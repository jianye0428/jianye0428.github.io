[{"categories":["Math"],"content":"1. ç‚¹åˆ°ç›´çº¿çš„è·ç¦» ç¬¬ä¸€ç§: æœ¬æ–‡é»˜è®¤æƒ…å†µä¸‹ï¼Œç›´çº¿çš„æ–¹ç¨‹ä¸º $l:Ax+By+C=0$ï¼Œ$A$, $B$ å‡ä¸ä¸º0ï¼Œæ–œç‡ä¸º $k_l$ï¼Œç‚¹çš„åæ ‡ä¸ºP(x0, y0)ï¼Œç‚¹ $P$ åˆ° $l$ çš„è·ç¦»ä¸º $d$ ã€‚ åˆ™è·ç¦»ä¸º: $$d=\\frac{|Ax_0+By_0+C|}{\\sqrt{A^2+B^2}}$$ æ¨å¯¼è¿‡ç¨‹å¦‚ä¸‹: https://zhuanlan.zhihu.com/p/26307123 ç¬¬äºŒç§: ç›´çº¿çš„æ–¹ç¨‹ä¸º $l: y = ax + b$ï¼Œ$a$, $b$ å‡ä¸ä¸º0ï¼Œæ–œç‡ä¸º $a$ï¼Œç‚¹çš„åæ ‡ä¸ºP(x0, y0)ï¼Œç‚¹ $P$ åˆ°ç›´çº¿ $l$ çš„è·ç¦»ä¸º $d$ ã€‚ $$d=\\frac{|ax_{0} - y_{0} + b|}{\\sqrt{a^2+b^2}}$$ ","date":"2024-05-12","objectID":"/posts/pointlineplane/:1:0","tags":["å¹³é¢å‡ ä½•"],"title":"ç‚¹ã€çº¿ã€é¢ä¹‹é—´çš„å…³ç³»","uri":"/posts/pointlineplane/"},{"categories":["Math"],"content":"2. å¦‚ä½•åˆ¤æ–­ä¸¤ç‚¹åœ¨ç›´çº¿çš„ä¸¤ä¾§ åˆ¤æ–­ç‚¹åœ¨ç›´çº¿çš„ä¸€ä¾§: æ–¹æ³•ä¸€: å·²çŸ¥ $P(0,0)$, $Q(3,2)$ ä¸¤ç‚¹ï¼Œè¯•åˆ¤æ–­ $P$ , $Q$æ˜¯å¦åœ¨ç›´çº¿ $2x+3y=4$ çš„åŒä¸€ä¾§ã€‚ è§£ï¼šç›´çº¿2x+3y=4, å³ç›´çº¿2x+3y-4=0, æŠŠPã€Qä»£å…¥2x+3y-4å¾—åˆ°: $$2 \\times 0 + 3 \\times 0-4=-4\u003c0$$ $$2 {\\times} 3+3 {\\times} 2 - 4 = 8 \u003e 0$$ æ‰€ä»¥ï¼Œåœ¨ä¸¤ä¾§ã€‚ æ–¹æ³•2: æ€ä¹ˆåˆ¤æ–­åæ ‡ä¸º(xp,yp)çš„ç‚¹Pæ˜¯åœ¨ç›´çº¿çš„å“ªä¸€ä¾§å‘¢? è®¾ç›´çº¿æ˜¯ç”±å…¶ä¸Šä¸¤ç‚¹ $(x_1,y_1)$ï¼Œ$(x_2,y_2)$ ç¡®å®šçš„ï¼Œç›´çº¿æ–¹å‘æ˜¯ç”± $(x_1,y_1)$ åˆ° $(x_2,y_2)$ çš„æ–¹å‘ã€‚ å‡è®¾ç›´çº¿æ–¹ç¨‹ä¸ºï¼š$Ax+By+C=0$ï¼Œåˆ™æœ‰: $A=y2-y1$; $B=x1-x2$; $C=x2y1-x1y2$; $$\\left\\{\\begin{aligned} A\u0026=y_2-y_1\\\\ B\u0026=x_1-x_2\\\\ C\u0026=x_2y_1-x_1y_2 \\end{aligned}\\right.$$ è¿™æ—¶å¯ä»¥é€šè¿‡è®¡ç®—D,æ¥åˆ¤æ–­ç‚¹Pæ˜¯åœ¨ç›´çº¿çš„å“ªä¸€ä¾§: $$D=Ax_p+By_p+C$$ è‹¥D\u003c0, åˆ™ç‚¹Påœ¨ç›´çº¿çš„å·¦ä¾§; è‹¥D\u003e0, åˆ™ç‚¹Påœ¨ç›´çº¿çš„å³ä¾§; è‹¥D=0, åˆ™ç‚¹Påœ¨ç›´çº¿ä¸Šã€‚ æ³¨ï¼šè¿™é‡Œçš„ç›´çº¿æ˜¯æœ‰æ–¹å‘æ€§çš„ï¼ æ–¹æ³•3ï¼š åˆ©ç”¨çŸ¢é‡è®¡ç®—å¿«é€Ÿåˆ¤å®šä¸€ç‚¹åœ¨ç›´çº¿çš„å“ªä¸€ä¾§! ä¾‹å¦‚çŸ¢é‡AÃ—çŸ¢é‡B=çŸ¢é‡C è®¾æƒ³çŸ¢é‡Aæ²¿å°äº180åº¦çš„è§’åº¦è½¬å‘çŸ¢é‡B å°†å³æ‰‹çš„å››æŒ‡æŒ‡å‘çŸ¢é‡Açš„æ–¹å‘ï¼Œå³æ‰‹çš„å››æŒ‡å¼¯æ›²ä»£è¡¨ä¸Šè¿°æ—‹è½¬æ–¹å‘ï¼Œåˆ™ä¼¸ç›´çš„æ‹‡æŒ‡æŒ‡å‘å®ƒä»¬çš„å‰ä¹˜å¾—åˆ°çš„çŸ¢é‡C å¦‚æœçŸ¢é‡Cçš„æ–¹å‘ç›¸åŒï¼Œåˆ™åœ¨åŒä¾§ï¼›å¦åˆ™åœ¨ä¸¤ä¾§ã€‚ æ³¨ï¼šå‰ä¹˜è®¡ç®—å…¬å¼ï¼ è‹¥å°†å‘é‡ç”¨åæ ‡è¡¨ç¤ºï¼ˆä¸‰ç»´å‘é‡ï¼‰ï¼Œå‘é‡ $a=(x_1,y_1,z_1)$ï¼Œå‘é‡ $b=(x_2,y_2,z_2)$ï¼Œåˆ™ï¼š ç‚¹ä¹˜ï¼Œä¹Ÿå«å‘é‡çš„å†…ç§¯ã€æ•°é‡ç§¯ã€‚ $$å‘é‡aÂ·å‘é‡b = |a||b|cos\\theta$$ $$å‘é‡aÂ·å‘é‡b = x_1 * x_2 + y_1 * y_2 + z_1 * z_2$$ å‰ä¹˜ï¼Œä¹Ÿå«å‘é‡çš„å¤–ç§¯ã€å‘é‡ç§¯ã€‚ $$|å‘é‡c| = |å‘é‡aÃ—å‘é‡b| = |a||b|sin \\theta$$ å‘é‡cçš„æ–¹å‘ä¸a,bæ‰€åœ¨çš„å¹³é¢å‚ç›´ï¼Œä¸”æ–¹å‘è¦ç”¨â€œå³æ‰‹æ³•åˆ™â€åˆ¤æ–­ï¼ˆç”¨å³æ‰‹çš„å››æŒ‡å…ˆè¡¨ç¤ºå‘é‡açš„æ–¹å‘ï¼Œç„¶åæ‰‹æŒ‡æœç€æ‰‹å¿ƒçš„æ–¹å‘\u003c180æ‘†åŠ¨åˆ°å‘é‡bçš„æ–¹å‘ï¼Œå¤§æ‹‡æŒ‡æ‰€æŒ‡çš„æ–¹å‘å°±æ˜¯å‘é‡cçš„æ–¹å‘ï¼‰ï¼› $$a\\times b=\\begin{vmatrix}\\mathrm{i}\u0026\\mathrm{j}\u0026\\mathrm{k}\\\\x_{1}\u0026y_{1}\u0026z_{1}\\\\x_{2}\u0026y_{2}\u0026z_{2}\\end{vmatrix}=(y_{1}z_{2}-y_{2}z_{1})i-(x_{1}z_{2}-x_{2}z_{1})j+(x_{1}y_{2}-x_{2}y_{1})k$$ ï¼ˆiã€jã€kåˆ†åˆ«ä¸ºç©ºé—´ä¸­ç›¸äº’å‚ç›´çš„ä¸‰æ¡åæ ‡è½´çš„å•ä½å‘é‡ï¼‰ ref: [1]. Cross Productå‰ä¹˜é€ŸæŸ¥æ‰‹å†Œ [2].å‰ä¹˜å‡ ä½•æ„ä¹‰ [3].https://blog.csdn.net/wzyaiwl/article/details/106310705 ","date":"2024-05-12","objectID":"/posts/pointlineplane/:2:0","tags":["å¹³é¢å‡ ä½•"],"title":"ç‚¹ã€çº¿ã€é¢ä¹‹é—´çš„å…³ç³»","uri":"/posts/pointlineplane/"},{"categories":["Math"],"content":"3. åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨çŸ©å½¢ã€å¤šè¾¹å½¢ä¸­ æ–¹æ³•ä¸€: åªè¦åˆ¤æ–­è¯¥ç‚¹çš„æ¨ªåæ ‡å’Œçºµåæ ‡æ˜¯å¦å¤¹åœ¨çŸ©å½¢çš„å·¦å³è¾¹å’Œä¸Šä¸‹è¾¹ä¹‹é—´ã€‚ ä¾‹å¦‚: åˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨ä¸¤æ¡çº¿æ®µä¹‹é—´å¤¹ç€å°±è½¬åŒ–æˆï¼Œåˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨æŸæ¡çº¿æ®µçš„ä¸€è¾¹ä¸Šï¼Œå°±å¯ä»¥åˆ©ç”¨å‰ä¹˜çš„æ–¹å‘æ€§ï¼Œæ¥åˆ¤æ–­å¤¹è§’æ˜¯å¦è¶…è¿‡äº†180åº¦ å¦‚ä¸‹å›¾: BP Network åªè¦åˆ¤æ–­ $(AB \\times AE ) * (CD \\times CE) \u003e= 0$ å°±è¯´æ˜Eåœ¨ADå’ŒBCä¸­é—´å¤¹ç€ï¼ŒåŒç† $ (DA \\times DE ) * (BC \\times BE) \u003e= 0 $ è®¡ç®—å¦ä¸¤è¾¹AB,CDå°±å¯ä»¥äº†ã€‚(å¤‡æ³¨å¯è¿›ä¸€æ­¥å­¦ä¹ ï¼šå‘é‡ç‚¹ä¹˜ï¼Œå‰ä¹˜çš„æ„ä¹‰å’Œå‡ ä½•æ„ä¹‰) æœ€åå°±æ˜¯åªéœ€è¦åˆ¤æ–­ $$(AB \\times AE ) * (CD \\times CE) \u003e= 0 \\text{ä¸”} (DA \\times DE ) * (BC \\times BE) \u003e= 0$$ ã€‚ å‚è€ƒä»£ç : // è®¡ç®— |p1 p2| X |p1 p| function GetCross(p1: Point, p2: Point, p: Point) { return (p2.x - p1.x) * (p.y - p1.y) - (p.x - p1.x) * (p2.y - p1.y); } //åˆ¤æ–­ç‚¹pæ˜¯å¦åœ¨p1p2p3p4çš„æ­£æ–¹å½¢å†… function IsPointInMatrix(p1: Point, p2: Point, p3: Point, p4: Point, p: Point) { let isPointIn = GetCross(p1, p2, p) * GetCross(p3, p4, p) \u003e= 0 \u0026\u0026 GetCross(p2, p3, p) * GetCross(p4, p1, p) \u003e= 0; return isPointIn; } ä¸¾ä¾‹: https://www.cnblogs.com/fangsmile/p/9306510.html æ–¹æ³•2ï¼š é‡‡ç”¨ç‚¹æ˜¯å¦åŒ…å«åœ¨å¤šè¾¹å½¢ä¸­åˆ¤æ–­ ä»¥è¯¥ç‚¹ä¸ºé¡¶ç‚¹ï¼Œåšä¸€æ¡å°„çº¿ï¼Œä½¿å¾—çŸ©å½¢å››ä¸ªé¡¶ç‚¹ä¸­ä»»æ„ä¸€ç‚¹éƒ½ä¸åœ¨å°„çº¿ä¸Šã€‚ è‹¥è¯¥å°„çº¿ä¸çŸ©å½¢æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªäº¤ç‚¹ï¼Œåˆ™åœ¨çŸ©å½¢å†…ï¼›è‹¥æœ‰é›¶ä¸ªæˆ–ä¸¤ä¸ªç„¦ç‚¹ï¼Œåˆ™åœ¨çŸ©å½¢å¤–ã€‚ è‡³äºå°„çº¿ï¼Œå¯ä»¥é€šè¿‡é€‰æ‹©è‚¯å®šåœ¨çŸ©å½¢å¤–çš„ä¸€ç‚¹å’Œå·²çŸ¥ç‚¹ç»ƒæˆçº¿æ®µæ¥æ„æˆã€‚ References: [1] äºŒç»´è®¡ç®—å‡ ä½•åŸºç¡€ ","date":"2024-05-12","objectID":"/posts/pointlineplane/:3:0","tags":["å¹³é¢å‡ ä½•"],"title":"ç‚¹ã€çº¿ã€é¢ä¹‹é—´çš„å…³ç³»","uri":"/posts/pointlineplane/"},{"categories":["Math"],"content":"4. åˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢çš„å†…éƒ¨ æ–¹æ³•ä¸€ï¼šé¢ç§¯æ¯”è¾ƒ åˆ¤æ–­â–³ABO+â–³BOC+â–³COAçš„é¢ç§¯ä¸â–³ABCæ˜¯å¦ç›¸ç­‰ã€‚è‹¥ç›¸ç­‰åˆ™Oåœ¨å†…éƒ¨ï¼Œåä¹‹åˆ™åœ¨å¤–éƒ¨ã€‚ BP Network å¦‚ä½•è®¡ç®—ä¸‰è§’å½¢çš„é¢ç§¯å‘¢ï¼Ÿé€šè¿‡åæ ‡ï¼Œå¾ˆå®¹æ˜“è®¡ç®—ä¸‰è§’å½¢çš„è¾¹é•¿ã€‚ å†ç”±æµ·ä¼¦å…¬å¼è®¡ç®—é¢ç§¯ã€‚ $$S=\\sqrt{p(p-a)(p-b)(p-c)}$$ å…¶ä¸­ï¼Œa,b,cä¸ºä¸‰è¾¹é•¿åº¦, $p=\\frac{a+b+c}{2}$ ä»£ç å®ç°: #include \u003ciostream\u003e #include \u003cmath.h\u003e using namespace std; struct Point { double x; double y; }; double getDist(Point p1,Point p2) { //ä¸¤ç‚¹ä¹‹é—´è®¡ç®—è·ç¦»å…¬å¼ return sqrt(pow(p1.x-p2.x,2) + pow(p1.y-p2.y,2)); } double getArea(Point p1,Point p2,Point p3) { double a = getDist(p1, p2); double b = getDist(p2, p3); double c = getDist(p1, p3); double p = (a + b + c) / 2; return sqrt(p * (p - a) * (p - b) * (p - c)); } bool isInTriangle(Point p1,Point p2,Point p3,Point o) { double s1 = getArea(p1,p2,o); double s2 = getArea(p2,p3,o); double s3 = getArea(p3,p1,o); double s = getArea(p1,p2,p3); return s1+s2+s3 == s; //æ­¤å¤„æ²¡æœ‰ç”¨fabs(a-b)\u003cepsæ¯”è¾ƒï¼Œæ˜¯æ–¹ä¾¿å¤§å®¶ç†è§£æ€è·¯ } int main() { Point p1,p2,p3,o; cin \u003e\u003e p1.x \u003e\u003e p1.y; cin \u003e\u003e p2.x \u003e\u003e p2.y; cin \u003e\u003e p3.x \u003e\u003e p3.y; cin \u003e\u003e o.x \u003e\u003e o.y; bool flag = isInTriangle(p1,p2,p3,o); if(flag) puts(\"Yes\"); else puts(\"No\"); } æ–¹æ³•äºŒï¼šå‘é‡å‰ä¹˜ è‹¥ç‚¹Oåœ¨ä¸‰è§’å½¢å†…éƒ¨ï¼Œåˆ™æ²¿ç€ä¸‰è§’å½¢çš„è¾¹é€†æ—¶é’ˆèµ°ï¼Œç‚¹Oä¸€å®šä¿æŒåœ¨è¾¹çš„å·¦ä¾§ã€‚å¦‚å›¾ç¤ºï¼Œç‚¹åœ¨é€†æ—¶é’ˆè¡Œèµ°æ—¶ï¼Œåœ¨ABï¼ŒBCï¼ŒCAçš„å·¦ä¾§ã€‚ BP Network å¦‚ä½•åˆ¤æ–­ç‚¹åœ¨ä¸€ä¸ªè¾¹çš„å·¦ä¾§å‘¢ï¼Ÿ å¯ä»¥å€ŸåŠ©å‘é‡å‰ä¹˜æ¥åˆ¤æ–­Oæ˜¯å¦åœ¨å‘é‡ABçš„å“ªä¸€ä¾§ã€‚é€šè¿‡è®¡ç®—å‘é‡AOä¸å‘é‡ABçš„å‰ä¹˜çš„å€¼ä¸ºæ­£ï¼Œåˆ™è¡¨ç¤ºOåœ¨ABçš„å·¦ä¾§ï¼Œåä¹‹ä¸ºå³ä¾§ã€‚ (ç†è§£æœ€å¥½ï¼Œç†è§£ä¸äº†ä¹Ÿä¸è¦çº ç»“ï¼ŒæŠŠå‰ä¹˜å…¬å¼è®°ä¸€ä¸‹å°±ok) å‘é‡ $\\overrightarrow{a}$ æ˜¯ $(m,n)$ , $\\vec{b}$ æ˜¯ $(p,q)$ $$\\vec{a} \\times \\vec{b} = mq-np$$ æœ¬é¢˜çš„æ ¸å¿ƒæ€è·¯å°±æ˜¯è¿™æ ·ã€‚å¦‚æœè¦è®©æ‰‹æ’•ä»£ç ï¼Œé¢˜ç›®å¯èƒ½æ²¡æœ‰è¯´è¾“å…¥çš„3ä¸ªç‚¹æ˜¯é€†æ—¶é’ˆé¡ºåºçš„ã€‚æ¯”å¦‚ï¼Œä¸Šå›¾ä¸­å¦‚æœä¾æ¬¡è¾“å…¥çš„æ˜¯A,C,Bçš„åæ ‡ï¼Œé‚£å°±ä¸è¡Œäº†ã€‚ æ€ä¹ˆè§£å†³å‘¢ï¼Ÿå‡è®¾ä¾æ¬¡è¾“å…¥çš„ç‚¹åˆ†åˆ«æ˜¯p1,p2,p3ã€‚ æˆ‘ä»¬åˆ¤æ–­è‹¥p3åœ¨ $\\vec{p1} \\vec{p2}$çš„å³ä¾§ï¼åˆ™è¡¨ç¤ºè¾“å…¥çš„ç‚¹çš„é¡ºåºæ˜¯é¡ºæ—¶é’ˆçš„ï¼Œå³A,C,Bå¼çš„è¾“å…¥ï¼Œå°†p2,p3è°ƒæ¢ä½ç½®å³å¯ä¿è¯é¡ºåºæ˜¯é€†æ—¶é’ˆã€‚ BP Network å‚è€ƒä»£ç : #include \u003ciostream\u003e #include \u003cmath.h\u003e using namespace std; struct Point { double x; double y; }; double crossproduct(Point p1,Point p2,Point p3) { //é¦–å…ˆæ ¹æ®åæ ‡è®¡ç®—p1p2å’Œp1p3çš„å‘é‡ï¼Œç„¶åå†è®¡ç®—å‰ä¹˜ //p1p2 å‘é‡è¡¨ç¤ºä¸º (p2.x-p1.x,p2.y-p1.y) //p1p3 å‘é‡è¡¨ç¤ºä¸º (p3.x-p1.x,p3.y-p1.y) return (p2.x-p1.x)*(p3.y-p1.y) - (p2.y-p1.y)*(p3.x-p1.x); } bool isInTriangle(Point p1,Point p2,Point p3,Point o) { //ä¿è¯p1ï¼Œp2ï¼Œp3æ˜¯é€†æ—¶é’ˆé¡ºåº if(crossproduct(p1, p2, p3)\u003c0) return isInTriangle(p1,p3,p2,o); if(crossproduct(p1, p2, o)\u003e0 \u0026\u0026 crossproduct(p2, p3, o)\u003e0 \u0026\u0026 crossproduct(p3, p1, o)\u003e0) return true; return false; } int main() { Point p1,p2,p3,o; cin \u003e\u003e p1.x \u003e\u003e p1.y; cin \u003e\u003e p2.x \u003e\u003e p2.y; cin \u003e\u003e p3.x \u003e\u003e p3.y; cin \u003e\u003e o.x \u003e\u003e o.y; bool flag = isInTriangle(p1,p2,p3,o); if(flag) puts(\"Yes\"); else puts(\"No\"); } https://leetcode.cn/circle/discuss/7OldE4/ ","date":"2024-05-12","objectID":"/posts/pointlineplane/:4:0","tags":["å¹³é¢å‡ ä½•"],"title":"ç‚¹ã€çº¿ã€é¢ä¹‹é—´çš„å…³ç³»","uri":"/posts/pointlineplane/"},{"categories":["AV","Robotics"],"content":"0. åŸºäºé‡‡æ ·çš„è¿åŠ¨è§„åˆ’ç®—æ³•-RRT(Rapidly-exploring Random Trees) RRTæ˜¯Steven M. LaValleå’ŒJames J. Kuffner Jr.æå‡ºçš„ä¸€ç§é€šè¿‡éšæœºæ„å»ºSpace Filling Treeå®ç°å¯¹éå‡¸é«˜ç»´ç©ºé—´å¿«é€Ÿæœç´¢çš„ç®—æ³•ã€‚è¯¥ç®—æ³•å¯ä»¥å¾ˆå®¹æ˜“çš„å¤„ç†åŒ…å«éšœç¢ç‰©å’Œå·®åˆ†è¿åŠ¨çº¦æŸçš„åœºæ™¯ï¼Œå› è€Œå¹¿æ³›çš„è¢«åº”ç”¨åœ¨å„ç§æœºå™¨äººçš„è¿åŠ¨è§„åˆ’åœºæ™¯ä¸­ã€‚ BP Network ","date":"2024-05-09","objectID":"/posts/rrt/:0:0","tags":["RRT"],"title":"RRT (Rapidly-Exploring Random Tree) ç®—æ³•è¯¦è§£","uri":"/posts/rrt/"},{"categories":["AV","Robotics"],"content":"1ã€ Basic RRTç®—æ³• åŸå§‹çš„RRTç®—æ³•ä¸­å°†æœç´¢çš„èµ·ç‚¹ä½ç½®ä½œä¸ºæ ¹èŠ‚ç‚¹ï¼Œç„¶åé€šè¿‡éšæœºé‡‡æ ·å¢åŠ å¶å­èŠ‚ç‚¹çš„æ–¹å¼ï¼Œç”Ÿæˆä¸€ä¸ªéšæœºæ‰©å±•æ ‘ï¼Œå½“éšæœºæ ‘çš„å¶å­èŠ‚ç‚¹è¿›å…¥ç›®æ ‡åŒºåŸŸï¼Œå°±å¾—åˆ°äº†ä»èµ·ç‚¹ä½ç½®åˆ°ç›®æ ‡ä½ç½®çš„è·¯å¾„ã€‚ ä¼ªä»£ç å¦‚ä¸‹ï¼š BP Network ä¸Šè¿°ä¼ªä»£ç ä¸­ï¼ŒMæ˜¯åœ°å›¾ç¯å¢ƒï¼Œ$x_{init}$æ˜¯èµ·å§‹ä½ç½®ï¼Œ$x_{goal}$æ˜¯ç›®æ ‡ä½ç½®ã€‚è·¯å¾„ç©ºé—´æœç´¢çš„è¿‡ç¨‹ä»èµ·ç‚¹å¼€å§‹ï¼Œå…ˆéšæœºæ’’ç‚¹$x_rand$;ç„¶åæŸ¥æ‰¾è·ç¦» $x_rand$ æœ€è¿‘çš„èŠ‚ç‚¹ $x_{near}$;ç„¶åæ²¿ç€ $x_{near}$ åˆ° $x_{rand}$æ–¹å‘å‰è¿›stepsizeçš„è·ç¦»å¾—åˆ°$x_{new}$; CollisionFree(M, $E_i$) æ–¹æ³•æ£€æµ‹Edge $(x_{new},x_{near})$ æ˜¯å¦ä¸åœ°å›¾ç¯å¢ƒä¸­çš„éšœç¢ç‰©æœ‰ç¢°æ’ï¼Œå¦‚æœæ²¡æœ‰ç¢°æ’ï¼Œåˆ™å°†æˆåŠŸå®Œæˆä¸€æ¬¡ç©ºé—´æœç´¢æ‹“å±•ã€‚é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´è‡³è¾¾åˆ°ç›®æ ‡ä½ç½®ã€‚ BP Network å›¾ç‰‡æ¥æº:https://www.researchgate.net/profile/Burak_Boyacioglu/publication/306404973/figure/fig1/AS:398553223581697@1472033901892/Basic-RRT-algorithm.png ","date":"2024-05-09","objectID":"/posts/rrt/:1:0","tags":["RRT"],"title":"RRT (Rapidly-Exploring Random Tree) ç®—æ³•è¯¦è§£","uri":"/posts/rrt/"},{"categories":["AV","Robotics"],"content":"2ã€åŸºäºæ¦‚ç‡çš„RRTç®—æ³• ä¸ºäº†åŠ å¿«éšæœºæ ‘æ”¶æ•›åˆ°ç›®æ ‡ä½ç½®çš„é€Ÿåº¦ï¼ŒåŸºäºæ¦‚ç‡çš„RRTç®—æ³•åœ¨éšæœºæ ‘çš„æ‰©å±•çš„æ­¥éª¤ä¸­å¼•å…¥ä¸€ä¸ªæ¦‚ç‡ $p$ï¼Œæ ¹æ®æ¦‚ç‡ $p$ çš„å€¼æ¥é€‰æ‹©æ ‘çš„ç”Ÿé•¿æ–¹å‘æ˜¯éšæœºç”Ÿé•¿($x_{rand}$) è¿˜æ˜¯æœå‘ç›®æ ‡ä½ç½® $x_{goal}$ ç”Ÿé•¿ã€‚å¼•å…¥å‘ç›®æ ‡ç”Ÿé•¿çš„æœºåˆ¶å¯ä»¥åŠ é€Ÿè·¯å¾„æœç´¢çš„æ”¶æ•›é€Ÿåº¦ã€‚ åŸºäºæ¦‚ç‡çš„RRTç®—æ³• ","date":"2024-05-09","objectID":"/posts/rrt/:2:0","tags":["RRT"],"title":"RRT (Rapidly-Exploring Random Tree) ç®—æ³•è¯¦è§£","uri":"/posts/rrt/"},{"categories":["AV","Robotics"],"content":"3ã€RRT Connectç®—æ³• RRT Connectç®—æ³•ä»åˆå§‹çŠ¶æ€ç‚¹å’Œç›®æ ‡çŠ¶æ€ç‚¹åŒæ—¶æ‰©å±•éšæœºæ ‘ä»è€Œå®ç°å¯¹çŠ¶æ€ç©ºé—´çš„å¿«é€Ÿæœç´¢ã€‚ BP Network å›¾ç‰‡æ¥æº:https://www.cs.cmu.edu/~motionplanning/lecture/lec20.pdf ","date":"2024-05-09","objectID":"/posts/rrt/:3:0","tags":["RRT"],"title":"RRT (Rapidly-Exploring Random Tree) ç®—æ³•è¯¦è§£","uri":"/posts/rrt/"},{"categories":["AV","Robotics"],"content":"4ã€RRT*ç®—æ³• RRT*ç®—æ³•çš„ç›®æ ‡åœ¨äºè§£å†³RRTç®—æ³•éš¾ä»¥æ±‚è§£æœ€ä¼˜çš„å¯è¡Œè·¯å¾„çš„é—®é¢˜ï¼Œå®ƒåœ¨è·¯å¾„æŸ¥æ‰¾çš„è¿‡ç¨‹ä¸­æŒç»­çš„ä¼˜åŒ–è·¯å¾„ï¼Œéšç€è¿­ä»£æ¬¡æ•°å’Œé‡‡æ ·ç‚¹çš„å¢åŠ ï¼Œå¾—åˆ°çš„è·¯å¾„è¶Šæ¥è¶Šä¼˜åŒ–ã€‚è¿­ä»£çš„æ—¶é—´è¶Šä¹…ï¼Œå°±è¶Šå¯ä»¥å¾—åˆ°ç›¸å¯¹æ»¡æ„çš„è§„åˆ’è·¯å¾„ã€‚ BP Network å›¾ç‰‡æ¥æºï¼šhttps://blog.csdn.net/gophae/article/details/103231053 RRT*ç®—æ³•ä¸RRTç®—æ³•çš„åŒºåˆ«ä¸»è¦åœ¨äºä¸¤ç‚¹ï¼š rewriteçš„è¿‡ç¨‹ã€‚å³ä¸º $x_{new}$ é‡æ–°é€‰æ‹©çˆ¶èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼› éšæœºæ ‘é‡å¸ƒçº¿çš„è¿‡ç¨‹ï¼› ","date":"2024-05-09","objectID":"/posts/rrt/:4:0","tags":["RRT"],"title":"RRT (Rapidly-Exploring Random Tree) ç®—æ³•è¯¦è§£","uri":"/posts/rrt/"},{"categories":["AV","Robotics"],"content":"4.1 Rewrite ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹Rewriteæ˜¯å¦‚ä½•å®ç°çš„ã€‚RRT*åœ¨æ‰¾åˆ°è·ç¦» $x_{rand}$ æœ€è¿‘çš„èŠ‚ç‚¹ $x_{nearest}$ å¹¶é€šè¿‡CollisionFreeæ£€æµ‹ä¹‹åï¼Œå¹¶ä¸ç«‹å³å°† Edge(x_{nearest},x_{rand}) åŠ å…¥æ‰©å±•æ ‘ä¸­ã€‚ BP Network å›¾ç‰‡æ¥æºï¼šhttps://blog.csdn.net/weixin_43795921/article/details/88557317 è€Œæ˜¯ä»¥ $x_{rand}$ ä¸ºä¸­å¿ƒï¼Œ$r$ ä¸ºåŠå¾„ï¼Œæ‰¾åˆ°æ‰€æœ‰æ½œåœ¨çš„çˆ¶èŠ‚ç‚¹é›†åˆï¼Œå¹¶ä¸ $x_{nearest}$ çˆ¶èŠ‚ç‚¹çš„Costå¯¹æ¯”ï¼Œçœ‹æ˜¯å¦å­˜åœ¨æ›´ä¼˜Costçš„çˆ¶èŠ‚ç‚¹ã€‚ BP Network å›¾ç‰‡æ¥æºï¼šhttps://blog.csdn.net/weixin_43795921/article/details/88557317 å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä¼šè®¡ç®—è·¯å¾„ $x_{init} \\rightarrow x_{parent} \\rightarrow x_{child}$ çš„Cost=$cost1$ï¼Œå†è®¡ç®— $x_{init} \\rightarrow x_{potential_parent} \\rightarrow x_{child}$ çš„Cost=$cost2$ï¼Œæ¯”è¾ƒ $cost1$å’Œ $cost2$ çš„å¤§å°ã€‚æ­¤å¤„ç”±äº $x_{potential_parent}$ ä¸ $ {x_child} $ ä¹‹é—´å­˜åœ¨éšœç¢ç‰©å¯¼è‡´äºŒè€…çš„ç›´æ¥è¿çº¿ä¸å¯è¾¾ï¼Œæ‰€ä»¥ $cost \u003e cost1$ ï¼Œä¸éœ€æ”¹å˜ $ x_{child} $ çš„çˆ¶èŠ‚ç‚¹ã€‚ BP Network å›¾ç‰‡æ¥æºï¼šhttps://blog.csdn.net/weixin_43795921/article/details/88557317 å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå½“è·¯å¾„ ${x_{init} \\rightarrow x_{parent}-\u003ex_{child}} $çš„Costå¤§äº ${x_{init} \\rightarrow x_{potential_parent} \\rightarrow x_{child}}$çš„Costæ—¶ï¼ŒRRT^*ç®—æ³•ä¼šå°†Edge${ x_{parent} \\rightarrow x_{child}}$å‰” é™¤ , å¹¶ æ–° å¢ Edge${ x_{potential_parent} \\rightarrow x_{child}} $ã€‚ BP Network å›¾ç‰‡æ¥æºï¼šhttps://blog.csdn.net/weixin_43795921/article/details/88557317 è‡³æ­¤æˆ‘ä»¬å°±å®Œæˆäº†ä¸€æ¬¡Rewriteçš„è¿‡ç¨‹ï¼Œæ–°ç”Ÿæˆçš„éšæœºæ ‘å¦‚ä¸‹ã€‚ BP Network å›¾ç‰‡æ¥æºï¼šhttps://blog.csdn.net/weixin_43795921/article/details/88557317 ","date":"2024-05-09","objectID":"/posts/rrt/:5:0","tags":["RRT"],"title":"RRT (Rapidly-Exploring Random Tree) ç®—æ³•è¯¦è§£","uri":"/posts/rrt/"},{"categories":["AV","Robotics"],"content":"4.2 éšæœºæ ‘é‡å¸ƒçº¿çš„è¿‡ç¨‹ BP Network å›¾ç‰‡æ¥æºï¼šhttps://blog.csdn.net/weixin_43795921/article/details/88557317 åœ¨ä¸º $x_{new}$ é‡æ–°é€‰æ‹©çˆ¶èŠ‚ç‚¹ä¹‹åï¼Œé‡å¸ƒçº¿ä½¿å¾—ç”Ÿæˆæ–°èŠ‚ç‚¹åçš„éšæœºæ ‘å‡å°‘å†—ä½™é€šè·¯ï¼Œå‡å°è·¯å¾„ä»£ä»·ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œ$x_{new}$ ä¸ºæ–°ç”Ÿæˆçš„èŠ‚ç‚¹ï¼Œ4ã€6ã€8æ˜¯ $x_{new}$ çš„è¿‘é‚»èŠ‚ç‚¹ï¼Œ0ã€ 4ã€ 5åˆ†åˆ«ä¸ºè¿‘é‚»èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ã€‚ è·¯å¾„{0-\u003e4}çš„Costä¸º: 10 è·¯å¾„{0-\u003e4-\u003e6}çš„Costä¸ºï¼š 10 + 5 = 15 è·¯å¾„{0-\u003e1-\u003e5-\u003e8}çš„Costä¸º: 3 + 5 + 1 = 9 å…ˆå°è¯•å°†èŠ‚ç‚¹4çš„çˆ¶èŠ‚ç‚¹æ”¹ä¸º $x_{new}$ï¼Œåˆ°è¾¾èŠ‚ç‚¹4çš„è·¯å¾„å˜ä¸º{0-\u003e1-\u003e5-\u003e9-\u003e4}ï¼Œæ–°è·¯å¾„çš„Cost=3+5+3+4=15ï¼Œæ–°è·¯å¾„çš„Costå¤§äºåŸè·¯å¾„Costï¼Œæ‰€ä»¥ä¸æ”¹å˜èŠ‚ç‚¹4çš„çˆ¶èŠ‚ç‚¹ã€‚ å†å°è¯•æ”¹å˜èŠ‚ç‚¹8çš„çˆ¶èŠ‚ç‚¹ä¸º $x_{new}$ï¼Œåˆ°è¾¾èŠ‚ç‚¹8çš„è·¯å¾„å˜ä¸º{0-\u003e1-\u003e5-\u003e9-\u003e8},æ–°è·¯å¾„çš„Cost=3+5+3+3=14ï¼Œæ–°è·¯å¾„çš„Costå¤§äºåŸè·¯å¾„Costï¼Œéšæ„ä¸æ”¹å˜èŠ‚ç‚¹8çš„çˆ¶èŠ‚ç‚¹ã€‚ å†å°è¯•æ”¹å˜èŠ‚ç‚¹6çš„çˆ¶èŠ‚ç‚¹ä¸º $x_{new}$ï¼Œåˆ°è¾¾è·¯å¾„6çš„è·¯å¾„å˜ä¸º{0-\u003e1-\u003e5-\u003e9-\u003e6},æ–°çš„Cost=3+5+3+1=12,æ–°è·¯å¾„çš„Costå°äºåŸè·¯å¾„Costï¼Œå› æ­¤å°†èŠ‚ç‚¹6çš„çˆ¶èŠ‚ç‚¹æ›´æ–°ä¸ºèŠ‚ç‚¹9ã€‚ é‡å¸ƒçº¿åçš„éšæœºæ ‘å¦‚ä¸Šå³å›¾æ‰€ç¤ºã€‚ ","date":"2024-05-09","objectID":"/posts/rrt/:6:0","tags":["RRT"],"title":"RRT (Rapidly-Exploring Random Tree) ç®—æ³•è¯¦è§£","uri":"/posts/rrt/"},{"categories":["AV","Robotics"],"content":"4.3 RRT*ç®—æ³•æ•ˆæœ ä»RRTä¸RRTçš„æ•ˆæœå¯ä»¥çœ‹å‡ºï¼ŒRRTçš„è·¯å¾„è§„åˆ’çš„ç»“æœä¼˜äºRRTç®—æ³•ã€‚ BP Network RRT^* VS RRTã€‚å›¾ç‰‡æ¥æºï¼šhttps://www.cc.gatech.edu/~dellaert/11S-AI/Topics/Entries/2011/2/21_PRM,_RRT,_and_RRT__files/06-RRT.pdf BP Network RRT^* VS RRT With Obstaclesã€‚å›¾ç‰‡æ¥æºï¼šhttps://www.cc.gatech.edu/~dellaert/11S-AI/Topics/Entries/2011/2/21_PRM,_RRT,_and_RRT__files/06-RRT.pdf RRT^*ç®—æ³•+èµ›è½¦åŠ¨åŠ›å­¦å®ç°è½¦è¾†180åº¦è½¬å¼¯ã€‚å›¾ç‰‡æ¥æºï¼šhttps://www.youtube.com/watch?v=KSB_9KE6fWI ","date":"2024-05-09","objectID":"/posts/rrt/:7:0","tags":["RRT"],"title":"RRT (Rapidly-Exploring Random Tree) ç®—æ³•è¯¦è§£","uri":"/posts/rrt/"},{"categories":["AV","Robotics"],"content":"å‚è€ƒé“¾æ¥ 1ã€åŸºäºRRTçš„è¿åŠ¨è§„åˆ’ç®—æ³•ç»¼è¿°(https://wenku.baidu.com/view/8de40fafbdeb19e8b8f67c1cfad6195f312be80a.html) 2ã€RRTç»´åŸºç™¾ç§‘(https://en.wikipedia.org/wiki/Rapidly-exploring_random_tree) 3ã€PRM, RRT, and RRT*ï¼ŒFrank Dellaer (https://www.cc.gatech.edu/~dellaert/11S-AI/Topics/Entries/2011/2/21_PRM,_RRT,_and_RRT__files/06-RRT.pdf) 4ã€è·¯å¾„è§„åˆ’â€”â€”æ”¹è¿›RRTç®—æ³•(https://zhuanlan.zhihu.com/p/51087819) 5ã€è¿åŠ¨è§„åˆ’RRT*ç®—æ³•å›¾è§£(https://blog.csdn.net/weixin_43795921/article/details/88557317) 6ã€å…¨å±€è·¯å¾„è§„åˆ’ï¼šå›¾æœç´¢ç®—æ³•ä»‹ç»4(RRT/RRT*)(https://blog.csdn.net/gophae/article/details/103231053) ref: [1]. https://zhuanlan.zhihu.com/p/133224593 [2]. https://blog.csdn.net/gophae/article/details/103231053 [3]. https://xwlu.github.io/wiki/path-planning/rrt/ [4]. â€» https://dlonng.com/posts/rrt ","date":"2024-05-09","objectID":"/posts/rrt/:8:0","tags":["RRT"],"title":"RRT (Rapidly-Exploring Random Tree) ç®—æ³•è¯¦è§£","uri":"/posts/rrt/"},{"categories":["RL"],"content":"æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³• ","date":"2024-05-04","objectID":"/posts/sac/:0:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["RL"],"content":"1 å‰è¨€ æœºå™¨äººå­¦ä¹ Robot Learningæ­£åœ¨å¿«é€Ÿçš„å‘å±•ï¼Œå…¶ä¸­æ·±åº¦å¼ºåŒ–å­¦ä¹ deep reinforcement learningï¼ˆDRLï¼‰ï¼Œç‰¹åˆ«æ˜¯é¢å‘è¿ç»­æ§åˆ¶continous controlçš„DRLç®—æ³•èµ·ç€é‡è¦çš„ä½œç”¨ã€‚åœ¨è¿™ä¸€é¢†åŸŸä¸­ï¼Œç›®å‰å¯ä»¥è¯´æœ‰ä¸‰ç±»è¡Œä¹‹æœ‰æ•ˆçš„model free DRLç®—æ³•ï¼š TRPO,PPO DDPGåŠå…¶æ‹“å±•ï¼ˆD4PG,TD3ç­‰ï¼‰ Soft Q-Learning, Soft Actor-Critic PPO ç®—æ³•æ˜¯ç›®å‰æœ€ä¸»æµçš„DRLç®—æ³•ï¼ŒåŒæ—¶é¢å‘ç¦»æ•£æ§åˆ¶å’Œè¿ç»­æ§åˆ¶ï¼Œåœ¨OpenAI Fiveä¸Šå–å¾—äº†å·¨å¤§æˆåŠŸã€‚ä½†æ˜¯PPOæ˜¯ä¸€ç§on-policyçš„ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯PPOé¢ä¸´ç€ä¸¥é‡çš„sample inefficiencyï¼Œéœ€è¦å·¨é‡çš„é‡‡æ ·æ‰èƒ½å­¦ä¹ ï¼Œè¿™å¯¹äºçœŸå®çš„æœºå™¨äººè®­ç»ƒæ¥è¯´ï¼Œæ˜¯æ— æ³•æ¥å—çš„ã€‚ DDPG åŠå…¶æ‹“å±•åˆ™æ˜¯DeepMindå¼€å‘çš„é¢å‘è¿ç»­æ§åˆ¶çš„off policyç®—æ³•ï¼Œç›¸å¯¹PPO æ›´sample efficientã€‚DDPGè®­ç»ƒçš„æ˜¯ä¸€ç§ç¡®å®šæ€§ç­–ç•¥deterministic policyï¼Œå³æ¯ä¸€ä¸ªstateä¸‹éƒ½åªè€ƒè™‘æœ€ä¼˜çš„ä¸€ä¸ªåŠ¨ä½œã€‚DDPGçš„æ‹“å±•ç‰ˆD4PGä»paperä¸­çš„ç»“æœçœ‹å–å¾—äº†éå¸¸å¥½çš„æ•ˆæœï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¼€æºï¼Œç›®å‰githubä¸Šä¹Ÿæ²¡æœ‰äººèƒ½å¤Ÿå®Œå…¨å¤ç°Deepmindçš„æ•ˆæœã€‚ Soft Actor-Critic (SAC) æ˜¯é¢å‘Maximum Entropy Reinforcement learning å¼€å‘çš„ä¸€ç§off policyç®—æ³•ï¼Œå’ŒDDPGç›¸æ¯”ï¼ŒSoft Actor-Criticä½¿ç”¨çš„æ˜¯éšæœºç­–ç•¥stochastic policyï¼Œç›¸æ¯”ç¡®å®šæ€§ç­–ç•¥å…·æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼ˆå…·ä½“åé¢åˆ†æï¼‰ã€‚Soft Actor-Criticåœ¨å…¬å¼€çš„benchmarkä¸­å–å¾—äº†éå¸¸å¥½çš„æ•ˆæœï¼Œå¹¶ä¸”èƒ½ç›´æ¥åº”ç”¨åˆ°çœŸå®æœºå™¨äººä¸Šã€‚æœ€å…³é”®çš„æ˜¯ï¼ŒSoft Actor-Criticæ˜¯å®Œå…¨å¼€æºçš„ï¼Œå› æ­¤ï¼Œæ·±å…¥ç†è§£Soft Actor-Critic ç®—æ³•å…·æœ‰éå¸¸é‡è¦çš„æ„ä¹‰ï¼Œä¹Ÿæ˜¯æœ¬ç¯‡blogçš„ç›®çš„ã€‚ Soft Actor-Criticç®—æ³•ç›¸å…³é“¾æ¥ï¼š Paperï¼š Soft Actor-Critic: Off-Policy Maximum Entropy Deep Reinforcement Learning with a Stochastic Actor Soft Actor-Critic Algorithms and Applications Reinforcement Learning with Deep Energy-Based Policies (Soft Q-Learning) Codes: rail-berkeley/softlearning (åŸä½œè€…å®ç°ï¼‰ vitchyr/rlkit openai/spinningup hill-a/stable-baselines ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†è§£è¯»ä¸€ä¸‹SACçš„ç®—æ³•åŠå…¶å…·ä½“å®ç°ã€‚æœ¬æ–‡çš„é˜…è¯»éœ€è¦æœ‰åŸºæœ¬çš„DRLç®—æ³•åŸºç¡€çŸ¥è¯†ã€‚ ","date":"2024-05-04","objectID":"/posts/sac/:1:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["RL"],"content":"2 ä¸ºä»€ä¹ˆç ”ç©¶ Maximum Entropy Reinforcement Learningï¼Ÿ å¯¹äºä¸€èˆ¬çš„DRLï¼Œå­¦ä¹ ç›®æ ‡å¾ˆç›´æ¥ï¼Œå°±æ˜¯å­¦ä¹ ä¸€ä¸ªpolicyä½¿å¾—ç´¯åŠ çš„rewardæœŸæœ›å€¼æœ€å¤§ï¼š $$\\pi^*=\\arg\\max_\\pi\\mathbb{E}_{(s_t,a_t)\\sim\\rho_\\pi}[\\sum_tR(s_t,a_t)]\\tag{1}$$ è€Œæœ€å¤§ç†µRLï¼Œé™¤äº†ä¸Šé¢çš„åŸºæœ¬ç›®æ ‡ï¼Œè¿˜è¦æ±‚policyçš„æ¯ä¸€æ¬¡è¾“å‡ºçš„action ç†µentropyæœ€å¤§ï¼š $$\\pi^*=\\arg\\max_\\pi\\mathbb{E}_{(s_t,a_t)\\sim\\rho_\\pi}[\\sum_t\\underbrace{R(s_t,a_t)}_{reward}+\\alpha\\underbrace{H(\\pi(\\cdot|s_t))}_{entropy}]\\tag{2}$$ è¿™æ ·åšçš„åŸºæœ¬ç›®çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè®©ç­–ç•¥éšæœºåŒ–ï¼Œå³è¾“å‡ºçš„æ¯ä¸€ä¸ªactionçš„æ¦‚ç‡å°½å¯èƒ½åˆ†æ•£ï¼Œè€Œä¸æ˜¯é›†ä¸­åœ¨ä¸€ä¸ªactionä¸Šã€‚ä¸äº†è§£entropyçš„åŒå­¦å¯ä»¥çœ‹è¿™é‡Œï¼šwiki-ä¿¡æ¯ç†µ æˆ‘ä»¬çŸ¥é“DDPGè®­ç»ƒå¾—åˆ°çš„æ˜¯ä¸€ä¸ªdeterministic policyç¡®å®šæ€§ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç­–ç•¥å¯¹äºä¸€ç§çŠ¶æ€stateåªè€ƒè™‘ä¸€ä¸ªæœ€ä¼˜çš„åŠ¨ä½œã€‚æ‰€ä»¥ï¼Œstochastic policyç›¸å¯¹deterministic policyæœ‰ä»€ä¹ˆä¼˜åŠ¿å‘¢ï¼Ÿ Stochastic policyéšæœºç­–ç•¥åœ¨å®é™…æœºå™¨äººæ§åˆ¶ä¸Šå¾€å¾€æ˜¯æ›´å¥½çš„åšæ³•ã€‚æ¯”å¦‚æˆ‘ä»¬è®©æœºå™¨äººæŠ“å–ä¸€ä¸ªæ°´æ¯ï¼Œæœºå™¨äººæ˜¯æœ‰æ— æ•°æ¡è·¯å¾„å»å®ç°è¿™ä¸ªè¿‡ç¨‹çš„ï¼Œè€Œå¹¶ä¸æ˜¯åªæœ‰å”¯ä¸€çš„ä¸€ç§åšæ³•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°±éœ€è¦drlç®—æ³•èƒ½å¤Ÿç»™å‡ºä¸€ä¸ªéšæœºç­–ç•¥ï¼Œåœ¨æ¯ä¸€ä¸ªstateä¸Šéƒ½èƒ½è¾“å‡ºæ¯ä¸€ç§actionçš„æ¦‚ç‡ï¼Œæ¯”å¦‚æœ‰3ä¸ªactionéƒ½æ˜¯æœ€ä¼˜çš„ï¼Œæ¦‚ç‡ä¸€æ ·éƒ½æœ€å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä»è¿™äº›actionä¸­éšæœºé€‰æ‹©ä¸€ä¸ªåšå‡ºactionè¾“å‡ºã€‚æœ€å¤§ç†µmaximum entropyçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ä¸é—è½åˆ°ä»»æ„ä¸€ä¸ªæœ‰ç”¨çš„actionï¼Œæœ‰ç”¨çš„trajectoryã€‚å¯¹æ¯”DDPGçš„deterministic policyçš„åšæ³•ï¼Œçœ‹åˆ°ä¸€ä¸ªå¥½çš„å°±æ¡èµ·æ¥ï¼Œå·®ä¸€ç‚¹çš„å°±ä¸è¦äº†ï¼Œè€Œæœ€å¤§ç†µæ˜¯éƒ½è¦æ¡èµ·æ¥ï¼Œéƒ½è¦è€ƒè™‘ã€‚ åŸºäºæœ€å¤§ç†µçš„RLç®—æ³•æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ ä»¥å‰ç”¨deterministic policyçš„ç®—æ³•ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€æ¡æœ€ä¼˜è·¯å¾„ï¼Œå­¦ä¹ è¿‡ç¨‹ä¹Ÿå°±ç»“æŸäº†ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬è¿˜è¦æ±‚ç†µæœ€å¤§ï¼Œå°±æ„å‘³ç€ç¥ç»ç½‘ç»œéœ€è¦å»exploreæ¢ç´¢æ‰€æœ‰å¯èƒ½çš„æœ€ä¼˜è·¯å¾„ï¼Œè¿™å¯ä»¥äº§ç”Ÿä»¥ä¸‹å¤šç§ä¼˜åŠ¿ï¼š 1ï¼‰å­¦åˆ°policyå¯ä»¥ä½œä¸ºæ›´å¤æ‚å…·ä½“ä»»åŠ¡çš„åˆå§‹åŒ–ã€‚å› ä¸ºé€šè¿‡æœ€å¤§ç†µï¼Œpolicyä¸ä»…ä»…å­¦åˆ°ä¸€ç§è§£å†³ä»»åŠ¡çš„æ–¹æ³•ï¼Œè€Œæ˜¯æ‰€æœ‰allã€‚å› æ­¤è¿™æ ·çš„policyå°±æ›´æœ‰åˆ©äºå»å­¦ä¹ æ–°çš„ä»»åŠ¡ã€‚æ¯”å¦‚æˆ‘ä»¬ä¸€å¼€å§‹æ˜¯å­¦èµ°ï¼Œç„¶åä¹‹åè¦å­¦æœæŸä¸€ä¸ªç‰¹å®šæ–¹å‘èµ°ã€‚ 2ï¼‰æ›´å¼ºçš„explorationèƒ½åŠ›ï¼Œè¿™æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œèƒ½å¤Ÿæ›´å®¹æ˜“çš„åœ¨å¤šæ¨¡æ€reward ï¼ˆmultimodal rewardï¼‰ä¸‹æ‰¾åˆ°æ›´å¥½çš„æ¨¡å¼ã€‚æ¯”å¦‚æ—¢è¦æ±‚æœºå™¨äººèµ°çš„å¥½ï¼Œåˆè¦æ±‚æœºå™¨äººèŠ‚çº¦èƒ½æº 3ï¼‰æ›´robusté²æ£’ï¼Œæ›´å¼ºçš„generalizationã€‚å› ä¸ºè¦ä»ä¸åŒçš„æ–¹å¼æ¥æ¢ç´¢å„ç§æœ€ä¼˜çš„å¯èƒ½æ€§ï¼Œä¹Ÿå› æ­¤é¢å¯¹å¹²æ‰°çš„æ—¶å€™èƒ½å¤Ÿæ›´å®¹æ˜“åšå‡ºè°ƒæ•´ã€‚ï¼ˆå¹²æ‰°ä¼šæ˜¯ç¥ç»ç½‘ç»œå­¦ä¹ è¿‡ç¨‹ä¸­çœ‹åˆ°çš„ä¸€ç§stateï¼Œæ—¢ç„¶å·²ç»æ¢ç´¢åˆ°äº†ï¼Œå­¦åˆ°äº†å°±å¯ä»¥æ›´å¥½çš„åšå‡ºååº”ï¼Œç»§ç»­è·å–é«˜rewardï¼‰ æ—¢ç„¶æœ€å¤§ç†µRLç®—æ³•è¿™ä¹ˆå¥½ï¼Œæˆ‘ä»¬å½“ç„¶åº”è¯¥ç ”ç©¶å®ƒäº†ã€‚è€Œå®é™…ä¸Šï¼Œåœ¨ä¹‹å‰çš„DRLç®—æ³•A3Cä¸­ï¼Œæˆ‘ä»¬å…¶å®å·²ç»ç”¨äº†ä¸€ä¸‹æœ€å¤§ç†µï¼š BP Network åœ¨è®­ç»ƒpolicyçš„æ—¶å€™ï¼ŒA3CåŠ äº†entropyé¡¹ï¼Œä½œä¸ºä¸€ä¸ªregularizerï¼Œè®©policyæ›´éšæœºã€‚ä¸è¿‡A3Cè¿™ä¹ˆåšä¸»è¦æ˜¯ä¸ºäº†æ›´å¥½åšexplorationï¼Œæ•´ä½“çš„è®­ç»ƒç›®æ ‡ä¾ç„¶åªè€ƒè™‘rewardã€‚è¿™å’ŒSoft Actor-Criticçš„è®¾å®šè¿˜æ˜¯ä¸ä¸€æ ·çš„ï¼ŒSoft Actor-Criticæ˜¯çœŸæ­£æœ€å¤§ç†µDRLç®—æ³•ã€‚ ","date":"2024-05-04","objectID":"/posts/sac/:2:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["RL"],"content":"3 Maximum Entropy Reinforcement Learningçš„Bellmanæ–¹ç¨‹ æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹dynamic programmingä¸­Bellman backup equationï¼Œå‚è€ƒhttp://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching_files/MDP.pdf BP Network $$q_\\pi(s,a)=r(s,a)+\\gamma\\sum_{s^{\\prime}\\in\\mathcal{S}}\\mathcal{P}_{ss^{\\prime}}^a\\sum_{a^{\\prime}\\in\\mathcal{A}}\\pi(a^{\\prime}|s^{\\prime})q_\\pi(s^{\\prime},a^{\\prime})\\tag{3}$$ é‚£ä¹ˆå¯¹äºæœ€å¤§ç†µï¼ˆMaxEnt)çš„ç›®æ ‡ï¼Œå…¶å®å¯ä»¥æŠŠç†µä¹Ÿä½œä¸ºrewardçš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬åœ¨è®¡ç®—qå€¼æ—¶ï¼ˆè®°ä½qæ˜¯ç´¯åŠ rewardçš„æœŸæœ›ï¼Œä¼ ç»Ÿrlçš„ç›®æ ‡ç­‰ä»·äºè®©qæœ€å¤§ï¼‰ï¼Œå°±éœ€è¦è®¡ç®—æ¯ä¸€ä¸ªstateçš„ç†µentropy (entropyçš„å…¬å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼š BP Network BP Network å› æ­¤æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°Soft Bellman Backup equation (Entropyé¡¹)é¢å¤–ä¹˜ä¸Š $\\alpha$ ç³»æ•°ï¼š $$q_\\pi(s,a)=r(s,a)+\\gamma\\sum_{s^{\\prime}\\in\\mathcal{S}}\\mathcal{P}_{ss^{\\prime}}^a\\sum_{a^{\\prime}\\in\\mathcal{A}}\\pi(a^{\\prime}|s^{\\prime})(q_\\pi(s^{\\prime},a^{\\prime})-\\alpha\\log(\\pi(a^{\\prime}|s^{\\prime}))\\quad(4)$$ Recallä¸€ä¸‹Dynamic Programming Backupï¼š BP Network å¯¹åº”Qå€¼çš„å…¬å¼æ˜¯ $$Q(s_t,a_t)=r(s_t,a_t)+\\gamma\\mathbb{E}_{s_{t+1},a_{t+1}}[Q(s_{t+1},a_{t+1})]\\tag{5}$$ æ ¹æ®å…¬å¼ï¼ˆ4ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°Soft Bellman Backupçš„ æ›´æ–°å…¬å¼ï¼š $$Q_{soft}(s_t,a_t)=r(s_t,a_t)+\\gamma\\mathbb{E}_{s_{t+1},a_{t+1}}[Q_{soft}(s_{t+1},a_{t+1})-\\alpha\\log(\\pi(a_{t+1}|s_{t+1}))]\\tag{6}$$ ä¸Šé¢å…¬å¼ï¼ˆ6ï¼‰æ˜¯ç›´æ¥ä½¿ç”¨dynamic programmingï¼Œå°†entropyåµŒå…¥è®¡ç®—å¾—åˆ°çš„ç»“æœã€‚æˆ‘ä»¬å¯ä»¥åè¿‡æ¥å…ˆç›´æ¥æŠŠentropyä½œä¸ºrewardçš„ä¸€éƒ¨åˆ†ï¼š $$r_{soft}(s_t,a_t)=r(s_t,a_t)+\\gamma\\alpha\\mathbb{E}_{s_{t+1}\\sim\\rho}H(\\pi(\\cdot|s_{t+1}))\\tag{7}$$ æˆ‘ä»¬å°†ï¼ˆ7ï¼‰å¸¦å…¥åˆ°å…¬å¼ï¼ˆ5ï¼‰ï¼š $$\\begin{aligned} {Q_{soft}(s_{t},a_{t})} \u0026=r(s_t,a_t)+\\gamma\\alpha\\mathbb{E}_{s_{t+1}\\sim\\rho}H(\\pi(\\cdot|s_{t+1}))+\\gamma\\mathbb{E}_{s_{t+1},a_{t+1}}[Q_{soft}(s_{t+1},a_{t+1})]\\\\ \u0026=r(s_t,a_t)+\\gamma\\mathbb{E}_{s_{t+1}\\sim\\rho,a_{t+1}\\sim\\pi}[Q_{soft}(s_{t+1},a_{t+1})]+\\gamma\\alpha\\mathbb{E}_{s_{t+1}\\sim\\rho}H(\\pi(\\cdot|s_{t+1}))\\\\ \u0026=r(s_t,a_t)+\\gamma\\mathbb{E}_{s_{t+1}\\sim\\rho,a_{t+1}\\sim\\pi}[Q_{soft}(s_{t+1},a_{t+1})]+\\gamma\\mathbb{E}_{s_{t+1}\\sim\\rho}\\mathbb{E}_{a_{t+1}\\sim\\pi}[-\\alpha\\log\\pi(a_{t+1}|s_{t+1})]\\\\ \u0026=r(s_t,a_t)+\\gamma\\mathbb{E}_{s_{t+1}\\sim\\rho}[\\mathbb{E}_{a_{t+1}\\sim\\pi}[Q_{soft}(s_{t+1},a_{t+1})-\\alpha\\log(\\pi(a_{t+1}|s_{t+1}))]]\\\\\u0026=r(s_t,a_t)+\\gamma\\mathbb{E}_{s_{t+1},a_{t+1}}[Q_{soft}(s_{t+1},a_{t+1})-\\alpha\\log(\\pi(a_{t+1}|s_{t+1}))]\\end{aligned}$$ å¯ä»¥å¾—åˆ°ä¸€æ ·çš„ç»“æœã€‚ ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬çŸ¥é“: $$Q(s_t,a_t)=r(s_t,a_t)+\\gamma\\mathbb{E}_{s_{t+1}\\sim\\rho}[V(s_{t+1})]\\tag{9}$$ å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ï¼š $$V_{soft}(s_t)=\\mathbb{E}_{a_t\\sim\\pi}[Q_{soft}(s_t,a_t)-\\alpha\\log\\pi(a_t|s_t)]\\tag{10}$$ è‡³æ­¤æˆ‘ä»¬ç†æ¸…æ¥šäº†SAC paperåŸæ–‡ä¸­çš„å…¬å¼(2)å’Œ(3)ï¼š BP Network BP Network å¹¶ä¸”ï¼ˆ7ï¼‰çš„åšæ³•ç›´æ¥è¯æ˜äº†Lemma 1 Soft Policy Evaluation (è¿™ä¸ªlemmaä¸ºä¸‹ä¸€éƒ¨åˆ†çš„soft policy iterationæä¾›æ”¯æ’‘ï¼‰: BP Network ä½†æ˜¯ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä¸Šé¢çš„æ•´ä¸ªæ¨å¯¼è¿‡ç¨‹éƒ½æ˜¯å›´ç»•maximum entropyï¼Œå’Œsoft å¥½åƒæ²¡æœ‰ä»€ä¹ˆç›´æ¥å…³ç³»ã€‚æ‰€ä»¥ï¼Œ ä¸ºä»€ä¹ˆç§°ä¸ºsoftï¼Ÿå“ªé‡Œsoftäº†ï¼Ÿä»¥åŠä¸ºä»€ä¹ˆsoft Q functionèƒ½å¤Ÿå®ç°maximum entropyï¼Ÿ ç†è§£æ¸…æ¥šè¿™ä¸ªé—®é¢˜æ˜¯ç†è§£æ˜ç™½soft q-learningåŠsacçš„å…³é”®ï¼ SACè¿™ç¯‡paperç›´æ¥è·³è¿‡äº†soft Q-functionçš„å®šä¹‰é—®é¢˜ï¼Œå› æ­¤ï¼Œè¦ææ¸…æ¥šä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä»Soft Q-Learningçš„paperæ¥å¯»æ‰¾ç­”æ¡ˆã€‚ å‚è€ƒLearning Diverse Skills via Maximum Entropy Deep Reinforcement Learning BP Network ä¸Šé¢çš„æ›²çº¿å¾ˆæ˜æ˜¾çš„è¯´æ˜äº†stochastic policyçš„é‡è¦æ€§ï¼Œé¢å¯¹å¤šæ¨¡çš„ï¼ˆmultimodalï¼‰çš„Q functionï¼Œä¼ ç»Ÿçš„RLåªèƒ½æ”¶æ•›åˆ°ä¸€ä¸ªé€‰æ‹©ï¼ˆå·¦å›¾ï¼‰ï¼Œè€Œæ›´ä¼˜çš„åŠæ³•æ˜¯å³å›¾ï¼Œè®©policyä¹Ÿç›´æ¥ç¬¦åˆQçš„åˆ†å¸ƒã€‚è¿™é‡Œï¼Œæœ€ç›´æ¥çš„ä¸€ç§åŠæ³•å°±æ˜¯å®šä¹‰è¿™æ ·çš„energy-based policyï¼š \\pi(a_t|s_t)\\propto exp(-\\mathcal{E}(s_t,a_t)) ï¼ˆ11ï¼‰ å…¶ä¸­ \\mathcal{E} æ˜¯èƒ½é‡å‡½æ•°ï¼Œä¸Šé¢çš„å½¢å¼å°±æ˜¯Boltzmann Distribution ç»å°”å…¹æ›¼åˆ†å¸ƒ ã€‚ä¸‹å›¾çš„ -f(x)=\\mathcal{E} BP Network https://deepgenerativemodels.github.io/assets/slides/cs236_lecture13.pdf ä¸ºäº†è¿æ¥soft Q functionï¼Œæˆ‘ä»¬å¯ä»¥è®¾å®š $$\\mathcal{E}(s_t,a_t)=-\\frac{1}{\\alpha}Q_{soft}(s_t,a_t)\\tag{12}$$ å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ $$\\pi(a_t|s_t)\\propto exp(Q_{soft}(s_t,a_t))\\tag{13}$$ è¿™æ ·çš„policyèƒ½å¤Ÿä¸ºæ¯ä¸€ä¸ªactionèµ‹å€¼ä¸€ä¸ªç‰¹å®šçš„æ¦‚ç‡ç¬¦åˆQå€¼çš„åˆ†å¸ƒï¼Œä¹Ÿå°±æ»¡è¶³äº†stochastic policyçš„éœ€æ±‚ã€‚ ä¸‹é¢æˆ‘ä»¬è¦å‘ç°(13)çš„å½¢å¼æ­£å¥½å°±æ˜¯æœ€å¤§ç†µRLçš„optimal policyæœ€ä¼˜ç­–ç•¥çš„å½¢å¼ï¼Œè€Œè¿™å®ç°äº†soft q functionå’Œmaximum entropyçš„è¿æ¥ã€‚ BP Network å®é™…ä¸Šæˆ‘ä»¬ç†è§£Soft Q-LearningåŠSoft Actor Criticï¼Œè¦æ¸…æ¥šä¸Šå›¾ä¸‰è€…çš„å…³ç³»ã€‚åœ¨Soft Q-Learningé‚£ç¯‡paperä¸­ï¼Œä»–æ˜¯ä»Soft Value Functionçš„å®šä¹‰å‡ºå‘å»è¿æ¥Energy-Based Policy å’ŒMaximum Entropy Objectiveçš„å…³ç³»ã€‚è€Œåœ¨æœ¬blogä¸­ï¼Œæˆ‘ä»¬ä»Maximum Entropy Objectiveå‡ºå‘ï¼Œæ¥è¿æ¥å…¶ä»–ä¸¤éƒ¨åˆ†ã€‚ å‰é¢æˆ‘ä»¬å·²ç»æ¨å¯¼å¾—åˆ°äº†å…¬å¼ï¼ˆ10ï¼‰ï¼Œé‚£ä¹ˆæ ¹æ®å…¬å¼ï¼ˆ10ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ¨å¯¼å¾—åˆ°policyçš„å½¢å¼ï¼š $$\\begin{aligned}\\pi(s_{t},a_{t})\u0026=\\exp(\\frac1\\alpha(Q_{soft}(s_t,a_t)-V_{soft}(s_t)))\\\\\u0026\u0026\\text{(14)}\\\\\u0026=\\frac{\\exp(\\frac1\\alpha Q_{soft}(s_t,a_t))}{\\exp(\\frac1\\alpha V_{soft}(s_t))}\\end{aligned}$$ ï¼ˆ14ï¼‰ç¬¦åˆäº†ï¼ˆ13ï¼‰ï¼Œ $\\frac{1}{\\alpha}V_{soft}(s_t)$ å¯ä»¥çœ‹åšæ˜¯å¯¹åº”çš„log partition function. ç”±æ­¤ï¼Œå°±è¿æ¥äº†Maximum En","date":"2024-05-04","objectID":"/posts/sac/:3:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["RL"],"content":"4 Policy Iteration ç†æ¸…æ¥šäº†ä¸Šé¢çš„åŸºæœ¬å®šä¹‰å’Œè”ç³»ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç ”ç©¶æ€ä¹ˆæ›´æ–°policyäº†ï¼Œä¹Ÿå°±æ˜¯policy iterationã€‚ å›é¡¾ä¸€ä¸‹ä¸€èˆ¬çš„Policy Iterationï¼š BP Network åœ¨ä¸¤æ­¥ä¸­è¿›è¡Œå¾ªç¯è¿­ä»£ï¼ˆæˆ‘ä»¬ç›´æ¥ä½¿ç”¨Qå€¼æ¥è¯´æ˜ï¼‰ï¼š Policy evaluationï¼šå›ºå®špolicyï¼Œä½¿ç”¨Bellmanæ–¹ç¨‹æ›´æ–°Qå€¼ç›´åˆ°æ”¶æ•›ï¼š $$Q_\\pi(s,a)=r(s,a)+\\lambda\\mathbb{E}_{s^{\\prime},a^{\\prime}}Q_\\pi(s^{\\prime},a^{\\prime})\\tag{20}$$ Policy improvement: æ›´æ–°policyï¼š $$\\pi^{\\prime}(s)=\\arg\\max_aQ_\\pi(s,a)\\tag{21}$$ åŸºäºåŒæ ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æœ‰Soft Policy Iterationï¼š Soft policy evaluation:å›ºå®špolicyï¼Œä½¿ç”¨Bellmanæ–¹ç¨‹æ›´æ–°Qå€¼ç›´åˆ°æ”¶æ•›: $$\\begin{aligned}\u0026Q_{soft}^\\pi(s_t,a_t)=r(s_t,a_t)+\\lambda\\mathbb{E}_{s_{t+1},a_{t+1}}\\left[Q_{soft}^\\pi(s_{t+1},a_{t+1})-\\alpha\\log(\\pi(a_{t+1}|s_{t+1}))\\right]\\tag{22}\\end{aligned}$$ Soft policy improvement: æ›´æ–°policyï¼š $$\\pi^{\\prime}=\\arg\\min_{\\pi_k\\in\\Pi}D_{KL}(\\pi_k(\\cdot|s_t)||\\frac{\\exp(\\frac{1}{\\alpha}Q_{soft}^{\\pi}(s_t,\\cdot))}{Z_{soft}^{\\pi}(s_t)}) \\tag{23}$$ (22)åŸºäºä¸Šä¸€éƒ¨åˆ†è¯´çš„Lemma 1 Soft Policy Evaluation, å¯æ”¶æ•›ã€‚ (23)åˆ™åŸºäºä¸Šä¸€éƒ¨åˆ†çš„Theorem 4 Policy Improvement Theoremã€‚åªæ˜¯è¿™é‡Œçš„åšæ³•ä¸æ˜¯ç›´æ¥èµ‹å€¼ï¼Œè€Œæ˜¯é€šè¿‡KL divergenceæ¥è¶‹è¿‘ $\\exp(Q^{\\pi}_{soft}(s_t,\\cdot))$ ã€‚åœ¨SACçš„paperåŸæ–‡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¹ˆåšçš„åŸå› æ˜¯ä¸ºäº†é™åˆ¶policyåœ¨ä¸€å®šèŒƒå›´çš„policies $\\Pi$ ä¸­ä»è€Œtractableï¼Œpolicyçš„åˆ†å¸ƒå¯ä»¥æ˜¯é«˜æ–¯åˆ†å¸ƒã€‚ BP Network åŒæ ·çš„ï¼Œä½œè€…ä¹Ÿä¸“é—¨è¯æ˜äº†é‡‡ç”¨KL divergenceçš„æ–¹æ³•ä¸€æ ·èƒ½å¤Ÿä¿è¯policy improvementï¼Œä¹Ÿå°±æ˜¯Lemma 2ï¼š BP Network æœ€åï¼Œå°±æ˜¯è¯æ˜ä¸Šé¢çš„Soft Policy Iterationè¿‡ç¨‹èƒ½ä¿è¯policyæ”¶æ•›åˆ°æœ€ä¼˜ï¼Œå³Theorem 1ï¼š BP Network ç”±æ­¤ï¼ŒåŸºæœ¬çš„ç†è®ºå»ºè®¾ä¹Ÿå°±ç»“æŸäº†ï¼Œä¸‹é¢è¿›å…¥Soft Actor-Criticçš„ç®—æ³•è®¾è®¡ã€‚ ","date":"2024-05-04","objectID":"/posts/sac/:4:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["RL"],"content":"5 Soft Actor-Critic SACç®—æ³•çš„æ„å»ºé¦–å…ˆæ˜¯ç¥ç»ç½‘ç»œåŒ–ï¼Œæˆ‘ä»¬ç”¨ç¥ç»ç½‘ç»œæ¥è¡¨ç¤ºQå’ŒPolicyï¼š $Q_{\\theta}(s_t,a_t)$ å’Œ $\\pi_{\\phi}(a_t|s_t)$ ã€‚Qç½‘ç»œæ¯”è¾ƒç®€å•ï¼Œå‡ å±‚çš„MLPæœ€åè¾“å‡ºä¸€ä¸ªå•å€¼è¡¨ç¤ºQå°±å¯ä»¥äº†ï¼ŒPolicyç½‘ç»œéœ€è¦è¾“å‡ºä¸€ä¸ªåˆ†å¸ƒï¼Œä¸€èˆ¬æ˜¯è¾“å‡ºä¸€ä¸ªGaussian åŒ…å«meanå’Œcovarianceã€‚ä¸‹é¢å°±æ˜¯æ„å»ºç¥ç»ç½‘ç»œçš„æ›´æ–°å…¬å¼ã€‚ å¯¹äºQç½‘ç»œçš„æ›´æ–°ï¼Œæˆ‘ä»¬æ ¹æ®ï¼ˆ10ï¼‰å¯ä»¥å¾—åˆ°ï¼š $$\\begin{aligned} J_{Q}(\\theta)\u0026 =\\mathbb{E}_{(s_t,a_t,s_{t+1})\\sim\\mathcal{D}}[\\frac{1}{2}(Q_\\theta(s_t,a_t)-(r(s_t,a_t)+\\gamma V_{\\bar{\\theta}}(s_{t+1})))^2] \\\\ \u0026=\\mathbb{E}_{(s_t,a_t,s_{t+1})\\sim\\mathcal{D},a_{t+1}\\sim\\pi_\\phi}[\\frac12(Q_\\theta(s_t,a_t)-(r(s_t,a_t)+\\gamma(Q_{\\bar{\\theta}}(s_{t+1},a_{t+1})-\\alpha\\log(\\pi_\\phi(a_{t+1}|s_{t+1})))))^2] \\tag{24} \\end{aligned}$$ è¿™é‡Œå’ŒDDPGä¸€æ ·ï¼Œæ„é€ äº†ä¸€ä¸ªtarget soft Q ç½‘ç»œå¸¦å‚æ•° $\\overline{\\theta}$ ï¼Œè¿™ä¸ªå‚æ•°é€šè¿‡exponentially moving average Qç½‘ç»œçš„å‚æ•° $\\theta$ å¾—åˆ°ã€‚(ps:åœ¨ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„SACä¸­ï¼Œä»–ä»¬å•ç‹¬å®šä¹‰äº†Vç½‘ç»œè¿›è¡Œæ›´æ–°ï¼Œè¯´æ˜¯æ›´ç¨³å®šï¼Œåˆ°æ–°ç‰ˆçš„SACä¸­ï¼Œç”±äºè‡ªåŠ¨æ›´æ–°temperature $\\alpha$ å°±ç›´æ¥ä½¿ç”¨Qç½‘ç»œæ›´æ–°ï¼‰ å¯¹äºPolicy ç½‘ç»œå‚æ•°çš„æ›´æ–°ï¼Œå°±æ˜¯æœ€å°åŒ–KL divergenceï¼š $$\\begin{aligned} J_{\\pi}(\\phi)\u0026 =D_{\\mathrm{KL}}\\left(\\pi_\\phi(.\\left|s_t\\right)|\\exp(\\frac1\\alpha Q_\\theta(s_t,.)-\\log Z(s_t))\\right) \\\\ \u0026=\\mathbb{E}_{s_t\\sim\\mathcal{D},a_t\\sim\\pi_\\phi}\\Big[\\log\\big(\\frac{\\pi_\\phi(a_t|s_t)}{\\exp(\\frac{1}{\\alpha}Q_\\theta(s_t,a_t)-\\log Z(s_t))}\\big)\\Big] \\\\ \u0026=\\mathbb{E}_{s_t\\sim\\mathcal{D},a_t\\sim\\pi_\\phi}[\\log\\pi_\\phi(a_t|s_t)-\\frac1\\alpha Q_\\theta(s_t,a_t)+\\log Z(s_t)] \\tag{25} \\end{aligned}$$ è¿™é‡Œçš„actionæˆ‘ä»¬é‡‡ç”¨reparameterization trickæ¥å¾—åˆ°ï¼Œå³ $$a_t=f_\\phi(\\varepsilon_t;s_t)=f_\\phi^\\mu(s_t)+\\varepsilon_t\\odot f_\\phi^\\sigma(s_t)\\tag{26}$$ få‡½æ•°è¾“å‡ºå¹³å‡å€¼å’Œæ–¹å·®ï¼Œç„¶å $\\varepsilon$ æ˜¯noiseï¼Œä»æ ‡å‡†æ­£æ€åˆ†å¸ƒé‡‡æ ·ã€‚ä½¿ç”¨è¿™ä¸ªtrickï¼Œæ•´ä¸ªè¿‡ç¨‹å°±æ˜¯å®Œå…¨å¯å¾®çš„(loss ä¹˜ä»¥ $\\alpha$ å¹¶å»æ‰ä¸å½±å“æ¢¯åº¦çš„å¸¸é‡log partition function Z(s_t)) ï¼š $$J_\\pi(\\phi)=\\mathbb{E}_{s_t\\sim\\mathcal{D},\\varepsilon\\sim\\mathcal{N}}[\\alpha\\log\\pi_\\phi(f_\\phi(\\varepsilon_t;s_t)|s_t)-Q_\\theta(s_t,f_\\phi(\\varepsilon_t;s_t))] \\tag{27}$$ è¿™æ ·åŸºæœ¬çš„Soft Actor-Criticçš„æ›´æ–°æ–¹æ³•ä¹Ÿå°±å¾—åˆ°äº†ã€‚ ","date":"2024-05-04","objectID":"/posts/sac/:5:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["RL"],"content":"6 Temperature Hyperparameter Auto-Adjustment å‰é¢çš„SACä¸­ï¼Œæˆ‘ä»¬åªæ˜¯äººä¸ºç»™å®šä¸€ä¸ªå›ºå®šçš„temperature $\\alpha$ ä½œä¸ºentropyçš„æƒé‡ï¼Œä½†å®é™…ä¸Šç”±äºrewardçš„ä¸æ–­å˜åŒ–ï¼Œé‡‡ç”¨å›ºå®šçš„temperatureå¹¶ä¸åˆç†ï¼Œä¼šè®©æ•´ä¸ªè®­ç»ƒä¸ç¨³å®šï¼Œå› æ­¤ï¼Œæœ‰å¿…è¦èƒ½å¤Ÿè‡ªåŠ¨è°ƒèŠ‚è¿™ä¸ªtemperatureã€‚å½“policyæ¢ç´¢åˆ°æ–°çš„åŒºåŸŸæ—¶ï¼Œæœ€ä¼˜çš„actionè¿˜ä¸æ¸…æ¥šï¼Œåº”è¯¥è°ƒæ•´temperature $\\alpha$ å»æ¢ç´¢æ›´å¤šçš„ç©ºé—´ã€‚å½“æŸä¸€ä¸ªåŒºåŸŸå·²ç»æ¢ç´¢å¾—å·®ä¸å¤šï¼Œæœ€ä¼˜çš„actionåŸºæœ¬ç¡®å®šäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªtemperatureå°±å¯ä»¥å‡å°ã€‚ è¿™é‡Œï¼ŒSACçš„ä½œè€…æ„é€ äº†ä¸€ä¸ªå¸¦çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ï¼Œè®©å¹³å‡çš„entropyæƒé‡æ˜¯æœ‰é™åˆ¶çš„ï¼Œä½†æ˜¯åœ¨ä¸åŒçš„stateä¸‹entropyçš„æƒé‡æ˜¯å¯å˜çš„ï¼Œå³ $$\\max_{\\pi_0,\\ldots,\\pi_T}\\mathbb{E}\\bigg[\\sum_{t=0}^Tr(s_t,a_t)\\bigg]\\mathrm{s.t.~}\\forall t, \\mathcal{H}(\\pi_t)\\geq\\mathcal{H}_0\\tag{28}$$ å¯¹äºè¿™éƒ¨åˆ†å†…å®¹ï¼ŒPolicy Gradient Algorithms è¿™ä¸ªopenaiå°å§å§çš„blogä»‹ç»å¾—æå…¶æ¸…æ¥šï¼Œå¤§å®¶å¯ä»¥å‚è€ƒï¼Œæœ€åå¾—åˆ°temperatureçš„lossï¼š $$J(\\alpha)=\\mathbb{E}_{a_t\\sim\\pi_t}[-\\alpha\\log\\pi_t(a_t\\mid\\pi_t)-\\alpha\\mathcal{H}_0]\\tag{29}$$ ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å®Œæ•´çš„Soft Actor-Criticç®—æ³•ï¼š BP Network ä¸ºäº†æ›´å¿«é€Ÿç¨³å®šçš„è®­ç»ƒï¼Œä½œè€…å¼•å…¥äº†ä¸¤ä¸ªQç½‘ç»œï¼Œç„¶åæ¯æ¬¡é€‰æ‹©Qå€¼å°çš„ä¸€ä¸ªä½œä¸ºtarget Qå€¼ã€‚æ›´æ–°Qï¼ŒPolicyåŠ \\alpha ä½¿ç”¨ä¸Šæ–‡çš„ï¼ˆ24ï¼‰ï¼ˆ27ï¼‰ï¼ˆ29ï¼‰ä¸‰ä¸ªå…¬å¼ã€‚ ","date":"2024-05-04","objectID":"/posts/sac/:6:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["RL"],"content":"7 ç¥ç»ç½‘ç»œç»“æ„ è™½ç„¶ä¸Šé¢æŠŠç®—æ³•æµç¨‹ç¡®å®šäº†ï¼Œä½†æ˜¯å¦‚ä½•æ„é€ policyçš„ç¥ç»ç½‘ç»œè¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚ä¸‹å›¾æ˜¯å¸¦Vç½‘ç»œçš„ç¥ç»ç½‘ç»œç»“æ„å›¾ï¼š BP Network https://nervanasystems.github.io/coach/components/agents/policy_optimization/sac.html æˆ‘ä»¬ä¸»è¦æ¥æ¢ç©¶ä¸€ä¸‹Policyç½‘ç»œçš„è®¾è®¡ã€‚ è§ä¸Šå›¾å³ä¸Šè§’çš„Policyç½‘ç»œï¼Œå‰é¢çš„input embedderå’ŒMiddlewareä¸ç”¨è¯´ï¼Œå°±æ˜¯å‡ å±‚çš„MLPã€‚ç„¶åï¼Œæ¥ä¸‹æ¥ç¥ç»ç½‘ç»œåˆ†æˆä¸¤ä¸ªåˆ†æ”¯ï¼Œåˆ†åˆ«è¾“å‡ºå¹³å‡å€¼mean $\\mu$ å’Œlog æ ‡å‡†å·® log std ã€‚ç„¶åä½¿ç”¨expå¾—åˆ°stdã€‚ $$\\pi_\\phi(s_t) = \\mu_t,\\log \\sigma_t \\tag{30}$$ $$\\sigma_t = \\exp(\\log \\sigma_t)$$ æ­£å¸¸è¾“å‡ºè¿™æ ·çš„é«˜æ–¯åˆ†å¸ƒä½œä¸ºaction çš„åˆ†å¸ƒdistributionæ˜¯OKçš„ï¼Œä½†æ˜¯åœ¨å®é™…ä¸­ï¼Œè¿™ä¸ªactionéœ€è¦é™å®šåœ¨ä¸€å®šèŒƒå›´å†…ã€‚å› æ­¤ï¼Œè¿™é‡Œä½œè€…ä½¿ç”¨äº†squashing function tanhï¼Œå°†actioné™åˆ¶åœ¨ï¼ˆ-1,1ï¼‰ä¹‹é—´ï¼Œå³ $$\\mathbf{u}_t =\\mu_t + \\varepsilon_t \\odot \\sigma_t $$ $$a_t = \\tanh (\\mathbf{u}) \\tag{31}$$ è¿™é‡Œå’Œä¸Šæ–‡çš„å…¬å¼ï¼ˆ26ï¼‰å¯¹åº”ï¼Œå¤šäº†ä¸€ä¸ªtanhã€‚ é‚£ä¹ˆè¿™ä¼šå¯¼è‡´åˆ†å¸ƒçš„å˜åŒ–ï¼Œä»è€Œå½±å“log likelihoodçš„è®¡ç®—ï¼Œè€Œè¿™æ˜¯æˆ‘ä»¬è®¡ç®—SACçš„losså¿…é¡»çš„ã€‚ä½œè€…åœ¨paperä¸­ç»™å‡ºäº†è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š $$\\log \\pi(a|s)=\\log \\mu(\\mathbf{u}|s)-\\sum_{i=1}^{D}{\\log(1-\\tanh^2(u_i))} \\tag{32}$$ å…¶ä¸­ u_i æ˜¯ $\\mathbf{u}$ çš„ç¬¬iä¸ªå…ƒç´ ã€‚è¿™é‡Œçš„ $\\mu(\\mathbf{u}|s)$ æ˜¯æ²¡æœ‰åŠ é™åˆ¶æ—¶çš„likelihood functionä¹Ÿå°±æ˜¯é«˜æ–¯åˆ†å¸ƒçš„likelihood functionä¼¼ç„¶å‡½æ•°ã€‚é«˜æ–¯åˆ†å¸ƒçš„log likelihoodç›´æ¥ä½¿ç”¨pytorchçš„Normal classå°±å¯ä»¥è·å¾—ã€‚ ","date":"2024-05-04","objectID":"/posts/sac/:7:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["RL"],"content":"8 å…¶ä»–ç»†èŠ‚ 1ï¼‰SACé‡Œçš„target entropy è®¾è®¡ä¸º $$\\mathcal{H}_0 = -\\dim (\\mathcal{A}) \\tag{33}$$ å³-åŠ¨ä½œæ•°é‡ã€‚ 2ï¼‰SAC paperé‡Œå®Œå…¨æ²¡æœ‰è¯´æ˜çš„è®­ç»ƒæ—¶çš„episodeè®¾ç½®ã€‚SACè®¾ç½®ä¸ºæ¯ä¸€ä¸ªepisodeé‡‡æ ·1000æ¬¡ç„¶åè®­ç»ƒ1000æ¬¡ã€‚ 3ï¼‰åœ¨ä»£ç ä¸­SACä½¿ç”¨ log alphaä½œä¸ºæ›´æ–°çš„å‚æ•°ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨alphaå¦‚å…¬å¼ï¼ˆ25ï¼‰ï¼Œè¿™å’Œè¾“å‡ºlog stdæ˜¯ä¸€æ ·çš„ï¼Œä½¿ç”¨logæœ‰å¾ˆå¤§çš„æ­£è´ŸèŒƒå›´ï¼Œæ›´æ–¹ä¾¿ç½‘ç»œè¾“å‡ºã€‚å¦åˆ™alphaæˆ–è€…stdéƒ½æ˜¯æ­£å€¼ã€‚ 4ï¼‰SACæœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œå®ƒçš„policyçš„ç›®çš„æ˜¯è¶‹è¿‘äºç»å°”å…¹æ›¼åˆ†å¸ƒï¼Œä½†æ˜¯å®é™…å®ç°çš„æ—¶å€™ï¼Œä¸ºäº†èƒ½å¤Ÿtractableï¼Œé€‰æ‹©äº†è¾“å‡ºä¸€ä¸ªé«˜æ–¯ï¼Œä¹Ÿå°±æ˜¯è®©é«˜æ–¯è¶‹è¿‘äºç»å°”å…¹æ›¼åˆ†å¸ƒã€‚è¿™æ„å‘³ç€SACæœ¬è´¨ä¸Šè¿˜æ˜¯unimodalçš„ç®—æ³•ï¼Œè€Œä¸æ˜¯soft q-learningçš„multi-modalã€‚è¿™ä½¿å¾—SACçš„åˆ›æ–°æ€§æ‰“äº†å¾ˆå¤§çš„æŠ˜æ‰£ã€‚ä½†æ˜¯ç®—æ³•æ•ˆæœç¡®å®è¿˜æ˜¯ä¸é”™çš„ã€‚ ","date":"2024-05-04","objectID":"/posts/sac/:8:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["RL"],"content":"9 å°ç»“ æœ¬æ–‡ä»ç†è®ºåˆ°å…·ä½“å®ç°å±‚é¢å‰–æäº†Soft Actor-Criticè¿™ä¸€ç›®å‰æå¼ºçš„DRLç®—æ³•ï¼ŒåŸºæœ¬ä¸Šç†è§£äº†æœ¬æ–‡çš„åˆ†æï¼Œå¯¹äºä»£ç çš„å®ç°ä¹Ÿå°±å¯ä»¥äº†ç„¶ä¸€èƒ¸äº†ã€‚ ç”±äºæœ¬äººæ°´å¹³æœ‰é™ï¼Œå‰é¢çš„ç†è®ºåˆ†æææœ‰é”™è¯¯ï¼Œæœ›æ‰¹è¯„æŒ‡æ­£ï¼ ref: [1]. https://zhuanlan.zhihu.com/p/70360272 ","date":"2024-05-04","objectID":"/posts/sac/:9:0","tags":["SAC"],"title":"å¼ºåŒ–å­¦ä¹  | æ·±åº¦è§£è¯»Soft Actor-Critic ç®—æ³•","uri":"/posts/sac/"},{"categories":["LLM"],"content":"0. å¼•è¨€ BP Network æœ€è¿‘ç«å‡ºåœˆçš„ğŸš€ ChatGPT ä¸­ RLHF ä¸»è¦é‡‡ç”¨äº†å°±æ˜¯ PPO è¿›è¡Œå¼ºåŒ–å­¦ä¹ è®­ç»ƒ ä¸»è¦è¿ç”¨åœ¨å¾®è°ƒé˜¶æ®µï¼ˆå¾®è°ƒæ•´ä¸ª 10Bï½100B+ å‚æ•°çš„æˆæœ¬å…¶å®ä¹Ÿéå¸¸é«˜ ï¼‰ä½¿ç”¨ç­–ç•¥æ¢¯åº¦å¼ºåŒ–å­¦ä¹  (Policy Gradient RL) ç®—æ³•ã€è¿‘ç«¯ç­–ç•¥ä¼˜åŒ– (PPO) å¾®è°ƒåˆå§‹ LM çš„éƒ¨åˆ†æˆ–å…¨éƒ¨å‚æ•°ã€‚ BP Network ä»¥ä¸‹ä¸»è¦å‚è€ƒå°å¤§æå®æ¯…çš„æ¨å¯¼è¿‡ç¨‹ ","date":"2024-05-04","objectID":"/posts/chatgpt_rlhf/:1:0","tags":["RLHF","ChatGPT"],"title":"ä¸€æ–‡è¯¦è§£ ChatGPT RLHF èƒŒåçš„ PPO å¼ºåŒ–å­¦ä¹ è®­ç»ƒ","uri":"/posts/chatgpt_rlhf/"},{"categories":["LLM"],"content":"01. Vanilla policy gradient åŠ¨ä½œ/ç¯å¢ƒ/å¥–åŠ±ä¹‹é—´çš„å…³ç³»ï¼š BP Network è½¨è¿¹å¯è¡¨ç¤ºä¸ºé›†åˆ $$\\begin{aligned}p_{\\theta}(\\tau)\u0026=p(s_1)p_\\theta(a_1|s_1)p(s_2|s_1,a_1)p_\\theta(a_1|s_1)p(s_3|s_2,a_2)\\ldots\\\\\u0026=p(s_1)\\prod_{t=1}^Tp_\\theta(a_t|s_t)p(s_{t+1}|s_t,a_t)\\end{aligned}$$ BP Network ä¸€ä¸ªè½¨è¿¹çš„å¥–åŠ±æ€»å’Œä¸ºï¼š $$R(\\tau)=\\sum_{t=1}^Tr_t$$ åˆ™å¥–åŠ±çš„æœŸæœ›ä¸ºï¼š $$\\bar{R}_\\theta=\\sum_\\tau R(\\tau)p_\\theta(\\tau)=E_{\\tau\\sim p_\\theta(\\tau)}[R(\\tau)]$$ å°† $R(\\tau)$ çœ‹æˆå¸¸é‡ï¼Œå¯¹å…¶æ±‚å¾®åˆ†ï¼š $$\\begin{aligned} \\nabla\\bar{R}_{\\theta}\u0026 =\\sum_{\\tau}R(\\tau)\\nabla p_{\\theta}(\\tau) \\\\ \u0026=\\sum_{\\tau}R(\\tau)p_{\\theta}(\\tau)\\frac{\\nabla p_{\\theta}(\\tau)}{p_{\\theta}(\\tau)} \\\\ \u0026=\\sum_{\\tau}R(\\tau)p_{\\theta}(\\tau)\\nabla\\log p_{\\theta}(\\tau)\\quad\\nabla f(x)=f(x)\\nabla\\log f(x) \\\\ \u0026=E_{\\tau\\sim p_{\\theta}(\\tau)}[R(\\tau)\\nabla\\log p_{\\theta}(\\tau)]\u0026 \\left(2\\right) \\\\ \u0026\\approx\\frac1N\\sum_{n=1}^{N}R(\\tau^{n})\\nabla\\log p_{\\theta}(\\tau^{n}) \\\\ \u0026=\\frac1N\\sum_{n=1}^N\\sum_{t=1}^{T_n}R(\\tau^n)\\nabla\\log p_\\theta(a_t^n|s_t^n) \\end{aligned}$$ ç­–ç•¥ç½‘ç»œæ¢¯åº¦æ›´æ–°ï¼š BP Network å¯ä»¥çœ‹æˆä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼ˆæ¸¸æˆä¸­é€šè¿‡é”®ç›˜è¾“å…¥æ¥äº’åŠ¨ï¼Œåˆ†ç±»ç±»åˆ«ä¸ºæ‰€æœ‰å¯æ“ä½œçš„é”®ä½ï¼‰ï¼š BP Network ç†æƒ³æƒ…å†µä¸‹ï¼Œ å¹¶ä¸ä¸€ç›´ä¸ºæ­£æ•°ï¼Œå¢åŠ ä¸€ä¸ª baseline: $$\\nabla\\bar{R}_{\\theta}=\\frac{1}{N}\\sum_{n=1}^{N}\\sum_{t=1}^{{T_{n}}}(R(\\tau^{n})-b)\\nabla\\log p_{\\theta}(a_{t}^{n}|s_{t}^{n})b\\approx E[R(\\tau)]$$ åœ¨ç”µå­æ¸¸æˆä¸­ï¼Œå¥–åŠ±å€¼å¸¸å¸¸ä¸ºæ­£ï¼ˆé€šå¸¸ä¸ºæ¸¸æˆåˆ†æ•°ï¼‰ã€‚è¿™æ—¶éœ€è¦å¢åŠ ä¸€ä¸ªåç½®æ¥ä¿è¯åŒæ—¶æœ‰æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬ åˆ†é…åˆé€‚çš„å­¦åˆ† ä¸€ä¸ªé«˜åˆ†çš„æ¸¸æˆè½¨è¿¹ä¸­ä¹Ÿå¯èƒ½å­˜åœ¨é”™è¯¯çš„åŠ¨ä½œï¼ŒåŒæ ·çš„ï¼Œä¸€ä¸ªä½åˆ†çš„æ¸¸æˆè½¨è¿¹ä¹Ÿå¯èƒ½å­˜åœ¨æ­£ç¡®çš„åŠ¨ä½œï¼Œè€Œä¸Šæ–‡ä¸­çš„è®¡ç®—å°†æœ€åçš„å¥–åŠ±å€¼ï¼ˆæœ€åçš„æ¸¸æˆåˆ†æ•°ï¼‰éƒ½ä¸€è§†åŒä»è§†ä¸ºè¯¥æ¸¸æˆè½¨è¿¹æ¯ä¸ªåŠ¨ä½œçš„å­¦åˆ†ã€‚ ä¸ºäº†æ›´å‡†ç¡®åœ°æè¿°æ¯ä¸ªåŠ¨ä½œæ‰€å¾—åˆ°çš„å­¦åˆ†ï¼Œå°†ä¸€ä¸ªåŠ¨ä½œæ‰§è¡Œåå¯¹åº”çš„å­¦åˆ†ä¸ºåç»­çš„æ‰€æœ‰å¥–åŠ±å€¼çš„æ€»å’Œ BP Network $$\\begin{aligned} \\nabla\\bar{R}_\\theta\u0026 =\\frac1N\\sum_{n=1}^N\\sum_{t=1}^{T_n}(R(\\tau^n)-b)\\nabla\\log p_\\theta(a_t^n|s_t^n) \\Downarrow\\nabla\\bar{R}_\\theta \\\\ \u0026= \\frac1N\\sum_{n=1}^N\\sum_{t=1}^{T_n}(\\sum_{t^{\\prime}=t}^{T_n}r_{t^{\\prime}}^n-b)\\nabla\\log p_\\theta(a_t^n|s_t^n) \\end{aligned}$$ å½“æŸä¸ªåŠ¨ä½œæ‰§è¡Œä»¥åï¼Œå…¶å¯¹åç»­çš„å¥–åŠ±åˆ†æ•°çš„å½±å“åœ¨æ…¢æ…¢å‡å°‘ï¼Œå†å¢åŠ ä¸€ä¸ªè¡°å‡å› å­ï¼š $$\\begin{aligned} \\nabla\\bar{R}_\\theta\u0026 =\\frac1N\\sum_{n=1}^N\\sum_{t=1}^{T_n}(\\sum_{t^{\\prime}=t}^{T_n}r_{t^{\\prime}}^n)\\nabla\\log p_\\theta(a_t^n|s_t^n)\\Downarrow\\nabla\\bar{R}_\\theta \\\\ \u0026 = \\frac{1}{N}\\sum_{n=1}^{N}\\sum_{t=1}^{T_{n}}(\\sum_{t^{\\prime}=t}^{T_{n}}\\gamma^{t^{\\prime}-t}r_{t^{\\prime}}^{n}-b)\\nabla\\log p_{\\theta}(a_{t}^{n}|s_{t}^{n}),\\gamma\u003c1 \\end{aligned}$$ ","date":"2024-05-04","objectID":"/posts/chatgpt_rlhf/:2:0","tags":["RLHF","ChatGPT"],"title":"ä¸€æ–‡è¯¦è§£ ChatGPT RLHF èƒŒåçš„ PPO å¼ºåŒ–å­¦ä¹ è®­ç»ƒ","uri":"/posts/chatgpt_rlhf/"},{"categories":["LLM"],"content":"02. ä»on-policyåˆ°off-policy ä¸¤è€…åŒºåˆ«: On-policy: å­¦ä¹ åˆ°çš„ agent å’Œä¸ç¯å¢ƒäº¤äº’çš„ agent æ˜¯ç›¸åŒçš„ï¼Œæ¯ä¸€æ¬¡æ¢¯åº¦æ›´æ–°éƒ½éœ€è¦é‡æ–°é‡‡æ · Off-policy: å­¦ä¹ åˆ°çš„ agent å’Œä¸ç¯å¢ƒäº¤äº’çš„ agent æ˜¯ä¸åŒçš„ï¼Œæ¯æ¬¡æ¢¯åº¦æ›´æ–°ä¸éœ€è¦é‡æ–°é‡‡æ · é‡æ–°çœ‹çœ‹ çš„è¡¨è¾¾å¼ï¼š $$\\nabla\\bar{R}_\\theta=E_{\\tau\\sim p_\\theta(\\tau)}[R(\\tau)\\nabla\\log p_\\theta(\\tau)]$$ ä½¿ç”¨ç­–ç•¥ç½‘ç»œ æ”¶é›†æ•°æ®ã€‚å½“ æ›´æ–°åï¼Œåˆ™éœ€è¦é‡æ–°æ”¶é›†è®­ç»ƒæ ·æœ¬ ç›®æ ‡ï¼šä½¿ç”¨ç›¸åŒçš„æ ·æœ¬ï¼ˆé€šè¿‡ é‡‡æ ·ï¼‰è®­ç»ƒ ã€‚å…¶ä¸­ ä¸ºå›ºå®šçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é‡å¤ä½¿ç”¨å…¶æ ·æœ¬æ•°æ® ","date":"2024-05-04","objectID":"/posts/chatgpt_rlhf/:3:0","tags":["RLHF","ChatGPT"],"title":"ä¸€æ–‡è¯¦è§£ ChatGPT RLHF èƒŒåçš„ PPO å¼ºåŒ–å­¦ä¹ è®­ç»ƒ","uri":"/posts/chatgpt_rlhf/"},{"categories":["LLM"],"content":"2.1 é‡è¦æ€§é‡‡æ ·ï¼ˆImportance Samplingï¼‰ è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼Œå‡å¦‚æ­£åœ¨å°è¯•è®¡ç®—å‡½æ•° $f(x)$ çš„æœŸæœ›å€¼ï¼Œå…¶ä¸­ $x \\sim f(x)$ æœä»æŸç§åˆ†å¸ƒã€‚åˆ™å¯¹ $E(f(x))$ æœ‰ä»¥ä¸‹ä¼°è®¡ï¼š $$E_{x\\sim p}[f(x)]=\\int f(x)p(x)dx\\approx\\frac{1}{n}\\sum_{i}f(x_{i})$$ è’™ç‰¹å¡æ´›æŠ½æ ·æ–¹æ³•æ˜¯ç®€å•åœ°ä»åˆ†å¸ƒ $p(x)$ ä¸­æŠ½å‡º ï¼Œç„¶åå–æ‰€æœ‰æ ·æœ¬çš„å¹³å‡å€¼æ¥å¾—åˆ°æœŸæœ›å€¼çš„ä¼°è®¡ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœ $p(x)$ éå¸¸éš¾å–æ ·æ€ä¹ˆåŠï¼Ÿæ˜¯å¦èƒ½å¤Ÿæ ¹æ®ä¸€äº›å·²çŸ¥çš„ã€å®¹æ˜“æŠ½æ ·çš„åˆ†å¸ƒæ¥ä¼°è®¡æœŸæœ›å€¼ï¼Ÿ ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚å…¬å¼çš„ä¸€ä¸ªç®€å•è½¬æ¢å°±å¯ä»¥åšåˆ° $$E_{x\\sim p}[f(x)]=\\int f(x)p(x)dx=\\int f(x)\\frac{p(x)}{q(x)}q(x)dx=E_{x\\sim q}[f(x)\\frac{p(x)}{q(x)}]$$ å…¶ä¸­$x$ä»åˆ†å¸ƒ$q(x)$ä¸­é‡‡æ ·ï¼Œ$q(x)$ä¸åº”ä¸º 0ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¼°è®¡æœŸæœ›èƒ½å¤Ÿä»å¦ä¸€ä¸ªåˆ†å¸ƒ$q(x)$ä¸­é‡‡æ ·ï¼Œ$p(x)/q(x)$æ˜¯ç§°ä¸ºé‡‡æ ·ç‡æˆ–é‡‡æ ·æƒé‡ï¼Œå®ƒä½œä¸ºæ ¡æ­£æƒé‡ä»¥æŠµæ¶ˆæ¥è‡ªä¸åŒåˆ†å¸ƒçš„æ¦‚ç‡é‡‡æ ·ã€‚ é‡è¦æ€§é‡‡æ ·çš„ç¼ºé™· è™½ç„¶é‡è¦æ€§é‡‡æ ·ä¿è¯äº†æœŸæœ›çš„ä¸€è‡´ï¼Œä½†æ˜¯è¿™é‡Œæ¥è®¡ç®—ä¸€ä¸‹æ–¹å·®æ˜¯å¦ä¸€è‡´ æ–¹å·®çš„è®¡ç®—ï¼š $$Var[X]=E[X^2]-(E[X])^2$$ åˆ†åˆ«è®¡ç®—æ–¹å·®ï¼š $$\\begin{aligned}Var_{x\\sim p}[f(x)]\u0026=E_{x\\sim p}[f(x)^2]-(E_{x\\sim p}[f(x)])^2\\\\Var_{x\\sim q}[f(x)\\frac{p(x)}{q(x)}]\u0026=E_{x\\sim q}[(f(x)\\frac{p(x)}{q(x)})^2]-(E_{x\\sim q}[f(x)\\frac{p(x)}{q(x)}])^2\\\\\u0026=E_{x\\sim p}[f(x)^2\\frac{p(x)}{q(x)}]-(E_{x\\sim p}[f(x)])^2\\end{aligned}$$ å¯ä»¥å‘ç°ä¸¤è€…è™½ç„¶æœŸæœ›ç›¸ç­‰ä½†æ–¹å·®å¹¶ä¸ä¸€è‡´ ","date":"2024-05-04","objectID":"/posts/chatgpt_rlhf/:3:1","tags":["RLHF","ChatGPT"],"title":"ä¸€æ–‡è¯¦è§£ ChatGPT RLHF èƒŒåçš„ PPO å¼ºåŒ–å­¦ä¹ è®­ç»ƒ","uri":"/posts/chatgpt_rlhf/"},{"categories":["LLM"],"content":"2.2 ä» on-policy åˆ° off-policy æˆ‘ä»¬ä½¿ç”¨é‡è¦æ€§é‡‡æ ·å°† on-policy è°ƒæ•´ä¸º off-policy $$\\nabla\\bar{R}_\\theta=E_{\\tau\\sim p_{\\theta^{\\prime}}(\\tau)}[\\frac{p_\\theta(\\tau)}{p_{\\theta^{\\prime}}(\\tau)}R(\\tau)\\nabla\\log p_\\theta(\\tau)]$$ ä» $\\thetaâ€™$ é‡‡æ ·å¾—åˆ°æ•°æ®é›† ä½¿ç”¨è¯¥ æ•°æ®é›†å¤šæ¬¡è®­ç»ƒ $\\theta$ æ¢¯åº¦æ›´æ–°è¿‡ç¨‹ï¼š $$\\begin{aligned} \u0026=E_{(s_t,a_t)\\sim\\pi_\\theta}[A^\\theta(s_t,a_t)\\nabla\\log p_\\theta(a_t^n|s_t^n)] \\\\ \u0026=E_{(s_t,a_t)\\sim\\pi_{\\theta^{\\prime}}}[\\frac{p_\\theta(s_t,a_t)}{p_{\\theta^{\\prime}}(s_t,a_t)}A^{\\theta^{\\prime}}(s_t,a_t)\\nabla\\log p_\\theta(a_t^n|s_t^n)] \\\\ \u0026=E_{(s_t,a_t)\\sim\\pi_{\\theta^{\\prime}}}[\\frac{p_\\theta(a_t|s_t)}{p_{\\theta^{\\prime}}(a_t|s_t)}\\frac{p_\\theta(s_t)}{p_{\\theta^{\\prime}}(s_t)}A^{\\theta^{\\prime}}(s_t,a_t)\\nabla\\log p_\\theta(a_t^n|s_t^n)]\u0026 \\text{(4)} \\\\ \u0026=E_{(s_t,a_t)\\sim\\pi_{\\theta^{\\prime}}}[\\frac{p_\\theta(a_t|s_t)}{p_{\\theta^{\\prime}}(a_t|s_t)}A^{\\theta^{\\prime}}(s_t,a_t)\\nabla\\log p_\\theta(a_t^n|s_t^n)] \\end{aligned}$$ å…¶ä¸­ $A^\\theta(s_t,a_t)$ æŒ‡çš„æ˜¯ advantage å‡½æ•°,å…¶è®¡ç®—æ–¹å¼ä¸ºåŠ ä¸Šè¡°å‡æœºåˆ¶åçš„å¥–åŠ±å€¼å¹¶å‡å»åŸºçº¿ã€‚ ç”±äº $\\frac{p_\\theta(s_t)}{p_{\\thetaâ€™}(s_t)}$ çš„å€¼éš¾ä»¥è®¡ç®—ï¼Œå°†å…¶è®¾ç½®ä¸º 1ï¼Œç®€åŒ–è®¡ç®— ç›®æ ‡å‡½æ•°å¯ä»¥è¡¨ç¤ºä¸ºï¼š ç”±äº $\\nabla f(x)=f(x)\\nabla\\log f(x)$ å†ç»“åˆä¸å®šç§¯åˆ†ï¼Œç›®æ ‡å‡½æ•°å¯ä»¥è¡¨ç¤ºä¸º: $$J^{\\thetaâ€™}(\\theta)=E_{(s_t,a_t)\\sim\\pi_{\\thetaâ€™}}[\\frac{p_\\theta(a_t|s_t)}{p_{\\thetaâ€™}(a_t|s_t)}A^{\\thetaâ€™}(s_t,a_t)]$$ ","date":"2024-05-04","objectID":"/posts/chatgpt_rlhf/:3:2","tags":["RLHF","ChatGPT"],"title":"ä¸€æ–‡è¯¦è§£ ChatGPT RLHF èƒŒåçš„ PPO å¼ºåŒ–å­¦ä¹ è®­ç»ƒ","uri":"/posts/chatgpt_rlhf/"},{"categories":["LLM"],"content":"03. PPO/TRPO ä¸ºäº†æ¶ˆé™¤é‡è¦æ€§é‡‡æ ·çš„ç¼ºé™·çš„å½±å“ï¼Œä»¥ä¸‹ä¸ºä¸¤ç§æ–¹å¼ PPOï¼ˆProximal Policy Optimizationï¼‰ åˆå§‹åŒ–ç­– ç•¥ç½‘ç»œå‚æ•° åœ¨æ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­: ç›®æ ‡å‡½æ•°: ä½¿ç”¨ ä¸ç¯å¢ƒäº’åŠ¨ä»¥æ”¶é›† ï¼Œå¹¶è®¡ç®—å‡º advantage å€¼ æ›´æ–° ä¼˜åŒ– ç®—æ³•: $$\\begin{aligned} PPO algorithm: \\\\ J_{PPO}^{\\theta^k}(\\theta) \u0026 = J^{\\theta^k}(\\theta)-\\beta KL(\\theta,\\theta^k)J^{\\theta^k}(\\theta) \\\\ \u0026 = E_{(s_{t},a_{t})\\sim\\pi_{\\theta^{k}}}[\\frac{p_{\\theta}(a_{t}|s_{t})}{p_{\\theta^{k}}(a_{t}|s_{t})}A^{\\theta^{k}}(s_{t},a_{t})] \\\\ \u0026 \\approx \\sum_{(s_{t},a_{t})}\\frac{p_{\\theta}(a_{t}|s_{t})}{p_{\\theta^{k}}(a_{t}|s_{t})}A^{\\theta^{k}}(s_{t},a_{t}) \\end{aligned}$$ è‡ªé€‚åº” KL æƒ©ç½šï¼šå¦‚æœ $KL(\\theta,\\theta^k)\u003eKL_{\\max}$ ,å¢å¤§ $\\beta$; å¦‚æœ $KL(\\theta,\\theta^k) \u003cKL_{\\min}$,å‡å° $\\beta$ã€‚ BP Network TRPOï¼ˆTrust Region Policy Optimizatioï¼‰ $$J_{TRPO}^{\\thetaâ€™}(\\theta)=E_{(s_t,a_t)\\sim\\pi_{\\thetaâ€™}}[\\frac{p_\\theta(a_t|s_t)}{p_{\\thetaâ€™}(a_t|s_t)}A^{\\thetaâ€™}(s_t,a_t)]KL(\\theta,\\thetaâ€™)\u003c\\delta $$ TRPO å’Œ PPO åœ¨å„ä¸ªæµ‹è¯•ä¸Šæ€§èƒ½å·®ä¸å¤šã€‚ä½†ç›¸æ¯” PPO ï¼ŒTRPO è®¡ç®—è¦æ›´å¤æ‚ å‚è€ƒæ–‡çŒ®: [1] https://spinningup.openai.com/en/latest/algorithms/ppo.html [2] https://openai.com/research/openai-baselines-ppo [3] https://huggingface.co/blog/deep-rl-ppo [4] https://huggingface.co/blog/rlhf [5] https://mp.weixin.qq.com/s/zhkNDNDEJV3BEdcgeuHkOA ","date":"2024-05-04","objectID":"/posts/chatgpt_rlhf/:4:0","tags":["RLHF","ChatGPT"],"title":"ä¸€æ–‡è¯¦è§£ ChatGPT RLHF èƒŒåçš„ PPO å¼ºåŒ–å­¦ä¹ è®­ç»ƒ","uri":"/posts/chatgpt_rlhf/"},{"categories":["LLM"],"content":"0. å¼•è¨€ åœ¨ChatGPTå¼•é¢†çš„å¤§å‹è¯­è¨€æ¨¡å‹æ—¶ä»£ï¼Œå›½å†…å¤–çš„å¤§æ¨¡å‹å‘ˆç°çˆ†å‘å¼å‘å±•ï¼Œå°¤å…¶æ˜¯ä»¥å¹´åˆçš„LLaMAæ¨¡å‹ä¸ºé¦–çš„å¼€æºå¤§æ¨¡å‹å’Œæœ€è¿‘ç™¾å·æ™ºèƒ½çš„baichuanæ¨¡å‹ï¼Œä½†æ— ä¸€ä¾‹å¤–ï¼Œéƒ½ä½¿ç”¨äº†ã€ŒåŸºäºäººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹ ã€ï¼ˆRLHFï¼‰æ¥æå‡è¯­è¨€æ¨¡å‹çš„æ€§èƒ½ï¼Œå¹¶åœ¨æ¨¡å‹é‡æ³¨å…¥äº†äººç±»çš„åå¥½ï¼Œä»¥æé«˜æ¨¡å‹çš„æœ‰ç”¨æ€§å’Œå®‰å…¨æ€§ã€‚ä¸è¿‡RLHFä¹Ÿæ—©å·²æ›´æ–°æ¢ä»£ï¼Œæˆ‘ä»¬ä»¥å¦‚ä¸‹ç›®å½•è¿›è¡Œè¯¦ç»†è®²è¿°RLHFåŠå…¶å˜ç§ï¼š LLMçš„ç»å…¸é¢„è®­ç»ƒPipeline Llama 2ä¸­çš„RLHF RLHFæ›¿ä»£æ–¹æ¡ˆ ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:1:0","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"ä¸€ã€LLMçš„ç»å…¸é¢„è®­ç»ƒPipeline â€‹ ç›®å‰åŸºäºTransformer decoderçš„LLMï¼Œæ¯”å¦‚ChatGPTã€LLaMAã€baichuanç­‰ï¼Œé€šå¸¸éƒ½ä¼šæœ‰åŸºäºé¢„è®­ç»ƒçš„baseæ¨¡å‹å’Œåœ¨baseæ¨¡å‹è‡³å°‘ä½¿ç”¨RLHFå¾®è°ƒçš„Chatæ¨¡å‹ï¼ŒChatæ¨¡å‹çš„è®­ç»ƒä¸€èˆ¬éƒ½åŒ…æ‹¬å¦‚ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼šé¢„è®­ç»ƒï¼Œæœ‰ç›‘ç£å¾®è°ƒå’Œå¯¹é½ã€‚ â€‹ åœ¨é¢„è®­ç»ƒé˜¶æ®µï¼Œæ¨¡å‹ä¼šä»å¤§é‡æ— æ ‡æ³¨æ–‡æœ¬æ•°æ®é›†ä¸­å­¦ä¹ é€šç”¨çŸ¥è¯†ï¼Œç„¶åä½¿ç”¨ã€Œæœ‰ç›‘ç£å¾®è°ƒã€ï¼ˆSFTï¼‰ä¼˜åŒ–æ¨¡å‹ä»¥æ›´å¥½åœ°éµå®ˆç‰¹å®šæŒ‡ä»¤ï¼Œæœ€åä½¿ç”¨å¯¹é½æŠ€æœ¯ä½¿LLMå¯ä»¥æ›´æœ‰ç”¨ä¸”æ›´å®‰å…¨åœ°å“åº”ç”¨æˆ·æç¤ºã€‚ ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:2:0","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"1.1 é¢„è®­ç»ƒï¼ˆPre-trainingï¼‰ é¢„è®­ç»ƒé˜¶æ®µé€šå¸¸éœ€è¦åŒ…å«æ•°åäº¿åˆ°æ•°ä¸‡äº¿ä¸ªtokençš„åºå¤§æ–‡æœ¬è¯­æ–™åº“ï¼Œä½†è®­ç»ƒç›®æ ‡æ˜¯æ¨¡å‹éœ€è¦æ ¹æ®æä¾›çš„æ–‡æœ¬æ¥é¢„æµ‹ã€Œä¸‹ä¸€ä¸ªå•è¯ã€ã€‚ BP Network 1.2 æœ‰ç›‘ç£å¾®è°ƒï¼ˆSupervised Finetuningï¼‰ â€‹SFTçš„è®­ç»ƒè¿‡ç¨‹ç±»ä¼¼Pre-trainingé˜¶æ®µï¼Œä¹Ÿæ˜¯é¢„æµ‹ã€Œä¸‹ä¸€ä¸ªå•è¯ã€ï¼Œä½†æ˜¯éœ€è¦äººå·¥æ ‡æ³¨çš„æŒ‡ä»¤æ•°æ®é›†ï¼Œå…¶ä¸­æ¨¡å‹çš„è¾“å…¥æ˜¯ä¸€ä¸ªæŒ‡ä»¤ï¼ˆæ ¹æ®ä»»åŠ¡çš„ä¸åŒï¼Œä¹Ÿå¯èƒ½åŒ…å«ä¸€æ®µè¾“å…¥æ–‡æœ¬ï¼‰ï¼Œè¾“å‡ºä¸ºæ¨¡å‹çš„é¢„æœŸå›å¤å†…å®¹ã€‚ BP Network æ•°æ®å½¢å¼ç±»ä¼¼äºï¼š Instruction: â€œWrite a limerick about a pelican.â€ æŒ‡ä»¤ï¼šâ€œå†™ä¸€é¦–å…³äºé¹ˆé¹•çš„æ‰“æ²¹è¯—ã€‚â€œ Output: â€œThere once was a pelican so fineâ€¦â€ è¾“å‡ºï¼šâ€œä»å‰æœ‰ä¸€åªé¹ˆé¹•å¾ˆå¥½â€¦â€œ æ¨¡å‹ä¼šæŠŠâ€œWrite a limerick about a pelicanâ€ä½œä¸ºè¾“å…¥ï¼Œé€ä¸ªtokenè¿›è¡Œé¢„æµ‹ï¼Œè¾“å‡ºâ€œThere once was a pelican so fineâ€¦â€ è™½ç„¶ä¸¤ä¸ªé˜¶æ®µéƒ½é‡‡ç”¨ç±»ä¼¼çš„è®­ç»ƒç›®æ ‡ï¼Œä½†æœ‰ç›‘ç£å¾®è°ƒæ•°æ®é›†é€šå¸¸æ¯”é¢„è®­ç»ƒæ•°æ®å°å¾—å¤šï¼ŒæŒ‡ä»¤æ•°æ®é›†éœ€è¦äººç±»ï¼ˆæˆ–å…¶ä»–é«˜è´¨é‡çš„LLMï¼‰æä¾›æ ‡æ³¨ç»“æœï¼Œæ‰€ä»¥æ— æ³•å¤§è§„æ¨¡åº”ç”¨ã€‚ 1.3 å¯¹é½ï¼ˆAlignmentï¼‰ ç¬¬ä¸‰é˜¶æ®µä¾ç„¶æ˜¯å¾®è°ƒï¼Œä¸è¿‡å…¶ä¸»è¦ç›®æ ‡åœ¨äºå°†è¯­è¨€æ¨¡å‹ä¸äººç±»çš„åå¥½ã€ä»·å€¼è§‚è¿›è¡Œå¯¹é½ï¼Œè¿™ä¹Ÿæ˜¯RLHFæœºåˆ¶å‘æŒ¥çš„åœ°æ–¹ã€‚ BP Network ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:2:1","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"äºŒã€Reinforcement Learning with Human Feedback (RLHF) ä¸ŠèŠ‚ï¼Œæˆ‘ä»¬è®¨è®ºäº†ç°ä»£LLMçš„ä¸‰ä¸ªè®­ç»ƒè¿‡ç¨‹ï¼›æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬é‡ç‚¹è®¨è®ºã€Œä¸Šè¿°ä¸¤ä¸ªå¾®è°ƒé˜¶æ®µã€ï¼ˆSupervised Tinetuningå’ŒAlignmentï¼‰ä¸­ä½¿ç”¨çš„RLHFæŠ€æœ¯ã€‚ RLHFä¸»è¦åŒ…æ‹¬ä¸‰æ­¥ï¼š åœ¨é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ä¸Šè¿›è¡Œã€Œæœ‰ç›‘ç£å¾®è°ƒã€ï¼ˆSFTï¼‰ï¼› åœ¨æœ‰ç›‘ç£å¾®è°ƒæ¨¡å‹åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªreward modelï¼ˆRMï¼‰æ¨¡å‹ï¼› åŸºäºRMæ¨¡å‹ä½¿ç”¨PPOç®—æ³•å¾®è°ƒSFTæ¨¡å‹ï¼› ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:3:0","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"2.1 åœ¨é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ä¸Šè¿›è¡Œæœ‰ç›‘ç£å¾®è°ƒ** å…ˆæ”¶é›†ä¸€ä¸ªPromptsé›†åˆï¼Œå¹¶è¦æ±‚æ ‡æ³¨äººå‘˜å†™å‡ºé«˜è´¨é‡çš„å›å¤ï¼Œç„¶åä½¿ç”¨è¯¥æ•°æ®é›†ä»¥ç›‘ç£çš„æ–¹å¼å¾®è°ƒé¢„è®­ç»ƒçš„åŸºç¡€æ¨¡å‹ã€‚ BP Network â€‹è¯¥æ­¥éª¤ä¸ä¸Šå°èŠ‚çš„Supervised Finetuningç±»ä¼¼ï¼Œä½†è¿™æ˜¯RLHFä¸å¯æˆ–ç¼ºçš„ä¸€ä¸ªæ­¥éª¤ã€‚ ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:3:1","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"2.2 åœ¨æœ‰ç›‘ç£å¾®è°ƒæ¨¡å‹åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªRMæ¨¡å‹ å¯¹äºæ¯ä¸ªPromptï¼Œè¦æ±‚æœ‰ç›‘ç£å¾®è°ƒåçš„LLMç”Ÿæˆå››åˆ°ä¹ä¸ªå›å¤ï¼Œå†ç”±æ ‡æ³¨äººå‘˜æ ¹æ®ä¸ªäººåå¥½å¯¹æ‰€æœ‰å›å¤è¿›è¡Œæ’åºã€‚è™½ç„¶æ’åºè¿‡ç¨‹å¾ˆè€—æ—¶ï¼Œä½†å·¥ä½œé‡è¿˜æ˜¯æ¯”ç¬¬ä¸€æ­¥çš„æœ‰ç›‘ç£æ•°æ®é›†æ„å»ºè¦å°‘ä¸€äº›ã€‚ BP Network åœ¨å¤„ç†æ’åºæ•°æ®æ—¶ï¼Œä½¿ç”¨äº†ä¸€ä¸ªå¥–åŠ±æ¨¡å‹RMï¼ŒRMæ¥è‡ªRLHFç¬¬ä¸€æ­¥çš„ã€Œæœ‰ç›‘ç£å¾®è°ƒè¯­è¨€æ¨¡å‹ã€ï¼ˆSFTï¼‰ï¼ŒSFTçš„è¾“å‡ºé€šè¿‡ä¸€ä¸ªå›å½’å±‚ï¼ˆå•ä¸ªè¾“å‡ºèŠ‚ç‚¹ï¼‰è½¬æ¢ä¸ºå¥–åŠ±åˆ†æ•°ï¼Œå³å¯ç§°ä¸ºRMæ¨¡å‹ã€‚ ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:3:2","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"2.3 åŸºäºRMæ¨¡å‹ä½¿ç”¨PPOç®—æ³•å¾®è°ƒSFTæ¨¡å‹ åŸºäºRMæ¨¡å‹ä½¿ç”¨proximal policy optimization (PPO)ç®—æ³•å¾®è°ƒSFTæ¨¡å‹ BP Network PPOçš„å…·ä½“æŠ€æœ¯ç»†èŠ‚å¯ä»¥å‚è€ƒInstructGPTæˆ–ä¸‹é¢çš„è®ºæ–‡åˆ—è¡¨ã€‚ Asynchronous Methods for Deep Reinforcement Learning (2016) ï¼Œhttps://arxiv.org/abs/1602.01783 Proximal Policy Optimization Algorithms (2017)ï¼Œhttps://arxiv.org/abs/1707.06347 Fine-Tuning Language Models from Human Preferences (2020)ï¼Œhttps://arxiv.org/abs/1909.08593 Learning to Summarize from Human Feedback (2022) ï¼Œhttps://arxiv.org/abs/2009.01325 ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:3:3","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"ä¸‰ã€LLaMA 2çš„RLHF** Meta AIåœ¨åˆ›å»ºLlama-2-chatæ¨¡å‹æ—¶ä¹Ÿä½¿ç”¨äº†RLHFæŠ€æœ¯ï¼Œä¸è¿‡ä¸ChatGPTç›¸æ¯”è¿˜æ˜¯æœ‰äº›ç»†å¾®åŒºåˆ«ã€‚ BP Network ç®€å•æ¥è¯´ï¼ŒLlama-2-chatåœ¨ç¬¬ä¸€æ­¥RLHFå¾®è°ƒä¸Šä½¿ç”¨ç›¸åŒçš„æŒ‡ä»¤æ•°æ®ï¼Œä½†åœ¨ç¬¬äºŒæ­¥ä½¿ç”¨äº†ä¸¤ä¸ªå¥–åŠ±æ¨¡å‹ï¼›é€šè¿‡å¤šä¸ªé˜¶æ®µçš„ä¸æ–­è¿›åŒ–ï¼Œå¥–åŠ±æ¨¡å‹ä¹Ÿä¼šæ ¹æ®Llama-2-chatæ¨¡å‹å‡ºç°çš„é”™è¯¯è¿›è¡Œæ›´æ–°ï¼›å¹¶ä¸”å¢åŠ äº†æ‹’ç»é‡‡æ ·ï¼ˆrejection samplingï¼‰æ­¥éª¤ã€‚ ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:4:0","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"3.1 Margin Loss â€‹åœ¨æ ‡å‡†InstructGPTä¸­ä½¿ç”¨çš„RLHF PPOæ–¹æ³•ï¼Œç ”ç©¶äººå‘˜éœ€è¦æ”¶é›†åŒä¸€ä¸ªæç¤ºä¸‹çš„4-9ä¸ªæ¨¡å‹è¾“å‡ºå¹¶è¿›è¡Œæ’åºï¼Œæ¯”å¦‚å››ä¸ªå›å¤çš„æ’åºç»“æœä¸ºA\u003cC\u003c D\u003cBï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°å…­ä¸ªå¯¹æ¯”ç»“æœï¼šA \u003c Cï¼ŒA \u003c D ï¼ŒA \u003c Bï¼ŒC \u003c Dï¼ŒC \u003c Bï¼ŒD \u003c Bã€‚ â€‹Llama 2çš„æ•°æ®é›†ä¹Ÿé‡‡ç”¨ç±»ä¼¼çš„æ–¹å¼ï¼Œä¸è¿‡æ ‡æ³¨äººå‘˜æ¯æ¬¡åªèƒ½çœ‹åˆ°ä¸¤ä¸ªï¼ˆè€Œé4-9ä¸ªï¼‰å›å¤å¹¶è¿›è¡Œå¯¹æ¯”ï¼Œä½†æ–°å¢äº†ä¸€ä¸ªè¾¹é™…ï¼ˆmarginï¼‰æ ‡ç­¾ï¼Œå¯¹æ¯”ç»“æœå¯ä»¥ä¸ºã€Œæ˜¾è‘—æ›´å¥½ã€ï¼ˆsignificantly betterï¼‰å’Œã€Œå¥½çš„ä¸æ˜æ˜¾ã€ï¼ˆnegligibly betterï¼‰ã€‚ åœ¨æ’åºè®­ç»ƒæ—¶ä¸­ï¼ŒLlama 2ç›¸æ¯”InstructGPTå¢åŠ äº†è¾¹é™…æŸå¤±ï¼š $$\\mathcal{L}{\\mathrm{ranking}}=-\\log\\left(\\sigma\\left(r\\theta\\left(x,y_c\\right)-r_\\theta\\left(x,y_r\\right)-m(r)\\right)\\right)$$ å…¶ä¸­ï¼Œ$r_Î¸(xï¼Œy)$æ˜¯æç¤ºxå’Œç”Ÿæˆçš„å›å¤yçš„æ ‡é‡åˆ†æ•°è¾“å‡º; Î¸ä¸ºæ¨¡å‹æƒé‡; Ïƒæ˜¯å°†å±‚è¾“å‡ºè½¬æ¢ä¸ºèŒƒå›´ä»0åˆ°1çš„åˆ†æ•°çš„é€»è¾‘Så½¢å‡½æ•°; $y_c$æ˜¯ç”±æ ‡æ³¨äººå‘˜é€‰æ‹©çš„æ›´ä¼˜å›å¤; $y_r$æ˜¯è¾ƒå·®çš„å›å¤ã€‚$m(r)$å¯ä»¥è°ƒèŠ‚ä¸¤ä¸ªå›å¤ä¹‹é—´çš„å·®å€¼ï¼Œå¦‚æœå¯¹æ¯”ç»“æœä¸ºã€Œæ˜¾è‘—æ›´å¥½ã€ï¼Œåˆ™ä¼šå¢åŠ æ¢¯åº¦å€¼ï¼ŒåŠ å¿«æ›´æ–°é€Ÿåº¦ã€‚ ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:4:1","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"3.2 ä¸¤ä¸ªRMæ¨¡å‹ â€‹Llama 2ä¸­çš„ä¸¤ä¸ªå¥–åŠ±æ¨¡å‹åˆ†åˆ«ä¾§é‡ã€Œæœ‰ç”¨æ€§ã€ï¼ˆhelpfulnessï¼‰å’Œã€Œå®‰å…¨æ€§ã€ï¼ˆsafetyï¼‰ï¼Œç”¨äºæ¨¡å‹ä¼˜åŒ–çš„æœ€ç»ˆå¥–åŠ±å‡½æ•°ä¼šå°†ä¸¤ä¸ªåˆ†æ•°è¿›è¡Œçº¿æ€§ç»„åˆã€‚ BP Network ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:4:2","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"3.3 æ‹’ç»é‡‡æ · â€‹Llama 2çš„ä½œè€…ä½¿ç”¨äº†ä¸€ä¸ªè®­ç»ƒæµæ°´çº¿ï¼ŒåŒæ—¶ä½¿ç”¨PPOå’Œæ‹’ç»é‡‡æ ·ç®—æ³•ï¼Œè¿­ä»£åœ°äº§ç”Ÿå¤šä¸ªRLHFæ¨¡å‹ï¼ˆä»RLHF-V1åˆ°RLHF-V5ï¼‰ï¼Œæ¨¡å‹åœ¨æ‹’ç»é‡‡æ ·æ—¶ä¼šå¾—åˆ°Kä¸ªè¾“å‡ºï¼Œå¹¶ä½¿ç”¨æœ€é«˜å¥–åŠ±çš„è¾“å‡ºæ›´æ–°æ¢¯åº¦ï¼Œè€ŒPPOæ¯æ¬¡åªåŸºäºå•æ ·æœ¬è¿›è¡Œæ›´æ–°ã€‚ BP Network åœ¨ç›‘ç£å¾®è°ƒçš„åˆå§‹é˜¶æ®µä¹‹åï¼Œæ¨¡å‹åªä½¿ç”¨æ‹’ç»é‡‡æ ·è¿›è¡Œè®­ç»ƒï¼Œç„¶åå†ç»“åˆæ‹’ç»é‡‡æ ·å’ŒPPOã€‚ ä»å®éªŒç»“æœæ¥çœ‹ï¼ŒRLHFå¾®è°ƒæ¨¡å‹åœ¨æ— å®³æ€§å’Œæœ‰ç”¨æ€§ä¸Šéƒ½å¾—åˆ°äº†æ”¹å–„ï¼Œå¹¶ä¸”åœ¨æœ€åé˜¶æ®µRLHF-v5ä½¿ç”¨PPOç®—æ³•çš„æ€§èƒ½æœ€å¥½ã€‚ BP Network ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:4:3","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"å››ã€RLHFçš„æ›¿ä»£æ–¹æ¡ˆ BP Network RLHFåœ¨InstructGPTå’ŒLlama 2è®ºæ–‡ä¸­è¢«è¯æ˜æ˜¯æœ‰æ•ˆçš„ï¼Œä½†æ˜¯RLHFçš„è¿‡ç¨‹æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œä¸‹é¢å°†ä»‹ç»ä¸€ä¸‹æœ€è¿‘RLHFçš„æ›¿ä»£æ–¹æ¡ˆï¼š ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:5:0","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"4.1 Constitutional AI: Harmlessness from AI Feedback (Dec 2022, https://arxiv.org/abs/2212.08073) ç ”ç©¶äººå‘˜æå‡ºäº†ä¸€ç§ åŸºäºäººç±»æä¾›çš„è§„åˆ™åˆ—è¡¨çš„è‡ªæˆ‘è®­ç»ƒæœºåˆ¶ã€‚ä¸å‰é¢æåˆ°çš„InstructGPTè®ºæ–‡ç±»ä¼¼ï¼Œä¹Ÿä½¿ç”¨äº†å¼ºåŒ–å­¦ä¹ æ–¹æ³•ã€‚ BP Network ä¸Šå›¾ä¸­çš„ã€Œçº¢é˜Ÿã€ï¼ˆRed Teamï¼‰æŒ‡çš„æ˜¯æµ‹è¯•ç›®æ ‡ç³»ç»Ÿçš„é˜²å¾¡èƒ½åŠ›ï¼Œå³å¤–éƒ¨æˆ–å†…éƒ¨ä¸“å®¶æ¨¡æ‹Ÿæ½œåœ¨å¯¹æ‰‹çš„è¿‡ç¨‹ï¼Œé€šè¿‡æ¨¡ä»¿ç°å®ä¸–ç•Œæ”»å‡»è€…çš„æˆ˜æœ¯ã€æŠ€æœ¯å’Œç¨‹åºæ¥æŒ‘æˆ˜ã€æµ‹è¯•å¹¶æœ€ç»ˆæ”¹è¿›ç³»ç»Ÿã€‚ ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:5:1","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"4.2 The Wisdom of Hindsight Makes Language Models Better Instruction Followers (Feb 2023, https://arxiv.org/abs/2302.05206) ç ”ç©¶äººå‘˜æå‡ºäº†ä¸€ç§**åŸºäºé‡æ–°æ ‡è®°çš„ç›‘ç£å¾®è°ƒæ–¹æ³•HIR**ï¼Œè¯¥æ–¹æ³•åœ¨12ä¸ªBigBenchä»»åŠ¡ä¸Šä¼˜äºRLHFã€‚ â€‹HIRæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿç®€è€Œè¨€ä¹‹ï¼ŒHIRæ–¹æ³•åŒ…æ‹¬ä¸¤ä¸ªæ­¥éª¤ï¼Œå³é‡‡æ ·å’Œè®­ç»ƒã€‚åœ¨é‡‡æ ·æ­¥éª¤ä¸­ï¼ŒPromptå’ŒæŒ‡ä»¤è¾“å…¥ç»™LLMæ¥è·å–ç­”æ¡ˆï¼Œæ ¹æ®å¯¹é½å¾—åˆ†ï¼Œåœ¨è®­ç»ƒé˜¶æ®µé€‚å½“çš„åœ°æ–¹é‡æ–°æ ‡æ³¨æŒ‡ä»¤ï¼›ç„¶åï¼Œé‡æ–°æ ‡è®°çš„æŒ‡ä»¤å’ŒåŸå§‹çš„Promptç”¨äºå¾®è°ƒLLMã€‚ä½¿ç”¨è¿™ç§é‡æ–°æ ‡è®°çš„æ–¹æ³•ï¼Œç ”ç©¶äººå‘˜æœ‰æ•ˆåœ°å°†å¤±è´¥æ¡ˆä¾‹ï¼ˆLLMåˆ›å»ºçš„è¾“å‡ºä¸åŸå§‹æŒ‡ä»¤ä¸åŒ¹é…çš„æ¡ˆä¾‹ï¼‰è½¬åŒ–ä¸ºæœ‰ç”¨çš„è®­ç»ƒæ•°æ®ï¼Œç”¨äºç›‘ç£å­¦ä¹ ã€‚ BP Network ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:5:2","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"4.3 Direct Preference Optimization: Your Language Model is Secretly a Reward Model (https://arxiv.org/abs/2305.18290, May 2023) ç›´æ¥åå¥½ä¼˜åŒ–ï¼ˆDPOï¼‰æ˜¯å…·æœ‰PPOçš„RLHFçš„æ›¿ä»£æ–¹æ¡ˆï¼Œå…¶ä¸­ç ”ç©¶äººå‘˜è¡¨æ˜ï¼Œåœ¨RLHFä¸­æ‹Ÿåˆå¥–åŠ±æ¨¡å‹çš„äº¤å‰ç†µæŸå¤±å¯ä»¥ç›´æ¥ç”¨äºå¾®è°ƒLLMã€‚æ ¹æ®ä»–ä»¬çš„åŸºå‡†ï¼Œä½¿ç”¨DPOæ›´æœ‰æ•ˆï¼Œè€Œä¸”åœ¨å“åº”è´¨é‡æ–¹é¢é€šå¸¸ä¹Ÿä¼˜äºRLHF/PPOã€‚ BP Network ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:5:3","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"4.4 Reinforced Self-Training (ReST) for Language Modeling (Aug 2023, https://arxiv.org/abs/2308.08998) ReSTæ˜¯äººç±»åé¦ˆå¼ºåŒ–å­¦ä¹ ï¼ˆRLHFï¼‰çš„ä¸€ç§æ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒä½¿LLMä¸äººç±»åå¥½ä¿æŒä¸€è‡´ã€‚ ReSTä½¿ç”¨é‡‡æ ·æ–¹æ³•åˆ›å»ºæ”¹è¿›çš„æ•°æ®é›†ï¼Œåœ¨è´¨é‡è¶Šæ¥è¶Šé«˜çš„å­é›†ä¸Šè¿­ä»£è®­ç»ƒï¼Œä»¥å®Œå–„å…¶å¥–åŠ±å‡½æ•°ã€‚æ ¹æ®ä½œè€…çš„è¯´æ³•ï¼Œä¸æ ‡å‡†çš„åœ¨çº¿RLHFæ–¹æ³•ï¼ˆå¦‚å…·æœ‰è¿‘ç«¯ç­–ç•¥ä¼˜åŒ–çš„RLHFï¼ŒPPOï¼‰ç›¸æ¯”ï¼ŒReSTé€šè¿‡ç¦»çº¿ç”Ÿæˆè®­ç»ƒæ•°æ®é›†å®ç°äº†æ›´é«˜çš„æ•ˆç‡ï¼Œä½†ç¼ºå°‘ä¸InstructGPTæˆ–Llama 2ä¸­ä½¿ç”¨çš„æ ‡å‡†RLHF PPOæ–¹æ³•çš„å…¨é¢æ¯”è¾ƒã€‚ BP Network ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:5:4","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"4.5 RLAIF: Scaling Reinforcement Learning from Human Feedback with AI Feedback (Sep 2023, https://arxiv.org/abs/2309.00267) æœ€è¿‘çš„äººå·¥æ™ºèƒ½åé¦ˆå¼ºåŒ–å­¦ä¹ ï¼ˆRLAIFï¼‰ç ”ç©¶è¡¨æ˜ï¼ŒRLHFä¸­å¥–åŠ±æ¨¡å‹è®­ç»ƒçš„è¯„çº§ä¸ä¸€å®šå¿…é¡»ç”±äººç±»æä¾›ï¼Œè€Œæ˜¯å¯ä»¥ç”±LLMç”Ÿæˆï¼ˆæ­¤å¤„ï¼šPaLM 2ï¼‰ã€‚æ ‡æ³¨äººå‘˜åœ¨ä¸€åŠçš„æ¡ˆä¾‹ä¸­æ›´å–œæ¬¢RLAIFæ¨¡å‹ï¼Œä¹Ÿå°±æ„å‘³ç€ä¸¤ä¸ªæ¨¡å‹çš„å·®è·å¹¶ä¸å¤§ï¼ŒRLHFå’ŒRLAIFéƒ½å¤§å¤§ä¼˜äºçº¯é€šè¿‡ç›‘ç£æŒ‡ä»¤å¾®è°ƒè®­ç»ƒçš„æ¨¡å‹ã€‚ BP Network è¿™é¡¹ç ”ç©¶çš„ç»“æœéå¸¸æœ‰ç”¨å’Œæœ‰è¶£ï¼Œå› ä¸ºå®ƒåŸºæœ¬ä¸Šæ„å‘³ç€æˆ‘ä»¬å¯èƒ½èƒ½å¤Ÿä½¿åŸºäºRLHFçš„è®­ç»ƒæ›´åŠ é«˜æ•ˆå’Œå®¹æ˜“ã€‚ç„¶è€Œï¼Œè¿™äº›RLAIFæ¨¡å‹åœ¨ä¸“æ³¨äºä¿¡æ¯å†…å®¹çš„å®‰å…¨æ€§å’ŒçœŸå®æ€§çš„å®šæ€§ç ”ç©¶ä¸­çš„è¡¨ç°è¿˜æœ‰å¾…è§‚å¯Ÿï¼Œè€Œäººç±»åå¥½ç ”ç©¶ä»…éƒ¨åˆ†æ•æ‰åˆ°äº†è¿™ä¸€ç‚¹ã€‚ å‚è€ƒæ–‡çŒ®ï¼š [1] https://magazine.sebastianraschka.com/p/llm-training-rlhf-and-its-alternatives [2] https://mp.weixin.qq.com/s/3Ff6C5zT7fXggQ1FwxvWAQ ","date":"2024-05-04","objectID":"/posts/pretrain_rlhf_one/:5:5","tags":["RLHF"],"title":"LLMé¢„è®­ç»ƒä¹‹RLHFï¼ˆä¸€ï¼‰ï¼šRLHFåŠå…¶å˜ç§","uri":"/posts/pretrain_rlhf_one/"},{"categories":["LLM"],"content":"ä¸‡å­—é•¿æ–‡ï¼ŒCVer è½¬ LLM å­¦ä¹ ç¬”è®°ä¹‹å¤§æ¨¡å‹GPT ç³»åˆ— ","date":"2024-05-03","objectID":"/posts/survey/:0:0","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["LLM"],"content":"å¯¼è¯» æœ¬æ–‡æ˜¯ä½œè€…å¯¹ GPT ç³»åˆ—æ–‡ç« çš„å­¦ä¹ ç¬”è®°ï¼Œä»ä¸ªäººè§’åº¦æ¢³ç†äº† GPT ç³»åˆ—çš„è¿­ä»£é€»è¾‘ï¼Œä»æŠ€æœ¯çš„é€»è¾‘è¿ç»­æ€§å’Œå…³è”æ€§éƒ½æœ‰å¾ˆå¥½çš„è®²è§£ï¼Œç¯‡å¹…è¾ƒé•¿ï¼Œå»ºè®®å¤§å®¶ç‚¹èµæ”¶è—ã€‚ è¿™ä¸ªç³»åˆ—çš„ç¬”è®°ä¸»è¦é¢å‘åƒæˆ‘ä¸€æ ·å·²ç»å…·å¤‡ä¸€å®šçš„æ·±åº¦å­¦ä¹ åŸºç¡€ï¼Œä½†æ˜¯æ–°æ¥è§¦ NLP å’Œå¤§æ¨¡å‹é¢†åŸŸçš„è¯»è€…ï¼Œç›®çš„æ˜¯èƒ½æçº²æŒˆé¢†åœ°å¿«é€ŸæŠŠæ¡è¿™ä¸ªé¢†åŸŸçš„ä¸€ç³»åˆ—å…³é”®å·¥ä½œèŠ‚ç‚¹ã€‚ è¿™ç¯‡ç¬”è®°æ¶µç›–çš„å†…å®¹æœ‰ï¼š GPT-1 è®ºæ–‡ GPT-2 è®ºæ–‡ GPT-3 è®ºæ–‡ InstructGPT è®ºæ–‡ï¼ˆGPT-3.5 èƒŒåçš„æŠ€æœ¯ï¼‰ GPT-4 æŠ€æœ¯æŠ¥å‘Š GPT-4 å¾®è½¯è¯„æµ‹æŠ¥å‘Š GPT-4V å¾®è½¯è¯„æµ‹æŠ¥å‘Š ä½œä¸ºä¸€ä¸ªä» CV è½¬åˆ° LLM çš„æ–°äººï¼Œéš¾å…çŠ¯ä¸€äº›å¸¸è§æˆ–ä½çº§çš„é”™è¯¯ï¼Œæ¬¢è¿ä»»ä½•è¯»è€…åŠæ—¶æŒ‡å‡ºå’Œæ–§æ­£ï¼Œä¹Ÿæ¬¢è¿ä»»ä½•ç•™è¨€è®¨è®ºã€‚ ","date":"2024-05-03","objectID":"/posts/survey/:1:0","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["LLM"],"content":"è¦ç‚¹ (TL;DL) æ³¨é‡èƒ½åŠ›ï¼Œè€Œéè¿‡ç¨‹ï¼šé¢„è®­ç»ƒä»»åŠ¡å…¶å®å½¢å¼ä¸é‡è¦ï¼Œå¯ä»¥æ˜¯ classificationï¼Œå¯ä»¥æ˜¯é¢„æµ‹ next tokenï¼ŒçœŸæ­£é‡è¦çš„æ˜¯ model å’Œ data çš„ scaling upï¼Œä»¥æ­¤å¿«é€Ÿé«˜æ•ˆåœ°å¾—åˆ°ä¸€ä¸ªæœ‰ä¼˜å¼‚æ³›åŒ–èƒ½åŠ›çš„ç‰¹å¾æå–å™¨: data: æ‰¾åˆ°/è®¾è®¡ä¸€ä¸ªèƒ½æŠŠæµ·é‡çš„æ•°æ®ç”¨èµ·æ¥çš„ä»»åŠ¡ï¼Œèƒ½ç”¨çš„æ•°æ®è¶Šå¤šè¶Šå¥½ï¼Œè®­ç»ƒè¶Šå¿«è¶Šå¥½ model: æ¨¡å‹æ€§èƒ½å¯ä»¥éšç€å‚æ•°é‡å·¨é‡åœ°æå‡è€Œä¸ä¼šå¿«é€Ÿé¥±å’Œï¼Œä¸€ä¸ªä¼˜ç§€çš„æ¨¡å‹æ¶æ„æ˜¯ scaling up çš„åŸºç¡€ä¿éšœ ä¸‰ç§èŒƒå¼ï¼š æˆ‘ä»¬å¯ä»¥å°†ä¸“å±ä»»åŠ¡ä¸Šå¾®è°ƒå¾—åˆ°çš„æ¨¡å‹ï¼Œçœ‹æˆä¸€ç§ç”¨æˆ·è¾“å…¥ 0 ä¸ªç‰¹æ®Š tokenï¼Œè§£å†³ 1 ç§ä»»åŠ¡çš„èŒƒå¼ï¼Œæ‰€ä»¥ç¬¬ä¸€èŒƒå¼ä¸‹çš„æ¯ä¸ªæ¨¡å‹åªèƒ½ç”¨äºè§£å†³ä¸€ä¸ªä¸“å±ä»»åŠ¡ã€‚ ç¬¬äºŒèŒƒå¼çš„æ¨¡å‹æ˜¯ä¸ºæ¯ä¸€ç§ä»»åŠ¡å‡†å¤‡ 1 ä¸ªç‰¹æ®Š tokenï¼Œå› æ­¤é€šè¿‡æ”¹å˜è¾“å…¥ tokenï¼Œå°±èƒ½ç”¨ä¸€ä¸ªæ¨¡å‹è§£å†³ä¸åŒçš„ä»»åŠ¡ã€‚ ç¬¬ä¸‰èŒƒå¼çš„æ¨¡å‹æŠŠç‰¹æ®Š token æ›¿æ¢æˆäº†ç‰¹æ®Š token åºåˆ—ï¼Œè€Œè‡ªç„¶è¯­è¨€æ­£å¥½å°±æ˜¯ä¸€ç§æœ€ç¬¦åˆäººç±»ä¹ æƒ¯å’Œç›´è§‰çš„ç‰¹æ®Š token åºåˆ—ã€‚ RLHFï¼š SFT æ¨¡å‹(16 epoch) RM PPO ç»§ç»­è®­ç»ƒå‡ºæ¥çš„æœ€ç»ˆæ¨¡å‹ SFT æ•°æ®(13k æ¡): äººå·¥è®¾è®¡çš„é—®é¢˜ï¼Œäººå·¥æ ‡æ³¨ç­”æ¡ˆ Feedback æ•°æ®(33k æ¡): é’ˆå¯¹ä¸Šé¢äººå·¥è®¾è®¡çš„é—®é¢˜ï¼Œæ¨¡å‹è¾“å‡ºçš„å‡ ä»½ç­”æ¡ˆçš„æ’åºï¼ˆæ‰“åˆ†ï¼‰ PPO ä½¿ç”¨çš„æ•°æ®(31k æ¡): äººå·¥è®¾è®¡çš„é—®é¢˜(ä¸Šé¢çš„æ¨¡å‹æ²¡è§è¿‡çš„æ–°é—®é¢˜)ï¼Œç”¨ RM çš„è¯„åˆ†æ¥ç»§ç»­è®­ç»ƒï¼Œè¿™ä»½æ•°æ®ä¸éœ€è¦äººå·¥æ ‡æ³¨ç­”æ¡ˆ å¯¹ GPT-4 çš„å…¨é¢æ¢ç´¢ï¼š å¿ƒç†å­¦è§’åº¦ï¼šäººç±»æ€ç»´æ˜¯å¿«æ€è€ƒä¸æ…¢æ€è€ƒä¸¤ä¸ªç³»ç»Ÿçš„æ··åˆä½“ï¼Œè€Œ GPT-4 ç›®å‰æ›´ç±»ä¼¼äºå•çº¯çš„å¿«æ€è€ƒ GPT-4 è¿˜æœ‰å“ªäº›å±€é™æ€§ï¼Œä»¥åŠå“ªäº›å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼ˆè§ GPT-4 å¾®è½¯æŠ¥å‘Šï¼‰ GPT-4V çš„å…¨é¢æ¢ç´¢ï¼š æ”¯æŒå“ªäº›è¾“å…¥å’Œå·¥ä½œæ¨¡å¼ åœ¨ä¸åŒé¢†åŸŸå’Œä»»åŠ¡ä¸Šçš„èƒ½åŠ›è´¨é‡å’Œé€šç”¨æ€§å¦‚ä½• æœ‰æ•ˆä½¿ç”¨å’Œæç¤ºæ–¹æ³• æœªæ¥æ–¹å‘ ","date":"2024-05-03","objectID":"/posts/survey/:2:0","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["LLM"],"content":"1. Improving Language Understanding by Generative Pre-Training (2018.06) GPT ç³»åˆ—çš„ç¬¬ä¸€ç¯‡è®ºæ–‡ï¼Œå®šä¸‹äº†çº¯ Transformer-Decoder è·¯çº¿ã€‚ æ·±åº¦å­¦ä¹ çš„æ—©æœŸçªç ´å¾ˆå¤šæ¥è‡ªäº CV é¢†åŸŸï¼Œå…¶ä¸­å¾ˆé‡è¦çš„ä¸€ä¸ªåŸå› æ˜¯ CV æœ‰ ImageNet è¿™ä¸ªç™¾ä¸‡é‡çº§çš„æœ‰æ ‡æ³¨æ•°æ®é›†ï¼Œåœ¨ ImageNet ä¸Šè®­ç»ƒåˆ†ç±»ä»»åŠ¡å¾—åˆ°çš„æ¨¡å‹ Backbone å¤©ç„¶å°±æ˜¯ä¸€ä¸ªä¼˜ç§€çš„å›¾ç‰‡ç‰¹å¾æå–å™¨ï¼ŒåŸºäºè¿™ä¸ªç‰¹å¾æå–å™¨åœ¨ä»»æ„çš„å­ä»»åŠ¡ä¸Šåš fine-tuning æ•ˆæœéƒ½ä¸ä¼šå¤ªå·®ï¼ˆè‡³å°‘èƒ½å±•ç°å‡ºä¸€å®šçš„æ³›åŒ–èƒ½åŠ›ï¼‰ã€‚è€Œ NLP é¢†åŸŸç¼ºå°‘è¿™æ ·å¤§çš„æ•°æ®é›†ï¼Œå› æ­¤ï¼Œä¸€ç›´ä»¥æ¥ NLP æ¨¡å‹å‘åŠ›å¡åœ¨äº†ç‰¹å¾æå–å™¨çš„æ„ç­‘ä¸Šï¼ŒGPT æå‡ºç”¨è®­ç»ƒè¯­è¨€æ¨¡å‹çš„æ–¹å¼æ¥å¾—åˆ°è¿™ä¸ªç‰¹å¾æå–å™¨ï¼Œç„¶åç”¨å®ƒæ¥åšå­ä»»åŠ¡ä¸Šçš„å¾®è°ƒã€‚ è¯­è¨€æ¨¡å‹ç”±äºåšçš„æ˜¯â€œé¢„æµ‹ä¸‹ä¸€ä¸ªè¯â€è¿™æ ·çš„ä¸€ä¸ªä»»åŠ¡ï¼Œå› æ­¤ä¸ä¾èµ–äºäººå·¥æ ‡æ³¨ï¼Œå¯ä»¥å®ç°æµ·é‡æ•°æ®çš„é¢„è®­ç»ƒå’Œæ³›åŒ–ã€‚ GPT å·¥ä½œæ˜¯åœ¨ BERT ä¹‹å‰çš„ï¼Œå¾ˆå¤šçš„ setting éƒ½è¢« BERT ç›´æ¥æ²¿ç”¨äº†ï¼Œæ¯”å¦‚ 12 å±‚ Transformerï¼Œ768 çš„ç»´åº¦ï¼Œ800M çš„ BookCorpus æ•°æ®é›† ç­‰ã€‚ æ–‡ç« å‰©ä½™éƒ¨åˆ†ä»‹ç»äº†å¦‚ä½•åœ¨ NLP å››å¤§ä¸»æµä»»åŠ¡ç±»å‹ä¸Šè¿ç”¨ GPTï¼Œå³å¦‚ä½•æŠŠä¸åŒå½¢å¼çš„ä»»åŠ¡éƒ½è¡¨ç¤ºæˆä¸€ä¸ªåºåˆ—+å¯¹åº”çš„æ ‡ç­¾çš„å½¢å¼ã€‚ å¯¹ç¬”è€…çš„å¯ç¤º: æ³¨é‡èƒ½åŠ›ï¼Œè€Œéè¿‡ç¨‹ï¼šé¢„è®­ç»ƒä»»åŠ¡å…¶å®å½¢å¼ä¸é‡è¦ï¼Œå¯ä»¥æ˜¯ classificationï¼Œå¯ä»¥æ˜¯é¢„æµ‹ next tokenï¼ŒçœŸæ­£é‡è¦çš„æ˜¯ model å’Œ data çš„ scaling upï¼Œä»¥æ­¤å¿«é€Ÿé«˜æ•ˆåœ°å¾—åˆ°ä¸€ä¸ªæœ‰ä¼˜å¼‚æ³›åŒ–èƒ½åŠ›çš„ç‰¹å¾æå–å™¨: data: æ‰¾åˆ°/è®¾è®¡ä¸€ä¸ªèƒ½æŠŠæµ·é‡çš„æ•°æ®ç”¨èµ·æ¥çš„ä»»åŠ¡ï¼Œèƒ½ç”¨çš„æ•°æ®è¶Šå¤šè¶Šå¥½ï¼Œè®­ç»ƒè¶Šå¿«è¶Šå¥½ model: æ¨¡å‹æ€§èƒ½å¯ä»¥éšç€å‚æ•°é‡å·¨é‡åœ°æå‡è€Œä¸ä¼šå¿«é€Ÿé¥±å’Œï¼Œä¸€ä¸ªä¼˜ç§€çš„æ¨¡å‹æ¶æ„æ˜¯ scaling up çš„åŸºç¡€ä¿éšœ ","date":"2024-05-03","objectID":"/posts/survey/:3:0","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["LLM"],"content":"2. Language Models are Unsupervised Multitask Learners (2019.02) GPT ç³»åˆ—çš„ç¬¬äºŒç¯‡å·¥ä½œã€‚ å‚æ•°é‡æå‡åˆ°äº† 1.5Bï¼Œä¹Ÿç”¨äº†æ›´å¤§é‡çš„æ•°æ®ã€‚GPT-2 æœ€å¤§çš„è´¡çŒ®æ˜¯æŠŠç ”ç©¶çš„é‡ç‚¹ä»å•ä¸ªä»»åŠ¡ä¸Šçš„é’ˆå¯¹æ€§è°ƒå‚åˆ·æ¦œï¼Œè½¬å‘äº† zero-shotï¼Œå³ï¼Œ è®­ç»ƒå¥½çš„æ¨¡å‹ä¸å†éœ€è¦å¾®è°ƒå°±èƒ½å»åšä¸åŒä»»åŠ¡äº†ï¼Œå°½ç®¡æ€§èƒ½ä¸Šè·ç¦»æ¯ä¸ªä»»åŠ¡çš„ SOTA éƒ½è¿˜æœ‰è·ç¦»ï¼Œä½†æ–¹æ¡ˆçš„å¯è¡Œæ€§å·²ç»éªŒè¯äº†ã€‚è¦å®ç°è¿™ä¸€ç‚¹ï¼ŒåŸæ¥ä¸ºç‰¹æ®Šä»»åŠ¡å‡†å¤‡ç‰¹æ®Š token çš„åšæ³•å°±ä¸åˆé€‚äº†ï¼Œå› ä¸ºé¢„è®­ç»ƒé˜¶æ®µæ¨¡å‹æ˜¯æ²¡è§è¿‡è¿™äº› token çš„ï¼Œæ¯•ç«Ÿè¯­è¨€æ¨¡å‹é¢„è®­ç»ƒé˜¶æ®µåªè§è¿‡è‡ªç„¶è¯­è¨€ï¼Œæ‰€ä»¥éå¸¸è‡ªç„¶åœ°å°±å¼•å‡ºäº† prompt çš„æ¦‚å¿µï¼Œç”¨è‡ªç„¶è¯­è¨€æ¥æ›¿ä»£åŸæœ¬çš„ä»»åŠ¡ tokenï¼Œå®ç°ä¸åŒä»»åŠ¡çš„ zero-shotã€‚ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªæ—¶å€™ GPT-2 å°±å·²ç»åˆå…· ChatGPT çš„é›å½¢äº†ï¼Œåªä¸è¿‡ç”¨æˆ·çš„è¾“å…¥è¿˜ä¸å®Œå…¨æ˜¯ä»»æ„è‡ªç„¶è¯­è¨€ï¼Œè€Œæ˜¯ç±»ä¼¼äºè¿™æ ·çš„æ¨¡æ¿è¾“å…¥ã€‚ï¼š ç¿»è¯‘ä»»åŠ¡ï¼š (translate to french, english text, french text) QA ä»»åŠ¡ï¼š (answer the question, document, question, answer) ","date":"2024-05-03","objectID":"/posts/survey/:4:0","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["LLM"],"content":"3. Language Models are Few-Shot Learners (2005.14165) GPT ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡å·¥ä½œã€‚ GPT-3 çš„å‚æ•°é‡æ¥åˆ°äº† 175Bï¼Œè®­ç»ƒæ•°æ®ä»ä¸€å¼€å§‹ GPT-1 çš„å‡ åƒæœ¬ä¹¦çš„æ•°æ®é›†ï¼Œå¼€å§‹è¿›å…¥åˆ°äº†ç½‘ç«™çˆ¬è™«æ•°æ®å’Œæ¸…æ´—çš„æ¨¡å¼ã€‚ å…¶å®åœ¨ GPT-2 ä¸­å°±å·²ç»æåˆ°äº†ä¸€ä¸ªå« Common Crawl çš„å…¬å¼€ç½‘ç»œæ•°æ®ï¼Œä½†æ˜¯å› ä¸ºä»–ä»¬è§‰å¾—è¿™ä»½æ•°æ®å®åœ¨å¤ªè„äº†æ‰€ä»¥æ”¾å¼ƒäº†ï¼Œè€Œç°åœ¨ä¸ºäº†è®­ç»ƒæ›´å¤§çš„æ¨¡å‹ä¹Ÿä¸å¾—ä¸ç”¨èµ·æ¥ï¼Œå› æ­¤æ¸…æ´—æ•°æ®æ˜¯å…ä¸äº†çš„ã€‚ æ•°æ®æ¸…æ´—ç»å†äº†ä¸¤ä¸ªè¿‡ç¨‹ï¼š è¿‡æ»¤ï¼šä»–ä»¬å°†åŸæ¥ GPT-2 è®­ç»ƒç”¨çš„æ•°æ®ä½œä¸ºæ­£æ ·æœ¬ï¼ŒCommon Crawl ä½œä¸ºè´Ÿæ ·æœ¬è®­ç»ƒäº†ä¸€ä¸ªäºŒåˆ†ç±»å™¨ï¼Œç„¶åç”¨è¿™ä¸ªåˆ†ç±»å™¨æ¥åšæ•°æ®ç­›é€‰ï¼Œè¿‡æ»¤æ‰ä¸€äº›ç‰¹åˆ«æ˜¾è‘—çš„è„æ•°æ®ã€‚ å»é‡ï¼šç”¨ç»å…¸çš„ LSH ç®—æ³•è¿›è¡Œå»é‡ å¦ä¸€æ–¹é¢ï¼ŒGPT-3 ä¹Ÿæ­£å¼æå‡ºäº†â€œin-context learningâ€çš„æ¦‚å¿µï¼Œåœ¨æ¨¡å‹å‚æ•°ä¸è¿›è¡Œæ›´æ–°çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡è¾“å…¥çš„ä¸Šä¸‹æ–‡æ¥å¸®åŠ©æ¨¡å‹æå‡è¡¨ç°ã€‚ å¯¹äºç¬”è€…è€Œè¨€ï¼Œè¿™å¼ å›¾ç›¸å½“å½¢è±¡: BP Network è¿™æ­ç¤ºäº†æ¨¡å‹å­¦ä¹ çš„å¦ä¸€ä¸ªç»´åº¦ï¼Œæå‡æ¨¡å‹è¡¨ç°å¹¶ä¸åªæœ‰ SGD æ¢¯åº¦æ›´æ–°è¿™ä¸€ä¸ªä¼˜åŒ–æ–¹å‘ã€‚ç»“åˆ GPT-2 ä¸­ prompt çš„ç”±æ¥ï¼Œprompt çš„å‰èº«æ˜¯è¯­è¨€æ¨¡å‹åšå¤šä»»åŠ¡ zero-shot æ—¶ï¼Œé’ˆå¯¹ä¸åŒä»»åŠ¡ç»™çš„ç‰¹æ®Š tokenï¼Œå› æ­¤ä¸€ä¸ªæ›´åŠ å¯Œæœ‰ä¿¡æ¯é‡çš„â€œç‰¹æ®Š token åºåˆ—â€èƒ½æå‡æ¨¡å‹è¡¨ç°ä¼¼ä¹æ˜¯ä¸€ä»¶éå¸¸ç¬¦åˆç›´è§‰çš„äº‹æƒ…ã€‚ ç›¸æ¯”äºè¿‡å»ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Š token æ¥ä»£è¡¨æŸä¸€ç§ç‰¹å®šçš„ä»»åŠ¡ï¼ŒGPT-3 çš„ few-shot promptï¼Œæˆ–è€…è¯´ in-context learning å½¢å¼ï¼Œåœ¨ç¬”è€…çœ‹æ¥æ˜¯ä¸€ç§æ¨å¹¿ï¼Œç”¨æˆ·è¾“å…¥çš„è‡ªç„¶è¯­è¨€å’Œ few-shot æ ·ä¾‹å¯ä»¥çœ‹æˆæ˜¯ä¸€ç»„ç‰¹æ®Š token çš„åºåˆ—ï¼Œå› ä¸ºè‡ªç„¶è¯­è¨€çš„ token å…·æœ‰è¯­ä¹‰å’Œé€»è¾‘å…³è”æ€§ï¼Œä¸€ä¸ªå¼ºå¤§çš„é¢„è®­ç»ƒæ¨¡å‹åšåˆ°äº†â€œç‰¹æ®Š tokenâ€ä¹‹é—´çš„æ³›åŒ–ã€‚ é€šè¿‡å®éªŒæˆ‘ä»¬ä¹Ÿå¯ä»¥è§‚å¯Ÿåˆ°ï¼Œéšç€ç»™å‡ºçš„ç¤ºä¾‹æ ·æœ¬æ•°å˜å¤šï¼Œæ¨¡å‹çš„è¡¨ç°ä¹Ÿåœ¨æå‡ï¼š BP Network ä»ç¬”è€…ä¸ªäººçš„è§’åº¦æ¥æ€»ç»“ï¼š æˆ‘ä»¬å¯ä»¥å°†ä¸“å±ä»»åŠ¡ä¸Šå¾®è°ƒå¾—åˆ°çš„æ¨¡å‹ï¼Œçœ‹æˆä¸€ç§ç”¨æˆ·è¾“å…¥ 0 ä¸ªç‰¹æ®Š tokenï¼Œè§£å†³ 1 ç§ä»»åŠ¡çš„èŒƒå¼ï¼Œæ‰€ä»¥ç¬¬ä¸€èŒƒå¼ä¸‹çš„æ¯ä¸ªæ¨¡å‹åªèƒ½ç”¨äºè§£å†³ä¸€ä¸ªä¸“å±ä»»åŠ¡ã€‚ ç¬¬äºŒèŒƒå¼çš„æ¨¡å‹æ˜¯ä¸ºæ¯ä¸€ç§ä»»åŠ¡å‡†å¤‡ 1 ä¸ªç‰¹æ®Š tokenï¼Œå› æ­¤é€šè¿‡æ”¹å˜è¾“å…¥ tokenï¼Œå°±èƒ½ç”¨ä¸€ä¸ªæ¨¡å‹è§£å†³ä¸åŒçš„ä»»åŠ¡ã€‚ ç¬¬ä¸‰èŒƒå¼çš„æ¨¡å‹æŠŠç‰¹æ®Š token æ›¿æ¢æˆäº†ç‰¹æ®Š token åºåˆ—ï¼Œè€Œè‡ªç„¶è¯­è¨€æ­£å¥½å°±æ˜¯ä¸€ç§æœ€ç¬¦åˆäººç±»ä¹ æƒ¯å’Œç›´è§‰çš„ç‰¹æ®Š token åºåˆ—ã€‚ ","date":"2024-05-03","objectID":"/posts/survey/:5:0","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["LLM"],"content":"4. Training language models to follow instructions with human feedback (2203.02155) InstructGPT è¢«è®¤ä¸ºæ˜¯ ChatGPTï¼ˆGPT3.5ï¼‰ èƒŒåçš„æŠ€æœ¯ï¼Œæ ¸å¿ƒç‚¹æ˜¯æŠŠ RLHFï¼Œå³åŸºäºäººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹ ï¼Œç”¨åˆ°äº†è¯­è¨€æ¨¡å‹ä¸Šæ¥è¿›è¡Œäººç±»å–œå¥½å¯¹é½ã€‚ç»è¿‡ RLHF çš„ 1.3B GPT æ¨¡å‹èƒ½åœ¨äººç±»ä¸»è§‚è¯„åˆ†ä¸Šè¶…è¿‡ 175B çš„ GPT-3. BP Network è¿™ç¯‡å·¥ä½œé‡Œå°†æ¨¡å‹è¾“å‡ºä¸äººç±»æ„æ„¿ä¸ä¸€è‡´çš„è¿™ä¸ªç°è±¡ç§°ä¸ºâ€œmisalignedâ€ï¼Œå¹¶åˆ†æåŸå› åœ¨äºè¯­è¨€æ¨¡å‹çš„è®­ç»ƒç›®æ ‡åªæ˜¯é¢„æµ‹ä¸‹ä¸€ä¸ª tokenï¼Œè¿™è·Ÿæˆ‘ä»¬å¸Œæœ›æ¨¡å‹â€œfollow the userâ€™s instructions helpfully and safelyâ€çš„ç›®æ ‡ä¹‹é—´æ˜¾ç„¶æ˜¯å­˜åœ¨å·®è·çš„ã€‚ ç”¨ Anthropic çš„å·¥ä½œé‡Œçš„è¯æ¥è¯´ï¼Œå¤§æ¨¡å‹åº”è¯¥éµå¾ª 3H åŸåˆ™ï¼Œå³ï¼š helpfulï¼šå¸®åŠ©ç”¨æˆ·è§£å†³é—®é¢˜ honestï¼šä¸èƒ½ä¼ªé€ ä¿¡æ¯æˆ–è¯¯å¯¼ç”¨æˆ· harmlessï¼šä¸èƒ½å¯¹äººæˆ–ç¯å¢ƒé€ æˆèº«ä½“ã€å¿ƒç†æˆ–ç¤¾ä¼šä¼¤å®³ è¯­è¨€æ¨¡å‹ä¹‹æ‰€ä»¥å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼ŒåŸå› ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯æ— ç›‘ç£å­¦ä¹ ï¼Œæœ¬èº«çš„å­¦ä¹ ç›®æ ‡é‡Œå°±æ²¡æœ‰äººä¸ºæ§åˆ¶ï¼Œæ‰€ä»¥å¾ˆç›´è§‚åœ°å¯ä»¥æƒ³åˆ°ç”¨**ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰**çš„æ–¹å¼æ¥æŠŠç¼ºå¤±çš„äººç±»ç›‘ç£ä¿¡å·åŠ è¿›æ¥ã€‚ ä½†æ˜¯å‰é¢ GPT ä¸‰ç¯‡å·¥ä½œå¥½ä¸å®¹æ˜“æ‰æŠŠæ¨¡å‹åšåˆ° 175B è¿™ä¹ˆå¤§ï¼Œç°åœ¨åˆé‡æ–°å¼€å§‹æ ‡æ•°æ®åšç›‘ç£å­¦ä¹ æ˜¾ç„¶æ˜¯æœ‰ç‚¹ä¸èªæ˜çš„ï¼Œè€Œä¸”æ¨¡å‹å¤§äº†ä»¥åä¹Ÿæ›´å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œå¯¹äºäººç±»åå¥½è¿™ä¸€ç±»çš„é—®é¢˜æ ‡æ³¨èµ·æ¥éš¾åº¦åˆå¾ˆå¤§ï¼Œç®€å•åœ°å…¨é  SFT è‚¯å®šæ˜¯è¡Œä¸é€šçš„ã€‚æ‰€ä»¥å¾ˆè‡ªç„¶åœ°ï¼ŒOpenAI æƒ³åˆ°äº†ç”¨ä»–ä»¬å®¶çš„æ‹¿æ‰‹å¥½æˆå¼ºåŒ–å­¦ä¹ ï¼Œè¦çŸ¥é“ OpenAI æœ¬èº«å°±æ˜¯åšå¼ºåŒ–å­¦ä¹ èµ·å®¶çš„ï¼Œæœ¬æ–‡ä½¿ç”¨çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³• PPO ä¹Ÿå…¨æ˜¯ä¹‹å‰ä»–ä»¬å·²ç»æå‡ºçš„ç®—æ³•ï¼Œæ²¡æœ‰ä»»ä½•æ–°çš„ç®—æ³•è¢«æå‡ºï¼Œç”šè‡³è®ºæ–‡é‡Œéƒ½æ²¡æœ‰å¯¹å·²æœ‰çš„ç®—æ³•è¿›è¡Œå¤ªå¤šçš„è§£é‡Šå’Œé“ºå«ï¼Œéœ€è¦ä½ æ„Ÿå…´è¶£è‡ªå·±å»ç¿»ä»–ä»¬çš„è®ºæ–‡ã€‚ BP Network ä»–ä»¬çš„æ–¹æ³•æ•´ä½“å¯ä»¥æ¦‚æ‹¬å¦‚ä¸‹ï¼š äººå·¥æ ‡ä¸€æ‰¹ SFT æ•°æ®ï¼ˆåŒ…å«é—®é¢˜å’Œå›ç­”ï¼‰ï¼Œå¯¹ GPT-3 æ¨¡å‹ï¼ˆåœ¨å¼ºåŒ–å­¦ä¹ é‡Œå¯¹åº” Policyï¼‰è¿›è¡Œå¾®è°ƒ ç”¨ SFT å¾—åˆ°çš„æ¨¡å‹ï¼Œé’ˆå¯¹æ¯ä¸ªé—®é¢˜ç”Ÿæˆå‡ ä»½å›ç­”ï¼Œç„¶åäººå·¥ç»™è¿™äº›å›ç­”è´¨é‡æ‰“åˆ†ï¼ˆæ’åºï¼‰ ç”¨è¿™ä»½æ‰“åˆ†æ•°æ®è®­ç»ƒä¸€ä¸ªå¥–åŠ±æ¨¡å‹ï¼ˆReward Model, RMï¼‰ï¼Œè®©å¥–åŠ±æ¨¡å‹ä»£æ›¿äººå·¥æ‰“åˆ† é‡‡ç”¨ PPO ç®—æ³•ï¼ŒåŸºäºå¥–åŠ±æ¨¡å‹çš„è¯„åˆ†æ¥ç»§ç»­è®­ç»ƒ GPT-3 æ¨¡å‹ æ¢è¨€ä¹‹ï¼Œä»–ä»¬ä¸€å…±é€ äº†ä¸‰ä»½æ•°æ®ï¼š SFT æ•°æ®ï¼ˆ13k æ¡ï¼‰ï¼šäººå·¥è®¾è®¡çš„é—®é¢˜ï¼Œäººå·¥æ ‡æ³¨ç­”æ¡ˆ Feedback æ•°æ®ï¼ˆ33k æ¡ï¼‰ï¼šé’ˆå¯¹ä¸Šé¢äººå·¥è®¾è®¡çš„é—®é¢˜ï¼Œæ¨¡å‹è¾“å‡ºçš„å‡ ä»½ç­”æ¡ˆçš„æ’åºï¼ˆæ‰“åˆ†ï¼‰ PPO ä½¿ç”¨çš„æ•°æ®ï¼ˆ31k æ¡ï¼‰ï¼šäººå·¥è®¾è®¡çš„é—®é¢˜ï¼ˆä¸Šé¢çš„æ¨¡å‹æ²¡è§è¿‡çš„æ–°é—®é¢˜ï¼‰ï¼Œç”¨ RM çš„è¯„åˆ†æ¥ç»§ç»­è®­ç»ƒï¼Œè¿™ä»½æ•°æ®ä¸éœ€è¦äººå·¥æ ‡æ³¨ç­”æ¡ˆ è®­ç»ƒä¸‰ä¸ªæ¨¡å‹ï¼š SFT æ¨¡å‹ï¼ˆ16 epochï¼‰ RM (Reward Model å¥–åŠ±æ¨¡å‹) PPO ç»§ç»­è®­ç»ƒå‡ºæ¥çš„æœ€ç»ˆæ¨¡å‹ ä»–ä»¬ç”šè‡³å¯¹é—®é¢˜ç±»å‹è¿›è¡Œäº†ä¸€äº›åˆ†ç±»ï¼š BP Network æ¨¡å‹è®­ç»ƒéƒ¨åˆ†ï¼Œä¸ªäººè§‰å¾—å€¼å¾—æ³¨æ„çš„ç‚¹æœ‰ï¼š SFT é˜¶æ®µï¼Œåœ¨è®­äº† 1 epoch åæ¨¡å‹å°±å·²ç»è¿‡æ‹Ÿåˆäº†ï¼Œä½†ä»–ä»¬å‘ç°ç»§ç»­è®­ç»ƒè¿‡æ‹Ÿåˆçš„æ¨¡å‹ä¾ç„¶å¯ä»¥æå‡ RM æ€§èƒ½ï¼Œæ‰€ä»¥ä»–ä»¬è®­ç»ƒäº† 16 epoch RM çš„æƒé‡æ˜¯ç›´æ¥ç”¨ SFT æ¨¡å‹åˆå§‹åŒ–çš„ï¼Œå› ä¸ºè¯„åˆ†æ¨¡å‹ä¹Ÿéœ€è¦è¯­è¨€èƒ½åŠ›ï¼Œç›´æ¥æ‹·è´ä¸€ä»½æƒé‡æ˜¯æ¯”è¾ƒçœäº‹çš„ã€‚RM çš„è¾“å…¥æ˜¯é—®é¢˜+å‡ ä»½ç­”æ¡ˆï¼Œè¾“å‡ºæ˜¯æ’åºã€‚ RM æ¨¡å‹åªæœ‰ 6Bï¼Œå› ä¸º 175B çš„ RM å¾ˆéš¾è®­ å¼ºåŒ–å­¦ä¹ é˜¶æ®µåŠ äº†ä¸€ä¸ªé€ token çš„ KL æ•£åº¦ï¼Œç”¨æ¥è®©æœ€ç»ˆæ¨¡å‹è·Ÿç¬¬ä¸€ç‰ˆ SFT æ¨¡å‹çš„è¦è¾“å‡ºåˆ†å¸ƒå°½é‡ä¿æŒä¸€è‡´ï¼Œå› ä¸º RM æ˜¯åœ¨è®­ç»ƒ SFT æ¨¡å‹çš„æ•°æ®ä¸Šè®­çš„ï¼Œå¦‚æœåˆ†å¸ƒå·®å¼‚å¤ªå¤§ï¼ŒRM çš„è¯„åˆ†å°±ä¸å‡†äº† å¼ºåŒ–å­¦ä¹ çš„ç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š BP Network ç®€å•ç¿»è¯‘ä¸€ä¸‹ï¼š $$æŸå¤± = RM è¯„åˆ† + æ–°æ—§æ¨¡å‹è¾“å‡ºtokenåˆ†å¸ƒçš„KLæ•£åº¦ + æ—§é—®é¢˜ä¸ŠSFTçš„æŸå¤±$$ å…¶ä¸­ï¼š RM è¯„åˆ†æ˜¯ RM å¯¹å½“å‰æ­£åœ¨è®­ç»ƒçš„æ¨¡å‹åœ¨æ–°é—®é¢˜ï¼ˆç¬¬ä¸‰ä»½æ•°æ®ï¼‰ä¸Šçš„è¾“å‡ºçš„è¯„åˆ† KL æ•£åº¦æ˜¯å½“å‰æ¨¡å‹è·Ÿæ—§çš„ SFT æ¨¡å‹è¾“å‡ºä¹‹é—´è®¡ç®—çš„ æ—§é—®é¢˜ SFT æŸå¤±æ˜¯ç”¨ç¬¬ä¸€ä»½æ•°æ®é›†ç»§ç»­æŒ‰ SFT æ–¹æ³•è®­å½“å‰æ¨¡å‹å¾—åˆ°çš„ å¦å¤–ï¼Œå…³äºè®­ç»ƒæ•°æ®å’Œè¯„æµ‹æ–¹é¢çš„å–èˆä¹Ÿæœ‰æ‰€ä¸åŒï¼Œè®­ç»ƒä¸­ä»–ä»¬æ›´çœ‹é‡ helpfulï¼Œè€Œè¯„æµ‹é˜¶æ®µåˆ™æ›´çœ‹é‡ honest å’Œ harmlessã€‚ ","date":"2024-05-03","objectID":"/posts/survey/:6:0","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["LLM"],"content":"5. GPT-4 Technical Report (2303.08774) å¤šæ¨¡ åŸºäºä¸Šé¢ç¬”è€…ä¸‰ç§æ¨¡å‹èŒƒå¼çš„æ€è·¯ï¼Œå¤šæ¨¡æ€çš„æ¨¡å‹å¯ä»¥çœ‹æˆæ˜¯è®©ç‰¹æ®Š token çš„ç±»å‹ä»æ–‡æœ¬ token æ‹“å®½åˆ°äº†è§†è§‰ tokenï¼Œå°†æ¨¡å‹è§£å†³çš„ä»»åŠ¡ä» NLP ä»»åŠ¡æ‹“å®½åˆ°äº† CV ä»»åŠ¡ï¼Œè€Œä¸¤ç§æ¨¡æ€ token å¯¹é½çš„æŠ€æœ¯ä¹Ÿæ—©è¢« OpenAI ç ”ç©¶è¿‡äº†ï¼Œä¹Ÿå°±æ˜¯å¤§åé¼é¼çš„ CLIPã€‚å› æ­¤ï¼ŒGPT-4 å…·å¤‡å¤šæ¨¡èƒ½åŠ›æœ¬èº«å¹¶ä¸æ˜¯ä¸€ä»¶æ„å¤–çš„äº‹æƒ…ã€‚ RLHF åœ¨ç¬”è€…çœ‹æ¥ï¼ŒRLHF ç­‰æŠ€æœ¯æ›´å¤šåœ°æ˜¯åœ¨ä¸é™åˆ¶è¾“å…¥ token åºåˆ—çš„æƒ…å†µä¸‹ï¼Œå»çº¦æŸæ¨¡å‹è¾“å‡ºçš„æŠ€æœ¯ï¼Œå½“ç„¶ä»æŸç§æ„ä¹‰ä¸Šï¼Œä¹Ÿå¯ä»¥çœ‹æˆæ˜¯åœ¨ç›‘ç£ prompts -\u003e task çš„æ˜ å°„å…³ç³»çš„æŠ€æœ¯ï¼ˆå…¶å®å‘å±•åˆ°ç°åœ¨ï¼Œtask è¿™ä¸ªè¯å·²ç»ä¸å¤ªå‡†ç¡®äº†ï¼Œå¯ä»¥æ„ä¼šä¸€ä¸‹ï¼‰ã€‚ GPT-4 çš„æŠ¥å‘Šä¸­æ˜ç¡®æŒ‡å‡ºï¼ŒRLHF å¹¶ä¸èƒ½æå‡æ¨¡å‹è§£å†³ä»»åŠ¡çš„è´¨é‡ï¼ˆä¸ä¼šå¢åŠ çŸ¥è¯†ï¼‰ï¼Œç”šè‡³å¾ˆå¤šæ—¶å€™è°ƒçš„ä¸å¥½è¿˜ä¼šæŸå®³å„ä¸ªä»»åŠ¡ä¸Šçš„æŒ‡æ ‡ã€‚RLHF æ›´å¤šåœ°æ˜¯åœ¨æ„å»ºä¸€äº›æ˜ç¡®çš„ prompts -\u003e task æ˜ å°„å…³ç³»ï¼Œå› ä¸ºè‡ªç„¶è¯­è¨€æ˜¯å…·æœ‰æ­§ä¹‰æ€§çš„ï¼Œå°¤å…¶æ˜¯åœ¨è¾“å…¥ä¿¡æ¯è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œæ¨¡å‹æ ¹æ® prompts â€œç†è§£â€åˆ°çš„é‚£ä¸ª taskï¼Œå¹¶ä¸ä¸€å®šæ˜¯äººç±»çœŸæ­£å¿ƒé‡Œçš„é‚£ä¸ªæ„å›¾ï¼ŒRLHF å®ç°äº†ä¸€ç§å®šåˆ¶åŒ–çš„æ˜ å°„æ­å»ºï¼Œæˆ–è€…è¯´ï¼Œäººç±»å–œå¥½å¯¹é½ã€‚ Predictable scaling ç”±äºå¤§æ¨¡å‹å®éªŒçš„æˆæœ¬æ—¥æ¸é«˜æ˜‚ï¼Œæˆ‘ä»¬ä¸å†èƒ½åƒå°æ¨¡å‹é‚£æ ·éšä¾¿èµ·å®éªŒè°ƒå‚äº†ã€‚å› æ­¤ OpenAI çš„å¤§éƒ¨åˆ†å®éªŒåº”è¯¥æ˜¯åœ¨ä¸€ä¸ªæ¯” GPT-4 å°å¾ˆå¤šå€çš„æ¨¡å‹ä¸Šè¿›è¡Œçš„ï¼Œç„¶åé€šè¿‡è¿™ä¸ªå°æ¨¡å‹çš„è®­ç»ƒ lossï¼Œæ¥é¢„æµ‹å¤§æ¨¡å‹æœ€ç»ˆè®­ç»ƒå‡ºæ¥çš„ loss BP Network åŒæ ·çš„ï¼Œ predictable scaling laws ä¹Ÿåœ¨å¾ˆå¤š HumanEval é›†ä¸Šå¾—åˆ°äº†è§‚å¯Ÿã€‚å½“ç„¶ï¼Œåœ¨ä¸€éƒ¨åˆ†çš„ä»»åŠ¡ä¸Šä¹Ÿè¿˜æ— æ³•è¢«æ‹Ÿåˆçš„æ€§èƒ½æ›²çº¿ï¼Œå› æ­¤ OpenAI è¯´åç»­è¿˜ä¼šè¿›ä¸€æ­¥ä¼˜åŒ–ä»–ä»¬æ¨¡å‹æ€§èƒ½é¢„æµ‹çš„æ–¹æ³•ã€‚ ","date":"2024-05-03","objectID":"/posts/survey/:7:0","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["LLM"],"content":"6. Sparks of Artifificial General Intelligence: Early experiments with GPT-4 (2303.12712) æ™ºèƒ½ï¼ˆIntelligenceï¼‰æ˜¯ä¸€ä¸ªå¤šæ–¹é¢ä¸”éš¾ä»¥æ‰æ‘¸çš„æ¦‚å¿µï¼Œé•¿æœŸä»¥æ¥ç¼ºä¹ä¸€ä¸ªå…±è¯†æ€§çš„å®šä¹‰ã€‚1994 å¹´ 52 å å¿ƒç†å­¦å®¶ç»„æˆçš„å…¬å¼å°ç»„å‡ºç‰ˆçš„å…³äºæ™ºåŠ›ç§‘å­¦çš„ç¤¾è®ºä¸­ï¼Œå°†åªèƒ½å®šä¹‰ä¸ºä¸€ç§éå¸¸æ™®éçš„å¿ƒç†èƒ½åŠ›ï¼ŒåŒ…æ‹¬æ¨ç†ã€è®¡åˆ’ã€è§£å†³é—®é¢˜ã€æŠ½è±¡æ€è€ƒã€ç†è§£å¤æ‚æƒ³æ³•ã€å¿«é€Ÿå­¦ä¹ å’Œä»ç»éªŒä¸­å­¦ä¹ çš„èƒ½åŠ›ã€‚ è¿™ç¯‡æ˜¯å¾®è½¯å…³äº GPT-4 çš„ç ”ç©¶æŠ¥å‘Šï¼Œé•¿è¾¾ 55 é¡µï¼Œæ–‡ä¸­çš„å®éªŒéƒ½æ˜¯åœ¨ æ—©æœŸçš„æ–‡æœ¬å•ä¸€æ¨¡æ€ç‰ˆçš„ GPT-4 ä¸Šè¿›è¡Œçš„ï¼ˆè€Œä¸æ˜¯åé¢æ›´æ–°çš„å¤šæ¨¡æ€ç‰ˆæœ¬ï¼‰, å…¶ç›®æ ‡æ˜¯ç”Ÿæˆä¸€äº›æ–°é¢–è€Œå›°éš¾çš„ä»»åŠ¡å’Œé—®é¢˜ï¼Œæ¥è¯æ˜ GPT-4 çš„èƒ½åŠ›å¹¶ä¸æ˜¯å•çº¯çš„è®°å¿†ï¼Œå¹¶ä¸”å®ƒå¯¹æ¦‚å¿µã€æŠ€èƒ½å’Œé¢†åŸŸæœ‰æ·±åˆ»è€Œçµæ´»çš„ç†è§£ã€‚å¦å¤–è¿˜æ—¨åœ¨æ¢ç´¢ GPT-4 çš„å“åº”å’Œè¡Œä¸ºï¼Œä»¥éªŒè¯å…¶ä¸€è‡´æ€§ã€è¿è´¯æ€§å’Œæ­£ç¡®æ€§ï¼Œæ­ç¤ºå…¶å±€é™æ€§å’Œåå·®ã€‚ å¦‚ä½•è¡¡é‡ GPT-4 çš„æ™ºèƒ½ ä¼ ç»Ÿæœºå™¨å­¦ä¹ çš„æ ‡å‡†åšæ³•æ˜¯å‡†å¤‡ä¸€ç»„æ ‡å‡†è¯„æµ‹æ•°æ®é›†ï¼Œç¡®ä¿å®ƒä»¬ç‹¬ç«‹äºè®­ç»ƒæ•°æ®ä¹‹å¤–ï¼Œè¦†ç›–ä¸€ç³»åˆ—çš„ä»»åŠ¡å’Œé¢†åŸŸã€‚ ä½†è¿™ç§æ–¹æ³•å¹¶ä¸å¤ªé€‚ç”¨äº GPT-4ï¼Œå› ä¸º GPT-4 æ˜¯é—­æºæ¨¡å‹ï¼Œç›¸å…³çš„è®­ç»ƒæ•°æ®é›†ä¿¡æ¯ä¸å…¬å¼€ï¼Œå¹¶ä¸”å¯ä»¥é¢„è§åœ°éå¸¸åºå¤§ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½ä¿è¯ç›®å‰å…¬å¼€çš„åŸºå‡†æµ‹è¯•é›†ä¸åœ¨å®ƒçš„è®­ç»ƒæ•°æ®é‡Œã€‚ä¹Ÿæ­£å› ä¸ºæ­¤ï¼Œæœ¬æ–‡é‡‡ç”¨çš„ç ”ç©¶æ–¹æ³•æ›´æ¥è¿‘äºä¼ ç»Ÿå¿ƒç†å­¦ï¼Œè€Œä¸æ˜¯æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚ å¤šæ¨¡æ€ä¸è·¨å­¦ç§‘æ•´åˆ æ™ºèƒ½çš„ä¸€ä¸ªé‡è¦è¡¡é‡æŒ‡æ ‡æ˜¯ç»¼åˆä¸åŒé¢†åŸŸä¿¡æ¯çš„èƒ½åŠ›ï¼Œä»¥åŠè·¨å­¦ç§‘åœ°åº”ç”¨çŸ¥è¯†å’ŒæŠ€èƒ½çš„èƒ½åŠ›ã€‚è¿™ä¸€èŠ‚ä¸­ä½œè€…ä¸¾äº†å››ä¸ªä¾‹å­æ¥è¯´æ˜ GPT-4 å…·æœ‰å¾ˆå¼ºçš„å¤šæ¨¡æ€ä¸è·¨å­¦ç§‘æ•´åˆèƒ½åŠ›ï¼š å†™ JavaScript ä»£ç æ¥ç”Ÿæˆç”»å®¶ Wassily Kandinsky é£æ ¼çš„ä½œå“ã€‚å›¾ä¸€æ˜¯è¯¥ç”»å®¶çš„åŸä½œï¼Œåé¢åˆ†åˆ«æ˜¯ GPT-4 å’Œ ChatGPT å†™çš„ä»£ç ç”»å‡ºçš„ã€‚ BP Network ç”¨èå£«æ¯”äºšçš„æ–‡é£æ¥è¯æ˜ç´ æ•°æ— ç©·å®šç† BP Network ä»¥åœ£é›„ç”˜åœ°çš„å£å»å†™ä¸€å°ä¿¡ç»™ä»–çš„å¦»å­ï¼Œå†…å®¹æ˜¯æ”¯æŒâ€œç”µå­â€æˆä¸ºç¾å›½æ€»ç»Ÿå€™é€‰äºº BP Network å†™ Python ä»£ç ï¼Œä»¥å¹´é¾„ã€æ€§åˆ«ã€ä½“é‡ã€èº«é«˜å’Œè¡€æ¶²æµ‹è¯•ç»“æœå‘é‡ä½œä¸ºè¾“å…¥ï¼Œæ¥é¢„æµ‹ç”¨æˆ·æ˜¯å¦æœ‰æ‚£ç³–å°¿ç—…çš„é£é™© è¿™äº›å¯¹æ¯”å¯ä»¥ä½“ç° GPT-4 èƒ½åˆ›æ–°æ€§åœ°æ•´åˆä¸åŒé¢†åŸŸçš„æ¦‚å¿µï¼Œå¹¶ä¸”æ˜¾è‘—å¼ºäº ChatGPTã€‚é™¤æ­¤ä¹‹å¤–ä½œè€…ä¹Ÿæµ‹è¯•äº† GPT-4 åœ¨éŸ³ä¹ã€ç»˜å›¾ã€ç©ºé—´ç†è§£æ–¹é¢çš„èƒ½åŠ›ã€‚ ä»£ç  é™¤äº†å¸¸è§çš„ leetcode åˆ·é¢˜ï¼Œä½œè€…æµ‹è¯•äº† GPT-4 ç”Ÿæˆé€†å‘å·¥ç¨‹ä»£ç ã€è§£é‡Šå·²æœ‰ä»£ç ã€ç”¨è‡ªç„¶è¯­è¨€æ¨¡æ‹Ÿä»£ç æ‰§è¡Œè¿‡ç¨‹ã€è¿è¡Œä¼ªä»£ç ç­‰èƒ½åŠ›ã€‚ æ•°å­¦ åœ¨ä¸€ç³»åˆ—çš„åˆ†æå®éªŒåï¼Œä½œè€…ä»ä»¥ä¸‹ä¸‰æ–¹é¢æ€»ç»“äº†GPT-4çš„æ•°å­¦èƒ½åŠ›ï¼š åˆ›é€ æ€§æ¨ç†ï¼šè¯†åˆ«æ¯ä¸ªé˜¶æ®µå¯èƒ½ç›¸å…³çš„å‚æ•°ã€ä¸­é—´æ­¥éª¤ã€è®¡ç®—æˆ–ä»£æ•°æ“ä½œçš„èƒ½åŠ›ã€‚è¯¥ç»„ä»¶é€šå¸¸åŸºäºå¯å‘å¼çŒœæµ‹æˆ–ç›´è§‰ï¼Œé€šå¸¸è¢«è®¤ä¸ºæ˜¯æ•°å­¦è§£å†³é—®é¢˜çš„æœ€å®è´¨æ€§å’Œæœ€æ·±åˆ»çš„æ–¹é¢ æŠ€æœ¯ç†Ÿç»ƒç¨‹åº¦ï¼šæ‰§è¡Œéµå¾ªæŒ‡å®šæ­¥éª¤é›†çš„å¸¸è§„è®¡ç®—æˆ–æ“ä½œçš„èƒ½åŠ› æ‰¹åˆ¤æ€§æ¨ç†ï¼šæ‰¹åˆ¤æ€§åœ°æ£€æŸ¥è®ºç‚¹çš„æ¯ä¸ªæ­¥éª¤çš„èƒ½åŠ›ï¼Œå°†å…¶åˆ†è§£ä¸ºå…¶å­ç»„ä»¶ï¼Œè§£é‡Šå®ƒéœ€è¦çš„å†…å®¹ï¼Œå®ƒä¸å…¶ä½™è®ºç‚¹ç›¸å…³ä»¥åŠä¸ºä»€ä¹ˆæ˜¯æ­£ç¡®çš„ è¿™ä¸€èŠ‚ä½œè€…å‘ç° GPT-4 çš„å¾ˆå¤šç¼ºé™·ï¼Œå¦‚ï¼š åœ¨æ‰§è¡Œä¸€äº›å¾ˆå¸¸è§„ä¸”æœºæ¢°çš„è®¡ç®—æ—¶ç»å¸¸ç®—é”™å’Œæ··æ·† GPT-4 ç”±äºæ˜¯è‡ªå›å½’æ¨¡å‹ï¼Œå› æ­¤æ˜¯å®æ—¶çº¿æ€§è¾“å‡ºçš„ï¼Œè€Œæ²¡æœ‰åŠæ³•â€œæ‰“è…¹ç¨¿â€ ä¸ä¸–ç•Œçš„äº¤äº’ æ™ºèƒ½çš„å¦ä¸€é‡è¦æ–¹é¢æ˜¯äº¤äº’èƒ½åŠ›ï¼Œå³è·Ÿå¤–ç•Œç¯å¢ƒå’Œæ™ºèƒ½ä½“è¿›è¡Œäº¤äº’çš„èƒ½åŠ›ï¼Œä½œè€…ä¸»è¦é€šè¿‡å·¥å…·è°ƒç”¨å’Œå…·èº«äº¤äº’ä¸¤ä¸ªç»´åº¦æ¥è¯„ä¼°ã€‚ å·¥å…·è°ƒç”¨è¿™é‡Œä¸å¤šèµ˜è¿°äº†ï¼Œå…·èº«äº¤äº’æ–¹é¢æµ‹è¯•äº†æ–‡å­—è·‘å›¢æ¸¸æˆï¼Œä»¥åŠäº¤äº’å¼åœ°æŒ‡å¯¼äººå‘˜æ‰¾åˆ°å¤©èŠ±æ¿æ¼æ°´çš„åœ°æ–¹å¹¶è¿›è¡Œä¿®è¡¥ï¼Œé€æ­¥æ ¹æ®äººç±»çš„æ¯ä¸€æ­¥åé¦ˆï¼Œç»™å‡ºè¡ŒåŠ¨å»ºè®®å’ŒæŒ‡ç¤ºã€‚ ä¸äººç±»çš„äº¤äº’ GPT-4 åœ¨æ¨ç†ä»–äººå¿ƒç†çŠ¶æ€æ–¹é¢è¡¨ç°éå¸¸çªå‡ºï¼Œç‰¹åˆ«æ˜¯åœ¨æ¨¡æ‹Ÿç°å®åœºæ™¯ä¸­ï¼Œå®ƒçš„è§£é‡Šèƒ½åŠ›ä¹Ÿå¾ˆå¼ºï¼Œèƒ½å¯¹è‡ªå·±çš„åˆ¤æ–­å’Œè¨€è®ºè¿›è¡Œè‡ªæˆ‘è§£é‡Šã€‚ åˆ¤åˆ«èƒ½åŠ› åˆ¤åˆ«èƒ½åŠ›ä¸»è¦æŒ‡æ¨¡å‹åŒºåˆ«ä¸åŒäº‹ç‰©ã€æ¦‚å¿µå’Œæƒ…æ™¯çš„èƒ½åŠ›ã€‚æ¯”å¦‚ï¼ŒåŒºåˆ†ä¸¤ä¸ªé£Ÿç‰©å“ªä¸ªæ˜¯å¯ä»¥å®‰å…¨é£Ÿç”¨ï¼Œå“ªä¸ªæ˜¯æœ‰æ¯’çš„ã€‚ è¿™ä¸€èŠ‚çš„æµ‹è¯•é‡Œï¼Œæ­ç¤ºå‡ºå½“å‰çš„è¯„æµ‹æŒ‡æ ‡å­˜åœ¨çš„ç¼ºé™·ï¼šå¯¹äºè¯­å¥ç›¸ä¼¼åº¦æ•æ‰ä¸å¤Ÿï¼Œä¾ç„¶ä¸¥é‡ä¾èµ–å•è¯å’ŒçŸ­å¥çš„ç›¸ä¼¼åº¦ï¼Œå› æ­¤åœ¨å¾ˆå¤šæ—¶å€™å‚è€ƒç­”æ¡ˆå¾ˆçŸ­ï¼Œè€Œ GPT-4 ç”Ÿæˆçš„ç­”æ¡ˆå¾ˆé•¿ï¼Œä¼šè¢« ROUGE è¿™æ ·çš„æŒ‡æ ‡åˆ¤å®šä¸ºç­”æ¡ˆä¸åŒ¹é…ï¼Œè€Œäººå·¥æ£€æŸ¥åå‘ç° GPT-4 çš„ç­”æ¡ˆæ›´åŠ é«˜è´¨é‡å’Œå…·æœ‰è¯´æœåŠ›ã€‚ å¦ä¸€æ–¹é¢ä½œè€…ä¹Ÿæµ‹è¯•äº†ç”¨ GPT-4 ä½œä¸ºè¯„åˆ†å‘˜ï¼Œå¯¹å›ç­”è¿›è¡Œæ‰“åˆ†ï¼Œå®éªŒç°å®å°½ç®¡è·ç¦»äººç±»æ‰“åˆ†è¿˜å­˜åœ¨ä¸€äº›å·®è·ï¼Œä½†åœ¨ä¸€äº›å¼ºçº¦æŸçš„åœºæ™¯ä¸‹å·²ç»å¾ˆå…·æœ‰ç«äº‰åŠ›äº†ã€‚ è‡ªå›å½’ç»“æ„çš„å±€é™æ€§ è‡ªå›å½’ç»“æ„çš„è¾“å‡ºæ˜¯å®æ—¶è¿›è¡Œçš„ï¼Œå› æ­¤ä¸å­˜åœ¨â€œæ‰“è‰ç¨¿â€çš„æœºä¼šï¼Œå› æ­¤æ— æ³•â€œstep-by-stepâ€åœ°å¤„ç†é—®é¢˜ï¼Œè€Œå¼•å…¥æ€ç»´é“¾åˆ™å¯ä»¥æ˜¾è‘—åœ°æå‡æ¨¡å‹å‡†ç¡®åº¦ã€‚ å¯¹äºä¸€äº›ä¾èµ–é€’å½’å›æº¯çš„é—®é¢˜ï¼Œæ¯”å¦‚ä¸€æ­¥ä¸€æ­¥è¾“å‡ºæ±‰è¯ºå¡”é—®é¢˜çš„è§£æ³•ï¼ŒGPT-4 è¡¨ç°éå¸¸å·®ï¼Œåœ¨è§£å†³ä¸èƒ½ä»¥è¿ç»­æ–¹å¼å¤„ç†çš„å¤æ‚æˆ–åˆ›é€ æ€§é—®é¢˜æ—¶ï¼Œéƒ½æš´éœ²å‡ºäº†ä¸¥é‡çš„å±€é™æ€§ã€‚ æ¯”å¦‚è¦æ±‚ GPT-4 ä¿®æ”¹â€œ9 * 4 + 6 * 6 = 72â€è¿™ä¸ªç­‰å¼å·¦è¾¹çš„ä¸€ä¸ªæ•°å­—ï¼Œæ¥è®©ç­‰å¼è®¡ç®—ç»“æœå˜æˆ 99ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ— æ³•ç®€å•â€œstep-by-stepâ€æ¨ç†å¾—åˆ°ç­”æ¡ˆçš„é—®é¢˜ï¼ŒGPT-4 æœ€åçš„å‡†ç¡®ç‡ä¹Ÿéå¸¸ä½ã€‚ è¿™ä¸€èŠ‚çš„è®¨è®ºä¸­ï¼Œä½œè€…æŒ‡å‡ºï¼Œç†è§£è¿™äº›å±€é™æ€§çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ç±»æ¯”è¯ºå¥–ä½œè€…å¡å°¼æ›¼æå‡ºçš„â€œå¿«æ€è€ƒâ€å’Œâ€œæ…¢æ€è€ƒâ€çš„æ¦‚å¿µã€‚å¡å°¼æ›¼è®¤ä¸ºäººç±»æ€ç»´åˆ†æˆå¿«ã€æ…¢ä¸¤ä¸ªç³»ç»Ÿï¼Œå¿«æ€è€ƒæ˜¯ä¸€ç§è‡ªåŠ¨çš„ã€ç›´è§‚çš„ã€ä¸éœ€è¦èŠ±è´¹ç²¾åŠ›çš„æ€è€ƒæ–¹å¼ï¼Œé€Ÿåº¦å¿«ä½†æ˜¯å®¹æ˜“å‡ºé”™å’Œåè§ã€‚æ…¢æ€è€ƒæ˜¯ä¸€ç§å—æ§çš„ã€ç†æ€§çš„ã€è€—è´¹ç²¾åŠ›çš„æ€è€ƒæ–¹å¼ï¼Œè™½ç„¶é€Ÿåº¦æ…¢ä½†æ˜¯å‡†ç¡®å¯é ã€‚ å½“å‰çš„ GPT-4 å¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥çœ‹æˆæ˜¯åœ¨æ‰§è¡Œå¿«æ€è€ƒï¼Œä½†ç¼ºå°‘æ…¢æ€è€ƒèƒ½åŠ›ã€‚ æœªæ¥æ–¹å‘ ä½œè€…åœ¨è¿™ä¸€èŠ‚æ€»ç»“äº†æœªæ¥ GPT-4 å¯ä»¥ç ”ç©¶å’Œæ”¹è¿›çš„æ–¹å‘ï¼š ç½®ä¿¡åº¦æ ¡éªŒï¼šæ¨¡å‹çš„è¾“å‡ºç¼ºä¹ç½®ä¿¡åº¦ï¼Œæ—¢ä¼šç¼–é€ è®­ç»ƒé›†ä¸­æ²¡æœ‰çš„å†…å®¹ï¼ˆopen-domain å¹»è§‰ï¼‰ï¼Œä¹Ÿä¼šç”Ÿæˆä¸ Prompt ä¸ä¸€è‡´çš„å†…å®¹ï¼ˆclose-domain å¹»è§‰ï¼‰ BP Network é•¿æœŸè®°å¿†ï¼šå³é•¿çš„ä¸Šä¸‹æ–‡ æŒç»­å­¦ä¹ ï¼šå½“å‰å¾®è°ƒå’Œè‡ªæˆ‘æ›´æ–°æˆæœ¬è¿‡é«˜ã€ç¼ºä¹æœ‰æ•ˆä¸”ç¨³å®šçš„æ‰‹æ®µï¼ˆä¿æŒå·²æœ‰èƒ½åŠ›ä¸ä¸¢å¤±å’Œé—å¿˜ï¼‰ ä¸ªæ€§åŒ–ï¼šæ ¹æ®åº”ç”¨å’Œéœ€æ±‚è¿›è¡Œå®šåˆ¶ã€æ‰®æ¼”ã€è°ƒæ•´é£æ ¼ç­‰ æå‰è§„åˆ’å’Œæ¦‚å¿µæ€§è·³è·ƒï¼šæ¨ç†è¿‡ç¨‹è¿‡äºçº¿æ€§ï¼Œåœ¨éœ€è¦æ€ç»´è·³è·ƒæ€§çš„ä»»åŠ¡ä¸Šè¡¨ç°ä¸ä½³ é€æ˜åº¦ã€å¯è§£é‡Šæ€§å’Œä¸€è‡´æ€§ è®¤çŸ¥è°¬è¯¯å’Œéç†æ€§ï¼šæ•°æ®ä¸­å­˜åœ¨çš„åè§ã€æˆè§æˆ–é”™è¯¯å¼•å…¥äº†è®¤çŸ¥åå·®å’Œéç†æ€§ å¯¹è¾“å…¥çš„æ•æ„Ÿæ€§ï¼šå¯¹äº Prompt è¿‡äºæ•æ„Ÿï¼Œé²æ£’æ€§ä¸å¤Ÿ è¿™äº›å±€é™æ€§å‡æŒ‡å‘ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šå“ªäº›ç¼ºé™·æ˜¯è‡ªå›å½’æ¶æ„çš„å…ˆå¤©ç¼ºé™·ï¼Œå“ªäº›æ˜¯åœ¨å·²æœ‰æ¶æ„ä¸Šå¯ä»¥é€šè¿‡å¤„ç†æ•°æ®ã€å¢åŠ å¤–æŒ‚çš„ç»„ä»¶å’Œå¢å¤§å‚æ•°é‡è§£å†³çš„ã€‚ ","date":"2024-05-03","objectID":"/posts/survey/:8:0","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["LLM"],"content":"7. The Dawn of LMMs: Preliminary Explorations with GPT-4V(ision) (2309.17421) å¾®è½¯å‘å¸ƒçš„ 166 é¡µçš„ GPT-4V æŠ¥å‘Šï¼Œä¸»è¦å›´ç»•ä»¥ä¸‹å››ä¸ªç‚¹è¿›è¡Œå±•å¼€ç ”ç©¶ï¼š GPT-4V æ”¯æŒå“ªäº›è¾“å…¥å’Œå·¥ä½œæ¨¡å¼ï¼Ÿ GPT-4V åœ¨ä¸åŒé¢†åŸŸå’Œä»»åŠ¡ä¸Šçš„èƒ½åŠ›è´¨é‡å’Œé€šç”¨æ€§å¦‚ä½•ï¼Ÿ GPT-4V æœ‰æ•ˆä½¿ç”¨å’Œæç¤ºæ–¹æ³•æœ‰å“ªäº›ï¼Ÿ æœªæ¥æœ‰å“ªäº›æœ‰å‰é€”çš„æ–¹å‘ï¼Ÿ GPT-4V çš„è¾“å…¥æ¨¡å¼ çº¯æ–‡æœ¬ å•ä¸ªå›¾åƒ-æ–‡æœ¬å¯¹ å›¾åƒæ–‡æœ¬äº¤æ›¿è¾“å…¥ å‰ä¸¤ç§ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œç¬¬ä¸‰ç§äº¤æ›¿è¾“å…¥çš„æƒ…å†µï¼Œå·²ç»éå¸¸æ¥è¿‘äºäººçš„èŠå¤©æ¨¡å¼äº†ã€‚ BP Network GPT-4V çš„å·¥ä½œæ¨¡å¼å’Œæç¤ºæŠ€æœ¯ å®éªŒè¯æ˜ï¼Œåœ¨ LLM ä¸Šç ”ç©¶å‡ºæ¥ä¸Šå„ç§æç¤ºæŠ€æœ¯ï¼Œåœ¨ GPT-4V ä¸Šä¹Ÿæ˜¯å¥½ä½¿çš„ï¼Œæ¯”å¦‚æ€ç»´é“¾ã€few-shot æç¤ºç­‰ã€‚ è¿™ä¸€èŠ‚æåˆ°äº†ä¸€ä¸ªâ€œLLMs donâ€™t want to succeedâ€çš„ç†è®ºï¼Œè²Œä¼¼æ˜¯æ¥è‡ªäº Andrej Karpathy çš„æŸæ¬¡æ¼”è®²ï¼Œé‡Œé¢å±•ç¤ºäº†ä¸€ç§ç±»ä¼¼äºå‚¬çœ ä¸€æ ·çš„æç¤ºæŠ€æœ¯ï¼Œå³ï¼Œä½ æƒ³è¦ä½ çš„ LLM è¡¨ç°æ›´å‡ºè‰²ï¼Œä½ å°±è¦ç”¨ç›´æ¥çš„æç¤ºè¯è¯´â€œä½ æ˜¯xxxæ–¹é¢çš„ä¸“å®¶â€ï¼Œå¦åˆ™å®ƒä¹‹åè¡¨ç°å‡ºä¸€èˆ¬æ™®é€šäººæ°´å¹³çš„èƒ½åŠ›ã€‚ BP Network å®Œæ•´çš„ PPT å¯ä»¥çœ‹è¿™é‡Œï¼šhttps://karpathy.ai/stateofgpt.pdf åœ¨è®ºæ–‡ä¸­ä½œè€…æ˜¯ä¸¾äº†ä¸€ä¸ªæ•°è‹¹æœçš„æ¡ˆä¾‹ï¼Œè®© GPT-4V æ¥æ•°ä¸€ä¸‹ç”»é¢ä¸­æœ‰å‡ ä¸ªè‹¹æœã€‚ä¸€å¼€å§‹ GPT-4V å¹¶ä¸èƒ½è½»æ˜“å¾—åˆ°æ­£ç¡®ç­”æ¡ˆï¼Œä½†ç»è¿‡ä¸€ç³»åˆ—æˆ‘ä»¬å·²çŸ¥çš„ LLM Prompt æŠ€å·§åŠ å¼ºåï¼ŒGPT-4V å˜å¾—å¯é ï¼Œèƒ½å¤Ÿæ­£ç¡®è®¡æ•°ï¼š BP Network åœ¨æ—¥å¸¸çš„äººå’Œäººäº¤äº’ä¸­ï¼Œåœ¨å›¾ç‰‡ä¸­ç”»åœˆã€ç”»ç®­å¤´æ¥æŒ‡å‘å…³é”®ä¿¡æ¯æ˜¯ä¸€ç§å¾ˆè‡ªç„¶ä¸”å¸¸è§çš„æ–¹å¼ï¼Œ ç»å®éªŒ GPT-4V åœ¨è¿™æ–¹é¢çš„ç†è§£èƒ½åŠ›éå¸¸å¼ºå¤§ã€‚ BP Network ä½œè€…å®éªŒäº†ä¸€äº›å¾ˆæœ‰æŒ‘æˆ˜æ€§çš„ caseï¼Œå‘ç°åŸºæœ¬ä¸Šéš¾ä¸å€’å®ƒï¼š BP Network åœ¨ In-context few-shot learning æ–¹é¢ï¼Œä½œè€…ä¹Ÿç”¨ä¸€ä¸ªå¾ˆæœ‰ä»£è¡¨æ€§çš„ä¾‹å­è¯´æ˜äº†æä¾›ç¤ºä¾‹æ ·æœ¬çš„é‡è¦æ€§ã€‚ä½œè€…ç»™äº†ä¸€å¼ ä»ªè¡¨çš„å›¾ï¼Œè®© GPT-4V è¯»å‡ºå½“å‰ä»ªè¡¨æŒ‡é’ˆæŒ‡å‘çš„æ•°å€¼ï¼Œä¸€å¼€å§‹ä¸è®ºå¦‚ä½•æ”¹è‰¯ prompt éƒ½æ— æ³•å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ BP Network ç”šè‡³åœ¨ç»™å‡ºä¸€ä¸ªç¤ºä¾‹çš„æƒ…å†µä¸‹æ¨¡å‹ä»ç„¶è¡¨ç°ä¸ä½³ï¼Œä½†å½“ç¤ºä¾‹å¢åŠ åˆ°ä¸¤ä¸ªåï¼ŒGPT-4V å°±çªç„¶èƒ½æˆåŠŸè¯»æ•°äº†ï¼Œå¯è§æä¾›ä¸Šä¸‹æ–‡ç¤ºä¾‹å¯¹äºæå‡å¤§æ¨¡å‹æ€§èƒ½è‡³å…³é‡è¦ã€‚ BP Network BP Network è§†è§‰è¯­è¨€èƒ½åŠ› åœ¨å¤§éƒ¨åˆ†å·²æœ‰çš„ CV å­ä»»åŠ¡ä¸Šï¼ŒGPT-4V éƒ½è¡¨ç°å‡ºäº†ä¸é”™çš„èƒ½åŠ›ï¼Œå¸¸è§çš„åœºæ™¯æè¿°ç­‰æ›´æ˜¯è¡¨ç°å‡ºè‰²ï¼Œåœ¨ç›¸å¯¹å°ä¼—çš„é¢†åŸŸï¼Œå¦‚åŒ»å­¦å›¾åƒä¸Šï¼ŒåŒæ ·è®©äººå°è±¡æ·±åˆ»ï¼ŒGPT-4V å¯ä»¥æ ¹æ® CT å›¾åˆ¤æ–­å‡ºæ™ºé½¿å’Œéª¨æŠ˜ç­‰ã€‚ BP Network å½“ç„¶ï¼Œåœ¨ä¸€äº›å·²ç»è¢«åšå¾—éå¸¸æ·±å…¥çš„å­ä»»åŠ¡ä¸Šï¼ŒGPT-4V ç›¸è¾ƒäº SOTA æ¨¡å‹è¿˜æœ‰ä¸å°çš„å·®è·ï¼Œä½†è¿˜æ˜¯é‚£å¥è¯ï¼Œæ½œåŠ›å¤§äºç»å¯¹ç²¾åº¦ï¼Œç›®å‰ GPT-4V å·²ç»å±•ç°å‡ºäº†è®©äººé¼“èˆçš„æ€§èƒ½ï¼Œä¼˜åŒ–ä¸ªåˆ«ä»»åŠ¡ä¸Šçš„è¡¨ç°åªæ˜¯æ—¶é—´é—®é¢˜ã€‚ BP Network GPT-4V ç”šè‡³èƒ½çœ‹æ‡‚æ¢—å›¾ï¼Œè§£é‡Šå…¶ä¸­çš„ç¬‘ç‚¹ï¼š BP Network å€ŸåŠ© GPT-4V å¼ºå¤§çš„æ¨ç†èƒ½åŠ›å’Œå…·å¤‡çš„å¸¸è¯†ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥â€œå‡å¦‚ä½ æ˜¯ä¸€åä¾¦æ¢ï¼Œä½ å¯ä»¥ä»å›¾ä¸­æ¨ç†å‡ºå“ªäº›çº¿ç´¢ï¼Ÿâ€ BP Network æ—¶é—´åºåˆ—å’Œè§†é¢‘ç†è§£ ä½œè€…å®éªŒäº†å¤šå›¾åƒåºåˆ—ï¼ŒGPT-4V èƒ½å¤Ÿè¯†åˆ«å‡ºè¿™æ˜¯ä¸€ç»„åŠ¨æ€å›¾åƒåºåˆ—ï¼Œå¹¶ä¸”èƒ½ç»“åˆèµ·æ¥åˆ¤æ–­ç”»é¢ä¸­çš„äººæ­£åœ¨åšä¿¯å§æ’‘ï¼š BP Network æƒ…å•†æµ‹è¯• åœ¨è¿™ä¸€èŠ‚ï¼ŒGPT-4V å¯ä»¥åŸºäºäºˆä»¥å†…å®¹å’Œå›¾åƒæ ·å¼è§£é‡Šè§†è§‰æƒ…æ„Ÿï¼Œå¦‚æ»¡æ„ã€æ„¤æ€’ã€æ•¬ç•å’Œææƒ§ç­‰ï¼š BP Network ç”šè‡³å¯ä»¥ä¸€å¼ å›¾ç‰‡è®© GPT-4V ç”¨ä¸¤ç§ä¸åŒæ–¹å¼æ¥æè¿°ï¼Œåˆ†åˆ«è®©äººæ„Ÿåˆ°ä¸å®‰å’Œæ„Ÿåˆ°èˆ’é€‚ï¼ˆæ–°é—»å­¦è®©å®ƒç©æ˜ç™½äº†ï¼‰ï¼š BP Network æ–°å…´åº”ç”¨äº®ç‚¹ è¡Œä¸šï¼š ç¼ºé™·æ£€æµ‹ å®‰å…¨æ£€æŸ¥ æ‚è´§ç»“è´¦ åŒ»ç–— æ±½è½¦ä¿é™© æŸå®³è¯„ä¼° ä¿é™©æŠ¥å‘Š å®šåˆ¶åŒ– ç…§ç‰‡ç»„ç»‡ å¯†é›†æ ‡æ³¨ä¸åˆ†å‰² å›¾åƒç”Ÿæˆ ç”Ÿæˆå›¾åƒçš„è¯„ä¼° å›¾åƒç¼–è¾‘çš„æç¤ºç”Ÿæˆ å…·è±¡åŒ–æ™ºèƒ½ä½“ æ“ä½œæœºå™¨ å¯¼èˆª GUI å¯¼èˆªï¼ˆè½¯ä»¶å±‚é¢çš„äº¤äº’å’Œå¯¼èˆªï¼‰ æ•´ç¯‡æŠ¥å‘Šç¯‡å¹…è¾ƒå¤šï¼Œå¹¶ä¸”ä¸¾äº†å¤§é‡è¯¦ç»†çš„ä¾‹å­ï¼Œåœ¨è¿™é‡Œå°±ä¸ä¸€ä¸€å±•å¼€äº†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œç¿»é˜…ã€‚ è‡³æ­¤ï¼Œæˆ‘æ€»ç»“äº† GPT ç³»åˆ—å·¥ä½œé‡Œä¸€äº›æˆ‘å…³æ³¨åˆ°çš„ç‚¹ï¼Œä»ä¸­å¯ä»¥æ„Ÿå—åˆ° OpenAI çš„å·¥ä½œä¹‹é—´éƒ½æœ‰ç€å¾ˆæ·±çš„é€»è¾‘é“¾æ¡ï¼Œå¾ˆå¤šæ¨å¹¿éƒ½ä¼¼ä¹æ˜¯æœ€ç¬¦åˆç›´è§‰çš„ã€‚OpenAI æ—©æœŸå…¬å¼€çš„è®ºæ–‡é‡Œå„ç§ç»†èŠ‚è¿˜æ˜¯å¾ˆä¸°å¯Œçš„ï¼Œä¸ä»…ç»†è‡´åœ°å‘Šè¯‰ä½ å¦‚ä½•æ¸…æ´—å’Œæ„é€ æ•°æ®ï¼Œç”šè‡³è¿˜æ•™ä½ å¦‚ä½•æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æ ‡æ³¨å‘˜ç»™ä½ æ ‡æ•°æ®ã€‚ ä½œä¸ºä¸€ä¸ªä» CV è½¬åˆ° LLM çš„æ–°äººï¼Œéš¾å…çŠ¯ä¸€äº›å¸¸è§æˆ–ä½çº§çš„é”™è¯¯ï¼Œæ¬¢è¿ä»»ä½•è¯»è€…åŠæ—¶æŒ‡å‡ºå’Œæ–§æ­£ï¼Œä¹Ÿæ¬¢è¿ä»»ä½•ç•™è¨€è®¨è®ºã€‚ æœ¬ç¯‡ç¬”è®°çš„å†™ä½œå‚è€ƒäº†æ²ç¥çš„å‡ æœŸ B ç«™è§†é¢‘ï¼Œä»¥åŠçŸ¥ä¹@è‹æ‰“çš„æ–‡ç« ï¼Œç‰¹æ­¤æ„Ÿè°¢ ","date":"2024-05-03","objectID":"/posts/survey/:8:1","tags":["GPT"],"title":"å¤§æ¨¡å‹å­¦ä¹ ç¬”è®° | GPT ç³»åˆ—","uri":"/posts/survey/"},{"categories":["DL"],"content":"1ã€â­softmaxå¦‚ä½•é˜²æ­¢æŒ‡æ•°ä¸Šæº¢ åŸsoftmaxå…¬å¼ï¼š å·¥ç¨‹åŒ–å®ç°ï¼Œé˜²æ­¢æŒ‡æ•°ä¸Šæº¢ï¼š ï¼Œä½¿aç­‰äºxä¸­æœ€å¤§å€¼ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:1","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"2ã€â­Transformerä¸­çš„positional encoding ä¸ºä»€ä¹ˆéœ€è¦PE: å› ä¸ºtransfomeræ˜¯åŒæ—¶å¤„ç†æ‰€æœ‰è¾“å…¥çš„ï¼Œå¤±å»äº†ä½ç½®ä¿¡æ¯ã€‚ ç¼–ç åº”è¯¥æ»¡è¶³çš„æ¡ä»¶ï¼šaã€å¯¹äºæ¯ä¸ªä½ç½®è¯è¯­ï¼Œç¼–ç æ˜¯å”¯ä¸€çš„ bã€è¯è¯­ä¹‹é—´çš„é—´éš”å¯¹äºä¸åŒé•¿åº¦å¥å­æ˜¯ä¸€è‡´çš„ cã€èƒ½é€‚åº”ä»»æ„é•¿åº¦å¥å­ å…¬å¼ï¼šæ¯ä¸ªè¯è¯­ä½ç½®ç¼–ç ä¸ºä¸åŒé¢‘ç‡çš„ä½™å¼¦å‡½æ•°ï¼Œä»1åˆ°1/10000ã€‚å¦‚ä¸‹å°†æ¯ä¸ªè¯è¯­ä½ç½®ç¼–ç ä¸ºdç»´å‘é‡â€“\u003e å¯ç†è§£ä¸ºä¸€ç§äºŒè¿›åˆ¶ç¼–ç ï¼ŒäºŒè¿›åˆ¶çš„ä¸åŒä½å˜åŒ–é¢‘ç‡ä¸ä¸€æ ·ï¼ŒPEçš„ä¸åŒä½ç½®å˜åŒ–é¢‘ç‡ä¹Ÿä¸ä¸€æ · å¦‚ä½•è·å–ç›¸å¯¹ä½ç½®å…³ç³»ï¼šä¸¤ä¸ªä½ç½®ç¼–ç è¿›è¡Œç‚¹ç§¯ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:2","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"3ã€â­æ±‚ä¼¼ç„¶å‡½æ•°æ­¥éª¤ å®šä¹‰ï¼šæ¦‚ç‡æ˜¯ç»™å®šå‚æ•°ï¼Œæ±‚æŸä¸ªäº‹ä»¶å‘ç”Ÿæ¦‚ç‡ï¼›ä¼¼ç„¶åˆ™æ˜¯ç»™å®šå·²å‘ç”Ÿçš„äº‹ä»¶ï¼Œä¼°è®¡å‚æ•°ã€‚ å†™å‡ºä¼¼ç„¶å‡½æ•° å¯¹ä¼¼ç„¶å‡½æ•°å–å¯¹æ•°å¹¶æ•´ç† æ±‚å¯¼æ•°ï¼Œå¯¼æ•°ä¸º0å¤„ä¸ºæœ€ä½³å‚æ•° è§£ä¼¼ç„¶æ–¹ç¨‹ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:3","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"4ã€â­HMMå’ŒCRFåŒºåˆ« CRFæ˜¯åˆ¤åˆ«æ¨¡å‹ï¼Œå¯¹é—®é¢˜çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒå»ºæ¨¡ï¼›HMMæ˜¯ç”Ÿæˆæ¨¡å‹ï¼Œå¯¹è”åˆæ¦‚ç‡åˆ†å¸ƒå»ºæ¨¡ HMMæ˜¯æ¦‚ç‡æœ‰å‘å›¾ï¼ŒCRFæ˜¯æ¦‚ç‡æ— å‘å›¾ HMMæ±‚è§£è¿‡ç¨‹å¯èƒ½æ˜¯å±€éƒ¨æœ€ä¼˜ï¼ŒCRFæ˜¯å…¨å±€æœ€ä¼˜ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:4","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"5ã€â­ç©ºæ´å·ç§¯å®ç° ç›¸æ¯”äºå¸¸è§„å·ç§¯å¤šäº†dilation rateè¶…å‚æ•°ï¼Œä¾‹å¦‚dilation rate=2ä»£è¡¨ç›¸é‚»ä¸¤ä¸ªå·ç§¯ç‚¹è·ç¦»ä¸º2ï¼Œå¦‚å›¾(b)ã€‚ å­˜åœ¨é—®é¢˜ï¼šgridding effect, ç”±äºå·ç§¯çš„åƒç´ æœ¬è´¨ä¸Šæ˜¯é‡‡æ ·å¾—åˆ°çš„ï¼Œæ‰€ä»¥å›¾åƒçš„å±€éƒ¨ç›¸å…³æ€§ä¸¢å¤±äº†ï¼ŒåŒæ—¶è¿œè·ç¦»å·ç§¯å¾—åˆ°çš„ä¿¡æ¯ä¹Ÿæ²¡æœ‰ç›¸å…³æ€§ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:5","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"6ã€â­æ±‰æ˜è·ç¦» ä¸¤ä¸ªå­—ç¬¦ä¸²å¯¹åº”ä½ç½®çš„ä¸åŒå­—ç¬¦çš„ä¸ªæ•°ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:6","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"7ã€â­è®­ç»ƒè¿‡ç¨‹ä¸­å‘ç°losså¿«é€Ÿå¢å¤§åº”è¯¥ä»å“ªäº›æ–¹é¢è€ƒè™‘? å­¦ä¹ ç‡è¿‡å¤§ è®­ç»ƒæ ·æœ¬ä¸­æœ‰åæ•°æ® ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:7","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"8ã€â­Pytorchå’ŒTensorFlowåŒºåˆ« å›¾ç”Ÿæˆï¼špytorchåŠ¨æ€å›¾ï¼Œtensorflowé™æ€å›¾ è®¾å¤‡ç®¡ç†ï¼špytorch cudaï¼Œtensorflow è‡ªåŠ¨åŒ– ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:8","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"9ã€â­model.eval vså’Œtorch.no_gradåŒºåˆ« model.eval: ä¾ç„¶è®¡ç®—æ¢¯åº¦ï¼Œä½†æ˜¯ä¸åä¼ ï¼›dropoutå±‚ä¿ç•™æ¦‚ç‡ä¸º1ï¼›batchnormå±‚ä½¿ç”¨å…¨å±€çš„meanå’Œvar with torch.no_grad: ä¸è®¡ç®—æ¢¯åº¦ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:9","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"10ã€â­æ¯ä¸ªå·ç§¯å±‚çš„FLOPSè®¡ç®— å³è®¡ç®—feature mapæ¯ä¸ªç‚¹éœ€è¦çš„ä¹˜æ³•å’ŒåŠ æ³•è¿ç®—é‡ï¼Œå®šä¹‰ä¸€ä¸ªä¹˜æ³•å’ŒåŠ æ³•ä¸ºä¸€æ¬¡flopï¼Œåˆ™FLOPSè®¡ç®—å¦‚ä¸‹ï¼š ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:10","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"11ã€â­PCA(ä¸»æˆåˆ†åˆ†æ) â­PCAæ˜¯ä¸€ç§é™ç»´æ–¹æ³•ï¼Œç”¨æ•°æ®é‡Œé¢æœ€ä¸»è¦çš„æ–¹é¢æ¥ä»£æ›¿åŸå§‹æ•°æ®ï¼Œä¾‹å¦‚å°†$m$ä¸ª$n$ç»´æ•°æ®é™ç»´åˆ°$nâ€™$ç»´ï¼Œå¸Œæœ›è¿™$m$ä¸ª$nâ€™$ç»´æ•°æ®å°½å¯èƒ½åœ°ä»£è¡¨åŸæ•°æ®ã€‚ â­ä¸¤ä¸ªåŸåˆ™ï¼šæœ€è¿‘é‡æ„æ€§â€“\u003eæ ·æœ¬ç‚¹åˆ°è¿™ä¸ªè¶…å¹³é¢çš„è·ç¦»è¶³å¤Ÿè¿‘ï¼›æœ€å¤§å¯åˆ†æ€§â€“\u003eæ ·æœ¬ç‚¹åœ¨è¿™ä¸ªè¶…å¹³é¢çš„æŠ•å½±å°½å¯èƒ½çš„åˆ†å¼€ã€‚ â­æµç¨‹ï¼šåŸºäºç‰¹å¾å€¼åˆ†è§£åæ–¹å·®çŸ©é˜µå’ŒåŸºäºå¥‡å¼‚å€¼åˆ†è§£SVDåˆ†è§£åæ–¹å·®çŸ©é˜µã€‚ ï¼ˆ1ï¼‰å¯¹æ‰€æœ‰æ ·æœ¬è¿›è¡Œä¸­å¿ƒåŒ– ï¼ˆ2ï¼‰è®¡ç®—æ ·æœ¬çš„åæ–¹å·®çŸ©é˜µ$XX^T$ ï¼ˆ3ï¼‰å¯¹åæ–¹å·®çŸ©é˜µè¿›è¡Œç‰¹å¾å€¼åˆ†è§£ ï¼ˆ4ï¼‰å–å‡ºæœ€å¤§çš„$nâ€™$ä¸ªç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œå°†æ‰€æœ‰ç‰¹å¾å‘é‡æ ‡å‡†åŒ–ï¼Œç»„æˆç‰¹å¾å‘é‡çŸ©é˜µW ï¼ˆ5ï¼‰å¯¹æ ·æœ¬é›†ä¸­çš„æ¯ä¸€ä¸ªæ ·æœ¬$x^(i)$è½¬åŒ–ä¸ºæ–°çš„æ ·æœ¬$z^(i)=W^T x^(i)$ï¼Œå³å°†æ¯ä¸ªåŸæ•°æ®æ ·æœ¬æŠ•å½±åˆ°ç‰¹å¾å‘é‡ç»„æˆçš„ç©ºé—´ä¸Š ï¼ˆ6ï¼‰å¾—åˆ°è¾“å‡ºçš„æ ·æœ¬é›†$z^(1)ã€z^(2)â€¦$ â­æ„ä¹‰ï¼šaã€ä½¿å¾—ç»“æœå®¹æ˜“ç†è§£ bã€æ•°æ®é™ç»´ï¼Œé™ä½ç®—æ³•è®¡ç®—å¼€é”€ cã€å»é™¤å™ªå£° ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:11","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"12ã€â­k-meanså¦‚ä½•æ”¹è¿›ï¼Ÿ â­ç¼ºç‚¹ï¼š1ã€kä¸ªåˆå§‹åŒ–çš„è´¨å¿ƒå¯¹æœ€åçš„èšç±»æ•ˆæœæœ‰å¾ˆå¤§å½±å“ 2ã€å¯¹ç¦»ç¾¤ç‚¹å’Œå­¤ç«‹ç‚¹æ•æ„Ÿ 3ã€Kå€¼äººä¸ºè®¾å®š â­æ”¹è¿›ï¼š K-means++ï¼šä»æ•°æ®é›†éšæœºé€‰æ‹©ä¸€ä¸ªç‚¹ä½œä¸ºç¬¬ä¸€ä¸ªèšç±»ä¸­å¿ƒï¼Œå¯¹äºæ•°æ®é›†ä¸­æ¯ä¸€ä¸ªç‚¹è®¡ç®—å’Œè¯¥ä¸­å¿ƒçš„è·ç¦»ï¼Œé€‰æ‹©ä¸‹ä¸€ä¸ªèšç±»ä¸­å¿ƒï¼Œä¼˜å…ˆé€‰æ‹©å’Œä¸Šä¸€ä¸ªèšç±»ä¸­å¿ƒè·ç¦»è¾ƒå¤§çš„ç‚¹ã€‚é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œå¾—åˆ°kä¸ªèšç±»ä¸­å¿ƒã€‚ K-medoidsï¼šè®¡ç®—è´¨å¿ƒæ—¶ï¼Œè´¨å¿ƒä¸€å®šæ˜¯æŸä¸ªæ ·æœ¬å€¼çš„ç‚¹ã€‚è·ç¦»åº¦é‡ï¼šæ¯ä¸ªæ ·æœ¬å’Œæ‰€æœ‰å…¶ä»–æ ·æœ¬çš„æ›¼å“ˆé¡¿è·ç¦»$((x,y), |x|+|y|)$ã€‚ ISODATAï¼Œåˆç§°ä¸ºè¿­ä»£è‡ªç»„ç»‡æ•°æ®åˆ†ææ³•ï¼Œæ˜¯ä¸ºäº†è§£å†³Kå€¼éœ€è¦äººä¸ºè®¾å®šçš„é—®é¢˜ã€‚æ ¸å¿ƒæ€æƒ³ï¼šå½“å±äºæŸä¸ªç±»åˆ«çš„æ ·æœ¬æ•°è¿‡å°‘æ—¶æˆ–è€…ç±»åˆ«ä¹‹é—´é å¾—éå¸¸è¿‘å°±å°†è¯¥ç±»åˆ«å»é™¤ï¼›å½“å±äºæŸä¸ªç±»åˆ«çš„æ ·æœ¬æ•°è¿‡å¤šæ—¶ï¼ŒæŠŠè¿™ä¸ªç±»åˆ«åˆ†ä¸ºä¸¤ä¸ªå­ç±»åˆ«ã€‚ â­å’Œåˆ†ç±»é—®é¢˜çš„åŒºåˆ«ï¼šåˆ†ç±»çš„ç±»åˆ«å·²çŸ¥ï¼Œä¸”éœ€è¦ç›‘ç£ï¼›k-meansæ˜¯èšç±»é—®é¢˜ï¼Œç±»åˆ«æœªçŸ¥ï¼Œä¸éœ€è¦ç›‘ç£ã€‚ â­ç»ˆæ­¢æ¡ä»¶ï¼šaã€ç›¸é‚»ä¸¤è½®è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œéè´¨å¿ƒç‚¹æ‰€å±ç°‡å‘ç”Ÿæ”¹å˜çš„æ¯”ä¾‹å°äºæŸä¸ªé˜ˆå€¼ bã€æ‰€æœ‰ç°‡çš„è´¨å¿ƒå‡æœªæ”¹å˜ cã€è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•° â­æ—¶é—´å¤æ‚åº¦ï¼š$O(è¿­ä»£æ¬¡æ•° \\ast æ•°æ®ä¸ªæ•° \\ast k \\ast æ•°æ®ç»´åº¦)$ï¼Œkä¸ºkä¸ªç±»åˆ«ä¸­å¿ƒ â­ç©ºé—´å¤æ‚åº¦ï¼š$O(æ•°æ®ä¸ªæ•° \\ast æ•°æ®ç»´åº¦+k \\ast æ•°æ®ç»´åº¦)$ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:12","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"13ã€â­Dropoutå®ç° ä»¥pçš„æ¦‚ç‡ä½¿ç¥ç»å…ƒå¤±æ•ˆï¼Œå³ä½¿å…¶æ¿€æ´»å‡½æ•°è¾“å‡ºå€¼ä¸º0ï¼š ä¸ºäº†ä½¿è®­ç»ƒå’Œæµ‹è¯•é˜¶æ®µè¾“å‡ºå€¼æœŸæœ›ç›¸åŒï¼Œéœ€è¦åœ¨è®­ç»ƒæ—¶å°†è¾“å‡ºå€¼ä¹˜ä»¥1/(1-p)æˆ–è€…åœ¨æµ‹è¯•æ—¶å°†æƒé‡å€¼ä¹˜ä»¥(1-p)ã€‚ Dropoutå’ŒBatch normèƒ½å¦ä¸€èµ·ä½¿ç”¨ï¼Ÿ å¯ä»¥ï¼Œä½†æ˜¯åªèƒ½å°†Dropoutæ”¾åœ¨Batch normä¹‹åä½¿ç”¨ã€‚å› ä¸ºDropoutè®­ç»ƒæ—¶ä¼šæ”¹å˜è¾“å…¥Xçš„æ–¹å·®ï¼Œä»è€Œå½±å“Batch normè®­ç»ƒè¿‡ç¨‹ä¸­ç»Ÿè®¡çš„æ»‘åŠ¨æ–¹å·®å€¼ï¼›è€Œæµ‹è¯•æ—¶æ²¡æœ‰Dropoutï¼Œè¾“å…¥Xçš„æ–¹å·®å’Œè®­ç»ƒæ—¶ä¸ä¸€è‡´ï¼Œè¿™å°±å¯¼è‡´Batch normæµ‹è¯•æ—¶æœŸæœ›çš„æ–¹å·®å’Œè®­ç»ƒæ—¶ç»Ÿè®¡çš„æœ‰åå·®ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:13","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"14ã€â­æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ æ¢¯åº¦æ¶ˆå¤±çš„åŸå› å’Œè§£å†³åŠæ³• ï¼ˆ1ï¼‰éšè—å±‚çš„å±‚æ•°è¿‡å¤š åå‘ä¼ æ’­æ±‚æ¢¯åº¦æ—¶çš„é“¾å¼æ±‚å¯¼æ³•åˆ™ï¼ŒæŸéƒ¨åˆ†æ¢¯åº¦å°äº1ï¼Œåˆ™å¤šå±‚è¿ä¹˜åå‡ºç°æ¢¯åº¦æ¶ˆå¤± ï¼ˆ2ï¼‰é‡‡ç”¨äº†ä¸åˆé€‚çš„æ¿€æ´»å‡½æ•° å¦‚sigmoidå‡½æ•°çš„æœ€å¤§æ¢¯åº¦ä¸º1/4ï¼Œè¿™æ„å‘³ç€éšè—å±‚æ¯ä¸€å±‚çš„æ¢¯åº¦å‡å°äº1ï¼ˆæƒå€¼å°äº1æ—¶ï¼‰ï¼Œå‡ºç°æ¢¯åº¦æ¶ˆå¤±ã€‚ è§£å†³æ–¹æ³•ï¼š1ã€reluæ¿€æ´»å‡½æ•°ï¼Œä½¿å¯¼æ•°è¡¡ä¸º1 2ã€batch norm 3ã€æ®‹å·®ç»“æ„ æ¢¯åº¦çˆ†ç‚¸çš„åŸå› å’Œè§£å†³åŠæ³• ï¼ˆ1ï¼‰éšè—å±‚çš„å±‚æ•°è¿‡å¤šï¼ŒæŸéƒ¨åˆ†æ¢¯åº¦å¤§äº1ï¼Œåˆ™å¤šå±‚è¿ä¹˜åï¼Œæ¢¯åº¦å‘ˆæŒ‡æ•°å¢é•¿ï¼Œäº§ç”Ÿæ¢¯åº¦çˆ†ç‚¸ã€‚ ï¼ˆ2ï¼‰æƒé‡åˆå§‹å€¼å¤ªå¤§ï¼Œæ±‚å¯¼æ—¶ä¼šä¹˜ä¸Šæƒé‡ è§£å†³æ–¹æ³•ï¼š1ã€æ¢¯åº¦è£å‰ª 2ã€æƒé‡L1/L2æ­£åˆ™åŒ– 3ã€æ®‹å·®ç»“æ„ 4ã€batch norm ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:14","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"15ã€â­YOLOV1-YOLOV4æ”¹è¿› â­YOLOV1: one-stageå¼€å±±ä¹‹ä½œï¼Œå°†å›¾åƒåˆ†æˆS*Sçš„å•å…ƒæ ¼ï¼Œæ ¹æ®ç‰©ä½“ä¸­å¿ƒæ˜¯å¦è½å…¥æŸä¸ªå•å…ƒæ ¼æ¥å†³å®šå“ªä¸ªå•å…ƒæ ¼æ¥è´Ÿè´£é¢„æµ‹è¯¥ç‰©ä½“ï¼Œæ¯ä¸ªå•å…ƒæ ¼é¢„æµ‹ä¸¤ä¸ªæ¡†çš„åæ ‡ã€å­˜åœ¨ç‰©ä½“çš„æ¦‚ç‡ï¼ˆå’Œgtçš„IoUï¼‰ã€å„ç±»åˆ«æ¡ä»¶æ¦‚ç‡ã€‚ æŸå¤±å‡½æ•°ï¼šå‡é‡‡ç”¨å‡æ–¹è¯¯å·®ã€‚ ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«ã€‚ ç¼ºç‚¹ï¼š1ã€æ¯ä¸ªå•å…ƒæ ¼é¢„æµ‹ä¸¤ä¸ªæ¡†ï¼Œå¹¶ä¸”åªå–å’Œgt IoUæœ€å¤§çš„æ¡†ï¼Œç›¸å½“äºæ¯ä¸ªå•å…ƒæ ¼åªèƒ½é¢„æµ‹ä¸€ä¸ªç‰©ä½“ï¼Œæ— æ³•å¤„ç†å¯†é›†ç‰©ä½“åœºæ™¯ã€‚2ã€è¾“å‡ºå±‚ä¸ºå…¨è¿æ¥å±‚ï¼Œåªèƒ½è¾“å…¥å›ºå®šåˆ†è¾¨ç‡å›¾ç‰‡ 3ã€è®¡ç®—IoUæŸå¤±æ—¶ï¼Œå°†å¤§å°ç‰©ä½“åŒç­‰å¯¹å¾…ï¼Œä½†åŒæ ·çš„å°è¯¯å·®ï¼Œå¯¹å¤§ç‰©ä½“æ¥è¯´æ˜¯å¾®ä¸è¶³é“çš„ï¼Œè€Œå¯¹å°ç‰©ä½“æ¥è¯´æ˜¯å¾ˆä¸¥é‡çš„ï¼Œè¿™ä¼šå¯¼è‡´å®šä½ä¸å‡†çš„é—®é¢˜ã€‚4ã€æ²¡æœ‰å¯†é›†é”šæ¡†ã€æ²¡æœ‰RPNï¼Œå¯¼è‡´å¬å›ç‡ä½ â­YOLOV2: æ”¹è¿›ç‚¹ï¼š (1)ã€Batch normalizationæ›¿ä»£dropoutï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆ (2)ã€å»æ‰å…¨è¿æ¥å±‚ï¼Œä½¿ç”¨ç±»ä¼¼RPNçš„å…¨å·ç§¯å±‚ (3)ã€å¼•å…¥Anchorï¼Œå¹¶ä½¿ç”¨k-meansèšç±»ç¡®å®šanchorå¤§å°ã€æ¯”ä¾‹ï¼Œæé«˜äº†recall (4)ã€é«˜åˆ†è¾¨ç‡é¢„è®­ç»ƒbackbone (5)ã€é™å®šé¢„æµ‹æ¡†çš„ä¸­å¿ƒç‚¹åªèƒ½åœ¨cellå†…ï¼Œå…·ä½“é€šè¿‡é¢„æµ‹ç›¸å¯¹äºcellå·¦ä¸Šè§’ç‚¹çš„åç§»å®ç°ï¼Œè¿™æ ·ç½‘ç»œæ”¶æ•›æ›´ç¨³å®š (6)ã€æ·»åŠ passthroughå±‚ï¼Œç›¸å½“äºå¤šå°ºåº¦ç‰¹å¾èåˆï¼Œ$1 \\ast 1$å·ç§¯å°†$26 \\ast 26 \\ast 512$ feature mapé™ç»´æˆ$26 \\ast 26 \\ast 64$, ç„¶åå°†ç‰¹å¾é‡ç»„ï¼Œæ‹†åˆ†ä¸º4ä»½$13 \\ast 13 \\ast 64$ï¼Œconcateå¾—åˆ°$13 \\ast 13 \\ast 256$ feature mapï¼Œå’Œä½åˆ†è¾¨ç‡çš„$13 \\ast 13 \\ast 1024$ feature mapè¿›è¡Œconcate (7)ã€æå‡ºDarknetè¿›è¡Œç‰¹å¾æå–ï¼Œå‚æ•°æ›´å°‘ï¼Œé€Ÿåº¦æ›´å¿« (8)ã€æå‡ºYOLO9000ï¼Œå»ºç«‹å±‚çº§åˆ†ç±»çš„World Treeç»“æ„ï¼Œå¯ä»¥è¿›è¡Œç»†ç²’åº¦åˆ†ç±» â­YOLOV3: (1)ã€ä½¿ç”¨sigmoidåˆ†ç±»å™¨æ›¿ä»£softmaxåˆ†ç±»å™¨ï¼Œå¯ä»¥å¤„ç†å¤šæ ‡ç­¾åˆ†ç±»é—®é¢˜ (2)ã€å¼•å…¥æ®‹å·®ç»“æ„ï¼Œè¿›ä¸€æ­¥åŠ æ·±ç½‘ç»œæ·±åº¦ (3)ã€å¤šå°ºåº¦é¢„æµ‹ï¼Œæ¯ä¸ªå°ºåº¦é¢„æµ‹3ä¸ªbbox â­YOLOV4: (1)ã€Mosaic data augmentationï¼šå››å¼ å›¾ç‰‡æ‹¼æ¥æˆä¸€å¼ å›¾ç‰‡ (2)ã€DropBlockï¼šdrop outåªä¸¢å¼ƒå•ä¸ªåƒç´ ï¼Œè€Œå› ä¸ºäºŒç»´å›¾åƒä¸­ç›¸é‚»ç‰¹å¾å¼ºç›¸å…³ï¼Œæ‰€ä»¥ä¸¢å¼ƒåç½‘ç»œä¾ç„¶å¯ä»¥æ¨æ–­å‡ºä¸¢å¤±åŒºåŸŸä¿¡æ¯ï¼Œå¯¼è‡´è¿‡æ‹Ÿåˆï¼›æ‰€ä»¥dropblocké€‰æ‹©ä¸¢å¼ƒä¸€å—è¿ç»­åŒºåŸŸã€‚ (3)ã€label smoothing (4)ã€CIoU loss CIoU = IoU + bboxä¸­å¿ƒè·ç¦»/å¯¹è§’çº¿è·ç¦»+é•¿å®½æ¯”ä¾‹ä¹‹å·® -1\u003c=CIoU\u003c=1 (5)ã€YOLO with SPPï¼šå°±æ˜¯ç”¨ä¸åŒå¤§å°çš„å·ç§¯æ ¸å¯¹ç‰¹å¾å›¾è¿›è¡Œå·ç§¯ï¼Œå¾—åˆ°ä¸åŒæ„Ÿå—é‡çš„ç‰¹å¾ï¼Œç„¶åconcateåˆ°ä¸€èµ·ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:15","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"16ã€â­APè®¡ç®— â­APæ˜¯å¯¹æ¯ä¸€ç±»å…ˆè®¡ç®—APï¼Œå†å°†æ‰€æœ‰ç±»å¹³å‡å¾—åˆ°æœ€ç»ˆAPã€‚ ä»¥COCOä¸­APè®¡ç®—ä¸ºä¾‹ã€‚å…ˆé€‰å®šç”¨æ¥åˆ¤æ–­TPå’ŒFPçš„IoUé˜ˆå€¼ï¼Œå¦‚0.5ï¼Œåˆ™ä»£è¡¨è®¡ç®—çš„æ˜¯AP0.5ï¼Œç„¶åå¯¹æ¯ç±»åšè®¡ç®—ï¼Œä¾‹å¦‚å¯¹äºclass1: class1 box1 score1 box2 score2 box3 score3 è‹¥box1ä¸æŸgtçš„IoUå¤§äºæŒ‡å®šé˜ˆå€¼ï¼ˆå¦‚0.5)ï¼Œè®°ä¸ºPositiveï¼›è‹¥æœ‰å¤šä¸ªbboxä¸gtçš„IoUå¤§äºæŒ‡å®šé˜ˆå€¼ï¼Œé€‰æ‹©å…¶ä¸­scoreæœ€å¤§çš„è®°ä¸ºPositiveï¼Œå…¶å®ƒè®°ä¸ºNegativeã€‚å¯ç†è§£ä¸ºç¡®å®šbox1å¯¹åº”çš„labelã€‚box2ã€box3åŒç†ã€‚ è€Œåè¦å¾—åˆ°PRæ›²çº¿ï¼Œéœ€è¦å…ˆå¯¹box1,2,3æŒ‰scoreä»é«˜åˆ°ä½æ’åºï¼Œå‡è®¾æ’åºç»“æœå¦‚ä¸‹ï¼š True class class1 box2 Positive score2 box1 Negative score1 box3 Positive score3 ç„¶åé€è¡Œè®¡ç®—scoreé˜ˆå€¼ä¸ºscore2ã€score1ã€score3çš„Precisionå’ŒRecallï¼Œscoreå¤§äºé˜ˆå€¼çš„boxæ‰ç®—åšæ¨¡å‹é¢„æµ‹çš„Positiveï¼ˆTP+FP)ã€‚å‡è®¾å…±æœ‰ä¸‰ä¸ªgt boxï¼Œåˆ™è®¡ç®—ç»“æœå¦‚ä¸‹ï¼š True class class1 Precision=TP/(TP+FP) Recall box2 Positive score2 1/1 1/3 box1 Negative score1 1/2 1/3 box3 Positive score3 2/3 2/3 è¿™æ ·å¾—åˆ°ä¸€ä¸ªä¸ªPRæ›²çº¿ä¸Šçš„ç‚¹ï¼Œç„¶ååˆ©ç”¨æ’å€¼æ³•è®¡ç®—PRæ›²çº¿çš„é¢ç§¯ï¼Œå¾—åˆ°class1çš„APã€‚ å…·ä½“æ’å€¼æ–¹æ³•ï¼šCOCOä¸­æ˜¯å‡åŒ€å–101ä¸ªrecallå€¼å³0,0.01,0.02,â€¦,1ï¼Œå¯¹äºæ¯ä¸ªrecallå€¼rï¼Œprecisionå€¼å–æ‰€æœ‰recall\u003e=rä¸­çš„æœ€å¤§å€¼$p_{interp(r)}$ã€‚ ç„¶åæ¯ä¸ªrecallå€¼åŒºé—´ï¼ˆ0-0.01ï¼Œ0.01-0.02ï¼Œâ€¦ï¼‰éƒ½å¯¹åº”ä¸€ä¸ªçŸ©å½¢ï¼Œå°†æ‰€æœ‰çŸ©å½¢é¢ç§¯åŠ èµ·æ¥å³ä¸ºPRæ›²çº¿é¢ç§¯ï¼Œå¾—åˆ°ä¸€ä¸ªç±»åˆ«çš„APï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¯¹æ‰€æœ‰ç±»åˆ«ï¼ˆå¦‚COCOä¸­80ç±»ï¼‰ã€æ‰€æœ‰IoUé˜ˆå€¼ï¼ˆä¾‹å¦‚0.5:0.95ï¼‰çš„APå–å‡å€¼å³å¾—åˆ°æœ€ç»ˆAPã€‚ ARè®¡ç®— è®¡ç®—è¿‡ç¨‹åŒAPï¼Œä¹Ÿæ˜¯åœ¨æ‰€æœ‰IoUé˜ˆå€¼å’Œç±»åˆ«ä¸Šå¹³å‡ã€‚ æ¯ç»™å®šä¸€ä¸ªIoUé˜ˆå€¼å’Œç±»åˆ«ï¼Œå¾—åˆ°ä¸€ä¸ªP_Ræ›²çº¿ï¼Œå½“Pä¸ä¸º0æ—¶æœ€å¤§çš„Recallä½œä¸ºå½“å‰Recallã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:16","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"17ã€â­IoUå˜ç§åˆé›† IoU GIoU $Ac$ä¸ºbbox Aå’Œbbox Bçš„æœ€å°å‡¸é›†é¢ç§¯ï¼ŒUä¸ºA U Bçš„é¢ç§¯ï¼Œå³ç¬¬äºŒé¡¹ä¸ºä¸å±äºAå’ŒBçš„åŒºåŸŸå æœ€å°é—­åŒ…çš„æ¯”ä¾‹ã€‚ -1\u003c=GIoU\u003c=1ï¼Œå½“Aå’ŒBä¸é‡åˆï¼Œä»å¯ä»¥è®¡ç®—æŸå¤±ï¼Œå› æ­¤å¯ä½œä¸ºæŸå¤±å‡½æ•°ã€‚ âœ’ï¸ä¼˜ç‚¹ï¼šåœ¨ä¸é‡å çš„æƒ…å†µä¸‹ï¼Œèƒ½è®©é¢„æµ‹æ¡†å‘gtæ¡†æ¥è¿‘ã€‚ âœ’ï¸ç¼ºç‚¹ï¼šé‡åˆ°Aæ¡†è¢«Bæ¡†åŒ…å«çš„æƒ…å†µä¸‹ï¼ŒGIoUç›¸åŒã€‚ DIoU å…¶ä¸­ï¼Œ $b$å’Œ$b^{gt}$åˆ†åˆ«ä»£è¡¨äº†é¢„æµ‹æ¡†å’ŒçœŸå®æ¡†çš„ä¸­å¿ƒç‚¹ï¼Œä¸”$Ï$ä»£è¡¨çš„æ˜¯è®¡ç®—ä¸¤ä¸ªä¸­å¿ƒç‚¹é—´çš„æ¬§å¼è·ç¦»ã€‚$c$ä»£è¡¨çš„æ˜¯èƒ½å¤ŸåŒæ—¶åŒ…å«é¢„æµ‹æ¡†å’ŒçœŸå®æ¡†çš„æœ€å°é—­åŒ…åŒºåŸŸçš„å¯¹è§’çº¿è·ç¦»ã€‚ $-1 \u003c DIoU \\leq 1$, å°†ç›®æ ‡ä¸anchorä¹‹é—´çš„è·ç¦»ï¼Œé‡å ç‡ä»¥åŠå°ºåº¦éƒ½è€ƒè™‘è¿›å»ï¼Œä½¿å¾—ç›®æ ‡æ¡†å›å½’å˜å¾—æ›´åŠ ç¨³å®š âœ’ï¸ä¼˜ç‚¹ï¼šç›´æ¥ä¼˜åŒ–è·ç¦»ï¼Œè§£å†³GIoUåŒ…å«æƒ…å†µã€‚ CIoU åœ¨DIoUçš„åŸºç¡€ä¸Šè€ƒè™‘bboxçš„é•¿å®½æ¯”ï¼š $-1 \\leq CIoU \\leq 1$ âœ’ï¸ä¼˜ç‚¹ï¼šè€ƒè™‘bboxé•¿å®½æ¯” ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:17","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"18ã€â­depth-wise separable conv (æ·±åº¦å¯åˆ†ç¦»å·ç§¯) ä¾‹å¦‚$5 \\ast 5 \\ast 3$å›¾ç‰‡è¦ç¼–ç ä¸º$5 \\ast 5 \\ast 4$ feature mapï¼Œåˆ™depth-wise convåˆ†ä¸ºä¸¤æ­¥ï¼š å…ˆæ˜¯depth wiseå·ç§¯ï¼Œåˆ©ç”¨3ä¸ª$3 \\ast 3$ convå¯¹æ¯ä¸ªé€šé“å•ç‹¬è¿›è¡Œå·ç§¯ï¼Œè¿™ä¸€æ­¥åªèƒ½æ”¹å˜feature mapé•¿å®½ï¼Œä¸èƒ½æ”¹å˜é€šé“æ•°ï¼š å‚æ•°é‡ï¼š è®¡ç®—é‡ï¼š ç„¶åæ˜¯point wiseå·ç§¯ï¼Œåˆ©ç”¨4ä¸ª$1 \\ast 1 \\ast 3$ convå¯¹depth wiseç”Ÿæˆçš„feature mapè¿›è¡Œå·ç§¯ï¼Œè¿™ä¸€æ­¥åªèƒ½æ”¹å˜é€šé“æ•°ï¼Œä¸èƒ½æ”¹å˜feature mapé•¿å®½ï¼š å‚æ•°é‡ï¼š è®¡ç®—é‡ï¼š æ‰€ä»¥ä¸ä¸€èˆ¬å·ç§¯å¯¹æ¯”ï¼Œæ€»å‚æ•°é‡å’Œè®¡ç®—é‡ï¼š æ€»å‚æ•°é‡ï¼šå¸¸è§„å·ç§¯â€“\u003e ï¼Œ æ·±åº¦å¯åˆ†ç¦»å·ç§¯â€“\u003e æ€»è®¡ç®—é‡ï¼šå¸¸è§„å·ç§¯â€“\u003e , æ·±åº¦å¯åˆ†ç¦»å·ç§¯â€“\u003e ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:18","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"19ã€â­æ£€æµ‹æ¨¡å‹é‡Œä¸ºå•¥ç”¨smoothL1å»å›å½’bbox é¦–å…ˆï¼Œå¯¹äºL2 lossï¼Œå…¶å¯¼æ•°åŒ…å«äº†(f(x)-Y)ï¼Œæ‰€ä»¥å½“é¢„æµ‹å€¼ä¸gtå·®å¼‚è¿‡å¤§æ—¶ï¼Œå®¹æ˜“æ¢¯åº¦çˆ†ç‚¸ï¼› è€Œå¯¹äºL1 lossï¼Œå³ä½¿è®­ç»ƒåæœŸé¢„æµ‹å€¼å’Œgtå·®å¼‚è¾ƒå°ï¼Œæ¢¯åº¦ä¾ç„¶ä¸ºå¸¸æ•°ï¼ŒæŸå¤±å‡½æ•°å°†åœ¨ç¨³å®šå€¼é™„è¿‘æ³¢åŠ¨ï¼Œéš¾ä»¥æ”¶æ•›åˆ°æ›´é«˜ç²¾åº¦ã€‚ æ‰€ä»¥SmoothL1 lossç»“åˆäº†ä¸¤è€…çš„ä¼˜åŠ¿ï¼Œå½“é¢„æµ‹å€¼å’Œgtå·®å¼‚è¾ƒå¤§æ—¶ä½¿ç”¨L1 lossï¼›å·®å¼‚è¾ƒå°æ—¶ä½¿ç”¨L2 lossï¼š ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:19","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"20ã€â­Deformable convå¦‚ä½•å®ç°æ¢¯åº¦å¯å¾®ï¼Ÿ æŒ‡çš„æ˜¯å¯¹offsetå¯å¾®ï¼Œå› ä¸ºoffsetåå·ç§¯æ ¸æ‰€åœ¨ä½ç½®å¯èƒ½æ˜¯å°æ•°ï¼Œå³ä¸åœ¨feature mapæ•´æ•°ç‚¹ä¸Šï¼Œæ‰€ä»¥æ— æ³•æ±‚å¯¼ï¼›Deformable convé€šè¿‡åŒçº¿æ€§æ’å€¼å®ç°äº†offsetæ¢¯åº¦å¯å¾®ã€‚ ç”¨å¦‚ä¸‹è¡¨è¾¾å¼è¡¨è¾¾å¸¸è§„CNN: åˆ™Deformable convå¯è¡¨è¾¾ä¸ºï¼š $x(p_0+p_n+\\Delta p_n)$å¯èƒ½ä¸æ˜¯æ•´æ•°ï¼Œéœ€è¦è¿›è¡Œæ’å€¼ï¼Œä»»æ„ç‚¹pï¼ˆå‘¨å›´å››ä¸ªæ•´æ•°ç‚¹ä¸ºqï¼‰çš„åŒçº¿æ€§æ’å€¼å¯è¡¨è¾¾ä¸ºä¸‹å¼ï¼š å…¶ä¸­$g(a, b) = max(0, 1 âˆ’ |a âˆ’ b|)$ã€‚ åˆ™offest delta_pnæ±‚å¯¼å…¬å¼ä¸ºï¼š ä»è€Œå®ç°å¯¹offsetçš„æ¢¯åº¦å¯å¾®ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:20","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"21ã€â­Swin Transformer (1)â­motivation é«˜åˆ†è¾¨ç‡å›¾åƒä½œä¸ºåºåˆ—è¾“å…¥è®¡ç®—é‡è¿‡å¤§é—®é¢˜ï¼›å’Œnlpä¸åŒï¼Œcvé‡Œæ¯ä¸ªç‰©ä½“çš„å°ºåº¦ä¸åŒï¼Œè€Œnlpé‡Œæ¯ä¸ªç‰©ä½“çš„å•è¯é•¿åº¦éƒ½å·®ä¸å¤šã€‚ (2)â­idea é—®é¢˜ä¸€ï¼šä¸€å¼ å›¾åˆ†æˆå¤šä¸ªçª—å£ï¼Œæ¯ä¸ªçª—å£åˆ†æˆå¤šä¸ªpatchï¼Œæ¯ä¸ªçª—å£å†…çš„å¤šä¸ªpatchç›¸äº’è®¡ç®—è‡ªæ³¨æ„åŠ›ï¼›é—®é¢˜äºŒï¼šæ¨¡ä»¿CNN poolingæ“ä½œï¼Œå°†æµ…å±‚å°ºåº¦patchè¿›è¡Œpath mergingå¾—åˆ°ä¸€ä¸ªå°çš„patchï¼Œå®ç°é™é‡‡æ ·ï¼Œä»è€Œå¾—åˆ°å¤šå°ºåº¦ç‰¹å¾ã€‚ (3)â­method æ•´ä½“ç»“æ„å¾ˆåƒCNNï¼Œå·ç§¯è¢«çª—å£è‡ªæ³¨æ„åŠ›ä»£æ›¿ï¼Œpoolingè¢«patch mergingä»£æ›¿ã€‚ âœ’ï¸method 1: shifted window ç›®çš„æ˜¯è®©ä¸é‡å çª—å£åŒºåŸŸä¹Ÿèƒ½æœ‰äº¤äº’ï¼Œæ“ä½œæœ¬è´¨æ˜¯å°†æ‰€æœ‰çª—å£å¾€å³ä¸‹è§’ç§»åŠ¨2ä¸ªpatchã€‚ çª—å£æ•°ä»4ä¸ªå˜æˆäº†9ä¸ªï¼Œè®¡ç®—é‡å¢å¤§ï¼Œä¸ºå‡å°è®¡ç®—é‡ï¼Œä½¿ç”¨cyclic shiftï¼Œå°†çª—å£æ‹¼æ¥æˆ4ä¸ªçª—å£ï¼Œå¦å¤–å› ä¸ºæ‹¼æ¥åAã€Bã€Cç›¸è¾ƒäºåŸå›¾å‘ç”Ÿäº†ç›¸å¯¹ä½ç½®å˜åŒ–ï¼Œæ‰€ä»¥Aã€Bã€Cå’Œå…¶ä»–åŒºåŸŸæ˜¯ä¸å¯ä»¥è¿›è¡Œäº¤äº’çš„ï¼Œå› æ­¤å¼•å…¥äº†Maskæ“ä½œã€‚ Maskæ“ä½œï¼š ä»¥3ã€6æ‰€åœ¨çª—å£çš„è‡ªæ³¨æ„åŠ›è®¡ç®—ä¸ºä¾‹ï¼Œå°†7*7=49ä¸ªåƒç´ å±•å¹³å¾—åˆ°é•¿åº¦ä¸º49çš„ä¸€ç»´å‘é‡ï¼ŒåšçŸ©é˜µä¹˜æ³•å³Q*Kã€‚ åˆå› ä¸º3å’Œ6æ˜¯ä¸å¯ä»¥äº¤äº’çš„ï¼Œæ‰€ä»¥çŸ©é˜µå·¦ä¸‹è§’å’Œå³ä¸Šè§’åº”è¯¥è¢«maskæ‰ï¼ŒSwiné‡‡ç”¨çš„æ–¹æ³•æ˜¯åŠ ä¸Šå·¦ä¸‹è§’å’Œå³ä¸Šè§’ä¸º-100ï¼Œå…¶ä½™ä½ç½®ä¸º0çš„æ¨¡æ¿ï¼Œè¿™æ ·å¾—åˆ°çš„attentionçŸ©é˜µåœ¨softmaxåå°±å˜æˆ0äº†ã€‚ âœ’ï¸method2: patch merging å°±æ˜¯é—´éš”é‡‡æ ·ï¼Œç„¶ååœ¨é€šé“ç»´åº¦ä¸Šæ‹¼æ¥ (4)â­SwinTransformerä½ç½®ç¼–ç å®ç° ğŸ‘‰æ ¸å¿ƒæ€æƒ³å°±æ˜¯å»ºäº†ä¸€ä¸ªç›¸å¯¹ä½ç½®ç¼–ç embeddingå­—å…¸ï¼Œä½¿å¾—ç›¸åŒçš„ç›¸å¯¹ä½ç½®ç¼–ç æˆç›¸åŒçš„embeddingã€‚ğŸ‘ˆ ä¾‹å¦‚2*2çš„patchä¹‹é—´çš„ç›¸å¯¹ä½ç½®å…³ç³»çŸ©é˜µä¸º2*2*2ï¼Œç›¸å¯¹ä½ç½®èŒƒå›´ä¸º[-1,1]ï¼š åˆ™xï¼Œyç›¸å¯¹ä½ç½®å…³ç³»å¯ç”¨3*3 (-1,0,1ä¸‰ç§ç›¸å¯¹ä½ç½®)çš„tableå­˜å‚¨æ‰€æœ‰å¯èƒ½çš„ç›¸å¯¹ä½ç½®å…³ç³»ï¼Œå¹¶ç”¨3*3*embed_nè¡¨ç¤ºæ‰€æœ‰ç›¸å¯¹ä½ç½®å¯¹åº”çš„embeddingã€‚ä¸ºäº†ä½¿å¾—ç´¢å¼•ä¸ºæ•´æ•°ï¼Œéœ€è¦å°†æ‰€æœ‰ç›¸å¯¹ä½ç½®å˜ä¸ºæ­£å€¼ï¼š å¯ä»¥é€šè¿‡ç®€å•çš„x,yç›¸å¯¹ä½ç½®ç›¸åŠ å°†ç›¸å¯¹ä½ç½®æ˜ å°„ä¸ºä¸€ç»´ï¼Œä½†æ˜¯ä¼šå‡ºç°(0,2)å’Œ(2,0)æ— æ³•åŒºåˆ†çš„é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦ä½¿å¾—x,yç›¸å¯¹ä½ç½®ç¼–ç ä¸åŒï¼š ç„¶åå°†xå’Œyç›¸å¯¹ä½ç½®ç›¸åŠ ï¼š ä»è€Œæ¯ä¸ªç›¸å¯¹ä½ç½®å¯¹åº”ä¸€ä¸ªä¸€ç»´çš„å€¼ï¼Œä½œä¸ºç›¸å¯¹ä½ç½®embedding tableçš„ç´¢å¼•ï¼Œè·å–å¯¹åº”ä½ç½®çš„embeddingã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:21","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"22ã€â­YOLOXæ ¸å¿ƒæ”¹è¿›ï¼š (1)âœ’ï¸Decoupled headï¼šå°±æ˜¯anchor freeæ–¹æ³•é‡Œæœ€å¸¸ç”¨çš„cls headå’Œreg head (2)âœ’ï¸Anchor-free: å³ç±»ä¼¼FCOSï¼Œä¸åŒçš„æ˜¯é¢„æµ‹çš„æ˜¯ä¸­å¿ƒç‚¹ç›¸å¯¹äºgridå·¦ä¸Šè§’åæ ‡çš„offsetå€¼ï¼Œä»¥åŠbboxçš„é•¿å®½ï¼Œå°†ç‰©ä½“ä¸­å¿ƒçš„æŸä¸ªåŒºåŸŸå†…çš„ç‚¹å®šä¹‰ä¸ºæ­£æ ·æœ¬ï¼Œå¹¶ä¸”æ¯ä¸ªå°ºåº¦é¢„æµ‹ä¸åŒå¤§å°ç‰©ä½“ã€‚ (3)âœ’ï¸Label assignment(SimOTA): å°†predictionå’Œgtçš„åŒ¹é…è¿‡ç¨‹å»ºæ¨¡ä¸ºè¿è¾“é—®é¢˜ï¼Œä½¿å¾—costæœ€å°ã€‚ costè¡¨ç¤ºï¼š$pred_i$å’Œ$gt_j$çš„clså’Œreg lossã€‚ å¯¹æ¯ä¸ªgtï¼Œé€‰æ‹©è½åœ¨æŒ‡å®šä¸­å¿ƒåŒºåŸŸçš„top-k least cost predictionså½“ä½œæ­£æ ·æœ¬ï¼Œæ¯ä¸ªgtçš„kå€¼ä¸åŒã€‚ æœ€ä½³æ­£é”šç‚¹æ•°é‡ä¼°è®¡ï¼šæŸä¸ªgtçš„é€‚å½“æ­£é”šç‚¹æ•°é‡åº”è¯¥ä¸è¯¥gtå›å½’è‰¯å¥½çš„é”šç‚¹æ•°é‡æ­£ç›¸å…³ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸ªgtï¼Œæˆ‘ä»¬æ ¹æ®IoUå€¼é€‰æ‹©å‰qä¸ªé¢„æµ‹ã€‚è¿™äº›IoUå€¼ç›¸åŠ ä»¥è¡¨ç¤ºæ­¤gtçš„æ­£é”šç‚¹ä¼°è®¡æ•°é‡ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:22","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"23ã€â­L1ã€L2æ­£åˆ™åŒ–çš„åŒºåˆ« âœ’ï¸L1æ­£åˆ™åŒ–å®¹æ˜“å¾—åˆ°ç¨€ç–è§£ï¼Œå³ç¨€ç–æƒå€¼çŸ©é˜µï¼ŒL2æ­£åˆ™åŒ–å®¹æ˜“å¾—åˆ°å¹³æ»‘è§£ï¼ˆæƒå€¼å¾ˆå°ï¼‰ã€‚ âœ’ï¸åŸå› ï¼šaã€è§£ç©ºé—´è§’åº¦ï¼šäºŒç»´æƒ…å†µï¼ŒL1æ­£åˆ™åŒ–ï¼š||w1||+||w2||ï¼Œåˆ™å‡½æ•°å›¾åƒä¸ºå›¾ä¸­æ–¹æ¡†ï¼Œæ˜¾ç„¶æ–¹æ¡†çš„è§’ç‚¹å®¹æ˜“æ˜¯æœ€ä¼˜è§£ï¼Œè€Œè¿™äº›æœ€ä¼˜è§£éƒ½åœ¨åæ ‡è½´ä¸Šï¼Œæƒå€¼ä¸º0. bã€æ¢¯åº¦ä¸‹é™è§’åº¦ æ·»åŠ æ­£åˆ™é¡¹ $\\lambda \\theta^2_j$ï¼Œåˆ™Lå¯¹$\\theta_j$çš„å¯¼æ•°ä¸º$2\\lambda \\theta_j$ï¼Œæ¢¯åº¦æ›´æ–°æ—¶$\\theta_j=\\theta_j-2 \\lambda \\theta_j=(1-2 \\lambda) \\theta_j$ï¼Œç›¸å½“äºæ¯æ¬¡éƒ½ä¼šä¹˜ä»¥ä¸€ä¸ªå°äº1çš„æ•°ï¼Œä½¿å¾—$\\theta_j$è¶Šæ¥è¶Šå°ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:23","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"24ã€â­æ·±åº¦å­¦ä¹ èŠ±å¼å½’ä¸€åŒ–ä¹‹Batch/Layer/Instance/Group Normalization âœ’ï¸Batch Normalization â­æ ¸å¿ƒè¿‡ç¨‹ï¼šé¡¾åæ€ä¹‰ï¼Œå¯¹ä¸€ä¸ªbatchå†…çš„æ•°æ®è®¡ç®—å‡å€¼å’Œæ–¹å·®ï¼Œå°†æ•°æ®å½’ä¸€åŒ–ä¸ºå‡å€¼ä¸º0ã€æ–¹å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒæ•°æ®ï¼Œæœ€åç”¨å¯¹æ•°æ®è¿›è¡Œç¼©æ”¾å’Œåç§»æ¥è¿˜åŸæ•°æ®æœ¬èº«çš„åˆ†å¸ƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ Batch Norm 1d è¾“å…¥æ˜¯b*c, è¾“å‡ºæ˜¯b*cï¼Œå³åœ¨æ¯ä¸ªç»´åº¦ä¸Šè¿›è¡Œnormalizationã€‚ Batch Norm 2d ä¾‹å¦‚è¾“å…¥æ˜¯b*c*h*wï¼Œåˆ™è®¡ç®—normlizationæ—¶æ˜¯å¯¹æ¯ä¸ªé€šé“ï¼Œæ±‚bhwå†…çš„åƒç´ æ±‚å‡å€¼å’Œæ–¹å·®ï¼Œè¾“å‡ºæ˜¯1*c*1*1ã€‚ BNæµ‹è¯•æ—¶å’Œè®­ç»ƒæ—¶ä¸åŒï¼Œæµ‹è¯•æ—¶ä½¿ç”¨çš„æ˜¯å…¨å±€è®­ç»ƒæ•°æ®çš„æ»‘åŠ¨å¹³å‡çš„å‡å€¼å’Œæ–¹å·®ã€‚ ä½œç”¨ï¼šaã€é˜²æ­¢è¿‡æ‹Ÿåˆ bã€åŠ é€Ÿç½‘ç»œçš„æ”¶æ•›ï¼Œinternal covariate shiftå¯¼è‡´ä¸Šå±‚ç½‘ç»œéœ€è¦ä¸æ–­é€‚åº”åº•å±‚ç½‘ç»œå¸¦æ¥çš„åˆ†å¸ƒå˜åŒ– cã€ç¼“è§£æ¢¯åº¦çˆ†ç‚¸å’Œæ¢¯åº¦æ¶ˆå¤± å±€é™ï¼šä¾èµ–äºbatch sizeï¼Œé€‚ç”¨äºbatch sizeè¾ƒå¤§çš„æƒ…å†µ âœ’ï¸æ”¹è¿›ï¼š Layer normalization: å¯¹æ¯ä¸ªæ ·æœ¬çš„æ‰€æœ‰ç‰¹å¾è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¦‚N*C*H*Wï¼Œå¯¹æ¯ä¸ªC*H*Wè¿›è¡Œå½’ä¸€åŒ–ï¼Œå¾—åˆ°Nä¸ªå‡å€¼å’Œæ–¹å·®ã€‚ Instance normalization: å¯¹æ¯ä¸ªæ ·æœ¬çš„æ¯ä¸ªé€šé“ç‰¹å¾è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¦‚N*C*H*Wï¼Œå¯¹æ¯ä¸ªH*Wè¿›è¡Œå½’ä¸€åŒ–ï¼Œå¾—åˆ°N*Cä¸ªå‡å€¼å’Œæ–¹å·®ã€‚ Group normalizationï¼šæ¯ä¸ªæ ·æœ¬æŒ‰é€šé“åˆ†ç»„è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¦‚N*C*H*Wï¼Œå¯¹æ¯ä¸ªC*H*Wï¼Œåœ¨Cç»´åº¦ä¸Šåˆ†æˆgç»„ï¼Œåˆ™å…±æœ‰N*gä¸ªå‡å€¼å’Œæ–¹å·®ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:24","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["DL"],"content":"25ã€â­æ·±åº¦å­¦ä¹ å¸¸ç”¨ä¼˜åŒ–å™¨ä»‹ç» å‚è€ƒhttps://zhuanlan.zhihu.com/p/261695487ï¼Œä¿®æ­£äº†å…¶ä¸­çš„ä¸€äº›é”™è¯¯ã€‚ (1)â­SGD a. âœ’ï¸å…¬å¼ å…¶ä¸­$\\alpha$æ˜¯å­¦ä¹ ç‡ï¼Œ$g_t$æ˜¯å½“å‰å‚æ•°çš„æ¢¯åº¦ã€‚ b. âœ’ï¸ä¼˜ç‚¹ï¼šæ¯æ¬¡åªç”¨ä¸€ä¸ªæ ·æœ¬æ›´æ–°æ¨¡å‹å‚æ•°ï¼Œè®­ç»ƒé€Ÿåº¦å¿«ã€‚ c. âœ’ï¸ç¼ºç‚¹ï¼šå®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼›æ²¿é™¡å³­æ–¹å‘æŒ¯è¡ï¼Œè€Œæ²¿å¹³ç¼“ç»´åº¦è¿›å±•ç¼“æ…¢ï¼Œéš¾ä»¥è¿…é€Ÿæ”¶æ•› (2) â­SGD with momentum a. âœ’ï¸å…¬å¼ å…¶ä¸­$m_t$ä¸ºåŠ¨é‡ã€‚ b. âœ’ï¸ä¼˜ç‚¹ï¼šå¯å€ŸåŠ©åŠ¨é‡è·³å‡ºå±€éƒ¨æœ€ä¼˜ç‚¹ã€‚ c. âœ’ï¸ç¼ºç‚¹ï¼šå®¹æ˜“åœ¨å±€éƒ¨æœ€ä¼˜ç‚¹é‡Œæ¥å›æŒ¯è¡ã€‚ (3) â­AdaGradï¼šç»å¸¸æ›´æ–°çš„å‚æ•°å·²ç»æ”¶æ•›å¾—æ¯”è¾ƒå¥½äº†ï¼Œåº”è¯¥å‡å°‘å¯¹å®ƒçš„å…³æ³¨ï¼Œå³é™ä½å…¶å­¦ä¹ ç‡ï¼›å¯¹äºä¸å¸¸æ›´æ–°çš„å‚æ•°ï¼Œæ¨¡å‹å­¦ä¹ çš„ä¿¡æ¯è¿‡å°‘ï¼Œåº”è¯¥å¢åŠ å¯¹å®ƒçš„å…³æ³¨ï¼Œå³å¢å¤§å…¶å­¦ä¹ ç‡ã€‚ a. âœ’ï¸å…¬å¼ $$w_{t+1}=w_t-\\alpha \\cdot g_t / \\sqrt{V_t}=w_t-\\alpha \\cdot g_t / \\sqrt{\\sum_{\\tau=1}^t g_\\tau^2}$$ å…¶ä¸­Vtæ˜¯äºŒé˜¶åŠ¨é‡ï¼Œä¸ºç´¯è®¡æ¢¯åº¦å€¼çš„å¹³æ–¹å’Œï¼Œä¸å‚æ•°æ›´æ–°é¢‘ç¹ç¨‹åº¦æˆæ­£æ¯”ã€‚ b. âœ’ï¸ä¼˜ç‚¹ï¼šç¨€ç–æ•°æ®åœºæ™¯ä¸‹è¡¨ç°å¥½ï¼›è‡ªé€‚åº”è°ƒèŠ‚å­¦ä¹ ç‡ã€‚ c. âœ’ï¸ç¼ºç‚¹ï¼šVtå•è°ƒé€’å¢ï¼Œä½¿å¾—å­¦ä¹ ç‡å•è°ƒé€’å‡ä¸º0ï¼Œä»è€Œä½¿å¾—è®­ç»ƒè¿‡ç¨‹è¿‡æ—©ç»“æŸã€‚ (4) â­RMSPropï¼šAdaGradçš„æ”¹è¿›ç‰ˆï¼Œä¸ç´¯è®¡æ‰€æœ‰å†å²æ¢¯åº¦ï¼Œè€Œæ˜¯è¿‡å»ä¸€æ®µæ—¶é—´çª—å£å†…çš„å†å²æ¢¯åº¦ã€‚ a. âœ’ï¸å…¬å¼ $$\\begin{aligned} w_{t+1} \u0026 =w_t-\\alpha \\cdot g_t / \\sqrt{V_t} \\ \u0026 =w_t-\\alpha \\cdot g_t / \\sqrt{\\beta_2 \\cdot V_{t-1}+\\left(1-\\beta_2\\right) g_t^2}\\end{aligned}$$ å³æŠŠVtæ¢æˆæŒ‡æ•°ç§»åŠ¨å¹³å‡ã€‚ b. âœ’ï¸ä¼˜ç‚¹ï¼šé¿å…äº†äºŒé˜¶åŠ¨é‡æŒç»­ç´¯ç§¯ã€å¯¼è‡´è®­ç»ƒè¿‡ç¨‹æå‰ç»“æŸçš„é—®é¢˜äº†ã€‚ (5) â­Adamï¼š=Adaptive + momentumï¼Œå³ç»“åˆäº†momentumä¸€é˜¶åŠ¨é‡+RMSPropäºŒé˜¶åŠ¨é‡ã€‚ a. âœ’ï¸å…¬å¼ $$\\begin{aligned} w_{t+1} \u0026 =w_t-\\alpha \\cdot m_t / \\sqrt{V_t} \\ \u0026 =w_t-\\alpha \\cdot\\left(\\beta_1 \\cdot m_{t-1}+\\left(1-\\beta_1\\right) \\cdot g_t\\right) / \\sqrt{\\beta_2 \\cdot V_{t-1}+\\left(1-\\beta_2\\right) g_t^2}\\end{aligned}$$ b. âœ’ï¸ä¼˜ç‚¹ï¼šé€šè¿‡ä¸€é˜¶åŠ¨é‡å’ŒäºŒé˜¶åŠ¨é‡ï¼Œæœ‰æ•ˆæ§åˆ¶å­¦ä¹ ç‡æ­¥é•¿å’Œæ¢¯åº¦æ–¹å‘ï¼Œé˜²æ­¢æ¢¯åº¦çš„æŒ¯è¡å’Œåœ¨éç‚¹çš„é™æ­¢ã€‚ c. âœ’ï¸ç¼ºç‚¹ï¼šäºŒé˜¶åŠ¨é‡æ˜¯å›ºå®šå†å²æ—¶é—´çª—å£çš„ç´¯ç§¯ï¼Œçª—å£çš„å˜åŒ–å¯èƒ½å¯¼è‡´VtæŒ¯è¡ï¼Œè€Œä¸æ˜¯å•è°ƒå˜åŒ–ï¼Œä»è€Œå¯¼è‡´è®­ç»ƒåæœŸå­¦ä¹ ç‡çš„æŒ¯è¡ï¼Œæ¨¡å‹ä¸æ”¶æ•›ï¼Œå¯é€šè¿‡ æ¥ä¿®æ­£ï¼Œä¿è¯å­¦ä¹ ç‡å•è°ƒé€’å‡ï¼›è‡ªé€‚åº”å­¦ä¹ ç‡ç®—æ³•å¯èƒ½ä¼šå¯¹å‰æœŸå‡ºç°çš„ç‰¹å¾è¿‡æ‹Ÿåˆï¼ŒåæœŸæ‰å‡ºç°çš„ç‰¹å¾å¾ˆéš¾çº æ­£å‰æœŸçš„æ‹Ÿåˆæ•ˆæœï¼Œä»è€Œé”™è¿‡å…¨å±€æœ€ä¼˜è§£ã€‚ æ•´ç†è¿™ç¯‡æ–‡ç« ä¸æ˜“ï¼Œå–œæ¬¢çš„è¯å¯ä»¥å…³æ³¨æˆ‘â€“\u003eæ— åæ°ï¼ŒæŸä¹å’Œå°çº¢è–¯åŒåï¼ŒWXï¼šæ— åæ°çš„èƒ¡è¨€ä¹±è¯­ã€‚ å®šæœŸåˆ†äº«ç®—æ³•ç¬”è¯•ã€é¢è¯•å¹²è´§ã€‚ ","date":"2024-04-26","objectID":"/posts/dl_basics_one/:0:25","tags":["DL"],"title":"Index","uri":"/posts/dl_basics_one/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ (åå…«) åŸºäºæ¨¡æ‹Ÿçš„æœç´¢ä¸è’™ç‰¹å¡ç½—æ ‘æœç´¢(MCTS)ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†MCTSçš„åŸç†å’Œåœ¨æ£‹ç±»ä¸­çš„åŸºæœ¬åº”ç”¨ã€‚è¿™é‡Œæˆ‘ä»¬åœ¨å‰ä¸€èŠ‚MCTSçš„åŸºç¡€ä¸Šï¼Œè®¨è®ºä¸‹DeepMindçš„AlphaGo Zeroå¼ºåŒ–å­¦ä¹ åŸç†ã€‚ æœ¬ç¯‡ä¸»è¦å‚è€ƒäº†AlphaGo Zeroçš„è®ºæ–‡, AlphaGo Zeroç»¼è¿°å’ŒAlphaGo Zero Cheat Sheetã€‚ 1. AlphaGo Zeroæ¨¡å‹åŸºç¡€ AlphaGo Zeroä¸éœ€è¦å­¦ä¹ äººç±»çš„æ£‹è°±ï¼Œé€šè¿‡è‡ªæˆ‘å¯¹å¼ˆå®Œæˆæ£‹åŠ›æé«˜ã€‚ä¸»è¦ä½¿ç”¨äº†ä¸¤ä¸ªæ¨¡å‹ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯æˆ‘ä»¬ä¸Šä¸€èŠ‚ä»‹ç»MCTSæ ‘ç»“æ„ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œã€‚MCTSä¸Šä¸€ç¯‡å·²ç»æœ‰åŸºæœ¬ä»‹ç»äº†ï¼Œå¯¹äºç¥ç»ç½‘ç»œï¼Œå®ƒçš„è¾“å…¥æ˜¯å½“å‰çš„æ£‹å±€çŠ¶æ€ï¼Œè¾“å‡ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†è¾“å‡ºæ˜¯åœ¨å½“å‰æ£‹å±€çŠ¶æ€ä¸‹å„ä¸ªå¯èƒ½çš„è½å­åŠ¨ä½œå¯¹åº”çš„è·èƒœæ¦‚ç‡pï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºActor-Criticç­–ç•¥å‡½æ•°éƒ¨åˆ†ã€‚å¦ä¸€éƒ¨åˆ†è¾“å‡ºä¸ºè·èƒœæˆ–è€…å¤±è´¥çš„è¯„ä¼°[-1,1]ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºActor-Criticä»·å€¼å‡½æ•°éƒ¨åˆ†ã€‚ AlphaGo Zeroçš„è¡Œæ£‹ä¸»è¦æ˜¯ç”±MCTSæŒ‡å¯¼å®Œæˆçš„ï¼Œä½†æ˜¯åœ¨MCTSæœç´¢çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºæœ‰ä¸€äº›ä¸åœ¨æ ‘ä¸­çš„çŠ¶æ€éœ€è¦ä»¿çœŸï¼Œåšå±€é¢è¯„ä¼°ï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªç®€å•çš„ç­–ç•¥æ¥å¸®åŠ©MCTSè¯„ä¼°æ”¹è¿›ç­–ç•¥ï¼Œè¿™ä¸ªç­–ç•¥æ”¹è¿›éƒ¨åˆ†ç”±å‰é¢æåˆ°çš„ç¥ç»ç½‘ç»œå®Œæˆã€‚ è¿™ä¸¤éƒ¨åˆ†çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š AlphaGo Zero ä¸­çš„MCTSå’ŒNN å…·ä½“AlphaGo Zeroçš„MCTSå¦‚ä½•æœç´¢ï¼Œç¥ç»ç½‘ç»œå¦‚ä½•è®­ç»ƒï¼Œå¦‚ä½•æŒ‡å¯¼MCTSæœç´¢æˆ‘ä»¬åœ¨åé¢å†è®²ã€‚ 2. AlphaGo Zeroçš„è®­ç»ƒè¿‡ç¨‹ç®€ä»‹ åœ¨è®¨è®ºAlphaGo Zeroçš„MCTSå¦‚ä½•æœç´¢ï¼Œç¥ç»ç½‘ç»œå¦‚ä½•è®­ç»ƒç­‰ç»†èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹AlphaGo Zeroçš„è®­ç»ƒè¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ã€‚ AlphaGo Zeroè®­ç»ƒè¿‡ç¨‹ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šè‡ªæˆ‘å¯¹æˆ˜å­¦ä¹ é˜¶æ®µï¼Œè®­ç»ƒç¥ç»ç½‘ç»œé˜¶æ®µå’Œè¯„ä¼°ç½‘ç»œé˜¶æ®µã€‚ è‡ªæˆ‘å¯¹æˆ˜å­¦ä¹ é˜¶æ®µä¸»è¦æ˜¯AlphaGo Zeroè‡ªæˆ‘å¯¹å¼ˆï¼Œäº§ç”Ÿå¤§é‡æ£‹å±€æ ·æœ¬çš„è¿‡ç¨‹ï¼Œç”±äºAlphaGo Zeroå¹¶ä¸ä½¿ç”¨å›´æ£‹å¤§å¸ˆçš„æ£‹å±€æ¥å­¦ä¹ ï¼Œå› æ­¤éœ€è¦è‡ªæˆ‘å¯¹å¼ˆå¾—åˆ°è®­ç»ƒæ•°æ®ç”¨äºåç»­ç¥ç»ç½‘ç»œçš„è®­ç»ƒã€‚åœ¨è‡ªæˆ‘å¯¹æˆ˜å­¦ä¹ é˜¶æ®µï¼Œæ¯ä¸€æ­¥çš„è½å­æ˜¯ç”±MCTSæœç´¢æ¥å®Œæˆçš„ã€‚åœ¨MCTSæœç´¢çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°ä¸åœ¨æ ‘ä¸­çš„çŠ¶æ€ï¼Œåˆ™ä½¿ç”¨ç¥ç»ç½‘ç»œçš„ç»“æœæ¥æ›´æ–°MCTSæ ‘ç»“æ„ä¸Šä¿å­˜çš„å†…å®¹ã€‚åœ¨æ¯ä¸€æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œåœ¨æ¯ä¸ªæ£‹å±€å½“å‰çŠ¶æ€ $s$ ä¸‹ï¼Œæ¯ä¸€æ¬¡ç§»åŠ¨ä½¿ç”¨1600æ¬¡MCTSæœç´¢æ¨¡æ‹Ÿã€‚æœ€ç»ˆMCTSç»™å‡ºæœ€ä¼˜çš„è½å­ç­–ç•¥ $Ï€$ ,è¿™ä¸ªç­–ç•¥ $Ï€$ å’Œç¥ç»ç½‘ç»œçš„è¾“å‡º $p$ æ˜¯ä¸ä¸€æ ·çš„ã€‚å½“æ¯ä¸€å±€å¯¹æˆ˜ç»“æŸåï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„èƒœè´Ÿå¥–åŠ± $z$ ,1æˆ–è€…-1. è¿™æ ·æˆ‘ä»¬å¯ä»¥å¾—åˆ°éå¸¸å¤šçš„æ ·æœ¬ $(s,Ï€,z)$,è¿™äº›æ•°æ®å¯ä»¥è®­ç»ƒç¥ç»ç½‘ç»œé˜¶æ®µã€‚ åœ¨è®­ç»ƒç¥ç»ç½‘ç»œé˜¶æ®µï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªæˆ‘å¯¹æˆ˜å­¦ä¹ é˜¶æ®µå¾—åˆ°çš„æ ·æœ¬é›†åˆ(s,Ï€,z)(ï¿½,ï¿½,ï¿½),è®­ç»ƒæˆ‘ä»¬ç¥ç»ç½‘ç»œçš„æ¨¡å‹å‚æ•°ã€‚è®­ç»ƒçš„ç›®çš„æ˜¯å¯¹äºæ¯ä¸ªè¾“å…¥ $s$, ç¥ç»ç½‘ç»œè¾“å‡ºçš„ $p,v$å’Œæˆ‘ä»¬è®­ç»ƒæ ·æœ¬ä¸­çš„ $Ï€$, $z$å·®è·å°½å¯èƒ½çš„å°‘ã€‚è¿™ä¸ªæŸå¤±å‡½æ•° $L$ å…¶å®æ˜¯å¾ˆç®€å•çš„ï¼š $$L=(z-v)^2-\\pi^Tlog(p)+c||\\theta||^2$$ æŸå¤±å‡½æ•°ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°ï¼Œç”¨äºè¯„ä¼°ç¥ç»ç½‘ç»œé¢„æµ‹çš„èƒœè´Ÿç»“æœå’ŒçœŸå®ç»“æœä¹‹é—´çš„å·®å¼‚ã€‚ç¬¬äºŒéƒ¨åˆ†æ˜¯äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œç”¨äºè¯„ä¼°ç¥ç»ç½‘ç»œçš„è¾“å‡ºç­–ç•¥å’Œæˆ‘ä»¬MCTSè¾“å‡ºçš„ç­–ç•¥çš„å·®å¼‚ã€‚ç¬¬ä¸‰éƒ¨åˆ†æ˜¯L2æ­£åˆ™åŒ–é¡¹ã€‚ é€šè¿‡è®­ç»ƒç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬å¯ä»¥ä¼˜åŒ–ç¥ç»ç½‘ç»œçš„å‚æ•° $Î¸$,ç”¨äºåç»­æŒ‡å¯¼æˆ‘ä»¬çš„MCTSæœç´¢è¿‡ç¨‹ã€‚ å½“ç¥ç»ç½‘ç»œè®­ç»ƒå®Œæ¯•åï¼Œæˆ‘ä»¬å°±è¿›è¡Œäº†è¯„ä¼°é˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦ç”¨äºç¡®è®¤ç¥ç»ç½‘ç»œçš„å‚æ•°æ˜¯å¦å¾—åˆ°äº†ä¼˜åŒ–ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè‡ªæˆ‘å¯¹æˆ˜çš„åŒæ–¹å„è‡ªä½¿ç”¨è‡ªå·±çš„ç¥ç»ç½‘ç»œæŒ‡å¯¼MCTSæœç´¢ï¼Œå¹¶å¯¹æˆ˜è‹¥å¹²å±€ï¼Œæ£€éªŒAlphaGo Zeroåœ¨æ–°ç¥ç»ç½‘ç»œå‚æ•°ä¸‹æ£‹åŠ›æ˜¯å¦å¾—åˆ°äº†æé«˜ã€‚é™¤äº†ç¥ç»ç½‘ç»œçš„å‚æ•°ä¸åŒï¼Œè¿™ä¸ªè¿‡ç¨‹å’Œç¬¬ä¸€é˜¶æ®µçš„è‡ªæˆ‘å¯¹æˆ˜å­¦ä¹ é˜¶æ®µè¿‡ç¨‹æ˜¯ç±»ä¼¼çš„ã€‚ 3. AlphaGo Zeroçš„ç¥ç»ç½‘ç»œç»“æ„ åœ¨ç¬¬äºŒèŠ‚æˆ‘ä»¬å·²ç»è®¨è®ºäº†AlphaGo Zeroçš„ä¸»è¦è®­ç»ƒè¿‡ç¨‹ï¼Œä½†æ˜¯è¿˜æœ‰ä¸¤å—æ²¡æœ‰è®²æ¸…æ¥šï¼Œä¸€æ˜¯AlphaGo Zeroçš„MCTSæœç´¢è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼ŒäºŒæ˜¯AlphaGo Zeroçš„ç¥ç»ç½‘ç»œçš„ç»“æ„å…·ä½“æ˜¯ä»€ä¹ˆæ ·çš„ã€‚è¿™ä¸€èŠ‚æˆ‘ä»¬æ¥çœ‹çœ‹AlphaGo Zeroçš„ç¥ç»ç½‘ç»œçš„ç»†èŠ‚ã€‚ é¦–å…ˆæˆ‘ä»¬çœ‹çœ‹AlphaGo Zeroçš„è¾“å…¥ï¼Œå½“å‰çš„æ£‹å±€çŠ¶æ€ã€‚ç”±äºå›´æ£‹æ˜¯19x19çš„361ä¸ªç‚¹ç»„æˆçš„æ£‹å±€ï¼Œæ¯ä¸ªç‚¹çš„çŠ¶æ€æœ‰äºŒç§ï¼šå¦‚æœå½“å‰æ˜¯é»‘æ–¹è¡Œæ£‹ï¼Œåˆ™å½“å‰æœ‰é»‘æ£‹çš„ç‚¹å–å€¼1ï¼Œæœ‰ç™½æ£‹æˆ–è€…æ²¡æœ‰æ£‹å­çš„ä½ç½®å–å€¼ä¸º0ï¼Œåè¿‡æ¥ï¼Œå¦‚æœå½“å‰æ˜¯ç™½æ–¹è¡Œæ£‹ï¼Œåˆ™å½“å‰æœ‰ç™½æ£‹çš„ç‚¹å–å€¼1ï¼Œæœ‰é»‘æ£‹æˆ–è€…æ²¡æœ‰æ£‹å­çš„ä½ç½®å–å€¼ä¸º0ã€‚åŒæ—¶ï¼Œä¸ºäº†æä¾›æ›´å¤šçš„ä¿¡æ¯ï¼Œè¾“å…¥çš„æ£‹å±€çŠ¶æ€ä¸å…‰åªæœ‰å½“å‰çš„æ£‹å±€çŠ¶æ€ï¼ŒåŒ…æ‹¬äº†é»‘æ£‹ç™½æ£‹å„è‡ªå‰8æ­¥å¯¹åº”çš„æ£‹å±€çŠ¶æ€ã€‚é™¤äº†è¿™16ä¸ªæ£‹å±€çŠ¶æ€ï¼Œè¿˜æœ‰ä¸€ä¸ªå•ç‹¬çš„æ£‹å±€çŠ¶æ€ç”¨äºæ ‡è¯†å½“å‰è¡Œæ£‹æ–¹ï¼Œå¦‚æœæ˜¯å½“å‰é»‘æ£‹è¡Œæ£‹ï¼Œåˆ™æ£‹å±€çŠ¶æ€ä¸Šæ ‡å…¨1ï¼Œç™½æ£‹åˆ™æ£‹å±€çŠ¶æ€ä¸Šæ ‡å…¨0ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Game State æœ€ç»ˆç¥ç»ç½‘ç»œçš„è¾“å…¥æ˜¯ä¸€ä¸ª19x19x17çš„å¼ é‡ã€‚é‡Œé¢åŒ…å«é»‘æ£‹å’Œç™½æ£‹çš„æœ€è¿‘8æ­¥è¡Œæ£‹çŠ¶æ€å’Œå½“å‰è¡Œæ£‹æ–¹çš„ä¿¡æ¯ã€‚ æ¥ç€æˆ‘ä»¬çœ‹çœ‹ç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼Œç¥ç»ç½‘ç»œçš„è¾“å‡ºåŒ…æ‹¬ç­–ç•¥éƒ¨åˆ†å’Œä»·å€¼éƒ¨åˆ†ã€‚å¯¹äºç­–ç•¥éƒ¨åˆ†ï¼Œå®ƒé¢„æµ‹å½“å‰å„ä¸ªè¡Œæ£‹ç‚¹è½å­çš„æ¦‚ç‡ã€‚ç”±äºå›´æ£‹æœ‰361ä¸ªè½å­ç‚¹ï¼ŒåŠ ä¸Šè¿˜å¯ä»¥Passä¸€æ‰‹ï¼Œå› æ­¤ä¸€å…±æœ‰362ä¸ªç­–ç•¥ç«¯æ¦‚ç‡è¾“å‡ºã€‚å¯¹äºä»·å€¼ç«¯ï¼Œè¾“å‡ºå°±ç®€å•äº†ï¼Œå°±æ˜¯å½“å‰å±€é¢èƒœè´Ÿçš„è¯„ä¼°å€¼ï¼Œåœ¨[-1,1]ä¹‹é—´ã€‚ çœ‹å®Œäº†ç¥ç»ç½‘ç»œçš„è¾“å…¥å’Œè¾“å‡ºï¼Œæˆ‘ä»¬å†çœ‹çœ‹ç¥ç»ç½‘ç»œçš„ç»“æ„ï¼Œä¸»è¦æ˜¯ç”¨CNNç»„æˆçš„æ·±åº¦æ®‹å·®ç½‘ç»œã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åœ¨19x19x17çš„å¼ é‡åšäº†ä¸€ä¸ªåŸºæœ¬çš„å·ç§¯åï¼Œä½¿ç”¨äº†19å±‚æˆ–è€…39å±‚çš„æ·±åº¦æ®‹å·®ç½‘ç»œï¼Œè¿™ä¸ªæ˜¯ResNetçš„ç»å…¸ç»“æ„ã€‚ç†è®ºä¸Šè¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨DenseNetç­‰å…¶ä»–æµè¡Œçš„ç½‘ç»œç»“æ„ã€‚ç¥ç»ç½‘ç»œçš„æŸå¤±å‡½æ•°éƒ¨åˆ†æˆ‘ä»¬åœ¨ç¬¬äºŒèŠ‚å·²ç»å°†äº†ã€‚æ•´ä¸ªç¥ç»ç½‘ç»œå°±æ˜¯ä¸ºäº†å½“MCTSé‡åˆ°æ²¡æœ‰è§è¿‡çš„å±€é¢æ—¶ï¼Œæä¾›çš„å½“å‰çŠ¶æ€ä¸‹çš„å±€é¢è¯„ä¼°å’Œè½å­æ¦‚ç‡å‚è€ƒã€‚è¿™éƒ¨åˆ†ä¿¡æ¯ä¼šè¢«MCTSåç»­ç»¼åˆåˆ©ç”¨ã€‚ 4. AlphaGo Zeroçš„MCTSæœç´¢ ç°åœ¨æˆ‘ä»¬æ¥å†çœ‹çœ‹AlphaGo Zeroçš„MCTSæœç´¢è¿‡ç¨‹ï¼Œåœ¨å¼ºåŒ–å­¦ä¹ (åå…«) åŸºäºæ¨¡æ‹Ÿçš„æœç´¢ä¸è’™ç‰¹å¡ç½—æ ‘æœç´¢(MCTS)é‡Œï¼Œæˆ‘ä»¬å·²ç»ä»‹ç»äº†MCTSçš„åŸºæœ¬åŸç†ï¼Œå’Œ4ä¸ªä¸»è¦çš„æœç´¢é˜¶æ®µï¼šé€‰æ‹©ï¼Œæ‰©å±•ï¼Œä»¿çœŸå’Œå›æº¯ã€‚å’Œä¸Šä¸€ç¯‡çš„å†…å®¹ç›¸æ¯”ï¼Œè¿™é‡ŒMCTSçš„ä¸åŒä¸»è¦ä½“ç°åœ¨æ ‘ç»“æ„ä¸Šä¿å­˜çš„ä¿¡æ¯ä¸åŒï¼Œè¿›è€ŒUCTçš„è®¡ç®—å…¬å¼ä¹Ÿç¨æœ‰ä¸åŒã€‚æœ€åMCTSæœç´¢å®Œæ¯•åï¼ŒAlphaGo Zeroä¹Ÿæœ‰è‡ªå·±é€‰æ‹©çœŸæ­£è½å­ç‚¹çš„ç­–ç•¥ã€‚ åœ¨ä¸Šä¸€ç¯‡é‡Œï¼Œæˆ‘ä»¬çš„MCTSä¸Šä¿å­˜çš„æ•°æ®å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸‹çš„æ€»ç›˜æ•°å’Œèµ¢çš„æ€»ç›˜æ•°ã€‚åœ¨AlphaGo Zeroè¿™é‡Œï¼Œæˆ‘ä»¬ä¿å­˜çš„ä¿¡æ¯ä¼šå¤šä¸€äº›ã€‚ä¸»è¦åŒ…æ‹¬ä¸‹é¢çš„4éƒ¨åˆ†ï¼š $N(s,a)$:è®°å½•è¾¹çš„è®¿é—®æ¬¡æ•° $W(s,a)$: åˆè®¡è¡ŒåŠ¨ä»·å€¼ $Q(s,a)$:å¹³å‡è¡ŒåŠ¨ä»·å€¼ $P(s,a)$:é€‰æ‹©è¯¥æ¡è¾¹çš„å…ˆéªŒæ¦‚ç‡ å…¶ä¸­ $s$ ä¸ºå½“å‰æ£‹å±€çŠ¶æ€ï¼Œ$a$ ä¸ºæŸä¸€è½å­é€‰æ‹©å¯¹åº”çš„æ ‘åˆ†æ”¯ã€‚ æœ‰äº†MCTSä¸Šçš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬çœ‹çœ‹AlphaGo Zeroçš„MCTSæœç´¢çš„4ä¸ªé˜¶æ®µæµç¨‹ï¼š é¦–å…ˆæ˜¯é€‰æ‹©ï¼Œåœ¨MCTSå†…éƒ¨ï¼Œå‡ºç°è¿‡çš„å±€é¢ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨UCTé€‰æ‹©å­åˆ†æ”¯ã€‚å­åˆ†æ”¯çš„UCTåŸç†å’Œä¸Šä¸€èŠ‚ä¸€æ ·ã€‚ä½†æ˜¯å…·ä½“çš„å…¬å¼ç¨æœ‰ä¸åŒï¼Œå¦‚ä¸‹ï¼š $$\\begin{gathered} U(s,a)=c_{puct}P(s,a)\\frac{\\sqrt{\\sum_bN(s,b)}}{1+N(s,a)} \\\\ a_t=\\arg\\max_a(Q(s_t,a)+U(s_t,a)) \\end{gathered}$$ æœ€ç»ˆæˆ‘ä»¬ä¼šé€‰æ‹© $Q+U$æœ€å¤§çš„å­åˆ†æ”¯ä½œä¸ºæœç´¢åˆ†æ”¯ï¼Œä¸€ç›´èµ°åˆ°æ£‹å±€ç»“æŸï¼Œæˆ–è€…èµ°åˆ°äº†æ²¡æœ‰åˆ°ç»ˆå±€MCTSçš„å¶å­èŠ‚ç‚¹ã€‚$c_{puct}$æ˜¯å†³å®šæ¢ç´¢ç¨‹åº¦çš„ä¸€ä¸ªç³»æ•°,ä¸Šä¸€ç¯‡å·²è®²è¿‡ã€‚ å¦‚æœåˆ°äº†æ²¡æœ‰åˆ°ç»ˆå±€çš„MCTSå¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è¿›å…¥MCTSçš„ç¬¬äºŒæ­¥ï¼Œæ‰©å±•é˜¶æ®µ,ä»¥åŠåç»­çš„ç¬¬ä¸‰æ­¥ä»¿çœŸé˜¶æ®µã€‚æˆ‘ä»¬è¿™é‡Œä¸€èµ·è®²ã€‚å¯¹äºå¶å­èŠ‚ç‚¹çŠ¶æ€sï¿½ï¼Œä¼šåˆ©ç”¨ç¥ç»ç½‘ç»œå¯¹å¶å­èŠ‚ç‚¹åšé¢„æµ‹ï¼Œå¾—åˆ°å½“å‰å¶å­èŠ‚ç‚¹çš„å„ä¸ªå¯èƒ½çš„å­èŠ‚ç‚¹ä½ç½®sLï¿½ï¿½è½å­çš„æ¦‚ç‡pï¿½å’Œå¯¹åº”çš„ä»·å€¼vï¿½,å¯¹äºè¿™äº›å¯èƒ½çš„æ–°èŠ‚ç‚¹æˆ‘ä»¬åœ¨MCTSä¸­åˆ›å»ºå‡ºæ¥ï¼Œåˆå§‹åŒ–å…¶åˆ†æ”¯ä¸Šä¿å­˜çš„ä¿¡æ¯ä¸ºï¼š $$\\{N(s_L,a)=0,W(s_L,a)=0,Q(s_L,a)=0,P(s_L,a)=P_a\\}$$ è¿™ä¸ªè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™æ ·æ‰©å±•åï¼Œä¹‹å‰çš„å¶å­èŠ‚ç‚¹ $s$ï¼Œç°åœ¨å°±æ˜¯å†…éƒ¨èŠ‚ç‚¹äº†ã€‚åšå®Œäº†æ‰©å±•å’Œä»¿çœŸåï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œå›æº¯ï¼Œå°†æ–°å¶å­èŠ‚ç‚¹åˆ†æ”¯çš„ä¿¡æ¯å›æº¯ç´¯åŠ åˆ°ç¥–å…ˆèŠ‚ç‚¹åˆ†æ”¯ä¸Šå»ã€‚è¿™ä¸ªå›æº¯çš„é€»è¾‘ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼Œä»æ¯ä¸ªå¶å­èŠ‚ç‚¹ $L$ ä¾æ¬¡å‘æ ¹èŠ‚ç‚¹å›æº¯ï¼Œå¹¶ä¾æ¬¡æ›´æ–°ä¸Šå±‚åˆ†æ”¯æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š $$\\begin{gathered} N(s_t,a_t)=N(s_t,a_t)+1 \\\\ W(s_t,a_t)=W(s_t,a_t)+v \\\\ Q(s_t,a_t)=\\frac{W(s_t,a_t)}{N(s_t,a_t)} \\end{gathered}$$ è¿™ä¸ªMCTSæœç´¢è¿‡ç¨‹åœ¨ä¸€æ¬¡çœŸæ­£è¡Œæ£‹å‰ï¼Œä¸€èˆ¬ä¼šè¿›è¡Œçº¦1600æ¬¡æœç´¢ï¼Œæ¯æ¬¡æœç´¢éƒ½ä¼šè¿›è¡Œä¸Šè¿°4ä¸ªé˜¶æ®µã€‚ è¿™ä¸Šåƒæ¬¡MCTSæœç´¢å®Œæ¯•åï¼ŒAlphaGo Zeroå°±å¯ä»¥åœ¨MCTSçš„æ ¹èŠ‚ç‚¹ $s$ åŸºäºä»¥ä¸‹å…¬å¼é€‰æ‹©è¡Œæ£‹çš„MCTSåˆ†æ”¯äº†: $$\\pi(a|s)=\\frac{N(s,a)^{1/\\tau}}{\\sum_bN(s,b)^{1/\\tau}}$$ å…¶ä¸­ï¼Œ$Ï„$ ä¸ºæ¸©åº¦å‚æ•°ï¼Œæ§åˆ¶æ¢ç´¢çš„ç¨‹åº¦ï¼Œ$Ï„$ è¶Šå¤§ï¼Œä¸åŒèµ°æ³•é—´å·®å¼‚å˜å°ï¼Œæ¢ç´¢æ¯”ä¾‹å¢å¤§ï¼Œåä¹‹ï¼Œåˆ™æ›´å¤šé€‰æ‹©å½“å‰æœ€ä¼˜æ“ä½œã€‚æ¯ä¸€æ¬¡å®Œæ•´çš„è‡ªæˆ‘å¯¹å¼ˆçš„å‰30æ­¥ï¼Œå‚æ•° $Ï„=1$ï¼Œè¿™æ˜¯æ—©æœŸé¼“åŠ±æ¢ç´¢çš„è®¾ç½®ã€‚æ¸¸æˆå‰©ä¸‹çš„æ­¥æ•°ï¼Œè¯¥å‚æ•°å°†é€æ¸é™ä½è‡³0ã€‚å¦‚æœæ˜¯æ¯”èµ›ï¼Œåˆ™ç›´æ¥ä¸º0. åŒæ—¶åœ¨éšåçš„æ—¶é—´æ­¥ä¸­ï¼Œè¿™ä¸ªMCTSæœç´¢æ ‘å°†ä¼šç»§ç»­ä½¿ç”¨ï¼Œå¯¹åº”äºå®é™…æ‰€é‡‡å–çš„è¡Œä¸ºçš„","date":"2024-02-25","objectID":"/posts/rl_learning_note_19/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [19] | AlphaGo Zeroå¼ºåŒ–å­¦ä¹ åŸç†","uri":"/posts/rl_learning_note_19/"},{"categories":["RL"],"content":" 0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ (åä¸ƒ) åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ä¸Dynaç®—æ³•æ¡†æ¶ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºåŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•çš„åŸºæœ¬æ€è·¯ï¼Œä»¥åŠé›†åˆåŸºäºæ¨¡å‹ä¸ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ¡†æ¶Dynaã€‚æœ¬æ–‡æˆ‘ä»¬è®¨è®ºå¦ä¸€ç§éå¸¸æµè¡Œçš„é›†åˆåŸºäºæ¨¡å‹ä¸ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼šåŸºäºæ¨¡æ‹Ÿçš„æœç´¢(Simulation Based Search)ã€‚ æœ¬ç¯‡ä¸»è¦å‚è€ƒäº†UCLå¼ºåŒ–å­¦ä¹ è¯¾ç¨‹çš„ç¬¬å…«è®²ï¼Œç¬¬ä¹è®²éƒ¨åˆ†ã€‚ 1. åŸºäºæ¨¡æ‹Ÿçš„æœç´¢æ¦‚è¿° ä»€ä¹ˆæ˜¯åŸºäºæ¨¡æ‹Ÿçš„æœç´¢å‘¢ï¼Ÿå½“ç„¶ä¸»è¦æ˜¯ä¸¤ä¸ªç‚¹ï¼šä¸€ä¸ªæ˜¯æ¨¡æ‹Ÿï¼Œä¸€ä¸ªæ˜¯æœç´¢ã€‚æ¨¡æ‹Ÿæˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡ä¹Ÿè®¨è®ºè¿‡ï¼Œå°±æ˜¯åŸºäºå¼ºåŒ–å­¦ä¹ æ¨¡å‹è¿›è¡Œé‡‡æ ·ï¼Œå¾—åˆ°æ ·æœ¬æ•°æ®ã€‚ä½†æ˜¯è¿™æ˜¯æ•°æ®ä¸æ˜¯åŸºäºå’Œç¯å¢ƒäº¤äº’è·å¾—çš„çœŸå®æ•°æ®ï¼Œæ‰€ä»¥æ˜¯â€œæ¨¡æ‹Ÿâ€ã€‚å¯¹äºæœç´¢ï¼Œåˆ™æ˜¯ä¸ºäº†åˆ©ç”¨æ¨¡æ‹Ÿçš„æ ·æœ¬ç»“æœæ¥å¸®æˆ‘ä»¬è®¡ç®—åˆ°åº•åº”è¯¥é‡‡ç”¨ä»€ä¹ˆæ ·çš„åŠ¨ä½œï¼Œä»¥å®ç°æˆ‘ä»¬çš„é•¿æœŸå—ç›Šæœ€å¤§åŒ–ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆè¦è¿›è¡ŒåŸºäºæ¨¡æ‹Ÿçš„æœç´¢å‘¢ï¼Ÿåœ¨è¿™ä¹‹å‰æˆ‘ä»¬å…ˆçœ‹çœ‹æœ€ç®€å•çš„å‰å‘æœç´¢(forward search)ã€‚å‰å‘æœç´¢ç®—æ³•ä»å½“å‰æˆ‘ä»¬è€ƒè™‘çš„çŠ¶æ€èŠ‚ç‚¹ $S_t$ å¼€å§‹è€ƒè™‘ï¼Œæ€ä¹ˆè€ƒè™‘å‘¢ï¼Ÿå¯¹è¯¥çŠ¶æ€èŠ‚ç‚¹æ‰€æœ‰å¯èƒ½çš„åŠ¨ä½œè¿›è¡Œæ‰©å±•ï¼Œå»ºç«‹ä¸€é¢—ä»¥ $S_t$ ä¸ºæ ¹èŠ‚ç‚¹çš„æœç´¢æ ‘ï¼Œè¿™ä¸ªæœç´¢æ ‘ä¹Ÿæ˜¯ä¸€ä¸ªMDPï¼Œåªæ˜¯å®ƒæ˜¯ä»¥å½“å‰çŠ¶æ€ä¸ºæ ¹èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯ä»¥èµ·å§‹çŠ¶æ€ä¸ºæ ¹èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä¹Ÿå«åšsub-MDPã€‚æˆ‘ä»¬æ±‚è§£è¿™ä¸ªsub-MDPé—®é¢˜ï¼Œç„¶åå¾—åˆ° $S_t$çŠ¶æ€æœ€åº”è¯¥é‡‡ç”¨çš„åŠ¨ä½œ $A_t$ã€‚å‰å‘æœç´¢çš„sub-MDPå¦‚ä¸‹å›¾ï¼š forward search sub-MDP å‰å‘æœç´¢å»ºç«‹äº†ä¸€ä¸ªsub-MDPæ¥æ±‚è§£ï¼Œè¿™å¾ˆç²¾ç¡®ï¼Œè€Œä¸”è¿™åœ¨çŠ¶æ€åŠ¨ä½œæ•°é‡éƒ½å¾ˆå°‘çš„æ—¶å€™æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯åªè¦ç¨å¾®çŠ¶æ€åŠ¨ä½œæ•°é‡å¤šä¸€ç‚¹ï¼Œæ¯ä¸ªçŠ¶æ€çš„é€‰æ‹©å°±éƒ½ç‰¹åˆ«æ…¢äº†ï¼Œå› æ­¤ä¸å¤ªå®ç”¨ï¼Œæ­¤æ—¶åŸºäºæ¨¡æ‹Ÿçš„æœç´¢å°±æ˜¯ä¸€ç§æ¯”è¾ƒå¥½çš„æŠ˜è¡·ã€‚ 2. ç®€å•è’™ç‰¹å¡ç½—æœç´¢ é¦–å…ˆæˆ‘ä»¬çœ‹çœ‹åŸºäºæ¨¡æ‹Ÿçš„æœç´¢ä¸­æ¯”è¾ƒç®€å•çš„ä¸€ç§æ–¹æ³•ï¼šç®€å•è’™ç‰¹å¡ç½—æœç´¢ã€‚ ç®€å•è’™ç‰¹å¡ç½—æœç´¢åŸºäºä¸€ä¸ªå¼ºåŒ–å­¦ä¹ æ¨¡å‹ $M_v$ å’Œä¸€ä¸ªæ¨¡æ‹Ÿç­–ç•¥ $Ï€$.åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¯¹äºå½“å‰æˆ‘ä»¬è¦é€‰æ‹©åŠ¨ä½œçš„çŠ¶æ€ $S_t$, å¯¹æ¯ä¸€ä¸ªå¯èƒ½é‡‡æ ·çš„åŠ¨ä½œ $aâˆˆA$,éƒ½è¿›è¡Œ $K$ è½®é‡‡æ ·ï¼Œè¿™æ ·æ¯ä¸ªåŠ¨ä½œ $a$ éƒ½ä¼šå¾—åˆ° $K$ ç»„ç»å†å®Œæ•´çš„çŠ¶æ€åºåˆ—(episode)ã€‚å³ï¼š $$\\{S_t,a,R_{t+1}^k,S_{t+1}^k,A_{t+1}^k,\\ldots\\ldots S_T^k\\}_{k=1}^K\\sim M_v,\\pi $$ ç°åœ¨å¯¹äºæ¯ä¸ª $(S_t,a)$ ç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºè’™ç‰¹å¡ç½—æ³•æ¥è®¡ç®—å…¶åŠ¨ä½œä»·å€¼å‡½æ•°å¹¶é€‰æ‹©æœ€ä¼˜çš„åŠ¨ä½œäº†ã€‚ $$\\begin{gathered}Q(S_t,a)=\\frac1K\\sum_{k=1}^KG_t\\\\a_t=\\arg\\max_{a\\in A}Q(S_t,a)\\end{gathered}$$ ç®€å•è’™ç‰¹å¡ç½—æœç´¢å’Œèµ·å‰å‘æœç´¢æ¯”èµ·æ¥ï¼Œå¯¹äºçŠ¶æ€åŠ¨ä½œæ•°é‡çš„å¤„ç†èƒ½åŠ›ä¸Šäº†ä¸€ä¸ªæ•°é‡çº§,å¯ä»¥å¤„ç†ä¸­ç­‰è§„æ¨¡çš„é—®é¢˜ã€‚ä½†æ˜¯å‡å¦‚æˆ‘ä»¬çš„çŠ¶æ€åŠ¨ä½œæ•°é‡è¾¾åˆ°éå¸¸å¤§çš„é‡çº§ï¼Œæ¯”å¦‚å›´æ£‹çš„çº§åˆ«,é‚£ä¹ˆç®€å•è’™ç‰¹å¡ç½—æœç´¢ä¹Ÿå¤ªæ…¢äº†ã€‚åŒæ—¶ï¼Œç”±äºä½¿ç”¨è’™ç‰¹å¡ç½—æ³•è®¡ç®—å…¶åŠ¨ä½œä»·å€¼å‡½æ•°ï¼Œæ¨¡æ‹Ÿé‡‡æ ·å¾—åˆ°çš„ä¸€äº›ä¸­é—´çŠ¶æ€å’Œå¯¹åº”è¡Œä¸ºçš„ä»·å€¼å°±è¢«å¿½ç•¥äº†ï¼Œè¿™éƒ¨åˆ†æ•°æ®èƒ½ä¸èƒ½åˆ©ç”¨èµ·æ¥å‘¢ï¼Ÿ ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹è’™ç‰¹å¡ç½—æ ‘æœç´¢(Monte-Carlo Tree Searchï¼Œä»¥ä¸‹ç®€ç§°MCTS)æ€ä¹ˆä¼˜åŒ–è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ 3. MCTSçš„åŸç† MCTSæ‘’å¼ƒäº†ç®€å•è’™ç‰¹å¡ç½—æœç´¢é‡Œé¢å¯¹å½“å‰çŠ¶æ€ $S_t$ æ¯ä¸ªåŠ¨ä½œéƒ½è¦è¿›è¡ŒKæ¬¡æ¨¡æ‹Ÿé‡‡æ ·çš„åšæ³•ï¼Œè€Œæ˜¯æ€»å…±å¯¹å½“å‰çŠ¶æ€ $S_t$è¿›è¡ŒKæ¬¡é‡‡æ ·ï¼Œè¿™æ ·é‡‡æ ·åˆ°çš„åŠ¨ä½œåªæ˜¯åŠ¨ä½œå…¨é›† $A$ ä¸­çš„ä¸€éƒ¨åˆ†ã€‚è¿™æ ·åšå¤§å¤§é™ä½äº†é‡‡æ ·çš„æ•°é‡å’Œé‡‡æ ·åçš„æœç´¢è®¡ç®—ã€‚å½“ç„¶ï¼Œä»£ä»·æ˜¯å¯èƒ½åŠ¨ä½œå…¨é›†ä¸­çš„å¾ˆå¤šåŠ¨ä½œéƒ½æ²¡æœ‰é‡‡æ ·åˆ°ï¼Œå¯èƒ½é”™å¤±å¥½çš„åŠ¨ä½œé€‰æ‹©ï¼Œè¿™æ˜¯ä¸€ä¸ªç®—æ³•è®¾è®¡ä¸Šçš„æŠ˜è¡·ã€‚ åœ¨MCTSä¸­ï¼ŒåŸºäºä¸€ä¸ªå¼ºåŒ–å­¦ä¹ æ¨¡å‹ $M_v$å’Œä¸€ä¸ªæ¨¡æ‹Ÿç­–ç•¥$Ï€$ï¼Œå½“å‰çŠ¶æ€ $S_t$ å¯¹åº”çš„å®Œæ•´çš„çŠ¶æ€åºåˆ—(episode)æ˜¯è¿™æ ·çš„: $$\\{S_t,A_t^k,R_{t+1}^k,S_{t+1}^k,A_{t+1}^k,\\ldots\\ldots S_T^k\\}_{k=1}^K\\sim M_v,\\pi $$ é‡‡æ ·å®Œæ¯•åï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºé‡‡æ ·çš„ç»“æœæ„å»ºä¸€é¢—MCTSçš„æœç´¢æ ‘ï¼Œç„¶åè¿‘ä¼¼è®¡ç®— $Q(st,a)$å’Œæœ€å¤§ $Q(s_t,a)$å¯¹åº”çš„åŠ¨ä½œã€‚ $$\\begin{gathered}Q(S_t,a)=\\frac1{N(S_t,a)}\\sum_{k=1}^K\\sum_{u=t}^T1(S_{uk}=S_t,A_{uk}=a)G_u\\\\a_t=\\arg\\max_{a\\in A}Q(S_t,a)\\end{gathered}$$ MCTSæœç´¢çš„ç­–ç•¥åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šç¬¬ä¸€ä¸ªæ˜¯æ ‘å†…ç­–ç•¥(tree policy)ï¼šä¸ºå½“æ¨¡æ‹Ÿé‡‡æ ·å¾—åˆ°çš„çŠ¶æ€å­˜åœ¨äºå½“å‰çš„MCTSæ—¶ä½¿ç”¨çš„ç­–ç•¥ã€‚æ ‘å†…ç­–ç•¥å¯ä»¥ä½¿ $Ïµâˆ’$è´ªå©ªç­–ç•¥ï¼Œéšç€æ¨¡æ‹Ÿçš„è¿›è¡Œç­–ç•¥å¯ä»¥å¾—åˆ°æŒç»­æ”¹å–„ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸Šé™ç½®ä¿¡åŒºé—´ç®—æ³•UCTï¼Œè¿™åœ¨æ£‹ç±»æ¸¸æˆä¸­å¾ˆæ™®éï¼›ç¬¬äºŒä¸ªæ˜¯é»˜è®¤ç­–ç•¥(default policy)ï¼šå¦‚æœå½“å‰çŠ¶æ€ä¸åœ¨MCTSå†…ï¼Œä½¿ç”¨é»˜è®¤ç­–ç•¥æ¥å®Œæˆæ•´ä¸ªçŠ¶æ€åºåˆ—çš„é‡‡æ ·ï¼Œå¹¶æŠŠå½“å‰çŠ¶æ€çº³å…¥åˆ°æœç´¢æ ‘ä¸­ã€‚é»˜è®¤ç­–ç•¥å¯ä»¥ä½¿éšæœºç­–ç•¥æˆ–åŸºäºç›®æ ‡ä»·å€¼å‡½æ•°çš„ç­–ç•¥ã€‚ è¿™é‡Œè®²åˆ°çš„æ˜¯æœ€ç»å…¸çš„å¼ºåŒ–å­¦ä¹ ç»ˆMCTSçš„ç”¨æˆ·ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰å»¶æ—¶å¥–åŠ±ï¼Œä½†æ˜¯åœ¨æ£‹ç±»ä¹‹ç±»çš„é›¶å’Œé—®é¢˜ä¸­ï¼Œä¸­é—´çŠ¶æ€æ˜¯æ²¡æœ‰æ˜ç¡®å¥–åŠ±çš„ï¼Œæˆ‘ä»¬åªæœ‰åœ¨æ£‹ä¸‹å®ŒåçŸ¥é“è¾“èµ¢äº†æ‰èƒ½å¯¹å‰é¢çš„åŠ¨ä½œè¿›è¡ŒçŠ¶æ€å¥–åŠ±ï¼Œå¯¹äºè¿™ç±»é—®é¢˜æˆ‘ä»¬çš„MCTSéœ€è¦åšä¸€äº›ç»“æ„ä¸Šçš„ç»†åŒ–ã€‚ 4. ä¸Šé™ç½®ä¿¡åŒºé—´ç®—æ³•UCT åœ¨è®¨è®ºæ£‹ç±»æ¸¸æˆçš„MCTSæœç´¢ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç†Ÿæ‚‰ä¸‹ä¸Šé™ç½®ä¿¡åŒºé—´ç®—æ³•(Upper Confidence Bound Applied to Trees, ä»¥ä¸‹ç®€ç§°UCT)ã€‚å®ƒæ˜¯ä¸€ç§ç­–ç•¥ç®—æ³•ï¼Œæˆ‘ä»¬ä¹‹å‰æœ€å¸¸ç”¨çš„æ˜¯ $Ïµâˆ’$è´ªå©ªç­–ç•¥ã€‚ä½†æ˜¯åœ¨æ£‹ç±»é—®é¢˜ä¸­ï¼ŒUCTæ›´å¸¸ä½¿ç”¨ã€‚ åœ¨æ£‹ç±»æ¸¸æˆä¸­ï¼Œç»å¸¸æœ‰è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬å‘ç°åœ¨æŸç§æ£‹çš„çŠ¶æ€ä¸‹ï¼Œæœ‰2ä¸ªå¯é€‰åŠ¨ä½œï¼Œç¬¬ä¸€ä¸ªåŠ¨ä½œå†å²æ£‹å±€ä¸­æ˜¯0èƒœ1è´Ÿï¼Œç¬¬äºŒä¸ªåŠ¨ä½œå†å²æ£‹å±€ä¸­æ˜¯8èƒœ10è´Ÿï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥é€‰æ‹©å“ªä¸ªåŠ¨ä½œå¥½å‘¢ï¼Ÿå¦‚æœæŒ‰ $Ïµâˆ’$è´ªå©ªç­–ç•¥ï¼Œåˆ™ç¬¬äºŒä¸ªåŠ¨ä½œéå¸¸å®¹æ˜“è¢«é€‰æ‹©åˆ°ã€‚ä½†æ˜¯å…¶å®è™½ç„¶ç¬¬ä¸€ä¸ªåŠ¨ä½œèƒœåˆ©0%ï¼Œä½†æ˜¯å¾ˆå¯èƒ½æ˜¯å› ä¸ºè¿™ä¸ªåŠ¨ä½œçš„å†å²æ£‹å±€å°‘ï¼Œæ•°æ®ä¸å¤Ÿå¯¼è‡´çš„ï¼Œå¾ˆå¯èƒ½è¯¥åŠ¨ä½œä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„åŠ¨ä½œã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åœ¨æœ€ä¼˜ç­–ç•¥å’Œæ¢ç´¢åº¦è¾¾åˆ°ä¸€ä¸ªé€‰æ‹©å¹³è¡¡å‘¢ï¼Ÿ $Ïµâˆ’$è´ªå©ªç­–ç•¥å¯ä»¥ç”¨ï¼Œä½†æ˜¯UCTæ˜¯ä¸€ä¸ªæ›´ä¸é”™çš„é€‰æ‹©ã€‚ UCTé¦–å…ˆè®¡ç®—æ¯ä¸€ä¸ªå¯é€‰åŠ¨ä½œèŠ‚ç‚¹å¯¹åº”çš„åˆ†æ•°ï¼Œè¿™ä¸ªåˆ†æ•°è€ƒè™‘äº†å†å²æœ€ä¼˜ç­–ç•¥å’Œæ¢ç´¢åº¦å—ï¼Œä¸€ä¸ªå¸¸ç”¨çš„å…¬å¼å¦‚ä¸‹ï¼š $$\\text{score}=\\left.\\frac{w_i}{n_i}+c\\sqrt{\\frac{\\ln N_i}{n_i}}\\right.$$ å…¶ä¸­ï¼Œ$w_i$ æ˜¯ i èŠ‚ç‚¹çš„èƒœåˆ©æ¬¡æ•°ï¼Œ$n_i$ æ˜¯ièŠ‚ç‚¹çš„æ¨¡æ‹Ÿæ¬¡æ•°ï¼Œ$N_i$ æ˜¯æ‰€æœ‰æ¨¡æ‹Ÿæ¬¡æ•°ï¼Œc æ˜¯æ¢ç´¢å¸¸æ•°ï¼Œç†è®ºå€¼ä¸º$âˆš2$ï¼Œå¯æ ¹æ®ç»éªŒè°ƒæ•´ï¼Œ$c$ è¶Šå¤§å°±è¶Šåå‘äºå¹¿åº¦æœç´¢ï¼Œ$c$ è¶Šå°å°±è¶Šåå‘äºæ·±åº¦æœç´¢ã€‚æœ€åæˆ‘ä»¬é€‰æ‹©åˆ†æ•°æœ€é«˜çš„åŠ¨ä½œèŠ‚ç‚¹ã€‚ æ¯”å¦‚å¯¹äºä¸‹é¢çš„æ£‹å±€ï¼Œå¯¹äºæ ¹èŠ‚ç‚¹æ¥è¯´ï¼Œæœ‰3ä¸ªé€‰æ‹©ï¼Œç¬¬ä¸€ä¸ªé€‰æ‹©7èƒœ3è´Ÿï¼Œç¬¬äºŒä¸ªé€‰æ‹©5èƒœ3è´Ÿï¼Œç¬¬ä¸‰ä¸ªé€‰æ‹©0èƒœ3è´Ÿã€‚ å¦‚æœæˆ‘ä»¬å–c=10,åˆ™ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„åˆ†æ•°ä¸ºï¼š$$score(7,10)=7/10+C\\cdot\\sqrt{\\frac{\\log(21)}{10}}\\approx6.2$$ ç¬¬äºŒä¸ªèŠ‚ç‚¹çš„åˆ†æ•°ä¸ºï¼š$$score(5,8)=5/8+C\\cdot\\sqrt{\\frac{\\log(21)}8}\\approx6.8$$ ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹çš„åˆ†æ•°ä¸ºï¼š$$score(0,3)=0/3+C\\cdot\\sqrt{\\frac{\\log(21)}3}\\approx10$$ å¯è§ï¼Œç”±äºæˆ‘ä»¬æŠŠæ¢ç´¢ç‡ $c$ è®¾ç½®çš„æ¯”è¾ƒå¤§ï¼Œç¬¬ä¸‰ä¸ªèŠ‚ç‚¹æ˜¯è¢«UCTé€‰ä¸­è¦æ‰§è¡Œçš„åŠ¨ä½œèŠ‚ç‚¹ã€‚å½“ç„¶å¦‚æœæˆ‘ä»¬æŠŠcè®¾ç½®çš„æ¯”è¾ƒå°çš„è¯ï¼Œç¬¬ä¸€ä¸ªæˆ–è€…ç¬¬äºŒä¸ªå¯èƒ½å°±å˜æˆæœ€å¤§çš„åˆ†æ•°äº†ã€‚ 5. æ£‹ç±»æ¸¸æˆMCTSæœç´¢ åœ¨åƒä¸­å›½è±¡æ£‹ï¼Œå›´æ£‹è¿™æ ·çš„é›¶å’Œé—®é¢˜ä¸­ï¼Œä¸€ä¸ªåŠ¨ä½œåªæœ‰åœ¨æ£‹å±€ç»“æŸæ‰èƒ½æ‹¿åˆ°çœŸæ­£çš„å¥–åŠ±ï¼Œå› æ­¤æˆ‘ä»¬å¯¹MCTSçš„æœç´¢æ­¥éª¤å’Œæ ‘ç»“æ„ä¸Šéœ€è¦æ ¹æ®é—®é¢˜çš„ä¸åŒåšä¸€äº›ç»†åŒ–ã€‚ å¯¹äºMCTSçš„æ ‘ç»“æ„ï¼Œå¦‚æœæ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼Œåªéœ€è¦åœ¨èŠ‚ç‚¹ä¸Šä¿å­˜çŠ¶æ€å¯¹åº”çš„å†å²èƒœè´Ÿè®°å½•ã€‚åœ¨æ¯æ¡è¾¹ä¸Šä¿å­˜é‡‡æ ·çš„åŠ¨ä½œã€‚è¿™æ ·MCTSçš„æœç´¢éœ€è¦èµ°4æ­¥ï¼Œå¦‚ä¸‹å›¾(å›¾æ¥è‡ªç»´åŸºç™¾ç§‘)ï¼š BP Network ç¬¬ä¸€æ­¥æ˜¯é€‰æ‹©(Selection):è¿™ä¸€æ­¥ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ¯æ¬¡éƒ½é€‰ä¸€ä¸ªâ€œæœ€å€¼å¾—æœç´¢çš„å­èŠ‚ç‚¹â€ï¼Œä¸€èˆ¬ä½¿ç”¨UCTé€‰æ‹©åˆ†æ•°æœ€é«˜çš„èŠ‚ç‚¹ï¼Œç›´åˆ°æ¥åˆ°ä¸€ä¸ªâ€œå­˜åœ¨æœªæ‰©å±•çš„å­èŠ‚ç‚¹â€çš„èŠ‚ç‚¹ï¼Œå¦‚å›¾ä¸­çš„ 3/3 èŠ‚ç‚¹ã€‚ä¹‹æ‰€ä»¥å«åšâ€œå­˜åœ¨æœªæ‰©å±•çš„å­èŠ‚ç‚¹â€ï¼Œæ˜¯å› ä¸ºè¿™ä¸ªå±€é¢å­˜åœ¨æœªèµ°è¿‡çš„åç»­ç€æ³•ï¼Œä¹Ÿå°±æ˜¯MCTSä¸­æ²¡æœ‰åç»­çš„åŠ¨ä½œå¯ä»¥å‚è€ƒäº†ã€‚è¿™æ—¶æˆ‘ä»¬è¿›å…¥ç¬¬äºŒæ­¥ã€‚ ç¬¬äºŒæ­¥æ˜¯æ‰©å±•(Expansion)ï¼Œåœ¨è¿™ä¸ªæœç´¢åˆ°çš„å­˜åœ¨æœªæ‰©å±•çš„å­èŠ‚ç‚¹ï¼ŒåŠ ä¸Šä¸€ä¸ª0/0çš„å­èŠ‚ç‚¹ï¼Œè¡¨ç¤ºæ²¡æœ‰å†å²è®°å½•å‚è€ƒã€‚è¿™æ—¶æˆ‘ä»¬è¿›å…¥ç¬¬ä¸‰æ­¥ã€‚ ç¬¬ä¸‰æ­¥æ˜¯ä»¿çœŸ(simulation)ï¼Œä»ä¸Šé¢è¿™ä¸ªæ²¡æœ‰è¯•è¿‡çš„ç€æ³•å¼€å§‹ï¼Œç”¨ä¸€ä¸ªç®€å•ç­–ç•¥æ¯”å¦‚å¿«é€Ÿèµ°å­ç­–ç•¥ï¼ˆRollout policyï¼‰èµ°åˆ°åº•ï¼Œå¾—åˆ°ä¸€ä¸ªèƒœè´Ÿç»“æœã€‚å¿«é€Ÿèµ°å­ç­–ç•¥ä¸€èˆ¬é€‚åˆé€‰æ‹©èµ°å­å¾ˆå¿«å¯èƒ½ä¸æ˜¯å¾ˆç²¾ç¡®çš„ç­–ç•¥ã€‚å› ä¸ºå¦‚æœè¿™ä¸ªç­–ç•¥èµ°å¾—æ…¢ï¼Œç»“æœè™½ç„¶ä¼šæ›´å‡†ç¡®ï¼Œä½†ç”±äºè€—æ—¶å¤šäº†ï¼Œåœ¨å•ä½æ—¶é—´å†…çš„æ¨¡æ‹Ÿæ¬¡æ•°å°±å°‘äº†ï¼Œæ‰€ä»¥ä¸ä¸€å®šä¼šæ£‹åŠ›æ›´å¼ºï¼Œæœ‰å¯èƒ½ä¼šæ›´å¼±ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸€èˆ¬åªæ¨¡æ‹Ÿä¸€æ¬¡ï¼Œå› ä¸ºå¦‚æœæ¨¡æ‹Ÿå¤šæ¬¡ï¼Œè™½ç„¶æ›´å‡†ç¡®ï¼Œä½†æ›´æ…¢ã€‚ ç¬¬å››æ­¥æ˜¯å›æº¯(backpropagation), å°†æˆ‘ä»¬æœ€åå¾—åˆ°çš„èƒœè´Ÿç»“æœå›æº¯åŠ åˆ°MCTSæ ‘ç»“æ„ä¸Šã€‚æ³¨æ„é™¤äº†ä¹‹å‰çš„MCTSæ ‘è¦å›æº¯å¤–ï¼Œæ–°åŠ å…¥çš„èŠ‚ç‚¹ä¹Ÿè¦åŠ ä¸Šä¸€æ¬¡èƒœè´Ÿå†å²è®°å½•ï¼Œå¦‚ä¸Šå›¾æœ€å³è¾¹æ‰€ç¤ºã€‚ ä»¥ä¸Šå°±æ˜¯MCTSæœç´¢çš„æ•´ä¸ªè¿‡ç¨‹ã€‚è¿™4æ­¥ä¸€èˆ¬æ˜¯é€šç”¨çš„ï¼Œä½†æ˜¯MCTSæ ‘ç»“æ„ä¸Šä¿å­˜çš„å†…å®¹è€Œä¸€èˆ¬æ ¹æ®è¦è§£å†³çš„é—®é¢˜å’Œå»ºæ¨¡çš„å¤æ‚åº¦è€Œä¸åŒã€‚ 6. MCTSå°ç»“","date":"2024-02-25","objectID":"/posts/rl_learning_note_18/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [18] | åŸºäºæ¨¡æ‹Ÿçš„æœç´¢ä¸è’™ç‰¹å¡ç½—æ ‘æœç´¢(MCTS)","uri":"/posts/rl_learning_note_18/"},{"categories":["RL"],"content":"å¼ºåŒ–å­¦ä¹ (åä¸ƒ) åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ä¸Dynaç®—æ³•æ¡†æ¶ åœ¨å‰é¢æˆ‘ä»¬è®¨è®ºäº†åŸºäºä»·å€¼çš„å¼ºåŒ–å­¦ä¹ (Value Based RL)å’ŒåŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ æ¨¡å‹(Policy Based RL)ï¼Œæœ¬ç¯‡æˆ‘ä»¬è®¨è®ºæœ€åä¸€ç§å¼ºåŒ–å­¦ä¹ æµæ´¾ï¼ŒåŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ (Model Based RL)ï¼Œä»¥åŠåŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•æ¡†æ¶Dynaã€‚ æœ¬ç¯‡ä¸»è¦å‚è€ƒäº†UCLå¼ºåŒ–å­¦ä¹ è¯¾ç¨‹çš„ç¬¬8è®²å’ŒDyna-2çš„è®ºæ–‡ã€‚ 1. åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ç®€ä»‹ åŸºäºä»·å€¼çš„å¼ºåŒ–å­¦ä¹ æ¨¡å‹å’ŒåŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ æ¨¡å‹éƒ½ä¸æ˜¯åŸºäºæ¨¡å‹çš„ï¼Œå®ƒä»¬ä»ä»·å€¼å‡½æ•°ï¼Œç­–ç•¥å‡½æ•°ä¸­ç›´æ¥å»å­¦ä¹ ï¼Œä¸ç”¨å­¦ä¹ ç¯å¢ƒçš„çŠ¶æ€è½¬åŒ–æ¦‚ç‡æ¨¡å‹ï¼Œå³åœ¨çŠ¶æ€ $s$ ä¸‹é‡‡å–åŠ¨ä½œ $a$,è½¬åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ $sâ€™$ çš„æ¦‚ç‡ $P^a_{ssâ€™}$ã€‚ è€ŒåŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ åˆ™ä¼šå°è¯•ä»ç¯å¢ƒçš„æ¨¡å‹å»å­¦ä¹ ï¼Œä¸€èˆ¬æ˜¯ä¸‹é¢ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„æ¨¡å‹ï¼š ä¸€ä¸ªæ˜¯çŠ¶æ€è½¬åŒ–é¢„æµ‹æ¨¡å‹ï¼Œè¾“å…¥å½“å‰çŠ¶æ€ $s$å’ŒåŠ¨ä½œ $a$ï¼Œé¢„æµ‹ä¸‹ä¸€ä¸ªçŠ¶æ€ $sâ€™$ã€‚ å¦ä¸€ä¸ªæ˜¯å¥–åŠ±é¢„æµ‹æ¨¡å‹ï¼Œè¾“å…¥å½“å‰çŠ¶æ€ $s$å’ŒåŠ¨ä½œ $a$ï¼Œé¢„æµ‹ç¯å¢ƒçš„å¥–åŠ± $r$ã€‚ å³æ¨¡å‹å¯ä»¥æè¿°ä¸ºä¸‹é¢ä¸¤ä¸ªå¼å­ï¼š $$\\begin{gathered}S_{t+1}\\sim P(S_{t+1}|S_t,A_t)\\\\R_{t+1}\\sim R(R_{t+1}|S_t,A_t)\\end{gathered}$$ å¦‚æœæ¨¡å‹ $P$, $R$ å¯ä»¥å‡†ç¡®çš„æè¿°çœŸæ­£çš„ç¯å¢ƒçš„è½¬åŒ–æ¨¡å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åŸºäºæ¨¡å‹æ¥é¢„æµ‹ï¼Œå½“æœ‰ä¸€ä¸ªæ–°çš„çŠ¶æ€ $S$ å’ŒåŠ¨ä½œ $A$åˆ°æ¥æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åŸºäºæ¨¡å‹é¢„æµ‹å¾—åˆ°æ–°çš„çŠ¶æ€å’ŒåŠ¨ä½œå¥–åŠ±ï¼Œä¸éœ€è¦å’Œç¯å¢ƒäº¤äº’ã€‚å½“ç„¶å¦‚æœæˆ‘ä»¬çš„æ¨¡å‹ä¸å¥½ï¼Œé‚£ä¹ˆåŸºäºæ¨¡å‹é¢„æµ‹çš„æ–°çŠ¶æ€å’ŒåŠ¨ä½œå¥–åŠ±å¯èƒ½é”™çš„ç¦»è°±ã€‚ ä»ä¸Šé¢çš„æè¿°æˆ‘ä»¬å¯ä»¥çœ‹å‡ºåŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ å’Œä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ çš„ä¸»è¦åŒºåˆ«ï¼šå³åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ˜¯ä»æ¨¡å‹ä¸­å­¦ä¹ ï¼Œè€Œä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ˜¯ä»å’Œç¯å¢ƒäº¤äº’çš„ç»å†å»å­¦ä¹ ã€‚ ä¸‹é¢è¿™å¼ å›¾æè¿°äº†åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ çš„æ€è·¯ï¼š Model-based RL 2. åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•è®­ç»ƒæµç¨‹ è¿™é‡Œæˆ‘ä»¬çœ‹çœ‹åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•è®­ç»ƒæµç¨‹ï¼Œå…¶æµç¨‹å’Œæˆ‘ä»¬ç›‘ç£å­¦ä¹ ç®—æ³•æ˜¯éå¸¸ç±»ä¼¼çš„ã€‚ å‡è®¾è®­ç»ƒæ•°æ®æ˜¯è‹¥å¹²ç»„è¿™æ ·çš„ç»å†ï¼š $$S_1,A_1,R_2,S_2,A_2,R_2,\\ldots,S_T$$ å¯¹äºæ¯ç»„ç»å†ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è½¬åŒ–ä¸º $Tâˆ’1$ ç»„è®­ç»ƒæ ·æœ¬ï¼Œå³ï¼š $$\\begin{gathered} S_1,A_1\\to S_2,S_1,A_1\\to R_2 \\\\ S_2,A_2\\to S_3,S_2,A_2\\to R_3 \\\\ â€¦â€¦ \\\\ S_{T-1},A_{T-1}\\rightarrow S_T,~S_{T_1},A_{T-1}\\rightarrow R_T \\end{gathered}$$ å³è¾¹çš„è®­ç»ƒæ ·æœ¬ä¸€èµ·ç»„æˆäº†ä¸€ä¸ªåˆ†ç±»æ¨¡å‹æˆ–å¯†åº¦ä¼°è®¡æ¨¡å‹ï¼Œè¾“å…¥çŠ¶æ€å’ŒåŠ¨ä½œï¼Œè¾“å‡ºä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚ å³è¾¹çš„è®­ç»ƒæ ·æœ¬ä¸€èµ·ç»„æˆäº†ä¸€ä¸ªå›å½’æ¨¡å‹è®­ç»ƒé›†ï¼Œè¾“å…¥çŠ¶æ€å’ŒåŠ¨ä½œï¼Œè¾“å‡ºåŠ¨ä½œå¥–åŠ±å€¼ã€‚ è‡³æ­¤æˆ‘ä»¬çš„å¼ºåŒ–å­¦ä¹ æ±‚è§£è¿‡ç¨‹å’Œä¼ ç»Ÿçš„ç›‘ç£å­¦ä¹ ç®—æ³•æ²¡æœ‰å¤ªå¤šåŒºåˆ«äº†ï¼Œå¯ä»¥ä½¿ç”¨ä¼ ç»Ÿçš„ç›‘ç£å­¦ä¹ ç®—æ³•æ¥æ±‚è§£è¿™ä¸¤ä¸ªæ¨¡å‹ã€‚ å½“ç„¶è¿˜å¯ä»¥æ›´ç®€å•ï¼Œå³é€šè¿‡å¯¹è®­ç»ƒæ ·æœ¬è¿›è¡ŒæŸ¥è¡¨æ³•è¿›è¡Œç»Ÿè®¡ï¼Œç›´æ¥å¾—åˆ° $P(S_{t+1}|S_t,A_t)$ çš„æ¦‚ç‡å’Œ $R(R_{t+1}|S_t,A_t)$ çš„å¹³å‡å€¼ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥é¢„æµ‹ã€‚æ¯”ä½¿ç”¨æ¨¡å‹æ›´ç®€å•ã€‚ æ­¤å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„æ–¹æ³•å¯ä»¥ç”¨æ¥å¾—åˆ° $P(S_{t+1}|S_t,A_t)$å’Œ $R(R_{t+1}|S_t,A_t)$ï¼Œè¿™ä¸ªæˆ‘ä»¬åé¢å†è®²ã€‚ è™½ç„¶åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ€è·¯å¾ˆæ¸…æ™°ï¼Œè€Œä¸”è¿˜æœ‰ä¸è¦å’Œç¯å¢ƒæŒç»­äº¤äº’ä¼˜åŒ–çš„ä¼˜ç‚¹ï¼Œä½†æ˜¯ç”¨äºå®é™…äº§å“è¿˜æ˜¯æœ‰å¾ˆå¤šå·®è·çš„ã€‚ä¸»è¦æ˜¯æˆ‘ä»¬çš„æ¨¡å‹ç»å¤§å¤šæ•°æ—¶å€™ä¸èƒ½å‡†ç¡®çš„æè¿°çœŸæ­£çš„ç¯å¢ƒçš„è½¬åŒ–æ¨¡å‹ï¼Œé‚£ä¹ˆä½¿ç”¨åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•å¾—åˆ°çš„è§£å¤§å¤šæ•°æ—¶å€™ä¹Ÿä¸æ˜¯å¾ˆå®ç”¨ã€‚é‚£ä¹ˆæ˜¯ä¸æ˜¯åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ å°±ä¸èƒ½ç”¨äº†å‘¢ï¼Ÿä¹Ÿä¸æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ å’Œä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ é›†åˆèµ·æ¥ï¼Œå–é•¿è¡¥çŸ­ï¼Œè¿™æ ·åšæœ€å¸¸è§çš„å°±æ˜¯Dynaç®—æ³•æ¡†æ¶ã€‚ 3. Dynaç®—æ³•æ¡†æ¶ Dynaç®—æ³•æ¡†æ¶å¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œè€Œæ˜¯ä¸€ç±»ç®—æ³•æ¡†æ¶çš„æ€»ç§°ã€‚Dynaå°†åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ å’Œä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ é›†åˆèµ·æ¥ï¼Œæ—¢ä»æ¨¡å‹ä¸­å­¦ä¹ ï¼Œä¹Ÿä»å’Œç¯å¢ƒäº¤äº’çš„ç»å†å»å­¦ä¹ ï¼Œä»è€Œæ›´æ–°ä»·å€¼å‡½æ•°å’Œï¼ˆæˆ–ï¼‰ç­–ç•¥å‡½æ•°ã€‚å¦‚æœç”¨å’Œç¬¬ä¸€èŠ‚ç±»ä¼¼çš„å›¾ï¼Œå¯ä»¥è¡¨ç¤ºå¦‚ä¸‹å›¾ï¼Œå’Œç¬¬ä¸€èŠ‚çš„å›¾ç›¸æ¯”ï¼Œå¤šäº†ä¸€ä¸ªâ€œDirect RLâ€œçš„ç®­å¤´ï¼Œè¿™æ­£æ˜¯ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ çš„æ€è·¯ã€‚ Dynaç®—æ³•ç¤ºæ„å›¾ Dynaç®—æ³•æ¡†æ¶å’Œä¸åŒçš„å…·ä½“çš„ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ä¸€èµ·ï¼Œå¯ä»¥å¾—åˆ°å…·ä½“çš„ä¸åŒç®—æ³•ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨åŸºäºä»·å€¼å‡½æ•°çš„Q-Learningï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—åˆ°äº†Dyna-Qç®—æ³•ã€‚æˆ‘ä»¬åŸºäºDyna-Qæ¥çœ‹çœ‹Dynaç®—æ³•æ¡†æ¶çš„ä¸€èˆ¬æµç¨‹. 4. Dyna-Qç®—æ³•æµç¨‹ è¿™é‡Œæˆ‘ä»¬ç»™å‡ºåŸºäºä»·å€¼å‡½æ•°çš„Dyna-Qç®—æ³•çš„æ¦‚è¦æµç¨‹ã€‚å‡è®¾æ¨¡å‹ä½¿ç”¨çš„æ˜¯æŸ¥è¡¨æ³•ã€‚ (1). åˆå§‹åŒ–ä»»æ„ä¸€ä¸ªçŠ¶æ€ $s$,å’Œä»»æ„ä¸€ä¸ªåŠ¨ä½œ $a$ å¯¹åº”çš„çŠ¶æ€ä»·å€¼ $Q(s,a)$, åˆå§‹åŒ–å¥–åŠ±æ¨¡å‹ $R(s,a)$å’ŒçŠ¶æ€æ¨¡å‹ $P(s,a)$ (2). for $i=1$ to æœ€å¤§è¿­ä»£æ¬¡æ•°Tï¼š (a) $S \\leftarrow \\text{current state}$ (b) $A \\leftarrow \\text{Ïµâˆ’greedy(S,Q)}$ (c) æ‰§è¡ŒåŠ¨ä½œ $A$,å¾—åˆ°æ–°çŠ¶æ€ $Sâ€™$ å’Œå¥–åŠ± $R$ (d) ä½¿ç”¨Q-Learningæ›´æ–°ä»·å€¼å‡½æ•°ï¼š$Q(S,A)=Q(S,A)+\\alpha[R+\\gamma\\max_aQ(S^{\\prime},a)-Q(S,A)]$ (e) ä½¿ç”¨ $S,A,S^{\\prime}$ æ›´æ–°çŠ¶æ€æ¨¡å‹ $P(s,a)$ï¼Œä½¿ç”¨ $S,A,R$ æ›´æ–°çŠ¶æ€æ¨¡å‹ $R(s,a)$ (f) $\\text{for} \\space \\space j=1 \\space \\space \\text{to} \\text{æœ€å¤§æ¬¡æ•°}n$ï¼š (i) éšæœºé€‰æ‹©ä¸€ä¸ªä¹‹å‰å‡ºç°è¿‡çš„çŠ¶æ€ $S$ , åœ¨çŠ¶æ€ $S$ ä¸Šå‡ºç°è¿‡çš„åŠ¨ä½œä¸­éšæœºé€‰æ‹©ä¸€ä¸ªåŠ¨ä½œ $A$ (ii) åŸºäºæ¨¡å‹ $P(S,A)$ å¾—åˆ° $Sâ€™$, åŸºäºæ¨¡å‹ $R(S,A)$ å¾—åˆ° $R$ (iii) ä½¿ç”¨Q-Learningæ›´æ–°ä»·å€¼å‡½æ•°: $Q(S,A)=Q(S,A)+\\alpha[R+\\gamma\\max_aQ(S^{\\prime},a)-Q(S,A)]$ ä»ä¸Šé¢çš„æµç¨‹å¯ä»¥çœ‹å‡ºï¼ŒDynaæ¡†æ¶åœ¨æ¯ä¸ªè¿­ä»£è½®ä¸­ï¼Œä¼šå…ˆå’Œç¯å¢ƒäº¤äº’ï¼Œå¹¶æ›´æ–°ä»·å€¼å‡½æ•°å’Œï¼ˆæˆ–ï¼‰ç­–ç•¥å‡½æ•°ï¼Œæ¥ç€è¿›è¡Œnæ¬¡æ¨¡å‹çš„é¢„æµ‹ï¼ŒåŒæ ·æ›´æ–°ä»·å€¼å‡½æ•°å’Œï¼ˆæˆ–ï¼‰ç­–ç•¥å‡½æ•°ã€‚è¿™æ ·åŒæ—¶åˆ©ç”¨ä¸Šäº†å’Œç¯å¢ƒäº¤äº’çš„ç»å†ä»¥åŠæ¨¡å‹çš„é¢„æµ‹ã€‚ 5. Dyna-2ç®—æ³•æ¡†æ¶ åœ¨Dynaç®—æ³•æ¡†æ¶çš„åŸºç¡€ä¸Šåæ¥åˆå‘å±•å‡ºäº†Dyna-2ç®—æ³•æ¡†æ¶ã€‚å’ŒDynaç›¸æ¯”ï¼ŒDyna-2å°†å’Œå’Œç¯å¢ƒäº¤äº’çš„ç»å†ä»¥åŠæ¨¡å‹çš„é¢„æµ‹è¿™ä¸¤éƒ¨åˆ†ä½¿ç”¨è¿›è¡Œäº†åˆ†ç¦»ã€‚è¿˜æ˜¯ä»¥Qå‡½æ•°ä¸ºä¾‹ï¼ŒDyna-2å°†è®°å¿†åˆ†ä¸ºæ°¸ä¹…æ€§è®°å¿†ï¼ˆpermanent memoryï¼‰å’Œç¬æ—¶è®°å¿†ï¼ˆtransient memoryï¼‰, å…¶ä¸­æ°¸ä¹…æ€§è®°å¿†åˆ©ç”¨å®é™…çš„ç»éªŒæ¥æ›´æ–°ï¼Œç¬æ—¶è®°å¿†åˆ©ç”¨æ¨¡å‹æ¨¡æ‹Ÿç»éªŒæ¥æ›´æ–°ã€‚ æ°¸ä¹…æ€§è®°å¿†çš„Qå‡½æ•°å®šä¹‰ä¸ºï¼š $$Q(S,A)=\\phi(S,A)^T\\theta $$ ç¬æ—¶è®°å¿†çš„Qå‡½æ•°å®šä¹‰ä¸ºï¼š $$Q^{\\prime}(S,A)=\\overline{\\phi}(S,A)^T\\overline{\\theta}$$ ç»„åˆèµ·æ¥åè®°å¿†çš„Qå‡½æ•°å®šä¹‰ä¸ºï¼š $$\\overline{Q}(S,A)=\\phi(S,A)^T\\theta+\\overline{\\phi}(S,A)^T\\overline{\\theta}$$ Dyna-2çš„åŸºæœ¬æ€æƒ³æ˜¯åœ¨é€‰æ‹©å®é™…çš„æ‰§è¡ŒåŠ¨ä½œå‰ï¼Œæ™ºèƒ½ä½“å…ˆæ‰§è¡Œä¸€éä»å½“å‰çŠ¶æ€å¼€å§‹çš„åŸºäºæ¨¡å‹çš„æ¨¡æ‹Ÿï¼Œè¯¥æ¨¡æ‹Ÿå°†ä»¿çœŸå®Œæ•´çš„è½¨è¿¹ï¼Œä»¥ä¾¿è¯„ä¼°å½“å‰çš„åŠ¨ä½œå€¼å‡½æ•°ã€‚æ™ºèƒ½ä½“ä¼šæ ¹æ®æ¨¡æ‹Ÿå¾—åˆ°çš„åŠ¨ä½œå€¼å‡½æ•°åŠ ä¸Šå®é™…ç»éªŒå¾—åˆ°çš„å€¼å‡½æ•°å…±åŒé€‰æ‹©å®é™…è¦æ‰§è¡Œçš„åŠ¨ä½œã€‚ä»·å€¼å‡½æ•°çš„æ›´æ–°æ–¹å¼ç±»ä¼¼äº $SARSA(Î»)$ ä»¥ä¸‹æ˜¯Dyna-2çš„ç®—æ³•æµç¨‹ï¼š Dyna-2 ç®—æ³•æµç¨‹ 6. åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ€»ç»“ åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ä¸€èˆ¬ä¸å•ç‹¬ä½¿ç”¨ï¼Œè€Œæ˜¯å’Œä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ç»“åˆèµ·æ¥ï¼Œå› æ­¤ä½¿ç”¨Dynaç®—æ³•æ¡†æ¶æ˜¯å¸¸ç”¨çš„åšæ³•ã€‚å¯¹äºæ¨¡å‹éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æŸ¥è¡¨æ³•å’Œç›‘ç£å­¦ä¹ æ³•ç­‰æ–¹æ³•ï¼Œé¢„æµ‹æˆ–è€…é‡‡æ ·å¾—åˆ°æ¨¡æ‹Ÿçš„ç»å†ã€‚è€Œå¯¹äºéæ¨¡å‹éƒ¨åˆ†ï¼Œä½¿ç”¨å‰é¢çš„Q-Learningç³»åˆ—çš„ä»·å€¼å‡½æ•°è¿‘ä¼¼ï¼Œæˆ–è€…åŸºäºActor-Criticçš„ç­–ç•¥å‡½æ•°çš„è¿‘ä¼¼éƒ½æ˜¯å¯ä»¥çš„ã€‚ é™¤äº†Dynaç®—æ³•æ¡†æ¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨åŸºäºæ¨¡æ‹Ÿçš„æœç´¢(simulation-based search)æ¥ç»“åˆåŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ å’Œä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ,å¹¶æ±‚è§£é—®é¢˜ã€‚è¿™éƒ¨åˆ†æˆ‘ä»¬åœ¨åé¢å†è®¨è®ºã€‚ ","date":"2024-02-25","objectID":"/posts/rl_learning_note_17/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [17] | åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ ä¸Dynaç®—æ³•æ¡†æ¶","uri":"/posts/rl_learning_note_17/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ (åäº”) A3Cä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ä½¿ç”¨å¤šçº¿ç¨‹çš„æ–¹æ³•æ¥è§£å†³Actor-Criticéš¾æ”¶æ•›çš„é—®é¢˜ï¼Œä»Šå¤©æˆ‘ä»¬ä¸ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œè€Œæ˜¯ä½¿ç”¨å’ŒDDQNç±»ä¼¼çš„æ–¹æ³•ï¼šå³ç»éªŒå›æ”¾å’ŒåŒç½‘ç»œçš„æ–¹æ³•æ¥æ”¹è¿›Actor-Criticéš¾æ”¶æ•›çš„é—®é¢˜ï¼Œè¿™ä¸ªç®—æ³•å°±æ˜¯æ˜¯æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦(Deep Deterministic Policy Gradientï¼Œä»¥ä¸‹ç®€ç§°DDPG)ã€‚ æœ¬ç¯‡ä¸»è¦å‚è€ƒäº†DDPGçš„è®ºæ–‡å’ŒICML 2016çš„deep RL tutorialã€‚ 1. ä»éšæœºç­–ç•¥åˆ°ç¡®å®šæ€§ç­–ç•¥ ä»DDPGè¿™ä¸ªåå­—çœ‹ï¼Œå®ƒæ˜¯ç”±Dï¼ˆDeepï¼‰+Dï¼ˆDeterministic ï¼‰+ PG(Policy Gradient)ç»„æˆã€‚PG(Policy Gradient)æˆ‘ä»¬åœ¨å¼ºåŒ–å­¦ä¹ (åä¸‰) ç­–ç•¥æ¢¯åº¦(Policy Gradient)é‡Œå·²ç»è®¨è®ºè¿‡ã€‚é‚£ä»€ä¹ˆæ˜¯ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦(Deterministic Policy Gradientï¼Œä»¥ä¸‹ç®€ç§°DPG)å‘¢ï¼Ÿ ç¡®å®šæ€§ç­–ç•¥æ˜¯å’Œéšæœºç­–ç•¥ç›¸å¯¹è€Œè¨€çš„ï¼Œå¯¹äºæŸä¸€äº›åŠ¨ä½œé›†åˆæ¥è¯´ï¼Œå®ƒå¯èƒ½æ˜¯è¿ç»­å€¼ï¼Œæˆ–è€…éå¸¸é«˜ç»´çš„ç¦»æ•£å€¼ï¼Œè¿™æ ·åŠ¨ä½œçš„ç©ºé—´ç»´åº¦æå¤§ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨éšæœºç­–ç•¥ï¼Œå³åƒDQNä¸€æ ·ç ”ç©¶å®ƒæ‰€æœ‰çš„å¯èƒ½åŠ¨ä½œçš„æ¦‚ç‡ï¼Œå¹¶è®¡ç®—å„ä¸ªå¯èƒ½çš„åŠ¨ä½œçš„ä»·å€¼çš„è¯ï¼Œé‚£éœ€è¦çš„æ ·æœ¬é‡æ˜¯éå¸¸å¤§æ‰å¯è¡Œçš„ã€‚äºæ˜¯æœ‰äººå°±æƒ³å‡ºä½¿ç”¨ç¡®å®šæ€§ç­–ç•¥æ¥ç®€åŒ–è¿™ä¸ªé—®é¢˜ã€‚ ä½œä¸ºéšæœºç­–ç•¥ï¼Œåœ¨ç›¸åŒçš„ç­–ç•¥ï¼Œåœ¨åŒä¸€ä¸ªçŠ¶æ€å¤„ï¼Œé‡‡ç”¨çš„åŠ¨ä½œæ˜¯åŸºäºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„ï¼Œå³æ˜¯ä¸ç¡®å®šçš„ã€‚è€Œç¡®å®šæ€§ç­–ç•¥åˆ™å†³å®šç®€å•ç‚¹ï¼Œè™½ç„¶åœ¨åŒä¸€ä¸ªçŠ¶æ€å¤„ï¼Œé‡‡ç”¨çš„åŠ¨ä½œæ¦‚ç‡ä¸åŒï¼Œä½†æ˜¯æœ€å¤§æ¦‚ç‡åªæœ‰ä¸€ä¸ªï¼Œå¦‚æœæˆ‘ä»¬åªå–æœ€å¤§æ¦‚ç‡çš„åŠ¨ä½œï¼Œå»æ‰è¿™ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œé‚£ä¹ˆå°±ç®€å•å¤šäº†ã€‚å³ä½œä¸ºç¡®å®šæ€§ç­–ç•¥ï¼Œç›¸åŒçš„ç­–ç•¥ï¼Œåœ¨åŒä¸€ä¸ªçŠ¶æ€å¤„ï¼ŒåŠ¨ä½œæ˜¯å”¯ä¸€ç¡®å®šçš„ï¼Œå³ç­–ç•¥å˜æˆï¼š $$\\pi_\\theta(s)=a$$ 2. ä»DPGåˆ°DDPG åœ¨çœ‹ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦DPGå‰ï¼Œæˆ‘ä»¬çœ‹çœ‹åŸºäºQå€¼çš„éšæœºæ€§ç­–ç•¥æ¢¯åº¦çš„æ¢¯åº¦è®¡ç®—å…¬å¼ï¼š $$\\nabla_\\theta J(\\pi_\\theta)=E_{s\\sim\\rho^\\pi,a\\sim\\pi_\\theta}[\\nabla_\\theta log\\pi_\\theta(s,a)Q_\\pi(s,a)]$$ å…¶ä¸­çŠ¶æ€çš„é‡‡æ ·ç©ºé—´ä¸º$\\rho^\\pi$, $\\nabla_\\theta log\\pi_\\theta(s,a)$æ˜¯åˆ†å€¼å‡½æ•°ï¼Œå¯è§éšæœºæ€§ç­–ç•¥æ¢¯åº¦éœ€è¦åœ¨æ•´ä¸ªåŠ¨ä½œçš„ç©ºé—´$\\pi_\\mathrm{\\theta}$è¿›è¡Œé‡‡æ ·ã€‚ è€ŒDPGåŸºäºQå€¼çš„ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦çš„æ¢¯åº¦è®¡ç®—å…¬å¼æ˜¯ï¼š $$\\nabla_\\theta J(\\pi_\\theta)=E_{s\\sim\\rho^\\pi}[\\nabla_\\theta\\pi_\\theta(s)\\nabla_aQ_\\pi(s,a)|{a=\\pi\\theta(s)}]$$ è·Ÿéšæœºç­–ç•¥æ¢¯åº¦çš„å¼å­ç›¸æ¯”ï¼Œå°‘äº†å¯¹åŠ¨ä½œçš„ç§¯åˆ†ï¼Œå¤šäº†å›æŠ¥Qå‡½æ•°å¯¹åŠ¨ä½œçš„å¯¼æ•°ã€‚ è€Œä»DPGåˆ°DDPGçš„è¿‡ç¨‹ï¼Œå®Œå…¨å¯ä»¥ç±»æ¯”DQNåˆ°DDQNçš„è¿‡ç¨‹ã€‚é™¤äº†è€ç”Ÿå¸¸è°ˆçš„ç»éªŒå›æ”¾ä»¥å¤–ï¼Œæˆ‘ä»¬æœ‰äº†åŒç½‘ç»œï¼Œå³å½“å‰ç½‘ç»œå’Œç›®æ ‡ç½‘ç»œçš„æ¦‚å¿µã€‚è€Œç”±äºç°åœ¨æˆ‘ä»¬æœ¬æ¥å°±æœ‰Actorç½‘ç»œå’ŒCriticä¸¤ä¸ªç½‘ç»œï¼Œé‚£ä¹ˆåŒç½‘ç»œåå°±å˜æˆäº†4ä¸ªç½‘ç»œï¼Œåˆ†åˆ«æ˜¯ï¼šActorå½“å‰ç½‘ç»œï¼ŒActorç›®æ ‡ç½‘ç»œï¼ŒCriticå½“å‰ç½‘ç»œï¼ŒCriticç›®æ ‡ç½‘ç»œã€‚2ä¸ªActorç½‘ç»œçš„ç»“æ„ç›¸åŒï¼Œ2ä¸ªCriticç½‘ç»œçš„ç»“æ„ç›¸åŒã€‚é‚£ä¹ˆè¿™4ä¸ªç½‘ç»œçš„åŠŸèƒ½å„è‡ªæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ 3. DDPGçš„åŸç† DDPGæœ‰4ä¸ªç½‘ç»œï¼Œåœ¨äº†è§£è¿™4ä¸ªç½‘ç»œçš„åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¤ä¹ DDQNçš„ä¸¤ä¸ªç½‘ç»œï¼šå½“å‰Qç½‘ç»œå’Œç›®æ ‡Qç½‘ç»œçš„ä½œç”¨ã€‚å¯ä»¥å¤ä¹ å¼ºåŒ–å­¦ä¹ ï¼ˆåï¼‰Double DQN (DDQN)ã€‚ DDQNçš„å½“å‰Qç½‘ç»œè´Ÿè´£å¯¹å½“å‰çŠ¶æ€ $S$ ä½¿ç”¨ $Ïµ$âˆ’è´ªå©ªæ³•é€‰æ‹©åŠ¨ä½œ $A$ï¼Œæ‰§è¡ŒåŠ¨ä½œ $A$,è·å¾—æ–°çŠ¶æ€ $Sâ€™$å’Œå¥–åŠ±$R$,å°†æ ·æœ¬æ”¾å…¥ç»éªŒå›æ”¾æ± ï¼Œå¯¹ç»éªŒå›æ”¾æ± ä¸­é‡‡æ ·çš„ä¸‹ä¸€çŠ¶æ€ $Sâ€™$ä½¿ç”¨è´ªå©ªæ³•é€‰æ‹©åŠ¨ä½œ $Aâ€™$ï¼Œä¾›ç›®æ ‡Qç½‘ç»œè®¡ç®—ç›®æ ‡Qå€¼ï¼Œå½“ç›®æ ‡Qç½‘ç»œè®¡ç®—å‡ºç›®æ ‡Qå€¼åï¼Œå½“å‰Qç½‘ç»œä¼šè¿›è¡Œç½‘ç»œå‚æ•°çš„æ›´æ–°ï¼Œå¹¶å®šæœŸæŠŠæœ€æ–°ç½‘ç»œå‚æ•°å¤åˆ¶åˆ°ç›®æ ‡Qç½‘ç»œã€‚ DDQNçš„ç›®æ ‡Qç½‘ç»œåˆ™è´Ÿè´£åŸºäºç»éªŒå›æ”¾æ± è®¡ç®—ç›®æ ‡Qå€¼, æä¾›ç»™å½“å‰Qç½‘ç»œç”¨ï¼Œç›®æ ‡Qç½‘ç»œä¼šå®šæœŸä»å½“å‰Qç½‘ç»œå¤åˆ¶æœ€æ–°ç½‘ç»œå‚æ•°ã€‚ ç°åœ¨æˆ‘ä»¬å›åˆ°DDPGï¼Œä½œä¸ºDDPGï¼ŒCriticå½“å‰ç½‘ç»œï¼ŒCriticç›®æ ‡ç½‘ç»œå’ŒDDQNçš„å½“å‰Qç½‘ç»œï¼Œç›®æ ‡Qç½‘ç»œçš„åŠŸèƒ½å®šä½åŸºæœ¬ç±»ä¼¼ï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰è‡ªå·±çš„Actorç­–ç•¥ç½‘ç»œï¼Œå› æ­¤ä¸éœ€è¦ $Ïµ$âˆ’è´ªå©ªæ³•è¿™æ ·çš„é€‰æ‹©æ–¹æ³•ï¼Œè¿™éƒ¨åˆ†DDQNçš„åŠŸèƒ½åˆ°äº†DDPGå¯ä»¥åœ¨Actorå½“å‰ç½‘ç»œå®Œæˆã€‚è€Œå¯¹ç»éªŒå›æ”¾æ± ä¸­é‡‡æ ·çš„ä¸‹ä¸€çŠ¶æ€ $Sâ€™$ ä½¿ç”¨è´ªå©ªæ³•é€‰æ‹©åŠ¨ä½œ $Aâ€™$ï¼Œè¿™éƒ¨åˆ†å·¥ä½œç”±äºç”¨æ¥ä¼°è®¡ç›®æ ‡Qå€¼ï¼Œå› æ­¤å¯ä»¥æ”¾åˆ°Actorç›®æ ‡ç½‘ç»œå®Œæˆã€‚ åŸºäºç»éªŒå›æ”¾æ± å’Œç›®æ ‡Actorç½‘ç»œæä¾›çš„ $Sâ€™$, $Aâ€™$ è®¡ç®—ç›®æ ‡Qå€¼çš„ä¸€éƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†ç”±äºæ˜¯è¯„ä¼°ï¼Œå› æ­¤è¿˜æ˜¯æ”¾åˆ°Criticç›®æ ‡ç½‘ç»œå®Œæˆã€‚è€ŒCriticç›®æ ‡ç½‘ç»œè®¡ç®—å‡ºç›®æ ‡Qå€¼ä¸€éƒ¨åˆ†åï¼ŒCriticå½“å‰ç½‘ç»œä¼šè®¡ç®—ç›®æ ‡Qå€¼ï¼Œå¹¶è¿›è¡Œç½‘ç»œå‚æ•°çš„æ›´æ–°ï¼Œå¹¶å®šæœŸå°†ç½‘ç»œå‚æ•°å¤åˆ¶åˆ°Criticç›®æ ‡ç½‘ç»œã€‚ æ­¤å¤–ï¼ŒActorå½“å‰ç½‘ç»œä¹Ÿä¼šåŸºäºCriticå½“å‰ç½‘ç»œè®¡ç®—å‡ºçš„ç›®æ ‡Qå€¼ï¼Œè¿›è¡Œç½‘ç»œå‚æ•°çš„æ›´æ–°ï¼Œå¹¶å®šæœŸå°†ç½‘ç»œå‚æ•°å¤åˆ¶åˆ°Actorç›®æ ‡ç½‘ç»œã€‚ æœ‰äº†ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬æ€»ç»“ä¸‹DDPG 4ä¸ªç½‘ç»œçš„åŠŸèƒ½å®šä½ï¼š (1). Actorå½“å‰ç½‘ç»œ: è´Ÿè´£ç­–ç•¥ç½‘ç»œå‚æ•° $Î¸$çš„è¿­ä»£æ›´æ–°ï¼Œè´Ÿè´£æ ¹æ®å½“å‰çŠ¶æ€ $S$é€‰æ‹©å½“å‰åŠ¨ä½œ $A$ï¼Œç”¨äºå’Œç¯å¢ƒäº¤äº’ç”Ÿæˆ $Sâ€™$, $R$ã€‚ (2). Actorç›®æ ‡ç½‘ç»œ: è´Ÿè´£æ ¹æ®ç»éªŒå›æ”¾æ± ä¸­é‡‡æ ·çš„ä¸‹ä¸€çŠ¶æ€ $Sâ€™$ é€‰æ‹©æœ€ä¼˜ä¸‹ä¸€åŠ¨ä½œ$Aâ€™$ã€‚ç½‘ç»œå‚æ•° $Î¸â€™$å®šæœŸä» $Î¸$å¤åˆ¶ã€‚ (3). Criticå½“å‰ç½‘ç»œ: è´Ÿè´£ä»·å€¼ç½‘ç»œå‚æ•° $w$çš„è¿­ä»£æ›´æ–°ï¼Œè´Ÿè´£è®¡ç®—è´Ÿè´£è®¡ç®—å½“å‰Qå€¼ $Q(S,A,w)$ã€‚ç›®æ ‡Qå€¼$y_i=R+Î³Qâ€™(Sâ€™,Aâ€™,wâ€™)$ (4). Criticç›®æ ‡ç½‘ç»œ: è´Ÿè´£è®¡ç®—ç›®æ ‡Qå€¼ä¸­çš„ $Qâ€™(Sâ€™,Aâ€™,wâ€™)$éƒ¨åˆ†ã€‚ç½‘ç»œå‚æ•° $wâ€™$ å®šæœŸä» $w$å¤åˆ¶ã€‚ DDPGé™¤äº†è¿™4ä¸ªç½‘ç»œç»“æ„ï¼Œè¿˜ç”¨åˆ°äº†ç»éªŒå›æ”¾ï¼Œè¿™éƒ¨åˆ†ç”¨äºè®¡ç®—ç›®æ ‡Qå€¼ï¼Œå’ŒDQNæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚ æ­¤å¤–ï¼ŒDDPGä»å½“å‰ç½‘ç»œåˆ°ç›®æ ‡ç½‘ç»œçš„å¤åˆ¶å’Œæˆ‘ä»¬ä¹‹å‰è®²åˆ°äº†DQNä¸ä¸€æ ·ã€‚å›æƒ³DQNï¼Œæˆ‘ä»¬æ˜¯ç›´æ¥æŠŠå°†å½“å‰Qç½‘ç»œçš„å‚æ•°å¤åˆ¶åˆ°ç›®æ ‡Qç½‘ç»œï¼Œå³$w$â€²=$w$, DDPGè¿™é‡Œæ²¡æœ‰ä½¿ç”¨è¿™ç§ç¡¬æ›´æ–°ï¼Œè€Œæ˜¯ä½¿ç”¨äº†è½¯æ›´æ–°ï¼Œå³æ¯æ¬¡å‚æ•°åªæ›´æ–°ä¸€ç‚¹ç‚¹ï¼Œå³ï¼š $$\\begin{gathered} wâ€™\\leftarrow\\tau w+(1-\\tau)wâ€™ \\ \\thetaâ€™\\leftarrow\\tau\\theta+(1-\\tau)\\theta' \\end{gathered}$$ å…¶ä¸­ $Ï„$æ˜¯æ›´æ–°ç³»æ•°ï¼Œä¸€èˆ¬å–çš„æ¯”è¾ƒå°ï¼Œæ¯”å¦‚0.1æˆ–è€…0.01è¿™æ ·çš„å€¼ã€‚ åŒæ—¶ï¼Œä¸ºäº†å­¦ä¹ è¿‡ç¨‹å¯ä»¥å¢åŠ ä¸€äº›éšæœºæ€§ï¼Œå¢åŠ å­¦ä¹ çš„è¦†ç›–ï¼ŒDDPGå¯¹é€‰æ‹©å‡ºæ¥çš„åŠ¨ä½œ $A$ä¼šå¢åŠ ä¸€å®šçš„å™ªå£° $N$, å³æœ€ç»ˆå’Œç¯å¢ƒäº¤äº’çš„åŠ¨ä½œ $A$ çš„è¡¨è¾¾å¼æ˜¯ï¼š $$A=\\pi_\\theta(S)+\\mathcal{N}$$ æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹DDPGçš„æŸå¤±å‡½æ•°ã€‚å¯¹äºCriticå½“å‰ç½‘ç»œï¼Œå…¶æŸå¤±å‡½æ•°å’ŒDQNæ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯å‡æ–¹è¯¯å·®ï¼Œå³ï¼š $$J(w)=\\frac1m\\sum_{j=1}^m(y_j-Q(\\phi(S_j),A_j,w))^2$$ è€Œå¯¹äº Actorå½“å‰ç½‘ç»œï¼Œå…¶æŸå¤±å‡½æ•°å°±å’Œä¹‹å‰è®²çš„PGï¼ŒA3Cä¸åŒäº†ï¼Œè¿™é‡Œç”±äºæ˜¯ç¡®å®šæ€§ç­–ç•¥ï¼ŒåŸè®ºæ–‡å®šä¹‰çš„æŸå¤±æ¢¯åº¦æ˜¯ï¼š $$\\nabla_J(\\theta)=\\frac1m\\sum_{j=1}^m[\\nabla_aQ_(s_i,a_i,w)|{s=s_i,a=\\pi\\theta(s)}\\nabla_\\theta\\pi_{\\theta(s)}|_{s=s_i}]$$ è¿™ä¸ªå¯ä»¥å¯¹åº”ä¸Šæˆ‘ä»¬ç¬¬äºŒèŠ‚çš„ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ï¼Œçœ‹èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œä½†æ˜¯å…¶å®ç†è§£èµ·æ¥å¾ˆç®€å•ã€‚å‡å¦‚å¯¹åŒä¸€ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬è¾“å‡ºäº†ä¸¤ä¸ªä¸åŒçš„åŠ¨ä½œ $a_1$å’Œ$a_2$ï¼Œä»Criticå½“å‰ç½‘ç»œå¾—åˆ°äº†ä¸¤ä¸ªåé¦ˆçš„ $Q$ å€¼ï¼Œåˆ†åˆ«æ˜¯ $Q_1$,$Q_2$ï¼Œå‡è®¾ $Q_1\u003eQ_2$,å³é‡‡å–åŠ¨ä½œ1å¯ä»¥å¾—åˆ°æ›´å¤šçš„å¥–åŠ±ï¼Œé‚£ä¹ˆç­–ç•¥æ¢¯åº¦çš„æ€æƒ³æ˜¯ä»€ä¹ˆå‘¢ï¼Œå°±æ˜¯å¢åŠ  $a_1$çš„æ¦‚ç‡ï¼Œé™ä½$a_2$çš„æ¦‚ç‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒActoræƒ³è¦å°½å¯èƒ½çš„å¾—åˆ°æ›´å¤§çš„Qå€¼ã€‚æ‰€ä»¥æˆ‘ä»¬çš„Actorçš„æŸå¤±å¯ä»¥ç®€å•çš„ç†è§£ä¸ºå¾—åˆ°çš„åé¦ˆQå€¼è¶Šå¤§æŸå¤±è¶Šå°ï¼Œå¾—åˆ°çš„åé¦ˆQå€¼è¶Šå°æŸå¤±è¶Šå¤§ï¼Œå› æ­¤åªè¦å¯¹çŠ¶æ€ä¼°è®¡ç½‘ç»œè¿”å›çš„Qå€¼å–ä¸ªè´Ÿå·å³å¯ï¼Œå³ï¼š $$J(\\theta)=-\\frac1m\\sum_{j=1}^mQ_(s_i,a_i,w)$$ 4. DDPGç®—æ³•æµç¨‹ è¿™é‡Œæˆ‘ä»¬æ€»ç»“ä¸‹DDPGçš„ç®—æ³•æµç¨‹ è¾“å…¥ï¼šActorå½“å‰ç½‘ç»œï¼ŒActorç›®æ ‡ç½‘ç»œï¼ŒCriticå½“å‰ç½‘ç»œï¼ŒCriticç›®æ ‡ç½‘ç»œ,å‚æ•°åˆ†åˆ«ä¸º $Î¸$,$Î¸â€™$,$w$,$wâ€™$,è¡°å‡å› å­ $Î³$, è½¯æ›´æ–°ç³»æ•° $Ï„$, æ‰¹é‡æ¢¯åº¦ä¸‹é™çš„æ ·æœ¬æ•° $m$,ç›®æ ‡Qç½‘ç»œå‚æ•°æ›´æ–°é¢‘ç‡ $C$ã€‚æœ€å¤§è¿­ä»£æ¬¡æ•° $T$ã€‚éšæœºå™ªéŸ³å‡½æ•° $\\mathcal{N}$ è¾“å‡ºï¼šæœ€ä¼˜Actorå½“å‰ç½‘ç»œå‚æ•° $Î¸$,Criticå½“å‰ç½‘ç»œå‚æ•° $w$ (1). éšæœºåˆå§‹åŒ–$Î¸$,$w$, $w$â€²=$w$,$Î¸$â€²=$Î¸$ã€‚æ¸…ç©ºç»éªŒå›æ”¾çš„é›†åˆ$D$ (2). for i from 1 to Tï¼Œè¿›è¡Œè¿­ä»£ã€‚ a) åˆå§‹åŒ– $S$ä¸ºå½“å‰çŠ¶æ€åºåˆ—çš„ç¬¬ä¸€ä¸ªçŠ¶æ€, æ‹¿åˆ°å…¶ç‰¹å¾å‘é‡ $Ï•(S)$ b) åœ¨Actorå½“å‰ç½‘ç»œåŸºäºçŠ¶æ€ $S$ å¾—åˆ°åŠ¨ä½œ $A=Ï€_Î¸(Ï•(S))+\\mathcal{N}$ c) æ‰§è¡ŒåŠ¨ä½œ$A$,å¾—åˆ°æ–°çŠ¶æ€$S$â€²,å¥–åŠ±$R$,æ˜¯å¦ç»ˆæ­¢çŠ¶æ€%is_end$ d) å°† ${Ï•(S), A, R, Ï•(Sâ€™), is_end}$","date":"2024-02-25","objectID":"/posts/rl_learning_note_16/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [16] | æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦(DDPG)","uri":"/posts/rl_learning_note_16/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ (åå››) Actor-Criticä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†Actor-Criticçš„ç®—æ³•æµç¨‹ï¼Œä½†æ˜¯ç”±äºæ™®é€šçš„Actor-Criticç®—æ³•éš¾ä»¥æ”¶æ•›ï¼Œéœ€è¦ä¸€äº›å…¶ä»–çš„ä¼˜åŒ–ã€‚è€ŒAsynchronous Advantage Actor-critic(ä»¥ä¸‹ç®€ç§°A3C)å°±æ˜¯å…¶ä¸­æ¯”è¾ƒå¥½çš„ä¼˜åŒ–ç®—æ³•ã€‚æœ¬æ–‡æˆ‘ä»¬è®¨è®ºA3Cçš„ç®—æ³•åŸç†å’Œç®—æ³•æµç¨‹ã€‚ æœ¬æ–‡ä¸»è¦å‚è€ƒäº†A3Cçš„è®ºæ–‡ï¼Œä»¥åŠICML 2016çš„deep RL tutorialã€‚ 1. A3Cçš„å¼•å…¥ ä¸Šä¸€ç¯‡Actor-Criticç®—æ³•çš„ä»£ç ï¼Œå…¶å®å¾ˆéš¾æ”¶æ•›ï¼Œæ— è®ºæ€ä¹ˆè°ƒå‚ï¼Œæœ€åçš„CartPoleéƒ½å¾ˆéš¾ç¨³å®šåœ¨200åˆ†ï¼Œè¿™æ˜¯Actor-Criticç®—æ³•çš„é—®é¢˜ã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯æœ‰åŠæ³•å»æœ‰ä¼˜åŒ–è¿™ä¸ªéš¾ä»¥æ”¶æ•›çš„é—®é¢˜çš„ã€‚ å›å¿†ä¸‹ä¹‹å‰çš„DQNç®—æ³•ï¼Œä¸ºäº†æ–¹ä¾¿æ”¶æ•›ä½¿ç”¨äº†ç»éªŒå›æ”¾çš„æŠ€å·§ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„Actor-Criticæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ä½¿ç”¨ç»éªŒå›æ”¾çš„æŠ€å·§å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ï¼ä¸è¿‡A3Cæ›´è¿›ä¸€æ­¥ï¼Œè¿˜å…‹æœäº†ä¸€äº›ç»éªŒå›æ”¾çš„é—®é¢˜ã€‚ç»éªŒå›æ”¾æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ å›æ”¾æ± ç»éªŒæ•°æ®ç›¸å…³æ€§å¤ªå¼ºï¼Œç”¨äºè®­ç»ƒçš„æ—¶å€™æ•ˆæœå¾ˆå¯èƒ½ä¸ä½³ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å­¦ä¹ ä¸‹æ£‹ï¼Œæ€»æ˜¯å’ŒåŒä¸€ä¸ªäººä¸‹ï¼ŒæœŸæœ›èƒ½æé«˜æ£‹è‰ºã€‚è¿™å½“ç„¶æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯åˆ°ä¸€å®šç¨‹åº¦å°±å†éš¾æé«˜äº†ï¼Œæ­¤æ—¶æœ€å¥½çš„æ–¹æ³•æ˜¯å¦å¯»é«˜æ‰‹åˆ‡ç£‹ã€‚ A3Cçš„æ€è·¯ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå®ƒåˆ©ç”¨å¤šçº¿ç¨‹çš„æ–¹æ³•ï¼ŒåŒæ—¶åœ¨å¤šä¸ªçº¿ç¨‹é‡Œé¢åˆ†åˆ«å’Œç¯å¢ƒè¿›è¡Œäº¤äº’å­¦ä¹ ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æŠŠå­¦ä¹ çš„æˆæœæ±‡æ€»èµ·æ¥ï¼Œæ•´ç†ä¿å­˜åœ¨ä¸€ä¸ªå…¬å…±çš„åœ°æ–¹ã€‚å¹¶ä¸”ï¼Œå®šæœŸä»å…¬å…±çš„åœ°æ–¹æŠŠå¤§å®¶çš„é½å¿ƒå­¦ä¹ çš„æˆæœæ‹¿å›æ¥ï¼ŒæŒ‡å¯¼è‡ªå·±å’Œç¯å¢ƒåé¢çš„å­¦ä¹ äº¤äº’ã€‚ é€šè¿‡è¿™ç§æ–¹æ³•ï¼ŒA3Cé¿å…äº†ç»éªŒå›æ”¾ç›¸å…³æ€§è¿‡å¼ºçš„é—®é¢˜ï¼ŒåŒæ—¶åšåˆ°äº†å¼‚æ­¥å¹¶å‘çš„å­¦ä¹ æ¨¡å‹ã€‚ 2. A3Cçš„ç®—æ³•ä¼˜åŒ– ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ç›¸æ¯”Actor-Criticï¼ŒA3Cåˆ°åº•åšäº†å“ªäº›å…·ä½“çš„ä¼˜åŒ–ã€‚ ç›¸æ¯”Actor-Criticï¼ŒA3Cçš„ä¼˜åŒ–ä¸»è¦æœ‰3ç‚¹ï¼Œåˆ†åˆ«æ˜¯å¼‚æ­¥è®­ç»ƒæ¡†æ¶ï¼Œç½‘ç»œç»“æ„ä¼˜åŒ–ï¼ŒCriticè¯„ä¼°ç‚¹çš„ä¼˜åŒ–ã€‚å…¶ä¸­å¼‚æ­¥è®­ç»ƒæ¡†æ¶æ˜¯æœ€å¤§çš„ä¼˜åŒ–ã€‚ æˆ‘ä»¬é¦–å…ˆæ¥çœ‹è¿™ä¸ªå¼‚æ­¥è®­ç»ƒæ¡†æ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¼‚æ­¥è®­ç»ƒæ¡†æ¶ å›¾ä¸­ä¸Šé¢çš„Global Networkå°±æ˜¯ä¸Šä¸€èŠ‚è¯´çš„å…±äº«çš„å…¬å…±éƒ¨åˆ†ï¼Œä¸»è¦æ˜¯ä¸€ä¸ªå…¬å…±çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œè¿™ä¸ªç¥ç»ç½‘ç»œåŒ…æ‹¬Actorç½‘ç»œå’ŒCriticç½‘ç»œä¸¤éƒ¨åˆ†çš„åŠŸèƒ½ã€‚ä¸‹é¢æœ‰nä¸ªworkerçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹é‡Œæœ‰å’Œå…¬å…±çš„ç¥ç»ç½‘ç»œä¸€æ ·çš„ç½‘ç»œç»“æ„ï¼Œæ¯ä¸ªçº¿ç¨‹ä¼šç‹¬ç«‹çš„å’Œç¯å¢ƒè¿›è¡Œäº¤äº’å¾—åˆ°ç»éªŒæ•°æ®ï¼Œè¿™äº›çº¿ç¨‹ä¹‹é—´äº’ä¸å¹²æ‰°ï¼Œç‹¬ç«‹è¿è¡Œã€‚ æ¯ä¸ªçº¿ç¨‹å’Œç¯å¢ƒäº¤äº’åˆ°ä¸€å®šé‡çš„æ•°æ®åï¼Œå°±è®¡ç®—åœ¨è‡ªå·±çº¿ç¨‹é‡Œçš„ç¥ç»ç½‘ç»œæŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œä½†æ˜¯è¿™äº›æ¢¯åº¦å´å¹¶ä¸æ›´æ–°è‡ªå·±çº¿ç¨‹é‡Œçš„ç¥ç»ç½‘ç»œï¼Œè€Œæ˜¯å»æ›´æ–°å…¬å…±çš„ç¥ç»ç½‘ç»œã€‚ä¹Ÿå°±æ˜¯nä¸ªçº¿ç¨‹ä¼šç‹¬ç«‹çš„ä½¿ç”¨ç´¯ç§¯çš„æ¢¯åº¦åˆ†åˆ«æ›´æ–°å…¬å…±éƒ¨åˆ†çš„ç¥ç»ç½‘ç»œæ¨¡å‹å‚æ•°ã€‚æ¯éš”ä¸€æ®µæ—¶é—´ï¼Œçº¿ç¨‹ä¼šå°†è‡ªå·±çš„ç¥ç»ç½‘ç»œçš„å‚æ•°æ›´æ–°ä¸ºå…¬å…±ç¥ç»ç½‘ç»œçš„å‚æ•°ï¼Œè¿›è€ŒæŒ‡å¯¼åé¢çš„ç¯å¢ƒäº¤äº’ã€‚ å¯è§ï¼Œå…¬å…±éƒ¨åˆ†çš„ç½‘ç»œæ¨¡å‹å°±æ˜¯æˆ‘ä»¬è¦å­¦ä¹ çš„æ¨¡å‹ï¼Œè€Œçº¿ç¨‹é‡Œçš„ç½‘ç»œæ¨¡å‹ä¸»è¦æ˜¯ç”¨äºå’Œç¯å¢ƒäº¤äº’ä½¿ç”¨çš„ï¼Œè¿™äº›çº¿ç¨‹é‡Œçš„æ¨¡å‹å¯ä»¥å¸®åŠ©çº¿ç¨‹æ›´å¥½çš„å’Œç¯å¢ƒäº¤äº’ï¼Œæ‹¿åˆ°é«˜è´¨é‡çš„æ•°æ®å¸®åŠ©æ¨¡å‹æ›´å¿«æ”¶æ•›ã€‚ ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬äºŒä¸ªä¼˜åŒ–ï¼Œç½‘ç»œç»“æ„çš„ä¼˜åŒ–ã€‚ä¹‹å‰åœ¨å¼ºåŒ–å­¦ä¹ (åå››) Actor-Criticä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªä¸åŒçš„ç½‘ç»œActorå’ŒCriticã€‚åœ¨A3Cè¿™é‡Œï¼Œæˆ‘ä»¬æŠŠä¸¤ä¸ªç½‘ç»œæ”¾åˆ°äº†ä¸€èµ·ï¼Œå³è¾“å…¥çŠ¶æ€ $S$,å¯ä»¥è¾“å‡ºçŠ¶æ€ä»·å€¼ $V$,å’Œå¯¹åº”çš„ç­–ç•¥ $Ï€$, å½“ç„¶ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥æŠŠActorå’ŒCriticçœ‹åšç‹¬ç«‹çš„ä¸¤å—ï¼Œåˆ†åˆ«å¤„ç†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æŠŠActorå’ŒCriticçœ‹åšç‹¬ç«‹çš„ä¸¤å—ï¼Œåˆ†åˆ«å¤„ç† ç¬¬ä¸‰ä¸ªä¼˜åŒ–ç‚¹æ˜¯Criticè¯„ä¼°ç‚¹çš„ä¼˜åŒ–ï¼Œåœ¨å¼ºåŒ–å­¦ä¹ (åå››) Actor-Criticç¬¬2èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ä¸åŒçš„Criticè¯„ä¼°ç‚¹çš„é€‰æ‹©ï¼Œå…¶ä¸­déƒ¨åˆ†è®²åˆ°äº†ä½¿ç”¨ä¼˜åŠ¿å‡½æ•° $A$ æ¥åšCriticè¯„ä¼°ç‚¹ï¼Œä¼˜åŠ¿å‡½æ•° $A$ åœ¨æ—¶åˆ»tä¸è€ƒè™‘å‚æ•°çš„é»˜è®¤è¡¨è¾¾å¼ä¸ºï¼š $$A(S,A,t)=Q(S,A)-V(S)$$ $Q(S,A)$çš„å€¼ä¸€èˆ¬å¯ä»¥é€šè¿‡å•æ­¥é‡‡æ ·è¿‘ä¼¼ä¼°è®¡ï¼Œå³ï¼š $$Q(S,A)=R+\\gamma V(S^{\\prime})$$ è¿™æ ·ä¼˜åŠ¿å‡½æ•°å»æ‰åŠ¨ä½œå¯ä»¥è¡¨è¾¾ä¸ºï¼š $$A(S,t)=R+\\gamma V(S^{\\prime})-V(S)$$ å…¶ä¸­ $V(S)$çš„å€¼éœ€è¦é€šè¿‡Criticç½‘ç»œæ¥å­¦ä¹ å¾—åˆ°ã€‚ åœ¨A3Cä¸­ï¼Œé‡‡æ ·æ›´è¿›ä¸€æ­¥ï¼Œä½¿ç”¨äº†Næ­¥é‡‡æ ·ï¼Œä»¥åŠ é€Ÿæ”¶æ•›ã€‚è¿™æ ·A3Cä¸­ä½¿ç”¨çš„ä¼˜åŠ¿å‡½æ•°è¡¨è¾¾ä¸ºï¼š $$A(S,t)=R_t++\\gamma R_{t+1}+\\ldots\\gamma^{n-1}R_{t+n-1}+\\gamma^nV(S^{\\prime})-V(S)$$ å¯¹äºActorå’ŒCriticçš„æŸå¤±å‡½æ•°éƒ¨åˆ†ï¼Œå’ŒActor-CriticåŸºæœ¬ç›¸åŒã€‚æœ‰ä¸€ä¸ªå°çš„ä¼˜åŒ–ç‚¹å°±æ˜¯åœ¨Actor-Criticç­–ç•¥å‡½æ•°çš„æŸå¤±å‡½æ•°ä¸­ï¼ŒåŠ å…¥äº†ç­–ç•¥ $Ï€$ çš„ç†µé¡¹,ç³»æ•°ä¸º $c$, å³ç­–ç•¥å‚æ•°çš„æ¢¯åº¦æ›´æ–°å’ŒActor-Criticç›¸æ¯”å˜æˆäº†è¿™æ ·ï¼š $$\\theta=\\theta+\\alpha\\nabla_\\theta log\\pi_\\theta(s_t,a_t)A(S,t)+c\\nabla_\\theta H(\\pi(S_t,\\theta))$$ ä»¥ä¸Šå°±æ˜¯A3Cå’ŒActor-Criticç›¸æ¯”æœ‰ä¼˜åŒ–çš„éƒ¨åˆ†ã€‚ä¸‹é¢æˆ‘ä»¬æ¥æ€»ä»·ä¸‹A3Cçš„ç®—æ³•æµç¨‹ã€‚ 3. A3Cç®—æ³•æµç¨‹ è¿™é‡Œæˆ‘ä»¬å¯¹A3Cç®—æ³•æµç¨‹åšä¸€ä¸ªæ€»ç»“ï¼Œç”±äºA3Cæ˜¯å¼‚æ­¥å¤šçº¿ç¨‹çš„ï¼Œæˆ‘ä»¬è¿™é‡Œç»™å‡ºä»»æ„ä¸€ä¸ªçº¿ç¨‹çš„ç®—æ³•æµç¨‹ã€‚ è¾“å…¥ï¼šå…¬å…±éƒ¨åˆ†çš„A3Cç¥ç»ç½‘ç»œç»“æ„ï¼Œå¯¹åº”å‚æ•°ä½ $Î¸$ , $w$ï¼Œæœ¬çº¿ç¨‹çš„A3Cç¥ç»ç½‘ç»œç»“æ„ï¼Œå¯¹åº”å‚æ•° $Î¸â€™$, $wâ€™$, å…¨å±€å…±äº«çš„è¿­ä»£è½®æ•° $T$ï¼Œå…¨å±€æœ€å¤§è¿­ä»£æ¬¡æ•° $T_{max}$, çº¿ç¨‹å†…å•æ¬¡è¿­ä»£æ—¶é—´åºåˆ—æœ€å¤§é•¿åº¦ $T_{local}$,çŠ¶æ€ç‰¹å¾ç»´åº¦ $n$, åŠ¨ä½œé›† $A$, æ­¥é•¿ $Î±$, $Î²$ï¼Œç†µç³»æ•° $c$, è¡°å‡å› å­ $Î³$ è¾“å‡ºï¼šå…¬å…±éƒ¨åˆ†çš„A3Cç¥ç»ç½‘ç»œå‚æ•° $Î¸$, $w$ (1). æ›´æ–°æ—¶é—´åºåˆ— $t=1$ (2). é‡ç½®Actorå’ŒCriticçš„æ¢¯åº¦æ›´æ–°é‡: $dÎ¸â†0$,$dwâ†0$ (3). ä»å…¬å…±éƒ¨åˆ†çš„A3Cç¥ç»ç½‘ç»œåŒæ­¥å‚æ•°åˆ°æœ¬çº¿ç¨‹çš„ç¥ç»ç½‘ç»œï¼š$Î¸â€™=Î¸,wâ€™=w$ (4). $t_{start}=t$ï¼Œåˆå§‹åŒ–çŠ¶æ€ $s_t$ (5). åŸºäºç­–ç•¥ $Ï€(at|st;Î¸)$ é€‰æ‹©å‡ºåŠ¨ä½œ $a_t$ (6). æ‰§è¡ŒåŠ¨ä½œ $a_t$å¾—åˆ°å¥–åŠ± $r_t$ å’Œæ–°çŠ¶æ€ $s_{t+1}$ (7). $tâ†t+1$, $Tâ†T+1$ (8). å¦‚æœ $s_t$æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œæˆ– $t âˆ’ t_{start}==t_{local}$,åˆ™è¿›å…¥æ­¥éª¤(9)ï¼Œå¦åˆ™å›åˆ°æ­¥éª¤(5) (9). è®¡ç®—æœ€åä¸€ä¸ªæ—¶é—´åºåˆ—ä½ç½® $s_t$çš„ $Q(s,t)$: $$\\left.Q(s,t)=\\left\\{\\begin{array}{ll}0\u0026terminal~state\\\\V(s_t,w^{\\prime})\u0026none~terminal~state,bootstrapping\\end{array}\\right.\\right.$$ (10). for $iâˆˆ(tâˆ’1,tâˆ’2,â€¦t_{start})$: 1). è®¡ç®—æ¯ä¸ªæ—¶åˆ»çš„$Q(s,i)$ï¼š $Q(s,i)=r_i+\\gamma Q(s,i+1)$ 2). ç´¯è®¡Actorçš„æœ¬åœ°æ¢¯åº¦æ›´æ–°ï¼š $$d\\theta\\leftarrow d\\theta+\\nabla_{\\theta^{\\prime}}log\\pi_{\\theta^{\\prime}}(s_i,a_i)(Q(s,i)-V(S_i,w^{\\prime}))+c\\nabla_{\\theta^{\\prime}}H(\\pi(s_i,\\theta^{\\prime}))$$ 3). ç´¯è®¡Criticçš„æœ¬åœ°æ¢¯åº¦æ›´æ–°ï¼š $$\\begin{aligned}dw\u0026\\leftarrow dw+\\frac{\\partial(Q(s,i)-V(S_i,w^{\\prime}))^2}{\\partial w^{\\prime}}\\end{aligned}$$ (11). æ›´æ–°å…¨å±€ç¥ç»ç½‘ç»œçš„æ¨¡å‹å‚æ•°ï¼š $$\\theta=\\theta+\\alpha d\\theta,~w=w-\\beta dw$$ (12). å¦‚æœ $T\u003eT_{max}$,åˆ™ç®—æ³•ç»“æŸï¼Œè¾“å‡ºå…¬å…±éƒ¨åˆ†çš„A3Cç¥ç»ç½‘ç»œå‚æ•° $Î¸$, $w$,å¦åˆ™è¿›å…¥æ­¥éª¤(3) ä»¥ä¸Šå°±æ˜¯A3Cç®—æ³•å•ä¸ªçº¿ç¨‹çš„ç®—æ³•æµç¨‹ã€‚ 4. A3Cç®—æ³•å®ä¾‹ ä¸‹é¢æˆ‘ä»¬åŸºäºä¸Šè¿°ç®—æ³•æµç¨‹ç»™å‡ºA3Cç®—æ³•å®ä¾‹ã€‚ä»ç„¶ä½¿ç”¨äº†OpenAI Gymä¸­çš„CartPole-v0æ¸¸æˆæ¥ä½œä¸ºæˆ‘ä»¬ç®—æ³•åº”ç”¨ã€‚CartPole-v0æ¸¸æˆçš„ä»‹ç»å‚è§è¿™é‡Œã€‚å®ƒæ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬è¦æ±‚å°±æ˜¯æ§åˆ¶ä¸‹é¢çš„cartç§»åŠ¨ä½¿è¿æ¥åœ¨ä¸Šé¢çš„poleä¿æŒå‚ç›´ä¸å€’ã€‚è¿™ä¸ªä»»åŠ¡åªæœ‰ä¸¤ä¸ªç¦»æ•£åŠ¨ä½œï¼Œè¦ä¹ˆå‘å·¦ç”¨åŠ›ï¼Œè¦ä¹ˆå‘å³ç”¨åŠ›ã€‚è€ŒstateçŠ¶æ€å°±æ˜¯è¿™ä¸ªcartçš„ä½ç½®å’Œé€Ÿåº¦ï¼Œ poleçš„è§’åº¦å’Œè§’é€Ÿåº¦ï¼Œ4ç»´çš„ç‰¹å¾ã€‚åšæŒåˆ°200åˆ†çš„å¥–åŠ±åˆ™ä¸ºè¿‡å…³ã€‚ ç®—æ³•ä»£ç å¤§éƒ¨åˆ†å‚è€ƒäº†è«çƒ¦çš„A3Cä»£ç ï¼Œå¢åŠ äº†æ¨¡å‹æµ‹è¯•éƒ¨åˆ†çš„ä»£ç å¹¶è°ƒæ•´äº†éƒ¨åˆ†æ¨¡å‹å‚æ•°ã€‚å®Œæ•´çš„ä»£ç å‚è§æˆ‘çš„Githubï¼šhttps://github.com/ljpzzz/machinelearning/blob/master/reinforcement-learning/a3c.py æ•´ä¸ªç®—æ³•çš„Actorå’ŒCriticçš„ç½‘ç»œç»“æ„éƒ½å®šä¹‰åœ¨è¿™é‡Œï¼Œ æ‰€æœ‰çš„çº¿ç¨‹ä¸­çš„ç½‘ç»œç»“æ„ï¼Œå…¬å…±éƒ¨åˆ†çš„ç½‘ç»œç»“æ„éƒ½åœ¨è¿™é‡Œå®šä¹‰ã€‚ def _build_net(self, scope): w_init = tf.random_normal_initializer(0., .1) with tf.variable_scope('actor'): l_a = tf.layers.dense(self.s, 200, tf.nn.rel","date":"2024-02-25","objectID":"/posts/rl_learning_note_15/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [15] | A3C","uri":"/posts/rl_learning_note_15/"},{"categories":["RL"],"content":" 0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ (åä¸‰) ç­–ç•¥æ¢¯åº¦(Policy Gradient)ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°äº†åŸºäºç­–ç•¥(Policy Based)çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•çš„åŸºæœ¬æ€è·¯ï¼Œå¹¶è®¨è®ºäº†è’™ç‰¹å¡ç½—ç­–ç•¥æ¢¯åº¦reinforceç®—æ³•ã€‚ä½†æ˜¯ç”±äºè¯¥ç®—æ³•éœ€è¦å®Œæ•´çš„çŠ¶æ€åºåˆ—ï¼ŒåŒæ—¶å•ç‹¬å¯¹ç­–ç•¥å‡½æ•°è¿›è¡Œè¿­ä»£æ›´æ–°ï¼Œä¸å¤ªå®¹æ˜“æ”¶æ•›ã€‚ åœ¨æœ¬ç¯‡æˆ‘ä»¬è®¨è®ºç­–ç•¥(Policy Based)å’Œä»·å€¼(Value Based)ç›¸ç»“åˆçš„æ–¹æ³•ï¼šActor-Criticç®—æ³•ã€‚ æœ¬æ–‡ä¸»è¦å‚è€ƒäº†Suttonçš„å¼ºåŒ–å­¦ä¹ ä¹¦ç¬¬13ç« å’ŒUCLå¼ºåŒ–å­¦ä¹ è®²ä¹‰çš„ç¬¬7è®²ã€‚ 1. Actor-Criticç®—æ³•ç®€ä»‹ Actor-Criticä»åå­—ä¸Šçœ‹åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼Œæ¼”å‘˜(Actor)å’Œè¯„ä»·è€…(Critic)ã€‚å…¶ä¸­Actorä½¿ç”¨æˆ‘ä»¬ä¸Šä¸€èŠ‚è®²åˆ°çš„ç­–ç•¥å‡½æ•°ï¼Œè´Ÿè´£ç”ŸæˆåŠ¨ä½œ(Action)å¹¶å’Œç¯å¢ƒäº¤äº’ã€‚è€ŒCriticä½¿ç”¨æˆ‘ä»¬ä¹‹å‰è®²åˆ°äº†çš„ä»·å€¼å‡½æ•°ï¼Œè´Ÿè´£è¯„ä¼°Actorçš„è¡¨ç°ï¼Œå¹¶æŒ‡å¯¼Actorä¸‹ä¸€é˜¶æ®µçš„åŠ¨ä½œã€‚ å›æƒ³æˆ‘ä»¬ä¸Šä¸€ç¯‡çš„ç­–ç•¥æ¢¯åº¦ï¼Œç­–ç•¥å‡½æ•°å°±æ˜¯æˆ‘ä»¬çš„Actorï¼Œä½†æ˜¯é‚£é‡Œæ˜¯æ²¡æœ‰Criticçš„ï¼Œæˆ‘ä»¬å½“æ—¶ä½¿ç”¨äº†è’™ç‰¹å¡ç½—æ³•æ¥è®¡ç®—æ¯ä¸€æ­¥çš„ä»·å€¼éƒ¨åˆ†æ›¿ä»£äº†Criticçš„åŠŸèƒ½ï¼Œä½†æ˜¯åœºæ™¯æ¯”è¾ƒå—é™ã€‚å› æ­¤ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ç±»ä¼¼DQNä¸­ç”¨çš„ä»·å€¼å‡½æ•°æ¥æ›¿ä»£è’™ç‰¹å¡ç½—æ³•ï¼Œä½œä¸ºä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„Criticã€‚ ä¹Ÿå°±æ˜¯è¯´åœ¨Actor-Criticç®—æ³•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤ç»„è¿‘ä¼¼ï¼Œç¬¬ä¸€ç»„æ˜¯ç­–ç•¥å‡½æ•°çš„è¿‘ä¼¼ï¼š $$ \\pi_\\theta(s,a)=P(a|s,\\theta)\\approx\\pi(a|s) $$ ç¬¬äºŒç»„æ˜¯ä»·å€¼å‡½æ•°çš„è¿‘ä¼¼ï¼Œå¯¹äºçŠ¶æ€ä»·å€¼å’ŒåŠ¨ä½œä»·å€¼å‡½æ•°åˆ†åˆ«æ˜¯ï¼š $$ \\hat{v}(s,w)\\approx v_\\pi(s) $$ $$ \\hat{q}(s,a,w)\\approx q_\\pi(s,a) $$ å¯¹äºæˆ‘ä»¬ä¸Šä¸€èŠ‚è®²åˆ°çš„è’™ç‰¹å¡ç½—ç­–ç•¥æ¢¯åº¦reinforceç®—æ³•ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ”¹é€ æ‰èƒ½å˜æˆActor-Criticç®—æ³•ã€‚é¦–å…ˆï¼Œåœ¨è’™ç‰¹å¡ç½—ç­–ç•¥æ¢¯åº¦reinforceç®—æ³•ä¸­ï¼Œæˆ‘ä»¬çš„ç­–ç•¥çš„å‚æ•°æ›´æ–°å…¬å¼æ˜¯ï¼š $$ \\theta=\\theta+\\alpha\\nabla_\\theta log\\pi_\\theta(s_t,a_t)v_t $$ æ¢¯åº¦æ›´æ–°éƒ¨åˆ†ä¸­ï¼Œ$\\nabla_\\theta log\\pi_\\theta(s_t,a_t)$æ˜¯æˆ‘ä»¬çš„åˆ†å€¼å‡½æ•°ï¼Œä¸ç”¨åŠ¨ï¼Œè¦å˜æˆActorçš„è¯æ”¹åŠ¨çš„æ˜¯$v_t$ï¼Œè¿™å—ä¸èƒ½å†ä½¿ç”¨è’™ç‰¹å¡ç½—æ³•æ¥å¾—åˆ°ï¼Œè€Œåº”è¯¥ä»Criticå¾—åˆ°ã€‚ è€Œå¯¹äºCriticæ¥è¯´ï¼Œè¿™å—æ˜¯æ–°çš„ï¼Œä¸è¿‡æˆ‘ä»¬å®Œå…¨å¯ä»¥å‚è€ƒä¹‹å‰DQNçš„åšæ³•ï¼Œå³ç”¨ä¸€ä¸ªQç½‘ç»œæ¥åšä¸ºCriticï¼Œè¿™ä¸ªQç½‘ç»œçš„è¾“å…¥å¯ä»¥æ˜¯çŠ¶æ€ï¼Œè€Œè¾“å‡ºæ˜¯æ¯ä¸ªåŠ¨ä½œçš„ä»·å€¼æˆ–è€…æœ€ä¼˜åŠ¨ä½œçš„ä»·å€¼ã€‚ ç°åœ¨æˆ‘ä»¬æ±‡æ€»æ¥è¯´ï¼Œå°±æ˜¯Criticé€šè¿‡Qç½‘ç»œè®¡ç®—çŠ¶æ€çš„æœ€ä¼˜ä»·å€¼$v_t$,è€ŒActoråˆ©ç”¨$v_t$è¿™ä¸ªæœ€ä¼˜ä»·å€¼è¿­ä»£æ›´æ–°ç­–ç•¥å‡½æ•°çš„å‚æ•°$\\theta$,è¿›è€Œé€‰æ‹©åŠ¨ä½œï¼Œå¹¶å¾—åˆ°åé¦ˆå’Œæ–°çš„çŠ¶æ€ï¼ŒCriticä½¿ç”¨åé¦ˆå’Œæ–°çš„çŠ¶æ€æ›´æ–°Qç½‘ç»œå‚æ•°$w$,åœ¨åé¢Criticä¼šä½¿ç”¨æ–°çš„ç½‘ç»œå‚æ•°$w$æ¥å¸®Actorè®¡ç®—çŠ¶æ€çš„æœ€ä¼˜ä»·å€¼$v_{te}$ 2. Actor-Criticç®—æ³•å¯é€‰å½¢å¼ åœ¨ä¸Šä¸€èŠ‚æˆ‘ä»¬å·²ç»å¯¹Actor-Criticç®—æ³•çš„æµç¨‹åšäº†ä¸€ä¸ªåˆæ­¥çš„æ€»ç»“ï¼Œä¸è¿‡æœ‰ä¸€ä¸ªå¯ä»¥æ³¨æ„çš„ç‚¹å°±æ˜¯ï¼Œæˆ‘ä»¬å¯¹äºCriticè¯„ä¼°çš„ç‚¹é€‰æ‹©æ˜¯å’Œä¸Šä¸€ç¯‡ç­–ç•¥æ¢¯åº¦ä¸€æ ·çš„çŠ¶æ€ä»·å€¼ $v_t$å®é™…ä¸Šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€‰æ‹©å¾ˆå¤šå…¶ä»–çš„æŒ‡æ ‡æ¥åšä¸ºCriticçš„è¯„ä¼°ç‚¹ã€‚è€Œç›®å‰å¯ä»¥ä½¿ç”¨çš„Actor-Criticè¯„ä¼°ç‚¹ä¸»è¦æœ‰ï¼š a) åŸºäºçŠ¶æ€ä»·å€¼ï¼šè¿™æ˜¯æˆ‘ä»¬ä¸Šä¸€èŠ‚ä½¿ç”¨çš„è¯„ä¼°ç‚¹ï¼Œè¿™æ ·Actorçš„ç­–ç•¥å‡½æ•°å‚æ•°æ›´æ–°çš„æ³•å…¬å¼æ˜¯ï¼š $$\\theta=\\theta+\\alpha\\nabla_\\theta log\\pi_\\theta(s_t,a_t)V(s,w)$$ b) åŸºäºåŠ¨ä½œä»·å€¼ï¼šåœ¨DQNä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„éƒ½æ˜¯åŠ¨ä½œä»·å€¼å‡½æ•°Qæ¥åšä»·å€¼è¯„ä¼°ï¼Œè¿™æ ·Actorçš„ç­–ç•¥å‡½æ•°å‚æ•°æ›´æ–°çš„æ³•å…¬å¼æ˜¯ï¼š $$\\theta=\\theta+\\alpha\\nabla_\\theta log\\pi_\\theta(s_t,a_t)Q(s,a,w)$$ c) åŸºäºTDè¯¯å·®ï¼šåœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆäº”ï¼‰ç”¨æ—¶åºå·®åˆ†æ³•ï¼ˆTDï¼‰æ±‚è§£ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°äº†TDè¯¯å·®ï¼Œå®ƒçš„è¡¨è¾¾å¼æ˜¯ $\\delta(t)=R_{t+1}+\\gamma V(S_{t+1})-V(S_t)$ æˆ–è€… $\\delta(t)=R_{t+1}+\\gamma Q(S_{t+1}\\text{,}A_{t+1})-Q(S_t,A_t)$, è¿™æ ·Actorçš„ç­–ç•¥å‡½æ•°å‚æ•°æ›´æ–°çš„æ³•å…¬å¼æ˜¯ï¼š $$\\theta=\\theta+\\alpha\\nabla_\\theta log\\pi_\\theta(s_t,a_t)\\delta(t)$$ d) åŸºäºä¼˜åŠ¿å‡½æ•°ï¼šåœ¨å¼ºåŒ–å­¦ä¹ (åäºŒ) Dueling DQNä¸­ï¼Œæˆ‘ä»¬è®²åˆ°è¿‡ä¼˜åŠ¿å‡½æ•°Açš„å®šä¹‰ï¼š$A(S,A,w,\\beta)=Q(S,A,w,\\alpha,\\beta)-V(S,w,\\alpha)$, å³åŠ¨ä½œä»·å€¼å‡½æ•°å’ŒçŠ¶æ€ä»·å€¼å‡½æ•°çš„å·®å€¼ã€‚è¿™æ ·Actorçš„ç­–ç•¥å‡½æ•°å‚æ•°æ›´æ–°çš„æ³•å…¬å¼æ˜¯ï¼š $$\\theta=\\theta+\\alpha\\nabla_\\theta log\\pi_\\theta(s_t,a_t)A(S,A,w,\\beta)$$ e) åŸºäº $TD(Î»)$ è¯¯å·®ï¼šä¸€èˆ¬éƒ½æ˜¯åŸºäºåå‘ $TD(Î»)$è¯¯å·®, åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆäº”ï¼‰ç”¨æ—¶åºå·®åˆ†æ³•ï¼ˆTDï¼‰æ±‚è§£ä¸­ä¹Ÿæœ‰è®²åˆ°ï¼Œæ˜¯TDè¯¯å·®å’Œæ•ˆç”¨è¿¹Eçš„ä¹˜ç§¯ã€‚è¿™æ ·Actorçš„ç­–ç•¥å‡½æ•°å‚æ•°æ›´æ–°çš„æ³•å…¬å¼æ˜¯ï¼š $\\theta=\\theta+\\alpha\\nabla_\\theta log\\pi_\\theta(s_t,a_t)\\delta(t)E(t)$ å¯¹äºCriticæœ¬èº«çš„æ¨¡å‹å‚æ•° $w$ ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°æ¥åšåšè¿­ä»£æ›´æ–°ï¼Œç±»ä¼¼ä¹‹å‰DQNç³»åˆ—ä¸­æ‰€è®²çš„è¿­ä»£æ–¹æ³•. å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯æœ€ç®€å•çš„çº¿æ€§Qå‡½æ•°ï¼Œæ¯”å¦‚ $Q(s,a,w)=Ï•(s,a)^Tw$,åˆ™Criticæœ¬èº«çš„æ¨¡å‹å‚æ•° $w$çš„æ›´æ–°å…¬å¼å¯ä»¥è¡¨ç¤ºä¸ºï¼š $$\\begin{gathered} \\delta=R_{t+1}+\\gamma Q(S_{t+1}\\text{,}A_{t+1})-Q(S_t,A_t) \\\\ w=w+\\beta\\delta\\phi(s,a) \\end{gathered}$$ é€šè¿‡å¯¹å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°æ±‚å¯¼å¯ä»¥å¾ˆå®¹æ˜“çš„å¾—åˆ°ä¸Šå¼ã€‚å½“ç„¶å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä½¿ç”¨çº¿æ€§Qå‡½æ•°ï¼Œè€Œä½¿ç”¨ç¥ç»ç½‘ç»œè¡¨ç¤ºçŠ¶æ€å’ŒQå€¼çš„å…³ç³»ã€‚ 3. Actor-Criticç®—æ³•æµç¨‹ è¿™é‡Œç»™ä¸€ä¸ªActor-Criticç®—æ³•çš„æµç¨‹æ€»ç»“ï¼Œè¯„ä¼°ç‚¹åŸºäºTDè¯¯å·®ï¼ŒCriticä½¿ç”¨ç¥ç»ç½‘ç»œæ¥è®¡ç®—TDè¯¯å·®å¹¶æ›´æ–°ç½‘ç»œå‚æ•°ï¼ŒActorä¹Ÿä½¿ç”¨ç¥ç»ç½‘ç»œæ¥æ›´æ–°ç½‘ç»œå‚æ•°ã€€ç®—æ³•è¾“å…¥ï¼šè¿­ä»£è½®æ•° $T$ï¼ŒçŠ¶æ€ç‰¹å¾ç»´åº¦ $n$, åŠ¨ä½œé›† $A$, æ­¥é•¿ $Î±$, $Î²$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, Criticç½‘ç»œç»“æ„å’ŒActorç½‘ç»œç»“æ„ã€‚ è¾“å‡ºï¼šActor ç½‘ç»œå‚æ•° $Î¸$, Criticç½‘ç»œå‚æ•° $w$ (1). éšæœºåˆå§‹åŒ–æ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œå¯¹åº”çš„ä»·å€¼Qï¿½. éšæœºåˆå§‹åŒ–Criticç½‘ç»œçš„æ‰€æœ‰å‚æ•°$w$ã€‚éšæœºåˆå§‹åŒ–Actorç½‘ç»œçš„æ‰€æœ‰å‚æ•°$\\theta$ã€‚ (2). for i from 1 to Tï¼Œè¿›è¡Œè¿­ä»£ã€‚ a) åˆå§‹åŒ– $S$ ä¸ºå½“å‰çŠ¶æ€åºåˆ—çš„ç¬¬ä¸€ä¸ªçŠ¶æ€, æ‹¿åˆ°å…¶ç‰¹å¾å‘é‡ $Ï•(S)$ b) åœ¨Actorç½‘ç»œä¸­ä½¿ç”¨ $Ï•(S)$ ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºåŠ¨ä½œ $A$,åŸºäºåŠ¨ä½œ $A$å¾—åˆ°æ–°çš„çŠ¶æ€ $Sâ€™$,åé¦ˆ $R$ã€‚ c) åœ¨Criticç½‘ç»œä¸­åˆ†åˆ«ä½¿ç”¨ $Ï•(S)$ï¼Œ$Ï•(Sâ€™)$ ä½œä¸ºè¾“å…¥ï¼Œå¾—åˆ°Qå€¼è¾“å‡º $V(S)$ï¼Œ$V(Sâ€™)$ d) è®¡ç®—TDè¯¯å·® $\\delta=R+\\gamma V(S^{\\prime})-V(S)$ e) ä½¿ç”¨å‡æ–¹å·®æŸå¤±å‡½æ•° $\\sum(R+\\gamma V(S^{\\prime})-V(S,w))^2$ ä½œCriticç½‘ç»œå‚æ•° $w$çš„æ¢¯åº¦æ›´æ–° f) æ›´æ–°Actorç½‘ç»œå‚æ•° $Î¸$: $$\\theta=\\theta+\\alpha\\nabla_\\theta log\\pi_\\theta(S_t,A)\\delta $$ å¯¹äºActorçš„åˆ†å€¼å‡½æ•° $âˆ‡_Î¸logÏ€_Î¸(S_t,A)$,å¯ä»¥é€‰æ‹©softmaxæˆ–è€…é«˜æ–¯åˆ†å€¼å‡½æ•°ã€‚ ä¸Šè¿°Actor-Criticç®—æ³•å·²ç»æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç®—æ³•æ¡†æ¶ï¼Œä½†æ˜¯ç¦»å®é™…åº”ç”¨è¿˜æ¯”è¾ƒè¿œã€‚ä¸»è¦åŸå› æ˜¯è¿™é‡Œæœ‰ä¸¤ä¸ªç¥ç»ç½‘ç»œï¼Œéƒ½éœ€è¦æ¢¯åº¦æ›´æ–°ï¼Œè€Œä¸”äº’ç›¸ä¾èµ–ã€‚ä½†æ˜¯äº†è§£è¿™ä¸ªç®—æ³•è¿‡ç¨‹åï¼Œå…¶ä»–åŸºäºActor-Criticçš„ç®—æ³•å°±å¥½ç†è§£äº†ã€‚ 4. Actor-Criticç®—æ³•å®ä¾‹ ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥æ¼”ç¤ºä¸Šé¢çš„Actor-Criticç®—æ³•ã€‚ä»ç„¶ä½¿ç”¨äº†OpenAI Gymä¸­çš„CartPole-v0æ¸¸æˆæ¥ä½œä¸ºæˆ‘ä»¬ç®—æ³•åº”ç”¨ã€‚CartPole-v0æ¸¸æˆçš„ä»‹ç»å‚è§è¿™é‡Œã€‚å®ƒæ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬è¦æ±‚å°±æ˜¯æ§åˆ¶ä¸‹é¢çš„cartç§»åŠ¨ä½¿è¿æ¥åœ¨ä¸Šé¢çš„poleä¿æŒå‚ç›´ä¸å€’ã€‚è¿™ä¸ªä»»åŠ¡åªæœ‰ä¸¤ä¸ªç¦»æ•£åŠ¨ä½œï¼Œè¦ä¹ˆå‘å·¦ç”¨åŠ›ï¼Œè¦ä¹ˆå‘å³ç”¨åŠ›ã€‚è€ŒstateçŠ¶æ€å°±æ˜¯è¿™ä¸ªcartçš„ä½ç½®å’Œé€Ÿåº¦ï¼Œ poleçš„è§’åº¦å’Œè§’é€Ÿåº¦ï¼Œ4ç»´çš„ç‰¹å¾ã€‚åšæŒåˆ°200åˆ†çš„å¥–åŠ±åˆ™ä¸ºè¿‡å…³ã€‚ ç®—æ³•æµç¨‹å¯ä»¥å‚è€ƒä¸Šé¢çš„ç¬¬ä¸‰èŠ‚ï¼Œè¿™é‡Œçš„åˆ†å€¼å‡½æ•°æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯softmaxå‡½æ•°ï¼Œå’Œä¸Šä¸€ç‰‡çš„ç±»ä¼¼ã€‚å®Œæ•´çš„ä»£ç å‚è§Githubï¼šhttps://github.com/ljpzzz/machinelearning/blob/master/reinforcement-learning/actor_critic.py ä»£ç ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯Actorï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯Criticã€‚å¯¹äºActoréƒ¨åˆ†ï¼Œå¤§å®¶å¯ä»¥å’Œä¸Šä¸€ç¯‡ç­–ç•¥æ¢¯åº¦çš„ä»£ç å¯¹æ¯”ï¼Œæ”¹åŠ¨å¹¶ä¸å¤§ï¼Œä¸»è¦åŒºåˆ«åœ¨äºæ¢¯åº¦æ›´æ–°éƒ¨åˆ†ï¼Œç­–ç•¥æ¢¯åº¦ä½¿ç”¨æ˜¯è’™ç‰¹å¡ç½—æ³•è®¡ç®—å‡ºçš„ä»·å€¼ $v","date":"2024-02-25","objectID":"/posts/rl_learning_note_14/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [14] | Actor-Critic","uri":"/posts/rl_learning_note_14/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å‰é¢è®²åˆ°çš„DQNç³»åˆ—å¼ºåŒ–å­¦ä¹ ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å¯¹ä»·å€¼å‡½æ•°è¿›è¡Œäº†è¿‘ä¼¼è¡¨ç¤ºï¼ŒåŸºäºä»·å€¼æ¥å­¦ä¹ ã€‚è¿™ç§Value Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•åœ¨å¾ˆå¤šé¢†åŸŸéƒ½å¾—åˆ°æ¯”è¾ƒå¥½çš„åº”ç”¨ï¼Œä½†æ˜¯Value Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•ä¹Ÿæœ‰å¾ˆå¤šå±€é™æ€§ï¼Œå› æ­¤åœ¨å¦ä¸€äº›åœºæ™¯ä¸‹æˆ‘ä»¬éœ€è¦å…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”å¦‚æœ¬ç¯‡è®¨è®ºçš„ç­–ç•¥æ¢¯åº¦(Policy Gradient)ï¼Œå®ƒæ˜¯Policy Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼ŒåŸºäºç­–ç•¥æ¥å­¦ä¹ ã€‚ æœ¬æ–‡å‚è€ƒäº†Suttonçš„å¼ºåŒ–å­¦ä¹ ä¹¦ç¬¬13ç« å’Œç­–ç•¥æ¢¯åº¦çš„è®ºæ–‡ã€‚ 1. Value Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•çš„ä¸è¶³ DQNç³»åˆ—å¼ºåŒ–å­¦ä¹ ç®—æ³•ä¸»è¦çš„ é—®é¢˜ ä¸»è¦æœ‰ä¸‰ç‚¹ã€‚ ç¬¬ä¸€ç‚¹æ˜¯å¯¹è¿ç»­åŠ¨ä½œçš„å¤„ç†èƒ½åŠ›ä¸è¶³ã€‚DQNä¹‹ç±»çš„æ–¹æ³•ä¸€èˆ¬éƒ½æ˜¯åªå¤„ç†ç¦»æ•£åŠ¨ä½œï¼Œæ— æ³•å¤„ç†è¿ç»­åŠ¨ä½œã€‚è™½ç„¶æœ‰NAF DQNä¹‹ç±»çš„å˜é€šæ–¹æ³•ï¼Œä½†æ˜¯å¹¶ä¸ä¼˜é›…ã€‚æ¯”å¦‚æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ç»å…¸çš„å†°çƒä¸–ç•Œ(PuckWorld) å¼ºåŒ–å­¦ä¹ é—®é¢˜ï¼Œå…·ä½“çš„åŠ¨æ€demoè§è¿™é‡Œã€‚ç¯å¢ƒç”±ä¸€ä¸ªæ­£æ–¹å½¢åŒºåŸŸæ„æˆä»£è¡¨ç€å†°çƒåœºåœ°ï¼Œåœºåœ°å†…å¤§çš„åœ†ä»£è¡¨ç€è¿åŠ¨å‘˜ä¸ªä½“ï¼Œå°åœ†ä»£è¡¨ç€ç›®æ ‡å†°çƒã€‚åœ¨è¿™ä¸ªæ­£æ–¹å½¢ç¯å¢ƒä¸­ï¼Œå°åœ†ä¼šæ¯éš”ä¸€å®šçš„æ—¶é—´éšæœºæ”¹å˜åœ¨åœºåœ°çš„ä½ç½®ï¼Œè€Œä»£è¡¨ä¸ªä½“çš„å¤§åœ†çš„ä»»åŠ¡å°±æ˜¯å°½å¯èƒ½å¿«çš„æ¥è¿‘å†°çƒç›®æ ‡ã€‚å¤§åœ†å¯ä»¥æ“ä½œçš„è¡Œä¸ºæ˜¯åœ¨æ°´å¹³å’Œç«–ç›´å…±å››ä¸ªæ–¹å‘ä¸Šæ–½åŠ ä¸€ä¸ªæ—¶é—´ä¹˜æ—¶é•¿çš„åŠ›ï¼Œå€Ÿæ­¤æ¥æ”¹å˜å¤§åœ†çš„é€Ÿåº¦ã€‚å‡å¦‚æ­¤æ—¶è¿™ä¸ªåŠ›çš„å¤§å°å’Œæ–¹å‘æ˜¯å¯ä»¥çµæ´»é€‰æ‹©çš„ï¼Œé‚£ä¹ˆä½¿ç”¨æ™®é€šçš„DQNä¹‹ç±»çš„ç®—æ³•å°±ä¸å¥½åšäº†ã€‚å› ä¸ºæ­¤æ—¶ç­–ç•¥æ˜¯ä¸€ä¸ªæœ‰å…·ä½“å€¼æœ‰æ–¹å‘çš„åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªåŠ›åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘åˆ†è§£ã€‚é‚£ä¹ˆè¿™ä¸ªåŠ›å°±æ˜¯ä¸¤ä¸ªè¿ç»­çš„å‘é‡ç»„æˆï¼Œè¿™ä¸ªç­–ç•¥ä½¿ç”¨ç¦»æ•£çš„æ–¹å¼æ˜¯ä¸å¥½è¡¨è¾¾çš„ï¼Œä½†æ˜¯ç”¨Policy Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•å´å¾ˆå®¹æ˜“å»ºæ¨¡ã€‚ ç¬¬äºŒç‚¹æ˜¯å¯¹å—é™çŠ¶æ€ä¸‹çš„é—®é¢˜å¤„ç†èƒ½åŠ›ä¸è¶³ã€‚åœ¨ä½¿ç”¨ç‰¹å¾æ¥æè¿°çŠ¶æ€ç©ºé—´ä¸­çš„æŸä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œæœ‰å¯èƒ½å› ä¸ºä¸ªä½“è§‚æµ‹çš„é™åˆ¶æˆ–è€…å»ºæ¨¡çš„å±€é™ï¼Œå¯¼è‡´çœŸå®ç¯å¢ƒä¸‹æœ¬æ¥ä¸åŒçš„ä¸¤ä¸ªçŠ¶æ€å´å†æˆ‘ä»¬å»ºæ¨¡åæ‹¥æœ‰ç›¸åŒçš„ç‰¹å¾æè¿°ï¼Œè¿›è€Œå¾ˆæœ‰å¯èƒ½å¯¼è‡´æˆ‘ä»¬çš„value Basedæ–¹æ³•æ— æ³•å¾—åˆ°æœ€ä¼˜è§£ã€‚æ­¤æ—¶ä½¿ç”¨Policy Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•ä¹Ÿå¾ˆæœ‰æ•ˆã€‚ ç¬¬ä¸‰ç‚¹æ˜¯æ— æ³•è§£å†³éšæœºç­–ç•¥é—®é¢˜ã€‚Value Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•å¯¹åº”çš„æœ€ä¼˜ç­–ç•¥é€šå¸¸æ˜¯ç¡®å®šæ€§ç­–ç•¥ï¼Œå› ä¸ºå…¶æ˜¯ä»ä¼—å¤šè¡Œä¸ºä»·å€¼ä¸­é€‰æ‹©ä¸€ä¸ªæœ€å¤§ä»·å€¼çš„è¡Œä¸ºï¼Œè€Œæœ‰äº›é—®é¢˜çš„æœ€ä¼˜ç­–ç•¥å´æ˜¯éšæœºç­–ç•¥ï¼Œè¿™ç§æƒ…å†µä¸‹åŒæ ·æ˜¯æ— æ³•é€šè¿‡åŸºäºä»·å€¼çš„å­¦ä¹ æ¥æ±‚è§£çš„ã€‚è¿™æ—¶ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨Policy Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•ã€‚ ç”±äºä¸Šé¢è¿™äº›åŸå› ï¼ŒValue Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•ä¸èƒ½é€šåƒæ‰€æœ‰çš„åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦æ–°çš„è§£å†³ä¸Šè¿°ç±»åˆ«é—®é¢˜çš„æ–¹æ³•ï¼Œæ¯”å¦‚Policy Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•ã€‚ 2. Policy Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•å¼•å…¥ å›æƒ³æˆ‘ä»¬åœ¨Value Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•é‡Œï¼Œæˆ‘ä»¬å¯¹ä»·å€¼å‡½æ•°è¿›è¡Œäº†è¿‘ä¼¼è¡¨ç¤ºï¼Œå¼•å…¥äº†ä¸€ä¸ªåŠ¨ä½œä»·å€¼å‡½æ•° $\\hat{q}$ï¼Œè¿™ä¸ªå‡½æ•°ç”±å‚æ•° $w$ æè¿°ï¼Œå¹¶æ¥å—çŠ¶æ€ $s$ ä¸åŠ¨ä½œ $a$ ä½œä¸ºè¾“å…¥ï¼Œè®¡ç®—åå¾—åˆ°è¿‘ä¼¼çš„åŠ¨ä½œä»·å€¼ï¼Œå³ï¼š $$\\hat{q}\\left(s,a,w\\right)\\approx q_\\pi(s,a)$$ åœ¨Policy Basedå¼ºåŒ–å­¦ä¹ æ–¹æ³•ä¸‹ï¼Œæˆ‘ä»¬é‡‡æ ·ç±»ä¼¼çš„æ€è·¯ï¼Œåªä¸è¿‡è¿™æ—¶æˆ‘ä»¬å¯¹ç­–ç•¥è¿›è¡Œè¿‘ä¼¼è¡¨ç¤ºã€‚æ­¤æ—¶ç­–ç•¥ $Ï€$å¯ä»¥è¢«è¢«æè¿°ä¸ºä¸€ä¸ªåŒ…å«å‚æ•° $Î¸$ çš„å‡½æ•°,å³ï¼š $$\\pi_\\theta(s,a)=P(a|s,\\theta)\\approx\\pi(a|s)$$ å°†ç­–ç•¥è¡¨ç¤ºæˆä¸€ä¸ªè¿ç»­çš„å‡½æ•°åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿ç»­å‡½æ•°çš„ä¼˜åŒ–æ–¹æ³•æ¥å¯»æ‰¾æœ€ä¼˜çš„ç­–ç•¥äº†ã€‚è€Œæœ€å¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯æ¢¯åº¦ä¸Šå‡æ³•äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¢¯åº¦å¯¹åº”çš„ä¼˜åŒ–ç›®æ ‡å¦‚ä½•å®šä¹‰å‘¢ï¼Ÿ 3. ç­–ç•¥æ¢¯åº¦çš„ä¼˜åŒ–ç›®æ ‡ æˆ‘ä»¬è¦ç”¨æ¢¯åº¦ä¸Šå‡æ¥å¯»æ‰¾æœ€ä¼˜çš„æ¢¯åº¦ï¼Œé¦–å…ˆå°±è¦æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥ä¼˜åŒ–çš„å‡½æ•°ç›®æ ‡ã€‚ æœ€ç®€å•çš„ä¼˜åŒ–ç›®æ ‡å°±æ˜¯åˆå§‹çŠ¶æ€æ”¶è·çš„æœŸæœ›ï¼Œå³ä¼˜åŒ–ç›®æ ‡ä¸ºï¼š $$J_1(\\theta)=V_{\\pi_\\theta}(s_1)=\\mathbb{E}_{\\pi_\\theta}(G_1)$$ ä½†æ˜¯æœ‰çš„é—®é¢˜æ˜¯æ²¡æœ‰æ˜ç¡®çš„åˆå§‹çŠ¶æ€çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡å¯ä»¥å®šä¹‰å¹³å‡ä»·å€¼ï¼Œå³ï¼š $$J_{avV}(\\theta)=\\sum_sd_{\\pi_\\theta}(s)V_{\\pi_\\theta}(s)$$ å…¶ä¸­ï¼Œ$d_Ï€Î¸(s)$ æ˜¯åŸºäºç­–ç•¥ $Ï€_Î¸$ç”Ÿæˆçš„é©¬å°”ç§‘å¤«é“¾å…³äºçŠ¶æ€çš„é™æ€åˆ†å¸ƒã€‚ æˆ–è€…å®šä¹‰ä¸ºæ¯ä¸€æ—¶é—´æ­¥çš„å¹³å‡å¥–åŠ±ï¼Œå³ï¼š $$J_{avR}(\\theta)==\\sum_sd_{\\pi_\\theta}(s)\\sum_a\\pi_\\theta(s,a)R_s^a$$ æ— è®ºæˆ‘ä»¬æ˜¯é‡‡ç”¨ $J_1$, $J_{av}V$, è¿˜æ˜¯ $J_{av}R$ æ¥è¡¨ç¤ºä¼˜åŒ–ç›®æ ‡ï¼Œæœ€ç»ˆå¯¹ $Î¸$æ±‚å¯¼çš„æ¢¯åº¦éƒ½å¯ä»¥è¡¨ç¤ºä¸ºï¼š $$\\nabla_\\theta J(\\theta)=\\mathbb{E}_{\\pi_\\theta}[\\nabla_\\theta log\\pi_\\theta(s,a)Q_\\pi(s,a)]$$ å…·ä½“çš„è¯æ˜è¿‡ç¨‹è¿™é‡Œå°±ä¸å†åˆ—äº†ï¼Œå¦‚æœå¤§å®¶æ„Ÿå…´è¶£ï¼Œå¯ä»¥å»çœ‹ç­–ç•¥æ¢¯åº¦çš„è®ºæ–‡çš„é™„å½•1ï¼Œé‡Œé¢æœ‰è¯¦ç»†çš„è¯æ˜ã€‚ å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥é‡‡ç”¨å¾ˆå¤šå…¶ä»–å¯èƒ½çš„ä¼˜åŒ–ç›®æ ‡æ¥åšæ¢¯åº¦ä¸Šå‡ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„æ¢¯åº¦å¼å­é‡Œé¢çš„ $\\nabla_\\theta log\\pi_\\theta(s,a)$ éƒ¨åˆ†å¹¶ä¸æ”¹å˜ï¼Œå˜åŒ–çš„åªæ˜¯åé¢çš„ $Q_\\pi(s,a)$ éƒ¨åˆ†ã€‚å¯¹äº $\\nabla_\\theta log\\pi_\\theta(s,a)$,æˆ‘ä»¬ä¸€èˆ¬ç§°ä¸ºåˆ†å€¼å‡½æ•°(score function)ã€‚ ç°åœ¨æ¢¯åº¦çš„å¼å­å·²ç»æœ‰äº†ï¼Œåé¢å‰©ä¸‹çš„å°±æ˜¯ç­–ç•¥å‡½æ•° $\\pi_\\theta(s,a)$çš„è®¾è®¡äº†ã€‚ 4. ç­–ç•¥å‡½æ•°çš„è®¾è®¡ ç°åœ¨æˆ‘ä»¬å›å¤´çœ‹ä¸€ä¸‹ç­–ç•¥å‡½æ•° $\\pi_\\theta(s,a)$ çš„è®¾è®¡ï¼Œåœ¨å‰é¢å®ƒä¸€ç›´æ˜¯ä¸€ä¸ªæ•°å­¦ç¬¦å·ã€‚ æœ€å¸¸ç”¨çš„ç­–ç•¥å‡½æ•°å°±æ˜¯softmaxç­–ç•¥å‡½æ•°äº†ï¼Œå®ƒä¸»è¦åº”ç”¨äºç¦»æ•£ç©ºé—´ä¸­ï¼Œsoftmaxç­–ç•¥ä½¿ç”¨æè¿°çŠ¶æ€å’Œè¡Œä¸ºçš„ç‰¹å¾ $Ï•(s,a)$ ä¸å‚æ•° $Î¸$çš„çº¿æ€§ç»„åˆæ¥æƒè¡¡ä¸€ä¸ªè¡Œä¸ºå‘ç”Ÿçš„å‡ ç‡,å³: $$\\pi_\\theta(s,a)=\\frac{e^{\\phi(s,a)^T\\theta}}{\\sum_be^{\\phi(s,b)^T\\theta}}$$ åˆ™é€šè¿‡æ±‚å¯¼å¾ˆå®¹æ˜“æ±‚å‡ºå¯¹åº”çš„åˆ†å€¼å‡½æ•°ä¸ºï¼š $$\\nabla_\\theta log\\pi_\\theta(s,a)=\\phi(s,a)-\\mathbb{E}_{\\pi_\\theta}[\\phi(s,.)]$$ å¦ä¸€ç§é«˜æ–¯ç­–ç•¥åˆ™æ˜¯åº”ç”¨äºè¿ç»­è¡Œä¸ºç©ºé—´çš„ä¸€ç§å¸¸ç”¨ç­–ç•¥ã€‚è¯¥ç­–ç•¥å¯¹åº”çš„è¡Œä¸ºä»é«˜æ–¯åˆ†å¸ƒ $\\mathbb{N}(\\phi(\\mathrm{s})^{\\mathbb{T}}\\theta,\\sigma^2)$ä¸­äº§ç”Ÿã€‚é«˜æ–¯ç­–ç•¥å¯¹åº”çš„åˆ†å€¼å‡½æ•°æ±‚å¯¼å¯ä»¥å¾—åˆ°ä¸º: $$\\nabla_\\theta log\\pi_\\theta(s,a)==\\frac{(a-\\phi(s)^T\\theta)\\phi(s)}{\\sigma^2}$$ æœ‰ç­–ç•¥æ¢¯åº¦çš„å…¬å¼å’Œç­–ç•¥å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ç¬¬ä¸€ç‰ˆçš„ç­–ç•¥æ¢¯åº¦ç®—æ³•äº†ã€‚ 5. è’™ç‰¹å¡ç½—ç­–ç•¥æ¢¯åº¦reinforceç®—æ³• è¿™é‡Œæˆ‘ä»¬è®¨è®ºæœ€ç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼Œè’™ç‰¹å¡ç½—ç­–ç•¥æ¢¯åº¦reinforceç®—æ³•, ä½¿ç”¨ä»·å€¼å‡½æ•° $v(s)$ æ¥è¿‘ä¼¼ä»£æ›¿ç­–ç•¥æ¢¯åº¦å…¬å¼é‡Œé¢çš„ $Q_Ï€(s,a)$ã€‚ç®—æ³•çš„æµç¨‹å¾ˆç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤º: è¾“å…¥ï¼šNä¸ªè’™ç‰¹å¡ç½—å®Œæ•´åºåˆ—,è®­ç»ƒæ­¥é•¿ $Î±$ è¾“å‡ºï¼šç­–ç•¥å‡½æ•°çš„å‚æ•° $Î¸$ (1). for æ¯ä¸ªè’™ç‰¹å¡ç½—åºåˆ—: a. ç”¨è’™ç‰¹å¡ç½—æ³•è®¡ç®—åºåˆ—æ¯ä¸ªæ—¶é—´ä½ç½®tçš„çŠ¶æ€ä»·å€¼ $v_t$ b. å¯¹åºåˆ—æ¯ä¸ªæ—¶é—´ä½ç½®tï¼Œä½¿ç”¨æ¢¯åº¦ä¸Šå‡æ³•ï¼Œæ›´æ–°ç­–ç•¥å‡½æ•°çš„å‚æ•° $Î¸$ï¼š $$\\theta=\\theta+\\alpha\\nabla_\\theta log\\pi_\\theta(s_t,a_t)v_t$$ (2).è¿”å›ç­–ç•¥å‡½æ•°çš„å‚æ•° $Î¸$ è¿™é‡Œçš„ç­–ç•¥å‡½æ•°å¯ä»¥æ˜¯softmaxç­–ç•¥ï¼Œé«˜æ–¯ç­–ç•¥æˆ–è€…å…¶ä»–ç­–ç•¥ã€‚ 6. ç­–ç•¥æ¢¯åº¦å®ä¾‹ è¿™é‡Œç»™å‡ºç¬¬5èŠ‚çš„è’™ç‰¹å¡ç½—ç­–ç•¥æ¢¯åº¦reinforceç®—æ³•çš„ä¸€ä¸ªå®ä¾‹ã€‚ä»ç„¶ä½¿ç”¨äº†OpenAI Gymä¸­çš„CartPole-v0æ¸¸æˆæ¥ä½œä¸ºæˆ‘ä»¬ç®—æ³•åº”ç”¨ã€‚CartPole-v0æ¸¸æˆçš„ä»‹ç»å‚è§è¿™é‡Œã€‚å®ƒæ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬è¦æ±‚å°±æ˜¯æ§åˆ¶ä¸‹é¢çš„cartç§»åŠ¨ä½¿è¿æ¥åœ¨ä¸Šé¢çš„poleä¿æŒå‚ç›´ä¸å€’ã€‚è¿™ä¸ªä»»åŠ¡åªæœ‰ä¸¤ä¸ªç¦»æ•£åŠ¨ä½œï¼Œè¦ä¹ˆå‘å·¦ç”¨åŠ›ï¼Œè¦ä¹ˆå‘å³ç”¨åŠ›ã€‚è€ŒstateçŠ¶æ€å°±æ˜¯è¿™ä¸ªcartçš„ä½ç½®å’Œé€Ÿåº¦ï¼Œ poleçš„è§’åº¦å’Œè§’é€Ÿåº¦ï¼Œ4ç»´çš„ç‰¹å¾ã€‚åšæŒåˆ°200åˆ†çš„å¥–åŠ±åˆ™ä¸ºè¿‡å…³ã€‚ å®Œæ•´çš„ä»£ç å‚è§æˆ‘çš„githubï¼šhttps://github.com/ljpzzz/machinelearning/blob/master/reinforcement-learning/policy_gradient.py è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨softmaxç­–ç•¥ä½œä¸ºæˆ‘ä»¬çš„ç­–ç•¥å‡½æ•°ï¼ŒåŒæ—¶ï¼Œsoftmaxçš„å‰ç½®éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç­–ç•¥æ¨¡å‹ç”¨ä¸€ä¸ªä¸‰å±‚çš„softmaxç¥ç»ç½‘ç»œæ¥è¡¨ç¤ºã€‚è¿™æ ·å¥½å¤„å°±æ˜¯æ¢¯åº¦çš„æ›´æ–°å¯ä»¥äº¤ç»™ç¥ç»ç½‘ç»œæ¥åšã€‚ æˆ‘ä»¬çš„softmaxç¥ç»ç½‘ç»œçš„ç»“æ„å¦‚ä¸‹ï¼Œæ³¨æ„è¿™ä¸ªç½‘ç»œä¸æ˜¯ä»·å€¼Qç½‘ç»œï¼Œè€Œæ˜¯ç­–ç•¥ç½‘ç»œï¼š def create_softmax_network(self): # network weights W1 = self.weight_variable([self.state_dim, 20]) b1 = self.bias_variable([20]) W2 = self.weight_variable([20, self.action_dim]) b2 = self.bias_variable([self.action_dim]) # input layer self.state_input = tf.placeholder(\"float\", [None, self.state_dim]) self.tf_acts = tf.placeholder(tf.int32","date":"2024-02-25","objectID":"/posts/rl_learning_note_13/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [13] | ç­–ç•¥æ¢¯åº¦(Policy Gradient)","uri":"/posts/rl_learning_note_13/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ (åä¸€) Prioritized Replay DQNä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¯¹DQNçš„ç»éªŒå›æ”¾æ± æŒ‰æƒé‡é‡‡æ ·æ¥ä¼˜åŒ–DQNç®—æ³•çš„æ–¹æ³•ï¼Œæœ¬æ–‡è®¨è®ºå¦ä¸€ç§ä¼˜åŒ–æ–¹æ³•ï¼ŒDueling DQNã€‚æœ¬ç« å†…å®¹ä¸»è¦å‚è€ƒäº†ICML 2016çš„deep RL tutorialå’ŒDueling DQNçš„è®ºæ–‡(Dueling Network Architectures for Deep Reinforcement Learning)(ICML 2016)ã€‚ 1. Dueling DQNçš„ä¼˜åŒ–ç‚¹è€ƒè™‘ åœ¨å‰é¢è®²åˆ°çš„DDQNä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¼˜åŒ–ç›®æ ‡Qå€¼çš„è®¡ç®—æ¥ä¼˜åŒ–ç®—æ³•ï¼Œåœ¨Prioritized Replay DQNä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¼˜åŒ–ç»éªŒå›æ”¾æ± æŒ‰æƒé‡é‡‡æ ·æ¥ä¼˜åŒ–ç®—æ³•ã€‚è€Œåœ¨Dueling DQNä¸­ï¼Œæˆ‘ä»¬å°è¯•é€šè¿‡ä¼˜åŒ–ç¥ç»ç½‘ç»œçš„ç»“æ„æ¥ä¼˜åŒ–ç®—æ³•ã€‚ å…·ä½“å¦‚ä½•ä¼˜åŒ–ç½‘ç»œç»“æ„å‘¢ï¼ŸDueling DQNè€ƒè™‘å°†Qç½‘ç»œåˆ†æˆä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯ä»…ä»…ä¸çŠ¶æ€ $S$æœ‰å…³ï¼Œä¸å…·ä½“è¦é‡‡ç”¨çš„åŠ¨ä½œ $A$æ— å…³ï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬å«åšä»·å€¼å‡½æ•°éƒ¨åˆ†ï¼Œè®°åš $V(S,w,Î±)$,ç¬¬äºŒéƒ¨åˆ†åŒæ—¶ä¸çŠ¶æ€çŠ¶æ€ $S$ å’ŒåŠ¨ä½œ $A$æœ‰å…³ï¼Œè¿™éƒ¨åˆ†å«åš**ä¼˜åŠ¿å‡½æ•°(Advantage Function)**éƒ¨åˆ†,è®°ä¸º $A(S,A,w,Î²)$,é‚£ä¹ˆæœ€ç»ˆæˆ‘ä»¬çš„ä»·å€¼å‡½æ•°å¯ä»¥é‡æ–°è¡¨ç¤ºä¸ºï¼š $$Q(S,A,w,\\alpha,\\beta)=V(S,w,\\alpha)+A(S,A,w,\\beta)$$ å…¶ä¸­ï¼Œ$w$ æ˜¯å…¬å…±éƒ¨åˆ†çš„ç½‘ç»œå‚æ•°ï¼Œè€Œ $Î±$ æ˜¯ä»·å€¼å‡½æ•°ç‹¬æœ‰éƒ¨åˆ†çš„ç½‘ç»œå‚æ•°ï¼Œè€Œ $Î²$ æ˜¯ä¼˜åŠ¿å‡½æ•°ç‹¬æœ‰éƒ¨åˆ†çš„ç½‘ç»œå‚æ•°ã€‚ 2. Dueling DQNç½‘ç»œç»“æ„ ç”±äºQç½‘ç»œçš„ä»·å€¼å‡½æ•°è¢«åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå› æ­¤Dueling DQNçš„ç½‘ç»œç»“æ„ä¹Ÿå’Œä¹‹å‰çš„DQNä¸åŒã€‚ä¸ºäº†ç®€åŒ–ç®—æ³•æè¿°ï¼Œè¿™é‡Œä¸ä½¿ç”¨åŸè®ºæ–‡çš„CNNç½‘ç»œç»“æ„ï¼Œè€Œæ˜¯ä½¿ç”¨å‰é¢æ–‡ä¸­ç”¨åˆ°çš„æœ€ç®€å•çš„ä¸‰å±‚ç¥ç»ç½‘ç»œæ¥æè¿°ã€‚æ˜¯å¦ä½¿ç”¨CNNå¯¹Dueling DQNç®—æ³•æœ¬èº«æ— å½±å“ã€‚ åœ¨å‰é¢è®²åˆ°çš„DDQNç­‰DQNç®—æ³•ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„ä¸‰å±‚ç¥ç»ç½‘ç»œï¼šä¸€ä¸ªè¾“å…¥å±‚ï¼Œä¸€ä¸ªéšè—å±‚å’Œä¸€ä¸ªè¾“å‡ºå±‚ã€‚å¦‚ä¸‹å·¦å›¾æ‰€ç¤ºï¼š ç¥ç»ç½‘ç»œä¸Dueling DQN è€Œåœ¨Dueling DQNä¸­ï¼Œæˆ‘ä»¬åœ¨åé¢åŠ äº†ä¸¤ä¸ªå­ç½‘ç»œç»“æ„ï¼Œåˆ†åˆ«å¯¹åº”ä¸Šé¢ä¸Šåˆ°ä»·æ ¼å‡½æ•°ç½‘ç»œéƒ¨åˆ†å’Œä¼˜åŠ¿å‡½æ•°ç½‘ç»œéƒ¨åˆ†ã€‚å¯¹åº”ä¸Šé¢å³å›¾æ‰€ç¤ºã€‚æœ€ç»ˆQç½‘ç»œçš„è¾“å‡ºç”±ä»·æ ¼å‡½æ•°ç½‘ç»œçš„è¾“å‡ºå’Œä¼˜åŠ¿å‡½æ•°ç½‘ç»œçš„è¾“å‡ºçº¿æ€§ç»„åˆå¾—åˆ°ã€‚ æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸Šä¸€èŠ‚çš„ä»·å€¼å‡½æ•°çš„ç»„åˆå…¬å¼å¾—åˆ°æˆ‘ä»¬çš„åŠ¨ä½œä»·å€¼ï¼Œä½†æ˜¯è¿™ä¸ªå¼å­æ— æ³•è¾¨è¯†æœ€ç»ˆè¾“å‡ºé‡Œé¢ $V(S,w,Î±)$ å’Œ $A(S,A,w,Î²)$å„è‡ªçš„ä½œç”¨ï¼Œä¸ºäº†å¯ä»¥ä½“ç°è¿™ç§å¯è¾¨è¯†æ€§(identifiability),å®é™…ä½¿ç”¨çš„ç»„åˆå…¬å¼å¦‚ä¸‹ï¼š $$Q(S,A,w,\\alpha,\\beta)=V(S,w,\\alpha)+(A(S,A,w,\\beta)-\\frac1{\\mathcal{A}}\\sum_{a^{\\prime}\\in\\mathcal{A}}A(S,a^{\\prime},w,\\beta))$$ å…¶å®å°±æ˜¯å¯¹ä¼˜åŠ¿å‡½æ•°éƒ¨åˆ†åšäº†ä¸­å¿ƒåŒ–çš„å¤„ç†ã€‚ä»¥ä¸Šå°±æ˜¯Dueling DQNçš„ä¸»è¦ç®—æ³•æ€è·¯ã€‚ç”±äºå®ƒä»…ä»…æ¶‰åŠç¥ç»ç½‘ç»œçš„ä¸­é—´ç»“æ„çš„æ”¹è¿›ï¼Œç°æœ‰çš„DQNç®—æ³•å¯ä»¥åœ¨ä½¿ç”¨Duel DQNç½‘ç»œç»“æ„çš„åŸºç¡€ä¸Šç»§ç»­ä½¿ç”¨ç°æœ‰çš„ç®—æ³•ã€‚ç”±äºç®—æ³•ä¸»æµç¨‹å’Œå…¶ä»–ç®—æ³•æ²¡æœ‰å·®å¼‚ï¼Œè¿™é‡Œå°±ä¸å•ç‹¬è®²Duel DQNçš„ç®—æ³•æµç¨‹äº†ã€‚ 3. Dueling DQNå®ä¾‹ ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥æ¼”ç¤ºDueling DQNçš„åº”ç”¨ã€‚ä»ç„¶ä½¿ç”¨äº†OpenAI Gymä¸­çš„CartPole-v0æ¸¸æˆæ¥ä½œä¸ºæˆ‘ä»¬ç®—æ³•åº”ç”¨ã€‚CartPole-v0æ¸¸æˆçš„ä»‹ç»å‚è§è¿™é‡Œã€‚å®ƒæ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬è¦æ±‚å°±æ˜¯æ§åˆ¶ä¸‹é¢çš„cartç§»åŠ¨ä½¿è¿æ¥åœ¨ä¸Šé¢çš„poleä¿æŒå‚ç›´ä¸å€’ã€‚è¿™ä¸ªä»»åŠ¡åªæœ‰ä¸¤ä¸ªç¦»æ•£åŠ¨ä½œï¼Œè¦ä¹ˆå‘å·¦ç”¨åŠ›ï¼Œè¦ä¹ˆå‘å³ç”¨åŠ›ã€‚è€ŒstateçŠ¶æ€å°±æ˜¯è¿™ä¸ªcartçš„ä½ç½®å’Œé€Ÿåº¦ï¼Œ poleçš„è§’åº¦å’Œè§’é€Ÿåº¦ï¼Œ4ç»´çš„ç‰¹å¾ã€‚åšæŒåˆ°200åˆ†çš„å¥–åŠ±åˆ™ä¸ºè¿‡å…³ã€‚ è¿™ä¸ªå®ä¾‹ä»£åŸºäºNature DQNï¼Œå¹¶å°†ç½‘ç»œç»“æ„æ”¹ä¸ºä¸Šå›¾ä¸­å³è¾¹çš„Dueling DQNç½‘ç»œç»“æ„ï¼Œå®Œæ•´çš„ä»£ç å‚è§github: https://github.com/ljpzzz/machinelearning/blob/master/reinforcement-learning/duel_dqn.py è¿™é‡Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨Dueling DQNå’ŒNature DQNçš„ä»£ç çš„ä¸åŒä¹‹å¤„ã€‚ä¹Ÿå°±æ˜¯ç½‘ç»œç»“æ„å®šä¹‰éƒ¨åˆ†ï¼Œä¸»è¦çš„ä»£ç å¦‚ä¸‹ï¼Œä¸€å…±æœ‰ä¸¤ä¸ªç›¸åŒç»“æ„çš„Qç½‘ç»œï¼Œæ¯ä¸ªQç½‘ç»œéƒ½æœ‰çŠ¶æ€å‡½æ•°å’Œä¼˜åŠ¿å‡½æ•°çš„å®šä¹‰ï¼Œä»¥åŠç»„åˆåçš„Qç½‘ç»œè¾“å‡ºï¼Œå¦‚ä»£ç çº¢è‰²éƒ¨åˆ†ï¼š def create_Q_network(self): # input layer self.state_input = tf.placeholder(\"float\", [None, self.state_dim]) # network weights with tf.variable_scope('current_net'): W1 = self.weight_variable([self.state_dim,20]) b1 = self.bias_variable([20]) # hidden layer 1 h_layer_1 = tf.nn.relu(tf.matmul(self.state_input,W1) + b1) # hidden layer for state value with tf.variable_scope('Value'): W21= self.weight_variable([20,1]) b21 = self.bias_variable([1]) self.V = tf.matmul(h_layer_1, W21) + b21 # hidden layer for action value with tf.variable_scope('Advantage'): W22 = self.weight_variable([20,self.action_dim]) b22 = self.bias_variable([self.action_dim]) self.A = tf.matmul(h_layer_1, W22) + b22 # Q Value layer self.Q_value = self.V + (self.A - tf.reduce_mean(self.A, axis=1, keep_dims=True)) with tf.variable_scope('target_net'): W1t = self.weight_variable([self.state_dim,20]) b1t = self.bias_variable([20]) # hidden layer 1 h_layer_1t = tf.nn.relu(tf.matmul(self.state_input,W1t) + b1t) # hidden layer for state value with tf.variable_scope('Value'): W2v = self.weight_variable([20,1]) b2v = self.bias_variable([1]) self.VT = tf.matmul(h_layer_1t, W2v) + b2v # hidden layer for action value with tf.variable_scope('Advantage'): W2a = self.weight_variable([20,self.action_dim]) b2a = self.bias_variable([self.action_dim]) self.AT = tf.matmul(h_layer_1t, W2a) + b2a # Q Value layer self.target_Q_value = self.VT + (self.AT - tf.reduce_mean(self.AT, axis=1, keep_dims=True)) å…¶ä½™éƒ¨åˆ†ä»£ç å’ŒNature DQNåŸºæœ¬ç›¸åŒã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¹Ÿåœ¨å‰é¢DDQNï¼ŒPrioritized Replay DQNä»£ç çš„åŸºç¡€ä¸Šï¼ŒæŠŠç½‘ç»œç»“æ„æ”¹æˆä¸Šé¢çš„å®šä¹‰ï¼Œè¿™æ ·Dueling DQNä¹Ÿå¯ä»¥èµ·ä½œç”¨ã€‚ 4. DQNæ€»ç»“ DQNç³»åˆ—æˆ‘èŠ±äº†5ç¯‡æ¥è®²è§£ï¼Œä¸€å…±5ä¸ªå‰åæœ‰å…³è”çš„ç®—æ³•ï¼šDQN(NIPS2013), Nature DQN, DDQN, Prioritized Replay DQNå’ŒDueling DQNã€‚ç›®å‰ä½¿ç”¨çš„æ¯”è¾ƒä¸»æµçš„æ˜¯åé¢ä¸‰ç§ç®—æ³•æ€è·¯ï¼Œè¿™ä¸‰ç§ç®—æ³•æ€è·¯ä¹Ÿæ˜¯å¯ä»¥æ··ç€ä¸€èµ·ä½¿ç”¨çš„ï¼Œç›¸äº’å¹¶ä¸æ’æ–¥ã€‚ å½“ç„¶DQNå®¶æ—çš„ç®—æ³•è¿œè¿œä¸æ­¢è¿™äº›ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„DQNç®—æ³•æˆ‘æ²¡æœ‰è¯¦ç»†ä»‹ç»ï¼Œæ¯”å¦‚ä½¿ç”¨ä¸€äº›è¾ƒå¤æ‚çš„CNNå’ŒRNNç½‘ç»œæ¥æé«˜DQNçš„è¡¨è¾¾èƒ½åŠ›ï¼Œåˆæ¯”å¦‚æ”¹è¿›æ¢ç´¢çŠ¶æ€ç©ºé—´çš„æ–¹æ³•ç­‰ï¼Œä¸»è¦æ˜¯åœ¨DQNçš„åŸºç¡€ä¸ŠæŒç»­ä¼˜åŒ–ã€‚ DQNç®—æ˜¯æ·±åº¦å¼ºåŒ–å­¦ä¹ çš„ä¸­çš„ä¸»æµæµæ´¾ï¼Œä»£è¡¨äº†Value-Basedè¿™ä¸€å¤§ç±»æ·±åº¦å¼ºåŒ–å­¦ä¹ ç®—æ³•ã€‚ä½†æ˜¯å®ƒä¹Ÿæœ‰è‡ªå·±çš„ä¸€äº›é—®é¢˜ï¼Œå°±æ˜¯ç»å¤§å¤šæ•°DQNåªèƒ½å¤„ç†ç¦»æ•£çš„åŠ¨ä½œé›†åˆï¼Œä¸èƒ½å¤„ç†è¿ç»­çš„åŠ¨ä½œé›†åˆã€‚è™½ç„¶NAF DQNå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æ–¹æ³•è¿‡äºå¤æ‚äº†ã€‚è€Œæ·±åº¦å¼ºåŒ–å­¦ä¹ çš„å¦ä¸€ä¸ªä¸»æµæµæ´¾Policy-Basedè€Œå¯ä»¥è¾ƒå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»ä¸‹ä¸€ç¯‡æˆ‘ä»¬å¼€å§‹è®¨è®ºPolicy-Basedæ·±åº¦å¼ºåŒ–å­¦ä¹ ã€‚ ","date":"2024-02-25","objectID":"/posts/rl_learning_note_12/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [12] | Dueling DQN","uri":"/posts/rl_learning_note_12/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆåï¼‰Double DQN (DDQN)ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°äº†DDQNä½¿ç”¨ä¸¤ä¸ªQç½‘ç»œï¼Œç”¨å½“å‰Qç½‘ç»œè®¡ç®—æœ€å¤§Qå€¼å¯¹åº”çš„åŠ¨ä½œï¼Œç”¨ç›®æ ‡Qç½‘ç»œè®¡ç®—è¿™ä¸ªæœ€å¤§åŠ¨ä½œå¯¹åº”çš„ç›®æ ‡Qå€¼ï¼Œè¿›è€Œæ¶ˆé™¤è´ªå©ªæ³•å¸¦æ¥çš„åå·®ã€‚ä»Šå¤©æˆ‘ä»¬åœ¨DDQNçš„åŸºç¡€ä¸Šï¼Œå¯¹ç»éªŒå›æ”¾éƒ¨åˆ†çš„é€»è¾‘åšä¼˜åŒ–ã€‚å¯¹åº”çš„ç®—æ³•æ˜¯Prioritized Replay DQNã€‚ æœ¬ç« å†…å®¹ä¸»è¦å‚è€ƒäº†ICML 2016çš„deep RL tutorialå’ŒPrioritized Replay DQNçš„è®ºæ–‡(Prioritized Experience Replay)(ICLR 2016)ã€‚ 1. Prioritized Replay DQNä¹‹å‰ç®—æ³•çš„é—®é¢˜ åœ¨Prioritized Replay DQNä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºäº†å¾ˆå¤šç§DQNï¼Œæ¯”å¦‚Nature DQNï¼Œ DDQNç­‰ï¼Œä»–ä»¬éƒ½æ˜¯é€šè¿‡ç»éªŒå›æ”¾æ¥é‡‡æ ·ï¼Œè¿›è€Œåšç›®æ ‡Qå€¼çš„è®¡ç®—çš„ã€‚åœ¨é‡‡æ ·çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯ä¸€è§†åŒä»ï¼Œåœ¨ç»éªŒå›æ”¾æ± é‡Œé¢çš„æ‰€æœ‰çš„æ ·æœ¬éƒ½æœ‰ç›¸åŒçš„è¢«é‡‡æ ·åˆ°çš„æ¦‚ç‡ã€‚ ä½†æ˜¯æ³¨æ„åˆ°åœ¨ç»éªŒå›æ”¾æ± é‡Œé¢çš„ä¸åŒçš„æ ·æœ¬ç”±äºTDè¯¯å·®çš„ä¸åŒï¼Œå¯¹æˆ‘ä»¬åå‘ä¼ æ’­çš„ä½œç”¨æ˜¯ä¸ä¸€æ ·çš„ã€‚TDè¯¯å·®è¶Šå¤§ï¼Œé‚£ä¹ˆå¯¹æˆ‘ä»¬åå‘ä¼ æ’­çš„ä½œç”¨è¶Šå¤§ã€‚è€ŒTDè¯¯å·®å°çš„æ ·æœ¬ï¼Œç”±äºTDè¯¯å·®å°ï¼Œå¯¹åå‘æ¢¯åº¦çš„è®¡ç®—å½±å“ä¸å¤§ã€‚åœ¨Qç½‘ç»œä¸­ï¼ŒTDè¯¯å·®å°±æ˜¯ç›®æ ‡Qç½‘ç»œè®¡ç®—çš„ç›®æ ‡Qå€¼å’Œå½“å‰Qç½‘ç»œè®¡ç®—çš„Qå€¼ä¹‹é—´çš„å·®è·ã€‚ è¿™æ ·å¦‚æœTDè¯¯å·®çš„ç»å¯¹å€¼ $|Î´(t)|$è¾ƒå¤§çš„æ ·æœ¬æ›´å®¹æ˜“è¢«é‡‡æ ·ï¼Œåˆ™æˆ‘ä»¬çš„ç®—æ³•ä¼šæ¯”è¾ƒå®¹æ˜“æ”¶æ•›ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹Prioritized Replay DQNçš„ç®—æ³•æ€è·¯ã€‚ 2. Prioritized Replay DQNç®—æ³•çš„å»ºæ¨¡ Prioritized Replay DQNæ ¹æ®æ¯ä¸ªæ ·æœ¬çš„TDè¯¯å·®ç»å¯¹å€¼ $|Î´(t)|$ï¼Œç»™å®šè¯¥æ ·æœ¬çš„ä¼˜å…ˆçº§æ­£æ¯”äº $|Î´(t)|$ï¼Œå°†è¿™ä¸ªä¼˜å…ˆçº§çš„å€¼å­˜å…¥ç»éªŒå›æ”¾æ± ã€‚å›å¿†ä¸‹ä¹‹å‰çš„DQNç®—æ³•ï¼Œæˆ‘ä»¬ä»…ä»…åªä¿å­˜å’Œç¯å¢ƒäº¤äº’å¾—åˆ°çš„æ ·æœ¬çŠ¶æ€ï¼ŒåŠ¨ä½œï¼Œå¥–åŠ±ç­‰æ•°æ®ï¼Œæ²¡æœ‰ä¼˜å…ˆçº§è¿™ä¸ªè¯´æ³•ã€‚ ç”±äºå¼•å…¥äº†ç»éªŒå›æ”¾çš„ä¼˜å…ˆçº§ï¼Œé‚£ä¹ˆPrioritized Replay DQNçš„ç»éªŒå›æ”¾æ± å’Œä¹‹å‰çš„å…¶ä»–DQNç®—æ³•çš„ç»éªŒå›æ”¾æ± å°±ä¸ä¸€æ ·äº†ã€‚å› ä¸ºè¿™ä¸ªä¼˜å…ˆçº§å¤§å°ä¼šå½±å“å®ƒè¢«é‡‡æ ·çš„æ¦‚ç‡ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨SumTreeè¿™æ ·çš„äºŒå‰æ ‘ç»“æ„æ¥åšæˆ‘ä»¬çš„å¸¦ä¼˜å…ˆçº§çš„ç»éªŒå›æ”¾æ± æ ·æœ¬çš„å­˜å‚¨ã€‚ å…·ä½“çš„SumTreeæ ‘ç»“æ„å¦‚ä¸‹å›¾ï¼š sum_tree ç»“æ„å›¾ æ‰€æœ‰çš„ç»éªŒå›æ”¾æ ·æœ¬åªä¿å­˜åœ¨æœ€ä¸‹é¢çš„å¶å­èŠ‚ç‚¹ä¸Šé¢ï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸€ä¸ªæ ·æœ¬ã€‚å†…éƒ¨èŠ‚ç‚¹ä¸ä¿å­˜æ ·æœ¬æ•°æ®ã€‚è€Œå¶å­èŠ‚ç‚¹é™¤äº†ä¿å­˜æ•°æ®ä»¥å¤–ï¼Œè¿˜è¦ä¿å­˜è¯¥æ ·æœ¬çš„ä¼˜å…ˆçº§ï¼Œå°±æ˜¯å›¾ä¸­çš„æ˜¾ç¤ºçš„æ•°å­—ã€‚å¯¹äºå†…éƒ¨èŠ‚ç‚¹æ¯ä¸ªèŠ‚ç‚¹åªä¿å­˜è‡ªå·±çš„å„¿å­èŠ‚ç‚¹çš„ä¼˜å…ˆçº§å€¼ä¹‹å’Œï¼Œå¦‚å›¾ä¸­å†…éƒ¨èŠ‚ç‚¹ä¸Šæ˜¾ç¤ºçš„æ•°å­—ã€‚ è¿™æ ·ä¿å­˜æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿä¸»è¦æ˜¯æ–¹ä¾¿é‡‡æ ·ã€‚ä»¥ä¸Šé¢çš„æ ‘ç»“æ„ä¸ºä¾‹ï¼Œæ ¹èŠ‚ç‚¹æ˜¯42ï¼Œå¦‚æœè¦é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨[0,42]ä¹‹é—´åšå‡åŒ€é‡‡æ ·ï¼Œé‡‡æ ·åˆ°å“ªä¸ªåŒºé—´ï¼Œå°±æ˜¯å“ªä¸ªæ ·æœ¬ã€‚æ¯”å¦‚æˆ‘ä»¬é‡‡æ ·åˆ°äº†26ï¼Œ åœ¨ï¼ˆ25-29ï¼‰è¿™ä¸ªåŒºé—´ï¼Œé‚£ä¹ˆå°±æ˜¯ç¬¬å››ä¸ªå¶å­èŠ‚ç‚¹è¢«é‡‡æ ·åˆ°ã€‚è€Œæ³¨æ„åˆ°ç¬¬ä¸‰ä¸ªå¶å­èŠ‚ç‚¹ä¼˜å…ˆçº§æœ€é«˜ï¼Œæ˜¯12ï¼Œå®ƒçš„åŒºé—´13-25ä¹Ÿæ˜¯æœ€é•¿çš„ï¼Œä¼šæ¯”å…¶ä»–èŠ‚ç‚¹æ›´å®¹æ˜“è¢«é‡‡æ ·åˆ°ã€‚ å¦‚æœè¦é‡‡æ ·ä¸¤ä¸ªæ ·æœ¬ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨[0,21],[21,42]ä¸¤ä¸ªåŒºé—´åšå‡åŒ€é‡‡æ ·ï¼Œæ–¹æ³•å’Œä¸Šé¢é‡‡æ ·ä¸€ä¸ªæ ·æœ¬ç±»ä¼¼ã€‚ ç±»ä¼¼çš„é‡‡æ ·ç®—æ³•æ€æƒ³æˆ‘ä»¬åœ¨word2vecåŸç†(ä¸‰) åŸºäºNegative Samplingçš„æ¨¡å‹ç¬¬å››èŠ‚ä¸­ä¹Ÿæœ‰è®²åˆ°ã€‚ é™¤äº†ç»éªŒå›æ”¾æ± ï¼Œç°åœ¨æˆ‘ä»¬çš„Qç½‘ç»œçš„ç®—æ³•æŸå¤±å‡½æ•°ä¹Ÿæœ‰ä¼˜åŒ–ï¼Œä¹‹å‰æˆ‘ä»¬çš„æŸå¤±å‡½æ•°æ˜¯ï¼š $$\\frac1m\\sum_{j=1}^m(y_j-Q(\\phi(S_j),A_j,w))^2$$ ç°åœ¨æˆ‘ä»¬æ–°çš„è€ƒè™‘äº†æ ·æœ¬ä¼˜å…ˆçº§çš„æŸå¤±å‡½æ•°æ˜¯ $$\\frac1m\\sum_{j=1}^mw_j(y_j-Q(\\phi(S_j),A_j,w))^2$$ å…¶ä¸­ $w_j$æ˜¯ç¬¬jä¸ªæ ·æœ¬çš„ä¼˜å…ˆçº§æƒé‡ï¼Œç”±TDè¯¯å·® $|Î´(t)|$å½’ä¸€åŒ–å¾—åˆ°ã€‚ ç¬¬ä¸‰ä¸ªè¦æ³¨æ„çš„ç‚¹å°±æ˜¯å½“æˆ‘ä»¬å¯¹Qç½‘ç»œå‚æ•°è¿›è¡Œäº†æ¢¯åº¦æ›´æ–°åï¼Œéœ€è¦é‡æ–°è®¡ç®—TDè¯¯å·®ï¼Œå¹¶å°†TDè¯¯å·®æ›´æ–°åˆ°SunTreeä¸Šé¢ã€‚ é™¤äº†ä»¥ä¸Šä¸‰ä¸ªéƒ¨åˆ†ï¼ŒPrioritized Replay DQNå’ŒDDQNçš„ç®—æ³•æµç¨‹ç›¸åŒã€‚ 3. Prioritized Replay DQNç®—æ³•æµç¨‹ ä¸‹é¢æˆ‘ä»¬æ€»ç»“ä¸‹Prioritized Replay DQNçš„ç®—æ³•æµç¨‹ï¼ŒåŸºäºä¸Šä¸€èŠ‚çš„DDQNï¼Œå› æ­¤è¿™ä¸ªç®—æ³•æˆ‘ä»¬åº”è¯¥å«åšPrioritized Replay DDQNã€‚ä¸»æµç¨‹å‚è€ƒè®ºæ–‡(Prioritized Experience Replay)(ICLR 2016)ã€‚ ç®—æ³•è¾“å…¥ï¼šè¿­ä»£è½®æ•° $T$ï¼ŒçŠ¶æ€ç‰¹å¾ç»´åº¦ $n$, åŠ¨ä½œé›† $A$, æ­¥é•¿ $Î±$ï¼Œé‡‡æ ·æƒé‡ç³»æ•° $Î²$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, å½“å‰Qç½‘ç»œ $Q$ï¼Œç›®æ ‡Qç½‘ç»œ $Qâ€™$, æ‰¹é‡æ¢¯åº¦ä¸‹é™çš„æ ·æœ¬æ•° $m$,ç›®æ ‡Qç½‘ç»œå‚æ•°æ›´æ–°é¢‘ç‡ $C$, SumTreeçš„å¶å­èŠ‚ç‚¹æ•° $S$ã€‚ è¾“å‡ºï¼šQç½‘ç»œå‚æ•°ã€‚ éšæœºåˆå§‹åŒ–æ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œå¯¹åº”çš„ä»·å€¼ $Q$. éšæœºåˆå§‹åŒ–å½“å‰Qç½‘ç»œçš„æ‰€æœ‰å‚æ•° $w$,åˆå§‹åŒ–ç›®æ ‡Qç½‘ç»œ $Qâ€™$çš„å‚æ•° $wâ€™=w$ã€‚åˆå§‹åŒ–ç»éªŒå›æ”¾SumTreeçš„é»˜è®¤æ•°æ®ç»“æ„ï¼Œæ‰€æœ‰SumTreeçš„Sä¸ªå¶å­èŠ‚ç‚¹çš„ä¼˜å…ˆçº§ $p_j$ä¸º1ã€‚ for i from 1 to Tï¼Œè¿›è¡Œè¿­ä»£ã€‚ a) åˆå§‹åŒ–Sä¸ºå½“å‰çŠ¶æ€åºåˆ—çš„ç¬¬ä¸€ä¸ªçŠ¶æ€, æ‹¿åˆ°å…¶ç‰¹å¾å‘é‡ $Ï•(S)$ b) åœ¨Qç½‘ç»œä¸­ä½¿ç”¨ $Ï•(S)$ ä½œä¸ºè¾“å…¥ï¼Œå¾—åˆ°Qç½‘ç»œçš„æ‰€æœ‰åŠ¨ä½œå¯¹åº”çš„Qå€¼è¾“å‡ºã€‚ç”¨ $Ïµâˆ’$è´ªå©ªæ³•åœ¨å½“å‰Qå€¼è¾“å‡ºä¸­é€‰æ‹©å¯¹åº”çš„åŠ¨ä½œ $A$ c) åœ¨çŠ¶æ€ $S$ æ‰§è¡Œå½“å‰åŠ¨ä½œ $A$,å¾—åˆ°æ–°çŠ¶æ€ $Sâ€™$ å¯¹åº”çš„ç‰¹å¾å‘é‡ $Ï•(Sâ€™)$å’Œå¥–åŠ± $R$,æ˜¯å¦ç»ˆæ­¢çŠ¶æ€ is_end d) å°† ${Ï•(S),A,R,Ï•(Sâ€™),is_end}$è¿™ä¸ªäº”å…ƒç»„å­˜å…¥SumTree e) $S=S'$ f) ä»SumTreeä¸­é‡‡æ · $m$ ä¸ªæ ·æœ¬ ${Ï•(S_j),A_j,R_j,Ï•(Sâ€™_j),is_end_j},j=1,2.,,,m$ï¼Œæ¯ä¸ªæ ·æœ¬è¢«é‡‡æ ·çš„æ¦‚ç‡åŸºäº $P(j)=\\frac{p_j}{\\sum_i(p_i)}$ï¼ŒæŸå¤±å‡½æ•°æƒé‡ $w_j=(N*P(j))^{-\\beta}/\\max_i(w_i)$ï¼Œè®¡ç®—å½“å‰ç›®æ ‡Qå€¼ $y_j$: $$\\left.y_j=\\left\\\\{\\begin{matrix}R_j\u0026is_end_j\\textit{is true}\\\\\\\\R_j+\\gamma Q^{\\prime}(\\phi(S_j^{\\prime}),\\arg\\max_{a^{\\prime}}Q(\\phi(S_j^{\\prime}),a,w),w^{\\prime})\u0026is_end_j\\textit{is false}\\end{matrix}\\right.\\right.$$ g) ä½¿ç”¨å‡æ–¹å·®æŸå¤±å‡½æ•°$\\begin{aligned}\\frac{1}{m}\\sum_{j=1}^mw_j(y_j-Q(\\phi(S_j),A_j,w))^2\\end{aligned}$ï¼Œé€šè¿‡ç¥ç»ç½‘ç»œçš„æ¢¯åº¦åå‘ä¼ æ’­æ¥æ›´æ–°Qç½‘ç»œçš„æ‰€æœ‰å‚æ•° $w$ h) é‡æ–°è®¡ç®—æ‰€æœ‰æ ·æœ¬çš„TDè¯¯å·® $\\delta_j=y_j-Q(\\phi(S_j),A_j,w)$ï¼Œæ›´æ–°SumTreeä¸­æ‰€æœ‰èŠ‚ç‚¹çš„ä¼˜å…ˆçº§ $p_j=|\\delta_j|$ i) å¦‚æœi%C=1,åˆ™æ›´æ–°ç›®æ ‡Qç½‘ç»œå‚æ•° $wâ€™=w$ j) å¦‚æœ $Sâ€™$æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œå½“å‰è½®è¿­ä»£å®Œæ¯•ï¼Œå¦åˆ™è½¬åˆ°æ­¥éª¤b) æ³¨æ„ï¼Œä¸Šè¿°ç¬¬äºŒæ­¥çš„fæ­¥å’Œgæ­¥çš„Qå€¼è®¡ç®—ä¹Ÿéƒ½éœ€è¦é€šè¿‡Qç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚å¦å¤–ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œä¸ºäº†ç®—æ³•è¾ƒå¥½çš„æ”¶æ•›ï¼Œæ¢ç´¢ç‡$Ïµ$éœ€è¦éšç€è¿­ä»£çš„è¿›è¡Œè€Œå˜å°ã€‚ 4. Prioritized Replay DDQNç®—æ³•æµç¨‹ ä¸‹é¢æˆ‘ä»¬ç»™å‡ºPrioritized Replay DDQNç®—æ³•çš„å®ä¾‹ä»£ç ã€‚ä»ç„¶ä½¿ç”¨äº†OpenAI Gymä¸­çš„CartPole-v0æ¸¸æˆæ¥ä½œä¸ºæˆ‘ä»¬ç®—æ³•åº”ç”¨ã€‚CartPole-v0æ¸¸æˆçš„ä»‹ç»å‚è§è¿™é‡Œã€‚å®ƒæ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬è¦æ±‚å°±æ˜¯æ§åˆ¶ä¸‹é¢çš„cartç§»åŠ¨ä½¿è¿æ¥åœ¨ä¸Šé¢çš„poleä¿æŒå‚ç›´ä¸å€’ã€‚è¿™ä¸ªä»»åŠ¡åªæœ‰ä¸¤ä¸ªç¦»æ•£åŠ¨ä½œï¼Œè¦ä¹ˆå‘å·¦ç”¨åŠ›ï¼Œè¦ä¹ˆå‘å³ç”¨åŠ›ã€‚è€ŒstateçŠ¶æ€å°±æ˜¯è¿™ä¸ªcartçš„ä½ç½®å’Œé€Ÿåº¦ï¼Œ poleçš„è§’åº¦å’Œè§’é€Ÿåº¦ï¼Œ4ç»´çš„ç‰¹å¾ã€‚åšæŒåˆ°200åˆ†çš„å¥–åŠ±åˆ™ä¸ºè¿‡å…³ã€‚ å®Œæ•´çš„ä»£ç å‚è§æˆ‘çš„github: https://github.com/ljpzzz/machinelearning/blob/master/reinforcement-learning/ddqn_prioritised_replay.pyï¼Œ ä»£ç ä¸­çš„SumTreeçš„ç»“æ„å’Œç»éªŒå›æ”¾æ± çš„ç»“æ„å‚è€ƒäº†morvanzhouçš„githubä»£ç ã€‚ è¿™é‡Œé‡ç‚¹è®²ä¸‹å’Œç¬¬ä¸‰èŠ‚ä¸­ç®—æ³•æè¿°ä¸åŒçš„åœ°æ–¹ï¼Œä¸»è¦æ˜¯ $w_j$çš„è®¡ç®—ã€‚æ³¨æ„åˆ°ï¼š $$w_j=\\frac{(NP(j))^{-\\beta}}{\\max_i(w_i)}=\\frac{(NP(j))^{-\\beta}}{\\max_i((N*P(i))^{-\\beta})}=\\frac{(P(j))^{-\\beta}}{\\max_i((P(i))^{-\\beta})}=(\\frac{P_j}{\\min_iP(i)})^{-\\beta}$$ å› æ­¤ä»£ç é‡Œé¢$w_j$ï¼Œå³ISWeightsçš„è®¡ç®—ä»£ç æ˜¯è¿™æ ·çš„ï¼š def sample(self, n): b_idx, b_memory, ISWeights = np.empty((n,), dtype=np.int32), np.empty((n, self.tree.data[0].size)), np.empty((n, 1)) pri_seg = self.tree.total_p / n # priority segment","date":"2024-02-25","objectID":"/posts/rl_learning_note_11/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [11] | Prioritized Replay DQN","uri":"/posts/rl_learning_note_11/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆä¹ï¼‰Deep Q-Learningè¿›é˜¶ä¹‹Nature DQNä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†Nature DQNçš„ç®—æ³•æµç¨‹ï¼Œå®ƒé€šè¿‡ä½¿ç”¨ä¸¤ä¸ªç›¸åŒçš„ç¥ç»ç½‘ç»œï¼Œä»¥è§£å†³æ•°æ®æ ·æœ¬å’Œç½‘ç»œè®­ç»ƒä¹‹å‰çš„ç›¸å…³æ€§ã€‚ä½†æ˜¯è¿˜æ˜¯æœ‰å…¶ä»–å€¼å¾—ä¼˜åŒ–çš„ç‚¹ï¼Œæ–‡æœ¬å°±å…³æ³¨äºNature DQNçš„ä¸€ä¸ªæ”¹è¿›ç‰ˆæœ¬: Double DQNç®—æ³•ï¼ˆä»¥ä¸‹ç®€ç§°DDQNï¼‰ã€‚ æœ¬ç« å†…å®¹ä¸»è¦å‚è€ƒäº†ICML 2016çš„deep RL tutorialå’ŒDDQNçš„è®ºæ–‡(Deep Reinforcement Learning with Double Q-learning)ã€‚ 1. DQNçš„ç›®æ ‡Qå€¼è®¡ç®—é—®é¢˜ åœ¨DDQNä¹‹å‰ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„ç›®æ ‡Qå€¼éƒ½æ˜¯é€šè¿‡è´ªå©ªæ³•ç›´æ¥å¾—åˆ°çš„ï¼Œæ— è®ºæ˜¯Q-Learningï¼Œ DQN(NIPS 2013)è¿˜æ˜¯ Nature DQNï¼Œéƒ½æ˜¯å¦‚æ­¤ã€‚æ¯”å¦‚å¯¹äºNature DQN,è™½ç„¶ç”¨äº†ä¸¤ä¸ªQç½‘ç»œå¹¶ä½¿ç”¨ç›®æ ‡Qç½‘ç»œè®¡ç®—Qå€¼ï¼Œå…¶ç¬¬jä¸ªæ ·æœ¬çš„ç›®æ ‡Qå€¼çš„è®¡ç®—è¿˜æ˜¯è´ªå©ªæ³•å¾—åˆ°çš„ï¼Œè®¡ç®—å¦‚ä¸‹å¼: $$\\left.y_j=\\left{\\begin{array}{ll}R_j\u0026is_end_j\\textit{ is true}\\R_j+\\gamma\\max_{a^{\\prime}}Q^{\\prime}(\\phi(S_j^{\\prime}),A_j^{\\prime},w^{\\prime})\u0026is_end_j\\textit{ is false}\\end{array}\\right.\\right.$$ ä½¿ç”¨maxè™½ç„¶å¯ä»¥å¿«é€Ÿè®©Qå€¼å‘å¯èƒ½çš„ä¼˜åŒ–ç›®æ ‡é æ‹¢ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“è¿‡çŠ¹ä¸åŠï¼Œå¯¼è‡´è¿‡åº¦ä¼°è®¡(Over Estimation)ï¼Œæ‰€è°“è¿‡åº¦ä¼°è®¡å°±æ˜¯æœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„ç®—æ³•æ¨¡å‹æœ‰å¾ˆå¤§çš„åå·®(bias)ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ DDQNé€šè¿‡è§£è€¦ç›®æ ‡Qå€¼åŠ¨ä½œçš„é€‰æ‹©å’Œç›®æ ‡Qå€¼çš„è®¡ç®—è¿™ä¸¤æ­¥ï¼Œæ¥è¾¾åˆ°æ¶ˆé™¤è¿‡åº¦ä¼°è®¡çš„é—®é¢˜ã€‚ 2. DDQNçš„ç®—æ³•å»ºæ¨¡ DDQNå’ŒNature DQNä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸€æ ·çš„ä¸¤ä¸ªQç½‘ç»œç»“æ„ã€‚åœ¨Nature DQNçš„åŸºç¡€ä¸Šï¼Œé€šè¿‡è§£è€¦ç›®æ ‡Qå€¼åŠ¨ä½œçš„é€‰æ‹©å’Œç›®æ ‡Qå€¼çš„è®¡ç®—è¿™ä¸¤æ­¥ï¼Œæ¥æ¶ˆé™¤è¿‡åº¦ä¼°è®¡çš„é—®é¢˜ã€‚ åœ¨ä¸Šä¸€èŠ‚é‡Œï¼ŒNature DQNå¯¹äºéç»ˆæ­¢çŠ¶æ€ï¼Œå…¶ç›®æ ‡Qå€¼çš„è®¡ç®—å¼å­æ˜¯ï¼š $$y_j=R_j+\\gamma\\max_{a^{\\prime}}Q^{\\prime}(\\phi(S_j^{\\prime}),A_j^{\\prime},w^{\\prime})$$ åœ¨DDQN(Double DQN)è¿™é‡Œï¼Œä¸å†æ˜¯ç›´æ¥åœ¨ç›®æ ‡Qç½‘ç»œé‡Œé¢æ‰¾å„ä¸ªåŠ¨ä½œä¸­æœ€å¤§Qå€¼ï¼Œè€Œæ˜¯å…ˆåœ¨å½“å‰Qç½‘ç»œä¸­å…ˆæ‰¾å‡ºæœ€å¤§Qå€¼å¯¹åº”çš„åŠ¨ä½œï¼Œå³: $$a^{max}(S_j^{\\prime},w)=\\arg\\max_{a^{\\prime}}Q(\\phi(S_j^{\\prime}),a,w)$$ ç„¶ååˆ©ç”¨è¿™ä¸ªé€‰æ‹©å‡ºæ¥çš„åŠ¨ä½œ $\\begin{aligned}\u0026a^{max}(S_j^{\\prime},w)\\end{aligned}$ åœ¨ç›®æ ‡ç½‘ç»œé‡Œé¢å»è®¡ç®—ç›®æ ‡Qå€¼ã€‚å³ï¼š $$y_j=R_j+\\gamma Q^{\\prime}(\\phi(S_j^{\\prime}),a^{max}(S_j^{\\prime},w),w^{\\prime})$$ ç»¼åˆèµ·æ¥å†™å°±æ˜¯ï¼š $$y_j=R_j+\\gamma Q^{\\prime}(\\phi(S_j^{\\prime}),\\arg\\max_{a^{\\prime}}Q(\\phi(S_j^{\\prime}),a,w),w^{\\prime})$$ é™¤äº†ç›®æ ‡Qå€¼çš„è®¡ç®—æ–¹å¼ä»¥å¤–ï¼ŒDDQNç®—æ³•å’ŒNature DQNçš„ç®—æ³•æµç¨‹å®Œå…¨ç›¸åŒã€‚ 3. DDQNç®—æ³•æµç¨‹ è¿™é‡Œæˆ‘ä»¬æ€»ç»“ä¸‹DDQNçš„ç®—æ³•æµç¨‹ï¼Œå’ŒNature DQNçš„åŒºåˆ«ä»…ä»…åœ¨æ­¥éª¤2.fä¸­ç›®æ ‡Qå€¼çš„è®¡ç®—ã€‚ ç®—æ³•è¾“å…¥ï¼šè¿­ä»£è½®æ•° $T$ï¼ŒçŠ¶æ€ç‰¹å¾ç»´åº¦ $n$, åŠ¨ä½œé›† $A$, æ­¥é•¿ $Î±$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, å½“å‰Qç½‘ç»œ $Q$ï¼Œç›®æ ‡Qç½‘ç»œ $Qâ€™$, æ‰¹é‡æ¢¯åº¦ä¸‹é™çš„æ ·æœ¬ $m$,ç›®æ ‡Qç½‘ç»œå‚æ•°æ›´æ–°é¢‘ $C$ã€‚ è¾“å‡ºï¼šQç½‘ç»œå‚æ•° éšæœºåˆå§‹åŒ–æ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œå¯¹åº”çš„ä»·å€¼ $Q$. éšæœºåˆå§‹åŒ–å½“å‰Qç½‘ç»œçš„æ‰€æœ‰å‚æ•° $w$,åˆå§‹åŒ–ç›®æ ‡Qç½‘ç»œ $Qâ€™çš„å‚æ•° $wâ€²=w$ ã€‚æ¸…ç©ºç»éªŒå›æ”¾çš„é›†åˆ $D$ã€‚ for i from 1 to Tï¼Œè¿›è¡Œè¿­ä»£ã€‚ a) åˆå§‹åŒ– $S$ä¸ºå½“å‰çŠ¶æ€åºåˆ—çš„ç¬¬ä¸€ä¸ªçŠ¶æ€, æ‹¿åˆ°å…¶ç‰¹å¾å‘é‡ $Ï•(S)$ b) åœ¨Qç½‘ç»œä¸­ä½¿ç”¨ $Ï•(S)$ä½œä¸ºè¾“å…¥ï¼Œå¾—åˆ°Qç½‘ç»œçš„æ‰€æœ‰åŠ¨ä½œå¯¹åº”çš„Qå€¼è¾“å‡ºã€‚ç”¨ $Ïµâˆ’$è´ªå©ªæ³•åœ¨å½“å‰Qå€¼è¾“å‡ºä¸­é€‰æ‹©å¯¹åº”çš„åŠ¨ä½œ $A$ c) åœ¨çŠ¶æ€ $S$æ‰§è¡Œå½“å‰åŠ¨ä½œ $A$,å¾—åˆ°æ–°çŠ¶æ€ $Sâ€™$å¯¹åº”çš„ç‰¹å¾å‘é‡ $Ï•(Sâ€™)$ å’Œå¥–åŠ± $R$,æ˜¯å¦ç»ˆæ­¢çŠ¶æ€ is_end d) å°† ${Ï•(S),A,R,Ï•(Sâ€²),is_end} $,è¿™ä¸ªäº”å…ƒç»„å­˜å…¥ç»éªŒå›æ”¾é›†åˆ $D$ e) $S=S'$ f) ä»ç»éªŒå›æ”¾é›†åˆ $D$ ä¸­é‡‡æ · $m$ ä¸ªæ ·æœ¬ ${Ï•(S_j),A_j,R_j,Ï•(Sâ€™_j),is_end_j},j=1,2.,,,m$, è®¡ç®—å½“å‰ç›®æ ‡Qå€¼ $y_j$: $$\\left.y_j=\\left{\\begin{array}{ll}R_j\u0026is_end_j\\textit{ is true}\\R_j+\\gamma Q^{\\prime}(\\phi(S_j^{\\prime}),\\arg\\max_{a^{\\prime}}Q(\\phi(S_j^{\\prime}),a,w),w^{\\prime})\u0026is_end_j\\textit{ is false}\\end{array}\\right.\\right.$$ g) ä½¿ç”¨å‡æ–¹å·®æŸå¤±å‡½æ•°$\\frac1m\\sum_{j=1}^m(y_j-Q(\\phi(S_j),A_j,w))^2$ï¼Œé€šè¿‡ç¥ç»ç½‘ç»œçš„æ¢¯åº¦åå‘ä¼ æ’­æ¥æ›´æ–°Qç½‘ç»œçš„æ‰€æœ‰å‚æ•°wï¿½ h) å¦‚æœ $i%C=1$,åˆ™æ›´æ–°ç›®æ ‡Qç½‘ç»œå‚æ•° $wâ€™=w$ i) å¦‚æœ $Sâ€™$æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œå½“å‰è½®è¿­ä»£å®Œæ¯•ï¼Œå¦åˆ™è½¬åˆ°æ­¥éª¤b) æ³¨æ„ï¼Œä¸Šè¿°ç¬¬äºŒæ­¥çš„fæ­¥å’Œgæ­¥çš„Qå€¼è®¡ç®—ä¹Ÿéƒ½éœ€è¦é€šè¿‡Qç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚å¦å¤–ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œä¸ºäº†ç®—æ³•è¾ƒå¥½çš„æ”¶æ•›ï¼Œæ¢ç´¢ç‡ $Ïµ$éœ€è¦éšç€è¿­ä»£çš„è¿›è¡Œè€Œå˜å°ã€‚ 4. DDQNç®—æ³•å®ä¾‹ã€€ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥æ¼”ç¤ºDQNçš„åº”ç”¨ã€‚ä»ç„¶ä½¿ç”¨äº†OpenAI Gymä¸­çš„CartPole-v0æ¸¸æˆæ¥ä½œä¸ºæˆ‘ä»¬ç®—æ³•åº”ç”¨ã€‚CartPole-v0æ¸¸æˆçš„ä»‹ç»å‚è§è¿™é‡Œã€‚å®ƒæ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬è¦æ±‚å°±æ˜¯æ§åˆ¶ä¸‹é¢çš„cartç§»åŠ¨ä½¿è¿æ¥åœ¨ä¸Šé¢çš„poleä¿æŒå‚ç›´ä¸å€’ã€‚è¿™ä¸ªä»»åŠ¡åªæœ‰ä¸¤ä¸ªç¦»æ•£åŠ¨ä½œï¼Œè¦ä¹ˆå‘å·¦ç”¨åŠ›ï¼Œè¦ä¹ˆå‘å³ç”¨åŠ›ã€‚è€ŒstateçŠ¶æ€å°±æ˜¯è¿™ä¸ªcartçš„ä½ç½®å’Œé€Ÿåº¦ï¼Œ poleçš„è§’åº¦å’Œè§’é€Ÿåº¦ï¼Œ4ç»´çš„ç‰¹å¾ã€‚åšæŒåˆ°200åˆ†çš„å¥–åŠ±åˆ™ä¸ºè¿‡å…³ã€‚ å®Œæ•´çš„ä»£ç å‚è§github: https://github.com/ljpzzz/machinelearning/blob/master/reinforcement-learning/ddqn.py è¿™é‡Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨DDQNå’Œä¸Šä¸€èŠ‚çš„Nature DQNçš„ä»£ç çš„ä¸åŒä¹‹å¤„ã€‚ä»£ç åªæœ‰ä¸€ä¸ªåœ°æ–¹ä¸ä¸€æ ·ï¼Œå°±æ˜¯è®¡ç®—ç›®æ ‡Qå€¼çš„æ—¶å€™ï¼Œå¦‚ä¸‹ï¼š # Step 2: calculate y y_batch = [] current_Q_batch = self.Q_value.eval(feed_dict={self.state_input: next_state_batch}) max_action_next = np.argmax(current_Q_batch, axis=1) target_Q_batch = self.target_Q_value.eval(feed_dict={self.state_input: next_state_batch}) for i in range(0,BATCH_SIZE): done = minibatch[i][4] if done: y_batch.append(reward_batch[i]) else : target_Q_value = target_Q_batch[i, max_action_next[i]] y_batch.append(reward_batch[i] + GAMMA * target_Q_value) è€Œä¹‹å‰çš„Nature DQNè¿™é‡Œçš„ç›®æ ‡Qå€¼è®¡ç®—æ˜¯å¦‚ä¸‹è¿™æ ·çš„ï¼š # Step 2: calculate y y_batch = [] Q_value_batch = self.target_Q_value.eval(feed_dict={self.state_input:next_state_batch}) for i in range(0,BATCH_SIZE): done = minibatch[i][4] if done: y_batch.append(reward_batch[i]) else : y_batch.append(reward_batch[i] + GAMMA * np.max(Q_value_batch[i])) é™¤äº†ä¸Šé¢è¿™éƒ¨åˆ†çš„åŒºåˆ«ï¼Œä¸¤ä¸ªç®—æ³•çš„ä»£ç å®Œå…¨ç›¸åŒã€‚ 5. DDQNå°ç»“ DDQNç®—æ³•å‡ºæ¥ä»¥åï¼Œå–å¾—äº†æ¯”è¾ƒå¥½çš„æ•ˆæœï¼Œå› æ­¤å¾—åˆ°äº†æ¯”è¾ƒå¹¿æ³›çš„åº”ç”¨ã€‚ä¸è¿‡æˆ‘ä»¬çš„DQNä»ç„¶æœ‰å…¶ä»–å¯ä»¥ä¼˜åŒ–çš„ç‚¹ï¼Œå¦‚ä¸Šä¸€ç¯‡æœ€åè®²åˆ°çš„: éšæœºé‡‡æ ·çš„æ–¹æ³•å¥½å—ï¼ŸæŒ‰é“ç†ç»éªŒå›æ”¾é‡Œä¸åŒæ ·æœ¬çš„é‡è¦æ€§æ˜¯ä¸ä¸€æ ·çš„ï¼ŒTDè¯¯å·®å¤§çš„æ ·æœ¬é‡è¦ç¨‹åº¦åº”è¯¥é«˜ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚çš„Prioritised Replay DQNä¸­è®¨è®ºã€‚ ","date":"2024-02-23","objectID":"/posts/rl_learning_note_10/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [10] | Double DQN (DDQN)","uri":"/posts/rl_learning_note_10/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆå…«ï¼‰ä»·å€¼å‡½æ•°çš„è¿‘ä¼¼è¡¨ç¤ºä¸Deep Q-Learningä¸­ï¼Œæˆ‘ä»¬è®²åˆ°äº†Deep Q-Learningï¼ˆNIPS 2013ï¼‰çš„ç®—æ³•å’Œä»£ç ï¼Œåœ¨è¿™ä¸ªç®—æ³•åŸºç¡€ä¸Šï¼Œæœ‰å¾ˆå¤šDeep Q-Learning(ä»¥ä¸‹ç®€ç§°DQN)çš„æ”¹è¿›ç‰ˆï¼Œä»Šå¤©æˆ‘ä»¬æ¥è®¨è®ºDQNçš„ç¬¬ä¸€ä¸ªæ”¹è¿›ç‰ˆNature DQN(NIPS 2015)ã€‚ æœ¬ç« å†…å®¹ä¸»è¦å‚è€ƒäº†ICML 2016çš„deep RL tutorialå’ŒNature DQNçš„è®ºæ–‡ã€‚ 1. DQN(NIPS 2013)çš„é—®é¢˜ åœ¨ä¸Šä¸€ç¯‡æˆ‘ä»¬å·²ç»è®¨è®ºäº†DQN(NIPS 2013)çš„ç®—æ³•åŸç†å’Œä»£ç å®ç°ï¼Œè™½ç„¶å®ƒå¯ä»¥è®­ç»ƒåƒCartPoleè¿™æ ·çš„ç®€å•æ¸¸æˆï¼Œä½†æ˜¯æœ‰å¾ˆå¤šé—®é¢˜ã€‚è¿™é‡Œæˆ‘ä»¬å…ˆè®¨è®ºç¬¬ä¸€ä¸ªé—®é¢˜ã€‚ æ³¨æ„åˆ°DQN(NIPS 2013)é‡Œé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ç›®æ ‡ $Q$å€¼çš„è®¡ç®—æ–¹å¼ï¼š $$\\left.y_j=\\left\\\\{\\begin{array}{ll}R_j\u0026is_end_j\\textit{ is true}\\\\\\\\R_j+\\gamma\\max_{a^{\\prime}}Q(\\phi(S_j^{\\prime}),A_j^{\\prime},w)\u0026is_end_j\\textit{ is false}\\end{array}\\right.\\right.$$ è¿™é‡Œç›®æ ‡Qå€¼çš„è®¡ç®—ä½¿ç”¨åˆ°äº†å½“å‰è¦è®­ç»ƒçš„Qç½‘ç»œå‚æ•°æ¥è®¡ç®—$Q(\\phi(S_j^{\\prime}),A_j^{\\prime},w)$ï¼Œè€Œå®é™…ä¸Šï¼Œæˆ‘ä»¬åˆå¸Œæœ›é€šè¿‡ $y_j$æ¥åç»­æ›´æ–° $Q$ç½‘ç»œå‚æ•°ã€‚è¿™æ ·ä¸¤è€…å¾ªç¯ä¾èµ–ï¼Œè¿­ä»£èµ·æ¥ä¸¤è€…çš„ç›¸å…³æ€§å°±å¤ªå¼ºäº†ã€‚ä¸åˆ©äºç®—æ³•çš„æ”¶æ•›ã€‚ å› æ­¤ï¼Œä¸€ä¸ªæ”¹è¿›ç‰ˆçš„DQN: Nature DQNå°è¯•ç”¨ä¸¤ä¸ªQç½‘ç»œæ¥å‡å°‘ç›®æ ‡Qå€¼è®¡ç®—å’Œè¦æ›´æ–°Qç½‘ç»œå‚æ•°ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹Nature DQNæ˜¯æ€ä¹ˆåšçš„ã€‚ 2. Nature DQNçš„å»ºæ¨¡ Nature DQNçš„ä¸¤ä¸ªQç½‘ç»œåˆ†åˆ«å‘½åä¸ºå½“å‰Qç½‘ç»œå’Œç›®æ ‡Qç½‘ç»œã€‚ Nature DQNä½¿ç”¨äº†ä¸¤ä¸ªQç½‘ç»œï¼Œä¸€ä¸ªå½“å‰Qç½‘ç»œ$Q$ç”¨æ¥é€‰æ‹©åŠ¨ä½œï¼Œæ›´æ–°æ¨¡å‹å‚æ•°ï¼Œå¦ä¸€ä¸ªç›®æ ‡Qç½‘ç»œ $Qâ€™$ç”¨äºè®¡ç®—ç›®æ ‡Qå€¼ã€‚ç›®æ ‡Qç½‘ç»œçš„ç½‘ç»œå‚æ•°ä¸éœ€è¦è¿­ä»£æ›´æ–°ï¼Œè€Œæ˜¯æ¯éš”ä¸€æ®µæ—¶é—´ä»å½“å‰Qç½‘ç»œ$Q$å¤åˆ¶è¿‡æ¥ï¼Œå³å»¶æ—¶æ›´æ–°ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ç›®æ ‡Qå€¼å’Œå½“å‰çš„Qå€¼ç›¸å…³æ€§ã€‚ è¦æ³¨æ„çš„æ˜¯ï¼Œä¸¤ä¸ªQç½‘ç»œçš„ç»“æ„æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚è¿™æ ·æ‰å¯ä»¥å¤åˆ¶ç½‘ç»œå‚æ•°ã€‚ Nature DQNå’Œä¸Šä¸€ç¯‡çš„DQNç›¸æ¯”ï¼Œé™¤äº†ç”¨ä¸€ä¸ªæ–°çš„ç›¸åŒç»“æ„çš„ç›®æ ‡Qç½‘ç»œæ¥è®¡ç®—ç›®æ ‡Qå€¼ä»¥å¤–ï¼Œå…¶ä½™éƒ¨åˆ†åŸºæœ¬æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚ 3. Nature DQNçš„ç®—æ³•æµç¨‹ ä¸‹é¢æˆ‘ä»¬æ¥æ€»ç»“ä¸‹Nature DQNçš„ç®—æ³•æµç¨‹ï¼Œ åŸºäºDQN NIPS 2015ï¼š ç®—æ³•è¾“å…¥ï¼šè¿­ä»£è½®æ•° $T$ï¼ŒçŠ¶æ€ç‰¹å¾ç»´åº¦ $n$, åŠ¨ä½œé›† $A$, æ­¥é•¿ $Î±$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, å½“å‰Qç½‘ç»œ $Q$ï¼Œç›®æ ‡Qç½‘ç»œ $Qâ€™$, æ‰¹é‡æ¢¯åº¦ä¸‹é™çš„æ ·æœ¬æ•° $m$,ç›®æ ‡Qç½‘ç»œå‚æ•°æ›´æ–°é¢‘ç‡$C$ã€‚ è¾“å‡ºï¼š$Q$ç½‘ç»œå‚æ•° éšæœºåˆå§‹åŒ–æ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œå¯¹åº”çš„ä»·å€¼ $Q$. éšæœºåˆå§‹åŒ–å½“å‰Qç½‘ç»œçš„æ‰€æœ‰å‚æ•° $w$,åˆå§‹åŒ–ç›®æ ‡Qç½‘ç»œ $Qâ€™$çš„å‚æ•° $wâ€™=w$ã€‚æ¸…ç©ºç»éªŒå›æ”¾çš„é›†åˆ $D$ã€‚ for i from 1 to Tï¼Œè¿›è¡Œè¿­ä»£ã€‚ a) åˆå§‹åŒ–Sä¸ºå½“å‰çŠ¶æ€åºåˆ—çš„ç¬¬ä¸€ä¸ªçŠ¶æ€, æ‹¿åˆ°å…¶ç‰¹å¾å‘é‡ $Ï•(S)$ b) åœ¨Qç½‘ç»œä¸­ä½¿ç”¨ $Ï•(S)$ä½œä¸ºè¾“å…¥ï¼Œå¾—åˆ°Qç½‘ç»œçš„æ‰€æœ‰åŠ¨ä½œå¯¹åº”çš„Qå€¼è¾“å‡ºã€‚ç”¨ $Ïµâˆ’$è´ªå©ªæ³•åœ¨å½“å‰Qå€¼è¾“å‡ºä¸­é€‰æ‹©å¯¹åº”çš„åŠ¨ä½œ $A$ c) åœ¨çŠ¶æ€ $S$ æ‰§è¡Œå½“å‰åŠ¨ä½œ $A$,å¾—åˆ°æ–°çŠ¶æ€ $Sâ€™$ å¯¹åº”çš„ç‰¹å¾å‘é‡ $Ï•(Sâ€™)$ å’Œå¥–åŠ± $R$,æ˜¯å¦ç»ˆæ­¢çŠ¶æ€is_end d) å°† $\\\\{Ï•(S),A,R,Ï•(Sâ€²),is_end\\\\}$è¿™ä¸ªäº”å…ƒç»„å­˜å…¥ç»éªŒå›æ”¾é›†åˆ $D$ e) $S=S'$ f) ä»ç»éªŒå›æ”¾é›†åˆ $D$ ä¸­é‡‡æ · $m$ ä¸ªæ ·æœ¬ ${Ï•(S_j),A_j,R_j,Ï•(Sâ€™_j),is_end_j},j=1,2.,,,m$ï¼Œè®¡ç®—å½“å‰ç›®æ ‡Qå€¼ $y_j$ï¼š $$\\left.y_j=\\left\\\\{\\begin{array}{ll}R_j\u0026is_end_j\\textit{ is true}\\\\\\\\R_j+\\gamma\\max_{a^{\\prime}}Q^{\\prime}(\\phi(S_j^{\\prime}),A_j^{\\prime},w^{\\prime})\u0026is_end_j\\textit{ is false}\\end{array}\\right.\\right.$$ g) ä½¿ç”¨å‡æ–¹å·®æŸå¤±å‡½æ•° $\\frac1m\\sum_{j=1}^m(y_j-Q(\\phi(S_j),A_j,w))^2$ï¼Œé€šè¿‡ç¥ç»ç½‘ç»œçš„æ¢¯åº¦åå‘ä¼ æ’­æ¥æ›´æ–°Qç½‘ç»œçš„æ‰€æœ‰å‚æ•° $w$ h) å¦‚æœ $i%C=1$, åˆ™æ›´æ–°ç›®æ ‡Qç½‘ç»œå‚æ•° $wâ€™=w$ i) å¦‚æœ $Sâ€™$æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œå½“å‰è½®è¿­ä»£å®Œæ¯•ï¼Œå¦åˆ™è½¬åˆ°æ­¥éª¤b) æ³¨æ„ï¼Œä¸Šè¿°ç¬¬äºŒæ­¥çš„fæ­¥å’Œgæ­¥çš„Qå€¼è®¡ç®—ä¹Ÿéƒ½éœ€è¦é€šè¿‡Qç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚å¦å¤–ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œä¸ºäº†ç®—æ³•è¾ƒå¥½çš„æ”¶æ•›ï¼Œæ¢ç´¢ç‡ $Ïµ$ éœ€è¦éšç€è¿­ä»£çš„è¿›è¡Œè€Œå˜å°ã€‚ 4. Nature DQNç®—æ³•å®ä¾‹ ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥æ¼”ç¤ºDQNçš„åº”ç”¨ã€‚ä»ç„¶ä½¿ç”¨äº†OpenAI Gymä¸­çš„CartPole-v0æ¸¸æˆæ¥ä½œä¸ºæˆ‘ä»¬ç®—æ³•åº”ç”¨ã€‚CartPole-v0æ¸¸æˆçš„ä»‹ç»å‚è§è¿™é‡Œã€‚å®ƒæ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬è¦æ±‚å°±æ˜¯æ§åˆ¶ä¸‹é¢çš„cartç§»åŠ¨ä½¿è¿æ¥åœ¨ä¸Šé¢çš„poleä¿æŒå‚ç›´ä¸å€’ã€‚è¿™ä¸ªä»»åŠ¡åªæœ‰ä¸¤ä¸ªç¦»æ•£åŠ¨ä½œï¼Œè¦ä¹ˆå‘å·¦ç”¨åŠ›ï¼Œè¦ä¹ˆå‘å³ç”¨åŠ›ã€‚è€ŒstateçŠ¶æ€å°±æ˜¯è¿™ä¸ªcartçš„ä½ç½®å’Œé€Ÿåº¦ï¼Œ poleçš„è§’åº¦å’Œè§’é€Ÿåº¦ï¼Œ4ç»´çš„ç‰¹å¾ã€‚åšæŒåˆ°200åˆ†çš„å¥–åŠ±åˆ™ä¸ºè¿‡å…³ã€‚ å®Œæ•´çš„ä»£ç å‚è§github: https://github.com/ljpzzz/machinelearning/blob/master/reinforcement-learning/nature_dqn.py è¿™é‡Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨Nature DQNå’Œä¸Šä¸€èŠ‚çš„NIPS 2013 DQNçš„ä»£ç çš„ä¸åŒä¹‹å¤„ã€‚ é¦–å…ˆæ˜¯Qç½‘ç»œï¼Œä¸Šä¸€ç¯‡çš„DQNæ˜¯ä¸€ä¸ªä¸‰å±‚çš„ç¥ç»ç½‘ç»œï¼Œè€Œè¿™é‡Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªä¸€æ ·çš„ä¸‰å±‚ç¥ç»ç½‘ç»œï¼Œä¸€ä¸ªæ˜¯å½“å‰Qç½‘ç»œï¼Œä¸€ä¸ªæ˜¯ç›®æ ‡Qç½‘ç»œï¼Œç½‘ç»œçš„å®šä¹‰éƒ¨åˆ†å¦‚ä¸‹ï¼š def create_Q_network(self): # input layer self.state_input = tf.placeholder(\"float\", [None, self.state_dim]) # network weights with tf.variable_scope('current_net'): W1 = self.weight_variable([self.state_dim,20]) b1 = self.bias_variable([20]) W2 = self.weight_variable([20,self.action_dim]) b2 = self.bias_variable([self.action_dim]) # hidden layers h_layer = tf.nn.relu(tf.matmul(self.state_input,W1) + b1) # Q Value layer self.Q_value = tf.matmul(h_layer,W2) + b2 with tf.variable_scope('target_net'): W1t = self.weight_variable([self.state_dim,20]) b1t = self.bias_variable([20]) W2t = self.weight_variable([20,self.action_dim]) b2t = self.bias_variable([self.action_dim]) # hidden layers h_layer_t = tf.nn.relu(tf.matmul(self.state_input,W1t) + b1t) # Q Value layer self.target_Q_value = tf.matmul(h_layer,W2t) + b2t å¯¹äºå®šæœŸå°†ç›®æ ‡Qç½‘ç»œçš„å‚æ•°æ›´æ–°çš„ä»£ç å¦‚ä¸‹é¢ä¸¤éƒ¨åˆ†ï¼š t_params = tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, scope='target_net') e_params = tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, scope='current_net') with tf.variable_scope('soft_replacement'): self.target_replace_op = [tf.assign(t, e) for t, e in zip(t_params, e_params)] def update_target_q_network(self, episode): # update target Q netowrk if episode % REPLACE_TARGET_FREQ == 0: self.session.run(self.target_replace_op) #print('episode '+str(episode) +', target Q network params replaced!') æ­¤å¤–ï¼Œæ³¨æ„ä¸‹æˆ‘ä»¬è®¡ç®—ç›®æ ‡Qå€¼çš„éƒ¨åˆ†ï¼Œè¿™é‡Œä½¿ç”¨çš„ç›®æ ‡Qç½‘ç»œçš„å‚æ•°ï¼Œè€Œä¸æ˜¯å½“å‰Qç½‘ç»œçš„å‚æ•°ï¼š # Step 2: calculate y y_batch = [] Q_value_batch = self.targe","date":"2024-02-23","objectID":"/posts/rl_learning_note_9/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [9] | Deep Q-Learningè¿›é˜¶ä¹‹Nature DQN","uri":"/posts/rl_learning_note_9/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ç³»åˆ—çš„å‰ä¸ƒç¯‡é‡Œï¼Œæˆ‘ä»¬ä¸»è¦è®¨è®ºçš„éƒ½æ˜¯è§„æ¨¡æ¯”è¾ƒå°çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜æ±‚è§£ç®—æ³•ã€‚ä»Šå¤©å¼€å§‹æˆ‘ä»¬æ­¥å…¥æ·±åº¦å¼ºåŒ–å­¦ä¹ ã€‚è¿™ä¸€ç¯‡å…³æ³¨äºä»·å€¼å‡½æ•°çš„è¿‘ä¼¼è¡¨ç¤ºå’ŒDeep Q-Learningç®—æ³•ã€‚ Deep Q-Learningè¿™ä¸€ç¯‡å¯¹åº”Suttonä¹¦çš„ç¬¬11ç« éƒ¨åˆ†å’ŒUCLå¼ºåŒ–å­¦ä¹ è¯¾ç¨‹çš„ç¬¬å…­è®²ã€‚ 1. ä¸ºä½•éœ€è¦ä»·å€¼å‡½æ•°çš„è¿‘ä¼¼è¡¨ç¤º åœ¨ä¹‹å‰è®²åˆ°äº†å¼ºåŒ–å­¦ä¹ æ±‚è§£æ–¹æ³•ï¼Œæ— è®ºæ˜¯åŠ¨æ€è§„åˆ’DPï¼Œè’™ç‰¹å¡ç½—æ–¹æ³•MCï¼Œè¿˜æ˜¯æ—¶åºå·®åˆ†TDï¼Œä½¿ç”¨çš„çŠ¶æ€éƒ½æ˜¯ç¦»æ•£çš„æœ‰é™ä¸ªçŠ¶æ€é›†åˆ $S$ã€‚æ­¤æ—¶é—®é¢˜çš„è§„æ¨¡æ¯”è¾ƒå°ï¼Œæ¯”è¾ƒå®¹æ˜“æ±‚è§£ã€‚ä½†æ˜¯å‡å¦‚æˆ‘ä»¬é‡åˆ°å¤æ‚çš„çŠ¶æ€é›†åˆå‘¢ï¼Ÿç”šè‡³å¾ˆå¤šæ—¶å€™ï¼ŒçŠ¶æ€æ˜¯è¿ç»­çš„ï¼Œé‚£ä¹ˆå°±ç®—ç¦»æ•£åŒ–åï¼Œé›†åˆä¹Ÿå¾ˆå¤§ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„ä¼ ç»Ÿæ–¹æ³•ï¼Œæ¯”å¦‚Q-Learningï¼Œæ ¹æœ¬æ— æ³•åœ¨å†…å­˜ä¸­ç»´æŠ¤è¿™ä¹ˆå¤§çš„ä¸€å¼ Qè¡¨ã€‚ã€€æ¯”å¦‚ç»å…¸çš„å†°çƒä¸–ç•Œ(PuckWorld)å¼ºåŒ–å­¦ä¹ é—®é¢˜ï¼Œå…·ä½“çš„åŠ¨æ€demoè§è¿™é‡Œã€‚ç¯å¢ƒç”±ä¸€ä¸ªæ­£æ–¹å½¢åŒºåŸŸæ„æˆä»£è¡¨ç€å†°çƒåœºåœ°ï¼Œåœºåœ°å†…å¤§çš„åœ†ä»£è¡¨ç€è¿åŠ¨å‘˜ä¸ªä½“ï¼Œå°åœ†ä»£è¡¨ç€ç›®æ ‡å†°çƒã€‚åœ¨è¿™ä¸ªæ­£æ–¹å½¢ç¯å¢ƒä¸­ï¼Œå°åœ†ä¼šæ¯éš”ä¸€å®šçš„æ—¶é—´éšæœºæ”¹å˜åœ¨åœºåœ°çš„ä½ç½®ï¼Œè€Œä»£è¡¨ä¸ªä½“çš„å¤§åœ†çš„ä»»åŠ¡å°±æ˜¯å°½å¯èƒ½å¿«çš„æ¥è¿‘å†°çƒç›®æ ‡ã€‚å¤§åœ†å¯ä»¥æ“ä½œçš„è¡Œä¸ºæ˜¯åœ¨æ°´å¹³å’Œç«–ç›´å…±å››ä¸ªæ–¹å‘ä¸Šæ–½åŠ ä¸€ä¸ªæ—¶é—´æ­¥æ—¶é•¿çš„ä¸€ä¸ªå¤§å°å›ºå®šçš„åŠ›ï¼Œå€Ÿæ­¤æ¥æ”¹å˜å¤§åœ†çš„é€Ÿåº¦ã€‚ç¯å¢ƒä¼šåœ¨æ¯ä¸€ä¸ªæ—¶é—´æ­¥å†…å‘Šè¯‰ä¸ªä½“å½“å‰çš„æ°´å¹³ä¸å‚ç›´åæ ‡ã€å½“å‰çš„é€Ÿåº¦åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šçš„åˆ†é‡ä»¥åŠç›®æ ‡çš„æ°´å¹³å’Œå‚ç›´åæ ‡å…±6é¡¹æ•°æ®ï¼Œå¥–åŠ±å€¼ä¸ºä¸ªä½“ä¸ç›®æ ‡ä¸¤è€…ä¸­å¿ƒè·ç¦»çš„è´Ÿæ•°ï¼Œä¹Ÿå°±æ˜¯è·ç¦»è¶Šå¤§å¥–åŠ±å€¼è¶Šä½ä¸”æœ€é«˜å¥–åŠ±å€¼ä¸º0ã€‚ åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼ŒçŠ¶æ€æ˜¯ä¸€ä¸ª6ç»´çš„å‘é‡ï¼Œå¹¶ä¸”æ˜¯è¿ç»­å€¼ã€‚æ²¡æ³•ç›´æ¥ç”¨ä¹‹å‰ç¦»æ•£é›†åˆçš„æ–¹æ³•æ¥æè¿°çŠ¶æ€ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿ç»­ç‰¹å¾ç¦»æ•£åŒ–ã€‚æ¯”å¦‚æŠŠè¿™ä¸ªå†°çƒåœº100x100çš„æ¡†æŒ‰1x1çš„æ ¼å­åˆ’åˆ†æˆ10000ä¸ªæ ¼å­ï¼Œé‚£ä¹ˆå¯¹äºè¿åŠ¨å‘˜çš„åæ ‡å’Œå†°çƒçš„åæ ‡å°±æœ‰$10^4âˆ—10^4=10^8$æ¬¡ç§ï¼Œå¦‚æœå†åŠ ä¸Šä¸ªä½“é€Ÿåº¦çš„åˆ†é‡å°±æ›´æ˜¯å¤©æ–‡æ•°å­—äº†ï¼Œæ­¤æ—¶ä¹‹å‰è®²è¿‡çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•éƒ½ä¼šå› ä¸ºé—®é¢˜çš„è§„æ¨¡å¤ªå¤§è€Œæ— æ³•ä½¿ç”¨ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿå¿…é¡»è¦å¯¹é—®é¢˜çš„å»ºæ¨¡åšä¿®æ”¹äº†ï¼Œè€Œä»·å€¼å‡½æ•°çš„è¿‘ä¼¼è¡¨ç¤ºå°±æ˜¯ä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•ã€‚ 2. ä»·å€¼å‡½æ•°çš„è¿‘ä¼¼è¡¨ç¤ºæ–¹æ³• ç”±äºé—®é¢˜çš„çŠ¶æ€é›†åˆè§„æ¨¡å¤§ï¼Œä¸€ä¸ªå¯è¡Œçš„å»ºæ¨¡æ–¹æ³•æ˜¯ä»·å€¼å‡½æ•°çš„è¿‘ä¼¼è¡¨ç¤ºã€‚æ–¹æ³•æ˜¯æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªçŠ¶æ€ä»·å€¼å‡½æ•° $\\hat{v}$, è¿™ä¸ªå‡½æ•°ç”±å‚æ•° $w$ æè¿°ï¼Œå¹¶æ¥å—çŠ¶æ€ $s$ ä½œä¸ºè¾“å…¥ï¼Œè®¡ç®—åå¾—åˆ°çŠ¶æ€ $s$ çš„ä»·å€¼ï¼Œå³æˆ‘ä»¬æœŸæœ›ï¼š $$\\hat{v}(s,w)\\approx v_\\pi(s)$$ ç±»ä¼¼çš„ï¼Œå¼•å…¥ä¸€ä¸ªåŠ¨ä½œä»·å€¼å‡½æ•° $\\hat{q}$ï¼Œè¿™ä¸ªå‡½æ•°ç”±å‚æ•° $w$ æè¿°ï¼Œå¹¶æ¥å—çŠ¶æ€ $s$ ä¸åŠ¨ä½œ $a$ ä½œä¸ºè¾“å…¥ï¼Œè®¡ç®—åå¾—åˆ°åŠ¨ä½œä»·å€¼ï¼Œå³æˆ‘ä»¬æœŸæœ›ï¼š $$\\hat{q}(s,a,w)\\approx q_\\pi(s,a)$$ ä»·å€¼å‡½æ•°è¿‘ä¼¼çš„æ–¹æ³•å¾ˆå¤šï¼Œæ¯”å¦‚æœ€ç®€å•çš„çº¿æ€§è¡¨ç¤ºæ³•ï¼Œç”¨ $Ï•(s)$è¡¨ç¤ºçŠ¶æ€ $s$ çš„ç‰¹å¾å‘é‡ï¼Œåˆ™æ­¤æ—¶æˆ‘ä»¬çš„çŠ¶æ€ä»·å€¼å‡½æ•°å¯ä»¥è¿‘ä¼¼è¡¨ç¤ºä¸ºï¼š $$\\hat{v}(s,w)=\\phi(s)^Tw$$ å½“ç„¶ï¼Œé™¤äº†çº¿æ€§è¡¨ç¤ºæ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨å†³ç­–æ ‘ï¼Œæœ€è¿‘é‚»ï¼Œå‚…é‡Œå¶å˜æ¢ï¼Œç¥ç»ç½‘ç»œæ¥è¡¨è¾¾æˆ‘ä»¬çš„çŠ¶æ€ä»·å€¼å‡½æ•°ã€‚è€Œæœ€å¸¸è§ï¼Œåº”ç”¨æœ€å¹¿æ³›çš„è¡¨ç¤ºæ–¹æ³•æ˜¯ç¥ç»ç½‘ç»œã€‚å› æ­¤åé¢æˆ‘ä»¬çš„è¿‘ä¼¼è¡¨è¾¾æ–¹æ³•å¦‚æœæ²¡æœ‰ç‰¹åˆ«æåˆ°ï¼Œéƒ½æ˜¯æŒ‡çš„ç¥ç»ç½‘ç»œçš„è¿‘ä¼¼è¡¨ç¤ºã€‚ å¯¹äºç¥ç»ç½‘ç»œï¼Œå¯ä»¥ä½¿ç”¨DNNï¼ŒCNNæˆ–è€…RNNã€‚æ²¡æœ‰ç‰¹åˆ«çš„é™åˆ¶ã€‚å¦‚æœæŠŠæˆ‘ä»¬è®¡ç®—ä»·å€¼å‡½æ•°çš„ç¥ç»ç½‘ç»œçœ‹åšä¸€ä¸ªé»‘ç›’å­ï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‘ä¼¼è¿‡ç¨‹å¯ä»¥çœ‹åšä¸‹é¢è¿™ä¸‰ç§æƒ…å†µï¼š ç¥ç»ç½‘ç»œæ‹Ÿåˆä»·å€¼å‡½æ•° å¯¹äºçŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œç¥ç»ç½‘ç»œçš„è¾“å…¥æ˜¯çŠ¶æ€sçš„ç‰¹å¾å‘é‡ï¼Œè¾“å‡ºæ˜¯çŠ¶æ€ä»·å€¼ $\\hat{v}(s,w)$ã€‚å¯¹äºåŠ¨ä½œä»·å€¼å‡½æ•°ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯è¾“å…¥çŠ¶æ€ $s$ çš„ç‰¹å¾å‘é‡å’ŒåŠ¨ä½œ $a$ï¼Œè¾“å‡ºå¯¹åº”çš„åŠ¨ä½œä»·å€¼ $\\hat{q}(s,a,w)$ï¼Œå¦ä¸€ç§æ˜¯åªè¾“å…¥çŠ¶æ€ $s$ çš„ç‰¹å¾å‘é‡ï¼ŒåŠ¨ä½œé›†åˆæœ‰å¤šå°‘ä¸ªåŠ¨ä½œå°±æœ‰å¤šå°‘ä¸ªè¾“å‡º $\\hat{q}(s,ai,w)$ã€‚è¿™é‡Œéšå«äº†æˆ‘ä»¬çš„åŠ¨ä½œæ˜¯æœ‰é™ä¸ªçš„ç¦»æ•£åŠ¨ä½œã€‚ å¯¹äºæˆ‘ä»¬å‰ä¸€ç¯‡è®²åˆ°çš„Q-Learningç®—æ³•ï¼Œæˆ‘ä»¬ç°åœ¨å°±ä»·å€¼å‡½æ•°çš„è¿‘ä¼¼è¡¨ç¤ºæ¥å°†å…¶æ”¹é€ ï¼Œé‡‡ç”¨ä¸Šé¢å³è¾¹çš„ç¬¬ä¸‰å¹…å›¾çš„åŠ¨ä½œä»·å€¼å‡½æ•°å»ºæ¨¡æ€è·¯æ¥åšï¼Œç°åœ¨æˆ‘ä»¬å«å®ƒDeep Q-Learningã€‚ 3. Deep Q-Learningç®—æ³•æ€è·¯ Deep Q-Learningç®—æ³•çš„åŸºæœ¬æ€è·¯æ¥æºäºQ-Learningã€‚ä½†æ˜¯å’ŒQ-Learningä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œå®ƒçš„Qå€¼çš„è®¡ç®—ä¸æ˜¯ç›´æ¥é€šè¿‡çŠ¶æ€å€¼så’ŒåŠ¨ä½œæ¥è®¡ç®—ï¼Œè€Œæ˜¯é€šè¿‡ä¸Šé¢è®²åˆ°çš„Qç½‘ç»œæ¥è®¡ç®—çš„ã€‚è¿™ä¸ªQç½‘ç»œæ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬ä¸€èˆ¬ç®€ç§°Deep Q-Learningä¸ºDQNã€‚ DQNçš„è¾“å…¥æ˜¯æˆ‘ä»¬çš„çŠ¶æ€så¯¹åº”çš„çŠ¶æ€å‘é‡ $Ï•(s)$ï¼Œ è¾“å‡ºæ˜¯æ‰€æœ‰åŠ¨ä½œåœ¨è¯¥çŠ¶æ€ä¸‹çš„åŠ¨ä½œä»·å€¼å‡½æ•°Qã€‚Qç½‘ç»œå¯ä»¥æ˜¯DNNï¼ŒCNNæˆ–è€…RNNï¼Œæ²¡æœ‰å…·ä½“çš„ç½‘ç»œç»“æ„è¦æ±‚ã€‚ DQNä¸»è¦ä½¿ç”¨çš„æŠ€å·§æ˜¯ç»éªŒå›æ”¾(experience replay), å³å°†æ¯æ¬¡å’Œç¯å¢ƒäº¤äº’å¾—åˆ°çš„å¥–åŠ±ä¸çŠ¶æ€æ›´æ–°æƒ…å†µéƒ½ä¿å­˜èµ·æ¥ï¼Œç”¨äºåé¢ç›®æ ‡Qå€¼çš„æ›´æ–°ã€‚ä¸ºä»€ä¹ˆéœ€è¦ç»éªŒå›æ”¾å‘¢ï¼Ÿæˆ‘ä»¬å›å¿†ä¸€ä¸‹Q-Learningï¼Œå®ƒæ˜¯æœ‰ä¸€å¼ Qè¡¨æ¥ä¿å­˜æ‰€æœ‰çš„Qå€¼çš„å½“å‰ç»“æœçš„ï¼Œä½†æ˜¯DQNæ˜¯æ²¡æœ‰çš„ï¼Œé‚£ä¹ˆåœ¨åšåŠ¨ä½œä»·å€¼å‡½æ•°æ›´æ–°çš„æ—¶å€™ï¼Œå°±éœ€è¦å…¶ä»–çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯ç»éªŒå›æ”¾ã€‚ é€šè¿‡ç»éªŒå›æ”¾å¾—åˆ°çš„ç›®æ ‡Qå€¼å’Œé€šè¿‡Qç½‘ç»œè®¡ç®—çš„Qå€¼è‚¯å®šæ˜¯æœ‰è¯¯å·®çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¢¯åº¦çš„åå‘ä¼ æ’­æ¥æ›´æ–°ç¥ç»ç½‘ç»œçš„å‚æ•° $w$ï¼Œå½“ $w$ æ”¶æ•›åï¼Œæˆ‘ä»¬çš„å°±å¾—åˆ°çš„è¿‘ä¼¼çš„Qå€¼è®¡ç®—æ–¹æ³•ï¼Œè¿›è€Œè´ªå©ªç­–ç•¥ä¹Ÿå°±æ±‚å‡ºæ¥äº†ã€‚ ä¸‹é¢æˆ‘ä»¬æ€»ç»“ä¸‹DQNçš„ç®—æ³•æµç¨‹ï¼ŒåŸºäºNIPS 2013 DQNã€‚ã€€ç®—æ³•è¾“å…¥ï¼šè¿­ä»£è½®æ•° $T$ï¼ŒçŠ¶æ€ç‰¹å¾ç»´åº¦ $n$, åŠ¨ä½œé›† $A$, æ­¥é•¿ $Î±$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, Qç½‘ç»œç»“æ„, æ‰¹é‡æ¢¯åº¦ä¸‹é™çš„æ ·æœ¬æ•° $m$ã€‚ è¾“å‡ºï¼šQç½‘ç»œå‚æ•° éšæœºåˆå§‹åŒ–$Q$ç½‘ç»œçš„æ‰€æœ‰å‚æ•° $w$ï¼ŒåŸºäº $w$åˆå§‹åŒ–æ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œå¯¹åº”çš„ä»·å€¼ $Q$ã€‚æ¸…ç©ºç»éªŒå›æ”¾çš„é›†åˆ $D$ã€‚ for i from 1 to Tï¼Œè¿›è¡Œè¿­ä»£ã€‚ a) åˆå§‹åŒ–Sä¸ºå½“å‰çŠ¶æ€åºåˆ—çš„ç¬¬ä¸€ä¸ªçŠ¶æ€, æ‹¿åˆ°å…¶ç‰¹å¾å‘é‡ $Ï•(S)$ b) åœ¨Qç½‘ç»œä¸­ä½¿ç”¨ $Ï•(S)$ ä½œä¸ºè¾“å…¥ï¼Œå¾—åˆ°Qç½‘ç»œçš„æ‰€æœ‰åŠ¨ä½œå¯¹åº”çš„Qå€¼è¾“å‡ºã€‚ç”¨ $Ïµâˆ’$è´ªå©ªæ³•åœ¨å½“å‰Qå€¼è¾“å‡ºä¸­é€‰æ‹©å¯¹åº”çš„åŠ¨ä½œ $A$ c) åœ¨çŠ¶æ€ $S$æ‰§è¡Œå½“å‰åŠ¨ä½œ $A$,å¾—åˆ°æ–°çŠ¶æ€ $Sâ€™$å¯¹åº”çš„ç‰¹å¾å‘é‡ $Ï•(Sâ€™)$å’Œå¥–åŠ± $R$,æ˜¯å¦ç»ˆæ­¢çŠ¶æ€is_end d) å°† $\\\\{Ï•(S),A,R,Ï•(Sâ€™),is_end\\\\}$è¿™ä¸ªäº”å…ƒç»„å­˜å…¥ç»éªŒå›æ”¾é›†åˆD e) $S=S'$ f) ä»ç»éªŒå›æ”¾é›†åˆ $D$ ä¸­é‡‡æ · $m$ ä¸ªæ ·æœ¬ ${Ï•(Sj),Aj,Rj,Ï•(Sâ€²j),is_endj},j=1,2.,,,m$ï¼Œè®¡ç®—å½“å‰ç›®æ ‡Qå€¼$y_j$ï¼š $$\\left.y_j=\\left\\\\{\\begin{array}{ll}R_j\u0026is_end_j\\mathrm{~}is\\mathrm{~}true\\\\\\\\R_j+\\gamma\\max_{a^{\\prime}}Q(\\phi(S_j^{\\prime}),A_j^{\\prime},w)\u0026is_end_j\\mathrm{~}is\\mathrm{~}false\\end{array}\\right.\\right.$$ g) ä½¿ç”¨å‡æ–¹å·®æŸå¤±å‡½æ•°$\\frac1m\\sum_{i=1}^m(y_j-Q(\\phi(S_j),A_j,w))^2$ï¼Œé€šè¿‡ç¥ç»ç½‘ç»œçš„æ¢¯åº¦åå‘ä¼ æ’­æ¥æ›´æ–°Qç½‘ç»œçš„æ‰€æœ‰å‚æ•° $w$ h) å¦‚æœ$Sâ€™$æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œå½“å‰è½®è¿­ä»£å®Œæ¯•ï¼Œå¦åˆ™è½¬åˆ°æ­¥éª¤b) æ³¨æ„ï¼Œä¸Šè¿°ç¬¬äºŒæ­¥çš„ $f$æ­¥å’Œ $g$æ­¥çš„ $Q$å€¼è®¡ç®—ä¹Ÿéƒ½éœ€è¦é€šè¿‡ $Q$ç½‘ç»œè®¡ç®—å¾—åˆ°ã€‚å¦å¤–ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œä¸ºäº†ç®—æ³•è¾ƒå¥½çš„æ”¶æ•›ï¼Œæ¢ç´¢ç‡ $Ïµ$éœ€è¦éšç€è¿­ä»£çš„è¿›è¡Œè€Œå˜å°ã€‚ 4. Deep Q-Learningå®ä¾‹ ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥æ¼”ç¤ºDQNçš„åº”ç”¨ã€‚è¿™é‡Œä½¿ç”¨äº†OpenAI Gymä¸­çš„CartPole-v0æ¸¸æˆæ¥ä½œä¸ºæˆ‘ä»¬ç®—æ³•åº”ç”¨ã€‚CartPole-v0æ¸¸æˆçš„ä»‹ç»å‚è§è¿™é‡Œã€‚å®ƒæ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬è¦æ±‚å°±æ˜¯æ§åˆ¶ä¸‹é¢çš„cartç§»åŠ¨ä½¿è¿æ¥åœ¨ä¸Šé¢çš„poleä¿æŒå‚ç›´ä¸å€’ã€‚è¿™ä¸ªä»»åŠ¡åªæœ‰ä¸¤ä¸ªç¦»æ•£åŠ¨ä½œï¼Œè¦ä¹ˆå‘å·¦ç”¨åŠ›ï¼Œè¦ä¹ˆå‘å³ç”¨åŠ›ã€‚è€ŒstateçŠ¶æ€å°±æ˜¯è¿™ä¸ªcartçš„ä½ç½®å’Œé€Ÿåº¦ï¼Œ poleçš„è§’åº¦å’Œè§’é€Ÿåº¦ï¼Œ4ç»´çš„ç‰¹å¾ã€‚åšæŒåˆ°200åˆ†çš„å¥–åŠ±åˆ™ä¸ºè¿‡å…³ã€‚ å®Œæ•´çš„ä»£ç å‚è§github: https://github.com/ljpzzz/machinelearning/blob/master/reinforcement-learning/dqn.py ä»£ç å‚è€ƒäº†çŸ¥ä¹ä¸Šçš„ä¸€ä¸ªDQNå®ä¾‹ï¼Œä¿®æ”¹äº†ä»£ç ä¸­çš„ä¸€äº›é”™è¯¯ï¼Œå¹¶ç”¨æœ€æ–°çš„Python3.6+Tensorflow1.8.0è¿è¡Œã€‚è¦è·‘ä»£ç éœ€è¦å®‰è£…OpenAIçš„Gymåº“ï¼Œä½¿ç”¨pip install gymå³å¯ã€‚ ä»£ç ä½¿ç”¨äº†ä¸€ä¸ªä¸‰å±‚çš„ç¥ç»ç½‘ç»œï¼Œè¾“å…¥å±‚ï¼Œä¸€ä¸ªéšè—å±‚å’Œä¸€ä¸ªè¾“å‡ºå±‚ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹å…³é”®éƒ¨åˆ†çš„ä»£ç ã€‚ ç®—æ³•ç¬¬2æ­¥çš„æ­¥éª¤bé€šè¿‡$Ïµâˆ’$è´ªå©ªæ³•é€‰æ‹©åŠ¨ä½œçš„ä»£ç å¦‚ä¸‹ï¼Œæ³¨æ„æ¯æ¬¡æˆ‘ä»¬$Ïµâˆ’$è´ªå©ªæ³•åéƒ½ä¼šå‡å°$Ïµ$å€¼ã€‚ def egreedy_action(self,state): Q_value = self.Q_value.eval(feed_dict = { self.state_input:[state] })[0] if random.random() \u003c= self.epsilon: self.epsilon -= (INITIAL_EPSILON - FINAL_EPSILON) / 10000 return random.randint(0,self.action_dim - 1) else: self.epsilon -= (INITIAL_EPSILON - FINAL_EPSILON) ","date":"2024-02-23","objectID":"/posts/rl_learning_note_8/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [8] | ä»·å€¼å‡½æ•°çš„è¿‘ä¼¼è¡¨ç¤ºä¸Deep Q-Learning","uri":"/posts/rl_learning_note_8/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆå…­ï¼‰æ—¶åºå·®åˆ†åœ¨çº¿æ§åˆ¶ç®—æ³•SARSAä¸­æˆ‘ä»¬è®¨è®ºäº†æ—¶åºå·®åˆ†çš„åœ¨çº¿æ§åˆ¶ç®—æ³•SARSAï¼Œè€Œå¦ä¸€ç±»æ—¶åºå·®åˆ†çš„ç¦»çº¿æ§åˆ¶ç®—æ³•è¿˜æ²¡æœ‰è®¨è®ºï¼Œå› æ­¤æœ¬æ–‡æˆ‘ä»¬å…³æ³¨äºæ—¶åºå·®åˆ†ç¦»çº¿æ§åˆ¶ç®—æ³•ï¼Œä¸»è¦æ˜¯ç»å…¸çš„Q-Learningç®—æ³•ã€‚ Q-Learningè¿™ä¸€ç¯‡å¯¹åº”Suttonä¹¦çš„ç¬¬å…­ç« éƒ¨åˆ†å’ŒUCLå¼ºåŒ–å­¦ä¹ è¯¾ç¨‹çš„ç¬¬äº”è®²éƒ¨åˆ†ã€‚ 1. Q-Learningç®—æ³•çš„å¼•å…¥ã€€Q-Learningç®—æ³•æ˜¯ä¸€ç§ä½¿ç”¨æ—¶åºå·®åˆ†æ±‚è§£å¼ºåŒ–å­¦ä¹ æ§åˆ¶é—®é¢˜çš„æ–¹æ³•ï¼Œå›é¡¾ä¸‹æ­¤æ—¶æˆ‘ä»¬çš„æ§åˆ¶é—®é¢˜å¯ä»¥è¡¨ç¤ºä¸ºï¼šç»™å®šå¼ºåŒ–å­¦ä¹ çš„5ä¸ªè¦ç´ ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, å³æ—¶å¥–åŠ± $R$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, æ±‚è§£æœ€ä¼˜çš„åŠ¨ä½œä»·å€¼å‡½æ•° $qâˆ—$å’Œæœ€ä¼˜ç­–ç•¥ $Ï€âˆ—$ã€‚ è¿™ä¸€ç±»å¼ºåŒ–å­¦ä¹ çš„é—®é¢˜æ±‚è§£ä¸éœ€è¦ç¯å¢ƒçš„çŠ¶æ€è½¬åŒ–æ¨¡å‹ï¼Œæ˜¯ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜æ±‚è§£æ–¹æ³•ã€‚å¯¹äºå®ƒçš„æ§åˆ¶é—®é¢˜æ±‚è§£ï¼Œå’Œè’™ç‰¹å¡ç½—æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯ä»·å€¼è¿­ä»£ï¼Œå³é€šè¿‡ä»·å€¼å‡½æ•°çš„æ›´æ–°ï¼Œæ¥æ›´æ–°ç­–ç•¥ï¼Œé€šè¿‡ç­–ç•¥æ¥äº§ç”Ÿæ–°çš„çŠ¶æ€å’Œå³æ—¶å¥–åŠ±ï¼Œè¿›è€Œæ›´æ–°ä»·å€¼å‡½æ•°ã€‚ä¸€ç›´è¿›è¡Œä¸‹å»ï¼Œç›´åˆ°ä»·å€¼å‡½æ•°å’Œç­–ç•¥éƒ½æ”¶æ•›ã€‚ å†å›é¡¾ä¸‹æ—¶åºå·®åˆ†æ³•çš„æ§åˆ¶é—®é¢˜ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯åœ¨çº¿æ§åˆ¶ï¼Œå³ä¸€ç›´ä½¿ç”¨ä¸€ä¸ªç­–ç•¥æ¥æ›´æ–°ä»·å€¼å‡½æ•°å’Œé€‰æ‹©æ–°çš„åŠ¨ä½œï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸Šä¸€ç¯‡è®²åˆ°çš„SARSA, è€Œå¦ä¸€ç±»æ˜¯ç¦»çº¿æ§åˆ¶ï¼Œä¼šä½¿ç”¨ä¸¤ä¸ªæ§åˆ¶ç­–ç•¥ï¼Œä¸€ä¸ªç­–ç•¥ç”¨äºé€‰æ‹©æ–°çš„åŠ¨ä½œï¼Œå¦ä¸€ä¸ªç­–ç•¥ç”¨äºæ›´æ–°ä»·å€¼å‡½æ•°ã€‚è¿™ä¸€ç±»çš„ç»å…¸ç®—æ³•å°±æ˜¯Q-Learningã€‚ å¯¹äºQ-Learningï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ $Ïµâˆ’$è´ªå©ªæ³•æ¥é€‰æ‹©æ–°çš„åŠ¨ä½œï¼Œè¿™éƒ¨åˆ†å’ŒSARSAå®Œå…¨ç›¸åŒã€‚ä½†æ˜¯å¯¹äºä»·å€¼å‡½æ•°çš„æ›´æ–°ï¼ŒQ-Learningä½¿ç”¨çš„æ˜¯è´ªå©ªæ³•ï¼Œè€Œä¸æ˜¯SARSAçš„ $Ïµâˆ’$è´ªå©ªæ³•ã€‚è¿™ä¸€ç‚¹å°±æ˜¯SARSAå’ŒQ-Learningæœ¬è´¨çš„åŒºåˆ«ã€‚ 2. Q-Learningç®—æ³•æ¦‚è¿° Q-Learningç®—æ³•çš„æ‹“æ‰‘å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Q Learning æ‹“æ‰‘å›¾ é¦–å…ˆæˆ‘ä»¬åŸºäºçŠ¶æ€ $S$ï¼Œç”¨ $Ïµâˆ’$è´ªå©ªæ³•é€‰æ‹©åˆ°åŠ¨ä½œ $A$, ç„¶åæ‰§è¡ŒåŠ¨ä½œ$A$ï¼Œå¾—åˆ°å¥–åŠ± $R$ï¼Œå¹¶è¿›å…¥çŠ¶æ€ $Sâ€™$ï¼Œæ­¤æ—¶ï¼Œå¦‚æœæ˜¯SARSAï¼Œä¼šç»§ç»­åŸºäºçŠ¶æ€ $Sâ€™$ï¼Œç”¨ $Ïµâˆ’$è´ªå©ªæ³•é€‰æ‹© $Aâ€™$,ç„¶åæ¥æ›´æ–°ä»·å€¼å‡½æ•°ã€‚ä½†æ˜¯Q-Learningåˆ™ä¸åŒã€‚ å¯¹äºQ-Learningï¼Œå®ƒåŸºäºçŠ¶æ€ $Sâ€™$ï¼Œæ²¡æœ‰ä½¿ç”¨ $Ïµâˆ’$è´ªå©ªæ³•é€‰æ‹© $A$ï¼Œè€Œæ˜¯ä½¿ç”¨è´ªå©ªæ³•é€‰æ‹© $Aâ€™$ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€‰æ‹©ä½¿ $Q(Sâ€™,a)$ æœ€å¤§çš„ $a$ ä½œä¸º $Aâ€™$æ¥æ›´æ–°ä»·å€¼å‡½æ•°ã€‚ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºå°±æ˜¯ï¼š $$Q(S,A)=Q(S,A)+\\alpha(R+\\gamma\\max_aQ(S^{\\prime},a)-Q(S,A))$$ å¯¹åº”åˆ°ä¸Šå›¾ä¸­å°±æ˜¯åœ¨å›¾ä¸‹æ–¹çš„ä¸‰ä¸ªé»‘åœ†åœˆåŠ¨ä½œä¸­é€‰æ‹©ä¸€ä¸ªä½¿ $Q(Sâ€™,a)$æœ€å¤§çš„åŠ¨ä½œä½œä¸º $Aâ€™$ã€‚ æ­¤æ—¶é€‰æ‹©çš„åŠ¨ä½œåªä¼šå‚ä¸ä»·å€¼å‡½æ•°çš„æ›´æ–°ï¼Œä¸ä¼šçœŸæ­£çš„æ‰§è¡Œã€‚ä»·å€¼å‡½æ•°æ›´æ–°åï¼Œæ–°çš„æ‰§è¡ŒåŠ¨ä½œéœ€è¦åŸºäºçŠ¶æ€ $Sâ€™$ï¼Œç”¨ $Ïµâˆ’$è´ªå©ªæ³•é‡æ–°é€‰æ‹©å¾—åˆ°ã€‚è¿™ä¸€ç‚¹ä¹Ÿå’ŒSARSAç¨æœ‰ä¸åŒã€‚å¯¹äºSARSAï¼Œä»·å€¼å‡½æ•°æ›´æ–°ä½¿ç”¨çš„ $Aâ€™$ ä¼šä½œä¸ºä¸‹ä¸€é˜¶æ®µå¼€å§‹æ—¶å€™çš„æ‰§è¡ŒåŠ¨ä½œã€‚ ä¸‹é¢æˆ‘ä»¬å¯¹Q-Learningç®—æ³•åšä¸€ä¸ªæ€»ç»“ã€‚ 3. Q-Learningç®—æ³•æµç¨‹ ä¸‹é¢æˆ‘ä»¬æ€»ç»“ä¸‹Q-Learningç®—æ³•çš„æµç¨‹ã€‚ ç®—æ³•è¾“å…¥ï¼šè¿­ä»£è½®æ•° $T$ï¼ŒçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, æ­¥é•¿ $Î±$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, è¾“å‡º: æ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œå¯¹åº”çš„ä»·å€¼ $Q$ éšæœºåˆå§‹åŒ–æ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œå¯¹åº”çš„ä»·å€¼Qï¿½. å¯¹äºç»ˆæ­¢çŠ¶æ€å…¶Qï¿½å€¼åˆå§‹åŒ–ä¸º0. for i from 1 to Tï¼Œè¿›è¡Œè¿­ä»£ã€‚ a) åˆå§‹åŒ– $S$ ä¸ºå½“å‰çŠ¶æ€åºåˆ—çš„ç¬¬ä¸€ä¸ªçŠ¶æ€ã€‚ b) ç”¨ $Ïµâˆ’$è´ªå©ªæ³•åœ¨å½“å‰çŠ¶æ€ $S$ é€‰æ‹©å‡ºåŠ¨ä½œ $A$ c) åœ¨çŠ¶æ€ $S$æ‰§è¡Œå½“å‰åŠ¨ä½œ $A$,å¾—åˆ°æ–°çŠ¶æ€ $Sâ€™$å’Œå¥–åŠ± $R$ d) æ›´æ–°ä»·å€¼å‡½æ•° $Q(S,A)$: $$Q(S,A)+\\alpha(R+\\gamma\\max_aQ(S^{\\prime},a)-Q(S,A))$$ e) $S=S'$ f) å¦‚æœ$Sâ€™$æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œå½“å‰è½®è¿­ä»£å®Œæ¯•ï¼Œå¦åˆ™è½¬åˆ°æ­¥éª¤b) 4. Q-Learningç®—æ³•å®ä¾‹ï¼šWindy GridWorld æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨å’ŒSARSAä¸€æ ·çš„ä¾‹å­æ¥ç ”ç©¶Q-Learningã€‚å¦‚æœå¯¹windy gridworldçš„é—®é¢˜è¿˜ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥å¤ä¹ å¼ºåŒ–å­¦ä¹ ï¼ˆå…­ï¼‰æ—¶åºå·®åˆ†åœ¨çº¿æ§åˆ¶ç®—æ³•SARSAç¬¬4èŠ‚çš„ç¬¬äºŒæ®µã€‚ å®Œæ•´çš„ä»£ç å‚è§github: https://github.com/ljpzzz/machinelearning/blob/master/reinforcement-learning/q_learning_windy_world.py ç»å¤§éƒ¨åˆ†ä»£ç å’ŒSARSAæ˜¯ç±»ä¼¼çš„ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥é‡ç‚¹æ¯”è¾ƒå’ŒSARSAä¸åŒçš„éƒ¨åˆ†ã€‚åŒºåˆ«éƒ½åœ¨episode()è¿™ä¸ªå‡½æ•°é‡Œé¢ã€‚ é¦–å…ˆæ˜¯åˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªåˆå§‹åŒ–çŠ¶æ€ $S$,æŠŠ $A$ çš„äº§ç”Ÿæ”¾åˆ°äº†whileå¾ªç¯é‡Œé¢, è€Œå›å¿†ä¸‹SARSAä¼šåŒæ—¶åˆå§‹åŒ–çŠ¶æ€ $S$ å’ŒåŠ¨ä½œ $A$ï¼Œå†å»æ‰§è¡Œå¾ªç¯ã€‚ä¸‹é¢è¿™æ®µQ-Learningçš„ä»£ç å¯¹åº”æˆ‘ä»¬ç®—æ³•çš„ç¬¬äºŒæ­¥æ­¥éª¤aå’Œbï¼š # play for an episode def episode(q_value): # track the total time steps in this episode time = 0 # initialize state state = START while state != GOAL: # choose an action based on epsilon-greedy algorithm if np.random.binomial(1, EPSILON) == 1: action = np.random.choice(ACTIONS) else: values_ = q_value[state[0], state[1], :] action = np.random.choice([action_ for action_, value_ in enumerate(values_) if value_ == np.max(values_)]) æ¥ç€æˆ‘ä»¬ä¼šå»æ‰§è¡ŒåŠ¨ä½œ $A$,å¾—åˆ° $Sâ€™$ï¼Œ ç”±äºå¥–åŠ±ä¸æ˜¯ç»ˆæ­¢å°±æ˜¯-1ï¼Œä¸éœ€è¦å•ç‹¬è®¡ç®—ã€‚,è¿™éƒ¨åˆ†å’ŒSARSAçš„ä»£ç ç›¸åŒã€‚å¯¹åº”æˆ‘ä»¬Q-Learningç®—æ³•çš„ç¬¬äºŒæ­¥æ­¥éª¤cï¼š next_state = step(state, action) def step(state, action): i, j = state if action == ACTION_UP: return [max(i - 1 - WIND[j], 0), j] elif action == ACTION_DOWN: return [max(min(i + 1 - WIND[j], WORLD_HEIGHT - 1), 0), j] elif action == ACTION_LEFT: return [max(i - WIND[j], 0), max(j - 1, 0)] elif action == ACTION_RIGHT: return [max(i - WIND[j], 0), min(j + 1, WORLD_WIDTH - 1)] else: assert False åé¢æˆ‘ä»¬ç”¨è´ªå©ªæ³•é€‰æ‹©å‡ºæœ€å¤§çš„ $Q(Sâ€™,a)$,å¹¶æ›´æ–°ä»·å€¼å‡½æ•°ï¼Œæœ€åæ›´æ–°å½“å‰çŠ¶æ€ $S$ã€‚å¯¹åº”æˆ‘ä»¬Q-Learningç®—æ³•çš„ç¬¬äºŒæ­¥æ­¥éª¤d,eã€‚æ³¨æ„SARSAè¿™é‡Œæ˜¯ä½¿ç”¨Ïµâˆ’ï¿½âˆ’è´ªå©ªæ³•ï¼Œè€Œä¸æ˜¯è´ªå©ªæ³•ã€‚åŒæ—¶SARSAä¼šåŒæ—¶æ›´æ–°çŠ¶æ€Sï¿½å’ŒåŠ¨ä½œAï¿½,è€ŒQ-Learningåªä¼šæ›´æ–°å½“å‰çŠ¶æ€Sï¿½ã€‚ values_ = q_value[next_state[0], next_state[1], :] next_action = np.random.choice([action_ for action_, value_ in enumerate(values_) if value_ == np.max(values_)]) # Sarsa update q_value[state[0], state[1], action] += \\ ALPHA * (REWARD + q_value[next_state[0], next_state[1], next_action] - q_value[state[0], state[1], action]) state = next_state è·‘å®Œå®Œæ•´çš„ä»£ç ï¼Œå¤§å®¶å¯ä»¥å¾ˆå®¹æ˜“å¾—åˆ°è¿™ä¸ªé—®é¢˜çš„æœ€ä¼˜è§£ï¼Œè¿›è€Œå¾—åˆ°åœ¨æ¯ä¸ªæ ¼å­é‡Œçš„æœ€ä¼˜è´ªå©ªç­–ç•¥ã€‚ 5. SARSA vs Q-Learning ç°åœ¨SARSAå’ŒQ-Learningç®—æ³•æˆ‘ä»¬éƒ½è®²å®Œäº†ï¼Œé‚£ä¹ˆä½œä¸ºæ—¶åºå·®åˆ†æ§åˆ¶ç®—æ³•çš„ä¸¤ç§ç»å…¸æ–¹æ³•å—ï¼Œä»–ä»¬éƒ½æœ‰è¯´æ˜ç‰¹ç‚¹ï¼Œå„è‡ªé€‚ç”¨äºä»€ä¹ˆæ ·çš„åœºæ™¯å‘¢ï¼Ÿ Q-Learningç›´æ¥å­¦ä¹ çš„æ˜¯ æœ€ä¼˜ç­–ç•¥ï¼Œè€ŒSARSAåœ¨å­¦ä¹ æœ€ä¼˜ç­–ç•¥çš„åŒæ—¶è¿˜åœ¨åšæ¢ç´¢ã€‚è¿™å¯¼è‡´æˆ‘ä»¬åœ¨å­¦ä¹ æœ€ä¼˜ç­–ç•¥çš„æ—¶å€™ï¼Œå¦‚æœç”¨SARSAï¼Œä¸ºäº†ä¿è¯æ”¶æ•›ï¼Œéœ€è¦åˆ¶å®šä¸€ä¸ªç­–ç•¥ï¼Œä½¿ $Ïµâˆ’$è´ªå©ªæ³•çš„è¶…å‚æ•° $Ïµ$åœ¨è¿­ä»£çš„è¿‡ç¨‹ä¸­é€æ¸å˜å°ã€‚Q-Learningæ²¡æœ‰è¿™ä¸ªçƒ¦æ¼ã€‚ å¦å¤–ä¸€ä¸ªå°±æ˜¯Q-Learningç›´æ¥å­¦ä¹ æœ€ä¼˜ç­–ç•¥ï¼Œä½†æ˜¯æœ€ä¼˜ç­–ç•¥ä¼šä¾èµ–äºè®­ç»ƒä¸­äº§ç”Ÿçš„ä¸€ç³»åˆ—æ•°æ®ï¼Œæ‰€ä»¥å—æ ·æœ¬æ•°æ®çš„å½±å“è¾ƒå¤§ï¼Œå› æ­¤å—åˆ°è®­ç»ƒæ•°æ®æ–¹å·®çš„å½±å“å¾ˆå¤§ï¼Œç”šè‡³ä¼šå½±å“Qå‡½æ•°çš„æ”¶æ•›ã€‚Q-Learningçš„æ·±åº¦å¼ºåŒ–å­¦ä¹ ç‰ˆDeep Q-Learningä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ã€‚ åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼ŒSARSAåœ¨æ”¶æ•›çš„è¿‡ç¨‹ä¸­é¼“åŠ±æ¢ç´¢ï¼Œè¿™æ ·å­¦ä¹ è¿‡ç¨‹ä¼šæ¯”è¾ƒå¹³æ»‘ï¼Œä¸è‡³äºè¿‡äºæ¿€è¿›ï¼Œå¯¼è‡´å‡ºç°åƒQ-Learningå¯èƒ½é‡åˆ°ä¸€äº›ç‰¹æ®Šçš„æœ€ä¼˜â€œé™·é˜±â€ã€‚æ¯”å¦‚ç»å…¸çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜\"Cliff Wa","date":"2024-02-23","objectID":"/posts/rl_learning_note_7/:0:0","tags":["RL"],"title":"å¼ºåŒ–å­¦ä¹ ç¬”è®° [7] | æ—¶åºå·®åˆ†ç¦»çº¿æ§åˆ¶ç®—æ³•Q-Learning","uri":"/posts/rl_learning_note_7/"},{"categories":["draft"],"content":"0 å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆå››ï¼‰ç”¨è’™ç‰¹å¡ç½—æ³•ï¼ˆMCï¼‰æ±‚è§£ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°äº†ä½¿ç”¨è’™ç‰¹å¡ç½—æ³•æ¥æ±‚è§£å¼ºåŒ–å­¦ä¹ é—®é¢˜çš„æ–¹æ³•ï¼Œè™½ç„¶è’™ç‰¹å¡ç½—æ³•å¾ˆçµæ´»ï¼Œä¸éœ€è¦ç¯å¢ƒçš„çŠ¶æ€è½¬åŒ–æ¦‚ç‡æ¨¡å‹ï¼Œä½†æ˜¯å®ƒéœ€è¦æ‰€æœ‰çš„é‡‡æ ·åºåˆ—éƒ½æ˜¯ç»å†å®Œæ•´çš„çŠ¶æ€åºåˆ—ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰å®Œæ•´çš„çŠ¶æ€åºåˆ—ï¼Œé‚£ä¹ˆå°±æ— æ³•ä½¿ç”¨è’™ç‰¹å¡ç½—æ³•æ±‚è§£äº†ã€‚æœ¬æ–‡æˆ‘ä»¬å°±æ¥è®¨è®ºå¯ä»¥ä¸ä½¿ç”¨å®Œæ•´çŠ¶æ€åºåˆ—æ±‚è§£å¼ºåŒ–å­¦ä¹ é—®é¢˜çš„æ–¹æ³•ï¼šæ—¶åºå·®åˆ†(Temporal-Difference, TD)ã€‚ æ—¶åºå·®åˆ†è¿™ä¸€ç¯‡å¯¹åº”Suttonä¹¦çš„ç¬¬å…­ç« éƒ¨åˆ†å’ŒUCLå¼ºåŒ–å­¦ä¹ è¯¾ç¨‹çš„ç¬¬å››è®²éƒ¨åˆ†ï¼Œç¬¬äº”è®²éƒ¨åˆ†ã€‚ 1. æ—¶åºå·®åˆ†TDç®€ä»‹ æ—¶åºå·®åˆ†æ³•å’Œè’™ç‰¹å¡ç½—æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜æ±‚è§£æ–¹æ³•ã€‚æ‰€ä»¥åœ¨ä¸Šä¸€ç¯‡å®šä¹‰çš„ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ§åˆ¶é—®é¢˜å’Œé¢„æµ‹é—®é¢˜çš„å®šä¹‰ï¼Œåœ¨è¿™é‡Œä»ç„¶é€‚ç”¨ã€‚ é¢„æµ‹é—®é¢˜ï¼šå³ç»™å®šå¼ºåŒ–å­¦ä¹ çš„5ä¸ªè¦ç´ ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, å³æ—¶å¥–åŠ± $R$ï¼Œè¡°å‡å› å­ $Î³$, ç»™å®šç­–ç•¥ $Ï€$ï¼Œ æ±‚è§£è¯¥ç­–ç•¥çš„çŠ¶æ€ä»·å€¼å‡½æ•° $v(Ï€)$ æ§åˆ¶é—®é¢˜ï¼šä¹Ÿå°±æ˜¯æ±‚è§£æœ€ä¼˜çš„ä»·å€¼å‡½æ•°å’Œç­–ç•¥ã€‚ç»™å®šå¼ºåŒ–å­¦ä¹ çš„5ä¸ªè¦ç´ ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, å³æ—¶å¥–åŠ± $R$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, æ±‚è§£æœ€ä¼˜çš„åŠ¨ä½œä»·å€¼å‡½æ•° $qâˆ—$ å’Œæœ€ä¼˜ç­–ç•¥ $Ï€âˆ—$ã€€å›é¡¾è’™ç‰¹å¡ç½—æ³•ä¸­è®¡ç®—çŠ¶æ€æ”¶è·çš„æ–¹æ³•æ˜¯ï¼š $$G_t=R_{t+1}+\\gamma R_{t+2}+\\gamma^2R_{t+3}+\\ldots\\gamma^{T-t-1}R_T$$ è€Œå¯¹äºæ—¶åºå·®åˆ†æ³•æ¥è¯´ï¼Œæˆ‘ä»¬æ²¡æœ‰å®Œæ•´çš„çŠ¶æ€åºåˆ—ï¼Œåªæœ‰éƒ¨åˆ†çš„çŠ¶æ€åºåˆ—ï¼Œé‚£ä¹ˆå¦‚ä½•å¯ä»¥è¿‘ä¼¼æ±‚å‡ºæŸä¸ªçŠ¶æ€çš„æ”¶è·å‘¢ï¼Ÿå›é¡¾å¼ºåŒ–å­¦ä¹ ï¼ˆäºŒï¼‰é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹(MDP)ä¸­çš„è´å°”æ›¼æ–¹ç¨‹ï¼š $$v_\\pi(s)=\\mathbb{E}_\\pi(R_{t+1}+\\gamma v_\\pi(S_{t+1})|S_t=s)$$ è¿™å¯å‘æˆ‘ä»¬å¯ä»¥ç”¨ $R_{t+1}+\\gamma v(S_{t+1})$ æ¥è¿‘ä¼¼çš„ä»£æ›¿æ”¶è· $G_t$,ä¸€èˆ¬æˆ‘ä»¬æŠŠ $R_{t+1}+\\gamma V(S_{t+1})$ ç§°ä¸ºTDç›®æ ‡å€¼ã€‚$R_{t+1}+\\gamma V(S_{t+1})-V(S_t)$ ç§°ä¸ºTDè¯¯å·®ï¼Œå°†ç”¨TDç›®æ ‡å€¼è¿‘ä¼¼ä»£æ›¿æ”¶è· $G(t)$ çš„è¿‡ç¨‹ç§°ä¸ºå¼•å¯¼(bootstrapping)ã€‚è¿™æ ·æˆ‘ä»¬åªéœ€è¦ä¸¤ä¸ªè¿ç»­çš„çŠ¶æ€ä¸å¯¹åº”çš„å¥–åŠ±ï¼Œå°±å¯ä»¥å°è¯•æ±‚è§£å¼ºåŒ–å­¦ä¹ é—®é¢˜äº†ã€‚ ç°åœ¨æˆ‘ä»¬æœ‰äº†è‡ªå·±çš„è¿‘ä¼¼æ”¶è· $G_t$ çš„è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥å»æ±‚è§£æ—¶åºå·®åˆ†çš„é¢„æµ‹é—®é¢˜å’Œæ§åˆ¶é—®é¢˜äº†ã€‚ 2. æ—¶åºå·®åˆ†TDçš„é¢„æµ‹é—®é¢˜æ±‚è§£ æ—¶åºå·®åˆ†çš„é¢„æµ‹é—®é¢˜æ±‚è§£å’Œè’™ç‰¹å¡ç½—æ³•ç±»ä¼¼ï¼Œä½†æ˜¯ä¸»è¦æœ‰ä¸¤ä¸ªä¸åŒç‚¹ã€‚ä¸€æ˜¯æ”¶è· $G_t$ çš„è¡¨è¾¾å¼ä¸åŒï¼Œæ—¶åºå·®åˆ† $G(t)$ çš„è¡¨è¾¾å¼ä¸ºï¼š $$G(t)=R_{t+1}+\\gamma V(S_{t+1})$$ äºŒæ˜¯è¿­ä»£çš„å¼å­ç³»æ•°ç¨æœ‰ä¸åŒï¼Œå›é¡¾è’™ç‰¹å¡ç½—æ³•çš„è¿­ä»£å¼å­æ˜¯ï¼š $$V(S_t)=V(S_t)+\\frac1{N(S_t)}(G_t-V(S_t))$$ ç”±äºåœ¨æ—¶åºå·®åˆ†æˆ‘ä»¬æ²¡æœ‰å®Œæ•´çš„åºåˆ—ï¼Œä¹Ÿå°±æ²¡æœ‰å¯¹åº”çš„æ¬¡æ•° $N(S_t)$ ,ä¸€èˆ¬å°±ç”¨ä¸€ä¸ª[0,1]çš„ç³»æ•° $Î±$ ä»£æ›¿ã€‚è¿™æ ·æ—¶åºå·®åˆ†çš„ä»·å€¼å‡½æ•°è¿­ä»£å¼å­æ˜¯ï¼š $$V(S_t)=V(S_t)+\\alpha(G_t-V(S_t)) \\\\\\\\ Q(S_t,A_t)=Q(S_t,A_t)+\\alpha(G_t-Q(S_t,A_t)) $$ è¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹è’™ç‰¹å¡ç½—æ³•å’Œæ—¶åºå·®åˆ†æ³•æ±‚è§£é¢„æµ‹é—®é¢˜çš„ä¸åŒã€‚ å‡è®¾æˆ‘ä»¬çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜æœ‰A,Bä¸¤ä¸ªçŠ¶æ€ï¼Œæ¨¡å‹æœªçŸ¥ï¼Œä¸æ¶‰åŠç­–ç•¥å’Œè¡Œä¸ºã€‚åªæ¶‰åŠçŠ¶æ€è½¬åŒ–å’Œå³æ—¶å¥–åŠ±ã€‚ä¸€å…±æœ‰8ä¸ªå®Œæ•´çš„çŠ¶æ€åºåˆ—å¦‚ä¸‹ï¼š â‘  A,0,B,0 â‘¡B,1 â‘¢B,1 â‘£ B,1 â‘¤ B,1 â‘¥B,1 â‘¦B,1 â‘§B,0 åªæœ‰ç¬¬ä¸€ä¸ªçŠ¶æ€åºåˆ—æ˜¯æœ‰çŠ¶æ€è½¬ç§»çš„ï¼Œå…¶ä½™7ä¸ªåªæœ‰ä¸€ä¸ªçŠ¶æ€ã€‚è®¾ç½®è¡°å‡å› å­ $Î³=1$ã€‚ é¦–å…ˆæˆ‘ä»¬æŒ‰è’™ç‰¹å¡ç½—æ³•æ¥æ±‚è§£é¢„æµ‹é—®é¢˜ã€‚ç”±äºåªæœ‰ç¬¬ä¸€ä¸ªåºåˆ—ä¸­åŒ…å«çŠ¶æ€Aï¼Œå› æ­¤Açš„ä»·å€¼ä»…èƒ½é€šè¿‡ç¬¬ä¸€ä¸ªåºåˆ—æ¥è®¡ç®—ï¼Œä¹Ÿå°±ç­‰åŒäºè®¡ç®—è¯¥åºåˆ—ä¸­çŠ¶æ€Açš„æ”¶è·ï¼š $$V(A)=G(A)=R_A+\\gamma R_B=0$$ å¯¹äºBï¼Œåˆ™éœ€è¦å¯¹å…¶åœ¨8ä¸ªåºåˆ—ä¸­çš„æ”¶è·å€¼æ¥å¹³å‡ï¼Œå…¶ç»“æœæ˜¯6/8ã€‚ å†æ¥çœ‹çœ‹æ—¶åºå·®åˆ†æ³•æ±‚è§£çš„è¿‡ç¨‹ã€‚å…¶æ”¶è·æ˜¯åœ¨è®¡ç®—çŠ¶æ€åºåˆ—ä¸­æŸçŠ¶æ€ä»·å€¼æ—¶æ˜¯åº”ç”¨å…¶åç»­çŠ¶æ€çš„é¢„ä¼°ä»·å€¼æ¥è®¡ç®—çš„ï¼Œå¯¹äºBæ¥è¯´ï¼Œå®ƒæ€»æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œæ²¡æœ‰åç»­çŠ¶æ€ï¼Œå› æ­¤å®ƒçš„ä»·å€¼ç›´æ¥ç”¨å…¶åœ¨8ä¸ªåºåˆ—ä¸­çš„æ”¶è·å€¼æ¥å¹³å‡ï¼Œå…¶ç»“æœæ˜¯6/8ã€‚ å¯¹äºAï¼Œåªåœ¨ç¬¬ä¸€ä¸ªåºåˆ—å‡ºç°ï¼Œå®ƒçš„ä»·å€¼ä¸ºï¼š $$V(A)=R_A+\\gamma V(B)=\\frac68$$ ä»ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°è’™ç‰¹å¡ç½—æ³•å’Œæ—¶åºå·®åˆ†æ³•æ±‚è§£é¢„æµ‹é—®é¢˜çš„åŒºåˆ«ã€‚ ä¸€æ˜¯æ—¶åºå·®åˆ†æ³•åœ¨çŸ¥é“ç»“æœä¹‹å‰å°±å¯ä»¥å­¦ä¹ ï¼Œä¹Ÿå¯ä»¥åœ¨æ²¡æœ‰ç»“æœæ—¶å­¦ä¹ ï¼Œè¿˜å¯ä»¥åœ¨æŒç»­è¿›è¡Œçš„ç¯å¢ƒä¸­å­¦ä¹ ï¼Œè€Œè’™ç‰¹å¡ç½—æ³•åˆ™è¦ç­‰åˆ°æœ€åç»“æœæ‰èƒ½å­¦ä¹ ï¼Œæ—¶åºå·®åˆ†æ³•å¯ä»¥æ›´å¿«é€Ÿçµæ´»çš„æ›´æ–°çŠ¶æ€çš„ä»·å€¼ä¼°è®¡ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹æœ‰ç€éå¸¸é‡è¦çš„å®é™…æ„ä¹‰ã€‚ äºŒæ˜¯æ—¶åºå·®åˆ†æ³•åœ¨æ›´æ–°çŠ¶æ€ä»·å€¼æ—¶ä½¿ç”¨çš„æ˜¯TD ç›®æ ‡å€¼ï¼Œå³åŸºäºå³æ—¶å¥–åŠ±å’Œä¸‹ä¸€çŠ¶æ€çš„é¢„ä¼°ä»·å€¼æ¥æ›¿ä»£å½“å‰çŠ¶æ€åœ¨çŠ¶æ€åºåˆ—ç»“æŸæ—¶å¯èƒ½å¾—åˆ°çš„æ”¶è·ï¼Œæ˜¯å½“å‰çŠ¶æ€ä»·å€¼çš„æœ‰åä¼°è®¡ï¼Œè€Œè’™ç‰¹å¡ç½—æ³•åˆ™ä½¿ç”¨å®é™…çš„æ”¶è·æ¥æ›´æ–°çŠ¶æ€ä»·å€¼ï¼Œæ˜¯æŸä¸€ç­–ç•¥ä¸‹çŠ¶æ€ä»·å€¼çš„æ— åä¼°è®¡ï¼Œè¿™ä¸€ç‚¹è’™ç‰¹å¡ç½—æ³•å ä¼˜ã€‚ ä¸‰æ˜¯è™½ç„¶æ—¶åºå·®åˆ†æ³•å¾—åˆ°çš„ä»·å€¼æ˜¯æœ‰åä¼°è®¡ï¼Œä½†æ˜¯å…¶æ–¹å·®å´æ¯”è’™ç‰¹å¡ç½—æ³•å¾—åˆ°çš„æ–¹å·®è¦ä½ï¼Œä¸”å¯¹åˆå§‹å€¼æ•æ„Ÿï¼Œé€šå¸¸æ¯”è’™ç‰¹å¡ç½—æ³•æ›´åŠ é«˜æ•ˆã€‚ ä»ä¸Šé¢çš„æè¿°å¯ä»¥çœ‹å‡ºæ—¶åºå·®åˆ†æ³•çš„ä¼˜åŠ¿æ¯”è¾ƒå¤§ï¼Œå› æ­¤ç°åœ¨ä¸»æµçš„å¼ºåŒ–å­¦ä¹ æ±‚è§£æ–¹æ³•éƒ½æ˜¯åŸºäºæ—¶åºå·®åˆ†çš„ã€‚åé¢çš„æ–‡ç« ä¹Ÿä¼šä¸»è¦åŸºäºæ—¶åºå·®åˆ†æ³•æ¥æ‰©å±•è®¨è®ºã€‚ 3. næ­¥æ—¶åºå·®åˆ† åœ¨ç¬¬äºŒèŠ‚çš„æ—¶åºå·®åˆ†æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç”¨ $R_{t+1}+\\gamma v(S_{t+1})$ æ¥è¿‘ä¼¼çš„ä»£æ›¿æ”¶è· $G_t$ã€‚å³å‘å‰ä¸€æ­¥æ¥è¿‘ä¼¼æˆ‘ä»¬çš„æ”¶è· $G_{t}$,é‚£ä¹ˆèƒ½ä¸èƒ½å‘å‰ä¸¤æ­¥å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ï¼Œè¿™æ—¶æˆ‘ä»¬çš„æ”¶è· $G_t$ çš„è¿‘ä¼¼è¡¨è¾¾å¼ä¸ºï¼š $$G_t^{(2)}=R_{t+1}+\\gamma R_{t+2}+\\gamma^2V(S_{t+2})$$ ä»ä¸¤æ­¥ï¼Œåˆ°ä¸‰æ­¥ï¼Œå†åˆ°næ­¥ï¼Œæˆ‘ä»¬å¯ä»¥å½’çº³å‡ºnæ­¥æ—¶åºå·®åˆ†æ”¶è· $G^{(n)}_t$è¡¨è¾¾å¼ä¸ºï¼š$$G_t^{(n)}=R_{t+1}+\\gamma R_{t+2}+\\ldots+\\gamma^{n-1}R_{t+n}+\\gamma^nV(S_{t+n})$$ å½“nè¶Šæ¥è¶Šå¤§ï¼Œè¶‹äºæ— ç©·ï¼Œæˆ–è€…è¯´è¶‹äºä½¿ç”¨å®Œæ•´çš„çŠ¶æ€åºåˆ—æ—¶ï¼Œnæ­¥æ—¶åºå·®åˆ†å°±ç­‰ä»·äºè’™ç‰¹å¡ç½—æ³•äº†ã€‚ å¯¹äºnæ­¥æ—¶åºå·®åˆ†æ¥è¯´ï¼Œå’Œæ™®é€šçš„æ—¶åºå·®åˆ†çš„åŒºåˆ«å°±åœ¨äºæ”¶è·çš„è®¡ç®—æ–¹å¼çš„å·®å¼‚ã€‚é‚£ä¹ˆæ—¢ç„¶æœ‰è¿™ä¸ªnæ­¥çš„è¯´æ³•ï¼Œé‚£ä¹ˆnåˆ°åº•æ˜¯å¤šå°‘æ­¥å¥½å‘¢ï¼Ÿå¦‚ä½•è¡¡é‡nçš„å¥½åå‘¢ï¼Ÿæˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚è®¨è®ºã€‚ 4. TD(Î») næ­¥æ—¶åºå·®åˆ†é€‰æ‹©å¤šå°‘æ­¥æ•°ä½œä¸ºä¸€ä¸ªè¾ƒä¼˜çš„è®¡ç®—å‚æ•°æ˜¯éœ€è¦å°è¯•çš„è¶…å‚æ•°è°ƒä¼˜é—®é¢˜ã€‚ä¸ºäº†èƒ½åœ¨ä¸å¢åŠ è®¡ç®—å¤æ‚åº¦çš„æƒ…å†µä¸‹ç»¼åˆè€ƒè™‘æ‰€æœ‰æ­¥æ•°çš„é¢„æµ‹ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªæ–°[0,1]çš„å‚æ•° $\\lambda$,å®šä¹‰å…¥â€”æ”¶è·æ˜¯ $n$ ä» $1$ åˆ° $\\infty$ æ‰€æœ‰æ­¥çš„æ”¶è·ä¹˜ä»¥æƒé‡çš„å’Œã€‚æ¯ä¸€æ­¥çš„æƒé‡æ˜¯ $(1-\\lambda)\\lambda^{n-1}$,è¿™æ · $\\lambda-$æ”¶è·çš„è®¡ç®—å…¬å¼è¡¨ç¤ºä¸º: $$G_t^\\lambda=(1-\\lambda)\\sum_{n=1}^\\infty\\lambda^{n-1}G_t^{(n)}$$ è¿›è€Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° $TD(Î»)$ çš„ä»·å€¼å‡½æ•°çš„è¿­ä»£å…¬å¼ï¼š $$V(S_t)=V(S_t)+\\alpha(G_t^\\lambda-V(S_t)) \\\\\\\\ Q(S_t,A_t)=Q(S_t,A_t)+\\alpha(G_t^\\lambda-Q(S_t,A_t)) $$ æ¯ä¸€æ­¥æ”¶è·çš„æƒé‡å®šä¹‰ä¸º $(1âˆ’Î»)Î»^{nâˆ’1}$ çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå…¶å›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°éšç€nçš„å¢å¤§ï¼Œå…¶ç¬¬næ­¥æ”¶è·çš„æƒé‡å‘ˆå‡ ä½•çº§æ•°çš„è¡°å‡ã€‚å½“åœ¨Tæ—¶åˆ»åˆ°è¾¾ç»ˆæ­¢çŠ¶æ€æ—¶ï¼Œæœªåˆ†é…çš„æƒé‡å…¨éƒ¨ç»™äºˆç»ˆæ­¢çŠ¶æ€çš„å®é™…æ”¶è·å€¼ã€‚è¿™æ ·å¯ä»¥ä½¿ä¸€ä¸ªå®Œæ•´çš„çŠ¶æ€åºåˆ—ä¸­æ‰€æœ‰çš„næ­¥æ”¶è·çš„æƒé‡åŠ èµ·æ¥ä¸º1ï¼Œç¦»å½“å‰çŠ¶æ€è¶Šè¿œçš„æ”¶è·å…¶æƒé‡è¶Šå°ã€‚ TD(Î») ä»å‰å‘æ¥çœ‹ $TD(Î»)$ï¼Œ ä¸€ä¸ªçŠ¶æ€çš„ä»·å€¼ $V(St)$ç”± $G_t$å¾—åˆ°ï¼Œè€ŒGtï¿½ï¿½åˆé—´æ¥ç”±æ‰€æœ‰åç»­çŠ¶æ€ä»·å€¼è®¡ç®—å¾—åˆ°ï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºæ›´æ–°ä¸€ä¸ªçŠ¶æ€çš„ä»·å€¼éœ€è¦çŸ¥é“æ‰€æœ‰åç»­çŠ¶æ€çš„ä»·å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¿…é¡»è¦ç»å†å®Œæ•´çš„çŠ¶æ€åºåˆ—è·å¾—åŒ…æ‹¬ç»ˆæ­¢çŠ¶æ€çš„æ¯ä¸€ä¸ªçŠ¶æ€çš„å³æ—¶å¥–åŠ±æ‰èƒ½æ›´æ–°å½“å‰çŠ¶æ€çš„ä»·å€¼ã€‚è¿™å’Œè’™ç‰¹å¡ç½—æ³•çš„è¦æ±‚ä¸€æ ·ï¼Œå› æ­¤TD(Î»)ï¿½ï¿½(ï¿½)æœ‰ç€å’Œè’™ç‰¹å¡ç½—æ³•ä¸€æ ·çš„åŠ£åŠ¿ã€‚å½“ $Î»=0$ æ—¶,å°±æ˜¯ç¬¬äºŒèŠ‚è®²åˆ°çš„æ™®é€šçš„æ—¶åºå·®åˆ†æ³•ï¼Œå½“ $Î»=1$ æ—¶,å°±æ˜¯è’™ç‰¹å¡ç½—æ³•ã€‚ ä»åå‘æ¥çœ‹ $TD(Î»)$ï¼Œå®ƒå¯ä»¥åˆ†ææˆ‘ä»¬çŠ¶æ€å¯¹åç»­çŠ¶æ€çš„å½±å“ã€‚æ¯”å¦‚è€é¼ åœ¨ä¾æ¬¡è¿ç»­æ¥å—äº†3 æ¬¡å“é“ƒå’Œ1 æ¬¡äº®ç¯ä¿¡å·åé­åˆ°äº†ç”µå‡»ï¼Œé‚£ä¹ˆåœ¨åˆ†æé­ç”µå‡»çš„åŸå› æ—¶ï¼Œåˆ°åº•æ˜¯å“é“ƒçš„å› ç´ è¾ƒé‡è¦è¿˜æ˜¯äº®ç¯çš„å› ç´ æ›´é‡è¦å‘¢ï¼Ÿå¦‚æœæŠŠè€é¼ é­åˆ°ç”µå‡»çš„åŸå› è®¤ä¸ºæ˜¯ä¹‹å‰æ¥å—äº†è¾ƒå¤šæ¬¡æ•°çš„å“é“ƒï¼Œåˆ™ç§°è¿™ç§å½’å› ä¸ºé¢‘ç‡å¯å‘(frequency heuristic) å¼ï¼›è€ŒæŠŠç”µå‡»å½’å› äºæœ€è¿‘å°‘æ•°å‡ æ¬¡çŠ¶æ€çš„å½±å“ï¼Œåˆ™ç§°ä¸ºå°±è¿‘å¯å‘(recency heuristic) å¼ã€‚ å¦‚æœç»™æ¯ä¸€ä¸ªçŠ¶æ€å¼•å…¥ä¸€ä¸ªæ•°å€¼ï¼šæ•ˆç”¨(eligibility, E) æ¥è¡¨ç¤ºè¯¥çŠ¶æ€å¯¹åç»­çŠ¶æ€çš„å½±å“ï¼Œå°±å¯ä»¥åŒæ—¶åˆ©ç”¨åˆ°ä¸Šè¿°ä¸¤ä¸ªå¯å‘ã€‚è€Œæ‰€æœ‰çŠ¶æ€çš„æ•ˆç”¨å€¼æ€»ç§°ä¸ºæ•ˆç”¨è¿¹(eligibility traces,ES)ã€‚å®šä¹‰ä¸ºï¼š $$ E_0(s)=0 \\\\\\\\ \\left.E_t(s)=\\gamma\\lambda E_{t-1}(s)+1(S_t=s)=\\left\\\\{\\begin{array}{ll}0\u0026t\u003ck\\\\\\\\(\\gamma\\lambda)^{t-k}\u0026t\\geq k\\end{array}\\right.\\right.,\\quad s.t.\\quad\\lambda,\\","date":"2024-02-22","objectID":"/posts/rl_learning_note_5/:0:0","tags":["draft"],"title":"RLå­¦ä¹ ç¬”è®° [5] | ç”¨æ—¶åºå·®åˆ†æ³•ï¼ˆTDï¼‰æ±‚è§£","uri":"/posts/rl_learning_note_5/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆäº”ï¼‰ç”¨æ—¶åºå·®åˆ†æ³•ï¼ˆTDï¼‰æ±‚è§£ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ç”¨æ—¶åºå·®åˆ†æ¥æ±‚è§£å¼ºåŒ–å­¦ä¹ é¢„æµ‹é—®é¢˜çš„æ–¹æ³•ï¼Œä½†æ˜¯å¯¹æ§åˆ¶ç®—æ³•çš„æ±‚è§£è¿‡ç¨‹æ²¡æœ‰æ·±å…¥ï¼Œæœ¬æ–‡æˆ‘ä»¬å°±å¯¹æ—¶åºå·®åˆ†çš„åœ¨çº¿æ§åˆ¶ç®—æ³•SARSAåšè¯¦ç»†çš„è®¨è®ºã€‚ SARSAè¿™ä¸€ç¯‡å¯¹åº”Suttonä¹¦çš„ç¬¬å…­ç« éƒ¨åˆ†å’ŒUCLå¼ºåŒ–å­¦ä¹ è¯¾ç¨‹çš„ç¬¬äº”è®²éƒ¨åˆ†ã€‚ 1. SARSAç®—æ³•çš„å¼•å…¥ SARSAç®—æ³•æ˜¯ä¸€ç§ä½¿ç”¨æ—¶åºå·®åˆ†æ±‚è§£å¼ºåŒ–å­¦ä¹ æ§åˆ¶é—®é¢˜çš„æ–¹æ³•ï¼Œå›é¡¾ä¸‹æ­¤æ—¶æˆ‘ä»¬çš„æ§åˆ¶é—®é¢˜å¯ä»¥è¡¨ç¤ºä¸ºï¼šç»™å®šå¼ºåŒ–å­¦ä¹ çš„5ä¸ªè¦ç´ ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, å³æ—¶å¥–åŠ± $R$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, æ±‚è§£æœ€ä¼˜çš„åŠ¨ä½œä»·å€¼å‡½æ•° $qâˆ—$ å’Œæœ€ä¼˜ç­–ç•¥ $Ï€âˆ—$ã€‚ è¿™ä¸€ç±»å¼ºåŒ–å­¦ä¹ çš„é—®é¢˜æ±‚è§£ä¸éœ€è¦ç¯å¢ƒçš„çŠ¶æ€è½¬åŒ–æ¨¡å‹ï¼Œæ˜¯ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜æ±‚è§£æ–¹æ³•ã€‚å¯¹äºå®ƒçš„æ§åˆ¶é—®é¢˜æ±‚è§£ï¼Œå’Œè’™ç‰¹å¡ç½—æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯ä»·å€¼è¿­ä»£ï¼Œå³é€šè¿‡ä»·å€¼å‡½æ•°çš„æ›´æ–°ï¼Œæ¥æ›´æ–°å½“å‰çš„ç­–ç•¥ï¼Œå†é€šè¿‡æ–°çš„ç­–ç•¥ï¼Œæ¥äº§ç”Ÿæ–°çš„çŠ¶æ€å’Œå³æ—¶å¥–åŠ±ï¼Œè¿›è€Œæ›´æ–°ä»·å€¼å‡½æ•°ã€‚ä¸€ç›´è¿›è¡Œä¸‹å»ï¼Œç›´åˆ°ä»·å€¼å‡½æ•°å’Œç­–ç•¥éƒ½æ”¶æ•›ã€‚ å†å›é¡¾ä¸‹æ—¶åºå·®åˆ†æ³•çš„æ§åˆ¶é—®é¢˜ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯åœ¨çº¿æ§åˆ¶ï¼Œå³ä¸€ç›´ä½¿ç”¨ä¸€ä¸ªç­–ç•¥æ¥æ›´æ–°ä»·å€¼å‡½æ•°å’Œé€‰æ‹©æ–°çš„åŠ¨ä½œã€‚è€Œå¦ä¸€ç±»æ˜¯ç¦»çº¿æ§åˆ¶ï¼Œä¼šä½¿ç”¨ä¸¤ä¸ªæ§åˆ¶ç­–ç•¥ï¼Œä¸€ä¸ªç­–ç•¥ç”¨äºé€‰æ‹©æ–°çš„åŠ¨ä½œï¼Œå¦ä¸€ä¸ªç­–ç•¥ç”¨äºæ›´æ–°ä»·å€¼å‡½æ•°ã€‚ æˆ‘ä»¬çš„SARSAç®—æ³•ï¼Œå±äºåœ¨çº¿æ§åˆ¶è¿™ä¸€ç±»ï¼Œå³ä¸€ç›´ä½¿ç”¨ä¸€ä¸ªç­–ç•¥æ¥æ›´æ–°ä»·å€¼å‡½æ•°å’Œé€‰æ‹©æ–°çš„åŠ¨ä½œï¼Œè€Œè¿™ä¸ªç­–ç•¥æ˜¯ $Ïµâˆ’$è´ªå©ªæ³•ï¼Œåœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆå››ï¼‰ç”¨è’™ç‰¹å¡ç½—æ³•ï¼ˆMCï¼‰æ±‚è§£ä¸­ï¼Œæˆ‘ä»¬å¯¹äº $Ïµâˆ’$è´ªå©ªæ³•æœ‰è¯¦ç»†è®²è§£ï¼Œå³é€šè¿‡è®¾ç½®ä¸€ä¸ªè¾ƒå°çš„ $Ïµ$ å€¼ï¼Œä½¿ç”¨ $1âˆ’Ïµ$ çš„æ¦‚ç‡è´ªå©ªåœ°é€‰æ‹©ç›®å‰è®¤ä¸ºæ˜¯æœ€å¤§è¡Œä¸ºä»·å€¼çš„è¡Œä¸ºï¼Œè€Œç”¨ $Ïµ$ çš„æ¦‚ç‡éšæœºçš„ä»æ‰€æœ‰ m ä¸ªå¯é€‰è¡Œä¸ºä¸­é€‰æ‹©è¡Œä¸ºã€‚ç”¨å…¬å¼å¯ä»¥è¡¨ç¤ºä¸ºï¼š $$\\left.\\pi(a|s)=\\left\\\\{\\begin{array}{ll}\\epsilon/m+1-\\epsilon\u0026if\\mathrm{~}a^*=\\arg\\max_{a\\in A}Q(s,a)\\\\\\\\\\epsilon/m\u0026else\\end{array}\\right.\\right.$$ Ï€(a|s)={Ïµ/m+1âˆ’Ïµifaâˆ—=argmaxaâˆˆAQ(s,a)Ïµ/melseï¿½(ï¿½|ï¿½)={ï¿½/ï¿½+1âˆ’ï¿½ï¿½ï¿½ï¿½âˆ—=argâ¡maxï¿½âˆˆï¿½ï¿½(ï¿½,ï¿½)ï¿½/ï¿½ï¿½ï¿½ï¿½ï¿½ 2. SARSAç®—æ³•æ¦‚è¿° ä½œä¸ºSARSAç®—æ³•çš„åå­—æœ¬èº«æ¥è¯´ï¼Œå®ƒå®é™…ä¸Šæ˜¯ç”± $S,A,R,S,A$ å‡ ä¸ªå­—æ¯ç»„æˆçš„ã€‚è€Œ $S,A,R$ åˆ†åˆ«ä»£è¡¨çŠ¶æ€ï¼ˆStateï¼‰ï¼ŒåŠ¨ä½œ(Action),å¥–åŠ±(Reward)ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬å‰é¢ä¸€ç›´åœ¨ä½¿ç”¨çš„ç¬¦å·ã€‚è¿™ä¸ªæµç¨‹ä½“ç°åœ¨ä¸‹å›¾ï¼š SARSA Transition åœ¨è¿­ä»£çš„æ—¶å€™ï¼Œæˆ‘ä»¬é¦–å…ˆåŸºäº $Ïµâˆ’$è´ªå©ªæ³•åœ¨å½“å‰çŠ¶æ€ $S$ é€‰æ‹©ä¸€ä¸ªåŠ¨ä½œ $A$ ï¼Œè¿™æ ·ç³»ç»Ÿä¼šè½¬åˆ°ä¸€ä¸ªæ–°çš„çŠ¶æ€ $Sâ€²$, åŒæ—¶ç»™æˆ‘ä»¬ä¸€ä¸ªå³æ—¶å¥–åŠ± $R$ , åœ¨æ–°çš„çŠ¶æ€ $Sâ€²$ï¼Œæˆ‘ä»¬ä¼šåŸºäº $Ïµâˆ’$è´ªå©ªæ³•åœ¨çŠ¶æ€ $Sâ€²$ é€‰æ‹©ä¸€ä¸ªåŠ¨ä½œ $Aâ€²$ï¼Œä½†æ˜¯æ³¨æ„è¿™æ—¶å€™æˆ‘ä»¬å¹¶ä¸æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ $Aâ€²$ï¼Œåªæ˜¯ç”¨æ¥æ›´æ–°çš„æˆ‘ä»¬çš„ä»·å€¼å‡½æ•°ï¼Œä»·å€¼å‡½æ•°çš„æ›´æ–°å…¬å¼æ˜¯ï¼š $$Q(S,A)=Q(S,A)+\\alpha(R+\\gamma Q(S^{\\prime},A^{\\prime})-Q(S,A))$$ å…¶ä¸­ï¼Œ$Î³$ æ˜¯è¡°å‡å› å­ï¼Œ$Î±$ æ˜¯è¿­ä»£æ­¥é•¿ã€‚è¿™é‡Œå’Œè’™ç‰¹å¡ç½—æ³•æ±‚è§£åœ¨çº¿æ§åˆ¶é—®é¢˜çš„è¿­ä»£å…¬å¼çš„åŒºåˆ«ä¸»è¦æ˜¯ï¼Œæ”¶è· $G_t$çš„è¡¨è¾¾å¼ä¸åŒï¼Œå¯¹äºæ—¶åºå·®åˆ†ï¼Œæ”¶è· $G_t$çš„è¡¨è¾¾å¼æ˜¯ $R+\\gamma Q(Sâ€™,Aâ€™)$ ã€‚è¿™ä¸ªä»·å€¼å‡½æ•°æ›´æ–°çš„è´å°”æ›¼å…¬å¼æˆ‘ä»¬åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆäº”ï¼‰ç”¨æ—¶åºå·®åˆ†æ³•ï¼ˆTDï¼‰æ±‚è§£ç¬¬2èŠ‚æœ‰è¯¦ç»†è®²åˆ°ã€‚ é™¤äº†æ”¶è· $G_t$çš„è¡¨è¾¾å¼ä¸åŒï¼ŒSARSAç®—æ³•å’Œè’™ç‰¹å¡ç½—åœ¨çº¿æ§åˆ¶ç®—æ³•åŸºæœ¬ç±»ä¼¼ã€‚ 3. SARSAç®—æ³•æµç¨‹ ä¸‹é¢æˆ‘ä»¬æ€»ç»“ä¸‹SARSAç®—æ³•çš„æµç¨‹ã€‚ ç®—æ³•è¾“å…¥ï¼šè¿­ä»£è½®æ•° $T$ï¼ŒçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, æ­¥é•¿ $Î±$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, è¾“å‡ºï¼šæ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œå¯¹åº”çš„ä»·å€¼ $Q$ éšæœºåˆå§‹åŒ–æ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œå¯¹åº”çš„ä»·å€¼Qï¿½. å¯¹äºç»ˆæ­¢çŠ¶æ€å…¶Qï¿½å€¼åˆå§‹åŒ–ä¸º0. for i from 1 to Tï¼Œè¿›è¡Œè¿­ä»£ã€‚ a) åˆå§‹åŒ– $S$ ä¸ºå½“å‰çŠ¶æ€åºåˆ—çš„ç¬¬ä¸€ä¸ªçŠ¶æ€ã€‚è®¾ç½® $A$ ä¸º $Ïµâˆ’$è´ªå©ªæ³•åœ¨å½“å‰çŠ¶æ€$S$ é€‰æ‹©çš„åŠ¨ä½œã€‚ b) åœ¨çŠ¶æ€ $S$ æ‰§è¡Œå½“å‰åŠ¨ä½œ $A$ ,å¾—åˆ°æ–°çŠ¶æ€ $Sâ€²$ å’Œ å¥–åŠ± $R$ c) ç”¨ $\\epsilon-$è´ªå©ªæ³•åœ¨çŠ¶æ€ $Sâ€™$ é€‰æ‹©æ–°çš„åŠ¨ä½œ $A'$ d) æ›´æ–°ä»·å€¼å‡½æ•° $Q(S,A)$: $$Q(S,A)=Q(S,A)+\\alpha(R+\\gamma Q(S^{\\prime},A^{\\prime})-Q(S,A))$$ e) $S=Sâ€²$, $A=Aâ€²$ f) å¦‚æœ $Sâ€²$ æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œå½“å‰è½®è¿­ä»£å®Œæ¯•ï¼Œå¦åˆ™è½¬åˆ°æ­¥éª¤b) è¿™é‡Œæœ‰ä¸€ä¸ªè¦æ³¨æ„çš„æ˜¯ï¼Œæ­¥é•¿ $Î±$ä¸€èˆ¬éœ€è¦éšç€è¿­ä»£çš„è¿›è¡Œé€æ¸å˜å°ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯åŠ¨ä½œä»·å€¼å‡½æ•° $Q$ å¯ä»¥æ”¶æ•›ã€‚å½“ $Q$ æ”¶æ•›æ—¶ï¼Œæˆ‘ä»¬çš„ç­–ç•¥ $Ïµâˆ’$è´ªå©ªæ³•ä¹Ÿå°±æ”¶æ•›äº†ã€‚ 4. SARSAç®—æ³•å®ä¾‹ï¼šWindy GridWorld ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªè‘—åçš„å®ä¾‹Windy GridWorldæ¥ç ”ç©¶SARSAç®—æ³•ã€‚ å¦‚ä¸‹å›¾ä¸€ä¸ª10Ã—7çš„é•¿æ–¹å½¢æ ¼å­ä¸–ç•Œï¼Œæ ‡è®°æœ‰ä¸€ä¸ªèµ·å§‹ä½ç½® S å’Œä¸€ä¸ªç»ˆæ­¢ç›®æ ‡ä½ç½® Gï¼Œæ ¼å­ä¸‹æ–¹çš„æ•°å­—è¡¨ç¤ºå¯¹åº”çš„åˆ—ä¸­ä¸€å®šå¼ºåº¦çš„é£ã€‚å½“ä¸ªä½“è¿›å…¥è¯¥åˆ—çš„æŸä¸ªæ ¼å­æ—¶ï¼Œä¼šæŒ‰å›¾ä¸­ç®­å¤´æ‰€ç¤ºçš„æ–¹å‘è‡ªåŠ¨ç§»åŠ¨æ•°å­—è¡¨ç¤ºçš„æ ¼æ•°ï¼Œå€Ÿæ­¤æ¥æ¨¡æ‹Ÿä¸–ç•Œä¸­é£çš„ä½œç”¨ã€‚åŒæ ·æ ¼å­ä¸–ç•Œæ˜¯æœ‰è¾¹ç•Œçš„ï¼Œä¸ªä½“ä»»æ„æ—¶åˆ»åªèƒ½å¤„åœ¨ä¸–ç•Œå†…éƒ¨çš„ä¸€ä¸ªæ ¼å­ä¸­ã€‚ä¸ªä½“å¹¶ä¸æ¸…æ¥šè¿™ä¸ªä¸–ç•Œçš„æ„é€ ä»¥åŠæœ‰é£ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¸çŸ¥é“æ ¼å­æ˜¯é•¿æ–¹å½¢çš„ï¼Œä¹Ÿä¸çŸ¥é“è¾¹ç•Œåœ¨å“ªé‡Œï¼Œä¹Ÿä¸çŸ¥é“è‡ªå·±åœ¨é‡Œé¢ç§»åŠ¨ç§»æ­¥åä¸‹ä¸€ä¸ªæ ¼å­ä¸ä¹‹å‰æ ¼å­çš„ç›¸å¯¹ä½ç½®å…³ç³»ï¼Œå½“ç„¶å®ƒä¹Ÿä¸æ¸…æ¥šèµ·å§‹ä½ç½®ã€ç»ˆæ­¢ç›®æ ‡çš„å…·ä½“ä½ç½®ã€‚ä½†æ˜¯ä¸ªä½“ä¼šè®°ä½æ›¾ç»ç»è¿‡çš„æ ¼å­ï¼Œä¸‹æ¬¡åœ¨è¿›å…¥è¿™ä¸ªæ ¼å­æ—¶ï¼Œå®ƒèƒ½å‡†ç¡®çš„è¾¨è®¤å‡ºè¿™ä¸ªæ ¼å­æ›¾ç»ä»€ä¹ˆæ—¶å€™æ¥è¿‡ã€‚æ ¼å­å¯ä»¥æ‰§è¡Œçš„è¡Œä¸ºæ˜¯æœä¸Šã€ä¸‹ã€å·¦ã€å³ç§»åŠ¨ä¸€æ­¥ï¼Œæ¯ç§»åŠ¨ä¸€æ­¥åªè¦ä¸æ˜¯è¿›å…¥ç›®æ ‡ä½ç½®éƒ½ç»™äºˆä¸€ä¸ª -1 çš„æƒ©ç½šï¼Œç›´è‡³è¿›å…¥ç›®æ ‡ä½ç½®åè·å¾—å¥–åŠ± 0 åŒæ—¶æ°¸ä¹…åœç•™åœ¨è¯¥ä½ç½®ã€‚ç°åœ¨è¦æ±‚è§£çš„é—®é¢˜æ˜¯ä¸ªä½“åº”è¯¥éµå¾ªæ€æ ·çš„ç­–ç•¥æ‰èƒ½å°½å¿«çš„ä»èµ·å§‹ä½ç½®åˆ°è¾¾ç›®æ ‡ä½ç½®ã€‚ Windy GridWorld é€»è¾‘å¹¶ä¸å¤æ‚ï¼Œå®Œæ•´çš„ä»£ç åœ¨æˆ‘çš„githubã€‚è¿™é‡Œæˆ‘ä¸»è¦çœ‹ä¸€ä¸‹å…³é”®éƒ¨åˆ†çš„ä»£ç ã€‚ ç®—æ³•ä¸­ç¬¬2æ­¥æ­¥éª¤a,åˆå§‹åŒ– $S$,ä½¿ç”¨ $Ïµâˆ’$è´ªå©ªæ³•åœ¨å½“å‰çŠ¶æ€ $S$ é€‰æ‹©çš„åŠ¨ä½œçš„è¿‡ç¨‹ï¼š # initialize state state = START # choose an action based on epsilon-greedy algorithm if np.random.binomial(1, EPSILON) == 1: action = np.random.choice(ACTIONS) else: values_ = q_value[state[0], state[1], :] action = np.random.choice([action_ for action_, value_ in enumerate(values_) if value_ == np.max(values_)]) ç®—æ³•ä¸­ç¬¬2æ­¥æ­¥éª¤b,åœ¨çŠ¶æ€Sï¿½æ‰§è¡Œå½“å‰åŠ¨ä½œAï¿½,å¾—åˆ°æ–°çŠ¶æ€Sâ€²ï¿½â€²çš„è¿‡ç¨‹ï¼Œç”±äºå¥–åŠ±ä¸æ˜¯ç»ˆæ­¢å°±æ˜¯-1ï¼Œä¸éœ€è¦å•ç‹¬è®¡ç®—ï¼š def step(state, action): i, j = state if action == ACTION_UP: return [max(i - 1 - WIND[j], 0), j] elif action == ACTION_DOWN: return [max(min(i + 1 - WIND[j], WORLD_HEIGHT - 1), 0), j] elif action == ACTION_LEFT: return [max(i - WIND[j], 0), max(j - 1, 0)] elif action == ACTION_RIGHT: return [max(i - WIND[j], 0), min(j + 1, WORLD_WIDTH - 1)] else: assert False ç®—æ³•ä¸­ç¬¬2æ­¥æ­¥éª¤c,ç”¨ $Ïµâˆ’$è´ªå©ªæ³•åœ¨çŠ¶æ€ $Sâ€™$é€‰æ‹©æ–°çš„åŠ¨ä½œ $Aâ€²$çš„è¿‡ç¨‹ï¼š next_state = step(state, action) if np.random.binomial(1, EPSILON) == 1: next_action = np.random.choice(ACTIONS) else: values_ = q_value[next_state[0], next_state[1], :] next_action = np.random.choice([action_ for action_, value_ in enumerate(values_) if value_ == np.max(values_)]) ç®—æ³•ä¸­ç¬¬2æ­¥æ­¥éª¤d,e, æ›´æ–°ä»·å€¼å‡½æ•° $Q(S,A)$ ä»¥åŠæ›´æ–°å½“å‰çŠ¶æ€åŠ¨ä½œçš„è¿‡ç¨‹ï¼š # Sarsa update q_value[state[0], state[1], action] += \\ ALPHA * (REWARD + q_value[next_state[0], next_state[1], next_action] - q_value[state[0], state[1], action]) state = next_state action = next_action ä»£ç å¾ˆç®€å•ï¼Œç›¸ä¿¡å¤§å®¶å¯¹ç…§ç®—æ³•ï¼Œè·‘è·‘ä»£ç ï¼Œå¯ä»¥å¾ˆå®¹æ˜“å¾—åˆ°è¿™ä¸ª","date":"2024-02-22","objectID":"/posts/rl_learning_note_6/:0:0","tags":["RL"],"title":"RLå­¦ä¹ ç¬”è®° [6] | æ—¶åºå·®åˆ†åœ¨çº¿æ§åˆ¶ç®—æ³•SARSA","uri":"/posts/rl_learning_note_6/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆä¸‰ï¼‰ç”¨åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰æ±‚è§£ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ç”¨åŠ¨æ€è§„åˆ’æ¥æ±‚è§£å¼ºåŒ–å­¦ä¹ é¢„æµ‹é—®é¢˜å’Œæ§åˆ¶é—®é¢˜çš„æ–¹æ³•ã€‚ä½†æ˜¯ç”±äºåŠ¨æ€è§„åˆ’æ³•éœ€è¦åœ¨æ¯ä¸€æ¬¡å›æº¯æ›´æ–°æŸä¸€ä¸ªçŠ¶æ€çš„ä»·å€¼æ—¶ï¼Œå›æº¯åˆ°è¯¥çŠ¶æ€çš„æ‰€æœ‰å¯èƒ½çš„åç»­çŠ¶æ€ã€‚å¯¼è‡´å¯¹äºå¤æ‚é—®é¢˜è®¡ç®—é‡å¾ˆå¤§ã€‚åŒæ—¶å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬è¿ç¯å¢ƒçš„çŠ¶æ€è½¬åŒ–æ¨¡å‹ $P$ éƒ½æ— æ³•çŸ¥é“ï¼Œè¿™æ—¶åŠ¨æ€è§„åˆ’æ³•æ ¹æœ¬æ²¡æ³•ä½¿ç”¨ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¦‚ä½•æ±‚è§£å¼ºåŒ–å­¦ä¹ é—®é¢˜å‘¢ï¼Ÿæœ¬æ–‡è¦è®¨è®ºçš„è’™ç‰¹å¡ç½—(Monte-Calo, MC)å°±æ˜¯ä¸€ç§å¯è¡Œçš„æ–¹æ³•ã€‚ è’™ç‰¹å¡ç½—æ³•è¿™ä¸€ç¯‡å¯¹åº”Suttonä¹¦çš„ç¬¬äº”ç« å’ŒUCLå¼ºåŒ–å­¦ä¹ è¯¾ç¨‹çš„ç¬¬å››è®²éƒ¨åˆ†ï¼Œç¬¬äº”è®²éƒ¨åˆ†ã€‚ 1. ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜å®šä¹‰ åœ¨åŠ¨æ€è§„åˆ’æ³•ä¸­ï¼Œå¼ºåŒ–å­¦ä¹ çš„ä¸¤ä¸ªé—®é¢˜æ˜¯è¿™æ ·å®šä¹‰çš„: é¢„æµ‹é—®é¢˜ï¼Œå³ç»™å®šå¼ºåŒ–å­¦ä¹ çš„6ä¸ªè¦ç´ ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, æ¨¡å‹çŠ¶æ€è½¬åŒ–æ¦‚ç‡çŸ©é˜µ $P$, å³æ—¶å¥–åŠ± $R$ï¼Œè¡°å‡å› å­ $Î³$, ç»™å®šç­–ç•¥ $Ï€$ï¼Œ æ±‚è§£è¯¥ç­–ç•¥çš„çŠ¶æ€ä»·å€¼å‡½æ•° $v(Ï€)$ æ§åˆ¶é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æ±‚è§£æœ€ä¼˜çš„ä»·å€¼å‡½æ•°å’Œç­–ç•¥ã€‚ç»™å®šå¼ºåŒ–å­¦ä¹ çš„5ä¸ªè¦ç´ ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, æ¨¡å‹çŠ¶æ€è½¬åŒ–æ¦‚ç‡çŸ©é˜µ $P$, å³æ—¶å¥–åŠ± $R$ï¼Œè¡°å‡å› å­ $Î³$, æ±‚è§£æœ€ä¼˜çš„çŠ¶æ€ä»·å€¼å‡½æ•° $vâˆ—$ å’Œæœ€ä¼˜ç­–ç•¥ $Ï€âˆ—$ã€€å¯è§, æ¨¡å‹çŠ¶æ€è½¬åŒ–æ¦‚ç‡çŸ©é˜µ $P$ å§‹ç»ˆæ˜¯å·²çŸ¥çš„ï¼Œå³MDPå·²çŸ¥ï¼Œå¯¹äºè¿™æ ·çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¸ºåŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜ã€‚ ä¸è¿‡æœ‰å¾ˆå¤šå¼ºåŒ–å­¦ä¹ é—®é¢˜ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•äº‹å…ˆå¾—åˆ°æ¨¡å‹çŠ¶æ€è½¬åŒ–æ¦‚ç‡çŸ©é˜µ $P$ ï¼Œè¿™æ—¶å¦‚æœä»ç„¶éœ€è¦æˆ‘ä»¬æ±‚è§£å¼ºåŒ–å­¦ä¹ é—®é¢˜ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜äº†ã€‚å®ƒçš„ä¸¤ä¸ªé—®é¢˜ä¸€èˆ¬çš„å®šä¹‰æ˜¯ï¼š é¢„æµ‹é—®é¢˜ï¼Œå³ç»™å®šå¼ºåŒ–å­¦ä¹ çš„5ä¸ªè¦ç´ ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, å³æ—¶å¥–åŠ± $R$ï¼Œè¡°å‡å› å­ $Î³$ , ç»™å®šç­–ç•¥ $Ï€$ï¼Œ æ±‚è§£è¯¥ç­–ç•¥çš„çŠ¶æ€ä»·å€¼å‡½æ•° $v(Ï€)$ æ§åˆ¶é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æ±‚è§£æœ€ä¼˜çš„ä»·å€¼å‡½æ•°å’Œç­–ç•¥ã€‚ç»™å®šå¼ºåŒ–å­¦ä¹ çš„5ä¸ªè¦ç´ ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, å³æ—¶å¥–åŠ± $R$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡ $Ïµ$, æ±‚è§£æœ€ä¼˜çš„åŠ¨ä½œä»·å€¼å‡½æ•° $qâˆ—$ å’Œæœ€ä¼˜ç­–ç•¥ $Ï€âˆ—$ã€€æœ¬æ–‡è¦è®¨è®ºçš„è’™ç‰¹å¡ç½—æ³•å°±æ˜¯ä¸Šè¿°ä¸åŸºäºæ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜ã€‚ 2. è’™ç‰¹å¡ç½—æ³•æ±‚è§£ç‰¹ç‚¹ è’™ç‰¹å¡ç½—è¿™ä¸ªè¯ä¹‹å‰çš„åšæ–‡ä¹Ÿè®¨è®ºè¿‡ï¼Œå°¤å…¶æ˜¯åœ¨ä¹‹å‰çš„MCMCç³»åˆ—ä¸­ã€‚å®ƒæ˜¯ä¸€ç§é€šè¿‡é‡‡æ ·è¿‘ä¼¼æ±‚è§£é—®é¢˜çš„æ–¹æ³•ã€‚è¿™é‡Œçš„è’™ç‰¹å¡ç½—æ³•è™½ç„¶å’ŒMCMCä¸åŒï¼Œä½†æ˜¯é‡‡æ ·çš„æ€è·¯è¿˜æ˜¯ä¸€è‡´çš„ã€‚é‚£ä¹ˆå¦‚ä½•é‡‡æ ·å‘¢ï¼Ÿ è’™ç‰¹å¡ç½—æ³•é€šè¿‡é‡‡æ ·è‹¥å¹²ç»å†å®Œæ•´çš„çŠ¶æ€åºåˆ—(episode)æ¥ä¼°è®¡çŠ¶æ€çš„çœŸå®ä»·å€¼ã€‚æ‰€è°“çš„ç»å†å®Œæ•´ï¼Œå°±æ˜¯è¿™ä¸ªåºåˆ—å¿…é¡»æ˜¯è¾¾åˆ°ç»ˆç‚¹çš„ã€‚æ¯”å¦‚ä¸‹æ£‹é—®é¢˜åˆ†å‡ºè¾“èµ¢ï¼Œé©¾è½¦é—®é¢˜æˆåŠŸåˆ°è¾¾ç»ˆç‚¹æˆ–è€…å¤±è´¥ã€‚æœ‰äº†å¾ˆå¤šç»„è¿™æ ·ç»å†å®Œæ•´çš„çŠ¶æ€åºåˆ—ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥è¿‘ä¼¼çš„ä¼°è®¡çŠ¶æ€ä»·å€¼ï¼Œè¿›è€Œæ±‚è§£é¢„æµ‹å’Œæ§åˆ¶é—®é¢˜äº†ã€‚ ä»ç‰¹å¡ç½—æ³•æ³•çš„ç‰¹ç‚¹æ¥è¯´ï¼Œä¸€æ˜¯å’ŒåŠ¨æ€è§„åˆ’æ¯”ï¼Œå®ƒä¸éœ€è¦ä¾èµ–äºæ¨¡å‹çŠ¶æ€è½¬åŒ–æ¦‚ç‡ã€‚äºŒæ˜¯å®ƒä»ç»å†è¿‡çš„å®Œæ•´åºåˆ—å­¦ä¹ ï¼Œå®Œæ•´çš„ç»å†è¶Šå¤šï¼Œå­¦ä¹ æ•ˆæœè¶Šå¥½ã€‚ 3. è’™ç‰¹å¡ç½—æ³•æ±‚è§£å¼ºåŒ–å­¦ä¹ é¢„æµ‹é—®é¢˜ è¿™é‡Œæˆ‘ä»¬å…ˆæ¥è®¨è®ºè’™ç‰¹å¡ç½—æ³•æ±‚è§£å¼ºåŒ–å­¦ä¹ é¢„æµ‹é—®é¢˜çš„æ–¹æ³•ï¼Œå³ç­–ç•¥è¯„ä¼°ã€‚ä¸€ä¸ªç»™å®šç­–ç•¥ $Ï€$ çš„å®Œæ•´æœ‰Tä¸ªçŠ¶æ€çš„çŠ¶æ€åºåˆ—å¦‚ä¸‹ï¼š $$S_1,A_1,R_2,S_2,A_2,\\ldots S_t,A_t,R_{t+1},\\ldots R_T,S_T$$ å›å¿†ä¸‹å¼ºåŒ–å­¦ä¹ ï¼ˆäºŒï¼‰é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹(MDP)ä¸­å¯¹äºä»·å€¼å‡½æ•° $v_Ï€(s)$çš„å®šä¹‰: $$v_\\pi(s)=\\mathbb{E}_\\pi(G_t|S_t=s)=\\mathbb{E}_\\pi(R_{t+1}+\\gamma R_{t+2}+\\gamma^2R_{t+3}+\\ldots|S_t=s)$$ å¯ä»¥çœ‹å‡ºæ¯ä¸ªçŠ¶æ€çš„ä»·å€¼å‡½æ•°ç­‰äºæ‰€æœ‰è¯¥çŠ¶æ€æ”¶è·çš„æœŸæœ›ï¼ŒåŒæ—¶è¿™ä¸ªæ”¶è·æ˜¯é€šè¿‡åç»­çš„å¥–åŠ±ä¸å¯¹åº”çš„è¡°å‡ä¹˜ç§¯æ±‚å’Œå¾—åˆ°ã€‚é‚£ä¹ˆå¯¹äºè’™ç‰¹å¡ç½—æ³•æ¥è¯´ï¼Œå¦‚æœè¦æ±‚æŸä¸€ä¸ªçŠ¶æ€çš„çŠ¶æ€ä»·å€¼ï¼Œåªéœ€è¦æ±‚å‡ºæ‰€æœ‰çš„å®Œæ•´åºåˆ—ä¸­è¯¥çŠ¶æ€å‡ºç°æ—¶å€™çš„æ”¶è·å†å–å¹³å‡å€¼å³å¯è¿‘ä¼¼æ±‚è§£ï¼Œä¹Ÿå°±æ˜¯ï¼š $$G_t=R_{t+1}+\\gamma R_{t+2}+\\gamma^2R_{t+3}+\\ldots\\gamma^{T-t-1}R_T$$ $$v_\\pi(s)\\approx average(G_t),s.t.S_t=s$$ å¯ä»¥çœ‹å‡ºï¼Œé¢„æµ‹é—®é¢˜çš„æ±‚è§£æ€è·¯è¿˜æ˜¯å¾ˆç®€å•çš„ã€‚ä¸è¿‡æœ‰å‡ ä¸ªç‚¹å¯ä»¥ä¼˜åŒ–è€ƒè™‘ã€‚ ç¬¬ä¸€ä¸ªç‚¹æ˜¯: åŒæ ·ä¸€ä¸ªçŠ¶æ€å¯èƒ½åœ¨ä¸€ä¸ªå®Œæ•´çš„çŠ¶æ€åºåˆ—ä¸­é‡å¤å‡ºç°ï¼Œé‚£ä¹ˆè¯¥çŠ¶æ€çš„æ”¶è·è¯¥å¦‚ä½•è®¡ç®—ï¼Ÿæœ‰ä¸¤ç§è§£å†³æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ˜¯ä»…æŠŠçŠ¶æ€åºåˆ—ä¸­ç¬¬ä¸€æ¬¡å‡ºç°è¯¥çŠ¶æ€æ—¶çš„æ”¶è·å€¼çº³å…¥åˆ°æ”¶è·å¹³å‡å€¼çš„è®¡ç®—ä¸­ï¼›å¦ä¸€ç§æ˜¯é’ˆå¯¹ä¸€ä¸ªçŠ¶æ€åºåˆ—ä¸­æ¯æ¬¡å‡ºç°çš„è¯¥çŠ¶æ€ï¼Œéƒ½è®¡ç®—å¯¹åº”çš„æ”¶è·å€¼å¹¶çº³å…¥åˆ°æ”¶è·å¹³å‡å€¼çš„è®¡ç®—ä¸­ã€‚ä¸¤ç§æ–¹æ³•å¯¹åº”çš„è’™ç‰¹å¡ç½—æ³•åˆ†åˆ«ç§°ä¸ºï¼šé¦–æ¬¡è®¿é—®(first visit) å’Œæ¯æ¬¡è®¿é—®(every visit) è’™ç‰¹å¡ç½—æ³•ã€‚ç¬¬äºŒç§æ–¹æ³•æ¯”ç¬¬ä¸€ç§çš„è®¡ç®—é‡è¦å¤§ä¸€äº›ï¼Œä½†æ˜¯åœ¨å®Œæ•´çš„ç»å†æ ·æœ¬åºåˆ—å°‘çš„åœºæ™¯ä¸‹ä¼šæ¯”ç¬¬ä¸€ç§æ–¹æ³•é€‚ç”¨ã€‚ ç¬¬äºŒä¸ªç‚¹æ˜¯ç´¯è¿›æ›´æ–°å¹³å‡å€¼(incremental mean)ã€‚åœ¨ä¸Šé¢é¢„æµ‹é—®é¢˜çš„æ±‚è§£å…¬å¼é‡Œï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªaverageçš„å…¬å¼ï¼Œæ„å‘³ç€è¦ä¿å­˜æ‰€æœ‰è¯¥çŠ¶æ€çš„æ”¶è·å€¼ä¹‹å’Œæœ€åå–å¹³å‡ã€‚è¿™æ ·æµªè´¹äº†å¤ªå¤šçš„å­˜å‚¨ç©ºé—´ã€‚ä¸€ä¸ªè¾ƒå¥½çš„æ–¹æ³•æ˜¯åœ¨è¿­ä»£è®¡ç®—æ”¶è·å‡å€¼ï¼Œå³æ¯æ¬¡ä¿å­˜ä¸Šä¸€è½®è¿­ä»£å¾—åˆ°çš„æ”¶è·å‡å€¼ä¸æ¬¡æ•°ï¼Œå½“è®¡ç®—å¾—åˆ°å½“å‰è½®çš„æ”¶è·æ—¶ï¼Œå³å¯è®¡ç®—å½“å‰è½®æ”¶è·å‡å€¼å’Œæ¬¡æ•°ã€‚é€šè¿‡ä¸‹é¢çš„å…¬å¼å°±å¾ˆå®¹æ˜“ç†è§£è¿™ä¸ªè¿‡ç¨‹ï¼š $$\\mu_k=\\frac1k\\sum_{j=1}^kx_j=\\frac1k(x_k+\\sum_{j=1}^{k-1}x_j)=\\frac1k(x_k+(k-1)\\mu_{k-1})=\\mu_{k-1}+\\frac1k(x_k-\\mu_{k-1})$$ è¿™æ ·ä¸Šé¢çš„çŠ¶æ€ä»·å€¼å…¬å¼å°±å¯ä»¥æ”¹å†™æˆï¼š $$N(S_t)=N(S_t)+1$$ $$V(S_t)=V(S_t)+\\frac1{N(S_t)}(G_t-V(S_t))$$ è¿™æ ·æˆ‘ä»¬æ— è®ºæ•°æ®é‡æ˜¯å¤šè¿˜æ˜¯å°‘ï¼Œç®—æ³•éœ€è¦çš„å†…å­˜åŸºæœ¬æ˜¯å›ºå®šçš„ ã€‚ æœ‰æ—¶å€™ï¼Œå°¤å…¶æ˜¯æµ·é‡æ•°æ®åšåˆ†å¸ƒå¼è¿­ä»£çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½æ— æ³•å‡†ç¡®è®¡ç®—å½“å‰çš„æ¬¡æ•° $N(S_t)$,è¿™æ—¶æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç³»æ•° $Î±$ æ¥ä»£æ›¿ï¼Œå³ï¼š $$V(S_t)=V(S_t)+\\alpha(G_t-V(S_t))$$ å¯¹äºåŠ¨ä½œä»·å€¼å‡½æ•° $Q(S_t,A_t)$,ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œæ¯”å¦‚å¯¹ä¸Šé¢æœ€åä¸€ä¸ªå¼å­ï¼ŒåŠ¨ä½œä»·å€¼å‡½æ•°ç‰ˆæœ¬ä¸ºï¼š $$Q(S_t,A_t)=Q(S_t,A_t)+\\alpha(G_t-Q(S_t,A_t))$$ ä»¥ä¸Šå°±æ˜¯è’™ç‰¹å¡ç½—æ³•æ±‚è§£é¢„æµ‹é—®é¢˜çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹æ§åˆ¶é—®é¢˜æ±‚è§£ã€‚ 4. è’™ç‰¹å¡ç½—æ³•æ±‚è§£å¼ºåŒ–å­¦ä¹ æ§åˆ¶é—®é¢˜ è’™ç‰¹å¡ç½—æ³•æ±‚è§£æ§åˆ¶é—®é¢˜çš„æ€è·¯å’ŒåŠ¨æ€è§„åˆ’ä»·å€¼è¿­ä»£çš„çš„æ€è·¯ç±»ä¼¼ã€‚å›å¿†ä¸‹åŠ¨æ€è§„åˆ’ä»·å€¼è¿­ä»£çš„çš„æ€è·¯ï¼Œ æ¯è½®è¿­ä»£å…ˆåšç­–ç•¥è¯„ä¼°ï¼Œè®¡ç®—å‡ºä»·å€¼ $v_k(s)$ ï¼Œç„¶ååŸºäºæ®ä¸€å®šçš„æ–¹æ³•ï¼ˆæ¯”å¦‚è´ªå©ªæ³•ï¼‰æ›´æ–°å½“å‰ç­–ç•¥ $Ï€$ã€‚æœ€åå¾—åˆ°æœ€ä¼˜ä»·å€¼å‡½æ•° $vâˆ—$ å’Œæœ€ä¼˜ç­–ç•¥ $Ï€âˆ—$ã€‚ å’ŒåŠ¨æ€è§„åˆ’æ¯”ï¼Œè’™ç‰¹å¡ç½—æ³•ä¸åŒä¹‹å¤„ä½“ç°åœ¨ä¸‰ç‚¹: ä¸€æ˜¯é¢„æµ‹é—®é¢˜ç­–ç•¥è¯„ä¼°çš„æ–¹æ³•ä¸åŒï¼Œè¿™ä¸ªç¬¬ä¸‰èŠ‚å·²ç»è®²äº†ã€‚ ç¬¬äºŒæ˜¯è’™ç‰¹å¡ç½—æ³•ä¸€èˆ¬æ˜¯ä¼˜åŒ–æœ€ä¼˜åŠ¨ä½œä»·å€¼å‡½æ•° $qâˆ—$ï¼Œè€Œä¸æ˜¯çŠ¶æ€ä»·å€¼å‡½æ•° $vâˆ—$ã€‚ ä¸‰æ˜¯åŠ¨æ€è§„åˆ’ä¸€èˆ¬åŸºäºè´ªå©ªæ³•æ›´æ–°ç­–ç•¥ã€‚è€Œè’™ç‰¹å¡ç½—æ³•ä¸€èˆ¬é‡‡ç”¨ $Ïµâˆ’$è´ªå©ªæ³•æ›´æ–°ã€‚è¿™ä¸ª $Ïµ$ å°±æ˜¯æˆ‘ä»¬åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆä¸€ï¼‰æ¨¡å‹åŸºç¡€ä¸­è®²åˆ°çš„ç¬¬8ä¸ªæ¨¡å‹è¦ç´  $Ïµ$ã€‚$Ïµâˆ’$è´ªå©ªæ³•é€šè¿‡è®¾ç½®ä¸€ä¸ªè¾ƒå°çš„ $Ïµ$ å€¼ï¼Œä½¿ç”¨ $1âˆ’Ïµ$ çš„æ¦‚ç‡è´ªå©ªåœ°é€‰æ‹©ç›®å‰è®¤ä¸ºæ˜¯æœ€å¤§è¡Œä¸ºä»·å€¼çš„è¡Œä¸ºï¼Œè€Œç”¨ $Ïµ$ çš„æ¦‚ç‡éšæœºçš„ä»æ‰€æœ‰ $m$ ä¸ªå¯é€‰è¡Œä¸ºä¸­é€‰æ‹©è¡Œä¸ºã€‚ç”¨å…¬å¼å¯ä»¥è¡¨ç¤ºä¸ºï¼š $$\\left.\\pi(a|s)=\\left\\\\{\\begin{array}{ll}\\epsilon/m+1-\\epsilon\u0026if\\mathrm{~}a^*=\\arg\\max_{a\\in A}Q(s,a)\\\\\\\\\\epsilon/m\u0026else\\end{array}\\right.\\right.$$ åœ¨å®é™…æ±‚è§£æ§åˆ¶é—®é¢˜æ—¶ï¼Œä¸ºäº†ä½¿ç®—æ³•å¯ä»¥æ”¶æ•›ï¼Œä¸€èˆ¬ $Ïµ$ä¼šéšç€ç®—æ³•çš„è¿­ä»£è¿‡ç¨‹é€æ¸å‡å°ï¼Œå¹¶è¶‹äº0ã€‚è¿™æ ·åœ¨è¿­ä»£å‰æœŸï¼Œæˆ‘ä»¬é¼“åŠ±æ¢ç´¢ï¼Œè€Œåœ¨åæœŸï¼Œç”±äºæˆ‘ä»¬æœ‰äº†è¶³å¤Ÿçš„æ¢ç´¢é‡ï¼Œå¼€å§‹è¶‹äºä¿å®ˆï¼Œä»¥è´ªå©ªä¸ºä¸»ï¼Œä½¿ç®—æ³•å¯ä»¥ç¨³å®šæ”¶æ•›ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€å¼ å’ŒåŠ¨æ€è§„åˆ’ç±»ä¼¼çš„å›¾ï¼š Mento Carlo æœç´¢è¿‡ç¨‹ç¤ºæ„ 5. è’™ç‰¹å¡ç½—æ³•æ§åˆ¶é—®é¢˜ç®—æ³•æµç¨‹ åœ¨è¿™é‡Œæ€»ç»“ä¸‹è’™ç‰¹å¡ç½—æ³•æ±‚è§£å¼ºåŒ–å­¦ä¹ æ§åˆ¶é—®é¢˜çš„ç®—æ³•æµç¨‹ï¼Œè¿™é‡Œçš„ç®—æ³•æ˜¯åœ¨çº¿(on-policy)ç‰ˆæœ¬çš„,ç›¸å¯¹çš„ç®—æ³•è¿˜æœ‰ç¦»çº¿(off-policy)ç‰ˆæœ¬çš„ã€‚åœ¨çº¿å’Œç¦»çº¿çš„åŒºåˆ«æˆ‘ä»¬åœ¨åç»­çš„æ–‡ç« é‡Œé¢ä¼šè®²ã€‚åŒæ—¶è¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯every-visit,å³ä¸ªçŠ¶æ€åºåˆ—ä¸­æ¯æ¬¡å‡ºç°çš„ç›¸åŒçŠ¶æ€ï¼Œéƒ½ä¼šè®¡ç®—å¯¹åº”çš„æ”¶è·å€¼ã€‚ åœ¨çº¿è’™ç‰¹å¡ç½—æ³•æ±‚è§£å¼ºåŒ–å­¦ä¹ æ§åˆ¶é—®é¢˜çš„ç®—æ³•æµç¨‹å¦‚ä¸‹: è¾“å…¥ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›† $A$, å³æ—¶å¥–åŠ± $R$ï¼Œè¡°å‡å› å­ $Î³$, æ¢ç´¢ç‡$Ïµ$ è¾“å‡ºï¼šæœ€ä¼˜çš„åŠ¨ä½œä»·å€¼å‡½æ•° $qâˆ—$ å’Œæœ€ä¼˜ç­–ç•¥ $Ï€âˆ—$ åˆå§‹åŒ–æ‰€æœ‰çš„åŠ¨ä½œä»·å€¼ $Q(s,a)=0$ ï¼Œ çŠ¶æ€æ¬¡æ•° $N(s,a)=0$ï¼Œé‡‡æ ·æ¬¡æ•° $k=0$ï¼Œéšæœºåˆå§‹åŒ–ä¸€ä¸ªç­–ç•¥ $Ï€$ $k=k+1$, åŸºäºç­–ç•¥ $Ï€$ è¿›è¡Œç¬¬kæ¬¡è’™ç‰¹å¡ç½—é‡‡æ ·ï¼Œå¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„çŠ¶æ€åºåˆ—: $$S_1,A_1,R_2,S_2,A_2,\\ldots S_t,A_t,R_{t+1},\\ldots R_T,S_T$$ å¯¹äºè¯¥çŠ¶æ€åºåˆ—é‡Œå‡ºç°çš„æ¯ä¸€çŠ¶æ€è¡Œä¸ºå¯¹ $(S_t,A_t)$ï¼Œè®¡ç®—å…¶æ”¶è· $G_t$, æ›´æ–°å…¶è®¡æ•° $N(s,a)$ å’Œè¡Œä¸ºä»·å€¼å‡½æ•° $Q(s,a)$ï¼š $$\\begin{gathered} G_t=R_{t+1}+\\gamma R_{t+2}+\\gamma^2R_{t+3}+\\ldots\\gamma^{T-t-1}R_T \\\\\\\\ N(S_t,A_t)=N(S_t,","date":"2024-02-22","objectID":"/posts/rl_learning_note_4/:0:0","tags":["RL"],"title":"RLå­¦ä¹ ç¬”è®° [4] | ç”¨è’™ç‰¹å¡ç½—æ³•ï¼ˆMCï¼‰æ±‚è§£","uri":"/posts/rl_learning_note_4/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆäºŒï¼‰é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹(MDP)ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ç”¨é©¬å°”ç§‘å¤«å‡è®¾æ¥ç®€åŒ–å¼ºåŒ–å­¦ä¹ æ¨¡å‹çš„å¤æ‚åº¦ï¼Œè¿™ä¸€ç¯‡æˆ‘ä»¬åœ¨é©¬å°”ç§‘å¤«å‡è®¾å’Œè´å°”æ›¼æ–¹ç¨‹çš„åŸºç¡€ä¸Šè®¨è®ºä½¿ç”¨åŠ¨æ€è§„åˆ’(Dynamic Programming, DP)æ¥æ±‚è§£å¼ºåŒ–å­¦ä¹ çš„é—®é¢˜ã€‚ åŠ¨æ€è§„åˆ’è¿™ä¸€ç¯‡å¯¹åº”Suttonä¹¦çš„ç¬¬å››ç« å’ŒUCLå¼ºåŒ–å­¦ä¹ è¯¾ç¨‹çš„ç¬¬ä¸‰è®²ã€‚ 1. åŠ¨æ€è§„åˆ’å’Œå¼ºåŒ–å­¦ä¹ é—®é¢˜çš„è”ç³» å¯¹äºåŠ¨æ€è§„åˆ’ï¼Œç›¸ä¿¡å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ï¼Œå¾ˆå¤šä½¿ç”¨ç®—æ³•çš„åœ°æ–¹éƒ½ä¼šç”¨åˆ°ã€‚å°±ç®—æ˜¯æœºå™¨å­¦ä¹ ç›¸å…³çš„ç®—æ³•ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’çš„ä¹Ÿå¾ˆå¤šï¼Œæ¯”å¦‚ä¹‹å‰è®²åˆ°çš„éšé©¬å°”ç§‘å¤«æ¨¡å‹HMMï¼ˆäºŒï¼‰å‰å‘åå‘ç®—æ³•è¯„ä¼°è§‚å¯Ÿåºåˆ—æ¦‚ç‡ï¼Œéšé©¬å°”ç§‘å¤«æ¨¡å‹HMMï¼ˆå››ï¼‰ç»´ç‰¹æ¯”ç®—æ³•è§£ç éšè—çŠ¶æ€åºåˆ—ï¼Œ éƒ½æ˜¯åŠ¨æ€è§„åˆ’çš„å…¸å‹ä¾‹å­ã€‚ åŠ¨æ€è§„åˆ’çš„å…³é”®ç‚¹æœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯é—®é¢˜çš„æœ€ä¼˜è§£å¯ä»¥ç”±è‹¥å¹²å°é—®é¢˜çš„æœ€ä¼˜è§£æ„æˆï¼Œå³é€šè¿‡å¯»æ‰¾å­é—®é¢˜çš„æœ€ä¼˜è§£æ¥å¾—åˆ°é—®é¢˜çš„æœ€ä¼˜è§£ã€‚ç¬¬äºŒæ˜¯å¯ä»¥æ‰¾åˆ°å­é—®é¢˜çŠ¶æ€ä¹‹é—´çš„é€’æ¨å…³ç³»ï¼Œé€šè¿‡è¾ƒå°çš„å­é—®é¢˜çŠ¶æ€é€’æ¨å‡ºè¾ƒå¤§çš„å­é—®é¢˜çš„çŠ¶æ€ã€‚è€Œå¼ºåŒ–å­¦ä¹ çš„é—®é¢˜æ°å¥½æ˜¯æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶çš„ã€‚ æˆ‘ä»¬å…ˆçœ‹çœ‹å¼ºåŒ–å­¦ä¹ çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜ã€‚ ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯é¢„æµ‹ï¼Œå³ç»™å®šå¼ºåŒ–å­¦ä¹ çš„6ä¸ªè¦ç´ ï¼šçŠ¶æ€é›† $S$, åŠ¨ä½œé›†$A$, æ¨¡å‹çŠ¶æ€è½¬åŒ–æ¦‚ç‡çŸ©é˜µ$P$, å³æ—¶å¥–åŠ±$R$ï¼Œè¡°å‡å› å­$Î³$, ç»™å®šç­–ç•¥$Ï€$ï¼Œ æ±‚è§£è¯¥ç­–ç•¥çš„çŠ¶æ€ä»·å€¼å‡½æ•°$v(Ï€)$ ç¬¬äºŒä¸ªé—®é¢˜æ˜¯æ§åˆ¶ï¼Œä¹Ÿå°±æ˜¯æ±‚è§£æœ€ä¼˜çš„ä»·å€¼å‡½æ•°å’Œç­–ç•¥ã€‚ç»™å®šå¼ºåŒ–å­¦ä¹ çš„5ä¸ªè¦ç´ ï¼šçŠ¶æ€é›†$S$, åŠ¨ä½œé›†$A$, æ¨¡å‹çŠ¶æ€è½¬åŒ–æ¦‚ç‡çŸ©é˜µ$P$, å³æ—¶å¥–åŠ±$R$ï¼Œè¡°å‡å› å­$Î³$, æ±‚è§£æœ€ä¼˜çš„çŠ¶æ€ä»·å€¼å‡½æ•° $vâˆ—$ å’Œæœ€ä¼˜ç­–ç•¥ $Ï€âˆ—$ã€€é‚£ä¹ˆå¦‚ä½•æ‰¾åˆ°åŠ¨æ€è§„åˆ’å’Œå¼ºåŒ–å­¦ä¹ è¿™ä¸¤ä¸ªé—®é¢˜çš„å…³ç³»å‘¢ï¼Ÿ å›å¿†ä¸€ä¸‹ä¸Šä¸€ç¯‡å¼ºåŒ–å­¦ä¹ ï¼ˆäºŒï¼‰é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹(MDP)ä¸­çŠ¶æ€ä»·å€¼å‡½æ•°çš„è´å°”æ›¼æ–¹ç¨‹ï¼š $$v_\\pi(s)=\\sum_{a\\in A}\\pi(a|s)(R_s^a+\\gamma\\sum_{sâ€™ \\in S}P_{ssâ€™}^av_\\pi(sâ€™))$$ ä»è¿™ä¸ªå¼å­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å‡ºå­é—®é¢˜æ±‚è§£æ¯ä¸ªçŠ¶æ€çš„çŠ¶æ€ä»·å€¼å‡½æ•°ï¼ŒåŒæ—¶è¿™ä¸ªå¼å­åˆæ˜¯ä¸€ä¸ªé€’æ¨çš„å¼å­, æ„å‘³ç€åˆ©ç”¨å®ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šä¸€ä¸ªè¿­ä»£å‘¨æœŸå†…çš„çŠ¶æ€ä»·å€¼æ¥è®¡ç®—æ›´æ–°å½“å‰è¿­ä»£å‘¨æœŸæŸçŠ¶æ€ $s$ çš„çŠ¶æ€ä»·å€¼ã€‚å¯è§ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥æ±‚è§£å¼ºåŒ–å­¦ä¹ é—®é¢˜æ˜¯æ¯”è¾ƒè‡ªç„¶çš„ã€‚ 2. ç­–ç•¥è¯„ä¼°æ±‚è§£é¢„æµ‹é—®é¢˜ é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹å¦‚ä½•ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥æ±‚è§£å¼ºåŒ–å­¦ä¹ çš„é¢„æµ‹é—®é¢˜ï¼Œå³æ±‚è§£ç»™å®šç­–ç•¥çš„çŠ¶æ€ä»·å€¼å‡½æ•°çš„é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜çš„æ±‚è§£è¿‡ç¨‹æˆ‘ä»¬é€šå¸¸å«åšç­–ç•¥è¯„ä¼°(Policy Evaluation)ã€‚ ç­–ç•¥è¯„ä¼°çš„åŸºæœ¬æ€è·¯æ˜¯ä»ä»»æ„ä¸€ä¸ªçŠ¶æ€ä»·å€¼å‡½æ•°å¼€å§‹ï¼Œä¾æ®ç»™å®šçš„ç­–ç•¥ï¼Œç»“åˆè´å°”æ›¼æœŸæœ›æ–¹ç¨‹ã€çŠ¶æ€è½¬ç§»æ¦‚ç‡å’Œå¥–åŠ±åŒæ­¥è¿­ä»£æ›´æ–°çŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œç›´è‡³å…¶æ”¶æ•›ï¼Œå¾—åˆ°è¯¥ç­–ç•¥ä¸‹æœ€ç»ˆçš„çŠ¶æ€ä»·å€¼å‡½æ•°ã€‚ å‡è®¾æˆ‘ä»¬åœ¨ç¬¬kè½®è¿­ä»£å·²ç»è®¡ç®—å‡ºäº†æ‰€æœ‰çš„çŠ¶æ€çš„çŠ¶æ€ä»·å€¼ï¼Œé‚£ä¹ˆåœ¨ç¬¬ $k+1$ è½®æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç¬¬kè½®è®¡ç®—å‡ºçš„çŠ¶æ€ä»·å€¼è®¡ç®—å‡ºç¬¬k+1+1è½®çš„çŠ¶æ€ä»·å€¼ã€‚è¿™æ˜¯é€šè¿‡è´å°”æ›¼æ–¹ç¨‹æ¥å®Œæˆçš„ï¼Œå³ï¼š $$v_{k+1}(s)=\\sum_{a\\in A}\\pi(a|s)(R_s^a+\\gamma\\sum_{sâ€™ \\in S}P_{ssâ€™}^av_k(sâ€™))$$ å’Œä¸Šä¸€èŠ‚çš„å¼å­å”¯ä¸€çš„åŒºåˆ«æ˜¯ç”±äºæˆ‘ä»¬çš„ç­–ç•¥ $Ï€$ å·²ç»ç»™å®šï¼Œæˆ‘ä»¬ä¸å†å†™å‡ºï¼Œå¯¹åº”åŠ ä¸Šäº†è¿­ä»£è½®æ•°çš„ä¸‹æ ‡ã€‚æˆ‘ä»¬æ¯ä¸€è½®å¯ä»¥å¯¹è®¡ç®—å¾—åˆ°çš„æ–°çš„çŠ¶æ€ä»·å€¼å‡½æ•°å†æ¬¡è¿›è¡Œè¿­ä»£ï¼Œç›´è‡³çŠ¶æ€ä»·å€¼çš„å€¼æ”¹å˜å¾ˆå°(æ”¶æ•›)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—å‡ºäº†é¢„æµ‹é—®é¢˜çš„è§£ï¼Œå³ç»™å®šç­–ç•¥çš„çŠ¶æ€ä»·å€¼å‡½æ•° $v(Ï€)$ã€‚ ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥è¯´æ˜ç­–ç•¥è¯„ä¼°çš„è¿‡ç¨‹ã€‚ 3. ç­–ç•¥è¯„ä¼°æ±‚è§£å®ä¾‹ è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„Grid Worldçš„ä¾‹å­ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ª4x4çš„16å®«æ ¼ã€‚åªæœ‰å·¦ä¸Šå’Œå³ä¸‹çš„æ ¼å­æ˜¯ç»ˆæ­¢æ ¼å­ã€‚è¯¥ä½ç½®çš„ä»·å€¼å›ºå®šä¸º0ï¼Œä¸ªä½“å¦‚æœåˆ°è¾¾äº†è¯¥2ä¸ªæ ¼å­ï¼Œåˆ™åœæ­¢ç§»åŠ¨ï¼Œæ­¤åæ¯è½®å¥–åŠ±éƒ½æ˜¯0ã€‚ä¸ªä½“åœ¨16å®«æ ¼å…¶ä»–æ ¼çš„æ¯æ¬¡ç§»åŠ¨ï¼Œå¾—åˆ°çš„å³æ—¶å¥–åŠ±Réƒ½æ˜¯-1ã€‚æ³¨æ„ä¸ªä½“æ¯æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä¸ªæ ¼å­ï¼Œä¸”åªèƒ½ä¸Šä¸‹å·¦å³4ç§ç§»åŠ¨é€‰æ‹©ï¼Œä¸èƒ½æ–œç€èµ°, å¦‚æœåœ¨è¾¹ç•Œæ ¼å¾€å¤–èµ°ï¼Œåˆ™ä¼šç›´æ¥ç§»åŠ¨å›åˆ°ä¹‹å‰çš„è¾¹ç•Œæ ¼ã€‚è¡°å‡å› å­æˆ‘ä»¬å®šä¹‰ä¸ºÎ³=1=1ã€‚ç”±äºè¿™é‡Œæ¯æ¬¡ç§»åŠ¨ï¼Œä¸‹ä¸€æ ¼éƒ½æ˜¯å›ºå®šçš„ï¼Œå› æ­¤æ‰€æœ‰å¯è¡Œçš„çš„çŠ¶æ€è½¬åŒ–æ¦‚ç‡P=1=1ã€‚è¿™é‡Œç»™å®šçš„ç­–ç•¥æ˜¯éšæœºç­–ç•¥ï¼Œå³æ¯ä¸ªæ ¼å­é‡Œæœ‰25%çš„æ¦‚ç‡å‘å‘¨å›´çš„4ä¸ªæ ¼å­ç§»åŠ¨ã€‚ Grid World é¦–å…ˆæˆ‘ä»¬åˆå§‹åŒ–æ‰€æœ‰æ ¼å­çš„çŠ¶æ€ä»·å€¼ä¸º0ï¼Œå¦‚ä¸Šå›¾ $k=0$ çš„æ—¶å€™ã€‚ç°åœ¨æˆ‘ä»¬å¼€å§‹ç­–ç•¥è¿­ä»£äº†ã€‚ç”±äºç»ˆæ­¢æ ¼å­çš„ä»·å€¼å›ºå®šä¸º0ï¼Œæˆ‘ä»¬å¯ä»¥ä¸å°†å…¶åŠ å…¥è¿­ä»£è¿‡ç¨‹ã€‚åœ¨ $k=1$ çš„æ—¶å€™ï¼Œæˆ‘ä»¬åˆ©ç”¨ä¸Šé¢çš„è´å°”æ›¼æ–¹ç¨‹å…ˆè®¡ç®—ç¬¬äºŒè¡Œç¬¬ä¸€ä¸ªæ ¼å­çš„ä»·å€¼ï¼š $$v_1^{(21)}=\\frac14[(-1+0)+(-1+0)+(-1+0)+(-1+0)]=-1$$ ç¬¬äºŒè¡Œç¬¬äºŒä¸ªæ ¼å­çš„ä»·å€¼æ˜¯ï¼š $$v_1^{(22)}=\\frac14[(-1+0)+(-1+0)+(-1+0)+(-1+0)]=-1$$ å…¶ä»–çš„æ ¼å­éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œç¬¬ä¸€è½®çš„çŠ¶æ€ä»·å€¼è¿­ä»£çš„ç»“æœå¦‚ä¸Šå›¾ $k=1$ çš„æ—¶å€™ã€‚ç°åœ¨æˆ‘ä»¬ç¬¬ä¸€è½®è¿­ä»£å®Œäº†ã€‚å¼€å§‹åŠ¨æ€è§„åˆ’è¿­ä»£ç¬¬äºŒè½®äº†ã€‚è¿˜æ˜¯çœ‹ç¬¬äºŒè¡Œç¬¬ä¸€ä¸ªæ ¼å­çš„ä»·å€¼ï¼š $$v_2^{(21)}=\\frac14[(-1+0)+(-1-1)+(-1-1)+(-1-1)]=-1.75$$ ç¬¬äºŒè¡Œç¬¬äºŒä¸ªæ ¼å­çš„ä»·å€¼æ˜¯ï¼š $$v_2^{(22)}=\\frac14[(-1-1)+(-1-1)+(-1-1)+(-1-1)]=-2$$ æœ€ç»ˆå¾—åˆ°çš„ç»“æœæ˜¯ä¸Šå›¾ $k=2$ çš„æ—¶å€™ã€‚ç¬¬ä¸‰è½®çš„è¿­ä»£å¦‚ä¸‹ï¼š $$v_3^{(21)}=\\frac14[(-1-1.7)+(-1-2)+(-1-2)+(-1+0)]=-2.425$$ $$v_3^{(22)}=\\frac14[(-1-1.7)+(-1-1.7)+(-1-2)+(-1-2)]=-2.85$$ æœ€ç»ˆå¾—åˆ°çš„ç»“æœæ˜¯ä¸Šå›¾ $k=3$ çš„æ—¶å€™ã€‚å°±è¿™æ ·ä¸€ç›´è¿­ä»£ä¸‹å»ï¼Œç›´åˆ°æ¯ä¸ªæ ¼å­çš„ç­–ç•¥ä»·å€¼æ”¹å˜å¾ˆå°ä¸ºæ­¢ã€‚è¿™æ—¶æˆ‘ä»¬å°±å¾—åˆ°äº†æ‰€æœ‰æ ¼å­çš„åŸºäºéšæœºç­–ç•¥çš„çŠ¶æ€ä»·å€¼ã€‚ å¯ä»¥çœ‹åˆ°ï¼ŒåŠ¨æ€è§„åˆ’çš„ç­–ç•¥è¯„ä¼°è®¡ç®—è¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬çš„é—®é¢˜æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„æ¨¡å‹çš„è¯ï¼Œè¿™ä¸ªè®¡ç®—é‡è¿˜æ˜¯éå¸¸å¤§çš„ã€‚ 4. ç­–ç•¥è¿­ä»£æ±‚è§£æ§åˆ¶é—®é¢˜ ä¸Šé¢æˆ‘ä»¬è®²äº†ä½¿ç”¨ç­–ç•¥è¯„ä¼°æ±‚è§£é¢„æµ‹é—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬å†æ¥çœ‹å¦‚ä½•ä½¿ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£å¼ºåŒ–å­¦ä¹ çš„ç¬¬äºŒä¸ªé—®é¢˜æ§åˆ¶é—®é¢˜ã€‚ä¸€ç§å¯è¡Œçš„æ–¹æ³•å°±æ˜¯æ ¹æ®æˆ‘ä»¬ä¹‹å‰åŸºäºä»»æ„ä¸€ä¸ªç»™å®šç­–ç•¥è¯„ä¼°å¾—åˆ°çš„çŠ¶æ€ä»·å€¼æ¥åŠæ—¶è°ƒæ•´æˆ‘ä»¬çš„åŠ¨ä½œç­–ç•¥ï¼Œè¿™ä¸ªæ–¹æ³•æˆ‘ä»¬å«åšç­–ç•¥è¿­ä»£(Policy Iteration)ã€‚ å¦‚ä½•è°ƒæ•´å‘¢ï¼Ÿæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯è´ªå©ªæ³•ã€‚è€ƒè™‘ä¸€ç§å¦‚ä¸‹çš„è´ªå©ªç­–ç•¥ï¼šä¸ªä½“åœ¨æŸä¸ªçŠ¶æ€ä¸‹é€‰æ‹©çš„è¡Œä¸ºæ˜¯å…¶èƒ½å¤Ÿåˆ°è¾¾åç»­æ‰€æœ‰å¯èƒ½çš„çŠ¶æ€ä¸­çŠ¶æ€ä»·å€¼æœ€å¤§çš„é‚£ä¸ªçŠ¶æ€ã€‚è¿˜æ˜¯ä»¥ç¬¬ä¸‰èŠ‚çš„ä¾‹å­ä¸ºä¾‹ï¼Œå¦‚ä¸Šé¢çš„å›¾å³è¾¹ã€‚å½“æˆ‘ä»¬è®¡ç®—å‡ºæœ€ç»ˆçš„çŠ¶æ€ä»·å€¼åï¼Œæˆ‘ä»¬å‘ç°ï¼Œç¬¬äºŒè¡Œç¬¬ä¸€ä¸ªæ ¼å­å‘¨å›´çš„ä»·å€¼åˆ†åˆ«æ˜¯0,-18,-20ï¼Œæ­¤æ—¶æˆ‘ä»¬ç”¨è´ªå©ªæ³•ï¼Œåˆ™æˆ‘ä»¬è°ƒæ•´è¡ŒåŠ¨ç­–ç•¥ä¸ºå‘çŠ¶æ€ä»·å€¼ä¸º0çš„æ–¹å‘ç§»åŠ¨ï¼Œè€Œä¸æ˜¯éšæœºç§»åŠ¨ã€‚ä¹Ÿå°±æ˜¯å›¾ä¸­ç®­å¤´å‘ä¸Šã€‚è€Œæ­¤æ—¶ç¬¬äºŒè¡Œç¬¬äºŒä¸ªæ ¼å­å‘¨å›´çš„ä»·å€¼åˆ†åˆ«æ˜¯-14,-14,-20,-20ã€‚é‚£ä¹ˆæˆ‘ä»¬æ•´è¡ŒåŠ¨ç­–ç•¥ä¸ºå‘çŠ¶æ€ä»·å€¼ä¸º-14çš„æ–¹å‘ç§»åŠ¨ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„å‘å·¦å‘ä¸Šã€‚ å¦‚æœç”¨ä¸€å‰¯å›¾æ¥è¡¨ç¤ºç­–ç•¥è¿­ä»£çš„è¿‡ç¨‹çš„è¯ï¼Œå¦‚ä¸‹å›¾ï¼š Policy Iteration åœ¨ç­–ç•¥è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾ªç¯è¿›è¡Œä¸¤éƒ¨åˆ†å·¥ä½œï¼Œç¬¬ä¸€æ­¥æ˜¯ä½¿ç”¨å½“å‰ç­–ç•¥ $Ï€âˆ—$ è¯„ä¼°è®¡ç®—å½“å‰ç­–ç•¥çš„æœ€ç»ˆçŠ¶æ€ä»·å€¼ $vâˆ—$ï¼Œç¬¬äºŒæ­¥æ˜¯æ ¹æ®çŠ¶æ€ä»·å€¼ $vâˆ—$ æ ¹æ®ä¸€å®šçš„æ–¹æ³•ï¼ˆæ¯”å¦‚è´ªå©ªæ³•ï¼‰æ›´æ–°ç­–ç•¥ $Ï€âˆ—$ï¼Œæ¥ç€å›åˆ°ç¬¬ä¸€æ­¥ï¼Œä¸€ç›´è¿­ä»£ä¸‹å»ï¼Œæœ€ç»ˆå¾—åˆ°æ”¶æ•›çš„ç­–ç•¥ $Ï€âˆ—$ å’ŒçŠ¶æ€ä»·å€¼ $vâˆ—$ã€‚ 5. ä»·å€¼è¿­ä»£æ±‚è§£æ§åˆ¶é—®é¢˜ è§‚å¯Ÿç¬¬ä¸‰èŠ‚çš„å›¾å‘ç°ï¼Œæˆ‘ä»¬å¦‚æœç”¨è´ªå©ªæ³•è°ƒæ•´åŠ¨ä½œç­–ç•¥ï¼Œé‚£ä¹ˆå½“k=3=3çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å·²ç»å¾—åˆ°äº†æœ€ä¼˜çš„åŠ¨ä½œç­–ç•¥ã€‚è€Œä¸ç”¨ä¸€ç›´è¿­ä»£åˆ°çŠ¶æ€ä»·å€¼æ”¶æ•›æ‰å»è°ƒæ•´ç­–ç•¥ã€‚é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬çš„ç­–ç•¥è¿­ä»£ä¼˜åŒ–ä¸ºä»·å€¼è¿­ä»£ã€‚ è¿˜æ˜¯ä»¥ç¬¬ä¸‰èŠ‚çš„ä¾‹å­ä¸ºä¾‹ï¼Œå¦‚ä¸Šé¢çš„å›¾å³è¾¹ã€‚æ¯”å¦‚å½“k=2=2æ—¶ï¼Œç¬¬äºŒè¡Œç¬¬ä¸€ä¸ªæ ¼å­å‘¨å›´çš„ä»·å€¼åˆ†åˆ«æ˜¯0,-2,-2ï¼Œæ­¤æ—¶æˆ‘ä»¬ç”¨è´ªå©ªæ³•ï¼Œåˆ™æˆ‘ä»¬è°ƒæ•´è¡ŒåŠ¨ç­–ç•¥ä¸ºå‘çŠ¶æ€ä»·å€¼ä¸º0çš„æ–¹å‘ç§»åŠ¨ï¼Œè€Œä¸æ˜¯éšæœºç§»åŠ¨ã€‚ä¹Ÿå°±æ˜¯å›¾ä¸­ç®­å¤´å‘ä¸Šã€‚è€Œæ­¤æ—¶ç¬¬äºŒè¡Œç¬¬äºŒä¸ªæ ¼å­å‘¨å›´çš„ä»·å€¼åˆ†åˆ«æ˜¯-1.7,-1.7,-2, -2ã€‚é‚£ä¹ˆæˆ‘ä»¬æ•´è¡ŒåŠ¨ç­–ç•¥ä¸ºå‘çŠ¶æ€ä»·å€¼ä¸º-1.7çš„æ–¹å‘ç§»åŠ¨ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„å‘å·¦å‘ä¸Šã€‚ å’Œä¸Šä¸€èŠ‚ç›¸æ¯”ï¼Œæˆ‘ä»¬æ²¡æœ‰ç­‰åˆ°çŠ¶æ€ä»·å€¼æ”¶æ•›æ‰è°ƒæ•´ç­–ç•¥ï¼Œè€Œæ˜¯éšç€çŠ¶æ€ä»·å€¼çš„è¿­ä»£åŠæ—¶è°ƒæ•´ç­–ç•¥, è¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘è¿­ä»£æ¬¡æ•°ã€‚æ­¤æ—¶æˆ‘ä»¬çš„çŠ¶æ€ä»·å€¼çš„æ›´æ–°æ–¹æ³•ä¹Ÿå’Œç­–ç•¥è¿­ä»£ä¸åŒã€‚ç°åœ¨çš„è´å°”æ›¼æ–¹ç¨‹è¿­ä»£å¼å­å¦‚ä¸‹ï¼š $$v_{k+1}(s)=\\max_{a\\in A}(R_s^a+\\gamma\\sum_{sâ€™ \\in S}P_{ssâ€™}^av_k(sâ€™))$$ å¯è§ç”±äºç­–ç•¥è°ƒæ•´ï¼Œæˆ‘ä»¬ç°åœ¨ä»·å€¼æ¯æ¬¡æ›´æ–°å€¾å‘äºè´ªå©ªæ³•é€‰æ‹©çš„æœ€ä¼˜ç­–ç•¥å¯¹åº”çš„åç»­çŠ¶æ€ä»·å€¼ï¼Œè¿™æ ·æ”¶æ•›æ›´å¿«ã€‚ 6. å¼‚æ­¥åŠ¨æ€è§„åˆ’ç®—æ³• åœ¨å‰å‡ èŠ‚æˆ‘ä»¬è®²çš„éƒ½æ˜¯åŒæ­¥åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œå³æ¯è½®è¿­ä»£æˆ‘ä¼šè®¡ç®—å‡ºæ‰€æœ‰çš„çŠ¶æ€ä»·å€¼å¹¶ä¿å­˜èµ·æ¥ï¼Œåœ¨ä¸‹ä¸€è½®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™äº›ä¿å­˜èµ·æ¥çš„çŠ¶æ€ä»·å€¼æ¥è®¡ç®—æ–°ä¸€è½®çš„çŠ¶æ€ä»·å€¼ã€‚ å¦ä¸€ç§åŠ¨æ€è§„åˆ’æ±‚è§£æ˜¯å¼‚æ­¥åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œåœ¨è¿™äº›ç®—æ³•é‡Œï¼Œæ¯ä¸€æ¬¡è¿­ä»£å¹¶ä¸å¯¹æ‰€æœ‰çŠ¶æ€çš„ä»·å€¼è¿›è¡Œæ›´æ–°ï¼Œè€Œæ˜¯ä¾æ®ä¸€å®šçš„åŸåˆ™æœ‰é€‰æ‹©æ€§çš„æ›´æ–°éƒ¨åˆ†çŠ¶æ€çš„ä»·å€¼ï¼Œè¿™ç±»ç®—æ³•æœ‰è‡ªå·±çš„ä¸€äº›ç‹¬ç‰¹ä¼˜åŠ¿ï¼Œå½“ç„¶æœ‰é¢ä¼šæœ‰ä¸€äº›é¢å¤–çš„ä»£ä»·ã€‚ å¸¸è§çš„å¼‚æ­¥åŠ¨æ€è§„åˆ’ç®—æ³•æœ‰ä¸‰ç§ï¼š ç¬¬ä¸€ç§æ˜¯åŸä½åŠ¨æ€è§„åˆ’ (in-place dynamic programming)ï¼Œ æ­¤æ—¶æˆ‘ä»¬ä¸ä¼šå¦å¤–ä¿å­˜ä¸€ä»½ä¸Šä¸€è½®è®¡ç®—å‡ºçš„çŠ¶æ€ä»·å€¼ã€‚è€Œæ˜¯å³æ—¶è®¡ç®—å³æ—¶æ›´æ–°ã€‚è¿™æ ·å¯ä»¥å‡å°‘ä¿å­˜çš„çŠ¶æ€ä»·å€¼çš„æ•°é‡ï¼ŒèŠ‚çº¦å†…å­˜ã€‚ä»£ä»·æ˜¯æ”¶æ•›é€Ÿåº¦å¯èƒ½ç¨æ…¢ã€‚ ç¬¬äºŒç§æ˜¯ä¼˜å…ˆçº§åŠ¨æ€è§„åˆ’ (prioritised sweeping)ï¼šè¯¥ç®—æ³•å¯¹æ¯ä¸€ä¸ªçŠ¶æ€è¿›è¡Œä¼˜å…ˆçº§åˆ†çº§ï¼Œä¼˜å…ˆçº§è¶Šé«˜çš„çŠ¶æ€å…¶çŠ¶æ€ä»·å€¼ä¼˜å…ˆå¾—åˆ°æ›´æ–°ã€‚é€šå¸¸ä½¿ç”¨è´å°”æ›¼è¯¯å·®æ¥è¯„ä¼°çŠ¶æ€çš„ä¼˜å…ˆçº§ï¼Œè´å°”æ›¼è¯¯å·®å³æ–°çŠ¶æ€ä»·å€¼ä¸å‰æ¬¡è®¡ç®—å¾—åˆ°çš„çŠ¶æ€ä»·å€¼å·®çš„ç»å¯¹","date":"2024-02-22","objectID":"/posts/rl_learning_note_3/:0:0","tags":["RL"],"title":"RLå­¦ä¹ ç¬”è®° [3] | ç”¨åŠ¨æ€è§„åˆ’(DP)æ±‚è§£","uri":"/posts/rl_learning_note_3/"},{"categories":["RL"],"content":"0. å¼•è¨€ åœ¨å¼ºåŒ–å­¦ä¹ ï¼ˆä¸€ï¼‰æ¨¡å‹åŸºç¡€ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°äº†å¼ºåŒ–å­¦ä¹ æ¨¡å‹çš„8ä¸ªåŸºæœ¬è¦ç´ ã€‚ä½†æ˜¯ä»…å‡­è¿™äº›è¦ç´ è¿˜æ˜¯æ— æ³•ä½¿ç”¨å¼ºåŒ–å­¦ä¹ æ¥å¸®åŠ©æˆ‘ä»¬è§£å†³é—®é¢˜çš„, åœ¨è®²åˆ°æ¨¡å‹è®­ç»ƒå‰ï¼Œæ¨¡å‹çš„ç®€åŒ–ä¹Ÿå¾ˆé‡è¦ï¼Œè¿™ä¸€ç¯‡ä¸»è¦å°±æ˜¯è®²å¦‚ä½•åˆ©ç”¨é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹(Markov Decision Processï¼Œä»¥ä¸‹ç®€ç§°MDP)æ¥ç®€åŒ–å¼ºåŒ–å­¦ä¹ çš„å»ºæ¨¡ã€‚ MDPè¿™ä¸€ç¯‡å¯¹åº”Suttonä¹¦çš„ç¬¬ä¸‰ç« å’ŒUCLå¼ºåŒ–å­¦ä¹ è¯¾ç¨‹çš„ç¬¬äºŒè®²ã€‚ 1. å¼ºåŒ–å­¦ä¹ å¼•å…¥MDPçš„åŸå›  å¯¹äºé©¬å°”ç§‘å¤«æ€§æœ¬èº«ï¼Œæˆ‘ä¹‹å‰è®²è¿‡çš„éšé©¬å°”ç§‘å¤«æ¨¡å‹HMMï¼ˆä¸€ï¼‰HMMæ¨¡å‹ï¼Œæ¡ä»¶éšæœºåœºCRF(ä¸€)ä»éšæœºåœºåˆ°çº¿æ€§é“¾æ¡ä»¶éšæœºåœºä»¥åŠMCMC(äºŒ)é©¬å°”ç§‘å¤«é“¾éƒ½æœ‰è®²åˆ°ã€‚å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„å‡è®¾ï¼Œå› æ­¤è¿™é‡Œå°±ä¸ä¸“é—¨å¯¹â€œé©¬å°”å¯å¤«æ€§â€åšä¸“é—¨çš„è®²è¿°äº†ã€‚ é™¤äº†å¯¹äºç¯å¢ƒçš„çŠ¶æ€è½¬åŒ–æ¨¡å‹è¿™ä¸ªå› ç´ åšé©¬å°”ç§‘å¤«å‡è®¾å¤–ï¼Œæˆ‘ä»¬è¿˜å¯¹å¼ºåŒ–å­¦ä¹ ç¬¬å››ä¸ªè¦ç´ ä¸ªä½“çš„ç­–ç•¥(policy) $Ï€$ ä¹Ÿåšäº†é©¬å°”ç§‘å¤«å‡è®¾ã€‚å³åœ¨çŠ¶æ€ $s$ æ—¶é‡‡å–åŠ¨ä½œ $a$ çš„æ¦‚ç‡ä»…ä¸å½“å‰çŠ¶æ€ $s$ æœ‰å…³ï¼Œä¸å…¶ä»–çš„è¦ç´ æ— å…³ã€‚ç”¨å…¬å¼è¡¨ç¤ºå°±æ˜¯ $$\\pi(a\\mid s)=P(A_{t}=a\\mid S_{t}=s)$$ å¯¹äºç¬¬äº”ä¸ªè¦ç´ ï¼Œä»·å€¼å‡½æ•° $v_Ï€(s)$ ä¹Ÿæ˜¯ä¸€æ ·, $v_Ï€(s)$ ç°åœ¨ä»…ä»…ä¾èµ–äºå½“å‰çŠ¶æ€äº†ï¼Œé‚£ä¹ˆç°åœ¨ä»·å€¼å‡½æ•° $v_Ï€(s)$ è¡¨ç¤ºä¸º: $$v_{\\pi}(s)=\\mathrm{E}_{\\pi}(G_{t}|S_{t}=s)=\\mathrm{E}_{\\pi}(R_{t+1}+\\gamma R_{t+2}+\\gamma^{2}R_{t+3}+\\ldots\\mid S_{t}=s)$$ å…¶ä¸­ï¼Œ$G_t$ ä»£è¡¨æ”¶è·(return), æ˜¯ä¸€ä¸ªMDPä¸­ä»æŸä¸€ä¸ªçŠ¶æ€ $S_t$ å¼€å§‹é‡‡æ ·ç›´åˆ°ç»ˆæ­¢çŠ¶æ€æ—¶æ‰€æœ‰å¥–åŠ±çš„æœ‰è¡°å‡çš„ä¹‹å’Œã€‚ 2. MDPçš„ä»·å€¼å‡½æ•°ä¸è´å°”æ›¼æ–¹ç¨‹ å¯¹äºMDPï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€èŠ‚é‡Œå·²ç»è®²åˆ°äº†å®ƒçš„ä»·å€¼å‡½æ•° $v_Ï€(s)$ çš„è¡¨è¾¾å¼ã€‚ä½†æ˜¯è¿™ä¸ªè¡¨è¾¾å¼æ²¡æœ‰è€ƒè™‘åˆ°æ‰€é‡‡ç”¨çš„åŠ¨ä½œ$a$å¸¦æ¥çš„ä»·å€¼å½±å“ï¼Œå› æ­¤æˆ‘ä»¬é™¤äº† $v_Ï€(s)$ è¿™ä¸ªçŠ¶æ€ä»·å€¼å‡½æ•°å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªåŠ¨ä½œä»·å€¼å‡½æ•° $q_Ï€(s,a)$ï¼Œå³ï¼š $$q_{\\pi}(s,a)=\\operatorname{E}_{\\pi}(G_{t}|S_{t}=s,A_{t}=a)=\\operatorname{E}_{\\pi}(R_{t+1}+\\gamma R_{t+2}+\\gamma^{2}R_{t+3}+\\ldots\\mid S_{t}=s,A_{t}=a)$$ æ ¹æ®ä»·å€¼å‡½æ•°çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºä»·å€¼å‡½æ•°åŸºäºçŠ¶æ€çš„é€’æ¨å…³ç³»ï¼Œæ¯”å¦‚å¯¹äºçŠ¶æ€ä»·å€¼å‡½æ•° $v_Ï€(s)$ï¼Œå¯ä»¥å‘ç°ï¼š $$\\begin{aligned} V_{\\pi}(s)\u0026 =\\mathrm{E}_{\\pi}(R_{t+1}+\\gamma R_{t+2}+\\gamma^{2}R_{t+3}+\\ldots\\mid S_{t}=s) \\ \u0026=\\mathrm{E}_{\\pi}(R_{t+1}+\\gamma(R_{t+2}+\\gamma R_{t+3}+\\ldots)|S_{t}=s) \\ \u0026=\\mathrm{E}_{\\pi}(R_{t+1}+\\gamma G_{t+1}|S_{t}=s) \\ \u0026=\\mathrm{E}_{\\pi}(R_{t+1}+\\gamma v_{\\pi}(S_{t+1})|S_{t}=s) \\end{aligned}$$ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ $t$ æ—¶åˆ»çš„çŠ¶æ€ $S_t$ å’Œ $t+1$ æ—¶åˆ»çš„çŠ¶æ€ $S_{t+1}$ æ˜¯æ»¡è¶³é€’æ¨å…³ç³»çš„ï¼Œå³ï¼š $$v_{\\pi}(s)=\\mathrm{E}_{\\pi}(R_{t+1}+\\gamma\\nu_{\\pi}(S_{t+1})\\mid S_{t}=s)$$ è¿™ä¸ªé€’æ¨å¼å­æˆ‘ä»¬ä¸€èˆ¬å°†å®ƒå«åšè´å°”æ›¼æ–¹ç¨‹ã€‚è¿™ä¸ªå¼å­å‘Šè¯‰æˆ‘ä»¬ï¼Œä¸€ä¸ªçŠ¶æ€çš„ä»·å€¼ç”±è¯¥çŠ¶æ€çš„å¥–åŠ±ä»¥åŠåç»­çŠ¶æ€ä»·å€¼æŒ‰ä¸€å®šçš„è¡°å‡æ¯”ä¾‹è”åˆç»„æˆã€‚ åŒæ ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åŠ¨ä½œä»·å€¼å‡½æ•° $q_Ï€(s,a)$ çš„è´å°”æ›¼æ–¹ç¨‹ï¼š $$q_{\\pi}(s,a)=\\mathrm{E}_{\\pi}(R_{t+1}+\\gamma q_{\\pi}(S_{t+1},A_{t+1})\\mid S_{t}=s,A_{t}=a)$$ 3. çŠ¶æ€ä»·å€¼å‡½æ•°ä¸åŠ¨ä½œä»·å€¼å‡½æ•°çš„é€’æ¨å…³ç³» æ ¹æ®åŠ¨ä½œä»·å€¼å‡½æ•° $q_Ï€(s,a)$ å’ŒçŠ¶æ€ä»·å€¼å‡½æ•° $v_Ï€(s)$ çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¾—åˆ°ä»–ä»¬ä¹‹é—´çš„è½¬åŒ–å…³ç³»å…¬å¼ï¼š $$\\nu_{\\pi}(s)=\\sum_{a\\in A}\\pi(a|s)q_{\\pi}(s,a)$$ ä¹Ÿå°±æ˜¯è¯´ï¼ŒçŠ¶æ€ä»·å€¼å‡½æ•°æ˜¯æ‰€æœ‰åŠ¨ä½œä»·å€¼å‡½æ•°åŸºäºç­–ç•¥ $Ï€$ çš„æœŸæœ›ã€‚é€šä¿—è¯´å°±æ˜¯æŸçŠ¶æ€ä¸‹æ‰€æœ‰çŠ¶æ€åŠ¨ä½œä»·å€¼ä¹˜ä»¥è¯¥åŠ¨ä½œå‡ºç°çš„æ¦‚ç‡ï¼Œæœ€åæ±‚å’Œï¼Œå°±å¾—åˆ°äº†å¯¹åº”çš„çŠ¶æ€ä»·å€¼ã€‚ åè¿‡æ¥ï¼Œåˆ©ç”¨ä¸Šè´å°”æ›¼æ–¹ç¨‹ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“ä»çŠ¶æ€ä»·å€¼å‡½æ•° $v_Ï€(s)$ è¡¨ç¤ºåŠ¨ä½œä»·å€¼å‡½æ•° $q_Ï€(s,a)$ï¼Œå³ï¼š $$q_{\\pi}(s,a)=R_{s}^{a}+\\gamma\\sum_{s^{\\prime}\\in S}P_{ssâ€™}^{a}\\nu_{\\pi}(sâ€™)$$ é€šä¿—è¯´å°±æ˜¯çŠ¶æ€åŠ¨ä½œä»·å€¼æœ‰ä¸¤éƒ¨åˆ†ç›¸åŠ ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯å³æ—¶å¥–åŠ±ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ç¯å¢ƒæ‰€æœ‰å¯èƒ½å‡ºç°çš„ä¸‹ä¸€ä¸ªçŠ¶æ€çš„æ¦‚ç‡ä¹˜ä»¥è¯¥ä¸‹ä¸€çŠ¶æ€çš„çŠ¶æ€ä»·å€¼ï¼Œæœ€åæ±‚å’Œï¼Œå¹¶åŠ ä¸Šè¡°å‡ã€‚ è¿™ä¸¤ä¸ªè½¬åŒ–è¿‡ç¨‹ä¹Ÿå¯ä»¥ä»ä¸‹å›¾ä¸­ç›´è§‚çš„çœ‹å‡ºï¼š çŠ¶æ€ä»·å€¼å‡½æ•° åŠ¨ä½œä»·å€¼å‡½æ•° æŠŠä¸Šé¢ä¸¤ä¸ªå¼å­äº’ç›¸ç»“åˆèµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š $$\\nu_{\\pi}(s)=\\sum_{a\\in A}\\pi(a\\mid s)(R_{s}^{a}+\\gamma\\sum_{sâ€™ \\in S}P_{ssâ€™}^{a}\\nu_{\\pi}(s^{â€™}))$$ $$q_\\pi(s,a)=R_s^a+\\gamma\\sum_{sâ€™ \\in S}P_{ssâ€™}^a\\sum_{aâ€™ \\in A}\\pi(aâ€™ \\mid sâ€™)q_\\pi(sâ€™,aâ€™)$$ 4. æœ€ä¼˜ä»·å€¼å‡½æ•° è§£å†³å¼ºåŒ–å­¦ä¹ é—®é¢˜æ„å‘³ç€è¦å¯»æ‰¾ä¸€ä¸ªæœ€ä¼˜çš„ç­–ç•¥è®©ä¸ªä½“åœ¨ä¸ç¯å¢ƒäº¤äº’è¿‡ç¨‹ä¸­è·å¾—å§‹ç»ˆæ¯”å…¶å®ƒç­–ç•¥éƒ½è¦å¤šçš„æ”¶è·ï¼Œè¿™ä¸ªæœ€ä¼˜ç­–ç•¥æˆ‘ä»¬å¯ä»¥ç”¨ $Ï€^*$è¡¨ç¤ºã€‚ä¸€æ—¦æ‰¾åˆ°è¿™ä¸ªæœ€ä¼˜ç­–ç•¥$Ï€^âˆ—$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è§£å†³äº†è¿™ä¸ªå¼ºåŒ–å­¦ä¹ é—®é¢˜ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ¯”è¾ƒéš¾å»æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜ç­–ç•¥ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡æ¯”è¾ƒè‹¥å¹²ä¸åŒç­–ç•¥çš„ä¼˜åŠ£æ¥ç¡®å®šä¸€ä¸ªè¾ƒå¥½çš„ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯å±€éƒ¨æœ€ä¼˜è§£ã€‚ å¦‚ä½•æ¯”è¾ƒç­–ç•¥çš„ä¼˜åŠ£å‘¢ï¼Ÿä¸€èˆ¬æ˜¯é€šè¿‡å¯¹åº”çš„ä»·å€¼å‡½æ•°æ¥æ¯”è¾ƒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯»æ‰¾è¾ƒä¼˜ç­–ç•¥å¯ä»¥é€šè¿‡å¯»æ‰¾è¾ƒä¼˜çš„ä»·å€¼å‡½æ•°æ¥å®Œæˆã€‚å¯ä»¥å®šä¹‰æœ€ä¼˜çŠ¶æ€ä»·å€¼å‡½æ•°æ˜¯æ‰€æœ‰ç­–ç•¥ä¸‹äº§ç”Ÿçš„ä¼—å¤šçŠ¶æ€ä»·å€¼å‡½æ•°ä¸­çš„æœ€å¤§è€…ï¼Œå³ï¼š $$v^{\\ast}(s)=\\max_{\\pi} v_{\\pi}(s)$$ åŒç†ä¹Ÿå¯ä»¥å®šä¹‰æœ€ä¼˜åŠ¨ä½œä»·å€¼å‡½æ•°æ˜¯æ‰€æœ‰ç­–ç•¥ä¸‹äº§ç”Ÿçš„ä¼—å¤šåŠ¨ä½œçŠ¶æ€ä»·å€¼å‡½æ•°ä¸­çš„æœ€å¤§è€…ï¼Œå³ï¼š $$q^{\\ast}(s,a)=\\max_\\pi q_\\pi(s,a)$$ å¯¹äºæœ€ä¼˜çš„ç­–ç•¥ï¼ŒåŸºäºåŠ¨ä½œä»·å€¼å‡½æ•°æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸ºï¼š $$\\pi ^{\\ast} (a|s)=\\begin{cases}1\u0026\\mathrm{if~}a=\\mathrm{arg~}\\max_{a\\in A}q*(s,a)\\\\\\\\0\u0026\\mathrm{else}\u0026\\end{cases}$$ åªè¦æˆ‘ä»¬æ‰¾åˆ°äº†æœ€å¤§çš„çŠ¶æ€ä»·å€¼å‡½æ•°æˆ–è€…åŠ¨ä½œä»·å€¼å‡½æ•°ï¼Œé‚£ä¹ˆå¯¹åº”çš„ç­–ç•¥ $Ï€^*$ å°±æ˜¯æˆ‘ä»¬å¼ºåŒ–å­¦ä¹ é—®é¢˜çš„è§£ã€‚åŒæ—¶ï¼Œåˆ©ç”¨çŠ¶æ€ä»·å€¼å‡½æ•°å’ŒåŠ¨ä½œä»·å€¼å‡½æ•°ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°: $$v^{\\ast}(s)=\\max_a q ^{\\ast} (s,a)$$ åè¿‡æ¥çš„æœ€ä¼˜ä»·å€¼å‡½æ•°å…³ç³»ä¹Ÿå¾ˆå®¹æ˜“å¾—åˆ°ï¼š $$q_{}(s,a)=R_{s}^{a}+\\gamma\\sum_{sâ€™ \\in S}P_{ss}^{a}{}_{}(\\mathrm{sâ€™})$$ åˆ©ç”¨ä¸Šé¢çš„ä¸¤ä¸ªå¼å­ä¹Ÿå¯ä»¥å¾—åˆ°å’Œç¬¬ä¸‰èŠ‚æœ«å°¾ç±»ä¼¼çš„å¼å­ï¼š $$v_(s)=\\max_a(R_s^a+\\gamma\\sum_{s^{\\prime}\\in S}P_{ssâ€™}^a\\nu_(sâ€™))$$ $$q_(s,a)=R_s^a+\\gamma\\sum_{sâ€™ \\in S}P_{ssâ€™}^a\\max_{aâ€™}q_(sâ€™,aâ€™)$$ 5. MDPå®ä¾‹ ä¸Šé¢çš„å…¬å¼æœ‰ç‚¹å¤šï¼Œéœ€è¦ä¸€äº›æ—¶é—´æ…¢æ…¢æ¶ˆåŒ–ï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ªUCLè®²ä¹‰ä¸Šå®é™…çš„ä¾‹å­ï¼Œé¦–å…ˆçœ‹çœ‹å…·ä½“æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨ç»™å®šç­–ç•¥æ¥è®¡ç®—ä»·å€¼å‡½æ•°ã€‚ MDP ä¸¾ä¾‹ ä¾‹å­æ˜¯ä¸€ä¸ªå­¦ç”Ÿå­¦ä¹ è€ƒè¯•çš„MDPã€‚é‡Œé¢å·¦ä¸‹é‚£ä¸ªåœ†åœˆä½ç½®æ˜¯èµ·ç‚¹ï¼Œæ–¹æ¡†é‚£ä¸ªä½ç½®æ˜¯ç»ˆç‚¹ã€‚ä¸Šé¢çš„åŠ¨ä½œæœ‰study, pub, facebook, quit, sleepï¼Œæ¯ä¸ªçŠ¶æ€åŠ¨ä½œå¯¹åº”çš„å³æ—¶å¥–åŠ±Rå·²ç»æ ‡å‡ºæ¥äº†ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°æœ€ä¼˜çš„åŠ¨ä½œä»·å€¼å‡½æ•°æˆ–è€…çŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œè¿›è€Œæ‰¾å‡ºæœ€ä¼˜çš„ç­–ç•¥ã€‚ ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å‡è®¾è¡°å‡å› å­ $Î³=1$, $Ï€(a|s)=0.5$ã€‚ å¯¹äºç»ˆç‚¹æ–¹æ¡†ä½ç½®ï¼Œç”±äºå…¶æ²¡æœ‰ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œä¹Ÿæ²¡æœ‰å½“å‰çŠ¶æ€çš„åŠ¨ä½œï¼Œå› æ­¤å…¶çŠ¶æ€ä»·å€¼å‡½æ•°ä¸º0ã€‚å¯¹äºå…¶ä½™å››ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬ä¾æ¬¡å®šä¹‰å…¶ä»·å€¼ä¸ºv1,v2,v3,v4ï¼Œ åˆ†åˆ«å¯¹åº”å·¦ä¸Šï¼Œå·¦ä¸‹ï¼Œä¸­ä¸‹ï¼Œå³ä¸‹ä½ç½®çš„åœ†åœˆã€‚æˆ‘ä»¬åŸºäº$\\nu_{\\pi}(s)=\\sum_{a\\in A}\\pi(a|s)(R_{s}^{a}+\\gamma\\sum_{sâ€™ \\in S}P_{ssâ€™}^{a}v_{\\pi}(sâ€™))$è®¡ç®—æ‰€æœ‰çš„çŠ¶æ€ä»·å€¼å‡½æ•°ã€‚å¯ä»¥åˆ—å‡ºä¸€ä¸ªæ–¹ç¨‹ç»„ã€‚ å¯¹äºv1ä½ç½®ï¼Œæˆ‘ä»¬æœ‰ï¼š$v_1=0.5*(-1+v_1)+0.5*(0+v_2)$ å¯¹äºv2ä½ç½®ï¼Œæˆ‘ä»¬æœ‰ï¼š$v_2=0.5*(-1+v_1)+0.5*(-2+v_3)$ å¯¹äºv3ä½ç½®ï¼Œæˆ‘ä»¬æœ‰ï¼š$v_3=0.5*(0+0)+0.5*(-2+v_4)$ å¯¹äºv4ä½ç½®ï¼Œæˆ‘ä»¬æœ‰ï¼š$v_4=0.5*(10+0)+0.5*(1+0.2v_2+0.4v_3+0.4*v_4)$ è§£å‡ºè¿™ä¸ªæ–¹ç¨‹ç»„å¯ä»¥å¾—åˆ° $v_1=","date":"2024-02-21","objectID":"/posts/rl_learning_note_2/:0:0","tags":["RL"],"title":"RLå­¦ä¹ ç¬”è®° [2] | é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹(MDP)","uri":"/posts/rl_learning_note_2/"},{"categories":["RL"],"content":"0. å¼•è¨€ ä»ä»Šå¤©å¼€å§‹æ•´ç†å¼ºåŒ–å­¦ä¹ é¢†åŸŸçš„çŸ¥è¯†ï¼Œä¸»è¦å‚è€ƒçš„èµ„æ–™æ˜¯Suttonçš„å¼ºåŒ–å­¦ä¹ ä¹¦å’ŒUCLå¼ºåŒ–å­¦ä¹ çš„è¯¾ç¨‹ã€‚è¿™ä¸ªç³»åˆ—å¤§æ¦‚å‡†å¤‡å†™10åˆ°20ç¯‡ï¼Œå¸Œæœ›å†™å®Œåè‡ªå·±çš„å¼ºåŒ–å­¦ä¹ ç¢ç‰‡åŒ–çŸ¥è¯†å¯ä»¥å¾—åˆ°èä¼šè´¯é€šï¼Œä¹Ÿå¸Œæœ›å¯ä»¥å¸®åˆ°æ›´å¤šçš„äººï¼Œæ¯•ç«Ÿç›®å‰ç³»ç»Ÿçš„è®²è§£å¼ºåŒ–å­¦ä¹ çš„ä¸­æ–‡èµ„æ–™ä¸å¤ªå¤šã€‚ ç¬¬ä¸€ç¯‡ä¼šä»å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µè®²èµ·ï¼Œå¯¹åº”Suttonä¹¦çš„ç¬¬ä¸€ç« å’ŒUCLè¯¾ç¨‹çš„ç¬¬ä¸€è®²ã€‚ 1. å¼ºåŒ–å­¦ä¹ åœ¨æœºå™¨å­¦ä¹ ä¸­çš„ä½ç½® å¼ºåŒ–å­¦ä¹ çš„å­¦ä¹ æ€è·¯å’Œäººæ¯”è¾ƒç±»ä¼¼ï¼Œæ˜¯åœ¨å®è·µä¸­å­¦ä¹ ï¼Œæ¯”å¦‚å­¦ä¹ èµ°è·¯ï¼Œå¦‚æœæ‘”å€’äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¤§è„‘åé¢ä¼šç»™ä¸€ä¸ªè´Ÿé¢çš„å¥–åŠ±å€¼ï¼Œè¯´æ˜èµ°çš„å§¿åŠ¿ä¸å¥½ã€‚ç„¶åæˆ‘ä»¬ä»æ‘”å€’çŠ¶æ€ä¸­çˆ¬èµ·æ¥ï¼Œå¦‚æœåé¢æ­£å¸¸èµ°äº†ä¸€æ­¥ï¼Œé‚£ä¹ˆå¤§è„‘ä¼šç»™ä¸€ä¸ªæ­£é¢çš„å¥–åŠ±å€¼ï¼Œæˆ‘ä»¬ä¼šçŸ¥é“è¿™æ˜¯ä¸€ä¸ªå¥½çš„èµ°è·¯å§¿åŠ¿ã€‚é‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹å’Œä¹‹å‰è®²çš„æœºå™¨å­¦ä¹ æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ å¼ºåŒ–å­¦ä¹ æ˜¯å’Œç›‘ç£å­¦ä¹ ï¼Œéç›‘ç£å­¦ä¹ å¹¶åˆ—çš„ç¬¬ä¸‰ç§æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œä»ä¸‹å›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ã€‚ RLã€SLã€ULä¸MLçš„åŒºåˆ«è”ç³» ä¸ç›‘ç£å­¦ä¹ ç›¸æ¯”ï¼Œå¼ºåŒ–å­¦ä¹ æœ€å¤§çš„åŒºåˆ«æ˜¯å®ƒæ²¡æœ‰ç›‘ç£å­¦ä¹ å·²ç»å‡†å¤‡å¥½çš„è®­ç»ƒæ•°æ®è¾“å‡ºå€¼ã€‚å¼ºåŒ–å­¦ä¹ åªæœ‰å¥–åŠ±å€¼ï¼Œä½†æ˜¯è¿™ä¸ªå¥–åŠ±å€¼å’Œç›‘ç£å­¦ä¹ çš„è¾“å‡ºå€¼ä¸ä¸€æ ·ï¼Œå®ƒä¸æ˜¯äº‹å…ˆç»™å‡ºçš„ï¼Œè€Œæ˜¯å»¶åç»™å‡ºçš„ï¼Œæ¯”å¦‚ä¸Šé¢çš„ä¾‹å­é‡Œèµ°è·¯æ‘”å€’äº†æ‰å¾—åˆ°å¤§è„‘çš„å¥–åŠ±å€¼ã€‚åŒæ—¶ï¼Œå¼ºåŒ–å­¦ä¹ çš„æ¯ä¸€æ­¥ä¸æ—¶é—´é¡ºåºå‰åå…³ç³»ç´§å¯†ã€‚è€Œç›‘ç£å­¦ä¹ çš„è®­ç»ƒæ•°æ®ä¹‹é—´ä¸€èˆ¬éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰è¿™ç§å‰åçš„ä¾èµ–å…³ç³»ã€‚ å†æ¥çœ‹çœ‹å¼ºåŒ–å­¦ä¹ å’Œéç›‘ç£å­¦ä¹ çš„åŒºåˆ«ã€‚ä¹Ÿè¿˜æ˜¯åœ¨å¥–åŠ±å€¼è¿™ä¸ªåœ°æ–¹ã€‚éç›‘ç£å­¦ä¹ æ˜¯æ²¡æœ‰è¾“å‡ºå€¼ä¹Ÿæ²¡æœ‰å¥–åŠ±å€¼çš„ï¼Œå®ƒåªæœ‰æ•°æ®ç‰¹å¾ã€‚åŒæ—¶å’Œç›‘ç£å­¦ä¹ ä¸€æ ·ï¼Œæ•°æ®ä¹‹é—´ä¹Ÿéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰å¼ºåŒ–å­¦ä¹ è¿™æ ·çš„å‰åä¾èµ–å…³ç³»ã€‚ 2. å¼ºåŒ–å­¦ä¹ çš„å»ºæ¨¡ æˆ‘ä»¬ç°åœ¨æ¥çœ‹çœ‹å¼ºåŒ–å­¦ä¹ è¿™æ ·çš„é—®é¢˜æˆ‘ä»¬æ€ä¹ˆæ¥å»ºæ¨¡ï¼Œç®€å•çš„æ¥è¯´ï¼Œæ˜¯ä¸‹å›¾è¿™æ ·çš„ï¼š å¤§è„‘ä¸ç¯å¢ƒçš„äº¤äº’ ä¸Šé¢çš„å¤§è„‘ä»£è¡¨æˆ‘ä»¬çš„ç®—æ³•æ‰§è¡Œä¸ªä½“ï¼Œæˆ‘ä»¬å¯ä»¥æ“ä½œä¸ªä½“æ¥åšå†³ç­–ï¼Œå³é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„åŠ¨ä½œï¼ˆActionï¼‰$A_t$ã€‚ä¸‹é¢çš„åœ°çƒä»£è¡¨æˆ‘ä»¬è¦ç ”ç©¶çš„ç¯å¢ƒ,å®ƒæœ‰è‡ªå·±çš„çŠ¶æ€æ¨¡å‹ï¼Œæˆ‘ä»¬é€‰æ‹©äº†åŠ¨ä½œ $A_t$ åï¼Œç¯å¢ƒçš„çŠ¶æ€(State)ä¼šå˜ï¼Œæˆ‘ä»¬ä¼šå‘ç°ç¯å¢ƒçŠ¶æ€å·²ç»å˜ä¸º $S_{t+1}$,åŒæ—¶æˆ‘ä»¬å¾—åˆ°äº†æˆ‘ä»¬é‡‡å–åŠ¨ä½œ $A_t$ çš„å»¶æ—¶å¥–åŠ±(Reward) $R_{t+1}$ã€‚ç„¶åä¸ªä½“å¯ä»¥ç»§ç»­é€‰æ‹©ä¸‹ä¸€ä¸ªåˆé€‚çš„åŠ¨ä½œï¼Œç„¶åç¯å¢ƒçš„çŠ¶æ€åˆä¼šå˜ï¼Œåˆæœ‰æ–°çš„å¥–åŠ±å€¼â€¦è¿™å°±æ˜¯å¼ºåŒ–å­¦ä¹ çš„æ€è·¯ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ•´ç†ä¸‹è¿™ä¸ªæ€è·¯é‡Œé¢å‡ºç°çš„å¼ºåŒ–å­¦ä¹ è¦ç´ ã€‚ ç¬¬ä¸€ä¸ªæ˜¯ç¯å¢ƒçš„çŠ¶æ€ $S$, $t$ æ—¶åˆ»ç¯å¢ƒçš„çŠ¶æ€ $S_t$ æ˜¯å®ƒçš„ç¯å¢ƒçŠ¶æ€é›†ä¸­æŸä¸€ä¸ªçŠ¶æ€ã€‚ ç¬¬äºŒä¸ªæ˜¯ä¸ªä½“çš„åŠ¨ä½œ $A$, $t$ æ—¶åˆ»ä¸ªä½“é‡‡å–çš„åŠ¨ä½œ $A_t$ æ˜¯å®ƒçš„åŠ¨ä½œé›†ä¸­æŸä¸€ä¸ªåŠ¨ä½œã€‚ ç¬¬ä¸‰ä¸ªæ˜¯ç¯å¢ƒçš„å¥–åŠ± $R$, $t$ æ—¶åˆ»ä¸ªä½“åœ¨çŠ¶æ€ $S_t$ é‡‡å–çš„åŠ¨ä½œ $A_t$ å¯¹åº”çš„å¥–åŠ± $R_{t+1}$ ä¼šåœ¨ $t+1$ æ—¶åˆ»å¾—åˆ°ã€‚ ç¬¬å››ä¸ªæ˜¯ä¸ªä½“çš„ç­–ç•¥(policy) $Ï€$,å®ƒä»£è¡¨ä¸ªä½“é‡‡å–åŠ¨ä½œçš„ä¾æ®ï¼Œå³ä¸ªä½“ä¼šä¾æ®ç­–ç•¥ $Ï€$ æ¥é€‰æ‹©åŠ¨ä½œã€‚æœ€å¸¸è§çš„ç­–ç•¥è¡¨è¾¾æ–¹å¼æ˜¯ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $Ï€(a|s)$, å³åœ¨çŠ¶æ€ $s$ æ—¶é‡‡å–åŠ¨ä½œ $a$ çš„æ¦‚ç‡ã€‚å³ $Ï€(a|s)=P(A_t=a|S_t=s)$.æ­¤æ—¶æ¦‚ç‡å¤§çš„åŠ¨ä½œè¢«ä¸ªä½“é€‰æ‹©çš„æ¦‚ç‡è¾ƒé«˜ã€‚ ç¬¬äº”ä¸ªæ˜¯ä¸ªä½“åœ¨ç­–ç•¥ $Ï€$ å’ŒçŠ¶æ€ $s$ æ—¶ï¼Œé‡‡å–è¡ŒåŠ¨åçš„ä»·å€¼(value)ï¼Œä¸€èˆ¬ç”¨ $v_Ï€(s)$ è¡¨ç¤ºã€‚è¿™ä¸ªä»·å€¼ä¸€èˆ¬æ˜¯ä¸€ä¸ªæœŸæœ›å‡½æ•°ã€‚è™½ç„¶å½“å‰åŠ¨ä½œä¼šç»™ä¸€ä¸ªå»¶æ—¶å¥–åŠ± $R_{t+1}$,ä½†æ˜¯å…‰çœ‹è¿™ä¸ªå»¶æ—¶å¥–åŠ±æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºå½“å‰çš„å»¶æ—¶å¥–åŠ±é«˜ï¼Œä¸ä»£è¡¨åˆ°äº† $t+1$, $t+2$,â€¦æ—¶åˆ»çš„åç»­å¥–åŠ±ä¹Ÿé«˜ã€‚æ¯”å¦‚ä¸‹è±¡æ£‹ï¼Œæˆ‘ä»¬å¯ä»¥æŸä¸ªåŠ¨ä½œå¯ä»¥åƒæ‰å¯¹æ–¹çš„è½¦ï¼Œè¿™ä¸ªå»¶æ—¶å¥–åŠ±æ˜¯å¾ˆé«˜ï¼Œä½†æ˜¯æ¥ç€åé¢æˆ‘ä»¬è¾“æ£‹äº†ã€‚æ­¤æ—¶åƒè½¦çš„åŠ¨ä½œå¥–åŠ±å€¼é«˜ä½†æ˜¯ä»·å€¼å¹¶ä¸é«˜ã€‚å› æ­¤æˆ‘ä»¬çš„ä»·å€¼è¦ç»¼åˆè€ƒè™‘å½“å‰çš„å»¶æ—¶å¥–åŠ±å’Œåç»­çš„å»¶æ—¶å¥–åŠ±ã€‚ä»·å€¼å‡½æ•° $v_{\\pi}(s)$ ä¸€èˆ¬å¯ä»¥è¡¨ç¤ºä¸ºä¸‹å¼ï¼Œä¸åŒçš„ç®—æ³•ä¼šæœ‰å¯¹åº”çš„ä¸€äº›ä»·å€¼å‡½æ•°å˜ç§ï¼Œä½†æ€è·¯ç›¸åŒã€‚ $$v_{\\pi}(s)=\\mathbb{E}_Ï€(R_{t+1}+Î³R_{t+2}+Î³^2R_{t+3}+â€¦|S_t=s)$$ å…¶ä¸­ $Î³$ æ˜¯ç¬¬å…­ä¸ªæ¨¡å‹è¦ç´ ï¼Œå³å¥–åŠ±è¡°å‡å› å­ï¼Œåœ¨[0ï¼Œ1]ä¹‹é—´ã€‚å¦‚æœä¸º0ï¼Œåˆ™æ˜¯è´ªå©ªæ³•ï¼Œå³ä»·å€¼åªç”±å½“å‰å»¶æ—¶å¥–åŠ±å†³å®šï¼Œå¦‚æœæ˜¯1ï¼Œåˆ™æ‰€æœ‰çš„åç»­çŠ¶æ€å¥–åŠ±å’Œå½“å‰å¥–åŠ±ä¸€è§†åŒä»ã€‚å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå–ä¸€ä¸ª0åˆ°1ä¹‹é—´çš„æ•°å­—ï¼Œå³å½“å‰å»¶æ—¶å¥–åŠ±çš„æƒé‡æ¯”åç»­å¥–åŠ±çš„æƒé‡å¤§ã€‚ ç¬¬ä¸ƒä¸ªæ˜¯ç¯å¢ƒçš„çŠ¶æ€è½¬åŒ–æ¨¡å‹ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ¦‚ç‡çŠ¶æ€æœºï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ï¼Œå³åœ¨çŠ¶æ€ $s$ ä¸‹é‡‡å–åŠ¨ä½œ $a$,è½¬åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ $sâ€™$ çš„æ¦‚ç‡ï¼Œè¡¨ç¤ºä¸º $P^a_{ssâ€™}$ã€‚ ç¬¬å…«ä¸ªæ˜¯æ¢ç´¢ç‡ $Ïµ$ï¼Œè¿™ä¸ªæ¯”ç‡ä¸»è¦ç”¨åœ¨å¼ºåŒ–å­¦ä¹ è®­ç»ƒè¿­ä»£è¿‡ç¨‹ä¸­ï¼Œç”±äºæˆ‘ä»¬ä¸€èˆ¬ä¼šé€‰æ‹©ä½¿å½“å‰è½®è¿­ä»£ä»·å€¼æœ€å¤§çš„åŠ¨ä½œï¼Œä½†æ˜¯è¿™ä¼šå¯¼è‡´ä¸€äº›è¾ƒå¥½çš„ä½†æˆ‘ä»¬æ²¡æœ‰æ‰§è¡Œè¿‡çš„åŠ¨ä½œè¢«é”™è¿‡ã€‚å› æ­¤æˆ‘ä»¬åœ¨è®­ç»ƒé€‰æ‹©æœ€ä¼˜åŠ¨ä½œæ—¶ï¼Œä¼šæœ‰ä¸€å®šçš„æ¦‚ç‡ $Ïµ$ ä¸é€‰æ‹©ä½¿å½“å‰è½®è¿­ä»£ä»·å€¼æœ€å¤§çš„åŠ¨ä½œï¼Œè€Œé€‰æ‹©å…¶ä»–çš„åŠ¨ä½œã€‚ ä»¥ä¸Š8ä¸ªå°±æ˜¯å¼ºåŒ–å­¦ä¹ æ¨¡å‹çš„åŸºæœ¬è¦ç´ äº†ã€‚å½“ç„¶ï¼Œåœ¨ä¸åŒçš„å¼ºåŒ–å­¦ä¹ æ¨¡å‹ä¸­ï¼Œä¼šè€ƒè™‘ä¸€äº›å…¶ä»–çš„æ¨¡å‹è¦ç´ ï¼Œæˆ–è€…ä¸è€ƒè™‘ä¸Šè¿°è¦ç´ çš„æŸå‡ ä¸ªï¼Œä½†æ˜¯è¿™8ä¸ªæ˜¯å¤§å¤šæ•°å¼ºåŒ–å­¦ä¹ æ¨¡å‹çš„åŸºæœ¬è¦ç´ ã€‚ 3. å¼ºåŒ–å­¦ä¹ çš„ç®€å•å®ä¾‹ è¿™é‡Œç»™å‡ºä¸€ä¸ªç®€å•çš„å¼ºåŒ–å­¦ä¹ ä¾‹å­Tic-Tac-Toeã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ¸¸æˆï¼Œåœ¨ä¸€ä¸ª3x3çš„ä¹å®«æ ¼é‡Œï¼Œä¸¤ä¸ªäººè½®æµä¸‹ï¼Œç›´åˆ°æœ‰ä¸ªäººçš„æ£‹å­æ»¡è¶³ä¸‰ä¸ªä¸€æ¨ªä¸€ç«–æˆ–è€…ä¸€æ–œï¼Œèµ¢å¾—æ¯”èµ›æ¸¸æˆç»“æŸï¼Œæˆ–è€…ä¹å®«æ ¼å¡«æ»¡ä¹Ÿæ²¡æœ‰äººèµ¢ï¼Œåˆ™å’Œæ£‹ã€‚ è¿™ä¸ªä¾‹å­çš„å®Œæ•´ä»£ç åœ¨githubã€‚ä¾‹å­åªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå¾ˆç®€å•ï¼Œä»£ç é¦–å…ˆä¼šç”¨ä¸¤ä¸ªç”µè„‘é€‰æ‰‹è®­ç»ƒæ¨¡å‹ï¼Œç„¶åå¯ä»¥è®©äººå’Œæœºå™¨å¯¹æˆ˜ã€‚å½“ç„¶ï¼Œç”±äºè¿™ä¸ªæ¨¡å‹å¾ˆç®€å•ï¼Œæ‰€ä»¥åªè¦ä½ ä¸ä¹±èµ°ï¼Œæœ€åçš„ç»“æœéƒ½æ˜¯å’Œæ£‹ï¼Œå½“ç„¶æƒ³èµ¢ç”µè„‘ä¹Ÿæ˜¯ä¸å¯èƒ½çš„ã€‚ æˆ‘ä»¬é‡ç‚¹çœ‹çœ‹è¿™ä¸ªä¾‹å­çš„æ¨¡å‹ï¼Œç†è§£ä¸Šé¢ç¬¬äºŒèŠ‚çš„éƒ¨åˆ†ã€‚å¦‚ä½•è®­ç»ƒå¼ºåŒ–å­¦ä¹ æ¨¡å‹å¯ä»¥å…ˆä¸ç®¡ã€‚ä»£ç éƒ¨åˆ†å¤§å®¶å¯ä»¥è‡ªå·±å»çœ‹ï¼Œåªæœ‰300å¤šè¡Œã€‚ é¦–å…ˆçœ‹ç¬¬ä¸€ä¸ªè¦ç´ ç¯å¢ƒçš„çŠ¶æ€ $S$ã€‚è¿™æ˜¯ä¸€ä¸ªä¹å®«æ ¼ï¼Œæ¯ä¸ªæ ¼å­æœ‰ä¸‰ç§çŠ¶æ€ï¼Œå³æ²¡æœ‰æ£‹å­(å–å€¼0)ï¼Œæœ‰ç¬¬ä¸€ä¸ªé€‰æ‰‹çš„æ£‹å­(å–å€¼1)ï¼Œæœ‰ç¬¬äºŒä¸ªé€‰æ‰‹çš„æ£‹å­(å–å€¼-1)ã€‚é‚£ä¹ˆè¿™ä¸ªæ¨¡å‹çš„çŠ¶æ€ä¸€å…±æœ‰$3^9=19683$ä¸ªã€‚ æ¥ç€æˆ‘ä»¬çœ‹ä¸ªä½“çš„åŠ¨ä½œ $A$ï¼Œè¿™é‡Œåªæœ‰9ä¸ªæ ¼å­ï¼Œæ¯æ¬¡ä¹Ÿåªèƒ½ä¸‹ä¸€æ­¥ï¼Œæ‰€ä»¥æœ€å¤šåªæœ‰9ä¸ªåŠ¨ä½œé€‰é¡¹ã€‚å®é™…ä¸Šç”±äºå·²ç»æœ‰æ£‹å­çš„æ ¼å­æ˜¯ä¸èƒ½å†ä¸‹çš„ï¼Œæ‰€ä»¥åŠ¨ä½œé€‰é¡¹ä¼šæ›´å°‘ã€‚å®é™…å¯ä»¥é€‰æ‹©åŠ¨ä½œçš„å°±æ˜¯é‚£äº›å–å€¼ä¸º0çš„æ ¼å­ã€‚ ç¬¬ä¸‰ä¸ªæ˜¯ç¯å¢ƒçš„å¥–åŠ± $R$ï¼Œè¿™ä¸ªä¸€èˆ¬æ˜¯æˆ‘ä»¬è‡ªå·±è®¾è®¡ã€‚ç”±äºæˆ‘ä»¬çš„ç›®çš„æ˜¯èµ¢æ£‹ï¼Œæ‰€ä»¥å¦‚æœæŸä¸ªåŠ¨ä½œå¯¼è‡´çš„æ”¹å˜åˆ°çš„çŠ¶æ€å¯ä»¥ä½¿æˆ‘ä»¬èµ¢æ£‹ï¼Œç»“æŸæ¸¸æˆï¼Œé‚£ä¹ˆå¥–åŠ±æœ€é«˜ï¼Œåä¹‹åˆ™å¥–åŠ±æœ€ä½ã€‚å…¶ä½™çš„åŒæ–¹ä¸‹æ£‹åŠ¨ä½œéƒ½æœ‰å¥–åŠ±ï¼Œä½†å¥–åŠ±è¾ƒå°‘ã€‚ç‰¹åˆ«çš„ï¼Œå¯¹äºå…ˆä¸‹çš„æ£‹æ‰‹ï¼Œä¸ä¼šå¯¼è‡´ç»“æŸçš„åŠ¨ä½œå¥–åŠ±è¦æ¯”åä¸‹çš„æ£‹æ‰‹å°‘ã€‚ # give reward to two players def giveReward(self): if self.currentState.winner == self.p1Symbol: self.p1.feedReward(1) self.p2.feedReward(0) elif self.currentState.winner == self.p2Symbol: self.p1.feedReward(0) self.p2.feedReward(1) else: self.p1.feedReward(0.1) self.p2.feedReward(0.5) ç¬¬å››ä¸ªæ˜¯ä¸ªä½“çš„ç­–ç•¥(policy) $Ï€$ï¼Œè¿™ä¸ªä¸€èˆ¬æ˜¯å­¦ä¹ å¾—åˆ°çš„ï¼Œæˆ‘ä»¬ä¼šåœ¨æ¯è½®ä»¥è¾ƒå¤§çš„æ¦‚ç‡é€‰æ‹©å½“å‰ä»·å€¼æœ€é«˜çš„åŠ¨ä½œï¼ŒåŒæ—¶ä»¥è¾ƒå°çš„æ¦‚ç‡å»æ¢ç´¢æ–°åŠ¨ä½œï¼Œåœ¨è¿™é‡ŒAIçš„ç­–ç•¥å¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºã€‚é‡Œé¢çš„exploreRateå°±æ˜¯æˆ‘ä»¬çš„ç¬¬å…«ä¸ªè¦ç´ æ¢ç´¢ç‡ $Ïµ$ã€‚å³ç­–ç•¥æ˜¯ä»¥ $1âˆ’Ïµ$ çš„æ¦‚ç‡é€‰æ‹©å½“å‰æœ€å¤§ä»·å€¼çš„åŠ¨ä½œï¼Œä»¥ $Ïµ$ çš„æ¦‚ç‡éšæœºé€‰æ‹©æ–°åŠ¨ä½œã€‚ # determine next action def takeAction(self): state = self.states[-1] nextStates = [] nextPositions = [] for i in range(BOARD_ROWS): for j in range(BOARD_COLS): if state.data[i, j] == 0: nextPositions.append([i, j]) nextStates.append(state.nextState(i, j, self.symbol).getHash()) if np.random.binomial(1, self.exploreRate): np.random.shuffle(nextPositions) # Not sure if truncating is the best way to deal with exploratory step # Maybe it's better to only skip this step rather than forget all the history self.states = [] action = nextPositions[0] action.append(self.symbol) return action values = [] for hash, pos in zip(nextStates, nextPositions): values.append((self.estimations[hash], pos)) np.random.shuffle(values) values.sort(key=lambda x: x[0], reverse=True) action = values[0][1] action.append(self.symbol) return action ç¬¬äº”","date":"2024-02-21","objectID":"/posts/rl_learning_note_1/:0:0","tags":["RL"],"title":"RLå­¦ä¹ ç¬”è®° [1] | æ¨¡å‹åŸºç¡€","uri":"/posts/rl_learning_note_1/"},{"categories":["AD"],"content":"0. æè¿° Dubinså’ŒRSæ›²çº¿éƒ½æ˜¯è·¯å¾„è§„åˆ’çš„ç»å…¸ç®—æ³•ï¼Œå…¶ä¸­è½¦è¾†è¿åŠ¨å­¦åˆ©ç”¨RSæ›²çº¿å±…å¤šï¼Œå› æ­¤ç®€å•ä»‹ç»Dubinså¹¶å¼•å‡ºRSæ›²çº¿ã€‚ èŠ±äº†ç‚¹æ—¶é—´çœ‹äº†äºŒè€…çš„è®ºæ–‡ï¼Œå¹¶é˜…è¯»äº†ä¸€ä¸ªå¼€æºçš„ä»£ç ã€‚ ","date":"2024-02-20","objectID":"/posts/dubinsandrs/:1:0","tags":["Planning"],"title":"è½¦è¾†è·¯å¾„è§„åˆ’ä¹‹Dubinsæ›²çº¿ä¸RSæ›²çº¿ç®€è¿°","uri":"/posts/dubinsandrs/"},{"categories":["AD"],"content":"1. Dubinsæ›²çº¿ Dubinsæ›²çº¿æ˜¯åœ¨æ»¡è¶³æ›²ç‡çº¦æŸå’Œè§„å®šçš„å§‹ç«¯å’Œæœ«ç«¯çš„åˆ‡çº¿ï¼ˆè¿›å…¥æ–¹å‘ï¼‰çš„æ¡ä»¶ä¸‹ï¼Œè¿æ¥ä¸¤ä¸ªäºŒç»´å¹³é¢çš„æœ€çŸ­è·¯å¾„ã€‚å®ƒæ»¡è¶³ç»™å®šçš„è¿åŠ¨æ›²ç‡çº¦æŸï¼Œå³è½¬å¼¯åŠå¾„å¤§äºç­‰äºç»™å®šçš„åŠå¾„ã€‚ å‡è®¾é¡ºæ—¶é’ˆåœ†å‘¨è¿åŠ¨ä¸ºRï¼Œé€†æ—¶é’ˆåœ†å‘¨è¿åŠ¨ä¸ºLï¼Œç›´çº¿è¿åŠ¨ä¸ºSã€‚æ±‚å‡ºDubinsæ›²çº¿ï¼Œç”¨ä»»åŠ¡æ¥è¡¨è¾¾å°±æ˜¯ ç»™äº†è½¦è¾†èµ·å§‹ä½ç½® $(x_{start},y_{start})$ ï¼Œè½¦è¾†çš„æœå‘ $\\theta_{start}$ ï¼Œå†ç»™ä¸€ä¸ªè½¦è¾†çš„ç›®æ ‡ä½ç½® $(x_{end},y_{end})$ ï¼Œè½¦è¾†çš„ç›®æ ‡æœå‘ä¸º $\\theta_{end}$ ã€‚è½¦è¾†æœ€å¤šèƒ½å®ç°çš„æ›²ç‡ä¸º $K_{max}$ ã€‚è½¦è¾†ä¸å¯ä»¥åšåé€€è¿åŠ¨ï¼Œåªèƒ½å‘å‰å¼€ã€‚ è§„åˆ’çš„æ›²çº¿åˆ†ä¸‰æ®µï¼Œç¬¬ä¸€æ®µæ˜¯ç»•å›ºå®šåœ†å¿ƒçš„Læˆ–Rï¼Œç¬¬äºŒæ®µæ˜¯L/R/Sï¼Œç¬¬ä¸‰æ®µæ˜¯L/Rã€‚ç”¨è¿™ä¸‰æ®µæ›²çº¿å¯ä»¥ä½¿è½¦è¾†ä»åˆå§‹ä½å§¿è¿ç»­çš„ç§»åŠ¨åˆ°ç›®æ ‡ä½å§¿ã€‚ ä¸‰æ®µæ›²çº¿å¯ä»¥ç»„æˆçš„é›†åˆæœ‰6ç§={LSLã€RSRã€RSLã€LSRã€RLRã€LRL}ã€‚è¿™å…­ç§å¯èƒ½ä¸­æœ€çŸ­çš„è·¯å¾„å°±æ˜¯Dubinsæ›²çº¿ã€‚ ç½‘ä¸Šæœ‰å¾ˆå¤šå…³äºDubinsæ›²çº¿çš„æ–‡ç« ï¼Œéƒ½å¾ˆç®€å•ã€‚å…ˆæŠŠåˆå§‹ä½å§¿å’Œç›®æ ‡ä½å§¿åšä¸€ä¸‹å·®å€¼ï¼Œå¾—åˆ°ä¸€ä¸ªæ›´ç®€å•çš„åæ ‡ç³»ã€‚å†é€šè¿‡ç”»åœ†å’Œç›´çº¿ï¼Œæ±‚è§£ä¸€äº›æ–¹ç¨‹ï¼Œå°±å¯ä»¥è®¡ç®—å‡ºä¸åŒé€‰æ‹©è·¯å¾„çš„é•¿åº¦å€¼ã€‚å†ä»ä¸­å–æœ€å°çš„ï¼Œå°±å¯ä»¥å¾—åˆ°Dubinsæ›²çº¿äº†ã€‚è¿™é‡Œä¸å¤šä»‹ç»ã€‚ æœ‰å…³Dubinsçš„æ–‡ç« æœ‰å¾ˆå¤šï¼Œå¯¹äº6ç§ä¸åŒçš„è·¯å¾„ï¼Œéƒ½æœ‰å¯¹åº”çš„å…¬å¼å»è®¡ç®—æ¯æ®µçš„é•¿åº¦å€¼ã€‚ ","date":"2024-02-20","objectID":"/posts/dubinsandrs/:2:0","tags":["Planning"],"title":"è½¦è¾†è·¯å¾„è§„åˆ’ä¹‹Dubinsæ›²çº¿ä¸RSæ›²çº¿ç®€è¿°","uri":"/posts/dubinsandrs/"},{"categories":["AD"],"content":"2. Reeds-Sheppæ›²çº¿ 1. åŸç† â€œåˆ©ç”¨å€’æŒ¡çš„RSæ›²çº¿å¯ä»¥æ¯”Dubinsæ›²çº¿æ›´ä¼˜â€ è®ºæ–‡ã€ŠOptimal paths for a car that goes both forwards and backwardsã€‹æå‡ºäº†Reeds-Sheppæ›²çº¿ã€‚è¿™ç¯‡è®ºæ–‡ç”±Reedså’ŒSheppåœ¨1990å¹´å‘è¡¨ã€‚ä»–ä»¬æå‡ºäº†ä¸€ç§èƒ½å¤Ÿè®¡ç®—å‡ºè½¦è¾†ä»¥å›ºå®šè½¬å¼¯åŠå¾„ï¼Œç”±ä¸€ä¸ªå§¿æ€å‘å¦ä¸€ä¸ªå§¿æ€è¿åŠ¨çš„æœ€çŸ­è·¯å¾„çš„æ›²çº¿ï¼Œå³Reeds-Sheppæ›²çº¿ï¼Œç®€ç§°ä¸ºRSæ›²çº¿ã€‚ å¯¹äºDubinsæ›²çº¿ï¼Œå½“æˆ‘ä»¬éœ€è¦è½¦è¾†ä½ç½®ä¸å˜åŸåœ°æ‰å¤´æ—¶ï¼Œæœ‰å¦‚ä¸‹å›¾çš„æƒ…å†µï¼š Dubinsæ›²çº¿ å›¾Aå’Œå›¾Béƒ½å¯ä»¥è¾¾åˆ°ç›®æ ‡ã€‚æ ¹æ®Dubinsæ›²çº¿çš„å®šä¹‰ï¼Œæˆ‘ä»¬çŸ¥é“å›¾Bæ˜¯æœ€ä¼˜çš„è·¯çº¿ï¼ŒåŒæ—¶å­˜åœ¨å¦å¤–ä¸€æ¡æ›²çº¿å›¾Cï¼Œä¹Ÿèƒ½è¾¾åˆ°ç›¸åŒçš„æ•ˆæœã€‚ä½†è¿™å’Œæˆ‘ä»¬å¹³æ—¶å¼€è½¦æ˜¾ç„¶ä¸åŒï¼Œå› ä¸ºæˆ‘ä»¬çš„è½¦è¾†æ˜¯å¯ä»¥æŒ‚å€’æŒ¡çš„ã€‚æˆ‘ä»¬é€‰æ‹©å›¾Dä»£è¡¨çš„è·¯å¾„ï¼Œå¯ä»¥æ›´å¿«è¾¾åˆ°ç›®æ ‡ã€‚ ç›¸è¾ƒäºDubinsæ›²çº¿ï¼ŒRSæ›²çº¿æœ‰äº†è¿›ä¸€æ­¥çš„çº¦æŸæ¡ä»¶ï¼šè¦æ±‚æ¯ä¸ªç‚¹çš„æ›²ç‡åŠå¾„éƒ½å¤§äº1ï¼ŒåŒæ—¶å…è®¸è½¦è¾†å¯ä»¥åé€€ã€‚å½“è½¦è¾†å¯ä»¥å€’é€€æ—¶ï¼Œè·¯å¾„æœ‰å¯èƒ½è¢«ç¼©çŸ­å˜å¾—æ›´ä¼˜ï¼Œè€Œæ­¤æ—¶Dubinsæ›²çº¿å°†ä¸èƒ½æ»¡è¶³è¦æ±‚ã€‚ä½œè€…å¯¹RSæ›²çº¿çš„æ‰€æœ‰å¯èƒ½è¿›è¡Œäº†ç®€åŒ–è¡¨ç¤ºï¼Œåœ¨æ–‡ä¸­åšå‡ºäº†ä¸€ç³»åˆ—å®šä¹‰ï¼Œæˆ‘æŒ‰ç…§æ–‡ç« çš„é¡ºåºè¿›è¡Œè®²è§£ã€‚ 2. å®šä¹‰ â€¢Cä»£è¡¨å·¦è½¬ï¼ˆLï¼‰æˆ–å³è½¬ï¼ˆRï¼‰ï¼ŒSä»£è¡¨æ²¿ç›´çº¿è¡Œé©¶ã€‚C^+å’ŒC^-çš„ä¸Šæ ‡ä»£è¡¨å‰è¿›å’Œåé€€ï¼ˆåœ¨è½¦è¾†é‡Œå°±æ˜¯æ¢æ¡£ï¼‰ã€‚å› æ­¤ï¼ŒCCä»£è¡¨çš„å°±æ˜¯LRæˆ–è€…RLã€‚ â€¢ $C^+{\\pi/2}$ ä»£è¡¨å‰è¿›æ–¹å‘å¼§é•¿èµ° $\\pi/2$ï¼ŒC^-{-\\pi/2}ä»£è¡¨åé€€æ–¹å‘å¼§é•¿èµ°\\pi/2ã€‚æ‰€ä»¥å†é€šç”¨ä¸€äº›ï¼ŒC^\\pm_tè¡¨è¾¾å¼ä¸­çš„Cå¯ä»¥ä»£è¡¨Lã€Ræˆ–è€…Sï¼Œä¸Šæ ‡ä»£è¡¨å‰è¿›æ–¹å‘ï¼Œä¸‹æ ‡tæ˜¯å’Œä¸Šæ ‡æ­£è´Ÿå·ç›¸åŒçš„ä»£è¡¨å¼§é•¿çš„å€¼ã€‚ â€¢C_uC_uè¿™ä¸¤ä¸ªéœ€è¦è¿åœ¨ä¸€èµ·å‡ºç°ï¼Œä»£è¡¨ä¸¤æ®µå¼§é•¿ç›¸ç­‰ã€‚ åœ¨è¯¸å¦‚C^+_tC^-_uC^-_vv^+_wè¿™æ ·çš„è·¯å¾„æ—ï¼ˆç”±å››æ®µç»„æˆçš„è·¯å¾„ï¼ŒåŒæ ·çš„è¿˜æœ‰C^-_tC^+_uC^+_vv^-_wâ€¦â€¦ç­‰ï¼‰ä¸­ï¼Œè‡ªç”±å‚æ•°t,u,v,wä¸€å…±æœ‰4ä¸ªå‚æ•°ï¼Œæ¯”æ¡ä»¶çš„æ•°é‡ï¼ˆç›®æ ‡ä½ç½®å’Œè§’åº¦ï¼‰å¤šäº†1ä¸ªï¼Œå› æ­¤å¯¹äºç»™å®šçš„ç»ˆç‚¹æ¡ä»¶é€šå¸¸å­˜åœ¨å¤šä¸ªè§£ã€‚æˆ‘ä»¬å¯¹æ—ä¸­çš„è·¯å¾„è¿›è¡Œä¼˜åŒ–ï¼Œèƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ªé¢å¤–çš„æ–¹ç¨‹ï¼Œç»“æœå°±æ˜¯ v = uï¼Œæˆ–v = Ï€/2ã€‚è¿™æ ·çœ‹å‚æ•°ä»ç„¶æ˜¯ä¸‰ä¸ªã€‚ ä½œè€…åœ¨åé¢ä¼šè¯æ˜ï¼Œç¡®å®è¿˜æœ‰ç±»ä¼¼äºC^+C^-C^+C^-C^+C^-è¿™æ ·çš„è·¯å¾„å­˜åœ¨ï¼Œè¿™æ ·çš„è·¯å¾„å¹¶ä¸åœ¨ä½œè€…æåˆ°çš„å½¢å¼ä¹‹ä¸­ã€‚ä½†æ˜¯è¿™ç§è·¯å¾„å¾€å¾€åœ¨æˆ‘ä»¬çš„å½¢å¼ä¸­æœ‰ç›¸åŒçš„æ›¿ä»£è·¯å¾„ã€‚å¯¹äºä¸åœ¨ä½œè€…é›†åˆä¸­çš„è·¯å¾„ï¼Œå°†ä¸ä¼šå‡ºç°åœ¨ç®€å•çš„å‰å‘åœºæ™¯ä¸­ã€‚ ä½œè€…æå‡ºäº†ä¸¤ç§æè¿°æ–¹å¼ï¼Œä¸€ç§æ˜¯ç”¨\\pmä»£è¡¨çš„æ­£è´Ÿæ–¹å‘ å¦ä¸€ç§æ˜¯ç”¨ | ä»£è¡¨çš„æ¡£ä½å˜åŒ– BP Network ä»¥è½¦è¾†ä¸ºä¾‹ï¼Œå¦‚æœç”¨çœŸå®çš„å·¦æ‰“è½®å’Œå³æ‰“è½®ï¼ŒåŠ ä¸Šæ¡£ä½å˜åŒ–ï¼Œä¸€å…±ä¼šæœ‰48ç§ä¸åŒçš„è·¯å¾„ï¼Œå¦‚ä¸‹å›¾ã€‚ç”±äºæœ‰ä¸€äº›è·¯å¾„ä¼šæœ‰å¤šä¸ªå…¬å¼æ¥è¡¨è¾¾ï¼Œæ‰€ä»¥è¿™48ç§è·¯å¾„æœ€å¤šä¼šæœ‰68ä¸ªå…¬å¼ã€‚ BP Network Dubinsæ›²çº¿å’Œæˆ‘ä»¬çš„è¯æ˜æ–¹å¼ä¸åŒã€‚Dubinsè¯æ˜äº†ä»»ä½•ç»ˆç‚¹æ¡ä»¶ä¸‹éƒ½ä¼šå­˜åœ¨è·¯å¾„ï¼Œå³é—®é¢˜çš„ä¸‹é™è¢«ç¡®å®šäº†ã€‚åŒæ—¶ï¼Œä»»ä½•è·¯å¾„é•¿åº¦å°äº \\pi/8çš„è·¯å¾„ä¸€å®šæ˜¯ä¸€ä¸ªCSCç±»å‹çš„è·¯å¾„ã€‚ç„¶åå®¹æ˜“å¾—åˆ°ï¼Œæ¯ä¸ªè·¯å¾„å¿…é¡»ç”±æœ‰é™çš„Cå’ŒSç»„æˆï¼Œæœ€ç»ˆè·¯å¾„ç®€åŒ–ä¸ºäº†CSCå’ŒCCCä¸¤ç§å¯èƒ½ã€‚ä½œè€…æ²¡æœ‰èƒ½å¤Ÿç”¨Dubinsçš„æ–¹æ³•æ¥è§£å†³æœ¬æ–‡ç« æåˆ°çš„è½¦è¾†åå‘è¿åŠ¨é—®é¢˜ã€‚ä½œè€…åœ¨ç¬¬7èŠ‚è¯æ˜äº†åœ¨ä¸å¢åŠ è·¯å¾„é•¿åº¦çš„æƒ…å†µä¸‹ï¼Œæœ€å¤š5æ®µå°±èƒ½è¡¨ç¤ºè·¯å¾„ï¼Œè¯æ˜æ–¹æ³•ä¸Dubinsç±»ä¼¼ã€‚ ä½œè€…é™¤äº†ç”¨æ•°å­¦å…¬å¼æ¥æ¨å¯¼è¯æ˜ï¼Œè¿˜ç”¨è®¡ç®—æœºæ¥åšäº†éªŒè¯ï¼šè®¾ç½®äº†ä¸€ä¸ªåŒ…å«å¾ˆå¤šæ¡å­è·¯å¾„çš„é›†åˆWï¼Œéšæœºå‡ºèµ·å§‹æ¡ä»¶å’Œç»ˆæ­¢æ¡ä»¶ï¼Œå¦‚æœåœ¨é›†åˆWä¸­æ‰¾åˆ°äº†ä¸¤æ¡è·¯å¾„å°±èƒ½è¿æ¥èµ·ç‚¹ç»ˆç‚¹ï¼Œé‚£ä¹ˆé›†åˆWæ˜¾ç„¶å°±æ˜¯ä¸å……åˆ†çš„ï¼Œå°±è¦å¯¹é›†åˆWè¿›è¡Œä¸€äº›ä¿®å‰ªã€‚æœ€ç»ˆç”¨è¿™ç§æ–¹å¼å¾—åˆ°äº†ä¸€ä¸ªæœ€å°çš„æœ‰æ•ˆé›†åˆWã€‚ä¸€æ—¦çŒœæµ‹å‡ºäº†Wï¼Œä½œè€…å†æ¬¡ä½¿ç”¨è®¡ç®—æœºæ¥å¸®åŠ©è¿›è¡Œå¤§é‡æƒ…å†µä¸‹çš„å¹¿æ³›ä»£æ•°è¿ç®—ï¼Œä»¥éªŒè¯ä¸Šè¿°æ–¹æ³•å¯ä»¥ç»™å‡ºä¸¥æ ¼çš„è¯æ˜ã€‚æœ€åï¼Œä½œè€…å‘ç°è¯æ˜å¯ä»¥ç®€åŒ–ä¸ºä¸Šå›¾ï¼Œè¿™æ ·æ™®é€šäººå¯ä»¥åœ¨æ²¡æœ‰è®¡ç®—æœºæ£€æŸ¥ç»†èŠ‚çš„æƒ…å†µä¸‹è½»æ¾ç†è§£ã€‚ä½†ä½œè€…è®¤ä¸ºï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨è®¡ç®—æœºï¼Œä»–ä»¬æ°¸è¿œä¸å¯èƒ½æ‰¾åˆ°æ­£ç¡®çš„å­è·¯å¾„é›†ã€‚ï¼ˆè¿™å®é™…ä¸Šè¡¨æ˜ä½œè€…æ˜¯åœ¨è®¡ç®—æœºè¾…åŠ©ä¸‹ï¼ŒæˆåŠŸåœ°æ‰¾åˆ°äº†RSæ›²çº¿çš„è§£ï¼Œå¹¶é€šè¿‡å¹¿æ³›çš„ä»£æ•°è¿ç®—éªŒè¯äº†ä»–ä»¬çš„æ–¹æ³•ã€‚æœ€ç»ˆï¼Œä»–ä»¬å†åè¿‡æ¥ç®€åŒ–è¯æ˜è¿‡ç¨‹ï¼Œæœ€ç»ˆè®©RSæ›²çº¿æ›´æ˜“äºç†è§£ã€‚ï¼‰ ","date":"2024-02-20","objectID":"/posts/dubinsandrs/:3:0","tags":["Planning"],"title":"è½¦è¾†è·¯å¾„è§„åˆ’ä¹‹Dubinsæ›²çº¿ä¸RSæ›²çº¿ç®€è¿°","uri":"/posts/dubinsandrs/"},{"categories":["AD"],"content":"3. ç­‰æ•ˆè¿ç®— ä½œè€…æåˆ°ï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡éƒ½éœ€è¦è®¡ç®—48ç§è·¯å¾„ï¼Œå› ä¸ºå­˜åœ¨ä¸€äº›åŸºæœ¬å˜æ¢è§„åˆ™å¯ä»¥ç®€åŒ–è®¡ç®— ç¬¬ä¸€ç§ç­‰æ•ˆè¿ç®—ï¼šâ€timeflipâ€â€”â€”æ—¶é—´å˜æ¢ è·¯å¾„ $l^+ r^- s^- l^-$ å’Œè·¯å¾„ l^-r^+s^+l^+ ä¹‹é—´çš„å…³ç³»å°±æ˜¯æ—¶é—´å˜æ¢ï¼Œå¯ä»¥çœ‹å‡ºå…¶å®å°±æ˜¯å‰è¿›å’Œåé€€åŠ¨ä½œæ›¿æ¢äº†ä¸€ä¸‹ å½“æˆ‘ä»¬æƒ³æ±‚æ²¿è·¯å¾„ l^-r^+s^+l^+ ä» [0,0,0] åˆ° [x,y,\\phi] æ—¶ ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚æ²¿è·¯å¾„ l^+r^-s^-l^-ä» [0,0,0] åˆ° [-x,y,-\\phi]ï¼Œæ±‚å‡ºçš„è·¯å¾„ l^+r^-s^-l^-ä¸­æ¯æ®µèµ°çš„å¼§é•¿ï¼Œå°±æ˜¯å¾…æ±‚è·¯å¾„ l^-r^+s^+l^+ çš„å¼§é•¿ç»“æœ ç¬¬äºŒç§ç­‰æ•ˆè¿ç®—ï¼šâ€œreflectâ€â€”â€”åå°„å˜æ¢ è·¯å¾„ l^+r^-s^-l^- å’Œè·¯å¾„ r^+l^-s^-r^- ä¹‹é—´çš„å…³ç³»å°±æ˜¯åå°„å˜æ¢ï¼Œå¯ä»¥çœ‹å‡ºå…¶å®å°±æ˜¯å‘å·¦å’Œå‘å³æ›¿æ¢äº†ä¸€ä¸‹ å½“æˆ‘ä»¬æƒ³æ±‚æ²¿è·¯å¾„ r^+l^-s^-r^- ä» [0,0,0] åˆ° [x,y,\\phi] æ—¶ ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚æ²¿è·¯å¾„ l^+r^-s^-l^-ä» [0,0,0] åˆ° [x,-y,-\\phi]ï¼Œæ±‚å‡ºçš„è·¯å¾„ l^+r^-s^-l^-ä¸­æ¯æ®µèµ°çš„å¼§é•¿ï¼Œå°±æ˜¯å¾…æ±‚è·¯å¾„ r^+l^-s^-r^- çš„å¼§é•¿ç»“æœ ç¬¬ä¸‰ç§ç­‰æ•ˆè¿ç®—ï¼šâ€œbackwardsâ€â€”â€”åå‘å˜æ¢ è·¯å¾„ l^+r^-s^-l^- å’Œè·¯å¾„ l^-s^-r^-l^+ ä¹‹é—´çš„å…³ç³»å°±æ˜¯åå‘å˜æ¢ï¼Œå¯ä»¥çœ‹å‡ºå…¶å®ä¸¤æ¡è·¯å¾„å‰åé¡ºåºé¢ å€’äº†ä¸€ä¸‹ å½“æˆ‘ä»¬æƒ³æ±‚æ²¿è·¯å¾„ l^-s^-r^-l^+ ä» [0,0,0] åˆ° [x,y,\\phi] æ—¶ ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚æ²¿è·¯å¾„ l^+r^-s^-l^-ä» [0,0,0] åˆ° [xcos\\phi+ysin\\phi,xsin\\phi-ycos\\phi,\\phi]ï¼Œæ±‚å‡ºçš„è·¯å¾„ l^+r^-s^-l^-ä¸­æ¯æ®µèµ°çš„å¼§é•¿ï¼Œå°±æ˜¯å¾…æ±‚è·¯å¾„ l^-s^-r^-l^+ çš„å¼§é•¿ç»“æœ ä¸Šé¢æåˆ°äº†ä¸‰ç§å˜æ¢å…³ç³»æ¥ç®€åŒ–è¿ç®—ï¼Œç®€å•ç†è§£ä¸€ä¸‹å°±æ˜¯ï¼š ä» [0,0,0] åˆ° [x,y,\\phi] éœ€è¦æ±‚è§£çš„ä¸‰ä¸ªè·¯å¾„ l^-r^+s^+l^+ã€r^+l^-s^-r^- ã€l^-s^-r^-l^+ï¼Œé€šè¿‡åˆ†åˆ«æ”¹å˜ç»ˆç‚¹çš„åæ ‡ï¼Œå‡å¯ä»¥é€šè¿‡æ±‚è§£è·¯å¾„ l^+r^-s^-l^- å¾—åˆ°æ¯æ®µè½¨è¿¹çš„å¼§é•¿æˆ–å‰è¿›è·ç¦» ","date":"2024-02-20","objectID":"/posts/dubinsandrs/:4:0","tags":["Planning"],"title":"è½¦è¾†è·¯å¾„è§„åˆ’ä¹‹Dubinsæ›²çº¿ä¸RSæ›²çº¿ç®€è¿°","uri":"/posts/dubinsandrs/"},{"categories":["AD"],"content":"4. æµç¨‹ä¸ä»£ç  ä¸Dubinsæ›²çº¿ä¸€è‡´ï¼ŒRSæ›²çº¿æ¯ç§è·¯å¾„ä¹Ÿæœ‰å¯¹åº”çš„å…¬å¼å¯ä»¥è®¡ç®—ã€‚ ç¬¬ä¸€æ­¥ï¼šèµ·å§‹ç‚¹åæ ‡å˜æ¢ï¼Œä»¤èµ·ç‚¹åæ ‡å˜ä¸º(0,0,0)ï¼Œç»ˆç‚¹çš„åæ ‡è½¬æ¢ä¸ºèµ·ç‚¹åæ ‡ç³»ä¸‹çš„åæ ‡ï¼Œä»è€Œç®€åŒ–åç»­è®¡ç®— q0 = [sx, sy, syaw] # èµ·ç‚¹:x,y,yaw q1 = [gx, gy, gyaw] # ç»ˆç‚¹:x,y,yaw dx = q1[0] - q0[0] dy = q1[1] - q0[1] dth = q1[2] - q0[2] c = math.cos(q0[2]) s = math.sin(q0[2]) x = (c * dx + s * dy) * max_curvature y = (-s * dx + c * dy) * max_curvature # èµ·ç‚¹å˜æˆäº†(0,0,0),ç»ˆç‚¹åæ ‡å˜æˆäº†(x, y, dth) ç¬¬äºŒæ­¥ï¼šè®¡ç®—è·¯å¾„ åˆ©ç”¨ä¸‰ç§åŸºæœ¬å®šç†ï¼Œè®¡ç®—å…¨éƒ¨çš„è·¯å¾„ ç¬¬ä¸‰æ­¥ï¼šé€‰æ‹©è·¯å¾„ é€‰æ‹©æœ€ä¼˜çš„è·¯å¾„ï¼Œå¹¶å¯¹ç”Ÿæˆçš„è·¯å¾„è¿›è¡Œå·®å€¼ï¼Œå¾—åˆ°è·¯å¾„ä¸Šçš„æ¯ä¸€ä¸ªè·¯å¾„ç‚¹ ","date":"2024-02-20","objectID":"/posts/dubinsandrs/:5:0","tags":["Planning"],"title":"è½¦è¾†è·¯å¾„è§„åˆ’ä¹‹Dubinsæ›²çº¿ä¸RSæ›²çº¿ç®€è¿°","uri":"/posts/dubinsandrs/"},{"categories":["AD"],"content":"5. æ€»ç»“ åŸç†åŸºæœ¬ä¸Šå¾ˆæ¸…æ¥šï¼Œæš‚æ—¶å¯¹å¯é€‰è·¯å¾„è®¡ç®—çš„ä¼˜åŒ–æ²¡æœ‰æ·±ç©¶ï¼Œä¹‹åå†è¯´ã€‚ ref: https://mp.weixin.qq.com/s/RfAEnFtUW7KkG7cSPqmWUw ","date":"2024-02-20","objectID":"/posts/dubinsandrs/:6:0","tags":["Planning"],"title":"è½¦è¾†è·¯å¾„è§„åˆ’ä¹‹Dubinsæ›²çº¿ä¸RSæ›²çº¿ç®€è¿°","uri":"/posts/dubinsandrs/"},{"categories":["Git"],"content":"Git å¸¸ç”¨å‘½ä»¤æ±‡æ€» ","date":"2024-02-02","objectID":"/posts/commandsheet/:0:0","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"å¸¸è§„æ“ä½œ git push origin test æ¨é€æœ¬åœ°åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ git rm -r --cached æ–‡ä»¶/æ–‡ä»¶å¤¹åå­— å–æ¶ˆæ–‡ä»¶è¢«ç‰ˆæœ¬æ§åˆ¶ git reflog è·å–æ‰§è¡Œè¿‡çš„å‘½ä»¤ git log --graph æŸ¥çœ‹åˆ†æ”¯åˆå¹¶å›¾ git merge --no-ff -m 'åˆå¹¶æè¿°' åˆ†æ”¯å ä¸ä½¿ç”¨Fast forwardæ–¹å¼åˆå¹¶ï¼Œé‡‡ç”¨è¿™ç§æ–¹å¼åˆå¹¶å¯ä»¥çœ‹åˆ°åˆå¹¶è®°å½• git check-ignore -v æ–‡ä»¶å æŸ¥çœ‹å¿½ç•¥è§„åˆ™ git add -f æ–‡ä»¶å å¼ºåˆ¶å°†æ–‡ä»¶æäº¤ ","date":"2024-02-02","objectID":"/posts/commandsheet/:1:0","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"Git åˆ›å»ºé¡¹ç›®ä»“åº“ git init åˆå§‹åŒ– git remote add origin url å…³è”è¿œç¨‹ä»“åº“ git pull git fetch è·å–è¿œç¨‹ä»“åº“ä¸­æ‰€æœ‰çš„åˆ†æ”¯åˆ°æœ¬åœ° ","date":"2024-02-02","objectID":"/posts/commandsheet/:1:1","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"å¿½ç•¥å·²åŠ å…¥åˆ°ç‰ˆæœ¬åº“ä¸­çš„æ–‡ä»¶ git update-index --assume-unchanged file å¿½ç•¥å•ä¸ªæ–‡ä»¶ git rm -r --cached æ–‡ä»¶/æ–‡ä»¶å¤¹åå­— (. å¿½ç•¥å…¨éƒ¨æ–‡ä»¶) ","date":"2024-02-02","objectID":"/posts/commandsheet/:1:2","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"å–æ¶ˆå¿½ç•¥æ–‡ä»¶ git update-index --no-assume-unchanged file ","date":"2024-02-02","objectID":"/posts/commandsheet/:1:3","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"æ‹‰å–ã€ä¸Šä¼ å…å¯†ç  git config --global credential.helper store ","date":"2024-02-02","objectID":"/posts/commandsheet/:1:4","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"åˆ†æ”¯æ“ä½œ git branch åˆ›å»ºåˆ†æ”¯ git branch -b åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°å»ºçš„åˆ†æ”¯ä¸Š git checkout åˆ‡æ¢åˆ†æ”¯ git branch æŸ¥çœ‹åˆ†æ”¯åˆ—è¡¨ git branch -v æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æœ€åä¸€æ¬¡æ“ä½œ git branch -vv æŸ¥çœ‹å½“å‰åˆ†æ”¯ git branch -b åˆ†æ”¯å origin/åˆ†æ”¯å åˆ›å»ºè¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ° git branch --merged æŸ¥çœ‹åˆ«çš„åˆ†æ”¯å’Œå½“å‰åˆ†æ”¯åˆå¹¶è¿‡çš„åˆ†æ”¯ git branch --no-merged æŸ¥çœ‹æœªä¸å½“å‰åˆ†æ”¯åˆå¹¶çš„åˆ†æ”¯ git branch -d åˆ†æ”¯å åˆ é™¤æœ¬åœ°åˆ†æ”¯ git branch -D åˆ†æ”¯å å¼ºè¡Œåˆ é™¤åˆ†æ”¯ git push origin --delete åˆ†æ”¯å åˆ é™¤è¿œç¨‹ä»“åº“åˆ†æ”¯ git merge åˆ†æ”¯å åˆå¹¶åˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯ä¸Š git push -u \u003cremote\u003e \u003clocal_branch\u003e å…³è”æœ¬åœ°åˆ†æ”¯åˆ°è¿œç¨‹åˆ†æ”¯ git push --set-upstream \u003cremote\u003e \u003clocal_branch\u003e å…³è”æœ¬åœ°åˆ†æ”¯åˆ°è¿œç¨‹åˆ†æ”¯ ","date":"2024-02-02","objectID":"/posts/commandsheet/:2:0","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"æš‚å­˜æ“ä½œ git stash æš‚å­˜å½“å‰ä¿®æ”¹ git stash apply æ¢å¤æœ€è¿‘çš„ä¸€æ¬¡æš‚å­˜ git stash pop æ¢å¤æš‚å­˜å¹¶åˆ é™¤æš‚å­˜è®°å½• git stash list æŸ¥çœ‹æš‚å­˜åˆ—è¡¨ git stash drop æš‚å­˜å(ä¾‹ï¼šstash@{0}) ç§»é™¤æŸæ¬¡æš‚å­˜ git stash clear æ¸…é™¤æš‚å­˜ ","date":"2024-02-02","objectID":"/posts/commandsheet/:3:0","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"å›é€€æ“ä½œ git reset --hard HEAD^ å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ git reset --hard commitId å›é€€åˆ°æŸä¸ªç‰ˆæœ¬ git checkout -- fileæ’¤é”€ä¿®æ”¹çš„æ–‡ä»¶(å¦‚æœæ–‡ä»¶åŠ å…¥åˆ°äº†æš‚å­˜åŒºï¼Œåˆ™å›é€€åˆ°æš‚å­˜åŒºçš„ï¼Œå¦‚æœæ–‡ä»¶åŠ å…¥åˆ°äº†ç‰ˆæœ¬åº“ï¼Œåˆ™è¿˜åŸè‡³åŠ å…¥ç‰ˆæœ¬åº“ä¹‹åçš„çŠ¶æ€) git reset HEAD file æ’¤å›æš‚å­˜åŒºçš„æ–‡ä»¶ä¿®æ”¹åˆ°å·¥ä½œåŒº ","date":"2024-02-02","objectID":"/posts/commandsheet/:4:0","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"æ ‡ç­¾æ“ä½œ git tag æ ‡ç­¾å æ·»åŠ æ ‡ç­¾(é»˜è®¤å¯¹å½“å‰ç‰ˆæœ¬) git tag æ ‡ç­¾å commitId å¯¹æŸä¸€æäº¤è®°å½•æ‰“æ ‡ç­¾ git tag -a æ ‡ç­¾å -m 'æè¿°' åˆ›å»ºæ–°æ ‡ç­¾å¹¶å¢åŠ å¤‡æ³¨ git tag åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾åˆ—è¡¨ git show æ ‡ç­¾å æŸ¥çœ‹æ ‡ç­¾ä¿¡æ¯ git tag -d æ ‡ç­¾å åˆ é™¤æœ¬åœ°æ ‡ç­¾ git push origin æ ‡ç­¾å æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“ git push origin --tags æ¨é€æ‰€æœ‰æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“ git push origin :refs/tags/æ ‡ç­¾å ä»è¿œç¨‹ä»“åº“ä¸­åˆ é™¤æ ‡ç­¾ ","date":"2024-02-02","objectID":"/posts/commandsheet/:5:0","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"è¿œç¨‹ä»“åº“ git remote -væŸ¥çœ‹è¿œç¨‹ä»“åº“åœ°å€ git remote show originæŸ¥çœ‹è¿œç¨‹ä»“åº“è¯¦æƒ…ä¿¡æ¯ ","date":"2024-02-02","objectID":"/posts/commandsheet/:6:0","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"æŸ¥çœ‹æŸä¸ª commit æäº¤å±äºå“ªä¸ªåˆ†æ”¯ git branch -l --contains \u003ccommit_id\u003e æœ¬åœ°åˆ†æ”¯ git branch -r --contains \u003ccommit_id\u003e è¿œç¨‹åˆ†æ”¯ git branch --all --contains \u003ccommit_id\u003e æ‰€æœ‰åˆ†æ”¯ ","date":"2024-02-02","objectID":"/posts/commandsheet/:7:0","tags":["Git"],"title":"Git å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandsheet/"},{"categories":["Git"],"content":"Gitæ ¸å¿ƒçŸ¥è¯†æ€»ç»“ Git æ€»è§ˆ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:0:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"1.ä»€ä¹ˆæ˜¯Git åœ¨äº†è§£Gitä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ç‰ˆæœ¬æ§åˆ¶è¿™ä¸ªæ¦‚å¿µã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:1:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"1.1 ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ ç‰ˆæœ¬æ§åˆ¶æ˜¯ä¸€ç§è®°å½•ä¸€ä¸ªæˆ–è‹¥å¹²æ–‡ä»¶å†…å®¹å˜åŒ–ï¼Œä»¥ä¾¿å°†æ¥æŸ¥é˜…ç‰¹å®šç‰ˆæœ¬ä¿®è®¢æƒ…å†µçš„ç³»ç»Ÿã€‚ é™¤äº†é¡¹ç›®æºä»£ç ï¼Œä½ å¯ä»¥å¯¹ä»»ä½•ç±»å‹çš„æ–‡ä»¶è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:1:1","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"1.2 ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬æ§åˆ¶ æœ‰äº†å®ƒä½ å°±å¯ä»¥å°†æŸä¸ªæ–‡ä»¶å›æº¯åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œç”šè‡³å°†æ•´ä¸ªé¡¹ç›®éƒ½å›é€€åˆ°è¿‡å»æŸä¸ªæ—¶é—´ç‚¹çš„çŠ¶æ€ï¼Œä½ å¯ä»¥æ¯”è¾ƒæ–‡ä»¶çš„å˜åŒ–ç»†èŠ‚ï¼ŒæŸ¥å‡ºæœ€åæ˜¯è°ä¿®æ”¹äº†å“ªä¸ªåœ°æ–¹ï¼Œä»è€Œæ‰¾å‡ºå¯¼è‡´é¡¹ç›®é—®é¢˜å‡ºç°çš„åŸå› ï¼Œåˆæ˜¯è°åœ¨ä½•æ—¶æŠ¥å‘Šäº†æŸä¸ªåŠŸèƒ½ç¼ºé™·ç­‰ç­‰ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:1:2","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"1.3 æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ è®¸å¤šäººä¹ æƒ¯ç”¨å¤åˆ¶æ•´ä¸ªé¡¹ç›®ç›®å½•çš„æ–¹å¼æ¥ä¿å­˜ä¸åŒçš„ç‰ˆæœ¬ï¼Œæˆ–è®¸è¿˜ä¼šæ”¹ååŠ ä¸Šå¤‡ä»½æ—¶é—´ä»¥ç¤ºåŒºåˆ«ã€‚ è¿™ä¹ˆåšå”¯ä¸€çš„å¥½å¤„å°±æ˜¯ç®€å•ï¼Œä½†æ˜¯ç‰¹åˆ«å®¹æ˜“çŠ¯é”™ã€‚ æœ‰æ—¶å€™ä¼šæ··æ·†æ‰€åœ¨çš„å·¥ä½œç›®å½•ï¼Œä¸€ä¸å°å¿ƒä¼šå†™é”™æ–‡ä»¶æˆ–è€…è¦†ç›–æ„æƒ³å¤–çš„æ–‡ä»¶ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œäººä»¬å¾ˆä¹…ä»¥å‰å°±å¼€å‘äº†è®¸å¤šç§æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¤§å¤šéƒ½æ˜¯é‡‡ç”¨æŸç§ç®€å•çš„æ•°æ®åº“æ¥è®°å½•æ–‡ä»¶çš„å†æ¬¡æ›´æ–°å·®å¼‚ã€‚ Gitæ˜¯å½“å‰æœ€å…ˆè¿›ã€æœ€ä¸»æµçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå…è´¹ã€å¼€æºï¼æ ¸å¿ƒèƒ½åŠ›å°±æ˜¯ç‰ˆæœ¬æ§åˆ¶ã€‚å†å…·ä½“ä¸€ç‚¹ï¼Œå°±æ˜¯é¢å‘ä»£ç æ–‡ä»¶çš„ç‰ˆæœ¬æ§åˆ¶ï¼Œä»£ç çš„ä»»ä½•ä¿®æ”¹å†å²éƒ½ä¼šè¢«è®°å½•ç®¡ç†èµ·æ¥ï¼Œæ„å‘³ç€å¯ä»¥æ¢å¤åˆ°åˆ°ä»¥å‰çš„ä»»æ„æ—¶åˆ»çŠ¶æ€ã€‚æ”¯æŒè·¨åŒºåŸŸå¤šäººåä½œç¼–è¾‘ï¼Œæ˜¯å›¢é˜Ÿé¡¹ç›®å¼€å‘çš„å¿…å¤‡åŸºç¡€ï¼Œæ‰€ä»¥Gitä¹Ÿå°±æˆäº†ç¨‹åºå‘˜çš„å¿…å¤‡æŠ€èƒ½ã€‚ æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:1:3","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"2.Gitçš„æ¥æº Gitæ˜¯ä¸€ç§åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå®ƒçš„è®¾è®¡å’Œå¼€å‘æœ€åˆç”±æ—çº³æ–¯Â·æ‰˜ç“¦å…¹ï¼ˆLinus Torvaldsï¼‰é¢†å¯¼ï¼Œä»–ä¹Ÿæ˜¯Linuxæ“ä½œç³»ç»Ÿçš„åˆ›å§‹äººã€‚Gitçš„å¼€å‘å§‹äº2005å¹´ï¼Œå…¶èƒŒæ™¯å’Œåˆå§‹ç›®çš„ä¸Linuxå¼€å‘ç¤¾åŒºçš„éœ€æ±‚å¯†åˆ‡ç›¸å…³ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:2:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"2.1 èƒŒæ™¯å’Œåˆå§‹åŠ¨æœº åœ¨Gitä¹‹å‰ï¼ŒLinuxå†…æ ¸çš„å¼€å‘ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªåä¸ºBitKeeperçš„å•†ä¸šç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚è¿™ä¸ªç³»ç»Ÿå¯¹Linuxç¤¾åŒºæ˜¯å…è´¹çš„ï¼Œä½†åœ¨2005å¹´ï¼Œç”±äºä¸€äº›äº‰è®®å’Œè®¸å¯é—®é¢˜ï¼ŒLinuxç¤¾åŒºå¤±å»äº†å¯¹BitKeeperçš„å…è´¹è®¸å¯ã€‚è¿™ä¿ƒä½¿æ‰˜ç“¦å…¹å¯»æ‰¾ä¸€ä¸ªæ–°çš„å·¥å…·æ¥ç®¡ç†Linuxå†…æ ¸çš„å¼€å‘ã€‚ æ‰˜ç“¦å…¹å¯¹ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæœ‰å‡ ä¸ªæ˜ç¡®çš„éœ€æ±‚å’Œç›®æ ‡ï¼š ã€Œæ€§èƒ½ã€ï¼šç”±äºLinuxå†…æ ¸çš„åºå¤§å’Œå¤æ‚æ€§ï¼Œæ€§èƒ½æˆä¸ºä¸€ä¸ªå…³é”®å› ç´ ã€‚Gitéœ€è¦é«˜æ•ˆåœ°å¤„ç†å¤§å‹é¡¹ç›®ã€‚ ã€Œåˆ†å¸ƒå¼æ¶æ„ã€ï¼šGitè¢«è®¾è®¡ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæ„å‘³ç€æ¯ä¸ªå¼€å‘è€…çš„è®¡ç®—æœºä¸Šéƒ½æœ‰æ•´ä¸ªä»£ç åº“çš„å®Œæ•´å†å²è®°å½•ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¯¹ä¸­å¤®æœåŠ¡å™¨çš„ä¾èµ–ã€‚ ã€Œæ•°æ®å®Œæ•´æ€§ã€ï¼šGitå¼ºè°ƒæ•°æ®çš„å®Œæ•´æ€§ã€‚å®ƒé€šè¿‡å¯¹æ–‡ä»¶å†…å®¹å’Œç›®å½•ç»“æ„ä½¿ç”¨SHA-1å“ˆå¸Œæ¥ç¡®ä¿ä»£ç å†å²ä¸è¢«ç¯¡æ”¹ã€‚ ã€Œç®€å•çš„åˆ†æ”¯å’Œåˆå¹¶ã€ï¼šåœ¨Linuxå¼€å‘ä¸­ï¼Œåˆ†æ”¯å’Œåˆå¹¶æ“ä½œéå¸¸é¢‘ç¹ã€‚Gitè¢«è®¾è®¡ä¸ºä½¿è¿™äº›æ“ä½œå°½å¯èƒ½ç®€å•å’Œé«˜æ•ˆã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:2:1","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"2.2 Gitçš„å‘å±• Gitæœ€åˆæ˜¯ä½œä¸ºä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·å‘å¸ƒçš„ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå›´ç»•Gitå¼€å‘äº†å¤§é‡çš„å›¾å½¢ç•Œé¢å·¥å…·å’Œå¢å¼ºåŠŸèƒ½ï¼Œä½¿å…¶æ›´åŠ ç”¨æˆ·å‹å¥½ã€‚Gitè¿…é€Ÿåœ¨å¼€æºç¤¾åŒºä¸­è·å¾—äº†å¹¿æ³›çš„æ¥å—ï¼Œå¹¶é€æ¸æˆä¸ºä¸–ç•Œä¸Šæœ€æµè¡Œçš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:2:2","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"2.3 GitHubå’ŒGitçš„æ™®åŠ Gitçš„æ™®åŠä¹Ÿä¸GitHubè¿™æ ·çš„å¹³å°ç´§å¯†ç›¸å…³ã€‚GitHubæ˜¯ä¸€ä¸ªåŸºäºWebçš„Gitç‰ˆæœ¬åº“æ‰˜ç®¡æœåŠ¡ï¼Œå®ƒæä¾›äº†å›¾å½¢ç•Œé¢ï¼Œå¹¶å¢åŠ äº†å¦‚åˆ†å‰ã€æ‹‰å–è¯·æ±‚å’Œç¤¾äº¤ç½‘ç»œåŠŸèƒ½ç­‰ç‰¹æ€§ï¼Œè¿™äº›éƒ½æå¤§åœ°ä¿ƒè¿›äº†Gitçš„æ™®åŠå’Œå¼€æºæ–‡åŒ–çš„å‘å±•ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:2:3","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"3.Gitçš„ç‰¹ç‚¹ å¼€æºå…è´¹ï¼Œä½¿ç”¨å¹¿æ³›ã€‚ å¼ºå¤§çš„æ–‡æ¡£ï¼ˆä»£ç ï¼‰çš„å†å²ç‰ˆæœ¬ç®¡ç†ï¼Œç›´æ¥è®°å½•å®Œæ•´å¿«ç…§ï¼ˆå®Œæ•´å†…å®¹ï¼Œè€Œéå·®å¼‚ï¼‰ï¼Œæ”¯æŒå›æ»šã€å¯¹æ¯”ã€‚ åˆ†å¸ƒå¼å¤šäººåä½œçš„çš„ä»£ç ååŒå¼€å‘ï¼Œå‡ ä¹æ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ¬åœ°æ‰§è¡Œçš„ï¼Œæ”¯æŒä»£ç åˆå¹¶ã€ä»£ç åŒæ­¥ã€‚ ç®€å•æ˜“ç”¨çš„åˆ†æ”¯ç®¡ç†ï¼Œæ”¯æŒé«˜æ•ˆçš„åˆ›å»ºåˆ†æ”¯ã€åˆå¹¶åˆ†æ”¯ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:3:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"4.Gitçš„åŸºæœ¬æ¦‚å¿µ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:4:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"4.1 æ¦‚å¿µæ±‡æ€» æ¦‚å¿µåç§° æè¿° å·¥ä½œåŒºï¼ˆWorkspaceï¼‰ å°±æ˜¯åœ¨ç”µè„‘é‡Œèƒ½çœ‹åˆ°çš„ä»£ç åº“ç›®å½•ï¼Œæ˜¯æˆ‘ä»¬æ¬ç –çš„åœ°æ–¹ï¼Œæ–°å¢ã€ä¿®æ”¹çš„æ–‡ä»¶ä¼šæäº¤åˆ°æš‚å­˜åŒº æš‚å­˜åŒºï¼ˆstage æˆ– indexï¼‰ ç”¨äºä¸´æ—¶å­˜æ”¾æ–‡ä»¶çš„ä¿®æ”¹ï¼Œå®é™…ä¸Šä¸Šå®ƒåªæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼ˆ.git/indexï¼‰ï¼Œä¿å­˜å¾…æäº¤çš„æ–‡ä»¶åˆ—è¡¨ä¿¡æ¯ã€‚ ç‰ˆæœ¬åº“/ä»“åº“ï¼ˆRepositoryï¼‰ Gitçš„ç®¡ç†ä»“åº“ï¼Œç®¡ç†ç‰ˆæœ¬çš„æ•°æ®åº“ï¼Œè®°å½•æ–‡ä»¶/ç›®å½•çŠ¶æ€çš„åœ°æ–¹ï¼Œæ‰€æœ‰å†…å®¹çš„ä¿®æ”¹è®°å½•ï¼ˆç‰ˆæœ¬ï¼‰éƒ½åœ¨è¿™é‡Œã€‚ æœåŠ¡ç«¯/è¿œç¨‹ä»“åº“ï¼ˆorigin æˆ– remoteï¼‰ æœåŠ¡ç«¯çš„ç‰ˆæœ¬åº“ï¼Œä¸“ç”¨çš„GitæœåŠ¡å™¨ï¼Œä¸ºå¤šäººå…±äº«æä¾›æœåŠ¡ï¼Œæ‰¿æ‹…ä¸­å¿ƒæœåŠ¡å™¨çš„è§’è‰²ã€‚æœ¬åœ°ç‰ˆæœ¬åº“é€šè¿‡pushæŒ‡ä»¤æŠŠä»£ç æ¨é€åˆ°æœåŠ¡ç«¯ç‰ˆæœ¬åº“ã€‚ æœ¬åœ°ä»“åº“ ç”¨æˆ·æœºå™¨ä¸Šç›´æ¥ä½¿ç”¨çš„ç‰ˆæœ¬åº“ åˆ†æ”¯ï¼ˆBranchï¼‰ åˆ†æ”¯æ˜¯ä»ä¸»çº¿åˆ†ç¦»å‡ºå»çš„â€œå‰¯æœ¬â€ï¼Œå¯ä»¥ç‹¬ç«‹æ“ä½œè€Œäº’ä¸å¹²æ‰°ï¼Œä»“åº“åˆå§‹åŒ–å°±æœ‰ä¸€ä¸ªé»˜è®¤ä¸»åˆ†æ”¯masterã€‚ å¤´ï¼ˆHEADï¼‰ HEADç±»ä¼¼ä¸€ä¸ªâ€œæŒ‡é’ˆâ€ï¼ŒæŒ‡å‘å½“å‰æ´»åŠ¨åˆ†æ”¯çš„æœ€æ–°ç‰ˆæœ¬ã€‚ æäº¤ï¼ˆCommitï¼‰ æŠŠæš‚å­˜åŒºçš„æ‰€æœ‰å˜æ›´çš„å†…å®¹æäº¤åˆ°å½“å‰ä»“åº“çš„æ´»åŠ¨åˆ†æ”¯ã€‚ æ¨é€ï¼ˆPushï¼‰ å°†æœ¬åœ°ä»“åº“çš„ç‰ˆæœ¬æ¨é€åˆ°æœåŠ¡ç«¯ï¼ˆè¿œç¨‹ï¼‰ä»“åº“ï¼Œä¸ä»–äººå…±äº«ã€‚ æ‹‰å–ï¼ˆPullï¼‰ ä»æœåŠ¡ç«¯ï¼ˆè¿œç¨‹ï¼‰ä»“åº“è·å–æ›´æ–°åˆ°æœ¬åœ°ä»“åº“ï¼Œè·å–ä»–äººå…±äº«çš„æ›´æ–°ã€‚ è·å–ï¼ˆFetchï¼‰ ä»æœåŠ¡ç«¯ï¼ˆè¿œç¨‹ï¼‰ä»“åº“æ›´æ–°ï¼Œä½œç”¨åŒæ‹‰å–ï¼ˆPullï¼‰ï¼ŒåŒºåˆ«æ˜¯ä¸ä¼šè‡ªåŠ¨åˆå¹¶ã€‚ å†²çªï¼ˆConflictï¼‰ å¤šäººå¯¹åŒä¸€æ–‡ä»¶çš„å·¥ä½œå‰¯æœ¬è¿›è¡Œæ›´æ”¹ï¼Œå¹¶å°†è¿™äº›æ›´æ”¹åˆå¹¶åˆ°ä»“åº“æ—¶å°±ä¼šé¢ä¸´å†²çªï¼Œéœ€è¦äººå·¥åˆå¹¶å¤„ç†ã€‚ åˆå¹¶ï¼ˆMergeï¼‰ å¯¹æœ‰å†²çªçš„æ–‡ä»¶è¿›è¡Œåˆå¹¶æ“ä½œï¼ŒGitä¼šè‡ªåŠ¨åˆå¹¶å˜æ›´å†…å®¹ï¼Œæ— æ³•è‡ªåŠ¨å¤„ç†çš„å†²çªå†…å®¹ä¼šæç¤ºäººå·¥å¤„ç†ã€‚ æ ‡ç­¾ï¼ˆTagsï¼‰ æ ‡ç­¾æŒ‡çš„æ˜¯æŸä¸ªåˆ†æ”¯æŸä¸ªç‰¹å®šæ—¶é—´ç‚¹çš„çŠ¶æ€ï¼Œå¯ä»¥ç†è§£ä¸ºæäº¤è®°å½•çš„åˆ«åï¼Œå¸¸ç”¨æ¥æ ‡è®°ç‰ˆæœ¬ã€‚ masterï¼ˆæˆ–mainï¼‰ ä»“åº“çš„â€œmasterâ€åˆ†æ”¯ï¼Œé»˜è®¤çš„ä¸»åˆ†æ”¯ï¼Œåˆå§‹åŒ–ä»“åº“å°±æœ‰äº†ã€‚Githubä¸Šåˆ›å»ºçš„ä»“åº“é»˜è®¤åå­—ä¸ºâ€œmainâ€ origin/master è¡¨ç¤ºè¿œç¨‹ä»“åº“ï¼ˆoriginï¼‰çš„â€œmasterâ€åˆ†æ”¯ origin/HEAD è¡¨ç¤ºè¿œç¨‹ä»“åº“ï¼ˆoriginï¼‰çš„æœ€æ–°æäº¤çš„ä½ç½®ï¼Œä¸€èˆ¬æƒ…å†µç­‰äºâ€œorigin/masterâ€ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:4:1","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"4.2 å·¥ä½œåŒº/æš‚å­˜åŒº/ä»“åº“ å·¥ä½œåŒºï¼ˆWorkspaceï¼‰å°±æ˜¯åœ¨ç”µè„‘é‡Œèƒ½çœ‹åˆ°çš„ä»£ç åº“ç›®å½•ï¼Œæ˜¯æˆ‘ä»¬æ¬ç –çš„åœ°æ–¹ï¼Œæ–°å¢ã€ä¿®æ”¹çš„æ–‡ä»¶ä¼šæäº¤åˆ°æš‚å­˜åŒºã€‚ åœ¨è¿™é‡Œæ–°å¢æ–‡ä»¶ã€ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼Œæˆ–åˆ é™¤æ–‡ä»¶ã€‚ æš‚å­˜åŒºï¼ˆstageæˆ–indexï¼‰ç”¨äºä¸´æ—¶å­˜æ”¾æ–‡ä»¶çš„ä¿®æ”¹ï¼Œå®é™…ä¸Šä¸Šå®ƒåªæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼ˆ.git/indexï¼‰ï¼Œä¿å­˜å¾…æäº¤çš„æ–‡ä»¶åˆ—è¡¨ä¿¡æ¯ã€‚ ç”¨git add å‘½ä»¤å°†å·¥ä½œåŒºçš„ä¿®æ”¹ä¿å­˜åˆ°æš‚å­˜åŒºã€‚ ç‰ˆæœ¬åº“/ä»“åº“ï¼ˆRepositoryä»“åº“ï¼‰Gitçš„ç®¡ç†ä»“åº“ï¼Œç®¡ç†ç‰ˆæœ¬çš„æ•°æ®åº“ï¼Œè®°å½•æ–‡ä»¶/ç›®å½•çŠ¶æ€çš„åœ°æ–¹ï¼Œæ‰€æœ‰å†…å®¹çš„ä¿®æ”¹è®°å½•ï¼ˆç‰ˆæœ¬ï¼‰éƒ½åœ¨è¿™é‡Œã€‚å°±æ˜¯å·¥ä½œåŒºç›®å½•ä¸‹çš„éšè—æ–‡ä»¶å¤¹.gitï¼ŒåŒ…å«æš‚å­˜åŒºã€åˆ†æ”¯ã€å†å²è®°å½•ç­‰ä¿¡æ¯ã€‚ ç”¨git commit å‘½ä»¤å°†æš‚å­˜åŒºçš„å†…å®¹æ­£å¼æäº¤åˆ°ç‰ˆæœ¬åº“ã€‚ master ä¸ºä»“åº“çš„é»˜è®¤åˆ†æ”¯masterï¼ŒHEADæ˜¯ä¸€ä¸ªâ€œæŒ‡é’ˆâ€æŒ‡å‘å½“å‰åˆ†æ”¯çš„æœ€æ–°æäº¤ï¼Œé»˜è®¤æŒ‡å‘æœ€æ–°çš„masterã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:4:2","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"4.3 Gitçš„åŸºæœ¬æµç¨‹ Gitçš„å·¥ä½œæµç¨‹æ ¸å¿ƒå°±ä¸‹é¢å‡ ä¸ªæ­¥éª¤ã€‚ å‡†å¤‡ä»“åº“ï¼šåˆ›å»ºæˆ–ä»æœåŠ¡ç«¯å…‹éš†ä¸€ä¸ªä»“åº“ã€‚ ç¼–å†™ä»£ç ï¼šåœ¨å·¥ä½œç›®å½•ä¸­æ·»åŠ ã€ä¿®æ”¹ä»£ç ã€‚ æš‚å­˜ï¼ˆgit addï¼‰ï¼šå°†éœ€è¦è¿›è¡Œç‰ˆæœ¬ç®¡ç†çš„æ–‡ä»¶æ”¾å…¥æš‚å­˜åŒºåŸŸã€‚ æäº¤ï¼ˆgit commitï¼‰ï¼šå°†æš‚å­˜åŒºåŸŸçš„æ–‡ä»¶æäº¤åˆ°Gitä»“åº“ã€‚ æ¨é€ï¼ˆgit pushï¼‰ï¼šå°†æœ¬åœ°ä»“åº“æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼ŒåŒæ­¥ç‰ˆæœ¬åº“ã€‚ è·å–æ›´æ–°ï¼ˆfetch/pullï¼‰ï¼šä»æœåŠ¡ç«¯æ›´æ–°åˆ°æœ¬åœ°ï¼Œè·å–ä»–äººæ¨é€çš„æ›´æ–°ï¼Œä¸ä»–äººåä½œã€å…±äº«ã€‚ Git å·¥ä½œ æµç¨‹ git commit -a æŒ‡ä»¤çœç•¥äº†addåˆ°æš‚å­˜åŒºçš„æ­¥éª¤ï¼Œç›´æ¥æäº¤å·¥ä½œåŒºçš„ä¿®æ”¹å†…å®¹åˆ°ç‰ˆæœ¬åº“ï¼Œä¸åŒ…æ‹¬æ–°å¢çš„æ–‡ä»¶ã€‚ git fetchã€git pull éƒ½æ˜¯ä»è¿œç¨‹æœåŠ¡ç«¯è·å–æœ€æ–°è®°å½•ï¼ŒåŒºåˆ«æ˜¯git pullå¤šäº†ä¸€ä¸ªæ­¥éª¤ï¼Œå°±æ˜¯è‡ªåŠ¨åˆå¹¶æ›´æ–°å·¥ä½œåŒºã€‚ git checkout . ã€git checkout [file] ä¼šæ¸…é™¤å·¥ä½œåŒºä¸­æœªæ·»åŠ åˆ°æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œç”¨æš‚å­˜åŒºå†…å®¹æ›¿æ¢å·¥ä½œåŒºã€‚ git checkout HEAD .ã€ git checkout HEAD [file] ä¼šæ¸…é™¤å·¥ä½œåŒºã€æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œç”¨HEADæŒ‡å‘çš„å½“å‰åˆ†æ”¯æœ€æ–°ç‰ˆæœ¬æ›¿æ¢æš‚å­˜åŒºã€å·¥ä½œåŒºã€‚ git diff ç”¨æ¥å¯¹æ¯”ä¸åŒéƒ¨åˆ†ä¹‹é—´çš„åŒºåˆ«ï¼Œå¦‚æš‚å­˜åŒºã€å·¥ä½œåŒºï¼Œæœ€æ–°ç‰ˆæœ¬ä¸æœªæäº¤å†…å®¹ï¼Œä¸åŒç‰ˆæœ¬ä¹‹é—´ç­‰ã€‚ git reset æ˜¯ä¸“é—¨ç”¨æ¥æ’¤é”€ä¿®æ”¹ã€å›é€€ç‰ˆæœ¬çš„æŒ‡ä»¤ï¼Œæ›¿ä»£ä¸Šé¢checkoutçš„æ’¤é”€åŠŸèƒ½ã€‚ ã€ŒåŸºæœ¬çš„ Git å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼šã€ åœ¨å·¥ä½œç›®å½•ä¸­ä¿®æ”¹æ–‡ä»¶ã€‚ æš‚å­˜æ–‡ä»¶ï¼Œå°†æ–‡ä»¶çš„å¿«ç…§æ”¾å…¥æš‚å­˜åŒºåŸŸã€‚ æäº¤æ›´æ–°ï¼Œæ‰¾åˆ°æš‚å­˜åŒºåŸŸçš„æ–‡ä»¶ï¼Œå°†å¿«ç…§æ°¸ä¹…æ€§å­˜å‚¨åˆ° Git ä»“åº“ç›®å½•ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:4:3","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"4.4 Gitçš„çŠ¶æ€ Gitåœ¨æ‰§è¡Œæäº¤çš„æ—¶å€™ï¼Œä¸æ˜¯ç›´æ¥å°†å·¥ä½œåŒºçš„ä¿®æ”¹ä¿å­˜åˆ°ä»“åº“ï¼Œè€Œæ˜¯å°†æš‚å­˜åŒºåŸŸçš„ä¿®æ”¹ä¿å­˜åˆ°ä»“åº“ã€‚è¦æäº¤æ–‡ä»¶ï¼Œé¦–å…ˆéœ€è¦æŠŠæ–‡ä»¶åŠ å…¥åˆ°æš‚å­˜åŒºåŸŸä¸­ã€‚å› æ­¤ï¼ŒGitç®¡ç†çš„æ–‡ä»¶æœ‰ä¸‰ï¼ˆ+2ï¼‰ç§çŠ¶æ€ï¼š ã€Œæœªè·Ÿè¸ª(untracked)ï¼šã€ æ–°æ·»åŠ çš„æ–‡ä»¶ï¼Œæˆ–è¢«ç§»é™¤è·Ÿè¸ªçš„æ–‡ä»¶ï¼Œæœªå»ºç«‹è·Ÿè¸ªï¼Œé€šè¿‡git addæ·»åŠ æš‚å­˜å¹¶å»ºç«‹è·Ÿè¸ªã€‚ ã€Œæœªä¿®æ”¹ï¼šã€ ä»ä»“åº“ç­¾å‡ºçš„æ–‡ä»¶é»˜è®¤çŠ¶æ€ï¼Œä¿®æ”¹åå°±æ˜¯â€œå·²ä¿®æ”¹â€çŠ¶æ€äº†ã€‚ ã€Œå·²ä¿®æ”¹(modified)ï¼šã€ æ–‡ä»¶è¢«ä¿®æ”¹åçš„çŠ¶æ€ã€‚ ã€Œå·²æš‚å­˜(staged)ï¼šã€ ä¿®æ”¹ã€æ–°å¢çš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºåçš„çŠ¶æ€ã€‚ ã€Œå·²æäº¤(committed)ï¼šã€ ä»æš‚å­˜åŒºæäº¤åˆ°ç‰ˆæœ¬åº“ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:4:4","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"5.Gitçš„å®‰è£… Gitå®˜ç½‘ï¼šhttps://www.git-scm.com/ ä¸‹è½½å®‰è£…åŒ…è¿›è¡Œå®‰è£…ã€‚Gitçš„ä½¿ç”¨æœ‰ä¸¤ç§æ–¹å¼ï¼š ã€Œå‘½ä»¤è¡Œã€ï¼šGitçš„å‘½ä»¤é€šè¿‡ç³»ç»Ÿå‘½ä»¤è¡Œå·¥å…·ï¼Œæˆ–Gitæä¾›çš„å‘½ä»¤è¡Œå·¥å…·è¿è¡Œï¼ˆC:\\Program Files\\Git\\git-bash.exeï¼‰ ã€ŒGUIå·¥å…·ã€ï¼šWindows(GUI)ã€Mac(GUI)å·¥å…·ï¼Œéœ€å•ç‹¬å®‰è£…ï¼Œä½¿ç”¨æ›´ç®€å•ã€æ›´æ˜“ä¸Šæ‰‹ã€‚ ã€Œä¸‹ä¸€æ­¥å‚»ç“œå¼å®‰è£…å³å¯ã€‚ã€ æŒ‡ä»¤git --versionæŸ¥çœ‹å®‰è£…ç‰ˆæœ¬å· $ git --version git version 2.39.2.windows.1 ","date":"2024-02-02","objectID":"/posts/gitnotes2/:5:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"6.Gitå¿«é€Ÿå…¥é—¨ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:6:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"6.1 åˆ›å»ºä»“åº“ åˆ›å»ºä»“åº“çš„æ–¹å¼æœ‰ä¸¤ç§ã€‚ ä¸€ç§æ˜¯åˆ›å»ºå…¨æ–°çš„ä»“åº“ï¼ŒåŸºäºgit initå‘½ä»¤æ¥ï¼Œä¼šåœ¨å½“å‰ç›®å½•åˆå§‹åŒ–åˆ›å»ºä»“åº“ã€‚ ä¸€ç§æ˜¯é€šè¿‡git clone + ä»“åº“åœ°å€çš„æ–¹å¼ï¼Œä¸€èˆ¬å«åšå…‹éš†è¿œç¨‹ä»“åº“ã€‚ é¦–å…ˆå‡†å¤‡ä¸€ä¸ªæœ¬åœ°çš„å·¥ä½œç›®å½•ï¼šGitRepo æ–°å»ºæœ¬åœ°ä»“åº“ ç„¶ågitbashæ‰“å¼€ï¼Œåˆå§‹åŒ–ä¸ºgitä»“åº“ã€‚ $ git init Initialized empty Git repository in D:/IDEA Workplace/GitRepo/.git/ åˆ›å»ºå®Œå¤šå‡ºäº†ä¸€ä¸ªè¢«éšè—çš„.gitç›®å½•ï¼Œè¿™å°±æ˜¯æœ¬åœ°ä»“åº“Gitçš„å·¥ä½œç›®å½•ã€‚ ç”Ÿæˆ.gitæ–‡ä»¶å¤¹ å…‹éš†è¿œç¨‹ä»“åº“ï¼Œå¦‚åœ¨giteeä¸Šåˆ›å»ºçš„ä»“åº“ https://gitee.com/gaoziman/vue3-doc.git é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå…‹éš†ï¼š git clone https://gitee.com/gaoziman/vue3-doc.git æ‹‰å–è¿œç¨‹ä»£ç  å¯ä»¥çœ‹åˆ°è¿œç¨‹ä»“åº“å°±å‡ºç°åœ¨æˆ‘ä»¬çš„æœ¬åœ°å·¥ä½œç©ºé—´ è¿œç¨‹ä»£ç å‡ºç°åœ¨æœ¬åœ°ä»“åº“ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:6:1","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"6.2 æš‚å­˜åŒºadd git addå‘½ä»¤å°±æ˜¯æŠŠè¦æäº¤çš„æ‰€æœ‰ä¿®æ”¹æ”¾åˆ° ã€Œæš‚å­˜åŒºï¼ˆStageï¼‰ã€ï¼Œç„¶åï¼Œæ‰§è¡Œgit commitå°±å¯ä»¥ä¸€æ¬¡æ€§æŠŠæš‚å­˜åŒºçš„æ‰€æœ‰ä¿®æ”¹æäº¤åˆ°ä»“åº“ã€‚ ã€ŒæŒ‡ä»¤ã€ ã€Œæè¿°ã€ git add [file1] [file2] æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒºï¼ŒåŒ…æ‹¬ä¿®æ”¹çš„æ–‡ä»¶ã€æ–°å¢çš„æ–‡ä»¶ git add [dir] åŒä¸Šï¼Œæ·»åŠ ç›®å½•åˆ°æš‚å­˜åŒºï¼ŒåŒ…æ‹¬å­ç›®å½• git add . åŒä¸Šï¼Œæ·»åŠ **ã€Œæ‰€æœ‰ã€**ä¿®æ”¹ã€æ–°å¢æ–‡ä»¶ï¼ˆæœªè·Ÿè¸ªï¼‰åˆ°æš‚å­˜åŒº git rm [file] åˆ é™¤å·¥ä½œåŒºæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™æ¬¡åˆ é™¤æ”¾å…¥æš‚å­˜åŒº # æŸ¥çœ‹ä»“åº“çŠ¶æ€ $ git status On branch master Your branch is up to date with 'origin/master'. Changes not staged for commit: (use \"git add \u003cfile\u003e...\" to update what will be committed) (use \"git restore \u003cfile\u003e...\" to discard changes in working directory) modified: Nodejs.md no changes added to commit (use \"git add\" and/or \"git commit -a\") Administrator@WIN-20231112VVY MINGW64 /d/IDEA Workplace/GitRepo/vue3-doc/01-ç¯å¢ƒ (master) # æ·»åŠ åˆ°æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº $ git add Nodejs.md Administrator@WIN-20231112VVY MINGW64 /d/IDEA Workplace/GitRepo/vue3-doc/01-ç¯å¢ƒ (master) # ç»§ç»­æŸ¥çœ‹ä»“åº“çŠ¶æ€ $ git status On branch master Your branch is up to date with 'origin/master'. Changes to be committed: (use \"git restore --staged \u003cfile\u003e...\" to unstage) modified: Nodejs.md ä¿®æ”¹ä¹‹åé€šè¿‡ git add æ–‡ä»¶å å³å¯æŠŠæ–‡ä»¶æäº¤è‡³æš‚å­˜åŒº æŠŠæ–‡ä»¶æäº¤è‡³æš‚å­˜åŒº ","date":"2024-02-02","objectID":"/posts/gitnotes2/:6:2","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"6.3 commitæäº¤ git commitæäº¤æ˜¯ä»¥æ—¶é—´é¡ºåºæ’åˆ—è¢«ä¿å­˜åˆ°æ•°æ®åº“ä¸­çš„ï¼Œå°±å¦‚æ¸¸æˆå…³å¡ä¸€æ ·ï¼Œæ¯ä¸€æ¬¡æäº¤ï¼ˆcommitï¼‰å°±ä¼šäº§ç”Ÿä¸€æ¡è®°å½•ï¼šid + æè¿° + å¿«ç…§å†…å®¹ã€‚ ã€Œcommit idã€ï¼šæ ¹æ®ä¿®æ”¹çš„æ–‡ä»¶å†…å®¹é‡‡ç”¨æ‘˜è¦ç®—æ³•ï¼ˆSHA1ï¼‰è®¡ç®—å‡ºä¸é‡å¤çš„40ä½å­—ç¬¦ï¼Œè¿™ä¹ˆé•¿æ˜¯å› ä¸ºGitæ˜¯åˆ†å¸ƒå¼çš„ï¼Œè¦ä¿è¯å”¯ä¸€æ€§ã€å®Œæ•´æ€§ï¼Œä¸€èˆ¬æœ¬åœ°æŒ‡ä»¤ä¸­å¯ä»¥åªç”¨å‰å‡ ä½ï¼ˆ6ï¼‰ã€‚å³ä½¿å¤šå¹´ä»¥åï¼Œä¾ç„¶å¯é€šè¿‡idæ‰¾åˆ°æ›¾ç»çš„ä»»ä½•å†…å®¹å’Œå˜åŠ¨ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒä¸¢å¤±äº†ã€‚ ã€Œæè¿°ã€ï¼šé’ˆå¯¹æœ¬æ¬¡æäº¤çš„æè¿°è¯´æ˜ï¼Œå»ºè®®**ã€Œå‡†ç¡®ã€**å¡«å†™ï¼Œå°±è·Ÿä»£ç ä¸­çš„æ³¨é‡Šä¸€æ ·ï¼Œå¾ˆé‡è¦ã€‚ ã€Œå¿«ç…§ã€ï¼šå°±æ˜¯å®Œæ•´çš„ç‰ˆæœ¬æ–‡ä»¶ï¼Œä»¥å¯¹è±¡æ ‘çš„ç»“æ„å­˜åœ¨ä»“åº“ä¸‹\\.git\\objectsç›®å½•é‡Œï¼Œè¿™ä¹Ÿæ˜¯Gitæ•ˆç‡é«˜çš„ç§˜è¯€ä¹‹ä¸€ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ git reflog æŸ¥çœ‹æ‰€æœ‰çš„æäº¤è®°å½•åŒ…æ‹¬å›é€€è®°å½•ã€‚ æŸ¥çœ‹å›é€€è®°å½• æˆ‘ä»¬å¯ä»¥é€šè¿‡æäº¤æ‰€æœ‰çš„æŒ‡ä»¤åˆ°ä»“åº“ã€‚ git commit -a -m'ä¿®æ”¹READMEçš„ç‰ˆæƒä¿¡æ¯' æœ‰æ—¶å€™æˆ‘ä»¬æäº¤å®Œäº†æ‰å‘ç°æ¼æ‰äº†å‡ ä¸ªæ–‡ä»¶æ²¡æœ‰æ·»åŠ ï¼Œæˆ–è€…æäº¤ä¿¡æ¯å†™é”™äº†ã€‚ æ­¤æ—¶ï¼Œå¯ä»¥è¿è¡Œå¸¦æœ‰ --amend é€‰é¡¹çš„æäº¤å‘½ä»¤å°è¯•é‡æ–°æäº¤ï¼š å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡commitçš„æäº¤ä¿¡æ¯ $ git commit --amend -m [message] å–æ¶ˆæš‚å­˜çš„æ–‡ä»¶ git reset filename æ’¤æ¶ˆå¯¹æ–‡ä»¶çš„ä¿®æ”¹: git checkout -- filename ç”¨å‚æ•° --oneline å¯ä»¥è®©æ—¥å¿—è¾“å‡ºæ›´ç®€æ´ï¼ˆä¸€è¡Œï¼‰ git log --oneline è¾“å‡º ã€ŒğŸ”¥æŒ‡ä»¤ï¼šã€ ã€ŒæŒ‡ä»¤ã€ ã€Œæè¿°ã€ git commit -m â€˜è¯´æ˜â€™ æäº¤å˜æ›´ï¼Œå‚æ•°-mè®¾ç½®æäº¤çš„æè¿°ä¿¡æ¯ï¼Œåº”è¯¥æ­£ç¡®æäº¤ï¼Œä¸å¸¦è¯¥å‚æ•°ä¼šè¿›å…¥è¯´æ˜ç¼–è¾‘æ¨¡å¼ git commit -a å‚æ•°-aï¼Œè¡¨ç¤ºç›´æ¥ä»å·¥ä½œåŒºæäº¤åˆ°ç‰ˆæœ¬åº“ï¼Œç•¥è¿‡äº†git addæ­¥éª¤ï¼Œä¸åŒ…æ‹¬æ–°å¢çš„æ–‡ä»¶ git commit [file] æäº¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°ä»“åº“åŒº git commit â€“amend -m ä½¿ç”¨ä¸€æ¬¡æ–°çš„commitï¼Œæ›¿ä»£ä¸Šä¸€æ¬¡æäº¤ï¼Œä¼šä¿®æ”¹commitçš„hashå€¼ï¼ˆidï¼‰ git log -n20 æŸ¥çœ‹æ—¥å¿—(æœ€è¿‘20æ¡)ï¼Œä¸å¸¦å‚æ•°-nåˆ™æ˜¾ç¤ºæ‰€æœ‰æ—¥å¿— git log -n20 â€“oneline å‚æ•°â€œ--onelineâ€å¯ä»¥è®©æ—¥å¿—è¾“å‡ºæ›´ç®€æ´ï¼ˆä¸€è¡Œï¼‰ git log -n20 â€“graph å‚æ•°â€œ--graphâ€å¯è§†åŒ–æ˜¾ç¤ºåˆ†æ”¯å…³ç³» git log â€“follow [file] æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬å†å² git blame [file] ä»¥åˆ—è¡¨å½¢å¼æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„ä¿®æ”¹è®°å½• git ã€Œreflogã€ æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„å†å²ç‰ˆæœ¬è®°å½•ï¼ˆå®é™…æ˜¯HEADå˜æ›´è®°å½•ï¼‰ï¼ŒåŒ…å«è¢«å›é€€çš„è®°å½•ï¼ˆã€Œé‡è¦ã€ï¼‰ git status æŸ¥çœ‹æœ¬åœ°ä»“åº“çŠ¶æ€ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æŒ‡ä»¤ï¼ŒåŠ å‚æ•°-sç®€æ´æ¨¡å¼ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:6:3","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"6.4 æäº¤çš„å”¯ä¸€æ ‡è¯†ID æ¯ä¸€ä¸ªæäº¤éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œä¸»è¦å°±æ˜¯æäº¤çš„hashå€¼commit idï¼Œåœ¨å¾ˆå¤šæŒ‡ä»¤ä¸­ä¼šç”¨åˆ°ï¼Œå¦‚ç‰ˆæœ¬å›é€€ã€æ‹£é€‰æäº¤ç­‰ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªæäº¤ã€‚é‚£æ ‡è¯†å”¯ä¸€æäº¤æœ‰ä¸¤ç§æ–¹å¼ï¼š é¦–å…ˆå°±æ˜¯commit idï¼Œä¸€ä¸ª40ä½ç¼–ç ï¼ŒæŒ‡ä»¤ä¸­ä½¿ç”¨çš„æ—¶å€™å¯ä»¥åªè¾“å…¥å‰å‡ ä½ï¼ˆ6ä½ï¼‰å³å¯ã€‚ è¿˜æœ‰ä¸€ç§å°±æ˜¯HEAD~nï¼Œæ˜¯åŸºäºå½“å‰HEADä½ç½®çš„ä¸€ä¸ªç›¸å¯¹åæ ‡ã€‚ HEAD è¡¨ç¤ºå½“å‰åˆ†æ”¯çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„å‚æ•°ã€‚ HEAD^ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼ŒHEAD^^ ä¸Šä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚ HEAD~ æˆ–HEAD~1 è¡¨ç¤ºä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œä»¥æ­¤ç±»æ¨ï¼ŒHEAD^10 ä¸ºæœ€è¿‘ç¬¬10ä¸ªç‰ˆæœ¬ã€‚ HEAD@{2}åœ¨git reflogæ—¥å¿—ä¸­æ ‡è®°çš„æäº¤è®°å½•ç´¢å¼•ã€‚ é€šè¿‡git logã€git reflogå¯ä»¥æŸ¥çœ‹å†å²æ—¥å¿—ï¼Œå¯ä»¥çœ‹æ¯æ¬¡æäº¤çš„å”¯ä¸€ç¼–å·ï¼ˆhashï¼‰ã€‚åŒºåˆ«æ˜¯git reflogå¯ä»¥æŸ¥çœ‹æ‰€æœ‰æ“ä½œçš„è®°å½•ï¼ˆå®é™…æ˜¯HEADå˜æ›´è®°å½•ï¼‰ï¼ŒåŒ…æ‹¬è¢«æ’¤é”€å›é€€çš„æäº¤è®°å½•ã€‚ $ git reflog -n10 5acc914 (HEAD -\u003e main) HEAD@{0}: reset: moving to HEAD~ 738748b (dev) HEAD@{1}: reset: moving to HEAD~ 9312c3e HEAD@{2}: reset: moving to HEAD~ db03fcb HEAD@{3}: reset: moving to HEAD~ 1b81fb3 HEAD@{4}: reset: moving to HEAD~ 41ea423 HEAD@{5}: reset: moving to HEAD~ d3e15f9 HEAD@{6}: reset: moving to d3e15f9 1b81fb3 HEAD@{7}: reset: moving to HEAD~1 41ea423 HEAD@{8}: reset: moving to HEAD~ d3e15f9 HEAD@{9}: reset: moving to HEAD~ æŸ¥çœ‹å˜æ›´è®°å½• ","date":"2024-02-02","objectID":"/posts/gitnotes2/:6:4","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"6.5 diffæ¯”è¾ƒ git diffç”¨æ¥æ¯”è¾ƒä¸åŒæ–‡ä»¶ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚ã€‚ ã€ŒæŒ‡ä»¤ã€ ã€Œæè¿°ã€ ã€Œgit diffã€ æŸ¥çœ‹æš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚ git diff [file] åŒä¸Šï¼ŒæŒ‡å®šæ–‡ä»¶ git diff â€“cached æŸ¥çœ‹å·²æš‚å­˜çš„æ”¹åŠ¨ï¼Œå°±æ˜¯æš‚å­˜åŒºä¸æ–°ç‰ˆæœ¬HEADè¿›è¡Œæ¯”è¾ƒ git diff â€“staged åŒä¸Š git diff â€“cached [file] åŒä¸Šï¼ŒæŒ‡å®šæ–‡ä»¶ git diff HEAD æŸ¥çœ‹å·²æš‚å­˜çš„+æœªæš‚å­˜çš„æ‰€æœ‰æ”¹åŠ¨ï¼Œå°±æ˜¯ä¸æœ€æ–°ç‰ˆæœ¬HEADè¿›è¡Œæ¯”è¾ƒ git diff HEAD~ åŒä¸Šï¼Œä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬æ¯”è¾ƒã€‚HEAD~è¡¨ç¤ºä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼ŒHEAD~10ä¸ºæœ€è¿‘ç¬¬10ä¸ªç‰ˆæœ¬ git diff [id] [id] æŸ¥çœ‹ä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚ git diff [branch] æŸ¥çœ‹å·¥ä½œåŒºå’Œåˆ†æ”¯ç›´æ¥çš„å·®å¼‚ # æŸ¥çœ‹æ–‡ä»¶çš„ä¿®æ”¹ $ git diff README.md # æŸ¥çœ‹ä¸¤æ¬¡æäº¤çš„å·®å¼‚ $ git diff 8f4244 1da22 # æ˜¾ç¤ºä»Šå¤©ä½ å†™äº†å¤šå°‘è¡Œä»£ç ï¼šå·¥ä½œåŒº+æš‚å­˜åŒº $ git diff --shortstat \"@{10 day ago}\" ","date":"2024-02-02","objectID":"/posts/gitnotes2/:6:5","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"7.è¿œç¨‹ä»“åº“ Gitä½œä¸ºåˆ†å¸ƒå¼çš„ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿï¼Œæˆ‘ä»¬æ¯ä¸ªæœ¬åœ°ç»ˆç«¯éƒ½æœ‰å±äºè‡ªå·±çš„Gitä»“åº“ã€‚ä½†å›¢é˜Ÿåä½œè¿˜éœ€ä¸€ä¸ªä¸­é—´ä»“åº“ï¼Œä½œä¸ºæ§åˆ¶ä¸­å¿ƒï¼ŒåŒæ­¥å„ä¸ªä»“åº“ã€‚äºæ˜¯æœåŠ¡ç«¯ï¼ˆè¿œç¨‹ï¼‰ä»“åº“å°±æ¥æ‰¿æ‹…è¿™ä¸ªèŒè´£ï¼ŒæœåŠ¡ç«¯ä¸ä»…æœ‰ä»“åº“ï¼Œè¿˜é…å¥—ç›¸å…³ç®¡ç†åŠŸèƒ½ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ ã€Œè¿œç¨‹ä»“åº“ã€ ã€‚ è¿œç¨‹ä»“åº“ è¿œç¨‹ä»“åº“æœ‰å¥½å‡ ç§ï¼Œå¤§è‡´åˆ†ä¸ºä¸‹é¢å‡ ç§ã€‚ å…¬å…±GitæœåŠ¡å™¨ï¼Œå¦‚Githubã€ç äº‘Giteeã€è…¾è®¯Codingç­‰ã€‚ æ­å»ºç§æœ‰GitæœåŠ¡å™¨ï¼Œå¦‚å¼€æºçš„Gitlabã€Giteaã€ç­‰ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:7:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"7.1 è¿œç¨‹ä»“åº“æŒ‡ä»¤ ã€ŒæŒ‡ä»¤ã€ ã€Œæè¿°ã€ git clone [gitåœ°å€] ä»è¿œç¨‹ä»“åº“å…‹éš†åˆ°æœ¬åœ°ï¼ˆå½“å‰ç›®å½•ï¼‰ git remote -v æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹ä»“åº“ï¼Œä¸å¸¦å‚æ•°-våªæ˜¾ç¤ºåç§° git remote show [remote] æ˜¾ç¤ºæŸä¸ªè¿œç¨‹ä»“åº“çš„ä¿¡æ¯ git remote add [name] [url] å¢åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ï¼Œå¹¶å‘½å git remote rename [old] [new] ä¿®æ”¹è¿œç¨‹ä»“åº“åç§° ã€Œgit pull [remote] [branch]ã€ å–å›è¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶ä¸æœ¬åœ°ç‰ˆæœ¬åˆå¹¶ ã€Œgit pullã€ åŒä¸Šï¼Œé’ˆå¯¹å½“å‰åˆ†æ”¯ git fetch [remote] è·å–è¿œç¨‹ä»“åº“çš„æ‰€æœ‰å˜åŠ¨åˆ°æœ¬åœ°ä»“åº“ï¼Œä¸ä¼šè‡ªåŠ¨åˆå¹¶ï¼éœ€è¦æ‰‹åŠ¨åˆå¹¶ ã€Œgit pushã€ æ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ git push [remote] [branch] æ¨é€æœ¬åœ°å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“çš„æŒ‡å®šåˆ†æ”¯ git push [remote] â€“force/-f å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çªï¼Œâš ï¸å¾ˆå±é™©ï¼ git push [remote] â€“all æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ git push â€“u å‚æ•°â€“uè¡¨ç¤ºä¸è¿œç¨‹åˆ†æ”¯å»ºç«‹å…³è”ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™ç”¨ï¼Œåé¢å°±ä¸éœ€è¦äº† git remote rm [remote-name] åˆ é™¤è¿œç¨‹ä»“åº“ git pull â€“rebase ä½¿ç”¨rebaseçš„æ¨¡å¼è¿›è¡Œåˆå¹¶ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:7:1","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"7.2 pushå’Œpull git pushã€git pullæ˜¯å›¢é˜Ÿåä½œä¸­æœ€å¸¸ç”¨çš„æŒ‡ä»¤ï¼Œç”¨äºåŒæ­¥æœ¬åœ°ã€æœåŠ¡ç«¯çš„æ›´æ–°ï¼Œä¸ä»–äººåä½œã€‚ ã€ŒğŸ”¸æ¨é€ã€ï¼ˆpushï¼‰ï¼šæ¨é€æœ¬åœ°ä»“åº“åˆ°è¿œç¨‹ä»“åº“ã€‚ å¦‚æœæ¨é€çš„æ›´æ–°ä¸æœåŠ¡ç«¯å­˜åœ¨å†²çªï¼Œåˆ™ä¼šè¢«æ‹’ç»ï¼Œpushå¤±è´¥ã€‚ä¸€èˆ¬æ˜¯æœ‰å…¶ä»–äººæ¨é€äº†ä»£ç ï¼Œå¯¼è‡´æ–‡ä»¶å†²çªï¼Œå¯ä»¥å…ˆpullä»£ç ï¼Œåœ¨æœ¬åœ°è¿›è¡Œåˆå¹¶ï¼Œç„¶åå†pushã€‚ ã€ŒğŸ”¸æ‹‰å–ã€ï¼ˆpullï¼‰ï¼šä»æœåŠ¡ç«¯ï¼ˆè¿œç¨‹ï¼‰ä»“åº“æ›´æ–°åˆ°æœ¬åœ°ä»“åº“ã€‚ git pullï¼šæ‹‰å–æœåŠ¡ç«¯çš„æœ€æ–°æäº¤åˆ°æœ¬åœ°ï¼Œå¹¶ä¸æœ¬åœ°åˆå¹¶ï¼Œåˆå¹¶è¿‡ç¨‹åŒåˆ†æ”¯çš„åˆå¹¶ã€‚ git fetchï¼šæ‹‰å–æœåŠ¡ç«¯çš„æœ€æ–°æäº¤åˆ°æœ¬åœ°ï¼Œä¸ä¼šè‡ªåŠ¨åˆå¹¶ï¼Œä¹Ÿä¸ä¼šæ›´æ–°å·¥ä½œåŒºã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:7:2","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"7.4 fetchå’Œpullæœ‰ä»€ä¹ˆåŒºåˆ« 1. Git Fetch git fetchå‘½ä»¤ç”¨äºä»å¦ä¸€ä¸ªä»“åº“ï¼ˆä¾‹å¦‚ï¼Œè¿œç¨‹ä»“åº“ï¼‰ä¸‹è½½æ–°çš„åˆ†æ”¯å’Œæ•°æ®ï¼Œä½†ä¸ä¼šè‡ªåŠ¨åˆå¹¶æˆ–ä¿®æ”¹ä½ å½“å‰å·¥ä½œç›®å½•ä¸‹çš„æ–‡ä»¶æˆ–åˆ†æ”¯ã€‚fetch å‘½ä»¤ä¼šæŠŠè¿œç¨‹ä»“åº“çš„æ‰€æœ‰ä¿¡æ¯æ‹‰å–åˆ°æœ¬åœ°ä»“åº“ï¼Œä½†è¿™äº›æ”¹åŠ¨ä¸ä¼šåæ˜ åœ¨ä½ çš„å½“å‰å·¥ä½œåˆ†æ”¯ä¸Šï¼Œé™¤éä½ æ˜ç¡®åœ°è¿›è¡Œåˆå¹¶ã€‚ æ¢å¥è¯è¯´ï¼Œgit fetchæ˜¯ä¸€ç§å®‰å…¨çš„æ–¹å¼æ¥æŸ¥çœ‹åˆ«äººå·²ç»åšäº†å“ªäº›å·¥ä½œï¼Œè€Œè¿™äº›å˜æ›´åœ¨ä½ ç”¨git fetchä¹‹åä¸ä¼šå½±å“ä½ å½“å‰çš„å·¥ä½œçŠ¶æ€ã€‚å¦‚æœä½ æƒ³è¦è®©è¿™äº›å˜æ›´å½±å“ä½ çš„å½“å‰åˆ†æ”¯ï¼Œä½ éœ€è¦ç”¨git mergeæ‰‹åŠ¨åˆå¹¶ï¼Œå¦‚git merge origin/masterï¼ˆå¦‚æœä½ æ˜¯ä»masteråˆ†æ”¯ä¸Šfetchçš„ï¼‰ã€‚ 2. Git Pull git pullå‘½ä»¤å®é™…ä¸Šæ˜¯git fetchåŠ ä¸Šgit mergeå‘½ä»¤çš„ç»„åˆã€‚å½“ä½ æ‰§è¡Œgit pullï¼ŒGitä¼šä»è¿œç¨‹ä»“åº“è·å–æœ€æ–°çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œç„¶åå°è¯•è‡ªåŠ¨åˆå¹¶åˆ°ä½ å½“å‰çš„åˆ†æ”¯ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™æ„å‘³ç€å®ƒå°†è¿œç¨‹çš„æ›´æ–°å†…å®¹åˆå¹¶åˆ°ä½ å½“å‰åˆ†æ”¯çš„æœ¬åœ°å‰¯æœ¬ä¸­ã€‚ åœ¨ç®€å•çš„æƒ…å†µä¸‹ï¼Œgit pullä¼šé¡ºåˆ©åœ°å°†è¿œç¨‹å˜æ›´åˆå¹¶åˆ°ä½ çš„æœ¬åœ°åˆ†æ”¯ï¼Œä½ çš„å·¥ä½œæµç¨‹å¯ä»¥æ— ç¼ç»§ç»­ã€‚ç„¶è€Œï¼Œå¦‚æœåœ¨fetchçš„æ•°æ®ä¸ä½ æœ¬åœ°çš„ä¿®æ”¹å­˜åœ¨å†²çªæ—¶ï¼Œä½ å¯èƒ½éœ€è¦æ‰‹åŠ¨è§£å†³è¿™äº›å†²çªã€‚ 3. ä½¿ç”¨åœºæ™¯å¯¹æ¯” åœ¨ä¸æ¸…æ¥šè¿œç¨‹åˆ†æ”¯çš„æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æ›´å€¾å‘äºé¦–å…ˆä½¿ç”¨git fetchæ¥æŸ¥çœ‹æœ‰å“ªäº›æ›´æ–°ï¼Œå¾…æ£€æŸ¥å®Œæ›´æ–°å†…å®¹åå†å†³å®šæ˜¯å¦åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€‚è¿™æ˜¯ä¸€ç§æ›´ä¸ºè°¨æ…çš„åšæ³•ï¼Œå°¤å…¶é€‚ç”¨äºå¤æ‚çš„åˆå¹¶æ“ä½œï¼Œæˆ–è€…å½“ä½ ä¸å¸Œæœ›è‡ªåŠ¨å°†æ›´æ”¹åº”ç”¨åˆ°æœ¬åœ°ä»“åº“æ—¶ä½¿ç”¨ã€‚ å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ ç›¸ä¿¡è¿œç¨‹çš„å˜æ›´ä¸ä¼šå¼•èµ·ä»»ä½•é—®é¢˜ï¼Œå¹¶ä¸”å¸Œæœ›ä½ çš„æœ¬åœ°åˆ†æ”¯ä¿æŒä¸è¿œç¨‹åˆ†æ”¯çš„åŒæ­¥ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨git pullã€‚ 4.æ¡ˆä¾‹ è·å–è¿œç¨‹ä»“åº“çš„æ›´æ–°æ•°æ®ï¼Œä½†ä¸åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ï¼š git fetch origin è·å–è¿œç¨‹ä»“åº“çš„æ›´æ–°æ•°æ®å¹¶è‡ªåŠ¨åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ï¼š git pull origin master # æ‹‰å–originè¿œç¨‹ä»“åº“çš„masteråˆ†æ”¯å¹¶åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ git fetchç”¨äºå®‰å…¨åœ°æŸ¥çœ‹è¿œç¨‹å˜æ›´ï¼Œè€Œgit pullåˆ™ç”¨äºè·å–å¹¶ç«‹åˆ»åº”ç”¨è¿™äº›å˜æ›´ã€‚ä¸¤è€…åˆé€‚çš„ä½¿ç”¨å–å†³äºä½ æƒ³å¦‚ä½•ç®¡ç†è¿œç¨‹æ•°æ®å’Œæœ¬åœ°åˆ†æ”¯çš„å…³ç³»ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:7:3","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"8.åˆ†æ”¯ å‡ ä¹æ¯ä¸€ç§ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿéƒ½ä»¥æŸç§å½¢å¼æ”¯æŒåˆ†æ”¯ï¼Œä¸€ä¸ªåˆ†æ”¯ä»£è¡¨ä¸€æ¡ç‹¬ç«‹çš„å¼€å‘çº¿ã€‚ ä½¿ç”¨åˆ†æ”¯æ„å‘³ç€ä½ å¯ä»¥ä»å¼€å‘ä¸»çº¿ä¸Šåˆ†ç¦»å¼€æ¥ï¼Œç„¶ååœ¨ä¸å½±å“ä¸»çº¿çš„åŒæ—¶ç»§ç»­å·¥ä½œã€‚ åˆ†æ”¯ç¤ºæ„ Git åˆ†æ”¯å®é™…ä¸Šæ˜¯æŒ‡å‘æ›´æ”¹å¿«ç…§çš„æŒ‡é’ˆã€‚ æœ‰äººæŠŠ Git çš„åˆ†æ”¯æ¨¡å‹ç§°ä¸º**ã€Œå¿…æ€æŠ€ç‰¹æ€§ã€**ï¼Œè€Œæ­£æ˜¯å› ä¸ºå®ƒï¼Œå°† ã€ŒGitã€ ä»ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå®¶æ—é‡ŒåŒºåˆ†å‡ºæ¥ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:8:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"8.1 branch åŠ å…¥ï¼Œå‡†å¤‡1æœˆä»½å‘å¸ƒæ–°ç‰ˆæœ¬ï¼Œè¦æ–°å¼€å‘ä¸€äº›æ–°åŠŸèƒ½ï¼Œå é¢†å¸‚åœºã€‚ä½ å’Œå°ä¼™ä¼´ ã€Œå¼ ä¸‰ã€ ä¸€èµ·è´Ÿè´£å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½Aï¼Œå¼€å‘å‘¨æœŸ2å‘¨ï¼Œåœ¨è¿™ä¸¤å‘¨ä½ ä»¬çš„ä»£ç ä¸èƒ½å½±å“å…¶ä»–äººï¼Œä¸å½±å“ä¸»åˆ†æ”¯ã€‚è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä¸ºè¿™ä¸ªæ–°åŠŸèƒ½åˆ›å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½ ä»¬ä¸¤åœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šå¹²æ´»ï¼Œ2å‘¨åä»£ç å¼€å‘å®Œäº†ã€æµ‹è¯•é€šè¿‡ï¼Œå°±å¯ä»¥åˆå¹¶è¿›è¦å‘ç‰ˆçš„å¼€å‘åˆ†æ”¯äº†ã€‚å®‰å…¨ã€é«˜æ•ˆï¼Œä¸å½±å“å…¶ä»–äººå·¥ä½œï¼Œå®Œç¾ï¼ å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰å¤šä¸ªåˆ†æ”¯è¿›è¡Œå¼€å‘ã€‚ ã€Œmasterã€ï¼šä½œä¸ºä¸»åˆ†æ”¯ï¼Œå­˜æ”¾ç¨³å®šçš„ä»£ç ï¼Œå°±æ˜¯å¼€å‘åæµ‹è¯•é€šè¿‡çš„ä»£ç ï¼Œä¸å…è®¸éšä¾¿ä¿®æ”¹å’Œåˆå¹¶ã€‚ ã€Œå¼€å‘åˆ†æ”¯ã€ï¼šç”¨äºå›¢é˜Ÿæ—¥å¸¸å¼€å‘ç”¨ï¼Œæ¯”å¦‚å›¢é˜Ÿè®¡åˆ’12æœˆä»½å¼€å‘10ä¸ªåŠŸèƒ½å¹¶å‘ç‰ˆï¼Œåˆ™åœ¨æ­¤åˆ†æ”¯ä¸Šè¿›è¡Œï¼Œä¸å½±å“ä¸»åˆ†æ”¯çš„ç¨³å®šï¼Œå¦‚æœæˆ‘ä»¬å¼€å‘åˆ°ä¸€ä¸ªæˆç†Ÿé˜¶æ®µï¼Œä¾ç„¶å¯ä»¥åˆå¹¶åˆ°masterä¸»åˆ†æ”¯ã€‚ â **ã€Œåˆ†æ”¯ã€**å°±æ˜¯æŒ‡å‘æŸä¸€ä¸ªæäº¤è®°å½•çš„â€œæŒ‡é’ˆâ€å¼•ç”¨ï¼Œå› æ­¤åˆ›å»ºåˆ†æ”¯æ˜¯éå¸¸å¿«çš„ï¼Œä¸ç®¡ä»“åº“å¤šå¤§ã€‚å½“æˆ‘ä»¬è¿è¡Œgit branch devåˆ›å»ºäº†ä¸€ä¸ªåå­—ä¸ºdevçš„åˆ†æ”¯ï¼ŒGitå®é™…ä¸Šæ˜¯åœ¨.git\\refs\\headsä¸‹åˆ›å»ºä¸€ä¸ªdevçš„å¼•ç”¨æ–‡ä»¶ï¼ˆæ²¡æœ‰æ‰©å±•åï¼‰ã€‚ â ","date":"2024-02-02","objectID":"/posts/gitnotes2/:8:1","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"8.2 åˆ†æ”¯å‘½ä»¤ æˆ‘è¿™é‡Œè®²è¿™äº›å‘½ä»¤æ€»ç»“ä¸ºæ€ç»´å¯¼å›¾ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚ branch åˆ†æ”¯ç¤ºæ„å¯¼å›¾ åˆ—å‡ºäº†å½“å‰çš„æ‰€æœ‰åˆ†æ”¯ï¼Œæ˜Ÿå·â€œ*â€å¼€å¤´çš„â€œmainâ€ä¸ºå½“å‰æ´»åŠ¨åˆ†æ”¯ã€‚ åˆ—å‡ºå½“å‰çš„æ‰€æœ‰åˆ†æ”¯ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:8:2","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"8.3 åˆ†æ”¯å†²çª æŠŠä¸¤ä¸ªåˆ†æ”¯çš„ä¿®æ”¹å†…å®¹åˆå¹¶åˆ°ä¸€èµ·ï¼Œå¸¸ç”¨çš„åˆå¹¶æŒ‡ä»¤git merge [branch]ï¼Œå°†åˆ†æ”¯[branch]åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€‚æ ¹æ®è¦åˆå¹¶çš„å†…å®¹çš„ä¸åŒï¼Œå…·ä½“åˆå¹¶è¿‡ç¨‹å°±ä¼šæœ‰å¤šç§æƒ…å†µã€‚ é¦–å…ˆæˆ‘ä»¬å‡†å¤‡ä¸€ä¸ªæ¡ˆä¾‹é¡¹ç›®ï¼Œæˆ‘å·²ç»åœ¨giteeå‡†å¤‡å¥½äº†ï¼Œéå¸¸ç®€å•ï¼Œåªæœ‰ä¸‰ä¸ªç®€å•çš„æ–‡ä»¶ã€‚ gitee ä»£ç  1. å¿«é€Ÿåˆå¹¶ åˆå¹¶devåˆ°masterï¼Œæ³¨æ„è¦å…ˆåˆ‡æ¢åˆ°masteråˆ†æ”¯ï¼Œç„¶åæ‰§è¡Œgit merge devï¼ŒæŠŠdevåˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€‚ é¦–å…ˆåˆ›å»ºdevåˆ†æ”¯å¹¶åˆ‡æ¢åˆ°devåˆ†æ”¯ä¸Šå»ã€‚ åˆ›å»ºdevåˆ†æ”¯ ç„¶åå†devåˆ†æ”¯ä¸Šé¢åˆ›å»ºä¸€ä¸ªb.txtæ–‡ä»¶ï¼Œéšä¹‹æäº¤åˆ°è¿œç¨‹ä»“åº“ä¸­ã€‚ BP Network å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¿œç¨‹ä»“åº“çš„devåˆ†æ”¯ä¸Šé¢å·²ç»æœ‰äº†b.txtè¿™ä¸ªæ–‡ä»¶ã€‚ BP Network ç„¶ååˆ‡æ¢åˆ°masteråˆ†æ”¯ä¸Šé¢ï¼ŒæŠŠdevåˆ†æ”¯åˆå¹¶åˆ°æˆ‘ä»¬çš„masterä¸»åˆ†æ”¯ä¸Šé¢ã€‚ BP Network åŒæ—¶å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¿œç¨‹ä»“åº“ä¸­masteråˆ†æ”¯ä¹ŸåŒæ­¥åˆ°äº†devåˆ†æ”¯çš„b.txtæ–‡ä»¶ã€‚ BP Network 2. æ™®é€šåˆå¹¶ å¦‚æœmasteræœ‰å˜æ›´ï¼Œå­˜åœ¨åˆ†æ”¯äº¤å‰ï¼Œåˆ™ä¼šæŠŠä¸¤è¾¹çš„å˜æ›´åˆå¹¶æˆä¸€ä¸ªæäº¤ã€‚ å¦‚æœä¸¤è¾¹å˜æ›´çš„æ–‡ä»¶ä¸åŒï¼Œæ²¡æœ‰ä»€ä¹ˆå†²çªï¼Œå°±è‡ªåŠ¨åˆå¹¶äº†ã€‚ å¦‚æœæœ‰ä¿®æ”¹åŒä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ™ä¼šå­˜åœ¨å†²çªï¼Œåˆ°åº•è¯¥é‡‡ç”¨å“ªè¾¹çš„ï¼Œç¨‹åºæ— æ³•åˆ¤æ–­ï¼Œå°±æ¢äº§ç”Ÿå†²çªã€‚å†²çªå†…å®¹éœ€è¦äººå·¥ä¿®æ”¹åå†é‡æ–°æäº¤ï¼Œæ‰èƒ½å®Œæˆæœ€ç»ˆçš„åˆå¹¶ã€‚ æˆ‘ä»¬åœ¨è¿œç¨‹ä»“åº“masteråˆ†æ”¯ä¸­æ‰‹åŠ¨æ›´æ”¹a.txtæ–‡ä»¶æ¥æ¼”ç¤ºã€‚ 1. ç¬¬ä¸€ç§æƒ…å†µ BP Network æ­¤æ—¶æˆ‘ä»¬åœ¨æœ¬åœ°ä»“åº“ä¸­æ›´æ”¹å…¶ä»–æ–‡ä»¶ï¼Œåªè¦ä¸æ˜¯a.txtå³å¯ï¼Œç„¶åpushåˆ°è¿œç¨‹ã€‚ BP Network æ­¤æ—¶å‘ç°æˆ‘ä»¬å½“å‰æœ¬åœ°ä»“åº“çš„ç‰ˆæœ¬å·ä¸è¿œç¨‹ä»“åº“masteråˆ†æ”¯çš„ç‰ˆæœ¬å·ä¸ä¸€è‡´ï¼Œå¯¼è‡´æäº¤ä¸ä¸Šå»ã€‚ è¿™ç§æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œåªéœ€è¦é€šè¿‡ git pull å‘½ä»¤å°†æœ¬åœ°ç‰ˆæœ¬ä¸è¿œç¨‹ç‰ˆæœ¬åŒæ­¥å³å¯ BP Network æ­¤æ—¶ä¼šè¿›è¡Œè‡ªåŠ¨åˆå¹¶åˆ°æœ¬åœ°åˆ†æ”¯ï¼Œå¹¶å½“åšä¸€æ¬¡æäº¤ï¼Œæäº¤ä¿¡æ¯å¤§å®¶ä¹Ÿå¯ä»¥è¿›è¡Œæ›´æ”¹ï¼Œæˆ‘è¿™é‡Œé»˜è®¤å³å¯ã€‚ BP Network æ­¤æ—¶å†æ¬¡æäº¤å³å¯æˆåŠŸæäº¤åˆ°è¿œç¨‹ä»“åº“ä¸­ã€‚ 2. ç¬¬äºŒç§æƒ…å†µ ä¸Šé¢é‚£ç§æ–¹å¼å¤„ç†èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºæ˜¯å¤„ç†ä¸åŒçš„æ–‡ä»¶ã€‚ ä¸‹é¢æˆ‘æ¥æ¼”ç¤ºä¸€ä¸‹å¯¹äºåŒä¸€ä¸ªæ–‡ä»¶å†²çªæƒ…å†µè¿›è¡Œè§£å†³ã€‚ æˆ‘ä»¬åœ¨è¿œç¨‹ä»“åº“æ‰‹åŠ¨æ·»åŠ äº†ä»¥ä¸‹è¿™å¥è¯è¿›è¡Œå¯¹b.txtæ–‡ä»¶çš„ä¿®æ”¹ã€‚(å¯ä»¥ç†è§£ä¸ºç¨‹åºå‘˜Aä¿®æ”¹äº†b.txtæ–‡ä»¶å¹¶æäº¤åˆ°è¿œç¨‹ä»“åº“ä¸­å»ã€‚) BP Network æ­¤æ—¶ç¨‹åºå‘˜Bä¹Ÿåœ¨æœ¬åœ°ä¿®æ”¹äº†b.txtæ–‡ä»¶ã€‚ BP Network ç„¶åé€šè¿‡ä¸€ç³»åˆ—å‘½ä»¤æäº¤è‡³è¿œç¨‹ä»“åº“ã€‚ å¯ä»¥å‘ç°å‡ºç°å†²çªä¹‹åï¼Œæˆ‘ä»¬ç«‹å³é€šè¿‡git pull å‘½ä»¤è¿›è¡Œäº†åŒæ­¥ï¼Œä½†æ˜¯åˆå§‹æˆ‘ä»¬çš„è¿™é‡Œå‘ç”Ÿäº†å¾ˆå¤šå˜åŒ–ï¼Œå˜æˆäº†**ã€Œmaster | MENERGINGã€**ã€‚ BP Network æ­¤æ—¶è¿™ç§æƒ…å†µå°±æ˜¯å› ä¸ºåœ¨è‡ªåŠ¨åˆå¹¶çš„æ—¶å€™å‡ºç°äº†å†²çªï¼Œgitæ— æ³•å¸®åŠ©æˆ‘ä»¬è§£å†³ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨è§£å†³å†²çªã€‚ ç„¶åæˆ‘ä»¬åœ¨æœ¬åœ°æ‰“å¼€b.txtæ–‡ä»¶ã€‚ å¯ä»¥çœ‹åˆ°ç¡®å®ä¹ŸæŠŠè¿œç¨‹æ›´æ”¹çš„å†…å®¹åŒæ­¥è¿‡æ¥äº†ï¼Œè¿™é‡Œå°±éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è§£å†³ï¼Œç”±æˆ‘ä»¬å’Œå¦å¤–ä¸€ä¸ªç¨‹åºå‘˜åå•†åˆ°åº•æ˜¯ä¿ç•™è°çš„å†…å®¹æˆ–è€…æ˜¯éƒ½ä¿ç•™ã€‚ BP Network æ­¤æ—¶æˆ‘ä»¬è§‰å¾—éƒ½è¿›è¡Œä¿ç•™ï¼Œç„¶ååˆ é™¤å…¶ä»–å¤šä½™å†…å®¹ã€‚ ç„¶åè¿›è¡Œä»£ç æäº¤ã€‚ BP Network æ­¤æ—¶å¯ä»¥å‘ç°è¿œç¨‹ä»“åº“b.txtæ–‡ä»¶å†…å®¹å·²ç»å‘ç°äº†æ”¹å˜ï¼Œå¹¶ä¸”æ˜¯ç”±æˆ‘ä»¬æ‰‹åŠ¨è§£å†³å¹¶æäº¤çš„ã€‚ BP Network å¤§åŠŸå‘Šæˆ!! ","date":"2024-02-02","objectID":"/posts/gitnotes2/:8:3","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"9.Gitçš„ç‰ˆæœ¬å›é€€ å¦‚æœå‘ç°æˆ‘ä»¬ç¼–å†™ä»£ç ä¸­å†™é”™äº†è¦æ€ä¹ˆåŠï¼Œä½†åˆåˆ†å¥½å‡ ç§æƒ…å†µï¼Œæˆ‘ä»¬ä¾æ¬¡å¾€ä¸‹çœ‹ã€‚ â“è¿˜æ²¡æäº¤çš„æ€ä¹ˆæ’¤é”€ï¼Ÿ â€“ checkout è¿˜æœªæäº¤çš„ä¿®æ”¹ï¼ˆå·¥ä½œåŒºã€æš‚å­˜åŒºï¼‰ä¸æƒ³è¦äº†ï¼Œç”¨ç­¾å‡ºæŒ‡ä»¤ï¼ˆcheckoutï¼‰è¿›è¡Œæ’¤é”€æ¸…é™¤ã€‚ æˆ–è€…ç”¨checkoutçš„æ–°ç‰ˆå›æ»šæŒ‡ä»¤resetã€‚ â“ã€Œå·²æäº¤ä½†ä¹ˆæœ‰pushçš„æäº¤å¦‚ä½•æ’¤é”€ï¼Ÿã€â€”â€” resetã€revert â“ã€Œå·²pushçš„æäº¤å¦‚ä½•æ’¤é”€ï¼Ÿã€â€”â€” åŒä¸Šï¼Œå…ˆæœ¬åœ°æ’¤é”€ï¼Œç„¶åå¼ºåˆ¶æ¨é€git push origin -fï¼Œã€Œâš ï¸æ³¨æ„æ…ç”¨ï¼ã€ è®°å¾—å…ˆpullè·å–æ›´æ–°ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:9:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"9.1 ç‰ˆæœ¬å›é€€å‘½ä»¤ ã€ŒæŒ‡ä»¤ã€ ã€Œæè¿°ã€ git checkout . æ’¤é”€å·¥ä½œåŒºçš„ï¼ˆæœªæš‚å­˜ï¼‰ä¿®æ”¹ï¼ŒæŠŠæš‚å­˜åŒºæ¢å¤åˆ°å·¥ä½œåŒºã€‚ä¸å½±å“æš‚å­˜åŒºï¼Œå¦‚æœæ²¡æš‚å­˜ï¼Œåˆ™æ’¤é”€æ‰€æœ‰å·¥ä½œåŒºä¿®æ”¹ git checkout [file] åŒä¸Šï¼ŒfileæŒ‡å®šæ–‡ä»¶ git checkout HEAD . æ’¤é”€å·¥ä½œåŒºã€æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œç”¨HEADæŒ‡å‘çš„å½“å‰åˆ†æ”¯æœ€æ–°ç‰ˆæœ¬æ›¿æ¢å·¥ä½œåŒºã€æš‚å­˜åŒº git checkout HEAD [file] åŒä¸Šï¼ŒfileæŒ‡å®šæ–‡ä»¶ git reset æ’¤é”€æš‚å­˜åŒºçŠ¶æ€ï¼ŒåŒgit reset HEADï¼Œä¸å½±å“å·¥ä½œåŒº git reset HEAD [file] åŒä¸Šï¼ŒæŒ‡å®šæ–‡ä»¶fileï¼ŒHEADå¯çœç•¥ git reset [commit] å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œæ¸…ç©ºæš‚å­˜åŒºï¼Œä¸å½±å“å·¥ä½œåŒºã€‚å·¥ä½œåŒºéœ€è¦æ‰‹åŠ¨git checkoutç­¾å‡º git reset â€“soft [commit] ç§»åŠ¨åˆ†æ”¯masterã€HEADåˆ°æŒ‡å®šçš„ç‰ˆæœ¬ï¼Œä¸å½±å“æš‚å­˜åŒºã€å·¥ä½œåŒºï¼Œéœ€æ‰‹åŠ¨git checkoutç­¾å‡ºæ›´æ–° git reset â€“hard HEAD æ’¤é”€å·¥ä½œåŒºã€æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œç”¨å½“å‰æœ€æ–°ç‰ˆ git reset â€“hard HEAD~ å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œå¹¶é‡ç½®å·¥ä½œåŒºã€æš‚å­˜åŒºå†…å®¹ã€‚ git reset â€“hard [commit] å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œå¹¶é‡ç½®å·¥ä½œåŒºã€æš‚å­˜åŒºå†…å®¹ã€‚ git ã€Œrevertã€[commit] æ’¤é”€ä¸€ä¸ªæäº¤ï¼Œä¼šç”¨ä¸€ä¸ªæ–°çš„æäº¤ï¼ˆåŸæäº¤çš„é€†å‘æ“ä½œï¼‰æ¥å®Œæˆæ’¤é”€æ“ä½œï¼Œå¦‚æœå·²pushåˆ™é‡æ–°pushå³å¯ git checkout .ã€git checkout [file] ä¼šæ¸…é™¤å·¥ä½œåŒºä¸­æœªæ·»åŠ åˆ°æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œç”¨æš‚å­˜åŒºå†…å®¹æ›¿æ¢å·¥ä½œåŒºã€‚ git checkout HEAD .ã€git checkout HEAD [file] ä¼šæ¸…é™¤å·¥ä½œåŒºã€æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œç”¨HEADæŒ‡å‘çš„å½“å‰åˆ†æ”¯æœ€æ–°ç‰ˆæœ¬æ›¿æ¢æš‚å­˜åŒºã€å·¥ä½œåŒºã€‚ 1. åªæ’¤é”€å·¥ä½œåŒºçš„ä¿®æ”¹ï¼ˆæœªæš‚å­˜ï¼‰ æ’¤é”€å·¥ä½œåŒºçš„ï¼ˆæœªæš‚å­˜ï¼‰ä¿®æ”¹ï¼ŒæŠŠæš‚å­˜åŒºæ¢å¤åˆ°å·¥ä½œåŒºã€‚ä¸å½±å“æš‚å­˜åŒºï¼Œå¦‚æœæ²¡æš‚å­˜ï¼Œåˆ™æ’¤é”€æ‰€æœ‰å·¥ä½œåŒºä¿®æ”¹ã€‚ BP Network 2. æ’¤é”€å·¥ä½œåŒºã€æš‚å­˜åŒºçš„ä¿®æ”¹ æ’¤é”€å·¥ä½œåŒºã€æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œç”¨HEADæŒ‡å‘çš„å½“å‰åˆ†æ”¯æœ€æ–°ç‰ˆæœ¬æ›¿æ¢å·¥ä½œåŒºã€æš‚å­˜åŒº BP Network ","date":"2024-02-02","objectID":"/posts/gitnotes2/:9:1","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"9.2 reset resetæ˜¯ä¸“é—¨ç”¨æ¥æ’¤é”€ä¿®æ”¹ã€å›é€€ç‰ˆæœ¬çš„æŒ‡ä»¤ï¼Œæ”¯æŒçš„åœºæ™¯æ¯”è¾ƒå¤šï¼Œå¤šç§æ’¤é”€å§¿åŠ¿ï¼Œæ‰€ä»¥å‚æ•°ç»„åˆä¹Ÿæ¯”è¾ƒå¤šã€‚ç®€å•ç†è§£å°±æ˜¯ç§»åŠ¨masteråˆ†æ”¯ã€HEADçš„â€œæŒ‡é’ˆâ€åœ°å€ï¼Œç†è§£è¿™ä¸€ç‚¹å°±åŸºæœ¬æŒæ¡resetäº†ã€‚ resetæœ‰ä¸‰ç§æ¨¡å¼ï¼Œå¯¹åº”ä¸‰ç§å‚æ•°ï¼šmixedï¼ˆé»˜è®¤æ¨¡å¼ï¼‰ã€softã€hardã€‚ä¸‰ç§å‚æ•°çš„ä¸»è¦åŒºåˆ«å°±æ˜¯å¯¹å·¥ä½œåŒºã€æš‚å­˜åŒºçš„æ“ä½œä¸åŒã€‚ mixedä¸ºé»˜è®¤æ¨¡å¼ï¼Œå‚æ•°å¯ä»¥çœç•¥ã€‚ åªæœ‰hardæ¨¡å¼ä¼šé‡ç½®å·¥ä½œåŒºã€æš‚å­˜åŒºï¼Œä¸€èˆ¬ç”¨è¿™ä¸ªæ¨¡å¼ä¼šå¤šä¸€ç‚¹ã€‚ BP Network æ¨¡å¼åç§° ã€Œæè¿°ã€ ã€ŒHEADçš„ä½ç½®ã€ ã€Œæš‚å­˜åŒºã€ ã€Œå·¥ä½œåŒºã€ ã€Œsoftã€ å›é€€åˆ°æŸä¸€ä¸ªç‰ˆæœ¬ï¼Œå·¥ä½œåŒºä¸å˜ï¼Œéœ€æ‰‹åŠ¨git checkout ä¿®æ”¹ ä¸ä¿®æ”¹ ä¸ä¿®æ”¹ ã€Œmixedã€(é»˜è®¤) æ’¤é”€æš‚å­˜åŒºçŠ¶æ€ï¼Œä¸å½±å“å·¥ä½œåŒºï¼Œéœ€æ‰‹åŠ¨git checkout ä¿®æ”¹ ä¿®æ”¹ ä¸ä¿®æ”¹ ã€Œhardã€ é‡ç½®æœªæäº¤ä¿®æ”¹ï¼ˆå·¥ä½œåŒºã€æš‚å­˜åŒºï¼‰ ä¿®æ”¹ ä¿®æ”¹ ä¿®æ”¹ ç©¿æ¢­å‰ï¼Œç”¨git logå¯ä»¥æŸ¥çœ‹æäº¤å†å²ï¼Œä»¥ä¾¿ç¡®å®šè¦å›é€€åˆ°å“ªä¸ªç‰ˆæœ¬ã€‚è¦é‡è¿”æœªæ¥ï¼Œç”¨git reflogæŸ¥çœ‹å‘½ä»¤å†å²ï¼Œä»¥ä¾¿ç¡®å®šè¦å›åˆ°æœªæ¥çš„å“ªä¸ªç‰ˆæœ¬ã€‚ 1. æ’¤é”€æš‚å­˜åŒº è¿™ä¸ªå…¶å®è·Ÿåˆšåˆšçš„ git checkout HEAD .æ˜¯ä¸€æ ·çš„ã€‚ 2. æ’¤é”€å·¥ä½œåŒºã€æš‚å­˜åŒºä¿®æ”¹ $ git reset --hard HEAD 3. å›é€€ç‰ˆæœ¬åº“åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œå¹¶é‡ç½®å·¥ä½œåŒºã€æš‚å­˜ $ git reset --hard HEAD~ å¯ä»¥çœ‹åˆ°ä»–å·²ç»å›åˆ°äº†æˆ‘ä»¬ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚ BP Network é€šè¿‡git log æ—¥å¿—æŸ¥çœ‹ä¹Ÿæ²¡æœ‰äº†ä¹‹å‰çš„è®°å½•ï¼Œè€Œæ˜¯è¢«HEADæŒ‡å‘åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚ BP Network 4. å›åˆ°åŸæ¥çš„ç‰ˆæœ¬ï¼Œå¹¶é‡ç½®å·¥ä½œåŒºã€æš‚å­˜ $ git reset --hard 891350d å¯ä»¥çœ‹åˆ°ä»–åˆå›åˆ°ä¸Šä¸Šä¸€æ­¥ï¼Œä¹Ÿå°±æ˜¯å¯¹ä¸Šä¸€æ­¥æ“ä½œè¿›è¡Œæ’¤é”€ã€‚ BP Network 5. æŸ¥çœ‹æ‰€æœ‰å†å²æäº¤è®°å½• git reflog BP Network ","date":"2024-02-02","objectID":"/posts/gitnotes2/:9:2","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"10.IDEAé›†æˆGit é€šè¿‡ä»¥ä¸Šå†…å®¹ï¼Œæˆ‘ä»¬å¯¹Gitæ•´ä¸ªå·¥ä½œæµç¨‹æœ‰äº†ä¸€äº›è®¤è¯†ï¼Œä»¥åŠçŸ¥é“å¦‚ä½•ä½¿ç”¨Gitè¿›è¡Œå¹³æ—¶çš„å¼€å‘ã€‚ ä½†æ˜¯åœ¨çœŸå®çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½å¹¶ä¸æ˜¯ä½¿ç”¨å‘½ä»¤è¡Œè¿›è¡Œæ“ä½œï¼Œè€Œæ˜¯åœ¨IDEAä¸­è¿›è¡Œå›¾å½¢åŒ–æ“ä½œï¼Œæˆ‘ä»¬å†™å®Œä»£ç å³å¯è¿›è¡Œæäº¤ã€‚ æˆ‘ä»¬æ‰“å¼€IDEAï¼Œä¾æ¬¡åœ¨settings â€”ã€‹Version Control â€”ã€‹ Gitã€‚ é€‰æ‹©è‡ªå·±çš„Gitå®‰è£…è·¯å¾„ï¼Œç„¶åè¿›è¡Œæµ‹è¯•çœ‹æ˜¯å¦æˆåŠŸã€‚ BP Network ç‚¹å‡»Testä¹‹åçœ‹åˆ°è‡ªå·±å¯¹åº”çš„Gitç‰ˆæœ¬å·ä¹‹åå³å¯è¯´æ˜æˆ‘ä»¬åˆæ­¥æµ‹è¯•æˆåŠŸã€‚ BP Network ç„¶åå°±å¯ä»¥åœ¨IDEAä¸­è¿›è¡Œä»£ç çš„ç¼–å†™ã€‚ BP Network ç„¶åè®²ä»£ç pushåˆ°è¿œç¨‹ä»“åº“ã€‚ BP Network ç›¸æ¯”äºå‘½ä»¤è¡Œï¼ŒIDEAçš„å›¾å½¢åŒ–æ“ä½œæ˜¯ä¸æ˜¯è®©äººæ›´çœå¿ƒï¼Œç®€å•æ˜“ä¸Šæ‰‹ã€‚ ","date":"2024-02-02","objectID":"/posts/gitnotes2/:10:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["Git"],"content":"11.å‚è€ƒæ–‡çŒ® https://git-scm.com/book/zh/v2 https://www.yuque.com/kanding/ktech/ccgylqhnb94ug4bu#LlJg3 https://javaguide.cn/tools/git/git-intro.html https://www.yiibai.com/git ","date":"2024-02-02","objectID":"/posts/gitnotes2/:11:0","tags":["Git"],"title":"Git æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“","uri":"/posts/gitnotes2/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ æ–‡æ¡£åœ¨æ‰€æœ‰çš„è½¯ä»¶é¡¹ç›®éƒ½æ˜¯æœ‰å¿…è¦çš„ï¼š å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œäº†è§£å¦‚ä½•è·å¾—å¹¶æ„å»ºä»£ç ï¼Œå¹¶ä¸”å¦‚ä½•æœ‰æ•ˆåœ°ä½¿ç”¨æºä»£ç æˆ–åº“ï¼› å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œæ–‡æ¡£å¯ç”¨æ¥æè¿°ä½ æºç ç»†èŠ‚ï¼Œå¹¶å¸®åŠ©å…¶ä»–ç¨‹åºå‘˜å‚ä¸å…¶ä¸­ä¸ºè¯¥é¡¹ç›®ä½œå‡ºè´¡çŒ®ã€‚ Doxygenæ˜¯éå¸¸æµè¡Œçš„æºä»£ç æ–‡æ¡£å·¥å…·ã€‚å¯ä»¥åœ¨ä»£ç ä¸­æ·»åŠ æ–‡æ¡£æ ‡è®°ä½œä¸ºæ³¨é‡Šï¼Œè€Œåè¿è¡ŒDoxygenæå–è¿™äº›æ³¨é‡Šï¼Œå¹¶ä»¥Doxyfileé…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„æ ¼å¼åˆ›å»ºæ–‡æ¡£ã€‚Doxygenå¯ä»¥è¾“å‡ºHTMLã€XMLï¼Œç”šè‡³LaTeXæˆ–PDFã€‚æœ¬ç¯‡ï¼Œå°†ä½¿ç”¨CMakeæ¥æ„å»ºDoxygenæ–‡æ¡£ã€‚ ","date":"2024-02-01","objectID":"/posts/cmake_note_45/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [45] ä½¿ç”¨Doxygenæ„å»ºæ–‡æ¡£","uri":"/posts/cmake_note_45/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â””â”€â”€ UseDoxygenDoc.cmake â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ docs â”‚ â”œâ”€â”€ Doxyfile.in â”‚ â””â”€â”€ front_page.md â””â”€â”€ src â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ hello_world.cpp â”œâ”€â”€ message.cpp â””â”€â”€ message.hpp é¡¹ç›®åœ°å€ https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter10/01 ","date":"2024-02-01","objectID":"/posts/cmake_note_45/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [45] ä½¿ç”¨Doxygenæ„å»ºæ–‡æ¡£","uri":"/posts/cmake_note_45/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) include(GNUInstallDirs) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_BINDIR}) list(APPEND CMAKE_MODULE_PATH \"${CMAKE_SOURCE_DIR}/cmake\") include(UseDoxygenDoc) add_subdirectory(src) add_doxygen_doc( BUILD_DIR ${CMAKE_CURRENT_BINARY_DIR}/_build DOXY_FILE ${CMAKE_CURRENT_SOURCE_DIR}/docs/Doxyfile.in TARGET_NAME docs COMMENT \"HTML documentation\" ) å¼•ç”¨ add_doxygen_doc( BUILD_DIR ${CMAKE_CURRENT_BINARY_DIR}/_build DOXY_FILE ${CMAKE_CURRENT_SOURCE_DIR}/docs/Doxyfile.in TARGET_NAME docs COMMENT \"HTML documentation\" ) è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨cmake/UseDoxygenDox.cmakeä¸­è¢«å®šä¹‰ã€‚æœ‰å››ä¸ªå‚æ•°ï¼šBUILD_DIR,DOXY_FILE,TARGET_NAMEä»¥åŠCOMMENTã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼Œè¯·å‚è€ƒä¸‹é¢çš„ä»‹ç»ã€‚ å½“ç„¶ï¼Œä¸ºäº†èƒ½å¤Ÿä½¿ç”¨Doxygenéœ€è¦äº‹å…ˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š sudo apt install doxygen cmake/UseDoxygenDoc.cmake find_package(Perl REQUIRED) find_package(Doxygen REQUIRED) function(add_doxygen_doc) set(options) set(oneValueArgs BUILD_DIR DOXY_FILE TARGET_NAME COMMENT) set(multiValueArgs) cmake_parse_arguments(DOXY_DOC \"${options}\" \"${oneValueArgs}\" \"${multiValueArgs}\" ${ARGN} ) configure_file( ${DOXY_DOC_DOXY_FILE} ${DOXY_DOC_BUILD_DIR}/Doxyfile @ONLY ) add_custom_target(${DOXY_DOC_TARGET_NAME} COMMAND ${DOXYGEN_EXECUTABLE} Doxyfile WORKING_DIRECTORY ${DOXY_DOC_BUILD_DIR} COMMENT \"Building ${DOXY_DOC_COMMENT} with Doxygen\" VERBATIM ) message(STATUS \"Added ${DOXY_DOC_TARGET_NAME} [Doxygen] target to build documentation\") endfunction() set(options): å®šä¹‰ä¸€ä¸ªå˜é‡optionsï¼Œåœ¨è¿™é‡Œæ²¡æœ‰åˆ—å‡ºä»»ä½•é€‰é¡¹ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ²¡æœ‰ä¸å¸¦å€¼çš„é€‰é¡¹å‚æ•°ã€‚ set(oneValueArgs BUILD_DIR DOXY_FILE TARGET_NAME COMMENT): å®šä¹‰äº†æ¥å—å•ä¸ªå€¼çš„å‚æ•°ã€‚è¿™é‡Œåˆ—å‡ºäº†å››ä¸ªå‚æ•°ï¼šBUILD_DIRæ˜¯æ–‡æ¡£æ„å»ºçš„ç›®å½•ï¼ŒDOXY_FILEæ˜¯Doxygençš„é…ç½®æ–‡ä»¶ï¼ŒTARGET_NAMEæ˜¯CMakeç›®æ ‡çš„åå­—ï¼ŒCOMMENTæ˜¯æ„å»ºæ—¶æ˜¾ç¤ºçš„æ³¨é‡Šã€‚ set(multiValueArgs): å®šä¹‰äº†æ¥å—å¤šä¸ªå€¼çš„å‚æ•°ï¼Œä½†åœ¨æ­¤è„šæœ¬ä¸­æœªä½¿ç”¨ã€‚ cmake_parse_arguments(DOXY_DOC ...): ç”¨äºè§£æè°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥çš„å‚æ•°ï¼Œå¹¶å°†è§£æåçš„å€¼å­˜å‚¨åˆ°DOXY_DOCå˜é‡ä¸­ã€‚ configure_file(...): ç”¨äºå¤„ç†é…ç½®æ–‡ä»¶ã€‚å®ƒå°†DOXY_DOC_DOXY_FILEå‚æ•°æŒ‡å®šçš„Doxygené…ç½®æ–‡ä»¶å¤åˆ¶åˆ°DOXY_DOC_BUILD_DIRå‚æ•°æŒ‡å®šçš„æ„å»ºç›®å½•ï¼Œå¹¶æ›¿æ¢å…¶ä¸­çš„å˜é‡ã€‚ add_custom_target(...): æ·»åŠ äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ç›®æ ‡åˆ°CMakeï¼Œæ‰§è¡Œè¿™ä¸ªç›®æ ‡æ—¶ï¼Œå®ƒä¼šåœ¨DOXY_DOC_BUILD_DIRç›®å½•ä¸‹è¿è¡ŒDoxygenæ¥ç”Ÿæˆæ–‡æ¡£ã€‚ COMMAND ${DOXYGEN_EXECUTABLE} Doxyfile: è¿™æ˜¯å®é™…è°ƒç”¨Doxygenå‘½ä»¤çš„éƒ¨åˆ†ã€‚ WORKING_DIRECTORY ${DOXY_DOC_BUILD_DIR}: æŒ‡å®šäº†Doxygenå‘½ä»¤è¿è¡Œçš„å·¥ä½œç›®å½•ã€‚ COMMENT \"Building ${DOXY_DOC_COMMENT} with Doxygen\": è®¾ç½®äº†å½“æ‰§è¡Œè¿™ä¸ªCMakeç›®æ ‡æ—¶æ˜¾ç¤ºçš„æ³¨é‡Šã€‚ VERBATIM: ä¿è¯äº†å‘½ä»¤è¡Œåœ¨æ‰€æœ‰å¹³å°ä¸Šä»¥å­—é¢æ„ä¹‰æ‰§è¡Œï¼Œæ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚ message(STATUS \"Added ${DOXY_DOC_TARGET_NAME} [Doxygen] target to build documentation\"): è¿™è¡Œæ‰“å°ä¸€æ¡çŠ¶æ€æ¶ˆæ¯ï¼Œå‘Šè¯‰ç”¨æˆ·å·²ç»æ·»åŠ äº†ä¸€ä¸ªåä¸º${DOXY_DOC_TARGET_NAME}çš„ç›®æ ‡ï¼Œç”¨äºæ„å»ºæ–‡æ¡£ã€‚ docs/Doxyfile.in # Doxyfile 1.8.14 #--------------------------------------------------------------------------- # Project related configuration options #--------------------------------------------------------------------------- DOXYFILE_ENCODING = UTF-8 PROJECT_NAME = recipe-01 PROJECT_NUMBER = PROJECT_BRIEF = PROJECT_LOGO = OUTPUT_DIRECTORY = CREATE_SUBDIRS = NO OUTPUT_LANGUAGE = English BRIEF_MEMBER_DESC = YES REPEAT_BRIEF = YES ABBREVIATE_BRIEF = \"The $name class\" \\ \"The $name widget\" \\ \"The $name file\" \\ is \\ provides \\ specifies \\ contains \\ represents \\ a \\ an \\ the ALWAYS_DETAILED_SEC = NO INLINE_INHERITED_MEMB = NO FULL_PATH_NAMES = YES STRIP_FROM_PATH = STRIP_FROM_INC_PATH = SHORT_NAMES = NO JAVADOC_AUTOBRIEF = NO QT_AUTOBRIEF = NO MULTILINE_CPP_IS_BRIEF = NO INHERIT_DOCS = YES SEPARATE_MEMBER_PAGES = NO TAB_SIZE = 4 ALIASES = TCL_SUBST = OPTIMIZE_OUTPUT_FOR_C = NO OPTIMIZE_OUTPUT_JAVA = NO OPTIMIZE_FOR_FORTRAN = NO OPTIMIZE_OUTPUT_VHDL = NO EXTENSION_MAPPING = MARKDOWN_SUPPORT = YES AUTOLINK_SUPPORT = YES BUILTIN_STL_SUPPORT = NO CPP_CLI_SUPPORT = NO SIP_SUPPORT = NO IDL_PROPERTY_SUPPORT = YES DISTRIBUTE_GROUP_DOC = NO SUBGROUPING = YES INLINE_GROUPED_CLASSES = NO INLINE_SIMPLE_STRUCTS = NO TYPEDEF_HIDES_STRUCT = NO LOOKUP_CACHE_SIZE = 0 #--------------------------------------------------------------------------- # Build related co","date":"2024-02-01","objectID":"/posts/cmake_note_45/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [45] ä½¿ç”¨Doxygenæ„å»ºæ–‡æ¡£","uri":"/posts/cmake_note_45/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º mkdir build \u0026 cd build cmake .. cmake --build . --target docs doxygen æ–‡æ¡£ ![Image](data:image/svg+xml,%3C%3Fxml version=â€˜1.0â€™ encoding=â€˜UTF-8â€™%3F%3E%3Csvg width=â€˜1pxâ€™ height=â€˜1pxâ€™ viewBox=â€˜0 0 1 1â€™ version=â€˜1.1â€™ xmlns=â€˜http://www.w3.org/2000/svg' xmlns:xlink=â€˜http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke=â€˜noneâ€™ stroke-width=â€˜1â€™ fill=â€˜noneâ€™ fill-rule=â€˜evenoddâ€™ fill-opacity=â€˜0â€™%3E%3Cg transform=â€˜translate(-249.000000, -126.000000)â€™ fill=â€™%23FFFFFFâ€™%3E%3Crect x=â€˜249â€™ y=â€˜126â€™ width=â€˜1â€™ height=â€˜1â€™%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E) ![Image](data:image/svg+xml,%3C%3Fxml version=â€˜1.0â€™ encoding=â€˜UTF-8â€™%3F%3E%3Csvg width=â€˜1pxâ€™ height=â€˜1pxâ€™ viewBox=â€˜0 0 1 1â€™ version=â€˜1.1â€™ xmlns=â€˜http://www.w3.org/2000/svg' xmlns:xlink=â€˜http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke=â€˜noneâ€™ stroke-width=â€˜1â€™ fill=â€˜noneâ€™ fill-rule=â€˜evenoddâ€™ fill-opacity=â€˜0â€™%3E%3Cg transform=â€˜translate(-249.000000, -126.000000)â€™ fill=â€™%23FFFFFFâ€™%3E%3Crect x=â€˜249â€™ y=â€˜126â€™ width=â€˜1â€™ height=â€˜1â€™%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E) cmake45 cmake Â· ç›®å½• ä¸Šä¸€ç¯‡CMake:éªŒè¯è‡ªå·±ç”Ÿæˆçš„åº“ People who liked this content also liked CMake:è¶…çº§æ„å»ºæ¨¡å¼ Hope Hut ä¸å–œæ¬¢ ä¸çœ‹çš„åŸå›  OK å†…å®¹è´¨é‡ä½ ä¸çœ‹æ­¤å…¬ä¼—å· å€¼å¾—è‹¦ç»ƒçš„100é“Pythonç»å…¸ç»ƒæ‰‹é¢˜ï¼Œï¼ˆé™„è¯¦ç»†ç­”æ¡ˆï¼‰å»ºè®®æ”¶è— ç¼–ç¨‹è¯¾ä»£è¡¨ ä¸å–œæ¬¢ ä¸çœ‹çš„åŸå›  OK å†…å®¹è´¨é‡ä½ ä¸çœ‹æ­¤å…¬ä¼—å· Deno 1.40ã€Shikiji 0.10ã€Mantine 7.5ã€Bun for Windowsã€Rsdoctorã€Zed å‰ç«¯ä»“åº“ ä¸å–œæ¬¢ ä¸çœ‹ ","date":"2024-02-01","objectID":"/posts/cmake_note_45/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [45] ä½¿ç”¨Doxygenæ„å»ºæ–‡æ¡£","uri":"/posts/cmake_note_45/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¼•ç”¨ ç»è¿‡ä¸Šä¸€ç¯‡ï¼ˆCMake:è¾“å‡ºåº“ï¼ˆåƒå…¶ä»–ä¼˜ç§€çš„åº“ä¸€æ ·ä¼˜é›…ï¼‰ï¼‰ï¼Œæˆ‘ä»¬å·²ç»æ„å»ºå‡ºäº†ä¼˜é›…çš„åº“ã€‚æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†åŸºäºä¸Šä¸€ç¯‡çš„å†…å®¹ï¼Œå†™ä¸€ä¸ªç®€å•çš„ä½¿ç”¨demoè¿›è¡ŒéªŒè¯ï¼ ","date":"2024-02-01","objectID":"/posts/cmake_note_44/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [44] éªŒè¯è‡ªå·±ç”Ÿæˆçš„åº“","uri":"/posts/cmake_note_44/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ use_message.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter9/04 ","date":"2024-02-01","objectID":"/posts/cmake_note_44/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [44] éªŒè¯è‡ªå·±ç”Ÿæˆçš„åº“","uri":"/posts/cmake_note_44/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  CMakeLists.txt cmake_minimum_required(VERSION 3.5 FATAL_ERROR) project(use-message LANGUAGES CXX ) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) set(CMAKE_PREFIX_PATH /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/03/output/share/cmake/example) find_package(message REQUIRED CONFIG) if(message_FOUND) message(STATUS \"Found message: (found version ${message_VERSION})\") endif() include_directories(/home/jiangli/repo/tutorials/cmake-tutorial/chapter9/03/output/include) add_executable(use_message use_message.cpp) target_link_libraries(use_message message::message-shared) å¼•ç”¨ è¿™é‡Œï¼Œæˆ‘ä»¬æ²¡æœ‰å¯¹æˆ‘ä»¬çš„åº“æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œæ‰€ä»¥ä¸ºäº†ä½¿find_packageå‘½ä»¤èƒ½å¤Ÿæ‰¾åˆ°æˆ‘ä»¬çš„åº“ï¼Œéœ€è¦åœ¨find_packageå‘½ä»¤å‰è®¾ç½®åº“æ‰€åœ¨çš„cmakeæ–‡ä»¶è·¯å¾„ã€‚ set(CMAKE_PREFIX_PATH /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/03/output/share/cmake/example) å¦‚æœæˆ‘ä»¬æŠŠç”Ÿæˆçš„åº“è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥çœç•¥æ‰è¿™ä¸€æ­¥éª¤ï¼ use_message.cpp #include \u003ccstdlib\u003e #include \u003ciostream\u003e #include \u003cmessage/message.hpp\u003e int main() { Message say_hello(\"Hello, CMake World!\"); std::cout \u003c\u003c say_hello \u003c\u003c std::endl; Message say_goodbye(\"Goodbye, CMake World\"); std::cout \u003c\u003c say_goodbye \u003c\u003c std::endl; return EXIT_SUCCESS; } ","date":"2024-02-01","objectID":"/posts/cmake_note_44/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [44] éªŒè¯è‡ªå·±ç”Ÿæˆçš„åº“","uri":"/posts/cmake_note_44/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º mkdir build \u0026 cd build cmake .. make . ./use_message éªŒè¯ç”Ÿæˆçš„åº“ ![Image](data:image/svg+xml,%3C%3Fxml version=â€˜1.0â€™ encoding=â€˜UTF-8â€™%3F%3E%3Csvg width=â€˜1pxâ€™ height=â€˜1pxâ€™ viewBox=â€˜0 0 1 1â€™ version=â€˜1.1â€™ xmlns=â€˜http://www.w3.org/2000/svg' xmlns:xlink=â€˜http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke=â€˜noneâ€™ stroke-width=â€˜1â€™ fill=â€˜noneâ€™ fill-rule=â€˜evenoddâ€™ fill-opacity=â€˜0â€™%3E%3Cg transform=â€˜translate(-249.000000, -126.000000)â€™ fill=â€™%23FFFFFFâ€™%3E%3Crect x=â€˜249â€™ y=â€˜126â€™ width=â€˜1â€™ height=â€˜1â€™%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E) ![Image](data:image/svg+xml,%3C%3Fxml version=â€˜1.0â€™ encoding=â€˜UTF-8â€™%3F%3E%3Csvg width=â€˜1pxâ€™ height=â€˜1pxâ€™ viewBox=â€˜0 0 1 1â€™ version=â€˜1.1â€™ xmlns=â€˜http://www.w3.org/2000/svg' xmlns:xlink=â€˜http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke=â€˜noneâ€™ stroke-width=â€˜1â€™ fill=â€˜noneâ€™ fill-rule=â€˜evenoddâ€™ fill-opacity=â€˜0â€™%3E%3Cg transform=â€˜translate(-249.000000, -126.000000)â€™ fill=â€™%23FFFFFFâ€™%3E%3Crect x=â€˜249â€™ y=â€˜126â€™ width=â€˜1â€™ height=â€˜1â€™%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E) cmake45 cmake Â· ç›®å½• ä¸Šä¸€ç¯‡CMake:è¾“å‡ºåº“ï¼ˆåƒå…¶ä»–ä¼˜ç§€çš„åº“ä¸€æ ·ä¼˜é›…ï¼‰ä¸‹ä¸€ç¯‡CMake:ä½¿ç”¨Doxygenæ„å»ºæ–‡æ¡£ People who liked this content also liked CMake:è¶…çº§æ„å»ºæ¨¡å¼ Hope Hut ä¸å–œæ¬¢ ä¸çœ‹çš„åŸå›  OK å†…å®¹è´¨é‡ä½ ä¸çœ‹æ­¤å…¬ä¼—å· CMake:ä½¿ç”¨å‡½æ•°å’Œå®é‡ç”¨ä»£ç  Hope Hut ä¸å–œæ¬¢ ä¸çœ‹çš„åŸå›  OK å†…å®¹è´¨é‡ä½ ä¸çœ‹æ­¤å…¬ä¼—å· CMake:ä½¿ç”¨Doxygenæ„å»ºæ–‡æ¡£ Hope Hut ä¸å–œæ¬¢ ä¸çœ‹çš„åŸå›  OK å†…å®¹è´¨é‡ä½ ä¸çœ‹æ­¤å…¬ä¼—å· Scan to Follow people underline ","date":"2024-02-01","objectID":"/posts/cmake_note_44/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [44] éªŒè¯è‡ªå·±ç”Ÿæˆçš„åº“","uri":"/posts/cmake_note_44/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¼•ç”¨ å‰é¢çš„ç¬”è®°ä¸­ï¼ˆCMakeï¼šé™æ€åº“å’ŒåŠ¨æ€åº“çš„è¯¦è§£(Linux/Windows)ï¼‰ï¼Œå±•ç¤ºäº†å¦‚ä½•è¾“å‡ºåŠ¨æ€åº“å’Œé™æ€åº“ï¼Œä½†æ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå¦‚åªè¾“å‡ºäº†å…¶å¤´æ–‡ä»¶ã€ç¬¦å·è¡¨å’Œåº“æ–‡ä»¶ï¼Œä½†å®é™…æˆ‘ä»¬å¸Œæœ›ï¼Œå½“å…¶ä»–äººç¼–è¯‘å¹¶å®‰è£…äº†æˆ‘ä»¬çš„åº“ï¼Œåº“å°±èƒ½æ›´å®¹æ˜“æ‰¾åˆ°ï¼Œå¦‚é…ç½®å®Œç¯å¢ƒå˜æ¢æˆ–è€…æŒ‡å®šåº“çš„è·¯å¾„ã€‚è¿™ç¯‡ç¬”è®°å°†å±•ç¤ºCMakeå¦‚ä½•è®©æˆ‘ä»¬å¯¼å‡ºç›®æ ‡ï¼Œä»¥ä¾¿å…¶ä»–ä½¿ç”¨CMakeçš„é¡¹ç›®å¯ä»¥è½»æ¾åœ°è·å–å®ƒä»¬ã€‚ ","date":"2024-02-01","objectID":"/posts/cmake_note_43/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [43] è¾“å‡ºåº“","uri":"/posts/cmake_note_43/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â””â”€â”€ messageConfig.cmake.in â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ src â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ hello_world.cpp â”‚ â”œâ”€â”€ message.cpp â”‚ â””â”€â”€ message.hpp â””â”€â”€ test â””â”€â”€ CMakeLists.txt é¡¹ç›®åœ°å€ https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter9/03 ","date":"2024-02-01","objectID":"/posts/cmake_note_43/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [43] è¾“å‡ºåº“","uri":"/posts/cmake_note_43/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  CMakeLists.txt # CMake 3.6 needed for IMPORTED_TARGET option # to pkg_search_module cmake_minimum_required(VERSION 3.6 FATAL_ERROR) project(example LANGUAGES CXX VERSION 1.0.0 ) # \u003c\u003c\u003c General set up \u003e\u003e\u003e set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) # æ£€æŸ¥æ˜¯å¦å·²ç»è®¾ç½®äº†å®‰è£…å‰ç¼€ if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) # è®¾ç½®å®‰è£…ç›®å½•ä¸ºé¡¹ç›®æºç›®å½•ä¸‹çš„outputæ–‡ä»¶å¤¹ set(CMAKE_INSTALL_PREFIX \"${CMAKE_SOURCE_DIR}/output/\" CACHE PATH \"...\" FORCE) endif() message(STATUS \"Project will be installed to ${CMAKE_INSTALL_PREFIX}\") if(NOT CMAKE_BUILD_TYPE) set(CMAKE_BUILD_TYPE Release CACHE STRING \"Build type\" FORCE) endif() message(STATUS \"Build type set to ${CMAKE_BUILD_TYPE}\") include(GNUInstallDirs) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/${CMAKE_INSTALL_BINDIR}) # Offer the user the choice of overriding the installation directories set(INSTALL_LIBDIR ${CMAKE_INSTALL_LIBDIR} CACHE PATH \"Installation directory for libraries\") set(INSTALL_BINDIR ${CMAKE_INSTALL_BINDIR} CACHE PATH \"Installation directory for executables\") set(INSTALL_INCLUDEDIR ${CMAKE_INSTALL_INCLUDEDIR} CACHE PATH \"Installation directory for header files\") if(WIN32 AND NOT CYGWIN) set(DEF_INSTALL_CMAKEDIR CMake) else() set(DEF_INSTALL_CMAKEDIR share/cmake/${PROJECT_NAME}) endif() set(INSTALL_CMAKEDIR ${DEF_INSTALL_CMAKEDIR} CACHE PATH \"Installation directory for CMake files\") # Report to user foreach(p LIB BIN INCLUDE CMAKE) file(TO_NATIVE_PATH ${CMAKE_INSTALL_PREFIX}/${INSTALL_${p}DIR} _path ) message(STATUS \"Installing ${p} components to ${_path}\") unset(_path) endforeach() add_subdirectory(src) enable_testing() add_subdirectory(test) ä¸Šè¿°cmakeåœ¨ä¸Šä¸€ç¯‡cmake:å¯¼å‡ºå¤´æ–‡ä»¶ç›¸å…³ä»£ç è¯¦ç»†åˆ†æè¿‡äº†ï¼Œè¯·ç§»æ­¥åˆ°ä¸Šä¸€ç¯‡å‚è€ƒã€‚ cmake/messageConfig.cmake.in @PACKAGE_INIT@ include(\"${CMAKE_CURRENT_LIST_DIR}/messageTargets.cmake\") check_required_components( \"message-shared\" \"message-static\" \"message-hello-world_wDSO\" \"message-hello-world_wAR\" ) # Remove dependency on UUID if on Windows if(NOT WIN32) if(NOT TARGET PkgConfig::UUID) find_package(PkgConfig REQUIRED QUIET) pkg_search_module(UUID REQUIRED uuid IMPORTED_TARGET) endif() endif() å¼•ç”¨ @PACKAGE_INIT@ å ä½ç¬¦å°†ä½¿ç”¨configure_package_config_fileå‘½ä»¤è¿›è¡Œæ›¿æ¢ã€‚å¦‚æœé¡¹ç›®æˆåŠŸæ„å»ºï¼Œé‚£ä¹ˆå°†åœ¨messageConfig.cmakeæ–‡ä»¶ä¸­è¿›è¡Œæ›¿æ¢ï¼š get_filename_component(PACKAGE_PREFIX_DIR \"${CMAKE_CURRENT_LIST_DIR}/../../../\" ABSOLUTE) macro(set_and_check _var _file) set(${_var} \"${_file}\") if(NOT EXISTS \"${_file}\") message(FATAL_ERROR \"File or directory ${_file} referenced by variable ${_var} does not exist !\") endif() endmacro() macro(check_required_components _NAME) foreach(comp ${${_NAME}_FIND_COMPONENTS}) if(NOT ${_NAME}_${comp}_FOUND) if(${_NAME}_FIND_REQUIRED_${comp}) set(${_NAME}_FOUND FALSE) endif() endif() endforeach() endmacro() å¼•ç”¨ include(\"${CMAKE_CURRENT_LIST_DIR}/messageTargets.cmake\") åŒ…å«ä¸ºç›®æ ‡è‡ªåŠ¨ç”Ÿæˆçš„å¯¼å‡ºæ–‡ä»¶ã€‚ å¼•ç”¨ check_required_components( \"message-shared\" \"message-static\" \"message-hello-world_wDSO\" \"message-hello-world_wAR\" ) æ£€æŸ¥é™æ€åº“å’ŒåŠ¨æ€åº“ï¼Œä»¥åŠä¸¤ä¸ªHello, Worldå¯æ‰§è¡Œæ–‡ä»¶æ˜¯å¦å¸¦æœ‰CMakeæä¾›çš„check_required_componentså‡½æ•°ã€‚ å¼•ç”¨ if(NOT WIN32) if(NOT TARGET PkgConfig::UUID) find_package(PkgConfig REQUIRED QUIET) pkg_search_module(UUID REQUIRED uuid IMPORTED_TARGET) endif() endif() æ£€æŸ¥ç›®æ ‡PkgConfig::UUIDæ˜¯å¦å­˜åœ¨ã€‚å¦‚æœæ²¡æœ‰ï¼Œå†æ¬¡æœç´¢UUIDåº“(åªåœ¨éWindowsæ“ä½œç³»ç»Ÿä¸‹æœ‰æ•ˆ)ã€‚ src/CMakeLists.txt # Search for pkg-config and UUID find_package(PkgConfig QUIET) if(PKG_CONFIG_FOUND) pkg_search_module(UUID uuid IMPORTED_TARGET) if(TARGET PkgConfig::UUID) message(STATUS \"Found libuuid\") set(UUID_FOUND TRUE) endif() endif() # \u003c\u003c\u003c Build targets \u003e\u003e\u003e # SHARED library add_library(message-shared SHARED \"\") include(GenerateExportHeader) generate_export_header(message-shared BASE_NAME \"message\" EXPORT_MACRO_NAME \"MESSAGE_LIB_API\" EXPORT_FILE_NAME \"${CMAKE_BINARY_DIR}/${INSTALL_INCLUDEDIR}/message_export.h\" STATIC_DEFINE \"MESSAGE_STATIC_DEFINE\" DEFINE_NO_DEPRECATED ) target_sources(message-shared PRIVATE ${C","date":"2024-02-01","objectID":"/posts/cmake_note_43/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [43] è¾“å‡ºåº“","uri":"/posts/cmake_note_43/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. $ cmake --build . --target install å®‰è£…æ ‘ç»“æ„ï¼š output â”œâ”€â”€ bin â”‚ â”œâ”€â”€ hello-world_wAR â”‚ â””â”€â”€ hello-world_wDSO â”œâ”€â”€ include â”‚ â””â”€â”€ message â”‚ â”œâ”€â”€ message_export.h â”‚ â””â”€â”€ message.hpp â”œâ”€â”€ lib â”‚ â”œâ”€â”€ libmessage_s.a â”‚ â”œâ”€â”€ libmessage.so -\u003e libmessage.so.1 â”‚ â””â”€â”€ libmessage.so.1 â””â”€â”€ share â””â”€â”€ cmake â””â”€â”€ example â”œâ”€â”€ messageConfig.cmake â”œâ”€â”€ messageConfigVersion.cmake â”œâ”€â”€ messageTargets.cmake â””â”€â”€ messageTargets-release.cmake ","date":"2024-02-01","objectID":"/posts/cmake_note_43/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [43] è¾“å‡ºåº“","uri":"/posts/cmake_note_43/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¼•ç”¨ å…¶å®ï¼Œæœ¬ç¯‡çš„ç›¸å…³å†…å®¹å·²ç»åœ¨CMakeï¼šé™æ€åº“å’ŒåŠ¨æ€åº“çš„è¯¦è§£(Linux/Windows)ç¬”è®°ä¸­å·²ç»è¯¦ç»†ä»‹ç»äº†å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼Œä¸”å±•ç¤ºäº†CMakeæä¾›äº†ä¸å¹³å°æ— å…³çš„æ–¹å¼å®ç°çš„åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œæ²¡æœ‰å¤„ç†ç¬¦å·å¯è§æ€§çš„é—®é¢˜ã€‚å…³äºç¬¦å·çš„å¯è§æ€§çš„æœ€ä½³æ–¹å¼æ˜¯è§„å®šåŠ¨æ€åº“åªå…¬å¼€æœ€å°çš„ç¬¦å·ï¼Œä»è€Œé™åˆ¶ä»£ç ä¸­å®šä¹‰çš„å¯¹è±¡å’Œå‡½æ•°å¯¹å¤–çš„å¯è§æ€§ã€‚ æˆ‘ä»¬å¸Œæœ›åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŠ¨æ€åº“å®šä¹‰çš„æ‰€æœ‰ç¬¦å·éƒ½å¯¹å¤–éšè—ã€‚è¿™å°†ä½¿å¾—é¡¹ç›®çš„è´¡çŒ®è€…ï¼Œèƒ½å¤Ÿæ¸…æ¥šåœ°åˆ’åˆ†åº“å’Œå¤–éƒ¨ä»£ç ä¹‹é—´çš„æ¥å£ï¼Œå› ä¸ºä»–ä»¬å¿…é¡»æ˜¾å¼åœ°æ ‡è®°æ‰€æœ‰è¦åœ¨é¡¹ç›®å¤–éƒ¨ä½¿ç”¨çš„ç¬¦å·ã€‚ ","date":"2024-02-01","objectID":"/posts/cmake_note_42/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [42] å¯¼å‡ºå¤´æ–‡ä»¶","uri":"/posts/cmake_note_42/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ src â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ hello_world.cpp â”‚ â”œâ”€â”€ message.cpp â”‚ â””â”€â”€ message.hpp â””â”€â”€ test â””â”€â”€ CMakeLists.txt é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter9/02 ","date":"2024-02-01","objectID":"/posts/cmake_note_42/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [42] å¯¼å‡ºå¤´æ–‡ä»¶","uri":"/posts/cmake_note_42/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  CMakeLists.txt # CMake 3.6 needed for IMPORTED_TARGET option # to pkg_search_module cmake_minimum_required(VERSION 3.6 FATAL_ERROR) project( example LANGUAGES CXX VERSION 1.0.0 ) # \u003c\u003c\u003c General set up \u003e\u003e\u003e set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) # æ£€æŸ¥æ˜¯å¦å·²ç»è®¾ç½®äº†å®‰è£…å‰ç¼€ if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) # è®¾ç½®å®‰è£…ç›®å½•ä¸ºé¡¹ç›®æºç›®å½•ä¸‹çš„outputæ–‡ä»¶å¤¹ set(CMAKE_INSTALL_PREFIX \"${CMAKE_SOURCE_DIR}/output/\" CACHE PATH \"...\" FORCE) endif() message(STATUS \"Project will be installed to ${CMAKE_INSTALL_PREFIX}\") if(NOT CMAKE_BUILD_TYPE) set(CMAKE_BUILD_TYPE Release CACHE STRING \"Build type\" FORCE) endif() message(STATUS \"Build type set to ${CMAKE_BUILD_TYPE}\") include(GNUInstallDirs) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/${CMAKE_INSTALL_BINDIR}) # Offer the user the choice of overriding the installation directories set(INSTALL_LIBDIR ${CMAKE_INSTALL_LIBDIR} CACHE PATH \"Installation directory for libraries\") set(INSTALL_BINDIR ${CMAKE_INSTALL_BINDIR} CACHE PATH \"Installation directory for executables\") set(INSTALL_INCLUDEDIR ${CMAKE_INSTALL_INCLUDEDIR} CACHE PATH \"Installation directory for header files\") if(WIN32 AND NOT CYGWIN) set(DEF_INSTALL_CMAKEDIR CMake) else() set(DEF_INSTALL_CMAKEDIR share/cmake/${PROJECT_NAME}) endif() set(INSTALL_CMAKEDIR ${DEF_INSTALL_CMAKEDIR} CACHE PATH \"Installation directory for CMake files\") # Report to user foreach(p LIB BIN INCLUDE CMAKE) file(TO_NATIVE_PATH ${CMAKE_INSTALL_PREFIX}/${INSTALL_${p}DIR} _path ) message(STATUS \"Installing ${p} components to ${_path}\") unset(_path) endforeach() add_subdirectory(src) enable_testing() add_subdirectory(test) src/CMakeLists.txt # Search for pkg-config and UUID find_package(PkgConfig QUIET) if(PKG_CONFIG_FOUND) pkg_search_module(UUID uuid IMPORTED_TARGET) if(TARGET PkgConfig::UUID) message(STATUS \"Found libuuid\") set(UUID_FOUND TRUE) endif() endif() # \u003c\u003c\u003c Build targets \u003e\u003e\u003e # SHARED library add_library(message-shared SHARED \"\") target_sources(message-shared PRIVATE ${CMAKE_CURRENT_LIST_DIR}/message.cpp ) target_compile_definitions(message-shared PUBLIC $\u003c$\u003cBOOL:${UUID_FOUND}\u003e:HAVE_UUID\u003e ) target_link_libraries(message-shared PUBLIC $\u003c$\u003cBOOL:${UUID_FOUND}\u003e:PkgConfig::UUID\u003e ) set_target_properties(message-shared PROPERTIES POSITION_INDEPENDENT_CODE 1 CXX_VISIBILITY_PRESET hidden VISIBILITY_INLINES_HIDDEN 1 SOVERSION ${PROJECT_VERSION_MAJOR} OUTPUT_NAME \"message\" DEBUG_POSTFIX \"_d\" PUBLIC_HEADER \"message.hpp;${CMAKE_BINARY_DIR}/${INSTALL_INCLUDEDIR}/message_export.h\" MACOSX_RPATH ON ) include(GenerateExportHeader) generate_export_header(message-shared BASE_NAME \"message\" EXPORT_MACRO_NAME \"MESSAGE_LIB_API\" EXPORT_FILE_NAME \"${CMAKE_BINARY_DIR}/${INSTALL_INCLUDEDIR}/message_export.h\" STATIC_DEFINE \"MESSAGE_STATIC_DEFINE\" DEFINE_NO_DEPRECATED ) target_include_directories(message-shared PUBLIC ${CMAKE_BINARY_DIR}/${INSTALL_INCLUDEDIR} ) # STATIC library add_library(message-static STATIC \"\") target_sources(message-static PRIVATE ${CMAKE_CURRENT_LIST_DIR}/message.cpp ) target_compile_definitions(message-static PUBLIC MESSAGE_STATIC_DEFINE $\u003c$\u003cBOOL:${UUID_FOUND}\u003e:HAVE_UUID\u003e ) target_include_directories(message-static PUBLIC ${CMAKE_BINARY_DIR}/${INSTALL_INCLUDEDIR} ) target_link_libraries(message-static PUBLIC $\u003c$\u003cBOOL:${UUID_FOUND}\u003e:PkgConfig::UUID\u003e ) set_target_properties(message-static PROPERTIES POSITION_INDEPENDENT_CODE 1 ARCHIVE_OUTPUT_NAME \"message\" DEBUG_POSTFIX \"_sd\" RELEASE_POSTFIX \"_s\" PUBLIC_HEADER \"message.hpp;${CMAKE_BINARY_DIR}/${INSTALL_INCLUDEDIR}/message_export.h\" ) # EXECUTABLES add_executable(hello-world_wDSO hello_world.cpp) target_link_libraries(hello-world_wDSO PUBLIC message-shared ) # Prepare RPATH file(RELATIVE_PATH _rel ${CMAKE_INSTALL_PREFIX}/${INSTALL_BINDIR} ${CMAKE_INSTALL_PREFIX}) if(APPLE) set(_rpath \"@loader_path/${","date":"2024-02-01","objectID":"/posts/cmake_note_42/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [42] å¯¼å‡ºå¤´æ–‡ä»¶","uri":"/posts/cmake_note_42/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º \u0026 mkdir build \u0026 cd build \u0026 cmake .. \u0026 cmake --build . --target install Scanning dependencies of target message-static [ 12%] Building CXX object src/CMakeFiles/message-static.dir/message.cpp.o [ 25%] Linking CXX static library ../lib/libmessage_s.a [ 25%] Built target message-static Scanning dependencies of target hello-world_wAR [ 37%] Building CXX object src/CMakeFiles/hello-world_wAR.dir/hello_world.cpp.o [ 50%] Linking CXX executable ../bin/hello-world_wAR [ 50%] Built target hello-world_wAR Scanning dependencies of target message-shared [ 62%] Building CXX object src/CMakeFiles/message-shared.dir/message.cpp.o [ 75%] Linking CXX shared library ../lib/libmessage.so [ 75%] Built target message-shared Scanning dependencies of target hello-world_wDSO [ 87%] Building CXX object src/CMakeFiles/hello-world_wDSO.dir/hello_world.cpp.o [100%] Linking CXX executable ../bin/hello-world_wDSO [100%] Built target hello-world_wDSO Install the project... -- Install configuration: \"Release\" -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/lib/libmessage.so.1 -- Up-to-date: /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/lib/libmessage.so -- Up-to-date: /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/include/message/message.hpp -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/include/message/message_export.h -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/lib/libmessage_s.a -- Up-to-date: /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/include/message/message.hpp -- Up-to-date: /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/include/message/message_export.h -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/bin/hello-world_wDSO -- Set runtime path of \"/home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/bin/hello-world_wDSO\" to \"$ORIGIN/../lib\" -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/02/output/bin/hello-world_wAR è¾“å‡ºï¼š å¯¼å¤„å¤´æ–‡ä»¶ ","date":"2024-02-01","objectID":"/posts/cmake_note_42/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [42] å¯¼å‡ºå¤´æ–‡ä»¶","uri":"/posts/cmake_note_42/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ è¿™ç¯‡ç¬”è®°ï¼Œå°†é€šè¿‡ä¸€ä¸ªå°é¡¹ç›®æ¥ä»‹ç»ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œè¿™äº›æ¦‚å¿µä¹Ÿå°†åœ¨åé¢çš„ç¬”è®°ä¸­ä½¿ç”¨ã€‚å®‰è£…æ–‡ä»¶ã€åº“å’Œå¯æ‰§è¡Œæ–‡ä»¶æ˜¯ä¸€é¡¹éå¸¸åŸºç¡€çš„ä»»åŠ¡ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ã€‚é€šè¿‡è¿™ç¯‡ç¬”è®°ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨CMakeæœ‰æ•ˆåœ°é¿å¼€è¿™äº›é—®é¢˜ã€‚ ","date":"2024-02-01","objectID":"/posts/cmake_note_41/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [41] å®‰è£…é¡¹ç›®","uri":"/posts/cmake_note_41/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ src â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ hello_world.cpp â”‚ â”œâ”€â”€ message.cpp â”‚ â””â”€â”€ message.hpp â””â”€â”€ test â””â”€â”€ CMakeLists.txt é¡¹ç›®åœ°å€ https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter9/01 ","date":"2024-02-01","objectID":"/posts/cmake_note_41/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [41] å®‰è£…é¡¹ç›®","uri":"/posts/cmake_note_41/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  src/CMakeLists.txt # Search for pkg-config and UUID find_package(PkgConfig QUIET) if(PKG_CONFIG_FOUND) pkg_search_module(UUID uuid IMPORTED_TARGET) if(TARGET PkgConfig::UUID) message(STATUS \"Found libuuid\") set(UUID_FOUND TRUE) endif() endif() # SHARED library add_library(message-shared SHARED \"\") target_sources(message-shared PRIVATE ${CMAKE_CURRENT_LIST_DIR}/message.cpp ) target_compile_definitions(message-shared PUBLIC $\u003c$\u003cBOOL:${UUID_FOUND}\u003e:HAVE_UUID\u003e ) target_link_libraries(message-shared PUBLIC $\u003c$\u003cBOOL:${UUID_FOUND}\u003e:PkgConfig::UUID\u003e ) set_target_properties(message-shared PROPERTIES POSITION_INDEPENDENT_CODE 1 SOVERSION ${PROJECT_VERSION_MAJOR} OUTPUT_NAME \"message\" DEBUG_POSTFIX \"_d\" PUBLIC_HEADER \"message.hpp\" MACOSX_RPATH ON WINDOWS_EXPORT_ALL_SYMBOLS ON ) add_executable(hello-world_wDSO hello_world.cpp) target_link_libraries(hello-world_wDSO PUBLIC message-shared ) # Prepare RPATH file(RELATIVE_PATH _rel ${CMAKE_INSTALL_PREFIX}/${INSTALL_BINDIR} ${CMAKE_INSTALL_PREFIX}) if(APPLE) set(_rpath \"@loader_path/${_rel}\") else() set(_rpath \"\\$ORIGIN/${_rel}\") endif() file(TO_NATIVE_PATH \"${_rpath}/${INSTALL_LIBDIR}\" message_RPATH) set_target_properties(hello-world_wDSO PROPERTIES MACOSX_RPATH ON SKIP_BUILD_RPATH OFF BUILD_WITH_INSTALL_RPATH OFF INSTALL_RPATH \"${message_RPATH}\" INSTALL_RPATH_USE_LINK_PATH ON ) # \u003c\u003c\u003c Install and export targets \u003e\u003e\u003e install( TARGETS message-shared hello-world_wDSO ARCHIVE DESTINATION ${INSTALL_LIBDIR} COMPONENT lib RUNTIME DESTINATION ${INSTALL_BINDIR} COMPONENT bin LIBRARY DESTINATION ${INSTALL_LIBDIR} COMPONENT lib PUBLIC_HEADER DESTINATION ${INSTALL_INCLUDEDIR}/message COMPONENT dev ) tips target_compile_definitions(message-shared PUBLIC $\u003c$\u003cBOOL:${UUID_FOUND}\u003e:HAVE_UUID\u003e ) å¦‚æœæˆ‘ä»¬æ‰¾åˆ°äº†ä¸‰æ–¹åº“UUIDçš„è¯ï¼Œè¯¥å‘½ä»¤ä¼šå°† HAVE_UUID ç¼–è¯‘å®šä¹‰æ·»åŠ åˆ°æ¶ˆæ¯å…±äº«ç›®æ ‡åŠå…¶ä¾èµ–åº“ä¸­ã€‚ å¼•ç”¨ è¿™æ®µ CMake è„šæœ¬ä½¿ç”¨äº† set_target_properties å‘½ä»¤æ¥ä¸º message-shared è¿™ä¸ªç›®æ ‡ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªåº“æˆ–å¯æ‰§è¡Œæ–‡ä»¶ï¼‰è®¾ç½®ä¸€ç³»åˆ—å±æ€§ã€‚ä¸‹é¢æˆ‘ä¼šç”¨ä¸­æ–‡è§£é‡Šè¿™äº›å±æ€§çš„å«ä¹‰ï¼š set_target_properties(message-shared PROPERTIES POSITION_INDEPENDENT_CODE 1 SOVERSION ${PROJECT_VERSION_MAJOR} OUTPUT_NAME \"message\" DEBUG_POSTFIX \"_d\" PUBLIC_HEADER \"message.hpp\" MACOSX_RPATH ON WINDOWS_EXPORT_ALL_SYMBOLS ON ) POSITION_INDEPENDENT_CODE 1: è®¾ç½®ä»£ç ä¸ºä½ç½®æ— å…³ä»£ç ã€‚è¿™å¯¹äºåˆ›å»ºå…±äº«åº“æ˜¯é‡è¦çš„ï¼Œå› ä¸ºå®ƒå…è®¸ä»£ç åœ¨å†…å­˜ä¸­çš„ä»»ä½•ä½ç½®è¿è¡Œï¼Œè¿™å¯¹äºå…±äº«åº“æ¥è¯´æ˜¯å¿…éœ€çš„ã€‚ SOVERSION ${PROJECT_VERSION_MAJOR}: è®¾ç½®å…±äº«å¯¹è±¡ç‰ˆæœ¬å·ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯é¡¹ç›®çš„ä¸»ç‰ˆæœ¬å·ã€‚ OUTPUT_NAME \"message\": æŒ‡å®šè¾“å‡ºçš„åç§°ã€‚å°½ç®¡ç›®æ ‡åç§°æ˜¯ message-sharedï¼Œåœ¨æ„å»ºæ—¶ç”Ÿæˆçš„æ–‡ä»¶å°†è¢«å‘½åä¸º messageï¼ˆä¾‹å¦‚ï¼Œmessage.dll æˆ– message.soï¼‰ã€‚ DEBUG_POSTFIX \"_d\": ä¸ºè°ƒè¯•ç‰ˆæœ¬çš„è¾“å‡ºæ·»åŠ åç¼€ã€‚åœ¨æ„å»ºè°ƒè¯•ç‰ˆæœ¬æ—¶ï¼Œè¾“å‡ºæ–‡ä»¶çš„åç§°ä¼šæœ‰ä¸€ä¸ªé¢å¤–çš„ _d åç¼€ï¼Œæœ‰åŠ©äºåŒºåˆ†è°ƒè¯•å’Œå‘å¸ƒç‰ˆæœ¬ã€‚ PUBLIC_HEADER \"message.hpp\": æŒ‡å®šå…¬å…±å¤´æ–‡ä»¶ã€‚ MACOSX_RPATH ON: åœ¨ macOS ç³»ç»Ÿä¸Šå¯ç”¨ RPATHã€‚è¿™æ˜¯ä¸€ç§åŠ¨æ€åº“æŸ¥æ‰¾è·¯å¾„çš„è®¾ç½®æ–¹æ³•ï¼Œæœ‰åŠ©äºåº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶æ‰¾åˆ°å…¶ä¾èµ–çš„å…±äº«åº“ã€‚ WINDOWS_EXPORT_ALL_SYMBOLS ON: åœ¨ Windows ä¸Šè‡ªåŠ¨å¯¼å‡ºæ‰€æœ‰ç¬¦å·ã€‚è¿™å¯¹äºåˆ›å»º DLLï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒç®€åŒ–äº†ç¬¦å·å¯¼å‡ºçš„è¿‡ç¨‹ã€‚ å¼•ç”¨ file(RELATIVE_PATH _rel ${CMAKE_INSTALL_PREFIX}/${INSTALL_BINDIR} ${CMAKE_INSTALL_PREFIX}) if(APPLE) set(_rpath \"@loader_path/${_rel}\") else() set(_rpath \"\\$ORIGIN/${_rel}\") endif() åœ¨è¿™ä¸ª CMake è„šæœ¬å‘½ä»¤ä¸­ï¼Œfile(RELATIVE_PATH ...) ç”¨äºè®¡ç®—ä¸¤ä¸ªè·¯å¾„ä¹‹é—´çš„ç›¸å¯¹è·¯å¾„ã€‚ è¿™ä¸ªå‘½ä»¤çš„ç›®çš„æ˜¯ä¸ºäº†æ‰¾å‡º ${CMAKE_INSTALL_PREFIX} ç›¸å¯¹äº ${CMAKE_INSTALL_PREFIX}/${INSTALL_BINDIR} çš„ç›¸å¯¹è·¯å¾„ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒåœ¨å¯»æ‰¾ä»å®‰è£…çš„äºŒè¿›åˆ¶ç›®å½•ï¼ˆINSTALL_BINDIRï¼‰åˆ°å®‰è£…çš„æ ¹ç›®å½•ï¼ˆCMAKE_INSTALL_PREFIXï¼‰çš„è·¯å¾„ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™å°†ç®€å•åœ°è§£æä¸ºä»äºŒè¿›åˆ¶ç›®å½•å‘ä¸Šåˆ°è¾¾æ ¹ç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼ˆæ¯”å¦‚ ../ æˆ–è€…æ›´å¤šçº§çš„ ../../ï¼Œå–å†³äº INSTALL_BINDIR çš„æ·±åº¦ï¼‰ã€‚ è¿™ç§ç±»å‹çš„è®¡ç®—åœ¨å¤„ç†å®‰è£…å’Œæ‰“åŒ…æ—¶éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“éœ€è¦å¤„ç†å¯ç§»æ¤æ€§å’Œä¸åŒç³»ç»Ÿç»“æ„æ—¶ã€‚é€šè¿‡è¿™æ ·çš„ç›¸å¯¹è·¯å¾„è®¾ç½®ï¼Œå¯ä»¥ç¡®ä¿ä¸ç®¡ä½ çš„è½¯ä»¶å®‰è£…åœ¨å“ªé‡Œï¼Œæ–‡ä»¶å’Œèµ„æºçš„ç›¸äº’å¼•ç”¨éƒ½æ˜¯æ­£ç¡®çš„ã€‚ è¿™æ®µ CMake è„šæœ¬ä»£ç ä½¿ç”¨ file(RELATIVE_PATH ...) å‘½ä»¤è®¡ç®—äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œå¹¶æ ¹æ®æ“ä½œç³»ç»Ÿç±»å‹ï¼ˆApple ç³»ç»Ÿæˆ–å…¶ä»–ï¼‰è®¾ç½®äº†ä¸€ä¸ªåä¸º _rpath çš„å˜é‡ï¼Œç”¨äºæŒ‡å®šåŠ¨æ€åº“çš„è¿è¡Œæ—¶æœç´¢è·¯å¾„ï¼ˆRPATHï¼‰ã€‚ä¸‹é¢æ˜¯è¯¦ç»†è§£é‡Šï¼š if(APPLE) å’Œ else(): è¿™ä¸¤è¡Œä»£ç æ£€æŸ¥å½“å‰æ˜¯å¦åœ¨ Apple ç³»ç»Ÿï¼ˆæ¯”å¦‚ macOSï¼‰ä¸Šè¿›è¡Œæ„å»ºã€‚å¦‚æœæ˜¯ï¼Œåœ¨ Apple ç³»ç»Ÿä¸Šä½¿ç”¨ä¸€ç§ RPATH è®¾ç½®æ–¹æ³•ï¼›å¦‚æœä¸æ˜¯ï¼ˆæ¯”å¦‚åœ¨ Linux æˆ– Windows ä¸Šï¼‰ï¼Œä½¿ç”¨å¦ä¸€ç§æ–¹æ³•ã€‚ set(_rpath \"@loader_path/${_rel}\"): åœ¨ Apple ç³»ç»Ÿä¸Šï¼Œ_rpath è¢«è®¾ç½®ä¸º \"@loader_path/${_rel}\"ã€‚è¿™é‡Œçš„ @loader_path æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ ‡è®°ï¼Œå®ƒè¡¨ç¤ºåŠ è½½åŠ¨æ€åº“çš„å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚è¿™ç§æ–¹æ³•å…è®¸åŠ¨æ€åº“åœ¨ä¸å¯æ‰§è¡Œæ–‡ä»¶ç›¸å¯¹çš„è·¯å¾„ä¸­è¢«æ‰¾åˆ°ã€‚ set(_rpath \"\\$ORIGIN/${_rel}\"): åœ¨é Apple ç³»ç»Ÿä¸Šï¼Œ_rpath è¢«è®¾ç½®ä¸º \"\\$ORIGIN/${_rel}\"ã€‚è¿™é‡Œçš„ $ORIGIN æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ ‡è®°ï¼Œå®ƒä¹Ÿè¡¨ç¤ºåŠ è½½åŠ¨æ€åº“çš„å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚ä¸ Apple ç³»ç»Ÿçš„æ–¹æ³•ç±»ä¼¼ï¼Œå®ƒä½¿å¾—åŠ¨æ€åº“å¯ä»¥åœ¨ç›¸å¯¹äºå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ä¸­è¢«æ‰¾åˆ°ã€‚ å¼•ç”¨ set_target_properties(hello-world_wDSO PROPERTIES MACOSX_RPATH ON SKIP_BUILD_RPATH OFF BUILD_WITH_INSTALL_RPATH OFF INSTALL_RPATH \"${message_RPATH}\" INSTALL_RPATH_USE_LINK_PATH ON ) ä½¿ç”¨ set_target_propert","date":"2024-02-01","objectID":"/posts/cmake_note_41/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [41] å®‰è£…é¡¹ç›®","uri":"/posts/cmake_note_41/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º mkdir build \u0026 cd build cmake .. cmake --build . --target install GNU/Linuxæ„å»ºç›®å½•çš„å†…å®¹å¦‚ä¸‹: â”œâ”€â”€ build â”œâ”€â”€ bin â”‚ â””â”€â”€ hello-world_wDSO â”œâ”€â”€ CMakeCache.txt â”œâ”€â”€ cmake_install.cmake â”œâ”€â”€ CTestTestfile.cmake â”œâ”€â”€ install_manifest.txt â”œâ”€â”€ lib â”‚ â”œâ”€â”€ libmessage.so -\u003e libmessage.so.1 â”‚ â””â”€â”€ libmessage.so.1 â”œâ”€â”€ Makefile â”œâ”€â”€ src â”œâ”€â”€ test â””â”€â”€ Testing åœ¨å®‰è£…ä½ç½®ï¼Œå¯ä»¥æ‰¾åˆ°å¦‚ä¸‹çš„ç›®å½•ç»“æ„: . â”œâ”€â”€ bin â”‚ â””â”€â”€ hello-world_wDSO â”œâ”€â”€ include â”‚ â””â”€â”€ message â”‚ â””â”€â”€ message.hpp â””â”€â”€ lib â”œâ”€â”€ libmessage.so -\u003e libmessage.so.1 â””â”€â”€ libmessage.so.1 ","date":"2024-02-01","objectID":"/posts/cmake_note_41/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [41] å®‰è£…é¡¹ç›®","uri":"/posts/cmake_note_41/"},{"categories":["C++"],"content":"äº”ã€è¡¥å……å†…å®¹ å®‰è£…åˆ°æ ‡å‡†ä½ç½® å¯¹äºé¡¹ç›®çš„å®‰è£…æ¥è¯´ï¼Œä»€ä¹ˆæ˜¯å¥½çš„å¸ƒå±€å‘¢ï¼Ÿå¦‚æœåªæœ‰è‡ªå·±ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œé‚£å°±æ— æ‰€è°“å¥½æˆ–åçš„å¸ƒå±€ã€‚ç„¶è€Œï¼Œä¸€æ—¦å‘å¤–éƒ¨å‘å¸ƒäº§å“ï¼Œå’Œä»–äººå…±ç”¨è¯¥é¡¹ç›®ï¼Œå°±åº”è¯¥åœ¨å®‰è£…é¡¹ç›®æ—¶æä¾›ä¸€ä¸ªåˆç†çš„å¸ƒå±€ã€‚ æˆ‘ä»¬å¯ä»¥éµå¾ªä¸€äº›æ ‡å‡†ï¼ŒCMakeå¯ä»¥å¸®åŠ©æˆ‘ä»¬åšåˆ°è¿™ä¸€ç‚¹ã€‚å®é™…ä¸Šï¼ŒGNUInstallDirs.cmakeæ¨¡å—æ‰€åšçš„å°±æ˜¯å®šä¹‰è¿™æ ·ä¸€ç»„å˜é‡ï¼Œè¿™äº›å˜é‡æ˜¯å®‰è£…ä¸åŒç±»å‹æ–‡ä»¶çš„å­ç›®å½•çš„åç§°ã€‚ CMAKE_INSTALL_BINDIRï¼šç”¨äºå®šä¹‰ç”¨æˆ·å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„å­ç›®å½•ï¼Œå³æ‰€é€‰å®‰è£…ç›®å½•ä¸‹çš„binç›®å½•ã€‚ CMAKE_INSTALL_LIBDIRï¼šå°†æ‰©å±•åˆ°ç›®æ ‡ä»£ç åº“(å³é™æ€åº“å’ŒåŠ¨æ€åº“)æ‰€åœ¨çš„å­ç›®å½•ã€‚åœ¨64ä½ç³»ç»Ÿä¸Šï¼Œå®ƒæ˜¯lib64ï¼Œè€Œåœ¨32ä½ç³»ç»Ÿä¸Šï¼Œå®ƒåªæ˜¯libã€‚ CMAKE_INSTALL_INCLUDEDIRï¼šä½¿ç”¨è¿™ä¸ªå˜é‡ä¸ºå¤´æ–‡ä»¶è·å–æ­£ç¡®çš„å­ç›®å½•ï¼Œè¯¥å˜é‡ä¸ºincludeã€‚ ç”¨æˆ·å¯èƒ½å¸Œæœ›è¦†ç›–è¿™äº›é€‰é¡¹ã€‚å…è®¸åœ¨ä¸»CMakeLists.txtæ–‡ä»¶ä¸­ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è¦†ç›–é€‰é¡¹: # Offer the user the choice of overriding the installation directories set(INSTALL_LIBDIR ${CMAKE_INSTALL_LIBDIR} CACHE PATH \"Installation directory for libraries\") set(INSTALL_BINDIR ${CMAKE_INSTALL_BINDIR} CACHE PATH \"Installation directory for executables\") set(INSTALL_INCLUDEDIR ${CMAKE_INSTALL_INCLUDEDIR} CACHE PATH \"Installation directory for header files\") é‡æ–°å®šä¹‰äº†åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„INSTALL_BINDIRã€INSTALL_LIBDIRå’ŒINSTALL_INCLUDEDIRå˜é‡ã€‚ å½“åªè¦æ±‚å®‰è£…åº“ï¼š $ cmake -D COMPONENT=lib -P cmake_install.cmake æ­£ç¡®è®¾ç½®RPATHå¯èƒ½ç›¸å½“éº»çƒ¦ï¼Œä½†è¿™å¯¹äºç”¨æˆ·æ¥è¯´æ— æ³•é¿å…ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒCMakeè®¾ç½®å¯æ‰§è¡Œç¨‹åºçš„RPATHï¼Œå‡è®¾å®ƒä»¬å°†ä»æ„å»ºæ ‘è¿è¡Œã€‚ä½†æ˜¯ï¼Œå®‰è£…ä¹‹åRPATHè¢«æ¸…é™¤ï¼Œå½“ç”¨æˆ·æƒ³è¦è¿è¡Œhello-world_wDSOæ—¶ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚ä½¿ç”¨Linuxä¸Šçš„lddå·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æ„å»ºæ ‘ä¸­çš„hello-world_wDSOå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿è¡Œldd hello-world_wDSOå°†å¾—åˆ°ä»¥ä¸‹ç»“æœ: libmessage.so.1 =\u003e /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/01/build/lib/libmessage.so.1 (0x00007f43a4df7000) åœ¨å®‰è£…ç›®å½•ä¸­è¿è¡Œldd hello-world_wDSOå°†å¾—åˆ°ä»¥ä¸‹ç»“æœ: libmessage.so.1 =\u003e Not found è¿™æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ã€‚ä½†æ˜¯ï¼Œæ€»æ˜¯ç¡¬ç¼–ç RPATHæ¥æŒ‡å‘æ„å»ºæ ‘æˆ–å®‰è£…ç›®å½•ä¹Ÿæ˜¯é”™è¯¯çš„ï¼šè¿™ä¸¤ä¸ªä½ç½®ä¸­çš„ä»»ä½•ä¸€ä¸ªéƒ½å¯èƒ½è¢«åˆ é™¤ï¼Œä»è€Œå¯¼è‡´å¯æ‰§è¡Œæ–‡ä»¶çš„æŸåã€‚ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆä¸ºæ„å»ºæ ‘å’Œå®‰è£…ç›®å½•ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶è®¾ç½®äº†ä¸åŒçš„RPATHï¼Œå› æ­¤å®ƒæ€»æ˜¯æŒ‡å‘â€œæœ‰æ„ä¹‰â€çš„ä½ç½®ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå°½å¯èƒ½æ¥è¿‘å¯æ‰§è¡Œæ–‡ä»¶ã€‚åœ¨æ„å»ºæ ‘ä¸­è¿è¡Œlddæ˜¾ç¤ºç›¸åŒçš„è¾“å‡º: libmessage.so.1 =\u003e /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/01/output/bin/./../lib/libmessage.so.1 (0x00007f0ebfc4a000) libmessage.so.1 =\u003e /home/jiangli/repo/tutorials/cmake-tutorial/chapter9/01/build/lib/libmessage.so.1 (0x00007f43a4df7000) ä½¿ç”¨äº†å¸¦æœ‰ç›®æ ‡å‚æ•°çš„CMakeå®‰è£…å‘½ä»¤ï¼Œè¯¥å‘½ä»¤è¿˜æœ‰å¦å¤–4ä¸ªå‚æ•°: FILESå’ŒPROGRAMSï¼Œåˆ†åˆ«ç”¨äºå®‰è£…æ–‡ä»¶æˆ–ç¨‹åºã€‚å®‰è£…åï¼Œå¹¶è®¾ç½®å®‰è£…æ–‡ä»¶é€‚å½“çš„æƒé™ã€‚å¯¹äºæ–‡ä»¶ï¼Œå¯¹æ‰€æœ‰è€…å…·æœ‰è¯»å’Œå†™æƒé™ï¼Œå¯¹ç»„ä»¥åŠå…¶ä»–ç”¨æˆ·å’Œç»„å…·æœ‰è¯»æƒé™ã€‚å¯¹äºç¨‹åºï¼Œå°†æˆäºˆæ‰§è¡Œæƒé™ã€‚æ³¨æ„ï¼ŒPROGRAMSè¦ä¸éæ„å»ºç›®æ ‡çš„å¯æ‰§è¡Œç¨‹åºä¸€èµ·ä½¿ç”¨ã€‚ DIRECTORYï¼Œç”¨äºå®‰è£…ç›®å½•ã€‚å½“åªç»™å‡ºä¸€ä¸ªç›®å½•åæ—¶ï¼Œå®ƒé€šå¸¸è¢«ç†è§£ä¸ºç›¸å¯¹äºå½“å‰æºç›®å½•ã€‚å¯ä»¥å¯¹ç›®å½•çš„å®‰è£…ç²’åº¦è¿›è¡Œæ§åˆ¶ã€‚ SCRIPTï¼Œå¯ä»¥ä½¿ç”¨å®ƒåœ¨CMakeè„šæœ¬ä¸­å®šä¹‰è‡ªå®šä¹‰å®‰è£…è§„åˆ™ã€‚ EXPORTï¼Œè¯¥å‚æ•°ç”¨äºå¯¼å‡ºç›®æ ‡ã€‚ ","date":"2024-02-01","objectID":"/posts/cmake_note_41/:5:0","tags":["CMake"],"title":"CMake ç¬”è®° | [41] å®‰è£…é¡¹ç›®","uri":"/posts/cmake_note_41/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ æ¯ä¸ªé¡¹ç›®éƒ½éœ€è¦å¤„ç†ä¾èµ–å…³ç³»ï¼Œä½¿ç”¨**CMakeå¾ˆå®¹æ˜“æŸ¥è¯¢è¿™äº›ä¾èµ–å…³ç³»ï¼Œæ˜¯å¦å­˜åœ¨äºé…ç½®é¡¹ç›®ä¸­ã€‚å‰é¢çš„ç¬”è®°ä¸­ï¼Œå±•ç¤ºäº†å¦‚ä½•æ‰¾åˆ°å®‰è£…åœ¨ç³»ç»Ÿä¸Šçš„ä¾èµ–é¡¹ï¼Œåˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬ä¸€ç›´ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚ä½†æ˜¯ï¼Œå½“ä¸æ»¡è¶³ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬åªèƒ½ä½¿é…ç½®å¤±è´¥ï¼Œå¹¶å‘ç”¨æˆ·è­¦å‘Šå¤±è´¥çš„åŸå› ã€‚ç„¶è€Œï¼Œä½¿ç”¨CMakeå¯ä»¥ç»„ç»‡æˆ‘ä»¬çš„é¡¹ç›®ï¼Œå¦‚æœåœ¨ç³»ç»Ÿä¸Šæ‰¾ä¸åˆ°ä¾èµ–é¡¹ï¼Œå°±å¯ä»¥è‡ªåŠ¨è·å–å’Œæ„å»ºä¾èµ–é¡¹ã€‚åç»­çš„å‡ ç¯‡ç¬”è®°å°†ä»‹ç»å’Œåˆ†æExternalProject.cmakeå’ŒFetchContent.cmakeæ ‡å‡†æ¨¡å—ï¼ŒåŠåœ¨è¶…çº§æ„å»ºæ¨¡å¼ä¸­çš„ä½¿ç”¨ã€‚å‰è€…å…è®¸åœ¨æ„å»ºæ—¶æ£€ç´¢é¡¹ç›®çš„ä¾èµ–é¡¹ï¼Œåè€…å…è®¸æˆ‘ä»¬åœ¨é…ç½®æ—¶æ£€ç´¢ä¾èµ–é¡¹(CMakeçš„3.11ç‰ˆæœ¬åæ·»åŠ )ã€‚ä½¿ç”¨è¶…çº§æ„å»ºæ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨CMakeä½œä¸ºåŒ…ç®¡ç†å™¨ï¼šç›¸åŒçš„é¡¹ç›®ä¸­ï¼Œå°†ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç†ä¾èµ–é¡¹ï¼Œæ— è®ºä¾èµ–é¡¹åœ¨ç³»ç»Ÿä¸Šæ˜¯å·²ç»å¯ç”¨ï¼Œè¿˜æ˜¯éœ€è¦é‡æ–°æ„å»ºã€‚** é¦–å…ˆé€šè¿‡ä¸€ä¸ªç®€å•ç¤ºä¾‹ï¼Œä»‹ç»è¶…çº§æ„å»ºæ¨¡å¼ã€‚æˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•ä½¿ç”¨**ExternalProject_Addå‘½ä»¤æ¥æ„å»ºä¸€ä¸ªçš„hello_worldç¨‹åºã€‚** ","date":"2024-01-31","objectID":"/posts/cmake_note_40/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [40] è¶…çº§æ„å»ºæ¨¡å¼","uri":"/posts/cmake_note_40/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ src â”œâ”€â”€ CMakeLists.txt â””â”€â”€ hello-world.cpp é¡¹ç›®ç»“æ„ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter8/01 ","date":"2024-01-31","objectID":"/posts/cmake_note_40/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [40] è¶…çº§æ„å»ºæ¨¡å¼","uri":"/posts/cmake_note_40/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  src/CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example_core LANGUAGES CXX) add_executable(hello-world hello_world.cpp) src/hello_world.cpp #include \u003ccstdlib\u003e #include \u003ciostream\u003e #include \u003cstring\u003e std::string say_hello() { return std::string(\"Hello, CMake superbuild world!\"); } int main() { std::cout \u003c\u003c say_hello() \u003c\u003c std::endl; return EXIT_SUCCESS; } CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) set_property(DIRECTORY PROPERTY EP_BASE ${CMAKE_BINARY_DIR}/subprojects) include(ExternalProject) ExternalProject_Add(${PROJECT_NAME}_core SOURCE_DIR ${CMAKE_CURRENT_LIST_DIR}/src CMAKE_ARGS -DCMAKE_CXX_COMPILER=${CMAKE_CXX_COMPILER} -DCMAKE_CXX_STANDARD=${CMAKE_CXX_STANDARD} -DCMAKE_CXX_EXTENSIONS=${CMAKE_CXX_EXTENSIONS} -DCMAKE_CXX_STANDARD_REQUIRED=${CMAKE_CXX_STANDARD_REQUIRED} CMAKE_CACHE_ARGS -DCMAKE_CXX_FLAGS:STRING=${CMAKE_CXX_FLAGS} BUILD_ALWAYS 1 INSTALL_COMMAND \"\" ) å¼•ç”¨ set_property(DIRECTORY PROPERTY EP_BASE ${CMAKE_BINARY_DIR}/subprojects) ä¸ºå½“å‰ç›®å½•å’Œåº•å±‚ç›®å½•è®¾ç½®EP_BASEç›®å½•å±æ€§ã€‚ å¼•ç”¨ include(ExternalProject) åŒ…æ‹¬ExternalProject.cmakeæ ‡å‡†æ¨¡å—ã€‚è¯¥æ¨¡å—æä¾›äº†ExternalProject_Addå‡½æ•°ã€‚ å¼•ç”¨ ExternalProject_Add(${PROJECT_NAME}_core SOURCE_DIR ${CMAKE_CURRENT_LIST_DIR}/src CMAKE_ARGS -DCMAKE_CXX_COMPILER=${CMAKE_CXX_COMPILER} -DCMAKE_CXX_STANDARD=${CMAKE_CXX_STANDARD} -DCMAKE_CXX_EXTENSIONS=${CMAKE_CXX_EXTENSIONS} -DCMAKE_CXX_STANDARD_REQUIRED=${CMAKE_CXX_STANDARD_REQUIRED} CMAKE_CACHE_ARGS -DCMAKE_CXX_FLAGS:STRING=${CMAKE_CXX_FLAGS} BUILD_ALWAYS 1 INSTALL_COMMAND \"\" ) Hello, Worldæºä»£ç é€šè¿‡è°ƒç”¨ExternalProject_Addå‡½æ•°ä½œä¸ºå¤–éƒ¨é¡¹ç›®æ·»åŠ çš„ã€‚å¤–éƒ¨é¡¹ç›®çš„åç§°ä¸ºexample_coreã€‚ ExternalProject_Addå‘½ä»¤å¯ç”¨äºæ·»åŠ ç¬¬ä¸‰æ–¹æºã€‚æœ¬ç¯‡é€šè¿‡å°†è‡ªå·±çš„é¡¹ç›®ï¼Œåˆ†ä¸ºä¸åŒCMakeé¡¹ç›®çš„é›†åˆç®¡ç†ã€‚æœ¬ä¾‹ä¸­ï¼Œä¸»CMakeLists.txtå’Œå­CMakeLists.txtéƒ½å£°æ˜äº†ä¸€ä¸ªCMakeé¡¹ç›®ï¼Œå®ƒä»¬éƒ½ä½¿ç”¨äº†projectå‘½ä»¤ã€‚ ExternalProject_Addæœ‰è®¸å¤šé€‰é¡¹ï¼Œå¯ç”¨äºå¤–éƒ¨é¡¹ç›®çš„é…ç½®å’Œç¼–è¯‘ç­‰æ‰€æœ‰æ–¹é¢ã€‚è¿™äº›é€‰æ‹©å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç±»: Directory:ç”¨äºè°ƒä¼˜æºç çš„ç»“æ„ï¼Œå¹¶ä¸ºå¤–éƒ¨é¡¹ç›®æ„å»ºç›®å½•ã€‚æœ¬ç¯‡ï¼Œæˆ‘ä»¬ä½¿ç”¨SOURCE_DIRé€‰é¡¹è®©CMakeçŸ¥é“æºæ–‡ä»¶åœ¨${CMAKE_CURRENT_LIST_DIR}/srcæ–‡ä»¶å¤¹ä¸­ã€‚ç”¨äºæ„å»ºé¡¹ç›®å’Œå­˜å‚¨ä¸´æ—¶æ–‡ä»¶çš„ç›®å½•ï¼Œä¹Ÿå¯ä»¥åœ¨æ­¤ç±»é€‰é¡¹æˆ–ç›®å½•å±æ€§ä¸­æŒ‡å®šã€‚é€šè¿‡è®¾ç½®EP_BASEç›®å½•å±æ€§ï¼ŒCMakeå°†æŒ‰ç…§ä»¥ä¸‹å¸ƒå±€ä¸ºå„ä¸ªå­é¡¹ç›®è®¾ç½®æ‰€æœ‰ç›®å½•: TMP_DIR = \u003cEP_BASE\u003e/tmp/\u003cname\u003e STAMP_DIR = \u003cEP_BASE\u003e/Stamp/\u003cname\u003e DOWNLOAD_DIR = \u003cEP_BASE\u003e/Download/\u003cname\u003e SOURCE_DIR = \u003cEP_BASE\u003e/Source/\u003cname\u003e BINARY_DIR = \u003cEP_BASE\u003e/Build/\u003cname\u003e INSTALL_DIR = \u003cEP_BASE\u003e/Install/\u003cname\u003e Downloadï¼šå¤–éƒ¨é¡¹ç›®çš„ä»£ç å¯èƒ½éœ€è¦ä»åœ¨çº¿å­˜å‚¨åº“æˆ–èµ„æºå¤„ä¸‹è½½ã€‚ Updateå’ŒPatchï¼šå¯ç”¨äºå®šä¹‰å¦‚ä½•æ›´æ–°å¤–éƒ¨é¡¹ç›®çš„æºä»£ç æˆ–å¦‚ä½•åº”ç”¨è¡¥ä¸ã€‚ Configureï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒCMakeä¼šå‡å®šå¤–éƒ¨é¡¹ç›®æ˜¯ä½¿ç”¨CMakeé…ç½®çš„ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å¹¶ä¸å±€é™äºè¿™ç§æƒ…å†µã€‚å¦‚æœå¤–éƒ¨é¡¹ç›®æ˜¯CMakeé¡¹ç›®ï¼ŒExternalProject_Addå°†è°ƒç”¨CMakeå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶ä¼ é€’é€‰é¡¹ã€‚å¯¹äºæœ¬ç¯‡ç¤ºä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡CMAKE_ARGSå’ŒCMAKE_CACHE_ARGSé€‰é¡¹ä¼ é€’é…ç½®å‚æ•°ã€‚å‰è€…ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°ç›´æ¥ä¼ é€’ï¼Œè€Œåè€…é€šè¿‡CMakeè„šæœ¬æ–‡ä»¶ä¼ é€’ã€‚å®é™…ï¼Œè„šæœ¬æ–‡ä»¶ä½äºbuild/subprojects/tmp/example_core/example_core- cache-.cmakeã€‚ç„¶åï¼Œé…ç½®å¦‚ä»¥ä¸‹æ‰€ç¤º: loading initial cache file /home/jiangli/repo/tutorials/cmake-tutorial/chapter8/01/build/subprojects/tmp/example_core/example_core-cache-.cmake -- The CXX compiler identification is GNU 9.4.0 -- Check for working CXX compiler: /usr/bin/c++ -- Check for working CXX compiler: /usr/bin/c++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter8/01/build/subprojects/Build/example_core Buildï¼šå¯ç”¨äºè°ƒæ•´å¤–éƒ¨é¡¹ç›®çš„å®é™…ç¼–è¯‘ã€‚æˆ‘ä»¬ä½¿ç”¨BUILD_ALWAYSé€‰é¡¹ç¡®ä¿å¤–éƒ¨é¡¹ç›®æ€»ä¼šé‡æ–°æ„å»ºã€‚ Installï¼šè¿™äº›é€‰é¡¹ç”¨äºé…ç½®åº”è¯¥å¦‚ä½•å®‰è£…å¤–éƒ¨é¡¹ç›®ã€‚æˆ‘ä»¬å°†INSTALL_COMMANDä¿ç•™ä¸ºç©ºã€‚ Testï¼šä¸ºåŸºäºæºä»£ç æ„å»ºçš„è½¯ä»¶è¿è¡Œæµ‹è¯•ã€‚ExternalProject_Addçš„è¿™ç±»é€‰é¡¹å¯ä»¥ç”¨äºæ­¤ç›®çš„ã€‚æˆ‘ä»¬çš„æ²¡æœ‰ä½¿ç”¨è¿™äº›é€‰é¡¹ï¼Œå› ä¸ºHello, Worldç¤ºä¾‹æ²¡æœ‰ä»»ä½•æµ‹è¯•ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_40/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [40] è¶…çº§æ„å»ºæ¨¡å¼","uri":"/posts/cmake_note_40/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º $ mkdir -p build $ cmake .. $ cmake --build . æ„å»ºç›®å½•çš„ç»“æ„ç¨å¾®å¤æ‚ä¸€äº›ï¼Œsubprojectsæ–‡ä»¶å¤¹çš„å†…å®¹å¦‚ä¸‹: build/subprojects/ â”œâ”€â”€ Build â”‚ â””â”€â”€ example_core â”‚ â”œâ”€â”€ CMakeCache.txt â”‚ â”œâ”€â”€ CMakeFiles â”‚ â”œâ”€â”€ cmake_install.cmake â”‚ â”œâ”€â”€ hello-world â”‚ â””â”€â”€ Makefile â”œâ”€â”€ Download â”‚ â””â”€â”€ example_core â”œâ”€â”€ Install â”‚ â””â”€â”€ example_core â”œâ”€â”€ Stamp â”‚ â””â”€â”€ exampleq_core â”‚ â”œâ”€â”€ example_core-configure â”‚ â”œâ”€â”€ example_core-done â”‚ â”œâ”€â”€ example_core-download â”‚ â”œâ”€â”€ example_core-install â”‚ â”œâ”€â”€ example_core-mkdir â”‚ â”œâ”€â”€ example_core-patch â”‚ â””â”€â”€ example_core-update â””â”€â”€ tmp â””â”€â”€ example_core â”œâ”€â”€ example_core-cache-.cmake â”œâ”€â”€ example_core-cfgcmd.txt â””â”€â”€ example_core-cfgcmd.txt.in è¡¥å……å†…å®¹ ExternalProject.cmakeå®šä¹‰äº†ExternalProject_Get_Propertyå‘½ä»¤ï¼Œè¯¥å‘½ä»¤å¯¹äºæ£€ç´¢å¤–éƒ¨é¡¹ç›®çš„å±æ€§éå¸¸æœ‰ç”¨ã€‚å¤–éƒ¨é¡¹ç›®çš„å±æ€§æ˜¯åœ¨é¦–æ¬¡è°ƒç”¨ExternalProject_Addå‘½ä»¤æ—¶è®¾ç½®çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨é…ç½®example_coreæ—¶ï¼Œæ£€ç´¢è¦ä¼ é€’ç»™CMakeçš„å‚æ•°å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•å®ç°: ExternalProject_Get_Property(${PROJECT_NAME}_core CMAKE_ARGS) message(STATUS \"CMAKE_ARGS of ${PROJECT_NAME}_core ${CMAKE_ARGS}\") ExternalProject.cmakeæ¨¡å—å®šä¹‰äº†ä»¥ä¸‹é™„åŠ å‘½ä»¤: ExternalProject_Add_Step: å½“æ·»åŠ äº†å¤–éƒ¨é¡¹ç›®ï¼Œæ­¤å‘½ä»¤å…è®¸å°†é™„åŠ çš„å‘½ä»¤ä½œä¸ºè‡ªå®šä¹‰æ­¥éª¤é”å®šåœ¨å…¶ä¸Šã€‚ ExternalProject_Add_StepTargets:å…è®¸å°†å¤–éƒ¨é¡¹ç›®ä¸­çš„æ­¥éª¤(ä¾‹å¦‚ï¼šæ„å»ºå’Œæµ‹è¯•æ­¥éª¤)å®šä¹‰ä¸ºå•ç‹¬çš„ç›®æ ‡ã€‚è¿™æ„å‘³ç€å¯ä»¥ä»å®Œæ•´çš„å¤–éƒ¨é¡¹ç›®ä¸­å•ç‹¬è§¦å‘è¿™äº›æ­¥éª¤ï¼Œå¹¶å…è®¸å¯¹é¡¹ç›®ä¸­çš„å¤æ‚ä¾èµ–é¡¹ï¼Œè¿›è¡Œç»†ç²’åº¦æ§åˆ¶ã€‚ ExternalProject_Add_StepDependencies:å¤–éƒ¨é¡¹ç›®çš„æ­¥éª¤æœ‰æ—¶å¯èƒ½ä¾èµ–äºå¤–éƒ¨ç›®æ ‡ï¼Œè€Œè¿™ä¸ªå‘½ä»¤çš„è®¾è®¡ç›®çš„å°±æ˜¯å¤„ç†è¿™äº›æƒ…å†µã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_40/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [40] è¶…çº§æ„å»ºæ¨¡å¼","uri":"/posts/cmake_note_40/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸Šä¸€ç¯‡çš„å¦ä¸€ç§æ–¹æ³•ï¼Œå¹¶ä¸ä½¿ç”¨add_subdirectoryçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨module includeç»„è£…ä¸åŒçš„CMakeLists.txtæ–‡ä»¶ã€‚å…¶å…è®¸æˆ‘ä»¬ä½¿ç”¨target_link_librariesé“¾æ¥åˆ°å½“å‰ç›®å½•ä¹‹å¤–å®šä¹‰çš„ç›®æ ‡ã€‚ å°±é¡¹ç›®æ¶æ„è€Œè¨€ï¼Œä¸æ¨èæœ¬ç¯‡çš„æ„å»ºæ–¹å¼ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_39/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [39] æ„å»ºé¡¹ç›®ç­–ç•¥åŠé™åˆ¶å˜é‡èŒƒå›´2","uri":"/posts/cmake_note_39/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ external â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ conversion.cpp â”‚ â””â”€â”€ conversion.hpp â”œâ”€â”€ src â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ evolution â”‚ â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”‚ â”œâ”€â”€ evolution.cpp â”‚ â”‚ â””â”€â”€ evolution.hpp â”‚ â”œâ”€â”€ initial â”‚ â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”‚ â”œâ”€â”€ initial.cpp â”‚ â”‚ â””â”€â”€ initial.hpp â”‚ â”œâ”€â”€ io â”‚ â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”‚ â”œâ”€â”€ io.cpp â”‚ â”‚ â””â”€â”€ io.hpp â”‚ â”œâ”€â”€ main.cpp â”‚ â””â”€â”€ parser â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ parser.cpp â”‚ â””â”€â”€ parser.hpp â””â”€â”€ tests â”œâ”€â”€ catch.hpp â”œâ”€â”€ CMakeLists.txt â””â”€â”€ test.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter7/08 ","date":"2024-01-31","objectID":"/posts/cmake_note_39/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [39] æ„å»ºé¡¹ç›®ç­–ç•¥åŠé™åˆ¶å˜é‡èŒƒå›´2","uri":"/posts/cmake_note_39/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  å°†ä½¿ç”¨ä¸ä¸Šä¸€ç¯‡ç›¸åŒçš„æºä»£ç ã€‚å”¯ä¸€çš„æ›´æ”¹å°†å‡ºç°åœ¨CMakeLists.txtæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢çš„éƒ¨åˆ†ä¸­è®¨è®ºè¿™äº›æ›´æ”¹ã€‚ CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) include(GNUInstallDirs) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_BINDIR}) # defines targets and sources include(src/CMakeLists.txt) include(external/CMakeLists.txt) enable_testing() add_subdirectory(tests) src/CMakeLists.txt add_library(automaton \"\") add_library(evolution \"\") include(${CMAKE_CURRENT_LIST_DIR}/evolution/CMakeLists.txt) include(${CMAKE_CURRENT_LIST_DIR}/initial/CMakeLists.txt) include(${CMAKE_CURRENT_LIST_DIR}/io/CMakeLists.txt) include(${CMAKE_CURRENT_LIST_DIR}/parser/CMakeLists.txt) add_executable(automata \"\") target_sources(automata PRIVATE ${CMAKE_CURRENT_LIST_DIR}/main.cpp ) target_link_libraries(automata PRIVATE automaton conversion ) src/evolution/CMakeLists.txt target_sources(automaton PRIVATE ${CMAKE_CURRENT_LIST_DIR}/evolution.cpp PUBLIC ${CMAKE_CURRENT_LIST_DIR}/evolution.hpp ) target_include_directories(automaton PUBLIC ${CMAKE_CURRENT_LIST_DIR} ) target_sources(evolution PRIVATE ${CMAKE_CURRENT_LIST_DIR}/evolution.cpp PUBLIC ${CMAKE_CURRENT_LIST_DIR}/evolution.hpp ) target_include_directories(evolution PUBLIC ${CMAKE_CURRENT_LIST_DIR} ) å…¶ä½™CMakeLists.txtæ–‡ä»¶å’Œsrc/initial/CMakeLists.txtç›¸åŒã€‚ src/initial/CMakeLists.txt target_sources(automaton PRIVATE ${CMAKE_CURRENT_LIST_DIR}/initial.cpp PUBLIC ${CMAKE_CURRENT_LIST_DIR}/initial.hpp ) target_include_directories(automaton PUBLIC ${CMAKE_CURRENT_LIST_DIR} ) å®šä¹‰äº†ä¸‰ä¸ªåº“: conversion(åœ¨externalå®šä¹‰) automaton(åŒ…å«é™¤è½¬æ¢ä¹‹å¤–çš„æ‰€æœ‰æº) evolution(åœ¨src/evolutionä¸­å®šä¹‰ï¼Œå¹¶é€šè¿‡cpp_testé“¾æ¥) æˆ‘ä»¬é€šè¿‡ä½¿ç”¨include()å¼•ç”¨CMakeLists.txtæ–‡ä»¶ï¼Œåœ¨çˆ¶èŒƒå›´å†…ï¼Œä»ç„¶èƒ½ä¿æŒæ‰€æœ‰ç›®æ ‡å¯ç”¨ã€‚ include(src/CMakeLists.txt) include(external/CMakeLists.txt) æ„å»ºä¸€ä¸ªåŒ…å«æ ‘ï¼Œè®°ä½å½“è¿›å…¥å­ç›®å½•(src/CMakeLists.txt)æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ç›¸å¯¹äºçˆ¶èŒƒå›´çš„è·¯å¾„: include(${CMAKE_CURRENT_LIST_DIR}/evolution/CMakeLists.txt) include(${CMAKE_CURRENT_LIST_DIR}/initial/CMakeLists.txt) include(${CMAKE_CURRENT_LIST_DIR}/io/CMakeLists.txt) include(${CMAKE_CURRENT_LIST_DIR}/parser/CMakeLists.txt) è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰å¹¶é“¾æ¥åˆ°é€šè¿‡include()è¯­å¥è®¿é—®æ–‡ä»¶æ ‘ä¸­ä»»ä½•ä½ç½®çš„ç›®æ ‡ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_39/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [39] æ„å»ºé¡¹ç›®ç­–ç•¥åŠé™åˆ¶å˜é‡èŒƒå›´2","uri":"/posts/cmake_note_39/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º $ cd build $ cmake .. $ cmake --build build $ ctest Running tests... Start 1: test_evolution 1/1 Test #1: test_evolution ................... Passed 0.00 sec 100% tests passed, 0 tests failed out of 1 è¡¥å……å†…å®¹ æˆ‘ä»¬å¯ä»¥å†æ¬¡ä½¿ç”¨CMakeå’ŒGraphvizç”Ÿæˆè¿™ä¸ªé¡¹ç›®çš„ä¾èµ–å…³ç³»å›¾: $ cd build $ cmake --graphviz=example.dot .. $ dot -T png example.dot -o example.png é¡¹ç›®ç»“æ„ ","date":"2024-01-31","objectID":"/posts/cmake_note_39/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [39] æ„å»ºé¡¹ç›®ç­–ç•¥åŠé™åˆ¶å˜é‡èŒƒå›´2","uri":"/posts/cmake_note_39/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ æˆ‘ä»¬å°†è®¨è®ºæ„å»ºé¡¹ç›®çš„ç­–ç•¥ï¼Œå¹¶é™åˆ¶å˜é‡çš„èŒƒå›´å’Œå‰¯ä½œç”¨ï¼Œç›®çš„æ˜¯é™ä½ä»£ç çš„å¤æ‚æ€§å’Œç®€åŒ–é¡¹ç›®çš„ç»´æŠ¤ã€‚æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†æŠŠä¸€ä¸ªé¡¹ç›®åˆ†å‰²æˆå‡ ä¸ªèŒƒå›´æœ‰é™çš„CMakeLists.txtæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶å°†ä½¿ç”¨add_subdirectoryå‘½ä»¤è¿›è¡Œå¤„ç†ã€‚ å°†æºæ–‡ä»¶åˆ†å‰²æˆæ›´å°ã€æ›´æ˜“äºç®¡ç†çš„å•å…ƒæ˜¯æœ‰æ„ä¹‰çš„ã€‚å¯ä»¥å°†æ‰€æœ‰æºä»£ç éƒ½ç¼–è¯‘æˆä¸€ä¸ªåº“æˆ–å¯æ‰§è¡Œæ–‡ä»¶ã€‚å®é™…ä¸Šï¼Œé¡¹ç›®æ›´å–œæ¬¢å°†æºä»£ç ç¼–è¯‘åˆ†æˆæ›´å°çš„ã€å®šä¹‰è‰¯å¥½çš„åº“ã€‚è¿™æ ·åšæ—¢æ˜¯ä¸ºäº†æœ¬åœ°åŒ–å’Œç®€åŒ–ä¾èµ–é¡¹ï¼Œä¹Ÿæ˜¯ä¸ºäº†ç®€åŒ–ä»£ç ç»´æŠ¤ã€‚è¿™æ„å‘³ç€å¦‚åœ¨è¿™é‡Œæ‰€åšçš„é‚£æ ·ï¼Œç”±è®¸å¤šåº“æ„å»ºä¸€ä¸ªé¡¹ç›®æ˜¯ä¸€ç§å¸¸è§çš„æƒ…å†µã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_38/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [38] æ„å»ºé¡¹ç›®çš„ç­–ç•¥åŠé™åˆ¶å˜é‡çš„èŒƒå›´å’Œå‰¯ä½œç”¨","uri":"/posts/cmake_note_38/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ external â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ conversion.cpp â”‚ â””â”€â”€ conversion.hpp â”œâ”€â”€ src â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ evolution â”‚ â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”‚ â”œâ”€â”€ evolution.cpp â”‚ â”‚ â””â”€â”€ evolution.hpp â”‚ â”œâ”€â”€ initial â”‚ â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”‚ â”œâ”€â”€ initial.cpp â”‚ â”‚ â””â”€â”€ initial.hpp â”‚ â”œâ”€â”€ io â”‚ â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”‚ â”œâ”€â”€ io.cpp â”‚ â”‚ â””â”€â”€ io.hpp â”‚ â”œâ”€â”€ main.cpp â”‚ â””â”€â”€ parser â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ parser.cpp â”‚ â””â”€â”€ parser.hpp â””â”€â”€ tests â”œâ”€â”€ catch.hpp â”œâ”€â”€ CMakeLists.txt â””â”€â”€ test.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter7/07 ","date":"2024-01-31","objectID":"/posts/cmake_note_38/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [38] æ„å»ºé¡¹ç›®çš„ç­–ç•¥åŠé™åˆ¶å˜é‡çš„èŒƒå›´å’Œå‰¯ä½œç”¨","uri":"/posts/cmake_note_38/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  æœ¬ç¯‡çš„ä»£ç ä»¥åŠé¡¹ç›®ç»“æ„æ¯”è¾ƒç®€å•ï¼Œå¹¶æœªæ¶‰åŠåˆ°æ–°çš„å†…å®¹ï¼Œæ‰€ä»¥ä»¥ä¸‹ä»£ç éƒ½æ²¡æœ‰å…·ä½“è®²è§£ï¼Œç›¸å…³ä»£ç çš„çŸ¥è¯†ç‚¹éƒ½åœ¨å‰é¢ç¬”è®°ä¸­ã€‚ CMakeLists.txt cmake_minimum_required(VERSION 3.5 FATAL_ERROR) project(recipe-07 LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) include(GNUInstallDirs) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_BINDIR}) # defines targets and sources add_subdirectory(src) # contains an \"external\" library we will link to add_subdirectory(external) # enable testing and define tests enable_testing() add_subdirectory(tests) external/conversion.hpp #pragma once #include \u003cstring\u003e std::string BinaryRepresentation(const int decimal); external/conversion.cpp #include \"conversion.hpp\" #include \u003cbitset\u003e std::string BinaryRepresentation(const int decimal) { return std::bitset\u003c8\u003e(decimal).to_string(); } external/CMakeLists.txt add_library(conversion \"\") target_sources(conversion PRIVATE ${CMAKE_CURRENT_LIST_DIR}/conversion.cpp PUBLIC ${CMAKE_CURRENT_LIST_DIR}/conversion.hpp ) target_include_directories(conversion PUBLIC ${CMAKE_CURRENT_LIST_DIR} ) src/CMakeLists.txt add_executable(automata main.cpp) add_subdirectory(evolution) add_subdirectory(initial) add_subdirectory(io) add_subdirectory(parser) target_link_libraries(automata PRIVATE conversion evolution initial io parser ) src/evolution/evolution.hpp #pragma once #include \u003cstring\u003e #include \u003cvector\u003e std::vector\u003cint\u003e Evolve(const std::vector\u003cint\u003e row, const std::string rule_binary); src/evolution/evolution.cpp #include \"evolution.hpp\" #include \u003cvector\u003e std::vector\u003cint\u003e Evolve(const std::vector\u003cint\u003e row, const std::string rule_binary) { std::vector\u003cint\u003e result; for (auto i = 0; i \u003c row.size(); ++i) { auto left = (i == 0 ? row.size() : i) - 1; auto center = i; auto right = (i + 1) % row.size(); auto ancestors = 4 * row[left] + 2 * row[center] + 1 * row[right]; ancestors = 7 - ancestors; auto new_state = std::stoi(rule_binary.substr(ancestors, 1)); result.push_back(new_state); } return result; } src/evolution/CMakeLists.txt add_library(evolution \"\") target_sources(evolution PRIVATE evolution.cpp PUBLIC ${CMAKE_CURRENT_LIST_DIR}/evolution.hpp ) target_include_directories(evolution PUBLIC ${CMAKE_CURRENT_LIST_DIR} ) src/initial/initial.hpp #pragma once #include \u003cvector\u003e std::vector\u003cint\u003e InitialDistribution(const int length); src/initial/initial.cpp #include \"initial.hpp\" #include \u003cvector\u003e std::vector\u003cint\u003e InitialDistribution(const int length) { // we start with a vector which is zeroed out std::vector\u003cint\u003e result(length, 0); // more or less in the middle we place a living cell result[length / 2] = 1; return result; } src/initial/CMakeLists.txt add_library(initial \"\") target_sources(initial PRIVATE initial.cpp PUBLIC ${CMAKE_CURRENT_LIST_DIR}/initial.hpp ) target_include_directories(initial PUBLIC ${CMAKE_CURRENT_LIST_DIR} ) src/io/io.hpp #pragma once #include \u003cvector\u003e void PrintRow(const std::vector\u003cint\u003e row); src/io/io.cpp #include \"io.hpp\" #include \u003calgorithm\u003e #include \u003ciostream\u003e #include \u003cvector\u003e void PrintRow(const std::vector\u003cint\u003e row) { std::for_each(row.begin(), row.end(), [](int const \u0026value) { std::cout \u003c\u003c (value == 1 ? '*' : ' '); }); std::cout \u003c\u003c std::endl; } src/io/CMakeLists.txt add_library(io \"\") target_sources(io PRIVATE io.cpp PUBLIC ${CMAKE_CURRENT_LIST_DIR}/io.hpp ) target_include_directories(io PUBLIC ${CMAKE_CURRENT_LIST_DIR} ) src/parser/parser.hpp #pragma once #include \u003ctuple\u003e std::tuple\u003cint, int, int\u003e ParseArguments(int argc, char *argv[]); src/parser/parser.cpp #include \"parser.hpp\" #include \u003ccassert\u003e #include \u003cstring\u003e #include \u003ctuple\u003e std::tuple\u003cint, int, int\u003e ParseArguments(int argc, char *argv[]) { assert(argc == 4 \u0026\u0026 \"program called with wrong number of arguments\"); auto length = std::stoi(argv[1]); auto num_steps = std::stoi(argv[2]); auto rule_decimal = std::stoi(argv[3]); ","date":"2024-01-31","objectID":"/posts/cmake_note_38/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [38] æ„å»ºé¡¹ç›®çš„ç­–ç•¥åŠé™åˆ¶å˜é‡çš„èŒƒå›´å’Œå‰¯ä½œç”¨","uri":"/posts/cmake_note_38/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. $ cmake --build . Scanning dependencies of target conversion [ 7%] Building CXX object external/CMakeFiles/conversion.dir/conversion.cpp.o [ 14%] Linking CXX static library ../lib64/libconversion.a [ 14%] Built target conversion Scanning dependencies of target evolution [ 21%] Building CXX object src/evolution/CMakeFiles/evolution.dir/evolution.cpp.o [ 28%] Linking CXX static library ../../lib64/libevolution.a [ 28%] Built target evolution Scanning dependencies of target initial [ 35%] Building CXX object src/initial/CMakeFiles/initial.dir/initial.cpp.o [ 42%] Linking CXX static library ../../lib64/libinitial.a [ 42%] Built target initial Scanning dependencies of target io [ 50%] Building CXX object src/io/CMakeFiles/io.dir/io.cpp.o [ 57%] Linking CXX static library ../../lib64/libio.a [ 57%] Built target io Scanning dependencies of target parser [ 64%] Building CXX object src/parser/CMakeFiles/parser.dir/parser.cpp.o [ 71%] Linking CXX static library ../../lib64/libparser.a [ 71%] Built target parser Scanning dependencies of target automata [ 78%] Building CXX object src/CMakeFiles/automata.dir/main.cpp.o [ 85%] Linking CXX executable ../bin/automata [ 85%] Built target automata Scanning dependencies of target cpp_test [ 92%] Building CXX object tests/CMakeFiles/cpp_test.dir/test.cpp.o [100%] Linking CXX executable ../bin/cpp_test [100%] Built target cpp_test $ ctest Running tests... Start 1: test_evolution 1/1 Test #1: test_evolution ................... Passed 0.00 sec 100% tests passed, 0 tests failed out of 1 è¡¥å……å†…å®¹ CMakeå¯ä»¥ä½¿ç”¨Graphvizå›¾å½¢å¯è§†åŒ–è½¯ä»¶ç”Ÿæˆé¡¹ç›®çš„ä¾èµ–å…³ç³»å›¾: $ cd build $ cmake --graphviz=example.dot .. $ dot -T png example.dot -o example.png cmake é¡¹ç›®å…³ç³»ä¾èµ–å›¾ ","date":"2024-01-31","objectID":"/posts/cmake_note_38/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [38] æ„å»ºé¡¹ç›®çš„ç­–ç•¥åŠé™åˆ¶å˜é‡çš„èŒƒå›´å’Œå‰¯ä½œç”¨","uri":"/posts/cmake_note_38/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ åºŸå¼ƒæ˜¯åœ¨ä¸æ–­å‘å±•çš„é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ä¸€ç§é‡è¦æœºåˆ¶ï¼Œå®ƒå‘å¼€å‘äººå‘˜å‘å‡ºä¿¡å·ï¼Œè¡¨æ˜å°†æ¥æŸä¸ªå‡½æ•°ã€å®æˆ–å˜é‡å°†è¢«åˆ é™¤æˆ–æ›¿æ¢ã€‚åœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œå‡½æ•°ã€å®æˆ–å˜é‡å°†ç»§ç»­å¯è®¿é—®ï¼Œä½†ä¼šå‘å‡ºè­¦å‘Šï¼Œæœ€ç»ˆå¯èƒ½ä¼šä¸Šå‡ä¸ºé”™è¯¯ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_37/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [37] ä½¿ç”¨åºŸå¼ƒå‡½æ•°ã€å®å’Œå˜é‡","uri":"/posts/cmake_note_37/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â””â”€â”€ custom_guard.cmake â””â”€â”€ CMakeLists.txt é¡¹ç›®ç»“æ„ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter7/06 ","date":"2024-01-31","objectID":"/posts/cmake_note_37/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [37] ä½¿ç”¨åºŸå¼ƒå‡½æ•°ã€å®å’Œå˜é‡","uri":"/posts/cmake_note_37/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES NONE) macro(custom_include_guard) if(NOT DEFINED included_modules) set(included_modules) endif() if (\"${CMAKE_CURRENT_LIST_FILE}\" IN_LIST included_modules) message(WARNING \"module ${CMAKE_CURRENT_LIST_FILE} processed more than once\") endif() list(APPEND included_modules ${CMAKE_CURRENT_LIST_FILE}) endmacro() function(deprecate_variable _variable _access) if(_access STREQUAL \"READ_ACCESS\") message(DEPRECATION \"variable ${_variable} is deprecated\") endif() endfunction() if (CMAKE_VERSION VERSION_GREATER \"3.9\") # deprecate custom_include_guard macro(custom_include_guard) message(DEPRECATION \"custom_include_guard is deprecated - use built-in include_guard instead\") _custom_include_guard(${ARGV}) endmacro() # deprecate variable included_modules variable_watch(included_modules deprecate_variable) endif() include(cmake/custom_guard.cmake) message(STATUS \"list of all included modules: ${included_modules}\") å¼•ç”¨ macro(custom_include_guard) if(NOT DEFINED included_modules) set(included_modules) endif() if (\"${CMAKE_CURRENT_LIST_FILE}\" IN_LIST included_modules) message(WARNING \"module ${CMAKE_CURRENT_LIST_FILE} processed more than once\") endif() list(APPEND included_modules ${CMAKE_CURRENT_LIST_FILE}) endmacro() å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„åŒ…å«ä¿æŠ¤æœºåˆ¶ï¼ŒåŒ…æ‹¬ä¸€ä¸ªè‡ªå®šä¹‰æ¨¡å—(ä¸ä¸Šä¸€ç¯‡å†…å®¹ç›¸åŒ)ï¼Œå¹¶æ‰“å°æ‰€æœ‰åŒ…å«æ¨¡å—çš„åˆ—è¡¨ã€‚å¯¹äºCMake 3.10æˆ–æ›´é«˜ç‰ˆæœ¬æœ‰å†…ç½®çš„include_guardã€‚ä½†æ˜¯ï¼Œä¸èƒ½ç®€å•åœ°åˆ é™¤custom_include_guardå’Œ${included_modules}ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªåºŸå¼ƒè­¦å‘Šæ¥å¼ƒç”¨å®å’Œå˜é‡ã€‚æŸä¸ªæ—¶å€™ï¼Œå¯ä»¥å°†è¯¥è­¦å‘Šè½¬æ¢ä¸ºFATAL_ERRORï¼Œä½¿ä»£ç åœæ­¢é…ç½®ï¼Œå¹¶è¿«ä½¿å¼€å‘äººå‘˜å¯¹ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œåˆ‡æ¢åˆ°å†…ç½®å‘½ä»¤ã€‚ å¼•ç”¨ åºŸå¼ƒå‡½æ•°ã€å®å’Œå˜é‡çš„æ–¹æ³•å¦‚ä¸‹: 1.å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨å®ƒæ¥å¼ƒç”¨ä¸€ä¸ªå˜é‡ function(deprecate_variable _variable _access) if(_access STREQUAL \"READ_ACCESS\") message(DEPRECATION \"variable ${_variable} is deprecated\") endif() endfunction() 2.å¦‚æœCMakeçš„ç‰ˆæœ¬å¤§äº3.9ï¼Œæˆ‘ä»¬é‡æ–°å®šä¹‰custom_include_guardå¹¶å°†variable_watché™„åŠ åˆ°included_modulesä¸­: if (CMAKE_VERSION VERSION_GREATER \"3.9\") # deprecate custom_include_guard macro(custom_include_guard) message(DEPRECATION \"custom_include_guard is deprecated - use built-in include_guard instead\") _custom_include_guard(${ARGV}) endmacro() # deprecate variable included_modules variable_watch(included_modules deprecate_variable) endif() cmake/custom_guard.cmake custom_include_guard() message(STATUS \"custom.cmake is included and processed\") ","date":"2024-01-31","objectID":"/posts/cmake_note_37/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [37] ä½¿ç”¨åºŸå¼ƒå‡½æ•°ã€å®å’Œå˜é‡","uri":"/posts/cmake_note_37/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. CMake3.10ä»¥ä¸‹ç‰ˆæœ¬çš„é¡¹ç›®ä¼šäº§ç”Ÿä»¥ä¸‹ç»“æœ: -- custom_custom.cmake is included and processed -- list of all included modules: /home/jiangli/repo/tutorials/cmake-tutorial/chapter7/06/cmake/custom.cmake CMake3.10ä»¥ä¸‹ç‰ˆæœ¬çš„é¡¹ç›®ä¼šäº§ç”Ÿä»¥ä¸‹ç»“æœ: CMake Deprecation Warning at CMakeLists.txt:26 (message): custom_include_guard is deprecated - use built-in include_guard instead Call Stack (most recent call first): cmake/custom_guard.cmake:1 (custom_include_guard) CMakeLists.txt:34 (include) -- custom_custom.cmake is included and processed CMake Deprecation Warning at CMakeLists.txt:19 (message): variable included_modules is deprecated Call Stack (most recent call first): CMakeLists.txt:9999 (deprecate_variable) CMakeLists.txt:36 (message) -- list of all included modules: /home/jiangli/repo/tutorials/cmake-tutorial/chapter7/06/cmake/custom_guard.cmake -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter7/06/build ","date":"2024-01-31","objectID":"/posts/cmake_note_37/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [37] ä½¿ç”¨åºŸå¼ƒå‡½æ•°ã€å®å’Œå˜é‡","uri":"/posts/cmake_note_37/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ å‰é¢çš„ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº†å‡½æ•°å’Œå®ï¼Œå¹¶ä½¿ç”¨äº†ä½ç½®å‚æ•°ã€‚æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªå¸¦æœ‰å‘½åå‚æ•°çš„å‡½æ•°ã€‚æˆ‘ä»¬å°†å¤ç”¨ç¬¬1èŠ‚ä¸­çš„ä»£ç ï¼Œä½¿ç”¨å‡½æ•°å’Œå®é‡ç”¨ä»£ç ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_36/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [36] ç”¨æŒ‡å®šå‚æ•°å®šä¹‰å‡½æ•°æˆ–å®","uri":"/posts/cmake_note_36/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â””â”€â”€ testing.cmake â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ src â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ main.cpp â”‚ â”œâ”€â”€ sum_integers.cpp â”‚ â””â”€â”€ sum_integers.hpp â””â”€â”€ tests â”œâ”€â”€ catch.hpp â”œâ”€â”€ CMakeLists.txt â””â”€â”€ test.cpp https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter7/04 ","date":"2024-01-31","objectID":"/posts/cmake_note_36/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [36] ç”¨æŒ‡å®šå‚æ•°å®šä¹‰å‡½æ•°æˆ–å®","uri":"/posts/cmake_note_36/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  cmake/testing.cmake function(add_catch_test) set(options) set(oneValueArgs NAME COST) set(multiValueArgs LABELS DEPENDS REFERENCE_FILES) cmake_parse_arguments(add_catch_test \"${options}\" \"${oneValueArgs}\" \"${multiValueArgs}\" ${ARGN} ) message(STATUS \"defining a test ...\") message(STATUS \" NAME: ${add_catch_test_NAME}\") message(STATUS \" LABELS: ${add_catch_test_LABELS}\") message(STATUS \" COST: ${add_catch_test_COST}\") message(STATUS \" REFERENCE_FILES: ${add_catch_test_REFERENCE_FILES}\") add_test( NAME ${add_catch_test_NAME} COMMAND $\u003cTARGET_FILE:cpp_test\u003e [${add_catch_test_NAME}] --success --out ${PROJECT_BINARY_DIR}/tests/${add_catch_test_NAME}.log --durations yes WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR} ) set_tests_properties(${add_catch_test_NAME} PROPERTIES LABELS \"${add_catch_test_LABELS}\" ) if(add_catch_test_COST) set_tests_properties(${add_catch_test_NAME} PROPERTIES COST ${add_catch_test_COST} ) endif() if(add_catch_test_DEPENDS) set_tests_properties(${add_catch_test_NAME} PROPERTIES DEPENDS ${add_catch_test_DEPENDS} ) endif() if(add_catch_test_REFERENCE_FILES) file( COPY ${add_catch_test_REFERENCE_FILES} DESTINATION ${CMAKE_CURRENT_BINARY_DIR} ) endif() endfunction() å¼•ç”¨ function(add_catch_test) set(options) set(oneValueArgs NAME COST) set(multiValueArgs LABELS DEPENDS REFERENCE_FILES) cmake_parse_arguments(add_catch_test \"${options}\" \"${oneValueArgs}\" \"${multiValueArgs}\" ${ARGN} ) ... endfunction() CMakeæä¾›cmake_parse_argumentså‘½ä»¤ï¼Œæˆ‘ä»¬ä½¿ç”¨å‡½æ•°å(add_catch_test)é€‰é¡¹(æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯none)ã€å•å€¼å‚æ•°(NAMEå’ŒCOST)å’Œå¤šå€¼å‚æ•°(LABELSã€DEPENDSå’ŒREFERENCE_FILES)è°ƒç”¨è¯¥å‘½ä»¤ã€‚ optionsã€oneValueArgs å’Œ multiValueArgs å®šä¹‰äº†å‡½æ•°å¯ä»¥æ¥å—çš„ä¸åŒå‚æ•°ç±»å‹ã€‚optionsæ˜¯å¸ƒå°”æ ‡å¿—ï¼ŒoneValueArgs æ¥å—ä¸€ä¸ªå€¼ï¼Œè€Œ multiValueArgs å¯ä»¥æ¥å—å¤šä¸ªå€¼ã€‚ cmake_parse_argumentså‘½ä»¤è§£æé€‰é¡¹å’Œå‚æ•°ï¼Œå¹¶å®šä¹‰å¦‚ä¸‹: add_catch_test_NAME add_catch_test_COST add_catch_test_LABELS add_catch_test_DEPENDS add_catch_test_REFERENCE_FILES è¿™ç§æ–¹æ³•ä½¿æˆ‘ä»¬æœ‰æœºä¼šç”¨æ›´å¥å£®çš„æ¥å£å’Œæ›´å…·æœ‰å¯è¯»çš„å‡½æ•°/å®è°ƒç”¨ï¼Œæ¥å®ç°å‡½æ•°å’Œå®ã€‚ å¼•ç”¨ add_test( NAME ${add_catch_test_NAME} COMMAND $\u003cTARGET_FILE:cpp_test\u003e [${add_catch_test_NAME}] --success --out ${PROJECT_BINARY_DIR}/tests/${add_catch_test_NAME}.log --durations yes WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR} ) NAME å’Œ COMMAND å‚æ•°åˆ†åˆ«æŒ‡å®šæµ‹è¯•åç§°å’Œè¿è¡Œæµ‹è¯•çš„å‘½ä»¤ã€‚ æµ‹è¯•è¢«é…ç½®ä¸ºå°†ç»“æœè¾“å‡ºåˆ°é¡¹ç›®äºŒè¿›åˆ¶ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚ å¼•ç”¨ set_tests_properties ç”¨äºä¸ºæµ‹è¯•åˆ†é…å±æ€§ã€‚è¿™äº›å±æ€§åŒ…æ‹¬: LABELS ï¼ˆæ ‡ç­¾ï¼‰ï¼Œç”¨äºå¯¹æµ‹è¯•è¿›è¡Œåˆ†ç±»ã€‚ COST(æˆæœ¬)ï¼Œç”¨äºæŒ‡å®šæµ‹è¯•çš„ç›¸å¯¹èµ„æºä½¿ç”¨é‡ã€‚ DEPENDS æŒ‡å®šå¿…é¡»åœ¨è¯¥æµ‹è¯•ä¹‹å‰è¿è¡Œçš„å…¶ä»–æµ‹è¯•ã€‚ if(add_catch_test_DEPENDS) set_tests_properties(${add_catch_test_NAME} PROPERTIES DEPENDS ${add_catch_test_DEPENDS} ) endif() å¦‚æœæŒ‡å®šäº†ä»»ä½•å‚è€ƒæ–‡ä»¶ï¼Œåˆ™ä½¿ç”¨ file(COPY ... DESTINATION ...) å‘½ä»¤å°†è¿™äº›æ–‡ä»¶å¤åˆ¶åˆ°å½“å‰äºŒè¿›åˆ¶ç›®å½•ã€‚è¿™å¯¹éœ€è¦å°†å…¶è¾“å‡ºä¸å·²çŸ¥è‰¯å¥½è¾“å‡ºè¿›è¡Œæ¯”è¾ƒçš„æµ‹è¯•éå¸¸æœ‰ç”¨ã€‚ tests/CMakeLists.txt add_executable(cpp_test test.cpp) target_link_libraries(cpp_test sum_integers) include(testing) add_catch_test( NAME short LABELS short cpp_test COST 1.5 ) add_catch_test( NAME long LABELS long cpp_test COST 2.5 ) CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) list(APPEND CMAKE_MODULE_PATH \"${CMAKE_CURRENT_SOURCE_DIR}/cmake\") include(GNUInstallDirs) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_BINDIR}) add_subdirectory(src) enable_testing() add_subdirectory(tests) ","date":"2024-01-31","objectID":"/posts/cmake_note_36/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [36] ç”¨æŒ‡å®šå‚æ•°å®šä¹‰å‡½æ•°æˆ–å®","uri":"/posts/cmake_note_36/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. -- ... -- defining a test ... -- NAME: short -- LABELS: short;cpp_test -- COST: 1.5 -- REFERENCE_FILES: -- defining a test ... -- NAME: long -- LABELS: long;cpp_test -- COST: 2.5 -- REFERENCE_FILES: -- ... cmake --build . ctest è¾“å‡ºç»“æœ ","date":"2024-01-31","objectID":"/posts/cmake_note_36/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [36] ç”¨æŒ‡å®šå‚æ•°å®šä¹‰å‡½æ•°æˆ–å®","uri":"/posts/cmake_note_36/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¼•ç”¨ æ¨¡å—åŒ…å«ä¸åº”è¯¥ç”¨ä½œå‡½æ•°è°ƒç”¨ï¼Œå› ä¸ºæ¨¡å—å¯èƒ½è¢«åŒ…å«å¤šæ¬¡ã€‚æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†ç¼–å†™æˆ‘ä»¬è‡ªå·±çš„åŒ…å«ä¿æŠ¤æœºåˆ¶ï¼Œå¦‚æœå¤šæ¬¡åŒ…å«ä¸€ä¸ªæ¨¡å—ï¼Œå°†è§¦å‘è­¦å‘Šã€‚å†…ç½®çš„include_guardå‘½ä»¤ä»3.10ç‰ˆå¼€å§‹å¯ä»¥ä½¿ç”¨ï¼Œå¯¹äºC/C++å¤´æ–‡ä»¶ï¼Œå®ƒçš„è¡Œä¸ºå°±åƒ#pragmaä¸€æ ·ã€‚å¯¹äºå½“å‰ç‰ˆæœ¬çš„CMakeï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•é‡æ–°å®šä¹‰å‡½æ•°å’Œå®ï¼Œå¹¶ä¸”å±•ç¤ºå¦‚ä½•æ£€æŸ¥CMakeç‰ˆæœ¬ï¼Œå¯¹äºä½äº3.10çš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®šåˆ¶çš„åŒ…å«ä¿æŠ¤æœºåˆ¶ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_35/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [35] é‡æ–°å®šä¹‰å‡½æ•°å’Œå®","uri":"/posts/cmake_note_35/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â”œâ”€â”€ custom.cmake â”‚ â””â”€â”€ include_guard.cmake â””â”€â”€ CMakeLists.txt é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter7/05 ç›¸å…³æºç  cmake/include_guard.cmake macro(include_guard) if (CMAKE_VERSION VERSION_LESS \"3.10\") # for CMake below 3.10 we define our # own include_guard(GLOBAL) message(STATUS \"calling our custom include_guard\") # if this macro is called the first time # we start with an empty list if(NOT DEFINED included_modules) set(included_modules) endif() if (\"${CMAKE_CURRENT_LIST_FILE}\" IN_LIST included_modules) message(WARNING \"module ${CMAKE_CURRENT_LIST_FILE} processed more than once\") endif() list(APPEND included_modules ${CMAKE_CURRENT_LIST_FILE}) else() # for CMake 3.10 or higher we augment # the built-in include_guard message(STATUS \"calling the built-in include_guard\") _include_guard(${ARGV}) endif() endmacro() å¼•ç”¨ macro(include_guard) if (CMAKE_VERSION VERSION_LESS \"3.10\") # ... else() # ... endif() endmacro() include_guardå®åŒ…å«ä¸¤ä¸ªåˆ†æ”¯ï¼Œä¸€ä¸ªç”¨äºCMakeä½äº3.10ï¼Œå¦ä¸€ä¸ªç”¨äºCMakeé«˜äº3.10ã€‚ å¼•ç”¨ message(STATUS \"calling our custom include_guard\") # if this macro is called the first time # we start with an empty list if(NOT DEFINED included_modules) set(included_modules) endif() if (\"${CMAKE_CURRENT_LIST_FILE}\" IN_LIST included_modules) message(WARNING \"module ${CMAKE_CURRENT_LIST_FILE} processed more than once\") endif() list(APPEND included_modules ${CMAKE_CURRENT_LIST_FILE}) å¦‚æœCMakeç‰ˆæœ¬ä½äº3.10ï¼Œè¿›å…¥ç¬¬ä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶ä¸”å†…ç½®çš„include_guardä¸å¯ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ªã€‚ å¦‚æœç¬¬ä¸€æ¬¡è°ƒç”¨å®ï¼Œåˆ™included_moduleså˜é‡æ²¡æœ‰å®šä¹‰ï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶è®¾ç½®ä¸ºç©ºåˆ—è¡¨ã€‚ç„¶åæ£€æŸ¥${CMAKE_CURRENT_LIST_FILE}æ˜¯å¦æ˜¯included_modulesåˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚å¦‚æœæ˜¯ï¼Œåˆ™ä¼šå‘å‡ºè­¦å‘Šï¼›å¦‚æœæ²¡æœ‰ï¼Œæˆ‘ä»¬å°†${CMAKE_CURRENT_LIST_FILE}è¿½åŠ åˆ°è¿™ä¸ªåˆ—è¡¨ã€‚CMakeè¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯è‡ªå®šä¹‰æ¨¡å—çš„ç¬¬äºŒä¸ªåŒ…å«ç¡®å®ä¼šå¯¼è‡´è­¦å‘Šã€‚ å¼•ç”¨ macro(include_guard) if (CMAKE_VERSION VERSION_LESS \"3.10\") # ... else() message(STATUS \"calling the built-in include_guard\") _include_guard(${ARGV}) endif() endmacro() CMake 3.10åŠæ›´é«˜ç‰ˆæœ¬çš„æƒ…å†µæœ‰æ‰€ä¸åŒï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­˜åœ¨ä¸€ä¸ªå†…ç½®çš„include_guardï¼Œæˆ‘ä»¬ç”¨è‡ªå·±çš„å®æ¥æ”¶åˆ°å‚æ•°å¹¶è°ƒç”¨å®ƒã€‚ è¿™é‡Œï¼Œ_include_guard(${ARGV})æŒ‡å‘å†…ç½®çš„include_guardã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯(è°ƒç”¨å†…ç½®çš„include_guard)è¿›è¡Œäº†æ‰©å±•ã€‚è¿™ç§æ¨¡å¼ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œæ¥é‡æ–°å®šä¹‰è‡ªå·±çš„æˆ–å†…ç½®çš„å‡½æ•°å’Œå®ï¼Œè¿™å¯¹äºè°ƒè¯•æˆ–è®°å½•æ—¥å¿—æ¥è¯´éå¸¸æœ‰ç”¨ã€‚ cmake/custom.cmake include_guard(GLOBAL) message(STATUS \"custom.cmake is included and processed\") CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES NONE) # (re)defines include_guard include(cmake/include_guard.cmake) # this is some custom module include(cmake/custom.cmake) # we simulate that we accidentally include the module a second time include(cmake/custom.cmake) ","date":"2024-01-31","objectID":"/posts/cmake_note_35/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [35] é‡æ–°å®šä¹‰å‡½æ•°å’Œå®","uri":"/posts/cmake_note_35/"},{"categories":["C++"],"content":"ä¸‰ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. CMake 3.10åŠæ›´é«˜ç‰ˆæœ¬çš„ç»“æœå¦‚ä¸‹: -- calling the built-in include_guard -- custom.cmake is included and processed -- calling the built-in include_guard CMake 3.10ä»¥ä¸‹çš„ç»“æœå¦‚ä¸‹: - calling our custom include_guard -- custom.cmake is included and processed -- calling our custom include_guard CMake Warning at cmake/include_guard.cmake:7 (message): module /home/user/example/cmake/custom.cmake processed more than once Call Stack (most recent call first): cmake/custom.cmake:1 (include_guard) CMakeLists.txt:12 (include) ","date":"2024-01-31","objectID":"/posts/cmake_note_35/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [35] é‡æ–°å®šä¹‰å‡½æ•°å’Œå®","uri":"/posts/cmake_note_35/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ å‰ä¸¤ç¯‡ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å®ã€‚æœ¬ç¯‡ï¼Œå°†ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥æŠ½è±¡ç»†èŠ‚å¹¶é¿å…ä»£ç é‡å¤ã€‚æˆ‘ä»¬å°†å®ç°ä¸€ä¸ªæ¥å—ç¼–è¯‘å™¨æ ‡å¿—åˆ—è¡¨çš„å‡½æ•°ã€‚è¯¥å‡½æ•°å°†å°è¯•ç”¨è¿™äº›æ ‡å¿—é€ä¸ªç¼–è¯‘æµ‹è¯•ä»£ç ï¼Œå¹¶è¿”å›ç¼–è¯‘å™¨ç†è§£çš„ç¬¬ä¸€ä¸ªæ ‡å¿—ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°†äº†è§£å‡ ä¸ªæ–°ç‰¹æ€§ï¼š****å‡½æ•°ã€åˆ—è¡¨æ“ä½œã€å­—ç¬¦ä¸²æ“ä½œï¼Œä»¥åŠæ£€æŸ¥ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒç›¸åº”çš„æ ‡å¿—ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_34/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [34] ç¼–å†™å‡½æ•°æ¥æµ‹è¯•å’Œè®¾ç½®ç¼–è¯‘å™¨æ ‡å¿—","uri":"/posts/cmake_note_34/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â””â”€â”€ set_compiler_flag.cmake â””â”€â”€ CMakeLists.txt https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter7/03 ç›¸å…³æºç  cmake/set_compiler_flag.cmake include(CheckCCompilerFlag) include(CheckCXXCompilerFlag) include(CheckFortranCompilerFlag) function(set_compiler_flag _result _lang) set(_list_of_flags) set(_flag_is_required FALSE) foreach(_arg IN ITEMS ${ARGN}) string(TOUPPER \"${_arg}\" _arg_uppercase) if(_arg_uppercase STREQUAL \"REQUIRED\") set(_flag_is_required TRUE) else() list(APPEND _list_of_flags \"${_arg}\") endif() endforeach() set(_flag_found FALSE) foreach(flag IN ITEMS ${_list_of_flags}) unset(_flag_works CACHE) if(_lang STREQUAL \"C\") check_c_compiler_flag(\"${flag}\" _flag_works) elseif(_lang STREQUAL \"CXX\") check_cxx_compiler_flag(\"${flag}\" _flag_works) elseif(_lang STREQUAL \"Fortran\") check_Fortran_compiler_flag(\"${flag}\" _flag_works) else() message(FATAL_ERROR \"Unknown language in set_compiler_flag: ${_lang}\") endif() if(_flag_works) set(${_result} \"${flag}\" PARENT_SCOPE) set(_flag_found TRUE) break() endif() endforeach() if(_flag_is_required AND NOT _flag_found) message(FATAL_ERROR \"None of the required flags were supported\") endif() endfunction() tips include(CheckCCompilerFlag) include(CheckCXXCompilerFlag) include(CheckFortranCompilerFlag) è¿™éƒ½æ˜¯æ ‡å‡†çš„CMakeæ¨¡å—ï¼ŒCMakeå°†åœ¨${CMAKE_MODULE_PATH}ä¸­æ‰¾åˆ°å®ƒä»¬ã€‚è¿™äº›æ¨¡å—åˆ†åˆ«æä¾›check_c_compiler_flagã€check_cxx_compiler_flagå’Œcheck_fortran_compiler_flagå®ã€‚ tips function(set_compiler_flag _result _lang) ... endfunction() set_compiler_flagå‡½æ•°éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œ_result(ä¿å­˜æˆåŠŸç¼–è¯‘æ ‡å¿—æˆ–ä¸ºç©ºå­—ç¬¦ä¸²)å’Œ_lang(æŒ‡å®šè¯­è¨€:Cã€C++æˆ–Fortran)ã€‚ æˆ‘ä»¬ä¹Ÿèƒ½è¿™æ ·è°ƒç”¨å‡½æ•°: set_compiler_flag(working_compile_flag C REQUIRED \"-Wall\" \"-warn all\") è¿™é‡Œæœ‰äº”ä¸ªè°ƒç”¨å‚æ•°ï¼Œä½†æ˜¯å‡½æ•°å¤´åªéœ€è¦ä¸¤ä¸ªå‚æ•°ã€‚è¿™æ„å‘³ç€REQUIREDã€-Wallå’Œ-warn allå°†æ”¾åœ¨${ARGN}ä¸­ã€‚ tips # build a list of flags from the arguments set(_list_of_flags) # also figure out whether the function # is required to find a flag set(_flag_is_required FALSE) foreach(_arg IN ITEMS ${ARGN}) string(TOUPPER \"${_arg}\" _arg_uppercase) if(_arg_uppercase STREQUAL \"REQUIRED\") set(_flag_is_required TRUE) else() list(APPEND _list_of_flags \"${_arg}\") endif() endforeach() ä½¿ç”¨foreachæ„å»ºä¸€ä¸ªæ ‡å¿—åˆ—è¡¨ã€‚åŒæ—¶ï¼Œä»æ ‡å¿—åˆ—è¡¨ä¸­è¿‡æ»¤å‡ºREQUIREDï¼Œå¹¶ä½¿ç”¨å®ƒæ¥è®¾ç½®_flag_is_requiredï¼Œå°†æ ‡å¿—åˆ—è¡¨ä¸­çš„å…¶ä»–å‚æ•°æ”¾åˆ°_list_of_flagsä¸­ã€‚ tips set(_flag_found FALSE) # loop over all flags, try to find the first which works foreach(flag IN ITEMS ${_list_of_flags}) unset(_flag_works CACHE) if(_lang STREQUAL \"C\") check_c_compiler_flag(\"${flag}\" _flag_works) elseif(_lang STREQUAL \"CXX\") check_cxx_compiler_flag(\"${flag}\" _flag_works) elseif(_lang STREQUAL \"Fortran\") check_Fortran_compiler_flag(\"${flag}\" _flag_works) else() message(FATAL_ERROR \"Unknown language in set_compiler_flag: ${_lang}\") endif() # if the flag works, use it, and exit # otherwise try next flag if(_flag_works) set(${_result} \"${flag}\" PARENT_SCOPE) set(_flag_found TRUE) break() endif() endforeach() ç°åœ¨ï¼Œæˆ‘ä»¬å°†å¾ªç¯${_list_of_flags}ï¼Œå°è¯•æ¯ä¸ªæ ‡å¿—ï¼Œå¦‚æœ_flag_worksè¢«è®¾ç½®ä¸ºTRUEï¼Œæˆ‘ä»¬å°†_flag_foundè®¾ç½®ä¸ºTRUEï¼Œå¹¶ä¸­æ­¢è¿›ä¸€æ­¥çš„æœç´¢ã€‚ unset(_flag_works CACHE)ç¡®ä¿check_*_compiler_flagçš„ç»“æœï¼Œä¸ä¼šåœ¨ä½¿ç”¨_flag_works resultå˜é‡æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ç¼“å­˜ç»“æœã€‚ å¼•ç”¨ if(_flag_works) set(${_result} \"${flag}\" PARENT_SCOPE) set(_flag_found TRUE) break() endif() å¦‚æœæ‰¾åˆ°äº†æ ‡å¿—ï¼Œå¹¶ä¸”_flag_worksè®¾ç½®ä¸ºTRUEï¼Œæˆ‘ä»¬å°±å°†_resultæ˜ å°„åˆ°çš„å˜é‡ã€‚ è¿™éœ€è¦ä½¿ç”¨PARENT_SCOPEæ¥å®Œæˆï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨ä¿®æ”¹ä¸€ä¸ªå˜é‡ï¼Œå¸Œæœ›æ‰“å°å¹¶åœ¨å‡½æ•°ä½“å¤–éƒ¨ä½¿ç”¨è¯¥å˜é‡ã€‚è¯·æ³¨æ„ï¼Œå¦‚ä½•ä½¿ç”¨${_result}è¯­æ³•è§£å¼•ç”¨ï¼Œä»çˆ¶èŒƒå›´ä¼ é€’çš„å˜é‡_resultçš„å€¼ã€‚ä¸ç®¡å‡½æ•°çš„åç§°æ˜¯ä»€ä¹ˆï¼Œè¿™å¯¹äºç¡®ä¿å·¥ä½œæ ‡å¿—è¢«è®¾ç½®éå¸¸æœ‰å¿…è¦ã€‚ å¼•ç”¨ # raise an error if no flag was found if(_flag_is_required AND NOT _flag_found) message(FATAL_ERROR \"None of the required flags were supported\") endif() å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•æ ‡å¿—ï¼Œå¹¶ä¸”è¯¥æ ‡å¿—è®¾ç½®äº†REQUIREDï¼Œé‚£æˆ‘ä»¬å°†ä½¿ç”¨ä¸€æ¡é”™è¯¯æ¶ˆæ¯åœæ­¢é…ç½®ã€‚ CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES C CXX) include(cmake/set_compiler_flag.cmake) set_compiler_flag( working_compile_flag C REQUIRED \"-foo\" # this should fail \"-wrong\" # this should fail \"-wrong\" # this should fail \"-Wall\" # this should work with GNU \"-warn all\" # this should work with Intel \"-Minform=inform\" # this should work with PGI \"-nope\" # this should fail ) message(STATUS \"working C compile flag: ${working_compile_flag}\") set_compiler_flag( working_compile_flag CXX ","date":"2024-01-31","objectID":"/posts/cmake_note_34/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [34] ç¼–å†™å‡½æ•°æ¥æµ‹è¯•å’Œè®¾ç½®ç¼–è¯‘å™¨æ ‡å¿—","uri":"/posts/cmake_note_34/"},{"categories":["C++"],"content":"ä¸‰ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. -- ... -- Performing Test _flag_works -- Performing Test _flag_works - Failed -- Performing Test _flag_works -- Performing Test _flag_works - Failed -- Performing Test _flag_works -- Performing Test _flag_works - Failed -- Performing Test _flag_works -- Performing Test _flag_works - Success -- working C compile flag: -Wall -- Performing Test _flag_works -- Performing Test _flag_works - Failed -- Performing Test _flag_works -- Performing Test _flag_works - Success -- working CXX compile flag: -g -- ... ","date":"2024-01-31","objectID":"/posts/cmake_note_34/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [34] ç¼–å†™å‡½æ•°æ¥æµ‹è¯•å’Œè®¾ç½®ç¼–è¯‘å™¨æ ‡å¿—","uri":"/posts/cmake_note_34/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ é¡¹ç›®é€šå¸¸ä»å•ä¸ª**CMakeLists.txtæ–‡ä»¶å¼€å§‹ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šé€æ¸å¢é•¿ã€‚æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºä¸€ç§å°†CMakeLists.txtåˆ†å‰²æˆæ›´å°å•å…ƒçš„æœºåˆ¶ã€‚å°†CMakeLists.txtæ‹†åˆ†ä¸ºæ¨¡å—çš„åŠ¨æœºï¼š** ä¸»CMakeLists.txtæ›´æ˜“äºé˜…è¯»ï¼› CMakeæ¨¡å—å¯ä»¥åœ¨å…¶ä»–é¡¹ç›®ä¸­é‡ç”¨ ä¸å‡½æ•°ç›¸ç»“åˆï¼Œæ¨¡å—å¯ä»¥å¸®åŠ©æˆ‘ä»¬é™åˆ¶å˜é‡çš„ä½œç”¨èŒƒå›´ã€‚ æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•å®šä¹‰å’ŒåŒ…å«ä¸€ä¸ªå®ï¼Œè¯¥å®å…è®¸æˆ‘ä»¬è·å¾—**CMakeçš„å½©è‰²è¾“å‡º(ç”¨äºé‡è¦çš„çŠ¶æ€æ¶ˆæ¯æˆ–è­¦å‘Š)ã€‚** ","date":"2024-01-31","objectID":"/posts/cmake_note_33/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [33] å°†æºç åˆ†æˆæ¨¡å—","uri":"/posts/cmake_note_33/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â””â”€â”€ colors.cmake â””â”€â”€ CMakeLists.txt https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter7/02 ç›¸å…³æºç  cmake/color.cmake # colorize CMake output macro(define_colors) if(WIN32) # has no effect on WIN32 set(ColourReset \"\") set(ColourBold \"\") set(Red \"\") set(Green \"\") set(Yellow \"\") set(Blue \"\") set(Magenta \"\") set(Cyan \"\") set(White \"\") set(BoldRed \"\") set(BoldGreen \"\") set(BoldYellow \"\") set(BoldBlue \"\") set(BoldMagenta \"\") set(BoldCyan \"\") set(BoldWhite \"\") else() string(ASCII 27 Esc) set(ColourReset \"${Esc}[m\") set(ColourBold \"${Esc}[1m\") set(Red \"${Esc}[31m\") set(Green \"${Esc}[32m\") set(Yellow \"${Esc}[33m\") set(Blue \"${Esc}[34m\") set(Magenta \"${Esc}[35m\") set(Cyan \"${Esc}[36m\") set(White \"${Esc}[37m\") set(BoldRed \"${Esc}[1;31m\") set(BoldGreen \"${Esc}[1;32m\") set(BoldYellow \"${Esc}[1;33m\") set(BoldBlue \"${Esc}[1;34m\") set(BoldMagenta \"${Esc}[1;35m\") set(BoldCyan \"${Esc}[1;36m\") set(BoldWhite \"${Esc}[1;37m\") endif() endmacro() CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES NONE) list(APPEND CMAKE_MODULE_PATH \"${CMAKE_CURRENT_SOURCE_DIR}/cmake\") include(colors) define_colors() message(STATUS \"This is a normal message\") message(STATUS \"${Red}This is a red${ColourReset}\") message(STATUS \"${BoldRed}This is a bold red${ColourReset}\") message(STATUS \"${Green}This is a green${ColourReset}\") message(STATUS \"${BoldMagenta}This is bold${ColourReset}\") å¼•ç”¨ list(APPEND CMAKE_MODULE_PATH \"${CMAKE_CURRENT_SOURCE_DIR}/cmake\") å°†cmakeå­ç›®å½•æ·»åŠ åˆ°CMakeæ¨¡å—æœç´¢çš„è·¯å¾„åˆ—è¡¨ä¸­ã€‚ tips include(colors) define_colors() åŒ…æ‹¬colors.cmakeæ¨¡å—ï¼Œè°ƒç”¨å…¶ä¸­å®šä¹‰çš„å®ã€‚ å¼•ç”¨ message(STATUS \"This is a normal message\") message(STATUS \"${Red}This is a red${ColourReset}\") message(STATUS \"${BoldRed}This is a bold red${ColourReset}\") message(STATUS \"${Green}This is a green${ColourReset}\") message(STATUS \"${BoldMagenta}This is bold${ColourReset}\") æ‰“å°äº†ä¸åŒé¢œè‰²çš„ä¿¡æ¯ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_33/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [33] å°†æºç åˆ†æˆæ¨¡å—","uri":"/posts/cmake_note_33/"},{"categories":["C++"],"content":"ä¸‰ã€ç»“æœå±•ç¤º mkdir build cd build cmake .. ç»“æœå±•ç¤º ","date":"2024-01-31","objectID":"/posts/cmake_note_33/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [33] å°†æºç åˆ†æˆæ¨¡å—","uri":"/posts/cmake_note_33/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ ä»»ä½•ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå‡½æ•°å…è®¸æˆ‘ä»¬æŠ½è±¡(éšè—)ç»†èŠ‚å¹¶é¿å…ä»£ç é‡å¤ï¼Œ****CMakeä¹Ÿä¸ä¾‹å¤–ã€‚æˆ‘ä»¬å°†ä»¥å®å’Œå‡½æ•°ä¸ºä¾‹è¿›è¡Œè®¨è®ºï¼Œå¹¶ä»‹ç»ä¸€ä¸ªå®ï¼Œä»¥ä¾¿æ–¹ä¾¿åœ°å®šä¹‰æµ‹è¯•å’Œè®¾ç½®æµ‹è¯•çš„é¡ºåºã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å®šä¹‰ä¸€ä¸ªå®ï¼Œèƒ½å¤Ÿæ›¿æ¢add_testå’Œset_tests_propertiesï¼Œç”¨äºå®šä¹‰æ¯ç»„å’Œè®¾ç½®æ¯ä¸ªæµ‹è¯•çš„é¢„æœŸå¼€é”€ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_32/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [32] ä½¿ç”¨å‡½æ•°å’Œå®é‡ç”¨ä»£ç ","uri":"/posts/cmake_note_32/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ src â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ main.cpp â”‚ â”œâ”€â”€ sum_integers.cpp â”‚ â””â”€â”€ sum_integers.hpp â””â”€â”€ tests â”œâ”€â”€ catch.hpp â”œâ”€â”€ CMakeLists.txt â””â”€â”€ test.cpp https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter7/01 ç›¸å…³æºç  CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) include(GNUInstallDirs) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_BINDIR}) add_subdirectory(src) enable_testing() add_subdirectory(tests) tips include(GNUInstallDirs) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_BINDIR}) æ ¹æ®GNUæ ‡å‡†å®šä¹‰binaryå’Œlibraryè·¯å¾„ã€‚ tips add_subdirectory(src) enable_testing() add_subdirectory(tests) ä½¿ç”¨add_subdirectoryè°ƒç”¨src/CMakeLists.txtå’Œtests/CMakeLists.txtã€‚ src/CMakeLists.txt set(CMAKE_INCLUDE_CURRENT_DIR_IN_INTERFACE ON) add_library(sum_integers sum_integers.cpp) add_executable(sum_up main.cpp) target_link_libraries(sum_up sum_integers) tips set(CMAKE_INCLUDE_CURRENT_DIR_IN_INTERFACE ON) è¿™ä¸ªå‘½ä»¤ä¼šå°†å½“å‰ç›®å½•ï¼Œæ·»åŠ åˆ°CMakeLists.txtä¸­å®šä¹‰çš„æ‰€æœ‰ç›®æ ‡çš„interface_include_directoryå±æ€§ä¸­ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨target_include_directoryæ¥æ·»åŠ cpp_testæ‰€éœ€å¤´æ–‡ä»¶çš„ä½ç½®ã€‚ src/sun_integers.hpp #ifndef SUM_INTEGERS_H #define SUM_INTEGERS_H #include \u003cvector\u003e int sum_integers(const std::vector\u003cint\u003e \u0026integers); #endif // ! SUM_INTEGERS_H src/sun_integers.cpp #include \"sum_integers.hpp\" int sum_integers(const std::vector\u003cint\u003e\u0026 integers) { auto sum = 0; for (auto i : integers) { sum += i; } return sum; } src/main.cpp #include \u003ciostream\u003e #include \u003cstring\u003e #include \"sum_integers.hpp\" int main(int argc, char *argv[]) { std::vector\u003cint\u003e integers; for (auto i = 1; i \u003c argc; i++) { integers.push_back(std::stoi(argv[i])); } auto sum = sum_integers(integers); std::cout \u003c\u003c sum \u003c\u003c std::endl; return 0; } tests/CMakeLists.txt add_executable(cpp_test test.cpp) target_link_libraries(cpp_test sum_integers) macro(add_catch_test _name _cost) math(EXPR num_macro_calls \"${num_macro_calls} + 1\") message(STATUS \"add_catch_test called with ${ARGC} arguments: ${ARGV}\") set(_argn \"${ARGN}\") if(_argn) message(STATUS \"oops - macro received argument(s) we did not expect: ${ARGN}\") endif() add_test( NAME ${_name} COMMAND $\u003cTARGET_FILE:cpp_test\u003e [${_name}] --success --out ${PROJECT_BINARY_DIR}/tests/${_name}.log --durations yes WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR} ) set_tests_properties( ${_name} PROPERTIES COST ${_cost} ) endmacro() set(num_macro_calls 0) add_catch_test(short 1.5) add_catch_test(long1 2.5) add_catch_test(long2 3.0 extra_argument) message(STATUS \"in total there were ${num_macro_calls} calls to add_catch_test\") tips macro(add_catch_test _name _cost) math(EXPR num_macro_calls \"${num_macro_calls} + 1\") message(STATUS \"add_catch_test called with ${ARGC} arguments: ${ARGV}\") set(_argn \"${ARGN}\") if(_argn) message(STATUS \"oops - macro received argument(s) we did not expect: ${ARGN}\") endif() add_test( NAME ${_name} COMMAND $\u003cTARGET_FILE:cpp_test\u003e [${_name}] --success --out ${PROJECT_BINARY_DIR}/tests/${_name}.log --durations yes WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR} ) set_tests_properties( ${_name} PROPERTIES COST ${_cost} ) endmacro() è¿™ä¸ªé…ç½®ä¸­æ–°æ·»åŠ äº†add_catch_testå®ã€‚è¿™ä¸ªå®éœ€è¦ä¸¤ä¸ªå‚æ•°_nameå’Œ_costï¼Œå¯ä»¥åœ¨å®ä¸­ä½¿ç”¨è¿™äº›å‚æ•°æ¥è°ƒç”¨add_testå’Œset_tests_propertiesã€‚å‚æ•°å‰é¢çš„ä¸‹åˆ’çº¿ï¼Œæ˜¯ä¸ºäº†è¡¨æ˜è¿™äº›å‚æ•°åªèƒ½åœ¨å®ä¸­è®¿é—®ã€‚å¦å¤–ï¼Œå®è‡ªåŠ¨å¡«å……äº†${ARGC}(å‚æ•°æ•°é‡)å’Œ${ARGV}(å‚æ•°åˆ—è¡¨)ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¾“å‡ºä¸­éªŒè¯äº†è¿™ä¸€ç‚¹: -- add_catch_test called with 2 arguments: short;1.5 -- add_catch_test called with 3 arguments: long;2.5;extra_argument å®è¿˜å®šä¹‰äº†${ARGN}ï¼Œç”¨äºä¿å­˜æœ€åä¸€ä¸ªå‚æ•°ä¹‹åçš„å‚æ•°åˆ—è¡¨ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨${ARGV0}ã€${ARGV1}ç­‰æ¥å¤„ç†å‚æ•°ã€‚æˆ‘ä»¬æ¼”ç¤ºä¸€ä¸‹ï¼Œå¦‚ä½•æ•æ‰åˆ°è°ƒç”¨ä¸­çš„é¢å¤–å‚æ•°(extra_argument): add_catch_test(long 2.5 extra_argument) ä½¿ç”¨äº†ä»¥ä¸‹æ–¹æ³•: set(_ar","date":"2024-01-31","objectID":"/posts/cmake_note_32/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [32] ä½¿ç”¨å‡½æ•°å’Œå®é‡ç”¨ä»£ç ","uri":"/posts/cmake_note_32/"},{"categories":["C++"],"content":"ä¸‰ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. -- ... -- add_catch_test called with 2 arguments: short;1.5 -- add_catch_test called with 3 arguments: long;2.5;extra_argument -- oops - macro received argument(s) we did not expect: extra_argument -- in total there were 2 calls to add_catch_test -- ... æ„å»ºå¹¶è¿è¡Œæµ‹è¯• $ cmake --build . $ ctest æµ‹è¯•ç»“æœå±•ç¤º ","date":"2024-01-31","objectID":"/posts/cmake_note_32/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [32] ä½¿ç”¨å‡½æ•°å’Œå®é‡ç”¨ä»£ç ","uri":"/posts/cmake_note_32/"},{"categories":["C++"],"content":"å››ã€è¡¥å……å†…å®¹ ä¸Šè¿°å†…å®¹ä¸­çš„ä½¿ç”¨å®å®šä¹‰çš„æ–¹æ³•æ›¿æ¢add_testã€add_tests_propertiesçš„æ–¹æ³•å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥å®ç°ï¼š function(add_catch_test _name _cost) ... endfunction() å®å’Œå‡½æ•°ä¹‹é—´çš„åŒºåˆ«åœ¨äºå®ƒä»¬çš„å˜é‡èŒƒå›´ã€‚å®åœ¨è°ƒç”¨è€…çš„èŒƒå›´å†…æ‰§è¡Œï¼Œè€Œå‡½æ•°æœ‰è‡ªå·±çš„å˜é‡èŒƒå›´ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å®ï¼Œéœ€è¦è®¾ç½®æˆ–ä¿®æ”¹å¯¹è°ƒç”¨è€…å¯ç”¨çš„å˜é‡ã€‚å¦‚æœä¸å»è®¾ç½®æˆ–ä¿®æ”¹è¾“å‡ºå˜é‡ï¼Œæœ€å¥½ä½¿ç”¨å‡½æ•°ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¯ä»¥åœ¨å‡½æ•°ä¸­ä¿®æ”¹çˆ¶ä½œç”¨åŸŸå˜é‡ï¼Œä½†è¿™å¿…é¡»ä½¿ç”¨PARENT_SCOPEæ˜¾å¼è¡¨ç¤º: set(variable_visible_outside \"some value\" PARENT_SCOPE) å¦‚æœæˆ‘ä»¬å°†å®æ›´æ”¹ä¸ºå‡½æ•°ï¼Œæµ‹è¯•ä»ç„¶å¯ä»¥å·¥ä½œï¼Œä½†æ˜¯num_macro_callsåœ¨çˆ¶èŒƒå›´å†…çš„æ‰€æœ‰è°ƒç”¨ä¸­å§‹ç»ˆä¸º0ã€‚å°†CMakeå®æƒ³è±¡æˆç±»ä¼¼å‡½æ•°æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œè¿™äº›å‡½æ•°è¢«ç›´æ¥æ›¿æ¢åˆ°å®ƒä»¬è¢«è°ƒç”¨çš„åœ°æ–¹(åœ¨Cè¯­è¨€ä¸­å†…è”)ã€‚å°†CMakeå‡½æ•°æƒ³è±¡æˆé»‘ç›’å‡½æ•°å¾ˆæœ‰å¿…è¦ã€‚é»‘ç›’ä¸­ï¼Œé™¤éæ˜¾å¼åœ°å°†å…¶å®šä¹‰ä¸ºPARENT_SCOPEï¼Œå¦åˆ™ä¸ä¼šè¿”å›ä»»ä½•å†…å®¹ã€‚CMakeä¸­çš„å‡½æ•°æ²¡æœ‰è¿”å›å€¼ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_32/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [32] ä½¿ç”¨å‡½æ•°å’Œå®é‡ç”¨ä»£ç ","uri":"/posts/cmake_note_32/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ ä¸Šä¸€ç¯‡ï¼Œåœ¨é…ç½®æ—¶è®°å½•äº†ä»£ç å­˜å‚¨åº“(Git Hash)çš„çŠ¶æ€ã€‚ç„¶è€Œï¼Œè¯¥æ–¹æ³•æ–¹æ³•æœ‰ä¸€ä¸ªä»¤äººä¸æ»¡æ„çš„åœ°æ–¹ï¼Œå¦‚æœåœ¨é…ç½®ä»£ç ä¹‹åæ›´æ”¹åˆ†æ”¯æˆ–æäº¤æ›´æ”¹ï¼Œåˆ™æºä»£ç ä¸­åŒ…å«çš„ç‰ˆæœ¬è®°å½•å¯èƒ½æŒ‡å‘é”™è¯¯çš„Git Hashå€¼ã€‚æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•åœ¨æ„å»ºæ—¶è®°å½•Â·Git HashÂ·(æˆ–è€…ï¼Œæ‰§è¡Œå…¶ä»–æ“ä½œ)ï¼Œä»¥ç¡®ä¿æ¯æ¬¡æ„å»ºä»£ç æ—¶éƒ½è¿è¡Œè¿™äº›æ“ä½œï¼Œå› ä¸ºå®é™…æ“ä½œä¸­å¯èƒ½åªé…ç½®ä¸€æ¬¡ï¼Œä½†æ˜¯ä¼šæ„å»ºå¤šæ¬¡ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_31/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [31] æ„å»ºæ—¶è®°å½•Git Hashå€¼","uri":"/posts/cmake_note_31/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â””â”€â”€ git-hash.cmake â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ example.cpp â””â”€â”€ version.hpp.in https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter6/05 ç›¸å…³æºç  version.hpp.in #pragma once #include \u003cstring\u003e const std::string GIT_HASH = \"@GIT_HASH@\"; example.cpp #include \"version.hpp\" #include \u003ciostream\u003e int main() { std::cout \u003c\u003c \"This code has been built from version \" \u003c\u003c GIT_HASH \u003c\u003c std::endl; } git-hash.cmake set(GIT_HASH \"unknown\") # find Git and if available set GIT_HASH variable find_package(Git QUIET) if(GIT_FOUND) execute_process( COMMAND ${GIT_EXECUTABLE} log -1 --pretty=format:%h OUTPUT_VARIABLE GIT_HASH OUTPUT_STRIP_TRAILING_WHITESPACE ERROR_QUIET ) endif() message(STATUS \"Git hash is ${GIT_HASH}\") configure_file( ${CMAKE_SOURCE_DIR}/version.hpp.in ${TARGET_DIR}/generated/version.hpp @ONLY ) CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(recipe-07 LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) add_executable(example example.cpp) target_include_directories(example PRIVATE ${CMAKE_CURRENT_BINARY_DIR}/generated ) add_custom_command( OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/generated/version.hpp ALL COMMAND ${CMAKE_COMMAND} -D TARGET_DIR=${CMAKE_CURRENT_BINARY_DIR} -P ${CMAKE_CURRENT_SOURCE_DIR}/cmake/git-hash.cmake WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} ) # rebuild version.hpp every time add_custom_target( get_git_hash ALL DEPENDS ${CMAKE_CURRENT_BINARY_DIR}/generated/version.hpp ) # version.hpp has to be generated before we start building example add_dependencies(example get_git_hash) tips add_custom_command( OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/generated/version.hpp ALL COMMAND ${CMAKE_COMMAND} -D TARGET_DIR=${CMAKE_CURRENT_BINARY_DIR} -P ${CMAKE_CURRENT_SOURCE_DIR}/cmake/git-hash.cmake WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} ) è‡ªå®šä¹‰å‘½ä»¤è°ƒç”¨CMakeæ¥æ‰§è¡Œgit-hash.cmakeè„šæœ¬ã€‚è¿™é‡Œä½¿ç”¨CLIçš„-På¼€å…³ï¼Œé€šè¿‡ä¼ å…¥è„šæœ¬çš„ä½ç½®å®ç°çš„ã€‚è¯·æ³¨æ„ï¼Œå¯ä»¥åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨CLIå¼€å…³-Dä¼ é€’é€‰é¡¹ã€‚git-hash.cmakeè„šæœ¬ç”Ÿæˆ${TARGET_DIR}/generated/version.hppã€‚è‡ªå®šä¹‰ç›®æ ‡è¢«æ·»åŠ åˆ°ALLç›®æ ‡ä¸­ï¼Œå¹¶ä¸”ä¾èµ–äºè‡ªå®šä¹‰å‘½ä»¤çš„è¾“å‡ºã€‚æ¢å¥è¯è¯´ï¼Œå½“æ„å»ºé»˜è®¤ç›®æ ‡æ—¶ï¼Œæˆ‘ä»¬ç¡®ä¿è‡ªå®šä¹‰å‘½ä»¤å·²ç»è¿è¡Œã€‚æ­¤å¤–ï¼Œè‡ªå®šä¹‰å‘½ä»¤å°†ALLç›®æ ‡ä½œä¸ºè¾“å‡ºã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½ç¡®ä¿æ¯æ¬¡éƒ½ä¼šç”Ÿæˆversion.hppäº†ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_31/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [31] æ„å»ºæ—¶è®°å½•Git Hashå€¼","uri":"/posts/cmake_note_31/"},{"categories":["C++"],"content":"ä¸‰ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. $ cmake --build . $ ./example This code has been configured from version c66f02 ç”Ÿæˆgit hashç‰ˆæœ¬æ–‡ä»¶ ","date":"2024-01-31","objectID":"/posts/cmake_note_31/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [31] æ„å»ºæ—¶è®°å½•Git Hashå€¼","uri":"/posts/cmake_note_31/"},{"categories":["C++"],"content":"å››ã€è¡¥å……å†…å®¹ å¯ä»¥æ”¹è¿›é…ç½®ï¼Œä»¥ä¾¿åœ¨è®°å½•çš„Git Hashå¤–ï¼ŒåŒ…å«å…¶ä»–çš„ä¿¡æ¯ã€‚æ£€æµ‹æ„å»ºç¯å¢ƒæ˜¯å¦æ±¡æŸ“(å³æ˜¯å¦åŒ…å«æœªæäº¤çš„æ›´æ”¹å’Œæœªè·Ÿè¸ªçš„æ–‡ä»¶)ï¼Œæˆ–è€…å¹²å‡€ã€‚å¯ä»¥ä½¿ç”¨git describe --abbrev=7 --long --always --dirty --tagsæ£€æµ‹è¿™äº›ä¿¡æ¯ã€‚æ ¹æ®å¯é‡ç°æ€§ï¼Œç”šè‡³å¯ä»¥å°†Gitçš„çŠ¶æ€ï¼Œå®Œæ•´è¾“å‡ºè®°å½•åˆ°å¤´æ–‡ä»¶ä¸­ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_31/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [31] æ„å»ºæ—¶è®°å½•Git Hashå€¼","uri":"/posts/cmake_note_31/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ å¤§å¤šæ•°ç°ä»£æºä»£ç å­˜å‚¨åº“éƒ½ä½¿ç”¨**Gitä½œä¸ºç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿè¿›è¡Œè·Ÿè¸ªï¼Œæäº¤çš„Git Hashå†³å®šäº†æºä»£ç çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œä¸ºäº†æ ‡è®°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå°è¯•å°†Git Hashè®°å½•åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œæ–¹æ³•æ˜¯å°†å“ˆå¸Œå­—ç¬¦ä¸²è®°å½•åœ¨ä¸€ä¸ªå¤´æ–‡ä»¶ä¸­ï¼Œè¯¥å¤´æ–‡ä»¶å¯ä»¥åŒ…å«åœ¨ä»£ç ä¸­ã€‚** ","date":"2024-01-31","objectID":"/posts/cmake_note_30/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [30] é…ç½®æ—¶è®°å½•Git Hashå€¼","uri":"/posts/cmake_note_30/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ example.cpp â””â”€â”€ version.hpp.in https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter6/04 ç›¸å…³æºç  version.hpp.in #pragma once #include \u003cstring\u003e const std::string GIT_HASH = \"@GIT_HASH@\"; example.cpp #include \"version.hpp\" #include \u003ciostream\u003e int main() { std::cout \u003c\u003c \"This code has been configured from version \" \u003c\u003c GIT_HASH \u003c\u003c std::endl; } CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) set(GIT_HASH \"unknown\") find_package(Git QUIET) if(GIT_FOUND) execute_process( COMMAND ${GIT_EXECUTABLE} log -1 --pretty=format:%h OUTPUT_VARIABLE GIT_HASH OUTPUT_STRIP_TRAILING_WHITESPACE ERROR_QUIET WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} ) endif() message(STATUS \"Git hash is ${GIT_HASH}\") configure_file( version.hpp.in generated/version.hpp @ONLY ) add_executable(example example.cpp) target_include_directories(example PRIVATE ${CMAKE_CURRENT_BINARY_DIR}/generated ) å¼•ç”¨ set(GIT_HASH \"unknown\") ç”±äºGitå‘½ä»¤å¯èƒ½ä¼šå¤±è´¥(æºä»£ç å·²ç»åˆ†å‘åˆ°Gitå­˜å‚¨åº“ä¹‹å¤–)ï¼Œæˆ–è€…Gitåœ¨ç³»ç»Ÿä¸Šä¸å¯ç”¨ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºè¿™ä¸ªå˜é‡è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ã€‚ tips find_package(Git QUIET) if(GIT_FOUND) execute_process( COMMAND ${GIT_EXECUTABLE} log -1 --pretty=format:%h OUTPUT_VARIABLE GIT_HASH OUTPUT_STRIP_TRAILING_WHITESPACE ERROR_QUIET WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} ) endif() ä½¿ç”¨find_package(Git QUIET)æ¥æ£€æµ‹ç³»ç»Ÿä¸Šæ˜¯å¦æœ‰å¯ç”¨çš„Gitã€‚å¦‚æœæœ‰(GIT_FOUNDä¸ºTrue)ï¼Œè¿è¡Œä¸€ä¸ªGitå‘½ä»¤:${GIT_EXECUTABLE} log -1 --pretty=format:%hã€‚è¿™ä¸ªå‘½ä»¤ç»™å‡ºäº†å½“å‰æäº¤Hashçš„ç®€çŸ­ç‰ˆæœ¬ã€‚ å½“ç„¶ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥çµæ´»åœ°è¿è¡ŒGitå‘½ä»¤ã€‚ è¦æ±‚execute_processå‘½ä»¤å°†ç»“æœæ”¾å…¥åä¸ºGIT_HASHçš„å˜é‡ä¸­ï¼Œç„¶ååˆ é™¤ä»»ä½•å°¾éšçš„ç©ºæ ¼ã€‚ä½¿ç”¨ERROR_QUIETï¼Œå¦‚æœGitå‘½ä»¤ç”±äºæŸç§åŸå› å¤±è´¥ï¼Œä¸ä¼šåœæ­¢é…ç½®ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_30/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [30] é…ç½®æ—¶è®°å½•Git Hashå€¼","uri":"/posts/cmake_note_30/"},{"categories":["C++"],"content":"ä¸‰ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. $ cmake --build . $ ./example This code has been configured from version 74e4aa9 ç”Ÿæˆä¿å­˜git hashçš„æ–‡ä»¶ version.hpp #pragma once #include \u003cstring\u003e const std::string GIT_HASH = \"74e4aa9\"; ","date":"2024-01-31","objectID":"/posts/cmake_note_30/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [30] é…ç½®æ—¶è®°å½•Git Hashå€¼","uri":"/posts/cmake_note_30/"},{"categories":["C++"],"content":"ä¸€ã€ å¯¼è¨€ å¯¼è¨€ æœ¬ç¯‡å†…å®¹ç›®çš„å’Œä¸Šä¸€ç¯‡ç›¸ä¼¼ï¼Œä½†æ˜¯å‡ºå‘ç‚¹ä¸åŒã€‚æˆ‘ä»¬è®¡åˆ’æ˜¯ä»æ–‡ä»¶ä¸­è¯»å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å°†å…¶è®¾ç½®åœ¨CMakeLists.txtä¸­ã€‚å°†ç‰ˆæœ¬ä¿å­˜åœ¨å•ç‹¬æ–‡ä»¶ä¸­çš„ç›®çš„ï¼Œæ˜¯å…è®¸å…¶ä»–æ„å»ºæ¡†æ¶æˆ–å¼€å‘å·¥å…·ä½¿ç”¨ç‹¬ç«‹äº**CMakeçš„ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦å°†ä¿¡æ¯å¤åˆ¶åˆ°å¤šä¸ªæ–‡ä»¶ä¸­ã€‚** ","date":"2024-01-31","objectID":"/posts/cmake_note_29/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [29] ä»æ–‡ä»¶ä¸­è®°å½•é¡¹ç›®ç‰ˆæœ¬","uri":"/posts/cmake_note_29/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ example.cpp â”œâ”€â”€ version.hpp.in â””â”€â”€ VERSION.txt https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter6/03 ","date":"2024-01-31","objectID":"/posts/cmake_note_29/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [29] ä»æ–‡ä»¶ä¸­è®°å½•é¡¹ç›®ç‰ˆæœ¬","uri":"/posts/cmake_note_29/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  VERSION.txt 2.0.1-rc-2 version.hpp.in #pragma once #include \u003cstring\u003e const std::string PROGRAM_VERSION = \"@PROGRAM_VERSION@\"; example.cpp #include \"version.hpp\" #include \u003ciostream\u003e int main() { std::cout \u003c\u003c \"This is output from code v\" \u003c\u003c PROGRAM_VERSION \u003c\u003c std::endl; std::cout \u003c\u003c \"Hello CMake world!\" \u003c\u003c std::endl; } CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) if(EXISTS \"${CMAKE_CURRENT_SOURCE_DIR}/VERSION.txt\") file(READ \"${CMAKE_CURRENT_SOURCE_DIR}/VERSION.txt\" PROGRAM_VERSION) string(STRIP \"${PROGRAM_VERSION}\" PROGRAM_VERSION) else() message(FATAL_ERROR \"File ${CMAKE_CURRENT_SOURCE_DIR}/VERSION.txt not found\") endif() configure_file( version.hpp.in generated/version.hpp @ONLY ) add_executable(example example.cpp) target_include_directories(example PRIVATE ${CMAKE_CURRENT_BINARY_DIR}/generated ) å¼•ç”¨ if(EXISTS \"${CMAKE_CURRENT_SOURCE_DIR}/VERSION.txt\") file(READ \"${CMAKE_CURRENT_SOURCE_DIR}/VERSION.txt\" PROGRAM_VERSION) string(STRIP \"${PROGRAM_VERSION}\" PROGRAM_VERSION) else() message(FATAL_ERROR \"File ${CMAKE_CURRENT_SOURCE_DIR}/VERSION.txt not found\") endif() é¦–å…ˆï¼Œæ£€æŸ¥æ–‡ä»¶VERSION.txtæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å‘å‡ºé”™è¯¯æ¶ˆæ¯ã€‚å¦‚æœå­˜åœ¨ï¼Œå°†å†…å®¹è¯»å…¥PROGRAM_VERSIONå˜é‡ä¸­ï¼Œè¯¥å˜é‡ä¼šå»æ‰å°¾éƒ¨çš„ç©ºæ ¼ã€‚ å½“è®¾ç½®äº†å˜é‡PROGRAM_VERSIONï¼Œå°±å¯ä»¥ä½¿ç”¨å®ƒæ¥é…ç½®version.hpp.inï¼Œç”Ÿæˆgenerated/version.hppï¼š configure_file( version.hpp.in generated/version.hpp @ONLY ) ","date":"2024-01-31","objectID":"/posts/cmake_note_29/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [29] ä»æ–‡ä»¶ä¸­è®°å½•é¡¹ç›®ç‰ˆæœ¬","uri":"/posts/cmake_note_29/"},{"categories":["C++"],"content":"å››ã€ç»“æœå±•ç¤º $ mkdir -p build $ cd build $ cmake .. $ cmake --build . $ ./example This is output from code v2.0.1-rc-2 Hello CMake world! ç”Ÿæˆç‰ˆæœ¬æ–‡ä»¶ version.hpp #pragma once #include \u003cstring\u003e const std::string PROGRAM_VERSION = \"2.0.1-rc-2\"; ","date":"2024-01-31","objectID":"/posts/cmake_note_29/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [29] ä»æ–‡ä»¶ä¸­è®°å½•é¡¹ç›®ç‰ˆæœ¬","uri":"/posts/cmake_note_29/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ ä»£ç ç‰ˆæœ¬å¾ˆé‡è¦ï¼Œä¸ä»…æ˜¯ä¸ºäº†å¯é‡å¤æ€§ï¼Œè¿˜ä¸ºäº†è®°å½•APIåŠŸèƒ½æˆ–ç®€åŒ–æ”¯æŒè¯·æ±‚å’ŒbugæŠ¥å‘Šã€‚æºä»£ç é€šå¸¸å¤„äºæŸç§ç‰ˆæœ¬æ§åˆ¶ä¹‹ä¸‹ï¼Œä¾‹å¦‚å¯ä»¥ä½¿ç”¨Gitæ ‡è®°é™„åŠ é¢å¤–ç‰ˆæœ¬å·ã€‚ç„¶è€Œï¼Œä¸ä»…éœ€è¦å¯¹æºä»£ç è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œè€Œä¸”å¯æ‰§è¡Œæ–‡ä»¶è¿˜éœ€è¦è®°å½•é¡¹ç›®ç‰ˆæœ¬ï¼Œä»¥ä¾¿å°†å…¶æ‰“å°åˆ°ä»£ç è¾“å‡ºæˆ–ç”¨æˆ·ç•Œé¢ä¸Šã€‚ æœ¬ç¯‡ï¼Œå°†åœ¨CMakeæºæ–‡ä»¶ä¸­å®šä¹‰ç‰ˆæœ¬å·ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨é…ç½®é¡¹ç›®æ—¶å°†ç¨‹åºç‰ˆæœ¬è®°å½•åˆ°å¤´æ–‡ä»¶ä¸­ã€‚ç„¶åï¼Œç”Ÿæˆçš„å¤´æ–‡ä»¶å¯ä»¥åŒ…å«åœ¨ä»£ç çš„æ­£ç¡®ä½ç½®å’Œæ—¶é—´ï¼Œä»¥ä¾¿å°†ä»£ç ç‰ˆæœ¬æ‰“å°åˆ°è¾“å‡ºæ–‡ä»¶æˆ–å±å¹•ä¸Šã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_28/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [28] è®°å½•é¡¹ç›®ç‰ˆæœ¬ä¿¡æ¯ä»¥ä¾¿æŠ¥å‘Š","uri":"/posts/cmake_note_28/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ version.h.in â””â”€â”€ example.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter6/02 ","date":"2024-01-31","objectID":"/posts/cmake_note_28/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [28] è®°å½•é¡¹ç›®ç‰ˆæœ¬ä¿¡æ¯ä»¥ä¾¿æŠ¥å‘Š","uri":"/posts/cmake_note_28/"},{"categories":["C++"],"content":"ä¸‰ã€ç›¸å…³æºç  example.cpp #include \"version.h\" #include \u003ciostream\u003e int main() { std::cout \u003c\u003c \"This is output from code \" \u003c\u003c PROJECT_VERSION \u003c\u003c std::endl; std::cout \u003c\u003c \"Major version number: \" \u003c\u003c PROJECT_VERSION_MAJOR \u003c\u003c std::endl; std::cout \u003c\u003c \"Minor version number: \" \u003c\u003c PROJECT_VERSION_MINOR \u003c\u003c std::endl; std::cout \u003c\u003c \"Hello CMake world!\" \u003c\u003c std::endl; } è¿™é‡Œï¼Œå‡è®¾PROJECT_VERSION_MAJORã€PROJECT_VERSION_MINORå’ŒPROJECT_VERSIONæ˜¯åœ¨version.hä¸­å®šä¹‰çš„ã€‚ ç›®æ ‡æ˜¯ä»ä»¥ä¸‹æ¨¡æ¿ä¸­ç”Ÿæˆversion.h.in: version.h.in #pragma once #define PROJECT_VERSION_MAJOR @PROJECT_VERSION_MAJOR@ #define PROJECT_VERSION_MINOR @PROJECT_VERSION_MINOR@ #define PROJECT_VERSION_PATCH @PROJECT_VERSION_PATCH@ #define PROJECT_VERSION \"v@PROJECT_VERSION@\" è¿™é‡Œä½¿ç”¨é¢„å¤„ç†å™¨å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æˆ–æ•´æ•°å¸¸é‡æ¥æé«˜ç±»å‹å®‰å…¨æ€§ã€‚ CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(example VERSION 2.0.1 LANGUAGES CXX) configure_file( version.h.in generated/version.h @ONLY ) add_executable(${PROJECT_NAME} example.cpp) target_include_directories(${PROJECT_NAME} PRIVATE ${CMAKE_CURRENT_BINARY_DIR}/generated ) å½“ä½¿ç”¨ç‰ˆæœ¬å‚æ•°è°ƒç”¨CMakeçš„projectæ—¶ï¼ŒCMakeå°†ä¸ºé¡¹ç›®è®¾ç½®PROJECT_VERSION_MAJORã€PROJECT_VERSION_MINORå’ŒPROJECT_VERSION_PATCHã€‚ configure_fileæ¥å—ä¸€ä¸ªè¾“å…¥æ–‡ä»¶(æœ¬ä¾‹ä¸­æ˜¯version.h.in)ï¼Œé€šè¿‡å°†@ä¹‹é—´çš„å ä½ç¬¦æ›¿æ¢æˆå¯¹åº”çš„CMakeå˜é‡ï¼Œç”Ÿæˆä¸€ä¸ªè¾“å‡ºæ–‡ä»¶(æœ¬ä¾‹ä¸­æ˜¯generate/version.h)ã€‚å®ƒå°†@PROJECT_VERSION_MAJOR@æ›¿æ¢ä¸º2ï¼Œä»¥æ­¤ç±»æ¨ã€‚ä½¿ç”¨å…³é”®å­—@ONLYï¼Œæˆ‘ä»¬å°†configure_fileé™åˆ¶ä¸ºåªæ›¿æ¢@variables@ï¼Œè€Œä¸ä¿®æ”¹${variables}ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_28/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [28] è®°å½•é¡¹ç›®ç‰ˆæœ¬ä¿¡æ¯ä»¥ä¾¿æŠ¥å‘Š","uri":"/posts/cmake_note_28/"},{"categories":["C++"],"content":"å››ã€ç»“æœ mkdir build \u0026 cd build cmake .. cmake --build . ./example This is output from code v2.0.1 Major version number: 2 Minor version number: 0 Hello CMake world! ç”Ÿæˆç‰ˆæœ¬ä¿¡æ¯ #pragma once #define PROJECT_VERSION_MAJOR 2 #define PROJECT_VERSION_MINOR 0 #define PROJECT_VERSION_PATCH 1 #define PROJECT_VERSION \"v2.0.1\" ","date":"2024-01-31","objectID":"/posts/cmake_note_28/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [28] è®°å½•é¡¹ç›®ç‰ˆæœ¬ä¿¡æ¯ä»¥ä¾¿æŠ¥å‘Š","uri":"/posts/cmake_note_28/"},{"categories":["C++"],"content":"äº”ã€è¡¥å……å†…å®¹ CMakeä»¥x.y.zæ ¼å¼ç»™å‡ºçš„ç‰ˆæœ¬å·ï¼Œå¹¶å°†å˜é‡PROJECT_VERSIONå’Œ\u003cproject-name\u003e_VERSIONè®¾ç½®ä¸ºç»™å®šçš„å€¼ã€‚æ­¤å¤–,PROJECT_VERSION_MAJOR(\u003cproject-name\u003e_VERSION_MAJOR),PROJECT_VERSION_MINOR(\u003cproject-name\u003e_VERSION_MINOR) PROJECT_VERSION_PATCH(\u003cproject-name\u003e_VERSION_PATCH)å’ŒPROJECT_VERSION_TWEAK(\u003cproject-name\u003e_VERSION_TWEAK),å°†åˆ†åˆ«è®¾ç½®ä¸ºX, Y, Zå’Œtã€‚ ä¸ºäº†ç¡®ä¿åªæœ‰å½“CMakeå˜é‡è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„å¸¸é‡æ—¶ï¼Œæ‰å®šä¹‰é¢„å¤„ç†å™¨å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨configure_fileï¼Œåœ¨é…ç½®çš„å¤´æ–‡ä»¶ä¸­ä½¿ç”¨#cmakedefinè€Œä¸æ˜¯#defineã€‚ æ ¹æ®æ˜¯å¦å®šä¹‰äº†CMakeå˜é‡å¹¶å°†å…¶è®¡ç®—ä¸ºä¸€ä¸ªçœŸæ­£çš„å¸¸é‡ï¼Œ#cmakedefine YOUR_VARIABLEå°†è¢«æ›¿æ¢ä¸º#define YOUR_VARIABLE â€¦æˆ–è€…/* #undef YOUR_VARIABLE */ã€‚è¿˜æœ‰#cmakedefine01ï¼Œå°†æ ¹æ®å˜é‡æ˜¯å¦å®šä¹‰ï¼Œå°†å˜é‡è®¾ç½®ä¸º0æˆ–1ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_28/:5:0","tags":["CMake"],"title":"CMake ç¬”è®° | [28] è®°å½•é¡¹ç›®ç‰ˆæœ¬ä¿¡æ¯ä»¥ä¾¿æŠ¥å‘Š","uri":"/posts/cmake_note_28/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ ä»£ç ç”Ÿæˆåœ¨é…ç½®æ—¶å‘ç”Ÿï¼Œå¦‚ CMakeå¯ä»¥æ£€æµ‹æ“ä½œç³»ç»Ÿå’Œå¯ç”¨åº“ï¼›åŸºäºè¿™äº›ä¿¡æ¯ï¼Œå¯ä»¥å®šåˆ¶æ„å»ºçš„æºä»£ç ã€‚æœ¬ç¯‡æˆ‘ä»¬å°†æ¢ç´¢å¦‚ä½•ç”Ÿæˆä¸€ä¸ªç®€å•æºæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæŠ¥å‘Šæ„å»ºç³»ç»Ÿé…ç½®ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_27/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [27] é…ç½®æ—¶ç”Ÿæˆæºç ","uri":"/posts/cmake_note_27/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ print_info.c.in é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter6/01 ç›¸å…³æºç  CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(config_generator LANGUAGES C) execute_process( COMMAND whoami TIMEOUT 1 OUTPUT_VARIABLE _user_name OUTPUT_STRIP_TRAILING_WHITESPACE ) # host name information cmake_host_system_information(RESULT _host_name QUERY HOSTNAME) cmake_host_system_information(RESULT _fqdn QUERY FQDN) # processor information cmake_host_system_information(RESULT _processor_name QUERY PROCESSOR_NAME) cmake_host_system_information(RESULT _processor_description QUERY PROCESSOR_DESCRIPTION) # os information cmake_host_system_information(RESULT _os_name QUERY OS_NAME) cmake_host_system_information(RESULT _os_release QUERY OS_RELEASE) cmake_host_system_information(RESULT _os_version QUERY OS_VERSION) cmake_host_system_information(RESULT _os_platform QUERY OS_PLATFORM) string(TIMESTAMP _configuration_time \"%Y-%m-%d %H:%M:%S [UTC]\" UTC) configure_file(print_info.c.in print_info.c @ONLY) tips execute_process( COMMAND whoami TIMEOUT 1 OUTPUT_VARIABLE _user_name OUTPUT_STRIP_TRAILING_WHITESPACE ) ä½¿ç”¨ execute_processä¸ºé¡¹ç›®è·å–å½“å‰ä½¿ç”¨è€…çš„ä¿¡æ¯ã€‚ tips # host name information cmake_host_system_information(RESULT _host_name QUERY HOSTNAME) cmake_host_system_information(RESULT _fqdn QUERY FQDN) # processor information cmake_host_system_information(RESULT _processor_name QUERY PROCESSOR_NAME) cmake_host_system_information(RESULT _processor_description QUERY PROCESSOR_DESCRIPTION) # os information cmake_host_system_information(RESULT _os_name QUERY OS_NAME) cmake_host_system_information(RESULT _os_release QUERY OS_RELEASE) cmake_host_system_information(RESULT _os_version QUERY OS_VERSION) cmake_host_system_information(RESULT _os_platform QUERY OS_PLATFORM) ä½¿ç”¨cmake_host_system_information()å‡½æ•°æŸ¥è¯¢ç³»ç»Ÿä¿¡æ¯ã€‚ tips string(TIMESTAMP _configuration_time \"%Y-%m-%d %H:%M:%S [UTC]\" UTC) æ•è·é…ç½®æ—¶çš„æ—¶é—´æˆ³ï¼Œå¹¶é€šè¿‡ä½¿ç”¨å­—ç¬¦ä¸²æ“ä½œå‡½æ•°ã€‚ tips configure_file(print_info.c.in print_info.c @ONLY) é€šè¿‡configure_fileå‡½æ•°ç”Ÿæˆä»£ç ã€‚æ³¨æ„ï¼Œè¿™é‡Œåªè¦æ±‚ä»¥@å¼€å¤´å’Œç»“å°¾çš„å­—ç¬¦ä¸²è¢«æ›¿æ¢ã€‚ print_info.c.in #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e void print_info(void) { printf(\"\\n\"); printf(\"Configuration and build information\\n\"); printf(\"-----------------------------------\\n\"); printf(\"\\n\"); printf(\"Who compiled | %s\\n\", \"@_user_name@\"); printf(\"Compilation hostname | %s\\n\", \"@_host_name@\"); printf(\"Fully qualified domain name | %s\\n\", \"@_fqdn@\"); printf(\"Operating system | %s\\n\", \"@_os_name@, @_os_release@, @_os_version@\"); printf(\"Platform | %s\\n\", \"@_os_platform@\"); printf(\"Processor info | %s\\n\", \"@_processor_name@, @_processor_description@\"); printf(\"CMake version | %s\\n\", \"@CMAKE_VERSION@\"); printf(\"CMake generator | %s\\n\", \"@CMAKE_GENERATOR@\"); printf(\"Configuration time | %s\\n\", \"@_configuration_time@\"); printf(\"Fortran compiler | %s\\n\", \"@CMAKE_Fortran_COMPILER@\"); printf(\"C compiler | %s\\n\", \"@CMAKE_C_COMPILER@\"); printf(\"\\n\"); fflush(stdout); } ç»“æœå±•ç¤º: ç”Ÿæˆprint_info.c print_info.c #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e void print_info(void) { printf(\"\\n\"); printf(\"Configuration and build information\\n\"); printf(\"-----------------------------------\\n\"); printf(\"\\n\"); printf(\"Who compiled | %s\\n\", \"jiangli\"); printf(\"Compilation hostname | %s\\n\", \"jiangli-virtual-machine\"); printf(\"Fully qualified domain name | %s\\n\", \"jiangli-virtual-machine.lan\"); printf(\"Operating system | %s\\n\", \"Linux, 5.15.0-89-generic, #99~20.04.1-Ubuntu SMP Thu Nov 2 15:16:47 UTC 2023\"); printf(\"Platform | %s\\n\", \"x86_64\"); printf(\"Processor info | %s\\n\", \"Unknown AMD family, 16 core AMD Ryzen 7 4800H with Radeon Graphics\"); printf(\"CMake version | %s\\n\", \"3.16.3\"); printf(\"CMake generator | %s\\n\", \"Unix Makefiles\"); printf(\"Configuration time | %s\\n\", \"2023-11-24 01:01:31 [UTC]\"); printf(\"Fortran compiler | %s\\n\", \"\"); printf(\"C compiler | %s\\n\", \"/usr/bin/gcc\"); printf(\"\\n\"); fflush(stdout); } è¡¥å…… ç”¨å€¼æ›¿æ¢å ä½ç¬¦æ—¶ï¼ŒCMakeä¸­çš„å˜é‡ååº”è¯¥ä¸å°†è¦é…ç½®çš„æ–‡ä»¶ä¸­ä½¿ç”¨çš„å˜é‡åå®Œå…¨ç›¸åŒï¼Œå¹¶æ”¾åœ¨@ä¹‹é—´ã€‚å¯ä»¥åœ¨è°ƒç”¨configure_fileæ—¶å®šä¹‰çš„ä»»ä½•CMakeå˜é‡ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_27/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [27] é…ç½®æ—¶ç”Ÿæˆæºç ","uri":"/posts/cmake_note_27/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ æœ¬ç¯‡é€šè¿‡å±•ç¤ºå¦‚ä½•ä½¿ç”¨æ¥è‡ªå¯¹åº”çš„CheckSourceCompiles.cmakeæ ‡å‡†æ¨¡å—çš„check__source_compileså‡½æ•°ï¼Œä»¥è¯„ä¼°ç»™å®šç¼–è¯‘å™¨æ˜¯å¦å¯ä»¥å°†é¢„å®šä¹‰çš„ä»£ç ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚è¯¥å‘½ä»¤å¯å¸®åŠ©ç¡®å®š: ç¼–è¯‘å™¨æ”¯æŒæ‰€éœ€çš„ç‰¹æ€§ã€‚ é“¾æ¥å™¨å·¥ä½œæ­£å¸¸ï¼Œå¹¶ç†è§£ç‰¹å®šçš„æ ‡å¿—ã€‚ å¯ä»¥ä½¿ç”¨find_packageæ‰¾åˆ°çš„åŒ…å«ç›®å½•å’Œåº“ã€‚ æˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•æ£€æµ‹OpenMP 4.5æ ‡å‡†çš„å¾ªç¯ç‰¹æ€§ï¼Œä»¥ä¾¿åœ¨C++å¯æ‰§è¡Œæ–‡ä»¶ä¸­ä½¿ç”¨ã€‚ä½¿ç”¨ä¸€ä¸ªC++æºæ–‡ä»¶ï¼Œæ¥æ¢æµ‹ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒè¿™æ ·çš„ç‰¹æ€§ã€‚CMakeæä¾›äº†ä¸€ä¸ªé™„åŠ å‘½ä»¤try_compileæ¥æ¢ç©¶ç¼–è¯‘ã€‚ ","date":"2024-01-31","objectID":"/posts/cmake_note_26/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [26] æ¢ç©¶ç¼–è¯‘å’Œç¼–è¯‘å‘½ä»¤","uri":"/posts/cmake_note_26/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ â”œâ”€â”€ CMakeLists.txt â””â”€â”€ task_loop.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter5/04 ç›¸å…³æºç  CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(test LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) find_package(OpenMP) if(OpenMP_FOUND) # this will get wiped unless you run cmake with --debug-trycompile set(scratch_dir ${CMAKE_CURRENT_BINARY_DIR}/omp_try_compile) try_compile( omp_task_loop_test_1 ${scratch_dir} SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/task_loop.cpp LINK_LIBRARIES OpenMP::OpenMP_CXX ) message(STATUS \"Result of try_compile: ${omp_task_loop_test_1}\") include(CheckCXXSourceCompiles) file(READ ${CMAKE_CURRENT_SOURCE_DIR}/task_loop.cpp snippet) set(CMAKE_REQUIRED_LIBRARIES OpenMP::OpenMP_CXX) check_cxx_source_compiles(\"${snippet}\" omp_task_loop_test_2) unset(CMAKE_REQUIRED_LIBRARIES) message(STATUS \"Result of check_cxx_source_compiles: ${omp_task_loop_test_2}\") else() message(STATUS \"OpenMP not found: no test for taskloop is run\") endif() æ–¹å¼ä¸€ï¼š set(scratch_dir ${CMAKE_CURRENT_BINARY_DIR}/omp_try_compile) å¦‚æœæ‰¾åˆ°OpenMPï¼Œå†æ£€æŸ¥æ‰€éœ€çš„ç‰¹æ€§æ˜¯å¦å¯ç”¨ã€‚ä¸ºæ­¤ï¼Œè®¾ç½®äº†ä¸€ä¸ªä¸´æ—¶ç›®å½•ï¼Œtry_compileå°†åœ¨è¿™ä¸ªç›®å½•ä¸‹æ¥ç”Ÿæˆä¸­é—´æ–‡ä»¶ã€‚æˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨å‰é¢æ­¥éª¤ä¸­å¼•å…¥çš„ifè¯­å¥ä¸­ã€‚å¦‚æœæˆ‘ä»¬æ„å»ºæ—¶ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œåˆ™ä¼šåœ¨omp_try_compileæ–‡ä»¶å¤¹ä¸­äº§ç”Ÿä¸­é—´æ–‡ä»¶ã€‚ cmake .. --debug-trycompile ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶cmTC_e8239 try_compile( omp_task_loop_test_1 ${scratch_dir} SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/task_loop.cpp LINK_LIBRARIES OpenMP::OpenMP_CXX ) message(STATUS \"Result of try_compile: ${omp_task_loop_test_1}\") è°ƒç”¨try_compileç”Ÿæˆä¸€ä¸ªå°é¡¹ç›®ï¼Œä»¥å°è¯•ç¼–è¯‘æºæ–‡ä»¶task_loop.cppã€‚ç¼–è¯‘æˆåŠŸæˆ–å¤±è´¥çš„çŠ¶æ€ï¼Œå°†ä¿å­˜åˆ°omp_task_loop_test_1å˜é‡ä¸­ã€‚éœ€è¦ä¸ºè¿™ä¸ªç¤ºä¾‹ç¼–è¯‘è®¾ç½®é€‚å½“çš„ç¼–è¯‘å™¨æ ‡å¿—ã€åŒ…æ‹¬ç›®å½•å’Œé“¾æ¥åº“ã€‚å› ä¸ºä½¿ç”¨å¯¼å…¥çš„ç›®æ ‡OpenMP::OpenMP_CXXï¼Œæ‰€ä»¥åªéœ€å°†LINK_LIBRARIESé€‰é¡¹è®¾ç½®ä¸ºOpenMP::OpenMP_CXXå³å¯ã€‚å¦‚æœç¼–è¯‘æˆåŠŸï¼Œåˆ™ä»»åŠ¡å¾ªç¯ç‰¹æ€§å¯ç”¨ï¼Œæˆ‘ä»¬æ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚ æ–¹å¼äºŒï¼š include(CheckCXXSourceCompiles) è¦ä½¿ç”¨check_cxx_source_compileså‡½æ•°ï¼Œéœ€è¦åŒ…å«CheckCXXSourceCompiles.cmakeæ¨¡å—æ–‡ä»¶ã€‚å…¶ä»–è¯­è¨€ä¹Ÿæœ‰ç±»ä¼¼çš„æ¨¡å—æ–‡ä»¶ï¼ŒC(CheckCSourceCompiles.cmake)å’ŒFortran(CheckFortranSourceCompiles.cmake)ã€‚ file(READ ${CMAKE_CURRENT_SOURCE_DIR}/task_loop.cpp snippet) å¤åˆ¶æºæ–‡ä»¶çš„å†…å®¹ï¼Œé€šè¿‡file(READ ...)å‘½ä»¤è¯»å–å†…å®¹åˆ°ä¸€ä¸ªå˜é‡ä¸­ï¼Œè¯•å›¾ç¼–è¯‘å’Œè¿æ¥è¿™ä¸ªå˜é‡ã€‚ set(CMAKE_REQUIRED_LIBRARIES OpenMP::OpenMP_CXX) è®¾ç½®äº†CMAKE_REQUIRED_LIBRARIESã€‚å¯¹äºä¸‹ä¸€æ­¥æ­£ç¡®è°ƒç”¨ç¼–è¯‘å™¨æ˜¯å¿…éœ€çš„ã€‚æ³¨æ„ä½¿ç”¨å¯¼å…¥çš„OpenMP::OpenMP_CXXç›®æ ‡ï¼Œå®ƒè¿˜å°†è®¾ç½®æ­£ç¡®çš„ç¼–è¯‘å™¨æ ‡å¿—å’ŒåŒ…å«ç›®å½•ã€‚ check_cxx_source_compiles(\"${snippet}\" omp_task_loop_test_2) ä½¿ç”¨ä»£ç ç‰‡æ®µä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨check_cxx_source_compileså‡½æ•°ã€‚æ£€æŸ¥ç»“æœå°†ä¿å­˜åˆ°omp_task_loop_test_2å˜é‡ä¸­ã€‚ unset(CMAKE_REQUIRED_LIBRARIES) message(STATUS \"Result of check_cxx_source_compiles: ${omp_task_loop_test_2}\" è°ƒç”¨check_cxx_source_compileså¹¶å‘ç”¨æˆ·æ‰“å°æ¶ˆæ¯ä¹‹å‰ï¼Œå–æ¶ˆå˜é‡çš„è®¾ç½®ã€‚ task_loop.cpp #include \u003ccmath\u003e #include \u003ciostream\u003e void LongRunningTask() { double number = 5.0; double result = std::pow(number, 2); std::cout \u003c\u003c \"é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ç»“æœï¼š\" \u003c\u003c result \u003c\u003c std::endl; } void LoopBody(int i, int j) { double calculation_result = std::sin(i) * std::cos(j); std::cout \u003c\u003c \"åœ¨å¾ªç¯ä½“ä¸­è®¡ç®—ç»“æœï¼š\" \u003c\u003c calculation_result \u003c\u003c std::endl; } void ParallelWork() { int i, j; #pragma omp taskgroup { #pragma omp task LongRunningTask(); #pragma omp taskloop private(j) grainsize(500) nogroup for (i = 0; i \u003c 10000; i++) { for (j = 0; j \u003c i; j++) { LoopBody(i, j); } } } } int main() { ParallelWork(); return 0; } ç»“æœ $ mkdir -p build $ cd build $ cmake .. -- ... -- Found OpenMP_CXX: -fopenmp (found version \"4.5\") -- Found OpenMP: TRUE (found version \"4.5\") -- Result of try_compile: TRUE -- Performing Test omp_taskloop_test_2 -- Performing Test omp_taskloop_test_2 - Success -- Result of check_cxx_source_compiles: 1 ","date":"2024-01-31","objectID":"/posts/cmake_note_26/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [26] æ¢ç©¶ç¼–è¯‘å’Œç¼–è¯‘å‘½ä»¤","uri":"/posts/cmake_note_26/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ add_custom_command æ˜¯ CMake ä¸­ç”¨äºæ·»åŠ è‡ªå®šä¹‰æ„å»ºè§„åˆ™çš„å‘½ä»¤ï¼Œé€šå¸¸ç”¨äºåœ¨ç¼–è¯‘é¡¹ç›®æ—¶æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰æ“ä½œï¼Œä¾‹å¦‚ç”Ÿæˆæ–‡ä»¶ã€è¿è¡Œè„šæœ¬ç­‰ã€‚ ","date":"2024-01-30","objectID":"/posts/cmake_note_25/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [25] æ„å»ºæ—¶ä¸ºç‰¹å®šç›®æ ‡è¿è¡Œè‡ªå®šä¹‰å‘½ä»¤","uri":"/posts/cmake_note_25/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ generate_config.cmake â””â”€â”€ main.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter5/03 ç›¸å…³æºç  CMakeLists.txt cmake_minimum_required(VERSION 3.10) project(test_command) # è®¾ç½®éœ€è¦ç”Ÿæˆçš„å¤´æ–‡ä»¶çš„è·¯å¾„ set(CONFIG_HEADER ${CMAKE_BINARY_DIR}/config.h) # æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰å‘½ä»¤æ¥ç”Ÿæˆå¤´æ–‡ä»¶ add_custom_command( OUTPUT ${CONFIG_HEADER} COMMAND ${CMAKE_COMMAND} -DOUTPUT_FILE=${CONFIG_HEADER} -P ${CMAKE_CURRENT_SOURCE_DIR}/generate_config.cmake COMMENT \"Generating config.h\" ) # å°†ç”Ÿæˆçš„å¤´æ–‡ä»¶çš„è·¯å¾„æ·»åŠ åˆ°åŒ…å«ç›®å½• include_directories(${CMAKE_BINARY_DIR}) # æ·»åŠ å¯æ‰§è¡Œæ–‡ä»¶ add_executable(test_app main.cpp) # å°†è‡ªå®šä¹‰å‘½ä»¤çš„è¾“å‡ºæ–‡ä»¶æ·»åŠ ä¸ºä¾èµ–é¡¹ add_dependencies(test_app config_h_target) # å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰ç›®æ ‡ä»¥ä¾¿å…¶ä»–ç›®æ ‡å¯ä»¥ä¾èµ–å®ƒ add_custom_target(config_h_target DEPENDS ${CONFIG_HEADER}) # å°†è‡ªå®šä¹‰ç›®æ ‡æ·»åŠ åˆ° ALL é˜¶æ®µï¼Œä»¥ç¡®ä¿åœ¨æ¯æ¬¡æ„å»ºæ—¶éƒ½ç”Ÿæˆ config.h add_dependencies(test_app config_h_target) generate_config.cmake # ä½ å¯ä»¥åœ¨è¿™é‡Œå®šä¹‰æ‰€éœ€çš„å® set(APP_NAME \"TJUApp\") set(APP_VERSION \"1.0.0\") set(DEBUG_MODE 1) # ç”Ÿæˆ config.h å¤´æ–‡ä»¶ file(WRITE ${OUTPUT_FILE} \"#ifndef CONFIG_H\\n\") file(APPEND ${OUTPUT_FILE} \"#define CONFIG_H\\n\") file(APPEND ${OUTPUT_FILE} \"\\n\") # æ·»åŠ å®å®šä¹‰ file(APPEND ${OUTPUT_FILE} \"#define APP_NAME \\\"${APP_NAME}\\\"\\n\") file(APPEND ${OUTPUT_FILE} \"#define APP_VERSION \\\"${APP_VERSION}\\\"\\n\") if (DEBUG_MODE) file(APPEND ${OUTPUT_FILE} \"#define DEBUG_MODE 1\\n\") else () file(APPEND ${OUTPUT_FILE} \"#define DEBUG_MODE 0\\n\") endif () # ç»“æŸæ–‡ä»¶ file(APPEND ${OUTPUT_FILE} \"\\n#endif\\n\") #include \u003ciostream\u003e #include \"config.h\" int main() { #ifdef DEBUG_MODE std::cout \u003c\u003c \"DEBUG_MODE: \" \u003c\u003c DEBUG_MODE \u003c\u003c std::endl; #endif return 0; } ç»“æœ mkdir build \u0026 cd build cmake .. make ç”Ÿæˆconfig.hæ–‡ä»¶ ``` DEBUG_MODE: 1 ``` ","date":"2024-01-30","objectID":"/posts/cmake_note_25/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [25] æ„å»ºæ—¶ä¸ºç‰¹å®šç›®æ ‡è¿è¡Œè‡ªå®šä¹‰å‘½ä»¤","uri":"/posts/cmake_note_25/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¼•ç”¨ é¡¹ç›®çš„æ„å»ºç›®æ ‡å–å†³äºå‘½ä»¤çš„ç»“æœï¼Œè¿™äº›å‘½ä»¤åªèƒ½åœ¨æ„å»ºç³»ç»Ÿç”Ÿæˆå®Œæˆåçš„æ„å»ºæ‰§è¡Œã€‚CMakeæä¾›äº†ä¸‰ä¸ªé€‰é¡¹æ¥åœ¨æ„å»ºæ—¶æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤: ä½¿ç”¨add_custom_commandç¼–è¯‘ç›®æ ‡ï¼Œç”Ÿæˆè¾“å‡ºæ–‡ä»¶ã€‚ add_custom_targetçš„æ‰§è¡Œæ²¡æœ‰è¾“å‡ºã€‚ æ„å»ºç›®æ ‡å‰åï¼Œadd_custom_commandçš„æ‰§è¡Œå¯ä»¥æ²¡æœ‰è¾“å‡ºã€‚ è¿™ä¸‰ä¸ªé€‰é¡¹å¼ºåˆ¶æ‰§è¡Œç‰¹å®šçš„è¯­ä¹‰ï¼Œå¹¶ä¸”ä¸å¯äº’æ¢ã€‚æ¥ä¸‹æ¥çš„æˆ‘ä»¬å°†åˆ†åˆ«å­¦ä¹ å…·ä½“çš„ç”¨æ³•ã€‚ ","date":"2024-01-30","objectID":"/posts/cmake_note_24/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [24] æ„å»ºæ—¶è¿è¡Œè‡ªå®šä¹‰å‘½ä»¤add_custom_command","uri":"/posts/cmake_note_24/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ æœ¬é¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹add_custom_commandçš„ç®€å•ä½¿ç”¨ï¼Œæ¥æ¢ç´¢å®ƒçš„åŠŸèƒ½ã€‚ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ config â”‚ â””â”€â”€ config.txt â””â”€â”€ test.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter5/02 CMakeLists.txt cmake_minimum_required(VERSION 3.0) project(custom_command_example) # Set static library to lib file set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib) # Set dynamic library to lib file set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib) # Set dynamic runtime library or exetuable file to bin file set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin) add_executable(${PROJECT_NAME} test.cpp) if (MSVC) file(GLOB config_file \"${CMAKE_SOURCE_DIR}/config/*.txt\") add_custom_command(TARGET ${PROJECT_NAME} POST_BUILD COMMAND ${CMAKE_COMMAND} -E copy_if_different ${config_file} $\u003cTARGET_FILE_DIR:${PROJECT_NAME}\u003e) elseif(UNIX) file(GLOB config_file \"${CMAKE_SOURCE_DIR}/config/*.txt\") file(COPY ${config_file} DESTINATION ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}) endif() å¼•ç”¨ add_custom_command æ˜¯ CMake ä¸­çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºå‘æ„å»ºç³»ç»Ÿæ·»åŠ è‡ªå®šä¹‰çš„æ„å»ºè§„åˆ™æˆ–è‡ªå®šä¹‰å‘½ä»¤ã€‚è¿™å¯ä»¥ç”¨äºæ‰§è¡Œå„ç§ä»»åŠ¡ï¼Œå¦‚ç”Ÿæˆæºæ–‡ä»¶ã€æ‹·è´æ–‡ä»¶ã€æ‰§è¡Œè„šæœ¬ç­‰ã€‚å®ƒå…è®¸åœ¨ CMake æ„å»ºè¿‡ç¨‹ä¸­å®šä¹‰ä¸€äº›é¢å¤–çš„æ“ä½œã€‚ ä»¥ä¸‹æ˜¯ add_custom_command å‘½ä»¤çš„ä¸€èˆ¬è¯­æ³•å’Œå‚æ•°ï¼š add_custom_command( OUTPUT output1 [output2...] COMMAND command1 [ARGS] [command2 [ARGS] ...] [MAIN_DEPENDENCY depend] [DEPENDS depend [depend ...]] [WORKING_DIRECTORY dir] [COMMENT comment] [VERBATIM] [APPEND] [USES_TERMINAL] ) OUTPUT output1 [output2...]: æŒ‡å®šå‘½ä»¤æ‰§è¡Œåç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶é€šå¸¸æ˜¯æ„å»ºè¿‡ç¨‹çš„ç›®æ ‡ï¼Œå¯ä»¥æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ã€åº“æ–‡ä»¶ã€æ•°æ®æ–‡ä»¶ç­‰ã€‚ COMMAND command1 [ARGS] [command2 [ARGS] ...]: å®šä¹‰è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚è¿™å¯ä»¥æ˜¯å¤–éƒ¨å‘½ä»¤ã€è„šæœ¬æˆ–è‡ªå®šä¹‰æ“ä½œã€‚ MAIN_DEPENDENCY depend: æŒ‡å®šä¸»è¦çš„ä¾èµ–é¡¹ï¼Œé€šå¸¸æ˜¯å½±å“å‘½ä»¤æ‰§è¡Œçš„æ–‡ä»¶ã€‚å¦‚æœ depend è¢«ä¿®æ”¹ï¼Œå‘½ä»¤å°†é‡æ–°è¿è¡Œã€‚ DEPENDS depend [depend ...]: æŒ‡å®šå…¶ä»–ä¾èµ–é¡¹ã€‚è¿™äº›æ–‡ä»¶ä¼šè§¦å‘å‘½ä»¤é‡æ–°è¿è¡Œï¼Œå¦‚æœå®ƒä»¬è¢«ä¿®æ”¹ã€‚ WORKING_DIRECTORY dir: æŒ‡å®šå‘½ä»¤æ‰§è¡Œçš„å·¥ä½œç›®å½•ã€‚ COMMENT comment: å¯é€‰ï¼Œç”¨äºæè¿°è‡ªå®šä¹‰å‘½ä»¤çš„æ–‡æœ¬æ³¨é‡Šã€‚ VERBATIM: å¯é€‰ï¼Œå‘Šè¯‰ CMake ä¿æŒå‘½ä»¤çš„å‚æ•°ä¸å˜ï¼Œä¸è¿›è¡Œä»»ä½•è½¬ä¹‰ã€‚ APPEND: å¯é€‰ï¼Œå°†æ–°çš„è‡ªå®šä¹‰å‘½ä»¤è¿½åŠ åˆ°åŒä¸€è¾“å‡ºæ–‡ä»¶ä¸Šã€‚ USES_TERMINAL: å¯é€‰ï¼ŒæŒ‡ç¤ºå‘½ä»¤æ˜¯å¦ä½¿ç”¨ç»ˆç«¯ã€‚ é€šå¸¸ï¼Œadd_custom_command ç”¨äºåœ¨æ„å»ºæœŸé—´æ‰§è¡Œä¸€äº›éæ ‡å‡†çš„æ“ä½œï¼Œä¾‹å¦‚ç”Ÿæˆä»£ç ã€è½¬æ¢æ–‡ä»¶æ ¼å¼ã€è¿è¡Œæµ‹è¯•æˆ–å…¶ä»–è‡ªå®šä¹‰ä»»åŠ¡ã€‚è¿™å¯ä»¥å¸®åŠ©æ‚¨åœ¨ CMake æ„å»ºç³»ç»Ÿä¸­æ·»åŠ é¢å¤–çš„æ­¥éª¤ï¼Œä»¥æ»¡è¶³é¡¹ç›®çš„ç‰¹å®šéœ€æ±‚ã€‚ æœ¬é¡¹ç›®éœ€è¦åœ¨Windowsç³»ç»Ÿä¸­æ„å»ºï¼Œä»¥æ¢ç©¶add_custom_command å‘½ä»¤çš„åŠŸèƒ½ã€‚è¯¥å‘½ä»¤åœ¨æœ¬é¡¹ç›®ä¸­çš„ä¸»è¦åŠŸèƒ½æ˜¯å°†æ ¹ç›®å½•ä¸‹configÂ·æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰txtæœ¬æ–‡æ–‡ä»¶æ‹·è´åˆ°å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚ ä¹‹æ‰€ä»¥åœ¨Windowsä¸­çš„å‘½ä»¤å’ŒLinuxä¸­çš„å‘½ä»¤ä¸ä¸€æ ·ï¼Œæ ¹æœ¬åŸå› æ˜¯ç”±äºæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿçš„ä¸åŒé€ æˆçš„ã€‚ ç›¸å…³æºç  test.cpp #include \u003cfstream\u003e #include \u003ciostream\u003e #include \u003cstring\u003e int main() { // æ–‡ä»¶è·¯å¾„ std::string file_name = \"config.txt\"; // æ‰“å¼€æ–‡ä»¶ std::ifstream file(file_name); // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€ if (!file.is_open()) { std::cerr \u003c\u003c \"æ— æ³•æ‰“å¼€æ–‡ä»¶: \" \u003c\u003c file_name \u003c\u003c std::endl; return 1; } std::string line; // é€è¡Œè¯»å–æ–‡ä»¶å†…å®¹ while (std::getline(file, line)) { std::cout \u003c\u003c line \u003c\u003c std::endl; } // å…³é—­æ–‡ä»¶ file.close(); return 0; } è¿è¡Œç»“æœ version: 0.0.1 author: jiangli email: 1316762810@qq.com ","date":"2024-01-30","objectID":"/posts/cmake_note_24/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [24] æ„å»ºæ—¶è¿è¡Œè‡ªå®šä¹‰å‘½ä»¤add_custom_command","uri":"/posts/cmake_note_24/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ å·²ç»å¥½ä¹…å¥½ä¹…æ²¡æœ‰æ›´æ–°è¿™ä¸ªç³»åˆ—äº†ï¼Œä½†æ˜¯æ— è®ºå¦‚ä½•è¿™ä¸ªç³»åˆ—ä¸€å®šä¼šä»¥è¾ƒå…¨é¢çš„å½¢å¼æ›´æ–°å®Œæˆï¼Œåªæ˜¯åœ¨æ—¶é—´ä¸Šå¯èƒ½æ¯”è¾ƒæ‹–æ²“ã€‚æ²¡æœ‰æ›´æ–°çš„åŸå› ä¹Ÿæ˜¯æœ€è¿‘ä¸€ä¸ªæœˆåœ¨åšä¸€ä¸ªé¡¹ç›®ï¼Œæ²¡æ—¥æ²¡å¤œçš„åº¦è¿‡äº†ä¸€ä¸ªå¤šæœˆçš„åŠ ç­åŠ ç‚¹çš„ç”Ÿæ´»ã€‚ æˆ‘ä»¬è¨€å½’æ­£ä¼ ï¼Œé€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†CMakeå¦‚ä½•åœ¨é…ç½®æ—¶è¿è¡Œè®¸å¤šå­ä»»åŠ¡ï¼Œä»¥ä¾¿æ‰¾åˆ°å·¥ä½œçš„ç¼–è¯‘å™¨å’Œå¿…è¦çš„ä¾èµ–é¡¹ã€‚æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ä½¿ç”¨execute_processå‘½ä»¤åœ¨é…ç½®æ—¶è¿è¡Œå®šåˆ¶åŒ–å‘½ä»¤ã€‚ ","date":"2024-01-30","objectID":"/posts/cmake_note_23/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [23] é…ç½®æ—¶è¿è¡Œè‡ªå®šä¹‰å‘½ä»¤","uri":"/posts/cmake_note_23/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ æœ¬ç¯‡æ¯”è¾ƒç®€å•ï¼Œåªæœ‰ä¸€ä¸ªç®€å•çš„CMakeLists.txtã€‚ ç›¸å…³æºç ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter5/01 CMakeLists.txt cmake_minimum_required(VERSION 3.5 FATAL_ERROR) project(test_exe_proc LANGUAGES NONE) find_package(PythonInterp REQUIRED) # this is set as variable to prepare for abstraction using loops or functions set(module_name \"cffi\") execute_process( COMMAND ${PYTHON_EXECUTABLE} \"-c\" \"import ${module_name}; print(${module_name}.__version__)\" OUTPUT_VARIABLE stdout ERROR_VARIABLE stderr OUTPUT_STRIP_TRAILING_WHITESPACE ERROR_STRIP_TRAILING_WHITESPACE ) if(stderr MATCHES \"ModuleNotFoundError\") message(STATUS \"Module ${module_name} not found\") else() message(STATUS \"Found module ${module_name} v${stdout}\") endif() ä»£ç è¯¦è§£ execute_processå‘½ä»¤å°†ä»å½“å‰æ­£åœ¨æ‰§è¡Œçš„CMakeè¿›ç¨‹ä¸­æ´¾ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªå­è¿›ç¨‹ï¼Œä»è€Œæä¾›äº†åœ¨é…ç½®é¡¹ç›®æ—¶è¿è¡Œä»»æ„å‘½ä»¤çš„æ–¹æ³•ã€‚å¯ä»¥åœ¨ä¸€æ¬¡è°ƒç”¨execute_processæ—¶æ‰§è¡Œå¤šä¸ªå‘½ä»¤ã€‚æ³¨æ„ï¼Œæ¯ä¸ªå‘½ä»¤çš„è¾“å‡ºå°†é€šè¿‡ç®¡é“ä¼ è¾“åˆ°ä¸‹ä¸€ä¸ªå‘½ä»¤ä¸­ã€‚è¯¥å‘½ä»¤æ¥å—å¤šä¸ªå‚æ•°: WORKING_DIRECTORYï¼ŒæŒ‡å®šåº”è¯¥åœ¨å“ªä¸ªç›®å½•ä¸­æ‰§è¡Œå‘½ä»¤ã€‚ RESULT_VARIABLEå°†åŒ…å«è¿›ç¨‹è¿è¡Œçš„ç»“æœã€‚è¿™è¦ä¹ˆæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ªå¸¦æœ‰é”™è¯¯æ¡ä»¶çš„å­—ç¬¦ä¸²ã€‚ OUTPUT_VARIABLEå’ŒERROR_VARIABLEå°†åŒ…å«æ‰§è¡Œå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ã€‚ç”±äºå‘½ä»¤çš„è¾“å‡ºæ˜¯é€šè¿‡ç®¡é“ä¼ è¾“çš„ï¼Œå› æ­¤åªæœ‰æœ€åä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºæ‰ä¼šä¿å­˜åˆ°OUTPUT_VARIABLEä¸­ã€‚ INPUT_FILEæŒ‡å®šæ ‡å‡†è¾“å…¥é‡å®šå‘çš„æ–‡ä»¶å OUTPUT_FILEæŒ‡å®šæ ‡å‡†è¾“å‡ºé‡å®šå‘çš„æ–‡ä»¶å ERROR_FILEæŒ‡å®šæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘çš„æ–‡ä»¶å è®¾ç½®OUTPUT_QUIETå’ŒERROR_QUIETåï¼ŒCMakeå°†é™é»˜åœ°å¿½ç•¥æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ã€‚ è®¾ç½®OUTPUT_STRIP_TRAILING_WHITESPACEï¼Œå¯ä»¥åˆ é™¤è¿è¡Œå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºä¸­çš„ä»»ä½•å°¾éšç©ºæ ¼ è®¾ç½®ERROR_STRIP_TRAILING_WHITESPACEï¼Œå¯ä»¥åˆ é™¤è¿è¡Œå‘½ä»¤çš„é”™è¯¯è¾“å‡ºä¸­çš„ä»»ä½•å°¾éšç©ºæ ¼ execute_process( COMMAND ${PYTHON_EXECUTABLE} \"-c\" \"import ${module_name}; print(${module_name}.__version__)\" OUTPUT_VARIABLE stdout ERROR_VARIABLE stderr OUTPUT_STRIP_TRAILING_WHITESPACE ERROR_STRIP_TRAILING_WHITESPACE ) è¯¥å‘½ä»¤æ£€æŸ¥python -c \"import cffi; print(cffi.__version__)\"çš„è¾“å‡ºã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ¨¡å—ï¼Œstderrå°†åŒ…å«ModuleNotFoundErrorï¼Œæˆ‘ä»¬å°†åœ¨ifè¯­å¥ä¸­å¯¹å…¶è¿›è¡Œæ£€æŸ¥ã€‚æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æ‰“å°Module cffi not foundã€‚å¦‚æœå¯¼å…¥æˆåŠŸï¼ŒPythonä»£ç å°†æ‰“å°æ¨¡å—çš„ç‰ˆæœ¬ï¼Œè¯¥æ¨¡å—é€šè¿‡ç®¡é“è¾“å…¥stdoutï¼Œè¿™æ ·å°±å¯ä»¥æ‰“å°å¦‚ä¸‹å†…å®¹: message(STATUS \"Found module ${_module_name} v${stdout}\") è¿è¡Œç»“æœ mkdir build cd build cmake .. -- Found PythonInterp: /usr/bin/python3.8 (found version \"3.8.10\") -- Module cffi not found -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter5/01/build sudo pip3 install cffi mkdir build cd build cmake .. -- Found module cffi v1.16.0 -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter5/01/build è¡¥å……è¯´æ˜ æœ¬ç¯‡ï¼Œåªæ‰“å°äº†ç»“æœï¼Œä½†å®é™…é¡¹ç›®ä¸­ï¼Œå¯ä»¥è­¦å‘Šã€ä¸­æ­¢é…ç½®ï¼Œæˆ–è€…è®¾ç½®å¯ä»¥æŸ¥è¯¢çš„å˜é‡ï¼Œæ¥åˆ‡æ¢æŸäº›é…ç½®é€‰é¡¹ã€‚ ","date":"2024-01-30","objectID":"/posts/cmake_note_23/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [23] é…ç½®æ—¶è¿è¡Œè‡ªå®šä¹‰å‘½ä»¤","uri":"/posts/cmake_note_23/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ Original jjjstephen Hope Hut 2023-09-21 09:03 Posted on å¤©æ´¥ å¯¼è¨€ é€šè¿‡å‰å‡ ç¯‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åŸºæœ¬æŒæ¡äº†å…³äºå•å…ƒæµ‹è¯•çš„ç›¸å…³å†…å®¹ã€‚å½“ç„¶ï¼Œéšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œæ ¹æ®ä¸åŒä¸šåŠ¡çš„éœ€æ±‚æµ‹è¯•æ¡†æ¶å±‚å‡ºä¸ç©·ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•ä¸€ä¸€åˆ—ä¸¾ã€‚æœ¬ç¯‡æˆ‘ä»¬å°†è¡¥å……å‡ ä¸ªæµ‹è¯•çš„ç›¸å…³æŠ€æœ¯ï¼Œå¦‚é¢„æœŸå¤±è´¥ã€å¹¶è¡Œæµ‹è¯•ä»¥åŠæµ‹è¯•å­é›†ç­‰ã€‚ ","date":"2024-01-30","objectID":"/posts/cmake_note_22/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [22] æµ‹è¯•çš„å…¶ä»–è¡¥å……(é‡è¦)","uri":"/posts/cmake_note_22/"},{"categories":["C++"],"content":"äºŒã€é¢„æœŸæµ‹è¯•å¤±è´¥ ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰€æœ‰çš„æµ‹è¯•èƒ½åœ¨æ¯ä¸ªå¹³å°ä¸Šé€šè¿‡ã€‚ç„¶è€Œï¼Œä¹Ÿå¯èƒ½æƒ³è¦æµ‹è¯•é¢„æœŸçš„å¤±è´¥æˆ–å¼‚å¸¸æ˜¯å¦ä¼šåœ¨å—æ§çš„è®¾ç½®ä¸­è¿›è¡Œã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†æŠŠé¢„æœŸçš„å¤±è´¥å®šä¹‰ä¸ºæˆåŠŸã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œè¿™é€šå¸¸åº”è¯¥äº¤ç»™æµ‹è¯•æ¡†æ¶(ä¾‹å¦‚ï¼šCatch2æˆ–Google Test)çš„ä»»åŠ¡ï¼Œå®ƒåº”è¯¥æ£€æŸ¥é¢„æœŸçš„å¤±è´¥å¹¶å‘CMakeæŠ¥å‘ŠæˆåŠŸã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½å¸Œæœ›å°†æµ‹è¯•çš„éé›¶è¿”å›ä»£ç å®šä¹‰ä¸ºæˆåŠŸï¼›æ¢å¥è¯è¯´ï¼Œå¯èƒ½æƒ³è¦é¢ å€’æˆåŠŸå’Œå¤±è´¥çš„å®šä¹‰ã€‚ é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ test.py é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter4/05 CMakeLists.txt cmake_minimum_required(VERSION 3.5 FATAL_ERROR) project(test_error LANGUAGES NONE) find_package(PythonInterp REQUIRED) enable_testing() add_test(example ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test.py) set_tests_properties(example PROPERTIES WILL_FAIL true) å¼•ç”¨ å®šä¹‰æµ‹è¯•å¹¶å‘Šè¯‰CMakeï¼Œæµ‹è¯•é¢„æœŸä¼šå¤±è´¥: set_tests_properties(example PROPERTIES WILL_FAIL true) ç›¸å…³æºç  test.py import sys # simulate a failing test sys.exit(1) è¾“å‡ºç»“æœ Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/05/build Start 1: example 1/1 Test #1: example .......................... Passed 0.01 sec 100% tests passed, 0 tests failed out of 1 Total Test time (real) = 0.02 sec ","date":"2024-01-30","objectID":"/posts/cmake_note_22/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [22] æµ‹è¯•çš„å…¶ä»–è¡¥å……(é‡è¦)","uri":"/posts/cmake_note_22/"},{"categories":["C++"],"content":"ä¸‰ã€ä½¿ç”¨è¶…æ—¶æµ‹è¯•è¿è¡Œæ—¶é—´è¿‡é•¿çš„æµ‹è¯• ç†æƒ³æƒ…å†µä¸‹ï¼Œæµ‹è¯•é›†åº”è¯¥èŠ±å¾ˆçŸ­çš„æ—¶é—´è¿›è¡Œï¼Œä»¥ä¾¿å¼€å‘äººå‘˜ç»å¸¸è¿è¡Œæµ‹è¯•ï¼Œå¹¶ä½¿æ¯ä¸ªæäº¤(å˜æ›´é›†)è¿›è¡Œæµ‹è¯•æˆä¸ºå¯èƒ½(æˆ–æ›´å®¹æ˜“)ã€‚ç„¶è€Œï¼Œæœ‰äº›æµ‹è¯•å¯èƒ½ä¼šèŠ±è´¹æ›´é•¿çš„æ—¶é—´æˆ–è€…è¢«å¡ä½(ä¾‹å¦‚ï¼Œç”±äºé«˜æ–‡ä»¶I/Oè´Ÿè½½)ï¼Œå¯èƒ½éœ€è¦è®¾ç½®è¶…æ—¶æ¥ç»ˆæ­¢è€—æ—¶è¿‡é•¿çš„æµ‹è¯•ï¼Œå®ƒä»¬å»¶è¿Ÿäº†æ•´ä¸ªæµ‹è¯•ï¼Œå¹¶é˜»å¡äº†éƒ¨ç½²ç®¡é“ã€‚æœ¬èŠ‚ï¼Œå°†é€šè¿‡ä¸€ç§è®¾ç½®è¶…æ—¶çš„æ–¹æ³•ï¼Œå¯ä»¥é’ˆå¯¹æ¯ä¸ªæµ‹è¯•è®¾ç½®ä¸åŒçš„è¶…æ—¶ã€‚ é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ test.py é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter4/06 CMakeLists.txt cmake_minimum_required(VERSION 3.5 FATAL_ERROR) project(test_long_test LANGUAGES NONE) find_package(PythonInterp REQUIRED) enable_testing() add_test(example ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test.py) set_tests_properties(example PROPERTIES TIMEOUT 10) set_tests_properties(example PROPERTIES TIMEOUT 10) ä¸ºæµ‹è¯•æŒ‡å®šæ—¶é™ï¼Œè®¾ç½®ä¸º10ç§’ ç›¸å…³æºç  test.py import sys import time # wait for 2 seconds time.sleep(2) # report success sys.exit(0) è¾“å‡ºç»“æœ mkdir build \u0026 cd build cmake .. ctest Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/06/build Start 1: example 1/1 Test #1: example .......................... Passed 2.01 sec 100% tests passed, 0 tests failed out of 1 Total Test time (real) = 2.02 sec ä¸ºäº†éªŒè¯è¶…æ—¶æ˜¯å¦æœ‰æ•ˆï¼Œå°†test.pyä¸­çš„sleepå‘½ä»¤å¢åŠ åˆ°11ç§’ï¼Œå¹¶é‡æ–°è¿è¡Œæµ‹è¯•: Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/06/build Start 1: example 1/1 Test #1: example ..........................***Timeout 10.02 sec 0% tests passed, 1 tests failed out of 1 Total Test time (real) = 10.02 sec The following tests FAILED: 1 - example (Timeout) Errors while running CTest ","date":"2024-01-30","objectID":"/posts/cmake_note_22/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [22] æµ‹è¯•çš„å…¶ä»–è¡¥å……(é‡è¦)","uri":"/posts/cmake_note_22/"},{"categories":["C++"],"content":"å››ã€å¹¶è¡Œæµ‹è¯• å¤§å¤šæ•°ç°ä»£è®¡ç®—æœºéƒ½æœ‰4ä¸ªæˆ–æ›´å¤šä¸ªCPUæ ¸èŠ¯ã€‚CTestæœ‰ä¸ªéå¸¸æ£’çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿå¹¶è¡Œè¿è¡Œæµ‹è¯•ï¼Œå¦‚æœæœ‰å¤šä¸ªå¯ç”¨çš„æ ¸ã€‚è¿™å¯ä»¥å‡å°‘æµ‹è¯•çš„æ€»æ—¶é—´ã€‚ é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ test â”œâ”€â”€ a.py â”œâ”€â”€ b.py â”œâ”€â”€ c.py â”œâ”€â”€ d.py â”œâ”€â”€ e.py â”œâ”€â”€ f.py â”œâ”€â”€ g.py â”œâ”€â”€ h.py â”œâ”€â”€ i.py â””â”€â”€ j.py é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter4/07 CMakeLists.txts cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(recipe-08 LANGUAGES NONE) find_package(PythonInterp REQUIRED) enable_testing() add_test(a ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/a.py) add_test(b ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/b.py) add_test(c ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/c.py) add_test(d ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/d.py) add_test(e ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/e.py) add_test(f ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/f.py) add_test(g ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/g.py) add_test(h ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/h.py) add_test(i ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/i.py) add_test(j ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/j.py ç›¸å…³æºç  è¿™é‡Œæˆ‘ä»¬åªç»™å‡ºäº†ä¸€ä¸ªpythonæ–‡ä»¶ï¼Œå…¶ä»–æ–‡ä»¶æŒ‰ç…§å¦‚ä¸‹è¡¨æ ¼è®¾ç½®æ—¶é—´å³å¯ã€‚ æµ‹è¯•ç”¨ä¾‹ è¯¥å•å…ƒè€—æ—¶ a,b,c,d 0.5 e,f,g 1.5 h 2.5 i 3.5 j 4.5 a.py import sys import time # wait for 0.5 seconds time.sleep(0.5) # finally report success sys.exit(0) è¾“å‡ºç»“æœ mkdir build \u0026 cd build cmake .. ctest Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/07/build Start 1: a 1/10 Test #1: a ................................ Passed 0.51 sec Start 2: b 2/10 Test #2: b ................................ Passed 0.52 sec Start 3: c 3/10 Test #3: c ................................ Passed 0.52 sec Start 4: d 4/10 Test #4: d ................................ Passed 0.52 sec Start 5: e 5/10 Test #5: e ................................ Passed 1.52 sec Start 6: f 6/10 Test #6: f ................................ Passed 1.52 sec Start 7: g 7/10 Test #7: g ................................ Passed 1.52 sec Start 8: h 8/10 Test #8: h ................................ Passed 2.52 sec Start 9: i 9/10 Test #9: i ................................ Passed 3.52 sec Start 10: j 10/10 Test #10: j ................................ Passed 4.52 sec 100% tests passed, 0 tests failed out of 10 Total Test time (real) = 17.20 sec ctest --parallel 4 Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/07/build Start 10: j Start 9: i Start 8: h Start 7: g 1/10 Test #7: g ................................ Passed 1.51 sec Start 6: f 2/10 Test #8: h ................................ Passed 2.51 sec Start 5: e 3/10 Test #6: f ................................ Passed 1.51 sec Start 4: d 4/10 Test #9: i ................................ Passed 3.52 sec Start 3: c 5/10 Test #4: d ................................ Passed 0.51 sec Start 2: b 6/10 Test #5: e ................................ Passed 1.51 sec Start 1: a 7/10 Test #3: c ................................ Passed 0.51 sec 8/10 Test #2: b ................................ Passed 0.51 sec 9/10 Test #10: j ................................ Passed 4.51 sec 10/10 Test #1: a ................................ Passed 0.51 sec 100% tests passed, 0 tests failed out of 10 Total Test time (real) = 4.54 sec ctest --parallel 8 Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/07/build Start 10: j Start 9: i Start 8: h Start 7: g Start 6: f Start 5: e Start 4: d Start 2: b 1/10 Test #4: d ................................ Passed 0.52 sec Start 3: c 2/10 Test #2: b ................................ Passed 0.52 sec Start 1: a 3/10 Test #3: c ................................ Passed 0.51 sec 4/10 Test #1: a ................................ Passed 0.51 sec 5/10 Test #7: g ................................ Passed 1.52 sec 6/10 Test #6: f ................................ Passed 1.52 sec 7/10 Test #5: e ................................ Passed 1.52 sec 8/10 Test #8: h ................................ Passed 2.52 sec 9/10 Test #9: i .......................","date":"2024-01-30","objectID":"/posts/cmake_note_22/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [22] æµ‹è¯•çš„å…¶ä»–è¡¥å……(é‡è¦)","uri":"/posts/cmake_note_22/"},{"categories":["C++"],"content":"äº”ã€è¿è¡Œæµ‹è¯•å­é›† å‰å‡ èŠ‚ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åœ¨CMakeçš„å¸®åŠ©ä¸‹å¹¶è¡Œè¿è¡Œæµ‹è¯•ï¼Œå¹¶è®¨è®ºäº†ä»æœ€é•¿çš„æµ‹è¯•å¼€å§‹æ˜¯æœ€é«˜æ•ˆçš„ã€‚è™½ç„¶ï¼Œè¿™ç§ç­–ç•¥å°†æ€»æµ‹è¯•æ—¶é—´æœ€å°åŒ–ï¼Œä½†æ˜¯åœ¨ç‰¹å®šç‰¹æ€§çš„ä»£ç å¼€å‘æœŸé—´ï¼Œæˆ–è€…åœ¨è°ƒè¯•æœŸé—´ï¼Œæˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›è¿è¡Œæ•´ä¸ªæµ‹è¯•é›†ã€‚å¯¹äºè°ƒè¯•å’Œä»£ç å¼€å‘ï¼Œæˆ‘ä»¬åªéœ€è¦èƒ½å¤Ÿè¿è¡Œé€‰å®šçš„æµ‹è¯•å­é›†ã€‚té€šè¿‡æœ¬èŠ‚æˆ‘ä»¬å¯¹è¿™ä¸€ç­–ç•¥è¿›è¡Œè¿›ä¸€æ­¥æ¢ç©¶ã€‚ é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ test â”œâ”€â”€ benchmark-a.py â”œâ”€â”€ benchmark-b.py â”œâ”€â”€ feature-a.py â”œâ”€â”€ feature-b.py â”œâ”€â”€ feature-c.py â””â”€â”€ feature-d.py é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter4/08 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(test_subset LANGUAGES NONE) find_package(PythonInterp REQUIRED) enable_testing() add_test( NAME feature-a COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/feature-a.py ) add_test( NAME feature-b COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/feature-b.py ) add_test( NAME feature-c COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/feature-c.py ) add_test( NAME feature-d COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/feature-d.py ) add_test( NAME benchmark-a COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/benchmark-a.py ) add_test( NAME benchmark-b COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/benchmark-b.py ) set_tests_properties( feature-a feature-b feature-c PROPERTIES LABELS \"quick\" ) set_tests_properties( feature-d benchmark-a benchmark-b PROPERTIES LABELS \"long\" ) ç»™è¾ƒçŸ­çš„æµ‹è¯•è´´ä¸Šquickçš„æ ‡ç­¾ï¼Œç»™è¾ƒé•¿çš„æµ‹è¯•è´´ä¸Šlongçš„æ ‡ç­¾: set_tests_properties( feature-a feature-b feature-c PROPERTIES LABELS \"quick\" ) set_tests_properties( feature-d benchmark-a benchmark-b PROPERTIES LABELS \"long\" ) ç›¸å…³æºç  æˆ‘ä»¬å‡è®¾æ€»å…±æœ‰å…­ä¸ªæµ‹è¯•ï¼šå‰ä¸‰ä¸ªæµ‹è¯•æ¯”è¾ƒçŸ­ï¼Œåç§°åˆ†åˆ«ä¸ºfeature-aã€feature-bå’Œfeature-cï¼Œè¿˜æœ‰ä¸‰ä¸ªé•¿æµ‹è¯•ï¼Œåç§°åˆ†åˆ«æ˜¯feature-dã€benchmark-aå’Œbenchmark-bã€‚æˆ‘ä»¬åªç»™å‡ºfeature-a.pyï¼Œå…¶ä»–åªæ˜¯ç¡çœ æ—¶é—´çš„ä¸åŒã€‚ import sys import time # wait for 0.1 seconds time.sleep(1) # finally report success sys.exit(0) è¾“å‡ºç»“æœ ctest -R feature Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/08/build Start 1: feature-a 1/4 Test #1: feature-a ........................ Passed 0.11 sec Start 2: feature-b 2/4 Test #2: feature-b ........................ Passed 0.11 sec Start 3: feature-c 3/4 Test #3: feature-c ........................ Passed 0.11 sec Start 4: feature-d 4/4 Test #4: feature-d ........................ Passed 1.01 sec 100% tests passed, 0 tests failed out of 4 Label Time Summary: long = 1.01 sec*proc (1 test) quick = 0.33 sec*proc (3 tests) Total Test time (real) = 1.36 sec ctest -L long Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/08/build Start 4: feature-d 1/3 Test #4: feature-d ........................ Passed 1.01 sec Start 5: benchmark-a 2/3 Test #5: benchmark-a ...................... Passed 1.01 sec Start 6: benchmark-b 3/3 Test #6: benchmark-b ...................... Passed 1.01 sec 100% tests passed, 0 tests failed out of 3 Label Time Summary: long = 3.04 sec*proc (3 tests) Total Test time (real) = 3.04 sec ctest -L quick Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/08/build Start 1: feature-a 1/3 Test #1: feature-a ........................ Passed 0.11 sec Start 2: feature-b 2/3 Test #2: feature-b ........................ Passed 0.11 sec Start 3: feature-c 3/3 Test #3: feature-c ........................ Passed 0.12 sec 100% tests passed, 0 tests failed out of 3 Label Time Summary: quick = 0.34 sec*proc (3 tests) Total Test time (real) = 0.34 sec ","date":"2024-01-30","objectID":"/posts/cmake_note_22/:5:0","tags":["CMake"],"title":"CMake ç¬”è®° | [22] æµ‹è¯•çš„å…¶ä»–è¡¥å……(é‡è¦)","uri":"/posts/cmake_note_22/"},{"categories":["C++"],"content":"å…­ã€ä½¿ç”¨æµ‹è¯•å›ºä»¶ æœ¬èŠ‚å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨æµ‹è¯•å›ºä»¶ã€‚è¿™å¯¹äºæ›´å¤æ‚çš„æµ‹è¯•éå¸¸æœ‰ç”¨ï¼Œè¿™äº›æµ‹è¯•éœ€è¦åœ¨æµ‹è¯•è¿è¡Œå‰è¿›è¡Œè®¾ç½®ï¼Œä»¥åŠåœ¨æµ‹è¯•å®Œæˆåæ‰§è¡Œæ¸…ç†æ“ä½œ(ä¾‹å¦‚ï¼šåˆ›å»ºç¤ºä¾‹æ•°æ®åº“ã€è®¾ç½®è¿æ¥ã€æ–­å¼€è¿æ¥ã€æ¸…ç†æµ‹è¯•æ•°æ®åº“ç­‰ç­‰)ã€‚æˆ‘ä»¬éœ€è¦è¿è¡Œä¸€ä¸ªè®¾ç½®æˆ–æ¸…ç†æ“ä½œçš„æµ‹è¯•ï¼Œå¹¶èƒ½å¤Ÿä»¥ä¸€ç§å¯é¢„æµ‹å’Œå¥å£®çš„æ–¹å¼è‡ªåŠ¨è§¦å‘è¿™äº›æ­¥éª¤ï¼Œè€Œä¸éœ€è¦å¼•å…¥ä»£ç é‡å¤ã€‚è¿™äº›è®¾ç½®å’Œæ¸…ç†æ­¥éª¤å¯ä»¥å§”æ‰˜ç»™æµ‹è¯•æ¡†æ¶(ä¾‹å¦‚Google Testæˆ–Catch2)ã€‚ é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ test â”œâ”€â”€ cleanup.py â”œâ”€â”€ feature-a.py â”œâ”€â”€ feature-b.py â””â”€â”€ setup.py é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter4/09 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(test_firmware LANGUAGES NONE) find_package(PythonInterp REQUIRED) enable_testing() add_test( NAME setup COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/setup.py ) set_tests_properties( setup PROPERTIES FIXTURES_SETUP my-fixture ) add_test( NAME feature-a COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/feature-a.py ) add_test( NAME feature-b COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/feature-b.py ) set_tests_properties( feature-a feature-b PROPERTIES FIXTURES_REQUIRED my-fixture ) add_test( NAME cleanup COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/cleanup.py ) set_tests_properties( cleanup PROPERTIES FIXTURES_CLEANUP my-fixture ) add_test( NAME setup COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/setup.py ) set_tests_properties( setup PROPERTIES FIXTURES_SETUP my-fixture ) add_test( NAME feature-a COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/feature-a.py ) add_test( NAME feature-b COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/feature-b.py ) set_tests_properties( feature-a feature-b PROPERTIES FIXTURES_REQUIRED my-fixture ) add_test( NAME cleanup COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test/cleanup.py ) set_tests_properties( cleanup PROPERTIES FIXTURES_CLEANUP my-fixture ) å®šä¹‰äº†ä¸€ä¸ªæ–‡æœ¬å›ºä»¶ï¼Œå¹¶å°†å…¶ç§°ä¸ºmy-fixtureã€‚æˆ‘ä»¬ä¸ºå®‰è£…æµ‹è¯•æä¾›äº†FIXTURES_SETUPå±æ€§ï¼Œå¹¶ä¸ºæ¸…ç†æµ‹è¯•äº†FIXTURES_CLEANUPå±æ€§ï¼Œå¹¶ä¸”ä½¿ç”¨FIXTURES_REQUIREDï¼Œæˆ‘ä»¬ç¡®ä¿æµ‹è¯•feature-aå’Œfeature-béƒ½éœ€è¦å®‰è£…å’Œæ¸…ç†æ­¥éª¤æ‰èƒ½è¿è¡Œã€‚å°†å®ƒä»¬ç»‘å®šåœ¨ä¸€èµ·ï¼Œå¯ä»¥ç¡®ä¿åœ¨å®šä¹‰è‰¯å¥½çš„çŠ¶æ€ä¸‹ï¼Œè¿›å…¥å’Œç¦»å¼€ç›¸åº”çš„æ­¥éª¤ã€‚ ç›¸å…³æºç  setup.py import sys print(\"tearing down\") # report success sys.exit(0) feature-a.py import sys print(\"running test a\") # report success sys.exit(0) feature-b.py import sys print(\"running test b\") # report success sys.exit(0) clearup.py import sys print(\"tearing down\") # report success sys.exit(0) è¾“å‡ºç»“æœ ctest Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/09/build Start 1: setup 1/4 Test #1: setup ............................ Passed 0.01 sec Start 2: feature-a 2/4 Test #2: feature-a ........................ Passed 0.01 sec Start 3: feature-b 3/4 Test #3: feature-b ........................ Passed 0.01 sec Start 4: cleanup 4/4 Test #4: cleanup .......................... Passed 0.01 sec 100% tests passed, 0 tests failed out of 4 Total Test time (real) = 0.05 sec ctest -R feature-a Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/09/build Start 1: setup 1/3 Test #1: setup ............................ Passed 0.01 sec Start 2: feature-a 2/3 Test #2: feature-a ........................ Passed 0.01 sec Start 4: cleanup 3/3 Test #4: cleanup .......................... Passed 0.01 sec 100% tests passed, 0 tests failed out of 3 Total Test time (real) = 0.03 sec ","date":"2024-01-30","objectID":"/posts/cmake_note_22/:6:0","tags":["CMake"],"title":"CMake ç¬”è®° | [22] æµ‹è¯•çš„å…¶ä»–è¡¥å……(é‡è¦)","uri":"/posts/cmake_note_22/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ *ç›®å‰ï¼Œå†…å­˜ç¼ºé™·ï¼šå†™å…¥æˆ–è¯»å–è¶Šç•Œï¼Œæˆ–è€…å†…å­˜æ³„æ¼ï¼ˆå·²åˆ†é…ä½†ä»æœªé‡Šæ”¾çš„å†…å­˜ï¼‰ï¼Œä¼šç”Ÿäº§éš¾ä»¥è·Ÿè¸ªçš„*bug*ï¼Œæœ€å¥½å°½æ—©å°†å®ƒä»¬æ£€æŸ¥å‡ºæ¥ã€‚**Valgrind*æ˜¯ä¸€ä¸ªé€šç”¨çš„å·¥å…·ï¼Œç”¨æ¥æ£€æµ‹å†…å­˜ç¼ºé™·å’Œå†…å­˜æ³„æ¼ã€‚æœ¬ç¯‡å°†åœ¨ä½¿ç”¨*CMake/CTest*æµ‹è¯•æ—¶ä½¿ç”¨*Valgrind*å¯¹å†…å­˜é—®é¢˜è¿›è¡Œè­¦å‘Šã€‚ ","date":"2024-01-30","objectID":"/posts/cmake_note_21/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [21] åˆ©ç”¨Valgrindæ¥æ£€æµ‹å†…å­˜ç¼ºé™·","uri":"/posts/cmake_note_21/"},{"categories":["C++"],"content":"äºŒã€Valgrindå®‰è£… ä¸‹è½½Valgrind wget https://sourceware.org/pub/valgrind/valgrind-3.21.0.tar.bz2 è§£å‹ tar -xjvf valgrind-3.15.0.tar.bz2 cd valgrind-3.21.0 é…ç½® ./configure ç¼–è¯‘ make å®‰è£… sudo make install ","date":"2024-01-30","objectID":"/posts/cmake_note_21/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [21] åˆ©ç”¨Valgrindæ¥æ£€æµ‹å†…å­˜ç¼ºé™·","uri":"/posts/cmake_note_21/"},{"categories":["C++"],"content":"ä¸‰ã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ leaky_implementation.cpp â”œâ”€â”€ leaky_implementation.h â””â”€â”€ test.cpp é¡¹ç›®ç»“æ„ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter4/04 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(test_leaky LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) add_library(example_library leaky_implementation.cpp) add_executable(cpp_test test.cpp) target_link_libraries(cpp_test example_library) find_program(MEMORYCHECK_COMMAND NAMES valgrind) set(MEMORYCHECK_COMMAND_OPTIONS \"--trace-children=yes --leak-check=full\") # add memcheck test action include(CTest) enable_testing() add_test( NAME cpp_test COMMAND $\u003cTARGET_FILE:cpp_test\u003e ) å¼•ç”¨ find_program(MEMORYCHECK_COMMAND NAMES valgrind) æŸ¥æ‰¾valgrindï¼Œå¹¶å°†MEMORYCHECK_COMMANDè®¾ç½®ä¸ºå…¶ç»å¯¹è·¯å¾„ã€‚ å¼•ç”¨ set(MEMORYCHECK_COMMAND_OPTIONS \"--trace-children=yes --leak-check=full\") å°†ç›¸å…³å‚æ•°ä¼ é€’ç»™Valgrindã€‚å†…å­˜æ£€æŸ¥ä¼šåˆ›å»ºä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å¯ç”¨äºè¯¦ç»†è®°å½•å†…å­˜ç¼ºé™·ä¿¡æ¯ã€‚ ç›¸å…³æºç  leaky_implementation.h #ifndef LEAKY_IMPLEMENTATION_H #define LEAKY_IMPLEMENTATION_H int DoSomeWork(); #endif // ï¼LEAKY_IMPLEMENTATION_H leaky_implementation.cpp #include \"leaky_implementation.h\" int DoSomeWork() { // we allocate an array double *default_array = new double[1000]; // do some work // ... // we forget to deallocate it // delete[] default_array; return 0; } test.cpp #include \"leaky_implementation.h\" int main() { int ret = DoSomeWork(); return ret; } è¾“å‡ºç»“æœ Site: jiangli-virtual-machine Build name: Linux-g++ Memory check project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/04/build Start 1: cpp_test 1/1 MemCheck #1: cpp_test ......................... Passed 1.03 sec 100% tests passed, 0 tests failed out of 1 Total Test time (real) = 1.03 sec -- Processing memory checking output: 1/1 MemCheck: #1: cpp_test ......................... Defects: 1 MemCheck log files can be found here: ( * corresponds to test number) /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/04/build/Testing/Temporary/MemoryChecker.*.log Memory checking results: Memory Leak - 1 ","date":"2024-01-30","objectID":"/posts/cmake_note_21/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [21] åˆ©ç”¨Valgrindæ¥æ£€æµ‹å†…å­˜ç¼ºé™·","uri":"/posts/cmake_note_21/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ æœ¬ç¯‡ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åœ¨CMakeçš„å¸®åŠ©ä¸‹ä½¿ç”¨Google Testæ¡†æ¶å®ç°å•å…ƒæµ‹è¯•ã€‚ä¸å‰ä¸€ä¸ªé…ç½®ï¼ˆCatch2ï¼‰ç›¸æ¯”ï¼ŒGoogle Testæ¡†æ¶ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå¤´æ–‡ä»¶ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªåº“ï¼ŒåŒ…å«ä¸¤ä¸ªéœ€è¦æ„å»ºå’Œé“¾æ¥çš„æ–‡ä»¶ã€‚å¯ä»¥å°†å®ƒä»¬ä¸æˆ‘ä»¬çš„ä»£ç é¡¹ç›®æ”¾åœ¨ä¸€èµ·ï¼Œä½†æ˜¯ä¸ºäº†ä½¿é¡¹ç›®æ›´åŠ è½»é‡çº§ï¼Œæˆ‘ä»¬å°†é€‰æ‹©åœ¨é…ç½®æ—¶ï¼Œä¸‹è½½ä¸€ä¸ªå®šä¹‰è‰¯å¥½çš„Google Testï¼Œç„¶åæ„å»ºæ¡†æ¶å¹¶é“¾æ¥å®ƒã€‚æˆ‘ä»¬å°†ä½¿ç”¨è¾ƒæ–°çš„FetchContentæ¨¡å—ï¼ˆä»CMakeç‰ˆæœ¬3.11å¼€å§‹å¯ç”¨ï¼‰ã€‚å…³äºç›¸å…³ä½¿ç”¨å°†åœ¨åç»­çš„ç¬”è®°ä¸­å­¦ä¹ ã€‚ æ­¤å¤–æˆ‘ä»¬å°†åœ¨ç›¸å…³æµ‹è¯•å†…åŒå­¦ä¹ å®ŒæˆåæŒ‘é€‰ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼ˆç›®å‰Google Testæ›´åŠ æµè¡Œï¼‰*å†™ä¸€ä¸ªå°çš„é¡¹ç›®å®è·µï¼Œå°½å¯èƒ½å¤šçš„å°†è¯¥æ¡†æ¶ä¸‹çš„åŠŸèƒ½åŠ ä»¥ç†Ÿæ‚‰ã€‚* ","date":"2024-01-28","objectID":"/posts/cmake_note_20/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [20] åˆ©ç”¨Google Teståº“è¿›è¡Œå•å…ƒæµ‹è¯•","uri":"/posts/cmake_note_20/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ NOTE: main.cppã€sum_integers.cppå’Œsum_integers.hppä¸ä¸Šä¸€ç¯‡å†…å®¹ç›¸åŒï¼Œæˆ‘ä»¬å¯¹test.cppå°†åšç›¸å…³çš„ä¿®æ”¹ã€‚ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ main.cpp â”œâ”€â”€ sum_integers.cpp â”œâ”€â”€ sum_integers.h â””â”€â”€ test.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter4/03 ","date":"2024-01-28","objectID":"/posts/cmake_note_20/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [20] åˆ©ç”¨Google Teståº“è¿›è¡Œå•å…ƒæµ‹è¯•","uri":"/posts/cmake_note_20/"},{"categories":["C++"],"content":"ä¸‰ã€é¡¹ç›®ä»£ç  CMakeLists.txt cmake_minimum_required(VERSION 3.11 FATAL_ERROR) project(test_gtest LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON) add_library(sum_integers sum_integers.cpp) add_executable(sum_up main.cpp) target_link_libraries(sum_up sum_integers) option(ENABLE_UNIT_TESTS \"Enable unit tests\" ON) message(STATUS \"Enable testing: ${ENABLE_UNIT_TESTS}\") if(ENABLE_UNIT_TESTS) include(FetchContent) FetchContent_Declare( googletest GIT_REPOSITORY https://gitcode.net/mirrors/google/googletest.git GIT_TAG release-1.8.0 ) FetchContent_GetProperties(googletest) if(NOT googletest_POPULATED) FetchContent_Populate(googletest) # Prevent GoogleTest from overriding our compiler/linker options # when building with Visual Studio set(gtest_force_shared_crt ON CACHE BOOL \"\" FORCE) # Prevent GoogleTest from using PThreads set(gtest_disable_pthreads ON CACHE BOOL \"\" FORCE) # adds the targers: gtest, gtest_main, gmock, gmock_main add_subdirectory( ${googletest_SOURCE_DIR} ${googletest_BINARY_DIR} ) # Silence std::tr1 warning on MSVC if(MSVC) foreach(_tgt gtest gtest_main gmock gmock_main) target_compile_definitions(${_tgt} PRIVATE \"_SILENCE_TR1_NAMESPACE_DEPRECATION_WARNING\" ) endforeach() endif() endif() add_executable(cpp_test \"\") target_sources(cpp_test PRIVATE test.cpp ) target_link_libraries(cpp_test PRIVATE sum_integers gtest_main ) enable_testing() add_test( NAME google_test COMMAND $\u003cTARGET_FILE:cpp_test\u003e ) endif() **æ³¨æ„:**CMake 3.11ç‰ˆæœ¬ä»¥åæ‰å¯ä»¥ä½¿ç”¨FetchContentæ¨¡å—ã€‚ å¼•ç”¨ set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON) å‘Šè¯‰CMakeåœ¨ Windows å¹³å°ä¸Šè‡ªåŠ¨ä»å…±äº«åº“ï¼ˆDLLï¼‰ä¸­å¯¼å‡ºæ‰€æœ‰ç¬¦å·ï¼ˆå‡½æ•°ã€å˜é‡ã€ç±»ç­‰ï¼‰ã€‚ å½“å°†æ­¤é€‰é¡¹è®¾ç½®ä¸º ON æ—¶ï¼ŒCMakeä¼šè‡ªåŠ¨åœ¨åº“çš„ä»£ç ä¸­æ’å…¥å¯¼å‡ºæŒ‡ä»¤ï¼Œç¡®ä¿å®ƒä»¬å¯ä»¥è¢«å¤–éƒ¨é“¾æ¥ã€‚è¿™åœ¨ Windows ä¸Šç‰¹åˆ«é‡è¦ï¼Œå› ä¸ºéœ€è¦æ˜ç¡®çš„å¯¼å‡ºå£°æ˜æ‰èƒ½è®©ç¬¦å·ä» DLL å¤–éƒ¨è®¿é—®ã€‚ ç„¶è€Œï¼Œå¯ç”¨æ­¤é€‰é¡¹å¯èƒ½ä¼šå¯¼è‡´ç”Ÿæˆè¾ƒå¤§çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶å¯èƒ½æ„å¤–åœ°æš´éœ²ç¬¦å·ã€‚å¦‚æœé“¾æ¥äº†å¤šä¸ªåº“ï¼Œè¿˜å¯èƒ½å¯¼è‡´ç¬¦å·å†²çªã€‚å› æ­¤ï¼Œè™½ç„¶å®ƒç®€åŒ–äº†ç¬¦å·çš„å¯¼å‡ºï¼Œä½†éœ€è¦ä»”ç»†è€ƒè™‘å…¶å½±å“ï¼Œä»¥åŠæ˜¯å¦é€‚ç”¨äºè‡ªå·±çš„é¡¹ç›®ã€‚ å¼•ç”¨ option(ENABLE_UNIT_TESTS \"Enable unit tests\" ON) message(STATUS \"Enable testing: ${ENABLE_UNIT_TESTS}\") if(ENABLE_UNIT_TESTS) # all the remaining CMake code will be placed here endif() æ£€æŸ¥ENABLE_UNIT_TESTSã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¸ºONï¼Œä½†æœ‰æ—¶éœ€è¦è®¾ç½®ä¸ºOFFï¼Œä»¥å…åœ¨æ²¡æœ‰ç½‘ç»œè¿æ¥æ—¶ï¼Œä¹Ÿèƒ½ä½¿ç”¨Google Testã€‚ å¼•ç”¨ include(FetchContent) FetchContent_Declare( googletest GIT_REPOSITORY https://gitcode.net/mirrors/google/googletest.git GIT_TAG release-1.8.0 ) ä½¿ç”¨äº†FetchContentæ¨¡å—æ¥ä¸‹è½½å’Œé›†æˆGoogle Teståº“ï¼ˆgoogletestï¼‰ã€‚ include(FetchContent)ï¼šç”¨äºåŒ…å«FetchContentæ¨¡å—ï¼Œè¯¥æ¨¡å—å…è®¸åœ¨é¡¹ç›®ä¸­è·å–å¤–éƒ¨ä¾èµ–é¡¹ã€‚ FetchContent_Declare(googletest ...)ï¼šä½¿ç”¨FetchContent_Declareå®æ¥å£°æ˜è¦è·å–çš„å¤–éƒ¨ä¾èµ–é¡¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå£°æ˜äº†ä¸€ä¸ªåä¸ºgoogletestçš„å¤–éƒ¨ä¾èµ–é¡¹ã€‚ GIT_REPOSITORYï¼šè¿™æ˜¯æŒ‡å®šç”¨äºè·å–åº“çš„Gitå­˜å‚¨åº“çš„URLã€‚ GIT_TAGï¼šè¿™æ˜¯Gitå­˜å‚¨åº“ä¸­çš„ç‰¹å®šæ ‡ç­¾æˆ–åˆ†æ”¯ï¼ŒæŒ‡å®šå¸Œæœ›è·å–çš„åº“çš„ç‰ˆæœ¬ã€‚åœ¨è¿™é‡Œï¼Œå®ƒæŒ‡å®šäº†Google Teståº“çš„ç‰ˆæœ¬ä¸ºrelease-1.8.0ã€‚ ä½¿ç”¨è¿™æ®µä»£ç åï¼Œå½“æ„å»ºé¡¹ç›®æ—¶ï¼ŒCMakeå°†å°è¯•ä¸‹è½½å¹¶é›†æˆGoogle Teståº“ï¼Œä»¥ä¾¿å¯ä»¥åœ¨é¡¹ç›®ä¸­è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚è¯·æ³¨æ„ï¼Œå®é™…é¡¹ç›®ä¸­å¯èƒ½è¿˜éœ€è¦åœ¨æµ‹è¯•ç›®æ ‡ä¸­é“¾æ¥Google Teståº“ï¼Œå¹¶è®¾ç½®æµ‹è¯•ç”¨ä¾‹ç­‰ã€‚ å¼•ç”¨ if(NOT googletest_POPULATED) FetchContent_Populate(googletest) # Prevent GoogleTest from overriding our compiler/linker options # when building with Visual Studio set(gtest_force_shared_crt ON CACHE BOOL \"\" FORCE) # Prevent GoogleTest from using PThreads set(gtest_disable_pthreads ON CACHE BOOL \"\" FORCE) # adds the targers: gtest, gtest_main, gmock, gmock_main add_subdirectory( ${googletest_SOURCE_DIR} ${googletest_BINARY_DIR} ) # Silence std::tr1 warning on MSVC if(MSVC) foreach(_tgt gtest gtest_main gmock gmock_main) target_compile_definitions(${_tgt} PRIVATE \"_SILENCE_TR1_NAMESPACE_DEPRECATION_WARNING\" ) endforeach() endif() endif() if(NOT googletest_POPULATED)ï¼šæ£€æŸ¥æ˜¯å¦å·²ç»è·å–å¹¶é›†æˆäº†Google Teståº“ã€‚å¦‚æœgoogletest_POPULATEDæœªå®šä¹‰ï¼Œåˆ™ä¼šæ‰§è¡Œå…¶ä¸­çš„ä»£ç å—ã€‚ FetchContent_Populate(googletest)ï¼šå°†ä¸‹è½½çš„Google Teståº“å†…å®¹å¡«å……åˆ°æŒ‡å®šçš„ç›®å½•ï¼Œä»¥ä¾¿åç»­æ„å»ºå’Œé›†æˆã€‚ set(gtest_force_shared_crt ON CACHE BOOL \"\" FORCE)ï¼šåœ¨ä½¿ç”¨Visual Studioæ„å»ºæ—¶ï¼Œå°†å¼ºåˆ¶Google Testä½¿ç”¨å…±äº«è¿è¡Œæ—¶ï¼ˆC Runtimeï¼‰åº“ã€‚å¯ä»¥é¿å…æ„å»ºæ—¶çš„é“¾æ¥é”™è¯¯ã€‚ set(gtest_disable_pthreads ON CACHE BOOL \"\" FORCE)ï¼šç¦ç”¨Google Testå¯¹pthreadsçš„ä½¿ç”¨ã€‚è¿™å¯èƒ½åœ¨æŸäº›ç¯å¢ƒä¸­æ˜¯å¿…éœ€çš„ï¼Œä¾‹å¦‚åœ¨æ²¡æœ‰pthreadsæ”¯æŒçš„å¹³å°ä¸Šã€‚ add_subdirectory(...)ï¼šå°†Google Teståº“æ·»åŠ åˆ°é¡¹ç›®ä¸­ã€‚å®ƒä¼šåœ¨æŒ‡å®šçš„æºç ç›®å½•å’ŒäºŒè¿›åˆ¶ç›®å½•ä¸­è¿›è¡Œæ„å»ºã€‚ å¯¹äºMicrosoft Visual Studioï¼ˆMSVCï¼‰ï¼Œåœ¨æ„å»ºGoogle Teståº“æ—¶ï¼Œé€šè¿‡target_compile_definitionsä¸ºgtestã€gtest_mainã€gmockå’Œgmock_mainç›®æ ‡æ·»åŠ äº†å®å®šä¹‰ä»¥æ¶ˆé™¤MSVCä¸‹çš„è­¦å‘Šã€‚ ç›¸å…³æºç  test.cpp #include \"sum_integers.h\" #include \"gtest/gtest.h\" #includ","date":"2024-01-28","objectID":"/posts/cmake_note_20/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [20] åˆ©ç”¨Google Teståº“è¿›è¡Œå•å…ƒæµ‹è¯•","uri":"/posts/cmake_note_20/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ *ä¸Šä¸€ç¯‡ï¼Œæˆ‘ä»¬é€šè¿‡è¿”å›ç æ¥è¡¨ç¤º**test.cpp*æµ‹è¯•çš„æˆåŠŸæˆ–è€…å¤±è´¥ã€‚å¯¹äºç®€å•çš„åŠŸèƒ½æ²¡é—®é¢˜ï¼Œä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦ä½¿ç”¨ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼Œå®ƒæä¾›äº†ç›¸å…³åŸºç¡€è®¾æ–½æ¥è¿è¡Œæ›´å¤æ‚çš„æµ‹è¯•ï¼ŒåŒ…æ‹¬å›ºå®šæ–¹å¼è¿›è¡Œæµ‹è¯•ï¼Œä¸æ•°å€¼å…¬å·®è¿›è¡Œæ¯”è¾ƒï¼Œä»¥åŠåœ¨æµ‹è¯•å¤±è´¥æ—¶è¾“å‡ºæ›´å¥½çš„é”™è¯¯æŠ¥å‘Šã€‚æœ¬ç¯‡ï¼Œé€šè¿‡ä½¿ç”¨ç›®å‰æ¯”è¾ƒæµè¡Œçš„æµ‹è¯•åº“Catch2æ¥è¿›è¡Œæ¢ç´¢ç›¸å…³å†…å®¹ã€‚è¿™ä¸ªæµ‹è¯•æ¡†æ¶æœ‰ä¸ªå¾ˆå¥½çš„ç‰¹æ€§ï¼Œå®ƒå¯ä»¥é€šè¿‡å•ä¸ªå¤´æ–‡ä»¶åŒ…å«åœ¨é¡¹ç›®ä¸­è¿›è¡Œæµ‹è¯•ï¼Œè¿™ä½¿å¾—ç¼–è¯‘å’Œæ›´æ–°æ¡†æ¶ç‰¹åˆ«å®¹æ˜“ã€‚é€šè¿‡CMakeå’ŒCatch2ç»“åˆä½¿ç”¨ï¼Œæ¥æµ‹è¯•ä¸Šä¸€ç¯‡çš„æ±‚å’Œä»£ç ã€‚ ","date":"2024-01-28","objectID":"/posts/cmake_note_19/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [19] åˆ©ç”¨Catch2åº“è¿›è¡Œå•å…ƒæµ‹è¯•","uri":"/posts/cmake_note_19/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ NOTE æœ¬é¡¹ç›®ä¸­Catchä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯2.0.1ï¼Œç›®å‰å·²ç»æ›´æ–°åˆ°3.4.0ã€‚å…³äºæœ€æ–°ç‰ˆæœ¬çš„ä½¿ç”¨æˆ‘ä»¬å°†åœ¨æœ¬ç³»åˆ—æœ€åå¼€å¯ä¸€ä¸ªå…·ä½“çš„å°å‹é¡¹ç›®æ¢ç´¢æµ‹è¯•æ¡†æ¶ã€‚ . â”œâ”€â”€ catch.hpp â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ main.cpp â”œâ”€â”€ sum_integers.cpp â”œâ”€â”€ sum_integers.h â””â”€â”€ test.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter4/02 CMakeLists.txt # set minimum cmake version cmake_minimum_required(VERSION 3.10 FATAL_ERROR) # project name and language project(test_catch2 LANGUAGES CXX) # require C++11 set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) # example library add_library(sum_integers sum_integers.cpp) # main code add_executable(sum_up main.cpp) target_link_libraries(sum_up sum_integers) # testing binary add_executable(cpp_test test.cpp) target_link_libraries(cpp_test sum_integers) enable_testing() add_test( NAME catch_test COMMAND $\u003cTARGET_FILE:cpp_test\u003e --success ) å¼•ç”¨ add_test( NAME catch_test COMMAND $\u003cTARGET_FILE:cpp_test\u003e --success ) --successé€‰é¡¹å¯ä¼ é€’ç»™å•å…ƒæµ‹è¯•çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™æ˜¯ä¸€ä¸ªCatch2é€‰é¡¹ï¼Œæµ‹è¯•æˆåŠŸæ—¶ï¼Œä¹Ÿä¼šæœ‰è¾“å‡ºã€‚ ç›¸å…³æºç  main.cppã€sum_integers.cppå’Œsum_integers.hä¸ä¹‹å‰çš„ç¤ºä¾‹ç›¸åŒã€‚ test.cpp #include \u003cvector\u003e #include \"sum_integers.h\" // this tells catch to provide a main() // only do this in one cpp file #define CATCH_CONFIG_MAIN #include \"catch.hpp\" TEST_CASE(\"Sum of integers for a short vector\", \"[shirt]\") { auto integers = {1, 2, 3, 4, 5}; REQUIRE(sum_integers(integers) == 15); } TEST_CASE(\"Sum of integers for a longer vector\", \"[long]\") { std::vector\u003cint\u003e integers; for (int i = 1; i \u003c 1001; ++i) { integers.push_back(i); } REQUIRE(sum_integers(integers) == 500500); } è¾“å‡ºç»“æœ: mkdir -p build cd build cmake .. cmake --build . ctest -V UpdateCTestConfiguration from :/home/jiangli/repo/tutorials/cmake-tutorial/chapter4/02/build/DartConfiguration.tcl UpdateCTestConfiguration from :/home/jiangli/repo/tutorials/cmake-tutorial/chapter4/02/build/DartConfiguration.tcl Test project /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/02/build Constructing a list of tests Done constructing a list of tests Updating test list for fixtures Added 0 tests to meet fixture requirements Checking test dependency graph... Checking test dependency graph end test 1 Start 1: catch_test 1: Test command: /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/02/build/cpp_test \"--success\" 1: Test timeout computed to be: 10000000 1: 1: ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 1: cpp_test is a Catch v2.0.1 host application. 1: Run with -? for options 1: 1: ------------------------------------------------------------------------------- 1: Sum of integers for a short vector 1: ------------------------------------------------------------------------------- 1: /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/02/test.cpp:13 1: ............................................................................... 1: 1: /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/02/test.cpp:15: 1: PASSED: 1: REQUIRE( sum_integers(integers) == 15 ) 1: with expansion: 1: 15 == 15 1: 1: ------------------------------------------------------------------------------- 1: Sum of integers for a longer vector 1: ------------------------------------------------------------------------------- 1: /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/02/test.cpp:18 1: ............................................................................... 1: 1: /home/jiangli/repo/tutorials/cmake-tutorial/chapter4/02/test.cpp:23: 1: PASSED: 1: REQUIRE( sum_integers(integers) == 500500 ) 1: with expansion: 1: 500500 (0x7a314) == 500500 (0x7a314) 1: 1: =============================================================================== 1: All tests passed (2 assertions in 2 test cases) 1: 1/1 Test #1: catch_test ....................... Passed 0.00 sec 100% tests passed, 0 tests failed out of 1 Total Test time (real) = 0.00 sec æµ‹è¯•cpp_testçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ä»Catch2ä¸­çœ‹åˆ°è¾“å‡ºï¼š ./cpp_test --success ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ cpp_test is a Catch v2.0.1 host application. Run with -? for op","date":"2024-01-28","objectID":"/posts/cmake_note_19/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [19] åˆ©ç”¨Catch2åº“è¿›è¡Œå•å…ƒæµ‹è¯•","uri":"/posts/cmake_note_19/"},{"categories":["C++"],"content":"ä¸‰ã€é™„å½• Catch2æ˜¯ä¸€ä¸ªå•å¤´æ–‡ä»¶æµ‹è¯•æ¡†æ¶ï¼Œæ‰€ä»¥ä¸éœ€è¦å®šä¹‰å’Œæ„å»ºé¢å¤–çš„ç›®æ ‡ã€‚åªéœ€è¦ç¡®ä¿CMakeèƒ½æ‰¾åˆ°catch.hppï¼Œä»è€Œæ„å»ºtest.cppå³å¯ã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œå°†å®ƒæ”¾åœ¨ä¸test.cppç›¸åŒçš„ç›®å½•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªä¸åŒçš„ä½ç½®ï¼Œå¹¶ä½¿ç”¨target_include_directoryæŒ‡ç¤ºè¯¥ä½ç½®ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯å°†å¤´éƒ¨å°è£…åˆ°æ¥å£åº“ä¸­ï¼š # Prepare \"Catch\" library for other executables set(CATCH_INCLUDE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/catch) add_library(Catch INTERFACE) target_include_directories(Catch INTERFACE ${CATCH_INCLUDE_DIR}) ç„¶åï¼Œå¯¹åº“è¿›è¡Œå¦‚ä¸‹é“¾æ¥: target_link_libraries(cpp_test Catch) Catch2æä¾›äº†æ›´å¤šåŠŸèƒ½ã€‚æœ‰å…³Catch2æ¡†æ¶çš„å®Œæ•´æ–‡æ¡£ï¼Œå¯è®¿é—®ï¼š https://github.com/catchorg/Catch2 Catch2ä»£ç åº“åŒ…å«æœ‰CMakeå‡½æ•°ï¼Œç”¨äºè§£æCatchæµ‹è¯•å¹¶è‡ªåŠ¨åˆ›å»ºCMakeæµ‹è¯•ï¼Œä¸éœ€è¦æ˜¾å¼åœ°è¾“å…¥add_test()å‡½æ•°ï¼Œå¯è§ï¼š https://github.com/catchorg/Catch2/blob/master/contrib/ParseAndAddCatchTests.cmake ","date":"2024-01-28","objectID":"/posts/cmake_note_19/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [19] åˆ©ç”¨Catch2åº“è¿›è¡Œå•å…ƒæµ‹è¯•","uri":"/posts/cmake_note_19/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ CTestæ˜¯CMakeçš„æµ‹è¯•å·¥å…·ï¼Œæœ¬ç¯‡é€šè¿‡ç¼–å†™å’Œæµ‹è¯•èƒ½å¤Ÿå¯¹æ•´æ•°æ±‚å’Œçš„ä»£ç ï¼Œä»¥çª¥æ¢CTestå…¶ä¸­çš„åŠŸèƒ½ä¸€äºŒã€‚ä¸ºäº†è¯´æ˜CMakeæ²¡æœ‰å¯¹å®é™…æµ‹è¯•çš„è¯­è¨€è¿›è¡Œä»»ä½•é™åˆ¶ï¼Œæˆ‘ä»¬ä¸ä»…ä½¿ç”¨C++å¯æ‰§è¡Œæ–‡ä»¶æµ‹è¯•ä»£ç ï¼Œè¿˜ä½¿ç”¨Pythonè„šæœ¬å’Œshellè„šæœ¬ä½œä¸ºæµ‹è¯•ä»£ç ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†ä¸ä½¿ç”¨ä»»ä½•æµ‹è¯•åº“æ¥å®ç°ï¼Œä½†æ˜¯æˆ‘ä»¬å°†åœ¨åé¢çš„ç¬”è®°ä¸­ç†Ÿæ‚‰C++æµ‹è¯•æ¡†æ¶ã€‚ ","date":"2024-01-28","objectID":"/posts/cmake_note_18/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [18] åˆ©ç”¨CTestè¿›è¡Œå•å…ƒæµ‹è¯•","uri":"/posts/cmake_note_18/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ main.cpp â”œâ”€â”€ sum_integers.cpp â”œâ”€â”€ sum_integers.h â”œâ”€â”€ test.cpp â”œâ”€â”€ test.py â””â”€â”€ test.sh é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter4/01 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(test_ctest LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) find_package(PythonInterp REQUIRED) find_program(BASH_EXECUTABLE NAMES bash REQUIRED) # example library add_library(sum_integers sum_integers.cpp) # main code add_executable(sum_up main.cpp) target_link_libraries(sum_up sum_integers) # testing binary add_executable(cpp_test test.cpp) target_link_libraries(cpp_test sum_integers) enable_testing() add_test( NAME bash_test COMMAND ${BASH_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test.sh $\u003cTARGET_FILE:sum_up\u003e ) add_test( NAME cpp_test COMMAND $\u003cTARGET_FILE:cpp_test\u003e ) add_test( NAME python_test_long COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test.py --executable $\u003cTARGET_FILE:sum_up\u003e ) add_test( NAME python_test_short COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test.py --short --executable $\u003cTARGET_FILE:sum_up\u003e ) å¼•ç”¨ find_program(BASH_EXECUTABLE NAMES bash REQUIRED) ç”¨äºæŸ¥æ‰¾ç³»ç»Ÿä¸­çš„bashå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶å°†å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„å­˜å‚¨åœ¨å˜é‡BASH_EXECUTABLEä¸­ã€‚è¿™å¯ä»¥ç”¨äºåœ¨CMakeæ„å»ºè¿‡ç¨‹ä¸­æ‰§è¡Œbashè„šæœ¬æˆ–å‘½ä»¤ã€‚ å¼•ç”¨ enable_testing() æµ‹è¯•è¿™ä¸ªç›®å½•å’Œæ‰€æœ‰å­æ–‡ä»¶å¤¹(å› ä¸ºæˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨ä¸»CMakeLists.txt)ã€‚ Tips add_test( NAME cpp_test COMMAND $\u003cTARGET_FILE:cpp_test\u003e ) å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æµ‹è¯•ï¼Œå¹¶è®¾ç½®æµ‹è¯•åç§°å’Œè¿è¡Œå‘½ä»¤ã€‚ ä¸Šè¿°ä»£ç ä¸­ï¼Œä½¿ç”¨äº†ç”Ÿæˆå™¨è¡¨è¾¾å¼:$\u003cTARGET_FILE:cpp_test\u003eã€‚ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼Œæ˜¯åœ¨ç”Ÿæˆæ„å»ºç³»ç»Ÿç”Ÿæˆæ—¶çš„è¡¨è¾¾å¼ã€‚æˆ‘ä»¬å°†åœ¨åç»­çš„å­¦ä¹ å†…å®¹ä¸­ä»‹ç»å’Œå­¦ä¹ ç”Ÿæˆå™¨è¡¨è¾¾å¼ã€‚ç„¶åï¼Œå¯ä»¥å£°æ˜$\u003cTARGET_FILE:cpp_test\u003eå˜é‡ï¼Œå°†ä½¿ç”¨cpp_testå¯æ‰§è¡Œç›®æ ‡çš„å®Œæ•´è·¯å¾„è¿›è¡Œæ›¿æ¢ã€‚ NOTE: ç”Ÿæˆå™¨è¡¨è¾¾å¼åœ¨æµ‹è¯•æ—¶éå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºä¸å¿…æ˜¾å¼åœ°å°†å¯æ‰§è¡Œç¨‹åºçš„ä½ç½®å’Œåç§°ï¼Œå¯ä»¥ç¡¬ç¼–ç åˆ°æµ‹è¯•ä¸­ã€‚ä»¥ä¸€ç§å¯ç§»æ¤çš„æ–¹å¼å®ç°è¿™ä¸€ç‚¹éå¸¸éº»çƒ¦ï¼Œå› ä¸ºå¯æ‰§è¡Œæ–‡ä»¶å’Œå¯æ‰§è¡Œåç¼€(ä¾‹å¦‚ï¼ŒWindowsä¸Šæ˜¯.exeåç¼€)çš„ä½ç½®åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿã€æ„å»ºç±»å‹å’Œç”Ÿæˆå™¨ä¹‹é—´å¯èƒ½æœ‰æ‰€ä¸åŒã€‚ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬ä¸å¿…æ˜¾å¼åœ°äº†è§£ä½ç½®å’Œåç§°ã€‚ ä¹Ÿå¯ä»¥å°†å‚æ•°ä¼ é€’ç»™è¦è¿è¡Œçš„testå‘½ä»¤ï¼š add_test( NAME python_test_short COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test.py --short --executable $\u003cTARGET_FILE:sum_up\u003e ) NOTE CTestå¯ä»¥ä»¥ä»»ä½•ç¼–ç¨‹è¯­è¨€è¿è¡Œæµ‹è¯•é›†ã€‚CTestå…³å¿ƒçš„æ˜¯ï¼Œé€šè¿‡å‘½ä»¤çš„è¿”å›ç æµ‹è¯•ç”¨ä¾‹æ˜¯å¦é€šè¿‡ã€‚CTestéµå¾ªçš„æ ‡å‡†çº¦å®šæ˜¯ï¼šè¿”å›é›¶æ„å‘³ç€æˆåŠŸï¼Œéé›¶è¿”å›æ„å‘³ç€å¤±è´¥ã€‚å¯ä»¥è¿”å›é›¶æˆ–éé›¶çš„è„šæœ¬ï¼Œéƒ½å¯ä»¥åšæµ‹è¯•ç”¨ä¾‹ã€‚ ç›¸å…³æºç  sum_integers.h #ifndef SUM_INTEGERS_H #define SUM_INTEGERS_H #include \u003cvector\u003e int sum_integers(const std::vector\u003cint\u003e \u0026integers); #endif // ! SUM_INTEGERS_H sum_integers.cpp #include \"sum_integers.h\" int sum_integers(const std::vector\u003cint\u003e\u0026 integers) { auto sum = 0; for (auto i : integers) { sum += i; } return sum; } main.cpp #include \u003ciostream\u003e #include \u003cstring\u003e #include \"sum_integers.h\" int main(int argc, char *argv[]) { std::vector\u003cint\u003e integers; for (auto i = 1; i \u003c argc; i++) { integers.push_back(std::stoi(argv[i])); } auto sum = sum_integers(integers); std::cout \u003c\u003c sum \u003c\u003c std::endl; return 0; } test.cpp #include \"sum_integers.h\" int main() { auto integers = {1, 2, 3, 4, 5}; if (sum_integers(integers) == 15) { return 0; } else { return 1; } } test.py import subprocess import argparse # test script expects the executable as argument parser = argparse.ArgumentParser() parser.add_argument('--executable', help='full path to executable') parser.add_argument('--short', default=False, action='store_true', help='run a shorter test') args = parser.parse_args() def execute_cpp_code(integers): result = subprocess.check_output([args.executable] + integers) return int(result) if args.short: # we collect [1, 2, ..., 100] as a list of strings result = execute_cpp_code([str(i) for i in range(1, 101)]) assert result == 5050, 'summing up to 100 failed' else: # we collect [1, 2, ..., 1000] as a list of strings result = execute_cpp_code([str(i) for i in range(1, 1001)]) assert result == 500500, 'summing up to 1000 failed' test.sh #!/usr/bin/env bash EXECUTABLE=$1 OUTPUT=$($EXECUTABLE 1 2 3 4) if [ \"$OUTPUT\" = \"10\" ] then exit 0 else exit 1 fi ","date":"2024-01-28","objectID":"/posts/cmake_note_18/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [18] åˆ©ç”¨CTestè¿›è¡Œå•å…ƒæµ‹è¯•","uri":"/posts/cmake_note_18/"},{"categories":["C++"],"content":"ä¸‰ã€é™„å½• 1. è€ƒè™‘ä»¥ä¸‹å®šä¹‰: add_test( NAME python_test_long COMMAND ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/test.py --executable $\u003cTARGET_FILE:sum_up\u003e ) å‰é¢çš„å®šä¹‰å¯ä»¥é€šè¿‡æ˜¾å¼æŒ‡å®šè„šæœ¬è¿è¡Œçš„WORKING_DIRECTORYé‡æ–°è¡¨è¾¾ï¼Œå¦‚ä¸‹: add_test( NAME python_test_long COMMAND ${PYTHON_EXECUTABLE} test.py --executable $\u003cTARGET_FILE:sum_up\u003e WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} ) æµ‹è¯•åç§°å¯ä»¥åŒ…å«/å­—ç¬¦ï¼ŒæŒ‰åç§°ç»„ç»‡ç›¸å…³æµ‹è¯•ä¹Ÿå¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼š add_test( NAME python/long COMMAND ${PYTHON_EXECUTABLE} test.py --executable $\u003cTARGET_FILE:sum_up\u003e WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} ) æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæµ‹è¯•è„šæœ¬è®¾ç½®ç¯å¢ƒå˜é‡ã€‚è¿™å¯ä»¥é€šè¿‡set_tests_propertieså®ç°: set_tests_properties(python_test PROPERTIES ENVIRONMENT ACCOUNT_MODULE_PATH=${CMAKE_CURRENT_SOURCE_DIR} ACCOUNT_HEADER_FILE=${CMAKE_CURRENT_SOURCE_DIR}/account/account.h ACCOUNT_LIBRARY_FILE=$\u003cTARGET_FILE:account\u003e ) è¿™ç§æ–¹æ³•åœ¨ä¸åŒçš„å¹³å°ä¸Šå¹¶ä¸æ€»å¯è¡Œï¼ŒCMakeæä¾›äº†è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸ä¸Šé¢ç»™å‡ºçš„ä»£ç ç‰‡æ®µç›¸åŒï¼Œåœ¨æ‰§è¡Œå®é™…çš„Pythonæµ‹è¯•è„šæœ¬ä¹‹å‰ï¼Œé€šè¿‡CMAKE_COMMANDè°ƒç”¨CMakeæ¥é¢„å…ˆè®¾ç½®ç¯å¢ƒå˜é‡ï¼š add_test( NAME python_test COMMAND ${CMAKE_COMMAND} -E env ACCOUNT_MODULE_PATH=${CMAKE_CURRENT_SOURCE_DIR} ACCOUNT_HEADER_FILE=${CMAKE_CURRENT_SOURCE_DIR}/account/account.h ACCOUNT_LIBRARY_FILE=$\u003cTARGET_FILE:account\u003e ${PYTHON_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/account/test.py ) åŒæ ·ï¼Œè¦æ³¨æ„ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼$\u003cTARGET_FILE:account\u003eæ¥ä¼ é€’åº“æ–‡ä»¶çš„ä½ç½®ã€‚ 2. ä¸åŒå¹³å°æµ‹è¯•å‘½ä»¤ æˆ‘ä»¬å·²ç»ä½¿ç”¨ctestå‘½ä»¤æ‰§è¡Œæµ‹è¯•ï¼ŒCMakeè¿˜å°†ä¸ºç”Ÿæˆå™¨åˆ›å»ºç›®æ ‡(Unix Makefileç”Ÿæˆå™¨ä¸ºmake testï¼ŒNinjaå·¥å…·ä¸ºninja testï¼Œæˆ–è€…Visual Studioä¸ºRUN_TESTS)ã€‚è¿™æ„å‘³ç€ï¼Œè¿˜æœ‰å¦ä¸€ç§(å‡ ä¹)å¯ç§»æ¤çš„æ–¹æ³•æ¥è¿è¡Œæµ‹è¯•ï¼š $ cmake --build . --target test å½“ä½¿ç”¨Visual Studioç”Ÿæˆå™¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨RUN_TESTSæ¥ä»£æ›¿: $ cmake --build . --target RUN_TESTS ","date":"2024-01-28","objectID":"/posts/cmake_note_18/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [18] åˆ©ç”¨CTestè¿›è¡Œå•å…ƒæµ‹è¯•","uri":"/posts/cmake_note_18/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¼è¨€ ç›®å‰ä¸Šä¸€ç¯‡ï¼Œæˆ‘ä»¬äº†è§£äº†CMakeå…¶ä¸­ä¸€ç§è‡ªå®šä¹‰æ£€æµ‹å¤–éƒ¨åº“çš„æ–¹å¼ï¼Œæœ¬ç¯‡å°†å±•ç¤ºé€šè¿‡ç¼–å†™ä¸€ä¸ªfindæ¨¡å—æ¥å®šä½ç³»ç»Ÿä¸Šçš„ZeroMQåº“ï¼Œä»¥èƒ½å¤Ÿåœ¨éæ“ä½œç³»ç»Ÿä¸Šæ£€æµ‹è¯¥åº“ã€‚ ","date":"2024-01-28","objectID":"/posts/cmake_note_17/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [17] æ£€æµ‹å¤–éƒ¨åº“ -- è‡ªå®šä¹‰findæ¨¡å—","uri":"/posts/cmake_note_17/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ FindZeroMQ.cmake â”œâ”€â”€ zmq_client.cpp â””â”€â”€ zmq_server.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter3/06 æ³¨ï¼šç›¸å…³cppæºç ä¸ä¸Šä¸€ç¯‡ç›¸åŒã€‚ CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(test_zmq LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) set(CMAKE_PREFIX_PATH /opt/zmq) list(APPEND CMAKE_MODULE_PATH ${CMAKE_CURRENT_SOURCE_DIR}) find_package(ZeroMQ REQUIRED) add_executable(hw_server zmq_server.cpp) target_include_directories(hw_server PRIVATE ${ZeroMQ_INCLUDE_DIRS} ) target_link_libraries(hw_server PRIVATE ${ZeroMQ_LIBRARIES} ) add_executable(hw_client zmq_client.cpp) target_include_directories(hw_client PRIVATE ${ZeroMQ_INCLUDE_DIRS} ) target_link_libraries(hw_client PRIVATE ${ZeroMQ_LIBRARIES} ) å¼•ç”¨ list(APPEND CMAKE_MODULE_PATH ${CMAKE_CURRENT_SOURCE_DIR}) è¿™è¡Œä»£ç æ˜¯ç”¨äºåœ¨CMakeä¸­å‘CMAKE_MODULE_PATHå˜é‡ä¸­æ·»åŠ ä¸€ä¸ªç›®å½•çš„è·¯å¾„ã€‚é€šå¸¸ï¼ŒCMAKE_MODULE_PATHç”¨äºå­˜æ”¾è‡ªå®šä¹‰çš„CMakeæ¨¡å—æ–‡ä»¶ï¼Œè¿™äº›æ¨¡å—æ–‡ä»¶å¯ä»¥åœ¨é¡¹ç›®çš„CMakeLists.txtæ–‡ä»¶ä¸­é€šè¿‡includeç­‰å‘½ä»¤æ¥ä½¿ç”¨ã€‚ å…·ä½“è€Œè¨€ï¼Œè¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å°†${CMAKE_CURRENT_SOURCE_DIR}æ·»åŠ åˆ°CMAKE_MODULE_PATHä¸­ã€‚${CMAKE_CURRENT_SOURCE_DIR}è¡¨ç¤ºå½“å‰CMakeLists.txtæ‰€åœ¨çš„ç›®å½•ï¼Œå³æºä»£ç ç›®å½•ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†å‘Šè¯‰CMakeåœ¨è¿™ä¸ªç›®å½•ä¸­æŸ¥æ‰¾è‡ªå®šä¹‰çš„CMakeæ¨¡å—ã€‚ è¿™æ ·CMakeå°±å¯ä»¥æ‰¾åˆ°ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„FindZeroMQ.cmakeæ¨¡å—ã€‚ æ­¤ç¤ºä¾‹çš„ä¸»CMakeLists.txtåœ¨ä½¿ç”¨FindZeroMQ.cmakeæ—¶ï¼Œä¸ä¸Šä¸€ç¯‡ä¸­ä½¿ç”¨çš„CMakeLists.txtä¸åŒã€‚è¿™ä¸ªæ¨¡å—ä½¿ç”¨find_pathå’Œfind_library CMakeå†…ç½®å‘½ä»¤ï¼Œæœç´¢ZeroMQå¤´æ–‡ä»¶å’Œåº“ï¼Œå¹¶ä½¿ç”¨find_package_handle_standard_argsè®¾ç½®ç›¸å…³å˜é‡ã€‚ FindZeroMQ.cmake if(NOT ZeroMQ_ROOT) set(ZeroMQ_ROOT \"$ENV{ZeroMQ_ROOT}\") endif() if(NOT ZeroMQ_ROOT) find_path(_ZeroMQ_ROOT NAMES include/zmq.h) else() set(_ZeroMQ_ROOT \"${ZeroMQ_ROOT}\") endif() find_path(ZeroMQ_INCLUDE_DIRS NAMES zmq.h HINTS ${_ZeroMQ_ROOT}/include) if(ZeroMQ_INCLUDE_DIRS) set(_ZeroMQ_H ${ZeroMQ_INCLUDE_DIRS}/zmq.h) function(_zmqver_EXTRACT _ZeroMQ_VER_COMPONENT _ZeroMQ_VER_OUTPUT) set(CMAKE_MATCH_1 \"0\") set(_ZeroMQ_expr \"^[ \\\\t]*#define[ \\\\t]+${_ZeroMQ_VER_COMPONENT}[ \\\\t]+([0-9]+)$\") file(STRINGS \"${_ZeroMQ_H}\" _ZeroMQ_ver REGEX \"${_ZeroMQ_expr}\") string(REGEX MATCH \"${_ZeroMQ_expr}\" ZeroMQ_ver \"${_ZeroMQ_ver}\") set(${_ZeroMQ_VER_OUTPUT} \"${CMAKE_MATCH_1}\" PARENT_SCOPE) endfunction() _zmqver_EXTRACT(\"ZMQ_VERSION_MAJOR\" ZeroMQ_VERSION_MAJOR) _zmqver_EXTRACT(\"ZMQ_VERSION_MINOR\" ZeroMQ_VERSION_MINOR) _zmqver_EXTRACT(\"ZMQ_VERSION_PATCH\" ZeroMQ_VERSION_PATCH) // We should provide version to find_package_handle_standard_args in the same format as it was requested, // otherwise it can't check whether version matches exactly. if(ZeroMQ_FIND_VERSION_COUNT GREATER 2) set(ZeroMQ_VERSION \"${ZeroMQ_VERSION_MAJOR}.${ZeroMQ_VERSION_MINOR}.${ZeroMQ_VERSION_PATCH}\") else() // User has requested ZeroMQ version without patch part =\u003e user is not interested in specific patch =\u003e // any patch should be an exact match. set(ZeroMQ_VERSION \"${ZeroMQ_VERSION_MAJOR}.${ZeroMQ_VERSION_MINOR}\") endif() if(NOT ${CMAKE_C_PLATFORM_ID} STREQUAL \"Windows\") find_library(ZeroMQ_LIBRARIES NAMES zmq HINTS ${_ZeroMQ_ROOT}/lib ${_ZeroMQ_ROOT}/lib/x86_64-linux-gnu ) else() find_library(ZeroMQ_LIBRARIES NAMES libzmq \"libzmq-mt-${ZeroMQ_VERSION_MAJOR}_${ZeroMQ_VERSION_MINOR}_${ZeroMQ_VERSION_PATCH}\" \"libzmq-${CMAKE_VS_PLATFORM_TOOLSET}-mt-${ZeroMQ_VERSION_MAJOR}_${ZeroMQ_VERSION_MINOR}_${ZeroMQ_VERSION_PATCH}\" libzmq_d \"libzmq-mt-gd-${ZeroMQ_VERSION_MAJOR}_${ZeroMQ_VERSION_MINOR}_${ZeroMQ_VERSION_PATCH}\" \"libzmq-${CMAKE_VS_PLATFORM_TOOLSET}-mt-gd-${ZeroMQ_VERSION_MAJOR}_${ZeroMQ_VERSION_MINOR}_${ZeroMQ_VERSION_PATCH}\" HINTS ${_ZeroMQ_ROOT}/lib ) endif() endif() include(FindPackageHandleStandardArgs) find_package_handle_standard_args(ZeroMQ FOUND_VAR ZeroMQ_FOUND REQUIRED_VARS ZeroMQ_INCLUDE_DIRS ZeroMQ_LIBRARIES VERSION_VAR ZeroMQ_VERSION ) å¼•ç”¨ if(NOT ZeroMQ_ROOT) set(ZeroMQ_ROOT \"$ENV{ZeroMQ_ROOT}\") endif() å¦‚æœZeroMQ_ROOTå˜é‡æ²¡æœ‰è¢«è®¾ç½®ï¼Œå°±å°è¯•ä»ç¯å¢ƒå˜é‡ä¸­è·å–è¯¥è·¯å¾„å¹¶è®¾ç½®åˆ°ZeroMQ_ROOTå˜é‡ä¸­ã€‚è¿™æ ·çš„è®¾è®¡å¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸ä¿®æ”¹CMakeLists.txtæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡æ¥æŒ‡å®šZeroMQåº“çš„è·¯å¾„ã€‚ å¼•ç”¨ if(NOT ZeroMQ_ROOT) find_path(_ZeroMQ_ROOT NAMES include/zmq.h) else() set(_ZeroMQ_ROOT \"${ZeroMQ_ROOT}\") endif() find_path(ZeroMQ_INCLUDE_DIRS NAMES zmq.h HINTS ${_Ze","date":"2024-01-28","objectID":"/posts/cmake_note_17/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [17] æ£€æµ‹å¤–éƒ¨åº“ -- è‡ªå®šä¹‰findæ¨¡å—","uri":"/posts/cmake_note_17/"},{"categories":["C++"],"content":"ä¸‰ã€é™„å½• find-moduleé€šå¸¸éµå¾ªç‰¹å®šçš„æ¨¡å¼: æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ä¸ºæ‰€éœ€çš„åŒ…æä¾›äº†è‡ªå®šä¹‰ä½ç½®ã€‚ ä½¿ç”¨find_å®¶æ—ä¸­çš„å‘½ä»¤æœç´¢æ‰€éœ€åŒ…çš„å¿…éœ€ç»„ä»¶ï¼Œå³å¤´æ–‡ä»¶ã€åº“ã€å¯æ‰§è¡Œç¨‹åºç­‰ç­‰ã€‚æˆ‘ä»¬ä½¿ç”¨find_pathæŸ¥æ‰¾å¤´æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œå¹¶ä½¿ç”¨find_libraryæŸ¥æ‰¾åº“ã€‚CMakeè¿˜æä¾›find_fileã€find_programå’Œfind_packageã€‚è¿™äº›å‘½ä»¤çš„å‚æ•°ç¤ºæ„å¦‚ä¸‹: find_path(\u003cVAR\u003e NAMES name PATHS paths) å¦‚æœæœç´¢æˆåŠŸï¼Œ\u003cVAR\u003eå°†ä¿å­˜æœç´¢ç»“æœï¼›å¦‚æœæœç´¢å¤±è´¥ï¼Œåˆ™ä¼šè®¾ç½®ä¸º\u003cVAR\u003e-NOTFOUNDã€‚NAMESå’ŒPATHSåˆ†åˆ«æ˜¯CMakeåº”è¯¥æŸ¥æ‰¾çš„æ–‡ä»¶çš„åç§°å’Œæœç´¢åº”è¯¥æŒ‡å‘çš„è·¯å¾„ã€‚ åˆæ­¥æœç´¢çš„ç»“æœä¸­ï¼Œå¯ä»¥æå–ç‰ˆæœ¬å·ã€‚æœ¬ä¾‹ä¸­ï¼ŒZeroMQå¤´æ–‡ä»¶åŒ…å«åº“ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æ“ä½œå’Œæ­£åˆ™è¡¨è¾¾å¼æå–åº“ç‰ˆæœ¬ä¿¡æ¯ã€‚ æœ€åï¼Œè°ƒç”¨find_package_handle_standard_argså‘½ä»¤ã€‚å¤„ç†find_packageå‘½ä»¤çš„REQUIREDã€QUIETå’Œç‰ˆæœ¬å‚æ•°ï¼Œå¹¶è®¾ç½®ZeroMQ_FOUNDå˜é‡ã€‚ æ€»ç»“ï¼šæœ‰å››ç§æ–¹å¼å¯ç”¨äºæ‰¾åˆ°ä¾èµ–åŒ…ã€‚ ä½¿ç”¨ç”±åŒ…ä¾›åº”å•†æä¾›CMakeæ–‡ä»¶\u003cpackage\u003eConfig.cmake ï¼Œ\u003cpackage\u003eConfigVersion.cmakeå’Œ\u003cpackage\u003eTargets.cmakeï¼Œé€šå¸¸ä¼šåœ¨åŒ…çš„æ ‡å‡†å®‰è£…ä½ç½®æŸ¥æ‰¾ã€‚ æ— è®ºæ˜¯ç”±CMakeè¿˜æ˜¯ç¬¬ä¸‰æ–¹æä¾›çš„æ¨¡å—ï¼Œä¸ºæ‰€éœ€åŒ…ä½¿ç”¨find-moduleã€‚ ä½¿ç”¨pkg-configï¼Œå¦‚æœ¬ç¯‡çš„ç¤ºä¾‹æ‰€ç¤ºã€‚ å¦‚æœè¿™äº›éƒ½ä¸å¯è¡Œï¼Œé‚£ä¹ˆç¼–å†™è‡ªå·±çš„findæ¨¡å—ã€‚ è¿™å››ç§å¯é€‰æ–¹æ¡ˆæŒ‰ç›¸å…³æ€§è¿›è¡Œäº†æ’åºï¼Œæ¯ç§æ–¹æ³•ä¹Ÿéƒ½æœ‰å…¶æŒ‘æˆ˜ã€‚ ç›®å‰ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„åŒ…ä¾›åº”å•†éƒ½æä¾›CMakeçš„Findæ–‡ä»¶ï¼Œä¸è¿‡æ­£å˜å¾—è¶Šæ¥è¶Šæ™®éã€‚å› ä¸ºå¯¼å‡ºCMakeç›®æ ‡ï¼Œä½¿å¾—ç¬¬ä¸‰æ–¹ä»£ç å¾ˆå®¹æ˜“ä½¿ç”¨å®ƒæ‰€ä¾èµ–çš„åº“å’Œ/æˆ–ç¨‹åºé™„åŠ çš„ä¾èµ–ã€‚ ä»ä¸€å¼€å§‹ï¼ŒFind-moduleå°±ä¸€ç›´æ˜¯CMakeä¸­å®šä½ä¾èµ–çš„ä¸»æµæ‰‹æ®µã€‚ä½†æ˜¯ï¼Œå®ƒä»¬ä¸­çš„å¤§å¤šæ•°ä»ç„¶ä¾èµ–äºè®¾ç½®ä¾èµ–é¡¹ä½¿ç”¨çš„å˜é‡ï¼Œæ¯”å¦‚Boost_INCLUDE_DIRSã€PYTHON_INTERPRETERç­‰ç­‰ã€‚è¿™ç§æ–¹å¼å¾ˆéš¾åœ¨ç¬¬ä¸‰æ–¹å‘å¸ƒè‡ªå·±çš„åŒ…æ—¶ï¼Œç¡®ä¿ä¾èµ–å…³ç³»è¢«æ»¡è¶³ã€‚ ä½¿ç”¨pkg-configçš„æ–¹æ³•å¯ä»¥å¾ˆå¥½åœ°è¿›è¡Œé€‚é…ï¼Œå› ä¸ºå®ƒå·²ç»æˆä¸ºUnixç³»ç»Ÿçš„æ ‡å‡†ã€‚ç„¶è€Œï¼Œä¹Ÿç”±äºè¿™ä¸ªåŸå› ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªå®Œå…¨è·¨å¹³å°çš„æ–¹æ³•ã€‚æ­¤å¤–ï¼Œå¦‚CMakeæ–‡æ¡£æ‰€è¿°ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯èƒ½ä¼šæ„å¤–åœ°è¦†ç›–æ£€æµ‹åŒ…ï¼Œå¹¶å¯¼è‡´pkg-configæä¾›ä¸æ­£ç¡®çš„ä¿¡æ¯ã€‚ æœ€åçš„æ–¹æ³•æ˜¯ç¼–å†™è‡ªå·±çš„æŸ¥æ‰¾æ¨¡å—è„šæœ¬ï¼Œå°±åƒæœ¬ç¤ºä¾‹ä¸­é‚£æ ·ã€‚è¿™æ˜¯å¯è¡Œçš„ï¼Œå¹¶ä¸”ä¾èµ–äºFindPackageHandleStandardArgs.cmakeã€‚ç„¶è€Œï¼Œç¼–å†™ä¸€ä¸ªå…¨é¢çš„æŸ¥æ‰¾æ¨¡å—è„šæœ¬ç»éæ˜“äº‹ï¼Œéœ€è¦è€ƒè™‘å¾ˆå¤šå¯èƒ½æ€§ã€‚ æœ€åç¥å¤§å®¶å˜å¾—æ›´å¼ºï¼ ![Image](data:image/svg+xml,%3C%3Fxml version=â€˜1.0â€™ encoding=â€˜UTF-8â€™%3F%3E%3Csvg width=â€˜1pxâ€™ height=â€˜1pxâ€™ viewBox=â€˜0 0 1 1â€™ version=â€˜1.1â€™ xmlns=â€˜http://www.w3.org/2000/svg' xmlns:xlink=â€˜http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke=â€˜noneâ€™ stroke-width=â€˜1â€™ fill=â€˜noneâ€™ fill-rule=â€˜evenoddâ€™ fill-opacity=â€˜0â€™%3E%3Cg transform=â€˜translate(-249.000000, -126.000000)â€™ fill=â€™%23FFFFFFâ€™%3E%3Crect x=â€˜249â€™ y=â€˜126â€™ width=â€˜1â€™ height=â€˜1â€™%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E) ![Image](data:image/svg+xml,%3C%3Fxml version=â€˜1.0â€™ encoding=â€˜UTF-8â€™%3F%3E%3Csvg width=â€˜1pxâ€™ height=â€˜1pxâ€™ viewBox=â€˜0 0 1 1â€™ version=â€˜1.1â€™ xmlns=â€˜http://www.w3.org/2000/svg' xmlns:xlink=â€˜http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke=â€˜noneâ€™ stroke-width=â€˜1â€™ fill=â€˜noneâ€™ fill-rule=â€˜evenoddâ€™ fill-opacity=â€˜0â€™%3E%3Cg transform=â€˜translate(-249.000000, -126.000000)â€™ fill=â€™%23FFFFFFâ€™%3E%3Crect x=â€˜249â€™ y=â€˜126â€™ width=â€˜1â€™ height=â€˜1â€™%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E) cmake44 cmake Â· ç›®å½• ä¸Šä¸€ç¯‡CMake:æ£€æµ‹å¤–éƒ¨åº“â€”ä½¿ç”¨pkg-configä¸‹ä¸€ç¯‡CMake:åˆ©ç”¨CTestè¿›è¡Œå•å…ƒæµ‹è¯• People who liked this content also liked CMake:è¶…çº§æ„å»ºæ¨¡å¼ Hope Hut ä¸å–œæ¬¢ ä¸çœ‹çš„åŸå›  OK å†…å®¹è´¨é‡ä½ ä¸çœ‹æ­¤å…¬ä¼—å· IDEA 2023.3 çˆ†äº†ï¼ æ¶æ„æ±ª ä¸å–œæ¬¢ ä¸çœ‹çš„åŸå›  OK å†…å®¹è´¨é‡ä½ ä¸çœ‹æ­¤å…¬ä¼—å· CMake: æ„å»ºæ—¶è®°å½•Git Hashå€¼ Hope Hut ä¸å–œæ¬¢ ä¸çœ‹çš„åŸå›  OK å†…å®¹è´¨é‡ä½ ä¸çœ‹æ­¤å…¬ä¼—å· Scan to Follow people underline ","date":"2024-01-28","objectID":"/posts/cmake_note_17/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [17] æ£€æµ‹å¤–éƒ¨åº“ -- è‡ªå®šä¹‰findæ¨¡å—","uri":"/posts/cmake_note_17/"},{"categories":["C++"],"content":"ä¸€ã€æ£€æµ‹å¤–éƒ¨åº“â€”ä½¿ç”¨pkg-config å¯¼è¨€ å‰é¢å‡ ç¯‡å†…å®¹çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šäº†è§£äº†å¦‚ä½•é“¾æ¥ä¸€ä¸ªä¸‰æ–¹åº“çš„æ–¹æ³•ã€‚æœ¬ç¯‡ä»¥åŠä¸‹ä¸€ç¯‡å°†è¡¥å……ä¸¤ä¸ªæ£€æµ‹å¤–éƒ¨åº“çš„æ–¹æ³•ã€‚ ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¹ äº†ä¸¤ç§æ£€æµ‹å¤–éƒ¨ä¾èµ–å…³ç³»çš„æ–¹æ³•ï¼š ä½¿ç”¨CMakeè‡ªå¸¦çš„find-moduleï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„åŒ…åœ¨CMakeçš„findæ¨¡å—éƒ½æ‰¾å¾—åˆ°ã€‚ ä½¿ç”¨\u003cpackage\u003eConfig.cmake ,\u003cpackage\u003eConfigVersion.cmakeå’Œ\u003cpackage\u003eTargets.cmakeï¼Œè¿™äº›æ–‡ä»¶ç”±è½¯ä»¶åŒ…ä¾›åº”å•†æä¾›ï¼Œå¹¶ä¸è½¯ä»¶åŒ…ä¸€èµ·å®‰è£…åœ¨æ ‡å‡†ä½ç½®çš„cmakeæ–‡ä»¶å¤¹ä¸‹ã€‚ å¦‚æœæŸä¸ªä¾èµ–é¡¹æ—¢ä¸æä¾›æŸ¥æ‰¾æ¨¡å—ï¼Œä¹Ÿä¸æä¾›ä¾›åº”å•†çš„CMakeæ–‡ä»¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼š ä¾èµ–pkg-configç¨‹åºï¼Œæ¥æ‰¾åˆ°ç³»ç»Ÿä¸Šçš„åŒ…ã€‚è¿™ä¾èµ–äºåŒ…ä¾›åº”å•†åœ¨.pcé…ç½®æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­æœ‰å…³äºå‘è¡ŒåŒ…çš„å…ƒæ•°æ®ã€‚ ä¸ºä¾èµ–é¡¹ç¼–å†™è‡ªå·±çš„find-packageæ¨¡å—ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ZMQçš„ä½¿ç”¨ï¼Œæ¥æ¼”ç¤ºç¬¬ä¸€ç§æ–¹æ³•çš„ä½¿ç”¨ã€‚ ","date":"2024-01-28","objectID":"/posts/cmake_note_16/:0:0","tags":["CMake"],"title":"CMake ç¬”è®° | [16] æ£€æµ‹å¤–éƒ¨åº“---ä½¿ç”¨pkg-config","uri":"/posts/cmake_note_16/"},{"categories":["C++"],"content":"äºŒã€ZMQçš„å®‰è£… ZMQä¸‹è½½ï¼š https://github.com/zeromq ä¸‹è½½å¥½åè§£å‹, å¹¶è¿›å…¥ç›®å½•ï¼šï¼š tar -xzvf libzmq-4.3.4.tar.gz . cd libzmq-4.3.4 å¼€å§‹å®‰è£… ./autogen.sh ä½¿ç”¨prefixæ¥æŒ‡å®šå®‰è£…ç›®å½• ./configure --prefix=/opt/zmq/ --without-libsodium make sudo make install ","date":"2024-01-28","objectID":"/posts/cmake_note_16/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [16] æ£€æµ‹å¤–éƒ¨åº“---ä½¿ç”¨pkg-config","uri":"/posts/cmake_note_16/"},{"categories":["C++"],"content":"ä¸‰ã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ zmq_client.cpp â””â”€â”€ zmq_server.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter3/05 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(test_zmq LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) set(CMAKE_PREFIX_PATH /opt/zmq) find_package(PkgConfig REQUIRED QUIET) pkg_search_module( ZeroMQ REQUIRED libzeromq libzmq lib0mq IMPORTED_TARGET ) if(TARGET PkgConfig::ZeroMQ) message(STATUS \"Found ZeroMQ\") endif() add_executable(hw_server zmq_server.cpp) target_link_libraries(hw_server PkgConfig::ZeroMQ) add_executable(hw_client zmq_client.cpp) target_link_libraries(hw_client PkgConfig::ZeroMQ) ä½¿ç”¨pkg_search_moduleé€šæœç´¢ä»»ä½•é™„å¸¦åŒ…é…ç½®.pcæ–‡ä»¶çš„åº“æˆ–ç¨‹åºæ¥æŸ¥æ‰¾å’Œå¯¼å…¥ZeroMQåº“ã€‚è¿™ä¸ªå‘½ä»¤ä¼šåœ¨CMakeä¸­é€šè¿‡PkgConfigå·¥å…·æŸ¥æ‰¾å’Œé…ç½®ZeroMQåº“ã€‚ pkg_search_module( ZeroMQ REQUIRED libzeromq libzmq lib0mq IMPORTED_TARGET ) ZeroMQçš„ä¿¡æ¯å°†ä¼šè¢«å­˜å‚¨åœ¨ä¸€ä¸ªå¯¼å…¥ç›®æ ‡ä¸­ï¼Œå…¶åç§°æ˜¯PkgConfig::ZeroMQï¼Œå¯ä»¥å°†è¿™ä¸ªç›®æ ‡é“¾æ¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶æˆ–åº“ã€‚ å¯¼å…¥ç›®æ ‡ ç›¸å…³æºç  zmq_client.cpp #include \u003cstdio.h\u003e #include \u003cstring.h\u003e #include \u003cunistd.h\u003e #include \u003czmq.h\u003e int main() { void *context = zmq_ctx_new(); void *requester = zmq_socket(context, ZMQ_REQ); int rc = zmq_connect(requester, \"tcp://localhost:5555\"); if (rc != 0) { perror(\"Failed to connect to server\"); return 1; } while (true) { char buffer[] = \"Hello\"; zmq_send(requester, buffer, sizeof(buffer), 0); char reply[10]; zmq_recv(requester, reply, sizeof(reply), 0); printf(\"Received: %s\\n\", reply); sleep(10); } zmq_close(requester); zmq_ctx_destroy(context); return 0; } zmq_server.cpp include \u003cstdio.h\u003e #include \u003cstring.h\u003e #include \u003cunistd.h\u003e #include \u003czmq.h\u003e int main() { void *context = zmq_ctx_new(); void *responder = zmq_socket(context, ZMQ_REP); int rc = zmq_bind(responder, \"tcp://*:5555\"); if (rc != 0) { perror(\"Failed to bind socket\"); return 1; } while (1) { char buffer[10]; zmq_recv(responder, buffer, sizeof(buffer), 0); printf(\"Received: %s\\n\", buffer); zmq_send(responder, \"World\", 5, 0); } zmq_close(responder); zmq_ctx_destroy(context); return 0; } æ„å»ºé¡¹ç›®ï¼Œå¹¶æ‰§è¡Œ $ mkdir -p build $ cd build $ cmake .. $ cmake --build . æ‰§è¡Œç”Ÿæˆçš„ä¸¤ä¸ªè¿›ç¨‹ç»“æœï¼š è¾“å‡ºç»“æœ ","date":"2024-01-28","objectID":"/posts/cmake_note_16/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [16] æ£€æµ‹å¤–éƒ¨åº“---ä½¿ç”¨pkg-config","uri":"/posts/cmake_note_16/"},{"categories":["C++"],"content":"ä¸€ã€æ£€æµ‹å¹¶ä½¿ç”¨OpenMPçš„å¹¶è¡Œç¯å¢ƒ å¯¼è¨€ ç›®å‰ï¼Œå¸‚é¢ä¸Šçš„è®¡ç®—æœºå‡ ä¹éƒ½æ˜¯å¤šæ ¸æœºå™¨ï¼Œå¯¹äºæ€§èƒ½æ•æ„Ÿçš„ç¨‹åºï¼Œæˆ‘ä»¬å¿…é¡»å…³æ³¨è¿™äº›å¤šæ ¸å¤„ç†å™¨ï¼Œå¹¶åœ¨ç¼–ç¨‹æ¨¡å‹ä¸­ä½¿ç”¨å¹¶å‘ã€‚OpenMPæ˜¯å¤šæ ¸å¤„ç†å™¨ä¸Šå¹¶è¡Œæ€§çš„æ ‡å‡†ä¹‹ä¸€ã€‚ä¸ºäº†ä»OpenMPå¹¶è¡ŒåŒ–ä¸­è·å¾—æ€§èƒ½æ”¶ç›Šï¼Œé€šå¸¸ä¸éœ€è¦ä¿®æ”¹æˆ–é‡å†™ç°æœ‰ç¨‹åºã€‚ä¸€æ—¦ç¡®å®šäº†ä»£ç ä¸­çš„æ€§èƒ½å…³é”®éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼šä½¿ç”¨åˆ†æå·¥å…·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©OpenMPé€šè¿‡é¢„å¤„ç†å™¨æŒ‡ä»¤ï¼ŒæŒ‡ç¤ºç¼–è¯‘å™¨ä¸ºè¿™äº›åŒºåŸŸç”Ÿæˆå¯å¹¶è¡Œçš„ä»£ç ã€‚ ","date":"2024-01-27","objectID":"/posts/cmake_note_15/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [15] æ£€æµ‹å¹¶ä½¿ç”¨OpenMPçš„å¹¶è¡Œç¯å¢ƒ","uri":"/posts/cmake_note_15/"},{"categories":["C++"],"content":"äºŒã€OpenMPç®€ä»‹ OpenMPï¼ˆOpen Multi-Processingï¼‰æ˜¯ä¸€ä¸ªç”¨äºå…±äº«å†…å­˜å¤šå¤„ç†å™¨è®¡ç®—æœºä½“ç³»ç»“æ„çš„å¹¶è¡Œç¼–ç¨‹æ¨¡å‹ã€‚å®ƒæä¾›äº†ä¸€å¥—ç”¨äºå¹¶è¡ŒåŒ–åº”ç”¨ç¨‹åºçš„æŒ‡ä»¤é›†å’Œç¼–ç¨‹æ¥å£ï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæ›´å®¹æ˜“åœ°åœ¨å¤šæ ¸å¤„ç†å™¨ä¸Šå®ç°å¹¶è¡Œè®¡ç®—ã€‚ä»¥ä¸‹æ˜¯å…³äºOpenMPçš„ä¸€äº›åŸºæœ¬ä»‹ç»ï¼š 1. å¹¶è¡Œæ€§æ¨¡å‹ï¼š OpenMPæ—¨åœ¨ç®€åŒ–å¹¶è¡Œç¨‹åºçš„ç¼–å†™è¿‡ç¨‹ï¼Œå®ƒåŸºäºå…±äº«å†…å­˜æ¶æ„ï¼Œå…¶ä¸­å¤šä¸ªå¤„ç†å™¨æ ¸å¿ƒå…±äº«åŒä¸€å†…å­˜ã€‚æ¯ä¸ªæ ¸å¿ƒéƒ½å¯ä»¥è®¿é—®æ‰€æœ‰å†…å­˜ä½ç½®ï¼Œå› æ­¤é€šè¿‡å…±äº«æ•°æ®æ¥å®ç°å¹¶è¡Œè®¡ç®—ã€‚ 2. æŒ‡ä»¤æ³¨é‡Šï¼š OpenMPä½¿ç”¨ä¸€ç§é€šè¿‡åœ¨ç°æœ‰ä»£ç ä¸­æ’å…¥ç‰¹æ®Šçš„æŒ‡ä»¤æ³¨é‡Šæ¥å®ç°å¹¶è¡Œæ€§çš„æ–¹æ³•ã€‚è¿™äº›æŒ‡ä»¤å‘Šè¯‰ç¼–è¯‘å™¨åœ¨ä»£ç ä¸­çš„å“ªäº›éƒ¨åˆ†å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œä»¥åŠå¦‚ä½•åœ¨å¹¶è¡Œæ‰§è¡ŒæœŸé—´å¤„ç†å…±äº«çš„æ•°æ®ã€‚ 3. çº¿ç¨‹çº§å¹¶è¡Œï¼š OpenMPå°†ä»»åŠ¡åˆ†è§£æˆå¤šä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨ä¸åŒçš„å¤„ç†å™¨æ ¸å¿ƒä¸Šè¿è¡Œã€‚æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹åœ°æ‰§è¡ŒæŒ‡å®šçš„ä»»åŠ¡ï¼Œè¿™æ ·å¯ä»¥å……åˆ†åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨çš„è®¡ç®—èƒ½åŠ›ã€‚ 4. å¹¶è¡Œè¯­æ³•ï¼š OpenMPä½¿ç”¨é¢„å¤„ç†å™¨æŒ‡ä»¤ã€å‡½æ•°æ³¨é‡Šä»¥åŠåº“å‡½æ•°æ¥å®ç°å¹¶è¡Œæ€§ã€‚å¯ä»¥é€šè¿‡åœ¨ä»£ç ä¸­æ’å…¥ç‰¹å®šçš„ç¼–è¯‘å™¨æŒ‡ä»¤æ¥æ ‡è¯†éœ€è¦å¹¶è¡Œæ‰§è¡Œçš„ä»£ç å—ã€‚ 5. æ•°æ®å…±äº«ä¸åŒæ­¥ï¼š åœ¨å¤šçº¿ç¨‹å¹¶è¡Œè®¡ç®—ä¸­ï¼Œå…±äº«æ•°æ®çš„è®¿é—®éœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚OpenMPæä¾›äº†ä¸€äº›æœºåˆ¶ï¼Œå¦‚åŸå­æ“ä½œå’Œä¸´ç•Œæ®µï¼Œä»¥ç¡®ä¿æ•°æ®çš„æ­£ç¡®å…±äº«å’ŒåŒæ­¥ã€‚ 6. è·¨å¹³å°ï¼š OpenMPæ”¯æŒè®¸å¤šä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥åœ¨å„ç§å¹³å°ä¸Šä½¿ç”¨ç›¸åŒçš„å¹¶è¡Œä»£ç ã€‚ 7. ç¼–è¯‘å™¨æ”¯æŒï¼š å¤§å¤šæ•°ç°ä»£ç¼–è¯‘å™¨éƒ½æ”¯æŒOpenMPï¼Œå¹¶å¯ä»¥é€šè¿‡åœ¨ç¼–è¯‘æ—¶å¯ç”¨OpenMPé€‰é¡¹æ¥ç”Ÿæˆå¹¶è¡Œä»£ç ã€‚ 8. çµæ´»æ€§ï¼š OpenMPæä¾›äº†ä¸åŒçº§åˆ«çš„å¹¶è¡Œæ€§ï¼Œä»å•ä¸€çš„forå¾ªç¯å¹¶è¡Œåˆ°æ›´å¤æ‚çš„ä»»åŠ¡å¹¶è¡Œã€‚ 9. ç”¨é€”å¹¿æ³›ï¼š OpenMPé€‚ç”¨äºè®¸å¤šé¢†åŸŸï¼ŒåŒ…æ‹¬ç§‘å­¦è®¡ç®—ã€æ•°æ®åˆ†æã€å›¾åƒå¤„ç†ç­‰ï¼Œä½¿å¾—åœ¨å¤šæ ¸å¤„ç†å™¨ä¸Šæé«˜åº”ç”¨ç¨‹åºæ€§èƒ½å˜å¾—æ›´åŠ ç®€å•ã€‚ æ€»ä¹‹ï¼ŒOpenMPæ˜¯ä¸€ä¸ªç”¨äºå…±äº«å†…å­˜å¹¶è¡Œç¼–ç¨‹çš„å¼ºå¤§å·¥å…·ï¼Œå®ƒé€šè¿‡ä¸ºå¼€å‘è€…æä¾›ç®€å•ä¸”é«˜æ•ˆçš„æ–¹å¼æ¥å®ç°å¤šæ ¸å¤„ç†å™¨ä¸Šçš„å¹¶è¡Œè®¡ç®—ï¼Œå¸®åŠ©ä¼˜åŒ–æ€§èƒ½å¹¶åŠ é€Ÿåº”ç”¨ç¨‹åºçš„æ‰§è¡Œã€‚ ","date":"2024-01-27","objectID":"/posts/cmake_note_15/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [15] æ£€æµ‹å¹¶ä½¿ç”¨OpenMPçš„å¹¶è¡Œç¯å¢ƒ","uri":"/posts/cmake_note_15/"},{"categories":["C++"],"content":"ä¸‰ã€é¡¹ç›®ä»£ç  é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ test_no_openmp.cpp â””â”€â”€ test_openmp.cpp ä¸ºäº†çª¥æ¢ä½¿ç”¨OpenMPä¸ä¸ä½¿ç”¨OpenMPä¹‹é—´çš„å·®å¼‚æ€§ï¼Œé¡¹ç›®ä¸­æ–°å»ºäº†ä¸¤ä¸ªè¿›ç¨‹ä»¥éªŒè¯å…¶æ€§èƒ½ï¼Œå…·ä½“æ€§èƒ½è¡¨ç°å‚è€ƒæœ€åä¸€éƒ¨åˆ†çš„è¾“å‡ºç»“æœã€‚ é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter3/04 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(test_openmp LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) find_package(OpenMP REQUIRED) add_executable(test_openmp test_openmp.cpp) target_link_libraries(test_openmp PUBLIC OpenMP::OpenMP_CXX ) add_executable(test_no_openmp test_no_openmp.cpp) target_link_libraries(test_no_openmp PUBLIC OpenMP::OpenMP_CXX ) å¼•ç”¨ find_package(OpenMP REQUIRED) è°ƒç”¨find_packageæ¥æœç´¢OpenMPã€‚ å¼•ç”¨ add_executable(example example.cpp) target_link_libraries(example PUBLIC OpenMP::OpenMP_CXX ) é“¾æ¥åˆ°FindOpenMPæ¨¡å—æä¾›çš„å¯¼å…¥ç›®æ ‡ã€‚ ç›¸å…³æºç  test_openmp.cpp #include \u003comp.h\u003e #include \u003ciostream\u003e #include \u003cstring\u003e int main(int argc, char *argv[]) { std::cout \u003c\u003c \"number of available processors: \" \u003c\u003c omp_get_num_procs() \u003c\u003c std::endl; std::cout \u003c\u003c \"number of threads: \" \u003c\u003c omp_get_max_threads() \u003c\u003c std::endl; auto n = 1000000000; std::cout \u003c\u003c \"we will form sum of numbers from 1 to \" \u003c\u003c n \u003c\u003c std::endl; // start timer auto t0 = omp_get_wtime(); auto s = 0LL; #pragma omp parallel for reduction(+ : s) for (auto i = 1; i \u003c= n; i++) { s += i; } // stop timer auto t1 = omp_get_wtime(); std::cout \u003c\u003c \"sum: \" \u003c\u003c s \u003c\u003c std::endl; std::cout \u003c\u003c \"elapsed wall clock time: \" \u003c\u003c t1 - t0 \u003c\u003c \" seconds\" \u003c\u003c std::endl; return 0; } test_no_openmp.cpp #include \u003comp.h\u003e #include \u003ciostream\u003e #include \u003cstring\u003e int main(int argc, char *argv[]) { auto n = 1000000000; std::cout \u003c\u003c \"we will form sum of numbers from 1 to \" \u003c\u003c n \u003c\u003c std::endl; // start timer auto t0 = omp_get_wtime(); auto s = 0LL; for (auto i = 1; i \u003c= n; i++) { s += i; } // stop timer auto t1 = omp_get_wtime(); std::cout \u003c\u003c \"sum: \" \u003c\u003c s \u003c\u003c std::endl; std::cout \u003c\u003c \"elapsed wall clock time: \" \u003c\u003c t1 - t0 \u003c\u003c \" seconds\" \u003c\u003c std::endl; return 0; } è¾“å‡ºç»“æœ: $ mkdir -p build $ cd build $ cmake .. $ cmake --build . $./test_openmp number of available processors: 16 number of threads: 16 we will form sum of numbers from 1 to 1000000000 sum: 500000000500000000 elapsed wall clock time: 0.15193 seconds $./test_no_openmp torials/cmake-tutorial/chapter3/04/build/test_openmp number of available processors: 16 number of threads: 16 we will form sum of numbers from 1 to 1000000000 sum: 500000000500000000 ","date":"2024-01-27","objectID":"/posts/cmake_note_15/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [15] æ£€æµ‹å¹¶ä½¿ç”¨OpenMPçš„å¹¶è¡Œç¯å¢ƒ","uri":"/posts/cmake_note_15/"},{"categories":["C++"],"content":"ä¸€ã€æ£€æµ‹Pythonæ¨¡å—å’ŒåŒ… å¼•ç”¨ ä¸Šä¸€ç¯‡ï¼Œæˆ‘ä»¬åŸºæœ¬äº†è§£äº†å¦‚ä½•æ£€æµ‹pythonçš„è§£é‡Šå™¨å’Œpythonåº“ã€‚é€šå¸¸ï¼Œä»£ç æ˜¯ä¾èµ–äºç‰¹å®šçš„pythonæ¨¡å—çš„ï¼Œæ— è®ºæ˜¯pythonå·¥å…·ã€åµŒå…¥pythonçš„ç¨‹åºï¼Œè¿˜æ˜¯æ‰©å±•pythonçš„åº“ã€‚ä¾‹å¦‚ï¼ŒnumpyåŒ…ã€‚ä¾èµ–äºpythonæ¨¡å—æˆ–åŒ…çš„é¡¹ç›®ä¸­ï¼Œç¡®å®šæ»¡è¶³å¯¹è¿™äº›pythonæ¨¡å—çš„ä¾èµ–éå¸¸é‡è¦ã€‚ ","date":"2024-01-27","objectID":"/posts/cmake_note_14/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [14] æ£€æµ‹Pythonæ¨¡å—å’ŒåŒ…","uri":"/posts/cmake_note_14/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ py3_pure_embedding.cpp â””â”€â”€ use_numpy.py é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter3/03 CMakeLists.txt cmake_minimum_required(VERSION 3.5 FATAL_ERROR) project(python_module LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) find_package(PythonInterp REQUIRED) find_package(PythonLibs ${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR} EXACT REQUIRED) execute_process( COMMAND ${PYTHON_EXECUTABLE} \"-c\" \"import re, numpy; print(re.compile('/__init__.py.*').sub('',numpy.__file__))\" RESULT_VARIABLE numpy_status OUTPUT_VARIABLE numpy_location ERROR_QUIET OUTPUT_STRIP_TRAILING_WHITESPACE ) if(NOT numpy_status) set(NumPy ${numpy_location} CACHE STRING \"Location of NumPy\") endif() execute_process( COMMAND ${PYTHON_EXECUTABLE} \"-c\" \"import numpy; print(numpy.__version__)\" OUTPUT_VARIABLE numpy_version ERROR_QUIET OUTPUT_STRIP_TRAILING_WHITESPACE ) include(FindPackageHandleStandardArgs) find_package_handle_standard_args(NumPy FOUND_VAR NumPy_FOUND REQUIRED_VARS NumPy VERSION_VAR numpy_version ) add_executable(pure-embedding py3_pure_embedding.cpp) target_include_directories(pure-embedding PRIVATE ${PYTHON_INCLUDE_DIRS} ) target_link_libraries(pure-embedding PRIVATE ${PYTHON_LIBRARIES} ) add_custom_command( OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.py COMMAND ${CMAKE_COMMAND} -E copy_if_different ${CMAKE_CURRENT_SOURCE_DIR}/use_numpy.py ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.py DEPENDS ${CMAKE_CURRENT_SOURCE_DIR}/use_numpy.py ) # make sure building pure-embedding triggers the above custom command target_sources(pure-embedding PRIVATE ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.py ) Tip execute_process( COMMAND ${PYTHON_EXECUTABLE} \"-c\" \"import re, numpy; print(re.compile('/__init__.py.*').sub('',numpy.__file__))\" RESULT_VARIABLE numpy_status OUTPUT_VARIABLE numpy_location ERROR_QUIET OUTPUT_STRIP_TRAILING_WHITESPACE ) ä½¿ç”¨äº†CMakeçš„execute_processå‡½æ•°æ¥è¿è¡Œä¸€ä¸ªpythonè„šæœ¬ã€‚è¯¥è„šæœ¬å¯¼å…¥äº†reå’Œnumpyæ¨¡å—ï¼Œç„¶åä½¿ç”¨re.compileå‡½æ•°æ¥æ›¿æ¢numpyæ¨¡å—è·¯å¾„ä¸­çš„ä¸€ä¸ªæ¨¡å¼ã€‚RESULT_VARIABLEç”¨äºæ•è·pythonè„šæœ¬æ‰§è¡Œçš„çŠ¶æ€ï¼Œè€ŒOUTPUT_VARIABLEç”¨äºæ•è·ä¿®æ”¹åçš„numpyæ¨¡å—æ–‡ä»¶çš„ä½ç½®ã€‚é€šè¿‡ä½¿ç”¨ERROR_QUIETæ¥æŠ‘åˆ¶è¿›ç¨‹ç”Ÿæˆçš„ä»»ä½•é”™è¯¯ï¼Œå¹¶ä¸”ä½¿ç”¨OUTPUT_STRIP_TRAILING_WHITESPACEæ¥ç§»é™¤è¾“å‡ºä¸­çš„å°¾éšç©ºæ ¼ã€‚ Tip if(NOT numpy_status) set(NumPy ${numpy_location} CACHE STRING \"Location of NumPy\") endif() å¦‚æœnumpy_statusä¸ä¸ºç©ºï¼Œé‚£ä¹ˆè®¾ç½®äº†ä¸€ä¸ªåä¸ºNumPyçš„CMakeç¼“å­˜å˜é‡ï¼Œå…¶å€¼ä¸ºnumpy_locationï¼Œè¿™ä¸ªå˜é‡ç”¨äºå­˜å‚¨NumPyåº“çš„ä½ç½®ä¿¡æ¯ã€‚è¿™ä¸ªæ“ä½œå…è®¸åœ¨CMakeé…ç½®è¿‡ç¨‹ä¸­æŒ‡å®šNumPyçš„ä½ç½®ï¼Œä»¥ä¾¿åç»­çš„æ„å»ºè¿‡ç¨‹å¯ä»¥ä½¿ç”¨å®ƒã€‚å¦‚æœnumpy_statusä¸ºç©ºï¼Œåˆ™ä¸è¿›è¡Œä»»ä½•æ“ä½œã€‚ Tip execute_process( COMMAND ${PYTHON_EXECUTABLE} \"-c\" \"import numpy; print(numpy.__version__)\" OUTPUT_VARIABLE numpy_version ERROR_QUIET OUTPUT_STRIP_TRAILING_WHITESPACE ) è¿™æ®µä»£ç ä½¿ç”¨execute_processå‘½ä»¤æ¥æ‰§è¡Œä¸€ä¸ªpythonè„šæœ¬ã€‚ ${PYTHON_EXECUTABLE} æ˜¯ä¸€ä¸ªCMakeå˜é‡ï¼Œç”¨äºæŒ‡å®špythonå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚ -c é€‰é¡¹å‘Šè¯‰pythonè§£é‡Šå™¨åé¢ç´§è·Ÿç€çš„å­—ç¬¦ä¸²æ˜¯è¦æ‰§è¡Œçš„pythonä»£ç ã€‚ åœ¨è¿™ä¸ªpythonä»£ç ä¸­ï¼Œé¦–å…ˆå¯¼å…¥äº†numpyåº“ï¼Œç„¶åä½¿ç”¨printå‡½æ•°è¾“å‡ºäº†numpyåº“çš„ç‰ˆæœ¬å·ã€‚ OUTPUT_VARIABLE é€‰é¡¹ç”¨äºæ•è·pythonä»£ç çš„è¾“å‡ºï¼Œå³numpyåº“çš„ç‰ˆæœ¬å·ã€‚ ERROR_QUIET é€‰é¡¹ç”¨äºå¿½ç•¥å¯èƒ½çš„é”™è¯¯ä¿¡æ¯ã€‚ OUTPUT_STRIP_TRAILING_WHITESPACE é€‰é¡¹ç”¨äºç§»é™¤è¾“å‡ºå­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼ã€‚ é€šè¿‡è¿™ä¸ªæ“ä½œï¼Œå¯ä»¥åœ¨CMakeé…ç½®è¿‡ç¨‹ä¸­è·å–å¹¶ä¿å­˜numpyåº“çš„ç‰ˆæœ¬å·ï¼Œä»¥ä¾¿åç»­çš„æ„å»ºè¿‡ç¨‹å¯ä»¥ä½¿ç”¨ã€‚ Tip add_custom_command( OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.py COMMAND ${CMAKE_COMMAND} -E copy_if_different ${CMAKE_CURRENT_SOURCE_DIR}/use_numpy.py ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.py DEPENDS ${CMAKE_CURRENT_SOURCE_DIR}/use_numpy.py ) ä½¿ç”¨ CMake ä¸­çš„ add_custom_command å‘½ä»¤ï¼Œç”¨äºå®šä¹‰è‡ªå®šä¹‰çš„æ„å»ºæ­¥éª¤ï¼Œä»¥åŠç”Ÿæˆç›¸åº”çš„è¾“å‡ºæ–‡ä»¶ã€‚ OUTPUT æŒ‡å®šäº†ç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯ ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.pyã€‚ COMMAND æŒ‡å®šäº†ç”Ÿæˆè¾“å‡ºæ–‡ä»¶æ‰€éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿™é‡Œæ˜¯å°† ${CMAKE_CURRENT_SOURCE_DIR}/use_numpy.py å¤åˆ¶åˆ° ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.pyã€‚ DEPENDS åˆ—å‡ºäº†ç”Ÿæˆè¾“å‡ºæ–‡ä»¶æ‰€ä¾èµ–çš„æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯ ${CMAKE_CURRENT_SOURCE_DIR}/use_numpy.pyã€‚ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœ ${CMAKE_CURRENT_SOURCE_DIR}/use_numpy.py å‘ç”Ÿå˜åŒ–ï¼Œå°±æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤æ¥å°†è¯¥æ–‡ä»¶å¤åˆ¶åˆ°æ„å»ºç›®å½• ${CMAKE_CURRENT_BINARY_DIR} ä¸‹çš„ç›¸åŒè·¯å¾„ã€‚è¿™å¯ä»¥ç¡®ä¿åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå§‹ç»ˆä½¿ç”¨æœ€æ–°çš„ use_numpy.py æ–‡ä»¶ã€‚ Tip target_sources(pure-embedding PRIVATE ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.py ) åœ¨ CMake çš„æ„å»ºè¿‡ç¨‹ä¸­ä¸ºåä¸º pure-embedding çš„ç›®æ ‡ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æˆ–åº“ï¼‰æŒ‡å®šäº†æºæ–‡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œå¹¶æ²¡æœ‰ç›´æ¥æ·»åŠ  C++ æºä»£ç ï¼Œè€Œæ˜¯æ·»åŠ äº†ä¸€ä¸ª python è„šæœ¬æ–‡ä»¶ ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.pyã€‚ è¿™æ„å‘³ç€åœ¨æ„å»º pure-embedding ç›®æ ‡æ—¶ï¼ŒCMake ä¼šå°† ${CMAKE_CURRENT_BINARY_DIR}/use_numpy.py è§†ä¸ºç›®æ ‡çš„æºæ–‡ä»¶ä¹‹ä¸€ï¼Œå¹¶ç¡®","date":"2024-01-27","objectID":"/posts/cmake_note_14/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [14] æ£€æµ‹Pythonæ¨¡å—å’ŒåŒ…","uri":"/posts/cmake_note_14/"},{"categories":["C++"],"content":"ä¸€ã€æ£€æµ‹pythonè§£é‡Šå™¨å’Œpythonåº“ å¯¼è¨€ pythonæ˜¯ä¸€ç§éå¸¸æµè¡Œçš„è¯­è¨€ã€‚è®¸å¤šé¡¹ç›®ç”¨pythonç¼–å†™çš„å·¥å…·ï¼Œä»è€Œå°†ä¸»ç¨‹åºå’Œåº“æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œæˆ–è€…åœ¨é…ç½®æˆ–æ„å»ºè¿‡ç¨‹ä¸­ä½¿ç”¨pythonè„šæœ¬ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç¡®ä¿è¿è¡Œæ—¶pythonè§£é‡Šå™¨çš„ä¾èµ–ä¹Ÿéœ€è¦å¾—åˆ°æ»¡è¶³ã€‚æœ¬ç¯‡å°†å±•ç¤ºå¦‚ä½•æ£€æµ‹å’Œä½¿ç”¨pythonè§£é‡Šå™¨ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥å°†è§£é‡Šè¯­è¨€(å¦‚python)ä¸ç¼–è¯‘è¯­è¨€(å¦‚Cæˆ–C++)ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨ã€‚ä¸€ç§æ˜¯æ‰©å±•pythonï¼Œé€šè¿‡ç¼–è¯‘æˆå…±äº«åº“çš„Cæˆ–C++æ¨¡å—åœ¨è¿™äº›ç±»å‹ä¸Šæä¾›æ–°ç±»å‹å’Œæ–°åŠŸèƒ½ã€‚å¦ä¸€ç§æ˜¯å°†pythonè§£é‡Šå™¨åµŒå…¥åˆ°Cæˆ–C++ç¨‹åºä¸­ã€‚ä¸¤ç§æ–¹æ³•éƒ½éœ€è¦ä¸‹åˆ—æ¡ä»¶: pythonè§£é‡Šå™¨çš„å·¥ä½œç‰ˆæœ¬ pythonå¤´æ–‡ä»¶python.hçš„å¯ç”¨æ€§ pythonè¿è¡Œæ—¶åº“libpython ","date":"2024-01-27","objectID":"/posts/cmake_note_13/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [13] æ£€æµ‹pythonè§£é‡Šå™¨å’Œpythonåº“","uri":"/posts/cmake_note_13/"},{"categories":["C++"],"content":"äºŒã€æ£€æµ‹pythonè§£é‡Šå™¨ é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter3/01 CMakeLists.txtæ–‡ä»¶ cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(python_interperter LANGUAGES NONE) find_package(PythonInterp REQUIRED) execute_process( COMMAND ${PYTHON_EXECUTABLE} \"-c\" \"print('Hello, python interpreter!')\" RESULT_VARIABLE RESULT_STATUS OUTPUT_VARIABLE RESULT_OUTPUT ERROR_QUIET OUTPUT_STRIP_TRAILING_WHITESPACE ) # message(STATUS \"RESULT_VARIABLE is: ${RESULT_STATUS}\") # message(STATUS \"OUTPUT_VARIABLE is: ${RESULT_OUTPUT}\") include(CMakePrintHelpers) cmake_print_variables(RESULT_STATUS RESULT_OUTPUT) å¼•ç”¨ find_package(PythonInterp REQUIRED) ä½¿ç”¨find_packageå‘½ä»¤æ‰¾åˆ°pythonè§£é‡Šå™¨ã€‚ find_packageæ˜¯ç”¨äºå‘ç°å’Œè®¾ç½®åŒ…çš„CMakeæ¨¡å—çš„å‘½ä»¤ã€‚è¿™äº›æ¨¡å—åŒ…å«CMakeå‘½ä»¤ï¼Œç”¨äºæ ‡è¯†ç³»ç»Ÿæ ‡å‡†ä½ç½®ä¸­çš„åŒ…ã€‚CMakeæ¨¡å—æ–‡ä»¶ç§°ä¸ºFind\u003cname\u003e.cmakeï¼Œå½“è°ƒç”¨find_package(\u003cname\u003e)æ—¶ï¼Œæ¨¡å—ä¸­çš„å‘½ä»¤å°†ä¼šè¿è¡Œã€‚ é™¤äº†åœ¨ç³»ç»Ÿä¸Šå®é™…æŸ¥æ‰¾åŒ…æ¨¡å—ä¹‹å¤–ï¼ŒæŸ¥æ‰¾æ¨¡å—è¿˜ä¼šè®¾ç½®äº†ä¸€äº›æœ‰ç”¨çš„å˜é‡ï¼Œåæ˜ å®é™…æ‰¾åˆ°äº†ä»€ä¹ˆï¼Œä¹Ÿå¯ä»¥åœ¨è‡ªå·±çš„CMakeLists.txtä¸­ä½¿ç”¨è¿™äº›å˜é‡ã€‚å¯¹äºpythonè§£é‡Šå™¨ï¼Œç›¸å…³æ¨¡å—ä¸ºFindPythonInterp.cmakeé™„å¸¦çš„è®¾ç½®äº†ä¸€äº›CMakeå˜é‡: PYTHONINTERP_FOUNDï¼šæ˜¯å¦æ‰¾åˆ°è§£é‡Šå™¨ PYTHON_EXECUTABLEï¼špythonè§£é‡Šå™¨åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ PYTHON_VERSION_STRINGï¼špythonè§£é‡Šå™¨çš„å®Œæ•´ç‰ˆæœ¬ä¿¡æ¯ PYTHON_VERSION_MAJORï¼špythonè§£é‡Šå™¨çš„ä¸»è¦ç‰ˆæœ¬å· PYTHON_VERSION_MINOR ï¼špythonè§£é‡Šå™¨çš„æ¬¡è¦ç‰ˆæœ¬å· PYTHON_VERSION_PATCHï¼špythonè§£é‡Šå™¨çš„è¡¥ä¸ç‰ˆæœ¬å· å¯ä»¥å¼ºåˆ¶CMakeï¼ŒæŸ¥æ‰¾ç‰¹å®šç‰ˆæœ¬çš„åŒ…ã€‚ä¾‹å¦‚ï¼Œè¦æ±‚pythonè§£é‡Šå™¨çš„ç‰ˆæœ¬å¤§äºæˆ–ç­‰äº2.7ï¼šfind_package(PythonInterp 2.7)ã€‚ CMakeæœ‰å¾ˆå¤šæŸ¥æ‰¾è½¯ä»¶åŒ…çš„æ¨¡å—ã€‚å»ºè®®åœ¨CMakeåœ¨çº¿æ–‡æ¡£ä¸­æŸ¥è¯¢Find\u003cpackage\u003e.cmakeæ¨¡å—ï¼Œå¹¶åœ¨ä½¿ç”¨å®ƒä»¬ä¹‹å‰è¯¦ç»†é˜…è¯»å®ƒä»¬çš„æ–‡æ¡£ã€‚find_packageå‘½ä»¤çš„æ–‡æ¡£å¯ä»¥å‚è€ƒ : https://cmake.org/cmake/help/v3.5/command/find_ackage.html å¼•ç”¨ execute_process( COMMAND ${PYTHON_EXECUTABLE} \"-c\" \"print('Hello, world!')\" RESULT_VARIABLE _status OUTPUT_VARIABLE _hello_world ERROR_QUIET OUTPUT_STRIP_TRAILING_WHITESPACE ) æ‰§è¡Œpythonå‘½ä»¤å¹¶æ•è·å®ƒçš„è¾“å‡ºå’Œè¿”å›å€¼ã€‚ è¾“å‡º -- Found PythonInterp: /usr/bin/python3.8 (found version \"3.8.10\") -- RESULT_VARIABLE is: 0 -- OUTPUT_VARIABLE is: Hello, python interpreter! -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter3/01/build é™„å½• è½¯ä»¶åŒ…æ²¡æœ‰å®‰è£…åœ¨æ ‡å‡†ä½ç½®æ—¶ï¼ŒCMakeæ— æ³•æ­£ç¡®å®šä½å®ƒä»¬ã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨-Då‚æ•°ä¼ é€’ç›¸åº”çš„é€‰é¡¹ï¼Œå‘Šè¯‰CMakeæŸ¥çœ‹ç‰¹å®šçš„ä½ç½®ã€‚pythonè§£é‡Šå™¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®: $ cmake -D PYTHON_EXECUTABLE=/custom/location/python .. è¿™å°†æŒ‡å®šéæ ‡å‡†/custom/location/pythonå®‰è£…ç›®å½•ä¸­çš„pythonå¯æ‰§è¡Œæ–‡ä»¶ã€‚ æ³¨æ„:æ¯ä¸ªåŒ…éƒ½æ˜¯ä¸åŒçš„ï¼ŒFind\u003cpackage\u003e.cmakeæ¨¡å—è¯•å›¾æä¾›ç»Ÿä¸€çš„æ£€æµ‹æ¥å£ã€‚å½“CMakeæ— æ³•æ‰¾åˆ°æ¨¡å—åŒ…æ—¶ï¼Œå¯ä»¥é˜…è¯»ç›¸åº”æ£€æµ‹æ¨¡å—çš„æ–‡æ¡£ï¼Œä»¥äº†è§£å¦‚ä½•æ­£ç¡®åœ°ä½¿ç”¨CMakeæ¨¡å—ã€‚å¯ä»¥åœ¨ç»ˆç«¯ä¸­ç›´æ¥æµè§ˆæ–‡æ¡£ï¼Œå¯ä½¿ç”¨cmake --help-module FindPythonInterpæŸ¥çœ‹ã€‚ é™¤äº†æ£€æµ‹åŒ…ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æƒ³æåˆ°ä¸€ä¸ªä¾¿äºæ‰“å°å˜é‡çš„helperæ¨¡å—: message(STATUS \"RESULT_VARIABLE is: ${_status}\") message(STATUS \"OUTPUT_VARIABLE is: ${_hello_world}\") ä½¿ç”¨ä»¥ä¸‹å·¥å…·è¿›è¡Œè°ƒè¯•: include(CMakePrintHelpers) cmake_print_variables(_status _hello_world) å°†äº§ç”Ÿä»¥ä¸‹è¾“å‡º: -- _status=\"0\" ; _hello_world=\"Hello, world!\" ä¸‰ã€æ£€æµ‹pythonåº“ é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ hello_embedded_python.c é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter3/02 CMakeLists.txtæ–‡ä»¶ cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(link_python LANGUAGES C) set(CMAKE_C_STANDARD 99) set(CMAKE_C_EXTENSIONS OFF) set(CMAKE_C_STANDARD_REQUIRED ON) find_package(PythonInterp REQUIRED) find_package(PythonLibs ${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR} EXACT REQUIRED) add_executable(hello_embedded_python hello_embedded_python.c) target_include_directories(hello_embedded_python PRIVATE ${PYTHON_INCLUDE_DIRS} ) target_link_libraries(hello_embedded_python PRIVATE ${PYTHON_LIBRARIES} ) ä¸ºäº†ç¡®ä¿å¯æ‰§è¡Œæ–‡ä»¶ã€å¤´æ–‡ä»¶å’Œåº“éƒ½æœ‰ä¸€ä¸ªåŒ¹é…çš„ç‰ˆæœ¬ã€‚è¿™å¯¹äºä¸åŒç‰ˆæœ¬ï¼Œå¯èƒ½åœ¨è¿è¡Œæ—¶å¯¼è‡´å´©æºƒã€‚é€šè¿‡FindPythonInterp.cmakeä¸­å®šä¹‰çš„PYTHON_VERSION_MAJORå’ŒPYTHON_VERSION_MINORæ¥å®ç°: find_package(PythonInterp REQUIRED) find_package(PythonLibs ${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR} EXACT REQUIRED) å¯æ‰§è¡Œæ–‡ä»¶åŒ…å«python.hå¤´æ–‡ä»¶ã€‚å› æ­¤ï¼Œè¿™ä¸ªç›®æ ‡çš„includeç›®å½•å¿…é¡»åŒ…å«pythonçš„includeç›®å½•ï¼Œå¯ä»¥é€šè¿‡PYTHON_INCLUDE_DIRSå˜é‡è¿›è¡ŒæŒ‡å®š: target_include_directories(hello_embedded_python PRIVATE ${PYTHON_INCLUDE_DIRS} ) å°†å¯æ‰§è¡Œæ–‡ä»¶é“¾æ¥åˆ°pythonåº“ï¼Œé€šè¿‡PYTHON_LIBRARIESå˜é‡è®¿é—®: target_link_libraries(hello_embedded_python PRIVATE ${PYTHON_LIBRARIES} ) ç›¸å…³æºç  #include \u003cPython.h\u003e int main(int argc, char *argv[]) { /* optional but recommended */ Py_SetProgramName(argv[0]); Py_Initialize(); PyRun_SimpleString(\"print('Today is Tuesday!')\\n\"); Py_Finalize(); return 0; } é™„å½• å½“pythonä¸åœ¨æ ‡å‡†å®‰è£…ç›®å½•ä¸­ï¼Œå¦‚ä½•ç¡®å®špythonå¤´æ–‡ä»¶å’Œåº“çš„ä½ç½®æ˜¯æ­£ç¡®çš„ï¼Ÿ å¯¹äºpythonè§£é‡Šå™¨ï¼Œå¯ä»¥é€šè¿‡-Dé€‰é¡¹ä¼ é€’PYTHON_LIBRARYå’ŒPYTHON","date":"2024-01-27","objectID":"/posts/cmake_note_13/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [13] æ£€æµ‹pythonè§£é‡Šå™¨å’Œpythonåº“","uri":"/posts/cmake_note_13/"},{"categories":["C++"],"content":"ä¸€ã€CMake:ä¸ºEigenåº“ä½¿èƒ½å‘é‡åŒ– å¯¼è¨€ æœ¬ç¯‡å¼€å§‹å°†æ¶‰åŠæ£€æµ‹å¤–éƒ¨åº“ç›¸å…³çš„å†…å®¹ï¼ŒæœŸé—´ä¼šç©¿æ’ç€ä¸€äº›å…¶ä»–çš„å†…å®¹ã€‚ä¸ºäº†èƒ½å¤Ÿä½¿å¾—ç³»ç»Ÿåœ¨ç³»ç»Ÿä¸­è¿è¡ŒEigenåº“ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨ç³»ç»Ÿä¸­é…ç½®å¥½Eigenåº“ã€‚ç„¶åä»‹ç»ä¸Eigenåº“ç›¸å…³çš„CMakeé…ç½®ã€‚ ","date":"2024-01-26","objectID":"/posts/cmake_note_12/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [12] æ£€æµ‹ç¯å¢ƒ","uri":"/posts/cmake_note_12/"},{"categories":["C++"],"content":"äºŒã€æ„å»ºEigen Windows ä»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…(ä¸‹è½½ZIPæ ¼å¼)ï¼š https://eigen.tuxfamily.org/index.php?title=Main_Page Eigen ä¸‹è½½å®˜ç½‘æˆªå›¾ è§£å‹åˆ°æŸä¸€è·¯å¾„ä¸­,ä½¿ç”¨cmakeç¼–è¯‘ã€‚è¿™é‡Œä»¥vs15ä»¥åŠx64ä¸ºä¾‹ï¼š Cmake ç¼–è¯‘æˆªå›¾ Cmake ç¼–è¯‘æˆªå›¾ é€‰æ‹©è¾“å‡ºè·¯å¾„å¹¶ç‚¹å‡»generateï¼š CMake ç¼–è¯‘æˆªå›¾ VSæ‰“å¼€é¡¹ç›® æ‰“å¼€é¡¹ç›® åœ¨vs2015ä¸­ç”ŸæˆINSTALLã€‚å³é”®ç‚¹å‡»â€œç”Ÿæˆâ€ï¼š ç”Ÿæˆeigenåº“ å°†ç”Ÿæˆåçš„åº“æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼š æ·»åŠ ç¯å¢ƒå˜é‡ ubuntu ä»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…(ä¸‹è½½tar.gzæ ¼å¼)ï¼š https://eigen.tuxfamily.org/index.php?title=Main_Page ä¸‹è½½Eigen EigenåŒ…å®‰è£… ä¸‹è½½å®Œæˆåï¼Œå¯¹å‹ç¼©åŒ…è¿›è¡Œè§£å‹åï¼ˆè§£å‹åœ¨homeç›®å½•å³å¯ï¼‰ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š cd (eigenæ–‡ä»¶å¤¹ä¸­) mkdir build cd build cmake .. sudo make install å°†eigenæ–‡ä»¶å¤åˆ¶åˆ°æœ¬åœ°è°ƒç”¨æ–‡ä»¶å¤¹ä¸­ï¼ˆ/usr/includeï¼‰ sudo cp -r /usr/local/include/eigen3 /usr/include ","date":"2024-01-26","objectID":"/posts/cmake_note_12/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [12] æ£€æµ‹ç¯å¢ƒ","uri":"/posts/cmake_note_12/"},{"categories":["C++"],"content":"ä¸‰ã€Linear_algebraé¡¹ç›®ä¸¾ä¾‹ é¡¹ç›®ç»“æ„ . â”œâ”€â”€ CMakeLists.txt â””â”€â”€ linear_algebra.cpp é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter2/05 CMakeLists.txtæ–‡ä»¶ cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(eigen_tensor LANGUAGES CXX) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_EXTENSIONS OFF) set(CMAKE_CXX_STANDARD_REQUIRED ON) find_package(Eigen3 3.4 REQUIRED CONFIG) include(CheckCXXCompilerFlag) check_cxx_compiler_flag(\"-march=native\" _march_native_works) check_cxx_compiler_flag(\"-xHost\" _xhost_works) set(_CXX_FLAGS) if(_march_native_works) message(STATUS \"Using processor's vector instructions (-march=native compiler flag set)\") set(_CXX_FLAGS \"-march=native\") elseif(_xhost_works) message(STATUS \"Using processor's vector instructions (-xHost compiler flag set)\") set(_CXX_FLAGS \"-xHost\") else() message(STATUS \"No suitable compiler flag found for vectorization\") endif() add_executable(linear-algebra-unoptimized linear_algebra.cpp) target_link_libraries(linear-algebra-unoptimized PRIVATE Eigen3::Eigen ) add_executable(linear-algebra linear_algebra.cpp) target_compile_options(linear-algebra PRIVATE ${_CXX_FLAGS} ) target_link_libraries(linear-algebra PRIVATE Eigen3::Eigen ) ```find_package(Eigen3 3.4 REQUIRED CONFIG)``` find_package æ˜¯CMakeä¸­çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºæŸ¥æ‰¾å’ŒåŠ è½½ç‰¹å®šçš„ç¬¬ä¸‰æ–¹åº“ï¼ˆä¾‹å¦‚Eigen3ï¼‰çš„CMakeé…ç½®æ–‡ä»¶ã€‚ Eigen3 æ˜¯ä¸€ä¸ªç”¨äºçº¿æ€§ä»£æ•°è®¡ç®—çš„C++æ¨¡æ¿åº“ï¼Œå®ƒæä¾›äº†çŸ©é˜µã€å‘é‡ã€çŸ¢é‡è®¡ç®—ç­‰åŠŸèƒ½ã€‚é€šè¿‡åœ¨CMakeä¸­ä½¿ç”¨ find_package(Eigen3 3.4 REQUIRED CONFIG) å‘½ä»¤ï¼Œå‘Šè¯‰CMakeå»æŸ¥æ‰¾Eigen3åº“ï¼Œå¹¶ä¸”è¦æ±‚å®ƒçš„ç‰ˆæœ¬è‡³å°‘æ˜¯3.4ã€‚REQUIRED å‚æ•°è¡¨ç¤ºå¦‚æœæ‰¾ä¸åˆ°Eigen3åº“ï¼ŒCMakeå°†ä¼šæŠ¥é”™å¹¶åœæ­¢æ„å»ºã€‚ CONFIG å‚æ•°æŒ‡ç¤ºCMakeæŸ¥æ‰¾Eigen3çš„CMakeé…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ Eigen3Config.cmake æˆ–ç±»ä¼¼åç§°ï¼‰ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³åº“çš„ä¿¡æ¯å’Œè®¾ç½®ã€‚ ä¸€æ—¦æ‰¾åˆ°Eigen3åº“çš„CMakeé…ç½®æ–‡ä»¶ï¼ŒCMakeä¼šåŠ è½½è¯¥é…ç½®æ–‡ä»¶å¹¶è®¾ç½®ç›¸å…³çš„å˜é‡ï¼Œä¾‹å¦‚ EIGEN3_INCLUDE_DIRï¼Œå…¶ä¸­åŒ…å«äº†Eigen3åº“çš„å¤´æ–‡ä»¶è·¯å¾„ã€‚åœ¨æ¥ä¸‹æ¥çš„CMakeæ„å»ºä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›è®¾ç½®çš„å˜é‡æ¥é“¾æ¥å’ŒåŒ…å«Eigen3åº“ã€‚ ```include(CheckCXXCompilerFlag)``` åœ¨CMakeä¸­ï¼Œinclude(CheckCXXCompilerFlag) æ˜¯ä¸€ä¸ªç”¨äºæ£€æŸ¥C++ç¼–è¯‘å™¨æ ‡å¿—æ˜¯å¦å¯ç”¨çš„CMakeå‘½ä»¤ã€‚ è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ä¸ºäº†æ£€æŸ¥ç‰¹å®šçš„C++ç¼–è¯‘å™¨æ ‡å¿—æ˜¯å¦å—æ”¯æŒã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œéœ€è¦æ ¹æ®ç¼–è¯‘å™¨çš„ä¸åŒæ¥å¯ç”¨æˆ–ç¦ç”¨ä¸€äº›ç‰¹æ€§æˆ–ä¼˜åŒ–é€‰é¡¹ã€‚ ä½¿ç”¨è¿™ä¸ªå‘½ä»¤çš„ä¸€èˆ¬å½¢å¼æ˜¯ï¼š include(CheckCXXCompilerFlag \u003cflag\u003e) å…¶ä¸­\u003cflag\u003eæ˜¯ä½ è¦æ£€æŸ¥çš„C++ç¼–è¯‘å™¨æ ‡å¿—ï¼Œä¾‹å¦‚ -std=c++11ã€-fPIC ç­‰ã€‚ æ­¤å‘½ä»¤å°†å°è¯•å°†æŒ‡å®šçš„ç¼–è¯‘å™¨æ ‡å¿—æ·»åŠ åˆ°C++æºä»£ç ï¼Œå¹¶ç¼–è¯‘ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç¨‹åºæ¥æ£€æŸ¥ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒè¯¥æ ‡å¿—ã€‚å¦‚æœæ”¯æŒï¼Œé‚£ä¹ˆCMakeå°†å®šä¹‰ä¸€ä¸ªCMakeå˜é‡ï¼Œä¾‹å¦‚ CMAKE_REQUIRED_FLAGS æˆ– CMAKE_REQUIRED_LIBRARIESï¼Œæ¥è¡¨ç¤ºè¯¥æ ‡å¿—æ˜¯å¯ç”¨çš„ã€‚ é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥åœ¨CMakeè„šæœ¬ä¸­æ ¹æ®ç¼–è¯‘å™¨æ”¯æŒæƒ…å†µè¿›è¡Œæ¡ä»¶ç¼–è¯‘æˆ–è®¾ç½®ä¸åŒçš„é€‰é¡¹ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬è¦æ£€æŸ¥ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒC++11æ ‡å‡†ï¼š include(CheckCXXCompilerFlag) check_cxx_compiler_flag(\"-std=c++11\" COMPILER_SUPPORTS_CXX11) if (COMPILER_SUPPORTS_CXX11) # è®¾ç½®C++11æ ‡å‡† set(CMAKE_CXX_STANDARD 11) message(STATUS \"C++11 supported by the compiler.\") else () message(FATAL_ERROR \"C++11 is not supported by the compiler.\") endif () check_cxx_compiler_flag(\"-march=native\" _march_native_works) check_cxx_compiler_flag(\"-xHost\" _xhost_works) set(_CXX_FLAGS) if(_march_native_works) message(STATUS \"Using processor's vector instructions (-march=native compiler flag set)\") set(_CXX_FLAGS \"-march=native\") elseif(_xhost_works) message(STATUS \"Using processor's vector instructions (-xHost compiler flag set)\") set(_CXX_FLAGS \"-xHost\") else() message(STATUS \"No suitable compiler flag found for vectorization\") endif() è¿™æ®µCMakeä»£ç ç‰‡æ®µç”¨äºæ£€æŸ¥ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒç‰¹å®šçš„çŸ¢é‡æŒ‡ä»¤ä¼˜åŒ–æ ‡å¿—ï¼Œå¹¶æ ¹æ®ç»“æœè®¾ç½® _CXX_FLAGS å˜é‡ä»¥å¯ç”¨é€‚å½“çš„çŸ¢é‡åŒ–ä¼˜åŒ–ã€‚ -march=native æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨æ ‡å¿—ï¼Œç”¨äºå‘Šè¯‰ç¼–è¯‘å™¨æ ¹æ®å½“å‰ä¸»æœºçš„å¤„ç†å™¨æ¶æ„æ¥ä¼˜åŒ–ç”Ÿæˆçš„æœºå™¨ç ã€‚è¿™ä¸ªæ ‡å¿—ä¼šè®©ç¼–è¯‘å™¨é’ˆå¯¹å½“å‰çš„ CPU æ¶æ„ç”Ÿæˆæœ€ä¼˜åŒ–çš„ä»£ç ï¼Œä»¥å……åˆ†åˆ©ç”¨å¤„ç†å™¨çš„ç‰¹æ€§å’ŒæŒ‡ä»¤é›†ã€‚ ä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨ -march=native æ ‡å¿—ç¼–è¯‘ä»£ç æ—¶ï¼Œå¦‚æœä½ çš„è®¡ç®—æœºçš„å¤„ç†å™¨æ”¯æŒ AVX2 æŒ‡ä»¤é›†ï¼Œç¼–è¯‘å™¨å°†ä¼šé’ˆå¯¹ AVX2 è¿›è¡Œä¼˜åŒ–ã€‚å¦‚æœè¿è¡Œè¿™ä¸ªä¼˜åŒ–è¿‡çš„ä»£ç åœ¨æ”¯æŒ AVX2 çš„å¤„ç†å™¨ä¸Šï¼Œå®ƒå°†èƒ½å¤Ÿè·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚ è¯·æ³¨æ„ï¼Œä½¿ç”¨ -march=native æ ‡å¿—ç¼–è¯‘ä»£ç å¯èƒ½ä¼šå¯¼è‡´ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨å…¶ä»–ä¸åŒæ¶æ„çš„è®¡ç®—æœºä¸Šè¿è¡Œä¸æ­£ç¡®æˆ–ä¸ç¨³å®šã€‚å› æ­¤ï¼Œåœ¨åˆ†å‘æˆ–å…±äº«å¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œæœ€å¥½ä½¿ç”¨æ›´åŠ é€šç”¨çš„ç¼–è¯‘é€‰é¡¹ï¼Œé™¤éç¡®å®éœ€è¦å……åˆ†åˆ©ç”¨ç‰¹å®šå¤„ç†å™¨æ¶æ„çš„ä¼˜åŒ–ã€‚ -xHost æ˜¯ Intel ç¼–è¯‘å™¨çš„ç¼–è¯‘é€‰é¡¹ï¼Œç”¨äºæŒ‡ç¤ºç¼–è¯‘å™¨ä½¿ç”¨ä¸»æœºå¤„ç†å™¨æ”¯æŒçš„æœ€é«˜çº§åˆ«çš„æŒ‡ä»¤é›†æ¥ä¼˜åŒ–ç”Ÿæˆçš„æœºå™¨ç ã€‚ ç±»ä¼¼äº -march=nativeï¼Œ-xHost ä¹Ÿä¼šè®©ç¼–è¯‘å™¨æ ¹æ®å½“å‰ä¸»æœºçš„å¤„ç†å™¨æ¶æ„æ¥é€‰æ‹©æœ€ä¼˜åŒ–çš„æŒ‡ä»¤é›†ã€‚å®ƒä¼šè‡ªåŠ¨æ ¹æ®å½“å‰ç³»ç»Ÿçš„å¤„ç†å™¨ç±»å‹æ¥å†³å®šä½¿ç”¨æœ€é«˜çº§åˆ«çš„æŒ‡ä»¤é›†ï¼Œä»¥å……åˆ†åˆ©ç”¨å¤„ç†å™¨çš„æ€§èƒ½å’ŒåŠŸèƒ½ã€‚ ç„¶è€Œï¼Œä¸ -march=native ä¸åŒçš„æ˜¯ï¼Œ-xHost æ˜¯ç‰¹å®šäº Intel ç¼–è¯‘å™¨çš„é€‰é¡¹ï¼Œè€Œä¸æ˜¯åœ¨å…¶ä»–ç¼–è¯‘å™¨ä¸­é€šç”¨çš„æ ‡å¿—ã€‚ è¯·æ³¨æ„ï¼Œä¸ -march=native ä¸€æ ·ï¼Œä½¿ç”¨ -xHost ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨å…¶ä»–ä¸åŒæ¶æ„çš„è®¡ç®—æœºä¸Šè¿è¡Œä¸æ­£ç¡®æˆ–ä¸ç¨³å®šï¼Œå› æ­¤åœ¨åˆ†å‘æˆ–å…±äº«å¯æ‰§è¡Œæ–‡ä»¶æ—¶éœ€è°¨æ…ä½¿ç”¨ã€‚ ç›¸å…³æºç  linear_algebra.cpp #include \u003ceigen3/Eigen/Dense\u003e #include \u003cchrono\u003e #include \u003ciostream\u003e EIGEN_DONT_INLINE double simple_function(Eigen::VectorXd \u0026va, Eigen::VectorXd \u0026vb) { // this simple function computes the dot product of two vectors // of course it could be expressed more compactly double d = va.dot(vb); return d; } int main() { int len = 1","date":"2024-01-26","objectID":"/posts/cmake_note_12/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [12] æ£€æµ‹ç¯å¢ƒ","uri":"/posts/cmake_note_12/"},{"categories":["C++"],"content":"ä¸€ã€CMake:æ£€æµ‹ç¯å¢ƒ å¯¼è¨€ é€šè¿‡å‰é¢å‡ ç¯‡çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æŒæ¡CMakeä»¥åŠä¸C++ç›¸å…³çš„åŸºæœ¬çŸ¥è¯†ã€‚å°½ç®¡CMakeè·¨å¹³å°ï¼Œä½†æœ‰æ—¶æºä»£ç å¹¶ä¸æ˜¯å®Œå…¨å¯ç§»æ¤ã€‚ä¸ºäº†ä½¿å¾—æˆ‘ä»¬çš„æºä»£ç èƒ½å¤Ÿè·¨å¹³å°ã€æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨ï¼Œæ ¹æ®å¹³å°ä¸åŒçš„æ–¹å¼é…ç½®å’Œ/æˆ–æ„å»ºä»£ç æ˜¯åœ¨æ„å»ºé¡¹ç›®è¿‡ç¨‹ä¸­å¿…ä¸å¯å°‘çš„ç¯èŠ‚ã€‚ ","date":"2024-01-26","objectID":"/posts/cmake_note_11/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [11] æ£€æµ‹ç¯å¢ƒ","uri":"/posts/cmake_note_11/"},{"categories":["C++"],"content":"äºŒã€æ£€æµ‹æ“ä½œç³»ç»Ÿ CMakeæ˜¯ä¸€ç»„è·¨å¹³å°å·¥å…·ã€‚åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ“ä½œç³»ç»Ÿç›¸å…³çš„CMakeä»£ç ï¼Œä¼šæ ¹æ®æ“ä½œç³»ç»Ÿå¯ç”¨æ¡ä»¶ç¼–è¯‘ï¼Œæˆ–è€…åœ¨å¯ç”¨æˆ–å¿…è¦æ—¶ä½¿ç”¨ç‰¹å®šäºç¼–è¯‘å™¨çš„æ‰©å±•ã€‚ è¿™é‡Œä¸¾ä¸ªç‰¹å®šç¤ºä¾‹è¯´æ˜ï¼š Windowsä¸Unixç³»ç»Ÿçš„æ–‡ä»¶ç»“æ„æœ‰æ˜æ˜¾çš„å·®å¼‚ï¼Œå¦‚å°†æ·±åº¦å­¦ä¹ æ¨¡å‹é›†æˆäºC++å¼€å‘çš„è½¯ä»¶ç³»ç»Ÿä¸­æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦å°†æ·±åº¦å­¦ä¹ æ¨¡å‹(*.pth)æ‹·è´åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­æ—¶ï¼š if (MSVC) file(GLOB MODEL \"${CMAKE_SOURCE_DIR}/resource/*.pt\") add_custom_command(TARGET ${PROJECT_NAME} POST_BUILD COMMAND ${CMAKE_COMMAND} -E copy_if_different ${MODEL} $\u003cTARGET_FILE_DIR:${PROJECT_NAME}\u003e) elseif(UNIX) file(GLOB MODEL \"${CMAKE_SOURCE_DIR}/resource/*.pt\") file(COPY ${MODEL} DESTINATION ${EXECUTE_FILE}) endif() è¿™æ®µCMakeä»£ç ç”¨äºåœ¨æ„å»ºé¡¹ç›®åï¼Œæ ¹æ®ç›®æ ‡å¹³å°çš„ä¸åŒï¼ˆWindowsæˆ–UNIX/Linuxï¼‰ï¼Œå°†æ¨¡å‹æ–‡ä»¶å¤åˆ¶åˆ°è¾“å‡ºç›®å½•ä¸­ï¼Œä»¥ç¡®ä¿è¿è¡Œç¨‹åºæ—¶æ‰€éœ€çš„æ¨¡å‹æ–‡ä»¶ï¼ˆå…·æœ‰.ptæ‰©å±•åï¼‰ä¸å¯æ‰§è¡Œæ–‡ä»¶ä½äºåŒä¸€ç›®å½•ä¸‹ã€‚ å¯¹äºMSVCï¼ˆMicrosoft Visual C++ç¼–è¯‘å™¨ï¼Œé€šå¸¸ç”¨äºWindowså¹³å°ï¼‰ï¼š ä½¿ç”¨file()å‘½ä»¤å¹¶è®¾ç½®GLOBé€‰é¡¹ï¼Œåœ¨CMakeæºä»£ç ç›®å½•ï¼ˆ${CMAKE_SOURCE_DIR}ï¼‰ä¸‹çš„resourceç›®å½•ä¸­æŸ¥æ‰¾æ‰€æœ‰.ptæ¨¡å‹æ–‡ä»¶ã€‚ ç„¶åä½¿ç”¨add_custom_command()å‘½ä»¤å°†è‡ªå®šä¹‰çš„åæœŸæ„å»ºå‘½ä»¤æ·»åŠ åˆ°ç›®æ ‡``ï¼ˆ${PROJECT_NAME}ï¼‰ä¸­ã€‚ è‡ªå®šä¹‰å‘½ä»¤ä¼šå°†æ‰¾åˆ°çš„æ‰€æœ‰.ptæ¨¡å‹æ–‡ä»¶å¤åˆ¶åˆ°è¾“å‡ºç›®å½•ï¼ˆ$\u003cTARGET_FILE_DIR:${PROJECT_NAME}\u003eï¼‰ã€‚ä½¿ç”¨copy_if_differentå‚æ•°ç¡®ä¿ä»…åœ¨ç›®æ ‡æ–‡ä»¶ä¸æºæ–‡ä»¶ä¸åŒæˆ–ç›®æ ‡ç›®å½•ä¸­ä¸å­˜åœ¨æ—¶æ‰å¤åˆ¶æ–‡ä»¶ã€‚ å¯¹äºUNIXå¹³å°ï¼ˆåŒ…æ‹¬Linuxï¼‰ï¼š ä½¿ç”¨file()å‘½ä»¤å¹¶è®¾ç½®GLOBé€‰é¡¹ï¼Œåœ¨CMakeæºä»£ç ç›®å½•ï¼ˆ\\${CMAKE_SOURCE_DIR}ï¼‰ä¸‹çš„resourceç›®å½•ä¸­æŸ¥æ‰¾æ‰€æœ‰.ptæ¨¡å‹æ–‡ä»¶ã€‚ ç„¶åä½¿ç”¨file()å‘½ä»¤å¹¶è®¾ç½®COPYé€‰é¡¹ï¼Œå°†æ‰¾åˆ°çš„æ‰€æœ‰.ptæ¨¡å‹æ–‡ä»¶å¤åˆ¶åˆ°æŒ‡å®šçš„ç›®æ ‡ç›®å½•ï¼ˆ${EXECUTE_FILE}ï¼‰ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªä¸éœ€è¦ç¼–è¯‘ä»»ä½•æºä»£ç çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨CMakeæ£€æµ‹æ“ä½œç³»ç»Ÿã€‚ é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter2/01 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(os_test) if(CMAKE_SYSTEM_NAME STREQUAL \"Linux\") message(STATUS \"Configuring on/for Linux\") elseif(CMAKE_SYSTEM_NAME STREQUAL \"Darwin\") message(STATUS \"Configuring on/for macOs\") elseif(CMAKE_SYSTEM_NAME STREQUAL \"Windows\") message(STATUS \"Configuring on/for Windows\") elseif(CMAKE_SYSTEM_NAME STREQUAL \"AIX\") message(STATUS \"Configuring on/for IBM AIX\") else() message(STATUS \"Configuring on/for ${CMAKE_SYSTEM_NAME}\") endif() è¾“å‡ºç»“æœ -- The C compiler identification is GNU 9.4.0 -- The CXX compiler identification is GNU 9.4.0 -- Check for working C compiler: /usr/bin/cc -- Check for working C compiler: /usr/bin/cc -- works -- Detecting C compiler ABI info -- Detecting C compiler ABI info - done -- Detecting C compile features -- Detecting C compile features - done -- Check for working CXX compiler: /usr/bin/c++ -- Check for working CXX compiler: /usr/bin/c++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Configuring on/for Linux -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter2/01/build CMakeä¸ºç›®æ ‡æ“ä½œç³»ç»Ÿå®šä¹‰äº†CMAKE_SYSTEM_NAMEï¼Œå› æ­¤ä¸éœ€è¦ä½¿ç”¨å®šåˆ¶å‘½ä»¤ã€å·¥å…·æˆ–è„šæœ¬æ¥æŸ¥è¯¢æ­¤ä¿¡æ¯ã€‚ç„¶åï¼Œå¯ä»¥ä½¿ç”¨æ­¤å˜é‡çš„å€¼å®ç°ç‰¹å®šäºæ“ä½œç³»ç»Ÿçš„æ¡ä»¶å’Œè§£å†³æ–¹æ¡ˆã€‚ åœ¨macOSä¸ŠCMAKE_SYSTEM_NAMEä¸ºDarwinã€‚ åœ¨Linuxå’ŒWindowsä¸Šï¼ŒCMAKE_SYSTEM_NAMEåˆ†åˆ«ä¸ºLinuxå’ŒWindowsã€‚æˆ‘ä»¬äº†è§£äº†å¦‚ä½•åœ¨ç‰¹å®šçš„æ“ä½œç³»ç»Ÿä¸Šæ‰§è¡Œç‰¹å®šçš„CMakeä»£ç ã€‚å½“ç„¶ï¼Œåº”è¯¥å°½é‡å‡å°‘è¿™ç§å®šåˆ¶åŒ–è¡Œä¸ºï¼Œä»¥ä¾¿ç®€åŒ–è¿ç§»åˆ°æ–°å¹³å°çš„è¿‡ç¨‹ã€‚ æ³¨æ„ï¼šä¸ºäº†æœ€å°åŒ–ä»ä¸€ä¸ªå¹³å°è½¬ç§»åˆ°å¦ä¸€ä¸ªå¹³å°æ—¶çš„æˆæœ¬ï¼Œåº”è¯¥é¿å…ç›´æ¥ä½¿ç”¨Shellå‘½ä»¤ï¼Œè¿˜åº”è¯¥é¿å…æ˜¾å¼çš„è·¯å¾„åˆ†éš”ç¬¦(Linuxå’ŒmacOSä¸Šçš„å‰æ–œæ å’ŒWindowsä¸Šçš„åæ–œæ )ã€‚CMakeä»£ç ä¸­åªä½¿ç”¨å‰æ–œæ ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦ï¼ŒCMakeå°†è‡ªåŠ¨å°†å®ƒä»¬è½¬æ¢ä¸ºæ‰€æ¶‰åŠçš„æ“ä½œç³»ç»Ÿç¯å¢ƒã€‚ ","date":"2024-01-26","objectID":"/posts/cmake_note_11/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [11] æ£€æµ‹ç¯å¢ƒ","uri":"/posts/cmake_note_11/"},{"categories":["C++"],"content":"ä¸‰ã€å¤„ç†ä¸ç¼–è¯‘å™¨ç›¸å…³çš„æºä»£ç  ä¸ºäº†å¯ç§»æ¤æ€§ï¼Œæˆ‘ä»¬å°½é‡é¿å…å»ç¼–å†™æ–°ä»£ç ï¼Œä½†é‡åˆ°æœ‰ä¾èµ–çš„æƒ…å†µæˆ‘ä»¬ä¹Ÿè¦å»è§£å†³ï¼Œç‰¹åˆ«æ˜¯å½“ä½¿ç”¨å†å²ä»£ç æˆ–å¤„ç†ç¼–è¯‘å™¨ä¾èµ–å·¥å…·ã€‚ é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter2/02 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello_os LANGUAGES CXX) add_executable(${PROJECT_NAME} hello_os.cpp) if(CMAKE_SYSTEM_NAME STREQUAL \"Linux\") target_compile_definitions(${PROJECT_NAME} PUBLIC \"IS_LINUX\") endif() if(CMAKE_SYSTEM_NAME STREQUAL \"Darwin\") target_compile_definitions(${PROJECT_NAME} PUBLIC \"IS_MACOS\") endif() if(CMAKE_SYSTEM_NAME STREQUAL \"Windows\") target_compile_definitions(${PROJECT_NAME} PUBLIC \"IS_WINDOWS\") endif() é€šè¿‡target_compile_definitions()å‘½ä»¤å‘ç›®æ ‡ï¼ˆhello_osï¼‰æ·»åŠ é¢„å®šä¹‰å®IS_LINUXã€IS_MACOSæˆ–è€…IS_WINDOWSï¼Œè¯¥å®åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å°†ç”Ÿæ•ˆã€‚ target_compile_definitionsä¼šå°†å°†å®šä¹‰é™åˆ¶äºä¸€ä¸ªç‰¹å®šçš„ç›®æ ‡ï¼Œä»¥åŠé€šè¿‡PRIVATE|PUBLIC|INTERFACEé™å®šç¬¦ï¼Œé™åˆ¶è¿™äº›å®šä¹‰å¯è§æ€§: PRIVATEï¼Œç¼–è¯‘å®šä¹‰å°†åªåº”ç”¨äºç»™å®šçš„ç›®æ ‡ï¼Œè€Œä¸åº”ç”¨äºç›¸å…³çš„å…¶ä»–ç›®æ ‡ã€‚ INTERFACEï¼Œå¯¹ç»™å®šç›®æ ‡çš„ç¼–è¯‘å®šä¹‰å°†åªåº”ç”¨äºä½¿ç”¨å®ƒçš„ç›®æ ‡ã€‚ PUBLICï¼Œç¼–è¯‘å®šä¹‰å°†åº”ç”¨äºç»™å®šçš„ç›®æ ‡å’Œä½¿ç”¨å®ƒçš„æ‰€æœ‰å…¶ä»–ç›®æ ‡ã€‚ å½“ç„¶ï¼Œåœ¨C++ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é¢„å®šä¹‰çš„å®æ¥è¯†åˆ«ä¸åŒçš„å¹³å°å’Œæ“ä½œç³»ç»Ÿã€‚è¿™äº›é¢„å®šä¹‰çš„å®æ˜¯ç”±ç¼–è¯‘å™¨æˆ–æ“ä½œç³»ç»Ÿæä¾›çš„ï¼Œå¯ä»¥åœ¨æºä»£ç ä¸­ä½¿ç”¨å®ƒä»¬æ¥ç¼–å†™å¹³å°ç›¸å…³çš„ä»£ç ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„å¹³å°è¯†åˆ«å®ï¼š __APPLE__ï¼šåœ¨è‹¹æœï¼ˆAppleï¼‰å¹³å°ï¼ˆä¾‹å¦‚ macOS å’Œ iOSï¼‰ä¸Šå®šä¹‰ã€‚ __linux__ï¼šåœ¨Linuxå¹³å°ä¸Šå®šä¹‰ã€‚ _WIN32ï¼šåœ¨32ä½Windowsæ“ä½œç³»ç»Ÿä¸Šå®šä¹‰ã€‚ _WIN64ï¼šåœ¨64ä½Windowsæ“ä½œç³»ç»Ÿä¸Šå®šä¹‰ã€‚ _MSC_VERï¼šåœ¨ä½¿ç”¨Microsoft Visual C++ç¼–è¯‘å™¨æ—¶å®šä¹‰ï¼Œè¡¨ç¤ºç¼–è¯‘å™¨çš„ç‰ˆæœ¬å·ã€‚ __GNUC__ï¼šåœ¨ä½¿ç”¨GNUç¼–è¯‘å™¨ï¼ˆä¾‹å¦‚g++ï¼‰æ—¶å®šä¹‰ï¼Œè¡¨ç¤ºç¼–è¯‘å™¨çš„ç‰ˆæœ¬å·ã€‚ hello_os.cpp #include \u003cstring\u003e #include \u003ciostream\u003e std::string HelloOS(); int main() { std::cout \u003c\u003c HelloOS() \u003c\u003c std::endl; return EXIT_SUCCESS; } std::string HelloOS() { #ifdef IS_WINDOWS return std::string(\"Hello from Windows!\"); #elif IS_LINUX return std::string(\"Hello from Linux!\"); #elif IS_MACOS return std::string(\"Hello from macOS!\"); #else return std::string(\"Hello from an unknown system!\"); #endif } Windowsç³»ç»Ÿä¸Šï¼Œå°†çœ‹åˆ°æ¥è‡ªWindowsçš„Helloã€‚å…¶ä»–æ“ä½œç³»ç»Ÿå°†äº§ç”Ÿä¸åŒçš„è¾“å‡ºã€‚ ","date":"2024-01-26","objectID":"/posts/cmake_note_11/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [11] æ£€æµ‹ç¯å¢ƒ","uri":"/posts/cmake_note_11/"},{"categories":["C++"],"content":"å››ã€æ£€æµ‹ä¸å¤„ç†å™¨ä½“ç³»ç»“æ„ 19ä¸–çºª70å¹´ä»£ï¼Œå‡ºç°çš„64ä½æ•´æ•°è¿ç®—å’Œæœ¬ä¸–çºªåˆå‡ºç°çš„ç”¨äºä¸ªäººè®¡ç®—æœºçš„64ä½å¯»å€ï¼Œæ‰©å¤§äº†å†…å­˜å¯»å€èŒƒå›´ï¼Œå¼€å‘å•†æŠ•å…¥äº†å¤§é‡èµ„æºæ¥ç§»æ¤ä¸º32ä½ä½“ç³»ç»“æ„ç¡¬ç¼–ç ï¼Œä»¥æ”¯æŒ64ä½å¯»å€ã€‚è™½ç„¶ï¼Œé¿å…æ˜¾å¼ç¡¬ç¼–ç çš„æ–¹å¼éå¸¸æ˜æ™ºï¼Œä½†éœ€è¦åœ¨ä½¿ç”¨CMakeé…ç½®çš„ä»£ç ä¸­é€‚åº”ç¡¬ç¼–ç é™åˆ¶ã€‚ é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter2/03 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(arch_dependent LANGUAGES CXX) add_executable( ${PROJECT_NAME} ${CMAKE_SOURCE_DIR}/arch_dependent.cpp ) # æ£€æŸ¥ç©ºæŒ‡é’ˆç±»å‹çš„å¤§å° if(CMAKE_SIZEOF_VOID_P EQUAL 8) target_compile_definitions( ${PROJECT_NAME} PUBLIC \"IS_64_BIT_ARCH\" ) message(STATUS \"Target is 64 bits\") else() target_compile_definitions( ${PROJECT_NAME} PUBLIC \"IS_32_BIT_ARCH\" ) message(STATUS \"Target is 32 bits\") endif() # é€šè¿‡å®šä¹‰ç›®æ ‡ç¼–è¯‘å®šä¹‰ï¼Œè®©é¢„å¤„ç†å™¨äº†è§£ä¸»æœºå¤„ç†å™¨æ¶æ„ if(CMAKE_HOST_SYSTEM_PROCESSOR MATCHES \"i386\") message(STATUS \"i386 architecture detected\") elseif(CMAKE_HOST_SYSTEM_PROCESSOR MATCHES \"i686\") message(STATUS \"i686 architecture detected\") elseif(CMAKE_HOST_SYSTEM_PROCESSOR MATCHES \"x86_64\") message(STATUS \"x86_64 architecture detected\") else() message(STATUS \"host processor architecture is unknown\") endif() target_compile_definitions( ${PROJECT_NAME} PUBLIC \"ARCHITECTURE=${CMAKE_HOST_SYSTEM_PROCESSOR}\" ) CMakeå®šä¹‰äº†CMAKE_HOST_SYSTEM_PROCESSORå˜é‡ï¼Œä»¥åŒ…å«å½“å‰è¿è¡Œçš„å¤„ç†å™¨çš„åç§°ã€‚å¯ä»¥è®¾ç½®ä¸ºi386ã€i686ã€x86_64ã€AMD64ç­‰ç­‰ï¼Œå½“ç„¶ï¼Œè¿™å–å†³äºå½“å‰çš„CPUã€‚ CMAKE_SIZEOF_VOID_Pä¸ºvoidæŒ‡é’ˆçš„å¤§å°ã€‚å¯ä»¥åœ¨CMakeé…ç½®æ—¶è¿›è¡ŒæŸ¥è¯¢ï¼Œä»¥ä¾¿ä¿®æ”¹ç›®æ ‡æˆ–ç›®æ ‡ç¼–è¯‘å®šä¹‰ã€‚å¯ä»¥åŸºäºæ£€æµ‹åˆ°çš„ä¸»æœºå¤„ç†å™¨ä½“ç³»ç»“æ„ï¼Œä½¿ç”¨é¢„å¤„ç†å™¨å®šä¹‰ï¼Œç¡®å®šéœ€è¦ç¼–è¯‘çš„åˆ†æ”¯æºä»£ç ã€‚ å½“ç„¶ï¼Œç¼–å†™æ–°ä»£ç æ—¶åº”è¯¥é¿å…è¿™ç§ä¾èµ–ï¼Œä½†åœ¨å¤„ç†é—ç•™ä»£ç æˆ–äº¤å‰ç¼–è¯‘æ—¶ï¼Œè¿™ç§ä¾èµ–æ˜¯æœ‰ç”¨çš„ã€‚ æ³¨æ„ï¼šä½¿ç”¨CMAKE_SIZEOF_VOID_Pæ˜¯æ£€æŸ¥å½“å‰CPUæ˜¯å¦å…·æœ‰32ä½æˆ–64ä½æ¶æ„çš„å”¯ä¸€â€œçœŸæ­£â€å¯ç§»æ¤çš„æ–¹æ³•ã€‚ arch_dependent.cpp #include \u003ccstdlib\u003e #include \u003ciostream\u003e #include \u003cstring\u003e #define STRINGIFY(x) #x #define TOSTRING(x) STRINGIFY(x) std::string ArchInfo(); int main() { std::cout \u003c\u003c ArchInfo() \u003c\u003c std::endl; return EXIT_SUCCESS; } std::string ArchInfo() { std::string arch_info(TOSTRING(ARCHITECTURE)); arch_info += std::string(\" architecture. \"); #ifdef IS_32_BIT_ARCH return arch_info + std::string(\"Compiled on a 32 bit host processor.\"); #elif IS_64_BIT_ARCH return arch_info + std::string(\"Compiled on a 64 bit host processor.\"); #else return arch_info + std::string(\"Neither 32 not 64 bit, puzzling ...\"); #endif } è¾“å‡ºç»“æœ mkdir build cd build cmake .. -- The CXX compiler identification is GNU 9.4.0 -- Check for working CXX compiler: /usr/bin/c++ -- Check for working CXX compiler: /usr/bin/c++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Target is 64 bits -- x86_64 architecture detected -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter2/03/build make Scanning dependencies of target arch_dependent [ 50%] Building CXX object CMakeFiles/arch_dependent.dir/arch_dependent.cpp.o [100%] Linking CXX executable arch_dependent [100%] Built target arch_dependent ./arch_dependent x86_64 architecture. Compiled on a 64 bit host processor. ","date":"2024-01-26","objectID":"/posts/cmake_note_11/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [11] æ£€æµ‹ç¯å¢ƒ","uri":"/posts/cmake_note_11/"},{"categories":["C++"],"content":"äº”ã€é™„å½• é™¤äº†CMAKE_HOST_SYSTEM_PROCESSOR, CMakeè¿˜å®šä¹‰äº†CMAKE_SYSTEM_PROCESSORå˜é‡ã€‚å‰è€…åŒ…å«å½“å‰è¿è¡Œçš„CPUåœ¨CMakeçš„åç§°ï¼Œè€Œåè€…å°†åŒ…å«å½“å‰æ­£åœ¨ä¸ºå…¶æ„å»ºçš„CPUçš„åç§°ã€‚è¿™æ˜¯ä¸€ä¸ªç»†å¾®çš„å·®åˆ«ï¼Œåœ¨äº¤å‰ç¼–è¯‘æ—¶èµ·ç€éå¸¸é‡è¦çš„ä½œç”¨ã€‚ å¦ä¸€ç§è®©CMakeæ£€æµ‹ä¸»æœºå¤„ç†å™¨ä½“ç³»ç»“æ„ï¼Œæ˜¯ä½¿ç”¨Cæˆ–C++ä¸­å®šä¹‰çš„ç¬¦å·ï¼Œç»“åˆCMakeçš„try_runå‡½æ•°: #if defined(__i386) || defined(__i386__) || defined(_M_IX86) #error cmake_arch i386 #elif defined(__x86_64) || defined(__x86_64__) || defined(__amd64) || defined(_M_X64) #error cmake_arch x86_64 #endif è¿™ç§ç­–ç•¥ä¹Ÿæ˜¯æ£€æµ‹ç›®æ ‡å¤„ç†å™¨ä½“ç³»ç»“æ„çš„æ¨èç­–ç•¥ï¼Œå› ä¸ºCMakeä¼¼ä¹æ²¡æœ‰æä¾›å¯ç§»æ¤çš„å†…åœ¨è§£å†³æ–¹æ¡ˆã€‚ å¦ä¸€ç§é€‰æ‹©ï¼Œå°†åªä½¿ç”¨CMakeï¼Œå®Œå…¨ä¸ä½¿ç”¨é¢„å¤„ç†å™¨ï¼Œä»£ä»·æ˜¯ä¸ºæ¯ç§æƒ…å†µè®¾ç½®ä¸åŒçš„æºæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨target_sourceå‘½ä»¤å°†å…¶è®¾ç½®ä¸ºå¯æ‰§è¡Œç›®æ ‡arch_dependentä¾èµ–çš„æºæ–‡ä»¶: add_executable(arch-dependent \"\") if(CMAKE_HOST_SYSTEM_PROCESSOR MATCHES \"i386\") message(STATUS \"i386 architecture detected\") target_sources(arch_dependent PRIVATE arch_dependent_i386.cpp ) elseif(CMAKE_HOST_SYSTEM_PROCESSOR MATCHES \"i686\") message(STATUS \"i686 architecture detected\") target_sources(arch_dependent PRIVATE arch_dependent_i686.cpp ) elseif(CMAKE_HOST_SYSTEM_PROCESSOR MATCHES \"x86_64\") message(STATUS \"x86_64 architecture detected\") target_sources(arch_dependent PRIVATE arch_dependent_x86_64.cpp ) else() message(STATUS \"host processor architecture is unknown\") endif() è¿™ç§æ–¹æ³•ï¼Œæ˜¾ç„¶éœ€è¦å¯¹ç°æœ‰é¡¹ç›®è¿›è¡Œæ›´å¤šçš„å·¥ä½œï¼Œå› ä¸ºæºæ–‡ä»¶éœ€è¦åˆ†ç¦»ã€‚æ­¤å¤–ï¼Œä¸åŒæºæ–‡ä»¶ä¹‹é—´çš„ä»£ç å¤åˆ¶è‚¯å®šä¹Ÿä¼šæˆä¸ºé—®é¢˜ã€‚ ","date":"2024-01-26","objectID":"/posts/cmake_note_11/:5:0","tags":["CMake"],"title":"CMake ç¬”è®° | [11] æ£€æµ‹ç¯å¢ƒ","uri":"/posts/cmake_note_11/"},{"categories":["C++"],"content":"å…­ã€æ£€æµ‹å¤„ç†å™¨æŒ‡ä»¤é›† CMakeå¯ä»¥æ£€æµ‹ä¸»æœºå¤„ç†å™¨æ”¯æŒçš„æŒ‡ä»¤é›†ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯è¾ƒæ–°ç‰ˆæœ¬æ·»åŠ åˆ°CMakeä¸­çš„ï¼Œéœ€è¦CMake 3.10æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚æ£€æµ‹åˆ°çš„ä¸»æœºç³»ç»Ÿä¿¡æ¯ï¼Œå¯ç”¨äºè®¾ç½®ç›¸åº”çš„ç¼–è¯‘å™¨æ ‡å¿—ï¼Œæˆ–å®ç°å¯é€‰çš„æºä»£ç ç¼–è¯‘ï¼Œæˆ–æ ¹æ®ä¸»æœºç³»ç»Ÿç”Ÿæˆæºä»£ç ã€‚ å°†ä½¿ç”¨config.h.inç”Ÿæˆconfig.hæ–‡ä»¶ã€‚config.h.inå¦‚ä¸‹: #ifndef CONFIG_HEADER_IN_H #define CONFIG_HEADER_IN_H #define NUMBER_OF_LOGICAL_CORES @_NUMBER_OF_LOGICAL_CORES@ #define NUMBER_OF_PHYSICAL_CORES @_NUMBER_OF_PHYSICAL_CORES@ #define TOTAL_VIRTUAL_MEMORY @_TOTAL_VIRTUAL_MEMORY@ #define AVAILABLE_VIRTUAL_MEMORY @_AVAILABLE_VIRTUAL_MEMORY@ #define TOTAL_PHYSICAL_MEMORY @_TOTAL_PHYSICAL_MEMORY@ #define AVAILABLE_PHYSICAL_MEMORY @_AVAILABLE_PHYSICAL_MEMORY@ #define IS_64BIT @_IS_64BIT@ #define HAS_FPU @_HAS_FPU@ #define HAS_MMX @_HAS_MMX@ #define HAS_MMX_PLUS @_HAS_MMX_PLUS@ #define HAS_SSE @_HAS_SSE@ #define HAS_SSE2 @_HAS_SSE2@ #define HAS_SSE_FP @_HAS_SSE_FP@ #define HAS_SSE_MMX @_HAS_SSE_MMX@ #define HAS_AMD_3DNOW @_HAS_AMD_3DNOW@ #define HAS_AMD_3DNOW_PLUS @_HAS_AMD_3DNOW_PLUS@ #define HAS_IA64 @_HAS_IA64@ #define OS_NAME \"@_OS_NAME@\" #define OS_RELEASE \"@_OS_RELEASE@\" #define OS_VERSION \"@_OS_VERSION@\" #define OS_PLATFORM \"@_OS_PLATFORM@\" #endif // ! CONFIG_HEADER_IN_H CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(progressor_info LANGUAGES CXX) add_executable(${PROJECT_NAME} \"\") target_sources(${PROJECT_NAME} PRIVATE ${CMAKE_SOURCE_DIR}/processor_info.cpp ) target_include_directories(${PROJECT_NAME} PRIVATE ${PROJECT_BINARY_DIR} ) foreach(key IN ITEMS NUMBER_OF_LOGICAL_CORES NUMBER_OF_PHYSICAL_CORES TOTAL_VIRTUAL_MEMORY AVAILABLE_VIRTUAL_MEMORY TOTAL_PHYSICAL_MEMORY AVAILABLE_PHYSICAL_MEMORY IS_64BIT HAS_FPU HAS_MMX HAS_MMX_PLUS HAS_SSE HAS_SSE2 HAS_SSE_FP HAS_SSE_MMX HAS_AMD_3DNOW HAS_AMD_3DNOW_PLUS HAS_IA64 OS_NAME OS_RELEASE OS_VERSION OS_PLATFORM ) cmake_host_system_information(RESULT _${key} QUERY ${key}) endforeach() configure_file(config.h.in config.h @ONLY) foreachå¾ªç¯ä¼šæŸ¥è¯¢å¤šä¸ªé”®å€¼ï¼Œå¹¶å®šä¹‰ç›¸åº”çš„å˜é‡ã€‚cmake_host_system_informationæŸ¥è¯¢è¿è¡ŒCMakeçš„ä¸»æœºç³»ç»Ÿçš„ç³»ç»Ÿä¿¡æ¯ã€‚æœ¬ä¾‹ä¸­ï¼Œå¯¹æ¯ä¸ªé”®ä½¿ç”¨äº†ä¸€ä¸ªå‡½æ•°è°ƒç”¨ã€‚ç„¶åï¼Œä½¿ç”¨è¿™äº›å˜é‡æ¥é…ç½®config.h.inä¸­çš„å ä½ç¬¦ï¼Œè¾“å…¥å¹¶ç”Ÿæˆconfig.hã€‚ æ­¤é…ç½®ä½¿ç”¨configure_fileå‘½ä»¤å®Œæˆã€‚æœ€åï¼Œconfig.håŒ…å«åœ¨processor_info.cppä¸­ã€‚ç¼–è¯‘åï¼Œå®ƒå°†æŠŠå€¼æ‰“å°åˆ°å±å¹•ä¸Šã€‚ target_include_directories(${PROJECT_NAME} PRIVATE ${PROJECT_BINARY_DIR} ) è¿™å°†ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶é“¾æ¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸­ã€‚ æˆ‘ä»¬ç¼–è¯‘åï¼Œconfig.hå°†äºbuildä¸­ç”Ÿæˆï¼Œåœ¨æœ¬æœºä¸­ç”Ÿæˆçš„å†…å®¹å¦‚ä¸‹ï¼š #ifndef CONFIG_HEADER_IN_H #define CONFIG_HEADER_IN_H #define NUMBER_OF_LOGICAL_CORES 16 #define NUMBER_OF_PHYSICAL_CORES 16 #define TOTAL_VIRTUAL_MEMORY 2047 #define AVAILABLE_VIRTUAL_MEMORY 2047 #define TOTAL_PHYSICAL_MEMORY 7903 #define AVAILABLE_PHYSICAL_MEMORY 6007 #define IS_64BIT 1 #define HAS_FPU 1 #define HAS_MMX 1 #define HAS_MMX_PLUS 0 #define HAS_SSE 1 #define HAS_SSE2 1 #define HAS_SSE_FP 0 #define HAS_SSE_MMX 0 #define HAS_AMD_3DNOW 0 #define HAS_AMD_3DNOW_PLUS 0 #define HAS_IA64 0 #define OS_NAME \"Linux\" #define OS_RELEASE \"5.15.0-78-generic\" #define OS_VERSION \"#85~20.04.1-Ubuntu SMP Mon Jul 17 09:42:39 UTC 2023\" #define OS_PLATFORM \"x86_64\" #endif // ! CONFIG_HEADER_IN_H processor_info.cpp #include \u003ccstdlib\u003e #include \u003ciostream\u003e #include \"config.h\" int main() { std::cout \u003c\u003c \"Number of logical cores: \" \u003c\u003c NUMBER_OF_LOGICAL_CORES \u003c\u003c std::endl; std::cout \u003c\u003c \"Number of physical cores: \" \u003c\u003c NUMBER_OF_PHYSICAL_CORES \u003c\u003c std::endl; std::cout \u003c\u003c \"Total virtual memory in megabytes: \" \u003c\u003c TOTAL_VIRTUAL_MEMORY \u003c\u003c std::endl; std::cout \u003c\u003c \"Available virtual memory in megabytes: \" \u003c\u003c AVAILABLE_VIRTUAL_MEMORY \u003c\u003c std::endl; std::cout \u003c\u003c \"Total physical memory in megabytes: \" \u003c\u003c TOTAL_PHYSICAL_MEMORY \u003c\u003c std::endl; std::cout \u003c\u003c \"Available physical memory in megabytes: \" \u003c\u003c AVAILABLE_PHYSICAL_MEMORY \u003c\u003c std::endl; std::cout \u003c\u003c \"Processor is 64Bit: \" \u003c\u003c IS_64BIT \u003c\u003c std::endl; std::cout \u003c\u003c \"Processor has floating point unit: \" \u003c\u003c HAS_FPU \u003c\u003c std::endl; std::cout \u003c\u003c \"Processor supports MMX instructions: \" \u003c\u003c HAS_MMX \u003c\u003c std::endl; std::cout \u003c\u003c \"Processor supports Ext. MMX instructions: \" \u003c\u003c HAS_MMX_PLUS \u003c\u003c std::endl; std::cout \u003c\u003c \"Processor supports SSE instructions: \" \u003c\u003c HAS_SSE \u003c\u003c std::endl; std::cout \u003c\u003c \"Processor supports SSE2 instructions: \" \u003c\u003c HAS_SSE2 \u003c\u003c std::endl; std::cout \u003c\u003c \"Processor ","date":"2024-01-26","objectID":"/posts/cmake_note_11/:6:0","tags":["CMake"],"title":"CMake ç¬”è®° | [11] æ£€æµ‹ç¯å¢ƒ","uri":"/posts/cmake_note_11/"},{"categories":["C++"],"content":"ä¸€ã€CMake:ä½¿ç”¨æ§åˆ¶æµ å¯¼è¨€ åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨è¿‡if-else-endifã€‚CMakeè¿˜æä¾›äº†åˆ›å»ºå¾ªç¯çš„è¯­è¨€å·¥å…·ï¼šforeach-endforeachå’Œwhile-endwhileã€‚ä¸¤è€…éƒ½å¯ä»¥ä¸breakç»“åˆä½¿ç”¨ï¼Œä»¥ä¾¿å°½æ—©ä»å¾ªç¯ä¸­è·³å‡ºã€‚è€Œæœ¬ç¯‡ä¹Ÿæ˜¯ä¸ºç¬¬ä¸€ç« çš„å®Œç»“ç¯‡ï¼Œç®—æ˜¯æ­£å¼çš„è¸å…¥äº†CMakeå­¦ä¹ çš„å¤§é—¨äº†ã€‚ ","date":"2024-01-25","objectID":"/posts/cmake_note_10/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [10] ä½¿ç”¨æ§åˆ¶æµ","uri":"/posts/cmake_note_10/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cal_add.h â”œâ”€â”€ cal_subtract.cpp â”œâ”€â”€ cal_subtract.h â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ main.cpp â”œâ”€â”€ message.cpp â””â”€â”€ message.h æœ¬é¡¹ç›®ç»“æ„å›å½’åˆ°äº†ç®€å•çš„ç»“æ„ï¼Œç›®çš„ä¸»è¦æ˜¯ä¸ºäº†å¿«é€Ÿå±•ç¤ºæœ¬ç¯‡çš„ä¸»æ—¨ï¼Œå³å¦‚ä½•ä½¿ç”¨æ§åˆ¶æµå®ç°ä¸€äº›åŠŸèƒ½ã€‚ é¡¹ç›®åœ°å€ï¼š https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter1/13 ","date":"2024-01-25","objectID":"/posts/cmake_note_10/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [10] ä½¿ç”¨æ§åˆ¶æµ","uri":"/posts/cmake_note_10/"},{"categories":["C++"],"content":"ä¸‰ã€CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(control-flow LANGUAGES CXX) set(CXX_STANDARD 11) add_library(test_lib STATIC ${CMAKE_SOURCE_DIR}/message.h ${CMAKE_SOURCE_DIR}/message.cpp ${CMAKE_SOURCE_DIR}/cal_add.h ${CMAKE_SOURCE_DIR}/cal_subtract.h ${CMAKE_SOURCE_DIR}/cal_subtract.cpp ) # ä½¿ç”¨-O3ç¼–è¯‘å™¨ä¼˜åŒ–çº§åˆ«ç¼–è¯‘åº“ï¼Œå¯¹ç›®æ ‡è®¾ç½®ä¸€ä¸ªç§æœ‰ç¼–è¯‘å™¨é€‰é¡¹ target_compile_options(test_lib PRIVATE -O3) # ç”Ÿæˆä¸€ä¸ªæºæ–‡ä»¶åˆ—è¡¨ï¼Œä»¥è¾ƒä½çš„ä¼˜åŒ–é€‰é¡¹è¿›è¡Œç¼–è¯‘ list(APPEND sources_with_lower_optimization cal_subtract.cpp ) # å¾ªç¯è¿™äº›æºæ–‡ä»¶ï¼Œå°†å®ƒä»¬çš„ä¼˜åŒ–çº§åˆ«è°ƒåˆ°-O2ã€‚ä½¿ç”¨å®ƒä»¬çš„æºæ–‡ä»¶å±æ€§å®Œæˆ message(STATUS \"Setting source properties using IN LISTS syntax:\") foreach(_source IN LISTS sources_with_lower_optimization) set_source_files_properties(${_source} PROPERTIES COMPILE_FLAGS -O2) message(STATUS \"Appending -O2 flag for ${_source}\") endforeach() # ä¸ºäº†ç¡®ä¿è®¾ç½®å±æ€§ï¼Œå†æ¬¡å¾ªç¯å¹¶åœ¨æ‰“å°æ¯ä¸ªæºæ–‡ä»¶çš„COMPILE_FLAGSå±æ€§ message(STATUS \"Querying sources properties using plain syntax:\") foreach(_source ${sources_with_lower_optimization}) get_source_file_property(_flags ${_source} COMPILE_FLAGS) message(STATUS \"Source ${_source} has the following extra COMPILE_FLAGS: ${_flags}\") endforeach() add_executable(${PROJECT_NAME} main.cpp) target_link_libraries(${PROJECT_NAME} test_lib) set_source_files_properties(file PROPERTIES property value) å°†å±æ€§è®¾ç½®ä¸ºç»™å®šæ–‡ä»¶çš„ä¼ é€’å€¼ã€‚ä¸ç›®æ ‡éå¸¸ç›¸ä¼¼ï¼Œæ–‡ä»¶åœ¨CMakeä¸­ä¹Ÿæœ‰å±æ€§ï¼Œå…è®¸å¯¹æ„å»ºç³»ç»Ÿè¿›è¡Œéå¸¸ç»†ç²’åº¦çš„æ§åˆ¶ã€‚ Tip get_source_file_property(VAR file property) æ£€ç´¢ç»™å®šæ–‡ä»¶æ‰€éœ€å±æ€§çš„å€¼ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨CMakeVARå˜é‡ä¸­ã€‚ æ³¨æ„ï¼šCMakeä¸­ï¼Œåˆ—è¡¨æ˜¯ç”¨åˆ†å·åˆ†éš”çš„å­—ç¬¦ä¸²ç»„ã€‚åˆ—è¡¨å¯ä»¥ç”±listæˆ–setå‘½ä»¤åˆ›å»ºã€‚ä¾‹å¦‚ï¼Œset(var a b c d e)å’Œlist(APPEND a b c d e)éƒ½åˆ›å»ºäº†åˆ—è¡¨a;b;c;d;eã€‚ å¼•ç”¨ foreach(loop_var range total) or foreach(loop_var range start stop [step]) é€šè¿‡æŒ‡å®šä¸€ä¸ªèŒƒå›´ï¼Œå¯ä»¥å¯¹æ•´æ•°è¿›è¡Œå¾ªç¯ âœ¦ ","date":"2024-01-25","objectID":"/posts/cmake_note_10/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [10] ä½¿ç”¨æ§åˆ¶æµ","uri":"/posts/cmake_note_10/"},{"categories":["C++"],"content":"å››ã€ç›¸å…³æºç  cal_add.h #ifndef CALCULATE_ADD_HEADER #define CALCULATE_ADD_HEADER template \u003ctypename T, typename U\u003e auto Add(T t, U u) -\u003e decltype(t + u){ return t + u; } #endif // ! CALCULATE_ADD_HEADER cal_substruct.h #ifndef CALCULATE_SUBSTRACT_HEADER #define CALCULATE_SUBSTRACT_HEADER float Substract(float a, float b); #endif // ! CALCULATE_SUBSTRACT_HEADER cal_substruct.cpp float Substract(float a, float b) { return a - b; } message.h #ifndef MESSAGE_HEADER_H_ #define MESSAGE_HEADER_H_ #include \u003cstring\u003e class Message { public: Message() {} void Print(const std::string\u0026 message); }; #endif // ! MESSAGE_HEADER_H_ message.cpp #include \"message.h\" #include \u003ciostream\u003e void Message::Print(const std::string\u0026 message) { std::cout \u003c\u003c message \u003c\u003c std::endl; } main.cpp #include \"message.h\" #include \"cal_add.h\" #include \"cal_subtract.h\" int main() { int a = 1; int b = 2; auto c = Add(a , b); Message message; message.Print(std::to_string(c)); return 0; } ","date":"2024-01-25","objectID":"/posts/cmake_note_10/:4:0","tags":["CMake"],"title":"CMake ç¬”è®° | [10] ä½¿ç”¨æ§åˆ¶æµ","uri":"/posts/cmake_note_10/"},{"categories":["C++"],"content":"äº”ã€ç¼–è¯‘ç»“æœ -- The CXX compiler identification is GNU 9.4.0 -- Check for working CXX compiler: /usr/bin/c++ -- Check for working CXX compiler: /usr/bin/c++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Setting source properties using IN LISTS syntax: -- Appending -O2 flag for cal_add.cpp -- Appending -O2 flag for cal_subtract.cpp -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/13/build ","date":"2024-01-25","objectID":"/posts/cmake_note_10/:5:0","tags":["CMake"],"title":"CMake ç¬”è®° | [10] ä½¿ç”¨æ§åˆ¶æµ","uri":"/posts/cmake_note_10/"},{"categories":["C++"],"content":"äº”ã€é™„å½• foreach()çš„å››ç§ä½¿ç”¨æ–¹å¼: foreach(loop_var arg1 arg2 ...): å…¶ä¸­æä¾›å¾ªç¯å˜é‡å’Œæ˜¾å¼é¡¹åˆ—è¡¨ã€‚å½“ä¸ºsources_with_lower_optimizationä¸­çš„é¡¹æ‰“å°ç¼–è¯‘å™¨æ ‡å¿—é›†æ—¶ï¼Œä½¿ç”¨æ­¤è¡¨å•ã€‚æ³¨æ„ï¼Œå¦‚æœé¡¹ç›®åˆ—è¡¨ä½äºå˜é‡ä¸­ï¼Œåˆ™å¿…é¡»æ˜¾å¼å±•å¼€å®ƒï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œ${sources_with_lower_optimization}å¿…é¡»ä½œä¸ºå‚æ•°ä¼ é€’ã€‚ é€šè¿‡æŒ‡å®šä¸€ä¸ªèŒƒå›´ï¼Œå¯ä»¥å¯¹æ•´æ•°è¿›è¡Œå¾ªç¯ï¼Œä¾‹å¦‚ï¼šforeach(loop_var range total)æˆ–foreach(loop_var range start stop [step])ã€‚ å¯¹åˆ—è¡¨å€¼å˜é‡çš„å¾ªç¯ï¼Œä¾‹å¦‚ï¼šforeach(loop_var IN LISTS [list1[...]]) ã€‚å‚æ•°è§£é‡Šä¸ºåˆ—è¡¨ï¼Œå…¶å†…å®¹å°±ä¼šè‡ªåŠ¨å±•å¼€ã€‚ å¯¹å˜é‡çš„å¾ªç¯ï¼Œä¾‹å¦‚ï¼šforeach(loop_var IN ITEMS [item1 [...]])ã€‚å‚æ•°çš„å†…å®¹æ²¡æœ‰å±•å¼€ã€‚ ","date":"2024-01-25","objectID":"/posts/cmake_note_10/:6:0","tags":["CMake"],"title":"CMake ç¬”è®° | [10] ä½¿ç”¨æ§åˆ¶æµ","uri":"/posts/cmake_note_10/"},{"categories":["C++"],"content":"cmakeå¸¸ç”¨å‘½ä»¤çš„ä¸€äº›æ•´ç† CMake æ˜¯ä»€ä¹ˆæˆ‘å°±ä¸ç”¨å†å¤šè¯´ä»€ä¹ˆäº†ï¼Œç›¸ä¿¡å¤§å®¶éƒ½æœ‰æ¥è§¦æ‰ä¼šçœ‹ä¸€ç¯‡æ–‡ç« ã€‚å¯¹äºä¸å¤ªç†Ÿæ‚‰çš„å¼€å‘äººå‘˜å¯ä»¥æŠŠè¿™ç¯‡æ–‡ç« å½“ä¸ªæŸ¥æ‰¾æ‰‹å†Œã€‚ ","date":"2024-01-24","objectID":"/posts/commandcollection/:0:0","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.CMakeè¯­æ³• ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:0","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.1 æŒ‡å®šcmakeçš„æœ€å°ç‰ˆæœ¬ cmake_minimum_required(version ç‰ˆæœ¬å·) ä¾‹å¦‚ï¼š cmake_minimum_required(version 2.8) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:1","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.2 å®šä¹‰å·¥ç¨‹åç§° #å®šä¹‰å·¥ç¨‹åç§° project(é¡¹ç›®åç§°) ä¾‹å¦‚ï¼š project(MyTest) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:2","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.3 æ˜¾ç¤ºå®šä¹‰å˜é‡ set(var [value]) ä¾‹å¦‚ï¼š # ç¬¬ä¸€ç§ç”¨æ³•ï¼Œç”Ÿæˆä»£ç æ–‡ä»¶åˆ—è¡¨ #å…ˆç›´æ¥è®¾ç½®SRC_LISTçš„å€¼ set(SRC_LIST add.h add.cpp) #ç„¶åå†åœ¨SRC_LISTä¸­è¿½åŠ main.cpp set(SRC_LIST ${SRC_LIST} main.cpp) # ç¬¬äºŒç§ç”¨æ³•ï¼Œè®¾ç½®åº“ç”Ÿæˆç›®å½•æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ç”Ÿæˆç›®å½• set(LIBRARY_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/lib/linux) set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:3","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.4 è®¾ç½®ç¼–è¯‘ç±»å‹ # ç¼–è¯‘é™æ€åº“ add_library(åº“åç§° STATIC ä»£ç æ–‡ä»¶åç§°) # ç¼–è¯‘åŠ¨æ€åº“ add_library(åº“åç§° SHARED ä»£ç æ–‡ä»¶åç§°) # ç¼–è¯‘å¯æ‰§è¡Œç¨‹åº add_executable(å¯æ‰§è¡Œç¨‹åºå ä»£ç æ–‡ä»¶åç§°) ä¾‹å¦‚ï¼š # æŠŠ`.cpp`ã€`.h`æ–‡ä»¶ç¼–è¯‘æˆé™æ€åº“ add_library(add STATIC add.h add.cpp) add_library(add STATIC ${ADD_SRC} ${ADD_HDR}) # æŠŠ`.cpp`ã€`.h`æ–‡ä»¶ç¼–è¯‘æˆåŠ¨æ€åº“ add_library(add SHARED add.h add.cpp) add_library(add SHARED ${ADD_SRC} ${ADD_HDR}) # ç¼–è¯‘å¯æ‰§è¡Œç¨‹åº add_executable(main add.h add.cpp mai.cpp) add_executable(main ${MAIN_SRC} ${MAIN_HDR}) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:4","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.5 æŒ‡å®šé™æ€åº“æˆ–è€…åŠ¨æ€åº“ç¼–è¯‘è¾“å‡ºç›®å½• ä¾‹å¦‚å°†å½“å‰ç¼–è¯‘çš„é™æ€åº“æˆ–è€…åŠ¨æ€åº“è¾“å‡ºåˆ°å½“å‰é¡¹ç›®æ–‡ä»¶å¤¹libå­ç›®å½•ä¸‹ // cmakeä¸­`LIBRARY_OUTPUT_PATH`å˜é‡ä¸ºåº“æ–‡ä»¶è¾“å‡ºè·¯å¾„ set(LIBRARY_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/lib) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:5","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.6 æŒ‡å®šå¯æ‰§è¡Œç¨‹åºç¼–è¯‘è¾“å‡ºç›®å½• ä¾‹å¦‚å°†å½“å‰å¯æ‰§è¡Œç¨‹åºè¾“å‡ºåˆ°å½“å‰é¡¹ç›®æ–‡ä»¶å¤¹çš„binå­ç›®å½•ä¸‹ // è®¾å®šå¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç›®å½• set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:6","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.7 è®¾ç½®é“¾æ¥åº“æœç´¢ç›®å½• ä¾‹å¦‚å°†é“¾æ¥åº“æœç´¢ç›®å½•è®¾ç½®ä¸ºå½“å‰é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹lib/linuxæ–‡ä»¶å¤¹ // ${PROJECT_SOURCE_DIR} ä¸ºå½“å‰é¡¹ç›®æ–‡ä»¶å¤¹ link_directories(${PROJECT_SOURCE_DIR}/lib/linux) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:7","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.8 è®¾ç½®åŒ…å«ç›®å½• ä¾‹å¦‚å°†åŒ…å«ç›®å½•è®¾ç½®ä¸ºå½“å‰é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹includeæ–‡ä»¶å¤¹ include_directories(${PROJECT_SOURCE_DIR}/include) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:8","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.9 è®¾ç½®å®å®šä¹‰ #é¢„å®šä¹‰å® add_definitions(-Då®åç§°) ä¾‹å¦‚ï¼š add_definitions(-DWINDOWS) add_definitions(-DLINUX) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:9","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.10 é“¾æ¥é™æ€åº“ link_libraries( é™æ€åº“1 é™æ€åº“2 é™æ€åº“3 ... ) tips: link_libraries å’Œ target_link_libraries é“¾æ¥åº“ æ³¨æ„: link_librariesä¸­çš„é™æ€åº“ä¸ºå…¨è·¯å¾„ï¼Œå¸¸ä¸1.7 link_directories æ­é…ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š lib1.a, lib2.aåœ¨ç›®å½•${PROJECT_SOURCE_DIR}/lib/linuxä¸‹ï¼Œåˆ™å…ˆè®¾ç½®é“¾æ¥ç›®å½•ï¼Œå†é“¾æ¥ç›¸åº”çš„åº“ #è®¾ç½®é“¾æ¥ç›®å½• link_directories(${PROJECT_SOURCE_DIR}/lib/linux) # é“¾æ¥ç›¸åº”çš„åº“ link_libraries( lib1.a lib2.a ) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:10","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.11 é“¾æ¥åŠ¨æ€åº“ target_link_libraries(æ‰€éœ€ç”Ÿæˆçš„æ–‡ä»¶åç§° æ‰€éœ€é“¾æ¥çš„åŠ¨æ€åº“åç§°) ä¾‹å¦‚ target_link_libraries(main dl) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:11","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.12 link_libraries å’Œ target_link_libraries åŒºåˆ« åœ¨cmakeè¯­æ³•ä¸­ï¼Œlink_librarieså’Œtarget_link_librariesæ˜¯å¾ˆé‡è¦çš„ä¸¤ä¸ªé“¾æ¥åº“çš„æ–¹å¼ï¼Œè™½ç„¶å†™æ³•ä¸Šå¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯åŠŸèƒ½ä¸Šæœ‰å¾ˆå¤§åŒºåˆ«ï¼š æ³¨æ„ (1) link_librariesç”¨åœ¨add_executableä¹‹å‰ï¼Œtarget_link_librariesç”¨åœ¨add_executableä¹‹å (2) link_librariesç”¨æ¥é“¾æ¥é™æ€åº“ï¼Œtarget_link_librariesç”¨æ¥é“¾æ¥å¯¼å…¥åº“ï¼Œå³æŒ‰ç…§header file + .lib + .dllæ–¹å¼éšå¼è°ƒç”¨åŠ¨æ€åº“çš„.libåº“ æ³¨æ„: windowsç³»ç»Ÿä¸‹ï¼Œé™æ€åº“åç¼€ä¸º.lib, å¯¼å…¥åº“çš„åç¼€ä¸º.libï¼ŒåŠ¨æ€åº“çš„åç¼€ä¸º.dll linuxç³»ç»Ÿå†™ï¼Œé™æ€åº“åç¼€ä¸º.a, åŠ¨æ€åº“çš„åç¼€ä¸º.so ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:12","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.13 fileè¯­æ³• 1.13.1 å°†æ–‡ä»¶å¤¹æ‰€æœ‰çš„ç±»å‹çš„æ–‡ä»¶æ·»åŠ åˆ°æ–‡ä»¶åˆ—è¡¨ ä¾‹å¦‚å°†å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰.cppæ–‡ä»¶çš„æ–‡ä»¶ååŠ å…¥åˆ°MAIN_SRCä¸­ï¼Œå°†å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰.håŠ å…¥åˆ°MAIN_HDRä¸­ã€‚ file(GLOB MAIN_SRC ${CMAKE_CURRENT_SOURCE_DIR}/*.cpp) file(GLOB MAIN_HDR ${CMAKE_CURRENT_SOURCE_DIR}/*.h) ä¾‹å¦‚å°†å½“å‰æ–‡ä»¶å¤¹å­ç›®å½•srcæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰.cppæ–‡ä»¶çš„æ–‡ä»¶ååŠ å…¥åˆ°MAIN_SRCä¸­ï¼Œå°†å½“å‰æ–‡ä»¶å¤¹å­ç›®å½•srcæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰.håŠ å…¥åˆ°MAIN_HDRä¸­ã€‚ file(GLOB MAIN_SRC ${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp) file(GLOB MAIN_HDR ${CMAKE_CURRENT_SOURCE_DIR}/src/*.h) 1.13.2 é€’å½’æœç´¢è¯¥æ–‡ä»¶å¤¹ï¼Œå°†æ–‡ä»¶å¤¹ä¸‹ï¼ˆåŒ…å«å­ç›®å½•ï¼‰ç¬¦åˆç±»å‹çš„æ–‡ä»¶æ·»åŠ åˆ°æ–‡ä»¶åˆ—è¡¨ ä¾‹å¦‚å°†å½“å‰æ–‡ä»¶å¤¹ä¸‹ï¼ˆåŒ…æ‹¬å­ç›®å½•ä¸‹ï¼‰æ‰€æœ‰.cppæ–‡ä»¶çš„æ–‡ä»¶ååŠ å…¥åˆ°MAIN_SRCä¸­ï¼Œæ‰€æœ‰.håŠ å…¥åˆ°MAIN_HDRä¸­ file(GLOB_RECURSE MAIN_SRC ${CMAKE_CURRENT_SOURCE_DIR}/*.cpp) file(GLOB_RECURSE MAIN_HDR ${CMAKE_CURRENT_SOURCE_DIR}/*.h) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:13","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.14 Listæ“ä½œ å¸¸è§çš„Listæ“ä½œåŒ…æ‹¬ï¼š list(LENGTH \u003clist\u003e \u003coutput variable\u003e) list(GET \u003clist\u003e \u003celement index\u003e [\u003celement index\u003e ...] \u003coutput variable\u003e) list(APPEND \u003clist\u003e [\u003celement\u003e ...]) list(FIND \u003clist\u003e \u003cvalue\u003e \u003coutput variable\u003e) list(INSERT \u003clist\u003e \u003celement_index\u003e \u003celement\u003e [\u003celement\u003e ...]) list(REMOVE_ITEM \u003clist\u003e \u003cvalue\u003e [\u003cvalue\u003e ...]) list(REMOVE_AT \u003clist\u003e \u003cindex\u003e [\u003cindex\u003e ...]) list(REMOVE_DUPLICATES \u003clist\u003e) list(REVERSE \u003clist\u003e) list(SORT \u003clist\u003e) 1.14.1 Listç§»é™¤æŒ‡å®šé¡¹ ä¾‹å¦‚ä»MAIN_SRCç§»é™¤æŒ‡å®šé¡¹ list(REMOVE_ITEM MAIN_SRC ${CMAKE_CURRENT_SOURCE_DIR}/add.cpp) 1.14.2 å°†ä¸¤ä¸ªListé“¾æ¥èµ·æ¥ # æœç´¢å½“å‰ç›®å½• file(GLOB MAIN_SRC ${CMAKE_CURRENT_SOURCE_DIR}/*.cpp) file(GLOB MAIN_HDR ${CMAKE_CURRENT_SOURCE_DIR}/*.h) # é€’å½’æœç´¢å½“å‰ç›®å½•ä¸‹srcå­ç›®å½• file(GLOB_RECURSE MAIN_SRC_ELSE ${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp) file(GLOB_RECURSE MAIN_HDR_ELSE ${CMAKE_CURRENT_SOURCE_DIR}/src/*.h) # å°†MAIN_SRC_ELSEä¸­çš„å€¼æ·»åŠ åˆ°MAIN_SRC # å°†MAIN_HDR_ELSEä¸­çš„å€¼æ·»åŠ åˆ°MAIN_HDR list(APPEND MAIN_SRC ${MAIN_SRC_ELSE}) list(APPEND MAIN_HDR ${MAIN_HDR_ELSE}) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:14","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.15 æ·»åŠ å­æ–‡ä»¶å¤¹ ä¾‹å¦‚ add_subdirectory(src) è¯¥è¯­å¥ä¼šåœ¨æ‰§è¡Œå®Œå½“å‰æ–‡ä»¶å¤¹CMakeLists.txtä¹‹åæ‰§è¡Œsrcå­ç›®å½•ä¸‹çš„CMakeLists.txtã€‚ ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:15","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.16 messageè¾“å‡ºæ¶ˆæ¯æœºåˆ¶ è¾“å‡ºæ­£å¸¸ï¼š message(STATUS \"Enter cmake ${CMAKE_CURRENT_LIST_DIR}\") è¾“å‡ºè­¦å‘Š message(WARNING \"Enter cmake ${CMAKE_CURRENT_LIST_DIR}\") è¾“å‡ºé”™è¯¯ï¼š message(FATAL_ERROR \"Enter cmake ${CMAKE_CURRENT_LIST_DIR}\") ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:16","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.17 å®‰è£… install() install æŒ‡ä»¤ç”¨äºå®šä¹‰å®‰è£…è§„åˆ™ï¼Œå®‰è£…çš„å†…å®¹åŒ…æ‹¬äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ã€åŠ¨æ€åº“ã€é™æ€åº“ä»¥åŠæ–‡ä»¶ã€ç›®å½•ã€è„šæœ¬ç­‰ã€‚ 1.17.1 ç›®æ ‡æ–‡ä»¶å®‰è£… ä¾‹å¦‚ï¼š install(TARGETS util RUNTIME DESTINATION bin LIBRARY DESTINATION lib ARCHIVE DESTINATION lib) ARCHIVEæŒ‡é™æ€åº“ï¼ŒLIBRARYæŒ‡åŠ¨æ€åº“ï¼ŒRUNTIMEæŒ‡å¯æ‰§è¡Œç›®æ ‡äºŒè¿›åˆ¶ï¼Œä¸Šè¿°ç¤ºä¾‹çš„æ„æ€æ˜¯ï¼š å¦‚æœç›®æ ‡utilæ˜¯å¯æ‰§è¡ŒäºŒè¿›åˆ¶ç›®æ ‡ï¼Œåˆ™å®‰è£…åˆ°${CMAKE_INSTALL_PREFIX}/binç›®å½• å¦‚æœç›®æ ‡utilæ˜¯é™æ€åº“ï¼Œåˆ™å®‰è£…åˆ°å®‰è£…åˆ°${CMAKE_INSTALL_PREFIX}/libç›®å½• å¦‚æœç›®æ ‡utilæ˜¯åŠ¨æ€åº“ï¼Œåˆ™å®‰è£…åˆ°å®‰è£…åˆ°${CMAKE_INSTALL_PREFIX}/libç›®å½• 1.17.2 æ–‡ä»¶å¤¹å®‰è£… install(DIRECTORY include/ DESTINATION include/util) è¿™ä¸ªè¯­å¥çš„æ„æ€æ˜¯å°†include/ç›®å½•å®‰è£…åˆ°include/utilç›®å½• ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:17","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.18 è®¾ç½®ç¼–è¯‘é€‰é¡¹ è®¾ç½®ç¼–è¯‘é€‰é¡¹å¯ä»¥é€šè¿‡add_compile_optionså‘½ä»¤ï¼Œä¹Ÿå¯ä»¥é€šè¿‡setå‘½ä»¤ä¿®æ”¹CMAKE_CXX_FLAGSæˆ–CMAKE_C_FLAGSã€‚ æ–¹å¼1 set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=c++11 -march=native -O3 -frtti -fpermissive -fexceptions -pthread\") æ–¹å¼2 add_compile_options(-march=native -O3 -fexceptions -pthread -fPIC) è¿™ä¸¤ç§æ–¹å¼çš„åŒºåˆ«åœ¨äºï¼š add_compile_optionså‘½ä»¤æ·»åŠ çš„ç¼–è¯‘é€‰é¡¹æ˜¯é’ˆå¯¹æ‰€æœ‰ç¼–è¯‘å™¨çš„(åŒ…æ‹¬cå’Œc++ç¼–è¯‘å™¨)ï¼Œè€Œsetå‘½ä»¤è®¾ç½®CMAKE_C_FLAGSæˆ–CMAKE_CXX_FLAGSå˜é‡åˆ™æ˜¯åˆ†åˆ«åªé’ˆå¯¹cå’Œc++ç¼–è¯‘å™¨çš„ã€‚ ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:18","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.19 é¢„å®šä¹‰å˜é‡ 1.19.1 åŸºæœ¬å˜é‡ PROJECT_SOURCE_DIRâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“æˆ‘ä»¬ä½¿ç”¨cmakeå‘½ä»¤åç´§è·Ÿçš„ç›®å½•ï¼Œä¸€èˆ¬æ˜¯å·¥ç¨‹çš„æ ¹ç›®å½•ï¼› PROJECT_BINARY_DIR â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”æ‰§è¡Œcmakeå‘½ä»¤çš„ç›®å½•,é€šå¸¸æ˜¯${PROJECT_SOURCE_DIR}/buildï¼› CMAKE_INCLUDE_PATHâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ç³»ç»Ÿç¯å¢ƒå˜é‡,écmakeå˜é‡ï¼› CMAKE_LIBRARY_PATHâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç³»ç»Ÿç¯å¢ƒå˜é‡,écmakeå˜é‡ï¼› CMAKE_CURRENT_SOURCE_DIRâ€”â€”â€”â€”â€”â€”â€”â€”â€”å½“å‰å¤„ç†çš„CMakeLists.txtæ‰€åœ¨çš„è·¯å¾„ï¼› CMAKE_CURRENT_BINARY_DIRâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€“targetç¼–è¯‘ç›®å½•ï¼ˆä½¿ç”¨ADD_SURDIRECTORY(src bin)å¯ä»¥æ›´æ”¹æ­¤å˜é‡çš„å€¼ ï¼ŒSET(EXECUTABLE_OUTPUT_PATH \u003cæ–°è·¯å¾„\u003e)å¹¶ä¸ä¼šå¯¹æ­¤å˜é‡æœ‰å½±å“,åªæ˜¯æ”¹å˜äº†æœ€ç»ˆç›®æ ‡æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼‰ï¼› CMAKE_CURRENT_LIST_FILEâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“è¾“å‡ºè°ƒç”¨è¿™ä¸ªå˜é‡çš„CMakeLists.txtçš„å®Œæ•´è·¯å¾„ï¼› CMAKE_CURRENT_LIST_LINEâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“è¾“å‡ºè¿™ä¸ªå˜é‡æ‰€åœ¨çš„è¡Œï¼› CMAKE_MODULE_PATHâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“å®šä¹‰è‡ªå·±çš„cmakeæ¨¡å—æ‰€åœ¨çš„è·¯å¾„ï¼ˆè¿™ä¸ªå˜é‡ç”¨äºå®šä¹‰è‡ªå·±çš„cmakeæ¨¡å—æ‰€åœ¨çš„è·¯å¾„ï¼Œå¦‚æœä½ çš„å·¥ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæœ‰å¯èƒ½è‡ªå·±ç¼–å†™ä¸€äº›cmakeæ¨¡å—ï¼Œæ¯”å¦‚SET(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/cmake),ç„¶åå¯ä»¥ç”¨INCLUDEå‘½ä»¤æ¥è°ƒç”¨è‡ªå·±çš„æ¨¡å—ï¼‰ï¼› EXECUTABLE_OUTPUT_PATHâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”é‡æ–°å®šä¹‰ç›®æ ‡äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼› LIBRARY_OUTPUT_PATHâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“é‡æ–°å®šä¹‰ç›®æ ‡é“¾æ¥åº“æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼› PROJECT_NAMEâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-è¿”å›é€šè¿‡PROJECTæŒ‡ä»¤å®šä¹‰çš„é¡¹ç›®åç§°ï¼› CMAKE_ALLOW_LOOSE_LOOP_CONSTRUCTSâ€”ç”¨æ¥æ§åˆ¶IF ELSEè¯­å¥çš„ä¹¦å†™æ–¹å¼ï¼› ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:19","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.19.2 æ“ä½œç³»ç»Ÿå˜é‡ CMAKE_MAJOR_VERSIONâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€“cmakeä¸»ç‰ˆæœ¬å·,å¦‚3.4.1ä¸­çš„3ï¼› CMAKE_MINOR_VERSIONâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€“cmakeæ¬¡ç‰ˆæœ¬å·,å¦‚3.4.1ä¸­çš„4ï¼› CMAKE_PATCH_VERSIONâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€“cmakeè¡¥ä¸ç­‰çº§,å¦‚3.4.1ä¸­çš„1ï¼› CMAKE_SYSTEMâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-æ“ä½œç³»ç»Ÿåç§°ï¼ŒåŒ…æ‹¬ç‰ˆæœ¬åï¼Œå¦‚Linux-2.6.22ï¼› CAMKE_SYSTEM_NAMEâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-æ“ä½œç³»ç»Ÿåç§°ï¼Œä¸åŒ…æ‹¬ç‰ˆæœ¬åï¼Œå¦‚Linuxï¼› CMAKE_SYSTEM_VERSIONâ€”â€”â€”â€”â€”â€”â€”â€”â€“æ“ä½œç³»ç»Ÿç‰ˆæœ¬å·,å¦‚2.6.22ï¼› CMAKE_SYSTEM_PROCESSORâ€”â€”â€”â€”â€”â€”â€“ç”µè„‘å¤„ç†å™¨åç§°ï¼Œå¦‚i686ï¼› UNIXâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“åœ¨æ‰€æœ‰çš„ç±»UNIXå¹³å°ä¸ºTRUE,åŒ…æ‹¬OS Xå’Œcygwinï¼ŒLinux/Unixæ“ä½œç³»ç»Ÿï¼› WIN32â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“åœ¨æ‰€æœ‰çš„win32å¹³å°ä¸ºTRUE,åŒ…æ‹¬cygwinï¼ŒWindowsæ“ä½œç³»ç»Ÿï¼› APPLEâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-è‹¹æœæ“ä½œç³»ç»Ÿï¼› ä¾‹å¦‚æ“ä½œç³»ç»Ÿåˆ¤æ–­æ–¹å¼ä¸€ï¼š if(WIN32) message(STATUS â€œThis operating system is Windows.â€) elseif(UNIX) message(STATUS â€œThis operating system is Linux.â€) elseif(APPLE) message(STATUS â€œThis operating system is APPLE.â€) endif(WIN32) æ“ä½œç³»ç»Ÿåˆ¤æ–­æ–¹å¼äºŒï¼š if (CMAKE_SYSTEM_NAME MATCHES \"Linux** message(STATUS \"current platform: Linux \") elseif (CMAKE_SYSTEM_NAME MATCHES \"Windows\") message(STATUS \"current platform: Windows\") elseif (CMAKE_SYSTEM_NAME MATCHES \"FreeBSD\") message(STATUS \"current platform: FreeBSD\") else () message(STATUS \"other platform: ${CMAKE_SYSTEM_NAME}\") endif (CMAKE_SYSTEM_NAME MATCHES \"Linux\") ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:20","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.19.3 å¼€å…³é€‰é¡¹ BUILD_SHARED_LIBSâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”æ§åˆ¶é»˜è®¤çš„åº“ç¼–è¯‘æ–¹å¼ã€‚å¦‚æœæœªè¿›è¡Œè®¾ç½®,ä½¿ç”¨ADD_LIBRARYæ—¶åˆæ²¡æœ‰æŒ‡å®šåº“ç±»å‹,é»˜è®¤ç¼–è¯‘ç”Ÿæˆçš„åº“éƒ½æ˜¯é™æ€åº“ï¼› CMAKE_C_FLAGSâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-è®¾ç½®Cç¼–è¯‘é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡ä»¤ADD_DEFINITIONS()æ·»åŠ ï¼› CMAKE_CXX_FLAGSâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-è®¾ç½®C++ç¼–è¯‘é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡ä»¤ADD_DEFINITIONS()æ·»åŠ ï¼› CMAKE_C_COMPILERâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“æŒ‡å®šCç¼–è¯‘å™¨ï¼› CMAKE_CXX_COMPILERâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-æŒ‡å®šC++ç¼–è¯‘å™¨ï¼› CMAKE_BUILD_TYPE:ï¼šbuild ç±»å‹(Debug, Release, â€¦)-CMAKE_BUILD_TYPE=Debug ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:21","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.19.4 ç¯å¢ƒå˜é‡ è®¾ç½®ç¯å¢ƒå˜é‡ï¼š set(env{name} value) è°ƒç”¨ç¯å¢ƒå˜é‡ï¼š $env{name} ä¾‹å¦‚ message(STATUS \"$env{name}\") ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:22","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.19.5 CMAKE_INCLUDE_CURRENT_DIR è‡ªåŠ¨æ·»åŠ CMAKE_CURRENT_BINARY_DIRå’ŒCMAKE_CURRENT_SOURCE_DIRåˆ°å½“å‰å¤„ç†çš„CMakeLists.txtã€‚ ç›¸å½“äºåœ¨æ¯ä¸ªCMakeLists.txtåŠ å…¥ï¼š include_directories(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_CURRENT_SOURCE_DIR}) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:23","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.20 æ¡ä»¶åˆ¤æ–­ ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:24","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.20.1 é€»è¾‘åˆ¤æ–­å’Œæ¯”è¾ƒ if (expression)ï¼šexpression ä¸ä¸ºç©ºæ—¶ä¸ºçœŸï¼Œfalseçš„å€¼åŒ…æ‹¬ï¼ˆ0,N,NO,OFF,FALSE,NOTFOUNDï¼‰ï¼› if (not exp)ï¼šä¸ä¸Šé¢ç›¸åï¼› if (var1 AND var2)ï¼šå¦‚æœä¸¤ä¸ªå˜é‡éƒ½ä¸ºçœŸæ—¶ä¸ºçœŸï¼› if (var1 OR var2)ï¼šå¦‚æœä¸¤ä¸ªå˜é‡æœ‰ä¸€ä¸ªä¸ºçœŸæ—¶ä¸ºçœŸï¼› if (COMMAND cmd)ï¼šå¦‚æœ cmd ç¡®å®æ˜¯å‘½ä»¤å¹¶å¯è°ƒç”¨ä¸ºçœŸï¼› if (EXISTS dir) if (EXISTS file)ï¼šå¦‚æœç›®å½•æˆ–æ–‡ä»¶å­˜åœ¨ä¸ºçœŸï¼› if (file1 IS_NEWER_THAN file2)ï¼šå½“ file1 æ¯” file2 æ–°ï¼Œæˆ– file1/file2 ä¸­æœ‰ä¸€ä¸ªä¸å­˜åœ¨æ—¶ä¸ºçœŸï¼Œæ–‡ä»¶åéœ€ä½¿ç”¨å…¨è·¯å¾„ï¼› if (IS_DIRECTORY dir)ï¼šå½“ dir æ˜¯ç›®å½•æ—¶ä¸ºçœŸï¼› if (DEFINED var)ï¼šå¦‚æœå˜é‡è¢«å®šä¹‰ä¸ºçœŸï¼› if (var MATCHES regex)ï¼šç»™å®šçš„å˜é‡æˆ–è€…å­—ç¬¦ä¸²èƒ½å¤ŸåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ regex æ—¶ä¸ºçœŸï¼Œæ­¤å¤„ var å¯ä»¥ç”¨ var åï¼Œä¹Ÿå¯ä»¥ç”¨ ${var}ï¼› if (string MATCHES regex)ï¼šç»™å®šçš„å­—ç¬¦ä¸²èƒ½å¤ŸåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼regexæ—¶ä¸ºçœŸã€‚ ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:25","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.20.2 æ•°å­—æ¯”è¾ƒ if (variable LESS number)ï¼šå¦‚æœvariableå°äºnumberæ—¶ä¸ºçœŸï¼› if (string LESS number)ï¼šå¦‚æœstringå°äºnumberæ—¶ä¸ºçœŸï¼› if (variable GREATER number)ï¼šå¦‚æœvariableå¤§äºnumberæ—¶ä¸ºçœŸï¼› if (string GREATER number)ï¼šå¦‚æœstringå¤§äºnumberæ—¶ä¸ºçœŸï¼› if (variable EQUAL number)ï¼šå¦‚æœvariableç­‰äºnumberæ—¶ä¸ºçœŸï¼› if (string EQUAL number)ï¼šå¦‚æœstringç­‰äºnumberæ—¶ä¸ºçœŸã€‚ ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:26","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.20.3 å­—æ¯è¡¨é¡ºåºæ¯”è¾ƒ if (variable STRLESS string) if (string STRLESS string) if (variable STRGREATER string) if (string STRGREATER string) if (variable STREQUAL string) if (string STREQUAL string) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:27","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.21 å¾ªç¯ ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:28","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.21.1 foreach start è¡¨ç¤ºèµ·å§‹æ•°ï¼Œstop è¡¨ç¤ºç»ˆæ­¢æ•°ï¼Œstep è¡¨ç¤ºæ­¥é•¿ foreach(loop_var RANGE start stop [step]) ... endforeach(loop_var) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:29","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.21.2 while while(condition) ... endwhile() ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:30","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.22 è‡ªåŠ¨æ£€æµ‹ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒC++11 include(CheckCXXCompilerFlag) CHECK_CXX_COMPILER_FLAG(\"-std=c++11\" COMPILER_SUPPORTS_CXX11) CHECK_CXX_COMPILER_FLAG(\"-std=c++0x\" COMPILER_SUPPORTS_CXX0X) if(COMPILER_SUPPORTS_CXX11) set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=c++11\") elseif(COMPILER_SUPPORTS_CXX0X) set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=c++0x\") else() message(STATUS \"The compiler ${CMAKE_CXX_COMPILER} has no C++11 support. Please use a different C++ compiler.\") endif() ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:31","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.23 CMakeç”ŸæˆVSè§£å†³æ–¹æ¡ˆå°†é¡¹ç›®æ”¾ç½®åœ¨è®¾å®šæ–‡ä»¶å¤¹ä¸‹ ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨å·¥ç¨‹ä¸­å¼•ç”¨äº†è®¸å¤šçš„ç¬¬ä¸‰æ–¹å¼€æºåº“ï¼Œè¿™äº›åº“çš„æºç ä¸è‡ªå·±æ‰€å†™çš„ä»£ç éœ€è¦è¿›è¡ŒåŒºåˆ†å’Œéš”ç¦»ï¼Œé€šå¸¸æƒ…å†µä¸‹ä¼šå•ç‹¬å¼€ä¸€ä¸ªthirdç­›é€‰å™¨å­˜å‚¨è¿™äº›ç¬¬ä¸‰æ–¹åº“çš„é¡¹ç›®ï¼Œæ€ä¹ˆåšï¼Ÿ ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:32","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"ç¬¬ä¸€æ­¥ï¼š åœ¨ç¬¬ä¸‰æ–¹åº“çš„CMakeLists.txtä¸­cmake_minimum_required(VERSION 2.6)ä¸­åŠ ä¸Šset_property(GLOBAL PROPERTY USE_FOLDERS On) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:33","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"ç¬¬äºŒæ­¥ï¼šåœ¨ç”Ÿæˆç¼–è¯‘ç›®æ ‡çš„è¯­æ³•ä¹‹åï¼Œå¦‚ï¼š add_executable(demo demo.cpp) # ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ add_library(common STATIC util.cpp) # ç”Ÿæˆé™æ€åº“ add_library(common SHARED util.cpp) # ç”ŸæˆåŠ¨æ€åº“æˆ–å…±äº«åº“ åŠ å…¥ä¸€å¥ set_target_properties(${ç¬¬ä¸‰æ–¹åº“é¡¹ç›®åç§°} PROPERTIES FOLDER â€œç›®æ ‡æ–‡ä»¶å¤¹åç§°â€) ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:34","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.24 CMakeå¸¸ç”¨å˜é‡ 1ï¼‰CMAKE_BINARY_DIRã€PROJECT_BINARY_DIRã€\u003cprojectname\u003e_BINARY_DIRä¸‰ä¸ªå˜é‡æŒ‡ä»£çš„å†…å®¹æ˜¯ä¸€è‡´çš„ï¼Œå¦‚æœæ˜¯ in source ç¼–è¯‘ï¼ŒæŒ‡å¾—å°±æ˜¯å·¥ç¨‹é¡¶å±‚ç›®å½•ï¼Œå¦‚æœæ˜¯ out-of-source ç¼–è¯‘ï¼ŒæŒ‡çš„æ˜¯å·¥ç¨‹ç¼–è¯‘å‘ç”Ÿçš„ç›®å½•ã€‚PROJECT_BINARY_DIR è·Ÿå…¶ä»–æŒ‡ä»¤ç¨æœ‰åŒºåˆ«ï¼Œæš‚æ—¶å¯ä»¥ç†è§£ä¸ºä»–ä»¬æ˜¯ä¸€è‡´çš„ã€‚ ï¼ˆ2ï¼‰CMAKE_SOURCE_DIRã€PROJECT_SOURCE_DIRã€\u003cprojectname\u003e_SOURCE_DIRè¿™ä¸‰ä¸ªå˜é‡æŒ‡ä»£çš„å†…å®¹æ˜¯ä¸€è‡´çš„ï¼Œä¸è®ºé‡‡ç”¨ä½•ç§ç¼–è¯‘æ–¹å¼ï¼Œéƒ½æ˜¯å·¥ç¨‹é¡¶å±‚ç›®å½•ã€‚ä¹Ÿå°±æ˜¯åœ¨in source ç¼–è¯‘æ—¶ï¼Œä»–è·Ÿ CMAKE_BINARY_DIR ç­‰å˜é‡ä¸€è‡´ã€‚PROJECT_SOURCE_DIR è·Ÿå…¶ä»–æŒ‡ä»¤ç¨æœ‰åŒºåˆ«ï¼Œæš‚æ—¶ç†è§£ä¸ºä»–ä»¬æ˜¯ä¸€è‡´çš„ã€‚ ï¼ˆ3ï¼‰CMAKE_CURRENT_SOURCE_DIRæŒ‡çš„æ˜¯å½“å‰å¤„ç†çš„CMakeLists.txt æ‰€åœ¨çš„è·¯å¾„ã€‚ ï¼ˆ4ï¼‰CMAKE_CURRRENT_BINARY_DIRï¼Œå¦‚æœæ˜¯in-source ç¼–è¯‘ï¼Œå®ƒè·Ÿ CMAKE_CURRENT_SOURCE_DIR ä¸€è‡´ï¼Œå¦‚æœæ˜¯out-of-source ç¼–è¯‘ï¼Œä»–æŒ‡çš„æ˜¯target ç¼–è¯‘ç›®å½•ã€‚ä½¿ç”¨ADD_SUBDIRECTORY(src bin)å¯ä»¥æ›´æ”¹è¿™ä¸ªå˜é‡çš„å€¼ã€‚ä½¿ç”¨SET(EXECUTABLE_OUTPUT_PATH \u003cæ–°è·¯å¾„\u003e)å¹¶ä¸ä¼šå¯¹è¿™ä¸ªå˜é‡é€ æˆå½±å“ï¼Œå®ƒä»…ä»…ä¿®æ”¹äº†æœ€ç»ˆç›®æ ‡æ–‡ä»¶å­˜æ”¾çš„è·¯å¾„ã€‚ ï¼ˆ5ï¼‰CMAKE_CURRENT_LIST_FILEè¾“å‡ºè°ƒç”¨è¿™ä¸ªå˜é‡çš„CMakeLists.txt çš„å®Œæ•´è·¯å¾„ã€‚ ï¼ˆ6ï¼‰CMAKE_CURRENT_LIST_LINEè¾“å‡ºè¿™ä¸ªå˜é‡æ‰€åœ¨çš„è¡Œã€‚ ï¼ˆ7ï¼‰CMAKE_MODULE_PATHè¿™ä¸ªå˜é‡ç”¨æ¥å®šä¹‰è‡ªå·±çš„cmakeæ¨¡å—æ‰€åœ¨çš„è·¯å¾„ã€‚å¦‚æœä½ çš„å·¥ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæœ‰å¯èƒ½ä¼šè‡ªå·±ç¼–å†™ä¸€äº›cmakeæ¨¡å—ï¼Œè¿™äº›cmake æ¨¡å—æ˜¯éšä½ çš„å·¥ç¨‹å‘å¸ƒçš„ï¼Œä¸ºäº†è®©cmake åœ¨å¤„ç† CMakeLists.txt æ—¶æ‰¾åˆ°è¿™äº›æ¨¡å—ï¼Œä½ éœ€è¦é€šè¿‡SET æŒ‡ä»¤ï¼Œå°†è‡ªå·±çš„cmake æ¨¡å—è·¯å¾„è®¾ç½®ä¸€ä¸‹ã€‚ æ¯”å¦‚ï¼š SET(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/cmake), è¿™æ—¶å€™ä½ å°±å¯ä»¥é€šè¿‡INCLUDE æŒ‡ä»¤æ¥è°ƒç”¨è‡ªå·±çš„æ¨¡å—äº†ã€‚ ï¼ˆ8ï¼‰EXECUTABLE_OUTPUT_PATH å’Œ LIBRARY_OUTPUT_PATHåˆ†åˆ«ç”¨æ¥é‡æ–°å®šä¹‰æœ€ç»ˆç»“æœçš„å­˜æ”¾ç›®å½•ã€‚ ï¼ˆ9ï¼‰PROJECT_NAMEè¿”å›é€šè¿‡PROJECTæŒ‡ä»¤å®šä¹‰çš„é¡¹ç›®åç§°ã€‚ ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:35","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"1.25 target_sources() æ¥æº: https://blog.csdn.net/guaaaaaaa/article/details/125601766 ä½œç”¨: ä½¿ç”¨ target_sources() å°†å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰.cã€.hæ–‡ä»¶ä½œä¸ºæºæ–‡ä»¶æ·»åŠ åˆ°é¡¹ç›®ä¸­ ","date":"2024-01-24","objectID":"/posts/commandcollection/:1:36","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"2 é”™è¯¯è§£å†³æ–¹æ¡ˆ ","date":"2024-01-24","objectID":"/posts/commandcollection/:2:0","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"2.1 Cannot specify link libraries for target â€œ/â€¦/â€¦/lib/linux/libMyDll.aâ€ which è¿™ä¸ªé—®é¢˜è¦å°†ç”Ÿæˆæ‰§è¡Œæ–‡ä»¶ã€é™æ€åº“ã€åŠ¨æ€åº“çš„å£°æ˜ add_executable(demo demo.cpp) # ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ add_library(common STATIC util.cpp) # ç”Ÿæˆé™æ€åº“ add_library(common SHARED util.cpp) # ç”ŸæˆåŠ¨æ€åº“æˆ–å…±äº«åº“ æ”¾åœ¨ target_link_libraries() ä¹‹å‰ã€‚ ","date":"2024-01-24","objectID":"/posts/commandcollection/:2:1","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"2.2 è­¦å‘Šï¼šæ£€æµ‹åˆ°æ—¶é’Ÿé”™è¯¯ã€‚æ‚¨çš„åˆ›å»ºå¯èƒ½æ˜¯ä¸å®Œæ•´çš„ã€‚ åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼š touch * æ›´æ–°æ‰€æœ‰æ–‡ä»¶æ—¶é—´ã€‚ ","date":"2024-01-24","objectID":"/posts/commandcollection/:2:2","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["C++"],"content":"3 å‚è€ƒ [1].cmakeå¸¸ç”¨å‘½ä»¤çš„ä¸€äº›æ•´ç† [2].ç®€æ˜æ•™ç¨‹ [3].CMake å‘½ä»¤è¡Œå‚æ•° [4].https://blog.csdn.net/geyichongchujianghu/article/details/124781090?spm=1001.2101.3001.6650.1\u0026utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-124781090-blog-85257728.235%5Ev40%5Epc_relevant_3m_sort_dl_base1\u0026depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-124781090-blog-85257728.235%5Ev40%5Epc_relevant_3m_sort_dl_base1\u0026utm_relevant_index=2 [5].https://blog.csdn.net/Zhanganliu/article/details/85257728 [6].https://blog.csdn.net/llffss/article/details/120121617 [7].https://blog.csdn.net/wzj_110/category_10357507.html [8].https://blog.csdn.net/fengbingchun/category_783053.html ","date":"2024-01-24","objectID":"/posts/commandcollection/:3:0","tags":["CMake"],"title":"CMake å¸¸ç”¨å‘½ä»¤æŸ¥è¯¢","uri":"/posts/commandcollection/"},{"categories":["Linux"],"content":"1ã€ ç®€ä»‹ ./configure make make install ä»¥ä¸Šä¸‰ä¸ªå‘½ä»¤æ˜¯æºç å®‰è£…è½¯ä»¶çš„é€šç”¨æ­¥éª¤ã€‚å…¶ä¸»è¦å®Œæˆä»¥ä¸‹å·¥ä½œï¼š ./configure: é…ç½®ï¼Œæ˜¯ç”¨æ¥æ£€æµ‹ä½ çš„å®‰è£…å¹³å°çš„ç›®æ ‡ç‰¹å¾ã€‚æ¯”å¦‚å®ƒä¼šæ£€æµ‹ä½ æ˜¯ä¸æ˜¯æœ‰CCæˆ–GCCï¼Œå¹¶ä¸æ˜¯éœ€è¦CCæˆ–GCCï¼Œå®ƒæ˜¯ä¸ªshellè„šæœ¬ã€‚configure è„šæœ¬è´Ÿè´£åœ¨ä½¿ç”¨çš„ç³»ç»Ÿä¸Šå‡†å¤‡å¥½è½¯ä»¶çš„æ„å»ºç¯å¢ƒã€‚ç¡®ä¿æ¥ä¸‹æ¥çš„æ„å»ºå’Œå®‰è£…è¿‡ç¨‹æ‰€éœ€è¦çš„ä¾èµ–å‡†å¤‡å¥½ï¼Œå¹¶ä¸”ææ¸…æ¥šä½¿ç”¨è¿™äº›ä¾èµ–éœ€è¦çš„ä¸œè¥¿ã€‚ make: æ„å»ºï¼Œç”¨æ¥ç¼–è¯‘ï¼Œå®ƒä»Makefileä¸­è¯»å–æŒ‡ä»¤ï¼Œç„¶åç¼–è¯‘ã€‚ä¸‹è½½çš„æºç åŒ…ä¸€èˆ¬æ²¡æœ‰ä¸€ä¸ªæœ€ç»ˆçš„ Makefile æ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªæ¨¡ç‰ˆæ–‡ä»¶ http://Makefile.in æ–‡ä»¶ï¼Œç„¶å configure æ ¹æ®ç³»ç»Ÿçš„å‚æ•°ç”Ÿæˆä¸€ä¸ªå®šåˆ¶åŒ–çš„ Makefile æ–‡ä»¶ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæ‰§è¡Œåœ¨ Makefile æ–‡ä»¶ä¸­å®šä¹‰çš„ä¸€ç³»åˆ—ä»»åŠ¡å°†è½¯ä»¶æºä»£ç ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚ make install:å®‰è£…ï¼Œå®ƒä¹Ÿä»Makefileä¸­è¯»å–æŒ‡ä»¤ï¼Œå®‰è£…åˆ°æŒ‡å®šçš„ä½ç½®ã€‚make install å‘½ä»¤å°±æ˜¯å°†å¯æ‰§è¡Œæ–‡ä»¶ã€ç¬¬ä¸‰æ–¹ä¾èµ–åŒ…å’Œæ–‡æ¡£å¤åˆ¶åˆ°æ­£ç¡®çš„è·¯å¾„ã€‚ tips è¿™äº›è„šæœ¬æ˜¯æ€ä¹ˆäº§ç”Ÿçš„? å®‰è£…è¿‡ç¨‹ç®€å•è¯´å°±æ˜¯ configure è„šæœ¬æ ¹æ®ç³»ç»Ÿä¿¡æ¯å°† Makefile.in æ¨¡ç‰ˆæ–‡ä»¶è½¬æ¢ä¸º Makefileæ–‡ä»¶ï¼Œä½†æ˜¯ configure å’Œ Makefile.in æ–‡ä»¶æ˜¯æ€ä¹ˆäº§ç”Ÿçš„å‘¢ï¼Ÿ å¦‚æœä½ æ›¾ç»è¯•ç€æ‰“å¼€ configure æˆ–è€… Makefile.in æ–‡ä»¶ï¼Œä½ ä¼šå‘ç°è¶…é•¿è€Œä¸”å¤æ‚çš„ shell è„šæœ¬è¯­è¨€ã€‚æœ‰æ—¶å€™è¿™äº›è„šæœ¬ä»£ç æ¯”å®ƒä»¬è¦å®‰è£…çš„ç¨‹åºæºä»£ç è¿˜è¦é•¿ã€‚ å¦‚æœæƒ³æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªè¿™æ ·çš„ configure è„šæœ¬æ–‡ä»¶æ˜¯éå¸¸å¯æ€•çš„ï¼Œå¥½æ¶ˆæ¯æ˜¯è¿™äº›è„šæœ¬æ˜¯é€šè¿‡ä»£ç ç”Ÿæˆçš„ã€‚ é€šè¿‡è¿™ç§æ–¹å¼æ„å»ºçš„è½¯ä»¶é€šå¸¸æ˜¯é€šè¿‡ä¸€ä¸ªå«åš autotools çš„å·¥å…·é›†æ‰“åŒ…çš„ã€‚è¿™ä¸ªå·¥å…·é›†åŒ…å« autoconf ã€automake ç­‰å·¥å…·ï¼Œæ‰€æœ‰çš„è¿™äº›å·¥å…·ä½¿å¾—ç»´æŠ¤è½¯ä»¶ç”Ÿå‘½å‘¨æœŸå˜å¾—å¾ˆå®¹æ˜“ã€‚æœ€ç»ˆç”¨æˆ·ä¸éœ€è¦äº†è§£è¿™äº›å·¥å…·ï¼Œä½†å´å¯ä»¥è®©è½¯ä»¶åœ¨ä¸åŒçš„ Unix ç³»ç»Ÿä¸Šçš„å®‰è£…æ­¥éª¤å˜å¾—ç®€å•ã€‚ ","date":"2024-01-20","objectID":"/posts/make_install/:1:0","tags":["make_install"],"title":"configureã€makeã€make install èƒŒåçš„åŸç†","uri":"/posts/make_install/"},{"categories":["Linux"],"content":"2ã€ è¯¦ç»†è¯´æ˜ ","date":"2024-01-20","objectID":"/posts/make_install/:2:0","tags":["make_install"],"title":"configureã€makeã€make install èƒŒåçš„åŸç†","uri":"/posts/make_install/"},{"categories":["Linux"],"content":"2.1 configureå‘½ä»¤ è¿™ä¸€æ­¥ä¸€èˆ¬ç”¨æ¥ç”Ÿæˆ Makefileï¼Œä¸ºä¸‹ä¸€æ­¥çš„ç¼–è¯‘åšå‡†å¤‡ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨ configure ååŠ ä¸Šå‚æ•°æ¥å¯¹å®‰è£…è¿›è¡Œæ§åˆ¶ï¼Œå…·ä½“å‚æ•°å¯ä»¥é€šè¿‡configure --help å¯Ÿçœ‹ï¼Œä¸‹é¢ä¸¾å‡ ä¸ªä¾‹å­: ./configure --prefix=/usr ... --prefix=/usr: æ„æ€æ˜¯å°†è¯¥è½¯ä»¶å®‰è£…åœ¨ /usr ä¸‹é¢ï¼Œæ‰§è¡Œæ–‡ä»¶å°±ä¼šå®‰è£…åœ¨ /usr/bin (è€Œä¸æ˜¯é»˜è®¤çš„ /usr/local/bin), èµ„æºæ–‡ä»¶å°±ä¼šå®‰è£…åœ¨ /usr/share(è€Œä¸æ˜¯é»˜è®¤çš„/usr/local/share)ã€‚é€‰é¡¹çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯å¸è½½è½¯ä»¶æˆ–ç§»æ¤è½¯ä»¶ã€‚å½“æŸä¸ªå®‰è£…çš„è½¯ä»¶ä¸å†éœ€è¦æ—¶ï¼Œåªé¡»ç®€å•çš„åˆ é™¤è¯¥å®‰è£…ç›®å½•ï¼Œå°±å¯ä»¥æŠŠè½¯ä»¶å¸è½½å¾—å¹²å¹²å‡€å‡€ï¼›ç§»æ¤è½¯ä»¶åªéœ€æ‹·è´æ•´ä¸ªç›®å½•åˆ°å¦å¤–ä¸€ä¸ªæœºå™¨å³å¯ï¼ˆç›¸åŒçš„æ“ä½œç³»ç»Ÿï¼‰ --bindir=: æŒ‡å®šäºŒè¿›åˆ¶æ–‡ä»¶çš„å®‰è£…ä½ç½®.è¿™é‡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶å®šä¹‰ä¸ºå¯ä»¥è¢«ç”¨æˆ·ç›´æ¥æ‰§è¡Œçš„ç¨‹åº --enable-staticä¸--enable-shared: --enable-static: ç”Ÿæˆé™æ€é“¾æ¥åº“ --enable-shared: ç”ŸæˆåŠ¨æ€é“¾æ¥åº“ --with-: ç”¨äºå¯ç”¨æˆ–ç¦ç”¨ç‰¹å®šåŠŸèƒ½æˆ–æ¨¡å—ã€‚ä¾‹å¦‚: --with-sslè¡¨ç¤ºå¯ç”¨SSLæ”¯æŒ --without-guiè¡¨ç¤ºç¦ç”¨å›¾å½¢ç•Œé¢ã€‚ --with-package=dir --with-apxs æ˜¯æŒ‡å®š apache çš„é…ç½®ç¨‹åºè·¯å¾„ï¼Œphpç¼–è¯‘ç¨‹åºä¼šé€šè¿‡è¿™ä¸ªç¨‹åºæŸ¥æ‰¾apacheçš„ç›¸å…³è·¯å¾„ --with-libxml-dir: æŒ‡å‘çš„æ˜¯ libxml çš„åº“è·¯å¾„ --with-gd: æŒ‡é™æ€ç¼–è¯‘gdåº“ --with-png-dir: æŒ‡å®š libpng çš„è·¯å¾„ --enable-: ç”¨äºå¯ç”¨æˆ–ç¦ç”¨ç‰¹å®šåŠŸèƒ½æˆ–æ¨¡å—ã€‚ä¸â€“with-é€‰é¡¹ç±»ä¼¼ï¼Œä½†æ›´å¸¸ç”¨äºå¯ç”¨æˆ–ç¦ç”¨ç¼–è¯‘é€‰é¡¹ã€‚ --disable-: ç”¨äºç¦ç”¨ç‰¹å®šåŠŸèƒ½æˆ–æ¨¡å—ã€‚ä¸â€“enable-é€‰é¡¹ç›¸åï¼Œç”¨äºç¦ç”¨ç¼–è¯‘é€‰é¡¹ã€‚ â€“sys-config=: æŒ‡å®šè½¯ä»¶çš„é…ç½®æ–‡ä»¶ã€‚æœ‰ä¸€äº›è½¯ä»¶è¿˜å¯ä»¥åŠ ä¸Š â€“withã€â€“enableã€â€“withoutã€â€“disable ç­‰ç­‰å‚æ•°å¯¹ç¼–è¯‘åŠ ä»¥æ§åˆ¶ ","date":"2024-01-20","objectID":"/posts/make_install/:2:1","tags":["make_install"],"title":"configureã€makeã€make install èƒŒåçš„åŸç†","uri":"/posts/make_install/"},{"categories":["Linux"],"content":"2.2 make å‘½ä»¤ è¿™ä¸€æ­¥å°±æ˜¯ç¼–è¯‘ï¼Œå¤§å¤šæ•°çš„æºä»£ç åŒ…éƒ½ç»è¿‡è¿™ä¸€æ­¥è¿›è¡Œç¼–è¯‘ï¼ˆå½“ç„¶æœ‰äº›perlæˆ–pythonç¼–å†™çš„è½¯ä»¶éœ€è¦è°ƒç”¨perlæˆ–pythonæ¥è¿›è¡Œç¼–è¯‘ï¼‰ã€‚å¦‚æœ åœ¨ make è¿‡ç¨‹ä¸­å‡ºç° error ï¼Œä½ å°±è¦è®°ä¸‹é”™è¯¯ä»£ç ï¼ˆæ³¨æ„ä¸ä»…ä»…æ˜¯æœ€åä¸€è¡Œï¼‰ï¼Œç„¶åä½ å¯ä»¥å‘å¼€å‘è€…æäº¤ bugreportï¼ˆä¸€èˆ¬åœ¨ INSTALL é‡Œæœ‰æäº¤åœ°å€ï¼‰ï¼Œæˆ–è€…ä½ çš„ç³»ç»Ÿå°‘äº†ä¸€äº›ä¾èµ–åº“ç­‰ï¼Œè¿™äº›éœ€è¦è‡ªå·±ä»”ç»†ç ”ç©¶é”™è¯¯ä»£ç ã€‚ å¯èƒ½é‡åˆ°çš„é”™è¯¯ï¼šmake *** æ²¡æœ‰æŒ‡æ˜ç›®æ ‡å¹¶ä¸”æ‰¾ä¸åˆ° makefileã€‚ æ²¡æœ‰Makefileï¼Œå…ˆ./configure ä¸€ä¸‹ï¼Œå†makeã€‚make uninstall æ˜¯å¸è½½ï¼Œä¸åŠ å‚æ•°å°±æ˜¯é»˜è®¤çš„è¿›è¡Œæºä»£ç ç¼–è¯‘ã€‚ makeå·¥å…·ï¼Œå®ƒæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–ç¼–è¯‘å·¥å…·ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€æ¡å‘½ä»¤å®ç°å®Œå…¨ç¼–è¯‘ã€‚ä½†æ˜¯ä½ éœ€è¦ç¼–å†™ä¸€ä¸ªè§„åˆ™æ–‡ä»¶ï¼Œmakeä¾æ®å®ƒæ¥æ‰¹å¤„ç†ç¼–è¯‘ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯makefileã€‚ ","date":"2024-01-20","objectID":"/posts/make_install/:2:2","tags":["make_install"],"title":"configureã€makeã€make install èƒŒåçš„åŸç†","uri":"/posts/make_install/"},{"categories":["Linux"],"content":"2.3 make install å‘½ä»¤ è¿™æ¡å‘½ä»¤æ¥è¿›è¡Œå®‰è£…ï¼ˆå½“ç„¶æœ‰äº›è½¯ä»¶éœ€è¦å…ˆè¿è¡Œ make check æˆ– make test æ¥è¿›è¡Œä¸€äº›æµ‹è¯•ï¼‰ï¼Œè¿™ä¸€æ­¥ä¸€èˆ¬éœ€è¦ä½ æœ‰ root æƒé™ï¼ˆå› ä¸ºè¦å‘ç³»ç»Ÿå†™å…¥æ–‡ä»¶ï¼‰ã€‚ make install å’Œmake install prefix=/usr/local/ ç­‰ä»·ã€‚ make install prefix=/usr/local/ sysconfdir=/etc DESTDIR=/tmp/buildæ”¯æŒDESTDIRçš„æ„ä¹‰å°±æ˜¯ï¼Œä¿è¯æ‰€æœ‰è¦å®‰è£…çš„æ–‡ä»¶ï¼Œéƒ½ä¼šè¢«å®‰è£…åœ¨DESTDIRç›®å½•ä¸‹ï¼Œä¸ä¼šæ±¡æŸ“ç³»ç»Ÿçš„packageçš„ç›®å½•ã€‚installä¹Ÿ æ˜¯linuxç³»ç»Ÿå‘½ä»¤ã€‚ ","date":"2024-01-20","objectID":"/posts/make_install/:2:3","tags":["make_install"],"title":"configureã€makeã€make install èƒŒåçš„åŸç†","uri":"/posts/make_install/"},{"categories":["Linux"],"content":"2.4 æ‰©å±•è¯´æ˜ Linuxçš„ç”¨æˆ·å¯èƒ½çŸ¥é“ï¼Œåœ¨Linuxä¸‹å®‰è£…ä¸€ä¸ªåº”ç”¨ç¨‹åºæ—¶ï¼Œä¸€èˆ¬å…ˆè¿è¡Œè„šæœ¬configureï¼Œç„¶åç”¨makeæ¥ç¼–è¯‘æºç¨‹åºï¼Œåœ¨è¿è¡Œmake installï¼Œæœ€åè¿è¡Œmake cleanåˆ é™¤ä¸€äº›ä¸´æ—¶æ–‡ä»¶ã€‚ configureæ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨è®¾å®šæºç¨‹åºä»¥ç¬¦åˆå„ç§ä¸åŒå¹³å°ä¸ŠUnixç³»ç»Ÿçš„ç‰¹æ€§ï¼Œå¹¶ä¸”æ ¹æ®ç³»ç»Ÿåæ•°åŠç¯å¢ƒäº§ç”Ÿåˆé€‚çš„Makefileæ–‡ä»¶æˆ–æ˜¯Cçš„å¤´æ–‡ä»¶(header file)ï¼Œè®©æºç¨‹åºå¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨è¿™äº›ä¸åŒçš„å¹³å°ä¸Šè¢«ç¼–è¯‘è¿æ¥ã€‚ åˆ©ç”¨configureæ‰€äº§ç”Ÿçš„Makefileæ–‡ä»¶æœ‰å‡ ä¸ªé¢„è®¾çš„ç›®æ ‡å¯ä¾›ä½¿ç”¨ï¼Œå…¶ä¸­å‡ ä¸ªé‡è¦çš„ç®€è¿°å¦‚ä¸‹ï¼š make all: äº§ç”Ÿæˆ‘ä»¬è®¾å®šçš„ç›®æ ‡ï¼Œå³æ­¤èŒƒä¾‹ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚åªæ‰“makeä¹Ÿå¯ä»¥ï¼Œæ­¤æ—¶ä¼šå¼€å§‹ç¼–è¯‘åŸå§‹ç ï¼Œç„¶åè¿ç»“ï¼Œå¹¶ä¸”äº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ã€‚åªæ‰“make é»˜è®¤å°±æ˜¯make allï¼Œåªç¼–è¯‘å…¶ä¸­æŸä¸ªç›®æ ‡åˆ™åœ¨åé¢ç»™ç›®æ ‡åç§°ï¼šmake ce-commonã€‚ make clean: æ¸…é™¤ç¼–è¯‘äº§ç”Ÿçš„å¯æ‰§è¡Œæ–‡ä»¶åŠç›®æ ‡æ–‡ä»¶(object fileï¼Œ*.o)ã€‚ make distclean: é™¤äº†æ¸…é™¤å¯æ‰§è¡Œæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶å¤–ï¼ŒæŠŠconfigureæ‰€äº§ç”Ÿçš„Makefileä¹Ÿæ¸…é™¤æ‰ã€‚ make install: å°†ç¨‹åºå®‰è£…è‡³ç³»ç»Ÿä¸­ã€‚å¦‚æœåŸå§‹ç ç¼–è¯‘æ— è¯¯ï¼Œä¸”æ‰§è¡Œç»“æœæ­£ç¡®ï¼Œä¾¿å¯ä»¥æŠŠç¨‹åºå®‰è£…è‡³ç³»ç»Ÿé¢„è®¾çš„å¯æ‰§è¡Œæ–‡ä»¶å­˜æ”¾è·¯å¾„ã€‚ make dist: å°†ç¨‹åºå’Œç›¸å…³çš„æ¡£æ¡ˆåŒ…è£…æˆä¸€ä¸ªå‹ç¼©æ–‡ä»¶ä»¥ä¾›å‘å¸ƒã€‚æ‰§è¡Œå®Œåœ¨ç›®å½•ä¸‹ä¼šäº§ç”Ÿä¸€ä¸ªä»¥PACKAGE-VERSION.tar.gzä¸ºåç§°çš„æ–‡ä»¶ã€‚ PACKAGEå’ŒVERSIONè¿™ä¸¤ä¸ªå˜æ•°æ˜¯æ ¹æ®http://configure.inæ–‡ä»¶ä¸­AM_INIT_AUTOMAKE(PACKAGEï¼ŒVERSION)çš„å®šä¹‰ã€‚åœ¨æ­¤èŒƒä¾‹ä¸­ä¼šäº§ç”Ÿtest-1.0.tar.gzçš„æ¡£æ¡ˆã€‚ make distcheck: å’Œmake distç±»ä¼¼ï¼Œä½†æ˜¯åŠ å…¥æ£€æŸ¥åŒ…è£…åçš„å‹ç¼©æ–‡ä»¶æ˜¯å¦æ­£å¸¸ã€‚è¿™ä¸ªç›®æ ‡é™¤äº†æŠŠç¨‹åºå’Œç›¸å…³æ–‡ä»¶åŒ…è£…æˆtar.gzæ–‡ä»¶å¤–ï¼Œè¿˜ä¼šè‡ªåŠ¨æŠŠè¿™ä¸ªå‹ç¼©æ–‡ä»¶è§£å¼€ï¼Œæ‰§è¡Œ configureï¼Œå¹¶ä¸”è¿›è¡Œmake all çš„åŠ¨ä½œï¼Œç¡®è®¤ç¼–è¯‘æ— è¯¯åï¼Œä¼šæ˜¾ç¤ºè¿™ä¸ªtar.gzæ–‡ä»¶å¯ä¾›å‘å¸ƒäº†ã€‚è¿™ä¸ªæ£€æŸ¥éå¸¸æœ‰ç”¨ï¼Œæ£€æŸ¥è¿‡å…³çš„åŒ…ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç»™ä»»ä½•ä¸€ä¸ªå…·å¤‡GNUå¼€å‘ç¯å¢ƒ-çš„äººå»é‡æ–°ç¼–è¯‘ã€‚ ","date":"2024-01-20","objectID":"/posts/make_install/:2:4","tags":["make_install"],"title":"configureã€makeã€make install èƒŒåçš„åŸç†","uri":"/posts/make_install/"},{"categories":["Linux"],"content":"3. æ€»ç»“ é€šè¿‡æºç ç¼–è¯‘å®‰è£…ä¸€ä¸ªè½¯ä»¶å¦‚ä¸‹: ./configure --prefix=/usr/local/${program_name} make make install make clean æ³¨æ„: --prefixå¯ä»¥åœ¨configureæˆ–è€…make installæ—¶æŒ‡å®šå®‰è£…è·¯å¾„ã€‚ ","date":"2024-01-20","objectID":"/posts/make_install/:3:0","tags":["make_install"],"title":"configureã€makeã€make install èƒŒåçš„åŸç†","uri":"/posts/make_install/"},{"categories":["Linux"],"content":"4. å‚è€ƒ Linuxå‘½ä»¤è¯¦è§£ï¼š./configureã€makeã€make install å‘½ä»¤ configureã€ makeã€ make install èƒŒåçš„åŸç†(ç¿»è¯‘) ","date":"2024-01-20","objectID":"/posts/make_install/:4:0","tags":["make_install"],"title":"configureã€makeã€make install èƒŒåçš„åŸç†","uri":"/posts/make_install/"},{"categories":["C++"],"content":"0. ç®€ä»‹ ä½œä¸ºä¸€ä¸ªç¨‹åºè€Œè¨€ï¼Œbenchmarkæ˜¯éå¸¸å…³é”®çš„ä¸€ä¸ªè¡¡é‡æŒ‡æ ‡ï¼Œæ— è®ºæ˜¯ç¨‹åºç®—æ³•çš„æŒ‡æ ‡è¿˜æ˜¯ç¨‹åºè¿è¡Œæ€§èƒ½çš„æŒ‡æ ‡ï¼Œè¿™äº›æˆ‘ä»¬éƒ½å¯ä»¥å»å®Œæˆè¡¡é‡ã€‚å¯¹äºæ€§èƒ½è¡¡é‡è€Œè¨€google benchmarkæ— ç–‘æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚ æ€§èƒ½æµ‹è¯•å·¥å…·å¯¹æ¯” ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:1:0","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"1. google benchmarkå®‰è£… google benchmark ä¸‹è½½åœ°å€ ç¼–è¯‘å®‰è£…: ç™»å½• linuxç¯å¢ƒï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¿›è¡Œç¼–è¯‘å®‰è£…ï¼š git clone https://github.com/google/benchmark.git cd benchmark git clone https://github.com/google/googletest.git mkdir build cd build cmake .. -DCMAKE_BUILD_TYPE=RELEASE make -j4 # å¦‚æœæƒ³å…¨å±€å®‰è£…å°±æ¥ç€è¿è¡Œä¸‹é¢çš„å‘½ä»¤ sudo make install ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:2:0","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"2. ä»£ç ç¼–å†™ åˆ›å»ºä¸€ä¸ªC++æºæ–‡ä»¶ï¼Œå¹¶ç¼–å†™åŒ…å«åŸºå‡†æµ‹è¯•å‡½æ•°çš„ä»£ç ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºbenchmark_example.cppçš„æ–‡ä»¶ï¼Œå¹¶ç¼–å†™å¦‚ä¸‹å†…å®¹ï¼š #include \u003cbenchmark/benchmark.h\u003e static void BM_MyFunction(benchmark::State\u0026 state) { // åœ¨è¿™é‡Œç¼–å†™æ‚¨è¦æµ‹è¯•çš„ä»£ç  for (auto _ : state) { // æ‰§è¡Œæ‚¨çš„ä»£ç  } } BENCHMARK(BM_MyFunction); BENCHMARK_MAIN(); åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼ŒBM_MyFunctionæ˜¯æ‚¨è¦æµ‹è¯•çš„å‡½æ•°ã€‚ ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨C++ç¼–è¯‘å™¨ç¼–è¯‘æ‚¨çš„ä»£ç ï¼Œå¹¶é“¾æ¥Google Benchmarkåº“ã€‚ g++ benchmark_example.cpp -o benchmark_example -lbenchmark -lpthread å¦‚æœæ˜¯cmakelistï¼Œåˆ™å¯ä»¥ä½¿ç”¨ set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -pthread\") # benchmarkä¾èµ–threadçº¿ç¨‹åº“ add_library(benchmark STATIC IMPORTED) set_property(TARGET benchmark PROPERTY IMPORTED_LOCATION /usr/local/lib/libbenchmark.a) add_executable(demo demo.cpp) target_link_libraries(demo benchmark ) install(TARGETS demo DESTINATION \"bin/\" ) ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:3:0","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"2.1 åŸºç¡€ä»£ç è°ƒç”¨æµ‹è¯• æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªbenchmarkæµ‹è¯•ç”¨ä¾‹éƒ½æ˜¯ä¸€ä¸ªç±»å‹ä¸ºstd::functionçš„å‡½æ•°ï¼Œå…¶ä¸­benchmark::State\u0026è´Ÿè´£æµ‹è¯•çš„è¿è¡ŒåŠé¢å¤–å‚æ•°çš„ä¼ é€’ã€‚ æµ‹è¯•ç”¨ä¾‹ç¼–å†™å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨BENCHMARK()å°†æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹æ³¨å†Œè¿›benchmarkï¼Œè¿™æ ·ç¨‹åºè¿è¡Œæ—¶æ‰ä¼šæ‰§è¡Œæˆ‘ä»¬çš„æµ‹è¯•ã€‚ æœ€åæ˜¯ç”¨BENCHMARK_MAIN();æ›¿ä»£ç›´æ¥ç¼–å†™çš„mainå‡½æ•°ï¼Œå®ƒä¼šå¤„ç†å‘½ä»¤è¡Œå‚æ•°å¹¶è¿è¡Œæ‰€æœ‰æ³¨å†Œè¿‡çš„æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆæµ‹è¯•ç»“æœã€‚ Example 1: #include \u003cbenchmark/benchmark.h\u003e #include \u003cvector\u003e #include \u003carray\u003e constexpr int len = 6; std::vector\u003cint\u003e vec{1, 2, 3, 4, 5, 6}; std::array\u003cint, len\u003e array{1, 2, 3, 4, 5, 6}; // benchmark::State \u0026stateç”¨äºç»´æŠ¤æµ‹è¯•ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»¥åŠæ§åˆ¶è¿­ä»£æ¬¡æ•° static void vector_test(benchmark::State \u0026state) { for (auto _ : state) { vec[0]; vec[1]; vec[2]; vec[3]; vec[4]; vec[5]; } } static void array_test(benchmark::State \u0026state) { for (auto _ : state) { array[0]; array[1]; array[2]; array[3]; array[4]; array[5]; } } // æ³¨å†Œæµ‹è¯•ç”¨ä¾‹ BENCHMARK(vector_test); BENCHMARK(array_test); // benchmarkçš„ä¸»å‡½æ•° BENCHMARK_MAIN(); ç»“æœæ ¼å¼å¦‚ä¸‹: Load Average: 0.43, 0.25, 0.10 ------------------------------------------------------ Benchmark Time CPU Iterations ------------------------------------------------------ vector_test 6.81 ns 6.81 ns 102373755 array_test 13.6 ns 13.6 ns 51227934 Example 2 #include \u003cbenchmark/benchmark.h\u003e #include \u003carray\u003e constexpr int len = 6; // constexpr functionå…·æœ‰inlineå±æ€§ï¼Œä½ åº”è¯¥æŠŠå®ƒæ”¾åœ¨å¤´æ–‡ä»¶ä¸­ constexpr auto my_pow(const int i) { return i * i; } // ä½¿ç”¨operator[]è¯»å–å…ƒç´ ï¼Œä¾æ¬¡å­˜å…¥1-6çš„å¹³æ–¹ static void bench_array_operator(benchmark::State\u0026 state) { std::array\u003cint, len\u003e arr; constexpr int i = 1; for (auto _: state) { arr[0] = my_pow(i); arr[1] = my_pow(i+1); arr[2] = my_pow(i+2); arr[3] = my_pow(i+3); arr[4] = my_pow(i+4); arr[5] = my_pow(i+5); } } BENCHMARK(bench_array_operator); // ä½¿ç”¨at()è¯»å–å…ƒç´ ï¼Œä¾æ¬¡å­˜å…¥1-6çš„å¹³æ–¹ static void bench_array_at(benchmark::State\u0026 state) { std::array\u003cint, len\u003e arr; constexpr int i = 1; for (auto _: state) { arr.at(0) = my_pow(i); arr.at(1) = my_pow(i+1); arr.at(2) = my_pow(i+2); arr.at(3) = my_pow(i+3); arr.at(4) = my_pow(i+4); arr.at(5) = my_pow(i+5); } } BENCHMARK(bench_array_at); // std::get\u003c\u003e(array)æ˜¯ä¸€ä¸ªconstexpr functionï¼Œå®ƒä¼šè¿”å›å®¹å™¨å†…å…ƒç´ çš„å¼•ç”¨ï¼Œå¹¶åœ¨ç¼–è¯‘æœŸæ£€æŸ¥æ•°ç»„çš„ç´¢å¼•æ˜¯å¦æ­£ç¡® static void bench_array_get(benchmark::State\u0026 state) { std::array\u003cint, len\u003e arr; constexpr int i = 1; for (auto _: state) { std::get\u003c0\u003e(arr) = my_pow(i); std::get\u003c1\u003e(arr) = my_pow(i+1); std::get\u003c2\u003e(arr) = my_pow(i+2); std::get\u003c3\u003e(arr) = my_pow(i+3); std::get\u003c4\u003e(arr) = my_pow(i+4); std::get\u003c5\u003e(arr) = my_pow(i+5); } } BENCHMARK(bench_array_get); BENCHMARK_MAIN(); æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªbenchmarkæµ‹è¯•ç”¨ä¾‹éƒ½æ˜¯ä¸€ä¸ªç±»å‹ä¸ºstd::function\u003cvoid(benchmark::State\u0026)\u003eçš„å‡½æ•°ï¼Œå…¶ä¸­benchmark::State\u0026è´Ÿè´£æµ‹è¯•çš„è¿è¡ŒåŠé¢å¤–å‚æ•°çš„ä¼ é€’ã€‚ éšåæˆ‘ä»¬ä½¿ç”¨for (auto _: state) {}æ¥è¿è¡Œéœ€è¦æµ‹è¯•çš„å†…å®¹ï¼Œstateä¼šé€‰æ‹©åˆé€‚çš„æ¬¡æ•°æ¥è¿è¡Œå¾ªç¯ï¼Œæ—¶é—´çš„è®¡ç®—ä»å¾ªç¯å†…çš„è¯­å¥å¼€å§‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©åƒä¾‹å­ä¸­ä¸€æ ·åœ¨forå¾ªç¯ä¹‹å¤–åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒï¼Œç„¶ååœ¨å¾ªç¯ä½“å†…ç¼–å†™éœ€è¦æµ‹è¯•çš„ä»£ç ã€‚ æµ‹è¯•ç”¨ä¾‹ç¼–å†™å®Œæˆåæˆ‘ä»¬éœ€è¦ä½¿ç”¨BENCHMARK(\u003cfunction_name\u003e);å°†æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹æ³¨å†Œè¿›benchmarkï¼Œè¿™æ ·ç¨‹åºè¿è¡Œæ—¶æ‰ä¼šæ‰§è¡Œæˆ‘ä»¬çš„æµ‹è¯•ã€‚ æœ€åæ˜¯ç”¨BENCHMARK_MAIN();æ›¿ä»£ç›´æ¥ç¼–å†™çš„mainå‡½æ•°ï¼Œå®ƒä¼šå¤„ç†å‘½ä»¤è¡Œå‚æ•°å¹¶è¿è¡Œæ‰€æœ‰æ³¨å†Œè¿‡çš„æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆæµ‹è¯•ç»“æœã€‚ ç¤ºä¾‹ä¸­å¤§é‡ä½¿ç”¨äº†constexptï¼Œè¿™æ˜¯ä¸ºäº†èƒ½åœ¨ç¼–è¯‘æœŸè®¡ç®—å‡ºéœ€è¦çš„æ•°å€¼é¿å…å¯¹æµ‹è¯•äº§ç”Ÿå¤ªå¤šå™ªéŸ³ã€‚ ç„¶åæˆ‘ä»¬ç¼–è¯‘æµ‹è¯•ç¨‹åºï¼š g++ -Wall -std=c++14 benchmark_example.cpp -pthread -lbenchmark benchmarkéœ€è¦é“¾æ¥libbenchmark.soï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®š-lbenchmarkï¼Œæ­¤å¤–è¿˜éœ€è¦threadçš„æ”¯æŒï¼Œå› ä¸ºlibstdc++ä¸æä¾›threadçš„åº•å±‚å®ç°ï¼Œæˆ‘ä»¬éœ€è¦pthreadã€‚å¦å¤–ä¸å»ºè®®ä½¿ç”¨-lpthreadï¼Œå®˜æ–¹è¡¨ç¤ºä¼šå‡ºç°å…¼å®¹é—®é¢˜ï¼Œåœ¨æˆ‘è¿™æµ‹è¯•ä¹Ÿä¼šå‡ºç°é“¾æ¥é”™è¯¯ã€‚æ³¨æ„æ–‡ä»¶åä¸€å®šè¦åœ¨-lbenchmarkå‰é¢ï¼Œå¦åˆ™ç¼–è¯‘ä¼šå¤±è´¥ï¼Œå…·ä½“å‚è§ï¼šhttps://github.com/google/benchmark/issues/619 å¦‚æœä½ æ˜¯åœ¨Windowså¹³å°ä½¿ç”¨google/benchmarkï¼Œé‚£ä¹ˆä½ éœ€è¦é¢å¤–é“¾æ¥shlwapi.libæ‰èƒ½ä½¿benchmarkæ­£å¸¸ç¼–è¯‘å’Œè¿è¡Œã€‚è¯¦ç»†ä¿¡æ¯åœ¨è¿™é‡Œã€‚ ç¼–è¯‘å¥½ç¨‹åºåå°±å¯ä»¥è¿è¡Œæµ‹è¯•äº†ï¼š 2024-01-20T15:56:26+08:00 Running ./benchmark_example_two Run on (4 X 3700 MHz CPU s) CPU Caches: L1 Data 32 KiB (x4) L1 Instruction 32 KiB (x4) L2 Unified 256 KiB (x4) L3 Unified 8192 KiB (x1) Load Average: 0.36, 0.64, 0.82 ***WARNING*** CPU scaling is enabled, the benchmark real time measurements may be noisy and will incur extra overhead. --------------------------------------------------------------- Benchmark Time CPU Iterations --------------------------------------------------------------- bench_array_operator 30.9 ns 30.6 ns 22700640 bench_array_at 31.1 ns 30.9 ns 22376913 bench_array_get 29.4 ns 29.4 ns 23760270 æ˜¾ç¤ºçš„è­¦å‘Šä¿¡æ¯è¡¨ç¤ºåœ¨å½“å‰ç³»ç»Ÿç¯å¢ƒæœ‰ä¸€äº›å™ªéŸ³(ä¾‹å¦‚å…¶ä»–åœ¨è¿è¡Œçš„ç¨‹åº)å¯èƒ½å¯¼è‡´ç»“æœä¸å¤ªå‡†ç¡®ï¼Œå¹¶ä¸å½±å“æˆ‘ä»¬çš„æµ‹è¯•ã€‚ åœ¨Windowsä¸Šé€šå¸¸æ²¡æœ‰ä¸Šè¿°è­¦å‘Šï¼Œå¦‚æœä½ éœ€è¦åœ¨Linuxå¹³å°ä¸Šå»é™¤ç›¸å…³è­¦å‘Šçš„è¯ï¼Œè¯·å‚è€ƒæ­¤å¤„ã€‚ æµ‹è¯•ç»“æœä¸é¢„æœŸåŸºæœ¬ç›¸ç¬¦ï¼Œstd::getæœ€å¿«ï¼Œat()æœ€æ…¢ã€‚ ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:3:1","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"2.2 ä¼ å‚è°ƒç”¨æµ‹è¯• ä¸Šé¢çš„æµ‹è¯•ç”¨ä¾‹éƒ½åªæ¥å—ä¸€ä¸ªbenchmark::State\u0026ç±»å‹çš„å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨BENCHMARKå®ç”Ÿæˆçš„å¯¹è±¡çš„Argæ–¹æ³•æ¥å®Œæˆå‚æ•°çš„ä¼ é€’ã€‚ ä¼ é€’è¿›æ¥çš„å‚æ•°ä¼šè¢«æ”¾å…¥stateå¯¹è±¡å†…éƒ¨å­˜å‚¨ï¼Œé€šè¿‡rangeæ–¹æ³•è·å–ï¼Œè°ƒç”¨æ—¶çš„å‚æ•°0æ˜¯ä¼ å…¥å‚æ•°çš„éœ€è¦ï¼Œå¯¹åº”ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œç°åœ¨æœ‰ring bufferå’Œlinked listä¸¤ç§å®ç°å¯é€‰ï¼Œç°åœ¨æˆ‘ä»¬è¦æµ‹è¯•ä¸¤ç§æ–¹æ¡ˆåœ¨ä¸åŒæƒ…å†µä¸‹çš„æ€§èƒ½è¡¨ç°ï¼š // å¿…è¦çš„æ•°æ®ç»“æ„ #include \u003cbenchmark/benchmark.h\u003e #include \"ring.h\" #include \"linked_ring.h\" // ring bufferçš„æµ‹è¯• static void bench_array_ring_insert_int_10(benchmark::State\u0026 state) { auto ring = ArrayRing\u003cint\u003e(10); for (auto _: state) { for (int i = 1; i \u003c= 10; ++i) { ring.insert(i); } state.PauseTiming(); // æš‚åœè®¡æ—¶ ring.clear(); state.ResumeTiming(); // æ¢å¤è®¡æ—¶ } } BENCHMARK(bench_array_ring_insert_int_10); // linked listçš„æµ‹è¯• static void bench_linked_queue_insert_int_10(benchmark::State \u0026state) { auto ring = LinkedRing\u003cint\u003e{}; for (auto _:state) { for (int i = 0; i \u003c 10; ++i) { ring.insert(i); } state.PauseTiming(); ring.clear(); state.ResumeTiming(); } } BENCHMARK(bench_linked_queue_insert_int_10); // è¿˜æœ‰é’ˆå¯¹åˆ é™¤çš„æµ‹è¯•ï¼Œä»¥åŠé’ˆå¯¹stringçš„æµ‹è¯•ï¼Œéƒ½æ˜¯é«˜åº¦é‡å¤çš„ä»£ç ï¼Œè¿™é‡Œä¸å†ç½—åˆ— å¾ˆæ˜¾ç„¶ï¼Œä¸Šé¢çš„æµ‹è¯•é™¤äº†è¢«æµ‹è¯•ç±»å‹å’Œæ’å…¥çš„æ•°æ®é‡ä¹‹å¤–æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œå¦‚æœå¯ä»¥é€šè¿‡ä¼ å…¥å‚æ•°è¿›è¡Œæ§åˆ¶çš„è¯å°±å¯ä»¥å°‘å†™å¤§é‡é‡å¤çš„ä»£ç ã€‚ ç¼–å†™é‡å¤çš„ä»£ç æ˜¯æµªè´¹æ—¶é—´ï¼Œè€Œä¸”å¾€å¾€æ„å‘³ç€ä½ åœ¨åšä¸€ä»¶è ¢äº‹ï¼Œgoogleçš„å·¥ç¨‹å¸ˆä»¬å½“ç„¶æ—©å°±æ³¨æ„åˆ°äº†è¿™ä¸€ç‚¹ã€‚è™½ç„¶æµ‹è¯•ç”¨ä¾‹åªèƒ½æ¥å—ä¸€ä¸ªbenchmark::State\u0026ç±»å‹çš„å‚æ•°ï¼Œä½†æˆ‘ä»¬å¯ä»¥å°†å‚æ•°ä¼ é€’ç»™stateå¯¹è±¡ï¼Œç„¶ååœ¨æµ‹è¯•ç”¨ä¾‹ä¸­è·å–ï¼š static void bench_array_ring_insert_int(benchmark::State\u0026 state) { auto length = state.range(0); auto ring = ArrayRing\u003cint\u003e(length); for (auto _: state) { for (int i = 1; i \u003c= length; ++i) { ring.insert(i); } state.PauseTiming(); ring.clear(); state.ResumeTiming(); } } BENCHMARK(bench_array_ring_insert_int)-\u003eArg(10); ä¸Šé¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä¼ é€’å’Œè·å–å‚æ•°ï¼š ä¼ é€’å‚æ•°ä½¿ç”¨BENCHMARKå®ç”Ÿæˆçš„å¯¹è±¡çš„Argæ–¹æ³• ä¼ é€’è¿›æ¥çš„å‚æ•°ä¼šè¢«æ”¾å…¥stateå¯¹è±¡å†…éƒ¨å­˜å‚¨ï¼Œé€šè¿‡rangeæ–¹æ³•è·å–ï¼Œè°ƒç”¨æ—¶çš„å‚æ•°0æ˜¯ä¼ å…¥å‚æ•°çš„éœ€è¦ï¼Œå¯¹åº”ç¬¬ä¸€ä¸ªå‚æ•° Argæ–¹æ³•ä¸€æ¬¡åªèƒ½ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œé‚£å¦‚æœä¸€æ¬¡æƒ³è¦ä¼ é€’å¤šä¸ªå‚æ•°å‘¢ï¼Ÿä¹Ÿå¾ˆç®€å•ï¼š static void bench_array_ring_insert_int(benchmark::State\u0026 state) { auto ring = ArrayRing\u003cint\u003e(state.range(0)); for (auto _: state) { for (int i = 1; i \u003c= state.range(1); ++i) { ring.insert(i); } state.PauseTiming(); ring.clear(); state.ResumeTiming(); } } BENCHMARK(bench_array_ring_insert_int)-\u003eArgs({10, 10}); ä¸Šé¢çš„ä¾‹å­æ²¡ä»€ä¹ˆå®é™…æ„ä¹‰ï¼Œåªæ˜¯ä¸ºäº†å±•ç¤ºå¦‚ä½•ä¼ é€’å¤šä¸ªå‚æ•°ï¼ŒArgsæ–¹æ³•æ¥å—ä¸€ä¸ªvectorå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨c++11æä¾›çš„å¤§æ‹¬å·åˆå§‹åŒ–å™¨ç®€åŒ–ä»£ç ï¼Œè·å–å‚æ•°ä¾ç„¶é€šè¿‡state.rangeæ–¹æ³•ï¼Œ1å¯¹åº”ä¼ é€’è¿›æ¥çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚ æœ‰ä¸€ç‚¹å€¼å¾—æ³¨æ„ï¼Œå‚æ•°ä¼ é€’åªèƒ½æ¥å—æ•´æ•°ï¼Œå¦‚æœä½ å¸Œæœ›ä½¿ç”¨å…¶ä»–ç±»å‹çš„é™„åŠ å‚æ•°ï¼Œå°±éœ€è¦å¦å¤–æƒ³äº›åŠæ³•äº†ã€‚ ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:3:2","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"2.3 ç®€åŒ–å¤šä¸ªç±»ä¼¼æµ‹è¯•ç”¨ä¾‹çš„ç”ŸæˆåŠŸ å‘æµ‹è¯•ç”¨ä¾‹ä¼ é€’å‚æ•°çš„æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†åœ¨ä¸ç¼–å†™é‡å¤ä»£ç çš„æƒ…å†µä¸‹ç”Ÿæˆå¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œåœ¨çŸ¥é“äº†å¦‚ä½•ä¼ é€’å‚æ•°åä½ å¯èƒ½ä¼šè¿™ä¹ˆå†™ï¼š static void bench_array_ring_insert_int(benchmark::State\u0026 state) { auto length = state.range(0); auto ring = ArrayRing\u003cint\u003e(length); for (auto _: state) { for (int i = 1; i \u003c= length; ++i) { ring.insert(i); } state.PauseTiming(); ring.clear(); state.ResumeTiming(); } } // ä¸‹é¢æˆ‘ä»¬ç”Ÿæˆæµ‹è¯•æ’å…¥10ï¼Œ100ï¼Œ1000æ¬¡çš„æµ‹è¯•ç”¨ä¾‹ BENCHMARK(bench_array_ring_insert_int)-\u003eArg(10); BENCHMARK(bench_array_ring_insert_int)-\u003eArg(100); BENCHMARK(bench_array_ring_insert_int)-\u003eArg(1000); 2024-01-20T15:56:26+08:00 Running ./benchmark_example_two Run on (4 X 3700 MHz CPU s) CPU Caches: L1 Data 32 KiB (x4) L1 Instruction 32 KiB (x4) L2 Unified 256 KiB (x4) L3 Unified 8192 KiB (x1) Load Average: 0.36, 0.64, 0.82 ***WARNING*** CPU scaling is enabled, the benchmark real time measurements may be noisy and will incur extra overhead. -------------------------------------------------------------------------------- Benchmark Time CPU Iterations ---------------------------------------------------------------------------------- bench_array_ring_insert_int/10 584 ns 547 ns 1000000 bench_array_ring_insert_int/100 1357 ns 1367 ns 560000 bench_array_ring_insert_int/1000 9207 ns 9521 ns 64000 ä»¥ä¸Šçš„ä»£ç è™½ç„¶ç»“æœæ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯ä»ç„¶å†™äº†å¾ˆå¤šé‡å¤ä»£ç ï¼ å¹¸å¥½Argå’ŒArgsä¼šå°†æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹ä½¿ç”¨çš„å‚æ•°è¿›è¡Œæ³¨å†Œä»¥ä¾¿äº§ç”Ÿç”¨ä¾‹å/å‚æ•°çš„æ–°æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªæŒ‡å‘BENCHMARKå®ç”Ÿæˆå¯¹è±¡çš„æŒ‡é’ˆï¼Œæ¢å¥è¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ç”Ÿæˆä»…ä»…æ˜¯å‚æ•°ä¸åŒçš„å¤šä¸ªæµ‹è¯•çš„è¯ï¼Œåªéœ€è¦é“¾å¼è°ƒç”¨Argå’ŒArgså³å¯ï¼š BENCHMARK(bench_array_ring_insert_int)-\u003eArg(10)-\u003eArg(100)-\u003eArg(1000); ç»“æœå’Œä¸Šé¢ä¸€æ ·ã€‚ ä½†è¿™è¿˜ä¸æ˜¯æœ€ä¼˜è§£ï¼Œæˆ‘ä»¬ä»ç„¶é‡å¤è°ƒç”¨äº†Argæ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ›´å¤šç”¨ä¾‹æ—¶å°±ä¸å¾—ä¸åˆè¦åšé‡å¤åŠ³åŠ¨äº†ã€‚ å¯¹æ­¤google benchmarkä¹Ÿæœ‰è§£å†³åŠæ³•ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Rangeæ–¹æ³•æ¥è‡ªåŠ¨ç”Ÿæˆä¸€å®šèŒƒå›´å†…çš„å‚æ•°ã€‚ å…ˆçœ‹çœ‹Rangeçš„åŸå‹ï¼š BENCHMAEK(func)-\u003eRange(int64_t start, int64_t limit); startè¡¨ç¤ºå‚æ•°èŒƒå›´èµ·å§‹çš„å€¼ï¼Œlimitè¡¨ç¤ºèŒƒå›´ç»“æŸçš„å€¼ï¼ŒRangeæ‰€ä½œç”¨äºçš„æ˜¯ä¸€ä¸ª_é—­åŒºé—´_ã€‚ ä½†æ˜¯å¦‚æœæˆ‘ä»¬è¿™æ ·æ”¹å†™ä»£ç ï¼Œæ˜¯ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯çš„æµ‹è¯•ç»“æœ: BENCHMARK(bench_array_ring_insert_int)-\u003eRange(10, 1000); -------------------------------------------------------------------------------- Benchmark Time CPU Iterations ---------------------------------------------------------------------------------- bench_array_ring_insert_int/10 584 ns 625 ns 1000000 bench_array_ring_insert_int/64 1042 ns 1029 ns 896000 bench_array_ring_insert_int/512 4948 ns 5313 ns 100000 bench_array_ring_insert_int/1000 9221 ns 8545 ns 89600 ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿé‚£æ˜¯å› ä¸ºRangeé»˜è®¤é™¤äº†startå’Œlimitï¼Œä¸­é—´çš„å…¶ä½™å‚æ•°éƒ½ä¼šæ˜¯æŸä¸€ä¸ªåŸºåº•ï¼ˆbaseï¼‰çš„å¹‚ï¼ŒåŸºåœ°é»˜è®¤ä¸º8ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šçœ‹åˆ°64å’Œ512ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯8çš„å¹³æ–¹å’Œç«‹æ–¹ã€‚ æƒ³è¦æ”¹å˜è¿™ä¸€è¡Œä¸ºä¹Ÿå¾ˆç®€å•ï¼Œåªè¦é‡æ–°è®¾ç½®åŸºåº•å³å¯ï¼Œé€šè¿‡ä½¿ç”¨RangeMultiplieræ–¹æ³•ï¼š BENCHMARK(bench_array_ring_insert_int)-\u003eRangeMultiplier(10)-\u003eRange(10, 1000); ç°åœ¨ç»“æœæ¢å¤å¦‚åˆäº†ã€‚ ä½¿ç”¨Rangeså¯ä»¥å¤„ç†å¤šä¸ªå‚æ•°çš„æƒ…å†µï¼š BENCHMARK(func)-\u003eRangeMultiplier(10)-\u003eRanges({{10, 1000}, {128ï¼Œ 256}}); ç¬¬ä¸€ä¸ªèŒƒå›´æŒ‡å®šäº†æµ‹è¯•ç”¨ä¾‹çš„ç¬¬ä¸€ä¸ªä¼ å…¥å‚æ•°çš„èŒƒå›´ï¼Œè€Œç¬¬äºŒä¸ªèŒƒå›´æŒ‡å®šäº†ç¬¬äºŒä¸ªä¼ å…¥å‚æ•°å¯èƒ½çš„å€¼ï¼ˆæ³¨æ„è¿™é‡Œä¸æ˜¯èŒƒå›´äº†ï¼‰ã€‚ ä¸ä¸‹é¢çš„ä»£ç ç­‰ä»·ï¼š BENCHMARK(func)-\u003eArgs({10, 128}) -\u003eArgs({100, 128}) -\u003eArgs({1000, 128}) -\u003eArgs({10, 256}) -\u003eArgs({100, 256}) -\u003eArgs({1000, 256}) å®é™…ä¸Šå°±æ˜¯ç”¨ç”Ÿæˆçš„ç¬¬ä¸€ä¸ªå‚æ•°çš„èŒƒå›´äºåé¢æŒ‡å®šå†…å®¹çš„å‚æ•°åšäº†ä¸€ä¸ªç¬›å¡å°”ç§¯ã€‚ ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:3:3","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"2.4 ä½¿ç”¨å‚æ•°ç”Ÿæˆå™¨ å¦‚æœæˆ‘æƒ³å®šåˆ¶æ²¡æœ‰è§„å¾‹çš„æ›´å¤æ‚çš„å‚æ•°å‘¢ï¼Ÿè¿™æ—¶å°±éœ€è¦å®ç°è‡ªå®šä¹‰çš„å‚æ•°ç”Ÿæˆå™¨äº†ã€‚ ä¸€ä¸ªå‚æ•°ç”Ÿæˆå™¨çš„ç­¾åå¦‚ä¸‹ï¼š void CustomArguments(benchmark::internal::Benchmark* b); æˆ‘ä»¬åœ¨ç”Ÿæˆå™¨ä¸­è®¡ç®—å¤„å‚æ•°ï¼Œç„¶åè°ƒç”¨benchmark::internal::Benchmarkå¯¹è±¡çš„Argæˆ–Argsæ–¹æ³•åƒä¸Šä¸¤èŠ‚é‚£æ ·ä¼ å…¥å‚æ•°å³å¯ã€‚ éšåæˆ‘ä»¬ä½¿ç”¨Applyæ–¹æ³•æŠŠç”Ÿæˆå™¨åº”ç”¨åˆ°æµ‹è¯•ç”¨ä¾‹ä¸Šï¼š BENCHMARK(func)-\u003eApply(CustomArguments); å…¶å®è¿™ä¸€è¿‡ç¨‹çš„åŸç†å¹¶ä¸å¤æ‚ï¼Œæˆ‘åšä¸ªç®€å•çš„è§£é‡Šï¼š BENCHMARKå®äº§ç”Ÿçš„å°±æ˜¯ä¸€ä¸ªbenchmark::internal::Benchmarkå¯¹è±¡ç„¶åè¿”å›äº†å®ƒçš„æŒ‡é’ˆ å‘benchmark::internal::Benchmarkå¯¹è±¡ä¼ é€’å‚æ•°éœ€è¦ä½¿ç”¨Argå’ŒArgsç­‰æ–¹æ³• Applyæ–¹æ³•ä¼šå°†å‚æ•°ä¸­çš„å‡½æ•°åº”ç”¨åœ¨è‡ªèº« æˆ‘ä»¬åœ¨ç”Ÿæˆå™¨é‡Œä½¿ç”¨benchmark::internal::Benchmarkå¯¹è±¡çš„æŒ‡é’ˆbçš„Argsç­‰æ–¹æ³•ä¼ é€’å‚æ•°ï¼Œè¿™æ—¶çš„bå…¶å®æŒ‡å‘æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹ åˆ°æ­¤ä¸ºæ­¢ç”Ÿæˆå™¨æ˜¯å¦‚ä½•å·¥ä½œçš„å·²ç»ä¸€ç›®äº†ç„¶äº†ï¼Œå½“ç„¶ä»ä¸Šé¢å¾—å‡ºçš„ç»“è®ºï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®©Applyåšæ›´å¤šçš„äº‹æƒ…ã€‚ ä¸‹é¢çœ‹ä¸‹Applyçš„å…·ä½“ä½¿ç”¨ï¼š // è¿™æ¬¡æˆ‘ä»¬ç”Ÿæˆ100ï¼Œ200ï¼Œ...ï¼Œ1000çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç”¨rangeæ˜¯æ— æ³•ç”Ÿæˆè¿™äº›å‚æ•°çš„ static void custom_args(benchmark::internal::Benchmark* b) { for (int i = 100; i \u003c= 1000; i += 100) { b-\u003eArg(i); } } BENCHMARK(bench_array_ring_insert_int)-\u003eRangeMultiplier(10)-\u003eApply(custom_args); ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:3:4","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"2.5 æ¨¡æ¿ç±»çš„è°ƒç”¨æµ‹è¯• å¦‚æœé’ˆå¯¹æ¯ä¸€ç§æƒ…å†µå†™æµ‹è¯•å‡½æ•°ï¼Œæ˜¾ç„¶è¿åäº†DRYåŸåˆ™ï¼Œå› ä¸ºé™¤äº†vectorçš„ç±»å‹å‚æ•°ä¸åŒï¼Œå…¶ä»–ä»£ç å‡ ä¹æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ #include \u003cbenchmark/benchmark.h\u003e #include \u003cvector\u003e #include \u003carray\u003e template \u003ctypename T, std::size_t length, bool is_reserve = true\u003e void bench_vector_reserve(benchmark::State\u0026 state) { for (auto _ : state) { std::vector\u003cT\u003e container; if constexpr (is_reserve) { container.reserve(length); } for (std::size_t i = 0; i \u003c length; ++i) { container.push_back(T{}); } } } // BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, 100); // // benchmarkçš„ä¸»å‡½æ•° // BENCHMARK_MAIN(); éå¸¸çš„ç®€å•ï¼Œæˆ‘ä»¬é€šè¿‡lengthæ§åˆ¶æ’å…¥çš„å…ƒç´ ä¸ªæ•°ï¼›is_reserveåˆ™è´Ÿè´£æ§åˆ¶æ˜¯å¦é¢„åˆ†é…å†…å­˜ï¼Œé€šè¿‡if constexprå¯ä»¥ç”Ÿæˆreserveå’Œä¸è¿›è¡Œä»»ä½•æ“ä½œçš„ä¸¤ç§ä»£ç ï¼ˆå¦‚æœä¸ç†Ÿæ‚‰c++17çš„if constexprï¼Œæ¨èèŠ±ä¸¤åˆ†é’Ÿçœ‹çœ‹è¿™é‡Œï¼‰ã€‚ ç„¶åæˆ‘ä»¬åƒå¾€å¸¸ä¸€æ ·å®šä¹‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š BENCHMARK(bench_vector_reserve\u003cstd::string,100\u003e); å¯æ˜¯ç­‰æˆ‘ä»¬ç¼–è¯‘çš„æ—¶å€™å´æŠ¥é”™äº†ï¼ $ g++ test.cpp -lpthread -lbenchmark -lbenchmark_main test.cpp:19:48: é”™è¯¯ï¼šå®â€œBENCHMARKâ€ä¼ é€’äº† 2 ä¸ªå‚æ•°ï¼Œä½†åªéœ€è¦ 1 ä¸ª 19 | BENCHMARK(bench_vector_reserve\u003cstd::string,100\u003e); | ^ In file included from a.cpp:1: /usr/local/include/benchmark/benchmark.h:1146: é™„æ³¨ï¼šmacro \"BENCHMARK\" defined here 1146 | #define BENCHMARK(n) \\ | test.cpp:19:1: é”™è¯¯ï¼šâ€˜BENCHMARKâ€™ä¸æ˜¯ä¸€ä¸ªç±»å‹å 19 | BENCHMARK(bench_vector_reserve\u003cstd::string,100\u003e); åŸå› æ˜¯è¿™æ ·çš„ï¼Œåœ¨ç¼–è¯‘å™¨å¤„ç†å®çš„æ—¶å€™å®é™…ä¸Šä¸ä¼šè€ƒè™‘c++è¯­æ³•ï¼Œæ‰€ä»¥åˆ†å‰²æ¨¡æ¿å‚æ•°çš„é€—å·è¢«è¯†åˆ«æˆäº†åˆ†å‰²å®å‚æ•°çš„é€—å·ï¼Œå› æ­¤åœ¨å®å¤„ç†å™¨çš„çœ¼é‡Œæˆ‘ä»¬åƒæ˜¯ä¼ äº†ä¸¤ä¸ªå‚æ•°ã€‚è¿™ä¹Ÿè¯´æ˜äº†BENCHMARKæ˜¯å¤„ç†ä¸äº†æ¨¡æ¿çš„ã€‚ ä¸è¿‡åˆ«æ‹…å¿ƒï¼ŒGoogleæ—©å°±æƒ³åˆ°è¿™ç§æƒ…å†µäº†ï¼Œæ‰€ä»¥æä¾›äº†BENCHMARK_TEMPLATEå®ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæ¨¡æ¿åå­—å’Œéœ€è¦çš„ç±»å‹å‚æ•°ä¾æ¬¡ä¼ ç»™å®å³å¯ï¼š BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, 100); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, 1000); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, 10000); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, 100000); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, 100, false); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, 1000, false); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, 10000, false); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, 100000, false); è¾“å‡º: 2024-01-20T19:12:57+08:00 Running ./benchmark_template Run on (4 X 3700 MHz CPU s) CPU Caches: L1 Data 32 KiB (x4) L1 Instruction 32 KiB (x4) L2 Unified 256 KiB (x4) L3 Unified 8192 KiB (x1) Load Average: 1.67, 1.82, 1.39 ***WARNING*** CPU scaling is enabled, the benchmark real time measurements may be noisy and will incur extra overhead. ------------------------------------------------------------------------------------------- Benchmark Time CPU Iterations ------------------------------------------------------------------------------------------- bench_vector_reserve\u003cstd::string, 100\u003e 2912 ns 2910 ns 239967 bench_vector_reserve\u003cstd::string, 1000\u003e 27585 ns 27571 ns 25299 bench_vector_reserve\u003cstd::string, 10000\u003e 275549 ns 275527 ns 2534 bench_vector_reserve\u003cstd::string, 100000\u003e 3158585 ns 2818440 ns 253 bench_vector_reserve\u003cstd::string, 100, false\u003e 7743 ns 7635 ns 89883 bench_vector_reserve\u003cstd::string, 1000, false\u003e 54695 ns 54663 ns 12540 bench_vector_reserve\u003cstd::string, 10000, false\u003e 671379 ns 671340 ns 1050 bench_vector_reserve\u003cstd::string, 100000, false\u003e 8904492 ns 8903935 ns 79 ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:3:5","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"2.6 å®šåˆ¶æµ‹è¯•å‚æ•° åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œlengthå‚æ•°å…¶å®æ˜¯ä¸å¿…è¦çš„ï¼Œæ‰€ä»¥ä»£ç å¯ä»¥è¿™æ ·æ”¹ï¼š template \u003ctypename T, bool is_reserve = true\u003e void bench_vector_reserve(benchmark::State\u0026 state) { for (auto _ : state) { std::vector\u003cT\u003e container; if constexpr (is_reserve) { // é€šè¿‡rangeæ–¹æ³•è·å–ä¼ å…¥çš„å‚æ•° container.reserve(state.range(0)); } for (std::size_t i = 0; i \u003c state.range(0); ++i) { container.push_back(T{}); } } } BENCHMARK_TEMPLATE(bench_vector_reserve, std::string)-\u003eRangeMultiplier(10)-\u003eRange(10, 10000 * 10); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, false)-\u003eRangeMultiplier(10)-\u003eRange(10, 10000 * 10); ç°åœ¨æˆ‘ä»¬æµ‹è¯•çš„å…ƒç´ æ•°é‡æ˜¯[10, 100, 1000, 10^4, 10^5]ã€‚ é™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¦ä¸€ç§å«â€œå¯†é›†å‚æ•°â€çš„Rangesã€‚google benchmarkæä¾›äº†DenseRangeæ–¹æ³•ã€‚ è¿™ä¸ªæ–¹æ³•çš„åŸå‹å¦‚ä¸‹ï¼š DenseRange(int64_t start, int64_t end, int64_t step); Rangesæ˜¯ç´¯ä¹˜ï¼Œè€ŒDenseRangeæ˜¯ç´¯åŠ ï¼Œå› ä¸ºç´¯ä¹˜ä¼šå¯¼è‡´å‡ ä½•çº§æ•°çš„å¢é•¿ï¼Œåœ¨æ•°è½´ä¸Šçš„åˆ†å¸ƒè¶Šæ¥è¶Šç¨€ç–ï¼Œç´¯åŠ åˆ™çœ‹ä¸Šå»åƒæ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼Œå› æ­¤ç´¯åŠ çš„å‚æ•°ç”Ÿæˆå™¨è¢«å«åšå¯†é›†å‚æ•°ç”Ÿæˆå™¨ã€‚ å¦‚æœæˆ‘ä»¬æŠŠæµ‹è¯•ç”¨ä¾‹è¿™ä¹ˆæ”¹ï¼š BENCHMARK_TEMPLATE(bench_vector_reserve, std::string)-\u003eDenseRange(1000, 100 * 100, 1000); ç°åœ¨æˆ‘ä»¬çš„lengthå°±æ˜¯è¿™æ ·ä¸€ä¸ªåºåˆ—ï¼š[1000ï¼Œ2000ï¼Œ3000ï¼Œ ...ï¼Œ9000ï¼Œ10000]ã€‚ å…³äºè‡ªå®šä¹‰å‚æ•°æœ€åä¸€ä¸ªçŸ¥è¯†ç‚¹æ˜¯ArgsProductã€‚çœ‹åå­—å°±çŸ¥é“è¿™æ˜¯ä¸€ä¸ªå‚æ•°å·¥å‚ã€‚ ArgsProduct(const std::vector\u003c std::vector\u003cint64_t\u003e \u003e\u0026 arglists); std::vector\u003cint64_t\u003eå®é™…ä¸Šå°±æ˜¯ä¸€ç»„å‚æ•°ï¼Œarglistså°±æ˜¯å¤šç»„å‚æ•°çš„åˆé›†ï¼Œä»–ä»¬ä¹‹é—´ä¼šè¢«æ±‚ç¬›å¡å°”ç§¯ï¼Œä¸¾ä¸ªä¾‹å­ï¼š BENCHMARK(BM_test)-\u003eArgsProduct({ {\"a\", \"b\", \"c\", \"d\"}, {1, 2, 3, 4} }); // ç­‰ä»·äºä¸‹é¢çš„ BENCHMARK(BM_test)-\u003eArgs({\"a\", 1}) -\u003eArgs({\"a\", 2}) -\u003eArgs({\"a\", 3}) -\u003eArgs({\"a\", 4}) -\u003eArgs({\"b\", 1}) -\u003eArgs({\"b\", 2}) -\u003eArgs({\"b\", 3}) ... -\u003eArgs({\"d\", 3}) -\u003eArgs({\"d\", 4}) ``` æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‚æ•°å·¥å‚å…¶å®å¾—è‡ªå·±æ‰‹å†™æ‰€æœ‰å‚æ•°ï¼Œé‚£å¦‚æœæˆ‘æƒ³é…åˆå·¥å‚ä½¿ç”¨Rangeså‘¢ï¼Ÿ æ²¡é—®é¢˜ï¼Œbenchmarkçš„å¼€å‘è€…ä»¬æ—©å°±æƒ³åˆ°äº†ï¼Œæ‰€ä»¥æä¾›äº†ä¸‹é¢è¿™äº›å¸®åŠ©å‡½æ•°ï¼š benchmark::CreateRange(8, 128, /*multi=*/2) // ç”Ÿæˆï¼š[8, 16, 32, 64, 128] benchmark::CreateDenseRange(1, 6, /*step=*/1) // ç”Ÿæˆï¼š[1, 2, 3, 4, 5, 6] å¦‚æœæ¢æˆæˆ‘ä»¬çš„ä¾‹å­ï¼Œå°±å¯ä»¥è¿™æ ·å†™ï¼š BENCHMARK_TEMPLATE(bench_vector_reserve, std::string)-\u003eArgsProduct({ benchmark::CreateRange(10, 10000*10, 10) }); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, false)-\u003eArgsProduct({ benchmark::CreateRange(10, 10000*10, 10) }); å€ŸåŠ©ä»…ä»…ä¸¤è¡Œä»£ç æˆ‘ä»¬å°±èƒ½ç”Ÿæˆæ•°é‡å¯è§‚çš„æµ‹è¯•ç”¨ä¾‹ï¼š 2024-01-20T19:26:55+08:00 Running ./bm_template_2 Run on (4 X 3700 MHz CPU s) CPU Caches: L1 Data 32 KiB (x4) L1 Instruction 32 KiB (x4) L2 Unified 256 KiB (x4) L3 Unified 8192 KiB (x1) Load Average: 1.91, 2.05, 1.65 ***WARNING*** CPU scaling is enabled, the benchmark real time measurements may be noisy and will incur extra overhead. ------------------------------------------------------------------------------------------ Benchmark Time CPU Iterations ------------------------------------------------------------------------------------------ bench_vector_reserve\u003cstd::string\u003e/10 466 ns 466 ns 1505218 bench_vector_reserve\u003cstd::string\u003e/100 3549 ns 3548 ns 200461 bench_vector_reserve\u003cstd::string\u003e/1000 34067 ns 34049 ns 20858 bench_vector_reserve\u003cstd::string\u003e/10000 324499 ns 324370 ns 2125 bench_vector_reserve\u003cstd::string\u003e/100000 3229254 ns 3227361 ns 219 bench_vector_reserve\u003cstd::string, false\u003e/10 1604 ns 1603 ns 436414 bench_vector_reserve\u003cstd::string, false\u003e/100 7707 ns 7705 ns 89743 bench_vector_reserve\u003cstd::string, false\u003e/1000 57709 ns 57694 ns 12026 bench_vector_reserve\u003cstd::string, false\u003e/10000 688582 ns 688283 ns 1008 bench_vector_reserve\u003cstd::string, false\u003e/100000 9208480 ns 9205775 ns 75 å½“ç„¶ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç±»å‹å‚æ•°ï¼Œå®é™…ä¸Šæˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸¤ä¸ªç±»å‹éœ€è¦æµ‹è¯•ã€‚å¦å¤–è¿™æ˜¯1.5.5æ–°å¢çš„åŠŸèƒ½ï¼Œå¦‚æœä½ æƒ³å°é²œå¾—å…ˆå‡çº§google benchmarkã€‚ é€šå¸¸åšåˆ°ä¸Šé¢é‚£ä¸€æ­¥å°±è¶³å¤Ÿäº†ï¼Œç„¶è€Œåœ¨è¿™é‡Œæˆ‘ä»¬è¿˜æœ‰ä¼˜åŒ–ç©ºé—´ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬æŠŠå…¶ä»–ä¸¤ä¸ªæµ‹è¯•ç”¨çš„ç±»å‹åŠ ä¸Šï¼Œä»£ç æ˜¯è¿™æ ·çš„ï¼ŒMyClassçš„å®šä¹‰åé¢ä¼šç»™å‡ºï¼š BENCHMARK_TEMPLATE(bench_vector_reserve, std::string)-\u003eArgsProduct({ benchmark::CreateRange(10, 10000*10, 10) }); BENCHMARK_TEMPLATE(bench_vector_reserve, std::string, false)-\u003eArgsProduct({ benchmark::CreateRange(10, 10000*10, 10) }); BENCHMARK_TEMPLATE(bench_vector_reserve, std::size_t)-\u003eArgsProduct({ benchmark::CreateRange(10, 10000*10, 10) }); BENCHMARK_TEMPLATE(bench_vector_reserve, std::size_t, false)-\u003eArgsProduct({ benchmark::CreateRange(10, 10000*10, 10) }); BENCHMARK_TEMPLATE(bench_vector_reserve, MyClass)-\u003eArgsProduct({ benchmark::CreateRange(10, 10000*10, 10) }); BENCHMARK_TEMPLATE(bench_vector_reserve, MyClass, false)-\u003eArgsProduct({ benchmark::CreateRange(10, 10000*10, 10) }); ä½ çœ‹è§äº†ä»€ä¹ˆï¼Ÿæ²¡é”™ï¼Œé‡å¤é‡å¤é‡å¤ï¼æˆ‘ä»¬åˆè¿èƒŒäº†DRYåŸåˆ™ã€‚ ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:3:6","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"2.7. ä½¿ç”¨Benchmarkæ¥å£ è¿™é‡Œå°†å¾…æµ‹è¯•çš„å‡½æ•°æ³¨å†Œä¸ºä¸€ä¸ªåŸºå‡†æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶æŒ‡å®šæµ‹è¯•ç”¨ä¾‹çš„åç§°å’Œå‚æ•°ã€‚è¯¥ä»£ç ä¸­ä½¿ç”¨äº†ä¸‰ç§ä¸åŒçš„æ³¨å†Œæ–¹å¼ï¼šå‡½æ•°æŒ‡é’ˆã€Lambda å‡½æ•°å’Œå¸¦å‚æ•°çš„å‡½æ•°æŒ‡é’ˆã€‚æœ€åï¼Œä½¿ç”¨ benchmark::RunSpecifiedBenchmarks å‡½æ•°è¿è¡Œæ‰€æœ‰æ³¨å†Œçš„åŸºå‡†æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶ä½¿ç”¨ benchmark::Shutdown å‡½æ•°é‡Šæ”¾èµ„æºã€‚ #include \u003cbenchmark/benchmark.h\u003e #include \u003cchrono\u003e #include \u003cthread\u003e void BM_DemoSleep(benchmark::State\u0026 state) { for (auto _ : state){ std::this_thread::sleep_for(std::chrono::nanoseconds(1000)); //å¾…æµ‹è¯•çš„ä»£ç  } } void BM_DemoSleep1(benchmark::State\u0026 state, int id) { std::cout \u003c\u003c \"id:\"\u003c\u003c id \u003c\u003c std::endl; for (auto _ : state){ std::this_thread::sleep_for(std::chrono::nanoseconds(1000)); } } int main(int argc, char** argv) { benchmark::Initialize(\u0026argc, argv); // åˆå§‹åŒ–Benchmark if (benchmark::ReportUnrecognizedArguments(argc, argv)) return 1; // ä½¿ç”¨å‡½æ•°æŒ‡é’ˆæ³¨å†Œ benchmark::RegisterBenchmark(\"BM_DemoSleep\", \u0026BM_DemoSleep); // ä½¿ç”¨Lambaå‡½æ•°æ³¨å†Œ benchmark::RegisterBenchmark(\"BM_DemoSleep1\", [](benchmark::State\u0026 state){ for (auto _ : state){ std::this_thread::sleep_for(std::chrono::nanoseconds(1000)); } }); // ä½¿ç”¨å¸¦å‚æ•°çš„å‡½æ•°æŒ‡é’ˆæ³¨å†Œ int id = 10; benchmark::RegisterBenchmark(\"BM_DemoSleep2\", \u0026BM_DemoSleep1, id); benchmark::RunSpecifiedBenchmarks(); // è¿è¡Œ benchmark::Shutdown(); } ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:3:7","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"3. Ref: [1]. https://mp.weixin.qq.com/s/hrKwlKj6i2twd_qNqaHyYg [2]. Google Benchmark ç”¨æˆ·æ‰‹å†Œ [3]. https://www.cnblogs.com/apocelipes/p/10348925.html ","date":"2024-01-19","objectID":"/posts/google_benchmark_introduction/:4:0","tags":["Google Benchmark"],"title":"Google Benchmark æ€§èƒ½æµ‹è¯•åˆ†æå·¥å…·","uri":"/posts/google_benchmark_introduction/"},{"categories":["C++"],"content":"å››ã€C++ 20æ–°å¢ç‰¹æ€§ ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.1 æ–°å¢å…³é”®å­— concept(è§ä¸‹æ–‡) requires std::require æ˜¯ä¸€ä¸ªconstexpr å‡½æ•°æ¨¡æ¿ï¼Œç”¨äºåœ¨ç¼–è¯‘æ—¶æ£€æŸ¥æŸä¸ªè¡¨è¾¾å¼çš„çœŸå‡å€¼ã€‚å¦‚æœè¡¨è¾¾å¼ä¸ºçœŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæ— æ„ä¹‰çš„ç±»å‹ void_tï¼›å¦åˆ™ç¼–è¯‘ä¼šå¤±è´¥ï¼Œå‡ºç°ç›¸åº”çš„é”™è¯¯ä¿¡æ¯ consteval ç”¨æ¥ä¿®é¥°å‡½æ•°æ—¶å¸¸é‡å€¼çš„è¡¨è¾¾å¼ï¼Œè€Œä¸”æ˜¯å¼ºåˆ¶æ€§çš„ã€‚å¦‚æœå‡½æ•°æœ¬èº«ä¸æ˜¯å¸¸é‡å€¼çš„è¡¨è¾¾å¼çš„è¯åˆ™ä¼šç¼–è¯‘å¤±è´¥ co_await(åç¨‹ç›¸å…³) co_return(åç¨‹ç›¸å…³) co_yield(åç¨‹ç›¸å…³) char8_t ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:1","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.2 æ–°å¢æ ‡è¯†ç¬¦ import module æ¨¡å— ä¼˜ç‚¹ æ²¡æœ‰å¤´æ–‡ä»¶ å£°æ˜å®ç°ä»ç„¶å¯åˆ†ç¦», ä½†éå¿…è¦ å¯ä»¥æ˜¾å¼æŒ‡å®šé‚£äº›å¯¼å‡º(ç±», å‡½æ•°ç­‰) ä¸éœ€è¦å¤´æ–‡ä»¶é‡å¤å¼•å…¥å® (include guards) æ¨¡å—ä¹‹é—´åç§°å¯ä»¥ç›¸åŒä¸ä¼šå†²çª æ¨¡å—åªå¤„ç†ä¸€æ¬¡, ç¼–è¯‘æ›´å¿« (å¤´æ–‡ä»¶æ¯æ¬¡å¼•å…¥éƒ½éœ€è¦å¤„ç†) é¢„å¤„ç†å®åªåœ¨æ¨¡å—å†…æœ‰æ•ˆ æ¨¡å—å¼•å…¥é¡ºåºæ— å…³ç´§è¦ åˆ›å»ºæ¨¡å— // cppcon.cpp export module cppcon; namespace CppCon { auto GetWelcomeHelper() { return \"Welcome to CppCon 2019!\"; } export auto GetWelcome() { return GetWelcomeHelper();} } å¼•ç”¨æ¨¡å— // main.cpp import cppcon; int main(){ std::cout \u003c\u003c CppCon::GetWelcome(); } ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:2","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.3 importå¤´æ–‡ä»¶ import éšå¼åœ°å°† iostream è½¬æ¢ä¸ºæ¨¡å— åŠ é€Ÿæ„å»º, å› ä¸º iostream åªä¼šå¤„ç†ä¸€æ¬¡ å’Œé¢„ç¼–è¯‘å¤´ (PCH) å…·æœ‰ç›¸ä¼¼çš„æ•ˆæœ ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:3","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.4 Ranges Range ä»£è¡¨ä¸€ä¸²å…ƒç´ , æˆ–è€…ä¸€ä¸²å…ƒç´ ä¸­çš„ä¸€æ®µï¼Œç±»ä¼¼äºbegin/end å¯¹ã€‚ å¥½å¤„ ç®€åŒ–è¯­æ³•å’Œæ–¹ä¾¿ä½¿ç”¨ é˜²æ­¢ begin/end ä¸é…å¯¹ ä½¿å˜æ¢/è¿‡æ»¤ç­‰ä¸²è”æ“ä½œæˆä¸ºå¯èƒ½ ç›¸å…³åŠŸèƒ½ è§†å›¾: å»¶è¿Ÿè®¡ç®—, ä¸æŒæœ‰, ä¸æ”¹å†™ Actions: å³æ—¶å¤„ç†, æ”¹å†™ Algorithms: æ‰€æœ‰æ¥å— begin/end å¯¹çš„ç®—æ³•éƒ½å¯ç”¨ Views å’Œ actions ä½¿ç”¨ç®¡é“ç¬¦|ä¸²è” ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:4","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.5 åç¨‹ åç¨‹å®šä¹‰æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…·å¤‡å¦‚ä¸‹å…³é”®å­—ä¹‹ä¸€: co_wait: æŒ‚èµ·åç¨‹, ç­‰å¾…å…¶å®ƒè®¡ç®—å®Œæˆ co_return: ä»åç¨‹è¿”å› (åç¨‹ return ç¦æ­¢ä½¿ç”¨) co_yield: åŒ python yield, å¼¹å‡ºä¸€ä¸ªå€¼, æŒ‚èµ·åç¨‹, ä¸‹ä¸€æ¬¡è°ƒç”¨ç»§ç»­åç¨‹çš„è¿è¡Œ for co_await å¾ªç¯ä½“ åº”ç”¨åœºæ™¯ ç®€åŒ–generator ç®€åŒ–å¼‚æ­¥I/O ç®€åŒ–å»¶è¿Ÿè®¡ç®— ç®€åŒ–äº‹ä»¶é©±åŠ¨çš„ç¨‹åº ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:5","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.6 Concepts å¯¹æ¨¡æ¿ç±»å’Œå‡½æ•°çš„æ¨¡æ¿å½¢å‚çš„çº¦æŸ ç¼–è¯‘æœŸæ–­è¨€ å¯å£°æ˜å¤šä¸ª å®šä¹‰ template\u003ctypename T\u003e concept Incrementable = requires(T x) {x++; ++x;}; ä½¿ç”¨ template\u003cIncrementable T\u003e void Foo(T t); template\u003ctypename T\u003e requires Incrementable\u003cT\u003e void Foo(T t); template\u003ctypename T\u003e void Foo(T t) requires Incrementable\u003cT\u003e; void Foo(Incrementable auto t); ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:6","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.7 Lambdaè¡¨è¾¾å¼æ›´æ–° [=, this] éœ€è¦æ˜¾å¼æ•è·thiså˜é‡ C++20 ä¹‹å‰ [=] éšå¼æ•è·this C++20 å¼€å§‹ éœ€è¦æ˜¾å¼æ•è·this: [=, this] æ¨¡æ¿å½¢å¼çš„ Lambda è¡¨è¾¾å¼ å¯ä»¥åœ¨lambdaè¡¨è¾¾å¼ä¸­ä½¿ç”¨æ¨¡æ¿è¯­æ³•: []template\u003cT\u003e(T x) {/* ... */}; []template\u003cT\u003e(T* p) {/* ... */}; []template\u003cT, int N\u003e(T (\u0026a)[N]) {/* ... */}; ä¼˜ç‚¹ C++20ä¹‹å‰: è·å– vector å…ƒç´ ç±»å‹, éœ€è¦è¿™ä¹ˆå†™ auto func = [](auto vec){ using T = typename decltype(vec)::value_type; } C++20 å¯ä»¥: auto func = []\u003ctypename T\u003e(vector\u003cT\u003e vec){ // ... } æ–¹ä¾¿è·å–é€šç”¨lambdaå½¢å‚ç±»å‹, è®¿é—®é™æ€å‡½æ•°: C++20ä¹‹å‰ï¼š auto func = [](auto const\u0026 x){ using T = std::decay_t\u003cdecltype(x)\u003e; T copy = x; T::static_function(); using Iterator = typename T::iterator; } C++20ä»¥åï¼š auto func = []\u003ctypename T\u003e(const T\u0026 x){ T copy = x; T::static_function(); using Iterator = typename T::iterator; } å®Œç¾è½¬å‘ C++20ä¹‹å‰ï¼š auto func = [](auto\u0026\u0026 ...args) { return foo(std::forward\u003cdecltype(args)\u003e(args)...); } C++20ä»¥åï¼š auto func = []\u003ctypename â€¦T\u003e(T\u0026\u0026 â€¦args){ return foo(std::forward(args)...); } Lambda è¡¨è¾¾å¼æ•è·æ”¯æŒæ‰“åŒ…å±•å¼€(Pack Expansion) C++20ä¹‹å‰ï¼š template\u003cclass F, class... Args\u003e auto delay_invoke(F f, Args... args){ return [f, args...]{ return std::invoke(f, args...); } } C++20ä»¥åï¼š template\u003cclass F, class... Args\u003e auto delay_invoke(F f, Args... args){ // Pack Expansion: args = std::move(args)... return [f = std::move(f), args = std::move(args)...](){ return std::invoke(f, args...); } } ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:7","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.8 å¸¸é‡è¡¨è¾¾å¼(constexpr)çš„æ›´æ–° constexpr è™šå‡½æ•° constexpr çš„è™šå‡½æ•°å¯ä»¥é‡å†™é constexpr çš„è™šå‡½æ•° é constexpr è™šå‡½æ•°å¯ä»¥é‡å†™ constexpr çš„è™šå‡½æ•° ä½¿ç”¨ dynamic_cast() å’Œ typeid åŠ¨æ€å†…å­˜åˆ†é… æ›´æ”¹unionæˆå‘˜çš„å€¼ åŒ…å« try/catch ä¸å…è®¸throwè¯­å¥ åœ¨è§¦å‘å¸¸é‡æ±‚å€¼çš„æ—¶å€™ try/catch ä¸å‘ç”Ÿä½œç”¨ éœ€è¦å¼€å¯ constexpr std::vector constexpr string \u0026vector std::string å’Œ std::vector ç±»å‹ç°åœ¨å¯ä»¥ä½œä¸º constexpr æœªæ¥éœ€è¦æ”¯æŒ constexpr åå°„ ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:8","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.9 åŸå­æ™ºèƒ½æŒ‡é’ˆ æ™ºèƒ½æŒ‡é’ˆ(shared_ptr)çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š å®‰å…¨: å¼•ç”¨è®¡æ•°æ§åˆ¶å•å…ƒçº¿ç¨‹å®‰å…¨, ä¿è¯å¯¹è±¡åªè¢«é‡Šæ”¾ä¸€æ¬¡ ä¸å®‰å…¨ï¼šå¯¹äºæ•°æ®çš„è¯»å†™æ²¡æœ‰çº¿ç¨‹å®‰å…¨ å°†æ™ºèƒ½æŒ‡é’ˆå˜æˆçº¿ç¨‹å®‰å…¨ï¼š ä½¿ç”¨ mutex æ§åˆ¶æ™ºèƒ½æŒ‡é’ˆçš„è®¿é—® ä½¿ç”¨å…¨å±€éæˆå‘˜åŸå­æ“ä½œå‡½æ•°è®¿é—®, è¯¸å¦‚: std::atomic_load(), atomic_store(), â€¦ C++20: atomic\u003cshared_ptr\u003cT\u003e\u003e, atomic\u003cweak_ptr\u003cT\u003e\u003eï¼š å†…éƒ¨åŸç†å¯èƒ½ä½¿ç”¨äº†mutex å…¨å±€éæˆå‘˜åŸå­æ“ä½œå‡½æ•°æ ‡è®°ä¸ºä¸æ¨èä½¿ç”¨(deprecated) ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:9","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.10 è‡ªåŠ¨åˆæµ(Joining),å¯ä¸­æ–­çš„çº¿ç¨‹ è‡ªåŠ¨åˆæµ void DoWorkPreCpp20() { std::thread job([] { /* ... */ }); try { // ... Do something else ... } catch (...) { job.join(); throw; // rethrow } job.join(); } void DoWork() { std::jthread job([] { /* ... */ }); // ... Do something else ... } // jthread destructor automatically calls join() ä¸­æ–­ std::jthread job([](std::stop_token token) { while (!token.stop_requested()) { //... } }); //... job.request_stop(); // auto source = job.get_stop_source() // auto token = job.get_stop_token() ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:10","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.11 åŒæ­¥(Synchronization)åº“ åœ¨ä¼ ç»Ÿçš„å¤šçº¿ç¨‹ï¼ˆè¿›ç¨‹ï¼‰çš„ç¼–ç¨‹ä¸­ï¼Œå¤„ç†æ•°æ®å…±äº«æ˜¯ä¸€ä¸ªé‡ä¸­ä¹‹é‡ã€‚ç›®å‰æµè¡Œçš„å¤šæ ¸ï¼ˆå¤šCPUï¼‰ç¼–ç¨‹ä¸­ï¼Œè™½ç„¶é‡‡ç”¨äº†æ›´å¤šçš„åˆ†å¸ƒå¼çš„ç®—æ³•ï¼Œä½†æœ€ç»ˆç»†åˆ†åˆ°ä¸€ä¸ªå¤„ç†å•å…ƒä¸­ï¼Œä»ç„¶æ˜¯å¤„ç†çº¿ç¨‹é—´æ•°æ®çš„æ‹†åˆ†ã€‚å³ï¼Œé€šè¿‡æ•°æ®ç»“æ„çš„è®¾è®¡å’Œç®—æ³•çš„åˆ†æ‹†ï¼Œå®ç°æœ€å°çš„æ•°æ®å†²çªç»“æœã€‚ è§£å†³å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦çš„é—®é¢˜å°±æ˜¯ å¦‚ä½•å¤„ç†æ•°æ®çš„åŒæ­¥é—®é¢˜ï¼Œå¦‚æœ‰mutex,event,conditionç­‰ç­‰ã€‚ä¹Ÿæœ‰çš„ä¼šæåˆ°c++11åçš„lockç­‰ã€‚ åœ¨c++20ä¸­å¢åŠ äº†ä»¥ä¸‹å‡ ç±»åŒæ­¥ æ•°æ®ç»“æ„: ä¿¡å·é‡(Semaphore) è½»é‡çº§çš„åŒæ­¥åŸè¯­ï¼Œå¯ä»¥å®ç° mutex, latches, barriers, â€¦ç­‰åŒæ­¥æ•°æ®ç»“æ„ã€‚ ä¸¤ç§è¡¨ç°ç±»å‹: å¤šå…ƒä¿¡å·é‡(counting semaphore): å»ºæ¨¡éè´Ÿå€¼èµ„æºè®¡æ•° äºŒå…ƒä¿¡å·é‡(binary semaphore): åªæœ‰ä¸¤ä¸ªçŠ¶æ€çš„ä¿¡å·é‡ ä¸»è¦æ–¹æ³•æœ‰ï¼š releaseï¼šå¢åŠ å†…éƒ¨è®¡æ•°å™¨å¹¶å¯¹è·å–è€…è§£é™¤é˜»å¡ acquire ï¼šå‡å°‘å†…éƒ¨è®¡æ•°å™¨æˆ–é˜»å¡åˆ°ç›´è‡³èƒ½è·å– try_acquireï¼šå°è¯•å‡å°‘å†…éƒ¨è®¡æ•°å™¨è€Œä¸é˜»å¡ try_acquire_for ï¼šå°è¯•å‡å°‘å†…éƒ¨è®¡æ•°å™¨ï¼Œè‡³å¤šé˜»å¡ä¸€æ®µæ—¶é•¿ try_acquire_untilï¼šå°è¯•å‡å°‘å†…éƒ¨è®¡æ•°å™¨ï¼Œé˜»å¡ç›´è‡³ä¸€ä¸ªæ—¶é—´ç‚¹ std::atomic ç­‰å¾…å’Œé€šçŸ¥æ¥å£ ç­‰å¾…/é˜»å¡åœ¨åŸå­å¯¹è±¡ç›´åˆ°å…¶å€¼å‘ç”Ÿæ”¹å˜, ç„¶åé€šçŸ¥å‡½æ•°å‘é€é€šçŸ¥ï¼Œå®ƒæ¯”å•çº¯çš„è‡ªæ—‹é”å’Œè½®è¯¢è¦æ•ˆç‡é«˜ã€‚ ä¸»è¦æ–¹æ³•æœ‰ï¼š waitï¼šé˜»å¡çº¿ç¨‹ç›´è‡³è¢«æé†’ä¸”åŸå­å€¼æ›´æ”¹ notify_oneï¼šæé†’è‡³å°‘ä¸€ä¸ªåœ¨åŸå­å¯¹è±¡ä¸Šçš„ç­‰å¾…ä¸­é˜»å¡çš„çº¿ç¨‹ notify_allï¼šæé†’æ‰€æœ‰åœ¨åŸå­å¯¹è±¡ä¸Šçš„ç­‰å¾…ä¸­é˜»å¡çš„çº¿ç¨‹ è¿™ä¸ªå…¶å®æ˜¯å®ç°CASçš„ï¼Œåœ¨ä»¥å‰å°±æœ‰ï¼Œåœ¨c++20ä¸­åˆå¢åŠ äº†ç›¸å…³çš„ä¸€äº›å…·ä½“çš„å®ç°ç½¢äº†ã€‚ é”å­˜å™¨(Latches) latch æ˜¯ std::ptrdiff_t ç±»å‹çš„å‘ä¸‹è®¡æ•°å™¨ï¼Œå®ƒèƒ½ç”¨äºåŒæ­¥çº¿ç¨‹ã€‚åœ¨åˆ›å»ºæ—¶åˆå§‹åŒ–è®¡æ•°å™¨çš„å€¼ã€‚çº¿ç¨‹å¯èƒ½åœ¨ latch ä¸Šé˜»å¡ç›´è‡³è®¡æ•°å™¨å‡å°‘åˆ°é›¶ã€‚æ²¡æœ‰å¯èƒ½å¢åŠ æˆ–é‡ç½®è®¡æ•°å™¨ï¼Œè¿™ä½¿å¾— latch ä¸ºå•æ¬¡ä½¿ç”¨çš„å±éšœã€‚åŒæ—¶è°ƒç”¨ latch çš„æˆå‘˜å‡½æ•°ï¼Œé™¤äº†ææ„å‡½æ•°ï¼Œä¸å¼•å…¥æ•°æ®ç«äº‰ã€‚ æ³¨æ„ï¼šå®ƒåŒºåˆ«äºä¸‹é¢çš„Barriersçš„æ˜¯å®ƒåªæœ‰ä½¿ç”¨ä¸€æ¬¡ã€‚ å±éšœ(Barriers) std::barrier æä¾›å…è®¸è‡³å¤šä¸ºæœŸå¾…æ•°é‡çš„çº¿ç¨‹é˜»å¡ç›´è‡³æœŸå¾…æ•°é‡çš„çº¿ç¨‹åˆ°è¾¾è¯¥å±éšœã€‚ä¸åŒäº std::latch ï¼Œå±éšœå¯é‡ç”¨ï¼šä¸€æ—¦åˆ°è¾¾çš„çº¿ç¨‹ä»å±éšœé˜¶æ®µçš„åŒæ­¥ç‚¹é™¤é˜»ï¼Œåˆ™å¯é‡ç”¨åŒä¸€å±éšœã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:11","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.12 std::atomic_ref std::atomic_refç±»å‹å¯¹å…¶å¼•ç”¨çš„å¯¹è±¡è¿›è¡ŒåŸå­æ“ä½œã€‚ ä½¿ç”¨std::atomic_ref è¿›è¡Œå¤šçº¿ç¨‹è¯»å†™æ—¶ä¸ä¼šé€ æˆæ•°æ®äº‰ç”¨ã€‚è¢«å¼•ç”¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå¿…é¡»è¶…è¿‡std::atomic_ref ã€‚æ“ä½œstd::atomic_ref çš„å­å¯¹è±¡æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:12","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"4.13 å…¶ä»–æ›´æ–° æŒ‡å®šåˆå§‹åŒ–(Designated Initializers) struct Data { int anInt = 0; std::string aString; }; Data d{ .aString = \"Hello\" }; ä¸‰è·¯æ¯”è¾ƒè¿ç®—ç¬¦ \u003c=\u003e // å¦‚æœ a \u003c b åˆ™ä¸º true (a \u003c=\u003e b) \u003c 0 // å¦‚æœ a \u003e b åˆ™ä¸º true (a \u003c=\u003e b) \u003e 0 // å¦‚æœ a ä¸ b ç›¸ç­‰æˆ–è€…ç­‰ä»· åˆ™ä¸º true (a \u003c=\u003e b) == 0 æ ‡å‡†åº“ç±»å‹æ”¯æŒ: vector, string, map, set, sub_match, â€¦ èŒƒå›´ for å¾ªç¯è¯­å¥æ”¯æŒåˆå§‹åŒ–è¯­å¥ switch è¯­å¥åˆå§‹åŒ– (C++17): struct Foo { int value; int result; }; Foo GetData() { return Foo(); } int main() { switch (auto data = GetData(); data.value) { case 1: return data.result; } } if è¯­å¥åˆå§‹åŒ– (C++17): struct Foo { int value; int result; }; Foo* GetData() { return new Foo(); } int main() { if (auto data = GetData(); data) { // Use 'dataâ€™ } } ç°åœ¨èŒƒå›´ for å¾ªç¯åŒæ ·æ”¯æŒåˆå§‹åŒ– (C++20): struct Foo { std::vector\u003cint\u003e values; }; Foo GetData() { return Foo(); } int main() { for (auto data = GetData(); auto\u0026 value : data.values) { // Use 'dataâ€™ } } éç±»å‹æ¨¡æ¿å½¢å‚æ”¯æŒå­—ç¬¦ä¸² template\u003cauto\u0026 s\u003e void DoSomething() { std::cout \u003c\u003c s \u003c\u003c std::endl; } int main() { DoSomething\u003c\"CppCon\"\u003e(); } [[likely]], [[unlikely]] å…ˆéªŒæ¦‚ç‡æŒ‡å¯¼ç¼–è¯‘å™¨ä¼˜åŒ– switch (value) { case 1: break; [[likely]] case 2: break; [[unlikely]] case 3: break; } æ—¥å†(Calendar)å’Œæ—¶åŒº(Timezone)åŠŸèƒ½ å¢åŠ æ—¥å†å’Œæ—¶åŒºçš„æ”¯æŒ åªæ”¯æŒå…¬å†(Gregorian calendar) å…¶ä»–æ—¥å†ä¹Ÿå¯é€šè¿‡æ‰©å±•åŠ å…¥, å¹¶èƒ½å’Œ è¿›è¡Œäº¤äº’ å…·ä½“æ“ä½œå’Œç›¸å…³ç±»å‹è¯·å‚è€ƒå…¶ä»–ç¤ºä¾‹ã€‚ std::span å®šä¹‰ï¼šæŸæ®µè¿ç»­æ•°æ®çš„â€è§†å›¾â€ ç‰¹æ€§ï¼š ä¸æŒæœ‰æ•°æ®, ä¸åˆ†é…å’Œé”€æ¯æ•°æ® æ‹·è´éå¸¸å¿«, æ¨èå¤åˆ¶çš„æ–¹å¼ä¼ å‚(ç±»ä¼¼ string_view) ä¸æ”¯æŒæ•°æ®è·¨æ­¥(stride) å¯é€šè¿‡è¿è¡ŒæœŸç¡®å®šé•¿åº¦ä¹Ÿå¯ç¼–è¯‘å™¨ç¡®å®šé•¿åº¦ // fixed-size: 42 ints int data[42]; span\u003cint, 42\u003e a {data}; // dynamic-size: 42 ints span\u003cint\u003e b {data}; // compilation error span\u003cint, 50\u003e c {data}; // dynamic-size: len ints span\u003cint\u003e d{ ptr, len }; ç‰¹æ€§æµ‹è¯•å® é€šè¿‡å®ƒå¯ä»¥åˆ¤æ–­ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒæŸä¸ªåŠŸèƒ½ã€‚ è¯­è¨€ç‰¹æ€§ï¼š __has_cpp_attribute(fallthrough) __cpp_binary_literals __cpp_char8_t __cpp_coroutines æ ‡å‡†åº“ç‰¹æ€§: __cpp_lib_concepts __cpp_lib_ranges __cpp_lib_scoped_lock åŒ…å« C++ æ ‡å‡†åº“ç‰ˆæœ¬, å‘å¸ƒæ—¥æœŸ, ç‰ˆæƒè¯ä¹¦, ç‰¹æ€§å®ç­‰ã€‚ consteval å‡½æ•° constexpr å‡½æ•°å¯èƒ½ç¼–è¯‘æœŸæ‰§è¡Œ, ä¹Ÿå¯ä»¥åœ¨è¿è¡ŒæœŸæ‰§è¡Œ consteval åªèƒ½åœ¨ç¼–è¯‘å™¨æ‰§è¡Œ, å¦‚æœä¸æ»¡è¶³è¦æ±‚ç¼–è¯‘ä¸é€šè¿‡ã€‚ constinit: å¼ºåˆ¶æŒ‡å®šä»¥å¸¸é‡æ–¹å¼åˆå§‹åŒ– const char* GetStringDyn() { return \"dynamic init\"; } constexpr const char* GetString(bool constInit) { return constInit ? \"constant init\" : GetStringDyn(); } // âœ” constinit const char* a = GetString(true); // âŒ constinit const char* b = GetString(false); ç”¨ using å¼•ç”¨ enum ç±»å‹ enum class CardTypeSuit { Clubs, Diamonds, Hearts, Spades }; std::string_view GetString(const CardTypeSuit cardTypeSuit) { switch (cardTypeSuit) { case CardTypeSuit::Clubs: return \"Clubs\"; case CardTypeSuit::Diamonds: return \"Diamonds\"; case CardTypeSuit::Hearts: return \"Hearts\"; case CardTypeSuit::Spades: return \"Spades\"; } } std::string_view GetString(const CardTypeSuit cardTypeSuit) { switch (cardTypeSuit) { using enum CardTypeSuit; case Clubs: return \"Clubs\"; case Diamonds: return \"Diamonds\"; case Hearts: return \"Hearts\"; case Spades: return \"Spades\"; } } æ ¼å¼åŒ–åº“(std::format) std::string s = std::format(\"Hello CppCon {}!\", 2019); å¢åŠ æ•°å­¦å¸¸é‡ åŒ…å« e, log2e, log10e, pi, inv_pi, inv_sqrt ln2, ln10, sqrt2, sqrt3, inv_sqrt3, egamma std::source_location ç”¨äºè·å–ä»£ç ä½ç½®, å¯¹äºæ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯å°¤å…¶æœ‰ç”¨ [[nodiscard(reason)]] è¡¨æ˜è¿”å›å€¼ä¸å¯æŠ›å¼ƒ, åŠ å…¥ç†ç”±çš„æ”¯æŒ [[nodiscard(\"Ignoring the return value will result in memory leaks.\")]] void* GetData() { /* ... */ } ä½è¿ç®— åŠ å…¥å¾ªç¯ç§»ä½, è®¡æ•°0å’Œ1ä½ç­‰åŠŸèƒ½ ä¸€äº›å°æ›´æ–° å­—ç¬¦ä¸²æ”¯æŒ starts_with, ends_with map æ”¯æŒ contains æŸ¥è¯¢æ˜¯å¦å­˜åœ¨æŸä¸ªé”® list å’Œ forward list çš„ remove, remove_if å’Œ unique æ“ä½œè¿”å› size_type è¡¨æ˜åˆ é™¤ä¸ªæ•° å¢åŠ  shift_left, shift_right midpoint è®¡ç®—ä¸­ä½æ•°, å¯é¿å…æº¢å‡º lerp çº¿æ€§æ’å€¼ lerp( float a, float b, float t ) è¿”å› æ–°çš„å‘é‡åŒ–ç­–ç•¥ unsequenced_policy(execution::unseq) std::string str = \"Hello world!\"; // starts_with, ends_with bool b = str.starts_with(\"Hello\"); std::map myMap{ std::pair{1, \"one\"s}, {2, \"two\"s}, {3, \"three\"s} }; // contains, å†ä¹Ÿä¸ç”¨ .find() == .end() äº† bool result = myMap.contains(2); ","date":"2024-01-17","objectID":"/posts/cmake_note_9/:1:13","tags":["CMake"],"title":"CMake ç¬”è®° | [9] è®¾ç½®è¯­è¨€æ ‡å‡† (ä¸‰)","uri":"/posts/cmake_note_9/"},{"categories":["C++"],"content":"ä¸‰ã€C++ 14æ–°ç‰¹æ€§ ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.1 å‡½æ•°è¿”å›å€¼ç±»å‹æ¨å¯¼ c++14å¯¹å‡½æ•°è¿”å›å€¼ç±»å‹æ¨å¯¼è§„åˆ™åšäº†ä¼˜åŒ–ï¼šç”¨autoæ¨å¯¼å‡½æ•°çš„è¿”å›å€¼ #include \u003ciostream\u003e using namespace std; auto func(int i) { return i; } int main() { cout \u003c\u003c func(4) \u003c\u003c endl; return 0; } ä¸Šé¢çš„ä»£ç ä½¿ç”¨C++11æ˜¯ä¸èƒ½é€šè¿‡ç¼–è¯‘çš„ï¼Œé€šè¿‡ç¼–è¯‘å™¨è¾“å‡ºçš„ä¿¡æ¯å¾—çŸ¥è¿™ä¸ªç‰¹æ€§éœ€è¦åˆ°C++14æ‰è¢«æ”¯æŒã€‚ è¿”å›å€¼ç±»å‹æ¨å¯¼ä¹Ÿå¯ä»¥ç”¨åœ¨æ¨¡æ¿ä¸­ #include \u003ciostream\u003e using namespace std; template\u003ctypename T\u003e auto func(T t) { return t; } int main() { cout \u003c\u003c func(4) \u003c\u003c endl; cout \u003c\u003c func(3.4) \u003c\u003c endl; return 0; } æ³¨æ„: å‡½æ•°å†…å¦‚æœæœ‰å¤šä¸ªreturnè¯­å¥ï¼Œå®ƒä»¬å¿…é¡»è¿”å›ç›¸åŒçš„ç±»å‹ï¼Œå¦åˆ™ç¼–è¯‘å¤±è´¥ å¦‚æœreturnè¯­å¥è¿”å›åˆå§‹åŒ–åˆ—è¡¨ï¼Œè¿”å›å€¼ç±»å‹æ¨å¯¼ä¹Ÿä¼šå¤±è´¥ å¦‚æœå‡½æ•°æ˜¯è™šå‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨è¿”å›å€¼ç±»å‹æ¨å¯¼ è¿”å›ç±»å‹æ¨å¯¼å¯ä»¥ç”¨åœ¨å‰å‘å£°æ˜ä¸­ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨å®ƒä»¬ä¹‹å‰ï¼Œç¿»è¯‘å•å…ƒä¸­å¿…é¡»èƒ½å¤Ÿå¾—åˆ°å‡½æ•°å®šä¹‰ è¿”å›ç±»å‹æ¨å¯¼å¯ä»¥ç”¨åœ¨é€’å½’å‡½æ•°ä¸­ï¼Œä½†æ˜¯é€’å½’è°ƒç”¨å¿…é¡»ä»¥è‡³å°‘ä¸€ä¸ªè¿”å›è¯­å¥ä½œä¸ºå…ˆå¯¼ï¼Œä»¥ä¾¿ç¼–è¯‘å™¨æ¨å¯¼å‡ºè¿”å›ç±»å‹ lambdaå‚æ•°auto: åœ¨C++11ä¸­ï¼Œlambdaè¡¨è¾¾å¼å‚æ•°éœ€è¦ä½¿ç”¨å…·ä½“çš„ç±»å‹å£°æ˜ï¼š auto f = [] (int a) { return a; } åœ¨C++14ä¸­ï¼Œå¯¹æ­¤è¿›è¡Œä¼˜åŒ–ï¼Œlambdaè¡¨è¾¾å¼å‚æ•°å¯ä»¥ç›´æ¥æ˜¯autoï¼š auto f = [] (auto a) { return a; }; cout \u003c\u003c f(1) \u003c\u003c endl; cout \u003c\u003c f(2.3f) \u003c\u003c endl; ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:1","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.2 å˜é‡æ¨¡æ¿ å¯¹å˜é‡çš„ç±»å‹ä½¿ç”¨æ¨¡æ¿: template\u003cclass T\u003e constexpr T pi = T(3.1415926535897932385L); int main() { // 3 cout \u003c\u003c pi\u003cint\u003e \u003c\u003c endl; // 3.14159 cout \u003c\u003c pi\u003cdouble\u003e \u003c\u003c endl; return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:2","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.3 åˆ«åæ¨¡æ¿ å¯¹åˆ«åä½¿ç”¨æ¨¡æ¿ï¼Œå¹¶ä¸”ä»ç„¶ä¿ç•™æ¨¡æ¿ç‰¹æ€§: template\u003ctypename T, typename U\u003e struct A { T t; U u; }; template\u003ctypename T\u003e using B = A\u003cT, int\u003e; int main() { B\u003cdouble\u003e b; b.t = 10; b.u = 20; cout \u003c\u003c b.t \u003c\u003c endl; cout \u003c\u003c b.u \u003c\u003c endl; return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:3","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.4 constexptrçš„é™åˆ¶ C++14ç›¸è¾ƒäºC++11å¯¹constexprå‡å°‘äº†ä¸€äº›é™åˆ¶: C++11ä¸­constexprå‡½æ•°å¯ä»¥ä½¿ç”¨é€’å½’ï¼Œåœ¨C++14ä¸­å¯ä»¥ä½¿ç”¨å±€éƒ¨å˜é‡å’Œå¾ªç¯ // C++14 å’Œ C++11å‡å¯ constexpr int factorial(int n) { return n \u003c= 1 ? 1 : (n * factorial(n - 1)); } // C++11ä¸­ä¸å¯ï¼ŒC++14ä¸­å¯ä»¥ constexpr int factorial(int n) { int ret = 0; for (int i = 0; i \u003c n; ++i) { ret += i; } return ret; } C++11ä¸­constexprå‡½æ•°å¿…é¡»æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„returnè¯­å¥ä¸­ï¼Œè€Œconstexpråˆ™æ— æ­¤é™åˆ¶ // C++14 å’Œ C++11å‡å¯ constexpr int func(bool flag) { return 0; } // C++11ä¸­ä¸å¯ï¼ŒC++14ä¸­å¯ä»¥ constexpr int func(bool flag) { if (flag) return 1; else return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:4","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.5 deprecatedæ ‡è®° C++14ä¸­å¢åŠ äº†deprecatedæ ‡è®°ï¼Œä¿®é¥°ç±»ã€å˜ã€å‡½æ•°ç­‰ï¼Œå½“ç¨‹åºä¸­ä½¿ç”¨åˆ°äº†è¢«å…¶ä¿®é¥°çš„ä»£ç æ—¶ï¼Œç¼–è¯‘æ—¶è¢«äº§ç”Ÿè­¦å‘Šï¼Œç”¨æˆ·æç¤ºå¼€å‘è€…è¯¥æ ‡è®°ä¿®é¥°çš„å†…å®¹å°†æ¥å¯èƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œå°½é‡ä¸è¦ä½¿ç”¨ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:5","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.6 äºŒè¿›åˆ¶å­—é¢é‡ä¸æ•´å‹å­—é¢é‡åˆ†éš”ç¬¦ C++14å¼•å…¥äº†äºŒè¿›åˆ¶å­—é¢é‡ï¼Œä¹Ÿå¼•å…¥äº†åˆ†éš”ç¬¦ int a = 0b0001'0011'1010; double b = 3.14'1234'1234'1234; ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:6","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.7 std::make_unique C++11ä¸­æœ‰std::make_sharedï¼Œå´æ²¡æœ‰std::make_uniqueï¼Œåœ¨C++14å·²ç»æ”¹å–„ struct A {}; std::unique_ptr\u003cA\u003e ptr = std::make_unique\u003cA\u003e(); ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:7","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.8 std::shared_time_mutexä¸std::shared_lock C++14é€šè¿‡std::shared_timed_mutexå’Œstd::shared_lockæ¥å®ç°è¯»å†™é”ï¼Œä¿è¯å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¯»ï¼Œä½†æ˜¯å†™çº¿ç¨‹å¿…é¡»ç‹¬ç«‹è¿è¡Œï¼Œå†™æ“ä½œä¸å¯ä»¥åŒæ—¶å’Œè¯»æ“ä½œä¸€èµ·è¿›è¡Œã€‚ struct ThreadSafe { mutable std::shared_timed_mutex mutex_; int value_; ThreadSafe() { value_ = 0; } int get() const { std::shared_lock\u003cstd::shared_timed_mutex\u003e lock(mutex_); return value_; } void increase() { std::unique_lock\u003cstd::shared_timed_mutex\u003e lock(mutex_); value_ += 1; } }; ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:8","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.9 std::integer_sequence template\u003ctypename T, T... ints\u003e void print_sequence(std::integer_sequence\u003cT, ints...\u003e int_seq) { std::cout \u003c\u003c \"The sequence of size \" \u003c\u003c int_seq.size() \u003c\u003c \": \"; ((std::cout \u003c\u003c ints \u003c\u003c ' '), ...); std::cout \u003c\u003c '\\n'; } int main() { print_sequence(std::integer_sequence\u003cint, 9, 2, 5, 1, 9, 1, 6\u003e{}); return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:9","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.10 std::exchange int main() { std::vector\u003cint\u003e v; std::exchange(v, {1,2,3,4}); cout \u003c\u003c v.size() \u003c\u003c endl; for (int a : v) { cout \u003c\u003c a \u003c\u003c \" \"; } return 0; } çœ‹æ ·å­è²Œä¼¼å’Œstd::swapä½œç”¨ç›¸åŒï¼Œä½†æ˜¯å®é™…ä¸Šstd::exchangeå°†æ•°ç»„{1,2,3,4}èµ‹å€¼ç»™äº†æ•°ç»„v,ä½†æ˜¯æ²¡æœ‰å¯¹æ•°ç»„vè¿›è¡Œèµ‹å€¼ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:10","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"3.11 std::quoted C++14å¼•å…¥std::quotedç”¨äºç»™å­—ç¬¦ä¸²æ·»åŠ åŒå¼•å· int main() { string str = \"hello world\"; cout \u003c\u003c str \u003c\u003c endl; cout \u003c\u003c std::quoted(str) \u003c\u003c endl; return 0; } è¾“å‡º: \"hello world\" ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:1:11","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"å››ã€C++ 17æ–°ç‰¹æ€§ ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.1 æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼ åœ¨C++17å‰æ„é€ ä¸€ä¸ªæ¨¡æ¿ç±»å¯¹è±¡éœ€è¦æŒ‡æ˜ç±»å‹: std::pair\u003cint, double\u003e p(1, 2.2); C++17å°±ä¸éœ€è¦ç‰¹æ®ŠæŒ‡å®šï¼Œç›´æ¥å¯ä»¥æ¨å¯¼å‡ºç±»å‹: // c++17 è‡ªåŠ¨æ¨å¯¼ std::pair p(1, 2.2); // c++17 std::vector v = {1, 2, 3}; ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:1","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.2 ç»“æ„åŒ–ç»‘å®š é€šè¿‡ç»“æ„åŒ–ç»‘å®šï¼Œå¯¹äºtupleã€mapç­‰ç±»å‹ï¼Œè·å–ç›¸åº”å€¼: std::tuple\u003cint, double\u003e func() { return std::tuple(1, 2.2); } int main() { // C++17 auto[i, d] = func(); cout \u003c\u003c i \u003c\u003c endl; cout \u003c\u003c d \u003c\u003c endl; } // -------------***-------------// void f() { map\u003cint, string\u003e m = { {0, \"a\"}, {1, \"b\"}, }; for (const auto \u0026[i, s] : m) { cout \u003c\u003c i \u003c\u003c \" \" \u003c\u003c s \u003c\u003c endl; } } int main() { std::pair a(1, 2.3f); auto[i, f] = a; cout \u003c\u003c i \u003c\u003c endl; // 1 cout \u003c\u003c f \u003c\u003c endl; // 2.3f return 0; } ç»“æ„åŒ–ç»‘å®šè¿˜å¯ä»¥æ”¹å˜å¯¹è±¡çš„å€¼ï¼Œä½¿ç”¨å¼•ç”¨å³å¯: // é€šè¿‡ç»“æ„åŒ–ç»‘å®šæ”¹å˜å¯¹è±¡çš„å€¼ int main() { std::pair a(1, 2.3f); auto\u0026 [i, f] = a; i = 2; // 2 cout \u003c\u003c a.first \u003c\u003c endl; } æ³¨æ„: ç»“æ„åŒ–ç»‘å®šä¸èƒ½åº”ç”¨äºconstexprã€‚ // compile error, C++20å¯ä»¥ constexpr auto[x, y] = std::pair(1, 2.3f); ç»“æ„åŒ–ç»‘å®šä¸æ­¢å¯ä»¥ç»‘å®špairå’Œtupleï¼Œè¿˜å¯ä»¥ç»‘å®šæ•°ç»„å’Œç»“æ„ä½“ç­‰ int array[3] = {1, 2, 3}; auto [a, b, c] = array; cout \u003c\u003c a \u003c\u003c \" \" \u003c\u003c b \u003c\u003c \" \" \u003c\u003c c \u003c\u003c endl; // æ³¨æ„è¿™é‡Œçš„structçš„æˆå‘˜ä¸€å®šè¦æ˜¯publicçš„ struct Point { int x; int y; }; Point func() { return {1, 2}; } const auto [x, y] = func(); ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:2","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.3 if-switchè¯­å¥åˆå§‹åŒ– C++17ä¹‹åå¯ä»¥è¿™æ ·: if (init; condition) if (int a = GetValue()); a \u003c 101) { cout \u003c\u003c a; } string str = \"Hi World\"; if (auto [pos, size] = pair(str.find(\"Hi\"), str.size()); pos != string::npos) { std::cout \u003c\u003c pos \u003c\u003c \" Hello, size is \" \u003c\u003c size; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:3","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.4 å†…æ•›å˜é‡ C++17å‰åªæœ‰å†…è”å‡½æ•°ï¼Œç°åœ¨æœ‰äº†å†…è”å˜é‡ï¼Œæˆ‘ä»¬å°è±¡ä¸­C++ç±»çš„é™æ€æˆå‘˜å˜é‡åœ¨å¤´æ–‡ä»¶ä¸­æ˜¯ä¸èƒ½åˆå§‹åŒ–çš„ï¼Œä½†æ˜¯æœ‰äº†å†…è”å˜é‡ï¼Œå°±å¯ä»¥è¾¾åˆ°æ­¤ç›®çš„: // header file struct A { static const int value; }; inline int const A::value = 10; struct A { inline static const int value = 10; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:4","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.5 æŠ˜å è¡¨è¾¾å¼ C++17å¼•å…¥äº†æŠ˜å è¡¨è¾¾å¼ä½¿å¯å˜å‚æ•°æ¨¡æ¿ç¼–ç¨‹æ›´æ–¹ä¾¿ï¼š template \u003ctypename ... Ts\u003e auto sum(Ts ... ts) { return (ts + ...); } int a {sum(1, 2, 3, 4, 5)}; // 15 std::string a{\"hello \"}; std::string b{\"world\"}; cout \u003c\u003c sum(a, b) \u003c\u003c endl; // hello world ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:5","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.6 constexptr lambdaè¡¨è¾¾å¼ C++17å‰lambdaè¡¨è¾¾å¼åªèƒ½åœ¨è¿è¡Œæ—¶ä½¿ç”¨ï¼ŒC++17å¼•å…¥äº†constexpr lambdaè¡¨è¾¾å¼ï¼Œå¯ä»¥ç”¨äºåœ¨ç¼–è¯‘æœŸè¿›è¡Œè®¡ç®—: int main() { // c++17å¯ç¼–è¯‘ constexpr auto lamb = [] (int n) { return n * n; }; static_assert(lamb(3) == 9, \"a\"); } constexprå‡½æ•°æœ‰å¦‚ä¸‹é™åˆ¶ï¼š å‡½æ•°ä½“ä¸èƒ½åŒ…å«æ±‡ç¼–è¯­å¥ã€gotoè¯­å¥ã€labelã€tryå—ã€é™æ€å˜é‡ã€çº¿ç¨‹å±€éƒ¨å­˜å‚¨ã€æ²¡æœ‰åˆå§‹åŒ–çš„æ™®é€šå˜é‡ï¼Œä¸èƒ½åŠ¨æ€åˆ†é…å†…å­˜ï¼Œä¸èƒ½æœ‰new deleteç­‰ï¼Œä¸èƒ½æœ‰è™šå‡½æ•°ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:6","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.7 namespaceåµŒå¥— namespace A { namespace B { namespace C { void func(); } } } // c++17ï¼Œæ›´æ–¹ä¾¿ namespace A::B::C { void func();) } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:7","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.8 __has_includeé¢„å¤„ç†è¡¨è¾¾å¼ å¯ä»¥åˆ¤æ–­æ˜¯å¦æœ‰æŸä¸ªå¤´æ–‡ä»¶ï¼Œä»£ç å¯èƒ½ä¼šåœ¨ä¸åŒç¼–è¯‘å™¨ä¸‹å·¥ä½œï¼Œä¸åŒç¼–è¯‘å™¨çš„å¯ç”¨å¤´æ–‡ä»¶æœ‰å¯èƒ½ä¸åŒï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ­¤æ¥åˆ¤æ–­ï¼š #if defined __has_include #if __has_include(\u003ccharconv\u003e) #define has_charconv 1 #include \u003ccharconv\u003e #endif #endif std::optional\u003cint\u003e ConvertToInt(const std::string\u0026 str) { int value{}; #ifdef has_charconv const auto last = str.data() + str.size(); const auto res = std::from_chars(str.data(), last, value); if (res.ec == std::errc{} \u0026\u0026 res.ptr == last) { return value; } #else // alternative implementation... // å…¶å®ƒæ–¹å¼å®ç° #endif return std::nullopt; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:8","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.9 åœ¨lambdaè¡¨è¾¾å¼ç”¨*thisæ•è·å¯¹è±¡å‰¯æœ¬ æ­£å¸¸æƒ…å†µä¸‹ï¼Œlambdaè¡¨è¾¾å¼ä¸­è®¿é—®ç±»çš„å¯¹è±¡æˆå‘˜å˜é‡éœ€è¦æ•è·thisï¼Œä½†æ˜¯è¿™é‡Œæ•è·çš„æ˜¯thisæŒ‡é’ˆï¼ŒæŒ‡å‘çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯èƒ½æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœå¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå‡½æ•°çš„ä½œç”¨åŸŸè¶…è¿‡äº†å¯¹è±¡çš„ä½œç”¨åŸŸï¼Œå¯¹è±¡å·²ç»è¢«ææ„äº†ï¼Œè¿˜è®¿é—®äº†æˆå‘˜å˜é‡ï¼Œå°±ä¼šæœ‰é—®é¢˜ã€‚ struct A { int a; void func() { auto f = [this] { cout \u003c\u003c a \u003c\u003c endl; }; f(); } }; int main() { A a; a.func(); return 0; } C++17å¢åŠ äº†æ–°ç‰¹æ€§ï¼Œæ•è·*thisï¼Œä¸æŒæœ‰thisæŒ‡é’ˆï¼Œè€Œæ˜¯æŒæœ‰å¯¹è±¡çš„æ‹·è´ï¼Œè¿™æ ·ç”Ÿå‘½å‘¨æœŸå°±ä¸å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸ç›¸å…³: struct A { int a; void func() { auto f = [*this] { cout \u003c\u003c a \u003c\u003c endl; }; f(); } }; int main() { A a; a.func(); return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:9","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.10 æ–°å¢Attribute å¹³æ—¶åœ¨é¡¹ç›®ä¸­è§è¿‡__declspec, attribute , #pragmaæŒ‡ç¤ºç¬¦ï¼Œä½¿ç”¨å®ƒä»¬æ¥ç»™ç¼–è¯‘å™¨æä¾›ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œæ¥äº§ç”Ÿä¸€äº›ä¼˜åŒ–æˆ–ç‰¹å®šçš„ä»£ç ï¼Œä¹Ÿå¯ä»¥ç»™å…¶å®ƒå¼€å‘è€…ä¸€äº›æç¤ºä¿¡æ¯ã€‚ struct A { short f[3]; } __attribute__((aligned(8))); void fatal() __attribute__((noreturn)); åœ¨C++11å’ŒC++14ä¸­æœ‰æ›´æ–¹ä¾¿çš„æ–¹æ³•ï¼š [[carries_dependency]] è®©ç¼–è¯‘æœŸè·³è¿‡ä¸å¿…è¦çš„å†…å­˜æ …æ æŒ‡ä»¤ [[noreturn]] å‡½æ•°ä¸ä¼šè¿”å› [[deprecated]] å‡½æ•°å°†å¼ƒç”¨çš„è­¦å‘Š [[noreturn]] void terminate() noexcept; [[deprecated(\"use new func instead\")]] void func() {} C++17åˆæ–°å¢äº†ä¸‰ä¸ªï¼š [[fallthrough]]ï¼Œç”¨åœ¨switchä¸­æç¤ºå¯ä»¥ç›´æ¥è½ä¸‹å»ï¼Œä¸éœ€è¦breakï¼Œè®©ç¼–è¯‘æœŸå¿½ç•¥è­¦å‘Š switch (i) {} case 1: // warning xxx; case 2: xxx; // è­¦å‘Šæ¶ˆé™¤ [[fallthrough]]; case 3: xxx; break; } [[nodiscard]]: è¡¨ç¤ºä¿®é¥°çš„å†…å®¹ä¸èƒ½è¢«å¿½ç•¥ï¼Œå¯ç”¨äºä¿®é¥°å‡½æ•°ï¼Œæ ‡æ˜è¿”å›å€¼ä¸€å®šè¦è¢«å¤„ç† [[nodiscard]] int func(); void F() { // warning æ²¡æœ‰å¤„ç†å‡½æ•°è¿”å›å€¼ func(); } [[maybe_unused]]: æç¤ºç¼–è¯‘å™¨ä¿®é¥°çš„å†…å®¹å¯èƒ½æš‚æ—¶æ²¡æœ‰ä½¿ç”¨ï¼Œé¿å…äº§ç”Ÿè­¦å‘Š void func1() {} // è­¦å‘Šæ¶ˆé™¤ [[maybe_unused]] void func2() {} void func3() { int x = 1; // è­¦å‘Šæ¶ˆé™¤ [[maybe_unused]] int y = 2; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:10","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.11 std::variant æ–°å¢from_charså‡½æ•°å’Œto_charså‡½æ•°ï¼Œç›´æ¥çœ‹ä»£ç ï¼š #include \u003ccharconv\u003e int main() { const std::string str{\"123456098\"}; int value = 0; const auto res = std::from_chars(str.data(), str.data() + 4, value); if (res.ec == std::errc()) { cout \u003c\u003c value \u003c\u003c \", distance \" \u003c\u003c res.ptr - str.data() \u003c\u003c endl; } else if (res.ec == std::errc::invalid_argument) { cout \u003c\u003c \"invalid\" \u003c\u003c endl; } str = std::string(\"12.34); double val = 0; const auto format = std::chars_format::general; res = std::from_chars(str.data(), str.data() + str.size(), value, format); str = std::string(\"xxxxxxxx\"); const int v = 1234; res = std::to_chars(str.data(), str.data() + str.size(), v); cout \u003c\u003c str \u003c\u003c \", filled \" \u003c\u003c res.ptr - str.data() \u003c\u003c \" characters \\n\"; // 1234xxxx, filled 4 characters } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:11","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.12 std::optional c++17å¢åŠ std::variantå®ç°ç±»ä¼¼unionçš„åŠŸèƒ½ï¼Œä½†å´æ¯”unionæ›´é«˜çº§ï¼Œä¸¾ä¸ªä¾‹å­unioné‡Œé¢ä¸èƒ½æœ‰stringè¿™ç§ç±»å‹ï¼Œä½†std::variantå´å¯ä»¥ï¼Œè¿˜å¯ä»¥æ”¯æŒæ›´å¤šå¤æ‚ç±»å‹ï¼Œå¦‚mapç­‰ int main() { // c++17å¯ç¼–è¯‘ std::variant\u003cint, std::string\u003e var(\"hello\"); cout \u003c\u003c var.index() \u003c\u003c endl; var = 123; cout \u003c\u003c var.index() \u003c\u003c endl; try { var = \"world\"; // é€šè¿‡ç±»å‹è·å–å€¼ std::string str = std::get\u003cstd::string\u003e(var); var = 3; // é€šè¿‡indexè·å–å¯¹åº”å€¼ int i = std::get\u003c0\u003e(var); cout \u003c\u003c str \u003c\u003c endl; cout \u003c\u003c i \u003c\u003c endl; } catch(...) { // xxx; } return 0; } æ³¨æ„: ä¸€èˆ¬æƒ…å†µä¸‹variantçš„ç¬¬ä¸€ä¸ªç±»å‹ä¸€èˆ¬è¦æœ‰å¯¹åº”çš„æ„é€ å‡½æ•°ï¼Œå¦åˆ™ç¼–è¯‘å¤±è´¥ï¼š struct A { A(int i){} }; int main() { // ç¼–è¯‘å¤±è´¥ std::variant\u003cA, int\u003e var; } é¿å…è¿™ç§æƒ…å†µå‘¢ï¼Œå¯ä»¥ä½¿ç”¨std::monostateæ¥æ‰“ä¸ªæ¡©ï¼Œæ¨¡æ‹Ÿä¸€ä¸ªç©ºçŠ¶æ€ã€‚ // å¯ä»¥ç¼–è¯‘æˆåŠŸ std::variant\u003cstd::monostate, A\u003e var; ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:12","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.13 std::optional æœ‰æ—¶å€™å¯èƒ½ä¼šæœ‰éœ€æ±‚ï¼Œè®©å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ struct A {}; A func() { if (flag) return A(); else { // å¼‚å¸¸æƒ…å†µä¸‹ï¼Œæ€ä¹ˆè¿”å›å¼‚å¸¸å€¼å‘¢ï¼Œæƒ³è¿”å›ä¸ªç©ºå‘¢ } } æœ‰ä¸€ç§åŠæ³•æ˜¯è¿”å›å¯¹è±¡æŒ‡é’ˆï¼Œå¼‚å¸¸æƒ…å†µä¸‹å°±å¯ä»¥è¿”å›nullptrï¼Œä½†æ˜¯è¿™å°±æ¶‰åŠåˆ°äº†å†…å­˜ç®¡ç†ï¼Œä¹Ÿè®¸ä½ ä¼šä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œä½†è¿™é‡Œå…¶å®æœ‰æ›´æ–¹ä¾¿çš„åŠæ³•å°±æ˜¯std::optionalã€‚ std::optional\u003cint\u003e StoI(const std::string \u0026s) { try { return std::stoi(s); } catch(...) { return std::nullopt; } } void func() { std::string s{\"123\"}; std::optional\u003cint\u003e o = StoI(s); if (o) { cout \u003c\u003c *o \u003c\u003c endl; } else { cout \u003c\u003c \"error\" \u003c\u003c endl; } } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:13","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.14 std::any C++17å¼•å…¥äº†anyå¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å•ä¸ªå€¼ int main() { // c++17å¯ç¼–è¯‘ std::any a = 1; cout \u003c\u003c a.type().name() \u003c\u003c \" \" \u003c\u003c std::any_cast\u003cint\u003e(a) \u003c\u003c endl; a = 2.2f; cout \u003c\u003c a.type().name() \u003c\u003c \" \" \u003c\u003c std::any_cast\u003cfloat\u003e(a) \u003c\u003c endl; if (a.has_value()) { cout \u003c\u003c a.type().name(); } a.reset(); if (a.has_value()) { cout \u003c\u003c a.type().name(); } a = std::string(\"a\"); cout \u003c\u003c a.type().name() \u003c\u003c \" \" \u003c\u003c std::any_cast\u003cstd::string\u003e(a) \u003c\u003c endl; return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:14","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.15 std::apply ä½¿ç”¨std::applyå¯ä»¥å°†tupleå±•å¼€ä½œä¸ºå‡½æ•°çš„å‚æ•°ä¼ å…¥ int add(int first, int second) { return first + second; } auto add_lambda = [](auto first, auto second) { return first + second; }; int main() { std::cout \u003c\u003c std::apply(add, std::pair(1, 2)) \u003c\u003c '\\n'; std::cout \u003c\u003c add(std::pair(1, 2)) \u003c\u003c \"\\n\"; // error std::cout \u003c\u003c std::apply(add_lambda, std::tuple(2.0f, 3.0f)) \u003c\u003c '\\n'; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:15","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.16 std::make_from_tuple ä½¿ç”¨make_from_tupleå¯ä»¥å°†tupleå±•å¼€ä½œä¸ºæ„é€ å‡½æ•°å‚æ•° struct Foo { Foo(int first, float second, int third) { std::cout \u003c\u003c first \u003c\u003c \", \" \u003c\u003c second \u003c\u003c \", \" \u003c\u003c third \u003c\u003c \"\\n\"; } }; int main() { auto tuple = std::make_tuple(42, 3.14f, 0); std::make_from_tuple\u003cFoo\u003e(std::move(tuple)); } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:16","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.17 std::string_view é€šå¸¸ä¼ é€’ä¸€ä¸ªstringæ—¶ä¼šè§¦å‘å¯¹è±¡çš„æ‹·è´æ“ä½œï¼Œå¤§å­—ç¬¦ä¸²çš„æ‹·è´èµ‹å€¼æ“ä½œä¼šè§¦å‘å †å†…å­˜åˆ†é…ï¼Œå¾ˆå½±å“è¿è¡Œæ•ˆç‡ï¼Œæœ‰äº†string_viewå°±å¯ä»¥é¿å…æ‹·è´æ“ä½œï¼Œå¹³æ—¶ä¼ é€’è¿‡ç¨‹ä¸­ä¼ é€’string_viewå³å¯ã€‚ void func(std::string_view stv) { cout \u003c\u003c stv \u003c\u003c endl; } int main(void) { std::string str = \"Hello World\"; std::cout \u003c\u003c str \u003c\u003c std::endl; std::string_view stv(str.c_str(), str.size()); cout \u003c\u003c stv \u003c\u003c endl; func(stv); return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:17","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.18 as_const C++17ä½¿ç”¨as_constå¯ä»¥å°†å·¦å€¼è½¬æˆconstç±»å‹ std::string str = \"str\"; const std::string\u0026 constStr = std::as_const(str); ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:18","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.19 file_system C++17æ­£å¼å°†file_systemçº³å…¥æ ‡å‡†ä¸­ï¼Œæä¾›äº†å…³äºæ–‡ä»¶çš„å¤§å¤šæ•°åŠŸèƒ½ï¼ŒåŸºæœ¬ä¸Šåº”æœ‰å°½æœ‰: namespace fs = std::filesystem; fs::create_directory(dir_path); fs::copy_file(src, dst, fs::copy_options::skip_existing); fs::exists(filename); fs::current_path(err_code); ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:19","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"4.20 std::shared_mutex C++17å¼•å…¥äº†shared_mutexï¼Œå¯ä»¥å®ç°è¯»å†™é”ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_8/:2:20","tags":["CMake"],"title":"CMake ç¬”è®° | [8] è®¾ç½®è¯­è¨€æ ‡å‡† (äºŒ)","uri":"/posts/cmake_note_8/"},{"categories":["C++"],"content":"ä¸€ã€C ++ æ ‡å‡†å†å² 1998 å¹´ï¼ŒC++ æ ‡å‡†å§”å‘˜ä¼šå‘å¸ƒäº†ç¬¬ä¸€ç‰ˆ C++ æ ‡å‡†ï¼Œå¹¶å°†å…¶å‘½åä¸º C++ 98 æ ‡å‡† 2011 å¹´ï¼Œæ–°çš„ C++ 11 æ ‡å‡†è¯ç”Ÿï¼Œç”¨äºå–ä»£ C++ 98 æ ‡å‡†ã€‚æ­¤æ ‡å‡†è¿˜æœ‰ä¸€ä¸ªåˆ«åï¼Œä¸ºC++ 0x 2014 å¹´ï¼ŒC++ 14 æ ‡å‡†å‘å¸ƒï¼Œè¯¥æ ‡å‡†åº“å¯¹ C++ 11 æ ‡å‡†åº“åšäº†æ›´ä¼˜çš„ä¿®æ”¹å’Œæ›´æ–° 2017 å¹´åº•ï¼ŒC++ 17 æ ‡å‡†æ­£å¼é¢å¸ƒ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"äºŒã€C++ 11ç‰ˆæœ¬ç‰¹æ€§ä»‹ç» åœ¨ C++ 11 æ ‡å‡†ä¹‹å‰ï¼ŒC++ æ ‡å‡†å§”å‘˜ä¼šè¿˜åœ¨ 2003 å¹´å¯¹ C++ 98 æ ‡å‡†åšäº†ä¸€æ¬¡ä¿®æ”¹ï¼ˆç§°ä¸º C++ 03 æ ‡å‡†ï¼‰ï¼Œä½†ç”±äºä»…ä»…ä¿®å¤äº†ä¸€äº› C++ 98 æ ‡å‡†ä¸­å­˜åœ¨çš„æ¼æ´ï¼Œå¹¶æœªä¿®æ”¹æ ¸å¿ƒè¯­æ³•ï¼Œå› æ­¤äººä»¬ä¹ æƒ¯å°†è¿™æ¬¡ä¿®è®¢å’Œ C++ 98 åˆç§°ä¸º C++98/03 æ ‡å‡†ã€‚ ä»¥ä¸Š 3 ä¸ªæ ‡å‡†ä¸­ï¼ŒC++ 11 æ ‡å‡†æ— ç–‘æ˜¯é¢ è¦†æ€§çš„ï¼Œè¯¥æ ‡å‡†åœ¨ C++ 98 çš„åŸºç¡€ä¸Šä¿®æ­£äº†çº¦ 600 ä¸ª C++ è¯­è¨€ä¸­å­˜åœ¨çš„ç¼ºé™·ï¼ŒåŒæ—¶æ·»åŠ äº†çº¦ 140 ä¸ªæ–°ç‰¹æ€§ï¼Œè¿™äº›æ›´æ–°ä½¿å¾— C++ è¯­è¨€ç„•ç„¶ä¸€æ–°ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.1 ç±»å‹æ¨å¯¼ä¹‹autoå’Œdecltype åœ¨ C++11 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå®šä¹‰å˜é‡æˆ–è€…å£°æ˜å˜é‡ä¹‹å‰éƒ½å¿…é¡»æŒ‡æ˜å®ƒçš„ç±»å‹ï¼Œæ¯”å¦‚ intã€char ç­‰ã€‚C++11 ä½¿ç”¨ auto å…³é”®å­—æ¥æ”¯æŒè‡ªåŠ¨ç±»å‹æ¨å¯¼ã€‚ åœ¨ä¹‹å‰çš„ C++ ç‰ˆæœ¬ä¸­ï¼Œauto ç”¨æ¥æŒ‡æ˜å˜é‡çš„å­˜å‚¨ç±»å‹ï¼Œå®ƒå’Œ static æ˜¯ç›¸å¯¹çš„ã€‚auto è¡¨ç¤ºå˜é‡æ˜¯è‡ªåŠ¨å­˜å‚¨çš„ï¼Œè¿™ä¹Ÿæ˜¯ç¼–è¯‘å™¨çš„é»˜è®¤è§„åˆ™ï¼Œæ‰€ä»¥å†™ä¸å†™éƒ½ä¸€æ ·ï¼Œè¿™ä½¿å¾— auto çš„å­˜åœ¨å˜å¾—éå¸¸é¸¡è‚‹ã€‚ C++ 11 èµ‹äºˆ auto æ–°çš„å«ä¹‰ï¼Œç”¨å®ƒæ¥åšè‡ªåŠ¨ç±»å‹æ¨å¯¼ã€‚å³ï¼Œä½¿ç”¨ auto å…³é”®å­—åï¼Œç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æœŸé—´è‡ªåŠ¨æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ã€‚ æ³¨æ„ auto ä»…ä»…æ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œåœ¨ç¼–è¯‘å™¨æœŸé—´å®ƒä¼šè¢«çœŸæ­£çš„ç±»å‹æ‰€æ›¿ä»£ã€‚C++ ä¸­çš„å˜é‡å¿…é¡»æ˜¯æœ‰æ˜ç¡®ç±»å‹çš„ï¼Œåªæ˜¯è¿™ä¸ªç±»å‹æ˜¯ç”±ç¼–è¯‘å™¨è‡ªå·±æ¨å¯¼å‡ºæ¥çš„ã€‚ ä½¿ç”¨ auto ç±»å‹æ¨å¯¼çš„å˜é‡å¿…é¡»é©¬ä¸Šåˆå§‹åŒ–ï¼Œå› ä¸º auto åœ¨ C++11 ä¸­åªæ˜¯å ä½ç¬¦ï¼Œå¹¶éå¦‚ int ä¸€æ ·çš„çœŸæ­£çš„ç±»å‹å£°æ˜ã€‚ autoä¸constçš„ç»“åˆä½¿ç”¨ int x = 0; // n ä¸ºconst int,auto è¢«æ¨å¯¼ä¸ºint const auto n = x; // fä¸ºconst intï¼Œ auto è¢«æ¨å¯¼ä¸ºintï¼ˆconstå±æ€§è¢«æŠ›å¼ƒï¼‰ auto f = n; // r1ä¸ºconst int \u0026ç±»å‹ï¼Œautoè¢«æ¨å¯¼ä¸ºint const auto \u0026r1 = x; // r1ä¸ºconst int\u0026ç±»å‹ï¼Œauto è¢«æ¨å¯¼ä¸ºconst int ç±»å‹ auto \u0026r2 = r1; auto ä¸ const ç»“åˆçš„ç”¨æ³•ï¼š å½“ç±»å‹ä¸ä¸ºå¼•ç”¨æ—¶ï¼Œauto çš„æ¨å¯¼ç»“æœå°†ä¸ä¿ç•™è¡¨è¾¾å¼çš„ const å±æ€§ï¼› å½“ç±»å‹ä¸ºå¼•ç”¨æ—¶ï¼Œauto çš„æ¨å¯¼ç»“æœå°†ä¿ç•™è¡¨è¾¾å¼çš„ const å±æ€§ã€‚ autoçš„é™åˆ¶ï¼š ä½¿ç”¨autoæ—¶å¿…é¡»å¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ– autoä¸èƒ½ä½œä¸ºå‡½æ•°çš„å½¢å‚ auto ä¸èƒ½ä½œç”¨äºç±»çš„ éé™æ€æˆå‘˜å˜é‡ä¸­ auto å…³é”®å­—ä¸èƒ½å®šä¹‰æ•°ç»„ auto ä¸èƒ½ä½œç”¨äºæ¨¡æ¿å‚æ•° decltype æ˜¯ C++11 æ–°å¢çš„ä¸€ä¸ªå…³é”®å­—ï¼Œå®ƒå’Œ auto çš„åŠŸèƒ½ä¸€æ ·ï¼Œéƒ½ç”¨æ¥åœ¨ç¼–è¯‘æ—¶æœŸè¿›è¡Œè‡ªåŠ¨ç±»å‹æ¨å¯¼ã€‚decltype æ˜¯declare typeçš„ç¼©å†™ï¼Œè¯‘ä¸ºå£°æ˜ç±»å‹ã€‚ auto å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰çš„è‡ªåŠ¨ç±»å‹æ¨å¯¼åœºæ™¯ï¼Œåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ auto ç”¨èµ·æ¥éå¸¸ä¸æ–¹ä¾¿ï¼Œç”šè‡³å‹æ ¹æ— æ³•ä½¿ç”¨ï¼Œæ‰€ä»¥ decltype å…³é”®å­—ä¹Ÿè¢«å¼•å…¥åˆ° C++11 ä¸­ã€‚ auto var_name = value; decltype(exp) var_name = value; å…¶ä¸­ï¼Œvar_name è¡¨ç¤ºå˜é‡åï¼Œvalue è¡¨ç¤ºèµ‹ç»™å˜é‡çš„å€¼ï¼Œexp è¡¨ç¤ºä¸€ä¸ªè¡¨è¾¾å¼ã€‚ auto æ ¹æ®=å³è¾¹çš„åˆå§‹å€¼ value æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ï¼Œè€Œ decltype æ ¹æ® exp è¡¨è¾¾å¼æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ï¼Œè·Ÿ=å³è¾¹çš„ value æ²¡æœ‰å…³ç³»ã€‚ auto è¦æ±‚å˜é‡å¿…é¡»åˆå§‹åŒ–ï¼Œè€Œ decltype ä¸è¦æ±‚ã€‚ exp å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„è¡¨è¾¾å¼ï¼Œå®ƒå¯ä»¥æ˜¯ä»»æ„å¤æ‚çš„å½¢å¼ï¼Œä½†æ˜¯å¿…é¡»è¦ä¿è¯ exp çš„ç»“æœæ˜¯æœ‰ç±»å‹çš„ï¼Œä¸èƒ½æ˜¯ voidï¼›ä¾‹å¦‚ï¼Œå½“ exp è°ƒç”¨ä¸€ä¸ªè¿”å›å€¼ç±»å‹ä¸º void çš„å‡½æ•°æ—¶ï¼Œexp çš„ç»“æœä¹Ÿæ˜¯ void ç±»å‹ï¼Œæ­¤æ—¶å°±ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ int a = 0; // b è¢«æ¨å¯¼æˆäº† int decltype(a) b = 1; // x è¢«æ¨å¯¼æˆäº† double decltype(10.8) x = 5.5; // y è¢«æ¨å¯¼æˆäº† double decltype(x + 100) y; decltype æ¨å¯¼è§„åˆ™ å¦‚æœ exp æ˜¯ä¸€ä¸ªä¸è¢«æ‹¬å·( )åŒ…å›´çš„è¡¨è¾¾å¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªç±»æˆå‘˜è®¿é—®è¡¨è¾¾å¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå•ç‹¬çš„å˜é‡ï¼Œé‚£ä¹ˆ decltype(exp) çš„ç±»å‹å°±å’Œ exp ä¸€è‡´ã€‚ å¦‚æœ exp æ˜¯å‡½æ•°è°ƒç”¨ï¼Œé‚£ä¹ˆ decltype(exp) çš„ç±»å‹å°±å’Œå‡½æ•°è¿”å›å€¼çš„ç±»å‹ä¸€è‡´ã€‚ å¦‚æœ exp æ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œæˆ–è€…è¢«æ‹¬å·( )åŒ…å›´ï¼Œé‚£ä¹ˆ decltype(exp)çš„ç±»å‹å°±æ˜¯ exp çš„å¼•ç”¨ï¼›å‡è®¾ exp çš„ç±»å‹ä¸º Tï¼Œé‚£ä¹ˆ decltype(exp) çš„ç±»å‹å°±æ˜¯ T\u0026ã€‚ æ³¨æ„ å·¦å€¼æ˜¯æŒ‡é‚£äº›åœ¨è¡¨è¾¾å¼æ‰§è¡Œç»“æŸåä¾ç„¶å­˜åœ¨çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æŒä¹…æ€§çš„æ•°æ®ï¼› å³å€¼æ˜¯æŒ‡é‚£äº›åœ¨è¡¨è¾¾å¼æ‰§è¡Œç»“æŸåä¸å†å­˜åœ¨çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¸´æ—¶æ€§çš„æ•°æ®ã€‚ æœ‰ä¸€ç§å¾ˆç®€å•çš„æ–¹æ³•æ¥åŒºåˆ†å·¦å€¼å’Œå³å€¼ï¼Œå¯¹è¡¨è¾¾å¼å–åœ°å€ï¼Œå¦‚æœç¼–è¯‘å™¨ä¸æŠ¥é”™å°±ä¸ºå·¦å€¼ï¼Œå¦åˆ™ä¸ºå³å€¼ã€‚ autoä¸decltypeå¯¹ cv é™å®šç¬¦çš„å¤„ç†: cv é™å®šç¬¦æ˜¯ const å’Œ volatile å…³é”®å­—çš„ç»Ÿç§°: const å…³é”®å­—ç”¨æ¥è¡¨ç¤ºæ•°æ®æ˜¯åªè¯»çš„ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½è¢«ä¿®æ”¹ volatile å’Œ const æ˜¯ç›¸åçš„ï¼Œå®ƒç”¨æ¥è¡¨ç¤ºæ•°æ®æ˜¯å¯å˜çš„ã€æ˜“å˜çš„ï¼Œç›®çš„æ˜¯ä¸è®© CPU å°†æ•°æ®ç¼“å­˜åˆ°å¯„å­˜å™¨ï¼Œè€Œæ˜¯ä»åŸå§‹çš„å†…å­˜ä¸­è¯»å– åœ¨æ¨å¯¼å˜é‡ç±»å‹æ—¶ï¼Œauto å’Œ decltype å¯¹ cv é™åˆ¶ç¬¦çš„å¤„ç†æ˜¯ä¸ä¸€æ ·çš„ã€‚decltype ä¼šä¿ç•™ cv é™å®šç¬¦ï¼Œè€Œ auto æœ‰å¯èƒ½ä¼šå»æ‰ cv é™å®šç¬¦ã€‚å…¶åŸç†è§autoä¸constçš„ç»“åˆä½¿ç”¨ã€‚ autoä¸decltypeå¯¹å¼•ç”¨(\u0026)çš„å¤„ç†: å½“è¡¨è¾¾å¼çš„ç±»å‹ä¸ºå¼•ç”¨æ—¶ï¼Œauto å’Œ decltype çš„æ¨å¯¼è§„åˆ™ä¹Ÿä¸ä¸€æ ·ï¼›decltype ä¼šä¿ç•™å¼•ç”¨ç±»å‹ï¼Œè€Œ auto ä¼šæŠ›å¼ƒå¼•ç”¨ç±»å‹ï¼Œç›´æ¥æ¨å¯¼å‡ºå®ƒçš„åŸå§‹ç±»å‹ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:1","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.2 C++ è¿”å›å€¼ç±»å‹åç½® åœ¨æ³›å‹ç¼–ç¨‹ä¸­ï¼Œå¦‚æœéœ€è¦é€šè¿‡å‚æ•°çš„è¿ç®—æ¥å¾—åˆ°è¿”å›å€¼çš„ç±»å‹ï¼š template \u003ctypename R, typename T, typename U\u003e R Add(T t, U u) { return t+u; } int main() { int a = 1; float b = 2.0f; auto c = Add\u003cdecltype(a + b)\u003e(a + b); return 0; } ä»¥ä¸Šä»£ç æ˜¯å› ä¸ºæˆ‘ä»¬å¹¶ä¸å…³å¿ƒa + bçš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œå› æ­¤åªéœ€è¦é€šè¿‡decltype(a + b)ç›´æ¥å¾—åˆ°è¿”å›å€¼ç±»å‹å³å¯ã€‚ ä¸Šè¿°ä½¿ç”¨è¿‡ç¨‹ååˆ†ä¸æ–¹ä¾¿ï¼Œå› ä¸ºå¤–éƒ¨å…¶å®å¹¶ä¸çŸ¥é“å‚æ•°ä¹‹é—´åº”è¯¥å¦‚ä½•è¿ç®—ï¼Œåªæœ‰Addå‡½æ•°çŸ¥é“è¿”å›å€¼åº”è¯¥å¦‚ä½•æ¨å¯¼ã€‚ åœ¨å‡½æ•°å®šä¹‰ä¸Šç›´æ¥é€šè¿‡decltypeè·å–è¿”å›å€¼ï¼š template \u003ctypename T, typename U\u003e decltype(T() + U()) add(T t, U u) { return t + u; } è€ƒè™‘åˆ° Tã€U å¯èƒ½æ˜¯æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°çš„ç±»ï¼Œæ­£ç¡®çš„å†™æ³•å¦‚ä¸‹ï¼š template \u003ctypename T, typename U\u003e decltype((*(T*)0) + (*(U*)0)) add(T t, U u) { return t + u; } ä¸Šè¿°ä»£ç è™½ç„¶æˆåŠŸåœ°ä½¿ç”¨ decltype å®Œæˆäº†è¿”å›å€¼çš„æ¨å¯¼ï¼Œä½†å†™æ³•è¿‡äºæ™¦æ¶©ï¼Œä¼šå¤§å¤§å¢åŠ decltypeåœ¨è¿”å›å€¼ç±»å‹æ¨å¯¼ä¸Šçš„ä½¿ç”¨éš¾åº¦å¹¶é™ä½ä»£ç çš„å¯è¯»æ€§ã€‚ å› æ­¤ï¼Œåœ¨ C++11 ä¸­å¢åŠ äº†è¿”å›ç±»å‹åç½®è¯­æ³•ï¼Œå°† decltype å’Œ auto ç»“åˆèµ·æ¥å®Œæˆè¿”å›å€¼ç±»å‹çš„æ¨å¯¼ã€‚ template \u003ctypename T, typename U\u003e auto add(T t, U u) -\u003e decltype(t + u){ return t + u; } ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:2","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.3 å¯¹æ¨¡æ¿å®ä¾‹åŒ–ä¸­è¿ç»­å°–æ‹¬å·Â»æ”¹è¿› åœ¨ C++98/03 çš„æ³›å‹ç¼–ç¨‹ä¸­ï¼Œæ¨¡æ¿å®ä¾‹åŒ–è¿‡ç¨‹ä¸­ï¼Œè¿ç»­ä¸¤ä¸ªå³å°–æ‹¬å·ï¼ˆÂ»ï¼‰ä¼šè¢«ç¼–è¯‘å™¨è§£é‡Šæˆå³ç§»æ“ä½œç¬¦ï¼Œè€Œä¸æ˜¯æ¨¡æ¿å‚æ•°è¡¨çš„ç»“æŸã€‚ template \u003ctypename T\u003e struct Foo{ typedef T type; }; template \u003ctypename T\u003e class A{ // ... }; int main(){ //ç¼–è¯‘å‡ºé”™ Foo\u003cA\u003cint\u003e\u003e::type xx; return 0; } ä¸Šè¿°ä»£ç ä½¿ç”¨ gcc ç¼–è¯‘æ—¶ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹é”™è¯¯æç¤ºï¼š error: â€˜\u003e\u003eâ€™ should be â€˜\u003e\u003eâ€™ within a nested template argument list Foo\u003cA\u003e::type xx; æ„æ€å°±æ˜¯ï¼ŒFoo\u003cA\u003eè¿™ç§å†™æ³•æ˜¯ä¸è¢«æ”¯æŒçš„ï¼Œè¦å†™æˆè¿™æ ·Foo\u003cA\u003cint\u003e \u003e(æ³¨æ„ä¸¤ä¸ªå³å°–æ‹¬å·ä¹‹é—´çš„ç©ºæ ¼)ã€‚ è¿™ç§é™åˆ¶æ˜¯å¾ˆæ²¡æœ‰å¿…è¦çš„ã€‚å› ä¸ºåœ¨ C++ çš„å„ç§æˆå¯¹æ‹¬å·ä¸­ï¼Œç›®å‰åªæœ‰å³å°–æ‹¬å·è¿ç»­å†™ä¸¤ä¸ªä¼šå‡ºç°è¿™ç§äºŒä¹‰æ€§ã€‚static_castã€reinterpret_cast ç­‰ C++ æ ‡å‡†è½¬æ¢è¿ç®—ç¬¦ï¼Œéƒ½æ˜¯ä½¿ç”¨\u003c\u003eæ¥è·å¾—å¾…è½¬æ¢ç±»å‹ï¼ˆtype-idï¼‰çš„ã€‚è‹¥è¿™ä¸ª type-id æœ¬èº«æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œç”¨èµ·æ¥ä¼šå¾ˆä¸æ–¹ä¾¿ã€‚ åœ¨ C++11 æ ‡å‡†ä¸­ï¼Œè¦æ±‚ç¼–è¯‘å™¨å¯¹æ¨¡æ¿çš„å³å°–æ‹¬å·åšå•ç‹¬å¤„ç†ï¼Œä½¿ç¼–è¯‘å™¨èƒ½å¤Ÿæ­£ç¡®åˆ¤æ–­å‡ºÂ»æ˜¯ä¸€ä¸ªå³ç§»æ“ä½œç¬¦è¿˜æ˜¯æ¨¡æ¿å‚æ•°è¡¨çš„ç»“æŸæ ‡è®°ã€‚ æ³¨æ„ï¼šä¸Šè¿°è¿™ç§è‡ªåŠ¨åŒ–çš„å¤„ç†åœ¨æŸäº›æ—¶å€™ä¼šä¸è€æ ‡å‡†ä¸å…¼å®¹ï¼š template \u003cint N\u003e struct Foo{ // ... }; int main() { // è§£å†³æ–¹æ¡ˆï¼š // Foo\u003c(100 \u003e\u003e 2)\u003e xx; Foo\u003c100 \u003e\u003e 2\u003e xx; return 0; } åœ¨ C++98/03 çš„ç¼–è¯‘å™¨ä¸­ç¼–è¯‘æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½† C++11 çš„ç¼–è¯‘å™¨ä¼šæ˜¾ç¤º: error: expected unqualif?ied-id before â€˜\u003eâ€™ token Foo\u003c100 \u003e\u003e 2\u003e xx; ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:3","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.4 ä½¿ç”¨usingå®šä¹‰åˆ«åï¼ˆæ›¿ä»£typedefï¼‰ C++å¯ä»¥ä½¿ç”¨typedefé‡å®šä¹‰ä¸€ä¸ªç±»å‹ï¼Œè¢«é‡å®šä¹‰çš„ç±»å‹ä¸ä¸€å®šæ˜¯ä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œä¹Ÿæœ‰å¯èƒ½ä»…ä»…æ˜¯åŸæœ‰ç±»å‹å–äº†ä¸€ä¸ªæ–°çš„åå­—ã€‚ä½¿ç”¨typedefé‡å®šä¹‰ç±»å‹æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼Œå¦‚æ— æ³•é‡å®šä¹‰ä¸€ä¸ªæ¨¡æ¿ç­‰ã€‚ template\u003ctypename T\u003e using str_map_t = std::map\u003cstd::string, T\u003e; // ... str_map_t\u003cint\u003e map_1; å®é™…ä¸Šï¼Œusingçš„åˆ«åè¯­æ³•è¦†ç›–äº†typedefçš„å…¨éƒ¨åŠŸèƒ½ã€‚ // é‡å®šä¹‰unsigned int typedef unsigned int uint_t; using uint_t = unsigned int; // é‡å®šä¹‰std::map typedef std::map\u003cstd::string, int\u003e map_int_t; using map_int_t = std::map\u003cstd::string, int\u003e; // é‡å®šä¹‰æ¨¡æ¿ // C++98/03 template \u003ctypename T\u003e struct func_t{ typedef void (*type)(T, T); }; // ä½¿ç”¨ func_t æ¨¡æ¿ func_t\u003cint\u003e::type xx_1; // C++11 template \u003ctypename T\u003e using func_t = void (*)(T, T); // ä½¿ç”¨ func_t æ¨¡æ¿ func_t\u003cint\u003e xx_2; ä»ç¤ºä¾‹ä¸­å¯ä»¥çœ‹å‡ºï¼Œé€šè¿‡ using å®šä¹‰æ¨¡æ¿åˆ«åçš„è¯­æ³•ï¼Œåªæ˜¯åœ¨æ™®é€šç±»å‹åˆ«åè¯­æ³•çš„åŸºç¡€ä¸Šå¢åŠ  template çš„å‚æ•°åˆ—è¡¨ã€‚ä½¿ç”¨ using å¯ä»¥è½»æ¾åœ°åˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡æ¿åˆ«åï¼Œè€Œä¸éœ€è¦åƒ C++98/03 é‚£æ ·ä½¿ç”¨çƒ¦ççš„å¤–æ•·æ¨¡æ¿ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:4","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.5 æ”¯æŒå‡½æ•°æ¨¡æ¿çš„é»˜è®¤å‚æ•° åœ¨ C++98/03 æ ‡å‡†ä¸­ï¼Œç±»æ¨¡æ¿å¯ä»¥æœ‰é»˜è®¤çš„æ¨¡æ¿å‚æ•°: template \u003ctypename T, typename U = int, U N = 0\u003e struct Foo{ // ... }; ä½†æ˜¯ä¸æ”¯æŒå‡½æ•°çš„é»˜è®¤æ¨¡æ¿å‚æ•°ï¼š // error in C++98/03: default template arguments template \u003ctypename T = int\u003e void func(){ // ... } ç°åœ¨è¿™ä¸€é™åˆ¶åœ¨ C++11 ä¸­è¢«è§£é™¤äº†ã€‚ä¸Šé¢çš„ func å‡½æ•°åœ¨ C++11 ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨: int main(void){ //T = int func(); return 0; } å‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°åœ¨ä½¿ç”¨è§„åˆ™ä¸Šå’Œå…¶ä»–çš„é»˜è®¤å‚æ•°ä¹Ÿæœ‰ä¸€äº›ä¸åŒï¼Œå®ƒæ²¡æœ‰å¿…é¡»å†™åœ¨å‚æ•°è¡¨æœ€åçš„é™åˆ¶ã€‚ç”šè‡³äºï¼Œæ ¹æ®å®é™…åœºæ™¯ä¸­å‡½æ•°æ¨¡æ¿è¢«è°ƒç”¨çš„æƒ…å½¢ï¼Œç¼–è¯‘å™¨è¿˜å¯ä»¥è‡ªè¡Œæ¨å¯¼å‡ºéƒ¨åˆ†æ¨¡æ¿å‚æ•°çš„ç±»å‹ã€‚å³å½“é»˜è®¤æ¨¡æ¿å‚æ•°å’Œç¼–è¯‘å™¨è‡ªè¡Œæ¨å¯¼å‡ºæ¨¡æ¿å‚æ•°ç±»å‹çš„èƒ½åŠ›ä¸€èµ·ç»“åˆä½¿ç”¨æ—¶ï¼Œä»£ç çš„ä¹¦å†™å°†å˜å¾—å¼‚å¸¸çµæ´»ã€‚æˆ‘ä»¬å¯ä»¥æŒ‡å®šå‡½æ•°ä¸­çš„ä¸€éƒ¨åˆ†æ¨¡æ¿å‚æ•°é‡‡ç”¨é»˜è®¤å‚æ•°ï¼Œè€Œå¦ä¸€éƒ¨åˆ†ä½¿ç”¨è‡ªåŠ¨æ¨å¯¼ï¼š template \u003ctypename R = int, typename U\u003e R func(U val){ return val; } int main(){ // R=int, U=int func(97); // R=char, U=int func\u003cchar\u003e(97); // R=double, U=int func\u003cdouble, int\u003e(97); return 0; } å½“é»˜è®¤æ¨¡æ¿å‚æ•°å’Œè‡ªè¡Œæ¨å¯¼çš„æ¨¡æ¿å‚æ•°åŒæ—¶ä½¿ç”¨æ—¶ï¼Œè‹¥æ— æ³•æ¨å¯¼å‡ºå‡½æ•°æ¨¡æ¿å‚æ•°çš„ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šé€‰æ‹©ä½¿ç”¨é»˜è®¤æ¨¡æ¿å‚æ•°ï¼›å¦‚æœæ¨¡æ¿å‚æ•°æ— æ³•æ¨å¯¼å‡ºæ¥ï¼Œåˆæœªè®¾ç½®å…¶é»˜è®¤å€¼ï¼Œåˆ™ç¼–è¯‘å™¨ç›´æ¥æŠ¥é”™ã€‚ template \u003ctypename T, typename U = double\u003e void func(T val1 = 0, U val2 = 0) { //... } int main() { // T=char, U=double func('c'); // ç¼–è¯‘æŠ¥é”™ func(); return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:5","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.6 åœ¨å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿ä¸­ä½¿ç”¨å¯å˜å‚æ•° å¯å˜å‚æ•°ï¼ŒæŒ‡çš„æ˜¯å‚æ•°çš„ä¸ªæ•°å’Œç±»å‹éƒ½å¯ä»¥æ˜¯ä»»æ„çš„ã€‚ å¯¹äºå‡½æ•°å‚æ•°è€Œè¨€ï¼ŒC++ ä¸€ç›´éƒ½æ”¯æŒä¸ºå‡½æ•°è®¾ç½®å¯å˜å‚æ•°ï¼Œæœ€å…¸å‹çš„ä»£è¡¨å°±æ˜¯ printf() å‡½æ•°ï¼Œå®ƒçš„è¯­æ³•æ ¼å¼ä¸º: int printf ( const char * format, ... ); ...å°±è¡¨ç¤ºçš„æ˜¯å¯å˜å‚æ•°ï¼Œå³ printf() å‡½æ•°å¯ä»¥æ¥æ”¶ä»»æ„ä¸ªå‚æ•°ï¼Œä¸”å„ä¸ªå‚æ•°çš„ç±»å‹å¯ä»¥ä¸åŒã€‚ printf(\"%d\", 10); printf(\"%d %c\",10, 'A'); printf(\"%d %c %f\",10, 'A', 1.23); é€šå¸¸å°†å®¹çº³å¤šä¸ªå‚æ•°çš„å¯å˜å‚æ•°ç§°ä¸ºå‚æ•°åŒ…ã€‚å€ŸåŠ© format å­—ç¬¦ä¸²ï¼Œprintf() å‡½æ•°å¯ä»¥è½»æ¾åˆ¤æ–­å‡ºå‚æ•°åŒ…ä¸­çš„å‚æ•°ä¸ªæ•°å’Œç±»å‹ã€‚ #include \u003ciostream\u003e #include \u003ccstdarg\u003e //å¯å˜å‚æ•°çš„å‡½æ•° void vair_fun(int count, ...) { va_list args; va_start(args, count); for (int i = 0; i \u003c count; ++i) { int arg = va_arg(args, int); std::cout \u003c\u003c arg \u003c\u003c \" \"; } va_end(args); } int main() { //å¯å˜å‚æ•°æœ‰ 4 ä¸ªï¼Œåˆ†åˆ«ä¸º 10ã€20ã€30ã€40 vair_fun(4, 10, 20, 30,40); return 0; } æƒ³ä½¿ç”¨å‚æ•°åŒ…ä¸­çš„å‚æ•°ï¼Œéœ€è¦å€ŸåŠ©\u003ccstdarg\u003eå¤´æ–‡ä»¶ä¸­çš„ va_startã€va_arg ä»¥åŠ va_end è¿™ 3 ä¸ªå¸¦å‚æ•°çš„å®ï¼š va_start(args, count)ï¼šargs æ˜¯ va_list ç±»å‹çš„å˜é‡ï¼Œå¯ä»¥ç®€å•çš„å°†å…¶è§†ä¸º char * ç±»å‹ã€‚å€ŸåŠ© count å‚æ•°ï¼Œæ‰¾åˆ°å¯å˜å‚æ•°çš„èµ·å§‹ä½ç½®å¹¶èµ‹å€¼ç»™ argsï¼› va_arg(args, int)ï¼šè°ƒç”¨ va_startæ‰¾åˆ°å¯å˜å‚æ•°èµ·å§‹ä½ç½®çš„å‰æä¸‹ï¼Œé€šè¿‡æŒ‡æ˜å‚æ•°ç±»å‹ä¸º intï¼Œva_arg å°±å¯ä»¥å°†å¯å˜å‚æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿”å›; va_end(args)ï¼šä¸å†ä½¿ç”¨ args å˜é‡åï¼Œåº”åŠæ—¶è°ƒç”¨ va_end å®æ¸…ç† args å˜é‡ã€‚ ä½¿ç”¨â€¦å¯å˜å‚æ•°çš„è¿‡ç¨‹ä¸­ï¼Œéœ€æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š â€¦ å¯å˜å‚æ•°å¿…é¡»ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œä¸”ä¸€ä¸ªå‡½æ•°æœ€å¤šåªèƒ½æ‹¥æœ‰ 1 ä¸ªå¯å˜å‚æ•°; å¯å˜å‚æ•°çš„å‰é¢è‡³å°‘è¦æœ‰ 1 ä¸ªæœ‰åå‚æ•°; å½“å¯å˜å‚æ•°ä¸­åŒ…å« char ç±»å‹çš„å‚æ•°æ—¶ï¼Œva_arg å®è¦ä»¥ int ç±»å‹çš„æ–¹å¼è¯»å–ï¼›å½“å¯å˜å‚æ•°ä¸­åŒ…å« short ç±»å‹çš„å‚æ•°æ—¶ï¼Œva_arg å®è¦ä»¥ double ç±»å‹çš„æ–¹å¼è¯»å–ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯, â€¦å¯å˜å‚æ•°çš„æ–¹æ³•ä»…é€‚ç”¨äºå‡½æ•°å‚æ•°ï¼Œå¹¶ä¸é€‚ç”¨äºæ¨¡æ¿å‚æ•°ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:6","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.7 å¯å˜å‚æ•°æ¨¡æ¿ C++ 11 æ ‡å‡†å‘å¸ƒä¹‹å‰ï¼Œå‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿åªèƒ½è®¾å®šå›ºå®šæ•°é‡çš„æ¨¡æ¿å‚æ•°ã€‚C++11 æ ‡å‡†å¯¹æ¨¡æ¿çš„åŠŸèƒ½è¿›è¡Œäº†æ‰©å±•ï¼Œå…è®¸æ¨¡æ¿ä¸­åŒ…å«ä»»æ„æ•°é‡çš„æ¨¡æ¿å‚æ•°ï¼Œè¿™æ ·çš„æ¨¡æ¿åˆç§°å¯å˜å‚æ•°æ¨¡æ¿ã€‚ å¯å˜å‚æ•°å‡½æ•°æ¨¡æ¿ template\u003ctypename... T\u003e void vair_fun(T...args) { //å‡½æ•°ä½“ } æ¨¡æ¿å‚æ•°ä¸­ï¼Œ typenameï¼ˆæˆ–è€… classï¼‰åè·Ÿ â€¦ å°±è¡¨æ˜ T æ˜¯ä¸€ä¸ª å¯å˜æ¨¡æ¿å‚æ•° ï¼Œå®ƒå¯ä»¥æ¥æ”¶å¤šç§æ•°æ®ç±»å‹ï¼Œåˆç§° æ¨¡æ¿å‚æ•°åŒ… ã€‚vair_fun() å‡½æ•°ä¸­ï¼Œargs å‚æ•°çš„ç±»å‹ç”¨ Tâ€¦ è¡¨ç¤ºï¼Œè¡¨ç¤º args å‚æ•°å¯ä»¥æ¥æ”¶ä»»æ„ä¸ªå‚æ•°ï¼Œåˆç§° å‡½æ•°å‚æ•°åŒ… ã€‚å³æ­¤å‡½æ•°æ¨¡æ¿æœ€ç»ˆå®ä¾‹åŒ–å‡ºçš„ vair_fun() å‡½æ•°å¯ä»¥æŒ‡å®šä»»æ„ç±»å‹ã€ä»»æ„æ•°é‡çš„å‚æ•°ã€‚ vair_fun(); vair_fun(1, \"abc\"); vair_fun(1, \"abc\", 1.23); åœ¨æ¨¡æ¿å‡½æ•°å†…éƒ¨â€œè§£â€å‚æ•°åŒ…æ–¹æ³•ï¼š æ–¹æ³•ä¸€ï¼šé€’å½’æ–¹å¼è§£åŒ… #include \u003ciostream\u003e using namespace std; //æ¨¡æ¿å‡½æ•°é€’å½’çš„å‡ºå£ void vir_fun() { } template \u003ctypename T, typename... args\u003e void vir_fun(T argc, args... argv) { cout \u003c\u003c argc \u003c\u003c endl; //å¼€å§‹é€’å½’ï¼Œå°†ç¬¬ä¸€ä¸ªå‚æ•°å¤–çš„ argv å‚æ•°åŒ…é‡æ–°ä¼ é€’ç»™ vir_fun vir_fun(argv...); } int main() { vir_fun(1, \"http://www.biancheng.net\", 2.34); return 0; } ç»“æœï¼š 1 http://www.biancheng.net 2.34 ç¨‹åºçš„æ‰§è¡Œæµç¨‹ é¦–å…ˆï¼Œmain() å‡½æ•°è°ƒç”¨ vir_fun() æ¨¡æ¿å‡½æ•°æ—¶ï¼Œæ ¹æ®æ‰€ä¼ å®å‚çš„å€¼ï¼Œå¯ä»¥å¾ˆè½»æ˜“åœ°åˆ¤æ–­å‡ºæ¨¡æ¿å‚æ•° T çš„ç±»å‹ä¸º inTï¼Œå‡½æ•°å‚æ•° argc çš„å€¼ä¸º 1ï¼Œå‰©ä½™çš„æ¨¡æ¿å‚æ•°å’Œå‡½æ•°å‚æ•°éƒ½åˆ†åˆ«ä½äº args å’Œ argv ä¸­ï¼› vir_fun() å‡½æ•°ä¸­ï¼Œé¦–å…ˆè¾“å‡ºäº† argc çš„å€¼ï¼ˆä¸º 1ï¼‰ï¼Œç„¶åé‡å¤è°ƒç”¨è‡ªèº«ï¼ŒåŒæ—¶å°†å‡½æ•°å‚æ•°åŒ… argv ä¸­çš„æ•°æ®ä½œä¸ºå®å‚ä¼ é€’ç»™å½¢å‚ argc å’Œ argvï¼› å†æ¬¡æ‰§è¡Œ vir_fun() å‡½æ•°ï¼Œæ­¤æ—¶æ¨¡æ¿å‚æ•° T çš„ç±»å‹ä¸º char*ï¼Œè¾“å‡º argc çš„å€¼ä¸º http:www.biancheng.netã€‚å†æ¬¡è°ƒç”¨è‡ªèº«ï¼Œç»§ç»­å°† argv åŒ…ä¸­çš„æ•°æ®ä½œä¸ºå®å‚ï¼› å†æ¬¡æ‰§è¡Œ vir_fun() å‡½æ•°ï¼Œæ­¤æ—¶æ¨¡æ¿å‚æ•° T çš„ç±»å‹ä¸º doubleï¼Œè¾“å‡º argc çš„å€¼ä¸º 2.34ã€‚å†æ¬¡è°ƒç”¨è‡ªèº«ï¼Œå°†ç©ºçš„ argv åŒ…ä½œä¸ºå®å‚ï¼› ç”±äº argv åŒ…æ²¡æœ‰æ•°æ®ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨æ— ä»»ä½•å½¢å‚ã€å‡½æ•°ä½“ä¸ºç©ºçš„ vir_fun() å‡½æ•°ï¼Œæœ€ç»ˆæ‰§è¡Œç»“æŸã€‚ **æ³¨æ„:**ä»¥é€’å½’æ–¹å¼è§£åŒ…ï¼Œä¸€å®šè¦è®¾ç½®é€’å½’ç»“æŸçš„å‡ºå£ã€‚ä¾‹å¦‚æœ¬ä¾‹ä¸­ï¼Œæ— å½¢å‚ã€å‡½æ•°ä½“ä¸ºç©ºçš„ vir_fun() å‡½æ•°å°±æ˜¯é€’å½’ç»“æŸçš„å‡ºå£ã€‚ æ–¹æ³•äºŒï¼šéé€’å½’æ–¹å¼è§£åŒ…ï¼ˆå€ŸåŠ©é€—å·è¡¨è¾¾å¼å’Œåˆå§‹åŒ–åˆ—è¡¨ï¼Œä¹Ÿå¯ä»¥è§£å¼€å‚æ•°åŒ…ï¼‰ #include \u003ciostream\u003e using namespace std; template \u003ctypename T\u003e void dispaly(T t) { cout \u003c\u003c t \u003c\u003c endl; } template \u003ctypename... args\u003e void vir_fun(args... argv){ // é€—å·è¡¨è¾¾å¼+åˆå§‹åŒ–åˆ—è¡¨ int arr[] = { (dispaly(argv),0)... }; } int main() { vir_fun(1, \"http://www.biancheng.net\", 2.34); return 0; } ä»¥{ }åˆå§‹åŒ–åˆ—è¡¨çš„æ–¹å¼å¯¹æ•°ç»„ arr è¿›è¡Œäº†åˆå§‹åŒ–ï¼Œ (display(argv),0)â€¦ ä¼šä¾æ¬¡å±•å¼€ä¸º (display(1),0)ã€(display(â€œhttp://www.biancheng.netâ€),0) å’Œ (display(2.34),0)ã€‚ æ‰€ä»¥ï¼Œä¸‹é¢çš„è¯­å¥æ˜¯ç­‰ä»·çš„ï¼š int arr[] = { (dispaly(argv),0)... }; int arr[] = { (dispaly(1),0), (dispaly(\"http://www.biancheng.net\"),0), (dispaly(2.34),0) }; å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªé€—å·è¡¨è¾¾å¼ï¼Œä»¥ (display(1), 0) ä¸ºä¾‹ï¼Œå®ƒä¼šå…ˆè®¡ç®— display(1)ï¼Œç„¶åå°† 0 ä½œä¸ºæ•´ä¸ªè¡¨è¾¾å¼çš„å€¼è¿”å›ç»™æ•°ç»„ï¼Œå› æ­¤ arr æ•°ç»„æœ€ç»ˆå­˜å‚¨çš„éƒ½æ˜¯ 0ã€‚arr æ•°ç»„çº¯ç²¹æ˜¯ä¸ºäº†å°†å‚æ•°åŒ…å±•å¼€ï¼Œæ²¡æœ‰å‘æŒ¥å…¶å®ƒä½œç”¨ã€‚ å¯å˜å‚æ•°ç±»æ¨¡æ¿ C++11 æ ‡å‡†ä¸­ï¼Œç±»æ¨¡æ¿ä¸­çš„æ¨¡æ¿å‚æ•°ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯å˜å‚æ•°ã€‚C++11 æ ‡å‡†æä¾›çš„ tuple å…ƒç»„ç±»å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å¯å˜å‚æ•°æ¨¡æ¿ç±»ã€‚ template \u003ctypename... Types\u003e class tuple; å’Œå›ºå®šæ¨¡æ¿å‚æ•°çš„ç±»ä¸åŒï¼Œtuple æ¨¡æ¿ç±»å®ä¾‹åŒ–æ—¶ï¼Œå¯ä»¥æ¥æ”¶ä»»æ„æ•°é‡ã€ä»»æ„ç±»å‹çš„æ¨¡æ¿å‚æ•°: std::tuple\u003c\u003e tp0; std::tuple\u003cint\u003e tp1 = std::make_tuple(1); std::tuple\u003cint, double\u003e tp2 = std::make_tuple(1, 2.34); std::tuple\u003cint, double, string\u003e tp3 = std::make_tuple(1, 2.34, \"http://www.biancheng.net\"); ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:7","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.8 å¼•å…¥tupleå’ŒLambda tuple çš„åº”ç”¨åœºæ™¯: å½“éœ€è¦å­˜å‚¨å¤šä¸ªä¸åŒç±»å‹çš„å…ƒç´ æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ tupleï¼› å½“å‡½æ•°éœ€è¦è¿”å›å¤šä¸ªæ•°æ®æ—¶ï¼Œå¯ä»¥å°†è¿™äº›æ•°æ®å­˜å‚¨åœ¨ tuple ä¸­ï¼Œå‡½æ•°åªéœ€è¿”å›ä¸€ä¸ª tuple å¯¹è±¡å³å¯ã€‚ å…·ä½“ä½¿ç”¨æ–¹å¼è¯·å‚è€ƒã€ŠC++æ ‡å‡†åº“ã€‹ Lambdaè¯­æ³•æ ¼å¼ [å¤–éƒ¨å˜é‡è®¿é—®æ–¹å¼è¯´æ˜ç¬¦](å‚æ•°) mutable noexcept/throw()-\u003eè¿”å›å€¼ç±»å‹ { å‡½æ•°ä½“; }; [å¤–éƒ¨å˜é‡è®¿é—®æ–¹å¼è¯´æ˜ç¬¦]ï¼š[]æ–¹æ‹¬å·ç”¨äºå‘ç¼–è¯‘å™¨è¡¨æ˜å½“å‰æ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼ï¼Œå…¶ä¸èƒ½è¢«çœç•¥ã€‚åœ¨æ–¹æ‹¬å·å†…éƒ¨ï¼Œå¯ä»¥æ³¨æ˜å½“å‰ lambda å‡½æ•°çš„å‡½æ•°ä½“ä¸­å¯ä»¥ä½¿ç”¨å“ªäº›å¤–éƒ¨å˜é‡(å¤–éƒ¨å˜é‡ï¼ŒæŒ‡çš„æ˜¯å’Œå½“å‰ lambda è¡¨è¾¾å¼ä½äºåŒä¸€ä½œç”¨åŸŸå†…çš„æ‰€æœ‰å±€éƒ¨å˜é‡)ã€‚ å¤–éƒ¨å˜é‡æ ¼å¼ åŠŸèƒ½ [] ç©ºæ–¹æ‹¬å·è¡¨ç¤ºå½“å‰lambdaåŒ¿åå‡½æ•°ä¸å¯¼å…¥ä»»ä½•å¤–éƒ¨å˜é‡ [=] åªæœ‰ä¸€ä¸ª=ç¬¦åˆï¼Œè¡¨ç¤ºä»¥å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥æ‰€æœ‰å¤–éƒ¨å˜é‡ [\u0026] åªæœ‰ä¸€ä¸ª\u0026ç¬¦å·ï¼Œè¡¨ç¤ºä»¥å¼•ç”¨ä¼ é€’çš„æ–¹å¼å¯¼å…¥æ‰€æœ‰å¤–éƒ¨å˜é‡ [val1, val2,â€¦] è¡¨ç¤ºä»¥å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥val1ã€val2ç­‰å¤–éƒ¨å˜é‡ï¼ŒåŒæ—¶å¤šä¸ªå˜é‡ä¹‹é—´æ²¡æœ‰å‰åæ¬¡åº [\u0026val1, \u0026val2,â€¦] è¡¨ç¤ºä»¥å¼•ç”¨ä¼ é€’çš„æ–¹å¼å¯¼å…¥val1ã€val2ç­‰æŒ‡å®šçš„å¤–éƒ¨å˜é‡ï¼Œå¤šä¸ªå˜é‡ä¹‹é—´æ²¡æœ‰å‰åæ¬¡åº [val, \u0026val2,â€¦] ä»¥ä¸Šä¸¤ç§æ–¹å¼è¿˜å¯ä»¥æ··åˆä½¿ç”¨ [=, \u0026val1,â€¦] è¡¨ç¤ºé™¤val1ä»¥å¼•ç”¨ä¼ é€’çš„æ–¹å¼å¯¼å…¥ä»¥å¤–ï¼Œå…¶ä»–å¤–éƒ¨å˜é‡éƒ½ä»¥å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥ [this] è¡¨ç¤ºä»¥å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥å½“å‰çš„thisæŒ‡é’ˆ (å‚æ•°)ï¼šå’Œæ™®é€šå‡½æ•°çš„å®šä¹‰ä¸€æ ·ï¼Œlambda åŒ¿åå‡½æ•°ä¹Ÿå¯ä»¥æ¥æ”¶å¤–éƒ¨ä¼ é€’çš„å¤šä¸ªå‚æ•°ã€‚å’Œæ™®é€šå‡½æ•°ä¸åŒçš„æ˜¯ï¼Œå¦‚æœä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œå¯ä»¥è¿åŒ()å°æ‹¬å·ä¸€èµ·çœç•¥ã€‚ mutableï¼šæ­¤å…³é”®å­—å¯ä»¥çœç•¥ï¼Œå¦‚æœä½¿ç”¨ä¹‹å‰çš„ () å°æ‹¬å·å°†ä¸èƒ½çœç•¥ï¼ˆå‚æ•°ä¸ªæ•°å¯ä»¥ä¸º 0ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹äºä»¥å€¼ä¼ é€’æ–¹å¼å¼•å…¥çš„å¤–éƒ¨å˜é‡ï¼Œä¸å…è®¸åœ¨ lambda è¡¨è¾¾å¼å†…éƒ¨ä¿®æ”¹å®ƒä»¬çš„å€¼ï¼ˆå¯ä»¥ç†è§£ä¸ºè¿™éƒ¨åˆ†å˜é‡éƒ½æ˜¯ const å¸¸é‡ï¼‰ã€‚è€Œå¦‚æœæƒ³ä¿®æ”¹å®ƒä»¬ï¼Œå°±å¿…é¡»ä½¿ç”¨ mutable å…³é”®å­—ã€‚ï¼ˆæ³¨æ„ï¼Œå¯¹äºä»¥å€¼ä¼ é€’æ–¹å¼å¼•å…¥çš„å¤–éƒ¨å˜é‡ï¼Œlambda è¡¨è¾¾å¼ä¿®æ”¹çš„æ˜¯æ‹·è´çš„é‚£ä¸€ä»½ï¼Œå¹¶ä¸ä¼šä¿®æ”¹çœŸæ­£çš„å¤–éƒ¨å˜é‡ï¼‰ã€‚ noexcept/throw()ï¼šå¯ä»¥çœç•¥ï¼Œå¦‚æœä½¿ç”¨ï¼Œåœ¨ä¹‹å‰çš„ () å°æ‹¬å·å°†ä¸èƒ½çœç•¥ï¼ˆå‚æ•°ä¸ªæ•°å¯ä»¥ä¸º 0ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œlambda å‡½æ•°çš„å‡½æ•°ä½“ä¸­å¯ä»¥æŠ›å‡ºä»»ä½•ç±»å‹çš„å¼‚å¸¸ã€‚è€Œæ ‡æ³¨ noexcept å…³é”®å­—ï¼Œåˆ™è¡¨ç¤ºå‡½æ•°ä½“å†…ä¸ä¼šæŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼›ä½¿ç”¨throw()å¯ä»¥æŒ‡å®š lambda å‡½æ•°å†…éƒ¨å¯ä»¥æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚ï¼ˆæ³¨æ„ï¼Œå¦‚æœ lambda å‡½æ•°æ ‡æœ‰ noexcept è€Œå‡½æ•°ä½“å†…æŠ›å‡ºäº†å¼‚å¸¸ï¼Œåˆæˆ–è€…ä½¿ç”¨ throw() é™å®šäº†å¼‚å¸¸ç±»å‹è€Œå‡½æ•°ä½“å†…æŠ›å‡ºäº†éæŒ‡å®šç±»å‹çš„å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸æ— æ³•ä½¿ç”¨ try-catch æ•è·ï¼Œä¼šå¯¼è‡´ç¨‹åºæ‰§è¡Œå¤±è´¥ï¼‰ã€‚ -\u003eè¿”å›å€¼ç±»å‹ï¼šæŒ‡æ˜ lambda åŒ¿åå‡½æ•°çš„è¿”å›å€¼ç±»å‹ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœ lambda å‡½æ•°ä½“å†…åªæœ‰ä¸€ä¸ª return è¯­å¥ï¼Œæˆ–è€…è¯¥å‡½æ•°è¿”å› voidï¼Œåˆ™ç¼–è¯‘å™¨å¯ä»¥è‡ªè¡Œæ¨æ–­å‡ºè¿”å›å€¼ç±»å‹ï¼Œæ­¤æƒ…å†µä¸‹å¯ä»¥ç›´æ¥çœç•¥-\u003e è¿”å›å€¼ç±»å‹ã€‚ å‡½æ•°ä½“ï¼šå’Œæ™®é€šå‡½æ•°ä¸€æ ·ï¼Œlambda åŒ¿åå‡½æ•°åŒ…å«çš„å†…éƒ¨ä»£ç éƒ½æ”¾ç½®åœ¨å‡½æ•°ä½“ä¸­ã€‚è¯¥å‡½æ•°ä½“å†…é™¤äº†å¯ä»¥ä½¿ç”¨æŒ‡å®šä¼ é€’è¿›æ¥çš„å‚æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æŒ‡å®šçš„å¤–éƒ¨å˜é‡ä»¥åŠå…¨å±€èŒƒå›´å†…çš„æ‰€æœ‰å…¨å±€å˜é‡ã€‚ æ³¨æ„:å¤–éƒ¨å˜é‡ä¼šå—åˆ°ä»¥å€¼ä¼ é€’è¿˜æ˜¯ä»¥å¼•ç”¨ä¼ é€’æ–¹å¼å¼•å…¥çš„å½±å“ï¼Œè€Œå…¨å±€å˜é‡åˆ™ä¸ä¼šã€‚æ¢å¥è¯è¯´ï¼Œåœ¨ lambda è¡¨è¾¾å¼å†…å¯ä»¥ä½¿ç”¨ä»»æ„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå¿…è¦æ—¶è¿˜å¯ä»¥ç›´æ¥ä¿®æ”¹å®ƒä»¬çš„å€¼ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:8","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.9 åˆ—è¡¨åˆå§‹åŒ– å…·ä½“ä½¿ç”¨æ–¹å¼è¯·å‚è€ƒã€ŠC++ Primer Plusã€‹ã€ŠC++æ ‡å‡†åº“ã€‹ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:9","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.10 éå—é™è”åˆä½“ POD (Plain Old Data) ç±»å‹ä»‹ç»: PODç±»å‹ä¸€èˆ¬å…·æœ‰ä»¥ä¸‹å‡ ç§ç‰¹å¾ï¼š æ²¡æœ‰ç”¨æˆ·è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œææ„å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°å’Œç§»åŠ¨æ„é€ å‡½æ•° ä¸èƒ½åŒ…å«è™šå‡½æ•°å’Œè™šåŸºç±» éé™æ€æˆå‘˜å¿…é¡»å£°æ˜ä¸ºpublic ç±»ä¸­çš„ç¬¬ä¸€ä¸ªéé™æ€æˆå‘˜çš„ç±»å‹ä¸åŸºç±»ä¸åŒ åœ¨ç±»æˆ–è€…ç»“æ„ä½“ç»§æ‰¿æ—¶ï¼Œæ»¡è¶³ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¹‹ä¸€ï¼š æ´¾ç”Ÿç±»ä¸­æœ‰éé™æ€æˆå‘˜ï¼Œä¸”åªæœ‰ä¸€ä¸ªåŒ…å«é™æ€æˆå‘˜çš„åŸºç±» åŸºç±»æœ‰éé™æ€æˆå‘˜ï¼Œè€Œæ´¾ç”Ÿç±»æ²¡æœ‰éé™æ€æˆå‘˜ æ‰€æœ‰éé™æ€æ•°æ®æˆå‘˜å‡å’Œå…¶åŸºç±»ä¹Ÿç¬¦åˆä¸Šè¿°è§„åˆ™ï¼ˆé€’å½’å®šä¹‰ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´PODç±»å‹ä¸èƒ½åŒ…å«éPODç±»å‹çš„æ•°æ®ã€‚ æ‰€æœ‰å»ºé€šCè¯­è¨€çš„æ•°æ®ç±»å‹éƒ½æ˜¯PODç±»å‹(structã€unionç­‰ä¸èƒ½è¿èƒŒä¸Šè¿°è§„åˆ™) éå—é™è”åˆä½“ åœ¨ C/C++ ä¸­ï¼Œ**è”åˆä½“**æ˜¯ä¸€ç§æ„é€ æ•°æ®ç±»å‹ã€‚åœ¨ä¸€ä¸ªè”åˆä½“å†…ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ªä¸åŒç±»å‹çš„æˆå‘˜ï¼Œè¿™äº›æˆå‘˜å°†ä¼šå…±äº«åŒä¸€å—å†…å­˜ç©ºé—´ã€‚è€ç‰ˆæœ¬çš„ C++ ä¸ºäº†å’ŒCè¯­è¨€ä¿æŒå…¼å®¹ï¼Œå¯¹è”åˆä½“çš„æ•°æ®æˆå‘˜çš„ç±»å‹è¿›è¡Œäº†å¾ˆå¤§ç¨‹åº¦çš„é™åˆ¶ï¼Œè¿™äº›é™åˆ¶åœ¨ä»Šå¤©çœ‹æ¥å¹¶æ²¡æœ‰å¿…è¦ï¼Œå› æ­¤ C++11 å–æ¶ˆäº†è¿™äº›é™åˆ¶ã€‚ C++11 æ ‡å‡†è§„å®šï¼Œä»»ä½•éå¼•ç”¨ç±»å‹éƒ½å¯ä»¥æˆä¸ºè”åˆä½“çš„æ•°æ®æˆå‘˜ï¼Œè¿™ç§è”åˆä½“ä¹Ÿè¢«ç§°ä¸º**éå—é™è”åˆä½“**ã€‚ class Student{ public: Student(bool g, int a): gender(g), age(a) {} private: bool gender; int age; }; union T{ Student s; // å«æœ‰éPODç±»å‹çš„æˆå‘˜ï¼Œgcc-5.1.0 ç‰ˆæœ¬æŠ¥é”™ char name[10]; }; ä¸Šè¿°çš„ä»£ç ä¸­ï¼Œå› ä¸º Student ç±»å¸¦æœ‰è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªé POD ç±»å‹çš„ï¼Œè¿™å¯¼è‡´ç¼–è¯‘å™¨æŠ¥é”™ã€‚ C++ 11æ”¹è¿›1: C++11å…è®¸éPODç±»å‹ C++11å…è®¸è”åˆä½“åˆé™æ€æˆå‘˜(é™æ€æˆå‘˜å˜é‡æ™ºèƒ½åœ¨è”åˆä½“å†…å®šä¹‰ï¼Œå´ä¸èƒ½åœ¨è”åˆä½“å¤–ä½¿ç”¨) éå—é™è”åˆä½“çš„èµ‹å€¼æ³¨æ„äº‹é¡¹ï¼š C++11è§„å®šï¼Œå¦‚æœéå—é™è”åˆä½“å†…æœ‰ä¸€ä¸ªé POD çš„æˆå‘˜ï¼Œè€Œè¯¥æˆå‘˜æ‹¥æœ‰è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªéå—é™è”åˆä½“çš„é»˜è®¤æ„é€ å‡½æ•°å°†è¢«ç¼–è¯‘å™¨åˆ é™¤ï¼›å…¶ä»–çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œä¾‹å¦‚é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ã€æ‹·è´èµ‹å€¼æ“ä½œç¬¦ä»¥åŠææ„å‡½æ•°ç­‰ï¼Œä¹Ÿå°†è¢«åˆ é™¤ã€‚ #include \u003cstring\u003e using namespace std; union U { string s; int n; }; int main() { // æ„é€ å¤±è´¥ï¼Œå› ä¸º U çš„æ„é€ å‡½æ•°è¢«åˆ é™¤ U u; return 0; } åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå› ä¸º string ç±»æ‹¥æœ‰è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥ U çš„æ„é€ å‡½æ•°è¢«åˆ é™¤ï¼›å®šä¹‰ U çš„ç±»å‹å˜é‡ u éœ€è¦è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥ u ä¹Ÿå°±æ— æ³•å®šä¹‰æˆåŠŸã€‚ è§£å†³ä¸Šé¢é—®é¢˜çš„ä¸€èˆ¬éœ€è¦ç”¨åˆ° placement new: placement new æ˜¯ new å…³é”®å­—çš„ä¸€ç§è¿›é˜¶ç”¨æ³•ï¼Œæ—¢å¯ä»¥åœ¨æ ˆï¼ˆstackï¼‰ä¸Šç”Ÿæˆå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥åœ¨å †ï¼ˆheapï¼‰ä¸Šç”Ÿæˆå¯¹è±¡ã€‚ç›¸å¯¹åº”åœ°ï¼ŒæŠŠå¸¸è§çš„newçš„ç”¨æ³•ç§°ä¸º operator newï¼Œå®ƒåªèƒ½åœ¨ heap ä¸Šç”Ÿæˆå¯¹è±¡ã€‚ placement new çš„è¯­æ³•æ ¼å¼: new(address) ClassConstruct(â€¦) address è¡¨ç¤ºå·²æœ‰å†…å­˜çš„åœ°å€ï¼Œè¯¥å†…å­˜å¯ä»¥åœ¨æ ˆä¸Šï¼Œä¹Ÿå¯ä»¥åœ¨å †ä¸Š; ClassConstruct(â€¦) è¡¨ç¤ºè°ƒç”¨ç±»çš„æ„é€ å‡½æ•°ï¼Œå¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿå¯ä»¥çœç•¥æ‹¬å·ã€‚ placement new åˆ©ç”¨å·²ç»ç”³è¯·å¥½çš„å†…å­˜æ¥ç”Ÿæˆå¯¹è±¡ï¼Œå®ƒä¸å†ä¸ºå¯¹è±¡åˆ†é…æ–°çš„å†…å­˜ï¼Œè€Œæ˜¯å°†å¯¹è±¡æ•°æ®æ”¾åœ¨ address æŒ‡å®šçš„å†…å­˜ä¸­ã€‚ #include \u003cstring\u003e using namespace std; union U { string s; int n; public: U() { new(\u0026s) string; } ~U() { s.~string(); } }; int main() { U u; return 0; } æ„é€ æ—¶ï¼Œé‡‡ç”¨ placement new å°† s æ„é€ åœ¨å…¶åœ°å€ \u0026s ä¸Šï¼Œè¿™é‡Œ placement new çš„å”¯ä¸€ä½œç”¨åªæ˜¯è°ƒç”¨äº†ä¸€ä¸‹ string ç±»çš„æ„é€ å‡½æ•°ã€‚æ³¨æ„ï¼Œåœ¨ææ„æ—¶è¿˜éœ€è¦è°ƒç”¨ string ç±»çš„ææ„å‡½æ•°ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:10","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.11 éå—é™è”åˆä½“çš„åŒ¿åå£°æ˜å’Œâ€œæšä¸¾å¼ç±»â€ åŒ¿åè”åˆä½“æ˜¯æŒ‡ä¸å…·åçš„è”åˆä½“ï¼ˆä¹Ÿå³æ²¡æœ‰åå­—çš„è”åˆä½“ï¼‰ï¼Œå®šä¹‰å¦‚ä¸‹: union U{ // æ­¤è”åˆä½“ä¸ºåŒ¿åè”åˆä½“ union { int x; }; }; è”åˆä½“ U å†…å®šä¹‰äº†ä¸€ä¸ªä¸å…·åçš„è”åˆä½“ï¼Œè¯¥è”åˆä½“åŒ…å«ä¸€ä¸ª int ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œç§°è¿™ä¸ªè”åˆä½“ä¸ºåŒ¿åè”åˆä½“ã€‚ éå—é™è”åˆä½“ä¹Ÿå¯ä»¥åŒ¿åï¼Œè€Œå½“éå—é™çš„åŒ¿åè”åˆä½“è¿ç”¨äºç±»çš„å£°æ˜æ—¶ï¼Œè¿™æ ·çš„ç±»è¢«ç§°ä¸ºæšä¸¾å¼ç±»ã€‚ #include \u003ccstring\u003e using namespace std; class Student{ public: Student(bool g, int a): gender(g), age(a){} bool gender; int age; }; class Singer { public: enum Type { STUDENT, NATIVE, FOREIGENR }; Singer(bool g, int a) : s(g, a) { t = STUDENT; } Singer(int i) : id(i) { t = NATIVE; } Singer(const char* n, int s) { int size = (s \u003e 9) ? 9 : s; memcpy(name , n, size); name[s] = '\\0'; t = FOREIGENR; } ~Singer(){} private: Type t; union { Student s; int id; char name[10]; }; }; int main() { Singer(true, 13); Singer(310217); Singer(\"J Michael\", 9); return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:11","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.12 forå¾ªç¯(åŸºäºèŒƒå›´çš„å¾ªç¯) C++ 11æ ‡å‡†ä¹‹å‰ï¼ˆC++ 98/03 æ ‡å‡†ï¼‰ï¼Œå¦‚æœè¦ç”¨ for å¾ªç¯è¯­å¥éå†ä¸€ä¸ªæ•°ç»„æˆ–è€…å®¹å™¨ï¼Œåªèƒ½å¥—ç”¨å¦‚ä¸‹ç»“æ„: for(è¡¨è¾¾å¼ 1; è¡¨è¾¾å¼ 2; è¡¨è¾¾å¼ 3){ //å¾ªç¯ä½“ } ä¸¾ä¾‹: #include \u003ciostream\u003e #include \u003cvector\u003e #include \u003cstring.h\u003e using namespace std; int main() { char arc[] = \"http://c.biancheng.net/cplus/11/\"; int i; // forå¾ªç¯éå†æ™®é€šæ•°ç»„ for (i = 0; i \u003c strlen(arc); i++) { cout \u003c\u003c arc[i]; } cout \u003c\u003c endl; vector\u003cchar\u003emyvector(arc,arc+23); vector\u003cchar\u003e::iterator iter; // forå¾ªç¯éå† vector å®¹å™¨ for (iter = myvector.begin(); iter != myvector.end(); ++iter) { cout \u003c\u003c *iter; } return 0; } C++ 11 æ ‡å‡†ä¸­ï¼Œé™¤äº†å¯ä»¥æ²¿ç”¨å‰é¢ä»‹ç»çš„ç”¨æ³•å¤–ï¼Œè¿˜ä¸º for å¾ªç¯æ·»åŠ äº†ä¸€ç§å…¨æ–°çš„è¯­æ³•æ ¼å¼: for (declaration : expression){ //å¾ªç¯ä½“ } declaration:è¡¨ç¤ºæ­¤å¤„è¦å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œè¯¥å˜é‡çš„ç±»å‹ä¸ºè¦éå†åºåˆ—ä¸­å­˜å‚¨å…ƒç´ çš„ç±»å‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒC++ 11 æ ‡å‡†ä¸­ï¼Œdeclarationå‚æ•°å¤„å®šä¹‰çš„å˜é‡ç±»å‹å¯ä»¥ç”¨ auto å…³é”®å­—è¡¨ç¤ºï¼Œè¯¥å…³é”®å­—å¯ä»¥ä½¿ç¼–è¯‘å™¨è‡ªè¡Œæ¨å¯¼è¯¥å˜é‡çš„æ•°æ®ç±»å‹ã€‚ expression:è¡¨ç¤ºè¦éå†çš„åºåˆ—ï¼Œå¸¸è§çš„å¯ä»¥ä¸ºäº‹å…ˆå®šä¹‰å¥½çš„æ™®é€šæ•°ç»„æˆ–è€…å®¹å™¨ï¼Œè¿˜å¯ä»¥æ˜¯ç”¨ {} å¤§æ‹¬å·åˆå§‹åŒ–çš„åºåˆ—ã€‚ #include \u003ciostream\u003e #include \u003cvector\u003e using namespace std; int main() { char arc[] = \"http://c.biancheng.net/cplus/11/\"; // forå¾ªç¯éå†æ™®é€šæ•°ç»„ for (char ch : arc) { cout \u003c\u003c ch; } cout \u003c\u003c '!' \u003c\u003c endl; vector\u003cchar\u003emyvector(arc, arc + 23); // forå¾ªç¯éå† vector å®¹å™¨ for (auto ch : myvector) { cout \u003c\u003c ch; } cout \u003c\u003c '!'; // æ–°è¯­æ³•æ ¼å¼çš„ for å¾ªç¯è¿˜æ”¯æŒéå†ç”¨{ }å¤§æ‹¬å·åˆå§‹åŒ–çš„åˆ—è¡¨ for (int num : {1, 2, 3, 4, 5}) { cout \u003c\u003c num \u003c\u003c \" \"; } return 0; } æ³¨æ„: ç¨‹åºä¸­åœ¨éå† myvector å®¹å™¨æ—¶ï¼Œå®šä¹‰äº† auto ç±»å‹çš„ ch å˜é‡ï¼Œå½“ç¼–è¯‘å™¨ç¼–è¯‘ç¨‹åºæ—¶ï¼Œä¼šé€šè¿‡ myvector å®¹å™¨ä¸­å­˜å‚¨çš„å…ƒç´ ç±»å‹è‡ªåŠ¨æ¨å¯¼å‡º ch ä¸º char ç±»å‹ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„ ch ä¸æ˜¯è¿­ä»£å™¨ç±»å‹ï¼Œè€Œè¡¨ç¤ºçš„æ˜¯ myvector å®¹å™¨ä¸­å­˜å‚¨çš„æ¯ä¸ªå…ƒç´ ã€‚ åœ¨è¾“å‡ºç»“æœï¼Œå…¶ä¸­ç¬¬ä¸€è¡Œè¾“å‡ºçš„å­—ç¬¦ä¸²å’Œ ! ä¹‹é—´è¿˜è¾“å‡ºæœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œå› ä¸ºæ–°æ ¼å¼çš„ for å¾ªç¯åœ¨éå†å­—ç¬¦ä¸²åºåˆ—æ—¶ï¼Œä¸åªæ˜¯éå†åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œè¿˜ä¼šéå†ä½äºè¯¥å­—ç¬¦ä¸²æœ«å°¾çš„ \\0ï¼ˆå­—ç¬¦ä¸²çš„ç»“æŸæ ‡å¿—ï¼‰ã€‚ æ³¨æ„: åœ¨ä½¿ç”¨æ–°è¯­æ³•æ ¼å¼çš„ for å¾ªç¯éå†æŸä¸ªåºåˆ—æ—¶ï¼Œå¦‚æœéœ€è¦éå†çš„åŒæ—¶ä¿®æ”¹åºåˆ—ä¸­å…ƒç´ çš„å€¼ï¼Œå®ç°æ–¹æ¡ˆæ˜¯åœ¨ declaration å‚æ•°å¤„å®šä¹‰å¼•ç”¨å½¢å¼çš„å˜é‡ã€‚ #include \u003ciostream\u003e #include \u003cvector\u003e using namespace std; int main() { char arc[] = \"abcde\"; vector\u003cchar\u003emyvector(arc, arc + 5); // forå¾ªç¯éå†å¹¶ä¿®æ”¹å®¹å™¨ä¸­å„ä¸ªå­—ç¬¦çš„å€¼ for (auto \u0026ch : myvector) { ch++; } // forå¾ªç¯éå†è¾“å‡ºå®¹å™¨ä¸­å„ä¸ªå­—ç¬¦ for (auto ch : myvector) { cout \u003c\u003c ch; } return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:12","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.13 constexprï¼šéªŒè¯æ˜¯å¦ä¸ºå¸¸é‡è¡¨è¾¾å¼ constexpr æ˜¯ C++ 11 æ ‡å‡†æ–°å¼•å…¥çš„å…³é”®å­—ã€‚ å¸¸é‡è¡¨è¾¾å¼ï¼ŒæŒ‡çš„å°±æ˜¯ç”±å¤šä¸ªï¼ˆâ‰¥1ï¼‰å¸¸é‡ç»„æˆçš„è¡¨è¾¾å¼ã€‚å³å¦‚æœè¡¨è¾¾å¼ä¸­çš„æˆå‘˜éƒ½æ˜¯å¸¸é‡ï¼Œé‚£ä¹ˆè¯¥è¡¨è¾¾å¼å°±æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œå¸¸é‡è¡¨è¾¾å¼ä¸€æ—¦ç¡®å®šï¼Œå…¶å€¼å°†æ— æ³•ä¿®æ”¹ã€‚ ä»¥å®šä¹‰æ•°ç»„ä¸ºä¾‹ï¼Œæ•°ç»„çš„é•¿åº¦å°±å¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ï¼š //æ­£ç¡® int url[10]; // æ­£ç¡® int url[6 + 4]; // é”™è¯¯ï¼Œlengthæ˜¯å˜é‡ int length = 6; // æ”¹è¿›ï¼š const int length = 6; int url[length] ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ä¸ºé¢„å¤„ç†ã€ç¼–è¯‘ã€æ±‡ç¼–å’Œé“¾æ¥å››ä¸ªé˜¶æ®µï¼Œå…·ä½“è¯·å‚è€ƒè®¡ç®—æœºç³»ç»Ÿæ¼«æ¸¸(ä¸€)ã€‚å¤§è‡´åˆå¯ä»¥è¯´ç”±ç¼–è¯‘ã€é“¾æ¥ã€è¿è¡Œè¿™3 ä¸ªé˜¶æ®µã€‚å¸¸é‡è¡¨è¾¾å¼å’Œéå¸¸é‡è¡¨è¾¾å¼çš„è®¡ç®—æ—¶æœºä¸åŒï¼Œéå¸¸é‡è¡¨è¾¾å¼åªèƒ½åœ¨ç¨‹åºè¿è¡Œé˜¶æ®µè®¡ç®—å‡ºç»“æœï¼›è€Œå¸¸é‡è¡¨è¾¾å¼çš„è®¡ç®—å¾€å¾€å‘ç”Ÿåœ¨ç¨‹åºçš„ç¼–è¯‘é˜¶æ®µï¼Œè¿™å¯ä»¥æå¤§æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼Œå› ä¸ºè¡¨è¾¾å¼åªéœ€è¦åœ¨ç¼–è¯‘é˜¶æ®µè®¡ç®—ä¸€æ¬¡ï¼ŒèŠ‚çœäº†æ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶éƒ½éœ€è¦è®¡ç®—ä¸€æ¬¡çš„æ—¶é—´ã€‚ åœ¨å®é™…å¼€å‘ä¸­ï¼Œåˆ¤å®šä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦ä¸ºå¸¸é‡è¡¨è¾¾å¼æ–¹å¼: äººä¸ºåˆ¤å®šï¼› C++11 æ ‡å‡†è¿˜æä¾›æœ‰ constexpr å…³é”®å­—ã€‚ constexprä¿®é¥°æ™®é€šå˜é‡ C++11 æ ‡å‡†ä¸­ï¼Œå®šä¹‰å˜é‡æ—¶å¯ä»¥ç”¨ constexpr ä¿®é¥°ï¼Œä»è€Œä½¿è¯¥å˜é‡è·å¾—åœ¨ç¼–è¯‘é˜¶æ®µå³å¯è®¡ç®—å‡ºç»“æœçš„èƒ½åŠ›ã€‚ ä½¿ç”¨ constexpr ä¿®æ”¹æ™®é€šå˜é‡æ—¶ï¼Œå˜é‡å¿…é¡»ç»è¿‡åˆå§‹åŒ–ä¸”åˆå§‹å€¼å¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ã€‚ #include \u003ciostream\u003e using namespace std; int main() { constexpr int num = 1 + 2 + 3; int url[num] = {1,2,3,4,5,6}; couts\u003c\u003c url[1] \u003c\u003c endl; return 0; } ä¸Šè¿°ä»£ç ä¸­ï¼Œå¦‚æœå°è¯•å°† constexpr åˆ é™¤ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨ä¼šæç¤ºurl[num] å®šä¹‰ä¸­ num ä¸å¯ç”¨ä½œå¸¸é‡ã€‚ä½¿ç”¨ constexpr ä¿®é¥° num å˜é‡ï¼ŒåŒæ—¶å°† 1+2+3 è¿™ä¸ªå¸¸é‡è¡¨è¾¾å¼èµ‹å€¼ç»™ numã€‚ç”±æ­¤ï¼Œç¼–è¯‘å™¨å°±å¯ä»¥åœ¨ç¼–è¯‘æ—¶æœŸå¯¹ num è¿™ä¸ªè¡¨è¾¾å¼è¿›è¡Œè®¡ç®—ï¼Œå› ä¸º num å¯ä»¥ä½œä¸ºå®šä¹‰æ•°ç»„æ—¶çš„é•¿åº¦ã€‚ æ³¨æ„:å½“å¸¸é‡è¡¨è¾¾å¼ä¸­åŒ…å«æµ®ç‚¹æ•°æ—¶ï¼Œè€ƒè™‘åˆ°ç¨‹åºç¼–è¯‘å’Œè¿è¡Œæ‰€åœ¨çš„ç³»ç»Ÿç¯å¢ƒå¯èƒ½ä¸åŒï¼Œå¸¸é‡è¡¨è¾¾å¼åœ¨ç¼–è¯‘é˜¶æ®µå’Œè¿è¡Œé˜¶æ®µè®¡ç®—å‡ºçš„ç»“æœç²¾åº¦å¾ˆå¯èƒ½ä¼šå—åˆ°å½±å“ï¼Œå› æ­¤ C++11 æ ‡å‡†è§„å®šï¼Œæµ®ç‚¹å¸¸é‡è¡¨è¾¾å¼åœ¨ç¼–è¯‘é˜¶æ®µè®¡ç®—çš„ç²¾åº¦è¦è‡³å°‘ç­‰äºï¼ˆæˆ–è€…é«˜äºï¼‰è¿è¡Œé˜¶æ®µè®¡ç®—å‡ºçš„ç²¾åº¦ã€‚ constexprä¿®é¥°å‡½æ•° è¿™æ ·çš„å‡½æ•°åˆç§°ä¸ºå¸¸é‡è¡¨è¾¾å¼å‡½æ•°ã€‚ constexpr å¹¶éå¯ä»¥ä¿®æ”¹ä»»æ„å‡½æ•°çš„è¿”å›å€¼ã€‚å¿…é¡»æ»¡è¶³å¦‚ä¸‹æ¡ä»¶: æ•´ä¸ªå‡½æ•°çš„å‡½æ•°ä½“ä¸­ï¼Œé™¤äº†å¯ä»¥åŒ…å« using æŒ‡ä»¤ã€typedef è¯­å¥ä»¥åŠstatic_assertæ–­è¨€å¤–ï¼Œåªèƒ½åŒ…å«ä¸€æ¡ return è¿”å›è¯­å¥ã€‚ constexpr int display(int x) { // å¯ä»¥æ·»åŠ  using æ‰§è¡Œã€typedef è¯­å¥ä»¥åŠ static_assert æ–­è¨€ return 1 + 2 + x; } è¯¥å‡½æ•°å¿…é¡»æœ‰è¿”å›å€¼ï¼Œå³å‡½æ•°çš„è¿”å›å€¼ç±»å‹ä¸èƒ½æ˜¯ void å‡½æ•°åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œå¿…é¡»æœ‰å¯¹åº”çš„å®šä¹‰è¯­å¥ã€‚å‡½æ•°çš„ä½¿ç”¨åˆ†ä¸ºâ€œå£°æ˜â€å’Œâ€œå®šä¹‰â€ä¸¤éƒ¨åˆ†ï¼Œæ™®é€šçš„å‡½æ•°è°ƒç”¨åªéœ€è¦æå‰å†™å¥½è¯¥å‡½æ•°çš„å£°æ˜éƒ¨åˆ†å³å¯ï¼ˆå‡½æ•°çš„å®šä¹‰éƒ¨åˆ†å¯ä»¥æ”¾åœ¨è°ƒç”¨ä½ç½®ä¹‹åç”šè‡³å…¶å®ƒæ–‡ä»¶ä¸­ï¼‰ï¼Œä½†å¸¸é‡è¡¨è¾¾å¼å‡½æ•°åœ¨ä½¿ç”¨å‰ï¼Œå¿…é¡»è¦æœ‰è¯¥å‡½æ•°çš„å®šä¹‰ã€‚ return è¿”å›çš„è¡¨è¾¾å¼å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ æ³¨æ„:åœ¨å¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„ return è¯­å¥ä¸­ï¼Œä¸èƒ½åŒ…å«èµ‹å€¼çš„æ“ä½œï¼ˆä¾‹å¦‚ return x=1 åœ¨å¸¸é‡è¡¨è¾¾å¼å‡½æ•°ä¸­ä¸å…è®¸çš„ï¼‰ã€‚å¦å¤–ï¼Œç”¨ constexpr ä¿®æ”¹å‡½æ•°æ—¶ï¼Œå‡½æ•°æœ¬èº«ä¹Ÿæ˜¯æ”¯æŒé€’å½’çš„ã€‚ constexprä¿®é¥°ç±»çš„æ„é€ å‡½æ•° å¯¹äº C++ å†…ç½®ç±»å‹çš„æ•°æ®ï¼Œå¯ä»¥ç›´æ¥ç”¨ constexpr ä¿®é¥°ï¼Œä½†å¦‚æœæ˜¯è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼ˆç”¨ struct æˆ–è€… class å®ç°ï¼‰ï¼Œç›´æ¥ç”¨ constexpr ä¿®é¥°æ˜¯ä¸è¡Œçš„ã€‚ è‡ªå®šä¹‰ä¸€ä¸ªå¯äº§ç”Ÿå¸¸é‡çš„ç±»å‹æ—¶ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯åœ¨è¯¥ç±»å‹çš„å†…éƒ¨æ·»åŠ ä¸€ä¸ªå¸¸é‡æ„é€ å‡½æ•°: #include \u003ciostream\u003e using namespace std; // è‡ªå®šä¹‰ç±»å‹çš„å®šä¹‰ struct MyType { constexpr MyType(char *name,int age):name(name),age(age){}; const char* name; int age; //å…¶å®ƒç»“æ„ä½“æˆå‘˜ }; int main() { constexpr struct MyType mt { \"zhangsan\", 10 }; cout \u003c\u003c mt.name \u003c\u003c \" \" \u003c\u003c mt.age \u003c\u003c endl; return 0; } æ³¨æ„: constexpr ä¿®é¥°ç±»çš„æ„é€ å‡½æ•°æ—¶ï¼Œè¦æ±‚è¯¥æ„é€ å‡½æ•°çš„å‡½æ•°ä½“å¿…é¡»ä¸ºç©ºï¼Œä¸”é‡‡ç”¨åˆå§‹åŒ–åˆ—è¡¨çš„æ–¹å¼ä¸ºå„ä¸ªæˆå‘˜èµ‹å€¼æ—¶ï¼Œå¿…é¡»ä½¿ç”¨å¸¸é‡è¡¨è¾¾å¼ã€‚ constexpr å¯ç”¨äºä¿®é¥°å‡½æ•°ï¼Œè€Œç±»ä¸­çš„æˆå‘˜æ–¹æ³•å®Œå…¨å¯ä»¥çœ‹åšæ˜¯ä½äºç±»è¿™ä¸ªå‘½åç©ºé—´ä¸­çš„å‡½æ•°ï¼Œæ‰€ä»¥ constexpr ä¹Ÿå¯ä»¥ä¿®é¥°ç±»ä¸­çš„æˆå‘˜å‡½æ•°ï¼Œåªä¸è¿‡æ­¤å‡½æ•°å¿…é¡»æ»¡è¶³å‰é¢æåˆ°æ¡ä»¶ã€‚ æ³¨æ„: C++11 æ ‡å‡†ä¸­ï¼Œä¸æ”¯æŒç”¨ constexpr ä¿®é¥°å¸¦æœ‰ virtual çš„æˆå‘˜æ–¹æ³•ã€‚ constexprä¿®é¥°æ¨¡æ¿å‡½æ•° C++11 è¯­æ³•ä¸­ï¼Œconstexpr å¯ä»¥ä¿®é¥°æ¨¡æ¿å‡½æ•°ï¼Œä½†ç”±äºæ¨¡æ¿ä¸­ç±»å‹çš„ä¸ç¡®å®šæ€§ï¼Œå› æ­¤æ¨¡æ¿å‡½æ•°å®ä¾‹åŒ–åçš„å‡½æ•°æ˜¯å¦ç¬¦åˆå¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„è¦æ±‚ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ã€‚ é’ˆå¯¹è¿™ç§æƒ…å†µä¸‹ï¼ŒC++11 æ ‡å‡†è§„å®šï¼Œå¦‚æœ constexpr ä¿®é¥°çš„æ¨¡æ¿å‡½æ•°å®ä¾‹åŒ–ç»“æœä¸æ»¡è¶³å¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„è¦æ±‚ï¼Œåˆ™ constexpr ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ï¼Œå³è¯¥å‡½æ•°å°±ç­‰åŒäºä¸€ä¸ªæ™®é€šå‡½æ•°ã€‚ constexprä¸constçš„åŒºåˆ« C++ 11æ ‡å‡†ä¸­ï¼Œä¸ºäº†è§£å†³ const å…³é”®å­—çš„åŒé‡è¯­ä¹‰é—®é¢˜ï¼Œä¿ç•™äº† const è¡¨ç¤ºâ€œåªè¯»â€çš„è¯­ä¹‰ï¼Œè€Œå°†â€œå¸¸é‡â€çš„è¯­ä¹‰åˆ’åˆ†ç»™äº†æ–°æ·»åŠ çš„ constexpr å…³é”®å­—ã€‚å› æ­¤ C++11 æ ‡å‡†ä¸­ï¼Œå»ºè®®å°† const å’Œ constexpr çš„åŠŸèƒ½åŒºåˆ†å¼€ï¼Œå³å‡¡æ˜¯è¡¨è¾¾åªè¯»è¯­ä¹‰çš„åœºæ™¯éƒ½ä½¿ç”¨ constï¼Œè¡¨è¾¾å¸¸é‡è¯­ä¹‰çš„åœºæ™¯éƒ½ä½¿ç”¨ constexprã€‚ åªè¯»å’Œä¸å…è®¸è¢«ä¿®æ”¹ä¹‹é—´å¹¶æ²¡æœ‰å¿…ç„¶çš„è”ç³» #include \u003ciostream\u003e using namespace std; int main() { int a = 10; const int \u0026 con_b = a; cout \u003c\u003c con_b \u003c\u003c endl; a = 20; cout \u003c\u003c con_b \u003c\u003c endl; } ç¨‹åºä¸­ç”¨ const ä¿®é¥°äº† con_b å˜é‡ï¼Œè¡¨ç¤ºè¯¥å˜é‡åªè¯»ï¼Œå³æ— æ³•é€šè¿‡å˜é‡è‡ªèº«å»ä¿®æ”¹è‡ªå·±çš„å€¼ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ con_b çš„å€¼ä¸èƒ½å€ŸåŠ©å…¶å®ƒå˜é‡é—´æ¥æ”¹å˜ï¼Œé€šè¿‡æ”¹å˜ a çš„å€¼å°±å¯ä»¥ä½¿ con_b çš„å€¼å‘ç”Ÿå˜åŒ–ã€‚ åœ¨å¤§éƒ¨åˆ†å®é™…åœºæ™¯ä¸­ï¼Œconst å’Œ constexpr æ˜¯å¯ä»¥æ··ç”¨çš„: const int a = 5 + 4; constexpr int a = 5 + 4; åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œå¿…é¡»æ˜ç¡®ä½¿ç”¨ constexpr #include \u003ciostream\u003e #include \u003carray\u003e using namespace std; constexpr int sqr1(int arg) { return arg * arg; } const int sqr2(int arg) { return arg * arg; } int main() { // å¯ä»¥ï¼Œå› ä¸ºsqr1æ—¶constexprå‡½æ•° array\u003cint,sqr1(10)\u003e mylist1; // ä¸å¯ä»¥ï¼Œå› ä¸ºsqr2ä¸æ˜¯constexprå‡½æ•° array\u003cint,sqr2(10)\u003e mylist1; return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:13","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.14 long longè¶…é•¿æ•´å½¢ å°† long long æ•´å½¢å†™å…¥ C++ 11 æ ‡å‡†ä¸­ï¼Œå¦‚åŒ long ç±»å‹æ•´æ•°éœ€æ˜ç¡®æ ‡æ³¨ L æˆ–è€… l åç¼€ä¸€æ ·ï¼Œè¦ä½¿ç”¨ long long ç±»å‹çš„æ•´æ•°ï¼Œä¹Ÿå¿…é¡»æ ‡æ³¨å¯¹åº”çš„åç¼€ï¼š å¯¹äºæœ‰ç¬¦å· long long æ•´å½¢ï¼Œåç¼€ç”¨ LL æˆ–è€… ll æ ‡è¯†ã€‚å¦‚ï¼Œ10LL å°±è¡¨ç¤ºæœ‰ç¬¦å·è¶…é•¿æ•´æ•° 10ã€‚ å¯¹äºæ— ç¬¦å· long long æ•´å½¢ï¼Œåç¼€ç”¨ ULLã€ullã€Ull æˆ–è€… uLL æ ‡è¯†ã€‚å¦‚ï¼Œ10ULL å°±è¡¨ç¤ºæ— ç¬¦å·è¶…é•¿æ•´æ•° 10ï¼› æ³¨æ„: å¦‚æœä¸æ·»åŠ ä»»ä½•æ ‡è¯†ï¼Œåˆ™æ‰€æœ‰çš„æ•´æ•°éƒ½ä¼šé»˜è®¤ä¸º int ç±»å‹ã€‚ äº†è§£å½“å‰å¹³å°ä¸Š long long æ•´å½¢çš„å–å€¼èŒƒå›´ï¼Œå¯ä»¥ä½¿ç”¨å¤´æ–‡ä»¶ä¸­ä¸ long long æ•´å½¢ç›¸å…³çš„ 3 ä¸ªå®ï¼Œåˆ†åˆ«ä¸º LLONG_MINã€LLONG_MAX å’Œ ULLONG_MINï¼š LLONG_MINï¼šä»£è¡¨å½“å‰å¹³å°ä¸Šæœ€å°çš„ long long ç±»å‹æ•´æ•°ï¼› LLONG_MAXï¼šä»£è¡¨å½“å‰å¹³å°ä¸Šæœ€å¤§çš„ long long ç±»å‹æ•´æ•°ï¼› ULLONG_MINï¼šä»£è¡¨å½“å‰å¹³å°ä¸Šæœ€å¤§çš„ unsigned long long ç±»å‹æ•´æ•°ï¼ˆæ— ç¬¦å·è¶…é•¿æ•´å‹çš„æœ€å°å€¼ä¸º 0ï¼‰ï¼› #include \u003ciostream\u003e #include \u003ciomanip\u003e #include \u003cclimits\u003e using namespace std; int main() { cout \u003c\u003c\"long longæœ€å¤§å€¼ï¼š\" \u003c\u003c LLONG_MIN \u003c\u003c\" \"\u003c\u003c hex \u003c\u003c LLONG_MIN \u003c\u003c\"\\n\"; cout \u003c\u003c dec \u003c\u003c\"long longæœ€å°å€¼ï¼š\" \u003c\u003c LLONG_MAX \u003c\u003c \" \" \u003c\u003c hex \u003c\u003c LLONG_MAX \u003c\u003c \"\\n\"; cout \u003c\u003c dec \u003c\u003c \"unsigned long longæœ€å¤§å€¼ï¼š\" \u003c\u003c ULLONG_MAX \u003c\u003c \" \" \u003c\u003c hex \u003c\u003c ULLONG_MAX; return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:14","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.15 å³å€¼å¼•ç”¨ C++å·¦å€¼å’Œå³å€¼ åœ¨ C++/C è¯­è¨€ä¸­ï¼Œä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆå¯ä»¥æ˜¯å­—é¢é‡ã€å˜é‡ã€å¯¹è±¡ã€å‡½æ•°çš„è¿”å›å€¼ç­‰ï¼‰æ ¹æ®å…¶ä½¿ç”¨åœºæ™¯ä¸åŒï¼Œåˆ†ä¸ºå·¦å€¼è¡¨è¾¾å¼å’Œå³å€¼è¡¨è¾¾å¼ã€‚ç¡®åˆ‡çš„è¯´ C++ ä¸­å·¦å€¼å’Œå³å€¼çš„æ¦‚å¿µæ˜¯ä» C è¯­è¨€ç»§æ‰¿è¿‡æ¥çš„ã€‚ æ³¨æ„ï¼šå·¦å€¼çš„è‹±æ–‡ç®€å†™ä¸ºlvalueï¼Œå³å€¼çš„è‹±æ–‡ç®€å†™ä¸ºrvalueã€‚å¾ˆå¤šäººè®¤ä¸ºå®ƒä»¬åˆ†åˆ«æ˜¯left valueã€right value çš„ç¼©å†™ã€‚å…¶å®ä¸ç„¶ï¼Œlvalue æ˜¯loactor valueçš„ç¼©å†™ï¼Œå¯æ„ä¸ºå­˜å‚¨åœ¨å†…å­˜ä¸­ã€æœ‰æ˜ç¡®å­˜å‚¨åœ°å€ï¼ˆå¯å¯»å€ï¼‰çš„æ•°æ®ï¼Œè€Œ rvalue è¯‘ä¸º read valueï¼ŒæŒ‡çš„æ˜¯é‚£äº›å¯ä»¥æä¾›æ•°æ®å€¼çš„æ•°æ®ï¼ˆä¸ä¸€å®šå¯ä»¥å¯»å€ï¼Œä¾‹å¦‚å­˜å‚¨äºå¯„å­˜å™¨ä¸­çš„æ•°æ®ï¼‰ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ¤æ–­æŸä¸ªè¡¨è¾¾å¼æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œæœ€å¸¸ç”¨çš„æœ‰ä»¥ä¸‹ 2 ç§æ–¹æ³•: å¯ä½äºèµ‹å€¼å·(=)å·¦ä¾§çš„è¡¨è¾¾å¼å°±æ˜¯å·¦å€¼ï¼›åä¹‹ï¼Œåªèƒ½ä½äºèµ‹å€¼å·å³ä¾§çš„è¡¨è¾¾å¼å°±æ˜¯å³å€¼ã€‚ int a = 5; // é”™è¯¯ï¼Œ5 ä¸èƒ½ä¸ºå·¦å€¼ 5 = a; // b æ˜¯ä¸€ä¸ªå·¦å€¼ int b = 10; // aã€b éƒ½æ˜¯å·¦å€¼ï¼Œåªä¸è¿‡å°† b å¯ä»¥å½“åšå³å€¼ä½¿ç”¨ a = b; æœ‰åç§°çš„ã€å¯ä»¥è·å–åˆ°å­˜å‚¨åœ°å€çš„è¡¨è¾¾å¼å³ä¸ºå·¦å€¼ï¼›åä¹‹åˆ™æ˜¯å³å€¼ã€‚ ä»¥ä¸Šé¢å®šä¹‰çš„å˜é‡ aã€b ä¸ºä¾‹ï¼Œa å’Œ b æ˜¯å˜é‡åï¼Œä¸”é€šè¿‡ \u0026a å’Œ \u0026b å¯ä»¥è·å¾—ä»–ä»¬çš„å­˜å‚¨åœ°å€ï¼Œå› æ­¤ a å’Œ b éƒ½æ˜¯å·¦å€¼ï¼›åä¹‹ï¼Œå­—é¢é‡ 5ã€10ï¼Œå®ƒä»¬æ—¢æ²¡æœ‰åç§°ï¼Œä¹Ÿæ— æ³•è·å–å…¶å­˜å‚¨åœ°å€ï¼ˆå­—é¢é‡é€šå¸¸å­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­ï¼Œæˆ–è€…å’Œä»£ç å­˜å‚¨åœ¨ä¸€èµ·ï¼‰ï¼Œå› æ­¤ 5ã€10 éƒ½æ˜¯å³å€¼ã€‚ å³å€¼å¼•ç”¨ å³å€¼å¼•ç”¨å¯ä»¥ä»å­—é¢æ„æ€ä¸Šç†è§£ï¼ŒæŒ‡çš„æ˜¯ä»¥å¼•ç”¨ä¼ é€’ï¼ˆè€Œéå€¼ä¼ é€’ï¼‰çš„æ–¹å¼ä½¿ç”¨ C++ å³å€¼ã€‚ C++98/03 æ ‡å‡†ä¸­æœ‰å¼•ç”¨ï¼Œä½¿ç”¨ \u0026 è¡¨ç¤ºã€‚ä½†æ­¤ç§å¼•ç”¨æ–¹å¼æœ‰ä¸€ä¸ªç¼ºé™·ï¼Œå³æ­£å¸¸æƒ…å†µä¸‹åªèƒ½æ“ä½œ C++ ä¸­çš„å·¦å€¼ï¼Œæ— æ³•å¯¹å³å€¼æ·»åŠ å¼•ç”¨ã€‚ int num = 10; // æ­£ç¡® int \u0026b = num; // é”™è¯¯ int \u0026c = 10; æ³¨æ„: è™½ç„¶ C++98/03 æ ‡å‡†ä¸æ”¯æŒä¸ºå³å€¼å»ºç«‹éå¸¸é‡å·¦å€¼å¼•ç”¨ï¼Œä½†å…è®¸ä½¿ç”¨å¸¸é‡å·¦å€¼å¼•ç”¨æ“ä½œå³å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¸¸é‡å·¦å€¼å¼•ç”¨æ—¢å¯ä»¥æ“ä½œå·¦å€¼ï¼Œä¹Ÿå¯ä»¥æ“ä½œå³å€¼ã€‚ int num = 10; const int \u0026b = num; const int \u0026c = 10; æ³¨æ„: C++11 æ ‡å‡†ä¸­å¯¹å³å€¼åšäº†æ›´ç»†è‡´çš„åˆ’åˆ†ï¼Œåˆ†åˆ«ç§°ä¸º çº¯å³å€¼ï¼ˆpure valueï¼Œç®€ç§° pvalueï¼‰å’Œ å°†äº¡å€¼ï¼ˆexpiring valueï¼Œç®€ç§° xvalue ï¼‰ã€‚å…¶ä¸­çº¯å³å€¼å°±æ˜¯ C++98/03 æ ‡å‡†ä¸­çš„å³å€¼ï¼Œè€Œå°†äº¡å€¼åˆ™æŒ‡çš„æ˜¯å’Œå³å€¼å¼•ç”¨ç›¸å…³çš„è¡¨è¾¾å¼ï¼ˆæ¯”å¦‚æŸå‡½æ•°è¿”å›çš„ T \u0026\u0026 ç±»å‹çš„è¡¨è¾¾å¼ï¼‰ã€‚å¯¹äºçº¯å³å€¼å’Œå°†äº¡å€¼ï¼Œéƒ½å±äºå³å€¼ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:15","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.16 ç§»åŠ¨æ„é€ å‡½æ•°çš„åŠŸèƒ½å’Œç”¨æ³• å³å€¼å¼•ç”¨ä¸»è¦ç”¨äºå®ç°ç§»åŠ¨ï¼ˆmoveï¼‰è¯­ä¹‰å’Œå®Œç¾è½¬å‘ã€‚ å®Œç¾è½¬å‘åŠå…¶å®ç° C++11 æ ‡å‡†ä¸º C++ å¼•å…¥å³å€¼å¼•ç”¨è¯­æ³•çš„åŒæ—¶ï¼Œè¿˜è§£å†³äº†ä¸€ä¸ª C++ 98/03 æ ‡å‡†é•¿æœŸå­˜åœ¨çš„çŸ­æ¿ï¼Œå³ä½¿ç”¨ç®€å•çš„æ–¹å¼å³å¯åœ¨å‡½æ•°æ¨¡æ¿ä¸­å®ç°å‚æ•°çš„å®Œç¾è½¬å‘ã€‚ å®Œç¾è½¬å‘ æŒ‡çš„æ˜¯å‡½æ•°æ¨¡æ¿å¯ä»¥å°†è‡ªå·±çš„å‚æ•°\"å®Œç¾\"åœ°è½¬å‘ç»™å†…éƒ¨è°ƒç”¨çš„å…¶å®ƒå‡½æ•°ã€‚æ‰€è°“å®Œç¾ï¼Œå³ä¸ä»…èƒ½å‡†ç¡®åœ°è½¬å‘å‚æ•°çš„å€¼ï¼Œè¿˜èƒ½ä¿è¯è¢«è½¬å‘å‚æ•°çš„å·¦ã€å³å€¼å±æ€§ä¸å˜ã€‚å¦‚ï¼š template\u003ctypename T\u003e void function(T t) { otherdef(t); } ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œfunction() å‡½æ•°æ¨¡æ¿ä¸­è°ƒç”¨äº† otherdef() å‡½æ•°ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå®Œç¾è½¬å‘æŒ‡çš„æ˜¯ï¼šå¦‚æœ function() å‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•° t ä¸ºå·¦å€¼ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°ä¼ é€’ç»™ otherdef() çš„å‚æ•° t ä¹Ÿæ˜¯å·¦å€¼ï¼›åä¹‹å¦‚æœ function() å‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•° t ä¸ºå³å€¼ï¼Œé‚£ä¹ˆä¼ é€’ç»™ otherdef() å‡½æ•°çš„å‚æ•° t ä¹Ÿå¿…é¡»ä¸ºå³å€¼ã€‚ function() å‡½æ•°æ¨¡æ¿å¹¶æ²¡æœ‰å®ç°å®Œç¾è½¬å‘ã€‚ å‚æ•° t ä¸ºéå¼•ç”¨ç±»å‹ï¼Œè¿™æ„å‘³ç€åœ¨è°ƒç”¨ function() å‡½æ•°æ—¶ï¼Œå®å‚å°†å€¼ä¼ é€’ç»™å½¢å‚çš„è¿‡ç¨‹å°±éœ€è¦é¢å¤–è¿›è¡Œä¸€æ¬¡æ‹·è´æ“ä½œï¼› æ— è®ºè°ƒç”¨ function() å‡½æ•°æ¨¡æ¿æ—¶ä¼ é€’ç»™å‚æ•° t çš„æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œå¯¹äºå‡½æ•°å†…éƒ¨çš„å‚æ•° t æ¥è¯´ï¼Œå®ƒæœ‰è‡ªå·±çš„åç§°ï¼Œä¹Ÿå¯ä»¥è·å–å®ƒçš„å­˜å‚¨åœ°å€ï¼Œå› æ­¤å®ƒæ°¸è¿œéƒ½æ˜¯å·¦å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¼ é€’ç»™ otherdef() å‡½æ•°çš„å‚æ•° t æ°¸è¿œéƒ½æ˜¯å·¦å€¼ã€‚æ€»ä¹‹ï¼Œæ— è®ºä»é‚£ä¸ªè§’åº¦çœ‹ï¼Œfunction() å‡½æ•°çš„å®šä¹‰éƒ½ä¸â€œå®Œç¾â€ã€‚ å¦‚æœä½¿ç”¨ C++ 98/03 æ ‡å‡†ä¸‹çš„ C++ è¯­è¨€ï¼Œå¯ä»¥é‡‡ç”¨å‡½æ•°æ¨¡æ¿é‡è½½çš„æ–¹å¼å®ç°å®Œç¾è½¬å‘ï¼Œä¾‹å¦‚ï¼š #include \u003ciostream\u003e using namespace std; // é‡è½½è¢«è°ƒç”¨å‡½æ•°ï¼ŒæŸ¥çœ‹å®Œç¾è½¬å‘çš„æ•ˆæœ void otherdef(int \u0026 t) { cout \u003c\u003c \"lvalue\\n\"; } void otherdef(const int \u0026 t) { cout \u003c\u003c \"rvalue\\n\"; } // é‡è½½å‡½æ•°æ¨¡æ¿ï¼Œåˆ†åˆ«æ¥æ”¶å·¦å€¼å’Œå³å€¼ // æ¥æ”¶å³å€¼å‚æ•° template \u003ctypename T\u003e void function(const T\u0026 t) { otherdef(t); } // æ¥æ”¶å·¦å€¼å‚æ•° template \u003ctypename T\u003e void function(T\u0026 t) { otherdef(t); } int main() { // 5 æ˜¯å³å€¼ function(5); int x = 1; // x æ˜¯å·¦å€¼ function(x); return 0; } å¯¹äºå³å€¼5 æ¥è¯´ï¼Œå®ƒå®é™…è°ƒç”¨çš„å‚æ•°ç±»å‹ä¸º const T\u0026 çš„å‡½æ•°æ¨¡æ¿ï¼Œç”±äº t ä¸º const ç±»å‹ï¼Œæ‰€ä»¥ otherdef() å‡½æ•°å®é™…è°ƒç”¨çš„ä¹Ÿæ˜¯å‚æ•°ç”¨ const ä¿®é¥°çš„å‡½æ•°ï¼Œæ‰€ä»¥è¾“å‡ºâ€œrvalueâ€ï¼›å¯¹äºå·¦å€¼ x æ¥è¯´ï¼Œ2 ä¸ªé‡è½½æ¨¡æ¿å‡½æ•°éƒ½é€‚ç”¨ï¼ŒC++ç¼–è¯‘å™¨ä¼šé€‰æ‹©æœ€é€‚åˆçš„å‚æ•°ç±»å‹ä¸º T\u0026 çš„å‡½æ•°æ¨¡æ¿ï¼Œè¿›è€Œ therdef() å‡½æ•°å®é™…è°ƒç”¨çš„æ˜¯å‚æ•°ç±»å‹ä¸ºé const çš„å‡½æ•°ï¼Œè¾“å‡ºâ€œlvalueâ€ã€‚ ä½¿ç”¨é‡è½½çš„æ¨¡æ¿å‡½æ•°å®ç°å®Œç¾è½¬å‘ä¹Ÿæ˜¯æœ‰å¼Šç«¯çš„ï¼Œæ­¤æ–¹å¼ä»…é€‚ç”¨äºæ¨¡æ¿å‡½æ•°ä»…æœ‰å°‘é‡å‚æ•°çš„æƒ…å†µï¼Œå¦åˆ™å°±éœ€è¦ç¼–å†™å¤§é‡çš„é‡è½½å‡½æ•°æ¨¡æ¿ï¼Œé€ æˆä»£ç çš„å†—ä½™ã€‚ä¸ºäº†æ›´å¿«é€Ÿåœ°å®ç°å®Œç¾è½¬å‘ï¼ŒC++ 11 æ ‡å‡†ä¸­å…è®¸åœ¨å‡½æ•°æ¨¡æ¿ä¸­ä½¿ç”¨å³å€¼å¼•ç”¨æ¥å®ç°å®Œç¾è½¬å‘ã€‚ C++11 æ ‡å‡†ä¸­è§„å®šï¼Œé€šå¸¸æƒ…å†µä¸‹å³å€¼å¼•ç”¨å½¢å¼çš„å‚æ•°åªèƒ½æ¥æ”¶å³å€¼ï¼Œä¸èƒ½æ¥æ”¶å·¦å€¼ã€‚ä½†å¯¹äºå‡½æ•°æ¨¡æ¿ä¸­ä½¿ç”¨å³å€¼å¼•ç”¨è¯­æ³•å®šä¹‰çš„å‚æ•°æ¥è¯´ï¼Œä¸å†éµå®ˆè¿™ä¸€è§„å®šï¼Œæ—¢å¯ä»¥æ¥æ”¶å³å€¼ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å·¦å€¼ï¼ˆæ­¤æ—¶çš„å³å€¼å¼•ç”¨åˆè¢«ç§°ä¸ºâ€œä¸‡èƒ½å¼•ç”¨â€ï¼‰ã€‚ åœ¨ C++11 æ ‡å‡†ä¸­å®ç°å®Œç¾è½¬å‘ï¼Œåªéœ€è¦ç¼–å†™å¦‚ä¸‹ä¸€ä¸ªæ¨¡æ¿å‡½æ•°å³å¯ï¼š template \u003ctypename T\u003e void function(T\u0026\u0026 t) { otherdef(t); } æ­¤æ¨¡æ¿å‡½æ•°çš„å‚æ•° t æ—¢å¯ä»¥æ¥æ”¶å·¦å€¼ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å³å€¼ã€‚ä½†ä»…ä»…ä½¿ç”¨å³å€¼å¼•ç”¨ä½œä¸ºå‡½æ•°æ¨¡æ¿çš„å‚æ•°æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ç»§ç»­è§£å†³ï¼Œå¦‚æœè°ƒç”¨ function() å‡½æ•°æ—¶ä¸ºå…¶ä¼ é€’ä¸€ä¸ªå·¦å€¼å¼•ç”¨æˆ–è€…å³å€¼å¼•ç”¨çš„å®å‚ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š int n = 10; int \u0026 num = n; // T ä¸º int\u0026 function(num); int \u0026\u0026 num2 = 11; // T ä¸º int \u0026\u0026 function(num2); ç”± function(num) å®ä¾‹åŒ–çš„å‡½æ•°åº•å±‚å°±å˜æˆäº† function(int \u0026\u0026 t)ï¼ŒåŒæ ·ç”± function(num2) å®ä¾‹åŒ–çš„å‡½æ•°åº•å±‚åˆ™å˜æˆäº† function(int \u0026\u0026 \u0026\u0026 t)ã€‚C++98/03 æ ‡å‡†æ˜¯ä¸æ”¯æŒè¿™ç§ç”¨æ³•çš„ï¼Œè€Œ C++ 11æ ‡å‡†ä¸ºäº†æ›´å¥½åœ°å®ç°å®Œç¾è½¬å‘ï¼Œç‰¹æ„ä¸ºå…¶æŒ‡å®šäº†æ–°çš„ç±»å‹åŒ¹é…è§„åˆ™ï¼Œåˆç§°ä¸ºå¼•ç”¨æŠ˜å è§„åˆ™ï¼ˆå‡è®¾ç”¨ A è¡¨ç¤ºå®é™…ä¼ é€’å‚æ•°çš„ç±»å‹ï¼‰ï¼š å½“å®å‚ä¸ºå·¦å€¼æˆ–è€…å·¦å€¼å¼•ç”¨ï¼ˆA\u0026ï¼‰æ—¶ï¼Œå‡½æ•°æ¨¡æ¿ä¸­ T\u0026\u0026 å°†è½¬å˜ä¸º A\u0026ï¼ˆA\u0026 \u0026\u0026 = A\u0026ï¼‰ï¼› å½“å®å‚ä¸ºå³å€¼æˆ–è€…å³å€¼å¼•ç”¨ï¼ˆA\u0026\u0026ï¼‰æ—¶ï¼Œå‡½æ•°æ¨¡æ¿ä¸­ T\u0026\u0026 å°†è½¬å˜ä¸º A\u0026\u0026ï¼ˆA\u0026\u0026 \u0026\u0026 = A\u0026\u0026ï¼‰ã€‚ æ³¨æ„ï¼šåœ¨å®ç°å®Œç¾è½¬å‘æ—¶ï¼Œåªè¦å‡½æ•°æ¨¡æ¿çš„å‚æ•°ç±»å‹ä¸º T\u0026\u0026ï¼Œåˆ™ C++ å¯ä»¥è‡ªè¡Œå‡†ç¡®åœ°åˆ¤å®šå‡ºå®é™…ä¼ å…¥çš„å®å‚æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ã€‚ é€šè¿‡å°†å‡½æ•°æ¨¡æ¿çš„å½¢å‚ç±»å‹è®¾ç½®ä¸º T\u0026\u0026ï¼Œå¯ä»¥å¾ˆå¥½åœ°è§£å†³æ¥æ”¶å·¦ã€å³å€¼çš„é—®é¢˜ã€‚ä½†é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œå³æ— è®ºä¼ å…¥çš„å½¢å‚æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œå¯¹äºå‡½æ•°æ¨¡æ¿å†…éƒ¨æ¥è¯´ï¼Œå½¢å‚æ—¢æœ‰åç§°åˆèƒ½å¯»å€ï¼Œå› æ­¤å®ƒéƒ½æ˜¯å·¦å€¼ã€‚ å°†å‡½æ•°æ¨¡æ¿æ¥æ”¶åˆ°çš„å½¢å‚è¿åŒå…¶å·¦ã€å³å€¼å±æ€§ï¼Œä¸€èµ·ä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°æ–¹æ³•ï¼šå¼•å…¥ä¸€ä¸ªæ¨¡æ¿å‡½æ•° forword(): #include \u003ciostream\u003e using namespace std; // é‡è½½è¢«è°ƒç”¨å‡½æ•°ï¼ŒæŸ¥çœ‹å®Œç¾è½¬å‘çš„æ•ˆæœ void otherdef(int \u0026 t) { cout \u003c\u003c \"lvalue\\n\"; } void otherdef(const int \u0026 t) { cout \u003c\u003c \"rvalue\\n\"; } // å®ç°å®Œç¾è½¬å‘çš„å‡½æ•°æ¨¡æ¿ template \u003ctypename T\u003e void function(T\u0026\u0026 t) { otherdef(forward\u003cT\u003e(t)); } int main() { function(5); int x = 1; function(x); return 0; } ç§»åŠ¨è¯­ä¹‰ æŒ‡çš„å°±æ˜¯ä»¥ç§»åŠ¨è€Œéæ·±æ‹·è´çš„æ–¹å¼åˆå§‹åŒ–å«æœ‰æŒ‡é’ˆæˆå‘˜çš„ç±»å¯¹è±¡ã€‚ç®€å•çš„ç†è§£ï¼Œç§»åŠ¨è¯­ä¹‰æŒ‡çš„å°±æ˜¯å°†å…¶ä»–å¯¹è±¡ï¼ˆé€šå¸¸æ˜¯ä¸´æ—¶å¯¹è±¡ï¼‰æ‹¥æœ‰çš„å†…å­˜èµ„æºâ€œç§»ä¸ºå·²ç”¨â€ã€‚ #include \u003ciostream\u003e using namespace std; class demo{ public: demo():num(new int(0)){ cout\u003c\u003c\"construct!\"\u003c\u003cendl; } demo(const demo \u0026d):num(new int(*d.num)){ cout\u003c\u003c\"copy construct!\"\u003c\u003cendl; } // ç§»åŠ¨æ„é€ å‡½æ•° demo(demo \u0026\u0026d):num(d.num){ d.num = NULL; cout\u003c\u003c\"move construct!\"\u003c\u003cendl; } ~demo(){ cout\u003c\u003c\"class destruct!\"\u003c\u003cendl; } private: int *num; }; demo get_demo(){ return demo(); } int main(){ demo a = get_demo(); return 0; } demoç±»çš„å…¶ä¸­ä¸€ä¸ªæ„é€ å‡½æ•°(demo(demo \u0026\u0026d))ä½¿ç”¨å³å€¼å¼•ç”¨å½¢å¼çš„å‚æ•°ï¼Œåˆç§°ä¸ºç§»åŠ¨æ„é€ å‡½æ•°ã€‚å¹¶ä¸”åœ¨æ­¤æ„é€ å‡½æ•°ä¸­ï¼Œnum æŒ‡é’ˆå˜é‡é‡‡ç”¨çš„æ˜¯æµ…æ‹·è´çš„å¤åˆ¶æ–¹å¼ï¼ŒåŒæ—¶åœ¨å‡½æ•°å†…éƒ¨é‡ç½®äº† d.numï¼Œæœ‰æ•ˆé¿å…äº†â€œåŒä¸€å—å¯¹ç©ºé—´è¢«é‡Šæ”¾å¤šæ¬¡â€æƒ…å†µçš„å‘ç”Ÿã€‚ é const å³å€¼å¼•ç”¨åªèƒ½æ“ä½œå³å€¼ï¼Œç¨‹åºæ‰§è¡Œç»“æœä¸­äº§ç”Ÿçš„ä¸´æ—¶å¯¹è±¡ï¼ˆä¾‹å¦‚å‡½æ•°è¿”å›å€¼ã€lambda è¡¨è¾¾å¼ç­‰ï¼‰æ—¢æ— åç§°ä¹Ÿæ— æ³•è·å–å…¶å­˜å‚¨åœ°å€ï¼Œæ‰€ä»¥å±äºå³å€¼ã€‚å½“ç±»ä¸­åŒæ—¶åŒ…å«æ‹·è´æ„é€ å‡½æ•°å’Œç§»åŠ¨æ„é€ å‡½æ•°æ—¶ï¼Œå¦‚æœä½¿ç”¨ä¸´æ—¶å¯¹è±¡åˆå§‹åŒ–å½“å‰ç±»çš„å¯¹è±¡ï¼Œç¼–è¯‘å™¨ä¼šä¼˜å…ˆè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°æ¥å®Œæˆæ­¤æ“ä½œã€‚åªæœ‰å½“ç±»ä¸­æ²¡æœ‰åˆé€‚çš„ç§»åŠ¨æ„é€ å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨æ‰ä¼šé€€è€Œæ±‚å…¶æ¬¡ï¼Œè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚ æ³¨æ„:åœ¨å®é™…å¼€å‘ä¸­ï¼Œé€šå¸¸åœ¨ç±»ä¸­è‡ªå®šä¹‰ç§»åŠ¨æ„é€ å‡½æ•°çš„åŒæ—¶ï¼Œä¼šå†ä¸ºå…¶è‡ªå®šä¹‰ä¸€ä¸ªé€‚å½“çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œç”±æ­¤å½“ç”¨æˆ·åˆ©ç”¨å³å€¼åˆå§‹åŒ–ç±»å¯¹è±¡æ—¶ï¼Œä¼šè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼›ä½¿ç”¨å·¦å€¼ï¼ˆéå³å€¼ï¼‰åˆå§‹åŒ–ç±»å¯¹è±¡æ—¶ï¼Œä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå·¦å€¼åˆå§‹åŒ–åŒç±»å¯¹è±¡åªèƒ½é€šè¿‡æ‹·è´æ„é€ å‡½æ•°å®Œæˆï¼Œå¦‚æœæƒ³è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œåˆ™å¿…é¡»ä½¿ç”¨å³å€¼è¿›è¡Œåˆå§‹åŒ–ã€‚C++11 æ ‡å‡†ä¸­ä¸ºäº†æ»¡è¶³ç”¨æˆ·ä½¿ç”¨å·¦å€¼åˆå§‹åŒ–åŒç±»å¯¹è±¡æ—¶ä¹Ÿé€šè¿‡ç§»åŠ¨æ„é€ å‡½æ•°å®Œæˆçš„éœ€æ±‚ï¼Œæ–°å¼•å…¥äº† std::move() å‡½æ•°ï¼Œå®ƒå¯ä»¥å°†å·¦å€¼å¼ºåˆ¶è½¬æ¢æˆå¯¹åº”çš„å³å€¼ï¼Œç”±æ­¤ä¾¿å¯ä»¥ä½¿ç”¨ç§»åŠ¨æ„é€ å‡½æ•°ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:16","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.17 move()å‡½æ•°:å°†å·¦å€¼è½¬æ¢ä¸ºå³å€¼ C++11 æ ‡å‡†ä¸­å€ŸåŠ©å³å€¼å¼•ç”¨å¯ä»¥ä¸ºæŒ‡å®šç±»æ·»åŠ ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œè¿™æ ·å½“ä½¿ç”¨è¯¥ç±»çš„å³å€¼å¯¹è±¡ï¼ˆå¯ä»¥ç†è§£ä¸ºä¸´æ—¶å¯¹è±¡ï¼‰åˆå§‹åŒ–åŒç±»å¯¹è±¡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šä¼˜å…ˆé€‰æ‹©ç§»åŠ¨æ„é€ å‡½æ•°ã€‚ ç§»åŠ¨æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœºæ˜¯ï¼šç”¨åŒç±»çš„å³å€¼å¯¹è±¡åˆå§‹åŒ–æ–°å¯¹è±¡ã€‚ç”¨å½“å‰ç±»çš„å·¦å€¼å¯¹è±¡ï¼ˆæœ‰åç§°ï¼Œèƒ½è·å–å…¶å­˜å‚¨åœ°å€çš„å®ä¾‹å¯¹è±¡ï¼‰åˆå§‹åŒ–åŒç±»å¯¹è±¡æ—¶ï¼Œè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°æ–¹æ³•ï¼šè°ƒç”¨ move() å‡½æ•°ã€‚ move çš„åŠŸèƒ½å¾ˆç®€å•ï¼Œå°±æ˜¯å°†æŸä¸ªå·¦å€¼å¼ºåˆ¶è½¬åŒ–ä¸ºå³å€¼ã€‚ å¼•ç”¨é™å®šç¬¦çš„ç”¨æ³• é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰å·¦å€¼çš„ç±»å¯¹è±¡ç§°ä¸ºå·¦å€¼å¯¹è±¡ï¼Œå³å€¼çš„ç±»å¯¹è±¡ç§°ä¸ºå³å€¼å¯¹è±¡ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹äºç±»ä¸­ç”¨ public ä¿®é¥°çš„æˆå‘˜å‡½æ•°ï¼Œæ—¢å¯ä»¥è¢«å·¦å€¼å¯¹è±¡è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è¢«å³å€¼å¯¹è±¡è°ƒç”¨: #include \u003ciostream\u003e using namespace std; class demo { public: demo(int num):num(num){} int get_num(){ return this-\u003enum; } private: int num; }; int main() { demo a(10); cout \u003c\u003c a.get_num() \u003c\u003c endl; cout \u003c\u003c move(a).get_num() \u003c\u003c endl; return 0; } å¯ä»¥çœ‹åˆ°ï¼Œdemo ç±»ä¸­çš„ get_num() æˆå‘˜å‡½æ•°æ—¢å¯ä»¥è¢« a å·¦å€¼å¯¹è±¡è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è¢« move(a) ç”Ÿæˆçš„å³å€¼ demo å¯¹è±¡è°ƒç”¨ï¼Œè¿è¡Œç¨‹åºä¼šè¾“å‡ºä¸¤ä¸ª 10ã€‚ æŸäº›åœºæ™¯ä¸­ï¼Œå¯èƒ½éœ€è¦é™åˆ¶è°ƒç”¨æˆå‘˜å‡½æ•°çš„å¯¹è±¡çš„ç±»å‹ï¼ˆå·¦å€¼è¿˜æ˜¯å³å€¼ï¼‰ï¼Œä¸ºæ­¤ C++11 æ–°æ·»åŠ äº†å¼•ç”¨é™å®šç¬¦ã€‚æ‰€è°“å¼•ç”¨é™å®šç¬¦ï¼Œå°±æ˜¯åœ¨æˆå‘˜å‡½æ•°çš„åé¢æ·»åŠ  \u0026 æˆ–è€… \u0026\u0026ï¼Œä»è€Œé™åˆ¶è°ƒç”¨è€…çš„ç±»å‹ï¼ˆå·¦å€¼è¿˜æ˜¯å³å€¼ï¼‰ã€‚ #include \u003ciostream\u003e using namespace std; class demo { public: demo(int num):num(num){} int get_num()\u0026{ return this-\u003enum; } private: int num; }; int main() { demo a(10); // æ­£ç¡® cout \u003c\u003c a.get_num() \u003c\u003c endl; // é”™è¯¯ cout \u003c\u003c move(a).get_num() \u003c\u003c endl; return 0; } #include \u003ciostream\u003e using namespace std; class demo { public: demo(int num):num(num){} int get_num()\u0026\u0026{ return this-\u003enum; } private: int num; }; int main() { demo a(10); // é”™è¯¯ cout \u003c\u003c a.get_num() \u003c\u003c endl; // æ­£ç¡® cout \u003c\u003c move(a).get_num() \u003c\u003c endl; return 0; } æ³¨æ„:å¼•ç”¨é™å®šç¬¦ä¸é€‚ç”¨äºé™æ€æˆå‘˜å‡½æ•°å’Œå‹å…ƒå‡½æ•°ã€‚ constå’Œå¼•ç”¨é™å®š const ä¹Ÿå¯ä»¥ç”¨äºä¿®é¥°ç±»çš„æˆå‘˜å‡½æ•°ï¼Œä¹ æƒ¯ç§°ä¸ºå¸¸æˆå‘˜å‡½æ•°ã€‚ class demo{ public: int get_num() const; } const å’Œå¼•ç”¨é™å®šç¬¦ä¿®é¥°ç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œéƒ½ä½äºå‡½æ•°çš„æœ«å°¾ã€‚ æ³¨æ„: C++11 æ ‡å‡†è§„å®šï¼Œå½“å¼•ç”¨é™å®šç¬¦å’Œ const ä¿®é¥°åŒä¸€ä¸ªç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œconst å¿…é¡»ä½äºå¼•ç”¨é™å®šç¬¦å‰é¢ã€‚ å½“ const \u0026\u0026 ä¿®é¥°ç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œè°ƒç”¨å®ƒçš„å¯¹è±¡åªèƒ½æ˜¯å³å€¼å¯¹è±¡ï¼›å½“ const \u0026 ä¿®é¥°ç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œè°ƒç”¨å®ƒçš„å¯¹è±¡æ—¢å¯ä»¥æ˜¯å·¦å€¼å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯å³å€¼å¯¹è±¡ã€‚æ— è®ºæ˜¯ const \u0026\u0026 è¿˜æ˜¯ const \u0026 é™å®šçš„æˆå‘˜å‡½æ•°ï¼Œå†…éƒ¨éƒ½ä¸å…è®¸å¯¹å½“å‰å¯¹è±¡åšä¿®æ”¹æ“ä½œã€‚ #include \u003ciostream\u003e using namespace std; class demo { public: demo(int num,int num2) :num(num),num2(num2) {} //å·¦å€¼å’Œå³å€¼å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨ int get_num() const \u0026{ return this-\u003enum; } //ä»…ä¾›å³å€¼å¯¹è±¡è°ƒç”¨ int get_num2() const \u0026\u0026 { return this-\u003enum2; } private: int num; int num2; }; int main() { demo a(10,20); // æ­£ç¡® cout \u003c\u003c a.get_num() \u003c\u003c endl; // æ­£ç¡® cout \u003c\u003c move(a).get_num() \u003c\u003c endl; // é”™è¯¯ cout \u003c\u003c a.get_num2() \u003c\u003c endl; // æ­£ç¡® cout \u003c\u003c move(a).get_num2() \u003c\u003c endl; return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:17","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.17 nullptrï¼šåˆå§‹åŒ–ç©ºæŒ‡é’ˆ å®é™…å¼€å‘ä¸­ï¼Œé¿å…äº§ç”Ÿé‡æŒ‡é’ˆæœ€æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨å®šä¹‰æŒ‡é’ˆçš„åŒæ—¶å®Œæˆåˆå§‹åŒ–æ“ä½œï¼Œå³ä¾¿è¯¥æŒ‡é’ˆçš„æŒ‡å‘å°šæœªæ˜ç¡®ï¼Œä¹Ÿè¦å°†å…¶åˆå§‹åŒ–ä¸ºç©ºæŒ‡é’ˆã€‚ é‡æŒ‡é’ˆï¼Œåˆç§°æ‚¬æŒ‚æŒ‡é’ˆï¼ŒæŒ‡çš„æ˜¯æ²¡æœ‰æ˜ç¡®æŒ‡å‘çš„æŒ‡é’ˆã€‚é‡æŒ‡é’ˆå¾€å¾€æŒ‡å‘çš„æ˜¯é‚£äº›ä¸å¯ç”¨çš„å†…å­˜åŒºåŸŸï¼Œè¿™å°±æ„å‘³ç€åƒæ“ä½œæ™®é€šæŒ‡é’ˆé‚£æ ·ä½¿ç”¨é‡æŒ‡é’ˆï¼ˆä¾‹å¦‚ \u0026pï¼‰ï¼Œæå¯èƒ½å¯¼è‡´ç¨‹åºå‘ç”Ÿå¼‚å¸¸ã€‚ C++98/03 æ ‡å‡†ä¸­ï¼Œå°†ä¸€ä¸ªæŒ‡é’ˆåˆå§‹åŒ–ä¸ºç©ºæŒ‡é’ˆçš„æ–¹å¼ï¼š int *p = 0; // æ¨èä½¿ç”¨ int *p = NULL; å¯ä»¥çœ‹åˆ°ï¼Œå¯ä»¥å°†æŒ‡é’ˆæ˜ç¡®æŒ‡å‘ 0ï¼ˆ0x0000 0000ï¼‰è¿™ä¸ªå†…å­˜ç©ºé—´ã€‚ä¸€æ–¹é¢ï¼Œæ˜ç¡®æŒ‡é’ˆçš„æŒ‡å‘å¯ä»¥é¿å…å…¶æˆä¸ºé‡æŒ‡é’ˆï¼›å¦ä¸€æ–¹é¢ï¼Œå¤§å¤šæ•°æ“ä½œç³»ç»Ÿéƒ½ä¸å…è®¸ç”¨æˆ·å¯¹åœ°å€ä¸º 0 çš„å†…å­˜ç©ºé—´æ‰§è¡Œå†™æ“ä½œï¼Œè‹¥ç”¨æˆ·åœ¨ç¨‹åºä¸­å°è¯•ä¿®æ”¹å…¶å†…å®¹ï¼Œåˆ™ç¨‹åºè¿è¡Œä¼šç›´æ¥æŠ¥é”™ã€‚ ç›¸æ¯”ç¬¬ä¸€ç§æ–¹å¼ï¼Œæ¨èå°†æŒ‡é’ˆåˆå§‹åŒ–ä¸º NULLã€‚NULL å¹¶ä¸æ˜¯ C++ çš„å…³é”®å­—ï¼Œå®ƒæ˜¯ C++ äº‹å…ˆå®šä¹‰å¥½çš„ä¸€ä¸ªå®ï¼Œå¹¶ä¸”å®ƒçš„å€¼å¾€å¾€å°±æ˜¯å­—é¢é‡ 0ï¼ˆ#define NULL 0ï¼‰ã€‚ C++ ä¸­å°† NULL å®šä¹‰ä¸ºå­—é¢å¸¸é‡ 0ï¼Œè™½ç„¶èƒ½æ»¡è¶³å¤§éƒ¨åˆ†åœºæ™¯çš„éœ€è¦ï¼Œä½†ä¸ªåˆ«æƒ…å†µä¸‹ï¼Œå®ƒä¼šå¯¼è‡´ç¨‹åºçš„è¿è¡Œå’Œé¢„æœŸä¸ç¬¦ã€‚ #include \u003ciostream\u003e using namespace std; void isnull(void *c){ cout \u003c\u003c \"void*c\" \u003c\u003c endl; } void isnull(int n){ cout \u003c\u003c \"int n\" \u003c\u003c endl; } int main() { isnull(0); isnull(NULL); return 0; } ä»¥ä¸Šä»£ç éƒ½å°†è¾“å‡ºint nã€‚å¯¹äº isnull(0) æ¥è¯´ï¼Œæ˜¾ç„¶å®ƒçœŸæ­£è°ƒç”¨çš„æ˜¯å‚æ•°ä¸ºæ•´å½¢çš„ isnull() å‡½æ•°ï¼›è€Œå¯¹äº isnull(NULL)ï¼Œæˆ‘ä»¬æœŸæœ›å®ƒå®é™…è°ƒç”¨çš„æ˜¯å‚æ•°ä¸º void*c çš„ isnull() å‡½æ•°ï¼Œä½†ç¨‹åºçš„æ‰§è¡Œç»“æœå¹¶ä¸ç¬¦åˆé¢„æœŸã€‚ C++ 98/03 æ ‡å‡†ä¸­ï¼Œå¦‚æœæƒ³ä»¤ isnull(NULL) å®é™…è°ƒç”¨çš„æ˜¯ isnull(void* c)ï¼Œå°±éœ€è¦å¯¹ NULLï¼ˆæˆ–è€… 0ï¼‰è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼š isnull( (void*)NULL ); isnull( (void*)0 ); ç”±äº C++ 98 æ ‡å‡†ä½¿ç”¨æœŸé—´ï¼ŒNULL å·²ç»å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œå‡ºäºå…¼å®¹æ€§çš„è€ƒè™‘ï¼ŒC++11 æ ‡å‡†å¹¶æ²¡æœ‰å¯¹ NULL çš„å®å®šä¹‰åšä»»ä½•ä¿®æ”¹ã€‚ä¸ºäº†ä¿®æ­£ C++ å­˜åœ¨çš„è¿™ä¸€ BUGï¼Œåœ¨ C++11 æ ‡å‡†ä¸­å¼•å…¥ä¸€ä¸ªæ–°å…³é”®å­—ï¼Œå³ nullptrã€‚ nullptr æ˜¯ nullptr_t ç±»å‹çš„å³å€¼å¸¸é‡ï¼Œä¸“ç”¨äºåˆå§‹åŒ–ç©ºç±»å‹æŒ‡é’ˆã€‚nullptr_t æ˜¯ C++11 æ–°å¢åŠ çš„æ•°æ®ç±»å‹ï¼Œå¯ç§°ä¸ºæŒ‡é’ˆç©ºå€¼ç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œnullpter ä»…æ˜¯è¯¥ç±»å‹çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆå·²ç»å®šä¹‰å¥½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼‰ï¼Œå¦‚æœéœ€è¦å®Œå…¨å®šä¹‰å‡ºå¤šä¸ªåŒ nullptr å®Œå…¨ä¸€æ ·çš„å®ä¾‹å¯¹è±¡ã€‚nullptr å¯ä»¥è¢«éšå¼è½¬æ¢æˆä»»æ„çš„æŒ‡é’ˆç±»å‹ã€‚ é€šè¿‡å°†æŒ‡é’ˆåˆå§‹åŒ–ä¸º nullptrï¼Œå¯ä»¥å¾ˆå¥½åœ°è§£å†³ NULL é—ç•™çš„é—®é¢˜: #include \u003ciostream\u003e using namespace std; void isnull(void *c){ cout \u003c\u003c \"void*c\" \u003c\u003c endl; } void isnull(int n){ cout \u003c\u003c \"int n\" \u003c\u003c endl; } int main() { isnull(NULL); isnull(nullptr); return 0; } ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:18","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"2.18 æ™ºèƒ½æŒ‡é’ˆ æ™ºèƒ½æŒ‡é’ˆï¼Œå¯ä»¥ä»å­—é¢ä¸Šç†è§£ä¸ºâ€œæ™ºèƒ½â€çš„æŒ‡é’ˆã€‚å…·ä½“æ¥è®²ï¼Œæ™ºèƒ½æŒ‡é’ˆå’Œæ™®é€šæŒ‡é’ˆçš„ç”¨æ³•æ˜¯ç›¸ä¼¼çš„ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼Œæ™ºèƒ½æŒ‡é’ˆå¯ä»¥åœ¨é€‚å½“æ—¶æœºè‡ªåŠ¨é‡Šæ”¾åˆ†é…çš„å†…å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå¯ä»¥å¾ˆå¥½åœ°é¿å…â€œå¿˜è®°é‡Šæ”¾å†…å­˜è€Œå¯¼è‡´å†…å­˜æ³„æ¼â€é—®é¢˜å‡ºç°ã€‚ C++ æ™ºèƒ½æŒ‡é’ˆåº•å±‚æ˜¯é‡‡ç”¨å¼•ç”¨è®¡æ•°çš„æ–¹å¼å®ç°çš„ã€‚ç®€å•çš„ç†è§£ï¼Œæ™ºèƒ½æŒ‡é’ˆåœ¨ç”³è¯·å †å†…å­˜ç©ºé—´çš„åŒæ—¶ï¼Œä¼šä¸ºå…¶é…å¤‡ä¸€ä¸ªæ•´å½¢å€¼ï¼ˆåˆå§‹å€¼ä¸º 1ï¼‰ï¼Œæ¯å½“æœ‰æ–°å¯¹è±¡ä½¿ç”¨æ­¤å †å†…å­˜æ—¶ï¼Œè¯¥æ•´å½¢å€¼ +1ï¼›åä¹‹ï¼Œæ¯å½“ä½¿ç”¨æ­¤å †å†…å­˜çš„å¯¹è±¡è¢«é‡Šæ”¾æ—¶ï¼Œè¯¥æ•´å½¢å€¼å‡ 1ã€‚å½“å †ç©ºé—´å¯¹åº”çš„æ•´å½¢å€¼ä¸º 0 æ—¶ï¼Œå³è¡¨æ˜ä¸å†æœ‰å¯¹è±¡ä½¿ç”¨å®ƒï¼Œè¯¥å †ç©ºé—´å°±ä¼šè¢«é‡Šæ”¾æ‰ã€‚ å…³äºæ™ºèƒ½æŒ‡é’ˆçš„å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼Œè¯·å‚è€ƒã€ŠC++æ ‡å‡†åº“ã€‹ shared_ptr å®é™…ä¸Šï¼Œæ¯ç§æ™ºèƒ½æŒ‡é’ˆéƒ½æ˜¯ä»¥ç±»æ¨¡æ¿çš„æ–¹å¼å®ç°çš„ï¼Œshared_ptr ä¹Ÿä¸ä¾‹å¤–ã€‚shared_ptrï¼ˆå…¶ä¸­ T è¡¨ç¤ºæŒ‡é’ˆæŒ‡å‘çš„å…·ä½“æ•°æ®ç±»å‹ï¼‰çš„å®šä¹‰ä½äºå¤´æ–‡ä»¶ï¼Œå¹¶ä½äº std å‘½åç©ºé—´ä¸­ã€‚ å’Œ unique_ptrã€weak_ptr ä¸åŒä¹‹å¤„åœ¨äºï¼Œå¤šä¸ª shared_ptr æ™ºèƒ½æŒ‡é’ˆå¯ä»¥å…±åŒä½¿ç”¨åŒä¸€å—å †å†…å­˜ã€‚å¹¶ä¸”ï¼Œç”±äºè¯¥ç±»å‹æ™ºèƒ½æŒ‡é’ˆåœ¨å®ç°ä¸Šé‡‡ç”¨çš„æ˜¯å¼•ç”¨è®¡æ•°æœºåˆ¶ï¼Œå³ä¾¿æœ‰ä¸€ä¸ª shared_ptr æŒ‡é’ˆæ”¾å¼ƒäº†å †å†…å­˜çš„ä½¿ç”¨æƒï¼ˆå¼•ç”¨è®¡æ•°å‡ 1ï¼‰ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–æŒ‡å‘åŒä¸€å †å†…å­˜çš„ shared_ptr æŒ‡é’ˆï¼ˆåªæœ‰å¼•ç”¨è®¡æ•°ä¸º 0 æ—¶ï¼Œå †å†…å­˜æ‰ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ï¼‰ã€‚ unique_ptr unique_ptr æŒ‡é’ˆè‡ªç„¶ä¹Ÿå…·å¤‡â€œåœ¨é€‚å½“æ—¶æœºè‡ªåŠ¨é‡Šæ”¾å †å†…å­˜ç©ºé—´â€çš„èƒ½åŠ›ã€‚å’Œ shared_ptr æŒ‡é’ˆæœ€å¤§çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œunique_ptr æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜æ— æ³•åŒå…¶å®ƒ unique_ptr å…±äº«ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ª unique_ptr æŒ‡é’ˆéƒ½ç‹¬è‡ªæ‹¥æœ‰å¯¹å…¶æ‰€æŒ‡å †å†…å­˜ç©ºé—´çš„æ‰€æœ‰æƒã€‚ æ³¨æ„ï¼šæ¯ä¸ª unique_ptr æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜ç©ºé—´çš„å¼•ç”¨è®¡æ•°ï¼Œéƒ½åªèƒ½ä¸º 1ï¼Œä¸€æ—¦è¯¥ unique_ptr æŒ‡é’ˆæ”¾å¼ƒå¯¹æ‰€æŒ‡å †å†…å­˜ç©ºé—´çš„æ‰€æœ‰æƒï¼Œåˆ™è¯¥ç©ºé—´ä¼šè¢«ç«‹å³é‡Šæ”¾å›æ”¶ã€‚ unique_ptr æ™ºèƒ½æŒ‡é’ˆæ˜¯ä»¥æ¨¡æ¿ç±»çš„å½¢å¼æä¾›çš„ï¼Œunique_ptrï¼ˆT ä¸ºæŒ‡é’ˆæ‰€æŒ‡æ•°æ®çš„ç±»å‹ï¼‰å®šä¹‰åœ¨å¤´æ–‡ä»¶ï¼Œå¹¶ä½äº std å‘½åç©ºé—´ä¸­ã€‚ weak_ptr å’Œ shared_ptrã€unique_ptr ç±»å‹æŒ‡é’ˆä¸€æ ·ï¼Œweak_ptr æ™ºèƒ½æŒ‡é’ˆä¹Ÿæ˜¯ä»¥æ¨¡æ¿ç±»çš„æ–¹å¼å®ç°çš„ã€‚weak_ptrï¼ˆ T ä¸ºæŒ‡é’ˆæ‰€æŒ‡æ•°æ®çš„ç±»å‹ï¼‰å®šä¹‰åœ¨å¤´æ–‡ä»¶ï¼Œå¹¶ä½äº std å‘½åç©ºé—´ä¸­ã€‚ C++11æ ‡å‡†è™½ç„¶å°† weak_ptr å®šä½ä¸ºæ™ºèƒ½æŒ‡é’ˆçš„ä¸€ç§ï¼Œä½†è¯¥ç±»å‹æŒ‡é’ˆé€šå¸¸ä¸å•ç‹¬ä½¿ç”¨ï¼ˆæ²¡æœ‰å®é™…ç”¨å¤„ï¼‰ï¼Œåªèƒ½å’Œ shared_ptr ç±»å‹æŒ‡é’ˆæ­é…ä½¿ç”¨ã€‚ç”šè‡³äºï¼Œæˆ‘ä»¬å¯ä»¥å°† weak_ptr ç±»å‹æŒ‡é’ˆè§†ä¸º shared_ptr æŒ‡é’ˆçš„ä¸€ç§è¾…åŠ©å·¥å…·ï¼Œå€ŸåŠ© weak_ptr ç±»å‹æŒ‡é’ˆï¼Œ æˆ‘ä»¬å¯ä»¥è·å– shared_ptr æŒ‡é’ˆçš„ä¸€äº›çŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚æœ‰å¤šå°‘æŒ‡å‘ç›¸åŒçš„ shared_ptr æŒ‡é’ˆã€shared_ptr æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜æ˜¯å¦å·²ç»è¢«é‡Šæ”¾ç­‰ç­‰ã€‚ å½“ weak_ptr ç±»å‹æŒ‡é’ˆçš„æŒ‡å‘å’ŒæŸä¸€ shared_ptr æŒ‡é’ˆç›¸åŒæ—¶ï¼Œweak_ptr æŒ‡é’ˆå¹¶ä¸ä¼šä½¿æ‰€æŒ‡å †å†…å­˜çš„å¼•ç”¨è®¡æ•°åŠ  1ï¼›åŒæ ·ï¼Œå½“ weak_ptr æŒ‡é’ˆè¢«é‡Šæ”¾æ—¶ï¼Œä¹‹å‰æ‰€æŒ‡å †å†…å­˜çš„å¼•ç”¨è®¡æ•°ä¹Ÿä¸ä¼šå› æ­¤è€Œå‡ 1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œweak_ptr ç±»å‹æŒ‡é’ˆå¹¶ä¸ä¼šå½±å“æ‰€æŒ‡å †å†…å­˜ç©ºé—´çš„å¼•ç”¨è®¡æ•°ã€‚ ","date":"2024-01-17","objectID":"/posts/cmake_note_7/:2:19","tags":["CMake"],"title":"CMake ç¬”è®° | [7] è®¾ç½®è¯­è¨€æ ‡å‡†ï¼ˆä¸€ï¼‰","uri":"/posts/cmake_note_7/"},{"categories":["C++"],"content":"ä¸€ã€ç¼–è¯‘å™¨é€‰é¡¹ç›¸å…³æ¦‚å¿µ ç¼–è¯‘å™¨é€‰é¡¹æ˜¯æŒ‡åœ¨ç¼–è¯‘ç¨‹åºæ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„é€‰é¡¹æ¥æ§åˆ¶ç¼–è¯‘å™¨çš„è¡Œä¸ºå’Œç”Ÿæˆçš„ä»£ç çš„ç‰¹æ€§ã€‚å¸¸è§çš„ç¼–è¯‘å™¨é€‰é¡¹åŒ…æ‹¬ä¼˜åŒ–é€‰é¡¹ã€è°ƒè¯•é€‰é¡¹ã€è­¦å‘Šé€‰é¡¹ã€é“¾æ¥é€‰é¡¹ç­‰ã€‚ ä¼˜åŒ–é€‰é¡¹å¯ä»¥æ§åˆ¶ç¼–è¯‘å™¨å¯¹ä»£ç è¿›è¡Œä¼˜åŒ–çš„ç¨‹åº¦ï¼Œä»¥æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚ è°ƒè¯•é€‰é¡¹å¯ä»¥ç”Ÿæˆè°ƒè¯•ä¿¡æ¯ï¼Œä»¥ä¾¿åœ¨ç¨‹åºå‡ºç°é—®é¢˜æ—¶è¿›è¡Œè°ƒè¯•ã€‚ è­¦å‘Šé€‰é¡¹å¯ä»¥æ§åˆ¶ç¼–è¯‘å™¨æ˜¯å¦ç”Ÿæˆè­¦å‘Šä¿¡æ¯ï¼Œä»¥å¸®åŠ©å¼€å‘è€…å‘ç°æ½œåœ¨çš„é—®é¢˜ã€‚ é“¾æ¥é€‰é¡¹å¯ä»¥æ§åˆ¶ç¼–è¯‘å™¨å¦‚ä½•å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥åœ¨ä¸€èµ·ï¼Œä»¥ç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ ä¸åŒçš„ç¼–è¯‘å™¨å¯èƒ½æ”¯æŒä¸åŒçš„é€‰é¡¹ï¼Œå…·ä½“çš„é€‰é¡¹å’Œä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒç¼–è¯‘å™¨çš„æ–‡æ¡£æˆ–è€…å®˜æ–¹ç½‘ç«™ã€‚ æœ¬ç¯‡å†…å®¹æ¶‰åŠåˆ°çš„ç¼–è¯‘å™¨é€‰é¡¹æœ‰: ä¼˜åŒ–é€‰é¡¹: -fPICã€-fno-rttiã€-fno exception -fPIC:è¡¨ç¤ºç”Ÿæˆä½ç½®æ— å…³ä»£ç ã€‚å…·ä½“æ¥è¯´ï¼Œä½ç½®æ— å…³ä»£ç å¯ä»¥åœ¨ä¸åŒçš„è¿›ç¨‹ç©ºé—´ä¸­åŠ è½½å’Œæ‰§è¡Œï¼Œè€Œä¸éœ€è¦è¿›è¡Œé‡å®šä½æ“ä½œã€‚fPICé€‰é¡¹é€šå¸¸ç”¨äºç”ŸæˆåŠ¨æ€åº“ï¼Œå› ä¸ºåŠ¨æ€åº“éœ€è¦åœ¨ä¸åŒçš„è¿›ç¨‹ç©ºé—´ä¸­åŠ è½½å’Œæ‰§è¡Œã€‚ä½¿ç”¨-fPICé€‰é¡¹å¯ä»¥ç¡®ä¿åŠ¨æ€åº“ä¸­çš„ä»£ç å¯ä»¥åœ¨ä¸åŒçš„è¿›ç¨‹ç©ºé—´ä¸­æ­£ç¡®åœ°æ‰§è¡Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨-fPICé€‰é¡¹ä¼šå¢åŠ ä»£ç çš„å¤§å°å’Œè¿è¡Œæ—¶å¼€é”€ï¼Œå› æ­¤éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥å†³å®šæ˜¯å¦ä½¿ç”¨è¯¥é€‰é¡¹ã€‚ -fno-rtti: é€‰é¡¹å¯ä»¥æ§åˆ¶ç¼–è¯‘å™¨æ˜¯å¦ç”Ÿæˆä¸C++è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ï¼ˆRTTIï¼‰ç›¸å…³çš„ä»£ç ï¼Œä»¥å‡å°ç¨‹åºçš„å¤§å°å’Œè¿è¡Œæ—¶å¼€é”€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¦ç”¨RTTIå¯èƒ½ä¼šå½±å“ç¨‹åºçš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå› ä¸ºRTTIå¯ä»¥å¸®åŠ©å¼€å‘è€…åœ¨è¿è¡Œæ—¶è·å–å¯¹è±¡çš„ç±»å‹ä¿¡æ¯ã€‚å› æ­¤ï¼Œéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥å†³å®šæ˜¯å¦ä½¿ç”¨è¯¥é€‰é¡¹ã€‚ -fno exception: è¡¨ç¤ºç¦ç”¨C++å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚å…·ä½“æ¥è¯´ï¼Œä½¿ç”¨è¯¥é€‰é¡¹å¯ä»¥ä½¿ç¼–è¯‘å™¨ä¸ç”Ÿæˆä¸å¼‚å¸¸å¤„ç†ç›¸å…³çš„ä»£ç ï¼Œä»è€Œå‡å°ç¨‹åºçš„å¤§å°å’Œè¿è¡Œæ—¶å¼€é”€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¦ç”¨å¼‚å¸¸å¤„ç†æœºåˆ¶å¯èƒ½ä¼šå½±å“ç¨‹åºçš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå› ä¸ºå¼‚å¸¸å¤„ç†æœºåˆ¶å¯ä»¥å¸®åŠ©å¼€å‘è€…å¤„ç†ç¨‹åºä¸­çš„å¼‚å¸¸æƒ…å†µã€‚å› æ­¤ï¼Œéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥å†³å®šæ˜¯å¦ä½¿ç”¨è¯¥é€‰é¡¹ã€‚ è­¦å‘Šé€‰é¡¹:-Wallã€-Wextraå’Œ-Wpedantic -Wall: è¡¨ç¤ºå¼€å¯æ‰€æœ‰è­¦å‘Šä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„è­¦å‘Šä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¸€äº›å¯èƒ½ä¼šè¢«å¿½ç•¥çš„è­¦å‘Šä¿¡æ¯ã€‚å¼€å¯-Wallé€‰é¡¹å¯ä»¥å¸®åŠ©å¼€å‘è€…å‘ç°æ½œåœ¨çš„é—®é¢˜ï¼Œæé«˜ä»£ç çš„è´¨é‡å’Œå¯é æ€§ã€‚ä½†æ˜¯ï¼Œç”±äº-Wallä¼šç”Ÿæˆå¤§é‡çš„è­¦å‘Šä¿¡æ¯ï¼Œæœ‰æ—¶å€™ä¼šå½±å“å¼€å‘æ•ˆç‡ï¼Œå› æ­¤éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥å†³å®šæ˜¯å¦å¼€å¯è¯¥é€‰é¡¹ã€‚ -Wextra: è¡¨ç¤ºå¼€å¯é¢å¤–çš„è­¦å‘Šä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€äº›ä¸å±äº-Wallé€‰é¡¹çš„è­¦å‘Šä¿¡æ¯ï¼Œä¾‹å¦‚ä¸€äº›ä¸ç¬¦åˆæ ‡å‡†çš„ä»£ç é£æ ¼ã€ä¸€äº›æœªä½¿ç”¨çš„å˜é‡ç­‰ã€‚åŒç†ï¼Œå¼€å¯-Wextraé€‰é¡¹å¯ä»¥å¸®åŠ©å¼€å‘è€…å‘ç°æ›´å¤šçš„æ½œåœ¨é—®é¢˜ï¼Œæé«˜ä»£ç çš„è´¨é‡å’Œå¯é æ€§ã€‚ä½†æ˜¯ï¼Œç”±äº-Wextraä¼šç”Ÿæˆæ›´å¤šçš„è­¦å‘Šä¿¡æ¯ï¼Œæœ‰æ—¶å€™ä¼šå½±å“å¼€å‘æ•ˆç‡ï¼Œå› æ­¤éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥å†³å®šæ˜¯å¦å¼€å¯è¯¥é€‰é¡¹ã€‚ -Wpedantic: è¡¨ç¤ºå¼€å¯ä¸¥æ ¼çš„è­¦å‘Šä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€äº›ä¸ç¬¦åˆCæˆ–C++æ ‡å‡†çš„ä»£ç è­¦å‘Šä¿¡æ¯ï¼Œä¾‹å¦‚ä½¿ç”¨äº†ä¸æ¨èçš„è¯­æ³•ã€æœªå®šä¹‰çš„è¡Œä¸ºç­‰ã€‚å¼€å¯-Wpedanticé€‰é¡¹å¯ä»¥å¸®åŠ©å¼€å‘è€…ç¼–å†™ç¬¦åˆæ ‡å‡†çš„ä»£ç ï¼Œæé«˜ä»£ç çš„å¯ç§»æ¤æ€§å’Œå¯é æ€§ã€‚åŒç†ï¼Œç”±äº-Wpedanticä¼šç”Ÿæˆæ›´å¤šçš„è­¦å‘Šä¿¡æ¯ï¼Œæœ‰æ—¶å€™ä¼šå½±å“å¼€å‘æ•ˆç‡ï¼Œå› æ­¤éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥å†³å®šæ˜¯å¦å¼€å¯è¯¥é€‰é¡¹ ","date":"2024-01-16","objectID":"/posts/cmake_note_6/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [6] è®¾ç½®ç¼–è¯‘é€‰é¡¹","uri":"/posts/cmake_note_6/"},{"categories":["C++"],"content":"äºŒã€ç¼–è¯‘å™¨é€‰é¡¹è®¾ç½® ä¸ºç›®æ ‡å‡†å¤‡äº†æ ‡å¿—åˆ—è¡¨ï¼Œå…¶ä¸­ä¸€äº›å°†æ— æ³•åœ¨Windowsä¸Šä½¿ç”¨ï¼š list(APPEND compile_flags \"-fPIC\" \"-Wall\" \"-fPIC\") if(NOT WIN32) list(APPEND compile_flags \"-Wextra\" \"-Wpedantic\") endif() ä¸ºåº“è®¾ç½®ç¼–è¯‘é€‰é¡¹ï¼š target_compile_options(test_message PRIVATE ${compile_flags} ) ç¼–è¯‘é€‰é¡¹å¯ä»¥æ·»åŠ ä¸‰ä¸ªçº§åˆ«çš„å¯è§æ€§ï¼šINTERFACEã€PUBLICå’ŒPRIVATEã€‚ PRIVATE:ç¼–è¯‘é€‰é¡¹ä¼šåº”ç”¨äºç»™å®šçš„ç›®æ ‡ï¼Œä¸ä¼šä¼ é€’ç»™ä¸ç›®æ ‡ç›¸å…³çš„ç›®æ ‡ã€‚ INTERFACE:ç»™å®šçš„ç¼–è¯‘é€‰é¡¹å°†åªåº”ç”¨äºæŒ‡å®šç›®æ ‡ï¼Œå¹¶ä¼ é€’ç»™ä¸ç›®æ ‡ç›¸å…³çš„ç›®æ ‡ã€‚ PUBLIC:ç¼–è¯‘é€‰é¡¹å°†åº”ç”¨äºæŒ‡å®šç›®æ ‡å’Œä½¿ç”¨å®ƒçš„ç›®æ ‡ã€‚ å¦‚ä½•ç¡®å®šé¡¹ç›®åœ¨CMakeæ„å»ºæ—¶ï¼Œå®é™…ä½¿ç”¨äº†å“ªäº›ç¼–è¯‘æ ‡å¿—ï¼Ÿ ä¸€ç§æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨CMakeå°†é¢å¤–çš„å‚æ•°ä¼ é€’ç»™æœ¬åœ°æ„å»ºå·¥å…·ã€‚æœ¬ä¾‹ä¸­ä¼šè®¾ç½®ç¯å¢ƒå˜é‡VERBOSE=1ï¼š mkdir -p build $ cd build $ cmake .. $ cmake --build . -- VERBOSE=1 ... lots of output ... Scanning dependencies of target test_message make[2]: ç¦»å¼€ç›®å½•â€œ/home/jiangli/repo/tutorials/cmake-tutorial/chapter1/13/buildâ€ /usr/bin/make -f message-module/CMakeFiles/test_message.dir/build.make message-module/CMakeFiles/test_message.dir/build make[2]: è¿›å…¥ç›®å½•â€œ/home/jiangli/repo/tutorials/cmake-tutorial/chapter1/13/buildâ€ [ 25%] Building CXX object message-module/CMakeFiles/test_message.dir/src/message.cpp.o cd /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/13/build/message-module \u0026\u0026 /usr/bin/c++ -I/home/jiangli/repo/tutorials/cmake-tutorial/chapter1/13/message-module/include -O3 -DNDEBUG -fPIC -Wall -Wextra -Wpedantic -std=gnu++11 -o CMakeFiles/test_message.dir/src/message.cpp.o -c /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/13/message-module/src/message.cpp [ 50%] Linking CXX static library ../lib/libtest_message_release.a ... lots of output ... ç¬¬äºŒç§ï¼Œä½¿ç”¨CMakeå‚æ•°è¿›è¡Œé…ç½®ï¼š $ cmake -D CMAKE_CXX_FLAGS=\"-fno-exceptions -fno-rtti\" .. è¿™ä¸ªå‘½ä»¤å°†ç¼–è¯‘é¡¹ç›®ï¼Œç¦ç”¨å¼‚å¸¸å’Œè¿è¡Œæ—¶ç±»å‹æ ‡è¯†(RTTI)ã€‚ ","date":"2024-01-16","objectID":"/posts/cmake_note_6/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [6] è®¾ç½®ç¼–è¯‘é€‰é¡¹","uri":"/posts/cmake_note_6/"},{"categories":["C++"],"content":"ä¸‰ã€è¡¥å…… å¤§å¤šæ•°æ—¶å€™ï¼Œç¼–è¯‘å™¨æœ‰ç‰¹æ€§æ ‡ç¤ºã€‚å½“å‰çš„ä¾‹å­åªé€‚ç”¨äºGCCå’ŒClangï¼›å…¶ä»–ç¼–è¯‘å™¨ä¸ç¡®å®šæ˜¯å¦ä¼šç†è§£è¿™äº›æ ‡å¿—ã€‚å¦‚æœé¡¹ç›®æ˜¯çœŸæ­£è·¨å¹³å°ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜å°±å¿…é¡»å¾—åˆ°è§£å†³ï¼Œä»¥ä¸‹ä¸ºä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š ç¬¬ä¸€ç§ï¼Œæ‰€éœ€ç¼–è¯‘å™¨æ ‡å¿—åˆ—è¡¨é™„åŠ åˆ°æ¯ä¸ªé…ç½®ç±»å‹CMakeå˜é‡CMAKE_\u003cLANG\u003e_FLAGS_\u003cCONFIG\u003eã€‚æ ‡å¿—ç¡®å®šè®¾ç½®ä¸ºç»™å®šç¼–è¯‘å™¨æœ‰æ•ˆçš„æ ‡å¿—ï¼Œå› æ­¤å°†åŒ…å«åœ¨if-endifå­å¥ä¸­ï¼Œç”¨äºæ£€æŸ¥CMAKE_\u003cLANG\u003e_COMPILER_IDå˜é‡ï¼š if(CMAKE_CXX_COMPILER_ID MATCHES GNU) list(APPEND CMAKE_CXX_FLAGS \"-fno-rtti\" \"-fno-exceptions\") list(APPEND CMAKE_CXX_FLAGS_DEBUG \"-Wsuggest-final-types\" \"-Wsuggest-final-methods\" \"-Wsuggest-override\") list(APPEND CMAKE_CXX_FLAGS_RELEASE \"-O3\" \"-Wno-unused\") endif() if(CMAKE_CXX_COMPILER_ID MATCHES Clang) list(APPEND CMAKE_CXX_FLAGS \"-fno-rtti\" \"-fno-exceptions\" \"-Qunused-arguments\" \"-fcolor-diagnostics\") list(APPEND CMAKE_CXX_FLAGS_DEBUG \"-Wdocumentation\") list(APPEND CMAKE_CXX_FLAGS_RELEASE \"-O3\" \"-Wno-unused\") endif() ç¬¬äºŒç§ï¼Œå®šä¹‰ç‰¹å®šçš„æ ‡å¿—åˆ—è¡¨ï¼š set(COMPILER_FLAGS) set(COMPILER_FLAGS_DEBUG) set(COMPILER_FLAGS_RELEASE) if(CMAKE_CXX_COMPILER_ID MATCHES GNU) list(APPEND CXX_FLAGS \"-fno-rtti\" \"-fno-exceptions\") list(APPEND CXX_FLAGS_DEBUG \"-Wsuggest-final-types\" \"-Wsuggest-final-methods\" \"-Wsuggest-override\") list(APPEND CXX_FLAGS_RELEASE \"-O3\" \"-Wno-unused\") endif() if(CMAKE_CXX_COMPILER_ID MATCHES Clang) list(APPEND CXX_FLAGS \"-fno-rtti\" \"-fno-exceptions\" \"-Qunused-arguments\" \"-fcolor-diagnostics\") list(APPEND CXX_FLAGS_DEBUG \"-Wdocumentation\") list(APPEND CXX_FLAGS_RELEASE \"-O3\" \"-Wno-unused\") endif() ç¨åï¼Œä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼æ¥è®¾ç½®ç¼–è¯‘å™¨æ ‡å¿—çš„åŸºç¡€ä¸Šï¼Œä¸ºæ¯ä¸ªé…ç½®å’Œæ¯ä¸ªç›®æ ‡ç”Ÿæˆæ„å»ºç³»ç»Ÿ: target_compile_option(test_message PRIVATE ${CXX_FLAGS} \"$\u003c$\u003cCONFIG:Debug\u003e:${CXX_FLAGS_DEBUG}\u003e\" \"$\u003c$\u003cCONFIG:Release\u003e:${CXX_FLAGS_RELEASE}\u003e\" ) è¿™é‡Œæˆ‘ä»¬æ¨èä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ã€‚ ä¸¤ç§æ–¹æ³•éƒ½æœ‰æ•ˆï¼Œå¹¶åœ¨è®¸å¤šé¡¹ç›®ä¸­å¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚ä¸è¿‡ï¼Œæ¯ç§æ–¹å¼éƒ½æœ‰ç¼ºç‚¹ã€‚CMAKE_\u003cLANG\u003e_COMPILER_IDä¸èƒ½ä¿è¯ä¸ºæ‰€æœ‰ç¼–è¯‘å™¨éƒ½å®šä¹‰ã€‚æ­¤å¤–ï¼Œä¸€äº›æ ‡å¿—å¯èƒ½ä¼šè¢«å¼ƒç”¨ï¼Œæˆ–è€…åœ¨ç¼–è¯‘å™¨çš„è¾ƒæ™šç‰ˆæœ¬ä¸­å¼•å…¥ã€‚ ä¸CMAKE_\u003cLANG\u003e_COMPILER_IDç±»ä¼¼ï¼ŒCMAKE_\u003cLANG\u003e_COMPILER_VERSIONå˜é‡ä¸èƒ½ä¿è¯ä¸ºæ‰€æœ‰è¯­è¨€å’Œä¾›åº”å•†éƒ½æä¾›å®šä¹‰ã€‚å°½ç®¡æ£€æŸ¥è¿™äº›å˜é‡çš„æ–¹å¼éå¸¸æµè¡Œï¼Œä½†æˆ‘ä»¬è®¤ä¸ºæ›´å¥å£®çš„æ›¿ä»£æ–¹æ³•æ˜¯æ£€æŸ¥æ‰€éœ€çš„æ ‡å¿—é›†æ˜¯å¦ä¸ç»™å®šçš„ç¼–è¯‘å™¨ä¸€èµ·å·¥ä½œï¼Œè¿™æ ·é¡¹ç›®ä¸­å®é™…ä¸Šåªä½¿ç”¨æœ‰æ•ˆçš„æ ‡å¿—ã€‚ ","date":"2024-01-16","objectID":"/posts/cmake_note_6/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [6] è®¾ç½®ç¼–è¯‘é€‰é¡¹","uri":"/posts/cmake_note_6/"},{"categories":["C++"],"content":"ä¸€ã€åŸºæœ¬æ¦‚å¿µæ„å»ºç±»å‹ CMakeå¯ä»¥è¯†åˆ«çš„æ„å»ºç±»å‹æ˜¯ï¼š Debugï¼šç”¨äºåœ¨æ²¡æœ‰ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å¸¦æœ‰è°ƒè¯•ç¬¦å·æ„å»ºåº“æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ Release: ç”¨äºæ„å»ºçš„ä¼˜åŒ–çš„åº“æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸åŒ…å«è°ƒè¯•ç¬¦å· RelWithDebInfoï¼šç”¨äºæ„å»ºè¾ƒå°‘çš„ä¼˜åŒ–åº“æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒåŒ…å«è°ƒè¯•ç¬¦å· MinSizeRelï¼šç”¨äºä¸å¢åŠ ç›®æ ‡ä»£ç å¤§å°çš„ä¼˜åŒ–æ–¹å¼ï¼Œæ¥æ„å»ºåº“æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ æ§åˆ¶ç”Ÿæˆæ„å»ºç³»ç»Ÿä½¿ç”¨çš„é…ç½®å˜é‡æ˜¯CMAKE_BUILD_TYPEï¼Œè¯¥å˜é‡é»˜è®¤ä¸ºç©ºã€‚ è¿™é‡Œæˆ‘ä»¬ä»ç„¶é€‰æ‹©CMakeç¬¬ä¸‰ç¯‡â€”åŠ¨æ€åº“å’Œé™æ€åº“çš„è¡¥å……ä¸­çš„ä»£ç ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¯¹CMakeLists.txtç¨ä½œä¿®æ”¹ã€‚ ","date":"2024-01-15","objectID":"/posts/cmake_note_5/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [5] æ„å»ºç±»å‹(Debugã€Releaseä»¥åŠå…¶ä»–)","uri":"/posts/cmake_note_5/"},{"categories":["C++"],"content":"äºŒã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â””â”€â”€ message_config.cmake.in â”œâ”€â”€ message-module â”‚ â”œâ”€â”€ CMakeLists.txt â”‚ â”œâ”€â”€ include â”‚ â”‚ â”œâ”€â”€ message_export_lib.h â”‚ â”‚ â””â”€â”€ message.h â”‚ â””â”€â”€ src â”‚ â””â”€â”€ message.cpp â”œâ”€â”€ CMakeLists.txt â””â”€â”€ hello_world.cpp 4 directories, 9 files é¡¹ç›®æºç : https://github.com/jianye0428/CMake_Learning_Notes/tree/main/Note_5/message_module_lib_standard ","date":"2024-01-15","objectID":"/posts/cmake_note_5/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [5] æ„å»ºç±»å‹(Debugã€Releaseä»¥åŠå…¶ä»–)","uri":"/posts/cmake_note_5/"},{"categories":["C++"],"content":"2.1 message-moduleæ¨¡å—ä¸‹çš„CMakeLists.txt file(GLOB SOURCE_FILE ${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp) if (BUILD_SHARED_LIBS) add_library(test_message SHARED ${SOURCE_FILE}) target_compile_definitions(test_message PUBLIC -DMESSAGE_LIB_SHARED_BUILD) target_compile_definitions(test_message PRIVATE -DMESSAGE_LIB_EXPORTS) else() add_library(test_message STATIC ${SOURCE_FILE}) endif() # æ·»åŠ åˆ«åï¼Œä»¥ä¾¿åº“å¯ä»¥åœ¨æ„å»ºæ ‘ä¸­ä½¿ç”¨ï¼Œä¾‹å¦‚åœ¨æµ‹è¯•æ—¶ add_library(test_message::test_message ALIAS test_message) target_include_directories(test_message PUBLIC $\u003cBUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}\u003e/include $\u003cINSTALL_INTERFACE:include\u003e ) set_target_properties(test_message PROPERTIES CXX_STANDARD 11 CMAKE_CXX_STANDARD_REQUIRED True ) set_target_properties(test_message PROPERTIES DEBUG_POSTFIX \"_debug\" RELEASE_POSTFIX \"_release\" ) install(TARGETS test_message EXPORT message_export_target RUNTIME DESTINATION \"bin\" LIBRARY DESTINATION \"lib\" ARCHIVE DESTINATION \"lib\" ) install(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/include/ DESTINATION \"include\" FILES_MATCHING PATTERN \"*.h\" ) install(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/include/ DESTINATION \"include\" FILES_MATCHING PATTERN \"*.hpp\" ) install(EXPORT message_export_target FILE message_lib.cmake DESTINATION lib/cmake/test_message ) include(CMakePackageConfigHelpers) # generate the config file that is includes the exports configure_package_config_file( ${CMAKE_SOURCE_DIR}/cmake/message_config.cmake.in \"${CMAKE_SOURCE_DIR}/cmake/message_config.cmake\" INSTALL_DESTINATION \"lib/cmake/test_message\" ) # generate the version file for the config file write_basic_package_version_file( \"${CMAKE_SOURCE_DIR}/cmake/message_config_version.cmake\" VERSION \"${PROJECT_VERSION_MAJOR}.${PROJECT_VERSION_MINOR}\" COMPATIBILITY AnyNewerVersion ) install(FILES ${CMAKE_SOURCE_DIR}/cmake/message_config.cmake ${CMAKE_SOURCE_DIR}/cmake/message_config_version.cmake DESTINATION lib/cmake/test_message ) export(EXPORT message_export_target FILE ${CMAKE_SOURCE_DIR}/cmake/message_config_version.cmake) ä»£ç é‡Šä¹‰: è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šæ²¡æœ‰åšä¿®æ”¹ï¼Œåªæ·»åŠ äº†ä»¥ä¸‹å†…å®¹ï¼š å¼•ç”¨ set_target_properties(test_message PROPERTIES DEBUG_POSTFIX \"_debug\" RELEASE_POSTFIX \"_release\" ) è¿™å°†åœ¨ debug æ„å»ºæ¨¡å¼ä¸‹å°†åº“ååç¼€è®¾ç½®ä¸º _debugï¼Œåœ¨ release æ„å»ºæ¨¡å¼ä¸‹å°†åº“ååç¼€è®¾ç½®ä¸º _releaseã€‚ ç„¶åï¼Œå¯ä»¥ä½¿ç”¨ test_message_debug æˆ– test_message_release æ¥å¼•ç”¨åº“ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥ä½¿ç”¨find_packageï¼Œç„¶åç›´æ¥ä½¿ç”¨åº“çš„åˆ«åtest_messageå³å¯ã€‚ ","date":"2024-01-15","objectID":"/posts/cmake_note_5/:2:1","tags":["CMake"],"title":"CMake ç¬”è®° | [5] æ„å»ºç±»å‹(Debugã€Releaseä»¥åŠå…¶ä»–)","uri":"/posts/cmake_note_5/"},{"categories":["C++"],"content":"2.2 æ ¹ç›®å½•ä¸‹çš„CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello-world LANGUAGES CXX) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin) option(BUILD_SHARED_LIBS \"Specifies the type of libraries (SHARED or STATIC) to build\" OFF) # Set install direcotory if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/) endif() if(NOT CMAKE_BUILD_TYPE) set(CMAKE_BUILD_TYPE Release CACHE STRING \"Build type\" FORCE) endif() message(STATUS \"Build type: ${CMAKE_BUILD_TYPE}\") message(STATUS \"C flags, Debug configuration: ${CMAKE_C_FLAGS_DEBUG}\") message(STATUS \"C flags, Release configuration: ${CMAKE_C_FLAGS_RELEASE}\") message(STATUS \"C flags, Release configuration with Debug info: ${CMAKE_C_FLAGS_RELWITHDEBINFO}\") message(STATUS \"C flags, minimal Release configuration: ${CMAKE_C_FLAGS_MINSIZEREL}\") message(STATUS \"C++ flags, Debug configuration: ${CMAKE_CXX_FLAGS_DEBUG}\") message(STATUS \"C++ flags, Release configuration: ${CMAKE_CXX_FLAGS_RELEASE}\") message(STATUS \"C++ flags, Release configuration with Debug info: ${CMAKE_CXX_FLAGS_RELWITHDEBINFO}\") message(STATUS \"C++ flags, minimal Release configuration: ${CMAKE_CXX_FLAGS_MINSIZEREL}\") add_subdirectory(${CMAKE_SOURCE_DIR}/message-module) include_directories( ${CMAKE_SOURCE_DIR}/message-module/include ) add_executable( ${PROJECT_NAME} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) target_link_libraries( ${PROJECT_NAME} test_message ) è¿™é‡Œï¼Œæˆ‘ä»¬æ·»åŠ äº†ä»¥ä¸‹å†…å®¹ï¼š å¼•ç”¨ if(NOT CMAKE_BUILD_TYPE) set(CMAKE_BUILD_TYPE Release CACHE STRING \"Build type\" FORCE) endif() message(STATUS \"Build type: ${CMAKE_BUILD_TYPE}\") message(STATUS \"C flags, Debug configuration: ${CMAKE_C_FLAGS_DEBUG}\") message(STATUS \"C flags, Release configuration: ${CMAKE_C_FLAGS_RELEASE}\") message(STATUS \"C flags, Release configuration with Debug info: ${CMAKE_C_FLAGS_RELWITHDEBINFO}\") message(STATUS \"C flags, minimal Release configuration: ${CMAKE_C_FLAGS_MINSIZEREL}\") message(STATUS \"C++ flags, Debug configuration: ${CMAKE_CXX_FLAGS_DEBUG}\") message(STATUS \"C++ flags, Release configuration: ${CMAKE_CXX_FLAGS_RELEASE}\") message(STATUS \"C++ flags, Release configuration with Debug info: ${CMAKE_CXX_FLAGS_RELWITHDEBINFO}\") message(STATUS \"C++ flags, minimal Release configuration: ${CMAKE_CXX_FLAGS_MINSIZEREL}\") é¦–å…ˆï¼Œæ£€æŸ¥æ˜¯å¦è®¾ç½®äº†æ„å»ºç±»å‹ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™å°†æ„å»ºç±»å‹è®¾ç½®ä¸º Releaseã€‚ç„¶åï¼Œå®ƒä½¿ç”¨ message å‘½ä»¤è¾“å‡ºå„ç§ç¼–è¯‘æ ‡å¿—ï¼ŒåŒ…æ‹¬ C å’Œ C++ çš„ Debug å’Œ Release é…ç½®ï¼Œä»¥åŠæœ€å° Release é…ç½®å’Œå¸¦æœ‰è°ƒè¯•ä¿¡æ¯çš„ Releaseé…ç½®ã€‚è¿™äº›ä¿¡æ¯å¯¹äºè°ƒè¯•å’Œä¼˜åŒ–æ„å»ºéå¸¸æœ‰ç”¨ã€‚ ","date":"2024-01-15","objectID":"/posts/cmake_note_5/:2:2","tags":["CMake"],"title":"CMake ç¬”è®° | [5] æ„å»ºç±»å‹(Debugã€Releaseä»¥åŠå…¶ä»–)","uri":"/posts/cmake_note_5/"},{"categories":["C++"],"content":"2.3 éªŒè¯è¾“å‡º æˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¿™é‡Œæ²¡æœ‰æŒ‡å®šæ„å»ºç±»å‹ï¼Œå³é»˜è®¤æ„å»ºç±»å‹ä¸ºReleaseã€‚ mkdir build cd build cmake .. è¾“å‡º: -- The CXX compiler identification is GNU 7.5.0 -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Check for working CXX compiler: /usr/bin/c++ - skipped -- Detecting CXX compile features -- Detecting CXX compile features - done -- Build type: Release -- C flags, Debug configuration: -- C flags, Release configuration: -- C flags, Release configuration with Debug info: -- C flags, minimal Release configuration: -- C++ flags, Debug configuration: -g -- C++ flags, Release configuration: -O3 -DNDEBUG -- C++ flags, Release configuration with Debug info: -O2 -g -DNDEBUG -- C++ flags, minimal Release configuration: -Os -DNDEBUG -- Configuring done -- Generating done -- Build files have been written to: /home/yejian/yejian_personal/c++_playground/CMake_Learning_Notes/Note_5/message_module_lib_standard/build æ‰§è¡Œmake: make [ 25%] Building CXX object message_module/CMakeFiles/test_message.dir/src/message.cpp.o [ 50%] Linking CXX static library ../lib/libtest_message_release.a [ 50%] Built target test_message [ 75%] Building CXX object CMakeFiles/hello-world.dir/hello_world.cpp.o [100%] Linking CXX executable bin/hello-world [100%] Built target hello-world å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ‰§è¡Œmakeå‘½ä»¤åï¼Œç”Ÿæˆçš„åº“å‘½åä¸ºlibtest_message_release.a,å¹¶å°†å…¶å­˜å…¥libç›®å½•ä¸­ã€‚ æ‰§è¡Œ: make install è¾“å‡ºç»“æœå¦‚ä¸‹: [ 50%] Built target test_message [100%] Built target hello-world Install the project... -- Install configuration: \"Release\" -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/12/output/lib/libtest_message_release.a -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/12/output/include -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/12/output/include/message_export_lib.h -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/12/output/include/message.h -- Up-to-date: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/12/output/include -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/12/output/lib/cmake/test_message/message_lib.cmake -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/12/output/lib/cmake/test_message/message_lib-release.cmake -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/12/output/lib/cmake/test_message/message_config.cmake -- Installing: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/12/output/lib/cmake/test_message/message_config_version.cmake è®¾ç½®æ„å»ºç±»å‹ä¸ºdebug: mkdir build cd build cmake .. -DCMAKE_BUILD_TYPE=Debug åˆ™è¾“å‡º: -- The CXX compiler identification is GNU 7.5.0 -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Check for working CXX compiler: /usr/bin/c++ - skipped -- Detecting CXX compile features -- Detecting CXX compile features - done -- Build type: Debug -- C flags, Debug configuration: -- C flags, Release configuration: -- C flags, Release configuration with Debug info: -- C flags, minimal Release configuration: -- C++ flags, Debug configuration: -g -- C++ flags, Release configuration: -O3 -DNDEBUG -- C++ flags, Release configuration with Debug info: -O2 -g -DNDEBUG -- C++ flags, minimal Release configuration: -Os -DNDEBUG -- Configuring done -- Generating done -- Build files have been written to: /home/yejian/yejian_personal/c++_playground/CMake_Learning_Notes/Note_5/message_module_lib_standard/build æ‰§è¡Œmake: make è¾“å‡ºå¦‚ä¸‹: [ 25%] Building CXX object message_module/CMakeFiles/test_message.dir/src/message.cpp.o [ 50%] Linking CXX static library ../lib/libtest_message_debug.a [ 50%] Built target test_message [ 75%] Building CXX object CMakeFiles/hello-world.dir/hello_world.cpp.o [100%] Linking CXX executable bin/hello-world [100%] Built target hello-world å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ‰§è¡Œmakeå‘½ä»¤åï¼Œç”Ÿæˆçš„åº“å‘½åä¸ºlibtest_message_debug.a,å¹¶å°†å…¶å­˜å…¥libç›®å½•ä¸­ã€‚ make install Consolidate compiler generated dependencies of target test_message [ 50%] Built target test_message Consolidate compiler generated dependencies of target hello-world [100%] Built target hello-wor","date":"2024-01-15","objectID":"/posts/cmake_note_5/:2:3","tags":["CMake"],"title":"CMake ç¬”è®° | [5] æ„å»ºç±»å‹(Debugã€Releaseä»¥åŠå…¶ä»–)","uri":"/posts/cmake_note_5/"},{"categories":["C++"],"content":"ä¸‰ã€è¡¥å…… Releaseå’ŒDebugåœ¨æ„å»ºé¡¹ç›®é€šå¸¸å¾ˆæœ‰ç”¨ï¼Œå¦‚è¯„ä¼°ç¼–è¯‘å™¨ä¼˜åŒ–çº§åˆ«çš„æ•ˆæœã€‚å¯¹äºå•é…ç½®ç”Ÿæˆå™¨ï¼Œå¦‚Unix Makefileã€MSYS Makefileæˆ–è€…Ninjaï¼Œå› ä¸ºè¦å¯¹é¡¹ç›®é‡æ–°é…ç½®ï¼Œè¿™é‡Œéœ€è¦è¿è¡ŒCMakeä¸¤æ¬¡ã€‚ ä¸è¿‡ï¼ŒCMakeä¹Ÿæ”¯æŒç¬¦åˆé…ç½®ç”Ÿæˆå™¨ã€‚è¿™äº›é€šå¸¸æ˜¯é›†æˆå¼€å‘ç¯å¢ƒæä¾›çš„é¡¹ç›®æ–‡ä»¶ï¼Œæœ€æ˜¾è‘—çš„æ˜¯Visual Studioå’ŒXCodeï¼Œå®ƒä»¬å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªé…ç½®ã€‚å¯ä»¥ä½¿ç”¨CMAKE_CONFIGURATION_TYPESå˜é‡å¯¹è¿™äº›ç”Ÿæˆå™¨çš„å¯ç”¨é…ç½®è¿›è¡Œè°ƒæ•´ã€‚ mkdir -p build cd build cmake .. -G\"Visual Studio 14 2019 Win64\" -D CMAKE_CONFIGURATION_TYPES=\"Release;Debug\" å°†ä¸ºReleaseå’ŒDebugé…ç½®ç”Ÿæˆä¸€ä¸ªæ„å»ºæ ‘ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿â€“configæ ‡å¿—æ¥å†³å®šæ„å»ºè¿™ä¸¤ä¸ªä¸­çš„å“ªä¸€ä¸ª: cmake --build . --config Release ","date":"2024-01-15","objectID":"/posts/cmake_note_5/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [5] æ„å»ºç±»å‹(Debugã€Releaseä»¥åŠå…¶ä»–)","uri":"/posts/cmake_note_5/"},{"categories":["C++"],"content":"ä¸€ã€æ¡ä»¶è¯­å¥ é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯æ‹¿æˆ‘ä»¬ä¸Šä¸€ç¯‡æ ¹ç›®å½•ä¸‹çš„CMakeLists.txtæ–‡ä»¶è¿›è¡Œè®²è§£ã€‚ æºç åœ°å€ä¸ºï¼šhttps://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter1/11 cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello-world LANGUAGES CXX) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin) option(BUILD_SHARED_LIBS \"Specifies the type of libraries (SHARED or STATIC) to build\" OFF) # Set install direcotory if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/) endif() add_subdirectory(${CMAKE_SOURCE_DIR}/message-module) include_directories( ${CMAKE_SOURCE_DIR}/message-module/include ) add_executable( ${PROJECT_NAME} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) target_link_libraries( ${PROJECT_NAME} test_message ) è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ¡ä»¶è¯­å¥if()...endif()å’Œä¸€ä¸ªé€‰é¡¹å‘½ä»¤optionã€‚è¿™ä¸€èŠ‚æˆ‘ä»¬å…ˆå¯¹æ¡ä»¶è¯­å¥if()...endif()è¿›è¡Œè®²è§£ï¼Œå…³äºé€‰é¡¹optionå‘½ä»¤ï¼Œå°†åœ¨ä¸‹ä¸€èŠ‚è¿›è¡Œè®²è§£ã€‚ Tip if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/) endif() åˆ¤æ–­CMakeè‡ªå¸¦çš„å®CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULTæœ‰æ²¡æœ‰å¤„äºå¼€å¯çŠ¶æ€ï¼Œå¦‚æœæ˜¯é»˜è®¤çŠ¶æ€çš„è¯ï¼Œåˆ™CMAKE_INSTALL_PREFIXå°†è¢«è®¾ç½®ä¸º${CMAKE_SOURCE_DIR}/output/ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬åªå†™ä¸€ä¸ªCMakeLists.txtå¯¹æ¡ä»¶è¯­å¥if()...else()å’Œå®CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULTã€CMAKE_INSTALL_PREFIXè¿›è¡Œæ¢ç´¢ã€‚ cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(condition) if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/) endif() message(\"CMAKE_INSTALL_PREFIX is \" ${CMAKE_INSTALL_PREFIX}) å¦‚æœæˆ‘ä»¬å¯¹CMAKE_INSTALL_PREFIXæå‰è¿›è¡Œäº†å®šä¹‰ cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(condition) set(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT off) if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/) else() set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/test) endif() message(\"CMAKE_INSTALL_PREFIX is \" ${CMAKE_INSTALL_PREFIX}) ","date":"2024-01-15","objectID":"/posts/cmake_note_4/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [4] æ¡ä»¶è¯­å¥ã€é€‰é¡¹å‘½ä»¤ä»¥åŠæŒ‡å®šç¼–è¯‘å™¨","uri":"/posts/cmake_note_4/"},{"categories":["C++"],"content":"äºŒã€å‘½ä»¤é€‰é¡¹ å½“ç„¶ï¼Œä¸Šè¿°å†…å®¹æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ç¼–è¯‘æ—¶ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œè€Œä¸ç”¨æ˜¾å¼åœ°åœ¨CMakeLists.txtä¸­å¯¹CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULTè¿›è¡Œè®¾ç½®ï¼Œä½†æˆ‘ä»¬éœ€è¦åœ¨CMakeLists.txtä¸­æ·»åŠ optionå‘½ä»¤ã€‚ cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(condition) option(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT \"Set default install path\" off) if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/) else() set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/test) endif() message(\"CMAKE_INSTALL_PREFIX is \" ${CMAKE_INSTALL_PREFIX}) cmake .. -DCMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT=OFF å…¶ä¸­ï¼Œ-Då¼€å…³ç”¨äºä¸ºCMakeè®¾ç½®ä»»ä½•ç±»å‹çš„å˜é‡ï¼šé€»è¾‘å˜é‡ã€è·¯å¾„ç­‰ç­‰ã€‚ æºç åœ°å€: https://gitee.com/jiangli01/tutorials/tree/master/cmake-tutorial/chapter1/11 ","date":"2024-01-15","objectID":"/posts/cmake_note_4/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [4] æ¡ä»¶è¯­å¥ã€é€‰é¡¹å‘½ä»¤ä»¥åŠæŒ‡å®šç¼–è¯‘å™¨","uri":"/posts/cmake_note_4/"},{"categories":["C++"],"content":"ä¸‰ã€æŒ‡å®šç¼–è¯‘å™¨ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰è€ƒè™‘è¿‡ä½¿ç”¨CMakeå¦‚ä½•é€‰æ‹©ç¼–è¯‘å™¨ã€‚CMakeå¯ä»¥æ ¹æ®å¹³å°å’Œç”Ÿæˆå™¨é€‰æ‹©ç¼–è¯‘å™¨ï¼Œè¿˜èƒ½å°†ç¼–è¯‘å™¨æ ‡å¿—è®¾ç½®ä¸ºé»˜è®¤å€¼ã€‚ åœ¨å®é™…å·¥ä½œä¸­ï¼ŒæŒ‡å®šç¼–è¯‘å™¨ååˆ†é‡è¦ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦äº¤å‰ç¼–è¯‘åµŒå…¥å¼çš„é¡¹ç›®ï¼Œäº¦æˆ–æ˜¯æˆ‘ä»¬å¯ä»¥å°†Qtã€OpenCVç­‰ä¸‰æ–¹åº“äº¤å‰ç¼–è¯‘åˆ°æˆ‘ä»¬çš„åµŒå…¥å¼é¡¹ç›®ä¸­ã€‚å…·ä½“å…³äºå¦‚ä½•ç¼–è¯‘å…¶ä»–ä¸‰æ–¹åº“ç”ŸæˆæŒ‡å®šçš„å½¢å¼ï¼Œæˆ‘ä»¬å°†åœ¨ä¹‹åè®²åˆ°äº¤å‰ç¼–è¯‘æ—¶ä¼šè¯¦ç»†è®²è§£ã€‚ ","date":"2024-01-15","objectID":"/posts/cmake_note_4/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [4] æ¡ä»¶è¯­å¥ã€é€‰é¡¹å‘½ä»¤ä»¥åŠæŒ‡å®šç¼–è¯‘å™¨","uri":"/posts/cmake_note_4/"},{"categories":["C++"],"content":"3.1 é€šè¿‡å‘½ä»¤è¡Œçš„å½¢å¼æŒ‡å®š cmake -D CMAKE_CXX_COMPILER=clang++ .. æŒ‡å®šc++çš„ç¼–è¯‘å™¨ä¸ºclang++ CMAKE_CXX_COMPILER æŒ‡å®šC++ç¼–è¯‘å™¨ CMAKE_C_COMPILER æŒ‡å®šCç¼–è¯‘å™¨ CMAKE_Fortran_COMPILER æŒ‡å®šFortranç¼–è¯‘å™¨ ","date":"2024-01-15","objectID":"/posts/cmake_note_4/:3:1","tags":["CMake"],"title":"CMake ç¬”è®° | [4] æ¡ä»¶è¯­å¥ã€é€‰é¡¹å‘½ä»¤ä»¥åŠæŒ‡å®šç¼–è¯‘å™¨","uri":"/posts/cmake_note_4/"},{"categories":["C++"],"content":"3.2 é€šè¿‡å¯¼å‡ºç¯å¢ƒå˜é‡æŒ‡å®š env CXX=clang++ cmake .. å¯¼å‡ºç¯å¢ƒå˜é‡ï¼ŒæŒ‡å®šC++çš„ç¼–è¯‘å™¨ä¸ºClang++ CXX(C++ç¼–è¯‘å™¨)ã€CC(Cç¼–è¯‘å™¨)å’ŒFC(Fortranç¼–è¯‘å™¨) å¼•ç”¨ æ³¨æ„: CMakeäº†è§£è¿è¡Œç¯å¢ƒï¼Œå¯ä»¥é€šè¿‡-Då¼€å…³æˆ–è€…ç¯å¢ƒå˜é‡è®¾ç½®è®¸å¤šé€‰é¡¹ã€‚ç¬¬ä¸€ç§æ–¹æ³•è¦†ç›–ç¬¬äºŒç§æ–¹æ³•ï¼Œä½†æ˜¯å»ºè®®ä½¿ç”¨-Dçš„æ˜¾å¼è®¾ç½®é€‰é¡¹ã€‚æ˜¾å¼ç”±äºéšå¼ï¼Œå› ä¸ºç¯å¢ƒå˜é‡å¯èƒ½è¢«è®¾ç½®ä¸ºä¸åˆé€‚çš„å€¼ï¼ˆå½“å‰é¡¹ç›®ï¼‰ã€‚ æ³¨æ„: è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾ï¼Œå…¶ä»–çš„ç¼–è¯‘å™¨ï¼Œå¦‚clang++åœ¨æ ‡å‡†çš„è·¯å¾„ä¸­å¯ä»¥ç”¨ï¼ŒCMakeå¯ä»¥åœ¨æ ‡å‡†è·¯å¾„ä¸­æ‰§è¡ŒæŸ¥æ‰¾ç¼–è¯‘å™¨ã€‚å¦‚æœåœ¨æ ‡å‡†è·¯å¾„ä¸­ä¸å¯ä»¥ç”¨ä½¿ç”¨ï¼Œåˆ™ç”¨æˆ·éœ€è¦å°†å®Œæ•´çš„ç¼–è¯‘å™¨å¯æ‰§è¡Œæ–‡ä»¶æˆ–è€…åŒ…è£…å™¨è·¯å¾„ä¼ é€’ç»™CMakeã€‚å¦‚ï¼š cmake -D CMAKE_CXX_COMPILER=/mnt/usr/bin/clang++ .. æ³¨æ„: è¿™é‡Œï¼Œå»ºè®®ä½¿ç”¨-DCMAKE_\u003cLANG\u003e_COMPILERé€‰é¡¹è®¾ç½®ç¼–è¯‘å™¨ï¼Œè€Œä¸æ˜¯å¯¼å‡ºCXXã€CCå’ŒFCã€‚è¿™æ˜¯ç¡®ä¿è·¨å¹³å°å¹¶ä¸éPOSIXå…¼å®¹çš„å”¯ä¸€æ–¹æ³•ã€‚ä¸ºäº†é¿å…å˜é‡æ±¡æŸ“ç¯å¢ƒï¼Œè¿™äº›å˜é‡ä¼šå½±å“ä¸é¡¹ç›®ä¸€èµ·æ„å»ºçš„å¤–éƒ¨åº“ç¯å¢ƒã€‚ ","date":"2024-01-15","objectID":"/posts/cmake_note_4/:3:2","tags":["CMake"],"title":"CMake ç¬”è®° | [4] æ¡ä»¶è¯­å¥ã€é€‰é¡¹å‘½ä»¤ä»¥åŠæŒ‡å®šç¼–è¯‘å™¨","uri":"/posts/cmake_note_4/"},{"categories":["C++"],"content":"3.3 åœ¨CMakeä¸­æŒ‡å®š set(CMAKE_CXX_COMPILER /mnt/usr/bin/clang++) åœ¨ä½¿ç”¨CMakeè¿›è¡Œæ„å»ºæ—¶ï¼ŒCMakeä¼šè¿›è¡Œä¸€ç³»åˆ—çš„å¹³å°æµ‹è¯•ï¼Œä»¥ç¡®å®šå“ªäº›ç¼–è¯‘å™¨å¯ä»¥ä½¿ç”¨ä»¥åŠå®ƒä»¬æ˜¯å¦é€‚åˆå½“å‰çš„é¡¹ç›®ã€‚ ä¸€ä¸ªåˆé€‚çš„ç¼–è¯‘å™¨ä¸ä»…å–å†³äºæˆ‘ä»¬ä½¿ç”¨çš„å¹³å°ï¼Œè¿˜å–å†³äºæˆ‘ä»¬æƒ³è¦çš„ç”Ÿæˆå™¨ã€‚CMakeæ‰§è¡Œçš„ç¬¬ä¸€ä¸ªæµ‹è¯•åŸºäºé¡¹ç›®è¯­è¨€çš„ç¼–è¯‘å™¨åç§°ã€‚å¦‚ï¼ŒCCæ˜¯ä¸€ä¸ªå·¥ä½œiçš„Cç¼–è¯‘å™¨ï¼Œé‚£ä¹ˆå®ƒå°†ç”¨ä½œCé¡¹ç›®çš„é»˜è®¤ç¼–è¯‘å™¨ã€‚ GNU/Linuxä¸Šï¼Œä½¿ç”¨Unix Makefileæˆ–Ninjaæ—¶ï¼ŒGCCå®¶æ—ä¸­çš„ç¼–è¯‘å™¨å¾ˆå¯èƒ½æ˜¯C++ã€Cå’ŒFortrançš„é»˜è®¤é€‰æ‹©ã€‚Windowsä¸Šï¼Œå°†é€‰æ‹©Visual Studioä¸­C++å’ŒCç¼–è¯‘å™¨ã€‚å¦‚æœé€‰æ‹©MinGWæˆ–MSYS Makefileä½œä¸ºç”Ÿæˆå™¨ï¼Œåˆ™é»˜è®¤ä½¿ç”¨MinGWç¼–è¯‘å™¨ã€‚ ","date":"2024-01-15","objectID":"/posts/cmake_note_4/:3:3","tags":["CMake"],"title":"CMake ç¬”è®° | [4] æ¡ä»¶è¯­å¥ã€é€‰é¡¹å‘½ä»¤ä»¥åŠæŒ‡å®šç¼–è¯‘å™¨","uri":"/posts/cmake_note_4/"},{"categories":["C++"],"content":"3.4 ç¼–è¯‘å™¨çš„è¡¥å…… æˆ‘ä»¬å¹³å°ä¸Šçš„CMakeå¯ä»¥æ‰¾åˆ°å¯ç”¨çš„ç¼–è¯‘å™¨å’Œç¼–è¯‘å™¨æ ‡å¿—çš„æ–¹æ³•æ˜¯ï¼šCMakeæä¾›--system-informationæ ‡å¿—ï¼Œä»–å°†æŠŠå…³äºç³»ç»Ÿçš„æ‰€æœ‰ä¿¡æ¯è½¬å‚¨åˆ°å±å¹•æˆ–è€…æ–‡ä»¶ä¸­ã€‚ cmake --system-information information.txt æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°CMAKE_CXX_COMPILERã€CMAKE_C_COMPILERå’ŒCMAKE_Fortran_COMPILERçš„é»˜è®¤å€¼ï¼Œä»¥åŠé»˜è®¤æ ‡å¿—ã€‚ CMakeæä¾›äº†é¢å¤–çš„å˜é‡æ¥ä¸ç¼–è¯‘å™¨äº¤äº’ï¼š CMAKE_\u003cLANG\u003e_COMPILER_LOADED:å¦‚æœä¸ºé¡¹ç›®å¯ç”¨äº†è¯­è¨€ï¼Œåˆ™å°†è®¾ç½®ä¸ºTRUEã€‚ CMAKE_\u003cLANG\u003e_COMPILER_ID:ç¼–è¯‘å™¨æ ‡è¯†å­—ç¬¦ä¸²ï¼Œç¼–è¯‘å™¨ä¾›åº”å•†æ‰€ç‰¹æœ‰ã€‚ä¾‹å¦‚ï¼ŒGCCç”¨äºGNUç¼–è¯‘å™¨é›†åˆï¼ŒAppleClangç”¨äºmacOSä¸Šçš„Clang, MSVCç”¨äºMicrosoft Visual Studioç¼–è¯‘å™¨ã€‚æ³¨æ„ï¼Œä¸èƒ½ä¿è¯ä¸ºæ‰€æœ‰ç¼–è¯‘å™¨æˆ–è¯­è¨€å®šä¹‰æ­¤å˜é‡ã€‚ CMAKE_COMPILER_IS_GNU\u003cLANG\u003e:å¦‚æœè¯­è¨€æ˜¯GNUç¼–è¯‘å™¨é›†åˆçš„ä¸€éƒ¨åˆ†ï¼Œåˆ™å°†æ­¤é€»è¾‘å˜é‡è®¾ç½®ä¸ºTRUEã€‚æ³¨æ„å˜é‡åçš„éƒ¨åˆ†éµå¾ªGNUçº¦å®šï¼šCè¯­è¨€ä¸ºCC, C++è¯­è¨€ä¸ºCXX, Fortranè¯­è¨€ä¸ºG77ã€‚ CMAKE_\u003cLANG\u003e_COMPILER_VERSION:æ­¤å˜é‡åŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²ç»™å®šè¯­è¨€çš„ç¼–è¯‘å™¨ç‰ˆæœ¬ã€‚ç‰ˆæœ¬ä¿¡æ¯åœ¨major[.minor[.patch[.tweak]]]ä¸­ç»™å‡ºã€‚ä½†æ˜¯ï¼Œå¯¹äºCMAKE__COMPILER_IDï¼Œä¸èƒ½ä¿è¯æ‰€æœ‰ç¼–è¯‘å™¨æˆ–è¯­è¨€éƒ½å®šä¹‰äº†æ­¤å˜é‡ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç¼–è¯‘å™¨ï¼Œæ„å»ºä¸‹é¢çš„CMakeLists.txtã€‚ cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(recipe-06 LANGUAGES C CXX) message(STATUS \"Is the C++ compiler loaded? ${CMAKE_CXX_COMPILER_LOADED}\") if(CMAKE_CXX_COMPILER_LOADED) message(STATUS \"The C++ compiler ID is: ${CMAKE_CXX_COMPILER_ID}\") message(STATUS \"Is the C++ from GNU? ${CMAKE_COMPILER_IS_GNUCXX}\") message(STATUS \"The C++ compiler version is: ${CMAKE_CXX_COMPILER_VERSION}\") endif() message(STATUS \"Is the C compiler loaded? ${CMAKE_C_COMPILER_LOADED}\") if(CMAKE_C_COMPILER_LOADED) message(STATUS \"The C compiler ID is: ${CMAKE_C_COMPILER_ID}\") message(STATUS \"Is the C from GNU? ${CMAKE_COMPILER_IS_GNUCC}\") message(STATUS \"The C compiler version is: ${CMAKE_C_COMPILER_VERSION}\") endif() ","date":"2024-01-15","objectID":"/posts/cmake_note_4/:3:4","tags":["CMake"],"title":"CMake ç¬”è®° | [4] æ¡ä»¶è¯­å¥ã€é€‰é¡¹å‘½ä»¤ä»¥åŠæŒ‡å®šç¼–è¯‘å™¨","uri":"/posts/cmake_note_4/"},{"categories":["C++"],"content":"ä¸€ã€å¯¼è¨€ å¯¹CMakeåœ¨ä¸åŒå¹³å°ä¸Šæ„å»ºåŠ¨æ€åº“å’Œé™æ€åº“åšè¿›ä¸€æ­¥çš„æ¢ç´¢ï¼Œå³å¦‚ä½•åˆ©ç”¨ä¸€ä¸ªæ¯”è¾ƒç»Ÿä¸€çš„æ¨¡æ¿åœ¨ä¸åŒçš„å¹³å°æ„å»ºé™æ€åº“å’ŒåŠ¨æ€åº“ï¼Œä»¥åŠå¯¹add_libraryå‘½ä»¤çš„å…¶ä»–å‚æ•°åšè¿›ä¸€æ­¥çš„æ¢ç´¢ã€‚ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:1:0","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"äºŒã€åº“æ¨¡æ¿ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:2:0","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"2.1 é¡¹ç›®ç»“æ„ . â”œâ”€â”€ cmake â”‚ â””â”€â”€ message_config.cmake.in â”œâ”€â”€ message-module â”‚ â”œâ”€â”€ include â”‚ â”‚ â”œâ”€â”€ message_export_lib.h â”‚ â”‚ â””â”€â”€ message.h â”‚ â”œâ”€â”€ src â”‚ â”‚ â””â”€â”€ message.cpp â”‚ â””â”€â”€ CMakeLists.txt â”œâ”€â”€ hello_world.cpp â””â”€â”€ CMakeLists.txt æœ¬é¡¹ç›®çš„ç»“æ„ç›¸å¯¹æ¯”è¾ƒå¤æ‚ï¼Œä¸ºäº†èƒ½å¤Ÿç”Ÿæˆä¸€å¥—æ¯”è¾ƒæ ‡å‡†çš„åº“ï¼ˆé™æ€åº“/åŠ¨æ€åº“ï¼‰ï¼Œæ‰€ä»¥é¡¹ç›®ä¸­ä¼šåŒ…å«å¾ˆå¤šé…ç½®é¡¹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¼šå¯¹é¡¹ç›®ä¸­çš„æ‰€æœ‰å†…å®¹è¿›è¡Œä¸€ä¸€è®²è§£ã€‚ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:2:1","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"2.2 æ ¹ç›®å½•ä¸‹çš„CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello-world LANGUAGES CXX) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin) option(BUILD_SHARED_LIBS \"Specifies the type of libraries (SHARED or STATIC) to build\" OFF) # Set install direcotory if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/) endif() add_subdirectory(${CMAKE_SOURCE_DIR}/message-module) include_directories( ${CMAKE_SOURCE_DIR}/message-module/include ) add_executable( ${PROJECT_NAME} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) target_link_libraries( ${PROJECT_NAME} test_message ) Tip option(BUILD_SHARED_LIBS \"Specifies the type of libraries (SHARED or STATIC) to build\" OFF) é¦–å…ˆï¼Œæˆ‘ä»¬æä¾›äº†åœ¨æ‰§è¡Œcmakeå‘½ä»¤æ—¶çš„å‚æ•°é€‰é¡¹ï¼Œé»˜è®¤é»˜è®¤æƒ…å†µä¸‹BUILD_SHARED_LIBSçš„çŠ¶æ€æ˜¯å…³é—­çš„(OFF)ï¼Œå³é»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬é»˜è®¤æ„å»ºçš„æ˜¯é™æ€åº“ã€‚ å½“æˆ‘ä»¬è¦æ„å»ºåŠ¨æ€åº“æ—¶ï¼Œæˆ‘ä»¬éœ€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆå‡è®¾ä½ å·²ç»åœ¨é¡¹ç›®ä¸­æ„å»ºäº†buildæ–‡ä»¶å¤¹,å¹¶ä¸”ä½ ç°åœ¨åœ¨buildç›®å½•ä¸­ï¼‰ cmake .. -DBUILD_SHARED_LIBS=ON Tip if(CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT) set(CMAKE_INSTALL_PREFIX ${CMAKE_SOURCE_DIR}/output/) endif() å¦‚æœæˆ‘ä»¬æ²¡æœ‰æŒ‡å®šåœ¨make installåçš„è¾“å‡ºè·¯å¾„ï¼Œåˆ™CMAKE_INSTALL_PREFIX å°†è®¾ç½®ä¸º${CMAKE_SOURCE_DIR}/output/ï¼Œå³å½“å‰é¡¹ç›®ä¸‹çš„outputç›®å½•ã€‚ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:2:2","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"2.3 cmakeç›®å½•ä¸‹çš„message_config.cmake.in @PACKAGE_INIT@ include ( \"${CMAKE_CURRENT_LIST_DIR}/message_config.cmake\" ) ä¸ºäº†èƒ½å¤Ÿç”Ÿæˆä¸€ä¸ªæ ‡å‡†çš„åº“ï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ªmessage_config.cmake.inæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ‰§è¡Œmake installæ—¶å°†è¢«è°ƒç”¨ï¼Œè°ƒç”¨æ—¶æˆ‘ä»¬å†è¿›è¡Œè®²è§£ã€‚ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:2:3","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"2.4 message-moduleä¸‹message_export_lib.h #ifndef MESSAGE_EXPORT_LIB_H_ #define MESSAGE_EXPORT_LIB_H_ #ifdef MESSAGE_LIB_SHARED_BUILD #ifdef _WIN32 #ifdef MESSAGE_LIB_EXPORTS #define MESSAGE_LIB_API __declspec(dllexport) #else #define MESSAGE_LIB_API __declspec(dllimport) #endif // MESSAGE_LIB_EXPORTS #else #define MESSAGE_LIB_API #endif // _WIN32 #else #define MESSAGE_LIB_API #endif // MESSAGE_LIB_SHARED_BUILD #endif // ! MESSAGE_EXPORT_LIB_H_ é¦–å…ˆï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰äº†å®å®šä¹‰MESSAGE_LIB_SHARED_BUILD(å³æˆ‘ä»¬è¦æ„å»ºåŠ¨æ€åº“æ—¶)ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼šå¦‚æœæ˜¯Windowså¹³å°ï¼Œå¹¶ä¸”æ˜¯åœ¨ç”ŸæˆåŠ¨æ€åº“æ—¶ï¼Œå³å®šä¹‰äº†(MESSAGE_LIB_EXPORTS)ï¼Œå°†__declspec(dllexport)å®šä¹‰ä¸ºMESSAGE_LIB_APIï¼›å¦‚æœæ˜¯ä½¿ç”¨åŠ¨æ€åº“æ—¶ï¼Œå³æœªå®šä¹‰(MESSAGE_LIB_EXPORTS)ï¼Œåˆ™å°†__declspec(dllimport)å®šä¹‰ä¸ºMESSAGE_LIB_APIã€‚å¦‚æœæ˜¯éWindowså¹³å°ï¼Œåˆ™å¯¹å®MESSAGE_LIB_APIä¸åšä»»ä½•æ“ä½œ(å› ä¸ºåœ¨éWindowså¹³å°ä¸Šå¯ä»¥åŠ¨æ€åº“çš„ç”Ÿæˆå’Œä½¿ç”¨ä¸é™æ€åº“æ˜¯ä¸€æ ·çš„)ã€‚ ç„¶åï¼Œå¦‚æœæˆ‘ä»¬æœªå®šä¹‰å®å®šä¹‰MESSAGE_LIB_SHARED_BUILD(å³æˆ‘ä»¬è¦æ„å»ºé™æ€åº“æ—¶)ï¼Œæˆ‘ä»¬å¯¹å®MESSAGE_LIB_APIä¸åšä»»ä½•æ“ä½œã€‚ æ³¨æ„ï¼šå…³äºå®å®šä¹‰MESSAGE_LIB_SHARED_BUILDå’ŒMESSAGE_LIB_EXPORTSæ˜¯å¦è¦æ·»åŠ åˆ©ç”¨message-moduleä¸‹çš„CMakeLists.txtè¿›è¡Œé…ç½®ã€‚ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:2:4","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"2.5 message-moduleä¸‹message.h #ifndef MESSAGE_HEADER_H_ #define MESSAGE_HEADER_H_ #include \u003ciostream\u003e #include \u003cstring\u003e #include \"message_export_lib.h\" class MESSAGE_LIB_API Message { public: Message() {} void Print(const std::string \u0026message); }; #endif æˆ‘ä»¬å°†å¤´æ–‡ä»¶message_export_lib.håŒ…å«è¿›æ¥ï¼Œæ¥æ§åˆ¶åœ¨ä¸åŒå¹³å°ç”Ÿæˆä¸åŒçš„åº“æ—¶çš„é€‰é¡¹ã€‚ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:2:5","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"2.6 message-moduleä¸‹çš„CMakeLists.txt file(GLOB SOURCE_FILE ${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp) if (BUILD_SHARED_LIBS) add_library(test_message SHARED ${SOURCE_FILE}) target_compile_definitions(test_message PUBLIC -DMESSAGE_LIB_SHARED_BUILD) target_compile_definitions(test_message PRIVATE -DMESSAGE_LIB_EXPORTS) else() add_library(test_message STATIC ${SOURCE_FILE}) endif() # æ·»åŠ åˆ«åï¼Œä»¥ä¾¿åº“å¯ä»¥åœ¨æ„å»ºæ ‘ä¸­ä½¿ç”¨ï¼Œä¾‹å¦‚åœ¨æµ‹è¯•æ—¶ add_library(test_message::test_message ALIAS test_message) target_include_directories(test_message PUBLIC $\u003cBUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}\u003e/include $\u003cINSTALL_INTERFACE:include\u003e ) set_target_properties(test_message PROPERTIES CXX_STANDARD 11 CMAKE_CXX_STANDARD_REQUIRED True ) install(TARGETS test_message EXPORT message_export_target RUNTIME DESTINATION \"bin\" LIBRARY DESTINATION \"lib\" ARCHIVE DESTINATION \"lib\" ) install(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/include/ DESTINATION \"include\" FILES_MATCHING PATTERN \"*.h\" ) install(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/include/ DESTINATION \"include\" FILES_MATCHING PATTERN \"*.hpp\" ) install(EXPORT message_export_target FILE message_lib.cmake DESTINATION lib/cmake/test_message ) include(CMakePackageConfigHelpers) # generate the config file that is includes the exports configure_package_config_file( ${CMAKE_SOURCE_DIR}/cmake/message_config.cmake.in \"${CMAKE_SOURCE_DIR}/cmake/message_config.cmake\" INSTALL_DESTINATION \"lib/cmake/test_message\" ) # generate the version file for the config file write_basic_package_version_file( \"${CMAKE_SOURCE_DIR}/cmake/message_config_version.cmake\" VERSION \"${PROJECT_VERSION_MAJOR}.${PROJECT_VERSION_MINOR}\" COMPATIBILITY AnyNewerVersion ) install(FILES ${CMAKE_SOURCE_DIR}/cmake/message_config.cmake ${CMAKE_SOURCE_DIR}/cmake/message_config_version.cmake DESTINATION lib/cmake/test_message ) export(EXPORT message_export_target FILE ${CMAKE_SOURCE_DIR}/cmake/message_config_version.cmake) å¦‚æœæˆ‘ä»¬è®©å®BUILD_SHARED_LIBSä¸ºå¼€å¯çŠ¶æ€(å³æˆ‘ä»¬è¦æ„å»ºåŠ¨æ€åº“)ï¼Œæˆ‘ä»¬è¦å°†å®å®šä¹‰MESSAGE_LIB_SHARED_BUILDå’ŒMESSAGE_LIB_EXPORTSæ·»åŠ åˆ°ç¼–è¯‘å™¨ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬çš„å¤´æ–‡ä»¶message_export_lib.hä¸­ä¾¿çŸ¥é“æˆ‘ä»¬è¦æ„å»ºåŠ¨æ€åº“ã€‚ å¦åˆ™(å³æˆ‘ä»¬æ²¡æœ‰è®©BUILD_SHARED_LIBSå¼€å¯)ï¼Œæˆ‘ä»¬å°†æ„å»ºé™æ€åº“ã€‚ åˆ©ç”¨CMakePackageConfigHelpersæ¨¡å—ç”Ÿæˆå…³äºtest_messageåº“çš„cmakeçš„é…ç½®æ–‡ä»¶ï¼Œä¸”å¯ä»¥ä½¿ç”¨å‘½ä»¤find_packageå‘½ä»¤æ‰¾åˆ°åº“test_messageåº“ã€‚å…³äºä»¥ä¸Šå‘½ä»¤çš„å…·ä½“å‚æ•°ä½¿ç”¨ï¼Œæˆ‘ä»¬å°†åœ¨å…·ä½“çš„å‘½ä»¤å­¦ä¹ ç« èŠ‚è¿›è¡Œå…·ä½“çš„è®²è§£å’Œå­¦ä¹ ã€‚ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:2:6","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"ä¸‰ã€add_libraryå…¶ä»–å‚æ•°çš„ä¸€äº›æ¢ç´¢ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:3:0","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"3.1 ç”Ÿæˆå¯¹è±¡åº“ cmake_minimum_required(VERSION 3.5 FATAL_ERROR) project(recipe-03 LANGUAGES CXX) add_library(message-objs OBJECT Message.hpp Message.cpp ) # this is only needed for older compilers # but doesn't hurt either to have it set_target_properties(message-objs PROPERTIES POSITION_INDEPENDENT_CODE 1 ) add_library(message-shared SHARED $\u003cTARGET_OBJECTS:message-objs\u003e ) add_library(message-static STATIC $\u003cTARGET_OBJECTS:message-objs\u003e ) add_executable(hello-world hello-world.cpp) target_link_libraries(hello-world message-static) ä¸ºäº†ä¿è¯ç¼–è¯‘çš„ç›®æ ‡æ–‡ä»¶ä¸ç”Ÿæˆä½ç½®æ— å…³ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨set_target_propertieså‘½ä»¤ï¼Œè®¾ç½®message-objsç›®æ ‡çš„ç›¸åº”å±æ€§æ¥å®ç°ã€‚ **æ³¨æ„:**å¯èƒ½åœ¨æŸäº›å¹³å°å’Œ/æˆ–ä½¿ç”¨è¾ƒè€çš„ç¼–è¯‘å™¨ä¸Šï¼Œéœ€è¦æ˜¾å¼åœ°ä¸ºç›®æ ‡è®¾ç½®POSITION_INDEPENDENT_CODEå±æ€§ã€‚ ç°åœ¨ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡åº“æ¥è·å–é™æ€åº“(message-static)å’ŒåŠ¨æ€åº“(message-shared)ã€‚è¦æ³¨æ„å¼•ç”¨å¯¹è±¡åº“çš„ç”Ÿæˆå™¨è¡¨è¾¾å¼è¯­æ³•:$\u003cTARGET_OBJECTS:message-objs\u003eã€‚ç”Ÿæˆå™¨è¡¨è¾¾å¼æ˜¯CMakeåœ¨ç”Ÿæˆæ—¶(å³é…ç½®ä¹‹å)æ„é€ ï¼Œç”¨äºç”Ÿæˆç‰¹å®šäºé…ç½®çš„æ„å»ºè¾“å‡ºã€‚ ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:3:1","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"3.2 å°†é™æ€åº“å’ŒåŠ¨æ€åº“åŒæ—¶å‘½åä¸ºåŒåçš„ä¸¤ä¸ªåº“ add_library(message-shared SHARED $\u003cTARGET_OBJECTS:message-objs\u003e ) set_target_properties(message-shared PROPERTIES OUTPUT_NAME \"message\" ) add_library(message-static STATIC $\u003cTARGET_OBJECTS:message-objs\u003e ) set_target_properties(message-static PROPERTIES OUTPUT_NAME \"message\" ) ","date":"2024-01-14","objectID":"/posts/cmake_note_3/:3:2","tags":["CMake"],"title":"CMake ç¬”è®° | [3] é™æ€åº“å’ŒåŠ¨æ€çš„è¡¥å……","uri":"/posts/cmake_note_3/"},{"categories":["C++"],"content":"ä¸€ã€é¡¹ç›®ç»“æ„ . â”œâ”€â”€ include â”‚ â””â”€â”€ message.h â”œâ”€â”€ src â”‚ â””â”€â”€ message.cpp â”œâ”€â”€ hello_world.cpp â””â”€â”€ CMakeLists.txt é¡¹ç›®ç»“æ„æ˜¯ä¸ºäº†è®©æˆ‘ä»¬å¼€å‘äººå‘˜å¯¹é¡¹ç›®æ›´åŠ æ¸…æ™°ï¼Œä½¿ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ï¼ˆæ¨¡å—åŒ–ï¼‰ã€‚ä¸€èˆ¬æˆ‘ä»¬çš„é¡¹ç›®æ¯”è¾ƒç®€å•æ—¶ï¼Œå¯ä»¥æ„å»ºä¸ºå¦‚ä¸Šçš„é¡¹ç›®ç»“æ„ã€‚ä½†æ˜¯åœ¨æ„å»ºå¤§å‹é¡¹ç›®æ—¶ï¼Œé¡¹ç›®ç»“æ„ä¼šæ›´åŠ å¤æ‚ï¼Œå…·ä½“è¯·å‚è€ƒä¸‹èŠ‚å†…å®¹ã€‚ è¿™é‡Œæˆ‘ä»¬æ„å»ºäº†includeç›®å½•å’Œsrcç›®å½•ï¼Œincludeç›®å½•ä¸»è¦å­˜æ”¾çš„æ˜¯CPPæ–‡ä»¶çš„å¤´æ–‡ä»¶ï¼Œå³å‡½æ•°çš„å£°æ˜ï¼Œä¸ºä½¿ç”¨å®ƒçš„æ–‡ä»¶æä¾›APIã€‚srcç›®å½•ä¸»è¦æ˜¯å­˜æ”¾çš„å‡½æ•°çš„å…·ä½“å®ç°ã€‚ æºç åœ°å€: ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:1","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"äºŒã€message.h #ifndef MESSAGE_HEADER_H_ #define MESSAGE_HEADER_H_ #include \u003ciostream\u003e #include \u003cstring\u003e class Message { public: Message() {} void Print(const std::string \u0026message); }; #endif // ! MESSAGE_HEADER_H_ ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:2","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"ä¸‰ã€message.cpp #include \"message.h\" void Message::Print(const std::string \u0026message) { std::cout \u003c\u003c message \u003c\u003c std::endl; } ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:3","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"å››ã€hello_world.cpp #include \"message.h\" int main() { Message message; message.Print(\"Hello, CMake World!\"); message.Print(\"Goodbye, CMake World!\"); return EXIT_SUCCESS; } ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:4","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"äº”ã€CMakeæ–‡ä»¶ cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello-world LANGUAGES CXX) include_directories( ${CMAKE_SOURCE_DIR}/include ) file(GLOB HEADER ${CMAKE_SOURCE_DIR}/include/*.h) file(GLOB SOURCE ${CMAKE_SOURCE_DIR}/src/*.cpp) add_executable( ${PROJECT_NAME} ${HEADER} ${SOURCE} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) ä»£ç é‡Šä¹‰: Tip include_directories( ${CMAKE_SOURCE_DIR}/include ) å°†includeç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŒ…å«è¿›æ¥ï¼Œè¿™æ ·includeç›®å½•ä¸‹çš„message.hå°†ä¼šè¢«åŒ…å«åˆ°æ•´ä¸ªé¡¹ç›®ä¸­ã€‚å¦‚æœæˆ‘ä»¬åœ¨ç»†åˆ†ç›®å½•ä¸­ä½¿ç”¨åŒ…å«æŸä¸€æ¨¡å—çš„å¤´æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…·ä½“æ¨¡å—çš„CMakeLists.txtä¸­ä½¿ç”¨è¯¥å‘½ä»¤ï¼Œä¸”è¦åŒ…å«çš„å¤´æ–‡ä»¶çš„å¯è§æ€§åªæœ‰è¯¥æ¨¡å—ï¼Œå…¶ä»–æ¨¡å—ä¸å¯è§ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•ï¼Œè¯·å‚è€ƒä¸‹èŠ‚å†…å®¹ã€‚ Tip file(GLOB HEADER ${CMAKE_SOURCE_DIR}/include/*.h) file(GLOB SOURCE ${CMAKE_SOURCE_DIR}/src/*.cpp) å¦‚æœincludeç›®å½•å’Œsrcç›®å½•ä¸­æœ‰å¤šä¸ªå¤´æ–‡ä»¶å’Œæºæ–‡ä»¶ï¼Œä½¿ç”¨å¦‚ä¸Šå‘½ä»¤å¯ä»¥å°†æ‰€æœ‰å¤´æ–‡ä»¶é›†åˆåˆ°HEADERå’ŒSOURCEè‡ªå®šä¹‰å®å®šä¹‰ä¸­ï¼Œä½¿ç”¨æ—¶çš„å‘½ä»¤ä¸º${HEADER}å’Œ${SOURCE}ã€‚ Tip add_executable( ${PROJECT_NAME} ${HEADER} ${SOURCE} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) è¿™å°†ç»“åˆincludeç›®å½•ä¸‹çš„æ–‡ä»¶å’Œsrcç›®å½•ä¸‹çš„æ–‡ä»¶ä»¥åŠhello_world.cppç”Ÿæˆåä¸ºhello-worldçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:5","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"å…­ã€æ„å»ºåŠç¼–è¯‘ mkdir build cd build cmake .. æ„å»ºè¿‡ç¨‹: -- The CXX compiler identification is GNU 9.4.0 -- Check for working CXX compiler: /usr/bin/c++ -- Check for working CXX compiler: /usr/bin/c++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/02/build æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶å¹¶è¾“å‡º: make Scanning dependencies of target hello-world [ 33%] Building CXX object CMakeFiles/hello-world.dir/src/message.cpp.o [ 66%] Building CXX object CMakeFiles/hello-world.dir/hello_world.cpp.o [100%] Linking CXX executable hello-world [100%] Built target hello-world ä¸Šä¸€ç¯‡æˆ‘ä»¬æ²¡æœ‰è®²å°†æ‰§è¡Œcmakeå‘½ä»¤åç”Ÿæˆçš„MakeFileæ–‡ä»¶ï¼Œå…¶å¦‚ä½•æ„å»ºå‡ºå¯æ‰§è¡Œæ–‡ä»¶çš„å…·ä½“æ“ä½œï¼Œåªæ˜¯ç®€å•çš„è¯´MakeFileéœ€è¦makeå‘½ä»¤æ‰§è¡Œã€‚ åœ¨æˆ‘ä»¬æ‰§è¡Œå®Œcmake ..åï¼Œå°†ç”ŸæˆMakeFileæ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œmakeåä¾¿å¯ä»¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚ è¿™é‡Œæˆ‘ä»¬è¿›è¡Œè¡¥å……è¯´æ˜ï¼šå¦‚æœæˆ‘ä»¬åœ¨GNU/Linuxä¸Šï¼Œæ‰§è¡ŒCMake ..åä¼šç”ŸæˆMakeFileæ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œmakeå‘½ä»¤å³å¯ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼›åœ¨Windowsä¸Šï¼Œæ‰§è¡Œcmake ..åä¼šç”Ÿæˆslnæ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨VSè¿›è¡Œæ‰“å¼€ï¼Œç„¶åå¯¹å…¶è¿›è¡Œç”Ÿæˆæ“ä½œã€‚Windowsç”Ÿæˆslnæ–‡ä»¶åçš„å…·ä½“æ“ä½œè¿‡ç¨‹è¯·å‚è€ƒæœ€åä¸€äº›è¡¥å……å†…å®¹ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¸åˆ†å¹³å°ç›´æ¥æ„å»ºå‡ºå¯æ‰§è¡Œæ–‡ä»¶: cmake --build . ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:6","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"ä¸ƒã€é™æ€åº“å’ŒåŠ¨æ€åº“ç®€ä»‹ é¦–å…ˆï¼Œå¦‚æœå¯¹ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸçš„ä¸æ¸…æ¥šï¼Œè¯·å…ˆç§»æ­¥è¿™é‡Œè¿›è¡Œå­¦ä¹ ã€‚ 7.1 é™æ€åº“ åœ¨é“¾æ¥é˜¶æ®µï¼Œä¼šå°†æ±‡ç¼–ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶.oä¸å¼•ç”¨åˆ°çš„åº“ä¸€èµ·é“¾æ¥æ‰“åŒ…åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚è¿™ä¸ªé“¾æ¥æ–¹å¼ä¸ºé™æ€é“¾æ¥ï¼Œæ‰€éœ€è¦çš„.oï¼ˆunixç³»ç»Ÿï¼‰ç§°ä¸ºé™æ€åº“ã€‚ é™æ€åº“å¯¹å‡½æ•°åº“çš„é“¾æ¥æ˜¯æ”¾åœ¨ç¼–è¯‘æ—¶æœŸå®Œæˆçš„ã€‚ ç¨‹åºåœ¨è¿è¡Œæ—¶ä¸å‡½æ•°åº“å†æ— ç“œè‘›ï¼Œç§»æ¤æ–¹ä¾¿ã€‚ æµªè´¹ç©ºé—´å’Œèµ„æºï¼Œå› ä¸ºæ‰€æœ‰ç›¸å…³çš„ç›®æ ‡æ–‡ä»¶ä¸ç‰µæ¶‰åˆ°çš„å‡½æ•°åº“è¢«é“¾æ¥æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚ é™æ€åº“å¯¹ç¨‹åºçš„æ›´æ–°ã€éƒ¨ç½²å’Œå‘å¸ƒä¼šå¸¦æ¥éº»çƒ¦ã€‚å¦‚æœé™æ€åº“libxxx.oæ›´æ–°äº†ï¼Œæ‰€æœ‰ä½¿ç”¨å®ƒçš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦é‡æ–°ç¼–è¯‘ã€å‘å¸ƒç»™ç”¨æˆ·ã€‚ 7.2 åŠ¨æ€åº“ åŠ¨æ€åº“åœ¨ç¨‹åºç¼–è¯‘æ—¶å¹¶ä¸ä¼šé“¾æ¥åˆ°ç›®æ ‡ä»£ç ä¸­ï¼Œè€Œæ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰è¢«è½½å…¥ã€‚ä¸åŒçš„åº”ç”¨ç¨‹åºå¦‚æœè°ƒç”¨ç›¸åŒçš„åº“ï¼Œé‚£ä¹ˆåœ¨å†…å­˜åªéœ€è¦æœ‰ä¸€ä»½è¯¥å…±äº«åº“çš„å®ä¾‹ï¼Œè§„é¿äº†ç©ºé—´æµªè´¹ã€‚ åŠ¨æ€åº“åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰è¢«è½½å…¥ï¼Œä¹Ÿè§£å†³äº†é™æ€åº“å¯¹ç¨‹åºçš„æ›´æ–°ã€éƒ¨ç½²å’Œå‘å¸ƒå¸¦æ¥çš„é—®é¢˜ï¼Œç”¨æˆ·åªéœ€è¦æ›´æ–°åŠ¨æ€åº“å³å¯ï¼Œå¢é‡æ›´æ–°ã€‚ Windowsä¸Linuxæ‰§è¡Œæ–‡ä»¶æ ¼å¼ä¸åŒï¼Œåœ¨åˆ›å»ºåŠ¨æ€åº“çš„æ—¶å€™æœ‰ä¸€äº›å·®å¼‚ï¼š åœ¨Windowsç³»ç»Ÿä¸‹çš„æ‰§è¡Œæ–‡ä»¶æ ¼å¼æ˜¯PEæ ¼å¼ï¼ŒåŠ¨æ€åº“éœ€è¦ä¸€ä¸ªDllMainå‡½æ•°åšåˆå§‹åŒ–çš„å…¥å£ï¼Œé€šå¸¸åœ¨å¯¼å‡ºå‡½æ•°çš„å£°æ˜æ—¶éœ€è¦æœ‰_declspec(dllexport)å…³é”®å­—ã€‚ Linuxä¸‹gccç¼–è¯‘çš„æ‰§è¡Œæ–‡ä»¶é»˜è®¤æ˜¯ELFæ ¼å¼ï¼Œä¸éœ€è¦åˆå§‹åŒ–å…¥å£ï¼Œäº¦ä¸éœ€è¦å‡½æ•°åšç‰¹åˆ«çš„å£°æ˜ï¼Œç¼–å†™æ¯”è¾ƒæ–¹ä¾¿ ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:7","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"å…«ã€æ„å»ºå’Œé“¾æ¥é™æ€åº“ 8.1 é¡¹ç›®ç»“æ„ . â”œâ”€â”€ message-module â”‚ â”œâ”€â”€ include â”‚ â”‚ â””â”€â”€ message.h â”‚ â”œâ”€â”€ src â”‚ â”‚ â””â”€â”€ message.cpp â”‚ â””â”€â”€ CMakeLists.txt â”œâ”€â”€ hello_world.cpp â””â”€â”€ CMakeLists.txt åœ¨å®é™…çš„é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ç»“æ„å¾€å¾€ä¼šç”±å¾ˆå¤šä¸ªæ¨¡å—ç»„æˆï¼Œæ¯ä¸ªæ¨¡å—é€šè¿‡ä¸€ä¸ªå•ç‹¬çš„CMakeLists.txtå»æ§åˆ¶ï¼Œæœ€ååœ¨æ ¹ç›®å½•ä¸‹çš„CMakeLists.txtä¸­å°†å„ä¸ªæ¨¡å—ç»„åˆä½¿ç”¨ã€‚ æœ¬é¡¹ç›®ä¸­ä¸ºäº†ç®€åŒ–å­¦ä¹ ï¼Œåªæ„å»ºäº†ä¸€ä¸ªmessage-moduleæ¨¡å—ï¼Œæ„å»ºå¤šä¸ªæ¨¡å—çš„æ–¹å¼åŒç†ã€‚å…¶ä¸­é¡¹ç›®ä¸­çš„æ‰€æœ‰CPPæºæ–‡ä»¶ä¸ç¬¬ä¸€èŠ‚å†…å®¹ç›¸åŒï¼Œè¿™é‡Œå°±ä¸å±•å¼€æè¿°äº†ã€‚ æºç åœ°å€:https://github.com/jianye0428/CMake_Learning_Notes/tree/main/Note_2/message_static_lib 8.2 message-moduleç›®å½•ä¸‹çš„CMakeLists include_directories( ${CMAKE_CURRENT_SOURCE_DIR}/include ) file(GLOB HEADER ${CMAKE_CURRENT_SOURCE_DIR}/include/*.h) file(GLOB SOURCE ${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp) add_library( test_message STATIC ${HEADER} ${SOURCE} ) ä»£ç é‡Šä¹‰: Tip add_library( test_message STATIC ${HEADER} ${SOURCE} ) add_libraryç”Ÿæˆå¿…è¦çš„æ„å»ºæŒ‡ä»¤ï¼Œå°†æŒ‡å®šçš„æºç ç¼–è¯‘åˆ°åº“ä¸­ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡åã€‚æ•´ä¸ªé¡¹ç›®ä¸­ï¼Œå¯ä½¿ç”¨ç›¸åŒçš„åç§°æ¥å¼•ç”¨åº“ã€‚ç”Ÿæˆçš„åº“çš„å®é™…åç§°å°†ç”±CMakeé€šè¿‡åœ¨å‰é¢æ·»åŠ å‰ç¼€libå’Œé€‚å½“çš„æ‰©å±•åä½œä¸ºåç¼€æ¥å½¢æˆã€‚ç”Ÿæˆåº“æ˜¯æ ¹æ®ç¬¬äºŒä¸ªå‚æ•°(STATICæˆ–SHARED)å’Œæ“ä½œç³»ç»Ÿç¡®å®šçš„ï¼Œæœ¬é¡¹ç›®æ˜¯å°†ç›®æ ‡æ–‡ä»¶ç”Ÿæˆé™æ€åº“ã€‚ 8.3 æ ¹ç›®å½•ä¸‹çš„CMakeLists cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello-world LANGUAGES CXX) # è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶åˆ°binæ–‡ä»¶å¤¹ä¸‹ set(EXECUTE_FILE ${CMAKE_BINARY_DIR}/bin) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${EXECUTE_FILE}) # è®¾ç½®é™æ€åº“åˆ°libæ–‡ä»¶å¤¹ä¸‹ set(LIB_FILE ${CMAKE_BINARY_DIR}/lib) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${LIB_FILE}) include_directories( ${CMAKE_SOURCE_DIR}/message-module/include ) add_subdirectory( ${CMAKE_SOURCE_DIR}/message-module ) add_executable( ${PROJECT_NAME} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) target_link_libraries( ${PROJECT_NAME} test_message ) ä»£ç é‡Šä¹‰: Tip # è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶åˆ°binæ–‡ä»¶å¤¹ä¸‹ set(EXECUTE_FILE ${CMAKE_BINARY_DIR}/bin) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${EXECUTE_FILE}) # è®¾ç½®é™æ€åº“åˆ°libæ–‡ä»¶å¤¹ä¸‹ set(LIB_FILE ${CMAKE_BINARY_DIR}/lib) set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${LIB_FILE}) åœ¨æ„å»ºé¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬ä¸ºäº†ä½¿å¾—é¡¹ç›®ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œä½¿å¾—ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ã€é™æ€åº“ä»¥åŠåŠ¨æ€åº“ç­‰æ–‡ä»¶èƒ½å¤Ÿå­˜æ”¾åœ¨åˆé€‚çš„ä½ç½®ã€‚è¿™æ ·çš„æ„å»ºæ–¹å¼æœ‰åŠ©äºæˆ‘ä»¬åœ¨é¡¹ç›®é‡æ„ã€é¡¹ç›®ä¼˜åŒ–ã€debugçš„æ—¶å€™é€»è¾‘æ›´åŠ æ¸…æ™°ã€‚ Tip include_directories( ${CMAKE_SOURCE_DIR}/message-module/include ) è¿™ä¸ªå‘½ä»¤åŒç¬¬ä¸€èŠ‚å†…å®¹ï¼Œå› ä¸ºhello_world.cppè¦ä½¿ç”¨message-moduleæ¨¡å—çš„APIï¼Œä¸”ä¸è¯¥CMakeLists.txtåœ¨ç›¸åŒå±‚çº§çš„ç›®å½•ï¼Œæ‰€ä»¥éœ€è¦å°†message-moduleæ¨¡å—çš„APIåŒ…å«è¿›å»ã€‚ å¦‚æœhello_world.cppä¸­ä½¿ç”¨åˆ°äº†å¤šä¸ªæ¨¡å—ï¼Œåˆ™æ­¤å¤„å¯ä»¥åŒ…å«å¤šä¸ªæ¨¡å—çš„APIï¼š include_directories( ${CMAKE_SOURCE_DIR}/message-module/include ${CMAKE_SOURCE_DIR}/xxx-module/include ) Tip add_subdirectory( ${CMAKE_SOURCE_DIR}/message-module ) å°†æˆ‘ä»¬çš„message-moduleæ·»åŠ è¿›æ¥è¿›è¡Œç¼–è¯‘ï¼Œè¿™ä¸ªå‡½æ•°å‘½ä»¤å°†å¯»æ‰¾message-moduleç›®å½•ä¸‹çš„CMakeLists.txtï¼Œå¦‚æœè¯¥ç›®å½•ä¸‹æ²¡æœ‰CMakeLists.txtå°†æŠ¥é”™ã€‚ ç”±äºåœ¨æœ¬é¡¹ç›®ä¸­ï¼Œhello_world.cppè¦ä½¿ç”¨message-moduleæ¨¡å—ä¸­ç¼–è¯‘ç”Ÿæˆçš„é™æ€åº“ï¼Œæ‰€ä»¥add_subdirectoryå‘½ä»¤å°†message-moduleæ·»åŠ åˆ°é¡¹ç›®ä¸­, add_subdirectoryçš„é¡ºåºå¿…é¡»è¦å…ˆäºadd_executableå‘½ä»¤ã€‚ Tip add_executable( ${PROJECT_NAME} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) target_link_libraries( ${PROJECT_NAME} test_message ) add_executableå‘½ä»¤å°†hello_world.cppç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶åå­—ä¸ºé¡¹ç›®åç§°hello-worldï¼Œè¯¥å¯æ‰§è¡Œæ–‡ä»¶ä½¿ç”¨target_link_librarieså‘½ä»¤å°†message-moduleæ¨¡å—ä¸‹ç¼–è¯‘ç”Ÿæˆçš„é™æ€åº“test_messageé“¾æ¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚ æ³¨æ„ï¼šåœ¨å­æ¨¡å—message-moduleä¸­ç¼–è¯‘ç”Ÿæˆçš„test_messageæ˜¯å…¨å±€å¯è§çš„ï¼Œå³ä»»ä½•æ¨¡å—æˆ–è€…æ ¹ç›®å½•ä¸‹çš„CMakeLists.txtéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨test_messageè¿›è¡Œè°ƒç”¨ã€‚ 8.4 æ„å»ºä»¥åŠç¼–è¯‘ mkdir build cd build cmake .. æ„å»ºåŠç¼–è¯‘è¿‡ç¨‹: -- The CXX compiler identification is GNU 9.4.0 -- Check for working CXX compiler: /usr/bin/c++ -- Check for working CXX compiler: /usr/bin/c++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/03/build # cmake --build . make Scanning dependencies of target test_message [ 25%] Building CXX object message-module/CMakeFiles/test_message.dir/src/message.cpp.o [ 50%] Linking CXX static library ../lib/libtest_message.a [ 50%] Built target test_message Scanning dependencies of target hello-world [ 75%] Building CXX object CMakeFiles/hello-world.dir/hello_world.cpp.o [100%] Linking CXX executable bin/hello-world [100%] Built target hello-world å¯ä»¥é€šè¿‡ç¼–è¯‘æ—¥å¿—çœ‹åˆ°ï¼Œé¦–å…ˆç¼–è¯‘äº†message-moduleæ¨¡å—ï¼Œå¹¶å°†ç¼–è¯‘ç”Ÿæˆçš„libtest_message.aå­˜æ¡£åˆ°äº†../lib/ï¼Œå³buildæ–‡ä»¶å¤¹ä¸­çš„libç›®å½•ä¸­ã€‚ç„¶åé“¾æ¥hello-worldæ‰€éœ€è¦çš„ä¾èµ–é¡¹ï¼Œæ­¤æ—¶ä¾¿å°†test-messageé“¾æ¥åˆ°äº†hello-worldä¸­ï¼Œæœ€ç»ˆç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶hello-worldï¼Œå¹¶å°†å…¶å­˜æ”¾åˆ°binç›®å½•ä¸­ï¼Œå³buildæ–‡ä»¶å¤¹ä¸‹çš„binç›®å½•ã€‚ ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:8","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"ä¹ã€åªé“¾æ¥é“¾æ¥ä¸‰æ–¹åº“ï¼ˆé™æ€ï¼‰ æˆ‘ä»¬åœ¨æ„å»ºå®é™…é¡¹ç›®è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªé¡¹ç›®å¾€å¾€éœ€è¦é“¾æ¥è®¸å¤šçš„ä¸‰æ–¹åº“ï¼ŒæŠ‘æˆ–æ˜¯æˆ‘ä»¬å°†è‡ªå·±çš„ç®—æ³•ä»¥é™æ€åº“çš„å½¢å¼å‘å¸ƒï¼Œé€šå¸¸éœ€è¦ä¸ºæˆ‘ä»¬çš„é¡¹ç›®é“¾æ¥ä¸‰æ–¹åº“ã€‚æœ¬èŠ‚è®²å…¶ä¸­çš„ä¸€ç§ï¼Œåç»­æ¶‰åŠåˆ°ä¸‰æ–¹åº“çš„é“¾æ¥å°†è®²è¿°æ‰€æœ‰é“¾æ¥çš„æ–¹å¼ã€‚å…³äºthird-partyæ¨¡å—ä¸‹includeæ–‡ä»¶å¤¹ä¸‹çš„message.hå¤´æ–‡ä»¶ä¸å‰é¢ç›¸åŒï¼Œlibæ–‡ä»¶å¤¹ä¸‹çš„libtest_message.aæ˜¯ç¬¬ä¸‰èŠ‚ç¼–è¯‘ç”Ÿæˆçš„é™æ€åº“ã€‚ 9.1 é¡¹ç›®ç»“æ„ . â”œâ”€â”€ third-party â”‚ â”œâ”€â”€ include â”‚ â”‚ â””â”€â”€ message.h â”‚ â””â”€â”€ lib â”‚ â””â”€â”€ libtest_message.a â”œâ”€â”€ hello_world.cpp â””â”€â”€ CMakeLists.txt ä¸€èˆ¬ï¼Œæˆ‘ä»¬å°†ä¸‰æ–¹åº“æ”¾åˆ°é¡¹ç›®ä¸­ä¸€ä¸ªthird-partyçš„æ–‡ä»¶å¤¹ä¸‹ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥éšæ„å‘½åã€‚ä¸‰æ–¹åº“third-partyä¸­åŒ…å«includeå’Œlibåˆ†åˆ«å­˜æ”¾ä¸‰æ–¹åº“çš„APIå’Œé™æ€åº“ã€‚ æºç åœ°å€:https://github.com/jianye0428/CMake_Learning_Notes/tree/main/Note_2/message_static_lib_third_party 9.2 CMakeLists.txt cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello-world LANGUAGES CXX) # è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶åˆ°binæ–‡ä»¶å¤¹ä¸‹ set(EXECUTE_FILE ${CMAKE_BINARY_DIR}/bin) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${EXECUTE_FILE}) set(TEST_MESSAGE ${CMAKE_SOURCE_DIR}/third-party/lib/libtest_message.a) include_directories( ${CMAKE_SOURCE_DIR}/third-party/include ) add_executable( ${PROJECT_NAME} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) target_link_libraries( ${PROJECT_NAME} ${TEST_MESSAGE} ) ä»£ç é‡Šä¹‰: Tip set(TEST_MESSAGE ${CMAKE_SOURCE_DIR}/third-party/lib/libtest_message.a) å°†ä¸‰æ–¹åº“ä¸­çš„é™æ€åº“å®šä¹‰ä¸ºTEST_MESSAGEï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨${TEST_MESSAGE}è¿›è¡Œè°ƒç”¨ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨target_link_librarieså‘½ä»¤ä¸­ä½¿ç”¨${CMAKE_SOURCE_DIR}/third-party/lib/libtest_message.aè¿›è¡Œé“¾æ¥ï¼Œä½†æ˜¯è¿™ä¹ˆåšæ˜¯ä¸æ¨èçš„ã€‚å¦‚æœå¤šä¸ªæ¨¡å—éƒ½ä½¿ç”¨åˆ°äº†è¯¥åº“ï¼Œé‚£ä¹ˆå®šä¹‰ä¸ºå®çš„æ–¹å¼æ›´åŠ æ–¹ä¾¿å’Œæ¸…æ™°ã€‚ ä»Šåï¼Œæˆ‘ä»¬éƒ½å°†å®šä¹‰å‡ºæ¥çš„å®ç»Ÿä¸€é‡‡ç”¨äº†å¤§å†™ï¼Œæ„å’ŒCMakeè‡ªèº«å˜é‡å‘½åå¯¹å…¶ã€‚ 9.3 æ„å»ºåŠç¼–è¯‘ mkdir build cd build cmake .. æ„å»ºåŠç¼–è¯‘è¿‡ç¨‹: -- The CXX compiler identification is GNU 9.4.0 -- Check for working CXX compiler: /usr/bin/c++ -- Check for working CXX compiler: /usr/bin/c++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/04/build cmake --build . Scanning dependencies of target hello-world [ 50%] Building CXX object CMakeFiles/hello-world.dir/hello_world.cpp.o [100%] Linking CXX executable bin/hello-world [100%] Built target hello-world ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:9","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"åã€ç¼–è¯‘å’Œè¿æ¥åŠ¨æ€åº“ åŠ¨æ€åº“çš„ç¼–å†™éœ€è¦åŒºåˆ†å¹³å°ï¼Œåœ¨GNU/Linuxå¹³å°ä¸Šï¼ŒåŠ¨æ€åº“çš„ç¼–å†™å’Œè°ƒç”¨ä¸é™æ€åº“æ²¡æœ‰å·®åˆ«ï¼Œä½†æ˜¯åœ¨Windowså¹³å°ä¸ŠåŠ¨æ€åº“çš„ç¼–å†™å’Œè°ƒç”¨éœ€è¦åšä¸€å®šçš„ä¿®æ”¹ã€‚ 10.1 GNU/Linuxå¹³å°ä¸ŠåŠ¨æ€åº“çš„ç¼–è¯‘å’Œé“¾æ¥ åœ¨GNU/Linuxä¸Šç”ŸæˆåŠ¨æ€åº“çš„æ–¹æ³•å’Œé™æ€åº“ç”Ÿæˆçš„æ–¹æ³•ç±»ä¼¼ï¼Œå…¶ç›®å½•ç»“æ„ç­‰éƒ½ä¸é™æ€åº“ç›¸åŒï¼Œåªæœ‰åœ¨ä½¿ç”¨add_libraryå‘½ä»¤æ—¶ï¼Œå‚æ•°STATICæ”¹ä¸ºSHAREå³å¯,ç›¸å…³é¡¹ç›®ç»“æ„å’ŒCMakeLists.txtå¦‚ä¸‹ã€‚ . â”œâ”€â”€ message-module â”‚ â”œâ”€â”€ include â”‚ â”‚ â””â”€â”€ message.h â”‚ â”œâ”€â”€ src â”‚ â”‚ â””â”€â”€ message.cpp â”‚ â””â”€â”€ CMakeLists.txt â”œâ”€â”€ hello_world.cpp â””â”€â”€ CMakeLists.txt æºç åœ°å€: https://github.com/jianye0428/CMake_Learning_Notes/tree/main/Note_2/message_dynamic_lib é…ç½®åŠ¨æ€åº“çš„CMakeLists.txt: cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello-world LANGUAGES CXX) # è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶åˆ°binæ–‡ä»¶å¤¹ä¸‹ set(EXECUTE_FILE ${CMAKE_BINARY_DIR}/bin) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${EXECUTE_FILE}) # è®¾ç½®åŠ¨æ€åº“åˆ°libæ–‡ä»¶å¤¹ä¸‹ set(LIB_FILE ${CMAKE_BINARY_DIR}/lib) set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${LIB_FILE}) include_directories( ${CMAKE_SOURCE_DIR}/message-module/include ) add_subdirectory( ${CMAKE_SOURCE_DIR}/message-module ) add_executable( ${PROJECT_NAME} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) target_link_libraries( ${PROJECT_NAME} test_message ) è¿™é‡Œæˆ‘ä»¬è®¾ç½®åŠ¨æ€åº“å­˜æ”¾çš„è·¯å¾„çš„å®ä¸ºCMAKE_LIBRARY_OUTPUT_DIRECTORYã€‚ æºç åœ°å€ï¼š 10.2 GNU/Linuxåªé“¾æ¥ä¸‰æ–¹åº“ï¼ˆåŠ¨æ€åº“ï¼‰ åœ¨GNU/Linuxä¸Šé“¾æ¥åŠ¨æ€åº“çš„æ–¹æ³•å’Œé™æ€åº“ç”Ÿæˆçš„æ–¹æ³•ç±»ä¼¼ï¼Œå…¶ç›®å½•ç»“æ„ç­‰éƒ½ä¸é™æ€åº“ç›¸åŒï¼Œåªæœ‰åœ¨ä½¿ç”¨add_libraryå‘½ä»¤æ—¶ï¼Œå‚æ•°STATICæ”¹ä¸ºSHAREå³å¯,ç›¸å…³é¡¹ç›®ç»“æ„å’ŒCMakeLists.txtå¦‚ä¸‹ã€‚ ç›®å½•ç»“æ„: . â”œâ”€â”€ third-party â”‚ â”œâ”€â”€ include â”‚ â”‚ â””â”€â”€ message.h â”‚ â””â”€â”€ lib â”‚ â””â”€â”€ libtest_message.so â”œâ”€â”€ hello_world.cpp â””â”€â”€ CMakeLists.txt æºç åœ°å€: https://github.com/jianye0428/CMake_Learning_Notes/tree/main/Note_2/message_dynamic_lib_third_party CMakeLists.txtæ–‡ä»¶: cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello-world LANGUAGES CXX) # è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶åˆ°binæ–‡ä»¶å¤¹ä¸‹ set(EXECUTE_FILE ${CMAKE_BINARY_DIR}/bin) set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${EXECUTE_FILE}) set(TEST_MESSAGE ${CMAKE_SOURCE_DIR}/third-party/lib/libtest_message.so) include_directories( ${CMAKE_SOURCE_DIR}/third-party/include ) add_executable( ${PROJECT_NAME} ${CMAKE_SOURCE_DIR}/hello_world.cpp ) target_link_libraries( ${PROJECT_NAME} ${TEST_MESSAGE} ) 10.3 Windowså¹³å°ä¸ŠåŠ¨æ€åº“çš„ç¼–è¯‘å’Œé“¾æ¥ æ³¨æ„ï¼šé€šè¿‡å®è·µå‘ç°ï¼ŒWindowsä¸­CMAKE_LIBRARY_OUTPUT_DIRECTORYæ²¡æœ‰ä½œç”¨ã€‚åœ¨Windowsä¸­ç”Ÿæˆçš„åŠ¨æ€åº“å°†ä¼šè‡ªåŠ¨ç”Ÿæˆåˆ°å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚ å‰é¢æˆ‘ä»¬è¯´Windowså¹³å°ä¸­ç”ŸæˆåŠ¨æ€åº“çš„æºç å’Œé™æ€åº“æ˜¯ä¸åŒçš„ï¼Œåœ¨Windowså¹³å°ä¸­ï¼Œåœ¨å¯¼å‡ºåŠ¨æ€åº“æ—¶é™¤äº†ä¼šç”Ÿæˆ.dllåŠ¨æ€åº“ä¹‹å¤–ï¼Œè¿˜ä¼šç”Ÿæˆä¸€ä¸ª.libæ–‡ä»¶ã€‚æ³¨æ„ï¼Œè¿™ä¸ª.libæ–‡ä»¶å’Œé™æ€åº“çš„.libæ–‡ä»¶æ˜¯ä¸åŒçš„ï¼Œå®ƒé‡Œé¢å¹¶ä¸ä¿å­˜ä»£ç ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œæ˜¯æ‰€æœ‰éœ€è¦å¯¼å‡ºç¬¦å·çš„ç¬¦å·è¡¨ã€‚å› æ­¤è¿™ä¸ª.libæ–‡ä»¶å’Œç¼–è¯‘ç”Ÿæˆçš„é™æ€åº“.libç›¸æ¯”è¾ƒè€Œè¨€ä¼šå°çš„å¤šã€‚ ç¬¦å·è¡¨æ˜¯éœ€è¦æˆ‘ä»¬åœ¨ç¼–å†™æºç æ—¶è¿›è¡ŒæŒ‡å®šçš„ï¼Œå¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªç¬¦å·å¯¼å‡ºï¼ˆç¬¦å·å¯ä»¥æŒ‡ç±»ã€å‡½æ•°ç­‰å„ç§ç±»å‹ï¼‰,éœ€è¦åœ¨å…¶å‰é¢åŠ ä¸Š__declspec(dllexport)æ ‡å¿—ï¼Œè¿™æ ·è¿™ä¸ªç¬¦å·çš„ç›¸å…³ä¿¡æ¯å°±ä¼šåœ¨å¯¼å‡ºçš„.libä¸­çš„ç¬¦å·è¡¨ä¸­äº†ã€‚ å¦‚æœåœ¨æºç ä¸­æ²¡æœ‰ä»»ä½•çš„__declspec(dllexport),ä¾ç„¶å¯ä»¥æˆåŠŸçš„ç¼–è¯‘å‡ºåŠ¨æ€åº“ï¼Œä½†æ˜¯å¹¶ä¸ä¼šç”Ÿæˆä¿å­˜ç¬¦å·è¡¨çš„.libæ–‡ä»¶ã€‚ class __declspec(dllexport) Message { public: Message() {} void Print(const std::string \u0026message); }; é™¤äº†å¯¼å‡ºç¬¦å·æ ‡è¯†ç¬¦__declspec(dllexport)ä»¥å¤–ï¼Œä½œä¸ºç”¨æˆ·ä½¿ç”¨åŠ¨æ€åº“çš„æ—¶å€™ï¼Œå¯¹åº”çš„å¤´æ–‡ä»¶çš„ç¬¦å·è¿˜éœ€è¦__declspec(dllimport)æ ‡è¯†ç¬¦æ¥è¡¨ç¤ºè¿™ä¸ªç¬¦å·æ˜¯ä»åŠ¨æ€åº“å¯¼å…¥çš„ã€‚ class __declspec(dllimport) Message { public: Message() {} void Print(const std::string \u0026message); }; ä¸€èˆ¬ï¼Œä¸€ä¸ªåº“æ–‡ä»¶æˆ‘ä»¬å¹¶ä¸æƒ³å¯¹å¯¼å…¥å’Œå¯¼å‡ºåˆ†åˆ«å†™ä¸¤ä¸ªå‡ ä¹åŒæ ·çš„å¤´æ–‡ä»¶ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å®å®šä¹‰æ¥ä»£æ›¿ç›´æ¥ä½¿ç”¨__declspec(dllexport)å’Œ__declspec(dllimport)å…³é”®å­—ã€‚ #ifndef MESSAGE_HEADER_H_ #define MESSAGE_HEADER_H_ #ifdef SHARED_LIB_EXPORT #define SHARED_LIB_EXPORT __declspec(dllexport) #else #define SHARED_LIB_EXPORT __declspec(dllimport) #endif class SHARED_LIB_EXPORT Message { public: Message() {} void Print(const std::string \u0026message); }; #endif // ! MESSAGE_HEADER_H_ è¿™æ ·æˆ‘ä»¬åªéœ€è¦åœ¨ç¼–è¯‘ï¼ˆå¯¼å‡ºï¼‰è¿™ä¸ªåº“çš„æ—¶å€™ï¼Œç»™ç¼–è¯‘å™¨æ·»åŠ SHARED_LIB_EXPORTå®ã€‚è€Œåœ¨ä½¿ç”¨è¯¥åº“çš„æ—¶å€™ä»€ä¹ˆéƒ½ä¸å®šä¹‰å³å¯ã€‚ æˆ‘ä»¬é€šå¸¸ç¼–å†™ä¸€ä¸ªå¤´æ–‡ä»¶æ¥ä¸“é—¨ç®¡ç†SHARED_LIB_EXPORTå®å®šä¹‰ã€‚ä¸ºäº†ä½¿å¾—æˆ‘ä»¬çš„ä»£ç åœ¨Linuxä¸­å¹³å°ä»¥åŠé™æ€åº“çš„æƒ…å†µï¼Œæˆ‘ä»¬çš„å¤´æ–‡ä»¶ç¼–å†™å¦‚ä¸‹ï¼š #ifndef EXPORT_LIB_HEADER_H_ #define EXPORT_LIB_HEADER_H_ #ifdef SHARED_LIB_BUILD #ifdef _WIN32 #ifdef SHARED_LIB_EXPORT #define SHARED_LIB_API __declspec(dllexport) #else #define SHARED_LIB_API __declspec(dllimport) #endif // SHARED_LIB_EXPORT #else #define SHARED_LIB_API #endif // _WIN32 #else #define SHARED_LIB_API #endif // SHARED_LIB_BUILD #endif // ! EXPORT_LIB_HEADER_H_ æˆ‘ä»¬é™¤äº†ä½¿ç”¨SHARED_LIB_APIå®å®šä¹‰æ¥åˆ¤æ–­æ˜¯å¦å¯¼å‡ºä¸ºåŠ¨æ€åº“ä»¥å¤–ï¼Œè¿˜ä½¿ç”¨äº†ç¼–è¯‘å™¨è‡ªå¸¦çš„_WIN32å®æ¥åˆ¤æ–­æ˜¯å®åœ¨windowså¹³å°ä¸Šä»¥åŠä½¿ç”¨ã€‚SHARED_LIB_BUILDæ¥åˆ¤æ–­æ˜¯å¦æ­£åœ¨ç¼–è¯‘åŠ¨æ€åº“ã€‚ æœ‰äº†è¿™ä¸ªå¤´æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å¯¼å‡ºç¬¦å·è¡¨çš„å¤´æ–‡ä»¶ä¸­åŒ…å«è¯¥å¤´æ–‡ä»¶ï¼Œå°±å¯ä»¥ä½¿ç”¨SHARED_LIB_APIå®å®šä¹‰äº†ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œä¸Šè¿°çš„å¤´æ–‡ä»¶å¯ä»¥é€šè¿‡CMakeæä¾›çš„GenerateExportHeaderå‘½ä»¤è‡ªåŠ¨ç”Ÿæˆã€‚å…³äºè¯¥å‘½ä»¤çš„ä½¿ç”¨åœ¨åç»­ä»‹ç»ä¸­ä¼šè¯¦ç»†çš„è¿›è¡Œæ¢ç´¢ã€‚ é¡¹ç›®ç»“æ„: . â”œâ”€â”€ message-module â”‚ â”œâ”€â”€ include â”‚ â”‚ â””â”€â”€ message.h â”‚ â”œâ”€â”€ src â”‚ â”‚ â””â”€â”€ message.cpp â”‚ â””â”€â”€ CMakeLists.txt â”œâ”€â”€ hello_world.cpp â””â”€â”€ CMak","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:10","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"åä¸€ã€è¡¥å…… åœ¨windowä¸Šä½¿ç”¨vsç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶å’Œæ‰§è¡Œinstallå‘½ä»¤ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬é¦–å…ˆæ–°å»ºä¸€ä¸ªbuildç›®å½•ï¼Œå¹¶è¿›å…¥è¯¥ç›®å½•ã€‚ mkdir build cd build ç„¶åä½¿ç”¨cmakeè¿›è¡Œæ„å»ºé¡¹ç›®ã€‚ cmake .. ç„¶ååœ¨buildç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°slnæ–‡ä»¶ï¼Œä½¿ç”¨vsæ‰“å¼€ã€‚ æ„å»ºæ‰€æœ‰: åœ¨vsä¸­çš„è§£å†³æ–¹æ¡ˆèµ„æºç®¡ç†å™¨ä¸­å³é”®ALL_BUILDï¼Œç„¶åç‚¹å‡»ç”Ÿæˆ ç¼–è¯‘ç”Ÿæˆhello-worldè¿›ç¨‹ï¼Œå³é”®hello-world,ç„¶åç‚¹å‡»ç”Ÿæˆã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨CMakeåœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ç”Ÿæˆäº†å¤šä¸ªè¿›ç¨‹ï¼Œæˆ‘ä»¬åœ¨æµ‹è¯•æŸä¸€ä¸ªè¿›ç¨‹æ—¶ï¼Œåœ¨å¯¹åº”çš„è¿›ç¨‹ä¸Šå³é”®è®¾ä¸ºå¯åŠ¨é¡¹ç›®å³å¯ã€‚ æ‰§è¡Œinstallå®‰è£…å‘½ä»¤: åœ¨INSTALLä¸Šå³é”®ï¼Œç„¶åç‚¹å‡»ç”Ÿæˆå³å¯ã€‚æ³¨æ„ï¼šåªæœ‰å½“æˆ‘ä»¬çš„CMakeä¸­æœ‰installå‘½ä»¤æ—¶ï¼ŒVSä¸­æ‰ä¼šå‡ºç°INTALLé€‰é¡¹ã€‚ ","date":"2024-01-12","objectID":"/posts/cmake_note_2/:0:11","tags":["CMake"],"title":"CMake ç¬”è®° | [2] å¤šç›®å½•å¤šæ–‡ä»¶çš„CMakeæ„å»ºæ–¹å¼","uri":"/posts/cmake_note_2/"},{"categories":["C++"],"content":"ä¸€ã€é¡¹ç›®ç»“æ„ .. â”œâ”€â”€ CMakeLists.txt â””â”€â”€ hello_world.cpp 0 directories, 2 files æœ¬é¡¹ç›®åªåŒ…å«äº†ä¸€ä¸ªæºæ–‡ä»¶hello_world.cppå’Œä¸€ä¸ªCMakeæ–‡ä»¶ã€‚ æºç åœ°å€: https://github.com/jianye0428/CMake_Learning_Notes/tree/main/Note_1/hello-world æ³¨æ„ æ³¨æ„: CMakeæ–‡ä»¶çš„åå­—åªèƒ½æ˜¯CMakeLists.txtï¼Œå½“ç„¶å¦‚æœä½¿ç”¨includeå‘½ä»¤ï¼ˆåç»­ä¼šè®²åˆ°ï¼‰ï¼Œå¯ä»¥ä»¥ä»»ä½•åå­—è¿›è¡Œå‘½åï¼Œåªè¦ä»¥.cmakeç»“å°¾å³å¯ã€‚ ","date":"2024-01-12","objectID":"/posts/cmake_note_1/:0:1","tags":["CMake"],"title":"CMake ç¬”è®° | [1] å•ä¸ªæºæ–‡ä»¶ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶","uri":"/posts/cmake_note_1/"},{"categories":["C++"],"content":"äºŒã€CPPæºæ–‡ä»¶ #include \u003ccstdlib\u003e #include \u003ciostream\u003e #include \u003cstring\u003e std::string SayHello(); int main() { std::cout \u003c\u003c SayHello() \u003c\u003c std::endl; return 0; } std::string SayHello() { return std::string(\"Hello, CMake World!\"); } ","date":"2024-01-12","objectID":"/posts/cmake_note_1/:0:2","tags":["CMake"],"title":"CMake ç¬”è®° | [1] å•ä¸ªæºæ–‡ä»¶ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶","uri":"/posts/cmake_note_1/"},{"categories":["C++"],"content":"ä¸‰ã€CMakeæ–‡ä»¶ cmake_minimum_required(VERSION 3.10 FATAL_ERROR) project(hello-world LANGUAGES CXX) add_executable( ${PROJECT_NAME} hello_world.cpp } cmake_minimum_required(VERSION 3.10 FATAL_ERROR) è®¾ç½®CMakeæ‰€éœ€çš„æœ€ä½ç‰ˆæœ¬çš„æœ€ä½ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨çš„CMakeç‰ˆæœ¬ä½äºè¯¥ç‰ˆæœ¬ï¼Œåˆ™ä¼šå‘å‡ºè‡´å‘½é”™è¯¯ã€‚ ä»Šåï¼Œç¬”è®°ä¸­CMakeçš„ç‰ˆæœ¬è¦æ±‚éƒ½ä¸º3.10ã€‚vscodeä¸­CMake Toolæ’ä»¶ä½¿ç”¨debugåŠŸèƒ½è¦æ±‚CMakeç‰ˆæœ¬ä¸ä½äº3.10ã€‚å¦‚æœä½¿ç”¨çš„ç³»ç»Ÿubuntu 16.04çš„è¯ï¼Œéœ€è¦å‡çº§CMakeç‰ˆæœ¬ï¼Œwindowsè¯·è‡ªè¡Œå®‰è£…é«˜äº3.10ç‰ˆæœ¬çš„CMakeã€‚ project(hello-world LANGUAGES CXX) å£°æ˜äº†é¡¹ç›®çš„åç§°å’Œæ”¯æŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸”è¯¥å‘½ä»¤å¿…é¡»ç”Ÿå‘½åœ¨cmake_minimum_requiredä¹‹åã€‚ä¸€æ—¦å£°æ˜äº†é¡¹ç›®çš„åç§°åï¼Œå¯ä»¥ä½¿ç”¨å®å®šä¹‰${PROJECT_NAME}è¿›è¡Œè°ƒç”¨ã€‚ åœ¨CMakeä¸­ï¼ŒC++æ˜¯é»˜è®¤çš„ç¼–ç¨‹è¯­è¨€ã€‚ä¸è¿‡åœ¨å®é™…ç¼–å†™ä»£ç è¿‡ç¨‹ä¸­ï¼Œä»å»ºè®®ä½¿ç”¨LANGUAGESé€‰é¡¹åœ¨projectå‘½ä»¤ä¸­æ˜¾ç¤ºåœ°å£°æ˜é¡¹ç›®çš„è¯­è¨€ã€‚ add_executable(${PROJECT_NAME} hello_world.cpp} CMakeåˆ›å»ºä¸€ä¸ªæ–°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶åå­—ä¸º${PROJECT_NAME}ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ä»»æ„çš„åå­—ï¼‰ã€‚è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æ˜¯é€šè¿‡ç¼–è¯‘å’Œé“¾æ¥æºæ–‡ä»¶hello_world.cppç”Ÿæˆçš„ã€‚ CMakeå°†ä¸ºç¼–è¯‘å™¨ä½¿ç”¨é»˜è®¤è®¾ç½®ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå·¥å…·ã€‚ ","date":"2024-01-12","objectID":"/posts/cmake_note_1/:0:3","tags":["CMake"],"title":"CMake ç¬”è®° | [1] å•ä¸ªæºæ–‡ä»¶ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶","uri":"/posts/cmake_note_1/"},{"categories":["C++"],"content":"å››ã€æ“ä½œ åœ¨å·¥ç¨‹æ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰§è¡Œå¦‚ä¸‹æ“ä½œ: mkdir build cd build cmake .. è¾“å‡ºç»“æœ: -- The CXX compiler identification is GNU 9.4.0 -- Check for working CXX compiler: /usr/bin/c++ -- Check for working CXX compiler: /usr/bin/c++ -- works -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Detecting CXX compile features -- Detecting CXX compile features - done -- Configuring done -- Generating done -- Build files have been written to: /home/jiangli/repo/tutorials/cmake-tutorial/chapter1/01/build CMakeçš„æ„å»ºæ–¹å¼æœ‰ä¸¤ç§: æºå†…æ„å»ºå’Œæºå¤–æ„å»ºã€‚æºå†…æ„å»ºå³åœ¨CMakeLists.txtåŒçº§ç›®å½•ä¸­è¿›è¡Œæ„å»ºï¼Œæ„å»ºå‡ºæ¥çš„CMakeæ–‡ä»¶å°†åœ¨è¯¥ç›®å½•ä¸­ï¼Œè¿™é€šå¸¸æ˜¯ä¸æ¨èçš„ï¼Œå› ä¸ºè¿™ä¼šæ··åˆæºä»£ç å’Œé¡¹ç›®çš„ç›®å½•æ ‘ã€‚æºå¤–æ„å»ºçš„æ„å»ºæ–¹å¼ï¼Œå°±æ˜¯ç¬”è®°çš„æ„å»ºæ–¹å¼ï¼Œå¾€åæˆ‘ä»¬éƒ½é‡‡ç”¨æºå¤–æ„å»ºçš„æ–¹å¼ã€‚ CMakeæ˜¯ä¸€ä¸ªæ„å»ºç³»ç»Ÿç”Ÿæˆå™¨ã€‚å°†æè¿°æ„å»ºç³»ç»Ÿï¼Œå¦‚Unix Makefileã€Ninjaã€slnç­‰åº”å½“å¦‚ä½•æ“ä½œæ‰èƒ½ç¼–è¯‘ä»£ç ã€‚ç„¶åï¼ŒCMakeä¸ºæ‰€é€‰çš„æ„å»ºç³»ç»Ÿç”Ÿæˆç›¸åº”çš„æŒ‡ä»¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨GNU/Linuxå’ŒmacOSç³»ç»Ÿä¸Šï¼ŒCMakeä½¿ç”¨Unix Makefileç”Ÿæˆå™¨ã€‚Windowsä¸Šï¼Œslnæ˜¯é»˜è®¤çš„ç”Ÿæˆå™¨ã€‚ GNU/Linuxä¸Šï¼ŒCMakeé»˜è®¤ç”Ÿæˆ Makefileæ¥æ„å»ºé¡¹ç›®: Makefile: makeå°†è¿è¡ŒæŒ‡ä»¤æ¥æ„å»ºé¡¹ç›®ã€‚ CMakefile: åŒ…å«ä¸´æ—¶æ–‡ä»¶çš„ç›®å½•ï¼ŒCMakeç”¨äºæ£€æµ‹æ“ä½œç³»ç»Ÿã€ç¼–è¯‘å™¨ç­‰ã€‚æ­¤å¤–ï¼Œæ ¹æ®æ‰€é€‰çš„ç”Ÿæˆå™¨ï¼Œå®ƒè¿˜åŒ…å«ç‰¹å®šçš„æ–‡ä»¶ã€‚ cmake_install.cmake: å¤„ç†å®‰è£…è§„åˆ™çš„CMakeè„šæœ¬ï¼Œåœ¨é¡¹ç›®å®‰è£…æ—¶ä½¿ç”¨ï¼ˆå‘½ä»¤ä¸ºæ‰§è¡Œä¸ºmakeåæ‰§è¡Œmake installï¼‰ã€‚ CMakeCache.txt: å¦‚æ–‡ä»¶åæ‰€ç¤ºï¼ŒCMakeç¼“å­˜ã€‚CMakeåœ¨é‡æ–°è¿è¡Œé…ç½®æ—¶ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶ã€‚ ","date":"2024-01-12","objectID":"/posts/cmake_note_1/:0:4","tags":["CMake"],"title":"CMake ç¬”è®° | [1] å•ä¸ªæºæ–‡ä»¶ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶","uri":"/posts/cmake_note_1/"},{"categories":null,"content":"Here Is Articles Pilot C++ C++åŸºç¡€ ğŸ’¡ C++åŸºç¡€(ä¸€) ğŸ’¡ C++åŸºç¡€(äºŒ) C++æ–°ç‰¹æ€§[11\\14\\17] Cmake CMakeç®€ä»‹ CMakeå¸¸ç”¨å‘½ä»¤ cmake_cookbook professional cmake C++ Concurrency In Action Effective Modern C++ Effective C++ part one part two Effective STL è½¯ä»¶å®‰è£… å„ç§ç¨‹åºå®‰è£…æ•™ç¨‹ Vimå®‰è£…æ•™ç¨‹ Zshå®‰è£…æ•™ç¨‹ Math æ›²çº¿æ‹Ÿåˆ GIT Gitå¸¸ç”¨å‘½ä»¤æŸ¥è¯¢ Gitæ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“ æ•°æ®ç»“æ„ä¸ç®—æ³• æ’åºç®—æ³• äºŒå‰æ ‘ èƒŒåŒ…é—®é¢˜ ","date":"2024-01-06","objectID":"/pilot/:0:0","tags":null,"title":"æ–‡ç« å¯¼èˆª","uri":"/pilot/"},{"categories":["AutonomousDriving"],"content":"ä¸€ã€ç®€ä»‹ Argoverseæ•°æ®é›†æ˜¯ç”±Argo AIã€å¡å†…åŸºæ¢…éš†å¤§å­¦ã€ä½æ²»äºšç†å·¥å­¦é™¢å‘å¸ƒçš„ç”¨äºæ”¯æŒè‡ªåŠ¨é©¾é©¶æ±½è½¦3D Trackingå’ŒMotion Forecastingç ”ç©¶çš„æ•°æ®é›†ã€‚ æ•°æ®é›†åŒ…æ‹¬: å¸¦æ ‡æ³¨çš„ä¼ æ„Ÿå™¨æ•°æ®é›†: å«1000ä¸ªå¤šæ¨¡æ€æ•°æ®åºåˆ—ï¼ŒåŒ…æ‹¬æ¥è‡ªä¸ƒä¸ªç¯è§†æ‘„åƒæœºå’Œä¸¤ä¸ªåŒç›®æ‘„åƒæœºçš„é«˜åˆ†è¾¨ç‡å›¾åƒï¼Œä»¥åŠæ¿€å…‰é›·è¾¾ç‚¹äº‘å’Œ6è‡ªç”±åº¦åœ°å›¾é…å‡†ä½å§¿ã€‚åºåˆ—åŒ…å«26ä¸ªç›®æ ‡ç±»åˆ«çš„ä¸‰ç»´é•¿æ–¹ä½“æ ‡æ³¨ï¼Œæ‰€æœ‰è¿™äº›æ ‡æ³¨éƒ½æ˜¯å……åˆ†é‡‡æ ·çš„ï¼Œä»¥æ”¯æŒè®­ç»ƒå’Œä¸‰ç»´æ„ŸçŸ¥æ¨¡å‹çš„è¯„ä¼°ã€‚ æ¿€å…‰é›·è¾¾æ•°æ®é›†: åŒ…å«20,000ä¸ªæœªæ ‡è®°çš„æ¿€å…‰é›·è¾¾ç‚¹äº‘åºåˆ—å’Œåœ°å›¾é…å‡†ä½å§¿ã€‚è¯¥æ•°æ®é›†æ˜¯æœ‰å²ä»¥æ¥æœ€å¤§çš„æ¿€å…‰é›·è¾¾ä¼ æ„Ÿå™¨æ•°æ®é›†åˆï¼Œæ”¯æŒè‡ªç›‘ç£å­¦ä¹ å’Œæ–°å…´çš„ç‚¹äº‘é¢„æµ‹ä»»åŠ¡ã€‚ è¿åŠ¨é¢„æµ‹æ•°æ®é›†: åŒ…å«250,000ä¸ªåœºæ™¯ï¼ŒæŒ–æ˜æ¯ä¸ªåœºæ™¯ä¸­è‡ªè½¦ä¸å…¶ä»–å‚ä¸è€…ä¹‹é—´æœ‰è¶£å’Œå…·æœ‰æŒ‘æˆ˜æ€§çš„äº¤äº’ã€‚æ¨¡å‹çš„ä»»åŠ¡æ˜¯é¢„æµ‹æ¯ä¸ªåœºæ™¯ä¸­scored actorsçš„æœªæ¥è¿åŠ¨ï¼Œå¹¶æä¾›è·Ÿè¸ªå†å²ï¼Œæ•æ‰ç›®æ ‡çš„ä½ç½®ã€èˆªå‘ã€é€Ÿåº¦å’Œç±»åˆ«ã€‚ åœ¨æ‰€æœ‰ä¸‰ä¸ªæ•°æ®é›†ä¸­ï¼Œæ¯ä¸ªåœºæ™¯éƒ½åŒ…å«è‡ªå·±çš„é«˜ç²¾åœ°å›¾ï¼Œå¸¦æœ‰3Dè½¦é“å’Œäººè¡Œæ¨ªé“å‡ ä½•å½¢çŠ¶â€“æ¥è‡ªå…­ä¸ªä¸åŒåŸå¸‚çš„æ•°æ®ã€‚æ‰€æœ‰æ•°æ®é›†éƒ½æ˜¯åœ¨CC BY-NC-SA 4.0è®¸å¯ä¸‹å‘å¸ƒçš„ã€‚ ","date":"2024-01-05","objectID":"/posts/argoverse2/:1:0","tags":["dataset","prediction"],"title":"Argoverse 2 æ•°æ®é›†","uri":"/posts/argoverse2/"},{"categories":["AutonomousDriving"],"content":"äºŒã€Argoverse 2 Datasets ","date":"2024-01-05","objectID":"/posts/argoverse2/:2:0","tags":["dataset","prediction"],"title":"Argoverse 2 æ•°æ®é›†","uri":"/posts/argoverse2/"},{"categories":["AutonomousDriving"],"content":"2.1 Sensor Dataset ä¼ æ„Ÿå™¨æ•°æ®é›† Argoverse 2ä¼ æ„Ÿå™¨æ•°æ®é›†æ˜¯Argoverse 1 3Dè·Ÿè¸ªæ•°æ®é›†çš„åç»­ã€‚AV2æ›´å¤§ï¼Œæœ‰1000ä¸ªåœºæ™¯ï¼Œé«˜äºArgoverse 1ä¸­çš„113ä¸ªï¼Œä½†æ¯ä¸ªAV2åœºæ™¯ä¹Ÿæ›´ä¸°å¯Œâ€“AV2ä¸­æœ‰23å€çš„éè½¦è¾†ã€éè¡Œäººé•¿æ–¹ä½“ã€‚ä½œè€…æ‰‹å·¥é€‰æ‹©Argoverse 2ä¼ æ„Ÿå™¨æ•°æ®é›†ä¸­çš„30sç»„æˆåœºæ™¯ï¼Œä»¥åŒ…å«æ‹¥æŒ¤çš„åœºæ™¯ï¼Œå…¶ä¸­åŒ…å«æœªè¢«è¡¨ç¤ºçš„å¯¹è±¡ã€å€¼å¾—æ³¨æ„çš„å¤©æ°”å’Œæœ‰è¶£çš„è¡Œä¸ºï¼Œå¦‚æ’é˜Ÿå’Œä¹±ç©¿é©¬è·¯ã€‚æ¯ä¸ªåœºæ™¯çš„æŒç»­æ—¶é—´ä¸º15ç§’ã€‚è¡¨1å°†AV2ä¼ æ„Ÿå™¨æ•°æ®é›†ä¸è‡ªåŠ¨é©¾é©¶æ•°æ®é›†è¿›è¡Œäº†æ¯”è¾ƒã€‚å›¾1ã€2å’Œ3æ˜¾ç¤ºäº†AV2çš„åœºæ™¯åœ¨æ ‡æ³¨èŒƒå›´ã€ç›®æ ‡å¤šæ ·æ€§ã€ç›®æ ‡å¯†åº¦å’Œåœºæ™¯åŠ¨æ€æ€§æ–¹é¢å¦‚ä½•ä¼˜äºå…¶ä»–æ•°æ®é›†ã€‚ ä¸æœ¬æ–‡æœ€ç›¸ä¼¼çš„ä¼ æ„Ÿå™¨æ•°æ®é›†æ˜¯éå¸¸æœ‰å½±å“åŠ›çš„nuScenes[4]â€“è¿™ä¸¤ä¸ªæ•°æ®é›†éƒ½æœ‰1000ä¸ªåœºæ™¯å’Œé«˜æ¸…åœ°å›¾ï¼Œå°½ç®¡Argoverseåœ¨æ‹¥æœ‰åœ°é¢é«˜åº¦åœ°å›¾æ–¹é¢æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚nuScenesåŒ…å«æ¯«ç±³æ³¢é›·è¾¾æ•°æ®ï¼Œè€ŒAV2åŒ…å«åŒç›®å›¾åƒã€‚nuScenesæœ‰ä¸€ä¸ªå¾ˆå¤§çš„åˆ†ç±»å­¦â€“23ä¸ªç›®æ ‡ç±»åˆ«ï¼Œå…¶ä¸­10ä¸ªæœ‰é€‚åˆè®­ç»ƒå’Œè¯„ä¼°ï¼ˆevaluationï¼‰çš„æ•°æ®ã€‚æœ¬æ–‡çš„æ•°æ®é›†åŒ…å«30ä¸ªç›®æ ‡ç±»åˆ«ï¼Œå…¶ä¸­26ä¸ªè¢«å¾ˆå¥½åœ°é‡‡æ ·ï¼Œè¶³ä»¥ç”¨äºè®­ç»ƒå’Œè¯„ä¼°ã€‚nuScenesæ¨ªè·¨ä¸¤ä¸ªåŸå¸‚ï¼Œè€Œæœ¬æ–‡çš„æå‡ºçš„æ•°æ®é›†æ¨ªè·¨å…­ä¸ªåŸå¸‚ã€‚ ä¼ æ„Ÿå™¨å¥—ä»¶ã€‚ æ¿€å…‰é›·è¾¾æ‰«ææ”¶é›†åœ¨10èµ«å…¹ï¼Œä»¥åŠ20 fpså›¾åƒä»7ä¸ªæ‘„åƒå¤´å®šä½ï¼Œä»¥æä¾›ä¸€ä¸ªå®Œæ•´çš„å…¨æ™¯è§†é‡ã€‚æ­¤å¤–ï¼Œè¿˜æä¾›äº†å…¨å±€åæ ‡ç³»ä¸‹çš„æ‘„åƒæœºå†…å‚ã€å¤–å‚å’Œ6è‡ªç”±åº¦ ego-vehicle å§¿æ€ã€‚æ¿€å…‰é›·è¾¾å›æ³¢ç”±ä¸¤ä¸ª32æ³¢æŸæ¿€å…‰é›·è¾¾æ•è·ï¼Œæ¿€å…‰é›·è¾¾åœ¨åŒä¸€æ–¹å‘ä»¥10èµ«å…¹æ—‹è½¬ï¼Œä½†åœ¨æ–¹å‘ä¸Šç›¸éš”180Â°ã€‚æ‘„åƒæœºè§¦å‘ä¸ä¸¤ä¸ªæ¿€å…‰é›·è¾¾åŒæ­¥ï¼Œå¯¼è‡´20èµ«å…¹çš„å¸§ç‡ã€‚ä¸ƒä¸ªå…¨å±€å¿«é—¨æ‘„åƒæœºä¸æ¿€å…‰é›·è¾¾åŒæ­¥ï¼Œä½¿å®ƒä»¬çš„æ›å…‰é›†ä¸­åœ¨æ¿€å…‰é›·è¾¾ä¸Šï¼Œæ‰«æå®ƒä»¬çš„è§†é‡ã€‚åœ¨é™„å½•ä¸­ï¼Œæœ¬æ–‡æä¾›äº†ä¸€ä¸ªç¤ºæ„å›¾ï¼Œè¯´æ˜äº†æ±½è½¦ä¼ æ„Ÿå™¨å¥—ä»¶åŠå…¶åæ ‡æ¡†æ¶ã€‚ æ¿€å…‰é›·è¾¾åŒæ­¥ç²¾åº¦ã€‚ åœ¨AV2ä¸­ï¼Œæœ¬æ–‡æ”¹è¿›äº†æ‘„åƒæœºå’Œæ¿€å…‰é›·è¾¾çš„åŒæ­¥æ¯”Argoverse 1æ˜æ˜¾ã€‚æœ¬æ–‡çš„åŒæ­¥ç²¾åº¦åœ¨[-1.39,1.39]msï¼Œä¸Waymoå¼€æ”¾æ•°æ®é›†[-6,7]ms[45]ç›¸æ¯”è¾ƒã€‚ æ ‡æ³¨ã€‚ AV2ä¼ æ„Ÿå™¨æ•°æ®é›†åŒ…å«æœ¬æ–‡30ä¸ªç±»åˆ†ç±»æ³•ä¸­çš„å¯¹è±¡çš„10 Hz 3Dé•¿æ–¹ä½“æ ‡æ³¨ï¼ˆå›¾1ï¼‰ã€‚é•¿æ–¹ä½“çš„è½¨é“æ ‡è¯†ç¬¦éšç€æ—¶é—´çš„æ¨ç§»å¯¹äºç›¸åŒçš„ç›®æ ‡å®ä¾‹æ˜¯ä¸€è‡´çš„ã€‚å¦‚æœå¯¹è±¡åœ¨â€œæ„Ÿå…´è¶£åŒºåŸŸâ€(ROI)å†…â€“åœ¨æ˜ å°„çš„â€œå¯é©¾é©¶â€åŒºåŸŸçš„äº”ç±³å†…ï¼Œåˆ™å¯¹å…¶è¿›è¡Œæ ‡æ³¨ã€‚ éšç§ã€‚ ä¸ºäº†ä¿æŠ¤éšç§ï¼Œæ‰€æœ‰çš„è„¸å’Œè½¦ç‰Œï¼Œæ— è®ºæ˜¯åœ¨è½¦è¾†å†…è¿˜æ˜¯åœ¨å¯é©¾é©¶åŒºåŸŸå¤–ï¼Œéƒ½è¢«å¹¿æ³›æ¨¡ç³Šã€‚ ä¼ æ„Ÿå™¨æ•°æ®é›†åˆ†å‰²ã€‚ æœ¬æ–‡éšæœºåœ°å°†æ•°æ®é›†åˆ’åˆ†ä¸º700ã€150å’Œ150ä¸ªåœºæ™¯çš„è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•æ‹†åˆ†ã€‚ ","date":"2024-01-05","objectID":"/posts/argoverse2/:2:1","tags":["dataset","prediction"],"title":"Argoverse 2 æ•°æ®é›†","uri":"/posts/argoverse2/"},{"categories":["AutonomousDriving"],"content":"2.2 Lidar Dataset æ¿€å…‰é›·è¾¾æ•°æ®é›† Argoverse 2 æ¿€å…‰é›·è¾¾æ•°æ®é›†æ—¨åœ¨æ”¯æŒæ¿€å…‰é›·è¾¾åŸŸä¸­çš„è‡ªç›‘ç£å­¦ä¹ ç ”ç©¶ä»¥åŠç‚¹äº‘é¢„æµ‹[48,49]ã€‚ç”±äºæ¿€å…‰é›·è¾¾æ•°æ®æ¯”å®Œæ•´çš„ä¼ æ„Ÿå™¨å¥—ä»¶æ›´ç´§å‡‘ï¼Œæœ¬æ–‡å¯ä»¥åŒ…æ‹¬ä¸¤å€é•¿åº¦çš„åœºæ™¯ï¼ˆ30ç§’è€Œä¸æ˜¯15ç§’ï¼‰ï¼Œå’Œæ›´å¤š ï¼ˆ20,000 è€Œä¸æ˜¯ 1,000ï¼‰ï¼Œç›¸å½“äºå¤§çº¦40å€çš„é©¾é©¶å°æ—¶ï¼Œç©ºé—´é¢„ç®—æ˜¯5å€ã€‚AV2æ¿€å…‰é›·è¾¾æ•°æ®é›†çš„æŒ–æ˜æ ‡å‡†ä¸é¢„æµ‹æ•°æ®é›†ï¼ˆç¬¬3.3.2èŠ‚ï¼‰ç›¸åŒï¼Œä»¥ç¡®ä¿æ¯ä¸ªåœºæ™¯éƒ½æ˜¯æœ‰è¶£çš„ã€‚è™½ç„¶æ¿€å…‰é›·è¾¾æ•°æ®é›†æ²¡æœ‰3Dç›®æ ‡æ ‡æ³¨ï¼Œä½†æ¯ä¸ªåœºæ™¯éƒ½å¸¦æœ‰ä¸€å¼ é«˜æ¸…åœ°å›¾ï¼Œå…¶ä¸­åŒ…å«å…³äºåœºæ™¯çš„ä¸°å¯Œçš„3Dä¿¡æ¯ã€‚ æœ¬æ–‡çš„æ•°æ®é›†æ˜¯è¿„ä»Šä¸ºæ­¢æœ€å¤§çš„æ­¤ç±»é›†åˆï¼Œæœ‰20,000ä¸ª30ç§’åºåˆ—ã€‚å”¯ä¸€ä¸€ä¸ªç±»ä¼¼çš„æ•°æ®é›†ï¼Œæ˜¯åŒæ—¶å‘å¸ƒçš„ONCE[36]ï¼ŒåŒ…å«1Mæ¿€å…‰é›·è¾¾å¸§ï¼Œè€Œæœ¬æ–‡çš„æ˜¯6Mæ¿€å…‰é›·è¾¾å¸§ã€‚æœ¬æ–‡çš„æ•°æ®é›†ä»¥10 Hzé‡‡æ ·ï¼Œè€Œä¸æ˜¯åƒONCE[36]ä¸­é‚£æ ·ä»¥2 Hzé‡‡æ ·ï¼Œä½¿æœ¬æ–‡çš„æ•°æ®é›†æ›´é€‚åˆäºç‚¹äº‘é¢„æµ‹æˆ–è‡ªç›‘ç£ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡ç‚¹äº‘éšæ—¶é—´çš„æ¼”å˜æ˜¯é‡è¦çš„ã€‚ æ¿€å…‰é›·è¾¾æ•°æ®é›†åˆ†å‰²ã€‚ æœ¬æ–‡ç”¨åˆ†åˆ«ä¸º16,000ä¸ªã€2000ä¸ªå’Œ2000ä¸ªåœºæ™¯çš„trainã€validationå’Œtestæ‹†åˆ† éšæœºåˆ’åˆ†æ•°æ®é›†ã€‚ ","date":"2024-01-05","objectID":"/posts/argoverse2/:2:2","tags":["dataset","prediction"],"title":"Argoverse 2 æ•°æ®é›†","uri":"/posts/argoverse2/"},{"categories":["AutonomousDriving"],"content":"2.3 Motion Forecasting Dataset è¿åŠ¨é¢„æµ‹æ•°æ®é›† è¿åŠ¨é¢„æµ‹è§£å†³äº†é¢„æµ‹å±€éƒ¨ç¯å¢ƒä¸­åŠ¨æ€è¡Œä¸ºè€…çš„æœªæ¥çŠ¶æ€ï¼ˆæˆ–å ç”¨å›¾ï¼‰çš„é—®é¢˜ã€‚è‡ªåŠ¨é©¾é©¶ç›¸å…³è¡Œä¸ºè€…çš„ä¸€äº›ä¾‹å­åŒ…æ‹¬ï¼šè½¦è¾†ï¼ˆåœè½¦å’Œç§»åŠ¨ï¼‰ã€è¡Œäººã€éª‘è‡ªè¡Œè½¦çš„äººã€æ»‘æ¿è½¦å’Œå® ç‰©ã€‚ç”±é¢„æµ‹ç³»ç»Ÿç”Ÿæˆçš„é¢„æµ‹æœªæ¥è¢«ç”¨ä½œè¿åŠ¨è§„åˆ’çš„ä¸»è¦è¾“å…¥ï¼Œè¿åŠ¨è§„åˆ’æ ¹æ®è¿™ç§é¢„æµ‹æ¡ä»¶è¿›è¡Œè½¨è¿¹é€‰æ‹©ã€‚ç”Ÿæˆè¿™äº›é¢„æµ‹æå‡ºäº†ä¸€ä¸ªå¤æ‚çš„ã€å¤šæ¨¡æ€çš„é—®é¢˜ï¼Œæ¶‰åŠè®¸å¤šä¸åŒçš„ã€éƒ¨åˆ†è§‚å¯Ÿçš„å’Œç¤¾ä¼šäº¤äº’çš„ä¸»ä½“ã€‚ç„¶è€Œï¼Œé€šè¿‡åˆ©ç”¨è§‚å¯Ÿåˆ°çš„ground truth futures æ¥â€œè‡ªæˆ‘æ ‡è®°â€æ•°æ®çš„èƒ½åŠ›ï¼Œè¿åŠ¨é¢„æµ‹æˆä¸ºæœºå™¨å­¦ä¹ åº”ç”¨çš„ç†æƒ³é¢†åŸŸï¼ˆideal domainï¼‰ã€‚ åœ¨Argoverse 1æˆåŠŸçš„åŸºç¡€ä¸Šï¼ŒArgoverse 2è¿åŠ¨é¢„æµ‹æ•°æ®é›†æä¾›äº†ä»è‡ªåŠ¨é©¾é©¶è½¦é˜Ÿæ”¶é›†çš„ä¸€ç»„æ›´æ–°çš„é¢„æµ‹åœºæ™¯ã€‚ä¸‹é¢åˆ—ä¸¾çš„è®¾è®¡å†³ç­–æ€»ç»“äº†æœ¬æ–‡ä»å†…éƒ¨ç ”ç©¶/å¼€å‘ä¸­å¸å–çš„é›†ä½“ç»éªŒæ•™è®­ï¼Œä»¥åŠæ¥è‡ª3ä¸ªç«èµ›ä¸­è¿‘260ä¸ªç‹¬ç‰¹å›¢é˜Ÿæäº¤çš„2700å¤šä»½submissionsçš„åé¦ˆæ„è§[43]: è¿åŠ¨é¢„æµ‹æ˜¯é•¿å°¾åŸŸä¸­çš„ä¸€ä¸ªå®‰å…¨å…³é”®ç³»ç»Ÿã€‚ å› æ­¤ï¼Œæœ¬æ–‡çš„æ•°æ®é›†åå‘äºåŒ…å«ä¸åŒç±»å‹focal agentçš„ä¸åŒå’Œæœ‰è¶£çš„åœºæ™¯ï¼ˆè§ç¬¬3.3.2èŠ‚ï¼‰ã€‚æœ¬æ–‡çš„ç›®æ ‡æ˜¯é¼“åŠ±å¼€å‘ç¡®ä¿å°¾éƒ¨äº‹ä»¶ï¼ˆtail eventsï¼‰æœŸé—´å®‰å…¨çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä¼˜åŒ–â€œè½»æ¾é‡Œç¨‹â€ä¸Šçš„é¢„æœŸæ€§èƒ½ã€‚ There is a â€œGoldilocks zoneâ€ of task difficulty. Argoverse1æµ‹è¯•é›†çš„æ€§èƒ½å·²ç»å¼€å§‹ç¨³å®šä¸‹æ¥ï¼Œå¦‚é™„å½•çš„å›¾10æ‰€ç¤ºã€‚Argoverse 2çš„è®¾è®¡æ˜¯ä¸ºäº†å¢åŠ é¢„æµ‹çš„éš¾åº¦ï¼Œåœ¨æœªæ¥å‡ å¹´åˆºæ¿€å¯Œæœ‰æˆæ•ˆçš„é‡ç‚¹ç ”ç©¶ã€‚è¿™äº›å˜åŒ–æ—¨åœ¨æ¿€åŠ±åœ¨æ‰©å±•é¢„æµ‹èŒƒå›´(3sâ†’6s)ä¸Šè¡¨ç°è‰¯å¥½çš„æ–¹æ³•ï¼Œå¤„ç†å¤šç§ç±»å‹çš„åŠ¨æ€å¯¹è±¡(1â†’5)ï¼Œå¹¶ç¡®ä¿é•¿å°¾åœºæ™¯çš„å®‰å…¨æ€§ã€‚æœªæ¥çš„Argoverse releaseså¯èƒ½ä¼šé€šè¿‡å‡å°‘è§‚æµ‹çª—å£å’Œå¢åŠ é¢„æµ‹å±‚ä½æ¥ç»§ç»­å¢åŠ é—®é¢˜çš„éš¾åº¦ã€‚ å¯ç”¨æ€§å¾ˆé‡è¦ã€‚ Argoverse 1å—ç›Šäºä¸€ä¸ªåºå¤§è€Œæ´»è·ƒçš„ç ”ç©¶ç¤¾åŒºâ€“åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç”±äºè®¾ç½®å’Œä½¿ç”¨çš„ç®€å•æ€§ã€‚å› æ­¤ï¼Œæœ¬æ–‡æ³¨æ„ç¡®ä¿ç°æœ‰çš„Argoverseæ¨¡å‹å¯ä»¥å¾ˆå®¹æ˜“åœ°ç§»æ¤åˆ°Argoverse 2ä¸Šè¿è¡Œã€‚ç‰¹åˆ«æ˜¯ï¼Œæœ¬æ–‡ä¼˜å…ˆè€ƒè™‘å¯¹åœ°å›¾å…ƒç´ çš„ç›´è§‚è®¿é—®ï¼Œé¼“åŠ±ä½¿ç”¨è½¦é“å›¾ä½œä¸ºå¼ºä¼˜å…ˆçº§çš„æ–¹æ³•ã€‚ä¸ºäº†æé«˜è®­ç»ƒå’Œæ³›åŒ–ï¼Œæ‰€æœ‰å§¿æ€ä¹Ÿè¢«æ’å€¼å’Œé‡æ–°é‡‡æ ·åœ¨ç²¾ç¡®çš„10èµ«å…¹ï¼ˆArgoverse 1æ˜¯è¿‘ä¼¼çš„ï¼‰ã€‚æ–°çš„æ•°æ®é›†åŒ…æ‹¬æ›´å°‘ï¼Œä½†æ›´é•¿å’Œæ›´å¤æ‚çš„åœºæ™¯ï¼›è¿™ç¡®ä¿æ€»çš„æ•°æ®é›†å¤§å°ä¿æŒè¶³å¤Ÿå¤§ï¼Œå¯ä»¥è®­ç»ƒå¤æ‚çš„æ¨¡å‹ï¼Œä½†è¶³å¤Ÿå°ï¼Œå¯ä»¥æ–¹ä¾¿åœ°è®¿é—®ã€‚ ","date":"2024-01-05","objectID":"/posts/argoverse2/:2:3","tags":["dataset","prediction"],"title":"Argoverse 2 æ•°æ®é›†","uri":"/posts/argoverse2/"},{"categories":["AutonomousDriving"],"content":"2.4 HD Maps é«˜ç²¾åœ°å›¾ ä¸Šè¿°ä¸‰ä¸ªæ•°æ®é›†ä¸­çš„æ¯ä¸ªåœºæ™¯å…±äº«ç›¸åŒçš„HDåœ°å›¾è¡¨ç¤ºã€‚æ¯ä¸ªåœºæ™¯éƒ½å¸¦æœ‰è‡ªå·±çš„æœ¬åœ°åœ°å›¾åŒºåŸŸï¼Œç±»ä¼¼äºWaymo Open Motion[12]æ•°æ®é›†ã€‚è¿™ä¸æœ€åˆçš„Argoverseæ•°æ®é›†ä¸åŒï¼Œåœ¨æœ€åˆçš„æ•°æ®é›†ä¸­ï¼Œæ‰€æœ‰åœºæ™¯éƒ½è¢«æœ¬åœ°åŒ–åˆ°ä¸¤å¼ åŸå¸‚åœ°å›¾ä¸Šâ€“ä¸€å¼ æ˜¯åŒ¹å…¹å ¡çš„ï¼Œä¸€å¼ æ˜¯è¿ˆé˜¿å¯†çš„ã€‚åœ¨é™„å½•ä¸­ï¼Œæœ¬æ–‡æä¾›äº†ä¾‹å­ã€‚æ¯ä¸ªåœºæ™¯æ˜ å°„çš„ä¼˜ç‚¹åŒ…æ‹¬æ›´é«˜æ•ˆçš„æŸ¥è¯¢å’Œå¤„ç†æ˜ å°„æ›´æ”¹çš„èƒ½åŠ›ã€‚åœ¨æœ¬æ–‡çš„æ•°æ®é›†ä¸­ï¼Œä¸€ä¸ªç‰¹å®šçš„åå­—è·¯å£å¯èƒ½ä¼šè¢«è§‚å¯Ÿå¤šæ¬¡ï¼Œåœ¨æ­¤æœŸé—´è½¦é“ã€äººè¡Œæ¨ªé“ç”šè‡³åœ°é¢é«˜åº¦éƒ½å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ è½¦é“å›¾ã€‚ HDåœ°å›¾çš„æ ¸å¿ƒç‰¹å¾æ˜¯è½¦é“å›¾ï¼Œç”±å›¾ç»„æˆï¼Œå…¶ä¸­æ˜¯å•ä¸ªè½¦é“æ®µã€‚åœ¨é™„å½•ä¸­ï¼Œæœ¬æ–‡åˆ—ä¸¾å¹¶å®šä¹‰äº†æœ¬æ–‡ä¸ºæ¯ä¸ªè½¦é“æ®µæä¾›çš„å±æ€§ã€‚ä¸Argoverse 1ä¸åŒï¼Œæœ¬æ–‡æä¾›äº†å®é™…çš„3Dè½¦é“è¾¹ç•Œï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸­å¿ƒçº¿ã€‚ä½†æ˜¯ï¼Œæœ¬æ–‡çš„APIæä¾›äº†ä»£ç ï¼Œå¯ä»¥åœ¨ä»»ä½•æœŸæœ›çš„é‡‡æ ·åˆ†è¾¨ç‡ä¸‹å¿«é€Ÿæ¨æ–­ä¸­å¿ƒçº¿ã€‚æŠ˜çº¿è¢«é‡åŒ–åˆ°1cmåˆ†è¾¨ç‡ã€‚æœ¬æ–‡çš„è¡¨ç¤ºæ¯”nuScenesæ›´ä¸°å¯Œï¼Œå®ƒåªåœ¨2Dä¸­æä¾›è½¦é“å‡ ä½•ï¼Œè€Œä¸æ˜¯3Dã€‚ å¯é©¾é©¶åŒºåŸŸã€‚ è€Œä¸æ˜¯åƒåœ¨Argoverse 1ä¸­æ‰€åšçš„é‚£æ ·ï¼Œä»¥å…‰æ …åŒ–æ ¼å¼æä¾›å¯é©¾é©¶åŒºåŸŸåˆ†å‰²ï¼Œæœ¬æ–‡ä»¥çŸ¢é‡æ ¼å¼é‡Šæ”¾å®ƒï¼Œå³ä½œä¸º3Då¤šè¾¹å½¢ã€‚è¿™æä¾›äº†å¤šç§ä¼˜åŠ¿ï¼Œä¸»è¦æ˜¯åœ¨å‹ç¼©æ–¹é¢ï¼Œå…è®¸æœ¬æ–‡ä¸ºæˆåƒä¸Šä¸‡çš„åœºæ™¯å­˜å‚¨å•ç‹¬çš„åœ°å›¾ï¼Œç„¶è€Œå…‰æ …æ ¼å¼ä»ç„¶å¾ˆå®¹æ˜“è¡ç”Ÿã€‚å°†å¤šè¾¹å½¢é¡¶ç‚¹é‡åŒ–åˆ°1cmåˆ†è¾¨ç‡ã€‚ **åœ°è¡¨é«˜åº¦ã€‚**åªæœ‰ä¼ æ„Ÿå™¨æ•°æ®é›†åŒ…æ‹¬å¯†é›†çš„åœ°è¡¨é«˜åº¦å›¾ï¼ˆå°½ç®¡å…¶ä»–æ•°æ®é›†ä»ç„¶æœ‰å…³äºæŠ˜çº¿çš„ç¨€ç–çš„ä¸‰ç»´é«˜åº¦ä¿¡æ¯ï¼‰ã€‚åœ°åœ°é¢é«˜åº¦ä¸ºå¯è¡Œé©¶åŒºåŸŸè¾¹ç•Œ5mç­‰å€¼çº¿å†…çš„åŒºåŸŸæä¾›ï¼Œæœ¬æ–‡å°†å…¶å®šä¹‰ä¸ºæ„Ÿå…´è¶£åŒºåŸŸ(ROI)[6]ã€‚æœ¬æ–‡è¿™æ ·åšæ˜¯å› ä¸ºå¯¹äºå»ºç­‘ç‰©å†…éƒ¨å’Œå»ºç­‘å¯†é›†çš„åŸå¸‚è¡—åŒºå†…éƒ¨ï¼Œåœ°é¢è½¦è¾†ç”±äºé®æŒ¡è€Œæ— æ³•è§‚å¯Ÿçš„åŒºåŸŸï¼Œåœ°è¡¨é«˜åº¦çš„æ¦‚å¿µå®šä¹‰ä¸æ¸…(ill-defined)ã€‚å…‰æ …æ …æ ¼è¢«é‡åŒ–åˆ°30cmåˆ†è¾¨ç‡ï¼Œæ¯”Argoverse 1ä¸­çš„1måˆ†è¾¨ç‡æ›´é«˜ã€‚ **æœ¬åœ°åœ°å›¾çš„é¢ç§¯ã€‚**æ¯ä¸ªåœºæ™¯çš„å±€éƒ¨åœ°å›¾éƒ½åŒ…æ‹¬åœ¨ego-vehicleè½¨è¿¹çš„l2èŒƒæ•°ä¸­100ç±³è†¨èƒ€èŒƒå›´å†…æ‰¾åˆ°çš„æ‰€æœ‰å®ä½“ã€‚ ","date":"2024-01-05","objectID":"/posts/argoverse2/:2:4","tags":["dataset","prediction"],"title":"Argoverse 2 æ•°æ®é›†","uri":"/posts/argoverse2/"},{"categories":["AutonomousDriving"],"content":"ä¸‰ã€Argoverse 2 API ç®€ä»‹ è½¨è¿¹é¢„æµ‹å¸¸ç”¨çš„æœ‰åœºæ™¯æ•°æ®ArgoverseScenarioå’Œåœ°å›¾ArgoverseStaticMap è½¨è¿¹åºåˆ—è¯»å–çš„APIä¸ºscenario_serialization å¯è§†åŒ–çš„APIä¸ºvisualize_scenario argoverse2å’Œargoverse1ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯ï¼Œæ¯ä¸€æ®µè½¨è¿¹åºåˆ—ï¼ˆScenarioï¼‰å†…æœ‰è‡ªå·±çš„jsonåœ°å›¾æ–‡ä»¶ï¼ˆè™½ç„¶è¯´éƒ½æ˜¯åŒä¸€å¹…HD mapï¼Œä½†æ˜¯å¯¹åº”HD mapä¸­çš„ä¸åŒçš„ä½ç½®ï¼‰ï¼Œè€Œargoverse1æ˜¯æ‰€æœ‰è½¨è¿¹åºåˆ—å…±äº«ä¸€ä¸ªåœ°å›¾æ–‡ä»¶ # å­˜æ”¾è½¨è¿¹åºåˆ—çš„ç±» from av2.datasets.motion_forecasting.data_schema import ArgoverseScenario # ç”¨äºè¯»å–è½¨è¿¹åºåˆ—çš„API from av2.datasets.motion_forecasting import scenario_serialization # ç”¨äºå¯è§†åŒ–çš„API from av2.datasets.motion_forecasting.viz.scenario_visualization import visualize_scenario # ç”¨äºè¯»å–åœ°å›¾çš„API from av2.map.map_api import ArgoverseStaticMap ArgoverseScenario æ¯ä¸ªscenarioæœ‰11sé•¿çš„åºåˆ—ï¼ŒåŒ…å«actorçš„å†å²è½¨è¿¹é›†åˆï¼Œå°±æ˜¯è¿™é‡Œé¢çš„tracksï¼Œå¯¹äºæ¯ä¸€ä¸ªscenarioï¼Œæä¾›äº†ä»¥ä¸‹çš„é¡¶å±‚å±æ€§: scenario_id: è¯¥scenarioçš„ç‰¹æœ‰ID timestamps_ns: è¯¥scenarioçš„æ‰€æœ‰æ—¶é—´æˆ³ tracks: è¯¥scenarioçš„æ‰€æœ‰è½¨è¿¹åºåˆ— focal_track_id: è¯¥scenarioçš„ç„¦ç‚¹agent(focal agent)çš„track ID city_name: è¯¥scenarioå¯¹åº”çš„åŸå¸‚å æ¯ä¸ªtrackåŒ…å«ä»¥ä¸‹å±æ€§: track_id: è¯¥trackçš„ç‰¹æœ‰ID object_states: è¯¥è½¨è¿¹åºåˆ—å¯¹åº”çš„objectåœ¨è¿™11så†…çš„æœ‰æ•ˆè§‚æµ‹çš„çŠ¶æ€ï¼Œä»¥timestepè¡¨ç¤ºæ—¶é—´æ­¥ï¼Œä¸€èˆ¬æ¥è¯´æœ€å¤šæœ‰110æ­¥ï¼Œå› ä¸ºé‡‡æ ·é¢‘ç‡ä¸º10Hzï¼Œä¸€æ­¥å¯¹åº”0.1s object_type: è¯¥è½¨è¿¹åºåˆ—å¯¹åº”çš„objectçš„ç±»å‹ï¼Œå¦‚vehicleç­‰ category: ç»™è½¨è¿¹åºåˆ—åˆ†é…ç§ç±»ï¼Œç”¨äºç»™è½¨è¿¹é¢„æµ‹çš„æ•°æ®è´¨é‡æä¾›å‚è€ƒï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæœ‰å››ç§ï¼šSCORED_TRACKï¼ŒUNSCORED_TRACKï¼ŒFOCAL_TRACKï¼ŒTRACK_FRAGMENTã€‚å…¶ä¸­FOCAL_TRACKå’ŒSCORED_TRACKæ•°æ®è´¨é‡è¾ƒå¥½ï¼ŒUNSCORED_TRACKç”¨äºå½“ä½œä¸Šä¸‹æ–‡è¾“å…¥ï¼Œæ•°æ®è´¨é‡ä¸€èˆ¬ï¼Œè€ŒTRACK_FRAGMENTçš„æ—¶é—´é•¿åº¦ä¸å®šï¼Œæ•°æ®è´¨é‡è¾ƒå·® TRACK_FRAGMENT: Lower quality track that may only contain a few timestamps of observations. åœ¨æ•°æ®ä¸­ä»¥æ•´æ•°0è¡¨ç¤º UNSCORED_TRACK: Unscored track used for contextual input. åœ¨æ•°æ®ä¸­ä»¥æ•´æ•°1è¡¨ç¤º SCORED_TRACK: High-quality tracks relevant to the AV - scored in the multi-agent prediction challenge. åœ¨æ•°æ®ä¸­ä»¥æ•´æ•°2è¡¨ç¤º FOCAL_TRACK: The primary track of interest in a given scenario - scored in the single-agent prediction challenge. åœ¨æ•°æ®ä¸­ä»¥æ•´æ•°3è¡¨ç¤º æ¯ä¸ªobject_statesåŒ…å«ä»¥ä¸‹å±æ€§ï¼Œå¯¹åº”æŸä¸€actoråœ¨æŸä¸€æ—¶é—´ç‚¹çš„æ‰€æœ‰ä¿¡æ¯ï¼š observed: Boolean æŒ‡ç¤ºè¿™ä¸ªobject stateæ˜¯å¦åœ¨è¯¥scenarioçš„è§‚æµ‹åŒºé—´å†…(observed segment) timestep: æ—¶é—´æ­¥ï¼ŒèŒƒå›´æ˜¯[0, num_scenario_timesteps) Time step corresponding to this object state [0, num_scenario_timesteps). position: (x, y) Coordinates of center of object bounding box. object bounding boxçš„xyåæ ‡ heading: Heading associated with object bounding box (in radians, defined w.r.t the map coordinate frame). object bounding boxçš„èˆªå‘è§’ï¼Œå•ä½æ˜¯å¼§åº¦ï¼Œæ˜¯åœ¨åœ°å›¾åæ ‡ç³»ä¸‹çš„ velocity: (x, y) Instantaneous velocity associated with the object (in m/s). objectçš„xyæ–¹å‘çš„é€Ÿåº¦ æ¯ä¸ªtrackæœ‰ä»¥ä¸‹10ç§label: Dynamic VEHICLE PEDESTRIAN MOTORCYCLIST CYCLIST BUS Static STATIC BACKGROUND CONSTRUCTION RIDERLESS_BICYCLE UNKNOWN ArgoverseStaticMap Vector Map: Lane Graph and Lane Segments The core feature of the HD map is the lane graph, consisting of a graph G = (V, E), where V are individual lane segments. Argoverse2 æä¾›äº†3Dçš„é“è·¯è¾¹ç•Œçº¿ï¼Œè€Œä¸æ˜¯ä»…ä»…æœ‰centerlinesï¼Œä¹Ÿæä¾›äº†å¿«é€Ÿè·å–ç‰¹å®šé‡‡æ ·åˆ†è¾¨ç‡çš„centerlinesçš„APIï¼Œåœ¨releaseä¸­å¤šè¾¹å½¢çš„åˆ†è¾¨ç‡è¢«è®¾ç½®ä¸º1cm åœ°å›¾ä»¥jsonæ–‡ä»¶çš„å½¢å¼æä¾›, å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¯»å–ï¼š from av2.map.map_api import ArgoverseStaticMap log_map_dirpath = Path(\"av2\") / \"00a6ffc1-6ce9-3bc3-a060-6006e9893a1a\" / \"map\" avm = ArgoverseStaticMap.from_map_dir(log_map_dirpath=log_map_dirpath, build_raster=False) LaneSegment LaneSegmentä¸­åŒ…å«ä»¥ä¸‹å±æ€§ï¼š id: unique identifier for this lane segment (guaranteed to be unique only within this local map). è¯¥lane segmentçš„ç‰¹æœ‰IDï¼ˆä»…åœ¨å±€éƒ¨åœ°å›¾ä¸­ä¿è¯æ˜¯ç‰¹æœ‰çš„IDï¼‰ is_intersection: boolean value representing whether or not this lane segment lies within an intersection. boolean valueï¼Œç”¨æ¥è¡¨ç¤ºè¯¥lane segmentæ˜¯å¦ä½äºä¸€ä¸ªè·¯å£å†… lane_type: designation of which vehicle types may legally utilize this lane for travel. è¡¨ç¤ºè½¦é“çº¿ç±»å‹ right_lane_boundary: 3d polyline representing the right lane boundary. 3Dçº¿æ¡ï¼Œè¡¨ç¤ºå³è½¦é“è¾¹ç•Œçº¿ left_lane_boundary: 3d polyline representing the left lane boundary. 3Dçº¿æ¡ï¼Œè¡¨ç¤ºå·¦è½¦é“è¾¹ç•Œçº¿ right_mark_type: type of painted marking found along the right lane boundary . å³è½¦é“è¾¹ç•Œçº¿çš„çº¿å‹ left_mark_type: type of painted marking found along the left lane boundary. å·¦è½¦é“è¾¹ç•Œçº¿çš„çº¿å‹ predecessors: unique identifiers of lane segments that are predecessors of this object. è¯¥lane segmentçš„å‰ç»§lane segmentçš„unique ID successors: unique identifiers of lane segments that represent successor of this object. Note: this list will be empty if no successors exist. è¯¥lane segmentçš„åç»§lane segmentçš„unique ID right_neighbor_id: unique identifier of the lane segment representing this objectâ€™s right neighbor. è¯¥","date":"2024-01-05","objectID":"/posts/argoverse2/:3:0","tags":["dataset","prediction"],"title":"Argoverse 2 æ•°æ®é›†","uri":"/posts/argoverse2/"},{"categories":["AutonomousDriving"],"content":"å››ã€Argoverse 2 æ•°æ®æå– raw_dir æ–‡ä»¶å¤¹å†…åŒ…å«.parquetå’Œ.jsonæ–‡ä»¶ï¼Œå…¶ä¸­æ–‡ä»¶ç»„ç»‡å½¢å¼ä¸ºlog_map_archive_{$scenario_name}.parquetå’Œscenario_{$scenario_name}.jsonï¼Œåˆ†åˆ«ä»£è¡¨éšœç¢ç‰©æ—¶åºä¿¡æ¯å’Œåœ°å›¾ä¿¡æ¯ã€‚ è®¾ç½®åŸå§‹æ•°æ®è·¯å¾„: raw_dir = \"/home/yejian/yejian_personal/QCNet/train/\" raw_file_name = \"ffffe3df-8d26-42c3-9e7a-59de044736a0\" è¯»å–éšœç¢ç‰©ä¿¡æ¯å’Œåœ°å›¾ä¿¡æ¯ parquet_file = os.path.join(raw_dir, raw_file_name, f'scenario_{raw_file_name}.parquet') print(f\"parquet_file: {parquet_file}\") # éšœç¢ç‰©ä¿¡æ¯ map_file = os.path.join(raw_dir, raw_file_name, f'log_map_archive_{raw_file_name}.json') print(f\"map_file: {map_file}\")# åœ°å›¾ä¿¡æ¯ df = pd.read_from_parquet(parquet_file) map_file = read_json_file(map_file) æŸ¥çœ‹éšœç¢ç‰©ä¿¡æ¯æ–‡ä»¶å†…å®¹ df.columns.values.tolist() ['observed', 'track_id', 'object_type', 'object_category', 'timestep', 'position_x', 'position_y', 'heading', 'velocity_x', 'velocity_y', 'scenario_id', 'start_timestamp', 'end_timestamp', 'num_timestamps', 'focal_track_id', 'city'] ","date":"2024-01-05","objectID":"/posts/argoverse2/:4:0","tags":["dataset","prediction"],"title":"Argoverse 2 æ•°æ®é›†","uri":"/posts/argoverse2/"},{"categories":["AutonomousDriving"],"content":"Reference [1]. https://blog.csdn.net/Yong_Qi2015/article/details/128731798 [2]. https://blog.csdn.net/m0_56423263/article/details/134593815 ","date":"2024-01-05","objectID":"/posts/argoverse2/:5:0","tags":["dataset","prediction"],"title":"Argoverse 2 æ•°æ®é›†","uri":"/posts/argoverse2/"},{"categories":["DL"],"content":"ä¸€ã€ä¼ ç»Ÿçš„BPç½‘ç»œå’ŒCNNç½‘ç»œ BPç½‘ç»œå’ŒCNNç½‘ç»œæ²¡æœ‰æ—¶é—´ç»´ï¼Œå’Œä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ç†è§£èµ·æ¥ç›¸å·®æ— å‡ ï¼ŒCNNåœ¨å¤„ç†å½©è‰²å›¾åƒçš„3é€šé“æ—¶ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå åŠ å¤šå±‚ï¼Œå›¾å½¢çš„ä¸‰ç»´çŸ©é˜µå½“åšç©ºé—´çš„åˆ‡ç‰‡å³å¯ç†è§£ï¼Œå†™ä»£ç çš„æ—¶å€™ç…§ç€å›¾å½¢ä¸€å±‚å±‚å åŠ å³å¯ã€‚å¦‚ä¸‹å›¾æ˜¯ä¸€ä¸ªæ™®é€šçš„BPç½‘ç»œå’ŒCNNç½‘ç»œã€‚ BP Network CNN Network å›¾ä¸­çš„éšå«å±‚ã€å·ç§¯å±‚ã€æ± åŒ–å±‚ã€å…¨è¿æ¥å±‚ç­‰ï¼Œéƒ½æ˜¯å®é™…å­˜åœ¨çš„ï¼Œä¸€å±‚å±‚å‰åå åŠ ï¼Œåœ¨ç©ºé—´ä¸Šå¾ˆå¥½ç†è§£ï¼Œå› æ­¤åœ¨å†™ä»£ç çš„æ—¶å€™ï¼ŒåŸºæœ¬å°±æ˜¯çœ‹å›¾å†™ä»£ç ï¼Œæ¯”å¦‚ç”¨keraså°±æ˜¯: # ç¤ºä¾‹ä»£ç ï¼Œæ²¡æœ‰å®é™…æ„ä¹‰ model = Sequential() model.add(Conv2D(32, (3, 3), activation='relu')) # æ·»åŠ å·ç§¯å±‚ model.add(MaxPooling2D(pool_size=(2, 2))) # æ·»åŠ æ± åŒ–å±‚ model.add(Dropout(0.25)) # æ·»åŠ dropoutå±‚ model.add(Conv2D(32, (3, 3), activation='relu')) # æ·»åŠ å·ç§¯å±‚ model.add(MaxPooling2D(pool_size=(2, 2))) # æ·»åŠ æ± åŒ–å±‚ model.add(Dropout(0.25)) # æ·»åŠ dropoutå±‚ .... # æ·»åŠ å…¶ä»–å·ç§¯æ“ä½œ model.add(Flatten()) # æ‹‰å¹³ä¸‰ç»´æ•°ç»„ä¸º2ç»´æ•°ç»„ model.add(Dense(256, activation='relu')) æ·»åŠ æ™®é€šçš„å…¨è¿æ¥å±‚ model.add(Dropout(0.5)) model.add(Dense(10, activation='softmax')) .... # è®­ç»ƒç½‘ç»œ ","date":"2023-12-28","objectID":"/posts/lstm/:1:0","tags":["temporal sequences process"],"title":"é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ -- LSTM","uri":"/posts/lstm/"},{"categories":["DL"],"content":"äºŒã€LSTMç½‘ç»œ RNNç½‘ç»œçš„æœºæ„å›¾å¦‚ä¸‹å›¾æ‰€ç¤º: 2.1 RNN Architecture Overview RNN é¢ä¸´çš„é—®é¢˜:çŸ­æ—¶è®°å¿†å’Œæ¢¯åº¦æ¶ˆå¤±/æ¢¯åº¦çˆ†ç‚¸ çŸ­æ—¶è®°å¿† é—®é¢˜æè¿°ï¼šRNNåœ¨å¤„ç†é•¿åºåˆ—æ—¶ï¼Œç”±äºä¿¡æ¯çš„ä¼ é€’æ˜¯é€šè¿‡éšè—çŠ¶æ€è¿›è¡Œçš„ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¾ƒæ—©æ—¶é—´æ­¥çš„ä¿¡æ¯å¯èƒ½ä¼šåœ¨ä¼ é€’åˆ°åé¢çš„æ—¶é—´æ­¥æ—¶é€æ¸æ¶ˆå¤±æˆ–è¢«è¦†ç›–ã€‚ å½±å“ï¼šè¿™å¯¼è‡´RNNéš¾ä»¥æ•æ‰å’Œåˆ©ç”¨åºåˆ—ä¸­çš„é•¿æœŸä¾èµ–å…³ç³»ï¼Œä»è€Œé™åˆ¶äº†å…¶åœ¨å¤„ç†å¤æ‚ä»»åŠ¡æ—¶çš„æ€§èƒ½ã€‚ æ¢¯åº¦æ¶ˆå¤±/æ¢¯åº¦çˆ†ç‚¸ é—®é¢˜æè¿°ï¼šåœ¨RNNçš„åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œæ¢¯åº¦ä¼šéšç€æ—¶é—´æ­¥çš„æ¨ç§»è€Œé€æ¸æ¶ˆå¤±ï¼ˆå˜å¾—éå¸¸å°ï¼‰æˆ–çˆ†ç‚¸ï¼ˆå˜å¾—éå¸¸å¤§ï¼‰ã€‚ å½±å“ï¼šæ¢¯åº¦æ¶ˆå¤±ä½¿å¾—RNNåœ¨è®­ç»ƒæ—¶éš¾ä»¥å­¦ä¹ åˆ°é•¿æœŸä¾èµ–å…³ç³»ï¼Œå› ä¸ºè¾ƒæ—©æ—¶é—´æ­¥çš„æ¢¯åº¦ä¿¡æ¯åœ¨åå‘ä¼ æ’­åˆ°åˆå§‹å±‚æ—¶å‡ ä¹ä¸ºé›¶ã€‚æ¢¯åº¦çˆ†ç‚¸åˆ™å¯èƒ½å¯¼è‡´è®­ç»ƒè¿‡ç¨‹ä¸ç¨³å®šï¼Œæƒé‡æ›´æ–°è¿‡å¤§ï¼Œç”šè‡³å¯¼è‡´æ•°å€¼æº¢å‡ºã€‚ LSTMè§£å†³é—®é¢˜: å¤§è„‘å’ŒLSTMåœ¨å¤„ç†ä¿¡æ¯æ—¶éƒ½é€‰æ‹©æ€§åœ°ä¿ç•™é‡è¦ä¿¡æ¯ï¼Œå¿½ç•¥ä¸ç›¸å…³ç»†èŠ‚ï¼Œå¹¶æ®æ­¤è¿›è¡Œåç»­å¤„ç†ã€‚è¿™ç§æœºåˆ¶ä½¿å®ƒä»¬èƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†å’Œè¾“å‡ºå…³é”®ä¿¡æ¯ï¼Œè§£å†³äº†RNNï¼ˆé€’å½’ç¥ç»ç½‘ç»œï¼‰åœ¨å¤„ç†é•¿åºåˆ—æ—¶é¢ä¸´çš„é—®é¢˜ã€‚ å¤§è„‘è®°å¿†æœºåˆ¶ å¤§è„‘è®°å¿†æœºåˆ¶ï¼šå½“æµè§ˆè¯„è®ºæ—¶ï¼Œå¤§è„‘å€¾å‘äºè®°ä½é‡è¦çš„å…³é”®è¯ã€‚æ— å…³ç´§è¦çš„è¯æ±‡å’Œå†…å®¹å®¹æ˜“è¢«å¿½ç•¥ã€‚å›å¿†æ—¶ï¼Œå¤§è„‘æå–å¹¶è¡¨è¾¾ä¸»è¦è§‚ç‚¹ï¼Œå¿½ç•¥ç»†èŠ‚ã€‚ LSTMé—¨æ§æœºåˆ¶ï¼šLSTMé€šè¿‡è¾“å…¥é—¨ã€é—å¿˜é—¨å’Œè¾“å‡ºé—¨é€‰æ‹©æ€§åœ°ä¿ç•™æˆ–å¿˜è®°ä¿¡æ¯ï¼Œä½¿ç”¨ä¿ç•™çš„ç›¸å…³ä¿¡æ¯æ¥è¿›è¡Œé¢„æµ‹ï¼Œç±»ä¼¼äºå¤§è„‘æå–å¹¶è¡¨è¾¾ä¸»è¦è§‚ç‚¹ã€‚ å›¾2.1æ˜¯RNNå¾ªç¯ç¥ç»ç½‘ç»œç»å…¸çš„ç»“æ„å›¾ï¼ŒLSTMåªæ˜¯å¯¹éšå«å±‚èŠ‚ç‚¹Aåšäº†æ”¹è¿›ï¼Œæ•´ä½“ç»“æ„ä¸å˜ï¼Œå› æ­¤æœ¬æ–‡è®¨è®ºçš„ä¹Ÿæ˜¯è¿™ä¸ªç»“æ„çš„å¯è§†åŒ–é—®é¢˜ã€‚ ä¸­é—´çš„AèŠ‚ç‚¹éšå«å±‚ï¼Œå·¦è¾¹æ˜¯è¡¨ç¤ºåªæœ‰ä¸€å±‚éšå«å±‚çš„LSTMç½‘ç»œï¼Œæ‰€è°“LSTMå¾ªç¯ç¥ç»ç½‘ç»œå°±æ˜¯åœ¨æ—¶é—´è½´ä¸Šçš„å¾ªç¯åˆ©ç”¨ï¼Œåœ¨æ—¶é—´è½´ä¸Šå±•å¼€åå¾—åˆ°å³å›¾ã€‚ ä¸Šå›¾å³è¾¹ï¼Œæˆ‘ä»¬çœ‹Xtè¡¨ç¤ºåºåˆ—ï¼Œä¸‹æ ‡tæ˜¯æ—¶é—´è½´ï¼Œæ‰€ä»¥ï¼ŒAçš„æ•°é‡è¡¨ç¤ºçš„æ˜¯æ—¶é—´è½´çš„é•¿åº¦ï¼Œæ˜¯åŒä¸€ä¸ªç¥ç»å…ƒåœ¨ä¸åŒæ—¶åˆ»çš„çŠ¶æ€(Ht)ï¼Œä¸æ˜¯éšå«å±‚ç¥ç»å…ƒä¸ªæ•°ã€‚ æˆ‘ä»¬çŸ¥é“ï¼ŒLSTMç½‘ç»œåœ¨è®­ç»ƒæ—¶ä¼šä½¿ç”¨ä¸Šä¸€æ—¶åˆ»çš„ä¿¡æ¯ï¼ŒåŠ ä¸Šæœ¬æ¬¡æ—¶åˆ»çš„è¾“å…¥ä¿¡æ¯æ¥å…±åŒè®­ç»ƒã€‚ ä¸¾ä¸ªç®€å•çš„ä¾‹å­: åœ¨ç¬¬ä¸€å¤©æˆ‘ç”Ÿç—…äº†(åˆå§‹çŠ¶æ€H0)ï¼Œç„¶ååƒè¯(åˆ©ç”¨è¾“å…¥ä¿¡æ¯X1è®­ç»ƒç½‘ç»œ)ï¼Œç¬¬äºŒå¤©å¥½è½¬ä½†æ˜¯æ²¡æœ‰å®Œå…¨å¥½(H1)ï¼Œå†åƒè¯(X2),ç—…æƒ…å¾—åˆ°å¥½è½¬(H2),å¦‚æ­¤å¾ªç¯å¾€å¤çŸ¥é“ç—…æƒ…å¥½è½¬ã€‚å› æ­¤ï¼Œè¾“å…¥Xtæ˜¯åƒè¯ï¼Œæ—¶é—´è½´Tæ˜¯åƒå¤šå¤©çš„è¯ï¼Œéšå«å±‚çŠ¶æ€æ˜¯ç—…æƒ…çŠ¶å†µã€‚å› æ­¤æˆ‘è¿˜æ˜¯æˆ‘ï¼Œåªæ˜¯ä¸åŒçŠ¶æ€çš„æˆ‘ã€‚ å®é™…ä¸Šï¼ŒLSTMçš„ç½‘ç»œæ˜¯è¿™æ ·çš„: LSTM Network ä¸Šé¢çš„å›¾è¡¨ç¤ºåŒ…å«2ä¸ªéšå«å±‚çš„LSTMç½‘ç»œï¼Œåœ¨T=1æ—¶åˆ»çœ‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ™®é€šçš„BPç½‘ç»œï¼Œåœ¨T=2æ—¶åˆ»çœ‹ä¹Ÿæ˜¯ä¸€ä¸ªæ™®é€šçš„BPç½‘ç»œï¼Œåªæ˜¯æ²¿æ—¶é—´è½´å±•å¼€åï¼ŒT=1è®­ç»ƒçš„éšå«å±‚ä¿¡æ¯H,Cä¼šè¢«ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªæ—¶åˆ»T=2ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸Šå›¾ä¸­å‘å³çš„äº”ä¸ªå¸¸å¸¸çš„ç®­å¤´ï¼Œæ‰€æŒ‡çš„ä¹Ÿæ˜¯éšå«å±‚çŠ¶æ€åœ¨æ—¶é—´è½´ä¸Šçš„ä¼ é€’ã€‚ LSTM Architecture Overview æ³¨æ„ï¼Œå›¾ä¸­Hè¡¨ç¤ºéšè—å±‚çŠ¶æ€ï¼ŒCæ˜¯é—å¿˜é—¨ï¼Œåé¢ä¼šè®²è§£å®ƒä»¬çš„ç»´åº¦ã€‚ ","date":"2023-12-28","objectID":"/posts/lstm/:2:0","tags":["temporal sequences process"],"title":"é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ -- LSTM","uri":"/posts/lstm/"},{"categories":["DL"],"content":"2.1 LSTMçš„åŸç† RNNå·¥ä½œåŸç†:ç¬¬ä¸€ä¸ªè¯è¢«è½¬æ¢æˆäº†æœºå™¨å¯è¯»çš„å‘é‡ï¼Œç„¶å RNN é€ä¸ªå¤„ç†å‘é‡åºåˆ—ã€‚ RNN å·¥ä½œåŸç† éšè—çŠ¶æ€çš„ä¼ é€’ è¿‡ç¨‹æè¿°ï¼šåœ¨å¤„ç†åºåˆ—æ•°æ®æ—¶ï¼ŒRNNå°†å‰ä¸€æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ã€‚ ä½œç”¨ï¼šéšè—çŠ¶æ€å……å½“äº†ç¥ç»ç½‘ç»œçš„â€œè®°å¿†â€ï¼Œå®ƒåŒ…å«äº†ç½‘ç»œä¹‹å‰æ‰€è§è¿‡çš„æ•°æ®çš„ç›¸å…³ä¿¡æ¯ã€‚ é‡è¦æ€§ï¼šè¿™ç§ä¼ é€’æœºåˆ¶ä½¿å¾—RNNèƒ½å¤Ÿæ•æ‰åºåˆ—ä¸­çš„æ—¶åºä¾èµ–å…³ç³»ã€‚ å°†éšè—çŠ¶æ€ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ éšè—çŠ¶æ€çš„è®¡ç®— ç»†èƒç»“æ„ï¼šRNNçš„ä¸€ä¸ªç»†èƒæ¥æ”¶å½“å‰æ—¶é—´æ­¥çš„è¾“å…¥å’Œå‰ä¸€æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ã€‚ ç»„åˆæ–¹å¼ï¼šå½“å‰è¾“å…¥å’Œå…ˆå‰éšè—çŠ¶æ€è¢«ç»„åˆæˆä¸€ä¸ªå‘é‡ï¼Œè¿™ä¸ªå‘é‡èåˆäº†å½“å‰å’Œå…ˆå‰çš„ä¿¡æ¯ã€‚ æ¿€æ´»å‡½æ•°ï¼šç»„åˆåçš„å‘é‡ç»è¿‡ä¸€ä¸ªtanhæ¿€æ´»å‡½æ•°çš„å¤„ç†ï¼Œè¾“å‡ºæ–°çš„éšè—çŠ¶æ€ã€‚è¿™ä¸ªæ–°çš„éšè—çŠ¶æ€æ—¢åŒ…å«äº†å½“å‰è¾“å…¥çš„ä¿¡æ¯ï¼Œä¹ŸåŒ…å«äº†ä¹‹å‰æ‰€æœ‰è¾“å…¥çš„å†å²ä¿¡æ¯ã€‚ BP Network **è¾“å‡º:**æ–°çš„éšè—çŠ¶æ€è¢«è¾“å‡ºï¼Œå¹¶è¢«ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œç»§ç»­å‚ä¸åºåˆ—çš„å¤„ç†è¿‡ç¨‹ã€‚ RNNçš„ç»†èƒç»“æ„å’Œè¿ç®— LSTMå·¥ä½œåŸç†ï¼š LSTMçš„ç»†èƒç»“æ„å’Œè¿ç®— è¾“å…¥é—¨: ä½œç”¨ï¼šå†³å®šå“ªäº›æ–°ä¿¡æ¯åº”è¯¥è¢«æ·»åŠ åˆ°è®°å¿†å•å…ƒä¸­ã€‚ ç»„æˆï¼šè¾“å…¥é—¨ç”±ä¸€ä¸ªsigmoidæ¿€æ´»å‡½æ•°å’Œä¸€ä¸ªtanhæ¿€æ´»å‡½æ•°ç»„æˆã€‚sigmoidå‡½æ•°å†³å®šå“ªäº›ä¿¡æ¯æ˜¯é‡è¦çš„ï¼Œè€Œtanhå‡½æ•°åˆ™ç”Ÿæˆæ–°çš„å€™é€‰ä¿¡æ¯ã€‚ è¿ç®—ï¼šè¾“å…¥é—¨çš„è¾“å‡ºä¸å€™é€‰ä¿¡æ¯ç›¸ä¹˜ï¼Œå¾—åˆ°çš„ç»“æœå°†åœ¨è®°å¿†å•å…ƒæ›´æ–°æ—¶è¢«è€ƒè™‘ã€‚ è¾“å…¥é—¨ï¼ˆsigmoidæ¿€æ´»å‡½æ•° + tanhæ¿€æ´»å‡½æ•°ï¼‰ é—å¿˜é—¨: ä½œç”¨ï¼šå†³å®šå“ªäº›æ—§ä¿¡æ¯åº”è¯¥ä»è®°å¿†å•å…ƒä¸­é—å¿˜æˆ–ç§»é™¤ã€‚ ç»„æˆï¼šé—å¿˜é—¨ä»…ç”±ä¸€ä¸ªsigmoidæ¿€æ´»å‡½æ•°ç»„æˆã€‚ sigmoidæ¿€æ´»å‡½æ•°ï¼ˆåŒºé—´0ï½1ï¼‰ è¿ç®—ï¼šsigmoidå‡½æ•°çš„è¾“å‡ºç›´æ¥ä¸è®°å¿†å•å…ƒçš„å½“å‰çŠ¶æ€ç›¸ä¹˜ï¼Œç”¨äºå†³å®šå“ªäº›ä¿¡æ¯åº”è¯¥è¢«ä¿ç•™ï¼Œå“ªäº›åº”è¯¥è¢«é—å¿˜ã€‚è¾“å‡ºå€¼è¶Šæ¥è¿‘1çš„ä¿¡æ¯å°†è¢«ä¿ç•™ï¼Œè€Œè¾“å‡ºå€¼è¶Šæ¥è¿‘0çš„ä¿¡æ¯å°†è¢«é—å¿˜ã€‚ é—å¿˜é—¨ï¼ˆsigmoidæ¿€æ´»å‡½æ•°ï¼‰ è¾“å‡ºé—¨: ä½œç”¨ï¼šå†³å®šè®°å¿†å•å…ƒä¸­çš„å“ªäº›ä¿¡æ¯åº”è¯¥è¢«è¾“å‡ºåˆ°å½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ä¸­ã€‚ ç»„æˆï¼šè¾“å‡ºé—¨åŒæ ·ç”±ä¸€ä¸ªsigmoidæ¿€æ´»å‡½æ•°å’Œä¸€ä¸ªtanhæ¿€æ´»å‡½æ•°ç»„æˆã€‚sigmoidå‡½æ•°å†³å®šå“ªäº›ä¿¡æ¯åº”è¯¥è¢«è¾“å‡ºï¼Œè€Œtanhå‡½æ•°åˆ™å¤„ç†è®°å¿†å•å…ƒçš„çŠ¶æ€ä»¥å‡†å¤‡è¾“å‡ºã€‚ è¿ç®—ï¼šsigmoidå‡½æ•°çš„è¾“å‡ºä¸ç»è¿‡tanhå‡½æ•°å¤„ç†çš„è®°å¿†å•å…ƒçŠ¶æ€ç›¸ä¹˜ï¼Œå¾—åˆ°çš„ç»“æœå³ä¸ºå½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ã€‚ è¾“å‡ºé—¨(sigmoidæ¿€æ´»å‡½æ•° + tanhæ¿€æ´»å‡½æ•°) ","date":"2023-12-28","objectID":"/posts/lstm/:2:1","tags":["temporal sequences process"],"title":"é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ -- LSTM","uri":"/posts/lstm/"},{"categories":["DL"],"content":"ä¸‰ã€LSTMçš„è¾“å…¥ç»“æ„ ä¸ºäº†æ›´å¥½ç†è§£LSTMç»“æ„ï¼Œè¿˜å¿…é¡»ç†è§£LSTMçš„æ•°æ®è¾“å…¥æƒ…å†µã€‚ä»¿ç…§3é€šé“å›¾åƒçš„æ ·å­ï¼Œå†åŠ ä¸Šæ—¶é—´è½´åçš„å¤šæ ·æœ¬çš„å¤šç‰¹å¾çš„ä¸åŒæ—¶åˆ»çš„æ•°æ®ç«‹æ–¹ä½“å¦‚ä¸‹å›¾æ‰€ç¤º: Input Structure of LSTM Network å³è¾¹çš„å›¾æ˜¯æˆ‘ä»¬å¸¸è§æ¨¡å‹çš„è¾“å…¥ï¼Œæ¯”å¦‚XGBOOSTï¼ŒlightGBMï¼Œå†³ç­–æ ‘ç­‰æ¨¡å‹ï¼Œè¾“å…¥çš„æ•°æ®æ ¼å¼éƒ½æ˜¯è¿™ç§(NF)çš„çŸ©é˜µï¼Œè€Œå·¦è¾¹æ˜¯åŠ ä¸Šæ—¶é—´è½´åçš„æ•°æ®ç«‹æ–¹ä½“ï¼Œä¹Ÿå°±æ˜¯æ—¶é—´è½´ä¸Šçš„åˆ‡ç‰‡ï¼Œå®ƒçš„ç»´åº¦æ˜¯(NT*F),ç¬¬ä¸€ç»´åº¦æ˜¯æ ·æœ¬æ•°ï¼Œç¬¬äºŒç»´åº¦æ˜¯æ—¶é—´ï¼Œç¬¬ä¸‰ç»´åº¦æ˜¯ç‰¹å¾æ•°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º: å¤©æ°”æ•°æ®ç«‹æ–¹ä½“ è¿™æ ·çš„æ•°æ®ç«‹æ–¹ä½“å¾ˆå¤šï¼Œæ¯”å¦‚å¤©æ°”é¢„æŠ¥æ•°æ®ï¼ŒæŠŠæ ·æœ¬ç†è§£æˆåŸå¸‚ï¼Œæ—¶é—´è½´æ˜¯æ—¥æœŸï¼Œç‰¹å¾æ˜¯å¤©æ°”ç›¸å…³çš„é™é›¨é£é€ŸPM2.5ç­‰ï¼Œè¿™ä¸ªæ•°æ®ç«‹æ–¹ä½“å°±å¾ˆå¥½ç†è§£äº†ã€‚åœ¨NLPé‡Œé¢ï¼Œä¸€å¥è¯ä¼šè¢«embeddingæˆä¸€ä¸ªçŸ©é˜µï¼Œè¯ä¸è¯çš„é¡ºåºæ˜¯æ—¶é—´è½´Tï¼Œç´¢å¼•å¤šä¸ªå¥å­çš„embeddingä¸‰ç»´çŸ©é˜µå¦‚ä¸‹å›¾æ‰€ç¤º: NLP Embedding Matrix ","date":"2023-12-28","objectID":"/posts/lstm/:3:0","tags":["temporal sequences process"],"title":"é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ -- LSTM","uri":"/posts/lstm/"},{"categories":["DL"],"content":"å››ã€Pytorchä¸­çš„LSTM ","date":"2023-12-28","objectID":"/posts/lstm/:4:0","tags":["temporal sequences process"],"title":"é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ -- LSTM","uri":"/posts/lstm/"},{"categories":["DL"],"content":"4.1 Pytorchä¸­å®šä¹‰çš„LSTMæ¨¡å‹ pytorchä¸­å®šä¹‰çš„LSTMæ¨¡å‹çš„å‚æ•°å¦‚ä¸‹ class torch.nn.LSTM(*args, **kwargs) å‚æ•°æœ‰: - input_size: xçš„ç‰¹å¾ç»´åº¦ - hidden_size: éšè—å±‚çš„ç‰¹å¾ç»´åº¦ - num_layers: lstméšå±‚çš„å±‚æ•°ï¼Œé»˜è®¤ä¸º1 - bias: Falseåˆ™bihbih=0å’Œbhhbhh=0. é»˜è®¤ä¸ºTrue - batch_first: Trueåˆ™è¾“å…¥è¾“å‡ºçš„æ•°æ®æ ¼å¼ä¸º (batch, seq, feature) - dropout: é™¤æœ€åä¸€å±‚ï¼Œæ¯ä¸€å±‚çš„è¾“å‡ºéƒ½è¿›è¡Œdropoutï¼Œé»˜è®¤ä¸º: 0 - bidirectional: Trueåˆ™ä¸ºåŒå‘lstmé»˜è®¤ä¸ºFalse ç»“åˆå‰é¢çš„å›¾å½¢ï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªçœ‹ã€‚ (1)input_size: xçš„ç‰¹å¾ç»´åº¦ï¼Œå°±æ˜¯æ•°æ®ç«‹æ–¹ä½“ä¸­çš„Fï¼Œåœ¨NLPä¸­å°±æ˜¯ä¸€ä¸ªè¯è¢«embeddingåçš„å‘é‡é•¿åº¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º: LSTM Feature Matrix (2)hidden_size: éšè—å±‚çš„ç‰¹å¾ç»´åº¦(éšè—å±‚ç¥ç»å…ƒä¸ªæ•°)ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªéšå«å±‚ï¼Œæ¯ä¸ªéšè—å±‚çš„ç‰¹å¾ç»´åº¦éƒ½æ˜¯5ã€‚æ³¨æ„ï¼ŒéåŒå‘LSTMçš„è¾“å‡ºç»´åº¦ç­‰äºéšè—å±‚çš„ç‰¹å¾ç»´åº¦ã€‚ éšè—å±‚ç‰¹å¾ç»´åº¦ (3)num_layers: lstméšå±‚çš„å±‚æ•°ï¼Œä¸Šé¢çš„å›¾æˆ‘ä»¬å®šä¹‰äº†2ä¸ªéšè—å±‚ã€‚ (4)batch_first: ç”¨äºå®šä¹‰è¾“å…¥è¾“å‡ºç»´åº¦ï¼Œåé¢å†è®²ã€‚ (5)bidirectional: æ˜¯å¦æ˜¯åŒå‘å¾ªç¯ç¥ç»ç½‘ç»œï¼Œå¦‚ä¸‹å›¾æ˜¯ä¸€ä¸ªåŒå‘å¾ªç¯ç¥ç»ç½‘ç»œï¼Œå› æ­¤åœ¨ä½¿ç”¨åŒå‘LSTMçš„æ—¶å€™æˆ‘éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œæ­£å‘ä¼ æ’­çš„æ—¶å€™æœ‰(Ht, Ct),åå‘ä¼ æ’­ä¹Ÿæœ‰(Htâ€™, Ctâ€™),å‰é¢æˆ‘ä»¬è¯´äº†éåŒå‘LSTMçš„è¾“å‡ºç»´åº¦ç­‰äºéšè—å±‚çš„ç‰¹å¾ç»´åº¦ï¼Œè€ŒåŒå‘LSTMçš„è¾“å‡ºç»´åº¦æ˜¯éšå«å±‚ç‰¹å¾æ•°2ï¼Œè€Œä¸”H,Cçš„ç»´åº¦æ˜¯æ—¶é—´è½´é•¿åº¦2ã€‚ Bidirectional RNN ","date":"2023-12-28","objectID":"/posts/lstm/:4:1","tags":["temporal sequences process"],"title":"é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ -- LSTM","uri":"/posts/lstm/"},{"categories":["DL"],"content":"4.2 å–‚ç»™LSTMçš„æ•°æ®æ ¼å¼ pytorchä¸­LSTMçš„è¾“å…¥æ•°æ®æ ¼å¼é»˜è®¤å¦‚ä¸‹: input(seq_len, batch, input_size) å‚æ•°æœ‰: - seq_len: åºåˆ—é•¿åº¦ï¼Œåœ¨NLPä¸­å°±æ˜¯å¥å­é•¿åº¦ï¼Œä¸€èˆ¬éƒ½ä¼šç”¨pad_sequenceè¡¥é½é•¿åº¦ - batch: æ¯æ¬¡å–‚ç»™ç½‘ç»œçš„æ•°æ®æ¡æ•°ï¼Œåœ¨NLPä¸­å°±æ˜¯ä¸€æ¬¡å–‚ç»™ç½‘ç»œå¤šå°‘ä¸ªå¥å­ - input_size: ç‰¹å¾ç»´åº¦ï¼Œå’Œå‰é¢å®šä¹‰ç½‘ç»œç»“æ„çš„input_sizeä¸€è‡´ã€‚ å‰é¢ä¹Ÿè¯´åˆ°ï¼Œå¦‚æœLSTMçš„å‚æ•° batch_first=Trueï¼Œåˆ™è¦æ±‚è¾“å…¥çš„æ ¼å¼æ˜¯: input(batch, seq_len, input_size) åˆšå¥½è°ƒæ¢å‰é¢ä¸¤ä¸ªå‚æ•°çš„ä½ç½®ã€‚å…¶å®è¿™æ˜¯æ¯”è¾ƒå¥½ç†è§£çš„æ•°æ®å½¢å¼ï¼Œä¸‹é¢ä»¥NLPä¸­çš„embeddingå‘é‡è¯´æ˜å¦‚ä½•æ„é€ LSTMçš„è¾“å…¥ã€‚ ä¹‹å‰æˆ‘ä»¬çš„embeddingçŸ©é˜µå¦‚ä¸‹å›¾: Embedding Matrix å¦‚æœæŠŠbatchæ”¾åœ¨ç¬¬ä¸€ä½ï¼Œåˆ™ä¸‰ç»´çŸ©é˜µçš„å½¢å¼å¦‚ä¸‹: Batch First å…¶è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º: å°†ä¸‰ç»´çŸ©é˜µè½¬æ¢æˆäºŒç»´å½¢å¼ çœ‹æ‡‚äº†å—ï¼Œè¿™å°±æ˜¯è¾“å…¥æ•°æ®çš„æ ¼å¼ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚ LSTMçš„å¦å¤–ä¸¤ä¸ªè¾“å…¥æ˜¯ h0 å’Œ c0ï¼Œå¯ä»¥ç†è§£æˆç½‘ç»œçš„åˆå§‹åŒ–å‚æ•°ï¼Œç”¨éšæœºæ•°ç”Ÿæˆå³å¯ã€‚ h0(num_layers * num_directions, batch, hidden_size) c0(num_layers * num_directions, batch, hidden_size) å‚æ•°: - num_layers: éšè—å±‚æ•° - num_directions: å¦‚æœæ˜¯å•å‘å¾ªç¯ç½‘ç»œï¼Œåˆ™num_directions=1ï¼ŒåŒå‘åˆ™num_directions=2 - batch: è¾“å…¥æ•°æ®çš„batch - hidden_size: éšè—å±‚ç¥ç»å…ƒä¸ªæ•° æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰çš„inputæ ¼å¼æ˜¯: input(batch, seq_len, input_size) åˆ™Hå’ŒCçš„æ ¼å¼ä¹Ÿæ˜¯è¦å˜çš„: h0(batcï¼Œnum_layers * num_directions, h, hidden_size) c0(batcï¼Œnum_layers * num_directions, h, hidden_size) ","date":"2023-12-28","objectID":"/posts/lstm/:4:2","tags":["temporal sequences process"],"title":"é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ -- LSTM","uri":"/posts/lstm/"},{"categories":["DL"],"content":"4.3 LSTMçš„outputæ ¼å¼ LSTMçš„è¾“å‡ºæ˜¯ä¸€ä¸ªtupleï¼Œå¦‚ä¸‹: output,(ht, ct) = net(input) - output: æœ€åä¸€ä¸ªçŠ¶æ€çš„éšè—å±‚çš„ç¥ç»å…ƒè¾“å‡º - ht: æœ€åä¸€ä¸ªçŠ¶æ€çš„éšå«å±‚çš„çŠ¶æ€å€¼ - ct: æœ€åä¸€ä¸ªçŠ¶æ€çš„éšå«å±‚çš„é—å¿˜é—¨å€¼ outputçš„é»˜è®¤ç»´åº¦æ˜¯: output(seq_len, batch, hidden_size * num_directions) ht(num_layers * num_directions, batch, hidden_size) ct(num_layers * num_directions, batch, hidden_size) å’Œinputçš„æƒ…å†µç±»ä¼¼ï¼Œå¦‚æœæˆ‘ä»¬å‰é¢å®šä¹‰çš„inputæ ¼å¼æ˜¯: input(batch, seq_len, input_size) åˆ™htå’Œctçš„æ ¼å¼ä¹Ÿæ˜¯è¦å˜çš„: ht(batcï¼Œnum_layers * num_directions, h, hidden_size) ct(batcï¼Œnum_layers * num_directions, h, hidden_size) è¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹çœ‹htå’Œctåœ¨å“ªé‡Œï¼Œè¯·çœ‹ä¸‹å›¾: LSTM Network outputåœ¨å“ªé‡Œï¼Ÿè¯·çœ‹ä¸‹å›¾: è¾“å‡ºå±‚ ","date":"2023-12-28","objectID":"/posts/lstm/:4:3","tags":["temporal sequences process"],"title":"é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ -- LSTM","uri":"/posts/lstm/"},{"categories":["DL"],"content":"äº”ã€LSTMå’Œå…¶ä»–ç½‘ç»œç»„åˆ è¿˜è®°å¾—å—ï¼Œoutputçš„ç»´åº¦ç­‰äºéšè—å±‚ç¥ç»å…ƒçš„ä¸ªæ•°ï¼Œå³hidden_sizeï¼Œåœ¨ä¸€äº›æ—¶é—´åºåˆ—çš„é¢„æµ‹ä¸­ï¼Œä¼šåœ¨outputåï¼Œæ¥ä¸Šä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå…¨è¿æ¥å±‚çš„è¾“å…¥ç»´åº¦ç­‰äºLSTMçš„hidden_sizeï¼Œä¹‹åçš„ç½‘ç»œå¤„ç†å°±å’ŒBPç½‘ç»œç›¸åŒäº†ï¼Œå¦‚ä¸‹å›¾: åœ¨LSTMç½‘ç»œåæ¥ä¸Šå…¨è¿æ¥å±‚ ç”¨pytorchå®ç°ä¸Šé¢çš„ç»“æ„: import torch from torch import nn class RegLSTM(nn.Module): def __init__(self): super(RegLSTM, self).__init__() # å®šä¹‰LSTM self.rnn = nn.LSTM(input_size, hidden_size, hidden_num_layers) # å®šä¹‰å›å½’å±‚ç½‘ç»œï¼Œè¾“å…¥çš„ç‰¹å¾ç»´åº¦ç­‰äºLSTMçš„è¾“å‡ºï¼Œè¾“å‡ºç»´åº¦ä¸º1 self.reg = nn.Sequential( nn.Linear(hidden_size, 1) ) def forward(self, x): x, (ht,ct) = self.rnn(x) seq_len, batch_size, hidden_size= x.shape x = y.view(-1, hidden_size) x = self.reg(x) x = x.view(seq_len, batch_size, -1) return x å½“ç„¶ï¼Œæœ‰äº›æ¨¡å‹åˆ™æ˜¯å°†è¾“å‡ºå½“åšå¦ä¸€ä¸ªLSTMçš„è¾“å…¥ï¼Œæˆ–è€…ä½¿ç”¨éšè—å±‚ht,ctçš„ä¿¡æ¯è¿›è¡Œå»ºæ¨¡ï¼Œä¸ä¸€è€Œè¶³ã€‚ å¥½äº†ï¼Œä»¥ä¸Šå°±æ˜¯æˆ‘å¯¹LSTMçš„ä¸€äº›å­¦ä¹ å¿ƒå¾—ï¼Œçœ‹å®Œè®°å¾—å…³æ³¨ç‚¹èµã€‚ REF: [[1]. æ¼‚äº®ï¼ŒLSTMæ¨¡å‹ç»“æ„çš„å¯è§†åŒ–](https: //mp.weixin.qq.com/s?__biz=MzU1OTYzNjg5OQ==\u0026mid=2247545117\u0026idx=1\u0026sn=670ba155d94b229d39c5bf0bf20239d5\u0026chksm=fc1639d1cb61b0c72434a00454b2af8f9022e7ac3030a4186cda22ef5594ef5994620dc5fd52\u0026mpshare=1\u0026scene=1\u0026srcid=0617kfSozC3sKY1lRjYg1f0u\u0026sharer_shareinfo=6833fdea9df7fee2c423a9474c0928be\u0026sharer_shareinfo_first=6833fdea9df7fee2c423a9474c0928be#rd) [2].https: //zhuanlan.zhihu.com/p/94757947 [3].https: //zhuanlan.zhihu.com/p/59862381 [4].https: //zhuanlan.zhihu.com/p/36455374 [5].https: //www.zhihu.com/question/41949741/answer/318771336 [6].https: //blog.csdn.net/android_ruben/article/details/80206792 to be added: [7].https: //www.analyticsvidhya.com/blog/2021/01/understanding-architecture-of-lstm/ [8]. ç¥ç»ç½‘ç»œç®—æ³• - ä¸€æ–‡ææ‡‚LSTM(é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ) ","date":"2023-12-28","objectID":"/posts/lstm/:5:0","tags":["temporal sequences process"],"title":"é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ -- LSTM","uri":"/posts/lstm/"},{"categories":["C++"],"content":"çº¿ç¨‹é—´çš„å·¥ä½œåˆ’åˆ† ä¸ºäº†æé«˜çº¿ç¨‹åˆ©ç”¨ç‡å¹¶æœ€å°åŒ–å¼€é”€ï¼Œå¿…é¡»å†³å®šè¦ä½¿ç”¨çš„çº¿ç¨‹æ•°é‡ï¼Œå¹¶ä¸ºæ¯ä¸ªçº¿ç¨‹åˆç†åˆ†é…ä»»åŠ¡ ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å¼€å§‹å¤„ç†ä¹‹å‰çš„çº¿ç¨‹é—´æ•°æ®åˆ’åˆ† ç®€å•ç®—æ³•æœ€å®¹æ˜“å¹¶è¡ŒåŒ–ï¼Œæ¯”å¦‚è¦å¹¶è¡ŒåŒ– std::for_eachï¼ŒæŠŠå…ƒç´ åˆ’åˆ†åˆ°ä¸åŒçš„çº¿ç¨‹ä¸Šæ‰§è¡Œå³å¯ã€‚å¦‚ä½•åˆ’åˆ†æ‰èƒ½è·å–æœ€ä¼˜æ€§èƒ½ï¼Œå–å†³äºæ•°æ®ç»“æ„çš„ç»†èŠ‚ï¼Œè¿™é‡Œç”¨ä¸€ä¸ªæœ€ç®€å•çš„åˆ’åˆ†ä¸ºä¾‹ï¼Œæ¯ N ä¸ªå…ƒç´ åˆ†é…ç»™ä¸€ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸éœ€è¦ä¸å…¶ä»–çº¿ç¨‹é€šä¿¡ï¼Œç›´åˆ°ç‹¬ç«‹å®Œæˆå„è‡ªçš„å¤„ç†ä»»åŠ¡ å¦‚æœä½¿ç”¨è¿‡ MPI æˆ– OpenMPï¼Œä¼šå¾ˆç†Ÿæ‚‰è¿™ä¸ªç»“æ„ï¼Œå³æŠŠä¸€ä¸ªä»»åŠ¡åˆ’åˆ†æˆä¸€ç³»åˆ—å¹¶è¡Œä»»åŠ¡ï¼Œå·¥ä½œçº¿ç¨‹ç‹¬ç«‹å®Œæˆä»»åŠ¡ï¼Œæœ€å reduce åˆå¹¶ç»“æœã€‚ä¸è¿‡å¯¹ for_each æ¥è¯´ï¼Œæœ€åçš„ reduce å®é™…ä¸éœ€è¦æ‰§è¡Œæ“ä½œï¼Œä½†å¯¹å…¶ä»–éœ€è¦åˆå¹¶ç»“æœçš„å¹¶è¡Œç®—æ³•æ¥è¯´ï¼Œæœ€åä¸€æ­¥å¾ˆé‡è¦ å°½ç®¡è¿™ä¸ªæŠ€æœ¯å¾ˆå¼ºå¤§ï¼Œä½†ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæœ‰æ—¶æ•°æ®ä¸èƒ½çµæ´»åˆ’åˆ†ï¼Œåªæœ‰åœ¨å¤„ç†æ•°æ®æ—¶åˆ’åˆ†æ‰æ˜æ˜¾ï¼Œæœ€èƒ½æ˜æ˜¾ä½“ç°è¿™ç‚¹çš„å°±æ˜¯é€’å½’ç®—æ³•ï¼Œæ¯”å¦‚å¿«é€Ÿæ’åº ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:1:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"é€’å½’åˆ’åˆ†æ•°æ® è¦å¹¶è¡ŒåŒ–å¿«é€Ÿæ’åºï¼Œæ— æ³•ç›´æ¥åˆ’åˆ†æ•°æ®ï¼Œå› ä¸ºåªæœ‰å¤„ç†ä¹‹åæ‰çŸ¥é“æŸä¸€é¡¹åº”è¯¥ç½®äºåŸºæ•°çš„å“ªä¸€è¾¹ã€‚å› æ­¤ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°çš„æ˜¯ä½¿ç”¨é€’å½’ï¼Œå…¶ä¸­çš„é€’å½’è°ƒç”¨å®Œå…¨ç‹¬ç«‹ï¼Œå„è‡ªå¤„ç†ä¸åŒçš„å…ƒç´ é›†ï¼Œååˆ†é€‚åˆå¹¶å‘æ‰§è¡Œ å¦‚æœæ•°æ®é›†å¾ˆå¤§ï¼Œä¸ºæ¯ä¸ªé€’å½’ç”Ÿæˆæ–°çº¿ç¨‹å°±ä¼šç”Ÿæˆå¤§é‡çº¿ç¨‹ï¼Œå¦‚æœçº¿ç¨‹è¿‡å¤šå°±ä¼šå½±å“æ€§èƒ½ã€‚å› æ­¤éœ€è¦ä¸¥æ ¼æ§åˆ¶çº¿ç¨‹æ•°ï¼Œä¸è¿‡è¿™ä¸ªé—®é¢˜å¯ä»¥ç›´æ¥æŠ›ç»™ std::async #include \u003calgorithm\u003e #include \u003cfuture\u003e #include \u003clist\u003e template \u003ctypename T\u003e std::list\u003cT\u003e parallel_quick_sort(std::list\u003cT\u003e v) { if (v.empty()) { return {}; } std::list\u003cT\u003e res; res.splice(res.begin(), v, v.begin()); auto it = std::partition(v.begin(), v.end(), [\u0026](const T\u0026 x) { return x \u003c res.front(); }); std::list\u003cT\u003e low; low.splice(low.end(), v, v.begin(), it); std::future\u003cstd::list\u003cT\u003e\u003e l( std::async(\u0026parallel_quick_sort\u003cT\u003e, std::move(low))); auto r(parallel_quick_sort(std::move(v))); res.splice(res.end(), r); res.splice(res.begin(), l.get()); return res; } ä¹Ÿå¯ä»¥é€šè¿‡ hardware_concurrency å¾—çŸ¥ç¡¬ä»¶å¯æ”¯æŒçš„çº¿ç¨‹æ•°ï¼Œå†è‡ªå·±ç®¡ç†çº¿ç¨‹æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ stack å­˜å‚¨å·²æ’åºæ•°æ®çš„å¹¶è¡Œå¿«é€Ÿæ’åº #include \u003calgorithm\u003e #include \u003catomic\u003e #include \u003cfuture\u003e #include \u003clist\u003e #include \u003cmemory\u003e #include \u003cthread\u003e #include \u003cvector\u003e #include \"concurrent_stack.hpp\" template \u003ctypename T\u003e class Sorter { public: Sorter() : max_thread_count(std::thread::hardware_concurrency() - 1) {} ~Sorter() { end_of_data = true; for (auto\u0026 x : threads) { if (x.joinable()) { x.join(); } } } std::list\u003cT\u003e do_sort(std::list\u003cT\u003e\u0026 v) { if (v.empty()) { return {}; } std::list\u003cT\u003e res; res.splice(res.begin(), v, v.begin()); auto it = std::partition(v.begin(), v.end(), [\u0026](const T\u0026 x) { return x \u003c res.front(); }); ChunkToSort low; low.data.splice(low.data.end(), v, v.begin(), it); std::future\u003cstd::list\u003cT\u003e\u003e l = low.promise.get_future(); chunks.push(std::move(low)); if (threads.size() \u003c max_thread_count) { threads.emplace_back(\u0026Sorter\u003cT\u003e::sort_thread, this); } auto r{do_sort(v)}; res.splice(res.end(), r); while (l.wait_for(std::chrono::seconds(0)) != std::future_status::ready) { try_sort_chunk(); } res.splice(res.begin(), l.get()); return res; } private: struct ChunkToSort { std::list\u003cT\u003e data; std::promise\u003cstd::list\u003cT\u003e\u003e promise; }; private: void sort_chunk(const std::shared_ptr\u003cChunkToSort\u003e\u0026 chunk) { chunk-\u003epromise.set_value(do_sort(chunk-\u003edata)); } void try_sort_chunk() { std::shared_ptr\u003cChunkToSort\u003e chunk = chunks.pop(); if (chunk) { sort_chunk(chunk); } } void sort_thread() { while (!end_of_data) { try_sort_chunk(); std::this_thread::yield(); } } private: ConcurrentStack\u003cChunkToSort\u003e chunks; std::vector\u003cstd::thread\u003e threads; const std::size_t max_thread_count; std::atomic\u003cbool\u003e end_of_data = false; }; template \u003ctypename T\u003e std::list\u003cT\u003e parallel_quick_sort(std::list\u003cT\u003e v) { if (v.empty()) { return {}; } return Sorter\u003cT\u003e{}.do_sort(v); } ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:1:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"åŸºäºä»»åŠ¡åˆ’åˆ† å¦‚æœæ•°æ®åŠ¨æ€ç”Ÿæˆæˆ–æ¥è‡ªå¤–éƒ¨è¾“å…¥ï¼Œä¸Šè¿°åˆ’åˆ†æ–¹å¼éƒ½ä¸é€‚ç”¨ï¼Œæ­¤æ—¶åº”è¯¥åŸºäºä»»åŠ¡è€ŒéåŸºäºæ•°æ®æ¥åˆ’åˆ†ã€‚ä¸€ç§åŸºäºä»»åŠ¡çš„åˆ’åˆ†æ–¹å¼æ˜¯è®©çº¿ç¨‹é’ˆå¯¹æ€§å¤„ç†ä»»åŠ¡ï¼Œå¯¹åŒä¸€æ•°æ®è¿›è¡Œä¸åŒçš„æ“ä½œï¼Œè€Œä¸æ˜¯éƒ½åšç›¸åŒçš„å·¥ä½œã€‚è¿™æ ·çº¿ç¨‹æ˜¯ç‹¬ç«‹çš„ï¼Œæ¯ä¸ªçº¿ç¨‹åªéœ€è¦è´Ÿè´£å®Œæˆæ€»ä»»åŠ¡çš„æŸä¸€éƒ¨åˆ†ã€‚è¿™å°±æ˜¯ SoCï¼ˆseparation of concernsï¼Œå…³æ³¨ç‚¹åˆ†ç¦»ï¼‰è®¾è®¡åŸåˆ™ å•çº¿ç¨‹ä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªä»»åŠ¡éœ€è¦æ‰§è¡Œï¼Œåªèƒ½ä¾æ¬¡æ‰§è¡Œä»»åŠ¡ï¼Œä»»åŠ¡éœ€è¦ä¿å­˜å®ŒæˆçŠ¶æ€ï¼Œå¹¶å‘¨æœŸæ€§åœ°è¿”å›æ§åˆ¶æµç»™ä¸»å¾ªç¯ã€‚å¦‚æœå¾ªç¯ä¸­æ·»åŠ äº†å¾ˆå¤šä»»åŠ¡ï¼Œå°±ä¼šå¯¼è‡´ç¨‹åºå˜æ…¢ï¼Œå¯¹äºä¸€ä¸ªç”¨æˆ·å‘èµ·çš„äº‹ä»¶å¯èƒ½å¾ˆä¹…æ‰ä¼šå“åº” è¿™å°±æ˜¯ä½¿ç”¨çº¿ç¨‹çš„åŸå› ï¼Œå¦‚æœæ¯ä¸ªä»»åŠ¡åˆ†ç¦»åœ¨çº¿ç¨‹ä¸Šï¼Œä¿å­˜çŠ¶æ€å’Œè¿”å›æ§åˆ¶æµç»™ä¸»å¾ªç¯è¿™äº›äº‹éƒ½æŠ›ç»™äº†æ“ä½œç³»ç»Ÿï¼Œæ­¤æ—¶åªéœ€è¦å…³æ³¨ä»»åŠ¡æœ¬èº«ï¼Œå¹¶ä¸”ä»»åŠ¡è¿˜å¯ä»¥å¹¶å‘è¿è¡Œï¼Œè¿™æ ·ç”¨æˆ·ä¹Ÿèƒ½åŠæ—¶å¾—åˆ°å“åº” ä½†ç°å®ä¸ä¸€å®šè¿™ä¹ˆé¡ºåˆ©ã€‚å¦‚æœä»»åŠ¡éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œçº¿ç¨‹ä¹‹é—´ä¸éœ€è¦é€šä¿¡ï¼Œé‚£å°±å¾ˆç®€å•äº†ã€‚ç„¶è€Œï¼Œè¿™äº›åå°è¿è¡Œçš„ä»»åŠ¡ç»å¸¸éœ€è¦å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œå› æ­¤å°±éœ€è¦åœ¨å®Œæˆæ—¶æ›´æ–°ç”¨æˆ·æ¥å£ï¼Œä»¥é€šçŸ¥ç”¨æˆ·ã€‚æ­¤å¤–ï¼Œç”¨æˆ·è¿˜å¯èƒ½æƒ³å–æ¶ˆä»»åŠ¡ï¼Œè¿™æ ·å°±éœ€è¦ç”¨æˆ·æ¥å£å‘é€ä¸€æ¡é€šçŸ¥åå°ä»»åŠ¡ç»ˆæ­¢çš„æ¶ˆæ¯ã€‚è¿™äº›æƒ…å†µéƒ½è¦æ±‚å‘¨å…¨çš„è€ƒè™‘å’Œè®¾è®¡ï¼Œä»¥åŠåˆé€‚çš„åŒæ­¥ è™½ç„¶å¦‚æ­¤ï¼Œä½†å…³æ³¨ç‚¹ä»ç„¶æ˜¯åˆ†ç¦»çš„ã€‚ç”¨æˆ·æ¥å£çº¿ç¨‹çº¿ç¨‹ä»å¤„ç†ç”¨æˆ·æ¥å£ï¼Œåªæ˜¯å¯èƒ½åœ¨è¢«å…¶ä»–çº¿ç¨‹è¯·æ±‚æ—¶è¦æ›´æ–°æ¥å£ã€‚åŒç†ï¼Œåå°ä»»åŠ¡çº¿ç¨‹ä»ç„¶å…³æ³¨è‡ªå·±çš„ä»»åŠ¡ï¼Œåªæ˜¯å…è®¸è¢«å…¶ä»–çº¿ç¨‹è¯·æ±‚ç»ˆæ­¢ å¤šçº¿ç¨‹ä¸æ˜¯ä¸€å®šè¦ SoCï¼Œæ¯”å¦‚çº¿ç¨‹é—´æœ‰å¾ˆå¤šå…±äº«æ•°æ®ï¼Œæˆ–è€…éœ€è¦äº’ç›¸ç­‰å¾…ã€‚å¯¹äºè¿™æ ·å­˜åœ¨è¿‡å¤šé€šä¿¡çš„çº¿ç¨‹ï¼Œåº”è¯¥å…ˆæ‰¾å‡ºé€šä¿¡çš„åŸå› ï¼Œå¦‚æœæ‰€æœ‰çš„é€šä¿¡éƒ½å…³è”åŒä¸€ä¸ªé—®é¢˜ï¼Œåˆå¹¶æˆä¸€ä¸ªå•çº¿ç¨‹æ¥å¤„ç†å¯èƒ½æ›´å¥½ä¸€äº› åŸºäºä»»åŠ¡åˆ’åˆ†ä¸è¦æ±‚å®Œå…¨éš”ç¦»ï¼Œå¦‚æœå¤šä¸ªè¾“å…¥æ•°æ®é›†åˆé€‚ç”¨ç›¸åŒé¡ºåºçš„æ“ä½œï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ“ä½œåºåˆ—åˆ’åˆ†ä¸ºå¤šä¸ªå­é˜¶æ®µæ¥åˆ†é…ç»™æ¯ä¸ªçº¿ç¨‹ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å®Œæˆæ“ä½œåå°±æŠŠæ•°æ®æ”¾è¿›é˜Ÿåˆ—ï¼Œä¾›ä¸‹ä¸€çº¿ç¨‹ä½¿ç”¨ï¼Œè¿™å°±æ˜¯ pipelineã€‚è¿™ä¹Ÿæ˜¯å¦ä¸€ç§åˆ’åˆ†æ•°æ®çš„æ–¹å¼ï¼Œé€‚ç”¨äºæ“ä½œå¼€å§‹å‰è¾“å…¥æ•°æ®ä¸æ˜¯å®Œå…¨å·²çŸ¥çš„æƒ…å†µï¼Œæ¯”å¦‚æ¥è‡ªç½‘ç»œçš„æ•°æ®æˆ–è€…æ‰«ææ–‡ä»¶ç³»ç»Ÿä»¥è¯†åˆ«è¦å¤„ç†çš„æ–‡ä»¶ å¯¹äºåºåˆ—ä¸­è€—æ—¶çš„æ“ä½œï¼Œpipeline å°±èƒ½æé«˜å“åº”é€Ÿåº¦ã€‚æ¯”å¦‚ï¼Œå¦‚æœæ“ä½œåŒ…å« 4 æ­¥ï¼Œæ¯æ­¥ 5 ç§’ï¼Œå¤„ç†å®Œä¸€ä¸ªæ•°æ®å°±è¦ 20ç§’ï¼Œå¦‚æœæœ‰ 4 ä¸ªåŒ…å«æ•´ä¸ªæ“ä½œçš„çº¿ç¨‹ï¼Œè™½ç„¶æ¯ 20 ç§’èƒ½å¤„ç† 4 ä¸ªæ•°æ®ï¼Œä½†æ¯ä¸ªæ•°æ®ä»è¦ 20 ç§’å¤„ç†ã€‚ä½¿ç”¨ pipelineï¼Œæ¯ä¸ªçº¿ç¨‹åªå¤„ç†ä¸€æ­¥ï¼Œå¯¹äºç¬¬ä¸€ä¸ªæ•°æ®éœ€è¦ 20 ç§’å¤„ç†ï¼Œä¹‹åå¤„ç†æ¯ä¸ªæ•°æ®éƒ½åªéœ€è¦ 5 ç§’ // é pipelineï¼šæ¯ 20 ç§’ 4 ä¸ªæ•°æ®ï¼ˆæ¯ä¸ªæ•°æ®ä»è¦ 20 ç§’ï¼‰ çº¿ç¨‹Aï¼š-1- -1- -1- -1- -5- -5- -5- -5- çº¿ç¨‹Bï¼š-2- -2- -2- -2- -6- -6- -6- -6- çº¿ç¨‹Cï¼š-3- -3- -3- -3- -7- -7- -7- -7- çº¿ç¨‹Dï¼š-4- -4- -4- -4- -8- -8- -8- -8- // pipelineï¼šç¬¬ä¸€ä¸ªæ•°æ® 20 ç§’ï¼Œä¹‹åæ¯ä¸ª 5 ç§’ çº¿ç¨‹Aï¼š-1- -2- -3- -4- -5- -6- -7- -8- çº¿ç¨‹Bï¼š--- -1- -2- -3- -4- -5- -6- -7- çº¿ç¨‹Cï¼š--- --- -1- -2- -3- -4- -5- -6- çº¿ç¨‹Dï¼š--- --- --- -1- -2- -3- -4- -5- ä»¥è§†é¢‘è§£ç ä¸ºä¾‹ï¼Œæ¯ 4 ç§’ 120 å¸§ï¼Œç¬¬ä¸€ç§’è¾¾åˆ° 120 å¸§ï¼Œå¡é¡¿ 3 ç§’åæ’­æ”¾ä¸‹ä¸€ä¸ª 120 å¸§ï¼Œè¿™æ ·è¿œä¸å¦‚ç¨³å®šçš„æ¯ç§’ 30 å¸§ ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:1:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å½±å“å¹¶å‘ä»£ç æ€§èƒ½çš„å› ç´  ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å¤„ç†å™¨æ•°é‡ å¤„ç†å™¨æ•°é‡æ˜¯å½±å“å¤šçº¿ç¨‹ç¨‹åºæ€§èƒ½çš„é¦–è¦å› ç´ ï¼Œä¸€ä¸ªå¹¶å‘ç¨‹åºåœ¨ä¸åŒç¯å¢ƒä¸‹çš„è¡¨ç°è¿¥å¼‚ï¼Œè€Œå¼€å‘è€…çš„ç¯å¢ƒå’Œç”¨æˆ·å¾ˆå¯èƒ½ä¸åŒï¼Œæ¯”å¦‚å¼€å‘ç¯å¢ƒæ˜¯åŒæ ¸æˆ–å››æ ¸ç³»ç»Ÿï¼Œä½†ç”¨æˆ·æ˜¯ä»»æ„å¤šæ ¸æˆ–å•æ ¸ï¼Œå› æ­¤å¿…é¡»è°¨æ…è€ƒè™‘å¯èƒ½çš„å½±å“å¹¶å¯¹å…¶æµ‹è¯• å•ä¸ª 16 æ ¸ã€4 ä¸ªå››æ ¸ã€16 ä¸ªå•æ ¸æ˜¯è¿‘ä¼¼çš„ï¼Œéƒ½èƒ½å¹¶å‘è¿è¡Œ 16 ä¸ªçº¿ç¨‹ï¼Œè¦åˆ©ç”¨å¥½è¿™ç‚¹ï¼Œå¼€å‘çš„ç¨‹åºå¿…é¡»è‡³å°‘ç”¨ä¸Š 16 ä¸ªçº¿ç¨‹ã€‚å¦‚æœå°‘äº 16 ä¸ªï¼Œå°±ä¼šæµªè´¹å¤„ç†å™¨æ€§èƒ½ï¼ˆä¸è€ƒè™‘ç³»ç»Ÿè¿è¡Œå…¶ä»–ç¨‹åºçš„æƒ…å†µï¼‰ï¼Œå¦ä¸€æ–¹é¢ï¼Œå¦‚æœå¤šäº 16 ä¸ªï¼Œå°±ä¼šè®©å¤„ç†å™¨æµªè´¹æ—¶é—´åœ¨åˆ‡æ¢çº¿ç¨‹ä¸Šï¼Œè¿™ç§æƒ…å†µå°±æ˜¯ oversubscription ä½¿ç”¨ hardware_concurrency å¯ä»¥è·å–ç¡¬ä»¶æ”¯æŒçš„çº¿ç¨‹æ•°ï¼Œä½†è¦æ³¨æ„å®ƒä¸ä¼šè€ƒè™‘å·²è¿è¡Œåœ¨ç³»ç»Ÿä¸Šçš„å…¶ä»–çº¿ç¨‹ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹éƒ½ç”¨å®ƒç»™å‡ºçš„çº¿ç¨‹æ•°ï¼Œå°±ä¼šå¯¼è‡´å·¨å¤§çš„ oversubscriptionã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥æŠ›ç»™ std::asyncï¼Œå®ƒä¼šé€‚åº¦å¤„ç†å¹¶å®‰æ’æ‰€æœ‰è°ƒç”¨ã€‚è¿™ä¸ªé—®é¢˜ä¹Ÿèƒ½ç”¨çº¿ç¨‹æ± è§£å†³ éšç€å¤„ç†å™¨æ•°é‡å¢åŠ ï¼Œå¦ä¸€ä¸ªå½±å“æ€§èƒ½çš„é—®é¢˜ä¹Ÿéšä¹‹è€Œæ¥ï¼Œå³å¤šå¤„ç†å™¨å°è¯•è®¿é—®åŒä¸€æ•°æ® ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:2:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"ä¹’ä¹“ç¼“å­˜ï¼ˆcache ping-pongï¼‰ å¦‚æœä¸¤ä¸ªçº¿ç¨‹åœ¨ä¸åŒå¤„ç†å™¨ä¸Šå¹¶å‘æ‰§è¡Œï¼Œè¯»å–åŒä¸€æ•°æ®ä¸€èˆ¬ä¸ä¼šå¸¦æ¥é—®é¢˜ï¼Œæ•°æ®å°†æ‹·è´åˆ°å®ƒä»¬çš„ cacheï¼Œå¤„ç†å™¨å¯ä»¥åŒæ—¶å¤„ç†ã€‚ä½†å¦‚æœä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹æ•°æ®ï¼Œè¿™ä¸ªä¿®æ”¹ä¼ ç»™å…¶ä»–æ ¸çš„ cache å°±éœ€è¦èŠ±è´¹æ—¶é—´ï¼Œä»è€Œå¯èƒ½å¯¼è‡´ç¬¬äºŒä¸ªå¤„ç†å™¨åœæ­¢ä»¥ç­‰å¾…æ”¹å˜ä¼ åˆ°å†…å­˜ç¡¬ä»¶ï¼ˆå–å†³äºä¸¤ä¸ªçº¿ç¨‹ä¸Šçš„æ“ä½œå’Œè¿™ä¸ªæ“ä½œä½¿ç”¨çš„å†…å­˜åºï¼‰ã€‚ä» CPU æŒ‡ä»¤çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸ªæ“ä½œæ…¢åˆ°æƒŠäººï¼Œç­‰ä»·äºæ•°ç™¾ä¸ªç‹¬ç«‹æŒ‡ä»¤ï¼ˆå…·ä½“å–å†³äºç¡¬ä»¶çš„ç‰©ç†ç»“æ„ï¼‰ std::atomic\u003cstd::size_t\u003e n(0); void f() { // ä»»ä½•çº¿ç¨‹éƒ½èƒ½è°ƒç”¨ // æ¯æ¬¡nè‡ªå¢ï¼Œå¤„ç†å™¨éƒ½è¦ç¡®ä¿ cache ä¸­çš„æ‹·è´æ˜¯æœ€æ–°çš„ // ä¿®æ”¹å€¼åå†å‘ŠçŸ¥å…¶ä»–å¤„ç†å™¨ // fetch_add æ˜¯è¯»æ”¹å†™æ“ä½œï¼Œæ¯æ¬¡éƒ½è¦æ£€ç´¢æœ€æ–°å€¼ // å¦‚æœå¦ä¸€çº¿ç¨‹åœ¨å¦ä¸€å¤„ç†å™¨è¿è¡Œæ­¤ä»£ç  // n çš„æ•°æ®å°±è¦åœ¨ä¸¤ä¸ªå¤„ç†å™¨ä¹‹é—´æ¥å›ä¼ é€’ // è¿™æ · n å¢åŠ æ—¶ä¸¤ä¸ªå¤„ç†å™¨çš„ cache æ‰èƒ½æœ‰æœ€æ–°å€¼ while (n.fetch_add(1, std::memory_order_relaxed) \u003c 100000000) { task(); // å¦‚æœå¾ˆå¿«å®Œæˆæˆ–è€…æœ‰å¾ˆå¤šå¤„ç†å™¨è¿è¡Œæ­¤ä»£ç ï¼Œå¤„ç†å™¨å°±è¦äº’ç›¸ç­‰å¾… // ä¸€ä¸ªå¤„ç†å™¨åœ¨æ›´æ–°å€¼ï¼Œå¦ä¸€ä¸ªæ›´æ–°å€¼çš„å¤„ç†å™¨å°±è¦ç­‰å¾… // ç›´åˆ°ç¬¬ä¸€ä¸ªæ›´æ–°å®Œæˆå¹¶æŠŠæ”¹å˜ä¼ è¿‡æ¥ // è¿™ç§æƒ…å†µå°±æ˜¯ high contention // åä¹‹å¤„ç†å™¨å¾ˆå°‘è¦äº’ç›¸ç­‰å¾…çš„æƒ…å†µå°±æ˜¯ low contention // åœ¨ç±»ä¼¼è¿™æ ·çš„å¾ªç¯ä¸­ï¼Œn çš„æ•°æ®åœ¨ cache ä¹‹é—´æ¥å›ä¼ é€’ // è¿™å°±æ˜¯ cache ping-pong } } å¦‚æœå¤„ç†å™¨ç”±äºç­‰å¾… cache è½¬ç§»è€ŒæŒ‚èµ·ï¼Œå°±åªèƒ½å¹²ç­‰ç€è€Œä¸èƒ½åšä»»ä½•å·¥ä½œã€‚ä¸Šä¾‹çš„æƒ…å†µå¯èƒ½ä¸å¸¸è§ï¼Œä½†æœ‰ä¸€äº›å’Œä¸Šä¾‹æ²¡æœ‰æœ¬è´¨åŒºåˆ«çš„å¸¸è§æƒ…å†µï¼Œæ¯”å¦‚åœ¨å¾ªç¯ä¸­è·å– mutex std::mutex m; void f() { while (true) { std::lock_guard\u003cstd::mutex\u003e l(m); // ç°åœ¨éœ€è¦æ¥å›ä¼ é€’çš„æ˜¯ m if (done_processing(data)) { break; } } } è¦é¿å…ä¹’ä¹“ç¼“å­˜ï¼Œå°±è¦å°½é‡å‡å°‘å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€å†…å­˜ä½ç½®çš„ç«äº‰ã€‚ä½†å³ä½¿ä¸€ä¸ªç‰¹å®šå†…å­˜ä½ç½®åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œä»ç„¶å¯èƒ½å­˜åœ¨ä¹’ä¹“ç¼“å­˜ï¼ŒåŸå› å°±æ˜¯ä¼ªå…±äº« ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:2:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"ä¼ªå…±äº«ï¼ˆfalse sharingï¼‰ å¤„ç†å™¨ cache ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œæ˜¯ä»¥ cache line ä½œä¸ºæœ€å°å•ä½ï¼Œä¸€èˆ¬ä¸º 32 æˆ– 64 å­—èŠ‚ï¼Œå› æ­¤å°æ•°æ®å¯èƒ½ä½äºåŒä¸€ cache lineã€‚æœ‰æ—¶è¿™æ˜¯å¥½äº‹ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è®¿é—®çš„æ•°æ®éƒ½ä½äºåŒä¸€ cache lineï¼Œæ€§èƒ½ä¼šæ¯”åˆ†æ•£åœ¨å¤šä¸ª cache line å¥½ã€‚ä½†å¦‚æœ cache line ä¸­çš„æ•°æ®é¡¹ä¸ç›¸å…³ï¼Œéœ€è¦è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œå°±ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ å‡å¦‚æœ‰ä¸€ä¸ª int æ•°ç»„ï¼Œä¸€ç»„çº¿ç¨‹é¢‘ç¹è®¿é—®å’Œæ›´æ–°å…¶ä¸­çš„æ•°æ®ã€‚é€šå¸¸ int å¤§å°ä¸è¶…è¿‡ä¸€ä¸ª cache lineï¼Œå› æ­¤ä¸€ä¸ª cache line å¯ä»¥å­˜å‚¨å¤šä¸ªæ•°æ®é¡¹ï¼Œæ­¤æ—¶å³ä½¿æ¯ä¸ªçº¿ç¨‹åªè®¿é—®è‡ªå·±éœ€è¦çš„æ•°æ®ï¼Œcache ç¡¬ä»¶ä¹Ÿä¼šé€ æˆä¹’ä¹“ç¼“å­˜ã€‚æ¯”å¦‚è®¿é—® 0 å·æ•°æ®çš„çº¿ç¨‹è¦æ›´æ–°æ•°æ®ï¼Œcache line çš„æ‰€æœ‰æƒå°±è¦è¢«è½¬ç§»åˆ°è¿è¡Œè¿™ä¸ªçº¿ç¨‹çš„å¤„ç†å™¨ æ•°æ®å¯èƒ½ä¸å…±äº«ï¼Œä½† cache line æ˜¯å…±äº«çš„ï¼Œè¿™å°±æ˜¯ä¼ªå…±äº«ã€‚è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œæ„é€ æ•°æ®ï¼Œè®©èƒ½è¢«åŒä¸€çº¿ç¨‹è®¿é—®çš„æ•°æ®é¡¹ä½äºå†…å­˜ä¸­çš„ä¸´è¿‘ä½ç½®ï¼Œè®©èƒ½è¢«ä¸åŒçº¿ç¨‹è®¿é—®çš„æ•°æ®åœ¨å†…å­˜ä¸­ç›¸è·å¾ˆè¿œã€‚C++17 æä¾›äº† std::hardware_destructive_interference_size æ¥æŒ‡å®šå½“å‰ç¼–è¯‘ç›®æ ‡ä¼ªå…±äº«çš„æœ€å¤§è¿ç»­å­—èŠ‚æ•°ï¼Œåªè¦æ•°æ®é—´éš”å¤§äºæ­¤å­—èŠ‚æ•°å°±å¯ä»¥é¿å…ä¼ªå…±äº« ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:2:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"data proximity é€ æˆä¼ªå…±äº«çš„åŸå› æ˜¯ä¸¤ä¸ªçº¿ç¨‹è®¿é—®çš„æ•°æ®è¿‡äºæ¥è¿‘ï¼Œç›¸åº”çš„ï¼Œç›´æ¥å½±å“å•çº¿ç¨‹çš„æ€§èƒ½åˆ™æ˜¯æ•°æ®å¸ƒå±€ã€‚å¦‚æœå•çº¿ç¨‹è®¿é—®çš„æ•°æ®åˆ†æ•£åœ¨å†…å­˜ä¸­ï¼Œå°±ç±»ä¼¼ä½äºä¸åŒçš„ cache lineï¼Œå¦‚æœåœ¨å†…å­˜ä¸­ååˆ†é è¿‘ï¼Œå°±ç±»ä¼¼ä½äºåŒä¸€ cache lineã€‚å¦‚æœæ•°æ®æ˜¯åˆ†æ•£çš„ï¼Œå°±éœ€è¦ä»å†…å­˜åŠ è½½æ›´å¤šçš„ cache line åˆ°å¤„ç†å™¨ cacheï¼Œè¿™å°±ä¼šå¢åŠ å†…å­˜è®¿é—®å»¶è¿Ÿå¹¶é™ä½æ€§èƒ½ å¦‚æœæ•°æ®æ˜¯åˆ†æ•£çš„ï¼Œä¸€ä¸ªåŒ…å«å½“å‰çº¿ç¨‹æ•°æ®çš„ cache lineå¾ˆå¯èƒ½ä¼šåŒ…å«éå½“å‰çº¿ç¨‹çš„æ•°æ®ï¼Œæç«¯æƒ…å†µä¸‹ï¼Œcache ä¸­å°†åŒ…å«å¾ˆå¤šä¸éœ€è¦çš„æ•°æ®ï¼Œè¿™å°±ä¼šæµªè´¹å®è´µçš„ cache ç©ºé—´å¹¶å¢åŠ å¤„ç†å™¨ cache miss çš„æ¦‚ç‡ï¼Œå¯¼è‡´å¿…é¡»ä»ä¸»å­˜è·å–æ•°æ®ã€‚è€Œè¿™ä¸ªæ•°æ®å¯èƒ½æ›¾åœ¨ cache ä¸­ä¿ç•™è¿‡ï¼Œä½†ä¸ºäº†ç»™å…¶ä»–æ•°æ®è®©å‡ºç©ºé—´å¿…é¡»ä» cache ä¸­ç§»é™¤ è¿™çœ‹ä¸Šå»åªå¯¹å•çº¿ç¨‹å¾ˆé‡è¦ï¼Œä½†å…¶å®å¯¹å¤šçº¿ç¨‹ä¹Ÿå¾ˆé‡è¦ï¼ŒåŸå› åœ¨äºä»»åŠ¡åˆ‡æ¢ï¼ˆtask switchingï¼‰ã€‚å¦‚æœçº¿ç¨‹æ•°è¶…è¿‡æ ¸æ•°ï¼Œå°±ä¸€å®šä¼šæœ‰æ ¸è¦è¿è¡Œå¤šçº¿ç¨‹ï¼Œè¿™å°±å¢åŠ äº† cache çš„å‹åŠ›ï¼Œå› ä¸ºä¸ºäº†é¿å…ä¼ªå…±äº«å¿…é¡»ç¡®ä¿ä¸åŒçš„çº¿ç¨‹è®¿é—®ä¸åŒçš„ cache lineï¼Œå½“å¤„ç†å™¨åˆ‡æ¢çº¿ç¨‹æ—¶ï¼Œå¦‚æœæ•°æ®åˆ†æ•£ï¼Œå¾ˆå¯èƒ½ä¼šé‡æ–°è½½å…¥ cache lineã€‚C++17 æä¾›äº†std::hardware_constructive_interference_size æ¥æŒ‡å®šä¿è¯åŒä¸€ cache line çš„æœ€å¤§è¿ç»­å­—èŠ‚æ•°ï¼Œå¦‚æœæ•°æ®å°ºå¯¸å°äºæ­¤å­—èŠ‚æ•°å°±èƒ½é™ä½ cache miss çš„å‡ ç‡ å¦‚æœçº¿ç¨‹æ•°è¶…è¿‡å¤„ç†å™¨æ ¸æ•°ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šè°ƒåº¦çº¿ç¨‹ï¼Œåœ¨æŸä¸ªæ—¶é—´ç‰‡ä¸Šç»™ä¸€ä¸ªæ ¸ï¼Œåœ¨ä¸‹ä¸€ä¸ªæ—¶é—´ç‰‡ä¸Šç»™å¦ä¸€ä¸ªæ ¸ï¼Œè¿™å°±è¦æ±‚æŠŠç¬¬ä¸€ä¸ªæ ¸çš„ cache ä¼ ç»™ç¬¬äºŒä¸ªï¼Œä»è€Œå¢åŠ äº†æ—¶é—´å¼€é”€ã€‚è™½ç„¶æ“ä½œç³»ç»Ÿä¸€èˆ¬ä¼šå°½é‡é¿å…è¿™ç‚¹ï¼Œä½†å¦‚æœå‘ç”Ÿäº†å°±ä¼šå¯¹æ€§èƒ½é€ æˆå½±å“ å½“å¤§é‡çº¿ç¨‹å‡†å¤‡è¿è¡Œè€Œéç­‰å¾…æ—¶ï¼Œå°±ä¼šç»å¸¸å‡ºç°ä»»åŠ¡åˆ‡æ¢é—®é¢˜ï¼Œè¿™ç§å¤„ç†å™¨åœ¨ä»»åŠ¡åˆ‡æ¢ä¸ŠèŠ±è´¹å¤§é‡æ—¶é—´çš„æƒ…å†µå°±æ˜¯ oversubscription ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:2:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"oversubscription è¶…é¢ç”³è¯· çº¿ç¨‹ç»å¸¸èŠ±è´¹æ—¶é—´æ¥ç­‰å¾…é¢å¤–çš„ I/Oã€mutex é˜»å¡ã€æ¡ä»¶å˜é‡ï¼Œå› æ­¤ä½¿ç”¨è¶…è¿‡å¤„ç†å™¨æ ¸æ•°çš„çº¿ç¨‹ä»¥ç¡®ä¿æ²¡æœ‰é—²ç½®çš„å¤„ç†å™¨æ˜¯åˆç†çš„ã€‚ä½†å¦‚æœæœ‰è¿‡å¤šçš„é¢å¤–çº¿ç¨‹ï¼Œæ“ä½œç³»ç»Ÿç¡®ä¿ä¸ºæ¯ä¸ªçº¿ç¨‹å…¬å¹³åˆ†é…æ—¶é—´ç‰‡ï¼Œå°±ä¼šæœ‰æ²‰é‡çš„ä»»åŠ¡åˆ‡æ¢è´Ÿæ‹…ã€‚å½“ä¸€ä¸ªä»»åŠ¡é‡å¤è€Œæ— é™åˆ¶åœ°ç”Ÿæˆæ–°çº¿ç¨‹ï¼Œå°±ä¼šå¯¼è‡´ oversubscription å¦‚æœç”Ÿæˆçš„çº¿ç¨‹æ•°è¿‡å¤šçš„åŸå› æ˜¯æ•°æ®åˆ’åˆ†ï¼Œå¯ä»¥é™åˆ¶å·¥ä½œçº¿ç¨‹çš„æ•°é‡ã€‚å¦‚æœ oversubscription æ˜¯å› ä¸ºè‡ªç„¶çš„å·¥ä½œåˆ’åˆ†ï¼Œé™¤äº†é€‰æ‹©å…¶ä»–çš„åˆ’åˆ†æ–¹å¼ï¼Œæ²¡æœ‰ä»€ä¹ˆç›´æ¥æ”¹å–„çš„åŠæ³•ã€‚ä½†é€‰æ‹©åˆé€‚çš„åˆ’åˆ†éœ€è¦å¯¹ç›®æ ‡å¹³å°æœ‰æ›´å¤šçš„äº†è§£ï¼Œåªæœ‰æ€§èƒ½ä¸å¯æ¥å—ï¼Œè€Œæ”¹å˜åˆ’åˆ†æ–¹å¼å¯ä»¥æ˜æ˜¾æé«˜æ€§èƒ½æ—¶æ‰å€¼å¾—è¿™æ ·åš å½±å“å¤šçº¿ç¨‹ä»£ç æ€§èƒ½çš„å› ç´ éå¸¸å¤šï¼Œä»¥ä¸Šåªæ˜¯ä¸€äº›æœ‰æ˜æ˜¾å¯è§å½±å“çš„ä¸»è¦å› ç´ ï¼Œæ¯”å¦‚ä¹’ä¹“ç¼“å­˜çš„å¼€é”€åœ¨ä¸¤ä¸ªå•æ ¸å¤„ç†å™¨å’Œä¸€ä¸ªåŒæ ¸å¤„ç†å™¨ä¸ŠåŒºåˆ«å¾ˆå¤§ï¼Œå³ä½¿ä¸¤è€…æœ‰ç›¸åŒçš„CPUç±»å‹å’Œæ—¶é’Ÿé€Ÿåº¦ ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:2:5","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"é€‚ç”¨å¤šçº¿ç¨‹æ€§èƒ½çš„æ•°æ®ç»“æ„ å¦‚æœæœ‰ä¸¤ä¸ªä¸Šåƒè¡Œåˆ—çš„çŸ©é˜µç›¸ä¹˜ï¼Œç°åœ¨è¦ç”¨å¤šçº¿ç¨‹æ¥ä¼˜åŒ–è®¡ç®—ã€‚ä¸€èˆ¬éç¨€ç–çŸ©é˜µå¯ä»¥ç”¨ä¸€ä¸ªå¤§çš„ä¸€ç»´æ•°ç»„è¡¨ç¤ºï¼ŒçŸ©é˜µçš„æ¯è¡Œåœ¨æ•°ç»„ä¸­è¿ç»­æ’åˆ—ã€‚è¿™ä¸ªè®¡ç®—éœ€è¦ä¸‰ä¸ªæ•°ç»„ï¼Œå…¶ä¸­ä¸€ä¸ªå­˜å‚¨è®¡ç®—ç»“æœã€‚ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œå°±è¦ä»”ç»†è€ƒè™‘æ•°æ®è®¿é—®æ¨¡å¼ï¼Œå°¤å…¶æ˜¯å‘ç»“æœæ•°ç»„çš„å†™å…¥ åˆ’åˆ†æ–¹å¼æœ‰å¾ˆå¤šï¼Œå¦‚æœè¡Œåˆ—æ•°è¶…è¿‡å¤„ç†å™¨æ•°ï¼Œæ¯ä¸ªçº¿ç¨‹å¯ä»¥è®¡ç®—ç»“æœçš„æŸäº›è¡Œæˆ–åˆ—ï¼Œæˆ–è€…ä¸€ä¸ªå­çŸ©é˜µ è®¿é—®ç›¸é‚»å…ƒç´ å¯ä»¥å‡å°‘å¯¹ cache çš„ä½¿ç”¨ï¼Œä»¥åŠé™ä½ä¼ªå…±äº«çš„æ¦‚ç‡ã€‚å¦‚æœè®©çº¿ç¨‹è®¡ç®—ç»“æœçš„æŸåˆ—ï¼Œå°±éœ€è¦ä¾æ¬¡è®¿é—®å·¦çŸ©é˜µçš„è¡Œï¼ˆæœ€ç»ˆè¯»å–æ•´ä¸ªå·¦çŸ©é˜µï¼‰ï¼Œå¹¶è¯»å–å³çŸ©é˜µæŸåˆ—ã€‚çŸ©é˜µä¿å­˜äºä¸€ç»´æ•°ç»„ï¼Œè¡Œæ˜¯ç›¸é‚»çš„ï¼Œä½†åˆ—ä¸æ˜¯ï¼Œå› æ­¤å†™å…¥ç»“æœæ—¶ï¼Œå…¶ä»–çº¿ç¨‹å¯èƒ½è®¿é—®åŒä¸€è¡Œçš„å…¶ä»–å…ƒç´ ã€‚ä¸ºäº†é¿å…ä¼ªå…±äº«ï¼Œéœ€è¦è®©æ¯è¡Œå…ƒç´ æ‰€å çš„ç©ºé—´æ­£å¥½æ˜¯ cache line çš„æ•°é‡ å¦‚æœè®©çº¿ç¨‹è®¡ç®—ç»“æœçš„æŸè¡Œï¼Œå°±éœ€è¦è¯»å–å·¦çŸ©é˜µçš„æŸè¡Œï¼Œå¹¶ä¾æ¬¡è¯»å–å³çŸ©é˜µçš„åˆ—ï¼ˆæœ€ç»ˆè¯»å–æ•´ä¸ªå³çŸ©é˜µï¼‰ã€‚æ­¤æ—¶çº¿ç¨‹æŒ‰è¡Œå†™å…¥ç»“æœï¼Œç”±äºä¸€ç»´æ•°ç»„é‡ŒçŸ©é˜µè¡Œæ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œè¿™ä¸ªè¿ç»­å†…å­˜å—ä¸ç”¨è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œæ¯”èµ·ä¸Šé¢æŒ‰åˆ—å†™å…¥ç»“æœæ˜¯ä¸€ä¸ªæ”¹è¿›ï¼Œä¼ªå…±äº«åªå¯èƒ½å‘ç”Ÿäºä¸€ä¸ªç»“æœå—çš„æœ€åå‡ ä¸ªå…ƒç´ ä¸ä¸‹ä¸€ä¸ªå—çš„å‰å‡ ä¸ªå…ƒç´  å¦‚æœåˆ’åˆ†ä¸ºå­çŸ©é˜µï¼Œå¯ä»¥çœ‹æˆå…ˆæŒ‰åˆ—åˆ’åˆ†å†æŒ‰è¡Œåˆ’åˆ†ï¼Œå› æ­¤å®ƒå’ŒæŒ‰åˆ—åˆ’åˆ†ä¸€æ ·å­˜åœ¨ä¼ªå…±äº«çš„å¯èƒ½ã€‚å¦‚æœå¯ä»¥é¿å…è¿™ä¸ªå¯èƒ½ï¼Œè¿™ä¸ªåˆ’åˆ†å°±æœ‰ä¸€ä¸ªæ˜æ˜¾çš„å¥½å¤„ï¼Œå³ä¸éœ€è¦è¯»å–æ•´ä¸ªæºçŸ©é˜µï¼Œå› æ­¤è®¡ç®—å­çŸ©é˜µæ¯”è®¡ç®—è¡Œå¥½ä¸€äº›ã€‚å½“ç„¶ï¼Œå¦‚æœæ€§èƒ½éå¸¸é‡è¦ï¼Œå¿…é¡»é’ˆå¯¹ç›®æ ‡æ¶æ„ profile å„ç§é€‰é¡¹å¹¶æ£€ç´¢ç›¸å…³é¢†åŸŸçš„æ–‡çŒ® å¯¹äºå…¶ä»–æ•°æ®ç»“æ„çš„æ•°æ®è®¿é—®æ¨¡å¼è¿›è¡Œä¼˜åŒ–æ—¶ï¼Œéœ€è¦è€ƒè™‘çš„æœ¬è´¨ä¸Šä¸ä¼˜åŒ–å¯¹æ•°ç»„çš„è®¿é—®ç±»ä¼¼ è°ƒæ•´çº¿ç¨‹é—´çš„æ•°æ®åˆ†å¸ƒï¼Œè®©åŒä¸€çº¿ç¨‹è®¿é—®çš„æ•°æ®å°½é‡ç´§å¯† å°½é‡å‡å°‘çº¿ç¨‹æ‰€éœ€çš„æ•°æ®é‡ ä¾æ® std::hardware_destructive_interference_sizeï¼Œç¡®ä¿ä¸åŒçº¿ç¨‹è®¿é—®çš„æ•°æ®è·ç¦»è¶³å¤Ÿè¿œï¼Œä»¥é¿å…ä¼ªå…±äº« è¿™äº›ç”¨åœ¨å…¶ä»–æ•°æ®ç»“æ„ä¸Šå¹¶ä¸å®¹æ˜“ï¼Œæ¯”å¦‚äºŒå‰æ ‘å¾ˆéš¾åœ¨å­æ ‘ä»¥å¤–çš„ä»»ä½•å•å…ƒä¸­å†åˆ†å‰²ï¼Œå¹¶ä¸”äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸€èˆ¬æ˜¯åŠ¨æ€åˆ†é…çš„ï¼Œä»è€Œä¼šåˆ†å¸ƒåœ¨å †çš„ä¸åŒä½ç½®ä¸Šã€‚æ•°æ®ä½äºå †çš„ä¸åŒä½ç½®ä¸æ˜¯ä»€ä¹ˆç‰¹åˆ«çš„é—®é¢˜ï¼Œä½†ç¡®å®æ„å‘³ç€å¤„ç†å™¨éœ€è¦åœ¨ cache ä¸­ä¿å­˜æ›´å¤šä¸œè¥¿ã€‚ä¸è¿‡è¿™æ˜¯æœ‰ç›Šçš„ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹è¦éå†æ ‘ï¼Œå°±éƒ½éœ€è¦è®¿é—®æ ‘èŠ‚ç‚¹ï¼Œå¦‚æœæ ‘èŠ‚ç‚¹åªåŒ…å«ä¿å­˜æ•°æ®çš„æŒ‡é’ˆï¼Œå¤„ç†å™¨åªè¦åœ¨éœ€è¦æ—¶ä»å†…å­˜åŠ è½½æ•°æ®ï¼Œå¦‚æœæ•°æ®è¢«éœ€è¦å®ƒçš„çº¿ç¨‹ä¿®æ”¹äº†ï¼Œè¿™èƒ½é¿å…èŠ‚ç‚¹æ•°æ®æœ¬èº«å’Œæä¾›æ ‘ç»“æ„çš„æ•°æ®ä¹‹é—´çš„ä¼ªå…±äº«å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ ç”¨ mutex ä¿æŠ¤æ•°æ®ä¹Ÿæœ‰ç±»ä¼¼é—®é¢˜ã€‚å‡å¦‚æœ‰ä¸€ä¸ªç±»ï¼Œå®ƒåŒ…å«ä¸€ä¸ª mutex å’Œä¸€äº›è¢«ä¿æŠ¤çš„æ•°æ®ï¼Œå¦‚æœ mutex å’Œæ•°æ®åœ¨å†…å­˜ä¸­å¾ˆæ¥è¿‘ï¼Œè¿™å¯¹è·å– mutex çš„çº¿ç¨‹æ˜¯å¾ˆç†æƒ³çš„ï¼Œä¸ºäº†ä¿®æ”¹ mutexï¼Œéœ€è¦çš„æ•°æ®å¯èƒ½å·²ç»è·Ÿç€åŠ è½½åœ¨å¤„ç†å™¨ cache ä¸­äº†ã€‚ä½†è¿™ä¹Ÿæœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹å°è¯•è·å– mutexï¼Œå°±ä¼šéœ€è¦è®¿é—®é‚£å—å†…å­˜ äº’æ–¥é”çš„å…¸å‹å®ç°ä¸ºï¼Œä¸€ä¸ªæ“ä½œåœ¨ mutex å†…å­˜ä½ç½®ä¸Šä»¥å°è¯•è·å– mutex çš„è¯»æ”¹å†™åŸå­æ“ä½œï¼Œå¦‚æœ mutex å·²é”å®šï¼Œå°±æ¥ç€è°ƒç”¨æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚è¿™ä¸ªè¯»æ”¹å†™æ“ä½œå¯èƒ½ä¼šå¯¼è‡´ï¼ŒæŒæœ‰è¯¥ mutex çš„çº¿ç¨‹çš„ cache ä¸­ä¿å­˜çš„æ•°æ®æ— æ•ˆã€‚è¿™å¯¹äº mutex ä¸æ˜¯é—®é¢˜ï¼Œåœ¨ mutex è§£é”ä¹‹å‰çº¿ç¨‹ä¸ä¼šæ¥è§¦ mutexï¼Œä½†å¦‚æœ mutex ä¸æ•°æ®å…±äº«åŒä¸€ cache lineï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å– mutex æ—¶ï¼ŒæŒæœ‰ mutex çš„çº¿ç¨‹å°±ä¼šå—åˆ°æ€§èƒ½å½±å“ ä¸€ä¸ªæµ‹è¯•è¿™ç§ä¼ªå…±äº«æ˜¯å¦ä¼šå¸¦æ¥å½±å“çš„æ–¹æ³•æ˜¯ï¼Œåœ¨èƒ½è¢«å¹¶å‘è®¿é—®çš„æ•°æ®ä¹‹é—´æ·»åŠ å·¨å¤§çš„å¡«å……å—ã€‚æ¯”å¦‚ç”¨å¦‚ä¸‹æ–¹å¼æµ‹è¯• mutex ç«äº‰é—®é¢˜ struct ProtectedData { std::mutex m; // ä½¿ç”¨è¶…è¿‡ä¸€ä¸ª cache line å­—èŠ‚æ•°çš„å¡«å……å³å¯ char padding[std::hardware_destructive_interference_size]; // ä¸æ”¯æŒ C++17 åˆ™å¯ä»¥ padding[65536]; Data data_to_protect; }; ç”¨å¦‚ä¸‹æ–¹å¼æµ‹è¯•æ•°ç»„æ•°æ®ä¼ªå…±äº«ï¼Œå¦‚æœæ€§èƒ½æé«˜äº†å°±è¯´æ˜ä¼ªå…±äº«å½±å“äº†æ€§èƒ½ï¼Œå¹¶ä¸”å¯ä»¥ä¿ç•™å¡«å……æˆ–è€…ç”¨å…¶ä»–æ–¹å¼é‡æ’æ•°æ®è®¿é—®æ¥æ¶ˆé™¤ä¼ªå…±äº« struct Data { data_item1 d1; data_item2 d2; char padding[std::hardware_destructive_interference_size]; }; Data some_array[256]; ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å¹¶å‘è®¾è®¡çš„å…¶ä»–æ³¨æ„äº‹é¡¹ é™¤äº†ä¸Šè¿°é—®é¢˜ï¼Œè®¾è®¡å¹¶å‘ä»£ç æ—¶è¿˜éœ€è¦è€ƒè™‘å¼‚å¸¸å®‰å…¨å’Œå¯æ‰©å±•æ€§ã€‚å¦‚æœä»£ç ä¸æ˜¯å¼‚å¸¸å®‰å…¨çš„ï¼Œå°±å¯èƒ½å¯¼è‡´ç ´åä¸å˜é‡æˆ– race conditionï¼Œæˆ–ç”±äºä¸€ä¸ªæ“ä½œæŠ›å‡ºå¼‚å¸¸å¯¼è‡´ç¨‹åºæ„å¤–ç»ˆæ­¢ã€‚å¯æ‰©å±•æ€§æŒ‡çš„æ˜¯ï¼Œæ€§èƒ½ä¼šéšç€å¤„ç†å™¨æ ¸æ•°çš„æå‡è€Œæå‡ï¼Œå¦‚æœå¤„ç†å™¨æ ¸æ•°æ˜¯ä¹‹å‰çš„ 100 å€ï¼Œåˆ™æœ€ç†æƒ³çš„æƒ…å†µä¸‹æ€§èƒ½ä¹Ÿåº”è¯¥ä¹‹å‰çš„ 100 å€ ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:4:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å¹¶å‘ç®—æ³•çš„å¼‚å¸¸å®‰å…¨ å¹¶è¡Œç®—æ³•æ¯”ä¸²è¡Œç®—æ³•æ›´æ³¨é‡å¼‚å¸¸é—®é¢˜ã€‚åœ¨ä¸²è¡Œç®—æ³•ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œæŠ›å‡ºå¼‚å¸¸ï¼Œåªéœ€è¦ä¿è¯åä¸‹æ­¤å¼‚å¸¸ä»¥é¿å…èµ„æºæ³„æ¼æˆ–ç ´åä¸å˜é‡ï¼Œå®ƒå¯ä»¥æ„‰å¿«åœ°å…è®¸å¼‚å¸¸ä¼ æ’­ç»™è°ƒç”¨è€…å¤„ç†ã€‚ä½†åœ¨å¹¶è¡Œç®—æ³•ä¸­ï¼Œè®¸å¤šæ“ä½œè¿è¡Œåœ¨ä¸åŒçš„çº¿ç¨‹ä¸Šï¼Œå¼‚å¸¸å°±ä¸å…è®¸ä¼ æ’­ï¼Œå› ä¸ºå®ƒåœ¨é”™è¯¯çš„è°ƒç”¨æ ˆä¸Šã€‚å¦‚æœæ–°çº¿ç¨‹ä¸Šçš„å‡½æ•°å­˜åœ¨å¼‚å¸¸ï¼Œç¨‹åºå°±ä¼šç»ˆæ­¢ å›é¡¾ä»¥å‰æåˆ°çš„å¹¶è¡Œç‰ˆæœ¬çš„ std::accumulateï¼Œå®ƒå°±æ˜¯éå¼‚å¸¸å®‰å…¨çš„ï¼Œä»£ç å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä½ç½®å¦‚ä¸‹ #include \u003calgorithm\u003e #include \u003cfunctional\u003e #include \u003cnumeric\u003e #include \u003cthread\u003e #include \u003cvector\u003e template \u003ctypename Iterator, typename T\u003e struct accumulate_block { void operator()(Iterator first, Iterator last, T\u0026 res) { res = std::accumulate(first, last, res); // å¯èƒ½æŠ›å¼‚å¸¸ } }; template \u003ctypename Iterator, typename T\u003e T parallel_accumulate(Iterator first, Iterator last, T init) { std::size_t len = std::distance(first, last); // æ­¤æ—¶æ²¡åšä»»ä½•äº‹ï¼ŒæŠ›å¼‚å¸¸æ— å½±å“ if (!len) { return init; } std::size_t min_per_thread = 25; std::size_t max_threads = (len + min_per_thread - 1) / min_per_thread; std::size_t hardware_threads = std::thread::hardware_concurrency(); std::size_t num_threads = std::min(hardware_threads != 0 ? hardware_threads : 2, max_threads); std::size_t block_size = len / num_threads; std::vector\u003cT\u003e res(num_threads); // ä»æœªåšä»»ä½•äº‹ï¼ŒæŠ›å¼‚å¸¸æ— å½±å“ std::vector\u003cstd::thread\u003e threads(num_threads - 1); // åŒä¸Š Iterator block_start = first; // åŒä¸Š for (std::size_t i = 0; i \u003c num_threads - 1; ++i) { Iterator block_end = block_start; // åŒä¸Š std::advance(block_end, block_size); // ä¸‹é¢åˆ›å»º std::threadï¼ŒæŠ›å¼‚å¸¸å°±å¯¼è‡´ææ„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ std::terminate // ç»ˆæ­¢ç¨‹åº threads[i] = std::thread(accumulate_block\u003cIterator, T\u003e{}, block_start, block_end, std::ref(res[i])); block_start = block_end; } // accumulate_block::operator() è°ƒç”¨çš„ std::accumulate // å¯èƒ½æŠ›å¼‚å¸¸ï¼Œæ­¤æ—¶æŠ›å¼‚å¸¸é€ æˆé—®é¢˜åŒä¸Š accumulate_block\u003cIterator, T\u003e()(block_start, last, res[num_threads - 1]); std::for_each(threads.begin(), threads.end(), std::mem_fn(\u0026std::thread::join)); // æœ€åè°ƒç”¨ std::accumulate å¯èƒ½æŠ›å¼‚å¸¸ï¼Œä½†ä¸å¼•å‘å¤§é—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰çº¿ç¨‹å·² join return std::accumulate(res.begin(), res.end(), init); } ä¸Šé¢å·²ç»åˆ†æäº†æ‰€æœ‰å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä½ç½®ï¼Œä¸‹é¢æ¥å¤„ç†è¿™äº›é—®é¢˜ã€‚æ–°çº¿ç¨‹æƒ³åšçš„æ˜¯è¿”å›è®¡ç®—ç»“æœï¼Œä½†å¯èƒ½æŠ›å‡ºå¼‚å¸¸å¯¼è‡´ std::thread ææ„ï¼Œè€Œææ„æ²¡è¢« join çš„ std::thread å°†å¯¼è‡´ç¨‹åºç»ˆæ­¢ã€‚è§£å†³è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ï¼Œç»“åˆä½¿ç”¨ std::packaged_task å’Œ std::futureï¼Œå†æŠŠå·¥ä½œçº¿ç¨‹çš„å¼‚å¸¸æŠ›å‡ºåˆ°ä¸»çº¿ç¨‹ï¼Œè®©ä¸»çº¿ç¨‹å¤„ç†å³å¯ #include \u003calgorithm\u003e #include \u003cfunctional\u003e #include \u003cfuture\u003e #include \u003cnumeric\u003e #include \u003cthread\u003e #include \u003cvector\u003e template \u003ctypename Iterator, typename T\u003e struct accumulate_block { T operator()(Iterator first, Iterator last) { return std::accumulate(first, last, T{}); } }; template \u003ctypename Iterator, typename T\u003e T parallel_accumulate(Iterator first, Iterator last, T init) { std::size_t len = std::distance(first, last); if (!len) { return init; } std::size_t min_per_thread = 25; std::size_t max_threads = (len + min_per_thread - 1) / min_per_thread; std::size_t hardware_threads = std::thread::hardware_concurrency(); std::size_t num_threads = std::min(hardware_threads != 0 ? hardware_threads : 2, max_threads); std::size_t block_size = len / num_threads; std::vector\u003cstd::future\u003cT\u003e\u003e fts(num_threads - 1); // æ”¹ç”¨ std::future è·å–å€¼ std::vector\u003cstd::thread\u003e threads(num_threads - 1); Iterator block_start = first; for (std::size_t i = 0; i \u003c num_threads - 1; ++i) { Iterator block_end = block_start; std::advance(block_end, block_size); // ç”¨ std::packaged_task æ›¿ä»£ç›´æ¥åˆ›å»º std::thread std::packaged_task\u003cT(Iterator, Iterator)\u003e pt( accumulate_block\u003cIterator, T\u003e{}); fts[i] = pt.get_future(); threads[i] = std::thread(std::move(pt), block_start, block_end); block_start = block_end; } T last_res = accumulate_block\u003cIterator, T\u003e{}(block_start, last); std::for_each(threads.begin(), threads.end(), std::mem_fn(\u0026std::thread::join)); T res = init; try { for (std::size_t i = 0; i \u003c num_threads - 1; ++i) { res += fts[i].get(); } res += last_res; } catch (...) { for (auto\u0026 x : threads) { if (x.joinable()) { x.join(); } } throw; } return res; } ä¸è¿‡ try-catch å¾ˆéš¾çœ‹ï¼Œå¹¶ä¸”å¯¼è‡´äº†é‡å¤ä»£ç ï¼ˆæ­£å¸¸æ§åˆ¶æµå’Œ catch å—éƒ½å¯¹çº¿ç¨‹æ‰§è¡Œ joinï¼‰ï¼Œå› æ­¤å¯ä»¥ç”¨ RAII æ¥å¤„ç† #include \u003calgorithm\u003e #include \u003cfunctional\u003e #include \u003cfuture\u003e #include \u003cnumeric\u003e #include \u003cthread\u003e #include \u003cvector\u003e class threads_guard { public: explicit threads_guard(std::vector\u003cstd::thread\u003e\u0026 threads) : threads_(threads) {} ~threads_guard() { for (auto\u0026 x : threads_) { if (x.joinable()) { x.join(); } } } private: std::vector\u003cstd::threa","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:4:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å¯æ‰©å±•æ€§ä¸é˜¿å§†è¾¾å°”å®šå¾‹ï¼ˆAmdahlâ€™s lawï¼‰ å¯æ‰©å±•æ€§ä»£è¡¨äº†ç¨‹åºå¯¹å¤„ç†å™¨çš„åˆ©ç”¨ç‡ã€‚å•çº¿ç¨‹ç¨‹åºå°±æ˜¯ä¸å¯æ‰©å±•çš„ï¼Œå› ä¸ºå¤„ç†å™¨å¢åŠ å®Œå…¨ä¸èƒ½æé«˜å•çº¿ç¨‹ç¨‹åºçš„æ€§èƒ½ã€‚å¯¹äºå¤šçº¿ç¨‹ç¨‹åºï¼Œçº¿ç¨‹ç»å¸¸éœ€è¦èŠ±è´¹æ—¶é—´ç­‰å¾…ï¼ˆç­‰å¾…å…¶ä»–çº¿ç¨‹ã€è·å– mutexã€ä¿®æ”¹æ¡ä»¶å˜é‡ã€å®Œæˆ I/O æ“ä½œâ€¦â€¦ï¼‰ï¼Œä¸€ç§ç®€åŒ–çœ‹å¾…å¤šçº¿ç¨‹ç¨‹åºçš„æ–¹å¼æ˜¯å°†å…¶åˆ†ä¸ºä¸²è¡Œå’Œå¹¶è¡Œéƒ¨åˆ†ï¼Œç”±æ­¤å¯ä»¥å¾—åˆ°å¦‚ä¸‹å…¬å¼ï¼Œå³é˜¿å§†è¾¾å°”å®šå¾‹ S = 1 / (a + ( 1 - a ) / N) // a ä¸ºä¸²è¡Œéƒ¨åˆ†å æ¯”ï¼ŒN ä¸ºå¤„ç†å™¨å€æ•°ï¼ŒS ä¸ºæ€§èƒ½å€æ•° // æ­£å¸¸æƒ…å†µä¸‹ S \u003c 1 / aï¼Œæœ€ç†æƒ³çš„æƒ…å†µæ˜¯ a ä¸º 0ï¼ŒS = N ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:4:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"ç”¨å¤šçº¿ç¨‹éšè—å»¶è¿Ÿï¼ˆlantencyï¼‰ å¦‚æœåœ¨çº¿ç¨‹ç­‰å¾…æœŸé—´è®©ç³»ç»Ÿåšä¸€äº›æœ‰ç”¨çš„äº‹ï¼Œå°±ç›¸å½“äºéšè—äº†ç­‰å¾…ã€‚å¦‚æœåªæœ‰å’Œå¤„ç†å™¨å•å…ƒä¸€æ ·å¤šçš„çº¿ç¨‹ï¼Œé˜»å¡å°±æ„å‘³ç€æµªè´¹ CPU æ—¶é—´ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ—¶é—´å»è¿è¡Œé¢å¤–çš„çº¿ç¨‹ã€‚æ¯”å¦‚ä¸€ä¸ªç”¨ pipeline åˆ’åˆ†å·¥ä½œçš„ç—…æ¯’æ‰«æç¨‹åºï¼Œä¸€ä¸ªçº¿ç¨‹æ£€ç´¢æ–‡ä»¶ç³»ç»Ÿå¹¶å°†æ–‡ä»¶æ”¾å…¥é˜Ÿåˆ—ï¼Œè¿™æ˜¯ä¸€ä¸ªè´¹æ—¶çš„ I/O æ“ä½œï¼Œå› æ­¤åŒæ—¶å¯ä»¥è®©å¦ä¸€çº¿ç¨‹ä»é˜Ÿåˆ—è·å–æ–‡ä»¶åï¼ŒåŠ è½½å¹¶æ‰«ææ–‡ä»¶ åˆ©ç”¨ç©ºé—²çš„ CPU æ—¶é—´ä¹Ÿå¯èƒ½ä¸éœ€è¦è¿è¡Œé¢å¤–çš„çº¿ç¨‹ã€‚æ¯”å¦‚ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹å› ä¸ºç­‰å¾… I/O æ“ä½œè€Œé˜»å¡ï¼Œä½¿ç”¨å¼‚æ­¥ I/O å°±æ˜¯åˆç†çš„ï¼Œå½“ I/O æ“ä½œå¼‚æ­¥è¿è¡Œåœ¨åå°æ—¶ï¼Œçº¿ç¨‹å°±èƒ½åšæœ‰ç”¨çš„å·¥ä½œã€‚åˆæ¯”å¦‚ï¼Œä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªæ“ä½œæ—¶ï¼Œä¸å…¶é˜»å¡ï¼Œä¸å¦‚è‡ªå·±æ‰§è¡Œæ“ä½œï¼ˆå¦‚lock-free queueï¼‰ã€‚æ›´æç«¯çš„ä¾‹å­æ˜¯ï¼Œå¦‚æœçº¿ç¨‹ç­‰å¾…ä¸€ä¸ªæœªè¢«ä»»ä½•çº¿ç¨‹å¯åŠ¨çš„ä»»åŠ¡å®Œæˆï¼Œè¿™ä¸ªçº¿ç¨‹å¯èƒ½è‡ªå·±æ‰§è¡Œæ­¤ä»»åŠ¡ï¼Œæˆ–æ‰§è¡Œå¦ä¸€ä¸ªæœªå®Œæˆçš„ä»»åŠ¡ ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:4:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"ç”¨å¹¶å‘æé«˜å“åº”åº¦ï¼ˆresponsivenessï¼‰ æ·»åŠ çº¿ç¨‹ä¸ä¸€å®šæ˜¯ä¸ºäº†ç¡®ä¿ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„å¤„ç†å™¨ï¼Œæœ‰æ—¶æ˜¯ä¸ºäº†ç¡®ä¿åŠæ—¶å¤„ç†å¤–éƒ¨äº‹ä»¶ï¼Œä»¥æé«˜ç³»ç»Ÿå“åº”åº¦ã€‚ç°ä»£ GUI æ¡†æ¶å¤§å¤šæ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œä¸ºäº†ç¡®ä¿å¤„ç†æ‰€æœ‰äº‹ä»¶å’Œæ¶ˆæ¯ï¼ŒGUI ç¨‹åºä¸€èˆ¬åŒ…å«ä¸€ä¸ªå¦‚ä¸‹å¾ªç¯ while (true) { event_data event = get_event(); if (event.type == quit) { break; } process(event); } å¦‚æœæ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œå°±å¾ˆéš¾ç¼–å†™é•¿æœŸè¿è¡Œçš„ä»»åŠ¡ã€‚ä¸ºäº†ç¡®ä¿å³ä½¿å“åº”ç”¨æˆ·è¾“å…¥ï¼Œå°±è¦ä»¥åˆç†é¢‘ç‡è°ƒç”¨ get_event å’Œ processï¼Œè¿™æ„å‘³ç€ä»»åŠ¡è¦è¢«å‘¨æœŸæ€§æ‚¬æŒ‚ï¼ˆsuspendï¼‰å¹¶æŠŠæ§åˆ¶æµè¿”å›ç»™äº‹ä»¶å¾ªç¯ï¼Œæˆ–è€…åœ¨ä»£ç ä¸­çš„ä¸€ä¸ªé€‚å½“ç‚¹è°ƒç”¨ get_event å’Œ processï¼ŒäºŒè€…ä»»ä¸€éƒ½ä¼šå¤æ‚åŒ–ä»»åŠ¡å®ç° é€šè¿‡ SoCï¼ˆseparation of concernsï¼‰å¯ä»¥æŠŠå¾ˆé•¿çš„ä»»åŠ¡æ”¾åœ¨ä¸€ä¸ªå…¨æ–°çš„çº¿ç¨‹ä¸Šï¼Œè€Œè®© GUI çº¿ç¨‹æ¥å¤„ç†äº‹ä»¶ï¼Œçº¿ç¨‹å¯ä»¥é€šè¿‡ç®€å•çš„æœºåˆ¶è¿›è¡Œé€šä¿¡ï¼Œè€Œä¸éœ€è¦æ··å…¥å¤„ç†äº‹ä»¶çš„ä»£ç ï¼Œè¿™æ ·å³ä½¿ä»»åŠ¡è€—è´¹å¾ˆé•¿æ—¶é—´ï¼Œç”¨æˆ·çº¿ç¨‹ä¹Ÿæ€»èƒ½åŠæ—¶å“åº”äº‹ä»¶ std::thread task_thread; std::atomic\u003cbool\u003e task_cancelled(false); void gui_thread() { while (true) { event_data event = get_event(); if (event.type == quit) { break; } process(event); } } void task() { while (!task_complete() \u0026\u0026 !task_cancelled) do_next_operation(); if (task_cancelled) { perform_cleanup(); } else { post_gui_event(task_complete); } } void process(const event_data\u0026 event) { switch (event.type) { case start_task: task_cancelled = false; task_thread = std::thread(task); break; case stop_task: task_cancelled = true; task_thread.join(); break; case task_complete: task_thread.join(); display_results(); break; default: ... } } ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:4:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å®è·µ ä¸‹é¢ä¸ºæ ‡å‡†åº“çš„ä¸‰ä¸ªç®—æ³•å®ç°å¹¶è¡Œç‰ˆæœ¬ï¼Œè¿™äº›å®ç°ä»…æ˜¯ä¸ºäº†é˜è¿°æŠ€æœ¯çš„è¿ç”¨ï¼Œè€Œä¸æ˜¯æœ€å…ˆè¿›é«˜æ•ˆçš„å®ç°ã€‚æ›´å…ˆè¿›çš„å®ç°å¯ä»¥åœ¨å­¦æœ¯æ–‡çŒ®æˆ–ä¸“ä¸šçš„å¤šçº¿ç¨‹åº“ï¼ˆå¦‚ Intel çš„ Threading Building Blocksï¼‰ ä¸­æ‰¾åˆ° ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:5:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å¹¶è¡Œç‰ˆ std::for_each std::for_each ä¼šæŒ‰é¡ºåºä¾æ¬¡ä½œç”¨äºæ¯ä¸ªå…ƒç´ ï¼Œè€Œå¹¶è¡Œç‰ˆä¸ä¿è¯é¡ºåºï¼Œå…ƒç´ æœ€å¥½è¢«å¹¶å‘å¤„ç†ï¼Œä¸ºæ­¤éœ€è¦æŠŠå…ƒç´ åˆ’åˆ†ç»™æ¯ä¸ªçº¿ç¨‹ã€‚å®é™…ä¸Šï¼Œå¹¶è¡Œç‰ˆ std::for_each ä¸å¹¶è¡Œç‰ˆ std::accumulateçš„å®ç°æ€è·¯åŸºæœ¬ä¸€æ ·ï¼šä½¿ç”¨ hardware_concurrency å†³å®šçº¿ç¨‹æ•°ï¼Œä½¿ç”¨è¿ç»­æ•°æ®å—é¿å…ä¼ªå…±äº«ï¼Œä½¿ç”¨ std::packaged_task å’Œ std::future åœ¨çº¿ç¨‹é—´ä¼ é€’å¼‚å¸¸ #include \u003calgorithm\u003e #include \u003cfuture\u003e #include \u003cthread\u003e #include \u003cvector\u003e template \u003ctypename Iterator, typename Func\u003e void parallel_for_each(Iterator first, Iterator last, Func f) { std::size_t len = std::distance(first, last); if (!len) { return; } std::size_t min_per_thread = 25; std::size_t max_threads = (len + min_per_thread - 1) / min_per_thread; std::size_t hardware_threads = std::thread::hardware_concurrency(); std::size_t num_threads = std::min(hardware_threads != 0 ? hardware_threads : 2, max_threads); std::size_t block_size = len / num_threads; std::vector\u003cstd::future\u003cvoid\u003e\u003e fts(num_threads - 1); std::vector\u003cstd::jthread\u003e threads(num_threads - 1); Iterator block_start = first; for (std::size_t i = 0; i \u003c num_threads - 1; ++i) { Iterator block_end = block_start; std::advance(block_end, block_size); std::packaged_task\u003cvoid(void)\u003e pt( [=] { std::for_each(block_start, block_end, f); }); fts[i] = pt.get_future(); threads[i] = std::jthread(std::move(pt)); block_start = block_end; } std::for_each(block_start, last, f); for (std::size_t i = 0; i \u003c num_threads - 1; ++i) { fts[i].get(); // åªæ˜¯ä¸ºäº†ä¼ é€’å¼‚å¸¸ } } ä¹Ÿå¯ä»¥ä½¿ç”¨ std::async æ¥ç®€åŒ–å®ç° #include \u003calgorithm\u003e #include \u003cfuture\u003e template \u003ctypename Iterator, typename Func\u003e void parallel_for_each(Iterator first, Iterator last, Func f) { std::size_t len = std::distance(first, last); if (!len) { return; } std::size_t min_per_thread = 25; if (len \u003c 2 * min_per_thread) { std::for_each(first, last, f); return; } const Iterator mid_point = first + len / 2; std::future\u003cvoid\u003e l = std::async(\u0026parallel_for_each\u003cIterator, Func\u003e, first, mid_point, f); parallel_for_each(mid_point, last, f); l.get(); } ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:5:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å¹¶è¡Œç‰ˆ std::find std::find çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œåªè¦æ‰¾åˆ°ç›®æ ‡å€¼å°±åº”è¯¥åœæ­¢ç»§ç»­æŸ¥æ‰¾ã€‚åœ¨å¹¶è¡Œç‰ˆæœ¬ä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹æ‰¾åˆ°äº†å€¼ï¼Œä¸ä»…è‡ªèº«è¦åœæ­¢ç»§ç»­æŸ¥æ‰¾ï¼Œè¿˜åº”è¯¥é€šçŸ¥å…¶ä»–çº¿ç¨‹åœæ­¢ï¼Œè¿™ç‚¹å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåŸå­å˜é‡ä½œä¸ºæ ‡è®°æ¥å®ç° æœ‰ä¸¤ç§å¯é€‰æ–¹å¼æ¥è¿”å›å€¼å’Œä¼ æ’­å¼‚å¸¸ï¼Œä¸€æ˜¯ä½¿ç”¨ std::future æ•°ç»„å’Œ std::packaged_task å°†è¿”å›å€¼å’Œå¼‚å¸¸äº¤ç»™ä¸»çº¿ç¨‹å¤„ç†ï¼ŒäºŒæ˜¯ä½¿ç”¨ std::promise ç›´æ¥è®¾ç½®æœ€ç»ˆç»“æœã€‚å¦‚æœæƒ³åœ¨é¦–ä¸ªå¼‚å¸¸ä¸Šç»ˆæ­¢ï¼ˆå³ä½¿æ²¡æœ‰å¤„ç†å®Œæ‰€æœ‰å…ƒç´ ï¼‰åˆ™ä½¿ç”¨ std::promiseï¼Œå¦‚æœæƒ³è®©å…¶ä»–çº¿ç¨‹ç»§ç»­æœç´¢åˆ™ä½¿ç”¨ std::packaged_task ä¿å­˜æ‰€æœ‰å¼‚å¸¸ï¼Œå¹¶åœ¨æ²¡æœ‰æ‰¾åˆ°ç›®æ ‡å€¼æ—¶é‡æ–°æŠ›å‡ºå…¶ä¸­ä¸€ä¸ªå¼‚å¸¸ã€‚è¿™é‡Œé€‰æ‹©ä½¿ç”¨è¡Œä¸ºæ›´æ¥è¿‘ std::find çš„ std::promise #include \u003calgorithm\u003e #include \u003catomic\u003e #include \u003cfunctional\u003e #include \u003cfuture\u003e #include \u003cnumeric\u003e #include \u003cthread\u003e #include \u003cvector\u003e template \u003ctypename Iterator, typename T\u003e Iterator parallel_find(Iterator first, Iterator last, T match) { struct find_element { void operator()(Iterator begin, Iterator end, T match, std::promise\u003cIterator\u003e* res, std::atomic\u003cbool\u003e* done_flag) { try { for (; begin != end \u0026\u0026 !done_flag-\u003eload(); ++begin) { if (*begin == match) { res-\u003eset_value(begin); done_flag-\u003estore(true); return; } } } catch (...) { try { res-\u003eset_exception(std::current_exception()); done_flag-\u003estore(true); } catch (...) { } } } }; std::size_t len = std::distance(first, last); if (!len) { return last; } std::size_t min_per_thread = 25; std::size_t max_threads = (len + min_per_thread - 1) / min_per_thread; std::size_t hardware_threads = std::thread::hardware_concurrency(); std::size_t num_threads = std::min(hardware_threads != 0 ? hardware_threads : 2, max_threads); std::size_t block_size = len / num_threads; std::promise\u003cIterator\u003e res; std::atomic\u003cbool\u003e done_flag(false); { std::vector\u003cstd::jthread\u003e threads(num_threads - 1); Iterator block_start = first; for (auto\u0026 x : threads) { Iterator block_end = block_start; std::advance(block_end, block_size); x = std::jthread(find_element{}, block_start, block_end, match, \u0026res, \u0026done_flag); block_start = block_end; } find_element{}(block_start, last, match, \u0026res, \u0026done_flag); } if (!done_flag.load()) { return last; } return res.get_future().get(); } ä¹Ÿå¯ä»¥ä½¿ç”¨ std::async å®ç° #include \u003catomic\u003e #include \u003cfuture\u003e template \u003ctypename Iterator, typename T\u003e Iterator parallel_find_impl(Iterator first, Iterator last, T match, std::atomic\u003cbool\u003e\u0026 done_flag) { try { std::size_t len = std::distance(first, last); std::size_t min_per_thread = 25; if (len \u003c (2 * min_per_thread)) { for (; first != last \u0026\u0026 !done_flag.load(); ++first) { if (*first == match) { done_flag = true; return first; } } return last; } const Iterator mid_point = first + len / 2; std::future\u003cIterator\u003e async_res = std::async(\u0026parallel_find_impl\u003cIterator, T\u003e, mid_point, last, match, std::ref(done_flag)); const Iterator direct_res = parallel_find_impl(first, mid_point, match, done_flag); return direct_res == mid_point ? async_res.get() : direct_res; } catch (...) { done_flag = true; throw; } } template \u003ctypename Iterator, typename T\u003e Iterator parallel_find(Iterator first, Iterator last, T match) { std::atomic\u003cbool\u003e done_flag(false); return parallel_find_impl(first, last, match, done_flag); } ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:5:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å¹¶è¡Œç‰ˆ std::partial_sum std::partial_sum ä¼šä¾æ¬¡ç´¯åŠ å…ƒç´ çš„å’Œï¼ˆé»˜è®¤æ˜¯åŠ ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–äºŒå…ƒæ“ä½œï¼‰ #include \u003cnumeric\u003e #include \u003cvector\u003e int main() { std::vector\u003cint\u003e v{1, 2, 3, 4}; std::partial_sum( v.begin(), v.end(), std::ostream_iterator\u003cint\u003e(std::cout \u003c\u003c \"hi\"), // è¾“å‡ºåˆ°çš„è¿­ä»£å™¨èµ·å§‹ä½ç½® std::plus\u003cint\u003e{}); // ä½¿ç”¨çš„äºŒå…ƒè¿ç®—ç¬¦ï¼Œä¸æŒ‡å®šåˆ™é»˜è®¤ç´¯åŠ  } // è¾“å‡º hi13610 å…¶å®ç°ä¸º template \u003cclass InputIt, class OutputIt, class BinaryOperation\u003e OutputIt partial_sum(InputIt first, InputIt last, OutputIt d_first, BinaryOperation op) { if (first == last) { return d_first; } typename std::iterator_traits\u003cInputIt\u003e::value_type sum = *first; *d_first = sum; while (++first != last) { sum = op(std::move(sum), *first); *++d_first = sum; } return ++d_first; } å®ç°å¹¶è¡Œç‰ˆæœ¬æ—¶ï¼Œç¬¬ä¸€ç§åˆ’åˆ†æ–¹å¼å°±æ˜¯ä¼ ç»Ÿçš„æŒ‰å—åˆ’åˆ† 1 1 1 1 1 1 1 1 1 // è¾“å…¥ 9 ä¸ª 1 // åˆ’åˆ†ä¸ºä¸‰éƒ¨åˆ† 1 1 1 1 1 1 1 1 1 // å¾—åˆ°ä¸‰ä¸ªéƒ¨åˆ†çš„ç»“æœ 1 2 3 1 2 3 1 2 3 // å°†ç¬¬ä¸€éƒ¨åˆ†çš„å°¾å…ƒç´ ï¼ˆå³ 3ï¼‰åŠ åˆ°ç¬¬äºŒéƒ¨åˆ† 1 2 3 4 5 6 1 2 3 // å†å°†ç¬¬äºŒéƒ¨åˆ†çš„å°¾å…ƒç´ ï¼ˆå³ 6ï¼‰åŠ åˆ°ç¬¬ä¸‰éƒ¨åˆ† 1 2 3 4 5 6 7 8 9 ç”±äºéœ€è¦çº¿ç¨‹é—´åŒæ­¥ï¼Œè¿™ä¸ªå®ç°ä¸å®¹æ˜“ç®€å•åœ°ç”¨ std::async é‡å†™ #include \u003calgorithm\u003e #include \u003cfuture\u003e #include \u003cnumeric\u003e template \u003ctypename Iterator\u003e void parallel_partial_sum(Iterator first, Iterator last) { using value_type = typename Iterator::value_type; struct process_chunk { void operator()(Iterator begin, Iterator last, std::future\u003cvalue_type\u003e* previous_end_value, std::promise\u003cvalue_type\u003e* end_value) { try { Iterator end = last; ++end; std::partial_sum(begin, end, begin); if (previous_end_value) { // ä¸æ˜¯ç¬¬ä¸€ä¸ªå— value_type addend = previous_end_value-\u003eget(); *last += addend; if (end_value) { end_value-\u003eset_value(*last); } std::for_each(begin, last, [addend](value_type\u0026 item) { item += addend; }); } else if (end_value) { end_value-\u003eset_value(*last); // æ˜¯ç¬¬ä¸€ä¸ªå—åˆ™å¯ä»¥ä¸ºä¸‹ä¸ªå—æ›´æ–°å°¾å…ƒç´  } } catch (...) { // å¦‚æœæŠ›å‡ºå¼‚å¸¸åˆ™å­˜å‚¨åˆ° // std::promiseï¼Œå¼‚å¸¸ä¼šä¼ æ’­ç»™ä¸‹ä¸€ä¸ªå—ï¼ˆè·å–è¿™ä¸ªå—çš„å°¾å…ƒç´ æ—¶ï¼‰ if (end_value) { end_value-\u003eset_exception(std::current_exception()); } else { throw; // å¼‚å¸¸æœ€ç»ˆä¼ ç»™æœ€åä¸€ä¸ªå—ï¼Œæ­¤æ—¶å†æŠ›å‡ºå¼‚å¸¸ } } } }; std::size_t len = std::distance(first, last); if (!len) { return; } std::size_t min_per_thread = 25; std::size_t max_threads = (len + min_per_thread - 1) / min_per_thread; std::size_t hardware_threads = std::thread::hardware_concurrency(); std::size_t num_threads = std::min(hardware_threads != 0 ? hardware_threads : 2, max_threads); std::size_t block_size = len / num_threads; // end_values å­˜å‚¨å—å†…å°¾å…ƒç´ å€¼ std::vector\u003cstd::promise\u003cvalue_type\u003e\u003e end_values(num_threads - 1); // prev_end_values æ£€ç´¢å‰ä¸€ä¸ªå—çš„å°¾å…ƒç´  std::vector\u003cstd::future\u003cvalue_type\u003e\u003e prev_end_values; prev_end_values.reserve(num_threads - 1); Iterator block_start = first; std::vector\u003cstd::jthread\u003e threads(num_threads - 1); for (std::size_t i = 0; i \u003c num_threads - 1; ++i) { Iterator block_last = block_start; std::advance(block_last, block_size - 1); // æŒ‡å‘å°¾å…ƒç´  threads[i] = std::jthread(process_chunk{}, block_start, block_last, i != 0 ? \u0026prev_end_values[i - 1] : nullptr, \u0026end_values[i]); block_start = block_last; ++block_start; prev_end_values.emplace_back(end_values[i].get_future()); } Iterator final_element = block_start; std::advance(final_element, std::distance(block_start, last) - 1); process_chunk{}(block_start, final_element, num_threads \u003e 1 ? \u0026prev_end_values.back() : nullptr, nullptr); } å¦‚æœå¤„ç†å™¨æ ¸æ•°éå¸¸å¤šï¼Œå°±æ²¡å¿…è¦ä½¿ç”¨ä¸Šé¢çš„æ–¹å¼äº†ï¼Œå› ä¸ºè¿˜æœ‰å¹¶å‘åº¦æ›´é«˜çš„æ–¹å¼ï¼Œå³éš”ä¸€å®šè·ç¦»è®¡ç®—ï¼Œæ¯è½®è®¡ç®—å®Œæˆï¼Œä¸‹ä¸€è½®è®¡ç®—ä½¿ç”¨çš„è·ç¦»å˜ä¸ºä¹‹å‰çš„ä¸¤å€ã€‚è¿™ç§æ–¹å¼ä¸å†éœ€è¦è¿›ä¸€æ­¥åŒæ­¥ï¼Œå› ä¸ºæ‰€æœ‰ä¸­é—´çš„ç»“æœéƒ½ç›´æ¥ä¼ ç»™äº†ä¸‹ä¸€ä¸ªéœ€è¦è¿™äº›ç»“æœçš„å¤„ç†å™¨ï¼Œä½†å®é™…ä¸Šå¾ˆå°‘æœ‰å¤„ç†å™¨å¯ä»¥åœ¨å¤šæ¡æ•°æ®ä¸ŠåŒæ—¶æ‰§è¡ŒåŒä¸€æ¡æŒ‡ä»¤ï¼ˆå³ SIMDï¼‰ï¼Œå› æ­¤å¿…é¡»ä¸ºé€šç”¨æƒ…å†µè®¾è®¡ä»£ç ï¼Œåœ¨æ¯æ­¥æ“ä½œä¸Šæ˜¾å¼åŒæ­¥çº¿ç¨‹ï¼Œæ¯”å¦‚ä½¿ç”¨ barrier çš„åŒæ­¥æœºåˆ¶ï¼Œç›´åˆ°æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾ barrier æ—¶æ‰èƒ½ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ­¥ 1 1 1 1 1 1 1 1 1 // è¾“å…¥ 9 ä¸ª 1 // å…ˆè®©è·ç¦»ä¸º 1 çš„å…ƒç´ ç›¸åŠ  1 2 2 2 2 2 2 2 2 // å†è®©è·ç¦»ä¸º 2 çš„å…ƒç´ ç›¸åŠ  1 2 3 4 4 4 4 4 4 // å†è®©è·ç¦»ä¸º 4 çš„å…ƒç´ ç›¸åŠ  1 2 3 4 5 6 7 8 8 // å†è®©è·ç¦»ä¸º 8 çš„å…ƒç´ ç›¸åŠ  1 2 3 4 5 6 7 8 9 ","date":"2023-11-28","objectID":"/posts/ch08_designing_concurrent_code/:5:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [8] | CH08 Designing Concurrent Code","uri":"/posts/ch08_designing_concurrent_code/"},{"categories":["C++"],"content":"å¹¶å‘ç›¸å…³çš„ bug ç±»å‹ ä¸å¹¶å‘ç›´æ¥ç›¸å…³çš„ bug ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œä¸€æ˜¯éé¢„æœŸé˜»å¡ï¼ŒäºŒæ˜¯ race condition éé¢„æœŸé˜»å¡åŒ…å«ä»¥ä¸‹å‡ ç§æƒ…å†µ æ­»é”ï¼ˆdeadlockï¼‰ï¼šä¸¤ä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œå¯¼è‡´å‡æ— æ³•å®Œæˆå·¥ä½œã€‚æœ€æ˜æ˜¾çš„æƒ…å†µæ˜¯ï¼Œå¦‚æœè´Ÿè´£ç”¨æˆ·ç•Œé¢çš„çº¿ç¨‹æ­»é”ï¼Œç•Œé¢å°†å¤±å»å“åº”ã€‚ä¹Ÿæœ‰ä¸€äº›æƒ…å†µæ˜¯ï¼Œç•Œé¢å¯ä»¥ä¿æŒå“åº”ï¼Œä½†ä¸€äº›ä»»åŠ¡æ— æ³•å®Œæˆï¼Œæ¯”å¦‚æœç´¢ä¸è¿”å›ç»“æœï¼Œæˆ–è€…æ–‡æ¡£ä¸è¢«æ‰“å° æ´»é”ï¼ˆlivelockï¼‰ï¼šç±»ä¼¼äºæ­»é”ï¼Œä¸åŒçš„æ˜¯çº¿ç¨‹ä¸æ˜¯é˜»å¡ç­‰å¾…ï¼Œè€Œæ˜¯åœ¨å¿™ç¢Œäºä¸€ä¸ªæ£€æŸ¥å¾ªç¯ä¸­ï¼Œæ¯”å¦‚è‡ªæ—‹é”ã€‚ä¸¥é‡æ—¶ï¼Œå…¶è¡¨ç°çš„ç—‡çŠ¶å°±å’Œæ­»é”ä¸€æ ·ï¼Œæ¯”å¦‚ç¨‹åºä¸è¿›è¡Œï¼Œæ­¤å¤–ç”±äºçº¿ç¨‹ä»åœ¨è¿è¡Œï¼ŒCPU ä¼šå¤„äºé«˜ä½¿ç”¨ç‡çŠ¶æ€ã€‚åœ¨ä¸å¤ªä¸¥é‡çš„æƒ…å†µä¸‹ï¼Œæ´»é”æœ€ç»ˆä¼šè¢«æ“ä½œç³»ç»Ÿçš„éšæœºè°ƒåº¦è§£å†³ï¼Œä½†ä»ç„¶ä¼šé€ æˆä»»åŠ¡çš„é•¿æ—¶é—´å»¶è¿Ÿï¼Œå¹¶ä¸”å»¶è¿ŸæœŸé—´ CPU ä½¿ç”¨ç‡å¾ˆé«˜ I/O é˜»å¡æˆ–å…¶ä»–å¤–éƒ¨è¾“å…¥ï¼šå¦‚æœçº¿ç¨‹é˜»å¡ç­‰å¾…å¤–éƒ¨è¾“å…¥ï¼Œå°±æ— æ³•ç»§ç»­å¤„ç†å·¥ä½œã€‚å› æ­¤å¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡ä¼šè¢«å…¶ä»–çº¿ç¨‹ç­‰å¾…ï¼Œå°±ä¸è¦è®©è¿™ä¸ªçº¿ç¨‹ç­‰å¾…å¤–éƒ¨è¾“å…¥ è®¸å¤šæ­»é”å’Œæ´»é”éƒ½æ˜¯ç”±äº race condition é€ æˆçš„ï¼Œä¸è¿‡å¾ˆå¤§ä¸€éƒ¨åˆ† race condition æ˜¯è‰¯æ€§çš„ï¼Œæ¯”å¦‚è¦å¤„ç†ä»»åŠ¡é˜Ÿåˆ—çš„ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œå†³å®šç”¨å“ªä¸ªå·¥ä½œçº¿ç¨‹å»å¤„ç†æ˜¯æ— å…³ç´§è¦çš„ã€‚é€ æˆé—®é¢˜çš„ race condtion åŒ…å«ä»¥ä¸‹å‡ ç§æƒ…å†µ æ•°æ®ç«äº‰ï¼ˆdata raceï¼‰ï¼šæ•°æ®ç«äº‰æ˜¯ä¸€ç§ç‰¹å®šç±»å‹çš„ race condtionï¼Œç”±äºå¯¹å…±äº«å†…å­˜ä½ç½®çš„ä¸åŒæ­¥çš„å¹¶å‘è®¿é—®ï¼Œå®ƒå°†å¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚æ•°æ®ç«äº‰é€šå¸¸å‘ç”Ÿäºä¸æ­£ç¡®åœ°ä½¿ç”¨åŸå­æ“ä½œæ¥åŒæ­¥çº¿ç¨‹ï¼Œæˆ–è€…ä¸åŠ é”è®¿é—®å…±äº«æ•°æ® è¢«ç ´åçš„ä¸å˜é‡ï¼ˆbroken invariantï¼‰ï¼šå®ƒå¯ä»¥è¡¨ç°ä¸ºç©ºæ‚¬æŒ‡é’ˆï¼ˆå…¶ä»–çº¿ç¨‹å¯ä»¥åˆ é™¤è¢«è®¿é—®çš„æ•°æ®ï¼‰ã€éšæœºå†…å­˜æŸåï¼ˆç”±äºå±€éƒ¨æ›´æ–°å¯¼è‡´çº¿ç¨‹è¯»å–çš„å€¼ä¸ä¸€è‡´ï¼‰ã€åŒé‡é‡Šæ”¾ï¼ˆæ¯”å¦‚ä¸¤ä¸ªçº¿ç¨‹å¼¹å‡ºé˜Ÿåˆ—çš„åŒä¸€ä¸ªæ•°æ®ï¼‰ç­‰ã€‚ä¸å˜é‡çš„ç ´åæ˜¯æš‚æ—¶çš„ï¼Œå› ä¸ºå®ƒæ˜¯åŸºäºå€¼çš„ã€‚å¦‚æœä¸åŒçº¿ç¨‹ä¸Šçš„æ“ä½œè¦æ±‚ä»¥ä¸€ä¸ªç‰¹å®šé¡ºåºæ‰§è¡Œï¼Œä¸æ­£ç¡®çš„åŒæ­¥å°±ä¼šå¯¼è‡´ race conditionï¼Œæœ‰æ—¶å°±ä¼šè¿åè¿™ä¸ªæ‰§è¡Œé¡ºåº ç”Ÿå‘½å‘¨æœŸé—®é¢˜ï¼ˆlifetime issueï¼‰ï¼šè¿™ä¸ªé—®é¢˜å¯ä»¥å½’å…¥ broken invariantï¼Œä½†è¿™é‡Œå•ç‹¬æå‡ºæ¥ã€‚è¿™ä¸ªé—®é¢˜è¡¨ç°ä¸ºï¼Œçº¿ç¨‹æ¯”å…¶è®¿é—®çš„æ•°æ®æ´»å¾—æ›´é•¿ã€‚ä¸€èˆ¬è¿™ä¸ªé—®é¢˜å‘ç”Ÿäºçº¿ç¨‹å¼•ç”¨äº†è¶…å‡ºèŒƒå›´çš„å±€éƒ¨å˜é‡ï¼Œä½†ä¹Ÿä¸ä»…é™äºæ­¤ï¼Œæ¯”å¦‚è°ƒç”¨ joinï¼Œè¦è€ƒè™‘å¼‚å¸¸æŠ›å‡ºæ—¶ï¼Œè°ƒç”¨ä¸è¢«è·³è¿‡ é€šå¸¸å¯ä»¥é€šè¿‡è°ƒè¯•å™¨æ¥ç¡®è®¤æ­»é”å’Œæ´»é”çš„çº¿ç¨‹ä»¥åŠå®ƒä»¬äº‰ç”¨çš„åŒæ­¥å¯¹è±¡ã€‚å¯¹äºæ•°æ®ç«äº‰ã€ä¸å˜é‡çš„ç ´åã€ç”Ÿå‘½å‘¨æœŸé—®é¢˜ï¼Œå¯è§ç—‡çŠ¶ï¼ˆå¦‚éšæœºå´©æºƒæˆ–ä¸æ­£ç¡®çš„è¾“å‡ºï¼‰å¯ä»¥æ˜¾ç¤ºåœ¨ä»£ç çš„ä»»ä½•ä½ç½®ï¼Œä»£ç å¯èƒ½é‡å†™ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†ä½¿ç”¨çš„å†…å­˜ï¼Œå¹¶ä¸”å¾ˆä¹…ä»¥åæ‰è¢«è§¦åŠï¼Œè¿™ä¸ªé”™è¯¯å¯èƒ½åœ¨ç¨‹åºæ‰§è¡Œçš„åæœŸå‡ºç°åœ¨ä¸ bug ä»£ç å®Œå…¨æ— å…³çš„ä½ç½®ã€‚è¿™å°±æ˜¯å…±äº«å†…å­˜çš„çœŸæ­£ç¥¸ç«¯ï¼Œæ— è®ºå¦‚ä½•é™åˆ¶çº¿ç¨‹å¯¹æ•°æ®çš„è®¿é—®å’Œç¡®ä¿æ­£ç¡®çš„åŒæ­¥ï¼Œä»»ä½•çº¿ç¨‹éƒ½å¯ä»¥é‡å†™å…¶ä»–çº¿ç¨‹ä¸­çš„æ•°æ® ","date":"2023-11-28","objectID":"/posts/ch11_testing_and_debugging_multithreaded_application/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [11] | CH11 Testing and Debugging Multithreaded Applications","uri":"/posts/ch11_testing_and_debugging_multithreaded_application/"},{"categories":["C++"],"content":"å®šä½ bug çš„æ–¹æ³• ","date":"2023-11-28","objectID":"/posts/ch11_testing_and_debugging_multithreaded_application/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [11] | CH11 Testing and Debugging Multithreaded Applications","uri":"/posts/ch11_testing_and_debugging_multithreaded_application/"},{"categories":["C++"],"content":"code review è®©å…¶ä»–äººæˆ–è‡ªå·±è¿‡æ®µæ—¶é—´æ¥ code reviewï¼Œå› ä¸ºå¯¹ä»£ç ä¸ç†Ÿæ‚‰ï¼Œéœ€è¦æ€è€ƒä»£ç çš„å·¥ä½œæ–¹å¼ï¼Œçœ‹å¾…çš„è§’åº¦ä¹Ÿä¸ä¸€æ ·ï¼Œæ›´æœ‰å¯èƒ½å‘ç°æ½œåœ¨çš„é—®é¢˜ã€‚å¤šçº¿ç¨‹ä»£ç ä¸€èˆ¬æœ‰ä»¥ä¸‹é—®é¢˜ å“ªäº›æ•°æ®éœ€è¦è¢«ä¿æŠ¤ï¼Œä»¥é¿å…å¹¶å‘è®¿é—® å¦‚ä½•ç¡®ä¿æ•°æ®å¾—åˆ°ä¿æŠ¤ å…¶ä»–çº¿ç¨‹æ­¤æ—¶å¯èƒ½è¿è¡Œåˆ°ä»£ç çš„å“ªä¸ªä½ç½® è¿™ä¸ªçº¿ç¨‹æŒæœ‰å“ªäº›é” å…¶ä»–çº¿ç¨‹æŒæœ‰å“ªäº›é” åœ¨è¿™ä¸ªçº¿ç¨‹ä¸­å®Œæˆçš„æ“ä½œå’Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸­å®Œæˆçš„æ“ä½œä¹‹é—´æ˜¯å¦æœ‰ä»»ä½•æ’åºè¦æ±‚ï¼Œå¦‚ä½•æ‰§è¡Œè¿™äº›è¦æ±‚ è¿™ä¸ªçº¿ç¨‹è¯»çš„æ•°æ®æ˜¯å¦ä»ç„¶æœ‰æ•ˆï¼Œæ˜¯å¦å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹è¿‡ å‡è®¾å¦ä¸€ä¸ªçº¿ç¨‹åœ¨ä¿®æ”¹æ•°æ®ï¼Œè¿™æ„å‘³ç€ä»€ä¹ˆï¼Œå¦‚ä½•ç¡®ä¿è¿™ç§æƒ…å†µæ°¸è¿œä¸ä¼šå‘ç”Ÿ ","date":"2023-11-28","objectID":"/posts/ch11_testing_and_debugging_multithreaded_application/:2:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [11] | CH11 Testing and Debugging Multithreaded Applications","uri":"/posts/ch11_testing_and_debugging_multithreaded_application/"},{"categories":["C++"],"content":"æµ‹è¯• æµ‹è¯•å¤šçº¿ç¨‹ç¨‹åºçš„å›°éš¾åœ¨äºï¼Œå…·ä½“çš„çº¿ç¨‹è°ƒåº¦é¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼Œå¯¹äºç›¸åŒçš„è¾“å…¥ï¼Œå¾—åˆ°çš„ç»“æœå´ä¸ä¸€å®šç›¸åŒï¼Œç»“æœå¯èƒ½æœ‰æ—¶æ˜¯æ­£ç¡®çš„ï¼Œæœ‰æ—¶æ˜¯é”™è¯¯çš„ã€‚å› æ­¤å­˜åœ¨æ½œåœ¨çš„ race condition ä¹Ÿä¸æ„å‘³ç€æ€»ä¼šå¾—åˆ°å¤±è´¥çš„ç»“æœï¼Œæœ‰æ—¶å¯èƒ½ä¹Ÿä¼šæˆåŠŸ ç”±äºé‡ç°å¹¶å‘ç›¸å…³çš„ bug å¾ˆå›°éš¾ï¼Œæ‰€ä»¥å€¼å¾—ä»”ç»†è®¾è®¡æµ‹è¯•ã€‚æœ€å¥½è®©æ¯ä¸ªæµ‹è¯•è¿è¡Œæœ€å°æ•°é‡çš„ä»£ç ï¼Œè¿™æ ·åœ¨æµ‹è¯•å¤±è´¥æ—¶å¯ä»¥æœ€å¥½åœ°éš”ç¦»å‡ºé”™è¯¯ä»£ç ã€‚æ¯”å¦‚æµ‹è¯•ä¸€ä¸ªå¹¶å‘é˜Ÿåˆ—ï¼Œåˆ†åˆ«æµ‹è¯•å¹¶å‘çš„ push å’Œ pop çš„å·¥ä½œï¼Œå°±ç›´æ¥æ¯”æµ‹è¯•æ•´ä¸ªé˜Ÿåˆ—çš„åŠŸèƒ½è¦å¥½ ä¸ºäº†éªŒè¯é—®é¢˜æ˜¯å¦ä¸å¹¶å‘ç›¸å…³ï¼Œåº”è¯¥ä»æµ‹è¯•ä¸­æ¶ˆé™¤å¹¶å‘æ€§ã€‚å¤šçº¿ç¨‹ä¸­çš„ bug å¹¶ä¸æ„å‘³ç€ä¸€å®šæ˜¯å¹¶å‘ç›¸å…³çš„ï¼Œå¦‚æœä¸€ä¸ªé—®é¢˜åœ¨å•çº¿ç¨‹ä¸­ä¹Ÿæ€»æ˜¯å‡ºç°ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ bugï¼Œè€Œä¸æ˜¯å¹¶å‘ç›¸å…³çš„ bugã€‚å¦‚æœä¸€ä¸ªé—®é¢˜åœ¨å•æ ¸ç³»ç»Ÿä¸­æ¶ˆå¤±ï¼Œè€Œåœ¨å¤šæ ¸æˆ–å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­æ€»ä¼šå‡ºç°ï¼Œä¸€èˆ¬è¿™å°±å¯èƒ½æ˜¯ä¸€ä¸ª race conditionï¼Œæˆ–åŒæ­¥ã€å†…å­˜åºç›¸å…³çš„é—®é¢˜ æµ‹è¯•ç”¨ä¾‹ å•çº¿ç¨‹è°ƒç”¨ push() æˆ– pop()ï¼Œä»¥éªŒè¯ queue çš„åŸºæœ¬åŠŸèƒ½ ç©º queueï¼Œä¸€ä¸ªçº¿ç¨‹ push()ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ pop() ç©º queueï¼Œå¤šçº¿ç¨‹ push() æ»¡ queueï¼Œå¤šçº¿ç¨‹ push() ç©º queueï¼Œå¤šçº¿ç¨‹ pop() æ»¡ queueï¼Œå¤šçº¿ç¨‹ pop() æœ‰éƒ¨åˆ†æ•°æ®ä½†ä¸å¤Ÿæ‰€æœ‰çº¿ç¨‹ç”¨çš„ queueï¼Œå¤šçº¿ç¨‹ pop() ç©º queueï¼Œä¸€ä¸ªçº¿ç¨‹ pop()ï¼Œå¤šçº¿ç¨‹ push() æ»¡ queueï¼Œä¸€ä¸ªçº¿ç¨‹ pop()ï¼Œå¤šçº¿ç¨‹ push() ç©º queueï¼Œå¤šçº¿ç¨‹ pop()ï¼Œå¤šçº¿ç¨‹ push() æ»¡ queueï¼Œå¤šçº¿ç¨‹ pop()ï¼Œå¤šçº¿ç¨‹ push() æµ‹è¯•ç¯å¢ƒ å¤šçº¿ç¨‹åœ¨æ¯ç§ case ä¸­å…·ä½“æŒ‡å¤šå°‘çº¿ç¨‹ (3, 4, 1,024?) æ˜¯å¦æœ‰è¶³å¤Ÿçš„å¤„ç†å™¨ï¼Œè®©æ¯ä¸ªçº¿ç¨‹è¿è¡Œåœ¨è‡ªå·±çš„æ ¸ä¸Š åœ¨å“ªäº›å¤„ç†å™¨æ¶æ„ä¸Šè¿›è¡Œæµ‹è¯• å¦‚ä½•åˆç†å¯¹æµ‹è¯•ä¸­çš„ while éƒ¨åˆ† suitable scheduling ä¸€èˆ¬æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„ä»£ç å°±æ˜¯æ˜“äºæµ‹è¯•çš„ï¼Œè¿™äº›æ¡ä»¶å•çº¿ç¨‹å’Œå¤šçº¿ç¨‹ä¸­åŒæ ·é€‚ç”¨ æ¯ä¸ªå‡½æ•°å’Œç±»çš„è´£ä»»æ˜¯æ¸…æ™°çš„ å‡½æ•°ç®€æ˜æ‰¼è¦ï¼ˆshort and to the pointï¼‰ æµ‹è¯•å¯ä»¥å®Œå…¨æ§åˆ¶è¢«æµ‹ä»£ç æ‰€åœ¨ç¯å¢ƒ æ‰§è¡Œç‰¹å®šæ“ä½œçš„è¢«æµ‹ä»£ç åœ¨ç³»ç»Ÿä¸­æ˜¯ç´§å¯†è€Œéåˆ†æ•£çš„ ä»£ç åœ¨å†™ä¸‹ä¹‹å‰å·²è¢«è€ƒè™‘è¿‡å¦‚ä½•æµ‹è¯• ä¸ºäº†æµ‹è¯•è®¾è®¡å¹¶å‘ä»£ç çš„ä¸€ä¸ªæœ€å¥½æ–¹æ³•æ˜¯æ¶ˆé™¤å¹¶å‘ï¼Œå¦‚æœå¯ä»¥æŠŠä»£ç åˆ†è§£æˆè´Ÿè´£çº¿ç¨‹é—´é€šä¿¡è·¯å¾„çš„éƒ¨åˆ†ï¼Œä»¥åŠåœ¨å•çº¿ç¨‹ä¸­æ“ä½œé€šä¿¡æ•°æ®çš„éƒ¨åˆ†ï¼Œå°±å¯ä»¥æå¤§åœ°ç®€åŒ–é—®é¢˜ã€‚å¯¹äºæ“ä½œé€šä¿¡æ•°æ®çš„éƒ¨åˆ†å°±å¯ä»¥ç”¨å¸¸è§„çš„å•çº¿ç¨‹æŠ€æœ¯æµ‹è¯•ï¼Œå¯¹äºè´Ÿè´£çº¿ç¨‹é—´é€šä¿¡çš„éƒ¨åˆ†ï¼Œä»£ç å°äº†å¾ˆå¤šï¼Œæµ‹è¯•ä¹Ÿæ›´å®¹æ˜“ ","date":"2023-11-28","objectID":"/posts/ch11_testing_and_debugging_multithreaded_application/:2:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [11] | CH11 Testing and Debugging Multithreaded Applications","uri":"/posts/ch11_testing_and_debugging_multithreaded_application/"},{"categories":["C++"],"content":"å¤šçº¿ç¨‹æµ‹è¯•æŠ€æœ¯ ç¬¬ä¸€ç§æµ‹è¯•æŠ€æœ¯æ˜¯å‹åŠ›æµ‹è¯•ï¼Œéšç€ä»£ç è¿è¡Œæ¬¡æ•°çš„å¢åŠ ï¼Œbug å‡ºç°çš„å‡ ç‡ä¹Ÿæ›´é«˜ï¼Œå¦‚æœä»£ç è¿è¡Œåäº¿æ¬¡éƒ½é€šè¿‡ï¼Œä»£ç å°±å¾ˆå¯èƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚å¦‚æœæµ‹è¯•æ˜¯ç»†ç²’åº¦çš„ï¼ˆfine-grainedï¼‰ï¼Œæ¯”å¦‚å‰é¢å¯¹å¹¶å‘é˜Ÿåˆ—çš„æµ‹è¯•ï¼Œå‹åŠ›æµ‹è¯•å°±æ›´å¯é ã€‚å¦‚æœç²’åº¦éå¸¸å¤§ï¼Œå¯èƒ½çš„ç»„åˆä¹Ÿéå¸¸å¤šï¼Œå³ä½¿åäº¿æ¬¡çš„æµ‹è¯•çš„ç»“æœä¹Ÿä¸ç®—å¯é  å‹åŠ›æµ‹è¯•çš„ç¼ºç‚¹æ˜¯ï¼Œå¦‚æœæµ‹è¯•æœ¬æ¥å°±ä¿è¯äº†é—®é¢˜ä¸ä¼šå‘ç”Ÿï¼Œé‚£ä¹ˆæ— è®ºæµ‹è¯•å¤šå°‘æ¬¡éƒ½ä¸ä¼šå‡ºç°å¤±è´¥çš„æƒ…å†µï¼Œè¿™å°±ä¼šé€ æˆè¯¯å¯¼ã€‚æ¯”å¦‚åœ¨å•æ ¸ç³»ç»Ÿä¸Šæµ‹è¯•å¤šçº¿ç¨‹ç¨‹åºï¼Œrace condition å’Œä¹’ä¹“ç¼“å­˜çš„é—®é¢˜æ ¹æœ¬ä¸ä¼šå‡ºç°ï¼Œä½†è¿™ä¸è¡¨ç¤ºè¿™ä¸ªç¨‹åºåœ¨å¤šæ ¸ç³»ç»Ÿä¸Šæ˜¯æ²¡é—®é¢˜çš„ã€‚åˆæ¯”å¦‚ï¼Œä¸åŒå¤„ç†å™¨æ¶æ„æä¾›äº†ä¸åŒçš„åŒæ­¥å’Œå†…å­˜åºå·¥å…·ï¼Œåœ¨ x86 å’Œ x86-64 æ¶æ„ä¸Šï¼Œæ— è®ºä½¿ç”¨ memory_order_relaxed è¿˜æ˜¯ memory_order_seq_cst å†…å­˜åºï¼ŒåŸå­ load æ“ä½œæ€»æ˜¯ä¸€æ ·çš„ï¼Œè¿™æ„å‘³ç€åœ¨ x86 æ¶æ„ä¸Šä½¿ç”¨ relaxed è¯­ä¹‰æ€»æ˜¯å¯è¡Œçš„ï¼Œä½†å¦‚æœæ¢æˆç»†ç²’åº¦å†…å­˜åºæŒ‡ä»¤çš„ç³»ç»Ÿï¼ˆæ¯”å¦‚ SPARCï¼‰å°±ä¼šå¤±è´¥ ç¬¬äºŒç§æµ‹è¯•æŠ€æœ¯æ˜¯ç»„åˆä»¿çœŸæµ‹è¯•ï¼ˆcombination simulation testingï¼‰ï¼Œå³ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„è½¯ä»¶æ¥ä»¿çœŸçœŸå®çš„è¿è¡Œæ—¶ç¯å¢ƒã€‚ä»¿çœŸè½¯ä»¶å°†è®°å½•æ•°æ®è®¿é—®ã€é”å®šã€åŸå­æ“ä½œçš„åºåˆ—ï¼Œç„¶åä½¿ç”¨ C++ å†…å­˜æ¨¡å‹çš„è§„åˆ™æ¥é‡å¤è¿è¡Œæ‰€æœ‰å¯èƒ½çš„æ“ä½œç»„åˆï¼Œä»¥ç¡®å®š race condition å’Œæ­»é” è™½ç„¶è¿™ç§è¯¦å°½çš„ç»„åˆæµ‹è¯•å¯ä»¥ä¿è¯æ‰¾åˆ°è®¾è®¡æ‰€è¦æ£€æµ‹çš„æ‰€æœ‰é—®é¢˜ï¼Œä½†ä¼šèŠ±è´¹å¤§é‡æ—¶é—´ï¼Œå› ä¸ºç»„åˆçš„æ•°é‡éšçº¿ç¨‹ æ•°å’Œæ¯ä¸ªçº¿ç¨‹æ‰§è¡Œçš„æ“ä½œæ•°å‘ˆæŒ‡æ•°å¢é•¿ï¼Œå®ƒæœ€å¥½ç”¨äºå•ä¸ªä»£ç ç‰‡æ®µçš„ç»†ç²’åº¦æµ‹è¯•ï¼Œè€Œéç”¨äºæ•´ä¸ªç¨‹åºã€‚è¿™ç§æŠ€æœ¯çš„å¦ä¸€ä¸ªæ˜æ˜¾ç¼ºç‚¹æ˜¯ï¼Œå®ƒè¦æ±‚è®¿çœŸè½¯ä»¶èƒ½å¤„ç†ä»£ç ä¸­çš„æ“ä½œ ç¬¬ä¸‰ç§æµ‹è¯•æŠ€æœ¯æ˜¯ä½¿ç”¨ä¸“é—¨çš„åº“ã€‚æ¯”å¦‚å…±äº«æ•°æ®é€šå¸¸ä¼šç”¨ mutex ä¿æŠ¤ï¼Œå¦‚æœåœ¨è®¿é—®æ•°æ®æ—¶èƒ½æ£€æŸ¥å“ªäº› mutex è¢«é”å®šäº†ï¼Œå°±èƒ½éªŒè¯çº¿ç¨‹åœ¨è®¿é—®æ•°æ®æ—¶æ˜¯å¦é”å®šäº†ç›¸åº”çš„ mutexï¼Œå¦‚æœæ²¡æœ‰é”å®šå°±æŠ¥å‘Šå¤±è´¥ã€‚åº“å®ç°ä¹Ÿèƒ½è®°å½•ä¸Šé”çš„é¡ºåºï¼Œå¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ª mutex ä»¥ä¸åŒé¡ºåºä¸Šé”ï¼Œè¿™å°±ä¼šè¢«è®°å½•ä¸ºæ½œåœ¨çš„æ­»é” å¦ä¸€ç§ç±»å‹çš„åº“æ˜¯ï¼ŒåŒæ­¥åŸè¯­çš„å®ç°å…è®¸æµ‹è¯•ç¼–å†™è€…åœ¨å¤šçº¿ç¨‹ç­‰å¾…æ—¶ï¼Œå¯ä»¥æ§åˆ¶å“ªä¸ªçº¿ç¨‹æ¥è·å¾—é”ï¼Œæˆ–è€…å“ªä¸ªçº¿ç¨‹è¢« notify_one é€šçŸ¥ã€‚è¿™å°±å…è®¸è®¾ç½®ç‰¹å®šæ–¹æ¡ˆï¼Œæ¥éªŒè¯ä»£ç æ˜¯å¦åœ¨è¿™äº›æ–¹æ¡ˆä¸­æŒ‰é¢„æœŸè¿è¡Œ ä¸€äº›æµ‹è¯•å·¥å…·å·²ç»ä½œä¸ºæ ‡å‡†åº“å®ç°çš„ä¸€éƒ¨åˆ†æä¾›äº†ï¼Œå…¶ä»–çš„åˆ™å¯ä»¥åŸºäºæ ‡å‡†åº“çš„éƒ¨åˆ†æ‰‹åŠ¨å®ç° ","date":"2023-11-28","objectID":"/posts/ch11_testing_and_debugging_multithreaded_application/:2:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [11] | CH11 Testing and Debugging Multithreaded Applications","uri":"/posts/ch11_testing_and_debugging_multithreaded_application/"},{"categories":["C++"],"content":"æ„å»ºå¤šçº¿ç¨‹æµ‹è¯•ä»£ç  å¤šçº¿ç¨‹æµ‹è¯•ä»£ç å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ éƒ¨åˆ† å¿…é¡»å…ˆæ‰§è¡Œçš„æ€»ä½“è®¾ç½® å¿…é¡»è¿è¡Œåœ¨æ¯ä¸ªçº¿ç¨‹ä¸Šçš„çº¿ç¨‹ç‰¹å®šçš„è®¾ç½® è¦å¹¶å‘è¿è¡Œåœ¨æ¯ä¸ªçº¿ç¨‹ä¸Šçš„ä»£ç  å¹¶å‘æ‰§è¡Œç»“æŸåçš„çŠ¶æ€æ–­è¨€ å¦‚ä¸‹æ˜¯å¯¹ä¸€ä¸ªé˜Ÿåˆ—çš„æµ‹è¯•ä»£ç  void test_concurrent_push_and_pop_on_empty_queue() { ConcurrentQueue\u003cint\u003e q; // æ€»ä½“è®¾ç½®ï¼šå…ˆåˆ›å»ºä¸€ä¸ªé˜Ÿåˆ— std::promise\u003cvoid\u003e go, push_ready, pop_ready; std::shared_future\u003cvoid\u003e ready(go.get_future()); std::future\u003cvoid\u003e push_done; std::future\u003cint\u003e pop_done; try { push_done = std::async( std::launch::async, // æŒ‡å®šå¼‚æ­¥ç­–ç•¥ä¿è¯æ¯ä¸ªä»»åŠ¡è¿è¡Œåœ¨è‡ªå·±çš„çº¿ç¨‹ä¸Š [\u0026q, ready, \u0026push_ready]() { push_ready.set_value(); ready.wait(); q.push(42); // çº¿ç¨‹ç‰¹å®šçš„è®¾ç½®ï¼šå­˜å…¥ä¸€ä¸ª int }); pop_done = std::async(std::launch::async, [\u0026q, ready, \u0026pop_ready]() { pop_ready.set_value(); ready.wait(); return q.try_pop(); }); push_ready.get_future().wait(); // ç­‰å¾…å¼€å§‹æµ‹è¯•çš„é€šçŸ¥ pop_ready.get_future().wait(); // åŒä¸Š go.set_value(); // é€šçŸ¥å¼€å§‹çœŸæ­£çš„æµ‹è¯• push_done.get(); // è·å–ç»“æœ assert(pop_done.get() == 42); // è·å–ç»“æœ assert(q.empty()); } catch (...) { go.set_value(); // é¿å…ç©ºæ‚¬æŒ‡é’ˆ throw; // å†æŠ›å‡ºå¼‚å¸¸ } } ","date":"2023-11-28","objectID":"/posts/ch11_testing_and_debugging_multithreaded_application/:2:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [11] | CH11 Testing and Debugging Multithreaded Applications","uri":"/posts/ch11_testing_and_debugging_multithreaded_application/"},{"categories":["C++"],"content":"æµ‹è¯•å¤šçº¿ç¨‹ä»£ç çš„æ€§èƒ½ ä½¿ç”¨å¹¶å‘çš„ä¸€ä¸ªä¸»è¦ç›®çš„å°±æ˜¯åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨æ¥æé«˜ç¨‹åºæ€§èƒ½ï¼Œå› æ­¤æµ‹è¯•ä»£ç æ¥ç¡®ä¿æ€§èƒ½ç¡®å®æå‡äº†æ˜¯å¾ˆé‡è¦çš„ã€‚æ€§èƒ½ç›¸å…³çš„ä¸€ä¸ªä¸»è¦æ–¹é¢å°±æ˜¯å¯æ‰©å±•æ€§ï¼Œæ€§èƒ½åº”è¯¥éšç€æ ¸æ•°ä¸€èµ·æå‡ã€‚åœ¨æµ‹è¯•å¤šçº¿ç¨‹ä»£ç æ€§èƒ½æ—¶ï¼Œæœ€å¥½åœ¨å°½å¯èƒ½å¤šçš„ä¸åŒé…ç½®ä¸Šè¿›è¡Œæµ‹è¯• ","date":"2023-11-28","objectID":"/posts/ch11_testing_and_debugging_multithreaded_application/:2:5","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [11] | CH11 Testing and Debugging Multithreaded Applications","uri":"/posts/ch11_testing_and_debugging_multithreaded_application/"},{"categories":["C++"],"content":"æ‰§è¡Œç­–ç•¥ï¼ˆexecution policyï¼‰ C++17 å¯¹æ ‡å‡†åº“ç®—æ³•é‡è½½äº†å¹¶è¡Œç‰ˆæœ¬ï¼ŒåŒºåˆ«æ˜¯å¤šäº†ä¸€ä¸ªæŒ‡å®šæ‰§è¡Œç­–ç•¥çš„å‚æ•° std::vector\u003cint\u003e v; std::sort(std::execution::par, v.begin(), v.end()); std::execution::par è¡¨ç¤ºå…è®¸å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œæ­¤ç®—æ³•ï¼Œæ³¨æ„è¿™æ˜¯ä¸€ä¸ªæƒé™ï¼ˆpermissionï¼‰è€Œéå¼ºåˆ¶è¦æ±‚ï¼ˆrequirementï¼‰ï¼Œæ­¤ç®—æ³•ä¾ç„¶å¯ä»¥è¢«å•çº¿ç¨‹æ‰§è¡Œ å¦å¤–ï¼Œå¦‚æœæŒ‡å®šäº†æ‰§è¡Œç­–ç•¥ï¼Œç®—æ³•å¤æ‚åº¦çš„è¦æ±‚ä¹Ÿæ›´å®½æ¾ï¼Œå› ä¸ºå¹¶è¡Œç®—æ³•ä¸ºäº†åˆ©ç”¨å¥½ç³»ç»Ÿçš„å¹¶è¡Œæ€§é€šå¸¸è¦åšæ›´å¤šå·¥ä½œã€‚æ¯”å¦‚æŠŠå·¥ä½œåˆ’åˆ†ç»™ 100 ä¸ªå¤„ç†å™¨ï¼Œå³ä½¿æ€»å·¥ä½œæ˜¯åŸæ¥çš„ä¸¤å€ï¼Œä¹Ÿä»ç„¶èƒ½è·å¾—åŸæ¥çš„äº”åå€çš„æ€§èƒ½ \u003cexecution\u003e ä¸­æŒ‡å®šäº†å¦‚ä¸‹æ‰§è¡Œç­–ç•¥ç±» std::execution::sequenced_policy std::execution::parallel_policy std::execution::parallel_unsequenced_policy std::execution::unsequenced_policy // C++20 å¹¶æŒ‡å®šäº†å¯¹åº”çš„å…¨å±€å¯¹è±¡ std::execution::seq std::execution::par std::execution::par_unseq std::execution::unseq // C++20 å¦‚æœä½¿ç”¨æ‰§è¡Œç­–ç•¥ï¼Œç®—æ³•çš„è¡Œä¸ºå°±ä¼šå—æ‰§è¡Œç­–ç•¥å½±å“ï¼Œå½±å“æ–¹é¢åŒ…æ‹¬ï¼šç®—æ³•å¤æ‚åº¦ã€æŠ›å¼‚å¸¸æ—¶çš„è¡Œä¸ºã€ç®—æ³•æ­¥éª¤çš„æ‰§è¡Œä½ç½®ï¼ˆwhereï¼‰ã€æ–¹å¼ï¼ˆhowï¼‰ã€æ—¶åˆ»ï¼ˆwhenï¼‰ é™¤äº†ç®¡ç†å¹¶è¡Œæ‰§è¡Œçš„è°ƒåº¦å¼€é”€ï¼Œè®¸å¤šå¹¶è¡Œç®—æ³•ä¼šæ‰§è¡Œæ›´å¤šçš„æ ¸å¿ƒæ“ä½œï¼ˆäº¤æ¢ã€æ¯”è¾ƒã€ä½¿ç”¨å‡½æ•°å¯¹è±¡ç­‰ï¼‰ï¼Œè¿™æ ·å¯ä»¥å‡å°‘æ€»çš„å®é™…æ¶ˆè€—æ—¶é—´ï¼Œä»è€Œå…¨é¢æå‡æ€§èƒ½ã€‚è¿™å°±æ˜¯ç®—æ³•å¤æ‚åº¦å—å½±å“çš„åŸå› ï¼Œå…¶å…·ä½“æ”¹å˜å› ç®—æ³•ä¸åŒè€Œå¼‚ åœ¨ä¸æŒ‡å®šæ‰§è¡Œç­–ç•¥æ—¶ï¼Œå¦‚ä¸‹å¯¹ç®—æ³•çš„è°ƒç”¨ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸ä¼šè¢«ä¼ æ’­ std::for_each(v.begin(), v.end(), [](auto x) { throw my_exception(); }); è€ŒæŒ‡å®šæ‰§è¡Œç­–ç•¥æ—¶ï¼Œå¦‚æœç®—æ³•æ‰§è¡ŒæœŸé—´æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™è¡Œä¸ºç»“æœç”±æ‰§è¡Œç­–ç•¥å†³å®šã€‚å¦‚æœæœ‰ä»»ä½•æœªæ•è·çš„å¼‚å¸¸ï¼Œæ‰§è¡Œç­–ç•¥å°†è°ƒç”¨ std::terminate ç»ˆæ­¢ç¨‹åºï¼Œå”¯ä¸€å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æƒ…å†µæ˜¯ï¼Œå†…éƒ¨æ“ä½œä¸èƒ½è·å–è¶³å¤Ÿçš„å†…å­˜èµ„æºæ—¶æŠ›å‡º std::bad_allocã€‚å¦‚ä¸‹æ“ä½œå°†è°ƒç”¨ std::terminate ç»ˆæ­¢ç¨‹åº std::for_each(std::execution::seq, v.begin(), v.end(), [](auto x) { throw my_exception(); }); ä¸åŒçš„æ‰§è¡Œç­–ç•¥çš„æ‰§è¡Œæ–¹å¼ä¹Ÿä¸ç›¸åŒã€‚æ‰§è¡Œç­–ç•¥ä¼šæŒ‡å®šæ‰§è¡Œç®—æ³•æ­¥éª¤çš„ä»£ç†ï¼Œå¯ä»¥æ˜¯å¸¸è§„çº¿ç¨‹ã€çŸ¢é‡æµã€GPU çº¿ç¨‹æˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚æ‰§è¡Œç­–ç•¥ä¹Ÿä¼šæŒ‡å®šç®—æ³•æ­¥éª¤è¿è¡Œçš„é¡ºåºé™åˆ¶ï¼Œæ¯”å¦‚æ˜¯å¦è¦ä»¥ç‰¹å®šé¡ºåºè¿è¡Œã€ä¸åŒç®—æ³•æ­¥éª¤çš„ä¸€éƒ¨åˆ†æ˜¯å¦å¯ä»¥äº’ç›¸äº¤é”™æˆ–å¹¶è¡Œè¿è¡Œç­‰ã€‚ä¸‹é¢å¯¹ä¸åŒçš„æ‰§è¡Œç­–ç•¥è¿›è¡Œè¯¦ç»†è§£é‡Š ","date":"2023-11-28","objectID":"/posts/ch10_parallel_algorithm/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [10] | CH10 Parallel Algorithm","uri":"/posts/ch10_parallel_algorithm/"},{"categories":["C++"],"content":"std::execution::sequenced_policy std::execution::sequenced_policy ç­–ç•¥è¦æ±‚å¯ä»¥ä¸ï¼ˆmay notï¼‰å¹¶è¡Œæ‰§è¡Œï¼Œæ‰€æœ‰æ“ä½œå°†æ‰§è¡Œåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šã€‚ä½†å®ƒä¹Ÿæ˜¯æ‰§è¡Œç­–ç•¥ï¼Œå› æ­¤ä¸å…¶ä»–æ‰§è¡Œç­–ç•¥ä¸€æ ·ä¼šå½±å“ç®—æ³•å¤æ‚åº¦å’Œå¼‚å¸¸è¡Œä¸º æ‰€æœ‰æ‰§è¡Œåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šçš„æ“ä½œå¿…é¡»ä»¥æŸä¸ªç¡®å®šé¡ºåºæ‰§è¡Œï¼Œå› æ­¤è¿™äº›æ“ä½œæ˜¯ä¸èƒ½äº’ç›¸äº¤é”™çš„ã€‚ä½†ä¸è§„å®šå…·ä½“é¡ºåºï¼Œå› æ­¤å¯¹äºä¸åŒçš„å‡½æ•°è°ƒç”¨å¯èƒ½äº§ç”Ÿä¸åŒçš„é¡ºåº std::vector\u003cint\u003e v(1000); int n = 0; // æŠŠ 1-1000 å­˜å…¥å®¹å™¨ï¼Œå­˜å…¥é¡ºåºå¯èƒ½æ˜¯é¡ºåºä¹Ÿå¯èƒ½æ˜¯ä¹±åº std::for_each(std::execution::seq, v.begin(), v.end(), [\u0026](int\u0026 x) { x = ++n; }); å› æ­¤ std::execution::sequenced_policy ç­–ç•¥å¾ˆå°‘è¦æ±‚ç®—æ³•ä½¿ç”¨è¿­ä»£å™¨ã€å€¼ã€å¯è°ƒç”¨å¯¹è±¡ï¼Œå®ƒä»¬å¯ä»¥è‡ªç”±åœ°ä½¿ç”¨åŒæ­¥æœºåˆ¶ï¼Œå¯ä»¥ä¾èµ–äºåŒä¸€çº¿ç¨‹ä¸Šè°ƒç”¨çš„æ“ä½œï¼Œå°½ç®¡ä¸èƒ½ä¾èµ–äºè¿™äº›æ“ä½œçš„é¡ºåº ","date":"2023-11-28","objectID":"/posts/ch10_parallel_algorithm/:1:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [10] | CH10 Parallel Algorithm","uri":"/posts/ch10_parallel_algorithm/"},{"categories":["C++"],"content":"std::execution::parallel_policy std::execution::parallel_policy ç­–ç•¥æä¾›äº†åŸºæœ¬çš„è·¨å¤šä¸ªçº¿ç¨‹çš„å¹¶è¡Œæ‰§è¡Œï¼Œæ“ä½œå¯ä»¥æ‰§è¡Œåœ¨è°ƒç”¨ç®—æ³•çš„çº¿ç¨‹ä¸Šï¼Œæˆ–æ‰§è¡Œåœ¨ç”±åº“åˆ›å»ºçš„çº¿ç¨‹ä¸Šï¼Œåœ¨ä¸€ä¸ªç»™å®šçº¿ç¨‹ä¸Šçš„æ“ä½œå¿…é¡»ä»¥ç¡®å®šé¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”ä¸èƒ½ç›¸äº’äº¤é”™ã€‚åŒæ ·è¿™ä¸ªé¡ºåºæ˜¯æœªæŒ‡å®šçš„ï¼Œå¯¹äºä¸åŒçš„è°ƒç”¨å¯èƒ½ä¼šæœ‰ä¸åŒçš„é¡ºåºã€‚ä¸€ä¸ªç»™å®šçš„æ“ä½œå°†åœ¨ä¸€ä¸ªå›ºå®šçš„çº¿ç¨‹ä¸Šè¿è¡Œå®Œæ•´ä¸ªå‘¨æœŸ å› æ­¤ std::execution::parallel_policy ç­–ç•¥å¯¹äºè¿­ä»£å™¨ã€å€¼ã€å¯è°ƒç”¨å¯¹è±¡çš„ä½¿ç”¨å°±æœ‰ä¸€å®šè¦æ±‚ï¼Œå®ƒä»¬åœ¨å¹¶è¡Œè°ƒç”¨æ—¶ä¸èƒ½é€ æˆæ•°æ®ç«äº‰ï¼Œå¹¶ä¸”ä¸èƒ½ä¾èµ–äºç»Ÿä¸€çº¿ç¨‹ä¸Šçš„å…¶ä»–æ“ä½œï¼Œæˆ–è€…è¯´åªèƒ½ä¾èµ–äºä¸è¿è¡Œåœ¨åŒä¸€çº¿ç¨‹ä¸Šçš„å…¶ä»–æ“ä½œ å¤§å¤šæ•°æƒ…å†µéƒ½å¯ä»¥ä½¿ç”¨ std::execution::parallel_policy ç­–ç•¥ std::for_each(std::execution::par, v.begin(), v.end(), [](auto\u0026 x) { ++x; }); åªæœ‰åœ¨å…ƒç´ ä¹‹é—´æœ‰ç‰¹å®šé¡ºåºæˆ–å¯¹å…±äº«æ•°æ®çš„è®¿é—®ä¸åŒæ­¥æ—¶ï¼Œå®ƒæ‰æœ‰é—®é¢˜ std::vector\u003cint\u003e v(1000); int n = 0; std::for_each(std::execution::par, v.begin(), v.end(), [\u0026](int\u0026 x) { x = ++n; }); // å¦‚æœå¤šä¸ªçº¿ç¨‹æ‰§è¡Œ lambda å°±ä¼šå¯¹ n äº§ç”Ÿæ•°æ®ç«äº‰ å› æ­¤ä½¿ç”¨ std::execution::parallel_policy ç­–ç•¥æ—¶ï¼Œåº”è¯¥äº‹å…ˆè€ƒè™‘å¯èƒ½å‡ºç°çš„æœªå®šä¹‰è¡Œä¸ºã€‚å¯ä»¥ç”¨ mutex æˆ–åŸå­å˜é‡æ¥è§£å†³ç«äº‰é—®é¢˜ï¼Œä½†è¿™å°±å½±å“äº†å¹¶å‘æ€§ã€‚ä¸è¿‡è¿™ä¸ªä¾‹å­åªæ˜¯ä¸ºäº†é˜è¿°æ­¤æƒ…å†µï¼Œä¸€èˆ¬ä½¿ç”¨ std::execution::parallel_policy ç­–ç•¥æ—¶éƒ½æ˜¯å…è®¸åŒæ­¥è®¿é—®å…±äº«æ•°æ®çš„ ","date":"2023-11-28","objectID":"/posts/ch10_parallel_algorithm/:1:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [10] | CH10 Parallel Algorithm","uri":"/posts/ch10_parallel_algorithm/"},{"categories":["C++"],"content":"std::execution::parallel_unsequenced_policy std::execution::parallel_unsequenced_policy ç­–ç•¥æä¾›äº†æœ€å¤§å¯èƒ½çš„å¹¶è¡ŒåŒ–ï¼Œä»£ä»·æ˜¯å¯¹ç®—æ³•ä½¿ç”¨çš„è¿­ä»£å™¨ã€å€¼å’Œå¯è°ƒç”¨å¯¹è±¡æœ‰æœ€ä¸¥æ ¼çš„çš„è¦æ±‚ ä½¿ç”¨ std::execution::parallel_unsequenced_policy ç­–ç•¥çš„ç®—æ³•å…è®¸ä»¥æ— åºçš„æ–¹å¼åœ¨ä»»æ„æœªæŒ‡å®šçš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­å½¼æ­¤ä¸æ’åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ“ä½œå¯ä»¥åœ¨å•ä¸ªçº¿ç¨‹ä¸Šäº’ç›¸äº¤é”™ï¼ŒåŒä¸€çº¿ç¨‹ä¸Šçš„ç¬¬äºŒä¸ªæ“ä½œå¯ä»¥å¼€å§‹äºç¬¬ä¸€ä¸ªæ“ä½œç»“æŸå‰ï¼Œå¹¶ä¸”å¯ä»¥åœ¨çº¿ç¨‹é—´è¿ç§»ï¼Œä¸€ä¸ªç»™å®šçš„æ“ä½œå¯ä»¥å¼€å§‹äºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿è¡Œäºå¦ä¸€çº¿ç¨‹ï¼Œè€Œå®Œæˆäºç¬¬ä¸‰ä¸ªçº¿ç¨‹ ä½¿ç”¨ std::execution::parallel_unsequenced_policy ç­–ç•¥æ—¶ï¼Œæä¾›ç»™ç®—æ³•çš„è¿­ä»£å™¨ã€å€¼ã€å¯è°ƒç”¨å¯¹è±¡ä¸Šçš„æ“ä½œä¸èƒ½ä½¿ç”¨ä»»ä½•å½¢å¼çš„åŒæ­¥ï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ä¸å…¶ä»–ä»£ç åŒæ­¥çš„ä»»ä½•å‡½æ•°ã€‚è¿™æ„å‘³ç€æ“ä½œåªèƒ½ä½œç”¨äºç›¸å…³å…ƒç´ ï¼Œæˆ–ä»»ä½•åŸºäºè¿™äº›å…ƒç´ çš„å¯è®¿é—®æ•°æ®ï¼Œå¹¶ä¸”ä¸èƒ½ä¿®æ”¹ä»»ä½•çº¿ç¨‹é—´æˆ–å…ƒç´ é—´çš„å…±äº«æ•°æ® ","date":"2023-11-28","objectID":"/posts/ch10_parallel_algorithm/:1:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [10] | CH10 Parallel Algorithm","uri":"/posts/ch10_parallel_algorithm/"},{"categories":["C++"],"content":"æ ‡å‡†åº“å¹¶è¡Œç®—æ³• \u003calgorithm\u003e å’Œ \u003cnumberic\u003e ä¸­çš„å¤§éƒ¨åˆ†ç®—æ³•éƒ½é‡è½½äº†å¹¶è¡Œç‰ˆæœ¬ã€‚std::accumlate æ²¡æœ‰å¹¶è¡Œç‰ˆæœ¬ï¼Œä½† C++17 æä¾›äº† std::reduce std::accumulate(v.begin(), v.end(), 0); std::reduce(std::execution::par, v.begin(), v.end()); å¦‚æœå¸¸è§„ç®—æ³•æœ‰å¹¶è¡Œç‰ˆçš„é‡è½½ï¼Œåˆ™å¹¶è¡Œç‰ˆå¯¹å¸¸è§„ç®—æ³•åŸæœ‰çš„æ‰€æœ‰é‡è½½éƒ½æœ‰ä¸€ä¸ªå¯¹åº”é‡è½½ç‰ˆæœ¬ template \u003cclass RandomIt\u003e void sort(RandomIt first, RandomIt last); template \u003cclass RandomIt, class Compare\u003e void sort(RandomIt first, RandomIt last, Compare comp); // å¹¶è¡Œç‰ˆå¯¹åº”æœ‰ä¸¤ä¸ªé‡è½½ template \u003cclass ExecutionPolicy, class RandomIt\u003e void sort(ExecutionPolicy\u0026\u0026 policy, RandomIt first, RandomIt last); template \u003cclass ExecutionPolicy, class RandomIt, class Compare\u003e void sort(ExecutionPolicy\u0026\u0026 policy, RandomIt first, RandomIt last, Compare comp); ä½†å¹¶è¡Œç‰ˆçš„é‡è½½å¯¹éƒ¨åˆ†ç®—æ³•æœ‰ä¸€äº›åŒºåˆ«ï¼Œå¦‚æœå¸¸è§„ç‰ˆæœ¬ä½¿ç”¨çš„æ˜¯è¾“å…¥è¿­ä»£å™¨ï¼ˆinput iteratorï¼‰æˆ–è¾“å‡ºè¿­ä»£å™¨ï¼ˆoutput iteratorï¼‰ï¼Œåˆ™å¹¶è¡Œç‰ˆçš„é‡è½½å°†ä½¿ç”¨å‰å‘è¿­ä»£å™¨ï¼ˆforward iteratorï¼‰ template \u003cclass InputIt, class OutputIt\u003e OutputIt copy(InputIt first, InputIt last, OutputIt d_first); template \u003cclass ExecutionPolicy, class ForwardIt1, class ForwardIt2\u003e ForwardIt2 copy(ExecutionPolicy\u0026\u0026 policy, ForwardIt1 first, ForwardIt1 last, ForwardIt2 d_first); è¾“å…¥è¿­ä»£å™¨åªèƒ½ç”¨æ¥è¯»å–æŒ‡å‘çš„å€¼ï¼Œè¿­ä»£å™¨è‡ªå¢åå°±å†ä¹Ÿæ— æ³•è®¿é—®ä¹‹å‰æŒ‡å‘çš„å€¼ï¼Œå®ƒä¸€èˆ¬ç”¨äºä»æ§åˆ¶å°æˆ–ç½‘ç»œè¾“å…¥ï¼Œæˆ–ç”Ÿæˆåºåˆ—ï¼Œæ¯”å¦‚ std::istream_iteratorã€‚åŒç†ï¼Œè¾“å‡ºè¿­ä»£å™¨ä¸€èˆ¬ç”¨æ¥è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œæˆ–æ·»åŠ å€¼åˆ°å®¹å™¨ï¼Œä¹Ÿæ˜¯å•å‘çš„ï¼Œæ¯”å¦‚ std::ostream_iterator å‰å‘è¿­ä»£å™¨è¿”å›å…ƒç´ çš„å¼•ç”¨ï¼Œå› æ­¤å¯ä»¥ç”¨äºè¯»å†™ï¼Œå®ƒåŒæ ·åªèƒ½å•å‘ä¼ é€’ï¼Œstd::forward_list çš„è¿­ä»£å™¨å°±æ˜¯å‰å‘è¿­ä»£å™¨ï¼Œè™½ç„¶å®ƒä¸å¯ä»¥å›åˆ°ä¹‹å‰æŒ‡å‘çš„å€¼ï¼Œä½†å¯ä»¥å­˜å‚¨ä¸€ä¸ªæŒ‡å‘ä¹‹å‰å…ƒç´ çš„æ‹·è´ï¼ˆæ¯”å¦‚ std::forward_list::beginï¼‰æ¥é‡å¤åˆ©ç”¨ã€‚å¯¹äºå¹¶è¡Œæ€§æ¥è¯´ï¼Œå¯ä»¥é‡å¤åˆ©ç”¨è¿­ä»£å™¨å¾ˆé‡è¦ã€‚æ­¤å¤–ï¼Œå‰å‘è¿­ä»£å™¨çš„è‡ªå¢ä¸ä¼šä½¿å…¶ä»–çš„è¿­ä»£å™¨æ‹·è´å¤±æ•ˆï¼Œè¿™æ ·å°±ä¸ç”¨æ‹…å¿ƒå…¶ä»–çº¿ç¨‹ä¸­çš„è¿­ä»£å™¨å—å½±å“ã€‚å¦‚æœä½¿ç”¨è¾“å…¥è¿­ä»£å™¨ï¼Œæ‰€æœ‰çº¿ç¨‹åªèƒ½å…±ç”¨ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ˜¾ç„¶æ— æ³•å¹¶è¡Œ std::execution::par æ˜¯æœ€å¸¸ç”¨çš„ç­–ç•¥ï¼Œé™¤éå®ç°æä¾›äº†æ›´ç¬¦åˆéœ€æ±‚çš„éæ ‡å‡†ç­–ç•¥ã€‚ä¸€äº›æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨ std::execution::par_unseqï¼Œè™½ç„¶è¿™ä¸ä¿è¯æ›´å¥½çš„å¹¶å‘æ€§ï¼Œä½†å®ƒç»™äº†åº“é€šè¿‡é‡æ’å’Œäº¤é”™ä»»åŠ¡æ¥æå‡æ€§èƒ½çš„å¯èƒ½æ€§ï¼Œä¸è¿‡ä»£ä»·å°±æ˜¯ä¸èƒ½ä½¿ç”¨åŒæ­¥æœºåˆ¶ï¼Œè¦ç¡®ä¿çº¿ç¨‹å®‰å…¨åªèƒ½è®©ç®—æ³•æœ¬èº«ä¸ä¼šè®©å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€å…ƒç´ ï¼Œå¹¶åœ¨è°ƒç”¨è¯¥ç®—æ³•çš„å¤–éƒ¨ä½¿ç”¨åŒæ­¥æœºåˆ¶æ¥é¿å…å…¶ä»–çº¿ç¨‹å¯¹æ•°æ®çš„è®¿é—® å†…éƒ¨å¸¦åŒæ­¥æœºåˆ¶åªèƒ½ä½¿ç”¨ std::execution::parï¼Œå¦‚æœä½¿ç”¨ std::execution::par_unseq ä¼šå‡ºç°æœªå®šä¹‰è¡Œä¸º #include \u003calgorithm\u003e #include \u003cmutex\u003e #include \u003cvector\u003e class A { public: int get() const { std::lock_guard\u003cstd::mutex\u003e l(m_); return n_; } void inc() { std::lock_guard\u003cstd::mutex\u003e l(m_); ++n_; } private: mutable std::mutex m_; int n_ = 0; }; void f(std::vector\u003cA\u003e\u0026 v) { std::for_each(std::execution::par, v.begin(), v.end(), [](A\u0026 x) { x.inc(); }); } å¦‚æœä½¿ç”¨ std::execution::par_unseq åˆ™åº”è¯¥åœ¨å¤–éƒ¨ä½¿ç”¨åŒæ­¥æœºåˆ¶ #include \u003calgorithm\u003e #include \u003cmutex\u003e #include \u003cvector\u003e class A { public: int get() const { return n_; } void inc() { ++n_; } private: int n_ = 0; }; class B { public: void lock() { m_.lock(); } void unlock() { m_.unlock(); } std::vector\u003cA\u003e\u0026 get() { return v_; } private: std::mutex m_; std::vector\u003cA\u003e v_; }; void f(B\u0026 x) { std::lock_guard\u003cstd::mutex\u003e l(x); auto\u0026 v = x.get(); std::for_each(std::execution::par_unseq, v.begin(), v.end(), [](A\u0026 x) { x.inc(); }); } ä¸‹é¢æ˜¯ä¸€ä¸ªæ›´å®é™…çš„ä¾‹å­ã€‚å‡å¦‚æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œè®¿é—®æ—¥å¿—æœ‰ä¸Šç™¾ä¸‡æ¡ï¼Œä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹æ•°æ®éœ€è¦å¯¹æ—¥å¿—è¿›è¡Œå¤„ç†ã€‚å¯¹æ—¥å¿—æ¯è¡Œçš„å¤„ç†æ˜¯ç‹¬ç«‹çš„å·¥ä½œï¼Œå¾ˆé€‚åˆä½¿ç”¨å¹¶è¡Œç®—æ³• struct Log { std::string page; time_t visit_time; // any other fields }; extern Log parse(const std::string\u0026 line); using Map = std::unordered_map\u003cstd::string, unsigned long long\u003e; Map f(const std::vector\u003cstd::string\u003e\u0026 v) { struct Combine { // logã€Map ä¸¤ä¸ªå‚æ•°æœ‰å››ç§ç»„åˆï¼Œæ‰€ä»¥éœ€è¦å››ä¸ªé‡è½½ Map operator()(Map lhs, Map rhs) const { if (lhs.size() \u003c rhs.size()) { std::swap(lhs, rhs); } for (const auto\u0026 x : rhs) { lhs[x.first] += x.second; } return lhs; } Map operator()(Log l, Map m) const { ++m[l.page]; return m; } Map operator()(Map m, Log l) const { ++m[l.page]; return m; } Map operator()(Log lhs, Log rhs) const { Map m; ++m[lhs.page]; ++m[rhs.page]; return m; } }; return std::transform_reduce(std::execution::par, v.begin(), v.end(), Map{}, // åˆå§‹å€¼ï¼Œä¸€ä¸ªç©ºçš„ map Combine{}, // ç»“åˆä¸¤ä¸ªå…ƒç´ çš„äºŒå…ƒæ“ä½œ parse); // å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œçš„ä¸€å…ƒæ“ä½œ } ","date":"2023-11-28","objectID":"/posts/ch10_parallel_algorithm/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [10] | CH10 Parallel Algorithm","uri":"/posts/ch10_parallel_algorithm/"},{"categories":["C++"],"content":"çº¿ç¨‹æ±  çº¿ç¨‹æ± ä¸€èˆ¬ä¼šç”¨ä¸€ä¸ªè¡¨ç¤ºçº¿ç¨‹æ•°çš„å‚æ•°æ¥åˆå§‹åŒ–ï¼Œå†…éƒ¨éœ€è¦ä¸€ä¸ªé˜Ÿåˆ—æ¥å­˜å‚¨ä»»åŠ¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„çº¿ç¨‹æ± å®ç° #include \u003ccondition_variable\u003e #include \u003cfunctional\u003e #include \u003cmutex\u003e #include \u003cqueue\u003e #include \u003cthread\u003e #include \u003cutility\u003e class ThreadPool { public: explicit ThreadPool(std::size_t n) { for (std::size_t i = 0; i \u003c n; ++i) { std::thread{[this] { std::unique_lock\u003cstd::mutex\u003e l(m_); while (true) { if (!q_.empty()) { auto task = std::move(q_.front()); q_.pop(); l.unlock(); task(); l.lock(); } else if (done_) { break; } else { cv_.wait(l); } } }}.detach(); } } ~ThreadPool() { { std::lock_guard\u003cstd::mutex\u003e l(m_); done_ = true; // cv_.wait ä½¿ç”¨äº† done_ åˆ¤æ–­æ‰€ä»¥è¦åŠ é” } cv_.notify_all(); } template \u003ctypename F\u003e void submit(F\u0026\u0026 f) { { std::lock_guard\u003cstd::mutex\u003e l(m_); q_.emplace(std::forward\u003cF\u003e(f)); } cv_.notify_one(); } private: std::mutex m_; std::condition_variable cv_; bool done_ = false; std::queue\u003cstd::function\u003cvoid()\u003e\u003e q_; }; å¦‚æœæƒ³è®©æäº¤çš„ä»»åŠ¡å¸¦å‚æ•°ä¼šéº»çƒ¦å¾ˆå¤š template \u003cclass F, class... Args\u003e auto ThreadPool::submit(F\u0026\u0026 f, Args\u0026\u0026... args) { using RT = std::invoke_result_t\u003cF, Args...\u003e; // std::packaged_task ä¸å…è®¸æ‹·è´æ„é€ ï¼Œä¸èƒ½ç›´æ¥ä¼ å…¥ lambdaï¼Œ // å› æ­¤è¦å€ŸåŠ© std::shared_ptr auto task = std::make_shared\u003cstd::packaged_task\u003cRT()\u003e\u003e( std::bind(std::forward\u003cF\u003e(f), std::forward\u003cArgs\u003e(args)...)); // ä½† std::bind ä¼šæŒ‰å€¼æ‹·è´å®å‚ï¼Œå› æ­¤è¿™ä¸ªå®ç°ä¸å…è®¸ä»»åŠ¡çš„å®å‚æ˜¯ move-only ç±»å‹ { std::lock_guard\u003cstd::mutex\u003e l(m_); q_.emplace([task]() { (*task)(); }); // æ•è·æŒ‡é’ˆä»¥ä¼ å…¥ std::packaged_task } cv_.notify_one(); return task-\u003eget_future(); } ä¹¦ä¸Šå®ç°çš„çº¿ç¨‹æ± éƒ½åœ¨æ­»å¾ªç¯ä¸­ä½¿ç”¨äº† std::this_thread::yield æ¥è½¬è®©æ—¶é—´ç‰‡ #include \u003catomic\u003e #include \u003cfunctional\u003e #include \u003cthread\u003e #include \u003cvector\u003e #include \"concurrent_queue.hpp\" class ThreadPool { public: ThreadPool() { std::size_t n = std::thread::hardware_concurrency(); try { for (std::size_t i = 0; i \u003c n; ++i) { threads_.emplace_back(\u0026ThreadPool::worker_thread, this); } } catch (...) { done_ = true; for (auto\u0026 x : threads_) { if (x.joinable()) { x.join(); } } throw; } } ~ThreadPool() { done_ = true; for (auto\u0026 x : threads_) { if (x.joinable()) { x.join(); } } } template \u003ctypename F\u003e void submit(F f) { q_.push(std::function\u003cvoid()\u003e(f)); } private: void worker_thread() { while (!done_) { std::function\u003cvoid()\u003e task; if (q_.try_pop(task)) { task(); } else { std::this_thread::yield(); } } } private: std::atomic\u003cbool\u003e done_ = false; ConcurrentQueue\u003cstd::function\u003cvoid()\u003e\u003e q_; std::vector\u003cstd::thread\u003e threads_; // è¦åœ¨ done_ å’Œ q_ ä¹‹åå£°æ˜ }; è¿™æ ·åšçš„é—®é¢˜æ˜¯ï¼Œå¦‚æœçº¿ç¨‹æ± å¤„äºç©ºé—²çŠ¶æ€ï¼Œå°±ä¼šæ— é™è½¬è®©æ—¶é—´ç‰‡ï¼Œå¯¼è‡´ CPU ä½¿ç”¨ç‡è¾¾ 100%ï¼Œä¸‹é¢æ˜¯å¯¹ä¹¦ä¸­çš„çº¿ç¨‹æ± çš„ CPU ä½¿ç”¨ç‡æµ‹è¯•ç»“æœ å¯¹ç›¸åŒä»»åŠ¡ç”¨ä¹‹å‰å®ç°çš„çº¿ç¨‹æ± çš„æµ‹è¯•ç»“æœ è¿™é‡Œè¿˜æ˜¯æŠŠä¹¦ä¸Šçš„å†…å®¹åˆ—å‡ºæ¥ï¼Œä¸‹æ–‡å‡ä¸ºä¹¦ä¸­å†…å®¹ è¿™ä¸ªçº¿ç¨‹æ± åªèƒ½æ‰§è¡Œæ— å‚æ•°æ— è¿”å›å€¼çš„å‡½æ•°ï¼Œå¹¶ä¸”å¯èƒ½å‡ºç°æ­»é”ï¼Œä¸‹é¢å¸Œæœ›èƒ½æ‰§è¡Œæ— å‚æ•°ä½†æœ‰è¿”å›å€¼çš„å‡½æ•°ã€‚ä¸ºäº†å¾—åˆ°è¿”å›å€¼ï¼Œå°±åº”è¯¥æŠŠå‡½æ•°ä¼ é€’ç»™ std::packaged_task å†åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶è¿”å› std::packaged_task ä¸­çš„ std::futureã€‚ç”±äº std::packaged_task æ˜¯ move-only ç±»å‹ï¼Œè€Œ std::function è¦æ±‚å­˜å‚¨çš„å‡½æ•°å®ä¾‹å¯ä»¥æ‹·è´æ„é€ ï¼Œå› æ­¤è¿™é‡Œéœ€è¦å®ç°ä¸€ä¸ªæ”¯æŒ move-only ç±»å‹çš„å‡½æ•°åŒ…è£¹ç±»ï¼Œå³ä¸€ä¸ªå¸¦ call æ“ä½œçš„ç±»å‹æ“¦é™¤ï¼ˆtype-erasureï¼‰ç±» #include \u003cmemory\u003e #include \u003cutility\u003e class FunctionWrapper { public: FunctionWrapper() = default; FunctionWrapper(const FunctionWrapper\u0026) = delete; FunctionWrapper\u0026 operator=(const FunctionWrapper\u0026) = delete; FunctionWrapper(FunctionWrapper\u0026\u0026 rhs) noexcept : impl_(std::move(rhs.impl_)) {} FunctionWrapper\u0026 operator=(FunctionWrapper\u0026\u0026 rhs) noexcept { impl_ = std::move(rhs.impl_); return *this; } template \u003ctypename F\u003e FunctionWrapper(F\u0026\u0026 f) : impl_(new ImplType\u003cF\u003e(std::move(f))) {} void operator()() const { impl_-\u003ecall(); } private: struct ImplBase { virtual void call() = 0; virtual ~ImplBase() = default; }; template \u003ctypename F\u003e struct ImplType : ImplBase { ImplType(F\u0026\u0026 f) noexcept : f_(std::move(f)) {} void call() override { f_(); } F f_; }; private: std::unique_ptr\u003cImplBase\u003e impl_; }; ç”¨è¿™ä¸ªåŒ…è£¹ç±»æ›¿ä»£ std::function\u003cvoid()\u003e #include \u003catomic\u003e #include \u003cfuture\u003e #include \u003cthread\u003e #include \u003ctype_traits\u003e #include \u003cvector\u003e #include \"concurrent_queue.hpp\" #include \"function_wrapper.hpp\" class ThreadPool { public: ThreadPool() { std::size_t n = std::thread::hardware_concurrency(); try { for (std::size_t i = 0; i \u003c n; ++i) { threads_.emplace_back(\u0026ThreadPool::worker_thread, this); } } catch (...) { done_ = true; for (auto\u0026 x : threads_) { if (x.joinable()) { x.join(); } } thr","date":"2023-11-28","objectID":"/posts/ch09_advanced_thread_management/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [9] | CH09 Advanced Thread Management","uri":"/posts/ch09_advanced_thread_management/"},{"categories":["C++"],"content":"ä¸­æ–­ å¯ä¸­æ–­çº¿ç¨‹çš„ç®€å•å®ç° class InterruptFlag { public: void set(); bool is_set() const; }; thread_local InterruptFlag this_thread_interrupt_flag; class InterruptibleThread { public: template \u003ctypename F\u003e InterruptibleThread(F f) { std::promise\u003cInterruptFlag*\u003e p; t = std::thread([f, \u0026p] { p.set_value(\u0026this_thread_interrupt_flag); f(); }); flag = p.get_future().get(); } void interrupt() { if (flag) { flag-\u003eset(); } } private: std::thread t; InterruptFlag* flag; }; void interruption_point() { if (this_thread_interrupt_flag.is_set()) { throw thread_interrupted(); } } åœ¨å‡½æ•°ä¸­ä½¿ç”¨ void f() { while (!done) { interruption_point(); process_next_item(); } } æ›´å¥½çš„æ–¹å¼æ˜¯ç”¨ std::condition_variable æ¥å”¤é†’ï¼Œè€Œéåœ¨å¾ªç¯ä¸­æŒç»­è¿è¡Œ class InterruptFlag { public: void set() { b_.store(true, std::memory_order_relaxed); std::lock_guard\u003cstd::mutex\u003e l(m_); if (cv_) { cv_-\u003enotify_all(); } } bool is_set() const { return b_.load(std::memory_order_relaxed); } void set_condition_variable(std::condition_variable\u0026 cv) { std::lock_guard\u003cstd::mutex\u003e l(m_); cv_ = \u0026cv; } void clear_condition_variable() { std::lock_guard\u003cstd::mutex\u003e l(m_); cv_ = nullptr; } struct ClearConditionVariableOnDestruct { ~ClearConditionVariableOnDestruct() { this_thread_interrupt_flag.clear_condition_variable(); } }; private: std::atomic\u003cbool\u003e b_; std::condition_variable* cv_ = nullptr; std::mutex m_; }; void interruptible_wait(std::condition_variable\u0026 cv, std::unique_lock\u003cstd::mutex\u003e\u0026 l) { interruption_point(); this_thread_interrupt_flag.set_condition_variable(cv); // ä¹‹åçš„ wait_for å¯èƒ½æŠ›å¼‚å¸¸ï¼Œæ‰€ä»¥éœ€è¦ RAII æ¸…é™¤æ ‡å¿— InterruptFlag::ClearConditionVariableOnDestruct guard; interruption_point(); // è®¾ç½®çº¿ç¨‹çœ‹åˆ°ä¸­æ–­å‰çš„ç­‰å¾…æ—¶é—´ä¸Šé™ cv.wait_for(l, std::chrono::milliseconds(1)); interruption_point(); } template \u003ctypename Predicate\u003e void interruptible_wait(std::condition_variable\u0026 cv, std::unique_lock\u003cstd::mutex\u003e\u0026 l, Predicate pred) { interruption_point(); this_thread_interrupt_flag.set_condition_variable(cv); InterruptFlag::ClearConditionVariableOnDestruct guard; while (!this_thread_interrupt_flag.is_set() \u0026\u0026 !pred()) { cv.wait_for(l, std::chrono::milliseconds(1)); } interruption_point(); } å’Œ std::condition_variable ä¸åŒçš„æ˜¯ï¼Œstd::condition_variable_any å¯ä»¥ä½¿ç”¨ä¸é™äº std::unique_lock çš„ä»»ä½•ç±»å‹çš„é”ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„é”ç±»å‹ #include \u003catomic\u003e #include \u003ccondition_variable\u003e #include \u003cmutex\u003e class InterruptFlag { public: void set() { b_.store(true, std::memory_order_relaxed); std::lock_guard\u003cstd::mutex\u003e l(m_); if (cv_) { cv_-\u003enotify_all(); } else if (cv_any_) { cv_any_-\u003enotify_all(); } } template \u003ctypename Lockable\u003e void wait(std::condition_variable_any\u0026 cv, Lockable\u0026 l) { class Mutex { public: Mutex(InterruptFlag* self, std::condition_variable_any\u0026 cv, Lockable\u0026 l) : self_(self), lock_(l) { self_-\u003em_.lock(); self_-\u003ecv_any_ = \u0026cv; } ~Mutex() { self_-\u003ecv_any_ = nullptr; self_-\u003em_.unlock(); } void lock() { std::lock(self_-\u003em_, lock_); } void unlock() { lock_.unlock(); self_-\u003em_.unlock(); } private: InterruptFlag* self_; Lockable\u0026 lock_; }; Mutex m(this, cv, l); interruption_point(); cv.wait(m); interruption_point(); } // rest as before private: std::atomic\u003cbool\u003e b_; std::condition_variable* cv_ = nullptr; std::condition_variable_any* cv_any_ = nullptr; std::mutex m_; }; template \u003ctypename Lockable\u003e void interruptible_wait(std::condition_variable_any\u0026 cv, Lockable\u0026 l) { this_thread_interrupt_flag.wait(cv, l); } å¯¹äºå…¶ä»–é˜»å¡è°ƒç”¨ï¼ˆæ¯”å¦‚ mutexã€futureï¼‰çš„ä¸­æ–­ï¼Œä¸€èˆ¬ä¹Ÿå¯ä»¥åƒå¯¹ std::condition_variable ä¸€æ ·è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå› ä¸ºä¸è®¿é—®å†…éƒ¨ mutex æˆ– future æ— æ³•åœ¨æœªæ»¡è¶³ç­‰å¾…çš„æ¡ä»¶æ—¶ä¸­æ–­ç­‰å¾… template \u003ctypename T\u003e void interruptible_wait(std::future\u003cT\u003e\u0026 ft) { while (!this_thread_interrupt_flag.is_set()) { if (ft.wait_for(std::chrono::milliseconds(1)) == std::future_status::ready) { break; } } interruption_point(); } ä»è¢«ä¸­æ–­çš„çº¿ç¨‹è§’åº¦æ¥çœ‹ï¼Œä¸­æ–­å°±æ˜¯ä¸€ä¸ª thread_interrupted å¼‚å¸¸ã€‚å› æ­¤æ£€æŸ¥å‡ºä¸­æ–­åï¼Œå¯ä»¥åƒå¼‚å¸¸ä¸€æ ·å¯¹å…¶è¿›è¡Œå¤„ç† internal_thread = std::thread{[f, \u0026p] { p.set_value(\u0026this_thread_interrupt_flag); try { f(); } catch (const thread_interrupted\u0026) { // å¼‚å¸¸ä¼ å…¥ std::thread çš„ææ„å‡½æ•°æ—¶å°†è°ƒç”¨ std::terminate // ä¸ºäº†é˜²æ­¢ç¨‹åºç»ˆæ­¢å°±è¦æ•è·å¼‚å¸¸ } }}; å‡å¦‚æœ‰ä¸€ä¸ªæ¡Œé¢æœç´¢ç¨‹åºï¼Œé™¤äº†ä¸ç”¨æˆ·äº¤äº’ï¼Œç¨‹åºè¿˜éœ€è¦ç›‘æ§æ–‡ä»¶ç³»ç»Ÿçš„çŠ¶æ€ï¼Œä»¥è¯†åˆ«ä»»ä½•æ›´æ”¹å¹¶æ›´æ–°å…¶ç´¢å¼•ã€‚ä¸ºäº†é¿å…å½±å“ GUI çš„å“åº”æ€§ï¼Œè¿™ä¸ªå¤„ç†é€šå¸¸ä¼šäº¤ç»™ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œåå°çº¿ç¨‹éœ€è¦è¿è¡Œäºç¨‹åº","date":"2023-11-28","objectID":"/posts/ch09_advanced_thread_management/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [9] | CH09 Advanced Thread Management","uri":"/posts/ch09_advanced_thread_management/"},{"categories":["C++"],"content":"éé˜»å¡æ•°æ®ç»“æ„ é˜»å¡çš„ç®—æ³•å’Œæ•°æ®ç»“æ„ä½¿ç”¨ mutexã€æ¡ä»¶å˜é‡ã€æœŸå€¼æ¥åŒæ­¥æ•°æ®ï¼Œä½†éé˜»å¡ä¸ç­‰ä»·äº lock-freeï¼Œæ¯”å¦‚è‡ªæ—‹é”æ²¡æœ‰ä½¿ç”¨ä»»ä½•é˜»å¡å‡½æ•°çš„è°ƒç”¨ï¼Œæ˜¯éé˜»å¡çš„ï¼Œä½†å¹¶é lock-free éé˜»å¡æ•°æ®ç»“æ„ç”±æ¾åˆ°ä¸¥å¯åˆ†ä¸ºä¸‰ä¸ªç­‰çº§ï¼šobstruction-freeã€lock-freeã€wait-free obstruction-freeï¼ˆæ— éšœç¢ï¼‰ï¼šå¦‚æœå…¶ä»–çº¿ç¨‹éƒ½æš‚åœäº†ï¼Œä»»ä½•ä¸€ä¸ªç»™å®šçš„çº¿ç¨‹éƒ½ä¼šåœ¨æœ‰é™æ­¥æ•°å†…å®Œæˆæ“ä½œã€‚ä¸Šä¾‹å°±æ˜¯è¿™ç§æƒ…å†µï¼Œä½†è¿™ç§æƒ…å†µå¾ˆå°‘è§ï¼Œæ‰€ä»¥æ»¡è¶³è¿™ä¸ªæ¡ä»¶åªèƒ½ç®—ä¸€ä¸ªå¤±è´¥çš„ lock-free å®ç° lock-freeï¼ˆæ— é”ï¼‰ï¼šå¦‚æœå¤šçº¿ç¨‹åœ¨åŒä¸€ä¸ªæ•°æ®ç»“æ„ä¸Šæ“ä½œï¼Œå…¶ä¸­ä¸€ä¸ªå°†åœ¨æœ‰é™æ­¥æ•°å†…å®Œæˆæ“ä½œã€‚æ»¡è¶³ lock-free å¿…å®šæ»¡è¶³ obstruction-free wait-freeï¼ˆæ— ç­‰å¾…ï¼‰ï¼šå¦‚æœå¤šçº¿ç¨‹åœ¨åŒä¸€ä¸ªæ•°æ®ç»“æ„ä¸Šæ“ä½œï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šåœ¨æœ‰é™æ­¥æ•°å†…å®Œæˆæ“ä½œã€‚æ»¡è¶³ wait-free å¿…å®šæ»¡è¶³ lock-freeï¼Œä½† wait-free å¾ˆéš¾å®ç°ï¼Œå› ä¸ºè¦ä¿è¯æœ‰é™æ­¥æ•°å†…å®Œæˆæ“ä½œï¼Œå°±è¦ä¿è¯æ“ä½œä¸€æ¬¡é€šè¿‡ï¼Œå¹¶ä¸”æ‰§è¡Œåˆ°æŸä¸€æ­¥ä¸èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹æ“ä½œå¤±è´¥ lock-free æ•°æ®ç»“æ„å¿…é¡»å…è®¸å¤šçº¿ç¨‹å¹¶å‘è®¿é—®ï¼Œä½†å®ƒä»¬ä¸èƒ½åšç›¸åŒæ“ä½œï¼Œæ¯”å¦‚ä¸€ä¸ª lock-free çš„ queue å…è®¸ä¸€ä¸ªçº¿ç¨‹ pushã€å¦ä¸€ä¸ªçº¿ç¨‹ popï¼Œä½†ä¸å…è®¸ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶ pushã€‚æ­¤å¤–ï¼Œå¦‚æœä¸€ä¸ªè®¿é—® lock-free æ•°æ®ç»“æ„çš„çº¿ç¨‹è¢«ä¸­é€”æŒ‚èµ·ï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»èƒ½å®Œæˆæ“ä½œè€Œä¸éœ€è¦ç­‰å¾…æŒ‚èµ·çš„çº¿ç¨‹ ä½¿ç”¨ lock-free æ•°æ®ç»“æ„ä¸»è¦æ˜¯ä¸ºäº†æœ€å¤§åŒ–å¹¶å‘è®¿é—®ï¼Œä¸éœ€è¦é˜»å¡ã€‚ç¬¬äºŒä¸ªåŸå› æ˜¯é²æ£’æ€§ï¼Œå¦‚æœçº¿ç¨‹åœ¨æŒæœ‰é”æ—¶æ­»æ‰å°±ä¼šå¯¼è‡´æ•°æ®ç»“æ„è¢«æ°¸ä¹…ç ´åï¼Œè€Œå¯¹ lock-free æ•°æ®ç»“æ„æ¥è¯´ï¼Œé™¤äº†æ­»æ‰çš„çº¿ç¨‹é‡Œçš„æ•°æ®ï¼Œå…¶ä»–çš„æ•°æ®éƒ½ä¸ä¼šä¸¢å¤±ã€‚lock-free æ²¡æœ‰ä»»ä½•é”ï¼Œæ‰€ä»¥ä¸€å®šä¸ä¼šå‡ºç°æ­»é” ä½† lock-free å¯èƒ½é€ æˆæ›´å¤§å¼€é”€ï¼Œç”¨äº lock-free çš„åŸå­æ“ä½œæ¯”éåŸå­æ“ä½œæ…¢å¾—å¤šï¼Œä¸” lock-free æ•°æ®ç»“æ„ä¸­çš„åŸå­æ“ä½œä¸€èˆ¬æ¯” lock-based ä¸­çš„å¤šï¼Œæ­¤å¤–ï¼Œç¡¬ä»¶å¿…é¡»è®¿é—®åŒä¸€ä¸ªåŸå­å˜é‡ä»¥åœ¨çº¿ç¨‹é—´åŒæ­¥æ•°æ®ã€‚æ— è®º lock-free è¿˜æ˜¯ lock-basedï¼Œæ€§èƒ½æ–¹é¢çš„æ£€æŸ¥ï¼ˆæœ€åæƒ…å†µç­‰å¾…æ—¶é—´ã€å¹³å‡ç­‰å¾…æ—¶é—´ã€æ€»ä½“æ‰§è¡Œæ—¶é—´æˆ–å…¶ä»–æ–¹é¢ï¼‰éƒ½æ˜¯éå¸¸é‡è¦çš„ ","date":"2023-11-28","objectID":"/posts/ch07_designing_lock_free_concurrent_data_structure/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [7] | CH07 Designing Lock free Concurrent Data Structure","uri":"/posts/ch07_designing_lock_free_concurrent_data_structure/"},{"categories":["C++"],"content":"lock-free thread-safe stack æœ€ç®€å•çš„ stack å®ç°æ–¹å¼æ˜¯åŒ…å«å¤´èŠ‚ç‚¹æŒ‡é’ˆçš„é“¾è¡¨ã€‚push çš„è¿‡ç¨‹å¾ˆç®€å•ï¼Œåˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œç„¶åè®©æ–°èŠ‚ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘å½“å‰ headï¼Œæœ€å head è®¾ä¸ºæ–°èŠ‚ç‚¹ è¿™é‡Œçš„ race condition åœ¨äºï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶ pushï¼Œè®©å„è‡ªçš„æ–°èŠ‚ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘å½“å‰ headï¼Œè¿™æ ·å¿…ç„¶å¯¼è‡´ head æœ€ç»ˆè®¾ä¸ºäºŒè€…ä¹‹ä¸€çš„æ–°èŠ‚ç‚¹ï¼Œè€Œå¦ä¸€ä¸ªè¢«ä¸¢å¼ƒ è§£å†³æ–¹æ³•æ˜¯ï¼Œåœ¨æœ€åè®¾ç½® head æ—¶å…ˆè¿›è¡Œåˆ¤æ–­ï¼Œåªæœ‰å½“å‰ head ä¸æ–°èŠ‚ç‚¹çš„ next ç›¸ç­‰ï¼Œæ‰å°† head è®¾ä¸ºæ–°èŠ‚ç‚¹ï¼Œå¦‚æœä¸ç­‰åˆ™è®© next æŒ‡å‘å½“å‰ head å¹¶é‡æ–°åˆ¤æ–­ã€‚è€Œè¿™ä¸ªæ“ä½œå¿…é¡»æ˜¯åŸå­çš„ï¼Œå› æ­¤å°±éœ€è¦ä½¿ç”¨ compare_exchange_weakï¼Œä¸éœ€è¦ä½¿ç”¨ compare_exchange_strongï¼Œå› ä¸º compare_exchange_weak åœ¨ç›¸ç­‰æ—¶å¯èƒ½æ›¿æ¢å¤±è´¥ï¼Œä½†æ›¿æ¢å¤±è´¥ä¹Ÿä¼šè¿”å› falseï¼Œæ”¾åœ¨å¾ªç¯é‡Œå¸¦æ¥çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œè€Œ compare_exchange_weak åœ¨ä¸€äº›æœºå™¨æ¶æ„ä¸Šå¯ä»¥äº§ç”Ÿæ¯” compare_exchange_strong æ›´ä¼˜åŒ–çš„ä»£ç  #include \u003catomic\u003e template \u003ctypename T\u003e class LockFreeStack { public: void push(const T\u0026 x) { Node* t = new Node(x); t-\u003enext = head_.load(); while (!head_.compare_exchange_weak(t-\u003enext, t)) { } } private: struct Node { T v; Node* next = nullptr; Node(const T\u0026 x) : v(x) {} }; private: std::atomic\u003cNode*\u003e head_; }; pop çš„è¿‡ç¨‹å¾ˆç®€å•ï¼Œå…ˆå­˜å‚¨å½“å‰å¤´èŠ‚ç‚¹æŒ‡é’ˆï¼Œå†å°†å¤´èŠ‚ç‚¹è®¾ä¸ºä¸‹ä¸€èŠ‚ç‚¹ï¼Œæœ€åè¿”å›å­˜å‚¨çš„å¤´èŠ‚ç‚¹å¹¶åˆ é™¤æŒ‡é’ˆã€‚è¿™é‡Œçš„ race condition åœ¨äºï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶ popï¼Œå¦‚æœä¸€ä¸ªå·²ç»åˆ é™¤äº†å¤´èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è¯»å–å¤´èŠ‚ç‚¹çš„ä¸‹ä¸€èŠ‚ç‚¹å°±è®¿é—®äº†ç©ºæ‚¬æŒ‡é’ˆ å…ˆç»•å¼€åˆ é™¤æŒ‡é’ˆè¿™ä¸€æ­¥ï¼Œè€ƒè™‘å‰å‡ æ­¥çš„å®ç° template \u003ctypename T\u003e void LockFreeStack\u003cT\u003e::pop(T\u0026 res) { Node* t = head_.load(); // æœªè€ƒè™‘å¤´èŠ‚ç‚¹ä¸ºç©ºæŒ‡é’ˆçš„æƒ…å†µ while (!head_.compare_exchange_weak(t, t-\u003enext)) { } res = t-\u003ev; } ä¼ å¼•ç”¨æ¥ä¿å­˜ç»“æœçš„åŸå› æ˜¯ï¼Œå¦‚æœç›´æ¥è¿”å›å€¼ï¼Œè¿”å›å‰ä¸€å®šä¼šå…ˆç§»é™¤å…ƒç´ ï¼Œå¦‚æœæ‹·è´è¿”å›å€¼æ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œç§»é™¤çš„å…ƒç´ å°±ä¸¢å¤±äº†ã€‚ä½†ä¼ å¼•ç”¨çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹ç§»é™¤äº†èŠ‚ç‚¹ï¼Œè¢«ç§»é™¤çš„èŠ‚ç‚¹ä¸èƒ½è¢«è§£å¼•ç”¨ï¼Œå½“å‰çº¿ç¨‹å°±æ— æ³•å®‰å…¨åœ°æ‹·è´æ•°æ®ã€‚å› æ­¤ï¼Œå¦‚æœæƒ³å®‰å…¨åœ°è¿”å›å€¼ï¼Œåº”è¯¥è¿”å›æ™ºèƒ½æŒ‡é’ˆ #include \u003catomic\u003e #include \u003cmemory\u003e template \u003ctypename T\u003e class LockFreeStack { public: void push(const T\u0026 x) { Node* t = new Node(x); t-\u003enext = head_.load(); while (!head_.compare_exchange_weak(t-\u003enext, t)) { } } std::shared_ptr\u003cT\u003e pop() { // è¿˜æœªè€ƒè™‘é‡Šæ”¾åŸæ¥çš„å¤´èŠ‚ç‚¹æŒ‡é’ˆ Node* t = head_.load(); while (t \u0026\u0026 !head_.compare_exchange_weak(t, t-\u003enext)) { } return t ? t-\u003ev : nullptr; } private: struct Node { std::shared_ptr\u003cT\u003e v; Node* next = nullptr; Node(const T\u0026 x) : v(std::make_shared\u003cT\u003e(x)) {} }; private: std::atomic\u003cNode*\u003e head_; }; é‡Šæ”¾è¢«ç§»é™¤çš„èŠ‚ç‚¹çš„éš¾ç‚¹åœ¨äºï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨é‡Šæ”¾å†…å­˜æ—¶ï¼Œæ— æ³•å¾—çŸ¥å…¶ä»–çº¿ç¨‹æ˜¯å¦æŒæœ‰è¦é‡Šæ”¾çš„æŒ‡é’ˆ åªè¦æ²¡æœ‰å…¶ä»–çº¿ç¨‹è°ƒç”¨ popï¼Œå°±èƒ½å®‰å…¨é‡Šæ”¾ï¼Œå› æ­¤å¯ä»¥ç”¨ä¸€ä¸ªè®¡æ•°å™¨æ¥è®°å½•è°ƒç”¨ pop çš„çº¿ç¨‹æ•°ï¼Œè®¡æ•°ä¸ä¸º 1 æ—¶ï¼Œå…ˆæŠŠèŠ‚ç‚¹æ·»åŠ åˆ°å¾…åˆ é™¤èŠ‚ç‚¹åˆ—è¡¨ä¸­ï¼Œè®¡æ•°ä¸º 1 åˆ™å®‰å…¨é‡Šæ”¾ #include \u003catomic\u003e #include \u003cmemory\u003e template \u003ctypename T\u003e class LockFreeStack { public: void push(const T\u0026 x) { Node* t = new Node(x); t-\u003enext = head_.load(); while (!head_.compare_exchange_weak(t-\u003enext, t)) { } } std::shared_ptr\u003cT\u003e pop() { ++pop_cnt_; Node* t = head_.load(); while (t \u0026\u0026 !head_.compare_exchange_weak(t, t-\u003enext)) { } std::shared_ptr\u003cT\u003e res; if (t) { res.swap(t-\u003ev); } try_delete(t); return res; } private: struct Node { std::shared_ptr\u003cT\u003e v; Node* next = nullptr; Node(const T\u0026 x) : v(std::make_shared\u003cT\u003e(x)) {} }; private: static void delete_list(Node* head) { while (head) { Node* t = head-\u003enext; delete head; head = t; } } void append_to_delete_list(Node* first, Node* last) { last-\u003enext = to_delete_list_; // ç¡®ä¿ last-\u003enext ä¸º to_delete_list_ï¼Œå†è®¾ç½® first ä¸ºæ–°çš„å¤´èŠ‚ç‚¹ while (!to_delete_list_.compare_exchange_weak(last-\u003enext, first)) { } } void append_to_delete_list(Node* head) { Node* last = head; while (Node* t = last-\u003enext) { last = t; } append_to_delete_list(head, last); } void try_delete(Node* head) { if (pop_cnt_ == 0) { return; } if (pop_cnt_ \u003e 1) { append_to_delete_list(head, head); --pop_cnt_; return; } Node* t = to_delete_list_.exchange(nullptr); if (--pop_cnt_ == 0) { delete_list(t); } else if (t) { append_to_delete_list(t); } delete head; } private: std::atomic\u003cNode*\u003e head_; std::atomic\u003cstd::size_t\u003e pop_cnt_; std::atomic\u003cNode*\u003e to_delete_list_; }; å¦‚æœè¦é‡Šæ”¾æ‰€æœ‰èŠ‚ç‚¹ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªæ—¶åˆ»è®¡æ•°å™¨ä¸º 0ã€‚åœ¨é«˜è´Ÿè½½çš„æƒ…å†µä¸‹ï¼Œå¾€å¾€ä¸ä¼šå­˜åœ¨è¿™æ ·çš„æ—¶åˆ»ï¼Œä»è€Œå¯¼è‡´å¾…åˆ é™¤èŠ‚ç‚¹çš„åˆ—è¡¨æ— é™å¢é•¿ ","date":"2023-11-28","objectID":"/posts/ch07_designing_lock_free_concurrent_data_structure/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [7] | CH07 Designing Lock free Concurrent Data Structure","uri":"/posts/ch07_designing_lock_free_concurrent_data_structure/"},{"categories":["C++"],"content":"Hazard Pointerï¼ˆé£é™©æŒ‡é’ˆï¼‰ å¦ä¸€ä¸ªé‡Šæ”¾çš„æ€è·¯æ˜¯ï¼Œåœ¨çº¿ç¨‹è®¿é—®èŠ‚ç‚¹æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªä¿å­˜äº†çº¿ç¨‹ ID å’Œè¯¥èŠ‚ç‚¹çš„é£é™©æŒ‡é’ˆã€‚ç”¨ä¸€ä¸ªå…¨å±€æ•°ç»„ä¿å­˜æ‰€æœ‰çº¿ç¨‹çš„é£é™©æŒ‡é’ˆï¼Œé‡Šæ”¾èŠ‚ç‚¹æ—¶ï¼Œå¦‚æœæ•°ç»„ä¸­ä¸å­˜åœ¨åŒ…å«è¯¥èŠ‚ç‚¹çš„é£é™©æŒ‡é’ˆï¼Œåˆ™å¯ä»¥ç›´æ¥é‡Šæ”¾ï¼Œå¦åˆ™å°†èŠ‚ç‚¹æ·»åŠ åˆ°å¾…åˆ é™¤åˆ—è¡¨ä¸­ã€‚é£é™©æŒ‡é’ˆå®ç°å¦‚ä¸‹ #include \u003catomic\u003e #include \u003cstdexcept\u003e #include \u003cthread\u003e static constexpr std::size_t MaxSize = 100; struct HazardPointer { std::atomic\u003cstd::thread::id\u003e id; std::atomic\u003cvoid*\u003e p; }; static HazardPointer HazardPointers[MaxSize]; class HazardPointerHelper { public: HazardPointerHelper() { for (auto\u0026 x : HazardPointers) { std::thread::id default_id; if (x.id.compare_exchange_strong(default_id, std::this_thread::get_id())) { hazard_pointer = \u0026x; // å–ä¸€ä¸ªæœªè®¾ç½®è¿‡çš„é£é™©æŒ‡é’ˆ break; } } if (!hazard_pointer) { throw std::runtime_error(\"No hazard pointers available\"); } } ~HazardPointerHelper() { hazard_pointer-\u003ep.store(nullptr); hazard_pointer-\u003eid.store(std::thread::id{}); } HazardPointerHelper(const HazardPointerHelper\u0026) = delete; HazardPointerHelper operator=(const HazardPointerHelper\u0026) = delete; std::atomic\u003cvoid*\u003e\u0026 get() { return hazard_pointer-\u003ep; } private: HazardPointer* hazard_pointer = nullptr; }; std::atomic\u003cvoid*\u003e\u0026 hazard_pointer_for_this_thread() { static thread_local HazardPointerHelper t; return t.get(); } bool is_existing(void* p) { for (auto\u0026 x : HazardPointers) { if (x.p.load() == p) { return true; } } return false; } ä½¿ç”¨é£é™©æŒ‡é’ˆ #include \u003catomic\u003e #include \u003cfunctional\u003e #include \u003cmemory\u003e #include \"hazard_pointer.hpp\" template \u003ctypename T\u003e class LockFreeStack { public: void push(const T\u0026 x) { Node* t = new Node(x); t-\u003enext = head_.load(); while (!head_.compare_exchange_weak(t-\u003enext, t)) { } } std::shared_ptr\u003cT\u003e pop() { std::atomic\u003cvoid*\u003e\u0026 hazard_pointer = hazard_pointer_for_this_thread(); Node* t = head_.load(); do { // å¤–å¾ªç¯ç¡®ä¿ t ä¸ºæœ€æ–°çš„å¤´èŠ‚ç‚¹ï¼Œå¾ªç¯ç»“æŸåå°†å¤´èŠ‚ç‚¹è®¾ä¸ºä¸‹ä¸€èŠ‚ç‚¹ Node* t2; do { // å¾ªç¯è‡³é£é™©æŒ‡é’ˆä¿å­˜å½“å‰æœ€æ–°çš„å¤´èŠ‚ç‚¹ t2 = t; hazard_pointer.store(t); t = head_.load(); } while (t != t2); } while (t \u0026\u0026 !head_.compare_exchange_strong(t, t-\u003enext)); hazard_pointer.store(nullptr); std::shared_ptr\u003cT\u003e res; if (t) { res.swap(t-\u003ev); if (is_existing(t)) { append_to_delete_list(new DataToDelete{t}); } else { delete t; } try_delete(); } return res; } private: struct Node { std::shared_ptr\u003cT\u003e v; Node* next = nullptr; Node(const T\u0026 x) : v(std::make_shared\u003cT\u003e(x)) {} }; struct DataToDelete { template \u003ctypename T\u003e DataToDelete(T* p) : data(p), deleter([](void* p) { delete static_cast\u003cT*\u003e(p); }) {} ~DataToDelete() { deleter(data); } void* data = nullptr; std::function\u003cvoid(void*)\u003e deleter; DataToDelete* next = nullptr; }; private: void append_to_delete_list(DataToDelete* t) { t-\u003enext = to_delete_list_.load(); while (!to_delete_list_.compare_exchange_weak(t-\u003enext, t)) { } } void try_delete() { DataToDelete* cur = to_delete_list_.exchange(nullptr); while (cur) { DataToDelete* t = cur-\u003enext; if (!is_existing(cur-\u003edata)) { delete cur; } else { append_to_delete_list(new DataToDelete{cur}); } cur = t; } } private: std::atomic\u003cNode*\u003e head_; std::atomic\u003cstd::size_t\u003e pop_cnt_; std::atomic\u003cDataToDelete*\u003e to_delete_list_; }; é£é™©æŒ‡é’ˆå®ç°ç®€å•å¹¶è¾¾åˆ°äº†å®‰å…¨é‡Šæ”¾çš„ç›®çš„ï¼Œä½†æ¯æ¬¡åˆ é™¤èŠ‚ç‚¹å‰åéƒ½è¦éå†æ•°ç»„å¹¶åŸå­è®¿é—®å†…éƒ¨æŒ‡é’ˆæ¥æ£€æŸ¥ï¼Œå¢åŠ äº†å¾ˆå¤šå¼€é”€ æ— é”å†…å­˜å›æ”¶æŠ€æœ¯é¢†åŸŸååˆ†æ´»è·ƒï¼Œå¤§å…¬å¸éƒ½ä¼šç”³è¯·è‡ªå·±çš„ä¸“åˆ©ï¼Œé£é™©æŒ‡é’ˆåŒ…å«åœ¨ IBM æäº¤çš„ä¸“åˆ©ç”³è¯·ä¸­ï¼Œåœ¨ GPL åè®®ä¸‹å…è®¸å…è´¹ä½¿ç”¨ ","date":"2023-11-28","objectID":"/posts/ch07_designing_lock_free_concurrent_data_structure/:2:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [7] | CH07 Designing Lock free Concurrent Data Structure","uri":"/posts/ch07_designing_lock_free_concurrent_data_structure/"},{"categories":["C++"],"content":"å¼•ç”¨è®¡æ•° å¦ä¸€ä¸ªæ–¹æ¡ˆæ˜¯ä½¿ç”¨å¼•ç”¨è®¡æ•°è®°å½•è®¿é—®æ¯ä¸ªèŠ‚ç‚¹çš„çº¿ç¨‹æ•°é‡ï¼Œstd::shared_ptr çš„æ“ä½œæ˜¯åŸå­çš„ï¼Œä½†è¦æ£€æŸ¥æ˜¯å¦ lock-free std::shared_ptr\u003cint\u003e p(new int(42)); assert(std::atomic_is_lock_free(\u0026p)); å¦‚æœæ˜¯ï¼Œåˆ™å¯ä»¥ç”¨äºå®ç° lock-free stack #include \u003catomic\u003e #include \u003cmemory\u003e template \u003ctypename T\u003e class LockFreeStack { public: ~LockFreeStack() { while (pop()) { } } void push(const T\u0026 x) { auto t = std::make_shared\u003cNode\u003e(x); t-\u003enext = std::atomic_load(\u0026head_); while (!std::atomic_compare_exchange_weak(\u0026head_, \u0026t-\u003enext, t)) { } } std::shared_ptr\u003cT\u003e pop() { std::shared_ptr\u003cNode\u003e t = std::atomic_load(\u0026head_); while (t \u0026\u0026 !std::atomic_compare_exchange_weak(\u0026head_, \u0026t, t-\u003enext)) { } if (t) { std::atomic_store(\u0026t-\u003enext, nullptr); return t-\u003ev; } return nullptr; } private: struct Node { std::shared_ptr\u003cT\u003e v; std::shared_ptr\u003cNode\u003e next; Node(const T\u0026 x) : v(std::make_shared\u003cT\u003e(x)) {} }; private: std::shared_ptr\u003cNode\u003e head_; }; C++20 æ”¯æŒ std::atomic\u003cstd::shared_ptr\u003e #include \u003catomic\u003e #include \u003cmemory\u003e template \u003ctypename T\u003e class LockFreeStack { public: ~LockFreeStack() { while (pop()) { } } void push(const T\u0026 x) { auto t = std::make_shared\u003cNode\u003e(x); t-\u003enext = head_.load(); while (!head_.compare_exchange_weak(t-\u003enext, t)) { } } std::shared_ptr\u003cT\u003e pop() { std::shared_ptr\u003cNode\u003e t = head_.load(); while (t \u0026\u0026 !head_.compare_exchange_weak(t, t-\u003enext.load())) { } if (t) { t-\u003enext = std::shared_ptr\u003cNode\u003e(); return t-\u003ev; } return nullptr; } private: struct Node { std::shared_ptr\u003cT\u003e v; std::atomic\u003cstd::shared_ptr\u003cNode\u003e\u003e next; Node(const T\u0026 x) : v(std::make_shared\u003cT\u003e(x)) {} }; private: std::atomic\u003cstd::shared_ptr\u003cNode\u003e\u003e head_; }; ä½† VS2022 ä¸Šæµ‹è¯•å‘ç° std::atomic\u003cstd::shared_ptr\u003e å¹¶é lock-free assert(!std::atomic\u003cstd::shared_ptr\u003cint\u003e\u003e{}.is_lock_free()); æ›´é€šç”¨çš„æ–¹æ³•æ˜¯æ‰‹åŠ¨ç®¡ç†å¼•ç”¨è®¡æ•°ï¼Œä¸ºæ¯ä¸ªèŠ‚ç‚¹è®¾ç½®å†…å¤–éƒ¨ä¸¤ä¸ªå¼•ç”¨è®¡æ•°ï¼Œä¸¤è€…ä¹‹å’Œå°±æ˜¯èŠ‚ç‚¹çš„å¼•ç”¨è®¡æ•°ï¼Œå¤–éƒ¨è®¡æ•°é»˜è®¤ä¸º 1ï¼Œè®¿é—®å¯¹è±¡æ—¶é€’å¢å¤–éƒ¨è®¡æ•°å¹¶é€’å‡å†…éƒ¨è®¡æ•°ï¼Œè®¿é—®ç»“æŸååˆ™ä¸å†éœ€è¦å¤–éƒ¨è®¡æ•°ï¼Œå°†å¤–éƒ¨è®¡æ•°å‡ 2 å¹¶åŠ åˆ°å†…éƒ¨è®¡æ•°ä¸Š #include \u003catomic\u003e #include \u003cmemory\u003e template \u003ctypename T\u003e class LockFreeStack { public: ~LockFreeStack() { while (pop()) { } } void push(const T\u0026 x) { ReferenceCount t; t.p = new Node(x); t.external_cnt = 1; t.p-\u003enext = head_.load(); while (!head_.compare_exchange_weak(t.p-\u003enext, t)) { } } std::shared_ptr\u003cT\u003e pop() { ReferenceCount t = head_.load(); while (true) { increase_count(t); // å¤–éƒ¨è®¡æ•°é€’å¢è¡¨ç¤ºè¯¥èŠ‚ç‚¹æ­£è¢«ä½¿ç”¨ Node* p = t.p; // å› æ­¤å¯ä»¥å®‰å…¨åœ°è®¿é—® if (!p) { return nullptr; } if (head_.compare_exchange_strong(t, p-\u003enext)) { std::shared_ptr\u003cT\u003e res; res.swap(p-\u003ev); // å°†å¤–éƒ¨è®¡æ•°å‡ 2 ååŠ åˆ°å†…éƒ¨è®¡æ•°ï¼Œå‡ 2 æ˜¯å› ä¸ºï¼Œ // èŠ‚ç‚¹è¢«åˆ é™¤å‡ 1ï¼Œè¯¥çº¿ç¨‹æ— æ³•å†æ¬¡è®¿é—®æ­¤èŠ‚ç‚¹å†å‡ 1 const int cnt = t.external_cnt - 2; if (p-\u003einner_cnt.fetch_add(cnt) == -cnt) { delete p; // å†…å¤–éƒ¨è®¡æ•°å’Œä¸º 0 } return res; } if (p-\u003einner_cnt.fetch_sub(1) == 1) { delete p; // å†…éƒ¨è®¡æ•°ä¸º 0 } } } private: struct Node; struct ReferenceCount { int external_cnt; Node* p; }; struct Node { std::shared_ptr\u003cT\u003e v; std::atomic\u003cint\u003e inner_cnt = 0; ReferenceCount next; Node(const T\u0026 x) : v(std::make_shared\u003cT\u003e(x)) {} }; void increase_count(ReferenceCount\u0026 old_cnt) { ReferenceCount new_cnt; do { new_cnt = old_cnt; ++new_cnt.external_cnt; // è®¿é—® head_ æ—¶é€’å¢å¤–éƒ¨è®¡æ•°ï¼Œè¡¨ç¤ºè¯¥èŠ‚ç‚¹æ­£è¢«ä½¿ç”¨ } while (!head_.compare_exchange_strong(old_cnt, new_cnt)); old_cnt.external_cnt = new_cnt.external_cnt; } private: std::atomic\u003cReferenceCount\u003e head_; }; ä¸æŒ‡å®šå†…å­˜åºåˆ™é»˜è®¤ä½¿ç”¨å¼€é”€æœ€å¤§çš„ std::memory_order_seq_cstï¼Œä¸‹é¢æ ¹æ®æ“ä½œé—´çš„ä¾èµ–å…³ç³»ä¼˜åŒ–ä¸ºæœ€å°å†…å­˜åº #include \u003catomic\u003e #include \u003cmemory\u003e template \u003ctypename T\u003e class LockFreeStack { public: ~LockFreeStack() { while (pop()) { } } void push(const T\u0026 x) { ReferenceCount t; t.p = new Node(x); t.external_cnt = 1; // ä¸‹é¢æ¯”è¾ƒä¸­ release ä¿è¯ä¹‹å‰çš„è¯­å¥éƒ½å…ˆæ‰§è¡Œï¼Œå› æ­¤ load å¯ä»¥ä½¿ç”¨ relaxed t.p-\u003enext = head_.load(std::memory_order_relaxed); while (!head_.compare_exchange_weak(t.p-\u003enext, t, std::memory_order_release, std::memory_order_relaxed)) { } } std::shared_ptr\u003cT\u003e pop() { ReferenceCount t = head_.load(std::memory_order_relaxed); while (true) { increase_count(t); // acquire Node* p = t.p; if (!p) { return nullptr; } if (head_.compare_exchange_strong(t, p-\u003enext, std::memory_order_relaxed)) { std::shared_ptr\u003cT\u003e res; res.swap(p-\u003ev); // å°†å¤–éƒ¨è®¡æ•°å‡ 2 ååŠ åˆ°å†…éƒ¨è®¡æ•°ï¼Œå‡ 2 æ˜¯å› ä¸ºï¼Œ // èŠ‚ç‚¹è¢«åˆ é™¤å‡ 1ï¼Œè¯¥çº¿ç¨‹æ— æ³•å†æ¬¡è®¿é—®æ­¤èŠ‚ç‚¹å†å‡ 1 const int cnt = t.external_cnt - 2; // swap è¦å…ˆäº deleteï¼Œå› æ­¤ä½¿ç”¨ rele","date":"2023-11-28","objectID":"/posts/ch07_designing_lock_free_concurrent_data_structure/:2:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [7] | CH07 Designing Lock free Concurrent Data Structure","uri":"/posts/ch07_designing_lock_free_concurrent_data_structure/"},{"categories":["C++"],"content":" è®¾è®¡å¹¶å‘æ•°æ®ç»“æ„è¦è€ƒè™‘ä¸¤ç‚¹ï¼Œä¸€æ˜¯ç¡®ä¿è®¿é—® thread-safeï¼ŒäºŒæ˜¯æé«˜å¹¶å‘åº¦ thread-safe åŸºæœ¬è¦æ±‚å¦‚ä¸‹ æ•°æ®ç»“æ„çš„ä¸å˜é‡ï¼ˆinvariantï¼‰è¢«ä¸€ä¸ªçº¿ç¨‹ç ´åæ—¶ï¼Œç¡®ä¿ä¸è¢«çº¿ç¨‹çœ‹åˆ°æ­¤çŠ¶æ€ æä¾›æ“ä½œå®Œæ•´çš„å‡½æ•°æ¥é¿å…æ•°æ®ç»“æ„æ¥å£ä¸­å›ºæœ‰çš„ race condition æ³¨æ„æ•°æ®ç»“æ„å‡ºç°å¼‚å¸¸æ—¶çš„è¡Œä¸ºï¼Œä»¥ç¡®ä¿ä¸å˜é‡ä¸è¢«ç ´å é™åˆ¶é”çš„èŒƒå›´ï¼Œé¿å…å¯èƒ½çš„åµŒå¥—é”ï¼Œæœ€å°åŒ–æ­»é”çš„æ¦‚ç‡ ä½œä¸ºæ•°æ®ç»“æ„çš„è®¾è®¡è€…ï¼Œè¦æé«˜æ•°æ®ç»“æ„çš„å¹¶å‘åº¦ï¼Œå¯ä»¥ä»ä»¥ä¸‹è§’åº¦è€ƒè™‘ éƒ¨åˆ†æ“ä½œèƒ½å¦åœ¨é”çš„èŒƒå›´å¤–æ‰§è¡Œ æ•°æ®ç»“æ„çš„ä¸åŒéƒ¨åˆ†æ˜¯å¦è¢«ä¸åŒçš„ mutex ä¿æŠ¤ æ˜¯å¦æ‰€æœ‰æ“ä½œéœ€è¦åŒçº§åˆ«çš„ä¿æŠ¤ åœ¨ä¸å½±å“æ“ä½œè¯­ä¹‰çš„å‰æä¸‹ï¼Œèƒ½å¦å¯¹æ•°æ®ç»“æ„åšç®€å•çš„ä¿®æ”¹æé«˜å¹¶å‘åº¦ æ€»ç»“ä¸ºä¸€ç‚¹ï¼Œå³æœ€å°åŒ–çº¿ç¨‹å¯¹å…±äº«æ•°æ®çš„è½®æµè®¿é—®ï¼Œæœ€å¤§åŒ–çœŸå®çš„å¹¶å‘é‡ ","date":"2023-11-28","objectID":"/posts/ch06_designing_lock_based_concurrent_data_structure/:0:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [6] | CH06 Designing Lock-based Concurrent Data Structure","uri":"/posts/ch06_designing_lock_based_concurrent_data_structure/"},{"categories":["C++"],"content":"thread-safe queue ä¹‹å‰å®ç°è¿‡çš„ thread-safe stack å’Œ queue éƒ½æ˜¯ç”¨ä¸€æŠŠé”å®šä¿æŠ¤æ•´ä¸ªæ•°æ®ç»“æ„ï¼Œè¿™é™åˆ¶äº†å¹¶å‘æ€§ï¼Œå¤šçº¿ç¨‹åœ¨æˆå‘˜å‡½æ•°ä¸­é˜»å¡æ—¶ï¼ŒåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å·¥ä½œã€‚è¿™ç§é™åˆ¶ä¸»è¦æ˜¯å› ä¸ºå†…éƒ¨å®ç°ä½¿ç”¨çš„æ˜¯ std::queueï¼Œä¸ºäº†æ”¯æŒæ›´é«˜çš„å¹¶å‘ï¼Œéœ€è¦æ›´æ¢å†…éƒ¨çš„å®ç°æ–¹å¼ï¼Œä½¿ç”¨ç»†ç²’åº¦çš„ï¼ˆfine-grainedï¼‰é”ã€‚æœ€ç®€å•çš„å®ç°æ–¹å¼æ˜¯åŒ…å«å¤´å°¾æŒ‡é’ˆçš„å•é“¾è¡¨ï¼Œä¸è€ƒè™‘å¹¶å‘çš„å•é“¾è¡¨å®ç°å¦‚ä¸‹ #include \u003cmemory\u003e #include \u003cutility\u003e template \u003ctypename T\u003e class Queue { public: Queue() = default; Queue(const Queue\u0026) = delete; Queue\u0026 operator=(const Queue\u0026) = delete; void push(T x) { auto new_node = std::make_unique\u003cNode\u003e(std::move(x)); Node* new_tail_node = new_node.get(); if (tail_) { tail_-\u003enext = std::move(new_node); } else { head_ = std::move(new_node); } tail_ = new_tail_node; } std::shared_ptr\u003cT\u003e try_pop() { if (!head_) { return nullptr; } auto res = std::make_shared\u003cT\u003e(std::move(head_-\u003ev)); std::unique_ptr\u003cNode\u003e head_node = std::move(head_); head_ = std::move(head_node-\u003enext); return res; } private: struct Node { explicit Node(T x) : v(std::move(x)) {} T v; std::unique_ptr\u003cNode\u003e next; }; std::unique_ptr\u003cNode\u003e head_; Node* tail_ = nullptr; }; å³ä½¿ç”¨ä¸¤ä¸ª mutex åˆ†åˆ«ä¿æŠ¤å¤´å°¾æŒ‡é’ˆï¼Œè¿™ä¸ªå®ç°åœ¨å¤šçº¿ç¨‹ä¸‹ä¹Ÿæœ‰æ˜æ˜¾é—®é¢˜ã€‚push å¯ä»¥åŒæ—¶ä¿®æ”¹å¤´å°¾æŒ‡é’ˆï¼Œä¼šå¯¹ä¸¤ä¸ª mutex ä¸Šé”ï¼Œå¦å¤–ä»…æœ‰ä¸€ä¸ªå…ƒç´ æ—¶å¤´å°¾æŒ‡é’ˆç›¸ç­‰ï¼Œpush å†™å’Œ try_pop è¯»çš„ next èŠ‚ç‚¹æ˜¯åŒä¸€å¯¹è±¡ï¼Œäº§ç”Ÿäº†ç«äº‰ï¼Œé”çš„ä¹Ÿæ˜¯åŒä¸€ä¸ª mutex è¯¥é—®é¢˜å¾ˆå®¹æ˜“è§£å†³ï¼Œåœ¨å¤´èŠ‚ç‚¹å‰åˆå§‹åŒ–ä¸€ä¸ª dummy èŠ‚ç‚¹å³å¯ï¼Œè¿™æ · push åªè®¿é—®å°¾èŠ‚ç‚¹ï¼Œä¸ä¼šå†ä¸ try_pop ç«äº‰å¤´èŠ‚ç‚¹ #include \u003cmemory\u003e #include \u003cutility\u003e template \u003ctypename T\u003e class Queue { public: Queue() : head_(new Node), tail_(head_.get()) {} Queue(const Queue\u0026) = delete; Queue\u0026 operator=(const Queue\u0026) = delete; void push(T x) { auto new_val = std::make_shared\u003cT\u003e(std::move(x)); auto new_node = std::make_unique\u003cNode\u003e(); Node* new_tail_node = new_node.get(); tail_-\u003ev = new_val; tail_-\u003enext = std::move(new_node); tail_ = new_tail_node; } std::shared_ptr\u003cT\u003e try_pop() { if (head_.get() == tail_) { return nullptr; } std::shared_ptr\u003cT\u003e res = head-\u003ev; std::unique_ptr\u003cNode\u003e head_node = std::move(head_); head_ = std::move(head_node-\u003enext); return res; } private: struct Node { std::shared_ptr\u003cT\u003e v; std::unique_ptr\u003cNode\u003e next; }; std::unique_ptr\u003cNode\u003e head_; Node* tail_ = nullptr; }; æ¥ç€åŠ ä¸Šé”ï¼Œé”çš„èŒƒå›´åº”è¯¥å°½å¯èƒ½å° #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cutility\u003e template \u003ctypename T\u003e class ConcurrentQueue { public: ConcurrentQueue() : head_(new Node), tail_(head_.get()) {} ConcurrentQueue(const ConcurrentQueue\u0026) = delete; ConcurrentQueue\u0026 operator=(const ConcurrentQueue\u0026) = delete; void push(T x) { auto new_val = std::make_shared\u003cT\u003e(std::move(x)); auto new_node = std::make_unique\u003cNode\u003e(); Node* new_tail_node = new_node.get(); std::lock_guard\u003cstd::mutex\u003e l(tail_mutex_); tail_-\u003ev = new_val; tail_-\u003enext = std::move(new_node); tail_ = new_tail_node; } std::shared_ptr\u003cT\u003e try_pop() { std::unique_ptr\u003cNode\u003e head_node = pop_head(); return head_node ? head_node-\u003ev : nullptr; } private: struct Node { std::shared_ptr\u003cT\u003e v; std::unique_ptr\u003cNode\u003e next; }; private: std::unique_ptr\u003cNode\u003e pop_head() { std::lock_guard\u003cstd::mutex\u003e l(head_mutex_); if (head_.get() == get_tail()) { return nullptr; } std::unique_ptr\u003cNode\u003e head_node = std::move(head_); head_ = std::move(head_node-\u003enext); return head_node; } Node* get_tail() { std::lock_guard\u003cstd::mutex\u003e l(tail_mutex_); return tail_; } private: std::unique_ptr\u003cNode\u003e head_; Node* tail_ = nullptr; std::mutex head_mutex_; std::mutex tail_mutex_; }; push ä¸­åˆ›å»ºæ–°å€¼å’Œæ–°èŠ‚ç‚¹éƒ½æ²¡ä¸Šé”ï¼Œå¤šçº¿ç¨‹å¯ç”¨å¹¶å‘åˆ›å»ºæ–°å€¼å’Œæ–°èŠ‚ç‚¹ã€‚è™½ç„¶åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ·»åŠ æ–°èŠ‚ç‚¹ï¼Œä½†è¿™åªéœ€è¦ä¸€ä¸ªæŒ‡é’ˆèµ‹å€¼æ“ä½œï¼Œé”ä½å°¾èŠ‚ç‚¹çš„æ—¶é—´å¾ˆçŸ­ï¼Œtry_pop ä¸­å¯¹å°¾èŠ‚ç‚¹åªæ˜¯ç”¨æ¥åšä¸€æ¬¡æ¯”è¾ƒï¼ŒæŒæœ‰å°¾èŠ‚ç‚¹çš„æ—¶é—´åŒæ ·å¾ˆçŸ­ï¼Œå› æ­¤ try_pop å’Œ push å‡ ä¹å¯ä»¥åŒæ—¶è°ƒç”¨ã€‚try_pop ä¸­é”ä½å¤´èŠ‚ç‚¹æ‰€åšçš„ä¹Ÿåªæ˜¯æŒ‡é’ˆèµ‹å€¼æ“ä½œï¼Œå¼€é”€è¾ƒå¤§çš„ææ„åœ¨é”å¤–è¿›è¡Œï¼Œè¿™æ„å‘³ç€è™½ç„¶åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½ pop_headï¼Œä½†å…è®¸å¤šçº¿ç¨‹åˆ é™¤èŠ‚ç‚¹å¹¶è¿”å›æ•°æ®ï¼Œæå‡äº† try_pop çš„å¹¶å‘è°ƒç”¨æ•°é‡ æœ€åå†ç»“åˆ std::condition_variable å®ç° wait_and_popï¼Œå³å¾—åˆ°ä¸ä¹‹å‰æ¥å£ç›¸åŒä½†å¹¶å‘åº¦æ›´é«˜çš„ thread-safe queue #include \u003ccondition_variable\u003e #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cutility\u003e template \u003ctypename T\u003e class ConcurrentQueue { public: ConcurrentQueue() : head_(new Node), tail_(head_.get()) {} ConcurrentQueue(const ConcurrentQueue\u0026) = delete; ConcurrentQueue\u0026 operator=(const ConcurrentQueue\u0026) = delete; void push(T x) { auto new_val = std::make_shared\u003cT\u003e(std::move(x)); auto new_node = std::make_unique\u003cNode\u003e(); Node* new_tail_node = new_node.get(); { std::lock_guard\u003cstd::mutex\u003e l(tail_mutex_); tail_-\u003ev = new_val; tail_-\u003en","date":"2023-11-28","objectID":"/posts/ch06_designing_lock_based_concurrent_data_structure/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [6] | CH06 Designing Lock-based Concurrent Data Structure","uri":"/posts/ch06_designing_lock_based_concurrent_data_structure/"},{"categories":["C++"],"content":"thread-safe map å¹¶å‘è®¿é—® std::map å’Œ std::unordered_map çš„æ¥å£çš„é—®é¢˜åœ¨äºè¿­ä»£å™¨ï¼Œå…¶ä»–çº¿ç¨‹åˆ é™¤å…ƒç´ æ—¶ä¼šå¯¼è‡´è¿­ä»£å™¨å¤±æ•ˆï¼Œå› æ­¤ thread-safe map çš„æ¥å£è®¾è®¡å°±è¦è·³è¿‡è¿­ä»£å™¨ ä¸ºäº†ä½¿ç”¨ç»†ç²’åº¦é”ï¼Œå°±ä¸åº”è¯¥ä½¿ç”¨æ ‡å‡†åº“å®¹å™¨ã€‚å¯é€‰çš„å…³è”å®¹å™¨æ•°æ®ç»“æ„æœ‰ä¸‰ç§ï¼Œä¸€æ˜¯äºŒå‰æ ‘ï¼ˆå¦‚çº¢é»‘æ ‘ï¼‰ï¼Œä½†æ¯æ¬¡æŸ¥æ‰¾ä¿®æ”¹éƒ½è¦ä»è®¿é—®æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¹Ÿå°±è¡¨ç¤ºæ ¹èŠ‚ç‚¹éœ€è¦ä¸Šé”ï¼Œå°½ç®¡æ²¿ç€æ ‘å‘ä¸‹è®¿é—®èŠ‚ç‚¹æ—¶ä¼šè§£é”ï¼Œä½†è¿™ä¸ªæ¯”èµ·è¦†ç›–æ•´ä¸ªæ•°æ®ç»“æ„çš„å•ä¸ªé”å¥½ä¸äº†å¤šå°‘ ç¬¬äºŒç§æ–¹å¼æ˜¯æœ‰åºæ•°ç»„ï¼Œè¿™æ¯”äºŒå‰æ ‘è¿˜å·®ï¼Œå› ä¸ºæ— æ³•æå‰å¾—çŸ¥ä¸€ä¸ªç»™å®šçš„å€¼åº”è¯¥æ”¾åœ¨å“ªï¼Œäºæ˜¯åŒæ ·éœ€è¦ä¸€ä¸ªè¦†ç›–æ•´ä¸ªæ•°ç»„çš„é” ç¬¬ä¸‰ç§æ–¹å¼æ˜¯å“ˆå¸Œè¡¨ã€‚å‡å¦‚æœ‰ä¸€ä¸ªå›ºå®šæ•°é‡çš„æ¡¶ï¼Œä¸€ä¸ª key å±äºå“ªä¸ªæ¡¶å–å†³äº key çš„å±æ€§å’Œå“ˆå¸Œå‡½æ•°ï¼Œè¿™æ„å‘³ç€å¯ä»¥å®‰å…¨åœ°åˆ†å¼€é”ä½æ¯ä¸ªæ¡¶ã€‚å¦‚æœä½¿ç”¨è¯»å†™é”ï¼Œå°±èƒ½å°†å¹¶å‘åº¦æé«˜ç›¸å½“äºæ¡¶æ•°é‡çš„å€æ•° #include \u003calgorithm\u003e #include \u003cfunctional\u003e #include \u003clist\u003e #include \u003cmap\u003e #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cshared_mutex\u003e #include \u003cutility\u003e #include \u003cvector\u003e template \u003ctypename K, typename V, typename Hash = std::hash\u003cK\u003e\u003e class ConcurrentMap { public: // æ¡¶æ•°é»˜è®¤ä¸º 19ï¼ˆä¸€èˆ¬ç”¨ x % æ¡¶æ•°ä½œä¸º x çš„æ¡¶ç´¢å¼•ï¼Œæ¡¶æ•°ä¸ºè´¨æ•°å¯ä½¿æ¡¶åˆ†å¸ƒå‡åŒ€ï¼‰ ConcurrentMap(std::size_t n = 19, const Hash\u0026 h = Hash{}) : buckets_(n), hasher_(h) { for (auto\u0026 x : buckets_) { x.reset(new Bucket); } } ConcurrentMap(const ConcurrentMap\u0026) = delete; ConcurrentMap\u0026 operator=(const ConcurrentMap\u0026) = delete; V get(const K\u0026 k, const V\u0026 default_value = V{}) const { return get_bucket(k).get(k, default_value); } void set(const K\u0026 k, const V\u0026 v) { get_bucket(k).set(k, v); } void erase(const K\u0026 k) { get_bucket(k).erase(k); } // ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæä¾›ä¸€ä¸ªåˆ° std::map çš„æ˜ å°„ std::map\u003cK, V\u003e to_map() const { std::vector\u003cstd::unique_lock\u003cstd::shared_mutex\u003e\u003e locks; for (auto\u0026 x : buckets_) { locks.emplace_back(std::unique_lock\u003cstd::shared_mutex\u003e(x-\u003em)); } std::map\u003cK, V\u003e res; for (auto\u0026 x : buckets_) { for (auto\u0026 y : x-\u003edata) { res.emplace(y); } } return res; } private: struct Bucket { std::list\u003cstd::pair\u003cK, V\u003e\u003e data; mutable std::shared_mutex m; // æ¯ä¸ªæ¡¶éƒ½ç”¨è¿™ä¸ªé”ä¿æŠ¤ V get(const K\u0026 k, const V\u0026 default_value) const { // æ²¡æœ‰ä¿®æ”¹ä»»ä½•å€¼ï¼Œå¼‚å¸¸å®‰å…¨ std::shared_lock\u003cstd::shared_mutex\u003e l(m); // åªè¯»é”ï¼Œå¯å…±äº« auto it = std::find_if(data.begin(), data.end(), [\u0026](auto\u0026 x) { return x.first == k; }); return it == data.end() ? default_value : it-\u003esecond; } void set(const K\u0026 k, const V\u0026 v) { std::unique_lock\u003cstd::shared_mutex\u003e l(m); // å†™ï¼Œå•ç‹¬å ç”¨ auto it = std::find_if(data.begin(), data.end(), [\u0026](auto\u0026 x) { return x.first == k; }); if (it == data.end()) { data.emplace_back(k, v); // emplace_back å¼‚å¸¸å®‰å…¨ } else { it-\u003esecond = v; // èµ‹å€¼å¯èƒ½æŠ›å¼‚å¸¸ï¼Œä½†å€¼æ˜¯ç”¨æˆ·æä¾›çš„ï¼Œå¯æ”¾å¿ƒè®©ç”¨æˆ·å¤„ç† } } void erase(const K\u0026 k) { std::unique_lock\u003cstd::shared_mutex\u003e l(m); // å†™ï¼Œå•ç‹¬å ç”¨ auto it = std::find_if(data.begin(), data.end(), [\u0026](auto\u0026 x) { return x.first == k; }); if (it != data.end()) { data.erase(it); } } }; Bucket\u0026 get_bucket(const K\u0026 k) const { // æ¡¶æ•°å›ºå®šå› æ­¤å¯ä»¥æ— é”è°ƒç”¨ return *buckets_[hasher_(k) % buckets_.size()]; } private: std::vector\u003cstd::unique_ptr\u003cBucket\u003e\u003e buckets_; Hash hasher_; }; ","date":"2023-11-28","objectID":"/posts/ch06_designing_lock_based_concurrent_data_structure/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [6] | CH06 Designing Lock-based Concurrent Data Structure","uri":"/posts/ch06_designing_lock_based_concurrent_data_structure/"},{"categories":["C++"],"content":"thread-safe list #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cutility\u003e template \u003ctypename T\u003e class ConcurrentList { public: ConcurrentList() = default; ~ConcurrentList() { remove_if([](const Node\u0026) { return true; }); } ConcurrentList(const ConcurrentList\u0026) = delete; ConcurrentList\u0026 operator=(const ConcurrentList\u0026) = delete; void push_front(const T\u0026 x) { std::unique_ptr\u003cNode\u003e t(new Node(x)); std::lock_guard\u003cstd::mutex\u003e head_lock(head_.m); t-\u003enext = std::move(head_.next); head_.next = std::move(t); } template \u003ctypename F\u003e void for_each(F f) { Node* cur = \u0026head_; std::unique_lock\u003cstd::mutex\u003e head_lock(head_.m); while (Node* const next = cur-\u003enext.get()) { std::unique_lock\u003cstd::mutex\u003e next_lock(next-\u003em); head_lock.unlock(); // é”ä½äº†ä¸‹ä¸€èŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥é‡Šæ”¾ä¸Šä¸€èŠ‚ç‚¹çš„é” f(*next-\u003edata); cur = next; // å½“å‰èŠ‚ç‚¹æŒ‡å‘ä¸‹ä¸€èŠ‚ç‚¹ head_lock = std::move(next_lock); // è½¬äº¤ä¸‹ä¸€èŠ‚ç‚¹é”çš„æ‰€æœ‰æƒï¼Œå¾ªç¯ä¸Šè¿°è¿‡ç¨‹ } } template \u003ctypename F\u003e std::shared_ptr\u003cT\u003e find_first_if(F f) { Node* cur = \u0026head_; std::unique_lock\u003cstd::mutex\u003e head_lock(head_.m); while (Node* const next = cur-\u003enext.get()) { std::unique_lock\u003cstd::mutex\u003e next_lock(next-\u003em); head_lock.unlock(); if (f(*next-\u003edata)) { return next-\u003edata; // è¿”å›ç›®æ ‡å€¼ï¼Œæ— éœ€ç»§ç»­æŸ¥æ‰¾ } cur = next; head_lock = std::move(next_lock); } return nullptr; } template \u003ctypename F\u003e void remove_if(F f) { Node* cur = \u0026head_; std::unique_lock\u003cstd::mutex\u003e head_lock(head_.m); while (Node* const next = cur-\u003enext.get()) { std::unique_lock\u003cstd::mutex\u003e next_lock(next-\u003em); if (f(*next-\u003edata)) { // ä¸º true åˆ™ç§»é™¤ä¸‹ä¸€èŠ‚ç‚¹ std::unique_ptr\u003cNode\u003e old_next = std::move(cur-\u003enext); cur-\u003enext = std::move(next-\u003enext); // ä¸‹ä¸€èŠ‚ç‚¹è®¾ä¸ºä¸‹ä¸‹èŠ‚ç‚¹ next_lock.unlock(); } else { // å¦åˆ™ç»§ç»­è½¬è‡³ä¸‹ä¸€èŠ‚ç‚¹ head_lock.unlock(); cur = next; head_lock = std::move(next_lock); } } } private: struct Node { std::mutex m; std::shared_ptr\u003cT\u003e data; std::unique_ptr\u003cNode\u003e next; Node() = default; Node(const T\u0026 x) : data(std::make_shared\u003cT\u003e(x)) {} }; Node head_; }; ","date":"2023-11-28","objectID":"/posts/ch06_designing_lock_based_concurrent_data_structure/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [6] | CH06 Designing Lock-based Concurrent Data Structure","uri":"/posts/ch06_designing_lock_based_concurrent_data_structure/"},{"categories":["C++"],"content":"è¿›ç¨‹ åœ¨è¿›ç¨‹æ¨¡å‹ä¸­ï¼Œè®¡ç®—æœºä¸Šæ‰€æœ‰å¯è¿è¡Œçš„è½¯ä»¶ï¼Œé€šå¸¸ä¹ŸåŒ…æ‹¬æ“ä½œç³»ç»Ÿï¼Œè¢«ç»„ç»‡æˆè‹¥å¹²é¡ºåºè¿›ç¨‹(sequential process)ï¼Œç®€ç§°è¿›ç¨‹(process)ï¼Œä¸€ä¸ªè¿›ç¨‹å°±æ˜¯å°±æ˜¯ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œç¨‹åºçš„å®ä¾‹ï¼ŒåŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€å¯„å­˜å™¨å’Œå˜é‡çš„å½“å‰å€¼ æ¦‚å¿µä¸Šæ¥è¯´ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„è™šæ‹Ÿ CPUï¼Œä½†å®é™…ä¸ŠçœŸæ­£çš„ CPU(å‡è®¾åªæœ‰ä¸€ä¸ª CPU)åœ¨å„è¿›ç¨‹ä¹‹é—´æ¥å›åˆ‡æ¢ï¼ŒåŒä¸€æ—¶åˆ»å®é™…åªæœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨è¿è¡Œ å®é™…åªæœ‰ä¸€ä¸ªç‰©ç†ç¨‹åºè®¡æ•°å™¨ã€‚æ¯ä¸ªè¿›ç¨‹è¿è¡Œæ—¶ï¼Œå®ƒçš„é€»è¾‘ç¨‹åºè®¡æ•°å™¨è¢«è£…å…¥å®é™…çš„ç¨‹åºè®¡æ•°å™¨ã€‚å½“è¿›ç¨‹ç»“æŸæ—¶ï¼Œç‰©ç†ç¨‹åºè®¡æ•°å™¨ä¿å­˜åˆ°å†…å­˜ä¸­è¯¥è¿›ç¨‹çš„é€»è¾‘ç¨‹åºè®¡æ•°å™¨ä¸­ è¿›ç¨‹åˆ›å»ºä¸»è¦æœ‰å››ç§å½¢å¼ ç³»ç»Ÿåˆå§‹åŒ–ï¼šå¯åŠ¨ç³»ç»Ÿæ—¶ä¼šåˆ›å»ºè‹¥å¹²è¿›ç¨‹ï¼ŒåŒ…æ‹¬å’Œç”¨æˆ·äº¤äº’çš„å‰å°è¿›ç¨‹å’Œåœåœ¨åå°çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œå®ˆæŠ¤è¿›ç¨‹å¯ä»¥é€šè¿‡ UNIX çš„ ps æŒ‡ä»¤æˆ– Window çš„ä»»åŠ¡ç®¡ç†å™¨æŸ¥çœ‹ è¿è¡Œä¸­çš„ç¨‹åºæ‰§è¡Œåˆ›å»ºè¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ï¼šæ¯”å¦‚å¯åŠ¨ä¸€ä¸ªç¨‹åºï¼Œè¯¥ç¨‹åºè¦å¯åŠ¨æ›´å¤šè¿›ç¨‹æ¥åˆ†é…ä»»åŠ¡ ç”¨æˆ·è¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼šæ¯”å¦‚ç”¨æˆ·åŒå‡»å›¾æ ‡å¯åŠ¨ç¨‹åº å¤§å‹æœºæ‰¹å¤„ç†ä½œä¸šçš„åˆå§‹åŒ– åˆ›å»ºè¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨åœ¨ UNIX ä¸­æ˜¯ forkï¼Œåœ¨ Windows ä¸­æ˜¯ CreateProcessï¼Œè¿›ç¨‹åˆ›å»ºåï¼Œçˆ¶å­è¿›ç¨‹æœ‰ä¸åŒçš„åœ°å€ç©ºé—´ è¿›ç¨‹ç»ˆæ­¢é€šå¸¸ä¹Ÿæœ‰å››ç§å½¢å¼ æ­£å¸¸é€€å‡º(è‡ªæ„¿çš„)ï¼šæ¯”å¦‚ç‚¹å‡»æµè§ˆå™¨çš„å…³é—­å›¾æ ‡ã€‚è¿›ç¨‹é€€å‡ºçš„ç³»ç»Ÿè°ƒç”¨åœ¨ UNIX ä¸­æ˜¯ exitï¼Œåœ¨ Windows ä¸­æ˜¯ ExitProcess å‡ºé”™é€€å‡º(è‡ªæ„¿çš„)ï¼šæ¯”å¦‚æ‰§è¡Œ cc foo.c ç¼–è¯‘ foo.c è€Œè¯¥æ–‡ä»¶ä¸å­˜åœ¨ ä¸¥é‡é”™è¯¯(éè‡ªæ„¿)ï¼šæ¯”å¦‚æ‰§è¡Œéæ³•æŒ‡ä»¤ã€å¼•ç”¨ä¸å­˜åœ¨çš„å†…å­˜ã€é™¤æ•°æ˜¯é›¶ï¼ŒUNIXä¸­ä¼šå¸Œæœ›è‡ªè¡Œå¤„ç†è¿™äº›é”™è¯¯ä»¥é€šçŸ¥æ“ä½œç³»ç»Ÿï¼Œè¿›ç¨‹ä¼šæ”¶åˆ°ä¿¡å·è¢«ä¸­æ–­è€Œéç»ˆæ­¢ è¢«å…¶ä»–è¿›ç¨‹æ€æ­»(éè‡ªæ„¿)ï¼šUNIX ä¸­æ˜¯ killï¼ŒWindows ä¸­æ˜¯ TerminateProcess UNIXä¸­ï¼Œè¿›ç¨‹å’Œå…¶æ‰€æœ‰å­è¿›ç¨‹(åŒ…æ‹¬å…¶åè£”)ç»„æˆä¸€ä¸ªè¿›ç¨‹ç»„ï¼Œå½“ç”¨æˆ·å‘å‡ºä¸€ä¸ªé”®ç›˜ä¿¡å·ï¼Œè¯¥ä¿¡å·ä¼šå‘é€ç»™è¿›ç¨‹ç»„æ‰€æœ‰æˆå‘˜ Windowsä¸­æ²¡æœ‰è¿›ç¨‹å±‚æ¬¡çš„æ¦‚å¿µï¼Œæ‰€æœ‰è¿›ç¨‹åœ°ä½ç›¸åŒ è¿›ç¨‹é˜»å¡æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€æ˜¯æ­£å¸¸æƒ…å†µï¼Œæ¯”å¦‚æ“ä½œç³»ç»Ÿè°ƒåº¦å¦ä¸€ä¸ªè¿›ç¨‹å ç”¨ CPUï¼ŒäºŒæ˜¯å¼‚å¸¸æƒ…å†µï¼Œæ¯”å¦‚æ²¡æœ‰è¶³å¤Ÿçš„ CPU å¯è°ƒç”¨ è¿›ç¨‹æœ‰ä¸‰ç§çŠ¶æ€ï¼šè¿è¡Œã€å°±ç»ªã€é˜»å¡ è¿è¡Œ \u003c-\u003e å°±ç»ª â†˜ â†— é˜»å¡ è¿è¡Œï¼šè¯¥æ—¶åˆ»å®é™…å ç”¨ CPU å°±ç»ªï¼šæ“ä½œç³»ç»Ÿè°ƒåº¦äº†å…¶ä»–è¿›ç¨‹è¿è¡Œè€Œæš‚æ—¶åœæ­¢ é˜»å¡ï¼šé€»è¾‘ä¸Šä¸èƒ½ç»§ç»­è¿è¡Œï¼Œæ¯”å¦‚ç­‰å¾…ç”¨æˆ·è¾“å…¥ æ“ä½œç³»ç»Ÿé€šè¿‡ç»´æŠ¤ä¸€å¼ è¿›ç¨‹è¡¨(ä¸€ä¸ªç»“æ„æ•°ç»„)æ¥å®ç°è¿›ç¨‹æ¨¡å‹ï¼Œæ¯ä¸ªè¿›ç¨‹å ä¸€ä¸ªè¡¨é¡¹(å³è¿›ç¨‹æ§åˆ¶å—ï¼ŒProcessing Control Block)ã€‚PCB åŒ…å«äº†è¿›ç¨‹çŠ¶æ€çš„ä¸»è¦ä¿¡æ¯ï¼Œå¦‚ç¨‹åºè®¡æ•°å™¨ã€å †æ ˆæŒ‡é’ˆã€å†…å­˜åˆ†é…çŠ¶æ€ã€æ‰€æ‰“å¼€çš„æ–‡ä»¶çŠ¶æ€ã€è´¦å·å’Œè°ƒåº¦ä¿¡æ¯ã€è¿›ç¨‹çŠ¶æ€åˆ‡æ¢æ—¶å¿…é¡»ä¿å­˜çš„ä¿¡æ¯ æ‰€æœ‰ä¸­æ–­éƒ½ä»ä¿å­˜å¯„å­˜å™¨å¼€å§‹ï¼Œé€šå¸¸ä¼šä¿å­˜åˆ°å½“å‰è¿›ç¨‹çš„ PCB ä¸­ã€‚ä¸€ä¸ªè¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¸­æ–­å‡ åƒæ¬¡ï¼Œä½†æ¢å¤æ—¶ï¼Œè¢«ä¸­æ–­çš„è¿›ç¨‹éƒ½å°†è¿”å›åˆ°ä¸ä¸­æ–­å‘ç”Ÿå‰å®Œå…¨ç›¸åŒçš„çŠ¶æ€ å‘ç”Ÿä¸­æ–­åï¼Œæ“ä½œç³»ç»Ÿæœ€åº•å±‚çš„å·¥ä½œè¿‡ç¨‹ ä¸­æ–­ç¡¬ä»¶å°†ç¨‹åºè®¡æ•°å™¨ã€ç¨‹åºçŠ¶æ€å­—ã€å¯„å­˜å™¨å‹å…¥å †æ ˆ ç¡¬ä»¶ä»ä¸­æ–­å‘é‡è£…å…¥æ–°çš„ç¨‹åºè®¡æ•°å™¨ é€šè¿‡æ±‡ç¼–ä¿å­˜å¯„å­˜å™¨å€¼(å› ä¸ºè¿™ç±»æ“ä½œæ— æ³•ç”¨é«˜çº§è¯­è¨€å®Œæˆ) é€šè¿‡æ±‡ç¼–è®¾ç½®æ–°çš„å †æ ˆ è¿è¡ŒCè¯­è¨€(å‡è®¾æ“ä½œç³»ç»Ÿç”¨Cç¼–å†™)ä¸­æ–­æœåŠ¡ä¾‹ç¨‹ è°ƒç”¨è°ƒåº¦ç¨‹åºï¼Œå†³å®šæ¥ä¸‹æ¥è¦è¿è¡Œçš„è¿›ç¨‹ Cè¿”å›åˆ°æ±‡ç¼– é€šè¿‡æ±‡ç¼–è¿è¡Œæ–°è¿›ç¨‹ å‡è®¾ä¸€ä¸ªè¿›ç¨‹ç­‰å¾… I/O æ“ä½œä¸å…¶åœ¨å†…å­˜ä¸­åœç•™çš„æ—¶é—´æ¯”ä¸º pï¼Œåˆ™ n ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…(æ­¤æ—¶ CPU ç©ºè½¬)çš„æ¦‚ç‡ä¸º p ^ nï¼ŒCPU åˆ©ç”¨ç‡ä¸º 1 - p ^ nï¼Œå› æ­¤ä¸€èˆ¬(è¯¥æ¨¡å‹åªæ˜¯ç²—ç•¥æƒ…å†µ)I/O æ—¶é—´è¶ŠçŸ­ã€è¿è¡Œè¿›ç¨‹è¶Šå¤šï¼ŒCPU åˆ©ç”¨ç‡è¶Šé«˜ å‡å¦‚å†…å­˜ä¸º 8Gï¼Œæ“ä½œç³»ç»Ÿå’Œç›¸å…³è¡¨æ ¼å  2Gï¼Œç”¨æˆ·ç¨‹åºä¹Ÿå  2Gï¼Œå†…å­˜æœ€å¤šå®¹çº³ 3 ä¸ªç”¨æˆ·ç¨‹åº å‡è®¾ 80% æ—¶é—´ç”¨äºç­‰å¾… I/O æ“ä½œ CPU åˆ©ç”¨ç‡ = 1 - 0.8 ^ 3 = 49% å¦‚æœå¢åŠ  8G å†…å­˜ï¼Œåˆ™æœ€å¤šå®¹çº³ 7 ä¸ªç”¨æˆ·ç¨‹åº CPU åˆ©ç”¨ç‡ = 1 - 0.8 ^ 7 = 79%ï¼Œååé‡æé«˜ä¸º 79% - 49% = 30% å¦‚æœå†å¢åŠ  8G å†…å­˜ï¼Œåˆ™æœ€å¤šå®¹çº³ 11 ä¸ªç”¨æˆ·ç¨‹åº CPU åˆ©ç”¨ç‡ = 1 - 0.8 ^ 11 = 91%ï¼Œååé‡åªæé«˜äº† 12%ï¼Œå¯è§ç¬¬ä¸€æ¬¡å¢åŠ å†…å­˜æ¯”è¾ƒåˆ’ç®— ","date":"2023-11-19","objectID":"/posts/processesandthreads/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"çº¿ç¨‹ æ­£å¦‚è¿›ç¨‹æä¾›çš„æŠ½è±¡ä½¿å¾—é¿å…äº†å¯¹ä¸­æ–­ã€å®šæ—¶å™¨ã€ä¸Šä¸‹æ–‡åˆ‡æ¢çš„è€ƒè™‘ï¼Œå¤šçº¿ç¨‹æä¾›äº†ä¸€ç§æ–°æŠ½è±¡ï¼Œå³å¹¶è¡Œå®ä¾‹å…±äº«åŒä¸€åœ°å€ç©ºé—´å’Œæ‰€æœ‰å¯ç”¨æ•°æ®ï¼Œè¿™æ­£æ˜¯å¤šè¿›ç¨‹æ¨¡å‹(åœ°å€ç©ºé—´ä¸åŒ)æ— æ³•è¡¨è¾¾çš„ ç¬¬äºŒä¸ªéœ€è¦å¤šçº¿ç¨‹çš„ç†ç”±æ˜¯ï¼Œçº¿ç¨‹æ›´è½»é‡ï¼Œåˆ›å»ºå’Œæ’¤é”€éƒ½æ›´å¿«(é€šå¸¸åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¯”åˆ›å»ºä¸€ä¸ªè¿›ç¨‹å¿« 10 - 100 å€) ç¬¬ä¸‰ä¸ªç†ç”±æ˜¯å¤šæ ¸ CPU ç³»ç»Ÿä¸­ï¼Œå¤šçº¿ç¨‹ä¸ºçœŸæ­£çš„å¹¶è¡Œæä¾›äº†å¯èƒ½ çº¿ç¨‹åŒ…å«ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨(è®°å½•æ¥ä¸‹æ¥è¦æ‰§è¡Œå“ªä¸€æ¡æŒ‡ä»¤)ã€å¯„å­˜å™¨(ä¿å­˜çº¿ç¨‹å½“å‰çš„å·¥ä½œå˜é‡)ã€å †æ ˆæŒ‡é’ˆ(è®°å½•æ‰§è¡Œå†å²ï¼Œæ¯ä¸ªçº¿ç¨‹çš„å †æ ˆæœ‰ä¸€å¸§ï¼Œæ¯ä¸€å¸§ä¿å­˜ä¸€ä¸ªå·²è°ƒç”¨ä½†è¿˜æœªè¿”å›çš„è¿‡ç¨‹ï¼Œå¦‚å±€éƒ¨å˜é‡ã€è¿”å›åœ°å€) å„çº¿ç¨‹å¯ä»¥è®¿é—®è¿›ç¨‹åœ°å€ç©ºé—´çš„æ¯ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¯»å†™ç”šè‡³æ¸…é™¤å¦ä¸€ä¸ªçº¿ç¨‹çš„å †æ ˆã€‚çº¿ç¨‹ä¹‹é—´æ²¡æœ‰ä¿æŠ¤ï¼Œå› ä¸ºä¸å¯èƒ½ï¼Œä¹Ÿæ²¡å¿…è¦ é™¤äº†å…±äº«åœ°å€ç©ºé—´ï¼Œçº¿ç¨‹è¿˜å…±äº«åŒä¸€ä¸ªæ‰“å¼€æ–‡ä»¶é›†ã€å­è¿›ç¨‹ã€å®šæ—¶å™¨åŠç›¸å…³ä¿¡å·é‡ çº¿ç¨‹å¯ä»¥å¤„åœ¨è¿è¡Œã€å°±ç»ªã€é˜»å¡ã€ç»ˆæ­¢ç­‰çŠ¶æ€ä¸­çš„ä»»ä½•ä¸€ä¸ª thread_yield å…è®¸çº¿ç¨‹è‡ªåŠ¨æ”¾å¼ƒ CPU è½¬è®©ç»™å¦ä¸€ä¸ªçº¿ç¨‹è¿è¡Œï¼Œæä¾›è¿™ä¸ªè°ƒç”¨æ˜¯å› ä¸ºï¼Œä¸åŒäºè¿›ç¨‹ï¼Œçº¿ç¨‹åº“ä¸èƒ½åˆ©ç”¨æ—¶é’Ÿä¸­æ–­å¼ºåˆ¶çº¿ç¨‹è®©å‡º CPU å®ç°çº¿ç¨‹åŒ…ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯ç”¨æˆ·çº§çº¿ç¨‹(User-Level Thread)ï¼ŒäºŒæ˜¯å†…æ ¸çº§çº¿ç¨‹(Kernel-Level Thread)ï¼Œå¦å¤–ä¹Ÿæœ‰æ··åˆå®ç° ç”¨æˆ·çº§çº¿ç¨‹æŠŠæ•´ä¸ªçº¿ç¨‹åŒ…æ”¾åœ¨ç”¨æˆ·ç©ºé—´ä¸­ï¼Œå†…æ ¸å¯¹å…¶ä¸€æ— æ‰€çŸ¥ï¼Œä¸éœ€è¦å†…æ ¸æ”¯æŒï¼Œå¯ä»¥åœ¨ä¸æ”¯æŒçº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸Šå®ç°ã€‚åœ¨ç”¨æˆ·ç©ºé—´ç®¡ç†çº¿ç¨‹æ—¶ï¼Œæ¯ä¸ªè¿›ç¨‹éœ€è¦æœ‰å…¶ä¸“ç”¨çš„çº¿ç¨‹è¡¨(thread table)ï¼Œè¿™äº›è¡¨å’Œå†…æ ¸ä¸­çš„è¿›ç¨‹è¡¨ç±»ä¼¼ï¼Œåªä¸è¿‡è®°å½•çš„æ˜¯å„ä¸ªçº¿ç¨‹çš„å±æ€§ï¼Œå¦‚ç¨‹åºè®¡æ•°å™¨ã€å¯„å­˜å™¨ã€å †æ ˆæŒ‡é’ˆå’ŒçŠ¶æ€ç­‰ã€‚è¯¥çº¿ç¨‹è¡¨ç”±è¿è¡Œæ—¶ç³»ç»Ÿç®¡ç†ï¼Œå½“çº¿ç¨‹è½¬æ¢åˆ°å°±ç»ªæˆ–é˜»å¡çŠ¶æ€æ—¶ï¼Œåœ¨çº¿ç¨‹è¡¨ä¸­å­˜æ”¾é‡å¯è¯¥çº¿ç¨‹æ‰€éœ€çš„ä¿¡æ¯ï¼Œä¸å†…æ ¸åœ¨è¿›ç¨‹è¡¨ä¸­å­˜æ”¾è¿›ç¨‹çš„ä¿¡æ¯å®Œå…¨ä¸€æ · ç”¨æˆ·çº§çº¿ç¨‹å…è®¸è¿›ç¨‹æœ‰è‡ªå·±å®šåˆ¶çš„è°ƒåº¦ç®—æ³•ï¼Œå…·æœ‰æ›´å¥½çš„å¯æ‰©å±•æ€§(å› ä¸ºå†…æ ¸çº§çº¿ç¨‹éœ€è¦ä¸€äº›å›ºå®šè¡¨æ ¼ç©ºé—´å’Œå †æ ˆç©ºé—´)ï¼Œæ€§èƒ½æ›´å¥½ã€‚ç”¨æˆ·çº§çº¿ç¨‹çš„åˆ‡æ¢éœ€è¦å°‘é‡æœºå™¨æŒ‡ä»¤ï¼Œè€Œå†…æ ¸çº§çº¿ç¨‹éœ€è¦å®Œæ•´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¿®æ”¹å†…å­˜æ˜ åƒï¼Œä½¿é«˜é€Ÿç¼“å­˜å¤±æ•ˆï¼Œè¿™å¯¼è‡´äº†è‹¥å¹²æ•°é‡çº§çš„å»¶è¿Ÿ ç”¨æˆ·çº§çº¿ç¨‹çš„é—®é¢˜æ˜¯å¦‚ä½•å®ç°é˜»å¡ç³»ç»Ÿè°ƒç”¨ï¼Œæ¯”å¦‚çº¿ç¨‹è¯»å–é”®ç›˜ï¼Œåœ¨æ²¡æœ‰æŒ‰ä¸‹ä»»ä½•æŒ‰é”®ä¹‹å‰ä¸èƒ½è®©è¯¥çº¿ç¨‹å®é™…è¿›è¡Œè¯¥ç³»ç»Ÿè°ƒç”¨ï¼Œå› ä¸ºè¿™ä¼šåœæ­¢æ‰€æœ‰çº¿ç¨‹ã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹å¼€å§‹è¿è¡Œï¼Œåˆ™å…¶æ‰€åœ¨è¿›ç¨‹çš„å…¶ä»–çº¿ç¨‹å°±ä¸èƒ½è¿è¡Œï¼Œé™¤éè¿è¡Œçº¿ç¨‹è‡ªåŠ¨æ”¾å¼ƒ CPUã€‚è€Œä½¿ç”¨å†…æ ¸çº§çº¿ç¨‹æ—¶ï¼Œçº¿ç¨‹é˜»å¡åœ¨ I/O ä¸Šæ—¶ï¼Œä¸éœ€è¦å°†æ•´ä¸ªè¿›ç¨‹æŒ‚èµ· å†…æ ¸çº§çº¿ç¨‹çš„çº¿ç¨‹è¡¨(å’Œç”¨æˆ·çº§çº¿ç¨‹çš„çº¿ç¨‹è¡¨ä¸€æ ·ï¼Œè®°å½•å¯„å­˜å™¨ã€çŠ¶æ€å’Œå…¶ä»–ä¿¡æ¯)å­˜åœ¨äºå†…æ ¸ä¸­ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å¸Œæœ›åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æˆ–æ’¤é”€ä¸€ä¸ªå·²æœ‰çº¿ç¨‹æ—¶ï¼Œå°†è¿›è¡Œä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨é€šè¿‡å¯¹çº¿ç¨‹è¡¨çš„æ›´æ–°å®Œæˆåˆ›å»ºæˆ–æ’¤é”€å·¥ä½œ å½“å†…æ ¸çº§çº¿ç¨‹é˜»å¡æ—¶ï¼Œå†…æ ¸å¯ä»¥è¿è¡ŒåŒä¸€è¿›ç¨‹ä¸­çš„å¦ä¸€çº¿ç¨‹ï¼Œæˆ–è€…è¿è¡Œå¦ä¸€ä¸ªè¿›ç¨‹çš„çº¿ç¨‹ã€‚è€Œå¯¹äºç”¨æˆ·çº§çº¿ç¨‹ï¼Œè¿è¡Œæ—¶ç³»ç»Ÿå§‹ç»ˆè¿è¡Œå…¶æ‰€åœ¨è¿›ç¨‹çš„çº¿ç¨‹ï¼Œç›´åˆ°å†…æ ¸å‰¥å¤º CPU(æˆ–æ²¡æœ‰å¯è¿è¡Œçš„çº¿ç¨‹å­˜åœ¨)ä¸ºæ­¢ åœ¨å†…æ ¸ä¸­åˆ›å»ºæˆ–æ’¤é”€çº¿ç¨‹çš„ä»£ä»·è¾ƒå¤§ï¼Œå› æ­¤å†…æ ¸çº§çº¿ç¨‹è¢«æ’¤é”€æ—¶ï¼Œç³»ç»Ÿä¼šå°†å…¶æ ‡è®°ä¸ºä¸å¯è¿è¡Œçš„ï¼Œä½†å…¶å†…æ ¸æ•°æ®ç»“æ„æœªå—å½±å“ï¼Œä¹‹åå¿…é¡»åˆ›å»ºæ–°çº¿ç¨‹æ—¶å°±é‡æ–°å¯åŠ¨ä¸€ä¸ªæ—§çº¿ç¨‹ã€‚ç”¨æˆ·çº§çº¿ç¨‹ä¹Ÿå¯ä»¥è¿™æ ·å›æ”¶ï¼Œä½†å› ä¸ºç®¡ç†ä»£ä»·å¾ˆå°ï¼Œæ‰€ä»¥æ²¡å¿…è¦ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"è¿›ç¨‹é—´é€šä¿¡(Inter Process Communication) å¯¹å…±äº«å†…å­˜è¿›è¡Œè®¿é—®çš„ç¨‹åºç‰‡æ®µç§°ä¸ºä¸´ç•ŒåŒº(critical regionã€critical section)ï¼Œå¦‚æœåŒä¸€æ—¶åˆ»ä¸´ç•ŒåŒºåªæœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œå°±èƒ½é¿å… race condition å•å¤„ç†å™¨ç³»ç»Ÿä¸­å®ç°è¿™ç‚¹çš„ç®€å•åšæ³•æ˜¯ï¼Œåœ¨æ¯ä¸ªè¿›ç¨‹åˆšè¿›å…¥ä¸´ç•ŒåŒºåç«‹å³å±è”½æ‰€æœ‰ä¸­æ–­ï¼Œåœ¨å³å°†ç¦»å¼€æ—¶å†æ‰“å¼€ä¸­æ–­ã€‚å±è”½ä¸­æ–­åï¼Œæ—¶é’Ÿä¸­æ–­ä¹Ÿè¢«å±è”½ã€‚CPU åªæœ‰å‘ç”Ÿæ—¶é’Ÿä¸­æ–­æˆ–å…¶ä»–ä¸­æ–­æ‰ä¼šè¿›è¡Œè¿›ç¨‹åˆ‡æ¢ï¼Œè¿™æ · CPU å°±ä¸ä¼šåˆ‡æ¢åˆ°å…¶ä»–è¿›ç¨‹ ä½†è¿™ä¸ªæ–¹æ¡ˆå¹¶ä¸å¥½ï¼Œå› ä¸ºæŠŠå±è”½ä¸­æ–­çš„æƒåŠ›äº¤ç»™ç”¨æˆ·è¿›ç¨‹æ˜¯ä¸æ˜æ™ºçš„ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹å±è”½ä¸­æ–­åä¸æ‰“å¼€ï¼Œå°±å¯èƒ½å¯¼è‡´æ•´ä¸ªç³»ç»Ÿç»ˆæ­¢ã€‚æ­¤å¤–å¦‚æœç³»ç»Ÿæ˜¯å¤šå¤„ç†å™¨ï¼Œåˆ™å±è”½ä¸­æ–­åªå¯¹æ‰§è¡Œäº† disable æŒ‡ä»¤çš„ CPU æœ‰æ•ˆï¼Œå…¶ä»– CPU ä»å°†è¿è¡Œ å¯¹äºå†…æ ¸æ¥è¯´ï¼Œæ›´æ–°å˜é‡æˆ–åˆ—è¡¨çš„å‡ æ¡æŒ‡ä»¤æœŸé—´å±è”½ä¸­æ–­å¾ˆæ–¹ä¾¿ï¼Œå› æ­¤å±è”½ä¸­æ–­å¯¹æ“ä½œç³»ç»Ÿæœ¬èº«æ˜¯ä¸€é¡¹å¾ˆæœ‰ç”¨çš„æŠ€æœ¯ï¼Œä½†å¯¹ç”¨æˆ·è¿›ç¨‹åˆ™ä¸æ˜¯ä¸€ç§åˆé€‚çš„äº’æ–¥æœºåˆ¶ ç¬¬äºŒç§æ–¹å¼æ˜¯ä¸€ç§è½¯ä»¶æ–¹æ¡ˆï¼Œå‡è®¾æœ‰ä¸€ä¸ªå…±äº«é”å˜é‡ï¼Œå…¶åˆå§‹å€¼ä¸º 0ï¼Œå½“è¿›ç¨‹è¦è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œé¦–å…ˆæµ‹è¯•é”ï¼Œå¦‚æœå€¼ä¸º 0 åˆ™å°†é”è®¾ä¸º1å¹¶è¿›å…¥ä¸´ç•ŒåŒºï¼Œå¦‚æœé”çš„å€¼å·²ç»ä¸º 1ï¼Œåˆ™è¿›ç¨‹ç­‰å¾…å…¶å€¼ä¸º 0 è¿™ç§æ–¹å¼çš„é—®é¢˜åœ¨äºï¼Œå¦‚æœåœ¨ä¸€ä¸ªè¿›ç¨‹æ£€æŸ¥åˆ°é”ä¸º 0ï¼Œå¹¶è¦å°†é”è®¾ä¸º 1 ä¹‹å‰ï¼Œæ°å¥½å¦ä¸€ä¸ªçº¿ç¨‹è¢«è°ƒåº¦è¿è¡Œå°†é”è®¾ä¸º 1ï¼Œè€Œç¬¬ä¸€ä¸ªè¿›ç¨‹æ¢å¤è¿è¡Œæ—¶ä¹Ÿå°†æŠŠé”è®¾ä¸º 1 å¹¶è¿›å…¥ä¸´ç•ŒåŒºï¼Œæ­¤æ—¶ä¸´ç•ŒåŒºå°±æœ‰äº†ä¸¤ä¸ªè¿›ç¨‹ ç¬¬ä¸‰ç§æ–¹å¼æ˜¯å¿™ç­‰å¾…(busy waiting)ï¼Œç”¨ä¸€ä¸ªå¾ªç¯ä¸æ–­æµ‹è¯•å˜é‡å€¼ï¼Œç›´åˆ°å˜é‡å€¼æ”¹å˜æ‰è¿›å…¥ä¸´ç•ŒåŒºï¼Œç”¨äºå¿™ç­‰å¾…çš„é”ç§°ä¸ºè‡ªæ—‹é”(spin lock)ã€‚è¿™ç§æ–¹å¼çš„é—®é¢˜æ˜¯ï¼Œåœ¨å¾ªç¯ä¸­æµªè´¹äº†å¤§é‡ CPU æ—¶é—´ï¼Œåº”è¯¥é¿å…ï¼Œé™¤éç­‰å¾…æ—¶é—´éå¸¸çŸ­æ‰æœ‰ä½¿ç”¨çš„ç†ç”± // è¿›ç¨‹ A while (true) { while (x) { } critical_region(); x = true; // å…è®¸è¿›ç¨‹ B è¿›å…¥ä¸´ç•ŒåŒº noncritical_region(); } // è¿›ç¨‹ B while (true) { while (!x) { } critical_region(); x = false; // å…è®¸è¿›ç¨‹ A è¿›å…¥ä¸´ç•ŒåŒº noncritical_region(); } ç¬¬å››ç§æ–¹å¼æ˜¯ 1981 å¹´ç”± G. L. Peterson æå‡ºçš„ Peterson ç®—æ³• constexpr int N = 2; // è¿›ç¨‹æ•°é‡ä¸º2 int turn = 0; // è½®åˆ°çš„è¿›ç¨‹ vector\u003cbool\u003e interested(N); void enter_region(int process) { int other = 1 - process; // å¦ä¸€è¿›ç¨‹(è¿›ç¨‹å·ä¸º 0 æˆ– 1) interested[process] = true; turn = process; // turn åªæœ‰ä¸€ä¸ªï¼Œå³ä½¿ä¸¤ä¸ªè¿›ç¨‹è°ƒç”¨ä¹Ÿåªæœ‰åä¸€ä¸ªèµ‹å€¼ä¼šä¿ç•™ while (turn == process \u0026\u0026 interested[other]) { } } void leave_region(int process) { // è°ƒç”¨ä¸Šè¿°å‡½æ•°å®Œæˆåè°ƒç”¨æ­¤å‡½æ•° interested[process] = false; } // è‹¥è¿›ç¨‹ A è°ƒç”¨ enter_region åˆ™å¾ˆå¿«è¿”å›ï¼Œ // æ­¤æ—¶è¿›ç¨‹ B è°ƒç”¨å°†åœ¨ while å¾ªç¯æŒ‚èµ·ï¼Œ // ç›´åˆ°è¿›ç¨‹ A è°ƒç”¨ leave_region // è‹¥è¿›ç¨‹ AB åŒæ—¶è°ƒç”¨ enter_regionï¼Œ // turn ä¸ºåèµ‹å€¼è€…ï¼Œ // åˆ™å…ˆèµ‹å€¼è€…é€€å‡ºå¾ªç¯å¹¶è°ƒç”¨ leave_regionï¼Œåèµ‹å€¼è€…å†é€€å‡ºå¾ªç¯ ç¬¬äº”ç§æ–¹å¼æ˜¯ä¸€ç§ç¡¬ä»¶æ–¹å¼ï¼Œéœ€è¦å€ŸåŠ© TSL æŒ‡ä»¤ï¼Œå³æµ‹è¯•å¹¶åŠ é”(test and set lock)ï¼Œè¯¥æŒ‡ä»¤æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œæ‰§è¡Œ TSL æŒ‡ä»¤çš„ CPU å°†é”ä½å†…å­˜æ€»çº¿ä»¥ç¦æ­¢å…¶ä»– CPU åœ¨æŒ‡ä»¤ç»“æŸå‰è®¿é—®è¯¥å†…å­˜ TSL RX, LOCK // å°†å†…å­˜å­— LOCK è¯»åˆ°å¯„å­˜å™¨ RX ä¸­ï¼Œç„¶ååœ¨è¯¥å†…å­˜åœ°å€å†™ä¸€ä¸ªéé›¶å€¼ï¼Œè¯»å†™æ˜¯åŸå­æ“ä½œ ä¸ºäº†ä½¿ç”¨ TSL æŒ‡ä»¤å®ç°äº’æ–¥ï¼Œç”¨ä¸€ä¸ªå…±äº«å˜é‡ LOCK æ¥åè°ƒå¯¹å†…å­˜çš„è®¿é—®ï¼Œå…¶å€¼ä¸º 0 æ—¶ä»»ä½•è¿›ç¨‹éƒ½èƒ½ç”¨ TSL æŒ‡ä»¤å°†å€¼è®¾ä¸º 1 å¹¶è¯»å†™å…±äº«å†…å­˜ï¼Œæ“ä½œç»“æŸæ—¶å†ç”¨ move æŒ‡ä»¤å°†å€¼é‡ç½®ä¸º 0 enter_region: TSL REGISTER, LOCK ;å¤åˆ¶é”åˆ°å¯„å­˜å™¨å¹¶è®¾ç½®å€¼ä¸º 1 CMP REGISTER, #0 ;å€¼æ˜¯å¦ä¸º 0 JNE enter_region ;ä¸æ˜¯ 0 åˆ™å¾ªç¯ RET ;è¿”å›ï¼Œè¿›å…¥ä¸´ç•ŒåŒº leave_region: MOVE LOCK, #0 RET å¯ä»¥ç”¨ XCHG æŒ‡ä»¤æ›¿ä»£ TSL æŒ‡ä»¤ï¼Œå®ƒåŸå­äº¤æ¢ä¸¤ä¸ªä½ç½®çš„å†…å®¹ enter_region: MOVE REGISTER, #1 ;åœ¨å¯„å­˜å™¨æ”¾ä¸€ä¸ª 1 XCHG REGISTER, LOCK ;åŸå­äº¤æ¢å¯„å­˜å™¨å’Œé”å˜é‡çš„å†…å®¹ CMP REGISTER, #0 ;å€¼æ˜¯å¦ä¸º 0 JNE enter_region ;ä¸æ˜¯ 0 åˆ™å¾ªç¯ RET ;è¿”å›ï¼Œè¿›å…¥ä¸´ç•ŒåŒº leave_region: MOVE LOCK, #0 RET Peterson ç®—æ³•å’Œ TSL æˆ– XCHG è§£æ³•åŒæ ·éƒ½æœ‰å¿™ç­‰å¾…çš„é—®é¢˜ï¼Œå®ƒä»¬çš„æœ¬è´¨éƒ½æ˜¯åœ¨è¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºæ—¶æ£€æŸ¥æ˜¯å¦å…è®¸è¿›å…¥ï¼Œä¸å…è®¸åˆ™åŸåœ°ç­‰å¾…ç›´åˆ°å…è®¸ä¸ºæ­¢ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ ä¸¤ä¸ªè¿›ç¨‹å…±äº«ä¸€ä¸ªå›ºå®šå¤§å°çš„ç¼“å†²åŒºï¼Œç”Ÿäº§è€…è¿›ç¨‹å°†æ¶ˆæ¯æ”¾å…¥ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…è¿›ç¨‹ä»ç¼“å†²åŒºå–å‡ºæ¶ˆæ¯ constexpr int N = 100; // ç¼“å†²åŒºçš„æ§½æ•° int cnt = 0; // ç¼“å†²åŒºæ•°æ®æ•° void producer() { while (true) { int item = produce_item(); // ç”Ÿæˆæ–°æ•°æ® if (cnt == N) { sleep(); } insert_item(item); // å°†æ¶ˆæ¯æ”¾å…¥ç¼“å†²åŒº ++cnt; // 1 if (cnt == 1) { wakeup(consumer); // 2 } } } void consumer() { while (true) { if (!cnt) { sleep(); // 3 } int item = remove_item(); // ä»ç¼“å†²åŒºå–ä¸€ä¸ªæ•°æ® --cnt; if (cnt == N - 1) { wakeup(producer); } consume_item(item); // æ‰“å°æ•°æ® } } // é—®é¢˜åœ¨äº cnt çš„è®¿é—®å­˜åœ¨ race conditionï¼Œ // å¦‚æœæ¶ˆè´¹è€…æ‰§è¡Œåˆ° 3 å¤„ï¼Œcnt ä¸º 0ï¼Œåœ¨å³å°† sleep ä¹‹å‰ï¼Œ // ç”Ÿäº§è€…åœ¨æ­¤ä¹‹åæ‰æ‰§è¡Œåˆ° 1 å¤„ï¼Œæ­¤æ—¶ cnt ä¸º 1ï¼Œæ‰§è¡Œåˆ° 2 å¤„ï¼Œè°ƒç”¨ wakeupï¼Œ // ä½†æ­¤æ—¶æ¶ˆè´¹è€…è¿˜æœª sleepï¼Œå› æ­¤ wakeup çš„ä¿¡å·ä¸¢å¤±ï¼Œæ²¡æœ‰å®é™…ä½œç”¨ï¼Œ // æ¥ç€æ¶ˆè´¹è€… sleepï¼Œç”Ÿäº§è€…å¼€å§‹ä¸‹ä¸€è½®å¾ªç¯ï¼Œ // ç”Ÿäº§è€…ä¸‹ä¸€è½®å¾ªç¯åˆ° 1 å¤„ï¼Œcnt ä¸º 2ï¼Œåˆ° 2 å¤„ï¼Œä¸å†è°ƒç”¨ wakeupï¼Œæ¶ˆè´¹è€…ä¿æŒ sleepï¼Œ // ç”Ÿäº§è€…ç»§ç»­ä¹‹åçš„å¾ªç¯ï¼Œå¹¶ä¸”æ¯ä¸€è½®éƒ½ä¸ä¼šå”¤é†’æ¶ˆè´¹è€…ï¼Œ // æœ€ç»ˆç”Ÿäº§è€…æ‰§è¡Œåˆ° cnt ä¸º N æ—¶ sleepï¼Œä¸¤ä¸ªè¿›ç¨‹éƒ½å°†æ°¸ä¹… sleep ","date":"2023-11-19","objectID":"/posts/processesandthreads/:4:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"ä¿¡å·é‡(semaphore) ä¿¡å·é‡æ˜¯ç”± E. W. Dijkstra äº 1965 å¹´æå‡ºçš„ä¸€ç§æ–¹æ³•ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªæ•´å‹å˜é‡ä½œä¸ºä¿¡å·é‡ï¼Œå€¼ä¸º 0 è¡¨ç¤ºæ²¡æœ‰ä¿å­˜ä¸‹æ¥çš„å”¤é†’æ“ä½œï¼Œå€¼ä¸ºæ­£æ•°è¡¨ç¤ºå”¤é†’æ“ä½œçš„æ¬¡æ•° ä¿¡å·é‡æœ‰ down å’Œ up ä¸¤ç§æ“ä½œï¼ŒDijkstra åœ¨è®ºæ–‡ä¸­ç§°å…¶ä¸º P å’Œ V æ“ä½œ(è·å…°è¯­ä¸­çš„ Proberen æ„ä¸ºå°è¯•ï¼ŒVerhogen æ„ä¸ºå¢åŠ æˆ–å‡é«˜) down æ“ä½œæ£€æŸ¥å€¼æ˜¯å¦å¤§äº 0ï¼Œè‹¥å¤§äº 0 åˆ™å‡ 1 å¹¶ç»§ç»­ï¼Œè‹¥ä¸º 0 åˆ™è¿›ç¨‹ç¡çœ ï¼Œå¹¶ä¸”æ­¤æ—¶ down æ“ä½œæœªç»“æŸ up æ“ä½œå¯¹å€¼åŠ  1ã€‚å¦‚æœæœ‰è¿›ç¨‹åœ¨ä¿¡å·é‡ä¸Šç¡çœ ï¼Œæ— æ³•å®Œæˆä¸€ä¸ªå…ˆå‰çš„ down æ“ä½œï¼Œåˆ™ç”±ç³»ç»Ÿé€‰æ‹©å…¶ä¸­ä¸€ä¸ªä»¥å…è®¸å®Œæˆå…¶ down æ“ä½œã€‚äºæ˜¯ï¼Œå¯¹ä¸€ä¸ªæœ‰ç¡çœ è¿›ç¨‹çš„ä¿¡å·é‡æ‰§è¡Œä¸€æ¬¡ up æ“ä½œï¼Œä¿¡å·é‡å€¼ä»ä¸º 0ï¼Œä½†ç¡çœ è¿›ç¨‹å°‘äº†ä¸€ä¸ª down æ“ä½œå’Œ up æ“ä½œä¸­çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­çš„ï¼Œä¸€èˆ¬ä½œä¸ºç³»ç»Ÿè°ƒç”¨å®ç°ã€‚æ“ä½œç³»ç»Ÿåªè¦åœ¨æ‰§è¡Œæµ‹è¯•ä¿¡å·é‡ã€æ›´æ–°ä¿¡å·é‡ã€ä½¿è¿›ç¨‹ç¡çœ ç­‰æ“ä½œæ—¶æš‚æ—¶å±è”½å…¨éƒ¨ä¸­æ–­ï¼Œè¿™äº›åŠ¨ä½œåªéœ€è¦å‡ æ¡æŒ‡ä»¤ï¼Œæ‰€ä»¥å±è”½ä¸­æ–­ä¸ä¼šå¸¦æ¥ä»€ä¹ˆå‰¯ä½œç”¨ã€‚å¦‚æœä½¿ç”¨å¤šä¸ª CPUï¼Œåˆ™æ¯ä¸ªä¿¡å·é‡åº”ç”±ä¸€ä¸ªä¸€ä¸ªé”ä¿æŠ¤ï¼Œä½¿ç”¨ TSL æˆ– XCHG æŒ‡ä»¤æ¥ç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ª CPU å¯¹ä¿¡å·é‡è¿›è¡Œæ“ä½œ æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨ TSL æˆ– XCHG æŒ‡ä»¤æ¥é˜²æ­¢å¤š CPU åŒæ—¶è®¿é—®ä¸€ä¸ªä¿¡å·é‡ï¼Œä¸ç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…ç”¨å¿™ç­‰å¾…æ¥ç­‰å¾…å¯¹æ–¹è…¾å‡ºæˆ–å¡«å……ç¼“å†²åŒºæ˜¯å®Œå…¨ä¸åŒçš„ã€‚ä¿¡å·é‡æ“ä½œåªéœ€è¦å‡ æ¯«ç§’ï¼Œè€Œç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…åˆ™å¯èƒ½éœ€è¦ä»»æ„é•¿æ—¶é—´ ä½¿ç”¨ä¸‰ä¸ªä¿¡å·é‡è§£å†³ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ï¼šfull è®°å½•å·²å……æ»¡çš„ç¼“å†²æ§½æ•°ï¼Œåˆå€¼ä¸º 0ï¼›empty è®°å½•ç©ºçš„ç¼“å†²æ§½æ•°ï¼Œåˆå€¼ä¸ºç¼“å†²åŒºä¸­æ§½çš„æ•°ç›®ï¼›mutex ç¡®ä¿ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸ä¼šåŒæ—¶è®¿é—®ç¼“å†²åŒºï¼Œåˆå€¼ä¸º 1 ä¾›å¤šä¸ªè¿›ç¨‹ä½¿ç”¨çš„ä¿¡å·é‡åˆå€¼ä¸º 1ï¼Œä¿è¯åŒæ—¶åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºï¼Œè¿™ç§ä¿¡å·é‡ç§°ä¸ºäºŒå…ƒä¿¡å·é‡(binary semaphore)ã€‚å¦‚æœæ¯ä¸ªè¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºå‰æ‰§è¡Œä¸€ä¸ª down æ“ä½œï¼Œå¹¶åœ¨åˆšé€€å‡ºæ—¶æ‰§è¡Œä¸€ä¸ª up æ“ä½œï¼Œå°±èƒ½å®ç°äº’æ–¥ constexpr int N = 100; // ç¼“å†²åŒºçš„æ§½æ•° using semaphore = int; semaphore mutex = 1; semaphore empty = N; // ç¼“å†²åŒºç©ºæ§½æ•° semaphore full = 0; // ç¼“å†²åŒºæ»¡æ§½æ•° void producer() { while (true) { int item = produce_item(); down(\u0026empty); down(\u0026mutex); insert_item(item); up(\u0026mutex); up(\u0026full); } } void consumer() { while (true) { down(\u0026full); down(\u0026mutex); int item = remove_item(); up(\u0026mutex); up(\u0026empty); consume_item(item); } } ä¿¡å·é‡çš„å¦ä¸€ä¸ªä½œç”¨æ˜¯å®ç°åŒæ­¥(synchronization)ï¼Œè¿™é‡Œ full å’Œ empty ä¿è¯ç¼“å†²åŒºæ»¡æ—¶ç”Ÿäº§è€…åœæ­¢è¿è¡Œï¼Œç¼“å†²åŒºç©ºæ—¶æ¶ˆè´¹è€…åœæ­¢è¿è¡Œ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:5:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"äº’æ–¥é‡(mutex) å¦‚æœä¸éœ€è¦ä¿¡å·é‡çš„è®¡æ•°åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨å…¶ç§°ä¸ºäº’æ–¥é‡çš„ç®€åŒ–ç‰ˆæœ¬ã€‚äº’æ–¥é‡ä»…é€‚ç”¨äºç®¡ç†å…±äº«èµ„æºæˆ–ä¸€å°æ®µä»£ç ã€‚äº’æ–¥é‡å®ç°ç®€å•ä¸”æœ‰æ•ˆï¼Œåœ¨å®ç°ç”¨æˆ·ç©ºé—´çº¿ç¨‹åŒ…æ—¶ååˆ†æœ‰ç”¨ äº’æ–¥é‡åªæœ‰åŠ é”å’Œè§£é”ä¸¤ç§çŠ¶æ€ï¼Œåªéœ€è¦ä¸€ä¸ªäºŒè¿›åˆ¶ä½è¡¨ç¤ºï¼Œä¸è¿‡å®é™…ä¸Šä¸€èˆ¬ç”¨æ•´å‹é‡ï¼Œ0 è¡¨ç¤ºè§£é”ï¼Œå…¶ä»–å€¼è¡¨ç¤ºåŠ é” çº¿ç¨‹éœ€è¦è®¿é—®ä¸´ç•ŒåŒºæ—¶è°ƒç”¨ mutex_lockï¼Œå¦‚æœäº’æ–¥é‡æ˜¯è§£é”çš„åˆ™ä¸´ç•ŒåŒºå¯ç”¨ï¼Œè°ƒç”¨æˆåŠŸï¼Œçº¿ç¨‹å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºï¼Œå¦åˆ™çº¿ç¨‹è¢«é˜»å¡ï¼Œç›´åˆ°ä¸´ç•ŒåŒºä¸­çš„çº¿ç¨‹å®Œæˆå¹¶è°ƒç”¨ mutex_unlockã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹é˜»å¡åœ¨è¯¥äº’æ–¥é‡ä¸Šï¼Œåˆ™éšæœºé€‰æ‹©ä¸€ä¸ªçº¿ç¨‹å¹¶å…è®¸å®ƒè·å¾—é” ç”¨ TSL æˆ– XCHG æŒ‡ä»¤å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ç”¨æˆ·ç©ºé—´å®ç°äº’æ–¥é‡ mutex_lock: TSL REGISTER, MUTEX ;å°†äº’æ–¥é‡å¤åˆ¶åˆ°å¯„å­˜å™¨ï¼Œå¹¶å°†äº’æ–¥é‡ç½®ä¸º 1 CMP REGISTER, #0 JZE ok ;å¦‚æœäº’æ–¥é‡ä¸º 0ï¼Œå®ƒè¢«è§£é”ï¼Œæ‰€ä»¥è¿”å› CALL thread_yield ;äº’æ–¥é‡å¿™ï¼Œè°ƒåº¦å¦ä¸€ä¸ªçº¿ç¨‹ JMP mutex_lock ;ç¨åå†è¯• ok: RET mutex_unlock: MOVE MUTEX, #0 ;å°†äº’æ–¥é‡ç½®0 RET thread_yield åªæ˜¯è°ƒç”¨ç”¨æˆ·ç©ºé—´çº¿ç¨‹è°ƒåº¦ç¨‹åºï¼Œè¿è¡Œååˆ†å¿«æ·ï¼Œè¿™æ · mutex_lock å’Œ mutex_unlock éƒ½ä¸éœ€è¦ä»»ä½•å†…æ ¸è°ƒç”¨ã€‚ç”¨æˆ·çº§çº¿ç¨‹é€šè¿‡äº’æ–¥é‡çš„è¿™ä¸ªè¿‡ç¨‹å³å¯å®ç°åŒæ­¥ï¼Œè€ŒåŒæ­¥è¿‡ç¨‹ä»…éœ€è¦å°‘é‡æŒ‡ä»¤ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:6:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"ç®¡ç¨‹(monitor) å¦‚æœæŠŠç”Ÿäº§è€…ä»£ç ä¸­çš„ä¸¤ä¸ª down æ“ä½œäº¤æ¢é¡ºåºï¼Œä½¿å¾— mutex åœ¨ empty ä¹‹å‰å‡ 1ï¼Œå°±ä¼šå¯¼è‡´æ­»é”ï¼Œå› æ­¤ä½¿ç”¨ä¿¡å·é‡è¦ååˆ†å°å¿ƒã€‚ä¸ºäº†æ›´æ˜“äºç¼–å†™æ­£ç¡®çš„ç¨‹åºï¼ŒBrinch Hansen å’Œ Hoare æå‡ºäº†ä¸€ç§ç§°ä¸ºç®¡ç¨‹çš„é«˜çº§åŒæ­¥åŸè¯­ ä¸€ä¸ªç®¡ç¨‹æ˜¯ç”±è¿‡ç¨‹ã€å˜é‡ã€æ•°æ®ç»“æ„ç­‰ç»„æˆçš„ä¸€ä¸ªé›†åˆï¼Œå®ƒä»¬ç»„æˆä¸€ä¸ªç‰¹æ®Šçš„æ¨¡å—æˆ–è½¯ä»¶åŒ…ï¼Œè¿›ç¨‹å¯ä»¥åœ¨ä»»ä½•éœ€è¦çš„æ—¶å€™è°ƒç”¨ç®¡ç¨‹ä¸­çš„è¿‡ç¨‹ï¼Œä½†ä¸èƒ½åœ¨ç®¡ç¨‹ä¹‹å¤–å£°æ˜çš„è¿‡ç¨‹ä¸­ç›´æ¥è®¿é—®ç®¡ç¨‹å†…çš„æ•°æ®ç»“æ„ ä»»ä¸€æ—¶åˆ»ç®¡ç¨‹ä¸­åªèƒ½æœ‰ä¸€ä¸ªæ´»è·ƒè¿›ç¨‹ï¼Œè¿™ä¸€ç‰¹æ€§ä½¿å¾—ç®¡ç¨‹èƒ½æœ‰æ•ˆåœ°å®Œæˆäº’æ–¥ã€‚ç®¡ç¨‹æ˜¯ç¼–ç¨‹è¯­è¨€çš„ç»„æˆéƒ¨åˆ†ï¼Œç¼–è¯‘å™¨çŸ¥é“å…¶ç‰¹æ®Šæ€§ï¼Œè¿›å…¥ç®¡ç¨‹æ—¶çš„äº’æ–¥ç”±ç¼–è¯‘å™¨è´Ÿè´£ï¼Œé€šå¸¸åšæ³•æ˜¯ä½¿ç”¨äº’æ–¥é‡æˆ–äºŒå…ƒä¿¡å·é‡ã€‚è¿™æ ·å°±ä¸éœ€è¦ç¨‹åºå‘˜å®‰æ’äº’æ–¥ï¼Œå‡ºé”™çš„å¯èƒ½æ€§å°±å°å¾ˆå¤š ç®¡ç¨‹æä¾›äº†äº’æ–¥çš„ç®€ä¾¿é€”å¾„ï¼Œä½†æ­¤å¤–è¿˜éœ€è¦ä¸€ç§æ–¹æ³•ä½¿å¾—è¿›ç¨‹åœ¨æ— æ³•ç»§ç»­è¿è¡Œæ—¶è¢«é˜»å¡ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯å¼•å…¥æ¡ä»¶å˜é‡(condition variable) å½“ä¸€ä¸ªç®¡ç¨‹è¿‡ç¨‹å‘ç°å®ƒæ— æ³•ç»§ç»­è¿è¡Œæ—¶(å¦‚ç”Ÿäº§è€…å‘ç°ç¼“å†²åŒºæ»¡)ï¼Œåˆ™ä¼šåœ¨æŸä¸ªæ¡ä»¶å˜é‡(å¦‚ full)ä¸Šæ‰§è¡Œ wait æ“ä½œï¼Œè¯¥æ“ä½œå°†é˜»å¡å½“å‰è¿›ç¨‹ï¼Œå¹¶å°†å¦ä¸€ä¸ªåœ¨ç®¡ç¨‹å¤–çš„è¿›ç¨‹è°ƒå…¥ç®¡ç¨‹ã€‚å¦ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é€šè¿‡å¯¹åŒä¸€æ¡ä»¶å˜é‡æ‰§è¡Œ signal æ“ä½œå”¤é†’é˜»å¡è¿›ç¨‹ ä¸ºäº†é¿å…ç®¡ç¨‹ä¸­æœ‰ä¸¤ä¸ªæ´»è·ƒè¿›ç¨‹ï¼Œæ‰§è¡Œ signal æ“ä½œä¹‹åæœ‰ä¸¤ç§è§„åˆ™ã€‚Hoare å»ºè®®è®©æ–°å”¤é†’çš„è¿›ç¨‹è¿è¡Œï¼ŒæŒ‚èµ·å¦ä¸€ä¸ªè¿›ç¨‹ã€‚Brinch Hansen å»ºè®®æ‰§è¡Œ signal çš„è¿›ç¨‹å¿…é¡»ç«‹å³é€€å‡ºç®¡ç¨‹ï¼Œå³ signal è¯­å¥åªèƒ½ä½œä¸ºä¸€ä¸ªç®¡ç¨‹è¿‡ç¨‹çš„æœ€åä¸€æ¡è¯­å¥ã€‚åè€…åœ¨æ¦‚å¿µä¸Šæ›´ç®€å•ï¼Œå¹¶ä¸”æ›´å®¹æ˜“å®ç°ã€‚ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯ï¼Œè®©å‘ä¿¡å·è€…ç»§ç»­è¿è¡Œï¼Œç›´åˆ°å…¶é€€å‡ºç®¡ç¨‹ï¼Œæ‰å…è®¸ç­‰å¾…çš„è¿›ç¨‹å¼€å§‹è¿è¡Œ å¦‚æœä¸€ä¸ªæ¡ä»¶å˜é‡ä¸Šæœ‰è‹¥å¹²è¿›ç¨‹æ­£åœ¨ç­‰å¾…ï¼Œåˆ™å¯¹å…¶æ‰§è¡Œ signal æ“ä½œä¹‹åï¼Œç³»ç»Ÿè°ƒåº¦ç¨‹åºåªèƒ½é€‰æ‹©å…¶ä¸­ä¸€ä¸ªæ¢å¤è¿è¡Œ å¦‚æœä¸€ä¸ªæ¡ä»¶å˜é‡æ²¡æœ‰ç­‰å¾…è¿›ç¨‹ï¼Œåˆ™å¯¹å…¶æ‰§è¡Œ signal ä¼šä¸¢å¤±ä¿¡å·ï¼Œå› æ­¤ wait æ“ä½œå¿…é¡»åœ¨ signal ä¹‹å‰ã€‚è¿™ä¸ä¹‹å‰æåˆ°çš„ sleep å’Œ wakeup çš„å…³é”®åŒºåˆ«æ˜¯ï¼Œç®¡ç¨‹çš„è‡ªåŠ¨äº’æ–¥ä¿è¯äº†åœ¨ wait å®Œæˆä¹‹å‰ä¸ä¼šå…ˆ signal ","date":"2023-11-19","objectID":"/posts/processesandthreads/:7:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"æ¶ˆæ¯ä¼ é€’(message passing) ç®¡ç¨‹å’Œä¿¡å·é‡é€šè¿‡å…±äº«å†…å­˜è§£å†³ CPU äº’æ–¥é—®é¢˜ï¼Œä½†æ²¡æœ‰æä¾›ä¸åŒæœºå™¨é—´(æ¯”å¦‚å±€åŸŸç½‘ä¸­çš„æœºå™¨)çš„ä¿¡æ¯äº¤æ¢æ–¹æ³• æ¶ˆæ¯ä¼ é€’ä½¿ç”¨ send å’Œ receive åŸè¯­æ¥å®ç°è¿›ç¨‹é—´é€šä¿¡ï¼Œå®ƒä»¬åƒä¿¡å·é‡è€Œä¸åƒç®¡ç¨‹ï¼Œæ˜¯ç³»ç»Ÿè°ƒç”¨è€Œéè¯­è¨€æˆåˆ† send(destination, \u0026message); receive(source, \u0026message); send å‘ä¸€ä¸ªç»™å®šç›®æ ‡å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œreceive ä»ä¸€ä¸ªç»™å®šæº(æˆ–è€…ä»»æ„æº)æ¥æ”¶ä¸€æ¡æ¶ˆæ¯ï¼Œå¦‚æœæ²¡æœ‰æ¶ˆæ¯å¯ç”¨åˆ™æ¥æ”¶è€…å¯èƒ½è¢«é˜»å¡ç›´è‡³æœ‰ä¸€æ¡æ¶ˆæ¯åˆ°è¾¾ï¼Œæˆ–è€…å¸¦ç€ä¸€ä¸ªé”™è¯¯ç ç«‹å³è¿”å› æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿé¢ä¸´è®¸å¤šè®¾è®¡éš¾ç‚¹ï¼šæ¯”å¦‚æ¶ˆæ¯å¯èƒ½è¢«ç½‘ç»œä¸¢å¤±ï¼Œéœ€è¦ä¸‰æ¬¡æ¡æ‰‹æ¥ç¡®è®¤ä¿¡æ¯åˆ°è¾¾æƒ…å†µï¼›æ¯”å¦‚å‘é€æ–¹æœªæ”¶åˆ°ç¡®è®¤ï¼Œå› æ­¤é‡å‘æ¶ˆæ¯å¯¼è‡´æ¥æ”¶æ–¹æ”¶åˆ°ä¸¤æ¡ç›¸åŒæ¶ˆæ¯ï¼Œæ¥æ”¶æ–¹éœ€è¦åŒºåˆ†æ–°è€æ¶ˆæ¯ï¼›æ¯”å¦‚èº«ä»½è®¤è¯(authentication)é—®é¢˜ï¼Œå®¢æˆ·ç«¯å¦‚ä½•ç¡®è®¤é€šä¿¡çš„æ˜¯ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨è¿˜æ˜¯å†’å……è€… æ¶ˆæ¯ä¼ é€’æ–¹å¼å¯ä»¥æœ‰è®¸å¤šå˜ä½“ï¼Œä¸€ç§å¯¹æ¶ˆæ¯è¿›è¡Œç¼–å€çš„æ–¹å¼æ˜¯ï¼Œä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€ä¸ªå”¯ä¸€åœ°å€ï¼Œè®©æ¶ˆæ¯æŒ‰è¿›ç¨‹çš„åœ°å€ç¼–å€ã€‚å¦ä¸€ç§æ–¹å¼æ˜¯å¼•å…¥ä¸€ç§ç§°ä¸ºä¿¡ç®±(mailbox)çš„æ•°æ®ç»“æ„ï¼Œç”¨æ¥å¯¹ä¸€å®šæ•°é‡çš„æ¶ˆæ¯è¿›è¡Œç¼“å†²ã€‚ä½¿ç”¨ä¿¡ç®±æ—¶ï¼Œsend å’Œ receive è°ƒç”¨çš„åœ°å€å‚æ•°å°±æ˜¯ä¿¡ç®±è€Œéè¿›ç¨‹çš„åœ°å€ constexpr int N = 100; void producer() { message m; // æ¶ˆæ¯ç¼“å†²åŒº while (true) { int item = produce_item(); receive(consumer, \u0026m); // ç­‰å¾…æ¶ˆè´¹è€…å‘é€ç©ºç¼“å†²åŒº build_message(\u0026m, item); // å»ºç«‹ä¸€ä¸ªå¾…å‘é€çš„æ¶ˆæ¯ send(consumer, \u0026m); // å‘é€æ•°æ®é¡¹ç»™æ¶ˆè´¹è€… } } void consumer() { message m; for (int i = 0; i \u003c N; ++i) { send(producer, \u0026m); // å‘é€ N ä¸ªç©ºç¼“å†²åŒº } while (true) { receive(producer, \u0026m); // æ¥æ”¶åŒ…å«æ•°æ®é¡¹çš„æ¶ˆæ¯ int item = extract_item(\u0026m); // å°†æ•°æ®é¡¹ä»æ¶ˆæ¯ä¸­æå–å‡ºæ¥ send(producer, \u0026m); // å°†ç©ºç¼“å†²åŒºå‘é€å›ç”Ÿäº§è€… consume_item(item); } } ä½¿ç”¨ä¿¡ç®±çš„å¦ä¸€ç§æç«¯æ–¹æ³•æ˜¯å½»åº•å–æ¶ˆç¼“å†²ã€‚é‡‡å–è¿™ç§æ–¹æ³•æ—¶ï¼Œå¦‚æœ send åœ¨ receive ä¹‹å‰æ‰§è¡Œåˆ™å‘é€è¿›ç¨‹è¢«é˜»å¡ï¼Œç›´åˆ° receive å‘ç”Ÿï¼Œåä¹‹äº¦ç„¶ã€‚æ‰§è¡Œ receive æ—¶ï¼Œæ¶ˆæ¯å¯ä»¥ç›´æ¥ä»å‘é€è€…å¤åˆ¶åˆ°æ¥æ”¶è€…ï¼Œä¸ç”¨ä»»ä½•ä¸­é—´ç¼“å†²ã€‚è¿™ç§æ–¹æ¡ˆå¸¸è¢«ç§°ä¸ºä¼šå’Œ(rendezvous)ï¼Œå®ç°èµ·æ¥æ›´å®¹æ˜“ï¼Œä½†é™ä½äº†çµæ´»æ€§ï¼Œå› ä¸ºå‘é€è€…å’Œæ¥æ”¶è€…ä¸€å®šè¦ä»¥æ­¥æ­¥ç´§æ¥çš„æ–¹å¼è¿è¡Œ é€šå¸¸åœ¨å¹¶è¡Œç¨‹åºè®¾è®¡ç³»ç»Ÿä¸­ä½¿ç”¨æ¶ˆæ¯ä¼ é€’ï¼Œä¸€ä¸ªè‘—åçš„æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿæ˜¯æ¶ˆæ¯ä¼ é€’æ¥å£(Message-Passing Interfaceï¼ŒMPI)ï¼Œå®ƒå¹¿æ³›åº”ç”¨äºç§‘å­¦è®¡ç®— ","date":"2023-11-19","objectID":"/posts/processesandthreads/:8:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"å±éšœ(barrier) å±éšœæ˜¯ä¸€ç§ç”¨äºè¿›ç¨‹ç»„çš„åŒæ­¥æœºåˆ¶ï¼Œåªæœ‰æ‰€æœ‰è¿›ç¨‹å°±ç»ªæ—¶æ‰èƒ½è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚æ¯ä¸ªé˜¶æ®µçš„ç»“å°¾è®¾ç½®ä¸€ä¸ªå±éšœï¼Œå½“ä¸€ä¸ªè¿›ç¨‹åˆ°è¾¾å±éšœæ—¶å°†è¢«é˜»æ‹¦ï¼Œç›´åˆ°æ‰€æœ‰è¿›ç¨‹åˆ°è¾¾å±éšœä¸ºæ­¢ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:9:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"è°ƒåº¦ å‡ ä¹æ‰€æœ‰è¿›ç¨‹çš„ I/O è¯·æ±‚å’Œè®¡ç®—éƒ½æ˜¯äº¤æ›¿çªå‘çš„ï¼Œå¦‚æœè¿›ç¨‹èŠ±è´¹å¤§é‡æ—¶é—´åœ¨è®¡ç®—ä¸Šï¼Œåˆ™ç§°ä¸ºè®¡ç®—å¯†é›†å‹(compute-bound)ï¼Œå¦‚æœå¤§é‡æ—¶é—´èŠ±è´¹åœ¨ç­‰å¾… I/O ä¸Šï¼Œåˆ™ç§°ä¸º I/O å¯†é›†å‹(I/O-bound) éšç€ CPU å˜å¾—è¶Šæ¥è¶Šå¿«ï¼Œæ›´å¤šçš„è¿›ç¨‹å€¾å‘ä¸º I/O å¯†é›†å‹ã€‚è¿™ç§ç°è±¡çš„åŸå› æ˜¯ CPU çš„æ”¹è¿›æ¯”ç£ç›˜çš„æ”¹è¿›å¿«å¾—å¤šï¼Œæ‰€ä»¥æœªæ¥å¯¹ I/O å¯†é›†å‹è¿›ç¨‹çš„è°ƒåº¦å¤„ç†æ›´ä¸ºé‡è¦ è°ƒåº¦çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¦‚æœéœ€è¦è¿è¡Œ I/O å¯†é›†å‹è¿›ç¨‹ï¼Œå°±åº”è¯¥è®©å®ƒå°½å¿«å¾—åˆ°æœºä¼šï¼Œä»¥ä¾¿å‘å‡ºç£ç›˜è¯·æ±‚å¹¶ä¿æŒç£ç›˜å§‹ç»ˆå¿™ç¢Œ æ ¹æ®å¦‚ä½•å¤„ç†æ—¶é’Ÿä¸­æ–­ï¼Œå¯ä»¥æŠŠè°ƒåº¦ç®—æ³•åˆ†ä¸ºéæŠ¢å å¼å’ŒæŠ¢å å¼ä¸¤ç±» éæŠ¢å å¼è°ƒåº¦ç®—æ³•æŒ‘é€‰ä¸€ä¸ªè¿›ç¨‹ï¼Œç„¶åè®©è¯¥è¿›ç¨‹è¿è¡Œç›´è‡³é˜»å¡ï¼Œæˆ–ç›´åˆ°è¯¥è¿›ç¨‹è‡ªåŠ¨é‡Šæ”¾ CPUã€‚å³ä½¿è¯¥è¿›ç¨‹è¿è¡Œäº†å‡ ä¸ªå°æ—¶ä¹Ÿä¸ä¼šè¢«å¼ºè¿«æŒ‚èµ·ï¼Œè¿™æ ·å¯¼è‡´æ—¶é’Ÿä¸­æ–­å‘ç”Ÿæ—¶ä¸ä¼šè¿›è¡Œè°ƒåº¦ã€‚åœ¨å¤„ç†å®Œæ—¶é’Ÿä¸­æ–­åï¼Œå¦‚æœæ²¡æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œåˆ™è¢«ä¸­æ–­çš„è¿›ç¨‹å°†ç»§ç»­è¿è¡Œ æŠ¢å å¼è°ƒåº¦ç®—æ³•æŒ‘é€‰ä¸€ä¸ªè¿›ç¨‹ï¼Œè®©è¯¥è¿›ç¨‹è¿è¡ŒæŸä¸ªå›ºå®šæ—¶æ®µçš„æœ€å¤§å€¼ï¼Œæ—¶æ®µç»“æŸæ—¶å°†æŒ‚èµ·è¯¥è¿›ç¨‹ï¼Œå¹¶æŒ‘é€‰å¦ä¸€ä¸ªè¿›ç¨‹è¿è¡Œã€‚æŠ¢å å¼è°ƒåº¦éœ€è¦åœ¨æ—¶é—´é—´éš”çš„æœ«ç«¯å‘ç”Ÿæ—¶é’Ÿä¸­æ–­ï¼Œä»¥ä¾¿æŠŠ CPU æ§åˆ¶è¿”å›ç»™è°ƒåº¦ç¨‹åºï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨çš„æ—¶é’Ÿï¼Œå°±åªèƒ½é€‰æ‹©éæŠ¢å å¼è°ƒåº¦ ä¸åŒçš„åº”ç”¨é¢†åŸŸæœ‰ä¸åŒçš„ç›®æ ‡ï¼Œä¹Ÿå°±éœ€è¦ä¸åŒçš„è°ƒåº¦ç®—æ³•ã€‚ç¯å¢ƒå¯ä»¥åˆ’åˆ†ä¸ºä¸‰ç§ æ‰¹å¤„ç†ï¼šå¹¿æ³›ç”¨äºå•†ä¸šé¢†åŸŸï¼Œæ¯”å¦‚å¤„ç†è–ªæ°´æ¸…å•ã€è´¦ç›®æ”¶å…¥ã€è´¦ç›®æ”¯å‡ºã€åˆ©æ¯è®¡ç®—ï¼Œæ‰¹å¤„ç†ç³»ç»Ÿä¸ä¼šæœ‰ç”¨æˆ·åœ¨æ—è¾¹æ€¥åˆ‡ç­‰å¾…å“åº”ï¼Œå› æ­¤é€šå¸¸ä½¿ç”¨éæŠ¢å å¼ç®—æ³•ï¼Œæˆ–å¯¹æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰é•¿æ—¶é—´å‘¨æœŸçš„æŠ¢å å¼ç®—æ³•ï¼Œè¿™æ ·å‡å°‘äº†è¿›ç¨‹åˆ‡æ¢ä»è€Œæ”¹è¿›äº†æ€§èƒ½ äº¤äº’å¼ï¼šå¿…é¡»ä½¿ç”¨æŠ¢å å¼ç®—æ³•ï¼Œä»¥é¿å… CPU è¢«ä¸€ä¸ªè¿›ç¨‹éœ¸å è€Œæ‹’ç»ä¸ºå…¶ä»–è¿›ç¨‹æœåŠ¡ã€‚æœåŠ¡å™¨ä¹Ÿå½’äºæ­¤ç±»ï¼Œå› ä¸ºé€šå¸¸è¦æœåŠ¡å¤šä¸ªçªå‘çš„è¿œç¨‹ç”¨æˆ· å®æ—¶ï¼šæœ‰æ—¶ä¸éœ€è¦æŠ¢å ï¼Œå› ä¸ºè¿›ç¨‹äº†è§£å®ƒä»¬å¯èƒ½ä¼šé•¿æ—¶é—´å¾—ä¸åˆ°è¿è¡Œï¼Œæ‰€ä»¥é€šå¸¸å¾ˆå¿«åœ°å®Œæˆå„è‡ªå·¥ä½œå¹¶é˜»å¡ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:10:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"è°ƒåº¦ç®—æ³•çš„è¯„ä»·æŒ‡æ ‡ å¯¹äºæ‰¹å¤„ç†ç³»ç»Ÿï¼Œè°ƒåº¦ç®—æ³•çš„è¯„ä»·æŒ‡æ ‡ä¸»è¦æœ‰ä¸‰ä¸ª ååé‡(throughout)ï¼šç³»ç»Ÿå•ä½æ—¶é—´å†…å®Œæˆçš„ä½œä¸šæ•°é‡ï¼Œæ¯”å¦‚ 10 é“ä½œä¸šèŠ±è´¹ 100 ç§’ï¼Œåˆ™ååé‡ä¸º 0.1 é“/ç§’ å‘¨è½¬æ—¶é—´(turnaround time)ï¼šä¸€ä¸ªæ‰¹å¤„ç†ä½œä¸šä»æäº¤å¼€å§‹åˆ°å®Œæˆçš„ç»Ÿè®¡å¹³å‡æ—¶é—´ CPU åˆ©ç”¨ç‡ï¼šCPU å¿™ç¢Œæ—¶é—´ç›¸å¯¹æ€»æ—¶é—´çš„å æ¯” å¯¹äºäº¤äº’å¼ç³»ç»Ÿï¼Œè¯„ä»·æŒ‡æ ‡æœ€é‡è¦çš„æ˜¯æœ€å°å“åº”æ—¶é—´ï¼Œå³ä»å‘å‡ºå‘½ä»¤åˆ°å¾—åˆ°å“åº”ä¹‹é—´çš„æ—¶é—´ å®æ—¶ç³»ç»Ÿçš„ç‰¹ç‚¹æ˜¯æˆ–å¤šæˆ–å°‘å¿…é¡»æ»¡è¶³æˆªæ­¢æ—¶é—´ï¼Œå¤šæ•°å®æ—¶ç³»ç»Ÿä¸­ï¼Œå¯é¢„æµ‹æ€§ååˆ†é‡è¦ï¼Œæ¯”å¦‚å¦‚æœå¤šåª’ä½“å®æ—¶ç³»ç»Ÿçš„éŸ³é¢‘è¿›ç¨‹è¿è¡Œé”™è¯¯å¤ªå¤šï¼ŒéŸ³è´¨å°±ä¼šæ˜æ˜¾ä¸‹é™ï¼Œä¸ºæ­¤å®æ—¶ç³»ç»Ÿçš„è°ƒåº¦ç®—æ³•å¿…é¡»æ˜¯é«˜åº¦å¯é¢„æµ‹å’Œæœ‰è§„å¾‹çš„ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:11:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"æ‰¹å¤„ç†ç³»ç»Ÿä¸­çš„è°ƒåº¦ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:12:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"å…ˆæ¥å…ˆæœåŠ¡(First-Come First-Servedï¼ŒFCFS) éæŠ¢å å¼ã€‚è¿›ç¨‹æŒ‰ç…§è¯·æ±‚ CPU çš„å…ˆåé¡ºåºè°ƒåº¦ï¼Œä¼˜ç‚¹æ˜¯å…¬å¹³ï¼Œç®—æ³•å®ç°ç®€å•ï¼Œä¸ä¼šå¯¼è‡´è¿›ç¨‹é¥¥é¥¿(Starvationï¼Œç­‰å¾…æ—¶é—´å¯¹è¿›ç¨‹å“åº”å¸¦æ¥æ˜æ˜¾å½±å“) è¿›ç¨‹ åˆ°è¾¾æ—¶é—´ è¿è¡Œæ—¶é—´ P1 0 7 P2 2 4 P3 4 1 P4 5 4 å…ˆåˆ°å…ˆæœåŠ¡ï¼Œå› æ­¤è°ƒåº¦é¡ºåºä¸º P1 -\u003e P2 -\u003e P3 -\u003e P4 P1 P2 P3 P4 ------- ---- - ---- å‘¨è½¬æ—¶é—´ = å®Œæˆæ—¶é—´ - åˆ°è¾¾æ—¶é—´ P1 = 7 - 0 = 7 P2 = 11 - 2 = 9 P3 = 12 - 4 = 8 // åªè¿è¡Œ 1ï¼Œå´éœ€è¦ç­‰å¾… 8ï¼Œå¯è§ FCFS ç®—æ³•å¯¹çŸ­ä½œä¸šä¸åˆ© P4 = 16 - 5 = 11 å¹³å‡å‘¨è½¬æ—¶é—´ = 8.75 å¸¦æƒå‘¨è½¬æ—¶é—´ = å‘¨è½¬æ—¶é—´ / è¿è¡Œæ—¶é—´ P1 = 7 / 7 = 1 P2 = 9 / 4 = 2.25 P3 = 8 / 1 = 8 P4 = 11 / 4 = 2.75 å¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´ = 3.5 ç­‰å¾…æ—¶é—´ = å‘¨è½¬æ—¶é—´ - è¿è¡Œæ—¶é—´(ä¸è€ƒè™‘ç­‰å¾… I/O æ“ä½œçš„æ—¶é—´) P1 = 7 - 7 = 0 P2 = 9 - 4 = 5 P3 = 8 - 1 = 7 P4 = 11 - 4 = 7 å¹³å‡ç­‰å¾…æ—¶é—´ = 4.75 ","date":"2023-11-19","objectID":"/posts/processesandthreads/:12:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"æœ€çŸ­ä½œä¸šä¼˜å…ˆ(Shortest Job Firstï¼ŒSJF) éæŠ¢å å¼ã€‚é€‰æ‹©å·²åˆ°è¾¾çš„ä¸”è¿è¡Œæ—¶é—´æœ€çŸ­çš„è¿›ç¨‹ï¼Œè¿è¡Œæ—¶é—´ç›¸åŒåˆ™å…ˆåˆ°è¾¾çš„å…ˆè¿è¡Œã€‚ç›®æ ‡æ˜¯è¿½æ±‚æœ€çŸ­çš„å¹³å‡å‘¨è½¬æ—¶é—´ã€å¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´ã€å¹³å‡ç­‰å¾…æ—¶é—´ï¼Œç¼ºç‚¹æ˜¯ä¸å…¬å¹³ï¼Œå¯¹çŸ­ä½œä¸šæœ‰åˆ©ï¼Œå¯¹é•¿ä½œä¸šä¸åˆ©ï¼Œå¦‚æœä¸€ç›´æœ‰çŸ­ä½œä¸šåˆ°è¾¾å¯èƒ½å¯¼è‡´é•¿ä½œä¸šé¥¥é¥¿ è¿›ç¨‹ åˆ°è¾¾æ—¶é—´ è¿è¡Œæ—¶é—´ P1 0 7 P2 2 4 P3 4 1 P4 5 4 P1 å…ˆåˆ°è¾¾ï¼ŒP1 è¿è¡Œç»“æŸæ—¶ P2ã€P3ã€P4 å‡åˆ°è¾¾ï¼ŒP3 è¿è¡Œæ—¶é—´æœ€çŸ­å…ˆè¿è¡Œ P2ã€P4 è¿è¡Œæ—¶é—´ç›¸åŒï¼ŒP2 å…ˆåˆ°è¾¾ï¼Œå› æ­¤ P2 å…ˆäº P4 è¿è¡Œ æœ€ç»ˆè°ƒåº¦é¡ºåºä¸º P1 -\u003e P3 -\u003e P2 -\u003e P4 P1 P3 P2 P4 ------- - ---- ---- å‘¨è½¬æ—¶é—´ = å®Œæˆæ—¶é—´ - åˆ°è¾¾æ—¶é—´ P1 = 7 - 0 = 7 P2 = 12 - 2 = 10 P3 = 8 - 4 = 4 P4 = 16 - 5 = 11 å¹³å‡å‘¨è½¬æ—¶é—´ = 8 å¸¦æƒå‘¨è½¬æ—¶é—´ = å‘¨è½¬æ—¶é—´ / è¿è¡Œæ—¶é—´ P1 = 7 / 7 = 1 P2 = 10 / 4 = 2.5 P3 = 4 / 1 = 4 P4 = 11 / 4 = 2.75 å¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´ = 2.56 ç­‰å¾…æ—¶é—´ = å‘¨è½¬æ—¶é—´ - è¿è¡Œæ—¶é—´(ä¸è€ƒè™‘ç­‰å¾… I/O æ“ä½œçš„æ—¶é—´) P1 = 7 - 7 = 0 P2 = 10 - 4 = 6 P3 = 4 - 1 = 3 P4 = 11 - 4 = 7 å¹³å‡ç­‰å¾…æ—¶é—´ = 4 ","date":"2023-11-19","objectID":"/posts/processesandthreads/:12:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"æœ€çŸ­å‰©ä½™æ—¶é—´ä¼˜å…ˆ(Shortest Remaining Time Nextï¼ŒSRTN) SRTN æ˜¯ SJF çš„æŠ¢å å¼ç‰ˆæœ¬ï¼Œæ¯å½“æ–°è¿›ç¨‹åŠ å…¥æ—¶ï¼Œè°ƒåº¦ç¨‹åºæ€»æ˜¯é€‰æ‹©å‰©ä½™è¿è¡Œæ—¶é—´æœ€çŸ­çš„è¿›ç¨‹è¿è¡Œï¼Œå¦‚æœå½“å‰è¿›ç¨‹å‰©ä½™è¿è¡Œæ—¶é—´æ¯”æ–°è¿›ç¨‹é•¿ï¼Œåˆ™æŒ‚èµ·å½“å‰è¿›ç¨‹è€Œè¿è¡Œæ–°è¿›ç¨‹ è¿›ç¨‹ åˆ°è¾¾æ—¶é—´ è¿è¡Œæ—¶é—´ P1 0 7 P2 2 4 P3 4 1 P4 5 4 P2 åˆ°è¾¾æ—¶ï¼ŒP1 å‰©ä½™ 5ï¼ŒP2 ä¸º 4ï¼Œè¿è¡Œ P2 P3 åˆ°è¾¾æ—¶ï¼ŒP1 å‰©ä½™ 5ï¼ŒP2 å‰©ä½™ 2ï¼ŒP3 ä¸º 1ï¼Œè¿è¡Œ P3 P4 åˆ°è¾¾æ—¶ï¼ŒP3 è¿è¡Œç»“æŸï¼ŒP1 å‰©ä½™ 5ï¼ŒP2 å‰©ä½™ 2ï¼ŒP4 ä¸º 4ï¼Œè¿è¡Œ P2 æœ€åä¾æ¬¡è¿è¡Œ P4 å’Œ P1 æœ€ç»ˆè°ƒåº¦é¡ºåºä¸º P1 -\u003e P2 -\u003e P3 -\u003e P2 -\u003e P4 -\u003e P1 P1 P2 P3 P2 P4 P1 -- -- - -- ---- ----- å‘¨è½¬æ—¶é—´ = å®Œæˆæ—¶é—´ - åˆ°è¾¾æ—¶é—´ P1 = 16 - 0 = 16 P2 = 7 - 2 = 5 P3 = 5 - 4 = 1 P4 = 11 - 5 = 6 å¹³å‡å‘¨è½¬æ—¶é—´ = 7 å¸¦æƒå‘¨è½¬æ—¶é—´ = å‘¨è½¬æ—¶é—´ / è¿è¡Œæ—¶é—´ P1 = 16 / 7 = 2.29 P2 = 5 / 4 = 1.25 P3 = 1 / 1 = 1 P4 = 6 / 4 = 1.5 å¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´ = 1.51 ç­‰å¾…æ—¶é—´ = å‘¨è½¬æ—¶é—´ - è¿è¡Œæ—¶é—´(ä¸è€ƒè™‘ç­‰å¾… I/O æ“ä½œçš„æ—¶é—´) P1 = 16 - 7 = 9 P2 = 5 - 4 = 1 P3 = 1 - 1 = 0 P4 = 6 - 4 = 2 å¹³å‡ç­‰å¾…æ—¶é—´ = 3 ","date":"2023-11-19","objectID":"/posts/processesandthreads/:12:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"é«˜å“åº”æ¯”ä¼˜å…ˆ(Highest Response Ratio Nextï¼ŒHRRN) éæŠ¢å å¼ã€‚åœ¨æ‰€æœ‰å·²åˆ°è¾¾è¿›ç¨‹ä¸­é€‰æ‹©å“åº”æ¯”(ç­‰å¾…æ—¶é—´ / è¿è¡Œæ—¶é—´ + 1)æœ€é«˜çš„è¿è¡Œï¼Œç»¼åˆ FCFS å’Œ SJF çš„ä¼˜ç‚¹ï¼Œç­‰å¾…æ—¶é—´é•¿ã€è¿è¡Œæ—¶é—´çŸ­çš„ä¼˜å…ˆï¼Œé¿å…é•¿ä½œä¸šé¥¥é¥¿çš„é—®é¢˜ è¿›ç¨‹ åˆ°è¾¾æ—¶é—´ è¿è¡Œæ—¶é—´ P1 0 7 P2 2 4 P3 4 1 P4 5 4 å“åº”æ¯” = (ç­‰å¾…æ—¶é—´ + è¿è¡Œæ—¶é—´) / è¿è¡Œæ—¶é—´ P1 è¿è¡Œè‡³ç»“æŸï¼ŒP2ã€P3ã€P4 å‡åˆ°è¾¾ï¼Œå“åº”æ¯”åˆ†åˆ«ä¸º P2 = (5 + 4) / 4 = 2.25 P3 = (3 + 1) / 1 = 4 P4 = (2 + 4) / 4 = 1.5 è¿è¡Œ P3ï¼ŒP3 ç»“æŸæ—¶ï¼Œå“åº”æ¯”åˆ†åˆ«ä¸º P2 = (6 + 4) / 4 = 2.5 P4 = (3 + 4) / 4 = 1.75 è¿è¡Œ P2ï¼Œæœ€åè¿è¡Œ P4 æœ€ç»ˆè°ƒåº¦é¡ºåºä¸º P1 -\u003e P3 -\u003e P2 -\u003e P4 P1 P3 P2 P4 ------- - ---- ---- ","date":"2023-11-19","objectID":"/posts/processesandthreads/:12:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"äº¤äº’å¼ç³»ç»Ÿä¸­çš„è°ƒåº¦ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:13:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦(Round-Robin Schedulingï¼ŒRR) RR æ˜¯ä¸€ç§ç®€å•å…¬å¹³çš„æŠ¢å å¼è°ƒåº¦ç®—æ³•ï¼Œå¹¶ä¸”å¯ä»¥é¿å…é¥¥é¥¿ã€‚æ¯ä¸ªè¿›ç¨‹è¢«åˆ†é…ä¸€ä¸ªæ—¶é—´ç‰‡(quantum)ã€‚æ—¶é—´ç‰‡ç»“æŸæ—¶ï¼Œå¦‚æœè¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œåˆ™å‰¥å¤º CPU å¹¶åˆ†é…ç»™å¦ä¸€ä¸ªè¿›ç¨‹ã€‚å¦‚æœè¿›ç¨‹åœ¨æ—¶é—´ç‰‡ç»“æŸå‰é˜»å¡æˆ–ç»“æŸï¼Œåˆ™ CPU ç«‹å³åˆ‡æ¢ã€‚RR ç®—æ³•å®ç°å¾ˆå®¹æ˜“ï¼Œåªéœ€è¦ç»´æŠ¤ä¸€å¼ è¿›ç¨‹é˜Ÿåˆ—è¡¨ A -\u003e B -\u003e C -\u003e D è‹¥ A ç”¨å®Œæ—¶é—´ç‰‡ï¼Œä½†ä»åœ¨è¿è¡Œï¼Œåˆ™æ’å…¥åˆ°é˜Ÿåˆ—å°¾ B -\u003e C -\u003e D -\u003e A è‹¥ B ç”¨å®Œæ—¶é—´ç‰‡ï¼Œä½†ä»åœ¨è¿è¡Œï¼Œå¹¶åˆ°è¾¾ä¸€ä¸ªæ–°è¿›ç¨‹ Eï¼Œåˆ™å…ˆæ’å…¥æ–°è¿›ç¨‹ C -\u003e D -\u003e A -\u003e E -\u003e B è‹¥ C ç”¨å®Œæ—¶é—´ç‰‡ä¹‹å‰å°±ç»“æŸäº†ï¼Œåˆ™ç›´æ¥åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¿›ç¨‹ D -\u003e A -\u003e E -\u003e B éœ€è¦è€ƒè™‘çš„æ˜¯æ—¶é—´ç‰‡çš„é•¿åº¦ï¼Œå‡è®¾æ—¶é—´ç‰‡ä¸º 4 msï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢ä¸º 1 msï¼Œåˆ™ CPU å®Œæˆ 4 ms å·¥ä½œåå°†æµªè´¹ 1 ms è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢(context switch)ï¼Œå³æµªè´¹äº† 20% çš„æ—¶é—´ã€‚ä½†å¦‚æœæ—¶é—´ç‰‡å¤ªå¤§ï¼Œå°±ä¼šé€€åŒ–ä¸º FCFSï¼Œå¯¼è‡´å¢å¤§å“åº”æ—¶é—´ã€‚é€šå¸¸ä¸ºäº†æé«˜ CPU æ•ˆç‡ï¼Œè®¾ç½®æ—¶é—´ç‰‡æ—¶ï¼Œåˆ‡æ¢å¼€é”€å æ¯”åº”ä¸è¶…è¿‡ 1% ","date":"2023-11-19","objectID":"/posts/processesandthreads/:13:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"ä¼˜å…ˆçº§è°ƒåº¦ ä¸ºæ¯ä¸ªè¿›ç¨‹è®¾ç½®ä¼˜å…ˆçº§ï¼Œåœ¨å·²åˆ°è¾¾è¿›ç¨‹ä¸­ï¼Œé€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„è¿è¡Œï¼Œå¯ä»¥ä¸ºæŠ¢å å¼æˆ–éæŠ¢å å¼ æ¯”å¦‚å¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´ï¼ŒI/O å¯†é›†å‹è¿›ç¨‹çš„ä¼˜å…ˆçº§åº”è¯¥æ›´é«˜ã€‚I/O å¯†é›†å‹ç»§æ‰¿å¤šæ•°æ—¶é—´ç”¨äºç­‰å¾… I/O ç»“æŸï¼Œå› æ­¤éœ€è¦ CPU æ—¶åº”ç«‹å³åˆ†é…ç»™å®ƒä»¥ä¾¿å¯åŠ¨ä¸‹ä¸€ä¸ª I/O è¯·æ±‚ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å¦ä¸€ä¸ªè¿›ç¨‹è®¡ç®—çš„åŒæ—¶æ‰§è¡Œ I/O æ“ä½œ ä¸€ç§ç®€å•åšæ³•æ˜¯å°†ä¼˜å…ˆçº§è®¾ç½®ä¸º 1 / fï¼Œf ä¸ºè¯¥è¿›ç¨‹åœ¨ä¸Šä¸€æ—¶é—´ç‰‡ä¸­çš„è¿è¡Œæ—¶é—´å æ¯”ã€‚æ¯”å¦‚åœ¨ 50 ms æ—¶é—´ç‰‡ä¸­ï¼Œä½¿ç”¨ 1 ms çš„è¿›ç¨‹ä¼˜å…ˆçº§ä¸º 50ï¼Œä½¿ç”¨ 25 ms çš„è¿›ç¨‹ä¼˜å…ˆçº§ä¸º 2ã€‚å°†è¿›ç¨‹æŒ‰ä¼˜å…ˆçº§åˆ†ç»„ï¼Œå†ä½¿ç”¨ RR ç®—æ³•è°ƒåº¦é«˜ä¼˜å…ˆçº§ç»„ä¸­çš„è¿›ç¨‹ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:13:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ CTSS(Compatible Time Sharing System)æ˜¯æœ€æ—©ä½¿ç”¨ä¼˜å…ˆçº§è°ƒåº¦çš„ç³»ç»Ÿä¹‹ä¸€ï¼Œä½†å­˜åœ¨è¿›ç¨‹åˆ‡æ¢é€Ÿåº¦å¤ªæ…¢çš„é—®é¢˜ï¼Œå…¶è®¾è®¡è€…æ„è¯†åˆ°è®¾ç½®è¾ƒé•¿çš„æ—¶é—´ç‰‡å¯ä»¥å‡å°‘åˆ‡æ¢æ¬¡æ•°ï¼Œä½†é•¿æ—¶é—´ç‰‡åˆä¼šå½±å“åˆ°å“åº”æ—¶é—´ã€‚æœ€ç»ˆçš„è§£å†³æ–¹æ³•æ˜¯å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ï¼Œå®ƒæ˜¯å¯¹ FCFSã€SJFã€RRã€ä¼˜å…ˆçº§è°ƒåº¦çš„æŠ˜ä¸­æƒè¡¡ è®¾ç½®å¤šä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œæ¯ä¸ªçº§åˆ«å¯¹åº”ä¸åŒé•¿åº¦çš„æ—¶é—´ç‰‡ï¼Œæ¯”å¦‚ç¬¬ä¸€çº§(æœ€é«˜çº§)æ—¶é—´ç‰‡ä¸º 1ï¼Œç¬¬äºŒçº§ä¸º 2ï¼Œç¬¬ä¸‰çº§ä¸º 4ï¼Œä»¥æ­¤ç±»æ¨ å¦‚æœä¸€ä¸ªè¿›ç¨‹ç”¨å®Œå½“å‰çº§åˆ«æ—¶é—´ç‰‡åä»æœªè¿è¡Œå®Œï¼Œåˆ™åŠ å…¥ä¸‹ä¸€çº§é˜Ÿåˆ—é˜Ÿå°¾ï¼Œå¦‚æœå·²ç»ä½äºæœ€åä¸€çº§åˆ™æ”¾å›è¯¥çº§é˜Ÿå°¾ é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œæ‰ä¼šè°ƒåº¦ä½ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå› æ­¤å¯èƒ½å¯¼è‡´ä½ä¼˜å…ˆçº§è¿›ç¨‹é¥¥é¥¿ æ¯”å¦‚ä¸€ä¸ªè¿›ç¨‹éœ€è¦ 100 ä¸ªæ—¶é—´ç‰‡ï¼Œç¬¬ä¸€æ¬¡åˆ†é… 1 ä¸ªæ—¶é—´ç‰‡ï¼Œç¬¬äºŒæ¬¡åˆ†é… 2 ä¸ªï¼Œæ¥ä¸‹æ¥æ˜¯ 4ã€8ã€16ã€32ã€64ï¼Œæœ€åä¸€æ¬¡ä½¿ç”¨ 64 ä¸­çš„ 37 ä¸ªå³å¯ç»“æŸå·¥ä½œï¼Œä¸€å…±è¿›è¡Œ 7 æ¬¡åˆ‡æ¢ã€‚å¦‚æœä½¿ç”¨ RR ç®—æ³•ï¼Œåˆ™éœ€è¦ 100 æ¬¡åˆ‡æ¢ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:13:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"æœ€çŸ­è¿›ç¨‹ä¼˜å…ˆ å…³é”®åœ¨äºå¦‚ä½•ä»å¯è¿è¡Œè¿›ç¨‹ä¸­æ‰¾å‡ºæœ€çŸ­çš„ä¸€ä¸ª ä¸€ç§æ–¹æ³•æ˜¯æ ¹æ®è¿‡å»çš„è¡Œä¸ºè¿›è¡Œé¢„æµ‹ã€‚å‡è®¾æŸç»ˆç«¯æ¯æ¡å‘½ä»¤çš„ä¼°è®¡è¿è¡Œæ—¶é—´ä¸º T0ï¼Œæµ‹é‡åˆ°ä¸‹ä¸€æ¬¡è¿è¡Œæ—¶é—´ä¸º T1ï¼Œåˆ™ä¼°è®¡æ—¶é—´å¯ä»¥ä¿®æ­£ä¸º a * T0 + (1 - a) * T1ï¼Œæ¯”å¦‚è®¾ a ä¸º 1 / 2 å¯ä»¥å¾—åˆ°åºåˆ—å¦‚ä¸‹ T0 T0/2 + T1/2 T0/4 + T1/4 + T2/2 T0/8 + T1/8 + T2/4 + T3/2 // T0 åœ¨æ­¤æ—¶ä¼°è®¡æ—¶é—´ä¸­çš„å æ¯”ä¸‹é™åˆ° 1/8 ","date":"2023-11-19","objectID":"/posts/processesandthreads/:13:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"ä¿è¯è°ƒåº¦ å‘ç”¨æˆ·ä½œå‡ºæ˜ç¡®çš„æ€§èƒ½ä¿è¯ï¼Œç„¶åå®ç°å®ƒã€‚æ¯”å¦‚æœ‰ n ä¸ªè¿›ç¨‹è¿è¡Œçš„å•ç”¨æˆ·ç³»ç»Ÿä¸­ï¼Œå¦‚æœæ‰€æœ‰è¿›ç¨‹ç­‰ä»·ï¼Œåˆ™æ¯ä¸ªè¿›ç¨‹è·å¾— 1 / n çš„CPUæ—¶é—´ï¼Œä¸ºäº†å®ç°æ‰€ä½œçš„ä¿è¯ï¼Œç³»ç»Ÿè·Ÿè¸ªæ¯ä¸ªè¿›ç¨‹å·²ä½¿ç”¨çš„ CPU æ—¶é—´ï¼Œå¹¶è®¡ç®—åº”è·å¾—çš„æ—¶é—´ï¼Œç„¶åè½¬å‘å·²ç”¨æ—¶é—´æœ€å°‘çš„è¿›ç¨‹ï¼Œç›´åˆ°è¶…è¿‡æœ€æ¥è¿‘çš„ç«äº‰è€… ","date":"2023-11-19","objectID":"/posts/processesandthreads/:13:5","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"å½©ç¥¨è°ƒåº¦(Lottery Scheduling) ä¿è¯è°ƒåº¦çš„æƒ³æ³•ä¸é”™ï¼Œä½†å¾ˆéš¾å®ç°ã€‚å½©ç¥¨è°ƒåº¦æ—¢å¯ä»¥ç»™å‡ºç±»ä¼¼é¢„æµ‹ç»“æœï¼Œå¹¶ä¸”å®ç°éå¸¸ç®€å•ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯ä¸ºè¿›ç¨‹æä¾›å„ç§ç³»ç»Ÿèµ„æº(å¦‚ CPU æ—¶é—´)çš„å½©ç¥¨ï¼Œä¸€æ—¦éœ€è¦åšå‡ºè°ƒåº¦å†³ç­–æ—¶ï¼Œå°±éšæœºæŠ½å‡ºä¸€å¼ å½©ç¥¨ï¼Œæ‹¥æœ‰è¯¥å½©ç¥¨çš„è¿›ç¨‹è·å–è¯¥èµ„æº æ¯”å¦‚ç³»ç»ŸæŒæ¡æ¯ç§’ 50 æ¬¡çš„ä¸€ç§å½©ç¥¨ï¼Œä½œä¸ºå¥–åŠ±æ¯ä¸ªè·å¥–è€…å¯ä»¥è·å¾— 20 ms çš„ CPU æ—¶é—´ å¯ä»¥ç»™æ›´é‡è¦çš„è¿›ç¨‹é¢å¤–çš„å½©ç¥¨ï¼Œä»¥å¢åŠ å…¶è·èƒœçš„æœºä¼šï¼Œæ¯”å¦‚å‡ºå”® 100 å¼ å½©ç¥¨ï¼Œä¸€ä¸ªè¿›ç¨‹æŒæœ‰å…¶ä¸­ 20 å¼ ï¼Œåˆ™æ¯æ¬¡æŠ½å¥–è¯¥è¿›ç¨‹å°±æœ‰ 20% çš„å–èƒœæœºä¼šï¼Œåœ¨è¾ƒé•¿è¿è¡Œæ—¶é—´ä¸­è¯¥è¿›ç¨‹å°±ä¼šå¾—åˆ° 20% çš„ CPU å½©ç¥¨è°ƒåº¦å¯ä»¥è§£å†³å…¶ä»–æ–¹æ³•å¾ˆéš¾è§£å†³çš„é—®é¢˜ï¼Œæ¯”å¦‚ä¸€ä¸ªè§†é¢‘æœåŠ¡å™¨ä¸Šæœ‰è‹¥å¹²æä¾›è§†é¢‘æµçš„è¿›ç¨‹ï¼Œæ¯ä¸ªæµçš„å¸§ç‡ä¸åŒï¼Œå‡è®¾å¸§ç‡åˆ†åˆ«ä¸º 10ã€20ã€25ï¼Œé‚£ä¹ˆç»™è¿™äº›è¿›ç¨‹åˆ†åˆ«åˆ†é… 10ã€20ã€25 å¼ å½©ç¥¨ï¼Œå®ƒä»¬å°±ä¼šè‡ªåŠ¨æŒ‰ç…§æ¥è¿‘ 10:20:25 çš„æ¯”ä¾‹åˆ’åˆ† CPU çš„ä½¿ç”¨ ","date":"2023-11-19","objectID":"/posts/processesandthreads/:13:6","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"å…¬å¹³åˆ†äº«è°ƒåº¦ ä¹‹å‰çš„è°ƒåº¦å…³æ³¨çš„éƒ½æ˜¯è¿›ç¨‹æœ¬èº«ï¼Œè€Œæ²¡æœ‰å…³æ³¨è¿›ç¨‹æ‰€æœ‰è€…ã€‚å‡è®¾ä¸¤ä¸ªç”¨æˆ·åˆ†åˆ«å¯åŠ¨ 9 ä¸ªè¿›ç¨‹å’Œ 1 ä¸ªè¿›ç¨‹ï¼Œä½¿ç”¨ RR ç®—æ³•ï¼Œåˆ™ä¸¤è€…åˆ†åˆ«å¾—åˆ° 90% å’Œ 10% çš„ CPU æ—¶é—´ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåœ¨è°ƒåº¦å¤„ç†ä¹‹å‰åº”è¯¥è€ƒè™‘è¿›ç¨‹æ‹¥æœ‰è€… ","date":"2023-11-19","objectID":"/posts/processesandthreads/:13:7","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Processes and Threads","uri":"/posts/processesandthreads/"},{"categories":["C++"],"content":"æ— å­˜å‚¨å™¨æŠ½è±¡ æ—©æœŸè®¡ç®—æœºæ²¡æœ‰å­˜å‚¨å™¨æŠ½è±¡ï¼Œæ¯ä¸ªç¨‹åºéƒ½ç›´æ¥è®¿é—®ç‰©ç†å†…å­˜ MOV REGISTER1, 1000 ;å°†ä½ç½®1000çš„ç‰©ç†å†…å­˜ä¸­çš„å†…å®¹ç§»åˆ° REGISTER1 ä¸­ å› æ­¤é‚£æ—¶å‘ˆç°ç»™ç¨‹åºå‘˜çš„å­˜å‚¨å™¨æ¨¡å‹å°±æ˜¯ç®€å•çš„ç‰©ç†å†…å­˜ï¼šä» 0 åˆ°æŸä¸ªä¸Šé™çš„åœ°å€é›†åˆï¼Œæ¯ä¸ªåœ°å€å¯¹åº”ä¸€ä¸ªå¯å®¹çº³ä¸€å®šæ•°ç›®ï¼ˆé€šå¸¸æ˜¯ 8 ä¸ªï¼‰äºŒè¿›åˆ¶ä½çš„å­˜å‚¨å•å…ƒ è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨å†…å­˜ä¸­åŒæ—¶è¿è¡Œä¸¤ä¸ªç¨‹åºæ˜¯ä¸å¯èƒ½çš„ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºåœ¨ 2000 çš„ä½ç½®å†™å…¥ä¸€ä¸ªæ–°å€¼ï¼Œå°±ä¼šæ“¦æ‰å¦ä¸€ä¸ªç¨‹åºåœ¨ç›¸åŒä½ç½®ä¸Šçš„å†…å®¹ï¼Œå› æ­¤æ— æ³•åŒæ—¶è¿è¡Œä¸¤ä¸ªç¨‹åºï¼Œè¿™ä¸¤ä¸ªç¨‹åºä¼šç«‹åˆ»å´©æºƒ ä¸ºäº†è¿è¡Œå¤šä¸ªç¨‹åºï¼Œä¸€ä¸ªè§£å†³æ–¹æ³•æ˜¯ï¼Œæ“ä½œç³»ç»ŸæŠŠå½“å‰å†…å­˜ä¸­æ‰€æœ‰å†…å®¹ä¿å­˜åˆ°ç£ç›˜ï¼Œç„¶åæŠŠä¸‹ä¸€ä¸ªç¨‹åºè¯»å…¥åˆ°å†…å­˜ä¸­å†è¿è¡Œå³å¯ã€‚åŒä¸€æ—¶åˆ»ï¼Œåªè¦å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªç¨‹åºï¼Œå°±ä¸ä¼šå‘ç”Ÿå†²çª ä½†è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªé‡è¦çš„ç¼ºé™·ï¼Œå³é‡å®šä½ï¼ˆå³é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢ï¼‰é—®é¢˜ã€‚å‡è®¾æœ‰ä¸¤ä¸ªç¨‹åºï¼Œç¬¬ä¸€ä¸ªç¨‹åºåœ¨ 0 å¤„çš„æŒ‡ä»¤æ˜¯ JMP 24ï¼Œç¬¬äºŒä¸ªç¨‹åºåœ¨ 0 å¤„çš„æŒ‡ä»¤æ˜¯ JMP 28ï¼Œå½“ç¬¬ä¸€ä¸ªç¨‹åºè¿è¡Œä¸€æ®µæ—¶é—´åå†è¿è¡Œç¬¬äºŒä¸ªç¨‹åºï¼Œç¬¬äºŒä¸ªç¨‹åºä¼šè·³åˆ°ç¬¬ä¸€ä¸ªç¨‹åº 28 å¤„çš„æŒ‡ä»¤ã€‚ç”±äºå¯¹å†…å­˜åœ°å€çš„ä¸æ­£ç¡®è®¿é—®ï¼Œç¨‹åºç«‹åˆ»å´©æºƒ ä¸€ä¸ªè¡¥æ•‘æ–¹æ³•æ˜¯é™æ€é‡å®šä½ï¼Œå³è£…å…¥æ—¶å°†é€»è¾‘åœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€ã€‚å½“ä¸€ä¸ªç¨‹åºè¢«è£…è½½åˆ°åœ°å€ 16384 æ—¶ï¼Œå¸¸æ•° 16384 è¢«åŠ åˆ°æ¯ä¸€ä¸ªç¨‹åºåœ°å€ä¸Šã€‚è™½ç„¶è¿™ä¸ªæœºåˆ¶åœ¨ä¸å‡ºé”™è¯¯çš„æƒ…å†µä¸‹å¯è¡Œï¼Œä½†ä¸æ˜¯ä¸€ç§é€šç”¨çš„è§£å†³æ–¹æ³•ï¼ŒåŒæ—¶ä¼šå‡æ…¢è£…è½½é€Ÿåº¦ï¼Œå¹¶ä¸”å®ƒè¦æ±‚æ‰€æœ‰çš„å¯æ‰§è¡Œç¨‹åºæä¾›é¢å¤–çš„ä¿¡æ¯ï¼Œä»¥åŒºåˆ†å“ªäº›å†…å­˜å­—ä¸­å­˜æœ‰å¯é‡å®šä½çš„åœ°å€ï¼Œå“ªäº›æ²¡æœ‰ è™½ç„¶ç›´æ¥å¼•ç”¨ç‰©ç†åœ°å€å¯¹å¤§å‹è®¡ç®—æœºã€å°å‹è®¡ç®—æœºã€å°å¼è®¡ç®—æœºã€ç¬”è®°æœ¬éƒ½å·²ç»æˆä¸ºäº†å†å²ï¼Œä½†åœ¨åµŒå…¥å¼ç³»ç»Ÿã€æ™ºèƒ½å¡ç³»ç»Ÿä¸­ï¼Œç¼ºå°‘å­˜å‚¨å™¨æŠ½è±¡çš„æƒ…å†µä»ç„¶å¾ˆå¸¸è§ã€‚åƒæ”¶éŸ³æœºã€æ´—è¡£æœºã€å¾®æ³¢ç‚‰éƒ½æ˜¯é‡‡ç”¨è®¿é—®ç»å¯¹å†…å­˜åœ°å€çš„å¯»å€æ–¹å¼ï¼Œå…¶ä¸­çš„ç¨‹åºéƒ½æ˜¯äº‹å…ˆç¡®å®šçš„ï¼Œç”¨æˆ·ä¸èƒ½åœ¨å…¶ä¸Šè¿è¡Œè‡ªå·±çš„è½¯ä»¶ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥æ­£å¸¸å·¥ä½œ æ€»ä¹‹ï¼ŒæŠŠç‰©ç†åœ°å€æš´éœ²ç»™è¿›ç¨‹å¸¦æ¥çš„ä¸¥é‡é—®é¢˜æœ‰ï¼š å¦‚æœç”¨æˆ·ç¨‹åºå¯ä»¥å¯»å€å†…å­˜çš„æ¯ä¸ªå­—èŠ‚ï¼Œå°±å¯ä»¥è½»æ˜“ç ´åæ“ä½œç³»ç»Ÿ æƒ³è¦è¿è¡Œå¤šä¸ªç¨‹åºå¾ˆå›°éš¾ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"ä¸€ç§å­˜å‚¨å™¨æŠ½è±¡ï¼šåœ°å€ç©ºé—´ è¦ä½¿å¤šä¸ªç¨‹åºåŒæ—¶å­˜åœ¨äºå†…å­˜ä¸­å¹¶ä¸”äº’ä¸å½±å“ï¼Œéœ€è¦è§£å†³ä¿æŠ¤ï¼ˆè¿›ç¨‹åªèƒ½è®¿é—®è‡ªå·±çš„å†…å­˜ï¼‰å’Œé‡å®šä½ä¸¤ä¸ªé—®é¢˜ã€‚å¯¹å‰è€…çš„ä¸€ä¸ªåŸå§‹çš„è§£å†³æ–¹æ³•æ˜¯ï¼Œç»™å†…å­˜æ ‡è®°ä¸Šä¸€ä¸ªä¿æŠ¤é”®ï¼Œå¹¶ä¸”æ¯”è¾ƒæ‰§è¡Œè¿›ç¨‹çš„é”®å’Œå…¶è®¿é—®çš„æ¯ä¸ªå†…å­˜å­—çš„ä¿æŠ¤é”®ï¼Œæ¯”å¦‚è¿›ç¨‹èƒ½è®¿é—®çš„ç©ºé—´æ˜¯ 0-100ï¼ŒCPU æ ‡è®°æ­¤èŒƒå›´ï¼Œç„¶ååœ¨è®¿é—®å†…å­˜æ—¶æ£€æŸ¥æ˜¯å¦ä¸ºè¯¥è¿›ç¨‹å¯è®¿é—®ç©ºé—´ã€‚ä¸è¿‡è¿™ç§æ–¹æ³•å¹¶æ²¡æœ‰è§£å†³é‡å®šä½é—®é¢˜ æ›´å¥½çš„æ–¹æ³•æ˜¯åˆ›é€ ä¸€ä¸ªæ–°çš„å­˜å‚¨å™¨æŠ½è±¡ï¼šåœ°å€ç©ºé—´ã€‚åœ°å€ç©ºé—´æ˜¯ä¸€ä¸ªè¿›ç¨‹å¯ç”¨äºå¯»å€å†…å­˜çš„ä¸€å¥—åœ°å€é›†åˆï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„åœ°å€ç©ºé—´ï¼Œå¹¶ä¸”è¿™ä¸ªåœ°å€ç©ºé—´ç‹¬ç«‹äºå…¶ä»–è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼ˆé™¤äº†ä¸€äº›æƒ…å†µä¸‹è¿›ç¨‹éœ€è¦å…±äº«åœ°å€ç©ºé—´ï¼‰ åœ°å€ç©ºé—´çš„æ¦‚å¿µéå¸¸é€šç”¨ï¼Œæ¯”å¦‚ 7 ä½æ•°å­—çš„ç”µè¯å·ç çš„åœ°å€ç©ºé—´æ˜¯ 0 000 000 åˆ° 9 999 999ï¼Œx86 çš„ I/O ç«¯å£çš„åœ°å€ç©ºé—´æ˜¯ 0 åˆ° 16383ï¼ŒIPv4 çš„åœ°å€ç©ºé—´æ˜¯ 0 åˆ° 2 ^ 32 - 1ã€‚åœ°å€ç©ºé—´ä¹Ÿå¯ä»¥æ˜¯éæ•°å­—çš„ï¼Œæ¯”å¦‚ä»¥ .com ç»“å°¾çš„ç½‘ç»œåŸŸåçš„é›†åˆ æ¯”è¾ƒéš¾çš„æ˜¯ç»™æ¯ä¸ªç¨‹åºä¸€ä¸ªç‹¬æœ‰çš„åœ°å€ç©ºé—´ï¼Œä½¿å¾—ä¸¤ä¸ªç¨‹åºçš„ç›¸åŒåœ°å€ï¼ˆå¦‚åœ°å€ 28ï¼‰å¯¹åº”ä¸åŒçš„ç‰©ç†åœ°å€ ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨åŠ¨æ€é‡å®šä½ï¼Œå³è¿è¡Œæ—¶å°†é€»è¾‘åœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€ã€‚æŠŠæ¯ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´æ˜ å°„åˆ°ç‰©ç†å†…å­˜çš„ä¸åŒéƒ¨åˆ†ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹è¿è¡Œæ—¶ï¼Œç¨‹åºçš„èµ·å§‹ç‰©ç†åœ°å€è£…è½½åˆ°åŸºå€å¯„å­˜å™¨ï¼ˆåˆç§°é‡å®šä½å¯„å­˜å™¨ï¼‰ï¼Œç¨‹åºçš„é•¿åº¦è£…è½½åˆ°ç•Œé™å¯„å­˜å™¨ï¼ˆåˆç§°é™é•¿å¯„å­˜å™¨ï¼‰ã€‚è¿›ç¨‹è®¿é—®å†…å­˜ï¼ŒCPU åœ¨æŠŠåœ°å€å‘é€åˆ°å†…å­˜æ€»çº¿å‰ä¼šè‡ªåŠ¨æŠŠåŸºå€åŠ åˆ°è¿›ç¨‹å‘å‡ºçš„åœ°å€å€¼ä¸Šï¼ŒåŒæ—¶æ£€æŸ¥ç¨‹åºæä¾›çš„åœ°å€æ˜¯å¦è¶…å‡ºäº†ç•Œé™å¯„å­˜å™¨ä¸­çš„å€¼ï¼Œå¦‚æœè¶…å‡ºäº†å°±ä¼šäº§ç”Ÿé”™è¯¯å¹¶ç»ˆæ­¢è®¿é—®ã€‚å¯¹äºä¹‹å‰çš„ä¾‹å­ï¼Œæ¯”å¦‚ç¬¬äºŒä¸ªç¨‹åºçš„ JMP 28ï¼ŒCPU ä¼šå°†å…¶è§£é‡Šä¸º JMP 16412 ä½¿ç”¨åŸºå€å¯„å­˜å™¨å’Œç•Œé™å¯„å­˜å™¨é‡å®šä½çš„ç¼ºç‚¹æ˜¯ï¼Œæ¯æ¬¡è®¿é—®å†…å­˜éƒ½éœ€è¦è¿›è¡ŒåŠ æ³•å’Œæ¯”è¾ƒè¿ç®—ï¼Œæ¯”è¾ƒè¿ç®—å¯ä»¥å¾ˆå¿«ï¼Œä½†åŠ æ³•è¿ç®—ç”±äºè¿›ä½ä¼ é€’æ—¶é—´çš„é—®é¢˜ï¼Œåœ¨æ²¡æœ‰ä½¿ç”¨ç‰¹æ®Šç”µè·¯çš„æƒ…å†µä¸‹ä¼šæ˜¾å¾—å¾ˆæ…¢ ä½†ç‰©ç†å†…å­˜æ˜¯æœ‰é™çš„ï¼ŒæŠŠæ‰€æœ‰è¿›ç¨‹ä¸€ç›´ä¿å­˜åœ¨å†…å­˜ä¸­éœ€è¦å·¨å¤§çš„å†…å­˜ï¼Œå†…å­˜ä¸è¶³å°±æ— æ³•æ”¯æŒè¿™ç‚¹ã€‚å¤„ç†å†…å­˜è¶…è½½æœ‰ä¸¤ç§é€šç”¨æ–¹æ³•ï¼Œæœ€ç®€å•çš„æ˜¯äº¤æ¢ï¼ˆswappingï¼‰æŠ€æœ¯ï¼Œå³æŠŠè¿›ç¨‹å®Œæ•´è°ƒå…¥å†…å­˜è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œç„¶åæŠŠå®ƒå­˜å›ç£ç›˜ï¼Œè¿™æ ·ç©ºé—²è¿›ç¨‹ä¸»è¦å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œä¸è¿è¡Œå°±ä¸ä¼šå ç”¨å†…å­˜ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯è™šæ‹Ÿå†…å­˜ï¼ˆvirtual memoryï¼‰ï¼Œå®ƒèƒ½ä½¿ç¨‹åºåªæœ‰ä¸€éƒ¨åˆ†è°ƒå…¥å†…å­˜çš„æƒ…å†µä¸‹è¿è¡Œ äº¤æ¢å¯èƒ½åœ¨å†…å­˜ä¸­äº§ç”Ÿå¤šä¸ªç©ºé—²åŒºï¼ˆholeï¼‰ã€‚æŠŠè¿›ç¨‹å°½å¯èƒ½é è¿‘ï¼Œå°†è¿™äº›å°çš„é—´éš™åˆå¹¶æˆä¸€å¤§å—ï¼Œè¿™ç§æŠ€æœ¯ç§°ä¸ºå†…å­˜ç´§ç¼©ï¼ˆmemory compactionï¼‰ã€‚é€šå¸¸ä¸è¿›è¡Œè¿™ä¸ªæ“ä½œï¼Œå› ä¸ºå®ƒéœ€è¦è€—è´¹å¤§é‡ CPU æ—¶é—´ å¦‚æœè¿›ç¨‹çš„æ•°æ®æ®µå¯ä»¥å¢é•¿ï¼ˆæ¯”å¦‚ä»å †ä¸­åŠ¨æ€åˆ†é…å†…å­˜ï¼‰ï¼Œè¿›ç¨‹ä¸ç©ºé—²åŒºç›¸é‚»ï¼Œåˆ™å¯ä»¥æŠŠç©ºé—²åŒºåˆ†é…ç»™è¿›ç¨‹ä½¿å…¶å¢å¤§ã€‚å¦‚æœè¿›ç¨‹ä¹‹é—´ç´§ç´§ç›¸é‚»ï¼Œå°±éœ€è¦æŠŠè¦å¢é•¿çš„è¿›ç¨‹ç§»åˆ°å†…å­˜ä¸­ä¸€ä¸ªè¶³å¤Ÿå¤§çš„åŒºåŸŸï¼Œæˆ–è€…æŠŠä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹äº¤æ¢å‡ºå»ä»¥ç”Ÿæˆè¶³å¤Ÿå¤§çš„ç©ºé—²åŒºã€‚å¦‚æœè¿›ç¨‹åœ¨å†…å­˜ä¸­ä¸èƒ½å¢é•¿ï¼Œå¹¶ä¸”ç£ç›˜ä¸Šçš„äº¤æ¢åŒºå·²æ»¡ï¼Œåˆ™è¿™ä¸ªè¿›ç¨‹åªèƒ½æŒ‚èµ·ç›´åˆ°æœ‰ç©ºé—´ç©ºé—²ï¼Œæˆ–è€…ç»“æŸ å¦‚æœå¤§éƒ¨åˆ†è¿›ç¨‹åœ¨è¿è¡Œæ—¶éœ€è¦å¢é•¿ï¼Œä¸ºäº†å‡å°‘å› å†…å­˜åŒºä¸å¤Ÿè€Œå¼•èµ·çš„è¿›ç¨‹äº¤æ¢å’Œç§»åŠ¨å¼€é”€ï¼Œä¸€ç§æ–¹æ³•æ˜¯åœ¨æ¢å…¥æˆ–ç§»åŠ¨è¿›ç¨‹æ—¶é¢å¤–åˆ†é…ä¸€äº›é¢„ç•™å†…å­˜ åŠ¨æ€åˆ†é…å†…å­˜æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»å¯¹å…¶è¿›è¡Œç®¡ç†ï¼Œä¸€èˆ¬è·Ÿè¸ªå†…å­˜ä½¿ç”¨æƒ…å†µæœ‰ä¸¤ç§æ–¹æ³•ï¼šä½å›¾å’Œç©ºé—²åŒºé“¾è¡¨ ä½¿ç”¨ä½å›¾æ³•æ—¶ï¼ŒæŠŠå†…å­˜åˆ’åˆ†æˆåˆ†é…å•å…ƒï¼ˆæ¯ä¸ªå•å…ƒå°åˆ°å‡ ä¸ªå­—èŠ‚æˆ–å¤§åˆ°å‡ åƒå­—èŠ‚ï¼‰ï¼Œç”¨ä½å›¾ä¸­çš„ä¸€ä½æ¥è®°å½•æ¯ä¸ªåˆ†é…å•å…ƒçš„ä½¿ç”¨æƒ…å†µï¼Œæ¯”å¦‚ 0 è¡¨ç¤ºç©ºé—² 1 è¡¨ç¤ºå ç”¨ï¼ˆæˆ–è€…ç›¸åï¼‰ã€‚åˆ†é…å•å…ƒè¶Šå°ï¼Œä½å›¾è¶Šå¤§ï¼Œä¸è¿‡å³ä½¿ 4 ä¸ªå­—èŠ‚å¤§å°çš„åˆ†é…å•å…ƒï¼Œ32 ä½çš„å†…å­˜åªéœ€è¦ 1 ä½ä½å›¾ï¼Œä½å›¾åªå ç”¨äº† 1 / 32 çš„å†…å­˜ ä½å›¾æ³•çš„ä¸»è¦é—®é¢˜æ˜¯ï¼Œåœ¨å†³å®šæŠŠä¸€ä¸ªå  k ä¸ªåˆ†é…å•å…ƒçš„è¿›ç¨‹è°ƒå…¥å†…å­˜æ—¶ï¼Œå­˜å‚¨ç®¡ç†å™¨å¿…é¡»æœç´¢ä½å›¾ï¼Œåœ¨ä½å›¾ä¸­æ‰¾å‡ºæœ‰ k ä¸ªè¿ç»­ 0 çš„ä¸²ï¼Œè¿™ä¸ªæŸ¥æ‰¾æ“ä½œå¾ˆè€—æ—¶ï¼Œå› ä¸ºåœ¨ä½å›¾ä¸­è¯¥ä¸²å¯èƒ½è·¨è¶Šå­—çš„è¾¹ç•Œ å¦ä¸€ä¸ªè®°å½•å†…å­˜ä½¿ç”¨æƒ…å†µçš„æ–¹æ³•æ˜¯ï¼Œç»´æŠ¤ä¸€ä¸ªè®°å½•å·²åˆ†é…å†…å­˜æ®µå’Œç©ºé—²å†…å­˜æ®µçš„é“¾è¡¨ï¼Œé“¾è¡¨ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ªè¿›ç¨‹æˆ–è€…ä¸¤ä¸ªè¿›ç¨‹é—´çš„ä¸€å—ç©ºé—²åŒº ä½¿ç”¨é“¾è¡¨æ³•æ—¶ï¼Œä¸ºè¿›ç¨‹åˆ†é…å†…å­˜çš„æœ€ç®€å•çš„ç®—æ³•æ˜¯é¦–æ¬¡é€‚é…ï¼ˆfirst fitï¼‰ç®—æ³•ï¼Œå­˜å‚¨ç®¡ç†å™¨æ²¿é“¾è¡¨æœç´¢ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç©ºé—²åŒºï¼Œç„¶åå°†ç©ºé—²åŒºåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†ä¸ºè¦åˆ†é…çš„å¤§å°ï¼Œä¾›è¿›ç¨‹ä½¿ç”¨ï¼Œå¦ä¸€éƒ¨åˆ†å½¢æˆæ–°çš„ç©ºé—²åŒº å¯¹é¦–æ¬¡é€‚é…ç®—æ³•è¿›è¡Œå°ä¿®æ”¹å¯ä»¥å¾—åˆ°ä¸‹æ¬¡é€‚é…ï¼ˆnext fitï¼‰ç®—æ³•ï¼ŒåŒºåˆ«æ˜¯åœ¨æ¯æ¬¡æ‰¾åˆ°åˆé€‚çš„ç©ºé—²åŒºæ—¶è®°å½•ä½ç½®ï¼Œè¿™æ ·ä¸‹æ¬¡å°±å¯ä»¥ä»ä¸Šæ¬¡ç»“æŸçš„åœ°æ–¹å¼€å§‹æœç´¢ã€‚Bays çš„ä»¿çœŸç¨‹åºè¯æ˜ä¸‹æ¬¡é€‚é…ç®—æ³•æ€§èƒ½ç•¥ä½äºé¦–æ¬¡é€‚é…ç®—æ³• å¦ä¸€ä¸ªè‘—åå¹¶å¹¿æ³›ä½¿ç”¨çš„ç®—æ³•æ˜¯æœ€ä½³é€‚é…ï¼ˆbest fitï¼‰ç®—æ³•ï¼Œæœç´¢æ•´ä¸ªé“¾è¡¨ï¼Œæ‰¾åˆ°èƒ½å®¹çº³è¿›ç¨‹çš„æœ€å°ç©ºé—²åŒºã€‚å› ä¸ºæ¯æ¬¡éƒ½è¦æœç´¢æ•´ä¸ªé“¾è¡¨ï¼Œæ‰€ä»¥å®ƒæ¯”é¦–æ¬¡é€‚é…ç®—æ³•æ…¢ã€‚æœ‰äº›ä»¤äººæ„å¤–çš„æ˜¯ï¼Œå®ƒæ¯”å‰ä¸¤ç§ç®—æ³•æµªè´¹æ›´å¤šçš„å†…å­˜ï¼Œå› ä¸ºå®ƒä¼šäº§ç”Ÿå¤§é‡æ— ç”¨çš„å°ç©ºé—²åŒºã€‚ä¸ºäº†é¿å…åˆ†è£‚å‡ºå¾ˆå¤šéå¸¸å°çš„ç©ºé—²åŒºï¼Œå¯ä»¥è€ƒè™‘æœ€å·®é€‚é…ï¼ˆworst fitï¼‰ç®—æ³•ï¼Œå³æ€»æ˜¯åˆ†é…æœ€å¤§çš„å¯ç”¨ç©ºé—²åŒºï¼Œä½†ä»¿çœŸç¨‹åºè¡¨æ˜è¿™ä¹Ÿä¸æ˜¯ä¸€ä¸ªå¥½æ–¹æ³• ä¸€ä¸ªæé«˜ç®—æ³•é€Ÿåº¦çš„æ–¹å¼æ˜¯ï¼Œä¸ºè¿›ç¨‹å’Œç©ºé—²åŒºåˆ†åˆ«ç»´æŠ¤é“¾è¡¨ï¼Œä»£ä»·æ˜¯å¢åŠ å¤æ‚åº¦å’Œå†…å­˜é‡Šæ”¾é€Ÿåº¦å˜æ…¢ï¼Œå› ä¸ºå¿…é¡»å°†å›æ”¶çš„æ®µä»è¿›ç¨‹é“¾è¡¨åˆ é™¤å¹¶æ’å…¥åˆ°ç©ºé—²åŒºé“¾è¡¨ å¦‚æœåˆ†åˆ«ç»´æŠ¤è¿›ç¨‹å’Œç©ºé—²åŒºçš„é“¾è¡¨ï¼Œå°±å¯ä»¥å¯¹ç©ºé—²åŒºé“¾è¡¨æŒ‰å¤§å°æ’åºï¼Œä»¥æé«˜æœ€ä½³é€‚é…ç®—æ³•çš„é€Ÿåº¦ï¼Œæ¯”å¦‚æŒ‰ä»å°åˆ°å¤§æ’åºï¼Œç¬¬ä¸€ä¸ªåˆé€‚çš„ç©ºé—´å°±æ˜¯æœ€å°çš„ç©ºé—²åŒºï¼Œå°±æ˜¯æœ€ä½³é€‚é…ã€‚æ’åºåï¼Œé¦–æ¬¡é€‚é…ç®—æ³•ä¸æœ€ä½³é€‚é…ç®—æ³•ä¸€æ ·å¿«ï¼Œä¸‹æ¬¡é€‚é…ç®—æ³•æ— æ„ä¹‰ å•ç‹¬ç»´æŠ¤ç©ºé—²åŒºé“¾è¡¨æ—¶å¯ä»¥åšä¸€ä¸ªå°ä¼˜åŒ–ï¼Œåˆ©ç”¨ç©ºé—²åŒºå­˜å‚¨ä¿¡æ¯ï¼Œæ¯ä¸ªç©ºé—²åŒºçš„ç¬¬ä¸€ä¸ªå­—å°±æ˜¯ç©ºé—²åŒºå¤§å°ï¼Œç¬¬äºŒä¸ªå­—æŒ‡å‘ä¸‹ä¸€ç©ºé—²åŒº å¦ä¸€ç§åˆ†é…ç®—æ³•æ˜¯å¿«é€Ÿåˆ†é…ï¼ˆquick fitï¼‰ç®—æ³•ï¼Œå®ƒä¸ºå¸¸ç”¨å¤§å°çš„ç©ºé—²åŒºç»´æŠ¤å•ç‹¬çš„é“¾è¡¨ï¼Œæ¯”å¦‚é“¾è¡¨ç¬¬ä¸€é¡¹æ˜¯ 4 KB å¤§å°ç©ºé—²åŒºçš„é“¾è¡¨å¤´æŒ‡é’ˆï¼Œç¬¬äºŒé¡¹æ˜¯ 8 KB å¤§å°ç©ºé—²åŒºçš„é“¾è¡¨å¤´æŒ‡é’ˆï¼Œä»¥æ­¤ç±»æ¨ã€‚åƒ 21 KB çš„ç©ºé—²åŒºï¼Œæ—¢å¯ä»¥æ”¾åœ¨ 20 KB çš„é“¾è¡¨ä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨ä¸€ä¸ªä¸“é—¨å­˜æ”¾ç‰¹æ®Šå¤§å°çš„é“¾è¡¨ä¸­ã€‚è¿™ç§ç®—æ³•æŸ¥æ‰¾æŒ‡å®šå¤§å°çš„ç©ºé—²åŒºå¾ˆå¿«ï¼Œä½†åŒæ ·å­˜åœ¨çš„ç¼ºç‚¹æ˜¯ï¼Œè¿›ç¨‹ç»ˆæ­¢æˆ–æ¢å‡ºæ—¶ï¼Œå¯»æ‰¾å®ƒçš„ç›¸é‚»å—å¹¶æŸ¥æ‰¾æ˜¯å¦å¯ä»¥åˆå¹¶çš„è¿‡ç¨‹éå¸¸è´¹æ—¶ï¼Œå¦‚æœä¸åˆå¹¶ï¼Œå†…å­˜å°†å¾ˆå¿«åˆ†è£‚å‡ºå¤§é‡æ— æ³•åˆ©ç”¨çš„å°ç©ºé—²åŒº ","date":"2023-11-19","objectID":"/posts/memorymanagement/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"è™šæ‹Ÿå†…å­˜ å½“ç¨‹åºå¤§åˆ°å†…å­˜æ— æ³•å®¹çº³æ—¶ï¼Œäº¤æ¢æŠ€æœ¯å°±æœ‰æ‰€ç¼ºé™·ï¼Œä¸€ä¸ªå…¸å‹ SATA ç£ç›˜çš„å³°å€¼ä¼ è¾“ç‡é«˜è¾¾æ¯ç§’å‡ ç™¾å…†ï¼Œäº¤æ¢ä¸€ä¸ª 1 GB çš„ç¨‹åºå°±éœ€è¦å¥½å‡ ç§’ ç¨‹åºå¤§äºå†…å­˜çš„é—®é¢˜åœ¨ä¸€äº›åº”ç”¨é¢†åŸŸæ—©å°±å­˜åœ¨äº†ï¼Œæ¯”å¦‚æ¨¡æ‹Ÿå®‡å®™çš„åˆ›å»ºå°±è¦èŠ±è´¹å¤§é‡å†…å­˜ã€‚20 ä¸–çºª 60 å¹´ä»£çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå°†ç¨‹åºåˆ†å‰²ä¸ºå¤šä¸ªè¦†ç›–åŒºï¼ˆoverlayï¼‰ã€‚ç¨‹åºå¼€å§‹è¿è¡Œæ—¶ï¼Œå°†è¦†ç›–ç®¡ç†æ¨¡å—è£…å…¥å†…å­˜ï¼Œè¯¥æ¨¡å—ç«‹åˆ»è£…å…¥å¹¶è¿è¡Œç¬¬ä¸€ä¸ªè¦†ç›–åŒºï¼Œæ‰§è¡Œå®Œæˆåï¼Œç¬¬ä¸€ä¸ªè¦†ç›–åŒºé€šçŸ¥ç®¡ç†æ¨¡å—è£…å…¥ä¸‹ä¸€ä¸ªè¦†ç›–åŒº ç¨‹åºå‘˜å¿…é¡»æŠŠç¨‹åºåˆ†å‰²æˆå¤šä¸ªç‰‡æ®µï¼Œè¿™ä¸ªå·¥ä½œéå¸¸è´¹æ—¶æ¯ç‡¥ï¼Œå¹¶ä¸”æ˜“å‡ºé”™ã€‚ä¸ä¹…åæœ‰äº†è™šæ‹Ÿå†…å­˜ï¼ˆvirtual memoryï¼‰çš„æ–¹æ³•ï¼Œè¿™äº›å·¥ä½œéƒ½å¯ä»¥äº¤ç»™è®¡ç®—æœºå»åš è™šæ‹Ÿå†…å­˜çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œç¨‹åºçš„åœ°å€ç©ºé—´è¢«åˆ†å‰²æˆå¤šä¸ªé¡µï¼ˆpageï¼‰ï¼Œæ¯ä¸€é¡µæœ‰è¿ç»­çš„åœ°å€èŒƒå›´ã€‚è¿™äº›é¡µè¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰é¡µå¿…é¡»åœ¨å†…å­˜ä¸­æ‰èƒ½è¿è¡Œç¨‹åºã€‚å½“ç¨‹åºå¼•ç”¨åˆ°ä¸€éƒ¨åˆ†ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ç©ºé—´æ—¶ï¼Œç”±ç¡¬ä»¶æ‰§è¡Œå¿…è¦çš„æ˜ å°„ã€‚å½“ç¨‹åºå¼•ç”¨åˆ°ä¸€éƒ¨åˆ†ä¸åœ¨ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ç©ºé—´æ—¶ï¼Œç”±æ“ä½œç³»ç»Ÿè´Ÿè´£å°†ç¼ºå¤±çš„éƒ¨åˆ†è£…å…¥ç‰©ç†å†…å­˜å¹¶é‡æ–°æ‰§è¡Œå¤±è´¥çš„æŒ‡ä»¤ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"åˆ†é¡µï¼ˆpagingï¼‰ å¤§éƒ¨åˆ†è™šæ‹Ÿå†…å­˜ç³»ç»Ÿéƒ½ä½¿ç”¨äº†åˆ†é¡µæŠ€æœ¯ ç”±ç¨‹åºäº§ç”Ÿçš„åœ°å€ç§°ä¸ºè™šæ‹Ÿåœ°å€ï¼ˆvirtual addressï¼‰ MOV REG, 1000 ;å°†åœ°å€ä¸º 1000 çš„å†…å­˜å•å…ƒçš„å†…å®¹å¤åˆ¶åˆ° REGï¼Œ1000 æ˜¯è™šæ‹Ÿåœ°å€ è™šæ‹Ÿåœ°å€æ„æˆäº†è™šæ‹Ÿåœ°å€ç©ºé—´ï¼ˆvirtual address spaceï¼‰ã€‚åœ¨æ²¡æœ‰è™šæ‹Ÿå†…å­˜çš„è®¡ç®—æœºä¸Šï¼Œç³»ç»Ÿç›´æ¥å°†è™šæ‹Ÿåœ°å€é€åˆ°å†…å­˜æ€»çº¿ä¸Šï¼Œè¯»å†™æ“ä½œä½¿ç”¨ç›¸åŒåœ°å€çš„ç‰©ç†å†…å­˜å­—ã€‚åœ¨ä½¿ç”¨è™šæ‹Ÿå†…å­˜æ—¶ï¼Œè™šæ‹Ÿåœ°å€è¢«é€åˆ°å†…å­˜ç®¡ç†å•å…ƒï¼ˆMemory Management Unitï¼ŒMMUï¼‰ï¼ŒMMU æŠŠè™šæ‹Ÿåœ°å€æ˜ å°„ä¸ºç‰©ç†å†…å­˜åœ°å€ é¡µè¡¨ç»™å‡ºè™šæ‹Ÿåœ°å€ä¸ç‰©ç†å†…å­˜åœ°å€ä¹‹é—´çš„æ˜ å°„å…³ç³» è™šæ‹Ÿåœ°å€ç©ºé—´æŒ‰å›ºå®šå¤§å°åˆ’åˆ†ä¸ºé¡µé¢ï¼ˆpageï¼‰ï¼Œç‰©ç†å†…å­˜ä¸­å¯¹åº”çš„å•å…ƒç§°ä¸ºé¡µæ¡†ï¼ˆpage frameï¼‰ï¼Œé¡µé¢å’Œé¡µæ¡†çš„å¤§å°é€šå¸¸ç›¸åŒï¼Œé¡µè¡¨è¯´æ˜äº†æ¯ä¸ªé¡µé¢å¯¹åº”çš„é¡µæ¡†ã€‚RAM å’Œç£ç›˜ä¹‹é—´çš„äº¤æ¢æ€»æ˜¯ä»¥æ•´ä¸ªé¡µé¢ä¸ºå•å…ƒè¿›è¡Œçš„ å¯¹åº” 64 KB çš„è™šæ‹Ÿåœ°å€ç©ºé—´å’Œ 32 KB çš„ç‰©ç†å†…å­˜ï¼Œå¯ä»¥å¾—åˆ° 16 ä¸ªé¡µé¢å’Œ 8 ä¸ªé¡µæ¡† æ¯”å¦‚æ‰§è¡ŒæŒ‡ä»¤è®¿é—®åœ°å€ 0 æ—¶ MOV REG, 0 è™šæ‹Ÿåœ°å€ 0 è¢«é€åˆ° MMUï¼ŒMMU å‘ç°å…¶ä½äºé¡µé¢ 0ï¼ˆ0 - 4095ï¼‰ï¼Œæ ¹æ®æ˜ å°„ç»“æœï¼Œé¡µé¢ 0 å¯¹åº”é¡µæ¡† 2ï¼ˆ8192 - 12287ï¼‰ï¼Œäºæ˜¯ MMU å°†åœ°å€è½¬æ¢ä¸º 8192ï¼Œå¹¶æŠŠåœ°å€ 8192 é€åˆ°æ€»çº¿ä¸Šã€‚å†…å­˜å¹¶ä¸éœ€è¦çŸ¥é“ MMU åšçš„äº‹ï¼Œåªçœ‹åˆ°ä¸€ä¸ªè®¿é—®åœ°å€ 8192 çš„è¯·æ±‚å¹¶æ‰§è¡Œ å½“è™šæ‹Ÿåœ°å€ç©ºé—´æ¯”ç‰©ç†å†…å­˜å¤§æ—¶ï¼Œå°±ä¼šå­˜åœ¨æœªè¢«æ˜ å°„çš„é¡µé¢ã€‚å½“ç¨‹åºæ‰§è¡ŒæŒ‡ä»¤è®¿é—®æœªæ˜ å°„çš„é¡µé¢ MOV REG, 32780 ;ä½äºé¡µé¢ 8ï¼ˆä» 32768 å¼€å§‹ï¼‰ MMU å‘ç°è¯¥é¡µé¢æœªè¢«æ˜ å°„ï¼Œäºæ˜¯ä½¿ CPU é™·å…¥ï¼ˆtrapsï¼‰åˆ°æ“ä½œç³»ç»Ÿï¼Œè¿™ç§°ä¸ºç¼ºé¡µä¸­æ–­ï¼ˆpage faultï¼‰ã€‚æ“ä½œç³»ç»Ÿæ‰¾åˆ°ä¸€ä¸ªå¾ˆå°‘ä½¿ç”¨çš„é¡µæ¡†å¹¶æŠŠå…¶å†…å®¹å†™å…¥ç£ç›˜ï¼Œæ¯”å¦‚æ‰¾åˆ°é¡µé¢ 1 å¯¹åº”çš„é¡µæ¡† 1ã€‚å°†é¡µé¢ 1 æ ‡è®°ä¸ºæœªæ˜ å°„ï¼Œå†æŠŠé¡µé¢ 8 æ˜ å°„åˆ°è¿™ä¸ªé¡µæ¡† 1ï¼Œç„¶åé‡æ–°å¯åŠ¨è®¿é—®æŒ‡ä»¤ï¼Œæ­¤æ—¶è™šæ‹Ÿåœ°å€ 32780 å°±å¯ä»¥æ˜ å°„åˆ°ç‰©ç†åœ°å€ 4108ï¼ˆ4096 + 32780 - 32768ï¼‰ é¡µé¢å¤§å°ä¸€èˆ¬æ˜¯ 2 çš„æ•´æ•°æ¬¡å¹‚ã€‚æ¯”å¦‚é¡µé¢å¤§å°ä¸º 4 KBï¼Œå³ 2 ^ 12ï¼Œå¯¹äºä¸€ä¸ª 16 ä½çš„è™šæ‹Ÿåœ°å€ï¼Œå³å¯ç”¨å‰ 4 ä½è¡¨ç¤ºé¡µé¢çš„é¡µå·ï¼Œå 12 ä½è¡¨ç¤ºåç§»é‡ã€‚æ¯”å¦‚è™šæ‹Ÿåœ°å€ 8192ï¼ŒäºŒè¿›åˆ¶ä¸º 0010 0000 0000 0100ï¼Œ0010 å³ä¸ºé¡µå·ï¼Œ0000 0000 0100 å³ä¸ºåç§»ï¼Œå› æ­¤ 8192 ä½äºé¡µå· 2 åç§» 4 çš„ä½ç½® é¡µè¡¨ä¸­ï¼ŒæŸ¥æ‰¾é¡µå· 2 å¯¹åº”çš„é¡µæ¡†å·ä¸º 6ï¼ŒæŠŠé¡µæ¡†å· 110 å¤åˆ¶åˆ°è¾“å‡ºå¯„å­˜å™¨çš„é«˜ 3 ä½ï¼Œå 12 ä½ä¿æŒä¸å˜ï¼Œ110 0000 0000 0100 å³ä¸ºç‰©ç†åœ°å€ é™¤äº†é¡µæ¡†å·ï¼Œé¡µè¡¨è¿˜ä¼šæœ‰ä¸€äº›å…¶ä»–çš„ä½ æœ‰æ•ˆä½ï¼Œå¦‚æœè¯¥ä½ä¸º 1 åˆ™è¯´æ˜å­˜åœ¨æ˜ å°„ï¼Œå¦‚æœä¸º 0ï¼Œåˆ™è®¿é—®è¯¥é¡µé¢å°†å¼•èµ·ç¼ºé¡µä¸­æ–­ ä¿æŠ¤ï¼ˆprotectionï¼‰ä½ï¼ŒæŒ‡å‡ºä¸€ä¸ªé¡µå…è®¸çš„è®¿é—®æ–¹å¼ï¼Œæ¯”å¦‚ç”¨ä¸€ä¸ªä½è¡¨ç¤ºï¼Œ0 è¡¨ç¤ºè¯»å†™ï¼Œ1 è¡¨ç¤ºåªè¯» ä¿®æ”¹ï¼ˆmodifiedï¼‰ä½ï¼Œè®°å½•é¡µé¢ä½¿ç”¨æƒ…å†µï¼Œå†™å…¥é¡µé¢åç”±ç¡¬ä»¶è‡ªåŠ¨è®¾ç½®ä¿®æ”¹ä½ï¼Œè¯¥ä½ä¹Ÿç§°ä¸ºè„ä½ï¼ˆdirty bitï¼‰ï¼Œåœ¨é‡æ–°åˆ†é…é¡µæ¡†æ—¶å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ä¸€ä¸ªé¡µæ˜¯è„çš„ï¼ˆå·²è¢«ä¿®æ”¹è¿‡ï¼‰ï¼Œåˆ™å¿…é¡»æŠŠå®ƒå†™å›ç£ç›˜ï¼Œæ˜¯å¹²å‡€çš„åˆ™å¯ä»¥ç›´æ¥ä¸¢å¼ƒ è®¿é—®ï¼ˆreferencedï¼‰ä½ï¼Œåœ¨é¡µé¢è¢«è®¿é—®æ—¶è®¾ç½®ï¼Œä¸»è¦ç”¨æ¥å¸®åŠ©æ“ä½œç³»ç»Ÿåœ¨å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶é€‰æ‹©è¦æ·˜æ±°çš„é¡µé¢ ç¦æ­¢é«˜é€Ÿç¼“å­˜ä½ï¼Œè¯¥ä½å¯¹äºæ˜ å°„åˆ°è®¾å¤‡å¯„å­˜å™¨è€Œéå¸¸è§„å†…å­˜çš„é¡µé¢ååˆ†é‡è¦ï¼Œæ¯”å¦‚æ“ä½œç³»ç»ŸæŒç»­ç­‰å¾… I/O è®¾å¤‡çš„å“åº”ï¼Œå¿…é¡»ä¿è¯ç¡¬ä»¶è¯»å–çš„æ•°æ®æ¥è‡ªè®¾å¤‡è€Œéé«˜é€Ÿç¼“å­˜ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:4:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"åŠ é€Ÿåˆ†é¡µè¿‡ç¨‹ åœ¨ä»»ä½•åˆ†é¡µç³»ç»Ÿä¸­éƒ½éœ€è¦è€ƒè™‘ä¸¤ä¸ªé—®é¢˜ è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„å¿…é¡»éå¸¸å¿«ï¼šæ¯æ¬¡è®¿é—®å†…å­˜éƒ½è¦è¿›è¡Œæ˜ å°„ï¼Œæ‰€æœ‰çš„æŒ‡ä»¤æœ€ç»ˆéƒ½æ¥è‡ªå†…å­˜ï¼Œå¹¶ä¸”å¾ˆå¤šæŒ‡ä»¤ä¹Ÿä¼šè®¿é—®å†…å­˜ä¸­çš„æ“ä½œæ•°ï¼Œå› æ­¤æ¯æ¡æŒ‡ä»¤è¿›è¡Œä¸€ä¸¤æ¬¡æˆ–æ›´å¤šé¡µè¡¨è®¿é—®æ˜¯å¿…è¦çš„ã€‚å¦‚æœæŒ‡ä»¤ä¸€æ¡æŒ‡ä»¤è¦ 1 nsï¼Œé¡µè¡¨æŸ¥è¯¢å¿…é¡»åœ¨ 0.2 ns å†…å®Œæˆï¼Œä»¥é¿å…æ˜ å°„æˆä¸ºä¸»è¦ç“¶é¢ˆ å¦‚æœè™šæ‹Ÿåœ°å€ç©ºé—´å¾ˆå¤§ï¼Œé¡µè¡¨ä¹Ÿä¼šå¾ˆå¤§ï¼šç°ä»£è®¡ç®—æœºè‡³å°‘ä½¿ç”¨ 32 ä½è™šæ‹Ÿåœ°å€ï¼Œå‡è®¾é¡µé¢å¤§å°ä¸º 4 KBï¼Œ32 ä½çš„åœ°å€ç©ºé—´å°†æœ‰ 100 ä¸‡é¡µï¼Œé¡µè¡¨ä¹Ÿå¿…ç„¶æœ‰ 100 ä¸‡æ¡è¡¨é¡¹ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œéƒ½éœ€è¦è‡ªå·±çš„é¡µè¡¨ï¼Œäºæ˜¯éœ€è¦ä¸ºè¿›ç¨‹åˆ†é…éå¸¸å¤šçš„è¿ç»­é¡µæ¡† å¤§å¤šæ•°ç¨‹åºæ€»æ˜¯å¯¹å°‘é‡é¡µé¢å¤šæ¬¡è®¿é—®ï¼Œæ²¡æœ‰å¿…è¦è®©å°†æ•´ä¸ªé¡µè¡¨ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç”±æ­¤å¾—å‡ºçš„ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œè®¾ç½®ä¸€ä¸ªè½¬æ¢æ£€æµ‹ç¼“å†²åŒºï¼ˆTranslation Lookaside Bufferï¼ŒTLBï¼‰ï¼Œä¹Ÿç§°ç›¸è”å­˜å‚¨å™¨ï¼ˆassociate memoryï¼‰æˆ–å¿«è¡¨ï¼Œå°†è™šæ‹Ÿå†…å­˜ç›´æ¥æ˜ å°„åˆ°ç‰©ç†åœ°å€ï¼Œè€Œä¸å¿…å†è®¿é—®é¡µè¡¨ TLB é€šå¸¸åœ¨ MMU ä¸­ï¼ŒåŒ…å«å°‘é‡è¡¨é¡¹ï¼Œå®é™…ä¸­å¾ˆå°‘ä¼šè¶…è¿‡ 256 ä¸ªã€‚å°†ä¸€ä¸ªè™šæ‹Ÿåœ°å€æ”¾å…¥ MMU ä¸­è¿›è¡Œè½¬æ¢æ—¶ï¼Œç¡¬ä»¶å…ˆå°†é¡µå·ä¸ TLB ä¸­æ‰€æœ‰è¡¨é¡¹è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸä¸”æ“ä½œä¸è¿åä¿æŠ¤ä½ï¼Œåˆ™ç›´æ¥ä» TLB ä¸­å–å‡ºé¡µæ¡†å·ï¼Œè€Œä¸å†è®¿é—®é¡µè¡¨ã€‚å¦‚æœåŒ¹é…å¤±è´¥ï¼Œåˆ™è¿›è¡Œæ­£å¸¸çš„é¡µè¡¨æŸ¥è¯¢ï¼Œå¹¶ä» TLB æ·˜æ±°ä¸€ä¸ªè¡¨é¡¹ï¼Œç„¶åç”¨æ–°æ‰¾åˆ°çš„é¡µè¡¨é¡¹ä»£æ›¿å®ƒ å¤„ç†å·¨å¤§çš„è™šæ‹Ÿåœ°å€ç©ºé—´æœ‰ä¸¤ç§è§£å†³æ–¹æ³•ï¼šå¤šçº§é¡µè¡¨å’Œå€’æ’é¡µè¡¨ æ¯”å¦‚ 32 ä½åœ°å€ç©ºé—´ä¸­ï¼Œé¡µé¢å¤§å°ä¸º 4 KBï¼Œåç§»é‡å  12 ä½ï¼Œåˆ™é¡µå·å  20 ä½ã€‚å°†é¡µå·åˆ†ç»„ï¼Œé¡µè¡¨é¡¹å¤§å°ä¸º 4 Bï¼Œ4 KB çš„é¡µé¢å°±èƒ½æ”¾ 1024 ä¸ªè¡¨é¡¹ï¼Œäºæ˜¯æ¯ 1024 ä¸ªé¡µå·åˆ†ä¸ºä¸€ç»„ã€‚è¿™æ ·åˆ†ç»„å¾—åˆ°çš„é¡µè¡¨ä¸ºäºŒçº§é¡µè¡¨ï¼Œå†ç”¨ä¸€ä¸ªé¡¶çº§é¡µè¡¨æ˜ å°„é¡µå·åˆ°äºŒçº§é¡µè¡¨çš„ç‰©ç†åœ°å€å³å¯ ä½¿ç”¨å¤šçº§é¡µè¡¨æ—¶ï¼Œ32 ä½çš„åœ°å€åˆ’åˆ†ä¸º 10 ä½çš„ PT1 åŸŸã€10 ä½çš„ PT2 åŸŸã€12 ä½çš„ Offset åŸŸã€‚æ¯”å¦‚å¯¹äºè™šæ‹Ÿåœ°å€ 0000 0000 0100 0000 0011 0000 0000 0100ï¼ŒPT1 ä¸º 1ï¼ŒPT2 ä¸º 3ï¼ŒOffset ä¸º 4ï¼ŒMMU å…ˆè®¿é—®é¡¶çº§é¡µè¡¨ 1 å¤„ï¼Œå¾—åˆ°äºŒçº§é¡µè¡¨çš„ç‰©ç†åœ°å€ï¼Œç”±æ­¤è®¿é—®äºŒçº§é¡µè¡¨ 3 å¤„ï¼Œå¾—åˆ°é¡µæ¡†å·ï¼Œæœ€ååŠ ä¸Š Offset å³ä¸ºæœ€ç»ˆçš„ç‰©ç†åœ°å€ äºŒçº§é¡µè¡¨å¯ä»¥æ‰©å……ä¸ºæ›´å¤šçº§ã€‚æ¯çº§é¡µè¡¨å¤§å°ä¸èƒ½è¶…è¿‡ä¸€ä¸ªé¡µé¢ï¼Œæ¯”å¦‚ 4 KB é¡µé¢ï¼Œåç§»ä¸º 12 ä½ï¼Œé¡µè¡¨é¡¹å¤§å°ä¸º 4 Bï¼Œæ¯ 1024 åˆ†ä¸ºä¸€ç»„ï¼Œåˆ™æ¯çº§æœ€å¤š 10 ä½ï¼Œå¦‚æœæ˜¯ 40 ä½ï¼Œåˆ™é™¤å» 12 ä½ï¼Œå‰©ä½™å¯ä»¥åˆ’åˆ†ä¸ºä¸€çº§ 8 ä½ã€äºŒçº§ 10 ä½ã€ä¸‰çº§ 10 ä½çš„ä¸‰çº§é¡µè¡¨ å•çº§é¡µè¡¨åªè¦è¿›è¡Œä¸¤æ¬¡è®¿å­˜ï¼ˆç¬¬ä¸€æ¬¡è®¿é—®é¡µè¡¨å¾—åˆ°ç‰©ç†åœ°å€ï¼Œç¬¬äºŒæ¬¡è®¿é—®ç‰©ç†åœ°å€ï¼‰ï¼Œè€Œæ¯å¤šä¸€çº§é¡µè¡¨å°±è¦å¤šä¸€æ¬¡è®¿å­˜ï¼ˆä¸è€ƒè™‘ TLBï¼‰ å¦ä¸€ç§æ–¹å¼æ˜¯å€’æ’é¡µè¡¨ï¼ˆinverted page tableï¼‰ï¼Œè®©æ¯ä¸ªé¡µæ¡†ï¼ˆè€Œéé¡µé¢ï¼‰å¯¹åº”ä¸€ä¸ªè¡¨é¡¹ã€‚æ¯”å¦‚å¯¹äº 64 ä½è™šæ‹Ÿåœ°å€ï¼Œ4 KB çš„é¡µï¼Œ4 GB çš„ RAMï¼Œä¸€ä¸ªå€’æ’é¡µè¡¨ä»…éœ€è¦ 2 ^ 20 ä¸ªè¡¨é¡¹ï¼Œè¡¨é¡¹è®°å½•äº†ä¸€ä¸ªé¡µæ¡†å¯¹åº”çš„é¡µé¢ï¼ˆè¿›ç¨‹ï¼‰ è™½ç„¶å€’æ’é¡µè¡¨èŠ‚çœäº†å¤§é‡ç©ºé—´ï¼Œä½†ä»è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢å˜å¾—å¾ˆå›°éš¾ï¼Œå¿…é¡»æœç´¢æ•´ä¸ªå€’æ’é¡µè¡¨æ¥æ‰¾åˆ°é¡µé¢ï¼Œæ¯ä¸€æ¬¡æœç´¢éƒ½è¦æ‰§è¡Œè®¿é—®æ“ä½œã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ TLB è§£å†³ å€’æ’é¡µè¡¨åœ¨ 64 ä½æœºå™¨ä¸­å¾ˆå¸¸è§ï¼Œå› ä¸º 64 ä½æœºå™¨ä¸­ï¼Œå³ä½¿ä½¿ç”¨å¤§é¡µé¢é¡µè¡¨é¡¹æ•°é‡ä¹Ÿå¾ˆåºå¤§ï¼Œæ¯”å¦‚å¯¹äº 4 MB é¡µé¢å’Œ 64 ä½è™šæ‹Ÿåœ°å€ï¼Œéœ€è¦çš„é¡µè¡¨é¡¹ç›®æ•°ä¸º 2 ^ 42 ","date":"2023-11-19","objectID":"/posts/memorymanagement/:5:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"é¡µé¢ç½®æ¢ç®—æ³• å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»æ¢å‡ºå†…å­˜ä¸­çš„ä¸€ä¸ªé¡µé¢ï¼Œä»¥è…¾å‡ºç©ºé—´ã€‚å¦‚æœæ¢å‡ºçš„é¡µé¢åœ¨å†…å­˜é©»ç•™æœŸé—´è¢«ä¿®æ”¹è¿‡ï¼Œå°±å¿…é¡»æŠŠå®ƒå†™å›ç£ç›˜ä»¥æ›´æ–°å…¶åœ¨ç£ç›˜ä¸Šçš„å‰¯æœ¬ï¼Œå¦‚æœæœªè¢«ä¿®æ”¹è¿‡åˆ™ä¸éœ€è¦å†™å› å¦‚æœä¸€ä¸ªç»å¸¸ç”¨åˆ°çš„é¡µé¢è¢«æ¢å‡ºå†…å­˜ï¼ŒçŸ­æ—¶é—´å†…å®ƒå¯èƒ½åˆè¢«è°ƒå…¥å†…å­˜ï¼Œè¿™ä¼šå¸¦æ¥ä¸å¿…è¦çš„å¼€é”€ã€‚å› æ­¤å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œå¦‚ä½•é€‰æ‹©è¦æ¢å‡ºçš„é¡µé¢æ˜¯ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„é—®é¢˜ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•ï¼ˆOPTimal replacementï¼ŒOPTï¼‰ OPT ç®—æ³•çš„æ€è·¯å¾ˆç®€å•ï¼Œä»æ‰€æœ‰é¡µé¢ä¸­é€‰å‡ºä¸‹æ¬¡è®¿é—®æ—¶é—´è·ç°åœ¨æœ€ä¹…çš„æ·˜æ±° 432143543215 // é¡µé¢é˜Ÿåˆ— 444444444222 // é¡µ 1 33333333311 // é¡µ 2 2111555555 // é¡µ 3 TTTT T TT // æ˜¯å¦å‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼ˆå…±å‘ç”Ÿ 7 æ¬¡ç¼ºé¡µä¸­æ–­ï¼Œ4 æ¬¡é¡µé¢ç½®æ¢ï¼‰ | æŠŠ 2 æ›¿æ¢æ‰ï¼Œå› ä¸º 432 ä¸­ï¼Œ2 ä¸‹ä¸€æ¬¡è¢«è®¿é—®çš„æ—¶é—´æœ€é å è¿™ä¸ªç®—æ³•çš„å”¯ä¸€é—®é¢˜åœ¨äºï¼Œå®ƒæ˜¯æ— æ³•å®ç°çš„ï¼Œå› ä¸ºå‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ— æ³•å¾—çŸ¥å„ä¸ªé¡µé¢ä¸‹ä¸€æ¬¡åœ¨ä»€ä¹ˆæ—¶å€™è¢«è®¿é—® ä½œä¸ºç†è®ºæœ€ä¼˜ç®—æ³•ï¼Œå¯ä»¥ç”¨å®ƒè¡¡é‡å…¶ä»–ç®—æ³•çš„æ€§èƒ½ã€‚å¦‚æœæ“ä½œç³»ç»Ÿçš„é¡µé¢ç½®æ¢æ€§èƒ½åªæ¯”æœ€ä¼˜ç®—æ³•å·® 1%ï¼Œé‚£ä¹ˆèŠ±è´¹å¤§é‡ç²¾åŠ›æ¥ä¼˜åŒ–ç®—æ³•å°±ä¸æ˜¯ç‰¹åˆ«å¿…è¦çš„ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"æœ€è¿‘æœªä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•ï¼ˆNot Recently Usedï¼ŒNRUï¼‰ æ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªé¡µé¢è®¾ç½®äº†ä¸¤ä¸ªçŠ¶æ€ä½ï¼Œå½“é¡µé¢è¢«è®¿é—®æ—¶è®¾ç½® R ä½ï¼Œè¢«ä¿®æ”¹æ—¶è®¾ç½® M ä½ã€‚å¯åŠ¨è¿›ç¨‹æ—¶ï¼Œæ‰€æœ‰é¡µé¢çš„ RM å‡è®¾ä¸º 0ï¼Œå¹¶ä¸” R è¢«å®šæœŸï¼ˆæ¯”å¦‚æ¯æ¬¡æ—¶é’Ÿä¸­æ–­æ—¶ï¼‰æ¸…é›¶ å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œæ ¹æ® RM ä½çš„å€¼ï¼Œå¯ä»¥å°†é¡µé¢åˆ†ä¸º 4 ç±» ç¬¬ 0 ç±»ï¼šæœªè®¿é—®æœªä¿®æ”¹ï¼ˆR ä½ä¸º 0ï¼ŒM ä½ä¸º 0ï¼‰ ç¬¬ 1 ç±»ï¼šæœªè®¿é—®å·²ä¿®æ”¹ï¼ˆR ä½ä¸º 0ï¼ŒM ä½ä¸º 1ï¼Œçœ‹èµ·æ¥ä¼¼ä¹ä¸å¯èƒ½ï¼Œå®é™…å¯ä»¥ç”±ç¬¬ 3 ç±»è½¬æ¢è€Œæ¥ï¼‰ ç¬¬ 2 ç±»ï¼šå·²è®¿é—®æœªä¿®æ”¹ï¼ˆR ä½ä¸º 1ï¼ŒM ä½ä¸º 0ï¼‰ ç¬¬ 3 ç±»ï¼šå·²è®¿é—®å·²ä¿®æ”¹ï¼ˆR ä½ä¸º 1ï¼ŒM ä½ä¸º 1ï¼ŒR åœ¨æ¸…é›¶åå³å˜ä¸ºç¬¬ 1 ç±»ï¼‰ NRU ç®—æ³•éšæœºä»ç¬¬0ç±»ä¸­é€‰æ‹©ä¸€ä¸ªé¡µé¢æ·˜æ±°ï¼Œå¦‚æœç¬¬ 0 ç±»ä¸­æ²¡æœ‰é¡µé¢åˆ™é€‰æ‹©ç¬¬ 1 ç±»ï¼Œä»¥æ­¤ç±»æ¨ï¼Œä¼˜å…ˆé€‰æ‹©ç¼–å·æœ€å°çš„ç±» è¿™ä¸ªç®—æ³•çš„éšå«æ€æƒ³æ˜¯ï¼Œæ·˜æ±°ä¸€ä¸ªæœªè®¿é—®å·²ä¿®æ”¹é¡µé¢ï¼ˆç¬¬ 1 ç±»ï¼‰ï¼Œæ¯”æ·˜æ±°ä¸€ä¸ªé¢‘ç¹ä½¿ç”¨çš„å¹²å‡€é¡µé¢ï¼ˆç¬¬ 2 ç±»ï¼‰å¥½ NRU çš„ä¸»è¦ä¼˜ç‚¹æ˜¯æ˜“ç†è§£ä¸”èƒ½æœ‰æ•ˆå®ç°ï¼Œè™½ç„¶æ€§èƒ½ä¸æ˜¯æœ€å¥½çš„ï¼Œä½†å·²ç»å¤Ÿç”¨äº† ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"å…ˆè¿›å…ˆå‡ºé¡µé¢ç½®æ¢ç®—æ³•ï¼ˆFirst-In First-Outï¼ŒFIFOï¼‰ é¡¾åæ€ä¹‰ï¼Œæ·˜æ±°æœ€æ—©è¿›å…¥çš„é¡µé¢ æ“ä½œç³»ç»Ÿç»´æŠ¤ä¸€ä¸ªå†…å­˜ä¸­æ‰€æœ‰å½“å‰é¡µé¢çš„é“¾è¡¨ï¼Œæœ€æ–°è¿›å…¥çš„é¡µé¢æ”¾åœ¨è¡¨å°¾ï¼Œæ·˜æ±°é¡µé¢å°±æ˜¯è¡¨å¤´é¡µé¢ FIFO å¯èƒ½æ·˜æ±°å¸¸ç”¨é¡µé¢ï¼Œç”šè‡³å¯èƒ½å‡ºç°åˆ†é…é¡µé¢æ•°å¢å¤šä½†ç¼ºé¡µç‡åè€Œæé«˜çš„å¼‚å¸¸ç°è±¡ï¼ˆBelady å¼‚å¸¸ï¼‰ï¼Œå› æ­¤å¾ˆå°‘ä½¿ç”¨çº¯ç²¹çš„ FIFO ç®—æ³• ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"ç¬¬äºŒæ¬¡æœºä¼šé¡µé¢ç½®æ¢ç®—æ³•ï¼ˆSecond-Chanceï¼‰ å¯¹ FIFO åšä¸€ä¸ªç®€å•çš„ä¿®æ”¹ï¼šæ£€æŸ¥æœ€è€é¡µé¢çš„ R ä½ï¼ˆè®¿é—®ä½ï¼‰ï¼Œå¦‚æœ R ä½æ˜¯ 0 åˆ™æ·˜æ±°ï¼Œå¦‚æœæ˜¯ 1 åˆ™æŠŠ R ä½æ¸…é›¶ï¼Œå¹¶æŠŠè¯¥é¡µé¢æ”¾åˆ°è¡¨å°¾ï¼Œç„¶åç»§ç»­æœç´¢ å¦‚æœæ‰€æœ‰é¡µé¢éƒ½è¢«è®¿é—®è¿‡ï¼Œåˆ™è¯¥ç®—æ³•å°±ç®€åŒ–ä¸ºçº¯ç²¹çš„ FIFO ç®—æ³• ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•ï¼ˆclockï¼‰ ç¬¬äºŒæ¬¡æœºä¼šç®—æ³•ç»å¸¸è¦åœ¨é“¾è¡¨ä¸­ç§»åŠ¨é¡µé¢ï¼Œé™ä½äº†æ•ˆç‡ä¸”ä¸æ˜¯å¾ˆæœ‰å¿…è¦ ä¸€ä¸ªæ›´å¥½çš„åŠæ³•æ˜¯å°†æ‰€æœ‰é¡µé¢ä¿å­˜åœ¨åœ¨ä¸€ä¸ªç±»ä¼¼é’Ÿé¢çš„ç¯å½¢é“¾è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨é’ˆæŒ‡å‘æœ€è€çš„é¡µé¢ã€‚å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œæ£€æŸ¥è¡¨é’ˆæŒ‡å‘çš„é¡µé¢ï¼Œå¦‚æœ R ä½æ˜¯ 0 åˆ™æ·˜æ±°è¯¥é¡µé¢ï¼Œå¹¶åœ¨è¯¥ä½ç½®æ’å…¥æ–°é¡µé¢ï¼Œç„¶åè¡¨é’ˆåç§»ä¸€æ­¥ã€‚å¦‚æœ R ä½æ˜¯ 1 åˆ™æŠŠ R ä½æ¸…é›¶ï¼Œç„¶åè¡¨é’ˆåç§»ä¸€æ­¥ã€‚å¦‚æœè¯¥é¡µå·²å­˜åœ¨ï¼Œä¸å‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼ŒR ä½æ˜¯ 0 åˆ™æ”¹ä¸º 1ï¼Œè¡¨é’ˆä¸éœ€è¦ç§»åŠ¨ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:5","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"æœ€è¿‘æœ€å°‘ä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•ï¼ˆLeast Recently Usedï¼ŒLRUï¼‰ LRU æ˜¯ OPT çš„ä¸€ä¸ªè¿‘ä¼¼æ€è·¯ï¼Œåœ¨å‰å‡ æ¡æŒ‡ä»¤ä¸­é¢‘ç¹ä½¿ç”¨çš„é¡µé¢å¾ˆå¯èƒ½åœ¨åå‡ æ¡æŒ‡ä»¤ä¸­è¢«ä½¿ç”¨ï¼Œåè¿‡æ¥è¯´ï¼Œå¾ˆä¹…æ²¡ä½¿ç”¨çš„é¡µé¢å¾ˆå¯èƒ½åœ¨ä¹‹åçš„é•¿æ—¶é—´å†…ä»ç„¶ä¸ä½¿ç”¨ LRU æ˜¯å¯å®ç°çš„ï¼Œä½†ä»£ä»·å¾ˆé«˜ã€‚å®ç° LRU éœ€è¦ç»´æŠ¤ä¸€ä¸ªæ‰€æœ‰é¡µé¢çš„é“¾è¡¨ï¼Œæœ€å¸¸ä½¿ç”¨çš„ä½äºè¡¨å¤´ï¼Œæ¯æ¬¡è®¿é—®æ—¶å¿…é¡»æ›´æ–°æ•´ä¸ªé“¾è¡¨ï¼Œåœ¨é“¾è¡¨ä¸­æ‰¾åˆ°é¡µé¢åˆ é™¤åå†æ·»åŠ åˆ°è¡¨å¤´ æœ‰ä¸€äº›ä½¿ç”¨ç‰¹æ®Šç¡¬ä»¶å®ç° LRU çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¦æ±‚ç¡¬ä»¶æœ‰ä¸€ä¸ª 64 ä½è®¡æ•°å™¨ï¼Œå®ƒåœ¨æ¯æ¡æŒ‡ä»¤æ‰§è¡Œå®ŒååŠ  1ï¼Œæ¯ä¸ªé¡µè¡¨é¡¹ä¸­æœ‰ä¸€ä¸ªè¶³å¤Ÿå®¹çº³è¿™ä¸ªè®¡æ•°å™¨å€¼çš„åŸŸã€‚å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œæ£€æŸ¥æ‰€æœ‰é¡µè¡¨é¡¹çš„è®¡æ•°å€¼ï¼Œå€¼æœ€å°çš„å°±æ˜¯æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ åªæœ‰éå¸¸å°‘çš„è®¡ç®—æœºæœ‰è¿™ç§ç¡¬ä»¶ï¼ŒLRU å¾ˆä¼˜ç§€ä½†å¾ˆéš¾å®ç° ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:6","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"æœ€ä¸å¸¸ç”¨é¡µé¢ç½®æ¢ç®—æ³•ï¼ˆNot Frequently Usedï¼ŒNFUï¼‰ NFU æ˜¯ LRU çš„ä¸€ä¸ªè½¯ä»¶å®ç°æ–¹æ¡ˆ NFU å°†æ¯ä¸ªé¡µé¢ä¸ä¸€ä¸ªè½¯ä»¶è®¡æ•°å™¨å…³è”ï¼Œè®¡æ•°å™¨åˆå€¼ä¸º 0ï¼Œæ¯æ¬¡æ—¶é’Ÿä¸­æ–­æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰«æå†…å­˜ä¸­æ‰€æœ‰é¡µé¢ï¼Œå°†æ¯ä¸ªé¡µé¢çš„ R ä½å€¼åŠ åˆ°è®¡æ•°å™¨ä¸Šï¼Œè¿™ä¸ªè®¡æ•°å™¨å¤§è‡´è·Ÿè¸ªäº†å„ä¸ªé¡µé¢è¢«è®¿é—®çš„é¢‘ç¹ç¨‹åº¦ã€‚å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œåˆ™ç½®æ¢è®¡æ•°å™¨å€¼æœ€å°çš„é¡µé¢ NFU çš„é—®é¢˜åœ¨äºï¼Œç¬¬ä¸€éæ‰«æä¸­é¢‘ç¹ä½¿ç”¨çš„é¡µé¢ï¼Œç¬¬äºŒéæ‰«ææ—¶ï¼Œè®¡æ•°å™¨å€¼ä»ç„¶å¾ˆé«˜ã€‚è¿™å°±ä¼šå¯¼è‡´åç»­æ‰«æä¸­ï¼Œå³ä½¿è¯¥é¡µé¢ä½¿ç”¨æ¬¡æ•°æœ€å°‘ï¼Œä¹Ÿä¼šç”±äºè®¡æ•°å™¨å€¼è¾ƒé«˜è€Œä¸è¢«ç½®æ¢ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:7","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"è€åŒ–ï¼ˆagingï¼‰ç®—æ³• è€åŒ–ç®—æ³•å¯¹ NFU åšäº†ä¸€äº›æ”¹è¿›ï¼Œåœ¨Rä½åŠ è¿›ä¹‹å‰å…ˆå°†è®¡æ•°å™¨å³ç§»ä¸€ä½ï¼Œç„¶åæŠŠ R ä½åŠ åˆ°è®¡æ•°å™¨æœ€å·¦ç«¯çš„ä½ é¡µé¢ 0 10000000 11000000 11100000 11110000 01111000 1 00000000 10000000 11000000 01100000 10110000 2 10000000 01000000 00100000 00100000 10001000 3 00000000 00000000 10000000 01000000 00100000 4 10000000 11000000 01100000 10110000 01011000 5 10000000 01000000 10100000 01010000 00101000 | | | | | è®¿é—®é¡µé¢ 024 è®¿é—® 014 è®¿é—® 013 è®¿é—® 04 è®¿é—® 12 å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œç½®æ¢è®¡æ•°å™¨å€¼æœ€å°çš„é¡µé¢ï¼Œå› ä¸ºå‰é¢çš„ 0 è¶Šå¤šï¼Œè¯´æ˜å…¶æœ€è¿‘è¶Šä¸å¸¸è¢«è®¿é—® è€åŒ–ç®—æ³•éå¸¸è¿‘ä¼¼ LRUï¼Œä½†æœ‰ä¸¤ä¸ªåŒºåˆ« æ¯”å¦‚æœ€åä¸€æ¬¡è®¿é—®æ—¶ï¼Œå¦‚æœå‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œéœ€è¦ç½®æ¢ä¸€ä¸ªé¡µé¢ã€‚é¡µé¢ 3 å’Œé¡µé¢ 5 å¼€å¤´éƒ½æ˜¯ 001ï¼Œå³å‰ä¸¤æ¬¡æœªè¢«è®¿é—®ï¼Œå‰ç¬¬ä¸‰æ¬¡è¢«è®¿é—®ï¼Œå¦‚æœå‰ç¬¬ä¸‰æ¬¡æ˜¯é¡µé¢ 5 å…ˆè¢«è®¿é—®ï¼Œåˆ™ LRU ä¼šæ›¿æ¢é¡µé¢ 5ï¼Œä½†è¿™é‡Œæ— æ³•åŒºåˆ†ä¸¤è€…è°å…ˆè¢«è®¿é—®ï¼Œè€Œåªèƒ½æ›¿æ¢å€¼è¾ƒå°çš„é¡µé¢ 3 è€åŒ–ç®—æ³•è®¡æ•°å™¨ä½æ•°æœ‰é™ï¼Œæ¯”å¦‚è¿™é‡Œæ˜¯ 8 ä½ï¼Œåªèƒ½è®°å½•è¿‡å» 8 æ¬¡çš„è®¿é—®ï¼Œè¶…è¿‡è¯¥æ¬¡æ•°çš„è®°å½•æ— æ³•å¾—çŸ¥ã€‚ä¸è¿‡å®è·µä¸­ï¼Œå¦‚æœæ—¶é’Ÿæ»´ç­”æ˜¯ 20 msï¼Œ8 ä½ä¸€èˆ¬æ˜¯å¤Ÿç”¨çš„ï¼Œå¦‚æœä¸€ä¸ªé¡µé¢ 160 ms æœªè¢«è®¿é—®ï¼Œåˆ™å¾ˆå¯èƒ½ä¸é‡è¦ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:8","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"å·¥ä½œé›†é¡µé¢ç½®æ¢ç®—æ³• åœ¨å•çº¯çš„åˆ†é¡µç³»ç»Ÿä¸­ï¼Œåˆšå¼€å§‹å¯åŠ¨è¿›ç¨‹æ—¶ï¼Œå†…å­˜ä¸­æ²¡æœ‰é¡µé¢ï¼ŒCPU å°è¯•å–ç¬¬ä¸€æ¡æŒ‡ä»¤æ—¶å°±ä¼šäº§ç”Ÿä¸€æ¬¡ç¼ºé¡µä¸­æ–­ï¼Œä½¿æ“ä½œç³»ç»Ÿè£…å…¥å«ç¬¬ä¸€æ¡æŒ‡ä»¤çš„é¡µé¢ã€‚ä¸€æ®µæ—¶é—´åï¼Œè¿›ç¨‹éœ€è¦çš„å¤§éƒ¨åˆ†é¡µé¢éƒ½åœ¨å†…å­˜äº†ï¼Œè¿›ç¨‹å¼€å§‹åœ¨è¾ƒå°‘ç¼ºé¡µä¸­æ–­çš„æƒ…å†µä¸‹è¿è¡Œã€‚è¿™ä¸ªç­–ç•¥ç§°ä¸ºè¯·æ±‚è°ƒé¡µï¼ˆdemand pagingï¼‰ï¼Œå› ä¸ºé¡µé¢åœ¨éœ€è¦æ—¶è¢«è°ƒå…¥ï¼Œè€Œä¸æ˜¯é¢„å…ˆè£…å…¥ ä¸€ä¸ªè¿›ç¨‹å½“å‰æ­£åœ¨ä½¿ç”¨çš„é¡µé¢é›†åˆç§°ä¸ºå®ƒçš„å·¥ä½œé›†ï¼ˆDenningï¼‰ï¼Œå¦‚æœæ•´ä¸ªå·¥ä½œé›†éƒ½è¢«è£…å…¥å†…å­˜ä¸­ï¼Œé‚£ä¹ˆè¿›ç¨‹åœ¨è¿è¡Œåˆ°ä¸‹ä¸€é˜¶æ®µä¹‹å‰ä¸ä¼šäº§ç”Ÿå¾ˆå¤šç¼ºé¡µä¸­æ–­ã€‚å¦‚æœå†…å­˜å¤ªå°æ— æ³•å®¹çº³æ•´ä¸ªå·¥ä½œé›†ï¼Œè¿›ç¨‹çš„è¿è¡Œè¿‡ç¨‹ä¸­å°†äº§ç”Ÿå¤§é‡ç¼ºé¡µä¸­æ–­ï¼Œå¯¼è‡´è¿è¡Œé€Ÿåº¦å˜æ…¢ï¼Œå› ä¸ºé€šå¸¸æ‰§è¡Œä¸€æ¡æŒ‡ä»¤åªè¦å‡ çº³ç§’ï¼Œè€Œä»ç£ç›˜è¯»å…¥ä¸€ä¸ªé¡µé¢éœ€è¦åå‡ æ¯«ç§’ã€‚å¦‚æœæ¯æ‰§è¡Œå‡ æ¡æŒ‡ä»¤å°±å‘ç”Ÿä¸€æ¬¡ç¼ºé¡µä¸­æ–­ï¼Œå°±ç§°è¿™ä¸ªç¨‹åºå‘ç”Ÿäº†é¢ ç°¸ï¼ˆDenningï¼‰ è¯·æ±‚è°ƒé¡µç­–ç•¥ä¸­ï¼Œæ¯æ¬¡è£…å…¥ä¸€ä¸ªè¿›ç¨‹éƒ½è¦äº§ç”Ÿå¤§é‡ç¼ºé¡µä¸­æ–­ï¼Œé€Ÿåº¦å¤ªæ…¢ï¼Œå¹¶ä¸” CPU èŠ±äº†å¾ˆå¤šæ—¶é—´å¤„ç†ç¼ºé¡µä¸­æ–­ï¼Œæµªè´¹äº†è®¸å¤š CPU æ—¶é—´ï¼Œå› æ­¤ä¸å°‘åˆ†é¡µç³»ç»Ÿä¼šè®¾æ³•è·Ÿè¸ªå·¥ä½œé›†ï¼Œä»¥ç¡®ä¿åœ¨è¿›ç¨‹è¿è¡Œå‰ï¼Œå·¥ä½œé›†å·²ç»åœ¨å†…å­˜ä¸­äº†ï¼Œè¿™ä¸ªæ–¹æ³•ç§°ä¸ºå·¥ä½œé›†æ¨¡å‹ï¼ˆDenningï¼‰ï¼Œä¹Ÿå«é¢„å…ˆè°ƒé¡µï¼ˆprepagingï¼‰ï¼Œå…¶ç›®çš„åœ¨äºå¤§å¤§å‡å°‘ç¼ºé¡µä¸­æ–­ç‡ å·¥ä½œé›†æ˜¯éšç€æ—¶é—´å˜åŒ–çš„ï¼Œå®ƒæ˜¯æœ€è¿‘kæ¬¡è®¿å­˜æ‰€è®¿é—®è¿‡çš„é¡µé¢é›†åˆã€‚ä¸ºäº†å®ç°è¯¥ç®—æ³•ï¼Œéœ€è¦ä¸€ç§ç²¾ç¡®çš„æ–¹æ³•æ¥ç¡®å®šå“ªäº›é¡µé¢åœ¨å·¥ä½œé›†ä¸­ï¼Œä¸ºæ­¤å¿…é¡»é¢„å…ˆé€‰å®š k å€¼ã€‚ä½†æœ‰äº†å·¥ä½œé›†çš„å®šä¹‰å¹¶ä¸æ„å‘³ç€å°±èƒ½è®¡ç®—å‡ºå·¥ä½œé›† å‡è®¾æœ‰ä¸€ä¸ªé•¿åº¦ä¸º k çš„ç§»ä½å¯„å­˜å™¨ï¼Œæ¯æ¬¡è®¿å­˜éƒ½æŠŠå¯„å­˜å™¨å·¦ç§»ä¸€ä½ï¼Œç„¶ååœ¨æœ€å³ç«¯æ’å…¥åˆšæ‰è®¿é—®è¿‡çš„é¡µé¢å·ï¼Œå¯„å­˜å™¨ä¸­ k ä¸ªé¡µé¢å·çš„é›†åˆå°±æ˜¯å·¥ä½œé›†ã€‚ç†è®ºä¸Šï¼Œå‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œåªè¦è¯»å‡ºå¯„å­˜å™¨ä¸­çš„å†…å®¹å¹¶æ’åºï¼Œç„¶ååˆ é™¤é‡å¤çš„é¡µé¢ï¼Œç»“æœå°±æ˜¯å·¥ä½œé›†ã€‚ä½†ç»´æŠ¤è¯¥å¯„å­˜å™¨å¹¶åœ¨ç¼ºé¡µä¸­æ–­æ—¶å¤„ç†å®ƒéœ€è¦å¾ˆå¤§çš„å¼€é”€ï¼Œå› æ­¤è¯¥æŠ€æœ¯ä»æœªè¢«ä½¿ç”¨è¿‡ æœ‰å‡ ç§è¿‘ä¼¼çš„æ–¹æ³•ä½œä¸ºæ›¿ä»£ï¼Œä¸€ç§å¸¸è§è¿‘ä¼¼æ–¹æ³•æ˜¯ï¼Œä¸å‘åæŸ¥æ‰¾æœ€è¿‘ k æ¬¡çš„å†…å­˜è®¿é—®ï¼Œè€Œæ˜¯æŸ¥æ‰¾è¿‡å»ä¸€å®šæ—¶é—´å†…ï¼Œæ¯”å¦‚è¿‡å» 10 ms è®¿å­˜æ‰€ç”¨åˆ°çš„é¡µé¢é›†åˆ åŸºäºå·¥ä½œé›†çš„é¡µé¢ç½®æ¢ç®—æ³•æ˜¯ï¼Œæ‰¾å‡ºä¸€ä¸ªä¸åœ¨å·¥ä½œé›†ä¸­çš„é¡µé¢å¹¶æ·˜æ±°ï¼Œä¸ºæ­¤è¡¨é¡¹ä¸­è‡³å°‘éœ€è¦åŒ…å«ä¸¤æ¡ä¿¡æ¯ï¼Œä¸€æ˜¯ä¸Šæ¬¡ä½¿ç”¨è¯¥é¡µé¢çš„è¿‘ä¼¼æ—¶é—´ï¼ŒäºŒæ˜¯ R ä½ï¼ˆè®¿é—®ä½ï¼‰ å¤„ç†è¡¨é¡¹æ—¶ï¼Œå¦‚æœ R ä½æ˜¯ 1ï¼Œåˆ™æŠŠä¸Šæ¬¡ä½¿ç”¨æ—¶é—´æ”¹ä¸ºå½“å‰å®é™…æ—¶é—´ã€‚å¦‚æœ R ä½æ˜¯ 0ï¼Œåˆ™å¯ä»¥ä½œä¸ºç½®æ¢å€™é€‰è€…ï¼Œè®¡ç®—ç”Ÿå­˜æ—¶é—´ï¼ˆå½“å‰å®é™…æ—¶é—´ä¸ä¸Šæ¬¡ä½¿ç”¨æ—¶é—´çš„å·®ï¼‰ï¼Œå¦‚æœç”Ÿå­˜æ—¶é—´å¤§äºå®šä¹‰å·¥ä½œé›†èŒƒå›´çš„æ—¶é—´ï¼Œåˆ™è¯¥é¡µé¢åœ¨å·¥ä½œé›†å¤–ï¼Œå°†å…¶ç½®æ¢ã€‚å¦‚æœ R ä¸º 0 ä¸”ç”Ÿå­˜æ—¶é—´ä¸è¶…è¿‡å®šä¹‰å·¥ä½œé›†èŒƒå›´çš„æ—¶é—´ï¼Œåˆ™è¯¥é¡µé¢ä»åœ¨å·¥ä½œé›†ä¸­ï¼Œè®°å½•è¯¥é¡µé¢ã€‚å¦‚æœæ‰«æå®Œæ•´ä¸ªé¡µè¡¨éƒ½æ²¡æœ‰å¯æ·˜æ±°çš„ï¼Œåˆ™ä»è®°å½•é¡µé¢ä¸­é€‰ä¸€ä¸ªç”Ÿå­˜æ—¶é—´æœ€é•¿çš„æ·˜æ±°ï¼Œå¦‚æœè®°å½•é¡µé¢ä¸ºç©ºï¼Œå³æ‰€æœ‰é¡µé¢ R ä½å‡ä¸º 1ï¼Œåˆ™éšæœºé€‰æ‹©ä¸€ä¸ªæ·˜æ±° ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:9","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"å·¥ä½œé›†æ—¶é’Ÿï¼ˆWSClockï¼‰é¡µé¢ç½®æ¢ç®—æ³• å·¥ä½œé›†ç®—æ³•éœ€è¦æ‰«ææ•´ä¸ªé¡µè¡¨ï¼Œæ¯”è¾ƒè´¹æ—¶ï¼Œç»“åˆæ—¶é’Ÿç®—æ³•çš„æ€è·¯ç¨ä½œæ”¹è¿›ï¼Œå³å¯å¾—åˆ° WSClock ç®—æ³•ã€‚å®ƒå®ç°ç®€å•ï¼Œæ€§èƒ½è¾ƒå¥½ï¼Œåœ¨å®é™…å·¥ä½œä¸­å¾—åˆ°äº†å¹¿æ³›ä½¿ç”¨ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:6:10","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"åˆ†æ®µï¼ˆSegmentationï¼‰ ä¸€ä¸ªç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šå»ºç«‹è®¸å¤šè¡¨ï¼Œå…¶ä¸­å¯èƒ½åŒ…æ‹¬ è¢«ä¿å­˜èµ·æ¥ä¾›æ‰“å°æ¸…å•ç”¨çš„æºç¨‹åºæ­£æ–‡ï¼ˆç”¨äºæ‰¹å¤„ç†ç³»ç»Ÿï¼‰ åŒ…å«å˜é‡åå­—å’Œå±æ€§çš„ç¬¦å·è¡¨ åŒ…å«ç”¨åˆ°çš„æ‰€æœ‰æ•´å‹é‡å’Œæµ®ç‚¹å¸¸é‡çš„è¡¨ åŒ…å«ç¨‹åºè¯­æ³•åˆ†æç»“æœçš„è¯­æ³•åˆ†ææ ‘ ç¼–è¯‘å™¨å†…éƒ¨è¿‡ç¨‹è°ƒç”¨ä½¿ç”¨çš„å †æ ˆ åœ¨ä¸€ç»´åœ°å€ç©ºé—´ä¸­ï¼Œå½“æœ‰å¤šä¸ªåŠ¨æ€å¢åŠ çš„è¡¨æ—¶ï¼Œå°±å¯èƒ½å‘ç”Ÿç¢°æ’ã€‚ä¸€ç§èƒ½ä»¤ç¨‹åºå‘˜ä¸ç”¨ç®¡ç†è¡¨æ‰©å¼ å’Œæ”¶ç¼©çš„æ–¹æ³•æ˜¯ï¼Œåœ¨æœºå™¨ä¸Šæä¾›å¤šä¸ªäº’ç›¸ç‹¬ç«‹çš„æ®µï¼ˆsegmentï¼‰çš„åœ°å€ç©ºé—´ï¼Œæ®µçš„é•¿åº¦å¯ä»¥ä¸åŒï¼Œåœ¨è¿è¡Œæ—¶å¯ä»¥æ”¹å˜ï¼Œæ¯”å¦‚å †æ ˆæ®µçš„é•¿åº¦åœ¨æ•°æ®å‹å…¥æ—¶ä¼šå¢é•¿ï¼Œåœ¨æ•°æ®å¼¹å‡ºæ—¶ä¼šå‡å° æ¯ä¸ªæ®µéƒ½æ„æˆä¸€ä¸ªç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œåœ¨å†…å­˜ä¸­å æ®è¿ç»­ç©ºé—´ï¼Œå¯ä»¥ç‹¬ç«‹åœ°å¢é•¿æˆ–å‡å°ï¼Œè€Œä¸ä¼šå½±å“å…¶ä»–æ®µ æ®µæ˜¯æŒ‰é€»è¾‘åŠŸèƒ½çš„åˆ’åˆ†çš„å®ä½“ï¼Œç¨‹åºå‘˜ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼Œå¹¶ä¸”ç¨‹åºçš„å¯è¯»æ€§æ›´é«˜ã€‚æ­¤å¤–ï¼Œåˆ†æ®µæœ‰åŠ©äºå…±äº«å’Œä¿æŠ¤ã€‚åˆ†æ®µç³»ç»Ÿä¸­ï¼Œå¯ä»¥æŠŠå…±äº«åº“æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„æ®µä¸­ç”±å„ä¸ªè¿›ç¨‹å…±äº«ï¼Œè€Œä¸éœ€è¦åœ¨æ¯ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ä¿å­˜ä¸€ä»½ã€‚å½“ç»„æˆä¸€ä¸ªç¨‹åºçš„æ‰€æœ‰è¿‡ç¨‹éƒ½è¢«ç¼–è¯‘å’Œé“¾æ¥å¥½ä»¥åï¼Œå¦‚æœä¸€ä¸ªæ®µçš„è¿‡ç¨‹è¢«ä¿®æ”¹å¹¶é‡æ–°ç¼–è¯‘ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°å…¶ä»–æ®µï¼Œå› ä¸ºè¿™ä¸ªæ®µçš„èµ·å§‹åœ°å€ï¼ˆåŸºå€ï¼‰æ²¡æœ‰è¢«ä¿®æ”¹ è¦åœ¨åˆ†æ®µçš„å­˜å‚¨å™¨ä¸­è¡¨ç¤ºä¸€ä¸ªåœ°å€ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªæ®µå·ï¼ˆæ®µåï¼‰å’Œä¸€ä¸ªæ®µå†…åœ°å€ï¼ˆæ®µå†…åç§»é‡ï¼‰ 31 ... 16 15 ... 0 // å¯ç”¨ 31 - 16 è¡¨ç¤ºæ®µå·ï¼Œ15 - 0 è¡¨ç¤ºæ®µå†…åœ°å€ æ¯ä¸ªè¿›ç¨‹éœ€è¦ä¸€å¼ æ®µè¡¨ï¼Œæ¯ä¸ªæ®µè¡¨é¡¹è®°å½•ä¸€ä¸ªæ®µçš„èµ·å§‹ä½ç½®å’Œæ®µçš„é•¿åº¦ã€‚æ®µè¡¨é¡¹é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œå› æ­¤æ®µå·å¯ä»¥æ˜¯éšå«çš„ï¼Œä¸å å­˜å‚¨ç©ºé—´ã€‚æŸ¥æ‰¾æ—¶ï¼Œå¦‚æœæ®µå·è¶Šç•Œï¼Œåˆ™äº§ç”Ÿè¶Šç•Œä¸­æ–­ã€‚å¦‚æœæ®µå†…åœ°å€è¶…å‡ºæ®µé•¿ï¼Œåˆ™äº§ç”Ÿè¶Šç•Œä¸­æ–­ K å·æ®µçš„æ®µè¡¨å­˜æ”¾åœ°å€ = æ®µè¡¨èµ·å§‹ä½ç½® + K * æ®µè¡¨é¡¹é•¿åº¦ æ®µå· åŸºå€ æ®µé•¿ 0 20K 3K 1 60K 2K 2 40K 5K å¦‚æœä¸€ä¸ªé€»è¾‘åœ°å€æ®µå·ä¸º 1ï¼Œæ®µå†…åœ°å€ä¸º 1024 æ®µå· 1 çš„æ®µé•¿ä¸º 2Kï¼Œå¤§äº 1024ï¼Œä¸äº§ç”Ÿè¶Šç•Œä¸­æ–­ å­˜æ”¾åœ°å€ = 60K + 1024 = 61K åˆ†æ®µç®¡ç†çš„ç¼ºç‚¹æ˜¯ï¼Œå¦‚æœæ®µé•¿è¿‡å¤§ï¼Œåˆ™ä¸ä¾¿äºåˆ†é…è¿ç»­ç©ºé—´ï¼Œæ­¤å¤–ä¼šäº§ç”Ÿå¤–éƒ¨ç¢ç‰‡ã€‚åˆ†é¡µç®¡ç†çš„å†…å­˜åˆ©ç”¨ç‡é«˜ï¼Œä¸ä¼šäº§ç”Ÿå¤–éƒ¨ç¢ç‰‡ï¼Œåªä¼šæœ‰å°‘é‡é¡µå†…ç¢ç‰‡ã€‚å› æ­¤ï¼Œä¸¤è€…ç»“åˆå¯ä»¥äº’ç›¸å¼¥è¡¥ï¼Œå®ç°æ®µé¡µå¼ç®¡ç† æ®µé¡µå¼ç³»ç»Ÿçš„åœ°å€ç”±æ®µå·ã€é¡µå·ã€é¡µå†…åœ°å€ï¼ˆé¡µå†…åç§»é‡ï¼‰ç»„æˆã€‚åˆ†æ®µå¯¹ç”¨æˆ·å¯è§ï¼Œè€Œåˆ†é¡µä¸å¯è§ 31 ... 16 15 ... 12 11 ... 0 // å¯ç”¨ 31 - 16 è¡¨ç¤ºæ®µå·ï¼Œ15 - 12 è¡¨ç¤ºé¡µå·ï¼Œ11 - 0 è¡¨ç¤ºé¡µå†…åœ°å€ æ¯ä¸ªæ®µè¡¨é¡¹è®°å½•é¡µè¡¨é•¿åº¦ã€é¡µè¡¨èµ·å§‹åœ°å€ï¼Œé€šè¿‡é¡µè¡¨èµ·å§‹åœ°å€æ‰¾åˆ°é¡µå·ï¼Œé€šè¿‡é¡µå·å¯¹åº”çš„é¡µè¡¨é¡¹ç›®æ‰¾åˆ°ç‰©ç†åœ°å€ï¼Œä¸€å…±éœ€è¦ä¸‰æ¬¡è®¿å­˜ï¼ˆå¦‚æœå¼•å…¥ä»¥æ®µå·å’Œé¡µå·ä¸ºå…³é”®å­—çš„ TLB ä¸”å‘½ä¸­ï¼Œåˆ™åªéœ€è¦ä¸€æ¬¡è®¿å­˜ï¼‰ã€‚æ®µè¡¨é¡¹é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œæ®µå·å¯ä»¥æ˜¯éšå«çš„ã€‚åŒæ ·ï¼Œæ¯ä¸ªé¡µè¡¨é¡¹é•¿åº¦å›ºå®šï¼Œé¡µå·æ˜¯éšå«çš„ ","date":"2023-11-19","objectID":"/posts/memorymanagement/:7:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Memory Management","uri":"/posts/memorymanagement/"},{"categories":["C++"],"content":"I/O ç¡¬ä»¶åŸç† I/O è®¾å¤‡å°±æ˜¯å¯ä»¥å°†æ•°æ®è¾“å…¥åˆ°è®¡ç®—æœº(å¦‚é¼ æ ‡ã€é”®ç›˜)ï¼Œæˆ–è€…å¯ä»¥æ¥æ”¶è®¡ç®—æœºè¾“å‡ºæ•°æ®çš„å¤–éƒ¨è®¾å¤‡(å¦‚æ˜¾ç¤ºå™¨) I/O è®¾å¤‡æŒ‰ä¿¡æ¯äº¤æ¢å•ä½å¯åˆ†ä¸ºä¸¤ç±» å—è®¾å¤‡(block device)ï¼šæŠŠä¿¡æ¯å­˜å‚¨åœ¨å›ºå®šå¤§å°çš„å—ä¸­ï¼Œæ¯ä¸ªå—éƒ½æœ‰è‡ªå·±çš„åœ°å€ã€‚å—è®¾å¤‡çš„åŸºæœ¬ç‰¹å¾æ˜¯ï¼Œä¼ è¾“é€Ÿç‡å¿«ï¼Œå¯å¯»å€ï¼Œæ¯ä¸ªå—éƒ½èƒ½ç‹¬ç«‹äºå…¶ä»–å—è€Œè¯»å†™ã€‚ç£ç›˜å°±æ˜¯æœ€å¸¸è§çš„å—å¯å¯»å€è®¾å¤‡ï¼Œæ— è®ºç£ç›˜è‡‚å½“å‰å¤„äºä»€ä¹ˆä½ç½®ï¼Œæ€»æ˜¯èƒ½å¯»å€å…¶ä»–æŸ±é¢å¹¶ä¸”ç­‰å¾…æ‰€éœ€è¦çš„ç£ç›˜å—æ—‹è½¬åˆ°ç£å¤´ä¸‹é¢ å­—ç¬¦è®¾å¤‡(character device)ï¼šä»¥å­—ç¬¦ä¸ºå•ä½å‘é€æˆ–æ¥æ”¶ä¸€ä¸ªå­—ç¬¦æµï¼Œè€Œä¸è€ƒè™‘ä»»ä½•å—ç»“æ„ï¼Œå› æ­¤ä¼ è¾“é€Ÿç‡è¾ƒæ…¢ï¼Œä¸å¯å¯»å€ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•å¯»é“æ“ä½œï¼Œåœ¨è¾“å…¥/è¾“å‡ºæ—¶å¸¸é‡‡ç”¨ä¸­æ–­é©±åŠ¨æ–¹å¼ã€‚æ‰“å°æœºã€é¼ æ ‡å°±æ˜¯å¸¸è§çš„å­—ç¬¦è®¾å¤‡ I/O è®¾å¤‡ä¸€èˆ¬ç”±æœºæ¢°éƒ¨ä»¶å’Œç”µå­éƒ¨ä»¶ä¸¤éƒ¨åˆ†ç»„æˆ æœºæ¢°éƒ¨ä»¶ä¸»è¦ç”¨äºæ‰§è¡Œå…·ä½“ I/O æ“ä½œï¼Œå¦‚é¼ æ ‡çš„æŒ‰é’®ã€é”®ç›˜çš„æŒ‰é”®ã€æ˜¾ç¤ºå™¨çš„å±å¹•ã€ç¡¬ç›˜çš„ç£ç›˜è‡‚ ç”µå­éƒ¨ä»¶ä¹Ÿç§°ä½œè®¾å¤‡æ§åˆ¶å™¨(device controller)æˆ–é€‚é…å™¨(adapter)ï¼Œé€šå¸¸æ˜¯ä¸»æ¿ä¸Šçš„èŠ¯ç‰‡ï¼Œæˆ–ä¸€å—æ’å…¥ä¸»æ¿æ‰©å……æ§½çš„å°åˆ·ç”µè·¯æ¿ CPU æ— æ³•ç›´æ¥æ§åˆ¶æœºæ¢°éƒ¨ä»¶ï¼Œå› æ­¤éœ€è¦é€šè¿‡è®¾å¤‡æ§åˆ¶å™¨ä½œä¸ºä¸­ä»‹æ¥æ§åˆ¶æœºæ¢°éƒ¨ä»¶ã€‚è®¾å¤‡æ§åˆ¶å™¨çš„ä¸»è¦åŠŸèƒ½æœ‰ æ¥æ”¶å’Œè¯†åˆ« CPU å‘å‡ºçš„å‘½ä»¤ï¼šæ¯ä¸ªæ§åˆ¶å™¨æœ‰å‡ ä¸ªå¯„å­˜å™¨ç”¨äºä¸ CPU é€šä¿¡ï¼Œé€šè¿‡å†™å…¥è¿™äº›å¯„å­˜å™¨ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥å‘½ä»¤è®¾å¤‡å‘é€æ•°æ®ã€æ¥æ”¶æ•°æ®ã€å¼€å¯æˆ–å…³é—­ï¼Œæˆ–è€…æ‰§è¡Œå…¶ä»–æŸäº›æ“ä½œ å‘ CPU æŠ¥å‘Šè®¾å¤‡çš„çŠ¶æ€ï¼šé€šè¿‡è¯»å–è¿™äº›å¯„å­˜å™¨ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥äº†è§£è®¾å¤‡çš„çŠ¶æ€ï¼Œæ˜¯å¦å‡†å¤‡å¥½æ¥æ”¶ä¸€ä¸ªæ–°çš„å‘½ä»¤ç­‰ æ•°æ®äº¤æ¢ï¼šé™¤äº†æ§åˆ¶å¯„å­˜å™¨å¤–ï¼Œè®¸å¤šè®¾å¤‡è¿˜æœ‰ä¸€ä¸ªæ“ä½œç³»ç»Ÿå¯ä»¥è¯»å†™çš„æ•°æ®ç¼“å†²åŒºï¼Œæ¯”å¦‚åœ¨å±å¹•ä¸Šæ˜¾ç¤ºåƒç´ çš„å¸¸è§„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªè§†é¢‘ RAMï¼Œè¿™ä¸€ RAM åŸºæœ¬ä¸Šåªæ˜¯ä¸€ä¸ªæ•°æ®ç¼“å†²åŒºï¼Œå¯ä¾›ç¨‹åºæˆ–æ“ä½œç³»ç»Ÿå†™å…¥æ•°æ® åœ°å€è¯†åˆ«ï¼šä¸ºäº†åŒºåˆ†è®¾å¤‡æ§åˆ¶å™¨ä¸­çš„å¯„å­˜å™¨ï¼Œéœ€è¦ç»™æ¯ä¸ªå¯„å­˜å™¨è®¾ç½®ä¸€ä¸ªåœ°å€ï¼Œæ§åˆ¶å™¨é€šè¿‡ CPU æä¾›çš„åœ°å€æ¥åˆ¤æ–­ CPU è¦è®¿é—®çš„å¯„å­˜å™¨ è®¾å¤‡æ§åˆ¶å™¨ä¸­æœ‰å¤šä¸ªå¯„å­˜å™¨ï¼Œä¸ºè¿™äº›å¯„å­˜å™¨ç¼–å€æœ‰ä¸¤ç§æ–¹å¼ å†…å­˜æ˜ å°„ I/O(memory-mapped I/O)ï¼šæ‰€æœ‰è®¾å¤‡æ§åˆ¶å™¨çš„å¯„å­˜å™¨æ˜ å°„åˆ°å†…å­˜ç©ºé—´ä¸­ï¼Œæ¯ä¸ªæ§åˆ¶å¯„å­˜å™¨è¢«åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„å†…å­˜åœ°å€ï¼Œå¹¶ä¸”ä¸ä¼šæœ‰å†…å­˜è¢«åˆ†é…åˆ°è¿™ä¸€åœ°å€ å¯„å­˜å™¨ç‹¬ç«‹ç¼–å€ï¼šæ¯ä¸ªå¯„å­˜å™¨è¢«åˆ†é…ä¸€ä¸ª I/O ç«¯å£(port)å·ï¼Œæ‰€æœ‰ç«¯å£å·å½¢æˆ I/O ç«¯å£ç©ºé—´(I/O port space)ï¼Œå¹¶ä¸”å—åˆ°ä¿æŠ¤ä½¿å¾—æ™®é€šç”¨æˆ·ç¨‹åºä¸èƒ½å¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œåªæœ‰æ“ä½œç³»ç»Ÿå¯ä»¥è®¿é—®ã€‚è¿™ä¸€æ–¹æ¡ˆä¸­ï¼Œå†…å­˜åœ°å€ç©ºé—´å’Œ I/O åœ°å€ç©ºé—´æ˜¯ä¸åŒä¸”ä¸ç›¸å…³çš„ ","date":"2023-11-19","objectID":"/posts/io/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | IO","uri":"/posts/io/"},{"categories":["C++"],"content":"I/O è½¯ä»¶åŸç† I/O è½¯ä»¶çš„è®¾è®¡æœ‰ä»¥ä¸‹ç›®æ ‡ è®¾å¤‡ç‹¬ç«‹æ€§(device independence)ï¼šå…è®¸ç¼–å†™å‡ºçš„ç¨‹åºå¯ä»¥è®¿é—®ä»»æ„ I/O è®¾å¤‡è€Œæ— éœ€äº‹å…ˆæŒ‡å®šè®¾å¤‡ï¼Œæ¯”å¦‚è¯»å–ä¸€ä¸ªæ–‡ä»¶ä½œä¸ºè¾“å…¥çš„ç¨‹åºï¼Œåº”è¯¥èƒ½åœ¨ç¡¬ç›˜ã€DVD æˆ– USB ç›˜ä¸Šè¯»å–æ–‡ä»¶ï¼Œæ— éœ€ä¸ºæ¯ä¸€ç§ä¸åŒçš„è®¾å¤‡ä¿®æ”¹ç¨‹åº ç»Ÿä¸€å‘½å(uniform naming)ï¼šä¸€ä¸ªæ–‡ä»¶æˆ–ä¸€ä¸ªè®¾å¤‡çš„åå­—åº”è¯¥æ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²æˆ–ä¸€ä¸ªæ•´æ•°ï¼Œä¸åº”ä¾èµ–äºè®¾å¤‡ é”™è¯¯å¤„ç†(error handling)ï¼šä¸€èˆ¬æ¥è¯´ï¼Œé”™è¯¯åº”è¯¥å°½å¯èƒ½åœ¨æ¥è¿‘ç¡¬ä»¶çš„å±‚é¢å¾—åˆ°å¤„ç†ã€‚å½“æ§åˆ¶å™¨å‘ç°ä¸€ä¸ªè¯»é”™è¯¯æ—¶ï¼Œå¦‚æœå®ƒèƒ½å¤Ÿå¤„ç†ï¼Œå°±åº”è¯¥è‡ªå·±è®¾æ³•çº æ­£é”™è¯¯ã€‚å¦‚æœæ§åˆ¶å™¨å¤„ç†ä¸äº†ï¼Œè®¾å¤‡é©±åŠ¨ç¨‹åºå°±åº”å½“äºˆä»¥å¤„ç†ï¼Œå¯èƒ½åªéœ€è¦é‡è¯»ä¸€æ¬¡è¿™å—æ•°æ®å°±æ­£ç¡®äº† åŒæ­¥(synchronousï¼Œå³é˜»å¡)å’Œå¼‚æ­¥(asynchronousï¼Œå³ä¸­æ–­é©±åŠ¨)ä¼ è¾“ï¼šå¤§å¤šæ•°ç‰©ç† I/O æ˜¯å¼‚æ­¥çš„ï¼Œæ¯”å¦‚ CPU å¯åŠ¨ä¼ è¾“åä¾¿è½¬å»åšå…¶ä»–å·¥ä½œï¼Œç›´åˆ°ä¸­æ–­å‘ç”Ÿã€‚å¦‚æœ I/O æ“ä½œæ˜¯é˜»å¡çš„ï¼Œç”¨æˆ·ç¨‹åºå°±æ›´å®¹æ˜“ç¼–å†™ï¼Œæ¯”å¦‚ read ç³»ç»Ÿè°ƒç”¨ä¹‹åç¨‹åºå°†è‡ªåŠ¨è¢«æŒ‚èµ·ï¼Œç›´åˆ°ç¼“å†²åŒºä¸­çš„æ•°æ®å‡†å¤‡å¥½ï¼Œè€Œæ­£æ˜¯æ“ä½œç³»ç»Ÿå°†å®é™…å¼‚æ­¥çš„æ“ä½œå˜ä¸ºäº†åœ¨ç”¨æˆ·ç¨‹åºçœ‹æ¥æ˜¯é˜»å¡å¼çš„æ“ä½œ ç¼“å†²(buffering)ï¼šæ•°æ®ç¦»å¼€ä¸€ä¸ªè®¾å¤‡ä¹‹åé€šå¸¸ä¸èƒ½ç›´æ¥å­˜æ”¾åˆ°æœ€ç»ˆç›®çš„åœ°ï¼Œæ¯”å¦‚ä»ç½‘ç»œä¸Šè¿›æ¥ä¸€ä¸ªæ•°æ®åŒ…æ—¶ï¼Œç›´åˆ°å°†è¯¥æ•°æ®åŒ…å­˜æ”¾åˆ°æŸä¸ªåœ°æ–¹ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ£€æŸ¥ï¼Œæ“ä½œç³»ç»Ÿæ‰çŸ¥é“è¦å°†å…¶ç½®äºä½•å¤„ã€‚ç¼“å†²æ¶‰åŠå¤§é‡å¤åˆ¶å·¥ä½œï¼Œç»å¸¸å¯¹ I/O æ€§èƒ½æœ‰é‡å¤§å½±å“ å…±äº«è®¾å¤‡å’Œç‹¬å è®¾å¤‡ï¼šå…±äº«è®¾å¤‡èƒ½åŒæ—¶è®©å¤šä¸ªç”¨æˆ·ä½¿ç”¨(å¦‚ç£ç›˜)ï¼Œç‹¬å è®¾å¤‡åˆ™åªèƒ½ç”±å•ä¸ªç”¨æˆ·ç‹¬å ä½¿ç”¨(å¦‚ç£å¸¦æœº)ã€‚ç‹¬å è®¾å¤‡çš„å¼•å…¥å¸¦æ¥äº†å„ç§é—®é¢˜(å¦‚æ­»é”)ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»èƒ½å¤„ç†å…±äº«è®¾å¤‡å’Œç‹¬å è®¾å¤‡ä»¥é¿å…é—®é¢˜å‘ç”Ÿ I/O æœ‰ä¸‰ç§å®ç°æ–¹å¼ ç¨‹åºæ§åˆ¶ I/O(programmed I/O)ï¼šè¿™æ˜¯ I/O çš„æœ€ç®€å•å½¢å¼ã€‚CPU è½®è¯¢è®¾å¤‡çŠ¶æ€ï¼Œå½“è®¾å¤‡å‡†å¤‡å¥½æ—¶ï¼ŒCPU å‘æ§åˆ¶å™¨å‘å‡ºè¯»æŒ‡ä»¤ï¼Œä» I/O è®¾å¤‡ä¸­è¯»å–å­—ï¼Œå†æŠŠè¿™äº›å­—å†™å…¥åˆ°å­˜å‚¨å™¨ã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å®ç°ç®€å•ï¼Œç¼ºç‚¹æ˜¯åœ¨å®Œæˆå…¨éƒ¨ I/O ä¹‹å‰ï¼ŒCPU çš„æ‰€æœ‰æ—¶é—´éƒ½è¢«å…¶å ç”¨ï¼Œå¦‚æœ CPU æœ‰å…¶ä»–äº‹æƒ…è¦åšï¼Œè½®è¯¢å°±å¯¼è‡´äº† CPU åˆ©ç”¨ç‡ä½ ä¸­æ–­é©±åŠ¨ I/O ï¼šç”¨ä¸­æ–­é˜»å¡ç­‰å¾… I/O çš„è¿›ç¨‹ï¼ŒCPU åœ¨ç­‰å¾… I/O è®¾å¤‡å°±ç»ªæ—¶ï¼Œé€šè¿‡è°ƒåº¦ç¨‹åºå…ˆæ‰§è¡Œå…¶ä»–è¿›ç¨‹ã€‚å½“ I/O å®Œæˆå(æ¯”å¦‚æ‰“å°æœºæ‰“å°å®Œä¸€ä¸ªå­—ç¬¦ï¼Œå‡†å¤‡æ¥æ”¶ä¸‹ä¸€ä¸ªå­—ç¬¦)ï¼Œè®¾å¤‡æ§åˆ¶å™¨å°†å‘ CPU å‘é€ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼ŒCPU æ£€æµ‹åˆ°ä¸­æ–­ä¿¡å·åä¿å­˜å½“å‰è¿›ç¨‹çš„è¿è¡Œç¯å¢ƒä¿¡æ¯ï¼Œç„¶åæ‰§è¡Œä¸­æ–­é©±åŠ¨ç¨‹åºæ¥å¤„ç†ä¸­æ–­ã€‚CPU ä»è®¾å¤‡æ§åˆ¶å™¨è¯»ä¸€ä¸ªå­—çš„æ•°æ®ä¼ é€åˆ° CPU å¯„å­˜å™¨ï¼Œå†å†™å…¥ä¸»å­˜ï¼Œæ¥ç€ CPU æ¢å¤å…¶ä»–è¿›ç¨‹çš„è¿è¡Œç¯å¢ƒå¹¶ç»§ç»­æ‰§è¡Œ(æ‰“å°ä¸‹ä¸€ä¸ªå­—ç¬¦)ã€‚ä¸­æ–­çš„ä¼˜ç‚¹æ˜¯æé«˜äº† CPU åˆ©ç”¨ç‡ï¼Œç¼ºç‚¹æ˜¯æ¯æ¬¡åªèƒ½è¯»ä¸€ä¸ªå­—ï¼Œæ¯æ¬¡éƒ½è¦å‘ç”Ÿä¸€ä¸ªä¸­æ–­ï¼Œé¢‘ç¹çš„ä¸­æ–­å¤„ç†å°†æµªè´¹ä¸€å®šçš„ CPU æ—¶é—´ ä½¿ç”¨ DMA(Direct Memory Access)çš„ I/O ï¼šè®© DMA æ§åˆ¶å™¨æ¥å®Œæˆ CPU è¦åšçš„å·¥ä½œï¼Œä½¿å¾— CPU å¯ä»¥åœ¨ I/O æœŸé—´åšå…¶ä»–æ“ä½œã€‚æœ‰äº† DMA æ§åˆ¶å™¨ï¼Œå°±ä¸ç”¨æ¯ä¸ªå­—ä¸­æ–­ä¸€æ¬¡ï¼Œè€Œæ˜¯å‡å°‘åˆ°æ¯ä¸ªç¼“å†²åŒºä¸€æ¬¡ã€‚DMA æ§åˆ¶å™¨é€šå¸¸æ¯” CPU æ…¢å¾ˆå¤šï¼Œå¦‚æœ CPU åœ¨ç­‰å¾… DMA ä¸­æ–­æ—¶æ²¡æœ‰å…¶ä»–äº‹æƒ…è¦åšï¼Œé‡‡ç”¨ä¸­æ–­é©±åŠ¨ I/O ç”šè‡³ç¨‹åºæ§åˆ¶ I/O ä¹Ÿè®¸æ›´å¥½ ","date":"2023-11-19","objectID":"/posts/io/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | IO","uri":"/posts/io/"},{"categories":["C++"],"content":"I/O è½¯ä»¶å±‚æ¬¡ I/O è½¯ä»¶é€šå¸¸ç»„ç»‡æˆå››ä¸ªå±‚æ¬¡ï¼Œä»ä¸Šå±‚åˆ°åº•å±‚ä¾æ¬¡ä¸º ç”¨æˆ·çº§ I/O è½¯ä»¶ï¼šå®ç°äº†ä¸ç”¨æˆ·äº¤äº’çš„æ¥å£ï¼Œä¸ºç”¨æˆ·æä¾› I/O æ“ä½œç›¸å…³çš„åº“å‡½æ•°æ¥å£ï¼Œå¦‚ printf ä¸è®¾å¤‡æ— å…³çš„æ“ä½œç³»ç»Ÿè½¯ä»¶ï¼šå‘ç”¨æˆ·å±‚æä¾›ç³»ç»Ÿè°ƒç”¨ï¼Œå¦‚ä¸º printf æä¾› writeï¼Œå¦å¤–è¿˜è¦æä¾›è®¾å¤‡ä¿æŠ¤(è®¾ç½®è®¿é—®æƒé™)ã€ç¼“å†²ã€é”™è¯¯æŠ¥å‘Šã€åˆ†é…ä¸é‡Šæ”¾ä¸“ç”¨è®¾å¤‡ã€å»ºç«‹é€»è¾‘è®¾å¤‡ååˆ°ç‰©ç†è®¾å¤‡åçš„æ˜ å°„å…³ç³»ç­‰åŠŸèƒ½ è®¾å¤‡é©±åŠ¨ç¨‹åº(device driver)ï¼šæ¯ä¸ªè¿æ¥åˆ°è®¡ç®—æœºä¸Šçš„ I/O è®¾å¤‡éƒ½éœ€è¦æŸäº›è®¾å¤‡ç‰¹å®šçš„ä»£ç æ¥å¯¹å…¶è¿›è¡Œæ§åˆ¶ï¼Œè¿™æ ·çš„ä»£ç ç§°ä¸ºè®¾å¤‡é©±åŠ¨ç¨‹åº ä¸­æ–­å¤„ç†ç¨‹åºï¼šè¿›è¡Œä¸­æ–­å¤„ç† ","date":"2023-11-19","objectID":"/posts/io/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | IO","uri":"/posts/io/"},{"categories":["C++"],"content":"ç›˜ ç›˜æœ‰å¤šç§å¤šæ ·çš„ç±»å‹ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ç£ç›˜ï¼Œå®ƒå…·æœ‰è¯»å†™é€Ÿåº¦åŒæ ·å¿«çš„ç‰¹ç‚¹ï¼Œé€‚åˆä½œä¸ºè¾…åŠ©å­˜å‚¨å™¨(ç”¨äºåˆ†é¡µã€æ–‡ä»¶ç³»ç»Ÿç­‰) ç£ç›˜è¢«ç»„ç»‡æˆæŸ±é¢ï¼Œæ¯ä¸€ä¸ªæŸ±é¢åŒ…å«è‹¥å¹²ç£é“ï¼Œç£é“æ•°ä¸å‚ç›´å †å çš„ç£å¤´ä¸ªæ•°ç›¸åŒï¼Œç£é“åˆè¢«åˆ†ä¸ºè‹¥å¹²æ‰‡åŒºï¼Œé€šè¿‡ (æŸ±é¢å·, ç›˜é¢å·, æ‰‡åŒºå·) å³å¯å®šä½ä¸€ä¸ªç£ç›˜å— ç£ç›˜è‡‚è°ƒåº¦ç®—æ³•æœ‰ å…ˆæ¥å…ˆæœåŠ¡ç®—æ³•(First-Come First-Servedï¼ŒFCFS)ï¼šæŒ‰ç…§è¯·æ±‚æ¥æ”¶é¡ºåºå®Œæˆè¯·æ±‚ï¼Œä¼˜ç‚¹æ˜¯å…¬å¹³ç®€å•æ˜“å®ç°ï¼Œç¼ºç‚¹æ˜¯å¹³å‡å¯»é“æ—¶é—´è¾ƒé•¿ æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆç®—æ³•(Shortest Seek Time Firstï¼ŒSSTF)ï¼šä¸‹ä¸€æ¬¡å¤„ç†ï¼Œç£å¤´å‘æ‰€æœ‰è¯·æ±‚ä¸­è·ç¦»æœ€è¿‘çš„ä½ç½®ç§»åŠ¨ã€‚ç¼ºç‚¹æ˜¯å¯èƒ½å‡ºç°é¥¥é¥¿ç°è±¡ æ‰«æç®—æ³•(SCAN)ï¼šä¹Ÿå«ç”µæ¢¯ç®—æ³•(elevator algorithm)ï¼Œç£å¤´æŒç»­å‘ä¸€ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œç›´åˆ°åˆ°è¾¾æœ€å†…ä¾§æˆ–æœ€å¤–ä¾§æ—¶æ‰æ”¹å˜æ–¹å‘ã€‚ä¼˜ç‚¹æ˜¯å¹³å‡å¯»é“æ—¶é—´è¾ƒçŸ­ï¼Œä¸ä¼šäº§ç”Ÿé¥¥é¥¿ç°è±¡ LOOK è°ƒåº¦ç®—æ³•ï¼šå¯¹æ‰«æç®—æ³•ç¨ä½œä¼˜åŒ–ï¼Œå¦‚æœç£å¤´ç§»åŠ¨æ–¹å‘ä¸Šå·²æ²¡æœ‰éœ€è¦å¤„ç†çš„è¯·æ±‚ï¼Œåˆ™ç›´æ¥æ”¹å˜æ–¹å‘ å¾ªç¯æ‰«æç®—æ³•(C-SCAN)ï¼šSCAN ç®—æ³•å¯¹äºå„ä¸ªä½ç½®ç£é“çš„å“åº”é¢‘ç‡ä¸å¹³å‡ï¼Œé è¿‘ç£ç›˜ä¸¤ä¾§çš„å¯èƒ½æ›´å¿«è¢«ä¸‹ä¸€æ¬¡è®¿é—®ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒC-SCAN ç®—æ³•çš„åŸç†æ˜¯ï¼Œåªåœ¨ä¸€ä¸ªç§»åŠ¨æ–¹å‘ä¸Šå¤„ç†è¯·æ±‚ï¼Œç£å¤´è¿”å›æ—¶ä¸å¤„ç†ä»»ä½•è¯·æ±‚ C-LOOKï¼šåªåœ¨ä¸€ä¸ªç§»åŠ¨æ–¹å‘ä¸Šå¤„ç†è¯·æ±‚ï¼Œå¦‚æœè¯¥æ–¹å‘ä¹‹åæ²¡æœ‰è¦å¤„ç†çš„è¯·æ±‚ï¼Œåˆ™ç£å¤´è¿”å›ï¼Œå¹¶ä¸”åªéœ€è¦è¿”å›åˆ°ç¬¬ä¸€ä¸ªæœ‰è¯·æ±‚çš„ä½ç½® ","date":"2023-11-19","objectID":"/posts/io/:4:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | IO","uri":"/posts/io/"},{"categories":["C++"],"content":" è¿›ç¨‹è¿è¡Œæ—¶ï¼Œå¯ä»¥åœ¨è‡ªå·±çš„åœ°å€ç©ºé—´å­˜å‚¨ä¿¡æ¯ï¼Œä½†è¿™æ ·ä¿å­˜ä¿¡æ¯çš„é—®é¢˜æ˜¯ å¯¹äºä¸€äº›ç¨‹åºï¼Œå¦‚é“¶è¡Œç³»ç»Ÿï¼Œè¿™æ ·çš„å­˜å‚¨ç©ºé—´å¤ªå° è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œä¿å­˜çš„ä¿¡æ¯å°±ä¸¢å¤±äº† ç»å¸¸éœ€è¦å¤šä¸ªè¿›ç¨‹è®¿é—®åŒä¸€ä¿¡æ¯ï¼Œè¿™è¦æ±‚ä¿¡æ¯ç‹¬ç«‹äºä»»ä½•ä¸€ä¸ªè¿›ç¨‹ å› æ­¤ï¼Œé•¿æœŸå­˜å‚¨ä¿¡æ¯æœ‰ä¸‰ä¸ªåŸºæœ¬è¦æ±‚ èƒ½å¤Ÿå­˜å‚¨å¤§é‡ä¿¡æ¯ ä½¿ç”¨ä¿¡æ¯çš„è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œä¿¡æ¯ä»å­˜åœ¨ å…è®¸å¤šä¸ªè¿›ç¨‹å¹¶å‘è®¿é—®ä¿¡æ¯ ç†è®ºä¸Šï¼Œç£ç›˜(magnetic disk)å°±èƒ½è§£å†³é•¿æœŸå­˜å‚¨çš„é—®é¢˜ï¼Œä½†å®é™…ä¸Šï¼Œæœ‰è®¸å¤šæ“ä½œä¸ä¾¿äºå®ç° å¦‚ä½•æ‰¾åˆ°ä¿¡æ¯? å¦‚ä½•é˜²æ­¢ä¸€ä¸ªç”¨æˆ·è¯»å–å¦ä¸€ä¸ªç”¨æˆ·çš„æ•°æ®? å¦‚ä½•çŸ¥é“å“ªäº›å—æ˜¯ç©ºé—²çš„? ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥æ–‡ä»¶çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ä¸ªå»ºæ¨¡äºç£ç›˜çš„æŠ½è±¡æ¦‚å¿µ æ–‡ä»¶ç”±æ“ä½œç³»ç»Ÿç®¡ç†ï¼Œæ–‡ä»¶çš„æ„é€ ã€å‘½åã€è®¿é—®ã€ä½¿ç”¨ã€ä¿æŠ¤ã€å®ç°ã€ç®¡ç†æ–¹æ³•æ˜¯æ“ä½œç³»ç»Ÿè®¾è®¡çš„ä¸»è¦å†…å®¹ï¼Œæ“ä½œç³»ç»Ÿä¸­å¤„ç†æ–‡ä»¶çš„éƒ¨åˆ†ç§°ä¸ºæ–‡ä»¶ç³»ç»Ÿ(file system) ","date":"2023-11-19","objectID":"/posts/filesystems/:0:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶ ","date":"2023-11-19","objectID":"/posts/filesystems/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶å‘½å å„ä¸ªç³»ç»Ÿä¸­çš„æ–‡ä»¶å‘½åè§„åˆ™ä¸åŒï¼Œç°ä»£æ“ä½œç³»ç»Ÿéƒ½å…è®¸ç”¨ 1 åˆ° 8 ä¸ªå­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ä½œä¸ºåˆæ³•çš„æ–‡ä»¶åï¼Œé€šå¸¸ä¹Ÿå…è®¸æœ‰æ•°å­—å’Œä¸€äº›ç‰¹æ®Šå­—ç¬¦ ä¸€èˆ¬æ“ä½œç³»ç»Ÿæ”¯æŒæ–‡ä»¶åç”¨åœ†ç‚¹åˆ†éš”ä¸ºä¸¤éƒ¨åˆ†ï¼Œå¦‚ main.cppï¼Œåœ†ç‚¹åçš„éƒ¨åˆ†ç§°ä¸ºæ–‡ä»¶æ‰©å±•å(file extension)ã€‚UNIX ä¸­ï¼Œæ–‡ä»¶æ‰©å±•ååªæ˜¯ä¸€ç§çº¦å®šï¼ŒWindows ä¸­çš„æ‰©å±•ååˆ™æœ‰ç‰¹åˆ«æ„ä¹‰ï¼Œç”¨æˆ·æˆ–è¿›ç¨‹å¯ä»¥åœ¨æ“ä½œç³»ç»Ÿä¸­æ³¨å†Œæ‰©å±•åï¼Œå¹¶è§„å®šå“ªä¸ªç¨‹åºæ‹¥æœ‰è¯¥æ‰©å±•å(å³åŒå‡»è¯¥æ–‡ä»¶åˆ™å¯åŠ¨æ­¤ç¨‹åºå¹¶è¿è¡Œè¯¥æ–‡ä»¶) ","date":"2023-11-19","objectID":"/posts/filesystems/:1:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶ç»“æ„ æ–‡ä»¶å¯ä»¥æœ‰å¤šç§æ„é€ æ–¹å¼ å¸¸è§çš„ä¸€ç§æ„é€ æ–¹å¼æ˜¯æ— ç»“æ„çš„å•å­—èŠ‚åºåˆ—ï¼Œæ“ä½œç³»ç»Ÿè§åˆ°çš„å°±æ˜¯å­—èŠ‚ï¼Œæ–‡ä»¶å†…å®¹çš„ä»»ä½•å«ä¹‰åªåœ¨ç”¨æˆ·ç¨‹åºä¸­è§£é‡Šï¼ŒUNIX å’Œ Windows éƒ½é‡‡ç”¨è¿™ç§æ–¹æ³•ã€‚è¿™ä¸ºæ“ä½œç³»ç»Ÿæä¾›äº†æœ€å¤§çš„çµæ´»æ€§ï¼Œç”¨æˆ·å¯ä»¥å‘æ–‡ä»¶ä¸­åŠ å…¥ä»»ä½•å†…å®¹ï¼Œä»¥ä»»ä½•å½¢å¼å‘½åï¼Œæ“ä½œç³»ç»Ÿä¸æä¾›å¸®åŠ©ä¹Ÿä¸è¿›è¡Œé˜»ç¢ ç¬¬äºŒç§æ„é€ æ–¹å¼æ˜¯å›ºå®šé•¿åº¦è®°å½•çš„åºåˆ—ï¼Œè¿™ç§æ–¹å¼çš„ä¸­å¿ƒæ€æƒ³æ˜¯ï¼Œè¯»æ“ä½œè¿”å›ä¸€ä¸ªè®°å½•ï¼Œå†™æ“ä½œé‡å†™æˆ–è¿½åŠ ä¸€ä¸ªè®°å½•ã€‚å‡ åå¹´å‰ï¼Œ80 åˆ—çš„ç©¿å­”å¡ç‰‡æ˜¯ä¸»æµæ—¶ï¼Œå¾ˆå¤šå¤§å‹æœºçš„æ“ä½œç³»ç»Ÿä½¿ç”¨çš„å°±æ˜¯è¿™ç§æ–¹å¼ï¼Œæ–‡ä»¶ç”± 80 ä¸ªå­—ç¬¦çš„è®°å½•ç»„æˆï¼Œæ–‡ä»¶ç³»ç»Ÿå»ºç«‹åœ¨è¿™ç§æ–‡ä»¶åŸºç¡€ä¸Š ç¬¬ä¸‰ç§æ„é€ æ–¹å¼æ˜¯ç”¨ä¸€æ£µè®°å½•æ ‘æ„æˆæ–‡ä»¶ï¼Œè®°å½•çš„å›ºå®šä½ç½®æœ‰ä¸€ä¸ªé”®ï¼Œæ ‘æŒ‰é”®æ’åºï¼Œä»è€Œå¯ä»¥å¯¹é”®è¿›è¡Œå¿«é€ŸæŸ¥æ‰¾ï¼Œè¿™ç§æ–¹å¼è¢«å¹¿æ³›ç”¨äºå¤„ç†å•†ä¸šæ•°æ®çš„å¤§å‹è®¡ç®—æœº ","date":"2023-11-19","objectID":"/posts/filesystems/:1:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶ç±»å‹ æ“ä½œç³»ç»Ÿä¸€èˆ¬æ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹ï¼ŒUNIX å’Œ Windows éƒ½æœ‰æ™®é€šæ–‡ä»¶(regular file)å’Œç›®å½•(directory)ï¼Œæ­¤å¤– UNIX è¿˜æœ‰å­—ç¬¦ç‰¹æ®Šæ–‡ä»¶(character special file)å’Œå—ç‰¹æ®Šæ–‡ä»¶(block special file) æ™®é€šæ–‡ä»¶ä¸€èˆ¬åˆ†ä¸º ASCII æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ ASCII æ–‡ä»¶ç”±å¤šè¡Œæ­£æ–‡ç»„æˆï¼Œæ¯è¡Œç”¨å›è½¦ç¬¦æˆ–æ¢è¡Œç¬¦æˆ–ä¸¤è€…(å¦‚ MS-DOS)ç»“æŸï¼Œå…¶æœ€å¤§ä¼˜åŠ¿æ˜¯å¯ä»¥æ˜¾ç¤ºã€æ‰“å°ã€ç¼–è¾‘ï¼Œå¦‚æœå¾ˆå¤šç¨‹åºéƒ½ç”¨ ASCII æ–‡ä»¶ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºï¼Œå°±å¾ˆå®¹æ˜“æŠŠä¸€ä¸ªç¨‹åºçš„è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªç¨‹åºçš„è¾“å…¥ äºŒè¿›åˆ¶æ–‡ä»¶æ‰“å°å‡ºæ¥æ˜¯å……æ»¡ä¹±ç çš„è¡¨ï¼Œé€šå¸¸äºŒè¿›åˆ¶æ–‡ä»¶æœ‰ä¸€å®šçš„å†…éƒ¨ç»“æ„ï¼Œä½¿ç”¨è¯¥æ–‡ä»¶çš„ç¨‹åºæ‰äº†è§£è¿™ç§ç»“æ„ã€‚æ¯”å¦‚ UNIX å­˜æ¡£æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶ä»¥æ¨¡å—å¤´å¼€å§‹ï¼Œå…¶ä¸­è®°å½•äº†åç§°ã€åˆ›å»ºæ—¥æœŸã€æ‰€æœ‰è€…ã€ä¿æŠ¤ç ã€æ–‡ä»¶å¤§å°ï¼Œè¯¥æ¨¡å—å¤´ä¸å¯æ‰§è¡Œæ–‡ä»¶ä¸€æ ·éƒ½æ˜¯äºŒè¿›åˆ¶æ•°å­—ï¼Œæ‰“å°è¾“å‡ºå®ƒä»¬æ¯«æ— æ„ä¹‰ ","date":"2023-11-19","objectID":"/posts/filesystems/:1:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶è®¿é—® æ—©æœŸæ“ä½œç³»ç»Ÿåªæœ‰é¡ºåºè®¿é—®(sequential access)ä¸€ç§æ–‡ä»¶è®¿é—®æ–¹å¼ï¼Œè¿›ç¨‹å¯ä»¥ä»å¤´æŒ‰é¡ºåºè¯»å–æ–‡ä»¶çš„å­—èŠ‚ï¼Œä¸èƒ½è·³è¿‡æŸä¸€äº›å†…å®¹ã€‚åœ¨å­˜å‚¨ä»‹è´¨æ˜¯ç£å¸¦è€Œä¸æ˜¯ç£ç›˜æ—¶ï¼Œé¡ºåºè®¿é—®æ–‡ä»¶æ˜¯å¾ˆæ–¹ä¾¿çš„ ç”¨ç£ç›˜å­˜å‚¨æ–‡ä»¶æ—¶ï¼Œå°±èƒ½ä»¥ä»»ä½•æ¬¡åºè¯»å–æ–‡ä»¶çš„å­—èŠ‚ï¼Œèƒ½è¢«è¿™ç§æ–¹å¼è®¿é—®çš„æ–‡ä»¶ç§°ä¸ºéšæœºè®¿é—®æ–‡ä»¶(random access file)ã€‚å¯¹è®¸å¤šç¨‹åºæ¥è¯´ï¼Œéšæœºè®¿é—®æ–‡ä»¶å¿…ä¸å¯å°‘ï¼Œæ¯”å¦‚æ•°æ®åº“ç³»ç»Ÿï¼ŒæŸ¥æ‰¾ä¸€æ¡è®°å½•æ—¶ï¼Œä¸éœ€è¦å…ˆè¯»å‡ºä¹‹å‰çš„æˆåƒä¸Šä¸‡æ¡è®°å½• ","date":"2023-11-19","objectID":"/posts/filesystems/:1:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶å±æ€§ é™¤äº†æ–‡ä»¶åå’Œæ•°æ®ï¼Œæ“ä½œç³»ç»Ÿè¿˜ä¼šä¿å­˜æ–‡ä»¶ç›¸å…³çš„ä¿¡æ¯ï¼Œå¦‚åˆ›å»ºæ—¥æœŸã€æ–‡ä»¶å¤§å°ç­‰ï¼Œè¿™äº›é™„åŠ ä¿¡æ¯ç§°ä¸ºæ–‡ä»¶å±æ€§(attribute)æˆ–å…ƒæ•°æ®(metadata)ã€‚ä¸åŒç³»ç»Ÿä¸­çš„æ–‡ä»¶å±æ€§å·®åˆ«å¾ˆå¤§ ","date":"2023-11-19","objectID":"/posts/filesystems/:1:5","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶æ“ä½œ ä½¿ç”¨æ–‡ä»¶æ˜¯ä¸ºäº†å­˜å‚¨ä¿¡æ¯å¹¶æ–¹ä¾¿ä»¥åæ£€ç´¢ï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿæä¾›äº†ä¸åŒçš„æ–¹å¼ï¼Œå¸¸è§çš„æ–‡ä»¶ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨æœ‰ createã€deleteã€openã€closeã€readã€writeã€appendã€seekã€get attributesã€set attributesã€rename ","date":"2023-11-19","objectID":"/posts/filesystems/:1:6","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"ç›®å½• ç›®å½•ç³»ç»Ÿçš„æœ€ç®€å•å½¢å¼æ˜¯å•å±‚ç›®å½•ç³»ç»Ÿï¼Œå³ä¸€ä¸ªç›®å½•ä¸­åŒ…å«æ‰€æœ‰æ–‡ä»¶ï¼Œè¿™ä¸ªç›®å½•é€šå¸¸ç§°ä¸ºæ ¹ç›®å½•ï¼Œå…¶ä¼˜åŠ¿æ˜¯ç®€å•ï¼Œä¸”èƒ½å¿«é€Ÿå®šä½æ–‡ä»¶ï¼Œå¸¸ç”¨äºç®€å•çš„åµŒå…¥å¼è£…ç½®ï¼Œå¦‚ç”µè¯ã€æ•°ç ç›¸æœº ç°åœ¨çš„ç”¨æˆ·é€šå¸¸æœ‰æˆåƒä¸Šä¸‡çš„æ–‡ä»¶ï¼Œç”¨å•å±‚ç›®å½•å¯»æ‰¾æ–‡ä»¶å°±å¾ˆå›°éš¾äº†ï¼Œè¿™å°±éœ€è¦å±‚æ¬¡ç»“æ„(å³ä¸€ä¸ªç›®å½•æ ‘)ï¼Œå‡ ä¹æ‰€æœ‰ç°ä»£æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨çš„éƒ½æ˜¯å±‚æ¬¡ç›®å½•ç³»ç»Ÿã€‚ç”¨ç›®å½•æ ‘ç»„ç»‡æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œå¸¸ç”¨ç»å¯¹è·¯å¾„å(absolute path name)æˆ–ç›¸å¯¹è·¯å¾„å(relative path name)æ¥æŒ‡æ˜æ–‡ä»¶å UNIX ä¸­å¸¸è§çš„ç›®å½•æ“ä½œçš„ç³»ç»Ÿè°ƒç”¨æœ‰ createã€delete(åªèƒ½åˆ é™¤ç©ºç›®å½•)ã€opendirã€closedirã€readdirã€renameã€linkã€unlink ","date":"2023-11-19","objectID":"/posts/filesystems/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶ç³»ç»Ÿçš„å®ç° ","date":"2023-11-19","objectID":"/posts/filesystems/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€ æ–‡ä»¶ç³»ç»Ÿå­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚å¤šæ•°ç£ç›˜åˆ’åˆ†ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªåˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºä¸­æœ‰ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿ ç£ç›˜çš„ 0 å·æ‰‡åŒºç§°ä¸ºä¸»å¼•å¯¼è®°å½•(Master Boot Recordï¼ŒMBR)ï¼Œç”¨æ¥å¼•å¯¼è®¡ç®—æœº MBR çš„ç»“å°¾æ˜¯åˆ†åŒºè¡¨ï¼Œè¯¥è¡¨ç»™å‡ºäº†æ¯ä¸ªåˆ†åŒºçš„èµ·å§‹åœ°å€å’Œç»“æŸåœ°å€ã€‚è¡¨ä¸­çš„ä¸€ä¸ªåˆ†åŒºè¢«æ ‡è®°ä¸ºæ´»åŠ¨åˆ†åŒºï¼Œè®¡ç®—æœºè¢«å¼•å¯¼æ—¶ï¼ŒBIOS è¯»å…¥å¹¶æ‰§è¡Œ MBRï¼ŒMBR åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯ç¡®å®šæ´»åŠ¨åˆ†åŒºï¼Œè¯»å…¥ç¬¬ä¸€ä¸ªå—ï¼Œå³å¼•å¯¼å—(boot block)ï¼Œå¹¶æ‰§è¡Œ é™¤äº†å¼•å¯¼å—ï¼Œç£ç›˜åˆ†åŒºçš„å¸ƒå±€é€šå¸¸éšæ–‡ä»¶ç³»ç»Ÿçš„ä¸åŒè€Œå˜åŒ–ï¼Œä¸€ä¸ªå¯èƒ½çš„æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€å¦‚ä¸‹ |-----------------æ•´ä¸ªç£ç›˜-----------------| åˆ†åŒºè¡¨ ç£ç›˜åˆ†åŒº â†“ â†™ â†™ â†˜ â†˜ __________________________________________ |MBR||||________|________|________|________| / \\ / \\ |å¼•å¯¼å—|è¶…çº§å—|ç©ºé—²ç©ºé—´ç®¡ç†|ièŠ‚ç‚¹|æ ¹ç›®å½•|æ–‡ä»¶å’Œç›®å½•| ","date":"2023-11-19","objectID":"/posts/filesystems/:3:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶çš„å®ç° æ–‡ä»¶å­˜å‚¨å®ç°çš„å…³é”®æ˜¯è®°å½•æ–‡ä»¶ç”¨åˆ°äº†å“ªäº›ç£ç›˜å—ï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿçš„å®ç°æ–¹å¼ä¸åŒ æœ€ç®€å•çš„æ–¹å¼æ˜¯è¿ç»­åˆ†é…ï¼Œæ¯ä¸ªæ–‡ä»¶ä½œä¸ºä¸€è¿ä¸²è¿ç»­æ•°æ®å—å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œæ¯”å¦‚å—å¤§å°ä¸º 1 KB çš„ç£ç›˜ä¸Šï¼Œ50 KB çš„æ–‡ä»¶è¦åˆ†é… 50 ä¸ªè¿ç»­çš„å—ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½è¦ä»ä¸€ä¸ªæ–°çš„å—å¼€å§‹ï¼Œä¸Šä¸€ä¸ªæ–‡ä»¶æœ«å°¾å—å¯èƒ½ä¼šå­˜åœ¨éƒ¨åˆ†è¢«æµªè´¹çš„ç©ºé—´ è¿ç»­åˆ†é…çš„ä¼˜åŠ¿æ˜¯å®ç°ç®€å•ï¼Œåªéœ€è¦ä¸ºæ¯ä¸ªæ–‡ä»¶è®°å½•ç¬¬ä¸€å—çš„ç£ç›˜åœ°å€å’Œä½¿ç”¨çš„å—æ•°ï¼Œå¦å¤–è¯»æ“ä½œæ€§èƒ½è¾ƒå¥½ï¼Œå•ä¸ªæ“ä½œå°±å¯ä»¥è¯»å‡ºæ•´ä¸ªæ–‡ä»¶ ç¼ºç‚¹æ˜¯åˆ é™¤æ–‡ä»¶ä¼šåœ¨ç£ç›˜ä¸­ç•™ä¸‹æ–­æ–­ç»­ç»­çš„ç©ºé—²å—ã€‚å‹ç¼©ç£ç›˜ä»£ä»·å¤ªé«˜ï¼Œä¸å¯è¡Œã€‚ç»´æŠ¤ä¸€ä¸ªç©ºé—²å—é“¾è¡¨ï¼Œä½†åˆ›å»ºæ–°æ–‡ä»¶æ—¶ï¼Œä¸ºäº†é€‰æ‹©é€‰æ‹©åˆé€‚çš„ç©ºé—²åŒºï¼Œå¿…é¡»å…ˆç»™å‡ºæ–‡ä»¶çš„æœ€ç»ˆå¤§å°ï¼Œå¦‚æœç”¨æˆ·è¦åˆ›å»ºä¸€ä¸ªæ–‡æ¡£ç„¶åå½•å…¥ï¼Œç”¨æˆ·æ˜¯æ— æ³•ç»™å‡ºæœ€ç»ˆå¤§å°çš„ã€‚ä½†è¿™åœ¨ CD-ROM ä¸­æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºæ‰€æœ‰æ–‡ä»¶çš„å¤§å°éƒ½äº‹å…ˆå®šå¥½äº†ï¼Œå¹¶ä¸”åç»­ä½¿ç”¨ä¹Ÿä¸ä¼šè¢«æ”¹å˜ ç¬¬äºŒç§æ–¹å¼æ˜¯é“¾å¼åˆ†é…ï¼Œè¿™æ ·ä¸ä¼šå› ä¸ºç£ç›˜ç¢ç‰‡è€Œæµªè´¹å­˜å‚¨ç©ºé—´ï¼Œä½†éšæœºè®¿é—®å¾ˆæ…¢ï¼Œæ¯æ¬¡è¦è®¿é—®ä¸€ä¸ªå—æ—¶ï¼Œéƒ½å¿…é¡»ä»ç¬¬ä¸€ä¸ªå—å¼€å§‹ã€‚æ­¤å¤–ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªå—çš„æŒ‡é’ˆå ç”¨äº†ä¸€äº›å­—èŠ‚ï¼Œæ¯ä¸ªç£ç›˜å—å­˜å‚¨æ•°æ®çš„å­—èŠ‚æ•°ä¸å†æ˜¯ 2 çš„æ•´æ•°æ¬¡å¹‚ï¼Œè™½ç„¶è¿™ä¸ªé—®é¢˜ä¸æ˜¯éå¸¸ä¸¥é‡ï¼Œä½†ä¹Ÿä¼šé™ä½ç³»ç»Ÿçš„è¿è¡Œæ•ˆç‡ï¼Œå› ä¸ºç¨‹åºä¸€èˆ¬ä»¥é•¿åº¦ä¸º 2 çš„æ•´æ•°æ¬¡å¹‚æ¥è¯»å†™ç£ç›˜å— ç¬¬ä¸‰ç§æ–¹å¼æ˜¯æŠŠé“¾å¼åˆ†é…çš„æŒ‡é’ˆæ”¾åˆ°å†…å­˜çš„ä¸€ä¸ªè¡¨ä¸­ï¼Œè¿™ä¸ªè¡¨ç§°ä¸ºæ–‡ä»¶åˆ†é…è¡¨(File Allocation Tableï¼ŒFAT)ï¼Œè¿™æ ·å°±è§£å†³äº†å¤§å°ä¸æ­£å¸¸å¸¦æ¥çš„é—®é¢˜ï¼Œä½†å¦‚æœè¡¨é¡¹è¿‡å¤šï¼Œæ¯”å¦‚ 1 TB çš„ç£ç›˜å’Œ 1 KB çš„å—ï¼ŒFAT æœ‰ 10 äº¿é¡¹ï¼Œæ¯é¡¹è‡³å°‘å  3 å­—èŠ‚ï¼Œè¿™å°±å äº† 3 GB å†…å­˜ï¼Œå› æ­¤ FAT åœ¨å¤§å‹ç£ç›˜ä¸­ä¸å®ç”¨ æœ€åä¸€ç§æ–¹å¼æ˜¯ä¸ºæ¯ä¸ªæ–‡ä»¶èµ‹äºˆä¸€ä¸ª i èŠ‚ç‚¹(index-node)çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­åˆ—å‡ºäº†æ–‡ä»¶å±æ€§å’Œæ–‡ä»¶å—çš„ç£ç›˜åœ°å€ã€‚ç»™å®š i èŠ‚ç‚¹å°±èƒ½æ‰¾åˆ°æ–‡ä»¶çš„æ‰€æœ‰å—ï¼Œè¿™ç§æ–¹å¼ç›¸å¯¹äº FAT çš„ä¼˜åŠ¿æ˜¯ï¼Œåªæœ‰åœ¨æ–‡ä»¶æ‰“å¼€æ—¶ï¼Œå…¶ i èŠ‚ç‚¹æ‰åœ¨å†…å­˜ä¸­ï¼Œæœ€ç»ˆéœ€è¦çš„å†…å­˜ä¸åŒæ—¶æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°æˆæ­£æ¯” ","date":"2023-11-19","objectID":"/posts/filesystems/:3:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"ç›®å½•çš„å®ç° è¯»æ–‡ä»¶æ—¶å¿…é¡»å…ˆæ‰“å¼€æ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿåˆ©ç”¨è·¯å¾„åæ‰¾åˆ°ç›®å½•é¡¹ï¼Œç›®å½•é¡¹ä¸­æä¾›äº†æŸ¥æ‰¾æ–‡ä»¶ç£ç›˜å—æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯ä¸ç³»ç»Ÿæœ‰å…³ï¼Œä¿¡æ¯å¯èƒ½æ˜¯æ•´ä¸ªæ–‡ä»¶çš„ç£ç›˜åœ°å€(å¯¹äºè¿ç»­åˆ†é…çš„ç³»ç»Ÿ)ã€ç¬¬ä¸€å—çš„ç¼–å·(é“¾å¼åˆ†é…)ã€i èŠ‚ç‚¹å·ã€‚æ–‡ä»¶å±æ€§å­˜æ”¾çš„ä½ç½®å¯ä»¥æ˜¯ç›®å½•é¡¹æˆ–è€… i èŠ‚ç‚¹ ç°ä»£æ“ä½œç³»ç»Ÿä¸€èˆ¬éƒ½æ”¯æŒé•¿åº¦å¯å˜çš„é•¿æ–‡ä»¶åã€‚æœ€ç®€å•çš„å®ç°æ–¹å¼æ˜¯ï¼Œç»™æ–‡ä»¶åä¸€ä¸ªé•¿åº¦é™åˆ¶ï¼Œå¦‚ 255 ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸ºæ¯ä¸ªæ–‡ä»¶åä¿ç•™è¯¥é•¿åº¦çš„ç©ºé—´ï¼Œè¿™ç§æ–¹å¼ç®€å•ä½†æµªè´¹äº†å¤§é‡ç›®å½•ç©ºé—´ ç¬¬äºŒç§æ–¹å¼æ˜¯ï¼Œæ¯ä¸ªç›®å½•é¡¹ä¸­å¼€å¤´æœ‰ä¸€ä¸ªè®°å½•ç›®å½•é¡¹é•¿åº¦çš„å›ºå®šéƒ¨åˆ†ï¼Œæ¥ç€æ˜¯æ–‡ä»¶å±æ€§ã€ä»»æ„é•¿åº¦çš„æ–‡ä»¶åã€‚ç¼ºç‚¹å’Œè¿ç»­åˆ†é…çš„ç£ç›˜ç¢ç‰‡é—®é¢˜ä¸€æ ·ï¼Œç§»é™¤ä¸€ä¸ªä¸ªæ–‡ä»¶åä¼šç•™ä¸‹æ–­æ–­ç»­ç»­çš„ç©ºéš™ã€‚ç”±äºæ•´ä¸ªç›®å½•åœ¨å†…å­˜ä¸­ï¼Œåªæœ‰å¯¹ç›®å½•è¿›è¡Œç´§å‡‘æ“ä½œæ‰èƒ½èŠ‚çœç©ºé—´ã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯ä¸€ä¸ªç›®å½•é¡¹å¯èƒ½ä¼šåˆ†å¸ƒåœ¨å¤šä¸ªé¡µé¢ä¸Šï¼Œè¯»å–æ–‡ä»¶åæ—¶å¯èƒ½å‘ç”Ÿç¼ºé¡µä¸­æ–­ ç¬¬ä¸‰ç§æ–¹å¼æ˜¯ï¼Œä½¿ç›®å½•é¡¹æœ‰å›ºå®šé•¿åº¦ï¼Œå°†æ–‡ä»¶åæ”¾åœ¨ç›®å½•åé¢çš„å †ä¸Šï¼Œå¹¶ç®¡ç†è¿™ä¸ªå †ï¼Œè¿™æ ·ç§»é™¤ä¸€ä¸ªç›®å½•é¡¹åï¼Œä¸‹ä¸€ä¸ªè¿›æ¥çš„ç›®å½•é¡¹æ€»å¯ä»¥å¡«æ»¡è¿™ä¸ªç©ºéš™ çº¿æ€§æŸ¥æ‰¾æ–‡ä»¶åè¦ä»å¤´åˆ°å°¾æœç´¢ç›®å½•ï¼Œå¯¹äºéå¸¸é•¿çš„ç›®å½•ï¼Œä¸€ä¸ªä¼˜åŒ–æ–¹å¼æ˜¯åœ¨æ¯ä¸ªç›®å½•ä¸­ä½¿ç”¨æ•£åˆ—è¡¨æ¥æ˜ å°„æ–‡ä»¶åå’Œå¯¹åº”çš„ç›®å½•é¡¹ ","date":"2023-11-19","objectID":"/posts/filesystems/:3:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"å…±äº«æ–‡ä»¶ å‡ ä¸ªç”¨æˆ·åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­å·¥ä½œæ—¶å¸¸éœ€è¦å…±äº«æ–‡ä»¶ã€‚å¯¹äºå¦‚ä¸‹æ–‡ä»¶ç³»ç»Ÿï¼ŒB ä¸ C æœ‰ä¸€ä¸ªå…±äº«æ–‡ä»¶ï¼ŒB çš„ç›®å½•ä¸è¯¥æ–‡ä»¶çš„è”ç³»ç§°ä¸ºä¸€ä¸ªé“¾æ¥(link)ã€‚è¿™æ ·ï¼Œæ–‡ä»¶ç³»ç»Ÿæœ¬èº«æ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾(Derected Acyclic Graphï¼ŒDAG)è€Œä¸æ˜¯ä¸€æ£µæ ‘ï¼Œä»£ä»·æ˜¯ç»´æŠ¤å˜å¾—å¤æ‚ å…±äº«æ–‡ä»¶çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœç›®å½•ä¸­åŒ…å«ç£ç›˜åœ°å€ï¼Œé“¾æ¥æ–‡ä»¶æ—¶å¿…é¡»å°† C ç›®å½•ä¸­çš„ç£ç›˜åœ°å€å¤åˆ¶åˆ° B ç›®å½•ä¸­ï¼Œå¦‚æœ B(æˆ– C)å¾€æ–‡ä»¶ä¸­æ·»åŠ å†…å®¹ï¼Œæ–°æ•°æ®å—åªä¼šåˆ—å…¥ B(æˆ– C)çš„ç”¨æˆ·ç›®å½•ä¸­ï¼ŒC(æˆ– B)å¯¹æ­¤æ”¹å˜æ˜¯ä¸çŸ¥é“çš„ï¼Œè¿™å°±è¿èƒŒäº†å…±äº«çš„ç›®çš„ è§£å†³è¿™ä¸ªé—®é¢˜çš„ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯ï¼Œç£ç›˜å—ä¸åˆ—å…¥ç›®å½•ï¼Œè€Œæ˜¯åˆ—å…¥ä¸€ä¸ªä¸æ–‡ä»¶å…³è”çš„å°å‹æ•°æ®ç»“æ„ï¼Œç›®å½•å°†æŒ‡å‘è¿™ä¸ªå°å‹æ•°æ®ç»“æ„ã€‚è¿™æ˜¯ UNIX çš„åšæ³•ï¼Œå°å‹æ•°æ®ç»“æ„å°±æ˜¯ i èŠ‚ç‚¹ è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ï¼ŒB é“¾æ¥è¯¥å…±äº«æ–‡ä»¶æ—¶ï¼Œi èŠ‚ç‚¹è®°å½•çš„æ–‡ä»¶æ‰€æœ‰è€…ä»æ˜¯ Cï¼Œåªæ˜¯å°† i èŠ‚ç‚¹çš„é“¾æ¥è®¡æ•°åŠ  1ï¼Œä»¥è®©ç³»ç»ŸçŸ¥é“è¯¥æ–‡ä»¶æœ‰å¤šå°‘ä¸ªæŒ‡å‘å®ƒçš„ç›®å½•é¡¹ã€‚å¦‚æœ C ä¹‹ååˆ é™¤äº†è¿™ä¸ªæ–‡ä»¶ï¼ŒB å°±æœ‰ä¸€ä¸ªæŒ‡å‘æ— æ•ˆçš„ièŠ‚ç‚¹çš„ç›®å½•é¡¹ã€‚å¦‚æœè¿™ä¸ª i èŠ‚ç‚¹ä¹‹ååˆ†é…ç»™å¦ä¸€ä¸ªæ–‡ä»¶ï¼ŒB çš„é“¾æ¥å°†æŒ‡å‘ä¸€ä¸ªé”™è¯¯çš„æ–‡ä»¶ã€‚ç³»ç»Ÿå¯ä»¥é€šè¿‡ièŠ‚ç‚¹çš„è®¡æ•°çŸ¥é“æ–‡ä»¶è¢«å¼•ç”¨ï¼Œä½†æ— æ³•æ‰¾åˆ°æ‰€æœ‰ç›®å½•é¡¹å¹¶åˆ é™¤ï¼Œä¹Ÿä¸å¯èƒ½æŠŠç›®å½•é¡¹æŒ‡é’ˆå­˜å‚¨åœ¨ i èŠ‚ç‚¹ä¸­ï¼Œå› ä¸ºå¯èƒ½æœ‰æ— æ•°ä¸ªè¿™æ ·çš„ç›®å½• ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯ç¬¦å·é“¾æ¥(symbolic linking)ï¼Œè®©ç³»ç»Ÿå»ºç«‹ä¸€ä¸ª LINK ç±»å‹çš„æ–‡ä»¶ï¼ŒæŠŠè¯¥æ–‡ä»¶æ”¾åœ¨ B ç›®å½•ä¸‹ï¼Œä½¿å¾— B ä¸ C çš„ä¸€ä¸ªæ–‡ä»¶å­˜åœ¨é“¾æ¥ã€‚LINK æ–‡ä»¶ä¸­åŒ…å«äº†è¦é“¾æ¥çš„æ–‡ä»¶çš„è·¯å¾„åï¼ŒB è¯»è¯¥é“¾æ¥æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿå‘ç°æ˜¯ LINK ç±»å‹ï¼Œåˆ™æ‰¾åˆ°å…¶é“¾æ¥æ–‡ä»¶çš„è·¯å¾„å¹¶è¯»å– ç¬¦å·é“¾æ¥åœ¨æ–‡ä»¶è¢«åˆ é™¤åï¼Œé€šè¿‡è·¯å¾„åæŸ¥æ‰¾æ–‡ä»¶å°†å¤±è´¥ï¼Œå› æ­¤ä¸ä¼šæœ‰ç¬¬ä¸€ç§æ–¹æ³•çš„é—®é¢˜ã€‚ç¬¦å·é“¾æ¥çš„é—®é¢˜åœ¨äºéœ€è¦é¢å¤–å¼€é”€ï¼Œå¿…é¡»è¯»å–åŒ…å«è·¯å¾„çš„æ–‡ä»¶ï¼Œç„¶åé€æ­¥æ‰«æè·¯å¾„ç›´åˆ°æ‰¾åˆ° i èŠ‚ç‚¹ï¼Œè¿™äº›æ“ä½œå¯èƒ½éœ€è¦å¾ˆå¤šæ¬¡é¢å¤–çš„ç£ç›˜è®¿é—® æ­¤å¤–ï¼Œæ‰€æœ‰æ–¹å¼çš„é“¾æ¥éƒ½å­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæ–‡ä»¶æœ‰å¤šä¸ªè·¯å¾„ï¼Œå¦‚æœæŸ¥æ‰¾æ–‡ä»¶ï¼Œå°†å¤šæ¬¡å®šä½åˆ°è¢«é“¾æ¥çš„æ–‡ä»¶ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºçš„åŠŸèƒ½æ˜¯æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶å¹¶å¤åˆ¶ï¼Œå°±å¯èƒ½å¯¼è‡´å¤šæ¬¡å¤åˆ¶åŒä¸€æ–‡ä»¶ ","date":"2023-11-19","objectID":"/posts/filesystems/:3:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ(Log-structured File Systemï¼ŒLFS) è®¾è®¡ LFS çš„ä¸»è¦åŸå› æ˜¯ï¼ŒCPU è¿è¡Œé€Ÿåº¦è¶Šæ¥è¶Šå¿«ï¼ŒRAM å†…å­˜å˜å¾—æ›´å¤§ï¼Œç£ç›˜é«˜é€Ÿç¼“å­˜è¿…é€Ÿå¢åŠ ï¼Œä¸éœ€è¦ç£ç›˜è®¿é—®æ“ä½œï¼Œå°±å¯èƒ½æ»¡è¶³ç›´æ¥æ¥è‡ªé«˜é€Ÿç¼“å­˜çš„å¤§éƒ¨åˆ†è¯»è¯·æ±‚ï¼Œç”±æ­¤å¯ä»¥æ¨æ–­ï¼Œæœªæ¥çš„ç£ç›˜è®¿é—®å¤šæ•°æ˜¯å†™æ“ä½œï¼Œä¸”å†™æ“ä½œå¾€å¾€æ˜¯é›¶ç¢çš„ï¼Œæå‰è¯»æœºåˆ¶å¹¶ä¸èƒ½è·å¾—æ›´å¥½çš„æ€§èƒ½ å› æ­¤ LFS çš„è®¾è®¡è€…å†³å®šé‡æ–°å®ç°ä¸€ç§ UNIX æ–‡ä»¶ç³»ç»Ÿï¼Œå³ä½¿é¢å¯¹ä¸€ä¸ªç”±å¤§éƒ¨åˆ†ä¸ºé›¶ç¢çš„éšæœºå†™æ“ä½œç»„æˆçš„ä»»åŠ¡ï¼Œä¹Ÿèƒ½å¤Ÿå……åˆ†åˆ©ç”¨ç£ç›˜å¸¦å®½ åŸºæœ¬æ€è·¯æ˜¯ï¼Œå°†æ•´ä¸ªç£ç›˜ç»“æ„åŒ–ä¸ºä¸€ä¸ªæ—¥å¿—ï¼Œæœ€åˆæ‰€æœ‰å†™æ“ä½œéƒ½ç¼“å†²åœ¨å†…å­˜ä¸­ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æˆ–æœ‰ç‰¹æ®Šéœ€è¦æ—¶ï¼Œè¢«ç¼“å†²åœ¨å†…å­˜ä¸­æœªæ‰§è¡Œçš„å†™æ“ä½œè¢«æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„æ®µä¸­ï¼Œä½œä¸ºæ—¥å¿—æœ«å°¾çš„ä¸€ä¸ªé‚»æ¥æ®µè¢«å†™å…¥ç£ç›˜ ä½†ç£ç›˜ç©ºé—´ä¸æ˜¯æ— é™å¤§çš„ï¼Œè¿™ç§åšæ³•æœ€ç»ˆå°†å¯¼è‡´æ—¥å¿—å æ»¡æ•´ä¸ªç£ç›˜ï¼Œæ­¤æ—¶å°±æ— æ³•å†å†™å…¥æ–°çš„æ®µã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒLFS æœ‰ä¸€ä¸ªæ¸…ç†çº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹å‘¨æœŸæ€§æ‰«ææ—¥å¿—è¿›è¡Œç£ç›˜å‹ç¼©ã€‚æ•´ä¸ªç£ç›˜æˆä¸ºä¸€ä¸ªå¤§çš„ç¯å½¢ç¼“å†²åŒºï¼Œå†™çº¿ç¨‹å°†æ–°çš„æ®µå†™åˆ°å‰é¢ï¼Œæ¸…ç†çº¿ç¨‹å°†æ—§çš„æ®µä»åé¢ç§»èµ° LFS åœ¨å¤„ç†å¤§é‡é›¶ç¢å†™æ“ä½œæ—¶çš„æ€§èƒ½æ¯” UNIX å¥½ä¸€ä¸ªæ•°é‡çº§ï¼Œåœ¨å¤„ç†è¯»å’Œå¤§å—å†™æ“ä½œæ—¶çš„æ€§èƒ½ä¹Ÿä¸æ¯” UNIX å·®ï¼Œç”šè‡³æ›´å¥½ ","date":"2023-11-19","objectID":"/posts/filesystems/:3:5","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿ ç”±äº LFS å’Œç°æœ‰çš„æ–‡ä»¶ç³»ç»Ÿä¸ç›¸åŒ¹é…ï¼Œæ‰€ä»¥è¿˜æœªè¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½†å…¶å†…åœ¨çš„ä¸€ä¸ªæ€æƒ³ï¼Œå³é¢å¯¹å‡ºé”™çš„é²æ£’æ€§ï¼Œå¯ä»¥è¢«å…¶ä»–æ–‡ä»¶ç³»ç»Ÿå€Ÿé‰´ã€‚è¿™ä¸ªåŸºæœ¬æƒ³æ³•æ˜¯ï¼Œä¿å­˜ä¸€ä¸ªç”¨äºè®°å½•ç³»ç»Ÿä¸‹ä¸€æ­¥è¦åšä»€ä¹ˆçš„æ—¥å¿—ã€‚å½“ç³»ç»Ÿåœ¨å®Œæˆä»»åŠ¡å‰å´©æºƒæ—¶ï¼Œé‡æ–°å¯åŠ¨åï¼Œå°±èƒ½é€šè¿‡æŸ¥çœ‹æ—¥å¿—è·å–å´©æºƒå‰è®¡åˆ’å®Œæˆçš„ä»»åŠ¡ã€‚è¿™æ ·çš„æ–‡ä»¶ç³»ç»Ÿè¢«ç§°ä¸ºæ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶å·²è¢«å®é™…ä½¿ç”¨ï¼Œæ¯”å¦‚å¾®è½¯çš„ NTFSã€Linux ext3ã€RerserFSï¼ŒOS Xå°†æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿä½œä¸ºå¯é€‰é¡¹æä¾› ","date":"2023-11-19","objectID":"/posts/filesystems/:3:6","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ(Virtual File Systemï¼ŒVFS) åŒä¸€å°è®¡ç®—æœºæˆ–åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸­ï¼Œå¯ä»¥æœ‰å¤šä¸ªä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿ Windows æœ‰ä¸€ä¸ªä¸»è¦çš„ NTFS æ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä¹Ÿæœ‰ä¸€ä¸ªåŒ…å« FAT-32 æˆ– FAT-16 çš„é©±åŠ¨å™¨æˆ–åˆ†åŒºï¼Œæ­¤å¤–è¿˜å¯èƒ½æœ‰ CD-ROM æˆ–è€… DVD(æ¯ä¸€ä¸ªåŒ…å«ç‰¹å®šæ–‡ä»¶ç³»ç»Ÿ)ï¼ŒWindows é€šè¿‡æŒ‡å®šç›˜ç¬¦æ¥å¤„ç†ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿï¼Œè¿›ç¨‹æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œç›˜ç¬¦æ˜¯æ˜¾å¼æˆ–éšå¼å­˜åœ¨çš„ï¼ŒWindows ç”±æ­¤å¯çŸ¥å‘å“ªä¸ªæ–‡ä»¶ç³»ç»Ÿä¼ é€’è¯·æ±‚ï¼Œä¸éœ€è¦å°†ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿæ•´åˆä¸ºç»Ÿä¸€æ¨¡å¼ æ‰€æœ‰ç°ä»£çš„ UNIX å°è¯•å°†å¤šç§æ–‡ä»¶ç³»ç»Ÿæ•´åˆåˆ°ä¸€ä¸ªç»Ÿä¸€çš„ç»“æ„ä¸­ã€‚ä¸€ä¸ª Linux ç³»ç»Ÿå¯ä»¥ç”¨ ext2 ä½œä¸ºæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œext3 åˆ†åŒºè£…è½½åœ¨ /usr ä¸‹ï¼Œé‡‡ç”¨ RerserFS çš„æ–‡ä»¶ç³»ç»Ÿçš„ç¡¬ç›˜è£…è½½åœ¨ /home ä¸‹ï¼ŒISO 9660 çš„ CD-ROM ä¸´æ—¶è£…è½½åœ¨ /mnt ä¸‹ã€‚ç”¨æˆ·è§†è§’ä¸­ï¼Œåªæœ‰ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿå±‚çº§ï¼Œä½†å®é™…ä¸Šæ˜¯å¯¹ç”¨æˆ·å’Œè¿›ç¨‹ä¸å¯è§çš„å¤šç§ä¸ç›¸å®¹çš„æ–‡ä»¶ç³»ç»Ÿ ä½†æ˜¯å¤šç§æ–‡ä»¶ç³»ç»Ÿçš„å­˜åœ¨åœ¨å®é™…åº”ç”¨ä¸­æ˜¯æ˜ç¡®å¯è§çš„ï¼Œä»¥å‰å¤§å¤š UNIX æ“ä½œç³»ç»Ÿéƒ½ä½¿ç”¨ VFS æ¦‚å¿µå°è¯•å°†å¤šç§æ–‡ä»¶ç³»ç»Ÿç»Ÿä¸€æˆä¸€ä¸ªæœ‰åºç»“æ„ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯æŠ½è±¡å‡ºæ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿå…±æœ‰çš„éƒ¨åˆ†ä¸ºå•ç‹¬ä¸€å±‚ï¼Œè¿™ä¸€å±‚é€šè¿‡è°ƒç”¨åº•å±‚çš„å®é™…æ–‡ä»¶ç³»ç»Ÿæ¥å…·ä½“ç®¡ç†æ•°æ® UNIX ä¸­ï¼Œæ‰€æœ‰æ–‡ä»¶ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨æœ€åˆéƒ½æŒ‡å‘ VFSï¼Œè¿™äº›æ¥è‡ªç”¨æˆ·è¿›ç¨‹çš„è°ƒç”¨éƒ½æ˜¯æ ‡å‡†çš„ POSIX ç³»ç»Ÿè°ƒç”¨ï¼ŒVFS å¯¹ç”¨æˆ·è¿›ç¨‹æä¾›çš„ä¸Šå±‚æ¥å£å°±æ˜¯ POSIX æ¥å£ã€‚VFS ä¹Ÿæœ‰ä¸€ä¸ªå¯¹äºå®é™…æ–‡ä»¶ç³»ç»Ÿçš„ä¸‹å±‚æ¥å£ï¼Œå³ VFS æ¥å£ï¼Œå½“åˆ›é€ ä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿå’Œ VFS ä¸€èµ·å·¥ä½œæ—¶ï¼Œæ–°ç³»ç»Ÿçš„è®¾è®¡è€…å¿…é¡»ç¡®å®šå®ƒæä¾› VFS æ‰€éœ€è¦çš„åŠŸèƒ½è°ƒç”¨ -------------------------------- ç”¨æˆ·è¿›ç¨‹ -------------------------------- | | POSIX æ¥å£ â†“ -------------------------------- VFS -------------------------------- | | | | | | VFS æ¥å£ â†“ â†“ â†“ -------------------------------- FS1 FS2 FS3 å®é™…æ–‡ä»¶ç³»ç»Ÿ -------------------------------- â†‘ â†‘ â†‘ | | | â†“ â†“ â†“ -------------------------------- é«˜é€Ÿç¼“å†²åŒº -------------------------------- ","date":"2023-11-19","objectID":"/posts/filesystems/:3:7","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶ç³»ç»Ÿç®¡ç†å’Œä¼˜åŒ– ","date":"2023-11-19","objectID":"/posts/filesystems/:4:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"ç£ç›˜ç©ºé—´ç®¡ç† å‡ ä¹æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿéƒ½å°†æ–‡ä»¶åˆ†å‰²æˆå›ºå®šå¤§å°çš„å—å­˜å‚¨ï¼Œå„å—ä¹‹é—´ä¸ä¸€å®šç›¸é‚»ã€‚å—çš„å¤§å°æ˜¯ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Œå—å¤ªå°åˆ™æ–‡ä»¶å—æ•°è¶Šå¤šï¼Œéœ€è¦æ›´å¤šæ¬¡çš„å¯»é“ä¸æ—‹è½¬å»¶è¿Ÿæ‰èƒ½è¯»å‡ºå®ƒä»¬ï¼Œä»è€Œé™ä½äº†æ€§èƒ½ã€‚å—å¤ªå¤§ï¼Œåˆ™æ–‡ä»¶çš„æœ€åä¸€ä¸ªå—å­˜åœ¨ç©ºé—´æµªè´¹ã€‚ä»å†å²è§‚ç‚¹ä¸Šæ¥è¯´ï¼Œä¸€èˆ¬è®¾å°†å—å¤§å°ä¸º 1 åˆ° 4 KBï¼Œä½†éšç€ç°åœ¨ç£ç›˜è¶…è¿‡äº† 1 TBï¼Œç£ç›˜ç©ºé—´å·²ç»ä¸å†çŸ­ç¼ºäº†ï¼Œå°†å—çš„å¤§å°æå‡åˆ° 64 KBå¹¶æ¥å—ä¸€äº›æµªè´¹æ¯”è¾ƒå¥½ é€‰å®šå—å¤§å°åï¼Œä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•è®°å½•ç©ºé—²å—ã€‚æœ‰ä¸¤ç§æ–¹æ³•è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä¸€æ˜¯é“¾è¡¨ï¼ŒäºŒæ˜¯ä½å›¾ ä¸ºäº†é˜²æ­¢å ç”¨å¤ªå¤šç£ç›˜ç©ºé—´ï¼Œå¤šç”¨æˆ·æ“ä½œç³»ç»Ÿé€šå¸¸æä¾›äº†å¼ºåˆ¶æ€§ç£ç›˜é…é¢æœºåˆ¶ï¼Œç³»ç»Ÿç®¡ç†å‘˜ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…æ‹¥æœ‰æ–‡ä»¶å’Œå—çš„æœ€å¤§æ•°é‡ï¼Œæ“ä½œç³»ç»Ÿç¡®ä¿æ¯ä¸ªç”¨æˆ·ä¸è¶…è¿‡å¾—åˆ°çš„é…é¢ ","date":"2023-11-19","objectID":"/posts/filesystems/:4:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶ç³»ç»Ÿå¤‡ä»½ ç£ç›˜è½¬å‚¨åˆ°ç£å¸¦ä¸Šæœ‰ä¸¤ç§æ–¹æ¡ˆ ç‰©ç†è½¬å‚¨ï¼šä»ç£ç›˜çš„ç¬¬ 0 å—å¼€å§‹ï¼Œå°†å…¨éƒ¨çš„ç£ç›˜å—æŒ‰åºè¾“å‡ºåˆ°ç£å¸¦ä¸Šï¼Œç›´åˆ°æœ€åä¸€å—å¤åˆ¶å®Œæ¯• é€»è¾‘è½¬å‚¨ï¼šä»ä¸€ä¸ªæˆ–å‡ ä¸ªæŒ‡å®šçš„ç›®å½•å¼€å§‹ï¼Œé€’å½’åœ°è½¬å‚¨å…¶è‡ªç»™å®šæ—¥æœŸåæœ‰æ‰€æ›´æ”¹çš„å…¨éƒ¨æ–‡ä»¶å’Œç›®å½• ","date":"2023-11-19","objectID":"/posts/filesystems/:4:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶ç³»ç»Ÿçš„ä¸€è‡´æ€§ å¾ˆå¤šæ–‡ä»¶ç³»ç»Ÿè¯»å–ç£ç›˜å—ï¼Œä¿®æ”¹åå†å†™å›ç£ç›˜ã€‚å¦‚æœåœ¨å†™å›å®Œæˆå‰ç³»ç»Ÿå´©æºƒï¼Œæ–‡ä»¶ç³»ç»Ÿå¯èƒ½å¤„äºä¸ä¸€è‡´çŠ¶æ€ã€‚ä¸ºæ­¤ï¼Œå¾ˆå¤šè®¡ç®—æœºéƒ½æœ‰ä¸€ä¸ªæ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿä¸€è‡´æ€§çš„å®ç”¨ç¨‹åºï¼Œæ¯”å¦‚ UNIX çš„ fsckã€Windows çš„ scandiskï¼Œç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œç‰¹åˆ«æ˜¯å´©æºƒåçš„é‡å¯ï¼Œå¯ä»¥è¿è¡Œè¯¥ç¨‹åº ä¸€è‡´æ€§æ£€æŸ¥åˆ†ä¸¤ç§ å—çš„ä¸€è‡´æ€§æ£€æŸ¥ï¼šç¨‹åºæ„é€ ä¸¤å¼ è¡¨ï¼Œæ¯å¼ è¡¨ä¸ºæ¯ä¸ªå—è®¾ç«‹ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç¬¬ä¸€å¼ è¡¨è®°å½•å—åœ¨æ–‡ä»¶ä¸­çš„å‡ºç°æ¬¡æ•°ï¼Œç¬¬äºŒå¼ è®°å½•å—åœ¨ç©ºé—²åŒºçš„å‡ºç°æ¬¡æ•°ã€‚å¦‚æœæ–‡ä»¶ç³»ç»Ÿä¸€è‡´ï¼Œæœ€ç»ˆæ¯ä¸€ä¸ªå—åœ¨å…¶ä¸­ä¸€å¼ è¡¨ä¸­çš„è®¡æ•°å™¨ä¸º 1ï¼Œå¦‚æœä¸€ä¸ªå—åœ¨ä¸¤å¼ è¡¨ä¸­çš„è®¡æ•°å™¨éƒ½ä¸º 0ï¼Œåˆ™ç§°ä¸ºå—ä¸¢å¤± æ–‡ä»¶çš„ä¸€è‡´æ€§æ£€æŸ¥ï¼šåŸç†åŒä¸Šï¼ŒåŒºåˆ«æ˜¯ä¸€ä¸ªæ–‡ä»¶(è€Œéä¸€ä¸ªå—)å¯¹åº”ä¸€ä¸ªè®¡æ•°å™¨ã€‚æ³¨æ„ï¼Œç”±äºå­˜åœ¨ç¡¬é“¾æ¥ï¼Œä¸€ä¸ªæ–‡ä»¶å¯èƒ½å‡ºç°åœ¨å¤šä¸ªç›®å½•ä¸­ã€‚è€Œé‡åˆ°ç¬¦å·é“¾æ¥æ˜¯ä¸è®¡æ•°çš„ï¼Œä¸ä¼šå¯¹ç›®æ ‡æ–‡ä»¶çš„è®¡æ•°å™¨åŠ  1 ","date":"2023-11-19","objectID":"/posts/filesystems/:4:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½ è®¿é—®ç£ç›˜æ¯”è®¿é—®å†…å­˜æ…¢å¾ˆå¤šï¼Œå¦‚æœåªéœ€è¦ä¸€ä¸ªå­—ï¼Œå†…å­˜è®¿é—®å¯ä»¥æ¯”ç£ç›˜è®¿é—®å¿«ç™¾ä¸‡æ•°é‡çº§ï¼Œå› æ­¤è®¸å¤šæ–‡ä»¶ç³»ç»Ÿé‡‡ç”¨äº†å„ç§ä¼˜åŒ–æªæ–½æ¥æ”¹å–„æ€§èƒ½ æœ€å¸¸ç”¨çš„å‡å°‘ç£ç›˜è®¿é—®æ¬¡æ•°çš„æŠ€æœ¯æ˜¯å—é«˜é€Ÿç¼“å­˜(block cache)æˆ–ç¼“å†²åŒºé«˜é€Ÿç¼“å­˜(buffer cache)ï¼Œå®ƒä»¬é€»è¾‘ä¸Šå±äºç£ç›˜ï¼Œä½†å®é™…ä¸Šä¿å­˜åœ¨å†…å­˜ä¸­ ç¬¬äºŒä¸ªæ˜æ˜¾æé«˜æ€§èƒ½çš„æŠ€æœ¯æ˜¯å—æå‰è¯»ï¼Œåœ¨éœ€è¦ç”¨åˆ°å—ä¹‹å‰å…ˆå°†å—æå‰å†™å…¥é«˜é€Ÿç¼“å­˜ï¼Œä»è€Œæé«˜å‘½ä¸­ç‡ã€‚å—æå‰è¯»åªé€‚ç”¨äºé¡ºåºè¯»å–çš„æ–‡ä»¶ï¼Œå¦‚æœè¯·æ±‚æ–‡ä»¶ç³»ç»Ÿåœ¨æŸä¸ªæ–‡ä»¶ä¸­ç”Ÿæˆä¸€ä¸ªå—ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†æ½œåœ¨åœ°æ£€æŸ¥é«˜é€Ÿç¼“å­˜ï¼Œå¦‚æœä¸‹ä¸€ä¸ªå—ä¸åœ¨ç¼“å­˜ä¸­ï¼Œåˆ™ä¸ºä¸‹ä¸€ä¸ªå—å®‰æ’ä¸€ä¸ªé¢„è¯» å¦ä¸€ä¸ªé‡è¦æŠ€æœ¯æ˜¯æŠŠå¯èƒ½é¡ºåºè®¿é—®çš„å—æ”¾åœ¨ä¸€èµ·ï¼Œæœ€å¥½æ˜¯åœ¨åŒä¸€ä¸ªæŸ±é¢ä¸Šï¼Œä»è€Œå‡å°‘ç£ç›˜è‡‚çš„ç§»åŠ¨æ¬¡æ•°ã€‚è¿™ä¸ªæŠ€æœ¯ä»…å½“ç£ç›˜ä¸­è£…æœ‰ç£ç›˜è‡‚æ—¶æ‰æœ‰æ„ä¹‰ï¼Œç°åœ¨å›ºæ€ç¡¬ç›˜(SSD)è¶Šæ¥è¶Šæµè¡Œï¼Œè€Œå®ƒä»¬ä¸å¸¦ç§»åŠ¨éƒ¨ä»¶ã€‚å›ºæ€ç¡¬ç›˜é‡‡ç”¨äº†å’Œé—ªå­˜åŒæ ·çš„åˆ¶é€ æŠ€æœ¯ï¼Œä½¿å¾—éšæœºè®¿é—®ä¸é¡ºåºè®¿é—®åœ¨ä¼ è¾“é€Ÿåº¦ä¸Šå·²ç»è¾ƒä¸ºæ¥è¿‘ï¼Œä¼ ç»Ÿç¡¬ç›˜çš„è¯¸å¤šé—®é¢˜å°±æ¶ˆå¤±äº†ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›æ–°é—®é¢˜ï¼Œæ¯”å¦‚æ¯ä¸€å—åªå¯å†™å…¥æœ‰é™æ¬¡æ•°ï¼Œä½¿ç”¨æ—¶è¦ååˆ†å°å¿ƒä»¥è¾¾åˆ°å‡åŒ€åˆ†æ•£ç£¨æŸçš„ç›®çš„ ","date":"2023-11-19","objectID":"/posts/filesystems/:4:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"ç£ç›˜ç¢ç‰‡æ•´ç† éšç€ä¸æ–­åˆ›å»ºä¸åˆ é™¤æ–‡ä»¶ï¼Œç£ç›˜ä¼šé€æ¸äº§ç”Ÿè®¸å¤šç¢ç‰‡ï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æ—¶ï¼Œå…¶ä½¿ç”¨çš„å—ä¼šæ•£å¸ƒåœ¨æ•´ä¸ªç£ç›˜ä¸Šï¼Œé€ æˆæ€§èƒ½é™ä½ ä¸€ä¸ªæ¢å¤æ–¹å¼æ˜¯ï¼Œç§»åŠ¨æ–‡ä»¶ä½¿å…¶ç›¸é‚»ï¼ŒæŠŠç©ºé—²åŒºæ”¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå¤§çš„è¿ç»­åŒºåŸŸå†…ã€‚Windows æœ‰ä¸€ä¸ª defrag ç¨‹åºï¼Œå°±æ˜¯ç”¨äºå®Œæˆè¿™é¡¹å·¥ä½œçš„ï¼ŒWindows ç”¨æˆ·åº”è¯¥å®šæœŸä½¿ç”¨å®ƒã€‚Linux æ–‡ä»¶ç³»ç»Ÿç”±äºå…¶é€‰æ‹©ç£ç›˜å—çš„æ–¹å¼ï¼Œåœ¨ç£ç›˜ç¢ç‰‡æ•´ç†ä¸Šä¸€èˆ¬ä¸ä¼šé‡åˆ° Windows é‚£æ ·çš„å›°éš¾ï¼Œå› æ­¤å¾ˆå°‘éœ€è¦æ‰‹åŠ¨æ•´ç†ç£ç›˜ç¢ç‰‡ å›ºæ€ç¡¬ç›˜ä¸å—ç£ç›˜ç¢ç‰‡çš„å½±å“ï¼Œå¯¹å…¶åšç£ç›˜ç¢ç‰‡æ•´ç†ä¸ä»…æ²¡æœ‰æé«˜æ€§èƒ½ï¼Œåè€Œç£¨æŸäº†ç¡¬ç›˜ï¼Œç¼©çŸ­äº†ä½¿ç”¨å¯¿å‘½ ","date":"2023-11-19","objectID":"/posts/filesystems/:4:5","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | File Systems","uri":"/posts/filesystems/"},{"categories":["C++"],"content":"èµ„æºæ­»é”(resource deadlock) èµ„æºåˆ†ä¸ºä¸¤ç±» å¯æŠ¢å èµ„æº(preemptable resource): å¯ä»¥ä»æ‹¥æœ‰å®ƒçš„è¿›ç¨‹ä¸­æŠ¢å ï¼Œè€Œä¸ä¼šäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ï¼Œå¦‚å­˜å‚¨å™¨ ä¸å¯æŠ¢å èµ„æº(nonpreemptable resource): åœ¨ä¸å¼•èµ·ç›¸å…³çš„è®¡ç®—å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œæ— æ³•æŠŠå®ƒä»å æœ‰å®ƒçš„è¿›ç¨‹å¤„æŠ¢å è¿‡æ¥ï¼Œå¦‚å…‰ç›˜åˆ»å½•æœº æ­»é”ä¸»è¦å…³å¿ƒä¸å¯æŠ¢å èµ„æº å¦‚æœä¸€ä¸ªè¿›ç¨‹é›†åˆä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…é›†åˆä¸­çš„å…¶ä»–è¿›ç¨‹æ‰èƒ½å¼•å‘çš„äº‹ä»¶ï¼Œåˆ™è¯¥è¿›ç¨‹é›†åˆå°±æ˜¯æ­»é”çš„ã€‚é€šå¸¸è¿™ä¸ªäº‹ä»¶æ˜¯å…¶ä»–è¿›ç¨‹é‡Šæ”¾è‡ªèº«å æœ‰çš„èµ„æºï¼Œè¿™ç§æ­»é”ç§°ä¸ºèµ„æºæ­»é”ï¼Œè¿™æ˜¯æœ€å¸¸è§çš„æ­»é”ç±»å‹ï¼Œä½†ä¸æ˜¯å”¯ä¸€çš„ç±»å‹ å‘ç”Ÿèµ„æºæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶æ˜¯: äº’æ–¥æ¡ä»¶: æ¯ä¸ªèµ„æºè¦ä¹ˆåˆ†é…ç»™ä¸€ä¸ªè¿›ç¨‹ï¼Œè¦ä¹ˆæ˜¯å¯ç”¨çš„ å æœ‰å’Œç­‰å¾…æ¡ä»¶: å·²å¾—åˆ°æŸä¸ªèµ„æºçš„è¿›ç¨‹å¯ä»¥å†è¯·æ±‚æ–°çš„èµ„æºï¼Œå¹¶ä¸”ä¸ä¼šé‡Šæ”¾å·²æœ‰èµ„æº ä¸å¯æŠ¢å æ¡ä»¶: å·²åˆ†é…ç»™ä¸€ä¸ªè¿›ç¨‹çš„èµ„æºä¸èƒ½è¢«å¼ºåˆ¶æŠ¢å ï¼Œåªèƒ½è¢«å æœ‰å®ƒçš„è¿›ç¨‹æ˜¾å¼é‡Šæ”¾ ç¯è·¯ç­‰å¾…æ¡ä»¶: æ­»é”å‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿä¸­å¿…ç„¶æœ‰å¤šä¸ªè¿›ç¨‹ç»„æˆä¸€æ¡ç¯è·¯ï¼Œç¯è·¯ä¸­çš„æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…ä¸‹ä¸€ä¸ªè¿›ç¨‹æ‰€å æœ‰çš„èµ„æº ","date":"2023-11-19","objectID":"/posts/deadlocks/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Dead Locks","uri":"/posts/deadlocks/"},{"categories":["C++"],"content":"é¸µé¸Ÿç®—æ³• æœ€ç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ï¼ŒæŠŠå¤´åŸ‹åˆ°æ²™å­é‡Œï¼Œå‡è£…æ ¹æœ¬æ²¡æœ‰é—®é¢˜å‘ç”Ÿã€‚ä¸åŒäººå¯¹è¯¥æ–¹æ³•çš„çœ‹æ³•ä¹Ÿä¸åŒï¼Œæ•°å­¦å®¶è®¤ä¸ºè¿™ç§æ–¹æ³•å®Œå…¨ä¸å¯æ¥å—ï¼Œæ— è®ºä»£ä»·å¤šå¤§éƒ½åº”è¯¥å½»åº•é˜²æ­¢æ­»é”å‘ç”Ÿï¼Œå·¥ç¨‹å¸ˆè®¤ä¸ºè¦æ ¹æ®æ­»é”å‘ç”Ÿçš„é¢‘ç‡ã€ä¸¥é‡ç¨‹åº¦ã€ç³»ç»Ÿå´©æºƒæ¬¡æ•°æ¥å†³å®šï¼Œå¦‚æœæ­»é”æ¯äº”å¹´å‘ç”Ÿä¸€æ¬¡ï¼Œè€Œç³»ç»Ÿæ¯ä¸ªæœˆéƒ½ä¼šå› æ•…éšœå´©æºƒä¸€æ¬¡ï¼Œå°±æ²¡æœ‰å¿…è¦ç”¨æŸå¤±æ€§èƒ½å’Œå¯ç”¨æ€§çš„ä»£ä»·å»é˜²æ­¢æ­»é” ","date":"2023-11-19","objectID":"/posts/deadlocks/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Dead Locks","uri":"/posts/deadlocks/"},{"categories":["C++"],"content":"æ­»é”æ£€æµ‹å’Œæ­»é”æ¢å¤ ç¬¬äºŒç§æŠ€æœ¯æ˜¯æ­»é”æ£€æµ‹å’Œæ¢å¤ï¼Œä½¿ç”¨è¿™ç§æŠ€æœ¯æ—¶ï¼Œç³»ç»Ÿä¸é˜»æ­¢æ­»é”çš„äº§ç”Ÿï¼Œè€Œæ˜¯å…è®¸æ­»é”å‘ç”Ÿï¼Œåœ¨æ£€æµ‹åˆ°æ­»é”å‘ç”Ÿåå†æ¢å¤ ç”¨ E è¡¨ç¤ºç°æœ‰èµ„æºå‘é‡(exisiting resource vector)ï¼ŒA è¡¨ç¤ºå¯ç”¨èµ„æºå‘é‡(available resource vector)ï¼Œç”¨ C è¡¨ç¤ºå½“å‰åˆ†é…çŸ©é˜µ(current allocation matrix)ï¼Œç”¨ R è¡¨ç¤ºè¯·æ±‚çŸ©é˜µ(request matrix)ï¼Œæ­»é”æ£€æµ‹çš„ç®—æ³•æ˜¯ åœ¨ R ä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨æŸä¸€è¡Œ(å³ä¸€ä¸ªè¿›ç¨‹)å°äºç­‰äº A å¦‚æœæ‰¾åˆ°è¿™æ ·ä¸€è¡Œï¼Œå°±å°† C ä¸­ç›¸åŒè¡Œæ•°çš„è¡Œ(å³è¯¥è¿›ç¨‹çš„å·²åˆ†é…èµ„æº)åŠ åˆ° A ä¸­ï¼Œç„¶åæ ‡è®°è¯¥è¿›ç¨‹ï¼Œå†è½¬åˆ°ä¸Šä¸€æ­¥ å¦‚æœä¸å­˜åœ¨è¿™æ ·ä¸€è¡Œï¼Œåˆ™ç®—æ³•ç»ˆæ­¢ã€‚ç®—æ³•ç»“æŸæ—¶ï¼Œæ‰€æœ‰æ²¡æ ‡è®°è¿‡çš„è¿›ç¨‹éƒ½æ˜¯æ­»é”è¿›ç¨‹ æ­»é”æ¢å¤æ–¹æ³•æœ‰: æŠ¢å ã€å›æ»šã€ç»ˆæ­¢è¿›ç¨‹ ","date":"2023-11-19","objectID":"/posts/deadlocks/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Dead Locks","uri":"/posts/deadlocks/"},{"categories":["C++"],"content":"æ­»é”é¿å… å¦‚æœå½“å‰çŠ¶æ€ä¸‹æ²¡æœ‰æ­»é”å‘ç”Ÿï¼Œå¹¶ä¸”å­˜åœ¨æŸç§è°ƒåº¦æ¬¡åºèƒ½ä½¿æ¯ä¸ªè¿›ç¨‹éƒ½è¿è¡Œå®Œæ¯•ï¼Œåˆ™ç§°è¯¥çŠ¶æ€æ˜¯å®‰å…¨çš„ å¯¹äºç›®å‰æœ‰ 3 ä¸ªç©ºé—²èµ„æºçš„å¦‚ä¸‹çŠ¶æ€ï¼Œå…ˆåˆ†é… 2 ä¸ªèµ„æºç»™ Bï¼ŒB è¿è¡Œå®Œé‡Šæ”¾ 4 ä¸ªèµ„æºï¼Œæ­¤æ—¶æœ‰ 5 ä¸ªç©ºé—²èµ„æºï¼Œæ¥ç€ 5 ä¸ªèµ„æºå…¨åˆ†é…ç»™ Cï¼ŒC è¿è¡Œç»“æŸåå°†æœ‰ 9 ä¸ªç©ºé—²èµ„æºï¼Œæœ€åå°† 9 ä¸ªèµ„æºå…¨åˆ†é…ç»™ A å³å¯ã€‚æŒ‰ BCA çš„åˆ†é…é¡ºåºå¯ä»¥ä½¿å¾—æ‰€æœ‰è¿›ç¨‹éƒ½èƒ½å®Œæˆï¼Œå› æ­¤è¿™ä¸ªçŠ¶æ€æ˜¯å®‰å…¨çš„ è¿›ç¨‹ å·²åˆ†é…èµ„æº æœ€å¤§éœ€æ±‚ A 3 9 B 2 4 C 2 7 ç©ºé—²èµ„æºæ•°ä¸º 2 æ—¶çš„å¦‚ä¸‹çŠ¶æ€å°±æ˜¯ä¸å®‰å…¨çŠ¶æ€ã€‚é¦–å…ˆåªèƒ½å…ˆè¿è¡Œ Bï¼ŒB è¿è¡Œç»“æŸåå…±æœ‰ 4 ä¸ªç©ºé—²èµ„æºï¼Œæ— æ³•å†è¿è¡Œ A æˆ– C è¿›ç¨‹ å·²åˆ†é…èµ„æº æœ€å¤§éœ€æ±‚ A 4 9 B 2 4 C 2 7 å®‰å…¨çŠ¶æ€å’Œä¸å®‰å…¨çŠ¶æ€çš„åŒºåˆ«æ˜¯: ä»å®‰å…¨çŠ¶æ€å‡ºå‘ï¼Œç³»ç»Ÿå¯ä»¥ä¿è¯æ‰€æœ‰è¿›ç¨‹éƒ½èƒ½å®Œæˆï¼Œè€Œä»ä¸å®‰å…¨çŠ¶æ€å‡ºå‘å°±æ²¡æœ‰è¿™æ ·çš„ä¿è¯ Dijkstra æå‡ºäº†ä¸€ç§é¿å…æ­»é”çš„è°ƒåº¦ç®—æ³•ï¼Œç§°ä¸ºé“¶è¡Œå®¶ç®—æ³•(bankerâ€™s algorithm)ï¼Œæ–¹æ³•æ˜¯å¯¹æ¯ä¸€ä¸ªè¯·æ±‚è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæ»¡è¶³è¿™ä¸€è¯·æ±‚ä¼šåˆ°è¾¾å®‰å…¨çŠ¶æ€ï¼Œåˆ™æ»¡è¶³è¯¥è¯·æ±‚ï¼Œå¦åˆ™æ¨è¿Ÿå¯¹è¯¥è¯·æ±‚çš„æ»¡è¶³ ä¹‹å‰å®‰å…¨çŠ¶æ€çš„ä¾‹å­è€ƒè™‘çš„å°±æ˜¯å•ä¸ªèµ„æºçš„é“¶è¡Œå®¶ç®—æ³•ï¼Œä¸‹é¢è€ƒè™‘å¤šä¸ªèµ„æºçš„é“¶è¡Œå®¶ç®—æ³• å·²åˆ†é…èµ„æº è¿›ç¨‹ èµ„æº1 èµ„æº2 èµ„æº3 èµ„æº4 A 3 0 1 1 B 0 1 0 0 C 1 1 1 0 D 1 1 0 1 E 0 0 0 0 ä»éœ€è¦çš„èµ„æº è¿›ç¨‹ èµ„æº1 èµ„æº2 èµ„æº3 èµ„æº4 A 1 1 0 0 B 0 1 1 2 C 3 1 0 0 D 0 0 1 0 E 2 1 1 0 å¯¹åº”çš„å½“å‰åˆ†é…çŸ©é˜µ C å’Œè¯·æ±‚çŸ©é˜µ R ä¸º C R 3011 1100 0100 0112 1110 3100 1101 0010 0000 2110 ç”¨ä¸‰ä¸ªå‘é‡è¡¨ç¤ºç°æœ‰èµ„æº Eã€å·²åˆ†é…èµ„æº Pã€å¯ç”¨èµ„æº Aï¼Œè®¡ç®—åˆ†é…çŸ©é˜µ C çš„æ¯åˆ—å’Œå¾—åˆ° P = (5322)ï¼Œä»¥ E = (6342) ä¸ºä¾‹ï¼ŒA = E - P = (1020) æ£€æµ‹ä¸€ä¸ªçŠ¶æ€æ˜¯å¦å®‰å…¨çš„ç®—æ³•æ˜¯ æŸ¥æ‰¾ä¸€ä¸ªä½¿ç”¨å¯ç”¨èµ„æºå³å¯è¿è¡Œçš„è¿›ç¨‹ï¼Œå¦‚æœæ‰¾ä¸åˆ°åˆ™ç³»ç»Ÿå°±ä¼šæ­»é” å¦‚æœæ‰¾åˆ°ï¼Œåˆ™å‡è®¾è¯¥è¿›ç¨‹è·å–æ‰€éœ€èµ„æºå¹¶è¿è¡Œç»“æŸï¼Œå°†è¯¥è¿›ç¨‹æ ‡è®°ä¸ºç»ˆæ­¢ï¼Œå†å°†å…¶èµ„æºåŠ åˆ° A ä¸Š é‡å¤ä¸Šè¿°ä¸¤æ­¥ï¼Œå¦‚æœæœ€åæ‰€æœ‰è¿›ç¨‹éƒ½è¢«æ ‡è®°ä¸ºç»ˆæ­¢ï¼Œåˆ™åˆå§‹çŠ¶æ€æ˜¯å®‰å…¨çš„ å¯¹äºè¿™ä¸ªä¾‹å­ è¿›ç¨‹ D ä»éœ€è¦çš„èµ„æºä¸º (0010)ï¼Œå‡å°äº (1020)ï¼Œå› æ­¤è¿è¡Œ Dï¼ŒD æœ€åˆçš„å·²åˆ†é…èµ„æºä¸º (1101)ï¼Œå› æ­¤ç»“æŸå A = (1020) + (1101) = (2121) è¿›ç¨‹ A ä»éœ€è¦çš„èµ„æºä¸º (1100)ï¼Œå‡å°äºè¿è¡Œ (2121)ï¼Œè¿è¡Œ A(æ­¤æ—¶ E ä¹Ÿæ»¡è¶³æ¡ä»¶ï¼Œä¹Ÿå¯ä»¥è¿è¡Œ E)ï¼ŒA æœ€åˆçš„å·²åˆ†é…èµ„æºä¸º (3011)ï¼Œç»“æŸå A = (2121) + (3011) = (5132) è¿è¡Œ Bï¼Œç»“æŸå A = (5132) + (0100) = (5232) è¿è¡Œ Cï¼Œç»“æŸå A = (5232) + (1110) = (6342) è¿è¡Œ Eï¼Œç»“æŸå A = (6342) + (0000) = (6342) æ‰€æœ‰è¿›ç¨‹éƒ½è¿è¡Œç»“æŸï¼Œå› æ­¤è¿™ä¸ªä¾‹å­çš„çŠ¶æ€æ˜¯å®‰å…¨çš„ ","date":"2023-11-19","objectID":"/posts/deadlocks/:4:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Dead Locks","uri":"/posts/deadlocks/"},{"categories":["C++"],"content":"æ­»é”é¢„é˜² æ­»é”é¿å…æœ¬è´¨ä¸Šæ¥è¯´æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºå®ƒéœ€è¦è·å–æœªæ¥çš„è¯·æ±‚ï¼Œè€Œè¿™äº›è¯·æ±‚æ˜¯ä¸å¯çŸ¥çš„ æ­»é”å‘ç”Ÿæ—¶ï¼Œå››ä¸ªæ¡ä»¶å¿…é¡»åŒæ—¶æˆç«‹ï¼Œå› æ­¤ç ´åå…¶ä¸­æ¡ä»¶å³å¯é¢„é˜²å‘ç”Ÿæ­»é” ç ´åäº’æ–¥æ¡ä»¶: å¦‚æœèµ„æºä¸è¢«ä¸€ä¸ªè¿›ç¨‹ç‹¬å ï¼Œå°±ä¸€å®šä¸ä¼šå‘ç”Ÿæ­»é”ã€‚å®é™…æƒ…å†µä¸­ï¼Œå¦‚æœå…è®¸ä¸¤ä¸ªè¿›ç¨‹åŒæ—¶ä½¿ç”¨æ‰“å°æœºå°±ä¼šé€ æˆæ··ä¹±ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯å‡è„±æœºæ‰“å°æœºæŠ€æœ¯(spooling printer) ç ´åå æœ‰å¹¶ç­‰å¾…æ¡ä»¶: ç¦æ­¢å·²æŒæœ‰èµ„æºçš„è¿›ç¨‹å†ç­‰å¾…å…¶ä»–èµ„æºå³å¯ã€‚ä¸€ç§å®ç°æ–¹æ³•æ˜¯ï¼Œè§„å®šæ‰€æœ‰è¿›ç¨‹åœ¨å¼€å§‹æ‰§è¡Œå‰è¯·æ±‚æ‰€éœ€çš„å…¨éƒ¨èµ„æºã€‚è¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯ï¼Œå¾ˆå¤šè¿›ç¨‹åœ¨è¿è¡Œæ—¶æ‰çŸ¥é“éœ€è¦å¤šå°‘èµ„æºï¼Œå®é™…ä¸Šå¦‚æœè¿›ç¨‹çŸ¥é“éœ€è¦å¤šå°‘èµ„æºå°±å¯ä»¥ä½¿ç”¨é“¶è¡Œå®¶ç®—æ³•ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯ï¼Œå½“è¿›ç¨‹è¯·æ±‚èµ„æºæ—¶ï¼Œå…ˆæš‚æ—¶é‡Šæ”¾å…¶å æœ‰çš„èµ„æºï¼Œå†å°è¯•ä¸€æ¬¡è·å–æ‰€éœ€çš„å…¨éƒ¨èµ„æº ç ´åä¸å¯æŠ¢å æ¡ä»¶: è¿™ç§æ–¹æ³•æ˜¯å¯èƒ½çš„ ç ´åç¯è·¯ç­‰å¾…æ¡ä»¶: å¯¹èµ„æºç¼–å·ï¼Œè¯·æ±‚å¿…é¡»æŒ‰ç¼–å·å‡åºæå‡ºï¼Œä½†é—®é¢˜åœ¨äºï¼Œå‡ ä¹æ‰¾ä¸å‡ºä¸€ç§ä½¿æ¯ä¸ªäººéƒ½æ»¡æ„çš„ç¼–å·æ¬¡åº ","date":"2023-11-19","objectID":"/posts/deadlocks/:5:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Dead Locks","uri":"/posts/deadlocks/"},{"categories":["C++"],"content":"é€šä¿¡æ­»é”(communication deadlock) é™¤äº†æœ€å¸¸è§çš„èµ„æºæ­»é”ï¼Œè¿˜æœ‰é€šä¿¡æ­»é”ã€‚é€šä¿¡æ­»é”å‘ç”Ÿåœ¨é€šä¿¡ç³»ç»Ÿ(å¦‚ç½‘ç»œ)ä¸­ï¼Œæ¯”å¦‚è¿›ç¨‹ A å‘è¿›ç¨‹ B å‘é€è¯·æ±‚ä¿¡æ¯å¹¶é˜»å¡è‡³ B å›å¤ï¼Œå¦‚æœ A å‘é€çš„ä¿¡æ¯ä¸¢å¤±ï¼Œå°±ä¼šå¯¼è‡´ A å’Œ B å‡é˜»å¡ï¼Œä»è€Œå¯¼è‡´æ­»é” é€šä¿¡æ­»é”å¯ä»¥é€šè¿‡è¶…æ—¶æ¥è§£å†³ï¼Œå‘é€è€…åœ¨å‘é€ä¿¡æ¯æ—¶å¯åŠ¨è®¡æ—¶å™¨ï¼Œå¦‚æœè®¡æ—¶å™¨åœ¨å›å¤åˆ°è¾¾å‰åœæ­¢ï¼Œåˆ™å‘é€è€…å¯ä»¥è®¤ä¸ºä¿¡æ¯å·²ä¸¢å¤±ï¼Œå¹¶é‡æ–°å‘é€ ","date":"2023-11-19","objectID":"/posts/deadlocks/:6:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Dead Locks","uri":"/posts/deadlocks/"},{"categories":["C++"],"content":"æ´»é”(livelock) æ´»é”ä¸ä¼šå¯¼è‡´è¿›ç¨‹é˜»å¡ï¼Œç”šè‡³å¯ä»¥è¯´è¿›ç¨‹æ­£åœ¨æ´»åŠ¨ï¼Œå› æ­¤ä¸æ˜¯æ­»é”ï¼Œä½†å®é™…ä¸Šè¿›ç¨‹ä¸ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œå› æ­¤å¯ä»¥ç§°ä¸ºæ´»é” void process_A() { acquire_lock(\u0026resource_1); while (!try_lock(\u0026resource_2)) { // è¿›ç¨‹ A å°è¯•è·å–èµ„æº 2 å¤±è´¥ release_lock(\u0026resource_1); // å…ˆé‡Šæ”¾èµ„æº 1ï¼Œä¸€æ®µæ—¶é—´åå†å°è¯•è·å–èµ„æº 2 wait_fixed_time(); // è‹¥ B æ­¤æ—¶ä¹Ÿåœ¨ç­‰å¾…ï¼Œåˆ™ä¸¤è€…éƒ½è®©å‡ºäº†èµ„æºä½†å¯¹æ–¹éƒ½æœªè·å– acquire_lock(\u0026resource_1); // ä¸¤è€…å„è‡ªæ‹¿å›èµ„æºï¼Œåˆ™ä¸‹æ¬¡è·å–å¯¹æ–¹èµ„æºä»ä¼šå¤±è´¥ } // è‹¥æ­¤è¿‡ç¨‹ä¸€ç›´é‡å¤å°±æ˜¯æ´»é” use_both_resources(); release_lock(\u0026resource_2); release_lock(\u0026resource_1); } void process_B() { acquire_lock(\u0026resource_2); while (!try_lock(\u0026resource_1)) { release_lock(\u0026resource_2); wait_fixed_time(); acquire_lock(\u0026resource_2); } use_both_resources(); release_lock(\u0026resource_1); release_lock(\u0026resource_2); } ","date":"2023-11-19","objectID":"/posts/deadlocks/:7:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action | Dead Locks","uri":"/posts/deadlocks/"},{"categories":["C++"],"content":"å†…å­˜æ¨¡å‹åŸºç¡€ ä¸ºäº†é¿å… race conditionï¼Œçº¿ç¨‹å°±è¦è§„å®šæ‰§è¡Œé¡ºåºã€‚ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨ mutexï¼Œåä¸€çº¿ç¨‹å¿…é¡»ç­‰å¾…å‰ä¸€çº¿ç¨‹è§£é”ã€‚ç¬¬äºŒç§æ–¹å¼æ˜¯ä½¿ç”¨åŸå­æ“ä½œæ¥é¿å…ç«äº‰è®¿é—®åŒä¸€å†…å­˜ä½ç½® åŸå­æ“ä½œæ˜¯ä¸å¯åˆ†å‰²çš„æ“ä½œï¼Œè¦ä¹ˆåšäº†è¦ä¹ˆæ²¡åšï¼Œä¸å­˜åœ¨åšä¸€åŠçš„çŠ¶æ€ã€‚å¦‚æœè¯»å–å¯¹è±¡å€¼çš„åŠ è½½æ“ä½œæ˜¯åŸå­çš„ï¼Œé‚£ä¹ˆå¯¹è±¡ä¸Šçš„æ‰€æœ‰ä¿®æ”¹æ“ä½œä¹Ÿæ˜¯åŸå­çš„ï¼Œè¯»å–çš„è¦ä¹ˆæ˜¯åˆå§‹å€¼ï¼Œè¦ä¹ˆæ˜¯æŸä¸ªä¿®æ”¹å®Œæˆåçš„å­˜å‚¨å€¼ã€‚å› æ­¤ï¼ŒåŸå­æ“ä½œä¸å­˜åœ¨ä¿®æ”¹è¿‡ç¨‹ä¸­å€¼è¢«å…¶ä»–çº¿ç¨‹çœ‹åˆ°çš„æƒ…å†µï¼Œä¹Ÿå°±é¿å…äº†ç«äº‰é£é™© æ¯ä¸ªå¯¹è±¡ä»åˆå§‹åŒ–å¼€å§‹éƒ½æœ‰ä¸€ä¸ªä¿®æ”¹é¡ºåºï¼Œè¿™ä¸ªé¡ºåºç”±æ¥è‡ªæ‰€æœ‰çº¿ç¨‹å¯¹è¯¥å¯¹è±¡çš„å†™æ“ä½œç»„æˆã€‚é€šå¸¸è¿™ä¸ªé¡ºåºåœ¨è¿è¡Œæ—¶ä¼šå˜åŠ¨ï¼Œä½†åœ¨ä»»ä½•ç»™å®šçš„ç¨‹åºæ‰§è¡Œä¸­ï¼Œç³»ç»Ÿä¸­æ‰€æœ‰çº¿ç¨‹éƒ½å¿…é¡»éµå¾ªæ­¤é¡ºåº å¦‚æœå¯¹è±¡ä¸æ˜¯åŸå­ç±»å‹ï¼Œå°±è¦é€šè¿‡åŒæ­¥æ¥ä¿è¯çº¿ç¨‹éµå¾ªæ¯ä¸ªå˜é‡çš„ä¿®æ”¹é¡ºåºã€‚å¦‚æœä¸€ä¸ªå˜é‡å¯¹äºä¸åŒçº¿ç¨‹è¡¨ç°å‡ºä¸åŒçš„å€¼åºåˆ—ï¼Œå°±ä¼šå¯¼è‡´æ•°æ®ç«äº‰å’Œæœªå®šä¹‰è¡Œä¸ºã€‚ä½¿ç”¨åŸå­æ“ä½œå°±å¯ä»¥æŠŠåŒæ­¥çš„è´£ä»»æŠ›ç»™ç¼–è¯‘å™¨ ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"åŸå­æ“ä½œå’ŒåŸå­ç±»å‹ ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"æ ‡å‡†åŸå­ç±»å‹ æ ‡å‡†åŸå­ç±»å‹å®šä¹‰åœ¨ \u003catomic\u003e ä¸­ã€‚ä¹Ÿå¯ä»¥ç”¨ mutex æ¨¡æ‹ŸåŸå­æ“ä½œï¼Œå®é™…ä¸Šæ ‡å‡†åŸå­ç±»å‹å¯èƒ½å°±æ˜¯è¿™æ ·å®ç°çš„ï¼Œå®ƒä»¬éƒ½æœ‰ä¸€ä¸ª is_lock_free å‡½æ•°ï¼Œè¿”å› true è¯´æ˜è¯¥åŸå­ç±»å‹æ“ä½œæ˜¯æ— é”çš„ï¼Œç”¨çš„æ˜¯åŸå­æŒ‡ä»¤ï¼Œè¿”å› false åˆ™æ˜¯ç”¨é” struct A { int a[100]; }; struct B { int x, y; }; assert(!std::atomic\u003cA\u003e{}.is_lock_free()); assert(std::atomic\u003cB\u003e{}.is_lock_free()); åŸå­æ“ä½œçš„ä¸»è¦ç”¨å¤„æ˜¯æ›¿ä»£ mutex å®ç°åŒæ­¥ã€‚å¦‚æœåŸå­æ“ä½œå†…éƒ¨æ˜¯ç”¨ mutex å®ç°çš„ï¼Œå°±ä¸ä¼šæœ‰æœŸæœ›çš„æ€§èƒ½æå‡ï¼Œè¿˜ä¸å¦‚ç›´æ¥ç”¨ mutex æ¥åŒæ­¥ã€‚C++17 ä¸­æ¯ä¸ªåŸå­ç±»å‹éƒ½æœ‰ä¸€ä¸ª is_always_lock_free æˆå‘˜å˜é‡ï¼Œä¸º true æ—¶è¡¨ç¤ºè¯¥åŸå­ç±»å‹åœ¨æ­¤å¹³å°ä¸Š lock-free assert(std::atomic\u003cint\u003e{}.is_always_lock_free); C++17 ä¹‹å‰å¯ä»¥ç”¨æ ‡å‡†åº“ä¸ºå„ä¸ªåŸå­ç±»å‹å®šä¹‰çš„ ATOMIC_xxx_LOCK_FREE å®æ¥åˆ¤æ–­è¯¥ç±»å‹æ˜¯å¦æ— é”ï¼Œå€¼ä¸º 0 è¡¨ç¤ºåŸå­ç±»å‹æ˜¯æœ‰é”çš„ï¼Œä¸º 2 è¡¨ç¤ºæ— é”ï¼Œä¸º 1 è¡¨ç¤ºè¿è¡Œæ—¶æ‰èƒ½ç¡®å®š // LOCK-FREE PROPERTY #define ATOMIC_BOOL_LOCK_FREE 2 #define ATOMIC_CHAR_LOCK_FREE 2 #ifdef __cpp_lib_char8_t #define ATOMIC_CHAR8_T_LOCK_FREE 2 #endif // __cpp_lib_char8_t #define ATOMIC_CHAR16_T_LOCK_FREE 2 #define ATOMIC_CHAR32_T_LOCK_FREE 2 #define ATOMIC_WCHAR_T_LOCK_FREE 2 #define ATOMIC_SHORT_LOCK_FREE 2 #define ATOMIC_INT_LOCK_FREE 2 #define ATOMIC_LONG_LOCK_FREE 2 #define ATOMIC_LLONG_LOCK_FREE 2 #define ATOMIC_POINTER_LOCK_FREE 2 åªæœ‰ std::atomic_flag æœªæä¾› is_lock_freeï¼Œè¯¥ç±»å‹æ˜¯ä¸€ä¸ªç®€å•çš„å¸ƒå°”æ ‡å¿—ï¼Œæ‰€æœ‰æ“ä½œéƒ½ä¿è¯ lock-freeã€‚åŸºäº std::atomic_flag å°±èƒ½å®ç°ä¸€ä¸ªç®€å•çš„é”ï¼Œå¹¶å®ç°å…¶ä»–åŸºç¡€åŸå­ç±»å‹ã€‚å…¶ä½™åŸå­ç±»å‹å¯ä»¥é€šè¿‡ç‰¹åŒ– std::atomic æ¥å®ç°ï¼Œä¸”å¯ä»¥æœ‰æ›´å®Œæ•´çš„åŠŸèƒ½ï¼Œä½†ä¸ä¿è¯ lock-free æ ‡å‡†åº“ä¸­ä¸º std::atomic å¯¹å†…ç½®ç±»å‹çš„ç‰¹åŒ–å®šä¹‰äº†ç±»å‹åˆ«å namespace std { using atomic_bool = atomic\u003cbool\u003e; using atomic_char = std::atomic\u003cchar\u003e; } // namespace std é€šå¸¸ç±»å‹ std::atomic\u003cT\u003e çš„åˆ«åå°±æ˜¯ atomic_Tï¼Œåªæœ‰ä»¥ä¸‹å‡ ç§ä¾‹å¤–ï¼šsigned ç¼©å†™ä¸º sï¼Œunsigned ç¼©å†™ä¸º uï¼Œlong long ç¼©å†™ä¸º llong namespace std { using atomic_schar = std::atomic\u003csigned char\u003e; using atomic_uchar = std::atomic\u003cunsigned char\u003e; using atomic_uint = std::atomic\u003cunsigned\u003e; using atomic_ushort = std::atomic\u003cunsigned short\u003e; using atomic_ulong = std::atomic\u003cunsigned long\u003e; using atomic_llong = std::atomic\u003clong long\u003e; using atomic_ullong = std::atomic\u003cunsigned long long\u003e; } // namespace std åŸå­ç±»å‹ä¸å…è®¸ç”±å¦ä¸€ä¸ªåŸå­ç±»å‹æ‹·è´èµ‹å€¼ï¼Œå› ä¸ºæ‹·è´èµ‹å€¼è°ƒç”¨äº†ä¸¤ä¸ªå¯¹è±¡ï¼Œç ´åäº†æ“ä½œçš„åŸå­æ€§ã€‚ä½†å¯ä»¥ç”¨å¯¹åº”çš„å†…ç½®ç±»å‹èµ‹å€¼ T operator=(T desired) noexcept; T operator=(T desired) volatile noexcept; atomic\u0026 operator=(const atomic\u0026) = delete; atomic\u0026 operator=(const atomic\u0026) volatile = delete; æ­¤å¤– std::atomic ä¸ºæ”¯æŒèµ‹å€¼æä¾›äº†æˆå‘˜å‡½æ•° std::atomic\u003cT\u003e::store // æ›¿æ¢å½“å‰å€¼ std::atomic\u003cT\u003e::load // è¿”å›å½“å‰å€¼ std::atomic\u003cT\u003e::exchange // æ›¿æ¢å€¼ï¼Œå¹¶è¿”å›è¢«æ›¿æ¢å‰çš„å€¼ // ä¸æœŸæœ›å€¼æ¯”è¾ƒï¼Œä¸ç­‰åˆ™å°†æœŸæœ›å€¼è®¾ä¸ºåŸå­å€¼å¹¶è¿”å› false // ç›¸ç­‰åˆ™å°†åŸå­å€¼è®¾ä¸ºç›®æ ‡å€¼å¹¶è¿”å› true // åœ¨ç¼ºå°‘ CASï¼ˆcompare-and-exchangeï¼‰æŒ‡ä»¤çš„æœºå™¨ä¸Šï¼Œweak ç‰ˆæœ¬åœ¨ç›¸ç­‰æ—¶å¯èƒ½æ›¿æ¢å¤±è´¥å¹¶è¿”å› false // å› æ­¤ weak ç‰ˆæœ¬é€šå¸¸è¦æ±‚å¾ªç¯ï¼Œè€Œ strong ç‰ˆæœ¬è¿”å› false å°±èƒ½ç¡®ä¿ä¸ç›¸ç­‰ std::atomic\u003cT\u003e::compare_exchange_weak std::atomic\u003cT\u003e::compare_exchange_strong std::atomic\u003cT\u003e::fetch_add // åŸå­åŠ æ³•ï¼Œè¿”å›ç›¸åŠ å‰çš„å€¼ std::atomic\u003cT\u003e::fetch_sub // åŸå­å‡æ³•ï¼Œè¿”å›ç›¸å‡å‰çš„å€¼ std::atomic\u003cT\u003e::fetch_and std::atomic\u003cT\u003e::fetch_or std::atomic\u003cT\u003e::fetch_xor std::atomic\u003cT\u003e::operator++ // å‰è‡ªå¢ç­‰ä»·äº fetch_add(1) + 1 std::atomic\u003cT\u003e::operator++(int) // åè‡ªå¢ç­‰ä»·äº fetch_add(1) std::atomic\u003cT\u003e::operator-- // å‰è‡ªå‡ç­‰ä»·äº fetch_sub(1) - 1 std::atomic\u003cT\u003e::operator--(int) // åè‡ªå‡ç­‰ä»·äº fetch_sub(1) std::atomic\u003cT\u003e::operator+= // fetch_add(x) + x std::atomic\u003cT\u003e::operator-= // fetch_sub(x) - x std::atomic\u003cT\u003e::operator\u0026= // fetch_and(x) \u0026 x std::atomic\u003cT\u003e::operator|= // fetch_or(x) | x std::atomic\u003cT\u003e::operator^= // fetch_xor(x) ^ x è¿™äº›æˆå‘˜å‡½æ•°æœ‰ä¸€ä¸ªç”¨æ¥æŒ‡å®šå†…å­˜åºçš„å‚æ•° std::memory_orderï¼Œåç»­ä¼šè§£é‡Šå†…å­˜åºçš„å«ä¹‰ typedef enum memory_order { memory_order_relaxed, memory_order_consume, memory_order_acquire, memory_order_release, memory_order_acq_rel, memory_order_seq_cst } memory_order; void store(T desired, std::memory_order order = std::memory_order_seq_cst); // store çš„å†…å­˜åºåªèƒ½æ˜¯ // memory_order_relaxedã€memory_order_releaseã€memory_order_seq_cst T load(std::memory_order order = std::memory_order_seq_cst); // load çš„å†…å­˜åºåªèƒ½æ˜¯ // memory_order_relaxedã€memory_order_consumeã€memory_order_acquireã€memory_order_seq_cst ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:2:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"std::atomic_flag std::atomic_flag æ˜¯ä¸€ä¸ªåŸå­çš„å¸ƒå°”ç±»å‹ï¼Œä¹Ÿæ˜¯å”¯ä¸€ä¿è¯ lock-free çš„åŸå­ç±»å‹ï¼Œåªèƒ½ç”¨ ATOMIC_FLAG_INIT åˆå§‹åŒ–ä¸º false std::atomic_flag x = ATOMIC_FLAG_INIT; x.clear(std::memory_order_release); // å°†çŠ¶æ€è®¾ä¸º false // ä¸èƒ½ä¸ºè¯»æ“ä½œè¯­ä¹‰ï¼šmemory_order_consumeã€memory_order_acquireã€memory_order_acq_rel bool y = x.test_and_set(); // å°†çŠ¶æ€è®¾ä¸º true ä¸”è¿”å›ä¹‹å‰çš„å€¼ ç”¨ std::atomic_flag å®ç°è‡ªæ—‹é” #include \u003catomic\u003e #include \u003ciostream\u003e #include \u003cthread\u003e #include \u003cvector\u003e class Spinlock { public: void lock() { while (flag_.test_and_set(std::memory_order_acquire)) { } } void unlock() { flag_.clear(std::memory_order_release); } private: std::atomic_flag flag_ = ATOMIC_FLAG_INIT; }; Spinlock m; void f(int n) { for (int i = 0; i \u003c 100; ++i) { m.lock(); std::cout \u003c\u003c \"Output from thread \" \u003c\u003c n \u003c\u003c '\\n'; m.unlock(); } } int main() { std::vector\u003cstd::thread\u003e v; for (int i = 0; i \u003c 10; ++i) { v.emplace_back(f, i); } for (auto\u0026 x : v) { x.join(); } } ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:2:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"å…¶ä»–åŸå­ç±»å‹ std::atomic_flag åŠŸèƒ½è¿‡äºå±€é™ï¼Œç”šè‡³æ— æ³•åƒå¸ƒå°”ç±»å‹ä¸€æ ·ä½¿ç”¨ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œstd::atomic\u003cbool\u003e æ›´æ˜“ç”¨ï¼Œå®ƒä¸ä¿è¯ lock-freeï¼Œå¯ä»¥ç”¨ is_lock_free æ£€éªŒåœ¨å½“å‰å¹³å°ä¸Šæ˜¯å¦ lock-free std::atomic\u003cbool\u003e x(true); x = false; bool y = x.load(std::memory_order_acquire); // è¯»å– x å€¼è¿”å›ç»™ y x.store(true); // x å†™ä¸º true y = x.exchange(false, std::memory_order_acq_rel); // x ç”¨ false æ›¿æ¢ï¼Œå¹¶è¿”å›æ—§å€¼ç»™ y bool expected = false; // æœŸæœ›å€¼ // ä¸ç­‰åˆ™å°†æœŸæœ›å€¼è®¾ä¸º x å¹¶è¿”å› falseï¼Œç›¸ç­‰åˆ™å°† x è®¾ä¸ºç›®æ ‡å€¼ true å¹¶è¿”å› true // weak ç‰ˆæœ¬åœ¨ç›¸ç­‰æ—¶ä¹Ÿå¯èƒ½æ›¿æ¢å¤±è´¥è€Œè¿”å› falseï¼Œå› æ­¤ä¸€èˆ¬ç”¨äºå¾ªç¯ while (!x.compare_exchange_weak(expected, true) \u0026\u0026 !expected) { } // å¯¹äºåªæœ‰ä¸¤ç§å€¼çš„ std::atomic\u003cbool\u003e æ¥è¯´æ˜¾å¾—æœ‰äº›ç¹ç // ä½†å¯¹å…¶ä»–åŸå­ç±»å‹æ¥è¯´ï¼Œè¿™ä¸ªå½±å“å°±å¤§äº† æŒ‡é’ˆåŸå­ç±»å‹ std::atomic\u003cT*\u003e ä¹Ÿæ”¯æŒ is_lock_freeã€loadã€storeã€exchangeã€compare_exchange_weakã€compare_exchange_strongï¼Œä¸ std::atomic\u003cbool\u003e è¯­ä¹‰ç›¸åŒï¼Œåªä¸è¿‡è¯»å–å’Œè¿”å›çš„ç±»å‹æ˜¯ T* è€Œé boolã€‚æ­¤å¤–æŒ‡é’ˆåŸå­ç±»å‹è¿˜æ”¯æŒè¿ç®—æ“ä½œï¼šfetch_addã€fetch_subã€++ã€â€“ã€+=ã€-= class A {}; A a[5]; std::atomic\u003cA*\u003e p(a); // p ä¸º \u0026a[0] A* x = p.fetch_add(2); // p ä¸º \u0026a[2]ï¼Œå¹¶è¿”å›åŸå§‹å€¼ a[0] assert(x == a); assert(p.load() == \u0026a[2]); x = (p -= 1); // p ä¸º \u0026a[1]ï¼Œå¹¶è¿”å›ç»™ xï¼Œç›¸å½“äº x = p.fetch_sub(1) - 1 assert(x == \u0026a[1]); assert(p.load() == \u0026a[1]); æ•´å‹åŸå­ç±»å‹ï¼ˆå¦‚ std::atomic\u003cint\u003eï¼‰åœ¨ä¸Šè¿°æ“ä½œä¹‹å¤–è¿˜æ”¯æŒ fetch_orã€fetch_andã€fetch_xorã€|=ã€\u0026=ã€^= std::atomic\u003cint\u003e i(5); int j = i.fetch_and(3); // 101 \u0026 011 = 001 assert(i == 1); assert(j == 5); ç”¨æ•´å‹åŸå­ç±»å‹å®ç° Spinlock #include \u003catomic\u003e class Spinlock { public: void lock() { int expected = 0; while (!flag_.compare_exchange_weak(expected, 1, std::memory_order_release, std::memory_order_relaxed)) { expected = 0; } } void unlock() { flag_.store(0, std::memory_order_release); } private: std::atomic\u003cint\u003e flag_ = 0; }; ç”¨æ•´å‹åŸå­ç±»å‹å®ç° SharedSpinlock #include \u003catomic\u003e class SharedSpinlock { public: void lock() { int expected = 0; while (!flag_.compare_exchange_weak(expected, 1, std::memory_order_release, std::memory_order_relaxed)) { expected = 0; } } void unlock() { flag_.store(0, std::memory_order_release); } void lock_shared() { int expected = 0; while (!flag_.compare_exchange_weak(expected, 2, std::memory_order_release, std::memory_order_acquire) \u0026\u0026 expected == 2) { expected = 0; } count_.fetch_add(1, std::memory_order_release); } void unlock_shared() { if (count_.fetch_sub(1, std::memory_order_release) == 1) { flag_.store(0, std::memory_order_release); } } private: std::atomic\u003cint\u003e flag_ = 0; std::atomic\u003cint\u003e count_ = 0; }; ç”¨æ•´å‹åŸå­ç±»å‹å®ç° Barrier #include \u003catomic\u003e #include \u003cthread\u003e class Barrier { public: explicit Barrier(unsigned n) : count_(n), spaces_(n), generation_(0) {} void wait() { unsigned gen = generation_.load(); if (--spaces_ == 0) { spaces_ = count_.load(); ++generation_; return; } while (generation_.load() == gen) { std::this_thread::yield(); } } void arrive() { --count_; if (--spaces_ == 0) { spaces_ = count_.load(); ++generation_; } } private: std::atomic\u003cunsigned\u003e count_; // éœ€è¦åŒæ­¥çš„çº¿ç¨‹æ•° std::atomic\u003cunsigned\u003e spaces_; // å‰©ä½™æœªåˆ°è¾¾ Barrier çš„çº¿ç¨‹æ•° std::atomic\u003cunsigned\u003e generation_; // æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾ Barrier çš„æ€»æ¬¡æ•° }; å¦‚æœåŸå­ç±»å‹æ˜¯è‡ªå®šä¹‰ç±»å‹ï¼Œè¯¥è‡ªå®šä¹‰ç±»å‹å¿…é¡»å¯å¹³å‡¡å¤åˆ¶ï¼ˆtrivially copyableï¼‰ï¼Œä¹Ÿå°±æ„å‘³ç€è¯¥ç±»å‹ä¸èƒ½æœ‰è™šå‡½æ•°æˆ–è™šåŸºç±»ã€‚è¿™å¯ä»¥ç”¨ is_trivially_copyable æ£€éªŒ class A { public: virtual void f() {} }; assert(!std::is_trivially_copyable_v\u003cA\u003e); std::atomic\u003cA\u003e a; // é”™è¯¯ï¼šA ä¸æ»¡è¶³ trivially copyable std::atomic\u003cstd::vector\u003cint\u003e\u003e v; // é”™è¯¯ std::atomic\u003cstd::string\u003e s; // é”™è¯¯ è‡ªå®šä¹‰ç±»å‹çš„åŸå­ç±»å‹ä¸å…è®¸è¿ç®—æ“ä½œï¼Œåªå…è®¸ is_lock_freeã€loadã€storeã€exchangeã€compare_exchange_weakã€compare_exchange_strongï¼Œä»¥åŠèµ‹å€¼æ“ä½œå’Œå‘è‡ªå®šä¹‰ç±»å‹è½¬æ¢çš„æ“ä½œ é™¤äº†æ¯ä¸ªç±»å‹å„è‡ªçš„æˆå‘˜å‡½æ•°ï¼ŒåŸå­æ“ä½œåº“è¿˜æä¾›äº†é€šç”¨çš„è‡ªç”±å‡½æ•°ï¼Œåªä¸è¿‡å‡½æ•°åå¤šäº†ä¸€ä¸ª atomic_ å‰ç¼€ï¼Œå‚æ•°å˜ä¸ºæŒ‡é’ˆç±»å‹ std::atomic\u003cint\u003e i(42); int j = std::atomic_load(\u0026i); // ç­‰ä»·äº i.load() é™¤ std::atomic_is_lock_free å¤–ï¼Œæ¯ä¸ªè‡ªç”±å‡½æ•°æœ‰ä¸€ä¸ª _explicit åç¼€ç‰ˆæœ¬ï¼Œ_explicit è‡ªç”±å‡½æ•°é¢å¤–æ¥å—ä¸€ä¸ªå†…å­˜åºå‚æ•° std::atomic\u003cint\u003e i(42); std::atomic_load_explicit(\u0026i, std::memory_order_acquire); // i.load(std::memory_order_acquire) è‡ªç”±å‡½æ•°çš„è®¾è®¡ä¸»è¦è€ƒè™‘çš„æ˜¯ C è¯­è¨€æ²¡æœ‰å¼•ç”¨è€Œåªèƒ½ä½¿ç”¨æŒ‡é’ˆï¼Œcompare_exchange_weakã€compare_exchange_strong çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¼•ç”¨ï¼Œå› æ­¤ std::atomic_compare_exchange_weakã€std::atomic_compare_exchange_strong çš„å‚æ•°ç”¨çš„æ˜¯æŒ‡é’ˆ bool compare_exchange_weak(T\u0026 expected, T desired, std::memory_order success, std::memory_order failure); template \u003cclass T\u003e bool atomic_compare_exchange_weak(std::atomic\u003cT\u003e* obj, typename std::atomic\u003cT\u003e::value_type* expected, typename std::atomi","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:2:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"åŒæ­¥æ“ä½œå’Œå¼ºåˆ¶æ’åºï¼ˆenforced orderingï¼‰ ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«è¯»å†™æ•°æ®ï¼Œä¸ºäº†é¿å…ç«äº‰ï¼Œè®¾ç½®ä¸€ä¸ªæ ‡è®° std::vector\u003cint\u003e data; std::atomic\u003cbool\u003e data_ready(false); void read_thread() { while (!data_ready.load()) { // 1 happens-before 2 std::this_thread::sleep_for(std::chrono::milliseconds(1)); } std::cout \u003c\u003c data[0]; // 2 } void write_thread() { data.emplace_back(42); // 3 happens-before 4 data_ready = true; // 4 inter-thread happens-before 1 } std::atomic\u003cbool\u003e ä¸Šçš„æ“ä½œè¦æ±‚å¼ºåˆ¶æ’åºï¼Œè¯¥é¡ºåºç”±å†…å­˜æ¨¡å‹å…³ç³» happens-before å’Œ synchronizes-with æä¾› happens-before ä¿è¯äº† 1 åœ¨ 2 ä¹‹å‰å‘ç”Ÿï¼Œ3 åœ¨ 4 ä¹‹å‰å‘ç”Ÿï¼Œè€Œ 1 è¦æ±‚ 4ï¼Œæ‰€ä»¥ 4 åœ¨ 1 ä¹‹å‰å‘ç”Ÿï¼Œæœ€ç»ˆé¡ºåºç¡®å®šä¸º 3412 å¦‚æœæ²¡æœ‰å¼ºåˆ¶æ’åºï¼ŒCPU å¯èƒ½ä¼šè°ƒæ•´æŒ‡ä»¤é¡ºåºï¼Œå¦‚æœé¡ºåºæ˜¯ 4123ï¼Œè¯»æ“ä½œå°±ä¼šå› ä¸ºè¶Šç•Œè€Œå‡ºé”™ ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"synchronizes-with synchronizes-with å…³ç³»åªå­˜åœ¨äºåŸå­ç±»å‹æ“ä½œä¸Šï¼Œå¦‚æœä¸€ä¸ªæ•°æ®ç»“æ„åŒ…å«åŸå­ç±»å‹ï¼Œè¿™ä¸ªæ•°æ®ç»“æ„ä¸Šçš„æ“ä½œï¼ˆæ¯”å¦‚åŠ é”ï¼‰ä¹Ÿå¯èƒ½æä¾› synchronizes-with å…³ç³» å˜é‡ x ä¸Šï¼Œæ ‡è®°äº†å†…å­˜åºçš„åŸå­å†™æ“ä½œ Wï¼Œå’Œæ ‡è®°äº†å†…å­˜åºçš„åŸå­è¯»æ“ä½œï¼Œå¦‚æœä¸¤è€…å­˜åœ¨ synchronizes-with å…³ç³»ï¼Œè¡¨ç¤ºè¯»æ“ä½œè¯»å–çš„æ˜¯ï¼šW å†™å…¥çš„å€¼ï¼Œæˆ– W ä¹‹ååŒä¸€çº¿ç¨‹ä¸ŠåŸå­å†™æ“ä½œå†™å…¥ x çš„å€¼ï¼Œæˆ–ä»»æ„çº¿ç¨‹ä¸Šå¯¹ x çš„ä¸€ç³»åˆ—åŸå­è¯»æ”¹å†™æ“ä½œï¼ˆæ¯”å¦‚ fetch_addã€compare_exchange_weakï¼‰çš„å€¼ ç®€å•æ¥è¯´ï¼Œå¦‚æœçº¿ç¨‹ A å†™å…¥ä¸€ä¸ªå€¼ï¼Œçº¿ç¨‹ B è¯»å–è¯¥å€¼ï¼Œåˆ™ A synchronizes-with B ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"happens-before happens-before å’Œ strongly-happens-before å…³ç³»æ˜¯ç¨‹åºæ“ä½œé¡ºåºçš„åŸºæœ¬æ„å»ºå—ï¼Œå®ƒæŒ‡å®šæŸä¸ªæ“ä½œå¯ä»¥çœ‹åˆ°å…¶ä»–æ“ä½œçš„ç»“æœã€‚å¯¹å•çº¿ç¨‹æ¥è¯´å¾ˆç®€å•ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œåœ¨å¦ä¸€ä¸ªä¹‹å‰ï¼Œå°±å¯ä»¥è¯´å‰ä¸€ä¸ªæ“ä½œ happens-beforeï¼ˆä¸” strongly-happens-beforeï¼‰ åä¸€ä¸ªæ“ä½œ å¦‚æœæ“ä½œå‘ç”Ÿåœ¨åŒä¸€è¯­å¥ä¸­ï¼Œä¸€èˆ¬ä¸å­˜åœ¨ happens-before å…³ç³»ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æ— åºçš„ #include \u003ciostream\u003e void f(int x, int y) { std::cout \u003c\u003c x \u003c\u003c y; } int g() { static int i = 0; return ++i; } int main() { f(g(), g()); // æ— åºè°ƒç”¨ gï¼Œå¯èƒ½æ˜¯ 21 ä¹Ÿå¯èƒ½æ˜¯ 12 // ä¸€èˆ¬ C++ é»˜è®¤ä½¿ç”¨ __cdecl è°ƒç”¨æ¨¡å¼ï¼Œå‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œå°±æ˜¯21 } å‰ä¸€æ¡è¯­å¥ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½ happens-before ä¸‹ä¸€æ¡è¯­å¥ä¸­çš„æ‰€æœ‰æ“ä½œ ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"inter-thread happens-before å¦‚æœä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ“ä½œ A happens-before å¦ä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ“ä½œ Bï¼Œåˆ™ A inter-thread happens-before B A inter-thread happens-before B åŒ…æ‹¬ä»¥ä¸‹æƒ…å†µ A synchronizes-with B A dependency-ordered-before B A inter-thread happens-before Xï¼ŒX inter-thread happens-before B A sequenced-before Xï¼ŒX inter-thread happens-before B A synchronizes-with Xï¼ŒX sequenced-before B ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:3","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"strongly-happens-before strongly-happens-before å…³ç³»å¤§å¤šæ•°æƒ…å†µä¸‹å’Œ happens-before ä¸€æ ·ï¼ŒA strongly-happens-before B åŒ…æ‹¬ä»¥ä¸‹æƒ…å†µ A synchronizes-with B A sequenced-before Xï¼ŒX inter-thread happens-before B A strongly-happens-before Xï¼ŒX strongly-happens-before B ç•¥å¾®ä¸åŒçš„æ˜¯ï¼Œinter-thread happens-before å…³ç³»å¯ä»¥ç”¨ memory_order_consume æ ‡è®°ï¼Œè€Œ strongly-happens-before ä¸è¡Œã€‚ä½†å¤§å¤šæ•°ä»£ç ä¸åº”è¯¥ä½¿ç”¨ memory_order_consumeï¼Œæ‰€ä»¥è¿™ç‚¹å®é™…ä¸Šå½±å“ä¸å¤§ ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:4","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"std::memory_order typedef enum memory_order { memory_order_relaxed, // æ— åŒæ­¥æˆ–é¡ºåºé™åˆ¶ï¼Œåªä¿è¯å½“å‰æ“ä½œåŸå­æ€§ memory_order_consume, // æ ‡è®°è¯»æ“ä½œï¼Œä¾èµ–äºè¯¥å€¼çš„è¯»å†™ä¸èƒ½é‡æ’åˆ°æ­¤æ“ä½œå‰ memory_order_acquire, // æ ‡è®°è¯»æ“ä½œï¼Œä¹‹åçš„è¯»å†™ä¸èƒ½é‡æ’åˆ°æ­¤æ“ä½œå‰ memory_order_release, // æ ‡è®°å†™æ“ä½œï¼Œä¹‹å‰çš„è¯»å†™ä¸èƒ½é‡æ’åˆ°æ­¤æ“ä½œå memory_order_acq_rel, // ä»…æ ‡è®°è¯»æ”¹å†™æ“ä½œï¼Œè¯»æ“ä½œç›¸å½“äº acquireï¼Œå†™æ“ä½œç›¸å½“äº release memory_order_seq_cst // sequential consistencyï¼šé¡ºåºä¸€è‡´æ€§ï¼Œä¸å…è®¸é‡æ’ï¼Œæ‰€æœ‰åŸå­æ“ä½œçš„é»˜è®¤é€‰é¡¹ } memory_order; ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:5","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"Relaxed ordering æ ‡è®°ä¸º memory_order_relaxed çš„åŸå­æ“ä½œä¸æ˜¯åŒæ­¥æ“ä½œï¼Œä¸å¼ºåˆ¶è¦æ±‚å¹¶å‘å†…å­˜çš„è®¿é—®é¡ºåºï¼Œåªä¿è¯åŸå­æ€§å’Œä¿®æ”¹é¡ºåºä¸€è‡´æ€§ #include \u003catomic\u003e #include \u003cthread\u003e std::atomic\u003cint\u003e x = 0; std::atomic\u003cint\u003e y = 0; void f() { int i = y.load(std::memory_order_relaxed); // 1 x.store(i, std::memory_order_relaxed); // 2 } void g() { int j = x.load(std::memory_order_relaxed); // 3 y.store(42, std::memory_order_relaxed); // 4 } int main() { std::thread t1(f); std::thread t2(g); t1.join(); t2.join(); // å¯èƒ½æ‰§è¡Œé¡ºåºä¸º 4123ï¼Œç»“æœ i == 42, j == 42 } Relaxed ordering ä¸å…è®¸å¾ªç¯ä¾èµ– #include \u003catomic\u003e #include \u003cthread\u003e std::atomic\u003cint\u003e x = 0; std::atomic\u003cint\u003e y = 0; void f() { i = y.load(std::memory_order_relaxed); // 1 if (i == 42) { x.store(i, std::memory_order_relaxed); // 2 } } void g() { j = x.load(std::memory_order_relaxed); // 3 if (j == 42) { y.store(42, std::memory_order_relaxed); // 4 } } int main() { std::thread t1(f); std::thread t2(g); t1.join(); t2.join(); // ç»“æœä¸å…è®¸ä¸ºi == 42, j == 42 // å› ä¸ºè¦äº§ç”Ÿè¿™ä¸ªç»“æœï¼Œ1 ä¾èµ– 4ï¼Œ4 ä¾èµ– 3ï¼Œ3 ä¾èµ– 2ï¼Œ2 ä¾èµ– 1 } å…¸å‹ä½¿ç”¨åœºæ™¯æ˜¯è‡ªå¢è®¡æ•°å™¨ï¼Œæ¯”å¦‚ std::shared_ptr çš„å¼•ç”¨è®¡æ•°å™¨ï¼Œå®ƒåªè¦æ±‚åŸå­æ€§ï¼Œä¸è¦æ±‚é¡ºåºå’ŒåŒæ­¥ #include \u003catomic\u003e #include \u003ciostream\u003e #include \u003cthread\u003e #include \u003cvector\u003e std::atomic\u003cint\u003e x = 0; void f() { for (int i = 0; i \u003c 1000; ++i) { x.fetch_add(1, std::memory_order_relaxed); } } int main() { std::vector\u003cstd::thread\u003e v; for (int i = 0; i \u003c 10; ++i) { v.emplace_back(f); } for (auto\u0026 x : v) { x.join(); } std::cout \u003c\u003c x; // 10000 } ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:6","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"Release-Consume ordering å¯¹äºæ ‡è®°ä¸º memory_order_consume åŸå­å˜é‡ x çš„è¯»æ“ä½œ Rï¼Œå½“å‰çº¿ç¨‹ä¸­ä¾èµ–äº x çš„è¯»å†™ä¸å…è®¸é‡æ’åˆ° R ä¹‹å‰ï¼Œå…¶ä»–çº¿ç¨‹ä¸­å¯¹ä¾èµ–äº x çš„å˜é‡å†™æ“ä½œå¯¹å½“å‰çº¿ç¨‹å¯è§ å¦‚æœçº¿ç¨‹ A å¯¹ä¸€ä¸ªåŸå­å˜é‡xçš„å†™æ“ä½œä¸º memory_order_releaseï¼Œçº¿ç¨‹ B å¯¹åŒä¸€åŸå­å˜é‡çš„è¯»æ“ä½œä¸º memory_order_consumeï¼Œå¸¦æ¥çš„å‰¯ä½œç”¨æ˜¯ï¼Œçº¿ç¨‹ A ä¸­æ‰€æœ‰ dependency-ordered-before è¯¥å†™æ“ä½œçš„å…¶ä»–å†™æ“ä½œï¼ˆnon-atomicå’Œrelaxed atomicï¼‰ï¼Œåœ¨çº¿ç¨‹ B çš„å…¶ä»–ä¾èµ–äºè¯¥å˜é‡çš„è¯»æ“ä½œä¸­å¯è§ å…¸å‹ä½¿ç”¨åœºæ™¯æ˜¯è®¿é—®å¾ˆå°‘è¿›è¡Œå†™æ“ä½œçš„æ•°æ®ç»“æ„ï¼ˆæ¯”å¦‚è·¯ç”±è¡¨ï¼‰ï¼Œä»¥åŠä»¥æŒ‡é’ˆä¸ºä¸­ä»‹çš„ publisher-subscriber åœºæ™¯ï¼Œå³ç”Ÿäº§è€…å‘å¸ƒä¸€ä¸ªæŒ‡é’ˆç»™æ¶ˆè´¹è€…è®¿é—®ä¿¡æ¯ï¼Œä½†ç”Ÿäº§è€…å†™å…¥å†…å­˜çš„å…¶ä»–å†…å®¹ä¸éœ€è¦å¯¹æ¶ˆè´¹è€…å¯è§ï¼Œè¿™ä¸ªåœºæ™¯çš„ä¸€ä¸ªä¾‹å­æ˜¯ RCUï¼ˆRead-Copy Updateï¼‰ã€‚è¯¥é¡ºåºçš„è§„èŒƒæ­£åœ¨ä¿®è®¢ä¸­ï¼Œå¹¶ä¸”æš‚æ—¶ä¸é¼“åŠ±ä½¿ç”¨ memory_order_consume #include \u003catomic\u003e #include \u003ccassert\u003e #include \u003cthread\u003e std::atomic\u003cint*\u003e x; int i; void producer() { int* p = new int(42); i = 42; x.store(p, std::memory_order_release); } void consumer() { int* q; while (!(q = x.load(std::memory_order_consume))) { } assert(*q == 42); // ä¸€å®šä¸å‡ºé”™ï¼š*q å¸¦æœ‰ x çš„ä¾èµ– assert(i == 42); // å¯èƒ½å‡ºé”™ä¹Ÿå¯èƒ½ä¸å‡ºé”™ï¼ši ä¸ä¾èµ–äº x } int main() { std::thread t1(producer); std::thread t2(consumer); t1.join(); t2.join(); } ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:7","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"Release-Acquire ordering å¯¹äºæ ‡è®°ä¸º memory_order_acquire çš„è¯»æ“ä½œ Rï¼Œå½“å‰çº¿ç¨‹çš„å…¶ä»–è¯»å†™æ“ä½œä¸å…è®¸é‡æ’åˆ° R ä¹‹å‰ï¼Œå…¶ä»–çº¿ç¨‹ä¸­åœ¨åŒä¸€åŸå­å˜é‡ä¸Šæ‰€æœ‰çš„å†™æ“ä½œåœ¨å½“å‰çº¿ç¨‹å¯è§ å¦‚æœçº¿ç¨‹ A å¯¹ä¸€ä¸ªåŸå­å˜é‡çš„å†™æ“ä½œ W ä¸º memory_order_releaseï¼Œçº¿ç¨‹ B å¯¹åŒä¸€åŸå­å˜é‡çš„è¯»æ“ä½œä¸º memory_order_acquireï¼Œå¸¦æ¥çš„å‰¯ä½œç”¨æ˜¯ï¼Œçº¿ç¨‹ A ä¸­æ‰€æœ‰ happens-before W çš„å†™æ“ä½œï¼ˆnon-atomic å’Œ relaxed atomicï¼‰éƒ½åœ¨çº¿ç¨‹ B ä¸­å¯è§ å…¸å‹ä½¿ç”¨åœºæ™¯æ˜¯äº’æ–¥é”ï¼Œçº¿ç¨‹ A çš„é‡Šæ”¾åè¢«çº¿ç¨‹ B è·å–ï¼Œåˆ™ A ä¸­é‡Šæ”¾é”ä¹‹å‰å‘ç”Ÿåœ¨ critical section çš„æ‰€æœ‰å†…å®¹éƒ½åœ¨ B ä¸­å¯è§ #include \u003catomic\u003e #include \u003ccassert\u003e #include \u003cthread\u003e std::atomic\u003cint*\u003e x; int i; void producer() { int* p = new int(42); i = 42; x.store(p, std::memory_order_release); } void consumer() { int* q; while (!(q = x.load(std::memory_order_acquire))) { } assert(*q == 42); // ä¸€å®šä¸å‡ºé”™ assert(i == 42); // ä¸€å®šä¸å‡ºé”™ } int main() { std::thread t1(producer); std::thread t2(consumer); t1.join(); t2.join(); } å¯¹äºæ ‡è®°ä¸º memory_order_release çš„å†™æ“ä½œ Wï¼Œå½“å‰çº¿ç¨‹ä¸­çš„å…¶ä»–è¯»å†™æ“ä½œä¸å…è®¸é‡æ’åˆ°Wä¹‹åï¼Œè‹¥å…¶ä»–çº¿ç¨‹ acquire è¯¥åŸå­å˜é‡ï¼Œåˆ™å½“å‰çº¿ç¨‹æ‰€æœ‰ happens-before çš„å†™æ“ä½œåœ¨å…¶ä»–çº¿ç¨‹ä¸­å¯è§ï¼Œè‹¥å…¶ä»–çº¿ç¨‹ consume è¯¥åŸå­å˜é‡ï¼Œåˆ™å½“å‰çº¿ç¨‹æ‰€æœ‰ dependency-ordered-before W çš„å…¶ä»–å†™æ“ä½œåœ¨å…¶ä»–çº¿ç¨‹ä¸­å¯è§ å¯¹äºæ ‡è®°ä¸º memory_order_acq_rel çš„è¯»æ”¹å†™ï¼ˆread-modify-writeï¼‰æ“ä½œï¼Œç›¸å½“äºå†™æ“ä½œæ˜¯ memory_order_releaseï¼Œè¯»æ“ä½œæ˜¯ memory_order_acquireï¼Œå½“å‰çº¿ç¨‹çš„è¯»å†™ä¸å…è®¸é‡æ’åˆ°è¿™ä¸ªå†™æ“ä½œä¹‹å‰æˆ–ä¹‹åï¼Œå…¶ä»–çº¿ç¨‹ä¸­ release è¯¥åŸå­å˜é‡çš„å†™æ“ä½œåœ¨ä¿®æ”¹å‰å¯è§ï¼Œå¹¶ä¸”æ­¤ä¿®æ”¹å¯¹å…¶ä»– acquire è¯¥åŸå­å˜é‡çš„çº¿ç¨‹å¯è§ Release-Acquire ordering å¹¶ä¸è¡¨ç¤º total ordering #include \u003catomic\u003e #include \u003cthread\u003e std::atomic\u003cbool\u003e x = false; std::atomic\u003cbool\u003e y = false; std::atomic\u003cint\u003e z = 0; void write_x() { x.store(true, std::memory_order_release); // 1 happens-before 3ï¼ˆç”±äº 3 çš„å¾ªç¯ï¼‰ } void write_y() { y.store(true, std::memory_order_release); // 2 happens-before 5ï¼ˆç”±äº 5 çš„å¾ªç¯ï¼‰ } void read_x_then_y() { while (!x.load(std::memory_order_acquire)) { // 3 happens-before 4 } if (y.load(std::memory_order_acquire)) { // 4 ++z; } } void read_y_then_x() { while (!y.load(std::memory_order_acquire)) { // 5 happens-before 6 } if (x.load(std::memory_order_acquire)) { // 6 ++z; } } int main() { std::thread t1(write_x); std::thread t2(write_y); std::thread t3(read_x_then_y); std::thread t4(read_y_then_x); t1.join(); t2.join(); t3.join(); t4.join(); // z å¯èƒ½ä¸º 0ï¼Œ134 y ä¸º falseï¼Œ256 x ä¸º falseï¼Œä½† 12 ä¹‹é—´æ²¡æœ‰å…³ç³» } ä¸ºäº†ä½¿ä¸¤ä¸ªå†™æ“ä½œæœ‰åºï¼Œå°†å…¶æ”¾åˆ°ä¸€ä¸ªçº¿ç¨‹é‡Œ #include \u003catomic\u003e #include \u003ccassert\u003e #include \u003cthread\u003e std::atomic\u003cbool\u003e x = false; std::atomic\u003cbool\u003e y = false; std::atomic\u003cint\u003e z = 0; void write_x_then_y() { x.store(true, std::memory_order_relaxed); // 1 happens-before 2 y.store(true, std::memory_order_release); // 2 happens-before 3ï¼ˆç”±äº 3 çš„å¾ªç¯ï¼‰ } void read_y_then_x() { while (!y.load(std::memory_order_acquire)) { // 3 happens-before 4 } if (x.load(std::memory_order_relaxed)) { // 4 ++z; } } int main() { std::thread t1(write_x_then_y); std::thread t2(read_y_then_x); t1.join(); t2.join(); assert(z.load() != 0); // é¡ºåºä¸€å®šä¸º 1234ï¼Œz ä¸€å®šä¸ä¸º 0 } åˆ©ç”¨ Release-Acquire ordering å¯ä»¥ä¼ é€’åŒæ­¥ #include \u003catomic\u003e #include \u003ccassert\u003e std::atomic\u003cbool\u003e x = false; std::atomic\u003cbool\u003e y = false; std::atomic\u003cint\u003e v[2]; void f() { // v[0]ã€v[1] çš„è®¾ç½®æ²¡æœ‰å…ˆåé¡ºåºï¼Œä½†éƒ½ happens-before 1 v[0].store(1, std::memory_order_relaxed); v[1].store(2, std::memory_order_relaxed); x.store(true, std::memory_order_release); // 1 happens-before 2ï¼ˆç”±äº 2 çš„å¾ªç¯ï¼‰ } void g() { while (!x.load(std::memory_order_acquire)) { // 2ï¼šhappens-before 3 } y.store(true, std::memory_order_release); // 3 happens-before 4ï¼ˆç”±äº 4 çš„å¾ªç¯ï¼‰ } void h() { while (!y.load( std::memory_order_acquire)) { // 4 happens-before v[0]ã€v[1] çš„è¯»å– } assert(v[0].load(std::memory_order_relaxed) == 1); assert(v[1].load(std::memory_order_relaxed) == 2); } ä½¿ç”¨è¯»æ”¹å†™æ“ä½œå¯ä»¥å°†ä¸Šé¢çš„ä¸¤ä¸ªæ ‡è®°åˆå¹¶ä¸ºä¸€ä¸ª #include \u003catomic\u003e #include \u003ccassert\u003e std::atomic\u003cint\u003e x = 0; std::atomic\u003cint\u003e v[2]; void f() { v[0].store(1, std::memory_order_relaxed); v[1].store(2, std::memory_order_relaxed); x.store(1, std::memory_order_release); // 1 happens-before 2ï¼ˆç”±äº 2 çš„å¾ªç¯ï¼‰ } void g() { int i = 1; while (!x.compare_exchange_strong( i, 2, std::memory_order_acq_rel)) { // 2 happens-before 3ï¼ˆç”±äº 3 çš„å¾ªç¯ï¼‰ // x ä¸º 1 æ—¶ï¼Œå°† x æ›¿æ¢ä¸º 2ï¼Œè¿”å› true // x ä¸º 0 æ—¶ï¼Œå°† i æ›¿æ¢ä¸º xï¼Œè¿”å› false i = 1; // è¿”å› false æ—¶ï¼Œx æœªè¢«æ›¿æ¢ï¼Œi è¢«æ›¿æ¢ä¸º 0ï¼Œå› æ­¤å°† i é‡æ–°è®¾ä¸º 1 } } void h() { while (x.load(std::memory_order_acquire) \u003c 2) { // 3 } assert(v[0].load(std::memory_order_relaxed) == 1); assert(v[1].load(std::memory_order_relaxed) == 2); } ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:8","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"Sequentially-consistent ordering memory_order_seq_cst æ˜¯æ‰€æœ‰åŸå­æ“ä½œçš„é»˜è®¤é€‰é¡¹ï¼Œå¯ä»¥çœç•¥ä¸å†™ã€‚å¯¹äºæ ‡è®°ä¸º memory_order_seq_cst çš„æ“ä½œï¼Œè¯»æ“ä½œç›¸å½“äº memory_order_acquireï¼Œå†™æ“ä½œç›¸å½“äº memory_order_releaseï¼Œè¯»æ”¹å†™æ“ä½œç›¸å½“äº memory_order_acq_relï¼Œæ­¤å¤–è¿˜é™„åŠ ä¸€ä¸ªå•ç‹¬çš„ total orderingï¼Œå³æ‰€æœ‰çº¿ç¨‹å¯¹åŒä¸€æ“ä½œçœ‹åˆ°çš„é¡ºåºä¹Ÿæ˜¯ç›¸åŒçš„ã€‚è¿™æ˜¯æœ€ç®€å•ç›´è§‚çš„é¡ºåºï¼Œä½†ç”±äºè¦æ±‚å…¨å±€çš„çº¿ç¨‹åŒæ­¥ï¼Œå› æ­¤ä¹Ÿæ˜¯å¼€é”€æœ€å¤§çš„ #include \u003catomic\u003e #include \u003ccassert\u003e #include \u003cthread\u003e std::atomic\u003cbool\u003e x = false; std::atomic\u003cbool\u003e y = false; std::atomic\u003cint\u003e z = 0; // è¦ä¹ˆ 1 happens-before 2ï¼Œè¦ä¹ˆ 2 happens-before 1 void write_x() { x.store(true); // 1 happens-before 3ï¼ˆç”±äº 3 çš„å¾ªç¯ï¼‰ } void write_y() { y.store(true); // 2 happens-before 5ï¼ˆç”±äº 5 çš„å¾ªç¯ï¼‰ } void read_x_then_y() { while (!x.load()) { // 3 happens-before 4 } if (y.load()) { // 4 ä¸º false åˆ™ 1 happens-before 2 ++z; } } void read_y_then_x() { while (!y.load()) { // 5 happens-before 6 } if (x.load()) { // 6 å¦‚æœè¿”å› false åˆ™ä¸€å®šæ˜¯ 2 happens-before 1 ++z; } } int main() { std::thread t1(write_x); std::thread t2(write_y); std::thread t3(read_x_then_y); std::thread t4(read_y_then_x); t1.join(); t2.join(); t3.join(); t4.join(); assert(z.load() != 0); // z ä¸€å®šä¸ä¸º 0 // z å¯èƒ½ä¸º 1 æˆ– 2ï¼Œ12 ä¹‹é—´å¿…å®šå­˜åœ¨ happens-before å…³ç³» } ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:9","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"std::atomic_thread_fence #include \u003catomic\u003e #include \u003ccassert\u003e #include \u003cthread\u003e std::atomic\u003cbool\u003e x, y; std::atomic\u003cint\u003e z; void f() { x.store(true, std::memory_order_relaxed); // 1 happens-before 2 std::atomic_thread_fence(std::memory_order_release); // 2 synchronizes-with 3 y.store(true, std::memory_order_relaxed); } void g() { while (!y.load(std::memory_order_relaxed)) { } std::atomic_thread_fence(std::memory_order_acquire); // 3 happens-before 4 if (x.load(std::memory_order_relaxed)) { // 4 ++z; } } int main() { x = false; y = false; z = 0; std::thread t1(f); std::thread t2(g); t1.join(); t2.join(); assert(z.load() != 0); // 1 happens-before 4 } å°† x æ›¿æ¢ä¸ºéåŸå­ bool ç±»å‹ï¼Œè¡Œä¸ºä¹Ÿä¸€æ · #include \u003catomic\u003e #include \u003ccassert\u003e #include \u003cthread\u003e bool x = false; std::atomic\u003cbool\u003e y; std::atomic\u003cint\u003e z; void f() { x = true; // 1 happens-before 2 std::atomic_thread_fence(std::memory_order_release); // 2 synchronizes-with 3 y.store(true, std::memory_order_relaxed); } void g() { while (!y.load(std::memory_order_relaxed)) { } std::atomic_thread_fence(std::memory_order_acquire); // 3 happens-before 4 if (x) { // 4 ++z; } } int main() { x = false; y = false; z = 0; std::thread t1(f); std::thread t2(g); t1.join(); t2.join(); assert(z.load() != 0); // 1 happens-before 4 } ","date":"2023-11-18","objectID":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/:3:10","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [5] | CH05 C++ Memory Model and Operations on Atomic Types","uri":"/posts/ch05_cpp_memory_model_and_operations_on_atomic_types/"},{"categories":["C++"],"content":"æ¡ä»¶å˜é‡ï¼ˆcondition variableï¼‰ åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œä¸€ç§å¸¸è§çš„éœ€æ±‚æ˜¯ï¼Œä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹å®ŒæˆæŸä¸ªäº‹ä»¶åï¼Œå†ç»§ç»­æ‰§è¡Œä»»åŠ¡ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œæ ‡å‡†åº“æä¾›äº† std::condition_variable #include \u003ccondition_variable\u003e #include \u003ciostream\u003e #include \u003cmutex\u003e #include \u003cthread\u003e class A { public: void step1() { { std::lock_guard\u003cstd::mutex\u003e l(m_); step1_done_ = true; } std::cout \u003c\u003c 1; cv_.notify_one(); } void step2() { std::unique_lock\u003cstd::mutex\u003e l(m_); cv_.wait(l, [this] { return step1_done_; }); step2_done_ = true; std::cout \u003c\u003c 2; cv_.notify_one(); } void step3() { std::unique_lock\u003cstd::mutex\u003e l(m_); cv_.wait(l, [this] { return step2_done_; }); std::cout \u003c\u003c 3; } private: std::mutex m_; std::condition_variable cv_; bool step1_done_ = false; bool step2_done_ = false; }; int main() { A a; std::thread t1(\u0026A::step1, \u0026a); std::thread t2(\u0026A::step2, \u0026a); std::thread t3(\u0026A::step3, \u0026a); t1.join(); t2.join(); t3.join(); } // 123 æœ‰å¤šä¸ªèƒ½å”¤é†’çš„ä»»åŠ¡æ—¶ï¼Œnotify_one() ä¼šéšæœºå”¤é†’ä¸€ä¸ª #include \u003ccondition_variable\u003e #include \u003ciostream\u003e #include \u003cmutex\u003e #include \u003cthread\u003e class A { public: void wait1() { std::unique_lock\u003cstd::mutex\u003e l(m_); cv_.wait(l, [this] { return done_; }); std::cout \u003c\u003c 1; } void wait2() { std::unique_lock\u003cstd::mutex\u003e l(m_); cv_.wait(l, [this] { return done_; }); std::cout \u003c\u003c 2; } void signal() { { std::lock_guard\u003cstd::mutex\u003e l(m_); done_ = true; } cv_.notify_all(); } private: std::mutex m_; std::condition_variable cv_; bool done_ = false; }; int main() { A a; std::thread t1(\u0026A::wait1, \u0026a); std::thread t2(\u0026A::wait2, \u0026a); std::thread t3(\u0026A::signal, \u0026a); t1.join(); t2.join(); t3.join(); } // 12 or 21 std::condition_variable åªèƒ½ä¸ std::unique_lock åä½œï¼Œä¸ºæ­¤æ ‡å‡†åº“æä¾›äº†æ›´é€šç”¨çš„ std::condition_variable_any #include \u003ccondition_variable\u003e #include \u003ciostream\u003e #include \u003cmutex\u003e #include \u003cthread\u003e class Mutex { public: void lock() {} void unlock() {} }; class A { public: void signal() { std::cout \u003c\u003c 1; cv_.notify_one(); } void wait() { Mutex m; cv_.wait(m); std::cout \u003c\u003c 2; } private: std::condition_variable_any cv_; }; int main() { A a; std::thread t1(\u0026A::signal, \u0026a); std::thread t2(\u0026A::wait, \u0026a); t1.join(); t2.join(); } // 12 ä¸ std::stack ä¸€æ ·ï¼Œstd::queue çš„ front å’Œ pop å­˜åœ¨ race conditionï¼Œä¸ºæ­¤å°† front å’Œ pop åˆå¹¶æˆ try_pop å‡½æ•°ï¼Œæ­¤å¤–åˆ©ç”¨ std::condition_variable å®ç° wait_and_pop çš„æ¥å£ï¼Œå½“æ²¡æœ‰å…ƒç´ å¯å¼¹å‡ºæ—¶ä¼šé˜»å¡ï¼Œç›´è‡³æœ‰å…ƒç´ å¯å¼¹å‡º #include \u003ccondition_variable\u003e #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cqueue\u003e template \u003ctypename T\u003e class ConcurrentQueue { public: ConcurrentQueue() = default; ConcurrentQueue(const ConcurrentQueue\u0026 rhs) { std::lock_guard\u003cstd::mutex\u003e l(rhs.m_); q_ = rhs.q_; } void push(T x) { std::lock_guard\u003cstd::mutex\u003e l(m_); q_.push(std::move(x)); cv_.notify_one(); } void wait_and_pop(T\u0026 res) { std::unique_lock\u003cstd::mutex\u003e l(m_); cv_.wait(l, [this] { return !q_.empty(); }); res = std::move(q_.front()); q_.pop(); } std::shared_ptr\u003cT\u003e wait_and_pop() { std::unique_lock\u003cstd::mutex\u003e l(m_); cv_.wait(l, [this] { return !q_.empty(); }); auto res = std::make_shared\u003cT\u003e(std::move(q_.front())); q_.pop(); return res; } bool try_pop(T\u0026 res) { std::lock_guard\u003cstd::mutex\u003e l(m_); if (q_.empty()) { return false; } res = std::move(q_.front()); q_.pop(); return true; } std::shared_ptr\u003cT\u003e try_pop() { std::lock_guard\u003cstd::mutex\u003e l(m_); if (q_.empty()) { return nullptr; } auto res = std::make_shared\u003cT\u003e(std::move(q_.front())); q_.pop(); return res; } bool empty() const { std::lock_guard\u003cstd::mutex\u003e l(m_); // å…¶ä»–çº¿ç¨‹å¯èƒ½æœ‰æ­¤å¯¹è±¡ï¼ˆæ‹·è´æ„é€ ï¼‰æ‰€ä»¥è¦ä¸Šé” return q_.empty(); } private: mutable std::mutex m_; std::condition_variable cv_; std::queue\u003cT\u003e q_; }; è¿™ä¸ªå®ç°æœ‰ä¸€ä¸ªå¼‚å¸¸å®‰å…¨é—®é¢˜ï¼Œnotify_one() åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœå¤šçº¿ç¨‹ç­‰å¾…æ—¶ï¼Œè¢«å”¤é†’çº¿ç¨‹ wait_and_pop ä¸­æŠ›å‡ºå¼‚å¸¸ï¼ˆå¦‚æ„é€  std::shared_ptr å¯¹è±¡æ—¶å¯èƒ½æŠ›å¼‚å¸¸ï¼‰ï¼Œå…¶ä½™çº¿ç¨‹å°†æ°¸è¿œä¸è¢«å”¤é†’ã€‚ç”¨ notify_all() å¯è§£å†³æ­¤é—®é¢˜ï¼Œä½†ä¼šæœ‰ä¸å¿…è¦çš„å”¤é†’ï¼ŒæŠ›å‡ºå¼‚å¸¸æ—¶å†è°ƒç”¨ notify_one() æ›´å¥½ä¸€äº›ã€‚å¯¹äºæ­¤åœºæ™¯ï¼Œæœ€å¥½çš„åšæ³•æ˜¯å°†å†…éƒ¨çš„ std::queue\u003cT\u003e æ”¹ä¸º std::queue\u003cstd::shared_ptr\u003cT\u003e\u003eï¼Œstd::shared_ptr å¯¹è±¡åªåœ¨ push ä¸­æ„é€ ï¼Œè¿™æ · wait_and_pop å°±ä¸ä¼šæŠ›å¼‚å¸¸ #include \u003ccondition_variable\u003e #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cqueue\u003e #include \u003cutility\u003e template \u003ctypename T\u003e class ConcurrentQueue { public: ConcurrentQueue() = default; ConcurrentQueue(const ConcurrentQueue\u0026 rhs) { std::lock_guard\u003cstd::mutex\u003e l(rhs.m_); q_ = rhs.q_; } void push(T x) { a","date":"2023-11-05","objectID":"/posts/ch04_synchronizing_concurrent_operation/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [4] | CH04 Synchronizing concurrent operations","uri":"/posts/ch04_synchronizing_concurrent_operation/"},{"categories":["C++"],"content":"ä¿¡å·é‡ï¼ˆsemaphoreï¼‰ ä¿¡å·é‡ç”¨äºå®ç°å¤šçº¿ç¨‹ä¹‹é—´æŒ‡å®šæ•°é‡çš„äº‹ä»¶é€šçŸ¥ï¼ŒP æ“ä½œå¯¹ä¿¡å·é‡å‡ 1ï¼ŒV æ“ä½œå¯¹ä¿¡å·é‡åŠ  1ï¼Œè‹¥ P æ“ä½œå°†å¯¼è‡´ä¿¡å·é‡å°äº 0 åˆ™é˜»å¡ï¼Œç›´è‡³å¯å‡å°‘ä¿¡å·é‡ä¸ºæ­¢ã€‚C++20 æä¾›äº† std::counting_semaphore ï¼Œæ„é€ æ—¶é€šè¿‡æ¨¡æ¿å‚æ•°è®¾ç½®ä¿¡å·é‡çš„æœ€å¤§å€¼ï¼Œé€šè¿‡å‡½æ•°å‚æ•°è®¾ç½®ä¿¡å·é‡çš„åˆå§‹å€¼ï¼Œacquire() å³ P æ“ä½œï¼Œä¼šåœ¨ä¿¡å·é‡å€¼ä¸å°äº 0 æ—¶å°†ä¿¡å·é‡å‡ 1ï¼Œå¦åˆ™é˜»å¡è‡³å¯ä»¥å‡ 1 ä¸ºæ­¢ï¼Œrelease() å³ V æ“ä½œï¼Œä¼šå°†ä¿¡å·é‡åŠ ä¸ŠæŒ‡å®šå€¼ï¼ˆä¸æŒ‡å®šåˆ™åŠ  1ï¼‰ï¼Œå¹¶å”¤é†’æŒ‡å®šæ•°é‡çš„è¢« acquire() é˜»å¡çš„ä¿¡å·é‡ #include \u003ciostream\u003e #include \u003csemaphore\u003e #include \u003cthread\u003e class A { public: void wait1() { sem_.acquire(); std::cout \u003c\u003c 1; } void wait2() { sem_.acquire(); std::cout \u003c\u003c 2; } void signal() { sem_.release(2); } private: std::counting_semaphore\u003c2\u003e sem_{0}; // åˆå§‹å€¼ 0ï¼Œæœ€å¤§å€¼ 2 }; int main() { A a; std::thread t1(\u0026A::wait1, \u0026a); std::thread t2(\u0026A::wait2, \u0026a); std::thread t3(\u0026A::signal, \u0026a); t1.join(); t2.join(); t3.join(); } // 12 or 21 std::binary_semaphore æ˜¯æœ€å¤§å€¼ä¸º 1 çš„ä¿¡å·é‡ï¼Œå®ƒæ˜¯æ¨¡æ¿å‚æ•°ä¸º 1 çš„ std::counting_semaphore çš„åˆ«å #include \u003ciostream\u003e #include \u003csemaphore\u003e #include \u003cthread\u003e class A { public: void wait() { sem_.acquire(); std::cout \u003c\u003c 2; } void signal() { std::cout \u003c\u003c 1; sem_.release(); } private: std::binary_semaphore sem_{0}; }; int main() { A a; std::thread t1(\u0026A::wait, \u0026a); std::thread t2(\u0026A::signal, \u0026a); t1.join(); t2.join(); } // 12 ","date":"2023-11-05","objectID":"/posts/ch04_synchronizing_concurrent_operation/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [4] | CH04 Synchronizing concurrent operations","uri":"/posts/ch04_synchronizing_concurrent_operation/"},{"categories":["C++"],"content":"å±éšœï¼ˆbarrierï¼‰ C++20 æä¾›äº† std::barrierï¼Œå®ƒç”¨ä¸€ä¸ªå€¼ä½œä¸ºè¦ç­‰å¾…çš„çº¿ç¨‹çš„æ•°é‡æ¥æ„é€ ï¼Œè°ƒç”¨ std::barrier::arrive_and_wait ä¼šé˜»å¡è‡³æ‰€æœ‰çº¿ç¨‹å®Œæˆä»»åŠ¡ï¼ˆå› æ­¤ç§°ä¸ºå±éšœï¼‰ï¼Œå½“æœ€åä¸€ä¸ªçº¿ç¨‹å®Œæˆä»»åŠ¡æ—¶ï¼Œæ‰€æœ‰çº¿ç¨‹è¢«é‡Šæ”¾ï¼Œbarrier è¢«é‡ç½®ã€‚æ„é€  std::barrier æ—¶å¯ä»¥é¢å¤–è®¾ç½®ä¸€ä¸ª noexcept å‡½æ•°ï¼Œå½“æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾é˜»å¡ç‚¹æ—¶ï¼Œç”±å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹è¿è¡Œè¯¥å‡½æ•°ã€‚å¦‚æœæƒ³ä»çº¿ç¨‹é›†ä¸­ç§»é™¤çº¿ç¨‹ï¼Œåˆ™åœ¨è¯¥çº¿ç¨‹ä¸­å¯¹ barrier è°ƒç”¨ std::barrier::arrive_and_drop #include \u003cbarrier\u003e #include \u003ccassert\u003e #include \u003ciostream\u003e #include \u003cthread\u003e class A { public: void f() { std::barrier sync_point{3, [\u0026]() noexcept { ++i_; }}; for (auto\u0026 x : tasks_) { x = std::thread([\u0026] { std::cout \u003c\u003c 1; sync_point.arrive_and_wait(); assert(i_ == 1); std::cout \u003c\u003c 2; sync_point.arrive_and_wait(); assert(i_ == 2); std::cout \u003c\u003c 3; }); } for (auto\u0026 x : tasks_) { x.join(); // ææ„ barrier å‰ join æ‰€æœ‰ä½¿ç”¨äº† barrier çš„çº¿ç¨‹ } // ææ„ barrier æ—¶ï¼Œçº¿ç¨‹å†è°ƒç”¨ barrier çš„æˆå‘˜å‡½æ•°æ˜¯ undefined behavior } private: std::thread tasks_[3] = {}; int i_ = 0; }; int main() { A a; a.f(); } C++20 æä¾›äº† std::latch ä½œä¸ºä¸€æ¬¡æ€§å±éšœï¼Œå®ƒç”¨ä¸€ä¸ªå€¼ä½œä¸ºè®¡æ•°å™¨çš„åˆå§‹å€¼æ¥æ„é€ ï¼Œstd::latch::count_down å°†è®¡æ•°å™¨å‡ 1ï¼Œstd::latch::wait å°†é˜»å¡è‡³è®¡æ•°å™¨ä¸º 0ï¼Œå¦‚æœæƒ³è®©è®¡æ•°å™¨å‡ä¸€å¹¶é˜»å¡è‡³ä¸º 0 åˆ™å¯ä»¥è°ƒç”¨ std::latch::arrive_and_wait #include \u003ciostream\u003e #include \u003clatch\u003e #include \u003cstring\u003e #include \u003cthread\u003e class A { public: void f() { for (auto\u0026 x : data_) { x.t = std::jthread([\u0026] { x.s += x.s; done_.count_down(); }); } done_.wait(); for (auto\u0026 x : data_) { std::cout \u003c\u003c x.s \u003c\u003c std::endl; } } private: struct { std::string s; std::jthread t; } data_[3] = { {\"hello\"}, {\"down\"}, {\"demo\"}, }; std::latch done_{3}; }; int main() { A a; a.f(); } ","date":"2023-11-05","objectID":"/posts/ch04_synchronizing_concurrent_operation/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [4] | CH04 Synchronizing concurrent operations","uri":"/posts/ch04_synchronizing_concurrent_operation/"},{"categories":["C++"],"content":"æœŸå€¼ï¼ˆfutureï¼‰ std::thread åªèƒ½è¿è¡Œå‡½æ•°ï¼Œæ— æ³•è·å–å‡½æ•°çš„è¿”å›å€¼ï¼Œä¸ºæ­¤æ ‡å‡†åº“æä¾›äº† std::future æ¥å…³è”çº¿ç¨‹è¿è¡Œçš„å‡½æ•°å’Œå‡½æ•°çš„è¿”å›ç»“æœï¼Œè¿™ç§è·å–ç»“æœçš„æ–¹å¼æ˜¯å¼‚æ­¥çš„ã€‚é€šè¿‡ std::async() åˆ›å»ºå¼‚æ­¥ä»»åŠ¡çš„ std::futureï¼Œstd::async çš„åˆ›å»ºä»»åŠ¡çš„ä¼ å‚æ–¹å¼å’Œ std::thread ä¸€æ · #include \u003cfuture\u003e #include \u003ciostream\u003e class A { public: int f(int i) { return i; } }; int main() { A a; std::future\u003cint\u003e res = std::async(\u0026A::f, \u0026a, 1); std::cout \u003c\u003c res.get(); // 1ï¼Œé˜»å¡è‡³çº¿ç¨‹è¿”å›ç»“æœ } std::future åªèƒ½ get() ä¸€æ¬¡ #include \u003cfuture\u003e #include \u003ciostream\u003e int main() { std::future\u003cvoid\u003e res = std::async([] {}); res.get(); try { res.get(); } catch (const std::future_error\u0026 e) { std::cout \u003c\u003c e.what() \u003c\u003c std::endl; // no state } } std::async çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šä¸ºæšä¸¾ std::launch çš„å€¼ï¼Œç”¨äºè®¾ç½®ä»»åŠ¡çš„è¿è¡Œç­–ç•¥ namespace std { enum class launch { // names for launch options passed to async async = 0x1, // è¿è¡Œæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ deferred = 0x2 // æƒ°æ€§æ±‚å€¼ï¼Œè¯·æ±‚ç»“æœæ—¶æ‰æ‰§è¡Œä»»åŠ¡ }; } // std::async åˆ›å»ºä»»åŠ¡é»˜è®¤ä½¿ç”¨ä¸¤è€… std::async([] {}); // ç­‰ä»·äº std::async(std::launch::async | std::launch::deferred, [] {}) è¿˜å¯ä»¥ç”¨ std::packaged_task å°è£…å¼‚æ­¥ä»»åŠ¡ï¼Œå®ƒå¯ä»¥ç”¨äºåœ¨ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´ä¼ é€’ä»»åŠ¡ï¼Œæ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹å°†å¼‚æ­¥ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸æ–­ä»é˜Ÿåˆ—ä¸­å–ä»»åŠ¡æ‰§è¡Œ #include \u003cfuture\u003e #include \u003ciostream\u003e int main() { std::packaged_task\u003cint(int)\u003e task([](int i) { return i; }); task(1); // è¯·æ±‚è®¡ç®—ç»“æœï¼Œå†…éƒ¨çš„ future å°†è®¾ç½®ç»“æœå€¼ std::future\u003cint\u003e res = task.get_future(); std::cout \u003c\u003c res.get(); // 1 } ä¸€ç§æ›´ç®€å•çš„æƒ…å†µæ˜¯ï¼Œåªéœ€è¦ä¸€ä¸ªå›ºå®šçš„è¿”å›å€¼ï¼Œä¸ºæ­¤ä½¿ç”¨ std::promise å³å¯ #include \u003cfuture\u003e #include \u003ciostream\u003e int main() { std::promise\u003cint\u003e ps; ps.set_value(1); // å†…éƒ¨çš„ future å°†è®¾ç½®ç»“æœå€¼ std::future\u003cint\u003e res = ps.get_future(); std::cout \u003c\u003c res.get(); // 1 } std::promise å¯ä»¥å®ç°äº‹ä»¶é€šçŸ¥çš„æ•ˆæœ #include \u003cchrono\u003e #include \u003cfuture\u003e #include \u003ciostream\u003e class A { public: void signal() { std::cout \u003c\u003c 1; ps_.set_value(); } void wait() { std::future\u003cvoid\u003e res = ps_.get_future(); res.wait(); std::cout \u003c\u003c 2; } private: std::promise\u003cvoid\u003e ps_; }; int main() { A a; std::thread t1{\u0026A::signal, \u0026a}; std::thread t2{\u0026A::wait, \u0026a}; t1.join(); t2.join(); } ä¸åŒäº std::condition_variable çš„æ˜¯ï¼Œstd::promise åªèƒ½é€šçŸ¥ä¸€æ¬¡ï¼Œå› æ­¤é€šå¸¸ç”¨æ¥åˆ›å»ºæš‚åœçŠ¶æ€çš„çº¿ç¨‹ #include \u003cchrono\u003e #include \u003cfuture\u003e #include \u003ciostream\u003e class A { public: void task() { std::cout \u003c\u003c 1; } void wait_for_task() { ps_.get_future().wait(); task(); } void signal() { ps_.set_value(); } private: std::promise\u003cvoid\u003e ps_; }; void task() { std::cout \u003c\u003c 1; } int main() { A a; std::thread t(\u0026A::wait_for_task, \u0026a); a.signal(); t.join(); } std::promise åªèƒ½å…³è”ä¸€ä¸ª std::future #include \u003cfuture\u003e #include \u003ciostream\u003e int main() { std::promise\u003cvoid\u003e ps; auto a = ps.get_future(); try { auto b = ps.get_future(); } catch (const std::future_error\u0026 e) { std::cout \u003c\u003c e.what() \u003c\u003c std::endl; // future already retrieved } } std::future å¯ä»¥å­˜å‚¨ä»»åŠ¡ä¸­çš„å¼‚å¸¸ #include \u003cfuture\u003e #include \u003ciostream\u003e #include \u003cstdexcept\u003e int main() { std::future\u003cvoid\u003e res = std::async([] { throw std::logic_error(\"error\"); }); try { res.get(); } catch (const std::exception\u0026 e) { std::cout \u003c\u003c e.what() \u003c\u003c std::endl; } } std::promise éœ€è¦æ‰‹åŠ¨å­˜å‚¨å¼‚å¸¸ #include \u003cfuture\u003e #include \u003ciostream\u003e #include \u003cstdexcept\u003e int main() { std::promise\u003cvoid\u003e ps; try { throw std::logic_error(\"error\"); } catch (...) { ps.set_exception(std::current_exception()); } auto res = ps.get_future(); try { res.get(); } catch (const std::exception\u0026 e) { std::cout \u003c\u003c e.what() \u003c\u003c std::endl; } } æ³¨æ„ set_value() æ—¶çš„å¼‚å¸¸ä¸ä¼šè¢«è®¾ç½®åˆ° future ä¸­ #include \u003cfuture\u003e #include \u003ciostream\u003e #include \u003cstdexcept\u003e int main() { std::promise\u003cint\u003e ps; try { ps.set_value([] { throw std::logic_error(\"error\"); return 0; }()); } catch (const std::exception\u0026 e) { std::cout \u003c\u003c e.what() \u003c\u003c std::endl; } ps.set_value(1); auto res = ps.get_future(); std::cout \u003c\u003c res.get(); // 1 } å¦‚æœ std::packaged_task å’Œ std::promise ç›´åˆ°ææ„éƒ½æœªè®¾ç½®å€¼ï¼Œstd::future::get() ä¼šæŠ›å¼‚å¸¸ #include \u003cfuture\u003e #include \u003ciostream\u003e int main() { std::future\u003cvoid\u003e ft1; std::future\u003cvoid\u003e ft2; { std::packaged_task\u003cvoid()\u003e task([] {}); std::promise\u003cvoid\u003e ps; ft1 = task.get_future(); ft2 = ps.get_future(); } try { ft1.get(); } catch (const std::future_error\u0026 e) { std::cout \u003c\u003c e.what() \u003c\u003c std::endl; // broken promise } try { ft2.get(); } catch (const std::future_error\u0026 e) { std::cout \u003c\u003c e.what() \u003c\u003c std::endl; // broken promise } } std::shared_future å¯ä»¥å¤šæ¬¡è·å–ç»“æœï¼Œå®ƒå¯ä»¥é€šè¿‡ st","date":"2023-11-05","objectID":"/posts/ch04_synchronizing_concurrent_operation/:4:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [4] | CH04 Synchronizing concurrent operations","uri":"/posts/ch04_synchronizing_concurrent_operation/"},{"categories":["C++"],"content":"æ—¶é’Ÿ å¯¹äºæ ‡å‡†åº“æ¥è¯´ï¼Œæ—¶é’Ÿæ˜¯æä¾›äº†å››ç§ä¿¡æ¯çš„ç±» å½“å‰æ—¶é—´ï¼Œå¦‚ std::chrono::system_clock::now() è¡¨ç¤ºæ—¶é—´å€¼çš„ç±»å‹ï¼Œå¦‚ std::chrono::time_point æ—¶é’ŸèŠ‚æ‹ï¼ˆä¸€ä¸ª tick çš„å‘¨æœŸï¼‰ï¼Œä¸€èˆ¬ä¸€ç§’æœ‰ 25 ä¸ª tickï¼Œä¸€ä¸ªå‘¨æœŸåˆ™ä¸º std::ratio\u003c1, 25\u003e é€šè¿‡æ—¶é’ŸèŠ‚æ‹ç¡®å®šæ—¶é’Ÿæ˜¯å¦ç¨³å®šï¼ˆsteadyï¼ŒåŒ€é€Ÿï¼‰ï¼Œå¦‚ std::chrono::steady_clock::is_steady()ï¼ˆç¨³å®šæ—¶é’Ÿï¼Œä»£è¡¨ç³»ç»Ÿæ—¶é’Ÿçš„çœŸå®æ—¶é—´ï¼‰ã€std::chrono::system_clock::is_steady()ï¼ˆä¸€èˆ¬å› ä¸ºæ—¶é’Ÿå¯è°ƒèŠ‚è€Œä¸ç¨³å®šï¼Œå³ä½¿è¿™æ˜¯ä¸ºäº†è€ƒè™‘æœ¬åœ°æ—¶é’Ÿåå·®çš„è‡ªåŠ¨è°ƒèŠ‚ï¼‰ã€high_resolution_clock::is_steady()ï¼ˆæœ€å°èŠ‚æ‹æœ€é«˜ç²¾åº¦çš„æ—¶é’Ÿï¼‰ è·å–å½“å‰ UNIX æ—¶é—´æˆ³ï¼Œå•ä½ä¸ºçº³ç§’ #ifdef _WIN32 #include \u003cchrono\u003e #elif defined __GNUC__ #include \u003ctime.h\u003e #endif long long now_in_ns() { #ifdef _WIN32 return std::chrono::duration_cast\u003cstd::chrono::nanoseconds\u003e( std::chrono::system_clock::now().time_since_epoch()) .count(); #elif defined __GNUC__ struct timespec t; clockid_t clk_id = CLOCK_REALTIME; clock_gettime(clk_id, \u0026t); return t.tv_sec * 1e9 + t.tv_nsec; #endif } ç”¨ std::put_time æ ¼å¼åŒ–æ‰“å°æ—¶é—´ #include \u003cchrono\u003e #include \u003ciomanip\u003e #include \u003ciostream\u003e int main() { std::chrono::system_clock::time_point t = std::chrono::system_clock::now(); std::time_t c = std::chrono::system_clock::to_time_t(t); // UNIX æ—¶é—´æˆ³ï¼Œç§’ // %F å³ %Y-%m-%dï¼Œ%T å³ %H:%M:%Sï¼Œå¦‚ 2011-11-11 11:11:11 std::cout \u003c\u003c std::put_time(std::localtime(\u0026c), \"%F %T\"); } std::chrono::duration è¡¨ç¤ºæ—¶é—´é—´éš” namespace std { namespace chrono { using nanoseconds = duration\u003clong long, nano\u003e; using microseconds = duration\u003clong long, micro\u003e; using milliseconds = duration\u003clong long, milli\u003e; using seconds = duration\u003clong long\u003e; using minutes = duration\u003cint, ratio\u003c60\u003e\u003e; using hours = duration\u003cint, ratio\u003c3600\u003e\u003e; // C++20 using days = duration\u003cint, ratio_multiply\u003cratio\u003c24\u003e, hours::period\u003e\u003e; using weeks = duration\u003cint, ratio_multiply\u003cratio\u003c7\u003e, days::period\u003e\u003e; using years = duration\u003cint, ratio_multiply\u003cratio\u003c146097, 400\u003e, days::period\u003e\u003e; using months = duration\u003cint, ratio_divide\u003cyears::period, ratio\u003c12\u003e\u003e\u003e; } // namespace chrono } // namespace std C++14 åœ¨ std::literals::chrono_literals ä¸­æä¾›äº†è¡¨ç¤ºæ—¶é—´çš„åç¼€ #include \u003ccassert\u003e #include \u003cchrono\u003e using namespace std::literals::chrono_literals; int main() { auto a = 45min; assert(a.count() == 45); auto b = std::chrono::duration_cast\u003cstd::chrono::seconds\u003e(a); assert(b.count() == 2700); auto c = std::chrono::duration_cast\u003cstd::chrono::hours\u003e(a); assert(c.count() == 0); // è½¬æ¢ä¼šæˆªæ–­ } duration æ”¯æŒå››åˆ™è¿ç®— #include \u003ccassert\u003e #include \u003cchrono\u003e using namespace std::literals::chrono_literals; int main() { assert((1h - 2 * 15min).count() == 30); assert((0.5h + 2 * 15min + 60s).count() == 3660); } ä½¿ç”¨ duration è®¾ç½®ç­‰å¾…æ—¶é—´ #include \u003cchrono\u003e #include \u003cfuture\u003e #include \u003ciostream\u003e #include \u003cthread\u003e int f() { std::this_thread::sleep_for(std::chrono::seconds(1)); return 1; } int main() { auto res = std::async(f); if (res.wait_for(std::chrono::seconds(5)) == std::future_status::ready) { std::cout \u003c\u003c res.get(); } } std::chrono::time_point æ˜¯è¡¨ç¤ºæ—¶é—´çš„ç±»å‹ï¼Œå€¼ä¸ºä»æŸä¸ªæ—¶é—´ç‚¹å¼€å§‹è®¡æ—¶çš„æ—¶é—´é•¿åº¦ // ç¬¬ä¸€ä¸ªæ¨¡æ¿å‚æ•°ä¸ºå¼€å§‹æ—¶é—´ç‚¹çš„æ—¶é’Ÿç±»å‹ï¼Œç¬¬äºŒä¸ªä¸ºæ—¶é—´å•ä½ std::chrono::time_point\u003cstd::chrono::system_clock, std::chrono::seconds\u003e std::chrono::time_point å¯ä»¥ä¸ duration åŠ å‡ï¼Œä¹Ÿå¯ä»¥ä¸è‡ªèº«ç›¸å‡ #include \u003ccassert\u003e #include \u003cchrono\u003e int main() { std::chrono::system_clock::time_point a = std::chrono::system_clock::now(); std::chrono::system_clock::time_point b = a + std::chrono::hours(1); long long diff = std::chrono::duration_cast\u003cstd::chrono::seconds\u003e(b - a).count(); assert(diff == 3600); } å¦‚ä¸‹å‡½æ•°æ”¯æŒè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå‡½æ•°æœ€å¤šé˜»å¡è‡³æ—¶é—´åˆ°æœŸ std::this_thread::sleep_for std::this_thread::sleep_until std::condition_variable::wait_for std::condition_variable::wait_until std::condition_variable_any::wait_for std::condition_variable_any::wait_until std::timed_mutex::try_lock_for std::timed_mutex::try_lock_until std::recursive_timed_mutex::try_lock_for std::recursive_timed_mutex::try_lock_until std::unique_lock::try_lock_for std::unique_lock::try_lock_until std::future::wait_for std::future::wait_until std::shared_future::wait_for std::shared_future::wait_until std::counting_semaphore::try_acquire_for std::counting_semaphore::try_acquire_until ç”±äºä¸åŒæœºå™¨çš„ CPU é¢‘ç‡ä¸åŒï¼Œä¸ºäº†è¿›è¡Œæ›´ç²¾ç¡®çš„æ€§èƒ½æµ‹è¯•ï¼Œé€šå¸¸ä¸ç›´æ¥ä½¿ç”¨æ—¶é—´è€Œæ˜¯ç”¨ rdtsc æŒ‡ä»¤è·å– CPU å‘¨æœŸï¼Œrdtsc æŠŠ tsc çš„ä½ 32 ä½å­˜æ”¾åœ¨ EAXï¼Œé«˜ 32 ä½å­˜æ”¾åœ¨ EDXï¼Œä¸åŒ CPU ä¸Šè·å–çš„ tsc å¯èƒ½ä¸åŒæ­¥ï¼Œå¦‚æœå¼€å¯äº† constant_tsc çš„ flagï¼ˆé€šè¿‡ cat /proc/cpuinfo | gre","date":"2023-11-05","objectID":"/posts/ch04_synchronizing_concurrent_operation/:5:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [4] | CH04 Synchronizing concurrent operations","uri":"/posts/ch04_synchronizing_concurrent_operation/"},{"categories":["C++"],"content":"å‡½æ•°å¼ç¼–ç¨‹ï¼ˆfunctional programmingï¼‰ å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œä½¿ç”¨çš„å‡½æ•°ä¸ºçº¯å‡½æ•°ï¼Œå³å¦‚æœå‡½æ•°çš„è°ƒç”¨å‚æ•°ç›¸åŒï¼Œåˆ™æ°¸è¿œè¿”å›ç›¸åŒçš„ç»“æœï¼Œçº¯å‡½æ•°ä¸ä¼šæ”¹å˜å¤–éƒ¨çŠ¶æ€ï¼Œå› æ­¤å¯¹äºåªä½¿ç”¨çº¯å‡½æ•°çš„å‡½æ•°å¼ç¼–ç¨‹ï¼Œå¤©ç”Ÿå°±ä¸å­˜åœ¨ race condition çš„é—®é¢˜ã€‚Haskell æ˜¯ä¸€ç§å¸¸è§çš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œä»¥å¿«é€Ÿæ’åºä¸ºä¾‹ï¼ŒHaskell ä¸­çš„å®ç°å¦‚ä¸‹ quickSort :: Ord a =\u003e [a] -\u003e [a] quickSort [] = [] quickSort (x : xs) = l ++ [x] ++ r where l = quickSort (filter (\u003c= x) xs) r = quickSort (filter (\u003e x) xs) main :: IO () main = print (quickSort \"downdemo\") -- \"ddemnoow\" ç›¸åŒæ€è·¯çš„ C++ å®ç° #include \u003calgorithm\u003e #include \u003ciostream\u003e #include \u003clist\u003e #include \u003cutility\u003e template \u003ctypename T\u003e std::list\u003cT\u003e quick_sort(std::list\u003cT\u003e v) { if (v.empty()) { return v; } std::list\u003cT\u003e res; res.splice(res.begin(), v, v.begin()); // å°† v çš„é¦–å…ƒç´ ç§»åˆ° res ä¸­ // å°† v æŒ‰æ¡ä»¶åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªä¸æ»¡è¶³æ¡ä»¶å…ƒç´ çš„è¿­ä»£å™¨ auto it = std::partition(v.begin(), v.end(), [\u0026](const T\u0026 x) { return x \u003c res.front(); }); std::list\u003cT\u003e low; low.splice(low.end(), v, v.begin(), it); // è½¬ç§»å·¦åŠéƒ¨åˆ†åˆ° low auto l(quick_sort(std::move(low))); // é€’å½’å¯¹å·¦åŠéƒ¨åˆ†å¿«é€Ÿæ’åº auto r(quick_sort(std::move(v))); // é€’å½’å¯¹å³åŠéƒ¨åˆ†å¿«é€Ÿæ’åº res.splice(res.end(), r); // å³åŠéƒ¨åˆ†ç§»åˆ°ç»“æœå res.splice(res.begin(), l); // å·¦åŠéƒ¨åˆ†ç§»åˆ°ç»“æœå‰ return res; } int main() { for (auto\u0026 x : quick_sort(std::list\u003cint\u003e{1, 3, 2, 4, 5})) { std::cout \u003c\u003c x; // 12345 } } ä½¿ç”¨ std::future å®ç°å¹¶è¡Œç‰ˆæœ¬ #include \u003calgorithm\u003e #include \u003cfuture\u003e #include \u003ciostream\u003e #include \u003clist\u003e #include \u003cutility\u003e template \u003ctypename T\u003e std::list\u003cT\u003e quick_sort(std::list\u003cT\u003e v) { if (v.empty()) { return v; } std::list\u003cT\u003e res; res.splice(res.begin(), v, v.begin()); auto it = std::partition(v.begin(), v.end(), [\u0026](const T\u0026 x) { return x \u003c res.front(); }); std::list\u003cT\u003e low; low.splice(low.end(), v, v.begin(), it); // ç”¨å¦ä¸€ä¸ªçº¿ç¨‹å¯¹å·¦åŠéƒ¨åˆ†æ’åº std::future\u003cstd::list\u003cT\u003e\u003e l(std::async(\u0026quick_sort\u003cT\u003e, std::move(low))); auto r(quick_sort(std::move(v))); res.splice(res.end(), r); res.splice(res.begin(), l.get()); return res; } int main() { for (auto\u0026 x : quick_sort(std::list\u003cint\u003e{1, 3, 2, 4, 5})) { std::cout \u003c\u003c x; // 12345 } } ","date":"2023-11-05","objectID":"/posts/ch04_synchronizing_concurrent_operation/:6:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [4] | CH04 Synchronizing concurrent operations","uri":"/posts/ch04_synchronizing_concurrent_operation/"},{"categories":["C++"],"content":"é“¾å¼è°ƒç”¨ é“¾å¼è°ƒç”¨æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­ç»å¸¸ä½¿ç”¨çš„å½¢å¼ï¼Œå¸¸è§äº ReactiveXï¼Œæ¯”å¦‚ RxJSï¼Œå½“ä¸Šæ¸¸äº§ç”Ÿæ•°æ®æ—¶äº¤ç»™ä¸‹æ¸¸å¤„ç†ï¼Œå°†å¤æ‚çš„å¼‚æ­¥é€»è¾‘æ‹†æ•£æˆäº†å¤šä¸ªå°çš„æ“ä½œï¼Œåªéœ€è¦å…³æ³¨æ¯ä¸€æ­¥æ“ä½œå¹¶é€æ­¥è½¬æ¢åˆ°ç›®æ ‡ç»“æœå³å¯ã€‚C++20 çš„ ranges ä½¿ç”¨çš„ range-v3 å°±è„±èƒè‡ª RxCpp import { interval } from 'rxjs'; import { withLatestFrom } from 'rxjs/operators'; const source1$ = interval(500); const source2$ = interval(1000); source1$.pipe(withLatestFrom(source2$, (x, y) =\u003e `${x}${y}`)); // 10 20 31 41 52 62--- å¹¶å‘TS æä¾›äº† std::experimental::promise å’Œ std::experimental::packaged_taskï¼Œä¸æ ‡å‡†åº“å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå®ƒä»¬è¿”å› std::experimental::futureï¼Œstd::experimental::future::then() å¯é“¾å¼è°ƒç”¨ int f(std::experimental::future\u003cint\u003e); std::experimental::future\u003cint\u003e eft; auto ft1 = eft(); // std::experimental::future ç”±æœ¬èº«çš„æ„é€ å‡½æ•°ç”Ÿæˆ // ä¸ std::async ä¸åŒï¼Œä¸èƒ½ä¼ å…¥ f çš„å‚æ•° // å› ä¸ºå‚æ•°å·²ç»åœ¨è¿è¡Œåº“ä¸­å®šä¹‰ä¸ºäº†ä¸€ä¸ªå°±ç»ªçš„æœŸå€¼ // è¿™é‡Œ f çš„è¿”å› intï¼Œå› æ­¤å‚æ•°å°±æ˜¯ std::experimental::future\u003cint\u003e auto ft2 = ft1.then(f); // then ååŸæœŸå€¼å°±æ— æ•ˆäº† assert(!ft1.valid()); assert(ft2.valid()); std::async åªèƒ½è¿”å› std::futureï¼Œå¦‚æœæƒ³è¿”å› std::experimental::future åˆ™éœ€è¦æ‰‹åŠ¨å®ç°ä¸€ä¸ªæ–°çš„async template \u003ctypename F\u003e std::experimental::future\u003cdecltype(std::declval\u003cF\u003e()())\u003e new_async(F\u0026\u0026 func) { std::experimental::promise\u003cdecltype(std::declval\u003cF\u003e()())\u003e p; auto ft = p.get_future(); std::thread t([p = std::move(p), f = std::decay_t\u003cF\u003e(func)]() mutable { try { p.set_value_at_thread_exit(f()); } catch (...) { p.set_exception_at_thread_exit(std::current_exception()); } }); t.detach(); return ft; } å‡å¦‚è¦å®ç°ä¸€ä¸ªç™»å½•é€»è¾‘ï¼Œå°†ç”¨æˆ·åå’Œå¯†ç å‘é€ç»™åå°éªŒè¯ï¼Œå–å¾—ç”¨æˆ·ä¿¡æ¯åæ›´æ–°åˆ°æ˜¾ç¤ºç•Œé¢ï¼Œä¸²è¡Œå®ç°å¦‚ä¸‹ void process_login(const std::string\u0026 username, const std::string\u0026 password) { try { const user_id id = backend.authenticate_user(username, password); const user_data info_to_display = backend.request_current_info(id); update_display(info_to_display); } catch (std::exception\u0026 e) { display_error(e); } } ä¸ºäº†ä¸é˜»å¡ UI çº¿ç¨‹ï¼Œå°±éœ€è¦å¼‚æ­¥å®ç° std::future\u003cvoid\u003e process_login(const std::string\u0026 username, const std::string\u0026 password) { return std::async(std::launch::async, [=]() { try { const user_id id = backend.authenticate_user(username, password); const user_data info_to_display = backend.request_current_info(id); update_display(info_to_display); } catch (std::exception\u0026 e) { display_error(e); } }); } ä½†è¿™ä¸ªå®ç°ä»ç„¶ä¼šé˜»å¡ UI çº¿ç¨‹ï¼Œä¸ºæ­¤å°±éœ€è¦é“¾å¼è°ƒç”¨çš„æœºåˆ¶ï¼Œæ¯ä¸ªä»»åŠ¡å®Œæˆåè¿æ¥åˆ°å‰ä¸€ä¸ªä»»åŠ¡ä¸Š std::experimental::future\u003cvoid\u003e process_login(const std::string\u0026 username, const std::string\u0026 password) { return new_async( [=]() { return backend.authenticate_user(username, password); }) .then([](std::experimental::future\u003cuser_id\u003e id) { return backend.request_current_info(id.get()); }) .then([](std::experimental::future\u003cuser_data\u003e info_to_display) { try { update_display(info_to_display.get()); } catch (std::exception\u0026 e) { display_error(e); } }); } å¦‚æœè°ƒç”¨åå°å‡½æ•°å†…éƒ¨é˜»å¡ï¼Œå¯èƒ½æ˜¯å› ä¸ºéœ€è¦ç­‰å¾…æ¶ˆæ¯é€šè¿‡ç½‘ç»œæˆ–è€…å®Œæˆä¸€ä¸ªæ•°æ®åº“æ“ä½œï¼Œè€Œè¿™äº›è¿˜æ²¡æœ‰å®Œæˆã€‚å³ä½¿æŠŠä»»åŠ¡åˆ’åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹éƒ¨åˆ†ï¼Œä¹Ÿä»ä¼šé˜»å¡è°ƒç”¨ï¼Œå¾—åˆ°é˜»å¡çš„çº¿ç¨‹ã€‚è¿™æ—¶åå°è°ƒç”¨çœŸæ­£éœ€è¦çš„æ˜¯ï¼Œåœ¨æ•°æ®å‡†å¤‡å¥½æ—¶è¿”å›å°±ç»ªçš„æœŸå€¼ï¼Œè€Œä¸é˜»å¡ä»»ä½•çº¿ç¨‹ï¼Œæ‰€ä»¥è¿™é‡Œç”¨è¿”å› std::experimental::future\u003cuser_id\u003e çš„ backend.async_authenticate_user æ›¿ä»£è¿”å› user_id çš„ backend.authenticate_user std::experimental::future\u003cvoid\u003e process_login(const std::string\u0026 username, const std::string\u0026 password) { return backend.async_authenticate_user(username, password) .then([](std::experimental::future\u003cuser_id\u003e id) { return backend.async_request_current_info(id.get()); }) .then([](std::experimental::future\u003cuser_data\u003e info_to_display) { try { update_display(info_to_display.get()); } catch (std::exception\u0026 e) { display_error(e); } }); } è¿™æ ·åœ¨å¼‚æ­¥å‡½æ•°é“¾ä¸Šå°±ä¸å­˜åœ¨é˜»å¡äº†ã€‚æœ€åè¿™é‡Œè¿˜å¯ä»¥ç”¨æ³›å‹ lambda æ¥ç®€åŒ–ä»£ç  std::experimental::future\u003cvoid\u003e process_login(const std::string\u0026 username, const std::string\u0026 password) { return backend.async_authenticate_user(username, password) .then( [](auto id) { return backend.async_request_current_info(id.get()); }) .then([](auto info_to_display) { try { update_display(info_to_display.get()); } catch (std::exception\u0026 e) { display_error(e); } }); } é™¤äº† std::experimental::futureï¼Œæ”¯æŒé“¾å¼è°ƒç”¨çš„è¿˜æœ‰ std::experimental::shared_future auto ft1 = new_async(some_function).share(); auto ft2 = ft1.then( [](std::experimental::shared_future\u003csome_data\u003e data) { do_stuff(data); }); auto ft3 = ft1.then([](std::experimental::shared_future\u003csome_data\u003e data) { return do_other_stuff(data); }); ä½¿ç”¨ std::asy","date":"2023-11-05","objectID":"/posts/ch04_synchronizing_concurrent_operation/:7:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [4] | CH04 Synchronizing concurrent operations","uri":"/posts/ch04_synchronizing_concurrent_operation/"},{"categories":["C++"],"content":"CSPï¼ˆCommunicating Sequential Processesï¼‰ CSP æ˜¯ä¸€ç§æè¿°å¹¶å‘ç³»ç»Ÿäº¤äº’çš„ç¼–ç¨‹æ¨¡å‹ï¼Œçº¿ç¨‹ç†è®ºä¸Šæ˜¯åˆ†å¼€çš„ï¼Œæ²¡æœ‰å…±äº«æ•°æ®ï¼Œæ¯ä¸ªçº¿ç¨‹å¯ä»¥å®Œå…¨ç‹¬ç«‹åœ°æ€è€ƒï¼Œæ¶ˆæ¯é€šè¿‡ communication channel åœ¨ä¸åŒçº¿ç¨‹é—´ä¼ é€’ï¼Œçº¿ç¨‹è¡Œä¸ºå–å†³äºæ”¶åˆ°çš„æ¶ˆæ¯ï¼Œå› æ­¤æ¯ä¸ªçº¿ç¨‹å®é™…ä¸Šæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œæ”¶åˆ°ä¸€æ¡æ¶ˆæ¯æ—¶å°±ä»¥æŸç§æ–¹å¼æ›´æ–°çŠ¶æ€ï¼Œå¹¶ä¸”è¿˜å¯èƒ½å‘é€æ¶ˆæ¯ç»™å…¶ä»–çº¿ç¨‹ã€‚Erlang é‡‡ç”¨äº†è¿™ç§ç¼–ç¨‹æ¨¡å‹ï¼Œå¹¶ç”¨äº MPI åš C å’Œ C++ çš„é«˜æ€§èƒ½è®¡ç®—ã€‚çœŸæ­£çš„ CSP æ²¡æœ‰å…±äº«æ•°æ®ï¼Œæ‰€æœ‰é€šä¿¡é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ä¼ é€’ï¼Œä½†ç”±äº C++ çº¿ç¨‹å…±äº«åœ°å€ç©ºé—´ï¼Œæ— æ³•å¼ºåˆ¶å®ç°è¿™ä¸ªè¦æ±‚ï¼Œæ‰€ä»¥éœ€è¦åº”ç”¨æˆ–è€…åº“çš„ä½œè€…æ¥ç¡®ä¿çº¿ç¨‹é—´ä¸ä¼šå…±äº«æ•°æ® è€ƒè™‘å®ç°ä¸€ä¸ª ATM åº”ç”¨ï¼Œå®ƒéœ€è¦å¤„ç†å–é’±æ—¶å’Œé“¶è¡Œçš„äº¤äº’ï¼Œå¹¶æ§åˆ¶ç‰©ç†æœºå™¨å¯¹é“¶è¡Œå¡çš„ååº”ã€‚ä¸€ä¸ªå¤„ç†æ–¹æ³•æ˜¯åˆ†ä¸‰ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«å¤„ç†ç‰©ç†æœºå™¨ã€ATM é€»è¾‘ã€ä¸é“¶è¡Œçš„äº¤äº’ï¼Œçº¿ç¨‹é—´é€šè¿‡æ¶ˆæ¯é€šè®¯è€Œéå…±äº«æ•°æ®ï¼Œæ¯”å¦‚æ’å¡æ—¶æœºå™¨çº¿ç¨‹å‘é€æ¶ˆæ¯ç»™é€»è¾‘çº¿ç¨‹ï¼Œé€»è¾‘çº¿ç¨‹è¿”å›ä¸€æ¡æ¶ˆæ¯é€šçŸ¥æœºå™¨çº¿ç¨‹å¯ä»¥ç»™å¤šå°‘é’± ä¸€ä¸ªç®€å•çš„ ATM é€»è¾‘çš„çŠ¶æ€æœºå»ºæ¨¡å¦‚ä¸‹ è¿™ä¸ª ATM é€»è¾‘çš„çŠ¶æ€æœºä¸ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†å„è‡ªè¿è¡Œåœ¨ç‹¬ç«‹çš„çº¿ç¨‹ä¸Šï¼Œä¸éœ€è¦è€ƒè™‘åŒæ­¥å’Œå¹¶å‘çš„é—®é¢˜ï¼Œåªè¦è€ƒè™‘åœ¨æŸä¸ªç‚¹æ¥å—å’Œå‘é€çš„æ¶ˆæ¯ï¼Œè¿™ç§è®¾è®¡æ–¹å¼ç§°ä¸º actor modelï¼Œç³»ç»Ÿä¸­æœ‰å¤šä¸ªç‹¬ç«‹çš„ actorï¼Œactor ä¹‹é—´å¯ä»¥äº’ç›¸å‘é€æ¶ˆæ¯ä½†ä¸ä¼šå…±äº«çŠ¶æ€ï¼Œè¿™ç§æ–¹å¼å¯ä»¥æå¤§ç®€åŒ–å¹¶å‘ç³»ç»Ÿçš„è®¾è®¡ã€‚å®Œæ•´çš„ä»£ç å®ç°è§æ­¤ ref: https://github.com/downdemo/Cpp-Concurrency-in-Action-2ed ","date":"2023-11-05","objectID":"/posts/ch04_synchronizing_concurrent_operation/:8:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [4] | CH04 Synchronizing concurrent operations","uri":"/posts/ch04_synchronizing_concurrent_operation/"},{"categories":["C++"],"content":"çº¿ç¨‹é—´å…±äº«æ•°æ®å­˜åœ¨çš„é—®é¢˜ ä¸å˜é‡ï¼ˆinvariantï¼‰ï¼šå…³äºä¸€ä¸ªç‰¹å®šæ•°æ®ç»“æ„æ€»ä¸º true çš„è¯­å¥ï¼Œæ¯”å¦‚ åŒå‘é“¾è¡¨çš„ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹ A å’Œ Bï¼ŒA çš„åæŒ‡é’ˆä¸€å®šæŒ‡å‘ Bï¼ŒB çš„å‰æŒ‡é’ˆä¸€å®šæŒ‡å‘ Aã€‚æœ‰æ—¶ç¨‹åºä¸ºäº†æ–¹ä¾¿ä¼šæš‚æ—¶ç ´åä¸å˜é‡ï¼Œè¿™é€šå¸¸å‘ç”Ÿäºæ›´æ–°å¤æ‚æ•°æ®ç»“æ„çš„è¿‡ç¨‹ä¸­ï¼Œæ¯”å¦‚åˆ é™¤åŒå‘é“¾è¡¨ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ Nï¼Œè¦å…ˆè®© N çš„å‰ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘ N çš„åä¸€ä¸ªèŠ‚ç‚¹ï¼ˆä¸å˜é‡è¢«ç ´åï¼‰ï¼Œå†è®© N çš„åèŠ‚ç‚¹æŒ‡å‘å‰èŠ‚ç‚¹ï¼Œæœ€ååˆ é™¤ Nï¼ˆæ­¤æ—¶ä¸å˜é‡é‡æ–°æ¢å¤ï¼‰ çº¿ç¨‹ä¿®æ”¹å…±äº«æ•°æ®æ—¶ï¼Œå°±ä¼šå‘ç”Ÿç ´åä¸å˜é‡çš„æƒ…å†µï¼Œæ­¤æ—¶å¦‚æœæœ‰å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œå°±å¯èƒ½å¯¼è‡´ä¸å˜é‡è¢«æ°¸ä¹…æ€§ç ´åï¼Œè¿™å°±æ˜¯ race condition å¦‚æœçº¿ç¨‹æ‰§è¡Œé¡ºåºçš„å…ˆåå¯¹ç»“æœæ— å½±å“ï¼Œåˆ™ä¸ºä¸éœ€è¦å…³å¿ƒçš„è‰¯æ€§ç«äº‰ã€‚éœ€è¦å…³å¿ƒçš„æ˜¯ä¸å˜é‡è¢«ç ´åæ—¶äº§ç”Ÿçš„ race condition C++ æ ‡å‡†ä¸­å®šä¹‰äº† data race çš„æ¦‚å¿µï¼ŒæŒ‡ä»£ä¸€ç§ç‰¹å®šçš„ race conditionï¼Œå³å¹¶å‘ä¿®æ”¹å•ä¸ªå¯¹è±¡ã€‚data race ä¼šé€ æˆæœªå®šä¹‰è¡Œä¸º race condition è¦æ±‚ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ—¶ï¼Œå¦ä¸€çº¿ç¨‹è®¿é—®åŒä¸€æ•°æ®å—ï¼Œå‡ºç°é—®é¢˜æ—¶å¾ˆéš¾å¤ç°ï¼Œå› æ­¤ç¼–ç¨‹æ—¶éœ€è¦ä½¿ç”¨å¤§é‡å¤æ‚æ“ä½œæ¥é¿å… race condition ","date":"2023-11-04","objectID":"/posts/ch03_sharing_data_between_threads/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [3] | CH03 Sharing Data Between Threads","uri":"/posts/ch03_sharing_data_between_threads/"},{"categories":["C++"],"content":"äº’æ–¥é”ï¼ˆmutexï¼‰ ä½¿ç”¨ mutex åœ¨è®¿é—®å…±äº«æ•°æ®å‰åŠ é”ï¼Œè®¿é—®ç»“æŸåè§£é”ã€‚ä¸€ä¸ªçº¿ç¨‹ç”¨ç‰¹å®šçš„ mutex é”å®šåï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»ç­‰å¾…è¯¥çº¿ç¨‹çš„ mutex è§£é”æ‰èƒ½è®¿é—®å…±äº«æ•°æ® C++11 æä¾›äº† std::mutex æ¥åˆ›å»ºä¸€ä¸ª mutexï¼Œå¯é€šè¿‡ lock åŠ é”ï¼Œé€šè¿‡ unlock è§£é”ã€‚ä¸€èˆ¬ä¸æ‰‹åŠ¨ä½¿ç”¨è¿™ä¸¤ä¸ªæˆå‘˜å‡½æ•°ï¼Œè€Œæ˜¯ä½¿ç”¨ std::lock_guard æ¥è‡ªåŠ¨å¤„ç†åŠ é”ä¸è§£é”ï¼Œå®ƒåœ¨æ„é€ æ—¶æ¥å—ä¸€ä¸ª mutexï¼Œå¹¶ä¼šè°ƒç”¨ mutex.lock()ï¼Œææ„æ—¶ä¼šè°ƒç”¨ mutex.unlock() #include \u003ciostream\u003e #include \u003cmutex\u003e class A { public: void lock() { std::cout \u003c\u003c \"lock\" \u003c\u003c std::endl; } void unlock() { std::cout \u003c\u003c \"unlock\" \u003c\u003c std::endl; } }; int main() { A a; { std::lock_guard\u003cA\u003e l(a); // lock } // unlock } C++17 æä¾›äº†çš„ std::scoped_lockï¼Œå®ƒå¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„ mutexï¼Œå¹¶å°†è¿™äº› mutex ä¼ ç»™ std::lock æ¥åŒæ—¶ä¸Šé”ï¼Œå®ƒä¼šå¯¹å…¶ä¸­ä¸€ä¸ª mutex è°ƒç”¨ lock()ï¼Œå¯¹å…¶ä»–è°ƒç”¨ try_lock()ï¼Œè‹¥ try_lock() è¿”å› false åˆ™å¯¹å·²ç»ä¸Šé”çš„ mutex è°ƒç”¨ unlock()ï¼Œç„¶åé‡æ–°è¿›è¡Œä¸‹ä¸€è½®ä¸Šé”ï¼Œæ ‡å‡†æœªè§„å®šä¸‹ä¸€è½®çš„ä¸Šé”é¡ºåºï¼Œå¯èƒ½ä¸ä¸€è‡´ï¼Œé‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°æ‰€æœ‰ mutex ä¸Šé”ï¼Œä»è€Œè¾¾åˆ°åŒæ—¶ä¸Šé”çš„æ•ˆæœã€‚C++17 æ”¯æŒç±»æ¨¡æ¿å®å‚æ¨æ–­ï¼Œå¯ä»¥çœç•¥æ¨¡æ¿å‚æ•° #include \u003ciostream\u003e #include \u003cmutex\u003e class A { public: void lock() { std::cout \u003c\u003c 1; } void unlock() { std::cout \u003c\u003c 2; } bool try_lock() { std::cout \u003c\u003c 3; return true; } }; class B { public: void lock() { std::cout \u003c\u003c 4; } void unlock() { std::cout \u003c\u003c 5; } bool try_lock() { std::cout \u003c\u003c 6; return true; } }; int main() { A a; B b; { std::scoped_lock l(a, b); // 16 std::cout \u003c\u003c std::endl; } // 25 } ä¸€èˆ¬ mutex å’Œè¦ä¿æŠ¤çš„æ•°æ®ä¸€èµ·æ”¾åœ¨ç±»ä¸­ï¼Œå®šä¹‰ä¸º private æ•°æ®æˆå‘˜ï¼Œè€Œéå…¨å±€å˜é‡ï¼Œè¿™æ ·èƒ½è®©ä»£ç æ›´æ¸…æ™°ã€‚ä½†å¦‚æœæŸä¸ªæˆå‘˜å‡½æ•°è¿”å›æŒ‡å‘æ•°æ®æˆå‘˜çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œåˆ™é€šè¿‡è¿™ä¸ªæŒ‡é’ˆçš„è®¿é—®è¡Œä¸ºä¸ä¼šè¢« mutex é™åˆ¶ï¼Œå› æ­¤éœ€è¦è°¨æ…è®¾ç½®æ¥å£ï¼Œç¡®ä¿ mutex èƒ½é”ä½æ•°æ® #include \u003cmutex\u003e class A { public: void f() {} }; class B { public: A* get_data() { std::lock_guard\u003cstd::mutex\u003e l(m_); return \u0026data_; } private: std::mutex m_; A data_; }; int main() { B b; A* p = b.get_data(); p-\u003ef(); // æœªé”å®š mutex çš„æƒ…å†µä¸‹è®¿é—®æ•°æ® } å³ä¾¿åœ¨å¾ˆç®€å•çš„æ¥å£ä¸­ï¼Œä¹Ÿå¯èƒ½é‡åˆ° race condition std::stack\u003cint\u003e sï¼› if (!s.empty()) { int n = s.top(); // æ­¤æ—¶å…¶ä»–çº¿ç¨‹ pop å°±ä¼šè·å–é”™è¯¯çš„ top s.pop(); } ä¸Šè¿°ä»£ç å…ˆæ£€æŸ¥éç©ºå†è·å–æ ˆé¡¶å…ƒç´ ï¼Œåœ¨å•çº¿ç¨‹ä¸­æ˜¯å®‰å…¨çš„ï¼Œä½†åœ¨å¤šçº¿ç¨‹ä¸­ï¼Œæ£€æŸ¥éç©ºä¹‹åï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹å…ˆ popï¼Œå°±ä¼šå¯¼è‡´å½“å‰çº¿ç¨‹ top å‡ºé”™ã€‚å¦ä¸€ä¸ªæ½œåœ¨çš„ç«äº‰æ˜¯ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹éƒ½æœª popï¼Œè€Œæ˜¯åˆ†åˆ«è·å–äº† topï¼Œè™½ç„¶ä¸ä¼šäº§ç”Ÿæœªå®šä¹‰è¡Œä¸ºï¼Œä½†è¿™ç§å¯¹åŒä¸€å€¼å¤„ç†äº†ä¸¤æ¬¡çš„è¡Œä¸ºæ›´ä¸ºä¸¥é‡ï¼Œå› ä¸ºçœ‹èµ·æ¥æ²¡æœ‰ä»»ä½•é”™è¯¯ï¼Œå¾ˆéš¾å®šä½ bug æ—¢ç„¶å¦‚æ­¤ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥è®© pop è¿”å›æ ˆé¡¶å…ƒç´ ï¼ŸåŸå› åœ¨äºï¼Œæ„é€ è¿”å›å€¼çš„è¿‡ç¨‹å¯èƒ½æŠ›å¼‚å¸¸ï¼Œå¼¹å‡ºåæœªè¿”å›ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªå…ƒç´ ä¸º vector çš„ stackï¼Œæ‹·è´ vector éœ€è¦åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œå¦‚æœç³»ç»Ÿè´Ÿè½½ä¸¥é‡æˆ–èµ„æºæœ‰é™ï¼ˆæ¯”å¦‚ vector æœ‰å¤§é‡å…ƒç´ ï¼‰ï¼Œvector çš„æ‹·è´æ„é€ å‡½æ•°å°±ä¼šæŠ›å‡º std::bad_alloc å¼‚å¸¸ã€‚å¦‚æœ pop å¯ä»¥è¿”å›æ ˆé¡¶å…ƒç´ å€¼ï¼Œè¿”å›ä¸€å®šæ˜¯æœ€åæ‰§è¡Œçš„è¯­å¥ï¼Œstack åœ¨è¿”å›å‰å·²ç»å¼¹å‡ºäº†å…ƒç´ ï¼Œä½†å¦‚æœæ‹·è´è¿”å›å€¼æ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œå°±ä¼šå¯¼è‡´å¼¹å‡ºçš„æ•°æ®ä¸¢å¤±ï¼ˆä»æ ˆä¸Šç§»é™¤ä½†æ‹·è´å¤±è´¥ï¼‰ã€‚å› æ­¤ std::stack çš„è®¾è®¡è€…å°†è¿™ä¸ªæ“ä½œåˆ†è§£ä¸º top å’Œ pop ä¸¤éƒ¨åˆ† ä¸‹é¢æ€è€ƒå‡ ç§æŠŠ top å’Œ pop åˆä¸ºä¸€æ­¥çš„æ–¹æ³•ã€‚ç¬¬ä¸€ç§å®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•æ˜¯ä¼ å…¥ä¸€ä¸ªå¼•ç”¨æ¥è·å–ç»“æœå€¼ï¼Œè¿™ç§æ–¹å¼çš„æ˜æ˜¾ç¼ºç‚¹æ˜¯ï¼Œéœ€è¦æ„é€ ä¸€ä¸ªæ ˆå…ƒç´ ç±»å‹çš„å®ä¾‹ï¼Œè¿™æ˜¯ä¸ç°å®çš„ï¼Œä¸ºäº†è·å–ç»“æœè€Œä¸´æ—¶æ„é€ ä¸€ä¸ªå¯¹è±¡å¹¶ä¸åˆ’ç®—ï¼Œå…ƒç´ ç±»å‹å¯èƒ½ä¸æ”¯æŒèµ‹å€¼ï¼ˆæ¯”å¦‚ç”¨æˆ·è‡ªå®šä¹‰æŸä¸ªç±»å‹ï¼‰ï¼Œæ„é€ å‡½æ•°å¯èƒ½è¿˜éœ€è¦ä¸€äº›å‚æ•° std::vector\u003cint\u003e res; s.pop(res); å› ä¸º pop è¿”å›å€¼æ—¶åªæ‹…å¿ƒè¯¥è¿‡ç¨‹æŠ›å¼‚å¸¸ï¼Œç¬¬äºŒç§æ–¹æ¡ˆæ˜¯ä¸ºå…ƒç´ ç±»å‹è®¾ç½®ä¸æŠ›å¼‚å¸¸çš„æ‹·è´æˆ–ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä½¿ç”¨ std::is_nothrow_copy_constructible å’Œ std::is_nothrow_move_constructibleã€‚ä½†è¿™ç§æ–¹å¼è¿‡äºå±€é™ï¼Œåªæ”¯æŒæ‹·è´æˆ–ç§»åŠ¨ä¸æŠ›å¼‚å¸¸çš„ç±»å‹ ç¬¬ä¸‰ç§æ–¹æ¡ˆæ˜¯è¿”å›æŒ‡å‘å¼¹å‡ºå…ƒç´ çš„æŒ‡é’ˆï¼ŒæŒ‡é’ˆå¯ä»¥è‡ªç”±æ‹·è´ä¸”ä¸ä¼šæŠ›å¼‚å¸¸ï¼Œstd::shared_ptr æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä½†è¿™ä¸ªæ–¹æ¡ˆçš„å¼€é”€å¤ªå¤§ï¼Œå°¤å…¶æ˜¯å¯¹äºå†…ç½®ç±»å‹æ¥è¯´ï¼Œæ¯”å¦‚ int ä¸º 4 å­—èŠ‚ï¼Œ shared_ptr\u003cint\u003e ä¸º 16 å­—èŠ‚ï¼Œå¼€é”€æ˜¯åŸæ¥çš„ 4 å€ ç¬¬å››ç§æ–¹æ¡ˆæ˜¯ç»“åˆæ–¹æ¡ˆä¸€äºŒæˆ–è€…ä¸€ä¸‰ï¼Œæ¯”å¦‚ç»“åˆæ–¹æ¡ˆä¸€ä¸‰å®ç°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ stack #include \u003cexception\u003e #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cstack\u003e #include \u003cutility\u003e struct EmptyStack : std::exception { const char* what() const noexcept { return \"empty stack!\"; } }; template \u003ctypename T\u003e class ConcurrentStack { public: ConcurrentStack() = default; ConcurrentStack(const ConcurrentStack\u0026 rhs) { std::lock_guard\u003cstd::mutex\u003e l(rhs.m_); s_ = rhs.s_; } ConcurrentStack\u0026 operator=(const ConcurrentStack\u0026) = delete; void push(T x) { std::lock_guard\u003cstd::mutex\u003e l(m_); s_.push(std::move(x)); } bool empty() const { std::lock_guard\u003cstd::mutex\u003e l(m_); return s_.empty(); } std::shared_ptr\u003cT\u003e pop() { std::lock_guard\u003cstd::mutex\u003e l(m_); if (s_.empty()) { throw EmptyStack(); } auto res = std::make_shared\u003cT\u003e(std::move(s_.top())); s_.pop(); return res; } void pop(T\u0026 res) { std::lock_guard\u003cstd::mutex\u003e l(m_); if (s_.empty()) { throw EmptyStack(); } res = std::move(s_.top()); s_.pop(); } private: mutable std::mutex m_; std::stack\u003cT\u003e s_; }; ä¹‹å‰é”çš„ç²’åº¦ï¼ˆé”ä¿æŠ¤çš„æ•°æ®é‡å¤§å°ï¼‰å¤ªå°ï¼Œä¿æŠ¤æ“ä½œè¦†ç›–ä¸å‘¨å…¨ï¼Œè¿™é‡Œçš„ç²’åº¦å°±è¾ƒå¤§ï¼Œè¦†ç›–äº†å¤§é‡æ“ä½œã€‚ä½†å¹¶éç²’åº¦è¶Šå¤§è¶Šå¥½ï¼Œå¦‚æœé”ç²’åº¦å¤ªå¤§ï¼Œè¿‡å¤šçº¿ç¨‹è¯·æ±‚ç«äº‰å ç”¨èµ„æºæ—¶ï¼Œå¹¶å‘çš„æ€§èƒ½å°±ä¼šè¾ƒå·® å¦‚æœç»™å®šæ“ä½œéœ€è¦å¯¹å¤šä¸ª mutex ä¸Šé”æ—¶ï¼Œå°±ä¼šå¼•å…¥ä¸€ä¸ªæ–°çš„æ½œåœ¨é—®é¢˜ï¼Œå³æ­»é” ","date":"2023-11-04","objectID":"/posts/ch03_sharing_data_between_threads/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [3] | CH03 Sharing Data Between Threads","uri":"/posts/ch03_sharing_data_between_threads/"},{"categories":["C++"],"content":"æ­»é” æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ï¼šäº’æ–¥ã€å æœ‰ä¸”ç­‰å¾…ã€ä¸å¯æŠ¢å ã€å¾ªç¯ç­‰å¾… é¿å…æ­»é”é€šå¸¸å»ºè®®è®©ä¸¤ä¸ª mutex ä»¥ç›¸åŒé¡ºåºä¸Šé”ï¼Œæ€»æ˜¯å…ˆé” A å†é” Bï¼Œä½†è¿™å¹¶ä¸é€‚ç”¨æ‰€æœ‰æƒ…å†µã€‚std::lock å¯ä»¥åŒæ—¶å¯¹å¤šä¸ª mutex ä¸Šé”ï¼Œå¹¶ä¸”æ²¡æœ‰æ­»é”é£é™©ï¼Œå®ƒå¯èƒ½æŠ›å¼‚å¸¸ï¼Œæ­¤æ—¶å°±ä¸ä¼šä¸Šé”ï¼Œå› æ­¤è¦ä¹ˆéƒ½é”ä½ï¼Œè¦ä¹ˆéƒ½ä¸é” #include \u003cmutex\u003e #include \u003cthread\u003e struct A { explicit A(int n) : n_(n) {} std::mutex m_; int n_; }; void f(A \u0026a, A \u0026b, int n) { if (\u0026a == \u0026b) { return; // é˜²æ­¢å¯¹åŒä¸€å¯¹è±¡é‡å¤åŠ é” } std::lock(a.m_, b.m_); // åŒæ—¶ä¸Šé”é˜²æ­¢æ­»é” // ä¸‹é¢æŒ‰å›ºå®šé¡ºåºåŠ é”ï¼Œçœ‹ä¼¼ä¸ä¼šæœ‰æ­»é”çš„é—®é¢˜ // ä½†å¦‚æœæ²¡æœ‰ std::lock åŒæ—¶ä¸Šé”ï¼Œå¦ä¸€çº¿ç¨‹ä¸­æ‰§è¡Œ f(b, a, n) // ä¸¤ä¸ªé”çš„é¡ºåºå°±åäº†è¿‡æ¥ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ­»é” std::lock_guard\u003cstd::mutex\u003e lock1(a.m_, std::adopt_lock); std::lock_guard\u003cstd::mutex\u003e lock2(b.m_, std::adopt_lock); // ç­‰ä»·å®ç°ï¼Œå…ˆä¸ä¸Šé”ï¼ŒååŒæ—¶ä¸Šé” // std::unique_lock\u003cstd::mutex\u003e lock1(a.m_, std::defer_lock); // std::unique_lock\u003cstd::mutex\u003e lock2(b.m_, std::defer_lock); // std::lock(lock1, lock2); a.n_ -= n; b.n_ += n; } int main() { A x{70}; A y{30}; std::thread t1(f, std::ref(x), std::ref(y), 20); std::thread t2(f, std::ref(y), std::ref(x), 10); t1.join(); t2.join(); } std::unique_lock åœ¨æ„é€ æ—¶æ¥å—ä¸€ä¸ª mutexï¼Œå¹¶ä¼šè°ƒç”¨ mutex.lock()ï¼Œææ„æ—¶ä¼šè°ƒç”¨ mutex.unlock() #include \u003ciostream\u003e #include \u003cmutex\u003e class A { public: void lock() { std::cout \u003c\u003c \"lock\" \u003c\u003c std::endl; } void unlock() { std::cout \u003c\u003c \"unlock\" \u003c\u003c std::endl; } }; int main() { A a; { std::unique_lock l(a); // lock } // unlock } std::lock_guard æœªæä¾›ä»»ä½•æ¥å£ä¸”ä¸æ”¯æŒæ‹·è´å’Œç§»åŠ¨ï¼Œè€Œ std::unique_lock å¤šæä¾›äº†ä¸€äº›æ¥å£ï¼Œä½¿ç”¨æ›´çµæ´»ï¼Œå ç”¨çš„ç©ºé—´ä¹Ÿå¤šä¸€ç‚¹ã€‚ä¸€ç§è¦æ±‚çµæ´»æ€§çš„æƒ…å†µæ˜¯è½¬ç§»é”çš„æ‰€æœ‰æƒåˆ°å¦ä¸€ä¸ªä½œç”¨åŸŸ std::unique_lock\u003cstd::mutex\u003e get_lock() { extern std::mutex m; std::unique_lock\u003cstd::mutex\u003e l(m); prepare_data(); return l; // ä¸éœ€è¦ std::moveï¼Œç¼–è¯‘å™¨è´Ÿè´£è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° } void f() { std::unique_lock\u003cstd::mutex\u003e l(get_lock()); do_something(); } å¯¹ä¸€äº›è´¹æ—¶çš„æ“ä½œä¸Šé”å¯èƒ½é€ æˆå¾ˆå¤šæ“ä½œè¢«é˜»å¡ï¼Œå¯ä»¥åœ¨é¢å¯¹è¿™äº›æ“ä½œæ—¶å…ˆè§£é” void process_file_data() { std::unique_lock\u003cstd::mutex\u003e l(m); auto data = get_data(); l.unlock(); // è´¹æ—¶æ“ä½œæ²¡æœ‰å¿…è¦æŒæœ‰é”ï¼Œå…ˆè§£é” auto res = process(data); l.lock(); // å†™å…¥æ•°æ®å‰ä¸Šé” write_result(data, res); } C++17 æœ€ä¼˜çš„åŒæ—¶ä¸Šé”æ–¹æ³•æ˜¯ä½¿ç”¨ std::scoped_lock è§£å†³æ­»é”å¹¶ä¸ç®€å•ï¼Œstd::lock å’Œ std::scoped_lock æ— æ³•è·å–å…¶ä¸­çš„é”ï¼Œæ­¤æ—¶è§£å†³æ­»é”æ›´ä¾èµ–äºå¼€å‘è€…çš„èƒ½åŠ›ã€‚é¿å…æ­»é”æœ‰å››ä¸ªå»ºè®® ç¬¬ä¸€ä¸ªé¿å…æ­»é”çš„å»ºè®®æ˜¯ï¼Œä¸€ä¸ªçº¿ç¨‹å·²ç»è·å–ä¸€ä¸ªé”æ—¶å°±ä¸è¦è·å–ç¬¬äºŒä¸ªã€‚å¦‚æœæ¯ä¸ªçº¿ç¨‹åªæœ‰ä¸€ä¸ªé”ï¼Œé”ä¸Šå°±ä¸ä¼šäº§ç”Ÿæ­»é”ï¼ˆä½†é™¤äº†äº’æ–¥é”ï¼Œå…¶ä»–æ–¹é¢ä¹Ÿå¯èƒ½é€ æˆæ­»é”ï¼Œæ¯”å¦‚å³ä½¿æ— é”ï¼Œçº¿ç¨‹é—´ç›¸äº’ç­‰å¾…ä¹Ÿå¯èƒ½é€ æˆæ­»é”ï¼‰ ç¬¬äºŒä¸ªå»ºè®®æ˜¯ï¼ŒæŒæœ‰é”æ—¶é¿å…è°ƒç”¨ç”¨æˆ·æä¾›çš„ä»£ç ã€‚ç”¨æˆ·æä¾›çš„ä»£ç å¯èƒ½åšä»»ä½•æ—¶ï¼ŒåŒ…æ‹¬è·å–é”ï¼Œå¦‚æœæŒæœ‰é”æ—¶è°ƒç”¨ç”¨æˆ·ä»£ç è·å–é”ï¼Œå°±ä¼šè¿åç¬¬ä¸€ä¸ªå»ºè®®ï¼Œå¹¶é€ æˆæ­»é”ã€‚ä½†æœ‰æ—¶è°ƒç”¨ç”¨æˆ·ä»£ç æ˜¯æ— æ³•é¿å…çš„ ç¬¬ä¸‰ä¸ªå»ºè®®æ˜¯ï¼ŒæŒ‰å›ºå®šé¡ºåºè·å–é”ã€‚å¦‚æœå¿…é¡»è·å–å¤šä¸ªé”ä¸”ä¸èƒ½ç”¨ std::lock åŒæ—¶è·å–ï¼Œæœ€å¥½åœ¨æ¯ä¸ªçº¿ç¨‹ä¸Šç”¨å›ºå®šé¡ºåºè·å–ã€‚ä¸Šé¢çš„ä¾‹å­è™½ç„¶æ˜¯æŒ‰å›ºå®šé¡ºåºè·å–é”ï¼Œä½†å¦‚æœä¸åŒæ—¶åŠ é”å°±ä¼šå‡ºç°æ­»é”ï¼Œå¯¹äºè¿™ç§æƒ…å†µçš„å»ºè®®æ˜¯è§„å®šå›ºå®šçš„è°ƒç”¨é¡ºåº ç¬¬å››ä¸ªå»ºè®®æ˜¯ä½¿ç”¨å±‚çº§é”ï¼Œå¦‚æœä¸€ä¸ªé”è¢«ä½å±‚æŒæœ‰ï¼Œå°±ä¸å…è®¸åœ¨é«˜å±‚å†ä¸Šé” å±‚çº§é”å®ç°å¦‚ä¸‹ #include \u003ciostream\u003e #include \u003cmutex\u003e #include \u003cstdexcept\u003e class HierarchicalMutex { public: explicit HierarchicalMutex(int hierarchy_value) : cur_hierarchy_(hierarchy_value), prev_hierarchy_(0) {} void lock() { validate_hierarchy(); // å±‚çº§é”™è¯¯åˆ™æŠ›å¼‚å¸¸ m_.lock(); update_hierarchy(); } bool try_lock() { validate_hierarchy(); if (!m_.try_lock()) { return false; } update_hierarchy(); return true; } void unlock() { if (thread_hierarchy_ != cur_hierarchy_) { throw std::logic_error(\"mutex hierarchy violated\"); } thread_hierarchy_ = prev_hierarchy_; // æ¢å¤å‰ä¸€çº¿ç¨‹çš„å±‚çº§å€¼ m_.unlock(); } private: void validate_hierarchy() { if (thread_hierarchy_ \u003c= cur_hierarchy_) { throw std::logic_error(\"mutex hierarchy violated\"); } } void update_hierarchy() { // å…ˆå­˜å‚¨å½“å‰çº¿ç¨‹çš„å±‚çº§å€¼ï¼ˆç”¨äºè§£é”æ—¶æ¢å¤ï¼‰ prev_hierarchy_ = thread_hierarchy_; // å†æŠŠå…¶è®¾ä¸ºé”çš„å±‚çº§å€¼ thread_hierarchy_ = cur_hierarchy_; } private: std::mutex m_; const int cur_hierarchy_; int prev_hierarchy_; static thread_local int thread_hierarchy_; // æ‰€åœ¨çº¿ç¨‹çš„å±‚çº§å€¼ }; // static thread_local è¡¨ç¤ºå­˜æ´»äºä¸€ä¸ªçº¿ç¨‹å‘¨æœŸ thread_local int HierarchicalMutex::thread_hierarchy_(INT_MAX); HierarchicalMutex high(10000); HierarchicalMutex mid(6000); HierarchicalMutex low(5000); void lf() { // æœ€ä½å±‚å‡½æ•° std::lock_guard\u003cHierarchicalMutex\u003e l(low); // è°ƒç”¨ low.lock()ï¼Œthread_hierarchy_ ä¸º INT_MAXï¼Œ // cur_hierarchy_ ä¸º 5000ï¼Œthread_hierarchy_ \u003e cur_hierarchy_ï¼Œ // é€šè¿‡æ£€æŸ¥ï¼Œä¸Šé”ï¼Œprev_hierarchy_ æ›´æ–°ä¸º INT_MAXï¼Œ // thread_hierarchy_ æ›´æ–°ä¸º 5000 } // è°ƒç”¨ low.unlock()ï¼Œthread_hierarchy_ == cur_hierarchy_ï¼Œ // é€šè¿‡æ£€æŸ¥ï¼Œthread_hierarchy_ æ¢å¤ä¸º prev_hierarchy_ ä¿å­˜çš„ INT_MAXï¼Œè§£é” void hf() { std::lock_guard\u003cHierarchicalMutex\u003e l(high); // high.cur_hierarchy_ ä¸º 10000 // thread_hierarchy_ ä¸º 10000ï¼Œå¯ä»¥è°ƒç”¨ä½å±‚å‡½æ•° lf(); // thread_hierarchy_ ä» 10000 æ›´æ–°ä¸º 5000 // thread_hierarchy_ æ¢å¤ä¸º 10000 } // thread_hierarchy_ æ¢å¤ä¸º INT_MAX void mf() { std::lock_gua","date":"2023-11-04","objectID":"/posts/ch03_sharing_data_between_threads/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [3] | CH03 Sharing Data Between Threads","uri":"/posts/ch03_sharing_data_between_threads/"},{"categories":["C++"],"content":"è¯»å†™é”ï¼ˆreader-writer mutexï¼‰ æœ‰æ—¶ä¼šå¸Œæœ›å¯¹ä¸€ä¸ªæ•°æ®ä¸Šé”æ—¶ï¼Œæ ¹æ®æƒ…å†µï¼Œå¯¹æŸäº›æ“ä½œç›¸å½“äºä¸ä¸Šé”ï¼Œå¯ä»¥å¹¶å‘è®¿é—®ï¼Œå¯¹æŸäº›æ“ä½œä¿æŒä¸Šé”ï¼ŒåŒæ—¶æœ€å¤šåªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®ã€‚æ¯”å¦‚å¯¹äºéœ€è¦ç»å¸¸è®¿é—®ä½†å¾ˆå°‘æ›´æ–°çš„ç¼“å­˜æ•°æ®ï¼Œç”¨ std::mutex åŠ é”ä¼šå¯¼è‡´åŒæ—¶æœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¯»æ•°æ®ï¼Œè¿™å°±éœ€è¦ç”¨ä¸Šè¯»å†™é”ï¼Œè¯»å†™é”å…è®¸å¤šä¸ªçº¿ç¨‹å¹¶å‘è¯»ä½†ä»…ä¸€ä¸ªçº¿ç¨‹å†™ C++14 æä¾›äº† std::shared_timed_mutexï¼ŒC++17 æä¾›äº†æ¥å£æ›´å°‘æ€§èƒ½æ›´é«˜çš„ std::shared_mutexï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹è°ƒç”¨ shared_mutex.lock_shared()ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¯»ï¼Œå¦‚æœæ­¤æ—¶æœ‰ä¸€ä¸ªå†™çº¿ç¨‹è°ƒç”¨ shared_mutex.lock()ï¼Œåˆ™è¯»çº¿ç¨‹å‡ä¼šç­‰å¾…è¯¥å†™çº¿ç¨‹è°ƒç”¨ shared_mutex.unlock()ã€‚C++11 æ²¡æœ‰æä¾›è¯»å†™é”ï¼Œå¯ä½¿ç”¨ boost::shared_mutex C++14 æä¾›äº† std::shared_lockï¼Œå®ƒåœ¨æ„é€ æ—¶æ¥å—ä¸€ä¸ª mutexï¼Œå¹¶ä¼šè°ƒç”¨ mutex.lock_shared()ï¼Œææ„æ—¶ä¼šè°ƒç”¨ mutex.unlock_shared() #include \u003ciostream\u003e #include \u003cshared_mutex\u003e class A { public: void lock_shared() { std::cout \u003c\u003c \"lock_shared\" \u003c\u003c std::endl; } void unlock_shared() { std::cout \u003c\u003c \"unlock_shared\" \u003c\u003c std::endl; } }; int main() { A a; { std::shared_lock l(a); // lock_shared } // unlock_shared } å¯¹äº std::shared_mutexï¼Œé€šå¸¸åœ¨è¯»çº¿ç¨‹ä¸­ç”¨ std::shared_lock ç®¡ç†ï¼Œåœ¨å†™çº¿ç¨‹ä¸­ç”¨ std::unique_lock ç®¡ç† class A { public: int read() const { std::shared_lock\u003cstd::shared_mutex\u003e l(m_); return n_; } int write() { std::unique_lock\u003cstd::shared_mutex\u003e l(m_); return ++n_; } private: mutable std::shared_mutex m_; int n_ = 0; }; ","date":"2023-11-04","objectID":"/posts/ch03_sharing_data_between_threads/:3:1","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [3] | CH03 Sharing Data Between Threads","uri":"/posts/ch03_sharing_data_between_threads/"},{"categories":["C++"],"content":"é€’å½’é” std::mutex æ˜¯ä¸å¯é‡å…¥çš„ï¼Œæœªé‡Šæ”¾å‰å†æ¬¡ä¸Šé”æ˜¯æœªå®šä¹‰è¡Œä¸º #include \u003cmutex\u003e class A { public: void f() { m_.lock(); m_.unlock(); } void g() { m_.lock(); f(); m_.unlock(); } private: std::mutex m_; }; int main() { A{}.g(); // Undefined Behavior } ä¸ºæ­¤ C++ æä¾›äº† std::recursive_mutexï¼Œå®ƒå¯ä»¥åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šå¤šæ¬¡è·å–é”ï¼Œä½†åœ¨å…¶ä»–çº¿ç¨‹è·å–é”ä¹‹å‰å¿…é¡»é‡Šæ”¾æ‰€æœ‰çš„é” #include \u003cmutex\u003e class A { public: void f() { m_.lock(); m_.unlock(); } void g() { m_.lock(); f(); m_.unlock(); } private: std::recursive_mutex m_; }; int main() { A{}.g(); // OK } å¤šæ•°æƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦é€’å½’é”ï¼Œè¯´æ˜ä»£ç è®¾è®¡å­˜åœ¨é—®é¢˜ã€‚æ¯”å¦‚ä¸€ä¸ªç±»çš„æ¯ä¸ªæˆå‘˜å‡½æ•°éƒ½ä¼šä¸Šé”ï¼Œä¸€ä¸ªæˆå‘˜å‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œå°±å¯èƒ½å¤šæ¬¡ä¸Šé”ï¼Œè¿™ç§æƒ…å†µç”¨é€’å½’é”å°±å¯ä»¥é¿å…äº§ç”Ÿæœªå®šä¹‰è¡Œä¸ºã€‚ä½†æ˜¾ç„¶è¿™ä¸ªè®¾è®¡æœ¬èº«æ˜¯æœ‰é—®é¢˜çš„ï¼Œæ›´å¥½çš„åŠæ³•æ˜¯æå–å…¶ä¸­ä¸€ä¸ªå‡½æ•°ä½œä¸º private æˆå‘˜å¹¶ä¸”ä¸ä¸Šé”ï¼Œå…¶ä»–æˆå‘˜å…ˆä¸Šé”å†è°ƒç”¨è¯¥å‡½æ•° ","date":"2023-11-04","objectID":"/posts/ch03_sharing_data_between_threads/:3:2","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [3] | CH03 Sharing Data Between Threads","uri":"/posts/ch03_sharing_data_between_threads/"},{"categories":["C++"],"content":"å¯¹å¹¶å‘åˆå§‹åŒ–çš„ä¿æŠ¤ é™¤äº†å¯¹å¹¶å‘è®¿é—®å…±äº«æ•°æ®çš„ä¿æŠ¤ï¼Œå¦ä¸€ç§å¸¸è§çš„æƒ…å†µæ˜¯å¯¹å¹¶å‘åˆå§‹åŒ–çš„ä¿æŠ¤ #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cthread\u003e class A { public: void f() {} }; std::shared_ptr\u003cA\u003e p; std::mutex m; void init() { m.lock(); if (!p) { p.reset(new A); } m.unlock(); p-\u003ef(); } int main() { std::thread t1{init}; std::thread t2{init}; t1.join(); t2.join(); } ä¸Šé”åªæ˜¯ä¸ºäº†ä¿æŠ¤åˆå§‹åŒ–è¿‡ç¨‹ï¼Œä¼šä¸å¿…è¦åœ°å½±å“æ€§èƒ½ï¼Œä¸€ç§å®¹æ˜“æƒ³åˆ°çš„ä¼˜åŒ–æ–¹å¼æ˜¯åŒé‡æ£€æŸ¥é”æ¨¡å¼ï¼Œä½†è¿™å­˜åœ¨æ½œåœ¨çš„ race condition #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cthread\u003e class A { public: void f() {} }; std::shared_ptr\u003cA\u003e p; std::mutex m; void init() { if (!p) { // æœªä¸Šé”ï¼Œå…¶ä»–çº¿ç¨‹å¯èƒ½åœ¨æ‰§è¡Œ #1ï¼Œåˆ™æ­¤æ—¶ p ä¸ä¸ºç©º std::lock_guard\u003cstd::mutex\u003e l(m); if (!p) { p.reset(new A); // 1 // å…ˆåˆ†é…å†…å­˜ï¼Œå†åœ¨å†…å­˜ä¸Šæ„é€  A çš„å®ä¾‹å¹¶è¿”å›å†…å­˜çš„æŒ‡é’ˆï¼Œæœ€åè®© p æŒ‡å‘å®ƒ // ä¹Ÿå¯èƒ½å…ˆè®© p æŒ‡å‘å®ƒï¼Œå†åœ¨å†…å­˜ä¸Šæ„é€  A çš„å®ä¾‹ } } p-\u003ef(); // p å¯èƒ½æŒ‡å‘ä¸€å—è¿˜æœªæ„é€ å®ä¾‹çš„å†…å­˜ï¼Œä»è€Œå´©æºƒ } int main() { std::thread t1{init}; std::thread t2{init}; t1.join(); t2.join(); } ä¸ºæ­¤ï¼ŒC++11 æä¾›äº† std::once_flag å’Œ std::call_once æ¥ä¿è¯å¯¹æŸä¸ªæ“ä½œåªæ‰§è¡Œä¸€æ¬¡ #include \u003cmemory\u003e #include \u003cmutex\u003e #include \u003cthread\u003e class A { public: void f() {} }; std::shared_ptr\u003cA\u003e p; std::once_flag flag; void init() { std::call_once(flag, [\u0026] { p.reset(new A); }); p-\u003ef(); } int main() { std::thread t1{init}; std::thread t2{init}; t1.join(); t2.join(); } std::call_once ä¹Ÿå¯ä»¥ç”¨åœ¨ç±»ä¸­ #include \u003ciostream\u003e #include \u003cmutex\u003e #include \u003cthread\u003e class A { public: void f() { std::call_once(flag_, \u0026A::print, this); std::cout \u003c\u003c 2; } private: void print() { std::cout \u003c\u003c 1; } private: std::once_flag flag_; }; int main() { A a; std::thread t1{\u0026A::f, \u0026a}; std::thread t2{\u0026A::f, \u0026a}; t1.join(); t2.join(); } // 122 static å±€éƒ¨å˜é‡åœ¨å£°æ˜åå°±å®Œæˆäº†åˆå§‹åŒ–ï¼Œè¿™å­˜åœ¨æ½œåœ¨çš„ race conditionï¼Œå¦‚æœå¤šçº¿ç¨‹çš„æ§åˆ¶æµåŒæ—¶åˆ°è¾¾ static å±€éƒ¨å˜é‡çš„å£°æ˜å¤„ï¼Œå³ä½¿å˜é‡å·²åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­åˆå§‹åŒ–ï¼Œå…¶ä»–çº¿ç¨‹å¹¶ä¸çŸ¥æ™“ï¼Œä»ä¼šå¯¹å…¶å°è¯•åˆå§‹åŒ–ã€‚ä¸ºæ­¤ï¼ŒC++11 è§„å®šï¼Œå¦‚æœ static å±€éƒ¨å˜é‡æ­£åœ¨åˆå§‹åŒ–ï¼Œçº¿ç¨‹åˆ°è¾¾æ­¤å¤„æ—¶ï¼Œå°†ç­‰å¾…å…¶å®Œæˆï¼Œä»è€Œé¿å…äº† race conditionã€‚åªæœ‰ä¸€ä¸ªå…¨å±€å®ä¾‹æ—¶ï¼Œå¯ä»¥ç›´æ¥ç”¨ static è€Œä¸éœ€è¦ std::call_once template \u003ctypename T\u003e class Singleton { public: static T\u0026 Instance(); Singleton(const Singleton\u0026) = delete; Singleton\u0026 operator=(const Singleton\u0026) = delete; private: Singleton() = default; ~Singleton() = default; }; template \u003ctypename T\u003e T\u0026 Singleton\u003cT\u003e::Instance() { static T instance; return instance; } ","date":"2023-11-04","objectID":"/posts/ch03_sharing_data_between_threads/:4:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [3] | CH03 Sharing Data Between Threads","uri":"/posts/ch03_sharing_data_between_threads/"},{"categories":["C++"],"content":"std::thread æ¯ä¸ªç¨‹åºæœ‰ä¸€ä¸ªæ‰§è¡Œ main() å‡½æ•°çš„ä¸»çº¿ç¨‹ï¼Œå°†å‡½æ•°æ·»åŠ ä¸º std::thread çš„å‚æ•°å³å¯å¯åŠ¨å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸¤ä¸ªçº¿ç¨‹ä¼šåŒæ—¶è¿è¡Œ #include \u003ciostream\u003e #include \u003cthread\u003e void f() { std::cout \u003c\u003c \"hello world\"; } int main() { std::thread t{f}; t.join(); // ç­‰å¾…æ–°èµ·çš„çº¿ç¨‹é€€å‡º } std::thread çš„å‚æ•°ä¹Ÿå¯ä»¥æ˜¯å‡½æ•°å¯¹è±¡æˆ–è€… lambda #include \u003ciostream\u003e #include \u003cthread\u003e struct A { void operator()() const { std::cout \u003c\u003c 1; } }; int main() { A a; std::thread t1(a); // ä¼šè°ƒç”¨ A çš„æ‹·è´æ„é€ å‡½æ•° std::thread t2(A()); // most vexing parseï¼Œå£°æ˜åä¸º t2 å‚æ•°ç±»å‹ä¸º A çš„å‡½æ•° std::thread t3{A()}; std::thread t4((A())); std::thread t5{[] { std::cout \u003c\u003c 1; }}; t1.join(); t3.join(); t4.join(); t5.join(); } åœ¨çº¿ç¨‹é”€æ¯å‰è¦å¯¹å…¶è°ƒç”¨ join ç­‰å¾…çº¿ç¨‹é€€å‡ºæˆ– detach å°†çº¿ç¨‹åˆ†ç¦»ï¼Œå¦åˆ™ std::thread çš„ææ„å‡½æ•°ä¼šè°ƒç”¨ std::terminate ç»ˆæ­¢ç¨‹åºï¼Œæ³¨æ„åˆ†ç¦»çº¿ç¨‹å¯èƒ½å‡ºç°ç©ºæ‚¬å¼•ç”¨çš„éšæ‚£ #include \u003ciostream\u003e #include \u003cthread\u003e class A { public: A(int\u0026 x) : x_(x) {} void operator()() const { for (int i = 0; i \u003c 1000000; ++i) { call(x_); // å­˜åœ¨å¯¹è±¡ææ„åå¼•ç”¨ç©ºæ‚¬çš„éšæ‚£ } } private: void call(int\u0026 x) {} private: int\u0026 x_; }; void f() { int x = 0; A a{x}; std::thread t{a}; t.detach(); // ä¸ç­‰å¾… t ç»“æŸ } // å‡½æ•°ç»“æŸå t å¯èƒ½è¿˜åœ¨è¿è¡Œï¼Œè€Œ x å·²ç»é”€æ¯ï¼Œa.x_ ä¸ºç©ºæ‚¬å¼•ç”¨ int main() { std::thread t{f}; // å¯¼è‡´ç©ºæ‚¬å¼•ç”¨ t.join(); } join ä¼šåœ¨çº¿ç¨‹ç»“æŸåæ¸…ç† std::threadï¼Œä½¿å…¶ä¸å®Œæˆçš„çº¿ç¨‹ä¸å†å…³è”ï¼Œå› æ­¤å¯¹ä¸€ä¸ªçº¿ç¨‹åªèƒ½è¿›è¡Œä¸€æ¬¡ join #include \u003cthread\u003e int main() { std::thread t([] {}); t.join(); t.join(); // é”™è¯¯ } å¦‚æœçº¿ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸ï¼Œä¹‹åçš„ join ä¼šè¢«å¿½ç•¥ï¼Œä¸ºæ­¤éœ€è¦æ•è·å¼‚å¸¸ï¼Œå¹¶åœ¨æŠ›å‡ºå¼‚å¸¸å‰ join #include \u003cthread\u003e int main() { std::thread t([] {}); try { throw 0; } catch (int x) { t.join(); // å¤„ç†å¼‚å¸¸å‰å…ˆ join() throw x; // å†å°†å¼‚å¸¸æŠ›å‡º } t.join(); // ä¹‹å‰æŠ›å¼‚å¸¸ï¼Œä¸ä¼šæ‰§è¡Œåˆ°æ­¤å¤„ } C++20 æä¾›äº† std::jthreadï¼Œå®ƒä¼šåœ¨ææ„å‡½æ•°ä¸­å¯¹çº¿ç¨‹ join #include \u003cthread\u003e int main() { std::jthread t([] {}); } detach åˆ†ç¦»çº¿ç¨‹ä¼šè®©çº¿ç¨‹åœ¨åå°è¿è¡Œï¼Œä¸€èˆ¬å°†è¿™ç§åœ¨åå°è¿è¡Œçš„çº¿ç¨‹ç§°ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå®ˆæŠ¤çº¿ç¨‹ä¸ä¸»çº¿ç¨‹æ— æ³•ç›´æ¥äº¤äº’ï¼Œä¹Ÿä¸èƒ½è¢« join std::thread t([] {}); t.detach(); assert(!t.joinable()); åˆ›å»ºå®ˆæŠ¤çº¿ç¨‹ä¸€èˆ¬æ˜¯ä¸ºäº†é•¿æ—¶é—´è¿è¡Œï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªæ–‡æ¡£å¤„ç†åº”ç”¨ï¼Œä¸ºäº†åŒæ—¶ç¼–è¾‘å¤šä¸ªæ–‡æ¡£ï¼Œæ¯æ¬¡æ–°å¼€ä¸€ä¸ªæ–‡æ¡£ï¼Œå°±å¯ä»¥å¼€ä¸€ä¸ªå¯¹åº”çš„å®ˆæŠ¤çº¿ç¨‹ void edit_document(const std::string\u0026 filename) { open_document_and_display_gui(filename); while (!done_editing()) { user_command cmd = get_user_input(); if (cmd.type == open_new_document) { const std::string new_name = get_filename_from_user(); std::thread t(edit_document, new_name); t.detach(); } else { process_user_input(cmd); } } } ","date":"2023-11-01","objectID":"/posts/ch02_managing_threads/:1:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [2] | CH02 Managing Threads","uri":"/posts/ch02_managing_threads/"},{"categories":["C++"],"content":"ä¸ºå¸¦å‚æ•°çš„å‡½æ•°åˆ›å»ºçº¿ç¨‹ æœ‰å‚æ•°çš„å‡½æ•°ä¹Ÿèƒ½ä¼ ç»™ std::threadï¼Œå‚æ•°çš„é»˜è®¤å®å‚ä¼šè¢«å¿½ç•¥ #include \u003cthread\u003e void f(int i = 1) {} int main() { std::thread t{f, 42}; // std::thread t{f} åˆ™ä¼šå‡ºé”™ï¼Œå› ä¸ºé»˜è®¤å®å‚ä¼šè¢«å¿½ç•¥ t.join(); } å‚æ•°çš„å¼•ç”¨ç±»å‹ä¹Ÿä¼šè¢«å¿½ç•¥ï¼Œä¸ºæ­¤è¦ä½¿ç”¨ std::ref #include \u003ccassert\u003e #include \u003cthread\u003e void f(int\u0026 i) { ++i; } int main() { int i = 1; std::thread t{f, std::ref(i)}; t.join(); assert(i == 2); } å¦‚æœå¯¹ä¸€ä¸ªå®ä¾‹çš„ non-static æˆå‘˜å‡½æ•°åˆ›å»ºçº¿ç¨‹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ä¸ºæˆå‘˜å‡½æ•°æŒ‡é’ˆï¼Œç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸ºå®ä¾‹æŒ‡é’ˆï¼Œåç»­å‚æ•°ä¸ºå‡½æ•°å‚æ•° #include \u003ciostream\u003e #include \u003cthread\u003e class A { public: void f(int i) { std::cout \u003c\u003c i; } }; int main() { A a; std::thread t1{\u0026A::f, \u0026a, 42}; // è°ƒç”¨ a-\u003ef(42) std::thread t2{\u0026A::f, a, 42}; // æ‹·è´æ„é€  tmp_aï¼Œå†è°ƒç”¨ tmp_a.f(42) t1.join(); t2.join(); } å¦‚æœè¦ä¸ºå‚æ•°æ˜¯ move-only ç±»å‹çš„å‡½æ•°åˆ›å»ºçº¿ç¨‹ï¼Œåˆ™éœ€è¦ä½¿ç”¨ std::move ä¼ å…¥å‚æ•° #include \u003ciostream\u003e #include \u003cthread\u003e #include \u003cutility\u003e void f(std::unique_ptr\u003cint\u003e p) { std::cout \u003c\u003c *p; } int main() { std::unique_ptr\u003cint\u003e p(new int(42)); std::thread t{f, std::move(p)}; t.join(); } ","date":"2023-11-01","objectID":"/posts/ch02_managing_threads/:2:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [2] | CH02 Managing Threads","uri":"/posts/ch02_managing_threads/"},{"categories":["C++"],"content":"è½¬ç§»çº¿ç¨‹æ‰€æœ‰æƒ std::thread æ˜¯ move-only ç±»å‹ï¼Œä¸èƒ½æ‹·è´ï¼Œåªèƒ½é€šè¿‡ç§»åŠ¨è½¬ç§»æ‰€æœ‰æƒï¼Œä½†ä¸èƒ½è½¬ç§»æ‰€æœ‰æƒåˆ° joinable çš„çº¿ç¨‹ #include \u003cthread\u003e #include \u003cutility\u003e void f() {} void g() {} int main() { std::thread a{f}; std::thread b = std::move(a); assert(!a.joinable()); assert(b.joinable()); a = std::thread{g}; assert(a.joinable()); assert(b.joinable()); // a = std::move(b); // é”™è¯¯ï¼Œä¸èƒ½è½¬ç§»æ‰€æœ‰æƒåˆ° joinable çš„çº¿ç¨‹ a.join(); a = std::move(b); assert(a.joinable()); assert(!b.joinable()); a.join(); } ç§»åŠ¨æ“ä½œåŒæ ·é€‚ç”¨äºæ”¯æŒç§»åŠ¨çš„å®¹å™¨ #include \u003calgorithm\u003e #include \u003cthread\u003e #include \u003cvector\u003e int main() { std::vector\u003cstd::thread\u003e v; for (int i = 0; i \u003c 10; ++i) { v.emplace_back([] {}); } std::for_each(std::begin(v), std::end(v), std::mem_fn(\u0026std::thread::join)); } std::thread å¯ä»¥ä½œä¸ºå‡½æ•°è¿”å›å€¼ #include \u003cthread\u003e std::thread f() { return std::thread{[] {}}; } int main() { std::thread t{f()}; t.join(); } std::thread ä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°å‚æ•° #include \u003cthread\u003e #include \u003cutility\u003e void f(std::thread t) { t.join(); } int main() { f(std::thread([] {})); std::thread t([] {}); f(std::move(t)); } å®ç°ä¸€ä¸ªå¯ä»¥ç›´æ¥ç”¨ std::thread æ„é€ çš„è‡ªåŠ¨æ¸…ç†çº¿ç¨‹çš„ç±» #include \u003cstdexcept\u003e #include \u003cthread\u003e #include \u003cutility\u003e class scoped_thread { public: explicit scoped_thread(std::thread x) : t_(std::move(x)) { if (!t_.joinable()) { throw std::logic_error(\"no thread\"); } } ~scoped_thread() { t_.join(); } scoped_thread(const scoped_thread\u0026) = delete; scoped_thread\u0026 operator=(const scoped_thread\u0026) = delete; private: std::thread t_; }; int main() { scoped_thread t{std::thread{[] {}}}; } ç±»ä¼¼ std::jthread çš„ç±» #include \u003cthread\u003e class Jthread { public: Jthread() noexcept = default; template \u003ctypename T, typename... Ts\u003e explicit Jthread(T\u0026\u0026 f, Ts\u0026\u0026... args) : t_(std::forward\u003cT\u003e(f), std::forward\u003cTs\u003e(args)...) {} explicit Jthread(std::thread x) noexcept : t_(std::move(x)) {} Jthread(Jthread\u0026\u0026 rhs) noexcept : t_(std::move(rhs.t_)) {} Jthread\u0026 operator=(Jthread\u0026\u0026 rhs) noexcept { if (joinable()) { join(); } t_ = std::move(rhs.t_); return *this; } Jthread\u0026 operator=(std::thread t) noexcept { if (joinable()) { join(); } t_ = std::move(t); return *this; } ~Jthread() noexcept { if (joinable()) { join(); } } void swap(Jthread\u0026\u0026 rhs) noexcept { t_.swap(rhs.t_); } std::thread::id get_id() const noexcept { return t_.get_id(); } bool joinable() const noexcept { return t_.joinable(); } void join() { t_.join(); } void detach() { t_.detach(); } std::thread\u0026 as_thread() noexcept { return t_; } const std::thread\u0026 as_thread() const noexcept { return t_; } private: std::thread t_; }; int main() { Jthread t{[] {}}; } ","date":"2023-11-01","objectID":"/posts/ch02_managing_threads/:3:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [2] | CH02 Managing Threads","uri":"/posts/ch02_managing_threads/"},{"categories":["C++"],"content":"æŸ¥çœ‹ç¡¬ä»¶æ”¯æŒçš„çº¿ç¨‹æ•°é‡ hardware_concurrency ä¼šè¿”å›ç¡¬ä»¶æ”¯æŒçš„å¹¶å‘çº¿ç¨‹æ•° #include \u003ciostream\u003e #include \u003cthread\u003e int main() { unsigned int n = std::thread::hardware_concurrency(); std::cout \u003c\u003c n \u003c\u003c \" concurrent threads are supported.\\n\"; } å¹¶è¡Œç‰ˆæœ¬çš„ std::accumulate #include \u003calgorithm\u003e #include \u003ccassert\u003e #include \u003cfunctional\u003e #include \u003citerator\u003e #include \u003cnumeric\u003e #include \u003cthread\u003e #include \u003cvector\u003e template \u003ctypename Iterator, typename T\u003e struct accumulate_block { void operator()(Iterator first, Iterator last, T\u0026 res) { res = std::accumulate(first, last, res); } }; template \u003ctypename Iterator, typename T\u003e T parallel_accumulate(Iterator first, Iterator last, T init) { long len = std::distance(first, last); if (!len) { return init; } long min_per_thread = 25; long max_threads = (len + min_per_thread - 1) / min_per_thread; long hardware_threads = std::thread::hardware_concurrency(); long num_threads = // çº¿ç¨‹æ•°é‡ std::min(hardware_threads == 0 ? 2 : hardware_threads, max_threads); long block_size = len / num_threads; // æ¯ä¸ªçº¿ç¨‹ä¸­çš„æ•°æ®é‡ std::vector\u003cT\u003e res(num_threads); std::vector\u003cstd::thread\u003e threads(num_threads - 1); // å·²æœ‰ä¸»çº¿ç¨‹æ•…å°‘ä¸€ä¸ªçº¿ç¨‹ Iterator block_start = first; for (long i = 0; i \u003c num_threads - 1; ++i) { Iterator block_end = block_start; std::advance(block_end, block_size); // block_end æŒ‡å‘å½“å‰å—å°¾éƒ¨ threads[i] = std::thread{accumulate_block\u003cIterator, T\u003e{}, block_start, block_end, std::ref(res[i])}; block_start = block_end; } accumulate_block\u003cIterator, T\u003e()(block_start, last, res[num_threads - 1]); std::for_each(threads.begin(), threads.end(), std::mem_fn(\u0026std::thread::join)); return std::accumulate(res.begin(), res.end(), init); } int main() { std::vector\u003clong\u003e v(1000000); std::iota(std::begin(v), std::end(v), 0); long res = std::accumulate(std::begin(v), std::end(v), 0); assert(parallel_accumulate(std::begin(v), std::end(v), 0) == res); } ","date":"2023-11-01","objectID":"/posts/ch02_managing_threads/:4:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [2] | CH02 Managing Threads","uri":"/posts/ch02_managing_threads/"},{"categories":["C++"],"content":"çº¿ç¨‹å· å¯ä»¥é€šè¿‡å¯¹çº¿ç¨‹å®ä¾‹è°ƒç”¨æˆå‘˜å‡½æ•° get_id æˆ–åœ¨å½“å‰çº¿ç¨‹ä¸­è°ƒç”¨ std::this_thread::get_id è·å– çº¿ç¨‹å·ï¼Œå…¶æœ¬è´¨æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´å‹çš„å°è£…ï¼Œå…è®¸æ‹·è´å’Œæ¯”è¾ƒï¼Œå› æ­¤å¯ä»¥å°†å…¶ä½œä¸ºå®¹å™¨çš„é”®å€¼ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹çš„çº¿ç¨‹å·ç›¸ç­‰ï¼Œåˆ™ä¸¤è€…æ˜¯åŒä¸€çº¿ç¨‹æˆ–éƒ½æ˜¯ç©ºçº¿ç¨‹ï¼ˆä¸€èˆ¬ç©ºçº¿ç¨‹çš„çº¿ç¨‹å·ä¸º 0ï¼‰ #include \u003ciostream\u003e #include \u003cthread\u003e #ifdef _WIN32 #include \u003cWindows.h\u003e #elif defined __GNUC__ #include \u003csyscall.h\u003e #include \u003cunistd.h\u003e #endif void print_current_thread_id() { #ifdef _WIN32 std::cout \u003c\u003c std::this_thread::get_id() \u003c\u003c std::endl; // 19840 std::cout \u003c\u003c GetCurrentThreadId() \u003c\u003c std::endl; // 19840 std::cout \u003c\u003c GetThreadId(GetCurrentThread()) \u003c\u003c std::endl; // 19840 #elif defined __GNUC__ std::cout \u003c\u003c std::this_thread::get_id() \u003c\u003c std::endl; // 1 std::cout \u003c\u003c pthread_self() \u003c\u003c std::endl; // 140250646003520 std::cout \u003c\u003c getpid() \u003c\u003c std::endl; // 1502109ï¼Œps aux æ˜¾ç¤ºæ­¤ pid std::cout \u003c\u003c syscall(SYS_gettid) \u003c\u003c std::endl; // 1502109 #endif } std::thread::id master_thread_id = std::this_thread::get_id(); void f() { if (std::this_thread::get_id() == master_thread_id) { // do_master_thread_work(); } // do_common_work(); } int main() { print_current_thread_id(); f(); std::thread t{f}; t.join(); } ","date":"2023-11-01","objectID":"/posts/ch02_managing_threads/:5:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [2] | CH02 Managing Threads","uri":"/posts/ch02_managing_threads/"},{"categories":["C++"],"content":"CPU äº²å’Œæ€§ï¼ˆaffinityï¼‰ å°†çº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ªæŒ‡å®šçš„ CPU core ä¸Šè¿è¡Œï¼Œé¿å…å¤šæ ¸ CPU ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œ cache miss çš„å¼€é”€ #ifdef _WIN32 #include \u003cWindows.h\u003e #elif defined __GNUC__ #include \u003cpthread.h\u003e #include \u003csched.h\u003e #include \u003cstring.h\u003e #endif #include \u003ciostream\u003e #include \u003cthread\u003e void affinity_cpu(std::thread::native_handle_type t, int cpu_id) { #ifdef _WIN32 if (!SetThreadAffinityMask(t, 1ll \u003c\u003c cpu_id)) { std::cerr \u003c\u003c \"fail to affinity\" \u003c\u003c GetLastError() \u003c\u003c std::endl; } #elif defined __GNUC__ cpu_set_t cpu_set; CPU_ZERO(\u0026cpu_set); CPU_SET(cpu_id, \u0026cpu_set); int res = pthread_setaffinity_np(t, sizeof(cpu_set), \u0026cpu_set); if (res != 0) { errno = res; std::cerr \u003c\u003c \"fail to affinity\" \u003c\u003c strerror(errno) \u003c\u003c std::endl; } #endif } void affinity_cpu_on_current_thread(int cpu_id) { #ifdef _WIN32 if (!SetThreadAffinityMask(GetCurrentThread(), 1ll \u003c\u003c cpu_id)) { std::cerr \u003c\u003c \"fail to affinity\" \u003c\u003c GetLastError() \u003c\u003c std::endl; } #elif defined __GNUC__ cpu_set_t cpu_set; CPU_ZERO(\u0026cpu_set); CPU_SET(cpu_id, \u0026cpu_set); int res = pthread_setaffinity_np(pthread_self(), sizeof(cpu_set), \u0026cpu_set); if (res != 0) { errno = res; std::cerr \u003c\u003c \"fail to affinity\" \u003c\u003c strerror(errno) \u003c\u003c std::endl; } #endif } void f() { affinity_cpu_on_current_thread(0); } int main() { std::thread t1{[] {}}; affinity_cpu(t1.native_handle(), 1); std::thread t2{f}; t1.join(); t2.join(); } ","date":"2023-11-01","objectID":"/posts/ch02_managing_threads/:6:0","tags":["C++_Concurrency"],"title":"C++ Concurrency in Action [2] | CH02 Managing Threads","uri":"/posts/ch02_managing_threads/"},{"categories":["C++"],"content":"1. æ€»è§ˆ ä»€ä¹ˆæ˜¯CMakeï¼Ÿ CMakeæ˜¯ä¸ªä¸€ä¸ªå¼€æºçš„è·¨å¹³å°è‡ªåŠ¨åŒ–å»ºæ„ç³»ç»Ÿï¼Œç”¨æ¥ç®¡ç†è½¯ä»¶å»ºç½®çš„ç¨‹åºï¼Œå¹¶ä¸ç›¸ä¾äºæŸç‰¹å®šç¼–è¯‘å™¨ã€‚å¹¶å¯æ”¯æŒå¤šå±‚ç›®å½•ã€å¤šä¸ªåº”ç”¨ç¨‹åºä¸å¤šä¸ªåº“ã€‚ å®ƒç”¨é…ç½®æ–‡ä»¶æ§åˆ¶å»ºæ„è¿‡ç¨‹ï¼ˆbuild processï¼‰çš„æ–¹å¼å’ŒUnixçš„makeç›¸ä¼¼ï¼Œåªæ˜¯CMakeçš„é…ç½®æ–‡ä»¶å–åä¸ºCMakeLists.txtã€‚ CMakeå¹¶ä¸ç›´æ¥å»ºæ„å‡ºæœ€ç»ˆçš„è½¯ä»¶ï¼Œè€Œæ˜¯äº§ç”Ÿæ ‡å‡†çš„å»ºæ„æ¡£ï¼ˆå¦‚Unixçš„Makefileæˆ–Windows Visual C++çš„projects/workspacesï¼‰ï¼Œç„¶åå†ä¾ä¸€èˆ¬çš„å»ºæ„æ–¹å¼ä½¿ç”¨ã€‚ è¿™ä½¿å¾—ç†Ÿæ‚‰æŸä¸ªé›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰çš„å¼€å‘è€…å¯ä»¥ç”¨æ ‡å‡†çš„æ–¹å¼å»ºæ„ä»–çš„è½¯ä»¶ï¼Œè¿™ç§å¯ä»¥ä½¿ç”¨å„å¹³å°çš„åŸç”Ÿå»ºæ„ç³»ç»Ÿçš„èƒ½åŠ›æ˜¯CMakeå’ŒSConsç­‰å…¶ä»–ç±»ä¼¼ç³»ç»Ÿçš„åŒºåˆ«ä¹‹å¤„ã€‚ å®ƒé¦–å…ˆå…è®¸å¼€å‘è€…ç¼–å†™ä¸€ç§å¹³å°æ— å…³çš„CMakeList.txt æ–‡ä»¶æ¥å®šåˆ¶æ•´ä¸ªç¼–è¯‘æµç¨‹ï¼Œç„¶åå†æ ¹æ®ç›®æ ‡ç”¨æˆ·çš„å¹³å°è¿›ä¸€æ­¥ç”Ÿæˆæ‰€éœ€çš„æœ¬åœ°åŒ– Makefile å’Œå·¥ç¨‹æ–‡ä»¶ï¼Œå¦‚ Unixçš„ Makefile æˆ– Windows çš„ Visual Studio å·¥ç¨‹ã€‚ä»è€Œåšåˆ°â€œWrite once, run everywhereâ€ã€‚ æ˜¾ç„¶ï¼ŒCMake æ˜¯ä¸€ä¸ªæ¯”ä¸Šè¿°å‡ ç§ make æ›´é«˜çº§çš„ç¼–è¯‘é…ç½®å·¥å…·ã€‚â€œCMakeâ€è¿™ä¸ªåå­—æ˜¯\"Cross platform MAke\"çš„ç¼©å†™ã€‚è™½ç„¶åå­—ä¸­å«æœ‰\"make\"ï¼Œä½†æ˜¯CMakeå’ŒUnixä¸Šå¸¸è§çš„â€œmakeâ€ç³»ç»Ÿæ˜¯åˆ†å¼€çš„ï¼Œè€Œä¸”æ›´ä¸ºé«˜ç«¯ã€‚ å®ƒå¯ä¸åŸç”Ÿå»ºç½®ç¯å¢ƒç»“åˆä½¿ç”¨ï¼Œä¾‹å¦‚ï¼šmakeã€è‹¹æœçš„Xcodeä¸å¾®è½¯çš„Visual Studioã€‚ CMake is not a build system like Unix Make but a build system generator. Its purpose is to take your description of a project and generate a set of configuration files to build that project. CMake æ˜¯æ„å»ºç³»ç»Ÿçš„ç”Ÿæˆå™¨ã€‚å®ƒçš„ç›®æ ‡æ˜¯ï¼šæ ¹æ®ä½ å¯¹é¡¹ç›®çš„æè¿°ä¿¡æ¯ï¼Œå»ç”Ÿæˆä¸€ç³»åˆ—çš„é…ç½®æ–‡ä»¶ï¼Œæ¥ç¼–è¯‘æ„å»ºé¡¹ç›®ã€‚ As part of the generation of build configuration files, CMake also analyses source code to create a dependency graph of components so that when building the project unnecessary recompilation steps can be omitted to reduce build times. For larger projects this can reduce build times down from tens of minutes or hours, to a few minutes, perhaps even less than one minute. ä½œä¸ºæ„å»ºé…ç½®æ–‡ä»¶ç”Ÿæˆçš„ä¸€éƒ¨åˆ†ï¼ŒCMake è¿˜ä¼šå»åˆ†ææºç ï¼Œæ¥åˆ›å»ºå„ä¸ªéƒ¨åˆ†ä¹‹é—´çš„ä¾èµ–å›¾ï¼Œæ‰€ä»¥åœ¨æ„å»ºé¡¹ç›®æ—¶ï¼Œä¸å¿…è¦çš„é‡ç¼–æ­¥éª¤å°±ä¼šè¢«çœç•¥æ‰ã€‚è¿™æ ·èŠ‚çœäº†å¤§é‡æ„å»ºçš„æ—¶é—´ã€‚ CMake Build Process In addition to a build system, over the years CMake has evolved into a family of development tools: CMake, CTest, CPack, and CDash. CMake is the build tool responsible for building software. CTest is a test driver tool, used to run regression tests. CPack is a packaging tool used to create platform-specific installers for software built with CMake. CDash is a web application for displaying testing results and performing continuous integration testing. é™¤äº†æ„å»ºç³»ç»Ÿï¼ŒCMake è¿˜å‘å±•å‡ºä¸€ç³»åˆ—å·¥å…·ï¼šCMake æ˜¯æ„å»ºå·¥å…·ï¼ŒCTest æ˜¯ç”¨äºå›å½’æµ‹è¯•çš„æµ‹è¯•å·¥å…·ï¼ŒCPack æ˜¯ç”¨äºä¸ºç”¨ CMake æ„å»ºçš„è½¯ä»¶åˆ›å»ºæŒ‡å®šå¹³å°å®‰è£…å™¨çš„æ‰“åŒ…å·¥å…·ï¼ŒCDash æ˜¯å±•ç¤ºæµ‹è¯•ç»“æ„å’Œæ‰§è¡ŒæŒç»­é›†æˆæµ‹è¯•çš„ web ç«¯åº”ç”¨ã€‚ ","date":"2023-11-01","objectID":"/posts/cmake_introduction/:1:0","tags":["CMake"],"title":"CMake ç®€ä»‹","uri":"/posts/cmake_introduction/"},{"categories":["C++"],"content":"2. Notion The build tree is the directory hierarchy in which all generated files are placed. Generated files consist of the makefile, the compiled object files, and a dependency file (with a . d extension) for each source file. æ„å»ºæ ‘æ˜¯æ”¾ç½®æ‰€æœ‰ç”Ÿæˆæ–‡ä»¶çš„ç›®å½•å±‚çº§ç»“æ„ã€‚ç”Ÿæˆæ–‡ä»¶åŒ…æ‹¬ makefileã€ç¼–è¯‘å‡ºæ¥çš„ç›®æ ‡æ–‡ä»¶ã€æ¯ä¸ªæºæ–‡ä»¶çš„ä¾èµ–æ–‡ä»¶ã€‚ ","date":"2023-11-01","objectID":"/posts/cmake_introduction/:2:0","tags":["CMake"],"title":"CMake ç®€ä»‹","uri":"/posts/cmake_introduction/"},{"categories":["C++"],"content":"3. Requirements When CMake was being developed, the normal practice for a project was to have a configure script and Makefiles for Unix platforms, and Visual Studio project files for Windows. This duality of build systems made cross-platform development very tedious for many projects: the simple act of adding a new source file to a project was painful. The obvious goal for developers was to have a single unified build system. The developers of CMake had experience with two approaches of solving the unified build system problem. åœ¨ CMake è¢«å¼€å‘ä¹‹æ—¶ï¼Œå¸¸è§„çš„é¡¹ç›®æ“ä½œæ˜¯ï¼šä¸€ä¸ªé…ç½®è„šæœ¬ï¼Œä»¥åŠ Makefiles (Unix å¹³å°) æˆ– Visual Studio é¡¹ç›®æ–‡ä»¶(Windows å¹³å°)ã€‚è¿™æ ·çš„æ„å»ºç³»ç»Ÿå¯¼è‡´è·¨å¹³å°å¼€å‘éå¸¸åœ°éš¾å—ï¼šç®€å•åœ°æ·»åŠ ä¸€ä¸ªæ–‡ä»¶åˆ°é¡¹ç›®çš„æ“ä½œéƒ½å¾ˆç—›è‹¦ã€‚å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œä¸€ä¸ªæ˜¾ç„¶çš„ç›®æ ‡å°±æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„æ„å»ºç³»ç»Ÿã€‚ The basic constraints of the new build system would be as follows: å¯¹äºæ–°çš„æ„å»ºç³»ç»Ÿçš„é™åˆ¶å¦‚ä¸‹: Depend only on a C++ compiler being installed on the system. åªä¾èµ–ç³»ç»Ÿå®‰è£…çš„ c++ ç¼–è¯‘å™¨ It must be able to generate Visual Studio IDE input files. å¯ä»¥ç”Ÿæˆ VS IDE çš„è¾“å…¥æ–‡ä»¶ It must be easy to create the basic build system targets, including static libraries, shared libraries, executables, and plugins. å¾ˆå®¹æ˜“åˆ›å»ºç›®æ ‡æ–‡ä»¶ It must be able to run build time code generators. å¯ä»¥è¿è¡Œç¼–è¯‘æ—¶ä»£ç ç”Ÿæˆå™¨ It must support separate build trees from the source tree. å¯ä»¥æ”¯æŒç‹¬ç«‹äºæºæ ‘çš„æ„å»ºæ ‘ It must be able to perform system introspection, i.e., be able to determine automatically what the target system could and could not do. åæ˜ ç³»ç»Ÿé—®é¢˜ It must do dependency scanning of C/C++ header files automatically. è‡ªåŠ¨åœ°è¿›è¡Œ C/C++ å¤´æ–‡ä»¶çš„ä¾èµ–æ‰«æ All features would need to work consistently and equally well on all supported platforms. æ‰€æœ‰ç‰¹æ€§éœ€è¦åè°ƒå·¥ä½œï¼Œä¸”è‰¯å¥½è¿è¡Œåœ¨æ‰€æœ‰æ”¯æŒçš„å¹³å° In order to avoid depending on any additional libraries and parsers, CMake was designed with only one major dependency, the C++ compiler (which we can safely assume we have if weâ€™re building C++ code). This did limit CMake to creating its own simple language, which is a choice that still causes some people to dislike CMake. However, at the time the most popular embedded language was Tcl. If CMake had been a Tcl-based build system, it is unlikely that it would have gained the popularity that it enjoys today. ä¸ºäº†é¿å…ä¾èµ–é¢å¤–çš„åº“æˆ–è§£æå™¨ï¼ŒCMake åªå­˜åœ¨ä¸€ç§ä¸»è¦çš„ä¾èµ–ï¼šC++ ç¼–è¯‘å™¨ã€‚è¿™é™åˆ¶äº† CMake åˆ›å»ºå±äºè‡ªå·±çš„è¯­è¨€ï¼Œå¼•èµ·å¤§å®¶çš„ä¸æ»¡ã€‚ The ability to generate IDE project files is a strong selling point for CMake, but it also limits CMake to providing only the features that the IDE can support natively. However, the benefits of providing native IDE build files outweigh the limitations. Although this decision made the development of CMake more difficult, it made the development of ITK and other projects using CMake much easier. Developers are happier and more productive when using the tools they are most familiar with. By allowing developers to use their preferred tools, projects can take best advantage of their most important resource: the developer. å¯ä»¥ç”Ÿæˆ IDE é¡¹ç›®æ–‡ä»¶çš„èƒ½åŠ›æ˜¯ CMake çš„ä¸€å¤§å–ç‚¹ï¼Œä½†åŒæ ·ä¹Ÿé™åˆ¶äº† CMake åªå»æä¾› IDE æœ¬åœ°æ”¯æŒçš„ä¸€äº›ç‰¹æ€§ã€‚ä½†æ˜¯ï¼Œåˆ©å¤§äºå¼Šã€‚ Another early CMake requirement also came from autotools: the ability to create build trees that are separate from the source tree. This allows for multiple build types to be performed on the same source tree. It also prevents the source tree from being cluttered with build files, which often confuses version control systems. æ”¯æŒåˆ›å»ºç‹¬ç«‹äºæºæ ‘çš„æ„å»ºæ ‘ã€‚è¿™ä¸ªå¯ä»¥ä½¿ç›¸åŒçš„æºæ ‘æ‹¥æœ‰ä¼—å¤šçš„æ„å»ºç±»å‹ï¼ŒåŒæ—¶ä¹Ÿé˜²æ­¢æºæ ‘è¢«æ„å»ºæ–‡ä»¶æ±¡æŸ“ï¼Œå¯¼è‡´ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„æ··ä¹±ã€‚ CMake Build System ","date":"2023-11-01","objectID":"/posts/cmake_introduction/:3:0","tags":["CMake"],"title":"CMake ç®€ä»‹","uri":"/posts/cmake_introduction/"},{"categories":["C++"],"content":"4. Implementation Environment Variables (or Not) The trouble with this approach is that for the build to work, all of these external variables need to be set each time a build is performed. To solve this problem CMake has a cache file that stores all of the variables required for a build in one place. These are not shell or environment variables, but CMake variables. The first time CMake is run for a particular build tree, it creates a CMakeCache.txt file which stores all the persistent variables for that build. Since the file is part of the build tree, the variables will always be available to CMake during each run. éš¾ç‚¹åœ¨äºåœ¨æ¯æ¬¡ç¼–è¯‘æ—¶ï¼Œæ‰€æœ‰çš„å¤–éƒ¨å˜é‡éƒ½éœ€è¦è®¾ç½®ä¸€éã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒCMake ç”¨ä¸€ä¸ª cache æ–‡ä»¶ä¿å­˜æ‰€æœ‰ç¼–è¯‘æ‰€éœ€çš„å˜é‡ã€‚è¿™äº›ä¸æ˜¯ shell æˆ–ç¯å¢ƒå˜é‡ï¼Œåªæ˜¯ CMake çš„å˜é‡ã€‚ç¬¬ä¸€æ¬¡ CMake è¿è¡Œæ—¶ï¼Œå®ƒä¼šåˆ›å»º CMakeCache.txt æ–‡ä»¶æ¥ä¿å­˜è¿™äº›å˜é‡ã€‚è¿™ä¸ªæ–‡ä»¶å°±æ˜¯æ„å»ºæ ‘çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥å¯¹äº CMake çš„æ¯æ¬¡è¿è¡Œéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚ The Configure Step During the configure step, CMake first reads the CMakeCache.txt if it exists from a prior run. It then reads CMakeLists.txt, found in the root of the source tree given to CMake. During the configure step, the CMakeLists.txt files are parsed by the CMake language parser. Each of the CMake commands found in the file is executed by a command pattern object. Additional CMakeLists.txt files can be parsed during this step by the include and add_subdirectory CMake commands. CMake has a C++ object for each of the commands that can be used in the CMake language. Some examples of commands are add_library, if, add_executable, add_subdirectory, and include. In effect, the entire language of CMake is implemented as calls to commands. The parser simply converts the CMake input files into command calls and lists of strings that are arguments to commands. åœ¨é…ç½®é˜¶æ®µï¼ŒCMake é¦–å…ˆè¯»å– CMakeCache.txt æ–‡ä»¶(å¦‚æœå­˜åœ¨çš„è¯)ï¼Œç„¶åè¯»å– CMakeLists.txt æ¥æŸ¥æ‰¾æºæ ‘çš„æ ¹ã€‚åœ¨é…ç½®é˜¶æ®µï¼ŒCMakeLists.txt æ–‡ä»¶ä¼šè¢« CMake è¯­è¨€è§£æå™¨è§£æã€‚æ¯å½“æœ‰ CMake å‘½ä»¤åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­è¢«æ‰¾åˆ°å°±ä¼šè¢«å‚æ•°æ¨¡ç‰ˆå¯¹è±¡æ‰§è¡Œã€‚é¢å¤–çš„ CMakeLists.txt æ–‡ä»¶ä¼šåœ¨å¤„ç† include å’Œ add_subdirectory å‘½ä»¤ä¹‹æ—¶è§£æã€‚ The configure step essentially â€œrunsâ€ the user-provided CMake code. After all of the code is executed, and all cache variable values have been computed, CMake has an in-memory representation of the project to be built. This will include all of the libraries, executables, custom commands, and all other information required to create the final build files for the selected generator. At this point, the CMakeCache.txt file is saved to disk for use in future runs of CMake. é…ç½®é˜¶æ®µæœ¬è´¨ä¸Šä¼šè¿è¡Œç”¨æˆ·æä¾›çš„ CMake çš„ä»£ç ã€‚åœ¨æ‰€æœ‰ä»£ç æ‰§è¡Œå®Œæˆï¼Œä»¥åŠæ‰€æœ‰å˜é‡å€¼è®¡ç®—å®Œæˆä¹‹åï¼ŒCMake ä¼šæœ‰ä¸€ä¸ªé¡¹ç›®çš„å†…å­˜è¡¨ç¤ºéœ€è¦æ„å»ºï¼Œå®ƒä¼šåŒ…å«æ‰€æœ‰çš„åº“ã€å¯æ‰§è¡Œæ–‡ä»¶ã€æŒ‡å®šçš„å‘½ä»¤å’Œæ‰€æœ‰å…¶ä»–éœ€è¦å»åˆ›å»ºæœ€ç»ˆçš„æ„å»ºæ–‡ä»¶çš„ä¿¡æ¯ã€‚åœ¨æ­¤ï¼ŒCMakeCache.txt æ–‡ä»¶ä¼šè¢«ä¿å­˜åˆ°ç£ç›˜ä¸­ï¼Œä½œä¸º CMake ä¹‹åçš„ä½¿ç”¨ã€‚ The Generate Step CMake Generator Expression Once the configure step has been completed, the generate step can take place. The generate step is when CMake creates the build files for the target build tool selected by the user. At this point the internal representation of targets (libraries, executables, custom targets) is converted to either an input to an IDE build tool like Visual Studio, or a set of Makefiles to be executed by make. CMakeâ€™s internal representation after the configure step is as generic as possible so that as much code and data structures as possible can be shared between different built tools. ä¸€æ—¦é…ç½®å®Œæˆï¼Œå°±åˆ°ç”Ÿæˆé˜¶æ®µäº†ã€‚è¿™ä¸ªé˜¶æ®µ CMake ä¼šåˆ›å»ºç”¨æˆ·é€‰æ‹©çš„ç›®æ ‡æ„å»ºå·¥å…·çš„æ„å»ºæ–‡ä»¶ã€‚åœ¨æ­¤ï¼Œç›®æ ‡çš„å†…éƒ¨è¡¨ç¤ºä¼šè¢«è½¬æˆ IDE çš„æ„å»ºå·¥å…·ï¼Œæˆ–è€… make ç”¨åˆ°çš„ä¸€ç³»åˆ— Makefilesã€‚CMake çš„å†…éƒ¨è¡¨ç¤ºéœ€è¦å°½å¯èƒ½é€šç”¨ï¼Œè¿™æ ·ä»£ç å’Œæ•°æ®ç»“æ„å¯ä»¥è¢«ä¸åŒçš„æ„å»ºå·¥å…·æ‰€å…±äº«ã€‚ Generation ","date":"2023-11-01","objectID":"/posts/cmake_introduction/:4:0","tags":["CMake"],"title":"CMake ç®€ä»‹","uri":"/posts/cmake_introduction/"},{"categories":["C++"],"content":"5. The code CMake is an object-oriented system using inheritance, design patterns and encapsulation CMake æ˜¯ä½¿ç”¨äº†ç»§æ‰¿çš„é¢å‘å¯¹è±¡çš„ç³»ç»Ÿ Cmake Inheritage System The results of parsing each CMakeLists.txt file are stored in the cmMakefile object. In addition to storing the information about a directory, the cmMakefile object controls the parsing of the CMakeLists.txt file. The parsing function calls an object that uses a lex/yacc-based parser for the CMake language. Since the CMake language syntax changes very infrequently, and lex and yacc are not always available on systems where CMake is being built, the lex and yacc output files are processed and stored in the Source directory under version control with all of the other handwritten files. è§£æ CMakeLists.txt æ–‡ä»¶çš„ç»“æœè¢«ä¿å­˜åˆ° cmMakefile å¯¹è±¡å½“ä¸­ã€‚é™¤äº†ä¿å­˜ç›®å½•ä¿¡æ¯ï¼Œå®ƒè¿˜æ§åˆ¶æ–‡ä»¶çš„è§£æã€‚è§£æå‡½æ•°å¯ä»¥ä½¿ç”¨ CMake è¯­è¨€çš„è§£æå™¨ã€‚CMake è¯­æ³•ä¸æ€ä¹ˆå˜åŒ–ï¼Œè§£æå™¨åœ¨ CMake æ„å»ºæ—¶å¹¶éæ€»æ˜¯æ´»è·ƒçš„ï¼Œè§£æçš„ç»“æœä¼šè¢«ä¿å­˜åœ¨ Source ç›®å½•ä¸‹ã€‚ Another important class in CMake is cmCommand. This is the base class for the implementation of all commands in the CMake language. Each subclass not only provides the implementation for the command, but also its documentation. å¦ä¸€ä¸ªé‡è¦çš„ç±»æ˜¯ cmCommandã€‚è¿™æ˜¯ CMake å‘½ä»¤çš„åŸºç±»ã€‚æ¯ä¸ªå­ç±»ä¸ä»…æä¾›å‘½ä»¤çš„å®ç°ï¼Œè¿˜æœ‰å®ƒä»¬çš„æ–‡æ¡£è¯´æ˜ã€‚ ","date":"2023-11-01","objectID":"/posts/cmake_introduction/:5:0","tags":["CMake"],"title":"CMake ç®€ä»‹","uri":"/posts/cmake_introduction/"},{"categories":["C++"],"content":"6. Dependency Analysis Since Integrated Development Environments (IDEs) support and maintain file dependency information, CMake skips this step for those build systems. For IDE builds, CMake creates a native IDE input file, and lets the IDE handle the file level dependency information. The target level dependency information is translated to the IDEâ€™s format for specifying dependency information. ç”±äº IDE æœ¬èº«æ”¯æŒå’ŒæŒæœ‰æ–‡ä»¶ä¾èµ–ä¿¡æ¯ï¼ŒCMake å°±å¯ä»¥è·³è¿‡è¿™ä¸ªæ­¥éª¤ã€‚IDE æ„å»ºæ—¶ï¼ŒCMake åˆ›å»ºä¸€ä¸ªæœ¬åœ°çš„ IDE è¾“å…¥æ–‡ä»¶ï¼Œç„¶åè®© IDE å»å¤„ç†æ–‡ä»¶çº§åˆ«çš„ä¾èµ–ä¿¡æ¯ã€‚ç›®æ ‡çº§åˆ«çš„ä¾èµ–ä¿¡æ¯ä¼šè¢«è½¬æˆ IDE çš„æ ¼å¼æ¥æŒ‡æ˜ä¾èµ–ä¿¡æ¯ã€‚ With Makefile-based builds, native make programs do not know how to automatically compute and keep dependency information up-to-date. For these builds, CMake automatically computes dependency information for C, C++ and Fortran files. Both the generation and maintenance of these dependencies are automatically done by CMake. Once a project is initially configured by CMake, users only need to run make and CMake does the rest of the work. åœ¨ä½¿ç”¨ Makefile æ„å»ºï¼Œæœ¬åœ° make ç¨‹åºä¸éœ€è¦çŸ¥é“æ€ä¹ˆè‡ªåŠ¨è®¡ç®—å’Œä¿å­˜ä¾èµ–ä¿¡æ¯ä¸ºæœ€æ–°ã€‚æ„å»ºæ—¶ï¼ŒCMake è‡ªåŠ¨çš„è®¡ç®—è¿™äº›ä¾èµ–ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”Ÿæˆå’Œä¿å­˜ã€‚ä¸€æ—¦ CMake åˆå§‹é…ç½®å¥½äº†é¡¹ç›®ï¼Œç”¨æˆ·åªéœ€è¦å»è¿è¡Œ makeï¼Œç„¶å CMake ä¼šæŠŠå‰©ä¸‹çš„å·¥ä½œå®Œæˆã€‚ CMake does more than just generate the build files used to create object files and executable programs. It will generate a dependency file for each source file in the project. For example a main.cpp file will have a generated main.cpp.d file saved in the build folder hierarchy honouring the directory structure of the source files. CMake ä¸åªæ˜¯ç”Ÿæˆæ„å»ºæ–‡ä»¶ï¼Œå®ƒä¼šä¸ºé¡¹ç›®é‡Œçš„æ¯ä¸ªæºæ–‡ä»¶ç”Ÿæˆä¾èµ–æ–‡ä»¶ã€‚æ¯”å¦‚ main.cpp ä¼šä¿ƒä½¿ç”Ÿæˆ main.cpp.d æ–‡ä»¶ã€‚ Although users do not need to know how CMake does this work, it may be useful to look at the dependency information files for a project. This information for each target is stored in four files called depend.make, flags.make, build.make, and DependInfo.cmake. depend.make stores the dependency information for all the object files in the directory. flags.make contains the compile flags used for the source files of this target. If they change then the files will be recompiled. DependInfo.cmake is used to keep the dependency information up-to-date and contains information about what files are part of the project and what languages they are in. Finally, the rules for building the dependencies are stored in build.make. If a dependency for a target is out of date then the depend information for that target will be recomputed, keeping the dependency information current. This is done because a change to a .h file could add a new dependency. ä¾èµ–ä¿¡æ¯ä¼šè¢«ä¿å­˜åœ¨ 4 ä¸ªæ–‡ä»¶å½“ä¸­ï¼Œdepend.make, flags.make, build.make, DependInfo.cmake æ–‡ä»¶ã€‚depend.make ä¿å­˜æ‰€æœ‰ç›®å½•ä¸‹çš„ç›®æ ‡æ–‡ä»¶çš„ä¾èµ–ä¿¡æ¯ã€‚flags.make å«æœ‰ä»æºæ–‡ä»¶åˆ°ç›®æ ‡çš„ç¼–è¯‘å‚æ•°ï¼Œå¦‚æœå‚æ•°è¢«æ›´æ”¹ï¼Œè¿™ä¸ªæ–‡ä»¶ä¹Ÿä¼šè¢«é‡æ–°ç¼–è¯‘ã€‚DependInfo.cmake æ˜¯ç”¨æ¥ä¿è¯ä¾èµ–ä¿¡æ¯æ˜¯æœ€æ–°çš„ï¼Œä¿å­˜æœ‰å“ªäº›æ–‡ä»¶æ˜¯é¡¹ç›®çš„ä¸€éƒ¨åˆ†ä»¥åŠå®ƒä»¬æ˜¯ä»€ä¹ˆè¯­è¨€çš„ä¿¡æ¯ã€‚æœ€åï¼Œæ„å»ºè¿™äº›ä¾èµ–çš„è§„åˆ™ä¼šè¢«ä¿å­˜åœ¨ build.make æ–‡ä»¶ä¸­ã€‚å¦‚æœç›®æ ‡çš„ä¾èµ–è¿‡æœŸäº†ï¼Œé‚£ä¹ˆä¾èµ–ä¿¡æ¯ä¼šè¢«é‡æ–°è®¡ç®—ï¼Œä¿è¯ä¾èµ–ä¿¡æ¯æœ€æ–°ã€‚è¿™æ ·åšæ˜¯å› ä¸ºå¤´æ–‡ä»¶å¯èƒ½ä¼šæ·»åŠ æ–°çš„ä¾èµ–ã€‚ Cmake Dependency Graph ","date":"2023-11-01","objectID":"/posts/cmake_introduction/:6:0","tags":["CMake"],"title":"CMake ç®€ä»‹","uri":"/posts/cmake_introduction/"},{"categories":["C++"],"content":"7. CTest and CPack The ctest executable is used to run regression tests. A project can easily create tests for CTest to run with the add_test command. The tests can be run with CTest, which can also be used to send testing results to the CDash application for viewing on the web. CTest and CDash together are similar to the Hudson testing tool. They do differ in one major area: CTest is designed to allow a much more distributed testing environment. Clients can be setup to pull source from version control system, run tests, and send the results to CDash. With Hudson, client machines must give Hudson ssh access to the machine so tests can be run. ctest å¯æ‰§è¡Œæ–‡ä»¶ç”¨äºè·‘å›å½’æµ‹è¯•ã€‚ä¸€ä¸ªé¡¹ç›®å¯ä»¥é€šè¿‡ add_test å‘½ä»¤å¾ˆæ–¹ä¾¿åœ°åˆ›å»ºæµ‹è¯•ã€‚ç”± CTest æ¥æ‰§è¡Œï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥æŠŠæµ‹è¯•ç»“æœå‘ç»™ CDash æ¥åš web ç«¯å±•ç¤ºã€‚ The cpack executable is used to create installers for projects. CPack works much like the build part of CMake: it interfaces with other packaging tools. For example, on Windows the NSIS packaging tool is used to create executable installers from a project. CPack runs the install rules of a project to create the install tree, which is then given to a an installer program like NSIS. CPack also supports creating RPM, Debian .deb files, .tar, .tar.gz and self-extracting tar files. cpack å¯æ‰§è¡Œæ–‡ä»¶ç”¨æ¥åˆ›å»ºé¡¹ç›®çš„å®‰è£…å™¨ã€‚ ","date":"2023-11-01","objectID":"/posts/cmake_introduction/:7:0","tags":["CMake"],"title":"CMake ç®€ä»‹","uri":"/posts/cmake_introduction/"},{"categories":["C++"],"content":"8. Reference [1]. CMake æ„å»ºå·¥å…· [2]. https://aosabook.org/en/cmake.html [3]. https://blog.feabhas.com/2021/07/cmake-part-1-the-dark-arts/ [4]. https://blog.feabhas.com/2021/07/cmake-part-2-release-and-debug-builds/ [5]. æ·±å…¥ç†è§£CMakeï¼šä¼˜åŒ–æ„å»ºè¿‡ç¨‹ï¼Œæå‡å¼€å‘æ•ˆç‡ ","date":"2023-11-01","objectID":"/posts/cmake_introduction/:8:0","tags":["CMake"],"title":"CMake ç®€ä»‹","uri":"/posts/cmake_introduction/"},{"categories":["ObjectDetection"],"content":"Abstract DETRæ¶ˆé™¤äº†ç›®æ ‡æ£€ä»»åŠ¡ä¸­çš„æ‰‹å·¥è®¾è®¡ç—•è¿¹ï¼Œä½†æ˜¯å­˜åœ¨æ”¶æ•›æ…¢ä»¥åŠTransformerçš„è‡ªæ³¨æ„åŠ›é€ æˆçš„ç‰¹å¾å›¾åˆ†è¾¨ç‡ä¸èƒ½å¤ªé«˜çš„é—®é¢˜ï¼Œè¿™å°±å¯¼è‡´äº†å°ç›®æ ‡æ£€æµ‹æ€§èƒ½å¾ˆå·®ã€‚æˆ‘ä»¬çš„Deformable DETRåªåœ¨å‚è€ƒç‚¹é™„è¿‘é‡‡æ ·å°‘é‡çš„keyæ¥è®¡ç®—æ³¨æ„åŠ›ï¼Œå› æ­¤æˆ‘ä»¬çš„æ–¹æ³•æ”¶æ•›å¿«å¹¶ä¸”å¯ä»¥ç”¨åˆ°å¤šå°ºåº¦ç‰¹å¾ã€‚ ç›¸å¯¹äºTransformeré‚£ç§å…¨å±€(global)\u0026å¯†é›†(dense)çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œè¿™é‡Œæå‡ºäº†ä¸€ç§æ–°ç©æ³•: æ¯ä¸ªå‚è€ƒç‚¹ä»…å…³æ³¨é‚»åŸŸçš„ä¸€ç»„é‡‡æ ·ç‚¹ï¼Œè¿™äº›é‡‡æ ·ç‚¹çš„ä½ç½®å¹¶éå›ºå®šï¼Œè€Œæ˜¯å¯å­¦ä¹ çš„(å’Œå¯å˜å½¢å·ç§¯ä¸€æ ·)ï¼Œä»è€Œå®ç°äº†ä¸€ç§å±€éƒ¨(local)\u0026ç¨€ç–(sparse)çš„é«˜æ•ˆæ³¨æ„åŠ›æœºåˆ¶ã€‚ ","date":"2023-10-27","objectID":"/posts/deformabledetr/:1:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"1ã€Introduction ä¼ ç»Ÿç›®æ ‡æ£€æµ‹ä»»åŠ¡æœ‰å¾ˆå¤šæ‰‹å·¥è®¾è®¡ç—•è¿¹ï¼Œæ‰€ä»¥ä¸æ˜¯ç«¯åˆ°ç«¯çš„ç½‘ç»œã€‚DETRè¿ç”¨åˆ°äº†Transformerå¼ºå¤§çš„åŠŸèƒ½ä»¥åŠå…¨å±€å…³ç³»å»ºæ¨¡èƒ½åŠ›æ¥å–ä»£ç›®æ ‡æ£€æµ‹ä¸­äººå·¥è®¾è®¡ç—•è¿¹æ¥è¾¾åˆ°ç«¯åˆ°ç«¯çš„ç›®çš„ã€‚ DETR çš„ä¼˜åŠ¿: (i). ç¬¬ä¸€ä¸ªç«¯åˆ°ç«¯çš„ç›®æ ‡æ£€æµ‹å™¨ï¼› (ii). ä¸éœ€è¦ä¼—å¤šæ‰‹å·¥è®¾è®¡ç»„ä»¶(å¦‚anchorã€å›ºå®šè§„åˆ™çš„æ ‡ç­¾åˆ†é…ç­–ç•¥ã€NMSåå¤„ç†ç­‰) (iii). DETRå®è´¨ä¸Šç›¸å½“äºæ˜¯ç»™å‡ºäº†ä¸€ä¸ªæ–¹æ³•è®ºï¼ŒçŠ¹å¦‚â€œæ™®åº¦ä¼—ç”Ÿâ€ï¼Œå‘Šè¯‰å¤§å®¶Transformerå¯ä»¥æ‹¿åˆ°ç›®æ ‡æ£€æµ‹ä¸­æ¥ç©ï¼Œå¹¶æ²¡æœ‰è¿‡å¤šåœ°è¿½æ±‚å…¶å®ƒæ–¹é¢çš„æˆå°±ã€‚ DETRçš„ä¸¤å¤§ç¼ºç‚¹: æ”¶æ•›é€Ÿåº¦æ…¢(slow convergence): å› ä¸ºå…¨å±€åƒç´ ä¹‹é—´è®¡ç®—æ³¨æ„åŠ›è¦æ”¶æ•›åˆ°å‡ ä¸ªç¨€ç–çš„åƒç´ ç‚¹éœ€è¦æ¶ˆè€—å¾ˆé•¿çš„æ—¶é—´ã€‚ å°ç›®æ ‡æ£€æµ‹å·®: ç›®æ ‡æ£€æµ‹åŸºæœ¬éƒ½æ˜¯åœ¨å¤§åˆ†è¾¨ç‡çš„ç‰¹å¾å›¾ä¸Šè¿›è¡Œå°ç›®æ ‡çš„æ£€æµ‹ï¼Œä½†æ˜¯Transformerä¸­çš„Self Attentionçš„è®¡ç®—å¤æ‚åº¦æ˜¯å¹³æ–¹çº§åˆ«çš„ï¼Œæ‰€ä»¥åªèƒ½åˆ©ç”¨åˆ°æœ€åä¸€å±‚ç‰¹å¾å›¾ã€‚ Transformeråœ¨åˆå§‹åŒ–æ—¶ï¼Œåˆ†é…ç»™æ‰€æœ‰ç‰¹å¾åƒç´ çš„æ³¨æ„åŠ›æƒé‡å‡ ä¹æ˜¯å‡ç­‰çš„ï¼Œè¿™å°±é€ æˆäº†æ¨¡å‹éœ€è¦é•¿æ—¶é—´å»å­¦ä¹ å…³æ³¨çœŸæ­£æœ‰æ„ä¹‰çš„ä½ç½®ï¼Œè¿™äº›ä½ç½®åº”è¯¥æ˜¯ç¨€ç–çš„ï¼› Transformeråœ¨è®¡ç®—æ³¨æ„åŠ›æƒé‡æ—¶ï¼Œä¼´éšç€é«˜è®¡ç®—é‡ä¸ç©ºé—´å¤æ‚åº¦ã€‚ç‰¹åˆ«æ˜¯åœ¨ç¼–ç å™¨éƒ¨åˆ†ï¼Œä¸ç‰¹å¾åƒç´ ç‚¹çš„æ•°é‡æˆå¹³æ–¹çº§å…³ç³»ï¼Œå› æ­¤éš¾ä»¥å¤„ç†é«˜åˆ†è¾¨ç‡çš„ç‰¹å¾(è¿™ç‚¹ä¹Ÿæ˜¯DETRæ£€æµ‹å°ç›®æ ‡æ•ˆæœå·®çš„åŸå› ) å¯å˜å½¢å·ç§¯DCNæ˜¯ä¸€ç§æ³¨æ„ç¨€ç–ç©ºé—´ä½ç½®å¾ˆå¥½çš„æœºåˆ¶ï¼Œä½†æ˜¯å…¶ç¼ºä¹å…ƒç´ ä¹‹é—´å…³ç³»çš„å»ºæ¨¡èƒ½åŠ›ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼ŒDeformable Attentionæ¨¡å—ç»“åˆäº†DCNç¨€ç–é‡‡æ ·èƒ½åŠ›å’ŒTransformerçš„å…¨å±€å…³ç³»å»ºæ¨¡èƒ½åŠ›ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥èšåˆå¤šå°ºåº¦ç‰¹å¾ï¼Œä¸éœ€è¦FPNäº†ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªæ¨¡å—æ›¿æ¢äº†Transformer Encoderä¸­çš„Multi-Head Self-Attentionæ¨¡å—å’ŒTransformer Decoderä¸­çš„Cross Attentionæ¨¡å—ã€‚ Deformable DETRçš„æå‡ºå¯ä»¥å¸®åŠ©æ¢ç´¢æ›´å¤šç«¯åˆ°ç«¯ç›®æ ‡æ£€æµ‹æ–¹æ¡ˆï¼Œæå‡ºäº†bboxè¿­ä»£å¾®è°ƒç­–ç•¥å’Œä¸¤é˜¶æ®µæ–¹æ³•ï¼Œå…¶ä¸­iterative bounding box refinementç±»ä¼¼Cascade R-CNNæ–¹æ³•ï¼Œtwo stageç±»ä¼¼RPNã€‚ ","date":"2023-10-27","objectID":"/posts/deformabledetr/:2:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"2ã€Related work Transformerä¸­åŒ…å«äº†å¤šå¤´è‡ªæ³¨æ„åŠ›å’Œäº¤å‰æ³¨æ„åŠ›æœºåˆ¶ï¼Œå…¶ä¸­å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶å¯¹keyçš„æ•°é‡å¾ˆæ•æ„Ÿï¼Œå¹³æ–¹çº§åˆ«çš„å¤æ‚åº¦å¯¼è‡´ä¸èƒ½æœ‰å¤ªå¤šçš„keyï¼Œè§£å†³æ–¹æ³•ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸‰ç±»ã€‚ (1)ç¬¬ä¸€ç±»è§£å†³æ–¹æ³•ä¸ºåœ¨keyä¸Šä½¿ç”¨é¢„å®šä¹‰ç¨€ç–æ³¨æ„åŠ›æ¨¡å¼ï¼Œä¾‹å¦‚å°†æ³¨æ„åŠ›é™åˆ¶åœ¨ä¸€ä¸ªå›ºå®šçš„å±€éƒ¨çª—å£ä¸Šï¼Œè¿™å°†å¯¼è‡´å¤±å»äº†å…¨å±€ä¿¡æ¯ã€‚ (2)ç¬¬äºŒç±»æ˜¯é€šè¿‡æ•°æ®å­¦ä¹ åˆ°ç›¸å…³çš„ç¨€ç–æ³¨æ„åŠ›ã€‚ (3)ç¬¬ä¸‰ç±»æ˜¯å¯»æ‰¾è‡ªæ³¨æ„åŠ›ä¸­ä½ç­‰çº§çš„å±æ€§ï¼Œç±»ä¼¼é™åˆ¶å…³é”®å…ƒç´ çš„å°ºå¯¸å¤§å°ã€‚ å›¾åƒé¢†åŸŸçš„æ³¨æ„åŠ›æ–¹æ³•å¤§å¤šæ•°éƒ½å±€é™äºç¬¬ä¸€ç§è®¾è®¡æ–¹æ³•ï¼Œä½†æ˜¯å› ä¸ºå†…å­˜æ¨¡å¼åŸå› é€Ÿåº¦è¦æ¯”ä¼ ç»Ÿå·ç§¯æ…¢3å€(ç›¸åŒçš„FLOPsä¸‹)ã€‚DCNå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå®ƒæ¯”è‡ªæ³¨æ„åŠ›æœºåˆ¶æ›´åŠ é«˜æ•ˆæœ‰æ•ˆï¼Œä½†æ˜¯å…¶ç¼ºå°‘å…ƒç´ å…³ç³»å»ºæ¨¡çš„æœºåˆ¶ã€‚æˆ‘ä»¬çš„å¯å˜å½¢æ³¨æ„åŠ›æ¨¡å—æ¥æºäºDCNï¼Œå¹¶ä¸”å±äºç¬¬äºŒç±»æ³¨æ„åŠ›æ–¹æ³•ã€‚å®ƒåªå…³æ³¨ä»qç‰¹å¾é¢„æµ‹å¾—åˆ°çš„ä¸€å°éƒ¨åˆ†å›ºå®šæ•°é‡çš„é‡‡æ ·ç‚¹ã€‚ ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸€ä¸ªéš¾ç‚¹å°±æ˜¯é«˜æ•ˆçš„è¡¨å¾ä¸åŒå°ºåº¦ä¸‹çš„ç‰©ä½“ã€‚ç°åœ¨æœ‰çš„æ–¹æ³•æ¯”å¦‚FPNï¼ŒPA-FPNï¼ŒNAS-FPNï¼ŒAuto-FPNï¼ŒBiFPNç­‰ã€‚æˆ‘ä»¬çš„å¤šå°ºåº¦å¯å˜å½¢æ³¨æ„åŠ›æ¨¡å—å¯ä»¥è‡ªç„¶çš„èåˆåŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„å¤šå°ºåº¦ç‰¹å¾å›¾ï¼Œä¸éœ€è¦FPNäº†ã€‚ ","date":"2023-10-27","objectID":"/posts/deformabledetr/:3:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"3ã€Revisiting Transformers And DETR ","date":"2023-10-27","objectID":"/posts/deformabledetr/:4:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"3.1ã€Transformerä¸­çš„Multi-Head Self-Attention è¯¥æ¨¡å—è®¡ç®—å¤æ‚åº¦ä¸º: $O(N_qC^2+N_kC^2+N_qN_kC)$ ï¼Œå…¶ä¸­ $C$ ä»£è¡¨ç‰¹å¾å›¾ç»´åº¦ï¼Œ$N_q$ å’Œ $N_k$ å‡ä¸ºå›¾ç‰‡ä¸­çš„åƒç´ (pixel)ï¼Œå› æ­¤æœ‰ $N_{q}=N_{k}\\gg C$ ã€‚æ‰€ä»¥è®¡ç®—å¤æ‚åº¦å¯ä»¥ç®€åŒ–ä¸º $O(N_{q}N_{k}C)$ ï¼Œå¯ä»¥å¾—å‡ºå…¶ä¸å›¾ç‰‡åƒç´ çš„æ•°é‡æˆå¹³æ–¹çº§åˆ«çš„è®¡ç®—å¤æ‚åº¦ã€‚ ","date":"2023-10-27","objectID":"/posts/deformabledetr/:4:1","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"3.2ã€DETR DETRåœ¨ç›®æ ‡æ£€æµ‹é¢†åŸŸä¸­å¼•å…¥äº†Transformerç»“æ„å¹¶ä¸”å–å¾—äº†ä¸é”™çš„æ•ˆæœã€‚è¿™å¥—èŒƒå¼æ‘’å¼ƒäº†ä¼ ç»Ÿç›®æ ‡æ£€æµ‹ä¸­çš„anchorå’Œpost processing æœºåˆ¶ï¼Œè€Œæ˜¯å…ˆé¢„å…ˆè®¾å®š100ä¸ªobject queriesç„¶åè¿›è¡ŒäºŒåˆ†å›¾åŒ¹é…è®¡ç®—lossã€‚å…¶å…·ä½“æµç¨‹å›¾(pipeline)å¦‚ä¸‹: è¾“å…¥å›¾ç‰‡3Ã—800Ã—1066çš„ä¸€å¼ å›¾ç‰‡ï¼Œç»è¿‡å·ç§¯ç¥ç»ç½‘ç»œæå–ç‰¹å¾ï¼Œé•¿å®½32å€ä¸‹é‡‡æ ·åå¾—åˆ°2048Ã—25Ã—34ï¼Œç„¶åé€šè¿‡ä¸€ä¸ª1Ã—1 Convè¿›è¡Œé™ç»´æœ€ç»ˆå¾—åˆ°è¾“å‡ºshapeä¸º256Ã—25Ã—34. positional encodingä¸ºç»å¯¹ä½ç½®ç¼–ç ï¼Œä¸ºäº†å’Œç‰¹å¾å®Œå…¨åŒ¹é…å½¢çŠ¶ä¹Ÿä¸º256Ã—25Ã—34ï¼Œç„¶åå’Œç‰¹å¾è¿›è¡Œå…ƒç´ çº§åˆ«çš„ç›¸åŠ åè¾“å…¥åˆ°Transformer Encoderä¸­ã€‚ è¾“å…¥åˆ°Encoderçš„å°ºå¯¸ä¸º(25Ã—34)Ã—256=850Ã—256ï¼Œä»£è¡¨æœ‰850ä¸ªtokenï¼Œæ¯ä¸ªtokençš„ç»´åº¦ä¸º256ï¼ŒEncoderä¸æ”¹å˜è¾“å…¥çš„Shapeã€‚ Encoderçš„è¾“å‡ºå’Œobject queriesè¾“å…¥åˆ°Decoderä¸­å½¢æˆcross attentionï¼Œobject queriesçš„ç»´åº¦è®¾ç½®ä¸ºanchoræ•°é‡Ã—tokenæ•°é‡ã€‚ Decoderè¾“å‡ºåˆ°FFNè¿›è¡Œåˆ†ç±»å’Œæ¡†å®šä½ï¼Œå…¶ä¸­FFNæ˜¯å…±äº«å‚æ•°çš„ã€‚ Tips: è™½ç„¶DETRæ²¡æœ‰anchorï¼Œä½†æ˜¯object querieså…¶å®å°±æ˜¯èµ·åˆ°äº†anchorçš„ä½œç”¨ã€‚ ","date":"2023-10-27","objectID":"/posts/deformabledetr/:4:2","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"4ã€Method ","date":"2023-10-27","objectID":"/posts/deformabledetr/:5:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"4.1ã€Deformable Attention Module Deformable Attention Moduleä¸»è¦æ€æƒ³æ˜¯ç»“åˆäº†DCNå’Œè‡ªæ³¨æ„åŠ›ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†é€šè¿‡åœ¨è¾“å…¥ç‰¹å¾å›¾ä¸Šçš„å‚è€ƒç‚¹(reference point)é™„è¿‘åªé‡‡æ ·å°‘æ•°ç‚¹(deformable detrè®¾ç½®ä¸º3ä¸ªç‚¹)æ¥ä½œä¸ºæ³¨æ„åŠ›çš„ $k$ã€‚å› æ­¤è¦è§£å†³çš„é—®é¢˜å°±æ˜¯: (1). ç¡®å®šreference pointã€‚ (2). ç¡®å®šæ¯ä¸ªreference pointçš„åç§»é‡(offset)ã€‚ (3). ç¡®å®šæ³¨æ„åŠ›æƒé‡çŸ©é˜µã€‚ åœ¨Encoderå’ŒDecoderä¸­å®ç°æ–¹æ³•ä¸å¤ªä¸€æ ·ï¼ŒåŠ ä¸‹æ¥è¯¦ç»†å™è¿°ã€‚ Encoderéƒ¨åˆ† åœ¨Encoderéƒ¨åˆ†ï¼Œè¾“å…¥çš„Query Feature $z_q$ ä¸ºåŠ å…¥äº†ä½ç½®ç¼–ç çš„ç‰¹å¾å›¾(src+pos)ï¼Œ$value(x)$ çš„è®¡ç®—æ–¹æ³•åªä½¿ç”¨äº†srcè€Œæ²¡æœ‰ä½ç½®ç¼–ç (value_projå‡½æ•°)ã€‚ (1). reference pointç¡®å®šæ–¹æ³•ä¸ºç”¨äº†torch.meshgridæ–¹æ³•ï¼Œè°ƒç”¨çš„å‡½æ•°å¦‚ä¸‹(get_reference_points)ï¼Œæœ‰ä¸€ä¸ªç»†èŠ‚å°±æ˜¯å‚è€ƒç‚¹å½’ä¸€åŒ–åˆ°0å’Œ1ä¹‹é—´ï¼Œå› æ­¤å–å€¼çš„æ—¶å€™è¦ç”¨åˆ°åŒçº¿æ€§æ’å€¼çš„æ–¹æ³•ã€‚ ä¸åŒç‚¹: åœ¨Decoderä¸­ï¼Œå‚è€ƒç‚¹çš„è·å–æ–¹æ³•ä¸ºobject queriesé€šè¿‡ä¸€ä¸ªnn.Linearå¾—åˆ°æ¯ä¸ªå¯¹åº”çš„reference pointã€‚ def get_reference_points(spatial_shapes, valid_ratios, device): reference_points_list = [] for lvl, (H_, W_) in enumerate(spatial_shapes): # ä»0.5åˆ°H-0.5é‡‡æ ·Hä¸ªç‚¹ï¼ŒWåŒç† è¿™ä¸ªæ“ä½œçš„ç›®çš„ä¹Ÿå°±æ˜¯ä¸ºäº†ç‰¹å¾å›¾çš„å¯¹é½ ref_y, ref_x = torch.meshgrid(torch.linspace(0.5, H_ - 0.5, H_, dtype=torch.float32, device=device), torch.linspace(0.5, W_ - 0.5, W_, dtype=torch.float32, device=device)) ref_y = ref_y.reshape(-1)[None] / (valid_ratios[:, None, lvl, 1] * H_) ref_x = ref_x.reshape(-1)[None] / (valid_ratios[:, None, lvl, 0] * W_) ref = torch.stack((ref_x, ref_y), -1) reference_points_list.append(ref) reference_points = torch.cat(reference_points_list, 1) reference_points = reference_points[:, :, None] * valid_ratios[:, None] return reference_points (2)è®¡ç®—offsetçš„æ–¹æ³•ä¸ºå¯¹ $z_q$ åšä¸€ä¸ªnn.Linearï¼Œå¾—åˆ°å¤šç»„åç§»é‡ï¼Œæ¯ç»„åç§»é‡çš„ç»´åº¦ä¸ºå‚è€ƒç‚¹çš„ä¸ªæ•°ï¼Œç»„æ•°ä¸ºæ³¨æ„åŠ›å¤´çš„æ•°é‡ã€‚ (3)è®¡ç®—æ³¨æ„åŠ›æƒé‡çŸ©é˜µçš„æ–¹æ³•ä¸ºè¿‡ä¸€ä¸ªnn.Linearå’Œä¸€ä¸ªF.softmaxï¼Œå¾—åˆ°æ¯ä¸ªå¤´çš„æ³¨æ„åŠ›æƒé‡ã€‚ å¦‚å›¾2æ‰€ç¤ºï¼Œåˆ†å¤´è®¡ç®—å®Œçš„æ³¨æ„åŠ›æœ€ç»ˆä¼šæ‹¼æ¥åˆ°ä¸€èµ·ï¼Œç„¶åæœ€åè¿‡ä¸€ä¸ªnn.Linearå¾—åˆ°è¾“å…¥ $x$ çš„æœ€ç»ˆè¾“å‡ºã€‚ ","date":"2023-10-27","objectID":"/posts/deformabledetr/:5:1","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"4.2ã€Multi-Scale Deformable Attention Module Multi-Scale Features \u0026 Scale-Level Embedding å¤šå°ºåº¦çš„Deformable Attentionæ¨¡å—ä¹Ÿæ˜¯åœ¨å¤šå°ºåº¦ç‰¹å¾å›¾ä¸Šè®¡ç®—çš„ã€‚å¤šå°ºåº¦çš„ç‰¹å¾èåˆæ–¹æ³•åˆ™æ˜¯å–äº†éª¨å¹²ç½‘ç»œ(ResNet)æœ€åä¸‰å±‚çš„ç‰¹å¾å›¾C3ï¼ŒC4ï¼ŒC5ï¼Œå¹¶ä¸”ç”¨äº†ä¸€ä¸ªConv3x3 Stride2çš„å·ç§¯å¾—åˆ°äº†ä¸€ä¸ªC6æ„æˆäº†å››å±‚ç‰¹å¾å›¾ã€‚ä¸‹é‡‡æ ·ç‡å¯¹åº”ä¸º8ã€16ã€32ï¼Œ $C_6$ ç”± $C_5$ ç»è¿‡æ­¥é•¿ä¸º2çš„3x3å·ç§¯å¾—åˆ°ã€‚ç‰¹åˆ«çš„æ˜¯ä¼šé€šè¿‡å·ç§¯æ“ä½œå°†é€šé“æ•°é‡ç»Ÿä¸€ä¸º256(ä¹Ÿå°±æ˜¯tokençš„æ•°é‡)ï¼Œç„¶ååœ¨è¿™å››ä¸ªç‰¹å¾å›¾ä¸Šè¿è¡ŒDeformable Attention Moduleå¹¶ä¸”è¿›è¡Œç›´æ¥ç›¸åŠ å¾—åˆ°æœ€ç»ˆè¾“å‡ºã€‚å…¶ä¸­Deformable Attention Moduleç®—å­çš„pytorchå®ç°å¦‚ä¸‹: def ms_deform_attn_core_pytorch(value, value_spatial_shapes, sampling_locations, attention_weights): # for debug and test only, # need to use cuda version instead N_, S_, M_, D_ = value.shape # batch size, number token, number head, head dims # Lq_: number query, L_: level number, P_: sampling numberé‡‡æ ·ç‚¹æ•° _, Lq_, M_, L_, P_, _ = sampling_locations.shape # æŒ‰ç…§levelåˆ’åˆ†value value_list = value.split([H_ * W_ for H_, W_ in value_spatial_shapes], dim=1) # [0, 1] -\u003e [-1, 1] å› ä¸ºè¦æ»¡è¶³F.grid_sampleçš„è¾“å…¥è¦æ±‚ sampling_grids = 2 * sampling_locations - 1 sampling_value_list = [] for lid_, (H_, W_) in enumerate(value_spatial_shapes): # N_, H_*W_, M_, D_ -\u003e N_, H_*W_, M_*D_ -\u003e N_, M_*D_, H_*W_ -\u003e N_*M_, D_, H_, W_ value_l_ = value_list[lid_].flatten(2).transpose(1, 2).reshape(N_*M_, D_, H_, W_) # N_, Lq_, M_, P_, 2 -\u003e N_, M_, Lq_, P_, 2 -\u003e N_*M_, Lq_, P_, 2 sampling_grid_l_ = sampling_grids[:, :, :, lid_].transpose(1, 2).flatten(0, 1) # N_*M_, D_, Lq_, P_ # ç”¨åŒçº¿æ€§æ’å€¼ä»feature mapä¸Šè·å–valueï¼Œå› ä¸ºmaskçš„åŸå› è¶Šç•Œæ‰€ä»¥è¦zerosçš„æ–¹æ³•è¿›è¡Œå¡«å…… sampling_value_l_ = F.grid_sample(value_l_, sampling_grid_l_, mode='bilinear', padding_mode='zeros', align_corners=False) sampling_value_list.append(sampling_value_l_) # (N_, Lq_, M_, L_, P_) -\u003e (N_, M_, Lq_, L_, P_) -\u003e (N_, M_, 1, Lq_, L_*P_) attention_weights = attention_weights.transpose(1, 2).reshape(N_*M_, 1, Lq_, L_*P_) # ä¸åŒscaleè®¡ç®—å‡ºçš„multi head attention è¿›è¡Œç›¸åŠ ï¼Œè¿”å›outputåè¿˜éœ€è¦è¿‡ä¸€ä¸ªLinearå±‚ output = (torch.stack(sampling_value_list, dim=-2).flatten(-2) * attention_weights).sum(-1).view(N_, M_*D_, Lq_) return output.transpose(1, 2).contiguous() è¦çŸ¥é“ï¼ŒDETRä»…ç”¨äº†å•å°ºåº¦ç‰¹å¾ï¼Œäºæ˜¯å¯¹äºç‰¹å¾ç‚¹ä½ç½®ä¿¡æ¯çš„ç¼–ç ï¼Œä½¿ç”¨çš„æ˜¯ä¸‰è§’å‡½æ•°ï¼Œä¸åŒä½ç½®çš„ç‰¹å¾ç‚¹ä¼šå¯¹åº”ä¸åŒçš„ç¼–ç å€¼ï¼Œæ²¡é—®é¢˜ã€‚ä½†æ˜¯ï¼Œæ³¨æ„äº†ï¼Œè¿™ä»…èƒ½åŒºåˆ†ä½äºå•å°ºåº¦ç‰¹å¾ç‚¹çš„ä½ç½®ï¼è€Œåœ¨å¤šå°ºåº¦ç‰¹å¾ä¸­ï¼Œä½äºä¸åŒç‰¹å¾å±‚çš„ç‰¹å¾ç‚¹å¯èƒ½æ‹¥æœ‰ç›¸åŒçš„(h,w)åæ ‡ï¼Œè¿™æ ·å°±æ— æ³•åŒºåˆ†å®ƒä»¬çš„ä½ç½®ç¼–ç äº†ã€‚ é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…å¢åŠ ä½¿ç”¨ä¸€ä¸ªç§°ä¹‹ä¸ºscale-level embeddingçš„ä¸œä¸œï¼Œå®ƒä»…ç”¨äºåŒºåˆ†ä¸åŒçš„ç‰¹å¾å±‚ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ç‰¹å¾å±‚ä¸­çš„æ‰€æœ‰ç‰¹å¾ç‚¹ä¼šå¯¹åº”ç›¸åŒçš„scale-level embeddingï¼Œäºæ˜¯æœ‰å‡ å±‚ç‰¹å¾å°±ä½¿ç”¨å‡ ä¸ªä¸åŒçš„scale-level embeddingã€‚ å¦å¤–ï¼Œä¸åŒäºä¸‰è§’å‡½æ•°é‚£ç§å›ºå®šåœ°åˆ©ç”¨å…¬å¼è®¡ç®—å‡ºæ¥çš„ç¼–ç æ–¹å¼ï¼Œè¿™ä¸ªscale-level embeddingæ˜¯éšæœºåˆå§‹åŒ–å¹¶ä¸”æ˜¯éšç½‘ç»œä¸€èµ·è®­ç»ƒçš„ã€æ˜¯å¯å­¦ä¹ çš„: # scale-level embedding # å¯¹4ä¸ªç‰¹å¾å±‚æ¯å±‚é™„åŠ 256-dimçš„embedding # ç›®çš„æ˜¯ä¸ºäº†åŒºåˆ†queryå¯¹åº”åˆ°å“ªä¸ªç‰¹å¾å±‚ï¼Œå®ƒä¼šä¸position embeddingç›¸åŠ åœ¨ä¸€èµ· # æ³¨æ„: ä½äºåŒä¸€ä¸ªç‰¹å¾çš„æ‰€æœ‰queryéƒ½ä¼šå¯¹åº”åˆ°ç›¸åŒçš„scale-level embedding self.level_embed = nn.Parameter(torch.Tensor(num_feature_levels, d_model)) åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œè¿™ä¸ª scale-level embedding ä¸åŸºäºä¸‰è§’å‡½æ•°å…¬å¼è®¡ç®—çš„ position embedding ç›¸åŠ åœ¨ä¸€èµ·ä½œä¸ºä½ç½®ä¿¡æ¯çš„åµŒå…¥: # ç”±äº position embeddingä»…åŒºåˆ†h, wçš„ä½ç½®ï¼Œå› æ­¤å¯¹äºä¸åŒç‰¹å¾å±‚æœ‰ç›¸åŒåæ ‡å€¼çš„ç‰¹å¾ç‚¹æ¥è¯´ï¼Œæ˜¯æ— æ³•åŒºåˆ†çš„ï¼Œäºæ˜¯è¿™é‡Œé™„åŠ ä¸Šscale-level embeddingä½œä¸ºç‰¹å¾å±‚çš„åŒºåˆ†ä¿¡æ¯ï¼Œè¿™æ ·ï¼Œæ‰€æœ‰ç‰¹å¾ç‚¹çš„ä½ç½®ä¿¡æ¯å°±å„ä¸ç›¸åŒäº† # (bs, c, h, w) =\u003e (bs, h*w, c) pos_embed = pos_embed.flatten(2).transpose(1, 2) # (bs, h*w, c) + (1, 1, 256) # note that c = 256 here lvl_pos_embed = pos_embed + self.level_embed[lvl].view(1, 1, -1) Deformable Attention(\u0026Multi-Scale) å¯å˜å½¢æ³¨æ„åŠ›çš„é“ç†ç”¨å¤§ç™½è¯æ¥è¯´å¾ˆç®€å•: queryä¸æ˜¯å’Œå…¨å±€æ¯ä¸ªä½ç½®çš„keyéƒ½è®¡ç®—æ³¨æ„åŠ›æƒé‡ï¼Œè€Œæ˜¯å¯¹äºæ¯ä¸ªqueryï¼Œä»…åœ¨å…¨å±€ä½ç½®ä¸­é‡‡æ ·éƒ¨åˆ†ä½ç½®çš„keyï¼Œå¹¶ä¸”valueä¹Ÿæ˜¯åŸºäºè¿™äº›ä½ç½®è¿›è¡Œé‡‡æ ·æ’å€¼å¾—åˆ°çš„ï¼Œæœ€åå°†è¿™ä¸ªå±€éƒ¨\u0026ç¨€ç–çš„æ³¨æ„åŠ›æƒé‡æ–½åŠ åœ¨å¯¹åº”çš„valueä¸Šã€‚ Transformerä¸­å¤šå¤´æ³¨æ„åŠ›çš„å…¬å¼å¦‚ä¸‹: $$ \\text{MultiHeadAttn}(z_q,x)=\\sum_{m=1}^MW_m\\big[\\sum_{k\\in\\Omega_k}A_{mqk}\\cdot W_m^{\\prime}x_k\\big], $$ å…¶ä¸­ï¼Œ$z_q$ çœ‹ä½œqueryï¼Œç”± $x$ ç»è¿‡çº¿æ€§å˜æ¢ç”Ÿæˆï¼Œ$q$ æ˜¯å¯¹åº”çš„ç´¢å¼•ï¼Œ$k$ æ˜¯keyçš„ç´¢å¼•, $\\Omega_k$ å³æ‰€æœ‰çš„ $k$ é›†åˆï¼Œ$m$ ä»£è¡¨æ˜¯ç¬¬å‡ ä¸ªæ³¨æ„åŠ›å¤´éƒ¨ï¼Œ$W_m$ æ˜¯å¯¹æ³¨æ„åŠ›æ–½åŠ åœ¨valueåçš„ç»“æœè¿›è¡Œçº¿æ€§å˜æ¢ä»è€Œå¾—åˆ°ä¸åŒå¤´éƒ¨çš„è¾“å‡ºç»“æœï¼Œ$W_m^{â€™}$ç”¨äºå°† $x_k$ å˜æ¢æˆvalueï¼Œ$A_{mqk}$ ä»£è¡¨å½’ä¸€åŒ–çš„æ³¨æ„åŠ›æƒé‡ã€‚ Deformable Attetionå…¬å¼: $$ \\text{DeformAttn}(z_q,p_q,x)=\\sum_{m=1}^MW_m\\big[\\sum_{k=1}^KA_{mqk}\\cdot W_mâ€™x(p_q+\\Delta p_{mqk})\\big], $$ å’ŒTransformerçš„å¾ˆåƒæ˜¯ä¸æ˜¯ï¼Ÿ(è€å¸ˆæˆ‘æ²¡æœ‰æŠ„ä½œä¸šï¼Œåˆ«å‡¶..)å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå¤šäº† $p_q$ å’Œ $\\Delta p_{mqk}$ã€‚å…¶ä¸­ï¼Œå‰è€…ä»£è¡¨ $z_q$ çš„ä½ç½®(ç†è§£æˆåæ ‡å³å¯)ï¼Œæ˜¯2då‘é‡ï¼Œä½œè€…ç§°å…¶ä¸ºå‚è€ƒç‚¹(reference points)ï¼›è€Œåè€…æ˜¯é‡‡æ ·é›†åˆç‚¹ç›¸å¯¹äºå‚è€ƒç‚¹çš„ä½ç½®åç§»(offsets)ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªqueryåœ¨æ¯ä¸ªå¤´éƒ¨ä¸­é‡‡æ ·Kä¸ªä½ç½®ï¼Œåªéœ€å’Œè¿™äº›ä½ç½®çš„ç‰¹å¾äº¤äº’($x(p_q+\\Delta p_{mqk})$ ä»£è¡¨åŸºäºé‡‡æ ·ç‚¹ä½ç½®æ’å€¼å‡ºæ¥çš„value)ï¼Œå¹¶ä¸éœ€è¦åƒTransformerèˆ¬ä¸€å¼€å§‹å…ˆä»å…¨å±€ä½ç½®å¼€å§‹å­¦ä¹ æ‰èƒ½é€æ¸è¿‡æ¸¡åˆ°å…³æ³¨å±€éƒ¨(\u0026ç¨€ç–çš„)çš„ã€çœŸæ­£æœ‰æ„ä¹‰çš„ä½ç½®ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚å¯å˜å½¢å·ç§¯ä¸€æ ·ï¼Œä½ç½®åç§» $\\Delta p_{mqk}$ æ˜¯å¯å­¦ä¹ çš„ï¼Œç”±queryç»è¿‡å…¨è¿æ¥å±‚å¾—åˆ°ã€‚å¹¶ä¸”ï¼Œæ³¨æ„åŠ›æƒé‡ä¹Ÿä¸€æ ·ï¼Œç›´æ¥ç”±queryç»è¿‡å…¨è¿æ¥å±‚å¾—åˆ°(å› æ­¤ï¼Œåœ¨å¯å˜å½¢æ³¨æ„åŠ›æœºåˆ¶ä¸‹ï¼Œå…¶å®æ²¡æœ‰çœŸæ­£æ‰€è°“çš„keyæ¥ä¸queryäº¤äº’è®¡ç®—ï¼Œä¸ºä½•å¯ä»¥è¿™æ ·åšï¼Œåæ–‡CWä¼šè°ˆè‡ªå·±çš„çœ‹æ³•)ï¼åŒæ—¶åœ¨K","date":"2023-10-27","objectID":"/posts/deformabledetr/:5:2","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"4.3 Deformable Transformer è¿™é‡Œçš„Transformerå’ŒDETRä¸­çš„å¤§ä½“è¿‡ç¨‹ä¸€è‡´ï¼Œæœ€ä¸»è¦çš„åŒºåˆ«åœ¨äºç”¨å¯å˜å½¢æ³¨æ„åŠ›æ›¿ä»£äº†Encoderä¸­çš„è‡ªæ³¨æ„åŠ›(self-attention)ä»¥åŠDecoderä¸­çš„äº¤å‰æ³¨æ„åŠ›(cross-attention)ã€‚åœ¨åˆ†åˆ«è§£æEncoderå’ŒDecoderå‰ï¼ŒCWå…ˆå‘å¤§å®¶æ¢³ç†ä¸‹è¿™é‡ŒTransformerçš„æ•´ä¸ªpipeline(æœ‰æºç è§£æå“¦ï¼)ã€‚ 1). ä¸ºEncoderçš„è¾“å…¥åšå‡†å¤‡ ä¸»è¦æ˜¯å°†ä¸€äº›è¾“å…¥å…ƒç´ çš„ç»´åº¦å±•å¹³(flatten)ï¼Œè¿™äº›è¾“å…¥å…ƒç´ åŒ…æ‹¬: å¤šå°ºåº¦ç‰¹å¾å›¾ã€å„å°ºåº¦ç‰¹å¾å›¾å¯¹åº”çš„mask(æŒ‡ç¤ºå“ªäº›éƒ¨åˆ†å±äºpadding)ã€å„å°ºåº¦ç‰¹å¾å›¾å¯¹åº”çš„ä½ç½®ä¿¡æ¯(position embedding + scale-level embedding)ï¼Œå¦å¤–è¿˜æœ‰äº›è¾…åŠ©ä¿¡æ¯ï¼Œæ¯”å¦‚: å„å°ºåº¦ç‰¹å¾å›¾çš„å®½é«˜ã€ä¸åŒå°ºåº¦ç‰¹å¾å¯¹åº”äºè¢«flattençš„é‚£ä¸ªç»´åº¦çš„èµ·å§‹ç´¢å¼•ã€å„å°ºåº¦ç‰¹å¾å›¾ä¸­épaddingéƒ¨åˆ†çš„è¾¹é•¿å å…¶è¾¹é•¿çš„æ¯”ä¾‹ã€‚ # deformable transformer forwardå‡½æ•° def forward(self, srcs, masks, pos_embeds, query_embed=None): assert self.two_stage or query_embed is not None \"\"\"ä¸ºEncoderçš„è¾“å…¥ä½œå‡†å¤‡: (i). å°†å„å±‚ç‰¹å¾å›¾(å·²æ˜ å°„åˆ°c=256ç»´åº¦)flattenå¹¶concatåˆ°ä¸€èµ·: (bs, h_lvl1 * w_lvl1 + h_lvl2 * w_lvl2 +..., 256); (ii). å°†å„å±‚ç‰¹å¾å›¾å¯¹åº”çš„mask(æŒ‡ç¤ºäº†å“ªäº›ä½ç½®æ˜¯padding)flattenå¹¶concat: (bs, h_lvl1 * w_lvl1 + h_lvl2 * w_lvl2 + ...,) (iii). å°†å„å±‚ç‰¹å¾å›¾å¯¹åº”çš„position embeddingåŠ ä¸Šscale level embedding(ç”¨äºè¡¨æ˜queryå±äºå“ªä¸ªç‰¹å¾å±‚)ï¼Œ ç„¶åflattenå¹¶concat: (bs, h_lvl1 * w_lvl1 + h_lvl2 * w_lvl2 + ..., 256); (iv). å°†å„å±‚ç‰¹å¾å›¾çš„å®½é«˜ç”±listå˜ä¸ºtensor: (n_lvl, 2); (v). ç”±äºå°†æ‰€æœ‰ç‰¹å¾å›¾çš„ç‰¹å¾ç‚¹concatåœ¨äº†ä¸€èµ· (h_lvl1 * w_lvl1 + h_lvl2 * w_lvl2 + ...), å› æ­¤ä¸ºäº†åŒºåˆ†å„å±‚ï¼Œéœ€è¦è®¡ç®—å¯¹åº”äºè¢«flattené‚£ä¸ªç»´åº¦çš„èµ·å§‹index(ç¬¬ä¸€å±‚å½“ç„¶æ˜¯0ï¼Œåé¢å°±æ˜¯ç´¯åŠ ...) (vi). è®¡ç®—å„å±‚ç‰¹å¾å±‚ä¸­épaddingçš„éƒ¨åˆ†è¾¹é•¿(é«˜\u0026å®½)å ç‰¹å¾å›¾è¾¹é•¿çš„æ¯”ä¾‹(bs, n_lvl, 2) \"\"\" # prepare input for encoder # ä»¥ä¸‹çš„flattenæŒ‡çš„æ˜¯å°†hï¼Œwä¸¤ä¸ªç»´åº¦å±•å¹³ä¸ºh * w src_flatten = [] mask_flatten = [] # å„å±‚ç‰¹å¾å›¾å¯¹åº”çš„position embedding + scale-level embedding lvl_pos_embed_flatten = [] # å„å±‚ç‰¹å¾å›¾çš„å°ºå¯¸(h, w) spatial_shapes = [] for lvl, (src, mask, pos_embed) in enumerate(zip(srcs, masks, pos_embeds)): bs, c, h, w = src.shape spatial_shape = (h, w) spatial_shapes.append(spatial_shape) # (bs, c, h, w) =\u003e (bs, h*w, c) src = src.flatten(2).transpose(1, 2) # (bs, h, w) =\u003e (bs, h*w) mask = mask.flatten(1) \"\"\" ç”±äºposition embeddingä»…åŒºåˆ†hï¼Œwçš„ä½ç½® å› æ­¤å¯¹äºä¸åŒç‰¹å¾å±‚æœ‰ç›¸åŒåæ ‡å€¼çš„ç‰¹å¾ç‚¹æ¥è¯´ï¼Œæ˜¯æ— æ³•åŒºåˆ†çš„ï¼Œäºæ˜¯è¿™é‡Œé™„åŠ ä¸Šscale-level embeddingä½œä¸ºç‰¹å¾å±‚çš„åŒºåˆ†ä¿¡æ¯ è¿™æ ·ï¼Œæ‰€æœ‰ç‰¹å¾ç‚¹çš„ä½ç½®ä¿¡æ¯å°±å„ä¸ç›¸åŒäº† \"\"\" # (bs, c, h, w) =\u003e (bs, h * w, c) pos_embed = pos_embed.flatten(2).transpose(1, 2) # (bs, h*w, c) + (1, 1, 256)\\ # note that c = 256 here lvl_pos_embed = pos_embed + self.level_embed[lvl].view(1, 1, -1) lvl_pos_embed_flatten.append(lvl_pos_embed) src_flatten.append(src) mask_flatten.append(mask) # (bs, h_lvl1 * w_lvl1 + h_lvl2 * w_lvl2 + ..., c) src_flatten = torch.cat(src_flatten, 1) # (bs, h_lvl1 * w_lvl1 + h_lvl2 * w_lvl2 + ...) mask_flatten = torch.cat(mask_flatten, 1) # (bs, h_lvl1 * w_lvl1 + h_lvl2 * w_lvl2 + ..., c) lvl_pos_embed_flatten = torch.cat(lvl_pos_embed_flatten, 1) # (n_lvl,2) spatial_shapes = torch.as_tensor(spatial_shapes, dtype=torch.long, device=src_flatten.device) # .prod(dim=1)æ˜¯å°†dim1çš„å„ä¸ªå…ƒç´ ç›¸ä¹˜ï¼Œåœ¨è¿™é‡Œå°±ä¼šå¾—åˆ°å„ç‰¹å¾å±‚ç‚¹æ•°é‡: h * w # .cumsum(0)ä»£è¡¨åœ¨dim=0è¿›è¡Œç´¯åŠ ï¼Œåœ¨è¿™é‡Œå°±ä¼šå¾—åˆ°h_lvl1 * w_lvl1, h_lvl1 * w_lvl1 + h_lvl2 * w_lvl2, ... # å› æ­¤è¿™é‡Œå¾—åˆ°çš„level_start_indexæ˜¯å„ç‰¹å¾å±‚èµ·å§‹çš„index(è¿™ä¸ªç´¢å¼•å¯¹åº”åˆ°è¢«flattençš„ç»´åº¦) # (n_lvl,) level_start_index = torch.cat((spatial_shapes.new_zeros((1, )), spatial_shapes.prod(1).cumsum(0)[:-1])) # (bs, n_lvl, 2) å„ç‰¹å¾å±‚ä¸­épaddingéƒ¨åˆ†çš„è¾¹é•¿(é«˜\u0026å®½)å ç‰¹å¾å›¾è¾¹é•¿çš„æ¯”ä¾‹ valid_ratios = torch.stack([self.get_valid_ratio(m) for m in masks], 1) # encoder memory = self.encoder(src_flatten, spatial_shapes, level_start_index, valid_ratios, lvl_pos_embed_flatten, mask_flatten) 2). Encoderç¼–ç ç‰¹å¾ æºç å¯¹åº”ä¸Šå›¾æœ€åä¸€å¥ã€‚ encoderéƒ¨åˆ†ï¼Œè¾“å‡ºmemory(ç¼–ç åçš„ç‰¹å¾è¡¨ç¤º)ï¼Œshapeæ˜¯ (bs, h_lvl1w_lvl1+h_lvl2w_lvl2+.., c=256)ï¼Œå…¶ä¸­h_lvliå’Œw_lvliåˆ†åˆ«ä»£è¡¨ç¬¬iå±‚ç‰¹å¾å›¾çš„é«˜å’Œå®½ï¼Œäºæ˜¯ç¬¬äºŒä¸ªç»´åº¦å°±æ˜¯æ‰€æœ‰ç‰¹å¾ç‚¹çš„æ•°é‡ã€‚ç¼–ç åï¼Œç‰¹å¾çš„æœ€åä¸€ä¸ªç»´åº¦(hidden_dim)ä¸º256ã€‚ 3). å¤„ç†Encoderçš„è¾“å‡ºï¼Œä¸ºDecoderçš„è¾“å…¥åšå‡†å¤‡ è¿™ä¸€æ­¥ä¸»è¦æ˜¯å¾—åˆ°å‚è€ƒç‚¹(reference points)ã€‚éœ€è¦è¯´æ˜ä¸‹ï¼Œåœ¨2-stageæ¨¡å¼ä¸‹ï¼Œå‚è€ƒç‚¹å’Œè¾“å…¥åˆ°Decoderçš„object queryåŠquery embeddingçš„ç”Ÿæˆæ–¹å¼å’Œå½¢å¼ä¼šæœ‰æ‰€ä¸åŒ: â€“å¦‚æœæ˜¯2-stageæ¨¡å¼ï¼Œé‚£ä¹ˆå‚è€ƒç‚¹å°±æ˜¯ç”±Encoderé¢„æµ‹çš„top-kå¾—åˆ†æœ€é«˜çš„proposal boxes(æ³¨æ„ï¼Œè¿™æ—¶å‚è€ƒç‚¹æ˜¯4dçš„ï¼Œæ˜¯bboxå½¢å¼)ã€‚ç„¶åé€šè¿‡å¯¹å‚è€ƒç‚¹è¿›è¡Œä½ç½®åµŒå…¥(position embedding)æ¥ç”ŸæˆDecoderçš„object query(target) å’Œå¯¹åº”çš„ query embeddingï¼› â€“å¦åˆ™ï¼ŒDecoderçš„ object query(target )å’Œ query embedding å°±æ˜¯é¢„è®¾çš„embeddingï¼Œç„¶åå°†query embeddingç»è¿‡å…¨è¿æ¥å±‚è¾“å‡º2då‚è€ƒç‚¹ï¼Œè¿™æ—¶çš„å‚è€ƒç‚¹æ˜¯å½’ä¸€åŒ–çš„ä¸­å¿ƒåæ ‡å½¢å¼ã€‚ å¦å¤–ï¼Œä¸¤ç§æƒ…å†µä¸‹ç”Ÿæˆçš„å‚è€ƒç‚¹æ•°é‡å¯èƒ½ä¸åŒ: 2-stageæ—¶æ˜¯æœ‰top-k(ä½œè€…è®¾ç½®ä¸º300)ä¸ªï¼Œè€Œ1-stageæ—¶æ˜¯num_queries(ä½œè€…ä¹Ÿè®¾ç½®ä¸º300)ä¸ªï¼Œä¹Ÿå°±æ˜¯å’Œobject queryçš„æ•°é‡ä¸€è‡´(å¯ä»¥ç†è§£ä¸ºï¼Œæ­¤æ—¶å‚è€ƒç‚¹å°±æ˜¯object queryæœ¬èº«çš„ä½ç½®)ã€‚ # prepare input for decoder # c = 256 ä¸­é—´é‚£ä¸€ç»´ç­‰äº(æ‰€æœ‰å±‚)ç‰¹å¾ç‚¹çš„æ•°é‡ bs, _, c = memory.shape # æ ¹æ®æ˜¯å¦2-stageåˆ†æƒ…å†µè¿›è¡Œå¤„ç†ï¼Œå› ä¸ºç”Ÿæˆçš„reference pointsä¸åŒ if self.two_stage: # ç”Ÿæˆproposalsï¼Œ å¹¶ä¸”å¯¹Encoderçš„è¾“å‡º(memory)è¿›è¡Œå¤„ç†(å…¨è¿æ¥å±‚ + å½’ä¸€åŒ–) #(bs, h_lvl1","date":"2023-10-27","objectID":"/posts/deformabledetr/:5:3","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"4.4ã€Encoder è¿™é‡Œçš„Encoderä¸Transformerä¸­æœ€ä¸»è¦çš„åŒºåˆ«åœ¨äºä½¿ç”¨å¯å˜å½¢æ³¨æ„åŠ›æ›¿ä»£äº†åŸç”Ÿçš„è‡ªæ³¨æ„åŠ›ã€‚ç±»ä¼¼åœ°ï¼Œåœ¨æ¯å±‚ç¼–ç æ—¶ä¼šå°†ä¸Šä¸€å±‚è¾“å‡ºçš„ç¼–ç ç‰¹å¾ä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ï¼Œè¿™ä¸ªè¾“å…¥ä¸position emebddingç»“åˆä½œä¸ºqueryã€è€Œç»è¿‡çº¿æ€§å˜æ¢åˆ™ä½œä¸ºvalueã€‚ def forward(self, src, spatial_shapes, level_start_index, valid_ratios, pos=None, padding_mask=None): # è¿™é‡Œçš„posæ˜¯position embedding + scale-level embedding output = src # å°†å„ç‰¹å¾ç‚¹åœ¨å…¶æ‰€åœ¨ç‰¹å¾å±‚çš„å½’ä¸€åŒ–åæ ‡æ˜ å°„åˆ°æ‰€æœ‰ç‰¹å¾å±‚ï¼Œä½¿å¾—æ¯ä¸ªç‰¹å¾ç‚¹åœ¨æ‰€æœ‰ç‰¹å¾å±‚ä¸Šéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå½’ä¸€åŒ–çš„åæ ‡ # è¿™ä¸ªreference_points ç›¸å½“äºkeyçš„è§’è‰²ï¼Œ ä»è€Œæ¯ä¸ªqueryéƒ½ä¼šå’Œå…¶åœ¨æ‰€æœ‰ç‰¹å¾å±‚çš„ä½ç½®(ä¹Ÿå°±æ˜¯ä»¥ä¸‹è®¡ç®—å‡ºæ¥çš„åæ ‡)è¿›è¡Œäº¤äº’ # å®ç°äº†è·¨å°ºåº¦èåˆçš„æ•ˆæœï¼Œå› æ­¤ä¸éœ€è¦FPN # (bs, H_lvl1 * W_lvl1 + H_lvl2 * W_lvl2 + ..., n_lvl, 2) reference_points = self.get_reference_points(spatial_shapes, valid_ratios, device=src.device) for _, layer in enumerate(self.layers): output = layer(output, pos, reference_points, spatial_shapes, level_start_index, padding_mask) return output ç°åœ¨å…·ä½“æ¥çœ‹çœ‹ä¸»è¦æœ‰å“ªäº›è¿‡ç¨‹: i). è®¡ç®—å‚è€ƒç‚¹çš„ä½ç½® è¿™é‡Œçš„å‚è€ƒç‚¹å®è´¨å°±æ˜¯å¤šå°ºåº¦ç‰¹å¾ç‚¹çš„å½’ä¸€åŒ–åæ ‡ã€‚æ³¨æ„ï¼Œæ¯ä¸ªç‰¹å¾ç‚¹åœ¨æ‰€æœ‰ç‰¹å¾å±‚éƒ½ä¼šè®¡ç®—å‡ºä¸€ä¸ªå¯¹åº”çš„å½’ä¸€åŒ–åæ ‡(åæ–‡ä¼šè°ˆåˆ°ä¸ºä½•è¿™æ ·åš)ã€‚ def get_reference_points(spatial_shapes, valid_ratios, device): reference_points_list = [] for lvl, (H_, W_) in enumerate(spatial_shapes): # (H_, W_), (H_, W_) # 0.5 æ˜¯ä¸ºå¯¹åº”åˆ°ç‰¹å¾ç‚¹ä¸­å¿ƒ ref_y, ref_x = torch.meshgrid(torch.linspace(0.5, H_ - 0.5, H_, dtype=torch.float32, device=device), torch.linspace(0.5, W_ - 0.5, W_, dtype=torch.float32, device=device)) \"\"\"å°†å„å±‚ç‰¹å¾å›¾æ¯ä¸ªç‰¹å¾ç‚¹ä¸­å¿ƒåæ ‡æ ¹æ®ç‰¹å¾å›¾épaddingçš„è¾¹é•¿è¿›è¡Œå½’ä¸€åŒ–(å¯èƒ½å¤§äº1)\"\"\" # (1, H_*W_) / (bs, 1) åä¸€é¡¹æ˜¯ç‰¹å¾å›¾æœ‰æ•ˆ(épadding)éƒ¨åˆ†çš„é«˜ ref_y = ref_y.reshape(-1)[None] / (valid_ratios[:, None, lvl, 1] * H_) # (1, H_*W_) / (bs, 1) åä¸€é¡¹æ˜¯ç‰¹å¾å›¾æœ‰æ•ˆ(épadding)éƒ¨åˆ†çš„å®½ ref_x = ref_x.reshape(-1)[None] / (valid_ratios[:, None, lvl, 0] * W_) # (bs, H_*W_, 2) æ¯ä¸€é¡¹æ˜¯xy ref = torch.stack((ref_x, ref_y), -1) reference_points_list.append(ref) # (bs, H_lvl1 * W_lvl1 + H_lvl2 * W_lvl2 + ..., 2) reference_points = torch.cat(reference_points_list, 1) \"\"\"å°†å„ç‰¹å¾ç‚¹åœ¨å…¶æ‰€åœ¨ç‰¹å¾å±‚çš„å½’ä¸€åŒ–åæ ‡æ˜ å°„(æ‰©æ•£)åˆ°æ‰€æœ‰ç‰¹å¾å±‚ï¼Œ è¿™æ ·æ¯ä¸ªç‰¹å¾ç‚¹åœ¨æ‰€æœ‰ç‰¹å¾å±‚ä¸Šéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå½’ä¸€åŒ–åæ ‡\"\"\" # TODO: ä»¥ä¸‹è¿™æ ·è²Œä¼¼ä¸å¦¥ï¼Œ å¦‚æœå„ç‰¹å¾å±‚å¯¹åº”çš„valid_ratioä¸ä¸€è‡´ï¼Œ # TODO: åˆ™åæ ‡å€¼æœ‰å¯èƒ½å¤§äº1ï¼Œ è€Œåç»­æ²¡æœ‰å†å¯¹è¿™é‡Œçš„reference_pointsè¿›è¡Œå½’ä¸€åŒ–åˆ° 0~1 # (bs, H_lvl1 * W_lvl1 + H_lvl2 * W_lvl2 + ..., 1, 2) * (bs, 1, n_lvl, 2) reference_points = reference_points[:, :, None] * valid_ratios[:, None] # (bs, H_lvl1 * W_lvl1 + H_lvl2 * W_lvl2 + ..., n_lvl, 2) return reference_points é€šè¿‡æºç å‘ç°æœ‰ä¸ªå°é—®é¢˜: è¿™é‡Œåœ¨å¯¹åæ ‡å½’ä¸€åŒ–æ—¶ä½¿ç”¨çš„æ˜¯épaddingéƒ¨åˆ†çš„ç‰¹å¾å›¾è¾¹é•¿ï¼Œè€Œä¸åŒå±‚épaddingéƒ¨åˆ†çš„è¾¹é•¿æ¯”ä¾‹æœ‰å¯èƒ½ç”±äºè®¡ç®—æ—¶çš„èˆå…¥è¯¯å·®è€Œä¸ä¸€è‡´ï¼Œä»è€Œå¯¼è‡´æœ€ç»ˆå½’ä¸€åŒ–åçš„åæ ‡å€¼å¤§äº1ã€‚ ii). self-attention ä½¿ç”¨(å¤šå°ºåº¦)å¯å˜å½¢æ³¨æ„åŠ›æ¨¡å—æ›¿ä»£åŸç”Ÿçš„Transformerè‡ªæ³¨æ„åŠ›ï¼Œqueryå’Œvalueå‡æ¥è‡ªç‰¹å¾å›¾ï¼Œåªä¸è¿‡queryè¦ç»“åˆposition embeddingï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„position embeddingå®è´¨æ˜¯position emebedding + scale-level emebeddingã€‚ iii). feed-forward network å‰å‘åé¦ˆç½‘ç»œï¼Œå’ŒTransformerä¸­çš„ä¸€è‡´: ç”±å…¨è¿æ¥å±‚ã€æ¿€æ´»å‡½æ•°ã€Dropoutã€æ®‹å·®è¿æ¥ä»¥åŠå±‚å½’ä¸€åŒ–(LayerNorm)ç»„æˆã€‚ def forward(self, src, pos, reference_points, spatial_shapes, level_start_index, padding_mask=None): \"\"\"Deformable DETRçš„Encoderä¹Ÿæ˜¯ç”±self-attention + FNNç»„æˆ åªä¸è¿‡è¿™é‡Œself-attentionä½¿ç”¨Multi-Scale Deformable Attentionï¼Œ å¹¶ä¸”ä½ç½®ç¼–ç åŠ å…¥äº†scale-level embedding \"\"\" # self attention # è¿™é‡Œçš„posæ˜¯position embedding + scale-level embedding # padding_mask å°±æ˜¯æŒ‡ç¤ºå„ç‰¹å¾å›¾å“ªäº›ä½ç½®æ˜¯åŸå›¾paddingçš„ # reference_points å°±æ˜¯æ¯ä¸ªç‰¹å¾ç‚¹æœ¬èº«ä¸­å¿ƒçš„ä½ç½®(å½’ä¸€åŒ–åæ ‡): (bs, H_lvl1 * W_lvl1 + H_lvl2 * W_lvl2 + ..., n_lvl, 2) # æ³¨æ„ä¸€ä¸ªç‰¹å¾ç‚¹ä¸ä»…åœ¨å…¶æ‰€æœ‰ç‰¹å¾å±‚æœ‰ä¸ªåæ ‡ï¼Œ è€Œä¸”è¿˜åœ¨å…¶ä»–ç‰¹å¾å±‚ä¹Ÿéƒ½åˆ†åˆ«æ˜ å°„äº†ä¸€ä¸ªåæ ‡ # self attention src2 = self.self_attn(self.with_pos_embed(src, pos), reference_points, src, spatial_shapes, level_start_index, padding_mask) src = src + self.dropout1(src2) src = self.norm1(src) # ffn src = self.forward_ffn(src) return src DECODERè¯¦ç»†ä»£ç æ³¨é‡Šå¦‚ä¸‹ï¼Œiterative bounding box refinementå’Œtwo stageæ”¹è¿›æ–¹æ³•çš„Encoderä¸å˜ã€‚ class DeformableTransformerEncoderLayer(nn.Module): def __init__(self, d_model=256, d_ffn=1024, dropout=0.1, activation=\"relu\", n_levels=4, n_heads=8, n_points=4): super().__init__() # self attention self.self_attn = MSDeformAttn(d_model, n_levels, n_heads, n_points) self.dropout1 = nn.Dropout(dropout) self.norm1 = nn.LayerNorm(d_model) # ffn self.linear1 = nn.Linear(d_model, d_ffn) self.activation = _get_activation_fn(activation) self.dropout2 = nn.Dropout(dropout) self.linear2 = nn.Linear(d_ffn, d_model) self.dropout3 = nn.Dropout(dropout) self.norm2 = nn.LayerNorm(d_model) @staticmethod def with_pos_embed(tensor, pos): return tensor if pos is None else tensor + pos def forward_ffn(self, src): src2 = self.linear2(self.","date":"2023-10-27","objectID":"/posts/deformabledetr/:5:4","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"4.4ã€Decoder è¿™é‡Œä¸Transformerä¸­ä¸»è¦çš„åŒºåˆ«åœ¨äºä½¿ç”¨å¯å˜å½¢æ³¨æ„åŠ›æ›¿ä»£äº†åŸç”Ÿçš„äº¤å‰æ³¨æ„åŠ›ã€‚ç±»ä¼¼åœ°ï¼Œæ¯å±‚çš„è§£ç è¿‡ç¨‹æ˜¯self-attention+cross-attention+ffnï¼Œä¸‹ä¸€å±‚è¾“å…¥çš„object queryæ˜¯ä¸Šä¸€å±‚è¾“å‡ºçš„è§£ç ç‰¹å¾ã€‚ # æ¯ä¸€å±‚è¾“å…¥çš„outputæ˜¯ä¸Šä¸€å±‚è¾“å‡ºçš„ç»“æœï¼Œè€Œreference_points_inputåœ¨ä½¿ç”¨iterative bbox refineç­–ç•¥æ—¶ï¼Œ # æ¯å±‚éƒ½ä¼šå¯¹é½è¿›è¡Œæ ¡æ­£ï¼Œ å› æ­¤ä¸‹ä¸€å±‚ç”¨åˆ°çš„ä¹Ÿæ˜¯ä¸Šä¸€å±‚çš„è¾“å‡ºç»“æœ # (bsï¼Œ n_query=300ï¼Œhidden_dim=256) output = layer(output, query_pos, reference_points_input, src, src_spatial_shapes, src_level_start_index, src_padding_mask) ä¸€èµ·å…·ä½“æ¥çœ‹çœ‹æ¯å±‚çš„ä¸»è¦è¿‡ç¨‹: i). å°†å‚è€ƒç‚¹åæ ‡æ˜ å°„(re-scales)åˆ°å„å°ºåº¦ç‰¹å¾å±‚ å°†æ¯ä¸ªå‚è€ƒç‚¹çš„åæ ‡åˆ†åˆ«éƒ½ä¹˜ä»¥å„ç‰¹å¾å±‚épaddingéƒ¨åˆ†è¾¹é•¿çš„æ¯”ä¾‹ï¼Œä½¿å¾—ä¸€ä¸ªå‚è€ƒç‚¹åœ¨æ‰€æœ‰å°ºåº¦ç‰¹å¾å±‚ä¸Šéƒ½æœ‰ç›¸åº”çš„å½’ä¸€åŒ–åæ ‡å€¼(åæ–‡ä¼šè°ˆåˆ°ä¸ºä½•è¿™æ ·åš)ã€‚ def forward(self, tgt, reference_points, src, src_spatial_shapes, src_level_start_index, src_valid_ratios, query_pos=None, src_padding_mask=None): # è¯´æ˜ä¸€ä¸‹Decoderä¸€å¼€å§‹å¾—åˆ°çš„tgt, query_poså’Œreference_points, åˆ†ä¸ºä¸¤ç§æƒ…å†µ: # 1. 2-stage æ¨¡å¼ä¸‹ï¼Œreference_points æ˜¯Encoderè¾“å‡ºçš„top-k proposal boxes(å¹¶å½’ä¸€åŒ–)ï¼Œæœ€åä¸€ç»´ä¸º4 # è€Œtgtå’Œquery_posç”±å…¶ç»è¿‡position embeddingå¾—åˆ°ï¼› # 2. 1-stage æ¨¡å¼ä¸‹ï¼Œ tgtå’Œquery_posæ˜¯é¢„è®¾çš„embeddingï¼Œ reference_pointsé€šè¿‡è¿™ä¸ªquery_posç»å…¨è¿æ¥å±‚å¾—åˆ°ï¼Œ # æœ€åä¸€ç»´ä¸º2 # å¦å¤–ï¼Œsrcæ˜¯Encoderæœ€ç»ˆç¼–ç è¾“å‡ºçš„ç‰¹å¾å›¾ï¼Œå³ memory output = tgt # ä¸­é—´å„å±‚(åŒ…æ‹¬å¤´å°¾)çš„è§£ç è¾“å‡º intermediate = [] # ä¸­é—´å„å±‚(åŒ…æ‹¬å¤´å°¾)æ ¡æ­£çš„å‚è€ƒç‚¹ intermediate_reference_points = [] for lid, layer in enumerate(self.layers): # 2-stage æ¨¡å¼ä¸‹ï¼Œ å‚è€ƒç‚¹æ˜¯proposal boxesï¼Œ å› æ­¤æœ€åä¸€ç»´æ˜¯4 if reference_points.shape[-1] == 4: # (bs, k = 300, n_lvl, 4) # (bs, k = 300, 1, 4) * (bs, 1, n_lvl, 4) reference_points_input = reference_points[:, :, None] \\ * torch.cat([src_valid_ratios, src_valid_ratios], -1)[:, None] else: # 1-stage æ¨¡å¼ä¸‹ å‚è€ƒç‚¹å°±æ˜¯é€šè¿‡query embedding å˜æ¢è€Œæ¥çš„ä¸­å¿ƒåæ ‡å½¢å¼ï¼Œå› æ­¤æœ€åä¸€ç»´æ˜¯2 assert reference_points.shape[-1] == 2 # (bs, k=300, n_lvl, 2) # (bs, k=300, 1, 2) * (bs, 1, n_lvl, 2) reference_points_input = reference_points[:, :, None] * src_valid_ratios[:, None] output = layer(output, query_pos, reference_points_input, src, src_spatial_shapes, src_level_start_index, src_padding_mask) # hack implementation for iterative bounding box refinement if self.bbox_embed is not None: tmp = self.bbox_embed[lid](output) if reference_points.shape[-1] == 4: new_reference_points = tmp + inverse_sigmoid(reference_points) new_reference_points = new_reference_points.sigmoid() else: assert reference_points.shape[-1] == 2 new_reference_points = tmp new_reference_points[..., :2] = tmp[..., :2] + inverse_sigmoid(reference_points) new_reference_points = new_reference_points.sigmoid() reference_points = new_reference_points.detach() if self.return_intermediate: intermediate.append(output) intermediate_reference_points.append(reference_points) if self.return_intermediate: return torch.stack(intermediate), torch.stack(intermediate_reference_points) return output, reference_points ii). self-attention è¿™ä¸€æ­¥æ˜¯ä¸ºäº†å­¦ä¹ å„ä¸ªç›®æ ‡ä¹‹é—´çš„å…³ç³»ï¼Œqueryå’Œkeyéƒ½æ˜¯object query+query embeddingï¼Œvalueå°±æ˜¯object query(æ³¨æ„ä¸éœ€è¦ä½ç½®åµŒå…¥å“¦)ã€‚ def forward(self, tgt, query_pos, reference_points, src, src_spatial_shapes, level_start_index, src_padding_mask=None): # è‹¥æ˜¯2-stageï¼Œ åˆ™tgt å’Œ query_posæ¥è‡ªEncoderè¾“å‡ºçš„top-k proposal boxes(ç»è¿‡ä½ç½®åµŒå…¥) # è€Œreference_points å°±æ˜¯è¿™ä¸ªtop-k proposal boxes(å½’ä¸€åŒ–) # å¦åˆ™ï¼Œ tgtå’Œquery_posç”±é¢„è®¾çš„embeddingäº§ç”Ÿï¼Œ è€Œreference_pointsç”±query_posç»è¿‡å…¨è¿æ¥å±‚ç”Ÿæˆ # self attention # (bs, k = 300, d_model=256) q = k = self.with_pos_embed(tgt, query_pos) # (bs, k = 300, d_model=256) æ³¨æ„: valueå°±æ˜¯targetæœ¬èº«ä¸éœ€è¦ï¼Œ ä¸éœ€è¦ä½ç½®ç¼–ç  tgt2 = self.self_attn(q.transpose(0, 1), k.transpose(0, 1), tgt.transpose(0, 1))[0].transpose(0, 1) tgt = tgt + self.dropout2(tgt2) tgt = self.norm2(tgt) iii). cross-attention ä½¿ç”¨(å¤šå°ºåº¦)å¯å˜å½¢æ³¨æ„åŠ›æ¨¡å—æ›¿ä»£åŸç”Ÿçš„Transformeräº¤å‰æ³¨æ„åŠ›ï¼Œobject queryæ¥è‡ªself-attentionå±‚çš„è¾“å‡ºï¼ŒåŒæ—¶ä¹Ÿè¦åŠ ä¸Šquery embeddingï¼›valueç”±Encoderç¼–ç çš„ç‰¹å¾ç»è¿‡çº¿æ€§å˜æ¢å¾—åˆ°ã€‚ # ä¸Šç»­ decoderçš„ decoder layer forward # cross attention # srcæ˜¯Encoderè¾“å‡ºçš„memoryï¼Œ å³ç¼–ç åçš„ç‰¹å¾(bs, n_feat_points, d_model=256), å…¶ä¼šç»è¿‡çº¿æ€§å˜æ¢å¾—åˆ°value, # è¿™é‡Œçš„tgtæ¥è‡ªself-attentionçš„è¾“å‡ºï¼Œè€Œquery_posä¾æ—§å¦‚åˆšä¼ è¿›æ¥Decoderæ—¶ä¸€æ ·ï¼Œä¸å˜ # reference_points: (bs, k=300, n_feat_lvl, 4 or 2) åœ¨cross-attentionä¸­ä»£è¡¨keyçš„ä½ç½®ä¿¡æ¯ tgt2 = self.cross_attn(self.with_pos_embed(tgt, query_pos), reference_points, src, src_spatial_shapes, level_start_index, src_padding_mask) tgt = tgt + self.dropout1(tgt2) tgt = self.norm1(tgt) iv). feed-forward network è¾“å…¥æ¥è‡ªcross-attentionçš„è¾“å‡ºï¼Œè¯¦ç»†è¿‡ç¨‹å°±ä¸å†é˜è¿°äº†ï¼Œéƒ½æ˜¯è€æœ‹å‹äº†~ # ffn tgt = self.forward_ffn(tgt) return tg","date":"2023-10-27","objectID":"/posts/deformabledetr/:5:5","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"4.5ã€Deformable Transformer ç»¼åˆæ¨¡å—ä»£ç å¦‚ä¸‹ class DeformableTransformer(nn.Module): def __init__(self, d_model=256, nhead=8, num_encoder_layers=6, num_decoder_layers=6, dim_feedforward=1024, dropout=0.1, activation=\"relu\", return_intermediate_dec=False, num_feature_levels=4, dec_n_points=4, enc_n_points=4, two_stage=False, two_stage_num_proposals=300): super().__init__() self.d_model = d_model self.nhead = nhead self.two_stage = two_stage self.two_stage_num_proposals = two_stage_num_proposals encoder_layer = DeformableTransformerEncoderLayer(d_model, dim_feedforward, dropout, activation, num_feature_levels, nhead, enc_n_points) self.encoder = DeformableTransformerEncoder(encoder_layer, num_encoder_layers) decoder_layer = DeformableTransformerDecoderLayer(d_model, dim_feedforward, dropout, activation, num_feature_levels, nhead, dec_n_points) self.decoder = DeformableTransformerDecoder(decoder_layer, num_decoder_layers, return_intermediate_dec) self.level_embed = nn.Parameter(torch.Tensor(num_feature_levels, d_model)) if two_stage: self.enc_output = nn.Linear(d_model, d_model) self.enc_output_norm = nn.LayerNorm(d_model) self.pos_trans = nn.Linear(d_model * 2, d_model * 2) self.pos_trans_norm = nn.LayerNorm(d_model * 2) else: self.reference_points = nn.Linear(d_model, 2) self._reset_parameters() def _reset_parameters(self): for p in self.parameters(): if p.dim() \u003e 1: nn.init.xavier_uniform_(p) for m in self.modules(): if isinstance(m, MSDeformAttn): m._reset_parameters() if not self.two_stage: xavier_uniform_(self.reference_points.weight.data, gain=1.0) constant_(self.reference_points.bias.data, 0.) normal_(self.level_embed) def get_proposal_pos_embed(self, proposals): num_pos_feats = 128 temperature = 10000 scale = 2 * math.pi dim_t = torch.arange(num_pos_feats, dtype=torch.float32, device=proposals.device) dim_t = temperature ** (2 * (dim_t // 2) / num_pos_feats) # N, L, 4 proposals = proposals.sigmoid() * scale # N, L, 4, 128 pos = proposals[:, :, :, None] / dim_t # N, L, 4, 64, 2 pos = torch.stack((pos[:, :, :, 0::2].sin(), pos[:, :, :, 1::2].cos()), dim=4).flatten(2) return pos def gen_encoder_output_proposals(self, memory, memory_padding_mask, spatial_shapes): N_, S_, C_ = memory.shape base_scale = 4.0 proposals = [] _cur = 0 for lvl, (H_, W_) in enumerate(spatial_shapes): mask_flatten_ = memory_padding_mask[:, _cur:(_cur + H_ * W_)].view(N_, H_, W_, 1) valid_H = torch.sum(~mask_flatten_[:, :, 0, 0], 1) valid_W = torch.sum(~mask_flatten_[:, 0, :, 0], 1) grid_y, grid_x = torch.meshgrid(torch.linspace(0, H_ - 1, H_, dtype=torch.float32, device=memory.device), torch.linspace(0, W_ - 1, W_, dtype=torch.float32, device=memory.device)) grid = torch.cat([grid_x.unsqueeze(-1), grid_y.unsqueeze(-1)], -1) scale = torch.cat([valid_W.unsqueeze(-1), valid_H.unsqueeze(-1)], 1).view(N_, 1, 1, 2) grid = (grid.unsqueeze(0).expand(N_, -1, -1, -1) + 0.5) / scale wh = torch.ones_like(grid) * 0.05 * (2.0 ** lvl) proposal = torch.cat((grid, wh), -1).view(N_, -1, 4) proposals.append(proposal) _cur += (H_ * W_) output_proposals = torch.cat(proposals, 1) output_proposals_valid = ((output_proposals \u003e 0.01) \u0026 (output_proposals \u003c 0.99)).all(-1, keepdim=True) output_proposals = torch.log(output_proposals / (1 - output_proposals)) output_proposals = output_proposals.masked_fill(memory_padding_mask.unsqueeze(-1), float('inf')) output_proposals = output_proposals.masked_fill(~output_proposals_valid, float('inf')) output_memory = memory output_memory = output_memory.masked_fill(memory_padding_mask.unsqueeze(-1), float(0)) output_memory = output_memory.masked_fill(~output_proposals_valid, float(0)) output_memory = self.enc_output_norm(self.enc_output(output_memory)) return output_memory, output_proposals def get_valid_ratio(self, mask): _, H, W = mask.shape valid_H = torch.sum(~mask[:, :, 0], 1) valid_W = torch.sum(~mask[:, 0, :], 1) valid_ratio_h = valid_H.float() / H valid_ratio_w = valid_W.float() / W valid_ratio = torch.stack([valid_ratio_w, valid_ratio_h], -1","date":"2023-10-27","objectID":"/posts/deformabledetr/:5:6","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"5ã€Experiment ç”±å›¾4å¯çŸ¥ï¼ŒDeformable DETRä¸ä»…æ”¶æ•›é€Ÿç‡æ¯”DETRå¿«å¹¶ä¸”å°ç›®æ ‡ç²¾åº¦ä¹Ÿé«˜äº†è®¸å¤šã€‚ ","date":"2023-10-27","objectID":"/posts/deformabledetr/:6:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"6ã€æ”¹è¿›ç­–ç•¥ Deformable DETRæ˜¯æ€ä¹ˆè®©DCNå’ŒTransformerä¸€èµ·ç©çš„ï¼ŒCWåœ¨ä¸Šè¿°å·²åŸºæœ¬è§£æå®Œæ¯•ã€‚æ— å¥ˆä½œè€…è¿˜ç ”ç©¶äº†â€œé«˜é…ç‰ˆâ€çš„Deformable DETRï¼Œæ¶‰åŠä¸¤ä¸ªæå‡æ€§èƒ½çš„ç­–ç•¥: iterative bounding box refinement \u0026 two-stageã€‚ a. Iterative Bounding Box Refinement å­—é¢æ„æ€å°±æ˜¯è¿­ä»£åœ°å¯¹bboxè¿›è¡Œæ ¡æ­£ï¼Œç±»ä¼¼äºcascaded headï¼Œå®è´¨ä¸Šä¹Ÿæ˜¯coarse-to-fineä¸æ–­æ ¡æ­£çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚ç¬¬då±‚Decoderæ ¡æ­£åå½’ä¸€åŒ–çš„bboxç”¨å…¬å¼è¡¨ç¤ºå¦‚ä¸‹: $$\\hat{b}q^d={\\sigma(\\Delta b{qx}^d+\\sigma^{-1}(\\hat{b}{qx}^{d-1})),\\sigma(\\Delta b{qy}^d+\\sigma^{-1}(\\hat{b}{qy}^{d-1})),\\sigma(\\Delta b{qw}^d+\\sigma^{-1}(\\hat{b}{qw}^{d-1})),\\sigma(\\Delta b{qh}^d+\\sigma^{-1}(\\hat{b}_{qh}^{d-1}))}$$ å…¶ä¸­ $\\Delta b_{q{x,y,w,h}}^d$ æ˜¯ç¬¬då±‚Decoderåˆ©ç”¨æ£€æµ‹å¤´éƒ¨çš„å›å½’åˆ†æ”¯é¢„æµ‹çš„ç»“æœ(åç§»é‡)ï¼Œ$\\sigma$ï¼Œ$\\sigma^{-1}$åˆ†åˆ«ä»£è¡¨sigmoidå’Œåsigmoidå‡½æ•°ã€‚ åœ¨è¿™é‡Œéœ€è¦æ³¨æ„ä¸¤ç‚¹: å„å±‚çš„æ£€æµ‹å¤´éƒ¨æ˜¯ä¸å…±äº«å‚æ•°çš„ï¼› æ ¡æ­£åçš„bboxæ¢¯åº¦ä¼šè¢«é˜»æ–­(detach)ï¼Œä¸ä¼šè·¨å±‚ä¼ æ’­ å…·ä½“å®ç°å’Œè§£æåœ¨ä¸Šä¸€èŠ‚è®²Decoderçš„æ—¶å€™å·²è¯¦ç»†è¯´æ˜ã€‚ Two-Stage Deformable DETR 2-stageæ¨¡å¼ä¸‹ï¼ŒEncoderä¼šè¾“å‡ºä¸€æ‰¹proposals(å¹¶ä¸æ˜¯åŸºäºç½‘ç»œé¢„æµ‹ï¼Œè€Œæ˜¯åƒanchorä¸€æ ·è®¡ç®—å‡ºæ¥çš„)ï¼Œboxesä¸­å¿ƒå°±æ˜¯å„ç‰¹å¾ç‚¹çš„ä¸­å¿ƒï¼Œè€Œå®½ã€é«˜çš„è®¾ç½®åˆ™ä¸æ‰€åœ¨çš„ç‰¹å¾å±‚ç›¸å…³ï¼Œbaseå€¼è®¾ç½®ä¸º0.05ã€‚è¿™æ—¶çš„proposalsç›¸å¯¹äºanchorsçš„è§’è‰²ã€‚ ç„¶åï¼Œä½¿ç”¨æ£€æµ‹å¤´éƒ¨çš„åˆ†ç±»åˆ†æ”¯å¯¹Encoderç¼–ç çš„ç‰¹å¾(memory)è¿›è¡Œé¢„æµ‹ï¼Œå¯¹åº”å„ä¸ªproposalsçš„åˆ†ç±»ç»“æœï¼›åŒæ—¶ä½¿ç”¨å›å½’åˆ†æ”¯ä¹Ÿå¯¹ç¼–ç ç‰¹å¾ä¹Ÿè¿›è¡Œé¢„æµ‹ï¼Œå¾—åˆ°ç›¸å¯¹äºproposals(xywh)çš„åç§»é‡ï¼Œæ¥ç€å°†åç§»é‡åŠ åœ¨proposalsçš„ä¸­å¿ƒåæ ‡å’Œå®½ã€é«˜ä¸Šå¾—åˆ°ç¬¬ä¸€é˜¶æ®µé¢„æµ‹çš„proposalsã€‚ æœ€åï¼Œå–top-kåˆ†æ•°æœ€é«˜çš„é‚£æ‰¹é¢„æµ‹proposalsä½œä¸ºDecoderçš„å‚è€ƒç‚¹ã€‚å¹¶ä¸”ï¼ŒDecoderçš„object queryå’Œquery embeddingéƒ½ç”±å‚è€ƒç‚¹é€šè¿‡ä½ç½®åµŒå…¥(position embedding)æ¥ç”Ÿæˆã€‚ ","date":"2023-10-27","objectID":"/posts/deformabledetr/:7:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"7ã€Conclusion Deformable DETRæ•ˆç‡é«˜å¹¶ä¸”æ”¶æ•›å¿«ï¼Œæ ¸å¿ƒæ˜¯Multi-Scale Deformable Attention Moduleã€‚è§£å†³äº†DETRä¸­æ”¶æ•›æ…¢ä»¥åŠå°ç›®æ ‡æ€§èƒ½ä½çš„é—®é¢˜ã€‚ ","date":"2023-10-27","objectID":"/posts/deformabledetr/:8:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"8ã€Q\u0026A å¦‚æœè®¤çœŸæ€è€ƒï¼Œä¼šå‘ç°Deformable DETRä¸­æœ‰è®¸å¤šå€¼å¾—è€ƒé‡çš„åœ°æ–¹ã€‚ 1. ä¸ºä½•ä¸éœ€è¦FPNä¹Ÿèƒ½è¾¾åˆ°è·¨å±‚èåˆçš„æ•ˆæœï¼Ÿ ä½œè€…åœ¨paperä¸­è¯´åˆ°ï¼Œå¤šå°ºåº¦å¯å˜å½¢æ³¨æ„åŠ›å¯ä»¥åœ¨ä¸åŒå°ºåº¦çš„ç‰¹å¾ä¹‹é—´äº¤æ¢ä¿¡æ¯ï¼Œå› æ­¤ä¸éœ€è¦FPN: Note that the top-down structure in FPN (Lin et al., 2017a) is not used, because our proposed multi-scale deformable attention in itself can exchange information among multi-scale feature maps. é‚£ä¹ˆåˆ°åº•æ˜¯ä¸ºä½•ï¼Ÿå…·ä½“æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿ å…¶å®å‰æ–‡ä¹Ÿæåˆ°äº†ï¼Œæ¯ä¸ªå‚è€ƒç‚¹åœ¨å„å°ºåº¦ç‰¹å¾å±‚éƒ½ä¼šè¿›è¡Œé‡‡æ ·ã€‚è€Œä¸”åœ¨ä¸Šè¿°å¤„ç†å‚è€ƒç‚¹åæ ‡çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºåœ¨Encoderè¿˜æ˜¯Decoderï¼Œéƒ½ä¼šå¯¹å‚è€ƒç‚¹è¿›è¡Œå¤„ç†ï¼Œä½¿å¾—ä¸€ä¸ªå‚è€ƒç‚¹åœ¨æ‰€æœ‰å°ºåº¦ç‰¹å¾å±‚ä¸Šéƒ½æœ‰ç›¸åº”çš„å½’ä¸€åŒ–åæ ‡å€¼ã€‚ä¸ºä»€ä¹ˆè¿™æ ·åšå‘¢ï¼Ÿè¿™æ ·åšå…¶å®å°±æ˜¯ä¸ºäº†è®¡ç®—å‡ºæ¯ä¸ªå‚è€ƒç‚¹åœ¨å„å°ºåº¦ç‰¹å¾å±‚å¯¹åº”çš„é‡‡æ ·ç‚¹ä½ç½®ã€‚ é‚£ä¹ˆä½ å¯èƒ½åˆä¼šå¥‡æ€ªäº†ï¼Œä¸€ä¸ªå‚è€ƒç‚¹æ˜æ˜æ˜¯åªå¤„äºæŸä¸ªç‰¹å®šçš„ç‰¹å¾å±‚ï¼Œæ€ä¹ˆèƒ½å¤ŸæŠŠå®ƒæ”¾åˆ°å¦ä¸€ä¸ªç‰¹å¾å±‚å»å‘¢ï¼Ÿè¿™æ ·åˆç†å—ï¼Ÿ åˆç†ä¸åˆç†ç”±ç½‘ç»œå»è¿›è¡Œå­¦ä¹ ï¼ŒåŸºäºæœ€ç»ˆçš„åŒ¹é…æ•ˆæœæ¥è¯æ˜ã€‚ä½†æ˜¯å¯ä¸å¯è¡Œæˆ‘ä»¬å€’æ˜¯å¯åˆ†æçš„ï¼Œå¯ä»¥è¿™ä¹ˆçœ‹: æˆ‘ä»¬çŸ¥é“ï¼Œç”±äºç‰¹å¾å›¾æ˜¯ç»è¿‡åŸå›¾ä¸‹é‡‡æ ·å¾—åˆ°ï¼Œå› æ­¤ä¸€ä¸ªåƒç´ ç‚¹æ— è®ºæ˜¯å¤„äºåŸå›¾è¿˜æ˜¯å„å±‚ç‰¹å¾å›¾ä¸­ï¼Œå…¶åæ ‡çš„å½’ä¸€åŒ–å€¼åº”è¯¥æ˜¯ä¸€è‡´çš„(å¿½ç•¥ç»†å¾®çš„è®¡ç®—è¯¯å·®)ã€‚é‚£ä¹ˆï¼Œæ—¢ç„¶è¿™é‡Œå‚è€ƒç‚¹åæ ‡æ˜¯å½’ä¸€åŒ–çš„ï¼Œå®ƒå°±èƒ½å¤Ÿæ˜ å°„(re-scales)åˆ°å„å°ºåº¦ç‰¹å¾ä¸­å»ï¼Œè¿™éƒ¨åˆ†å¯¹åº”ä»¥ä¸‹å…¬å¼ä¸­çš„ $\\phi_l$ å‡½æ•°: $$\\text{MSDeformAttn}(z_{q},\\hat{p}{q},{x^{l}}{l=1}^{L})=\\sum_{m=1}^{M}W_{m}\\bigl[\\sum_{l=1}^{L}\\sum_{k=1}^{K}A_{mlqk}\\cdot W_{m}^{\\prime}x^{l}\\bigl[\\phi_{l}(\\hat{p}{q})\\bigr]+\\Delta p{mlqk}\\bigr)\\bigr],$$ ä½œè€…åœ¨paperä¸­æ˜¯è¿™ä¹ˆæè¿°çš„: Function $\\phi_l$ re-scales the normalized coordinates $\\hat{p}_{q}$ to the input feature map of the l-th level. 2. ä¸ºä½•æ³¨æ„åŠ›æƒé‡å¯ç”±queryç›´æ¥é€šè¿‡å…¨è¿æ¥å±‚é¢„æµ‹å¾—åˆ°ï¼Ÿ æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨Transformerä¸­ï¼Œæ³¨æ„åŠ›æƒé‡æ˜¯ç”±queryå’Œkeyäº¤äº’è®¡ç®—å¾—åˆ°çš„ã€‚ç„¶è€Œï¼Œåœ¨è¿™é‡Œå´åƒå¼€æŒ‚èˆ¬ç›´æ¥é€šè¿‡queryç»å…¨è¿æ¥å±‚è¾“å‡ºå¾—åˆ°(å¥½å®¶ä¼™~ï¼)ï¼Œè¿™èŠ‚å¥æ˜¯ä¸æ˜¯ä¸å¯¹åŠ²å‘¢ï¼Ÿè¦åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œä¸å¦¨å…ˆæ¥çœ‹çœ‹Deformable DETRä¸­å‚è€ƒç‚¹(reference points)å’Œqueryä¹‹é—´çš„å…³ç³»ã€‚ åœ¨Encoderä¸­: å‚è€ƒç‚¹æ˜¯ç‰¹å¾ç‚¹æœ¬èº«çš„ä½ç½®ï¼Œquery embeddingæ˜¯ç‰¹å¾å›¾å¯¹åº”çš„position emebdding(å…¶å®è¿˜åŠ ä¸Šäº†scale-level embedding)ï¼Œobject queryåˆ™æ¥è‡ªäºç‰¹å¾å›¾ï¼Œæœ€ç»ˆæ³¨æ„åŠ›æœºåˆ¶ä¸­çš„queryå°±æ˜¯object query + query embeddingã€‚ åœ¨Decoderä¸­: 2-stageæ—¶ï¼Œç”±å‚è€ƒç‚¹ç»è¿‡ä½ç½®åµŒå…¥ç”Ÿæˆquery embeddingå’Œobject queryï¼›è€Œ1-stageæ—¶ï¼Œobject queryå’Œquery embeddingéƒ½æ˜¯é¢„è®¾çš„embeddingï¼Œå‚è€ƒç‚¹åˆ™ç”±query embeddingç»å…¨è¿æ¥å±‚ç”Ÿæˆï¼Œæœ€ç»ˆæ³¨æ„åŠ›æœºåˆ¶ä¸­çš„queryä¹Ÿæ˜¯object query + query embeddingã€‚ ç»¼ä¸Šå¯çŸ¥ï¼Œå‚è€ƒç‚¹(reference points)å’Œqueryä¹‹é—´æ˜¯å­˜åœ¨ç€å¯¹åº”å…³ç³»çš„(å°±æœ‰ç‚¹â€œä½ ç”Ÿæˆ‘ã€æˆ‘ç”Ÿä½ â€çš„feel~)ã€‚ OKï¼Œæ—¢ç„¶è¿™æ ·ï¼Œé‚£ä¹ˆåŸºäºå‚è€ƒç‚¹ä½ç½®é‡‡æ ·æ’å€¼å‡ºæ¥çš„ç‰¹å¾(value)è‡ªç„¶å°±èƒ½å¤Ÿå’Œé€šè¿‡queryç»è¿‡çº¿æ€§å˜æ¢å¾—åˆ°çš„æ³¨æ„åŠ›æƒé‡å¯¹åº”èµ·æ¥äº†ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¯å˜å½¢æ³¨æ„åŠ›æ¨¡å—ä¸­ä¸éœ€è¦keyä¸queryæ¥äº¤äº’è®¡ç®—æ³¨æ„åŠ›æƒé‡äº†ã€‚ æ‰“ä¸ªæ¯”æ–¹: Aä¸Bå·²å»ºç«‹èµ·äº†å¯¹åº”å…³ç³»ï¼Œä¹‹åAå†é€šè¿‡æŸç§æ˜ å°„å…³ç³»å¾—åˆ°Cï¼ŒBä¹Ÿé€šè¿‡æŸç§æ˜ å°„å…³ç³»å¾—åˆ°Dï¼Œé‚£ä¹ˆCä¸Dä¹‹é—´å¿…ç„¶ä¼šæœ‰æŸç§ç¨‹åº¦çš„è€¦åˆä¸å¯¹åº”å…³ç³»ã€‚è¿™é‡ŒAã€Bã€Cã€Då°±åˆ†åˆ«æŒ‡ä»£queryã€reference pointsã€attention weightsä»¥åŠvalueã€‚ è¿˜æœ‰ä¸ªé—®é¢˜å€¼å¾—æ€è€ƒï¼Œä¸ºä½•åœ¨Decoderä¸­ï¼Œ2-stageæ—¶ç”±reference pointsç”Ÿæˆquery embeddingæ˜¯é€šè¿‡position embeddingï¼Œè€Œ1-stageæ—¶ç”±query embeddingç”Ÿæˆreference pointsæ—¶å´ç”¨å…¨è¿æ¥å±‚å‘¢ï¼Ÿ å¯¹æ­¤ï¼ŒCWæ˜¯è¿™ä¹ˆæƒ³çš„: 2-stageæ—¶ï¼Œå‚è€ƒç‚¹æ˜¯ç”±Encoderé¢„æµ‹å‡ºæ¥çš„proposalsï¼Œæœ¬èº«ä¸€å®šç¨‹åº¦ä¸Šä»£è¡¨ç€ç‰©ä½“çš„ä½ç½®ä¿¡æ¯äº†(è™½ç„¶è¿™ä¸ªä½ç½®å¯èƒ½å¹¶ä¸ç²¾ç¡®)ï¼Œå› æ­¤æœ‰å¿…è¦ç”¨ä½ç½®åµŒå…¥å°†è¿™â€œå®è´µ\"çš„ä¿¡æ¯ç»™è®°å½•ä¸‹æ¥ï¼›è€Œ1-stageæ—¶ï¼Œé¢„è®¾çš„query embeddingæœ¬èº«å°±æ˜¯ä¸€ä¸ªæŠ½è±¡ä½“ï¼Œç›²çŒœçš„ä¸œè¥¿ï¼Œå› æ­¤ç”¨çº¿æ€§å˜æ¢æ¥åšç»´åº¦æ˜ å°„å¾—åˆ°å‚è€ƒç‚¹æ¯”è¾ƒåˆç†ï¼Œå› ä¸ºæ¯•ç«Ÿå…¶æœ¬èº«å¹¶æ²¡æœ‰å®é™…æ„ä¹‰çš„ä½ç½®ä¿¡æ¯ã€‚ 3. ä¸ºä½•æ£€æµ‹å¤´éƒ¨çš„å›å½’åˆ†æ”¯é¢„æµ‹çš„æ˜¯åç§»é‡è€Œéç»å¯¹åæ ‡å€¼ï¼Ÿ è¿™ä¸ªé—®é¢˜ä¼°è®¡å¾ˆå¤šäººä¼šæå‡ºï¼Œä¸ºä½•è¿™é‡Œä¸åƒDETRä¸€æ ·ç›´æ¥é¢„æµ‹bboxçš„åæ ‡è€Œæ˜¯é¢„æµ‹åç§»é‡å‘¢ï¼Ÿ è¯·ä½ æƒ³æƒ³ï¼ŒDeformable DETRç›¸æ¯”äºDETRå¤šäº†ä¸€ä¸ªå¾ˆæ˜¾çœ¼çš„ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å‚è€ƒç‚¹ (reference points) å•Šï¼(æ„Ÿè§‰é€šç¯‡å®ƒéƒ½åœ¨ç§€å­˜åœ¨æ„Ÿ..) é‡‡æ ·ç‚¹çš„ä½ç½®æ˜¯åŸºäºå‚è€ƒç‚¹å’Œå¯¹åº”çš„åæ ‡åç§»é‡è®¡ç®—å‡ºæ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´é‡‡æ ·ç‰¹å¾æ˜¯åˆ†å¸ƒåœ¨å‚è€ƒç‚¹é™„è¿‘çš„ï¼Œæ—¢ç„¶è¿™é‡Œéœ€è¦ç”±é‡‡æ ·ç‰¹å¾å›å½’å‡ºbboxçš„ä½ç½®ï¼Œé‚£ä¹ˆé¢„æµ‹ç›¸å¯¹äºå‚è€ƒç‚¹çš„åç§»é‡å°±ä¼šæ¯”ç›´æ¥é¢„æµ‹ç»å¯¹åæ ‡æ›´æ˜“ä¼˜åŒ–ï¼Œæ›´æœ‰åˆ©äºæ¨¡å‹å­¦ä¹ ã€‚ Because the multi-scale deformable attention module extracts image features around the reference point, we let the detection head predict the bounding box as relative offsets w.r.t. the reference point to further reduce the optimization difficulty. å¦å¤–ï¼Œç”±äºé‡‡æ ·ç‰¹å¾ä¸­æ³¨å…¥äº†æ³¨æ„åŠ›ï¼Œè€Œé¢„æµ‹æ¡†æ˜¯åŸºäºé‡‡æ ·ç‰¹å¾å›å½’å¾—åˆ°çš„ï¼Œlossæ˜¯åŸºäºå›å½’ç»“æœè®¡ç®—çš„ï¼Œæ¢¯åº¦æ˜¯é€šè¿‡lossåå‘ä¼ æ’­çš„ï¼Œå› æ­¤æœ€ç»ˆå­¦ä¹ åˆ°çš„æ³¨æ„åŠ›æƒé‡å°±ä¼šå’Œé¢„æµ‹æ¡†æœ‰ç›¸å¯¹è¾ƒå¼ºçš„è”ç³»ï¼Œè¿™ä¹Ÿèµ·åˆ°äº†åŠ é€Ÿæ”¶æ•›çš„æ•ˆæœã€‚ In this way, the learned decoder attention will have strong correlation with the predicted bounding boxes, which also accelerates the training convergence. ","date":"2023-10-27","objectID":"/posts/deformabledetr/:9:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["ObjectDetection"],"content":"9ã€ä¸å…¶å®ƒæ–¹æ³•æ¯”è¾ƒ Deformable DETRæ˜¯åœ¨DETRåŸºç¡€ä¸Šæå‡ºçš„ï¼Œå› æ­¤ï¼Œåœ¨è¿™æœ€åä¸€éƒ¨åˆ†CWæ‰“ç®—å°†å…¶ä¸DETRä½œä¸ªæ¯”è¾ƒï¼›å¦å¤–ï¼ŒCWè§‰å¾—å…¶ä¸Sparse R-CNNä¹Ÿæœ‰å€¼å¾—æ¯”è¾ƒçš„åœ°æ–¹ï¼Œä¹‹å‰CWä¹Ÿå†™è¿‡ä¸€ç¯‡æ–‡ç« (ç›®å‰è¿˜åœ¨ç®€ä¹¦ï¼Œåç»­ä¼šåŒæ­¥åˆ°çŸ¥ä¹è¿™è¾¹æ¥)åˆ†æè¿‡è¯´Sparse R-CNNåƒæ˜¯DETRçš„å°å¼Ÿå“ˆå“ˆå“ˆã€‚ ä»¥ä¸‹åˆ—å‡ºçš„ç‚¹éƒ½æ˜¯ä»…å‡ºç°åœ¨ Deformable DETR ä¸­è€Œåœ¨ DETR / Sparse R-CNN ä¸­æ˜¯æ²¡æœ‰çš„ã€‚ i). vs DETR å¤šå°ºåº¦ç‰¹å¾ï¼› æ–°å¢scale-level embeddingï¼Œç”¨äºåŒºåˆ†ä¸åŒç‰¹å¾å±‚(ç”±äºç¬¬1ç‚¹)ï¼› ä½¿ç”¨äº†å¤šå°ºåº¦å¯å˜å½¢æ³¨æ„åŠ›æ›¿ä»£Encoderä¸­çš„è‡ªæ³¨æ„åŠ›å’ŒDecoderä¸­çš„äº¤å‰æ³¨æ„åŠ›ï¼› å¼•å…¥äº†å‚è€ƒç‚¹ï¼ŒæŸç§ç¨‹åº¦ä¸Šèµ·åˆ°å…ˆéªŒçš„ä½œç”¨ï¼› ä¸ºè‡ªå·±å¼€å‘äº†â€œé«˜é…â€ç‰ˆ: è¿­ä»£çš„æ¡†æ ¡æ­£ç­–ç•¥ å’Œ ä¸¤é˜¶æ®µæ¨¡å¼ï¼› æ£€æµ‹å¤´éƒ¨çš„å›å½’åˆ†æ”¯é¢„æµ‹çš„æ˜¯bboxåç§»é‡è€Œéç»å¯¹åæ ‡å€¼ ii). vs Sparse R-CNN æ²¡æœ‰ä½¿ç”¨FPNï¼› ä½¿ç”¨äº†ä½ç½®åµŒå…¥ï¼› 2-stageæ—¶ï¼Œproposalsæ˜¯predictedçš„(è€ŒéSparse R-CNNç›´æ¥ä½¿ç”¨learnable embedding)ï¼› ä½¿ç”¨äº†Transformerï¼› æ³¨æ„åŠ›æœºåˆ¶æ˜¯one-to-many iteraction(Sparse R-CNNç”±äºâ€˜Sparseâ€™å¶åƒåŒ…è¢±å¤ªé‡ï¼Œæ˜¯å½»åº•çš„sparseï¼Œæ˜¯one-to-oneå®ä¾‹çº§åˆ«çš„äº¤äº’)ï¼› æ£€æµ‹å¤´éƒ¨çš„å›å½’åˆ†æ”¯é¢„æµ‹çš„æ˜¯bboxåç§»é‡è€Œéç»å¯¹åæ ‡å€¼ æœ€å: DETRæ”¶æ•›æ…¢å’Œå°ç›®æ ‡æ£€æµ‹æ•ˆæœå·®çš„åŸå› åœ¨äºTransformerçš„æ³¨æ„åŠ›è®¡ç®—æ¨¡å—â€”â€”å®ƒå¯¹å…¨å±€å¯†é›†çš„å…³ç³»è¿›è¡Œå»ºæ¨¡ï¼Œè¿™ä½¿å¾—æ¨¡å‹éœ€è¦é•¿æ—¶é—´å»å­¦ä¹ (å…³æ³¨)çœŸæ­£æœ‰æ„ä¹‰çš„ç¨€ç–ä½ç½®ï¼ŒåŒæ—¶è¿˜å¸¦æ¥äº†é«˜å¤æ‚åº¦çš„è®¡ç®—ä¸ç©ºé—´èµ„æºæ¶ˆè€—ã€‚ è”æƒ³åˆ°ç¨€ç–ç©ºé—´ä½ç½®çš„å­¦ä¹ æ˜¯DCNçš„å¼ºé¡¹ï¼Œä½†å…¶åˆç¼ºä¹å…³ç³»å»ºæ¨¡èƒ½åŠ›ï¼Œäºæ˜¯ä½œè€…æœºæ™ºåœ°å°†DCNä¸Transformerç»“åˆåœ¨ä¸€èµ·ï¼Œæœ€ç»ˆæå‡º Deformable DETRã€‚ ref: [1]. https://zhuanlan.zhihu.com/p/372116181 [2]. https://blog.csdn.net/qq_38253797/article/details/127668593 [3]. https://zhuanlan.zhihu.com/p/596303361 ","date":"2023-10-27","objectID":"/posts/deformabledetr/:10:0","tags":["draft"],"title":"Deformable DETRè®ºæ–‡ç²¾è¯»+ä»£ç è¯¦è§£","uri":"/posts/deformabledetr/"},{"categories":["C++"],"content":"Effective Modern C++ ç¬”è®° ","date":"2023-10-12","objectID":"/posts/effective_modern_c/:1:0","tags":["Effective Modern C++"],"title":"Effective Modern C++ é˜…è¯»ç¬”è®°","uri":"/posts/effective_modern_c/"},{"categories":["C++"],"content":"CH01 Deducing Types Item 1: Understand template type deduction. å¤§éƒ¨åˆ†ç®€å•åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬æ ¹æ®æ¨¡æ¿è°ƒç”¨å¯èƒ½ä¸€çœ¼å°±èƒ½æ¨å¯¼å‡ºæ¥æ¨¡æ¿ç±»å‹ã€‚ä½†æ˜¯ï¼Œå¯¹äºä¸€äº›å¤æ‚åœºæ™¯ï¼Œæ¨¡æ¿ç±»å‹å°±æ²¡é‚£ä¹ˆæ˜æ˜¾äº†ï¼Œè¿™å°±éœ€è¦éµå¾ªä¸€äº›åŸºæœ¬åŸåˆ™ã€‚ template\u003ctypename T\u003e void f(ParamType param); //..... f(expr); // call f with some expression è€ƒè™‘ä»¥ä¸Šä»£ç ç‰‡æ®µï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µæ ¹æ®è°ƒç”¨ç‚¹ expr æ¥æ¨å¯¼å‡º T å’Œ ParamType çš„ç±»å‹ã€‚è¿™å…¶ä¸­ T çš„æ¨å¯¼ä¸ä»…ä¾èµ– expr çš„ç±»å‹ï¼Œä¹Ÿä¾èµ– ParamType çš„å½¢å¼ï¼Œæœ‰3ç§åœºæ™¯ï¼š ParamType æ˜¯å¼•ç”¨æˆ–è€…æŒ‡é’ˆç±»å‹ï¼Œä½†ä¸æ˜¯ä¸‡èƒ½å¼•ç”¨ã€‚ ParamType æ˜¯ä¸‡èƒ½å¼•ç”¨ã€‚ ParamType ä¸æ˜¯å¼•ç”¨ä¹Ÿä¸æ˜¯æŒ‡é’ˆã€‚ Case 1: ParamType is a Reference or Pointer, but not a Universal Reference å¯¹äº ParamType æ˜¯å¼•ç”¨æˆ–è€…æŒ‡é’ˆç±»å‹ï¼Œä½†ä¸æ˜¯ä¸‡èƒ½å¼•ç”¨çš„åœºæ™¯ï¼Œç±»å‹æ¨å¯¼æ–¹å¼å¦‚ä¸‹ï¼š å¦‚æœ expr æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œå¿½ç•¥å…¶å¼•ç”¨éƒ¨åˆ†ã€‚ ç„¶åå¯¹ expr çš„ç±»å‹å’Œ ParamType è¿›è¡Œæ¨¡å¼åŒ¹é…æ¥å†³å®š Tã€‚ è€ƒè™‘ä¸‹é¢çš„ä¾‹å­ï¼š template\u003ctypename T\u003e void f(T\u0026 param); // param is a reference æˆ‘ä»¬çš„å˜é‡ç”³æ˜å¦‚ä¸‹ï¼š int x = 27; // x is an int const int cx = x; // cx is a const int const int\u0026 rx = x; // rx is a reference to x as a const int è°ƒç”¨ç‚¹å’Œæ¨å¯¼ç»“æœå¦‚ä¸‹ï¼š f(x); // T is int, param's type is int\u0026 // param's type is int\u0026 f(cx); // T is const int, // param's type is const int\u0026 f(rx); // T is const int, // param's type is const int\u0026 ç¬¬ä¸€ä¸ªè°ƒç”¨ï¼Œå‡½æ•°è°ƒç”¨éå¸¸ç®€å•ï¼Œæˆ‘ä»¬å¾ˆå¿«èƒ½å¾—åˆ° T æ˜¯ intï¼Œparamç±»å‹æ˜¯ int\u0026ã€‚ ç¬¬äºŒä¸ªè°ƒç”¨ï¼Œcx æ˜¯ const int ç±»å‹ï¼Œå› æ­¤ T è¢«æ¨å¯¼æˆ const intï¼Œparam çš„ç±»å‹æ˜¯ const int\u0026ã€‚å½“æˆ‘ä»¬ä¼ ä¸€ä¸ª const å¯¹è±¡ç»™å‡½æ•°çš„ä¸€ä¸ªå¼•ç”¨ç±»å‹å‚æ•°ï¼Œæˆ‘ä»¬æœŸæœ›è¿™ä¸ªconst å¯¹è±¡ä¸èƒ½è¢«ä¿®æ”¹ï¼Œå› æ­¤ param è¢«æ¨å¯¼æˆå¸¸é‡å¼•ç”¨ï¼ˆreference-to-constï¼‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¼ é€’ä¸€ä¸ª const å¯¹è±¡ç»™ T\u0026 æ¨¡æ¿ç±»å‹æ˜¯å®‰å…¨çš„åŸå› ï¼šå¯¹è±¡çš„ constness å±æ€§è¢«æ¨å¯¼æˆäº† T çš„ä¸€éƒ¨åˆ†ã€‚ ç¬¬ä¸‰ä¸ªè°ƒç”¨ï¼Œè™½ç„¶ rx çš„ç±»å‹æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œç±»å‹æ¨å¯¼è¿‡ç¨‹ä¸­å°†å¿½ç•¥ rx çš„å¼•ç”¨ç±»å‹ï¼ŒT è¢«æ¨å¯¼æˆä¸€ä¸ªéå¼•ç”¨ç±»å‹ï¼Œå³ const intï¼Œparam çš„ç±»å‹æ˜¯ const int\u0026ã€‚ å¦‚æœæˆ‘ä»¬å°† param ç±»å‹æ”¹æˆ const T\u0026ï¼Œæƒ…å†µç•¥ä¸ºæœ‰ç‚¹ä¸åŒï¼Œå› ä¸º param çš„ç±»å‹å·²ç»æ˜¯å¸¸é‡å¼•ç”¨ï¼ˆreference-to-constï¼‰ï¼Œä¸éœ€è¦å°† const æ¨å¯¼æˆ T çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š template\u003ctypename T\u003e void f(const T\u0026 param); // param is now a ref-to-const int x = 27; // as before const int cx = x; // as before const int\u0026 rx = x; // as before f(x); // T is int, param's type is const int\u0026 f(cx); // T is int, param's type is const int\u0026 f(rx); // T is int, param's type is const int\u0026 å¦‚æœ param æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ˆæˆ–è€…æ˜¯æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼‰ï¼Œæ¨å¯¼æ–¹å¼å…¶æ˜¯å¼•ç”¨æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹ï¼š template\u003ctypename T\u003e void f(T* param); // param is now a pointer int x = 27; // as before const int *px = \u0026x; // px is a ptr to x as a const int f(\u0026x); // T is int, param's type is int* f(px); // T is const int, // param's type is const int* Case1 åœºæ™¯çš„æ¨¡æ¿ç±»å‹æ¨å¯¼å’Œæˆ‘ä»¬è®¾æƒ³çš„åº”è¯¥å·®ä¸å¤šï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ Case 2: ParamType is a Universal Reference æ¨¡æ¿ç±»å‹å‚æ•°æ˜¯ä¸‡èƒ½å¼•ç”¨æ—¶ï¼Œæ¨¡æ¿ç±»å‹æ¨å¯¼å°±æ²¡æœ‰é‚£ä¹ˆæ˜æ˜¾äº†ï¼Œè¯¦ç»†ä»‹ç»å°†ä¼šåœ¨ Item24 ä¸­å±•å¼€ï¼Œè¿™é‡Œç›´æ¥ç»™å‡ºå¤„ç†æ–¹å¼ï¼š å¦‚æœ expr æ˜¯ä¸€ä¸ªå·¦å€¼ï¼ˆlvalueï¼‰ï¼ŒT å’Œ ParamType éƒ½è¢«æ¨å¯¼æˆå·¦å€¼çš„å¼•ç”¨ã€‚è¿™æ˜¯éå¸¸ä¸å¯»å¸¸çš„ã€‚ç¬¬ä¸€ï¼Œè¿™æ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨æ¨¡æ¿ç±»å‹æ¨å¯¼ä¸­å°† T æ¨å¯¼æˆä¸€ä¸ªå¼•ç”¨çš„æƒ…å†µã€‚ç¬¬äºŒï¼Œè™½ç„¶ ParamType è¢«ç”³æ˜æˆè¯­æ³•ä¸Šçš„ä¸€ä¸ªå³å€¼ï¼ˆrvalueï¼‰å¼•ç”¨ï¼Œä½†å®ƒçš„æ¨å¯¼ç±»å‹å´æ˜¯ä¸€ä¸ªå·¦å€¼å¼•ç”¨ã€‚ å¦‚æœ expr æ˜¯ä¸€ä¸ªå³å€¼ï¼Œå’Œæ­£å¸¸çš„è§„åˆ™ä¸€æ ·ï¼ˆæ¯”å¦‚Case1çš„æ¨å¯¼æ–¹å¼ï¼‰ã€‚ ä¾‹å¦‚ï¼š template\u003ctypename T\u003e void f(T\u0026\u0026 param); // param is now a universal reference int x = 27; const int cx = x; const int\u0026 rx = x; f(x); // x is lvalue, so T is int\u0026, // param's type is also int\u0026 f(cx); // cx is lvalue, so T is const int\u0026, // param's type is also const int\u0026 f(rx); // rx is lvalue, so T is const int\u0026, // param's type is also const int\u0026 f(27); // 27 is rvalue, so T is int, // param's type is therefore int\u0026\u0026 æˆ‘ä»¬å°†åœ¨ Item24 ä¸­è§£é‡Šè¿™æ ·æ¨å¯¼çš„åŸå› ã€‚ Case 3: ParamType is Neither a Pointer nor a Reference å½“ ParamType ä¸æ˜¯å¼•ç”¨ä¹Ÿä¸æ˜¯æŒ‡é’ˆï¼Œåˆ™æ˜¯é€šè¿‡å€¼ä¼ é€’çš„æ–¹å¼å¤„ç†ï¼š template\u003ctypename T\u003e void f(T param); // param is now passed by value è¿™æ„å‘³ç€ä¸ç®¡ä¼ é€’è¿›æ¥çš„æ˜¯å•¥ï¼Œparam æ˜¯å®å‚çš„æ‹·è´ï¼Œå®ƒå°†æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚æ¨å¯¼æ–¹å¼å¦‚ä¸‹ï¼š å’Œä¹‹å‰ä¸€æ ·ï¼Œå¦‚æœ expr çš„ç±»å‹æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œå¿½ç•¥å…¶å¼•ç”¨éƒ¨åˆ†ã€‚ åœ¨å¿½ç•¥ expr çš„å¼•ç”¨éƒ¨åˆ†ä¹‹åï¼Œå¦‚æœ expr æ˜¯ä¸€ä¸ª constï¼Œä¹Ÿå¿½ç•¥å®ƒã€‚å¦‚æœ expr æ˜¯ volatile çš„ï¼Œä¹ŸåŒæ ·å¿½ç•¥ã€‚ å› æ­¤ï¼š template\u003ctypename T\u003e void f(T param); // param is now passed by value int x = 27; const int cx = x; const int\u0026 rx = x; f(x); // T's and param's types are both int f(cx); // T's and param's types are again both int f(rx); // T's and param's types are still both int æ³¨æ„åˆ°ï¼Œè™½ç„¶ cx å’Œ rx æ˜¯ const ç±»å‹ï¼Œparam ä¹Ÿä¸æ˜¯ const çš„ã€‚è¿™æ˜¯å¯ä»¥ç†è§£çš„ï¼Œparam æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œ ç‹¬ç«‹äº cx å’Œ rx â€”â€” æ˜¯ cx å’Œ rx çš„ä¸€ä¸ªæ‹·è´ã€‚param çš„ä¿®æ”¹ä¸ä¼šå½±å“åˆ° cx å’Œ rxï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ç±»å‹æ¨å¯¼æ—¶ expr çš„ constnessï¼ˆä»¥åŠ volatileness ç­‰ï¼‰è¢«å¿½ç•¥çš„åŸå› ï¼šå› ä¸º expr ä¸èƒ½è¢«ä¿®æ”¹å¹¶ä¸æ„å‘³ç€å®ƒçš„æ‹·è´ä¸èƒ½ã€‚ å¯¹äºå€¼ä¼ é€’çš„å‚æ•°æ¨¡æ¿ï¼Œconst å’Œ volatile æ˜¯è¢«å¿½ç•¥çš„ï¼Œä½†æ˜¯å¯¹äºå¼•ç”¨ç±»å‹æˆ–è€…å¸¸é‡å¼•ç”¨ç±»å‹å‚æ•°çš„æ¨¡æ¿ï¼Œexpr çš„ const åœ¨ç±»å‹æ¨å¯¼æ—¶è¢«ä¿ç•™ä¸‹æ¥äº†ã€‚è€ƒè™‘ expr æ˜¯ä¸€ä¸ªæŒ‡å‘å¸¸é‡çš„å¸¸é‡æŒ‡é’ˆï¼Œé€šè¿‡å€¼ä¼ é€’çš„å‚æ•°ç±»å‹ï¼š template\u003ctypename T\u003e void f(T param); // param is still passed by value const char* const ptr = \"Fun with pointers\"; // ptr is const pointer to const object f(ptr); // pass arg of type const char * const è¿™é‡Œï¼Œptr æ˜¯å¸¸é‡ï¼Œptr æŒ‡å‘çš„å­—ç¬¦ä¸²ä¹Ÿæ˜¯å¸¸é‡ã€‚å½“ ptr ä¼ é€’ç»™ fï¼Œç»„æˆæŒ‡é’ˆçš„æ¯”ç‰¹ä½è¢«æ‹·è´ç»™ paramï¼Œä¹Ÿå°±æ˜¯è¯´æŒ‡é’ˆè‡ªå·±ï¼ˆptrï¼‰æ˜¯å€¼ä¼ é€’ï¼Œæ ¹æ®å€¼ä¼ é€’å‚æ•°æ¨¡æ¿ç±»å‹æ¨å¯¼è§„åˆ™ï¼Œptr çš„ constness å°†è¢«å¿½ç•¥ï¼Œparam çš„ç±»","date":"2023-10-12","objectID":"/posts/effective_modern_c/:1:1","tags":["Effective Modern C++"],"title":"Effective Modern C++ é˜…è¯»ç¬”è®°","uri":"/posts/effective_modern_c/"},{"categories":["C++"],"content":"CH02: auto Item 5: Prefer auto to explicit type declarations. C++ æ˜¾å¼å£°æ˜å¯èƒ½ä¼šäº§ç”Ÿä¾‹å¦‚å˜é‡æœªåˆå§‹åŒ–ã€ç”³æ˜ç±»å‹å†—é•¿ã€æ— æ³•å½¢æˆé—­åŒ…ã€æˆªæ–­ç­‰é—®é¢˜ï¼Œé€šè¿‡ä½¿ç”¨ auto å¯ä»¥å¾ˆå¥½è§£å†³è¿™äº›é—®é¢˜ã€‚ é¿å…å˜é‡æœªåˆå§‹åŒ– int x1; // potentially uninitialized auto x2; // error! initializer required auto x3 = 0; // fine, x's value is well-defined x1 æœªåˆå§‹åŒ–ï¼Œå…¶å€¼å¯èƒ½æ˜¯æœªå®šä¹‰çš„ï¼Œè¿™å¯¼è‡´ç¨‹åºä¸­å¯èƒ½éšè—ç€ bugã€‚ä½¿ç”¨ auto å£°æ˜çš„å˜é‡æœªåˆå§‹åŒ–å°†å¯¼è‡´ç¼–è¯‘æŠ¥é”™ã€‚ ç®€åŒ–å˜é‡ç”³æ˜ è€ƒè™‘ä¸‹é¢çš„ä»£ç ï¼Œé€šè¿‡è§£å¼•ç”¨è¿­ä»£å™¨åˆå§‹åŒ–å±€éƒ¨å˜é‡ï¼š template\u003ctypename It\u003e // algorithm to dwim (\"do what I mean\") void dwim(It b, It e) // for all elements in range from { // b to e while (b != e) { typename std::iterator_traits\u003cIt\u003e::value_type currValue = *b; â€¦ } } ä½¿ç”¨ auto ç®€åŒ–ä¸Šè¿°ä»£ç ï¼š template\u003ctypename It\u003e // as before void dwim(It b, It e) { while (b != e) { auto currValue = *b; â€¦ } } ç”³æ˜é—­åŒ…ç±»å‹ åœ¨ Item 2 ä¸­ä»‹ç»è¿‡ auto å¯ä»¥é€šè¿‡ç±»å‹æ¨åˆ°å¾—åˆ°å®é™…çš„ç±»å‹ï¼Œè€ƒè™‘ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼š auto derefUPLess = // comparison func. [](const std::unique_ptr\u003cWidget\u003e\u0026 p1, // for Widgets const std::unique_ptr\u003cWidget\u003e\u0026 p2) // pointed to by { return *p1 \u003c *p2; }; // std::unique_ptrs C++14 lambda å‡½æ•°å‚æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨ autoï¼Œä»£ç ç®€åŒ–å¦‚ä¸‹ï¼š auto derefLess = // C++14 comparison [](const auto\u0026 p1, // function for const auto\u0026 p2) // values pointed { return *p1 \u003c *p2; }; // to by anything // pointer-like ä½¿ç”¨ auto çš„ derefLess æ˜¯ä¸€ä¸ªé—­åŒ…ç±»å‹ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ std::function å¾—åˆ°é—­åŒ…ç±»å‹ï¼š std::function\u003cbool(const std::unique_ptr\u003cWidgey\u003e\u0026, const std::unique_ptr\u003cWidget\u003e\u0026)\u003e derefLess = [] (const std::unique_ptr\u003cWidget\u003e\u0026 p1, const std::unique_ptr\u003cWidget\u003e\u0026 p2) { return *p1 \u003c *p2; }; auto ç”³æ˜çš„æŒæœ‰é—­åŒ…çš„å˜é‡å’Œé—­åŒ…æœ‰ç›¸åŒçš„ç±»å‹ï¼Œå¹¶ä¸”ä»…ä½¿ç”¨é—­åŒ…éœ€è¦çš„å†…å­˜å¤§å°ã€‚è€Œ std::function å£°æ˜æŒæœ‰é—­åŒ…çš„å˜é‡æœ‰ä¸€ä¸ªå›ºå®šå¤§å°å†…å­˜ï¼Œä¸€æ—¦å†…å­˜å¤§å°ä¸è¶³ï¼Œåˆ™éœ€è¦ç”³è¯·å †å†…å­˜æ¥å­˜å‚¨é—­åŒ…ã€‚å› æ­¤ï¼Œstd::function ç”³æ˜çš„å¯¹è±¡è¦æ¯” auto ç”³æ˜çš„å¯¹è±¡å æ›´å¤šçš„å†…å­˜ï¼Œç”±äºçº¦æŸå†…åµŒçš„ä½¿ç”¨å’Œæä¾›é—´æ¥å‡½æ•°çš„è°ƒç”¨ï¼Œé€šè¿‡ std::function å¯¹è±¡æ¥è°ƒç”¨ä¸€ä¸ªå°è£…ä½“æ¯”é€šè¿‡ auto å¯¹è±¡è¦æ…¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œstd::function æ–¹æ³•é€šå¸¸ä½“ç§¯æ¯” auto å¤§ä¸”æ…¢ï¼Œè¿˜æœ‰å¯èƒ½å¯¼è‡´å†…å­˜ä¸è¶³çš„å¼‚å¸¸ã€‚ é¿å…ç±»å‹æˆªæ–­ auto è¿˜æœ‰ä¸€ä¸ªé¿å…å†…å­˜æˆªæ–­çš„ä¼˜ç‚¹ï¼Œè€ƒè™‘ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼š std::vector\u003cint\u003e v; â€¦ unsigned sz = v.size(); v.size() è¿”å›ç±»å‹æ˜¯ std::vector::size_type ï¼Œä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œå¾ˆå¤šç¨‹åºå‘˜å¯èƒ½ä¼šå†™å‡ºä¸Šé¢çš„ä»£ç ã€‚std::vector::size_type åœ¨ 32 ä½æœºå™¨ä¸Šæ˜¯ 4ä¸ªå­—èŠ‚ï¼Œä½†åœ¨ 64 ä½æœºå™¨ä¸Šåˆ™ä¸º 8 å­—èŠ‚ï¼Œä½†æ˜¯ unsigned å›ºå®šä¸º 4 å­—èŠ‚ã€‚ä¸Šé¢çš„ä»£ç åœ¨ 32 ä½æœºå™¨ä¸Šè¿è¡Œæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†ç§»æ¤åˆ° 64 ä½æœºå™¨ä¸Šåˆ™ä¼šå¯¼è‡´ç±»å‹æˆªæ–­çš„é—®é¢˜ã€‚ é¿å…ç±»å‹ä¸åŒ¹é… auto è¿˜å…·æœ‰ä¸€ä¸ªéå¸¸éšè”½çš„æ•ˆæœï¼Œçœ‹ä¸‹é¢çš„ä»£ç ï¼š std::unordered_map\u003cstd::string, int\u003e m; ... for (std::pair\u003cstd::string, int\u003e\u0026 p : m) { ... // do something with p } çœ‹ä¸Šå»æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿæˆ‘ä»¬å¾ˆæœ‰å¯èƒ½å†™å‡ºä»¥ä¸Šçš„è¿­ä»£ä»£ç ï¼Œä½†æ˜¯ unordered_map çš„ key æ˜¯ constçš„ï¼Œå³ hash map ä¸­ std::pair çš„ç±»å‹æ˜¯ std::pair\u003cconst std::string, int\u003eã€‚ä¸‹é¢çš„ä»£ç å°†äº§ç”Ÿç¼–è¯‘æŠ¥é”™ï¼š #include \u003cunordered_map\u003e #include \u003ciostream\u003e int main() { int p; std::unordered_map\u003cstd::string,int\u003e m; m[\"key\"] = 10; for(std::pair\u003cstd::string,int\u003e\u0026p : m) { p.second = 2; } return 0; } // ç¼–è¯‘æŠ¥é”™ main.cpp:8:38: error: invalid initialization of reference of type 'std::pair\u003cstd::__cxx11::basic_string\u003cchar\u003e, int\u003e\u0026' from expression of type 'std::pair\u003cconst std::__cxx11::basic_string\u003cchar\u003e, int\u003e' 8 | for(std::pair\u003cstd::string,int\u003e\u0026p : m) { ä¸çŸ¥é“è¿™ä¸ªéšè”½çš„èƒŒæ™¯çŸ¥è¯†çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ auto æ›¿ä»£åˆ™ä¼šé¿å…ä¸Šè¿°é—®é¢˜ï¼š for (auto\u0026 p : m) { â€¦ // as before } ä¸Šé¢ä»‹ç»äº†å‡ æ¡ä½¿ç”¨ auto çš„ä¼˜åŠ¿ï¼Œ ä½¿ç”¨ auto ä¹Ÿæœ‰ Item 2 å’Œ Item 6 ä»‹ç»çš„ä½¿ç”¨é™·é˜±ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ Item 4 ä»‹ç»çš„ä¸€äº›æ–¹æ³•å¯è§†åŒ–å…¶ç±»å‹æ¨å¯¼ç»“æœï¼Œauto è¿˜æ˜¯éå¸¸å€¼å¾—ä½¿ç”¨çš„ã€‚ æ€»ç»“ auto å˜é‡å¿…é¡»åˆå§‹åŒ–ï¼Œä¸å—ç±»å‹ä¸åŒ¹é…å¯¼è‡´ç§»æ¤å’Œæ•ˆç‡é—®é¢˜ã€‚ auto ç±»å‹ä¹Ÿå— Item2 å’Œ Item6 ä¸­ä»‹ç»çš„é™·é˜±å›°æ‰°ã€‚ Item 6: Use the explicitly typed initializer idiom when auto deduces undesired types. åœ¨ Item 5 ä¸­ä»‹ç»äº†ä½¿ç”¨ auto ç”³æ˜ç±»å‹çš„ä¼˜åŠ¿ï¼Œä¹Ÿåœ¨ Item 2 ä»‹ç»äº† auto ç±»å‹æ¨å¯¼çš„æ–¹å¼å’Œ auto ç±»å‹æ¨å¯¼æœ‰æ—¶å€™å¹¶éå¦‚æˆ‘ä»¬æ‰€æ„¿çš„æƒ…å†µï¼Œæœ¬æ–‡ç»§ç»­åˆ†æä½¿ç”¨ auto å­˜åœ¨çš„é—®é¢˜ã€‚ çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œå‡½æ•° features å…¥å‚ä¸º Widget ç±»å‹ï¼Œè¿”å›ä¸€ä¸ª std::vectorï¼Œæ¯ä¸€ä¸ª bool ä»£è¡¨ Widget æ˜¯å¦æä¾›ä¸€ä¸ªç‰¹æ®Šçš„ç‰¹æ€§ï¼š std::vector\u003cbool\u003e features(const Widget\u0026 w); å‡è®¾ bit 5 ä»£è¡¨æ˜¯å¦æœ‰é«˜ä¼˜å…ˆçº§ï¼Œå¯èƒ½ç¼–ç å¦‚ä¸‹ï¼š Widget w; â€¦ bool highPriority = features(w)[5]; // is w high priority? â€¦ processWidget(w, highPriority); // process w in accord // with its priority å¦‚æœä¿®æ”¹ highPriority æ˜¾ç¤ºç”³æ˜ä¸º auto ï¼š auto highPriority = features(w)[5]; // is w high priority? å°†å¯¼è‡´ processWidget å‡ºç°ä¸å¯é¢„æµ‹çš„è¡Œä¸ºï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¯¹ vector çš„ operator [] æ“ä½œï¼Œä¸€èˆ¬æˆ‘ä»¬æœŸæœ›å¾—åˆ° T\u0026 ç±»å‹ã€‚ä½†æ˜¯å¯¹äº vector çš„ operator [] æ“ä½œï¼Œå¾—åˆ°çš„æ˜¯ std::vector::reference ç±»å‹ï¼Œå´ä¸æ˜¯ bool\u0026 ç±»å‹ã€‚ ä¸ºä»€ä¹ˆä¼šæœ‰std::vector::reference ç±»å‹å‘¢ï¼Ÿä¸»è¦æ˜¯ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œä½¿ç”¨ 1 ä¸ª bit ä»£æ›¿ 1 ä¸ªå­—èŠ‚çš„ bool ç±»å‹ã€‚ std::vector çš„ operator [] æ“ä½œåº”è¯¥è¿”å›çš„æ˜¯ T\u0026ï¼Œ ä½†æ ‡å‡†åº“æ— æ³•è¿”å¯¹ bit çš„å¼•ç”¨ã€‚ ä¸ºäº†å¾—åˆ°æ¥è¿‘ bool\u0026 çš„ç±»å‹ï¼Œstd::vector::reference å¯¹è±¡èƒ½å¤Ÿä½¿ç”¨åœ¨ bool\u0026 å¯ä»¥ä½¿ç”¨çš„åœºæ™¯ã€‚ ç”±äºä»¥ä¸Šå‡ ç‚¹ï¼Œå†çœ‹ä¸‹è¿™æ®µä»£ç ï¼š bool highPriority = features(w)[5]; // is w high priority? è¿™é‡Œï¼Œfeatures è¿”å›çš„æ˜¯ std::vector å¯¹è±¡ï¼Œç„¶åæ–½åŠ  operator [] æ“ä½œå¾—åˆ° std::vector::reference å¯¹è±¡ï¼Œ æœ€åè¢«éšå¼è½¬åŒ–ä¸º bool ç±»å‹æ¥åˆå§‹åŒ– highPriorityï¼ŒhighPriority ","date":"2023-10-12","objectID":"/posts/effective_modern_c/:1:2","tags":["Effective Modern C++"],"title":"Effective Modern C++ é˜…è¯»ç¬”è®°","uri":"/posts/effective_modern_c/"},{"categories":["C++"],"content":"CH03: Moving to Modern C++ Item 7: Distinguish between () and {} when creating objects. åˆå§‹åŒ–æ–¹å¼ C++11å¼€å§‹å˜é‡åˆå§‹åŒ–æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š int x(0); // initializer is in parentheses int y = 0; // initializer follows \"=\" int z{ 0 }; // initializer is in braces int z = { 0 }; // initializer uses \"=\" and braces å…¶ä¸­ç¬¬å››ç§ä½¿ç”¨ç­‰å·å’ŒèŠ±æ‹¬å·æ–¹å¼åˆå§‹åŒ–å˜é‡é€šå¸¸è®¤ä¸ºå’Œç¬¬ä¸‰ç§èŠ±æ‹¬å·çš„æ–¹å¼ç›¸åŒã€‚ä½¿ç”¨ç­‰å·è¿›è¡Œåˆå§‹åŒ–å¯èƒ½ä¼šè¢«è®¤ä¸ºæ˜¯èµ‹å€¼æ“ä½œï¼Œå¯¹äºå†…ç½®ç±»å‹ï¼ˆæ¯”å¦‚ intï¼‰ï¼Œå¯ä»¥å¿½ç•¥å®ƒä»¬çš„åŒºåˆ«ï¼Œä½†å¯¹äºç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼Œåˆ™éœ€è¦åŒºåˆ«ï¼š Widget w1; // call default constructor Widget w2 = w1; // not an assignment; calls copy ctor w1 = w2; // an assignment; calls copy operator= ä½¿ç”¨ {} åˆå§‹åŒ–è¢«ç§°ä¸ºç»Ÿä¸€åˆå§‹åŒ–ï¼ˆuniform initializationï¼‰ï¼ŒæœŸæœ›èƒ½å¤Ÿç»Ÿä¸€åº”ç”¨åœ¨æ‰€æœ‰åˆå§‹åŒ–åœºæ™¯ï¼ˆå®é™…ä¸Šä¹Ÿæœ‰ç¼ºé™·ï¼Œåæ–‡å°†ä»‹ç»ï¼‰ã€‚ () å’Œ = åˆå§‹åŒ–æ–¹å¼çš„é™åˆ¶ åœ†æ‹¬å·ä¸èƒ½ç”¨äºéé™æ€æˆå‘˜å˜é‡çš„é»˜è®¤åˆå§‹åŒ–ï¼š class Widget { ... private: int x{ 0 }; // fine, x's default value is 0 int y = 0; // also fine int z(0); // error! }; // ç¼–è¯‘æŠ¥é”™ä¿¡æ¯ main.cpp:10:11: error: expected identifier before numeric constant 10 | int z(0); // error! æˆå‘˜å˜é‡ z çš„åˆå§‹åŒ–å°†ä¼šå¯¼è‡´ç¼–è¯‘æŠ¥é”™ã€‚ å¦å¤–ï¼ŒC++ä¸­ä¸èƒ½æ‹·è´çš„å¯¹è±¡åˆ™ä¸èƒ½ä½¿ç”¨ç­‰å·åˆå§‹åŒ–ï¼š std::atomic\u003cint\u003e ai1{ 0 }; std::atomic\u003cint\u003e ai2(0); // fine std::atomic\u003cint\u003e ai3 = 0; // error! // ç¼–è¯‘æŠ¥é”™ä¿¡æ¯ main.cpp:5:24: error: use of deleted function â€˜std::atomic\u003cint\u003e::atomic(const std::atomic\u003cint\u003e\u0026)â€™ std::atomic\u003cint\u003e a = 0; ^ = å’Œ () åˆå§‹åŒ–éƒ½æœ‰ä½¿ç”¨çš„é™åˆ¶ï¼Œå¯èƒ½å°±æ˜¯ {} åˆå§‹åŒ–è¢«ç§°ä¸ºç»Ÿä¸€åˆå§‹åŒ–çš„åŸå› å§ã€‚ {} åˆå§‹åŒ–çš„ä¼˜åŠ¿ ç»Ÿä¸€åˆå§‹åŒ–å¯ä»¥é¿å…éšå¼çª„åŒ–è½¬æ¢ï¼ˆnarrowing conversionsï¼‰ï¼š double x, y, z; int sum1{ x + y + z }; // error! sum of doubles may not be expressible as int int sum2(x + y + z); // okay (value of expression truncated to an int) int sum3 = x + y + z; // ditto ç»Ÿä¸€åˆå§‹åŒ–å¦å¤–ä¸€ä¸ªå¥½å¤„æ˜¯é¿å…äº† C++ å¤æ‚çš„è¯­æ³•åˆ†æï¼ˆmost vexing parseï¼‰ï¼š Widget w2(); // most vexing parse! declares a function named w2 that returns a Widget! Widget w1(10); // call Widget ctor with argument 10 Widget w3{}; // calls Widget ctor with no args ç¬¬ä¸€ä¸ªä¾‹å­çš„é—®é¢˜å¯ä»¥æˆ³ C++â€˜s most vexing parse äº†è§£æ›´å¤šã€‚ {}åˆå§‹åŒ–çš„ä¸è¶³ é™¤äº† Item 2 ä»‹ç»çš„ auto å˜é‡ç±»å‹å£°æ˜ä½¿ç”¨ç»Ÿä¸€åˆå§‹åŒ–æ—¶å€™ç±»å‹è¢«æ¨å¯¼æˆ std::initializer_list çš„ç‰¹ç‚¹å¤–ï¼Œè¿˜å­˜åœ¨ç»Ÿä¸€åˆå§‹åŒ–å’Œå…¶ä»–åˆå§‹åŒ–è¡Œä¸ºä¸ä¸€è‡´çš„æƒ…å†µã€‚ åœ¨æ²¡æœ‰ std::initializer_list å‚æ•°ç±»å‹çš„æ„é€ å‡½æ•°æ—¶ï¼š class Widget { public: Widget(int i, bool b); // ctors not declaring Widget(int i, double d); // std::initializer_list params ... }; Widget w1(10, true); // calls first ctor Widget w2{10, true}; // also calls first ctor Widget w3(10, 5.0); // calls second ctor Widget w4{10, 5.0}; // also calls second ctor åœ¨å¢åŠ ä¸€ä¸ªstd::initializer_list å‚æ•°ç±»å‹çš„æ„é€ å‡½æ•°æ—¶ï¼š class Widget { public: Widget(int i, bool b); // as before Widget(int i, double d); // as before Widget(std::initializer_list\u003clong double\u003e il); // added ... }; Widget w1(10, true); // uses parens and, as before, // calls first ctor Widget w2{10, true}; // uses braces, but now calls // std::initializer_list ctor // (10 and true convert to long double) Widget w3(10, 5.0); // uses parens and, as before, // calls second ctor Widget w4{10, 5.0}; // uses braces, but now calls // std::initializer_list ctor // (10 and 5.0 convert to long double) è¿™é‡Œï¼Œw2 å’Œ w4 å°†ä¼šä½¿ç”¨æ–°å¢çš„æ„é€ å‡½æ•°ï¼ˆç¬¬3ä¸ªæ„é€ å‡½æ•°ï¼‰ã€‚ä½†æ˜¯å¾ˆæ˜æ˜¾ï¼Œ non-std::initializer_list å‚æ•°ç±»å‹æ„é€ å‡½æ•°æ¯”std::initializer_list å‚æ•°ç±»å‹æ„é€ å‡½æ•°æ›´åŠ åŒ¹é…ã€‚ æ›´æœ‰ç”šè€…ï¼Œæ‹·è´å’Œç§»åŠ¨æ„é€ å‡½æ•°ä¹Ÿèƒ½è¢« std::initializer_list æ„é€ å‡½æ•°ç»‘æ¶ï¼š class Widget { public: Widget(int i, bool b); // as before Widget(int i, double d); // as before Widget(std::initializer_list\u003clong double\u003e il); // as before operator float() const; // convert to float ... }; Widget w5(w4); // uses parens, calls copy ctor Widget w6{w4}; // uses braces, calls std::initializer_list ctor // (w4 converts to float, and float converts to long double) Widget w7(std::move(w4)); // uses parens, calls move ctor Widget w8{std::move(w4)}; // uses braces, calls std::initializer_list ctor // (for same reason as w6) ç¼–è¯‘å™¨åŒ¹é… std::initializer_list æ„é€ å‡½æ•°çš„å†³å¿ƒå¾ˆå¼ºï¼Œç”šè‡³å¯¼è‡´ç¼–è¯‘æŠ¥é”™ï¼Œä¹Ÿæ²¡æœ‰åŒ¹é…åˆ°æ™®é€šçš„æ„é€ å‡½æ•°ï¼š class Widget { public: Widget(int i, bool b); // as before Widget(int i, double d); // as before Widget(std::initializer_list\u003cbool\u003e il); // element type is now bool ... // no implicit conversion funcs }; Widget w{10, 5.0}; // error! requires narrowing conversions è¿™é‡Œï¼Œç¼–è¯‘å™¨ç›´æ¥å¿½ç•¥å‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œè¯•å›¾åŒ¹é… std::initializer_list æ„é€ å‡½æ•°ï¼Œä½†æ˜¯éœ€è¦å°† int (10) å’Œ double (5.0) è½¬æ¢ä¸º bool ç±»å‹ï¼Œè¿™æ˜¯çª„åŒ–è½¬åŒ–ï¼Œå°†ä¼šå¤±è´¥ï¼ˆå‰é¢æœ‰è§£é‡Šï¼‰ï¼Œè¿™é‡Œå°±å¯¼è‡´é”™è¯¯ã€‚ åªæœ‰èŠ±æ‹¬å·ä¸­å‚æ•°æ— æ³•è½¬æ¢ä¸º std::initializer_list ä¸­ç±»å‹æ—¶ï¼Œç¼–è¯‘å™¨æ‰åŒ¹é…æ™®é€šå‡½æ•°ï¼š class Widget { public: Widget(int i, bool b); // as before Widget(int ","date":"2023-10-12","objectID":"/posts/effective_modern_c/:1:3","tags":["Effective Modern C++"],"title":"Effective Modern C++ é˜…è¯»ç¬”è®°","uri":"/posts/effective_modern_c/"},{"categories":["C++"],"content":"CH04: Smart Pointers Item 18: Use std::unique_ptr for exclusive-ownership resource management. åŸå§‹æŒ‡é’ˆéå¸¸çµæ´»ï¼Œä½†æ˜¯ä½¿ç”¨é™·é˜±å¤šï¼Œå®¹æ˜“å‡ºé”™ï¼Œæ™ºèƒ½æŒ‡é’ˆåˆ™æ›´å®¹æ˜“ä½¿ç”¨ã€‚æœ¬æ–‡ä»‹ç»çš„æ™ºèƒ½æŒ‡é’ˆæ˜¯ std::unique_ptrã€‚ ç‹¬å æ‰€æœ‰æƒ std::unique_ptr è¡¨ç°å‡ºç‹¬å æ‰€æœ‰æƒçš„è¯­ä¹‰ã€‚ä¸€ä¸ªéç©ºçš„ std::unique_ptr æ€»æ˜¯å¯¹å®ƒæŒ‡å‘çš„èµ„æºæ‹¥æœ‰ç‹¬å æ‰€æœ‰æƒï¼Œå®ƒä¸å…±äº«å®ƒæŒ‡å‘çš„èµ„æºç»™å…¶ä»–æŒ‡é’ˆã€‚å› æ­¤ï¼Œæ— æ³•é€šè¿‡å€¼ä¼ é€’ std::unique_ptr ç»™å‡½æ•°ï¼Œä¹Ÿä¸å…è®¸å¤åˆ¶ std::unique_ptrã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œæ³¨æ„ std::make_unique åœ¨ C++14 æ‰å¼€å§‹æ”¯æŒï¼Œä»æŠ¥é”™ä¿¡æ¯ä¹Ÿå¯ä»¥çœ‹åˆ°æ‹·è´æ„é€ å‡½æ•°æ˜¯ delete çš„ã€‚ #include\u003ciostream\u003e #include\u003cmemory\u003e int main() { std::unique_ptr\u003cint\u003e pInt(new int(5)); // std::unique_ptr\u003cint\u003e pInt = std::make_unique\u003cint\u003e(5); // C++14 æ‰æ”¯æŒ std::unique_ptr\u003cint\u003e pInt1(pInt); // æŠ¥é”™ } // æŠ¥é”™ä¿¡æ¯ï¼š main.cpp: In function 'int main()': main.cpp:8:36: error: use of deleted function 'std::unique_ptr\u003c_Tp, _Dp\u003e::unique_ptr(const std::unique_ptr\u003c_Tp, _Dp\u003e\u0026) [with _Tp = int; _Dp = std::default_delete\u003cint\u003e]' 8 | std::unique_ptr\u003cint\u003e pInt1(pInt); // æŠ¥é”™ | ^ In file included from /usr/local/include/c++/11.2.0/memory:76, from main.cpp:2: /usr/local/include/c++/11.2.0/bits/unique_ptr.h:468:7: note: declared here 468 | unique_ptr(const unique_ptr\u0026) = delete; | std::unique_ptr æ˜¯ move-only ç±»å‹ï¼Œå¯ä»¥ move å®ƒçš„æ§åˆ¶æƒï¼ŒåŸ std::unique_ptr åˆ™å˜ä¸ºç©ºæŒ‡é’ˆã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š #include\u003ciostream\u003e #include\u003cmemory\u003e int main() { std::unique_ptr\u003cint\u003e pInt(new int(5)); std::unique_ptr\u003cint\u003e pInt2 = std::move(pInt); // è½¬ç§»æ‰€æœ‰æƒ // std::cout \u003c\u003c *pInt \u003c\u003c std::endl; // Segmentation fault (core dumped) ./a.out std::cout \u003c\u003c *pInt2 \u003c\u003c std::endl; std::unique_ptr\u003cint\u003e pInt3(std::move(pInt2)); } std::unique_ptr è™½ç„¶ä¸æ”¯æŒå¤åˆ¶ï¼Œä½†æœ‰ä¸ªä¾‹å¤–ï¼šå¯ä»¥ä»å‡½æ•°è¿”å›ä¸€ä¸ª std::unique_ptrã€‚ #include\u003ciostream\u003e #include\u003cmemory\u003e std::unique_ptr\u003cint\u003e func(int x) { std::unique_ptr\u003cint\u003e pInt(new int(x)); return pInt; } int main() { int x = 5; std::unique_ptr\u003cint\u003e p = func(x); std::cout \u003c\u003c *p \u003c\u003c std::endl; } å ç”¨å†…å­˜çš„å¤§å° ç›¸è¾ƒäºå…¶ä»–æ™ºèƒ½æŒ‡é’ˆï¼Œstd::unique_ptr æœ‰ä¸€ä¸ªä¼˜åŠ¿ï¼šåœ¨ä¸è‡ªå®šä¹‰åˆ é™¤å™¨çš„æƒ…å†µä¸‹ï¼Œstd::unique_ptr çš„å†…å­˜å ç”¨å‡ ä¹å’ŒåŸå§‹æŒ‡é’ˆä¸€è‡´ã€‚ #include\u003ciostream\u003e #include\u003cmemory\u003e int main() { int *p = new int(5); std::unique_ptr\u003cint\u003e pu(new int(6)); std::cout \u003c\u003c sizeof(p) \u003c\u003c \":\" \u003c\u003c sizeof(pu) \u003c\u003c std::endl; return 0; } // è¾“å‡ºï¼š8:8 std::unique_ptr å†…éƒ¨å‡ ä¹ä¸ç”¨ç»´æŠ¤å…¶ä»–ä¿¡æ¯ï¼ˆstd::shared_ptr éœ€è¦ç»´æŠ¤å¼•ç”¨è®¡æ•°ï¼‰ï¼Œå½“å®ƒç¦»å¼€ä½œç”¨åŸŸï¼Œæ˜¯é€šè¿‡ delete åˆ é™¤æŒ‡å‘çš„èµ„æºã€‚ä½†æ˜¯ï¼Œå¦‚æœè‡ªå®šä¹‰äº†åˆ é™¤å™¨ï¼Œåˆ™ä¼šå¢åŠ å†…å­˜å ç”¨ã€‚ #include\u003ciostream\u003e #include\u003cmemory\u003e int main() { int c = 2; int d = 3; // å¸¦å‚æ•°æ•æ‰çš„lambdaè¡¨è¾¾å¼ï¼Œä¼šå¯¼è‡´unique_ptrå ç”¨å†…å­˜å˜å¤§ auto delint = [\u0026](int *p) { std::cout \u003c\u003c \"c = \" \u003c\u003c c \u003c\u003c std::endl; std::cout \u003c\u003c \"d = \" \u003c\u003c d \u003c\u003c std::endl; std::cout \u003c\u003c \"deleter\" \u003c\u003c std::endl; delete p; }; std::unique_ptr\u003cint, decltype(delint)\u003e p(new int(10), delint); std::cout \u003c\u003c sizeof(p) \u003c\u003c std::endl; return 0; } // è¾“å‡ºï¼š 24 c = 2 d = 3 deleter ä¸€ä¸ªå…¸å‹åº”ç”¨ std::unique_ptr çš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯ä½œä¸ºä¸€ä¸ªå·¥å‚å‡½æ•°çš„è¿”å›ç±»å‹ï¼ˆæŒ‡å‘ç±»å±‚æ¬¡ä¸­çš„å¯¹è±¡ï¼‰ã€‚è¿™é‡Œç›´æ¥ä½¿ç”¨è¿™é‡Œçš„ä»£ç ä½œä¸ºä¾‹å­ï¼š #include\u003ciostream\u003e #include\u003cmemory\u003e using namespace std; /*! * \\brief The Investment class åŸºç±» */ class Investment { public: virtual ~Investment() = default; public: virtual void doWork() = 0; }; /*! * \\brief The Stock class æ´¾ç”Ÿç±» */ class Stock : public Investment { public: virtual void doWork() override { cout \u003c\u003c \"Stock doWork....\\n\"; } }; /*! * \\brief The Stock class æ´¾ç”Ÿç±» */ class Bond : public Investment { public: virtual void doWork() override { cout \u003c\u003c \"Bond doWork....\\n\"; } }; enum class InvestType { INVEST_TYPE_STOCK, INVEST_TYPE_BOND, }; auto makeInvestment(InvestType type) { // è‡ªå®šä¹‰ææ„å™¨, è¿™é‡Œä»¥lambdaè¡¨è¾¾å¼çš„å½¢å¼ç»™å‡º auto delInvmt = [](Investment *pInvestment) { // TODO è‡ªå®šä¹‰ææ„æ—¶æƒ³å¹²çš„äº‹ cout \u003c\u003c \"delInvmt called....\" \u003c\u003c endl; delete pInvestment; }; // å¾…è¿”å›çš„æŒ‡é’ˆ, åˆå§‹åŒ–ä¸ºç©ºæŒ‡é’ˆï¼Œå¹¶æŒ‡å®šè‡ªå®šä¹‰ææ„å™¨ // decltype(delInvmt) ç”¨äºè·å–è‡ªå®šä¹‰ææ„å™¨çš„ç±»å‹ unique_ptr\u003cInvestment, decltype(delInvmt)\u003e pInv(nullptr, delInvmt); // æ³¨æ„è¿™é‡Œç”¨resetæ¥æŒ‡å®špInvè·å–ä»newäº§ç”Ÿçš„å¯¹è±¡çš„æ‰€æœ‰æƒ, ä¸èƒ½ç”¨=èµ‹å€¼ switch (type) { case InvestType::INVEST_TYPE_STOCK: //pInv = new Stock; // error!! c++11ç¦æ­¢ä»è£¸æŒ‡é’ˆåˆ°æ™ºèƒ½æŒ‡é’ˆçš„éšå¼è½¬æ¢ pInv.reset(new Stock); break; case InvestType::INVEST_TYPE_BOND: pInv.reset(new Bond); break; } // è¿”å›æ™ºèƒ½æŒ‡é’ˆ return pInv; } void test() { // æµ‹è¯•å·¥å‚å‡½æ•° { // pInvå‡ºä½œç”¨åŸŸåä¼šè‡ªå·±ææ„ auto pInv = makeInvestment(InvestType::INVEST_TYPE_STOCK); if (pInv) { pInv-\u003edoWork(); } } cout \u003c\u003c \"----------------\\n\"; // æµ‹è¯•moveæ•ˆæœ { auto pInv = makeInvestment(InvestType::INVEST_TYPE_BOND); auto pInv2 = move(pInv); cout \u003c\u003c \"after move pInv to pInv2 \\n\"; if (!p","date":"2023-10-12","objectID":"/posts/effective_modern_c/:1:4","tags":["Effective Modern C++"],"title":"Effective Modern C++ é˜…è¯»ç¬”è®°","uri":"/posts/effective_modern_c/"},{"categories":["C++"],"content":"CH05: Rvalue References, Move Semantics, and Perfect Forwarding Item 23: Understand std::move and std::forward. std::move å’Œ std::forward å¹¶ä¸åƒä»–ä»¬åå­—æ‰€è¡¨è¾¾çš„é‚£æ ·ï¼Œå®é™…ä¸Š std::move å¹¶æ²¡æœ‰ç§»åŠ¨æ•°æ®ï¼Œstd::forward ä¹Ÿå¹¶æ²¡æœ‰è½¬å‘æ•°æ®ï¼Œå¹¶ä¸”å®ƒä»¬åœ¨è¿è¡ŒæœŸä»€ä¹ˆä¹Ÿæ²¡åšã€‚ å…ˆè¯´ std::moveï¼Œæˆ‘ä»¬çœ‹ä¸‹å®ƒåœ¨ C++11 ä¸­ç®€æ˜“çš„å®ç°å¦‚ä¸‹ï¼š template\u003ctypename T\u003e // in namespace std typename remove_reference\u003cT\u003e::type\u0026\u0026 move(T\u0026\u0026 param) { using ReturnType = // alias declaration; typename remove_reference\u003cT\u003e::type\u0026\u0026; // see Item 9 return static_cast\u003cReturnType\u003e(param); } std::move åªæ˜¯è¿”å›äº†å³å€¼å¼•ç”¨ã€‚è¿™é‡Œä½¿ç”¨äº† remove_reference æ˜¯ä¸ºäº†å»é™¤å¼•ç”¨æ ‡è¯†ç¬¦ã€‚å½“ T æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„æ—¶å€™ï¼Œæ ¹æ®å¼•ç”¨æŠ˜å åŸç†ï¼ŒT\u0026\u0026 ä¼šè¢«æŠ˜å æˆä¸€ä¸ªå·¦å€¼å¼•ç”¨ç±»å‹ã€‚æ‰€ä»¥ remove_reference æ˜¯ä¸ºäº†å»é˜²æ­¢ T æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œ å®ƒä¼šå»é™¤å¼•ç”¨è¿›è€Œä¿è¯ std::move è¿”å›ä¸€ä¸ªå³å€¼å¼•ç”¨ã€‚å› æ­¤ std::move åªæ˜¯åšäº†ç±»å‹è½¬æ¢ï¼Œå¹¶æ²¡æœ‰ç§»åŠ¨æ•°æ®ã€‚ç”±äºåªæœ‰å³å€¼æ˜¯å¯ä»¥è¢«ç§»åŠ¨çš„ï¼Œstd::move æ›´åƒæ˜¯è¯´æ˜ç»è¿‡å®ƒä¹‹åå¯¹è±¡å¯èƒ½ä¼šè¢«ç§»åŠ¨ï¼ˆå¯èƒ½ï¼Œè€Œä¸æ˜¯ä¸€å®šï¼Œåæ–‡ä¼šæœ‰è§£é‡Šï¼‰ã€‚ è€Œ C++14 çš„ std::move æ›´åŠ ç®€æ´ï¼š template\u003ctypename T\u003e // C++14; still in decltype(auto) move(T\u0026\u0026 param) // namespace std { using ReturnType = remove_reference_t\u003cT\u003e\u0026\u0026; return static_cast\u003cReturnType\u003e(param); } std::move çš„ç›®çš„å°±æ˜¯è®©ç¼–è¯‘å™¨æŠŠä¿®é¥°çš„å˜é‡çœ‹åšæ˜¯å³å€¼ï¼Œè¿›è€Œå°±å¯ä»¥è°ƒç”¨å…¶ç§»åŠ¨æ„é€ å‡½æ•°ã€‚äº‹å®ä¸Šï¼Œå³å€¼æ˜¯ä»…å¯ä»¥è¢«ç§»åŠ¨çš„å¯¹è±¡ï¼Œstd::move ä¹‹åä¸ä¸€å®šä¸€å®šè°ƒç”¨æ„é€ å‡½æ•°ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œå‡å¦‚ä½ æœ‰è¿™æ ·çš„ä¸€ä¸ªç±»ï¼š class Annotation { public: explicit Annotation(std::string text) : text_(text) std::string text_; } class Annotation { public: explicit Annotation(std::string text) : text_(std::move(text)) {} std::string text_; }; class Annotation { public: //è¿™é‡Œæ¢æˆäº†å¸¦æœ‰const explicit Annotation(const std::string text) : text_(std::move(text)) {} std::string text_; }; ç¬¬ä¸€ä¸ªå®ç°ä¼šå‘ç”Ÿä¸¤æ¬¡æ‹·è´ï¼Œç¬¬äºŒä¸ªå®ç°ä¼šå‘ç”Ÿä¸€æ¬¡æ‹·è´å’Œä¸€æ¬¡ç§»åŠ¨ï¼Œé‚£ä¹ˆç¬¬ä¸‰ä¸ªå®ç°ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ ç”±äº Annotation çš„æ„é€ å‡½æ•°ä¼ å…¥çš„æ˜¯ä¸€ä¸ª const std::string textï¼Œstd::move(text) ä¼šè¿”å›ä¸€ä¸ªå¸¸é‡å³å€¼å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯ const å±æ€§è¢«ä¿ç•™äº†ä¸‹æ¥ã€‚è€Œ std::string çš„ move æ„é€ å‡½æ•°çš„å‚æ•°åªèƒ½æ˜¯ä¸€ä¸ªé const çš„å³å€¼å¼•ç”¨ï¼Œè¿™é‡Œä¸èƒ½å»è°ƒç”¨ move æ„é€ ã€‚åªèƒ½è°ƒç”¨ copy æ„é€ ï¼Œå› ä¸º copy æ„é€ å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ª const å¼•ç”¨ï¼Œå®ƒæ˜¯å¯ä»¥æŒ‡å‘ä¸€ä¸ª const å³å€¼ã€‚å› æ­¤ï¼Œç¬¬ä¸‰ä¸ªå®ç°ä¹Ÿæ˜¯å‘ç”Ÿä¸¤æ¬¡æ‹·è´ã€‚ ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„ä¾‹å­éªŒè¯ä¸€ä¸‹ï¼š #include \u003ciostream\u003e #include \u003cboost/type_index.hpp\u003e using boost::typeindex::type_id_with_cvr; class A { public: A(){ std::cout \u003c\u003c \"constructon\" \u003c\u003c std::endl; } A(const A\u0026 a) { std::cout \u003c\u003c \"copy constructon\" \u003c\u003c std::endl; } A(A\u0026\u0026 a) { std::cout \u003c\u003c \"move constructon\" \u003c\u003c std::endl; } }; int main() { const A a1; std::cout \u003c\u003c type_id_with_cvr\u003cdecltype(std::move(a1))\u003e().pretty_name() \u003c\u003c std::endl; auto a2(std::move(a1)); return 0; } // output constructon A const\u0026\u0026 copy constructon å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºä¸¤ç‚¹å¯ç¤ºï¼š ç¬¬ä¸€ï¼Œå‡å¦‚ä½ æƒ³å¯¹è±¡èƒ½å¤ŸçœŸæ­£è¢«ç§»åŠ¨ï¼Œä¸è¦å£°æ˜å°†å…¶ç”³æ˜ä¸º constï¼Œå¯¹ const å¯¹è±¡çš„ç§»åŠ¨æ“ä½œä¼šè¢«è½¬æ¢æˆäº†æ‹·è´æ“ä½œã€‚ ç¬¬äºŒï¼Œstd::move ä¸ä»…ä¸ç§»åŠ¨ä»»ä½•ä¸œè¥¿ï¼Œç”šè‡³ä¸èƒ½ä¿è¯è¢«è½¬æ¢çš„å¯¹è±¡å¯ä»¥è¢«ç§»åŠ¨ã€‚å”¯ä¸€å¯ä»¥ç¡®è®¤çš„æ˜¯åº”ç”¨ std::move çš„å¯¹è±¡ç»“æœæ˜¯ä¸ªå³å€¼ã€‚ å†è¯´ std::forwardã€‚std::forward ä¹Ÿå¹¶æ²¡æœ‰è½¬å‘æ•°æ®ï¼Œæœ¬è´¨ä¸Šåªæ˜¯åšç±»å‹è½¬æ¢ï¼Œä¸ std::move ä¸åŒçš„æ˜¯ï¼Œstd::move æ˜¯å°†æ•°æ®æ— æ¡ä»¶çš„è½¬æ¢å³å€¼ï¼Œè€Œ std::forward çš„è½¬æ¢æ˜¯æœ‰æ¡ä»¶çš„ï¼šå½“ä¼ å…¥çš„æ˜¯å³å€¼çš„æ—¶å€™å°†å…¶è½¬æ¢ä¸ºå³å€¼ç±»å‹ã€‚ çœ‹ä¸€ä¸ª std::forward çš„å…¸å‹åº”ç”¨ï¼š #include\u003ciostream\u003e #include\u003cchrono\u003e class Widget { }; void process(const Widget\u0026 lvalArg) { std::cout \u003c\u003c \"process(const Widget\u0026 lvalArg)\" \u003c\u003c std::endl; } void process(Widget\u0026\u0026 rvalArg) { std::cout \u003c\u003c \"process(Widget\u0026\u0026 rvalArg)\" \u003c\u003c std::endl; } template\u003ctypename T\u003e void logAndProcess(T\u0026\u0026 param) { auto now = std::chrono::system_clock::now(); process(std::forward\u003cT\u003e(param)); } int main () { Widget w; logAndProcess(w); // call with lvalue logAndProcess(std::move(w)); // call with rvalue } // output process(const Widget\u0026 lvalArg) process(Widget\u0026\u0026 rvalArg) å½“æˆ‘ä»¬é€šè¿‡å·¦å€¼å»è°ƒç”¨ logAndProcess æ—¶ï¼Œè‡ªç„¶æœŸæœ›è¿™ä¸ªå·¦å€¼å¯ä»¥åŒæ ·ä½œä¸ºä¸€ä¸ªå·¦å€¼è½¬ç§»åˆ° process å‡½æ•°ï¼Œå½“æˆ‘ä»¬é€šè¿‡å³å€¼å»è°ƒç”¨ logAndProcess æ—¶ï¼Œæˆ‘ä»¬æœŸæœ›è¿™ä¸ªå³å€¼å¯ä»¥åŒæ ·ä½œä¸ºä¸€ä¸ªå³å€¼è½¬ç§»åˆ° process å‡½æ•°ã€‚ ä½†æ˜¯ï¼Œå¯¹äº logAndProcess çš„å‚æ•° paramï¼Œå®ƒæ˜¯ä¸ªå·¦å€¼ï¼ˆå¯ä»¥å–åœ°å€ï¼‰ã€‚åœ¨ logAndProcess å†…éƒ¨åªä¼šè°ƒç”¨å·¦å€¼çš„ process å‡½æ•°ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå½“ä¸”ä»…å½“ä¼ å…¥çš„ç”¨æ¥åˆå§‹åŒ– param çš„å®å‚æ˜¯ä¸ªå³å€¼ï¼Œæˆ‘ä»¬éœ€è¦ std::forward æ¥æŠŠ param è½¬æ¢æˆä¸€ä¸ªå³å€¼ã€‚è‡³äº std::forward æ˜¯å¦‚ä½•çŸ¥é“å®ƒçš„å‚æ•°æ˜¯é€šè¿‡ä¸€ä¸ªå³å€¼æ¥åˆå§‹åŒ–çš„ï¼Œå°†ä¼šåœ¨ Item 28 ä¸­ä¼šè§£é‡Šè¿™ä¸ªé—®é¢˜ã€‚ æ€»ç»“ std::move æ— æ¡ä»¶å°†è¾“å…¥è½¬åŒ–ä¸ºå³å€¼ã€‚å®ƒæœ¬èº«å¹¶ä¸ç§»åŠ¨ä»»ä½•ä¸œè¥¿ã€‚ std::forward æŠŠå…¶å‚æ•°è½¬æ¢ä¸ºå³å€¼ï¼Œä»…ä»…åœ¨å‚æ•°è¢«ç»‘å®šåˆ°ä¸€ä¸ªå³å€¼æ—¶ã€‚ std::move å’Œ std::forward åªæ˜¯åšç±»å‹è½¬æ¢ï¼Œåœ¨è¿è¡Œæ—¶ï¼ˆruntimeï¼‰ä¸åšä»»ä½•äº‹ã€‚ Item 24: Distinguish universal references from rvalue references. åœ¨ C++11 ç§»åŠ¨è¯­ä¹‰å‡ºç°åï¼Œé‡åˆ° T\u0026\u0026 ï¼Œä½ å¯èƒ½è®¤ä¸ºå°±æ˜¯å³å€¼å¼•ç”¨ï¼Œå…¶å®ä¸ç„¶ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªä¸‡èƒ½å¼•ç”¨ï¼ˆuniversal referenceï¼‰ï¼Œå³å€¼å¼•ç”¨å’Œä¸‡èƒ½å¼•ç”¨åªæ˜¯å½¢å¼ä¸Šç›¸ä¼¼è€Œå·²ï¼ŒäºŒè€…å®é™…ä¸Šæ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚å³å€¼å¼•ç”¨åªèƒ½ç»‘å®šåˆ°ä¸€ä¸ªå³å€¼ä¸Šï¼›è€Œä¸‡èƒ½å¼•ç”¨æ—¢å¯ä»¥ç»‘å®šåˆ°ä¸€ä¸ªå³å€¼ï¼Œä¹Ÿå¯ä»¥ç»‘å®šåˆ°ä¸€ä¸ªå·¦å€¼ã€‚å¦å¤–ï¼Œä¸‡èƒ½å¼•ç”¨èƒ½ç»‘å®šåˆ° const æˆ–é const å¯¹è±¡ï¼Œä¹Ÿèƒ½ç»‘å®šåˆ° volatile æˆ–é volatile å¯¹è±¡ï¼Œç”šè‡³èƒ½ç»‘å®šåˆ° const åŠ  volatile çš„å¯¹è±¡ã€‚ void f(Widget\u0026\u0026 param); // rvalue reference Widget\u0026\u0026 var1 = Widget(); // rvalue reference auto\u0026\u0026 var2 = var1; // not rvalue reference template\u003ctypename T\u003e void f(std::vector\u003cT\u003e\u0026\u0026 param); // rvalue reference ","date":"2023-10-12","objectID":"/posts/effective_modern_c/:1:5","tags":["Effective Modern C++"],"title":"Effective Modern C++ é˜…è¯»ç¬”è®°","uri":"/posts/effective_modern_c/"},{"categories":["C++"],"content":"CH06: Lambda Expressions Item 31: Avoid default capture modes. C++11 lambda è¡¨è¾¾å¼æœ‰ä¸¤ç§é»˜è®¤æ•è·æ¨¡å¼ï¼šä¼ å¼•ç”¨æ•è·å’Œä¼ å€¼æ•è·ã€‚é»˜è®¤ä¼ å¼•ç”¨æ•è·å¯èƒ½å¯¼è‡´å¼•ç”¨æ‚¬æŒ‚çš„é—®é¢˜ã€‚é»˜è®¤ä¼ å€¼æ•è·å…¶å®ä¹Ÿä¸èƒ½é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”ä½ çš„ lambda é—­åŒ…ä¹Ÿä¸æ˜¯ç‹¬ç«‹çš„ã€‚ å…ˆçœ‹é»˜è®¤ä¼ å¼•ç”¨æ•è·å¯¼è‡´å¼•ç”¨æ‚¬æŒ‚çš„é—®é¢˜ã€‚çœ‹ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼š using FilterContainer = std::vector\u003cstd::function\u003cbool(int)\u003e\u003e; FilterContainer filters; // filtering funcs void addDivisorFilter() { auto calc1 = computeSomeValue1(); auto calc2 = computeSomeValue2(); auto divisor = computeDivisor(calc1, calc2); filters.emplace_back( [\u0026](int value) { return value % divisor == 0; } // danger! ref to divisor will dangleï¼ ); } filters å­˜æ”¾äº† lamdba é—­åŒ…ï¼Œé—­åŒ…å¼•ç”¨äº† addDivisorFilter ä½œç”¨åŸŸå†…çš„å±€éƒ¨å˜é‡ divisorï¼Œå½“ç¦»å¼€ addDivisorFilter ä½œç”¨åŸŸåï¼Œå±€éƒ¨å˜é‡ divisor å°†è¢«ææ„ï¼Œè‹¥æ­¤æ—¶ä½¿ç”¨ filters åˆ™å¯¼è‡´å¼•ç”¨æ‚¬æŒ‚ã€‚ ä½¿ç”¨æ˜¾ç¤ºçš„ä¼ å¼•ç”¨æ•è·ä¹Ÿæœ‰åŒæ ·çš„é—®é¢˜ï¼š filters.emplace_back( [\u0026divisor](int value) // danger! ref to { return value % divisor == 0; } // divisor will ); // still dangle! ä¸è¿‡ï¼Œæ˜¾ç¤ºçš„ä¼ å¼•ç”¨æ•è·å¯ä»¥æé†’æˆ‘ä»¬ lambda è¡¨è¾¾å¼çš„ç”Ÿå‘½å‘¨æœŸä¾èµ–äº divisor çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¹Ÿå¯ä»¥æé†’æˆ‘ä»¬éœ€è¦ç¡®ä¿ divisor çš„ç”Ÿå‘½å‘¨æœŸè¦é•¿äº lambda è¡¨è¾¾å¼çš„ç”Ÿå‘½å‘¨æœŸã€‚ è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡é»˜è®¤ä¼ å€¼æ•è·çš„æ–¹å¼è§£å†³ï¼š filters.emplace.back( [=](int value) { return value % divisor == 0; } ) ä½†æ˜¯ï¼Œé»˜è®¤ä¼ å€¼æ•è·ä¹Ÿä¸ä¸€å®šèƒ½å¤Ÿè§£å†³æ‚¬æŒ‚é—®é¢˜ï¼šä¾‹å¦‚ä½ é€šè¿‡ä¼ å€¼çš„æ–¹å¼æ•è·ä¸€ä¸ªæŒ‡é’ˆï¼Œä¹Ÿå³ä½ æ‹·è´äº†ä¸€ä¸ªæŒ‡é’ˆç»™ lambda é—­åŒ…äº†ï¼Œä½†æ˜¯ä½ æ— æ³•é˜»æ­¢ lambda é—­åŒ…å¤–æŒ‡é’ˆè¢« deleteï¼Œä»è€Œå¯¼è‡´æŒ‡é’ˆæ‚¬æŒ‚çš„é—®é¢˜ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š class Widget { public: â€¦ // ctors, etc. void addFilter() const; // add an entry to filters private: int divisor; // used in Widget's filter }; void Widget::addFilter() const { filters.emplace_back( [=](int value) { return value % divisor == 0; } ); } ä¸Šé¢ä»£ç è²Œä¼¼æ˜¯å®‰å…¨çš„ã€‚å› ä¸ºä½ é€šè¿‡é»˜è®¤ä¼ å€¼æ•è·æ–¹å¼ï¼Œåº”è¯¥ä¸ä¼šæœ‰æ‚¬æŒ‚çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œlambda è¡¨è¾¾å¼åªèƒ½æ•è·ä½œç”¨åŸŸå†…çš„éé™æ€å±€éƒ¨å˜é‡ï¼Œè€Œ divisor æ˜¯ä¸€ä¸ªæˆå‘˜å˜é‡ã€‚é‚£ä¹ˆä¸Šé¢çš„ä»£ç ä¸ºä»€ä¹ˆå¯ä»¥ç¼–è¯‘é€šè¿‡å‘¢ï¼Ÿå¯ä»¥å…ˆçœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š void Widget::addFilter() const { filters.emplace_back( [divisor](int value) { return value % divisor == 0; } ); } è¿™æ®µä»£ç ç¼–è¯‘æ— æ³•é€šè¿‡ï¼š main.cpp: In member function 'void Widget::addFilter() const': main.cpp:19:6: error: capture of non-variable 'Widget::divisor' 19 | [divisor](int value) { return value % divisor == 0; } æ­£å¦‚æˆ‘ä»¬æ‰€è®¾æƒ³çš„ï¼Œlambda è¡¨è¾¾å¼æ— æ³•æ•è·éé™æ€æˆå‘˜å˜é‡ã€‚å‰é¢é»˜è®¤ä¼ å€¼æ•è·ä¹‹æ‰€ä»¥èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼ŒåŸå› å…¶å®æ˜¯è¿™é‡Œçš„ lambda è¡¨è¾¾å¼æ•è·çš„æ˜¯ this æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯å°† this æŒ‡é’ˆæ‹·è´è¿›äº†é—­åŒ…ã€‚ç¼–è¯‘å™¨åœ¨å†…éƒ¨å°† divisor æ›¿æ¢æˆäº† this-\u003edivisorï¼Œç­‰ä»·å¦‚ä¸‹ï¼š void Widget::addFilter() const { filters.emplace_back( [=](int value) { return value % this-\u003edivisor == 0; } ); } è¿™é‡Œå®é™…æ•è·çš„ä¸æ˜¯ divisorï¼Œè€Œæ˜¯ this æŒ‡é’ˆã€‚äº†è§£äº†ä¸Šè¿°çœŸç›¸åï¼Œå°±ä¸éš¾ç†è§£é»˜è®¤ä¼ å€¼æ•è·ä¹Ÿå¯èƒ½å¯¼è‡´æŒ‡é’ˆæ‚¬æŒ‚çš„é—®é¢˜äº†ã€‚ using FilterContainer = std::vector\u003cstd::function\u003cbool(int)\u003e\u003e; FilterContainer filters; void doSomeWork() { auto pw = std::make_unique\u003cWidget\u003e(); pw-\u003eaddFilter(); } filters åŒ…å«äº† Widget çš„ this æŒ‡é’ˆçš„æ‹·è´ã€‚ doSomeWork æ‰§è¡Œå®Œæˆåï¼ŒWidget å°†è¢«ææ„ï¼Œå¯¼è‡´ filters åŒ…å«äº†ä¸€ä¸ªæ‚¬æŒ‚çš„æŒ‡é’ˆã€‚ ä¸Šè¿°é—®é¢˜å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå±€éƒ¨å˜é‡æ‹·è´æˆå‘˜å˜é‡æ¥è§£å†³ã€‚å¦‚ä¸‹ï¼š void Widget::addFilter() const { auto divisorCopy = divisor; // copy data member filters.emplace_back( [divisorCopy](int value) // capture the copy { return value % divisorCopy == 0; } // use the copy ); } æˆ–è€…é»˜è®¤ä¼ å€¼æ•è·ä¹Ÿæ˜¯ä¸€æ ·ï¼š void Widget::addFilter() const { auto divisorCopy = divisor; // copy data member filters.emplace_back( [=](int value) // capture the copy { return value % divisorCopy == 0; } // use the copy ); } c++14 çš„æ–¹å¼æ›´åŠ ç®€æ´ï¼š void Widget::addFilter() const { filters.emplace_back( // C++14: [divisor = divisor](int value) // copy divisor to closure { return value % divisor == 0; } // use the copy ); } lambda è¡¨è¾¾å¼åªèƒ½æ•è·éé™æ€å±€éƒ¨å˜é‡ï¼Œå¯¹äº static æˆ–è€… global å˜é‡ï¼Œlambda è¡¨è¾¾å¼ä¸ä¼šæ•è·ã€‚æ‰€ä»¥è¿™äº›å˜é‡å‘ç”Ÿæ”¹å˜ä¼šå½±å“åˆ° lambda è¡¨è¾¾çš„è¡Œä¸ºã€‚ä½¿ç”¨é»˜è®¤ä¼ å€¼æ•è·ï¼Œå¯èƒ½ä¼šè®©ä½ ä»¥ä¸ºä½ çš„ lambda é—­åŒ…æ˜¯ç‹¬ç«‹çš„ï¼Œä¸ä¾èµ–å¤–éƒ¨å˜é‡çš„å˜åŒ–ï¼Œå…¶å®ä¸ç„¶ã€‚ void addDivisorFilter() { static auto calc1 = computeSomeValue1(); // now static static auto calc2 = computeSomeValue2(); // now static static auto divisor = // now static computeDivisor(calc1, calc2); filters.emplace_back( [=](int value) // captures nothing! { return value % divisor == 0; } // refers to above static ); ++divisor; // modify divisor } ä¸Šè¿°ä»£ç å¯èƒ½ä¼šè®©ä½ äº§ç”Ÿé”™è§‰ï¼šå› ä¸ºæ˜¯ä½¿ç”¨é»˜è®¤ä¼ å€¼æ•è·ï¼Œlambda é—­åŒ…æ˜¯å°† divisor æ‹·è´è¿›å»çš„ã€‚ä½†æ˜¯ static å˜é‡ä¸ä¼šè¢« lambda é—­åŒ…æ•è·ï¼Œ divisor çš„æ”¹å˜ä¼šå½±å“åˆ° lambda è¡¨è¾¾å¼çš„è¡Œä¸ºã€‚ æ€»ç»“ é»˜è®¤çš„æŒ‰å¼•ç”¨æ•è·å¯èƒ½ä¼šå¯¼è‡´å¼•ç”¨æ‚¬æŒ‚ã€‚ é»˜è®¤çš„æŒ‰å€¼å¼•ç”¨å¯¹äºæ‚¬æŒ‚æŒ‡é’ˆå¾ˆæ•æ„Ÿï¼ˆå°¤å…¶æ˜¯thisæŒ‡é’ˆï¼‰ï¼Œå¹¶ä¸”å®ƒä¼šè¯¯å¯¼äººè®¤ä¸º lambda æ˜¯ç‹¬ç«‹çš„ã€‚ Item 32: Use init capture to move objects into closures. å¦‚æœä½ æƒ³ç§»åŠ¨ä¸€ä¸ªå¯¹è±¡éƒ½ lambda é—­åŒ…ï¼Œå€¼æ•è·å’Œå¼•ç”¨æ•è·éƒ½ä¸èƒ½å®ç°è¯¥ç›®çš„ã€‚C++ 14 æä¾›äº†åˆå§‹åŒ–æ•è·ï¼ˆinit captureï¼‰æ¨¡å¼æ”¯æŒç§»åŠ¨æ•è·ã€‚C++11 å¹¶ä¸æ”¯æŒï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ std::bind é—´æ¥æ¨¡æ‹Ÿã€‚ C++14 ä½¿ç”¨åˆå§‹åŒ–æ•è·æ¨¡å¼å®ç°ç§»åŠ¨æ•è· C++14 æä¾›äº†æ”¯æŒç§»åŠ¨æ•è·çš„æœºåˆ¶ï¼Œä½†å¹¶æ²¡æœ‰ç±»ä¼¼å€¼æ•è· [=] æˆ–è€…å¼•ç”¨æ•è· [\u0026] çš„æ¨¡å¼ç›´æ¥æ·»åŠ ä¸€ä¸ªç§»åŠ¨æ•è· [\u0026\u0026] æ¨¡å¼ã€‚è€Œæ˜¯é‡‡å–äº†ä¸€ç§æ›´åŠ çµæ´»çš„æœºåˆ¶ â€”â€“ åˆå§‹åŒ–æ•è·æ¨¡å¼ã€‚ç§»åŠ¨æ•è·æ˜¯é‡‡ç”¨åˆå§‹åŒ–æ•è·çš„æœºåˆ¶å®ç°ï¼Œé™¤äº†é»˜è®¤æ•è·æ¨¡å¼","date":"2023-10-12","objectID":"/posts/effective_modern_c/:1:6","tags":["Effective Modern C++"],"title":"Effective Modern C++ é˜…è¯»ç¬”è®°","uri":"/posts/effective_modern_c/"},{"categories":["C++"],"content":"CH07: The Concurrency API Item 35: Prefer task-based programming to thread-based. å¦‚æœä½ æƒ³å¼‚æ­¥è¿è¡Œä¸€ä¸ªå‡½æ•° donAsyncWorkï¼Œä½ æœ‰ä¸¤ä¸ªåŸºæœ¬çš„é€‰æ‹©ï¼šåŸºäºçº¿ç¨‹çš„æ–¹æ³•ï¼ˆthread-basedï¼‰å’ŒåŸºäºä»»åŠ¡çš„æ–¹æ³•ï¼ˆtask-basedï¼‰ã€‚ int doAsyncWork(); std::thread t(doAsyncWork); // thread-based auto fut = std::async(doAsyncWork); // task-based åœ¨æ¯”è¾ƒäºŒè€…ä¼˜åŠ£å‰ï¼Œæˆ‘ä»¬å…ˆä»‹ç»ä¸‹ C++ è½¯ä»¶ä¸­çº¿ç¨‹çš„3ä¸ªå±‚æ¬¡ï¼š ç¡¬ä»¶çº¿ç¨‹ã€‚ç¡¬ä»¶å®é™…æ‰§è¡Œè®¡ç®—çš„å¹¶è¡Œæ•°ã€‚ç°ä»£è®¡ç®—æœºæ¶æ„ä¸­ï¼Œä¸€ä¸ªç¡¬ä»¶æ ¸å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªç¡¬ä»¶çº¿ç¨‹ã€‚ è½¯ä»¶çº¿ç¨‹ã€‚ä¹Ÿè¢«ç§°ä¸ºç³»ç»Ÿçº¿ç¨‹ï¼ŒæŒ‡çš„æ˜¯æ“ä½œç³»ç»Ÿç®¡ç†æ ¸è°ƒåº¦çš„æ‰€æœ‰çº¿ç¨‹ã€‚è½¯ä»¶çº¿ç¨‹è¿è¡Œåœ¨ç¡¬ä»¶çº¿ç¨‹ä¹‹ä¸Šï¼Œå¹¶ä¸”å¯ä»¥åˆ›å»ºçš„è½¯ä»¶çº¿ç¨‹è¦å¤šäºç¡¬ä»¶çº¿ç¨‹ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼šå½“æŸäº›è½¯ä»¶çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼ˆç­‰å¾…IOã€mutexã€condition variableï¼‰æ—¶ï¼Œå¯ä»¥æ‰§è¡Œå…¶ä»–çº¿ç¨‹ä»¥æé«˜ååç‡ã€‚ std::threadã€‚C++ çš„çº¿ç¨‹å¯¹è±¡ï¼Œä½œä¸ºå¥æŸ„å¯¹åº”ç³»ç»Ÿçš„è½¯ä»¶çº¿ç¨‹ã€‚std::thread ä¹Ÿå¯ä»¥æ˜¯ç©ºå¥æŸ„è€Œä¸å¯¹åº”ç³»ç»Ÿçš„è½¯ä»¶çº¿ç¨‹ã€‚ä¾‹å¦‚æ²¡æœ‰æ‰§è¡Œå‡½æ•°ã€æ‰§è¡Œå‡½æ•°è¢«ç§»åŠ¨å…¶ä»–çº¿ç¨‹ã€å·²ç» join æˆ– detached çš„ std::thread å¯¹è±¡ã€‚ åŸºäºä»»åŠ¡çš„æ–¹æ³•ä¸€èˆ¬è¦ä¼˜äºåŸºäºçº¿ç¨‹çš„æ–¹æ³•ã€‚ doAsyncWork æœ‰è¿”å›å€¼ï¼Œå¯ä»¥ä»£è¡¨ä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€ã€‚åŸºäºçº¿ç¨‹çš„æ–¹æ³•æ²¡æœ‰æä¾›ä¸€ä¸ªå¾ˆå¥½çš„æœºåˆ¶è·å–è¿”å›å€¼ã€‚è€Œ std::async è¿”å›çš„ std::future å¯¹è±¡æä¾›äº† get æ–¹æ³•å¯ä»¥è·å–åˆ°è¿”å›å€¼ã€‚å¹¶ä¸”å½“ doAsyncWork è¿”å›å¼‚å¸¸æ—¶ï¼ŒåŸºäºçº¿ç¨‹çš„æ–¹æ³•ç›´æ¥æŠ›å‡º std::terminateï¼Œè€ŒåŸºäºä»»åŠ¡çš„æ–¹æ³•å¯ä»¥æ ¹æ®è¿”å›å€¼åšå¼‚å¸¸å¤„ç†ã€‚ ç³»ç»Ÿçš„è½¯ä»¶çº¿ç¨‹æ˜¯æœ‰é™çš„ï¼Œå½“è¯·æ±‚åˆ›å»ºçš„ std::thread å¤šäºç³»ç»Ÿæä¾›çš„æœ€å¤§è½¯ä»¶çº¿ç¨‹æ•°ï¼Œå°†æŠ›å‡º std::system_errorï¼Œå³ä½¿ doAsyncWork è¢«è®¾ç½®æˆ noexceptã€‚å› è€ŒåŸºäºçº¿ç¨‹çš„æ–¹æ³•éœ€è¦å¤„ç†è¿™ç§æƒ…å†µï¼Œè¿™å°±éœ€è¦å¯¹çº¿ç¨‹è¿›è¡Œç®¡ç†ã€‚ å³ä½¿ä½ æ²¡æœ‰ç”¨å°½è½¯ä»¶çº¿ç¨‹ï¼ŒåŸºäºçº¿ç¨‹çš„æ–¹æ³•è¿˜å­˜åœ¨è®¤è´­è¶…é¢ï¼ˆoversubscriptionï¼‰çš„é—®é¢˜ï¼Œå³å°±ç»ªæ€çš„è½¯ä»¶çº¿ç¨‹é«˜äºç¡¬ä»¶çº¿ç¨‹ã€‚æ“ä½œç³»ç»Ÿä¼šé‡‡ç”¨æ—¶é—´ç‰‡è½®è¯¢çš„æ–¹å¼æ‰§è¡Œæ‰€æœ‰çš„è½¯ä»¶çº¿ç¨‹ï¼Œè€Œçº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ä¼šå¢åŠ çº¿ç¨‹ç®¡ç†çš„å¼€é”€ã€‚å¹¶ä¸”ç¡¬ä»¶çº¿ç¨‹è¢«åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè½¯ä»¶çº¿ç¨‹æ—¶ï¼Œå…¶ cache ä¸Šçš„æ•°æ®é€šå¸¸ä¼šå¤±æ•ˆï¼Œä¹Ÿä¼šå¢åŠ çº¿ç¨‹çš„å¼€é”€ã€‚æƒ³è¦é¿å…è®¤è´­è¶…é¢é—®é¢˜è¿˜æ¯”è¾ƒå›°éš¾ï¼Œè½¯ä»¶çº¿ç¨‹äºç¡¬ä»¶çº¿ç¨‹çš„åˆç†æ¯”ä¾‹å–å†³äºå¤šç§å› ç´ ã€‚ä¾‹å¦‚ç¡¬ä»¶æ¶æ„çš„ç‰¹ç‚¹ã€cacheçš„ä½¿ç”¨æ–¹å¼ã€ä»»åŠ¡çš„ç‰¹ç‚¹ç­‰ã€‚ ç»¼ä¸Šï¼Œçº¿ç¨‹çš„ç®¡ç†æ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚è€ŒåŸºäºä»»åŠ¡çš„æ–¹æ³•å°†çº¿ç¨‹ç®¡ç†äº¤ç»™äº† C++ æ ‡å‡†åº“ï¼Œè€Œ C++ æ ‡å‡†åº“å¯ä»¥æ›´å¥½åœ°ç®¡ç†çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼Œä½ æ— éœ€æ‹…å¿ƒè½¯ä»¶çº¿ç¨‹è€—å°½çš„é—®é¢˜ï¼Œå› ä¸ºé»˜è®¤å‚æ•°çš„ std::async ä¸ä¸€å®šä¼šåˆ›å»ºçº¿ç¨‹ï¼Œå®ƒå¯èƒ½åœ¨è®¤è´­è¶…é¢æ—¶å°†å½“å‰ä»»åŠ¡å®‰æ’åœ¨å½“å‰çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚å¦å¤– C++ æ ‡å‡†åº“å¯èƒ½æ¯”ä½ æ›´æ¸…æ¥šç¡¬ä»¶çº¿ç¨‹çš„èµ„æºï¼Œå¯ä»¥å¾ˆå¥½çš„é¿å…è´Ÿè½½ä¸å‡è¡¡çš„é—®é¢˜ã€‚ å½“ç„¶ï¼ŒåŸºäºçº¿ç¨‹çš„æ–¹æ³•ä¹Ÿæœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼š éœ€è¦è®¿é—®å®ç°çº¿ç¨‹çš„åº•å±‚APIã€‚std::thread å¯ä»¥è·å–åº•å±‚çº¿ç¨‹çš„å¥æŸ„ï¼Œå¯ä»¥ä½¿ç”¨åº•å±‚çº¿ç¨‹çš„APIã€‚ éœ€è¦ä¼˜åŒ–çº¿ç¨‹çš„ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæœåŠ¡è½¯ä»¶ï¼Œè€Œè¿™ä¸ªè½¯ä»¶æ˜¯è¿™å°æœºå™¨ä¸Šæ‰§è¡Œçš„å”¯ä¸€æœ‰æ„ä¹‰çš„è¿›ç¨‹ï¼Œå¹¶ä¸”ä½ æ¸…æ¥šè¿™å°æœºå™¨çš„ç¡¬ä»¶é…ç½®ã€‚ éœ€è¦å®ç°ä¸€äº›é«˜çº§çš„çº¿ç¨‹æŠ€æœ¯ã€‚ä¾‹å¦‚çº¿ç¨‹æ± æŠ€æœ¯ï¼Œè€Œ C++ æ ‡å‡†åº“æ²¡æœ‰æä¾›ã€‚ é™¤äº†ä¸Šè¿°æƒ…å†µå¤–ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨åŸºäºä»»åŠ¡çš„ç¼–ç¨‹æ–¹æ³•ã€‚ æ€»ç»“ std::thread API ä¸èƒ½ç›´æ¥è®¿é—®å¼‚æ­¥å‡½æ•°æ‰§è¡Œçš„ç»“æœï¼Œå¦‚æœæ‰§è¡Œå‡½æ•°æœ‰å¼‚å¸¸æŠ›å‡ºï¼Œä»£ç ç»ˆæ­¢æ‰§è¡Œã€‚ åŸºäºçº¿ç¨‹çš„ç¼–ç¨‹æ–¹å¼å­˜åœ¨èµ„æºè€—å°½ã€è®¤è´­è¶…é¢ã€è´Ÿè½½å‡è¡¡çš„æ–¹æ¡ˆç§»æ¤æ€§ä¸ä½³ã€‚ é€šè¿‡ std::async çš„åŸºäºä»»åŠ¡çš„ç¼–ç¨‹æ–¹å¼ä¼šé»˜è®¤è§£å†³ä¸Šé¢çš„é—®é¢˜ã€‚ Item 36: Specify std::launch::async if asynchronicity is essential. å½“ä½ ä½¿ç”¨ std::async() æ‰§è¡Œä¸€ä¸ªå‡½æ•°æˆ–å¯è°ƒç”¨å¯¹è±¡æ—¶ï¼Œä½ é€šå¸¸æœŸæœ›è¿™ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥æ‰§è¡Œã€‚ä½†æ˜¯ï¼Œ std::async() ä¸ä¸€å®šå¦‚ä½ æ‰€æ„¿ã€‚å…¶å® std::async() æ˜¯æ ¹æ®æ‰§è¡Œç­–ç•¥å†³å®šæ˜¯å¦ä¼šå¼‚æ­¥æ‰§è¡Œã€‚ std::async() æœ‰ä¸¤ç§æ‰§è¡Œç­–ç•¥ï¼Œå®šä¹‰åœ¨ std::launch ä½œç”¨åŸŸä¸­ï¼š std::launch::async å‡½æ•°æˆ–å¯æ‰§è¡Œå¯¹è±¡å¿…é¡»å¼‚æ­¥æ‰§è¡Œï¼Œä¹Ÿå³è¿è¡Œåœ¨å…¶ä»–çº¿ç¨‹ä¸Šã€‚ std::launch::deferred å‡½æ•°æˆ–å¯æ‰§è¡Œå¯¹è±¡å»¶è¿Ÿæ‰§è¡Œã€‚ä»…åœ¨ std::async() çš„è¿”å›å¯¹è±¡ std::future è°ƒç”¨ get æˆ– wait æ—¶ï¼Œæ‰åœ¨å½“å‰çº¿ç¨‹åŒæ­¥æ‰§è¡Œï¼Œå¹¶ä¸”è°ƒç”¨è€…ä¼šé˜»å¡ç›´åˆ°å‡½æ•°æ‰§è¡Œå®Œæˆã€‚ std::async() çš„é»˜è®¤ç­–ç•¥å…¶å®æ˜¯äºŒè€…çš„ç»„åˆï¼Œä¹Ÿå³ä»¥ä¸‹ä¸¤è€…æ¶µä¹‰å®Œå…¨ç›¸åŒï¼š auto fut1 = std::async(f); // run f using default launch policy auto fut2 = std::async(std::launch::async | // run f either std::launch::deferred, // async or f); // deferred é»˜è®¤çš„ç­–ç•¥ä¸‹ï¼Œf å¯èƒ½æ˜¯åŒæ­¥æ‰§è¡Œä¹Ÿå¯èƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œã€‚æ­£å¦‚ Item 35: Prefer task-based programming to thread-based. ä¸­è®¨è®ºçš„ï¼šæ ‡å‡†åº“çš„çº¿ç¨‹ç®¡ç†æ¨¡å—æ‰¿æ‹…äº†çº¿ç¨‹çš„åˆ›å»ºå’Œé‡Šæ”¾çš„èŒè´£ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…è¶…é¢è®¢é˜…ã€ä¿è¯è´Ÿè½½å‡è¡¡ã€‚è¿™æå¤§åœ°æ–¹ä¾¿äº† std::async çš„ä½¿ç”¨ã€‚ ä½†æ˜¯ï¼Œé»˜è®¤ç­–ç•¥ä¹Ÿä¼šæœ‰å¦‚ä¸‹é—®é¢˜ï¼š æ— æ³•é¢„æµ‹ f æ˜¯å¦æ˜¯å¹¶å‘æ‰§è¡Œã€‚ æ— æ³•é¢„æµ‹ f æ˜¯å¦è¿è¡Œåœ¨ get æˆ– wait è°ƒç”¨æ—¶çš„çº¿ç¨‹ä¸Šã€‚ ç”šè‡³æ— æ³•é¢„æµ‹ f æ˜¯å¦å·²ç»æ‰§è¡Œäº†ã€‚å› ä¸ºæ²¡æ³•ä¿è¯ä¸€å®šä¼šè°ƒç”¨ get æˆ– waitã€‚ å½“ f è¦è®¿é—®æœ¬åœ°çº¿ç¨‹å­˜å‚¨ï¼ˆTLSï¼ŒThread Local Storageï¼‰æ—¶ï¼Œæ— æ³•é¢„æµ‹è®¿é—®çš„æ˜¯å“ªä¸ªçº¿ç¨‹çš„æœ¬åœ°å­˜å‚¨ã€‚ auto fut = std::async(f); // TLS for f possibly for // independent thread, but // possibly for thread // invoking get or wait on fut std::async çš„é»˜è®¤ç­–ç•¥è¿˜ä¼šå½±å“åˆ° wait_for è¶…æ—¶è°ƒç”¨å†™æ³•ï¼Œå¯èƒ½å¯¼è‡´ bugï¼Œä¾‹å¦‚ï¼š using namespace std::literals; // for C++14 duration suffixes; see Item 34 void f() // f sleeps for 1 second, then returns { std::this_thread::sleep_for(1s); } auto fut = std::async(f); // run f asynchronously (conceptually) while (fut.wait_for(100ms) != // loop until f has std::future_status::ready) // finished running... { // which may never happen! â€¦ } å¦‚æœ std::async æ˜¯å¹¶å‘æ‰§è¡Œï¼Œä¹Ÿå³æ‰§è¡Œç­–ç•¥ä¸º std::launch::asyncï¼Œä»¥ä¸Šä»£ç æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‰§è¡Œç­–ç•¥ä¸º std::launch::deferredæ—¶ï¼Œfut.wait_for æ€»æ˜¯è¿”å› future_status::deferredï¼Œä»¥ä¸Šä»£ç å°±ä¼šæœ‰é—®é¢˜ã€‚è§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œå…ˆé€šè¿‡ wait_for çš„è¶…æ—¶æ—¶é—´ä¸º 0 æ¥æ£€æµ‹ std::async æ˜¯å¼‚æ­¥æ‰§è¡Œè¿˜æ˜¯åŒæ­¥æ‰§è¡Œï¼š auto fut = std::async(f); // as above if (fut.wait_for(0s) == // if task is std::future_status::deferred) // deferred... { // ...use wait or get on fut â€¦ // to call f synchronously } else { // task isn't deferred while (fut.wait_for(100ms) != // infinite loop not std::future_status::ready) { // possible (assuming // f finishes) â€¦ // task is neither deferred nor ready, // so do concurrent work until it's ready } â€¦ // fut is ready } ç»¼ä¸Šï¼Œå¦‚æœä½ çš„ä½¿ç”¨åœºæ™¯ä¸æ˜¯ä»¥ä¸‹å‡ ç§ï¼Œåˆ™éœ€è¦è€ƒè™‘æ˜¯å¦éœ€è¦æ›¿æ¢ std::async çš„é»˜è®¤ç­–ç•¥ï¼š å½“è°ƒç”¨ get æˆ– wait æ—¶ï¼Œä»»åŠ¡ä¸éœ€è¦å¹¶å‘æ‰§è¡Œã€‚ å¹¶ä¸å…³å¿ƒè®¿é—®çš„æ˜¯å“ªä¸ªçº¿ç¨‹çš„æœ¬åœ°å­˜å‚¨ã€‚ å¯ä»¥ä¿è¯ get æˆ– wait ä¸€å®šä¼šè¢«è°ƒç”¨ï¼Œæˆ–è€…ä»»åŠ¡ä¸è¢«æ‰§è¡Œä¹Ÿèƒ½æ¥å—ã€‚ ä½¿ç”¨ wait_for æˆ– wait_until æ—¶ï¼Œéœ€è¦è€ƒè™‘ std::launch::deferred ç­–ç•¥ã€‚ å¦‚æœä¸æ˜¯ä»¥ä¸Šåœºæ™¯ï¼Œä½ å¯èƒ½éœ€è¦æŒ‡å®šä½¿ç”¨ std::launch::async ç­–ç•¥ï¼Œä¹Ÿå³çœŸæ­£åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼š aut","date":"2023-10-12","objectID":"/posts/effective_modern_c/:1:7","tags":["Effective Modern C++"],"title":"Effective Modern C++ é˜…è¯»ç¬”è®°","uri":"/posts/effective_modern_c/"},{"categories":["C++"],"content":"CH08: Tweaks Item 41: Consider pass by value for copyable parameters that are cheap to move and always copied. C++ å‡½æ•°å‚æ•°ä¼ é€’æ–¹å¼æœ‰å€¼ä¼ é€’ã€æŒ‡é’ˆä¼ é€’ã€å¼•ç”¨ä¼ é€’çš„æ–¹å¼ã€‚ä¸€èˆ¬åœ°ï¼Œè€ƒè™‘åˆ°æ‹·è´å¼€é”€ï¼Œå»ºè®®ä½¿ç”¨å¼•ç”¨ä¼ é€’çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼š class Widget { public: void addName(const std::string\u0026 newName) // take lvalue; { names.push_back(newName); } // copy it void addName(std::string\u0026\u0026 newName) // take rvalue; { names.push_back(std::move(newName)); } // move it; see ... // Item 25 for use // of std::move private: std::vector\u003cstd::string\u003e names; }; å¯¹äºå·¦å€¼ï¼Œæ‹·è´è¿› Widget.names ä¸­ã€‚å¯¹äºå³å€¼ï¼Œç§»åŠ¨è¿› Widget.namesã€‚ä¸Šé¢ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œä½†æ˜¯å®ç°å’Œç»´æŠ¤ä¸¤ä¸ªå‡½æ•°æœ‰ç‚¹å†—ä½™ã€‚ å¦ä¸€ç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨ä¸‡èƒ½å¼•ç”¨ï¼ˆuniversal referenceï¼‰ä¼ å‚ã€‚ä¾‹å¦‚ï¼š class Widget { public: template\u003ctypename T\u003e // take lvalues void addName(T\u0026\u0026 newName) // and rvalues; { // copy lvalues, names.push_back(std::forward\u003cT\u003e(newName)); // move rvalues; } // see Item 25 // for use of ... // std::forward }; ä¸‡èƒ½å¼•ç”¨ç‰ˆæœ¬ä»£ç é‡å‡å°‘äº†å¾ˆå¤šï¼Œçœ‹èµ·æ¥ä¹Ÿæ¸…çˆ½å¾ˆå¤šï¼Œä½†ä¹Ÿä¼šæœ‰å…¶ä»–é—®é¢˜ã€‚ä½†æ¨¡æ¿çš„å®ç°ä¸€èˆ¬è¦æ”¾åˆ°å¤´æ–‡ä»¶é‡Œï¼Œä¹Ÿä¼šå®ä¾‹åŒ–å‡ºå¤šä¸ªç‰ˆæœ¬ï¼ˆå·¦å€¼ç‰ˆæœ¬ã€å³å€¼ç‰ˆæœ¬ä»¥åŠå¯ä»¥è½¬æ¢ä¸º std::string çš„ç±»å‹ç‰ˆæœ¬ï¼‰ã€‚äºæ­¤åŒæ—¶ï¼Œè¿˜å­˜åœ¨è¯¸å¦‚ Item 30 ä»‹ç»ä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘å¤±æ•ˆçš„ä¾‹å­ã€Item 27 ä»‹ç»çš„ä¼ å‚é”™è¯¯æ—¶ç¼–è¯‘æŠ¥é”™å¯è¯»æ€§å¾ˆå·®çš„é—®é¢˜ã€‚ é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆå®Œç¾çš„æ–¹æ¡ˆå¯ä»¥è§£å†³ä¸Šè¿°ä¸¤ç§æ–¹æ¡ˆé‡åˆ°çš„é—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬æ¥åˆ†æä¸‹å€¼ä¼ é€’çš„æ–¹æ¡ˆã€‚ class Widget { public: void addName(std::string newName) // take lvalue or { names.push_back(std::move(newName)); } // rvalue; move it ... }; åœ¨ addName å†…å¯¹ newName ä½¿ç”¨ std::move å¯ä»¥å‡å°‘ä¸€æ¬¡æ‹·è´ã€‚è¿™é‡Œä½¿ç”¨ std::move è€ƒè™‘åˆ°ä¸¤ç‚¹ï¼šé¦–å…ˆï¼ŒnewName ç‹¬ç«‹äºä¼ å…¥çš„å‚æ•°ï¼Œä¸ä¼šå½±å“åˆ°è°ƒç”¨è€…ï¼›å†è€…ï¼Œè¿™é‡Œæ˜¯æœ€åä½¿ç”¨ newName çš„åœ°æ–¹ï¼Œå¯¹å…¶ç§»åŠ¨ä¸ä¼šå½±å“å…¶ä»–ä»£ç ã€‚ å€¼ä¼ é€’çš„æ–¹æ¡ˆå¯ä»¥è§£å†³å¼•ç”¨é‡è½½ç‰ˆæœ¬çš„æºç å†—ä½™é—®é¢˜å’Œä¸‡èƒ½å¼•ç”¨ç‰ˆæœ¬çš„ä¸é€‚ç”¨åœºæ™¯ã€ä¼ å‚é”™è¯¯æŠ¥é”™ä¿¡æ¯å¯è¯»æ€§ç­‰é—®é¢˜ï¼Œé‚£å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯å€¼ä¼ é€’æ–¹æ¡ˆçš„æ€§èƒ½äº†ã€‚ åœ¨ C++98 ä¸­ï¼Œå¯¹äºå€¼ä¼ é€’çš„æ–¹æ¡ˆï¼Œä¸ç®¡ä¼ å…¥çš„å·¦å€¼è¿˜æ˜¯å³å€¼ï¼ŒnewName éƒ½ä¼šé€šè¿‡æ‹·è´æ„é€ å‡½æ•°æ¥æ„é€ ã€‚è€Œåˆ°äº† C++11ï¼ŒnewName åœ¨ä¼ å…¥å·¦å€¼æ—¶æ˜¯æ‹·è´æ„é€ ï¼Œä¼ å…¥å³å€¼æ˜¯ç§»åŠ¨æ„é€ ã€‚è€ƒè™‘åˆ°ä¸‹é¢çš„ä»£ç ï¼š Widget w; ... std::string name(\"Bart\"); w.addName(name); // call addName with lvalue ... w.addName(name + \"Jenne\"); // call addName with rvalue // (see below) å¯¹äºç¬¬ä¸€ä¸ªè°ƒç”¨ï¼Œå‚æ•° newName ä½¿ç”¨å·¦å€¼åˆå§‹åŒ–ï¼Œæ˜¯æ‹·è´æ„é€ ã€‚å¯¹äºç¬¬äºŒä¸ªè°ƒç”¨ï¼Œå‚æ•° newName ä½¿ç”¨å³å€¼åˆå§‹åŒ–ï¼Œæ˜¯ç§»åŠ¨æ„é€ ã€‚ æˆ‘ä»¬æŠŠä¸Šè¿°ä¸‰ç§æ–¹æ¡ˆå†™åˆ°ä¸€èµ·å†å¯¹æ¯”ä¸‹æ€§èƒ½ï¼š class Widget { // Approach 1:overload for public: // lvalues and rvalues. void addName(const std::string\u0026 newName) // take lvalue; { names.push_back(newName); } // copy it void addName(std::string\u0026\u0026 newName) // take rvalue; { names.push_back(std::move(newName)); } // move it; see ... // Item 25 for use // of std::move private: std::vector\u003cstd::string\u003e names; }; class Widget { // Approach 2: use universal reference public: void addName(const std::string\u0026 newName) // take lvalue; { names.push_back(newName); } // copy it void addName(std::string\u0026\u0026 newName) // take rvalue; { names.push_back(std::move(newName)); } // move it; see ... // Item 25 for use // of std::move }; class Widget { // Approach 3: pass by value public: void addName(std::string newName) // take lvalue or { names.push_back(std::move(newName)); } // rvalue; move it ... }; åŒæ ·ï¼Œè€ƒè™‘ä¸Šé¢ä¸¤ç§è°ƒç”¨æ–¹å¼ï¼š Widget w; ... std::string name(\"Bart\"); w.addName(name); // call addName with lvalue ... w.addName(name + \"Jenne\"); // call addName with rvalue // (see below) è¿™é‡Œï¼Œæˆ‘ä»¬å¿½ç•¥æ‰ç¼–è¯‘å™¨æ ¹æ®ä¸Šä¸‹æ–‡ä¿¡æ¯æ‰€åšçš„ç¼–è¯‘ä¼˜åŒ–çš„å¹²æ‰°ï¼Œå¯¹æ¯”ä¸‹ä¸‰ç§æ–¹æ¡ˆçš„æ€§èƒ½å¼€é”€ï¼š å¼•ç”¨é‡è½½ï¼šé¦–å…ˆï¼Œæ— è®ºæ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼é‡è½½å‡½æ•°ï¼Œ è°ƒç”¨è€…çš„å®å‚æ˜¯è¢«ç»‘å®šåˆ°å¼•ç”¨ newNameä¸Šï¼Œæ²¡æœ‰æ‹·è´æˆ–ç§»åŠ¨å¼€é”€ã€‚å†è€…ï¼Œå¯¹äºå·¦å€¼å¼•ç”¨é‡è½½å‡½æ•°ï¼Œ newName è¢«æ‹·è´åˆ° Widget::names å†…ï¼Œè€Œå¯¹äºå³å€¼å¼•ç”¨é‡è½½å‡½æ•°ï¼ŒnewName è¢«ç§»åŠ¨åˆ° Widget::names å†…ã€‚æ€»çš„æ¥è¯´ï¼Œå·¦å€¼éœ€è¦ä¸€æ¬¡æ‹·è´ï¼Œå³å€¼éœ€è¦ä¸€æ¬¡ç§»åŠ¨ã€‚ ä¸‡èƒ½å¼•ç”¨ï¼šé¦–å…ˆï¼Œè°ƒç”¨è€…çš„å®å‚ä¹Ÿæ˜¯è¢«ç»‘å®šåˆ°å¼•ç”¨ newNameä¸Šï¼Œä¹Ÿæ²¡æœ‰æ‹·è´æˆ–ç§»åŠ¨å¼€é”€ã€‚å†è€…ï¼Œç”±äºä½¿ç”¨äº† std::forward ï¼Œå·¦å€¼å®å‚åˆ™è¢«æ‹·è´åˆ° Widget::names å†…ï¼Œè€Œå³å€¼å®å‚åˆ™è¢«ç§»åŠ¨åˆ° Widget::names å†…ã€‚æ€»çš„æ¥è¯´ï¼Œå·¦å€¼éœ€è¦ä¸€æ¬¡æ‹·è´ï¼Œå³å€¼éœ€è¦ä¸€æ¬¡ç§»åŠ¨ã€‚å¯¹äºè°ƒç”¨è€…ä¼ å…¥çš„å‚æ•°ä¸æ˜¯ std::string ç±»å‹ï¼Œè€Œæ˜¯å¯ä»¥è½¬æ¢ä¸º std::string çš„ç±»å‹ï¼Œæ¯”å¦‚ char* ç±»å‹ï¼Œå¯¹äºå¼•ç”¨é‡è½½ç‰ˆæœ¬ï¼Œéœ€è¦å…ˆå°† char* æ„é€ æˆ std::stringï¼Œè¿™ä¼šå¢åŠ å…¶å¼€é”€ï¼Œè€Œä¸‡èƒ½å¼•ç”¨ç‰ˆæœ¬åˆ™ç›´æ¥å°† char* è½¬å‘ç»™ std::string æ„é€ å‡½æ•°ç›´æ¥æ„é€  std::string ç±»å‹ï¼Œè¯¦è§ Item 25 ã€‚è¿™é‡Œä¸è€ƒè™‘è¿™ç§ç‰¹æ®Šæƒ…å†µã€‚ å€¼ä¼ é€’ï¼šé¦–å…ˆï¼Œå¯¹äºå·¦å€¼ï¼Œéœ€è¦è°ƒç”¨æ‹·è´æ„é€  newNameï¼Œè€Œå¯¹äºå³å€¼ï¼Œéœ€è¦ç§»åŠ¨æ„é€  newNameã€‚å†è€…ï¼Œ newName è¢«æ— æ¡ä»¶ç§»åŠ¨åˆ° Widget::names å†…ã€‚æ€»çš„æ¥è¯´ï¼Œå·¦å€¼éœ€è¦ä¸€æ¬¡æ‹·è´åŠ ä¸€æ¬¡ç§»åŠ¨ï¼Œå³å€¼éœ€è¦ä¸¤æ¬¡ç§»åŠ¨ã€‚ç›¸è¾ƒäºå‰ä¸¤ç§å¼•ç”¨ä¼ å‚çš„æ–¹æ³•ï¼Œå¤šäº†ä¸€æ¬¡ç§»åŠ¨æ“ä½œã€‚ å†å›å¤´çœ‹ä¸‹æœ¬ Item çš„æ ‡é¢˜ï¼š Consider pass by value for copyable parameters that are cheap to move and always copiedã€‚ç¼˜äºä»¥ä¸‹å››ä¸ªåŸå› ï¼š åªè€ƒè™‘å€¼ä¼ é€’çš„è¯ï¼Œåªéœ€è¦å†™ä¸€ä¸ªå‡½æ•°ï¼Œç›®æ ‡ä»£ç ä¸­ä¹Ÿä¼šç”Ÿæˆä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥é¿å…ä¸‡èƒ½å¼•ç”¨æ–¹æ³•çš„é—®é¢˜ã€‚ä½†æ˜¯å¼•å…¥äº†ä¸€ç‚¹æ€§èƒ½å¼€é”€ã€‚ åªå¯¹å¯æ‹·è´çš„å‚æ•°ä½¿ç”¨å€¼ä¼ é€’æ–¹æ³•ã€‚å¦‚æœå‚æ•°æ˜¯ move-only çš„ï¼Œé‚£å€¼ä¼ é€’çš„æ–¹æ³•è‚¯å®šä¼šå¤±è´¥ã€‚å¯¹äº move-only ç±»å‹å‚æ•°ï¼Œä¹Ÿæ— é¡»æä¾›å·¦å€¼å¼•ç”¨é‡è½½å‡½æ•°ï¼Œåªéœ€è¦ä¸€ä¸ªå³å€¼å¼•ç”¨çš„é‡è½½å‡½æ•°å³å¯ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¼ é€’ std::unique_ptr ç±»å‹å‚æ•°ï¼š class Widget { public: ... void setPtr(std::unique_ptr\u003cstd::string\u003e\u0026\u0026 ptr) { p = std::move(ptr); } private: std::unique_ptr\u003cstd::string\u003e p; }; ... Widget w; ... w.setPtr(std::make_unique\u003cstd::string\u003e(\"Modern C++\")); ä¸Šè¿°ä»£ç ï¼Œstd::make_unique\u003cstd::string\u003e(\"Modern C++\") äº§ç”Ÿä¸€ä¸ªå³å€¼ï¼Œ","date":"2023-10-12","objectID":"/posts/effective_modern_c/:1:8","tags":["Effective Modern C++"],"title":"Effective Modern C++ é˜…è¯»ç¬”è®°","uri":"/posts/effective_modern_c/"},{"categories":["C++"],"content":"å‰è¨€ Effective-STLæ€»ç»“ç³»åˆ—åˆ†ä¸ºä¸ƒéƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬å››éƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬å››ç« ï¼Œå†…å®¹èŒƒå›´Rule26~29ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule26ç®€å†™ä¸ºR26ã€‚ Effective-STLç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(å››) ","date":"2023-09-21","objectID":"/posts/effective_stl_part_four/:0:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [4] | è¿­ä»£å™¨","uri":"/posts/effective_stl_part_four/"},{"categories":["C++"],"content":"R26: iterator ä¼˜å…ˆäº const_interatorã€reverse_interator åŠ const_reverse_interator STLä¸­æ‰€æœ‰çš„æ ‡å‡†å®¹å™¨éƒ½æä¾›äº†4ç§è¿­ä»£å™¨ç±»å‹ï¼Œå¯¹å®¹å™¨ç±»containerè€Œè¨€ï¼Œiteratorç±»å‹ç›¸å½“äºT*ï¼Œconst_iteratorç›¸å½“äºconst T*ã€‚reverse_iteratorå’Œconst_reverse_iteratoré€’å¢çš„æ•ˆæœæ˜¯ä»å®¹å™¨çš„å°¾éƒ¨åå‘éå†åˆ°å¤´éƒ¨ã€‚ å¯¹äºvectorå®¹å™¨çš„insertå‡½æ•°å’Œeraseå‡½æ•°ï¼Œè¿™äº›å‡½æ•°åªæ¥å—iteratorç±»å‹çš„å‚æ•°ï¼Œè€Œä¸æ˜¯const_iteratorã€reverse_iteratoræˆ–è€…const_reverse_iteratorã€‚ä¸‹é¢è¿™å¼ å›¾å±•ç¤ºäº†ä¸åŒç±»å‹è¿­ä»£å™¨ä¹‹é—´çš„å…³ç³»ã€‚é»‘è‰²ç®­å¤´ï¼Œå¹¶ä¸”ä¸Šé¢æœªæ ‡å‡½æ•°çš„è¡¨ç¤ºéšå¼ç±»å‹è½¬æ¢ï¼Œæ ‡å‡½æ•°çš„è¡¨ç¤ºæ˜¾ç¤ºç±»å‹è½¬æ¢ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡base()å¾—åˆ°çš„è¿­ä»£å™¨æˆ–è®¸å¹¶éæ˜¯ä½ æœŸæœ›çš„è¿­ä»£å™¨ç±»å‹ã€‚ä¹Ÿå¯ä»¥çœ‹å‡ºæƒ³éšå¼è½¬æ¢const_iteratoråˆ°iteratoræ˜¯ä¸å¯è¡Œçš„ã€‚ä»reverse_iteratorè½¬æ¢æ¥çš„iteratoråœ¨ä½¿ç”¨ä¹‹å‰å¯èƒ½éœ€è¦è¿›è¡Œç›¸åº”çš„è°ƒæ•´ï¼Œæ¡æ¬¾28å°†æ›´è¯¦ç»†åœ°è¯´æ˜è¿™ä¸€ç‚¹ã€‚ç”±æ­¤å¯è§ï¼Œå°½é‡ä½¿ç”¨iteratorï¼Œè€Œä¸æ˜¯constæˆ–reverseå‹çš„è¿­ä»£å™¨ï¼Œå¯ä»¥ä½¿å®¹å™¨çš„ä½¿ç”¨æ›´ä¸ºç®€å•æœ‰æ•ˆï¼Œå¹¶ä¸”å¯ä»¥é¿å…æ½œåœ¨çš„é—®é¢˜ã€‚ ä¸åŒç±»å‹çš„è¿­ä»£å™¨ä¹‹é—´çš„å…³ç³»: å‡è®¾æœ‰ä¸ªiterator iå’Œä¸€ä¸ªconst_iterator ciæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯åœ¨æ¯”è¾ƒè¿™ä¸¤ä¸ªè¿­ä»£å™¨æ—¶ï¼Œå³if(i == ci)çš„ç»“æœå´æ˜¯å‡ï¼Œç”šè‡³ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºè¿™äº›STLå®ç°å°†const_iteratorçš„operator==ä½œä¸ºæˆå‘˜å‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªéæˆå‘˜å‡½æ•°ï¼Œciä¸èƒ½éšå¼è½¬æˆiï¼Œä½†æ˜¯iå¯ä»¥éšå¼è½¬æˆciï¼Œæ‰€ä»¥åˆ¤æ–­if(ci == i)æ˜¯çœŸã€‚é¿å…è¿™ç§é—®é¢˜æœ€ç®€å•çš„åŠæ³•æ˜¯å‡å°‘æ··ç”¨ä¸åŒç±»å‹çš„è¿­ä»£å™¨ï¼Œå°½é‡ä½¿ç”¨iteratoræ¥ä»£æ›¿const_iteratorã€‚ ","date":"2023-09-21","objectID":"/posts/effective_stl_part_four/:1:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [4] | è¿­ä»£å™¨","uri":"/posts/effective_stl_part_four/"},{"categories":["C++"],"content":"R27: ä½¿ç”¨ distance å’Œ advance å°†å®¹å™¨çš„ const_interator è½¬æ¢æˆ iterator é¦–å…ˆè€ƒè™‘ç±»å‹è½¬æ¢è¾¾åˆ°è¯¥æ¡æ¬¾çš„ç›®çš„ï¼ŒåŒ…æ‹¬ä¸¤ç§ä»£ç ï¼ŒIter i(ci);å’ŒIter i(const_cast(ci));ï¼Œè¿™ä¸¤ç§ä»£ç éƒ½ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼ŒåŸå› åœ¨äºiteratorå’Œconst_iteratoræ˜¯å®Œå…¨ä¸åŒçš„ä¸¤ä¸ªç±»ï¼Œç›¸å½“äºintå’Œcomplexä¹‹é—´äº’è½¬ï¼Œå½“ç„¶ä¸å¯èƒ½æˆåŠŸã€‚ä¸è¿‡å¯¹äºvectorå’Œstringæ¥è¯´ï¼Œä¸Šé¢çš„ä»£ç å¯èƒ½é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºå¤§å¤šæ•°STLå°†vector::iteratorå’Œvector::const_iteratoråˆ†åˆ«å®šä¹‰ä¸ºTå’Œconst Tï¼Œstring::iteratorå’Œstring::const_iteratorå®šä¹‰ä¸ºcharå’Œconst charï¼Œå› æ­¤å¯¹äºè¿™ä¸¤ä¸ªå®¹å™¨å¼ºè½¬å¯èƒ½æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯å³ä½¿åœ¨è¿™ä¸¤ä¸ªå®¹å™¨ç§ï¼Œreverse_iteratorå’Œconst_reverse_iteratorä»ç„¶æ˜¯ä¸¤ä¸ªç±»ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯ä¸èƒ½å¼ºè½¬çš„ã€‚ å¯ä»¥é€šè¿‡distanceå‡½æ•°è¿›è¡Œè½¬æ¢ï¼Œä»£ç å¦‚ä¸‹ï¼š typedef deque\u003cint\u003e IntDeque; typedef IntDeque::iterator Iter; typedef IntDeque::const_iterator ConstIter; IntDeque d; ConstIter ci; Iter i(d.begin()); advance(i, distance(i, ci));//ç›®å‰ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯æ€æƒ³æ˜¯é€šè¿‡distanceè®¡ç®—å‡ºciå’Œbeginä¹‹é—´çš„è·ç¦»ï¼Œç„¶åç§»åŠ¨è¿™ä¹ˆå¤šè·ç¦» ä¸Šé¢è¿™ä¸ªç¨‹åºä¸èƒ½é€šè¿‡ç¼–è¯‘çš„åŸå› æ˜¯distanceå‡½æ•°åªèƒ½æ¥å—ä¸€ç§ç±»å‹çš„è¿­ä»£å™¨ï¼Œè€Œiå’Œciæ˜¯ä¸¤ç§ä¸åŒçš„è¿­ä»£å™¨ã€‚è¦é€šè¿‡ç¼–è¯‘æœ€ç®€å•çš„æ–¹æ³•æ˜¯æ˜¾ç¤ºæŒ‡å®šdistanceä½¿ç”¨çš„ç±»å‹ï¼Œå³advance(i, distance(i, ci));é™¤äº†è¾¾æˆæ•ˆç‡ï¼Œå†è€ƒè™‘è¿™ä¹ˆåšçš„æ•ˆç‡å¦‚ä½•ï¼Œå®ƒçš„æ‰§è¡Œæ•ˆç‡å–å†³äºä½ ä½¿ç”¨çš„è¿­ä»£å™¨ï¼Œå¯¹äºéšæœºè®¿é—®è¿­ä»£å™¨ï¼ˆvectorã€stringå’Œdequeï¼‰ï¼Œå®ƒæ˜¯å¸¸æ•°æ—¶é—´æ“ä½œï¼Œå¯¹äºåŒå‘è¿­ä»£å™¨ï¼ˆå…¶ä»–æ‰€æœ‰ï¼‰ï¼Œå®ƒæ˜¯çº¿æ€§æ—¶é—´æ“ä½œã€‚ ","date":"2023-09-21","objectID":"/posts/effective_stl_part_four/:2:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [4] | è¿­ä»£å™¨","uri":"/posts/effective_stl_part_four/"},{"categories":["C++"],"content":"R28: æ­£ç¡®ç†è§£ç”±reverse_iteratorçš„base()æˆå‘˜å‡½æ•°æ‰€äº§ç”Ÿçš„iteratorçš„ç”¨æ³• å‡è®¾é€šè¿‡reverse_iteratoræŸ¥æ‰¾å®¹å™¨ä¸­å€¼ä¸º3çš„å…ƒç´ ï¼Œriè¡¨ç¤º3çš„ä½ç½®ï¼Œä½†æ˜¯åœ¨è°ƒç”¨base()å‡½æ•°å°†å…¶è½¬æ¢æˆiteratorç±»å‹æ—¶ï¼Œå› ä¸ºåç§»å˜æˆiæ‰€æŒ‡å‘çš„ä½ç½®ã€‚å‡è®¾è¦åœ¨riçš„ä½ç½®æ’å…¥æ–°å…ƒç´ ï¼Œæˆ‘ä»¬é¢„æœŸæ–°å…ƒç´ ä¼šæ’å…¥åœ¨ç°åœ¨å…ƒç´ 3çš„ä½ç½®ï¼Œç„¶å3å’Œå…¶åçš„å…ƒç´ éœ€è¦å¾€å³ç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼Œä½†æ˜¯å› ä¸ºinsertä¼šå°†æ–°å…ƒç´ æ’å…¥åˆ°è¿­ä»£å™¨æŒ‡å‘ä½ç½®çš„å‰é¢ï¼Œè€Œé€†åºéå†çš„é¡ºåºæ˜¯ç”±åå‘å‰çš„ï¼Œæ‰€ä»¥ä¼šå°†æ–°å…ƒç´ æ’å…¥åœ¨3çš„â€œåé¢â€ï¼Œå®é™…å¯¹reverse_iteratoræ¥è¯´å°±æ˜¯â€œå‰é¢â€ã€‚æ‰€ä»¥å¦‚æœæ˜¯åœ¨reverse_iteratorç±»å‹riä½ç½®æ’å…¥ï¼Œåªéœ€è¦åœ¨ir.base()ä½ç½®æ’å…¥å³å¯ã€‚ä½†æ˜¯å¦‚æœæ˜¯åœ¨riä½ç½®åˆ é™¤å…ƒç´ ï¼Œåˆ™éœ€è¦åœ¨ri.base()ä½ç½®å‰é¢çš„ä½ç½®æ‰§è¡Œåˆ é™¤ã€‚ä½†æ˜¯å…¶ä¸­è¿˜æ˜¯æœ‰å‘ï¼Œè¯·çœ‹å¦‚ä¸‹ä»£ç ï¼š //è¿™æ®µä»£ç é€šä¸è¿‡ç¼–è¯‘ vector\u003cint\u003e v; vector\u003cint\u003e::reverse_iterator ri = find(v.rbegin(), v.rend(), 3); v.erase(--ri.base());//iteratorçš„--æ˜¯å·¦ç§»ï¼Œreverse_iteratorçš„--æ˜¯å³ç§» è¿™æ®µä»£ç å¯¹äºvectorå’Œstringä¸èƒ½é€šè¿‡ç¼–è¯‘çš„åŸå› åœ¨äºï¼Œè¿™ä¸¤ç§å®¹å™¨çš„iteratorå’Œconst_iteratoræ˜¯ä»¥å†…ç½®æŒ‡é’ˆçš„æ–¹å¼å®ç°çš„ï¼Œæ‰€ä»¥ri.base()çš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè€ŒCå’ŒC++éƒ½è§„å®šäº†ä»å‡½æ•°è¿”å›çš„æŒ‡é’ˆä¸åº”è¯¥è¢«ä¿®æ”¹ã€‚æ‰€ä»¥å¿…é¡»æ¢ä¸ªè°ƒç”¨æ–¹å¼ï¼šv.erase((++ri).base());ï¼Œå…ˆè®©riå·¦ç§»å†å–æŒ‡é’ˆã€‚ ","date":"2023-09-21","objectID":"/posts/effective_stl_part_four/:3:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [4] | è¿­ä»£å™¨","uri":"/posts/effective_stl_part_four/"},{"categories":["C++"],"content":"R29: å¯¹äºé€ä¸ªå­—ç¬¦çš„è¾“å…¥è¯·è€ƒè™‘ä½¿ç”¨istreambuf::iterator å‡è®¾ä½ æƒ³å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­çš„å†…å®¹æ‹·è´åˆ°ä¸€ä¸ªstringå¯¹è±¡ä¸­ï¼Œè€ƒè™‘å¦‚ä¸‹çš„å®ç°æ–¹å¼ï¼š ifstream inputFile(\"inputData.txt\"); string fileData((istream_iterator\u003cchar\u003e(inputFile)), istream_iterator\u003cchar\u003e());//æ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ‹¬å·åŒ…èµ·æ¥ ä½†æ˜¯è¿™ç§è¯»å–æ–¹å¼æ˜¯ä¸åŒ…å«ç©ºç™½å­—ç¬¦çš„ï¼Œå› ä¸ºistream_iteratorä½¿ç”¨operatorÂ»å®Œæˆè¯»æ“ä½œï¼Œè€Œé»˜è®¤æƒ…å†µä¸‹operatorÂ»ä¼šè·³è¿‡ç©ºç™½å­—ç¬¦ï¼Œå‡å®šä½ è¦ä¿ç•™ç©ºç™½å­—ç¬¦ï¼Œå¯ä»¥æ›´æ”¹è¿™ç§é»˜è®¤è¡Œä¸ºï¼Œå¦‚ä¸‹ä»£ç : ifstream inputFile(\"inputData.txt\"); inputFile.unsetf(ios::skipws); string fileData((istream_iterator\u003cchar\u003e(inputFile)), istream_iterator\u003cchar\u003e());//æ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ‹¬å·åŒ…èµ·æ¥ ä¸Šè¿°ä»£ç æ˜¯å¯ä»¥å®Œæˆè¦æ±‚çš„åŠŸèƒ½çš„ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°å®ƒå¹¶ä¸å¤Ÿå¿«ï¼Œistream_iteratorå†…éƒ¨ä½¿ç”¨çš„operatorÂ»å®é™…ä¸Šæ‰§è¡Œäº†æ ¼å¼åŒ–è¾“å‡ºï¼Œè¿™æ„å‘³ç€æ¯æ¬¡è°ƒç”¨operatorÂ»æ“ä½œç¬¦ï¼Œéƒ½ä¼šæ‰§è¡Œè®¸å¤šé™„åŠ çš„æ“ä½œã€‚ä¸€ç§æ›´ä¸ºæœ‰æ•ˆçš„é€”å¾„æ˜¯ä½¿ç”¨istreambuf_iteratorï¼Œistreambuf_iteratorçš„ä½¿ç”¨æ–¹æ³•ä¸istream_iteratorå¤§è‡´ç›¸åŒï¼Œä½†æ˜¯istream_iteratorä½¿ç”¨operatorÂ»ä»è¾“å…¥æµä¸­è¯»å–å•ä¸ªå­—ç¬¦ï¼Œè€Œistreambuf_iteratorä»ä¸€ä¸ªè¾“å…¥æµçš„ç¼“å†²åŒºè¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ä½¿ç”¨çš„ä»£ç å°±æ˜¯å°†istream_iteratoræ”¹æˆistreambuf_iteratorã€‚ ifstream inputFile(\"inputData.txt\"); string fileData((istreambuf_iterator\u003cchar\u003e(inputFile)), istreambuf_iterator\u003cchar\u003e());//æ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ‹¬å·åŒ…èµ·æ¥ åŒæ ·å¯¹äºéæ ¼å¼åŒ–çš„é€ä¸ªå­—ç¬¦çš„è¾“å‡ºï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨ostreambuf_iteratoræ›¿æ¢ostream_iteratorã€‚ ref: [1]. https://www.cnblogs.com/Sherry4869/p/15128250.html [2]. https://blog.csdn.net/zhuikefeng/article/details/108164117#t42 [3]. https://zhuanlan.zhihu.com/p/458156007 ","date":"2023-09-21","objectID":"/posts/effective_stl_part_four/:4:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [4] | è¿­ä»£å™¨","uri":"/posts/effective_stl_part_four/"},{"categories":["C++"],"content":"å‰è¨€ Effective-STLæ€»ç»“ç³»åˆ—åˆ†ä¸ºä¸ƒéƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬ä¸€éƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬ä¸€ç« ï¼Œå†…å®¹èŒƒå›´Rule01~12ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule12ç®€å†™ä¸ºR12ã€‚ Effective-STLç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(å››) ","date":"2023-09-15","objectID":"/posts/effective_stl_part_three/:0:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [3] | å…³è”å®¹å™¨","uri":"/posts/effective_stl_part_three/"},{"categories":["C++"],"content":"R19: ç†è§£ç›¸ç­‰ï¼ˆequalityï¼‰å’Œç­‰ä»·ï¼ˆequivalenceï¼‰çš„åŒºåˆ« findç®—æ³•å’Œsetçš„insertæˆå‘˜å‡½æ•°éƒ½éœ€è¦æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒï¼Œfindè¿”å›æŒ‡å®šå…ƒç´ ä½ç½®çš„è¿­ä»£å™¨ï¼Œset::insertéœ€è¦åœ¨æ’å…¥å‰ç¡®å®šå…ƒç´ æ˜¯å¦å·²ç»å­˜åœ¨äºsetä¸­äº†ã€‚ä½†æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯ä¸åŒçš„æ–¹æ³•åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒã€‚findå¯¹ç›¸åŒçš„å®šä¹‰æ˜¯ç›¸ç­‰ï¼ŒåŸºäºoperator==ï¼Œset::insertå¯¹ç›¸åŒçš„å®šä¹‰æ˜¯ç­‰ä»·ï¼ŒåŸºäºoperator\u003cã€‚ä½†æ˜¯ç›¸ç­‰ä¹Ÿä¸ä¸€å®šæ„å‘³ç€å¯¹è±¡çš„æ‰€æœ‰æˆå‘˜éƒ½ç›¸ç­‰ï¼Œå› ä¸ºå¯ä»¥é‡å†™operator==ï¼Œåˆ¶å®šæˆ‘ä»¬è‡ªå·±çš„ç›¸ç­‰ã€‚ç­‰ä»·æ˜¯ä»¥åœ¨å·²æ’åºåŒºé—´ä¸­å¯¹è±¡å€¼çš„ç›¸å¯¹é¡ºåºä¸ºåŸºç¡€çš„ï¼Œå¯¹äºä¸¤ä¸ªå…³è”å®¹å™¨çš„å¯¹è±¡xå’Œyï¼Œå¦‚æœå®ƒä»¬éƒ½ä¸åœ¨å¦ä¸€ä¸ªçš„å‰é¢ï¼Œé‚£ä¹ˆç§°è¿™ä¸¤ä¸ªå¯¹è±¡å…·æœ‰ç­‰ä»·çš„å€¼ï¼Œå³!(x \u003c y) \u0026\u0026 !(y \u003c x)æˆç«‹ã€‚ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå…³è”å®¹å™¨çš„æ¯”è¾ƒå‡½æ•°å¹¶ä¸æ˜¯operator\u003cï¼Œç”šè‡³ä¸æ˜¯lessï¼Œå®ƒæ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„åˆ¤åˆ«å¼ã€‚æ¯ä¸ªå…³è”å®¹å™¨éƒ½é€šè¿‡key_compæˆå‘˜å‡½æ•°ä½¿æ’åºåˆ¤åˆ«å¼å¯è¢«å¤–ç•Œä½¿ç”¨ï¼Œæ‰€ä»¥æ›´ä¸€èˆ¬çš„ç­‰ä»·æ˜¯ !c.key_comp() (x, y) \u0026\u0026 !c.key_comp() (y, x)æˆç«‹ï¼Œkey_comp()è¿”å›ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ã€‚ ä¸ºäº†è¿›ä¸€æ­¥ç†è§£ç›¸ç­‰å’Œç­‰ä»·çš„åŒºåˆ«ï¼Œè€ƒè™‘è¿™æ ·ä¸€ä¸ªä¸åŒºåˆ†å¤§å°å†™çš„setï¼Œå®ƒè®¤ä¸ºSTLå’Œstlæ˜¯ç­‰ä»·çš„ï¼Œä¸‹é¢æ˜¯å®ç°ï¼š struct CIStringCompare : public binary_function\u003cstring, string, bool\u003e{//è¯¥åŸºç±»ä¿¡æ¯å‚è€ƒæ¡æ¬¾40 bool operator()(const string\u0026 lhs, const string\u0026 rhs) const{ return ciStringCompare(lhs, rhs);//ä¸åŒºåˆ†å¤§å°å†™çš„å‡½æ•°å¯¹è±¡ï¼Œå…·ä½“å®ç°å‚è€ƒæ¡æ¬¾35 } } set\u003cstring, CIStringCompare\u003e ciss; cisså°±æ˜¯ä¸€ä¸ªä¸åŒºåˆ†å¤§å°å†™çš„é›†åˆï¼Œå¦‚æœåœ¨setä¸­æ’å…¥STLå’Œstlï¼Œåªæœ‰ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ä¼šè¢«æ’å…¥ï¼Œå› ä¸ºç¬¬äºŒä¸ªå’Œç¬¬ä¸€ä¸ªç­‰ä»·ã€‚å¦‚æœä½¿ç”¨setçš„findæˆå‘˜å‡½æ•°æŸ¥æ‰¾stlï¼Œæ˜¯å¯ä»¥æŸ¥æ‰¾æˆåŠŸçš„ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨éæˆå‘˜çš„findç®—æ³•å°±ä¼šæŸ¥æ‰¾å¤±è´¥ï¼Œå› ä¸ºSTLå’Œstlå¹¶ä¸ç›¸ç­‰ã€‚è¿™ä¸ªä¾‹å­ä¹Ÿå°è¯äº†æ¡æ¬¾44ä¸­çš„ï¼Œä¼˜å…ˆä½¿ç”¨æˆå‘˜å‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸ä¹‹å¯¹åº”çš„éæˆå‘˜å‡½æ•°ç®—æ³•ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆå…³è”å®¹å™¨è¦ä½¿ç”¨ç­‰ä»·ï¼Œè€Œä¸æ˜¯ç›¸ç­‰å‘¢ï¼Ÿæ ‡å‡†å®¹å™¨æ€»æ˜¯ä¿æŒæ’åˆ—é¡ºåºçš„ï¼Œæ‰€ä»¥æ¯ä¸ªå®¹å™¨å¿…é¡»æœ‰ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ï¼ˆé»˜è®¤æ˜¯lessï¼‰ï¼Œå¦‚æœå…³è”å®¹å™¨ä½¿ç”¨ç›¸ç­‰æ¥å†³å®šä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒçš„è¯ï¼Œæ„å‘³ç€è¦æä¾›å¦ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°æ¥åˆ¤æ–­ç›¸ç­‰ã€‚åŒæ ·æ˜¯é‚£ä¸ªä¸åŒºåˆ†å¤§å°å†™çš„ä¾‹å­ï¼ŒSTLå’Œstlå› ä¸ºä¸ç›¸ç­‰ï¼Œæ‰€ä»¥éƒ½ä¼šè¢«æ’å…¥åˆ°setä¸­ï¼Œä½†æ˜¯å®ƒä»¬ä¹‹é—´çš„é¡ºåºæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæ’åºæ˜¯ç”¨çš„lessï¼Œæ‰€ä»¥ä¹‹é—´çš„é¡ºåºæ˜¯åˆ¤æ–­ä¸äº†çš„ã€‚ ","date":"2023-09-15","objectID":"/posts/effective_stl_part_three/:1:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [3] | å…³è”å®¹å™¨","uri":"/posts/effective_stl_part_three/"},{"categories":["C++"],"content":"R20: ä¸ºåŒ…å«æŒ‡é’ˆçš„å…³è”å®¹å™¨æŒ‡å®šæ¯”è¾ƒç±»å‹ å‡å®šæœ‰ä¸€ä¸ªåŒ…å«string*æŒ‡é’ˆçš„setï¼Œä½ å°†ä¸€äº›å­—ç¬¦ä¸²æŒ‡é’ˆæ”¾å…¥å…¶ä¸­ï¼Œä½ å¯èƒ½æœŸæœ›setä¼šæŒ‰ç…§å­—ç¬¦ä¸²çš„å­—æ¯é¡ºåºæ¥æ’åºï¼Œå®åˆ™ä¸ç„¶ã€‚å¦‚æœæƒ³è¦æŒ‰ç…§æœŸæœ›çš„å½¢å¼è¾“å‡ºï¼Œå°±å¿…é¡»ç¼–å†™æ¯”è¾ƒå‡½æ•°å­ç±»ã€‚ struct stringPtrLess : public binary_function\u003cconst string*, const string*, bool\u003e { bool operator()(const string* ps1, const string* ps2) const { return *ps1 \u003c *ps2; } } typedef set\u003cstring*, stringPtrLess\u003e stringPtrSet; stringPtrSet sps; void print(const string* ps){ cout \u003c\u003c *ps \u003c\u003c endl; } for_each(sps.begin(), sps.end(), print);//å¯¹spsçš„æ¯ä¸ªå¯¹è±¡è°ƒç”¨print è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯setæ¨¡æ¿çš„ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯ä¸€ä¸ªç±»å‹ï¼Œæ‰€ä»¥ç»™å‚æ•°ä¼ é€’ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°æ˜¯ä¸è¡Œçš„ï¼Œæ— æ³•é€šè¿‡ç¼–è¯‘ã€‚setä¸éœ€è¦å‡½æ•°ï¼Œå®ƒéœ€è¦ä¸€ä¸ªç±»å‹ï¼Œåœ¨å†…éƒ¨ç”¨å®ƒåˆ›å»ºå‡½æ•°ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä»£ç æ˜¯ä¸èƒ½é€šè¿‡ç¼–è¯‘çš„ã€‚ bool stringPtrLess(const string* ps1, const string* ps2) const { return *ps1 \u003c *ps2; } typedef set\u003cstring*, stringPtrLess\u003e stringPtrSet;//ä¸èƒ½é€šè¿‡ç¼–è¯‘ stringPtrSet sps; æ¯å½“åˆ›å»ºåŒ…å«æŒ‡é’ˆçš„å…³è”å®¹å™¨æ—¶ï¼Œä¸€èˆ¬åŒæ—¶éœ€è¦æŒ‡å®šå®¹å™¨çš„æ¯”è¾ƒç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥å‡†å¤‡ä¸€ä¸ªæ¨¡æ¿æ¯”è¾ƒå‡½æ•°ã€‚ struct dereferenceLess{ template \u003ctypename PtrType\u003e bool operator()(PtrType pt1, PtrType pt2) const{ return *pt1 \u003c *pt2; } } set\u003cstring*, dereferenceLess\u003e sps; æœ€åä¸€ä»¶äº‹ï¼Œæœ¬æ¡æ¬¾æ˜¯å…³äºå…³è”å®¹å™¨çš„ï¼Œä½†å®ƒä¹ŸåŒæ ·é€‚ç”¨äºå…¶ä»–ä¸€äº›å®¹å™¨ï¼Œè¿™äº›å®¹å™¨åŒ…å«æŒ‡é’ˆï¼Œæ™ºèƒ½æŒ‡é’ˆæˆ–è¿­ä»£å™¨ï¼Œé‚£ä¹ˆåŒæ ·éœ€è¦ä¸ºè¿™äº›å®¹å™¨æŒ‡å®šä¸€ä¸ªæ¯”è¾ƒç±»å‹ã€‚ ","date":"2023-09-15","objectID":"/posts/effective_stl_part_three/:2:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [3] | å…³è”å®¹å™¨","uri":"/posts/effective_stl_part_three/"},{"categories":["C++"],"content":"R21: æ€»æ˜¯è®©æ¯”è¾ƒå‡½æ•°åœ¨ç­‰å€¼æƒ…å†µä¸‹è¿”å›false çœ‹ä¸€ä¸ªä¾‹å­ï¼Œset\u003cint, less_equal \u003e s;å…¶ä¸­less_equalæ˜¯æŒ‡å®šçš„æ¯”è¾ƒç±»å‹ï¼Œç›¸å½“äº\u003c=ã€‚å½“æ‰§è¡Œs.insert(10);ï¼Œå®¹å™¨ä¸­æœ‰ä¸€ä¸ª10çš„å…ƒç´ äº†ï¼Œç„¶åå†æ‰§è¡Œä¸€æ¬¡s.insert(10);ï¼Œå®¹å™¨ä¼šå…ˆåˆ¤æ–­å†…éƒ¨æœ‰æ²¡æœ‰å’Œ10ç­‰ä»·çš„å…ƒç´ ï¼Œå³è°ƒç”¨åˆ¤æ–­ !(10 \u003c= 10) \u0026\u0026 !(10 \u003c= 10)ï¼Œ \u0026\u0026ä¸¤è¾¹éƒ½æ˜¯falseï¼Œæ‰€ä»¥ç»“æœä¹Ÿæ˜¯falseï¼Œæ„æ€ä¸ºå®¹å™¨ä¸­æ²¡æœ‰ä¸å½“å‰å¾…æ’å…¥å…ƒç´ ç­‰ä»·çš„å…ƒç´ ï¼çœ‹å‡ºé—®é¢˜äº†å§ï¼Ÿç›¸ç­‰å´ä¸ç­‰ä»·ã€‚å½“ç¬¬äºŒä¸ª10è¢«æ’å…¥åˆ°setä¸­ï¼Œæ„å‘³ç€setä¸æ˜¯ä¸€ä¸ªsetäº†ï¼Œå°±ç ´åäº†è¿™ä¸ªå®¹å™¨ã€‚æ‰€ä»¥ä¸€å®šè¦ä¿è¯å¯¹å…³è”å®¹å™¨é€‚ç”¨çš„æ¯”è¾ƒå‡½æ•°æ€»æ˜¯å¯¹ç›¸ç­‰å€¼è¿”å›falseã€‚ å†çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå°±æ˜¯æ¡æ¬¾20ä¸­çš„stringPtrLessæ¯”è¾ƒç±»å‹ï¼Œå®ç°çš„æ˜¯string*æŒ‰ç…§å­—æ¯å‡åºæ’åˆ—ï¼ŒåŠ å…¥æˆ‘ä»¬å¸Œæœ›æŒ‰ç…§å­—å¹•é™åºæ’åºï¼Œå¯ä»¥ç›´æ¥å°†å®ƒçš„åˆ¤æ–­ç½®åå—ï¼Ÿä¸å¯ä»¥ï¼å°†åˆ¤æ–­ç›´æ¥ç½®åå¾—åˆ°çš„æ–°åˆ¤æ–­æ˜¯\u003e=ï¼Œè€Œä¸æ˜¯\u003eã€‚ struct stringPtrLess : public binary_function\u003cconst string*, const string*, bool\u003e { bool operator()(const string* ps1, const string* ps2) const { return !(*ps1 \u003c *ps2);//è¿™æ˜¯é”™è¯¯æ¼”ç¤º } } ","date":"2023-09-15","objectID":"/posts/effective_stl_part_three/:3:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [3] | å…³è”å®¹å™¨","uri":"/posts/effective_stl_part_three/"},{"categories":["C++"],"content":"R22: åˆ‡å‹¿ç›´æ¥ä¿®æ”¹setæˆ–multisetä¸­çš„é”® æ‰€æœ‰çš„å…³è”å®¹å™¨éƒ½ä¼šæŒ‰ç…§ä¸€å®šé¡ºåºå­˜å‚¨è‡ªå·±çš„å…ƒç´ ï¼Œå¦‚æœæ”¹å˜äº†å…³è”å®¹å™¨çš„å…ƒç´ çš„é”®ï¼Œé‚£ä¹ˆæ–°çš„é”®å¯èƒ½ä¸åœ¨åŸæ¥çš„ä½ç½®ä¸Šï¼Œè¿™å°±ä¼šæ‰“ç ´å®¹å™¨çš„æœ‰åºæ€§ã€‚å¯¹äºmapå’Œmultimapå¾ˆç®€å•ï¼Œå› ä¸ºé”®çš„ç±»å‹æ˜¯constçš„ï¼Œä½†æ˜¯setå’Œmultisetä¸­çš„å…ƒç´ å´ä¸æ˜¯constçš„ã€‚é¦–å…ˆè€ƒè™‘ä¸€ä¸‹ä¸ºä»€ä¹ˆsetä¸­çš„å…ƒç´ ä¸èƒ½æ˜¯constçš„ï¼ŒåŠ å…¥æœ‰ä¸€ä¸ªé›‡å‘˜ç±»ï¼Œå…¶ä¸­æœ‰idå’Œsalaryä¸¤ä¸ªæˆå‘˜ï¼Œsetæ˜¯æŒ‰ç…§idçš„é¡ºåºè¿›è¡Œæ’åºçš„ï¼Œæ‰€ä»¥æ›´æ”¹salaryä¸ä¼šå½±å“é›‡å‘˜å¯¹è±¡çš„ä½ç½®ï¼Œæ­£å› ä¸ºå¯ä»¥æ›´æ”¹é›‡å‘˜å¯¹è±¡ï¼Œè¿™æ„å‘³ç€setä¸­å­˜å‚¨çš„å¯¹è±¡ä¸èƒ½æ˜¯constçš„ã€‚æ­£å› ä¸ºæ›´æ”¹setä¸­çš„å…ƒç´ æ˜¯å¦‚æ­¤ç®€å•ï¼Œæ‰€ä»¥æ‰è¦æé†’ä½ ï¼Œå¦‚æœä½ æ”¹å˜äº†setæˆ–multisetä¸­çš„å…ƒç´ ï¼Œä¸€å®šä¸èƒ½æ”¹å˜é”®éƒ¨åˆ†ï¼Œå¦‚æœä½ æ”¹å˜äº†ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šç ´åå®¹å™¨ï¼Œå†ä½¿ç”¨è¯¥å®¹å™¨å°†å¯¼è‡´ä¸ç¡®å®šçš„ç»“æœã€‚ å°½ç®¡setå’Œmultisetçš„å…ƒç´ ä¸æ˜¯constï¼Œä½†æ˜¯STLæœ‰åŠæ³•é˜²æ­¢å…¶è¢«ä¿®æ”¹ã€‚æœ‰ç§å®ç°ä¼šä½¿set::iteratorçš„operator*è¿”å›ä¸€ä¸ªconst T\u0026ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯æ— æ³•ä¿®æ”¹setå’Œmultisetä¸­çš„å…ƒç´ çš„ã€‚ ç¬¬ä¸€æ¡æåˆ°å¯ä»¥æ›´æ”¹é›‡å‘˜å¯¹è±¡ä¸­éé”®çš„æˆå‘˜å˜é‡ï¼Œä½†æ˜¯æœ‰çš„ç¼–è¯‘å™¨ä¸å…è®¸è¿™æ ·çš„è¡Œä¸ºï¼Œæ‰€ä»¥ä¿®æ”¹setæˆ–multisetä¸­å…ƒç´ çš„å€¼æ˜¯ä¸å¯ç§»æ¤çš„ä»£ç ã€‚å¦‚æœä½ ä¸é‡è§†ç§»æ¤æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ›´æ”¹å¯¹è±¡ä¸­çš„éé”®æˆå‘˜ï¼Œå¦‚æœä½ é‡è§†ç§»æ¤æ€§ï¼Œé‚£ä¹ˆå°±ä¸èƒ½æ”¹å˜setå’Œmultisetä¸­çš„å¯¹è±¡ã€‚ä¸å¯¹ä¸å…è®¸æ”¹å˜éé”®çš„æˆå‘˜å˜é‡ï¼Œå¯ä»¥å…ˆæ‰§è¡Œconst_castè½¬æ¢ä¹‹åå†æ”¹å˜ã€‚ä½†æ˜¯è¦æ³¨æ„è½¬æ¢æˆå¼•ç”¨ï¼Œå³const_cast\u003cEmployee\u0026\u003e(i)ï¼Œå¦‚æœä¸æ˜¯å¼•ç”¨çš„è¯ï¼Œç±»å‹è½¬æ¢é¦–å…ˆä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œåœ¨ä¸´æ—¶å¯¹è±¡ä¸Šåšæ›´æ”¹salaryçš„åŠ¨ä½œï¼Œè€Œiæœ¬èº«æ˜¯å¹¶æ²¡æœ‰è¢«æ›´æ”¹çš„ã€‚ å¯¹äºä¿®æ”¹mapæˆ–multimapæƒ…å†µåˆæœ‰æ‰€ä¸åŒï¼Œmap\u003cK, V\u003eæˆ–multimap\u003cK, V\u003eåŒ…å«çš„æ˜¯pair\u003cconst K, V\u003eç±»å‹çš„å…ƒç´ ï¼Œå¦‚æœæŠŠconstå±æ€§å»æ‰ï¼Œå°±æ„å‘³ç€å¯ä»¥æ”¹å˜é”®éƒ¨åˆ†ã€‚ç†è®ºä¸Šï¼Œä¸€ç§STLå®ç°å¯ä»¥å°†è¿™æ ·çš„å€¼å¸è½½ä¸€ä¸ªåªè¯»çš„å†…å­˜åŒºåŸŸï¼Œä¸€æ—¦å†™å…¥åï¼Œå°†ç”±ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨è¿›è¡Œå†™ä¿æŠ¤ï¼Œè¿™æ˜¯è‹¥è¯•å›¾ä¿®æ”¹å®ƒï¼Œæœ€å¥½çš„ç»“æœå°±æ˜¯æ²¡æœ‰æ•ˆæœã€‚ä½†æ˜¯å¦‚æœè¦åšæŒC++æ ‡å‡†çš„è§„åˆ™ï¼Œé‚£å°±æ°¸è¿œä¸è¦è¯•å›¾ä¿®æ”¹mapæˆ–multimapä¸­çš„é”®éƒ¨åˆ†ã€‚ é™¤äº†å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¿˜æœ‰ä¸€ç§å®‰å…¨çš„æ–¹å¼å®Œæˆæ›´æ”¹å¯¹è±¡çš„å·¥ä½œã€‚ç¬¬ä¸€æ­¥æ‰¾åˆ°è¦ä¿®æ”¹çš„å¯¹è±¡çš„ä½ç½®ã€‚ç¬¬äºŒæ­¥ä¸ºå°†è¢«ä¿®æ”¹çš„å…ƒç´ åšä¸€ä»½æ‹·è´ã€‚ç¬¬ä¸‰æ­¥ä¿®æ”¹è¯¥æ‹·è´ã€‚ç¬¬å››æ­¥æŠŠå®¹å™¨ä¸­çš„å…ƒç´ åˆ é™¤ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨eraseã€‚ç¬¬äº”æ­¥æ˜¯æŠŠæ–°çš„å€¼æ’å…¥åˆ°å®¹å™¨ä¸­ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨insertã€‚ å¯¹äºä¸€ä¸ª map\u003cK, V\u003e æˆ– map\u003cK, V\u003e ç±»å‹çš„å¯¹è±¡ï¼Œå…¶ä¸­çš„å…ƒç´ ç±»å‹æ˜¯ pair\u003cconst K, V\u003eï¼Œå› ä¸ºé”®çš„ç±»å‹æ˜¯ const Kï¼Œæ‰€ä»¥å®ƒä¸èƒ½ä¿®æ”¹ã€‚ set / multiset ä¸­çš„å€¼ä¸æ˜¯ constï¼Œæ‰€ä»¥å¯¹è¿™äº›å€¼è¿›è¡Œä¿®æ”¹çš„ä»£ç å¯ä»¥é€šè¿‡ç¼–è¯‘ã€‚ ","date":"2023-09-15","objectID":"/posts/effective_stl_part_three/:4:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [3] | å…³è”å®¹å™¨","uri":"/posts/effective_stl_part_three/"},{"categories":["C++"],"content":"R23: è€ƒè™‘ç”¨æ’åºçš„vectoræ›¿ä»£å…³è”å®¹å™¨ 1.å½“ä½ éœ€è¦ä¸€ä¸ªå¿«é€ŸæŸ¥æ‰¾åŠŸèƒ½çš„æ•°æ®ç»“æ„æ—¶ï¼Œä¸€èˆ¬ä¼šç«‹å³æƒ³åˆ°æ ‡å‡†å…³è”å®¹å™¨ã€‚ä½†æ˜¯å“ˆå¸Œå®¹å™¨çš„æŸ¥æ‰¾é€Ÿåº¦æ›´å¿«ï¼Œé€šå¸¸æä¾›å¸¸æ•°æ—¶é—´çš„æŸ¥æ‰¾èƒ½åŠ›ï¼Œè€Œå…³è”å®¹å™¨æ—¶å¯¹æ•°æ—¶é—´çš„æŸ¥æ‰¾èƒ½åŠ›ã€‚å¦‚æœä½ è§‰å¾—å¯¹æ•°æ—¶é—´çš„æŸ¥æ‰¾èƒ½åŠ›ä¹Ÿå¯ï¼Œé‚£ä¹ˆå¯èƒ½æ’åºçš„vectorå¯èƒ½æ›´ç¬¦åˆä½ çš„è¦æ±‚ã€‚è¿™æ˜¯å› ä¸ºæ ‡å‡†å…³è”å®¹å™¨é€šå¸¸è¢«å®ç°ä¸ºå¹³è¡¡äºŒå‰æ ‘ï¼Œè¿™ç§æ•°æ®ç»“æ„å¯¹æ··åˆçš„æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾åšäº†ä¼˜åŒ–ï¼Œå³å®ƒé€‚ç”¨äºç¨‹åºæ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æ··åœ¨ä¸€èµ·ï¼Œæ²¡æœ‰æ˜æ˜¾çš„é˜¶æ®µçš„æ“ä½œã€‚ä½†æ˜¯å¾ˆå¤šåº”ç”¨ç¨‹åºä½¿ç”¨æ•°æ®ç»“æ„çš„æ–¹å¼å¹¶æ²¡æœ‰è¿™ä¹ˆä¹±ï¼Œä¸€èˆ¬å¯ä»¥æ˜æ˜¾åœ°åˆ†æˆä¸‰ä¸ªé˜¶æ®µã€‚è®¾ç½®é˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯æ’å…¥å’Œåˆ é™¤ï¼Œå‡ ä¹æ²¡æœ‰æŸ¥æ‰¾ã€‚æŸ¥æ‰¾é˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯æŸ¥æ‰¾ï¼Œå‡ ä¹æ²¡æœ‰æ’å…¥å’Œåˆ é™¤ã€‚é‡ç»„é˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯æ’å…¥å’Œåˆ é™¤ï¼Œå‡ ä¹æ²¡æœ‰æŸ¥æ‰¾ã€‚å¯¹äºè¿™ç§æ–¹å¼ï¼Œvectorå¯èƒ½æ¯”å…³è”å®¹å™¨æä¾›äº†æ›´å¥½çš„æ€§èƒ½ï¼Œä½†æ˜¯å¿…é¡»æ˜¯æ’åºçš„å®¹å™¨æ‰å¯ä»¥ï¼Œå› ä¸ºåªæœ‰å¯¹æ’åºçš„vectorå®¹å™¨æ‰èƒ½å¤Ÿæ­£ç¡®åº•ä½¿ç”¨æŸ¥æ‰¾ç®—æ³•binary_searchã€lower_boundå’Œequal_rangeç­‰ã€‚ 2. ä¸‹é¢æ¢ç©¶ä¸ºä»€ä¹ˆæ’åºçš„vectoråœ¨æŸ¥æ‰¾æ€§èƒ½ä¸Šä¼šæ¯”å…³è”å®¹å™¨è¦å¿«å‘¢ï¼Ÿç¬¬ä¸€ä¸ªåŸå› æ˜¯å¤§å°ï¼Œå¹³è¡¡äºŒå‰æ ‘å­˜å‚¨å¯¹è±¡ï¼Œé™¤äº†å¯¹è±¡æœ¬èº«ä»¥å¤–ï¼Œè¿˜é€šå¸¸åŒ…å«äº†ä¸‰ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡å‘å·¦å„¿å­ï¼Œä¸€ä¸ªæŒ‡å‘å³å„¿å­ï¼Œé€šå¸¸è¿˜æœ‰ä¸€ä¸ªæŒ‡å‘çˆ¶èŠ‚ç‚¹ï¼Œè€Œä½¿ç”¨vectorå­˜å‚¨å¯¹è±¡çš„è¯ï¼Œé™¤äº†å¯¹è±¡æœ¬èº«ä»¥å¤–ï¼Œå°±æ²¡æœ‰å¤šä½™çš„å¼€é”€äº†ã€‚å‡è®¾æˆ‘ä»¬çš„æ•°æ®è¶³å¤Ÿå¤§ï¼Œå®ƒä»¬è¢«åˆ†å‰²åå°†è·¨è¶Šå¤šä¸ªå†…å­˜é¡µé¢ï¼Œä½†æ˜¯vectorå°†æ¯”å…³è”å®¹å™¨éœ€è¦æ›´å°‘çš„é¡µé¢ã€‚ç¬¬äºŒä¸ªåŸå› æ˜¯vectoræ˜¯è¿ç»­å†…å­˜å®¹å™¨ï¼Œå…³è”å®¹å™¨æ˜¯åŸºäºèŠ‚ç‚¹çš„å®¹å™¨ï¼Œè™½ç„¶ç»å¤§å¤šæ•°STLå®ç°ä½¿ç”¨äº†è‡ªå®šä¹‰çš„å†…å­˜ç®¡ç†å™¨ä½¿å¾—äºŒå‰æ ‘çš„èŠ‚ç‚¹èšé›†åœ¨ç›¸å¯¹è¾ƒå°‘çš„å†…å­˜é¡µé¢ï¼Œä½†æ˜¯å¦‚æœä½ çš„STLå¹¶æ²¡æœ‰è¿™æ ·åšï¼Œé‚£è¿™äº›èŠ‚ç‚¹å°±ä¼šæ•£å¸ƒåœ¨å…¨éƒ¨åœ°å€ç©ºé—´ä¸­ï¼Œè¿™ä¼šå¯¼è‡´æ›´å¤šçš„é¡µé¢é”™è¯¯ã€‚ä¸vectorè¿™æ ·çš„å†…å­˜è¿ç»­å®¹å™¨ä¸åŒï¼ŒåŸºäºèŠ‚ç‚¹çš„å®¹å™¨æƒ³ä¿è¯å®¹å™¨ä¸­ç›¸é‚»çš„å…ƒç´ åœ¨ç‰©ç†å†…å­˜ä¸­ä¹Ÿæ˜¯ç›¸é‚»æ˜¯ååˆ†å›°éš¾çš„ã€‚ 3. ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ’å…¥å’Œåˆ é™¤æ“ä½œå¯¹äºvectoræ¥è¯´æ˜¯æ˜‚è´µçš„ï¼Œå°¤å…¶æ˜¯å¯¹äºéœ€è¦ä¿æŒæœ‰åºçš„vectorã€‚å› ä¸ºæ¯å½“æœ‰å…ƒç´ è¢«æ’å…¥ï¼Œæ–°å…ƒç´ ä¹‹åçš„å…ƒç´ éƒ½è¦å‘åç§»åŠ¨ä¸€ä¸ªä½ç½®ï¼Œå½“æœ‰å…ƒç´ è¢«åˆ é™¤ï¼Œåˆ é™¤ä½ç½®ä¹‹åçš„å…ƒç´ éƒ½è¦å‘å‰ç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚æ‰€ä»¥åªæœ‰åˆ é™¤æ’å…¥æ“ä½œä¸å’ŒæŸ¥æ‰¾æ“ä½œæ··åœ¨ä¸€èµ·çš„æ‰è€ƒè™‘ä½¿ç”¨æ’åºçš„vectoræ›¿ä»£å…³è”å®¹å™¨ã€‚ 4. å½“ä½¿ç”¨vectoræ›¿æ¢mapæˆ–multimapæ—¶ï¼Œå­˜å‚¨åœ¨vectorä¸­çš„æ•°æ®å¿…é¡»æ˜¯pair\u003cK, V\u003eï¼Œè€Œä¸æ˜¯pair\u003cconst K, V\u003eã€‚å› ä¸ºå½“å¯¹vectorè¿›è¡Œæ’åºæ—¶ï¼Œä»–çš„å…ƒç´ çš„å€¼å°†é€šè¿‡èµ‹å€¼æ“ä½œè¢«ç§»åŠ¨ï¼Œè¿™æ„å‘³ç€pairçš„ä¸¤ä¸ªéƒ¨åˆ†éƒ½å¿…é¡»æ˜¯å¯ä»¥è¢«èµ‹å€¼çš„ã€‚mapå’Œmultimapåœ¨æ’åºæ—¶åªçœ‹å…ƒç´ çš„é”®éƒ¨åˆ†ï¼Œæ‰€ä»¥ä½ éœ€è¦ä¸ºè‡ªå·±çš„pairå†™ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°ï¼Œå› ä¸ºpairçš„operator\u003cå¯¹pairçš„ä¸¤ä¸ªéƒ¨åˆ†éƒ½ä¼šæ£€æŸ¥ã€‚è€Œä¸”ä½ éœ€è¦å¦ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°æ¥æ‰§è¡ŒæŸ¥æ‰¾ï¼Œç”¨æ¥åšæ’åºçš„æ¯”è¾ƒå‡½æ•°éœ€è¦ä¸¤ä¸ªpairå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œä½†æ˜¯æŸ¥æ‰¾çš„æ¯”è¾ƒå‡½æ•°çš„ä¸€ä¸ªå‚æ•°æ˜¯ä¸é”®ç›¸åŒç±»å‹çš„å¯¹è±¡ï¼Œå¦ä¸€ä¸ªæ˜¯pairå¯¹è±¡ï¼Œåªéœ€è¦ä¸€ä¸ªé”®å€¼å¯¹ã€‚å¦å¤–ä½ ä¸çŸ¥é“ä¼ è¿›æ¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”®è¿˜æ˜¯pairï¼Œæ‰€ä»¥å®é™…ä¸Šéœ€è¦ä¸¤ä¸ªæŸ¥æ‰¾çš„æ¯”è¾ƒå‡½æ•°ï¼Œä¸€ä¸ªæ˜¯å‡å®šé”®éƒ¨åˆ†ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ï¼Œå¦ä¸€ä¸ªæ˜¯å‡å®špairå…ˆä¼ å…¥ã€‚ æ ‡å‡†çš„å…³è”å®¹å™¨é€šå¸¸è¢«å®ç°ä¸ºå¹³è¡¡äºŒå‰æ ‘ã€‚é€‚åˆæ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾çš„æ··åˆæ“ä½œï¼Œæä¾›å¯¹æ•°æ—¶é—´çš„æŸ¥æ‰¾èƒ½åŠ›ã€‚ä½†æ¯”è¾ƒæµªè´¹å†…å­˜ç©ºé—´ï¼ˆçˆ¶æŒ‡é’ˆï¼Œå·¦å„¿å­æŒ‡é’ˆï¼Œå³å„¿å­æŒ‡é’ˆï¼‰ã€‚å¦‚æœèŠ‚ç‚¹æ•£å¸ƒåœ¨å…¨éƒ¨åœ°å€ç©ºé—´ï¼Œå°†ä¼šå¯¼è‡´æ›´å¤šçš„é¡µç¼ºå¤±ã€‚ æ•£åˆ—å®¹å™¨ï¼šæä¾›å¸¸æ•°æ—¶é—´çš„æŸ¥æ‰¾èƒ½åŠ›ã€‚ ä½¿ç”¨æ•°æ®ç»“æ„çš„ä¸€èˆ¬è¿‡ç¨‹ï¼š è®¾ç½®é˜¶æ®µï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„ï¼Œå¹¶æ’å…¥å¤§é‡å…ƒç´ ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå‡ ä¹æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œå¾ˆå°‘æˆ–å‡ ä¹æ²¡æœ‰æŸ¥æ‰¾æ“ä½œã€‚ æŸ¥æ‰¾é˜¶æ®µï¼šæŸ¥è¯¢è¯¥æ•°æ®ç»“æ„ä»¥æ‰¾åˆ°ç‰¹å®šçš„ä¿¡æ¯ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå‡ ä¹æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æŸ¥æ‰¾æ“ä½œï¼Œå¾ˆå°‘æˆ–å‡ ä¹æ²¡æœ‰æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚ é‡ç»„é˜¶æ®µï¼šæ”¹å˜è¯¥æ•°æ®ç»“æ„çš„å†…å®¹ï¼Œæˆ–è®¸æ˜¯åˆ é™¤æ‰€æœ‰çš„å½“å‰æ•°æ®ï¼Œå†æ’å…¥æ–°çš„æ•°æ®ã€‚åœ¨è¡Œä¸ºä¸Šï¼Œè¿™ä¸ªé˜¶æ®µä¸ç¬¬1é˜¶æ®µç±»ä¼¼ã€‚ä½†è¿™ä¸ªé˜¶æ®µç»“æŸä»¥åï¼Œåº”ç”¨ç¨‹åºåˆå›åˆ°äº†ç¬¬2é˜¶æ®µã€‚ ä½¿ç”¨ vector æ›¿ä»£æ ‡å‡†å…³è”å®¹å™¨ï¼š åœ¨æ’åºçš„ vector ä¸­å­˜å‚¨æ•°æ®å¯èƒ½æ¯”åœ¨æ ‡å‡†å…³è”å®¹å™¨ä¸­å­˜å‚¨åŒæ ·çš„æ•°æ®è¦è€—è´¹æ›´å°‘çš„å†…å­˜ã€‚ è€ƒè™‘åˆ°é¡µé¢é”™è¯¯çš„å› ç´ ï¼Œé€šè¿‡äºŒåˆ†æœç´¢æ³•æ¥æŸ¥æ‰¾ä¸€ä¸ªæ’åºçš„ vector å¯èƒ½æ¯”æŸ¥æ‰¾ä¸€ä¸ªæ ‡å‡†å…³è”å®¹å™¨è¦æ›´å¿«ä¸€ç‚¹ã€‚ å­˜å‚¨åœ¨ vector ä¸­çš„æ•°æ®å¿…é¡»æ˜¯ pair\u003cK, V\u003e ï¼Œå› ä¸ºæ’åºæ—¶å®ƒçš„å…ƒç´ çš„å€¼å°†é€šè¿‡èµ‹å€¼æ“ä½œè¢«ç§»åŠ¨ã€‚ å¯¹ vector åšæ’åºæ—¶ï¼Œå¿…é¡»ä¸º pair å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¯”è¾ƒç±»å‹ã€‚ï¼ˆP85ï¼‰ ","date":"2023-09-15","objectID":"/posts/effective_stl_part_three/:5:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [3] | å…³è”å®¹å™¨","uri":"/posts/effective_stl_part_three/"},{"categories":["C++"],"content":"R24: å½“æ•ˆç‡è‡³å…³é‡è¦æ—¶ï¼Œè¯·åœ¨ map::operator[] ä¸ map::insert ä¹‹é—´è°¨æ…åšå‡ºé€‰æ‹©ã€‚ map::operator[]çš„åŠŸèƒ½æ˜¯æ·»åŠ å’Œæ›´æ–°ï¼Œå½“mapä¸­æ²¡æœ‰[]ä¸­æŒ‡å®šçš„é”®æ—¶ï¼Œåˆ™åŠ å…¥ä¸€ä¸ªæ–°pairï¼Œå¦‚æœ[]ä¸­æœ‰æŒ‡å®šçš„é”®æ—¶ï¼Œåˆ™æ›´æ–°è¿™ä¸ªé”®çš„å€¼ã€‚å‡å¦‚æœ‰ä¸€ä¸ªmapçš„å€¼æ˜¯Widgetå¯¹è±¡ï¼Œé”®æ˜¯ä¸€ä¸ªç®€å•ç±»å‹ï¼ˆå¦‚intï¼‰ï¼ŒWidgetæœ‰ä¸€ä¸ªé»˜è®¤æ— å‚æ„é€ å‡½æ•°å’Œä¸€ä¸ªæ¥å—ä¸€ä¸ªå‚æ•°çš„æœ‰å‚æ„é€ å‡½æ•°å’Œèµ‹å€¼æ„é€ å‡½æ•°ã€‚å½“mapä¸­æ²¡æœ‰ç›¸åº”çš„keyæ—¶ï¼Œmap::insertæ˜¯æ¯”map::operator[]æ›´å¿«çš„ï¼Œå› ä¸ºmap::operator[]ä¼šæ„é€ ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼ˆè°ƒç”¨æ— å‚æ„é€ å‡½æ•°ï¼‰ï¼Œå†å°†èµ‹ç»™ä»–æ–°å€¼ï¼Œè€Œmap::insertæ˜¯ç›´æ¥è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•°ã€‚ä½†æ˜¯å½“mapä¸­æœ‰ç›¸åº”çš„keyæ—¶ï¼Œmap::operator[]æ˜¯æ¯”map::insertæ›´å¿«çš„ï¼Œå› ä¸ºmap::insertéœ€è¦æ„é€ å’Œææ„å¯¹è±¡ï¼Œè€Œmap::operator[]ä¸éœ€è¦ã€‚ æ€»ç»“ï¼šå½“å‘æ˜ å°„è¡¨ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œè¦ä¼˜å…ˆé€‰ç”¨ insert è€Œä¸æ˜¯ operator[]ï¼›å½“æ›´æ–°å·²ç»åœ¨æ˜ å°„è¡¨ä¸­çš„å…ƒç´ çš„å€¼æ—¶ï¼Œè¦ä¼˜å…ˆé€‰æ‹© operator[]ã€‚ ","date":"2023-09-15","objectID":"/posts/effective_stl_part_three/:6:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [3] | å…³è”å®¹å™¨","uri":"/posts/effective_stl_part_three/"},{"categories":["C++"],"content":"R25: ç†Ÿæ‚‰éæ ‡å‡†çš„æ•£åˆ—å®¹å™¨ éæ ‡å‡†çš„æ•£åˆ—å®¹å™¨æœ‰ hash_mapï¼Œhash_setï¼Œhash_multimapï¼Œhash_multiset SGI çš„æ•£åˆ—å®¹å™¨ï¼š template\u003ctypename T, typename HashFunction = hash\u003cT\u003e, typename CompareFunction = equal_to\u003cT\u003e, typename Allocator = allocator\u003cT\u003e \u003e class hash_set; æ³¨æ„: ä¸æ ‡å‡†å…³è”å®¹å™¨ä¸åŒï¼Œ SGI çš„æ•£åˆ—å®¹å™¨ä½¿ç”¨ equal_to ä½œä¸ºé»˜è®¤çš„æ¯”è¾ƒå‡½æ•°ï¼Œé€šè¿‡æµ‹è¯•ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰è€Œä¸æ˜¯ç­‰ä»·æ¥å†³å®šå®¹å™¨ä¸­çš„ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ SGI çš„å®ç°æŠŠè¡¨çš„å…ƒç´ æ”¾åœ¨ä¸€ä¸ªå•å‘é“¾è¡¨ä¸­ï¼Œè€Œ Dinkumware çš„å®ç°åˆ™ä½¿ç”¨äº†åŒå‘é“¾è¡¨ã€‚ ref: [1]. https://www.cnblogs.com/Sherry4869/p/15128250.html [2]. https://blog.csdn.net/zhuikefeng/article/details/108164117#t42 ","date":"2023-09-15","objectID":"/posts/effective_stl_part_three/:7:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [3] | å…³è”å®¹å™¨","uri":"/posts/effective_stl_part_three/"},{"categories":["C++"],"content":"å‰è¨€ Effective-STLæ€»ç»“ç³»åˆ—åˆ†ä¸ºä¸ƒéƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬ä¸€éƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬ä¸€ç« ï¼Œå†…å®¹èŒƒå›´Rule01~12ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule12ç®€å†™ä¸ºR12ã€‚ Effective-STLç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“(å››) ","date":"2023-09-10","objectID":"/posts/effective_stl_part_two/:0:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [2] | vector å’Œ string","uri":"/posts/effective_stl_part_two/"},{"categories":["C++"],"content":"R13 vectorå’Œstringä¼˜å…ˆäºåŠ¨æ€åˆ†é…çš„æ•°ç»„ å¦‚æœä½¿ç”¨åŠ¨æ€åˆ†é…çš„æ•°ç»„ï¼Œæ„å‘³ç€ä½ éœ€è¦æ‰¿æ‹…ä¸‰ä¸ªè´£ä»»: é¦–å…ˆå¿…é¡»ç¡®ä¿æœ€åä¼šè°ƒç”¨deleteæ¥é‡Šæ”¾ç”³è¯·çš„å†…å­˜; å…¶æ¬¡æ˜¯å¿…é¡»ç¡®ä¿ä½¿ç”¨äº†æ­£ç¡®çš„deleteå½¢å¼ï¼Œå¦‚æœæ˜¯åˆ†é…äº†æ•°ç»„çš„è¯ï¼Œåº”è¯¥ä½¿ç”¨delete[]; æœ€åå¿…é¡»ç¡®ä¿åªdeleteäº†ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯å¤šæ¬¡ã€‚ è€Œä½¿ç”¨vectoræˆ–è€…stringå°±ä¸éœ€è¦æ‰¿æ‹…è¿™æ ·çš„è´£ä»»ã€‚ å¦‚æœå½“å‰ä½¿ç”¨çš„stringæ˜¯ä»¥å¼•ç”¨è®¡æ•°çš„æ–¹å¼å®ç°çš„ï¼Œè€Œåˆè¿è¡Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå¹¶ä¸”stringçš„å¼•ç”¨è®¡æ•°å®ç°ä¼šå½±å“æ•ˆç‡ï¼ˆæœ‰æ—¶ä¼šå‡ºç°åŒæ­¥æ§åˆ¶æ‰€èŠ±è´¹çš„æ—¶é—´æ¯”é¿å…å†…å­˜åˆ†é…å’Œå­—ç¬¦æ‹·è´èŠ‚çº¦ä¸‹æ¥çš„æ—¶é—´è¿˜è¦å¤šï¼‰ï¼Œé‚£ä¹ˆä½ è‡³å°‘æœ‰ä¸‰ç§é€‰æ‹©æ–¹æ¡ˆï¼Œä¸”æ²¡æœ‰ä¸€ç§æ˜¯æ”¾å¼ƒä½¿ç”¨stringã€‚ ç¬¬ä¸€ç§æ˜¯æ£€æŸ¥stringå®ç°ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰å¯èƒ½ç¦æ­¢å¼•ç”¨è®¡æ•°ï¼Œé€šå¸¸æ˜¯é€šè¿‡æ”¹å˜æŸä¸ªé¢„å¤„ç†å˜é‡çš„å€¼ã€‚ ç¬¬äºŒç§æ˜¯å¯»æ‰¾æˆ–å¼€å‘ä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°çš„stringå®ç°ã€‚ ç¬¬ä¸‰æ˜¯è€ƒè™‘ä½¿ç”¨vectorè€Œä¸æ˜¯stringã€‚ ","date":"2023-09-10","objectID":"/posts/effective_stl_part_two/:1:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [2] | vector å’Œ string","uri":"/posts/effective_stl_part_two/"},{"categories":["C++"],"content":"R14: ä½¿ç”¨ reserve æ¥é¿å…ä¸å¿…è¦çš„é‡æ–°åˆ†é…ã€‚ vector å’Œ string çš„è‡ªåŠ¨å¢é•¿æœºåˆ¶ï¼š åˆ†é…ï¼šåˆ†é…ä¸€å—å¤§å°ä¸ºå½“å‰å®¹é‡çš„æŸä¸ªå€æ•°çš„æ–°å†…å­˜ã€‚vector å’Œ string ä¸€èˆ¬ä¸º 2. æŠŠå®¹å™¨çš„æ‰€æœ‰å…ƒç´ ä»æ—§çš„å†…å­˜å¤åˆ¶åˆ°æ–°çš„å†…å­˜ã€‚ ææ„æ‰æ—§å†…å­˜ä¸­çš„å¯¹è±¡ã€‚ é‡Šæ”¾æ—§å†…å­˜ã€‚ size()ï¼šå‘Šè¯‰ä½ è¯¥å®¹å™¨ä¸­æœ‰å¤šå°‘ä¸ªå…ƒç´ ã€‚ capacity()ï¼šå‘Šè¯‰ä½ è¯¥å®¹å™¨åˆ©ç”¨å·²ç»åˆ†é…çš„å†…å­˜å¯ä»¥å®¹çº³å¤šå°‘ä¸ªå…ƒç´ ã€‚è¿™æ˜¯å®¹å™¨æ‰€èƒ½å®¹çº³çš„å…ƒç´ æ€»æ•°ã€‚ resize(Container::size_type n)ï¼šå¼ºè¿«å®¹å™¨æ”¹å˜åˆ°åŒ…å« n ä¸ªå…ƒç´ çš„çŠ¶æ€ã€‚åœ¨è°ƒç”¨ resize ä¹‹åï¼Œsize å°†è¿”å› nã€‚ reserve(Container::size_type n)ï¼šå¼ºè¿«å®¹å™¨æŠŠå®ƒçš„å®¹é‡å˜ä¸ºè‡³å°‘æ˜¯ nï¼Œå‰ææ˜¯ n ä¸å°äºå½“å‰çš„å¤§å°ã€‚ ä½¿ç”¨ reserveï¼Œç®€å•é¢„ç•™é€‚åˆå¤§å°çš„ç©ºé—´ï¼Œé¿å…å¾ªç¯è¿‡ç¨‹ä¸­å‘ç”Ÿé‡æ–°åˆ†é…ï¼š vector\u003cint\u003e v; v.reserve(1000); for (int i = 1; i \u003c= 1000; ++i) v.push_back(i); å¯¹ push_back çš„è°ƒç”¨ä¸ä¼šä½¿ string ä¸­çš„è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨æ— æ•ˆï¼š string s; ... if (s.size() \u003c s.capacity()) { s.push_back('x'); } ","date":"2023-09-10","objectID":"/posts/effective_stl_part_two/:2:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [2] | vector å’Œ string","uri":"/posts/effective_stl_part_two/"},{"categories":["C++"],"content":"R15: æ³¨æ„ string å®ç°çš„å¤šæ ·æ€§ã€‚ æ¯ä¸ª string åŒ…å«çš„ä¿¡æ¯ï¼š å­—ç¬¦ä¸²çš„å¤§å°ï¼ˆsizeï¼‰ï¼Œå³å®ƒæ‰€åŒ…å«çš„å­—ç¬¦ä¸ªæ•°ã€‚ å­˜å‚¨è¯¥å­—ç¬¦ä¸²ä¸­å­—ç¬¦çš„å†…å­˜å®¹é‡ï¼ˆcapacityï¼‰ã€‚ å­—ç¬¦ä¸²çš„å€¼ï¼ˆvalue)ï¼Œå³æ„æˆè¯¥å­—ç¬¦ä¸²çš„å­—ç¬¦ã€‚ å¯é€‰ï¼š åˆ†é…å­çš„æ‹·è´ã€‚ å¯¹å€¼çš„å¼•ç”¨è®¡æ•°ã€‚ å®ç°A å®ç°A å®ç°A å®ç°A ","date":"2023-09-10","objectID":"/posts/effective_stl_part_two/:3:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [2] | vector å’Œ string","uri":"/posts/effective_stl_part_two/"},{"categories":["C++"],"content":"R16: äº†è§£å¦‚ä½•æŠŠ vector å’Œ string æ•°æ®ä¼ ç»™æ—§çš„ APIã€‚ C++æ ‡å‡†è¦æ±‚ vector ä¸­çš„å…ƒç´ å­˜å‚¨åœ¨è¿ç»­çš„å†…å­˜ä¸­ï¼Œå°±åƒæ•°ç»„ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¾—åˆ°å®¹å™¨ä¸­çš„æ•°æ®æŒ‡é’ˆã€‚ å¯¹äº vector v; è¡¨è¾¾å¼ v[0] ç»™å‡ºäº†ä¸€ä¸ªå¼•ç”¨ï¼Œå®ƒæ˜¯è¯¥å‘é‡ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥ \u0026v[0] æ˜¯æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚ \u0026*v.begin() ç­‰ä»·äº \u0026v[0] å¯¹äº stringï¼Œç”±äº string ä¸­çš„æ•°æ®ä¸ä¸€å®šå­˜å‚¨åœ¨è¿ç»­çš„å†…å­˜ä¸­ä¸” string çš„å†…éƒ¨è¡¨ç¤ºä¸ä¸€å®šæ˜¯ä»¥ç©ºå­—ç¬¦ç»“å°¾ï¼Œéœ€ä½¿ç”¨æˆå‘˜å‡½æ•° c_str()ã€‚ ","date":"2023-09-10","objectID":"/posts/effective_stl_part_two/:4:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [2] | vector å’Œ string","uri":"/posts/effective_stl_part_two/"},{"categories":["C++"],"content":"R17: ä½¿ç”¨ â€œswap æŠ€å·§â€ é™¤å»å¤šä½™çš„å®¹é‡ shrink to fitï¼šä¸ºäº†é¿å…å‘é‡ä»å ç”¨ä¸å†éœ€è¦çš„å†…å­˜ï¼Œä½ å¸Œæœ›æœ‰ä¸€ç§æ–¹æ³•èƒ½æŠŠå®ƒçš„å®¹é‡ä»ä»¥å‰çš„æœ€å¤§å€¼ç¼©å‡åˆ°å½“å‰éœ€è¦çš„æ•°é‡ã€‚ ä» contestants å‘é‡ä¸­é™¤å»å¤šä½™çš„å®¹é‡ï¼š vector\u003cContestant\u003e(contestants).swap(contestants); vector çš„æ‹·è´æ„é€ å‡½æ•°åªä¸ºè¯´æ‹·è´çš„å…ƒç´ åˆ†é…æ‰€éœ€è¦çš„å†…å­˜ï¼Œæ‰€ä»¥è¿™ä¸ªä¸´æ—¶å˜é‡æ²¡æœ‰å¤šä½™çš„å®¹é‡ã€‚ swapï¼šä¸´æ—¶å˜é‡çš„æ•°æ®å’Œ contestents çš„æ•°æ®åš swap æ“ä½œã€‚åœ¨è¿™ä¹‹åï¼Œcontestents å…·æœ‰äº†è¢«å»é™¤ä¹‹åçš„å®¹é‡ï¼Œå³åŸå…ˆä¸´æ—¶å˜é‡çš„å®¹é‡ã€‚ä¸´æ—¶å˜é‡éšåè¢«ææ„ï¼Œä»è€Œé‡Šæ”¾å…ˆå‰ä¸º contestents æ‰€å æ®çš„å†…å­˜ã€‚æ³¨æ„ï¼Œè¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨ä¹Ÿå°†è¢«äº¤æ¢ï¼ˆstring é™¤å¤–ï¼‰ã€‚ åŒæ ·é€‚ç”¨äº string string s; ... string(s).swap(s); æ¸…é™¤ä¸€ä¸ªå®¹å™¨ï¼š vector\u003cContestant\u003e v; string s; ... vector\u003cContestant\u003e().swap(v);// æ¸…é™¤vå¹¶æŠŠå®ƒçš„å®¹é‡å˜ä¸ºæœ€å° string().swap(s);// æ¸…é™¤så¹¶æŠŠå®ƒçš„å®¹é‡å˜ä¸ºæœ€å° ","date":"2023-09-10","objectID":"/posts/effective_stl_part_two/:5:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [2] | vector å’Œ string","uri":"/posts/effective_stl_part_two/"},{"categories":["C++"],"content":"R18: é¿å…ä½¿ç”¨ vector bool vector æ˜¯ä¸€ä¸ªå‡çš„å®¹å™¨ï¼š å®ƒä¸æ˜¯ä¸€ä¸ª STL å®¹å™¨ã€‚ å®ƒå¹¶ä¸å­˜å‚¨ boolã€‚ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå®ƒå‚¨å­˜çš„æ˜¯ bool çš„ç´§å‡‘è¡¨ç¤ºâ€”â€”ä½¿ç”¨äº†ä¸ä½åŸŸï¼ˆbitfieldï¼‰ä¸€æ ·çš„æ€æƒ³ï¼Œä¸€ä¸ª 8 ä½çš„å­—èŠ‚å¯å®¹çº³ 8 ä¸ª â€œboolâ€ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡å‘ bool çš„æŒ‡é’ˆï¼Œè€ŒæŒ‡å‘å•ä¸ªä½çš„æŒ‡é’ˆåˆ™æ˜¯ä¸å…è®¸çš„ã€‚æŒ‡å‘å•ä¸ªä½çš„å¼•ç”¨ä¹Ÿæ˜¯è¢«ç¦æ­¢çš„ã€‚ vector::operator[] è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç°å¾—åƒæ˜¯ä¸€ä¸ªæŒ‡å‘å•ä¸ªä½çš„å¼•ç”¨ï¼Œå³æ‰€è°“çš„ä»£ç†å¯¹è±¡ï¼ˆproxy objectï¼‰ã€‚ vector çš„æ›¿ä»£æ–¹æ¡ˆï¼š dequeï¼šdeque æ˜¯ä¸€ä¸ª STL å®¹å™¨ï¼Œè€Œä¸”å®ƒç¡®å®å­˜å‚¨ boolã€‚ä½† deque ä¸­å…ƒç´ çš„å†…å­˜ä¸æ˜¯è¿ç»­çš„ã€‚ bitsetï¼šbitset ä¸æ˜¯ STL å®¹å™¨ï¼Œå®ƒçš„å¤§å°ï¼ˆå…ƒç´ çš„ä¸ªæ•°ï¼‰åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šäº†ï¼Œæ‰€ä»¥å®ƒä¸æ”¯æŒè¿­ä»£å™¨ã€‚ä¸ vector ä¸€æ ·ï¼Œå®ƒä½¿ç”¨äº†ä¸€ç§ç´§å‡‘è¡¨ç¤ºï¼Œåªä¸ºæ‰€åŒ…å«çš„æ¯ä¸ªå€¼æä¾›ä¸€ä½ç©ºé—´ã€‚ æ€»ä¹‹ï¼Œvector æ˜¯ä¸€ä¸ªå¤±è´¥äº†çš„é›„å¿ƒå‹ƒå‹ƒçš„å®éªŒï¼Œå®ƒä¸å®Œå…¨æ»¡è¶³ STL å®¹å™¨çš„è¦æ±‚ï¼›ä½ æœ€å¥½ä¸è¦ä½¿ç”¨å®ƒï¼›ä½ å¯ä»¥ä½¿ç”¨ deque å’Œ bitset æ¥æ›¿ä»£å®ƒï¼Œè¿™ä¸¤ä¸ªæ•°æ®ç»“æ„å‡ ä¹èƒ½åš vector æ‰€èƒ½åšçš„ä¸€åˆ‡äº‹æƒ…ã€‚ ref: [1]. https://www.cnblogs.com/Sherry4869/p/15128250.html [2]. https://blog.csdn.net/zhuikefeng/article/details/108164117#t42 ","date":"2023-09-10","objectID":"/posts/effective_stl_part_two/:6:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [2] | vector å’Œ string","uri":"/posts/effective_stl_part_two/"},{"categories":["C++"],"content":"ä¸€ã€ åŸºç¡€è®®é¢˜(Basics) ","date":"2023-09-06","objectID":"/posts/more_effective_c/:1:0","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 1: ä»”ç»†åŒºåˆ« pointerså’Œreferences æ²¡æœ‰æ‰€è°“çš„ null referenceã€‚ä¸€ä¸ª reference å¿…é¡»æ€»ä»£è¡¨æŸä¸ªå¯¹è±¡ã€‚æ‰€ä»¥å¦‚æœä½ æœ‰ä¸€ä¸ªå˜é‡ï¼Œå…¶ç›®çš„æ˜¯ç”¨æ¥æŒ‡å‘(ä»£è¡¨)å¦ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¯èƒ½å®ƒä¸æŒ‡å‘(ä»£è¡¨)ä»»ä½•å¯¹è±¡ï¼Œé‚£ä¹ˆä½ åº”è¯¥ä½¿ç”¨ pointerï¼Œå› ä¸ºä½ å¯ä»¥å°† pointerè®¾ä¸º nullã€‚æ¢ä¸ªè§’åº¦çœ‹ï¼Œå¦‚æœè¿™ä¸ªå˜é‡æ€»æ˜¯å¿…é¡»ä»£è¡¨ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ çš„è®¾è®¡å¹¶ä¸å…è®¸è¿™ä¸ªå˜é‡ä¸º nullï¼Œé‚£ä¹ˆä½ åº”è¯¥ä½¿ç”¨referenceã€‚ Pointers å’Œ references ä¹‹é—´çš„å¦ä¸€ä¸ªé‡è¦å·®å¼‚å°±æ˜¯ï¼Œpointers å¯ä»¥è¢«é‡æ–°èµ‹å€¼ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼Œreference å´æ€»æ˜¯æŒ‡å‘(ä»£è¡¨)å®ƒæœ€åˆè·å¾—çš„é‚£ä¸ªå¯¹è±¡ã€‚ ä¸€èˆ¬è€Œè¨€ï¼Œå½“ä½ éœ€è¦è€ƒè™‘â€œä¸æŒ‡å‘ä»»ä½•å¯¹è±¡â€çš„å¯èƒ½æ€§æ—¶ï¼Œæˆ–æ˜¯è€ƒè™‘â€œåœ¨ä¸åŒæ—¶é—´æŒ‡å‘ä¸åŒå¯¹è±¡â€çš„èƒ½åŠ›æ—¶ï¼Œä½ å°±åº”è¯¥é‡‡ç”¨ pointerã€‚å‰ä¸€ç§æƒ…å†µä½ å¯ä»¥å°† pointerè®¾ä¸º nullï¼Œåä¸€ç§æƒ…å†µä½ å¯ä»¥æ”¹å˜pointer æ‰€æŒ‡å¯¹è±¡ã€‚è€Œå½“ä½ ç¡®å®šâ€œæ€»æ˜¯ä¼šä»£è¡¨æŸä¸ªå¯¹è±¡â€ï¼Œè€Œä¸”â€œä¸€æ—¦ä»£è¡¨äº†è¯¥å¯¹è±¡å°±ä¸èƒ½å¤Ÿå†æ”¹å˜â€ï¼Œé‚£ä¹ˆä½ åº”è¯¥é€‰ç”¨ referenceã€‚ å½“ä½ çŸ¥é“ä½ éœ€è¦æŒ‡å‘æŸä¸ªä¸œè¥¿ï¼Œè€Œä¸”ç»ä¸ä¼šæ”¹å˜æŒ‡å‘å…¶ä»–ä¸œè¥¿ï¼Œæˆ–æ˜¯å½“ä½ å®ç°ä¸€ä¸ªæ“ä½œç¬¦è€Œå…¶è¯­æ³•éœ€æ±‚æ— æ³•ç”± pointers è¾¾æˆï¼Œä½ å°±åº”è¯¥é€‰æ‹© referencesã€‚ä»»ä½•å…¶ä»–æ—¶å€™ï¼Œè¯·é‡‡ç”¨ pointersã€‚ åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸èƒ½ä½¿ç”¨æŒ‡å‘ç©ºå€¼çš„å¼•ç”¨ã€‚ä¸€ä¸ªå¼•ç”¨å¿…é¡»æ€»æ˜¯æŒ‡å‘æŸäº›å¯¹è±¡ã€‚åœ¨C++é‡Œï¼Œå¼•ç”¨åº”è¢«åˆå§‹åŒ–ã€‚ ä¸å­˜åœ¨æŒ‡å‘ç©ºå€¼çš„å¼•ç”¨è¿™ä¸ªäº‹å®æ„å‘³ç€ä½¿ç”¨å¼•ç”¨çš„ä»£ç æ•ˆç‡æ¯”ä½¿ç”¨æŒ‡é’ˆçš„è¦é«˜ã€‚å› ä¸ºåœ¨ä½¿ç”¨å¼•ç”¨ä¹‹å‰ä¸éœ€è¦æµ‹è¯•å®ƒçš„åˆæ³•æ€§ã€‚ æŒ‡é’ˆä¸å¼•ç”¨çš„å¦ä¸€ä¸ªé‡è¦çš„ä¸åŒæ˜¯æŒ‡é’ˆå¯ä»¥è¢«é‡æ–°èµ‹å€¼ä»¥æŒ‡å‘å¦ä¸€ä¸ªä¸åŒçš„å¯¹è±¡ã€‚ä½†æ˜¯å¼•ç”¨åˆ™æ€»æ˜¯æŒ‡å‘åœ¨åˆå§‹åŒ–æ—¶è¢«æŒ‡å®šçš„å¯¹è±¡ï¼Œä»¥åä¸èƒ½æ”¹å˜ã€‚ å…³äºå¼•ç”¨çš„æ›´å¤šä»‹ç»å‚è€ƒ: https://blog.csdn.net/fengbingchun/article/details/69820184 void printDouble(const double\u0026 rd) { std::cout\u003c\u003crd; // ä¸éœ€è¦æµ‹è¯•rd,å®ƒè‚¯å®šæŒ‡å‘ä¸€ä¸ªdoubleå€¼ } void printDouble(const double* pd) { if (pd) { // æ£€æŸ¥æ˜¯å¦ä¸ºNULL std::cout\u003c\u003c*pd; } } int test_item_1() { char* pc = 0; // è®¾ç½®æŒ‡é’ˆä¸ºç©ºå€¼ char\u0026 rc = *pc; // è®©æŒ‡é’ˆæŒ‡å‘ç©ºå€¼ï¼Œè¿™æ˜¯éå¸¸æœ‰å®³çš„ï¼Œç»“æœå°†æ˜¯ä¸ç¡®å®šçš„ //std::string\u0026 rs; // é”™è¯¯ï¼Œå¼•ç”¨å¿…é¡»è¢«åˆå§‹åŒ– std::string s(\"xyzzy\"); std::string\u0026 rs = s; // æ­£ç¡®,rsæŒ‡å‘s std::string* ps; // æœªåˆå§‹åŒ–çš„æŒ‡é’ˆï¼Œåˆæ³•ä½†å±é™© { std::string s1(\"Nancy\"); std::string s2(\"Clancy\"); std::string\u0026 rs = s1; // rså¼•ç”¨s1 std::string* ps = \u0026s1; // psæŒ‡å‘s1 rs = s2; // rsä»æ—§å¼•ç”¨s1,ä½†æ˜¯s1çš„å€¼ç°åœ¨æ˜¯\"Clancy\" ps = \u0026s2; // psç°åœ¨æŒ‡å‘s2,s1æ²¡æœ‰æ”¹å˜ } std::vector\u003cint\u003e v(10); v[5] = 10; // è¿™ä¸ªè¢«èµ‹å€¼çš„ç›®æ ‡å¯¹è±¡å°±æ˜¯æ“ä½œç¬¦[]è¿”å›çš„å€¼ï¼Œå¦‚æœæ“ä½œç¬¦[] // è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼Œé‚£ä¹ˆåä¸€ä¸ªè¯­å¥å°±å¾—è¿™æ ·å†™: *v[5] = 10; return 0; } ","date":"2023-09-06","objectID":"/posts/more_effective_c/:1:1","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 2: æœ€å¥½ä½¿ç”¨ C++è½¬å‹æ“ä½œç¬¦ C++é€šè¿‡å¼•è¿›å››ä¸ªæ–°çš„ç±»å‹è½¬æ¢(cast)æ“ä½œç¬¦å…‹æœäº†Cé£æ ¼ç±»å‹è½¬æ¢çš„ç¼ºç‚¹(è¿‡äºç²—é²ï¼Œèƒ½å…è®¸ä½ åœ¨ä»»ä½•ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼›Cé£æ ¼çš„ç±»å‹è½¬æ¢åœ¨ç¨‹åºè¯­å¥ä¸­éš¾ä»¥è¯†åˆ«)ï¼Œè¿™å››ä¸ªæ“ä½œç¬¦æ˜¯: static_castã€const_castã€dynamic_castã€reinterpret_castã€‚ static_caståœ¨åŠŸèƒ½ä¸ŠåŸºæœ¬ä¸Šä¸Cé£æ ¼çš„ç±»å‹è½¬æ¢ä¸€æ ·å¼ºå¤§ï¼Œå«ä¹‰ä¹Ÿä¸€æ ·ã€‚å®ƒä¹Ÿæœ‰åŠŸèƒ½ä¸Šé™åˆ¶ã€‚ä¾‹å¦‚ï¼Œä¸èƒ½ç”¨static_caståƒç”¨C é£æ ¼çš„ç±»å‹è½¬æ¢ä¸€æ ·æŠŠstructè½¬æ¢æˆintç±»å‹æˆ–è€…æŠŠdoubleç±»å‹è½¬æ¢æˆæŒ‡é’ˆç±»å‹ï¼Œå¦å¤–ï¼Œstatic_castä¸èƒ½ä»è¡¨è¾¾å¼ä¸­å»é™¤constå±æ€§ï¼Œå› ä¸ºå¦ä¸€ä¸ªæ–°çš„ç±»å‹è½¬æ¢æ“ä½œç¬¦const_castæœ‰è¿™æ ·çš„åŠŸèƒ½ã€‚ const_castç”¨äºç±»å‹è½¬æ¢æ‰è¡¨è¾¾å¼çš„constæˆ–volatilenesså±æ€§ã€‚å¦‚æœä½ è¯•å›¾ä½¿ç”¨const_castæ¥å®Œæˆä¿®æ”¹constnessæˆ–è€…volatilenesså±æ€§ä¹‹å¤–çš„äº‹æƒ…ï¼Œä½ çš„ç±»å‹è½¬æ¢å°†è¢«æ‹’ç»ã€‚ dynamic_castè¢«ç”¨äºå®‰å…¨åœ°æ²¿ç€ç±»çš„ç»§æ‰¿å…³ç³»å‘ä¸‹è¿›è¡Œç±»å‹è½¬æ¢ã€‚è¿™å°±æ˜¯è¯´ï¼Œä½ èƒ½ç”¨dynamic_castæŠŠæŒ‡å‘åŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢æˆæŒ‡å‘å…¶æ´¾ç”Ÿç±»æˆ–å…¶å…„å¼Ÿç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œè€Œä¸”ä½ èƒ½çŸ¥é“è½¬æ¢æ˜¯å¦æˆåŠŸã€‚å¤±è´¥çš„è½¬æ¢å°†è¿”å›ç©ºæŒ‡é’ˆ(å½“å¯¹æŒ‡é’ˆè¿›è¡Œç±»å‹è½¬æ¢æ—¶)æˆ–è€…æŠ›å‡ºå¼‚å¸¸(å½“å¯¹å¼•ç”¨è¿›è¡Œç±»å‹è½¬æ¢æ—¶)ã€‚dynamic_caståœ¨å¸®åŠ©ä½ æµè§ˆç»§æ‰¿å±‚æ¬¡ä¸Šæ˜¯æœ‰é™åˆ¶çš„ï¼Œå®ƒä¸èƒ½è¢«ç”¨æ¥ç¼ºä¹è™šå‡½æ•°çš„ç±»å‹ä¸Šï¼Œä¹Ÿä¸èƒ½ç”¨å®ƒæ¥è½¬æ¢æ‰constnessã€‚å¦‚ä½ æƒ³åœ¨æ²¡æœ‰ç»§æ‰¿å…³ç³»çš„ç±»å‹ä¸­è¿›è¡Œè½¬æ¢ï¼Œä½ å¯èƒ½æƒ³åˆ°static_castã€‚å¦‚æœæ˜¯ä¸ºäº†å»é™¤constï¼Œä½ æ€»å¾—ç”¨const_castã€‚ reinterpret_castä½¿ç”¨è¿™ä¸ªæ“ä½œç¬¦çš„ç±»å‹è½¬æ¢ï¼Œå…¶è½¬æ¢ç»“æœå‡ ä¹éƒ½æ˜¯æ‰§è¡ŒæœŸå®šä¹‰(implementation-defined)ã€‚å› æ­¤ï¼Œä½¿ç”¨reinterpret_castçš„ä»£ç å¾ˆéš¾ç§»æ¤ã€‚æ­¤æ“ä½œç¬¦æœ€æ™®é€šçš„ç”¨é€”å°±æ˜¯åœ¨å‡½æ•°æŒ‡é’ˆä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚ å…³äºç±»å‹è½¬æ¢æ›´å¤šä»‹ç»å‚è€ƒ: https://blog.csdn.net/fengbingchun/article/details/51235498 class Widget { public: virtual void func() {} }; class SpecialWidget : public Widget { public: virtual void func() {} }; void update(SpecialWidget* psw) {} void updateViaRef(SpecialWidget\u0026 rsw) {} typedef void (*FuncPtr)(); // FuncPtræ˜¯ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ int doSomething() { return 1; }; int test_item_2() { int firstNumber = 1, secondNumber = 1; double result1 = ((double)firstNumber) / secondNumber; // Cé£æ ¼ double result2 = static_cast\u003cdouble\u003e(firstNumber) / secondNumber; // C++é£æ ¼ç±»å‹è½¬æ¢ SpecialWidget sw; // swæ˜¯ä¸€ä¸ªéconstå¯¹è±¡ const SpecialWidget\u0026 csw = sw; // cswæ˜¯swçš„ä¸€ä¸ªå¼•ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªconstå¯¹è±¡ //update(\u0026csw); // é”™è¯¯ï¼Œä¸èƒ½ä¼ é€’ä¸€ä¸ªconst SpecialWidget*å˜é‡ç»™ä¸€ä¸ªå¤„ç†SpecialWidget*ç±»å‹å˜é‡çš„å‡½æ•° update(const_cast\u003cSpecialWidget*\u003e(\u0026csw)); // æ­£ç¡®ï¼Œcswçš„constæ˜¾ç¤ºåœ°è½¬æ¢æ‰(cswå’Œswä¸¤ä¸ªå˜é‡å€¼åœ¨updateå‡½æ•°ä¸­èƒ½è¢«æ›´æ–°) update((SpecialWidget*)\u0026csw); // åŒä¸Šï¼Œä½†ç”¨äº†ä¸€ä¸ªæ›´éš¾è¯†åˆ«çš„Cé£æ ¼çš„ç±»å‹è½¬æ¢ Widget* pw = new SpecialWidget; //update(pw); // é”™è¯¯ï¼Œpwçš„ç±»å‹æ˜¯Widget*ï¼Œä½†æ˜¯updateå‡½æ•°å¤„ç†çš„æ˜¯SpecialWidget*ç±»å‹ //update(const_cast\u003cSpecialWidget*\u003e(pw)); // é”™è¯¯ï¼Œconst_castä»…èƒ½è¢«ç”¨åœ¨å½±å“constness or volatilenessçš„åœ°æ–¹ï¼Œä¸èƒ½ç”¨åœ¨å‘ç»§æ‰¿å­ç±»è¿›è¡Œç±»å‹è½¬æ¢ Widget* pw2 = nullptr; update(dynamic_cast\u003cSpecialWidget*\u003e(pw2)); // æ­£ç¡®ï¼Œä¼ é€’ç»™updateå‡½æ•°ä¸€ä¸ªæŒ‡é’ˆæ˜¯æŒ‡å‘å˜é‡ç±»å‹ä¸ºSpecialWidgetçš„pw2çš„æŒ‡é’ˆï¼Œ å¦‚æœpw2ç¡®å®æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œå¦åˆ™ä¼ é€’è¿‡å»çš„å°†æ˜¯ç©ºæŒ‡é’ˆ Widget* pw3 = new SpecialWidget; updateViaRef(dynamic_cast\u003cSpecialWidget\u0026\u003e(*pw3)); // æ­£ç¡®ï¼Œä¼ é€’ç»™updateViaRefå‡½æ•°SpecailWidget pw3æŒ‡é’ˆï¼Œå¦‚æœpw3ç¡®å®æŒ‡å‘äº†æŸä¸ªå¯¹è±¡ï¼Œå¦åˆ™å°†æŠ›å‡ºå¼‚å¸¸ //double result3 = dynamic_cast\u003cdouble\u003e(firstNumber) / secondNumber; // é”™è¯¯ï¼Œæ²¡æœ‰ç»§æ‰¿å…³ç³» const SpecialWidget sw4; //update(dynamic_cast\u003cSpecialWidget*\u003e(\u0026sw4)); // é”™è¯¯ï¼Œdynamic_castä¸èƒ½è½¬æ¢æ‰const FuncPtr funcPtrArray[10]; // funcPtrArrayæ˜¯ä¸€ä¸ªèƒ½å®¹çº³10ä¸ªFuncPtræŒ‡é’ˆçš„æ•°ç»„ //funcPtrArray[0] = \u0026doSomething; // é”™è¯¯ï¼Œç±»å‹ä¸åŒ¹é… funcPtrArray[0] = reinterpret_cast\u003cFuncPtr\u003e(\u0026doSomething); // è½¬æ¢å‡½æ•°æŒ‡é’ˆçš„ä»£ç æ˜¯ä¸å¯ç§»æ¤çš„(C++ä¸ä¿è¯æ‰€æœ‰çš„å‡½æ•°æŒ‡é’ˆéƒ½è¢«ç”¨ä¸€æ ·çš„æ–¹æ³•è¡¨ç¤º)ï¼Œåœ¨ä¸€äº›æƒ…å†µä¸‹è¿™æ ·çš„è½¬æ¢ä¼šäº§ç”Ÿä¸æ­£ç¡®çš„ç»“æœï¼Œæ‰€ä»¥åº”è¯¥é¿å…è½¬æ¢å‡½æ•°æŒ‡é’ˆç±»å‹ return 0; } ","date":"2023-09-06","objectID":"/posts/more_effective_c/:1:2","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 3: ç»å¯¹ä¸è¦ä»¥å¤šæ€(polymorphically)æ–¹å¼å¤„ç†æ•°ç»„ C++å…è®¸ä½ é€šè¿‡åŸºç±»æŒ‡é’ˆå’Œå¼•ç”¨æ¥æ“ä½œæ´¾ç”Ÿç±»æ•°ç»„ã€‚ä¸è¿‡è¿™æ ¹æœ¬å°±ä¸æ˜¯ä¸€ä¸ªç‰¹æ€§ï¼Œå› ä¸ºè¿™æ ·çš„ä»£ç å‡ ä¹ä»ä¸å¦‚ä½ æ‰€æ„¿åœ°é‚£æ ·è¿è¡Œã€‚æ•°ç»„ä¸å¤šæ€ä¸èƒ½ç”¨åœ¨ä¸€èµ·ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯å¦‚æœä½ ä¸ä»ä¸€ä¸ªå…·ä½“ç±»(concrete classes)(ä¾‹å¦‚BST)æ´¾ç”Ÿå‡ºå¦ä¸€ä¸ªå…·ä½“ç±»(ä¾‹å¦‚BalancedBST)ï¼Œé‚£ä¹ˆä½ å°±ä¸å¤ªå¯èƒ½çŠ¯è¿™ç§ä½¿ç”¨å¤šæ€æ€§æ•°ç»„çš„é”™è¯¯ã€‚ åŸå› : derived class å¯¹è±¡ä¸€èˆ¬æ¯”base classå¯¹è±¡å°ã€‚æ‰€ä»¥å½“ä½¿ç”¨ä¸€ä¸ª base classæ•°ç»„å­˜å‚¨derived classæ—¶ï¼Œåœ¨è®¿é—® array[i] æ—¶ï¼Œä¼šè®¿é—®array+i*sizeof(base class)çš„åœ°å€ï¼Œé€ æˆè®¿é—®é”™è¯¯ã€‚ ç”±base æŒ‡é’ˆåˆ é™¤ä¸€ä¸ªderived class æ•°ç»„ï¼Œç»“æœæœªå®šä¹‰ã€‚å› ä¸ºåˆ é™¤æ—¶ï¼Œææ„ä»æœ€åä¸€ä¸ªå¼€å§‹ï¼Œä½†æ˜¯è®¡ç®—åœ°å€æ—¶è·Ÿtips1ä¸€æ ·ï¼Œé€ æˆè®¿é—®é”™è¯¯ã€‚ class BST { public: virtual ~BST() { fprintf(stdout, \"BST::~BST\\n\"); } private: int score; }; class BalancedBST : public BST { public: virtual ~BalancedBST() { fprintf(stdout, \"BalancedBST::~BalancedBST\\n\"); } private: int length; int size; // å¦‚æœå¢åŠ æ­¤ä¸€ä¸ªintæˆå‘˜ï¼Œæ‰§è¡Œtest_item_3ä¼šsegmentation faultï¼Œæ³¨é‡Šæ‰æ­¤å˜é‡ï¼Œè¿è¡Œæ­£å¸¸ }; int test_item_3() { fprintf(stdout, \"BST size: %d\\n\", sizeof(BST)); // 16 fprintf(stdout, \"BalancedBST size: %d\\n\", sizeof(BalancedBST)); // 24 BST* p = new BalancedBST[10]; delete [] p; // å¦‚æœsizeof(BST) != sizeof(BalancedBST)ï¼Œåˆ™ä¼šsegmentation fault return 0; } ","date":"2023-09-06","objectID":"/posts/more_effective_c/:1:3","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 4: é¿å…æ— ç”¨çš„ç¼ºçœæ„é€ å‡½æ•° æ„é€ å‡½æ•°èƒ½åˆå§‹åŒ–å¯¹è±¡ï¼Œè€Œç¼ºçœæ„é€ å‡½æ•°åˆ™å¯ä»¥ä¸åˆ©ç”¨ä»»ä½•åœ¨å»ºç«‹å¯¹è±¡æ—¶çš„å¤–éƒ¨æ•°æ®å°±èƒ½åˆå§‹åŒ–å¯¹è±¡ã€‚æœ‰æ—¶è¿™æ ·çš„æ–¹æ³•æ˜¯ä¸é”™çš„ã€‚ä¾‹å¦‚ä¸€äº›è¡Œä¸ºç‰¹æ€§ä¸æ•°å­—ç›¸ä»¿çš„å¯¹è±¡è¢«åˆå§‹åŒ–ä¸ºç©ºå€¼æˆ–ä¸ç¡®å®šçš„å€¼ä¹Ÿæ˜¯åˆç†çš„ï¼Œè¿˜æœ‰æ¯”å¦‚é“¾è¡¨ã€å“ˆå¸Œè¡¨ã€å›¾ç­‰ç­‰æ•°æ®ç»“æ„ä¹Ÿå¯ä»¥è¢«åˆå§‹åŒ–ä¸ºç©ºå®¹å™¨ã€‚ä½†ä¸æ˜¯æ‰€æœ‰çš„å¯¹è±¡éƒ½å±äºä¸Šè¿°ç±»å‹ï¼Œå¯¹äºå¾ˆå¤šå¯¹è±¡æ¥è¯´ï¼Œä¸åˆ©ç”¨å¤–éƒ¨æ•°æ®è¿›è¡Œå®Œå…¨çš„åˆå§‹åŒ–æ˜¯ä¸åˆç†çš„ã€‚æ¯”å¦‚ä¸€ä¸ªæ²¡æœ‰è¾“å…¥å§“åçš„åœ°å€è–„å¯¹è±¡ï¼Œå°±æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚ åˆ©ç”¨æŒ‡é’ˆæ•°ç»„ä»£æ›¿ä¸€ä¸ªå¯¹è±¡æ•°ç»„è¿™ç§æ–¹æ³•æœ‰ä¸¤ä¸ªç¼ºç‚¹: ç¬¬ä¸€ä½ å¿…é¡»åˆ é™¤æ•°ç»„é‡Œæ¯ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚å¦‚æœå¿˜äº†ï¼Œå°±ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ã€‚ç¬¬äºŒå¢åŠ äº†å†…å­˜åˆ†é…é‡ï¼Œå› ä¸ºæ­£å¦‚ä½ éœ€è¦ç©ºé—´æ¥å®¹çº³EquipmentPieceå¯¹è±¡ä¸€æ ·ï¼Œä½ ä¹Ÿéœ€è¦ç©ºé—´æ¥å®¹çº³æŒ‡é’ˆã€‚ å¯¹äºç±»é‡Œæ²¡æœ‰å®šä¹‰ç¼ºçœæ„é€ å‡½æ•°è¿˜ä¼šé€ æˆå®ƒä»¬æ— æ³•åœ¨è®¸å¤šåŸºäºæ¨¡æ¿(template-based)çš„å®¹å™¨ç±»é‡Œä½¿ç”¨ã€‚å› ä¸ºå®ä¾‹åŒ–ä¸€ä¸ªæ¨¡æ¿æ—¶ï¼Œæ¨¡æ¿çš„ç±»å‹å‚æ•°åº”è¯¥æä¾›ä¸€ä¸ªç¼ºçœæ„é€ å‡½æ•°ã€‚åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œé€šè¿‡ä»”ç»†è®¾è®¡æ¨¡æ¿å¯ä»¥æœç»å¯¹ç¼ºçœæ„é€ å‡½æ•°çš„éœ€æ±‚ã€‚ class EquipmentPiece { public: EquipmentPiece(int IDNumber) {} }; int test_item_4() { //EquipmentPiece bestPieces[10]; // é”™è¯¯ï¼Œæ²¡æœ‰æ­£ç¡®è°ƒç”¨EquipmentPieceæ„é€ å‡½æ•° //EquipmentPiece* bestPieces2 = new EquipmentPiece[10]; // é”™è¯¯ï¼Œä¸ä¸Šé¢çš„é—®é¢˜ä¸€æ · int ID1 = 1, ID2 = 2; EquipmentPiece bestPieces3[] = { EquipmentPiece(ID1), EquipmentPiece(ID2) }; // æ­£ç¡®ï¼Œæä¾›äº†æ„é€ å‡½æ•°çš„å‚æ•° // åˆ©ç”¨æŒ‡é’ˆæ•°ç»„æ¥ä»£æ›¿ä¸€ä¸ªå¯¹è±¡æ•°ç»„ typedef EquipmentPiece* PEP; // PEPæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªEquipmentPieceå¯¹è±¡ PEP bestPieces4[10]; // æ­£ç¡®ï¼Œæ²¡æœ‰è°ƒç”¨æ„é€ å‡½æ•° PEP* bestPieces5 = new PEP[10]; // ä¹Ÿæ­£ç¡® // åœ¨æŒ‡é’ˆæ•°ç»„é‡Œçš„æ¯ä¸€ä¸ªæŒ‡é’ˆè¢«é‡æ–°èµ‹å€¼ï¼Œä»¥æŒ‡å‘ä¸€ä¸ªä¸åŒçš„EquipmentPieceå¯¹è±¡ for (int i = 0; i \u003c 10; ++i) bestPieces5[i] = new EquipmentPiece(ID1); // ä¸ºæ•°ç»„åˆ†é…raw memory,å¯ä»¥é¿å…æµªè´¹å†…å­˜ï¼Œä½¿ç”¨placement newæ–¹æ³•åœ¨å†…å­˜ä¸­æ„é€ EquipmentPieceå¯¹è±¡ void* rawMemory = operator new[](10*sizeof(EquipmentPiece)); // make bestPieces6 point to it so it can be treated as an EquipmentPiece array EquipmentPiece* bestPieces6 = static_cast\u003cEquipmentPiece*\u003e(rawMemory); // construct the EquipmentPiece objects in the memoryä½¿ç”¨\"placement new\" for (int i = 0; i \u003c 10; ++i) new(\u0026bestPieces6[i]) EquipmentPiece(ID1); // ... // ä»¥ä¸æ„é€ bestPieces6å¯¹è±¡ç›¸åçš„é¡ºåºè§£æ„å®ƒ for (int i = 9; i \u003e= 0; --i) bestPieces6[i].~EquipmentPiece(); // å¦‚æœä½¿ç”¨æ™®é€šçš„æ•°ç»„åˆ é™¤æ–¹æ³•ï¼Œç¨‹åºçš„è¿è¡Œå°†æ˜¯ä¸å¯é¢„æµ‹çš„ // deallocate the raw memory delete [] rawMemory; return 0; } ","date":"2023-09-06","objectID":"/posts/more_effective_c/:1:4","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"äºŒã€è¿ç®—ç¬¦(æ“ä½œç¬¦) ","date":"2023-09-06","objectID":"/posts/more_effective_c/:2:0","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 5: è°¨æ…å®šä¹‰ç±»å‹è½¬æ¢å‡½æ•° C++ å…è®¸å†…ç½®æ•°æ®ç±»å‹ä¹‹é—´(ä¾‹å¦‚charå’Œintï¼Œintå’Œdoubleç­‰)è¿›è¡Œéšå¼è½¬æ¢ï¼Œå¯¹äºå†…ç½®ç±»å‹ä¹‹é—´çš„éšå¼è½¬æ¢æœ‰è¯¦ç»†çš„è§„åˆ™ï¼Œä½†ä¸ç®¡æ€æ ·ï¼Œè¿™äº›éƒ½æ˜¯è¯­è¨€æä¾›çš„ï¼Œæ—¢ç›¸å¯¹å®‰å…¨ï¼Œæˆ‘ä»¬åˆæ— æ³•æ›´æ”¹ã€‚ å¯¹äºè‡ªå®šä¹‰çš„ç±»ç±»å‹ï¼Œéšå¼è½¬æ¢å¯ä»¥é€šè¿‡å•å‚æ•°æ„é€ å‡½æ•°(single-argument constructors)å’Œéšå¼ç±»å‹è½¬æ¢æ“ä½œç¬¦æ¥å®ç°ã€‚æ‰€è°“â€å•ä¸€è‡ªå˜é‡(å•å‚æ•°)æŒ‡çš„æ˜¯å¯ä»¥æœ‰å¤šä¸ªå‚æ•°ï¼Œä½†é™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°å…¶ä»–å‚æ•°å¿…é¡»æœ‰é»˜è®¤å®å‚)ã€‚æ‰€è°“éšå¼ç±»å‹è½¬æ¢æ“ä½œç¬¦ï¼Œæ˜¯ä¸€ä¸ª member function: å…³é”®è¯operator ä¹‹ååŠ ä¸€ä¸ªç±»å‹åç§°ï¼Œä¾‹å¦‚: operator double() const; class Rational { public: ... operator double() const; // å°†Rational è½¬æ¢ä¸º double } è¿™ä¸ªå‡½æ•°ä¼šåœ¨ä»¥ä¸‹æƒ…å†µè¢«è‡ªåŠ¨è°ƒç”¨: Rational r(1, 2); // rçš„å€¼æ˜¯ 1/2 double d = 0.5 * r; // å°†rçš„å€¼è½¬æ¢ä¸ºdoubleï¼Œç„¶åæ‰§è¡Œè¿ç®—ã€‚ ä½†æ˜¯ä¸‹é¢è¿™ä¸ªæƒ…å†µå°±ä¼šå‡ºé—®é¢˜: std::cout \u003c\u003c r; å¦‚æœä½ å¿˜äº†ä¸º Rational ç±»é‡è½½ä¸€ä¸ª operatorÂ«ï¼Œé‚£ä¹ˆæŒ‰é“ç†åº”è¯¥æ‰“å°ä¸æˆåŠŸã€‚ä½†æ˜¯ç¼–è¯‘å™¨é¢å¯¹ä¸Šè¿°åŠ¨ä½œï¼Œå®ƒä¼šæƒ³å°½åŠæ³•(åŒ…æ‹¬æ‰¾å‡ºä¸€ç³»åˆ—å¯æ¥å—çš„éšå¼ç±»å‹è½¬æ¢)è®©å‡½æ•°è°ƒç”¨åŠ¨ä½œæˆåŠŸã€‚æ­¤æ—¶ç¼–è¯‘å™¨å‘ç° åªéœ€è°ƒç”¨ Rational::operator doubleï¼Œ å°† r è½¬æ¢ä¸º doubleï¼Œå°±å¯ä»¥æˆåŠŸè°ƒç”¨ std::cout Â« r;ï¼Œä»¥æµ®ç‚¹æ•°çš„å½¢å¼è¾“å‡ºã€‚ è§£å†³åŠæ³•å°±æ˜¯ä»¥åŠŸèƒ½å¯¹ç­‰çš„å¦ä¸€ä¸ªå‡½æ•°å–ä»£ç±»å‹è½¬æ¢æ“ä½œç¬¦ã€‚å³: å®šä¹‰ä¸€ä¸ª doube asDouble() const;å‡½æ•°ã€‚è™½ç„¶ä½¿ç”¨æ—¶æœ‰äº›è®¸ä¸ä¾¿ï¼Œä½†â€œå¯å› ä¸ºä¸å†é»˜é»˜è°ƒç”¨é‚£äº›ä¸æ‰“ç®—è°ƒç”¨çš„å‡½æ•°è€Œè·å¾—å¼¥è¡¥â€ã€‚C++ æ ‡å‡†åº“ä¸­çš„ string ç±»ä»æ²¡æœ‰ string åˆ° char* çš„éšå¼ç±»å‹è½¬æ¢æ“ä½œç¬¦è€Œé‡‡ç”¨ c_str å‡½æ•°å¯èƒ½å°±æ˜¯è¿™ä¸ªåŸå› ã€‚ æ‹¥æœ‰å•ä¸ªå‚æ•°(æˆ–é™¤ç¬¬ä¸€ä¸ªå‚æ•°å¤–éƒ½æœ‰é»˜è®¤å€¼çš„å¤šå‚æ•°)æ„é€ å‡½æ•°çš„ç±»ï¼Œå¾ˆå®¹æ˜“è¢«éšå¼ç±»å‹è½¬æ¢ï¼Œæœ€å¥½åŠ ä¸Š explicit é˜²æ­¢éšå¼ç±»å‹è½¬æ¢ã€‚ template\u003cclass T\u003e class Array{ public: Array(int size); T\u0026 operator[](int index); }; bool operator==(const Array\u003cint\u003e \u0026lhs, const Array\u003cint\u003e \u0026 rhs); Array\u003cint\u003e a(10), b(10); for(int i=0; i\u003c10; ++i){ if(a == b[i]){ //æƒ³è¦å†™ a[i] == b[i]ï¼Œä½†æ˜¯è¿™æ—¶å€™ç¼–è¯‘å™¨å¹¶ä¸ä¼šæŠ¥é”™ // do something } else{ // do something } } if(a == b[i]) å¹¶ä¸ä¼šæŠ¥é”™ã€‚å› ä¸ºç¼–è¯‘å™¨å‘ç°åªè¦è°ƒç”¨ Array\\ constructor(éœ€ä¸€ä¸ª int ä½œä¸ºè‡ªå˜é‡)ï¼Œå°±å¯ä»¥æŠŠ int è½¬ä¸º Array\\ objectã€‚å°±ä¼šäº§ç”Ÿç±»ä¼¼è¿™æ ·çš„ä»£ç : if( a == static_cast\u003cArray\u003cint\u003e \u003e(b[i])) å°† b[i] è½¬ä¸º Arrayã€‚æ­¤æ—¶ç¨‹åºä¼šæ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯ç»“æœå´ä¸å°½äººæ„ã€‚ è§£å†³åŠæ³•å°±æ˜¯ä½¿ç”¨ C++ ç‰¹æ€§: å…³é”®è¯ explicitã€‚è¿™ä¸ªç‰¹æ€§ä¹‹æ‰€ä»¥è¢«å¯¼å…¥ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³éšå¼ç±»å‹è½¬æ¢å¸¦æ¥çš„é—®é¢˜ã€‚explict Array(int size); è¿˜æœ‰ä¸€ç§è¢«ç§°ä¸º proxy classes çš„æ–¹æ³•: class Array { public: class ArraySize { // è¿™ä¸ªç±»æ˜¯æ–°çš„ public: ArraySize(int numElements):theSize(numElements){} int size() const { return theSize;} private: int theSize; }; Array(int lowBound, int highBound); Array(ArraySize size); // æ³¨æ„æ–°çš„å£°æ˜ ... }; è¿™æ ·å†™çš„ä»£ç åœ¨ Array\\ a(10); çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šå…ˆé€šè¿‡ç±»å‹è½¬æ¢å°† int è½¬æ¢æˆ ArraySizeï¼Œç„¶åå†è¿›è¡Œæ„é€ ï¼Œè™½ç„¶éº»çƒ¦å¾ˆå¤šï¼Œæ•ˆç‡ä¹Ÿä½äº†å¾ˆå¤šï¼Œä½†æ˜¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥é¿å…éšå¼è½¬æ¢å¸¦æ¥çš„é—®é¢˜ã€‚ å¯¹äºè‡ªå®šä¹‰ç±»å‹çš„ç±»å‹è½¬æ¢ï¼Œæœ‰ä¸€ä¸ªè§„åˆ™: â€œæ²¡æœ‰ä»»ä½•ä¸€ä¸ªè½¬æ¢ç¨‹åºå¯ä»¥å†…å«ä¸€ä¸ªä»¥ä¸Šçš„â€˜ç”¨æˆ·å®šåˆ¶è½¬æ¢è¡Œä¸ºâ€™(äº¦å³å•è‡ªå˜é‡constructoräº¦å³éšå¼ç±»å‹è½¬æ¢æ“ä½œç¬¦)\"ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¿…è¦çš„æ—¶å€™ç¼–è¯‘å™¨å¯ä»¥å…ˆè¿›è¡Œå†…ç½®ç±»å‹ä¹‹é—´çš„è½¬æ¢å†è°ƒç”¨å¸¦å•è‡ªå˜é‡çš„æ„é€ å‡½æ•°æˆ–è€…å…ˆè°ƒç”¨éšå¼ç±»å‹è½¬æ¢æ“ä½œç¬¦åœ¨è¿›è¡Œå†…ç½®ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼Œä½†ä¸å¯èƒ½è¿ç»­è¿›è¡Œä¸¤æ¬¡ç”¨æˆ·å®šåˆ¶çš„ç±»å‹è½¬æ¢ï¼ æ‰€ä»¥ æ­¤æ—¶ if(a == b[i]) å°±ä¼šæŠ¥é”™ã€‚ä¸èƒ½ä» int è½¬æ¢æˆ ArraySizeï¼Œå†ä» ArraySize è½¬ä¸º Arrayã€‚ æ€»ç»“å…è®¸ç¼–è¯‘å™¨æ‰§è¡Œéšå¼è½¬æ¢å¼Šå¤§äºåˆ©ï¼Œæ‰€ä»¥éå¿…è¦ä¸è¦æä¾›è½¬æ¢å‡½æ•°ï¼ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:2:1","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 6: åŒºåˆ« increment/decrement æ“ä½œç¬¦çš„å‰ç½®å’Œåç½®å½¢å¼s ç”±äº increment/decrement æ“ä½œç¬¦çš„å‰ç½®å’Œåç½®å¼éƒ½æ˜¯ä¸€å…ƒè¿ç®—ç¬¦ï¼Œæ²¡æœ‰å‚æ•°ã€‚å› æ­¤é‡è½½æ—¶é€šè¿‡åœ¨åç½®å¼ä¸­åŠ ä¸€ä¸ª int å‹å‚æ•°(å“‘å…ƒå‚æ•°)åŠ ä»¥åŒºåˆ†ï¼Œå½“åç½®å¼è¢«è°ƒç”¨æ—¶ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨åœ¨ä¸ºè¯¥å‚æ•°æŒ‡å®šä¸€ä¸ª0å€¼ã€‚ class UPInt{ public: UPInt\u0026 operator++(); // å‰ç½®å¼++ const UPInt operator++(int); // åç½®å¼++ UPInt\u0026 operator--(); // å‰ç½®å¼-- const UPInt operator++(int); // å‰ç½®å¼-- } å‰ç½®ç´¯åŠ æ“ä½œç¬¦å’Œåç½®ç´¯åŠ æ“ä½œç¬¦å®ç°: // å‰ç¼€å½¢å¼: å¢åŠ ç„¶åå–å›å€¼ UPInt\u0026 UPInt::operator++() { *this += 1; // å¢åŠ  return *this; // å–å›å€¼ } // postfix form: fetch and increment const UPInt UPInt::operator++(int) { UPInt oldValue = *this; ++(*this); // å–å›å€¼ // å¢åŠ  return oldValue; // è¿”å›è¢«å–å›çš„å€¼ } å‰ç½®å¼è¿”å› referenceï¼Œåç½®å¼è¿”å› const å¯¹è±¡ï¼ åç½® operator++(int) çš„å åŠ æ˜¯ä¸å…è®¸çš„ï¼Œå³: i++++ã€‚ åŸå› æœ‰ä¸¤ä¸ª: ä¸€æ˜¯ä¸å†…å»ºç±»å‹è¡Œä¸ºä¸ä¸€è‡´(å†…å»ºç±»å‹æ”¯æŒå‰ç½®å åŠ )ï¼›äºŒæ˜¯å…¶æ•ˆæœè·Ÿè°ƒç”¨ä¸€æ¬¡ operator++(int) æ•ˆæœä¸€æ ·ï¼Œè¿™æ˜¯è¿åç›´è§‰çš„ã€‚å¦å¤–ï¼Œåç½®å¼æ“ä½œç¬¦ä½¿ç”¨ operator++(int)ï¼Œå‚æ•°çš„å”¯ä¸€ç›®çš„åªæ˜¯ä¸ºäº†åŒºåˆ«å‰ç½®å¼å’Œåç½®å¼è€Œå·²ï¼Œå½“å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œç¼–è¯‘å™¨ä¼ é€’ä¸€ä¸ª0ä½œä¸ºintå‚æ•°çš„å€¼ä¼ é€’ç»™è¯¥å‡½æ•°ã€‚ å¤„ç†ç”¨æˆ·å®šåˆ¶ç±»å‹æ—¶ï¼Œåº”è¯¥å°½å¯èƒ½ä½¿ç”¨å‰ç½®å¼ã€‚ åç½®å¼increment å’Œdecrement æ“ä½œç¬¦çš„å®ç°åº”ä»¥å…¶å‰ç½®å¼å…„å¼Ÿä¸ºåŸºç¡€ã€‚å¦‚æ­¤ä¸€æ¥ä½ å°±åªéœ€ç»´æŠ¤å‰ç½®å¼ç‰ˆæœ¬ï¼Œå› ä¸ºåç½®å¼ç‰ˆæœ¬ä¼šè‡ªåŠ¨è°ƒæ•´ä¸ºä¸€è‡´çš„è¡Œä¸ºã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:2:2","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 7: åƒä¸‡ä¸è¦é‡è½½\u0026\u0026ï¼Œ|| å’Œï¼Œæ“ä½œç¬¦ C++ å¯¹äºâ€œçœŸå‡å€¼è¡¨è¾¾å¼â€ é‡‡ç”¨æ‰€è°“çš„â€œçŸ­è·¯â€ è¯„ä¼°æ–¹å¼(short-circuit evaluation)ã€‚æ„æ€æ˜¯ä¸€æ—¦è¯¥è¡¨è¾¾å¼çš„çœŸä»·å€¼ç¡®å®šï¼ŒåŠæ—¶è¡¨è¾¾å¼ä¸­è¿˜ä»¥åéƒ¨åˆ†å°šæœªæ£€éªŒï¼Œæ•´ä¸ªè¯„ä¼°å·¥ä½œä»ç„¶ç»“æŸã€‚ â€œå‡½æ•°è°ƒç”¨â€è¯­ä¹‰å’Œæ‰€è°“çš„â€œçŸ­è·¯â€ è¯„ä¼°æ–¹å¼è¯­ä¹‰æœ‰ä¸¤ä¸ªé‡å¤§çš„åŒºåˆ«ã€‚ç¬¬ä¸€ï¼Œå½“å‡½æ•°è°ƒç”¨åŠ¨ä½œè¢«æ‰§è¡Œï¼Œæ‰€æœ‰å‚æ•°å€¼éƒ½å¿…é¡»è¯„ä¼°å®Œæˆï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è°ƒç”¨ operator\u0026\u0026å’Œ operator||æ—¶ï¼Œä¸¤ä¸ªå‚æ•°éƒ½å·²è¯„ä¼°å®Œæˆã€‚æ¢å¥è¯è¯´æ²¡æœ‰ä»€ä¹ˆéª¤æ­»å¼è¯­ä¹‰ã€‚ç¬¬äºŒï¼ŒC++è¯­è¨€è§„èŒƒå¹¶æœªæ˜ç¡®å®šä¹‰å‡½æ•°è°ƒç”¨åŠ¨ä½œä¸­å„å‚æ•°çš„è¯„ä¼°é¡ºåºï¼Œæ‰€ä»¥æ²¡åŠæ³•çŸ¥é“expression1 å’Œ expression2 å“ªä¸ªä¼šå…ˆè¢«è¯„ä¼°ã€‚è¿™ä¸éª¤æ­»å¼è¯„ä¼°æ³•å½¢æˆä¸€ä¸ªæ˜ç¡®çš„å¯¹æ¯”ï¼Œåè€…æ€»æ˜¯ç”±å·¦å‘å³è¯„ä¼°å…¶è‡ªå˜é‡ã€‚ C++åŒæ ·ä¹Ÿæœ‰ä¸€äº›è§„åˆ™ç”¨æ¥å®šä¹‰é€—å·æ“ä½œç¬¦é¢å¯¹å†…å»ºç±»å‹çš„è¡Œä¸ºã€‚è¡¨è¾¾å¼å¦‚æœå†…å«é€—å·ï¼Œé‚£ä¹ˆé€—å·å·¦ä¾§ä¼šå…ˆè¢«è¯„ä¼°ï¼Œç„¶åé€—å·çš„å³ä¾§å†è¢«è¯„ä¼°ï¼›æœ€åï¼Œæ•´ä¸ªé€—å·è¡¨è¾¾å¼çš„ç»“æœä»¥é€—å·å³ä¾§çš„å€¼ä¸ºä»£è¡¨ã€‚ ä½ ä¸èƒ½é‡è½½ä»¥ä¸‹æ“ä½œç¬¦: . .* :: ?: new delete sizeof typeid static_cast dynamic_cast const_cast reinterpret_cast ","date":"2023-09-06","objectID":"/posts/more_effective_c/:2:3","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾8: äº†è§£å„ç§ä¸åŒæ„ä¹‰çš„ new å’Œ delete new operator: newæ“ä½œç¬¦ï¼Œç”¨äºåŠ¨æ€åˆ†é…å†…å­˜å¹¶è¿›è¡Œåˆå§‹åŒ–, å®ƒçš„åŠ¨ä½œåˆ†ä¸ºä¸¤æ–¹é¢ã€‚ç¬¬ä¸€ï¼Œå®ƒåˆ†é…è¶³å¤Ÿçš„å†…å­˜ï¼Œç”¨æ¥æ”¾ç½®æŸç±»å‹çš„å¯¹è±¡ã€‚ä»¥ä¸Šä¾‹è€Œè¨€ï¼Œå®ƒåˆ†é…è¶³å¤Ÿæ”¾ç½®ä¸€ä¸ªstring å¯¹è±¡çš„å†…å­˜ã€‚ç¬¬äºŒï¼Œå®ƒè°ƒç”¨ä¸€ä¸ª constructorï¼Œä¸ºåˆšæ‰åˆ†é…çš„å†…å­˜ä¸­çš„é‚£ä¸ªå¯¹è±¡è®¾å®šåˆå€¼ã€‚; new operatorï¼Œä¸èƒ½è¢«é‡è½½ å½“ä½ å†™å‡ºè¿™æ ·çš„ä»£ç : string *ps = new string(â€œMemory Mangementâ€); ä½ æ‰€ä½¿ç”¨çš„ new æ˜¯æ‰€è°“çš„ new operatorã€‚å®ƒçš„åŠ¨ä½œåˆ†ä¸ºä¸¤ä¸ªæ–¹é¢: 1ã€åˆ†é…è¶³å¤Ÿçš„å†…å­˜ï¼Œç”¨æ¥æ”¾ç½®æŸç±»å‹çš„å¯¹è±¡ï¼›2ã€è°ƒç”¨ constructorï¼Œä¸ºåˆšæ‰çš„å†…å­˜ä¸­çš„é‚£ä¸ªå¯¹è±¡è®¾å®šåˆå€¼ã€‚ operator new: æ ‡å‡†åº“çš„å‡½æ•°ï¼Œåªåˆ†é…å†…å­˜ä¸è¿›è¡Œåˆå§‹åŒ–(æˆ–è€…ä¼ é€’ä¸€ä¸ªå¯ç”¨çš„å†…å­˜åœ°å€)ï¼Œå¯ä»¥è‡ªå·±è¿›è¡Œé‡è½½ï¼Œä¹Ÿå¯ä»¥ä¸»åŠ¨è°ƒç”¨ã€‚ å’Œ malloc ä¸€æ ·ï¼Œoperator new çš„å”¯ä¸€ä»»åŠ¡å°±æ˜¯åˆ†é…å†…å­˜ã€‚ void *rawMemory = operator new(sizeof(string)); è¿”å›å€¼ç±»å‹æ˜¯ void* ï¼ï¼ï¼ å¯ä»¥é‡è½½ operator newï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹å¿…é¡»æ€»æ˜¯ size_tã€‚ string *ps = new string(\"Memory Mangement\");ç­‰ä»·äº void *rawMemory = operator new(sizeof(string)); // å–å¾—åŸå§‹å†…å­˜ï¼Œç”¨æ¥å­˜æ”¾æœ‰ä¸€ä¸ªstringå¯¹è±¡ call string::string(\"Memory Mangement\") on *memory; // å°†å†…å­˜ä¸­çš„å¯¹è±¡åˆå§‹åŒ– string *ps = static_cast\u003cstring*\u003e(memory); // è®©ps æŒ‡å‘æ–°å®Œæˆçš„å¯¹è±¡ placement new (å®šä½new): new operatorçš„å¦å¤–ä¸€ç§ç”¨æ³• ï¼Œåœ¨å·²åˆ†é…çš„å†…å­˜ä¸Šæ„é€ å¯¹è±¡; æ³¨æ„ æ³¨æ„: new operatoræ˜¯æ“ä½œç¬¦ï¼Œplacement newæ˜¯è¿™ä¸ªæ“ä½œç¬¦çš„ä¸€ç§ç”¨æ³•ï¼Œè€Œoperator newæ˜¯æ ‡å‡†åº“ä¸­çš„å‡½æ•°ï¼Œnew operatorè°ƒç”¨äº† operator newã€‚ å°†å¯¹è±¡äº§ç”Ÿä¸ heapï¼Œè¯·ä½¿ç”¨ new operatorã€‚å®ƒä¸ä½†åˆ†é…å†…å­˜è€Œä¸”ä¸ºè¯¥å¯¹è±¡è°ƒç”¨ä¸€ä¸ª constructorã€‚ å¦‚æœä½ åªæ˜¯æ‰“ç®—åˆ†é…å†…å­˜ï¼Œè¯·è°ƒç”¨ operator newï¼Œé‚£å°±æ²¡æœ‰ä»»ä½• constructor ä¼šè¢«è°ƒç”¨ã€‚ å¦‚æœä½ æ‰“ç®—åœ¨ heap objects äº§ç”Ÿæ—¶è‡ªå·±å†³å®šå†…å­˜åˆ†é…æ–¹å¼ï¼Œè¯·å†™ä¸€ä¸ªè‡ªå·±çš„ operator newï¼Œå¹¶ä½¿ç”¨ new operatorï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨ä½ æ‰€å†™çš„ operator newã€‚ å¦‚æœä½ æ‰“ç®—åœ¨å·²åˆ†é…å¹¶æ‹¥æœ‰æŒ‡é’ˆçš„å†…å­˜ä¸­æ„é€ å¯¹è±¡ï¼Œè¯·ä½¿ç”¨ placement newã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:2:4","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"ä¸‰ã€ å¼‚å¸¸ ç¨‹åºä¹‹æ‰€ä»¥åœ¨ exceptions å‡ºç°æ—¶ä»æœ‰è‰¯å¥½è¡Œä¸ºï¼Œä¸æ˜¯å› ä¸ºç¢°å·§å¦‚æ­¤ï¼Œè€Œæ˜¯å› ä¸ºå®ƒä»¬åŠ å…¥äº† exceptions çš„è€ƒè™‘ã€‚ exceptions æ— æ³•è¢«å¿½ç•¥ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°åˆ©ç”¨â€œè®¾å®šçŠ¶æ€å˜é‡â€çš„æ–¹å¼æˆ–æ˜¯åˆ©ç”¨â€œè¿”å›é”™è¯¯ç â€çš„æ–¹å¼å‘å‡ºä¸€ä¸ªå¼‚å¸¸ä¿¡å·ï¼Œæ— æ³•ä¿è¯æ­¤å‡½æ•°çš„è°ƒç”¨è€…ä¼šæ£€æŸ¥é‚£ä¸ªå˜é‡æˆ–æ£€éªŒé‚£ä¸ªé”™è¯¯ç ã€‚äºæ˜¯ç¨‹åºçš„æ‰§è¡Œå¯èƒ½ä¼šä¸€ç›´ç»§ç»­ä¸‹å»ï¼Œè¿œç¦»é”™è¯¯å‘ç”Ÿåœ°ç‚¹ã€‚ä½†æ˜¯å¦‚æœå‡½æ•°ä»¥æŠ›å‡º exception çš„æ–¹å¼å‘å‡ºå¼‚å¸¸ä¿¡å·ï¼Œè€Œè¯¥ exception æœªè¢«æ•æ‰ï¼Œç¨‹åºçš„æ‰§è¡Œä¾¿ä¼šç«‹åˆ»ä¸­æ­¢ã€‚ å¦‚æœä½ éœ€è¦ä¸€ä¸ªâ€œç»å¯¹ä¸ä¼šè¢«å¿½ç•¥çš„â€å¼‚å¸¸ä¿¡å·å‘å°„æ–¹æ³•ï¼Œè€Œä¸”å‘å°„åçš„ stackå¤„ç†è¿‡ç¨‹åˆèƒ½å¤Ÿç¡®ä¿å±€éƒ¨å¯¹è±¡çš„ destructors è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆä½ éœ€è¦ C++exceptionsã€‚å®ƒæ˜¯æœ€ç®€å•çš„æ–¹æ³•äº†ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:3:0","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 9: åˆ©ç”¨ destructors é¿å…æ³„æ¼èµ„æº æ¯å½“ new ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä¸€å®šè¦ç¡®ä¿æˆåŠŸ delete å®ƒï¼Œå¦åˆ™å°±ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚ void processAdoptions(istream\u0026 dataSource){ while(dataSource){ ALA *pa = readALA(dataSource); // new æ–°çš„å¯¹è±¡ pa-\u003eprocessAdoption(); // å¤„ç†äº‹åŠ¡ delete pa; // åˆ é™¤paæŒ‡å‘çš„å¯¹è±¡ } } ä½†æ˜¯å¦‚æœ pa-\u003eprocessAdoption();æŠ›å‡ºå¼‚å¸¸ï¼Œä¹‹åçš„æ‰€æœ‰è¯­å¥éƒ½ä¼šè¢«è·³è¿‡ï¼Œä¸å†æ‰§è¡Œï¼Œè¿™æ„å‘³ç€ deleta pa;ä¸ä¼šæ‰§è¡Œï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚ è§£å†³æ–¹æ³•1: void processAdoptions(istream\u0026 dataSource){ while(dataSource){ ALA *pa = readALA(dataSource); try{ pa-\u003eprocessAdoption(); } catch(...){ delete pa; //åœ¨æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™é¿å…æ³„éœ² throw; } delete pa; //åœ¨ä¸æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™é¿å…æ³„ } } å› ä¸ºè¿™ç§æƒ…å†µä¼šéœ€è¦åˆ é™¤ä¸¤æ¬¡paï¼Œä»£ç ç»´æŠ¤å¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œä¼˜åŒ–: åªè¦æˆ‘ä»¬èƒ½å¤Ÿå°† â€œä¸€å®šå¾—æ‰§è¡Œçš„æ¸…ç†ä»£ç â€ ç§»åˆ° processAdoptions å‡½æ•°çš„æŸä¸ªå±€éƒ¨å¯¹è±¡çš„ destructors å†…å³å¯ã€‚å› ä¸ºå±€éƒ¨å¯¹è±¡æ€»æ˜¯ä¼šåœ¨å‡½æ•°ç»“æŸæ—¶è¢«ææ„ï¼Œä¸è®ºå‡½æ•°å¦‚ä½•ç»“æŸã€‚ å¦‚ä½•æŠŠ delete åŠ¨ä½œä» processAdoptions å‡½æ•°ç§»åˆ°å‡½æ•°å†…çš„æŸä¸ªå±€éƒ¨å¯¹è±¡çš„ destructor å†…: ä»¥ä¸€ä¸ª â€œç±»ä¼¼æŒ‡é’ˆçš„å¯¹è±¡(æ™ºèƒ½æŒ‡é’ˆ)â€å–ä»£æŒ‡é’ˆ paã€‚å½“è¿™ä¸ªç±»ä¼¼æŒ‡é’ˆçš„å¯¹è±¡è¢«(è‡ªåŠ¨)é”€æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ä»¤å…¶ destructor è°ƒç”¨ deleteã€‚ void processAdoptions(istream\u0026 dataSource){ while(dataSource){ auto_ptr\u003cALA\u003e pa(readALA(dataSource)); // ç°åœ¨auto_ptrå·²è¢«å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨ shared_ptr!!! pa-\u003eprocessAdoption(); } } ","date":"2023-09-06","objectID":"/posts/more_effective_c/:3:1","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 10: åœ¨ constructors å†…é˜»æ­¢èµ„æºæ³„æ¼(resource leak) è€ƒè™‘ä¸‹é¢çš„æƒ…å†µ: BookEntry::BookEntry():theImage(0), theAudioClip(0){ theImage = new Image(imageFileName); theAudioClip = new AudioClip(audioClipFileName); } BookEntry::~BookEntry(){ delete theImage; delete theAudioClip; } å¦‚æœ theAudioClip = new AudioClip(audioClipFileName); æœ‰ exception æŠ›å‡ºï¼Œé‚£ä¹ˆå‡½æ•°æ„é€ å¤±è´¥ï¼Œdestructor è‡ªç„¶ä¸ä¼šè¢«è°ƒç”¨ã€‚ä½†æ˜¯ theImage å¯¹è±¡æ„é€ æˆåŠŸäº†ï¼Œè¿™å°±å¯¼è‡´ BookEntry constructor æ‰€åˆ†é…çš„ Image object è¿˜æ˜¯æ³„æ¼äº†ã€‚ ç”±äºC++ ä¸è‡ªåŠ¨æ¸…ç†é‚£äº› â€œæ„é€ æœŸé—´æŠ›å‡º exceptionsâ€ çš„å¯¹è±¡ï¼Œæ‰€ä»¥ä½ å¿…é¡»è®¾è®¡ä½ çš„ constructorï¼Œä½¿å¾—å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ¸…ç†ã€‚é€šå¸¸åªéœ€å°†æ‰€æœ‰å¯èƒ½çš„ exceptions æ•æ‰èµ·æ¥ï¼Œæ‰§è¡ŒæŸç§æ¸…ç†å·¥ä½œï¼Œç„¶åé‡æ–°æŠ›å‡º exceptionï¼Œä½¿å®ƒç»§ç»­ä¼ æ’­å‡ºå»å³å¯ã€‚ è§£å†³åŠæ³•ä¸€: BookEntry::BookEntry(){ try{ theImage = new Image(imageFileName); theAudioClip = new AudioClip(audioClipFileName); } catch(...){ // åœ¨æ„é€ å‡½æ•°å†…æ•æ‰å¼‚å¸¸ delete theImage; delete theAudioClip; throw; } } ä¸€ä¸ªæ›´å¥½çš„è§£ç­”æ˜¯ï¼Œæ¥æ”¶æ¡æ¬¾9çš„å¿ å‘Šï¼Œå°† theImage å’Œ theAudioClip æ‰€æŒ‡å¯¹è±¡è§†ä¸ºèµ„æºï¼Œäº¤ç»™å±€éƒ¨å¯¹è±¡æ¥ç®¡ç†ã€‚ ä¸è®º theImage å’Œ theAudioClip éƒ½æ˜¯æŒ‡å‘åŠ¨æ€åˆ†é…è€Œå¾—çš„å¯¹è±¡ï¼Œå½“æŒ‡é’ˆæœ¬èº«åœæ­¢æ´»åŠ¨ï¼Œé‚£äº›å¯¹è±¡éƒ½åº”è¯¥è¢«åˆ é™¤ã€‚ class BookEntry{ public:...... private: const auto_ptr\u003cImage\u003e theImage; // åŒæ ·çš„ï¼Œç°åœ¨auto_ptrå·²è¢«å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨ shared_ptr!!! const auto_ptr\u003cAudioClip\u003e theAudioClip; } BookEntry::BookEntry(const string\u0026 imageFileName, const string\u0026 audioClipFileName): theImage(imageFileName != \"\" ? new Image(imageFileName) : 0), theAudioClip(audioClipFileName != \"\" ? new AudiaClip(audioClipFileName) : 0) {} è¿™æ ·ä¸ä»…è§£å†³äº†åœ¨ constructors å†…é˜»æ­¢èµ„æºæ³„æ¼ï¼Œè€Œä¸”è¿˜å¤§å¹…ç®€åŒ– destructorã€‚ BookEntry::~BookEntry(){} // ä¸éœ€è¦åšä»€ä¹ˆäº‹ï¼ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:3:2","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾ 11: ç¦æ­¢å¼‚å¸¸(exceptions)æµå‡ºdestructorsä¹‹å¤– ä¸¤ç§æƒ…å†µä¸‹ destructor ä¼šè¢«è°ƒç”¨ã€‚ç¬¬ä¸€ç§æƒ…å†µæ˜¯å½“å¯¹è±¡åœ¨æ­£å¸¸çŠ¶æ€ä¸‹è¢«é”€æ¯ï¼Œä¹Ÿå°±æ˜¯å½“å®ƒç¦»å¼€äº†å®ƒçš„ç”Ÿå­˜ç©ºé—´(scope)æˆ–æ˜¯è¢«æ˜ç¡®åœ°åˆ é™¤ï¼›ç¬¬äºŒç§æƒ…å†µæ˜¯å½“å¯¹è±¡è¢« exception å¤„ç†æœºåˆ¶â€”â€”ä¹Ÿå°±æ˜¯exception ä¼ æ’­è¿‡ç¨‹ä¸­çš„ stack-unwinding(æ ˆå±•å¼€)æœºåˆ¶â€”â€”é”€æ¯ã€‚ å› ä¸ºå¦‚æœæ§åˆ¶æƒåŸºäº exception çš„å› ç´ ç¦»å¼€ destructorï¼Œè€Œæ­¤æ—¶æ­£æœ‰å¦ä¸€ä¸ª exception å¤„äºä½œç”¨çŠ¶æ€ï¼ŒC++ä¼šè°ƒç”¨ terminate å‡½æ•°ã€‚æ­¤å‡½æ•°çš„ä½œä¸ºæ­£å¦‚å…¶å: å°†ä½ çš„ç¨‹åºç»“æŸæ‰â€”â€”å®ƒä¼šç«‹åˆ»åŠ¨æ‰‹ï¼Œç”šè‡³ä¸ç­‰å±€éƒ¨å¯¹è±¡è¢«é”€æ¯ã€‚ å› æ­¤ï¼Œæœ‰ä¸¤ä¸ªå¥½ç†ç”±æ”¯æŒæˆ‘ä»¬â€œå…¨åŠ›é˜»æ­¢exceptionsä¼ å‡º destructorsä¹‹å¤–â€ã€‚ç¬¬ä¸€ï¼Œå®ƒå¯ä»¥é¿å… terminateå‡½æ•°åœ¨ exceptionä¼ æ’­è¿‡ç¨‹çš„æ ˆå±•å¼€(stack-unwinding)æœºåˆ¶ä¸­è¢«è°ƒç”¨ï¼›ç¬¬äºŒï¼Œå®ƒå¯ä»¥ååŠ©ç¡®ä¿ destructors å®Œæˆå…¶åº”è¯¥å®Œæˆçš„æ‰€æœ‰äº‹æƒ…ã€‚ å¦‚ä½•é¿å…exceptionä¼ å‡ºdestructorä¹‹å¤–å‘¢? åœ¨ææ„å‡½æ•°ä¸­ä½¿ç”¨try{} catch(){}ç»“æ„, å¹¶ä¸”åœ¨catchçš„{}ä¸­ä»€ä¹ˆä¹Ÿä¸åšã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:3:3","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾12: äº†è§£â€œæŠ›å‡ºä¸€ä¸ªexceptionâ€ä¸â€œä¼ é€’ä¸€ä¸ªå‚æ•°â€æˆ–â€œè°ƒç”¨ä¸€ä¸ªè™šå‡½æ•°â€ä¹‹é—´çš„å·®å¼‚ ä½ è°ƒç”¨å‡½æ•°æ—¶ï¼Œç¨‹åºçš„æ§åˆ¶æƒæœ€ç»ˆè¿˜ä¼šè¿”å›åˆ°å‡½æ•°çš„è°ƒç”¨å¤„ï¼Œä½†æ˜¯å½“ä½ æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸æ—¶ï¼Œæ§åˆ¶æƒæ°¸è¿œä¸ä¼šå›åˆ°æŠ›å‡ºå¼‚å¸¸çš„åœ°æ–¹ã€‚ C++è§„èŒƒè¦æ±‚è¢«ä½œä¸ºå¼‚å¸¸æŠ›å‡ºçš„å¯¹è±¡å¿…é¡»è¢«å¤åˆ¶ã€‚å³ä½¿è¢«æŠ›å‡ºçš„å¯¹è±¡ä¸ä¼šè¢«é‡Šæ”¾ï¼Œä¹Ÿä¼šè¿›è¡Œæ‹·è´æ“ä½œã€‚æŠ›å‡ºå¼‚å¸¸è¿è¡Œé€Ÿåº¦æ¯”å‚æ•°ä¼ é€’è¦æ…¢ã€‚ å½“å¼‚å¸¸å¯¹è±¡è¢«æ‹·è´æ—¶ï¼Œæ‹·è´æ“ä½œæ˜¯ç”±å¯¹è±¡çš„æ‹·è´æ„é€ å‡½æ•°å®Œæˆçš„ã€‚è¯¥æ‹·è´æ„é€ å‡½æ•°æ˜¯å¯¹è±¡çš„é™æ€ç±»å‹(static type)æ‰€å¯¹åº”ç±»çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„åŠ¨æ€ç±»å‹(dynamic type)å¯¹åº”ç±»çš„æ‹·è´æ„é€ å‡½æ•°ã€‚ catchå­å¥ä¸­è¿›è¡Œå¼‚å¸¸åŒ¹é…æ—¶å¯ä»¥è¿›è¡Œä¸¤ç§ç±»å‹è½¬æ¢: ç¬¬ä¸€ç§æ˜¯ç»§æ‰¿ç±»ä¸åŸºç±»é—´çš„è½¬æ¢ã€‚ä¸€ä¸ªç”¨æ¥æ•è·åŸºç±»çš„catchå­å¥ä¹Ÿå¯ä»¥å¤„ç†æ´¾ç”Ÿç±»ç±»å‹çš„å¼‚å¸¸ã€‚è¿™ç§æ´¾ç”Ÿç±»ä¸åŸºç±»(inheritance_based)é—´çš„å¼‚å¸¸ç±»å‹è½¬æ¢å¯ä»¥ä½œç”¨äºæ•°å€¼ã€å¼•ç”¨ä»¥åŠæŒ‡é’ˆä¸Šã€‚ ç¬¬äºŒç§æ˜¯å…è®¸ä»ä¸€ä¸ªç±»å‹åŒ–æŒ‡é’ˆ(typed pointer)è½¬å˜æˆæ— ç±»å‹æŒ‡é’ˆ(untyped pointer)ï¼Œæ‰€ä»¥å¸¦æœ‰const void*æŒ‡é’ˆçš„catchå­å¥èƒ½æ•è·ä»»ä½•ç±»å‹çš„æŒ‡é’ˆç±»å‹å¼‚å¸¸ã€‚ catchå­å¥åŒ¹é…é¡ºåºæ€»æ˜¯å–å†³äºå®ƒä»¬åœ¨ç¨‹åºä¸­å‡ºç°çš„é¡ºåºã€‚å› æ­¤ä¸€ä¸ªæ´¾ç”Ÿç±»å¼‚å¸¸å¯èƒ½è¢«å¤„ç†å…¶åŸºç±»å¼‚å¸¸çš„catchå­å¥æ•è·ï¼Œå³ä½¿åŒæ—¶å­˜åœ¨æœ‰èƒ½ç›´æ¥å¤„ç†è¯¥æ´¾ç”Ÿç±»å¼‚å¸¸çš„catchå­å¥ï¼Œä¸ç›¸åŒçš„tryå—ç›¸å¯¹åº”ã€‚ä¸è¦æŠŠå¤„ç†åŸºç±»å¼‚å¸¸çš„catchå­å¥æ”¾åœ¨å¤„ç†æ´¾ç”Ÿç±»å¼‚å¸¸çš„catchå­å¥çš„å‰é¢ã€‚ æŠŠä¸€ä¸ªå¯¹è±¡ä¼ é€’ç»™å‡½æ•°æˆ–ä¸€ä¸ªå¯¹è±¡è°ƒç”¨è™šæ‹Ÿå‡½æ•°ä¸æŠŠä¸€ä¸ªå¯¹è±¡ä½œä¸ºå¼‚å¸¸æŠ›å‡ºï¼Œè¿™ä¹‹é—´æœ‰ä¸‰ä¸ªä¸»è¦åŒºåˆ«: ç¬¬ä¸€ï¼Œå¼‚å¸¸å¯¹è±¡åœ¨ä¼ é€’æ—¶æ€»è¢«è¿›è¡Œæ‹·è´ï¼›å½“é€šè¿‡ä¼ å€¼æ–¹å¼æ•è·æ—¶ï¼Œå¼‚å¸¸å¯¹è±¡è¢«æ‹·è´äº†ä¸¤æ¬¡ã€‚å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°æ—¶ä¸ä¸€å®šéœ€è¦è¢«æ‹·è´ã€‚ ç¬¬äºŒï¼Œå¯¹è±¡ä½œä¸ºå¼‚å¸¸è¢«æŠ›å‡ºä¸ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ç›¸æ¯”ï¼Œå‰è€…ç±»å‹è½¬æ¢æ¯”åè€…è¦å°‘(å‰è€…åªæœ‰ä¸¤ç§è½¬æ¢å½¢å¼)ã€‚ æœ€åä¸€ç‚¹ï¼Œcatchå­å¥è¿›è¡Œå¼‚å¸¸ç±»å‹åŒ¹é…çš„é¡ºåºæ˜¯å®ƒä»¬åœ¨æºä»£ç ä¸­å‡ºç°çš„é¡ºåºï¼Œç¬¬ä¸€ä¸ªç±»å‹åŒ¹é…æˆåŠŸçš„catchå°†è¢«ç”¨æ¥æ‰§è¡Œã€‚å½“ä¸€ä¸ªå¯¹è±¡è°ƒç”¨ä¸€ä¸ªè™šæ‹Ÿå‡½æ•°æ—¶ï¼Œè¢«é€‰æ‹©çš„å‡½æ•°ä½äºä¸å¯¹è±¡ç±»å‹åŒ¹é…æœ€ä½³çš„ç±»é‡Œï¼Œå³ä½¿è¯¥ç±»ä¸æ˜¯åœ¨æºä»£ç çš„æœ€å‰å¤´ã€‚ try_catch ä»‹ç»å‚è€ƒ: https://blog.csdn.net/fengbingchun/article/details/65939258 ","date":"2023-09-06","objectID":"/posts/more_effective_c/:3:4","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾13: ä»¥ by referenceæ–¹å¼æ•æ‰ exceptions catch by pointerçš„é—®é¢˜: ä»–ä»¬æ˜¯å¦åº”è¯¥åˆ é™¤ä»–ä»¬æ¥å—çš„æŒ‡é’ˆï¼Ÿå¦‚æœæ˜¯åœ¨å †ä¸­å»ºç«‹çš„å¼‚å¸¸å¯¹è±¡ï¼Œé‚£ä»–ä»¬å¿…é¡»åˆ é™¤å®ƒï¼Œå¦åˆ™ä¼šé€ æˆèµ„æºæ³„æ¼ã€‚å¦‚æœä¸æ˜¯åœ¨å †ä¸­å»ºç«‹çš„å¼‚å¸¸å¯¹è±¡ï¼Œä»–ä»¬ç»å¯¹ä¸èƒ½åˆ é™¤å®ƒï¼Œå¦åˆ™ç¨‹åºçš„è¡Œä¸ºå°†ä¸å¯é¢„æµ‹ã€‚é€šè¿‡æŒ‡é’ˆæ•è·å¼‚å¸¸ï¼Œå°†é‡åˆ°ä¸€ä¸ªå“ˆå§†é›· ç‰¹å¼çš„éš¾é¢˜: æ˜¯åˆ é™¤è¿˜æ˜¯ä¸åˆ é™¤ï¼Ÿè¿™æ˜¯ä¸€ä¸ªéš¾ä»¥å›ç­”çš„é—®é¢˜ã€‚æ‰€ä»¥ä½ æœ€å¥½é¿å¼€å®ƒã€‚ catch by valueçš„é—®é¢˜: å½“å®ƒä»¬è¢«æŠ›å‡ºæ—¶ç³»ç»Ÿå°†å¯¹å¼‚å¸¸å¯¹è±¡æ‹·è´ä¸¤æ¬¡(å‚è§æ¡æ¬¾ M12)ã€‚ å½“æŠ›å‡ºçš„æ˜¯æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œä½†æ˜¯ç”¨åŸºç±»æ•è·ï¼Œä¼šåœºç”Ÿslicing é—®é¢˜ã€‚ catch by referenceçš„ä¼˜åŠ¿: å¦‚æœ catch by referenceï¼Œä½ å°±å¯ä»¥é¿å¼€å¯¹è±¡åˆ é™¤é—®é¢˜ï¼Œä½ ä¹Ÿå¯ä»¥é¿å¼€ exception objects çš„åˆ‡å‰²(slicing)é—®é¢˜ï¼›ä½ å¯ä»¥ä¿ç•™æ•æ‰æ ‡å‡† exceptions çš„èƒ½åŠ›ï¼›ä½ ä¹Ÿçº¦æŸäº† exception objects éœ€è¢«å¤åˆ¶çš„æ¬¡æ•°ã€‚ é€šè¿‡æŒ‡é’ˆæ•è·å¼‚å¸¸ä¸ç¬¦åˆC++è¯­è¨€æœ¬èº«çš„è§„èŒƒã€‚å››ä¸ªæ ‡å‡†çš„å¼‚å¸¸â€”-bad_alloc(å½“operator newä¸èƒ½åˆ†é…è¶³å¤Ÿçš„å†…å­˜æ—¶è¢«æŠ›å‡º)ï¼›bad_cast(å½“dynamic_casté’ˆå¯¹ä¸€ä¸ªå¼•ç”¨(reference)æ“ä½œå¤±è´¥æ—¶è¢«æŠ›å‡º)ï¼›bad_typeid(å½“dynamic_castå¯¹ç©ºæŒ‡é’ˆè¿›è¡Œæ“ä½œæ—¶è¢«æŠ›å‡º)ï¼›bad_exception(ç”¨äºunexpectedå¼‚å¸¸)â€”-éƒ½ä¸æ˜¯æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆï¼Œæ‰€ä»¥ä½ å¿…é¡»é€šè¿‡å€¼æˆ–å¼•ç”¨æ¥æ•è·å®ƒä»¬ã€‚ std::exceptionçš„ä»‹ç»å‚è€ƒ: https://blog.csdn.net/fengbingchun/article/details/78303734 ","date":"2023-09-06","objectID":"/posts/more_effective_c/:3:5","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾14: å®¡æ…ä½¿ç”¨å¼‚å¸¸è§„æ ¼(exception specifications) å¦‚æœä¸€ä¸ªå‡½æ•°æŠ›å‡ºä¸€ä¸ªä¸åœ¨å¼‚å¸¸è§„æ ¼èŒƒå›´é‡Œçš„å¼‚å¸¸ï¼Œç³»ç»Ÿåœ¨è¿è¡Œæ—¶èƒ½å¤Ÿæ£€æµ‹å‡ºè¿™ä¸ªé”™è¯¯ï¼Œç„¶åä¸€ä¸ªç‰¹æ®Šå‡½æ•°std::unexpectedå°†è¢«è‡ªåŠ¨åœ°è°ƒç”¨(This function is automatically called when a function throws an exception that is not listed in its dynamic-exception-specifier.)ã€‚std::unexpectedç¼ºçœçš„è¡Œä¸ºæ˜¯è°ƒç”¨å‡½æ•°std::terminateï¼Œè€Œstd::terminateç¼ºçœçš„è¡Œä¸ºæ˜¯è°ƒç”¨å‡½æ•°abortã€‚åº”é¿å…è°ƒç”¨std::unexpectedã€‚ é¿å…è¸ä¸Š unexpectedä¹‹è·¯çš„ç¬¬ä¸€ä¸ªæŠ€æœ¯æ˜¯: ä¸åº”è¯¥å°† templates å’Œ exceptionspecifications æ··åˆä½¿ç”¨ã€‚ é¿å…è¸ä¸Š unexpectedä¹‹è·¯çš„ç¬¬äºŒä¸ªæŠ€æœ¯æ˜¯: å¦‚æœA å‡½æ•°å†…è°ƒç”¨äº† B å‡½æ•°ï¼Œè€ŒB å‡½æ•°æ—  exceptionspecificationsï¼Œé‚£ä¹ˆ A å‡½æ•°æœ¬èº«ä¹Ÿä¸è¦è®¾å®šexception specificationsã€‚ é¿å…è¸ä¸Š unexpected ä¹‹è·¯çš„ç¬¬ä¸‰ä¸ªæŠ€æœ¯æ˜¯: å¤„ç†â€œç³»ç»Ÿâ€å¯èƒ½æŠ›å‡ºçš„exceptionsã€‚å…¶ä¸­æœ€å¸¸è§çš„å°±æ˜¯ bad_allocï¼Œé‚£æ˜¯åœ¨å†…å­˜åˆ†é…å¤±è´¥æ—¶ç”±operator newå’Œ operator new[]æŠ›å‡ºçš„(è§æ¡æ¬¾8)ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:3:6","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾15: äº†è§£å¼‚å¸¸å¤„ç†çš„ç³»ç»Ÿå¼€é”€ å¼‚å¸¸åŠŸèƒ½æ˜¯éœ€è¦ä¸€å®šå¼€é”€çš„,å³ä½¿æ˜¯å®Œå…¨æ²¡æœ‰è¿›è¡Œä½¿ç”¨,è™½ç„¶åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥è¿›è¡Œå¼‚å¸¸åŠŸèƒ½çš„å…³é—­,ä½†å‰ææ˜¯,å½“å‰çš„æ‰€æœ‰ä»£ç æ‰€æœ‰æ¨¡å—éƒ½æ²¡æœ‰è¿›è¡Œå¼‚å¸¸åŠŸèƒ½çš„ä½¿ç”¨,ä¸€æ—¦æœ‰ä¸€ä¸ªæ¨¡å—ä½¿ç”¨äº†å¼‚å¸¸,å°†å¯¼è‡´ç¨‹åºæ— æ³•è¿è¡Œ. æŠ›å‡ºå¼‚å¸¸è¿™ä¸ªå·¥ä½œæ˜¯æ¯”è¾ƒæ¶ˆè€—èµ„æºçš„,ç›¸å¯¹äºå¹³å¸¸çš„å‡½æ•°è¿”å›å€¼,å¤§çº¦æ˜¯3å€çš„èµ„æºæ¶ˆè€—,ä½†æ˜¯ä¸å¿…ææ…Œ,é™¤éå°†å¼‚å¸¸ä½œä¸ºäº†ä¸€ç§å¸¸è§„æ‰‹æ®µ,å¦åˆ™å¶å°”çš„ä½¿ç”¨åŸºæœ¬æ˜¯ä¸ä¼šå½±å“æ•´ä½“æ•ˆç‡çš„ å¼‚å¸¸åŠŸèƒ½æ•´ä½“ä¸Šä¼šä½¿ç¨‹åºå˜å¤§ 5%~10%,åŒæ—¶ä¹Ÿä¸€å®šæ¯”ä¾‹çš„å‡æ…¢ç¨‹åºçš„è¿è¡Œé€Ÿåº¦. è¿™å°±æ˜¯å¼‚å¸¸å¤„ç†çš„ç³»ç»Ÿå¼€é”€ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:3:7","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"å››ã€æ•ˆç‡ æœ¬ç« çš„å†…å®¹ä»ä¸¤ä¸ªè§’åº¦é˜è¿°æ•ˆç‡çš„é—®é¢˜ã€‚ ç¬¬ä¸€æ˜¯ä»è¯­è¨€ç‹¬ç«‹çš„è§’åº¦ï¼Œå…³æ³¨é‚£äº›ä½ èƒ½åœ¨ä»»ä½•è¯­è¨€é‡Œéƒ½èƒ½ä½¿ç”¨çš„ä¸œè¥¿ã€‚C++ä¸ºå®ƒä»¬æä¾›äº†ç‰¹åˆ«å¸å¼•äººçš„å®ç°é€”å¾„ï¼Œå› ä¸ºå®ƒå¯¹å°è£…çš„æ”¯æŒéå¸¸å¥½ï¼Œä»è€Œèƒ½å¤Ÿç”¨æ›´å¥½çš„ç®—æ³•ä¸æ•°æ®ç»“æ„æ¥æ›¿ä»£ä½æ•ˆçš„ç±»ä¼¼å®ç°ï¼ŒåŒæ—¶æ¥å£å¯ä»¥ä¿æŒä¸å˜ã€‚ ç¬¬äºŒæ˜¯å…³æ³¨ C++è¯­è¨€æœ¬èº«ã€‚é«˜æ€§èƒ½çš„ç®—æ³•ä¸æ•°æ®ç»“æ„è™½ç„¶éå¸¸å¥½ï¼Œä½†å¦‚æœå® é™…ç¼–ç¨‹ä¸­ä»£ç å®ç°å¾—å¾ˆç²—ç³™ï¼Œæ•ˆç‡ä¹Ÿä¼šé™ä½å¾—ç›¸å½“å¤šã€‚æ½œåœ¨å±å®³æ€§æœ€å¤§çš„é”™è¯¯æ˜¯ æ—¢å®¹æ˜“çŠ¯è€Œåˆä¸å®¹æ˜“å¯Ÿè§‰çš„é”™è¯¯ï¼Œæ¿’ç¹åœ°æ„é€ å’Œé‡Šæ”¾å¤§é‡çš„å¯¹è±¡å°±æ˜¯ä¸€ç§è¿™æ ·çš„ é”™è¯¯ã€‚è¿‡å¤šçš„å¯¹è±¡æ„é€ å’Œå¯¹è±¡é‡Šæ”¾å¯¹äºä½ çš„ç¨‹åºæ€§èƒ½æ¥è¯´å°±è±¡æ˜¯åœ¨å¤§å‡ºè¡€ï¼Œåœ¨æ¯ æ¬¡å»ºç«‹å’Œé‡Šæ”¾ä¸éœ€è¦çš„å¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œå®è´µçš„æ—¶é—´å°±è¿™ä¹ˆæµèµ°äº†ã€‚è¿™ä¸ªé—®é¢˜åœ¨ C++ç¨‹åºä¸­å¾ˆæ™®éï¼Œæˆ‘å°†ç”¨å››ä¸ªæ¡æ¬¾æ¥è¯´æ˜è¿™äº›å¯¹è±¡ä»å“ªé‡Œæ¥çš„ï¼Œåœ¨ä¸å½±å“ç¨‹åº ä»£ç æ­£ç¡®æ€§çš„åŸºç¡€ä¸Šåˆå¦‚ä½•æ¶ˆé™¤å®ƒä»¬ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:0","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾16: è°¨è®° 80-20 æ³•åˆ™ 80-20å‡†åˆ™è¯´çš„æ˜¯å¤§çº¦20%çš„ä»£ç ä½¿ç”¨äº†80%çš„ç¨‹åºèµ„æºï¼›å¤§çº¦20%çš„ä»£ç è€—ç”¨äº†å¤§çº¦80%çš„è¿è¡Œæ—¶é—´ï¼›å¤§çº¦20%çš„ä»£ç ä½¿ç”¨äº†80%çš„å†…å­˜ï¼›å¤§çº¦20%çš„ä»£ç æ‰§è¡Œ80%çš„ç£ç›˜è®¿é—®ï¼›80%çš„ç»´æŠ¤æŠ•å…¥äºå¤§çº¦20%çš„ä»£ç ä¸Šã€‚ åŸºæœ¬çš„è§‚ç‚¹: è½¯ä»¶æ•´ä½“çš„æ€§èƒ½å–å†³äºä»£ç ç»„æˆä¸­çš„ä¸€å°éƒ¨åˆ†ã€‚ä¸€ä¸ªç¨‹åºå¤§é‡çš„èµ„æºæ˜¯æ¶ˆè€—åœ¨å°‘éƒ¨åˆ†çš„ä»£ç ä¸Šé¢,æ‰€æœ‰çš„ç¨‹åºéƒ½ç¬¦åˆè¿™ä¸ªè§„åˆ™,æ‰€ä»¥,æˆ‘ä»¬è¦åšçš„å¹¶ä¸æ˜¯å¯¹æ¯ä¸€å¤„ä»£ç éƒ½è¿›è¡Œä¼˜åŒ–,è™½ç„¶è¿™ä¹ˆåšå›ºç„¶å¾ˆå¥½,ä½†æ˜¯æ¯ä¸ªäººçš„èƒ½åŠ›å’Œç²¾åŠ›æ˜¯ä¸€ä¸ªå›ºå®šå€¼,ä¸€å‘³çš„ä¼˜åŒ–80%éƒ¨åˆ†çš„ä»£ç ,æå‡çš„æ•ˆæœå¯èƒ½è¾¾ä¸åˆ°20%ä¸­çš„å‡ è¡Œä»£ç ,æˆ‘ä»¬è¦å–„äºåˆ©ç”¨å„ç§å·¥å…·,æ‰¾åˆ°çœŸæ­£éœ€è¦è¿›è¡Œä¼˜åŒ–çš„é€»è¾‘,ç„¶åå»è¿›è¡Œä¼˜åŒ–. ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:1","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾17: è€ƒè™‘ä½¿ç”¨ lazy evaluation(ç¼“å¼è¯„ä¼°) lazy evaluation(ç¼“å¼è¯„ä¼°)ã€‚ä¸€æ—¦ä½ é‡‡ç”¨ lazy evaluationï¼Œå°±æ˜¯ä»¥æŸç§æ–¹å¼æ’°å†™ä½ çš„ classesï¼Œä½¿å®ƒä»¬å»¶ç¼“è¿ç®—ï¼Œç›´åˆ°é‚£äº›è¿ç®—ç»“æœåˆ»ä¸å®¹ç¼“åœ°è¢«è¿«åˆ‡éœ€è¦ä¸ºæ­¢ã€‚å¦‚æœå…¶è¿ç®—ç»“æœä¸€ç›´ä¸è¢«éœ€è¦ï¼Œè¿ç®—ä¹Ÿå°±ä¸€ç›´ä¸æ‰§è¡Œã€‚ å¼•ç”¨è®¡æ•° è¿™ç§â€œæ•°æ®å…±äº«â€çš„è¡ŒåŠ¨ç»†èŠ‚(åŠç›¸åº”ä»£ç )åœ¨æ¡æ¬¾ 29æœ‰è¯¦ç»†å™è¿°ï¼Œå…¶è§‚å¿µä¾¿æ˜¯ lazy evaluationï¼šåœ¨ä½ çœŸæ­£éœ€è¦ä¹‹å‰ï¼Œä¸å¿…ç€æ€¥ä¸ºæŸç‰©åšä¸€ä¸ªå‰¯æœ¬ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œä»¥æ‹–å»¶æˆ˜æœ¯åº”ä»˜ä¹‹â€”â€”åªè¦èƒ½å¤Ÿï¼Œå°±ä½¿ç”¨å…¶ä»–å‰¯æœ¬ã€‚åœ¨æŸäº›åº”ç”¨é¢†åŸŸï¼Œä½ å¸¸æœ‰å¯èƒ½æ°¸è¿œä¸éœ€è¦æä¾›é‚£æ ·ä¸€ä¸ªå‰¯æœ¬ã€‚ åŒºåˆ«å¯¹å¾…è¯»å–å’Œå†™å…¥ string s = \"Homer's liad\"; ... cout \u003c\u003c s[3]; s[3] = 'x'; é¦–å…ˆè°ƒç”¨ operator[]ç”¨æ¥è¯»å– string çš„éƒ¨åˆ†å€¼ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡è°ƒç”¨è¯¥å‡½æ•°æ˜¯ä¸ºäº†å®Œæˆå†™æ“ä½œã€‚æˆ‘ä»¬åº”èƒ½å¤ŸåŒºåˆ«å¯¹å¾…è¯»è°ƒç”¨å’Œå†™è°ƒç”¨ï¼Œå› ä¸ºè¯»å–reference-counted string æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œè€Œå†™å…¥è¿™ä¸ª string åˆ™éœ€è¦åœ¨å†™å…¥å‰å¯¹è¯¥string å€¼åˆ¶ä½œä¸€ä¸ªæ–°æ‹·è´ã€‚ ä¸ºäº†èƒ½å¤Ÿè¿™æ ·åšï¼Œéœ€è¦åœ¨ operator[]é‡Œé‡‡å–ä¸åŒçš„æªæ–½(æ ¹æ®æ˜¯ä¸ºäº†å®Œæˆè¯»å–æ“ä½œè€Œè°ƒç”¨è¯¥å‡½æ•°è¿˜æ˜¯ä¸ºäº†å®Œæˆå†™å…¥æ“ä½œè€Œè°ƒç”¨è¯¥å‡½æ•°)ã€‚æˆ‘ä»¬å¦‚æœåˆ¤æ–­è°ƒç”¨ operator[]çš„ context æ˜¯è¯»å–æ“ä½œè¿˜æ˜¯å†™å…¥æ“ä½œå‘¢ï¼Ÿæ®‹é…·çš„äº‹å®æ˜¯æˆ‘ä»¬ä¸å¯èƒ½åˆ¤æ–­å‡ºæ¥ã€‚é€šè¿‡ä½¿ç”¨ lazy evaluation å’Œæ¡æ¬¾ M30 ä¸­è®²è¿°çš„proxy classï¼Œæˆ‘ä»¬å¯ä»¥æ¨è¿Ÿåšå‡ºæ˜¯è¯»æ“ä½œè¿˜æ˜¯å†™æ“ä½œçš„å†³å®šï¼Œç›´åˆ°æˆ‘ä»¬èƒ½åˆ¤æ–­å‡ºæ­£ç¡®çš„ç­”æ¡ˆã€‚ Lazy Fetching (æ‡’æƒ°æå–) å®ç° lazy fetching æ—¶ï¼Œä½ å¿…é¡»é¢å¯¹ä¸€ä¸ªé—®é¢˜ï¼šnull æŒ‡é’ˆå¯èƒ½ä¼šåœ¨ä»»ä½• member functions(åŒ…æ‹¬const member functionsï¼Œå¦‚ field1)å†…è¢«èµ‹å€¼ï¼Œä»¥æŒ‡å‘çœŸæ­£çš„æ•°æ®ã€‚ç„¶è€Œå½“ä½ ä¼å›¾åœ¨ constmember functions å†…ä¿®æ”¹ data membersï¼Œç¼–è¯‘å™¨ä¸ä¼šåŒæ„ã€‚æ‰€ä»¥ä½ å¿…é¡»ç”¨æŸç§æ–¹æ³•å‘Šè¯‰ç¼–è¯‘å™¨è¯´ï¼šâ€œæ”¾è½»æ¾ï¼Œæˆ‘çŸ¥é“æˆ‘æ­£åœ¨å¹²ä»€ä¹ˆâ€ã€‚è¯´è¿™å¥è¯çš„æœ€å¥½æ–¹æ³•å°±æ˜¯å°†æŒ‡é’ˆå­—æ®µå£°æ˜ä¸º mutableï¼Œæ„æ€æ˜¯è¿™æ ·çš„å­—æ®µå¯ä»¥åœ¨ä»»ä½•member function å†…è¢«ä¿®æ”¹ï¼Œç”šè‡³æ˜¯åœ¨ const member functions å†…(è§æ¡æ¬¾ E21)ã€‚ Lazy Expression Evaluation(æ‡’æƒ°è¡¨è¾¾å¼è®¡ç®—) lazy evaluation åœ¨è®¸å¤šé¢†åŸŸä¸­éƒ½å¯èƒ½æœ‰ç”¨é€”ï¼šå¯é¿å…éå¿…è¦çš„å¯¹è±¡å¤åˆ¶ï¼Œå¯åŒºåˆ« operator[]çš„è¯»å–å’Œå†™åŠ¨ä½œï¼Œå¯é¿å…éå¿…è¦çš„æ•°æ®åº“è¯»å–åŠ¨ä½œï¼Œå¯é¿å…éå¿…è¦çš„æ•°å€¼è®¡ç®—åŠ¨ä½œã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:2","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾18: åˆ†æœŸæ‘Šè¿˜é¢„æœŸçš„è®¡ç®—æˆæœ¬ ç°åœ¨æˆ‘é¼“åŠ±ä½ æ”¹å–„è½¯ä»¶æ€§èƒ½çš„æ–¹æ³•æ˜¯ï¼šä»¤ä½ çš„ä»£ç è¶…å‰è¿›åº¦åœ°åšâ€œè¦æ±‚ä»¥å¤–â€çš„æ›´å¤šå·¥ä½œã€‚æ­¤æ¡æ¬¾èƒŒåçš„å“²å­¦å¯ç§°ä¸ºè¶…æ€¥è¯„ä¼°(over-eager evaluation): åœ¨è¢«è¦æ±‚ä¹‹å‰å°±å…ˆæŠŠäº‹æƒ…åšä¸‹å»ã€‚ Over-eager evaluation èƒŒåçš„è§‚å¿µæ˜¯ï¼Œå¦‚æœä½ é¢„æœŸç¨‹åºå¸¸å¸¸ä¼šç”¨åˆ°æŸä¸ªè®¡ç®—ï¼Œä½ å¯ä»¥é™ä½æ¯æ¬¡è®¡ç®—çš„å¹³å‡æˆæœ¬ï¼ŒåŠæ³•å°±æ˜¯è®¾è®¡ä¸€ä»½æ•°æ®ç»“æ„ä»¥ä¾¿èƒ½å¤Ÿææœ‰æ•ˆç‡åœ°å¤„ç†éœ€æ±‚ã€‚ Caching æ˜¯â€œåˆ†æœŸæ‘Šè¿˜é¢„æœŸè®¡ç®—ä¹‹æˆæœ¬â€çš„ä¸€ç§åšæ³•,å³caching(ç¼“å­˜)é‚£äº›å·²ç»è¢«è®¡ç®—å‡ºæ¥è€Œä»¥åè¿˜æœ‰å¯èƒ½éœ€è¦çš„å€¼ã€‚ Prefetching(é¢„å…ˆå–å‡º)æ˜¯å¦ä¸€ç§åšæ³•ã€‚Prefetchéœ€è¦ç©ºé—´æ”¾ç½®è¢« prefetch çš„ä¸œè¥¿ï¼Œä½†æ˜¯å®ƒå‡å°‘äº†è®¿é—®å®ƒä»¬æ‰€éœ€ çš„æ—¶é—´ã€‚ ä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½æ˜¯é€šè¿‡ä»¥ç©ºé—´æ¢æ—¶é—´çš„æ–¹å¼æ¥æé«˜ä»£ç çš„è¿è¡Œæ•ˆç‡ã€‚ å¯é€šè¿‡over-eager evaluation å¦‚ cachingå’Œprefetching ç­‰åšæ³•åˆ†æœŸæ‘Šè¿˜é¢„æœŸè¿ç®—æˆæœ¬â€”â€”å’Œæˆ‘åœ¨æ¡æ¬¾ 17 æ‰€æçš„ lazy evaluation å¹¶ä¸çŸ›ç›¾ã€‚å½“ä½ å¿…é¡»æ”¯æŒæŸäº›è¿ç®—è€Œå…¶ç»“æœå¹¶ä¸æ€»æ˜¯éœ€è¦çš„æ—¶å€™ï¼Œlazy evaluation å¯ä»¥æ”¹å–„ç¨‹åºæ•ˆç‡ã€‚å½“ä½ å¿…é¡»æ”¯æŒæŸäº›è¿ç®—è€Œå…¶ç»“æœå‡ ä¹æ€»æ˜¯è¢«éœ€è¦ï¼Œæˆ–å…¶ç»“æœå¸¸å¸¸è¢«å¤šæ¬¡éœ€è¦çš„æ—¶å€™ï¼Œover-eager evaluation å¯ä»¥æ”¹å–„ç¨‹åºæ•ˆç‡ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:3","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾19: ç†è§£ä¸´æ—¶å¯¹è±¡çš„æ¥æº size_t countChar(const std::string\u0026 str, char ch) { // å»ºç«‹ä¸€ä¸ªstringç±»å‹çš„ä¸´æ—¶å¯¹è±¡ï¼Œé€šè¿‡ä»¥bufferåšä¸ºå‚æ•°è°ƒç”¨stringçš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–è¿™ä¸ªä¸´æ—¶å¯¹è±¡, // countCharçš„å‚æ•°strè¢«ç»‘å®šåœ¨è¿™ä¸ªä¸´æ—¶çš„stringå¯¹è±¡ä¸Šï¼Œå½“countCharè¿”å›æ—¶ï¼Œä¸´æ—¶å¯¹è±¡è‡ªåŠ¨é‡Šæ”¾ // å°†countChar(const std::string\u0026 str, char ch)ä¿®æ”¹ä¸ºcountChar(std::string\u0026 str, char ch)åˆ™ä¼šerror return 1; } #define MAX_STRING_LEN 64 int test_item_19() { char buffer[MAX_STRING_LEN]; char c; std::cin \u003e\u003e c \u003e\u003e std::setw(MAX_STRING_LEN) \u003e\u003e buffer; std::cout\u003c\u003c\"There are \"\u003c\u003ccountChar(buffer, c)\u003c\u003c\" occurrences of the character \"\u003c\u003cc\u003c\u003c\" in \"\u003c\u003cbuffer\u003c\u003cstd::endl; return 0; } C++çœŸæ­£çš„æ‰€è°“çš„ä¸´æ—¶å¯¹è±¡æ˜¯ä¸å¯è§çš„â€”â€”ä¸ä¼šåœ¨ä½ çš„æºä»£ç ä¸­å‡ºç°ã€‚åªè¦ä½ äº§ç”Ÿä¸€ä¸ª non-heap object(éå †å¯¹è±¡) è€Œæ²¡æœ‰ä¸ºå®ƒå‘½åï¼Œä¾¿è¯ç”Ÿäº†ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ã€‚æ­¤ç­‰åŒ¿åå¯¹è±¡é€šå¸¸å‘ç”Ÿäºä¸¤ç§æƒ…å†µï¼šä¸€æ˜¯å½“éšå¼ç±»å‹è½¬æ¢(implicit type conversions)è¢«æ–½è¡Œèµ·æ¥ä»¥æ±‚å‡½æ•°è°ƒç”¨èƒ½å¤ŸæˆåŠŸï¼›äºŒæ˜¯å½“å‡½æ•°è¿”å›å¯¹è±¡çš„æ—¶å€™ã€‚ ä»…å½“é€šè¿‡ä¼ å€¼(by value)æ–¹å¼ä¼ é€’å¯¹è±¡æˆ–ä¼ é€’å¸¸é‡å¼•ç”¨(reference-to-const)å‚æ•°æ—¶ï¼Œæ‰ä¼šå‘ç”Ÿè¿™äº›ç±»å‹è½¬æ¢ã€‚å½“ä¼ é€’ä¸€ä¸ªéå¸¸é‡å¼•ç”¨(reference-to-non-const)å‚æ•°å¯¹è±¡ï¼Œå°±ä¸ä¼šå‘ç”Ÿã€‚ C++è¯­è¨€ç¦æ­¢ä¸º**éå¸¸é‡å¼•ç”¨(reference-to-non-const)**äº§ç”Ÿä¸´æ—¶å¯¹è±¡ã€‚ åœ¨è¿™äº›ä¼˜åŒ–ç­–ç•¥ä¸­ï¼Œæœ€å¸¸è§ä¹Ÿæœ€æœ‰ç”¨çš„å°±æ˜¯æ‰€è°“çš„â€œè¿”å›å€¼ä¼˜åŒ–(return value optimization)â€ã€‚ ä¸´æ—¶å¯¹è±¡å¯èƒ½å¾ˆè€—æˆæœ¬ï¼Œæ‰€ä»¥ä½ åº”è¯¥å°½å¯èƒ½æ¶ˆé™¤å®ƒä»¬ã€‚ç„¶è€Œæ›´é‡è¦çš„æ˜¯ï¼Œå¦‚ä½•è®­ç»ƒå‡ºé”åˆ©çš„çœ¼åŠ›ï¼Œçœ‹å‡ºå¯èƒ½äº§ç”Ÿä¸´æ—¶å¯¹è±¡çš„åœ°æ–¹ã€‚ä»»ä½•æ—¶å€™åªè¦ä½ çœ‹åˆ°ä¸€ä¸ª reference-to-const å‚æ•°ï¼Œå°±æå¯èƒ½ä¼šæœ‰ä¸€ä¸ªä¸´æ—¶å¯¹è±¡è¢«äº§ç”Ÿå‡ºæ¥ç»‘å®šè‡³è¯¥å‚æ•°ä¸Šã€‚ä»»ä½•æ—¶å€™åªè¦ä½ çœ‹åˆ°å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šäº§ç”Ÿä¸´æ—¶å¯¹è±¡(å¹¶äºç¨åé”€æ¯)ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:4","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾20: ååŠ©å®Œæˆè¿”å›å€¼ä¼˜åŒ– (RVO) class Rational20 { public: Rational20(int numerator = 0, int denominator = 1) {} int numerator() const { return 1; } int denominator() const { return 2; } }; const Rational20 operator*(const Rational20\u0026 lhs, const Rational20\u0026 rhs) { // ä»¥æŸç§æ–¹æ³•è¿”å›å¯¹è±¡ï¼Œèƒ½è®©ç¼–è¯‘å™¨æ¶ˆé™¤ä¸´æ—¶å¯¹è±¡çš„å¼€é”€ï¼šè¿™ç§æŠ€å·§æ˜¯è¿”å›constructor argumentè€Œä¸æ˜¯ç›´æ¥è¿”å›å¯¹è±¡ return Rational20(lhs.numerator() * rhs.numerator(), lhs.denominator() * rhs.denominator()); } int test_item_20() { Rational20 a = 10; Rational20 b(1, 2); Rational20 c = a * b; return 0; } æˆ‘ä»¬å¯ä»¥ç”¨æŸç§ç‰¹æ®Šå†™æ³•æ¥æ’°å†™å‡½æ•°ï¼Œä½¿å®ƒåœ¨è¿”å›å¯¹è±¡æ—¶ï¼Œèƒ½å¤Ÿè®©ç¼–è¯‘å™¨æ¶ˆé™¤ä¸´æ—¶å¯¹è±¡çš„æˆæœ¬ã€‚æˆ‘ä»¬çš„ä¼ä¿©æ˜¯ï¼šè¿”å›æ‰€è°“çš„ constructor argumentsä»¥å–ä»£å¯¹è±¡ã€‚ æ­¤ç‰¹æ®Šçš„ä¼˜åŒ–è¡Œä¸ºâ€”â€”åˆ©ç”¨å‡½æ•°çš„ return ç‚¹æ¶ˆé™¤ä¸€ä¸ªå±€éƒ¨ä¸´æ—¶å¯¹è±¡ï¼ˆå¹¶å¯èƒ½ç”¨å‡½æ•°è°ƒç”¨ç«¯çš„æŸå¯¹è±¡å–ä»£ï¼‰â€”â€”ä¸ä½†å¹¿ä¸ºäººçŸ¥è€Œä¸”å¾ˆæ™®éåœ°è¢«å®ç°å‡ºæ¥ã€‚å®ƒç”šè‡³æœ‰ä¸ªä¸“å±åç§°ï¼šreturn value optimizationã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:5","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾21: é€šè¿‡é‡è½½é¿å…éšå¼ç±»å‹è½¬æ¢ class UPInt21 { // unlimited precision integers class public: UPInt21() {} UPInt21(int value) {} }; const UPInt21 operator+(const UPInt21\u0026 lhs, const UPInt21\u0026 rhs) // add UPInt21+UPInt21 { return UPInt21(1); } const UPInt21 operator+(const UPInt21\u0026 lhs, int rhs) // add UPInt21+int { return UPInt21(1); } const UPInt21 operator+(int lhs, const UPInt21\u0026 rhs) // add int+UPInt21 { return UPInt21(1); } int test_item_21() { UPInt21 upi1, upi2; UPInt21 upi3 = upi1 + upi2; // æ­£ç¡®ï¼Œæ²¡æœ‰ç”±upi1æˆ–upi2ç”Ÿæˆä¸´æ—¶å¯¹è±¡ upi3 = upi1 + 10; // æ­£ç¡®,æ²¡æœ‰ç”±upi1æˆ–10ç”Ÿæˆä¸´æ—¶å¯¹è±¡ upi3 = 10 + upi2; // æ­£ç¡®ï¼Œæ²¡æœ‰ç”±10æˆ–upi2ç”Ÿæˆä¸´æ—¶å¯¹è±¡ // æ³¨æ„ï¼šæ³¨é‡Šæ‰ä¸Šé¢çš„operator+(UPInt21\u0026, int)å’Œoperator+(int, UPInt21\u0026)ä¹Ÿæ­£ç¡®ï¼Œä½†æ˜¯ä¼šé€šè¿‡ä¸´æ—¶å¯¹è±¡æŠŠ10è½¬æ¢ä¸ºUPInt21 return 0; } åœ¨C++ä¸­æœ‰ä¸€æ¡è§„åˆ™æ˜¯æ¯ä¸€ä¸ªé‡è½½çš„operatorå¿…é¡»å¸¦æœ‰ä¸€ä¸ªç”¨æˆ·å®šä¹‰ç±»å‹(user-defined type)çš„å‚æ•°ã€‚ åˆ©ç”¨é‡è½½é¿å…ä¸´æ—¶å¯¹è±¡çš„æ–¹æ³•ä¸åªæ˜¯ç”¨åœ¨operatorå‡½æ•°ä¸Šã€‚ æ²¡æœ‰å¿…è¦å®ç°å¤§é‡çš„é‡è½½å‡½æ•°ï¼Œé™¤éä½ æœ‰ç†ç”±ç¡®ä¿¡ç¨‹åºä½¿ç”¨é‡è½½å‡½æ•°ä»¥åå…¶æ•´ä½“æ•ˆç‡ä¼šæœ‰æ˜¾è‘—çš„æé«˜ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:6","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾22: è€ƒè™‘ç”¨è¿ç®—ç¬¦çš„èµ‹å€¼å½¢å¼(op=)å–ä»£å…¶å•ç‹¬å½¢å¼(op) class Rational22 { public: Rational22(int numerator = 0, int denominator = 1) {} Rational22\u0026 operator+=(const Rational22\u0026 rhs) { return *this; } Rational22\u0026 operator-=(const Rational22\u0026 rhs) { return *this; } }; // operator+æ ¹æ®operator+=å®ç° const Rational22 operator+(const Rational22\u0026 lhs, const Rational22\u0026 rhs) { return Rational22(lhs) += rhs; } // operator-æ ¹æ®operator-=å®ç° const Rational22 operator-(const Rational22\u0026 lhs, const Rational22\u0026 rhs) { return Rational22(lhs) -= rhs; } å°±C++æ¥è¯´ï¼Œoperator+ã€operator=å’Œoperator+=ä¹‹é—´æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œå› æ­¤å¦‚æœä½ æƒ³è®©ä¸‰ä¸ªoperatoråŒæ—¶å­˜åœ¨å¹¶å…·æœ‰ä½ æ‰€æœŸæœ›çš„å…³ç³»ï¼Œå°±å¿…é¡»è‡ªå·±å®ç°å®ƒä»¬ã€‚åŒç†ï¼Œoperator-, *, /, ç­‰ç­‰ä¹Ÿä¸€æ ·ã€‚ è¦ç¡®ä¿æ“ä½œç¬¦çš„å¤åˆå½¢å¼ï¼ˆä¾‹å¦‚ï¼Œoperator+=ï¼‰å’Œå…¶ç‹¬èº«å½¢å¼ï¼ˆä¾‹å¦‚ï¼Œoperator+ï¼‰ä¹‹é—´çš„è‡ªç„¶å…³ç³»èƒ½å¤Ÿå­˜åœ¨ï¼Œä¸€ä¸ªå¥½æ–¹æ³•å°±æ˜¯ä»¥å‰è€…ä¸ºåŸºç¡€å®ç°åè€…ï¼ˆè§æ¡æ¬¾ 6ï¼‰ã€‚ 3 ä¸ªä¸æ•ˆç‡æœ‰å…³çš„æƒ…å†µå€¼å¾—æ³¨æ„: ç¬¬ä¸€ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œå¤åˆæ“ä½œç¬¦æ¯”å…¶å¯¹åº”çš„ç‹¬èº«ç‰ˆæœ¬æ•ˆç‡é«˜ï¼Œå› ä¸ºç‹¬èº«ç‰ˆæœ¬é€šå¸¸å¿…é¡»è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè€Œæˆ‘ä»¬å¿…é¡»å› æ­¤è´Ÿæ‹…ä¸€ä¸ªä¸´æ—¶å¯¹è±¡çš„æ„é€ å’Œææ„æˆæœ¬ï¼ˆè§æ¡æ¬¾ 19å’Œ 20åŠæ¡æ¬¾ E23ï¼‰ã€‚è‡³äºå¤åˆç‰ˆæœ¬åˆ™æ˜¯ç›´æ¥å°†ç»“æœå†™å…¥å…¶å·¦ç«¯è‡ªå˜é‡ï¼Œæ‰€ä»¥ä¸éœ€è¦äº§ç”Ÿä¸€ä¸ªä¸´æ—¶å¯¹è±¡æ¥æ”¾ç½®è¿”å›å€¼ã€‚ ç¬¬äºŒï¼Œå¦‚æœåŒæ—¶æä¾›æŸä¸ªæ“ä½œç¬¦çš„å¤åˆå½¢å¼å’Œç‹¬èº«å½¢å¼ï¼Œä¾¿å…è®¸ä½ çš„å®¢æˆ·åœ¨æ•ˆç‡ä¸ä¾¿åˆ©æ€§ä¹‹é—´åšå–èˆï¼ˆè™½ç„¶é‚£æ˜¯æå…¶å›°éš¾çš„æŠ‰æ‹©ï¼‰ã€‚ ç¬¬ä¸‰ã€è‡ªå¤ä»¥æ¥åŒ¿åå¯¹è±¡æ€»æ˜¯æ¯”å‘½åå¯¹è±¡æ›´å®¹æ˜“è¢«æ¶ˆé™¤ï¼Œæ‰€ä»¥å½“ä½ é¢ä¸´å‘½åå¯¹è±¡æˆ–ä¸´æ—¶å¯¹è±¡çš„æŠ‰æ‹©æ—¶ï¼Œæœ€å¥½é€‰æ‹©ä¸´æ—¶å¯¹è±¡ã€‚å®ƒåº”è¯¥ç»ä¸ä¼šæ¯”å…¶å‘½åå…„å¼Ÿè€—ç”¨æ›´å¤šæˆæœ¬ï¼Œåå€’æ˜¯ææœ‰å¯èƒ½é™ä½æˆæœ¬ï¼ˆå°¤å…¶åœ¨æ­é…æ—§å¼ç¼–è¯‘å™¨æ—¶ï¼‰ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:7","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾23: è€ƒè™‘ä½¿ç”¨å…¶ä»–ç¨‹åºåº“ ä¸åŒçš„ç¨‹åºåº“åœ¨æ•ˆç‡ã€å¯æ‰©å±•æ€§ã€ç§»æ¤æ€§ã€ç±»å‹å®‰å…¨å’Œå…¶å®ƒä¸€äº›é¢†åŸŸä¸Šè•´å«ç€ä¸åŒçš„è®¾è®¡ç†å¿µï¼Œé€šè¿‡å˜æ¢ä½¿ç”¨ç»™äºˆæ€§èƒ½æ›´å¤šè€ƒè™‘çš„ç¨‹åºåº“ï¼Œä½ æœ‰æ—¶å¯ä»¥å¤§å¹…åº¦åœ°æä¾›è½¯ä»¶çš„æ•ˆç‡ã€‚ é‡ç‚¹æ˜¯ï¼Œä¸åŒçš„ç¨‹åºåº“å³ä½¿æä¾›ç›¸ä¼¼çš„æœºèƒ½ï¼Œä¹Ÿå¾€å¾€è¡¨ç°å‡ºä¸åŒçš„æ€§èƒ½å–èˆç­–ç•¥ï¼Œæ‰€ä»¥ä¸€æ—¦ä½ æ‰¾å‡ºç¨‹åºçš„ç“¶é¢ˆï¼ˆé€šè¿‡åˆ†æå™¨ï¼Œè§æ¡æ¬¾16ï¼‰ï¼Œä½ åº”è¯¥æ€è€ƒæ˜¯å¦æœ‰å¯èƒ½å› ä¸ºæ”¹ç”¨å¦ä¸€ä¸ªç¨‹åºåº“è€Œç§»é™¤äº†é‚£äº›ç“¶é¢ˆã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:8","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾24: ç†è§£è™šæ‹Ÿå‡½æ•°ã€å¤šç»§æ‰¿ã€è™šåŸºç±»å’ŒRTTIæ‰€éœ€çš„ä»£ç  å½“è°ƒç”¨ä¸€ä¸ªè™šæ‹Ÿå‡½æ•°æ—¶ï¼Œè¢«æ‰§è¡Œçš„ä»£ç å¿…é¡»ä¸è°ƒç”¨å‡½æ•°çš„å¯¹è±¡çš„åŠ¨æ€ç±»å‹ç›¸ä¸€è‡´ï¼›æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆæˆ–å¼•ç”¨çš„ç±»å‹æ˜¯ä¸é‡è¦çš„ã€‚å¤§å¤šæ•°ç¼–è¯‘å™¨æ˜¯ä½¿ç”¨virtual tableå’Œvirtual table pointersï¼Œé€šå¸¸è¢«åˆ†åˆ«åœ°ç§°ä¸ºvtblå’Œvptrã€‚ ä¸€ä¸ªvtblé€šå¸¸æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„ã€‚(ä¸€äº›ç¼–è¯‘å™¨ä½¿ç”¨é“¾è¡¨æ¥ä»£æ›¿æ•°ç»„ï¼Œä½†æ˜¯åŸºæœ¬æ–¹æ³•æ˜¯ä¸€æ ·çš„)åœ¨ç¨‹åºä¸­çš„æ¯ä¸ªç±»åªè¦å£°æ˜äº†è™šå‡½æ•°æˆ–ç»§æ‰¿äº†è™šå‡½æ•°ï¼Œå®ƒå°±æœ‰è‡ªå·±çš„vtblï¼Œå¹¶ä¸”ç±»ä¸­vtblçš„é¡¹ç›®æ˜¯æŒ‡å‘è™šå‡½æ•°å®ç°ä½“çš„æŒ‡é’ˆã€‚ä¾‹å¦‚ï¼Œå¦‚ä¸‹è¿™ä¸ªç±»å®šä¹‰: class C1 { public: C1(); virtual ~C1(); virtual void f1(); virtual int f2(char c) const; virtual void f3(const string\u0026 s); void f4() const; ... }; C1 çš„ virtual table æ•°ç»„çœ‹èµ·æ¥å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š vtbl é€šå¸¸æ˜¯ä¸€ä¸ªç”±â€œå‡½æ•°æŒ‡é’ˆâ€æ¶æ„è€Œæˆçš„æ•°ç»„ã€‚æŸäº›ç¼–è¯‘å™¨ä¼šä»¥é“¾è¡¨ï¼ˆlinked listï¼‰å–ä»£æ•°ç»„ï¼Œä½†å…¶åŸºæœ¬ç­–ç•¥ç›¸åŒã€‚ç¨‹åºä¸­çš„æ¯ä¸€ä¸ªclass å‡¡å£°æ˜ï¼ˆæˆ–ç»§æ‰¿ï¼‰è™šå‡½æ•°è€…ï¼Œéƒ½æœ‰è‡ªå·±çš„ä¸€ä¸ª vtblï¼Œè€Œå…¶ä¸­çš„æ¡ç›®ï¼ˆentriesï¼‰å°±æ˜¯è¯¥ class çš„å„ä¸ªè™šå‡½æ•°å®ç°ä½“çš„æŒ‡é’ˆã€‚ è¿™ä»½è®¨è®ºå¸¦å‡ºè™šå‡½æ•°çš„ç¬¬ä¸€ä¸ªæˆæœ¬ï¼šä½ å¿…é¡»ä¸ºæ¯ä¸ªæ‹¥æœ‰è™šå‡½æ•°çš„classè€—è´¹ä¸€ä¸ªvtbl ç©ºé—´ï¼Œå…¶å¤§å°è§†è™šå‡½æ•°çš„ä¸ªæ•°ï¼ˆåŒ…æ‹¬ç»§æ‰¿è€Œæ¥çš„ï¼‰è€Œå®šã€‚ç±»çš„vtblçš„å¤§å°ä¸ç±»ä¸­å£°æ˜çš„è™šå‡½æ•°çš„æ•°é‡æˆæ­£æ¯”(åŒ…æ‹¬ä»åŸºç±»ç»§æ‰¿çš„è™šå‡½æ•°)ã€‚æ¯ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªvirtual tableï¼Œæ‰€ä»¥virtual tableæ‰€éœ€çš„ç©ºé—´ä¸ä¼šå¤ªå¤§ï¼Œä½†æ˜¯å¦‚æœä½ æœ‰å¤§é‡çš„ç±»æˆ–è€…åœ¨æ¯ä¸ªç±»ä¸­æœ‰å¤§é‡çš„è™šå‡½æ•°ï¼Œä½ ä¼šå‘ç°vtblä¼šå ç”¨å¤§é‡çš„åœ°å€ç©ºé—´ã€‚ Virtual tables åªæ˜¯è™šå‡½æ•°å®ç°æœºæ„çš„ä¸€åŠè€Œå·²ã€‚å¦‚æœåªæœ‰å®ƒï¼Œä¸èƒ½æˆæ°”å€™ã€‚ä¸€æ—¦æœ‰æŸç§æ–¹æ³•å¯ä»¥æŒ‡ç¤ºå‡ºæ¯ä¸ªå¯¹è±¡ç›¸åº”äºå“ªä¸€ä¸ª vtblï¼Œvtbl æ‰çœŸçš„æœ‰ç”¨ã€‚è€Œè¿™æ­£æ˜¯virtual table pointerï¼ˆvptrï¼‰çš„ä»»åŠ¡ã€‚ å…³äºè™šå‡½æ•°è¡¨çš„ä»‹ç»å‚è€ƒï¼šhttps://blog.csdn.net/fengbingchun/article/details/79592347 å‡¡å£°æ˜æœ‰è™šå‡½æ•°çš„ classï¼Œå…¶å¯¹è±¡éƒ½å«æœ‰ä¸€ä¸ªéšè—çš„ data memberï¼Œç”¨æ¥æŒ‡å‘è¯¥class çš„ vtblã€‚è¿™ä¸ªéšè—çš„ data memberâ€”â€”æ‰€è°“çš„vptrâ€”â€”è¢«ç¼–è¯‘å™¨åŠ å…¥å¯¹è±¡å†…æŸä¸ªå”¯ç¼–è¯‘å™¨æ‰çŸ¥é“çš„ä½ç½®ã€‚ æ­¤åˆ»ï¼Œåªéœ€æ³¨æ„åˆ°è™šå‡½æ•°çš„ç¬¬äºŒä¸ªæˆæœ¬ï¼šä½ å¿…é¡»åœ¨æ¯ä¸€ä¸ªæ‹¥æœ‰è™šå‡½æ•°çš„å¯¹è±¡å†…ä»˜å‡ºâ€œä¸€ä¸ªé¢å¤–æŒ‡é’ˆâ€çš„ä»£ä»·ã€‚ ç¼–è¯‘å™¨å¿…é¡»äº§ç”Ÿä»£ç ï¼Œå®Œæˆä»¥ä¸‹åŠ¨ä½œï¼š 1.æ ¹æ®å¯¹è±¡çš„ vptr æ‰¾å‡ºå…¶ vtblã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„åŠ¨ä½œï¼Œå› ä¸ºç¼–è¯‘å™¨çŸ¥é“åˆ°å¯¹è±¡çš„å“ªé‡Œå»æ‰¾å‡º vptrï¼ˆæ¯•ç«Ÿé‚£ä¸ªä½ç½®æ­£æ˜¯ç¼–è¯‘å™¨å†³å®šçš„ï¼‰ã€‚æˆæœ¬åªæœ‰ä¸€ä¸ªåç§»è°ƒæ•´ï¼ˆoffset adjustmentï¼Œä»¥ä¾¿è·å¾— vptrï¼‰å’Œä¸€ä¸ªæŒ‡é’ˆé—´æ¥åŠ¨ä½œï¼ˆä»¥ä¾¿è·å¾— vtblï¼‰ã€‚ 2.æ‰¾å‡ºè¢«è°ƒç”¨å‡½æ•°ï¼ˆæœ¬ä¾‹ä¸º f1ï¼‰åœ¨ vtbl å†…çš„å¯¹åº”æŒ‡é’ˆã€‚è¿™ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¸ºæ¯ä¸ªè™šå‡½æ•°æŒ‡å®šäº†ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„è¡¨æ ¼ç´¢å¼•ã€‚æœ¬æ­¥éª¤çš„æˆæœ¬åªæ˜¯ä¸€ä¸ªå·®ç§»ï¼ˆoffsetï¼‰ä»¥æ±‚è¿›å…¥ vtbl æ•°ç»„ã€‚ 3.è°ƒç”¨æ­¥éª¤ 2æ‰€å¾—æŒ‡é’ˆæ‰€æŒ‡å‘çš„å‡½æ•°ã€‚ ä¸€äº›åŸå› å¯¼è‡´ç°åœ¨çš„ç¼–è¯‘å™¨ä¸€èˆ¬æ€»æ˜¯å¿½ç•¥è™šå‡½æ•°çš„inlineæŒ‡ä»¤ã€‚è™šå‡½æ•°çœŸæ­£çš„è¿è¡Œæ—¶æœŸæˆæœ¬å‘ç”Ÿåœ¨å’Œ inlining äº’åŠ¨çš„æ—¶å€™ã€‚å¯¹æ‰€æœ‰å®ç”¨ç›®çš„è€Œè¨€ï¼Œè™šå‡½æ•°ä¸åº”è¯¥ inlinedã€‚å› ä¸ºâ€œinlineâ€æ„å‘³â€œåœ¨ç¼–è¯‘æœŸï¼Œå°†è°ƒç”¨ç«¯çš„è°ƒç”¨åŠ¨ä½œè¢«è°ƒç”¨å‡½æ•°çš„å‡½æ•°æœ¬ä½“å–ä»£â€ï¼Œè€Œâ€œvirtualâ€åˆ™æ„å‘³ç€â€œç­‰å¾…ï¼Œç›´åˆ°è¿è¡Œæ—¶æœŸæ‰çŸ¥é“å“ªä¸ªå‡½æ•°è¢«è°ƒç”¨â€ã€‚(è¿™æ˜¯å› ä¸ºâ€å†…è”â€æ˜¯æŒ‡â€åœ¨ç¼–è¯‘æœŸé—´ç”¨è¢«è°ƒç”¨çš„å‡½æ•°ä½“æœ¬èº«æ¥ä»£æ›¿å‡½æ•°è°ƒç”¨çš„æŒ‡ä»¤â€ï¼Œä½†æ˜¯è™šå‡½æ•°çš„â€è™šâ€æ˜¯æŒ‡â€ç›´åˆ°è¿è¡Œæ—¶æ‰èƒ½çŸ¥é“è¦è°ƒç”¨çš„æ˜¯å“ªä¸€ä¸ªå‡½æ•°â€ã€‚) å½“ç¼–è¯‘å™¨é¢å¯¹æŸä¸ªè°ƒç”¨åŠ¨ä½œï¼Œå´æ— æ³•çŸ¥é“å“ªä¸ªå‡½æ•°è¯¥è¢«è°ƒç”¨æ—¶ï¼Œä½ å°±å¯ä»¥äº†è§£ä¸ºä»€ä¹ˆå®ƒä»¬æ²¡æœ‰èƒ½åŠ›å°†è¯¥å‡½æ•°è°ƒç”¨åŠ ä»¥ inliningäº†ã€‚è¿™ä¾¿æ˜¯è™šå‡½æ•°çš„ç¬¬ä¸‰ä¸ªæˆæœ¬ï¼šä½ äº‹å®ä¸Šç­‰äºæ”¾å¼ƒäº† inliningã€‚ è¿è¡Œæ—¶æœŸç±»å‹è¾¨è¯†ï¼ˆruntime typeidentificationï¼ŒRTTIï¼‰çš„æˆæœ¬ã€‚RTTI è®©æˆ‘ä»¬å¾—ä»¥åœ¨è¿è¡Œæ—¶æœŸè·å¾— objects å’Œ classes çš„ç›¸å…³ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸€å®šå¾—æœ‰æŸäº›åœ°æ–¹ç”¨æ¥å­˜æ”¾é‚£äº›ä¿¡æ¯æ‰è¡Œâ€”â€”æ˜¯çš„ï¼Œå®ƒä»¬è¢«å­˜æ”¾åœ¨ç±»å‹ä¸º type_info çš„å¯¹è±¡å†…ã€‚ä½ å¯ä»¥åˆ©ç”¨ typeid æ“ä½œç¬¦å–å¾—æŸä¸ªclass ç›¸åº”çš„ type_info å¯¹è±¡ã€‚ C++è§„èŒƒä¹¦ä¸Šè¯´ï¼Œåªæœ‰å½“æŸç§ç±»å‹æ‹¥æœ‰è‡³å°‘ä¸€ä¸ªè™šå‡½æ•°ï¼Œæ‰ä¿è¯æˆ‘ä»¬èƒ½å¤Ÿæ£€éªŒè¯¥ç±»å‹å¯¹è±¡çš„åŠ¨æ€ç±»å‹ã€‚è¿™ä½¿å¾— RTTI ç›¸å…³ä¿¡æ¯å¬èµ·æ¥æœ‰ç‚¹åƒä¸€ä¸ª vtblï¼šé¢å¯¹ä¸€ä¸ª classï¼Œæˆ‘ä»¬åªéœ€ä¸€ä»½ç›¸å…³ä¿¡æ¯ï¼Œè€Œæˆ‘ä»¬éœ€è¦æŸç§æ–¹æ³•ï¼Œè®©ä»»ä½•ä¸€ä¸ªå†…å«è™šå‡½æ•°çš„å¯¹è±¡éƒ½æœ‰èƒ½åŠ›å–å¾—å…¶ä¸“å±ä¿¡æ¯ã€‚RTTI å’Œvtbl ä¹‹é—´çš„è¿™ç§å¹³è¡Œå…³ç³»å¹¶éå¶å‘ï¼ŒRTTI çš„è®¾è®¡ç†å¿µæ˜¯ï¼šæ ¹æ® class çš„ vtblæ¥å®ç°ã€‚ å…³äºtypeidçš„ä½¿ç”¨å‚è€ƒï¼šhttps://blog.csdn.net/fengbingchun/article/details/51866559 RTTIè¢«è®¾è®¡ä¸ºåœ¨ç±»çš„vtblåŸºç¡€ä¸Šå®ç°ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:4:9","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"äº”ã€æŠ€æœ¯ (Techniquesï¼ŒIdiomsï¼ŒPatterns) ","date":"2023-09-06","objectID":"/posts/more_effective_c/:5:0","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾25: å°†æ„é€ å‡½æ•°å’Œéæˆå‘˜å‡½æ•°è™šæ‹ŸåŒ– ç”±äºå®ƒäº§ç”Ÿæ–°å¯¹è±¡ï¼Œæ‰€ä»¥è¡Œä¸ºä»¿è‹¥ constructorï¼Œä½†å®ƒèƒ½å¤Ÿäº§ç”Ÿä¸åŒç±»å‹çš„å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ç§°å®ƒä¸ºä¸€ä¸ª virtual constructorã€‚æ‰€è°“ virtualconstructor æ˜¯æŸç§å‡½æ•°ï¼Œè§†å…¶è·å¾—çš„è¾“å…¥ï¼Œå¯äº§ç”Ÿä¸åŒç±»å‹çš„å¯¹è±¡ã€‚Virtual constructors åœ¨è®¸å¤šæƒ…å†µä¸‹æœ‰ç”¨ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯ä»ç£ç›˜ï¼ˆæˆ–ç½‘ç»œæˆ–ç£å¸¦ç­‰ï¼‰è¯»å–å¯¹è±¡ä¿¡æ¯ã€‚ æœ‰ä¸€ç§ç‰¹åˆ«çš„ virtual constructorâ€”â€”æ‰€è°“ virtual copyconstructorâ€”â€”ä¹Ÿè¢«å¹¿æ³›åœ°è¿ç”¨ã€‚Virtual copy constructor ä¼šè¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å…¶è°ƒç”¨è€…ï¼ˆæŸå¯¹è±¡ï¼‰çš„ä¸€ä¸ªæ–°å‰¯æœ¬ã€‚åŸºäºè¿™ç§è¡Œä¸ºï¼Œvirtual copy constructors é€šå¸¸ä»¥ copySelf æˆ–cloneSelf å‘½åï¼Œæˆ–è€…åƒä¸‹é¢ä¸€æ ·å‘½åä¸º cloneã€‚ å½“ derived class é‡æ–°å®šä¹‰å…¶base class çš„ä¸€ä¸ªè™šå‡½æ•°æ—¶ï¼Œä¸å†éœ€è¦ä¸€å®šå¾—å£°æ˜ä¸åŸæœ¬ç›¸åŒçš„è¿”å›ç±»å‹ã€‚å¦‚æœå‡½æ•°çš„è¿”å›ç±»å‹æ˜¯ä¸ªæŒ‡é’ˆï¼ˆæˆ–referenceï¼‰ï¼ŒæŒ‡å‘ä¸€ä¸ªbase classï¼Œé‚£ä¹ˆ derived class çš„å‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼ˆæˆ–referenceï¼‰ï¼ŒæŒ‡å‘è¯¥ base class çš„ä¸€ä¸ª derived classã€‚ æ—¢ç„¶ä¸€ä¸ªå‡½æ•°èƒ½å¤Ÿæ„é€ å‡ºä¸åŒç±»å‹çš„æ–°å¯¹è±¡æ˜¯å¯ä»¥ç†è§£çš„ï¼Œé‚£ä¹ˆåŒæ ·ä¹Ÿå­˜åœ¨è¿™æ ·çš„éæˆå‘˜å‡½æ•°ï¼Œå¯ä»¥æ ¹æ®å‚æ•°çš„ä¸åŒåŠ¨æ€ç±»å‹è€Œå…¶è¡Œä¸ºç‰¹æ€§ä¹Ÿä¸åŒã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:5:1","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾26: é™åˆ¶æŸä¸ªç±»æ‰€èƒ½äº§ç”Ÿçš„å¯¹è±¡æ•°é‡ æ¯å½“å³å°†äº§ç”Ÿä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬ç¡®çŸ¥ä¸€ä»¶äº‹æƒ…ï¼šä¼šæœ‰ä¸€ä¸ª constructorè¢«è°ƒç”¨ã€‚â€œé˜»æ­¢æŸä¸ª class äº§å‡ºå¯¹è±¡â€çš„æœ€ç®€å•æ–¹æ³•å°±æ˜¯å°†å…¶constructors å£°æ˜ä¸º privateã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:5:2","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾27: è¦æ±‚ï¼ˆæˆ–ç¦æ­¢ï¼‰å¯¹è±¡äº§ç”Ÿäº heapä¹‹ä¸­ æ‰€è°“ abstract base classæ˜¯ä¸€ä¸ªä¸èƒ½å¤Ÿè¢«å®ä¾‹åŒ–çš„ base classã€‚ä¹Ÿå°±æ˜¯è¯´å®ƒè‡³å°‘æœ‰ä¸€ä¸ªçº¯è™šå‡½æ•°ã€‚æ‰€è°“ mixinï¼ˆâ€œmix inâ€ï¼‰classåˆ™æä¾›ä¸€ç»„å®šä¹‰å®Œå¥½çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿä¸å…¶derived classæ‰€å¯èƒ½æä¾›çš„å…¶ä»–ä»»ä½•èƒ½åŠ›ï¼ˆæ¡æ¬¾ E7ï¼‰å…¼å®¹ã€‚å¦‚æ­¤çš„ classeså‡ ä¹æ€»æ˜¯abstractã€‚æˆ‘ä»¬äºæ˜¯å¯ä»¥å½¢æˆä¸€ä¸ªæ‰€è°“çš„ abstract mixin base classï¼Œç”¨æ¥ä¸º derivedclassesæä¾›â€œåˆ¤æ–­æŸæŒ‡é’ˆæ˜¯å¦ä»¥ operator new åˆ†é…å‡ºæ¥â€çš„èƒ½åŠ›ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:5:3","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾28: çµå·§(smart)æŒ‡é’ˆ å½“ä½ ä»¥ smart pointers å–ä»£ C++çš„å†…å»ºæŒ‡é’ˆï¼ˆäº¦å³æ‰€è°“çš„ dumbpointersï¼‰ï¼Œä½ å°†è·å¾—ä»¥ä¸‹å„ç§æŒ‡é’ˆè¡Œä¸ºçš„æ§åˆ¶æƒï¼š æ„é€ å’Œææ„ï¼ˆConstruction and Destructionï¼‰ã€‚ä½ å¯ä»¥å†³å®šsmart pointer è¢«äº§ç”Ÿä»¥åŠè¢«é”€æ¯æ—¶å‘ç”Ÿä»€ä¹ˆäº‹ã€‚é€šå¸¸æˆ‘ä»¬ä¼šç»™smart pointers ä¸€ä¸ªé»˜è®¤å€¼ 0ï¼Œä»¥é¿å…â€œæŒ‡é’ˆæœªè·åˆå§‹åŒ–â€çš„å¤´ç—›é—®é¢˜ã€‚æŸäº› smart pointers æœ‰è´£ä»»åˆ é™¤å®ƒä»¬æ‰€æŒ‡çš„å¯¹è±¡â€”â€”å½“æŒ‡å‘è¯¥å¯¹è±¡çš„æœ€åä¸€ä¸ª smart pointer è¢«é”€æ¯æ—¶ã€‚è¿™æ˜¯æ¶ˆé™¤èµ„æºæ³„æ¼é—®é¢˜çš„ä¸€å¤§è¿›æ­¥ã€‚ å¤åˆ¶å’Œèµ‹å€¼ï¼ˆCopying and Assignmentï¼‰ã€‚å½“ä¸€ä¸ª smartpointer è¢«å¤åˆ¶æˆ–æ¶‰åŠèµ‹å€¼åŠ¨ä½œæ—¶ï¼Œä½ å¯ä»¥æ§åˆ¶å‘ç”Ÿä»€ä¹ˆäº‹ã€‚æŸäº›smart pointer ä¼šå¸Œæœ›åœ¨æ­¤æ—¶åˆ»è‡ªåŠ¨ä¸ºå…¶æ‰€æŒ‡ä¹‹ç‰©è¿›è¡Œå¤åˆ¶æˆ–èµ‹å€¼åŠ¨ä½œï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œæ‰€è°“çš„æ·±å¤åˆ¶ï¼ˆdeep copyï¼‰ã€‚å¦ä¸€äº› smartpointeråˆ™å¯èƒ½åªå¸Œæœ›æŒ‡é’ˆæœ¬èº«è¢«å¤åˆ¶æˆ–èµ‹å€¼å°±å¥½ã€‚è¿˜æœ‰ä¸€äº›åˆ™æ ¹æœ¬ä¸å…è®¸å¤åˆ¶å’Œèµ‹å€¼ã€‚ä¸è®ºä½ å¸Œæœ›ä»€ä¹ˆæ ·çš„è¡Œä¸ºï¼Œsmart pointers éƒ½å¯ä»¥è®©ä½ å¦‚æ„¿ã€‚ è§£å¼•ï¼ˆDereferencingï¼‰ã€‚å½“ client è§£å¼•ï¼ˆå–ç”¨ï¼‰smart pointeræ‰€æŒ‡ä¹‹ç‰©æ—¶ï¼Œä½ æœ‰æƒå†³å®šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ã€‚ä¾‹å¦‚ä½ å¯ä»¥åˆ©ç”¨ smartpointers ååŠ©å®ç°å‡ºæ¡æ¬¾ 17æ‰€è¯´çš„ lazy fetching ç­–ç•¥ã€‚ Smart pointerçš„æ„é€ è¡Œä¸ºé€šå¸¸æ˜ç¡®æ˜“è§£ï¼šç¡®å®šä¸€ä¸ªç›®æ ‡ç‰©ï¼ˆé€šå¸¸æ˜¯åˆ©ç”¨smart pointerçš„ constructorè‡ªå˜é‡ï¼‰ï¼Œç„¶åè®© smart pointerå†…éƒ¨çš„ dumb pointeræŒ‡å‘å®ƒã€‚å¦‚æœå°šæœªå†³å®šç›®æ ‡ç‰©ï¼Œå°±å°†å†…éƒ¨æŒ‡é’ˆè®¾ä¸º 0ï¼Œæˆ–æ˜¯å‘å‡ºä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼ˆå¯èƒ½æ˜¯æŠ›å‡º exceptionï¼‰ã€‚ é‡ç‚¹å¾ˆç®€å•ï¼šä¸è¦æä¾›å¯¹ dumb pointersçš„éšå¼è½¬æ¢æ“ä½œç¬¦ï¼Œé™¤éä¸å¾—å·²ã€‚ å¤§å¤šæ•°çµå·§æŒ‡é’ˆæ¨¡æ¿å¦‚ä¸‹: // å¤§å¤šæ•°çµå·§æŒ‡é’ˆæ¨¡æ¿ template\u003cclass T\u003e class SmartPtr { public: SmartPtr(T* realPtr = 0); // å»ºç«‹ä¸€ä¸ªçµå·§æŒ‡é’ˆæŒ‡å‘dumb pointer(å†…å»ºæŒ‡é’ˆ)æ‰€æŒ‡çš„å¯¹è±¡ï¼Œæœªåˆå§‹åŒ–çš„æŒ‡é’ˆï¼Œç¼ºçœå€¼ä¸º0(null) SmartPtr(const SmartPtr\u0026 rhs); // æ‹·è´ä¸€ä¸ªçµå·§æŒ‡é’ˆ ~SmartPtr(); // é‡Šæ”¾çµå·§æŒ‡é’ˆ // make an assignment to a smart ptr SmartPtr\u0026 operator=(const SmartPtr\u0026 rhs); T* operator-\u003e() const; // dereferenceä¸€ä¸ªçµå·§æŒ‡é’ˆä»¥è®¿é—®æ‰€æŒ‡å¯¹è±¡çš„æˆå‘˜ T\u0026 operator*() const; // dereferenceçµå·§æŒ‡é’ˆ private: T* pointee; // çµå·§æŒ‡é’ˆæ‰€æŒ‡çš„å¯¹è±¡ }; çµå·§æŒ‡é’ˆæ˜¯ä¸€ç§å¤–è§‚å’Œè¡Œä¸ºéƒ½è¢«è®¾è®¡æˆä¸å†…å»ºæŒ‡é’ˆç›¸ç±»ä¼¼çš„å¯¹è±¡ï¼Œä¸è¿‡å®ƒèƒ½æä¾›æ›´å¤šçš„åŠŸèƒ½ã€‚å®ƒä»¬æœ‰è®¸å¤šåº”ç”¨çš„é¢†åŸŸï¼ŒåŒ…æ‹¬èµ„æºç®¡ç†å’Œé‡å¤ä»£ç ä»»åŠ¡çš„è‡ªåŠ¨åŒ–ã€‚ åœ¨C++11ä¸­auto_ptrå·²ç»è¢«åºŸå¼ƒï¼Œç”¨unique_ptræ›¿ä»£ã€‚ std::unique_ptrçš„ä½¿ç”¨å‚è€ƒï¼šhttps://blog.csdn.net/fengbingchun/article/details/52203664 ","date":"2023-09-06","objectID":"/posts/more_effective_c/:5:4","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾29: Reference countingï¼ˆå¼•ç”¨è®¡æ•°ï¼‰ class String { public: String(const char* initValue = \"\"); String(const String\u0026 rhs); String\u0026 operator=(const String\u0026 rhs); const char\u0026 operator[](int index) const; // for const String char\u0026 operator[](int index); // for non-const String ~String(); private: // StringValueçš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªç©ºé—´å°†ä¸€ä¸ªç‰¹åˆ«çš„å€¼å’Œå…±äº«æ­¤å€¼çš„å¯¹è±¡çš„æ•°ç›®è”ç³»èµ·æ¥ struct StringValue { // holds a reference count and a string value int refCount; char* data; bool shareable; // æ ‡å¿—ï¼Œä»¥æŒ‡å‡ºå®ƒæ˜¯å¦ä¸ºå¯å…±äº«çš„ StringValue(const char* initValue); ~StringValue(); }; StringValue* value; // value of this String }; String::String(const char* initValue) : value(new StringValue(initValue)) {} String::String(const String\u0026 rhs) { if (rhs.value-\u003eshareable) { value = rhs.value; ++value-\u003erefCount; } else { value = new StringValue(rhs.value-\u003edata); } } String\u0026 String::operator=(const String\u0026 rhs) { if (value == rhs.value) { // do nothing if the values are already the same return *this; } if (value-\u003eshareable \u0026\u0026 --value-\u003erefCount == 0) { // destroy *this's value if no one else is using it delete value; } if (rhs.value-\u003eshareable) { value = rhs.value; // have *this share rhs's value ++value-\u003erefCount; } else { value = new StringValue(rhs.value-\u003edata); } return *this; } const char\u0026 String::operator[](int index) const { return value-\u003edata[index]; } char\u0026 String::operator[](int index) { // if we're sharing a value with other String objects, break off a separate copy of the value fro ourselves if (value-\u003erefCount \u003e 1) { --value-\u003erefCount; // decrement current value's refCount, becuase we won't be using that value any more value = new StringValue(value-\u003edata); // make a copy of the value for ourselves } value-\u003eshareable = false; // return a reference to a character inside our unshared StringValue object return value-\u003edata[index]; } String::~String() { if (--value-\u003erefCount == 0) { delete value; } } String::StringValue::StringValue(const char* initValue) : refCount(1), shareable(true) { data = new char[strlen(initValue) + 1]; strcpy(data, initValue); } String::StringValue::~StringValue() { delete[] data; } // åŸºç±»ï¼Œä»»ä½•éœ€è¦å¼•ç”¨è®¡æ•°çš„ç±»éƒ½å¿…é¡»ä»å®ƒç»§æ‰¿ class RCObject { public: void addReference() { ++refCount; } void removeReference() { if (--refCount == 0) delete this; } // å¿…é¡»ç¡®ä¿RCObjectåªèƒ½è¢«æ„å»ºåœ¨å †ä¸­ void markUnshareable() { shareable = false; } bool isShareable() const { return shareable; } bool isShared() const { return refCount \u003e 1; } protected: RCObject() : refCount(0), shareable(true) {} RCObject(const RCObject\u0026 rhs) : refCount(0), shareable(true) {} RCObject\u0026 operator=(const RCObject\u0026 rhs) { return *this; } virtual ~RCObject() = 0; private: int refCount; bool shareable; }; RCObject::~RCObject() {} // virtual dtors must always be implemented, even if they are pure virtual and do nothing // template class for smart pointers-to-T objects. T must support the RCObject interface, typically by inheriting from RCObject template\u003cclass T\u003e class RCPtr { public: RCPtr(T* realPtr = 0) : pointee(realPtr) { init(); } RCPtr(const RCPtr\u0026 rhs) : pointee(rhs.pointee) { init(); } ~RCPtr() { if (pointee) pointee-\u003eremoveReference(); } RCPtr\u0026 operator=(const RCPtr\u0026 rhs) { if (pointee != rhs.pointee) { // skip assignments where the value doesn't change if (pointee) pointee-\u003eremoveReference(); // remove reference to current value pointee = rhs.pointee; // point to new value init(); // if possible, share it else make own copy } return *this; } T* operator-\u003e() const { return pointee; } T\u0026 operator*() const { return *pointee; } private: T* pointee; // dumb pointer this object is emulating void init() // common initialization { if (pointee == 0) // if the dumb pointer is null, so is the smart one return; if (pointee-\u003eisShareable() == false) // if the value isn't shareable copy it pointee = new T(*pointee); pointee-\u003eaddReference(); // note that there is now a new reference to the value } }; // å°†StringValueä¿®æ”¹ä¸ºæ˜¯ä»RCObjectç»§æ‰¿ // å°†å¼•ç”¨è®¡æ•°åŠŸèƒ½ç§»å…¥ä¸€ä¸ªæ–°ç±»(RCObject)ï¼Œå¢åŠ äº†çµå·§æŒ‡é’ˆ(RCPtr)æ¥è‡ªåŠ¨å¤„ç†å¼•ç”¨è®¡æ•° class String2 { public: String2(const char* value = \"\") : value(new StringValu","date":"2023-09-06","objectID":"/posts/more_effective_c/:5:5","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾30: Proxy classesï¼ˆæ›¿èº«ç±»ã€ä»£ç†ç±»ï¼‰ template\u003cclass T\u003e class Array2D { // ä½¿ç”¨ä»£ç†å®ç°äºŒç»´æ•°ç»„ public: Array2D(int i, int j) : i(i), j(j) { data.reset(new T[i*j]); } class Array1D { // Array1Dæ˜¯ä¸€ä¸ªä»£ç†ç±»ï¼Œå®ƒçš„å®ä¾‹æ‰®æ¼”çš„æ˜¯ä¸€ä¸ªåœ¨æ¦‚å¿µä¸Šä¸å­˜åœ¨çš„ä¸€ç»´æ•°ç»„ public: Array1D(T* data) : data(data) {} T\u0026 operator[](int index) { return data[index]; } const T\u0026 operator[](int index) const { return data[index]; } private: T* data; }; Array1D operator[](int index) { return Array1D(data.get()+j*index); } const Array1D operator[](int index) const { return Array1D(data.get()+j*index); } private: std::unique_ptr\u003cT[]\u003e data; int i, j; }; // å¯ä»¥é€šè¿‡ä»£ç†ç±»å¸®åŠ©åŒºåˆ†é€šè¿‡operator[]è¿›è¡Œçš„æ˜¯è¯»æ“ä½œè¿˜æ˜¯å†™æ“ä½œ class String30 { public: String30(const char* value = \"\") : value(new StringValue(value)) {} class CharProxy { // proxies for string chars public: CharProxy(String30\u0026 str, int index) : theString(str), charIndex(index) {} CharProxy\u0026 operator=(const CharProxy\u0026 rhs) { // if the string is haring a value with other String objects, // break off a separate copy of the value for this string only if (theString.value-\u003eisShared()) theString.value = new StringValue(theString.value-\u003edata); // now make the assignment: assign the value of the char // represented by rhs to the char represented by *this theString.value-\u003edata[charIndex] = rhs.theString.value-\u003edata[rhs.charIndex]; return *this; } CharProxy\u0026 operator=(char c) { if (theString.value-\u003eisShared()) theString.value = new StringValue(theString.value-\u003edata); theString.value-\u003edata[charIndex] = c; return *this; } operator char() const { return theString.value-\u003edata[charIndex]; } private: String30\u0026 theString; int charIndex; }; const CharProxy operator[](int index) const // for const String30 { return CharProxy(const_cast\u003cString30\u0026\u003e(*this), index); } CharProxy operator[](int index) // for non-const String30 { return CharProxy(*this, index); } //friend class CharProxy; private: // StringValueçš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªç©ºé—´å°†ä¸€ä¸ªç‰¹åˆ«çš„å€¼å’Œå…±äº«æ­¤å€¼çš„å¯¹è±¡çš„æ•°ç›®è”ç³»èµ·æ¥ struct StringValue : public RCObject { // holds a reference count and a string value char* data; StringValue(const char* initValue) { init(initValue); } StringValue(const StringValue\u0026 rhs) { init(rhs.data); } void init(const char* initValue) { data = new char[strlen(initValue) + 1]; strcpy(data, initValue); } ~StringValue() { delete [] data; } }; RCPtr\u003cStringValue\u003e value; // value of this String30 }; int test_item_30() { Array2D\u003cfloat\u003e data(10, 20); fprintf(stdout, \"%f\\n\", data[3][6]); String30 s1(\"Effective C++\"), s2(\"More Effective C++\"); // reference-counted strings using proxies fprintf(stdout, \"%c\\n\", s1[5]); // still legal, still works s2[5] = 'x'; // also legal, also works s1[3] = s2[8]; // of course it's legal, of course it works //char* p = \u0026s1[1]; // error, é€šå¸¸,å–proxyå¯¹è±¡åœ°å€çš„æ“ä½œä¸å–å®é™…å¯¹è±¡åœ°å€çš„æ“ä½œå¾—åˆ°çš„æŒ‡é’ˆï¼Œå…¶ç±»å‹æ˜¯ä¸åŒçš„,é‡è½½CharProxyç±»çš„å–åœ°å€è¿ç®—å¯æ¶ˆé™¤è¿™ä¸ªä¸åŒ return 0; } å‡¡â€œç”¨æ¥ä»£è¡¨ï¼ˆè±¡å¾ï¼‰å…¶ä»–å¯¹è±¡â€çš„å¯¹è±¡ï¼Œå¸¸è¢«ç§°ä¸º proxy objectsï¼ˆæ›¿èº«å¯¹è±¡ï¼‰ï¼Œè€Œç”¨ä»¥è¡¨ç° proxy objectsè€…ï¼Œæˆ‘ä»¬ç§°ä¸º proxy classesã€‚ è™½ç„¶æˆ–è®¸ä¸å¯èƒ½çŸ¥é“operator[] æ˜¯åœ¨å·¦å€¼æˆ–å³å€¼æƒ…å¢ƒä¸‹è¢«è°ƒç”¨ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥åŒºåˆ†è¯»å’Œå†™â€”â€”åªè¦å°†æˆ‘ä»¬æ‰€è¦çš„å¤„ç†åŠ¨ä½œå»¶ç¼“ï¼Œç›´è‡³çŸ¥é“operator[] çš„è¿”å›ç»“æœå°†å¦‚ä½•è¢«ä½¿ç”¨ä¸ºæ­¢ã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“çš„ï¼Œå°±æ˜¯å¦‚ä½•å»¶ç¼“æˆ‘ä»¬çš„å†³å®šï¼ˆå†³å®šå¯¹è±¡ç©¶ç«Ÿæ˜¯è¢«è¯»æˆ–è¢«å†™ï¼‰ï¼Œç›´åˆ° operator[] è¿”å›ã€‚è¿™æ˜¯æ¡æ¬¾ 17 çš„ç¼“å¼è¯„ä¼°ï¼ˆlazyevaluationï¼‰ä¾‹å­ä¹‹ä¸€ã€‚ Proxy class è®©æˆ‘ä»¬å¾—ä»¥ä¹°åˆ°æˆ‘ä»¬æ‰€è¦çš„æ—¶é—´ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ä¿®æ”¹operator[]ï¼Œä»¤å®ƒè¿”å›å­—ç¬¦ä¸²ä¸­å­—ç¬¦çš„ proxyï¼Œè€Œä¸è¿”å›å­—ç¬¦æœ¬èº«ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥ç­‰å¾…ï¼Œçœ‹çœ‹è¿™ä¸ª proxyå¦‚ä½•è¢«è¿ç”¨ã€‚å¦‚æœå®ƒè¢«è¯»ï¼Œæˆ‘ä»¬å¯ä»¥ï¼ˆæœ‰ç‚¹è¿‡æ—¶åœ°ï¼‰å°† operator[] çš„è°ƒç”¨åŠ¨ä½œè§†ä¸ºä¸€ä¸ªè¯»å–åŠ¨ä½œã€‚å¦‚æœå®ƒè¢«å†™ï¼Œæˆ‘ä»¬å¿…é¡»å°† operator[] çš„è°ƒç”¨è§†ä¸ºä¸€ä¸ªå†™åŠ¨ä½œã€‚ ç¨åä½ ä¼šçœ‹åˆ°ä»£ç ã€‚é¦–å…ˆï¼Œé‡è¦çš„æ˜¯äº†è§£æˆ‘ä»¬å³å°†ä½¿ç”¨çš„ proxiesã€‚å¯¹äºä¸€ä¸ªproxyï¼Œä½ åªæœ‰ 3ä»¶äº‹æƒ…å¯åšï¼š äº§ç”Ÿå®ƒï¼Œæœ¬ä¾‹ä¹Ÿå°±æ˜¯æŒ‡å®šå®ƒä»£è¡¨å“ªä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„å“ªä¸€ä¸ªå­—ç¬¦ã€‚ ä»¥å®ƒä½œä¸ºèµ‹å€¼åŠ¨ä½œï¼ˆassignmentï¼‰çš„ç›®æ ‡ï¼ˆæ¥å—ç«¯ï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹ä½ æ˜¯å¯¹å®ƒæ‰€ä»£è¡¨çš„å­—ç¬¦ä¸²å†…çš„å­—ç¬¦åšèµ‹å€¼åŠ¨ä½œã€‚å¦‚æœè¿™ä¹ˆä½¿ç”¨ï¼Œproxy ä»£è¡¨çš„å°†æ˜¯â€œè°ƒç”¨operator[] å‡½æ•°â€çš„é‚£ä¸ªå­—ç¬¦ä¸²çš„å·¦å€¼è¿ç”¨ã€‚ ä»¥å…¶ä»–æ–¹å¼ä½¿ç”¨ä¹‹ã€‚å¦‚æœè¿™ä¹ˆä½¿ç”¨ï¼Œproxy è¡¨ç°çš„æ˜¯â€œè°ƒç”¨operator[] å‡½æ•°â€çš„é‚£ä¸ªå­—ç¬¦ä¸²çš„å³å€¼è¿ç”¨ã€‚ Proxy classes å…è®¸æˆ‘ä»¬å®ŒæˆæŸäº›ååˆ†å›°éš¾æˆ–å‡ ä¹ä¸å¯èƒ½å®Œæˆçš„è¡Œä¸ºã€‚å¤šç»´æ•°ç»„æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œå·¦å€¼/å³å€¼çš„åŒºåˆ†æ˜¯å…¶ä¸­ä¹‹äºŒï¼Œå‹æŠ‘éšå¼è½¬æ¢ï¼ˆè§æ¡æ¬¾ 5ï¼‰æ˜¯å…¶ä¸­ä¹‹ä¸‰ã€‚ æœ€åï¼Œå½“ class çš„èº«ä»½ä»â€œä¸çœŸå®å¯¹è±¡åˆä½œâ€ç§»è½¬åˆ°â€œä¸æ›¿èº«å¯¹è±¡ï¼ˆproxiesï¼‰åˆä½œâ€ï¼Œå¾€å¾€ä¼šé€ æˆ classè¯­ä¹‰çš„æ”¹å˜ï¼Œå› ä¸º proxyobjects æ‰€å±•ç°çš„è¡Œä¸ºå¸¸å¸¸å’ŒçœŸæ­£å¯¹è±¡çš„è¡Œä¸ºæœ‰äº›éšå¾®å·®å¼‚ã€‚ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:5:6","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾31: è®©å‡½æ•°æ ¹æ®ä¸€ä¸ªä»¥ä¸Šçš„å¯¹è±¡ç±»å‹æ¥å†³å®šå¦‚ä½•è™šåŒ– å‡è®¾ä½ å¿…é¡»ä»¥ C++å®Œæˆä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯ä½ å¿…é¡»è‡ªè¡Œæƒ³åŠæ³•å®Œæˆä¸Šè¿°éœ€æ±‚ï¼ˆå¸¸è¢«ç§°ä¸º double-dispatchingï¼‰ã€‚æ­¤åç§°æ¥è‡ªé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ç¤¾åŒºï¼Œåœ¨é‚£ä¸ªé¢†åŸŸé‡Œï¼Œäººä»¬æŠŠä¸€ä¸ªâ€œè™šå‡½æ•°è°ƒç”¨åŠ¨ä½œâ€ç§°ä¸ºä¸€ä¸ªâ€œmessage dispatchâ€ï¼ˆæ¶ˆæ¯åˆ†æ´¾ï¼‰ã€‚å› æ­¤æŸä¸ªå‡½æ•°è°ƒç”¨å¦‚æœæ ¹æ®ä¸¤ä¸ªå‚æ•°è€Œè™šåŒ–ï¼Œè‡ªç„¶è€Œç„¶åœ°å°±è¢«ç§°ä¸ºâ€œdouble dispatchâ€ã€‚æ›´å¹¿æ³›çš„æƒ…å†µï¼ˆå‡½æ•°æ ¹æ®å¤šä¸ªå‚æ•°è€Œè™šåŒ–ï¼‰åˆ™è¢«ç§°ä¸º multiple dispatchã€‚ è™šå‡½æ•°+ RTTIï¼ˆè¿è¡Œæ—¶æœŸç±»å‹è¾¨è¯†ï¼‰ åªä½¿ç”¨è™šå‡½æ•° è‡ªè¡Œä»¿çœŸè™šå‡½æ•°è¡¨æ ¼ï¼ˆVirtual Function Tablesï¼‰ è®¿é—®è€…æ¨¡å¼ ","date":"2023-09-06","objectID":"/posts/more_effective_c/:5:7","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"å…­ã€æ‚é¡¹è®¨è®º ","date":"2023-09-06","objectID":"/posts/more_effective_c/:6:0","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾32: ","date":"2023-09-06","objectID":"/posts/more_effective_c/:6:1","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾33: ","date":"2023-09-06","objectID":"/posts/more_effective_c/:6:2","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾34: ","date":"2023-09-06","objectID":"/posts/more_effective_c/:6:3","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"æ¡æ¬¾35: Ref: [1]. More Effective C++ [2]. ã€ŠMore Effective C++ã€‹è¯»ä¹¦ç¬”è®° [3]. https://blog.csdn.net/fengbingchun/article/details/102990753 ","date":"2023-09-06","objectID":"/posts/more_effective_c/:6:4","tags":["More Effective C++"],"title":"More Effective C++ é˜…è¯»ç¬”è®°","uri":"/posts/more_effective_c/"},{"categories":["C++"],"content":"å‡½æ•°æŒ‡é’ˆæŒ‰å€¼ä¼ é€’ Cå’ŒC++éƒ½ä¸å…è®¸ä½ çœŸçš„æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œä½ å¿…é¡»ä¼ æŒ‡é’ˆç»™å‡½æ•°ã€‚ æ¯”å¦‚ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°qsortçš„å£°æ˜: void qsort(void *base, size_t nmemb, size_t size, int (*cmpfcn)(const void*, const void*)); ä¸€æ—¦ä½ å¿½ç•¥äº†æ‰€æœ‰çš„æ˜Ÿå·ï¼Œå°±å¯ä»¥æ¸…æ¥šåœ°çœ‹å‡ºä½œä¸ºcmpfcnä¼ é€’çš„å®å‚ï¼Œä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆï¼Œæ˜¯ä»è°ƒç”¨ç«¯æ‹·è´ï¼ˆä¹Ÿå°±æ˜¯ï¼Œå€¼ä¼ é€’ï¼‰ç»™qsortã€‚è¿™æ˜¯Cå’ŒC++æ ‡å‡†åº“éƒ½éµå¾ªçš„ä¸€èˆ¬å‡†åˆ™:å‡½æ•°æŒ‡é’ˆæ˜¯å€¼ä¼ é€’ã€‚ STLä¸­çš„ä¹ æƒ¯æ˜¯å½“ä¼ ç»™å‡½æ•°å’Œä»å‡½æ•°è¿”å›æ—¶å‡½æ•°å¯¹è±¡ä¹Ÿæ˜¯å€¼ä¼ é€’çš„ï¼ˆä¹Ÿå°±æ˜¯æ‹·è´ï¼‰ã€‚ æœ€å¥½çš„è¯æ®æ˜¯æ ‡å‡†çš„for_eachå£°æ˜ï¼Œè¿™ä¸ªç®—æ³•é€šè¿‡å€¼ä¼ é€’è·å–å’Œè¿”å›å‡½æ•°å¯¹è±¡: template\u003cclass InputIterator, class Function\u003e Function // æ³¨æ„å€¼è¿”å›ï¼Œ æ³¨æ„å€¼ä¼ é€’ for_each(InputIterator first, InputIterator last, Function f); å®é™…ä¸Šï¼Œå€¼ä¼ é€’çš„æƒ…å†µå¹¶ä¸æ˜¯å®Œå…¨æ‰“ä¸ç ´çš„ï¼Œå› ä¸ºfor_eachçš„è°ƒç”¨è€…åœ¨è°ƒç”¨ç‚¹å¯ä»¥æ˜¾å¼æŒ‡å®šå‚æ•°ç±»å‹ã€‚æ¯”å¦‚ï¼Œä¸‹é¢çš„ä»£ç å¯ä»¥ä½¿for_eaché€šè¿‡å¼•ç”¨ä¼ é€’å’Œè¿”å›å®ƒçš„ä»¿å‡½æ•°: class DoSomething : public unary_function\u003cint, void\u003e { public: void operator()(int x){...} ... }; // æ–¹ä¾¿çš„typedef typedef deque\u003cint\u003e::iterator DequeIntIter; deque\u003cint\u003e di; ... // å»ºç«‹ä¸€ä¸ªå‡½æ•°å¯¹è±¡ DoSomething d; ... // è°ƒç”¨for_eachï¼Œå‚æ•°ç±»å‹æ˜¯DequeIntIterå’ŒDoSomething\u0026ï¼› // è¿™è¿«ä½¿dæŒ‰å¼•ç”¨ä¼ é€’å’Œè¿”å› for_each\u003cDequeIntIter, DoSomething \u0026\u003e(di.begin(), di.end(), d); ","date":"2023-09-06","objectID":"/posts/effective_stl_38/:1:0","tags":["Effective STL"],"title":"Effective STL [38] | æŠŠä»¿å‡½æ•°ç±»è®¾è®¡ä¸ºç”¨äºå€¼ä¼ é€’","uri":"/posts/effective_stl_38/"},{"categories":["C++"],"content":"ä¿è¯æ‹·è´ä¼ é€’è¡Œä¸ºæ­£å¸¸ å› ä¸ºå‡½æ•°å¯¹è±¡ä»¥å€¼ä¼ é€’å’Œè¿”å›ï¼Œä½ çš„ä»»åŠ¡å°±æ˜¯ç¡®ä¿å½“æ‹·è´ä¼ é€’æ—¶ä½ çš„å‡½æ•°å¯¹è±¡è¡Œä¸ºè‰¯å¥½ã€‚ è¿™æš—ç¤ºäº†2ä¸ªä¸œè¥¿: ä½ çš„å‡½æ•°å¯¹è±¡åº”è¯¥å¾ˆå°ã€‚å¦åˆ™å®ƒä»¬çš„æ‹·è´ä¼šå¾ˆæ˜‚è´µã€‚ ä½ çš„å‡½æ•°å¯¹è±¡å¿…é¡»å•æ€ï¼ˆä¹Ÿå°±æ˜¯ï¼Œéå¤šæ€ï¼‰â€”â€”å®ƒä»¬ä¸èƒ½ç”¨è™šå‡½æ•°ã€‚é‚£æ˜¯å› ä¸ºæ´¾ç”Ÿç±»å¯¹è±¡ä»¥å€¼ä¼ é€’ä»£å…¥åŸºç±»ç±»å‹çš„å‚æ•°ä¼šé€ æˆåˆ‡å‰²é—®é¢˜: åœ¨æ‹·è´æ—¶ï¼Œå®ƒä»¬çš„æ´¾ç”Ÿéƒ¨åˆ†è¢«åˆ é™¤ã€‚ å½“ç„¶æ•ˆç‡å¾ˆé‡è¦ï¼Œé¿å…åˆ‡å‰²é—®é¢˜ä¹Ÿæ˜¯ï¼Œä½†ä¸æ˜¯æ‰€æœ‰çš„ä»¿å‡½æ•°éƒ½æ˜¯å°çš„ã€å•æ€çš„ã€‚å‡½æ•°å¯¹è±¡æ¯”çœŸçš„å‡½æ•°ä¼˜è¶Šçš„çš„åŸå› ä¹‹ä¸€æ˜¯ä»¿å‡½æ•°å¯ä»¥åŒ…å«ä½ éœ€è¦çš„æ‰€æœ‰çŠ¶æ€ã€‚ æœ‰äº›å‡½æ•°å¯¹è±¡è‡ªç„¶ä¼šå¾ˆé‡ï¼Œä¿æŒä¼ è¿™æ ·çš„ä»¿å‡½æ•°ç»™STLç®—æ³•å’Œä¼ å®ƒä»¬çš„å‡½æ•°ç‰ˆæœ¬ä¸€æ ·å®¹æ˜“æ˜¯å¾ˆé‡è¦çš„ã€‚ ","date":"2023-09-06","objectID":"/posts/effective_stl_38/:2:0","tags":["Effective STL"],"title":"Effective STL [38] | æŠŠä»¿å‡½æ•°ç±»è®¾è®¡ä¸ºç”¨äºå€¼ä¼ é€’","uri":"/posts/effective_stl_38/"},{"categories":["C++"],"content":"å¤šæ€ä»¿å‡½æ•°å®ç° ç¦æ­¢å¤šæ€ä»¿å‡½æ•°æ˜¯ä¸åˆ‡å®é™…çš„ã€‚C++æ”¯æŒç»§æ‰¿å±‚æ¬¡å’ŒåŠ¨æ€ç»‘å®šï¼Œè¿™äº›ç‰¹æ€§åœ¨è®¾è®¡ä»¿å‡½æ•°ç±»å’Œå…¶ä»–ä¸œè¥¿çš„æ—¶å€™ä¸€æ ·æœ‰ç”¨ã€‚ä»¿å‡½æ•°ç±»å¦‚æœç¼ºå°‘ç»§æ‰¿å°±åƒC++ç¼ºå°‘â€œ++â€ã€‚ å¸¦ç€ä½ è¦æ”¾è¿›ä½ çš„ä»¿å‡½æ•°ç±»çš„æ•°æ®å’Œ/æˆ–å¤šæ€ï¼ŒæŠŠå®ƒä»¬ç§»åˆ°å¦ä¸€ä¸ªç±»ä¸­ã€‚ç„¶åç»™ä½ çš„ä»¿å‡½æ•°ä¸€ä¸ªæŒ‡å‘è¿™ä¸ªæ–°ç±»çš„æŒ‡é’ˆã€‚ æ¯”å¦‚ï¼Œå¦‚æœä½ æƒ³è¦å»ºç«‹ä¸€ä¸ªåŒ…å«å¾ˆå¤šæ•°æ®çš„å¤šæ€ä»¿å‡½æ•°ç±»ã€‚ // BPFC = â€œBig Polymorphic Functor Classâ€ template \u003ctypename T\u003e class BPFC : public unary_function\u003cT, void\u003e { // æ¡æ¬¾40è§£é‡Šäº†è¿™ä¸ªåŸºç±» private: Widget w; Int x; // è¿™ä¸ªç±»æœ‰å¾ˆå¤šæ•°æ®ï¼Œæ‰€ä»¥ç”¨å€¼ä¼ é€’ ... // ä¼šå½±å“æ•ˆç‡ public : virtual void operator()(const T\u0026 val) const; // è¿™æ˜¯ä¸€ä¸ªè™šå‡½æ•°ï¼Œæ‰€ä»¥åˆ‡å‰²æ—¶ä¼šå‡ºé—®é¢˜ ... }; å»ºç«‹ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæŒ‡å‘å®ç°ç±»çš„æŒ‡é’ˆçš„å°è€Œå•æ€çš„ç±»ï¼Œç„¶åæŠŠæ‰€æœ‰æ•°æ®å’Œè™šå‡½æ•°æ”¾åˆ°å®ç°ç±»: // ç”¨äºä¿®æ”¹çš„BPFCçš„æ–°å®ç°ç±» template \u003ctypename T\u003e class BPFCImpl : public unary_function\u003cT, void\u003e { private: // ä»¥å‰åœ¨BPFCé‡Œçš„æ‰€æœ‰æ•°æ®ç°åœ¨åœ¨è¿™é‡Œ Widget w; int x; ... // å¤šæ€ç±»éœ€è¦è™šææ„å‡½æ•° virtual ~BPFCImpl(); virtual void operator()(const T\u0026 val) const; friend class BPFC\u003cT\u003e; // è®©BPFCå¯ä»¥è®¿é—®è¿™äº›æ•°æ® }; // å°çš„ï¼Œå•æ€ç‰ˆçš„BPFC template \u003ctypename T\u003e class BPFC : public unary_function\u003cT, void\u003e { private: BPFCImpl\u003cT\u003e* pImpl; // è¿™æ˜¯BPFCå”¯ä¸€çš„æ•°æ® public: // ç°åœ¨éè™šï¼› void operator()(const T\u0026 val) const { // è°ƒç”¨BPFCImplçš„çœŸçš„è™šå‡½æ•° pImpl-\u003eoperator()(val); } ... }; BPFC::operator()çš„å®ç°ä¾‹è¯äº†BPFCæ‰€æœ‰çš„è™šå‡½æ•°æ˜¯æ€ä¹ˆå®ç°çš„: å®ƒä»¬è°ƒç”¨äº†åœ¨BPFCImplä¸­å®ƒä»¬çœŸçš„è™šå‡½æ•°ã€‚ ç»“æœæ˜¯ä»¿å‡½æ•°ç±»ï¼ˆBPFCï¼‰æ˜¯å°è€Œå•æ€çš„ï¼Œä½†å¯ä»¥è®¿é—®å¤§é‡çŠ¶æ€è€Œä¸”è¡Œä¸ºå¤šæ€ã€‚ é¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™ç§å®ç°æ–¹æ³•åœ¨ã€ŠEffective C++ã€‹çš„æ¡æ¬¾34ä¸­æœ‰ã€‚åœ¨Gammaç­‰çš„ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸­ï¼Œè¿™å«åšâ€œBridgeæ¨¡å¼â€ã€‚Sutteråœ¨ä»–çš„ã€ŠExceptional C++ã€‹ä¸­å«å®ƒâ€œPimplæƒ¯ç”¨æ³•â€ã€‚ ","date":"2023-09-06","objectID":"/posts/effective_stl_38/:3:0","tags":["Effective STL"],"title":"Effective STL [38] | æŠŠä»¿å‡½æ•°ç±»è®¾è®¡ä¸ºç”¨äºå€¼ä¼ é€’","uri":"/posts/effective_stl_38/"},{"categories":["C++"],"content":"æ€»ç»“ ä»STLçš„è§†è§’çœ‹æ¥ï¼Œè¦è®°ä½çš„æœ€é‡è¦çš„ä¸œè¥¿æ˜¯ä½¿ç”¨è¿™ç§æŠ€æœ¯çš„ä»¿å‡½æ•°ç±»å¿…é¡»æ”¯æŒåˆç†æ–¹å¼çš„æ‹·è´ã€‚ å”¯ä¸€ä½ å¿…é¡»æ‹…å¿ƒçš„æ˜¯BPFCçš„æ‹·è´æ„é€ å‡½æ•°çš„è¡Œä¸ºï¼Œå› ä¸ºå½“åœ¨STLä¸­è¢«ä¼ é€’æˆ–ä»ä¸€ä¸ªå‡½æ•°è¿”å›æ—¶ï¼Œå‡½æ•°å¯¹è±¡æ€»æ˜¯è¢«æ‹·è´â€”â€”å€¼ä¼ é€’ã€‚ è®°å¾—å—ï¼Ÿé‚£æ„å‘³ç€ä¸¤2ä»¶äº‹: è®©å®ƒä»¬å°ï¼Œè€Œä¸”è®©å®ƒä»¬å•æ€ã€‚ ","date":"2023-09-06","objectID":"/posts/effective_stl_38/:4:0","tags":["Effective STL"],"title":"Effective STL [38] | æŠŠä»¿å‡½æ•°ç±»è®¾è®¡ä¸ºç”¨äºå€¼ä¼ é€’","uri":"/posts/effective_stl_38/"},{"categories":["AutonomousDriving","Perception"],"content":"1. èƒŒæ™¯/Motivation ","date":"2023-09-03","objectID":"/posts/bevformer/:1:0","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"1.1 ä¸ºä»€ä¹ˆè§†è§‰æ„ŸçŸ¥è¦ç”¨BEVï¼Ÿ ç›¸æœºå›¾åƒæè¿°çš„æ˜¯ä¸€ä¸ª2Dåƒç´ ä¸–ç•Œï¼Œç„¶è€Œè‡ªåŠ¨é©¾é©¶ä¸­åˆ©ç”¨ç›¸æœºæ„ŸçŸ¥ç»“æœçš„åç»­å†³ç­–ã€è·¯å¾„è§„åˆ’éƒ½æ˜¯åœ¨è½¦è¾†æ‰€å¤„çš„3Dä¸–ç•Œä¸‹è¿›è¡Œã€‚ç”±æ­¤å¼•å…¥çš„2Då’Œ3Dç»´åº¦ä¸åŒ¹é…ï¼Œå°±å¯¼è‡´åŸºäºç›¸æœºæ„ŸçŸ¥ç»“æœç›´æ¥è¿›è¡Œè‡ªåŠ¨é©¾é©¶å˜å¾—å¼‚å¸¸å›°éš¾ã€‚ è¿™ç§æ„ŸçŸ¥å’Œå†³ç­–è§„åˆ’çš„ç©ºé—´ç»´åº¦ä¸åŒ¹é…çš„çŸ›ç›¾ï¼Œä¹Ÿä½“ç°åœ¨å­¦å¼€è½¦çš„æ–°æ‰‹ä¸Šã€‚å€’è½¦æ³Šè½¦æ—¶ï¼Œæ–°æ‰‹é€šè¿‡åè§†é•œè§‚å¯Ÿè½¦è¾†å‘¨å›´ï¼Œå¾ˆéš¾ç›´è§‚åœ°æ„å»ºè½¦å­ä¸å‘¨å›´éšœç¢ç‰©çš„ç©ºé—´è”ç³»ï¼Œå®¹æ˜“å¯¼è‡´è¯¯æ“ä½œå‰è¹­æˆ–éœ€è¦å°è¯•å¤šæ¬¡æ‰èƒ½æ³Šè½¦æˆåŠŸï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯æ–°æ‰‹ä»2Då›¾åƒåˆ°3Dç©ºé—´çš„è½¬æ¢èƒ½åŠ›è¾ƒå¼±ã€‚åŸºäºç›¸æœºå›¾åƒå¹³é¢æ„ŸçŸ¥ç»“æœè¿›è¡Œå†³ç­–è§„åˆ’çš„è‡ªåŠ¨é©¾é©¶AIï¼Œå°±å¥½æ¯”ç¼ºä¹ç©ºé—´ç†è§£åŠ›çš„é©¾é©¶æ–°æ‰‹ï¼Œå¾ˆéš¾æŠŠè½¦å¼€å¥½ã€‚ å®é™…ä¸Šï¼Œåˆ©ç”¨æ„ŸçŸ¥ç»“æœè¿›è¡Œå†³ç­–å’Œè·¯å¾„è§„åˆ’ï¼Œé—®é¢˜è¿˜å‡ºç°åœ¨å¤šè§†è§’èåˆè¿‡ç¨‹ä¸­: åœ¨æ¯ä¸ªç›¸æœºä¸Šè¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œç„¶åå¯¹ç›®æ ‡è¿›è¡Œè·¨ç›¸æœºèåˆã€‚å¦‚2021 TESLA AI Dayç»™å‡ºçš„å›¾1ï¼Œå¸¦æ‹–æŒ‚çš„å¡è½¦åˆ†å¸ƒåœ¨å¤šä¸ªç›¸æœºæ„ŸçŸ¥é‡å†…ï¼Œåœ¨è¿™ç§åœºæ™¯ä¸‹è¯•å›¾é€šè¿‡ç›®æ ‡æ£€æµ‹å’Œèåˆæ¥çœŸå®åœ°æè¿°å¡è½¦åœ¨çœŸå®ä¸–ç•Œä¸­çš„å§¿æ€ï¼Œå­˜åœ¨éå¸¸å¤§çš„æŒ‘æˆ˜ã€‚ ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œå¾ˆå¤šå…¬å¸é‡‡ç”¨ç¡¬ä»¶è¡¥å……æ·±åº¦æ„ŸçŸ¥èƒ½åŠ›ï¼Œå¦‚å¼•å…¥æ¯«ç±³æ³¢é›·è¾¾æˆ–æ¿€å…‰é›·è¾¾ä¸ç›¸æœºç»“åˆï¼Œè¾…åŠ©ç›¸æœºæŠŠå›¾åƒå¹³é¢æ„ŸçŸ¥ç»“æœè½¬æ¢åˆ°è‡ªè½¦æ‰€åœ¨çš„3Dä¸–ç•Œï¼Œæè¿°è¿™ä¸ª3Dä¸–ç•Œçš„ä¸“ä¸šæœ¯è¯­å«åšBEV mapæˆ–BEV features(é¸Ÿç°å›¾æˆ–é¸Ÿç°å›¾ç‰¹å¾)ï¼Œå¦‚æœå¿½ç•¥é«˜åº¦ä¿¡æ¯ï¼Œå°±æŠŠæ‹æ‰åçš„è‡ªè½¦åæ ‡ç³»å«åšBEVåæ ‡ç³»(å³é¸Ÿç°ä¿¯è§†å›¾åæ ‡ç³»)ã€‚ ä½†å¦å¤–ä¸€äº›å…¬å¸åˆ™åšæŒä¸å¼•å…¥æ·±åº¦æ„ŸçŸ¥ä¼ æ„Ÿå™¨ï¼Œä»–ä»¬å°è¯•ä»æœ¬è´¨å…¥æ‰‹ï¼ŒåŸºäºè§†è§‰å­¦ä¹ å¾—åˆ°ä»å›¾åƒç†è§£ç©ºé—´çš„èƒ½åŠ›ï¼Œè®©è‡ªåŠ¨é©¾é©¶AIç³»ç»Ÿæ›´åƒè€å¸æœºï¼Œä¾‹å¦‚TESLAã€‚Elon Muskè®¤ä¸º: äººç±»ä¸æ˜¯è¶…äººï¼Œä¹Ÿä¸æ˜¯è™è ä¾ ï¼Œä¸èƒ½å¤Ÿçœ¼æ”¾æ¿€å…‰ï¼Œä¹Ÿæ²¡å®‰è£…é›·è¾¾ï¼Œä½†æ˜¯é€šè¿‡çœ¼ç›æ•æ‰åˆ°çš„å›¾åƒï¼Œäººç±»åå¤ç»ƒä¹ å°±å¯ä»¥æ„å»ºå‡ºå¯¹å‘¨å›´ä¸–ç•Œçš„3Dç©ºé—´ç†è§£èƒ½åŠ›ä»è€Œå¾ˆå¥½åœ°æŒæ¡é©¾é©¶è¿™é¡¹èƒ½åŠ›ï¼Œé‚£ä¹ˆè¦åƒäººä¸€æ ·å•çº¯åˆ©ç”¨çœ¼ç›(ç›¸æœº)è¿›è¡Œè‡ªåŠ¨é©¾é©¶å°±å¿…é¡»å…·å¤‡ä»2Då›¾åƒå¹³é¢åˆ°3Dè‡ªè½¦ç©ºé—´(BEV)çš„è½¬æ¢èƒ½åŠ›ã€‚ ä¼ ç»Ÿè·å–BEV map/featuresçš„æ–¹æ³•æœ‰å±€é™æ€§ï¼Œå®ƒä¸€èˆ¬æ˜¯åˆ©ç”¨ç›¸æœºå¤–å‚ä»¥åŠåœ°é¢å¹³é¢å‡è®¾ï¼Œå³IPM(Inverse Perspective Mapping)æ–¹æ³•ï¼Œå°†å›¾åƒå¹³é¢çš„æ„ŸçŸ¥ç»“æœåæŠ•å½±åˆ°è‡ªè½¦BEVåæ ‡ç³»ã€‚Teslaä»¥å‰çš„æ–¹æ¡ˆä¹Ÿæ˜¯è¿™æ ·ï¼Œç„¶è€Œå½“è½¦è¾†å‘¨å›´åœ°é¢ä¸æ»¡è¶³å¹³é¢å‡è®¾ï¼Œä¸”å¤šç›¸æœºè§†é‡å…³è”å—åˆ°å„ç§å¤æ‚ç¯å¢ƒå½±å“çš„æ—¶å€™ï¼Œè¿™ç±»æ–¹æ³•å°±éš¾ä»¥åº”ä»˜ã€‚ é’ˆå¯¹IPMæ–¹æ³•è·å–BEVé‡åˆ°çš„å›°éš¾ï¼ŒTESLAè‡ªåŠ¨é©¾é©¶æ„ŸçŸ¥è´Ÿè´£äººAndrej Karparthyçš„å›¢é˜Ÿç›´æ¥åœ¨ç¥ç»ç½‘ç»œä¸­å®Œæˆå›¾åƒå¹³é¢åˆ°BEVçš„ç©ºé—´å˜æ¢ï¼Œè¿™ä¸€æ”¹å˜æˆä¸ºäº†2020å¹´10æœˆå‘å¸ƒçš„FSD Betaä¸ä¹‹å‰Autopilotäº§å“æœ€æ˜¾è‘—çš„å·®åˆ«ã€‚TESLAåˆ©ç”¨Transformerç”ŸæˆBEV Featruesï¼Œå¾—åˆ°çš„Featuresé€šé“æ•°æ˜¯256(IPMæ–¹æ³•æœ€å¤šä¿ç•™RGB3ä¸ªchannel)ï¼Œè¿™æ ·èƒ½æå¤§ç¨‹åº¦åœ°ä¿ç•™å›¾åƒä¿¡æ¯ï¼Œç”¨äºåç»­åŸºäºBEV Featuresçš„å„ç§ä»»åŠ¡ï¼Œå¦‚åŠ¨ã€é™æ€ç›®æ ‡æ£€æµ‹å’Œçº¿æ£€æµ‹ç­‰ã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:1:1","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"1.2 ç”ŸæˆBEVè§†è§’çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿä¸ºä½•é€‰ç”¨Transformerå‘¢ï¼Ÿ æŠŠç›¸æœº2Då¹³é¢å›¾åƒè½¬æ¢æˆBEVè§†è§’çš„æ–¹æ³•æœ‰ä¸¤ç§: è§†è§‰å‡ ä½•æ–¹æ³•å’Œç¥ç»ç½‘ç»œæ–¹æ³•ã€‚ è§†è§‰å‡ ä½•æ–¹æ³•: åŸºäºIPMè¿›è¡Œé€åƒç´ å‡ ä½•æŠ•å½±è½¬æ¢ä¸ºBEVè§†è§’ï¼Œå†å¯¹å¤šä¸ªè§†è§’çš„éƒ¨åˆ†BEVå›¾æ‹¼æ¥å½¢æˆå®Œæ•´BEVå›¾ã€‚æ­¤æ–¹æ³•æœ‰ä¸¤ä¸ªå‡è®¾: 1.è·¯é¢ä¸ä¸–ç•Œåæ ‡ç³»å¹³è¡Œï¼Œ2.è½¦è¾†è‡ªèº«çš„åæ ‡ç³»ä¸ä¸–ç•Œåæ ‡ç³»å¹³è¡Œã€‚å‰è€…åœ¨è·¯é¢éå¹³å¦çš„æƒ…å†µä¸‹å¹¶ä¸æ»¡è¶³ï¼Œåè€…ä¾èµ–è½¦è¾†å§¿æ€å‚æ•°(Pitchå’ŒRoll)å®æ—¶æ ¡æ­£ï¼Œä¸”ç²¾åº¦è¦æ±‚è¾ƒé«˜ï¼Œä¸æ˜“å®ç°ã€‚ ç¥ç»ç½‘ç»œæ–¹æ³•: ç”¨ç¥ç»ç½‘ç»œç”ŸæˆBEVï¼Œå…¶ä¸­çš„å…³é”®è¦æ‰¾åˆ°åˆé€‚çš„æ–¹æ³•å®ç°ç¥ç»ç½‘ç»œå†…éƒ¨Feature Mapç©ºé—´å°ºå¯¸ä¸Šçš„å˜æ¢ã€‚ å®ç°ç©ºé—´å°ºå¯¸å˜æ¢çš„ç¥ç»ç½‘ç»œä¸»æµæ“ä½œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œå¦‚å›¾2æ‰€ç¤º: MLPä¸­çš„Fully Connected Layerå’ŒTransformer Cross Attention(å›¾ç‰‡å¼•ç”¨è‡ªã€Šè¶…é•¿å»¶è¿Ÿçš„ç‰¹æ–¯æ‹‰AI Dayè§£æ: è®²æ˜ç™½FSDè½¦ç«¯æ„ŸçŸ¥ã€‹) MLP Fully Connected Layeræ–¹æ³•: $$O=Act(W_{mlp}*X+b)$$ å¿½ç•¥éçº¿æ€§æ¿€æ´»å‡½æ•°å’Œbiasåï¼Œå¯ä»¥å†™æˆ: $$O=W_{mlp}*X$$ Transformer Cross Attentionæ–¹æ³•: $$O=Softmax(Q*K^T)*V$$ å…¶ä¸­ï¼ŒKå’ŒVæ˜¯è¾“å…¥å›¾åƒç‰¹å¾Xç»çº¿æ€§å˜æ¢åå¾—åˆ°çš„ï¼›åœ¨æœ€ç»ˆè¾“å‡ºçš„BEVè§†è§’ä¸‹ï¼ŒæŠŠè‡ªè½¦å‘¨å›´ç©ºé—´ä¸­çš„ç´¢å¼•é‡ç§°ä½œ $\\boldsymbol{\\Phi}$ $$O=Softmax(\\Phi W_q*(XW_K)^T)*XW_V=W_{transformer}(X,\\Phi)*XW_V$$ BEVå˜æ¢çš„æœ¬è´¨æ˜¯å°†è¾“å…¥çš„2Då›¾åƒç©ºé—´ç‰¹å¾å›¾è½¬æ¢æˆBEVç‰¹å¾å›¾ã€‚åœ¨è¿›è¡ŒBEVè½¬æ¢ä¹‹å‰ï¼Œå…ˆé€šè¿‡å¤šå±‚CNN(æˆ–è€…ä»»ä¸€å›¾åƒå¤„ç†backboneç½‘ç»œ)åœ¨å›¾åƒä¸Šæå–ç‰¹å¾ï¼Œå¾—åˆ°å›¾åƒç©ºé—´ç‰¹å¾å›¾å±‚å°ºå¯¸($h * w$)ï¼Œå³$X$çš„å°ºå¯¸ã€‚ BEVå˜æ¢è¾“å‡ºOæ‰€åœ¨çš„BEVç©ºé—´å°ºå¯¸ï¼Œæ˜¯ä»¥è‡ªè½¦ä½ç½®ä¸ºåŸç‚¹çš„å‰åå·¦å³å„è‹¥å¹²ç±³èŒƒå›´å†…å»ºç«‹çš„æ …æ ¼ç©ºé—´($x * y$)ã€‚ MLP Fully Connect Layerå’ŒCross Attentionçš„æ˜¾è‘—å·®åˆ«åœ¨äºä½œç”¨äºè¾“å…¥é‡Xçš„ç³»æ•°W: å…¨è”æ¥å±‚çš„Wï¼Œä¸€æ—¦è®­ç»ƒç»“æŸååœ¨Inferenceé˜¶æ®µæ˜¯å›ºå®šä¸å˜çš„ï¼›è€ŒCross Attentionçš„Transformerçš„ç³»æ•°Wï¼Œæ˜¯è¾“å…¥é‡Xå’Œç´¢å¼•é‡çš„å‡½æ•°ï¼Œåœ¨Inferenceé˜¶æ®µä¼šæ ¹æ®è¾“å…¥é‡Xå’Œç´¢å¼•é‡çš„ä¸åŒå‘ç”Ÿæ”¹å˜ã€‚ä»è¿™ä¸ªè§’åº¦æ¥è®²ï¼Œä½¿ç”¨Cross Attentionæ¥è¿›è¡Œç©ºé—´å˜æ¢å¯èƒ½ä½¿æ¨¡å‹è·å¾—æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›ã€‚ TESLAåœ¨2021å¹´AI Dayä¸Šä»…ä»‹ç»äº†ç”¨Transformerè½¬æ¢BEV Featuresçš„æŠ€æœ¯æ€æƒ³ï¼Œå¹¶æœªæŠ«éœ²æ›´å¤šå®ç°ç»†èŠ‚ã€‚è®ºæ–‡BEVFormerå……åˆ†ç ”ç©¶äº†TESLAçš„æŠ€æœ¯æ€æƒ³åï¼Œåˆ©ç”¨Transformerèåˆå›¾åƒçš„æ—¶ã€ç©ºç‰¹å¾ï¼Œå¾—åˆ°BEV Featuresï¼Œä¸TESLAçš„å…³é”®æ–¹æ³•ã€å®ç°æ•ˆæœéƒ½éå¸¸æ¥è¿‘ã€‚BEVFormeræ—¢é€šè¿‡è®ºæ–‡æŠ«éœ²äº†è¯¦å°½æ–¹æ³•ï¼Œåˆåœ¨2022å¹´6æœˆå¼€æºäº†å·¥ç¨‹ï¼Œæ¥ä¸‹æ¥å°±å›´ç»•BEVFormerä»‹ç»å¦‚ä½•é€šè¿‡Transformerè·å–BEV Featuresã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:1:2","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"2. Method/Strategyâ€”â€”BEVFormer ","date":"2023-09-03","objectID":"/posts/bevformer/:2:0","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"2.1 Overall Architecture å¦‚ä¸‹å›¾3æ‰€ç¤º: BEVFormerä¸»ä½“éƒ¨åˆ†æœ‰6å±‚ç»“æ„ç›¸åŒçš„BEVFormer encoder layersï¼Œæ¯ä¸€å±‚éƒ½æ˜¯ç”±ä»¥transformerä¸ºæ ¸å¿ƒçš„modules(TSA+SCA)ï¼Œå†åŠ ä¸ŠFFã€Addå’ŒNormç»„æˆã€‚BEVFormer encoder layerç»“æ„ä¸­æœ‰3ä¸ªç‰¹åˆ«çš„è®¾è®¡: BEV Queriesï¼Œ Spatial Cross-attention(SCA)å’ŒTemporal Self-attention(TSA)ã€‚å…¶ä¸­BEV Queriesæ˜¯æ …æ ¼å½¢å¯å­¦ä¹ å‚æ•°ï¼Œæ‰¿è½½ç€é€šè¿‡attentionæœºåˆ¶åœ¨multi-camera viewsä¸­æŸ¥è¯¢ã€èšåˆçš„featuresã€‚SCAå’ŒTSAæ˜¯ä»¥BEV Queriesä½œä¸ºè¾“å…¥çš„æ³¨æ„åŠ›å±‚ï¼Œè´Ÿè´£å®æ–½æŸ¥è¯¢ã€èšåˆç©ºé—´features(æ¥è‡ªmulti-camera images)å’Œæ—¶é—´features(æ¥è‡ªå†å²BEV)çš„è¿‡ç¨‹ã€‚ ä¸‹é¢åˆ†æ­¥éª¤è§‚å¯ŸBEVå®Œæ•´æ¨¡å‹çš„å‰å‘æ¨ç†è¿‡ç¨‹: åœ¨tæ—¶åˆ»ï¼Œè¾“å…¥è½¦ä¸Šå¤šä¸ªè§†è§’ç›¸æœºçš„å›¾åƒåˆ°backboneï¼Œè¾“å‡ºå„å›¾åƒçš„å¤šå°ºåº¦ç‰¹å¾(multi-scale features): $x = 1$, $F_t = {{F^i_t}}^a_b$, $F_t={{{F_t^i}}}{i=1}^{N{view}}$ï¼Œå…¶ä¸­ $F^i_t$ æ˜¯ç¬¬iä¸ªè§†è§’ç›¸æœºçš„featureï¼Œ$N_{view}$ æ˜¯å¤šä¸ªç›¸æœºè§†è§’çš„æ€»æ•°ã€‚åŒæ—¶ï¼Œè¿˜è¦ä¿ç•™t-1æ—¶åˆ»çš„BEV Features ${\\boldsymbol{B}}_{t-1}$ã€‚ åœ¨æ¯ä¸ªBEVFormer Encoder layerä¸­ï¼Œé¦–å…ˆç”¨BEV Queries Qé€šè¿‡TSAæ¨¡å—ä» ${\\boldsymbol{B}}_{t-1}$ ä¸­æŸ¥è¯¢å¹¶èåˆæ—¶åŸŸä¿¡æ¯(the temporal information)ï¼Œå¾—åˆ°ä¿®æ­£åçš„BEV Queries $Q^{\\prime}$ï¼› ç„¶ååœ¨åŒä¸€ä¸ªBEVFormer Encoder layerä¸­ï¼Œå¯¹TSAâ€œä¿®è¯â€è¿‡çš„BEV Queries $Q^{\\prime}$ ï¼Œé€šè¿‡SCAæ¨¡å—ä»multi-camera features $F_{t}$ æŸ¥è¯¢å¹¶èåˆç©ºåŸŸä¿¡æ¯(spatial information)ï¼Œå¾—åˆ°è¿›ä¸€æ­¥ä¿®æ­£çš„BEV Queries $Q^{^{\\prime\\prime}}$ ã€‚ è¿™ä¸€å±‚encoder layeræŠŠç»è¿‡ä¸¤æ¬¡ä¿®æ­£çš„BEV features $Q^{^{\\prime\\prime}}$ (ä¹Ÿå¯ä»¥å«åšBEV Queries)è¿›è¡ŒFFè®¡ç®—ï¼Œç„¶åè¾“å‡ºï¼Œä½œä¸ºä¸‹ä¸€ä¸ªencoder layerçš„è¾“å…¥ã€‚ å¦‚æ­¤å †å 6å±‚ï¼Œå³ç»è¿‡6è½®å¾®è°ƒï¼Œtæ—¶åˆ»çš„ç»Ÿä¸€BEV features $B_{t}$ å°±ç”Ÿæˆäº†ã€‚ æœ€åï¼Œä»¥BEV Features $B_{t}$ ä½œä¸ºè¾“å…¥ï¼Œ3D detection headå’Œmap segmentation headé¢„æµ‹æ„ŸçŸ¥ç»“æœï¼Œä¾‹å¦‚3D bounding boxeså’Œsemantic mapã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:2:1","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"2.2 BEV Queries BEVFormeré‡‡ç”¨æ˜¾æ€§å®šä¹‰BEVçš„æ–¹å¼ï¼ŒBEV Querieså°±æ˜¯å…¶ä¸­çš„æ˜¾æ€§BEV featuresã€‚ å¯ä»3ä¸ªæ¦‚å¿µå¾ªåºæ¸è¿›åœ°è®¤è¯†/ç†è§£BEV Queries: BEVå¹³é¢ â†’ BEV æ„ŸçŸ¥ç©ºé—´ â†’ BEV Queriesã€‚ BEV å¹³é¢ BEVå¹³é¢($R^{H\\times W\\times1}$)æ˜¯ä»¥è‡ªè½¦ä¸ºä¸­å¿ƒçš„æ …æ ¼åŒ–äºŒç»´å¹³é¢ï¼ŒHã€Wæ˜¯BEVå¹³é¢åœ¨xã€yæ–¹å‘çš„æ …æ ¼å°ºå¯¸ï¼Œæ­¤å¹³é¢æ˜¾æ€§åœ°ä¸è½¦è¾†å‘¨å›´æ¨ªã€çºµå‘ç‰©ç†ç©ºé—´å…³è”ï¼Œä¸€ä¸ªæ …æ ¼è¡¨ç¤ºsç±³ï¼Œè®ºæ–‡ä¸­æŠŠBEVå¹³é¢ä¸­çš„æ …æ ¼å«åš2Då‚è€ƒç‚¹(2D reference points)ã€‚ä¾‹å¦‚è®ºæ–‡ä¸­å®šä¹‰nuScenesæ•°æ®é›†æ …æ ¼å°ºå¯¸200x200ï¼Œå¯¹åº”[-51.2ç±³, 51.2ç±³]ï¼Œé‚£ä¹ˆså°±æ˜¯0.512ç±³ã€‚ BEV æ„ŸçŸ¥ç©ºé—´ BEVæ„ŸçŸ¥ç©ºé—´( $R^{H\\times W\\times N_{ref}}$ )æŠŠBEVå¹³é¢åœ¨zè½´æ–¹å‘é€‰å– $N_{ref}$ä¸ª3Då‚è€ƒç‚¹è¿›è¡Œæ‰©å±•ï¼Œè¡¨ç¤ºè½¦è¾†å‘¨å›´æœ‰é™ç©ºé—´ã€‚æŸ¥çœ‹BEVå¼€æºå·¥ç¨‹å¯çŸ¥ï¼ŒBEVæ„ŸçŸ¥ç©ºé—´çš„ç²¾ç¡®è¡¨ç¤ºèŒƒå›´: åœ¨nuScenesæ•°æ®é›†ä¸­ï¼Œæ˜¯ä»¥Lidarä½œä¸ºä¸­å¿ƒç‚¹ï¼Œå‰åå„51.2mã€å·¦å³å„51.2mã€å‘ä¸Š3mã€å‘ä¸‹5mçš„çŸ©å½¢ç©ºé—´ã€‚ ä»”ç»†æ·±ç©¶ä½œè€…è¿™æ ·è®¾ç½®çš„ç”¨æ„ï¼Œä¼šå‘ç°è›®æœ‰æ„æ€/æ„ä¹‰: nuScenesé‡‡é›†è½¦ä¸Šå®‰è£…çš„Lidarè·åœ°é¢é«˜çº¦1.84mï¼Œ[-5m, 3m]çš„è®¾ç½®è®©BEV Queriesæ„ŸçŸ¥ç©ºé—´åœ¨è‡ªè½¦è½®èƒæ¥åœ°ç‚¹å¹³é¢ä»¥ä¸Šéƒ¨åˆ†çº¦4.84mï¼Œæ¥åœ°ç‚¹å¹³é¢ä»¥ä¸‹éƒ¨åˆ†çº¦3.16mã€‚å‰è€…ç¡®ä¿ä¸ä»…èƒ½æ„ŸçŸ¥é«˜å¤§ç›®æ ‡ç‰©ï¼Œå¦‚è´§è½¦ç­‰ï¼Œè¿˜èƒ½æ„ŸçŸ¥è¦†ç›–å¡åº¦9.5%(4.84m/51.2m100%)ä¸Šå¡åœºæ™¯ï¼Œåè€…ä¿è¯æ„ŸçŸ¥è¦†ç›–å¡åº¦6.2%(3.16m/51.2m100%)ä¸‹å¡åœºæ™¯ã€‚å¤‡æ³¨: å¡åº¦=(é«˜ç¨‹å·®/æ°´å¹³è·ç¦»)x100%ï¼Œè½¦è¾†å‰è¿›100mçš„å‚ç›´ä¸Šå‡/ä¸‹é™é«˜åº¦ï¼Œæˆ‘å›½è§„å®šåŸå¸‚é“è·¯æœ€å¤§çºµå¡8ï¼…ï¼Œå…¬è·¯9ï¼…ã€‚ BEV Queries BEV Queriesæ˜¯é¢„å®šä¹‰çš„ä¸€ç»„æ …æ ¼å½¢(grid-shaped)å¯å­¦ä¹ å‚æ•°ï¼Œç®€ç§° $Q\\in R^{H\\times W\\times C}$ï¼Œå®ƒæ˜¯å¯¹ä¸Šè¿°BEV æ„ŸçŸ¥ç©ºé—´çš„ç‰¹å¾æè¿°ï¼Œå¯ç›´ç™½åœ°ç†è§£ä¸ºå­¦ä¹ å®Œæˆäº†ï¼Œå®ƒå°±å˜æˆäº†BEV featuresã€‚ BEV Queriesçš„Hã€Wä¸BEVå¹³é¢åœ¨xã€yæ–¹å‘çš„æ …æ ¼å°ºå¯¸å®šä¹‰ä¸€è‡´ï¼Œå› æ­¤ä¹Ÿç»§æ‰¿äº†BEVå¹³é¢æ˜¾æ€§åœ°ä¸è½¦è¾†å‘¨å›´æ¨ªã€çºµå‘ç‰©ç†ç©ºé—´å…³è”çš„ç‰¹æ€§ã€‚ä½†Cæ˜¯BEV Queriesä½œä¸ºfeaturesæ—¶åœ¨channelç»´åº¦çš„å°ºå¯¸ï¼Œå¹¶ä¸æ˜¾æ€§åœ°å¯¹åº”äºBEVå¹³é¢zè½´çš„ç‰©ç†ç©ºé—´å°ºå¯¸ã€‚ç‰¹åˆ«æŒ‡å‡ºï¼Œä½äº $p=(x,y)$ å¤„çš„æŸä¸ªquery $Q_{p}\\in R^{1\\times C}$ï¼Œè¡¨ç¤ºBEV queriesä¸­çš„ä¸€ä¸ªæ …æ ¼ã€‚åœ¨è¾“å…¥åˆ°BEVFormerä¹‹å‰ï¼ŒBEV QueriesåŠ ä¸Šäº†å¯å­¦ä¹ çš„ä½ç½®ç¼–ç (learnable positional embedding)ã€‚ è®ºæ–‡ä¸­å¤šå¤„æåŠBEV Querieså’ŒBEV featuresï¼Œå®ƒä¿©ä»€ä¹ˆå…³ç³»ï¼Ÿæœ¬è´¨ä¸Šæè¿°çš„æ˜¯åŒä¸€ä¸ªä¸œè¥¿ä¹ˆï¼Ÿ å…ˆè¯´ç­”æ¡ˆ: ä¸¤è€…æœ¬è´¨ä¸Šæ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚æ¨¡å‹ä¸­é¢„å®šä¹‰å‚æ•°BEV Queries è¾“å…¥åˆ°BEV Encoder layerï¼Œè¾“å‡ºçš„å°±æ˜¯ç»è¿‡1æ¬¡å¾®è°ƒè¿‡çš„BEV featuresï¼Œå®ƒä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥æ—¶ï¼Œåˆè¢«çœ‹ä½œä¸‹ä¸€å±‚çš„BEV Queriesã€‚ç»è¿‡æ‰€æœ‰layersçš„å¤šæ¬¡å¾®è°ƒï¼Œæœ€åä¸€ä¸ªlayerè¾“å‡ºçš„å°±æ˜¯BEV features ${\\mathit{B}}_{t}$ ï¼Œä½œä¸ºå„ç±»æ„ŸçŸ¥task headsçš„è¾“å…¥ã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:2:2","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"2.3 SCA: Spatial cross-attention å¦‚ä¸Šå›¾(b)æ‰€ç¤ºï¼Œä½œè€…è®¾è®¡äº†ä¸€ç§ç©ºé—´äº¤å‰æ³¨æ„åŠ›æœºåˆ¶ï¼Œä½¿ BEV queries ä»å¤šä¸ªç›¸æœºçš„image Featuresä¸­æå–æ‰€éœ€ä¿¡æ¯å¹¶è½¬æ¢ä¸ºBEV Featuresã€‚ æ¯ä¸ªBEVæ …æ ¼çš„queryåœ¨image featuresçš„å“ªäº›èŒƒå›´æå–ä¿¡æ¯å‘¢ï¼Ÿè¿™é‡Œæœ‰3ä¸ªæ–¹æ¡ˆ: ä¸€ã€ä»image featuresçš„æ‰€æœ‰ç‚¹ä¸Šæå–ä¿¡æ¯ï¼Œå³global attentionã€‚ äºŒã€ä»BEVæ …æ ¼åœ¨image featuresçš„æŠ•å½±ç‚¹ä¸Šæå–ä¿¡æ¯ã€‚ ä¸‰ã€ä»BEVæ …æ ¼åœ¨image featuresçš„æŠ•å½±ç‚¹åŠå…¶å‘¨å›´æå–ä¿¡æ¯ï¼Œå³deformable attentionã€‚ ç”±äºä½¿ç”¨äº†å¤šå°ºåº¦å›¾åƒç‰¹å¾å’Œé«˜åˆ†è¾¨ç‡ BEV ç‰¹å¾(200x200)ï¼Œå¦‚æœé‡‡ç”¨æ–¹æ¡ˆä¸€ global attention ï¼Œä¼šå¸¦æ¥æ— æ³•è´Ÿæ‹…çš„è®¡ç®—ä»£ä»·(æ˜¾å­˜å’Œè®¡ç®—å¤æ‚åº¦)ã€‚ä½†æ˜¯ï¼Œæ–¹æ¡ˆä¸€å®Œå…¨ç”¨ä¸åˆ°ç›¸æœºå†…å¤–å‚ï¼Œè¿™ç®—æ˜¯å®ƒç‹¬æœ‰çš„ä¼˜åŠ¿ã€‚ æ–¹æ¡ˆäºŒä¾èµ–éå¸¸ç²¾ç¡®çš„ç›¸æœºå†…ã€å¤–å‚ï¼Œä¸”ä¸èƒ½å……åˆ†åˆ©ç”¨image featuresä¸Šçš„å±€éƒ¨åŒºåŸŸä¿¡æ¯ã€‚ å› æ­¤ä½œè€…é€‰ç”¨äº†æ–¹æ¡ˆä¸‰ï¼ŒåŸºäºdeformable attention çš„ç¨€ç–æ³¨æ„åŠ›æœºåˆ¶ï¼Œä½¿BEV Queriesä¸­çš„æ¯ä¸ªQuery åªä¸å…¶æ‰€ä»£è¡¨ä¸–ç•Œåæ ‡ç³»ç‰©ç†ç©ºé—´æŠ•å½±åˆ°å›¾åƒä¸Šçš„éƒ¨åˆ†åŒºåŸŸè¿›è¡Œäº¤äº’ï¼Œä¸”è§£é™¤äº†å¯¹ç›¸æœºå†…ã€å¤–å‚çš„é«˜ç²¾åº¦ä¾èµ–ã€‚æ³¨æ„ï¼Œè¿™é‡Œå¤æ•°BEV Queriesè¡¨ç¤ºæ•´ä¸ªBEVå›¾ï¼Œè€Œå•æ•°Queryè¡¨ç¤ºBEV å›¾ä¸­ä½äº $(x, y)$çš„ä¸€ä¸ªæ …æ ¼ã€‚ $$\\mathrm{SCA}(Q_p,F_t)=\\frac1{|\\mathcal{V}\\mathrm{hit}|}\\sum{i\\in\\mathcal{V}\\mathrm{hit}}\\sum{j=1}^{N_\\mathrm{ref}}\\mathrm{Deform}\\mathrm{Attn}(Q_p,\\mathcal{P}(p,i,j),F_t^i)\\quad\\quad\\quad\\quad(2)$$ åœ¨DeformAttn()ä¸­ï¼Œ$Q_{p}$ã€$P(p,i,j)$ å’Œ $F_{t}^{i}$ åˆ†åˆ«è¡¨ç¤ºquery, reference pointså’Œè¾“å…¥ç‰¹å¾ã€‚ é€šä¿—ç†è§£å…¬å¼: åœ¨BEV Queryå¯¹åº”çš„å›¾åƒ2D features æœ‰æ•ˆåŒºåŸŸé™„è¿‘è®¡ç®—æ³¨æ„åŠ›ï¼ŒæŠŠå›¾åƒ2D featuresåŠ æƒèåˆåˆ°BEV Queryä½œä¸ºSCAçš„è¾“å‡ºã€‚ å‚è€ƒå›¾(b)å’Œä¸Šè¿°å…¬å¼2ï¼Œæ€»ç»“Spatial cross-attentionçš„å®ç°æ–¹å¼: å¯¹äºæ¯ä¸€ä¸ªä½äº $(x, y)$ ä½ç½®çš„ BEV query $Q_{p}$ ï¼Œè®¡ç®—å…¶å¯¹åº”çœŸå®ä¸–ç•Œçš„åæ ‡ $(x^{â€™},y^{â€™})$ã€‚ç„¶åå°† BEV query åœ¨zæ–¹å‘è¿›è¡Œ lift æ“ä½œï¼Œè®¾ç½® $N_{ref}$ ä¸ª 3Då‚è€ƒç‚¹ï¼Œå³å¯¹åº” $N_{ref}$ ä¸ªä¸–ç•Œåæ ‡ç³»ä¸‹çš„3Dç©ºé—´å‚è€ƒç‚¹ã€‚ é€šè¿‡ç›¸æœºå†…å¤–å‚ï¼ŒæŠŠç¬¬jä¸ª3Då‚è€ƒç‚¹æŠ•å½±åˆ° $v_{hit}$ ä¸ªç›¸æœºå›¾åƒä¸Šã€‚å—ç›¸æœºæ„ŸçŸ¥èŒƒå›´é™åˆ¶ï¼Œæ¯ä¸ª3Då‚è€ƒç‚¹ä¸€èˆ¬åªåœ¨ 1-2 ä¸ªç›¸æœºä¸Šæ‰¾åˆ°æœ‰æ•ˆçš„æŠ•å½±ç‚¹(åè¿‡æ¥æè¿°ï¼Œæ¯ä¸ªç›¸æœºçš„featuresåªä¸éƒ¨åˆ†BEV queriesæ„æˆæœ‰æ•ˆæŠ•å½±å…³ç³»)ã€‚ åŸºäº Deformable Attentionï¼ŒæŠŠåƒå¹³é¢ä¸Šçš„è¿™äº›æŠ•å½±ç‚¹ä½œä¸º2Då›¾åƒå‚è€ƒç‚¹ï¼Œåœ¨å…¶å‘¨å›´å¯¹ $F_{t}^{i}$ è¿›è¡Œç‰¹å¾é‡‡æ ·ï¼Œå¾—åˆ°sampled featuresã€‚ æœ€åï¼Œå¯¹ $V_{hit}$ ã€$N_{ref}$ ä¸ªsampled featuresè¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œä½œä¸ºspatial cross-attentionçš„è¾“å‡ºæ¥æ›´æ–°BEV queryï¼Œä»è€Œå®Œæˆ spatial ç©ºé—´çš„ç‰¹å¾èšåˆã€‚ è¯¦ç»†ä»‹ç»ä¸€ä¸‹ç¬¬2æ­¥ä¸­å¦‚ä½•æŠŠ3Då‚è€ƒç‚¹æŠ•å½±åˆ°ç›¸æœºå›¾åƒä¸Šè·å¾—2Då‚è€ƒç‚¹: é¦–å…ˆè®¡ç®—ä½äº $p = (x, y)$ çš„query $Q_{p}$ åœ¨ä»¥è½¦è¾†ä¸ºä¸­å¿ƒä¸–ç•Œåæ ‡ $(x^{â€™},y^{â€™})$ $$x^{^{\\prime}}=(x-W/2)*s; \\quad y^{^{\\prime}}=(y-{H}/2)*s$$ å…¶ä¸­Hå’ŒWæ˜¯BEV queriesçš„å°ºå¯¸ï¼Œsæ˜¯BEVä¸­ä¸€ä¸ªæ …æ ¼æ‰€ä»£è¡¨çš„ç‰©ç†ç©ºé—´å°ºå¯¸; è®¡ç®—ç¬¬jä¸ª3Då‚è€ƒç‚¹æŠ•å½±åˆ°ç¬¬iä¸ªç›¸æœºå›¾åƒä¸Šçš„2Då‚è€ƒç‚¹åæ ‡: $$P(p,i,j)=(x_{i,j},y_{i,j})$$ å…¶ä¸­ï¼Œ $$z_{i,j}[x_{i,j},y_{i,j},1]^T=T_i*[x^{â€™},y^{â€™},z^{â€™},1]^T$$ $T_i$ æ˜¯ç¬¬ $i$ ä¸ªç›¸æœºçš„æŠ•å½±çŸ©é˜µã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:2:3","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"2.4 TSA: Temporal self-attention ä»ç»å…¸ RNN ç½‘ç»œè·å¾—å¯å‘ï¼Œå°† BEV ç‰¹å¾ $B_t$ è§†ä¸ºèƒ½å¤Ÿä¼ é€’åºåˆ—ä¿¡æ¯çš„ memoryã€‚æ¯ä¸€æ—¶åˆ»ç”Ÿæˆçš„ BEV ç‰¹å¾ $B_t$ éƒ½ä»ä¸Šä¸€æ—¶åˆ»çš„ BEV ç‰¹å¾ $B_{t-1}$ è·å–æ‰€éœ€çš„æ—¶åºä¿¡æ¯ï¼Œè¿™æ ·èƒ½ä¿è¯åŠ¨æ€åœ°è·å–æ‰€éœ€çš„æ—¶åºç‰¹å¾ï¼Œè€Œéåƒå †å ä¸åŒæ—¶åˆ» BEV ç‰¹å¾é‚£æ ·åªèƒ½è·å–å®šé•¿çš„æ—¶åºä¿¡æ¯ã€‚ $$\\text{TSA}(Q_p,{Q,Bâ€™{t-1}})=\\sum{V\\in{Q,Bâ€™_{t-1}}}\\text{DeformAttn}(Q_p,p,V),\\quad(5)$$ å‚è€ƒå›¾4å’Œä¸Šè¿°å…¬å¼5ï¼Œæ€»ç»“temporal self-attentionçš„å®ç°æ–¹æ³•: ç»™å®št-1æ—¶åˆ»çš„ BEV ç‰¹å¾ $B_{t-1}$ ï¼Œå…ˆæ ¹æ® ego motion å°† $B_{t-1}$ å¯¹é½åˆ° $t$ æ—¶åˆ»ï¼Œæ¥ç¡®ä¿ $B_{t-1}$ å’Œ $B_{t}$ åœ¨ç›¸åŒindexä½ç½®çš„æ …æ ¼å¯¹åº”äºç°å®ä¸–ç•Œçš„åŒä¸€ä½ç½®ï¼ŒæŠŠæ—¶é—´å¯¹é½åçš„BEVç‰¹å¾è®°ä½œ $B_{t-1}^{â€™}$ ã€‚ $t$ æ—¶åˆ»ä½äº $(x, y)$ å¤„çš„ BEV queryæ‰€è¡¨å¾çš„ç‰©ä½“å¯èƒ½é™æ€æˆ–è€…åŠ¨æ€ï¼Œå®ƒåœ¨t-1æ—¶åˆ»ä¼šå‡ºç°åœ¨ $B_{t-1}^{â€™}$ çš„ $(x, y)$ å‘¨å›´ï¼Œå› æ­¤åˆ©ç”¨ deformable attention ä»¥ $(x, y)$ ä½œä¸ºå‚è€ƒç‚¹åœ¨å…¶å‘¨å›´è¿›è¡Œç‰¹å¾é‡‡æ ·ã€‚ ä¸Šè¿°æ–¹æ³•æ²¡æœ‰æ˜¾å¼åœ°è®¾è®¡é—å¿˜é—¨ï¼Œè€Œæ˜¯é€šè¿‡ attention æœºåˆ¶ä¸­çš„ attention weights æ¥å¹³è¡¡å†å²æ—¶åºç‰¹å¾å’Œå½“å‰ BEV ç‰¹å¾çš„èåˆè¿‡ç¨‹ã€‚ å…³äºTSAçš„åè®°: BEVFormer V2å¯¹ BEVFormerçš„æ—¶åŸŸèåˆæ–¹æ³•TSAåšäº†ä¿®æ”¹ã€‚ BEVFormerä¸­TSAé‡‡ç”¨äº†ç»§æ‰¿å¼çš„æ—¶åŸŸä¿¡æ¯èåˆæ–¹å¼: åˆ©ç”¨attentionæœºåˆ¶åœ¨tæ—¶åˆ»èåˆäº†t-1æ—¶åˆ»çš„BEV featuresä¿¡æ¯ï¼Œç”±äºt-1æ—¶åˆ»çš„BEV features ä¹Ÿèåˆäº†æ›´æ—©æ—¶åˆ»(t-2)çš„ä¿¡æ¯ï¼Œå› æ­¤tæ—¶åˆ»BEV featuresé—´æ¥åœ°èåˆäº†æ¯”t-1æ—¶åˆ»æ›´æ—©çš„ä¿¡æ¯ã€‚ ä½†æ˜¯è¿™ç§ç»§æ‰¿å¼æ—¶åŸŸèåˆæ–¹å¼æœ‰é—å¿˜çš„ç‰¹ç‚¹ï¼Œå³ä¸èƒ½æœ‰æ•ˆåˆ©ç”¨è¾ƒé•¿æ—¶é—´çš„å†å²ä¿¡æ¯ã€‚ BEVFormer V2æŠŠæ—¶åŸŸèåˆæ”¹æˆäº†: æ ¹æ®ego motionï¼ŒæŠŠè¿‡å»å¤šä¸ªæ—¶åˆ»çš„BEV features å¯¹é½åˆ°å½“å‰æ—¶åˆ»ï¼Œç„¶ååœ¨channel ç»´åº¦æŠŠè¿™äº›å¯¹é½åçš„BEV features ä¸å½“å‰æ—¶åˆ»BEV featuresä¸²è”ï¼Œç„¶åç”¨Residual æ¨¡å—é™ä½channelæ•°ï¼Œå°±å®Œæˆäº†æ—¶åŸŸèåˆã€‚ ç»¼åˆ2.3å’Œ2.4èŠ‚ï¼Œè§‚å¯Ÿ6ä¸ª BEVFormer Encoder Layersçš„å®Œæ•´ç»“æ„ä¼šå‘ç°ï¼Œ BEV query æ—¢èƒ½é€šè¿‡ spatial cross-attention èšåˆç©ºé—´ç‰¹å¾ï¼Œåˆèƒ½é€šè¿‡ temporal self-attention èšåˆæ—¶åºç‰¹å¾ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šé‡å¤å¤šæ¬¡ï¼Œè®©æ—¶ç©ºç‰¹å¾èåˆèƒ½å¤Ÿç›¸äº’ä¿ƒè¿›ï¼Œæœ€ç»ˆå¾—åˆ°æ›´å¥½çš„èåˆBEV featuresã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:2:4","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"2.5 Application of BEV Features BEV Features $B_{t}\\in R^{H\\times W\\times C}$ æ˜¯å¯ç”¨äºå¤šç§è‡ªåŠ¨é©¾é©¶æ„ŸçŸ¥ä»»åŠ¡çš„2D feature mapï¼Œ åŸºäº2D æ„ŸçŸ¥æ–¹æ³•ç¨åŠ æ”¹åŠ¨å°±å¯åœ¨ $B_t$ ä¸Šå¼€å‘3Dç›®æ ‡æ£€æµ‹å’Œmap segmentationä»»åŠ¡ã€‚ 3D object detection å‚è€ƒ2D ç›®æ ‡æ£€æµ‹å™¨Deformable DETRï¼Œè®ºæ–‡è®¾è®¡äº†end-to-endçš„3Dç›®æ ‡æ£€æµ‹headï¼Œä¿®æ”¹éƒ¨åˆ†åŒ…æ‹¬: ç”¨single-scale çš„BEV features $B_t$ ä½œä¸ºæ£€æµ‹å¤´çš„è¾“å…¥ï¼Œé¢„æµ‹è¾“å‡º3D b-boxeså’Œé€Ÿåº¦è€Œä¸æ˜¯2D b-boxesï¼Œä»…ç”¨ $L_1$ lossç›‘ç£3D b-boxesçš„å›å½’ã€‚ç»§æ‰¿DETRæ–¹æ³•çš„ä¼˜åŠ¿ï¼Œé¢„æµ‹æœ‰é™æ•°ç›®çš„å€™é€‰ç›®æ ‡é›†åˆ(å¼€æºå·¥ç¨‹ä¸­è®¾ä¸º300ä¸ª)ï¼Œè¿™ç§end-to-endçš„æ£€æµ‹å¤´ä¸éœ€è¦NMSåå¤„ç†ã€‚ map segmentation å‚è€ƒ2D segmentation æ–¹æ³•Panoptic SegFormerï¼Œè®ºæ–‡è®¾è®¡äº†map segmentation headã€‚å› ä¸ºåŸºäºBEVçš„map segmentationåŸºæœ¬ä¸Šä¸å¸¸è§è¯­ä¹‰åˆ†å‰²ç›¸åŒï¼Œä½œè€…åˆ©ç”¨äº†å‚è€ƒæ–‡ç« [22]ä¸­çš„mask decoderå’Œclass-fixed queriesè®¾è®¡headæ¥æŸ¥æ‰¾æ¯ä¸ªè¯­ä¹‰ç±»åˆ«ï¼ŒåŒ…æ‹¬carã€vehicleã€road(å¯é€šè¡ŒåŒºåŸŸ)å’Œè½¦é“çº¿ã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:2:5","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"2.6 Implementation details è®­ç»ƒæ—¶çš„å®æ–½ç»†èŠ‚: å¯¹äºæ—¶é—´tï¼Œåœ¨è¿‡å»2sä¸­éšæœºé€‰å–3ä¸ªæ—¶åˆ»t-3ã€t-2å’Œt-1ï¼› åœ¨åˆå§‹3ä¸ªæ—¶åˆ»ï¼Œå¾ªç¯ç”ŸæˆBEV features ${B_{t-3},B_{t-2},B_{t-1}}$ï¼Œä¸”åœ¨æ­¤é˜¶æ®µä¸è®¡ç®—æ¢¯åº¦ï¼› è®¡ç®—ç¬¬ä¸€ä¸ªæ—¶åˆ»t-3çš„temporal self-attentionè¾“å‡ºæ—¶ï¼Œå®ƒå¹¶æ²¡æœ‰å‰åºBEV featuresï¼Œå°±ç”¨å®ƒè‡ªèº«ä½œä¸ºå‰åºæ—¶åˆ»è¾“å…¥ï¼Œé‚£ä¹ˆtemporal self-attentionæš‚æ—¶é€€åŒ–æˆäº†self-attentionã€‚ inferenceæ—¶çš„å®æ–½ç»†èŠ‚: æŒ‰ç…§æ—¶é—´é¡ºåºè®¡ç®—å›¾åƒåºåˆ—ä¸­çš„æ¯ä¸€å¸§ï¼Œå‰åºæ—¶åˆ»çš„BEV featuresè¢«ä¿æŒä¸‹æ¥å¹¶ç”¨äºåä¸€æ—¶åˆ»ï¼Œè¿™ç§onlineçš„inferenceç­–ç•¥åœ¨åº”ç”¨ä¸­æ¯”è¾ƒé«˜æ•ˆã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:2:6","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"3. Experiments ","date":"2023-09-03","objectID":"/posts/bevformer/:3:0","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"3.1 experimental settings é‡‡ç”¨ä¸¤ç§Backbone: ResNet101-DCNï¼Œé‡‡ç”¨æ¥è‡ªFCOS3Dè®­ç»ƒå¾—åˆ°çš„å‚æ•°ï¼›VoVnet-99ï¼Œé‡‡ç”¨æ¥è‡ªDD3Dè®­ç»ƒå¾—åˆ°çš„å‚æ•°ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨FPNè¾“å‡ºçš„å¤šå°ºåº¦ featuresçš„å°ºå¯¸åŒ…å«1/16ï¼Œ1/32ï¼Œ1/64(æ³¨æ„ï¼Œä»£ç ä¸­å®é™…ç”¨å¥½çš„1/8å°ºå¯¸çš„featuresï¼Œå³nuScenesä¸­çš„116*200çš„FPNè¾“å‡º)ï¼ŒåŒæ—¶æŠŠdimension Cè®¾ä¸º256ã€‚ åœ¨nuScenesæ•°æ®é›†è¯•éªŒä¸­ï¼ŒBEV querieså°ºå¯¸è®¾ä¸º200x200ï¼Œå¯¹åº”æ„Ÿxå’Œyæ–¹å‘çš„çŸ¥èŒƒå›´éƒ½æ˜¯[-51.2m, 51.2m]ï¼Œå¯¹åº”BEV Gridå°ºå¯¸ç²¾åº¦æ˜¯0.512mã€‚ åœ¨Waymoæ•°æ®é›†è¯•éªŒä¸­ï¼ŒBEV querieså°ºå¯¸è®¾ä¸º300x220ï¼Œå¯¹åº”æ„Ÿxæ–¹å‘çš„æ„ŸçŸ¥èŒƒå›´æ˜¯[-35.0m, 75.0m]ï¼Œyæ–¹å‘çš„çŸ¥èŒƒå›´æ˜¯[-75.0m, 75.0m]ï¼Œå¯¹åº”BEV Gridå°ºå¯¸ç²¾åº¦æ˜¯0.5mã€‚è‡ªè½¦ä¸­å¿ƒä½äº BEVçš„(70ï¼Œ150)å¤„ã€‚ å¯¹æ¯ä¸ªBEV queryï¼Œåœ¨ spatial cross-attentionæ¨¡å—ä¸­ï¼Œè®¾ç½® $N_{ref}=4$ ä¸ª3Då‚è€ƒç‚¹ï¼Œé¢„å®šä¹‰å®ƒä»¬å¯¹åº”çš„é«˜åº¦èŒƒå›´æ˜¯-5måˆ°3mã€‚ å¯¹æ¯ä¸ª2Då›¾åƒå‚è€ƒç‚¹(3Då‚è€ƒç‚¹æŠ•å½±åˆ°2D viewä¸Šçš„ç‚¹)ï¼Œåœ¨å…¶å‘¨å›´é€‰å–4ä¸ªé‡‡æ ·ç‚¹é€å…¥SCAã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè®­ç»ƒ24epochesï¼Œå­¦ä¹ ç‡è®¾ä¸º $12\\times10^{-4}$ã€‚ Baselines: ä¸ºäº†åˆç†è¯„ä¼°task headsçš„å½±å“ï¼Œå…¬å¹³åœ°ä¸å…¶å®ƒç”ŸæˆBEVæ–¹æ³•å¯¹æ¯”ã€‚é€‰æ‹©VPNå’ŒLift-Splatä½œä¸ºbaselinesï¼Œå¯¹å®ƒä»¬headä¹‹å‰çš„éƒ¨åˆ†æ›¿æ¢BEVFormerï¼Œä¿ç•™task headså’Œå…¶å®ƒè®¾ç½®ã€‚ è®ºæ–‡ä¸­ï¼Œé€šè¿‡æŠŠtemporal self-attentionä¿®æ”¹ä¸ºæ™®é€šçš„self-attentionï¼Œè¿™æ ·å°±ä½¿BEVFormerå˜æˆäº†ä¸€ä¸ªé™æ€æ¨¡å‹ï¼Œå‘½åä¸ºBEVFormer-Sï¼Œå®ƒä¸ä½¿ç”¨å†å²BEV Featuresã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:3:1","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"3.2 3Dç›®æ ‡æ£€æµ‹ç»“æœ BEVFormerçš„3Dæ£€æµ‹æ€§èƒ½ï¼Œå¦‚Table1ã€Table2å’ŒTable3æ‰€ç¤ºï¼Œè¿œè¶…ä¹‹å‰æœ€ä¼˜æ–¹æ³•DETR3Dã€‚ BEVFormerå¼•å…¥äº†temporal informationï¼Œå› æ­¤å®ƒåœ¨ä¼°è®¡ç›®æ ‡é€Ÿåº¦æ–¹é¢æ•ˆæœä¹Ÿå¾ˆå¥½ã€‚ä»é€Ÿåº¦ä¼°è®¡æŒ‡æ ‡mean Average Velocity (mAVE)æ¥çœ‹ï¼ŒBEVFormerè¯¯å·®ä¸º0.378m/sï¼Œæ•ˆæœè¿œå¥½äºåŒç±»åŸºäºç›¸æœºçš„æ–¹æ³•ï¼Œç”šè‡³é€¼è¿‘äº†åŸºäºæ¿€å…‰çš„æ–¹æ³•ã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:3:2","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"3.3 multi-tasks perception results è”åˆè®­ç»ƒ3D detectionå’Œmap segmentationä»»åŠ¡ï¼Œä¸å•ç‹¬è®­ç»ƒæ¯”è¾ƒè®­ç»ƒæ•ˆæœï¼Œå¦‚Table4æ‰€ç¤º: å¯¹3Dç›®æ ‡æ£€æµ‹å’Œåˆ†å‰²ä¸­çš„è½¦è¾†ç±»è¯­ä¹‰æ„ŸçŸ¥ï¼Œè”åˆè®­ç»ƒæ•ˆæœæœ‰æå‡ï¼›å¯¹åˆ†å‰²ä¸­çš„roadã€laneç±»çš„è¯­ä¹‰æ„ŸçŸ¥ï¼Œè”åˆè®­ç»ƒæ•ˆæœåè€Œä¼šä¸‹é™ã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:3:3","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"3.4 æ¶ˆèè¯•éªŒ Spatial Cross-attentionæœ‰æ•ˆæ€§ ä¸ºäº†éªŒè¯SCAçš„æœ‰æ•ˆæ€§ï¼Œåˆ©ç”¨ä¸åŒ…å«TSAçš„BEVFormer-Sæ¥è®¾è®¡æ¶ˆèè¯•éªŒï¼Œç»“æœå¦‚Table5æ‰€ç¤ºã€‚ é»˜è®¤çš„SCAåŸºäºdeformable attentionï¼Œåœ¨å¯¹æ¯”è¯•éªŒä¸­æ„å»ºäº†åŸºäº2ç§ä¸åŒattentionæœºåˆ¶çš„baselines: 1. ç”¨global attentionå–ä»£deformable attentionï¼›2. è®©æ¯ä¸ªqueryä»…ä¸å®ƒçš„å›¾åƒå‚è€ƒç‚¹äº¤äº’ï¼Œè€Œä¸æ˜¯åƒSCAé‚£æ ·queryä¸å›¾åƒå‚è€ƒç‚¹å‘¨å›´åŒºåŸŸäº¤äº’ã€‚ä¸ºäº†æ‰©å¤§å¯¹æ¯”èŒƒå›´ï¼ŒæŠŠBEVFormerä¸­çš„BEVç”Ÿæˆæ–¹æ³•æ›¿æ¢ä¸ºäº†VPNå’ŒLift-Spaltä¸­çš„æ–¹æ³•ã€‚ä»Table5ç»“æœå¯è§Deformable Attentionæ–¹æ³•æ˜¾è‘—ä¼˜äºå…¶å®ƒæ–¹æ³•ï¼Œä¸”åœ¨GPU Memoryä½¿ç”¨é‡å’Œqueryå…´è¶£åŒºåŸŸå¤§å°ä¹‹é—´å®ç°äº†balanceã€‚ Temporal Self-attentionæœ‰æ•ˆæ€§ ä»Table1å’ŒTable4å¯è§ï¼Œåœ¨ç›¸åŒçš„è®¾ç½®ä¸‹ï¼ŒBEVFormerç›¸æ¯”äºBEVFormer-Sçš„æ€§èƒ½å¤§å¹…æå‡ï¼Œé’ˆå¯¹æœ‰æŒ‘æˆ˜æ€§çš„æ£€æµ‹ä»»åŠ¡æå‡æ›´æ˜æ˜¾ã€‚TSAä¸»è¦æ˜¯åœ¨ä»¥ä¸‹æ–¹é¢å½±å“æ€§èƒ½æå‡çš„: 1.temporal informationçš„å¼•å…¥å¯¹æé«˜ç›®æ ‡é€Ÿåº¦ä¼°è®¡ç²¾åº¦éå¸¸æœ‰ç›Šï¼›2.åˆ©ç”¨temporal informationï¼Œç›®æ ‡é¢„æµ‹çš„locationå’Œorientationsæ›´ç²¾ç¡®ï¼›3.å—ç›Šäºtemporal informationåŒ…å«è¿‡å»æ—¶åˆ»objectçš„ä¿¡æ¯ï¼Œå¦‚å›¾4æ‰€ç¤ºï¼Œä¸¥é‡é®æŒ¡ç›®æ ‡çš„recall æ›´é«˜ã€‚æ ¹æ®nuScenesæ ‡æ³¨çš„é®æŒ¡ç¨‹åº¦æŠŠéªŒè¯æ•°æ®é›†è¿›è¡Œåˆ’åˆ†æˆ4éƒ¨åˆ†ï¼Œæ¥è¯„ä¼°BEVFormerå¯¹å„ç§ç¨‹åº¦é®æŒ¡çš„æ€§èƒ½ï¼Œé’ˆå¯¹æ¯ä¸ªæ•°æ®å­é›†éƒ½ä¼šè®¡ç®—average recall(åŒ¹é…æ—¶æŠŠä¸­å¿ƒè·ç¦»çš„é˜ˆå€¼è®¾ä¸º2m)ã€‚ Model Scale and Latency é’ˆå¯¹ä¸åŒScale Settingsçš„BEVFormerï¼Œå¯¹æ¯”æ£€æµ‹æ€§èƒ½å’Œlatencyï¼Œç»“æœå¦‚Table6æ‰€ç¤ºã€‚åœ¨3æ–¹é¢è¿›è¡ŒBEVFormerçš„Scaleé…ç½®: 1. è¾“å…¥åˆ°BEVFormer Encoderçš„featuresæ˜¯multi-scaleè¿˜æ˜¯single-scaleï¼›2.BEV Queries/featuresçš„å°ºå¯¸ï¼›3. encoder layeræ•°ç›®ã€‚ ä»å®éªŒç»“æœçœ‹æ¥: Backboneçš„Latencyè¿œå¤§äºBEVFormerï¼Œå› æ­¤Latencyä¼˜åŒ–çš„ä¸»è¦ç“¶é¢ˆåœ¨äºBackboneè€Œä¸æ˜¯BEVFormer(è¿™é‡ŒæŒ‡BEVFormer Encoderéƒ¨åˆ†)ï¼ŒBEVFormerå¯ä»¥é‡‡ç”¨ä¸åŒçš„Scaleï¼Œå…·å¤‡æ”¯æŒçµæ´»å¹³è¡¡æ€§èƒ½å’Œefficiencyçš„ç‰¹æ€§ã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:3:4","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"4. Discussion ç†è®ºä¸Šè§†è§‰å›¾åƒçš„æ•°æ®æ¯”æ¿€å…‰æ•°æ®ç¨ å¯†ï¼Œä½†åŸºäºè§†è§‰çš„BEVæ•ˆæœè¿˜æ˜¯æ¯”åŸºäºæ¿€å…‰çš„æ–¹æ³•æ€§èƒ½å·®ï¼Œé‚£ä¹ˆä¹Ÿè¯´æ˜äº†ç†è®ºä¸Šè§†è§‰è¿˜æœ‰å¯æå‡ç©ºé—´ã€‚ BEV Featuresèƒ½ç”¨äºæ³Šè½¦ä½æ£€æµ‹ä¹ˆï¼Ÿ å¯èƒ½å¯ä»¥ç”¨BEVFormeråœ¨ç¯è§†é±¼çœ¼ç›¸æœºä¸Šç”ŸæˆBEV featuresï¼Œç”¨äºæ³Šè½¦ä½æ£€æµ‹æˆ–è¿‘è·ç¦»ç›®æ ‡çš„ç²¾ç¡®æ£€æµ‹ã€‚ æ˜¾æ€§åœ°å¼•å…¥BEV ç‰¹å¾ï¼Œé™åˆ¶äº†æœ€å¤§æ£€æµ‹è·ç¦»ï¼Œåœ¨é«˜é€Ÿå…¬è·¯åœºæ™¯ï¼Œæ£€æµ‹è¿œå¤„ç›®æ ‡éå¸¸é‡è¦ï¼Œå¦‚ä½•æƒè¡¡BEVçš„å¤§å°ä¸æ£€æµ‹è·ç¦»æ˜¯ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚ å¦‚ä½•åœ¨æ£€æµ‹ç²¾åº¦å’Œgridå¤§å°ä¹‹é—´åšå¹³è¡¡æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ é’ˆå¯¹2ã€3é—®é¢˜çš„ä¸€ä¸ªä¼˜åŒ–æ–¹å‘: è®¾è®¡è‡ªé€‚åº”å°ºå¯¸çš„BEVç‰¹å¾ã€‚è¿™é‡Œçš„è‡ªé€‚åº”æ˜¯æŒ‡æ ¹æ®åœºæ™¯æ¥è°ƒæ•´BEVå°ºå¯¸æˆ–ç²¾åº¦ã€‚ ","date":"2023-09-03","objectID":"/posts/bevformer/:4:0","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"5. References è®ºæ–‡: ã€ŠBEVFormer: Learning Birdâ€™s-Eye-View Representation from Multi-Camera Images via Spatiotemporal Transformersã€‹ å¼€æºå·¥ç¨‹: https://github.com/zhiqi-li/BEVFormer å‚è€ƒä¸­æ–‡è§£è¯» ä½¿ç”¨Transformerèåˆæ—¶ç©ºä¿¡æ¯çš„è‡ªåŠ¨é©¾é©¶æ„ŸçŸ¥æ¡†æ¶ 3d camera-only detection: BEVFormer BEVFormerï¼Œé€šè¿‡ä¸€ä¸ªæ—¶ç©ºTransformerå­¦ä¹  BEVè¡¨å¾ ç±»ä¼¼å·¥ä½œ: Cross-view Transformers for real-time Map-view Semantic Segmentation è®ºæ–‡: https://arxiv.org/pdf/2205.02833v1.pdf ä»£ç : https://github.com/bradyz/cross REF: [1]. ä¸€æ–‡è¯»æ‡‚BEVFormerè®ºæ–‡ https://zhuanlan.zhihu.com/p/543335939 https://zhuanlan.zhihu.com/p/629792598 ","date":"2023-09-03","objectID":"/posts/bevformer/:5:0","tags":["Robotics"],"title":"BEVFormer è®ºæ–‡è§£è¯»","uri":"/posts/bevformer/"},{"categories":["AutonomousDriving","Perception"],"content":"è¿‘å¹´æ¥ï¼ŒåŸºäºé¸Ÿç°å›¾(BEV)è¡¨ç¤ºçš„æ„ŸçŸ¥ä»»åŠ¡è¶Šæ¥è¶Šå—åˆ°å…³æ³¨ï¼ŒBEVè¡¨ç¤ºæœ‰æœ›æˆä¸ºä¸‹ä¸€ä»£è‡ªåŠ¨é©¾é©¶è½¦è¾†(AV)æ„ŸçŸ¥çš„åŸºç¡€ã€‚ç°æœ‰å¤§å¤šæ•°çš„BEVè§£å†³æ–¹æ¡ˆè¦ä¹ˆéœ€è¦å¤§é‡èµ„æºæ¥æ‰§è¡Œè½¦è½½æ¨ç†ï¼Œè¦ä¹ˆæ€§èƒ½ä¸ä½³ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ¡†æ¶ï¼Œç§°ä¸ºFast BEVï¼Œå®ƒèƒ½å¤Ÿåœ¨è½¦è½½èŠ¯ç‰‡ä¸Šæ‰§è¡Œæ›´å¿«çš„BEVæ„ŸçŸ¥ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œä½œè€…é¦–å…ˆä»ç»éªŒä¸Šå‘ç°ï¼ŒBEVè¡¨ç¤ºå¯ä»¥è¶³å¤Ÿå¼ºå¤§ï¼Œè€Œæ— éœ€æ˜‚è´µçš„åŸºäºtransformerçš„å˜æ¢æˆ–æ·±åº¦è¡¨ç¤ºã€‚Fast BEVç”±äº”ä¸ªéƒ¨åˆ†ç»„æˆï¼Œè®ºæ–‡æ–°é¢–åœ°æå‡ºï¼š (1)ä¸€ç§è½»é‡çº§çš„ã€æ˜“äºéƒ¨ç½²çš„è§†å›¾è½¬æ¢ï¼Œå®ƒå°†2Då›¾åƒç‰¹å¾å¿«é€Ÿä¼ è¾“åˆ°3Dä½“ç´ ç©ºé—´; (2)ä¸€ç§åˆ©ç”¨å¤šå°ºåº¦ä¿¡æ¯è·å¾—æ›´å¥½æ€§èƒ½çš„å¤šå°ºåº¦å›¾åƒç¼–ç å™¨; (3)ä¸€ç§é«˜æ•ˆçš„BEVç¼–ç å™¨ï¼Œå®ƒä¸“é—¨è®¾è®¡ç”¨äºåŠ å¿«è½¦è½½æ¨ç†; (4)é’ˆå¯¹å›¾åƒå’ŒBEVç©ºé—´çš„å¼ºå¤§æ•°æ®å¢å¼ºç­–ç•¥ä»¥é¿å…è¿‡åº¦æ‹Ÿåˆ; (5)åˆ©ç”¨æ—¶é—´ä¿¡æ¯çš„å¤šå¸§ç‰¹å¾èåˆæœºåˆ¶ã€‚ å…¶ä¸­ï¼Œ(1)å’Œ(3)ä½¿Fast BEVèƒ½å¤Ÿåœ¨è½¦è½½èŠ¯ç‰‡ä¸Šå¿«é€Ÿæ¨ç†å’Œéƒ¨ç½²ï¼Œ(2)ã€(4)å’Œ(5)ç¡®ä¿Fast BEVå…·æœ‰ç«äº‰æ€§èƒ½ã€‚æ‰€æœ‰è¿™äº›éƒ½ä½¿Fast BEVæˆä¸ºä¸€ç§å…·æœ‰é«˜æ€§èƒ½ã€å¿«é€Ÿæ¨ç†é€Ÿåº¦å’Œåœ¨è‡ªåŠ¨é©¾é©¶è½¦è½½èŠ¯ç‰‡ä¸Šéƒ¨ç½²å‹å¥½çš„è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡å®éªŒï¼Œåœ¨2080Tiå¹³å°ä¸Šï¼ŒR50æ¨¡å‹å¯ä»¥åœ¨nuSceneséªŒè¯é›†ä¸Šä»¥47.3%çš„NDSè¿è¡Œ52.6 FPSï¼Œè¶…è¿‡äº†BEVDepth-R50æ¨¡å‹çš„41.3 FPSå’Œ47.5%çš„NDSï¼Œä»¥åŠBEVDet4DR50æ¨¡å‹çš„30.2 FPSå’Œ45.7%çš„NDSã€‚æœ€å¤§çš„å‹å·(R101@900x1600)åœ¨nuSceneséªŒè¯é›†ä¸Šå»ºç«‹äº†å…·æœ‰ç«äº‰åŠ›çš„53.5%NDSï¼Œè®ºæ–‡åœ¨å½“å‰ä¸»æµçš„è½¦è½½èŠ¯ç‰‡ä¸Šè¿›ä¸€æ­¥å¼€å‘äº†å…·æœ‰ç›¸å½“é«˜ç²¾åº¦å’Œæ•ˆç‡çš„åŸºå‡†ï¼ ","date":"2023-09-02","objectID":"/posts/fastbev/:0:0","tags":["Robotics"],"title":"FastBEV:å¿«é€Ÿè€Œå¼ºå¤§çš„BEVæ„ŸçŸ¥åŸºçº¿","uri":"/posts/fastbev/"},{"categories":["AutonomousDriving","Perception"],"content":"é¢†åŸŸç°çŠ¶ å¿«é€Ÿå‡†ç¡®çš„3Dæ„ŸçŸ¥ç³»ç»Ÿå¯¹äºè‡ªåŠ¨é©¾é©¶è‡³å…³é‡è¦ã€‚ç»å…¸æ–¹æ³•ä¾èµ–äºæ¿€å…‰é›·è¾¾ç‚¹äº‘æä¾›çš„ç²¾ç¡®3Dä¿¡æ¯ã€‚ç„¶è€Œï¼Œæ¿€å…‰é›·è¾¾ä¼ æ„Ÿå™¨é€šå¸¸è¦èŠ±è´¹æ•°åƒç¾å…ƒï¼Œé˜»ç¢äº†å®ƒä»¬åœ¨ç»æµå‹è½¦è¾†ä¸Šçš„åº”ç”¨ã€‚åŸºäºçº¯ç›¸æœºçš„é¸Ÿç°å›¾(BEV)æ–¹æ³•æœ€è¿‘æ˜¾ç¤ºå‡ºå…¶å¼ºå¤§çš„3Dæ„ŸçŸ¥èƒ½åŠ›å’Œä½æˆæœ¬çš„å·¨å¤§æ½œåŠ›ã€‚å®ƒä»¬åŸºæœ¬ä¸Šéµå¾ªè¿™æ ·çš„èŒƒå¼ï¼šå°†å¤šæ‘„åƒæœº2Då›¾åƒç‰¹å¾è½¬æ¢ä¸ºè‡ªæˆ‘æ±½è½¦åæ ‡ä¸­çš„3D BEVç‰¹å¾ï¼Œç„¶åå°†ç‰¹å®šå¤´éƒ¨åº”ç”¨äºç»Ÿä¸€BEVè¡¨ç¤ºä»¥æ‰§è¡Œç‰¹å®šçš„3Dä»»åŠ¡ï¼Œä¾‹å¦‚ï¼Œ3Dæ£€æµ‹ã€åˆ†å‰²ç­‰ã€‚ç»Ÿä¸€BEVè¡¨è¾¾å¯ä»¥å•ç‹¬å¤„ç†å•ä¸ªä»»åŠ¡æˆ–åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œè¿™æ˜¯é«˜æ•ˆå’Œçµæ´»çš„ã€‚ ä¸ºäº†ä»2Då›¾åƒç‰¹å¾æ‰§è¡Œ3Dæ„ŸçŸ¥ï¼ŒnuScenesä¸Šçš„ç°æœ‰BEVæ–¹æ³•ä½¿ç”¨åŸºäºæŸ¥è¯¢çš„transformation [17]ï¼Œ[18]æˆ–åŸºäºéšå¼/æ˜¾å¼æ·±åº¦çš„transformation [13]ï¼Œ[15]ï¼Œ[26]ã€‚ç„¶è€Œï¼Œå®ƒä»¬å¾ˆéš¾éƒ¨ç½²åœ¨è½¦è½½èŠ¯ç‰‡ä¸Šï¼Œå¹¶ä¸”æ¨ç†é€Ÿåº¦æ…¢ï¼š (1) åŸºäºåŸºäºæŸ¥è¯¢çš„transformation æ–¹æ³•å¦‚å›¾1(a)æ‰€ç¤ºï¼Œç”±äºè§£ç å™¨éœ€è¦transformerå†…çš„æ³¨æ„æœºåˆ¶ï¼Œè¿™äº›æ–¹æ³•é€šå¸¸éœ€è¦ä¸“ç”¨èŠ¯ç‰‡æ¥æ”¯æŒã€‚ (2) åŸºäºæ·±åº¦å˜æ¢çš„æ–¹æ³•å¦‚å›¾1(b)æ‰€ç¤ºã€‚ è¿™äº›æ–¹æ³•é€šå¸¸éœ€è¦åŠ é€Ÿä¸å‹å¥½çš„ä½“ç´ æ± æ“ä½œï¼Œç”šè‡³å¤šçº¿ç¨‹CUDAå†…æ ¸ä¹Ÿå¯èƒ½ä¸æ˜¯æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚æ­¤å¤–ï¼Œè¿™å¯¹äºåœ¨èµ„æºå—é™æˆ–CUDAåŠ é€Ÿæ¨ç†åº“ä¸æ”¯æŒçš„èŠ¯ç‰‡ä¸Šè¿è¡Œæ˜¯ä¸æ–¹ä¾¿çš„ã€‚æ­¤å¤–ï¼Œå®ƒä»¬åœ¨æ¨ç†ä¸Šå¾ˆè€—æ—¶ï¼Œè¿™å¦¨ç¢äº†å®ƒä»¬çš„å®é™…éƒ¨ç½²ã€‚æœ¬æ–‡æ—¨åœ¨ä¸ºè½¦è½½èŠ¯ç‰‡è®¾è®¡ä¸€ç§å…·æœ‰å‹å¥½éƒ¨ç½²ã€é«˜æ¨ç†é€Ÿåº¦å’Œç«äº‰æ€§èƒ½çš„BEVæ„ŸçŸ¥æ¡†æ¶ï¼Œä¾‹å¦‚Xavierã€Orinã€Tesla T4ç­‰ã€‚ åŸºäºè¿™äº›è§‚å¯Ÿç»“æœï¼Œéµå¾ªM2BEV[16]çš„åŸç†ï¼Œè¯¥åŸç†å‡è®¾åœ¨å›¾åƒåˆ°BEV(2Dåˆ°3D)è§†å›¾è½¬æ¢æœŸé—´æ²¿ç›¸æœºå…‰çº¿çš„æ·±åº¦åˆ†å¸ƒå‡åŒ€ï¼Œæˆ‘ä»¬æå‡ºFast-Rayè½¬æ¢ï¼Œå¦‚å›¾1(c)æ‰€ç¤ºï¼Œå€ŸåŠ©äºâ€œæŸ¥æ‰¾è¡¨â€å’Œâ€œå¤šè§†å›¾åˆ°ä¸€ä¸ªä½“ç´ â€æ“ä½œï¼Œå°†BEVè½¬æ¢åŠ é€Ÿåˆ°ä¸€ä¸ªæ–°çš„æ°´å¹³ã€‚åŸºäºFast Rayå˜æ¢ï¼Œè®ºæ–‡è¿›ä¸€æ­¥æå‡ºäº†Fast BEVï¼Œè¿™æ˜¯ä¸€ç§æ›´å¿«ã€æ›´å¼ºçš„å…¨å·ç§¯BEVæ„ŸçŸ¥æ¡†æ¶ï¼Œæ— éœ€æ˜‚è´µçš„è§†å›¾transformer[17]ã€[18]æˆ–æ·±åº¦è¡¨ç¤º[15]ã€[23]ã€[26]ã€‚æ‰€æå‡ºçš„å¿«é€ŸBEVåŒ…æ‹¬äº”ä¸ªéƒ¨åˆ†ï¼ŒFast-Rayå˜æ¢ã€å¤šå°ºåº¦å›¾åƒç¼–ç å™¨ã€é«˜æ•ˆBEVç¼–ç å™¨ã€æ•°æ®å¢å¼ºå’Œæ—¶é—´èåˆï¼Œè¿™äº›å…±åŒæ„æˆäº†ä¸€ä¸ªæ¡†æ¶ï¼Œèµ‹äºˆFast BEVå¿«é€Ÿæ¨ç†é€Ÿåº¦å’Œæœ‰ç«äº‰åŠ›çš„æ€§èƒ½ã€‚ è¯¦ç»†å±•å¼€è¯´ï¼Œæœ¬æ–‡æå‡ºäº†Fast Rayå˜æ¢ï¼Œè¿™æ˜¯ä¸€ç§ç”¨äºå¿«é€Ÿæ¨ç†çš„è½»é‡çº§å’Œéƒ¨ç½²å‹å¥½çš„è§†å›¾å˜æ¢ï¼Œé€šè¿‡å°†å¤šè§†å›¾2Då›¾åƒç‰¹å¾æ²¿ç€ç›¸æœºå°„çº¿çš„ä½“ç´ æŠ•å½±åˆ°3Dæ¥è·å¾—BEVè¡¨ç¤ºã€‚æ­¤å¤–ï¼Œè¿˜æå‡ºäº†ä¸¤ç§æ“ä½œï¼Œå³â€œæŸ¥æ‰¾è¡¨â€å’Œâ€œå¤šè§†å›¾åˆ°ä¸€ä¸ªä½“ç´ â€ï¼Œä»¥ä¼˜åŒ–è½¦è½½å¹³å°çš„æµç¨‹ã€‚ç°æœ‰å·¥ä½œçš„è§†å›¾è½¬æ¢è€—æ—¶ï¼Œå¤šå°ºåº¦æŠ•å½±æ“ä½œå°†å…·æœ‰è¾ƒå¤§çš„æ—¶é—´å¼€é”€ï¼Œå› æ­¤éš¾ä»¥åœ¨å®è·µä¸­ä½¿ç”¨ã€‚åŸºäºFast Rayå˜æ¢ï¼Œæœ¬æ–‡çš„2Dåˆ°3DæŠ•å½±å…·æœ‰æå¿«çš„é€Ÿåº¦ï¼Œä½¿å…·æœ‰å¤šå°ºåº¦æŠ•å½±æ“ä½œçš„å¤šå°ºåº¦å›¾åƒç¼–ç å™¨æˆä¸ºå¯èƒ½ã€‚å…·ä½“è€Œè¨€ï¼Œä¸å¤§å¤šæ•°ä½¿ç”¨å•å°ºåº¦ç‰¹å¾ä½œä¸ºå›¾åƒç¼–ç å™¨è¾“å‡ºçš„ç°æœ‰å·¥ä½œä¸åŒï¼Œè®ºæ–‡åœ¨å›¾åƒç¼–ç å™¨è¾“å‡ºéƒ¨åˆ†ä½¿ç”¨äº†3å±‚å¤šå°ºåº¦ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œ(FPN)ç»“æ„ã€‚éšåæ˜¯ç›¸åº”çš„3çº§å¤šå°ºåº¦æŠ•å½±æ“ä½œã€‚å¯¹äºBEVç¼–ç å™¨ï¼Œä½œè€…ä½¿ç”¨å¾ˆå°‘çš„åŸå§‹æ®‹å·®ç½‘ç»œä½œä¸ºåŸºæœ¬BEVç¼–ç å™¨ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œä½¿ç”¨ä¸‰ç»´ç¼©å‡æ“ä½œæ¥åŠ é€Ÿç¼–ç å™¨ï¼Œåˆ†åˆ«æ˜¯â€œç©ºé—´åˆ°ä¿¡é“â€(S2C)ç®—å­ã€å¤šå°ºåº¦çº§è”èåˆ(MSCF)ç®—å­å’Œå¤šå¸§çº§è”èåˆ(MFCF)ç®—å­ã€‚è®ºæ–‡è¿˜è¿›ä¸€æ­¥ä¸ºå›¾åƒå’ŒBEVç©ºé—´å¼•å…¥äº†å¼ºå¤§çš„æ•°æ®å¢å¼ºç­–ç•¥ï¼Œå¦‚ç¿»è½¬ã€æ—‹è½¬ã€è°ƒæ•´å¤§å°ç­‰ã€‚åˆ†åˆ«åœ¨å›¾åƒç©ºé—´å’ŒBEVä¸­æ‰§è¡Œçš„æ•°æ®å¢å¼ºä¸ä»…é¿å…äº†è¿‡åº¦æ‹Ÿåˆï¼Œè€Œä¸”å®ç°äº†æ›´å¥½çš„æ€§èƒ½ã€‚æœ€åå¼•å…¥äº†æ—¶é—´èåˆ[17]ï¼Œ[23]ï¼Œå®ƒé€šè¿‡å¼•å…¥æ—¶é—´ç‰¹å¾èåˆæ¨¡å—å°†Fast BEVä»çº¯ç©ºé—´æ‰©å±•åˆ°æ—¶ç©ºç©ºé—´ï¼Œä½¿å½“å‰å…³é”®å¸§èƒ½å¤Ÿåˆ©ç”¨æ¥è‡ªå†å²å¸§çš„ä¿¡æ¯ã€‚ BEVæ„ŸçŸ¥åœ¨å­¦æœ¯ç•Œç»å¸¸æ›´æ–°æ€§èƒ½åŸºå‡†ï¼Œå¦‚NuScenesåŸºå‡†ï¼Œä½†å¾ˆå°‘åœ¨å·¥ä¸šåº”ç”¨æ–¹é¢è¿›è¡Œç ”ç©¶ã€‚æœ¬æ–‡é¦–æ¬¡åœ¨å½“å‰æµè¡Œçš„è½¦è½½èŠ¯ç‰‡ä¸Šå¼€å‘äº†ä¸€ä¸ªå…·æœ‰ç›¸å½“å‡†ç¡®åº¦å’Œæ•ˆç‡çš„åŸºå‡†ï¼Œä»å»¶è¿Ÿåˆ°ä¸åŒè®¡ç®—èƒ½åŠ›çš„è½¦è½½èŠ¯ç‰‡ä¹‹é—´çš„æ€§èƒ½ï¼Œè¿™ä¸ºBEVè§£å†³æ–¹æ¡ˆçš„å®é™…éƒ¨ç½²æä¾›äº†å‚è€ƒã€‚å‡­å€Ÿå…¶é«˜æ•ˆç‡å’Œå…·æœ‰ç«äº‰åŠ›çš„æ€§èƒ½ï¼ŒFast BEVæ‰“ç ´äº†ç°æœ‰BEVè§£å†³æ–¹æ¡ˆéš¾ä»¥åœ¨ä½è®¡ç®—èŠ¯ç‰‡ä¸Šéƒ¨ç½²çš„ä¿¡å¿µï¼Œç®€å•å’Œé«˜æ•ˆæ˜¯å…¶ä¸»è¦ä¼˜åŠ¿ã€‚æ‰€æå‡ºçš„Fast BEVè¡¨ç°å‡ºäº†å‡ºè‰²çš„æ€§èƒ½ï¼Œå¯ä»¥è½»æ¾éƒ¨ç½²åœ¨è½¦è½½å¹³å°ä¸Šã€‚åœ¨nuScenesæ•°æ®é›†ä¸Šï¼Œåœ¨2080Tiå¹³å°ä¸Šï¼ŒR50æ¨¡å‹å¯ä»¥åœ¨nuSceneéªŒè¯é›†ä¸Šè¿è¡Œ52.6 FPSå’Œ47.3%çš„NDSï¼Œè¶…è¿‡äº†BEVDepth-R50æ¨¡å‹çš„41.3 FPSå’Œ47.5%çš„NDSä»¥åŠBEVDet4D-R50æ¨¡å‹çš„30.2 FPSå’Œ45.7%çš„NDSã€‚æœ€å¤§çš„å‹å·(R101@900x1600)åœ¨nuSceneséªŒè¯é›†ä¸Šå»ºç«‹äº†å…·æœ‰ç«äº‰åŠ›çš„53.5%NDSã€‚ ","date":"2023-09-02","objectID":"/posts/fastbev/:1:0","tags":["Robotics"],"title":"FastBEV:å¿«é€Ÿè€Œå¼ºå¤§çš„BEVæ„ŸçŸ¥åŸºçº¿","uri":"/posts/fastbev/"},{"categories":["AutonomousDriving","Perception"],"content":"é¢†åŸŸçš„ä¸»æµæ–¹æ¡ˆæ¢³ç† 1)åŸºäºcameraçš„å•ç›®3Dç›®æ ‡æ£€æµ‹ 3Dç›®æ ‡æ£€æµ‹ä¸­çš„æ£€æµ‹å™¨æ—¨åœ¨é¢„æµ‹ç‰©ä½“åœ¨3Dç©ºé—´ä¸­çš„ä½ç½®å’Œç±»åˆ«ï¼Œç»™å®šç”±æ¿€å…‰é›·è¾¾æˆ–ç›¸æœºä¼ æ„Ÿå™¨ç”Ÿæˆçš„è¾“å…¥ã€‚åŸºäºLiDARçš„æ–¹æ³•ï¼Œä¾‹å¦‚CenterPointï¼Œå€¾å‘äºä½¿ç”¨3D CNNä»LiDARç‚¹æå–ç©ºé—´ç‰¹å¾ï¼Œå¹¶è¿›ä¸€æ­¥å›å½’åˆ°3Då±æ€§ï¼Œå¦‚ç›®æ ‡çš„3Dä¸­å¿ƒã€‚ä¸LiDARä¼ æ„Ÿå™¨ç›¸æ¯”ï¼Œä»…å°†ç›¸æœºå›¾åƒä½œä¸ºè¾“å…¥ä¸ä»…æˆæœ¬æ›´ä½ï¼Œè€Œä¸”å›¾åƒåŒ…å«æ›´ä¸°å¯Œçš„è¯­ä¹‰ä¿¡æ¯ã€‚å•ç›®3Dç›®æ ‡æ£€æµ‹çš„ä¸€ç§å®ç”¨æ–¹æ³•æ˜¯åŸºäº3Då›¾åƒç‰¹å¾å­¦ä¹ 3Dè¾¹ç•Œæ¡†ï¼ŒM3DRPNæå‡ºäº†3DåŒºåŸŸå»ºè®®ç½‘ç»œå’Œæ·±åº¦å·ç§¯å±‚ï¼Œä»¥æé«˜3Dåœºæ™¯ç†è§£ã€‚åœ¨FCOSä¹‹åï¼ŒFCOS3D[7]é€šè¿‡å°†3Dç›®æ ‡è½¬æ¢ä¸ºå›¾åƒåŸŸï¼Œç›´æ¥é¢„æµ‹æ¯ä¸ªå¯¹è±¡çš„3Dè¾¹ç•Œæ¡†ã€‚PGD[9]ä½¿ç”¨å¯¹è±¡ä¹‹é—´çš„å…³ç³»å’Œæ¦‚ç‡è¡¨ç¤ºæ¥æ•è·æ·±åº¦ä¸ç¡®å®šæ€§ï¼Œä»¥ä¾¿äº3Då¯¹è±¡æ£€æµ‹çš„æ·±åº¦ä¼°è®¡ï¼ŒDD3D[10]å—ç›Šäºæ·±åº¦é¢„è®­ç»ƒï¼Œå¹¶æ˜¾è‘—æ”¹å–„ç«¯åˆ°ç«¯3Dæ£€æµ‹ï¼ 2)åŸºäºcameraçš„ç¯è§†3Dç›®æ ‡æ£€æµ‹ ä¸€äº›å¤§å‹åŸºå‡†çš„æœ€æ–°è¿›å±•ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨æ›´å¤šçš„å‘¨å›´è§†å›¾ï¼Œè¿›ä¸€æ­¥æ¨åŠ¨äº†3Dæ„ŸçŸ¥é¢†åŸŸã€‚åœ¨åŸºäºcameraçš„3Dç›®æ ‡æ£€æµ‹ä¸­ï¼Œæ–°æå‡ºçš„å¤šè§†å›¾transformation æŠ€æœ¯[11]ã€[12]ã€[13]ã€[14]å°†ä»»åŠ¡é‡æ–°è¡¨è¿°ä¸ºç«‹ä½“åŒ¹é…é—®é¢˜ï¼Œå…¶ä¸­å‘¨å›´çš„å›¾åƒç‰¹å¾è½¬æ¢æˆç«‹ä½“è¡¨ç¤ºï¼Œå¦‚BEVæˆ–3Dä½“ç´ ã€‚ä¾‹å¦‚ï¼ŒLSSåœ¨é¢„æµ‹çš„æ·±åº¦åˆ†å¸ƒä¸ŠæŠ•å½±é€åƒç´ ç‰¹å¾ï¼Œä»¥ç”Ÿæˆç›¸æœºæˆªå¤´ä½“ï¼Œç„¶åè½¬æ¢æˆªå¤´ä½“è¿›å…¥BEV gridã€‚OFT[14]æå‡ºé€šè¿‡å°†é¢„å®šä¹‰çš„ä½“ç´ æŠ•å½±åˆ°å›¾åƒç‰¹å¾ä¸Šæ¥ç”Ÿæˆä½“ç´ è¡¨ç¤ºï¼ŒBEVDetå°†LSSåº”ç”¨äºå…¨å·ç§¯æ–¹æ³•ï¼Œå¹¶é¦–å…ˆéªŒè¯äº†æ˜¾å¼BEVçš„æ€§èƒ½ã€‚M2BEVé¦–å…ˆè·ŸéšOFTæ¢ç´¢BEVå¤šä»»åŠ¡æ„ŸçŸ¥ï¼ŒBEVDepthè¿›ä¸€æ­¥æ‰©å±•äº†LSS[13]ï¼Œå…·æœ‰å¼ºå¤§çš„æ·±åº¦ç›‘ç£å’Œé«˜æ•ˆçš„æ± åŒ–æ“ä½œã€‚è§†å›¾è½¬æ¢çš„å¦ä¸€ä¸ªè·¯çº¿å›¾æ˜¯ç½‘æ ¼çŠ¶çš„BEVæŸ¥è¯¢ï¼ŒDETR3Då’ŒGraph-DETR3Då°†æ¯ä¸ªBEVæŸ¥è¯¢è§£ç ä¸º3Då‚è€ƒç‚¹ï¼Œä»¥ä»å›¾åƒä¸­é‡‡æ ·ç›¸å…³çš„2Dç‰¹å¾è¿›è¡Œç»†åŒ–ã€‚BEVFormeråœ¨äºŒç»´åˆ°ä¸‰ç»´è½¬æ¢ä¸­å¼•å…¥äº†ç©ºé—´äº¤å‰å…³æ³¨ï¼Œå…è®¸æ¯ä¸ªæŸ¥è¯¢å¯ä»¥è·¨ç›¸æœºè§†å›¾èšåˆå…¶ç›¸å…³çš„äºŒç»´ç‰¹å¾ã€‚PETRæå‡º3Dåæ ‡ç”Ÿæˆæ¥æ„ŸçŸ¥3Dä½ç½®æ„ŸçŸ¥ç‰¹å¾ï¼Œé¿å…ç”Ÿæˆ3Då‚è€ƒç‚¹ã€‚è¿™äº›å·¥ä½œçš„æˆåŠŸæ¿€åŠ±æˆ‘ä»¬æœ‰æ•ˆå’Œé«˜æ•ˆåœ°æ‰©å±•å‘¨å›´çš„å¤šæ‘„åƒæœºæ£€æµ‹pipelineã€‚ä½œè€…å‘ç°åœ¨ç±»ä¼¼LSSçš„æ–¹æ³•ä¸­ï¼Œä½¿ç”¨æ·±åº¦åˆ†å¸ƒæ˜¯ä¸å¿…è¦çš„ï¼Œå¹¶ä¸”å¯ä»¥åˆ é™¤å®ƒä»¥è¿›ä¸€æ­¥åŠ å¿«æ•´ä¸ªpipelineçš„é€Ÿåº¦ï¼ 3)åŸºäºcameraçš„å¤šè§†å›¾æ—¶é—´èåˆ æœ€è¿‘ï¼Œä¸€äº›åŸºäºç›¸æœºçš„æ–¹æ³•è¯•å›¾åœ¨æ£€æµ‹è¿‡ç¨‹ä¸­å¼•å…¥å¤šå¸§èåˆï¼Œè¿™å·²è¢«è¯æ˜å¯¹åŸºäºLiDARçš„æ£€æµ‹å™¨ä¸­çš„é€Ÿåº¦ä¼°è®¡å’Œboxå®šä½æœ‰æ•ˆ[20]ï¼Œ[21]ï¼Œ[22]ã€‚è€ŒBEVä½œä¸ºä¸€ç§åŒæ—¶ç»„åˆæ¥è‡ªå¤šä¸ªç›¸æœºçš„è§†è§‰ä¿¡æ¯çš„ä¸­é—´ç‰¹å¾ï¼Œé€‚åˆäºæ—¶é—´å¯¹é½ã€‚[40]æå‡ºäº†ä¸€ç§åŠ¨æ€æ¨¡å—ï¼Œè¯¥æ¨¡å—ä½¿ç”¨è¿‡å»çš„ç©ºé—´BEVç‰¹å¾æ¥å­¦ä¹ æ—¶ç©ºBEVè¡¨ç¤ºï¼ŒBEVDet4Dé€šè¿‡å¯¹é½å¤šå¸§ç‰¹å¾å¹¶åˆ©ç”¨è‡ªæˆ‘è¿åŠ¨ä¸­çš„ç©ºé—´ç›¸å…³æ€§æ¥æ‰©å±•BEVDet[15]ã€‚PETRv2åŸºäº3Dä½ç½®åµŒå…¥çš„è§†è§’ï¼Œç›´æ¥å®ç°3Dç©ºé—´ä¸­çš„æ—¶é—´å¯¹é½ã€‚BEVFormerè®¾è®¡äº†ä¸€ç§æ—¶é—´è‡ªå…³æ³¨ï¼Œä»¥é€’å½’åœ°èåˆå†å²BEVä¿¡æ¯ï¼Œç±»ä¼¼äºRNNæ¨¡å‹ä¸­çš„éšè—çŠ¶æ€ã€‚æœ¬æ–‡çš„å·¥ä½œä¹Ÿå—åˆ°æ—¶é—´å¯¹é½çš„å¯å‘ï¼Œå…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬åº”ç”¨è¯¥æŠ€æœ¯æ¥è¿›ä¸€æ­¥æé«˜æ€§èƒ½ï¼ŒåŒæ—¶ä¿æŒé«˜æ•ˆç‡ã€‚ ","date":"2023-09-02","objectID":"/posts/fastbev/:2:0","tags":["Robotics"],"title":"FastBEV:å¿«é€Ÿè€Œå¼ºå¤§çš„BEVæ„ŸçŸ¥åŸºçº¿","uri":"/posts/fastbev/"},{"categories":["AutonomousDriving","Perception"],"content":"æœ¬æ–‡çš„æ–¹æ³• BEVæ„ŸçŸ¥ä¸­æœ€é‡è¦çš„æ˜¯å¦‚ä½•å°†2Dç‰¹å¾è½¬ç§»åˆ°3Dç©ºé—´ã€‚å¦‚å›¾1æ‰€ç¤ºï¼ŒåŸºäºæŸ¥è¯¢çš„æ–¹æ³•é€šè¿‡å˜æ¢å™¨ä¸­çš„æ³¨æ„åŠ›æœºåˆ¶è·å¾—3D BEVç‰¹å¾ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥è¡¨ç¤ºä¸ºä»¥ä¸‹å…¬å¼(1)ï¼ŒåŸºäºæ·±åº¦çš„æ–¹æ³•é€šè¿‡è®¡ç®—2Dç‰¹å¾å’Œé¢„æµ‹æ·±åº¦çš„å¤–ç§¯æ¥è·å¾—3D BEVç‰¹å¾ï¼Œå…·ä½“è¿‡ç¨‹å¦‚å…¬å¼(2)æ‰€ç¤º: $$F_{bev}(x,y,z)=Attn(q,k,v)\\quad(1)$$ $$F_{bev}(x,y,z)=Pool{F_{2D}(u,v)\\otimes D(u,v)}_{x,y,z}\\quad(2)$$ å…¶ä¸­F2D(u,v)è¡¨ç¤ºä»å›¾åƒä¸­æå–çš„2Dç‰¹å¾ï¼ŒD(u,v)è¡¨ç¤ºæ¥è‡ª2Dç‰¹å¾çš„æ·±åº¦é¢„æµ‹ã€‚âŠ—è¡¨ç¤ºout producterï¼ŒPoolè¡¨ç¤ºä½“ç´ æ± æ“ä½œã€‚xã€yã€zæ˜¯ä¸‰ç»´ç©ºé—´ä¸­çš„å¹³å‡åæ ‡ï¼Œuï¼Œvåœ¨äºŒç»´ç©ºé—´ä¸­çš„åæ ‡ã€‚åœ¨CUDAå¤šçº¿ç¨‹çš„æ”¯æŒä¸‹ï¼Œè¿™äº›æ–¹æ³•å¤§å¤§æé«˜äº†GPUå¹³å°ä¸Šçš„æ¨ç†é€Ÿåº¦ï¼Œä½†åœ¨æ›´å¤§çš„åˆ†è¾¨ç‡å’Œç‰¹å¾ç»´åº¦ä¸Šä¼šé‡åˆ°è®¡ç®—é€Ÿåº¦ç“¶é¢ˆï¼Œå¹¶ä¸”åœ¨æ²¡æœ‰æ¨ç†åº“æ”¯æŒçš„æƒ…å†µä¸‹è½¬ç§»åˆ°éGPUå¹³å°ä¸æ˜¯å¾ˆå‹å¥½ã€‚ ä½œè€…æå‡ºäº†åŸºäºå…‰çº¿æŠ•å½±çš„Fast-Ray transformationæ–¹æ³•ï¼Œå€ŸåŠ©äºæŸ¥æ‰¾è¡¨å’Œå¤šè§†å›¾åˆ°ä¸€ä¸ªä½“ç´ æ“ä½œï¼Œä»¥ä¾¿åœ¨GPUå¹³å°ä¸Šå®ç°æé«˜çš„2Dåˆ°3Dæ¨ç†é€Ÿåº¦ã€‚æ­¤å¤–ï¼Œç”±äºå…¶æ ‡é‡ç´¢å¼•çš„é«˜æ•ˆæ€§ï¼Œå½“åœ¨CPUå¹³å°ä¸Šè¿è¡Œæ—¶ï¼Œå®ƒä»ç„¶å…·æœ‰ä¼˜äºç°æœ‰è§£å†³æ–¹æ¡ˆçš„é€Ÿåº¦æ€§èƒ½ï¼Œè¿™ä½¿å¾—è½¬ç§»åˆ°æ›´å¤šå¹³å°æˆä¸ºå¯èƒ½ã€‚ M2BEV[16]æ˜¯è§£å†³å…·æœ‰ç»Ÿä¸€BEVè¡¨ç¤ºçš„å¤šæ‘„åƒæœºå¤šä»»åŠ¡æ„ŸçŸ¥çš„ç¬¬ä¸€ä¸ªå·¥ä½œä¹‹ä¸€ï¼Œå› ä¸ºå®ƒæ²¡æœ‰æ˜‚è´µçš„è§†å›¾è½¬æ¢å™¨æˆ–æ·±åº¦è¡¨ç¤ºï¼Œå› æ­¤åœ¨è½¦è½½å¹³å°ä¸Šå…·æœ‰å·¨å¤§çš„åº”ç”¨æ½œåŠ›ã€‚å—å…¶ç®€å•æ€§çš„å¯å‘ï¼Œæœ¬æ–‡æå‡ºäº†å…·æœ‰å“è¶Šé€Ÿåº¦å’Œæ€§èƒ½çš„Fast BEVï¼Œå¦‚å›¾2æ‰€ç¤ºï¼ŒFast BEVå°†å¤šæ‘„åƒæœºå›¾åƒä½œä¸ºè¾“å…¥ï¼Œå¹¶é¢„æµ‹3Dè¾¹ç•Œæ¡†(åŒ…æ‹¬é€Ÿåº¦)ä½œä¸ºè¾“å‡ºã€‚å…¶ä¸»è¦æ¡†æ¶å¯åˆ†ä¸ºäº”ä¸ªå…³é”®æ¨¡å—ï¼šFast-Ray Transformationã€Multi-Scale Image Encoderã€Efficient BEV Encoderã€Data Augmentationã€Temporal Fusionï¼ 1) Fast-Ray Transformation è§†å›¾è½¬æ¢æ˜¯å°†ç‰¹å¾ä»2Då›¾åƒç©ºé—´è½¬æ¢åˆ°3D BEVç©ºé—´çš„å…³é”®ç»„ä»¶ï¼Œè¿™é€šå¸¸åœ¨æ•´ä¸ªpipelinesä¸­èŠ±è´¹å¤§é‡æ—¶é—´ã€‚è®ºæ–‡æŒ‰ç…§[16]ï¼Œ[34]å‡è®¾æ²¿å°„çº¿çš„æ·±åº¦åˆ†å¸ƒæ˜¯å‡åŒ€çš„ï¼Œè¿™ç§æ–¹å¼ä¼˜ç‚¹æ˜¯ï¼Œä¸€æ—¦è·å¾—äº†ç›¸æœºçš„å†…åœ¨/å¤–åœ¨å‚æ•°ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°çŸ¥é“2Dåˆ°3Dçš„æŠ•å½±ã€‚ç”±äºè¿™é‡Œæ²¡æœ‰ä½¿ç”¨å¯å­¦ä¹ çš„å‚æ•°ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°è®¡ç®—å›¾åƒç‰¹å¾å›¾å’ŒBEVç‰¹å¾å›¾ä¸­çš„ç‚¹ä¹‹é—´çš„å¯¹åº”çŸ©é˜µã€‚åŸºäºè¿™ä¸€å‡è®¾ï¼Œæœ¬æ–‡ä»ä¸¤ä¸ªè§’åº¦è¿›ä¸€æ­¥åŠ é€Ÿè¯¥è¿‡ç¨‹ï¼šé¢„è®¡ç®—æŠ•å½±ç´¢å¼•(æŸ¥æ‰¾è¡¨)å’Œå¯†é›†ä½“ç´ ç‰¹å¾ç”Ÿæˆ(å¤šè§†å›¾åˆ°ä¸€ä¸ªä½“ç´ )ã€‚ æŸ¥æ‰¾è¡¨ã€‚æŠ•å½±ç´¢å¼•æ˜¯ä»2Då›¾åƒç©ºé—´åˆ°3Dä½“ç´ ç©ºé—´çš„æ˜ å°„ç´¢å¼•ï¼Œè€ƒè™‘åˆ°åœ¨æ„å»ºæ„ŸçŸ¥ç³»ç»Ÿæ—¶ç›¸æœºä½ç½®åŠå…¶å†…åœ¨/å¤–åœ¨å‚æ•°æ˜¯å›ºå®šçš„ï¼Œå¹¶ä¸”æœ¬æ–‡çš„æ–¹æ³•æ—¢ä¸ä¾èµ–äºæ•°æ®ç›¸å…³çš„æ·±åº¦é¢„æµ‹ï¼Œä¹Ÿä¸ä¾èµ–äºtransformerï¼Œå› æ­¤æ¯ä¸ªè¾“å…¥çš„æŠ•å½±æŒ‡æ•°éƒ½æ˜¯ç›¸åŒçš„ã€‚æ‰€ä»¥ä¸éœ€è¦ä¸ºæ¯æ¬¡è¿­ä»£è®¡ç®—ç›¸åŒçš„ç´¢å¼•ï¼Œåªéœ€é¢„å…ˆè®¡ç®—å›ºå®šæŠ•å½±ç´¢å¼•å¹¶å°†å…¶å­˜å‚¨ã€‚åœ¨æ¨æ–­è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢æŸ¥æ‰¾è¡¨æ¥è·å¾—æŠ•å½±ç´¢å¼•ï¼Œè¿™æ˜¯è¾¹ç¼˜è®¾å¤‡ä¸Šçš„ä¸€ä¸ªè¶…çº§ä¾¿å®œçš„æ“ä½œã€‚æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬ä»å•ä¸ªå¸§æ‰©å±•åˆ°å¤šä¸ªå¸§ï¼Œè¿˜å¯ä»¥å¾ˆå®¹æ˜“åœ°é¢„å…ˆè®¡ç®—å†…éƒ¨å’Œå¤–éƒ¨å‚æ•°ï¼Œå¹¶å°†å®ƒä»¬ä¸å½“å‰å¸§é¢„å¯¹é½ã€‚å¦‚ç®—æ³•1æ‰€ç¤ºï¼Œé€šè¿‡ç›¸æœºå‚æ•°çŸ©é˜µæŠ•å½±æ„å»ºäº†å…·æœ‰ä¸è¾“å‡ºä¸‰ç»´ä½“ç´ ç©ºé—´ç›¸åŒç»´åº¦çš„æŸ¥æ‰¾è¡¨LUTã€‚è¿­ä»£æ¯ä¸ªä½“ç´ å•å…ƒï¼Œå¹¶é€šè¿‡æŠ•å½±è®¡ç®—å¯¹åº”äº3Dåæ ‡çš„2Dåƒç´ åæ ‡ã€‚å¦‚æœè·å¾—çš„2Dåƒç´ åæ ‡åœ°å€æ˜¯åˆæ³•çš„ï¼Œå¯ä»¥å°†å…¶å¡«å……åˆ°LUTä¸­ä»¥å»ºç«‹ä¸æ•°æ®æ— å…³çš„ç´¢å¼•æ˜ å°„ï¼ å¤šè§†å›¾åˆ°ä¸€ä¸ªä½“ç´ ã€‚åŸºæœ¬è§†å›¾å˜æ¢ä½¿ç”¨åŸå§‹ä½“ç´ èšåˆæ“ä½œï¼Œè¯¥æ“ä½œä¸ºæ¯ä¸ªç›¸æœºè§†å›¾å­˜å‚¨ç¦»æ•£ä½“ç´ ç‰¹å¾ï¼Œç„¶åèšåˆå®ƒä»¬ä»¥ç”Ÿæˆæœ€ç»ˆä½“ç´ ç‰¹å¾ã€‚å¦‚å›¾3(a)æ‰€ç¤ºï¼Œè¿™æ˜¯å¡«å……çš„æ¯ä¸ªç¦»æ•£ä½“ç´ çš„é¸Ÿç°å›¾ã€‚å› ä¸ºæ¯ä¸ªç›¸æœºåªæœ‰æœ‰é™çš„è§†è§’ï¼Œæ‰€ä»¥æ¯ä¸ªä½“ç´ ç‰¹å¾éå¸¸ç¨€ç–ï¼Œä¾‹å¦‚ï¼Œåªæœ‰å¤§çº¦17%çš„ä½ç½®æ˜¯éé›¶çš„ã€‚æˆ‘ä»¬å‘ç°è¿™äº›ä½“ç´ ç‰¹å¾çš„èšé›†æ˜¯éå¸¸æ˜‚è´µçš„ï¼Œå› ä¸ºå®ƒä»¬çš„å·¨å¤§å°ºå¯¸ã€‚æœ¬æ–‡å»ºè®®ç”Ÿæˆå¯†é›†ä½“ç´ ç‰¹å¾ä»¥é¿å…æ˜‚è´µçš„ä½“ç´ èšé›†ï¼Œå…·ä½“æ¥è¯´ï¼Œè®©æ‰€æœ‰ç›¸æœºè§†å›¾ä¸­çš„å›¾åƒç‰¹å¾æŠ•å½±åˆ°åŒä¸€ä¸ªä½“ç´ ç‰¹å¾ï¼Œä»è€Œåœ¨æœ€åç”Ÿæˆä¸€ä¸ªå¯†é›†ä½“ç´ ï¼Œåä¸ºâ€œå¤šè§†å›¾åˆ°ä¸€ä¸ªä½“å…ƒâ€ã€‚å¦‚å›¾3(b)æ‰€ç¤ºï¼Œè¿™æ˜¯å¡«å……äº†å¯†é›†ä½“ç´ çš„é¸Ÿç°å›¾ã€‚å¦‚ç®—æ³•2æ‰€ç¤ºçš„å¿«é€Ÿå°„çº¿å˜æ¢ç®—æ³•ï¼Œå…¶å°†è¾“å…¥çš„å¤šè§†å›¾2Då›¾åƒç‰¹å¾è½¬ç§»åˆ°ä¸€ä¸ªä½“ç´ 3dç©ºé—´ä¸­ï¼Œå…¶ä¸­æ¯ä¸ªä½“ç´ å•å…ƒç”±é¢„å…ˆè®¡ç®—çš„LUTå¡«å……ç›¸åº”çš„2Då›¾åƒç‰¹å¾ã€‚å¯¹äºå…·æœ‰é‡å åŒºåŸŸçš„å¤šä¸ªè§†å›¾çš„æƒ…å†µï¼Œç›´æ¥é‡‡ç”¨ç¬¬ä¸€ä¸ªé‡åˆ°çš„è§†å›¾æ¥æé«˜è¡¨æ„å»ºçš„é€Ÿåº¦ã€‚ç»“åˆâ€œæŸ¥æ‰¾è¡¨â€å’Œâ€œå¤šè§†å›¾åˆ°ä¸€ä¸ªä½“ç´ â€åŠ é€Ÿè®¾è®¡ï¼Œè§†å›¾è½¬æ¢æ“ä½œå…·æœ‰æå¿«çš„æŠ•å½±é€Ÿåº¦ï¼ 2)å¤šå°ºåº¦Image Encoder å¤šå°ºåº¦å›¾åƒç¼–ç å™¨ä»å¤šè§†å›¾å›¾åƒä¸­æå–å¤šå±‚æ¬¡ç‰¹å¾ï¼ŒNä¸ªå›¾åƒâˆˆ$R^{HÃ—WÃ—3}$ä½œä¸ºè¾“å…¥ï¼ŒF1/4ã€F1/8ã€F1/16ä¸‰çº§ç‰¹å¾ä½œä¸ºè¾“å‡ºã€‚ 3)é«˜æ•ˆBEVç¼–ç å™¨ BEVç‰¹å¾æ˜¯4Då¼ é‡ï¼Œæ—¶é—´èåˆå°†å åŠ ç‰¹å¾ï¼Œè¿™å°†ä½¿BEVç¼–ç å™¨å…·æœ‰å¤§é‡è®¡ç®—é‡ã€‚ä¸‰ç»´ç¼©å‡æ“ä½œç”¨äºåŠ å¿«ç¼–ç å™¨çš„é€Ÿåº¦ï¼Œå³â€œç©ºé—´åˆ°ä¿¡é“â€(S2C)ç®—å­ã€å¤šå°ºåº¦ï¼Œå…¶ä¸­æ‰€è¿°å¤šå¸§èåˆ(MFCF)ç®—å­åˆ†åˆ«æ˜¯çº§è”èåˆ(MSCF)ç®—å­å’Œå¤šå¸§å‡¹èåˆ(MFF)ç®—å­ã€‚S2Cç®—å­å°†4Dä½“ç´ å¼ é‡VâˆˆRXÃ—YÃ—ZÃ—Cè½¬æ¢ä¸º3D BEVå¼ é‡VâˆˆR XÃ—YÃ—(ZC)ï¼Œä»è€Œé¿å…ä½¿ç”¨å†…å­˜æ˜‚è´µçš„3Då·ç§¯ã€‚åœ¨MFCFç®—å­ä¹‹å‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡å¤šå°ºåº¦æŠ•å½±è·å¾—çš„BEVç‰¹å¾æ˜¯ä¸åŒçš„å°ºåº¦ã€‚è®ºæ–‡å°†é¦–å…ˆå¯¹Xå’ŒYç»´åº¦ä¸Šçš„å¤šå°ºåº¦BEVç‰¹å¾è¿›è¡Œä¸Šé‡‡æ ·ï¼Œä½¿å…¶å¤§å°ç›¸åŒï¼Œä¾‹å¦‚200Ã—200ã€‚MSCFå’ŒMFCFè¿è¥å•†åœ¨ä¿¡é“ç»´åº¦ä¸­åˆå¹¶å¤šå°ºåº¦å¤šå¸§ç‰¹å¾ï¼Œå¹¶å°†å®ƒä»¬ä»è¾ƒé«˜çš„å‚æ•°é‡èåˆåˆ°è¾ƒä½çš„å‚æ•°é‡ã€‚æ­¤å¤–ï¼Œé€šè¿‡å®éªŒå‘ç°ï¼ŒBEVç¼–ç å™¨å’Œ3Dä½“ç´ åˆ†è¾¨ç‡çš„å¤§å°å¯¹æ€§èƒ½çš„å½±å“ç›¸å¯¹è¾ƒå°ï¼Œä½†å ç”¨äº†è¾ƒå¤§çš„é€Ÿåº¦æ¶ˆè€—ï¼Œå› æ­¤æ›´å°‘çš„blockå’Œæ›´å°çš„ä½“ç´ åˆ†è¾¨ç‡ä¹Ÿæ›´ä¸ºå…³é”®ï¼ 4)æ•°æ®å¢å¼º æ•°æ®æ‰©å……çš„å¥½å¤„å·²åœ¨å­¦æœ¯ç•Œå½¢æˆå…±è¯†ã€‚æ­¤å¤–ï¼Œ3Dæ•°æ®é›†(å¦‚NuScenesã€KITTI)å¾ˆéš¾æ ‡è®°ï¼Œä¸”æˆæœ¬é«˜æ˜‚ï¼Œè¿™å¯¼è‡´æ•°æ®é›†ä¸­æ ·æœ¬æ•°é‡è¾ƒå°‘ï¼Œå› æ­¤æ•°æ®å¢å¼ºå¯ä»¥å¸¦æ¥æ›´æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚æœ¬æ–‡åœ¨å›¾åƒç©ºé—´å’ŒBEVç©ºé—´ä¸­æ·»åŠ äº†æ•°æ®å¢å¼ºï¼Œä¸»è¦éµå¾ªBEVDetã€‚ å›¾åƒå¢å¼ºï¼šç”±äº3Dåœºæ™¯ä¸­çš„å›¾åƒä¸3Dç›¸æœºåæ ‡æœ‰ç›´æ¥å…³ç³»ï¼Œå› æ­¤3Dç›®æ ‡æ£€æµ‹ä¸­çš„æ•°æ®å¢å¼ºæ¯”2Dæ£€æµ‹æ›´å…·æŒ‘æˆ˜æ€§ã€‚å› æ­¤ï¼Œå¦‚æœå¯¹å›¾åƒåº”ç”¨æ•°æ®å¢å¼ºï¼Œè¿˜éœ€è¦æ”¹å˜ç›¸æœºå›ºæœ‰çŸ©é˜µã€‚å¯¹äºå¢å¼ºæ“ä½œï¼ŒåŸºæœ¬ä¸Šéµå¾ªå¸¸è§çš„æ“ä½œï¼Œä¾‹å¦‚ç¿»è½¬ã€è£å‰ªå’Œæ—‹è½¬ï¼Œåœ¨å›¾5çš„å·¦ä¾§éƒ¨åˆ†ï¼Œå±•ç¤ºäº†ä¸€äº›å›¾åƒå¢å¼ºçš„ç¤ºä¾‹ã€‚ BEVå¢å¼ºï¼šç±»ä¼¼äºå›¾åƒå¢å¼ºï¼Œç±»ä¼¼çš„æ“ä½œå¯ä»¥åº”ç”¨äºBEVç©ºé—´ï¼Œä¾‹å¦‚ç¿»è½¬ã€ç¼©æ”¾å’Œæ—‹è½¬ã€‚æ³¨æ„ï¼Œå¢å¼ºå˜æ¢åº”åº”ç”¨äºBEVç‰¹å¾å›¾å’Œ3D GTæ¡†ï¼Œä»¥ä¿æŒä¸€è‡´æ€§ã€‚BEVå¢å¼ºå˜æ¢å¯ä»¥é€šè¿‡ç›¸åº”åœ°ä¿®æ”¹ç›¸æœºå¤–éƒ¨çŸ©é˜µæ¥æ§åˆ¶ï¼Œåœ¨å›¾5çš„å³ä¾§éƒ¨åˆ†ï¼Œå±•ç¤ºäº†éšæœºæ—‹è½¬å¢å¼ºï¼Œä¸€ç§BEVå¢å¼ºï¼ 5)æ—¶é—´èåˆ å—BEVDet4Då’ŒBEVFormerçš„å¯å‘ï¼Œä½œè€…è¿˜å°†å†å²å¸§å¼•å…¥åˆ°å½“å‰å¸§ä¸­ä»¥è¿›è¡Œæ—¶é—´ç‰¹å¾èåˆã€‚é€šè¿‡ç©ºé—´å¯¹é½æ“ä½œå’Œçº§è”æ“ä½œï¼Œå°†å†å²å¸§çš„ç‰¹å¾ä¸å½“å‰å¸§çš„å¯¹åº”ç‰¹å¾èåˆã€‚æ—¶é—´èåˆå¯ä»¥è¢«è®¤ä¸ºæ˜¯å¸§çº§çš„ç‰¹å¾å¢å¼ºï¼Œåœ¨ä¸€å®šèŒƒå›´å†…è¾ƒé•¿çš„æ—¶é—´åºåˆ—å¯ä»¥å¸¦æ¥æ›´å¤šçš„æ€§èƒ½å¢ç›Šã€‚å…·ä½“æ¥è¯´ï¼Œç”¨ä¸‰ä¸ªå†å²å…³é”®å¸§å¯¹å½“å‰å¸§è¿›è¡Œé‡‡æ ·;æ¯ä¸ªå…³é”®å¸§å…·æœ‰0.5sé—´éš”ï¼Œæœ¬æ–‡é‡‡ç”¨äº†BEVDet4Dä¸­çš„å¤šå¸§ç‰¹å¾å¯¹é½æ–¹æ³•ã€‚å¦‚å›¾6æ‰€ç¤ºï¼Œåœ¨è·å¾—å››ä¸ªå¯¹é½çš„BEVç‰¹å¾åï¼Œç›´æ¥å°†å®ƒä»¬è¿æ¥èµ·æ¥ï¼Œå¹¶å°†å®ƒä»¬é¦ˆé€åˆ°BEVç¼–ç å™¨ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œä½¿ç”¨å›¾åƒç¼–ç å™¨åœ¨çº¿æå–å†å²å¸§ç‰¹å¾ï¼Œåœ¨æµ‹è¯•é˜¶æ®µï¼Œå†å²å¸§åŠŸèƒ½å¯ä»¥ç¦»çº¿ä¿å­˜ï¼Œå¹¶ç›´æ¥å–å‡ºç”¨äºåŠ é€Ÿã€‚ä¸BEVDet4Då’ŒBEVFormerè¿›è¡Œæ¯”è¾ƒï¼ŒBEVDet4Dåªå¼•å…¥äº†ä¸€ä¸ªå†å²æ¡†æ¶ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ä¸è¶³ä»¥åˆ©ç”¨å†å²ä¿¡æ¯ã€‚Fast BEVä½¿ç”¨ä¸‰ä¸ªå†å²å¸§ï¼Œä»è€Œæ˜¾è‘—æé«˜äº†æ€§èƒ½ï¼Œé€šè¿‡ä½¿ç”¨ä¸¤ä¸ªå†å²å¸§ï¼ŒBEVFormerç•¥ä¼˜äºBEVDet4Dã€‚ç„¶è€Œï¼Œç”±äºè®°å¿†é—®é¢˜ï¼Œåœ¨è®­ç»ƒé˜¶æ®µï¼Œå†å²ç‰¹å¾åœ¨æ²¡æœ‰æ¢¯åº¦çš„æƒ…å†µä¸‹è¢«åˆ†ç¦»ï¼Œè¿™ä¸æ˜¯æœ€ä½³çš„ã€‚æ­¤å¤–ï¼ŒBEVFormerä½¿ç”¨RNNæ ·å¼æ¥é¡ºåºèåˆç‰¹å¾ï¼Œè¿™æ˜¯ä½æ•ˆçš„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒFast BEVä¸­çš„æ‰€æœ‰å¸§éƒ½ä»¥ç«¯åˆ°ç«¯çš„æ–¹å¼è¿›è¡Œè®­ç»ƒï¼Œè¿™ä¸æ™®é€šGPUç›¸æ¯”æ›´æ˜“äºè®­ç»ƒï¼ ","date":"2023-09-02","objectID":"/posts/fastbev/:3:0","tags":["Robotics"],"title":"FastBEV:å¿«é€Ÿè€Œå¼ºå¤§çš„BEVæ„ŸçŸ¥åŸºçº¿","uri":"/posts/fastbev/"},{"categories":["AutonomousDriving","Perception"],"content":"å®éªŒ æ•°æ®é›†æè¿°ï¼šè¯„ä¼°äº†nuScenesæ•°æ®é›†ä¸Šçš„ Fast BEVï¼Œè¯¥æ•°æ®é›†åŒ…å«1000ä¸ªè‡ªåŠ¨é©¾é©¶åœºæ™¯ï¼Œæ¯ä¸ªåœºæ™¯20ç§’ã€‚æ•°æ®é›†è¢«åˆ†æˆ850ä¸ªåœºæ™¯ç”¨äºè®­ç»ƒ/éªŒè¯ï¼Œå…¶ä½™150ä¸ªåœºæ™¯ç”¨äºæµ‹è¯•ã€‚è™½ç„¶nuScenesæ•°æ®é›†æä¾›æ¥è‡ªä¸åŒä¼ æ„Ÿå™¨çš„æ•°æ®ï¼Œä½†æˆ‘ä»¬åªä½¿ç”¨ç›¸æœºæ•°æ®ã€‚ç›¸æœºæœ‰å…­ä¸ªè§†å›¾ï¼šå·¦å‰ã€å‰ã€å³å‰ã€å·¦åã€åã€å³åã€‚ è¯„ä¼°æŒ‡æ ‡ã€‚ä¸ºäº†å…¨é¢è¯„ä¼°æ£€æµ‹ä»»åŠ¡ï¼Œä½¿ç”¨å¹³å‡ç²¾åº¦(mAP)å’ŒnuScenesæ£€æµ‹åˆ†æ•°(NDS)çš„æ ‡å‡†è¯„ä¼°æŒ‡æ ‡è¿›è¡Œ3Dç›®æ ‡æ£€æµ‹è¯„ä¼°ã€‚æ­¤å¤–ï¼Œä¸ºäº†è®¡ç®—ç›¸åº”æ–¹é¢çš„ç²¾åº¦(ä¾‹å¦‚ï¼Œå¹³ç§»ã€ç¼©æ”¾ã€æ–¹å‘ã€é€Ÿåº¦å’Œå±æ€§)ï¼Œä½¿ç”¨å¹³å‡å¹³ç§»è¯¯å·®(mATE)ã€å¹³å‡ç¼©æ”¾è¯¯å·®(mASE)ã€å¹³å‡æ–¹å‘è¯¯å·®(mAOE)ã€å¹³å‡é€Ÿåº¦è¯¯å·®(mAVE)ï¼Œä»¥åŠå¹³å‡å±æ€§è¯¯å·®(mAAE)ä½œä¸ºåº¦é‡ã€‚ å’Œä¸»æµæ–¹æ³•çš„Latencyè¿›è¡Œæ¯”è¾ƒï¼š åœ¨å¯æ¯”æ€§èƒ½ä¸‹ï¼ŒFast BEVã€BEVDet4Då’ŒBEVDepthæ–¹æ¡ˆçš„ç«¯åˆ°ç«¯å»¶è¿Ÿæ¯”è¾ƒã€‚è¡¨çš„ä¸Šéƒ¨æ˜¯ä¸‰ç§æ–¹æ¡ˆçš„è¯¦ç»†è®¾ç½®ï¼ŒåŒ…æ‹¬æ¯ä¸ªç»„ä»¶çš„å…·ä½“é…ç½®ã€‚è¡¨çš„ä¸‹åŠéƒ¨åˆ†æ˜¯åœ¨å¯æ¯”æ€§èƒ½ä¸‹ä¸‰ç§æ–¹æ¡ˆçš„æ¯ä¸ªéƒ¨åˆ†çš„å»¶è¿Ÿå’Œæ€»å»¶è¿Ÿçš„æ¯”è¾ƒã€‚2Dåˆ°3Déƒ¨åˆ†åŒ…æ‹¬CPUå’ŒCUDAä¸¤ä¸ªå¹³å°çš„å»¶è¿Ÿï¼ŒMSOè¡¨ç¤ºå¤šå°ºåº¦è¾“å‡ºã€‚ nuScenesé›†çš„æ¯”è¾ƒã€‚â€œLâ€è¡¨ç¤ºæ¿€å…‰é›·è¾¾ï¼Œâ€œCâ€è¡¨ç¤ºæ‘„åƒæœºï¼Œâ€œDâ€è¡¨ç¤ºæ·±åº¦/æ¿€å…‰é›·è¾¾ç›‘æ§ã€‚MSè¡¨ç¤ºå›¾åƒå’ŒBEVç¼–ç å™¨ä¸­çš„å¤šå°ºåº¦ã€‚â€œÂ¶â€è¡¨ç¤ºæˆ‘ä»¬ä½¿ç”¨MSã€scale NMSå’Œæµ‹è¯•æ—¶é—´æ•°æ®å¢å¼ºçš„æ–¹æ³•ã€‚ æ›´å¤šæ¶ˆèå®éªŒå¯¹æ¯”ï¼š é«˜æ•ˆå‹å·ç³»åˆ—ï¼šä¸ºäº†æ»¡è¶³ä¸åŒè®¡ç®—èƒ½åŠ›å¹³å°çš„éƒ¨ç½²éœ€æ±‚ï¼Œæœ¬æ–‡è®¾è®¡äº†ä¸€ç³»åˆ—ä»M0åˆ°M5çš„é«˜æ•ˆæ¨¡å‹ï¼Œå¦‚è¡¨10æ‰€ç¤ºã€‚è®¾ç½®äº†ä¸åŒçš„å›¾åƒç¼–ç å™¨(ä»ResNet18åˆ°ResNet50)ï¼Œå›¾åƒåˆ†è¾¨ç‡(ä»256Ã—704åˆ°900Ã—1600)ã€ä½“ç´ åˆ†è¾¨ç‡(ä»200Ã—200Ã—4åˆ°250Ã—250Ã—6)å’ŒBEVç¼–ç å™¨(ä»2b-192cåˆ°6b-256c)æ¥è®¾è®¡æ¨¡å‹å°ºå¯¸ã€‚ä»è¡¨10å¯ä»¥çœ‹å‡ºï¼Œä»M0åˆ°M5ï¼Œéšç€å›¾åƒç¼–ç å™¨ã€å›¾åƒåˆ†è¾¨ç‡ã€ä½“ç´ åˆ†è¾¨ç‡å’ŒBEVç¼–ç å™¨é€æ¸å˜å¤§ï¼Œæ¨¡å‹æ€§èƒ½é€æ¸æé«˜ã€‚ åœ¨æµè¡Œè®¾å¤‡ä¸Šéƒ¨ç½²ï¼šé™¤äº†æ³¨é‡æ€§èƒ½ï¼Œè¿˜å°†Mç³»åˆ—è½¦å‹éƒ¨ç½²åœ¨ä¸åŒçš„è½¦è½½å¹³å°(Xavierã€Orinã€T4)ä¸Šï¼Œå¹¶ä½¿ç”¨CUDA-TensorRT-INT8åŠ é€Ÿã€‚å…·ä½“è€Œè¨€ï¼ŒAGX Xavieråœ¨æ²¡æœ‰ä½¿ç”¨CUDA11.4-TRTT8.4.0-INT8éƒ¨ç½²DLAåŠ é€Ÿçš„æƒ…å†µä¸‹çš„è®¡ç®—èƒ½åŠ›ä¸º22TOPSï¼ŒAGX Orin 64Gåœ¨æ²¡æœ‰ä½¿ç”¨CUDA11.4-TTRT8.4.0-INT8éƒ¨ç½²DLBåŠ é€Ÿçš„æƒ…å†µä¸‹çš„è®¡ç®—èƒ½åŠ›æ˜¯170TOPSï¼ŒT4åœ¨ä½¿ç”¨CUDA11.1-TRT7.2.1-INT8éƒ¨ç½²æ—¶çš„è®¡ç®—èƒ½åŠ›åˆ™æ˜¯130TOPSã€‚å¦‚è¡¨11æ‰€ç¤ºï¼Œè¯„ä¼°äº†è¿™äº›è½¦è½½è®¾å¤‡ä¸ŠMç³»åˆ—æ¨¡å‹çš„å»¶è¿Ÿï¼Œå¹¶å°†å»¶è¿Ÿåˆ†è§£ä¸º2D/2Dåˆ°3D/3Dä¸‰ä¸ªéƒ¨åˆ†ã€‚ ä»è¡¨11ä¸­å¯ä»¥çœ‹å‡ºï¼š(1)éšç€Mç³»åˆ—å‹å·é€æ¸å˜å¤§ï¼Œæ€§èƒ½é€æ¸æé«˜ï¼ŒåŒä¸€è®¡ç®—å¹³å°ä¸Šçš„å»¶è¿Ÿä¹ŸåŸºæœ¬ä¸Šé€æ¸å¢åŠ ï¼Œ2Då’Œ3Déƒ¨åˆ†çš„å»¶è¿Ÿä¹Ÿåˆ†åˆ«å¢åŠ ã€‚(2) ä»å·¦åˆ°å³ï¼Œéšç€è¿™ä¸‰ä¸ªè®¾å¤‡çš„å®é™…è®¡ç®—èƒ½åŠ›1é€æ¸å¢åŠ ï¼ŒMç³»åˆ—çš„æ¯ä¸ªæ¨¡å‹çš„å»¶è¿Ÿé€æ¸å‡å°‘ï¼Œ2Då’Œ3Déƒ¨åˆ†çš„å»¶è¿Ÿåˆ†åˆ«å‡å°‘ã€‚(3) ç»“åˆè¡¨11ä¸­Mç³»åˆ—çš„æ€§èƒ½ï¼Œå¯ä»¥å‘ç°ï¼Œä»…è€ƒè™‘å»¶è¿Ÿæ—¶ï¼ŒM0æ¨¡å‹åœ¨Xavierç­‰ä½è®¡ç®—å¹³å°ä¸Šå¯ä»¥è¾¾åˆ°19.7FPSï¼Œè¿™å¯ä»¥å®ç°å®æ—¶æ¨ç†é€Ÿåº¦ã€‚è€ƒè™‘åˆ°æ€§èƒ½ï¼ŒM2æ¨¡å‹åœ¨æ€§èƒ½å’Œå»¶è¿Ÿä¹‹é—´å…·æœ‰æœ€åˆç†çš„æƒè¡¡ã€‚åœ¨ä¸è¡¨2ä¸­R50ç³»åˆ—æ¨¡å‹çš„æ€§èƒ½ç›¸å½“çš„å‰æä¸‹ï¼Œå®ƒåœ¨Orinå¹³å°ä¸Šå¯ä»¥è¾¾åˆ°43.3 FPSï¼Œè¿™å¯ä»¥å®ç°å®é™…çš„å®æ—¶æ¨ç†è¦æ±‚ã€‚ ç›®å‰ï¼ŒBEVæ„ŸçŸ¥è§£å†³æ–¹æ¡ˆè¶Šæ¥è¶Šå¤šï¼Œä½†å®ƒä»¬ä¸»è¦è¿½æ±‚å­¦æœ¯é¢†åŸŸçš„æ€§èƒ½ï¼Œå¾ˆå°‘è€ƒè™‘å¦‚ä½•æ›´å¥½åœ°å°†å…¶éƒ¨ç½²åœ¨è½¦è½½èŠ¯ç‰‡ä¸Šï¼Œå°¤å…¶æ˜¯ä½è®¡ç®—èŠ¯ç‰‡ä¸Šã€‚ä¸èƒ½å¦è®¤ï¼ŒBEVDetå’ŒBEVDepthç­‰å·¥ä½œæ˜¯å½“å‰è€ƒè™‘çš„é¦–æ‰¹å¯èƒ½è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒä»¬åœ¨éƒ¨ç½²è½¦è½½èŠ¯ç‰‡æ—¶éå¸¸æ–¹ä¾¿ã€‚ä½†Fast BEVåœ¨ä»¥ä¸‹æƒ…å†µä¸‹æä¾›äº†åº”ç”¨çš„å¯èƒ½æ€§ï¼š ä½è®¡ç®—èƒ½åŠ›èŠ¯ç‰‡ï¼šå°½ç®¡è‡ªåŠ¨é©¾é©¶èŠ¯ç‰‡çš„è®¡ç®—èƒ½åŠ›åœ¨é€æ¸å¢åŠ ï¼Œä½†ä¸€äº›è®¡ç®—èƒ½åŠ›è¾ƒä½çš„èŠ¯ç‰‡ï¼Œå¦‚è‹±ä¼Ÿè¾¾Xavierï¼Œä»è¢«ç”¨äºç»æµå‹è½¦è¾†ã€‚Fast BEVå¯ä»¥ä»¥æ›´å¿«çš„é€Ÿåº¦åœ¨ä½è®¡ç®—èƒ½åŠ›èŠ¯ç‰‡ä¸Šè¡¨ç°å¾—æ›´å¥½ã€‚ éGPUéƒ¨ç½²ï¼šDEVEDepthå’ŒBEVDetçš„æˆåŠŸéƒ¨ç½²å’Œåº”ç”¨ä¸»è¦ä¾èµ–äºCUDAå¤šçº¿ç¨‹æ”¯æŒçš„é«˜æ•ˆä½“ç´ æ± æ“ä½œã€‚ç„¶è€Œï¼Œæ²¡æœ‰CUDAåº“çš„éGPUèŠ¯ç‰‡ï¼Œä¾‹å¦‚ä»¥DSPä¸ºè®¡ç®—å•å…ƒçš„å¾·å·ä»ªå™¨èŠ¯ç‰‡ï¼Œå¾ˆéš¾å¼€å‘DSPå¤šçº¿ç¨‹å¤„ç†å™¨ï¼ŒCPUé€Ÿåº¦ä¸å¤Ÿå¿«ï¼Œè¿™ä½¿å¾—å®ƒä»¬çš„è§£å†³æ–¹æ¡ˆåœ¨æ­¤ç±»èŠ¯ç‰‡ä¸Šå¤±å»äº†ä¼˜åŠ¿ã€‚Fast BEVä»¥å…¶å¿«é€Ÿçš„CPUé€Ÿåº¦æä¾›äº†åœ¨éGPUèŠ¯ç‰‡ä¸Šéƒ¨ç½²çš„ä¾¿åˆ©ã€‚ å®è·µä¸­å¯æ‰©å±•ï¼šéšç€æŠ€æœ¯çš„å‘å±•ï¼Œè®¸å¤šè‡ªåŠ¨é©¾é©¶åˆ¶é€ å•†å·²ç»å¼€å§‹æ”¾å¼ƒæ¿€å…‰é›·è¾¾ï¼Œåªä½¿ç”¨çº¯æ‘„åƒå¤´è¿›è¡Œæ„ŸçŸ¥ã€‚ç»“æœï¼Œåœ¨çœŸå®è½¦è¾†æ”¶é›†çš„å¤§é‡æ•°æ®ä¸­æ²¡æœ‰æ·±åº¦ä¿¡æ¯ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ¨¡å‹æ”¾å¤§æˆ–æ•°æ®æ”¾å¤§é€šå¸¸åŸºäºä»çœŸå®è½¦è¾†æ”¶é›†çš„æ•°æ®ï¼Œä»¥åˆ©ç”¨æ•°æ®æ½œåŠ›æé«˜æ€§èƒ½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸºäºæ·±åº¦ç›‘æ§çš„è§£å†³æ–¹æ¡ˆé‡åˆ°ç“¶é¢ˆï¼Œè€ŒFast BEVä¸å¼•å…¥ä»»ä½•æ·±åº¦ä¿¡æ¯ï¼Œå¯ä»¥æ›´å¥½åœ°åº”ç”¨ï¼ ref: [1]. è®ºæ–‡ï¼šhttps://arxiv.org/abs/2301.12511 [2]. ä»£ç ï¼šhttps://github.com/Sense-GVT/Fast-BEV [3]. https://mp.weixin.qq.com/s/aVbaw2qYc6-i21zbCNhfOg [4]. FastBEV ä»£ç æ³¨é‡Š ","date":"2023-09-02","objectID":"/posts/fastbev/:4:0","tags":["Robotics"],"title":"FastBEV:å¿«é€Ÿè€Œå¼ºå¤§çš„BEVæ„ŸçŸ¥åŸºçº¿","uri":"/posts/fastbev/"},{"categories":["C++"],"content":"æ“ä½œåŒºé—´çš„å‡½æ•° æœ‰æ—¶å€™ä½ éœ€è¦æŠŠæ•´ä¸ªåŒºé—´æç‚¼æˆä¸€ä¸ªå•ç‹¬çš„æ•°ï¼Œæˆ–ï¼Œæ›´ä¸€èˆ¬åœ°ï¼Œä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ã€‚ å¯¹äºä¸€èˆ¬éœ€è¦çš„ä¿¡æ¯ï¼Œcountå‘Šè¯‰ä½ åŒºé—´ä¸­æœ‰å¤šå°‘ç­‰äºæŸä¸ªå€¼çš„å…ƒç´ ï¼Œè€Œcount_ifå‘Šè¯‰ä½ æœ‰å¤šå°‘å…ƒç´ æ»¡è¶³ä¸€ä¸ªåˆ¤æ–­å¼ã€‚ åŒºé—´ä¸­çš„æœ€å°å’Œæœ€å¤§å€¼å¯ä»¥é€šè¿‡min_elementå’Œmax_elementè·å¾—ã€‚ ä½†æœ‰æ—¶ï¼Œä½ éœ€è¦ç”¨ä¸€äº›è‡ªå®šä¹‰çš„æ–¹å¼ç»Ÿè®¡ï¼ˆsummarizeï¼‰åŒºé—´ï¼Œè€Œä¸”åœ¨é‚£äº›æƒ…å†µä¸­ï¼Œä½ éœ€è¦æ¯”countã€count_ifã€min_elementæˆ–max_elementæ›´çµæ´»çš„ä¸œè¥¿ã€‚ ä½ å¯èƒ½æƒ³è¦å¯¹ä¸€ä¸ªå®¹å™¨ä¸­çš„å­—ç¬¦ä¸²é•¿åº¦æ±‚å’Œã€‚ä½ å¯èƒ½æƒ³è¦æ•°çš„åŒºé—´çš„ä¹˜ç§¯ã€‚ä½ å¯èƒ½æƒ³è¦pointåŒºé—´çš„å¹³å‡åæ ‡ã€‚åœ¨é‚£äº›æƒ…å†µä¸­ï¼Œä½ éœ€è¦ç»Ÿè®¡ä¸€ä¸ªåŒºé—´ï¼Œä½†ä½ éœ€è¦æœ‰å®šä¹‰ä½ éœ€è¦ç»Ÿè®¡çš„ä¸œè¥¿çš„èƒ½åŠ›ã€‚ ","date":"2023-09-02","objectID":"/posts/clause_37/:1:0","tags":["Effective STL"],"title":"Effective STL [37] | ç”¨accumulateæˆ–for_eachæ¥ç»Ÿè®¡åŒºé—´","uri":"/posts/clause_37/"},{"categories":["C++"],"content":"accumulate accumulateå’Œinner_productã€adjacent_differenceå’Œpartial_sumç®—æ³•åœ¨å¤´æ–‡ä»¶ä¸­ã€‚ accumulateå­˜åœ¨ä¸¤ç§å½¢å¼ã€‚ å¸¦æœ‰ä¸€å¯¹è¿­ä»£å™¨å’Œåˆå§‹å€¼çš„å½¢å¼å¯ä»¥è¿”å›åˆå§‹å€¼åŠ ç”±è¿­ä»£å™¨åˆ’åˆ†å‡ºçš„åŒºé—´ä¸­å€¼çš„å’Œ // å»ºç«‹ä¸€ä¸ªlistï¼Œæ”¾ä¸€äº›doubleè¿›å» list\u003cdouble\u003e ld; ... // è®¡ç®—å®ƒä»¬çš„å’Œï¼Œä»0.0å¼€å§‹ double sum = accumulate(ld.begin(), ld.end(), 0.0); æ³¨æ„ æ„åˆå§‹å€¼æŒ‡å®šä¸º0.0ï¼Œä¸æ˜¯ç®€å•çš„0ã€‚ 0.0çš„ç±»å‹æ˜¯doubleï¼Œæ‰€ä»¥accumulateå†…éƒ¨ä½¿ç”¨äº†ä¸€ä¸ªdoubleç±»å‹çš„å˜é‡æ¥å­˜å‚¨è®¡ç®—çš„å’Œã€‚ å¦‚æœè¿™ä¹ˆå†™è¿™ä¸ªè°ƒç”¨: // è®¡ç®—å®ƒä»¬çš„å’Œï¼Œä»0å¼€å§‹ï¼›è¿™ä¸æ­£ç¡®ï¼ double sum = accumulate(ld.begin(), ld.end(), 0); å¦‚æœåˆå§‹å€¼æ˜¯int 0ï¼Œæ‰€ä»¥accumulateå†…éƒ¨å°±ä¼šä½¿ç”¨ä¸€ä¸ªintæ¥ä¿å­˜å®ƒè®¡ç®—çš„å€¼ã€‚é‚£ä¸ªintæœ€åå˜æˆaccumulateçš„è¿”å›å€¼ï¼Œè€Œä¸”å®ƒç”¨æ¥åˆå§‹åŒ–å’Œå˜é‡ã€‚è¿™ä»£ç å¯ä»¥ç¼–è¯‘å’Œè¿è¡Œï¼Œä½†å’Œçš„å€¼å¯èƒ½ä¸å¯¹ã€‚ä¸æ˜¯ä¿å­˜çœŸçš„doubleçš„listçš„å’Œï¼Œå®ƒå¯èƒ½ä¿å­˜äº†æ‰€æœ‰çš„doubleåŠ èµ·æ¥çš„ç»“æœï¼Œä½†æ¯æ¬¡åŠ æ³•åæŠŠç»“æœè½¬æ¢ä¸ºä¸€ä¸ªintã€‚ è¾“å…¥è¿­ä»£å™¨ accumulateåªéœ€è¦è¾“å…¥è¿­ä»£å™¨ï¼Œæ‰€ä»¥ä½ ç”šè‡³å¯ä»¥ä½¿ç”¨istream_iteratorå’Œistreambuf_iterator // æ‰“å°cinä¸­ é‚£äº›intçš„å’Œ cout \u003c\u003c \"The sum of the ints on the standard input is\" \u003c\u003c accumulate(istream_iterator\u003cint\u003e(cin), istream_iterator\u003cint\u003e(), 0); å¸¦æœ‰ä¸€ä¸ªåˆå§‹å’Œå€¼ä¸ä¸€ä¸ªä»»æ„çš„ç»Ÿè®¡å‡½æ•° æ¯”å¦‚ï¼Œè€ƒè™‘æ€ä¹ˆä½¿ç”¨accumulateæ¥è®¡ç®—å®¹å™¨ä¸­çš„å­—ç¬¦ä¸²çš„é•¿åº¦å’Œã€‚è¦è®¡ç®—è¿™ä¸ªå’Œï¼Œaccumulateéœ€è¦çŸ¥é“ä¸¤ä¸ªä¸œ è¥¿ã€‚ç¬¬ä¸€ï¼Œå®ƒå¿…é¡»çŸ¥é“å’Œçš„å¼€å§‹ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯0ã€‚ç¬¬äºŒï¼Œå®ƒå¿…é¡»çŸ¥é“æ¯æ¬¡çœ‹åˆ°ä¸€ä¸ªæ–°çš„å­— ç¬¦ä¸²æ—¶æ€ä¹ˆæ›´æ–°è¿™ä¸ªå’Œã€‚è¦å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¸¦æœ‰ç›®å‰çš„å’Œä¸æ–°çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸”è¿”å›æ›´æ–°çš„å’Œ: // string::size_typeçš„å†…å®¹ string::size_type stringLengthSum(string::size_type sumSoFar, const string\u0026 s) { return sumSoFar + s.size(); } æ¯ä¸ªæ ‡å‡†STLå®¹å™¨éƒ½æœ‰ä¸€ä¸ªtypedefå«åšsize_typeï¼Œé‚£æ˜¯å®¹å™¨è®¡é‡ä¸œè¥¿çš„ç±»å‹ã€‚æ¯”å¦‚ï¼Œè¿™æ˜¯å®¹å™¨çš„sizeå‡½æ•°çš„è¿”å›ç±»å‹ã€‚å¯¹äºæ‰€æœ‰çš„æ ‡å‡†å®¹å™¨ï¼Œsize_typeå¿…é¡»æ˜¯size_tã€‚ stringLengthSumæ˜¯accmulateä½¿ç”¨çš„ç»Ÿè®¡å‡½æ•°çš„ä»£è¡¨ã€‚å®ƒå¸¦æœ‰åˆ°ç›®å‰ä¸ºæ­¢åŒºé—´çš„ç»Ÿè®¡å€¼å’ŒåŒºé—´çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå®ƒè¿”å›æ–°çš„ç»Ÿè®¡å€¼ã€‚ set\u003cstring\u003e ss; // å»ºç«‹å­—ç¬¦ä¸²çš„å®¹å™¨ï¼Œè¿›è¡Œä¸€äº›æ“ä½œ ... // æŠŠlengthSumè®¾ä¸ºå¯¹ ssä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨stringLengthSumçš„ç»“æœï¼Œä½¿ç”¨0ä½œä¸ºåˆå§‹ç»Ÿè®¡å€¼ string::size_type lengthSum = accumulate(ss.begin(), ss.end(), 0, stringLengthSum); è®¡ç®—æ•°å€¼åŒºé—´çš„ç§¯ç”šè‡³æ›´ç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ç”¨å†™è‡ªå·±çš„æ±‚å’Œå‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‡å‡†multipliesä»¿å‡½æ•°ç±»: // å»ºç«‹floatçš„å®¹å™¨ vector\u003cfloat\u003e vf; // è¿›è¡Œä¸€äº›æ“ä½œ ... // æŠŠproductè®¾ä¸ºå¯¹vfä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ï¼Œ multiplies\u003cfloat\u003eçš„ç»“æœï¼Œç”¨1.0fä½œä¸ºåˆå§‹ç»Ÿè®¡å€¼ float product = accumulate(vf.begin(), vf.end(),1.0f, multiplies\u003cfloat\u003e()); // è¿™é‡Œå”¯ä¸€éœ€è¦å°å¿ƒçš„ä¸œè¥¿æ˜¯è®°å¾—æŠŠ1.0fä½œä¸ºåˆå§‹ç»Ÿè®¡å€¼ï¼Œè€Œä¸æ˜¯0ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨0ä½œä¸ºå¼€å§‹å€¼ï¼Œç»“æœä¼šæ€»æ˜¯0ï¼Œå› ä¸º0ä¹˜ä»¥ä»»ä½•ä¸œè¥¿ä¹Ÿæ˜¯0ã€‚ å¯»æ‰¾pointçš„åŒºé—´çš„å¹³å‡å€¼ å¯»æ‰¾pointçš„åŒºé—´çš„å¹³å‡å€¼ï¼Œpointçœ‹èµ·æ¥åƒè¿™æ ·: struct Point { Point(double initX, double initY): x(initX), y(initY) {} double x, y; }; æ±‚å’Œå‡½æ•°åº”è¯¥æ˜¯ä¸€ä¸ªå«åšPointAverageçš„ä»¿å‡½æ•°ç±»çš„å¯¹è±¡ï¼Œä½†åœ¨æˆ‘ä»¬å¯Ÿçœ‹PointAverageä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒåœ¨è°ƒç”¨accumulateä¸­çš„ä½¿ç”¨æ–¹æ³•ï¼š list\u003cPoint\u003e lp; ... // å¯¹Ipä¸­çš„pointæ±‚å¹³å‡å€¼ Point avg = accumulate(lp.begin(), lp.end(), Point(0, 0), PointAverage()); åˆå§‹å’Œå€¼æ˜¯åœ¨åŸç‚¹çš„pointå¯¹è±¡ï¼Œæˆ‘ä»¬éœ€è¦è®°å¾—çš„æ˜¯å½“è®¡ç®—åŒºé—´çš„å¹³å‡å€¼æ—¶ä¸è¦è€ƒè™‘é‚£ä¸ªç‚¹ã€‚ PointAverageé€šè¿‡è®°å½•å®ƒçœ‹åˆ°çš„pointçš„ä¸ªæ•°å’Œå®ƒä»¬xå’Œyéƒ¨åˆ†çš„å’Œçš„æ¥å·¥ä½œã€‚æ¯æ¬¡è°ƒç”¨æ—¶ï¼Œå®ƒæ›´æ–°é‚£äº›å€¼å¹¶è¿”å›ç›®å‰æ£€æŸ¥è¿‡çš„pointçš„å¹³å‡åæ ‡ï¼Œå› ä¸ºå®ƒå¯¹äºåŒºé—´ä¸­çš„æ¯ä¸ªç‚¹åªè°ƒç”¨ä¸€æ¬¡ï¼Œå®ƒæŠŠxä¸yçš„å’Œé™¤ä»¥åŒºé—´ä¸­çš„pointçš„ä¸ªæ•°ï¼Œå¿½ç•¥ä¼ ç»™accumulateçš„åˆå§‹pointå€¼ï¼Œå®ƒå°±åº”è¯¥æ˜¯è¿™æ ·ï¼š class PointAverage : public binary_function\u003cPoint, Point, Point\u003e { public: PointAverage() : numPoints(0), xSum(0), ySum(0) {} const Point operator()(const Point\u0026 avgSoFar, const Point\u0026 p) { ++numPoints; xSum += p.x; ySum += p.y; return Point(xSum / numPoints, ySum / numPoints); } private: size_t numPoints; double xSum; double ySum; }; æˆå‘˜å˜é‡numPointsã€xSumå’ŒySumçš„ä¿®æ”¹é€ æˆäº†ä¸€ä¸ªå‰¯ä½œç”¨ï¼Œæ‰€ä»¥ï¼ŒæŠ€æœ¯ä¸Šè®²ï¼Œä¸Šè¿°ä¾‹å­å±•ç¤ºçš„ä»£ç ä¼šå¯¼è‡´ç»“æœæœªå®šä¹‰ã€‚ ","date":"2023-09-02","objectID":"/posts/clause_37/:2:0","tags":["Effective STL"],"title":"Effective STL [37] | ç”¨accumulateæˆ–for_eachæ¥ç»Ÿè®¡åŒºé—´","uri":"/posts/clause_37/"},{"categories":["C++"],"content":"for_each for_eachå¸¦æœ‰ä¸€ä¸ªåŒºé—´å’Œä¸€ä¸ªå‡½æ•°ï¼ˆä¸€èˆ¬æ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼‰æ¥è°ƒç”¨åŒºé—´ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œä½†ä¼ ç»™for_eachçš„å‡½æ•°åªæ¥æ”¶ä¸€ä¸ªå®å‚ï¼ˆå½“å‰çš„åŒºé—´å…ƒç´ ï¼‰ï¼Œè€Œä¸”å½“å®Œæˆæ—¶for_eachè¿”å›å®ƒçš„å‡½æ•°ã€‚ï¼ˆå®é™…ä¸Šï¼Œå®ƒè¿”å›å®ƒçš„å‡½æ•°çš„ä¸€ä¸ªæ‹·è´ã€‚ é¦–å…ˆï¼Œaccumulateçš„åå­—è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªäº§ç”ŸåŒºé—´ç»Ÿè®¡çš„ç®—æ³•ï¼Œfor_eachå¬èµ·æ¥å¥½åƒä½ åªæ˜¯è¦å¯¹åŒºé—´çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œä¸€äº›æ“ä½œã€‚ ç”¨for_eachæ¥ç»Ÿè®¡ä¸€ä¸ªåŒºé—´æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰accumulateæ¸…æ¥šã€‚ accumulateç›´æ¥è¿”å›é‚£äº›æˆ‘ä»¬æƒ³è¦çš„ç»Ÿè®¡å€¼ï¼Œè€Œfor_eachè¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œæˆ‘ä»¬å¿…é¡»ä»è¿™ä¸ªå¯¹è±¡ä¸­æå–æƒ³è¦çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ åœ¨C++é‡Œï¼Œé‚£æ„å‘³ç€æˆ‘ä»¬å¿…é¡»ç»™ä»¿å‡½æ•°ç±»æ·»åŠ ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œè®©æˆ‘ä»¬æ‰¾å›æˆ‘ä»¬è¿½æ±‚çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ struct Point {...}; // åŒä¸Š class PointAverage : public unary_function\u003cPoint, void\u003e { // å‚è§æ¡æ¬¾40 public: PointAverage() : xSum(0), ySum(0), numPoints(0) {} void operator()(const Point\u0026 p) { ++numPoints; xSum += p.x; ySum += p.y; } Point result() const { return Point(xSum / numPoints, ySum / numPoints); } private: size_t numPoints; double xSum; double ySum; }; list\u003cPoint\u003e lp; Point avg = for_each(lp.begin(), lp.end(), PointAverage()).result; å°±ä¸ªäººæ¥è¯´ï¼Œæˆ‘æ›´å–œæ¬¢ç”¨accumulateæ¥ç»Ÿè®¡ï¼Œå› ä¸ºæˆ‘è®¤ä¸ºå®ƒæœ€æ¸…æ¥šåœ°è¡¨è¾¾äº†æ­£åœ¨åšä»€ä¹ˆï¼Œä½†æ˜¯for_eachä¹Ÿå¯ä»¥ï¼Œè€Œä¸”ä¸åƒaccumulateï¼Œå‰¯ä½œç”¨çš„é—®é¢˜å¹¶ä¸è·Ÿéšfor_eachã€‚ ","date":"2023-09-02","objectID":"/posts/clause_37/:3:0","tags":["Effective STL"],"title":"Effective STL [37] | ç”¨accumulateæˆ–for_eachæ¥ç»Ÿè®¡åŒºé—´","uri":"/posts/clause_37/"},{"categories":["C++"],"content":"å‰è¨€ Effective-STLæ€»ç»“ç³»åˆ—åˆ†ä¸ºä¸ƒéƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬ä¸€éƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬ä¸€ç« ï¼Œå†…å®¹èŒƒå›´Rule01~12ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule12ç®€å†™ä¸ºR12ã€‚ Effective-STLç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››) ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:0:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R01 æ…é‡é€‰æ‹©å®¹å™¨ç±»å‹ STL å®¹å™¨ä¸æ˜¯ç®€å•çš„å¥½ï¼Œè€Œæ˜¯ç¡®å®å¾ˆå¥½ã€‚ å®¹å™¨ç±»å‹å¦‚ä¸‹ï¼š æ ‡å‡† STL åºåˆ—å®¹å™¨ï¼švectorã€stringã€dequeã€listã€‚ æ ‡å‡† STL å…³è”å®¹å™¨ï¼šsetã€multisetã€mapã€multimapã€‚ éæ ‡å‡†åºåˆ—å®¹å™¨ slist å’Œ ropeã€‚slist æ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œrope æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª â€œé‡å‹â€ stringã€‚ éæ ‡å‡†çš„å…³è”å®¹å™¨ï¼šhash_setã€hash_multisetã€hash_mapã€hash_multimapã€‚ vector ä½œä¸º string çš„æ›¿ä»£ã€‚ vector ä½œä¸ºæ ‡å‡†å…³è”å®¹å™¨çš„æ›¿ä»£ï¼šæœ‰æ—¶ vector åœ¨è¿è¡Œæ—¶é—´å’Œç©ºé—´ä¸Šéƒ½è¦ä¼˜äºæ ‡å‡†å…³è”å®¹å™¨ã€‚ å‡ ç§æ ‡å‡†çš„é STL å®¹å™¨ï¼šarrayã€bitsetã€valarrayã€stackã€queueã€priority_queueã€‚ å®¹å™¨é€‰æ‹©æ ‡å‡†: vectorã€listå’Œdequeæœ‰ç€ä¸åŒçš„å¤æ‚åº¦ï¼Œvectoræ˜¯é»˜è®¤ä½¿ç”¨çš„åºåˆ—ç±»å‹ã€‚å½“éœ€è¦é¢‘ç¹åœ¨åºåˆ—ä¸­é—´åšæ’å…¥å’Œåˆ é™¤æ“ä½œæ—¶ï¼Œåº”ä½¿ç”¨listã€‚å½“å¤§å¤šæ•°æ’å…¥å’Œåˆ é™¤æ“ä½œå‘ç”Ÿåœ¨åºåˆ—çš„å¤´éƒ¨å’Œå°¾éƒ¨æ—¶ï¼Œåº”ä½¿ç”¨dequeã€‚ å¯ä»¥å°†å®¹å™¨åˆ†ä¸ºè¿ç»­å†…å­˜å®¹å™¨å’ŒåŸºäºèŠ‚ç‚¹çš„å®¹å™¨ä¸¤ç±»ã€‚è¿ç»­å†…å­˜å®¹å™¨æŠŠå…ƒç´ å­˜æ”¾åœ¨ä¸€å—æˆ–å¤šå—(åŠ¨æ€åˆ†é…çš„)å†…å­˜ä¸­ï¼Œå½“æœ‰æ–°å…ƒç´ æ’å…¥æˆ–å·²æœ‰çš„å…ƒç´ è¢«åˆ é™¤æ—¶ï¼ŒåŒä¸€å—å†…å­˜ä¸­çš„å…¶ä»–å…ƒç´ è¦å‘å‰æˆ–å‘åç§»åŠ¨ï¼Œä»¥ä¾¿ä¸ºæ–°å…ƒç´ è®©å‡ºç©ºé—´ï¼Œæˆ–è€…æ˜¯å¡«å……è¢«åˆ é™¤å…ƒç´ æ‰€ç•™ä¸‹çš„ç©ºéš™ã€‚è¿™ç§ç§»åŠ¨ä¼šå½±å“åˆ°æ•ˆç‡å’Œå¼‚å¸¸å®‰å…¨æ€§ã€‚æ ‡å‡†çš„è¿ç»­å†…å­˜å®¹å™¨æœ‰vectorã€stringå’Œdequeï¼Œéæ ‡å‡†çš„æœ‰ropeã€‚ åŸºäºèŠ‚ç‚¹çš„å®¹å™¨åœ¨æ¯ä¸€ä¸ª(åŠ¨æ€åˆ†é…çš„)å†…å­˜å—ä¸­åªå­˜æ”¾ä¸€ä¸ªå…ƒç´ ã€‚å®¹å™¨ä¸­å…ƒç´ çš„æ’å…¥æˆ–åˆ é™¤åªå½±å“æŒ‡å‘èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œè€Œä¸å½±å“èŠ‚ç‚¹æœ¬èº«ï¼Œæ‰€ä»¥æ’å…¥æˆ–åˆ é™¤æ“ä½œæ—¶å…ƒç´ æ˜¯ä¸éœ€è¦ç§»åŠ¨çš„ã€‚é“¾è¡¨å®ç°çš„å®¹å™¨listå’Œslistæ˜¯åŸºäºèŠ‚ç‚¹çš„ï¼Œæ ‡å‡†å…³è”å®¹å™¨ä¹Ÿæ˜¯(é€šå¸¸çš„å®ç°æ–¹å¼æ˜¯å¹³è¡¡æ ‘)ï¼Œéæ ‡å‡†çš„å“ˆå¸Œå®¹å™¨ä½¿ç”¨ä¸åŒçš„åŸºäºèŠ‚ç‚¹çš„å®ç°ã€‚ æ˜¯å¦éœ€è¦åœ¨å®¹å™¨çš„ä»»æ„ä½ç½®æ’å…¥æ–°å…ƒç´ ï¼Ÿéœ€è¦åˆ™é€‰æ‹©åºåˆ—å®¹å™¨ï¼Œå…³è”å®¹å™¨æ˜¯ä¸è¡Œçš„ã€‚ æ˜¯å¦å…³å¿ƒå®¹å™¨ä¸­çš„å…ƒç´ æ˜¯å¦‚ä½•æ’åºçš„ï¼Ÿå¦‚æœä¸å…³å¿ƒï¼Œå¯ä»¥é€‰æ‹©å“ˆå¸Œå®¹å™¨ï¼Œå¦åˆ™ä¸èƒ½é€‰å“ˆå¸Œå®¹å™¨(unordered)ã€‚ éœ€è¦å“ªç§ç±»å‹çš„è¿­ä»£å™¨ï¼Ÿå¦‚æœæ˜¯éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œé‚£å°±åªèƒ½é€‰æ‹©vectorã€dequeå’Œstringã€‚å¦‚æœä½¿ç”¨åŒå‘è¿­ä»£å™¨ï¼Œé‚£ä¹ˆå°±ä¸èƒ½é€‰slistå’Œå“ˆå¸Œå®¹å™¨ã€‚ æ˜¯å¦å¸Œæœ›åœ¨æ’å…¥æˆ–åˆ é™¤å…ƒç´ æ—¶é¿å…ç§»åŠ¨å…ƒç´ ï¼Ÿå¦‚æœæ˜¯ï¼Œåˆ™ä¸èƒ½é€‰æ‹©è¿ç»­å†…å­˜çš„å®¹å™¨ã€‚ å®¹å™¨çš„æ•°æ®å¸ƒå±€æ˜¯å¦éœ€è¦å’ŒCå…¼å®¹ï¼Ÿå¦‚æœéœ€è¦åªèƒ½é€‰vectorã€‚ å…ƒç´ çš„æŸ¥æ‰¾é€Ÿåº¦æ˜¯å¦æ˜¯å…³é”®çš„è€ƒè™‘å› ç´ ï¼Ÿå¦‚æœæ˜¯å°±è€ƒè™‘å“ˆå¸Œå®¹å™¨ã€æ’åºçš„vectorå’Œæ ‡å‡†å…³è”å®¹å™¨ã€‚ æ˜¯å¦ä»‹æ„å®¹å™¨å†…éƒ¨ä½¿ç”¨å¼•ç”¨è®¡æ•°æŠ€æœ¯ï¼Œå¦‚æœæ˜¯åˆ™é¿å…ä½¿ç”¨stringï¼Œå› ä¸ºstringçš„å®ç°å¤§å¤šä½¿ç”¨äº†å¼•ç”¨è®¡æ•°ï¼Œå¯ä»¥è€ƒè™‘ç”¨vector\u003cchar\u003eæ›¿ä»£ã€‚ å¯¹æ’å…¥å’Œåˆ é™¤æ“ä½œéœ€è¦æä¾›äº‹åŠ¡è¯­ä¹‰å—ï¼Ÿå°±æ˜¯è¯´åœ¨æ’å…¥å’Œåˆ é™¤æ“ä½œå¤±è´¥æ—¶ï¼Œéœ€è¦å›æ»šçš„èƒ½åŠ›å—ï¼Ÿå¦‚æœéœ€è¦åˆ™ä½¿ç”¨åŸºäºèŠ‚ç‚¹çš„å®¹å™¨ã€‚å¦‚æœæ˜¯å¯¹å¤šä¸ªå…ƒç´ çš„æ’å…¥æ“ä½œ(é’ˆå¯¹åŒºé—´)éœ€è¦äº‹åŠ¡è¯­ä¹‰ï¼Œåˆ™éœ€è¦é€‰æ‹©listï¼Œå› ä¸ºåœ¨æ ‡å‡†å®¹å™¨ä¸­ï¼Œåªæœ‰listå¯¹å¤šä¸ªå…ƒç´ çš„æ’å…¥æ“ä½œæä¾›äº†äº‹åŠ¡è¯­ä¹‰ã€‚å¯¹å¸Œæœ›ç¼–å†™å¼‚å¸¸å®‰å…¨ä»£ç çš„ç¨‹åºå‘˜ï¼Œäº‹åŠ¡è¯­ä¹‰å°¤ä¸ºé‡è¦ã€‚ä½¿ç”¨è¿ç»­å†…å­˜çš„å®¹å™¨ä¹Ÿå¯ä»¥è·å¾—äº‹åŠ¡è¯­ä¹‰ï¼Œä½†æ˜¯è¦ä»˜å‡ºæ€§èƒ½ä¸Šçš„ä»£ä»·ï¼Œè€Œä¸”ä»£ç ä¹Ÿä¸é‚£ä¹ˆç›´æˆªäº†å½“ã€‚ éœ€è¦ä½¿è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å˜ä¸ºæ— æ•ˆçš„æ¬¡æ•°æœ€å°‘å—ï¼Ÿå¦‚æœæ˜¯åˆ™é€‰æ‹©åŸºäºèŠ‚ç‚¹çš„å®¹å™¨ï¼Œå› ä¸ºå¯¹è¿™ç±»å®¹å™¨çš„æ’å…¥å’Œåˆ é™¤æ“ä½œä»æ¥ä¸ä¼šä½¿è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å˜æˆæ— æ•ˆ(é™¤éå®ƒä»¬æŒ‡å‘ä¸€ä¸ªæ­£åœ¨åˆ é™¤çš„å…ƒç´ )ã€‚è€Œå¯¹è¿ç»­å†…å­˜å®¹å™¨çš„æ’å…¥å’Œåˆ é™¤ä¸€èˆ¬ä¼šä½¿å¾—æŒ‡å‘è¯¥å®¹å™¨çš„è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å˜ä¸ºæ— æ•ˆã€‚ ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:1:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R02 ä¸è¦è¯•å›¾ç¼–å†™ç‹¬ç«‹äºå®¹å™¨ç±»å‹çš„ä»£ç  å®¹å™¨æ˜¯ä»¥ç±»å‹ä½œä¸ºå‚æ•°çš„ï¼Œè€Œè¯•å›¾æŠŠå®¹å™¨æœ¬èº«ä½œä¸ºå‚æ•°ï¼Œå†™å‡ºç‹¬ç«‹äºå®¹å™¨ç±»å‹çš„ä»£ç æ˜¯ä¸å¯èƒ½å®ç°çš„ã€‚å› ä¸ºä¸åŒçš„å®¹å™¨æ”¯æŒçš„æ“ä½œæ˜¯ä¸åŒçš„ï¼Œå³ä½¿æ“ä½œæ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å®ç°åˆæ˜¯ä¸åŒçš„ï¼Œæ¯”å¦‚å¸¦æœ‰ä¸€ä¸ªè¿­ä»£å™¨å‚æ•°çš„eraseä½œç”¨äºåºåˆ—å®¹å™¨æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ï¼Œä½†ä½œç”¨äºå…³è”å®¹å™¨åˆ™æ²¡æœ‰è¿”å›å€¼ã€‚è¿™äº›é™åˆ¶çš„æ ¹æºåœ¨äºï¼Œå¯¹äºä¸åŒç±»å‹çš„åºåˆ—å®¹å™¨ï¼Œä½¿è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨æ— æ•ˆçš„è§„åˆ™æ˜¯ä¸åŒçš„ã€‚ æœ‰æ—¶å€™ä¸å¯é¿å…è¦ä»ä¸€ä¸ªå®¹å™¨ç±»å‹è½¬åˆ°å¦ä¸€ç§ï¼Œå¯ä»¥ä½¿ç”¨å°è£…æŠ€æœ¯æ¥å®ç°ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯å¯¹å®¹å™¨ç±»å‹å’Œå…¶è¿­ä»£å™¨ç±»å‹ä½¿ç”¨typedefï¼Œå¦‚typedef vector\u003cWidget\u003e widgetContainer; typedef widgetContainer::iterator WCIterator; å¦‚æœæƒ³å‡å°‘åœ¨æ›¿æ¢å®¹å™¨ç±»å‹æ—¶æ‰€éœ€è¦ä¿®æ”¹çš„ä»£ç ï¼Œå¯ä»¥æŠŠå®¹å™¨éšè—åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œå¹¶å°½é‡å‡å°‘é‚£äº›é€šè¿‡ç±»æ¥å£å¯è§çš„ã€ä¸å®¹å™¨æœ‰å…³çš„ä¿¡æ¯ã€‚ ä¸€ç§å®¹å™¨ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§å®¹å™¨ç±»å‹ï¼štypedef class Widget{...}; typedef vector\u003cWidget\u003e WidgetContainer; WidgetContainer cw; Widget bestWidget; ... WidgetContainer::iterator i = find(cw.begin(), cw.end(), bestWidget); è¿™æ ·å°±ä½¿å¾—æ”¹å˜å®¹å™¨ç±»å‹è¦å®¹æ˜“å¾—å¤šï¼Œå°¤å…¶å½“è¿™ç§æ”¹å˜ä»…ä»…æ˜¯å¢åŠ ä¸€ä¸ªè‡ªå®šä¹‰å¾—åˆ†é…å­æ—¶ï¼Œå°±æ˜¾å¾—æ›´ä¸ºæ–¹ä¾¿ï¼ˆè¿™ä¸€æ”¹å˜ä¸å½±å“ä½¿è¿­ä»£å™¨/æŒ‡é’ˆ/å¼•ç”¨æ— æ•ˆçš„è§„åˆ™ï¼‰ã€‚ ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:2:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R03 ç¡®ä¿å®¹å™¨ä¸­çš„å¯¹è±¡æ‹·è´æ­£ç¡®è€Œé«˜æ•ˆ å­˜åœ¨ç»§æ‰¿å…³ç³»çš„æƒ…å†µä¸‹ï¼Œæ‹·è´åŠ¨ä½œä¼šå¯¼è‡´å‰¥ç¦»ï¼ˆslicingï¼‰: å¦‚æœåˆ›å»ºäº†ä¸€ä¸ªå­˜æ”¾åŸºç±»å¯¹è±¡çš„å®¹å™¨ï¼Œå´å‘å…¶ä¸­æ’å…¥æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œé‚£ä¹ˆåœ¨æ´¾ç”Ÿç±»å¯¹è±¡ï¼ˆé€šè¿‡åŸºç±»çš„æ‹·è´æ„é€ å‡½æ•°ï¼‰è¢«æ‹·è´è¿›å®¹å™¨æ—¶ï¼Œå®ƒæ‰€ç‰¹æœ‰çš„éƒ¨åˆ†ï¼ˆå³æ´¾ç”Ÿç±»ä¸­çš„ä¿¡æ¯ï¼‰å°†ä¼šä¸¢å¤±ã€‚ vector\u003cWidget\u003e vw; class SpecialWidget: // SpecialWidget ç»§æ‰¿äºä¸Šé¢çš„ Widget public Widget{...}; SpecialWidget sw; vw.push_back(); // sw ä½œä¸ºåŸºç±»å¯¹è±¡è¢«æ‹·è´è¿› vw ä¸­ // å®ƒçš„æ´¾ç”Ÿç±»ç‰¹æœ‰éƒ¨åˆ†åœ¨æ‹·è´æ—¶è¢«ä¸¢æ‰äº† å‰¥ç¦»æ„å‘³ç€å‘åŸºç±»å¯¹è±¡ä¸­çš„å®¹å™¨ä¸­æ’å…¥æ´¾ç”Ÿç±»å¯¹è±¡å‡ ä¹æ€»æ˜¯é”™è¯¯çš„ã€‚ è§£å†³å‰¥ç¦»é—®é¢˜çš„ç®€å•æ–¹æ³•ï¼šä½¿å®¹å™¨åŒ…å«æŒ‡é’ˆè€Œä¸æ˜¯å¯¹è±¡ã€‚ å®¹å™¨ä¸­ä¿å­˜çš„å¯¹è±¡ï¼Œå¹¶ä¸æ˜¯ä½ æä¾›ç»™å®¹å™¨çš„é‚£äº›å¯¹è±¡ã€‚ä»å®¹å™¨ä¸­å–å‡ºå¯¹è±¡æ—¶ï¼Œä¹Ÿä¸æ˜¯å®¹å™¨ä¸­ä¿å­˜çš„é‚£ä»½å¯¹è±¡ã€‚å½“é€šè¿‡å¦‚insertæˆ–push_backä¹‹ç±»çš„æ“ä½œå‘å®¹å™¨ä¸­åŠ å…¥å¯¹è±¡æ—¶ï¼Œå­˜å…¥å®¹å™¨çš„æ˜¯è¯¥å¯¹è±¡çš„æ‹·è´ã€‚å½“é€šè¿‡å¦‚frontæˆ–backä¹‹ç±»çš„æ“ä½œä»å®¹å™¨ä¸­ å–å‡ºå¯¹è±¡æ—¶ï¼Œæ‰€å¾—åˆ°çš„æ˜¯å®¹å™¨ä¸­å¯¹è±¡çš„æ‹·è´ã€‚è¿›å»ä¼šæ‹·è´ï¼Œå‡ºæ¥ä¹Ÿæ˜¯æ‹·è´ï¼Œè¿™å°±æ˜¯STLçš„å·¥ä½œæ–¹å¼ã€‚ å½“å¯¹è±¡è¢«ä¿å­˜åˆ°å®¹å™¨ä¸­ï¼Œå®ƒç»å¸¸ä¼šè¿›ä¸€æ­¥è¢«æ‹·è´ã€‚å½“å¯¹vectorã€stringæˆ–dequeè¿›è¡Œå…ƒç´ çš„æ’å…¥æˆ–åˆ é™¤æ—¶ï¼Œç°æœ‰å…ƒç´ çš„ä½ç½®é€šå¸¸ä¼šè¢«ç§»åŠ¨ï¼ˆæ‹·è´ï¼‰ã€‚å¦‚æœä½¿ç”¨ä¸‹åˆ—ä»»ä½•ç®—æ³•ï¼Œnext_permutationæˆ–previous_permutationï¼Œremoveã€uniqueï¼Œrotateæˆ–reverseç­‰ç­‰ï¼Œé‚£ä¹ˆå¯¹è±¡å°†ä¼šè¢«ç§»åŠ¨ï¼ˆæ‹·è´ï¼‰ï¼Œè¿™å°±æ˜¯STLçš„å·¥ä½œæ–¹å¼ã€‚ å¦‚æœå‘å®¹å™¨ä¸­å¡«å……çš„å¯¹è±¡æ‹·è´æ“ä½œå¾ˆè´¹æ—¶ï¼Œé‚£ä¹ˆå‘å®¹å™¨ä¸­å¡«å……å¯¹è±¡è¿™ä¸€ç®€å•æ“ä½œå°†ä¼šæˆä¸ºç¨‹åºçš„æ€§èƒ½ç“¶é¢ˆã€‚è€Œä¸”å¦‚æœè¿™äº›å¯¹è±¡çš„æ‹·è´æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œé‚£ä¹ˆæŠŠå®ƒä»¬æ”¾å…¥å®¹å™¨è¿˜å°†ä¸å¯é¿å…åœ°ä¼šäº§ç”Ÿé”™è¯¯ã€‚ å½“å­˜åœ¨ç»§æ‰¿å…³ç³»æ—¶ï¼Œæ‹·è´åŠ¨ä½œä¼šå¯¼è‡´å‰¥ç¦»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåˆ›å»ºäº†ä¸€ä¸ªå­˜æ”¾åŸºç±»å¯¹è±¡çš„å®¹å™¨ï¼Œå´å‘å…¶ä¸­æ’å…¥æ´¾ç”Ÿç±»çš„å¯¹è±¡ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»å¯¹è±¡ï¼ˆé€šè¿‡åŸºç±»çš„æ‹·è´æ„é€ å‡½æ•°ï¼‰è¢«æ‹·è´è¿›å®¹å™¨æ—¶ï¼Œå®ƒæ´¾ç”Ÿç±»çš„éƒ¨åˆ†å°†ä¼šä¸¢å¤±ã€‚ ä½¿æ‹·è´åŠ¨ä½œé«˜æ•ˆã€æ­£ç¡®ï¼Œå¹¶é˜²æ­¢å‰¥ç¦»é—®é¢˜å‘ç”Ÿçš„ä¸€ä¸ªç®€å•åŠæ³•å°±æ˜¯ä½¿å®¹å™¨åŒ…å«å¯¹è±¡æŒ‡é’ˆï¼Œè€Œä¸æ˜¯å¯¹è±¡æœ¬èº«ã€‚æ‹·è´æŒ‡é’ˆçš„é€Ÿåº¦éå¸¸å¿«ï¼Œè€Œä¸”æ€»æ˜¯ä¼šæŒ‰ä½ æœŸæœ›çš„æ–¹å¼è¿›è¡Œã€‚å¦‚æœè€ƒè™‘èµ„æºçš„é‡Šæ”¾ï¼Œæ™ºèƒ½æŒ‡é’ˆæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚ ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:3:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R04 è°ƒç”¨ empty è€Œä¸æ˜¯æ£€æŸ¥ size()æ˜¯å¦ä¸º0 empty é€šå¸¸è¢«å®ç°ä¸ºå†…è”å‡½æ•°ï¼ˆinline functionï¼‰ï¼Œå¹¶ä¸”å®ƒåšçš„ä»…ä»…æ˜¯è¿”å› size() æ˜¯å¦ä¸º 0. empty å¯¹æ‰€æœ‰æ ‡å‡†å®¹å™¨éƒ½æ˜¯å¸¸æ•°æ—¶é—´æ“ä½œï¼Œè€Œå¯¹äºä¸€äº› list å®ç°ï¼Œsize è€—è´¹çº¿æ€§æ—¶é—´ ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:4:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R05 åŒºé—´æˆå‘˜å‡½æ•°ä¼˜å…ˆäºä¸ä¹‹å¯¹åº”çš„å•å…ƒç´ æˆå‘˜å‡½æ•° åŒºé—´æˆå‘˜å‡½æ•°æ˜¯ä½¿ç”¨ä¸¤ä¸ªè¿­ä»£å™¨å‚æ•°æ¥ç¡®å®šæˆå‘˜æ“ä½œæ‰§è¡Œçš„åŒºé—´ï¼ŒåƒSTLç®—æ³•ä¸€æ ·ã€‚åŒºé—´æˆå‘˜å‡½æ•°å’Œforå¾ªç¯å¤„ç†å•å…ƒç´ æˆå‘˜å‡½æ•°åœ¨åŠŸèƒ½ä¸Šæ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯åœ¨æ•ˆç‡å’Œä»£ç æ¸…æ™°åº¦ä¸Šè¦æ›´èƒœä¸€ç­¹ã€‚å¦‚å°†ä¸€ä¸ªå…ƒç´ æ’å…¥åˆ°vectorä¸­ï¼Œè€Œå®ƒçš„å†…å­˜æ»¡äº†ï¼Œé‚£ä¹ˆvectorå°†ç”³è¯·æ›´å¤§å®¹é‡çš„å†…å®¹ï¼ŒæŠŠå®ƒçš„å…ƒç´ ä»æ—§å†…å­˜æ‹·è´åˆ°æ–°å†…å­˜ï¼Œé”€æ¯æ—§å†…å­˜ä¸­çš„å…ƒç´ ï¼Œå¹¶é‡Šæ”¾æ—§å†…å­˜ï¼Œå†æŠŠè¦æ’å…¥çš„å…ƒç´ æ’å…¥è¿›æ¥ï¼Œå› æ­¤æ’å…¥nä¸ªæ–°å…ƒç´ æœ€å¤šå¯å¯¼è‡´æ¬¡æ–°å†…å­˜çš„åˆ†é…ã€‚ å‡ ä¹æ‰€æœ‰é€šè¿‡æ’å…¥è¿­ä»£å™¨(å³åˆ©ç”¨inserterã€back_inserteræˆ–front_inserter)æ¥æ“ä½œç›®æ ‡åŒºé—´çš„copyè°ƒç”¨ï¼Œéƒ½å¯ä»¥åº”è¯¥è¢«æ›¿æ¢ä¸ºå¯¹åŒºé—´æˆå‘˜å‡½æ•°çš„è°ƒç”¨ã€‚ å¯¹äºåŒºé—´åˆ›å»ºï¼Œæ‰€æœ‰çš„æ ‡å‡†å®¹å™¨éƒ½æä¾›äº†å¦‚ä¸‹å½¢å¼çš„æ„é€ å‡½æ•°ï¼šcontainer::container(InputIterator begin, InputIterator end); å¯¹äºåŒºé—´æ’å…¥ï¼Œæ‰€æœ‰çš„æ ‡å‡†åºåˆ—å®¹å™¨éƒ½æä¾›äº†å¦‚ä¸‹å½¢å¼çš„insertï¼švoid container::insert(iterator position, InputIterator begin, InputIterator end);è¡¨ç¤ºåœ¨positionä½ç½®æ’å…¥beginåˆ°endçš„å…ƒç´ ã€‚å…³è”å®¹å™¨åˆ©ç”¨æ¯”è¾ƒå‡½æ•°å†³å®šå…ƒç´ çš„æ’å…¥ä½ç½®ï¼Œæ‰€ä»¥ä¸éœ€è¦æä¾›æ’å…¥ä½ç½®ï¼švoid container::insert(InputIterator begin, InputIterator end); å¯¹äºåŒºé—´åˆ é™¤ï¼Œæ‰€æœ‰çš„æ ‡å‡†å®¹å™¨éƒ½æä¾›äº†åŒºé—´å½¢å¼çš„eraseæ“ä½œï¼Œä½†æ˜¯å¯¹äºåºåˆ—å®¹å™¨å’Œå…³è”å®¹å™¨ï¼Œå…¶è¿”å›å€¼ä¸åŒã€‚åºåˆ—å®¹å™¨æä¾›äº†å¦‚ä¸‹çš„å½¢å¼ï¼šiterator container::erase(iterator begin, iterator end);è€Œå…³è”å®¹å™¨åˆ™æä¾›äº†å¦‚ä¸‹å½¢å¼ï¼švoid container::erase(iterator begin, iterator end);ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§åŒºåˆ«å‘¢ï¼Ÿæ®è¯´æ˜¯å…³è”å®¹å™¨çš„eraseå¦‚æœè¿”å›è¿­ä»£å™¨ï¼ˆæŒ‡å‘è¢«åˆ é™¤å…ƒç´ ä¹‹åçš„å…ƒç´ ï¼‰ä¼šå¯¼è‡´ä¸å¯æ¥å—çš„æ€§èƒ½è´Ÿæ‹…ã€‚ å¯¹äºåŒºé—´èµ‹å€¼ï¼Œæ‰€æœ‰çš„æ ‡å‡†å®¹å™¨éƒ½æä¾›äº†åŒºé—´å½¢å¼çš„assignï¼švoid container::assign(InputIterator begin, InputIterator end); ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:5:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R06 å½“å¿ƒC++ç¼–è¯‘å™¨æœ€çƒ¦äººçš„åˆ†ææœºåˆ¶ åˆ†æè¿™æ ·ä¸€æ®µç¨‹åºï¼šæœ‰ä¸€ä¸ªå­˜æœ‰æ•´æ•°çš„æ–‡ä»¶ï¼Œä½ æƒ³æŠŠè¿™äº›æ•´æ•°æ‹·è´åˆ°ä¸€ä¸ªlistä¸­ ifstream dataFile(\"ints.dat\"); list\u003cint\u003e data(istream_iterator\u003cint\u003e(dataFile), istream_iterator\u003cint\u003e());//å°å¿ƒï¼ç»“æœä¸ä¼šæ˜¯ä½ æœŸæœ›çš„é‚£æ · è¿™æ ·åšçš„æ€è·¯æ˜¯æŠŠä¸€å¯¹istream_iteratorä¼ å…¥åˆ°listçš„åŒºé—´æ„é€ å‡½æ•°ï¼Œä»è€ŒæŠŠæ–‡ä»¶ä¸­çš„æ•´æ•°æ‹·è´åˆ°listä¸­ï¼Œè¿™æ®µä»£ç å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯åœ¨è¿è¡Œæ—¶ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œå®ƒä¹Ÿä¸ä¼šåˆ›å»ºlistï¼Œè¿™æ˜¯å› ä¸ºç¬¬äºŒæ¡è¯­å¥å¹¶æ²¡æœ‰å£°æ˜åˆ›å»ºä¸€ä¸ªlistã€‚ ä»æœ€åŸºæœ¬çš„è¯´èµ·ï¼Œint f(double d);å£°æ˜äº†ä¸€ä¸ªæ¥æ”¶doubleå‚æ•°ï¼Œè¿”å›intçš„å‡½æ•°ï¼Œä¸‹é¢ä¸¤ç§å½¢å¼æ˜¯åšäº†åŒæ ·çš„äº‹ï¼šint f(double (d));è¿˜æœ‰int f(double);å†çœ‹int g(double (*pf)());å£°æ˜äº†ä¸€ä¸ªå‡½æ•°gï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œè¿™ä¸ªå‡½æ•°æŒ‡é’ˆä¸æ¥å—å‚æ•°ï¼Œè¿”å›å€¼æ˜¯doubleï¼Œä¸‹é¢ä¸¤ç§å½¢å¼åŒæ ·æ˜¯åšäº†è¿™æ ·çš„äº‹ï¼Œint g(double pf());è¿˜æœ‰int g(double ())ï¼Œç¬¬ä¸‰ç§å½¢å¼çœç•¥äº†å‡½æ•°åï¼Œdoubleåæœ‰ä¸€ä¸ªç©ºæ ¼å’Œ()ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚ å†æ¥çœ‹æœ€å¼€å§‹çš„ä¾‹å­ï¼Œç¬¬äºŒè¡Œå…¶å®ä¸æ˜¯å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œè€Œæ˜¯å£°æ˜äº†ä¸€ä¸ªå‡½æ•°ï¼Œå…¶è¿”å›å€¼æ˜¯listï¼Œç¬¬ä¸€ä¸ªå‚æ•°åç§°æ˜¯dataFileï¼Œç±»å‹æ˜¯istream_iteratorï¼ŒdataFileä¸¤è¾¹çš„æ‹¬å·æ˜¯å¤šä½™çš„ï¼Œä¼šè¢«å¿½ç•¥ã€‚ç¬¬äºŒä¸ªå‚æ•°æ²¡æœ‰åç§°ï¼Œç±»å‹æ˜¯æŒ‡å‘ä¸å¸¦å‚æ•°çš„å‡½æ•°çš„æŒ‡é’ˆï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªistream_iteratorã€‚ è¿™ç¬¦åˆC++ä¸­ä¸€ä¸ªæ™®éè§„å¾‹ï¼Œå°½å¯èƒ½åœ°è§£é‡Šä¸ºå‡½æ•°å£°æ˜ï¼Œæ¯”å¦‚è¿™æ ·ä¸€æ®µä»£ç ï¼Œclass Widget{ ... }; Widget w();å®ƒå¹¶æ²¡æœ‰å£°æ˜ä¸€ä¸ªWidgetç±»å‹çš„å¯¹è±¡wï¼Œè€Œæ˜¯å£°æ˜äº†ä¸€ä¸ªåä¸ºwçš„å‡½æ•°ã€‚å­¦ä¼šè¯†åˆ«è¿™ç±»è¨€ä¸è¾¾æ„æ˜¯æˆä¸ºC++ç¨‹åºå‘˜çš„å¿…ç»ä¹‹è·¯ã€‚ è€Œä¸ºäº†å®ç°æœ€å¼€å§‹é‚£æ®µä»£ç æƒ³è¦å®ç°çš„åŠŸèƒ½ï¼Œå¯ä»¥ä¸ºç¬¬ä¸€ä¸ªå‚æ•°å‚æ•°åŠ ä¸Šä¸€å¯¹æ‹¬å·ï¼Œå³list\u003cint\u003e data((istream_iterator\u003cint\u003e(dataFile)), istream_iterator\u003cint\u003e());ä¸å¹¸åœ°æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ç¼–è¯‘å™¨éƒ½çŸ¥é“è¿™ä¸€ç‚¹ï¼Œå‡ ä¹æœ‰ä¸€åŠéƒ½ä¼šæ‹’ç»ä¸Šè¿°æ­£ç¡®çš„å£°æ˜å½¢å¼ï¼Œè€Œæ¥æ”¶æœ€å¼€å§‹é”™è¯¯çš„å£°æ˜å½¢å¼ã€‚æ›´å¥½çš„æ–¹å¼æ˜¯åœ¨dataå£°æ˜ä¸­é¿å…ä½¿ç”¨åŒ¿åçš„istream_iteratorå¯¹è±¡ï¼Œå°†é‚£å¥ä»£ç åˆ†æˆä¸‰å¥æ¥å†™ã€‚ ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:6:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R07 å¦‚æœå®¹å™¨ä¸­åŒ…å«äº†é€šè¿‡newæ“ä½œåˆ›å»ºçš„æŒ‡é’ˆï¼Œåˆ‡è®°åœ¨å®¹å™¨å¯¹è±¡ææ„å‰å°†æŒ‡é’ˆdeleteæ‰ STLå®¹å™¨å¾ˆæ™ºèƒ½ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ™ºèƒ½åˆ°çŸ¥é“æ˜¯å¦è¯¥é‡Šæ”¾è‡ªå·±æ‰€åŒ…å«çš„æŒ‡é’ˆçš„ç¨‹åº¦ã€‚å½“ä½ ä½¿ç”¨æŒ‡é’ˆçš„å®¹å™¨ï¼Œè€Œå…¶ä¸­çš„æŒ‡é’ˆåº”è¯¥è¢«åˆ é™¤æ—¶ï¼Œä¸ºäº†é¿å…èµ„æºæ³„éœ²ï¼Œä½ åº”è¯¥ä½¿ç”¨å¼•ç”¨è®¡æ•°å½¢å¼çš„æ™ºèƒ½æŒ‡é’ˆï¼ˆå¦‚shared_ptrï¼‰ä»£æ›¿æŒ‡é’ˆï¼ˆæ™®é€šæŒ‡é’ˆä¸å…·æœ‰å¼‚å¸¸å®‰å…¨æ€§ï¼‰ï¼Œæˆ–è€…å½“å®¹å™¨è¢«ææ„æ—¶æ‰‹åŠ¨åˆ é™¤å…¶ä¸­çš„æ¯ä¸ªæŒ‡é’ˆã€‚ åˆ†æä¸‹é¢çš„ä»£ç ï¼š void doSomething(){ vector\u003cWidget*\u003e vwp; for(int i=0; i\u003cn; ++i){ vwp.push_back(new Widget); } } å½“vwpçš„ä½œç”¨åŸŸç»“æŸï¼Œå…¶ä¸­çš„æŒ‡é’ˆå¹¶æ²¡æœ‰é‡Šæ”¾ï¼Œé€ æˆäº†èµ„æºæ³„éœ²ã€‚å¦‚æœå¸Œæœ›å®ƒä»¬è¢«åˆ é™¤ï¼Œä½ å¯èƒ½ä¼šå†™å‡ºå¦‚ä¸‹çš„ä»£ç ï¼š void doSomething(){ vector\u003cWidget*\u003e vwp; for(int i=0; i\u003cn; ++i){ vwp.push_back(new Widget); } //do something for(auto i=vwp.begin(); i!=vwp.end(); ++i){ delete *i; } } è¿™æ ·ç¡®å®å¯ä»¥ï¼Œåªè¦ä½ ä¸å¤ªæŒ‘å‰”çš„è¯ã€‚ä¸€ä¸ªé—®é¢˜æ˜¯è¿™æ®µä»£ç åšçš„äº‹æƒ…å’Œfor_eachç›¸åŒï¼Œä½†æ˜¯ä¸å¦‚for_eachæ›´æ¸…æ™°ï¼Œå¦ä¸€ä¸ªé—®é¢˜æ˜¯è¿™æ®µä»£ç ä¸æ˜¯å¼‚å¸¸å®‰å…¨çš„ã€‚å¦‚æœåœ¨vwpå¡«å……æŒ‡é’ˆå’Œä»å…¶ä¸­åˆ é™¤æŒ‡é’ˆçš„è¿‡ç¨‹ä¸­æœ‰å¼‚å¸¸æŠ›å‡ºçš„è¯ï¼ŒåŒæ ·ä¼šæœ‰èµ„æºæ³„éœ²ã€‚ä¸‹é¢å°±è¦å…‹æœè¿™ä¸¤ä¸ªé—®é¢˜ã€‚ é¦–å…ˆä½¿ç”¨for_eachæ›¿æ¢ä¸Šé¢çš„forå¾ªç¯ï¼Œä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œéœ€è¦æŠŠdeleteå˜æˆä¸€ä¸ªå‡½æ•°å¯¹è±¡ã€‚ template \u003ctypename T\u003e struct DeleteObject : public unary_function\u003cconst T*, void\u003e{//æ¡æ¬¾40ä¼šè§£é‡Šä¸ºä»€ä¹ˆæœ‰è¿™ä¸ªç»§æ‰¿ void operator()(const T* ptr) const {//è¿™æ˜¯å‡½æ•°å¯¹è±¡ï¼Œæ¥æ”¶ä¸€ä¸ªæŒ‡é’ˆä½œä¸ºå‚æ•° delete ptr; } } void doSomething(){ vector\u003cWidget*\u003e vwp; for(int i=0; i\u003cn; ++i){ vwp.push_back(new Widget); } //do something for_each(vwp.begin(), vwp.end(), DeleteObject\u003cWidget\u003e()); } ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§å½¢å¼çš„å‡½æ•°å¯¹è±¡éœ€è¦æŒ‡å®šè¦åˆ é™¤çš„å¯¹è±¡ç±»å‹ï¼ˆè¿™é‡Œæ˜¯Widgetï¼‰ï¼Œvectorä¸­ä¿å­˜çš„Widget*ï¼ŒDeleteObjectå½“ç„¶æ˜¯è¦åˆ é™¤Widget*ç±»å‹çš„æŒ‡é’ˆã€‚è¿™ç§å½¢å¼ä¸ä»…æ˜¯å¤šä½™ï¼ŒåŒæ ·å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›éš¾ä»¥è¿½è¸ªçš„é”™è¯¯ï¼Œæ¯”å¦‚è¯´æœ‰ä»£ç å¾ˆä¸æ˜æ™ºçš„ä»stringä¸­ç»§æ‰¿ã€‚è¿™æ ·åšéå¸¸å±é™©ï¼Œå› ä¸ºåŒå…¶ä»–æ ‡å‡†STLå®¹å™¨ä¸€æ ·ï¼Œstringæ˜¯æ²¡æœ‰è™šææ„å‡½æ•°çš„ï¼Œä»æ²¡æœ‰è™šææ„å‡½æ•°çš„ç±»è¿›è¡Œå…±æœ‰ç»§æ‰¿æ˜¯ä¸€é¡¹é‡è¦ç¦å¿Œï¼ˆEffective C++æœ‰è¯¦ç»†æè¿°ï¼‰ã€‚å…ˆæŠ›å¼€ç¦å¿Œä¸è°ˆï¼Œå‡å¦‚æœ‰äººå°±æ˜¯å†™å‡ºäº†è¿™æ ·çš„ä»£ç ï¼Œåœ¨è°ƒç”¨for_each(vwp.begin(), vwp.end(), DeleteObject());æ—¶ï¼Œå› ä¸ºé€šè¿‡åŸºç±»æŒ‡é’ˆåˆ é™¤æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œè€ŒåŸºç±»åˆæ²¡æœ‰è™šææ„å‡½æ•°çš„è¯ï¼Œä¼šäº§ç”Ÿä¸ç¡®å®šçš„è¡Œä¸ºã€‚æ‰€ä»¥åº”è¯¥è®©ç¼–è¯‘å™¨è‡ªå·±æ¨æ–­å‡ºåº”è¯¥åˆ é™¤çš„æŒ‡é’ˆç±»å‹ï¼Œå¦‚ä¸‹æ˜¯æ”¹è¿›åçš„ä»£ç ã€‚ struct DeleteObject { template \u003ctypename T\u003e void operator()(const T* ptr) const {//è¿™æ˜¯å‡½æ•°å¯¹è±¡ï¼Œæ¥æ”¶ä¸€ä¸ªæŒ‡é’ˆä½œä¸ºå‚æ•° delete ptr; } } void doSomething(){ vector\u003cWidget*\u003e vwp; for(int i=0; i\u003cn; ++i){ vwp.push_back(new Widget); } //do something for_each(vwp.begin(), vwp.end(), DeleteObject()); } ä½†æ˜¯ä¸Šè¿°ä»£ç ä¾ç„¶ä¸æ˜¯ç±»å‹å®‰å…¨çš„ï¼Œå¦‚æœåœ¨åˆ›å»ºWidgetå¯¹è±¡å’Œæ‰§è¡Œfor_eaché”€æ¯å¯¹è±¡ä¹‹é—´æœ‰å¼‚å¸¸è¢«æŠ›å‡ºï¼Œå°±ä¼šæœ‰èµ„æºæ³„éœ²ï¼Œå¯ä»¥ä½¿ç”¨å¸¦å¼•ç”¨è®¡æ•°çš„æ™ºèƒ½æŒ‡é’ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¦‚ä¸‹æ˜¯æœ€ç»ˆä¼˜åŒ–çš„ç‰ˆæœ¬ã€‚ void doSomething(){ typedef std::shared_ptr\u003cWidget\u003e SPW;//SPWè¡¨ç¤ºæŒ‡å‘Widgetçš„shared_ptr vector\u003cSPW\u003e vwp; for(int i=0; i\u003cn; ++i){ vwp.push_back(SPW(new Widget)); } } ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:7:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R08 åˆ‡å‹¿åˆ›å»ºåŒ…å«auto_ptrçš„å®¹å™¨å¯¹è±¡ åŒ…å«auto_ptrçš„å®¹å™¨æ˜¯è¢«ç¦æ­¢çš„ï¼Œè¿™æ ·çš„ä»£ç ä¸åº”è¯¥è¢«ç¼–è¯‘é€šè¿‡ï¼ˆå¯æƒœç›®å‰æœ‰äº›ç¼–è¯‘å™¨åšä¸åˆ°è¿™ä¸€ç‚¹ï¼‰ã€‚é¦–å…ˆæ˜¯å› ä¸ºè¿™æ ·çš„å®¹å™¨æ˜¯ä¸å¯ç§»æ¤çš„ï¼Œå…¶æ¬¡ï¼Œæ‹·è´ä¸€ä¸ªauto_ptræ„å‘³ç€å®ƒæŒ‡å‘çš„å¯¹è±¡çš„æ‰€æœ‰æƒè¢«ç§»äº¤åˆ°æ‹·å…¥çš„auto_pträ¸Šï¼Œè€Œå®ƒè‡ªèº«è¢«ç½®ä¸ºNULLï¼ˆç›¸å½“äºæ˜¯ç§»åŠ¨ï¼‰ï¼Œè¿™ç§æ‹·è´åŒ…æ‹¬è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼æ„é€ å‡½æ•°çš„æ—¶å€™ã€‚è€ŒSTLå®¹å™¨ä¸­çš„æ‹·è´éåœ°éƒ½æ˜¯ï¼Œä¸¾ä¸€ä¸ªä¾‹å­ï¼Œè°ƒç”¨sortå‡½æ•°ç»™åŒ…å«auto_ptrçš„vectoræ’åºæ—¶ï¼ˆå®šä¹‰å¥½äº†æ’åºå‡½æ•°è°“è¯ï¼‰ï¼Œåœ¨æ’åºè¿‡ç¨‹ä¸­ï¼ŒWidgetçš„ä¸€ä¸ªæˆ–å‡ ä¸ªauto_ptrå¯èƒ½ä¼šè¢«ç½®ä¸ºNULLã€‚è¿™æ˜¯å› ä¸ºsortçš„å¸¸è§å®ç°ç®—æ³•æ˜¯ï¼ŒæŠŠå®¹å™¨ä¸­çš„æŸä¸ªå…ƒç´ å½“ä½œâ€œåŸºå‡†å…ƒç´ â€ï¼Œç„¶åå¯¹å¤§äºæˆ–å°äºç­‰äºè¯¥å…ƒç´ çš„å…¶ä»–å…ƒç´ é€’å½’è°ƒç”¨æ’åºæ“ä½œï¼Œä¼šæŠŠå¾…äº¤æ¢çš„å…ƒç´ é¦–å…ˆèµ‹å€¼ç»™ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œåˆ™è‡ªèº«è¢«ç½®ä¸ºNULLäº†ï¼Œè¯¥ä¸´æ—¶å¯¹è±¡è¶…è¿‡ä½œç”¨åŸŸä¹Ÿä¼šè¢«é”€æ¯ï¼Œä»è€Œå¯¼è‡´ç»“æœvectorä¸­çš„å…ƒç´ è¢«ç½®ä¸ºNULLã€‚ // å¯¹vectoræ‰€åšçš„æ’åºæ“ä½œå¯èƒ½ä¼šæ”¹å˜å®ƒçš„å†…å®¹ï¼ vector\u003cauto_ptr\u003cWidget\u003e \u003e widgets;sort(widgets.begin(), widgets.end(), widgetAPcompare()); ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:8:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R09 æ…é‡é€‰æ‹©åˆ é™¤å…ƒç´ çš„æ–¹æ³• åˆ é™¤å®¹å™¨ä¸­æœ‰ç‰¹å®šå€¼çš„æ‰€æœ‰å¯¹è±¡ å¯¹æ ‡å‡†å®¹å™¨ Container\u003cint\u003e c; åˆ é™¤å…¶ä¸­æ‰€æœ‰å€¼ä¸º 1963 çš„å…ƒç´ çš„æ–¹æ³•ã€‚ erase-remove ä¹ æƒ¯ç”¨æ³•ï¼ˆè¿ç»­å†…å­˜å®¹å™¨ vectorï¼Œdequeï¼Œstringï¼‰ï¼š c.erase(remove(c.begin(), c.end(), 1963), c.end()); list: c.remove(1963); å…³è”å®¹å™¨ï¼šc.erase(1963); å¯¹æ•°æ—¶é—´å¼€é”€ï¼ŒåŸºäºç­‰ä»·è€Œä¸æ˜¯ç›¸ç­‰ã€‚æ³¨æ„å…³è”å®¹å™¨æ²¡æœ‰åä¸º remove çš„æˆå‘˜å‡½æ•°ï¼Œä½¿ç”¨ä»»ä½•åä¸º remove çš„æ“ä½œéƒ½æ˜¯å®Œå…¨é”™è¯¯çš„ã€‚ åˆ é™¤å®¹å™¨ä¸­æ»¡è¶³ç‰¹å®šåˆ¤åˆ«å¼ï¼ˆæ¡ä»¶ï¼‰çš„æ‰€æœ‰å¯¹è±¡ åˆ é™¤ä½¿ä¸‹é¢çš„åˆ¤åˆ«å¼è¿”å› true çš„æ¯ä¸€ä¸ªå¯¹è±¡ bool badValue(int ); // åºåˆ—å®¹å™¨(vector,string,deque,list) c.erase(remove_if(c.begin(), c.end(), badValue), c.end()); // list c.remove_if(badValue); é«˜æ•ˆæ–¹æ³•ï¼šå†™ä¸€ä¸ªå¾ªç¯éå†å®¹å™¨ä¸­çš„å…ƒç´ ï¼Œå¹¶åœ¨éå†è¿‡ç¨‹ä¸­åˆ é™¤å…ƒç´ ã€‚æ³¨æ„ï¼Œå¯¹äºå…³è”å®¹å™¨ï¼ˆmapï¼Œsetï¼Œmultimapï¼Œmultisetï¼‰ï¼Œåˆ é™¤å½“å‰çš„ iteratorï¼Œåªä¼šä½¿å½“å‰çš„ iterator å¤±æ•ˆã€‚ åŸå› ï¼šå…³è”å®¹å™¨çš„åº•å±‚ä½¿ç”¨çº¢é»‘æ ‘å®ç°ï¼Œæ’å…¥ã€åˆ é™¤ä¸€ä¸ªç»“ç‚¹ä¸ä¼šå¯¹å…¶ä»–ç»“ç‚¹é€ æˆå½±å“ã€‚erase åªä¼šä½¿è¢«åˆ é™¤å…ƒç´ çš„è¿­ä»£å™¨å¤±æ•ˆã€‚å…³è”å®¹å™¨çš„ erase è¿”å›å€¼ä¸º voidï¼Œå¯ä»¥ä½¿ç”¨ erase(iter++) çš„æ–¹å¼åˆ é™¤è¿­ä»£å™¨ã€‚ AssocContainer\u003cint\u003e c; ofstream logFile; ... for (AssocContainer\u003cint\u003e::iterator i = c.begin(); i != c.end(); /*ä»€ä¹ˆä¹Ÿä¸åš*/) { if (badValue(*i)) { logFile \u003c\u003c \"Erasing \" \u003c\u003c *i \u003c\u003c '\\n'; // å†™æ—¥å¿—æ–‡ä»¶ c.erase(i++); // ä½¿ç”¨åç¼€é€’å¢åˆ é™¤å…ƒç´ ï¼Œé¿å…è¿­ä»£å™¨æ— æ•ˆã€‚ } else { ++i; } } å¯¹äºåºåˆ—å¼å®¹å™¨ï¼ˆvectorï¼Œstringï¼Œdequeï¼‰ï¼Œåˆ é™¤å½“å‰çš„ iterator ä¼šä½¿åé¢æ‰€æœ‰å…ƒç´ çš„ iterator éƒ½å¤±æ•ˆã€‚ åŸå› ï¼š vectorã€stringã€deque ä½¿ç”¨äº†è¿ç»­åˆ†é…çš„å†…å­˜ï¼Œåˆ é™¤ä¸€ä¸ªå…ƒç´ ä¼šå¯¼è‡´åé¢çš„æ‰€æœ‰å…ƒç´ éƒ½å‘å‰ç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚æ‰€ä»¥ä¸èƒ½ä½¿ç”¨ erase(iter++) çš„æ–¹å¼ï¼Œä½†å¯ä»¥ä½¿ç”¨ erase æ–¹æ³•ï¼Œåºåˆ—å®¹å™¨çš„ erase å¯ä»¥è¿”å›ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„ iteratorã€‚ ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:9:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R10 äº†è§£åˆ†é…å™¨ï¼ˆallocatorï¼‰çš„çº¦å®šå’Œé™åˆ¶ åƒnewæ“ä½œç¬¦å’Œnew[]æ“ä½œç¬¦ä¸€æ ·ï¼ŒSTLå†…å­˜åˆ†é…å­è´Ÿè´£åˆ†é…å’Œé‡Šæ”¾åŸå§‹å†…å­˜ï¼Œä½†æ˜¯å¤šæ•°æ ‡å‡†å®¹å™¨ä»ä¸å‘ä¸ä¹‹å…³è”çš„åˆ†é…å­ç”³è¯·å†…å­˜ã€‚ 2.allocatoræ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œæ¨¡æ¿å‚æ•°Tè¡¨ç¤ºä¸ºå®ƒåˆ†é…å†…å­˜çš„å¯¹è±¡çš„ç±»å‹ï¼Œæä¾›ç±»å‹å®šä¹‰pointerå’Œreferenceï¼Œä½†æ˜¯å§‹ç»ˆè®©pointerä¸ºT*ï¼Œreferenceä¸ºT\u0026ã€‚ åƒä¸‡ä¸èƒ½è®©è‡ªå®šä¹‰çš„allocatoræ‹¥æœ‰éšå¯¹è±¡è€Œä¸åŒçš„çŠ¶æ€ï¼Œå³ä¸åº”è¯¥æœ‰éé™æ€æˆå‘˜å˜é‡ã€‚ 4.ä¼ ç»™allocatorçš„allocateæˆå‘˜å‡½æ•°çš„å‚æ•°æ˜¯å¯¹è±¡çš„ä¸ªæ•°ï¼Œè€Œä¸æ˜¯æ‰€éœ€å­—èŠ‚çš„å¤§å°ï¼Œè¿™ä¸€ç‚¹å’Œnewç›¸åŒï¼Œå’Œoperator newï¼Œmallocç›¸åã€‚åŒæ—¶allocateçš„è¿”å›å€¼æ˜¯TæŒ‡é’ˆï¼Œå³ä½¿å°šæœªæœ‰Tå¯¹è±¡è¢«æ„é€ å‡ºæ¥ï¼Œè€Œoperator newï¼Œmallocè¿”å›éƒ½æ˜¯voidï¼Œvoid*æ˜¯ç”¨æ¥æŒ‡å‘æœªåˆå§‹åŒ–å†…å­˜çš„ä¼ ç»Ÿæ–¹å¼ã€‚ è‡ªå®šä¹‰çš„allocatorä¸€å®šè¦æä¾›åµŒå¥—çš„rebindæ¨¡æ¿ï¼Œå› ä¸ºæ ‡å‡†å®¹å™¨ä¾èµ–è¯¥æ¨¡æ¿ ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:10:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R11 ç†è§£è‡ªå®šä¹‰åˆ†é…å™¨çš„æ­£ç¡®ç”¨æ³• è¯¦ç»†å‚è€ƒ:https://jianye0428.github.io/posts/clause_11/ ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:11:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"R12 åˆ‡å‹¿å¯¹STLå®¹å™¨çš„çº¿ç¨‹å®‰å…¨æ€§æœ‰ä¸åˆ‡å®é™…çš„ä¾èµ– è¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒ: https://jianye0428.github.io/posts/clause_12/ STL åªæ”¯æŒä»¥ä¸‹å¤šçº¿ç¨‹æ ‡å‡†ï¼š å¤šä¸ªçº¿ç¨‹è¯»æ˜¯å®‰å…¨çš„ã€‚ å¤šä¸ªçº¿ç¨‹å¯¹ä¸åŒçš„å®¹å™¨åšå†™å…¥æ“ä½œæ˜¯å®‰å…¨çš„ã€‚ è€ƒè™‘ä¸€æ®µå•çº¿ç¨‹å¯ä»¥æˆåŠŸæ‰§è¡Œçš„ä»£ç ã€‚ //å°†vectorä¸­çš„5éƒ½æ›¿æ¢æˆ0 vector\u003cint\u003e v; vector\u003cint\u003e::iterator first5(find(v.begin(), v.end(), 5)); if(first5 != v.end()){ *first5 = 0; } ä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œæ‰§è¡Œç¬¬äºŒè¡Œè¯­å¥åè¿”å›çš„first5çš„å€¼å¯èƒ½ä¼šè¢«æ”¹å˜ï¼Œå¯¼è‡´ç¬¬ä¸‰è¡Œçš„åˆ¤æ–­ä¸å‡†ç¡®ï¼Œç”šè‡³ä¸€äº›æ’å…¥/åˆ é™¤æ“ä½œä¼šè®©first5æ— æ•ˆã€‚æ‰€ä»¥å¿…é¡»åœ¨æ“ä½œvectorä¹‹å‰ï¼Œå†å…¶ä¸Šä¸‹ä½ç½®åŠ é”ã€‚ vector\u003cint\u003e v; getMutex(v); vector\u003cint\u003e::iterator first5(find(v.begin(), v.end(), 5)); if(first5 != v.end()){ *first5 = 0; } releaseMutex(v); æ›´ä¸ºå®Œå–„çš„æ–¹æ³•æ˜¯å®ç°ä¸€ä¸ªLockç±»ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­åŠ é”ï¼Œåœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾é”ï¼Œå³RAIIã€‚ ref: [1]. https://www.cnblogs.com/Sherry4869/p/15128250.html [2]. https://blog.csdn.net/zhuikefeng/article/details/108164117#t42 ","date":"2023-09-01","objectID":"/posts/effective_stl_part_one/:12:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [1] | å®¹å™¨","uri":"/posts/effective_stl_part_one/"},{"categories":["C++"],"content":"STLä¸­copyç®—æ³• STLæœ‰å¾ˆå¤šæœ‰è¶£çš„åœ°æ–¹ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯è™½ç„¶æœ‰11ä¸ªåå­—å¸¦â€œcopyâ€çš„ç®—æ³•ï¼Œä½†æ²¡æœ‰ä¸€ä¸ªæ˜¯copy_ifã€‚ copy copy_backward replace_copy reverse_copy replace_copy_if unique_copy remove_copy rotate_copy remove_copy_if partial_sort_copy unintialized_copy å¦‚æœä½ åªæ˜¯ç®€å•åœ°æƒ³è¦æ‹·è´ä¸€ä¸ªåŒºé—´ä¸­æ»¡è¶³æŸä¸ªåˆ¤æ–­å¼çš„å…ƒç´ ï¼Œä½ åªèƒ½è‡ªå·±åšã€‚ ","date":"2023-08-30","objectID":"/posts/clause_36/:1:0","tags":["Effective STL"],"title":"Effective STL [36] | äº†è§£copy_ifçš„æ­£ç¡®å®ç°","uri":"/posts/clause_36/"},{"categories":["C++"],"content":"è‡ªå·±å®ç° å‡è®¾ä½ æœ‰ä¸€ä¸ªå‡½æ•°æ¥å†³å®šä¸€ä¸ªWidgetæ˜¯å¦æœ‰ç¼ºé™·çš„ï¼š bool isDefective(const Widget\u0026 w); è€Œä¸”ä½ å¸Œæœ›æŠŠä¸€ä¸ªvectorä¸­æ‰€æœ‰æœ‰ç¼ºé™·çš„Widgetå†™åˆ°cerrã€‚å¦‚æœå­˜åœ¨copy_ifï¼Œä½ å¯ä»¥ç®€å•åœ°è¿™ä¹ˆåšï¼š vector\u003cWidget\u003e widgets; ... // è¿™æ— æ³•ç¼–è¯‘ï¼šSTLä¸­å¹¶æ²¡æœ‰copy_if copy_if(widgets.begin(), widgets.end(), ostream_iterator\u003cWidget\u003e(cerr, \"\\n\"), isDefective); ä¸€ä¸ªä¸å¾ˆæ­£ç¡®çš„copy_ifå®ç° è¿™é‡Œæœ‰ä¸€ä¸ªåˆç†çš„çœ‹å¾…copy_ifï¼š template\u003ctypename InputIterator, typename OutputIterator, typename Predicate\u003e OutputIterator copy_if(InputIterator begin, InputIterator end, OutputIterator destBegin, Predicate p) { return remove_copy_if(begin, end, destBegin, not1(p)); } è™½ç„¶STLå¹¶æ²¡æœ‰è®©ä½ è¯´â€œæ‹·è´æ¯ä¸ªåˆ¤æ–­å¼ä¸ºtrueçš„ä¸œè¥¿â€ï¼Œä½†å®ƒçš„ç¡®è®©ä½ è¯´äº†â€œæ‹·è´é™¤äº†åˆ¤æ–­å¼ä¸ä¸ºtrueä»¥å¤–çš„æ¯ä¸ªä¸œè¥¿â€ã€‚ è¦å®ç°copy_ifï¼Œä¼¼ä¹æˆ‘ä»¬éœ€è¦åšçš„å°±åªæ˜¯åŠ ä¸€ä¸ªnot1åœ¨æˆ‘ä»¬å¸Œæœ›ä¼ ç»™copy_ifçš„åˆ¤æ–­å¼å‰é¢ï¼Œç„¶åæŠŠè¿™ä¸ªç»“æœåˆ¤æ–­å¼ä¼ ç»™remove_copy_ifï¼Œç»“æœå°±æ˜¯ä¸Šé¢çš„ä»£ç ã€‚ å¦‚æœä¸Šé¢çš„ç†ç”±æœ‰æ•ˆï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ç§æ–¹æ³•å†™å‡ºæœ‰ç¼ºé™·çš„Widgetï¼š // ä¸ä¼šç¼–è¯‘çš„å–„æ„ä»£ç  copy_if(widgets.begin(), widgets.end(), ostream_iterator\u003cWidget\u003e(cerr, \"\\n\"), isDefective); ä½ çš„STLå¹³å°å°†ä¼šæ•Œè§†è¿™æ®µä»£ç ï¼Œå› ä¸ºå®ƒè¯•å›¾å¯¹isDefectiveåº”ç”¨not1ï¼ˆè¿™ä¸ªåº”ç”¨å‡ºç°åœ¨copy_ifå†…éƒ¨ï¼‰ã€‚ not1ä¸èƒ½ç›´æ¥åº”ç”¨äºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå‡½æ•°æŒ‡é’ˆå¿…é¡»å…ˆä¼ ç»™ptr_funã€‚è¦è°ƒç”¨è¿™ä¸ªcopy_ifå®ç°ï¼Œä½ å¿…é¡»ä¼ é€’çš„ä¸ä»…æ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªå¯é€‚é…çš„å‡½æ•°å¯¹è±¡ã€‚ æ ‡å‡†STLç®—æ³•ä»æ¥ä¸è¦æ±‚å®ƒä»¬çš„ä»¿å‡½æ•°æ˜¯å¯é€‚é…çš„ï¼Œcopy_ifä¹Ÿä¸åº”è¯¥è¦æ±‚ã€‚ ","date":"2023-08-30","objectID":"/posts/clause_36/:2:0","tags":["Effective STL"],"title":"Effective STL [36] | äº†è§£copy_ifçš„æ­£ç¡®å®ç°","uri":"/posts/clause_36/"},{"categories":["C++"],"content":"æ­£ç¡®çš„å®ç° template\u003ctypename InputIterator, typename OutputIterator, typename Predicate\u003e OutputIterator copy_if(InputIterator begin, InputIterator end, OutputIterator destBegin, Predicate p) { while (begin != end) { if (p(*begin)) *destBegin++ == *begin; ++begin; } return destBegin; } ","date":"2023-08-30","objectID":"/posts/clause_36/:3:0","tags":["Effective STL"],"title":"Effective STL [36] | äº†è§£copy_ifçš„æ­£ç¡®å®ç°","uri":"/posts/clause_36/"},{"categories":["C++"],"content":"å‰è¨€ Effective-STLæ€»ç»“ç³»åˆ—åˆ†ä¸ºä¸ƒéƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬ä¸ƒéƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬ä¸ƒç« ï¼Œå†…å®¹èŒƒå›´Rule43~50ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule43ç®€å†™ä¸ºR43ã€‚ Effective-STLç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››) ","date":"2023-08-28","objectID":"/posts/effective_stl_part_seven/:0:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [7] | åœ¨ç¨‹åºä¸­ä½¿ç”¨STL","uri":"/posts/effective_stl_part_seven/"},{"categories":["C++"],"content":"R43 ç®—æ³•è°ƒç”¨ä¼˜å…ˆäºæ‰‹å†™çš„å¾ªç¯ è°ƒç”¨ç®—æ³•ä¼˜äºæ‰‹å†™å¾ªç¯ï¼š æ•ˆç‡ï¼šç®—æ³•æ¯”æ‰‹å†™çš„å¾ªç¯æ•ˆç‡æ›´é«˜ã€‚ æ­£ç¡®æ€§ï¼šæ‰‹å†™å¾ªç¯æ¯”ä½¿ç”¨ç®—æ³•å®¹æ˜“å‡ºé”™ã€‚ å¯ç»´æŠ¤æ€§ï¼šä½¿ç”¨ç®—æ³•çš„ä»£ç æ›´åŠ ç®€æ´æ˜äº†ã€‚ ä¾‹å­ï¼šP155ï¼Œ ç®—æ³•çš„åç§°è¡¨æ˜äº†å®ƒçš„åŠŸèƒ½ï¼Œè€Œ forã€whileã€do å¾ªç¯ä¸èƒ½ã€‚ æ‰‹å†™å¾ªç¯éœ€è¦ç»´æŠ¤è¿­ä»£å™¨çš„æœ‰æ•ˆæ€§ã€‚ ","date":"2023-08-28","objectID":"/posts/effective_stl_part_seven/:1:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [7] | åœ¨ç¨‹åºä¸­ä½¿ç”¨STL","uri":"/posts/effective_stl_part_seven/"},{"categories":["C++"],"content":"R44 å®¹å™¨çš„æˆå‘˜å‡½æ•°ä¼˜å…ˆäºåŒåçš„ç®—æ³• åŸå› : æˆå‘˜å‡½æ•°å¾€å¾€é€Ÿåº¦å¿«ã€‚ æˆå‘˜å‡½æ•°é€šå¸¸ä¸å®¹å™¨ç»“åˆå¾—æ›´åŠ ç´§å¯†ã€‚ï¼ˆåŒæ ·çš„åç§°åšä¸åŒçš„äº‹æƒ…ï¼‰ å¯¹äº map å’Œ multimap è€Œè¨€: æˆå‘˜å‡½æ•°å¯ä»¥è·å¾—å¯¹æ•°æ—¶é—´çš„æ€§èƒ½ã€‚ æˆå‘˜å‡½æ•°çš„ç›¸åŒæ˜¯ç­‰ä»·ï¼Œè€Œç®—æ³•æ˜¯ç›¸ç­‰ã€‚ å®ƒä»¬çš„æˆå‘˜å‡½æ•°åªç»Ÿè®¡æ£€æŸ¥æ¯ä¸ª pair å¯¹è±¡çš„é”®éƒ¨åˆ†ã€‚è€Œç®—æ³•åŒæ—¶æ£€æŸ¥é”®å’Œå€¼/(key,value)å¯¹ã€‚ å¯¹äº list è€Œè¨€ï¼Œlist æˆå‘˜å‡½æ•°åªæ˜¯ç®€å•åœ°ç»´æŠ¤æŒ‡é’ˆï¼Œå¯ä»¥æä¾›æ›´å¥½çš„æ€§èƒ½ã€‚list çš„ removeã€remove_ifã€unqiue åˆ™å®å®åœ¨åœ¨çš„åˆ é™¤äº†å…ƒç´ ã€‚sort ç®—æ³•ä¸èƒ½ç›´æ¥åº”ç”¨äº listï¼Œå› ä¸º sort éœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œè€Œ list çš„è¿­ä»£å™¨æ˜¯åŒå‘è¿­ä»£å™¨ã€‚ ","date":"2023-08-28","objectID":"/posts/effective_stl_part_seven/:2:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [7] | åœ¨ç¨‹åºä¸­ä½¿ç”¨STL","uri":"/posts/effective_stl_part_seven/"},{"categories":["C++"],"content":"R45 æ­£ç¡®åŒºåˆ†countã€findã€binary_searchã€lower_boundã€upper_boundå’Œequal_range å‡è®¾ä½ è¦åœ¨å®¹å™¨ä¸­æŸ¥æ‰¾ä¸€äº›ä¿¡æ¯ï¼Œæ ‡é¢˜åˆ—å‡ºçš„å‡ ä¸ªå‡½æ•°åº”è¯¥æ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿé¦–å…ˆåº”è¯¥è€ƒè™‘åŒºé—´æ˜¯å¦æ˜¯æ’åºçš„ï¼Œå¦‚æœæ˜¯æ’åºçš„ï¼Œåˆ™binary_searchã€lower_boundã€upper_boundå’Œequal_rangeå…·æœ‰æ›´å¿«çš„æŸ¥æ‰¾é€Ÿåº¦ï¼Œå¦‚æœä¸æ˜¯æ’åºçš„ï¼Œé‚£ä¹ˆä½ åªèƒ½é€‰æ‹©countã€count_ifã€findã€find_ifï¼Œè¿™äº›ç®—æ³•ä»…æä¾›çº¿æ€§æ—¶é—´çš„æŸ¥æ‰¾æ•ˆç‡ã€‚ä½†æ˜¯è¿™äº›å‡½æ•°è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œcountã€count_ifã€findã€find_ifä½¿ç”¨ç›¸ç­‰æ€§è¿›è¡ŒæŸ¥æ‰¾ï¼Œbinary_searchã€lower_boundã€upper_boundå’Œequal_rangeä½¿ç”¨ç­‰ä»·æ€§è¿›è¡ŒæŸ¥æ‰¾ã€‚ è€ƒè™‘countå’Œfindçš„åŒºåˆ«ï¼Œcountè¡¨ç¤ºåŒºé—´æ˜¯å¦å­˜åœ¨å¾…æŸ¥æ‰¾çš„å€¼ï¼Œå¦‚æœå­˜åœ¨æœ‰å¤šå°‘ä¸ªï¼Ÿfindè¡¨ç¤ºåŒºé—´æ˜¯å¦å­˜åœ¨å¾…æŸ¥æ‰¾çš„å€¼ï¼Œå¦‚æœå­˜åœ¨å®ƒåœ¨å“ªé‡Œï¼Ÿå‡è®¾ä½ åªæƒ³çŸ¥é“åŒºé—´ä¸­æ˜¯å¦å­˜åœ¨å¾…æŸ¥æ‰¾çš„å€¼ï¼Œå¦‚æœæ˜¯ä½¿ç”¨countä¼šæ›´æ–¹ä¾¿ä¸€äº›ï¼Œå› ä¸ºä½¿ç”¨findè¿˜éœ€è¦æ¯”è¾ƒfindè¿”å›çš„æŒ‡é’ˆæ˜¯å¦æ˜¯å®¹å™¨çš„end()ï¼Œä½†æ˜¯å› ä¸ºfindæ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæŸ¥æ‰¾çš„å€¼å°±ä¼šè¿”å›ï¼Œcountä¸€å®šä¼šéå†åˆ°å®¹å™¨çš„æœ«å°¾ï¼Œæ‰€ä»¥findçš„æ•ˆç‡æ›´é«˜ã€‚ å½“ä½ çš„åŒºé—´æ˜¯æ’åºçš„ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥ä½¿ç”¨å¯¹æ•°æ—¶é—´æŸ¥æ‰¾çš„å››ç§æ–¹æ³•ã€‚ä¸æ ‡å‡†C/C++å‡½æ•°åº“ä¸­çš„bsearchä¸åŒçš„æ˜¯ï¼Œbinary_searchä»…åˆ¤æ–­åŒºé—´æ˜¯å¦å­˜åœ¨å¾…æŸ¥æ‰¾çš„å€¼ï¼ˆè¿”å›å€¼æ˜¯boolï¼‰ï¼Œå¦‚æœä½ è¿˜æƒ³çŸ¥é“å¾…æŸ¥æ‰¾å€¼å¾—ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–ä¸‰ç§æ–¹æ³•ï¼Œå…ˆè€ƒè™‘lower_boundï¼Œlower_boundæŸ¥æ‰¾ç‰¹å®šå€¼ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒåŒæ ·ä½ éœ€è¦åˆ¤æ–­è¿™ä¸ªè¿­ä»£å™¨çš„ç»“æœï¼Œé™¤äº†è¦åˆ¤æ–­è¿™ä¸ªè¿­ä»£å™¨æ˜¯å¦æ˜¯end()ï¼Œè¿˜è¦åˆ¤æ–­å…¶æŒ‡å‘çš„å€¼æ˜¯å¦æ˜¯å¾…æŸ¥æ‰¾çš„å€¼ï¼Œæ‰€ä»¥å¾ˆå¤šäººä¼šè¿™ä¹ˆå†™ï¼š vector\u003cWidget\u003e::iterator i = lower_bound(vw.begin(), vw.end(), w); if(i != vw.end() \u0026\u0026 *i == w) { ... }//è¿™é‡Œæœ‰ä¸€ä¸ªé”™è¯¯ è¿™é‡Œ*i == wæ˜¯ä¸€ä¸ªç›¸ç­‰æ€§æµ‹è¯•ï¼Œä½†æ˜¯lower_boundä½¿ç”¨ç­‰ä»·æ€§è¿›è¡Œæœç´¢çš„ï¼Œè™½ç„¶å¤§å¤šæ•°æƒ…å†µä¸‹ç­‰ä»·æ€§æµ‹è¯•å’Œç›¸ç­‰æ€§æµ‹è¯•çš„ç»“æœç›¸åŒï¼Œä½†æ˜¯æ¡æ¬¾19ä¹Ÿè¯´æ˜äº†è¿èƒŒè¿™ä¸ªæƒ…å†µä¹Ÿå¾ˆå¸¸è§ï¼Œæ‰€ä»¥æ­£ç¡®ä¹Ÿæ›´æ–¹ä¾¿çš„æ–¹å¼æ˜¯ä½¿ç”¨equal_rangeï¼Œequal_rangeä¼šè¿”å›ä¸€å¯¹è¿­ä»£å™¨ï¼Œç¬¬ä¸€ä¸ªè¿­ä»£å™¨ç­‰äºlower_boundè¿”å›çš„è¿­ä»£å™¨ï¼Œç¬¬äºŒä¸ªè¿­ä»£å™¨ç­‰äºupper_boundè¿”å›çš„è¿­ä»£å™¨ï¼Œequal_rangeè¿”å›äº†ä¸€ä¸ªå­åŒºé—´ï¼Œå…¶ä¸­çš„å€¼ä¸å¾…æŸ¥æ‰¾çš„å€¼ç­‰ä»·ï¼Œå¦‚æœè¿”å›çš„ä¸¤ä¸ªè¿­ä»£å™¨ç›¸åŒï¼Œç­‰è¯´æ˜æŸ¥æ‰¾çš„åŒºé—´æ²¡æœ‰å¾…æŸ¥æ‰¾çš„å€¼ï¼Œè€Œå­åŒºé—´çš„é•¿åº¦å°±æ˜¯ç­‰ä»·å€¼çš„ä¸ªæ•°ï¼Œå¯ä»¥ä½¿ç”¨distanceå¾—åˆ°ã€‚ å†è€ƒè™‘lower_boundå’Œupper_boundçš„ä½¿ç”¨åœºæ™¯ï¼Œè¿™æ¬¡æˆ‘ä¸æ˜¯å¸Œæœ›æŸ¥æ‰¾æŸä¸ªå…ƒç´ ï¼Œè€Œæ˜¯æƒ³æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¯”ç‰¹å®šå€¼å¤§çš„å…ƒç´ çš„ä½ç½®ï¼Œè¿™ä¸ªç‰¹å®šå€¼å¯èƒ½ä¸åœ¨å®¹å™¨ä¸­ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨lower_boundï¼Œå¦‚æœå¸Œæœ›æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºæˆ–ç­‰äºç‰¹å®šå€¼çš„å…ƒç´ çš„ä½ç½®ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨upper_boundã€‚ ","date":"2023-08-28","objectID":"/posts/effective_stl_part_seven/:3:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [7] | åœ¨ç¨‹åºä¸­ä½¿ç”¨STL","uri":"/posts/effective_stl_part_seven/"},{"categories":["C++"],"content":"R46 è€ƒè™‘ä½¿ç”¨å‡½æ•°å¯¹è±¡è€Œä¸æ˜¯å‡½æ•°ä½œä¸º STL ç®—æ³•çš„å‚æ•° ç¬¬ä¸€ä¸ªåŸå› æ˜¯å› ä¸ºæ•ˆç‡ã€‚éšç€æŠ½è±¡ç¨‹åº¦çš„æé«˜ï¼Œæ‰€ç”Ÿæˆä»£ç çš„æ•ˆç‡æ˜¯åœ¨é™ä½çš„ï¼Œæ¯”å¦‚å‡ ä¹åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œæ“ä½œåŒ…å«ä¸€ä¸ªdoubleçš„å¯¹è±¡æ¯”ç›´æ¥æ“ä½œdoubleéƒ½æ˜¯è¦æ…¢çš„ï¼Œä½†æ˜¯å¯èƒ½ä»¤ä½ æ„Ÿåˆ°æƒŠè®¶çš„æ˜¯ï¼Œå°†å‡½æ•°å¯¹è±¡ä¼ é€’ç»™STLç®—æ³•å¾€å¾€æ¯”ä¼ é€’å‡½æ•°æ›´åŠ é«˜æ•ˆã€‚æ¯”å¦‚è¯´ä½ æƒ³ç”Ÿæˆä¸€ä¸ªé™åºæ’åˆ—çš„vectorï¼Œä½ å¯ä»¥ä½¿ç”¨å‡½æ•°å¯¹è±¡ï¼Œå³greaterï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°ï¼Œè€Œç¬¬ä¸€ç§æƒ…å†µå¾€å¾€æ˜¯æ›´å¿«çš„ï¼Œè¿™æ˜¯å› ä¸ºå¦‚æœä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„operator()å‡½æ•°è¢«å£°æ˜æ˜¯å†…è”çš„ï¼ˆå¯ä»¥é€šè¿‡inlineæ˜¾å¼å£°æ˜ï¼Œä¹Ÿå¯ä»¥å®šä¹‰åœ¨ç±»ä¸­éšå¼å£°æ˜ï¼‰ï¼Œé‚£ä¹ˆå®ƒçš„å‡½æ•°ä½“å¯è¢«ç¼–è¯‘å™¨ç›´æ¥ä¼˜åŒ–ï¼Œä½†æ˜¯ä¼ é€’å‡½æ•°æŒ‡é’ˆåˆ™ä¸è¡Œï¼Œç¼–è¯‘å™¨ä¸èƒ½ä¼˜åŒ–ã€‚ sort(v.begin(), v.end(), doubleGreater); sort(v.begin(), v.end(), greater\u003cdouble\u003e()); ä½¿ç”¨greater\u003cdouble\u003e()çš„sortè°ƒç”¨æ¯”ä½¿ç”¨doubleGreaterçš„ sort è°ƒç”¨å¿«å¾—å¤šã€‚åŸå› ï¼šå‡½æ•°å†…è”ï¼Œsort ä¸åŒ…å«å‡½æ•°è°ƒç”¨ã€‚ æŠ½è±¡æ€§åˆ©ç›Šï¼šC++ çš„ sort ç®—æ³•æ€§èƒ½æ€»æ˜¯ä¼˜äº C çš„ qsortã€‚åœ¨è¿è¡Œæ—¶ï¼Œsort ç®—æ³•ä»¥å†…è”æ–¹å¼è°ƒç”¨å®ƒçš„æ¯”è¾ƒå‡½æ•°ï¼Œè€Œ qsort åˆ™é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å®ƒçš„æ¯”è¾ƒå‡½æ•°ã€‚ ä½¿ç”¨å‡½æ•°å¯¹è±¡ï¼Œå¯ä»¥è®©ä½ çš„ç¨‹åºæ­£ç¡®åœ°é€šè¿‡ç¼–è¯‘ï¼Œé¿å…è¯­è¨€æœ¬èº«çš„ç¼ºé™·ã€‚ 2. ç¬¬äºŒä¸ªåŸå› æ˜¯æ­£ç¡®æ€§ï¼Œæœ‰çš„æ—¶å€™STLå¹³å°ä¼šæ‹’ç»ä¸€äº›å®Œå…¨åˆæ³•çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š //å®Œå…¨åˆæ³•çš„ä»£ç ä½†æ˜¯ä¸èƒ½é€šè¿‡ç¼–è¯‘ set\u003cstring\u003e s; transform(s.begin(), s.end(), ostream_iterator\u003cstring::size_type\u003e(cout, \"\\n\"), mem_fun_ref(\u0026string::size)); //å¯ä»¥æ”¹ç”¨å‡½æ•°å¯¹è±¡çš„å½¢å¼ struct stringSize : public unary_function\u003cstring, string::size_type\u003e{ string::size_type operator()(const string\u0026 s) const { return s.size(); } }; ","date":"2023-08-28","objectID":"/posts/effective_stl_part_seven/:4:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [7] | åœ¨ç¨‹åºä¸­ä½¿ç”¨STL","uri":"/posts/effective_stl_part_seven/"},{"categories":["C++"],"content":"R47 é¿å…äº§ç”Ÿ â€œç›´å†™å‹â€ ï¼ˆwrite onlyï¼‰çš„ä»£ç  æ‰€è°“â€ç›´å†™å‹â€œçš„ä»£ç æ˜¯æŒ‡ä¸€è¡Œä»£ç ä¸­æœ‰è¿‡äºå¤æ‚çš„åµŒå¥—å‡½æ•°è°ƒç”¨ï¼Œå¯èƒ½å¯¹äºç¼–å†™ä»£ç çš„äººï¼Œè¿™è¡Œä»£ç çœ‹ä¼¼éå¸¸ç›´æ¥å’Œç®€å•ï¼Œä½†æ˜¯å¯¹äºé˜…è¯»ä»£ç çš„äººåˆ™æ˜¾å¾—éš¾ä»¥ç†è§£ã€‚æ‰€ä»¥åœ¨é‡åˆ°è¿™ç§å†™å‡ºâ€œç›´å†™å‹â€ä»£ç æ—¶ï¼Œåº”è¯¥å°†å…¶æ‹†åˆ†æˆå¤šè¡Œä»£ç ï¼Œæˆ–è€…ä½¿ç”¨typedefèµ·åˆ«åçš„å½¢å¼ï¼Œè®©ä»£ç æ›´æ˜“äºé˜…è¯»ã€‚ ","date":"2023-08-28","objectID":"/posts/effective_stl_part_seven/:5:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [7] | åœ¨ç¨‹åºä¸­ä½¿ç”¨STL","uri":"/posts/effective_stl_part_seven/"},{"categories":["C++"],"content":"R48 æ€»æ˜¯åŒ…å«ï¼ˆ#includeï¼‰æ­£ç¡®çš„å¤´æ–‡ä»¶ æœ‰çš„æ—¶å€™å³ä½¿æ¼æ‰äº†å¿…è¦çš„å¤´æ–‡ä»¶ï¼Œç¨‹åºåŒæ ·å¯ä»¥ç¼–è¯‘ï¼Œè¿™æ˜¯å› ä¸ºC++æ ‡å‡†å¹¶æ²¡æœ‰è§„å®šæ ‡å‡†åº“ä¸­å¤´æ–‡ä»¶ä¹‹é—´çš„ç›¸äº’åŒ…å«å…³ç³»ï¼Œè¿™å°±å¯¼è‡´äº†æŸä¸ªå¤´æ–‡ä»¶åŒ…å«äº†å…¶ä»–å¤´æ–‡ä»¶ï¼Œå¦‚åŒ…å«äº†ã€‚ä½†æ˜¯è¿™ç§ç¨‹åºå¾€å¾€æ˜¯ä¸å¯ç§»æ¤çš„ï¼Œå³ä½¿åœ¨ä½ çš„å¹³å°ä¸Šå¯ä»¥ç¼–è¯‘ï¼Œä½†æ˜¯åœ¨å…¶ä»–å¹³å°ä¸Šå°±å¯èƒ½ä¼šç¼–è¯‘ä¸è¿‡ï¼Œæ‰€ä»¥è§£å†³æ­¤ç±»é—®é¢˜çš„ä¸€æ¡åŸåˆ™å°±æ˜¯æ€»æ˜¯includeå¿…è¦çš„å¤´æ–‡ä»¶ ","date":"2023-08-28","objectID":"/posts/effective_stl_part_seven/:6:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [7] | åœ¨ç¨‹åºä¸­ä½¿ç”¨STL","uri":"/posts/effective_stl_part_seven/"},{"categories":["C++"],"content":"R49 å­¦ä¼šåˆ†æä¸ STL ç›¸å…³çš„ç¼–è¯‘å™¨è¯Šæ–­ä¿¡æ¯ åœ¨ç¨‹åºç¼–è¯‘æˆ–è€…è¿è¡Œå‡ºé”™æ—¶ï¼Œæœ‰æ—¶ç¼–è¯‘å™¨ç»™å‡ºçš„è¯Šæ–­ä¿¡æ¯éå¸¸æ··ä¹±å’Œéš¾ä»¥é˜…è¯»ã€‚å¯¹äºè¿™äº›ä¿¡æ¯å¯ä»¥ä½¿ç”¨åŒä¹‰è¯æ›¿æ¢çš„æ–¹æ³•è¿›è¡Œç®€åŒ–ï¼Œæ¯”å¦‚è¯´å°†std::basic_string\u003c\u003eæ›¿æ¢æˆstringï¼Œå°†std::map\u003c\u003eæ›¿æ¢æˆmapï¼Œå°†çœ‹ä¸æ‡‚çš„STLå†…éƒ¨æ¨¡æ¿std::_Treeæ›¿æ¢æˆsomething ","date":"2023-08-28","objectID":"/posts/effective_stl_part_seven/:7:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [7] | åœ¨ç¨‹åºä¸­ä½¿ç”¨STL","uri":"/posts/effective_stl_part_seven/"},{"categories":["C++"],"content":"R50 ç†Ÿæ‚‰ä¸ STL ç›¸å…³çš„ web ç«™ç‚¹ SGI STL ç«™ç‚¹ STLport ç«™ç‚¹ Boost ç«™ç‚¹ Ref: [1]. htTps://www.cnblogs.com/Sherry4869/p/15162253.html [2]. https://blog.csdn.net/zhuikefeng/article/details/108164117#t35 [3]. https://zhuanlan.zhihu.com/p/458156007 ","date":"2023-08-28","objectID":"/posts/effective_stl_part_seven/:8:0","tags":["Effective STL"],"title":"Effective STL ç²¾è¯»æ€»ç»“ [7] | åœ¨ç¨‹åºä¸­ä½¿ç”¨STL","uri":"/posts/effective_stl_part_seven/"},{"categories":["C++"],"content":"æ€ä¹ˆä½¿ç”¨STLæ¥è¿›è¡Œå¿½ç•¥å¤§å°å†™çš„å­—ç¬¦ä¸²æ¯”è¾ƒ? å¦‚æœä½ å¿½ç•¥å›½é™…åŒ–é—®é¢˜è€Œä¸”åªå…³æ³¨äºè®¾è®¡æˆå­—ç¬¦ä¸²strcmpé‚£æ ·çš„ç±»å‹ï¼Œè¿™ä¸ªä»»åŠ¡å¾ˆç®€å•ã€‚ å¦‚æœä½ è¦æœ‰strcmpä¸å…·æœ‰çš„æŒ‰è¯­è¨€å¤„ç†å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦çš„èƒ½åŠ›ï¼ˆå³ï¼Œå®¹çº³æ–‡æœ¬çš„å­—ç¬¦ä¸²æ˜¯é™¤äº†è‹±è¯­ä»¥å¤–çš„è¯­è¨€ï¼‰æˆ–ç¨‹åºä½¿ç”¨äº†åŒºåŸŸè®¾ç½®è€Œä¸æ˜¯é»˜è®¤çš„ï¼Œè¿™ä¸ªä»»åŠ¡å¾ˆå›°éš¾ã€‚ æƒ³è¦ä½¿ç”¨å¿½ç•¥å¤§å°å†™æ¯”è¾ƒçš„ç¨‹åºå‘˜é€šå¸¸éœ€è¦ä¸¤ç§ä¸åŒçš„è°ƒç”¨æ¥å£ï¼š ä¸€ç§ç±»ä¼¼strcmpï¼ˆè¿”å›ä¸€ä¸ªè´Ÿæ•°ã€é›¶æˆ–æ­£æ•°ï¼‰ å¦ä¸€ç§ç±»ä¼¼operatorï¼ˆè¿”å›trueæˆ–falseï¼‰ ","date":"2023-08-28","objectID":"/posts/clause_35/:1:0","tags":["Effective STL"],"title":"Effective STL [35] | é€šè¿‡mismatchæˆ–lexicographicalæ¯”è¾ƒå®ç°ç®€å•çš„å¿½ç•¥å¤§å°å†™å­—ç¬¦ä¸²æ¯”è¾ƒ","uri":"/posts/clause_35/"},{"categories":["C++"],"content":"ç¡®å®šä¸¤ä¸ªå­—ç¬¦é™¤äº†å¤§å°å†™ä¹‹å¤–æ˜¯å¦ç›¸ç­‰ ç±»ä¼¼strcmpè¿›è¡Œçš„å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œåªè€ƒè™‘ç±»ä¼¼strcmpçš„å­—ç¬¦ä¸²æ¯”è¾ƒï¼š // å¿½ç•¥å¤§å°å†™æ¯”è¾ƒå­—ç¬¦ // c1å’Œc2ï¼Œå¦‚æœc1 \u003c c2è¿”å›-1ï¼Œ // å¦‚æœc1==c2è¿”å›0ï¼Œå¦‚æœc1 \u003e c2è¿”å›1 int ciCharCompare(char c1, char c2) { // è¿™äº›è¯­å¥çš„è§£é‡Šçœ‹ä¸‹æ–‡ int Ic1 = tolower(static_cast\u003cunsigned char\u003e(c1)); int Ic2 = tolower(static_cast\u003cunsigned char\u003e(c2)); if (Ic1 \u003c Ic2) return -1; if (Ic1 \u003e Ic2) return 1; return 0; } è¿™ä¸ªå‡½æ•°éµå¾ªäº†strcmpï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªè´Ÿæ•°ã€é›¶æˆ–æ­£æ•°ï¼Œä¾èµ–äºc1å’Œc2ä¹‹é—´çš„å…³ç³»ã€‚ tolower ä¸strcmpä¸åŒçš„æ˜¯ï¼ŒciCharCompareåœ¨è¿›è¡Œæ¯”è¾ƒå‰æŠŠä¸¤ä¸ªå‚æ•°è½¬åŒ–ä¸ºå°å†™ï¼Œä»è€Œå¿½ç•¥å¤§å°å†™çš„å­—ç¬¦æ¯”è¾ƒã€‚ æ­£å¦‚\u003ccctype\u003eï¼ˆä¹Ÿæ˜¯\u003cctype.h\u003eï¼‰é‡Œçš„å¾ˆå¤šå‡½æ•°ï¼Œtolowerçš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹æ˜¯intï¼Œä½†é™¤éè¿™ä¸ªintæ˜¯EOFï¼Œå®ƒçš„å€¼å¿…é¡»èƒ½è¡¨ç°ä¸ºä¸€ä¸ªunsigned charã€‚ åœ¨Cå’ŒC++ä¸­ï¼Œcharå¯èƒ½æˆ–å¯èƒ½ä¸æ˜¯æœ‰ç¬¦å·çš„ï¼ˆä¾èµ–äºå®ç°ï¼‰ï¼Œå½“charæœ‰ç¬¦å·æ—¶ï¼Œå”¯ä¸€ç¡®è®¤å®ƒçš„å€¼å¯ä»¥è¡¨ç°ä¸ºunsigned charçš„æ–¹å¼æ˜¯åœ¨è°ƒç”¨tolowerä¹‹å‰è½¬æ¢ä¸€ä¸‹ã€‚ åŸºäºmismatchå®ç° ç»™å®šäº†ciCharCompareï¼Œå°±å¾ˆå®¹æ˜“å†™å‡ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå¿½ç•¥å¤§å°å†™çš„ä¸¤ä¸ªå­—ç¬¦ä¸²æ¯”è¾ƒå‡½æ•°ï¼Œæä¾›äº†ä¸€ä¸ªç±»ä¼¼strcmpçš„æ¥å£ã€‚ ciStringCompareè¿™ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªè´Ÿæ•°ã€é›¶æˆ–æ­£æ•°ï¼Œä¾èµ–äºè¦æ¯”è¾ƒçš„å­—ç¬¦ä¸²çš„å…³ç³»ã€‚ å®ƒåŸºäºmismatchç®—æ³•ï¼Œå› ä¸ºmismatchç¡®å®šäº†ä¸¤ä¸ªåŒºé—´ä¸­ç¬¬ä¸€ä¸ªå¯¹åº”çš„ä¸ç›¸åŒçš„å€¼çš„ä½ç½®ã€‚ æˆ‘ä»¬å¿…é¡»ç¡®å®šä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ¯”å¦ä¸€ä¸ªçŸ­ï¼ŒçŸ­çš„å­—ç¬¦ä¸²ä½œä¸ºç¬¬ä¸€ä¸ªåŒºé—´ä¼ é€’ã€‚ å› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠçœŸæ­£çš„å·¥ä½œæ”¾åœ¨ä¸€ä¸ªå«åšciStringCompareImplçš„å‡½æ•°ï¼Œç„¶åè®©ciStringCompareç®€å•åœ°ç¡®ä¿ä¼ è¿›å»çš„å®å‚é¡ºåºæ­£ç¡®ï¼Œå¦‚æœå®å‚äº¤æ¢äº†å°±è°ƒæ•´è¿”å›å€¼ï¼š int ciStringCompareImpl(const string \u0026s1, const string \u0026s2); // å®ç°è¯·çœ‹ä¸‹æ–‡ int ciStringCompare(const string \u0026s1, const string \u0026s2) { if (s1.size() \u003c= s2.size()) return ciStringCompareImpl(s1, s2); else return -ciStringCompareImpl(s2, s1); } åœ¨ciStringCompareImplä¸­ï¼Œå¤§éƒ¨åˆ†å·¥ä½œç”±mismatchæ¥å®Œæˆã€‚å®ƒè¿”å›ä¸€å¯¹è¿­ä»£å™¨ï¼Œè¡¨ç¤ºäº†åŒºé—´ä¸­ç¬¬ä¸€ä¸ªå¯¹åº”çš„å­—ç¬¦ä¸ç›¸åŒçš„ä½ç½®ï¼š int ciStringCompareImpl(const string \u0026si, const strings s2) { // PSCI = â€œpair of string::const_iteratorâ€ typedef pair\u003cstring::const_iterator, string::const_iterator\u003e PSCI; // ä¸‹æ–‡è§£é‡Šäº†ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦not2ï¼› PSCI p = mismatch(s1.begin(), s1.end(), s2.begin(), not2(ptr_fun(ciCharCompare))); if (p.first == s1.end()) { // å¦‚æœä¸ºçœŸï¼Œs1ç­‰äºs2æˆ–s1æ¯”s2çŸ­ if (p.second == s2.end()) return 0; else return -1; } return ciCharCompare(*p.first, *p.second); // ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å…³ç³» å’Œä¸åŒ¹é…çš„å­—ç¬¦ä¸€æ · } æ¯”è¾ƒè¿‡ç¨‹ å½“å­—ç¬¦åŒ¹é…æ—¶è¿™ä¸ªåˆ¤æ–­å¼è¿”å›trueï¼Œå› ä¸ºå½“åˆ¤æ–­å¼è¿”å›falseæ—¶mismatchä¼šåœæ­¢ã€‚æˆ‘ä»¬ä¸èƒ½ä¸ºæ­¤ä½¿ç”¨ciCharCompareï¼Œå› ä¸ºå®ƒè¿”å›-1ã€1æˆ–0ï¼Œè€Œå½“å­—ç¬¦åŒ¹é…æ—¶å®ƒè¿”å›0ï¼Œå°±åƒstrcmpã€‚ å¦‚æœæˆ‘ä»¬æŠŠciCharCompareä½œä¸ºåˆ¤æ–­å¼ä¼ ç»™mismatchï¼ŒC++ä¼šæŠŠciCharCompareçš„è¿”å›ç±»å‹è½¬æ¢ä¸ºboolï¼Œè€Œå½“ç„¶boolä¸­é›¶çš„ç­‰ä»·ç‰©æ˜¯falseï¼Œæ­£å¥½å’Œæˆ‘ä»¬æƒ³è¦çš„ç›¸åï¼åŒæ ·çš„ï¼Œå½“ciCharCompareè¿”å›1æˆ–-1ï¼Œé‚£ä¼šè¢«è§£é‡Šæˆtrueï¼Œå› ä¸ºï¼Œå°±åƒCï¼Œæ‰€æœ‰éé›¶æ•´æ•°å€¼éƒ½çœ‹ä½œtrueã€‚è¿™å†æ¬¡å’Œæˆ‘ä»¬æƒ³è¦çš„ç›¸åã€‚ è¦ä¿®æ­£è¿™ä¸ªè¯­ä¹‰å€’ç½®ï¼Œæˆ‘ä»¬åœ¨ciCharCompareå‰é¢æ”¾ä¸Šnot2å’Œptr_funã€‚ std::not1 å’Œ std::not2 std::not1 å’Œ std::not2æ˜¯ç”¨æ¥æŠŠâ€œç¬¦åˆæŸç§æ¡ä»¶çš„å‡½æ•°å¯¹è±¡â€è½¬æ¢ä¸ºåä¹‰å‡½æ•°å¯¹è±¡çš„å‡½æ•°ã€‚ std::ptr_funç”¨æ¥æŠŠå‡½æ•°æŒ‡é’ˆå°è£…ä¸ºç¬¦åˆæŸç§æ¡ä»¶çš„å‡½æ•°å¯¹è±¡çš„å‡½æ•°ï¼ŒC++11 é‡Œå¯ä»¥ç”¨std::bindæˆ–std::functionä»£æ›¿ ","date":"2023-08-28","objectID":"/posts/clause_35/:2:0","tags":["Effective STL"],"title":"Effective STL [35] | é€šè¿‡mismatchæˆ–lexicographicalæ¯”è¾ƒå®ç°ç®€å•çš„å¿½ç•¥å¤§å°å†™å­—ç¬¦ä¸²æ¯”è¾ƒ","uri":"/posts/clause_35/"},{"categories":["C++"],"content":"lexicographical_compare å¯ä»¥åœ¨å…³è”å®¹å™¨ä¸­ç”¨ä½œæ¯”è¾ƒå‡½æ•°çš„å‡½æ•°ï¼Œå¯ä»¥æŠŠciCharCompareä¿®æ”¹ä¸ºä¸€ä¸ªæœ‰åˆ¤æ–­å¼æ¥å£çš„å­—ç¬¦æ¯”è¾ƒå‡½æ•°ï¼Œç„¶åæŠŠè¿›è¡Œå­—ç¬¦ä¸²æ¯”è¾ƒçš„å·¥ä½œäº¤ç»™STLä¸­åå­—ç¬¬äºŒé•¿çš„ç®—æ³•â€”â€”lexicographical_compareï¼š // è¿”å›åœ¨å¿½ç•¥å¤§å°å†™çš„æƒ…å†µä¸‹c1æ˜¯å¦åœ¨c2å‰é¢ï¼› bool ciCharLess(char c1, char c2) { // æ¡æ¬¾46è§£é‡Šäº†ä¸ºä»€ä¹ˆä¸€ä¸ªå‡½æ•°å¯¹è±¡å¯èƒ½ æ¯”å‡½æ•°å¥½ tolower(static_cast\u003cunsigned char\u003e(c1)) \u003c tolower(static_cast\u003cunsigned char\u003e(c2)); } bool ciStringCompare(const string \u0026s1, const string \u0026s2) { // ç®—æ³•è°ƒç”¨çš„è®¨è®ºåœ¨ä¸‹æ–‡ return lexicographical_compare(s1.begin(), s1.end(), s2.begin(), s2.end(), ciCharLess); } lexicographical_compareæ˜¯strcmpçš„æ³›å‹ç‰ˆæœ¬ã€‚ strcmpåªå¯¹å­—ç¬¦æ•°ç»„èµ·ä½œç”¨ï¼Œä½†lexicographical_compareå¯¹æ‰€æœ‰ä»»ä½•ç±»å‹çš„å€¼çš„åŒºé—´éƒ½èµ·ä½œç”¨ã€‚ åŒæ—¶ï¼Œstrcmpæ€»æ˜¯æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦æ¥çœ‹çœ‹å®ƒä»¬çš„å…³ç³»æ˜¯ç›¸ç­‰ã€å°äºæˆ–å¤§äºå¦ä¸€ä¸ªã€‚lexicographical_compareå¯ä»¥ä¼ å…¥ä¸€ä¸ªå†³å®šä¸¤ä¸ªå€¼æ˜¯å¦æ»¡è¶³ä¸€ä¸ªç”¨æˆ·å®šä¹‰æ ‡å‡†çš„äºŒå…ƒåˆ¤æ–­å¼ã€‚ æ¯”è¾ƒè¿‡ç¨‹ åœ¨ä¸Šé¢çš„è°ƒç”¨ä¸­ï¼Œlexicographical_compareç”¨æ¥å¯»æ‰¾s1å’Œs2ç¬¬ä¸€ä¸ªä¸åŒçš„ä½ç½®ï¼ŒåŸºäºè°ƒç”¨ciCharLessçš„ç»“æœã€‚å¦‚æœï¼Œä½¿ç”¨é‚£ä¸ªä½ç½®çš„å­—ç¬¦ï¼ŒciCharLessè¿”å›trueï¼Œlexicographical_compareä¹Ÿæ˜¯ï¼›å¦‚æœï¼Œåœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸åŒçš„ä½ç½®ï¼Œä»ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æ¥çš„å­—ç¬¦å…ˆäºå¯¹åº”çš„æ¥è‡ªç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„å­—ç¬¦ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å°±å…ˆäºç¬¬äºŒä¸ªã€‚ å°±åƒstrcmpï¼Œlexicographical_compareè®¤ä¸ºä¸¤ä¸ªç›¸ç­‰å€¼çš„åŒºé—´æ˜¯ç›¸ç­‰çš„ï¼Œå› æ­¤å®ƒå¯¹äºè¿™æ ·çš„ä¸¤ä¸ªåŒºé—´è¿”å›falseï¼šç¬¬ä¸€ä¸ªåŒºé—´ä¸åœ¨ç¬¬äºŒä¸ªä¹‹å‰ã€‚ ä¹Ÿåƒstrcmpï¼Œå¦‚æœç¬¬ä¸€ä¸ªåŒºé—´åœ¨å‘ç°ä¸åŒçš„å¯¹åº”å€¼ä¹‹å‰å°±ç»“æŸäº†ï¼Œlexicographical_compareè¿”å›trueï¼šä¸€ä¸ªå…ˆäºä»»ä½•åŒºé—´çš„å‰ç¼€æ˜¯ä¸€ä¸ªå‰ç¼€ã€‚ ","date":"2023-08-28","objectID":"/posts/clause_35/:3:0","tags":["Effective STL"],"title":"Effective STL [35] | é€šè¿‡mismatchæˆ–lexicographicalæ¯”è¾ƒå®ç°ç®€å•çš„å¿½ç•¥å¤§å°å†™å­—ç¬¦ä¸²æ¯”è¾ƒ","uri":"/posts/clause_35/"},{"categories":["ML"],"content":"ä¸€ã€ åŸºæœ¬å®šä¹‰ å‡è®¾ç»™å®šäº‹ä»¶ $x$, åˆ™æˆ‘ä»¬æœ‰ä»¥ä¸‹å®šä¹‰: Probability: å–å€¼0~1 $$p(x) æˆ– q(x)$$ Information: å¯¹$p(x)$å–å¯¹æ•°ï¼ŒåŠ ç¬¦å·å¾—æ­£å€¼ $$I(p)=-\\log p(x)$$ æ¦‚ç‡è¶Šé«˜ï¼ŒåŒ…å«çš„ä¿¡æ¯å°ï¼Œå› ä¸ºäº‹ä»¶è¶Šæ¥è¶Šç¡®å®šã€‚ç›¸åï¼Œæ¦‚ç‡è¶Šä½ï¼ŒåŒ…å«çš„ä¿¡æ¯è¶Šå¤šï¼Œå› ä¸ºäº‹ä»¶å…·æœ‰å¾ˆå¤§çš„ä¸ç¡®å®šæ€§ã€‚ (Shannon)Entropy(ä¿¡æ¯ç†µ): $p(x)$å¯¹$I(x)$ å¹³å‡ $$ \\begin{aligned} H(p)\u0026 =\\mathbb{E}_{x\\sim P}[I(p)] \\ \u0026=\\sum p(x)I(p) \\ \u0026=-\\sum p(x)\\log p(x) \\end{aligned} $$ ç†µæ˜¯ä¿¡æ¯çš„å¹³å‡ï¼Œç›´è§‚ä¸Šï¼ŒShannonç†µæ˜¯ä¿¡æ¯åœ¨åŒä¸€åˆ†å¸ƒä¸‹çš„å¹³å‡ã€‚ KLæ•£åº¦æ¥æºäºä¿¡æ¯è®ºï¼Œä¿¡æ¯è®ºçš„ç›®çš„æ˜¯ä»¥ä¿¡æ¯å«é‡æ¥åº¦é‡æ•°æ®ã€‚ä¿¡æ¯è®ºçš„æ ¸å¿ƒæ¦‚å¿µæ˜¯ä¿¡æ¯ç†µ(Entropy)ï¼Œä½¿ç”¨Hæ¥è¡¨ç¤ºã€‚æ¦‚ç‡è®ºä¸­æ¦‚ç‡åˆ†å¸ƒæ‰€å«çš„ä¿¡æ¯é‡åŒæ ·å¯ä»¥ä½¿ç”¨ä¿¡æ¯ç†µæ¥åº¦é‡ã€‚ Note å¯¹äºä»»æ„æ¦‚ç‡äº‹ä»¶ï¼Œç”±äºå…¶æ¦‚ç‡$p(x) \\geq 0$ ä¸” $p(x) \\leq 0$, å› æ­¤ $H(p) \\geq 0$. Cross-Entropy: $p(x)$å¯¹$I(q)$å¹³å‡: $$ \\begin{aligned} H(p,q)\u0026 =\\mathbb{E}_{x\\sim P}[I(q)] \\ \u0026=\\sum p(x)I(q) \\ \u0026=-\\sum p(x)\\log q(x) \\end{aligned} $$ ç†µæ˜¯ä¿¡æ¯çš„å¹³å‡ï¼Œç›´è§‚ä¸Šï¼Œäº¤å‰ç†µæ˜¯ä¿¡æ¯åœ¨ä¸åŒåˆ†å¸ƒä¸‹çš„å¹³å‡ã€‚ KL divergence(Relative entropy/Information gain): $$ \\begin{aligned} D_{KL}(p||q)\u0026 =H(p,q)-H(p) \\ \u0026=-\\sum p(x)\\log q(x)+\\sum p(x)\\log p(x) \\ \u0026=-\\sum p(x)\\log\\frac{q(x)}{p(x)} \\ \u0026=\\sum p(x)\\log\\frac{p(x)}{q(x)} \\end{aligned} $$ ç›¸å¯¹ç†µ = äº¤å‰ç†µ - shannonç†µ éå¯¹ç§°$D_{KL}(p||q)\\neq D_{KL}(q||p)$ï¼Œäº¦ä¸æ»¡è¶³ä¸‰è§’ä¸ç­‰å¼ï¼Œæ•…ä¸æ˜¯è·ç¦»ã€‚ $D_{KL}(p||q)$ä¸º$p$ç›¸å¯¹äº$q$ï¼Œå€¼éè´Ÿï¼Œå–é›¶è‹¥$p=q$ã€‚ä»å…¬å¼ä¸Šçœ‹ï¼Œå°±æ˜¯æ‹¿$q$æ›¿ä»£$p$åç†µçš„å˜åŒ–ã€‚ $KL = Kullback-Leibler$ æ‰€è°“KLæ•£åº¦ï¼Œæ˜¯æŒ‡å½“æŸåˆ†å¸ƒq(x)è¢«ç”¨äºè¿‘ä¼¼p(x)æ—¶çš„ä¿¡æ¯æŸå¤±ã€‚ $$ D(p||q)=\\sum_{x\\in X}p(x)\\log\\frac{p(x)}{q(x)} $$ ä¹Ÿå°±æ˜¯è¯´ï¼Œq(x)èƒ½åœ¨å¤šå¤§ç¨‹åº¦ä¸Šè¡¨è¾¾p(x)æ‰€åŒ…å«çš„ä¿¡æ¯ï¼ŒKLæ•£åº¦è¶Šå¤§ï¼Œè¡¨è¾¾æ•ˆæœè¶Šå·®ã€‚ ","date":"2023-08-26","objectID":"/posts/kldivergence/:1:0","tags":["KL Divergence"],"title":"KL Divergence è¯¦è§£","uri":"/posts/kldivergence/"},{"categories":["ML"],"content":"äºŒã€ KL divergence ä¸€äº›æ€§è´¨ï¼ˆéæ­£å¼ï¼‰è¯æ˜ éå¯¹ç§°æ€§ $$ D_{KL}(p||q)-D_{KL}(q||p)=\\sum\\left(p(x)+q(x)\\right)\\log\\frac{p(x)}{q(x)} $$ æ˜“çŸ¥ï¼Œå½“$p(x) \\neq q(x)$æ—¶ï¼Œä¸Šå¼ä¸ä¸º0ã€‚æ•…ï¼Œ$D_{KL}(p||q)$å’Œ$D_{KL}(q||p)$éå¯¹ç§°ï¼Œæ˜¯ä¸åŒçš„ã€‚ï¼ˆæ­¤éƒ¨åˆ†ä¾§é‡äºè¯´æ˜å®ƒä»¬ä¸æ˜¯ä¸åŒçš„ï¼‰ éè´Ÿæ€§ $$ \\begin{aligned} -D_{KL}(p||q)\u0026 =\\sum p(x)\\log\\frac{q(x)}{p(x)} \\cr \u0026\\leq\\log\\sum p(x)\\frac{q(x)}{p(x)} \\cr \u0026=\\log1 \\cr \u0026=0 \\end{aligned} $$ å…¶ä¸­ï¼Œä¸ç­‰å¼éƒ¨åˆ†ä½¿ç”¨äº†Jensenâ€™s inequality å‡¹æ€§ $$ \\begin{aligned} \u0026D_{KL}[\\lambda p_1(x)+(1-\\lambda)p_2(x)||\\lambda q_1(x)+(1-\\lambda)q_2(x)] \\cr \u0026=\\sum\\left[\\lambda p_1(x)+(1-\\lambda)p_2(x)\\right]\\log\\frac{[\\lambda p_1(x)+(1-\\lambda)p_2(x)]}{[\\lambda q_1(x)+(1-\\lambda)q_2(x)]} \\cr \u0026\\leq\\sum\\left[\\lambda p_1(x)\\log\\frac{\\lambda p_1(x)}{\\lambda q_1(x)}+(1-\\lambda)p_2(x)\\log\\frac{(1-\\lambda)p_2(x)}{(1-\\lambda)q_2(x)}\\right] \\cr \u0026=\\lambda\\sum p_1(x)\\log\\frac{p_1(x)}{q_1(x)}+(1-\\lambda)\\sum p_2(x)\\log\\frac{p_2(x)}{q_2(x)} \\cr \u0026=\\lambda D_{KL}[p_1(x)||q_1(x)]+(1-\\lambda)D_{KL}[p_2(x)||q_2(x)] \\end{aligned} $$ å…¶ä¸­ï¼Œä¸ç­‰å¼éƒ¨åˆ†ç”¨åˆ°äº†log sum inequality ","date":"2023-08-26","objectID":"/posts/kldivergence/:2:0","tags":["KL Divergence"],"title":"KL Divergence è¯¦è§£","uri":"/posts/kldivergence/"},{"categories":["ML"],"content":"ä¸‰ã€æœ€å°åŒ–KL divergenceç›®æ ‡å‡½æ•° ä¸ºäº†æ–¹ä¾¿è¯´æ˜ï¼Œæˆ‘ä»¬åŸºäºå®šä¹‰åœ¨æŸä¸ªç©ºé—´$X$ä¸Šçš„åˆ†å¸ƒ$P$å’Œ$Q$æ¥é‡å†™ä¸€ä¸‹KLï¼Œ å¦‚ä¸‹æ‰€ç¤ºï¼š $$ D_{KL}(P||Q)=\\mathbb{E}_{x\\sim P}[\\log\\frac{P(X)}{Q(X)}] $$ å‡è®¾ï¼Œ$P$ä¸ºçœŸå®çš„åˆ†å¸ƒå‡½æ•°ï¼Œæˆ‘ä»¬æƒ³è¦ç”¨å¸¦å‚æ•° $\\theta$ çš„åˆ†å¸ƒå‡½æ•° $Q$ï¼Œå³ $Q_{\\theta}$ ï¼Œå»è¿‘ä¼¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡é€‰å–å‚æ•°$\\theta$ï¼Œ è®© $Q_{\\theta}$ å’Œ $P$ åœ¨æŸç§æ„ä¹‰ä¸Šå…·æœ‰ç›¸ä¼¼æ€§ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬åˆ†åˆ«å°†é€‰å–æ­£å‘KLå’Œåå‘KLåšä¸ºç›®æ ‡å‡½æ•°è¿›è¡Œè¯´æ˜ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å‡è®¾ $P$ ä¸ºåŒå³°åˆ†å¸ƒï¼Œ$Q_{\\theta}$ ä¸ºæ­£å¤ªåˆ†å¸ƒï¼Œæ•… $\\theta$ åŒ…å«å‡å€¼å’Œæ–¹å·®ä¸¤ä¸ªå‚æ•°ã€‚ æœ€å°åŒ–æ­£å‘KLç›®æ ‡å‡½æ•° ç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š $$ \\begin{aligned} \u0026\\arg\\min_{\\theta}D_{KL}(P||Q_{\\theta}) \\cr \u0026=\\arg\\min_\\theta\\mathbb{E}{x\\sim P}[\\log\\frac{P(X)}{Q(X)}] \\cr \u0026=\\arg\\min\\theta\\mathbb{E}{x\\sim P}[-\\log Q\\theta(X)]-H[P(X)] \\cr \u0026=\\arg\\min_\\theta\\mathbb{E}{x\\sim P}[-\\log Q\\theta(X)] \\cr \u0026=\\arg\\max_\\theta\\mathbb{E}{x\\sim P}[\\log Q\\theta(X)] \\end{aligned} $$ ä»æ­¤å¤„å¯ä»¥çœ‹å‡ºæœ€å°åŒ–æ­£å‘KLç›®æ ‡å‡½æ•°ï¼Œå…¶å®æ˜¯ç­‰ä»·äºé€šè¿‡ $Q_{\\theta}$ è¿›è¡Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°æ® $x$ ç”± $P$ äº§ç”Ÿï¼ŒåŸºäºè¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬é€‰å– $\\theta$ è®©å¹³å‡åœ¨ $P(X)$ ä¸Šçš„ $\\log Q_{\\theta}(X)$ ä¼¼ç„¶å‡½æ•°æœ€å¤§ï¼Œå³: å¹³å‡P(X)å„ä¸ªå³°å¤ªï¼ŒP(X)æ¦‚ç‡é«˜çš„åœ°æ–¹ï¼Œ$Q_{\\theta}(X)$ æ¦‚ç‡ä¹Ÿè¦é«˜ æ‰€ä»¥æˆ‘ä»¬æœ‰ä¸‹å›¾mean-seekingçš„ç»“æœ (ä½ ä¹Ÿå¯ä»¥ä»ä¿¡æ¯/ç†µçš„è§’åº¦å»ç†è§£ï¼Œé“ç†æ˜¯ä¸€æ ·çš„) æœ€å°åŒ–åå‘KLç›®æ ‡å‡½æ•° ç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š $$ \\begin{aligned} \u0026\\arg\\min_{\\theta}D_{KL}(Q_{\\theta}||P) \\cr \u0026=\\arg\\min_\\theta\\mathbb{E}{x\\sim Q\\theta}[\\log\\frac{Q_\\theta}{P(X)}] \\cr \u0026=\\arg\\min_\\theta\\mathbb{E}{x\\sim Q\\theta}[-\\log P(X)]-H[Q_\\theta(X)] \\cr \u0026=\\arg\\max_\\theta\\mathbb{E}{x\\sim Q\\theta}\\left[\\log P(X)\\right]+H[Q_\\theta(X)] \\end{aligned} $$ æ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é€‰å–å‚æ•° $\\theta$ï¼Œè®©å¹³å‡åœ¨ $Q_{\\theta}(X)$ ä¸Šçš„ $\\log P(X)$ ä¼¼ç„¶å‡½æ•°æœ€å¤§;åŒæ—¶ï¼Œè®©Shannonç†µ $H(Q_{\\theta}(X))$ ä¹Ÿæ¯”è¾ƒå¤§ï¼Œå³çº¦æŸ $Q_{\\theta}(X)$ ä¸è¦è¿‡äºé›†ä¸­ã€‚æ€»çš„æ¥çœ‹ï¼Œæˆ‘ä»¬æœ‰ï¼š å¹³å‡ $Q_{\\theta}(X)$ å„ä¸ªå³°å¤ªï¼Œ$Q_{\\theta}(X)$ æ¦‚ç‡é«˜çš„åœ°æ–¹ï¼Œ$P(X)$ æ¦‚ç‡ä¹Ÿè¦é«˜ï¼Œä½† $Q_{\\theta}(X)$ ä¸èƒ½è¿‡äºé›†ä¸­ å¯ä»¥æƒ³è±¡ï¼Œå¦‚æœæ²¡æœ‰ $H[Q_{\\theta}(X)]$ çš„çº¦æŸï¼Œå¯èƒ½ä¼šè°ƒæ•´ $\\theta$ï¼Œè®© $Q_{\\theta}(X)$ é›†ä¸­äº $P(X)$ æœ€å¤§çš„åœ°æ–¹ï¼Œå¾—åˆ°çš„å€¼ä¹Ÿä¼šæ¯”è¾ƒå¤§ã€‚æ‰€ä»¥ï¼Œ$H[Q_{\\theta}(X)]$ èµ·åˆ°äº†ä¸€ä¸ªæ­£åˆ™åŒ–ï¼ˆregularizationï¼‰çš„æ•ˆæœã€‚ æ‰€ä»¥æˆ‘ä»¬æœ‰ä¸‹å›¾mode-seeking çš„ç»“æœ: æ­£å‘æœ€å°åŒ–å’Œåå‘æœ€å°åŒ–æ”¾åœ¨ä¸€èµ·å¯¹æ¯”ï¼š æ­£å‘å’Œåå‘æœ€å°åŒ– æ­¤éƒ¨åˆ†ä»£ç æ¥è‡ªå‚è€ƒæ–‡çŒ®3ï¼Œä½†åœ¨è°ƒç”¨logsumexpæ—¶ï¼Œæœ‰ç‚¹é—®é¢˜ï¼Œæ•…åšäº†ä¸€ä¸ªå¾®å°æ”¹åŠ¨ï¼Œä»£ç æ”¾åœ¨å¾®ä¿¡å…¬ä¼—å·MoDataæ–‡ç« æœ€åï¼Œå¦‚æœæ„Ÿå…´è¶£ï¼Œç‚¹å‡»æ­¤å¤„ã€‚ ç›¸å…³å‚è€ƒèµ„æ–™ [1]. Cover, T. M., and J. A. Thomas. â€œElements of Information Theory,(2nd edn, 2006).â€ DOI: https://doi. org/10.1002 X 47174882 (2006). [2]. https://dibyaghosh.com/blog/probability/kldivergence.html [3]. https://www.tuananhle.co.uk/notes/r ref: [1]. KL-Divergenceè¯¦è§£ [2]. https://www.zhihu.com/tardis/zm/art/95687720?source_id=1005 [3]. http://hanj.cs.illinois.edu/cs412/bk3/KL-divergence.pdf [4]. KL è¿›é˜¶ ","date":"2023-08-26","objectID":"/posts/kldivergence/:3:0","tags":["KL Divergence"],"title":"KL Divergence è¯¦è§£","uri":"/posts/kldivergence/"},{"categories":["C++"],"content":"ä¸æ˜¯æ‰€æœ‰ç®—æ³•å¯ä»¥ç”¨äºä»»æ„åŒºé—´ã€‚æ¯”å¦‚ï¼Œremoveéœ€è¦å‰å‘è¿­ä»£å™¨å’Œå¯ä»¥é€šè¿‡è¿™äº›è¿­ä»£å™¨èµ‹å€¼çš„èƒ½åŠ›ã€‚æ‰€ä»¥ï¼Œå®ƒä¸èƒ½åº”ç”¨äºç”±è¾“å…¥è¿­ä»£å™¨åˆ’åˆ†çš„åŒºé—´ï¼Œä¹Ÿä¸èƒ½æ˜¯mapæˆ–multimapï¼Œä¹Ÿä¸èƒ½æ˜¯setå’Œmultisetçš„ä¸€äº›å®ç°ã€‚ åŒæ ·ï¼Œå¾ˆå¤šæ’åºç®—æ³•éœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œæ‰€ä»¥ä¸å¯èƒ½åœ¨ä¸€ä¸ªlistçš„å…ƒç´ ä¸Šè°ƒç”¨è¿™äº›ç®—æ³•ã€‚ æœ€å¸¸è§çš„å°±æ˜¯ä¸€äº›ç®—æ³•éœ€è¦æœ‰åºå€¼çš„åŒºé—´ã€‚æ— è®ºä½•æ—¶éƒ½åº”è¯¥åšæŒè¿™ä¸ªéœ€æ±‚ï¼Œå› ä¸ºå†’çŠ¯å®ƒä¸ä»…ä¼šå¯¼è‡´ç¼–è¯‘å™¨è¯Šæ–­ï¼Œè€Œä¸”ä¼šé€ æˆæœªå®šä¹‰çš„è¿è¡ŒæœŸè¡Œä¸ºã€‚ æ—¢å¯ä»¥å’Œæœ‰åºåˆå¯ä»¥å’Œæ— åºåŒºé—´åˆä½œçš„ç®—æ³•å¾ˆå°‘ï¼Œä½†å½“æ“ä½œæœ‰åºåŒºé—´çš„æ—¶å€™å®ƒä»¬æœ€æœ‰ç”¨ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_34/:0:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"åªèƒ½æ“ä½œæœ‰åºæ•°æ®çš„ç®—æ³•çš„è¡¨ binary_search lower_bound upper_bound equal_range set_union set_intersection set_difference set_symmetric_difference merge inplace_merge includes ","date":"2023-08-26","objectID":"/posts/clause_34/:1:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"ä¸€èˆ¬ç”¨äºæœ‰åºåŒºé—´ï¼Œä½†ä¸å¼ºåˆ¶è¦æ±‚ unique unique_copy ","date":"2023-08-26","objectID":"/posts/clause_34/:2:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"binary_searchã€lower_boundã€upper_boundå’Œequal_range æœç´¢ç®—æ³•binary_searchã€lower_boundã€upper_boundå’Œequal_rangeéœ€è¦æœ‰åºåŒºé—´ï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨äºŒåˆ†æ³•æŸ¥æ‰¾æ¥æœç´¢å€¼ã€‚åƒCåº“ä¸­çš„bsearchï¼Œè¿™äº›ç®—æ³•ä¿è¯äº†å¯¹æ•°æ—¶é—´çš„æŸ¥æ‰¾ï¼Œä½†ä½œä¸ºäº¤æ¢çš„æ˜¯ï¼Œä½ å¿…é¡»ç»™å®ƒä»¬å·²ç»æ’è¿‡åºçš„å€¼ã€‚ å®é™…ä¸Šï¼Œä»…å½“ä¼ ç»™å®ƒä»¬çš„æ˜¯éšæœºè®¿é—®è¿­ä»£å™¨æ—¶å®ƒä»¬æ‰èƒ½ä¿è¯æœ‰é‚£æ ·çš„æ€§èƒ½ã€‚ å¦‚æœç»™å®ƒä»¬å¨åŠ›æ¯”è¾ƒå°çš„è¿­ä»£å™¨ï¼ˆæ¯”å¦‚åŒå‘è¿­ä»£å™¨ï¼‰ï¼Œå®ƒä»¬ä»ç„¶è¿›è¡Œå¯¹æ•°æ¬¡æ¯”è¾ƒï¼Œä½†è¿è¡Œæ˜¯çº¿æ€§æ—¶é—´çš„ã€‚é‚£æ˜¯å› ä¸ºï¼Œç¼ºä¹è¿›è¡Œâ€œè¿­ä»£å™¨ç®—æœ¯ï¼ˆarithmeticï¼‰â€çš„èƒ½åŠ›ã€‚å®ƒä»¬åœ¨æœç´¢çš„åŒºé—´ä¸­éœ€è¦èŠ±è´¹çº¿æ€§æ—¶é—´æ¥ä»ä¸€ä¸ªåœ°æ–¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_34/:3:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"unionã€set_intersectionã€set_differenceå’Œset_symmetric_difference ç®—æ³•set_unionã€set_intersectionã€set_differenceå’Œset_symmetric_differenceçš„å››äººç»„æä¾›äº†çº¿æ€§æ—¶é—´è®¾ç½®å®ƒä»¬åå­—æ‰€æå‡ºçš„æ“ä½œçš„æ€§èƒ½ã€‚ ä¸ºä»€ä¹ˆå®ƒä»¬éœ€è¦æœ‰åºåŒºé—´ï¼Ÿå› ä¸ºå¦‚æœä¸æ˜¯çš„è¯ï¼Œå®ƒä»¬ä¸èƒ½ä»¥çº¿æ€§æ—¶é—´å®Œæˆå®ƒä»¬çš„å·¥ä½œã€‚ ä½ ä¼šå‘ç°ï¼Œéœ€è¦æœ‰åºåŒºé—´çš„ç®—æ³•ä¸ºäº†æ¯”å®ƒä»¬ç”¨äºå¯èƒ½æ— åºåŒºé—´æä¾›æ›´å¥½çš„æ€§èƒ½è€Œè¿™ä¹ˆåšã€‚ ","date":"2023-08-26","objectID":"/posts/clause_34/:4:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"mergeå’Œinplace_merge mergeå’Œinplace_mergeæ‰§è¡Œäº†æœ‰æ•ˆçš„å•éåˆå¹¶æ’åºç®—æ³•ï¼šå®ƒä»¬è¯»å–ä¸¤ä¸ªæœ‰åºåŒºé—´ï¼Œç„¶åäº§ç”Ÿä¸€ä¸ªåŒ…å«äº†ä¸¤ä¸ªæºåŒºé—´æ‰€æœ‰å…ƒç´ çš„æ–°æœ‰åºåŒºé—´ã€‚ å®ƒä»¬ä»¥çº¿æ€§æ—¶é—´æ‰§è¡Œï¼Œå¦‚æœå®ƒä»¬ä¸çŸ¥é“æºåŒºé—´å·²ç»æœ‰åºå°±ä¸èƒ½å®Œæˆã€‚ ","date":"2023-08-26","objectID":"/posts/clause_34/:5:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"includes includes ç”¨æ¥æ£€æµ‹æ˜¯å¦ä¸€ä¸ªåŒºé—´çš„æ‰€æœ‰å¯¹è±¡ä¹Ÿåœ¨å¦ä¸€ä¸ªåŒºé—´ä¸­ã€‚ å› ä¸ºincludeså¯èƒ½å‡è®¾å®ƒçš„ä¸¤ä¸ªåŒºé—´éƒ½å·²ç»æœ‰åºï¼Œæ‰€ä»¥å®ƒä¿è¯äº†çº¿æ€§æ—¶é—´æ€§èƒ½ã€‚æ²¡æœ‰é‚£ä¸ªä¿è¯ï¼Œä¸€èˆ¬æ¥è¯´å®ƒä¼šå˜æ…¢ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_34/:6:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"uniqueå’Œunique_copy uniqueå’Œunique_copyç”šè‡³åœ¨æ— åºåŒºé—´ä¸Šä¹Ÿæä¾›äº†å®šä¹‰è‰¯å¥½çš„è¡Œä¸ºã€‚ çœ‹çœ‹æ ‡å‡†æ˜¯æ€ä¹ˆæè¿°uniqueçš„è¡Œä¸ºçš„ï¼š ä»æ¯ä¸ªç›¸ç­‰å…ƒç´ çš„è¿ç»­ç»„ä¸­å»é™¤ç¬¬ä¸€ä¸ªä»¥å¤–æ‰€æœ‰çš„å…ƒç´ ã€‚ å¦‚æœä½ è¦uniqueä»ä¸€ä¸ªåŒºé—´å»é™¤æ‰€æœ‰é‡å¤å€¼ï¼ˆä¹Ÿå°±æ˜¯ï¼Œè®©åŒºé—´ä¸­æ‰€æœ‰å€¼â€œå”¯ä¸€â€ï¼‰ï¼Œä½ å¿…é¡»å…ˆç¡®ä¿æ‰€æœ‰é‡å¤å€¼ä¸€ä¸ªæ¥ç€ä¸€ä¸ªã€‚é‚£æ˜¯æ’åºå®Œæˆçš„ä¸œè¥¿ä¹‹ä¸€ã€‚ å®é™…ä¸Šï¼Œuniqueä¸€èˆ¬ç”¨äºä»åŒºé—´ä¸­å»é™¤æ‰€æœ‰é‡å¤å€¼ï¼Œæ‰€ä»¥ä½ å‡ ä¹æ€»æ˜¯è¦ç¡®ä¿ä½ ä¼ é€’ç»™uniqueï¼ˆæˆ–unique_copyï¼‰çš„åŒºé—´æ˜¯æœ‰åºçš„ã€‚Unixå¼€å‘è€…ä¼šå‘ç°STLçš„uniqueå’ŒUnixçš„uniqä¹‹é—´æœ‰æƒŠäººçš„ç›¸ä¼¼ã€‚ é¡ºä¾¿è¯´è¯´ï¼Œuniqueä»ä¸€ä¸ªåŒºé—´é™¤å»å…ƒç´ çš„æ–¹å¼å’Œremoveä¸€æ ·ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåªæ˜¯åŒºåˆ†å‡ºä¸é™¤å»çš„å…ƒç´ ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_34/:7:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"æ’åº å› ä¸ºSTLå…è®¸ä½ æŒ‡å®šç”¨äºæ’åºçš„æ¯”è¾ƒå‡½æ•°ï¼Œä¸åŒçš„åŒºé—´å¯èƒ½ä»¥ä¸åŒçš„æ–¹å¼æ’åºã€‚ æ¯”å¦‚ï¼Œç»™å®šä¸¤ä¸ªintçš„åŒºé—´ï¼Œä¸€ä¸ªå¯èƒ½ä»¥é»˜è®¤æ–¹å¼æ’åºï¼ˆä¹Ÿå°±æ˜¯å‡åºï¼‰ï¼Œè€Œå¦ä¸€ä¸ªä½¿ç”¨greater\u003cint\u003eæ’åºï¼Œå› æ­¤æ˜¯é™åºã€‚ ç»™å®šWidgetçš„ä¸¤ä¸ªåŒºé—´ï¼Œä¸€ä¸ªå¯èƒ½ä»¥ä»·æ ¼æ’åºè€Œå¦ä¸€ä¸ªå¯èƒ½ä»¥å¹´é¾„æ’åºã€‚å› ä¸ºæœ‰å¾ˆå¤šä¸åŒçš„æ–¹å¼æ¥æ’åºï¼Œæ‰€ä»¥ä¿è¯ç»™STLæ‰€ä½¿ç”¨çš„æ’åºç›¸å…³ä¿¡æ¯ä¸€è‡´æ˜¯å¾ˆé‡è¦çš„ã€‚ å¦‚æœä½ ä¼ ä¸€ä¸ªåŒºé—´ç»™ä¸€ä¸ªä¹Ÿå¸¦æœ‰æ¯”è¾ƒå‡½æ•°çš„ç®—æ³•ï¼Œç¡®ä¿ä½ ä¼ é€’çš„æ¯”è¾ƒå‡½æ•°è¡Œä¸ºå’Œä½ ç”¨äºæ’åºè¿™ä¸ªåŒºé—´çš„ä¸€æ ·ã€‚ vector\u003cint\u003e v; // å»ºç«‹ä¸€ä¸ªvectorï¼ŒæŠŠä¸€äº›æ•°æ®æ”¾è¿›å» ... sort(v.begin(), v.end(), greater\u003cint\u003e()); // é™åºæ’åˆ— ... // ä½¿ç”¨è¿™ä¸ªvectorï¼ˆæ²¡æœ‰æ”¹å˜å®ƒï¼‰ // åœ¨è¿™ä¸ªvectorä¸­æœç´¢5 bool is3Exists = binary_search(v.begin(), v.end(), 3); // å‡è®¾å®ƒæ˜¯å‡åºæ’åˆ—ï¼ é»˜è®¤æƒ…å†µä¸‹ï¼Œbinary_searchå‡è®¾å®ƒæœç´¢çš„åŒºé—´æ˜¯ä»¥â€œ\u003câ€æ’åºï¼ˆä¹Ÿå°±æ˜¯ï¼Œå€¼æ˜¯å‡åºï¼‰ï¼Œä½†åœ¨æœ¬ä¾‹ä¸­ï¼Œè¿™ä¸ªvectoræ˜¯é™åºã€‚å½“ä½ åœ¨å€¼çš„æ’åˆ—é¡ºåºå’Œç®—æ³•æ‰€æœŸæœ›çš„ä¸åŒçš„åŒºé—´ä¸Šè°ƒç”¨binary_search (æˆ–lower_boundç­‰ï¼‰ä¼šå¯¼è‡´æœªå®šä¹‰çš„ç»“æœã€‚ ","date":"2023-08-26","objectID":"/posts/clause_34/:8:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"æ­£ç¡®æ’åºæ–¹å¼ è¦è®©ä»£ç è¡Œä¸ºæ­£ç¡®ï¼Œä½ å¿…é¡»å‘Šè¯‰binary_searchè¦ä½¿ç”¨å’ŒsortåŒæ ·çš„æ¯”è¾ƒå‡½æ•°ï¼š bool is3Exists = // æœç´¢3 binary_search(v.begin(), v.end(), 3, greater\u003cint\u003e()); // æ¯”è¾ƒå‡½æ•°æŠŠgreaterä½œä¸º æ‰€æœ‰éœ€è¦æœ‰åºåŒºé—´çš„ç®—æ³•ï¼ˆä¹Ÿå°±æ˜¯é™¤äº†uniqueå’Œunique_copyå¤–æœ¬æ¡æ¬¾çš„æ‰€æœ‰ç®—æ³•ï¼‰é€šè¿‡ç­‰ä»·æ¥åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦â€œç›¸åŒâ€ï¼Œå°±åƒæ ‡å‡†å…³è”å®¹å™¨ï¼ˆå®ƒä»¬æœ¬èº«æ˜¯æœ‰åºçš„ï¼‰ã€‚ç›¸åï¼Œuniqueå’Œunique_copyåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡â€œç›¸åŒâ€çš„é»˜è®¤æ–¹å¼æ˜¯é€šè¿‡ç›¸ç­‰ï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ä¼ ç»™è¿™äº›ç®—æ³•ä¸€ä¸ªå®šä¹‰äº†â€œç›¸åŒâ€çš„æ„ä¹‰çš„åˆ¤æ–­å¼æ¥è¦†ç›–è¿™ä¸ªé»˜è®¤æƒ…å†µã€‚ ","date":"2023-08-26","objectID":"/posts/clause_34/:8:1","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"æ€»ç»“ 11ä¸ªéœ€è¦æœ‰åºåŒºé—´çš„ç®—æ³•ä¸ºäº†æ¯”å…¶ä»–å¯èƒ½æ€§æä¾›æ›´å¥½çš„æ€§èƒ½è€Œéœ€è¦ä¼ ç»™å®ƒä»¬æœ‰åºåŒºé—´ï¼Œéœ€è¦ä¿è¯ç”¨äºç®—æ³•çš„æ¯”è¾ƒå‡½æ•°å’Œç”¨äºæ’åºçš„ä¸€è‡´ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_34/:9:0","tags":["Effective STL"],"title":"Effective STL [34] | æ³¨æ„å“ªä¸ªç®—æ³•éœ€è¦æœ‰åºåŒºé—´","uri":"/posts/clause_34/"},{"categories":["C++"],"content":"åˆ é™¤å«æœ‰æŒ‡é’ˆçš„å®¹å™¨å…ƒç´  å¦‚æœä½ åœ¨ç®¡ç†ä¸€å †åŠ¨æ€åˆ†é…çš„Widgetsï¼Œæ¯ä¸€ä¸ªéƒ½å¯èƒ½é€šè¿‡æ£€éªŒï¼Œä½ æŠŠç»“æœæŒ‡é’ˆä¿å­˜åœ¨ä¸€ä¸ªvectorä¸­ï¼š class Widget{ public: ... // è¿™ä¸ªWidgetæ˜¯å¦é€šè¿‡æ£€éªŒ bool isCertified() const; ... }; // å»ºç«‹ä¸€ä¸ªvectorç„¶åç”¨åŠ¨æ€åˆ†é…çš„Widgetçš„æŒ‡é’ˆå¡«å…… vector\u003cWidget*\u003e v; ... v.push_back(new Widget); å½“å’Œvå·¥ä½œä¸€æ®µæ—¶é—´åï¼Œä½ å†³å®šé™¤å»æœªé€šè¿‡æ£€éªŒçš„Widgetï¼Œå› ä¸ºä½ ä¸å†éœ€è¦å®ƒä»¬äº†ã€‚ å°½é‡ç”¨ç®—æ³•è°ƒç”¨ä»£æ›¿æ˜¾å¼å¾ªç¯å’Œå…³äºremoveå’Œeraseä¹‹é—´å…³ç³»çš„æè¿°ï¼Œä½ è‡ªç„¶ä¼šæƒ³åˆ°è½¬å‘erase-removeæƒ¯ç”¨æ³•ï¼Œè™½ç„¶è¿™æ¬¡ä½ ä½¿ç”¨äº†remove_ifï¼š v.erase(remove_if(v.begin(), v.end(), // åˆ é™¤æœªé€šè¿‡æ£€éªŒçš„WidgetæŒ‡é’ˆ not1(mem_fun(\u0026Widget::isCertified))), v.end()); // å…³äºmem_funçš„ä¿¡æ¯å‚è§æ¡æ¬¾41 æ¡æ¬¾7ä»‹ç»è¿‡æ‘§æ¯å®¹å™¨ä¸­çš„ä¸€ä¸ªæŒ‡é’ˆä¹Ÿä¸ä¼šåˆ é™¤æŒ‡é’ˆæŒ‡å‘çš„ä¸œè¥¿çš„è®¨è®ºï¼Œæ‰€ä»¥è¿™é‡Œå½“è°ƒç”¨eraseæ—¶ï¼Œæå¯èƒ½ä½ å·²ç»æ³„æ¼äº†èµ„æºã€‚ ","date":"2023-08-26","objectID":"/posts/clause_33/:1:0","tags":["Effective STL"],"title":"Effective STL [33] | æé˜²åœ¨æŒ‡é’ˆçš„å®¹å™¨ä¸Šä½¿ç”¨ç±»ä¼¼removeçš„ç®—æ³•","uri":"/posts/clause_33/"},{"categories":["C++"],"content":"èµ„æºæ³„éœ²åˆ†æ æˆ‘ä»¬å‡è®¾åœ¨è°ƒç”¨remove_ifå‰ï¼Œvçœ‹èµ·æ¥åƒè¿™æ ·ï¼š åœ¨è°ƒç”¨remove_ifåï¼Œä¸€èˆ¬æ¥è¯´vçœ‹èµ·æ¥åƒè¿™æ ·ï¼ˆåŒ…å«ä»remove_ifè¿”å›çš„è¿­ä»£å™¨ï¼‰ï¼š èµ„æºæ³„æ¼çš„ç†ç”±ç°åœ¨å¾ˆæ˜æœ—äº†ã€‚æŒ‡å‘Widget Bå’ŒCçš„â€œåˆ é™¤çš„â€æŒ‡é’ˆè¢«vectorä¸­åé¢çš„â€œä¸åˆ é™¤çš„â€æŒ‡é’ˆè¦†ç›–ã€‚æ²¡æœ‰ä»€ä¹ˆæŒ‡å‘ä¸¤ä¸ªæœªé€šè¿‡æ£€éªŒçš„Widgetï¼Œå®ƒä»¬ä¹Ÿæ²¡æœ‰è¢«åˆ é™¤ï¼Œå®ƒä»¬çš„å†…å­˜å’Œå…¶ä»–èµ„æºæ³„æ¼äº†ã€‚ ä¸€æ—¦remove_ifå’Œeraseè¿”å›åï¼Œæƒ…å†µçœ‹èµ·æ¥åƒè¿™æ ·ï¼š ç°åœ¨ä½ ä¹Ÿå¾ˆæ¸…æ¥šä¸ºä»€ä¹ˆåº”è¯¥åŠªåŠ›é¿å…åœ¨åŠ¨æ€åˆ†é…çš„æŒ‡é’ˆçš„å®¹å™¨ä¸Šä½¿ç”¨removeå’Œç±»ä¼¼ç®—æ³•ï¼ˆremove_ifå’Œuniqueï¼‰ã€‚ åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä½ ä¼šå‘ç°partitionç®—æ³•æ˜¯åˆç†çš„æ›¿ä»£å“ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_33/:2:0","tags":["Effective STL"],"title":"Effective STL [33] | æé˜²åœ¨æŒ‡é’ˆçš„å®¹å™¨ä¸Šä½¿ç”¨ç±»ä¼¼removeçš„ç®—æ³•","uri":"/posts/clause_33/"},{"categories":["C++"],"content":"æ­£ç¡®åˆ é™¤åšæ³• å¦‚æœä½ æ— æ³•é¿å…åœ¨é‚£æ ·çš„å®¹å™¨ä¸Šä½¿ç”¨removeï¼Œæ’é™¤è¿™ä¸ªé—®é¢˜ä¸€ç§æ–¹æ³•æ˜¯åœ¨åº”ç”¨erase-removeæƒ¯ç”¨æ³•ä¹‹å‰å…ˆåˆ é™¤æŒ‡é’ˆå¹¶è®¾ç½®å®ƒä»¬ä¸ºç©ºï¼Œç„¶åé™¤å»å®¹å™¨ä¸­çš„æ‰€æœ‰ç©ºæŒ‡é’ˆï¼š void delAndNullifyUncertified(Widget *\u0026pWidget) { // å¦‚æœ*pWidgetæ˜¯ä¸€ä¸ªæœªé€šè¿‡æ£€éªŒWidgetï¼Œ if (!pWidget-\u003eisCertified()) { // åˆ é™¤æŒ‡é’ˆ delete pWidget; // å¹¶ä¸”è®¾ç½®å®ƒä¸ºç©º pWidget = 0; } } // æŠŠæ‰€æœ‰æŒ‡å‘æœªé€šè¿‡æ£€éªŒWidgetçš„æŒ‡é’ˆåˆ é™¤å¹¶ä¸”è®¾ç½®ä¸ºç©º for_each(v.begin(), v.end(), delAndNullifyUncertified); // ä»vä¸­é™¤å»ç©ºæŒ‡é’ˆ0å¿…é¡»æ˜ å°„åˆ°ä¸€ä¸ªæŒ‡é’ˆï¼Œ v.erase(remove(v.begin(), v.end(), static_cast\u003cWidget *\u003e(0)), v.end()); // è®©C++å¯ä»¥æ­£ç¡®åœ°æ¨å‡ºremoveçš„ç¬¬ä¸‰ä¸ªå‚æ•°çš„ç±»å‹ å½“ç„¶ï¼Œè¿™å‡è®¾vectorå¹¶ä¸å®¹çº³ä»»ä½•ä½ æƒ³ä¿ç•™çš„ç©ºæŒ‡é’ˆã€‚å¦‚æœæœ‰çš„è¯ï¼Œä½ å¯èƒ½å¿…é¡»è‡ªå·±å†™å¾ªç¯æ¥æŒ‰ä½ çš„æ–¹å¼åˆ é™¤æŒ‡é’ˆã€‚ ","date":"2023-08-26","objectID":"/posts/clause_33/:3:0","tags":["Effective STL"],"title":"Effective STL [33] | æé˜²åœ¨æŒ‡é’ˆçš„å®¹å™¨ä¸Šä½¿ç”¨ç±»ä¼¼removeçš„ç®—æ³•","uri":"/posts/clause_33/"},{"categories":["C++"],"content":"æ™ºèƒ½æŒ‡é’ˆ å¦‚æœä½ æŠŠæŒ‡é’ˆçš„å®¹å™¨æ›¿æ¢æˆæ‰§è¡Œå¼•ç”¨è®¡æ•°çš„æ™ºèƒ½æŒ‡é’ˆçš„å®¹å™¨ï¼Œåˆ é™¤ç›¸å…³çš„å›°éš¾å°±ä¸å­˜åœ¨äº†ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨erase-removeæƒ¯ç”¨æ³•ï¼š template\u003ctypename T\u003e // RCSP = â€œå¼•ç”¨è®¡æ•°æ™ºèƒ½æŒ‡é’ˆâ€ class RCSP { ...}; // RCSPW = â€œRCSP to Widgetâ€ typedef RCSP\u003c Widget\u003e RCSPW; // å»ºç«‹ä¸€ä¸ªvectorï¼Œç”¨åŠ¨æ€åˆ†é…Widgetçš„æ™ºèƒ½æŒ‡é’ˆå¡«å……å®ƒ vector\u003cRCSPW \u003e v; v.push_back(RCSPW(new Widget)); ... // eraseæœªé€šè¿‡æ£€éªŒçš„Widgetçš„æŒ‡é’ˆ v.erase(remove_if(v.begin(), v.end(), not1 (mem_fun(\u0026Widget::isCertified))), v.end()); // æ²¡æœ‰èµ„æºæ³„æ¼ è¦è®©è¿™äº›å·¥ä½œï¼Œä½ çš„æ™ºèƒ½æŒ‡é’ˆç±»å‹å°±å¿…é¡»å¯ä»¥ï¼ˆæ¯”å¦‚RCSP\u003cWidget\u003eï¼‰éšå¼è½¬æ¢ä¸ºç›¸åº”çš„å†…å»ºæŒ‡é’ˆç±»å‹ï¼ˆæ¯”å¦‚Widget*ï¼‰ã€‚é‚£æ˜¯å› ä¸ºå®¹å™¨æŒæœ‰æ™ºèƒ½æŒ‡é’ˆï¼Œä½†è¢«è°ƒç”¨çš„æˆå‘˜å‡½æ•°ï¼ˆæ¯”å¦‚Widget::isCertifiedï¼‰è¦çš„æ˜¯å†…å»ºæŒ‡é’ˆã€‚å¦‚æœä¸å­˜åœ¨éšå¼è½¬æ¢ï¼Œä½ çš„ç¼–è¯‘å™¨ä¼šæŠ—è®®çš„ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_33/:3:1","tags":["Effective STL"],"title":"Effective STL [33] | æé˜²åœ¨æŒ‡é’ˆçš„å®¹å™¨ä¸Šä½¿ç”¨ç±»ä¼¼removeçš„ç®—æ³•","uri":"/posts/clause_33/"},{"categories":["C++"],"content":"removeå®é™…ä½œç”¨ ","date":"2023-08-26","objectID":"/posts/clause_32/:1:0","tags":["Effective STL"],"title":"Effective STL [32] | å¦‚æœä½ çœŸçš„æƒ³åˆ é™¤ä¸œè¥¿çš„è¯å°±åœ¨ç±»ä¼¼removeçš„ç®—æ³•åæ¥ä¸Šerase","uri":"/posts/clause_32/"},{"categories":["C++"],"content":"removeçš„å£°æ˜ template\u003cclass ForwardIterator, class T\u003e ForwardIterator remove(ForwardIterator first, ForwardIterator last, const T\u0026 value); removeæ¥æ”¶æŒ‡å®šå®ƒæ“ä½œçš„å…ƒç´ åŒºé—´çš„ä¸€å¯¹è¿­ä»£å™¨ã€‚å®ƒä¸æ¥æ”¶ä¸€ä¸ªå®¹å™¨ï¼Œæ‰€ä»¥removeä¸çŸ¥é“å®ƒä½œç”¨äºå“ªä¸ªå®¹å™¨ã€‚ æ­¤å¤–ï¼Œremoveä¹Ÿä¸å¯èƒ½å‘ç°å®¹å™¨ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•ä»ä¸€ä¸ªè¿­ä»£å™¨è·å–å¯¹åº”äºå®ƒçš„å®¹å™¨ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_32/:1:1","tags":["Effective STL"],"title":"Effective STL [32] | å¦‚æœä½ çœŸçš„æƒ³åˆ é™¤ä¸œè¥¿çš„è¯å°±åœ¨ç±»ä¼¼removeçš„ç®—æ³•åæ¥ä¸Šerase","uri":"/posts/clause_32/"},{"categories":["C++"],"content":"removeä¸åšä»€ä¹ˆ ä»å®¹å™¨ä¸­é™¤å»ä¸€ä¸ªå…ƒç´ ï¼Œå”¯ä¸€çš„æ–¹æ³•æ˜¯è°ƒç”¨é‚£ä¸ªå®¹å™¨çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œå‡ ä¹éƒ½æ˜¯eraseçš„æŸä¸ªå½¢å¼ï¼Œ(listæœ‰å‡ ä¸ªé™¤å»å…ƒç´ çš„æˆå‘˜å‡½æ•°ä¸å«eraseï¼Œä½†å®ƒä»¬ä»ç„¶æ˜¯æˆå‘˜å‡½æ•°ã€‚)å› ä¸ºå”¯ä¸€ä»å®¹å™¨ä¸­é™¤å»ä¸€ä¸ªå…ƒç´ çš„æ–¹æ³•æ˜¯åœ¨é‚£ä¸ªå®¹å™¨ä¸Šè°ƒç”¨ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œè€Œä¸”å› ä¸ºremoveæ— æ³•çŸ¥é“å®ƒæ­£åœ¨æ“ä½œçš„å®¹å™¨ï¼Œæ‰€ä»¥removeä¸å¯èƒ½ä»ä¸€ä¸ªå®¹å™¨ä¸­é™¤å»å…ƒç´ ã€‚ ä»ä¸€ä¸ªå®¹å™¨ä¸­removeå…ƒç´ ä¸ä¼šæ”¹å˜å®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼š vector\u003cint\u003e v; v.reserve(10); // å»ºç«‹ä¸€ä¸ªvector\u003cint\u003e ç”¨1-10å¡«å……å®ƒ(è°ƒç”¨reserveçš„è§£é‡Šåœ¨æ¡æ¬¾14) for (int i = 1; i \u003c= 10; ++i) { v.push_back(i); } cout \u003c\u003c v.size(); // æ‰“å°10 v[3] = v[5] = v[9] = 99; // è®¾ç½®3ä¸ªå…ƒç´ ä¸º99 remove(v.begin(), v.end(), 99); // åˆ é™¤æ‰€æœ‰ç­‰äº99çš„å…ƒç´  cout \u003c\u003c v.size(); // ä»ç„¶æ˜¯10ï¼ removeå¹¶ä¸â€œçœŸçš„â€åˆ é™¤ä¸œè¥¿ï¼Œå› ä¸ºå®ƒåšä¸åˆ°ã€‚ removeä¸çŸ¥é“å®ƒè¦ä»å“ªä¸ªå®¹å™¨åˆ é™¤ä¸œè¥¿ï¼Œè€Œæ²¡æœ‰å®¹å™¨ï¼Œå®ƒå°±æ²¡æœ‰åŠæ³•è°ƒç”¨æˆå‘˜å‡½æ•°ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_32/:1:2","tags":["Effective STL"],"title":"Effective STL [32] | å¦‚æœä½ çœŸçš„æƒ³åˆ é™¤ä¸œè¥¿çš„è¯å°±åœ¨ç±»ä¼¼removeçš„ç®—æ³•åæ¥ä¸Šerase","uri":"/posts/clause_32/"},{"categories":["C++"],"content":"remove åšäº†ä»€ä¹ˆ removeç§»åŠ¨æŒ‡å®šåŒºé—´ä¸­çš„å…ƒç´ ç›´åˆ°æ‰€æœ‰â€œä¸åˆ é™¤çš„â€å…ƒç´ åœ¨åŒºé—´çš„å¼€å¤´(ç›¸å¯¹ä½ç½®å’ŒåŸæ¥å®ƒä»¬çš„ä¸€æ ·)ã€‚å®ƒè¿”å›ä¸€ä¸ªæŒ‡å‘æœ€åä¸€ä¸ªçš„ä¸‹ä¸€ä¸ªâ€œä¸åˆ é™¤çš„â€å…ƒç´ çš„è¿­ä»£å™¨ã€‚è¿”å›å€¼æ˜¯åŒºé—´çš„â€œæ–°é€»è¾‘ç»ˆç‚¹â€ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œè¿™æ˜¯våœ¨è°ƒç”¨removeå‰çœ‹èµ·æ¥çš„æ ·å­ï¼š å¦‚æœæˆ‘ä»¬æŠŠremoveçš„è¿”å›å€¼å­˜æ”¾åœ¨ä¸€ä¸ªå«åšnewEndçš„æ–°è¿­ä»£å™¨ä¸­: vector\u003cint\u003e::iterator newEnd(remove(v.begin(), v.end(), 99)); è¿™æ˜¯è°ƒç”¨åvçœ‹èµ·æ¥çš„æ ·å­: å¦‚æœâ€œä¸åˆ é™¤çš„â€å…ƒç´ åœ¨vä¸­çš„v.begin()å’ŒnewEndä¹‹é—´ï¼Œâ€œåˆ é™¤çš„â€å…ƒç´ å°±å¿…é¡»åœ¨newEndå’Œv.end()ä¹‹é—´ã€‚ removeå¹¶æ²¡æœ‰æ”¹å˜åŒºé—´ä¸­å…ƒç´ çš„é¡ºåºï¼Œæ‰€ä»¥ä¸ä¼šæŠŠæ‰€æœ‰â€œåˆ é™¤çš„â€å…ƒç´ æ”¾åœ¨ç»“å°¾ï¼Œå¹¶å®‰æ’æ‰€æœ‰â€œä¸åˆ é™¤çš„â€å€¼åœ¨å¼€å¤´ã€‚ å¦‚æœä½ ä¸æƒ³å¤±å»ä»»ä½•å€¼ï¼Œä½ å¯èƒ½åº”è¯¥è°ƒç”¨partitionæˆ–stable_partitionè€Œä¸æ˜¯removeã€‚ ","date":"2023-08-26","objectID":"/posts/clause_32/:1:3","tags":["Effective STL"],"title":"Effective STL [32] | å¦‚æœä½ çœŸçš„æƒ³åˆ é™¤ä¸œè¥¿çš„è¯å°±åœ¨ç±»ä¼¼removeçš„ç®—æ³•åæ¥ä¸Šerase","uri":"/posts/clause_32/"},{"categories":["C++"],"content":"remove å®é™…æ“ä½œæµç¨‹ åœ¨å†…éƒ¨ï¼Œremoveéå†è¿™ä¸ªåŒºé—´ï¼ŒæŠŠè¦â€œåˆ é™¤çš„â€å€¼è¦†ç›–ä¸ºåé¢è¦ä¿ç•™çš„å€¼ã€‚è¿™ä¸ªè¦†ç›–é€šè¿‡å¯¹æŒæœ‰è¢«è¦†ç›–çš„å€¼çš„å…ƒç´ èµ‹å€¼æ¥å®Œæˆã€‚ removeæ£€æµ‹v[0]ï¼Œå‘ç°å®ƒçš„å€¼ä¸æ˜¯è¦è¢«åˆ é™¤çš„ï¼Œç„¶åç§»åŠ¨åˆ°v[1]ã€‚åŒæ ·çš„æƒ…å†µå‘ç”Ÿåœ¨v[1]å’Œv[2]ã€‚ å‘ç°v[3]åº”è¯¥è¢«åˆ é™¤ï¼Œæ‰€ä»¥å®ƒè®°å½•ä¸‹v[3]çš„å€¼åº”è¯¥è¢«è¦†ç›–ï¼Œç„¶åå®ƒç§»åŠ¨åˆ°v[4]ã€‚è¿™ç±»ä¼¼è®°å½•v[3]æ˜¯ä¸€ä¸ªéœ€è¦å¡«å……çš„â€œæ´â€ã€‚ å‘ç°v[4]çš„å€¼åº”è¯¥è¢«ä¿æŒï¼Œæ‰€ä»¥å®ƒæŠŠv[4]èµ‹ç»™v[3]ï¼Œè®°å½•ä¸‹v[4]åº”è¯¥è¢«è¦†ç›–ï¼Œç„¶åç§»åŠ¨åˆ°v[5]ã€‚ç»§ç»­ç±»ä¼¼çš„å‹ç¼©ï¼Œå®ƒç”¨v[4]â€œå¡«å……â€v[3]è€Œä¸”è®°å½•v[4]ç°åœ¨æ˜¯ä¸€ä¸ªæ´ã€‚ å‘ç°v[5]åº”è¯¥è¢«åˆ é™¤ï¼Œæ‰€ä»¥å¿½ç•¥å¹¶å®ƒç§»åŠ¨åˆ°v[6]ã€‚ä»ç„¶è®°å¾—v[4]æ˜¯ä¸€ä¸ªç­‰å¾…å¡«å……çš„æ´ã€‚ å‘ç°v[6]æ˜¯ä¸€ä¸ªåº”è¯¥ä¿ç•™çš„å€¼ï¼Œæ‰€ä»¥æŠŠv[6]èµ‹ç»™v[4]ã€‚è®°å¾—v[5]ç°åœ¨æ˜¯ä¸‹ä¸€ä¸ªè¦è¢«å¡«å……çš„æ´ï¼Œç„¶åç§»åˆ°v[7]ã€‚ åœ¨æŸç§æ„ä¹‰ä¸Šç±»ä¼¼ä¸Šé¢çš„ï¼Œæ£€æŸ¥v[7]ã€v[8]å’Œv[9]ã€‚æŠŠv[7]èµ‹ç»™v[5]ï¼Œv[8]èµ‹ç»™v[6]ï¼Œå¿½ç•¥v[9]ï¼Œå› ä¸ºv[9]çš„å€¼æ˜¯è¦è¢«åˆ é™¤çš„ã€‚ è¿”å›æŒ‡å®šä¸‹ä¸€ä¸ªè¦è¢«è¦†ç›–çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­è¿™ä¸ªå…ƒç´ æ˜¯v[7]ã€‚ äº‹å®ä¸Šå½“removeåœ¨åˆ é™¤æ—¶è¦†ç›–çš„å€¼æ˜¯æŒ‡é’ˆæ—¶ï¼Œä¼šæœ‰é‡è¦çš„å½±å“ã€‚ä½†æ˜¯å¯¹äºæœ¬æ¡æ¬¾ï¼ŒçŸ¥é“removeä¸ä»å®¹å™¨ä¸­é™¤å»ä»»ä½•å…ƒç´ å› ä¸ºå®ƒåšä¸åˆ°å°±å¤Ÿäº†ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_32/:1:4","tags":["Effective STL"],"title":"Effective STL [32] | å¦‚æœä½ çœŸçš„æƒ³åˆ é™¤ä¸œè¥¿çš„è¯å°±åœ¨ç±»ä¼¼removeçš„ç®—æ³•åæ¥ä¸Šerase","uri":"/posts/clause_32/"},{"categories":["C++"],"content":"åº”è¯¥åœ¨removeåé¢æ¥ä¸Šerase åªæœ‰å®¹å™¨æˆå‘˜å‡½æ•°å¯ä»¥é™¤å»å®¹å™¨å…ƒç´ ï¼Œè€Œé‚£æ˜¯æœ¬æ¡æ¬¾çš„æ•´ä¸ªè¦ç‚¹ï¼šå¦‚æœä½ çœŸçš„è¦åˆ é™¤ä¸œè¥¿çš„è¯ï¼Œä½ åº”è¯¥åœ¨removeåé¢æ¥ä¸Šeraseã€‚ è¦é™¤å»é‚£äº›å…ƒç´ ï¼Œä½ è¦åšçš„æ‰€æœ‰äº‹æƒ…å°±æ˜¯ç”¨é‚£ä¸¤ä¸ªè¿­ä»£å™¨è°ƒç”¨eraseçš„åŒºé—´å½¢å¼ã€‚å› ä¸ºremoveæœ¬èº«å¾ˆæ–¹ä¾¿åœ°è¿”å›äº†åŒºé—´æ–°é€»è¾‘ç»ˆç‚¹çš„è¿­ä»£å™¨: vector\u003cint\u003e v; // æ­£å¦‚ä»å‰ v.erase(remove(v.begin(), v.end(), 99), v.end()); cout \u003c\u003c v.size(); // çœŸçš„åˆ é™¤æ‰€æœ‰ç­‰äº99çš„å…ƒç´ ï¼Œç°åœ¨è¿”å›7 äº‹å®ä¸Šï¼Œremoveå’Œeraseæ˜¯äº²å¯†è”ç›Ÿï¼Œè¿™ä¸¤ä¸ªæ•´åˆåˆ°listæˆå‘˜å‡½æ•°removeä¸­ã€‚è¿™æ˜¯STLä¸­å”¯ä¸€åå«removeåˆèƒ½ä»å®¹å™¨ä¸­é™¤å»å…ƒç´ çš„å‡½æ•°ï¼š list\u003cint\u003e li; // å»ºç«‹ä¸€ä¸ªlistæ”¾ä¸€äº›å€¼è¿›å» li.remove(99); // é™¤å»æ‰€æœ‰ç­‰äº99çš„å…ƒç´ ï¼šçœŸçš„åˆ é™¤å…ƒç´ ï¼Œæ‰€ä»¥å®ƒçš„å¤§å°å¯èƒ½æ”¹å˜äº† è°ƒç”¨è¿™ä¸ªremoveå‡½æ•°æ˜¯ä¸€ä¸ªSTLä¸­çš„çŸ›ç›¾ã€‚åœ¨å…³è”å®¹å™¨ä¸­ç±»ä¼¼çš„å‡½æ•°å«eraseï¼Œlistçš„removeä¹Ÿå¯ä»¥å«åšeraseã€‚ä½†å®ƒæ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éƒ½å¿…é¡»ä¹ æƒ¯å®ƒã€‚ å¯¹äºlistï¼Œè°ƒç”¨removeæˆå‘˜å‡½æ•°æ¯”åº”ç”¨erase-removeæƒ¯ç”¨æ³•æ›´é«˜æ•ˆã€‚ ","date":"2023-08-26","objectID":"/posts/clause_32/:2:0","tags":["Effective STL"],"title":"Effective STL [32] | å¦‚æœä½ çœŸçš„æƒ³åˆ é™¤ä¸œè¥¿çš„è¯å°±åœ¨ç±»ä¼¼removeçš„ç®—æ³•åæ¥ä¸Šerase","uri":"/posts/clause_32/"},{"categories":["C++"],"content":"ç±»ä¼¼removeçš„ç®—æ³• remove_ifå’Œuniqueã€‚ removeå’Œremove_ifä¹‹é—´çš„ç›¸ä¼¼æ€§å¾ˆç›´æˆªäº†å½“ã€‚ uniqueè¡Œä¸ºä¹Ÿåƒremoveã€‚å®ƒç”¨æ¥ä»ä¸€ä¸ªåŒºé—´åˆ é™¤ä¸œè¥¿(é‚»è¿‘çš„é‡å¤å€¼)è€Œä¸ç”¨è®¿é—®æŒæœ‰åŒºé—´å…ƒç´ çš„å®¹å™¨ã€‚å¦‚æœä½ çœŸçš„è¦ä»å®¹å™¨ä¸­åˆ é™¤å…ƒç´ ï¼Œä½ ä¹Ÿå¿…é¡»æˆå¯¹è°ƒç”¨uniqueå’Œeraseï¼Œuniqueåœ¨listä¸­ä¹Ÿç±»ä¼¼äºremoveã€‚æ­£åƒlist::removeçœŸçš„åˆ é™¤ä¸œè¥¿(è€Œä¸”æ¯”erase-removeæƒ¯ç”¨æ³•é«˜æ•ˆå¾—å¤š)ã€‚ list::uniqueä¹ŸçœŸçš„åˆ é™¤é‚»è¿‘çš„é‡å¤å€¼(ä¹Ÿæ¯”erase-uniqueé«˜æ•ˆ)ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_32/:3:0","tags":["Effective STL"],"title":"Effective STL [32] | å¦‚æœä½ çœŸçš„æƒ³åˆ é™¤ä¸œè¥¿çš„è¯å°±åœ¨ç±»ä¼¼removeçš„ç®—æ³•åæ¥ä¸Šerase","uri":"/posts/clause_32/"},{"categories":["C++"],"content":"ç¨³å®šæ’åº VS ä¸ç¨³å®šæ’åº æœ‰äº›æ’åºç®—æ³•æ˜¯ç¨³å®šçš„ã€‚åœ¨ç¨³å®šæ’åºä¸­ï¼Œå¦‚æœä¸€ä¸ªåŒºé—´ä¸­çš„ä¸¤ä¸ªå…ƒç´ æœ‰ç­‰ä»·çš„å€¼ï¼Œå®ƒä»¬çš„ç›¸å¯¹ä½ç½®åœ¨æ’åºåä¸æ”¹å˜ã€‚ä¸ç¨³å®šçš„ç®—æ³•æ²¡åšè¿™ä¸ªä¿è¯ã€‚ ä¾‹å¦‚ï¼Œåœ¨ï¼ˆæœªæ’åºçš„ï¼‰widgets vectorä¸­Widget Aåœ¨Widget Bä¹‹å‰ï¼Œè€Œä¸”ä¸¤è€…éƒ½æœ‰ç›¸åŒçš„è´¨é‡ç­‰çº§ï¼Œé‚£ä¹ˆç¨³å®šæ’åºç®—æ³•ä¼šä¿è¯åœ¨è¿™ä¸ªvectoræ’åºåï¼ŒWidget Aä»ç„¶åœ¨Widget Bä¹‹å‰ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_31/:1:0","tags":["Effective STL"],"title":"Effective STL [31] | äº†è§£ä½ çš„æ’åºé€‰æ‹©","uri":"/posts/clause_31/"},{"categories":["C++"],"content":"partial_sort sortæ˜¯ä¸ªä»¤äººç§°èµçš„ç®—æ³•ï¼Œå¦‚æœä¸éœ€è¦å®Œå…¨æ’åºæ—¶ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªå­˜æœ‰Widget çš„vectorï¼Œä½ æƒ³é€‰æ‹©20ä¸ªè´¨é‡æœ€é«˜çš„Widgetå‘é€ç»™å®¢æˆ·ï¼Œ20ä¸ªä¹‹å¤–çš„Widgetå¯ä»¥ä¿æŒæ— åºï¼Œä¹Ÿå°±æ˜¯ä½ éœ€è¦çš„æ˜¯éƒ¨åˆ†æ’åºï¼Œè¿™æ—¶å°±å¯ä»¥ç”¨partial_sortã€‚ bool qualityCompare(const Widget\u0026 lhs, const Widget\u0026 rhs) { // è¿”å›lhsçš„è´¨é‡æ˜¯ä¸æ˜¯æ¯”rhsçš„è´¨é‡å¥½ } ... // æŠŠæœ€å¥½çš„20ä¸ªå…ƒç´ ï¼ˆæŒ‰é¡ºåºï¼‰æ”¾åœ¨widgetsçš„å‰ç«¯ partial_sort(widgets.begin(),widgets.begin() + 20, widgets.end(), qualityCompare); // ä½¿ç”¨widgets... ... è°ƒç”¨å®Œpartial_sortåï¼Œwidgetsçš„å‰20ä¸ªå…ƒç´ æ˜¯å®¹å™¨ä¸­æœ€å¥½çš„è€Œä¸”å®ƒä»¬æŒ‰é¡ºåºæ’åˆ—ï¼Œè´¨é‡æœ€é«˜çš„Widgetæ˜¯widgets[0]ï¼Œç¬¬äºŒé«˜çš„æ˜¯widgets[1]ç­‰ã€‚ partial_sortæ˜¯ä¸ç¨³å®šçš„ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_31/:2:0","tags":["Effective STL"],"title":"Effective STL [31] | äº†è§£ä½ çš„æ’åºé€‰æ‹©","uri":"/posts/clause_31/"},{"categories":["C++"],"content":"nth_element å¦‚æœä½ ä¸å…³å¿ƒå“ªä¸ªWidgetç»™å“ªä¸ªå®¢æˆ·ï¼Œä½ éœ€è¦çš„åªæ˜¯ä»»æ„é¡ºåºçš„20ä¸ªæœ€å¥½çš„Widgetã€‚STLä¸­nth_elementå¯ä»¥ç²¾ç¡®åœ°å®Œæˆäº†ä½ éœ€è¦çš„ã€‚ nth_elementæ’åºä¸€ä¸ªåŒºé—´ï¼Œåœ¨nä½ç½®ï¼ˆä½ æŒ‡å®šçš„ï¼‰çš„å…ƒç´ æ˜¯å¦‚æœåŒºé—´è¢«å®Œå…¨æ’åºåä¼šå‡ºç°åœ¨é‚£å„¿çš„å…ƒç´ ã€‚ Example randy[n]; //é»˜è®¤æ±‚ç¬¬må¤§çš„å…ƒç´  std::nth_element(randy, randy+m, randy+n); //å®šä¹‰cmpå¯æ±‚ç¬¬må°çš„å…ƒç´  bool cmp(int a, int b){ return a\u003eb; } std::nth_element(randy, randy+m, randy+n, cmp); å‡½æ•°æ˜¯å°†ç¬¬ m å¤§çš„å…ƒç´ æ”¾åœ¨ arr æ•°ç»„æ•°ç»„ä¸­é€‚å½“ä½ç½®ï¼Œå…¶ä»–å…ƒç´ æŒ‰ç…§ç¬¬ m å…ƒç´ çš„å¤§å°åˆ’åˆ†ã€‚ åœ¨[ 0, n ]è¿™ä¸ªèŒƒå›´å†…ï¼Œåœ¨ç¬¬ m ä¸ªå…ƒç´ ä¹‹å‰çš„å…ƒç´ éƒ½å°äºæˆ–ç­‰äºç¬¬ m ä¸ªå…ƒç´ ï¼Œè€Œä¸”ç¬¬ m ä¸ªå…ƒç´ åé¢çš„æ¯ä¸ªå…ƒç´ éƒ½ä¼šæ¯”å®ƒå¤§ã€‚ nth_element()å‡½æ•°ä»…å°†ç¬¬ m å¤§/å°çš„æ•°åœ¨ randy æ•°ç»„ä¸­æ’å¥½äº†ä½ç½®ï¼Œå¹¶ä¸è¿”å›å€¼ã€‚è¾“å‡º randy[m] å³æ˜¯ç¬¬ m å¤§/å°çš„æ•°ã€‚ æ’åºWidgetæ•°ç»„ ä½¿ç”¨nth_elementæ¥ä¿è¯æœ€å¥½çš„20ä¸ªWidgetåœ¨widgets vectorçš„å‰ç«¯ï¼š nth_element(widgets.begin(), widgets.begin() + 19, widgets.end(), qualityCompare); // æŠŠæœ€å¥½çš„20ä¸ªå…ƒç´ æ”¾åœ¨widgetså‰ç«¯ï¼Œä½†ä¸ç”¨æ‹…å¿ƒå®ƒä»¬çš„é¡ºåº è°ƒç”¨nth_elementæœ¬è´¨ä¸Šç­‰ä»·äºè°ƒç”¨partial_sortï¼Œä¸¤ä¸ªç®—æ³•éƒ½æŠŠ20ä¸ªè´¨é‡æœ€é«˜çš„Widgetç§»åŠ¨åˆ°vectorå‰ç«¯ã€‚ å®ƒä»¬ç»“æœçš„å”¯ä¸€åŒºåˆ«æ˜¯partial_sortæ’åºäº†åœ¨ä½ç½®1-20çš„å…ƒç´ ï¼Œè€Œnth_elementä¸æ’åºã€‚ å…¶ä»–ç”¨æ³• é™¤äº†èƒ½å¸®ä½ æ‰¾åˆ°åŒºé—´é¡¶éƒ¨çš„nä¸ªå…ƒç´ ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨äºæ‰¾åˆ°åŒºé—´çš„ä¸­å€¼æˆ–è€…æ‰¾åˆ°åœ¨æŒ‡å®šç™¾åˆ†ç‚¹çš„å…ƒç´ ï¼š // è¿­ä»£å™¨çš„å˜é‡æ–¹ä¾¿åœ°è¡¨ç¤ºwidgetsçš„èµ·ç‚¹å’Œç»ˆç‚¹ vector\u003cWidget\u003e::iterator begin(widgets.begin()); vector\u003cWidget\u003e::iterator end(widgets.end()); // è¿™ä¸ªè¿­ä»£å™¨æŒ‡ç¤ºäº†ä¸‹é¢ä»£ç è¦æ‰¾çš„ä¸­ç­‰è´¨é‡ç­‰çº§çš„Widgetçš„ä½ç½® vector\u003cWidget\u003e::iterator goalPosition; // å…´è¶£çš„Widgetä¼šæ˜¯æœ‰åºçš„vectorçš„ä¸­é—´ goalPosition = begin + widgets.size() / 2; // æ‰¾åˆ°widgetsä¸­ä¸­ç­‰è´¨é‡ç­‰çº§çš„å€¼ nth_element(begin, goalPosition, end, qualityCompare); // goalPositionç°åœ¨æŒ‡å‘ä¸­ç­‰è´¨é‡ç­‰çº§çš„Widget ... // ä¸‹é¢çš„ä»£ç èƒ½æ‰¾åˆ°è´¨é‡ç­‰çº§ä¸º75%çš„Widget // æŒ‡å‡ºå…´è¶£çš„Widgetç¦»å¼€å§‹æœ‰å¤šè¿œ vector\u003cWidget\u003e::size_type goalOffset = 0.25 * widgets.size(); // æ‰¾åˆ°è´¨é‡å€¼ä¸º75%çš„Widget nth_element(begin, begin + goalOffset, end, qualityCompare); // begin + goalOffsetç°åœ¨æŒ‡å‘è´¨é‡ç­‰çº§ä¸º75%çš„Widget ","date":"2023-08-26","objectID":"/posts/clause_31/:3:0","tags":["Effective STL"],"title":"Effective STL [31] | äº†è§£ä½ çš„æ’åºé€‰æ‹©","uri":"/posts/clause_31/"},{"categories":["C++"],"content":"å…ƒç´ æœ‰åŒæ ·è´¨é‡ å‡è®¾æœ‰12ä¸ªå…ƒç´ è´¨é‡æ˜¯1çº§ï¼ˆå¯èƒ½æ˜¯æœ€å¥½çš„ï¼‰ï¼Œ15ä¸ªå…ƒç´ è´¨é‡æ˜¯2çº§ï¼ˆç¬¬äºŒå¥½çš„ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€‰æ‹©20ä¸ªæœ€å¥½çš„Widgetå°±æ˜¯é€‰æ‹©12ä¸ª1çº§çš„å’Œ15ä¸ªä¸­çš„8ä¸ª2çº§çš„ã€‚partial_sortå’Œnth_elementæ€ä¹ˆåˆ¤æ–­15ä¸ªä¸­çš„å“ªäº›è¦æ”¾åˆ°æœ€å¥½çš„20ä¸ªä¸­ï¼Ÿå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œå½“å¤šä¸ªå…ƒç´ æœ‰ç­‰ä»·çš„å€¼æ—¶sortæ€ä¹ˆåˆ¤æ–­å…ƒç´ çš„é¡ºåºï¼Ÿ partial_sortå’Œnth_elementä»¥ä»»ä½•å®ƒä»¬å–œæ¬¢çš„æ–¹å¼æ’åºå€¼ç­‰ä»·çš„å…ƒç´ ï¼Œè€Œä¸”ä½ ä¸èƒ½æ§åˆ¶å®ƒä»¬åœ¨è¿™æ–¹é¢è¡Œä¸ºã€‚ nth_elementã€sortä¹Ÿæ²¡æœ‰æä¾›ç¨³å®šæ€§ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_31/:4:0","tags":["Effective STL"],"title":"Effective STL [31] | äº†è§£ä½ çš„æ’åºé€‰æ‹©","uri":"/posts/clause_31/"},{"categories":["C++"],"content":"stable_sort stable_sort æ˜¯ç¨³å®šæ’åºï¼ŒSTLå¹¶ä¸åŒ…å«partial_sortå’Œnth_elementçš„ç¨³å®šç‰ˆæœ¬ã€‚ å½“æŒ‡å®šèŒƒå›´å†…åŒ…å«å¤šä¸ªç›¸ç­‰çš„å…ƒç´ æ—¶ï¼Œsort() æ’åºå‡½æ•°æ— æ³•ä¿è¯ä¸æ”¹å˜å®ƒä»¬çš„ç›¸å¯¹ä½ç½®ã€‚é‚£ä¹ˆï¼Œå¦‚æœæ—¢è¦å®Œæˆæ’åºåˆè¦ä¿è¯ç›¸ç­‰å…ƒç´ çš„ç›¸å¯¹ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨stable_sort()å‡½æ•° stable_sort() å‡½æ•°å®Œå…¨å¯ä»¥çœ‹ä½œæ˜¯ sort() å‡½æ•°åœ¨åŠŸèƒ½æ–¹é¢çš„å‡çº§ç‰ˆã€‚stable_sort() å’Œ sort() å…·æœ‰ç›¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼Œå°±è¿è¯­æ³•æ ¼å¼ä¹Ÿæ˜¯ç›¸åŒçš„ï¼ˆåç»­ä¼šè®²ï¼‰ï¼Œåªä¸è¿‡å‰è€…åœ¨åŠŸèƒ½ä¸Šé™¤äº†å¯ä»¥å®ç°æ’åºï¼Œè¿˜å¯ä»¥ä¿è¯ä¸æ”¹å˜ç›¸ç­‰å…ƒç´ çš„ç›¸å¯¹ä½ç½®ã€‚ //å¯¹ [first, last) åŒºåŸŸå†…çš„å…ƒç´ åšé»˜è®¤çš„å‡åºæ’åº void stable_sort ( RandomAccessIterator first, RandomAccessIterator last ); //æŒ‰ç…§æŒ‡å®šçš„ comp æ’åºè§„åˆ™ï¼Œå¯¹ [first, last) åŒºåŸŸå†…çš„å…ƒç´ è¿›è¡Œæ’åº void stable_sort ( RandomAccessIterator first, RandomAccessIterator last, Compare comp ); #include \u003ciostream\u003e // std::cout #include \u003calgorithm\u003e // std::stable_sort #include \u003cvector\u003e // std::vector //ä»¥æ™®é€šå‡½æ•°çš„æ–¹å¼å®ç°è‡ªå®šä¹‰æ’åºè§„åˆ™ bool randy_comp(int i, int j) { return (i \u003c j); } //ä»¥å‡½æ•°å¯¹è±¡çš„æ–¹å¼å®ç°è‡ªå®šä¹‰æ’åºè§„åˆ™ class kim_comp { public: bool operator() (int i, int j) { return (i \u003c j); } }; int main() { std::vector\u003cint\u003e jeff_num{88, 13, 2, 22, 1, 30, 3, 33}; std::stable_sort(jeff_num.begin(), jeff_num.begin() + 4); // 2 13 22 88 1 30 3 33 //åˆ©ç”¨STLæ ‡å‡†åº“æä¾›greater\u003cT\u003eè¿›è¡Œæ’åº std::stable_sort(jeff_num.begin(), jeff_num.begin() + 4, std::greater\u003cint\u003e()); // 88 22 13 2 1 30 3 33 //é€šè¿‡è‡ªå®šä¹‰æ¯”è¾ƒè§„åˆ™è¿›è¡Œæ’åº,è¿™é‡Œä¹Ÿå¯ä»¥æ¢æˆ kim_comp() std::stable_sort(jeff_num.begin(), jeff_num.end(), randy_comp); // 1 2 3 13 22 30 33 88 for (std::vector\u003cint\u003e::iterator it = jeff_num.begin(); it != jeff_num.end(); ++it) { std::cout \u003c\u003c *it \u003c\u003c ' '; } std::cout \u003c\u003c std::endl; return 0; } ","date":"2023-08-26","objectID":"/posts/clause_31/:5:0","tags":["Effective STL"],"title":"Effective STL [31] | äº†è§£ä½ çš„æ’åºé€‰æ‹©","uri":"/posts/clause_31/"},{"categories":["C++"],"content":"partition ä½†æ˜¯å®Œå…¨æ’åºéœ€è¦å¾ˆå¤šå·¥ä½œï¼Œè€Œä¸”å¯¹äºè¿™ä¸ªä»»åŠ¡åšäº†å¾ˆå¤šä¸å¿…è¦çš„å·¥ä½œã€‚ä¸€ä¸ªæ›´å¥½çš„ç­–ç•¥æ˜¯ä½¿ç”¨partitionç®—æ³•ï¼Œå®ƒé‡æ’åŒºé—´ä¸­çš„å…ƒç´ ä»¥ä½¿æ‰€æœ‰æ»¡è¶³æŸä¸ªæ ‡å‡†çš„å…ƒç´ éƒ½åœ¨åŒºé—´çš„å¼€å¤´ã€‚ æ¯”å¦‚ï¼Œç§»åŠ¨æ‰€æœ‰è´¨é‡ç­‰çº§ä¸º2æˆ–æ›´å¥½çš„Widgetåˆ°widgetså‰ç«¯ï¼š bool hasAcceptableQuality(const Widget\u0026 w) { // è¿”å›wè´¨é‡ç­‰çº§æ˜¯å¦æ˜¯2æˆ–æ›´é«˜; } // æŠŠæ‰€æœ‰æ»¡è¶³hasAcceptableQualityçš„widgetsç§»åŠ¨åˆ°widgetså‰ç«¯ï¼Œ // å¹¶ä¸”è¿”å›ä¸€ä¸ªæŒ‡å‘ç¬¬ä¸€ä¸ªä¸æ»¡è¶³çš„widgetçš„è¿­ä»£å™¨ vector\u003cWidget\u003e::iterator goodEnd = partition(widgets.begin(), widgets.end(), hasAcceptableQuality); æ­¤è°ƒç”¨å®Œæˆåï¼Œä»widgets.begin()åˆ°goodEndçš„åŒºé—´å®¹çº³äº†æ‰€æœ‰è´¨é‡æ˜¯1æˆ–2çš„Widgetï¼Œä»goodEndåˆ°widgets.end()çš„åŒºé—´åŒ…å«äº†æ‰€æœ‰è´¨é‡ç­‰çº§æ›´ä½çš„Widgetã€‚ å¦‚æœåœ¨åˆ†å‰²æ—¶ä¿æŒåŒæ ·è´¨é‡ç­‰çº§çš„Widgetçš„ç›¸å¯¹ä½ç½®å¾ˆé‡è¦ï¼Œæˆ‘ä»¬è‡ªç„¶ä¼šç”¨stable_partitionæ¥ä»£æ›¿partitionã€‚ listæ’åº å”¯ä¸€æˆ‘ä»¬å¯èƒ½ä¼šä½†ä¸èƒ½ä½¿ç”¨sortã€stable_sortã€partial_sortæˆ–nth_elementçš„å®¹å™¨æ˜¯listï¼Œlisté€šè¿‡æä¾›sortæˆå‘˜å‡½æ•°åšäº†ä¸€äº›è¡¥å¿ã€‚ï¼ˆæœ‰è¶£çš„æ˜¯ï¼Œlist::sortæä¾›äº†ç¨³å®šæ’åºã€‚ï¼‰ å¦‚æœä½ æƒ³è¦å¯¹listä¸­çš„å¯¹è±¡è¿›è¡Œpartial_sortæˆ–nth_elementï¼Œä½ å¿…é¡»é—´æ¥å®Œæˆï¼š æŠŠå…ƒç´ æ‹·è´åˆ°ä¸€ä¸ªæ”¯æŒéšæœºè®¿é—®è¿­ä»£å™¨çš„å®¹å™¨ä¸­ï¼Œç„¶åå¯¹å®ƒåº”ç”¨éœ€è¦çš„ç®—æ³•; å»ºç«‹ä¸€ä¸ªlist::iteratorçš„å®¹å™¨ï¼Œå¯¹é‚£ä¸ªå®¹å™¨ä½¿ç”¨ç®—æ³•ï¼Œç„¶åé€šè¿‡è¿­ä»£å™¨è®¿é—®listå…ƒç´ ; ä½¿ç”¨æœ‰åºçš„è¿­ä»£å™¨å®¹å™¨çš„ä¿¡æ¯æ¥è¿­ä»£åœ°æŠŠlistçš„å…ƒç´ æ¥åˆåˆ°ä½ æƒ³è®©å®ƒä»¬æ‰€å¤„çš„ä½ç½®ã€‚ ","date":"2023-08-26","objectID":"/posts/clause_31/:6:0","tags":["Effective STL"],"title":"Effective STL [31] | äº†è§£ä½ çš„æ’åºé€‰æ‹©","uri":"/posts/clause_31/"},{"categories":["C++"],"content":"æ€»ç»“ ç®—æ³•sortã€stable_sortã€partial_sortå’Œnth_elementéœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œæ‰€ä»¥å®ƒä»¬å¯èƒ½åªèƒ½ç”¨äºvectorã€stringã€dequeå’Œæ•°ç»„ã€‚ å¯¹æ ‡å‡†å…³è”å®¹å™¨æ’åºå…ƒç´ æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºè¿™æ ·çš„å®¹å™¨ä½¿ç”¨å®ƒä»¬çš„æ¯”è¾ƒå‡½æ•°æ¥åœ¨ä»»ä½•æ—¶å€™ä¿æŒæœ‰åºã€‚ partitionå’Œstable_partitionä¸sortã€stable_sortã€partial_sortå’Œnth_elementä¸åŒï¼Œå®ƒä»¬åªéœ€è¦åŒå‘è¿­ä»£å™¨ã€‚å› æ­¤ä½ å¯ä»¥åœ¨ä»»ä½•æ ‡å‡†åºåˆ—è¿­ä»£å™¨ä¸Šä½¿ç”¨partitionå’Œstable_partitionã€‚ å¦‚æœéœ€è¦åœ¨vectorã€stringã€dequeæˆ–æ•°ç»„ä¸Šè¿›è¡Œå®Œå…¨æ’åºï¼Œä½ å¯ä»¥ä½¿ç”¨sortæˆ–stable_sortã€‚ å¦‚æœä½ æœ‰ä¸€ä¸ªvectorã€stringã€dequeæˆ–æ•°ç»„ï¼Œåªéœ€è¦æ’åºå‰nä¸ªå…ƒç´ ï¼Œåº”è¯¥ç”¨partial_sortã€‚ å¦‚æœä½ æœ‰ä¸€ä¸ªvectorã€stringã€dequeæˆ–æ•°ç»„ï¼Œéœ€è¦é‰´åˆ«å‡ºç¬¬nä¸ªå…ƒç´ æˆ–ä½ éœ€è¦é‰´åˆ«å‡ºæœ€å‰çš„nä¸ªå…ƒç´ ï¼Œè€Œä¸ç”¨çŸ¥é“å®ƒä»¬çš„é¡ºåºï¼Œnth_elementæ˜¯ä½ åº”è¯¥æ³¨æ„å’Œè°ƒç”¨çš„ã€‚ å¦‚æœä½ éœ€è¦æŠŠæ ‡å‡†åºåˆ—å®¹å™¨çš„å…ƒç´ æˆ–æ•°ç»„åˆ†éš”ä¸ºæ»¡è¶³å’Œä¸æ»¡è¶³æŸä¸ªæ ‡å‡†ï¼Œä½ å¤§æ¦‚å°±è¦æ‰¾partitionæˆ–stable_partitionã€‚ å¦‚æœä½ çš„æ•°æ®æ˜¯åœ¨listä¸­ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨partitionå’Œstable_partitionï¼Œä½ å¯ä»¥ä½¿ç”¨listçš„sortæ¥ä»£æ›¿sortå’Œstable_sortã€‚å¦‚æœä½ éœ€è¦partial_sortæˆ–nth_elementæä¾›çš„æ•ˆæœï¼Œä½ å°±å¿…é¡»é—´æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚ ä½ å¯ä»¥é€šè¿‡æŠŠæ•°æ®æ”¾åœ¨æ ‡å‡†å…³è”å®¹å™¨ä¸­çš„æ–¹æ³•ä»¥ä¿æŒåœ¨ä»»ä½•æ—¶å€™ä¸œè¥¿éƒ½æœ‰åºã€‚ä½ ä¹Ÿå¯èƒ½ä¼šè€ƒè™‘æ ‡å‡†éSTLå®¹å™¨priority_queueï¼Œå®ƒä¹Ÿå¯ä»¥æ€»æ˜¯ä¿æŒå®ƒçš„å…ƒç´ æœ‰åºã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œåšæ›´å¤šå·¥ä½œçš„ç®—æ³•æ¯”åšå¾—å°‘çš„è¦èŠ±æ›´é•¿æ—¶é—´ï¼Œè€Œå¿…é¡»ç¨³å®šæ’åºçš„ç®—æ³•æ¯”å¿½ç•¥ç¨³å®šæ€§çš„ç®—æ³•è¦èŠ±æ›´é•¿æ—¶é—´ã€‚ æœ¬èŠ‚è®¨è®ºçš„ç®—æ³•éœ€è¦æ›´å°‘èµ„æºï¼ˆæ—¶é—´å’Œç©ºé—´ï¼‰çš„ç®—æ³•æ’åºï¼š partition partial_sort stable_partition sort nth_element stable_sort ","date":"2023-08-26","objectID":"/posts/clause_31/:7:0","tags":["Effective STL"],"title":"Effective STL [31] | äº†è§£ä½ çš„æ’åºé€‰æ‹©","uri":"/posts/clause_31/"},{"categories":["C++"],"content":"å‰è¨€ Effective-STLæ€»ç»“ç³»åˆ—åˆ†ä¸ºä¸ƒéƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬å…­éƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬å…­ç« ï¼Œå†…å®¹èŒƒå›´Rule38~42ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule38ç®€å†™ä¸ºR38ã€‚ Effective-STLç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective STL(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››) ","date":"2023-08-22","objectID":"/posts/effective_stl_part_six/:0:0","tags":["Effective STL"],"title":"Effective STL ç²¾åº¦æ€»ç»“ [6] | ä»¿å‡½æ•°ã€ä»¿å‡½æ•°ç±»ã€å‡½æ•°ç­‰","uri":"/posts/effective_stl_part_six/"},{"categories":["C++"],"content":"R38: éµå¾ªæŒ‰å€¼ä¼ é€’çš„åŸåˆ™æ¥è®¾è®¡å‡½æ•°å­ç±» å‡½æ•°æŒ‡é’ˆæ˜¯æŒ‰å€¼ä¼ é€’çš„ã€‚ å‡½æ•°å¯¹è±¡å¾€å¾€æŒ‰å€¼ä¼ é€’å’Œè¿”å›ã€‚æ‰€ä»¥ï¼Œç¼–å†™çš„å‡½æ•°å¯¹è±¡å¿…é¡»å°½å¯èƒ½åœ°å°å·§ï¼Œå¦åˆ™å¤åˆ¶çš„å¼€é”€å¤§ï¼›å‡½æ•°å¯¹è±¡å¿…é¡»æ˜¯å•æ€çš„(ä¸æ˜¯å¤šæ€)ï¼Œä¸å¾—ä½¿ç”¨è™šå‡½æ•°ã€‚ å¦‚æœä½ å¸Œæœ›åˆ›å»ºä¸€ä¸ªåŒ…å«å¤§é‡æ•°æ®å¹¶ä¸”ä½¿ç”¨äº†å¤šæ€æ€§çš„å‡½æ•°å­ç±»ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ template\u003ctypename T\u003e class BPFCImpl: public unary_function\u003cT, void\u003e { private: Widget w; int x; ... virtual ~BPFCImpl(); virtual void operator() (const T\u0026 val) const; friend class BPFC\u003cT\u003e; // å…è®¸BPFCè®¿é—®å†…éƒ¨æ•°æ®ã€‚ } template\u003ctypename T\u003e class BPFC: // æ–°çš„BPFCç±»ï¼šçŸ­å°ã€å•æ€ public unary_function\u003cT, void\u003e { private: BPFCImpl\u003cT\u003e *pImpl; // BPFCå”¯ä¸€çš„æ•°æ®æˆå‘˜ public: void operator() (const T\u0026 val) const // ç°åœ¨è¿™æ˜¯ä¸€ä¸ªéè™šå‡½æ•°ï¼Œå°†è°ƒç”¨è½¬åˆ°BPFCImplä¸­ { pImpl-\u003eoperator()(val); } } é‚£ä¹ˆä½ åº”è¯¥åˆ›å»ºä¸€ä¸ªå°å·§ã€å•æ€çš„ç±»ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å¦ä¸€ä¸ªå®ç°ç±»ï¼Œå¹¶ä¸”å°†æ‰€æœ‰çš„æ•°æ®å’Œè™šå‡½æ•°éƒ½æ”¾åœ¨å®ç°ç±»ä¸­(â€œPimpl Idiomâ€)ã€‚ template\u003ctypename T\u003e class BPFCImpl: public unary_function\u003cT, void\u003e { private: Widget w; int x; ... virtual ~BPFCImpl(); virtual void operator() (const T\u0026 val) const; friend class BPFC\u003cT\u003e; // å…è®¸BPFCè®¿é—®å†…éƒ¨æ•°æ®ã€‚ } template\u003ctypename T\u003e class BPFC: // æ–°çš„BPFCç±»ï¼šçŸ­å°ã€å•æ€ public unary_function\u003cT, void\u003e { private: BPFCImpl\u003cT\u003e *pImpl; // BPFCå”¯ä¸€çš„æ•°æ®æˆå‘˜ public: void operator() (const T\u0026 val) const // ç°åœ¨è¿™æ˜¯ä¸€ä¸ªéè™šå‡½æ•°ï¼Œå°†è°ƒç”¨è½¬åˆ°BPFCImplä¸­ { pImpl-\u003eoperator()(val); } } ","date":"2023-08-22","objectID":"/posts/effective_stl_part_six/:1:0","tags":["Effective STL"],"title":"Effective STL ç²¾åº¦æ€»ç»“ [6] | ä»¿å‡½æ•°ã€ä»¿å‡½æ•°ç±»ã€å‡½æ•°ç­‰","uri":"/posts/effective_stl_part_six/"},{"categories":["C++"],"content":"R39 ç¡®ä¿åˆ¤åˆ«å¼æ˜¯ â€œçº¯å‡½æ•°â€ åˆ¤åˆ«å¼(predicate)ï¼šä¸€ä¸ªè¿”å›å€¼ä¸º bool ç±»å‹çš„å‡½æ•°ã€‚ çº¯å‡½æ•°ï¼šæŒ‡è¿”å›å€¼ä»…ä»…ä¾èµ–äºå…¶å‚æ•°çš„å‡½æ•°ã€‚ åˆ¤åˆ«å¼ç±»(predicate class)ï¼šä¸€ä¸ªå‡½æ•°å­ç±»ï¼Œå®ƒçš„ operator() å‡½æ•°æ˜¯ä¸€ä¸ªåˆ¤åˆ«å¼(è¿”å› true æˆ– false)ã€‚ STL ä¸­å‡¡æ˜¯å¯ä»¥æ¥å—ä¸€ä¸ªåˆ¤åˆ«å¼ç±»å¯¹è±¡çš„åœ°æ–¹ï¼Œä¹Ÿå°±å¯ä»¥æ¥å—ä¸€ä¸ªåˆ¤åˆ«å¼å‡½æ•°ã€‚ åˆ¤åˆ«å¼åº”è¯¥æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œè€Œçº¯å‡½æ•°åº”è¯¥æ²¡æœ‰çŠ¶æ€ã€‚ ","date":"2023-08-22","objectID":"/posts/effective_stl_part_six/:2:0","tags":["Effective STL"],"title":"Effective STL ç²¾åº¦æ€»ç»“ [6] | ä»¿å‡½æ•°ã€ä»¿å‡½æ•°ç±»ã€å‡½æ•°ç­‰","uri":"/posts/effective_stl_part_six/"},{"categories":["C++"],"content":"R40 ä½¿ä»¿å‡½æ•°ç±»å¯é€‚é… å¯¹å‡½æ•°æŒ‡é’ˆï¼Œè¦å…ˆåº”ç”¨ptr_funä¹‹åå†åº”ç”¨not1ä¹‹åæ‰å¯ä»¥å·¥ä½œã€‚ 4 ä¸ªæ ‡å‡†çš„å‡½æ•°é…æ¥å™¨(not1ã€not2ã€bind1stã€bind2nd)éƒ½è¦æ±‚ä¸€äº›ç‰¹æ®Šçš„ç±»å‹å®šä¹‰ï¼Œæä¾›è¿™äº›å¿…è¦ç±»å‹å®šä¹‰(argument_typeã€first_argument_typeã€second_argument_typeã€result_type)çš„å‡½æ•°å¯¹è±¡è¢«ç§°ä¸ºå¯é…æ¥(å¯é€‚é…)(adaptable)çš„å‡½æ•°å¯¹è±¡ã€‚ æä¾›è¿™äº›ç±»å‹å®šä¹‰æœ€ç®€å•çš„æ–¹æ³•ï¼šè®©å‡½æ•°å­ä»ä¸€ä¸ªåŸºç»“æ„ç»§æ‰¿ã€‚ å¯¹äº unary_functionï¼Œå¿…é¡»æŒ‡å®šå‡½æ•°å­ç±» operator() æ‰€å¸¦çš„å‚æ•°ç±»å‹ï¼Œä»¥åŠ operator() è¿”å›ç±»å‹ã€‚ å¯¹äº binary_functionï¼Œå¿…é¡»æŒ‡å®š 3 ä¸ªç±»å‹ï¼šoperator() ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°ç±»å‹ï¼Œä»¥åŠ operator() è¿”å›ç±»å‹ã€‚ template\u003ctypename T\u003e class MeetsThreshold: public std::unary_function\u003cWidget, bool\u003e { private: const T threshold; // åŒ…å«çŠ¶æ€ä¿¡æ¯ï¼Œä½¿ç”¨ç±»å°è£…ã€‚ public: MeetsThreshold(const T\u0026 threshold); bool operator()(const Widget\u0026) const; ... } struct WidgetNameCompare: // STLä¸­æ‰€æœ‰æ— çŠ¶æ€å‡½æ•°å­ç±»ä¸€èˆ¬éƒ½è¢«å®šä¹‰æˆç»“æ„ã€‚ public std::binary_function\u003cWidget, Widget, bool\u003e { bool operator()(const Widget\u0026 lhs, const Widget\u0026 rhs) const; } æ³¨æ„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼ é€’ç»™ binary_function æˆ– unary_function çš„éæŒ‡é’ˆç±»å‹éœ€è¦å»æ‰ const å’Œåº”ç”¨(\u0026)éƒ¨åˆ†ã€‚ ","date":"2023-08-22","objectID":"/posts/effective_stl_part_six/:3:0","tags":["Effective STL"],"title":"Effective STL ç²¾åº¦æ€»ç»“ [6] | ä»¿å‡½æ•°ã€ä»¿å‡½æ•°ç±»ã€å‡½æ•°ç­‰","uri":"/posts/effective_stl_part_six/"},{"categories":["C++"],"content":"R41 ç†è§£ ptr_funã€mem_fun å’Œ mem_fun_ref çš„æ¥ç”± STLè¯­æ³•æƒ¯ä¾‹ï¼šå‡½æ•°æˆ–è€…å‡½æ•°å¯¹è±¡è¢«è°ƒç”¨æ—¶ï¼Œæ€»æ˜¯ä½¿ç”¨éæˆå‘˜å‡½æ•°çš„è¯­æ³•å½¢å¼ã€‚ for_each(vw.begin(), vw.end(), test); // è°ƒç”¨1ï¼šf(x)ï¼Œfä¸ºéæˆå‘˜å‡½æ•° for_each(vw.begin(), vw.end(), \u0026Widget::test); // è°ƒç”¨2ï¼šx.f()ï¼Œfä¸ºæˆå‘˜å‡½æ•° // xæ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å¯¹è±¡çš„å¼•ç”¨ list\u003cWidget *\u003e lpw; for_each(lpw.begin(), lpw.end(), \u0026Widgettest); // è°ƒç”¨3ï¼šp-\u003ef()ï¼Œfä¸ºæˆå‘˜å‡½æ•° // pæ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡xçš„æŒ‡é’ˆã€‚ mem_funã€mem_fun_tï¼šmem_fun å°†è¯­æ³• 3 è°ƒæ•´ä¸ºè¯­æ³• 1ã€‚ template\u003ctypename R, typename C\u003e //è¯¥mem_funå£°æ˜é’ˆå¯¹ä¸å¸¦å‚æ•°çš„éconstæˆå‘˜å‡½æ•° mem_fun_t\u003cR,C\u003e //Cæ˜¯ç±»ï¼ŒRæ˜¯æ‰€æŒ‡å‘çš„æˆå‘˜å‡½æ•°è¿”å›çš„ç±»å‹ã€‚ mem_fun(R(C::*pmf)); mem_fun å¸¦ä¸€ä¸ªæŒ‡å‘æŸä¸ªæˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå‚æ•° pmfï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ª mem_fun_t ç±»å‹çš„å¯¹è±¡ã€‚ mem_fun_t æ˜¯ä¸€ä¸ªå‡½æ•°å­ç±»ï¼Œå®ƒæ‹¥æœ‰è¯¥æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆï¼Œå¹¶æä¾›äº† operator() å‡½æ•°ï¼Œåœ¨ operator() ä¸­è°ƒç”¨äº†é€šè¿‡å‚æ•°ä¼ é€’è¿›æ¥çš„å¯¹è±¡ä¸Šçš„è¯¥æˆå‘˜å‡½æ•°ã€‚ ç±»ä¼¼åœ°ï¼Œmem_fun_ref å°†è¯­æ³• 2 è°ƒæ•´ä¸ºè¯­æ³• 1ã€‚ æ€»ç»“: std::ptr_funï¼šå°†å‡½æ•°æŒ‡é’ˆè½¬æ¢ä¸ºå‡½æ•°å¯¹è±¡ã€‚ std::mem_funï¼šå°†æˆå‘˜å‡½æ•°è½¬æ¢ä¸ºå‡½æ•°å¯¹è±¡(æŒ‡é’ˆç‰ˆæœ¬)ã€‚ std::mem_fun_refï¼šå°†æˆå‘˜å‡½æ•°è½¬æ¢ä¸ºå‡½æ•°å¯¹è±¡(å¼•ç”¨ç‰ˆæœ¬)ã€‚ ","date":"2023-08-22","objectID":"/posts/effective_stl_part_six/:4:0","tags":["Effective STL"],"title":"Effective STL ç²¾åº¦æ€»ç»“ [6] | ä»¿å‡½æ•°ã€ä»¿å‡½æ•°ç±»ã€å‡½æ•°ç­‰","uri":"/posts/effective_stl_part_six/"},{"categories":["C++"],"content":"R42 ç¡®ä¿lessä¸operator\u003cå…·æœ‰ç›¸åŒçš„è¯­ä¹‰ å°½é‡é¿å…ä¿®æ”¹ less çš„è¡Œä¸ºï¼Œå¯èƒ½ä¼šè¯¯å¯¼å…¶ä»–ç¨‹åºå‘˜ã€‚ å¦‚æœä½ ä½¿ç”¨äº† lessï¼Œæ— è®ºæ˜¯æ˜¾å¼åœ°è¿˜æ˜¯éšå¼åœ°ï¼Œéƒ½éœ€è¦ç¡®ä¿å®ƒä¸ operator\u003c å…·æœ‰ç›¸åŒçš„æ„ä¹‰ã€‚ å¦‚æœä½ å¸Œæœ›ä»¥ä¸€ç§ç‰¹æ®Šçš„æ–¹å¼æ¥æ’åˆ—å¯¹è±¡ï¼Œé‚£ä¹ˆæœ€å¥½åˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°å­ç±»ã€‚ å‡è®¾æœ‰ä¸€ä¸ªmultisetå®¹å™¨ï¼Œå®ƒé»˜è®¤çš„æ¯”è¾ƒå‡½æ•°æ˜¯lessï¼Œè€Œlessåœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šè°ƒç”¨operator\u003cæ¥å®Œæˆmultisetçš„æ’åºï¼Œè€Œoperator\u003cæ˜¯æŒ‰ç…§Widgetä¸­æˆå‘˜å˜é‡weightæ¥æ’åºçš„ï¼Œç°åœ¨ç‰¹æ®Šæƒ…å†µä¸‹éœ€è¦ä¸€ä¸ªæŒ‰Widgetä¸­æˆå‘˜å˜é‡speedæ¥æ’åºçš„multisetï¼Œä¸€ç§æ–¹æ³•æ˜¯å…¨ç‰¹åŒ–lessï¼Œä½†æ˜¯è¿™ç§åšæ³•å¹¶ä¸å¥½ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½æ˜¯è§‰å¾—è‡ªå·±æŒ‰ç…§weightæ¥æ’åºï¼Œä½†æ˜¯å…¶å®åšçš„å´æ˜¯æŒ‰ç…§speedæ¥æ’åºï¼Œæ›´å¥½çš„åŠæ³•æ˜¯åˆ›å»ºä¸€ä¸ªå‡½æ•°å­ç±»ï¼Œç„¶åç”¨è¯¥å­ç±»åšæ¯”è¾ƒå‡½æ•°ï¼Œè€Œä¸æ˜¯æ”¹å˜lessçš„é»˜è®¤è¡Œä¸ºã€‚ struct speedCompare : public binary_function\u003cWidget, Widget, bool\u003e { bool operator()(const Widget\u0026 lhs, const Widget\u0026 rhs) const{ return lhs.maxSpeed() \u003c rhs.maxSpeed(); } }; multiset\u003cWidget, speedCompare\u003e widgets; Ref: [1]. https://www.cnblogs.com/Sherry4869/p/15162253.html [2]. https://blog.csdn.net/zhuikefeng/article/details/108164117#t35 [3]. https://zhuanlan.zhihu.com/p/458156007 ","date":"2023-08-22","objectID":"/posts/effective_stl_part_six/:5:0","tags":["Effective STL"],"title":"Effective STL ç²¾åº¦æ€»ç»“ [6] | ä»¿å‡½æ•°ã€ä»¿å‡½æ•°ç±»ã€å‡½æ•°ç­‰","uri":"/posts/effective_stl_part_six/"},{"categories":["ML"],"content":"1. 2017å¹´æ·±åº¦å­¦ä¹ é¢†åŸŸçš„é‡å¤§çªç ´æ˜¯ä»€ä¹ˆï¼Ÿ Transformerã€‚æœ‰ä¸¤æ–¹é¢çš„åŸå› : 1.1 ä¸€æ–¹é¢ï¼ŒTransformeræ˜¯æ·±åº¦å­¦ä¹ é¢†åŸŸç»§MLPã€RNNã€CNNä¹‹åçš„ç¬¬4å¤§ç‰¹å¾æå–å™¨(ä¹Ÿè¢«ç§°ä¸ºåŸºç¡€æ¨¡å‹)ã€‚ ä»€ä¹ˆæ˜¯ç‰¹å¾æå–å™¨ï¼Ÿ ç‰¹å¾æå–å™¨æ˜¯è®¡ç®—æœºæ¨¡ä»¿å¤§è„‘ï¼Œä¸å¤–éƒ¨ä¸–ç•Œ(å›¾åƒã€æ–‡å­—ã€è¯­éŸ³ç­‰)äº¤äº’çš„æ–¹å¼ï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚ä¸¾ä¾‹è€Œè¨€: Imagenetæ•°æ®é›†ä¸­åŒ…å«1000ç±»å›¾åƒï¼Œäººä»¬å·²ç»æ ¹æ®è‡ªå·±çš„ç»éªŒæŠŠè¿™ä¸€ç™¾ä¸‡å¼ å›¾åƒåˆ†å¥½1000ç±»ï¼Œæ¯ä¸€ç±»å›¾åƒ(å¦‚ç¾æ´²è±¹)éƒ½æœ‰ç‹¬ç‰¹çš„ç‰¹å¾ã€‚è¿™æ—¶ï¼Œç¥ç»ç½‘ç»œ(å¦‚ResNet18)ä¹Ÿæ˜¯æƒ³é€šè¿‡è¿™ç§åˆ†ç±»çš„æ–¹å¼ï¼ŒæŠŠæ¯ä¸€ç±»å›¾åƒçš„ç‰¹å¾å°½å¯èƒ½æå–æˆ–è¯†åˆ«å‡ºæ¥ã€‚åˆ†ç±»ä¸æ˜¯æœ€ç»ˆç›®çš„ï¼Œè€Œæ˜¯ä¸€ç§æå–å›¾åƒç‰¹å¾çš„æ‰‹æ®µï¼Œæ©ç è¡¥å…¨å›¾åƒä¹Ÿæ˜¯ä¸€ç§æå–ç‰¹å¾çš„æ–¹å¼ï¼Œå›¾åƒå—é¡ºåºæ‰“ä¹±ä¹Ÿæ˜¯ä¸€ç§æå–ç‰¹å¾çš„æ–¹å¼ã€‚ 1.2 å¦ä¸€æ–¹é¢ï¼ŒTransformeråœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸæ‰®æ¼”çš„è§’è‰²: ç¬¬3æ¬¡å’Œç¬¬4æ¬¡çƒ­æ½®çš„åŸºçŸ³ï¼Œå¦‚ä¸‹å›¾2æ‰€ç¤ºã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:1:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"2. Transformerçš„æå‡ºèƒŒæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ 2.1 åœ¨é¢†åŸŸå‘å±•èƒŒæ™¯å±‚é¢: å½“æ—¶æ—¶å¤„2017å¹´ï¼Œæ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸå·²ç»ç«äº†å‡ å¹´ã€‚ä»Alexnetã€VGGã€GoogleNetã€ResNetã€DenseNet;ä»å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹å†åˆ°è¯­ä¹‰åˆ†å‰²;ä½†åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸå¹¶æ²¡æœ‰å¼•èµ·å¾ˆå¤§åå“ã€‚ 2.2 æŠ€æœ¯èƒŒæ™¯å±‚é¢: (1)å½“æ—¶ä¸»æµçš„åºåˆ—è½¬å½•ä»»åŠ¡(å¦‚æœºå™¨ç¿»è¯‘)çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹å›¾3æ‰€ç¤ºï¼Œåœ¨Sequence to Sequenceæ¶æ„ä¸‹(Encoder-Decoderçš„ä¸€ç§)ï¼ŒRNNæ¥æå–ç‰¹å¾ï¼ŒAttentionæœºåˆ¶å°†Encoderæå–åˆ°çš„ç‰¹å¾é«˜æ•ˆä¼ é€’ç»™Decoderã€‚ (2)è¿™ç§åšæ³•æœ‰ä¸¤ä¸ªä¸è¶³ä¹‹å¤„ï¼Œä¸€æ–¹é¢æ˜¯åœ¨æå–ç‰¹å¾æ—¶çš„RNNå¤©ç”Ÿä»å‰å‘åæ—¶åºä¼ é€’çš„ç»“æ„å†³å®šäº†å…¶æ— æ³•å¹¶è¡Œè¿ç®—ï¼Œå…¶æ¬¡æ˜¯å½“åºåˆ—é•¿åº¦è¿‡é•¿æ—¶ï¼Œæœ€å‰é¢åºåˆ—çš„ä¿¡æ¯æœ‰å¯èƒ½è¢«é—å¿˜æ‰ã€‚å› æ­¤å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªæ¡†æ¶ä¸‹ï¼ŒRNNæ˜¯ç›¸å¯¹è–„å¼±æ€¥éœ€æ”¹è¿›çš„åœ°æ–¹ã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:2:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"3. Transformeråˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ 3.1 Transformeræ˜¯ä¸€ç§ç”±Encoderå’ŒDecoderç»„æˆçš„æ¶æ„ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯æ¶æ„å‘¢ï¼Ÿæœ€ç®€å•çš„æ¶æ„å°±æ˜¯A + B + Cã€‚ 3.2 Transformerä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥æ˜¯â€œæˆ‘çˆ±å­¦ä¹ â€ï¼Œè¾“å‡ºæ˜¯â€œI love studyâ€ã€‚ 3.3 å¦‚æœæŠŠTransformerçš„æ¶æ„è¿›è¡Œåˆ†æ‹†ï¼Œå¦‚å›¾4æ‰€ç¤ºã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:3:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"4. ä»€ä¹ˆæ˜¯Transformer Encoderï¼Ÿ 4.1 ä»åŠŸèƒ½è§’åº¦ï¼ŒTransformer Encoderçš„æ ¸å¿ƒä½œç”¨æ˜¯æå–ç‰¹å¾ï¼Œä¹Ÿæœ‰ä½¿ç”¨Transformer Decoderæ¥æå–ç‰¹å¾ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªäººå­¦ä¹ è·³èˆï¼ŒEncoderæ˜¯çœ‹åˆ«äººæ˜¯å¦‚ä½•è·³èˆçš„ï¼ŒDecoderæ˜¯å°†å­¦ä¹ åˆ°çš„ç»éªŒå’Œè®°å¿†(keyå’Œvalueçš„åŒ¹é…ç¨‹åº¦)ï¼Œå±•ç°å‡ºæ¥ 4.2 ä»ç»“æ„è§’åº¦ï¼Œå¦‚å›¾5æ‰€ç¤ºï¼ŒTransformer Encoder = Embedding + Positional Embedding + N * (å­Encoder block1 + å­Encoder block2); å­Encoder block1 = Multi head attention + ADD + Norm; å­Encoder block2 = Feed Forward + ADD + Norm; 4.3 ä»è¾“å…¥è¾“å‡ºè§’åº¦ï¼ŒNä¸ªTransformer Encoder blockä¸­çš„ç¬¬ä¸€ä¸ªEncoder blockçš„è¾“å…¥ä¸ºä¸€ç»„å‘é‡ X = (Embedding + Positional Embedding)ï¼Œå‘é‡ç»´åº¦é€šå¸¸ä¸º512*512ï¼Œå…¶ä»–Nä¸ªTransformerEncoder blockçš„è¾“å…¥ä¸ºä¸Šä¸€ä¸ª Transformer Encoder blockçš„è¾“å‡ºï¼Œè¾“å‡ºå‘é‡çš„ç»´åº¦ä¹Ÿä¸º512*512(è¾“å…¥è¾“å‡ºå¤§å°ç›¸åŒ)ã€‚ 4.4 ä¸ºä»€ä¹ˆæ˜¯512*512ï¼Ÿå‰è€…æ˜¯æŒ‡tokençš„ä¸ªæ•°ï¼Œå¦‚â€œæˆ‘çˆ±å­¦ä¹ â€æ˜¯4ä¸ªtokenï¼Œè¿™é‡Œè®¾ç½®ä¸º512æ˜¯ä¸ºäº†å›Šæ‹¬ä¸åŒçš„åºåˆ—é•¿åº¦ï¼Œä¸å¤Ÿæ—¶paddingã€‚åè€…æ˜¯æŒ‡æ¯ä¸€ä¸ªtokenç”Ÿæˆçš„å‘é‡ç»´åº¦ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€ä¸ªtokenä½¿ç”¨ä¸€ä¸ªåºåˆ—é•¿åº¦ä¸º512çš„å‘é‡è¡¨ç¤ºã€‚äººä»¬å¸¸è¯´ï¼ŒTransformerä¸èƒ½è¶…è¿‡512ï¼Œå¦åˆ™ç¡¬ä»¶å¾ˆéš¾æ”¯æ’‘;å…¶å®512æ˜¯æŒ‡å‰è€…ï¼Œä¹Ÿå°±æ˜¯tokençš„ä¸ªæ•°ï¼Œå› ä¸ºæ¯ä¸€ä¸ªtokenè¦åšself attentionæ“ä½œ;ä½†æ˜¯åè€…çš„512ä¸å®œè¿‡å¤§ï¼Œå¦åˆ™è®¡ç®—èµ·æ¥ä¹Ÿå¾ˆæ…¢ã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:4:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"5. ä»€ä¹ˆæ˜¯Transformer Decoderï¼Ÿ 5.1 ä»åŠŸèƒ½è§’åº¦ï¼Œç›¸æ¯”äºTransformer Encoderï¼ŒTransformer Decoderæ›´æ“…é•¿åšç”Ÿæˆå¼ä»»åŠ¡ï¼Œå°¤å…¶å¯¹äºè‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜ã€‚ 5.2 ä»ç»“æ„è§’åº¦ï¼Œå¦‚å›¾6æ‰€ç¤ºï¼ŒTransformer Decoder = Embedding + Positional Embedding + N*(å­Decoder block1 + å­Decoder block2 + å­Decoder block3)+ Linear + Softmax; å­Decoder block1 = Mask Multi head attention + ADD + Norm; å­Decoder block2 = Multi head attention + ADD + Norm; å­Decoder block3 = Feed Forward + ADD + Norm; 5.3 ä»(Embedding+Positional Embedding)(Nä¸ªDecoder block)(Linear + softmax) è¿™ä¸‰ä¸ªæ¯ä¸€ä¸ªå•ç‹¬ä½œç”¨è§’åº¦: Embedding + Positional Embedding: ä»¥æœºå™¨ç¿»è¯‘ä¸ºä¾‹ï¼Œè¾“å…¥â€œMachine Learningâ€ï¼Œè¾“å‡ºâ€œæœºå™¨å­¦ä¹ â€; è¿™é‡Œçš„Embeddingæ˜¯æŠŠâ€œæœºå™¨å­¦ä¹ â€ä¹Ÿè½¬åŒ–æˆå‘é‡çš„å½¢å¼ã€‚ Nä¸ªDecoder block: ç‰¹å¾å¤„ç†å’Œä¼ é€’è¿‡ç¨‹ã€‚ Linear + softmax: softmaxæ˜¯é¢„æµ‹ä¸‹ä¸€ä¸ªè¯å‡ºç°çš„æ¦‚ç‡ï¼Œå¦‚å›¾7æ‰€ç¤ºï¼Œå‰é¢çš„Linearå±‚ç±»ä¼¼äºåˆ†ç±»ç½‘ç»œ(ResNet18)æœ€ååˆ†ç±»å±‚å‰æ¥çš„MLPå±‚ã€‚ 5.4 Transformer Decoderçš„è¾“å…¥ã€è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿåœ¨Trainå’ŒTestæ—¶æ˜¯ä¸åŒçš„ã€‚ åœ¨Trainé˜¶æ®µï¼Œå¦‚å›¾8æ‰€ç¤ºã€‚è¿™æ—¶æ˜¯çŸ¥é“labelçš„ï¼Œdecoderçš„ç¬¬ä¸€ä¸ªè¾“å…¥æ˜¯beginå­—ç¬¦ï¼Œè¾“å‡ºç¬¬ä¸€ä¸ªå‘é‡ä¸labelä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦ä½¿ç”¨cross entropy lossã€‚Decoderçš„ç¬¬äºŒä¸ªè¾“å…¥æ˜¯ç¬¬ä¸€ä¸ªå‘é‡çš„labelï¼ŒDecoderçš„ç¬¬Nä¸ªè¾“å…¥å¯¹åº”çš„è¾“å‡ºæ˜¯Endå­—ç¬¦ï¼Œåˆ°æ­¤ç»“æŸã€‚è¿™é‡Œä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œåœ¨Trainé˜¶æ®µæ˜¯å¯ä»¥è¿›è¡Œå¹¶è¡Œè®­ç»ƒçš„ã€‚ åœ¨Testé˜¶æ®µï¼Œä¸‹ä¸€ä¸ªæ—¶åˆ»çš„è¾“å…¥æ˜¯å‰ä¸€ä¸ªæ—¶åˆ»çš„è¾“å‡ºï¼Œå¦‚å›¾9æ‰€ç¤ºã€‚å› æ­¤ï¼ŒTrainå’ŒTestæ—¶å€™ï¼ŒDecoderçš„è¾“å…¥ä¼šå‡ºç°Mismatchï¼Œåœ¨Testæ—¶å€™ç¡®å®æœ‰å¯èƒ½ä¼šå‡ºç°ä¸€æ­¥é”™ï¼Œæ­¥æ­¥é”™çš„æƒ…å†µã€‚æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆ: ä¸€ç§æ˜¯trainæ—¶å¶å°”ç»™ä¸€äº›é”™è¯¯ï¼Œå¦ä¸€ç§æ˜¯Scheduled samplingã€‚ 5.5 Transformer Decoder blockå†…éƒ¨çš„è¾“å…¥å’Œè¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ å‰é¢æåˆ°çš„æ˜¯åœ¨æ•´ä½“trainå’Œtesté˜¶æ®µï¼ŒDecoderçš„è¾“å…¥å’Œè¾“å‡ºï¼Œé‚£ä¹ˆTransformer Decoderå†…éƒ¨çš„Transformer Decoder blockï¼Œå¦‚å›¾10æ‰€ç¤ºï¼Œçš„è¾“å…¥è¾“å‡ºåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ å¯¹äºN=6ä¸­çš„ç¬¬1æ¬¡å¾ªç¯(N=1æ—¶): å­Decoder block1 çš„è¾“å…¥æ˜¯ embedding +Positional Embeddingï¼Œå­Decoder block2 çš„è¾“å…¥çš„Qæ¥è‡ªå­Decoder block1çš„è¾“å‡ºï¼ŒKVæ¥è‡ªTransformer Encoderæœ€åä¸€å±‚çš„è¾“å‡ºã€‚ å¯¹äºN=6çš„ç¬¬2æ¬¡å¾ªç¯: å­Decoder block1çš„è¾“å…¥æ˜¯N=1æ—¶ï¼Œå­Decoder block3çš„è¾“å‡ºï¼ŒKVåŒæ ·æ¥è‡ªTransformer Encoderçš„æœ€åä¸€å±‚çš„è¾“å‡ºã€‚ æ€»çš„æ¥è¯´ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºåœ¨Trainè¿˜æ˜¯Testæ—¶ï¼ŒTransformer Decoderçš„è¾“å…¥ä¸ä»…æ¥è‡ª(ground truthæˆ–è€…ä¸Šä¸€ä¸ªæ—¶åˆ»Decoderçš„è¾“å‡º)ï¼Œè¿˜æ¥è‡ªTransformer Encoderçš„æœ€åä¸€å±‚ã€‚ è®­ç»ƒæ—¶: ç¬¬iä¸ªdecoderçš„è¾“å…¥ = encoderè¾“å‡º + ground truth embeddingã€‚ é¢„æµ‹æ—¶: ç¬¬iä¸ªdecoderçš„è¾“å…¥ = encoderè¾“å‡º + ç¬¬(i-1)ä¸ªdecoderè¾“å‡º. ","date":"2023-08-21","objectID":"/posts/transformerqanda/:5:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"6. Transformer Encoderå’ŒTransformer Decoderæœ‰å“ªäº›ä¸åŒï¼Ÿ 6.1 ä½œç”¨ä¸Šï¼ŒTransformer Encoderå¸¸ç”¨æ¥æå–ç‰¹å¾ï¼ŒTransformer Decoderå¸¸ç”¨äºç”Ÿæˆå¼ä»»åŠ¡ã€‚Transformer Encoderå’ŒTransformer Decoderæ˜¯ä¸¤æ¡ä¸åŒçš„æŠ€æœ¯è·¯çº¿ï¼ŒBerté‡‡ç”¨çš„å‰è€…ï¼ŒGPTç³»åˆ—æ¨¡å‹é‡‡ç”¨çš„æ˜¯åè€…ã€‚ 6.2 ç»“æ„ä¸Šï¼ŒTransformer Decoder blockåŒ…æ‹¬äº†3ä¸ªå­Decoder blockï¼Œè€ŒTransformer Encoder block åŒ…æ‹¬2ä¸ªå­Encoder blockï¼Œä¸”Transformer Decoderä¸­ä½¿ç”¨äº†Mask multi-head Attentionã€‚ 6.3 ä»äºŒè€…çš„è¾“å…¥è¾“å‡ºè§’åº¦ï¼ŒNä¸ªTransformer Encoderè¿ç®—å®Œæˆä¹‹åï¼Œå®ƒçš„è¾“å‡ºæ‰æ­£å¼è¾“å…¥è¿›Transformer Decoderï¼Œä½œä¸ºQKVä¸­çš„Kå’ŒVï¼Œç»™Transformer Decoderä½¿ç”¨ã€‚é‚£ä¹ˆTransformerEncoderæœ€åå±‚çš„è¾“å‡ºæ˜¯å¦‚ä½•é€ç»™Decoderå‘¢ï¼Ÿå¦‚å›¾11æ‰€ç¤ºã€‚ é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆEncoderå’ŒDecoderå¿…é¡»è¦ç”¨è¿™ç§äº¤äº’çš„æ–¹å¼å‘¢ï¼Ÿå…¶å®ä¹Ÿå¹¶ä¸ä¸€å®šï¼Œåç»­æœ‰ä¸åŒäº¤äº’æ–¹å¼çš„æå‡ºï¼Œå¦‚å›¾12ã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:6:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"7. ä»€ä¹ˆæ˜¯Embeddingï¼Ÿ 7.1 Embeddingåœ¨Transformeræ¶æ„ä¸­çš„ä½ç½®å¦‚å›¾13æ‰€ç¤ºã€‚ 7.2 æå‡ºèƒŒæ™¯: è®¡ç®—æœºæ— æ³•ç›´æ¥å¤„ç†ä¸€ä¸ªå•è¯æˆ–è€…ä¸€ä¸ªæ±‰å­—ï¼Œéœ€è¦æŠŠä¸€ä¸ªtokenè½¬åŒ–æˆè®¡ç®—æœºå¯ä»¥è¯†åˆ«çš„å‘é‡ï¼Œè¿™ä¹Ÿå°±æ˜¯embeddingè¿‡ç¨‹ã€‚ 7.3 å®ç°æ–¹å¼: æœ€ç®€å•çš„embeddingæ“ä½œå°±æ˜¯one hot vectorï¼Œä½†one hot vectoræœ‰ä¸€ä¸ªå¼Šç«¯å°±æ˜¯æ²¡æœ‰è€ƒè™‘è¯è¯­å‰åä¹‹é—´çš„å…³ç³»ï¼Œåæ¥ä¹Ÿå°±äº§ç”Ÿäº†WordEmbeddingï¼Œå¦‚å›¾13ã€‚ Note wordembeddingå°†å•è¯tokenå‘é‡åŒ–ï¼Œå¹¶ä¸”è€ƒè™‘çš„å•è¯ä¸å•è¯ä¹‹é—´çš„ç›¸å…³æ€§ã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:7:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"8. ä»€ä¹ˆæ˜¯Positional Embeddingï¼Ÿ 8.1 Positional Embeddingåœ¨Transformeræ¶æ„ä¸­çš„ä½ç½®å¦‚å›¾14æ‰€ç¤ºã€‚ 8.2 æå‡ºèƒŒæ™¯: RNNä½œä¸ºç‰¹å¾æå–å™¨ï¼Œæ˜¯è‡ªå¸¦è¯çš„å‰åé¡ºåºä¿¡æ¯çš„;è€ŒAttentionæœºåˆ¶å¹¶æ²¡æœ‰è€ƒè™‘å…ˆåé¡ºåºä¿¡æ¯ï¼Œä½†å‰åé¡ºåºä¿¡æ¯å¯¹è¯­ä¹‰å½±å“å¾ˆå¤§ï¼Œå› æ­¤éœ€è¦é€šè¿‡Positional Embeddingè¿™ç§æ–¹å¼æŠŠå‰åä½ç½®ä¿¡æ¯åŠ åœ¨è¾“å…¥çš„Embeddingä¸Šã€‚ 8.3 å®ç°æ–¹å¼: ä¼ ç»Ÿä½ç½®ç¼–ç å’Œç¥ç»ç½‘ç»œè‡ªåŠ¨è®­ç»ƒå¾—åˆ°ã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:8:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"9. ä»€ä¹ˆæ˜¯Attentionï¼Ÿ 9.1 ä»‹ç»Transformerï¼Œä¸ºä»€ä¹ˆè¦ä»‹ç»Attentionå‘¢ï¼Ÿå› ä¸ºåœ¨Transformerä¸­æœ€å¤šçš„multi head attentionå’ŒMask multi head attentionæ¥è‡ªScaled dot product attentionï¼Œè€Œscaled dot product attentionæ¥è‡ªself attentionï¼Œè€Œself attentionæ˜¯attentionçš„ä¸€ç§ï¼Œå› æ­¤é¦–å…ˆéœ€è¦äº†è§£Attentionï¼Œå¦‚å›¾15æ‰€ç¤ºã€‚ 9.2 Attentionåˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ å¯¹äºå›¾åƒè€Œè¨€ï¼Œattentionå°±æ˜¯äººä»¬çœ‹åˆ°å›¾åƒä¸­çš„æ ¸å¿ƒå…³æ³¨çš„åŒºåŸŸï¼Œæ˜¯å›¾åƒä¸­çš„é‡ç‚¹ï¼Œå¦‚å›¾16æ‰€ç¤ºã€‚å¯¹äºåºåˆ—è€Œè¨€ï¼ŒAttentionæœºåˆ¶æœ¬è´¨ä¸Šæ˜¯ä¸ºäº†æ‰¾åˆ°è¾“å…¥ä¸­ä¸åŒtokenä¹‹é—´çš„ç›¸äº’å…³ç³»ï¼Œé€šè¿‡æƒé‡çŸ©é˜µæ¥è‡ªå‘åœ°æ‰¾åˆ°è¯ä¸è¯ä¹‹é—´çš„å…³ç³»ã€‚ 9.3 Attentionæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ æ˜¯é€šè¿‡QKVå®ç°çš„ã€‚ é‚£ä¹ˆä»€ä¹ˆæ˜¯QKVå‘¢ï¼ŸQæ˜¯queryï¼ŒKæ˜¯keysï¼ŒVæ˜¯valuesã€‚å¦‚å›¾17æ‰€ç¤ºï¼Œä¸¾ä¾‹è€Œè¨€ï¼ŒQæ˜¯å¤§è„‘å‘å‡ºçš„ä¿¡å·ï¼Œæˆ‘å£æ¸´äº†;Kæ˜¯ç¯å¢ƒä¿¡æ¯ï¼Œçœ¼ç›çœ‹åˆ°çš„ä¸–ç•Œ;Væ˜¯å¯¹ç¯å¢ƒä¸­ä¸åŒçš„ç‰©å“èµ‹äºˆä¸åŒçš„æ¯”é‡ï¼Œæ°´çš„æ¯”é‡åŠ å¤§ã€‚ æ€»ä¹‹ï¼ŒAttentionå°±æ˜¯é€šè¿‡è®¡ç®—QKçš„ç›¸ä¼¼åº¦ï¼Œä¸Vç›¸ä¹˜å¾—åˆ°æ³¨æ„åŠ›æ•°å€¼ã€‚ $$\\text{Attention}(\\mathrm{Query},\\mathrm{Source})=\\sum\\text{Similarity}(\\mathrm{Query},\\mathrm{Key}\\mathrm{i})*\\mathrm{Value}\\mathrm{i}$$ 9.4 ä¸ºä»€ä¹ˆå¿…é¡»è¦æœ‰QKVä¸‰è€…ï¼Ÿ ä¸ºä»€ä¹ˆä¸æ˜¯åªæœ‰Qï¼Ÿå› ä¸ºQ1ä¸Q2ä¹‹é—´çš„å…³ç³»æƒé‡ï¼Œä¸æ­¢éœ€è¦a12ï¼Œä¹Ÿéœ€è¦a21ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Ÿæˆ‘ä»¬è®©a12=a21ä¸è¡Œå—ï¼Ÿä¹Ÿå¯ä»¥å°è¯•ï¼Œä½†ä»åŸç†ä¸Šè®²æ•ˆæœåº”è¯¥æ²¡æœ‰a12å’Œa21æ•ˆæœå¥½ã€‚ ä¸ºä»€ä¹ˆä¸æ˜¯åªæœ‰QKï¼Ÿæ±‚å¾—çš„æƒé‡ç³»æ•°éœ€è¦æ”¾åˆ°è¾“å…¥ä¸­ï¼Œå¯ä»¥ä¹˜Qï¼Œä¹Ÿå¯ä»¥ä¹˜Kï¼Œä¸ºä»€ä¹ˆè¦é‡æ–°ä¹˜Vå‘¢ï¼Ÿæˆ‘è§‰å¾—å¯èƒ½æ˜¯å¤šäº†ä¸€ç»„å¯è®­ç»ƒå‚æ•°$W_V$ï¼Œä½¿ç½‘ç»œå…·æœ‰æ›´å¼ºçš„å­¦ä¹ èƒ½åŠ›ã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:9:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"10. ä»€ä¹ˆæ˜¯Self Attentionï¼Ÿ 10.1 ä»‹ç»Transformerï¼Œä¸ºä»€ä¹ˆè¦ä»‹ç»self Attentionå‘¢ï¼Ÿå› ä¸ºåœ¨Transformerä¸­æœ€å¤šçš„multi head attentionå’ŒMask multi head attentionæ¥è‡ªScaled dot product attentionï¼Œè€Œscaled dot product attentionæ¥è‡ªself attentionï¼Œå¦‚å›¾15æ‰€ç¤ºã€‚ 10.2 ä»€ä¹ˆæ˜¯Self Attentionå‘¢ï¼Ÿself attentionå’Œlocal attentionã€stride attentionéƒ½æ˜¯attentionçš„ä¸€ç§;self attentionæ˜¯æ¯ä¸€ä¸ªQä¸æ¯ä¸€ä¸ªKä¾æ¬¡è®¡ç®—æ³¨æ„åŠ›ç³»æ•°ï¼Œå¦‚å›¾18æ‰€ç¤ºï¼Œè€Œåƒlocal attentionæ˜¯Qåªä¸ç›¸é‚»çš„Kè®¡ç®—æ³¨æ„åŠ›ç³»æ•°ï¼Œstride attentionæ˜¯Qé€šè¿‡è·³è¿çš„æ–¹å¼ä¸Kè®¡ç®—æ³¨æ„åŠ›ç³»æ•°ã€‚ 10.3 Self attentionä¸ºä»€ä¹ˆå¯ä»¥ç”¨äºå¤„ç†åƒæœºå™¨ç¿»è¯‘è¿™ç§åºåˆ—æ•°æ®? è¾“å…¥åºåˆ—ä¸­çš„æ¯ä¸€ä¸ªä½ç½®çš„æ•°æ®ï¼Œå¯ä»¥å…³æ³¨å…¶ä»–ä½ç½®çš„ä¿¡æ¯ï¼Œç”±æ­¤é€šè¿‡Attention scoreæ¥æå–ç‰¹å¾æˆ–è€…æ•è·è¾“å…¥åºåˆ—æ¯ä¸€ä¸ªtokenä¹‹é—´çš„å…³ç³»ã€‚ 10.4 Self attentionæ˜¯å¦‚ä½•å…·ä½“å®ç°çš„? æ€»å…±åˆ†ä¸º4æ­¥ï¼Œå¦‚å›¾19æ‰€ç¤º ","date":"2023-08-21","objectID":"/posts/transformerqanda/:10:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"11. ä»€ä¹ˆæ˜¯Scaled dot product attentionï¼Ÿ 11.1 self attentionæœ€å¸¸è§çš„æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯dot product attentionã€å¦ä¸€ç§æ˜¯additive attentionï¼Œå¦‚å›¾20æ‰€ç¤ºï¼Œå‰è€…çš„è®¡ç®—æ•ˆç‡æ›´é«˜ã€‚ 11.2 ä»€ä¹ˆæ˜¯Scaled ? scaledçš„å…·ä½“å®ç°æ–¹å¼å¦‚å›¾21æ‰€ç¤ºï¼Œè¿™ä¸€æ“ä½œçš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢å†…ç§¯è¿‡å¤§ï¼Œä»æ¢¯åº¦è§’åº¦è€ƒè™‘ï¼Œé¿å…é è¿‘1ï¼Œæ˜“è®­ç»ƒ;ä¸batch normalizationæœ‰ä¸€äº›ç›¸ä¼¼çš„åŠŸèƒ½ã€‚ $$\\text{Attention}(Q,K,V)=\\text{softmax}(\\frac{QK^T}{\\sqrt{d_k}})V$$ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:11:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"12. ä»€ä¹ˆæ˜¯Multi head attentionï¼Ÿ 12.1 Multi head attentionåœ¨Transformeræ¶æ„ä¸­çš„ä½ç½®å¦‚å›¾15æ‰€ç¤ºã€‚ 12.2 æå‡ºèƒŒæ™¯: CNNå…·æœ‰å¤šä¸ªchannelï¼Œå¯ä»¥æå–å›¾åƒä¸åŒç»´åº¦çš„ç‰¹å¾ä¿¡æ¯ï¼Œé‚£ä¹ˆSelf attentionæ˜¯å¦å¯ä»¥æœ‰ç±»ä¼¼æ“ä½œï¼Œå¯ä»¥æå–ä¸åŒè·ç¦»tokençš„å¤šä¸ªç»´åº¦ä¿¡æ¯å‘¢ï¼Ÿ 12.3 ä»€ä¹ˆæ˜¯group å·ç§¯ï¼Ÿå¦‚å›¾22æ‰€ç¤ºï¼Œå°†è¾“å…¥çš„ç‰¹å¾å¤šä¸ªchannelåˆ†æˆå‡ ä¸ªgroupå•ç‹¬åšå·ç§¯ï¼Œæœ€åå†è¿›è¡Œcon cæ“ä½œã€‚ 12.4 Multi head attentionçš„å®ç°æ–¹å¼ï¼Ÿä¸self attentionæ ¹æœ¬ä¸åŒæ˜¯ä»€ä¹ˆï¼Ÿ å¦‚å›¾23æ‰€ç¤ºï¼Œä»¥2ä¸ªheadçš„ä¸ºä¾‹ï¼Œå°†è¾“å…¥çš„Qã€Kã€Våˆ†æˆä¸¤ä»½ï¼Œæ¯ä¸€å°ä»½çš„Qä¸å¯¹åº”çš„Kã€Våˆ†åˆ«æ“ä½œï¼Œæœ€åè®¡ç®—å¾—åˆ°çš„å‘é‡å†è¿›è¡Œconcæ“ä½œï¼Œç”±æ­¤å¯ä»¥çœ‹å‡ºï¼ŒMulti head attentionä¸groupå·ç§¯æœ‰ç€ç›¸ä¼¼çš„å®ç°æ–¹å¼ã€‚ 12.5 å¦‚ä½•ä»è¾“å…¥è¾“å‡ºçš„ç»´åº¦æ¥ç†è§£Multi head attentionï¼Ÿå¦‚å›¾24æ‰€ç¤ºã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:12:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"13. ä»€ä¹ˆæ˜¯Mask Multi head attentionï¼Ÿ 13.1 Mask Multi head attentionåœ¨transformeræ¶æ„ä¸­çš„ä½ç½®å¦‚å›¾15æ‰€ç¤ºã€‚ 13.2 ä¸ºä»€ä¹ˆè¦æœ‰Maskè¿™ç§æ“ä½œï¼Ÿ Transformeré¢„æµ‹ç¬¬Tä¸ªæ—¶åˆ»çš„è¾“å‡ºï¼Œä¸èƒ½çœ‹åˆ°Tæ—¶åˆ»ä¹‹åçš„é‚£äº›è¾“å…¥ï¼Œä»è€Œä¿è¯è®­ç»ƒå’Œé¢„æµ‹ä¸€è‡´ã€‚ é€šè¿‡ Masked æ“ä½œå¯ä»¥é˜²æ­¢ç¬¬ i ä¸ªå•è¯çŸ¥é“ i+1 ä¸ªå•è¯ä¹‹åçš„ä¿¡æ¯ï¼Œå¦‚å›¾25æ‰€ç¤ºã€‚ 13.3 Maskæ“ä½œæ˜¯å¦‚ä½•å…·ä½“å®ç°çš„å‘¢ï¼Ÿ Q1åªè·ŸK1è®¡ç®—ï¼ŒQ2åªè·ŸK1ã€K2è®¡ç®—ï¼Œè€Œå¯¹äºK3ã€K4ç­‰ï¼Œåœ¨softmaxä¹‹å‰ç»™ä¸€ä¸ªéå¸¸å¤§çš„è´Ÿæ•°ï¼Œç”±æ­¤ç»è¿‡softmaxä¹‹åå˜ä¸º0ï¼Œå…¶åœ¨çŸ©é˜µä¸Šçš„è®¡ç®—åŸç†å®ç°å¦‚å›¾26æ‰€ç¤ºã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:13:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"14. ä»€ä¹ˆæ˜¯ADDï¼Ÿ 14.1 Addå°±æ˜¯æ®‹å·®è¿æ¥ï¼Œç”±2015å¹´ResNetè¿™ç¯‡æ–‡ç« å‘æ‰¬å…‰å¤§(ç›®å‰å¼•ç”¨é‡å·²è¶…è¿‡16ä¸‡)ï¼Œä¸Skip connectionçš„åŒºåˆ«åœ¨äºéœ€è¦å¤§å°ç»´åº¦å…¨éƒ¨ç›¸åŒã€‚ 14.2 ä½œä¸ºå¤§é“è‡³ç®€æƒ³æ³•çš„æè‡´ï¼Œå‡ ä¹æ¯ä¸€ä¸ªæ·±åº¦å­¦ä¹ æ¨¡å‹éƒ½ä¼šç”¨åˆ°è¿™ä¸ªæŠ€æœ¯ï¼Œå¯ä»¥é˜²æ­¢ç½‘ç»œé€€åŒ–ï¼Œå¸¸ç”¨äºè§£å†³å¤šå±‚ç½‘ç»œéš¾è®­ç»ƒçš„é—®é¢˜ã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:14:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"15. ä»€ä¹ˆæ˜¯Normï¼Ÿ 15.1 Normå°±æ˜¯layer normalizationã€‚ 15.2 æ ¸å¿ƒä½œç”¨: ä¸ºäº†è®­ç»ƒæ›´åŠ ç¨³å®šï¼Œå’Œbatch normalizationæœ‰ç›¸åŒçš„ä½œç”¨ï¼Œéƒ½æ˜¯ä¸ºäº†ä½¿è¾“å…¥çš„æ ·æœ¬å‡å€¼ä¸ºé›¶ï¼Œæ–¹å·®ä¸º1ã€‚ 15.3 ä¸ºä»€ä¹ˆä¸ä½¿ç”¨batch normalizationï¼Œä½¿ç”¨çš„æ˜¯layer normalizationå‘¢ï¼Ÿå› ä¸ºä¸€ä¸ªæ—¶åºæ•°æ®ï¼Œå¥å­è¾“å…¥é•¿åº¦æœ‰é•¿æœ‰çŸ­ï¼Œå¦‚æœä½¿ç”¨batch normalizationï¼Œåˆ™å¾ˆå®¹æ˜“é€ æˆå› æ ·æœ¬é•¿çŸ­ä¸ä¸€é€ æˆâ€œè®­ç»ƒä¸ç¨³å®šâ€ã€‚BNæ˜¯å¯¹åŒä¸€ä¸ªbatchå†…çš„æ‰€æœ‰æ•°æ®çš„åŒä¸€ä¸ªç‰¹å¾æ•°æ®è¿›è¡Œæ“ä½œ;è€ŒLNæ˜¯å¯¹åŒä¸€ä¸ªæ ·æœ¬è¿›è¡Œæ“ä½œã€‚ ä»€ä¹ˆæ˜¯FFNï¼Ÿ 16.1 FFNå°±æ˜¯feed forward networksã€‚ 16.2 ä¸ºä»€ä¹ˆæœ‰äº†Self attentionå±‚ï¼Œè¿˜è¦æœ‰FFNï¼ŸAttentionå·²ç»æœ‰äº†æƒ³è¦çš„åºåˆ—ä¿¡æ¯ç‰¹å¾ï¼ŒMLPçš„ä½œç”¨æ˜¯æŠŠä¿¡æ¯æŠ•å½±åˆ°ç‰¹å®šçš„ç©ºé—´é‡Œï¼Œå†åšä¸€æ¬¡éçº¿æ€§æ˜ å°„ï¼Œå’ŒSelf attentionäº¤æ›¿ä½¿ç”¨ã€‚ 16.3 ç»“æ„ä¸Š: åŒ…æ‹¬ä¸¤å±‚MLPï¼Œç¬¬ä¸€å±‚çš„ç»´åº¦ä¸º$5122048$ï¼Œç¬¬äºŒå±‚çš„ç»´åº¦ä¸º$2048512$ï¼Œä¸”ç¬¬äºŒå±‚MLPæ²¡æœ‰ä½¿ç”¨æ¿€æ´»å‡½æ•°ï¼Œå¦‚å›¾29æ‰€ç¤ºã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:15:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"17. Transformeræ˜¯å¦‚ä½•è®­ç»ƒå‡ºæ¥çš„ï¼Ÿ 17.1 æ•°æ®ä¸Šï¼Œåœ¨Transformerè®ºæ–‡ä¸­æœ‰æåˆ°ï¼Œç”¨åˆ°äº†4.5Må’Œ36Mçš„ç¿»è¯‘å¥å­å¯¹ã€‚ 17.2 ç¡¬ä»¶ä¸Šï¼Œbaseæ¨¡å‹æ˜¯8ä¸ªP100 GPUè®­ç»ƒäº†12ä¸ªå°æ—¶ï¼Œå¤§æ¨¡å‹æ˜¯è®­ç»ƒäº†3.5å¤©ã€‚ 17.3 æ¨¡å‹å‚æ•°å’Œè°ƒå‚å±‚é¢: ç¬¬ä¸€ï¼Œå¯è®­ç»ƒçš„å‚æ•°åŒ…æ‹¬$W_Q$ã€$W_K$ã€$W_V$ã€$W_O$ï¼Œæ¢åŒ…æ‹¬$FFN$å±‚çš„å‚æ•°ã€‚ ç¬¬äºŒï¼Œå¯è°ƒçš„å‚æ•°åŒ…æ‹¬: æ¯ä¸€ä¸ªtokenå‘é‡è¡¨ç¤ºçš„ç»´åº¦(d_model)ã€headçš„å¤´æ•°ã€Encoderå’ŒDecoderä¸­blocké‡å¤çš„æ¬¡æ•°Nã€FFNä¸­é—´å±‚å‘é‡çš„ç»´åº¦ã€Label smoothing(ç½®ä¿¡åº¦0.1)å’Œdropout(0.1)ã€‚ ","date":"2023-08-21","objectID":"/posts/transformerqanda/:16:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"18. Transformerä¸ºä»€ä¹ˆæ•ˆæœå¥½ï¼Ÿ 18.1 è™½ç„¶é¢˜ç›®æ˜¯Attention is all you needï¼Œä½†åç»­ä¸€äº›ç ”ç©¶è¡¨æ˜ï¼ŒAttentionã€æ®‹å·®è¿æ¥ã€layer normalizationã€FFNï¼Œè¿™äº›å› ç´ å…±åŒæˆå°±äº†Transformerã€‚ 18.2 Transformerä¼˜ç‚¹åŒ…æ‹¬: ç¬¬ä¸€ï¼Œæå‡ºæ·±åº¦å­¦ä¹ ç»§MLPã€CNNã€RNNåçš„ç¬¬4å¤§ç‰¹å¾æå–å™¨ã€‚ ç¬¬äºŒï¼Œä¸€å¼€å§‹ç”¨åœ¨æœºå™¨ç¿»è¯‘ï¼Œéšç€GPTå’ŒBertå½»åº•å‡ºåœˆ;æ˜¯ä¸€ä¸ªè½¬æŠ˜ç‚¹ï¼Œåœ¨è¿™ä¸ªç‚¹ä¹‹åï¼ŒNLPé¢†åŸŸå¿«é€Ÿå‘å±•ï¼Œä¹‹åå¤šæ¨¡æ€ã€å¤§æ¨¡å‹ã€è§†è§‰Transformerç­‰å¼€å§‹å…´èµ·ã€‚ ç¬¬ä¸‰ï¼Œç»™äººä»¬ä¿¡å¿ƒï¼ŒåŸæ¥CNNå’ŒRNNä¹‹åï¼Œè¿˜å¯ä»¥æœ‰æ•ˆæœæ›´å¥½çš„ç‰¹å¾æå–å™¨ã€‚ 18.3 Transformerçš„ä¸è¶³ä¹‹å¤„ï¼Ÿ ç¬¬ä¸€ï¼Œè®¡ç®—é‡å¤§ï¼Œå¯¹ç¡¬ä»¶è¦æ±‚é«˜ã€‚ ç¬¬äºŒï¼Œå› ä¸ºæ— å½’çº³åç½®ï¼Œéœ€è¦å¾ˆå¤šæ•°æ®æ‰å¯ä»¥å–å¾—å¾ˆå¥½çš„æ•ˆæœã€‚ Ref: [1]. https://mp.weixin.qq.com/s/sNyh3SzhIdsk8feYfQlTSA ","date":"2023-08-21","objectID":"/posts/transformerqanda/:17:0","tags":["Transformer"],"title":"Transformer Q \u0026 A","uri":"/posts/transformerqanda/"},{"categories":["ML"],"content":"è§£ç­”ä¸€ æˆ‘ä»¬ç›´æ¥ç”¨torchå®ç°ä¸€ä¸ªSelfAttentionæ¥è¯´ä¸€è¯´ï¼š é¦–å…ˆå®šä¹‰ä¸‰ä¸ªçº¿æ€§å˜æ¢çŸ©é˜µï¼Œquery, key, valueï¼š class BertSelfAttention(nn.Module): self.query = nn.Linear(config.hidden_size, self.all_head_size) # è¾“å…¥768ï¼Œ è¾“å‡º768 self.key = nn.Linear(config.hidden_size, self.all_head_size) # è¾“å…¥768ï¼Œ è¾“å‡º768 self.value = nn.Linear(config.hidden_size, self.all_head_size) æ³¨æ„ï¼Œè¿™é‡Œçš„query, key, valueåªæ˜¯ä¸€ç§æ“ä½œ(çº¿æ€§å˜æ¢)çš„åç§°ï¼Œå®é™…çš„Q/K/Væ˜¯å®ƒä»¬ä¸‰ä¸ªçš„è¾“å‡º å‡è®¾ä¸‰ç§æ“ä½œçš„è¾“å…¥éƒ½æ˜¯åŒä¸€ä¸ªçŸ©é˜µ(æš‚ä¸”å…ˆåˆ«ç®¡ä¸ºä»€ä¹ˆè¾“å…¥æ˜¯åŒä¸€ä¸ªçŸ©é˜µ)ï¼Œè¿™é‡Œæš‚ä¸”å®šä¸ºé•¿åº¦ä¸ºLçš„å¥å­ï¼Œæ¯ä¸ªtokençš„ç‰¹å¾ç»´åº¦æ˜¯768ï¼Œé‚£ä¹ˆè¾“å…¥å°±æ˜¯(L, 768)ï¼Œæ¯ä¸€è¡Œå°±æ˜¯ä¸€ä¸ªå­—ï¼Œåƒè¿™æ ·ï¼š ä¹˜ä»¥ä¸Šé¢ä¸‰ç§æ“ä½œå°±å¾—åˆ°äº†Q/K/Vï¼Œ(L, 768)*(768,768) = (L,768)ï¼Œç»´åº¦å…¶å®æ²¡å˜ï¼Œå³æ­¤åˆ»çš„Q/K/Våˆ†åˆ«ä¸ºï¼š ä»£ç ä¸º: class BertSelfAttention(nn.Module): def __init__(self, config): self.query = nn.Linear(config.hidden_size, self.all_head_size) # è¾“å…¥768ï¼Œ è¾“å‡º768 self.key = nn.Linear(config.hidden_size, self.all_head_size) # è¾“å…¥768ï¼Œ è¾“å‡º768 self.value = nn.Linear(config.hidden_size, self.all_head_size) # è¾“å…¥768ï¼Œ è¾“å‡º768 def forward(self, hidden_states): # hidden_states ç»´åº¦æ˜¯(L, 768) Q = self.query(hidden_states) K = self.key(hidden_states) V = self.value(hidden_states) ç„¶åæ¥å®ç°è¿™ä¸ªæ“ä½œ: $$Attention(Q,K_i,V_i)\\color{red}{\\boxed{=softmax(\\frac{Q^TK_i}{\\sqrt{d_k}})V_i}}$$ â‘  é¦–å…ˆæ˜¯Qå’ŒKçŸ©é˜µä¹˜ï¼Œ(L, 768)*(L, 768)çš„è½¬ç½®=(L,L)ï¼Œçœ‹å›¾ï¼š é¦–å…ˆç”¨Qçš„ç¬¬ä¸€è¡Œï¼Œå³â€œæˆ‘â€å­—çš„768ç‰¹å¾å’ŒKä¸­â€œæˆ‘â€å­—çš„768ä¸ºç‰¹å¾ç‚¹ä¹˜æ±‚å’Œï¼Œå¾—åˆ°è¾“å‡º(0ï¼Œ0)ä½ç½®çš„æ•°å€¼ï¼Œè¿™ä¸ªæ•°å€¼å°±ä»£è¡¨äº†â€œæˆ‘æƒ³åƒé…¸èœé±¼â€ä¸­â€œæˆ‘â€å­—å¯¹â€œæˆ‘â€å­—çš„æ³¨æ„åŠ›æƒé‡ï¼Œç„¶åæ˜¾è€Œæ˜“è§è¾“å‡ºçš„ç¬¬ä¸€è¡Œå°±æ˜¯â€œæˆ‘â€å­—å¯¹â€œæˆ‘æƒ³åƒé…¸èœé±¼â€é‡Œé¢æ¯ä¸ªå­—çš„æ³¨æ„åŠ›æƒé‡ï¼›æ•´ä¸ªç»“æœè‡ªç„¶å°±æ˜¯â€œæˆ‘æƒ³åƒé…¸èœé±¼â€é‡Œé¢æ¯ä¸ªå­—å¯¹å…¶å®ƒå­—(åŒ…æ‹¬è‡ªå·±)çš„æ³¨æ„åŠ›æƒé‡(å°±æ˜¯ä¸€ä¸ªæ•°å€¼)äº†~ â‘¡ ç„¶åæ˜¯é™¤ä»¥æ ¹å·dimï¼Œè¿™ä¸ªdimå°±æ˜¯768ï¼Œè‡³äºä¸ºä»€ä¹ˆè¦é™¤ä»¥è¿™ä¸ªæ•°å€¼ï¼Ÿä¸»è¦æ˜¯ä¸ºäº†ç¼©å°ç‚¹ç§¯èŒƒå›´ï¼Œç¡®ä¿softmaxæ¢¯åº¦ç¨³å®šæ€§ï¼Œå…·ä½“æ¨å¯¼å¯ä»¥çœ‹è¿™é‡Œï¼šè²ç”Ÿä¸‰åäºŒï¼šSelf-attentionä¸­dot-productæ“ä½œä¸ºä»€ä¹ˆè¦è¢«ç¼©æ”¾ï¼Œç„¶åå°±æ˜¯ä¸ºä»€ä¹ˆè¦softmaxï¼Œä¸€ç§è§£é‡Šæ˜¯ä¸ºäº†ä¿è¯æ³¨æ„åŠ›æƒé‡çš„éè´Ÿæ€§ï¼ŒåŒæ—¶å¢åŠ éçº¿æ€§ï¼Œè¿˜æœ‰ä¸€äº›å·¥ä½œå¯¹å»æ‰softmaxè¿›è¡Œäº†å®éªŒï¼Œå¦‚PaperWeeklyï¼šçº¿æ€§Attentionçš„æ¢ç´¢ï¼šAttentionå¿…é¡»æœ‰ä¸ªSoftmaxå—ï¼Ÿ â‘¢ ç„¶åå°±æ˜¯åˆšæ‰çš„æ³¨æ„åŠ›æƒé‡å’ŒVçŸ©é˜µä¹˜äº†ï¼Œå¦‚å›¾ï¼š æ³¨æ„åŠ›æƒé‡ x VALUEçŸ©é˜µ = æœ€ç»ˆç»“æœ é¦–å…ˆæ˜¯â€œæˆ‘â€è¿™ä¸ªå­—å¯¹â€œæˆ‘æƒ³åƒé…¸èœé±¼â€è¿™å¥è¯é‡Œé¢æ¯ä¸ªå­—çš„æ³¨æ„åŠ›æƒé‡ï¼Œå’ŒVä¸­â€œæˆ‘æƒ³åƒé…¸èœé±¼â€é‡Œé¢æ¯ä¸ªå­—çš„ç¬¬ä¸€ç»´ç‰¹å¾è¿›è¡Œç›¸ä¹˜å†æ±‚å’Œï¼Œè¿™ä¸ªè¿‡ç¨‹å…¶å®å°±ç›¸å½“äºç”¨æ¯ä¸ªå­—çš„æƒé‡å¯¹æ¯ä¸ªå­—çš„ç‰¹å¾è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œç„¶åå†ç”¨â€œæˆ‘â€è¿™ä¸ªå­—å¯¹å¯¹â€œæˆ‘æƒ³åƒé…¸èœé±¼â€è¿™å¥è¯é‡Œé¢æ¯ä¸ªå­—çš„æ³¨æ„åŠ›æƒé‡å’ŒVä¸­â€œæˆ‘æƒ³åƒé…¸èœé±¼â€é‡Œé¢æ¯ä¸ªå­—çš„ç¬¬äºŒç»´ç‰¹å¾è¿›è¡Œç›¸ä¹˜å†æ±‚å’Œï¼Œä¾æ¬¡ç±»æ¨~æœ€ç»ˆä¹Ÿå°±å¾—åˆ°äº†(L,768)çš„ç»“æœçŸ©é˜µï¼Œå’Œè¾“å…¥ä¿æŒä¸€è‡´~ æ•´ä¸ªè¿‡ç¨‹åœ¨è‰ç¨¿çº¸ä¸Šç”»ä¸€ç”»ç®€å•çš„çŸ©é˜µä¹˜å°±å‡ºæ¥äº†ï¼Œä¸€ç›®äº†ç„¶~æœ€åä¸Šä»£ç ï¼š class BertSelfAttention(nn.Module): def __init__(self, config): self.query = nn.Linear(config.hidden_size, self.all_head_size) # è¾“å…¥768ï¼Œ è¾“å‡º768 self.key = nn.Linear(config.hidden_size, self.all_head_size) # è¾“å…¥768ï¼Œ è¾“å‡º768 self.value = nn.Linear(config.hidden_size, self.all_head_size) # è¾“å…¥768ï¼Œ è¾“å‡º768 def forward(self,hidden_states): # hidden_states ç»´åº¦æ˜¯(L, 768) Q = self.query(hidden_states) K = self.key(hidden_states) V = self.value(hidden_states) attention_scores = torch.matmul(Q, K.transpose(-1, -2)) attention_scores = attention_scores / math.sqrt(self.attention_head_size) attention_probs = nn.Softmax(dim=-1)(attention_scores) out = torch.matmul(attention_probs, V) return out ä¸ºä»€ä¹ˆå«è‡ªæ³¨æ„åŠ›ç½‘ç»œï¼Ÿ å› ä¸ºå¯ä»¥çœ‹åˆ°Q/K/Véƒ½æ˜¯é€šè¿‡åŒä¸€å¥è¯çš„è¾“å…¥ç®—å‡ºæ¥çš„ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æµç¨‹ä¹Ÿå°±æ˜¯ä¸€å¥è¯å†…æ¯ä¸ªå­—å¯¹å…¶å®ƒå­—(åŒ…æ‹¬è‡ªå·±)çš„æƒé‡åˆ†é…ï¼›é‚£å¦‚æœä¸æ˜¯è‡ªæ³¨æ„åŠ›å‘¢ï¼Ÿç®€å•æ¥è¯´ï¼ŒQæ¥è‡ªäºå¥Aï¼ŒKã€Væ¥è‡ªäºå¥Bå³å¯~ æ³¨æ„ï¼ŒK/Vä¸­ï¼Œå¦‚æœåŒæ—¶æ›¿æ¢ä»»æ„ä¸¤ä¸ªå­—çš„ä½ç½®ï¼Œå¯¹æœ€ç»ˆçš„ç»“æœæ˜¯ä¸ä¼šæœ‰å½±å“çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆï¼Œå¯ä»¥è‡ªå·±åœ¨è‰ç¨¿çº¸ä¸Šç”»ä¸€ç”»çŸ©é˜µä¹˜ï¼›ä¹Ÿå°±æ˜¯è¯´æ³¨æ„åŠ›æœºåˆ¶æ˜¯æ²¡æœ‰ä½ç½®ä¿¡æ¯çš„ï¼Œä¸åƒCNN/RNN/LSTMï¼›è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦å¼•å…¥positional embedingçš„åŸå› ã€‚ ","date":"2023-08-20","objectID":"/posts/attentionaqkv/:1:0","tags":["Transformer"],"title":"Transformer | å¦‚ä½•ç†è§£attentionä¸­çš„Q,K,Vï¼Ÿ","uri":"/posts/attentionaqkv/"},{"categories":["ML"],"content":"è§£ç­”äºŒ å…¶å®ç›´æ¥ç”¨é‚±é”¡é¹è€å¸ˆPPTé‡Œçš„ä¸€å¼ å›¾å°±å¯ä»¥ç›´è§‚ç†è§£â€”â€”å‡è®¾Dæ˜¯è¾“å…¥åºåˆ—çš„å†…å®¹ï¼Œå®Œå…¨å¿½ç•¥çº¿æ€§å˜æ¢çš„è¯å¯ä»¥è¿‘ä¼¼è®¤ä¸ºQ=K=V=D(æ‰€ä»¥å«åšSelf-Attentionï¼Œå› ä¸ºè¿™æ˜¯è¾“å…¥çš„åºåˆ—å¯¹å®ƒè‡ªå·±çš„æ³¨æ„åŠ›)ï¼Œäºæ˜¯åºåˆ—ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ç»è¿‡Self-Attentionä¹‹åçš„è¡¨ç¤ºå°±å¯ä»¥è¿™æ ·å±•ç°ï¼š ä¹Ÿå°±æ˜¯è¯´ï¼ŒTheè¿™ä¸ªè¯çš„è¡¨ç¤ºï¼Œå®é™…ä¸Šæ˜¯æ•´ä¸ªåºåˆ—åŠ æƒæ±‚å’Œçš„ç»“æœâ€”â€”æƒé‡ä»å“ªæ¥ï¼Ÿç‚¹ç§¯ä¹‹åSoftmaxå¾—åˆ°â€”â€”è¿™é‡ŒSoftmax(QK)å°±æ˜¯æ±‚æƒé‡çš„ä½“ç°ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå‘é‡ç‚¹ç§¯çš„å€¼å¯ä»¥è¡¨å¾è¯ä¸è¯ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œè€Œæ­¤å¤„çš„â€œæ•´ä¸ªåºåˆ—â€åŒ…æ‹¬Theè¿™ä¸ªè¯è‡ªå·±(å†ä¸€æ¬¡å¼ºè°ƒè¿™æ˜¯Self-Attention)ï¼Œæ‰€ä»¥æœ€åè¾“å‡ºçš„è¯çš„è¡¨ç¤ºï¼Œå…¶â€œä¸»è¦æˆåˆ†â€å°±ä¸»è¦åœ°åŒ…å«å®ƒè‡ªèº«å’Œè·Ÿå®ƒç›¸ä¼¼çš„è¯çš„è¡¨ç¤ºï¼Œå…¶ä»–æ— å…³çš„è¯çš„è¡¨ç¤ºå¯¹åº”çš„æƒé‡å°±ä¼šæ¯”è¾ƒä½ã€‚ ","date":"2023-08-20","objectID":"/posts/attentionaqkv/:2:0","tags":["Transformer"],"title":"Transformer | å¦‚ä½•ç†è§£attentionä¸­çš„Q,K,Vï¼Ÿ","uri":"/posts/attentionaqkv/"},{"categories":["ML"],"content":"è§£ç­”ä¸‰ é¦–å…ˆé™„ä¸Šé“¾æ¥ï¼šå¼ ä¿Šæ—ï¼šæ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æ¨¡å‹(2017ç‰ˆ) ã€‚è¿™ä¸ªå‡ ä¹æ˜¯æˆ‘è¯»åˆ°è¿‡çš„è®²è§£Attentionæœ€ä¸ºé€å½»çš„ç¯‡ç« ä¹‹ä¸€äº†ã€‚ Q(Querry)ä»£è¡¨æŸ¥è¯¢å€¼ï¼Œå¯¹åº”Decoderçš„H(t-1)çŠ¶æ€ã€‚è¿™é‡Œè¦æ­£ç¡®ç†è§£H(t-1)ï¼Œæƒ³è¦è§£ç å‡ºtæ—¶åˆ»çš„è¾“å‡ºï¼Œä½ é€å…¥Decoderçš„å¿…ç„¶æœ‰å‰ä¸€æ—¶åˆ»è®¡ç®—å‡ºçš„éšçŠ¶æ€ã€‚å¥½äº†ï¼Œæ‰€è°“æŸ¥è¯¢ï¼Œå°±æ˜¯ä½ è¦æ‹¿ç€è¿™ä¸ªDecoderä¸­çš„H(t-1)å»å’ŒEncoderä¸­å„ä¸ªæ—¶åˆ»çš„éšçŠ¶æ€H(1), H(2), â€¦ , H(T)å»æ¯”ï¼Œä¹Ÿå°±æ˜¯äºŒè€…è®¡ç®—ç›¸ä¼¼åº¦(å¯¹åº”äºæ–‡çŒ®ä¸­çš„å„ç§energyå‡½æ•°)ã€‚æœ€åç®—å‡ºæ¥çš„ç»“æœç”¨Softmaxå½’ä¸€åŒ–ï¼Œè¿™ä¸ªç®—å‡ºæ¥çš„æƒé‡å°±æ˜¯å¸¦æœ‰æ³¨æ„åŠ›æœºåˆ¶çš„æƒé‡ï¼Œå…¶å®åœ¨ç¿»è¯‘ä»»åŠ¡ä¸­ï¼ŒKeyå’ŒValueæ˜¯ç›¸ç­‰çš„ã€‚åœ¨Transformerçš„å®ç°æºç ä¸­ï¼ŒKeyå’ŒValueçš„åˆå§‹å€¼ä¹Ÿæ˜¯ç›¸ç­‰çš„ã€‚æœ‰äº†è¿™ä¸ªæƒé‡ä¹‹åï¼Œå°±å¯ä»¥ç”¨è¿™ä¸ªæƒé‡å¯¹Valueè¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œç”Ÿæˆçš„è¿™ä¸ªæ–°çš„å‘é‡å°±æ˜¯å¸¦æœ‰æ³¨æ„åŠ›æœºåˆ¶çš„è¯­ä¹‰å‘é‡ Context vectorï¼Œè€Œè¿™ä¸ªè¯­ä¹‰å‘é‡ä¼šæƒè¡¡Targetä¸Sourceçš„tokenä¸tokençš„å…³ç³»ï¼Œä»è€Œå®ç°è§£ç è¾“å‡ºæ—¶ï¼Œä¸Sourceä¸­â€œçœŸæ­£æœ‰å†³å®šæ„ä¹‰â€çš„tokenå…³è”ã€‚ å§‘ä¸”ç”»è›‡æ·»è¶³çš„å†è¯´å‡ å¥ï¼š é¦–å…ˆï¼ŒAttentionæœºåˆ¶æ˜¯ç”±Encoder-Decoderæ¶æ„è€Œæ¥ï¼Œä¸”æœ€åˆæ˜¯ç”¨äºå®ŒæˆNLPé¢†åŸŸä¸­çš„ç¿»è¯‘(Translation)ä»»åŠ¡ã€‚é‚£ä¹ˆè¾“å…¥è¾“å‡ºå°±æ˜¯éå¸¸æ˜æ˜¾çš„ Source-Targetçš„å¯¹åº”å…³ç³»ï¼Œç»å…¸çš„Seq2Seqç»“æ„æ˜¯ä»Encoderç”Ÿæˆå‡ºä¸€ä¸ªè¯­ä¹‰å‘é‡(Context vector)è€Œä¸å†å˜åŒ–ï¼Œç„¶åå°†è¿™ä¸ªè¯­ä¹‰å‘é‡é€å…¥Decoderé…åˆè§£ç è¾“å‡ºã€‚è¿™ç§æ–¹æ³•çš„æœ€å¤§é—®é¢˜å°±æ˜¯è¿™ä¸ªè¯­ä¹‰å‘é‡ï¼Œæˆ‘ä»¬æ˜¯å¸Œæœ›å®ƒä¸€æˆä¸å˜å¥½å‘¢ï¼Ÿè¿˜æ˜¯å®ƒæœ€å¥½èƒ½é…åˆDecoderåŠ¨æ€è°ƒæ•´è‡ªå·±ï¼Œæ¥ä½¿Targetä¸­çš„æŸäº›tokenä¸Sourceä¸­çš„çœŸæ­£â€œæœ‰å†³å®šæ„ä¹‰â€çš„tokenå…³è”èµ·æ¥å¥½å‘¢ï¼Ÿ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰Attentionæœºåˆ¶çš„åŸå› ã€‚è¯´åˆ°åº•ï¼ŒAttentionæœºåˆ¶å°±æ˜¯æƒ³ç”Ÿæˆä¼šåŠ¨æ€å˜åŒ–çš„è¯­ä¹‰å‘é‡æ¥é…åˆè§£ç è¾“å‡ºã€‚è€Œæ–°è´µ Self-Attentionåˆ™æ˜¯ä¸ºäº†è§£å†³Targetä¸Sourceå„è‡ªå†…éƒ¨tokenä¸tokençš„å…³ç³»ã€‚åœ¨Transformerä¸­ï¼Œè¿™ä¸¤ç§æ³¨æ„åŠ›æœºåˆ¶å¾—åˆ°äº†æœ‰æœºçš„ç»Ÿä¸€ï¼Œé‡Šæ”¾å‡ºäº†å¼‚å¸¸æƒŠäººçš„æ½œåŠ›ã€‚ ref: [1]. https://mp.weixin.qq.com/s/v7N3lhMBSdoGCz4K3TmsmA ","date":"2023-08-20","objectID":"/posts/attentionaqkv/:3:0","tags":["Transformer"],"title":"Transformer | å¦‚ä½•ç†è§£attentionä¸­çš„Q,K,Vï¼Ÿ","uri":"/posts/attentionaqkv/"},{"categories":["C++"],"content":"STLå®¹å™¨åœ¨è¢«æ·»åŠ æ—¶ï¼ˆé€šè¿‡insertã€push_frontã€push_backç­‰ï¼‰è‡ªåŠ¨æ‰©å±•å®ƒä»¬è‡ªå·±æ¥å®¹çº³æ–°å¯¹è±¡ã€‚ ","date":"2023-08-19","objectID":"/posts/clause_30/:0:0","tags":["Effective STL"],"title":"Effective STL [30] | ç¡®ä¿ç›®æ ‡åŒºé—´è¶³å¤Ÿå¤§","uri":"/posts/clause_30/"},{"categories":["C++"],"content":"æ’å…¥æ•°æ® å°¾éƒ¨æ’å…¥ back_inserter å½“ä½ æƒ³å‘å®¹å™¨ä¸­æ’å…¥å¯¹è±¡ä½†å¹¶æ²¡æœ‰å‘Šè¯‰STLä»–ä»¬æ‰€æƒ³çš„æ—¶ï¼Œé—®é¢˜å‡ºç°äº†: int transmogrify(int x); // è‡ªå®šä¹‰çš„è¿™ä¸ªå‡½æ•°ä»xäº§ç”Ÿä¸€äº›æ–°å€¼ vector\u003cint\u003e values; ... // æŠŠæ•°æ®æ”¾å…¥values vector\u003cint\u003e results; // æŠŠtransmogrifyåº”ç”¨äºvaluesä¸­çš„æ¯ä¸ªå¯¹è±¡ // æŠŠè¿™ä¸ªè¿”å›çš„valuesé™„åŠ åˆ°results transform(values.begin(), values.end(),results.end(),transmogrify); // è¿™æ®µä»£ç æœ‰bugï¼ transformè¢«å‘ŠçŸ¥å®ƒçš„ç›®çš„åŒºé—´æ˜¯ä»results.end()å¼€å§‹çš„ï¼Œæ‰€ä»¥é‚£å°±æ˜¯å¼€å§‹å†™åœ¨valuesçš„æ¯ä¸ªå…ƒç´ ä¸Šè°ƒç”¨transmogrifyçš„ç»“æœçš„åœ°æ–¹ã€‚ å°±åƒæ‰€æœ‰ä½¿ç”¨ç›®æ ‡åŒºé—´çš„ç®—æ³•ï¼Œtransformé€šè¿‡å¯¹ç›®æ ‡åŒºé—´çš„å…ƒç´ èµ‹å€¼çš„æ–¹æ³•å†™å…¥ç»“æœï¼Œtransformä¼šæŠŠtransmogrifyåº”ç”¨äºvalues[0]å¹¶æŠŠç»“æœèµ‹ç»™*results.end()ã€‚ ç„¶åå®ƒä¼šæŠŠtransmogrifyåº”ç”¨äºvalue[1]å¹¶æŠŠç»“æœèµ‹ç»™*(results.end()+1)ã€‚ é‚£åªèƒ½å¸¦æ¥ç¾éš¾ï¼Œå› ä¸ºåœ¨*results.end()æ²¡æœ‰å¯¹è±¡ï¼Œ*(results.end()+1)ä¹Ÿæ²¡æœ‰ï¼å› ä¸ºtransformå¹¶æ²¡æœ‰åœ¨å°¾éƒ¨åˆ›é€ æ–°çš„å¯¹è±¡ã€‚ è°ƒç”¨transformæ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå®ƒä¼šç»™ä¸å­˜åœ¨çš„å¯¹è±¡èµ‹å€¼ã€‚ æ­£ç¡®åšæ³• æŠŠtransformçš„ç»“æœæ”¾å…¥resultså®¹å™¨çš„ç»“å°¾çš„æ–¹å¼æ˜¯è°ƒç”¨back_inserteræ¥äº§ç”ŸæŒ‡å®šç›®æ ‡åŒºé—´èµ·ç‚¹çš„è¿­ä»£å™¨: vector\u003cint\u003e results; // æŠŠtransmogrifyåº”ç”¨äºvaluesä¸­çš„æ¯ä¸ªå¯¹è±¡ï¼Œåœ¨resultsçš„ç»“å°¾æ’å…¥è¿”å›çš„values transform(values.begin(), values.end(),back_inserter(results),transmogrify); åœ¨å†…éƒ¨ï¼Œback_inserterè¿”å›çš„è¿­ä»£å™¨ä¼šè°ƒç”¨push_backï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨ä»»ä½•æä¾›push_backçš„å®¹å™¨ä¸Šä½¿ç”¨back_inserter(ä¹Ÿå°±æ˜¯ä»»ä½•æ ‡å‡†åºåˆ—å®¹å™¨: vectorã€stringã€dequeå’Œlist)ã€‚ å‰ç«¯æ’å…¥ front_inserter å¦‚æœä½ æƒ³è®©ä¸€ä¸ªç®—æ³•åœ¨å®¹å™¨çš„å‰ç«¯æ’å…¥ä¸œè¥¿ï¼Œä½ å¯ä»¥ä½¿ç”¨front_inserterã€‚ åœ¨å†…éƒ¨ï¼Œfront_inserteråˆ©ç”¨äº†push_frontï¼Œæ‰€ä»¥front_insertåªå’Œæä¾›é‚£ä¸ªæˆå‘˜å‡½æ•°çš„å®¹å™¨é…åˆ(ä¹Ÿå°±æ˜¯dequeå’Œlist): ... // åŒä¸Š list\u003cint\u003e results; // resultsç°åœ¨æ˜¯list transform(values.begin(), values.end(),front_inserter(results),transmogrify); // åœ¨resultså‰ç«¯ ä»¥ååº æ’å…¥transformçš„ç»“æœ å› ä¸ºfront_inserterç”¨push_frontæŠŠæ¯ä¸ªå¯¹è±¡æ·»åŠ åˆ°resultsï¼Œresultsä¸­çš„å¯¹è±¡é¡ºåºä¼šå’Œvaluesä¸­å¯¹åº”çš„å¯¹è±¡é¡ºåºç›¸åã€‚ vectorä¸æä¾›push_frontï¼Œæ‰€ä»¥front_inserterä¸èƒ½ç”¨äºvectorã€‚ åŒåºæ’å…¥ å¦‚æœä½ è¦transformæŠŠè¾“å‡ºç»“æœæ”¾åœ¨resultså‰ç«¯ï¼Œä½†ä½ ä¹Ÿè¦è¾“å‡ºå’Œvaluesä¸­å¯¹åº”çš„å¯¹è±¡é¡ºåºç›¸åŒï¼Œåªè¦ä»¥ç›¸åçš„é¡ºåºè¿­ä»£values: list\u003cint\u003e results; // åŒä¸Š // åœ¨resultså‰ç«¯ æ’å…¥transformçš„ç»“æœ transform(values.rbegin(), values.rend(),front_inserter(results),transmogrify); // ä¿æŒç›¸å¯¹çš„å¯¹è±¡é¡ºåº ä»»æ„ä½ç½®æ’å…¥ inserter front_inserterè®©ä½ å¼ºåˆ¶ç®—æ³•åœ¨å®¹å™¨å‰ç«¯æ’å…¥å®ƒä»¬çš„ç»“æœï¼Œback_inserterè®©ä½ å‘Šè¯‰å®ƒä»¬æŠŠç»“æœæ”¾åœ¨å®¹å™¨åç«¯ï¼Œæœ‰ç‚¹æƒŠäººçš„æ˜¯inserterå…è®¸ä½ å¼ºåˆ¶ç®—æ³•æŠŠå®ƒä»¬çš„ç»“æœæ’å…¥å®¹å™¨ä¸­çš„ä»»æ„ä½ç½®: vector\u003cint\u003e values; ... vector\u003cint\u003e results; ... // åŒä¸Š // åŒä¸Šï¼Œé™¤äº†ç°åœ¨åœ¨è°ƒç”¨transformå‰ resultså·²ç»æœ‰ä¸€äº›æ•°æ® transform(values.begin(), values.end(), // æŠŠtransmogrifyçš„ç»“æœæ’å…¥resultsçš„ä¸­é—´ inserter(results, results.begin() + results.size()/2), transmogrify); ","date":"2023-08-19","objectID":"/posts/clause_30/:1:0","tags":["Effective STL"],"title":"Effective STL [30] | ç¡®ä¿ç›®æ ‡åŒºé—´è¶³å¤Ÿå¤§","uri":"/posts/clause_30/"},{"categories":["C++"],"content":"æ’å…¥æ•ˆç‡ ä¸ç®¡ä½ æ˜¯å¦ä½¿ç”¨äº†back_inserterã€front_inserteræˆ–inserterï¼Œtransformä¼šå¯¹ç›®çš„åŒºé—´æ¯æ¬¡å†™å…¥ä¸€ä¸ªå€¼ï¼Œä½ æ— æ³•æ”¹å˜ã€‚ å½“ä½ è¦æ’å…¥çš„å®¹å™¨æ˜¯vectoræˆ–stringæ—¶ï¼Œä½ å¯ä»¥æœ€å°åŒ–è¿™ä¸ªä»£ä»·ï¼Œé¢„å…ˆè°ƒç”¨reserveã€‚ ä½ ä»ç„¶è¦æ‰¿å—æ¯æ¬¡å‘ç”Ÿæ’å…¥æ—¶ç§»åŠ¨å…ƒç´ çš„å¼€é”€ï¼Œä½†è‡³å°‘ä½ é¿å…äº†é‡æ–°åˆ†é…å®¹å™¨çš„å†…åœ¨å†…å­˜: vector\u003cint\u003e values; // åŒä¸Š vector\u003cint\u003e results; ... results.reserve(results.size() + values.size()); // ç¡®å®šresultsè‡³å°‘è¿˜èƒ½è£…å¾—ä¸‹values.size()ä¸ªå…ƒç´  transform(values.begin(), values.end(), // åŒä¸Šï¼Œä½†resultsæ²¡æœ‰ä»»ä½•é‡æ–°åˆ†é…æ“ä½œ inserter(results, results.begin() + results.size() / 2), transmogrify); å½“ä½¿ç”¨reserveæ¥æé«˜ä¸€è¿ä¸²æ’å…¥çš„æ•ˆç‡æ—¶ï¼Œæ€»æ˜¯åº”è¯¥è®°ä½reserveåªå¢åŠ å®¹å™¨çš„å®¹é‡ï¼šå®¹å™¨çš„å¤§å°ä»ç„¶æ²¡æœ‰æ”¹å˜ã€‚ å³ä½¿è°ƒç”¨å®Œreserveï¼Œå½“ä½ æƒ³è¦è®©å®¹å™¨æŠŠæ–°å…ƒç´ åŠ å…¥åˆ°vectoræˆ–stringæ—¶ï¼Œä½ ä¹Ÿå¿…é¡»å¯¹ç®—æ³•ä½¿ç”¨æ’å…¥è¿­ä»£å™¨(æ¯”å¦‚ï¼Œä»back_inserterã€front_inserteræˆ–inserterè¿”å›çš„è¿­ä»£å™¨ä¹‹ä¸€)ï¼Œå› ä¸ºèµ‹å€¼åªåœ¨ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æ“ä½œæ—¶æœ‰æ„ä¹‰ï¼Œè€Œä¸æ˜¯åœ¨ä¸€ä¸ªå¯¹è±¡å’Œä¸€å—åŸå§‹çš„æ¯”ç‰¹ä¹‹é—´ã€‚ ç¬¬ä¸€ä¸ªä¾‹å­æ­£ç¡®çš„å†™æ³•: vector\u003cint\u003e values; // åŒä¸Š vector\u003cint\u003e results; results.reserve(results.size() + values.size()); // åŒä¸Š // æŠŠtransmogrifyçš„ç»“æœå†™å…¥resultsçš„ç»“å°¾ï¼Œå¤„ç†æ—¶é¿å…äº†é‡æ–°åˆ†é… transform(values.begin(), values.end(), back_inserter(results) , transmogrify); ","date":"2023-08-19","objectID":"/posts/clause_30/:2:0","tags":["Effective STL"],"title":"Effective STL [30] | ç¡®ä¿ç›®æ ‡åŒºé—´è¶³å¤Ÿå¤§","uri":"/posts/clause_30/"},{"categories":["C++"],"content":"è¦†ç›–åŸå§‹æ•°æ® æœ‰æ—¶å€™ä½ è¦è¦†ç›–ç°æœ‰å®¹å™¨çš„å…ƒç´ è€Œä¸æ˜¯æ’å…¥æ–°çš„ã€‚ å½“è¿™ç§æƒ…å†µæ—¶ï¼Œä½ ä¸éœ€è¦æ’å…¥è¿­ä»£å™¨ï¼Œä½†ä½ ä»ç„¶éœ€è¦æŒ‰ç…§æœ¬æ¡æ¬¾çš„å»ºè®®æ¥ç¡®ä¿ä½ çš„ç›®çš„åŒºé—´è¶³å¤Ÿå¤§ã€‚ å‡è®¾ä½ è®©transformè¦†ç›–resultsçš„å…ƒç´ ã€‚å¦‚æœresultsè‡³å°‘æœ‰å’Œvaluesä¸€æ ·å¤šçš„å…ƒç´ ï¼Œé‚£å¾ˆç®€å•ã€‚å¦‚æœæ²¡æœ‰ï¼Œ ä½ ä¹Ÿå¿…é¡»ä½¿ç”¨resizeæ¥ç¡®ä¿å®ƒæœ‰ã€‚ vector\u003cint\u003e values; vector\u003cint\u003e results; ... // ç¡®ä¿resultsè‡³å°‘å’Œvaluesä¸€æ ·å¤§ if (results.size() \u003c values.size()){ results.resize(values.size()); } // è¦†ç›–values.size()ä¸ª resultsçš„å…ƒç´  transform(values.begin(), values.end(), results.begin(), transmogrify); æˆ–è€…ä½ å¯ä»¥æ¸…ç©ºresultsç„¶åç”¨é€šå¸¸çš„æ–¹å¼ä½¿ç”¨æ’å…¥è¿­ä»£å™¨: ... // é”€æ¯resultsä¸­çš„æ‰€æœ‰å…ƒç´  results.clear(); // ä¿ç•™è¶³å¤Ÿç©ºé—´ results.reserve(values.size()); // æŠŠtransformåœ°è¿”å›å€¼// æ”¾å…¥results transform(values.begin(), values.end(), back_inserter(results), transmogrify); ","date":"2023-08-19","objectID":"/posts/clause_30/:3:0","tags":["Effective STL"],"title":"Effective STL [30] | ç¡®ä¿ç›®æ ‡åŒºé—´è¶³å¤Ÿå¤§","uri":"/posts/clause_30/"},{"categories":["C++"],"content":"ç»“è®º æ— è®ºä½•æ—¶ä½ ä½¿ç”¨ä¸€ä¸ªè¦æ±‚æŒ‡å®šç›®çš„åŒºé—´çš„ç®—æ³•ï¼Œç¡®ä¿ç›®çš„åŒºé—´å·²ç»è¶³å¤Ÿå¤§æˆ–è€…åœ¨ç®—æ³•æ‰§è¡Œæ—¶å¯ä»¥å¢åŠ å¤§å°ã€‚ å¦‚æœä½ é€‰æ‹©å¢åŠ å¤§å°ï¼Œå°±ä½¿ç”¨æ’å…¥è¿­ä»£å™¨ï¼Œæ¯”å¦‚ostream_iteratorsæˆ–ä»back_inserterã€front_inserteræˆ–inserterè¿”å›çš„è¿­ä»£å™¨ã€‚ ","date":"2023-08-19","objectID":"/posts/clause_30/:4:0","tags":["Effective STL"],"title":"Effective STL [30] | ç¡®ä¿ç›®æ ‡åŒºé—´è¶³å¤Ÿå¤§","uri":"/posts/clause_30/"},{"categories":["C++"],"content":"istream_iterator æ‹·è´æ–‡ä»¶ å‡è®¾è¦æŠŠä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶æ‹·è´åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ä¸­ã€‚ä¼¼ä¹å¯ä»¥ç”¨ä¸€ç§å¾ˆæœ‰é“ç†çš„æ–¹æ³•å®Œæˆï¼š ifstream inputFile(\"interestingData.txt\"); string fileData((istream_iterator\u003cchar\u003e(inputFile)), istream_iterator\u003cchar\u003e()); // æŠŠinputFileè¯»å…¥fileDataï¼› // å…³äºä¸ºä»€ä¹ˆå®ƒä¸æ˜¯å¾ˆæ­£ç¡®è¯·çœ‹ä¸‹æ–‡å…³äºè¿™ä¸ªè¯­æ³•çš„è­¦å‘Šå‚è§æ¡æ¬¾6 å¾ˆå¿«ä½ å°±ä¼šå‘ç°è¿™ç§æ–¹æ³•æ— æ³•æŠŠæ–‡ä»¶ä¸­çš„ç©ºæ ¼æ‹·è´åˆ°å­—ç¬¦ä¸²ä¸­ã€‚ é‚£æ˜¯å› ä¸ºistream_iteratorsä½¿ç”¨operator\u003e\u003eå‡½æ•°æ¥è¿›è¡ŒçœŸçš„è¯»å–ï¼Œè€Œä¸”operator\u003e\u003eå‡½æ•°åœ¨é»˜è®¤æƒ…å†µä¸‹å¿½ç•¥ç©ºæ ¼ã€‚ å‡å¦‚ä½ æƒ³ä¿ç•™ç©ºæ ¼ï¼Œä½ è¦çš„åšå°±æ˜¯è¦†ç›–é»˜è®¤æƒ…å†µã€‚åªè¦æ¸…é™¤è¾“å…¥æµçš„skipwsæ ‡å¿—å°±è¡Œäº†ï¼š ifstream inputFile(\"interestingData.txt\"); inputFile.unset(ios::skipws); // å…³é—­inputFileçš„å¿½ç•¥ç©ºæ ¼æ ‡å¿— string fileData((istream_iterator\u003cchar\u003e(inputFile)), istream_iterator\u003cchar\u003e()); ç°åœ¨inputFileä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½æ‹·è´åˆ°fileDataä¸­äº†ã€‚ æ‹·è´é€Ÿåº¦ ä½ ä¼šå‘ç°å®ƒä»¬çš„æ‹·è´é€Ÿåº¦ä¸åƒä½ æƒ³è±¡çš„é‚£ä¹ˆå¿«ã€‚ istream_iteratorsæ‰€ä¾é çš„operator\u003e\u003eå‡½æ•°è¿›è¡Œçš„æ˜¯æ ¼å¼åŒ–è¾“å…¥ï¼Œè¿™æ„å‘³ç€æ¯æ¬¡ä½ è°ƒç”¨çš„æ—¶å€™å®ƒä»¬éƒ½å¿…é¡»åšå¤§é‡å·¥ä½œï¼š å¿…é¡»å»ºç«‹å’Œé”€æ¯å²—å“¨ï¼ˆsentryï¼‰å¯¹è±¡ï¼ˆä¸ºæ¯ä¸ªoperator\u003e\u003eè°ƒç”¨è¿›è¡Œå»ºç«‹å’Œæ¸…é™¤æ´»åŠ¨çš„ç‰¹æ®Šçš„iostreamå¯¹è±¡ï¼‰ï¼› å¿…é¡»æ£€æŸ¥å¯èƒ½å½±å“å®ƒä»¬è¡Œä¸ºçš„æµæ ‡å¿—ï¼ˆæ¯”å¦‚skipwsï¼‰ï¼› å¿…é¡»è¿›è¡Œå…¨é¢çš„è¯»å–é”™è¯¯æ£€æŸ¥ï¼› å¦‚æœå®ƒä»¬é‡åˆ°é—®é¢˜ï¼Œå®ƒä»¬å¿…é¡»æ£€æŸ¥æµçš„å¼‚å¸¸æ©ç æ¥å†³å®šæ˜¯å¦è¯¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ å¦‚æœè¿›è¡Œæ ¼å¼åŒ–è¾“å…¥ï¼Œé‚£äº›éƒ½æ˜¯é‡è¦çš„æ´»åŠ¨ï¼Œä½†å¦‚æœä½ éœ€è¦çš„åªæ˜¯ä»è¾“å…¥æµä¸­æŠ“å–ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£å°±è¿‡åº¦äº†ã€‚ ","date":"2023-08-18","objectID":"/posts/clause_29/:1:0","tags":["Effective STL"],"title":"Effective STL [29] | éœ€è¦ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¾“å…¥æ—¶è€ƒè™‘ä½¿ç”¨istreambuf_iterator","uri":"/posts/clause_29/"},{"categories":["C++"],"content":"istreambuf_iterators æ‹·è´æ–‡ä»¶ ä½ å¯ä»¥åƒistream_iteratorä¸€æ ·ä½¿ç”¨istreambuf_iteratorï¼Œä½†istream_iterator\u003cchar\u003eå¯¹è±¡ä½¿ç”¨operator\u003e\u003eæ¥ä»è¾“å…¥æµä¸­è¯»å–å•ä¸ªå­—ç¬¦ã€‚ istreambuf_iteratorå¯¹è±¡è¿›å…¥æµçš„ç¼“å†²åŒºå¹¶ç›´æ¥è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ï¼ˆæ›´æ˜ç¡®åœ°è¯´ï¼Œistreambuf_iterator\u003cchar\u003e å¯¹è±¡ä»ä¸€ä¸ªistream sä¸­è¯»å–ä¼šè°ƒç”¨s.rdbuf()-\u003esgetc()æ¥è¯»sçš„ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ï¼‰æŠŠæˆ‘ä»¬çš„æ–‡ä»¶è¯»å–ä»£ç æ”¹ä¸ºä½¿ç”¨istreambuf_iteratorç›¸å½“ç®€å•ï¼Œå¤§å¤šæ•°Visual Basicç¨‹åºå‘˜éƒ½å¯ä»¥åœ¨ä¸¤æ¬¡å°è¯•å†…åšå¯¹ï¼š ifstream inputFile(\"interestingData.txt\"); string fileData((istreambuf_iterator\u003cchar\u003e(inputFile)), istreambuf_iterator\u003cchar\u003e()); æ³¨æ„è¿™é‡Œä¸éœ€è¦â€œunsetâ€ skipwsæ ‡å¿—ï¼Œistreambuf_iteratorä¸å¿½ç•¥ä»»ä½•å­—ç¬¦ã€‚å®ƒä»¬åªæŠ“å–æµç¼“å†²åŒºçš„ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ ç›¸å¯¹äºistream_iteratorï¼Œå®ƒä»¬æŠ“å–å¾—æ›´å¿«ã€‚ å¦‚æœä½ éœ€è¦ä¸€ä¸ªä¸€ä¸ªåœ°è¯»å–æµä¸­çš„å­—ç¬¦ï¼Œä½ ä¸éœ€è¦æ ¼å¼åŒ–è¾“å…¥çš„å¨åŠ›ï¼Œä½ å…³å¿ƒçš„æ˜¯å®ƒä»¬èŠ±å¤šå°‘æ—¶é—´æ¥è¯»å–æµï¼Œå’Œæ˜æ˜¾çš„æ€§èƒ½æé«˜ç›¸æ¯”ï¼Œä¸ºæ¯ä¸ªè¿­ä»£å™¨å¤šé”®å…¥ä¸‰ä¸ªå­—ç¬¦çš„ä»£ä»·æ˜¯å¾®å¼±çš„ã€‚å¯¹äºæ— æ ¼å¼çš„ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¾“å…¥ï¼Œä½ æ€»æ˜¯åº”è¯¥è€ƒè™‘ä½¿ç”¨istreambuf_iteratorã€‚ ","date":"2023-08-18","objectID":"/posts/clause_29/:2:0","tags":["Effective STL"],"title":"Effective STL [29] | éœ€è¦ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¾“å…¥æ—¶è€ƒè™‘ä½¿ç”¨istreambuf_iterator","uri":"/posts/clause_29/"},{"categories":["C++"],"content":"ç»“è®º å½“ä½ äº†è§£å®ƒä¹‹åï¼Œä½ ä¹Ÿåº”è¯¥è€ƒè™‘æŠŠostreambuf_iteratorç”¨äºç›¸åº”çš„æ— æ ¼å¼ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¾“å‡ºçš„ä½œã€‚ å®ƒä»¬æ²¡æœ‰äº†ostream_iteratorçš„å¼€é”€ï¼ˆå’Œçµæ´»æ€§ï¼‰ï¼Œæ‰€ä»¥å®ƒä»¬é€šå¸¸ä¹Ÿåšå¾—æ›´å¥½ã€‚ ","date":"2023-08-18","objectID":"/posts/clause_29/:3:0","tags":["Effective STL"],"title":"Effective STL [29] | éœ€è¦ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¾“å…¥æ—¶è€ƒè™‘ä½¿ç”¨istreambuf_iterator","uri":"/posts/clause_29/"},{"categories":["C++"],"content":"Example é€šè¿‡reverse_iteratorçš„baseåˆå§‹åŒ–ä¸€ä¸ªiterator: vector\u003cint\u003e v; v.reserve(5); // å‚è§æ¡æ¬¾14 for(int i = 0ï¼›i \u003c 5; ++ i) { // å‘vectoræ’å…¥1åˆ°5 v.push_back(i); } vector\u003cint\u003e::reverse_iterator ri = find(v.rbegin(), v.rend(), 3); // ä½¿riæŒ‡å‘3 vector\u003cint\u003e::iterator i(ri.base()); // ä½¿iå’Œriçš„baseä¸€æ · æ‰§è¡Œä¸Šè¿°ä»£ç åï¼Œå¯ä»¥æƒ³åˆ°äº§ç”Ÿçš„ç»“æœå°±åƒè¿™æ ·: ä¸Šå›¾æ˜¾ç¤ºäº†reverse_iteratorå’Œå®ƒå¯¹åº”çš„base iteratorä¹‹é—´ç‰¹æœ‰çš„åç§»é‡ï¼Œå°±åƒrbegin()å’Œrend()ä¸ç›¸å…³çš„begin()å’Œend()ä¸€æ ·ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰è§£é‡Šæ€æ ·åœ¨riä¸Šå®ç°ä½ åœ¨iä¸Šæƒ³è¦å®Œæˆçš„æ“ä½œã€‚ æ­£å¦‚æ¡æ¬¾26è§£é‡Šçš„ï¼Œæœ‰äº›å®¹å™¨çš„æˆå‘˜å‡½æ•°åªæ¥å—iteratorç±»å‹çš„å‚æ•°ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³è¦åœ¨riæ‰€æŒ‡çš„ä½ç½®æ’å…¥ä¸€ä¸ªæ–°å…ƒç´ ï¼Œä½ ä¸èƒ½ç›´æ¥è¿™ä¹ˆåšï¼Œå› ä¸ºvectorçš„insertå‡½æ•°ä¸æ¥å—reverse_iteratorã€‚ å¦‚æœä½ æƒ³è¦åˆ é™¤riæ‰€æŒ‡ä½ç½®ä¸Šçš„å…ƒç´ ä¹Ÿä¼šæœ‰åŒæ ·çš„é—®é¢˜ã€‚eraseæˆå‘˜å‡½æ•°ä¼šæ‹’ç»reverse_iteratorï¼ŒåšæŒè¦æ±‚iteratorã€‚ ","date":"2023-08-17","objectID":"/posts/clause_28/:1:0","tags":["Effective STL"],"title":"Effective STL [28] | äº†è§£å¦‚ä½•é€šè¿‡reverse_iteratorçš„baseå¾—åˆ°iterator","uri":"/posts/clause_28/"},{"categories":["C++"],"content":"reverse_iteratorè½¬æ¢æˆiterator ä¸ºäº†å®Œæˆåˆ é™¤å’Œä¸€äº›å½¢å¼çš„æ’å…¥æ“ä½œï¼Œä½ å¿…é¡»å…ˆé€šè¿‡baseå‡½æ•°å°†reverse_iteratorè½¬æ¢æˆiteratorï¼Œç„¶åç”¨iteratoræ¥å®Œæˆå·¥ä½œã€‚ æ’å…¥æ“ä½œ å‡è®¾ä½ è¦åœ¨riæŒ‡å‡ºçš„ä½ç½®ä¸ŠæŠŠä¸€ä¸ªæ–°å…ƒç´ æ’å…¥vã€‚å‡è®¾ä½ è¦æ’å…¥çš„å€¼æ˜¯99ã€‚ **riåœ¨ä¸Šå›¾ä¸­éå†çš„é¡ºåºæ˜¯è‡ªå³å‘å·¦ï¼Œè€Œä¸”æ’å…¥æ“ä½œä¼šå°†æ–°å…ƒç´ æ’å…¥åˆ°riä½ç½®ï¼Œå¹¶ä¸”å°†åŸå…ˆriä½ç½®çš„å…ƒç´ ç§»åˆ°éå†è¿‡ç¨‹çš„â€œä¸‹ä¸€ä¸ªâ€ä½ç½®ï¼Œæˆ‘ä»¬è®¤ä¸º3åº”è¯¥å‡ºç°åœ¨99çš„å·¦ä¾§ã€‚**æ’å…¥æ“ä½œä¹‹åï¼Œvçœ‹èµ·æ¥åƒè¿™æ ·: æˆ‘ä»¬ä¸èƒ½ç”¨riæ¥æŒ‡å®šæ’å…¥çš„åœ°æ–¹ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªiteratorã€‚æˆ‘ä»¬å¿…é¡»ç”¨iæ¥ä»£æ›¿ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œå½“riæŒ‡å‘3æ—¶ï¼Œiï¼ˆå°±æ˜¯ri.base()ï¼‰æŒ‡å‘4ã€‚ å¦‚æœæˆ‘ä»¬ç”¨riæ¥æŒ‡å®šæ’å…¥ä½ç½®ï¼Œé‚£ä¹ˆç”¨iæŒ‡å‘æ’å…¥ä½ç½®ï¼Œé‚£ä¸ªå‡è®¾å°±æ˜¯æ­£ç¡®çš„ã€‚ ç»“è®º è¦å®ç°åœ¨ä¸€ä¸ªreverse_iterator riæŒ‡å‡ºçš„ä½ç½®ä¸Šæ’å…¥æ–°å…ƒç´ ï¼Œåœ¨ri.base()æŒ‡å‘çš„ä½ç½®æ’å…¥å°±è¡Œäº†ã€‚ å¯¹äºinsertæ“ä½œè€Œè¨€ï¼Œriå’Œri.base()æ˜¯ç­‰ä»·çš„ï¼Œè€Œä¸”ri.base()çœŸçš„æ˜¯riå¯¹åº”çš„iteratorã€‚ åˆ é™¤æ“ä½œ å¦‚æœä½ è¦åˆ é™¤riæŒ‡å‘çš„å…ƒç´ ï¼Œä½ ä¸èƒ½ç›´æ¥ä½¿ç”¨iäº†ï¼Œå› ä¸ºiä¸riä¸æ˜¯æŒ‡å‘åŒä¸€ä¸ªå…ƒç´ ã€‚å› æ­¤ï¼Œä½ è¦åˆ é™¤çš„æ˜¯içš„å‰ä¸€ä¸ªå…ƒç´ ã€‚ vector\u003cint\u003e v; ... // å‘væ’å…¥1åˆ°5ï¼ŒåŒä¸Š vecot\u003cint\u003e::reverse_iterator ri = find(v.rbegin(), v.rend(), 3); // åŒä¸Šï¼ŒriæŒ‡å‘3 v.erase(--ri.base()); // å°è¯•åˆ é™¤ri.base()å‰é¢çš„å…ƒç´ ï¼› // å¯¹äºvectorï¼Œä¸€èˆ¬æ¥è¯´ç¼–è¯‘ä¸é€šè¿‡ è¡¨è¾¾å¼--ri.base()ç¡®å®èƒ½å¤ŸæŒ‡å‡ºæˆ‘ä»¬éœ€è¦åˆ é™¤çš„å…ƒç´ ã€‚è€Œä¸”ï¼Œå®ƒä»¬èƒ½å¤Ÿå¤„ç†é™¤äº†vectorå’Œstringä¹‹å¤–çš„å…¶ä»–æ‰€æœ‰å®¹å™¨ã€‚ å®ƒå¯èƒ½ä¹Ÿèƒ½å¤„ç†vectorå’Œstringï¼Œä½†å¯¹äºå¤§å¤šæ•°vectorå’Œstringçš„å®ç°ï¼Œå®ƒæ— æ³•é€šè¿‡ç¼–è¯‘ã€‚ åœ¨è¿™æ ·çš„å®ç°ä¸‹ï¼Œiterator(å’Œconst_iterator)ä¼šé‡‡ç”¨å†…å»ºçš„æŒ‡é’ˆæ¥å®ç°ï¼Œæ‰€ä»¥ri.base()çš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚ åŸå› å‰–æ Cå’ŒC++éƒ½è§„å®šäº†ä¸èƒ½ç›´æ¥ä¿®æ”¹å‡½æ•°è¿”å›çš„æŒ‡é’ˆï¼Œæ‰€ä»¥åœ¨stringå’Œvectorçš„è¿­ä»£å™¨æ˜¯æŒ‡é’ˆçš„STLå¹³å°ä¸Šï¼Œåƒ--ri.base()è¿™æ ·çš„è¡¨è¾¾å¼æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚ è¦ç§»æ¤ä»ä¸€ä¸ªç”±reverse_iteratoræŒ‡å‡ºçš„ä½ç½®åˆ é™¤å…ƒç´ æ—¶ï¼Œä½ åº”è¯¥å°½é‡é¿å…ä¿®æ”¹baseçš„è¿”å›å€¼ã€‚ æ‰€ä»¥ï¼Œå¦‚æœä½ ä¸èƒ½å‡å°‘è°ƒç”¨baseçš„è¿”å›å€¼ï¼Œåªéœ€è¦å…ˆå¢åŠ reverse_iteratorçš„å€¼ï¼Œç„¶åå†è°ƒç”¨baseï¼ ... // åŒä¸Š v.erase((++ri).base()); // åˆ é™¤riæŒ‡å‘çš„å…ƒç´ ï¼› // è¿™ä¸‹ç¼–è¯‘æ²¡é—®é¢˜äº†ï¼ è¿™ä¸ªæ–¹æ³•é€‚ç”¨äºæ‰€æœ‰çš„æ ‡å‡†å®¹å™¨ï¼Œè¿™æ˜¯åˆ é™¤ä¸€ä¸ªç”±reverse_iteratoræŒ‡å‡ºçš„å…ƒç´ æ—¶é¦–é€‰çš„æŠ€å·§ ","date":"2023-08-17","objectID":"/posts/clause_28/:2:0","tags":["Effective STL"],"title":"Effective STL [28] | äº†è§£å¦‚ä½•é€šè¿‡reverse_iteratorçš„baseå¾—åˆ°iterator","uri":"/posts/clause_28/"},{"categories":["C++"],"content":"ç»“è®º reverse_iteratorçš„baseæˆå‘˜å‡½æ•°è¿”å›ä¸€ä¸ªâ€œå¯¹åº”çš„â€iteratorçš„è¯´æ³•å¹¶ä¸å‡†ç¡®ï¼šå¯¹äºæ’å…¥æ“ä½œè€Œè¨€ï¼Œçš„ç¡®å¦‚æ­¤; ä½†æ˜¯å¯¹äºåˆ é™¤æ“ä½œï¼Œå¹¶éå¦‚æ­¤ã€‚ å½“éœ€è¦æŠŠreverse_iteratorè½¬æ¢æˆiteratorçš„æ—¶å€™ï¼Œæœ‰ä¸€ç‚¹éå¸¸é‡è¦çš„æ˜¯ä½ å¿…é¡»çŸ¥é“ä½ å‡†å¤‡æ€ä¹ˆå¤„ç†è¿”å›çš„iteratorï¼Œå› ä¸ºåªæœ‰è¿™æ ·ä½ æ‰èƒ½å†³å®šä½ å¾—åˆ°çš„iteratoræ˜¯å¦æ˜¯ä½ éœ€è¦çš„ã€‚ ","date":"2023-08-17","objectID":"/posts/clause_28/:3:0","tags":["Effective STL"],"title":"Effective STL [28] | äº†è§£å¦‚ä½•é€šè¿‡reverse_iteratorçš„baseå¾—åˆ°iterator","uri":"/posts/clause_28/"},{"categories":["C++"],"content":"æŠŠconst_iteratorè½¬åŒ–ä¸ºiterator æœ‰äº›å®¹å™¨æˆå‘˜å‡½æ•°åªæ¥å—iteratorä½œä¸ºå‚æ•°ï¼Œè€Œä¸æ˜¯const_iteratorã€‚å¦‚æœä½ åªæœ‰ä¸€ä¸ªconst_iteratorï¼Œè¦åœ¨å®ƒæ‰€æŒ‡å‘çš„å®¹å™¨ä½ç½®ä¸Šæ’å…¥æ–°å…ƒç´ å‘¢ï¼Ÿ ä¸Šä¸€æ¡æ¬¾è¯´å¹¶ä¸å­˜åœ¨ä»const_iteratoråˆ°iteratorä¹‹é—´çš„éšå¼è½¬æ¢ï¼Œé‚£è¯¥æ€ä¹ˆåŠï¼Ÿ çœ‹çœ‹å½“ä½ æŠŠä¸€ä¸ªconst_iteratoræ˜ å°„ä¸ºiteratoræ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ: typedef deque\u003cint\u003e IntDeque; // æ–¹ä¾¿çš„typedef typedef IntDeque::iterator Iter; typedef IntDeque::const_iterator ConstIter; ConstIter ci; // ciæ˜¯const_iterator ... Iter i(ci); // é”™è¯¯ï¼æ²¡æœ‰ä»const_iterator åˆ°iteratoréšå¼è½¬æ¢çš„é€”å¾„ Iter i(const_cast\u003cIter\u003e(ci)); // ä»æ˜¯ä¸ªé”™è¯¯ï¼ä¸èƒ½ä»const_iterator æ˜ å°„ä¸ºiteratorï¼ è¿™é‡Œåªæ˜¯ä»¥dequeä¸ºä¾‹ï¼Œä½†æ˜¯ç”¨å…¶å®ƒå®¹å™¨ç±»â€”â€”listã€setã€multisetã€mapã€multimapç”šè‡³æ¡æ¬¾25æè¿°çš„æ•£åˆ—è¡¨å®¹å™¨â€”â€”çš„ç»“æœä¸€æ ·ã€‚ä½¿ç”¨æ˜ å°„çš„è¡Œä¹Ÿè®¸åœ¨vectoræˆ–stringçš„ä»£ç æ—¶èƒ½å¤Ÿç¼–è¯‘ï¼Œä½†è¿™æ˜¯æˆ‘ä»¬é©¬ä¸Šè¦è®¨è®ºçš„éå¸¸ç‰¹æ®Šçš„æƒ…å½¢ã€‚ ä¸Šè¿°ä»£ç ä¸èƒ½é€šè¿‡ç¼–è¯‘çš„åŸå› åœ¨äºï¼Œå¯¹äºè¿™äº›å®¹å™¨è€Œè¨€ï¼Œiteratorå’Œconst_iteratoræ˜¯å®Œå…¨ä¸åŒçš„ç±»ã€‚ åœ¨ä¸¤ä¸ªæ¯«æ— å…³è”çš„ç±»ä¹‹é—´è¿›è¡Œconst_castæ˜ å°„æ˜¯è’è°¬çš„ï¼Œæ‰€ä»¥reinterpret_castã€static_castç”šè‡³Cé£æ ¼çš„æ˜ å°„ä¹Ÿä¼šå¯¼è‡´åŒæ ·çš„ç»“æœã€‚ ä¸èƒ½ç¼–è¯‘çš„ä»£ç å¯¹äºvectorå’Œstringå®¹å™¨æ¥è¯´ä¹Ÿè®¸èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ é‚£æ˜¯å› ä¸ºé€šå¸¸æƒ…å†µä¸‹å¤§å¤šæ•°å®ç°éƒ½ä¼šé‡‡ç”¨çœŸå®çš„æŒ‡é’ˆä½œä¸ºé‚£äº›å®¹å™¨çš„è¿­ä»£å™¨ã€‚ å°±è¿™ç§å®ç°è€Œè¨€ï¼Œvector\u003cT\u003e::iteratoræ˜¯T*çš„typedefï¼Œè€Œvector\u003cT\u003e::const_iteratoræ˜¯const T*çš„typedefï¼Œstring::iteratoræ˜¯charçš„typedefï¼Œè€Œstring::const_iteratoræ˜¯const char*çš„typedefã€‚ åœ¨è¿™ç§å®ç°çš„æƒ…å†µä¸‹ï¼Œç”¨const_castæŠŠconst_iteratoræ˜ å°„æˆiteratorå½“ç„¶å¯ä»¥ç¼–è¯‘è€Œä¸”æ²¡æœ‰é—®é¢˜ï¼Œå› ä¸ºconst_iteratorä¸iteratorä¹‹é—´çš„const_castæ˜ å°„è¢«æœ€ç»ˆè§£é‡Šæˆconst T*åˆ°T*çš„æ˜ å°„ã€‚ä½†æ˜¯ï¼Œå³ä½¿æ˜¯åœ¨è¿™ç§å®ç°ä¸­ï¼Œreverse_iteratorå’Œconst_reverse_iteratorä¹Ÿæ˜¯çœŸæ­£çš„ç±»ï¼Œæ‰€ä»¥ä½ ä»ç„¶ä¸èƒ½ç›´æ¥ç”¨const_castæŠŠconst_reverse_iteratoræ˜ å°„æˆreverse_iteratorã€‚ è€Œä¸”è¿™äº›å®ç°é€šå¸¸åªä¼šåœ¨Releaseæ¨¡å¼æ—¶æ‰ä½¿ç”¨æŒ‡é’ˆè¡¨ç¤ºvectorå’Œstringçš„è¿­ä»£å™¨ã€‚ æ‰€æœ‰è¿™äº›äº‹å®è¡¨æ˜ï¼ŒæŠŠconstè¿­ä»£å™¨æ˜ å°„ä¸ºè¿­ä»£å™¨æ˜¯ç—…æ€çš„ï¼Œå³ä½¿æ˜¯å¯¹vectorå’Œstringæ¥è¯´ä¹Ÿæ—¶ï¼Œå› ä¸ºç§»æ¤æ€§å¾ˆå€¼å¾—æ€€ç–‘ã€‚ ","date":"2023-08-17","objectID":"/posts/clause_27/:1:0","tags":["Effective STL"],"title":"Effective STL [27] | ç”¨distanceå’ŒadvanceæŠŠconst_iteratorè½¬åŒ–æˆiterator","uri":"/posts/clause_27/"},{"categories":["C++"],"content":"const_iteratorè½¬æ¢ä¸ºiterator æœ‰ä¸€ç§å®‰å…¨çš„ã€å¯ç§»æ¤çš„æ–¹æ³•è·å–å®ƒæ‰€å¯¹åº”çš„iteratorï¼Œè€Œä¸”ï¼Œç”¨ä¸ç€é™·å…¥ç±»å‹ç³»ç»Ÿçš„è½¬æ¢ã€‚ #include \u003cdeque\u003e #include \u003citerator\u003e typedef deque\u003cint\u003e IntDeque; // å’Œä»¥å‰ä¸€æ · typedef IntDeque::iterator Iter; typedef IntDeque::const_iterator ConstIter; IntDeque d; ConstIter ci; ... // è®©ciæŒ‡å‘d Iter i(d.begin()); // åˆå§‹åŒ–iä¸ºd.begin() advance(i, distance(i, ci)); // æŠŠiç§»åˆ°æŒ‡å‘ciä½ç½®ï¼ˆä½†è¯·ç•™æ„ä¸‹é¢å…³äºä¸ºä»€ä¹ˆåœ¨å®ƒç¼–è¯‘å‰è¦è°ƒæ•´çš„åŸå› ï¼‰ è¦å¾—åˆ°ä¸const_iteratoræŒ‡å‘åŒä¸€ä½ç½®çš„iterator: å°†iteratoræŒ‡å‘å®¹å™¨çš„èµ·å§‹ä½ç½®ï¼Œ æŠŠå®ƒå‘å‰ç§»åˆ°å’Œconst_iteratorè·ç¦»å®¹å™¨èµ·å§‹ä½ç½®çš„åç§»é‡ä¸€æ ·çš„ä½ç½®å³å¯ è¿™ä¸ªä»»åŠ¡å¾—åˆ°äº†ä¸¤ä¸ªå‡½æ•°æ¨¡æ¿advanceå’Œdistanceçš„å¸®åŠ©ï¼Œå®ƒä»¬éƒ½åœ¨ä¸­å£°æ˜: distanceè¿”å›ä¸¤ä¸ªæŒ‡å‘åŒä¸€ä¸ªå®¹å™¨çš„iteratorä¹‹é—´çš„è·ç¦»ï¼› advanceåˆ™ç”¨äºå°†ä¸€ä¸ªiteratorç§»åŠ¨æŒ‡å®šçš„è·ç¦»ã€‚ å¦‚æœiå’ŒciæŒ‡å‘åŒä¸€ä¸ªå®¹å™¨ï¼Œé‚£ä¹ˆè¡¨è¾¾å¼advance(i, distance(i, ci))ä¼šå°†iç§»åŠ¨åˆ°ä¸ciç›¸åŒçš„ä½ç½®ä¸Šã€‚ ä¸Šè¿°ä»£ç ç¼–è¯‘å­˜åœ¨é—®é¢˜ã€‚ å…ˆæ¥çœ‹çœ‹distanceçš„å®šä¹‰ï¼š template\u003ctypename _InputIterator\u003e inline _GLIBCXX17_CONSTEXPR typename iterator_traits\u003c_InputIterator\u003e::difference_type distance(_InputIterator __first, _InputIterator __last) { // concept requirements -- taken care of in __distance return std::__distance(__first, __last, std::__iterator_category(__first)); } å½“é‡åˆ°distanceè°ƒç”¨æ—¶ï¼Œä½ çš„ç¼–è¯‘å™¨éœ€è¦æ ¹æ®ä½¿ç”¨çš„å®å‚ç±»å‹æ¨æ–­å‡ºInputIteratorçš„ç±»å‹ã€‚ å†æ¥çœ‹çœ‹æˆ‘æ‰€è¯´çš„ä¸å¤ªæ­£ç¡®çš„distanceè°ƒç”¨: advance(i, distance(i, ci)); // è°ƒæ•´iï¼ŒæŒ‡å‘ciä½ç½® æœ‰ä¸¤ä¸ªå‚æ•°ä¼ é€’ç»™distanceï¼Œiå’Œciã€‚içš„ç±»å‹æ˜¯Iterï¼Œå³deque\u003cint\u003e::iteratorçš„typedefã€‚ å¯¹ç¼–è¯‘å™¨æ¥è¯´ï¼Œè¿™è¡¨æ˜è°ƒç”¨distanceçš„InputIteratoræ˜¯deque::iteratorã€‚ä½†ciæ˜¯ConstIterï¼Œå³deque::const_iteratorçš„typedefã€‚ è¡¨æ˜é‚£ä¸ªInputIteratoræ˜¯deque\u003cint\u003e::const_iteratorã€‚ InputIteratorä¸å¯èƒ½åŒæ—¶æœ‰ä¸¤ç§ä¸åŒçš„ç±»å‹ï¼Œæ‰€ä»¥è°ƒç”¨distanceå¤±è´¥ã€‚ ä¸€èˆ¬ä¼šé€ æˆä¸€äº›å†—é•¿çš„å‡ºé”™ä¿¡æ¯ï¼Œå¯èƒ½ä¼šä¹Ÿå¯èƒ½ä¸ä¼šè¯´æ˜æ˜¯ç¼–è¯‘å™¨æ— æ³•å¾—å‡ºInputIteratoræ˜¯ä»€ä¹ˆç±»å‹ã€‚ è¦é¡ºåˆ©åœ°è°ƒç”¨distanceï¼Œä½ éœ€è¦æ’é™¤æ­§ä¹‰ã€‚ æœ€ç®€å•çš„åŠæ³•å°±æ˜¯æ˜¾å¼çš„æŒ‡æ˜distanceè°ƒç”¨çš„æ¨¡æ¿å‚æ•°ç±»å‹ï¼Œä»è€Œé¿å…ç¼–è¯‘å™¨è‡ªå·±å¾—å‡ºå®ƒä»¬çš„ç±»å‹: advance(i, distance\u003cConstIter\u003e(i, ci)); æˆ‘ä»¬ç°åœ¨çŸ¥é“äº†æ€ä¹ˆé€šè¿‡advanceå’Œdistanceè·å–const_iteratorç›¸åº”çš„iteratoräº†ã€‚ æ•ˆç‡å¦‚ä½•ï¼Ÿ ç­”æ¡ˆå¾ˆç®€å•ã€‚å–å†³äºä½ æ‰€è½¬æ¢çš„ç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ ·çš„è¿­ä»£å™¨ã€‚ å¯¹äºéšæœºè®¿é—®çš„è¿­ä»£å™¨ï¼ˆæ¯”å¦‚vectorã€stringå’Œdequeçš„ï¼‰è€Œè¨€ï¼Œè¿™æ˜¯å¸¸æ•°æ—¶é—´çš„æ“ä½œã€‚ å¯¹äºåŒå‘è¿­ä»£å™¨ï¼ˆä¹Ÿå°±æ˜¯ï¼Œæ‰€æœ‰å…¶å®ƒå®¹å™¨å’ŒåŒ…æ‹¬æ•£åˆ—å®¹å™¨çš„ä¸€äº›å®ç°ï¼‰è€Œè¨€ï¼Œè¿™æ˜¯çº¿æ€§æ—¶é—´çš„æ“ä½œã€‚ å› ä¸ºå®ƒå¯èƒ½èŠ±è´¹çº¿æ€§æ—¶é—´çš„ä»£ä»·æ¥äº§ç”Ÿä¸€ä¸ªå’Œconst_iteratorç­‰ä»·çš„iteratorï¼Œå¹¶ä¸”å› ä¸ºå¦‚æœä¸èƒ½è®¿é—®const_iteratoræ‰€å±çš„å®¹å™¨è¿™ä¸ªæ“ä½œå°±æ— æ³•å®Œæˆã€‚ ä»è¿™ä¸ªè§’åº¦å‡ºå‘ï¼Œä¹Ÿè®¸ä½ éœ€è¦é‡æ–°å®¡è§†ä½ ä»const_iteratoräº§ç”Ÿiteratorçš„è®¾è®¡ã€‚ å½“å¤„ç†å®¹å™¨æ—¶å°½é‡ç”¨iteratorä»£æ›¿constå’Œreverseè¿­ä»£å™¨ã€‚ ","date":"2023-08-17","objectID":"/posts/clause_27/:2:0","tags":["Effective STL"],"title":"Effective STL [27] | ç”¨distanceå’ŒadvanceæŠŠconst_iteratorè½¬åŒ–æˆiterator","uri":"/posts/clause_27/"},{"categories":["C++"],"content":"4ç§è¿­ä»£å™¨ æ¯ä¸ªæ ‡å‡†å®¹å™¨ç±»éƒ½æä¾›4ç§è¿­ä»£å™¨ç±»å‹:iterator,const_iteratorï¼Œreverse_iteratorå’Œconst_reverse_iterator å¯¹äºcontainer\u003cT\u003eè€Œè¨€ï¼Œiteratorçš„ä½œç”¨ç›¸å½“äºT*ï¼Œè€Œconst_iteratoråˆ™ç›¸å½“äºconst T*ã€‚ å¢åŠ ä¸€ä¸ªiteratoræˆ–è€…const_iteratorå¯ä»¥åœ¨ä¸€ä¸ªä»å®¹å™¨å¼€å¤´è¶‹å‘å°¾éƒ¨çš„éå†ä¸­è®©ä½ ç§»åŠ¨åˆ°å®¹å™¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚ reverse_iteratorä¸const_reverse_iteratoråŒæ ·ç›¸å½“äºå¯¹åº”çš„Tå’Œconst Tï¼Œæ‰€ä¸åŒçš„æ˜¯ï¼Œå¢åŠ reverse_iteratoræˆ–è€…const_reverse_iteratorä¼šåœ¨ä»å°¾åˆ°å¤´çš„éå†ä¸­è®©ä½ ç§»åŠ¨åˆ°å®¹å™¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚ ","date":"2023-08-16","objectID":"/posts/clause_26/:1:0","tags":["Effective STL"],"title":"Effective STL [26] | å°½é‡ç”¨iteratorä»£æ›¿const_iteratorï¼Œreverse_iteratorå’Œconst_reverse_iterator","uri":"/posts/clause_26/"},{"categories":["C++"],"content":"vectorçš„insertå’Œeraseçš„æ ·å¼ iterator insert(iterator position, const T\u0026 x); iterator erase(iterator position); iterator erase(iterator rangeBegin, iterator rangeEnd); è¿™äº›æ–¹æ³•åªæ¥å—iteratorç±»å‹çš„å‚æ•°ï¼Œè€Œä¸æ˜¯const_iteratorã€reverse_iteratoræˆ–const_reverse_iteratorã€‚æ€»æ˜¯iteratorã€‚ ","date":"2023-08-16","objectID":"/posts/clause_26/:2:0","tags":["Effective STL"],"title":"Effective STL [26] | å°½é‡ç”¨iteratorä»£æ›¿const_iteratorï¼Œreverse_iteratorå’Œconst_reverse_iterator","uri":"/posts/clause_26/"},{"categories":["C++"],"content":"è¿­ä»£å™¨ä¹‹é—´å­˜åœ¨çš„è½¬æ¢å…³ç³» å›¾ä¸­æ˜¾ç¤ºäº†ä»iteratoråˆ°const_iteratorã€ä»iteratoråˆ°reverse_iteratorå’Œä»reverse_iteratoråˆ°const_reverse_iteratorå¯ä»¥è¿›è¡Œéšå¼è½¬æ¢ã€‚ å¹¶ä¸”ï¼Œreverse_iteratorå¯ä»¥é€šè¿‡è°ƒç”¨å…¶baseæˆå‘˜å‡½æ•°è½¬æ¢ä¸ºiteratorã€‚const_reverse_iteratorä¹Ÿå¯ä»¥ç±»ä¼¼åœ°é€šè¿‡baseè½¬æ¢æˆä¸ºconst_iteratorã€‚ é€šè¿‡baseå¾—åˆ°çš„ä¹Ÿè®¸å¹¶éä½ æ‰€æœŸå¾…çš„iteratorã€‚ è€Œä¸”ï¼Œæ²¡æœ‰åŠæ³•ä»ä¸€ä¸ªconst_iteratorè½¬æ¢å¾—åˆ°ä¸€ä¸ªiteratorï¼Œä¹Ÿæ— æ³•ä»const_reverse_iteratorå¾—åˆ°reverse_iteratorã€‚ æ‰€ä»¥ï¼Œå½“ä½ éœ€è¦æŒ‡å‡ºæ’å…¥ä½ç½®æˆ–åˆ é™¤çš„å…ƒç´ æ—¶ï¼Œconstè¿­ä»£å™¨å‡ ä¹æ²¡æœ‰ç”¨ã€‚ ","date":"2023-08-16","objectID":"/posts/clause_26/:3:0","tags":["Effective STL"],"title":"Effective STL [26] | å°½é‡ç”¨iteratorä»£æ›¿const_iteratorï¼Œreverse_iteratorå’Œconst_reverse_iterator","uri":"/posts/clause_26/"},{"categories":["C++"],"content":"å°½é‡ä½¿ç”¨iteratorå–ä»£constæˆ–è€…reverseç±»å‹çš„è¿­ä»£å™¨ insertå’Œeraseçš„ä¸€äº›ç‰ˆæœ¬è¦æ±‚iteratorã€‚å¦‚æœä½ éœ€è¦è°ƒç”¨è¿™äº›å‡½æ•°ï¼Œä½ å°±å¿…é¡»äº§ç”Ÿiteratorï¼Œè€Œä¸èƒ½ç”¨constæˆ–reverse iteratorsã€‚ ä¸å¯èƒ½æŠŠconst_iteratoréšå¼è½¬æ¢æˆiteratorã€‚ä»ä¸€ä¸ªconst_iteratoräº§ç”Ÿä¸€ä¸ªiteratorçš„æŠ€æœ¯å¹¶ä¸æ™®éé€‚ç”¨ï¼Œè€Œä¸”ä¸ä¿è¯é«˜æ•ˆã€‚ ä»reverse_iteratorè½¬æ¢è€Œæ¥çš„iteratoråœ¨è½¬æ¢ä¹‹åå¯èƒ½éœ€è¦ç›¸åº”çš„è°ƒæ•´ã€‚ iteratorä¸reverse_iteratorä¹‹é—´çš„é€‰æ‹©æ˜¾è€Œæ˜“è§â€”â€”ä¾èµ–äºä»å‰åˆ°åæˆ–ä»ååˆ°å‰çš„éå†ã€‚ è¿­ä»£å™¨æ¯”è¾ƒ å½“åœ¨iteratorå’Œconst_iteratorä¹‹é—´ä½œé€‰æ‹©çš„æ—¶å€™ï¼Œä½ æœ‰æ›´å……åˆ†çš„ç†ç”±é€‰æ‹©iteratorï¼Œå³ä½¿const_iteratoråŒæ ·å¯è¡Œè€Œä¸”å³ä½¿ä½ å¹¶ä¸éœ€è¦è°ƒç”¨å®¹å™¨ç±»çš„ä»»ä½•æˆå‘˜å‡½æ•°ã€‚å…¶ä¸­çš„ä»¤äººè®¨åŒçš„åŸå› åŒ…æ‹¬iteratorä¸const_iteratorä¹‹é—´çš„æ¯”è¾ƒï¼š typedef deque\u003cint\u003e IntDeque; // typedefå¯ä»¥æå¤§åœ°ç®€åŒ–STLå®¹å™¨ç±»å’Œiteratorçš„æ“ä½œã€‚ typedef IntDeque::iterator Iter; typedef IntDeque::const_iterator ConstIter; Iter i; ConstIter ci; ... // åŒä¸€ä¸ªå®¹å™¨ if (i == ci) ... // æ¯”è¾ƒiteratorå’Œconst_iterator å”¯ä¸€çš„å˜åŒ–æ˜¯ç­‰å·çš„ä¸€è¾¹çš„ç±»å‹æ˜¯iteratorï¼Œè€Œå¦ä¸€è¾¹çš„ç±»å‹æ˜¯const_iteratorã€‚ å› ä¸ºiteratoråº”è¯¥åœ¨æ¯”è¾ƒä¹‹å‰éšå¼çš„è½¬æ¢æˆconst_iteratorï¼ŒçœŸæ­£çš„æ¯”è¾ƒåº”è¯¥åœ¨ä¸¤ä¸ªconst_iteratorä¹‹é—´è¿›è¡Œã€‚ å¦‚æœä¸€äº›å®ç°å°†const_iteratorçš„operator==ä½œä¸ºconst_iteratorçš„ä¸€ä¸ªæˆå‘˜å‡½æ•°è€Œä¸æ˜¯éæˆå‘˜å‡½æ•°ã€‚ è€Œé—®é¢˜çš„è§£å†³ä¹‹é“æ˜¾å¾—éå¸¸æœ‰è¶£ï¼šåªè¦åƒè¿™æ ·äº¤æ¢ä¸¤ä¸ªiteratorçš„ä½ç½®ï¼š if (ci == i)... // å½“ä¸Šé¢æ¯”è¾ƒæ— æ³•é€šè¿‡ç¼–è¯‘æ—¶çš„è§£å†³æ–¹æ³• è¿­ä»£å™¨æ··ç”¨ ä¸ä»…æ˜¯æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ï¼Œåªè¦ä½ åœ¨åŒä¸€ä¸ªè¡¨è¾¾å¼ä¸­æ··ç”¨iteratorå’Œconst_iteratorï¼ˆæˆ–è€…reverse_iteratorå’Œconst_reverse_iteratorï¼‰ï¼Œè¿™æ ·çš„é—®é¢˜å°±å¯èƒ½ä¼šå‡ºç°: if (i - ci \u003e= 3) ... // å¦‚æœiä¸ciä¹‹é—´è‡³å°‘æœ‰ä¸‰ä¸ªå…ƒç´ ... å¦‚æœè¿­ä»£å™¨çš„ç±»å‹ä¸åŒï¼Œä½ çš„æ­£ç¡®çš„ä»£ç å¯èƒ½ä¼šè¢«é”™è¯¯åœ°æ‹’ç»ã€‚ æœ¬ä¾‹ä¸­æœ€ç®€å•çš„è§£å†³æ–¹æ³•æ˜¯é€šè¿‡ä¸€ä¸ªï¼ˆå®‰å…¨çš„ï¼‰æ˜ å°„æŠŠiteratorè½¬æ¢ä¸ºconst_iterator: if (static_cast\u003cConstIter\u003e(i) - ci \u003e= 3) ... // å½“ä¸Šé¢çš„ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘æ—¶çš„è§£å†³æ–¹æ³• é¿å…è¿™ç±»é—®é¢˜çš„æœ€ç®€å•çš„æ–¹æ³•æ˜¯å‡å°‘æ··ç”¨ä¸åŒç±»å‹çš„è¿­ä»£å™¨çš„æœºä¼šã€‚ ","date":"2023-08-16","objectID":"/posts/clause_26/:4:0","tags":["Effective STL"],"title":"Effective STL [26] | å°½é‡ç”¨iteratorä»£æ›¿const_iteratorï¼Œreverse_iteratorå’Œconst_reverse_iterator","uri":"/posts/clause_26/"},{"categories":["C++"],"content":"STLæ²¡æœ‰æ•£åˆ—è¡¨ã€‚ å…¼å®¹STLçš„æ•£åˆ—å…³è”å®¹å™¨å¯ä»¥ä»å¤šä¸ªæ¥æºè·å¾—ï¼Œè€Œä¸”å®ƒä»¬ç”šè‡³æœ‰äº‹å®ä¸Šçš„æ ‡å‡†åå­—ï¼šhash_setã€hash_multisetã€hash_mapå’Œhash_multimapã€‚åœ¨C++æ ‡å‡†å§”å‘˜ä¼šçš„è®®æ¡ˆä¸­ï¼Œæ•£åˆ—å®¹å™¨çš„åå­—æ˜¯unordered_setã€ unordered_multisetã€unordered_mapå’Œunordered_multimapã€‚ å®ƒä»¬åœ¨æ¥å£ã€èƒ½åŠ›ã€å†…åœ¨æ•°æ®ç»“æ„å’Œæ”¯æŒæ“ä½œçš„ç›¸å…³æ•ˆç‡æ–¹é¢ä¸åŒã€‚ æœ€å¸¸è§çš„ä¸¤ä¸ªæ¥è‡ªSGIå’ŒDinkumwareï¼ŒSTLportä¹Ÿæä¾›æ•£åˆ—å®¹å™¨ï¼Œä½†æ˜¯STLportçš„æ•£åˆ—å®¹å™¨æ˜¯åŸºäºæ¥è‡ªSGIçš„ã€‚ æ•£åˆ—å®¹å™¨æ˜¯å…³è”å®¹å™¨ï¼Œå®ƒä»¬éœ€è¦çŸ¥é“å‚¨å­˜åœ¨å®¹å™¨ä¸­çš„å¯¹è±¡ç±»å‹ï¼Œç”¨äºè¿™äº›å¯¹è±¡çš„æ¯”è¾ƒå‡½æ•°ï¼Œä»¥åŠç”¨äºè¿™äº›å¯¹è±¡çš„åˆ†é…å™¨ã€‚ ","date":"2023-08-16","objectID":"/posts/clause_25/:0:0","tags":["Effective STL"],"title":"Effective STL [25] | ç†Ÿæ‚‰éæ ‡å‡†æ•£åˆ—å®¹å™¨","uri":"/posts/clause_25/"},{"categories":["C++"],"content":"æ•£åˆ—å®¹å™¨å£°æ˜ æ•£åˆ—å®¹å™¨éœ€è¦æ•£åˆ—å‡½æ•°çš„è¯´æ˜ã€‚ä¸‹é¢æ˜¯æ•£åˆ—å®¹å™¨å£°æ˜ï¼š template\u003ctypename T, typename HashFunction, typename CompareFunction, typename Allocator = allocator\u003cT\u003e \u003e class hash_container; è¿™éå¸¸æ¥è¿‘äºæ•£åˆ—å®¹å™¨çš„SGIå£°æ˜ï¼Œä¸»è¦å·®åˆ«æ˜¯SGIä¸ºHashFunctionå’ŒCompareFunctionæä¾›äº†é»˜è®¤ç±»å‹ã€‚ SGI è®¾è®¡ä¸¾ä¾‹ hash_setçš„SGIå£°æ˜çœ‹èµ·æ¥åŸºæœ¬ä¸Šåƒè¿™æ ·ï¼š template\u003ctypename T, typename HashFunction = hash\u003cT\u003e, typename CompareFunction = equa_to\u003cT\u003e, typename Allocator = allocator\u003cT\u003e \u003e class hash_set; SGIè®¾è®¡çš„ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æ–¹é¢æ˜¯ä½¿ç”¨equal_toä½œä¸ºé»˜è®¤æ¯”è¾ƒå‡½æ•°ã€‚è¿™è¿èƒŒæ ‡å‡†å…³è”å®¹å™¨çš„çº¦å®šâ€”â€”é»˜è®¤æ¯”è¾ƒå‡½æ•°æ˜¯lessã€‚ SGIçš„æ•£åˆ—å®¹å™¨ç¡®å®šåœ¨ä¸€ä¸ªæ•£åˆ—å®¹å™¨ä¸­çš„ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦æœ‰ç›¸åŒçš„å€¼æ˜¯é€šè¿‡ç›¸ç­‰æµ‹è¯•ï¼Œè€Œä¸æ˜¯ç­‰ä»·ã€‚ å› ä¸ºæ•£åˆ—å…³è”å®¹å™¨ï¼Œä¸åƒå®ƒä»¬åœ¨æ ‡å‡†ä¸­çš„ï¼ˆé€šå¸¸åŸºäºæ ‘ï¼‰å…„å¼Ÿï¼Œä¸éœ€è¦ä¿æŒæœ‰åºã€‚ Dinkumware è®¾è®¡ä¸¾ä¾‹ Dinkumwareè®¾è®¡çš„æ•£åˆ—å®¹å™¨é‡‡å–ä¸€äº›ä¸åŒçš„ç­–ç•¥ã€‚å®ƒä»ç„¶å…è®¸ä½ æŒ‡å®šå¯¹è±¡ç±»å‹ã€æ•£åˆ—å‡½æ•°ç±»å‹ã€æ¯”è¾ƒå‡½æ•°ç±»å‹å’Œåˆ†é…å™¨ç±»å‹ï¼Œä½†æ˜¯å®ƒæŠŠé»˜è®¤çš„æ•£åˆ—å’Œæ¯”è¾ƒå‡½æ•°ç§»è¿›ä¸€ä¸ªå•ç‹¬çš„ç±»ä¼¼ç‰¹æ€§çš„å«åšhash_compareçš„ç±»ï¼Œè€Œä¸”å®ƒæŠŠhash_compareä½œä¸ºå®¹å™¨æ¨¡æ¿çš„HashingInfoå®å‚çš„é»˜è®¤å€¼ã€‚ è¿™æ˜¯Dinkumwareçš„hash_setå£°æ˜ï¼ˆå†æ¬¡ä¸ºæ¼”ç¤ºè€Œè°ƒæ•´è¿‡ï¼‰: template\u003ctypename T, typename CompareFunction\u003e class hash_compare; template\u003ctypename T, typename HashingInfo = hash_compare\u003cT, less\u003cT\u003e \u003e typename Allocator = allocator\u003cT\u003e \u003e class hash_set; è¿™ç§æ¥å£è®¾è®¡æœ‰è¶£çš„åœ°æ–¹æ˜¯HashingInfoçš„ä½¿ç”¨ã€‚ å®¹å™¨çš„æ•£åˆ—å’Œæ¯”è¾ƒå‡½æ•°å‚¨å­˜åœ¨HashingInfoä¸­ï¼Œä½†HashingInfoç±»å‹ä¹Ÿå®¹çº³äº†æ§åˆ¶è¡¨ä¸­æ¡¶ï¼ˆbucketï¼‰æœ€å°æ•°é‡ï¼Œä»¥åŠå®¹å™¨å…ƒç´ å¯¹æ¡¶çš„æœ€å¤§å…è®¸æ¯”ç‡çš„æšä¸¾ã€‚ å½“è¿™æ¯”ç‡è¢«è¶…è¿‡æ—¶ï¼Œè¡¨ä¸­æ¡¶çš„æ•°é‡å°±å¢åŠ ï¼Œè€Œè¡¨ä¸­çš„ä¸€äº›å…ƒç´ éœ€è¦é‡æ–°æ•£åˆ—ã€‚ï¼ˆSGIæä¾›å…·æœ‰ç±»ä¼¼æ§åˆ¶è¡¨ä¸­æ¡¶å’Œè¡¨ä¸­å…ƒç´ å¯¹æ¡¶æ¯”ç‡çš„æˆå‘˜å‡½æ•°ã€‚ï¼‰ hash_compare hash_compareï¼ˆHashingInfoçš„é»˜è®¤å€¼ï¼‰çœ‹èµ·æ¥æˆ–å¤šæˆ–å°‘åƒè¿™æ ·: template\u003ctypename T, typename CompareFunction = less\u003cT\u003e \u003e class hash_compare { public: enum { bucket_size = 4, // å…ƒç´ å¯¹æ¡¶çš„æœ€å¤§æ¯”ç‡ min_buckets = 8 // æ¡¶çš„æœ€å°æ•°é‡ }; size_t operator()(const T\u0026) const; // æ•£åˆ—å‡½æ•°æ¯”è¾ƒå‡½æ•° bool operator()(const T\u0026, const T\u0026) const; ... // å¿½ç•¥ä¸€äº›ä¸œè¥¿ï¼ŒåŒ…æ‹¬ CompareFunctionçš„ä½¿ç”¨ } é‡è½½operator()ï¼ˆåœ¨è¿™é‡Œæ˜¯å®ç°æ•£åˆ—å’Œæ¯”è¾ƒå‡½æ•°ï¼‰æ˜¯æ¯”ä½ å¯ä»¥æƒ³è±¡çš„æ›´ç»å¸¸å‡ºç°çš„ä¸€ä¸ªç­–ç•¥ã€‚ Dinkumwareè®¾è®¡å…è®¸ä½ å†™ä½ è‡ªå·±çš„ç±»ä¼¼hash_compareçš„ç±»ï¼ˆä¹Ÿè®¸é€šè¿‡ä»hash_compareæœ¬èº«æ´¾ç”Ÿè€Œæ¥ï¼‰ï¼Œè€Œä¸”åªè¦ä½ çš„ç±»å®šä¹‰äº†bucket_sizeã€min_bucketsã€ä¸¤ä¸ªoperator()å‡½æ•°ï¼ˆä¸€ä¸ªå¸¦æœ‰ä¸€ä¸ªå®å‚ï¼Œä¸€ä¸ªå¸¦æœ‰ä¸¤ä¸ªï¼‰ï¼ŒåŠ ä¸Šå·²ç»çœå»çš„ä¸€äº›ä¸œè¥¿ï¼Œå°±èƒ½ä½¿ç”¨å®ƒæ¥æ§åˆ¶Dinkumwareçš„hash_setæˆ–hash_multisetçš„é…ç½®å’Œè¡Œä¸ºã€‚ hash_mapå’Œhash_multimapçš„é…ç½®æ§åˆ¶ä¹Ÿç›¸ä¼¼ã€‚ ","date":"2023-08-16","objectID":"/posts/clause_25/:1:0","tags":["Effective STL"],"title":"Effective STL [25] | ç†Ÿæ‚‰éæ ‡å‡†æ•£åˆ—å®¹å™¨","uri":"/posts/clause_25/"},{"categories":["C++"],"content":"å†³ç­–ç•™ç»™å®ç° æ³¨æ„ä¸ç®¡æ˜¯SGIè¿˜æ˜¯Dinkumwareçš„è®¾è®¡ï¼Œä½ éƒ½èƒ½æŠŠå…¨éƒ¨å†³ç­–ç•™ç»™å®ç°: // å»ºç«‹ä¸€ä¸ªintçš„æ•£åˆ—è¡¨ hash_set\u003cint\u003e intTable; è¦è®©è¿™ä¸ªå¯ä»¥ç¼–è¯‘ï¼Œæ•£åˆ—è¡¨å¿…é¡»å®¹çº³ä¸€ä¸ªæ•´æ•°ç±»å‹ï¼ˆä¾‹å¦‚intï¼‰ï¼Œå› ä¸ºé»˜è®¤æ•£åˆ—å‡½æ•°ä¸€èˆ¬å±€é™äºæ•´æ•°ç±»å‹ã€‚ å®ç°æ–¹æ³•ä¸åŒ åœ¨åç«¯ï¼ŒSGIå’ŒDinkumwareçš„å®ç°æ–¹æ³•éå¸¸ä¸åŒã€‚ SGIåˆ©ç”¨å¸¸ç”¨çš„ä¸€ä¸ªå…ƒç´ çš„å•é“¾è¡¨çš„æŒ‡é’ˆæ•°ç»„ï¼ˆæ¡¶ï¼‰ç»„æˆçš„å¼€æ”¾æ•£åˆ—æ³•ã€‚ Dinkumwareä¹Ÿåˆ©ç”¨äº†å¼€æ”¾æ•£åˆ—æ³•ï¼Œä½†æ˜¯å®ƒçš„è®¾è®¡æ˜¯åŸºäºä¸€ç§æ–°é¢–çš„æ•°æ®ç»“æ„â€”â€”ç”±è¿­ä»£å™¨ï¼ˆæœ¬è´¨æ˜¯æ¡¶ï¼‰çš„æ•°ç»„ç»„æˆçš„å…ƒç´ åŒå‘é“¾è¡¨ï¼Œè¿­ä»£å™¨çš„ç›¸é‚»å¯¹è¡¨ç¤ºåœ¨æ¯ä¸ªæ¡¶é‡Œå…ƒç´ çš„èŒƒå›´ã€‚ é“¾è¡¨ä¸åŒ SGIå®ç°åœ¨å•é“¾è¡¨ä¸­å‚¨å­˜è¡¨çš„å…ƒç´  Dinkumwareå®ç°ä½¿ç”¨ä¸€ä¸ªåŒå‘é“¾è¡¨ è¿­ä»£å™¨ç§ç±»ä¸åŒ SGIçš„æ•£åˆ—å®¹å™¨æä¾›äº†å‰å‘è¿­ä»£å™¨ï¼Œå› æ­¤ä½ å¾—æ”¾å¼ƒè¿›è¡Œåå‘è¿­ä»£çš„èƒ½åŠ›ï¼šåœ¨SGIçš„æ•£åˆ—å®¹å™¨ä¸­æ²¡æœ‰rbeginæˆ–è€…rendæˆå‘˜å‡½æ•°ã€‚ ç”¨äºDinkumwareæ•£åˆ—å®¹å™¨çš„è¿­ä»£å™¨æ˜¯åŒå‘çš„ï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥æä¾›å‰å‘å’Œåå‘éå†ã€‚ å†…å­˜ä½¿ç”¨é‡æ–¹é¢ä¸åŒ SGIçš„è®¾è®¡æ¯”Dinkumwareçš„èŠ‚ä¿­ä¸€ç‚¹ç‚¹ã€‚ ","date":"2023-08-16","objectID":"/posts/clause_25/:2:0","tags":["Effective STL"],"title":"Effective STL [25] | ç†Ÿæ‚‰éæ ‡å‡†æ•£åˆ—å®¹å™¨","uri":"/posts/clause_25/"},{"categories":["C++"],"content":"ç»“è®º è™½ç„¶STLæœ¬èº«ç¼ºä¹æ•£åˆ—å®¹å™¨ï¼Œå…¼å®¹STLçš„æ•£åˆ—å®¹å™¨ï¼ˆæœ‰ä¸åŒçš„æ¥å£ã€èƒ½åŠ›å’Œè¡Œä¸ºæƒè¡¡ï¼‰ä¸éš¾å¾—åˆ°ã€‚å°±SGIå’ŒSTLportçš„å®ç°è€Œè¨€ï¼Œä½ ç”šè‡³å¯ä»¥å…è´¹ä¸‹è½½å¾—åˆ°å®ƒä»¬ã€‚ ","date":"2023-08-16","objectID":"/posts/clause_25/:3:0","tags":["Effective STL"],"title":"Effective STL [25] | ç†Ÿæ‚‰éæ ‡å‡†æ•£åˆ—å®¹å™¨","uri":"/posts/clause_25/"},{"categories":["C++"],"content":"Example mapæ’å…¥ å‡è®¾æœ‰ä¸€ä¸ªæ”¯æŒé»˜è®¤æ„é€ å‡½æ•°ä»¥åŠä»ä¸€ä¸ªdoubleæ„é€ å’Œèµ‹å€¼çš„Widgetç±»: class Widget { public: Widget(); Widget(double weight); Widget\u0026 operator=(double weight); ... } å‡è®¾æˆ‘ä»¬æƒ³å»ºç«‹ä¸€ä¸ªä»intåˆ°Widgetçš„mapï¼Œè€Œä¸”æˆ‘ä»¬æƒ³æœ‰åˆå§‹åŒ–æœ‰ç‰¹å®šå€¼çš„æ˜ å°„: map\u003cint, Widget\u003e m; m[1] = 1.50; m[2] = 3.67; m[3] = 10.5; m[4] = 45.8; m[5] = 0.0003; map operator[] å·¥ä½œåŸç† mapçš„operator[]å‡½æ•°æ˜¯ä¸ªå¥‡æ€ªçš„ä¸œè¥¿ã€‚å®ƒä¸vectorã€dequeå’Œstringçš„operator[]å‡½æ•°æ— å…³ï¼Œä¹Ÿå’Œå†…å»ºçš„æ•°ç»„operator[]æ— å…³ã€‚ map::operator[]è¢«è®¾è®¡ä¸ºç®€åŒ–â€œæ·»åŠ æˆ–æ›´æ–°â€åŠŸèƒ½ã€‚å³ï¼Œç»™å®šmap\u003cK, V\u003e m;è¿™ä¸ªè¡¨è¾¾å¼ m[k] = v; æ£€æŸ¥é”®kæ˜¯å¦å·²ç»åœ¨mapé‡Œã€‚å¦‚æœä¸ï¼Œå°±æ·»åŠ ä¸Šï¼Œä»¥vä½œä¸ºå®ƒçš„å¯¹åº”å€¼ã€‚å¦‚æœkå·²ç»åœ¨mapé‡Œï¼Œå®ƒçš„å…³è”å€¼è¢«æ›´æ–°æˆvã€‚ è¿™é¡¹å·¥ä½œçš„åŸç†æ˜¯operator[]è¿”å›ä¸€ä¸ªä¸kå…³è”çš„å€¼å¯¹è±¡çš„å¼•ç”¨ã€‚ç„¶åvèµ‹å€¼ç»™æ‰€å¼•ç”¨ï¼ˆä»operator[]è¿”å›çš„ï¼‰çš„å¯¹è±¡ã€‚ å½“è¦æ›´æ–°ä¸€ä¸ªå·²å­˜åœ¨çš„é”®çš„å…³è”å€¼æ—¶å¾ˆç›´æ¥ï¼Œå› ä¸ºå·²ç»æœ‰operator[]å¯ä»¥ç”¨æ¥è¿”å›å¼•ç”¨çš„å€¼å¯¹è±¡ã€‚ ä½†æ˜¯å¦‚æœkè¿˜ä¸åœ¨mapé‡Œï¼Œoperator[]å°±æ²¡æœ‰å¯ä»¥å¼•ç”¨çš„å€¼å¯¹è±¡ã€‚é‚£æ ·çš„è¯ï¼Œå®ƒä½¿ç”¨å€¼ç±»å‹çš„é»˜è®¤æ„é€ å‡½æ•°ä»å¤´å¼€å§‹å»ºç«‹ä¸€ä¸ªï¼Œç„¶åoperator[]è¿”å›è¿™ä¸ªæ–°å»ºç«‹å¯¹è±¡çš„å¼•ç”¨ã€‚ è®©æˆ‘ä»¬å†æ¬¡åœ°çœ‹çœ‹åŸå…ˆä¾‹å­çš„ç¬¬ä¸€éƒ¨åˆ†ï¼š map\u003cint, Widget\u003e m; m[1] = 1.50; è¡¨è¾¾å¼m[1]æ˜¯m.operator[](1)çš„ç®€åŒ–ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªmap::operator[]çš„è°ƒç”¨ã€‚ è¿™ä¸ªå‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªWidgetçš„å¼•ç”¨ï¼Œå› ä¸ºm çš„æ˜ å°„ç±»å‹æ˜¯Widgetã€‚ åœ¨è¿™é‡Œï¼Œmé‡Œé¢è¿˜æ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥é”®1åœ¨mapé‡Œæ²¡æœ‰å…¥å£ã€‚å› æ­¤operator[]é»˜è®¤æ„é€ ä¸€ä¸ªWidgetæ¥ä½œä¸ºå…³è”åˆ°1çš„å€¼ï¼Œç„¶åè¿”å›åˆ°é‚£ä¸ªWidgetçš„å¼•ç”¨ã€‚ æœ€åï¼ŒWidgetæˆä¸ºèµ‹å€¼ç›®æ ‡ï¼šè¢«èµ‹å€¼çš„å€¼æ˜¯1.50ã€‚ æ‰€ä»¥ï¼Œä¸‹é¢è¿™ä¸ªè¯­å¥ m[1] = 1.50; åŠŸèƒ½ä¸Šç­‰ä»·äºè¿™ä¸ª: // æ–¹ä¾¿çš„ typedef typedef map\u003cint, Widget\u003e IntWidgetMap; // ç”¨é”®1å»ºç«‹æ–°æ˜ å°„å…¥å£å’Œä¸€ä¸ªé»˜è®¤æ„é€ çš„å€¼å¯¹è±¡ï¼› pair\u003cIntWidgetMap::iterator, bool\u003e result = m.insert(IntWidgetMap::value_type(1, Widget())); // èµ‹å€¼ç»™å€¼ç±»å‹ result.first-\u003esecond = 1.50; ç°åœ¨å·²ç»å¾ˆæ¸…æ¥šä¸ºä»€ä¹ˆè¿™ç§æ–¹æ³•å¯èƒ½é™ä½æ€§èƒ½äº†ï¼šå…ˆé»˜è®¤æ„é€ ä¸€ä¸ªWidgetï¼Œç„¶åæˆ‘ä»¬ç«‹å³èµ‹ç»™å®ƒæ–°å€¼ã€‚ map insertæ›´é«˜æ•ˆ å¦‚æœç”¨æƒ³è¦çš„å€¼æ„é€ Widgetæ¯”é»˜è®¤æ„é€ Widgetç„¶åè¿›è¡Œèµ‹å€¼æ˜¾ç„¶æ›´é«˜æ•ˆï¼Œå°±åº”è¯¥ç”¨ç›´æˆªäº†å½“çš„insertè°ƒç”¨æ¥æ›¿æ¢operator[]çš„ä½¿ç”¨ï¼ˆåŒ…æ‹¬å®ƒçš„æ„é€ åŠ èµ‹å€¼ï¼‰: m.insert(IntWidgetMap::value_type(1, 1.50)); è¿™ä¸ä¸Šé¢çš„é‚£äº›ä»£ç æœ‰ç›¸åŒçš„æœ€ç»ˆæ•ˆæœï¼Œé™¤äº†å®ƒé€šå¸¸èŠ‚çœäº†3æ¬¡å‡½æ•°è°ƒç”¨ï¼š ä¸€ä¸ªå»ºç«‹ä¸´æ—¶çš„é»˜è®¤æ„é€ Widgetå¯¹è±¡ ä¸€ä¸ªé”€æ¯é‚£ä¸ªä¸´æ—¶çš„å¯¹è±¡ ä¸€ä¸ªå¯¹Widgetçš„èµ‹å€¼æ“ä½œã€‚ è¿™äº›å‡½æ•°è°ƒç”¨è¶Šæ˜‚è´µï¼Œä½ é€šè¿‡ä½¿ç”¨map-insertä»£æ›¿map::operator[]å°±èƒ½èŠ‚çœè¶Šå¤šã€‚ ä¸Šé¢çš„ä»£ç åˆ©ç”¨äº†æ¯ä¸ªæ ‡å‡†å®¹å™¨éƒ½æä¾›çš„value_type typedefã€‚è¿™typedefæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«é‡è¦çš„ï¼Œä½†å¯¹äºmapå’Œmultimapï¼ˆä»¥åŠéæ ‡å‡†å®¹å™¨çš„hash_mapå’Œhash_multimapâ€”â€”å‚è§æ¡æ¬¾25ï¼‰ï¼Œè®°ä½å®ƒæ˜¯å¾ˆé‡è¦çš„ï¼Œå®¹å™¨å…ƒç´ çš„ç±»å‹æ€»æ˜¯æŸç§pairã€‚ ä¹‹å‰è°ˆåŠçš„operator[]è¢«è®¾è®¡ä¸ºç®€åŒ–â€œæ·»åŠ æˆ–æ›´æ–°â€åŠŸèƒ½ï¼Œè€Œä¸”ç°åœ¨æˆ‘ä»¬ç†è§£äº†å½“â€œå¢åŠ â€è¢«æ‰§è¡Œæ—¶ï¼Œinsertæ¯”operator[]æ›´é«˜æ•ˆã€‚å½“åšæ›´æ–°æ—¶ï¼Œæƒ…å½¢æ­£å¥½ç›¸åï¼Œä¹Ÿå°±æ˜¯ï¼Œå½“ä¸€ä¸ªç­‰ä»·çš„é”®è¿™å·²ç»åœ¨mapé‡Œæ—¶ã€‚ // ä½¿ç”¨operator[]æ¥æŠŠkçš„å€¼æ›´æ–°ä¸ºv m[k] = v; // æ¥æŠŠkçš„å€¼æ›´æ–°ä¸ºvä½¿ç”¨insert m.insert(IntWidgetMap::value_type(k, v)).first-\u003esecond = v; ","date":"2023-08-15","objectID":"/posts/clause_24/:1:0","tags":["Effective STL"],"title":"Effective STL [24] | å½“å…³ä¹æ•ˆç‡æ—¶åº”è¯¥åœ¨map::operator[]å’Œmap-insertä¹‹é—´ä»”ç»†é€‰æ‹©","uri":"/posts/clause_24/"},{"categories":["C++"],"content":"operator[] ä¸ insert æƒè¡¡ insertçš„è°ƒç”¨éœ€è¦IntWidgetMap::value_typeç±»å‹çš„å®å‚ï¼ˆå³pair\u003cint, Widget\u003eï¼‰ï¼Œæ‰€ä»¥å½“è°ƒç”¨insertæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ„é€ å’Œææ„ä¸€ä¸ªé‚£ç§ç±»å‹çš„å¯¹è±¡ã€‚é‚£è€—è´¹äº†ä¸€å¯¹æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ï¼Œä¹Ÿä¼šé€ æˆä¸€ä¸ªWidgetçš„æ„é€ å’Œææ„ï¼Œå› ä¸ºpair\u003cint, Widget\u003eæœ¬èº«åŒ…å«äº†ä¸€ä¸ªWidgetå¯¹è±¡ï¼Œoperator[]æ²¡æœ‰ä½¿ç”¨pairå¯¹è±¡ï¼Œæ‰€ä»¥æ²¡æœ‰æ„é€ å’Œææ„pairå’ŒWidgetã€‚ Note æƒ…å½¢é€‰æ‹©: å› æ­¤å‡ºäºå¯¹æ•ˆç‡çš„è€ƒè™‘ï¼Œå½“ç»™mapæ·»åŠ ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæˆ‘ä»¬æ–­å®šinsertæ¯”operator[]å¥½ï¼› ä»æ•ˆç‡å’Œç¾å­¦è€ƒè™‘ï¼Œå½“æ›´æ–°å·²ç»åœ¨mapé‡Œçš„å…ƒç´ å€¼æ—¶operator[]æ›´å¥½ã€‚ å¦‚æœSTLæä¾›ä¸€ä¸ªä¸¤å…¨å…¶ç¾çš„å‡½æ•°ï¼Œå³ï¼Œåœ¨å¥æ³•ä¸Šå¸å¼•äººçš„åŒ…ä¸­çš„é«˜æ•ˆçš„â€œæ·»åŠ æˆ–æ›´æ–°â€åŠŸèƒ½: // å¦‚æœé”®kä¸å†map mä¸­ï¼›é«˜æ•ˆåœ°æŠŠpair(k, v)æ·»åŠ åˆ°mä¸­ï¼› // å¦åˆ™é«˜æ•ˆåœ°æŠŠå’Œkå…³è”çš„å€¼æ›´æ–°ä¸ºvã€‚ // è¿”å›ä¸€ä¸ªæŒ‡å‘æ·»åŠ æˆ–ä¿®æ”¹çš„pairçš„è¿­ä»£å™¨ iterator affectedPair = efficientAddOrUpdate(m, k, v); ä½†æ˜¯ï¼Œåœ¨STLå†…æ²¡æœ‰åƒè¿™æ ·çš„å‡½æ•°ï¼Œæ­£å¦‚ä¸‹é¢çš„ä»£ç æ‰€æ¼”ç¤ºçš„ï¼Œè‡ªå·±å†™ä¸€ä¸ªå¹¶ä¸éš¾ã€‚é‚£äº›æ³¨é‡Šæ€»ç»“äº†æ­£åœ¨åšä»€ä¹ˆï¼Œè€Œä¸”éšåçš„æ®µè½ä¹Ÿæä¾›äº†ä¸€äº›é™„åŠ çš„è§£é‡Šã€‚ // mapçš„ç±»å‹KeyArgTypeå’ŒValueArgtypeæ˜¯ç±»å‹å‚æ•°çš„åŸå› è¯·çœ‹ä¸‹é¢ template\u003ctypename MapType, typename KeyArgType, typename ValueArgtype\u003e typename MapType::iterator efficientAddOrUpdate(MapType\u0026 m, const KeyArgType\u0026 k, const ValueArgtype\u0026 v) { // æ‰¾åˆ°kåœ¨æˆ–åº”è¯¥åœ¨å“ªé‡Œï¼› typename MapType::iterator Ib = m.lower_bound(k); // å¦‚æœIbæŒ‡å‘ä¸€ä¸ªpair, å®ƒçš„é”®ç­‰ä»·äºk... if(Ib != m.end() \u0026\u0026 !(m.key_comp()(k, Ib-\u003efirst))) { // æ›´æ–°è¿™ä¸ªpairçš„å€¼ Ib-\u003esecond = v; // å¹¶è¿”å›æŒ‡å‘pairçš„è¿­ä»£å™¨ return Ib; } else{ typedef typename MapType::value_type MVT; // æŠŠpair(k, v)æ·»åŠ åˆ°må¹¶// è¿”å›æŒ‡å‘æ–°mapå…ƒç´ çš„è¿­ä»£å™¨ return m.insert(Ib, MVT(k, v)); } } æ‰§è¡Œä¸€ä¸ªé«˜æ•ˆçš„å¢åŠ æˆ–æ›´æ–°ï¼Œæˆ‘ä»¬éœ€è¦èƒ½æ‰¾å‡ºkçš„å€¼æ˜¯å¦åœ¨mapä¸­; å¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£å®ƒåœ¨å“ªé‡Œ; å¦‚æœä¸æ˜¯ï¼Œå®ƒè¯¥è¢«æ’å…¥å“ªé‡Œã€‚ è¿™ä¸ªå·¥ä½œæ˜¯ä¸ºlow_boundé‡èº«å®šåšçš„ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬è°ƒç”¨é‚£ä¸ªå‡½æ•°ã€‚ç¡®å®šlower_boundæ˜¯å¦ç”¨æˆ‘ä»¬è¦å¯»æ‰¾çš„é”®æ‰¾åˆ°äº†ä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¯¹ååŠéƒ¨åˆ†è¿›è¡Œä¸€ä¸ªç­‰ä»·æµ‹è¯•ï¼Œä¸€å®šè¦å¯¹mapä½¿ç”¨æ­£ç¡®çš„æ¯”è¾ƒå‡½æ•°: é€šè¿‡map::key_compæä¾›çš„æ¯”è¾ƒå‡½æ•°ã€‚ç­‰ä»·æµ‹è¯•çš„ç»“æœå‘Šè¯‰æˆ‘ä»¬åº”è¯¥è¿›è¡Œå¢åŠ è¿˜æ˜¯æ›´æ–°ã€‚ å¦‚æœæ˜¯æ›´æ–°ï¼Œä»£ç å¾ˆç›´æˆªäº†å½“ã€‚æ’å…¥åˆ†æ”¯æ›´æœ‰è¶£ï¼Œå› ä¸ºå®ƒä½¿ç”¨äº†insertçš„â€œæç¤ºâ€å½¢å¼ã€‚ç»“æ„m.insert(Ibï¼ŒMVT(kï¼Œv))â€œæç¤ºâ€äº†**Ibé‰´åˆ«å‡ºäº†é”®ç­‰ä»·äºkçš„æ–°å…ƒç´ æ­£ç¡®çš„æ’å…¥ä½ç½®ï¼Œè€Œä¸”ä¿è¯å¦‚æœæç¤ºæ­£ç¡®ï¼Œé‚£ä¹ˆæ’å…¥å°†åœ¨åˆ†æ‘Šçš„å¸¸æ•°æ—¶é—´å†…å‘ç”Ÿï¼Œè€Œä¸æ˜¯å¯¹æ•°æ—¶é—´**ã€‚åœ¨efficientAddOrUpdateé‡Œï¼Œæˆ‘ä»¬çŸ¥é“Ibé‰´åˆ«å‡ºäº†é€‚å½“çš„æ’å…¥ä½ç½®ï¼Œå› æ­¤insertçš„è°ƒç”¨è¢«ä¿è¯ä¸ºæ˜¯ä¸€æ¬¡å¸¸æ•°æ—¶é—´æ“ä½œã€‚ KeyArgTypeå’ŒValueArgType è¿™ä¸ªå®ç°çš„ä¸€ä¸ªæœ‰è¶£æ–¹é¢æ˜¯KeyArgTypeå’ŒValueArgTypeä¸å¿…æ˜¯å‚¨å­˜åœ¨mapé‡Œçš„ç±»å‹ã€‚å®ƒä»¬åªéœ€è¦å¯ä»¥è½¬æ¢åˆ°å‚¨å­˜åœ¨mapé‡Œçš„ç±»å‹ã€‚ ä¸€ä¸ªå¯é€‰çš„æ–¹æ³•æ˜¯å»æ‰ç±»å‹å‚æ•°KeyArgTypeå’ŒValueArgTypeï¼Œæ”¹ä¸ºä½¿ç”¨MapType::key_typeå’ŒMapType::mapped_typeã€‚ ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬é‚£ä¹ˆåšï¼Œåœ¨è°ƒç”¨æ—¶æˆ‘ä»¬å¯èƒ½å¼ºè¿«å‘ç”Ÿä¸å¿…è¦çš„ç±»å‹è½¬æ¢: map\u003cint, Widget\u003e m; // åˆ«å¿˜äº†Widgetæ¥å—ä»ä¸€ä¸ªdoubleèµ‹å€¼ï¼š class Widget { public: ... Widget\u0026 operator=(double weight); ... }; ç°åœ¨è€ƒè™‘efficientAddOrUpdateçš„è°ƒç”¨: efficientAddOrUpdate(m, 10, 1.5); å‡è®¾æ˜¯ä¸€æ¬¡æ›´æ–°æ“ä½œï¼Œå³ï¼Œmå·²ç»åŒ…å«é”®æ˜¯10çš„å…ƒç´ ã€‚é‚£æ ·çš„è¯ï¼Œä¸Šé¢çš„æ¨¡æ¿æ¨æ–­å‡ºValueArgTypeæ˜¯doubleï¼Œå‡½æ•°ä½“ç›´æ¥æŠŠ1.5ä½œä¸ºdoubleèµ‹ç»™ä¸10ç›¸å…³çš„é‚£ä¸ªWidgetã€‚é‚£æ˜¯é€šè¿‡è°ƒç”¨Widget::operator(double)å®Œæˆçš„ã€‚ å¦‚æœæˆ‘ä»¬ç”¨äº†MapType::mapped_typeä½œä¸ºefficientAddOrUpdateçš„ç¬¬3ä¸ªå‚æ•°çš„ç±»å‹ï¼Œåœ¨è°ƒç”¨æ—¶æˆ‘ä»¬å¾—æŠŠ1.5è½¬åŒ–æˆä¸€ä¸ªWidgetï¼Œé‚£æ ·çš„è¯æˆ‘ä»¬å°±å¾—èŠ±è´¹æœ¬æ¥ä¸éœ€è¦çš„ä¸€æ¬¡Widgetæ„é€ ï¼ˆä»¥åŠéšåçš„ææ„ï¼‰ã€‚ ","date":"2023-08-15","objectID":"/posts/clause_24/:2:0","tags":["Effective STL"],"title":"Effective STL [24] | å½“å…³ä¹æ•ˆç‡æ—¶åº”è¯¥åœ¨map::operator[]å’Œmap-insertä¹‹é—´ä»”ç»†é€‰æ‹©","uri":"/posts/clause_24/"},{"categories":["C++"],"content":"ç»“è®º å½“å…³ä¹æ•ˆç‡æ—¶åº”è¯¥åœ¨map::operator[]å’Œmap-insertä¹‹é—´ä»”ç»†é€‰æ‹©ã€‚ å¦‚æœä½ è¦æ›´æ–°å·²å­˜åœ¨çš„mapå…ƒç´ ï¼Œoperator[]æ›´å¥½ï¼Œä½†å¦‚æœä½ è¦å¢åŠ ä¸€ä¸ªæ–°å…ƒç´ ï¼Œinsertåˆ™æœ‰ä¼˜åŠ¿ã€‚ ","date":"2023-08-15","objectID":"/posts/clause_24/:3:0","tags":["Effective STL"],"title":"Effective STL [24] | å½“å…³ä¹æ•ˆç‡æ—¶åº”è¯¥åœ¨map::operator[]å’Œmap-insertä¹‹é—´ä»”ç»†é€‰æ‹©","uri":"/posts/clause_24/"},{"categories":["C++"],"content":"å½“éœ€è¦ä¸€ä¸ªæä¾›å¿«é€ŸæŸ¥æ‰¾çš„æ•°æ®ç»“æ„æ—¶ï¼Œå¾ˆå¤šSTLç¨‹åºå‘˜ç«‹åˆ»ä¼šæƒ³åˆ°æ ‡å‡†å…³è”å®¹å™¨ï¼šsetã€multisetã€mapå’Œmultimapã€‚ å¦‚æœä½¿ç”¨äº†åˆé€‚çš„æ•£åˆ—å‡½æ•°ï¼Œåˆ™å¯ä»¥è®¤ä¸ºæ•£åˆ—å®¹å™¨æä¾›äº†å¸¸æ•°æ—¶é—´çš„æŸ¥æ‰¾ã€‚ å¯¹äºå¤šæ•°åº”ç”¨ï¼Œè¢«è®¤ä¸ºæ˜¯å¸¸æ•°æ—¶é—´æŸ¥æ‰¾çš„æ•£åˆ—å®¹å™¨è¦å¥½äºä¿è¯äº†å¯¹æ•°æ—¶é—´æŸ¥æ‰¾çš„setã€mapå’Œå®ƒä»¬çš„multiåŒäº‹ã€‚ å³ä½¿ä½ éœ€è¦çš„å°±åªæ˜¯==å¯¹æ•°æ—¶é—´==æŸ¥æ‰¾çš„ä¿è¯ï¼Œæ ‡å‡†å…³è”å®¹å™¨ä»ç„¶å¯èƒ½ä¸æ˜¯ä½ çš„æœ€ä½³é€‰æ‹©ã€‚å’Œç›´è§‰ç›¸åï¼Œå¯¹äºæ ‡å‡†å…³è”å®¹å™¨ï¼Œæ‰€æä¾›çš„æ€§èƒ½ä¹Ÿç»å¸¸åŠ£äºæœ¬è¯¥æ¯”è¾ƒæ¬¡çš„vectorã€‚ ","date":"2023-08-14","objectID":"/posts/clause_23/:0:0","tags":["Effective STL"],"title":"Effective STL [23] | è€ƒè™‘ç”¨æœ‰åºvectorä»£æ›¿å…³è”å®¹å™¨","uri":"/posts/clause_23/"},{"categories":["C++"],"content":"å…³è”å®¹å™¨æ•°æ®ç»“æ„ æ ‡å‡†å…³è”å®¹å™¨çš„å…¸å‹å®ç°æ˜¯å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ã€‚ ä¸€ä¸ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘æ˜¯ä¸€ä¸ªå¯¹æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾çš„æ··åˆæ“ä½œä¼˜åŒ–çš„æ•°æ®ç»“æ„ã€‚ æ¢å¥è¯è¯´ï¼Œå®ƒè¢«è®¾è®¡ä¸ºåº”ç”¨äºè¿›è¡Œä¸€äº›æ’å…¥ï¼Œç„¶åä¸€äº›æŸ¥æ‰¾ï¼Œç„¶åå¯èƒ½å†è¿›è¡Œä¸€äº›æ’å…¥ï¼Œç„¶åä¹Ÿè®¸ä¸€äº›åˆ é™¤ï¼Œç„¶åå†æ¥ä¸€äº›æŸ¥æ‰¾ï¼Œç„¶åæ›´å¤šçš„æ’å…¥æˆ–åˆ é™¤ï¼Œç„¶åæ›´å¤šçš„æŸ¥æ‰¾ç­‰ã€‚è¿™ä¸ªäº‹ä»¶åºåˆ—çš„å…³é”®ç‰¹å¾æ˜¯æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾éƒ½æ˜¯æ··åˆåœ¨ä¸€èµ·çš„ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæ²¡æœ‰åŠæ³•é¢„æµ‹å¯¹æ ‘çš„ä¸‹ä¸€ä¸ªæ“ä½œæ˜¯ä»€ä¹ˆã€‚ ä½¿ç”¨æ•°æ®ç»“æ„çš„3é˜¶æ®µ å»ºç«‹ã€‚é€šè¿‡æ’å…¥å¾ˆå¤šå…ƒç´ å»ºç«‹ä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå‡ ä¹æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ’å…¥å’Œåˆ é™¤ã€‚å‡ ä¹æ²¡æœ‰æˆ–æ ¹æœ¬æ²¡æœ‰æŸ¥æ‰¾ã€‚ æŸ¥æ‰¾ã€‚åœ¨æ•°æ®ç»“æ„ä¸­æŸ¥æ‰¾æŒ‡å®šçš„ä¿¡æ¯ç‰‡ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå‡ ä¹æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æŸ¥æ‰¾ã€‚å‡ ä¹æ²¡æœ‰æˆ–æ ¹æœ¬æ²¡æœ‰æ’å…¥å’Œåˆ é™¤ã€‚ é‡ç»„ã€‚ä¿®æ”¹æ•°æ®ç»“æ„çš„å†…å®¹ï¼Œé€šè¿‡åˆ é™¤æ‰€æœ‰ç°æœ‰æ•°æ®å’Œåœ¨åŸåœ°æ’å…¥æ–°æ•°æ®ã€‚ä»åŠ¨ä½œä¸Šè¯´ï¼Œè¿™ä¸ªé˜¶æ®µç­‰ä»·äºé˜¶æ®µ1ã€‚ä¸€æ—¦è¿™ä¸ªé˜¶æ®µå®Œæˆï¼Œåº”ç”¨ç¨‹åºè¿”å›é˜¶æ®µ2ã€‚ ","date":"2023-08-14","objectID":"/posts/clause_23/:1:0","tags":["Effective STL"],"title":"Effective STL [23] | è€ƒè™‘ç”¨æœ‰åºvectorä»£æ›¿å…³è”å®¹å™¨","uri":"/posts/clause_23/"},{"categories":["C++"],"content":"æœ‰åºvectoræ›´é«˜æ•ˆ ä¸€ä¸ªvectorå¯èƒ½æ¯”ä¸€ä¸ªå…³è”å®¹å™¨èƒ½æä¾›æ›´é«˜çš„æ€§èƒ½ï¼ˆæ—¶é—´å’Œç©ºé—´ä¸Šéƒ½æ˜¯ï¼‰ã€‚ ä½†ä¸æ˜¯ä»»æ„çš„vectoréƒ½ä¼šï¼Œåªæœ‰æœ‰åºvectorã€‚å› ä¸ºåªæœ‰æœ‰åºå®¹å™¨æ‰èƒ½æ­£ç¡®åœ°ä½¿ç”¨æŸ¥æ‰¾ç®—æ³•â€”â€”binary_searchã€lower_boundã€equal_rangeç­‰ã€‚ Q: ä¸ºä»€ä¹ˆä¸€ä¸ªï¼ˆæœ‰åºçš„ï¼‰vectorçš„äºŒåˆ†æ³•æŸ¥æ‰¾æ¯”ä¸€ä¸ªäºŒå‰æ ‘çš„äºŒåˆ†æ³•æŸ¥æ‰¾æä¾›äº†æ›´å¥½çš„æ€§èƒ½ï¼Ÿ A: å…¶ä¸­çš„ä¸€ä¸ªæ˜¯å¤§å°é—®é¢˜ï¼Œå…¶ä¸­çš„ä¸€ä¸ªæ˜¯å¼•ç”¨å±€éƒ¨æ€§é—®é¢˜ã€‚ å¤§å°é—®é¢˜ å‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®¹å™¨æ¥å®¹çº³Widgetå¯¹è±¡ï¼Œè€Œä¸”ï¼Œå› ä¸ºæŸ¥æ‰¾é€Ÿåº¦å¯¹æˆ‘ä»¬å¾ˆé‡è¦ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªWidgetçš„å…³è”å®¹å™¨å’Œä¸€ä¸ªæœ‰åºvector\u003cWidget\u003eã€‚ å…³è”å®¹å™¨æ•°æ®ç»“æ„ å¦‚æœé€‰æ‹©ä¸€ä¸ªå…³è”å®¹å™¨ï¼Œæˆ‘ä»¬å‡ ä¹ç¡®å®šäº†è¦ä½¿ç”¨å¹³è¡¡äºŒå‰æ ‘ã€‚è¿™æ ·çš„æ ‘æ˜¯ç”±æ ‘èŠ‚ç‚¹ç»„æˆï¼Œæ¯ä¸ªéƒ½ä¸ä»…å®¹çº³äº†ä¸€ä¸ªWidgetï¼Œè€Œä¸”ä¿å­˜äº†ä¸€ä¸ªè¯¥èŠ‚ç‚¹åˆ°å·¦å­©å­çš„æŒ‡é’ˆï¼Œä¸€ä¸ªåˆ°å®ƒå³å­©å­çš„æŒ‡é’ˆï¼Œå’Œï¼ˆå…¸å‹çš„ï¼‰ä¸€ä¸ªåˆ°å®ƒçˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚ è¿™æ„å‘³ç€åœ¨å…³è”å®¹å™¨ä¸­ç”¨äºå­˜å‚¨ä¸€ä¸ªWidgetçš„ç©ºé—´å¼€é”€è‡³å°‘ä¼šæ˜¯ä¸‰ä¸ªæŒ‡é’ˆã€‚ vectoræ•°æ®ç»“æ„ ä¸ä¹‹ç›¸å¯¹çš„æ˜¯ï¼Œå½“åœ¨vectorä¸­å­˜å‚¨Widgetå¹¶æ²¡æœ‰å¼€é”€ï¼šç®€å•åœ°å­˜å‚¨ä¸€ä¸ªWidgetã€‚ å½“ç„¶ï¼Œvectoræœ¬èº«æœ‰å¼€é”€ï¼Œåœ¨vectorç»“å°¾ä¹Ÿå¯èƒ½æœ‰ç©ºçš„ï¼ˆä¿ç•™ï¼‰ç©ºé—´ï¼Œä½†æ˜¯æ¯ä¸ªvectorå¼€é”€æ˜¯å¯ä»¥å¿½ç•¥çš„ï¼ˆé€šå¸¸æ˜¯ä¸‰ä¸ªæœºå™¨å­—ï¼Œæ¯”å¦‚ï¼Œä¸‰ä¸ªæŒ‡é’ˆæˆ–ä¸¤ä¸ªæŒ‡é’ˆå’Œä¸€ä¸ªintï¼‰ï¼Œè€Œä¸”å¦‚æœå¿…è¦çš„è¯ï¼Œæœ«å°¾ç©ºçš„ç©ºé—´å¯ä»¥é€šè¿‡â€œäº¤æ¢æŠ€å·§â€å»æ‰ã€‚å³ä½¿è¿™ä¸ªé™„åŠ çš„ç©ºé—´æ²¡æœ‰å»æ‰ï¼Œä¹Ÿå¹¶ä¸å½±å“ä¸‹é¢çš„åˆ†æï¼Œå› ä¸ºå½“æŸ¥æ‰¾æ—¶ä¸ä¼šå¼•ç”¨é‚£æ®µå†…å­˜ã€‚ å†…å­˜å¤§å° å‡è®¾æˆ‘ä»¬çš„æ•°æ®ç»“æ„è¶³å¤Ÿå¤§ï¼Œå®ƒä»¬å¯ä»¥åˆ†æˆå¤šä¸ªå†…å­˜é¡µé¢ï¼Œä½†æ˜¯vectoræ¯”å…³è”å®¹å™¨éœ€è¦çš„é¡µé¢è¦å°‘ã€‚ å› ä¸ºvectorä¸éœ€è¦æ¯ä¸ªWidgetçš„å¼€é”€ï¼Œè€Œå…³è”å®¹å™¨ç»™æ¯ä¸ªWidgetä¸Šé™„åŠ äº†ä¸‰ä¸ªæŒ‡é’ˆã€‚ å‡è®¾åœ¨ä½ ä½¿ç”¨çš„ç³»ç»Ÿä¸Šä¸€ä¸ªWidgetçš„å¤§å°æ˜¯12ä¸ªå­—èŠ‚ï¼ŒæŒ‡é’ˆæ˜¯4ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªå†…å­˜é¡µé¢æ˜¯4096ï¼ˆ4Kï¼‰å­—èŠ‚ã€‚ å¿½ç•¥æ¯ä¸ªå®¹å™¨çš„å¼€é”€ï¼Œå½“ç”¨vectorä¿å­˜æ—¶ï¼Œä½ å¯ä»¥åœ¨ä¸€é¡µé¢ä¸Šæ”¾ç½®341ä¸ªWidget $(4096\\div12\\approx341)$ï¼Œä½†ä½¿ç”¨å…³è”å®¹å™¨æ—¶ä½ æœ€å¤šåªèƒ½æ”¾170ä¸ª $4096\\div(12+4\\times3)\\approx170)$ã€‚ å› æ­¤å…³è”å®¹å™¨å’Œvectoræ¯”èµ·æ¥ï¼Œä½ å°†ä¼šä½¿ç”¨å¤§çº¦ä¸¤å€çš„å†…å­˜ã€‚ å¦‚æœä½ ä½¿ç”¨çš„ç¯å¢ƒå¯ä»¥ç”¨è™šæ‹Ÿå†…å­˜ï¼Œå°±å¾ˆå¯ä»¥å®¹æ˜“åœ°çœ‹å‡ºé‚£ä¼šé€ æˆå¤§é‡çš„é¡µé¢é”™è¯¯ï¼Œå› æ­¤ä¸€ä¸ªç³»ç»Ÿä¼šå› ä¸ºå¤§æ•°æ®é‡è€Œæ˜æ˜¾æ…¢ä¸‹æ¥ã€‚ å¼•ç”¨å±€éƒ¨æ€§é—®é¢˜ å‡è®¾åœ¨äºŒå‰æ ‘ä¸­çš„èŠ‚ç‚¹éƒ½ç¾¤é›†åœ¨ä¸€ä¸ªç›¸å…³çš„å°å†…å­˜é¡µé¢é›†ä¸­ï¼Œå®é™…æƒ…å†µä¸‹å…³è”å®¹å™¨å¾ˆä¹è§‚çš„ã€‚ å¤§éƒ¨åˆ†STLå®ç°ä½¿ç”¨è‡ªå®šä¹‰å†…å­˜ç®¡ç†å™¨æ¥è¾¾åˆ°è¿™æ ·çš„ç¾¤é›†ï¼Œä½†æ˜¯å¦‚æœä½ çš„STLå®ç°æ²¡æœ‰æ”¹è¿›æ ‘èŠ‚ç‚¹ä¸­çš„å¼•ç”¨å±€éƒ¨æ€§ï¼Œè¿™äº›èŠ‚ç‚¹ä¼šåˆ†æ•£åœ¨æ‰€æœ‰ä½ çš„å†…å­˜ç©ºé—´ã€‚é‚£ä¼šå¯¼è‡´æ›´å¤šçš„é¡µé¢é”™è¯¯ã€‚ å³ä½¿ä½¿ç”¨äº†è‡ªå®šä¹‰ç¾¤é›†å†…å­˜ç®¡ç†å™¨ï¼Œå…³è”å®¹å™¨ä¹Ÿä¼šå¯¼è‡´å¾ˆå¤šé¡µé¢é”™è¯¯ï¼Œå› ä¸ºï¼Œä¸åƒè¿ç»­å†…å­˜å®¹å™¨ï¼Œæ¯”å¦‚vectorï¼ŒåŸºäºèŠ‚ç‚¹çš„å®¹å™¨æ›´éš¾ä¿è¯åœ¨å®¹å™¨çš„éå†é¡ºåºä¸­ä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªçš„å…ƒç´ åœ¨ç‰©ç†å†…å­˜ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªã€‚ å½“è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾æ—¶é‚£ç§å†…å­˜ç»„ç»‡æ–¹å¼ï¼ˆè¯‘æ³¨ï¼šéå†é¡ºåºä¸­ä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªçš„å…ƒç´ åœ¨ç‰©ç†å†…å­˜ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªï¼‰æ­£å¥½æ˜¯é¡µé¢é”™è¯¯æœ€å°‘çš„ã€‚ ","date":"2023-08-14","objectID":"/posts/clause_23/:2:0","tags":["Effective STL"],"title":"Effective STL [23] | è€ƒè™‘ç”¨æœ‰åºvectorä»£æ›¿å…³è”å®¹å™¨","uri":"/posts/clause_23/"},{"categories":["C++"],"content":"vectorçš„ç¼ºç‚¹ æœ‰åºvectorçš„å¤§ç¼ºç‚¹æ˜¯å¿…é¡»ä¿æŒæœ‰åºï¼ å› ä¸ºvectorä¸­æ‰€æœ‰çš„å…ƒç´ éƒ½å¿…é¡»æ‹·è´ï¼Œæ‰€ä»¥ï¼š å½“ä¸€ä¸ªæ–°å…ƒç´ æ’å…¥æ—¶ï¼Œå¤§äºè¿™ä¸ªæ–°å…ƒç´ çš„æ‰€æœ‰ä¸œè¥¿éƒ½å¿…é¡»å‘ä¸Šç§»ä¸€ä½ï¼Œéå¸¸æ˜‚è´µï¼› å¦‚æœvectorå¿…é¡»é‡æ–°åˆ†é…å®ƒçš„å†…åœ¨å†…å­˜ï¼Œåˆ™ä¼šæ›´æ˜‚è´µï¼› å¦‚æœä¸€ä¸ªå…ƒç´ ä»vectorä¸­è¢«åˆ é™¤ï¼Œæ‰€æœ‰å¤§äºå®ƒçš„å…ƒç´ éƒ½è¦å‘ä¸‹ç§»åŠ¨ã€‚ vectorçš„æ’å…¥å’Œåˆ é™¤éƒ½å¾ˆæ˜‚è´µï¼Œä½†æ˜¯å…³è”å®¹å™¨çš„æ’å…¥å’Œåˆ é™¤åˆ™å¾ˆè½»é‡ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåªæœ‰å½“ä½ çŸ¥é“ä½ çš„æ•°æ®ç»“æ„ä½¿ç”¨çš„æ—¶å€™æŸ¥æ‰¾å‡ ä¹ä¸å’Œæ’å…¥å’Œåˆ é™¤æ··åˆæ—¶ï¼Œä½¿ç”¨æœ‰åºvectorä»£æ›¿å…³è”å®¹å™¨æ‰æœ‰æ„ä¹‰ã€‚ æ¦‚è¦ åœ¨æœ‰åºvectorä¸­å­˜å‚¨æ•°æ®å¾ˆæœ‰å¯èƒ½æ¯”åœ¨æ ‡å‡†å…³è”å®¹å™¨ä¸­ä¿å­˜ç›¸åŒçš„æ•°æ®æ¶ˆè€—æ›´å°‘çš„å†…å­˜ï¼› å½“é¡µé¢é”™è¯¯å€¼å¾—é‡è§†çš„æ—¶å€™ï¼Œåœ¨æœ‰åºvectorä¸­é€šè¿‡äºŒåˆ†æ³•æŸ¥æ‰¾å¯èƒ½æ¯”åœ¨ä¸€ä¸ªæ ‡å‡†å…³è”å®¹å™¨ä¸­æŸ¥æ‰¾æ›´å¿«ã€‚ ","date":"2023-08-14","objectID":"/posts/clause_23/:3:0","tags":["Effective STL"],"title":"Effective STL [23] | è€ƒè™‘ç”¨æœ‰åºvectorä»£æ›¿å…³è”å®¹å™¨","uri":"/posts/clause_23/"},{"categories":["C++"],"content":"Example vectorä»£æ›¿set // ä»£æ›¿set\u003cWidget\u003e vector\u003cWidget\u003e vw; // å»ºç«‹é˜¶æ®µï¼šå¾ˆå¤šæ’å…¥ï¼Œå‡ ä¹æ²¡æœ‰æŸ¥æ‰¾ ... // ç»“æŸå»ºç«‹é˜¶æ®µã€‚ï¼ˆå½“æ¨¡æ‹Ÿä¸€ä¸ªmultisetæ—¶ï¼Œä½ å¯èƒ½æ›´å–œæ¬¢ç”¨stable_sort æ¥ä»£æ›¿ï¼› sort(vw.begin(), vw.end()); // ç”¨äºæŸ¥æ‰¾çš„å€¼çš„å¯¹è±¡ Widget w; ...// å¼€å§‹æŸ¥æ‰¾é˜¶æ®µ // é€šè¿‡binary_searchæŸ¥æ‰¾ if (binary_search(vw.begin(), vw.end(), w))... // é€šè¿‡lower_boundæŸ¥æ‰¾ vector\u003cWidget\u003e::iterator i = lower_bound(vw.begin(), vw.end(), w); // æ¡æ¬¾19è§£é‡Šäº†â€œ!(w \u003c *i)â€æµ‹è¯• if (i != vw.end() \u0026\u0026 !(w \u003c *i))... // é€šè¿‡equal_rangeæŸ¥æ‰¾ pair\u003cvector\u003cWidget\u003e::iterator, vector\u003cWidget\u003e::iterator\u003e range = equal_range(vw.begin(), vw.end(), w); if (range.first != range.second)... ... // ç»“æŸæŸ¥æ‰¾é˜¶æ®µï¼Œå¼€å§‹é‡ç»„é˜¶æ®µ // å¼€å§‹æ–°çš„æŸ¥æ‰¾é˜¶æ®µ... sort(vw.begin(), vw.end()); é‡Œé¢æœ€éš¾çš„ä¸œè¥¿å°±æ˜¯æ€ä¹ˆåœ¨æœç´¢ç®—æ³•ä¸­åšå‡ºé€‰æ‹©ï¼ˆæ¯”å¦‚ï¼Œbinary_searchã€lower_boundç­‰ï¼‰ vectorä»£æ›¿mapæˆ–multimap å½“ä½ å†³å®šç”¨vectorä»£æ›¿mapæˆ–multimapæ—¶ï¼Œäº‹æƒ…ä¼šå˜å¾—æ›´æœ‰è¶£ï¼Œå› ä¸ºvectorå¿…é¡»å®¹çº³pairå¯¹è±¡ã€‚ ä½†æ˜¯è¦æ³¨æ„ï¼Œå¦‚æœä½ å£°æ˜ä¸€ä¸ªmap\u003cK, V\u003eçš„å¯¹è±¡ï¼ˆæˆ–è€…ç­‰ä»·çš„multimapï¼‰ï¼Œä¿å­˜åœ¨mapä¸­çš„å…ƒç´ ç±»å‹æ˜¯pair\u003cconst K, V\u003eã€‚ å¦‚æœè¦ç”¨vectoræ¨¡æ‹Ÿmapæˆ–è€…multimapï¼Œå¿…é¡»å»æ‰constï¼Œå› ä¸ºå½“ä½ å¯¹vectoræ’åºæ—¶ï¼Œå…ƒç´ çš„å€¼å°†ä¼šé€šè¿‡èµ‹å€¼ç§»åŠ¨ï¼Œé‚£æ„å‘³ç€pairçš„ä¸¤ä¸ªç»„ä»¶éƒ½å¿…é¡»æ˜¯å¯èµ‹å€¼çš„ã€‚ å½“ä½¿ç”¨vectoræ¥æ¨¡æ‹Ÿmap\u003cK, V\u003eæ—¶ï¼Œä¿å­˜åœ¨vectorä¸­æ•°æ®çš„ç±»å‹å°†æ˜¯pair\u003cK, V\u003eï¼Œè€Œä¸æ˜¯pair\u003cconst K, V\u003eã€‚ mapå’Œmultimapä»¥é¡ºåºçš„æ–¹å¼ä¿å­˜ä»–ä»¬çš„å…ƒç´ ï¼Œä½†ç”¨äºæ’åºç›®çš„æ—¶å®ƒä»¬åªä½œç”¨äºå…ƒç´ çš„keyéƒ¨åˆ†ï¼ˆpairçš„ç¬¬ä¸€ä¸ªç»„ä»¶ï¼‰ï¼Œæ‰€ä»¥å½“æ’åºvectoræ—¶ä½ å¿…é¡»åšä¸€æ ·çš„äº‹æƒ…ã€‚ ä½ éœ€è¦ä¸ºä½ çš„pairå†™ä¸€ä¸ªè‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°ï¼Œå› ä¸ºpairçš„operator\u003cä½œç”¨äºpairçš„ä¸¤ä¸ªç»„ä»¶ã€‚ 2ä¸ªæ¯”è¾ƒå‡½æ•°æ¥è¿›è¡ŒæŸ¥æ‰¾ ç”¨æ¥æ’åºçš„æ¯”è¾ƒå‡½æ•°å°†ä½œç”¨äºä¸¤ä¸ªpairå¯¹è±¡ï¼Œä½†æ˜¯æŸ¥æ‰¾åªç”¨åˆ°keyå€¼ã€‚ å¿…é¡»ä¼ ç»™ç”¨äºæŸ¥æ‰¾çš„æ¯”è¾ƒå‡½æ•°ä¸€ä¸ªkeyç±»å‹çš„å¯¹è±¡ï¼ˆè¦æŸ¥æ‰¾çš„å€¼ï¼‰å’Œä¸€ä¸ªpairï¼ˆå­˜å‚¨åœ¨vectorä¸­çš„ä¸€ä¸ªpairï¼‰â€”â€”ä¸¤ä¸ªä¸åŒçš„ç±»å‹ã€‚ è¿˜æœ‰ä¸€ä¸ªé™„åŠ çš„éº»çƒ¦ï¼Œä½ ä¸ä¼šçŸ¥é“keyè¿˜æ˜¯pairæ˜¯ä½œä¸ºç¬¬ä¸€ä¸ªå®å‚ä¼ é€’çš„ï¼Œæ‰€ä»¥ä½ çœŸçš„éœ€è¦ä¸¤ä¸ªç”¨äºæŸ¥æ‰¾çš„æ¯”è¾ƒå‡½æ•°ï¼šä¸€ä¸ªkeyå€¼å…ˆä¼ é€’ï¼Œä¸€ä¸ªpairå…ˆä¼ é€’ typedef pair\u003cstring, int\u003e Data; // åœ¨è¿™ä¸ªä¾‹å­é‡Œ\"map\"å®¹çº³çš„ç±»å‹ class DataCompare { // ç”¨äºæ¯”è¾ƒçš„ç±» public: // ç”¨äºæ’åºçš„æ¯”è¾ƒå‡½æ•°keyLessåœ¨ä¸‹é¢ bool operator()(const Data\u0026 lhs, const Data\u0026 rhs) const { return keyLess(lhs.first, rhs.first); } // ç”¨äºæŸ¥æ‰¾çš„æ¯”è¾ƒå‡½æ•°ï¼ˆå½¢å¼1ï¼‰ bool operator()(const Data\u0026 Ihs, const Data::first_type\u0026 k) const { return keyLess(lhs.first, k); } // ç”¨äºæŸ¥æ‰¾çš„æ¯”è¾ƒå‡½æ•°ï¼ˆå½¢å¼2ï¼‰ bool operator()(const Data::first_type\u0026 k, const Data\u0026 rhs) const { return keyLessfk, rhs.first); } private: // â€œçœŸçš„â€æ¯”è¾ƒå‡½æ•° bool keyLess(const Data::first_type\u0026 k1, const Data::first_type\u0026 k2) const { return k1 \u003c k2; } }; æˆ‘ä»¬å‡è®¾æœ‰åºvectorå°†æ¨¡æ‹Ÿmap\u003cstring, int\u003eã€‚ è¿™æ®µä»£ç å‡ ä¹æ˜¯ä¸Šé¢è®¨è®ºçš„å­—é¢è½¬æ¢ï¼Œé™¤äº†å­˜åœ¨æˆå‘˜å‡½æ•°keyLessã€‚ é‚£ä¸ªå‡½æ•°çš„å­˜åœ¨æ˜¯ç”¨æ¥ä¿è¯å‡ ä¸ªä¸åŒçš„operator()å‡½æ•°ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚ æ¯ä¸ªè¿™æ ·çš„å‡½æ•°åªæ˜¯ç®€å•åœ°æ¯”è¾ƒä¸¤ä¸ªkeyçš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™ä¸ªæµ‹è¯•æ”¾åœ¨keyLessä¸­å¹¶è®©operator()å‡½æ•°è¿”å›keyLessæ‰€åšçš„äº‹æƒ…ï¼Œè¿™æ¯”å¤åˆ¶é‚£ä¸ªé€»è¾‘è¦å¥½ã€‚ è¿™ä¸ªè½¯ä»¶å·¥ç¨‹ä¸­ç»å¦™çš„åŠ¨ä½œå¢å¼ºäº†DataCompareçš„å¯ç»´æŠ¤æ€§ï¼Œä½†æœ‰ä¸€ä¸ªå°ç¼ºç‚¹ï¼Œå®ƒæä¾›äº†æœ‰ä¸åŒå‚æ•°ç±»å‹çš„operator()å‡½æ•°ï¼Œè¿™å°†å¯¼è‡´å‡½æ•°å¯¹è±¡æ— æ³•é€‚é…ã€‚ æŠŠæœ‰åºvectorç”¨ä½œmapæœ¬è´¨ä¸Šå’Œç”¨ä½œsetä¸€æ ·ã€‚ å”¯ä¸€å¤§çš„åŒºåˆ«æ˜¯å¿…é¡»æŠŠDataCompareå¯¹è±¡ç”¨ä½œæ¯”è¾ƒå‡½æ•°: // ä»£æ›¿map\u003cstring, int\u003e vector\u003cData\u003e vd; // å»ºç«‹é˜¶æ®µï¼šå¾ˆå¤šæ’å…¥ï¼Œå‡ ä¹æ²¡æœ‰æŸ¥æ‰¾ ... // ç»“æŸå»ºç«‹é˜¶æ®µã€‚ï¼ˆå½“æ¨¡æ‹Ÿmultimapæ—¶ï¼Œä½ å¯èƒ½æ›´å–œæ¬¢ç”¨stable_sortæ¥ä»£æ›¿ï¼‰ï¼› sort(vd.begin(), vd.end(), DataCompare()); // ç”¨äºæŸ¥æ‰¾çš„å€¼çš„å¯¹è±¡ string s; ... // å¼€å§‹æŸ¥æ‰¾é˜¶æ®µ // é€šè¿‡binary_searchæŸ¥æ‰¾ if (binary_search(vd.begin(), vd.end(), s, DataCompare()))... // å†æ¬¡é€šè¿‡lower_boundæŸ¥æ‰¾ï¼Œ vector\u003cData\u003e::iterator i = lower_bound(vd.begin(), vd.end(), s, DataCompare()); // æ¡æ¬¾45è§£é‡Šäº†â€œ!DataCompare()(s, *i)â€æµ‹è¯• if (i != vd.end() \u0026\u0026 !DataCompare()(s, *i))... // é€šè¿‡equal_rangeæŸ¥æ‰¾ pair\u003cvector\u003cData\u003e::iterator, vector\u003cData\u003e::iterator\u003e range = equal_range(vd.begin(), vd.end(), s, DataCompare()); if (range.first != range.second)... ... // ç»“æŸæŸ¥æ‰¾é˜¶æ®µï¼Œå¼€å§‹é‡ç»„é˜¶æ®µ // å¼€å§‹æ–°çš„æŸ¥æ‰¾é˜¶æ®µ... sort(vd.begin(), vd.end(), DataCompare()); æ­£å¦‚ä½ æ‰€è§ï¼Œä¸€æ—¦ä½ å†™äº†DataCompareï¼Œä¸œè¥¿éƒ½å¾ˆå¥½åœ°ä¾åºæ’åˆ—äº†ã€‚ è€Œä¸€æ—¦ä½ç½®åˆé€‚äº†ï¼Œå®ƒä»¬å¾€å¾€æ¯”ç›¸åº”çš„ä½¿ç”¨çœŸçš„mapçš„è®¾è®¡è¿è¡Œå¾—æ›´å¿«è€Œä¸”ä½¿ç”¨æ›´å°‘å†…å­˜ã€‚ å¦‚æœä½ çš„ç¨‹åºä¸æ˜¯æŒ‰ç…§é˜¶æ®µçš„æ–¹å¼æ“ä½œæ•°æ®ç»“æ„ï¼Œé‚£ä¹ˆä½¿ç”¨æœ‰åºvectorä»£æ›¿æ ‡å‡†å…³è”å®¹å™¨å‡ ä¹å¯ä»¥ç¡®å®šæ˜¯åœ¨æµªè´¹æ—¶é—´ã€‚ ","date":"2023-08-14","objectID":"/posts/clause_23/:4:0","tags":["Effective STL"],"title":"Effective STL [23] | è€ƒè™‘ç”¨æœ‰åºvectorä»£æ›¿å…³è”å®¹å™¨","uri":"/posts/clause_23/"},{"categories":["C++"],"content":"æ‰€æœ‰æ ‡å‡†å…³è”å®¹å™¨ï¼Œsetå’Œmultisetä¿æŒå®ƒä»¬çš„å…ƒç´ æœ‰åºï¼Œè¿™äº›å®¹å™¨çš„æ­£ç¡®è¡Œä¸ºä¾èµ–äºå®ƒä»¬ä¿æŒæœ‰åºã€‚ å¦‚æœä½ æ”¹äº†å…³è”å®¹å™¨é‡Œçš„ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼ˆä¾‹å¦‚ï¼ŒæŠŠ10å˜ä¸º1000ï¼‰ï¼Œæ–°å€¼å¯èƒ½ä¸åœ¨æ­£ç¡®çš„ä½ç½®ï¼Œè€Œä¸”é‚£å°†ç ´åå®¹å™¨çš„æœ‰åºæ€§ã€‚ ","date":"2023-08-14","objectID":"/posts/clause_22/:0:0","tags":["Effective STL"],"title":"Effective STL [22] | é¿å…åŸåœ°ä¿®æ”¹setå’Œmultisetçš„é”®","uri":"/posts/clause_22/"},{"categories":["C++"],"content":"ä¿®æ”¹mapå’Œmultimapå€¼ è¯•å›¾æ”¹å˜è¿™äº›å®¹å™¨é‡Œçš„ä¸€ä¸ªé”®å€¼çš„ç¨‹åºå°†ä¸èƒ½ç¼–è¯‘: map\u003cint, string\u003e m; ... m.begin()-\u003efirst = 10; // é”™è¯¯ï¼mapé”®ä¸èƒ½æ”¹å˜ multimap\u003cint, string\u003e mm; ... mm.begin()-\u003efirst = 20; // é”™è¯¯ï¼multimapé”®ä¹Ÿä¸èƒ½æ”¹å˜ Note å› ä¸ºmap\u003cK, V\u003eæˆ–multimap\u003cK, V\u003eç±»å‹çš„å¯¹è±¡ä¸­å…ƒç´ çš„ç±»å‹æ˜¯pair\u003cconst K, V\u003eã€‚å› ä¸ºé”®çš„ç±»å‹const Kï¼Œå®ƒä¸èƒ½æ”¹å˜ã€‚ template \u003ctypename _Key, typename _Tp, typename _Compare = std::less\u003c_Key\u003e, typename _Alloc = std::allocator\u003cstd::pair\u003cconst _Key, _Tp\u003e \u003e \u003e class map { public: typedef _Key key_type; typedef _Tp mapped_type; typedef std::pair\u003cconst _Key, _Tp\u003e value_type; typedef _Compare key_compare; typedef _Alloc allocator_type; ... } å¦‚æœä½ ä½¿ç”¨ä¸€ä¸ªconst_castï¼Œæˆ–è®¸èƒ½æ”¹å˜å®ƒï¼Œåé¢ä¼šè®¨è®ºåˆ°ã€‚ ","date":"2023-08-14","objectID":"/posts/clause_22/:1:0","tags":["Effective STL"],"title":"Effective STL [22] | é¿å…åŸåœ°ä¿®æ”¹setå’Œmultisetçš„é”®","uri":"/posts/clause_22/"},{"categories":["C++"],"content":"ä¿®æ”¹setå’Œmultisetå€¼ å¯¹äºset\u003cT\u003eæˆ–multiset\u003cT\u003eç±»å‹çš„å¯¹è±¡æ¥è¯´ï¼Œå‚¨å­˜åœ¨å®¹å™¨é‡Œçš„å…ƒç´ ç±»å‹åªä¸è¿‡æ˜¯Tï¼Œå¹¶éconst Tã€‚å› æ­¤ï¼Œsetæˆ–multiseté‡Œçš„å…ƒç´ å¯èƒ½åœ¨ä½ æƒ³è¦çš„ä»»ä½•æ—¶å€™æ”¹å˜ã€‚ä¸éœ€è¦æ˜ å°„ã€‚ template\u003ctypename _Key, typename _Compare = std::less\u003c_Key\u003e, typename _Alloc = std::allocator\u003c_Key\u003e \u003e class set { public: // typedefs: ///@{ /// Public typedefs. typedef _Key key_type; typedef _Key value_type; typedef _Compare key_compare; typedef _Compare value_compare; typedef _Alloc allocator_type; ///@} ... } ä¸ºä»€ä¹ˆsetæˆ–multiseté‡Œçš„å…ƒç´ ä¸æ˜¯å¸¸æ•°ï¼Ÿ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé›‡å‘˜çš„ç±»: class Employee { public: ... const string\u0026 name() const; // è·å–é›‡å‘˜å void setName(const string\u0026 name); // è®¾ç½®é›‡å‘˜å const string\u0026 getTitle() const; // è·å–é›‡å‘˜å¤´è¡” void setTitle(string\u0026 title); // è®¾ç½®é›‡å‘˜å¤´è¡” int idNumber() const; // è·å–é›‡å‘˜IDå· ... } è®©æˆ‘ä»¬åšåˆç†çš„å‡è®¾ï¼Œæ¯ä¸ªé›‡å‘˜æœ‰å”¯ä¸€çš„IDå·ï¼Œå°±æ˜¯idNumberå‡½æ•°è¿”å›çš„æ•°å­—ã€‚ç„¶åï¼Œå»ºç«‹ä¸€ä¸ªé›‡å‘˜çš„setï¼Œå¾ˆæ˜¾ç„¶åº”è¯¥åªä»¥IDå·æ¥æ’åºset: struct IDNumberLess { public binary_function\u003cEmployee, Employee, bool\u003e { // å‚è§æ¡æ¬¾40 bool operator()(const Employees lhs, const Employee\u0026 rhs) const { return lhs.idNumber() \u003c rhs.idNumber(); } }; typedef set\u003cEmployee, IDNumberLess\u003e EmpIDSet; EmpIDSet se; // seæ˜¯é›‡å‘˜çš„setï¼Œ æŒ‰ç…§IDå·æ’åº å®é™…ä¸Šï¼Œé›‡å‘˜çš„IDå·æ˜¯setä¸­å…ƒç´ çš„é”®ã€‚å…¶ä½™çš„é›‡å‘˜æ•°æ®åªæ˜¯è™šæœ‰å…¶è¡¨ã€‚åœ¨è¿™é‡Œï¼Œæ²¡æœ‰ç†ç”±ä¸èƒ½æŠŠä¸€ä¸ªç‰¹å®šé›‡å‘˜çš„å¤´è¡”æ”¹æˆæŸä¸ªæœ‰è¶£çš„ä¸œè¥¿: Employee selectedID; // å®¹çº³è¢«é€‰æ‹©çš„é›‡å‘˜ ... // IDå·çš„å˜é‡ EmpIDSet::iterator i = se.find(selectedID); if (i != se.end()){ i-\u003esetTitle(\"Corporate Deity\"); // ç»™é›‡å‘˜æ–°å¤´è¡” } å› ä¸ºåœ¨è¿™é‡Œæˆ‘ä»¬åªæ˜¯æ”¹å˜é›‡å‘˜çš„ä¸€ä¸ªä¸setæ’åºçš„æ–¹å¼æ— å…³çš„æ–¹é¢ï¼ˆä¸€ä¸ªé›‡å‘˜çš„éé”®éƒ¨åˆ†ï¼‰ï¼Œæ‰€ä»¥è¿™æ®µä»£ç ä¸ä¼šç ´åsetã€‚é‚£æ˜¯å®ƒåˆæ³•çš„åŸå› ã€‚ä½†å®ƒçš„åˆæ³•æ’é™¤äº†set/multisetçš„å…ƒç´ æ˜¯constçš„å¯èƒ½ã€‚è€Œä¸”é‚£æ˜¯å®ƒä»¬ä¸ºä»€ä¹ˆä¸æ˜¯çš„åŸå› ã€‚ å› ä¸ºsetæˆ–multiseté‡Œçš„å€¼ä¸æ˜¯constï¼Œæ‰€ä»¥è¯•å›¾æ”¹å˜å®ƒä»¬å¯ä»¥ç¼–è¯‘ã€‚ å¦‚æœä½ æ”¹å˜setæˆ–multiseté‡Œçš„å…ƒç´ ï¼Œ ä½ å¿…é¡»ç¡®ä¿ä¸æ”¹å˜ä¸€ä¸ªé”®éƒ¨åˆ†â€”â€”å½±å“å®¹å™¨æœ‰åºæ€§çš„å…ƒç´ éƒ¨åˆ†ã€‚å¦‚æœä½ åšäº†ï¼Œä½ ä¼šç ´åå®¹å™¨ï¼Œå†ä½¿ç”¨é‚£ä¸ªå®¹å™¨å°†äº§ç”Ÿæœªå®šä¹‰çš„ç»“æœï¼Œ è€Œä¸”é‚£æ˜¯ä½ çš„é”™è¯¯ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿™ä¸ªé™åˆ¶åªåº”ç”¨äºè¢«åŒ…å«å¯¹è±¡çš„é”®éƒ¨åˆ†ã€‚å¯¹è¢«åŒ…å«å…ƒç´ çš„æ‰€æœ‰å…¶ä»–éƒ¨åˆ†æ¥è¯´ï¼Œæ˜¯å¼€æ”¾çš„: éšä¾¿æ”¹å˜ï¼ ","date":"2023-08-14","objectID":"/posts/clause_22/:2:0","tags":["Effective STL"],"title":"Effective STL [22] | é¿å…åŸåœ°ä¿®æ”¹setå’Œmultisetçš„é”®","uri":"/posts/clause_22/"},{"categories":["C++"],"content":"é˜»æ­¢ä¿®æ”¹setå’Œmultisetå€¼ å³ä½¿setå’Œmultisetçš„å…ƒç´ ä¸æ˜¯constï¼Œå®ç°ä»ç„¶æœ‰å¾ˆå¤šæ–¹å¼å¯ä»¥é˜»æ­¢å®ƒä»¬è¢«ä¿®æ”¹ã€‚ ä¾‹å¦‚ï¼Œå®ç°å¯ä»¥è®©ç”¨äºset\u003cT\u003e::iteratorçš„operator*è¿”å›ä¸€ä¸ªå¸¸æ•°T\u0026ã€‚å³ï¼Œå®ƒå¯ä»¥è®©setçš„è¿­ä»£å™¨è§£å¼•ç”¨çš„ç»“æœæ˜¯setå…ƒç´ çš„å¸¸é‡å¼•ç”¨ã€‚ åœ¨è¿™æ ·çš„å®ç°ä¸‹ï¼Œå°†æ²¡æœ‰åŠæ³•ä¿®æ”¹setæˆ–multisetçš„å…ƒç´ ï¼Œå› ä¸ºæ‰€æœ‰è®¿é—®é‚£äº›å…ƒç´ çš„æ–¹æ³•éƒ½å°†åœ¨è®©ä½ è®¿é—®ä¹‹å‰åŠ ä¸€ä¸ªconstã€‚ ","date":"2023-08-14","objectID":"/posts/clause_22/:3:0","tags":["Effective STL"],"title":"Effective STL [22] | é¿å…åŸåœ°ä¿®æ”¹setå’Œmultisetçš„é”®","uri":"/posts/clause_22/"},{"categories":["C++"],"content":"è¦ä¸è¦ä¿®æ”¹setå’Œmultisetå€¼ å¦‚æœä¸å…³å¿ƒç§»æ¤æ€§ï¼Œä½ æƒ³è¦æ”¹å˜setæˆ–multisetä¸­å…ƒç´ çš„å€¼ï¼Œè€Œä¸”ä½ çš„STLå®ç°è®©ä½ ä¾¥å¹¸æˆåŠŸï¼Œç»§ç»­åšã€‚åªæ˜¯è¦ç¡®å®šä¸è¦æ”¹å˜å…ƒç´ çš„é”®éƒ¨åˆ†ï¼Œå³ï¼Œä¼šå½±å“å®¹å™¨æœ‰åºæ€§çš„å…ƒç´ éƒ¨åˆ†ã€‚ å¦‚æœåœ¨ä¹ç§»æ¤æ€§ï¼Œå°±è®¤ä¸ºsetå’Œmultisetä¸­çš„å…ƒç´ ä¸èƒ½è¢«ä¿®æ”¹ï¼Œè‡³å°‘ä¸èƒ½åœ¨æ²¡æœ‰æ˜ å°„çš„æƒ…å†µä¸‹ Solution: æ˜ å°„åˆ°ä¸€ä¸ªå¼•ç”¨ æœ‰æ—¶å€™å®Œå…¨æœ‰ç†ç”±æ”¹å˜setæˆ–multisetå…ƒç´ çš„éé”®éƒ¨åˆ†ã€‚ä¾‹å¦‚åˆšçœ‹çš„ä¸èƒ½åœ¨ä¸€äº›å®ç°ä¸‹ç¼–è¯‘çš„setTitleè°ƒç”¨: EmpIDSet::iterator i = se.find(selectedID); if (i != se.end()) { i-\u003esetTitle(\"Corporate Deity\"); // æœ‰äº›STLå®ç°ä¼šæ‹’ç»è¿™æ ·ï¼Œå› ä¸º*iæ˜¯const } ä¸ºäº†è®©å®ƒå¯ä»¥ç¼–è¯‘å¹¶ä¸”è¡Œä¸ºæ­£ç¡®ï¼Œæˆ‘ä»¬å¿…é¡»æ˜ å°„æ‰*içš„å¸¸é‡æ€§ã€‚è¿™æ˜¯é‚£ä¹ˆåšçš„æ­£ç¡®æ–¹æ³•: if (i != se.end()) { const_cast\u003cEmployee\u0026\u003e(*i).setTitle(\"Corporate Deity\"); // æ˜ å°„æ‰*içš„å¸¸é‡æ€§ } è¿™å¯ä»¥å¾—åˆ°iæŒ‡å‘çš„å¯¹è±¡ï¼Œå‘Šè¯‰ä½ çš„ç¼–è¯‘å™¨æŠŠæ˜ å°„çš„ç»“æœå½“ä½œä¸€ä¸ªï¼ˆéå¸¸æ•°ï¼‰Employeeçš„å¼•ç”¨ï¼Œç„¶ååœ¨é‚£ä¸ªå¼•ç”¨ä¸Šè°ƒç”¨setTitleã€‚ é”™è¯¯ç‰ˆæœ¬çš„æ˜ å°„ if (i != se.end()){ static_cast\u003cEmployee\u003e(*i).setTitle(\"Corporate Deity\"); // æŠŠ*iæ˜ å°„åˆ°ä¸€ä¸ªEmployee } å®ƒä¹Ÿç­‰ä»·äºå¦‚ä¸‹å†…å®¹: if (i != se.end()) { ((Employee)(*i)).setTitle(\"Corporate Deity\"); // ä½¿ç”¨Cæ˜ å°„è¯­æ³• } è¿™ä¸¤ä¸ªéƒ½èƒ½ç¼–è¯‘ï¼Œè€Œä¸”å› ä¸ºå®ƒä»¬ç­‰ä»·ï¼Œæ‰€ä»¥å®ƒä»¬é”™çš„åŸå› ä¹Ÿç›¸åŒã€‚ åœ¨è¿è¡ŒæœŸï¼Œå®ƒä»¬ä¸èƒ½ä¿®æ”¹*iï¼ åœ¨è¿™ä¸¤ä¸ªæƒ…å†µé‡Œï¼Œæ˜ å°„çš„ç»“æœæ˜¯ä¸€ä¸ª*iå‰¯æœ¬çš„ä¸´æ—¶åŒ¿åå¯¹è±¡ï¼Œè€ŒsetTitleæ˜¯åœ¨åŒ¿åçš„ç‰©ä½“ä¸Šè°ƒç”¨ï¼Œä¸åœ¨*iä¸Šï¼*iæ²¡è¢«ä¿®æ”¹ï¼Œå› ä¸ºsetTitleä»æœªåœ¨é‚£ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨ï¼Œå®ƒåœ¨é‚£ä¸ªå¯¹è±¡çš„å‰¯æœ¬ä¸Šè°ƒç”¨ã€‚ ä¸¤ä¸ªå¥æ³•å½¢å¼ç­‰ä»·äºè¿™ä¸ª: if (i != se.end()){ Employee tempCopy(*i); // æŠŠ*iæ‹·è´åˆ°tempCopy tempCopy.setTitle(\"Corporate Deity\"); // ä¿®æ”¹tempCopy } é€šè¿‡æ˜ å°„åˆ°å¼•ç”¨ï¼Œæˆ‘ä»¬é¿å…äº†å»ºç«‹ä¸€ä¸ªæ–°å¯¹è±¡ã€‚ å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæ˜ å°„çš„ç»“æœæ˜¯ä¸€ä¸ªç°æœ‰å¯¹è±¡çš„å¼•ç”¨ï¼ŒiæŒ‡å‘çš„å¯¹è±¡ã€‚ å½“æˆ‘ä»¬åœ¨æœ‰è¿™ä¸ªå¼•ç”¨æŒ‡å®šçš„å¯¹è±¡ä¸Šè°ƒç”¨setTitleæ—¶ï¼Œæˆ‘ä»¬æ˜¯åœ¨*iä¸Šè°ƒç”¨setTitleï¼Œè€Œä¸”é‚£æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ ä¸ºä»€ä¹ˆä¸èƒ½å»æ‰mapå’Œmultimapçš„å¸¸é‡æ€§ æ³¨æ„map\u003cK, V\u003eæˆ–multimap\u003cK, V\u003eåŒ…å«pair\u003cconst K, V\u003eç±»å‹çš„å…ƒç´ ã€‚ é‚£ä¸ªconstè¡¨æ˜pairçš„ç¬¬ä¸€ä¸ªç»„ä»¶è¢«å®šä¹‰ä¸ºå¸¸é‡ï¼Œè€Œé‚£æ„å‘³ç€è¯•å›¾ä¿®æ”¹å®ƒæ˜¯æœªå®šä¹‰çš„è¡Œä¸ºï¼ˆå³ä½¿æ˜ å°„æ‰å®ƒçš„å¸¸é‡æ€§ï¼‰ã€‚ ç†è®ºä¸Šï¼Œä¸€ä¸ªSTLå®ç°å¯èƒ½æŠŠè¿™æ ·çš„å€¼å†™åˆ°ä¸€ä¸ªåªè¯»çš„å†…å­˜ä½ç½®ï¼ˆæ¯”å¦‚ï¼Œä¸€æ—¦å†™äº†å°±é€šè¿‡ç³»ç»Ÿè°ƒç”¨è¿›è¡Œå†™ä¿æŠ¤çš„è™šæ‹Ÿå†…å­˜é¡µï¼‰ï¼Œè€Œä¸”è¯•å›¾æ˜ å°„æ‰å®ƒçš„å¸¸é‡æ€§ï¼Œæœ€å¤šï¼Œæ²¡æœ‰æ•ˆæœã€‚ å¦‚æœä½ æ˜¯ä¸€ä¸ªåšæŒéµå¾ªæ ‡å‡†æ‹Ÿå®šçš„è§„åˆ™çš„äººï¼Œä½ ç»ä¸ä¼šè¯•å›¾æ˜ å°„æ‰mapæˆ–multimapé”®çš„å¸¸é‡æ€§ã€‚ ","date":"2023-08-14","objectID":"/posts/clause_22/:4:0","tags":["Effective STL"],"title":"Effective STL [22] | é¿å…åŸåœ°ä¿®æ”¹setå’Œmultisetçš„é”®","uri":"/posts/clause_22/"},{"categories":["C++"],"content":"å®‰å…¨ä¿®æ”¹å…ƒç´ æ­¥éª¤ æƒ³è¦æ€»æ˜¯å¯ä»¥å·¥ä½œè€Œä¸”æ€»æ˜¯å®‰å…¨åœ°æ”¹å˜setã€multisetã€mapæˆ–multimapé‡Œçš„å…ƒç´ ï¼ŒæŒ‰5ä¸ªç®€å•çš„æ­¥éª¤å»åšï¼š å®šä½ä½ æƒ³è¦æ”¹å˜çš„å®¹å™¨å…ƒç´ ã€‚å¦‚æœä½ ä¸ç¡®å®šæœ€å¥½çš„æ–¹æ³•ï¼Œ æ¡æ¬¾45æä¾›äº†å…³äºæ€æ ·è¿›è¡Œé€‚å½“æœå¯»çš„æŒ‡å¯¼ã€‚ æ‹·è´ä¸€ä»½è¦è¢«ä¿®æ”¹çš„å…ƒç´ ã€‚å¯¹mapæˆ–multimapè€Œè¨€ï¼Œç¡®å®šä¸è¦æŠŠå‰¯æœ¬çš„ç¬¬ä¸€ä¸ªå…ƒç´ å£°æ˜ä¸ºconstã€‚æ¯•ç«Ÿï¼Œä½ æƒ³è¦æ”¹å˜å®ƒï¼ ä¿®æ”¹å‰¯æœ¬ï¼Œä½¿å®ƒæœ‰ä½ æƒ³è¦åœ¨å®¹å™¨é‡Œçš„å€¼ã€‚ ä»å®¹å™¨é‡Œåˆ é™¤å…ƒç´ ï¼Œé€šå¸¸é€šè¿‡è°ƒç”¨eraseï¼ˆå‚è§æ¡æ¬¾9ï¼‰ã€‚ æŠŠæ–°å€¼æ’å…¥å®¹å™¨ã€‚å¦‚æœæ–°å…ƒç´ åœ¨å®¹å™¨çš„æ’åºé¡ºåºä¸­çš„ä½ç½®æ­£å¥½ç›¸åŒæˆ–ç›¸é‚»äºåˆ é™¤çš„å…ƒç´ ï¼Œä½¿ç”¨insertçš„â€œæç¤ºâ€å½¢å¼æŠŠæ’å…¥çš„æ•ˆç‡ä»å¯¹æ•°æ—¶é—´æ”¹è¿›åˆ°åˆ†æ‘Šçš„å¸¸æ•°æ—¶é—´ã€‚ä½¿ç”¨ä½ ä»ç¬¬ä¸€æ­¥è·å¾—çš„è¿­ä»£å™¨ä½œä¸ºæç¤ºã€‚ ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼šå…ˆåˆ é™¤ï¼Œå†æ’å…¥æ–°çš„ã€‚ Example: è¿™æ˜¯åŒä¸€ä¸ªç´¯äººçš„é›‡å‘˜ä¾‹å­ï¼Œè¿™æ¬¡ä»¥å®‰å…¨ã€å¯ç§»æ¤çš„æ–¹å¼å†™: EmpIDSet se; // åŒå‰ï¼Œseæ˜¯ä¸€ä¸ªä»¥IDå·æ’åºçš„é›‡å‘˜set Employee selectedID; // åŒå‰ï¼ŒselectedIDæ˜¯ä¸€ä¸ªå¸¦æœ‰éœ€è¦IDå·çš„é›‡å‘˜ ... EmpIDSet::iterator i = se.find(selectedID); // ç¬¬ä¸€æ­¥ï¼šæ‰¾åˆ°è¦æ”¹å˜çš„å…ƒç´  if (i!=se.end()) { Employee e(*i); // ç¬¬äºŒæ­¥ï¼šæ‹·è´è¿™ä¸ªå…ƒç´  se.erase(i++); // ç¬¬ä¸‰æ­¥ï¼šåˆ é™¤è¿™ä¸ªå…ƒç´ ï¼› // è‡ªå¢è¿™ä¸ªè¿­ä»£å™¨ä»¥ // ä¿æŒå®ƒæœ‰æ•ˆï¼ˆå‚è§æ¡æ¬¾9ï¼‰ e.setTitle(\"Corporate Deity\"); // ç¬¬å››æ­¥ï¼šä¿®æ”¹è¿™ä¸ªå‰¯æœ¬ se.insert(i, e); // ç¬¬äº”æ­¥ï¼šæ’å…¥æ–°å€¼ï¼›æç¤ºå®ƒçš„ä½ç½®å’ŒåŸå…ˆå…ƒç´ çš„ä¸€æ · } ","date":"2023-08-14","objectID":"/posts/clause_22/:5:0","tags":["Effective STL"],"title":"Effective STL [22] | é¿å…åŸåœ°ä¿®æ”¹setå’Œmultisetçš„é”®","uri":"/posts/clause_22/"},{"categories":["C++"],"content":"Example set å»ºç«‹ä¸€ä¸ªsetï¼Œæ¯”è¾ƒç±»å‹ç”¨less_equalï¼Œç„¶åæ’å…¥æ•´å‹æ•°å­—33(ç§°ä¸º $33_{A}$): set\u003cint, less_equal\u003cint\u003e \u003e s; // sä»¥â€œ\u003c=â€æ’åº s.insert(33); // æ’å…¥33 ç°åœ¨å°è¯•å†æ’å…¥ä¸€æ¬¡33(ç§°ä¸º $33_{B}$): s.insert(33); å¯¹äºè¿™ä¸ªinsertçš„è°ƒç”¨ï¼Œsetå¿…é¡»å…ˆè¦åˆ¤æ–­å‡º $33_{A}$ æ˜¯å¦å·²ç»ä½äºå…¶ä¸­äº†ï¼ŒæŸ¥æ‰¾å“ªå„¿é€‚åˆæ’å…¥ $33_{B}$ã€‚æœ€ç»ˆï¼Œå®ƒæ€»è¦æ£€æŸ¥ $33_{B}$æ˜¯å¦ä¸ $33_{A}$ ç›¸åŒã€‚ å…³è”å®¹å™¨å¯¹â€œç›¸åŒâ€çš„å®šä¹‰æ˜¯ç­‰ä»·ï¼Œå› æ­¤setæµ‹è¯• $33_{B}$æ˜¯å¦ç­‰ä»·äº $33_{A}$ã€‚ å½“æ‰§è¡Œè¿™ä¸ªæµ‹è¯•æ—¶ï¼Œå®ƒè‡ªç„¶æ˜¯ä½¿ç”¨setçš„æ¯”è¾ƒå‡½æ•°ã€‚åœ¨è¿™ä¸€ä¾‹å­é‡Œï¼Œæ˜¯operator\u003c=ï¼Œå› ä¸ºæˆ‘ä»¬æŒ‡å®šsetçš„æ¯”è¾ƒå‡½æ•°ä¸ºless_equalï¼Œè€Œless_equalæ„æ€å°±æ˜¯operator\u003c=ã€‚ å¯ä»¥çœ‹çœ‹less_equalçš„æºç å®ç°ï¼š /// One of the @link comparison_functors comparison functors@endlink. template\u003ctypename _Tp\u003e struct less_equal : public binary_function\u003c_Tp, _Tp, bool\u003e { _GLIBCXX14_CONSTEXPR bool operator()(const _Tp\u0026 __x, const _Tp\u0026 __y) const { return __x \u003c= __y; } // æ­¤å¤„æ˜¯ \u003c= }; äºæ˜¯ï¼Œsetå°†è®¡ç®—è¿™ä¸ªè¡¨è¾¾å¼æ˜¯å¦ä¸ºçœŸ: !(33A \u003c= 33B) \u0026\u0026 !(33B \u003c= 33A) // æµ‹è¯•33Aå’Œ33Bæ˜¯å¦ç­‰ä»· $33_{A}$ å’Œ $33_{B}$ éƒ½æ˜¯33ï¼Œå› æ­¤ï¼Œ $33_{A}$\u003c=$33_{B}$ è‚¯å®šä¸ºçœŸã€‚åŒæ ·æ¸…æ¥šçš„æ˜¯ï¼Œ$33_{B}$ \u003c= $33_{A}$ã€‚äºæ˜¯ä¸Šè¿°çš„è¡¨è¾¾å¼ç®€åŒ–ä¸º: !(true) \u0026\u0026 !(true) å†ç®€åŒ–å°±æ˜¯ false \u0026\u0026 false ç»“æœå½“ç„¶æ˜¯falseã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œsetå¾—å‡ºçš„ç»“è®ºæ˜¯ $33_{B}$ ä¸ $33_{B}$ ä¸ç­‰ä»·ï¼Œå› æ­¤ä¸ä¸€æ ·ï¼Œäºæ˜¯å®ƒå°† $33_{B}$ æ’å…¥å®¹å™¨ä¸­çš„æ—è¾¹ã€‚ åœ¨æŠ€æœ¯ä¸Šè€Œè¨€ï¼Œè¿™ä¸ªåšæ³•å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºï¼Œä½†æ˜¯é€šå¸¸çš„ç»“æœæ˜¯setä»¥æ‹¥æœ‰äº†ä¸¤ä¸ªä¸º33çš„å€¼çš„æ‹·è´è€Œå‘Šç»ˆï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¸å†æ˜¯ä¸€ä¸ªsetäº†ã€‚é€šè¿‡ä½¿ç”¨less_equalä½œä¸ºæˆ‘ä»¬çš„æ¯”è¾ƒç±»å‹ï¼Œæˆ‘ä»¬ç ´åäº†å®¹å™¨ï¼ æµ‹è¯• template\u003ctypename T\u003e void print(const T t) { cout \u003c\u003c t \u003c\u003c endl; } int main(int argc, char** argv) { set\u003cint, less_equal\u003cint\u003e \u003e snumber; snumber.insert(33); snumber.insert(33); for_each(snumber.begin(), snumber.end(), print\u003cint\u003e); } ç»“æœ: 33 33 ","date":"2023-08-11","objectID":"/posts/clause_21/:1:0","tags":["Effective STL"],"title":"Effective STL [21] | æ°¸è¿œè®©æ¯”è¾ƒå‡½æ•°å¯¹ç›¸ç­‰çš„å€¼è¿”å›false","uri":"/posts/clause_21/"},{"categories":["C++"],"content":"Example string* æ¡æ¬¾20æè¿°äº†è¯¥å¦‚ä½•å†™ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ä»¥ä½¿å¾—å®¹çº³string*æŒ‡é’ˆçš„å®¹å™¨æ ¹æ®stringçš„å€¼æ’åºï¼Œè€Œä¸æ˜¯å¯¹æŒ‡é’ˆçš„å€¼æ’åºã€‚é‚£ä¸ªæ¯”è¾ƒå‡½æ•°æ˜¯æŒ‰å‡åºæ’åºçš„ï¼Œä½†ç°åœ¨å‡è®¾ä½ éœ€è¦string*æŒ‡é’ˆçš„å®¹å™¨çš„é™åºæ’åºçš„æ¯”è¾ƒå‡½æ•°ã€‚ è‡ªç„¶æ˜¯æŠ“ç°æˆçš„ä»£ç æ¥ä¿®æ”¹äº†ã€‚å¦‚æœä¸ç»†å¿ƒï¼Œå¯èƒ½ä¼šè¿™ä¹ˆå¹²: struct StringPtrGreater: public binary_function\u003cconst string*, const string*, bool\u003e { // è¿™ä»£ç æ˜¯æœ‰ç‘•ç–µçš„ï¼ bool operator()(const string *ps1, const string *ps2) const { return !(*ps1 \u003c *ps2); // åªæ˜¯ç›¸åäº†æ—§çš„æµ‹è¯•ï¼›è¿™æ˜¯ä¸å¯¹çš„ï¼ } }; è¿™é‡Œçš„æƒ³æ³•æ˜¯é€šè¿‡å°†æ¯”è¾ƒå‡½æ•°å†…éƒ¨ç»“æœå–åæ¥è¾¾åˆ°ååºçš„ç»“æœã€‚å¾ˆä¸å¹¸ï¼Œå–åâ€œ\u003câ€ä¸ä¼šç»™ä½ ï¼ˆä½ æ‰€æœŸæœ›çš„ï¼‰â€œ\u003eâ€ï¼Œå®ƒç»™ä½ çš„æ˜¯ â€œ\u003e=â€ã€‚ è€Œä½ ç°åœ¨çŸ¥é“ï¼Œå› ä¸ºå®ƒå°†å¯¹ç›¸ç­‰çš„å€¼è¿”å›trueï¼Œå¯¹å…³è”å®¹å™¨æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ— æ•ˆçš„æ¯”è¾ƒå‡½æ•°ã€‚ ä½ çœŸæ­£éœ€è¦çš„æ¯”è¾ƒç±»å‹æ˜¯è¿™ä¸ª: struct StringPtrGreater: // å¯¹å…³è”å®¹å™¨æ¥è¯´è¿™æ˜¯æœ‰æ•ˆçš„æ¯”è¾ƒç±»å‹ public binary_function\u003cconst string*, const string*, bool\u003e { bool operator()(const string *ps1, const string *ps2) const { return *ps2 \u003c *ps1; // è¿”å›*ps2æ˜¯å¦å¤§äº*ps1ï¼ˆä¹Ÿå°±æ˜¯äº¤æ¢æ“ä½œæ•°çš„é¡ºåºï¼‰ } }; è¦é¿å…æ‰å…¥è¿™ä¸ªé™·é˜±ï¼Œä½ æ‰€è¦è®°ä½çš„å°±æ˜¯æ¯”è¾ƒå‡½æ•°çš„è¿”å›å€¼è¡¨æ˜çš„æ˜¯åœ¨æ­¤å‡½æ•°å®šä¹‰çš„æ’åºæ–¹å¼ä¸‹ï¼Œä¸€ä¸ªå€¼æ˜¯å¦å¤§äºå¦ä¸€ä¸ªã€‚ ç›¸ç­‰çš„å€¼ç»ä¸è¯¥ä¸€ä¸ªå¤§äºå¦ä¸€ä¸ªï¼Œæ‰€ä»¥æ¯”è¾ƒå‡½æ•°æ€»åº”è¯¥å¯¹ç›¸ç­‰çš„å€¼è¿”å›false ","date":"2023-08-11","objectID":"/posts/clause_21/:2:0","tags":["Effective STL"],"title":"Effective STL [21] | æ°¸è¿œè®©æ¯”è¾ƒå‡½æ•°å¯¹ç›¸ç­‰çš„å€¼è¿”å›false","uri":"/posts/clause_21/"},{"categories":["C++"],"content":"Example multiset multisetå’Œmultimapé‚£äº›å®¹å™¨å¯ä»¥å®¹çº³å¤æœ¬å¯èƒ½åŒ…å«å‰¯æœ¬ï¼Œå¦‚æœå®¹å™¨è®¤ä¸ºä¸¤ä¸ªå€¼ç›¸ç­‰çš„å¯¹è±¡ä¸ç­‰ä»·ï¼Œå®ƒå°†ä¼šæŠŠä¸¤ä¸ªéƒ½å­˜å‚¨è¿›å»çš„ï¼Œè¿™æ­£æ˜¯multiç³»åˆ—å®¹å™¨çš„æ‰€è¦æ”¯æŒçš„äº‹æƒ…ã€‚ multiset\u003cint, less_equal\u003cint\u003e \u003e msnum; // ä»ç„¶ä»¥â€œ\u003c=â€æ’åº msnum.insert(22); // æ’å…¥22A msnum.insert(22); // æ’å…¥22B for_each(msnum.begin(), msnum.end(), print\u003cint\u003e); ç»“æœ: 22 22 sé‡Œæœ‰ä¸¤ä¸ª22çš„æ‹·è´ï¼Œå› æ­¤æˆ‘ä»¬æœŸæœ›å¦‚æœæˆ‘ä»¬åœ¨å®ƒä¸Šé¢åšä¸€ä¸ªequal_rangeï¼Œæˆ‘ä»¬å°†ä¼šå¾—åˆ°ä¸€å¯¹æŒ‡å‡ºåŒ…å«è¿™ä¸¤ä¸ªæ‹·è´çš„èŒƒå›´çš„è¿­ä»£å™¨ã€‚ä½†é‚£æ˜¯ä¸å¯èƒ½çš„ã€‚ equal_rangeï¼Œè™½ç„¶å«è¿™ä¸ªåå­—ï¼Œä½†ä¸æ˜¯æŒ‡ç¤ºå‡ºç›¸ç­‰çš„å€¼çš„èŒƒå›´ï¼Œè€Œæ˜¯ç­‰ä»·çš„å€¼çš„èŒƒå›´ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œsçš„æ¯”è¾ƒå‡½æ•°è¯´22Aå’Œ22Bæ˜¯ä¸ç­‰ä»·çš„ï¼Œæ‰€ä»¥ä¸å¯èƒ½è®©å®ƒä»¬åŒæ—¶å‡ºç°åœ¨equal_rangeæ‰€æŒ‡ç¤ºçš„èŒƒå›´å†…ã€‚ pair\u003cmultiset\u003cint\u003e::iterator, multiset\u003cint\u003e::iterator\u003e range2; //åœ¨ myvector å®¹å™¨ä¸­æ‰¾åˆ°æ‰€æœ‰çš„å…ƒç´  22 range2 = equal_range(msnum.begin(), msnum.end(), 22, less_equal\u003cint\u003e{}); cout \u003c\u003c \"\\nmy multisetï¼š\"; for (auto it = range2.first; it != range2.second; ++it) { cout \u003c\u003c *it \u003c\u003c \" \"; } ç»“æœæ²¡æœ‰å¾—åˆ°æœŸæœ›ç»“æœ: my multiset: å¦‚æœæ”¹ä¸ºlessæ¯”è¾ƒ: range2 = equal_range(msnum.begin(), msnum.end(), 22, less\u003cint\u003e{}); ç»“æœ: my multisetï¼š22 22 é™¤éä½ çš„æ¯”è¾ƒå‡½æ•°æ€»æ˜¯ä¸ºç›¸ç­‰çš„å€¼è¿”å›falseï¼Œä½ å°†ä¼šæ‰“ç ´æ‰€æœ‰çš„æ ‡å‡†å…³è”å‹å®¹å™¨ï¼Œä¸ç®¡å®ƒä»¬æ˜¯å¦å…è®¸å­˜å‚¨å¤æœ¬ã€‚ ","date":"2023-08-11","objectID":"/posts/clause_21/:3:0","tags":["Effective STL"],"title":"Effective STL [21] | æ°¸è¿œè®©æ¯”è¾ƒå‡½æ•°å¯¹ç›¸ç­‰çš„å€¼è¿”å›false","uri":"/posts/clause_21/"},{"categories":["C++"],"content":"æ€»ç»“ ä»æŠ€æœ¯ä¸Šè¯´ï¼Œç”¨äºæ’åºå…³è”å®¹å™¨çš„æ¯”è¾ƒå‡½æ•°å¿…é¡»åœ¨å®ƒä»¬æ‰€æ¯”è¾ƒçš„å¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªâ€œä¸¥æ ¼çš„å¼±åºåŒ–(strict weakordering)â€ã€‚ï¼ˆä¼ ç»™sortç­‰ç®—æ³•ï¼ˆå‚è§æ¡æ¬¾31ï¼‰çš„æ¯”è¾ƒå‡½æ•°ä¹Ÿæœ‰åŒæ ·çš„é™åˆ¶ï¼‰ã€‚ ä»»ä½•ä¸€ä¸ªå®šä¹‰äº†ä¸¥æ ¼çš„å¼±åºåŒ–çš„å‡½æ•°éƒ½å¿…é¡»åœ¨ä¼ å…¥ç›¸åŒçš„å€¼çš„ä¸¤ä¸ªæ‹·è´æ—¶è¿”å›falseã€‚ ","date":"2023-08-11","objectID":"/posts/clause_21/:4:0","tags":["Effective STL"],"title":"Effective STL [21] | æ°¸è¿œè®©æ¯”è¾ƒå‡½æ•°å¯¹ç›¸ç­‰çš„å€¼è¿”å›false","uri":"/posts/clause_21/"},{"categories":["C++"],"content":"Example å‡å®šä½ æœ‰ä¸€ä¸ªstring*æŒ‡é’ˆçš„setï¼Œä½ æŠŠä¸€äº›åŠ¨ç‰©çš„åå­—æ’å…¥è¿›set: set\u003cstring*\u003e ssp; ssp.insert(new string(\"Anteater\")); ssp.insert(new string(\"Wombat\")); ssp.insert(new string(\"Lemur\")); ssp.insert(new string(\"Penguin\")); // ssp = â€œset of string ptrsâ€ ç„¶åä½ å†™äº†ä¸‹åˆ—ä»£ç æ‰“å°setçš„å†…å®¹ï¼Œå¸Œæœ›å­—ç¬¦ä¸²æŒ‰å­—æ¯é¡ºåºå‡ºç°ã€‚æ¯•ç«Ÿï¼Œç¡®å®šsetä¿æŒå®ƒä»¬çš„å†…å®¹æœ‰åºã€‚ for (set\u003cstring*\u003e::const_iterator i = ssp.begin();i != ssp.end();++i) { cout \u003c\u003c *i \u003c\u003c endl; } ä½ æœŸæœ›çœ‹åˆ° Anteater Wombat Lemur Penguin å®é™…è¿è¡Œç»“æœ: 0x5566364b5eb0 0x5566364b5f10 0x5566364b5f70 0x5566364b5fd0 ç»“æœæ˜¯4ä¸ªåå…­è¿›åˆ¶çš„æ•°ï¼Œä»£è¡¨æŒ‡é’ˆçš„å€¼ã€‚ å› ä¸ºsetå®¹çº³æŒ‡é’ˆï¼Œ*iä¸æ˜¯ä¸€ä¸ªstringï¼Œæ˜¯ä¸€ä¸ªstringçš„æŒ‡é’ˆã€‚ å¦‚æœä½ å·²ç»æ”¹ä¸ºè°ƒç”¨copyç®—æ³•ï¼Œ copy(ssp.begin(), ssp.end(), ostream_iterator\u003cstring\u003e(cout, \"\\n\"));// æŠŠsspä¸­çš„å­—ç¬¦ä¸²æ‹·è´åˆ°coutï¼ˆä½†è¿™ä¸èƒ½ç¼–è¯‘ï¼‰ è¿™ä¸ªcopyçš„è°ƒç”¨å°†ä¸èƒ½ç¼–è¯‘ï¼Œå› ä¸ºostream_iteratoréœ€è¦çŸ¥é“è¢«æ‰“å°çš„å¯¹è±¡çš„ç±»å‹ï¼Œæ‰€ä»¥å½“ä½ å‘Šè¯‰å®ƒæ˜¯ä¸€ä¸ªstringæ—¶ï¼ˆé€šè¿‡ä½œä¸ºæ¨¡æ¿å‚æ•°ä¼ é€’ï¼‰ï¼Œç¼–è¯‘å™¨æ£€æµ‹åˆ°é‚£å’Œsspä¸­å‚¨å­˜çš„å¯¹è±¡ç±»å‹(æ˜¯string*)ä¹‹é—´ä¸åŒ¹é…ï¼Œå®ƒä»¬ä¼šæ‹’ç»ç¼–è¯‘ä»£ç ã€‚ æŠŠæ˜¾å¼å¾ªç¯ä¸­çš„*iæ”¹ä¸º**iï¼Œä½ å¯èƒ½å¯ä»¥å¾—åˆ°ä½ æƒ³è¦çš„è¾“å‡ºï¼Œä½†ä¹Ÿå¯èƒ½ä¸ã€‚åŠ¨ç‰©åå­—å°†è¢«æ‰“å°ï¼Œä½†å®ƒä»¬æŒ‰å­—æ¯é¡ºåºå‡ºç°çš„æœºä¼šåªæ˜¯24ä»½ä¹‹1ã€‚sspä¿æŒå®ƒçš„å†…å®¹æœ‰åºï¼Œä½†æ˜¯å®ƒå®¹çº³çš„æ˜¯æŒ‡é’ˆï¼Œæ‰€ä»¥å®ƒä»¥æŒ‡é’ˆçš„å€¼æ’åºï¼Œè€Œä¸ä»¥stringå€¼ã€‚å¯¹äºå››ä¸ªæŒ‡é’ˆå€¼å¯èƒ½æœ‰24ç§æ’åˆ—ï¼ˆï¼‰ï¼Œæ‰€ä»¥æŒ‡é’ˆè¢«å‚¨å­˜æ—¶æœ‰24ç§å¯èƒ½çš„é¡ºåºã€‚å› æ­¤ä½ çœ‹è§å­—ç¬¦ä¸²æŒ‰å­—æ¯æ’åºæœ‰24ä»½ä¹‹1çš„å‡ ç‡ã€‚ æˆ–è€…æ‰“å° *stringçš„char*æ•°ç»„ for (set\u003cstring*\u003e::const_iterator i = ssp.begin(); i != ssp.end(); ++i) { cout \u003c\u003c (*i)-\u003ec_str() \u003c\u003c endl; } ","date":"2023-08-11","objectID":"/posts/clause_20/:1:0","tags":["Effective STL"],"title":"Effective STL [20] | ä¸ºæŒ‡é’ˆçš„å…³è”å®¹å™¨æŒ‡å®šæ¯”è¾ƒç±»å‹","uri":"/posts/clause_20/"},{"categories":["C++"],"content":"Solution å½“æˆ‘ä»¬å†™ä¸‹set\u003cstring*\u003e ssp;ï¼Œå…¶å®çœç•¥äº†ä¸€ä¸ªé»˜è®¤å‚æ•°set\u003cstring*, less\u003cstring*\u003e \u003e ssp;ï¼Œå®é™…ä¸Šè¿˜æœ‰ä¸ªé»˜è®¤å‚æ•°: set\u003cstring*, less\u003cstring*\u003e, allocator\u003cstring*\u003e \u003e ssp; ","date":"2023-08-11","objectID":"/posts/clause_20/:2:0","tags":["Effective STL"],"title":"Effective STL [20] | ä¸ºæŒ‡é’ˆçš„å…³è”å®¹å™¨æŒ‡å®šæ¯”è¾ƒç±»å‹","uri":"/posts/clause_20/"},{"categories":["C++"],"content":"è‡ªå®šä¹‰ä»¿å‡½æ•° å¦‚æœæƒ³è¦string*æŒ‡é’ˆä»¥å­—ç¬¦ä¸²å€¼ç¡®å®šé¡ºåºè¢«å‚¨å­˜åœ¨setä¸­ï¼Œä¸èƒ½ä½¿ç”¨é»˜è®¤æ¯”è¾ƒä»¿å‡½æ•°ç±»less\u003cstring*\u003eã€‚ å¿…é¡»æ”¹ä¸ºå†™è‡ªå·±çš„æ¯”è¾ƒä»¿å‡½æ•°ç±»ï¼Œå®ƒçš„å¯¹è±¡å¸¦æœ‰string*æŒ‡é’ˆå¹¶æŒ‰ç…§æŒ‡å‘çš„å­—ç¬¦ä¸²å€¼æ¥è¿›è¡Œæ’åº: struct StringPtrLess: public binary_function\u003cconst string*, const string*, bool\u003e { bool operator()(const string *ps1, const string *ps2) const { return *ps1 \u003c *ps2; } }; ç„¶åå¯ä»¥ä½¿ç”¨StringPtrLessä½œä¸ºsspçš„æ¯”è¾ƒç±»å‹: typedef set\u003cstring*, StringPtrLess\u003e StringPtrSet; StringPtrSet ssp; // å»ºç«‹å­—ç¬¦ä¸²çš„é›†åˆï¼Œ // æŒ‰ç…§StringPtrLesså®šä¹‰çš„é¡ºåºæ’åº ... // å’Œå‰é¢ä¸€æ ·æ’å…¥ // åŒæ ·å››ä¸ªå­—ç¬¦ä¸² ç°åœ¨å¾ªç¯æœ€åå°†åšæƒ³è¦å®ƒåšçš„ï¼ˆä¹Ÿå°±æ˜¯å‰é¢ä½ ä½¿ç”¨*iä»£æ›¿**iæ‰€ä¿®æ­£çš„é—®é¢˜ï¼‰: for (StringPtrSet::const_iterator i = ssp.begin(); i != ssp.end(); ++i) { cout \u003c\u003c **i \u003c\u003c endl; } æŒ‡é’ˆä¹‹å‰å¯¹å®ƒä»¬è§£å¼•ç”¨çš„å‡½æ•°ï¼Œç„¶åå’Œfor_eachè”ç”¨é‚£ä¸ªå‡½æ•°: void print(const string *ps) { cout \u003c\u003c *ps \u003c\u003c endl; } for_each(ssp.begin(), ssp.end(), print);// åœ¨sspä¸­çš„æ¯ä¸ªå…ƒç´ ä¸Šè°ƒç”¨print æˆ–è€…ä½ æƒ³è±¡å¹¶å†™å‡ºäº†æ³›å‹çš„è§£å¼•ç”¨ä»¿å‡½æ•°ç±»ï¼Œç„¶åè®©å®ƒå’Œtransformä¸ostream_iteratorè¿ç”¨: // å½“æœ¬ç±»å‹çš„ä»¿å‡½æ•°è¢«ä¼ å…¥ä¸€ä¸ªT*æ—¶ï¼Œå®ƒä»¬è¿”å›ä¸€ä¸ªconst T\u0026 struct Dereference { template \u003ctypename T\u003e const T\u0026 operator()(const T *ptr) const { return *ptr; } }; // é€šè¿‡è§£å¼•ç”¨â€œè½¬æ¢â€ sspä¸­çš„æ¯ä¸ªå…ƒç´ ï¼ŒæŠŠç»“æœå†™å…¥cout transform(ssp.begin(), ssp.end(), ostream_iterator\u003cstring\u003e(cout, \"\\n\"), Dereference()); è¦ç‚¹æ˜¯æ— è®ºä½•æ—¶ä½ å»ºç«‹ä¸€ä¸ªæŒ‡é’ˆçš„æ ‡å‡†å…³è”å®¹å™¨ï¼Œä½ å¿…é¡»è®°ä½å®¹å™¨ä¼šä»¥æŒ‡é’ˆçš„å€¼æ’åºã€‚è¿™åŸºæœ¬ä¸Šä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œæ‰€ä»¥ä½ å‡ ä¹æ€»æ˜¯éœ€è¦å»ºç«‹è‡ªå·±çš„ä»¿å‡½æ•°ç±»ä½œä¸ºæ¯”è¾ƒç±»å‹ã€‚ æ¯”è¾ƒç±»å‹ vs æ¯”è¾ƒå‡½æ•° æ³¨æ„åˆ°è¿™é‡Œå†™çš„æ˜¯â€œæ¯”è¾ƒç±»å‹â€ã€‚ ä½ å¯èƒ½å¥‡æ€ªä¸ºä»€ä¹ˆå¿…é¡»ç‰¹æ„åˆ›é€ ä¸€ä¸ªä»¿å‡½æ•°ç±»è€Œä¸æ˜¯ç®€å•åœ°ä¸ºsetå†™ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°: bool stringPtrLess(const string* ps1, const string* ps2) { // å°†æˆä¸ºç”¨äºæŒ‰å­—ç¬¦ä¸²å€¼æ’åºçš„string*æŒ‡é’ˆçš„æ¯”è¾ƒå‡½æ•° return *ps1 \u003c *ps2; } set\u003cstring*, stringPtrLess\u003e ssp;// å‡è®¾ä½¿ç”¨stringPtrLess ä½œä¸ºsspçš„æ¯”è¾ƒå‡½æ•°ï¼› // è¿™ä¸èƒ½ç¼–è¯‘ è¿™é‡Œçš„é—®é¢˜æ˜¯æ¯ä¸ªsetæ¨¡æ¿çš„ç¬¬ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯ä¸€ç§ç±»å‹ï¼Œè€ŒstringPtrLessä¸æ˜¯ä¸€ç§ç±»å‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°è¯•ä½¿ç”¨stringPtrLessä½œä¸ºsetçš„æ¯”è¾ƒå‡½æ•°ä¸èƒ½ç¼–è¯‘çš„åŸå› ï¼Œsetä¸è¦ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¦çš„æ˜¯èƒ½åœ¨å†…éƒ¨ç”¨å®ä¾‹åŒ–å»ºç«‹å‡½æ•°çš„ä¸€ç§ç±»å‹ã€‚ æ— è®ºä½•æ—¶ä½ å»ºç«‹æŒ‡é’ˆçš„å…³è”å®¹å™¨ï¼Œæ³¨æ„ä½ ä¹Ÿå¾—æŒ‡å®šå®¹å™¨çš„æ¯”è¾ƒç±»å‹ã€‚ å¤§å¤šæ•°æ—¶å€™ï¼Œä½ çš„æ¯”è¾ƒç±»å‹åªæ˜¯è§£å¼•ç”¨æŒ‡é’ˆå¹¶æ¯”è¾ƒæ‰€æŒ‡å‘çš„å¯¹è±¡ï¼ˆå°±åƒä¸Šé¢çš„StringPtrLessåšçš„é‚£æ ·ï¼‰ã€‚ é‰´äºè¿™ç§æƒ…å†µï¼Œä½ æ‰‹å¤´æœ€å¥½ä¹Ÿèƒ½æœ‰ä¸€ä¸ªç”¨äºé‚£ç§æ¯”è¾ƒçš„ä»¿å‡½æ•°æ¨¡æ¿ã€‚åƒè¿™æ ·: struct DereferenceLess { template \u003ctypename PtrType\u003e bool operator()(PtrType pT1, PtrType pT2) const { // å‚æ•°æ˜¯å€¼ä¼ é€’çš„å› ä¸ºæˆ‘ä»¬å¸Œæœ›å®ƒä»¬æ˜¯ï¼ˆæˆ–è¡Œä¸ºåƒï¼‰æŒ‡é’ˆ return *pT1 \u003c *pT2; } }; è¿™æ ·çš„æ¨¡æ¿æ¶ˆé™¤äº†å†™åƒStringPtrLessé‚£æ ·çš„ç±»çš„éœ€è¦ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ”¹ä¸ºä½¿ç”¨DereferenceLess: set\u003cstring*, DereferenceLess\u003e ssp; // è¡Œä¸ºå°±åƒ set\u003cstring*, StringPtrLess\u003e ","date":"2023-08-11","objectID":"/posts/clause_20/:3:0","tags":["Effective STL"],"title":"Effective STL [20] | ä¸ºæŒ‡é’ˆçš„å…³è”å®¹å™¨æŒ‡å®šæ¯”è¾ƒç±»å‹","uri":"/posts/clause_20/"},{"categories":["C++"],"content":"æ€»ç»“ æœ¬æ¡æ¬¾æ˜¯å…³äºæŒ‡é’ˆçš„å…³è”å®¹å™¨ï¼Œä½†å®ƒä¹Ÿå¯ä»¥åº”ç”¨äºè¡¨ç°ä¸ºæŒ‡é’ˆçš„å¯¹è±¡çš„å®¹å™¨ï¼Œä¾‹å¦‚ï¼Œæ™ºèƒ½æŒ‡é’ˆå’Œè¿­ä»£å™¨ã€‚ å¦‚æœä½ æœ‰ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆæˆ–è¿­ä»£å™¨çš„å…³è”å®¹å™¨ï¼Œé‚£ä¹Ÿå¾—ä¸ºå®ƒæŒ‡å®šæ¯”è¾ƒç±»å‹ã€‚å¹¸è¿çš„æ˜¯ï¼ŒæŒ‡é’ˆçš„è¿™ä¸ªè§£å†³æ–¹æ¡ˆä¹Ÿå¯ä»¥ç”¨äºç±»ä¼¼æŒ‡é’ˆçš„å¯¹è±¡ã€‚æ­£å¦‚DereferenceLessé€‚åˆä½œä¸ºT*çš„å…³è”å®¹å™¨çš„æ¯”è¾ƒç±»å‹ä¸€æ ·ï¼Œå®ƒä¹Ÿ å¯ä»¥ä½œä¸ºTå¯¹è±¡çš„è¿­ä»£å™¨å’Œæ™ºèƒ½æŒ‡é’ˆå®¹å™¨çš„æ¯”è¾ƒç±»å‹ã€‚ å®é™…ä¸Šï¼Œè¿™24ç§æ’åˆ—å¾ˆå¯èƒ½ä¸æ˜¯å¹³ç­‰çš„ï¼Œæ‰€ä»¥â€œ24ä»½ä¹‹1â€çš„é™ˆè¿°æœ‰ç‚¹ä½¿äººè¯¯è§£ã€‚ç¡®å®ï¼Œæœ‰24ä¸ªä¸åŒçš„é¡ºåºï¼Œè€Œä¸”ä½ å¯èƒ½å¾—åˆ°å®ƒä»¬ä¸­çš„ä»»ä½•ä¸€ä¸ªã€‚ ","date":"2023-08-11","objectID":"/posts/clause_20/:4:0","tags":["Effective STL"],"title":"Effective STL [20] | ä¸ºæŒ‡é’ˆçš„å…³è”å®¹å™¨æŒ‡å®šæ¯”è¾ƒç±»å‹","uri":"/posts/clause_20/"},{"categories":["C++"],"content":"æ¯”è¾ƒå¯¹è±¡ STLå……æ»¡äº†æ¯”è¾ƒå¯¹è±¡æ˜¯å¦æœ‰åŒæ ·çš„å€¼ã€‚æ¯”å¦‚ï¼Œå½“ä½ ç”¨findæ¥å®šä½åŒºé—´ä¸­ç¬¬ä¸€ä¸ªæœ‰ç‰¹å®šå€¼çš„å¯¹è±¡çš„ä½ç½®ï¼Œfindå¿…é¡»å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ï¼Œçœ‹çœ‹ä¸€ä¸ªçš„å€¼æ˜¯å¦ä¸å¦ä¸€ä¸ªç›¸ç­‰ã€‚åŒæ ·ï¼Œå½“ä½ å°è¯•å‘setä¸­æ’å…¥ä¸€ä¸ªæ–°å…ƒç´ æ—¶ï¼Œset::insertå¿…é¡»å¯ä»¥åˆ¤æ–­é‚£ä¸ªå…ƒç´ çš„å€¼æ˜¯å¦å·²ç»åœ¨setä¸­äº†ã€‚ findç®—æ³•å’Œsetçš„insertæˆå‘˜å‡½æ•°æ˜¯å¾ˆå¤šå¿…é¡»åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒçš„å‡½æ•°çš„ä»£è¡¨ã€‚ä½†å®ƒä»¬å®ç°æ–¹å¼ä¸åŒï¼Œfindå¯¹â€œç›¸åŒâ€çš„å®šä¹‰æ˜¯ç›¸ç­‰ï¼ŒåŸºäºoperator==ã€‚set::insertå¯¹â€œç›¸åŒâ€çš„å®šä¹‰æ˜¯ç­‰ä»·ï¼Œé€šå¸¸åŸºäºoperator\u003cã€‚å› ä¸ºæœ‰å®šä¹‰ä¸åŒï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¸€ä¸ªå®šä¹‰è§„å®šäº†ä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„å€¼è€Œå¦ä¸€ä¸ªå®šä¹‰åˆ¤å®šå®ƒä»¬æ²¡æœ‰ã€‚ç»“æœï¼Œå¦‚æœä½ æƒ³æœ‰æ•ˆä½¿ç”¨STLï¼Œé‚£ä¹ˆä½ å¿…é¡»æ˜ç™½ç›¸ç­‰å’Œç­‰ä»·çš„åŒºåˆ«ã€‚ ç›¸ç­‰ æ“ä½œä¸Šæ¥è¯´ï¼Œç›¸ç­‰çš„æ¦‚å¿µæ˜¯åŸºäºoperatorçš„ã€‚å¦‚æœè¡¨è¾¾å¼â€œx == yâ€è¿”å›trueï¼Œxå’Œyæœ‰ç›¸ç­‰çš„å€¼ï¼Œå¦åˆ™å®ƒä»¬æ²¡æœ‰ã€‚ xå’Œyæœ‰ç›¸ç­‰çš„å€¼å¹¶ä¸æ„å‘³ç€æ‰€æœ‰å®ƒä»¬çš„æˆå‘˜æœ‰ç›¸ç­‰çš„å€¼ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªå†…éƒ¨è®°å½•äº†æœ€åä¸€æ¬¡è®¿é—®çš„Widgetç±»ã€‚ class Widget { public: ... private: TimeStamp lastAccessed; ... }; æˆ‘ä»¬å¯ä»¥æœ‰ä¸€ä¸ªç”¨äºWidgetçš„å¿½ç•¥è¿™ä¸ªåŸŸçš„operator: bool operator(const Widget\u0026 lhs, const Widget\u0026 rhs) { // å¿½ç•¥lastAccessedåŸŸçš„ä»£ç  } åœ¨è¿™é‡Œï¼Œä¸¤ä¸ªWidgetå³ä½¿å®ƒä»¬çš„lastAccessedåŸŸä¸åŒä¹Ÿå¯ä»¥æœ‰ç›¸ç­‰çš„å€¼ã€‚ ä¸€èˆ¬è€Œè¨€ï¼Œç›¸ç­‰æ„å‘³ç€ä¸¤ä¸ªå˜é‡çš„å€¼ç›¸åŒï¼Œä½†æ˜¯å¦‚æœæ¯”è¾ƒ2ä¸ªå¯¹è±¡ï¼Œå› ä¸ºæ¯”è¾ƒå‡½æ•°å¯ä»¥è‡ªå®šä¹‰ï¼Œå› æ­¤æœ‰æ—¶å€™å¯¹è±¡çš„æŸäº›æˆå‘˜å˜é‡å€¼ä¸åŒä¹Ÿä¼šè®¾å®š2ä¸ªå¯¹è±¡ç›¸ç­‰ã€‚ ç­‰ä»· ==ç­‰ä»·æ˜¯åŸºäºåœ¨ä¸€ä¸ªæœ‰åºåŒºé—´ä¸­å¯¹è±¡å€¼çš„ç›¸å¯¹ä½ç½®==ã€‚ ç­‰ä»·ä¸€èˆ¬åœ¨æ¯ç§æ ‡å‡†å…³è”å®¹å™¨ï¼ˆæ¯”å¦‚ï¼Œsetã€multisetã€mapå’Œmultimapï¼‰çš„ä¸€éƒ¨åˆ†â€”â€”æ’åºé¡ºåºæ–¹é¢æœ‰æ„ä¹‰ã€‚æ³¨æ„è¿™é‡Œçš„åº”ç”¨åœºæ™¯æ˜¯==æ’åº==ã€‚ ä¸¤ä¸ªå¯¹è±¡xå’Œyå¦‚æœåœ¨å…³è”å®¹å™¨cçš„æ’åºé¡ºåºä¸­æ²¡æœ‰å“ªä¸ªæ’åœ¨å¦ä¸€ä¸ªä¹‹å‰ï¼Œé‚£ä¹ˆå®ƒä»¬å…³äºcä½¿ç”¨çš„æ’åºé¡ºåºæœ‰ç­‰ä»·çš„å€¼ã€‚ ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œä¸€ä¸ªset sã€‚ä¸¤ä¸ªWidget w1å’Œw2ï¼Œå¦‚æœåœ¨sçš„æ’åºé¡ºåºä¸­æ²¡æœ‰å“ªä¸ªåœ¨å¦ä¸€ä¸ªä¹‹å‰ï¼Œé‚£ä¹ˆå…³äºså®ƒä»¬æœ‰ç­‰ä»·çš„å€¼ã€‚setçš„é»˜è®¤æ¯”è¾ƒå‡½æ•°æ˜¯lessï¼Œè€Œé»˜è®¤çš„lessç®€å•åœ°å¯¹Widgetè°ƒç”¨operator\u003cï¼Œæ‰€ä»¥w1å’Œw2å…³äºoperator\u003cæœ‰ç­‰ä»·çš„å€¼å¦‚æœä¸‹é¢è¡¨è¾¾å¼ä¸ºçœŸï¼š !(w1 \u003c w2) // w1 \u003c w2æ—¶å®ƒéçœŸ \u0026\u0026 // è€Œä¸” !(w2\u003cw1) // w2 \u003c w1æ—¶å®ƒéçœŸ è¿™ä¸ªæœ‰æ„ä¹‰ï¼šä¸¤ä¸ªå€¼å¦‚æœæ²¡æœ‰å“ªä¸ªåœ¨å¦ä¸€ä¸ªä¹‹å‰ï¼ˆå…³äºæŸä¸ªæ’åºæ ‡å‡†ï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬ç­‰ä»·ï¼ˆæŒ‰ç…§é‚£ä¸ªæ ‡å‡†ï¼‰ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”¨äºå…³è”å®¹å™¨çš„æ¯”è¾ƒå‡½æ•°ä¸æ˜¯operator\u003cæˆ–ç”šè‡³lessï¼Œå®ƒæ˜¯ç”¨æˆ·å®šä¹‰çš„åˆ¤æ–­å¼ã€‚æ¯ä¸ªæ ‡å‡†å…³è”å®¹å™¨é€šè¿‡å®ƒçš„key_compæˆå‘˜å‡½æ•°æ¥è®¿é—®æ’åºåˆ¤æ–­å¼ï¼Œæ‰€ä»¥å¦‚æœä¸‹å¼æ±‚å€¼ä¸ºçœŸï¼Œä¸¤ä¸ªå¯¹è±¡xå’Œyå…³äºä¸€ä¸ªå…³è”å®¹å™¨cçš„æ’åºæ ‡å‡†æœ‰ç­‰ä»·çš„å€¼ï¼š !c.key_comp()(x, y) \u0026\u0026 !c.key_comp()(y, x) // åœ¨cçš„æ’åºé¡ºåºä¸­ // å¦‚æœxåœ¨yä¹‹å‰å®ƒéçœŸï¼ŒåŒæ—¶åœ¨cçš„æ’åºé¡ºåºä¸­,å¦‚æœyåœ¨xä¹‹å‰å®ƒéçœŸ è¦å®Œå…¨é¢†ä¼š==ç›¸ç­‰==å’Œ==ç­‰ä»·==çš„å«ä¹‰ï¼Œè€ƒè™‘ä¸€ä¸ªå¿½ç•¥å¤§å°å†™çš„set\u003cstring\u003eï¼Œä¹Ÿå°±æ˜¯setçš„æ¯”è¾ƒå‡½æ•°å¿½ç•¥å­—ç¬¦ä¸²ä¸­å­—ç¬¦å¤§å°å†™çš„set\u003cstring\u003eã€‚è¿™æ ·çš„æ¯”è¾ƒå‡½æ•°ä¼šè®¤ä¸ºâ€œSTLâ€å’Œâ€œstLâ€æ˜¯ç­‰ä»·çš„ã€‚æ¡æ¬¾35æ¼”ç¤ºäº†æ€ä¹ˆå®ç°ä¸€ä¸ªå‡½æ•°ï¼ŒciStringCompareï¼Œå®ƒè¿›è¡Œäº†å¿½ç•¥å¤§å°å†™æ¯”è¾ƒï¼Œä½†setè¦ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°çš„ç±»å‹ï¼Œä¸æ˜¯çœŸçš„å‡½æ•°ã€‚è¦å¡«å¹³è¿™ä¸ªé¸¿æ²Ÿï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªoperator()è°ƒç”¨äº†ciStringCompareçš„ä»¿å‡½æ•°ç±»: struct CIStringCompare: // ç”¨äºå¿½ç•¥å¤§å°å†™ public // å­—ç¬¦ä¸²æ¯”è¾ƒçš„ç±»ï¼› binary_function\u003cstring, string, bool\u003e { bool operator()(const string\u0026 lhs, const string\u0026 rhs) const { return ciStringCompare(lhs, rhs); // å…³äºciStringCompare } } å…·ä½“å®ç°ä¸º: int ciCharCompare(char c1, char c2) // å¿½ç•¥å¤§å°å†™æ¯”è¾ƒå­—ç¬¦ { // c1å’Œc2ï¼Œå¦‚æœc1 \u003c c2è¿”å›-1ï¼Œ // å¦‚æœc1==c2è¿”å›0ï¼Œå¦‚æœc1 \u003e c2è¿”å›1 int Ic1 = tolower(static_cast\u003cunsigned char\u003e(c1));// è½¬æˆå°å†™ int Ic2 = tolower(static_cast\u003cunsigned char\u003e(c2)); if (Ic1 \u003c Ic2) return -1; if (lc1 \u003e Ic2) return 1; return 0; } ç»™å®šCIStringCompareï¼Œè¦å»ºç«‹ä¸€ä¸ªå¿½ç•¥å¤§å°å†™çš„setå°±å¾ˆç®€å•äº†: set\u003cstring, CIStringCompare\u003e ciss; // ciss = â€œcase-insensitive // string setâ€ å¦‚æœæˆ‘ä»¬å‘è¿™ä¸ªsetä¸­æ’å…¥â€œPersephoneâ€å’Œâ€œpersephoneâ€ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²åŠ å…¥äº†ï¼Œå› ä¸ºç¬¬äºŒä¸ªç­‰ä»·äºç¬¬ä¸€ä¸ªï¼š ciss.insert(\"Persephone\"); // ä¸€ä¸ªæ–°å…ƒç´ æ·»åŠ åˆ°setä¸­ ciss.insert(\"persephone\"); // æ²¡æœ‰æ–°å…ƒç´ æ·»åŠ åˆ°setä¸­ å¦‚æœæˆ‘ä»¬ç°åœ¨ä½¿ç”¨setçš„findæˆå‘˜å‡½æ•°æœç´¢å­—ç¬¦ä¸²â€œpersephoneâ€ï¼Œæœç´¢ä¼šæˆåŠŸï¼Œ if (ciss.find(\"persephone\") != ciss.end())... // è¿™ä¸ªæµ‹è¯•ä¼šæˆåŠŸ ä½†å¦‚æœæˆ‘ä»¬ç”¨éæˆå‘˜çš„findç®—æ³•ï¼Œæœç´¢ä¼šå¤±è´¥ï¼š if (find(ciss.begin(), ciss.end(), \"persephone\") != ciss.end())... // è¿™ä¸ªæµ‹è¯•ä¼šå¤±è´¥ é‚£æ˜¯å› ä¸ºâ€œpersephoneâ€ç­‰ä»·äºâ€œPersephoneâ€ï¼ˆå…³äºæ¯”è¾ƒä»¿å‡½æ•°CIStringCompareï¼‰ï¼Œä½†ä¸ç­‰äºå®ƒï¼ˆå› ä¸ºstring(â€œpersephoneâ€) != string(â€œPersephoneâ€)ï¼‰ã€‚ä½ å¯èƒ½ä¼šå¥‡æ€ªä¸ºä»€ä¹ˆæ ‡å‡†å…³è”å®¹å™¨æ˜¯åŸºäºç­‰ä»·è€Œä¸æ˜¯ç›¸ç­‰ã€‚æ¯•ç«Ÿï¼Œå¤§å¤šæ•°ç¨‹åºå‘˜å¯¹ç›¸ç­‰æœ‰æ„Ÿè§‰è€Œç¼ºä¹ç­‰ä»·çš„æ„Ÿè§‰ã€‚ æ ‡å‡†å…³è”å®¹å™¨ä¿æŒæœ‰åºï¼Œæ‰€ä»¥æ¯ä¸ªå®¹å™¨å¿…é¡»æœ‰ä¸€ä¸ªå®šä¹‰äº†æ€ä¹ˆä¿æŒä¸œè¥¿æœ‰åºçš„æ¯”è¾ƒå‡½æ•°ï¼ˆé»˜è®¤æ˜¯lessï¼‰ã€‚ç­‰ä»·æ˜¯æ ¹æ®è¿™ä¸ªæ¯”è¾ƒå‡½æ•°å®šä¹‰çš„ï¼Œæ‰€ä»¥æ ‡å‡†å…³è”å®¹å™¨çš„ç”¨æˆ·åªéœ€è¦ä¸ºä»–ä»¬è¦ä½¿ç”¨çš„ä»»æ„å®¹å™¨æŒ‡å®šä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ï¼ˆå†³å®šæ’åºé¡ºåºçš„é‚£ä¸ªï¼‰ã€‚ å¦‚æœå…³è”å®¹å™¨ä½¿ç”¨ç›¸ç­‰æ¥å†³å®šä¸¤ä¸ªå¯¹è±¡æ˜¯å¦æœ‰ç›¸åŒçš„å€¼ï¼Œé‚£ä¹ˆæ¯ä¸ªå…³è”å®¹å™¨å°±éœ€è¦ï¼Œé™¤äº†ç”¨äºæ’åºçš„æ¯”è¾ƒå‡½æ•°ï¼Œè¿˜éœ€è¦ä¸€ä¸ªç”¨äºåˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰çš„æ¯”è¾ƒå‡½æ•°ã€‚ï¼ˆé»˜è®¤çš„ï¼Œè¿™ä¸ªæ¯”è¾ƒå‡½æ•°å¤§æ¦‚åº”è¯¥æ˜¯equal_toï¼Œä½†æœ‰è¶£çš„æ˜¯equal_toä»æ²¡æœ‰åœ¨STLä¸­ç”¨åšé»˜è®¤æ¯”è¾ƒå‡½æ•°ã€‚å½“åœ¨STLä¸­éœ€è¦ç›¸ç­‰æ—¶ï¼Œä¹ æƒ¯æ˜¯ç®€å•åœ°ç›´æ¥è°ƒç”¨operator==ã€‚æ¯”å¦‚ï¼Œè¿™æ˜¯éæˆå‘˜findç®—æ³•æ‰€ä½œçš„ã€‚ï¼‰ è¯´ç™½äº†ï¼Œå°±æ˜¯ç­‰ä»·æ˜¯ä¸ºå®¹å™¨æ’åºæœåŠ¡çš„ï¼Œå¦‚æœå®¹å™¨æƒ³è¦æ’å…¥å¤šä¸ªè½¬åŒ–ä¸ºå°å†™åç›¸ç­‰çš„å•è¯ï¼Œå®¹å™¨ä¼šåˆ¤å®šè¿™äº›å•è¯ç­‰ä»·ï¼Œè™½ç„¶å®ƒä»¬æœ¬èº«ä¸ç›¸ç­‰ï¼Œè¿™æ ·å°±èƒ½å¤Ÿå¾ˆå¥½åœ°ä¿æŒå®¹å™¨å†…å•è¯çš„å”¯ä¸€æ€§å’Œå•è¯çš„æœ‰åºæ€§ã€‚å¦åˆ™é€šè¿‡æŸ¥æ‰¾æˆ–æ’å…¥è¯¥å•è¯çš„æ—¶å€™ï¼Œå®¹å™¨å†…éƒ¨å°±ä¼šå‘ç”Ÿæ­§ä¹‰ï¼Œé€ æˆä¸ç¬¦åˆä½¿ç”¨è€…é€»è¾‘ã€‚ è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç±»ä¼¼setçš„STLå®¹å™¨å«åšset2CFï¼Œâ€œset with two comparison functionsâ€ã€‚ç¬¬ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ç”¨æ¥å†³å®šsetçš„æ’åºé¡ºåºï¼Œç¬¬äºŒä¸ªç”¨æ¥å†³å®šæ˜¯å¦ä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„å€¼ã€‚ ç°åœ¨è€ƒè™‘è¿™set2CFï¼š set2CF\u003cstring, CIStringCompare, equal_to\u003cstring\u003e \u003e s; åœ¨è¿™é‡Œï¼Œså†…éƒ¨æ’åºå®ƒçš„å­—ç¬¦ä¸²æ—¶ä¸è€ƒè™‘å¤§å°å†™ï¼Œç­‰ä»·æ ‡å‡†ç›´è§‰ä¸Šæ˜¯è¿™æ ·ï¼šå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­ä¸€ä¸ªç­‰äºå¦ä¸€ä¸ªï¼Œé‚£ä¹ˆå®ƒä»¬æœ‰ç›¸åŒçš„å€¼ã€‚è®©æˆ‘ä»¬å‘sä¸­æ’å…¥å“ˆè¿ªæ–¯å¼ºå¨¶çš„æ–°å¨˜ï¼ˆPersephoneï¼‰çš„ä¸¤ä¸ªæ‹¼å†™: s.insert(\"Persephone\"); s.insert(\"persephone\"); å¦‚æœæˆ‘ä»¬è¯´\"Persephone\" != \"persephone\"ç„¶åä¸¤ä¸ªéƒ½æ’å…¥sï¼Œå®ƒä»¬åº”è¯¥æ˜¯ä»€ä¹ˆé¡ºåºï¼Ÿ è®°ä½æ’åºå‡½æ•°ä¸èƒ½åˆ†åˆ«å‘Šè¯‰å®ƒä»¬ã€‚æˆ‘ä»¬å¯ä»¥ä»¥ä»»æ„é¡ºåºæ’å…¥ï¼Œå› æ­¤æ”¾å¼ƒä»¥ç¡®å®šçš„é¡ºåºéå†setå†…å®¹çš„èƒ½åŠ›å—ï¼Ÿï¼ˆä¸èƒ½ä»¥ç¡®å®šçš„é¡ºåºéå†å…³è”å®¹å™¨å…ƒç´ å·²ç»æŠ˜ç£¨ç€multisetå’Œmultimapäº†ï¼Œå› ä¸ºæ ‡å‡†æ²¡æœ‰è§„å®šç­‰ä»·çš„å€¼ï¼ˆå¯¹äºmultisetï¼‰æˆ–é”®ï¼ˆå¯¹äºmultimapï¼‰çš„ç›¸å¯¹é¡ºåºã€‚ï¼‰æˆ–è€…æˆ‘ä»¬åšæŒsçš„å†…å®¹çš„ä¸€ä¸ªç¡®å®šé¡ºåºå¹¶å¿½ç•¥ç¬¬äºŒæ¬¡æ’å…¥çš„å°è¯•ï¼ˆâ€œpersephoneâ€çš„é‚£ä¸ªï¼‰? å¦‚æœæˆ‘ä»¬é‚£ä¹ˆåšï¼Œè¿™é‡Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ if (s.find(\"persephone\") != s.end())... // è¿™ä¸ªæµ‹è¯•æˆåŠŸæˆ–å¤±è´¥ï¼Ÿ å¤§æ¦‚**findä½¿ç”¨äº†ç­‰ä»·æ£€æŸ¥**ï¼Œä½†å¦‚æœæˆ‘ä»¬ä¸ºäº†ç»´æŠ¤sä¸­å…ƒç´ çš„ä¸€ä¸ªç¡®å®šé¡ºåºè€Œå¿½ç•¥äº†ç¬¬äºŒä¸ªinsertçš„è°ƒç”¨ï¼Œè¿™ä¸ªfindä¼šå¤±è´¥ï¼Œå³ä½¿â€œpersephoneâ€çš„æ’å…¥ç”±äºå®ƒæ˜¯ä¸€ä¸ªé‡å¤çš„å€¼çš„åŸåˆ™è€Œè¢«å¿½ç•¥ï¼ ","date":"2023-08-10","objectID":"/posts/clause_19/:1:0","tags":["Effective STL"],"title":"Effective STL [19] | äº†è§£ç›¸ç­‰å’Œç­‰ä»·çš„åŒºåˆ«","uri":"/posts/clause_19/"},{"categories":["C++"],"content":"æ€»ç»“ é€šè¿‡åªä½¿ç”¨ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°å¹¶ä½¿ç”¨ç­‰ä»·ä½œä¸ºä¸¤ä¸ªå€¼â€œç›¸ç­‰â€çš„æ„ä¹‰çš„ä»²è£è€…ï¼Œæ ‡å‡†å…³è”å®¹å™¨é¿å¼€äº†å¾ˆå¤šä¼šç”±å…è®¸ä¸¤ä¸ªæ¯”è¾ƒå‡½æ•°è€Œå¼•å‘çš„å›°éš¾ã€‚ ä¸€å¼€å§‹è¡Œä¸ºå¯èƒ½çœ‹èµ·æ¥æœ‰äº›å¥‡æ€ªï¼ˆç‰¹åˆ«æ˜¯å½“ä½ å‘ç°æˆå‘˜å’Œéæˆå‘˜findå¯èƒ½è¿”å›ä¸åŒç»“æœï¼‰ï¼Œä½†æœ€åï¼Œå®ƒé¿å…äº†ä¼šç”±åœ¨æ ‡å‡†å…³è”å®¹å™¨ä¸­æ··ç”¨ç›¸ç­‰å’Œç­‰ä»·é€ æˆçš„æ··ä¹±ã€‚ ","date":"2023-08-10","objectID":"/posts/clause_19/:2:0","tags":["Effective STL"],"title":"Effective STL [19] | äº†è§£ç›¸ç­‰å’Œç­‰ä»·çš„åŒºåˆ«","uri":"/posts/clause_19/"},{"categories":["C++"],"content":"vector é—®é¢˜ ä½œä¸ºä¸€ä¸ªSTLå®¹å™¨ï¼Œvectorç¡®å®åªæœ‰1ä¸ªé—®é¢˜: å®ƒä¸æ˜¯ä¸€ä¸ªSTLå®¹å™¨ï¼› å®ƒå¹¶ä¸å®¹çº³boolã€‚ ","date":"2023-08-09","objectID":"/posts/clause_18/:1:0","tags":["Effective STL"],"title":"Effective STL [18] | é¿å…ä½¿ç”¨vector\u003cbool\u003e","uri":"/posts/clause_18/"},{"categories":["C++"],"content":"å‰–æ ä¸€ä¸ªä¸œè¥¿è¦æˆä¸ºSTLå®¹å™¨å°±å¿…é¡»æ»¡è¶³æ‰€æœ‰åœ¨C++æ ‡å‡†23.1èŠ‚ä¸­åˆ—å‡ºçš„å®¹å™¨å¿…è¦æ¡ä»¶ã€‚ å¦‚æœcæ˜¯ä¸€ä¸ªTç±»å‹å¯¹è±¡çš„å®¹å™¨ï¼Œä¸”cæ”¯æŒoperator[]ï¼Œé‚£ä¹ˆä»¥ä¸‹ä»£ç å¿…é¡»èƒ½å¤Ÿç¼–è¯‘: T *p = \u0026c[0]; // æ— è®ºoperator[]è¿”å›ä»€ä¹ˆï¼Œéƒ½å¯ä»¥ç”¨è¿™ä¸ªåœ°å€åˆå§‹åŒ–ä¸€ä¸ªT* æ¢å¥è¯è¯´ï¼Œå¦‚æœä½ ä½¿ç”¨operator[]æ¥å¾—åˆ°Containerä¸­çš„ä¸€ä¸ªTå¯¹è±¡ï¼Œä½ å¯ä»¥é€šè¿‡å–å®ƒçš„åœ°å€è€Œè·å¾—æŒ‡å‘é‚£ä¸ªå¯¹è±¡çš„æŒ‡é’ˆã€‚(å‡è®¾Tæ²¡æœ‰å€”å¼ºåœ°é‡è½½ä¸€äº›æ“ä½œç¬¦ã€‚) ç„¶è€Œå¦‚æœvectoræ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œè¿™æ®µä»£ç å¿…é¡»èƒ½å¤Ÿç¼–è¯‘ï¼š vector\u003cbool\u003e v; bool *pb = \u0026v[0]; // ç”¨vector\u003cbool\u003e::operator[]è¿”å›çš„ä¸œè¥¿çš„åœ°å€åˆå§‹åŒ–ä¸€ä¸ªbool* ä½†å®ƒä¸èƒ½ç¼–è¯‘ã€‚ test_vector.cpp:154:19: error: taking address of rvalue [-fpermissive] 154 | bool *pb = \u0026r2[0]; | ^ test_vector.cpp:154:14: error: cannot convert â€˜std::vector\u003cbool\u003e::reference*â€™ {aka â€˜std::_Bit_reference*â€™} to â€˜bool*â€™ in initialization 154 | bool *pb = \u0026r2[0]; | ^~~~~~ | | | std::vector\u003cbool\u003e::reference* {aka std::_Bit_reference*} å› ä¸ºvector\u003cbool\u003eæ˜¯ä¸€ä¸ªä¼ªå®¹å™¨ï¼Œå¹¶ä¸ä¿å­˜çœŸæ­£çš„boolï¼Œè€Œæ˜¯æ‰“åŒ…boolä»¥èŠ‚çœç©ºé—´ã€‚åœ¨ä¸€ä¸ªå…¸å‹çš„å®ç°ä¸­ï¼Œæ¯ä¸ªä¿å­˜åœ¨â€œvectorâ€ä¸­çš„â€œboolâ€å ç”¨ä¸€ä¸ªå•ç‹¬çš„æ¯”ç‰¹ï¼Œè€Œä¸€ä¸ª8æ¯”ç‰¹çš„å­—èŠ‚å°†å®¹çº³8ä¸ªâ€œboolâ€ã€‚ åœ¨å†…éƒ¨ï¼Œvector\u003cbool\u003eä½¿ç”¨äº†ä¸ä½åŸŸï¼ˆbitfieldï¼‰ç­‰ä»·çš„æ€æƒ³æ¥è¡¨ç¤ºå®ƒå‡è£…å®¹çº³çš„boolã€‚ ä½åŸŸä¹Ÿåªè¡¨ç°ä¸ºä¸¤ç§å¯èƒ½çš„å€¼ï¼Œä½†çœŸçš„boolå’ŒåŒ–è£…æˆboolçš„ä½åŸŸä¹‹é—´æœ‰ä¸€ä¸ªé‡è¦çš„ä¸åŒï¼šä½ å¯ä»¥åˆ›å»ºæŒ‡å‘çœŸçš„boolçš„æŒ‡é’ˆï¼Œä½†å´ç¦æ­¢æœ‰æŒ‡å‘å•ä¸ªæ¯”ç‰¹çš„æŒ‡é’ˆã€‚ ","date":"2023-08-09","objectID":"/posts/clause_18/:2:0","tags":["Effective STL"],"title":"Effective STL [18] | é¿å…ä½¿ç”¨vector\u003cbool\u003e","uri":"/posts/clause_18/"},{"categories":["C++"],"content":"å®é™…å®ç° vector::operator[]è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶è¡Œä¸ºç±»ä¼¼äºæ¯”ç‰¹çš„å¼•ç”¨ï¼Œä¹Ÿç§°ä¸ºä»£ç†å¯¹è±¡ã€‚ template\u003ctypename _Alloc\u003e class vector\u003cbool, _Alloc\u003e : protected _Bvector_base\u003c_Alloc\u003e { typedef _Bvector_base\u003c_Alloc\u003e _Base; typedef typename _Base::_Bit_pointer _Bit_pointer; typedef typename _Base::_Bit_alloc_traits _Bit_alloc_traits; #if __cplusplus \u003e= 201103L friend struct std::hash\u003cvector\u003e; #endif public: typedef bool value_type; typedef size_t size_type; typedef ptrdiff_t difference_type; typedef _Bit_reference reference; typedef bool const_reference; typedef _Bit_reference* pointer; typedef const bool* const_pointer; typedef _Bit_iterator iterator; typedef _Bit_const_iterator const_iterator; typedef std::reverse_iterator\u003cconst_iterator\u003e const_reverse_iterator; typedef std::reverse_iterator\u003citerator\u003e reverse_iterator; typedef _Alloc allocator_type; allocator_type get_allocator() const { return _Base::get_allocator(); } protected: using _Base::_M_allocate; using _Base::_M_deallocate; using _Base::_S_nword; using _Base::_M_get_Bit_allocator; reference operator[](size_type __n) { return *iterator(this-\u003e_M_impl._M_start._M_p + __n / int(_S_word_bit), __n % int(_S_word_bit)); } const_reference operator[](size_type __n) const { return *const_iterator(this-\u003e_M_impl._M_start._M_p + __n / int(_S_word_bit), __n % int(_S_word_bit)); } } ä¸Šè¿°ä»£ç ä¸èƒ½ç¼–è¯‘çš„åŸå› å¾ˆæ˜æ˜¾ï¼šbool *pb = \u0026v[0]å³è¾¹çš„è¡¨è¾¾å¼æ˜¯vector\u003cbool\u003e::reference*ç±»å‹ï¼Œä¸æ˜¯bool*ã€‚ ","date":"2023-08-09","objectID":"/posts/clause_18/:3:0","tags":["Effective STL"],"title":"Effective STL [18] | é¿å…ä½¿ç”¨vector\u003cbool\u003e","uri":"/posts/clause_18/"},{"categories":["C++"],"content":"æ›¿ä»£å“ ","date":"2023-08-09","objectID":"/posts/clause_18/:4:0","tags":["Effective STL"],"title":"Effective STL [18] | é¿å…ä½¿ç”¨vector\u003cbool\u003e","uri":"/posts/clause_18/"},{"categories":["C++"],"content":"1. deque dequeæä¾›äº†å‡ ä¹æ‰€æœ‰vectoræ‰€æä¾›çš„ï¼ˆå”¯ä¸€å€¼å¾—æ³¨æ„çš„æ˜¯reserveå’Œcapacityï¼‰ï¼Œè€Œdeque\u003cbool\u003eæ˜¯ä¸€ä¸ªSTLå®¹å™¨ï¼Œå®ƒä¿å­˜çœŸæ­£çš„boolå€¼ã€‚ dequeå†…éƒ¨å†…å­˜ä¸æ˜¯è¿ç»­çš„ã€‚æ‰€ä»¥ä¸èƒ½ä¼ é€’deque\u003cbool\u003eä¸­çš„æ•°æ®ç»™ä¸€ä¸ªå¸Œæœ›å¾—åˆ°boolæ•°ç»„çš„C APIã€‚ æ¡æ¬¾16ä¸­ç”¨äºvectorçš„æŠ€æœ¯ä¸èƒ½åœ¨vector\u003cbool\u003eä¸Šé€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºå®ƒä»¬ä¾èµ–äºèƒ½å¤Ÿå–å¾—æŒ‡å‘å®¹å™¨ä¸­åŒ…å«çš„å…ƒç´ ç±»å‹çš„æŒ‡é’ˆã€‚ ","date":"2023-08-09","objectID":"/posts/clause_18/:4:1","tags":["Effective STL"],"title":"Effective STL [18] | é¿å…ä½¿ç”¨vector\u003cbool\u003e","uri":"/posts/clause_18/"},{"categories":["C++"],"content":"2. bitset bitsetä¸æ˜¯ä¸€ä¸ªSTLå®¹å™¨ï¼Œä½†å®ƒæ˜¯C++æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ã€‚ä¸STLå®¹å™¨ä¸åŒï¼Œå®ƒçš„å¤§å°ï¼ˆå…ƒç´ æ•°é‡ï¼‰åœ¨ç¼–è¯‘æœŸå›ºå®šï¼Œå› æ­¤å®ƒä¸æ”¯æŒæ’å…¥å’Œåˆ é™¤å…ƒç´ ã€‚ å› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªSTLå®¹å™¨ï¼Œå®ƒä¹Ÿä¸æ”¯æŒiteratorã€‚ä½†å°±åƒvector\u003cbool\u003eï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªå‹ç¼©çš„è¡¨ç¤ºæ³•ï¼Œä½¿å¾—å®ƒåŒ…å«çš„æ¯ä¸ªå€¼åªå ç”¨ä¸€æ¯”ç‰¹ã€‚ å®ƒæä¾›vector\u003cbool\u003eç‰¹æœ‰çš„flipæˆå‘˜å‡½æ•°ï¼Œè¿˜æœ‰ä¸€ç³»åˆ—å…¶ä»–æ“ä½œä½é›†(collection of bits)æ‰€ç‰¹æœ‰çš„æˆå‘˜å‡½æ•°ã€‚ ","date":"2023-08-09","objectID":"/posts/clause_18/:4:2","tags":["Effective STL"],"title":"Effective STL [18] | é¿å…ä½¿ç”¨vector\u003cbool\u003e","uri":"/posts/clause_18/"},{"categories":["C++"],"content":"æ€»ç»“ vector\u003cbool\u003eä¸æ»¡è¶³STLå®¹å™¨çš„å¿…è¦æ¡ä»¶ï¼Œä½ æœ€å¥½ä¸è¦ä½¿ç”¨å®ƒï¼› è€Œdeque\u003cbool\u003eå’Œbitsetæ˜¯åŸºæœ¬èƒ½æ»¡è¶³ä½ å¯¹vector\u003cbool\u003eæä¾›çš„æ€§èƒ½çš„éœ€è¦çš„æ›¿ä»£æ•°æ®ç»“æ„ã€‚ ","date":"2023-08-09","objectID":"/posts/clause_18/:5:0","tags":["Effective STL"],"title":"Effective STL [18] | é¿å…ä½¿ç”¨vector\u003cbool\u003e","uri":"/posts/clause_18/"},{"categories":["C++"],"content":" æ³¨æ„: è¿™é‡Œçš„å®¹é‡æŒ‡çš„æ˜¯capacity å‡å¦‚æœ‰ä¸€ä¸ªæµ·é€‰ï¼Œéœ€è¦ä»ç”³è¯·è€…ä¸­æŒ‘é€‰ä¸€äº›äººè¿›å…¥åˆ°ä¸‹ä¸€è½®æ¯”èµ›å½“ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå»ºç«‹ä¸€ä¸ªvectorç”¨æ¥å­˜å‚¨ç”³è¯·è€…ï¼š class Contestant {...}; vector\u003cContestant\u003e contestants; vectorä¼šå¾ˆå¿«è·å¾—å¾ˆå¤šå…ƒç´ ï¼Œä½ å¯èƒ½ä¼šå°†èƒ½å¤Ÿè¿›å…¥åˆ°ä¸‹ä¸€è½®çš„ç”³è¯·è€…æ”¾åˆ° vector çš„å‰ç«¯ï¼ˆå¯èƒ½é€šè¿‡ partial_sortæˆ–partitionï¼‰ï¼Œå¦‚æœæ²¡æœ‰å‚ä¸åˆ°ä¸‹ä¸€è½®çš„ç”³è¯·è€…å°±ä¼šä»vector ä¸­åˆ é™¤ï¼ˆå…¸å‹çš„æ–¹æ³•å°±æ˜¯è°ƒç”¨ erase çš„åŒºé—´å½¢å¼ï¼Œå…·ä½“è§æ¡æ¬¾5ï¼‰ã€‚ è¿™æ ·å¾ˆå¥½åœ°å‡å°‘äº† vector çš„å¤§å°ï¼Œä½†æ˜¯æ²¡æœ‰å‡å°‘å®ƒçš„å®¹é‡ã€‚ å½“ç„¶å¯ä»¥é€šè¿‡resizeæ–¹æ³•å»æ”¹å˜ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä¸çŸ¥é“å¤§æ¦‚è¦å¤šå°‘ï¼Œæˆ‘åªçŸ¥é“æœ‰ä¸€äº›ç¬¦åˆæˆ‘çš„è¦æ±‚ï¼Œå¦‚æœç›´æ¥ç”¨resizeå¯èƒ½å¤§äº†å¾ˆå¤šï¼Œæˆ–è€…æŠ›å¼ƒäº†åŸæœ¬ç¬¦åˆè¦æ±‚çš„å…ƒç´ ã€‚æ‰€ä»¥æœ€å¥½æœ‰ä¸€ç§shrink_to_fitçš„æ–¹å¼ã€‚ vector\u003cContestant\u003e contestants; vector\u003cContestant\u003e(contestants).swap(contestants); å…·ä½“å·¥ä½œåŸç†ï¼š è¡¨è¾¾å¼vector\u003cContestant\u003e(contestants)å»ºç«‹ä¸€ä¸ªä¸´æ—¶vectorï¼Œå®ƒæ˜¯contestantsçš„ä¸€ä»½æ‹·è´ï¼švectorçš„æ‹·è´æ„é€ å‡½æ•°åšäº†è¿™ä¸ªå·¥ä½œã€‚vectorçš„æ‹·è´æ„é€ å‡½æ•°åªåˆ†é…æ‹·è´çš„å…ƒç´ éœ€è¦çš„å†…å­˜ï¼Œå°±æ˜¯è¯´contestantsçœŸå®åŒ…å«å¤šå°‘å…ƒç´ ï¼Œå°±åˆ†é…å¤šå°‘å†…å­˜ç©ºé—´ï¼ŒæŒ‰ç…§size()çš„ä¸ªæ•°ï¼Œè€Œä¸æ˜¯capicatiyä¸ªæ•°ï¼Œæ‰€ä»¥è¿™ä¸ªä¸´æ—¶vectoræ²¡æœ‰å¤šä½™çš„å®¹é‡ã€‚ è®©ä¸´æ—¶vectorå’Œcontestantsäº¤æ¢æ•°æ®ï¼Œè¿™æ—¶contestantsåªæœ‰ä¸´æ—¶å˜é‡çš„ä¿®æ•´è¿‡çš„å®¹é‡(size)ï¼Œè€Œè¿™ä¸ªä¸´æ—¶å˜é‡åˆ™æŒæœ‰äº†æ›¾ç»åœ¨contestantsä¸­çš„å‘èƒ€çš„å®¹é‡(capacity)ã€‚åœ¨è¿™é‡Œï¼ˆè¿™ä¸ªè¯­å¥ç»“å°¾ï¼‰ï¼Œä¸´æ—¶vectorè¢«é”€æ¯ï¼Œå› æ­¤é‡Šæ”¾äº†ä»¥å‰contestantsä½¿ç”¨çš„å†…å­˜ã€‚ æ”¶ç¼©åˆ°åˆé€‚ã€‚ å®Œæˆæ”¶ç¼©å†…å­˜çš„åŒæ—¶ï¼Œä¹Ÿæ‹·è´äº†å®é™…size()ä¸ªå†…å­˜ï¼Œä¹Ÿæœ‰æ€§èƒ½æ¶ˆè€—ã€‚ TEST int main() { std::vector\u003cint\u003e r1(100, 1); // r1 åŒ…å«100ä¸ª1ï¼Œå³100ä¸ªç”³è¯·è€… std::cout \u003c\u003c \"r1 size: \" \u003c\u003c r1.size() \u003c\u003c \" capacity: \" \u003c\u003c r1.capacity() \u003c\u003c std::endl; r1.resize(50); // åªä¿ç•™å‰50åç”³è¯·è€…è¿›å…¥ä¸‹ä¸€è½® std::cout \u003c\u003c \"r1 size: \" \u003c\u003c r1.size() \u003c\u003c \" capacity: \" \u003c\u003c r1.capacity() \u003c\u003c std::endl; std::vector\u003cint\u003e(r1).swap(r1); // shrink to fit std::cout \u003c\u003c \"r1 size: \" \u003c\u003c r1.size() \u003c\u003c \" capacity: \" \u003c\u003c r1.capacity() \u003c\u003c std::endl; return 0; } ç»“æœ: r1 size: 100 capacity: 100 r1 size: 50 capacity: 100 r1 size: 50 capacity: 50 r1 size: 0 capacity: 0 stringä¹ŸåŒæ ·é€‚ç”¨ï¼š vector\u003cContestant\u003e v; string s; ... vector\u003cContest\u003e().swap(v); //æ¸…æ¥švå¹¶æŠŠå®ƒçš„å®¹é‡å˜ä¸ºæœ€å° string().swap(s); //æ¸…æ¥šså¹¶æŠŠå®ƒçš„å®¹é‡å˜ä¸ºæœ€å° å¦å¤–ï¼Œåœ¨swapçš„æ—¶å€™ï¼Œä¸ä»…ä»…å®¹å™¨å†…å®¹è¢«äº¤æ¢ï¼Œå…¶è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨ä¹Ÿè¢«äº¤æ¢(stringé™¤å¤–)ã€‚å› æ­¤ï¼Œåœ¨å‘ç”Ÿäº¤æ¢åï¼ŒåŸæ¥çš„è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨ä¾ç„¶æœ‰æ•ˆï¼Œå¹¶æŒ‡å‘åŒæ ·çš„å…ƒç´ â€”â€”ä½†è¿™äº›å…ƒç´ å·²ç»åœ¨å¦å¤–ä¸€ä¸ªå®¹å™¨ä¸­ã€‚ ","date":"2023-08-08","objectID":"/posts/clause_17/:0:0","tags":["Effective STL"],"title":"Effective STL [17] | ä½¿ç”¨â€œäº¤æ¢æŠ€å·§â€æ¥ä¿®æ•´è¿‡å‰©å®¹é‡(ä»…é€‚ç”¨äºvectorå’Œstring)","uri":"/posts/clause_17/"},{"categories":["C++"],"content":"æ¸…ç©ºå®¹å™¨å¹¶å‡å°‘å®¹é‡åˆ°æœ€å° äº¤æ¢æŠ€å·§çš„å˜ä½“å¯ä»¥ç”¨äºæ¸…é™¤å®¹å™¨å’Œå‡å°‘å®ƒçš„å®¹é‡åˆ°ä½ çš„å®ç°æä¾›çš„æœ€å°å€¼ã€‚ å¯ä»¥ç®€å•åœ°å’Œä¸€ä¸ªé»˜è®¤æ„é€ çš„ä¸´æ—¶vectoræˆ–stringåšä¸ªäº¤æ¢ï¼š vector\u003cContestant\u003e v; string s; ... // ä½¿ç”¨vå’Œs vector\u003cContestant\u003e().swap(v); // æ¸…é™¤vè€Œä¸”æœ€å°åŒ–å®ƒçš„å®¹é‡ string().swap(s); // æ¸…é™¤sè€Œä¸”æœ€å°åŒ–å®ƒçš„å®¹é‡ æµ‹è¯•ä»£ç ï¼š std::vector\u003cint\u003e r1(100, 1); // r1 åŒ…å«100ä¸ª1ï¼Œå³100ä¸ªç”³è¯·è€… std::cout \u003c\u003c \"r1 size: \" \u003c\u003c r1.size() \u003c\u003c \" capacity: \" \u003c\u003c r1.capacity() \u003c\u003c std::endl; std::vector\u003cint\u003e().swap(r1); // æ¸…ç©º r1 std::cout \u003c\u003c \"r1 size: \" \u003c\u003c r1.size() \u003c\u003c \" capacity: \" \u003c\u003c r1.capacity() \u003c\u003c std::endl; ç»“æœ: r1 size: 100 capacity: 100 r1 size: 0 capacity: 0 ref: [1]. https://blog.csdn.net/u011058765/article/details/51205757?spm=1001.2101.3001.6650.2\u0026utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-2-51205757-blog-18826.235%5Ev38%5Epc_relevant_anti_t3\u0026depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-2-51205757-blog-18826.235%5Ev38%5Epc_relevant_anti_t3\u0026utm_relevant_index=3 ","date":"2023-08-08","objectID":"/posts/clause_17/:1:0","tags":["Effective STL"],"title":"Effective STL [17] | ä½¿ç”¨â€œäº¤æ¢æŠ€å·§â€æ¥ä¿®æ•´è¿‡å‰©å®¹é‡(ä»…é€‚ç”¨äºvectorå’Œstring)","uri":"/posts/clause_17/"},{"categories":["C++"],"content":"string å’Œ vector ä¼ é€’ç»™C API ","date":"2023-08-07","objectID":"/posts/clause_16/:1:0","tags":["Effective STL"],"title":"Effective STL [16] | å¦‚ä½•å°†vectorå’Œstringçš„æ•°æ®ä¼ ç»™é—ç•™çš„API","uri":"/posts/clause_16/"},{"categories":["C++"],"content":"vectorä¼ é€’æŒ‡é’ˆ Cé£æ ¼APIæ¥å—çš„æ˜¯æ•°ç»„å’Œchar*æŒ‡é’ˆï¼Œè¿™æ ·çš„APIè¿˜ä¼šå­˜åœ¨å¾ˆé•¿æ—¶é—´ï¼Œå¦‚æœæœ‰1ä¸ªvectorå¯¹è±¡randyï¼Œ åˆ™ä½¿ç”¨\u0026v[0]å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæŒ‡å‘randyä¸­æ•°æ®çš„æŒ‡é’ˆã€‚å¯¹äºstringå¯¹è±¡sesameï¼Œåˆ™ä¼ é€’sesame.c_str()å³å¯ã€‚ è¡¨è¾¾å¼randy[0]ç”Ÿäº§ä¸€ä¸ªæŒ‡å‘vectorä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œæ‰€ä»¥ï¼Œ\u0026randy[0]æ˜¯æŒ‡å‘é‚£ä¸ªé¦–å…ƒç´ çš„æŒ‡é’ˆã€‚ vectorä¸­çš„å…ƒç´ è¢«C++æ ‡å‡†é™å®šä¸ºå­˜å‚¨åœ¨è¿ç»­å†…å­˜ä¸­ï¼Œå°±åƒæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯èƒ½ä¼šè¿™ä¹ˆä¼ é€’ // C API void doSomething(const int* pInts, size_t numInts); // è°ƒç”¨ doSomething(\u0026randy[0], randy.size()); å”¯ä¸€çš„é—®é¢˜å°±æ˜¯ï¼Œå¦‚æœrandyæ˜¯ç©ºçš„ï¼Œrandysize()æ˜¯0ï¼Œè€Œ\u0026randy[0]è¯•å›¾äº§ç”Ÿä¸€ä¸ªæŒ‡å‘æ ¹æœ¬å°±ä¸å­˜åœ¨çš„ä¸œè¥¿çš„æŒ‡é’ˆã€‚ å¯ä»¥æå‰åˆ¤æ–­ä¸€ä¸‹randyçš„å¤§å°ï¼š if (!randy.empty()) { doSomething(\u0026randy[0], randy.size()); } randy.begin()ä»£æ›¿\u0026randy[0]? å¯¹äºvectorï¼Œå…¶è¿­ä»£å™¨å®é™…ä¸Šæ˜¯æŒ‡é’ˆã€‚ beginçš„è¿”å›ç±»å‹æ˜¯iteratorï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå½“ä½ éœ€è¦ä¸€ä¸ªæŒ‡å‘vectorå†…éƒ¨æ•°æ®çš„æŒ‡é’ˆæ—¶ç»ä¸è¯¥ä½¿ç”¨beginã€‚å¦‚æœä½ åŸºäºæŸäº›åŸå› å†³å®šé”®å…¥randy.begin()ï¼Œå°±åº”è¯¥é”®å…¥\u0026*randy.begin()ï¼Œå› ä¸ºè¿™å°†ä¼šäº§ç”Ÿå’Œ\u0026v[0]ç›¸åŒçš„æŒ‡é’ˆã€‚ ","date":"2023-08-07","objectID":"/posts/clause_16/:1:1","tags":["Effective STL"],"title":"Effective STL [16] | å¦‚ä½•å°†vectorå’Œstringçš„æ•°æ®ä¼ ç»™é—ç•™çš„API","uri":"/posts/clause_16/"},{"categories":["C++"],"content":"string ä¼ é€’æŒ‡é’ˆ ç±»ä¼¼ä»vectorä¸Šè·å–æŒ‡å‘å†…éƒ¨æ•°æ®çš„æŒ‡é’ˆçš„æ–¹æ³•ï¼Œå¯¹stringä¸æ˜¯å¯é çš„: stringä¸­çš„æ•°æ®å¹¶æ²¡æœ‰ä¿è¯è¢«å­˜å‚¨åœ¨ç‹¬ç«‹çš„ä¸€å—è¿ç»­å†…å­˜ä¸­ stringçš„å†…éƒ¨è¡¨ç¤ºå½¢å¼å¹¶æ²¡æ‰¿è¯ºä»¥ä¸€ä¸ªnullå­—ç¬¦ç»“æŸã€‚è¿™è§£é‡Šäº†stringçš„æˆå‘˜å‡½æ•°c_strå­˜åœ¨çš„åŸå›  å³ä½¿æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ä¸º0ï¼Œc_strå°†è¿”å›ä¸€ä¸ªæŒ‡å‘nullå­—ç¬¦çš„æŒ‡é’ˆã€‚ åœ¨ä¸¤ç§å½¢å¼ä¸‹ï¼ŒæŒ‡é’ˆéƒ½è¢«ä¼ é€’ä¸ºæŒ‡å‘constçš„æŒ‡é’ˆã€‚vectorå’Œstringçš„æ•°æ®åªèƒ½ä¼ ç»™åªè¯»å–è€Œä¸ä¿®æ”¹å®ƒçš„APIã€‚ å¦‚æœä½ å°†randyä¼ ç»™ä¸€ä¸ªä¿®æ”¹å…¶å…ƒç´ çš„Cé£æ ¼APIçš„è¯ï¼Œå…¸å‹æƒ…å†µéƒ½æ˜¯æ²¡é—®é¢˜ï¼Œä½†è¢«è°ƒç”¨çš„å‡½æ•°ç»ä¸èƒ½è¯•å›¾æ”¹å˜vectorä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚å¦åˆ™ï¼Œrandyçš„å†…éƒ¨çŠ¶æ€å°†ä¼šå˜å¾—ä¸ä¸€è‡´ï¼Œv.size()å°†ä¼šå¾—åˆ°ä¸€ä¸ªä¸æ­£ç¡®çš„ç»“æœã€‚ æŠŠä¸€ä¸ªvectorä¼ é€’ç»™éœ€è¦ä¿®æ”¹vectoræ•°æ®çš„APIï¼Œä¸€å®šè¦ç¡®ä¿è¿™äº›é¢å¤–é™åˆ¶ç»§ç»­è¢«æ»¡è¶³ï¼Œæ¯”å¦‚æ˜¯å¦éœ€è¦ä¿æŒåŸæ¥vectorä¸­å…ƒç´ çš„é¡ºåºã€‚ ","date":"2023-08-07","objectID":"/posts/clause_16/:1:2","tags":["Effective STL"],"title":"Effective STL [16] | å¦‚ä½•å°†vectorå’Œstringçš„æ•°æ®ä¼ ç»™é—ç•™çš„API","uri":"/posts/clause_16/"},{"categories":["C++"],"content":"Cé£æ ¼APIè¿”å›çš„å…ƒç´ åˆå§‹åŒ–STLå®¹å™¨ ","date":"2023-08-07","objectID":"/posts/clause_16/:2:0","tags":["Effective STL"],"title":"Effective STL [16] | å¦‚ä½•å°†vectorå’Œstringçš„æ•°æ®ä¼ ç»™é—ç•™çš„API","uri":"/posts/clause_16/"},{"categories":["C++"],"content":"åˆå§‹åŒ–vector åˆ©ç”¨vectorå’Œæ•°ç»„æ½œåœ¨çš„å†…å­˜åˆ†å¸ƒå…¼å®¹æ€§å°†å­˜å‚¨vecotrçš„å…ƒç´ çš„ç©ºé—´ä¼ ç»™APIå‡½æ•°ï¼š // C APIï¼šæ­¤å‡½æ•°éœ€è¦ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼Œæ•°ç»„æœ€å¤šæœ‰arraySizeä¸ªdouble // è€Œä¸”ä¼šå¯¹æ•°ç»„å†™å…¥æ•°æ®ã€‚å®ƒè¿”å›å†™å…¥çš„doubleæ•°ï¼Œä¸ä¼šå¤§äºarraySize size_t fillArray(double *pArray, size_t arraySize); vector\u003cdouble\u003e vd(maxNumDoubles); // å»ºç«‹ä¸€ä¸ªvectorï¼Œå®ƒçš„å¤§å°æ˜¯maxNumDoubles vd.resize(fillArray(\u0026vd[0], vd.size())); // è®©fillArrayæŠŠæ•°æ®å†™å…¥vdï¼Œç„¶åè°ƒæ•´vdçš„å¤§å°ä¸ºfillArrayå†™å…¥çš„å…ƒç´ ä¸ªæ•° è¿™ä¸ªæŠ€å·§åªèƒ½å·¥ä½œäºvectorï¼Œå› ä¸ºåªæœ‰vectoræ‰¿è¯ºäº†ä¸æ•°ç»„å…·æœ‰ç›¸åŒçš„æ½œåœ¨å†…å­˜åˆ†å¸ƒã€‚ ","date":"2023-08-07","objectID":"/posts/clause_16/:2:1","tags":["Effective STL"],"title":"Effective STL [16] | å¦‚ä½•å°†vectorå’Œstringçš„æ•°æ®ä¼ ç»™é—ç•™çš„API","uri":"/posts/clause_16/"},{"categories":["C++"],"content":"åˆå§‹åŒ–string åªè¦è®©APIå°†æ•°æ®æ”¾å…¥ä¸€ä¸ªvector\u003cchar\u003eï¼Œç„¶åä»vectorä¸­å°†æ•°æ®æ‹·åˆ°stringï¼š // C APIï¼šæ­¤å‡½æ•°éœ€è¦ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼Œæ•°ç»„æœ€å¤šæœ‰arraySizeä¸ªchar // è€Œä¸”ä¼šå¯¹æ•°ç»„å†™å…¥æ•°æ®ã€‚å®ƒè¿”å›å†™å…¥çš„charæ•°ï¼Œä¸ä¼šå¤§äºarraySize size_t fillString(char *pArray, size_t arraySize); vector\u003cchar\u003e vc(maxNumChars); // å»ºç«‹ä¸€ä¸ªvectorï¼Œå®ƒçš„å¤§å°æ˜¯maxNumChars size_t charsWritten = fillString(\u0026vc[0], vc.size()); // è®©fillStringæŠŠæ•°æ®å†™å…¥vc string s(vc.begin(), vc.begin() + charsWritten); // ä»vcé€šè¿‡èŒƒå›´æ„é€ å‡½æ•°æ‹·è´æ•°æ®åˆ°s ","date":"2023-08-07","objectID":"/posts/clause_16/:2:2","tags":["Effective STL"],"title":"Effective STL [16] | å¦‚ä½•å°†vectorå’Œstringçš„æ•°æ®ä¼ ç»™é—ç•™çš„API","uri":"/posts/clause_16/"},{"categories":["C++"],"content":"åˆå§‹åŒ–å…¶ä»–STLå®¹å™¨ é€šç”¨æ–¹æ³•ï¼šCé£æ ¼APIæŠŠæ•°æ®æ”¾å…¥ä¸€ä¸ªvectorï¼Œç„¶åæ‹·åˆ°å®é™…æƒ³è¦çš„STLå®¹å™¨ size_t fillArray(double *pArray, size_t arraySize); // åŒä¸Š vector\u003cdouble\u003e vd(maxNumDoubles); // ä¸€æ ·åŒä¸Š vd.resize(fillArray(\u0026vd[0], vd.size())); deque\u003cdouble\u003e d(vd.begin(), vd.end()); // æ‹·è´æ•°æ®åˆ°deque list\u003cdouble\u003e l(vd.begin(), vd.end()); // æ‹·è´æ•°æ®åˆ°list set\u003cdouble\u003e s(vd.begin(), vd.end()); // æ‹·è´æ•°æ®åˆ°set ","date":"2023-08-07","objectID":"/posts/clause_16/:2:3","tags":["Effective STL"],"title":"Effective STL [16] | å¦‚ä½•å°†vectorå’Œstringçš„æ•°æ®ä¼ ç»™é—ç•™çš„API","uri":"/posts/clause_16/"},{"categories":["C++"],"content":"STLå®¹å™¨ä¼ é€’ç»™C API STLå®¹å™¨å°†å®ƒä»¬çš„æ•°æ®ä¼ ç»™Cé£æ ¼APIï¼Œåªè¦å°†å®¹å™¨çš„æ¯ä¸ªæ•°æ®æ‹·åˆ°vectorï¼Œç„¶åå°†vectorä¼ ç»™API: void doSomething(const int*pints, size_t numInts); // C API (åŒä¸Š) set\u003cint\u003e intSet; // ä¿å­˜è¦ä¼ é€’ç»™APIæ•°æ®çš„set ... vector\u003cint\u003e v(intSet.begin(), intSet.end()); // æ‹·è´setæ•°æ®åˆ°vector if (!v.empty()) doSomething(\u0026v[0], v.size()); // ä¼ é€’æ•°æ®åˆ°API å¦‚æœåœ¨ç¼–è¯‘æœŸå°±çŸ¥é“å®¹å™¨çš„å¤§å°ï¼Œå¯ä»¥å°†æ•°æ®æ‹·è¿›ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åå°†æ•°ç»„ä¼ ç»™Cé£æ ¼çš„APIï¼Œå¦åˆ™ä¸å¾—ä¸åˆ†é…åŠ¨æ€æ•°ç»„ã€‚ ","date":"2023-08-07","objectID":"/posts/clause_16/:2:4","tags":["Effective STL"],"title":"Effective STL [16] | å¦‚ä½•å°†vectorå’Œstringçš„æ•°æ®ä¼ ç»™é—ç•™çš„API","uri":"/posts/clause_16/"},{"categories":["C++"],"content":"sizeof(string)çš„å€¼ å¦‚æœæƒ³çŸ¥é“sizeof(string)çš„å€¼æ˜¯å¤šå°‘ï¼Œç­”æ¡ˆä¸ä¸€å®šã€‚ stringå’Œchar*æŒ‡é’ˆä¸€æ ·å¤§çš„å®ç°å¾ˆå¸¸è§ï¼Œä¹Ÿå¾ˆå®¹æ˜“æ‰¾åˆ°stringæ˜¯char*7 å€å¤§å°çš„stringå®ç°ã€‚ æ‰€ä»¥å¾—äº†è§£ä¸€ä¸‹stringçš„å®ç° ","date":"2023-08-04","objectID":"/posts/clause_15/:1:0","tags":["Effective"],"title":"Effective STL [15] | å°å¿ƒstringå®ç°çš„å¤šæ ·æ€§","uri":"/posts/clause_15/"},{"categories":["C++"],"content":"stringçš„å®ç° åŸºæœ¬å®ç° å­—ç¬¦ä¸²çš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯åŒ…å«çš„å­—ç¬¦çš„æ•°ç›®ã€‚ å®¹çº³å­—ç¬¦ä¸²å­—ç¬¦çš„å†…å­˜å®¹é‡ã€‚ å­—ç¬¦ä¸²çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ„æˆè¿™ä¸ªå­—ç¬¦ä¸²çš„å­—ç¬¦ã€‚ å¯èƒ½å®ç° é…ç½®å™¨çš„æ‹·è´ ä¾èµ–å¼•ç”¨è®¡æ•°çš„stringå®ç°s åŒ…å«è¿™ä¸ªå€¼çš„å¼•ç”¨è®¡æ•° ","date":"2023-08-04","objectID":"/posts/clause_15/:2:0","tags":["Effective"],"title":"Effective STL [15] | å°å¿ƒstringå®ç°çš„å¤šæ ·æ€§","uri":"/posts/clause_15/"},{"categories":["C++"],"content":"4ç§ä¸åŒçš„stringå®ç°æ•°æ®ç»“æ„ ä»¥ä¸‹æ˜¯åŸä½œè€…çœ‹åˆ°çš„4ä¸ªæºç çš„stringçš„å®ç° A æ¯ä¸ªstringå¯¹è±¡åŒ…å«ä¸€ä¸ªé…ç½®å™¨çš„æ‹·è´ï¼Œå­—ç¬¦ä¸²çš„å¤§å°(size)ï¼Œå®¹é‡(capacity)ï¼Œä¸€ä¸ªæŒ‡å‘åŒ…å«å¼•ç”¨è®¡æ•°ï¼ˆâ€œRefCntâ€ï¼‰å’Œå­—ç¬¦ä¸²å€¼çš„åŠ¨æ€åˆ†é…çš„ç¼“å†²åŒºçš„æŒ‡é’ˆã€‚ åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œä¸€ä¸ªä½¿ç”¨é»˜è®¤é…ç½®å™¨çš„å­—ç¬¦ä¸²å¯¹è±¡æ˜¯æŒ‡é’ˆå¤§å°çš„4å€ã€‚å¯¹äºä¸€ä¸ªè‡ªå®šä¹‰çš„é…ç½®å™¨ï¼Œstringå¯¹è±¡ä¼šéšé…ç½®å™¨å¯¹è±¡çš„å¢å¤§è€Œå˜å¤§ï¼š B Bçš„stringå¯¹è±¡å’ŒæŒ‡é’ˆä¸€æ ·å¤§ï¼Œå› ä¸ºåœ¨ç»“æ„ä½“ä¸­åªåŒ…å«ä¸€ä¸ªæŒ‡é’ˆã€‚å†æ¬¡ï¼Œè¿™é‡Œå‡è®¾ä½¿ç”¨é»˜è®¤é…ç½®å™¨ã€‚æ­£å¦‚å®ç°Aï¼Œå¦‚æœä½¿ç”¨è‡ªå®šä¹‰é…ç½®å™¨ï¼Œè¿™ä¸ªstringå¯¹è±¡çš„å¤§å°ä¼šå¢åŠ å¤§çº¦é…ç½®å™¨å¯¹è±¡çš„å¤§å°ã€‚ åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œä½¿ç”¨é»˜è®¤é…ç½®å™¨ä¸å ç”¨ç©ºé—´ï¼Œè¿™å½’åŠŸäºè¿™é‡Œç”¨äº†ä¸€ä¸ªåœ¨å®ç°Aä¸­æ²¡æœ‰çš„ä½¿ç”¨ä¼˜åŒ–ã€‚ Bçš„stringæŒ‡å‘çš„å¯¹è±¡åŒ…å«å­—ç¬¦ä¸²çš„å¤§å°ã€å®¹é‡å’Œå¼•ç”¨è®¡æ•°ï¼Œä»¥åŠå®¹çº³å­—ç¬¦ä¸²å€¼çš„åŠ¨æ€åˆ†é…ç¼“å†²åŒºçš„æŒ‡é’ˆåŠ\"å…¶ä»–\"ã€‚â€œå…¶ä»–â€æŒ‡å¯¹è±¡åŒ…å«åœ¨å¤šçº¿ç¨‹ç³»ç»Ÿä¸­ä¸å¹¶å‘æ§åˆ¶æœ‰å…³çš„ä¸€äº›é™„åŠ æ•°æ®ã€‚ åœ¨å®ç°Bä¸­ï¼Œç”¨äºå¹¶å‘æ§åˆ¶çš„æ•°æ®æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¤§å°çš„6å€ã€‚ C Cçš„stringå¯¹è±¡æ€»æ˜¯ç­‰äºæŒ‡é’ˆçš„å¤§å°ï¼Œä½†æ˜¯è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¸stringç›¸å…³çš„ä¸œè¥¿çš„åŠ¨æ€åˆ†é…ç¼“å†²å™¨ï¼šå¤§å°ã€å®¹é‡ã€å¼•ç”¨è®¡æ•°å’Œå€¼ã€‚æ²¡æœ‰æ¯ç‰©ä½“é…ç½®å™¨ï¼ˆper-object allocatorï¼‰çš„æ”¯æŒã€‚ç¼“å†²åŒºä¹Ÿå®¹çº³ä¸€äº›å…³äºå€¼å¯å…±äº«æ€§çš„æ•°æ®ï¼Œæ ‡è®°ä¸ºâ€œXâ€ã€‚ D Dçš„stringå¯¹è±¡æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¤§å°çš„7å€ï¼ˆä»ç„¶å‡è®¾ä½¿ç”¨äº†é»˜è®¤é…ç½®å™¨ï¼‰ã€‚è¿™ä¸ªå®ç°æ²¡æœ‰ä½¿ç”¨å¼•ç”¨è®¡æ•°ï¼Œä½†æ¯ä¸ªstringåŒ…å«äº†ä¸€ä¸ªè¶³ä»¥è¡¨ç°æœ€å¤š15ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²å€¼çš„å†…éƒ¨ç¼“å†²åŒºã€‚ å› æ­¤å°çš„å­—ç¬¦ä¸²å¯ä»¥è¢«æ•´ä¸ªä¿å­˜åœ¨stringå¯¹è±¡ä¸­ï¼Œä¸€ä¸ªæœ‰æ—¶è¢«ç§°ä¸ºâ€œå°å­—ç¬¦ä¸²ä¼˜åŒ–â€çš„ç‰¹æ€§ã€‚ å½“ä¸€ä¸ªstringçš„å®¹é‡è¶…è¿‡15æ—¶ï¼Œç¼“å†²å™¨çš„ç¬¬ä¸€éƒ¨åˆ†è¢«ç”¨ä½œæŒ‡å‘åŠ¨æ€åˆ†é…å†…å­˜çš„ä¸€ä¸ªæŒ‡é’ˆï¼Œè€Œå­—ç¬¦ä¸²çš„å€¼å­˜æ”¾åœ¨é‚£å—å†…å­˜ä¸­ï¼š g++ 9.4.0ä¸­çš„å®ç° template\u003ctypename _CharT, typename _Traits, typename _Alloc\u003e class basic_string { typedef typename __gnu_cxx::__alloc_traits\u003c_Alloc\u003e::template rebind\u003c_CharT\u003e::other _Char_alloc_type; typedef __gnu_cxx::__alloc_traits\u003c_Char_alloc_type\u003e _Alloc_traits; // Types: public: typedef _Traits traits_type; typedef typename _Traits::char_type value_type; typedef _Char_alloc_type allocator_type; typedef typename _Alloc_traits::size_type size_type; typedef typename _Alloc_traits::difference_type difference_type; typedef typename _Alloc_traits::reference reference; typedef typename _Alloc_traits::const_reference const_reference; typedef typename _Alloc_traits::pointer pointer; typedef typename _Alloc_traits::const_pointer const_pointer; typedef __gnu_cxx::__normal_iterator\u003cpointer, basic_string\u003e iterator; typedef __gnu_cxx::__normal_iterator\u003cconst_pointer, basic_string\u003e const_iterator; typedef std::reverse_iterator\u003cconst_iterator\u003e const_reverse_iterator; typedef std::reverse_iterator\u003citerator\u003e reverse_iterator; /// Value returned by various member functions when they fail. static const size_type npos = static_cast\u003csize_type\u003e(-1); } sizeof(string) ä¸¾ä¾‹ï¼š string s(\"Randy\"); // 5ä¸ªå­—ç¬¦ å®ç°Aæœ‰32ä¸ªå­—ç¬¦çš„æœ€å°åˆ†é…å¤§å°ï¼Œæ‰€ä»¥è™½ç„¶sçš„å¤§å°æ˜¯5ï¼Œåœ¨å®ç°Aä¸‹å®¹é‡æ˜¯31ã€‚ï¼ˆç¬¬32ä¸ªå­—ç¬¦å¤§æ¦‚è¢«ä¿ç•™ä½œå°¾éƒ¨çš„nullï¼Œå› æ­¤å¯ä»¥å®¹æ˜“åœ°å®ç°c_stræˆå‘˜å‡½æ•°ã€‚ï¼‰ å®ç°Cæœ€å°é‡16ï¼Œè€Œä¸”æ²¡æœ‰ä¸ºå°¾éƒ¨nullä¿ç•™ç©ºé—´ã€‚æ‰€ä»¥åœ¨å®ç°Cä¸‹ï¼Œsçš„å®¹é‡æ˜¯16ã€‚ å®ç°Dçš„æœ€å°ç¼“å†²åŒºå¤§å°ä¹Ÿæ˜¯16ï¼ŒåŒ…æ‹¬å°¾éƒ¨nullçš„ç©ºé—´ã€‚å½“ç„¶ï¼Œåœ¨è¿™é‡ŒåŒºåˆ«å‡ºå®ç°Dæ˜¯å› ä¸ºå®¹é‡å°äº16çš„å­—ç¬¦ä¸²ä½¿ç”¨çš„å†…å­˜åŒ…å«åœ¨æœ¬èº«å­—ç¬¦ä¸²å¯¹è±¡ä¸­ã€‚ å®ç°Bæ²¡æœ‰æœ€å°åˆ†é…ï¼Œåœ¨å®ç°Bä¸‹ï¼Œsçš„å®¹é‡æ˜¯7ã€‚ åŠ¨æ€åˆ†é… åœ¨å®ç°Dä¸‹å°†ä¼šæ²¡æœ‰åŠ¨æ€åˆ†é…ï¼Œåœ¨å®ç°Aå’ŒC 1æ¬¡ï¼Œè€Œåœ¨å®ç°B 2æ¬¡ï¼ˆä¸€æ¬¡æ˜¯stringå¯¹è±¡æŒ‡å‘çš„å¯¹è±¡ï¼Œä¸€æ¬¡æ˜¯é‚£ä¸ªå¯¹è±¡æŒ‡å‘çš„å­—ç¬¦ç¼“å†²åŒºï¼‰ã€‚ å¦‚æœå…³å¿ƒåŠ¨æ€åˆ†é…å’Œå›æ”¶å†…å­˜çš„æ¬¡æ•°ï¼Œæˆ–å¦‚æœå…³å¿ƒç»å¸¸ä¼´éšè¿™æ ·åˆ†é…çš„å†…å­˜å¼€é”€ï¼Œä½ å¯èƒ½æƒ³è¦é¿å¼€å®ç°Bã€‚ å¦ä¸€æ–¹é¢ï¼Œ å®ç°Bçš„æ•°æ®ç»“æ„åŒ…æ‹¬äº†å¯¹å¤šçº¿ç¨‹ç³»ç»Ÿå¹¶å‘æ§åˆ¶çš„ç‰¹æ®Šæ”¯æŒçš„äº‹å®æ„å‘³ç€å®ƒæ¯”å®ç°Aæˆ–Cæ›´èƒ½æ»¡è¶³ä½ çš„éœ€è¦ï¼Œå°½ç®¡åŠ¨æ€åˆ†é…æ¬¡æ•°è¾ƒå¤šã€‚ å®ç°Dä¸éœ€è¦å¯¹å¤šçº¿ç¨‹çš„ç‰¹æ®Šæ”¯æŒï¼Œå› ä¸ºå®ƒä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°ã€‚ åœ¨åŸºäºå¼•ç”¨è®¡æ•°çš„è®¾è®¡ä¸­ï¼Œå­—ç¬¦ä¸²å¯¹è±¡ä¹‹å¤–çš„æ¯ä¸ªä¸œè¥¿éƒ½å¯ä»¥è¢«å¤šä¸ªå­—ç¬¦ä¸²å…±äº«ï¼ˆå¦‚æœå®ƒä»¬æœ‰ç›¸åŒçš„å€¼ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»å›¾ä¸­è§‚å¯Ÿåˆ°çš„å…¶ä»–ä¸œè¥¿æ˜¯å®ç°Aæ¯”Bæˆ–Cæä¾›æ›´å°‘çš„å…±äº«æ€§ã€‚ ç‰¹åˆ«æ˜¯ï¼Œå®ç°Bå’ŒCèƒ½å…±äº«ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¤§å°å’Œå®¹é‡ï¼Œå› æ­¤æ½œåœ¨åœ°å‡å°‘äº†æ¯ç‰©ä½“åˆ†æ‘Šçš„çš„å‚¨å­˜æ•°æ®çš„å¼€é”€ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œå®ç°Cä¸èƒ½æ”¯æŒæ¯å¯¹è±¡é…ç½®å™¨çš„äº‹å®æ„å‘³ç€å®ƒæ˜¯å”¯ä¸€å¯ä»¥å…±äº«é…ç½®å™¨çš„å®ç°ï¼šæ‰€æœ‰å­—ç¬¦ä¸²å¿…é¡»ä½¿ç”¨åŒä¸€ä¸ªï¼ å®ç°Dåœ¨å­—ç¬¦ä¸²å¯¹è±¡é—´æ²¡æœ‰å…±äº«æ•°æ®ã€‚ ","date":"2023-08-04","objectID":"/posts/clause_15/:3:0","tags":["Effective"],"title":"Effective STL [15] | å°å¿ƒstringå®ç°çš„å¤šæ ·æ€§","uri":"/posts/clause_15/"},{"categories":["C++"],"content":"æ€»ç»“ ä¸åŒçš„å®ç°ä»¥ä¸åŒçš„æ–¹å¼ä»å®ƒä»¬çš„è®¾è®¡çµæ´»æ€§ä¸­å¾—åˆ°å¥½å¤„ï¼š å­—ç¬¦ä¸²å€¼å¯èƒ½æ˜¯æˆ–å¯èƒ½ä¸æ˜¯å¼•ç”¨è®¡æ•°çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¾ˆå¤šå®ç°çš„ç¡®æ˜¯ç”¨äº†å¼•ç”¨è®¡æ•°ï¼Œä½†å®ƒä»¬é€šå¸¸æä¾›äº†å…³é—­çš„æ–¹æ³•ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡é¢„å¤„ç†å™¨å®ã€‚æ¯”å¦‚ï¼Œå¼•ç”¨è®¡æ•°åªå¯¹é¢‘ç¹æ‹·è´çš„å­—ç¬¦ä¸²æœ‰å¸®åŠ©ï¼Œè€Œæœ‰äº›ç¨‹åºä¸ç»å¸¸æ‹·è´å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æ²¡æœ‰é‚£ä¸ªå¼€é”€ stringå¯¹è±¡çš„å¤§å°å¯èƒ½ä»1åˆ°è‡³å°‘7å€char*æŒ‡é’ˆçš„å¤§å° æ–°å­—ç¬¦ä¸²å€¼çš„å»ºç«‹å¯èƒ½éœ€è¦0ã€1æˆ–2æ¬¡åŠ¨æ€åˆ†é… stringå¯¹è±¡å¯èƒ½æ˜¯æˆ–å¯èƒ½ä¸å…±äº«å­—ç¬¦ä¸²çš„å¤§å°å’Œå®¹é‡ä¿¡æ¯ stringå¯èƒ½æ˜¯æˆ–å¯èƒ½ä¸æ”¯æŒæ¯å¯¹è±¡é…ç½®å™¨ ä¸åŒå®ç°å¯¹äºæœ€å°åŒ–å­—ç¬¦ç¼“å†²åŒºçš„é…ç½®å™¨æœ‰ä¸åŒç­–ç•¥ stringæ˜¯æ ‡å‡†åº“ä¸­çš„æœ€é‡è¦çš„ç»„ä»¶ä¹‹ä¸€ï¼Œé¼“åŠ±åº”è¯¥è¦å¤šç”¨ã€‚ å¦‚æœè¦æœ‰æ•ˆä½¿ç”¨STLï¼Œéœ€è¦å°å¿ƒstringå®ç°çš„å¤šæ ·æ€§ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ æ­£åœ¨å†™å¿…é¡»åœ¨ä¸åŒSTLå¹³å°ä¸Šè¿è¡Œçš„ä»£ç å¹¶ä¸”ä½ é¢ä¸´ä¸¥æ ¼çš„æ€§èƒ½éœ€æ±‚ã€‚ ","date":"2023-08-04","objectID":"/posts/clause_15/:4:0","tags":["Effective"],"title":"Effective STL [15] | å°å¿ƒstringå®ç°çš„å¤šæ ·æ€§","uri":"/posts/clause_15/"},{"categories":["C++"],"content":"è‡ªåŠ¨æ‰©å®¹ STL å®¹å™¨åªè¦å­˜å‚¨çš„å¯¹è±¡ä¸è¶…è¿‡ã€Œæœ€å¤§å¤§å°ã€ï¼Œå°±å¯ä»¥è‡ªåŠ¨å¢é•¿åˆ°è¶³ä»¥å®¹çº³æ”¾è¿›å»çš„æ•°æ®ã€‚è¿™ä¸ªæœ€å¤§å€¼ï¼Œåªè¦è°ƒç”¨åå«max_sizeçš„æˆå‘˜å‡½æ•°å°±å¯ä»¥æŸ¥è¯¢åˆ°ã€‚ å¯¹äºvectorå’Œstringï¼Œåªè¦éœ€è¦æ›´å¤šç©ºé—´ï¼Œå°±ä»¥reallocç­‰ä»·çš„æ€æƒ³æ¥å¢é•¿ã€‚ reallocçš„æ“ä½œæœ‰4ä¸ªéƒ¨åˆ†ï¼š ã€Œåˆ†é…æ–°çš„å†…å­˜å—ã€ã€‚åœ¨å¤§éƒ¨åˆ†å®ç°ä¸­ï¼Œvectorå’Œstringçš„å®¹é‡æ¯æ¬¡ä»¥ã€Œ2ã€ä¸ºå› æ•°å¢é•¿ï¼Œå³å®¹é‡æ¯æ¬¡ç¿»å€ã€‚ ã€ŒæŠŠæ‰€æœ‰å…ƒç´ ä»å®¹å™¨çš„æ—§å†…å­˜æ‹·è´åˆ°æ–°å†…å­˜ã€ã€‚ ã€Œé”€æ¯æ—§å†…å­˜ä¸­çš„å¯¹è±¡ã€ã€‚ ã€Œå›æ”¶æ—§å†…å­˜ã€ã€‚ è¿™å°±æ˜¯åˆ†é…ï¼Œå›æ”¶ï¼Œæ‹·è´å’Œææ„4ä¸ªæ­¥éª¤ï¼Œè¿™äº›æ­¥éª¤ä»£ä»·éƒ½å¾ˆæ˜‚è´µã€‚ å³ä¾¿æ˜¯ç®€å•åœ°æŠŠä¸€ä¸ªå…ƒç´ æ’å…¥vectoræˆ–stringçš„åŠ¨ä½œä¹Ÿå¯èƒ½å› ä¸ºéœ€è¦æ›´æ–°å…¶ä»–ä½¿ç”¨äº†æŒ‡å‘vectoræˆ–stringä¸­çš„è¿­ä»£å™¨ã€æŒ‡é’ˆæˆ–å¼•ç”¨çš„æ•°æ®ç»“æ„è€Œè†¨èƒ€ã€‚ ","date":"2023-08-03","objectID":"/posts/clause_14/:1:0","tags":["Effective"],"title":"Effective STL [14] | ä½¿ç”¨reserveæ¥é¿å…ä¸å¿…è¦çš„é‡æ–°åˆ†é…","uri":"/posts/clause_14/"},{"categories":["C++"],"content":"4ä¸ªæˆå‘˜å‡½æ•° è¿™4ä¸ªSTLå®¹å™¨æˆå‘˜å‡½æ•°ï¼Œåªæœ‰vectorå’Œstringæä¾›äº†æ‰€æœ‰è¿™äº›å‡½æ•°ã€‚ æˆå‘˜å‡½æ•° è¯´æ˜ size() ã€Œå®¹å™¨ä¸­æœ‰å¤šå°‘å…ƒç´ ã€ã€‚æ²¡æœ‰è¯´æ˜å®¹å™¨ä¸ºå®¹çº³çš„å…ƒç´ åˆ†é…äº†å¤šå°‘å†…å­˜ã€‚ capacity() ã€Œå®¹å™¨å·²ç»åˆ†é…çš„å†…å­˜ä¸­å¯ä»¥å®¹çº³å¤šå°‘å…ƒç´ ã€ã€‚é‚£æ˜¯å®¹å™¨åœ¨é‚£å—å†…å­˜ä¸­æ€»å…±å¯ä»¥å®¹çº³å¤šå°‘å…ƒç´ ï¼Œè€Œä¸æ˜¯è¿˜å¯ä»¥å®¹çº³å¤šå°‘å…ƒç´ ã€‚å¦‚æœæƒ³çŸ¥é“ä¸€ä¸ªvectoræˆ–stringä¸­æœ‰å¤šå°‘æ²¡æœ‰è¢«å ç”¨çš„å†…å­˜ï¼Œå¿…é¡»ä»capacity()ä¸­å‡å»size()ã€‚å¦‚æœsizeå’Œcapacityè¿”å›åŒæ ·çš„å€¼ï¼Œå®¹å™¨ä¸­å°±æ²¡æœ‰å‰©ä½™ç©ºé—´äº†ï¼Œè€Œä¸‹ä¸€æ¬¡æ’å…¥ï¼ˆé€šè¿‡insertæˆ–push_backç­‰ï¼‰ä¼šå¼•å‘ä¸Šé¢çš„é‡æ–°åˆ†é…æ­¥éª¤ã€‚ resize(Container::size_type n) ã€Œå¼ºåˆ¶æŠŠå®¹å™¨æ”¹ä¸ºå®¹çº³nä¸ªå…ƒç´ ã€ã€‚è°ƒç”¨resizeä¹‹åï¼Œsizeå°†ä¼šè¿”å›nã€‚å¦‚æœnå°äºå½“å‰å¤§å°ï¼Œå®¹å™¨å°¾éƒ¨çš„å…ƒç´ ä¼šè¢«é”€æ¯ã€‚å¦‚æœnå¤§äºå½“å‰å¤§å°ï¼Œæ–°é»˜è®¤æ„é€ çš„å…ƒç´ ä¼šæ·»åŠ åˆ°å®¹å™¨å°¾éƒ¨ã€‚å¦‚æœnå¤§äºå½“å‰å®¹é‡ï¼Œåœ¨å…ƒç´ åŠ å…¥ä¹‹å‰ä¼šå‘ç”Ÿé‡æ–°åˆ†é…ã€‚ reserve(Container::size_type n) ã€Œå¼ºåˆ¶å®¹å™¨æŠŠå®ƒçš„å®¹é‡æ”¹ä¸ºè‡³å°‘nï¼Œæä¾›çš„nä¸å°äºå½“å‰å¤§å°ã€ã€‚è¿™ä¸€èˆ¬å¼ºè¿«è¿›è¡Œä¸€æ¬¡é‡æ–°åˆ†é…ï¼Œå› ä¸ºå®¹é‡éœ€è¦å¢åŠ ã€‚ reserveæˆå‘˜å‡½æ•°å…è®¸ä½ æœ€å°åŒ–å¿…é¡»è¿›è¡Œçš„é‡æ–°åˆ†é…çš„æ¬¡æ•°ï¼Œå› è€Œå¯ä»¥é¿å…çœŸåˆ†é…çš„å¼€é”€å’Œè¿­ä»£å™¨/æŒ‡é’ˆ/å¼•ç”¨å¤±æ•ˆã€‚ ã€Œè°ƒç”¨reserveä¸æ”¹å˜å®¹å™¨ä¸­å¯¹è±¡çš„ä¸ªæ•°ã€‚ã€ ","date":"2023-08-03","objectID":"/posts/clause_14/:2:0","tags":["Effective"],"title":"Effective STL [14] | ä½¿ç”¨reserveæ¥é¿å…ä¸å¿…è¦çš„é‡æ–°åˆ†é…","uri":"/posts/clause_14/"},{"categories":["C++"],"content":"æå‰ reserve ã€Œåªè¦æœ‰å…ƒç´ éœ€è¦æ’å…¥è€Œä¸”å®¹å™¨çš„å®¹é‡ä¸è¶³æ—¶å°±ä¼šå‘ç”Ÿé‡æ–°åˆ†é…ã€ï¼ˆåŒ…æ‹¬å®ƒä»¬ç»´æŠ¤çš„ã€ŒåŸå§‹å†…å­˜åˆ†é…å’Œå›æ”¶ã€ï¼Œã€Œå¯¹è±¡çš„æ‹·è´å’Œææ„ã€å’Œã€Œè¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨çš„å¤±æ•ˆã€ï¼‰ã€‚ ã€Œé¿å…é‡æ–°åˆ†é…çš„å…³é”®ã€æ˜¯ä½¿ç”¨reserveå°½å¿«æŠŠå®¹å™¨çš„å®¹é‡è®¾ç½®ä¸ºè¶³å¤Ÿå¤§ï¼Œæœ€å¥½åœ¨å®¹å™¨è¢«æ„é€ ä¹‹åç«‹åˆ»è¿›è¡Œã€‚ Example å‡å®šä½ æƒ³å»ºç«‹ä¸€ä¸ªå®¹çº³1-1000å€¼çš„vector\u003cint\u003eã€‚æ²¡æœ‰ä½¿ç”¨reserveï¼š vector\u003cint\u003e v; for (int i = 1; i \u003c= 1000; ++i) { v.push_back(i); } åœ¨å¤§å¤šæ•°STLå®ç°ä¸­ï¼Œè¿™æ®µä»£ç åœ¨å¾ªç¯è¿‡ç¨‹ä¸­ã€Œå°†ä¼šå¯¼è‡´2åˆ°10æ¬¡é‡æ–°åˆ†é…ã€ã€‚ï¼ˆã€Œvectoråœ¨é‡æ–°åˆ†é…æ—¶ä¸€èˆ¬æŠŠå®¹é‡ç¿»å€ã€ï¼Œ$1000 \\approx 2^{10}$ã€‚ï¼‰ æŠŠä»£ç æ”¹ä¸ºä½¿ç”¨reserveï¼š vector\u003cint\u003e v; v.reserve(1000); for (int i = 1; i \u003c= 1000; ++i) { v.push_back(i); } ã€Œè¿™åœ¨å¾ªç¯ä¸­ä¸ä¼šå‘ç”Ÿé‡æ–°åˆ†é…ã€‚ã€ ","date":"2023-08-03","objectID":"/posts/clause_14/:3:0","tags":["Effective"],"title":"Effective STL [14] | ä½¿ç”¨reserveæ¥é¿å…ä¸å¿…è¦çš„é‡æ–°åˆ†é…","uri":"/posts/clause_14/"},{"categories":["C++"],"content":"ç»“è®º é€šå¸¸æœ‰2ç§æƒ…å†µä½¿ç”¨reserveæ¥é¿å…ä¸å¿…è¦çš„é‡æ–°åˆ†é…: å¯ç”¨çš„æƒ…å†µæ˜¯ã€Œå½“ä½ ç¡®åˆ‡æˆ–è€…å¤§çº¦çŸ¥é“æœ‰å¤šå°‘å…ƒç´ å°†æœ€åå‡ºç°åœ¨å®¹å™¨ä¸­ã€ã€‚å¯ä»¥æå‰reserveé€‚å½“æ•°é‡çš„ç©ºé—´ã€‚ 2.ã€Œä¿ç•™å¯èƒ½éœ€è¦çš„æœ€å¤§çš„ç©ºé—´ã€ï¼Œç„¶åï¼Œä¸€æ—¦æ·»åŠ å®Œå…¨éƒ¨æ•°æ®ã€Œä¿®æ•´æ‰ä»»ä½•å¤šä½™çš„å®¹é‡ã€ã€‚ ","date":"2023-08-03","objectID":"/posts/clause_14/:4:0","tags":["Effective"],"title":"Effective STL [14] | ä½¿ç”¨reserveæ¥é¿å…ä¸å¿…è¦çš„é‡æ–°åˆ†é…","uri":"/posts/clause_14/"},{"categories":["C++"],"content":"ä½¿ç”¨newåŠ¨æ€åˆ†é…å†…å­˜æ—¶çš„æ³¨æ„äº‹é¡¹ å¿…é¡»ç¡®ä¿ä»¥åä¼šdeleteè¿™ä¸ªåˆ†é…ã€‚å¦‚æœåé¢æ²¡æœ‰deleteï¼Œã€Œnewå°±ä¼šäº§ç”Ÿä¸€ä¸ªèµ„æºæ³„æ¼ã€ã€‚ ä½ é¡»ç¡®ä¿ä½¿ç”¨äº†deleteçš„æ­£ç¡®å½¢å¼: å¦‚æœä½¿ç”¨äº†deleteçš„é”™è¯¯å½¢å¼ï¼Œç»“æœä¼šæœªå®šä¹‰ã€‚åœ¨ä¸€äº›å¹³å°ä¸Šï¼Œç¨‹åºåœ¨è¿è¡ŒæœŸä¼šå½“æ‰ã€‚å¦ä¸€æ–¹é¢ï¼Œæœ‰æ—¶å€™ä¼šé€ æˆèµ„æºæ³„æ¼ï¼Œä¸€äº›å†…å­˜ä¹Ÿéšä¹‹è€Œå»ã€‚ å¯¹äºåˆ†é…ä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œå¿…é¡»ä½¿ç”¨â€œdeleteâ€ã€‚ å¯¹äºåˆ†é…ä¸€ä¸ªæ•°ç»„ï¼Œå¿…é¡»ä½¿ç”¨â€œdelete []â€ã€‚ å¿…é¡»ç¡®ä¿åªdeleteä¸€æ¬¡ã€‚å¦‚æœä¸€ä¸ªåˆ†é…è¢«åˆ é™¤äº†ä¸æ­¢ä¸€æ¬¡ï¼Œç»“æœä¹Ÿä¼šæœªå®šä¹‰ã€‚ ","date":"2023-08-03","objectID":"/posts/clause_13/:1:0","tags":["Effective"],"title":"Effective STL [13] | å°½é‡ä½¿ç”¨vectorå’Œstringæ¥ä»£æ›¿åŠ¨æ€åˆ†é…çš„æ•°ç»„","uri":"/posts/clause_13/"},{"categories":["C++"],"content":"vectorå’Œstring vectorå’Œstringæ¶ˆé™¤äº†ä¸Šé¢çš„è´Ÿæ‹…ï¼Œå› ä¸ºå®ƒä»¬ç®¡ç†è‡ªå·±çš„å†…å­˜ã€‚ å½“å…ƒç´ æ·»åŠ åˆ°é‚£äº›å®¹å™¨ä¸­æ—¶å®ƒä»¬çš„å†…å­˜ä¼šå¢é•¿ï¼Œè€Œä¸”å½“ä¸€ä¸ªvectoræˆ–stringé”€æ¯æ—¶ï¼Œå®ƒçš„ææ„å‡½æ•°ä¼šè‡ªåŠ¨é”€æ¯å®¹å™¨ä¸­çš„å…ƒç´ ï¼Œå›æ”¶å­˜æ”¾é‚£äº›å…ƒç´ çš„å†…å­˜ã€‚ vectorå’Œstringæ˜¯ç¾½ç¿¼ä¸°æ»¡çš„åºåˆ—å®¹å™¨ã€‚ è™½ç„¶æ•°ç»„ä¹Ÿå¯ä»¥ç”¨äºSTLç®—æ³•ï¼Œä½†æ²¡æœ‰æä¾›åƒbeginã€endå’Œsizeè¿™æ ·çš„æˆå‘˜å‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰å†…åµŒåƒiteratorã€reverse_iteratoræˆ–value_typeé‚£æ ·çš„typedefã€‚è€Œä¸”char*æŒ‡é’ˆå½“ç„¶ä¸èƒ½å’Œæä¾›äº†ä¸“ç”¨æˆå‘˜å‡½æ•°çš„stringç«äº‰ã€‚STLç”¨çš„è¶Šå¤šï¼Œè¶Šä¼šæ­§è§†å†…å»ºçš„æ•°ç»„ã€‚ ","date":"2023-08-03","objectID":"/posts/clause_13/:2:0","tags":["Effective"],"title":"Effective STL [13] | å°½é‡ä½¿ç”¨vectorå’Œstringæ¥ä»£æ›¿åŠ¨æ€åˆ†é…çš„æ•°ç»„","uri":"/posts/clause_13/"},{"categories":["C++"],"content":"string è®¡æ•°é—®é¢˜ å¾ˆå¤šstringå®ç°åœ¨åå°ä½¿ç”¨äº†å¼•ç”¨è®¡æ•°ï¼Œã€Œä¸€ä¸ªæ¶ˆé™¤äº†ä¸å¿…è¦çš„å†…å­˜åˆ†é…å’Œå­—ç¬¦æ‹·è´çš„ç­–ç•¥ï¼Œè€Œä¸”åœ¨å¾ˆå¤šåº”ç”¨ä¸­å¯ä»¥æé«˜æ€§èƒ½ã€ã€‚ äº‹å®ä¸Šï¼Œä¸€èˆ¬è®¤ä¸ºé€šè¿‡å¼•ç”¨è®¡æ•°ä¼˜åŒ–å­—ç¬¦ä¸²å¾ˆé‡è¦ï¼Œæ‰€ä»¥C++æ ‡å‡†å§”å‘˜ä¼šç‰¹åˆ«è®¾æ³•ä¿è¯äº†é‚£æ˜¯ä¸€ä¸ªåˆæ³•çš„å®ç°ã€‚ å¤šçº¿ç¨‹ä½¿ç”¨ å¦‚æœä½ åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨äº†å¼•ç”¨è®¡æ•°çš„å­—ç¬¦ä¸²ï¼Œä½ å¯èƒ½å‘ç°ã€Œé¿å…åˆ†é…å’Œæ‹·è´æ‰€èŠ‚çœä¸‹çš„æ—¶é—´éƒ½èŠ±è´¹åœ¨åå°å¹¶å‘æ§åˆ¶ä¸Šã€äº†ï¼Œä¼šå› ä¸ºçº¿ç¨‹å®‰å…¨æ€§å¯¼è‡´çš„æ€§èƒ½ä¸‹é™ã€‚ å¦‚æœç”¨åˆ°çš„stringå®ç°æ˜¯å¼•ç”¨è®¡æ•°çš„ï¼Œè€Œä¸”å·²ç»ç¡®å®šstringçš„å¼•ç”¨è®¡æ•°åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­è¿è¡Œï¼Œé‚£ä¹ˆè‡³å°‘æœ‰3ä¸ªåˆç†çš„é€‰æ‹©ï¼Œè€Œä¸”æ²¡æœ‰ä¸€ä¸ªæ”¾å¼ƒäº†STLï¼š ã€Œçœ‹çœ‹åº“å®ç°æ˜¯å¦å¯ä»¥å…³é—­å¼•ç”¨è®¡æ•°ï¼Œé€šå¸¸æ˜¯é€šè¿‡æ”¹å˜é¢„å¤„ç†å˜é‡çš„å€¼ã€ï¼› å¯»æ‰¾æˆ–å¼€å‘ä¸€ä¸ªä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°çš„stringå®ç°ï¼ˆæˆ–éƒ¨åˆ†å®ç°ï¼‰æ›¿ä»£å“ï¼› ã€Œè€ƒè™‘ä½¿ç”¨vectoræ¥ä»£æ›¿stringï¼Œvectorå®ç°ä¸å…è®¸ä½¿ç”¨å¼•ç”¨è®¡æ•°ï¼Œæ‰€ä»¥éšè—çš„å¤šçº¿ç¨‹æ€§èƒ½é—®é¢˜ä¸ä¼šå‡ºç°äº†ã€ã€‚ å½“ç„¶ï¼Œä½¿ç”¨äº†vectorï¼Œå°±ç›¸å½“äºæ”¾å¼ƒäº†stringçš„ä¸“ç”¨æˆå‘˜å‡½æ•°ï¼Œä½†å¤§éƒ¨åˆ†åŠŸèƒ½ä»ç„¶å¯ä»¥é€šè¿‡STLç®—æ³•å¾—åˆ°ï¼Œæ‰€ä»¥ä»ä¸€ç§è¯­æ³•åˆ‡æ¢åˆ°å¦ä¸€ç§ä¸ä¼šå¤±å»å¾ˆå¤šåŠŸèƒ½ã€‚ ","date":"2023-08-03","objectID":"/posts/clause_13/:3:0","tags":["Effective"],"title":"Effective STL [13] | å°½é‡ä½¿ç”¨vectorå’Œstringæ¥ä»£æ›¿åŠ¨æ€åˆ†é…çš„æ•°ç»„","uri":"/posts/clause_13/"},{"categories":["C++"],"content":"ç»“è®º å¦‚æœä½ åœ¨ä½¿ç”¨åŠ¨æ€åˆ†é…æ•°ç»„ï¼Œä½ å¯èƒ½æ¯”éœ€è¦çš„åšæ›´å¤šçš„å·¥ä½œã€‚ è¦å‡è½»ä½ çš„è´Ÿæ‹…ï¼Œå°±ä½¿ç”¨vectoræˆ–stringæ¥ä»£æ›¿ã€‚ ","date":"2023-08-03","objectID":"/posts/clause_13/:4:0","tags":["Effective"],"title":"Effective STL [13] | å°½é‡ä½¿ç”¨vectorå’Œstringæ¥ä»£æ›¿åŠ¨æ€åˆ†é…çš„æ•°ç»„","uri":"/posts/clause_13/"},{"categories":["C++"],"content":"å¤šçº¿ç¨‹ç»´æŠ¤çš„è§„åˆ™ å¤šçº¿ç¨‹ç¨‹åºæ˜¯å¾ˆæ™®éçš„ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†STLå‚å•†åŠªåŠ›ä½¿ä»–ä»¬çš„å®ç°åœ¨çº¿ç¨‹ç¯å¢ƒä¸­å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ ä½†æ˜¯ï¼Œå³ä½¿ä»–ä»¬åšå¾—å¾ˆå¥½ï¼Œã€Œå¤§éƒ¨åˆ†è´Ÿæ‹…ä»åœ¨ä½ è‚©ä¸Šï¼Œè€Œç†è§£ä¸ºä»€ä¹ˆä¼šè¿™æ ·æ˜¯å¾ˆé‡è¦çš„ã€ã€‚ åœ¨STLå®¹å™¨ï¼ˆå’Œå¤§å¤šæ•°å‚å•†çš„æ„¿æœ›ï¼‰é‡Œå¯¹å¤šçº¿ç¨‹æ”¯æŒçš„é»„é‡‘è§„åˆ™å·²ç»ç”±SGIå®šä¹‰ï¼Œå¹¶ä¸”åœ¨å®ƒä»¬çš„STLç½‘ç«™ä¸Šå‘å¸ƒï¼š ã€Œå¤šä¸ªè¯»å–è€…æ˜¯å®‰å…¨çš„ã€ã€‚å¤šçº¿ç¨‹å¯èƒ½åŒæ—¶è¯»å–ä¸€ä¸ªå®¹å™¨çš„å†…å®¹ï¼Œåœ¨è¯»å–æ—¶ã€Œä¸èƒ½æœ‰ä»»ä½•å†™å…¥è€…æ“ä½œè¿™ä¸ªå®¹å™¨ã€ã€‚ ã€Œå¯¹ä¸åŒå®¹å™¨çš„å¤šä¸ªå†™å…¥è€…æ˜¯å®‰å…¨çš„ã€ã€‚å¤šçº¿ç¨‹å¯ä»¥åŒæ—¶å†™ä¸åŒçš„å®¹å™¨ã€‚å¯¹åŒä¸€ä¸ªå®¹å™¨åŒæ—¶å¤šçº¿ç¨‹å†™å…¥æ˜¯ä¸å®‰å…¨çš„ã€‚ ","date":"2023-08-02","objectID":"/posts/clause_12/:1:0","tags":["Effective","STL"],"title":"Effective STL [12] | å¯¹STLå®¹å™¨çº¿ç¨‹å®‰å…¨æ€§çš„æœŸå¾…ç°å®ä¸€äº›","uri":"/posts/clause_12/"},{"categories":["C++"],"content":"å®Œå…¨çº¿ç¨‹å®‰å…¨ï¼Ÿ å¾ˆå¤šç¨‹åºå‘˜å¸Œæœ›STLå®ç°æ˜¯å®Œå…¨çº¿ç¨‹å®‰å…¨ï¼Œè¿™éå¸¸éš¾ä»¥å®ç°ã€‚ ä¸€ä¸ªåº“å¯èƒ½è¯•å›¾ä»¥ä¸‹åˆ—æ–¹å¼å®ç°è¿™æ ·å®Œå…¨çº¿ç¨‹å®‰å…¨çš„å®¹å™¨ï¼š æ¯æ¬¡è°ƒç”¨å®¹å™¨çš„æˆå‘˜å‡½æ•°æœŸé—´éƒ½è¦é”å®šè¯¥å®¹å™¨ã€ åœ¨ã€Œæ¯ä¸ªå®¹å™¨è¿”å›çš„è¿­ä»£å™¨(ä¾‹å¦‚é€šè¿‡è°ƒç”¨beginæˆ–end)çš„ç”Ÿå­˜æœŸä¹‹å†…éƒ½è¦é”å®šè¯¥å®¹å™¨ã€ åœ¨ã€Œæ¯ä¸ªåœ¨å®¹å™¨ä¸Šè°ƒç”¨çš„ç®—æ³•æ‰§è¡ŒæœŸé—´é”å®šè¯¥å®¹å™¨ã€ã€‚ï¼ˆè¿™äº‹å®ä¸Šæ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºç®—æ³•æ²¡æœ‰åŠæ³•è¯†åˆ«å‡ºå®ƒä»¬æ­£åœ¨æ“ä½œçš„å®¹å™¨ï¼‰ ","date":"2023-08-02","objectID":"/posts/clause_12/:2:0","tags":["Effective","STL"],"title":"Effective STL [12] | å¯¹STLå®¹å™¨çº¿ç¨‹å®‰å…¨æ€§çš„æœŸå¾…ç°å®ä¸€äº›","uri":"/posts/clause_12/"},{"categories":["C++"],"content":"Example å¤šçº¿ç¨‹ä¿®æ”¹ æœå¯»ä¸€ä¸ªvectorä¸­ç¬¬ä¸€æ¬¡å‡ºç°3è¿™ä¸ªå€¼çš„åœ°æ–¹ï¼Œå¦‚æœå®ƒæ‰¾åˆ°äº†ï¼Œå°±æŠŠè¿™ä¸ªå€¼æ”¹ä¸º2ã€‚ vector\u003cint\u003e v; vector\u003cint\u003e::iterator first3(find(v.begin(), v.end(), 3)); // line 1 if (first3 != v.end()){ // line 2 *first3 = 2; // line 3 } å¤šçº¿ç¨‹è®¿é—®æ—¶ï¼Œä¼šæœ‰å¾ˆå¤šã€Œé—®é¢˜ã€: åœ¨å¤šçº¿ç¨‹ç¯å¢ƒé‡Œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¯èƒ½åœ¨è¡Œ1å®Œæˆä¹‹åç«‹åˆ»ä¿®æ”¹vä¸­çš„æ•°æ®ã€‚å¦‚æœæ˜¯é‚£æ ·ï¼Œè¡Œ2å¯¹first3å’Œv.endçš„æ£€æµ‹å°†æ˜¯æ— æ„ä¹‰çš„ï¼Œå› ä¸ºvçš„å€¼å¯èƒ½å’Œå®ƒä»¬åœ¨è¡Œ1ç»“æŸæ—¶çš„å€¼ä¸åŒã€‚ è¿™æ ·çš„æ£€æµ‹ä¼šäº§ç”Ÿæœªå®šä¹‰çš„ç»“æœï¼Œå› ä¸ºå¦ä¸€çº¿ç¨‹å¯èƒ½æ’åœ¨è¡Œ1å’Œè¡Œ2ä¹‹é—´ï¼Œä½¿first3å¤±æ•ˆï¼Œæˆ–è®¸é€šè¿‡è¿›è¡Œä¸€æ¬¡æ’å…¥æ“ä½œé€ æˆvectoré‡æ–°åˆ†é…å®ƒçš„å†…åœ¨å†…å­˜ã€‚ï¼ˆé‚£å°†ä½¿vectorå…¨éƒ¨çš„è¿­ä»£å™¨å¤±æ•ˆï¼‰ è¡Œ3ä¸­å¯¹*first3çš„èµ‹å€¼æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¦ä¸€ä¸ªçº¿ç¨‹å¯èƒ½åœ¨è¡Œ2å’Œè¡Œ3ä¹‹é—´æ‰§è¡Œï¼Œå¹¶ä»¥æŸç§æ–¹å¼ä½¿first3å¤±æ•ˆï¼Œå¯èƒ½é€šè¿‡åˆ é™¤å®ƒæŒ‡å‘ï¼ˆæˆ–è‡³å°‘æ›¾ç»æŒ‡å‘ï¼‰çš„å…ƒç´ ã€‚ è§£å†³åŠæ³•ï¼šåŠ é” è¦è®©ä¸Šé¢çš„ä»£ç æˆä¸ºçº¿ç¨‹å®‰å…¨çš„ï¼Œã€Œvå¿…é¡»ä»è¡Œ1åˆ°è¡Œ3ä¿æŒé”å®šã€ï¼Œè®©æœ€å¤šä¸€ä¸ªçº¿ç¨‹åœ¨1-3è¡Œçš„è¿‡ç¨‹ä¸­èƒ½è®¿é—®vã€‚å¾ˆéš¾æƒ³è±¡STLå®ç°æ€ä¹ˆèƒ½è‡ªåŠ¨æ¨æ–­å‡ºè¿™ä¸ªã€‚ è€Œã€ŒåŒæ­¥åŸè¯­ï¼ˆä¾‹å¦‚ï¼Œä¿¡å·ç¯ï¼Œäº’æ–¥é‡ï¼Œç­‰ç­‰ï¼‰é€šå¸¸å¼€é”€å¾ˆå¤§ã€ï¼Œæ›´éš¾æƒ³è±¡æ€ä¹ˆå®ç°åœ¨ç¨‹åºæ²¡æœ‰æ˜æ˜¾æ€§èƒ½æŸå¤±çš„æƒ…å†µä¸‹åšåˆ°å‰é¢æ‰€è¯´çš„ã€‚ å› æ­¤ä½ å¿…é¡»ã€Œæ‰‹å·¥å¯¹ä»˜ã€è¿™äº›æƒ…å†µä¸­çš„åŒæ­¥æ§åˆ¶ vector\u003cint\u003e v; ... getMutexFor(v); vector\u003cint\u003e::iterator first3(find(v.begin(), v.end(), 3)); if (first3 != v.end()) { // è¿™é‡Œç°åœ¨å®‰å…¨äº† *first3 = 2; // è¿™é‡Œä¹Ÿæ˜¯ } releaseMutexFor(v); ã€Œæ”¹è¿›ï¼šã€ä¸€ä¸ªæ›´é¢å‘å¯¹è±¡çš„è§£å†³æ–¹æ¡ˆæ˜¯ã€Œåˆ›å»ºä¸€ä¸ªLockç±»ã€ï¼Œåœ¨å®ƒçš„ã€Œæ„é€ å‡½æ•°é‡Œè·å¾—äº’æ–¥é‡å¹¶åœ¨å®ƒçš„ææ„å‡½æ•°é‡Œé‡Šæ”¾å®ƒã€ï¼Œè¿™æ ·ä½¿getMutexForå’ŒreleaseMutexForçš„ã€Œè°ƒç”¨ä¸åŒ¹é…çš„æœºä¼šå‡åˆ°æœ€å°ã€: template\u003ctypename Container\u003e // è·å–å’Œé‡Šæ”¾å®¹å™¨çš„äº’æ–¥é‡çš„ç±»çš„æ¨¡æ¿æ ¸å¿ƒï¼› class Lock { / public: // å¿½ç•¥äº†å¾ˆå¤šç»†èŠ‚ Lock(const Containers container): c(container) { getMutexFor(c); // åœ¨æ„é€ å‡½æ•°è·å–äº’æ–¥é‡ } ~Lock() { releaseMutexFor(c); // åœ¨ææ„å‡½æ•°é‡Œé‡Šæ”¾å®ƒ } private: const Container\u0026 c; }; ä½¿ç”¨ä¸€ä¸ªç±»ï¼ˆåƒLockï¼‰æ¥ç®¡ç†èµ„æºçš„ç”Ÿå­˜æœŸï¼ˆä¾‹å¦‚äº’æ–¥é‡ï¼‰çš„åŠæ³•é€šå¸¸ç§°ä¸ºèµ„æºè·å¾—å³åˆå§‹åŒ–ã€‚ åº”ç”¨åˆ°ä¸Šè¿°ä¾‹å­ï¼š vector\u003cint\u003e v; ... { // å»ºç«‹æ–°å—ï¼› Lock\u003cvector\u003cint\u003e \u003e lock(v); // è·å–äº’æ–¥é‡ vector\u003cint\u003e::iterator first3(find(v.begin(), v.end(), 3)); if (first3 != v.end()) { *first3 = 2; } } // å…³é—­å—ï¼Œè‡ªåŠ¨ // é‡Šæ”¾äº’æ–¥é‡ åŸºäºLockçš„æ–¹æ³•åœ¨æœ‰å¼‚å¸¸çš„æƒ…å†µä¸‹æ˜¯ç¨³å¥çš„ å› ä¸ºLockå¯¹è±¡åœ¨Lockçš„ææ„å‡½æ•°é‡Œé‡Šæ”¾å®¹å™¨çš„çš„äº’æ–¥é‡ï¼Œæ‰€ä»¥åœ¨äº’æ–¥é‡éœ€è¦é‡Šæ”¾æ˜¯å°±é”€æ¯Lockæ˜¯å¾ˆé‡è¦çš„ã€‚ä¸ºäº†è®©è¿™ä»¶äº‹å‘ç”Ÿï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªé‡Œé¢å®šä¹‰äº†Lockçš„æ–°å—ï¼Œè€Œä¸”å½“æˆ‘ä»¬ä¸å†éœ€è¦äº’æ–¥é‡æ—¶å°±å…³é—­é‚£ä¸ªå—ã€‚ C++ä¿è¯å¦‚æœæŠ›å‡ºäº†å¼‚å¸¸ï¼Œå±€éƒ¨å¯¹è±¡å°±ä¼šè¢«é”€æ¯ï¼Œæ‰€ä»¥å³ä½¿å½“æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨Lockå¯¹è±¡æ—¶æœ‰å¼‚å¸¸æŠ›å‡ºï¼ŒLockä¹Ÿå°†é‡Šæ”¾å®ƒçš„äº’æ–¥é‡ã€‚å¦‚æœæˆ‘ä»¬ä¾èµ–æ‰‹å·¥è°ƒç”¨getMutexForå’ŒreleaseMutexForï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨getMutexForä¹‹åreleaseMutexForä¹‹å‰å¦‚æœæœ‰å¼‚å¸¸æŠ›å‡ºï¼Œæˆ‘ä»¬å°†ä¸ä¼šé‡Šæ”¾äº’æ–¥é‡ã€‚ ","date":"2023-08-02","objectID":"/posts/clause_12/:3:0","tags":["Effective","STL"],"title":"Effective STL [12] | å¯¹STLå®¹å™¨çº¿ç¨‹å®‰å…¨æ€§çš„æœŸå¾…ç°å®ä¸€äº›","uri":"/posts/clause_12/"},{"categories":["C++"],"content":"ç»“è®º å½“æ¶‰åŠåˆ°çº¿ç¨‹å®‰å…¨å’ŒSTLå®¹å™¨æ—¶ï¼Œä½ å¯ä»¥ç¡®å®šåº“å®ç°å…è®¸åœ¨ä¸€ä¸ªå®¹å™¨ä¸Šçš„å¤šè¯»å–è€…å’Œä¸åŒå®¹å™¨ä¸Šçš„å¤šå†™å…¥è€…ã€‚ ã€Œä½ ä¸èƒ½å¸Œæœ›åº“æ¶ˆé™¤å¯¹æ‰‹å·¥å¹¶è¡Œæ§åˆ¶çš„éœ€è¦ï¼Œè€Œä¸”ä½ å®Œå…¨ä¸èƒ½ä¾èµ–äºä»»ä½•çº¿ç¨‹æ”¯æŒã€ ","date":"2023-08-02","objectID":"/posts/clause_12/:4:0","tags":["Effective","STL"],"title":"Effective STL [12] | å¯¹STLå®¹å™¨çº¿ç¨‹å®‰å…¨æ€§çš„æœŸå¾…ç°å®ä¸€äº›","uri":"/posts/clause_12/"},{"categories":["ML"],"content":"ä¸€ã€å¼•å…¥ è¿‘å¹´AIGCçš„çˆ†ç«ç¦»ä¸å¼€äººå·¥æ™ºèƒ½åœ¨å›¾åƒç”Ÿæˆã€æ–‡æœ¬ç”Ÿæˆä»¥åŠå¤šæ¨¡æ€ç­‰é¢†åŸŸçš„ä¸æ–­ç´¯ç§¯ï¼Œå…¶ä¸­ç”Ÿæˆæ¨¡å‹çš„å‘å±•å æ®äº†å¾ˆå¤§åŠŸåŠ³ï¼Œå¦‚ï¼šç”Ÿæˆå¯¹æŠ—ç½‘ç»œ GAN åŠå…¶ä¸€ç³»åˆ—å˜ä½“ã€å˜åˆ†è‡ªç¼–ç å™¨ VAE åŠå…¶ä¸€ç³»åˆ—å˜ä½“ã€è‡ªå›å½’æ¨¡å‹ ARã€æµæ¨¡å‹ flow ï¼Œä»¥åŠè¿‘å¹´å¤§ç«çš„æ‰©æ•£æ¨¡å‹ Diffusion Model ç­‰ã€‚ æ‰©æ•£æ¨¡å‹çš„å¤§ç«å¹¶éæ¨ªç©ºå‡ºä¸–ï¼Œæ—©åœ¨2015å¹´å°±æœ‰äººæå‡ºäº†ç±»ä¼¼çš„æƒ³æ³•ï¼Œç›´åˆ°2020å¹´æ‰æå‡ºäº†ç»å…¸çš„ Denoising Diffusion Probabilistic Modelsï¼ˆDDPMï¼‰ï¼ŒåƒOpenAIã€NovelAIã€NVIDIAå’ŒGoogleæˆåŠŸçš„è®­ç»ƒäº†å¤§è§„æ¨¡æ¨¡å‹ä¹‹åï¼Œå®ƒä»¬å¸å¼•äº†å¾ˆå¤šäººæ³¨æ„ï¼Œåç»­æœ‰äº†å¾ˆå¤šåŸºäºæ‰©æ•£æ¨¡å‹çš„å˜ä½“ï¼Œæ¯”å¦‚æœ‰ï¼šGLIDEã€DALLE-2ã€Imagenå’Œå¹´åº•çˆ†ç«çš„å®Œå…¨å¼€æºçš„ç¨³å®šæ‰©æ•£æ¨¡å‹ï¼ˆStable Diffusionï¼‰ã€‚ æ‰©æ•£æ¨¡å‹ä¸ä¹‹å‰æ‰€æœ‰çš„ç”Ÿæˆæ–¹æ³•æœ‰ç€æœ¬è´¨çš„åŒºåˆ«ï¼š ç›´è§‚çš„è¯´å®ƒæ˜¯å°†å›¾åƒç”Ÿæˆè¿‡ç¨‹ï¼ˆé‡‡æ ·ï¼‰åˆ†è§£ä¸ºè®¸å¤šå°çš„å»å™ªæ­¥éª¤ï¼Œå…¶å® Diffusion çš„å«ä¹‰æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ï¼Œå®çº¿ç®­å¤´ç”¨äºæ‰©æ•£æ­¥éª¤ä¸­æ·»åŠ éšæœºå™ªå£°ï¼Œè™šçº¿ç®­å¤´ä»£è¡¨çš„æ˜¯é€šè¿‡å­¦ä¹ é€†å‘æ‰©æ•£è¿‡ç¨‹ä»å™ªå£°ä¸­é‡æ„æ‰€éœ€çš„æ•°æ®æ ·æœ¬ã€‚å¼•å…¥å™ªå£°å¯¼è‡´äº†ä¿¡æ¯çš„è¡°å‡ï¼Œå†é€šè¿‡å™ªå£°å°è¯•è¿˜åŸåŸå§‹æ•°æ®ï¼Œå¤šæ¬¡è¿­ä»£æœ€å°åŒ–æŸå¤±åï¼Œèƒ½å¤Ÿä½¿æ¨¡å‹åœ¨ç»™å®šå™ªå£°è¾“å…¥çš„æƒ…å†µä¸‹å­¦ä¹ ç”Ÿæˆæ–°å›¾åƒã€‚ æ‰€ä»¥Diffusionæ¨¡å‹å’Œå…¶å®ƒç”Ÿæˆæ¨¡å‹çš„åŒºåˆ«æ˜¯ï¼Œå®ƒä¸æ˜¯ç›´æ¥çš„å›¾åƒ-\u003eæ½œå˜é‡ã€æ½œå˜é‡-\u003eå›¾åƒçš„ä¸€æ­¥åˆ°ä½ï¼Œå®ƒæ˜¯ä¸€æ­¥ä¸€æ­¥çš„é€æ¸åˆ†è§£ã€é€æ¸å»å™ªçš„è¿‡ç¨‹ã€‚ å½“ç„¶æœ‰å…³Diffusionçš„ç†è§£å’Œå˜ä½“æœ‰å¾ˆå¤šï¼Œä½†æ˜¯æ‰©æ•£æ¨¡å‹ä»æœ¬è´¨ä¸Šè®²å°±æ˜¯DDPMï¼Œæ‰€ä»¥æœ¬æ–‡ä¸»è¦å¯¹DDPMçš„åŸç†è¿›è¡Œè®²è§£ï¼Œå¹¶ç»™å‡ºDDPMçš„æ‰©æ•£è¿‡ç¨‹ã€å»å™ªè¿‡ç¨‹ã€è®­ç»ƒæŸå¤±çš„è¯¦ç»†æ¨å¯¼ï¼Œå¯¹äºæŒæ¡Diffusionç®—æ³•åŸç†åªéœ€è¦æŠ“ä½ä»¥ä¸‹å››ç‚¹å³å¯ï¼š å‰å‘è¿‡ç¨‹ï¼ˆæ‰©æ•£ï¼‰ï¼› åå‘è¿‡ç¨‹ï¼ˆå»å™ªã€é‡‡æ ·ï¼‰ï¼› å¦‚ä½•è®­ç»ƒï¼› å¦‚ä½•æ¨æ–­ã€‚ ","date":"2023-07-31","objectID":"/posts/ddpm/:1:0","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"äºŒã€æ‰©æ•£åŸç†é˜è¿° æ‰©æ•£æ¨¡å‹åŒ…æ‹¬ å‰å‘æ‰©æ•£è¿‡ç¨‹ å’Œ åå‘å»å™ªè¿‡ç¨‹(é‡‡æ ·)ï¼Œå‰å‘é˜¶æ®µå¯¹å›¾åƒé€æ­¥æ–½åŠ å™ªå£°ï¼Œç›´è‡³å›¾åƒè¢«ç ´åå˜æˆå®Œå…¨çš„é«˜æ–¯å™ªå£°ï¼Œç„¶ååœ¨åå‘é˜¶æ®µå­¦ä¹ ä»é«˜æ–¯å™ªå£°è¿˜åŸä¸ºåŸå§‹å›¾åƒçš„è¿‡ç¨‹ã€‚ ","date":"2023-07-31","objectID":"/posts/ddpm/:2:0","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"2.1ã€ç›´è§‚ç†è§£ æ‰©æ•£æ¨¡å‹çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ å­¦ä¹ ä»çº¯å™ªå£°ç”Ÿæˆå›¾ç‰‡çš„æ–¹æ³•ã€‚ æ‰©æ•£æ¨¡å‹æ˜¯æ€ä¹ˆåšçš„ï¼Ÿ è®­ç»ƒä¸€ä¸ªUNetï¼Œæ¥å—ä¸€ç³»åˆ—åŠ äº†å™ªå£°çš„å›¾ç‰‡ï¼Œå­¦ä¹ é¢„æµ‹æ‰€åŠ çš„å™ªå£°ã€‚ å‰å‘è¿‡ç¨‹åœ¨å¹²ä»€ä¹ˆï¼Ÿ é€æ­¥å‘çœŸå®å›¾ç‰‡æ·»åŠ å™ªå£°æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªçº¯å™ªå£°ï¼› å¯¹äºè®­ç»ƒé›†ä¸­çš„æ¯å¼ å›¾ç‰‡ï¼Œéƒ½èƒ½ç”Ÿæˆä¸€ç³»åˆ—çš„å™ªå£°ç¨‹åº¦ä¸åŒçš„åŠ å™ªå›¾ç‰‡ï¼› åœ¨è®­ç»ƒæ—¶ï¼Œè¿™äº› ã€ä¸åŒç¨‹åº¦çš„å™ªå£°å›¾ç‰‡ + ç”Ÿæˆå®ƒä»¬æ‰€ç”¨çš„å™ªå£°ã€‘ æ˜¯å®é™…çš„è®­ç»ƒæ ·æœ¬ã€‚ åå‘è¿‡ç¨‹åœ¨å¹²ä»€ä¹ˆï¼Ÿ è®­ç»ƒå¥½æ¨¡å‹åï¼Œé‡‡æ ·ã€ç”Ÿæˆå›¾ç‰‡ã€‚ ","date":"2023-07-31","objectID":"/posts/ddpm/:2:1","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"2.2ã€å‰å‘è¿‡ç¨‹ï¼ˆæ‰©æ•£ï¼‰ å‰å‘è¿‡ç¨‹åœ¨åŸå§‹è¾“å…¥å›¾åƒ$x_0$ä¸Šé€æ­¥æ·»åŠ éšæœºå™ªå£°ï¼Œè¿™ä¸ªå™ªå£°æœä»é«˜æ–¯åˆ†å¸ƒ$N(0, 1)$ï¼Œæ¯ä¸€æ­¥å¾—åˆ°çš„å›¾åƒ$x_t$åªå’Œä¸Šä¸€æ­¥çš„åŠ å™ªç»“æœ$x_{t-1}$ç›¸å…³ï¼Œé€æ­¥æ·»åŠ å™ªå£°è‡³$T$æ­¥ï¼Œå¯ä»¥å¾—åˆ°è¶‹å‘äºçº¯ç²¹å™ªå£°çš„å›¾åƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åé¢æœ‰è¯¦ç»†çš„æ¨å¯¼ï¼Œå…¬å¼æ¯”è¾ƒå¤šï¼Œè¿™é‡Œå…ˆæå‰æŠŠä¸»è¦çš„åˆ—ä¸€ä¸‹æ–¹ä¾¿é˜è¿°ã€‚ å¯¹äºå°†ä¸€å¼ å›¾ç‰‡ï¼Œä»$x_{t-1}\\rightarrow x_{t}$çš„é€æ­¥åŠ å™ªç ´åçš„å…¬å¼ä¸ºï¼š $$x_t=\\sqrt{\\alpha_t}\\left.x_{t-1}+\\sqrt{1-\\alpha_t}\\right.\\varepsilon_t\\quad\\quad\\quad\\quad\\quad\\quad(1)$$ å…¶ä¸­: $x_t$è¡¨ç¤ºç¬¬$t$æ­¥çš„å›¾åƒï¼› $\\varepsilon$ æ˜¯ä¸€ä¸ªæ»¡è¶³æ­£æ€åˆ†å¸ƒçš„éšæœºå™ªå£°ï¼Œ$\\varepsilon \\sim N(0, 1)$ï¼› $\\sqrt{\\alpha_{t}}$ æ˜¯å›¾ç‰‡çš„æƒé‡ï¼Œ$\\sqrt{1 - \\alpha_{t}}$ æ˜¯å™ªå£°çš„æƒé‡ï¼› å®šä¹‰ï¼š $\\alpha_t=1-\\beta_t$ $\\overline{\\alpha}=\\prod_{s=1}^t\\alpha_s$ éšç€$t$çš„å¢åŠ ï¼Œå™ªå£°çš„å æ¯”ä¼šè¶Šæ¥è¶Šå¤§ï¼Œæ‰€ä»¥æ·»åŠ çš„å™ªå£°å¼ºåº¦ä¹Ÿä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¹Ÿå°±æ˜¯è¯´å›¾ç‰‡çš„æƒé‡è¦è¶Šæ¥è¶Šå°ï¼Œå™ªå£°çš„æƒé‡è¦è¶Šæ¥è¶Šå¤§ã€‚å› ä¸ºéšç€æ‰©æ•£è¿‡ç¨‹çš„å¢åŠ ï¼Œå›¾åƒä¸­å™ªå£°çš„å æ¯”ä¹Ÿä¼šè¶Šæ¥è¶Šå¤§ï¼Œæˆ‘ä»¬æƒ³è¦è¿›ä¸€æ­¥ç ´åå®ƒçš„ç»“æ„ï¼Œå°±éœ€è¦æ·»åŠ æ›´å¤šçš„å™ªå£°ã€‚ æ¢å¥è¯è¯´ï¼Œä¸€å¼€å§‹å›¾åƒæ¯”è¾ƒæ¸…æ™°ï¼Œè¿™ä¸ªæ—¶å€™æ·»åŠ çš„å™ªå£°å°ä¸€äº›ï¼Œéšç€å›¾åƒçš„å™ªå£°è¶Šæ¥è¶Šå¤šï¼Œè¿™ä¸ªæ—¶å€™å†åŠ ä¸€ç‚¹å™ªå£°çš„è¯ï¼Œå¯¹åŸæ¥çš„å›¾åƒå°±æ²¡ä»€ä¹ˆå½±å“äº†ï¼Œå› ä¸ºå®ƒæœ¬èº«å°±æœ‰å¥½å¤šå™ªå£°äº†ï¼Œæ‰€ä»¥éšç€å›¾åƒçš„å™ªå£°è¶Šæ¥è¶Šå¤šï¼Œåé¢çš„æ­¥éª¤å°±è¦åŠ æ›´å¤šçš„å™ªå£°ã€‚ å®é™…è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šæ¯”è¾ƒå¤§ï¼ˆDDPMåŸæ–‡ä¸­ä¸º1000ï¼‰ï¼Œæ‰€ä»¥ä¼šæœ‰ä»$x_0$é€’æ¨åˆ°$x_t$çš„å…¬å¼ï¼š $$x_t=\\sqrt{\\overline{\\alpha}_t}\\left.x_0+\\sqrt{1-\\overline{\\alpha}_t}\\right.\\varepsilon\\quad\\quad\\quad\\quad(2)$$ å…¶ä¸­ï¼š $\\alpha_t$ã€$\\beta_t$ æœ‰ä¸€ä¸ªå›ºå®šçš„å·²çŸ¥å‡½æ•°ï¼Œæ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œè®¡ç®—çš„ï¼› $\\varepsilon$ ä¸ºéšæœºäº§ç”Ÿçš„å™ªå£°ï¼› æ‰€ä»¥æ•´ä¸ªå¼å­æ˜¯å·²çŸ¥çš„ï¼Œå¼ $(1)$ã€$(2)$ å°±å¯ä»¥æè¿°å‰å‘è¿‡ç¨‹äº†ï¼Œ$(1)$ ç”¨äºå°†ä¸€å¼ å›¾ç‰‡çš„é€æ­¥ç ´åï¼Œ$(2)$ ç”¨äºä¸€æ­¥åˆ°ä½çš„ç ´åã€‚ ","date":"2023-07-31","objectID":"/posts/ddpm/:2:2","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"2.3ã€åå‘è¿‡ç¨‹ï¼ˆå»å™ªï¼‰ åå‘è¿‡ç¨‹åˆ™æ˜¯ä¸æ–­å»é™¤å™ªå£°çš„è¿‡ç¨‹ï¼Œç»™å®šä¸€ä¸ªå™ªå£°å›¾ç‰‡ $x_T$ï¼Œå¯¹å®ƒä¸€æ­¥æ­¥çš„å»å™ªè¿˜åŸï¼Œç›´è‡³æœ€ç»ˆå°†åŸå§‹å›¾åƒ $x_0$ ç»™æ¢å¤å‡ºæ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å»å™ªçš„è¿‡ç¨‹ï¼Œ$x_t$ã€$\\alpha_t$ã€$\\beta_t$ éƒ½æ˜¯å·²çŸ¥çš„ï¼Œåªæœ‰å…¬å¼ $(2)$ ä¸­çš„çœŸå®å™ªå£°æ˜¯æœªçŸ¥çš„ï¼Œå› ä¸ºå®ƒæ˜¯éšæœºé‡‡æ ·çš„ã€‚æ‰€ä»¥éœ€è¦ä¸€ä¸ªç¥ç»ç½‘ç»œæŠŠ $\\varepsilon$ ç»™å­¦å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯è¯´è®­ç»ƒä¸€ä¸ªç”± $x_t$ å’Œ $t$ ä¼°æµ‹å™ªå£°çš„æ¨¡å‹: $$x_{t-1}=\\frac{1}{\\sqrt{\\alpha_t}}(x_t-\\frac{\\beta_t}{\\sqrt{1-\\overline{\\alpha}t}}\\varepsilon\\theta(x_t,t))$$ å…¶ä¸­ $\\theta$ å°±æ˜¯æ¨¡å‹çš„å‚æ•°ï¼Œé€šå¸¸ä½¿ç”¨UNetä½œä¸ºé¢„ä¼°å™ªå£°çš„æ¨¡å‹ã€‚ ","date":"2023-07-31","objectID":"/posts/ddpm/:2:3","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"2.4ã€æ¨¡å‹è®­ç»ƒ æ‰€ä»¥è¯´åå‘è¿‡ç¨‹å…¶å®å°±æ˜¯è®­ç»ƒç½‘ç»œå»å­¦ä¹ åˆ†è§£è¿‡ç¨‹æ¯ä¸€æ­¥çš„å™ªå£°ï¼Œå½“ç½‘ç»œè®­ç»ƒå¥½ä¹‹åï¼Œè¾“å…¥ä¸€å¼ å™ªå£°å›¾ç‰‡ï¼Œé€šè¿‡ç½‘ç»œå°±èƒ½æŠŠåŠ çš„å™ªå£°ç»™æ±‚å‡ºæ¥ï¼Œå™ªå£°æœ‰äº†ä»£å…¥å…¬å¼ï¼Œå°±èƒ½æŠŠ $x_{t-1}$ æ­¥çš„æ¯”è¾ƒæ¸…æ™°çš„å›¾ç»™æ±‚å‡ºæ¥äº†ï¼Œä¸€æ­¥æ­¥å¾€å‰è¿­ä»£å°±è¡Œäº†ã€‚ é‡‡ç”¨L2è·ç¦»åˆ»ç”»ç›¸è¿‘ç¨‹åº¦å°±å¯ä»¥ï¼ŒDDPMçš„å…³é”®æ˜¯è®­ç»ƒ $\\varepsilon_{\\theta}(x_t, t)$ï¼Œç›®çš„å°±æ˜¯ä½¿é¢„æµ‹çš„å™ªå£°ä¸çœŸå®ç”¨äºç ´åçš„å™ªå£°ç›¸è¿‘ï¼š $$Loss=\\mid\\mid\\varepsilon-\\varepsilon_\\theta(x_t,t)\\mid\\mid^2=\\mid\\mid\\varepsilon-\\varepsilon_\\theta(\\sqrt{\\overline{\\alpha}_t}~x_0+\\sqrt{1-\\overline{\\alpha}_t}~\\varepsilon_t,t)\\mid\\mid^2$$ æ¨¡å‹è®­ç»ƒå®Œåï¼Œåªè¦ç»™å®šéšæœºé«˜æ–¯å™ªå£°ï¼Œå°±å¯ä»¥ç”Ÿæˆä¸€å¼ ä»æœªè§è¿‡çš„å›¾åƒã€‚ UNetæœ¬æ–‡ä¸åšä»‹ç»ï¼Œç»“æ„å›¾ä¸ºï¼š é¢å¤–å¼ºè°ƒçš„æ˜¯ï¼šUneté‡Œæœ‰ä¸€ä¸ªä½ç½®ç¼–ç ï¼Œæ˜¯å…³äºæ—¶é—´æ­¥çš„ï¼Œæ¯ä¸ªæ—¶é—´æ­¥æ˜¯æœ‰ä¸€ä¸ªçº¿æ€§è°ƒåº¦å™¨çš„ï¼Œæ¯ä¸ªæ—¶é—´æ·»åŠ çš„å™ªå£°çš„æ–¹å·®æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥å°†æ—¶é—´æ­¥ä½œä¸ºç¼–ç åµŒå…¥çš„è¯ï¼Œå¯ä»¥å°†æ¨¡å‹é¢„æµ‹çš„å™ªå£°æ›´åŠ çš„å‡†ç¡®ã€‚ ","date":"2023-07-31","objectID":"/posts/ddpm/:2:4","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"ä¸‰ã€ç®—æ³•æµç¨‹æ¦‚è¿° å†æ¬¡æ€»ç»“ï¼Œæ‰©æ•£æ¨¡å‹ä¸¤ä¸ªæ­¥éª¤å¦‚ä¸‹ï¼š ä¸€ä¸ªå›ºå®šçš„ï¼ˆé¢„å…ˆå®šä¹‰å¥½çš„ï¼‰å‰å‘æ‰©æ•£è¿‡ç¨‹ $q(x_t | x_{t-1})$ï¼šé€æ­¥å‘å›¾ç‰‡å¢åŠ å™ªå£°ç›´åˆ°æœ€ç»ˆå¾—åˆ°ä¸€å¼ çº¯ç²¹çš„å™ªå£°å›¾ï¼› ä¸€ä¸ªå­¦ä¹ å¾—åˆ°çš„å»å™ªè¿‡ç¨‹ $p_{\\theta}(x_{t-1} | x_t)$ï¼šè®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œå»é€æ¸çš„ä»ä¸€å¼ çº¯å™ªå£°ä¸­æ¶ˆé™¤å™ªå£°ï¼Œç›´åˆ°å¾—åˆ°ä¸€å¼ çœŸæ­£çš„å›¾ç‰‡ã€‚ ç®—æ³•1 ä¸ºè®­ç»ƒæµç¨‹ï¼š line2ï¼šä»æ•°æ®ä¸­é‡‡æ · $x_0$ï¼Œ$q(x_0)$ çš„æ„æ€æ˜¯ç»™ $x_0$ åŠ ä¸Šå™ªå£°ï¼› line3ï¼šéšæœºé€‰å– time step $t$ï¼› çœŸå®è®­ç»ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸å¯èƒ½ä¸€æ­¥æ­¥çš„ä» $t$ åˆ° $T$ï¼Œå› ä¸ºä¼šå¾ˆå¤§ï¼Œè¿™å°±æ„å‘³ç€æ¯è¾“å…¥ä¸€å¼ å›¾ç‰‡ $x$ï¼Œå°±ä¼šäº§ç”Ÿå¼ å™ªå£°å›¾åƒï¼Œä¹Ÿå°±æ˜¯ä¸€å¼ å›¾åƒçš„ç½‘ç»œè¦è®­ç»ƒ $T$ ä¸ªå™ªå£°æ ·æœ¬ï¼Œéå¸¸è€—æ—¶ã€‚ æ‰€ä»¥å¯¹ $T$ è¿›è¡Œäº†é‡‡æ ·ï¼Œ$t$ å°±æ˜¯ä» $T$ é‡Œé‡‡é›†è‹¥å¹²ä¸ªçš„æ„æ€ã€‚ ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾é‡‡é›† $t$ çš„åˆ†åˆ«ä¸º100ã€20ã€3ï¼Œå¯¹åº”çš„ $x$ ä¸º $x_{100}$ã€$x_{20}$ã€$x_{3}$ï¼Œå¯¹åº”å™ªå£°ä¸º $\\varepsilon_{100}$ã€$\\varepsilon_{20}$ã€$\\varepsilon_{3}$ï¼Œå¯¹äºçš„é¢„æµ‹å™ªå£°ä¸º $\\hat{\\varepsilon}{100}$ã€$\\hat{\\varepsilon}{20}$ã€$\\hat{\\varepsilon}_{3}$, åªéœ€è¦å°† $\\varepsilon$ å’Œ $\\hat{\\varepsilon}$ ä»£å…¥MSEå…¬å¼å³å¯ï¼ˆç›¸å‡ã€å¹³æ–¹ã€æœ€å°åŒ–ï¼‰ã€‚ line 4ï¼šç”Ÿæˆéšæœºé«˜æ–¯å™ªå£°ï¼› line 5ï¼šè°ƒç”¨æ¨¡å‹ä¼°è®¡ $\\varepsilon_{\\theta}(\\sqrt{\\overline{\\alpha}_t}~x_0+\\sqrt{1-\\overline{\\alpha}_t}~\\varepsilon_t,t)$ ï¼Œè®¡ç®—çœŸå®å™ªå£°ä¸ä¼°è®¡å™ªå£°ä¹‹é—´çš„MSE Lossï¼Œåå‘ä¼ æ’­æ›´æ–°æ¨¡å‹ã€‚ ç½‘ç»œçš„ä½œç”¨æ˜¯é¢„æµ‹å™ªå£°ï¼Œéšç€çš„å¢åŠ ï¼Œå™ªå£°å¼ºåº¦ä¼šè¶Šæ¥è¶Šå¤§ï¼Œå› æ­¤é¢„æµ‹çš„å™ªå£°æ˜¯å’Œè¿­ä»£æ˜¯ç›´æ¥ç›¸å…³çš„ï¼Œæ‰€ä»¥è¦æŠŠä½œä¸ºå‚æ•°é€å…¥åˆ°ç½‘ç»œå½“ä¸­ã€‚ ç›´åˆ°æ”¶æ•›ã€‚ ç®—æ³•2 ä¸ºé‡‡æ ·æµç¨‹ï¼š line 1ï¼šä»é«˜æ–¯åˆ†å¸ƒé‡‡æ · $x_T$ï¼› line 2ï¼šæŒ‰ç…§ $T, â€¦, 1$ çš„é¡ºåºè¿›è¡Œè¿­ä»£ï¼› line 3ï¼šå¦‚æœ $t = 1$ ä»¤ $z = 0$ï¼›å¦‚æœ $t \u003e 1$ ï¼Œä»é«˜æ–¯åˆ†å¸ƒä¸­é‡‡æ ·ï¼› line 4ï¼šåˆ©ç”¨å…¬å¼æ±‚å‡ºå‡å€¼å’Œæ–¹å·®ï¼Œè¿›è€Œæ±‚å¾— $x_{t-1}$ï¼› ç»è¿‡ä¸Šè¿°è¿­ä»£ï¼Œæ¢å¤ $x_0$ã€‚ ","date":"2023-07-31","objectID":"/posts/ddpm/:3:0","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"å››ã€æ•°å­¦æè¿° æˆ‘ä»¬æ¥æ¨å¯¼å¦‚ä½•ä»åŸå§‹å›¾åƒç›´æ¥åˆ°ç¬¬tæ—¶åˆ»çš„å›¾åƒ $(X_0 - X_t)$ã€‚ é¦–å…ˆå›é¡¾ 2.1å°èŠ‚ çš„ä¸¤ä¸ªå®šä¹‰ï¼š $\\alpha_t = 1 - \\beta_{t}$, $\\beta_t$ è¦è¶Šå¤§è¶Šå¥½ï¼Œè®ºæ–‡ä¸­ä»0.0001åˆ°0.02; $\\overline{\\alpha}=\\prod_{s=1}^t\\alpha_s$ç´¯ä¹˜ï¼Œä¸‹é¢ä¼šç”¨åˆ°ï¼› $x_t=\\sqrt{\\alpha_t}x_{t-1}+\\sqrt{1-\\alpha_t}\\varepsilon_t\\text{,}\\varepsilon_t\\sim N(0,1)$ æ¯ä¸€æ—¶åˆ»æ·»åŠ çš„å™ªå£°å‡ç‹¬ç«‹ï¼› æˆ‘ä»¬è¦æ±‚$x_t$æ—¶åˆ»çš„å›¾åƒï¼Œå®ƒéœ€è¦ä¸€æ­¥æ­¥çš„åŠ å™ªè¿­ä»£ï¼Œè¿™æ ·å¤ªæ…¢äº†ã€‚å› ä¸ºæ¯ä¸€æ­¥æ·»åŠ çš„å™ªå£°ç‹¬ç«‹ä¸”æœä»æ­£å¤ªåˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥åšå¦‚ä¸‹æ¨å¯¼ï¼š ä¸ºäº†ä¸æ··æ·†ï¼Œåªéœ€è¦è®°ä½ï¼šä¸‹æ ‡è¶Šå°ï¼Œå™ªå£°è¶Šå°ï¼Œå³ $x_{t-1}$ çš„å™ªå£°æ˜¯å°äº $x_t$ çš„ã€‚ $$ \\begin{aligned} q(x_{t}\\mid x_{t-1})\u0026 =N(x_t;\\sqrt{\\alpha_t}x_{t-1},(1-\\alpha_t)I) \\cr \u0026=\\underbrace{\\sqrt{\\alpha_t}x_{t-1}}{x{t-2}\\text{æ¥è¡¨ç¤º}x_{t-1}}+\\sqrt{1-\\alpha_t}\\varepsilon_t \\cr \u0026=\\sqrt{\\alpha_t}\\left(\\sqrt{\\alpha_{t-1}}\\right.x_{t-2}+\\sqrt{1-\\alpha_{t-1}}\\left.\\varepsilon_{t-1}\\right)+\\sqrt{1-\\alpha_t}\\left.\\varepsilon_t\\right. \\cr \u0026=\\sqrt{\\alpha_t\\alpha_{t-1}}x_{t-2}+\\underbrace{\\sqrt{\\alpha_t-\\alpha_t\\alpha_{t-1}}\\varepsilon_{t-1}+\\sqrt{1-\\alpha_t}\\varepsilon_t}{\\text{ä¸¤ä¸ªç‹¬ç«‹æ­£å¤ªåˆ†å¸ƒç›¸åŠ }} \\cr \u0026=\\sqrt{\\alpha_t\\alpha{t-1}}\\left.x_{t-2}+\\sqrt{1-\\alpha_t\\alpha_{t-1}}\\right.\\varepsilon \\cr \u0026\\text{â€¦} \\ \u0026=\\sqrt{\\overline{\\alpha}_t}\\left.x_0+\\sqrt{1-\\overline{\\alpha}_t}\\right.\\varepsilon \\cr \u0026\\therefore q(x_t\\mid x_0)=N(x_t;\\sqrt{\\overline{\\alpha}_t}x_0,\\sqrt{1-\\overline{\\alpha}_t}I) \\end{aligned} $$ ä¸Šè¿°ç”¨çš„å°±æ˜¯é‡å‚æ•°åŒ–æŠ€å·§ã€‚ æ–¹å·®å‚æ•° $\\beta_{t}$ å¯ä»¥å›ºå®šä¸ºä¸€ä¸ªå¸¸æ•°ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä½œä¸º $T$ æ—¶é—´æ®µçš„ä¸€ä¸ªæ—¶é—´è¡¨ã€‚äº‹å®ä¸Šï¼Œäººä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–¹å·®è¡¨ï¼Œå®ƒå¯ä»¥æ˜¯çº¿æ€§çš„ã€äºŒæ¬¡çš„ã€ä½™å¼¦çš„ç­‰ç­‰ã€‚æœ€åˆçš„DDPMä½œè€…åˆ©ç”¨äº†ä¸€ä¸ªä» $\\beta_1 = 10^{-4}$ åˆ°$\\beta_T = 0.02$å¢åŠ çš„çº¿æ€§æ—¶é—´è¡¨ã€‚Nicholç­‰äºº2021å¹´çš„ç ”ç©¶è¡¨æ˜ï¼Œé‡‡ç”¨ä½™å¼¦æ—¶é—´è¡¨æ•ˆæœæ›´å¥½ã€‚ ","date":"2023-07-31","objectID":"/posts/ddpm/:4:0","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"4.2ã€åå‘è¿‡ç¨‹ï¼ˆå»å™ªï¼‰ æ¥ä¸‹æ¥æ˜¯åå‘è¿‡ç¨‹çš„æ¨å¯¼ï¼š $$p(x_{t-1}\\mid x_t)=N(x_{t-1};\\underbrace{\\mu_\\theta(x_t,t)}\\text{è¦åé¢„æµ‹è¿™ä¸ª},\\overbrace{\\Sigma\\theta(x_t,t)}^{fixed})$$ ç»™å®š$x_t$è¦é¢„æµ‹ $x_{t-1}$ï¼Œå®ƒæ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒï¼Œ$x_t$å’Œ$t$çš„æ–¹å·®æ˜¯å›ºå®šçš„ï¼Œè®ºæ–‡ä½œè€…ä½¿ç”¨åŸå§‹çš„å™ªå£°è°ƒåº¦å™¨ä½œä¸ºæ–¹å·®ï¼Œä¹Ÿå°±æ˜¯è¯´å™ªå£°è°ƒåº¦å™¨ä¸€æ—¦ç¡®ç«‹ï¼Œæ–¹å·®çš„å¤§å°ä¹Ÿå°±å›ºå®šäº†ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦é¢„æµ‹è¿™ä¸ªå‡å€¼å°±å¥½äº†ï¼Œä¸‹é¢ç»™å‡ºå…·ä½“çš„æ¨å¯¼è¿‡ç¨‹ï¼š æˆ‘ä»¬å…ˆçœ‹æ•´ä¸ªæŸå¤±å‡½æ•°ï¼Œæ˜¯ä¸ªè´Ÿå¯¹æ•°ä¼¼ç„¶ï¼š $$-\\log{p_{\\theta}(x_0)}$$ å¸Œæœ›ç¥ç»ç½‘ç»œçš„å‚æ•° $\\theta$ï¼Œå¯ä»¥ä½¿å¾—ç”Ÿæˆ $x_0$çš„æ¦‚ç‡è¶Šå¤§è¶Šå¥½ã€‚ ä½†é—®é¢˜åœ¨äº $x_0$ çš„æ¦‚ç‡ä¸å¥½è®¡ç®—ï¼Œå› ä¸ºå®ƒä¾èµ–äº $x_0$ ä¹‹å‰çš„æ‰€æœ‰æ­¥é•¿ï¼Œä» $x_T$ å¼€å§‹ã€‚ä½œä¸ºä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—è¿™ä¸ªç›®æ ‡çš„å˜åˆ†ä¸‹ç•Œï¼Œå¹¶å¾—åˆ°ä¸€ä¸ªæ›´æ˜“äºè®¡ç®—çš„å…¬å¼ï¼š $$-log(p_\\theta(x_0))\\leq-log(p_\\theta(x_0))+D_{KL}(q(x_{1:T}\\mid x_0)\\parallel p_\\theta(x_{1:T}\\mid x_0))$$ å…¶ä¸­ï¼š $x_{1:T}$ æŒ‡çš„æ˜¯ $x_1, â€¦, x_T$ æ•´ä¸ªåºåˆ—ã€‚ ç°åœ¨ä¾ç„¶æ— æ³•è®¡ç®—ï¼Œæˆ‘ä»¬ç»§ç»­æ¨å¯¼ï¼š $$ \\begin{gathered} -log(p_\\theta(x_0)) \\leq-log(p_\\theta(x_0))+D_{KL}(q(x_{1:T}\\mid x_0)\\mid\\mid p_\\theta(x_{1:T}\\mid x_0)) \\cr \\leq-log(p_\\theta(x_0))+log(\\frac{q(x_{1:T}\\mid x_0)}{p_\\theta(x_{1:T}\\mid x_0)}) \\end{gathered} $$ æˆ‘ä»¬å°† KL divergence æ”¹å†™åï¼Œå†åˆ©ç”¨è´å¶æ–¯å…¬å¼è¿›è¡Œå˜å½¢ï¼Œå³åˆ†æ¯å¯ä»¥æ”¹å†™ä¸ºï¼š $$ \\begin{aligned} p_\\theta(x_{1:T}\\mid x_0) \u0026=\\frac{p_\\theta(x_0\\mid x_{1:T})\\mathrm{~}p_\\theta(x_{1:T})}{p_\\theta(x_0)} \\cr \u0026=\\frac{p_\\theta(x_0,x_{1:T})}{p_\\theta(x_0)} \\cr \u0026=\\frac{p_\\theta(x_{0:T})}{p_\\theta(x_0)} \\end{aligned} $$ å°†å…¶ä»£å›åŸå¼ï¼š $$ \\begin{aligned} log(\\frac{q(x_{1:T}\\mid x_0)}{p_\\theta(x_{1:T}\\mid x_0)})\u0026 =log(\\frac{q(x_{1:T}\\mid x_0)}{\\frac{p_\\theta(x_{0:T})}{p_\\theta(x_0)}}) \\cr \u0026=log(\\frac{q(x_{1:T}\\mid x_0)}{p_\\theta(x_{0:T})})+log(p_\\theta(x_0)) \\end{aligned} $$ æ‰€ä»¥åŸå¼å¯ç®€åŒ–ä¸ºï¼š $$-log(p_\\theta(x_0))\\leq\\underbrace{log(\\frac{q(x_{1:T}\\mid x_0)}{p_\\theta(x_{0:T})})}_{\\text{å˜åˆ†ä¸‹ç•Œ,å¯ä»¥ä¼˜åŒ–å®ƒ}}$$ åˆ†å­ï¼Œå°±æ˜¯å‰å‘è¿‡ç¨‹ï¼Œå®ƒæ˜¯å›ºå®šçš„ï¼Œä» $x_0$ åˆ° $x_{1:T}$ çš„é‡‡æ ·ï¼Œæ¢å¥è¯è¯´å°±æ˜¯ä»æˆ‘ä»¬æ•°æ®ä¸­çš„ä¸€äº›å›¾åƒå¼€å§‹ï¼› åˆ†æ¯ï¼Œ$p_\\theta(x_{0:T})=p(x_T)\\prod_{t=1}^Tp_\\theta(x_{t-1}\\mid x_t)$ï¼› å°† $p(x_T)$ æå‡ºæ¥ï¼Œæ˜¯å› ä¸º $p(x_T)$ æ˜¯æŒ‡å½“å‰å›¾åƒï¼Œå®ƒæ˜¯ä¸ä¾èµ–äºç½‘ç»œå‚æ•° $\\theta$ çš„. $$ \\begin{aligned} log(\\frac{q(x_{1:T}\\mid x_0)}{p_{\\theta}(x_{0:T})})\u0026 =log(\\frac{\\prod_{t=1}^Tq(x_t\\mid x_{t-1})}{p(x_T)\\prod_{t=1}^Tp_\\theta(x_{t-1}\\mid x_t)}) \\cr \u0026=-log(p(x_T))+log(\\frac{\\prod_{t=1}^Tq(x_t\\mid x_{t-1})}{\\prod_{t=1}^Tp_\\theta(x_{t-1}\\mid x_t)}) \\cr \u0026=-log(p(x_T))+\\sum_{t=1}^Tlog(\\frac{q(x_t\\mid x_{t-1})}{p_\\theta(x_{t-1}\\mid x_t)}) \\cr \u0026=-log(p(x_T))+\\sum_{t=2}^Tlog(\\frac{q(x_t\\mid x_{t-1})}{p_\\theta(x_{t-1}\\mid x_t)})+\\underbrace{log(\\frac{q(x_1\\mid x_0)}{p_\\theta(x_0\\mid x_1)})}_{t=1} \\end{aligned} $$ $q(x_t|x_{t-1})$ æ ¹æ®è´å¶æ–¯å…¬å¼å¯ä»¥å˜æ¢å¦‚ä¸‹ï¼š $$q(x_t\\mid x_{t-1})=\\frac{q(x_{t-1}\\mid x_t)q(x_t)}{q(x_{t-1})}$$ $q(x_{t-1}|x_{t})$å…·æœ‰æ¯”è¾ƒé«˜çš„æ–¹å·®ï¼Œå› ä¸ºæ ¹æ®è¿™å¼ ç…§ç‰‡ï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šå®ƒæ¥è‡ªå“ªé‡Œï¼Œä½†æ˜¯å¼•å…¥ $x_0$ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®¹æ˜“çš„é¢„æµ‹å‡º $x_{t-1}$ï¼Œ å› æ­¤æˆ‘ä»¬ä½¿ç”¨ï¼š $$\\frac{q(x_{t-1}\\mid x_t,x_0)\\mathrm{~}q(x_t\\mid x_0)}{q(x_{t-1}\\mid x_0)}$$ æ›¿æ¢è´å¶æ–¯é‡å†™åçš„å¼å­ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š $$ \\begin{aligned} log(\\frac{q(x_{1:T}\\mid x_0)}{p_{\\theta}(x_{0:T})})\u0026 =-log(p(x_T))+\\sum_{t=2}^Tlog(\\frac{q(x_{t-1}\\mid x_t,x_0)q(x_t\\mid x_0)}{p_\\theta(x_{t-1}\\mid x_t)q(x_{t-1}\\mid x_0)})+log(\\frac{q(x_1\\mid x_0)}{p_\\theta(x_0\\mid x_1)}) \\cr \u0026=-log(p(x_T))+\\sum_{t=2}^Tlog(\\frac{q(x_{t-1}\\mid x_t,x_0)}{p_\\theta(x_{t-1}\\mid x_t)})+\\underbrace{\\sum_{t=2}^Tlog(\\frac{q(x_t\\mid x_0)}{q(x_{t-1}\\mid x_0)})}+log(\\frac{q(x_1\\mid x_0)}{p_\\theta(x_0\\mid x_1)}) \\end{aligned} $$ ä¸Šè¿°æ ‡è®°çš„å¼å­ï¼Œä¹Ÿå¯ä»¥ç®€åŒ–ï¼Œæˆ‘ä»¬å‡è®¾ $t=4$ï¼š $$ \\begin{gathered} \\begin{aligned}\\sum_{t=2}^{T=4}log(\\frac{q(x_t\\mid x_0)}{q(x_{t-1}\\mid x_0)})\\end{aligned} =log(\\frac{q(x_2\\mid x_0)}{q(x_1\\mid x_0)}\\cdot\\frac{q(x_3\\mid x_0)}{q(x_2\\mid x_0)}\\cdot\\frac{q(x_4\\mid x_0)}{q(x_3\\mid x_0)}) \\ =log(\\frac{q(x_4\\mid x_0)}{q(x_1\\mid x_0)}) \\end{gathered} $$ å› æ­¤æˆ‘ä»¬å¯ä»¥ç®€åŒ–ä¸ºï¼š $$ \\begin{aligned} \u0026=-log(p(x_T))+\\sum_{t=2}^Tlog(\\frac{q(x_{t-1}\\mid x_t,x_0)}{p_\\theta(x_{t-1}\\mid x_t)})+log(\\frac{q(x_t\\mid x_0)}{q(x_1\\mid x_0)})+log(\\frac{q(x_1\\mid x_0)}{p_\\theta(x_0\\mid x_1)}) \\cr \u0026=-log(p(x_T))+\\sum_{t=2}^Tlog(\\frac{q(x_{t-1}\\mid x_t,x_0)}{p_\\theta(x_{t-1}\\mid x_t)})+log(q(x_t\\mid x_0))-log(p_\\theta(x_0\\mid x_1)) \\cr \u0026=log(\\frac{q(x_t\\mid x_0)}{p(x_T)})+\\sum_{t=2}^Tlog(\\frac{q(x_{t-1}\\mid x_t,x_0)}{p_\\theta(x_{t-1}\\mid x_t)})-log(p_\\theta(x_0\\mid x_1))\\cr \u0026=\\overbrace{\\underbrace{D_{KL}(q(x_t\\mid x_0)\\mid\\mid p(x_T))}{q\\text{åªæ˜¯ä¸ªæ­£å‘è¿‡ç¨‹æ²¡æœ‰å¯å­¦ä¹ å‚æ•°}}}^{\\text{å¯ä»¥å¿½ç•¥}} + \\sum{t=2}^TD_{KL}(q(x_{t-1}\\mid x_t,x_0)\\mid\\mid p_\\theta(x_{t-1}\\mid x_t))-log(p_\\theta(x_0\\mid x_1)) \\","date":"2023-07-31","objectID":"/posts/ddpm/:4:1","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"4.3ã€è®­ç»ƒæŸ ä¸‹é¢æˆ‘ä»¬æ¥çœ‹æŸå¤±çš„æ¨å¯¼ï¼Œæˆ‘ä»¬æ¥å›é¡¾ç¬¬äºŒé¡¹ï¼š æˆ‘ä»¬éœ€è¦å‡å°KLæ•£åº¦ï¼Œç”±äºæ–¹å·®æ˜¯å›ºå®šçš„ï¼Œæˆ‘ä»¬æ— æ³•ä¼˜åŒ–ï¼Œæ‰€ä»¥éœ€è¦å°†å®ƒä»¬çš„å‡å€¼ä¹‹å·®å‡å°ï¼ŒåŸè®ºæ–‡ä¸­ä½¿ç”¨çš„æ˜¯ç®€å•çš„å‡æ–¹è¯¯å·®ï¼š å°†$\\mu$è¡¨è¾¾å¼ä»£å…¥ï¼š $$ \\begin{aligned} L_{t}\u0026 =\\frac1{2\\sigma_t^2}\\mid|\\tilde{\\mu}t(x_t,x_0)-\\mu\\theta(x_t,t)||^2 \\cr \u0026=\\frac1{2\\sigma_t^2}\\mid\\mid\\frac1{\\sqrt{\\alpha_t}}(x_t-\\frac{\\beta_t}{\\sqrt{1-\\overline{\\alpha}t}}\\left.\\varepsilon\\right)-\\frac1{\\sqrt{\\alpha_t}}(x_t-\\frac{\\beta_t}{\\sqrt{1-\\overline{\\alpha}t}}\\left.\\varepsilon\\theta(x_t,t)\\right)\\mid\\mid^2 \\cr \u0026=\\frac{\\beta_t^2}{2\\sigma_t^2\\alpha_t(1-\\overline{\\alpha}t)}\\underbrace{\\mid\\mid\\varepsilon-\\varepsilon\\theta(x_t,t)\\mid\\mid^2}{mse} \\cr \u0026-\u003e\\mid\\mid\\varepsilon-\\varepsilon_\\theta(x_t,t)\\mid\\mid^2=\\mid\\mid\\varepsilon-\\varepsilon_\\theta(\\sqrt{\\overline{\\alpha}_t}\\left.x_0+\\sqrt{1-\\overline{\\alpha}_t}\\left.\\varepsilon_t,t\\right)\\mid\\mid^2\\right. \\end{aligned} $$ ç ”ç©¶äººå‘˜å‘ç°ï¼Œå¿½ç•¥å‰é¢çš„ç³»æ•°é¡¹ä¼šå˜å¾—æ›´ç®€å•ï¼Œé‡‡æ ·è´¨é‡ä¹Ÿä¼šå¾—åˆ°æé«˜ï¼Œæ‰€ä»¥å‰é¢è¿™ä¸ªç³»æ•°é¡¹æˆ‘ä»¬ç›´æ¥å¿½ç•¥ï¼Œå®ƒæ˜¯å’Œå™ªå£°è°ƒåº¦å™¨æœ‰å…³çš„ï¼Œæˆ‘ä»¬åŠ å™ªçš„è¯ä¹Ÿä¼šä½¿è®¡ç®—å¤æ‚ã€‚ æˆ‘ä»¬æœ€å°åŒ– $\\mid\\mid\\varepsilon-\\varepsilon_\\theta(x_t, t)\\mid\\mid^2$ ä¹Ÿå°±æ˜¯æœ€å°åŒ–äº†KLæ•£åº¦ï¼ŒKLæ•£åº¦å˜å°äº†ä¹Ÿå°±æ˜¯å˜åˆ†ä¸Šé™ä¼˜åŒ–åˆ°æœ€å°ï¼Œæ‰€ä»¥é‚£ä¸ªè´Ÿå¯¹æ•°ä¼¼ç„¶ä¹Ÿä¼šå˜å°ã€‚ ä¸Šé¢è¿˜å‰©äº†æœ€åä¸€é¡¹ $-log(p_\\theta(x_0\\mid x_1))$ ï¼Œè¿™ä¸ªä½œè€…å†³å®šå»æ‰å®ƒï¼Œå³åœ¨ $t=1$ æ—¶ï¼Œæˆ‘ä»¬ä¸æ·»åŠ å™ªå£°ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢æ¨ªçº¿çš„åœ°æ–¹ï¼Œåªæœ‰ $t\u003e1$ çš„æ—¶å€™æ‰æœä»é«˜æ–¯åˆ†å¸ƒï¼Œå¦‚æœ $t\\leq {1}$ï¼Œç›´æ¥è®© $z=0$ï¼Œå³å™ªå£°è®¾ç½®ä¸º0ã€‚ å›é¡¾ä¸Šé¢æ•´ä¸ªæ¨å¯¼è¿‡ç¨‹ï¼šæˆ‘ä»¬ä»è´Ÿå¯¹æ•°ä¼¼ç„¶ -\u003e ä¼˜åŒ–ä¸‹ç•Œ -\u003e ç®€åŒ–ä¸‹ç•Œ -\u003e é¢„æµ‹å™ªå£°ã€‚ ","date":"2023-07-31","objectID":"/posts/ddpm/:4:2","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["ML"],"content":"äº”ã€torchå¤ç° https://wangguisen.blog.csdn.net/article/details/128821008 ref: [1]. https://arxiv.org/abs/2006.11239 [2]. https://kexue.fm/archives/9119 [3]. https://zhuanlan.zhihu.com/p/576475987 [4]. https://zhuanlan.zhihu.com/p/525106459 [5]. https://www.bilibili.com/video/BV1b541197HX [6]. https://www.bilibili.com/video/BV1WD4y1E7X5 [7]. https://huggingface.co/blog/annotated-diffusion [8]. https://www.datalearner.com/blog/1051664857725795 [9]. https://lilianweng.github.io/posts/2021-07-11-diffusion-models [10]. https://mp.weixin.qq.com/s?__biz=Mzk0MzIzODM5MA==\u0026mid=2247486128\u0026idx=1\u0026sn=7ffef5d8c1bbf24565d0597eb5eaeb16\u0026chksm=c337b729f4403e3f4ca4fcc1bc04704f72c1dc02876a2bf83c330e7857eba567864da6a64e18\u0026scene=21#wechat_redirect [11]. paper link ","date":"2023-07-31","objectID":"/posts/ddpm/:5:0","tags":["draft"],"title":"Diffusion æ‰©æ•£æ¨¡å‹ï¼ˆDDPMï¼‰","uri":"/posts/ddpm/"},{"categories":["C++"],"content":" å‰è¨€ Effective-C++æ€»ç»“ç³»åˆ—åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬äºŒéƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬3~4ç« ï¼Œå†…å®¹èŒƒå›´Rule13~25ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule13ç®€å†™ä¸ºR13ã€‚ Effective-C++ç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››) ç”±äºåŸä¹¦åœ¨C++11ä¹‹å‰å†™æˆï¼Œæœ‰äº›ç°ä»£C++ç‰¹æ€§ä¸ä¼šæåŠï¼Œæ‰€ä»¥ä¼šæ ¹æ®æœ¬äººå¼€å‘ç»éªŒæ–°å¢ä¸€äº›ä¸ªäººæ„Ÿæ‚ŸğŸ‘‰By the wayç¯èŠ‚ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:0:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"CH7 æ¨¡æ¿ä¸æ³›å‹ç¼–ç¨‹ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:1:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R41 äº†è§£éšå¼æ¥å£å’Œç¼–è¯‘æœŸå¤šæ€ é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é€šå¸¸åšæ³•ï¼š æ˜¾å¼å®šä¹‰æ¥å£ï¼ˆå‚æ•°å’Œè¿”å›å€¼ç±»å‹éƒ½æ˜¯ç¡®å®šçš„ï¼Œå‡½æ•°ç­¾å å°±æ˜¯ç¡®å®šçš„ï¼‰ è™šå‡½æ•°å®ç°è¿è¡Œæ—¶å¤šæ€ é‚£ä¹ˆç¼–è¯‘æœŸå¤šæ€å‘¢ï¼Ÿåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„ç­”æ¡ˆé€šå¸¸æ˜¯å‡½æ•°é‡è½½ã€‚ åœ¨Templates åŠæ³›å‹ç¼–ç¨‹ä¸­ï¼Œæ›´ä¸ºæ³¨é‡çš„æ˜¯éšå¼æ¥å£å’Œç¼–è¯‘æœŸå¤šæ€ï¼š éšå¼æ¥å£: Templateçš„æ¥å£å±äºéšå¼æ¥å£ï¼Œå› ä¸ºå®ƒç±»å‹ä¸ç¡®å®šï¼Œæ‰€ä»¥æ˜¯åŸºäºæœ‰æ•ˆè¡¨è¾¾å¼æ¥åŒºåˆ†ã€‚å†åŠ ä¸Šè¿ç®—ç¬¦é‡è½½ç­‰ç‰¹æ€§ï¼Œéšå¼æ¥å£çš„è‡ªç”±åº¦éå¸¸å¤§ã€‚ ç¼–è¯‘æœŸå¤šæ€: Templateçš„å¤šæ€æ˜¯é€šè¿‡Templateå…·ç°åŒ–å’Œå‡½æ•°é‡è½½å†³è®®å‘ç”Ÿäºç¼–è¯‘æœŸã€‚ ä¸Šè¿°æè¿°çœ‹èµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Œåˆ†æä¸‹æ–¹Templateå‡½æ•°ä»£ç ï¼š template\u003ctypename T\u003e void doProcessing(T\u0026 w){ if(w.size() \u003e 10 \u0026\u0026 w != someNastyWidget){ ... } } doProcessingå±äºéšå¼æ¥å£ï¼Œç±»å‹ä¸å®šï¼Œä¼ å…¥ä¸åŒç±»å‹Tï¼Œå°±å¾—åˆ°ä¸åŒçš„å‡½æ•°ã€‚ ç”±äº æ“ä½œç¬¦é‡è½½(operator overloading) çš„å­˜åœ¨ï¼Œéšå¼æ¥å£å¯¹ä¼ å…¥çš„ T ç±»å‹çš„è¦æ±‚æ¯”è¾ƒå®½æ¾ï¼Œåˆ—ä¸¾å¦‚ä¸‹ï¼š Tç±»å‹æˆ–å…¶çˆ¶ç±»å‹å…·æœ‰ size() æ¥å£ï¼Œsize() æ¥å£è¿”å›ç±»å‹Sä¸ºæ•´å‹æˆ–è€…Sç±»å‹æœ‰ bool operator\u003e(int) æ¥å£ï¼› Tç±»å‹æœ‰ bool operator != (const T\u0026)æ¥å£ï¼›æˆ–Tç±»å‹å¯ä»¥éšå¼è½¬æ¢ä¸ºæŸSç±»å‹ï¼ŒSå¯ä»¥ä¸someNastyWidgetè¿›è¡Œ != æ¯”è¾ƒï¼Œæˆ–è€…å¹²è„†someNastyWidgetå°±æ˜¯Tç±»å‹ï¼› ä¸Šè¿°1 ã€ 2 ç‚¹çš„æè¿°æ²¡æœ‰å°† operator \u0026\u0026 è€ƒè™‘è¿›æ¥ï¼Œå¦åˆ™æƒ…å†µä¼šæ›´ä¸ºå¤æ‚ï¼Œè¿™é‡Œä¸èµ˜è¿°äº†ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:1:1","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R42 äº†è§£typenameçš„åŒé‡æ„ä¹‰ typename å’Œ class å…³é”®å­—åœ¨å£°æ˜ Template å‚æ•°çš„æ—¶å€™ï¼Œæ²¡æœ‰ä»»ä½•åŒºåˆ« å¦‚ä¸‹ç¤ºä¾‹ï¼Œæ•ˆæœæ˜¯ä¸€è‡´çš„ï¼š template\u003cclass T\u003e class Widget ; //æ—©æœŸC++ä½¿ç”¨è¿™ä¸ªå£°æ˜Templateå‚æ•° template\u003ctypename T\u003e class Widget; //ç°åœ¨æ›´æ¨èç”¨è¿™ä¸ªï¼Œæš—ç¤ºå‚æ•°ä¸ä¸€å®šæ˜¯ä¸ªclassç±»å‹ ä½¿ç”¨å…³é”®å­— typename æ ‡è¯† åµŒå¥—ä»å±ç±»å‹åç§° æ¨¡æ¿å†…çš„ä»å±ç±»å‹ï¼Œæ˜¯æŒ‡åœ¨æ¨¡æ¿å‡½æ•°/æ¨¡æ¿ç±»ä¸­ï¼Œéœ€è¦ä¾èµ–ä¼ å…¥çš„ template å‚æ•°é—´æ¥è¡¨ç¤ºçš„ç±»å‹ï¼Œå¦‚æœå‘ˆåµŒå¥—çŠ¶ï¼Œå°±å«åµŒå¥—ä»å±åç§°/ç±»å‹ã€‚ å¦‚ä¸‹ç¤ºä¾‹çš„ C::const_iterator å°±æ˜¯åµŒå¥—ä»å±ç±»å‹ã€‚ template\u003ctypename C\u003e void printContainer2ndVal(const C\u0026 container) { if (container.size() \u003e= 2) { typename C::const_iterator iter(container.begin()); std::cout \u003c\u003c \"this container's second value is: \" \u003c\u003c *++iter \u003c\u003c std::endl; } } æ­¤æ—¶ï¼Œtypename çš„ä½œç”¨å°±æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ C::const_iterator æ˜¯ä¸ªç±»å‹ï¼Œå¦åˆ™ä¼šç¼–è¯‘æŠ¥é”™ã€‚æ­¤æ—¶å¯ä»¥ç”¨ class å…³é”®å­—æ›¿ä»£ï¼Œä½†æ˜¯ä¸å»ºè®®ã€‚ typename ä½¿ç”¨èŒƒå›´ä¸åªæ˜¯ template å‡½æ•°å†…éƒ¨ï¼Œä¹ŸåŒ…æ‹¬äº†å‡½æ•°å…¥å‚ ï¼š template\u003ctypename C\u003e void foo(const C\u0026 container, // ä¸å…è®¸ä½¿ç”¨ \"typename\" typename C::iterator iter); // å¿…é¡»ä½¿ç”¨ \"typename\" âš ï¸ å…¶ä»–ç‰¹æ®Šæƒ…å†µï¼šä¸è¦åœ¨ åŸºç±»åˆ—è¡¨base class list æˆ– æˆå‘˜åˆå§‹åŒ–åˆ—member initialization list ä½¿ç”¨ typename template\u003ctypename T\u003e class Derived: public Base\u003cT\u003e::Nested{ //åŸºç±»åˆ—è¡¨ä¸å…è®¸ä½¿ç”¨typename public: explicit Derived(int x):Base\u003cT\u003e::Nested(x){// æˆå‘˜åˆå€¼åˆ—ä¹Ÿä¸å…è®¸typename typedef typename Base\u003cT\u003e::Nested NestedType;//ç»“åˆtypedefå®šä¹‰ï¼Œå¸¸è§„ç”¨æ³• NestedType temp; ...// å…¶ä»–æ“ä½œ } }; ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:1:2","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R43 å­¦ä¹ å¤„ç†æ¨¡æ¿åŒ–åŸºç±»å†…çš„åç§° æ¨¡æ¿åŒ–åŸºç±»ï¼šæŒ‡å®šä¹‰ template æ¨¡æ¿ç±»æ—¶ï¼Œç»§æ‰¿äºæŸåŸºç±» Baseï¼Œè¿™ä¸ª Base ç±»å°±æ˜¯æ¨¡æ¿åŒ–åŸºç±»ã€‚ ğŸ¤” é‚£ä¹ˆ Base ç±»æœ‰å…³çš„å‡½æ•°ç­‰åç§°è¯¥å¦‚ä½•å¤„ç†ï¼Œåœ¨å­ç±»ä¸­ç›´æ¥ä½¿ç”¨å—ï¼Ÿè¿˜æ˜¯æœ‰æ³¨æ„äº‹é¡¹ï¼Ÿè¿™ï¼Œå°±æ˜¯æœ¬èŠ‚è¦è®¨è®ºçš„é—®é¢˜ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š template\u003ctypename Company\u003e class MsgSender{ public: void SendPlain(){ std::cout \u003c\u003c \"send plain\\n\";} void SendEncrypted(){ std::cout \u003c\u003c \"send encrypted\\n\";} }; // åŸºç±» template\u003ctypename Company\u003e class LoggingMsgSender: public MsgSender\u003cCompany\u003e{//å­ç±» public: void SendPlainMsg(){ SendPlain();// ==\u003e è¿™æ ·ç›´æ¥è°ƒç”¨æ˜¯ä¸è¡Œçš„ï¼Œæƒ³æƒ³ä¸ºä»€ä¹ˆï¼Ÿ } }; ä¸Šè¿°æ³¨é‡Šä¸­é—®é¢˜çš„åŸå› ï¼šå› ä¸ºå½“å…¨ç‰¹åŒ–æ—¶å¯éšæ„å»é™¤ MsgSender å†…çš„å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨æ— æ³•ç¡®å®šåŸºç±»æ˜¯å¦ä»æœ‰ SendPlain è¿™ä¸ªæ–¹æ³•ã€‚æ‰€ä»¥ï¼Œç¼–è¯‘å™¨å¹²è„†æ‹’ç»åœ¨ç¼–è¯‘æ—¶å»æ¨¡æ¿åŒ–åŸºç±»ä¸­ä¸»åŠ¨å¯»æ‰¾ç»§æ‰¿è€Œæ¥çš„åç§°ã€‚ è§£å†³æ–¹æ³•æœ‰ä¸‰ä¸ªï¼š ä½¿ç”¨ this-\u003e è°ƒç”¨SendPlain()ï¼Œå³å¯è½¬åŒ–ä¸ºè¿è¡Œæ—¶çš„é—®é¢˜ï¼Œæ¨èè¿™ä¸ªæ–¹æ³•ï¼› ä½¿ç”¨ using MsgSender::SendPlain; è¿™æ ·çš„ using å£°æ˜å¼ï¼Œæˆ‘ä»¬åœ¨ Rule 33: é¿å…é®æ©ç”±ç»§æ‰¿å¾—æ¥çš„åç§° ä¸­ç”¨è¿‡è¿™ç§æ–¹æ³•ï¼Œæ˜¾å¼åœ°å‘Šè¯‰ç¼–è¯‘å™¨æ‰©å¤§åç§°æœç´¢èŒƒå›´ï¼Œå°è¯•å»åŸºç±»æ‰¾æ‰¾ï¼› ä½¿ç”¨æ˜¾å¼è°ƒç”¨ï¼Œå³ MsgSender::SendPlain(); ï¼Œä½†è¿™æ ·åšçš„åå¤„æ˜¯ç›´æ¥æ–­ç»äº† virtual å‡½æ•°çš„çµæ´»æ€§å’Œå¯èƒ½ï¼Œä¸å¤ªæ¨è ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:1:3","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R44 å°†ä¸å‚æ•°æ— å…³çš„ä»£ç æŠ½ç¦»templates é€šå¸¸ï¼Œåœ¨éæ¨¡æ¿ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºé‡å¤çš„ä»£ç æˆ–è€…ç±»ï¼Œä¸€èˆ¬é‡‡ç”¨æŠ½å–å…¬å…±éƒ¨åˆ†ä¸ºå•ç‹¬å‡½æ•°ï¼Œæˆ–è€…é‡‡ç”¨ç±»çš„ç»§æ‰¿/èšåˆç­‰é¢å‘å¯¹è±¡è®¾è®¡æ–¹å¼ã€‚ ä½†æ˜¯ï¼Œ template æœ‰å…³çš„ä»£ç ï¼Œæœ‰æ—¶ä»£ç é‡å¤æ˜¯éšæ™¦çš„ã€‚ è¿™ä¸€èŠ‚æ˜¯ä¸ºäº†è§£å†³ template çš„ ä»£ç è†¨èƒ€(code bloat) é—®é¢˜ï¼Œä¸»è¦åŸåˆ™ä¸º å…±æ€§ä¸å·®å¼‚æ€§åˆ†æ(commonality and variability analysis) ã€‚ **æŸäº›ä¸æ°å½“çš„è®¾è®¡ï¼Œä¼šå¯¼è‡´æ— ç•çš„ä»£ç è†¨èƒ€ã€‚**å…ˆçœ‹ä¸‹æ–¹è¿™ä¸ªåé¢æ•™æï¼š template\u003ctypename T, std::size_t n\u003e class SquareMatrix { public: void invert() { std::cout \u003c\u003c \"size is \" \u003c\u003c n \u003c\u003c std::endl; }; }; åº”ç”¨ä»£ç å¦‚ä¸‹ï¼š //ä¸‹é¢è¿™2å¥ï¼Œæ¨¡æ¿ç±»å®ä¾‹åŒ– 1 æ¬¡ã€‚ invertå‡½æ•°æœ‰ 1 ä»½å®ç° SquareMatrix\u003cint, 5\u003e mat5; SquareMatrix\u003cint, 5\u003e mat5New; //æ¢æˆä¸‹é¢è¿™2å¥ï¼Œæ¨¡æ¿ç±»å®ä¾‹åŒ– 2 æ¬¡ã€‚invertå‡½æ•°æœ‰ 2 ä»½å®ç°(é—®é¢˜æš´éœ²) SquareMatrix\u003cint, 5\u003e mat5; SquareMatrix\u003cint, 10\u003e mat10; è†¨èƒ€åŸå› ï¼šåœ¨ç¼–è¯‘å™¨çœ‹æ¥ï¼ŒSquareMatrix\u003cint, 5\u003e å’Œ SquareMatrix\u003cint, 10\u003e æ˜¯2ä¸ªå®Œå…¨ä¸åŒçš„ C++ ç±»ï¼Œå®ä¾‹åŒ–äº†2æ¬¡ï¼Œç”Ÿæˆäº†è¿™2ä¸ªç±»ã€‚è¯•æƒ³ï¼Œå¦‚æœä»£ç ä¸­è¿˜éœ€è¦å…¶ä»– size çš„SquareMatrix ï¼Œéƒ½ä¼šå†ç”Ÿæˆä¸€ä¸ªæ–°ç±»ï¼Œé‚£ä¹ˆæœ€åäºŒè¿›åˆ¶æ–‡ä»¶å°±å¤šäº†è®¸å¤šé‡å¤çš„ç›®æ ‡ä»£ç ï¼Œä¹Ÿå°±æ˜¯è†¨èƒ€ã€‚ å¦‚æœèƒ½æŠ½ç¦»å‚æ•°ç›¸å…³ä»£ç ï¼Œåšåˆ°å°ºå¯¸æ— å…³ï¼Œä¾¿å¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ è§£å†³æ€è·¯ï¼šæ–°å»ºä¸€ä¸ªåŸºç±» BaseMatrix ï¼Œå°†å°ºå¯¸å‚æ•°ä¼ å…¥ç»™åˆ°åŸºç±»ä½œä¸ºæˆå‘˜å˜é‡ä¿ç®¡ï¼Œå…·ä½“çš„æ•°æ®å¯ä»¥ç”¨æ•°ç»„æŒ‡é’ˆå½¢å¼æ‰˜ç®¡ã€‚ä¸è®ºæœ‰å¤šå°‘ä¸ªä¸å°ºå¯¸æœ‰å…³çš„æ´¾ç”Ÿç±»ï¼Œä¸€ä¸ª T ç±»å‹å°±åªæœ‰ä¸€ä¸ªåŸºç±»ï¼Œæ‰€ä»¥åŸºç±» baseInvert å‡½æ•°å®ç°åªæœ‰ä¸€ä»½ã€‚ åŸºç±»å®ç°ä»£ç å¦‚ä¸‹ï¼š template\u003ctypename T\u003e class BaseSqaureMatrix { public: BaseSqaureMatrix(std::size_t n,T* dataPtr) :n_(n), dataPtr_(dataPtr) {} protected: void baseInvert() { std::cout \u003c\u003c \"invert: pData = \" \u003c\u003c dataPtr_ \u003c\u003c \" , size = \" \u003c\u003c n_ \u003c\u003c std::endl; } void SetDataPtr(T* dataPtr) { dataPtr_ = dataPtr; }; std::size_t n_ = 0; T* dataPtr_ = nullptr; }; ç›®æ ‡æ´¾ç”Ÿç±»å®ç°å¦‚ä¸‹ï¼š template\u003ctypename T,std::size_t n\u003e class SquareMatrix : public BaseSqaureMatrix\u003cT\u003e { public: SquareMatrix() :BaseSqaureMatrix\u003cT\u003e(n,nullptr), data_(std::shared_ptr\u003cT\u003e(new T[n*n])) { this-\u003eSetDataPtr(data_.get()); } void invert() { this-\u003ebaseInvert(); }// å‚è€ƒRule43 private: std::shared_ptr\u003cT\u003e data_ ;// RAIIç®¡ç†èµ„æº }; æœ€ç»ˆæ•ˆæœï¼šç›¸åŒ T ç±»å‹çš„templateå®ä¾‹ç±»(æ¯”å¦‚SquareMatrix\u003cfloat,5\u003eå’ŒSquareMatrix\u003cfloat,6\u003e)ï¼Œå…±äº«å®ç°ç ï¼Œç¥›é™¤ä»£ç è†¨èƒ€ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:1:4","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R45 è¿ç”¨æ¨¡æ¿æˆå‘˜å‡½æ•°æ¥å—æ‰€æœ‰å…¼å®¹ç±»å‹ ä¼—æ‰€å‘¨çŸ¥ï¼ŒBase *pBase = pDerived; è¿™æ ·æ™®é€šç±»å‹è£¸æŒ‡é’ˆçš„éšå¼è½¬æ¢æ˜¯è¢« C++ æ‰€è®¤å¯çš„ã€‚ é‚£ä¹ˆå¦‚æœæ¢æˆæ™ºèƒ½æŒ‡é’ˆæ¨¡æ¿ç±» SmartPtr å’Œ SmartPtr å‘¢ï¼Œè¿˜èƒ½è¿™æ ·ä¸éœ€é¢å¤–é…ç½®å°±éšæ„è½¬æ¢å—ï¼Œç­”æ¡ˆæ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼ˆçºµç„¶ Base å’Œ Derived æ˜¯å…¼å®¹ç±»å‹ä¹Ÿä¸è¡Œï¼‰ã€‚ æœ¬èŠ‚ï¼Œå°±é‡‡ç”¨æ¨¡æ¿æˆå‘˜å‡½æ•°æ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚ ä½¿ç”¨æ¨¡æ¿æˆå‘˜å‡½æ•°ï¼Œæ¥å—æ‰€æœ‰å…¼å®¹ç±»å‹çš„â€œæ³›åŒ–æ„é€ â€/â€œæ³›åŒ–èµ‹å€¼â€ æ³›åŒ–(generalized)Copyæ„é€ ï¼Œæ˜¯æŒ‡æ¥å—å…¶ä»–å…¼å®¹ç±»å‹è¿›è¡Œæ¨¡æ¿å‡½æ•°çš„Copyæ„é€ ã€‚ä¸¾ä¾‹ä¸€ä¸ªç²—ç³™çš„ RAII æ™ºèƒ½æŒ‡é’ˆå®ç°ï¼Œä»£ç å¦‚ä¸‹ğŸ‘‡: template\u003cclass T\u003e class SmartPtr { public: SmartPtr(T* origPtr) :originPtr_(origPtr) {} SmartPtr(const SmartPtr\u0026 smt) :originPtr_(smt.get()) {}// æ­£å¸¸Copyæ„é€ å‡½æ•° //æ­£å¸¸copyæ“ä½œç¬¦å‡½æ•°: ç®€å•æ¼”ç¤ºï¼Œå°±æµ…å¤åˆ¶å§ SmartPtr\u0026 operator=(const SmartPtr\u0026 smt) { originPtr_ = smt.get(); return *this; } template\u003cclass U\u003e //æ³›åŒ–æ„é€ å‡½æ•° SmartPtr(const SmartPtr\u003cU\u003e\u0026 other):originPtr_(other.get()) { } //ä¸ºäº†éšå¼è½¬æ¢ä¸åŠ  explict template\u003cclass U\u003e //æ³›åŒ–èµ‹å€¼æ“ä½œç¬¦ SmartPtr\u0026 operator=(const SmartPtr\u003cU\u003e\u0026 other) { originPtr_ = other.get(); return *this; }//ç®€å•æ¼”ç¤ºï¼Œæµ…å¤åˆ¶ T* get() const { return originPtr_; } ~SmartPtr() { delete originPtr_;} private: T* originPtr_ = nullptr; }; æœ‰ä¸Šè¿°çš„ä»£ç æ”¯æŒï¼Œæˆ‘ä»¬å°±èƒ½å†™å‡ºå¦‚ä¸‹çš„åº”ç”¨ä»£ç ï¼š class BaseObj{}; class DerivedObj:public BaseObj {};//DerivedObjæ˜¯BaseObjå…¼å®¹ç±»å‹ SmartPtr\u003cDerivedObj\u003e smDerived(new DerivedObj()); SmartPtr\u003cBaseObj\u003e smBase(smDerived); SmartPtr\u003cBaseObj\u003e smBase2 = smDerived; å³ä½¿æœ‰ â€œæ³›åŒ–æ„é€ / èµ‹å€¼â€ï¼Œä¹Ÿéœ€è¦æ­£å¸¸çš„ Copyæ„é€ /èµ‹å€¼ æ³¨æ„ï¼Œæ¨¡æ¿æˆå‘˜å‡½æ•°ä¸ä¼šæ”¹å˜è¯­è¨€è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´â€œæ³›åŒ–æ„é€ â€ä¸èƒ½ä»£æ›¿æ­£å¸¸çš„ copy æ„é€ å‡½æ•°ã€‚æ‰€ä»¥ï¼Œéœ€è¦åŒæ—¶å£°æ˜æ­£å¸¸çš„ Copy æ„é€ å‡½æ•°å’Œ Copy èµ‹å€¼æ“ä½œç¬¦å‡½æ•°ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:1:5","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R46 éœ€è¦ç±»å‹è½¬æ¢æ—¶è¯·ä¸ºæ¨¡æ¿å®šä¹‰éæˆå‘˜å‡½æ•° æœ‰æ—¶æˆ‘ä»¬å¸Œæœ› class æ”¯æŒç±»å‹è½¬æ¢ï¼Œç±»ä¼¼æœ¬ä¹¦çš„å¦å¤–ä¸€èŠ‚ğŸ‘‰ Rule24:è‹¥æ‰€æœ‰å‚æ•°çš†éœ€ç±»å‹è½¬æ¢ï¼Œè¯·é‡‡ç”¨non-member ã€‚ å¦‚æœ Rule24 ä¸­çš„ Rational ç±»æ˜¯ template æ¨¡æ¿ç±»ï¼Œç›´æ¥ä»¿ç…§ Rule24 åˆ©ç”¨ non-member å‡½æ•°åšæ··åˆè¿ç®—æ˜¯è¡Œä¸é€šçš„ï¼ŒåŸå› æ˜¯ template å®å‚æ¨å¯¼æ˜¯ä¸é‡‡çº³ â€œé€šè¿‡æ„é€ å‡½æ•°è€Œå‘ç”Ÿçš„â€éšå¼ç±»å‹è½¬æ¢ã€‚ è§£å†³åŠæ³•å¦‚ä¸‹: ä½¿ç”¨ â€œtemplate class å†…éƒ¨çš„friendå‡½æ•°â€ å®Œæˆå‚æ•°éšå¼è½¬æ¢ å°† Rule24 çš„ non-member çš„ operator *å‡½æ•°æ”¹ä¸º inline-friend å‡½æ•°ï¼Œå› ä¸º template å®ä¾‹åŒ–çš„æ—¶å€™éœ€è¦æ‰¾åˆ°è¯¥ friend å‡½æ•°çš„å®šä¹‰å®ç°ï¼Œç±»å¤–å®šä¹‰å®ç°æ˜¯ä¼šé“¾æ¥é”™è¯¯çš„ï¼Œæ‰€ä»¥éœ€è¦ inline ã€‚ å‚è€ƒä»£ç å®ç°å¦‚ä¸‹ï¼š template\u003ctypename T\u003e class RationalNew { public: RationalNew(T numerator = 0, T denominator = 1) :numerator_(numerator), denominator_(denominator) {} T numerator()const { return numerator_; } T denominator()const { return denominator_; } friend const RationalNew\u003cT\u003e operator*(const RationalNew\u003cT\u003e\u0026lhs, const RationalNew\u003cT\u003e\u0026rhs) { return RationalNew\u003cT\u003e(lhs.numerator()*rhs.numerator(),lhs.denominator()*rhs.denominator()); } private: T numerator_ = 0; T denominator_ = 1; }; é‚£ä¹ˆï¼Œå¯¹å¦‚ä¸‹çš„åº”ç”¨ä»£ç ï¼Œå°±ä½¿ç”¨è‡ªå¦‚äº†ï¼š RationalNew\u003cfloat\u003e oneHalf(1.0,2.0); RationalNew\u003cfloat\u003e res = oneHalf * 2; RationalNew\u003cfloat\u003e res2 = 3 * oneHalf; è‹¥inline-friendå‡½æ•°ä½“å¤ªå¤§ï¼Œå¯ä»¥æŠ½ç¦»å‡ºç±»å¤–è¾…åŠ©å‡½æ•°ä¾›inlineè°ƒç”¨ ä¸Šè¿°çš„ operator* å‡½æ•°ä½“åªæœ‰ä¸€è¡Œï¼Œå®ç°ç®€å•ï¼Œä½†å¦‚æœå®ç°è¿‡ç¨‹å¤æ‚ä»£ç é‡å¤§ï¼Œè€ƒè™‘ inline å¸¦æ¥çš„å†²å‡»ä»¥åŠä»£ç å¯è¯»æ€§ï¼Œå¯ä»¥æŠ½å–ä¸ªå‡½æ•°å‡ºæ¥ä¾› inline-friend è°ƒç”¨ã€‚ ä¿®æ”¹æ–¹å¼å¦‚ä¸‹ï¼š template\u003ctypename T\u003e class RationalNew { public: // å…¶ä»–éƒ¨åˆ†ç•¥ã€‚æ³¨æ„ operator* å‡½æ•°ä½“å®ç°ï¼Œæ”¹ä¸ºè°ƒç”¨doMultiply friend const RationalNew\u003cT\u003e operator*(const RationalNew\u003cT\u003e\u0026lhs, const RationalNew\u003cT\u003e\u0026rhs) { return doMultiply(lhs,rhs); } }; // ç±»å¤–å‡½æ•° doMultiply template\u003ctypename T\u003e const RationalNew\u003cT\u003e doMultiply(const RationalNew\u003cT\u003e\u0026lhs, const RationalNew\u003cT\u003e\u0026rhs) { return RationalNew\u003cT\u003e(lhs.numerator()*rhs.numerator(), lhs.denominator()*rhs.denominator()); } ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:1:6","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R47 è¯·ä½¿ç”¨traits classesè¡¨ç°ç±»å‹ä¿¡æ¯ C++ ä¸­é€šå¸¸æŠŠ Traits ç§°ä¸ºç±»å‹èƒå–æŠ€æœ¯ï¼Œå³ï¼šåœ¨ template ç¼–ç¨‹ä¸­ï¼Œè·å–æ¨¡æ¿å‚æ•°çš„ç±»å‹ä¿¡æ¯ï¼Œå¹¶åœ¨ç¼–è¯‘é˜¶æ®µé’ˆå¯¹ä¸åŒçš„ç±»å‹å“åº”ä¸åŒçš„å¤„ç†ã€‚åŒæ—¶ï¼Œè¿™ä¸ªæŠ€æœ¯è¦æ±‚å¯¹C++å†…ç½®ç±»å‹built-in å’Œ ç”¨æˆ·è‡ªå®šä¹‰user-defined ç±»å‹çš„è¡¨ç°å¿…é¡»ä¸€æ ·å¥½ã€‚ æœ¬èŠ‚è®¨è®ºæ­¤è®®é¢˜ï¼Œå¹¶ä¸”ä»¥ä¸€ä¸ª C++ æ ‡å‡†çš„æ¨¡æ¿å‡½æ•°ä½œä¸ºåˆ‡å…¥å£è¿›è¡Œè®¨è®º(std::advanceï¼Œä½œç”¨æ˜¯å…¼å®¹ä¸åŒç±»å‹è¿­ä»£å™¨ï¼Œç”¨äºåç»­å–ç”¨æŒ‡å®šåç§»é‡çš„å…ƒç´  )ã€‚ ä¸‹æ–¹ â€œBy the wayâ€ ç¯èŠ‚ç®€å•å±•ç¤ºäº† std::advance æ ‡å‡†C++çš„å£°æ˜å¼å’ŒåŸºæœ¬ç”¨æ³•ï¼š ğŸ‘‡ï¼ˆå•å‡»å±•å¼€ï¼‰ By the way std::advance éœ€è¦çš„å¤´æ–‡ä»¶åŒ…å«ä¸º #include\u003citerator\u003e ï¼Œå†çœ‹ä¸‹å®ƒçš„å‡½æ•°åŸå‹å£°æ˜ï¼š template\u003c class InputIt, class Distance \u003e void advance( InputIt\u0026 it, Distance n ); // C++17 ä¹‹å‰ template\u003c class InputIt, class Distance \u003e constexpr void advance( InputIt\u0026 it, Distance n ); // è‡ªC++17 å¼€å§‹ å†çœ‹ä¸‹ç¤ºä¾‹åº”ç”¨ä»£ç ï¼š std::vector\u003cint\u003e nums{1,2,3,4,5}; auto vIter = nums.begin(); std::advance(vIter, 3); std::cout \u003c\u003c \"after advance 3 offset: *vIter = \" \u003c\u003c *vIter \u003c\u003c std::endl; std::deque\u003cfloat\u003e fNums{0.1,0.2,0.3,0.4,0.5,0.6}; auto dIter = fNums.end(); std::advance(dIter,-2); std::cout \u003c\u003c \"after advance -2 offset: *dIter = \" \u003c\u003c *dIter \u003c\u003c std::endl; std::list\u003cchar\u003e chList{10,20,30,40}; auto cIter = chList.begin(); std::advance(cIter,2); std::cout \u003c\u003c \"after advance 2 offset: *cIter = \" \u003c\u003c int(*cIter) \u003c\u003c std::endl; æœ€ç»ˆè¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š after advance 3 offset: *vIter = 4 after advance -2 offset: *dIter = 0.5 after advance 2 offset: *cIter = 30 èƒŒæ™¯çŸ¥è¯† ğŸ‘‰ STL è¿­ä»£å™¨æŒ‰ç…§åŠŸèƒ½åˆ†ä¸º 5 ç±»ï¼Œå¦‚ä¸‹æ–¹è¡¨æ ¼æ‰€è¿°ï¼š æè¿° ç‰¹ç‚¹ åº”ç”¨ input è¿­ä»£å™¨ åªå‘å‰ç§»åŠ¨ï¼Œä¸€æ¬¡ä¸€æ­¥ï¼Œåªè¯» istream_iterators outputè¿­ä»£å™¨ åªå‘å‰ç§»åŠ¨ï¼Œä¸€æ¬¡ä¸€æ­¥ï¼Œåªå†™ ostream_iterators forwardè¿­ä»£å™¨ åªå‘å‰ç§»åŠ¨ï¼Œä¸€æ¬¡ä¸€æ­¥ï¼Œå¯è¯»å†™ single-list iterator Bidirectionalè¿­ä»£å™¨ åŒå‘ç§»åŠ¨ï¼Œä¸€æ¬¡ä¸€æ­¥ï¼Œå¯è¯»å†™ set/multiset/map/multimap random-accessè¿­ä»£å™¨ åŒå‘ç§»åŠ¨ï¼Œä¸€æ¬¡å¤šæ­¥ï¼Œå¯è¯»å†™ vetor/deque/string å¦‚ä½•è®¾è®¡ä¸€ä¸ª trait_class å¹¶è¿ç”¨èµ·æ¥å‘¢ï¼Ÿ Step1ï¼š ç¡®è®¤è‹¥å¹²ä¸ªå¸Œæœ›è·å–çš„ç±»å‹ä¿¡æ¯ (æœ¬ä¾‹åªæœ‰ä¸€ä¸ª iterator ç±»åˆ«ä¿¡æ¯) é’ˆå¯¹5 ç§è¿­ä»£å™¨åˆ†ç±»ï¼ŒC++ æä¾›äº†ä¸“å±çš„ å·æ ‡ç»“æ„tag struct åŠ ä»¥åŒºåˆ†(å¯ä»¥ç†è§£ä¸ºç¼–è¯‘æœŸçš„æšä¸¾ä½œç”¨)ï¼Œç»§æ‰¿å…³ç³»å¦‚ä¸‹ï¼š struct input_iterator_tag{}; struct output_iterato_tag{}; struct forward_iterator_tag:public input_iterator_tag {}; struct bidirectional_iterator_tag: public forward_iterator_tag{}; struct random_access_iterator_tag: public bidirectional_iterator_tag{};` Step2ï¼šä¸ºè¯¥ä¿¡æ¯é€‰ä¸€ä¸ªåç§° (ä¾‹å¦‚ iterator_category) é‚£ä¹ˆ vectorï¼Œsetä¹‹ç±»çš„ç›®æ ‡å®¹å™¨ç±»ï¼Œå¦‚ä½•ä¸ä¸Šè¿° iterator_tag è”ç³»èµ·æ¥å‘¢ï¼Œéœ€è¦ä¸€ä¸ªåç§°ä¼ é€’å‡ºå»ï¼š template\u003c ... \u003e //çœç•¥template å‚æ•° class vector { public: class iterator{ public: // ps: C++11 ä¹‹åä½¿ç”¨çš„éƒ½æ˜¯ using å®šä¹‰å¼ typedef random_access_iterator_tag iterator_category; }; }; Step3ï¼šæä¾›ä¸€ä¸ª template ç±»å’Œä¸€ç»„ç‰¹åŒ–ç‰ˆæœ¬ï¼ˆç‰¹åŒ–ç‰ˆæœ¬æ”¯æŒæŸäº›ç‰¹æ®Šæƒ…å†µï¼‰ Traits æŠ€æœ¯é’ˆå¯¹äºè¿­ä»£å™¨çš„å…³é”®æ¨¡æ¿ç±» iterator_traits å®šä¹‰å¦‚ä¸‹ï¼š template\u003ctypename IterT\u003e // æ³¨æ„ï¼šä½¿ç”¨çš„æ˜¯ struct struct iterator_traits { //è¿™é‡Œçš„ IterT å°±å¯ä»¥ä¼ å…¥vectorç­‰å®¹å™¨ç±» typedef typename IterT::iterator_category iterator_category; } æ³¨æ„ï¼Œè¿™é‡Œçš„ IterT ç±»å‹ä¸èƒ½æ˜¯æŒ‡é’ˆç±»å‹ï¼Œå› ä¸º pointer ä¸èƒ½åç»­åµŒå¥—ã€‚é‚£ä¹ˆå°±éœ€è¦ä¸€ä¸ªç‰¹åŒ–ç‰ˆæœ¬äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š template\u003ctypename IterT\u003e struct iterator_traits\u003cIterT*\u003e{ // æŒ‡é’ˆç±»å‹å’Œ random è¿­ä»£å™¨ç±»ä¼¼ typedef random_access_iterator_tag iterator_category; } è‡³æ­¤ï¼Œiterator_traits çš„åŸºæœ¬å®ç°å°±å®Œæˆäº†ï¼Œä¹Ÿå°±æ˜¯è¯´ iterator_traits\u003cIterT\u003e::iterator_category å¯ä»¥åœ¨ç¼–è¯‘æœŸç¡®å®šï¼Œæ¥ä¸‹æ¥çœ‹çœ‹advance å‡½æ•°å¦‚ä½•ä½¿ç”¨å®ƒã€‚ ğŸ’— æ­£ç¡®åšæ³•ï¼šåˆ©ç”¨ å‡½æ•°é‡è½½overloading æŠ€æœ¯ï¼Œä½¿å¾— trait classes åœ¨ç¼–è¯‘æœŸå¯¹ç±»å‹æ‰§è¡Œ if â€¦ else æµ‹è¯•ã€‚ å›é¡¾æˆ‘ä»¬çš„ advance å‡½æ•°ï¼Œåªæœ‰è¿­ä»£å™¨ç±»å‹ IterT å’Œ åç§»é‡ DistT ã€‚å¯ä»¥é‡è½½å…¶å­å‡½æ•° doAdvance ï¼Œå®Œæˆç±»å‹èƒå–åçš„è‡ªé€‚åº”ï¼š template\u003ctypename IterT, typename DistT\u003e void doAdvance(IterT\u0026 iter, DistT d, std::random_access_iterator_tag) { iter += d; } template\u003ctypename IterT, typename DistT\u003e void doAdvance(IterT\u0026 iter, DistT d, std::bidirectional_iterator_tag) { if (d \u003e= 0) { while (d--) ++iter; } else { while (d++) --iter; } } template\u003ctypename IterT, typename DistT\u003e void doAdvance(IterT\u0026 iter, DistT d, std::input_iterator_tag) { if (d \u003c 0) {throw std::out_of_range(\"Negative distance\");}//ps: msvcä¸­çš„C++å®ç°æ˜¯é‡‡ç”¨ç¼–è¯‘æœŸé—´çš„assetåˆ¤å®š while (d--) ++iter; } è‡ªç„¶åœ°ï¼Œadvance å‡½æ•°çš„å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š template\u003ctypename IterT, typename DistT\u003e void advance(IterT\u0026 iter, DistT d){ doAdvance(iter,d, /*ä¸è®º category çš„tagç±»å‹æ˜¯ä»€ä¹ˆï¼Œé‡è½½èƒ½æ‰¾åˆ°åŒ¹é…å‡½æ•°ã€‚å³ç¼–è¯‘æœŸçš„ if...else æµ‹è¯•*/ typename std::iterator_traits\u003cIterT\u003e::iterator_category()); } è‡³æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„ (ä»¥ iterator_traits ä¸ºä¾‹)Traits æŠ€æœ¯å®ç°ä¸è¿ç”¨çš„è¿‡ç¨‹å°±å®Œæˆäº†ã€‚ By the way å…³äº iterator_traits ï¼Œä¸æ­¢æœ‰ iterator_categoryï¼Œè¿˜æœ‰ difference_type, value_type, pointer, reference ç­‰4ä¸ªæˆå‘˜ï¼Œè¯¦ç»†å¯å‚è€ƒ cppå‚è€ƒæ‰‹å†Œï¼šiterator_traits ã€‚ C++ æ ‡å‡†åº“ä¸­ç±»ä¼¼ iterator_traits åº”ç”¨äº† Traits æŠ€æœ¯çš„æ¨¡æ¿æœ‰åå‡ ä¸ªã€‚ ä¸¾ä¾‹å¸¸ç”¨çš„æ•°å€¼ç±»å‹èƒå– numeric_limits ï¼Œéœ€è¦æ³¨æ„2ä¸ªç»†èŠ‚ï¼š å¤´æ–‡ä»¶æ˜¯ #include; æˆå‘˜å‡½æ•° lowest/min/max æŒ‰ç…§é¡ºåºï¼Œåˆ†åˆ«ä»£è¡¨ç»™å®šç±»å‹çš„ æœ€ä½æœ‰é™å€¼ã€æœ€å°éè´Ÿå€¼ã€æœ€å¤§æœ‰é™å€¼ã€‚å°¤å…¶æ˜¯ float/doubleï¼Œå–æœ€å°å€¼æ˜¯ lowest() ï¼Œä¸æ˜¯ min(). ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:1:7","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R48 è®¤è¯†Templateæ¨¡æ¿å…ƒç¼–ç¨‹ TMPï¼Œæ¨¡æ¿å…ƒç¼–ç¨‹template metaprogramming ï¼Œæ˜¯ç¼–å†™ template-based C++ ç¨‹åºå¹¶æ‰§è¡Œäºç¼–è¯‘æœŸçš„è¿‡ç¨‹ã€‚TMP è¿‡ç¨‹ç»“æŸåï¼Œè‹¥å¹² C++ æºç ä¼šè¢« templates å…·ç°åŒ–å‡ºæ¥ï¼Œä¾¿ä¼šä¸€å¦‚å¾€å¸¸åœ°è¢«ç¼–è¯‘ã€‚ TMP æœ‰ 2 ä¸ªå¼ºå¤§çš„ä½œç”¨ï¼š å¯ä»¥å®Œæˆé TMP çš„å¸¸è§„ç¼–ç¨‹åšä¸åˆ°çš„äº‹æƒ… æ¯”å¦‚ä»£ç ç”Ÿæˆï¼Œç±»å‹é€‚é…ç­‰ã€‚ å¯ä»¥å°†æŸäº›å·¥ä½œä»è¿è¡ŒæœŸè½¬ç§»åˆ°ç¼–è¯‘æœŸ å¯ä»¥å°†è¿è¡ŒæœŸçš„é”™è¯¯æå‰æš´éœ²åœ¨ç¼–è¯‘æœŸï¼Œå¯ä»¥è·å¾—æ›´å°çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ›´å¿«åœ°è¿è¡Œï¼Œæ›´å°‘åœ°å†…å­˜éœ€æ±‚ï¼Œç¼ºç‚¹æ˜¯æ˜æ˜¾å¢åŠ ç¼–è¯‘æ—¶é—´ã€‚ TMP å·²è¢«è¯æ˜æ˜¯ä¸ªâ€œå›¾çµå®Œå¤‡â€çš„æœºå™¨ï¼Œæ„æ€æ˜¯å®ƒå¼ºå¤§åˆ°å¯ä»¥è®¡ç®—ä»»ä½•äº‹ç‰©ã€‚ä½¿ç”¨ TMP å¯ä»¥å£°æ˜å˜é‡ã€æ‰§è¡Œå¾ªç¯ã€ç¼–å†™åŠè°ƒç”¨å‡½æ•°â€¦ç­‰ç­‰ã€‚ æ¯”è¾ƒç‰¹åˆ«çš„æ˜¯ï¼ŒTMP å®ç°ä¸Šè¿°å„ç±»åŠŸèƒ½çš„æ–¹å¼ä¸åŒäºå¸¸è§„ C++ ç¨‹åºã€‚æ¯”å¦‚ä¸Šä¸€èŠ‚ Rule47 ä¸­ä½¿ç”¨é‡è½½å®Œæˆäº†ç¼–è¯‘æœŸçš„ ifâ€¦else æ¡ä»¶åˆ†æ”¯ã€‚TMP å¾ªç¯åŠŸèƒ½ä¹Ÿé€šå¸¸ä¼šä½¿ç”¨ â€œé€’å½’å…·ç°åŒ–â€ æ¥å®Œæˆçš„ã€‚ ä¸‹æ–¹ä»£ç ç¤ºèŒƒå¦‚ä½•ä½¿ç”¨ TMP çš„æ–¹å¼æ¥è®¡ç®—é˜¶ä¹˜ï¼š template\u003cunsigned n\u003e struct Factorial { // é€’å½’çš„å½¢å¼ä½“ç°: f(n) = n * f(n -1) enum {value = n* Factorial\u003cn-1\u003e::value}; }; template\u003c\u003e struct Factorial\u003c0\u003e { // æ¨¡æ¿å…¨ç‰¹åŒ–: å®é™…æ˜¯åˆå§‹åŒ– f(0) = 1 enum {value = 1}; }; é‚£ä¹ˆé˜¶ä¹˜è®¡ç®—åœ¨ç¼–è¯‘æœŸå°±å®Œæˆäº†ï¼Œè¿è¡Œæ—¶å°±æ˜¯ç›´æ¥å–ç”¨äº†ï¼š std::cout \u003c\u003c \"Factorial(\" \u003c\u003c 5 \u003c\u003c \") = \" \u003c\u003c Factorial\u003c5\u003e::value \u003c\u003c std::endl; std::cout \u003c\u003c \"Factorial(\" \u003c\u003c 7 \u003c\u003c \") = \" \u003c\u003c Factorial\u003c7\u003e::value \u003c\u003c std::endl; ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:1:8","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"CH8 å®šåˆ¶newå’Œdelete ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:2:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R49 äº†è§£new-handlerçš„è¡Œä¸º å½“ operator new æ— æ³•æ»¡è¶³æŸä¸ªå†…å­˜åˆ†é…éœ€æ±‚æ—¶ï¼Œä¸€èˆ¬ä¼šæŠ›å‡º std::bad_alloc å¼‚å¸¸ã€‚ å¦‚æœç”¨ std::nothrow ä¿®é¥° new æ“ä½œç¬¦ï¼Œä½¿å¾—å†…å­˜åˆ†é…é˜¶æ®µä¸ä¼šæŠ›å¼‚å¸¸ï¼Œå¤±è´¥äº†å°±è¿”å› null æŒ‡é’ˆã€‚ä¸¾ä¾‹ : int *pArr = new (std::nothrow) int[0x1fffffff]; //å³ä½¿åˆ†é…å¤±è´¥ï¼Œä¹Ÿä¸æŠ›å¼‚å¸¸ï¼Œè€Œæ˜¯å¾—åˆ°nullæŒ‡é’ˆ. // nothroow-new ä¸èƒ½ä¿è¯ class åç»­çš„æ„é€ å‡½æ•°ä¸æŠ›å¼‚å¸¸ new-hanlder çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š //å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•° void OutOfMemTip() { std::cerr \u003c\u003c \"new memory fail,out of memory!\\n\"; std::abort();//ç»ˆæ­¢ç¨‹åºï¼Œè‹¥è°ƒè¯•æ¨¡å¼ä¼šå¼¹çª—æç¤º } // æ•…æ„åˆ¶é€ newå¤±è´¥çš„æƒ…å½¢ï¼Œç¨‹åºä¼šè°ƒç”¨ OutOfMemTipï¼Œè§¦å‘std::abort() std::set_new_handler(OutOfMemTip); int *pArr = new int[0x1fffffff];//çº¦2GB,å¦‚æœæ‰›çš„ä½ï¼Œè°ƒå¤§è¿™ä¸ªæ•° å¯ä»¥çœ‹å‡ºè¿™æ ·çš„å‡½æ•°æŒ‡é’ˆç»™äº†ä½¿ç”¨è€…éå¸¸å¤§çš„è®¾è®¡å¼¹æ€§ï¼Œå¯ä»¥åšåˆ°ä»¥ä¸‹äº‹æƒ…ï¼š æå‰ç”³è¯·å†…å­˜ï¼Œè®© new_handler è§¦å‘ä¸‹ä¸€æ¬¡åˆ†é…ä½¿ç”¨ï¼› å®‰è£…å¦ä¸€ä¸ª new_handler ï¼Œæˆ–è®¸æ–°çš„ handler å¯ä»¥ç”³è¯·åˆ°å†…å­˜ï¼› å¸è½½ new_handler ï¼Œåªè¦ä¼  null æŒ‡é’ˆå³å¯ï¼› æ‰‹åŠ¨æŠ› std::bad_alloc çš„å¼‚å¸¸ï¼› ä¸è¿”å›ï¼Œé€šå¸¸è°ƒç”¨ std::abort() æˆ– std::exit() ; ğŸ¤” æˆ‘ä»¬æ€è€ƒå¦å¤–ä¸€ä¸ªé—®é¢˜ï¼šæ˜¯å¦å¯ä»¥ è®©ä¸åŒçš„ C++ ç±»æ‹¥æœ‰è‡ªå·±çš„ new-handler å‘¢ï¼Ÿ C++ æ ‡å‡†æœºåˆ¶æ˜¯ä¸æ”¯æŒçš„ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°ã€‚æœ‰ä¸¤ä¸ªå®ç°é€”å¾„ï¼Œåˆ—ä¸¾å¦‚ä¸‹ï¼š é’ˆå¯¹æŸä¸ªç‰¹å®šç±» ï¼Œç±»å†…é‡è½½ static ç±»å‹çš„ operator new ä»¥åŠ set_new_handleræ–¹æ³• å…·ä½“å®ç°ç•¥ï¼Œåªæƒ³æŒ‡å‡ºè¿™æ ·åšæ³•æœ‰ä¸ªæ˜æ˜¾å¼Šç«¯ï¼Œå°±æ˜¯æ¯ä¸ªç±»éƒ½å¾—è¿™ä¹ˆåšï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œä¹Ÿå®¹æ˜“ä»£ç å†—ä½™ã€‚ ä½¿ç”¨ CRTP æ–¹æ³•ï¼ˆå³ æ€ªå¼‚çš„å¾ªç¯æ¨¡æ¿æ¨¡å¼curiously recurring template pattern ï¼‰å°†ä¸Šè¿°æ–¹æ³• 1 å¡è¿› template ç±» è¿™æ ·åšçš„å¥½å¤„æ˜¯ä½¿ç”¨æ¨¡æ¿ç±»èµ‹äºˆä¸Šè¿° operator new å’Œ set_new_hanler çš„æ“ä½œï¼Œä½¿ç”¨èµ·æ¥æ–¹ä¾¿ã€‚ CRTP æ–¹æ³•ä¸­çš„åŸºç±» NewHandlerSupport å®ç°å¦‚ä¸‹ ğŸ‘‡(ç‚¹å‡»æ‰“å¼€æŠ˜å ) ï¼š template\u003ctypename T\u003e class NewHandlerSupport { public: static std::new_handler set_new_handler(std::new_handler p)noexcept { std::new_handler oldHandler = currentHandler_; currentHandler_ = p; return oldHandler; } static void* operator new(std::size_t size) throw(std::bad_alloc) { std::new_handler oldHandle = std::set_new_handler(currentHandler_); void *res = ::operator new(size); //newå®Œåå¤åŸglobal-new-handler std::set_new_handler(oldHandle);//åŸä¹¦ä½¿ç”¨RAIIæ‰‹æ³•åœ¨è¿˜åŸè¿™ä¸ªhandlerï¼Œè¿™é‡Œä½œç”¨ç±»ä¼¼ return res; } private: static std::new_handler currentHandler_;//åˆå§‹åŒ–åŠ¨ä½œæ”¾åˆ°ç±»å¤–cppæ–‡ä»¶é‡Œå» }; é‚£ä¹ˆç›®æ ‡ç±» TestNewHandler åªè¦åŸºäº CRTP æ–¹æ³•ç»§æ‰¿äºåŸºç±»å°±å¯ä»¥äº†ï¼Œå®ç°å¦‚ä¸‹ï¼š class TestNewHandler : public NewHandlerSupport\u003cTestNewHandler\u003e { //ä¸å¿…å£°æ˜ set_new_handler æˆ– operator new }; //æœ€ç»ˆåº”ç”¨æ—¶ä¹Ÿéå¸¸ç®€å• TestNewHandler::set_new_handler(OutOfMemTip); TestNewHandler* pTestHandle = new TestNewHandler(); ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:2:1","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R50 äº†è§£newå’Œdeleteçš„åˆç†æ›¿æ¢æ—¶æœº æ›¿æ¢ç¼–è¯‘å™¨æä¾›çš„ operator new å’Œ operator delete çš„ å¸¸è§ç†ç”± å¦‚ä¸‹ï¼š æ£€æµ‹è¿ç”¨ä¸Šçš„é”™è¯¯ è‡ªå®šä¹‰çš„new/deleteå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ ¡éªŒå®é™…æ§åˆ¶çš„åŒºæ®µå†…å­˜ï¼Œæ¯”å¦‚å¯ä»¥åœ¨ç›®æ ‡åŒºå—å‰åé¢å¤–ç©ºé—´æ·»åŠ å†…å­˜ç­¾å(æ¯”å¦‚å†™å…¥ç‰¹å®š int å€¼)ï¼Œç›‘æµ‹è¶Šç•Œçš„é—®é¢˜ã€‚ è¶Šç•Œåˆ†2ç§ï¼šunderruns (åŒºå—å†…å­˜èµ·ç‚¹ä¹‹å‰) å’Œ overruns (åŒºå—å†…å­˜æœ«å°¾ä¹‹å)ã€‚ æ—¶é—´æˆ–å†…å­˜ä½¿ç”¨çš„ä¼˜åŒ– é€šç”¨çš„ new/delete éœ€è¦é€‚ç”¨å„ç§åˆ†é…å½¢æ€å’Œåœºæ™¯ï¼Œå¯¹äºå†…å­˜ç¢ç‰‡æˆ–æ—¶é—´æ€§èƒ½éƒ½æ˜¯ä¸­åº¸æ°´å¹³ã€‚ å¯¹ç‰¹å®šçš„éœ€æ±‚å’Œåœºæ™¯ï¼Œå®šåˆ¶åŒ–åœ°å†…å­˜ç®¡ç†ä¼šæœ‰å¾ˆå¥½çš„ä¼˜åŒ–æ•ˆæœã€‚ æ”¶é›†å†…å­˜ä½¿ç”¨çš„ç»Ÿè®¡æ•°æ® å¯¹å†…å­˜åˆ†é…ç»†èŠ‚çš„æŠŠæ§ï¼Œä¾‹å¦‚åˆ†é…åŒºå—çš„å¤§å°åˆ†å¸ƒã€å­˜ç»­å‘¨æœŸã€FIFO/LIFOæ¬¡åºåˆ†é…å›æ”¶ã€å†…å­˜å³°å€¼ç­‰æƒ…å†µã€‚ å¼¥è¡¥é»˜è®¤å†…å­˜åˆ†é…å™¨çš„ éæœ€ä½³å¯¹é½ä½suboptimal alignment ä¾‹å¦‚x86ä½“ç³»ç»“æ„CPUä¸Šè®¿é—®doubleéƒ½æ˜¯8byteså¯¹é½ï¼Œå¦‚æœèƒ½åœ¨å†…å­˜åˆ†é…æ—¶å°±åšå¥½å†…å­˜å¯¹é½ï¼Œå¯æå‡è®¿é—®æ•ˆç‡ã€‚ å°†ç›¸å…³å¯¹è±¡æˆç°‡é›†ä¸­ æ¯”å¦‚å·²çŸ¥æŸä¸ªæ•°æ®ç»“æ„å¾€å¾€ä¸€èµ·ä½¿ç”¨ï¼Œé‚£ä¹ˆåˆ†é…çš„æ—¶å€™åº”è¯¥å°½é‡è®©æ‰€æœ‰æ•°æ®çš„å†…å­˜é›†ä¸­ä¸€äº›ï¼Œé¿å…é¢‘ç¹è§¦å‘ æ¢é¡µä¸­æ–­page faults ï¼Œæå‡è®¿é—®æ•ˆç‡ã€‚ å…¶ä»–çš„éä¼ ç»Ÿè¡Œä¸º æƒ³å®Œæˆä¸€äº›ç³»ç»Ÿç¼–è¯‘å™¨åŠä¸åˆ°çš„äº‹æƒ…ã€‚æ¯”å¦‚å¸Œæœ›åˆ†é…é‡Šæ”¾å…±äº«å†…å­˜çš„åŒºå—ï¼Œä½†æ˜¯åªæœ‰ C-API èƒ½åšåˆ°ï¼Œé‚£å°±éœ€è¦å®šåˆ¶ç‰ˆçš„ new/delete å»åŒ…è£¹å°è£…è¿™æ ·çš„APIã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:2:2","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R51 ç¼–å†™newå’Œdeleteæ—¶éœ€å›ºå®ˆå¸¸è§„ ä¸Šä¸€ä¸ªæ¡æ¬¾è®²äº†é‡å†™ new/delete çš„åŸå› ï¼Œè¿™ä¸€èŠ‚å°†è®²è¿°å…·ä½“éœ€è¦éµå®ˆçš„å‡ ä¸ªè§„åˆ™ã€‚ æ­£ç¡®å¤„ç† new å¤±è´¥çš„æƒ…å†µ å¦‚æœåˆ†é…æ­£å¸¸ï¼Œç›´æ¥è¿”å›åŒºå—å¯¹åº”çš„æŒ‡é’ˆå³å¯ã€‚å¯å¦‚æœå¤±è´¥ï¼Œå°±å¿…é¡»å¾—æ­£ç¡®è°ƒç”¨ new-handler å‡½æ•°ï¼Œå‚è€ƒ R49 äº†è§£new-handlerçš„è¡Œä¸ºã€‚ å¦‚æœè¦æ±‚åˆ†é… 0 byte ç©ºé—´ C++è§„å®šï¼Œå¦‚æœå®¢æˆ·è¦æ±‚åˆ†é… 0 byte å†…å­˜ç”³è¯·ï¼Œå°±è¿”å› 1byte ç©ºé—´ç”³è¯·ï¼Œå¹¶è¿”å›è¯¥æœ‰æ•ˆåœ°å€ã€‚ ç†è§£ operator new å†…éƒ¨çš„æ— ç©·å¾ªç¯ operator new æœ‰ä¸ª while(true) å¾ªç¯ï¼Œåˆ†é…æˆåŠŸå¯ä»¥returnï¼Œæˆ–ç”± new-handler ä¸º nullptr æ—¶æŠ›å‡º std::bad_alloc å¼‚å¸¸ã€‚ä¼ªä»£ç pseudocode å¦‚ä¸‹ï¼š void* operator new(std::size_t size) throw(std::bad_alloc){ using namespace std; if (size == 0){ size = 1; } while (true){ å°è¯•åˆ†é… size bytes; if (åˆ†é…æˆåŠŸ) return target_pointer; new_handler globalHandler = set_new_handler(0); set_new_handler(globalHandler);//åˆ†é…å¤±è´¥äº† if(globalHandler) (*globalHanler)(); else throw std::bad_alloc(); } } å½“åŸºç±»çš„ operator new è¢«å­ç±»ç»§æ‰¿æ—¶ å½“åŸºç±»è¢«ç»§æ‰¿æ—¶ï¼Œæˆå‘˜ operator new ä¹Ÿä¸€èµ·è¢«ç»§æ‰¿äº†ï¼Œè¦æ³¨æ„çš„æ˜¯åŸºç±»å’Œå­ç±»çš„ size é€šå¸¸æ˜¯ä¸ä¸€æ ·çš„ã€‚æ¨èå®ç°å¦‚ä¸‹ï¼š class Base{ public: static void* operator new(std::size_t size)throw (std::bad_alloc){ if (size != sizeof(Base)) return ::operator new(size);//å­ç±»èµ°è¿™é‡Œ } }; å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œoperator new[] ä¸èƒ½è¿™æ ·åœ¨åŸºç±»ä¸­åŒºåˆ†ã€‚å› ä¸ºå³ä½¿åœ¨Baseç±»ï¼Œä¹Ÿæ— æ³•å‡å®šæ¯ä¸ªå…ƒç´ æ˜¯ sizeof(Base)ï¼Œé€šå¸¸è¿˜æœ‰é¢å¤–å†…å­˜ç©ºé—´æ¥ä¿å­˜å…ƒç´ ä¸ªæ•°ã€‚ operator delete çš„æ³¨æ„äº‹é¡¹ C++ éœ€è¦ä¿è¯ â€œåˆ é™¤NULLæŒ‡é’ˆæ°¸è¿œå®‰å…¨â€ï¼Œæ‰€ä»¥å¿…é¡»å…‘ç°è¿™ä¸ªè§„åˆ™ã€‚é’ˆå¯¹nullæŒ‡é’ˆï¼Œå°±ä»€ä¹ˆä¹Ÿä¸åšï¼Œç›´æ¥returnã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:2:3","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R52 å†™äº†placement-new ä¹Ÿè¦å†™placement-delete placement-newï¼Œæ˜¯æŒ‡â€œé™¤sizeå‚æ•°ä»¥å¤–ï¼Œæ¥å—ä¸€ä¸ªé¢å¤–å‚æ•°å‚ä¸æ„é€ â€çš„ ç‰¹å®š operator-newã€‚ å…¶ä¸­ï¼Œâ€œæ¥å—ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å¯¹è±¡è¯¥è¢«æ„é€ ä¹‹å¤„â€æ˜¯æœ€å¸¸ä½¿ç”¨çš„ placement-newï¼Œå³â€œä¸€ä¸ªç‰¹å®šä½ç½®ä¸Šçš„newâ€ï¼Œå½¢å¼å¦‚ä¸‹ä¸ºï¼š //è¿™ä¸ªç‰¹æ®Šçš„ä¹Ÿæ˜¯æœ€å¸¸æ¶‰åŠçš„ placement-new å·²è¢«çº³å…¥C++æ ‡å‡†ç¨‹åºåº“ void * operator new(std::size_t size,void* pMemory) noexcept; å…ˆæš‚æ—¶è€ƒè™‘ä¸€ä¸ªè°ƒç”¨äº†placement-newçš„æ­£å¸¸æ„é€ è¿‡ç¨‹ï¼š // æœ‰è¿™æ ·ä¸€ä¸ªplacement-new,æ¥æ”¶ä¸€ä¸ªostreamæ¥logåˆ†é…æ—¶çš„ç›¸å…³ä¿¡æ¯ void* operator new(std::size_t size,std::ostream\u0026 logStream) throw (std::bad_alloc); Widget* pw = new (std::cerr) Widget;//ä¼ å…¥ostream å¯¹äºä»»ä½•çš„newå¯¹è±¡æ„é€ è¿‡ç¨‹ï¼Œè‡³å°‘å¯åˆ†ä¸ºä¸‹è¿°2ä¸ªè¿‡ç¨‹ï¼š operator new åˆ†é…å¯¹è±¡éœ€è¦çš„å†…å­˜ç©ºé—´ï¼› æ‰§è¡Œå¯¹åº”çš„æ„é€ å‡½æ•° å¦‚æœä¸Šè¿°è¿‡ç¨‹ 1 æˆåŠŸäº†ï¼Œè¿‡ç¨‹ 2 æŠ›å¼‚å¸¸ï¼Œå·²ç»ç”³è¯·çš„å†…å­˜å°±éœ€è¦åŠæ—¶å›æ”¶é¿å…memory-leakï¼Œè¿è¡ŒæœŸç³»ç»Ÿå°±ä¼šå°è¯•å¯»æ‰¾å¹¶è°ƒç”¨â€œé¢å¤–å‚æ•°ä¸ªæ•°å’Œç±»å‹éƒ½ä¸operator new ä¸€è‡´çš„operator deleteâ€ï¼Œå®Œæˆå†…å­˜å›æ”¶ã€‚ é‚£ä¹ˆä¸Šè¿°äº‹å®ï¼Œå°±æ˜¯ placement-new å’Œ placement-delete éœ€è¦æˆå¯¹å®ç°çš„ç†ç”±ã€‚ é’ˆå¯¹ä¸Šä¾‹é¢å¤–å‚æ•°æ˜¯ std::ostream çš„operator newï¼Œoperator deleteï¼Œç±»å£°æ˜å½¢å¼å¦‚ä¸‹: class Widget{ public: static void* operator new(std::size_t size,std::ostream\u0026 logStream) throw (std::bad_alloc); //ä¸æŠ›å¼‚å¸¸æ—¶ï¼Œæœ€åå¯¹è±¡ææ„æ—¶æ­£å¸¸è°ƒç”¨è¿™ä¸ª static void operator delete(void *pMemory) noexcept; //newæŠ›å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨è¿™ä¸ª é¢å¤–å‚æ•°ä¸ªæ•°å’Œç±»å‹éƒ½ä¸€è‡´çš„ placement-delete static void operator delete(void *pMemory,std::ostream\u0026 logStream); }; âš ï¸ One More Thing : C++ åœ¨global ä½œç”¨åŸŸæä¾›ä»¥ä¸‹å½¢å¼çš„ operator new: void * operator new(std::size_t size) throw (std::bad_alloc); void * operator new(std::size_t size,void*) noexcept; void * operator new(std::size_t size,const std::nothrow_t \u0026) noexcept;//è§æ¡æ¬¾49 new-Handlerçš„è¡Œä¸º ğŸ˜ æ‰€ä»¥ï¼Œå¦‚æœåœ¨class å†…å£°æ˜äº†ä¸Šè¿° operator newï¼Œ åˆ™globalä½œç”¨åŸŸçš„ operator new ä¼šè¢«åç§°é®æ©ã€‚ ğŸ¤” è§£å†³åŠæ³•ï¼šåœ¨åŸºç±»å¯¹globalä½œç”¨åŸŸçš„ ::operator new è¿›è¡Œå°è£…è°ƒç”¨ï¼Œç„¶ååœ¨å­ç±»ä¸­ä½¿ç”¨using å£°æ˜å¼ç ´é™¤åç§°é®æ©ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:2:4","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"CH9 æ‚é¡¹è®¨è®º ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:3:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R53 ä¸è¦è½»æ˜“å¿½ç•¥ç¼–è¯‘å™¨çš„è­¦å‘Š ä¸¥è‚ƒå¯¹å¾…ç¼–è¯‘å™¨å‘å‡ºçš„è­¦å‘Šä¿¡æ¯ ç¼–è¯‘å™¨å‘å‡ºçš„è­¦å‘Šä¿¡æ¯ï¼Œç»å¸¸ä¼šè¢«å¿½ç•¥ã€‚No-Warningæ˜¯å€¼å¾—è¿½å´‡çš„ï¼Œé™¤éä½ å¯¹ç¼–è¯‘ warning ä¿¡æ¯æ˜¯å……åˆ†äº†è§£å¹¶ç¡®ä¿¡æ˜¯æ— å…³ç´§è¦çš„ã€‚ ä¸‹é¢ä¸¾ä¸€ä¸ªè¾ƒä¸ºå¸¸è§çš„ä¾‹å­ï¼š class BaseWarn { public: virtual std::string GetWarnInfo() const { return \"Base\"; } }; class DerivedWarn :public BaseWarn { public: virtual std::string GetWarnInfo() {//ç¼ºäº†const return \"Derived\"; } }; å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œæ²¡æœ‰æˆåŠŸå®ç°è™šå‡½æ•°é‡å†™ï¼Œè€Œæ˜¯é€ æˆäº†â€œåç§°é®æ©â€ã€‚ è¿™æ ·çš„é”™è¯¯è¾ƒä¸ºéšè”½ï¼Œæœ‰äº›ç¼–è¯‘å™¨ä¼šç»™å‡ºè­¦å‘Šä¿¡æ¯ï¼Œæœ‰äº›ç”šè‡³è¿è­¦å‘Šä¿¡æ¯éƒ½æ²¡æœ‰ï¼ˆPsï¼šæˆ‘è‡ªè¡Œæµ‹è¯•äº†VS2017ï¼Œæ²¡æœ‰warningä¿¡æ¯ï¼‰ã€‚ å¦‚æœç¼–è¯‘å™¨ç»™å‡ºäº†è­¦å‘Šä¿¡æ¯ï¼Œè¯·è®¤çœŸå¯¹å¾…ã€‚ ä¸è¦è¿‡åº¦ä¾èµ–ç¼–è¯‘å™¨çš„æŠ¥è­¦èƒ½åŠ› è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œä¸åŒç¼–è¯‘å™¨å¤„ç†æ€åº¦ä¸åŒï¼Œè­¦å‘Šä¿¡æ¯ç”šè‡³å¯èƒ½æ¢ä¸ªç¼–è¯‘å™¨å°±æ¶ˆå¤±äº†ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:3:1","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R54 ç†Ÿæ‚‰åŒ…æ‹¬TR1åœ¨å†…çš„æ ‡å‡†ç¨‹åºåº“ C++ Technical Report 1 (TR1) å¹¶éæ ‡å‡†ï¼Œè€Œæ˜¯ä¸€ä»½è‰ç¨¿æ–‡ä»¶ï¼Œå¯¹C++æ ‡å‡†åº“çš„ç¬¬ä¸€æ¬¡æ‰©å±•ï¼Œå®ƒæå‡ºäº†å¯¹C++æ ‡å‡†å‡½å¼åº“çš„è¿½åŠ é¡¹ç›®ã€‚ è¿™ä»½æ–‡ä»¶çš„ç›®æ ‡åœ¨äºã€Œä¸ºæ‰©å……çš„C++æ ‡å‡†å‡½å¼åº“å»ºç«‹æ›´ä¸ºå¹¿æ³›çš„ç°å®ä½œå“ã€ã€‚ æˆ‘çš„ç†è§£ï¼š200x å¹´å‘å¸ƒçš„ C++ ç§°ä¸º â€œC++0xâ€ï¼ŒæŒç»­ä¿®æ”¹ä¸­ï¼Œæ‰€æœ‰ä¿®æ”¹å°†åˆå¹¶äº TR1ï¼Œæœ€ç»ˆç»å¤§éƒ¨åˆ†éƒ½å®šç‰ˆã€æ”¶å½•å‘å¸ƒäº C++11ã€‚ TR1è¯¦ç»†å™è¿°äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œéƒ½æ”¾åœ¨ std::tr1 å‘½åç©ºé—´å†…ï¼ˆä»¥ä¸‹ç®€ç§° tr1:: ï¼‰ï¼Œåˆ—ä¸¾å¦‚ä¸‹ æ™ºèƒ½æŒ‡é’ˆï¼štr1::shared_ptr å’Œ tr1::weak_ptr ï¼ŒRAII åŸºç¡€ï¼Œä¸èµ˜è¿°ï¼› tr1::functionï¼šè¡¨ç¤º å¯è°ƒç”¨ç‰©callable entityï¼Œå³ä»»ä½•å‡½æ•°æˆ–å‡½æ•°å¯¹è±¡ï¼Œåªè¦ç­¾åä¸€è‡´å³å¯ï¼› tr1::bindï¼šå¯¹å‡½æ•°è°ƒç”¨çš„å°è£…ï¼Œå°†å‡½æ•°å’Œå…¶å‚æ•°ç»‘å®šä¸€èµ·ï¼› Hash tablesï¼šé‡‡å“ˆå¸Œè¡¨å½¢å¼å‚ä¸æ„æˆï¼Œåç§°ä»¥ unordered_ å¼€å¤´çš„ set/multiset/map/multimapï¼› æ­£åˆ™è¡¨è¾¾å¼ï¼šå¤´æ–‡ä»¶åœ¨ ï¼› Tuple å…ƒç»„(æˆ–å«å˜é‡ç»„)ï¼šä¸å®šé•¿å˜é‡ç»„ï¼Œæ˜¯ std::pair çš„ä¸€ç§æ³›åŒ–ï¼› tr1::array: å’Œ C è¯­è¨€æ•°ç»„ä¸€æ ·ï¼Œæ˜¯ä¸ªå®šé•¿æ•°ç»„ï¼ŒåŒ…è£¹äº† STL ç”¨æ³•ï¼› tr1::mem_fn: ä¼ å…¥ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ˆæ”¯æŒå¯¹æˆå‘˜å‡½æ•°å–å€ï¼‰ä½œä¸ºå…¥å‚ï¼Œæ„é€ ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œè¿›è€Œè°ƒç”¨ï¼Œç±»ä¼¼åœ°è¿˜æœ‰ mem_fn_ref; tr1::reference_wrapperï¼šâ€œå°è£…å¼•ç”¨ä¸ºä¸€ä¸ªå¯¹è±¡â€ï¼Œé€šå¸¸ç”¨äºå¯¹å¼•ç”¨è¿›è¡Œå°è£…ç„¶åè£…å…¥æ ‡å‡†å®¹å™¨(ç›´æ¥å¾€å®¹å™¨å¡å¼•ç”¨æ˜¯ä¸è¡Œçš„)ï¼› éšæœºæ•°ç”Ÿæˆå·¥å…·ï¼šrandom_deviceï¼Œå¯ä»¥ç›´æ¥ç”Ÿæˆæˆ–è€…ä½¿ç”¨ä¸åŒçš„ éšæœºæ•°å¼•æ“ å’Œ éšæœºåˆ†å¸ƒç®—æ³•è¿›è¡Œç”Ÿæˆï¼Œå¤´æ–‡ä»¶æ˜¯ ï¼› æ•°å­¦ç‰¹æ®Šå‡½æ•°ï¼šåŒ…æ‹¬Laguerreå¤šé¡¹å¼ã€Bessel å‡½æ•°ã€å®Œå…¨æ¤­åœ†ç§¯åˆ†ç­‰ç‰¹æ®Šæ•°å­¦å‡½æ•°ï¼Œæ³¨æ„ï¼Œè¿™äº› åœ¨ C++17 æ‰å¼•å…¥C++æ ‡å‡†ï¼Œå¯å‚è€ƒcppreference: special math ï¼Œå¤´æ–‡ä»¶åœ¨ ï¼› C99å…¼å®¹æ‰©å…… ï¼šC99æ ‡å‡†æ˜¯Cè¯­è¨€çš„å®˜æ–¹æ ‡å‡†ç¬¬äºŒç‰ˆï¼Œ1999å¹´å‘å¸ƒï¼ŒTR1å¯¹å…¶è¿›è¡Œäº†å…¼å®¹ï¼› Type traits ç±»å‹èƒå–ï¼štemplateç¼–ç¨‹çš„ç²¾åä¹‹ä¸€ï¼Œå‚è€ƒ Rule47:ä½¿ç”¨traitè¡¨ç°ç±»å‹ä¿¡æ¯ï¼Œå¤´æ–‡ä»¶ä¸º \u003ctype_traits\u003eï¼ŒåŠŸèƒ½ååˆ†ä¸°å¯Œï¼Œå¯å‚è€ƒcppreference: type_traitsï¼› tr1::result_of ï¼šå¯ä»¥å¯¹å‡½æ•°è¿”å›å€¼åšæ¨æ–­ï¼Œå¾—åˆ°è¿”å›å€¼ç±»å‹ï¼Œå¤´æ–‡ä»¶ä¸º \u003ctype_traits\u003e ï¼Œç¤ºä¾‹ç”¨æ³•å¦‚ä¸‹ï¼š c++ // å‡è®¾æœ‰ä¸ªå‡½æ•° double calcDaySale(int); std::tr1::result_of\u003ccalcDaySale(int)\u003e::type x = 3.14;//xå°±æ˜¯doubleç±»å‹. C++11ä¸­ç›´æ¥ std::result_of æ›´è¯¦ç»†çš„å®šç‰ˆTR1ä¿¡æ¯å¯ä»¥å‚è€ƒEffective-C++ï¼šTR1 informationã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:3:2","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":"R55 è®©è‡ªå·±ç†Ÿæ‚‰Boost Boostæ˜¯ä¸€ä¸ªC++å¼€å‘è€…é›†ç»“çš„ç¤¾ç¾¤ï¼Œä¹Ÿæ˜¯ä¸ªå¯è‡ªç”±ä¸‹è½½çš„ç¨‹åºåº“é›†ï¼Œç½‘å€æ˜¯ http://boost.orgã€‚ å…¶ç‰¹æ®Šæ€§ï¼šå’ŒC++æ ‡å‡†å§”å‘˜ä¼šæœ‰ç€ç‹¬ä¸€æ— äºŒçš„å¯†åˆ‡å…³ç³»ï¼Œä¸”å…·æœ‰å¾ˆæ·±å½±å“åŠ›ï¼›æ¥çº³ç¨‹åºåº“éå¸¸ä¸¥è°¨ï¼Œéœ€è¦ä¸€æ¬¡ä»¥ä¸Šçš„åŒè¡Œä¸“å®¶è¯„å®¡ã€‚ Boost ç¨‹åºåº“é›†å¯å¤„ç†çš„åœºæ™¯æœ‰è®¸å¤šï¼ˆä¸”å›Šæ‹¬äº†TR1çš„å®ç°ï¼‰ï¼Œå¯åŒºåˆ†å‡ºæ•°åä¸ªç±»åˆ«ï¼Œå¹¶ä¸”è¿˜åœ¨æŒç»­å¢åŠ ï¼Œåˆ—ä¸¾ä¸€å°éƒ¨åˆ†å¦‚ä¸‹ï¼š å­—ç¬¦ä¸²ä¸æ–‡æœ¬å¤„ç† å®¹å™¨ å‡½æ•°å¯¹è±¡ä¸é«˜çº§ç¼–ç¨‹ æ³›å‹ç¼–ç¨‹ï¼šè¦†ç›–ä¸€å¤§ç»„ traits classes æ¨¡æ¿å…ƒç¼–ç¨‹ï¼šè¦†ç›–ä¸€ä¸ªé’ˆå¯¹ç¼–è¯‘å™¨ assertions è€Œå†™çš„ç¨‹åºåº“ï¼Œä»¥åŠ Boost MPLç¨‹åºåº“ æ•°å­¦å’Œæ•°å€¼:åŒ…æ‹¬æœ‰ç†æ•°ã€å…«å…ƒæ•°ã€å››å…ƒæ•°ã€å…¬çº¦æ•°ã€å¤šé‡è¿ç®—ã€éšæœºæ•°ç­‰ç­‰ æ­£ç¡®æ€§ä¸æµ‹è¯•æ€§ æ•°æ®ç»“æ„ è¯­è¨€é—´çš„æ”¯æŒï¼šå…è®¸ C++ å’Œ Python ä¹‹é—´çš„æ— ç¼äº’è” å†…å­˜ï¼šè¦†ç›–Poolç¨‹åºåº“å’Œæ™ºèƒ½æŒ‡é’ˆç­‰ æ‚é¡¹ï¼šåŒ…æ‹¬ CRC æ ¡éªŒã€æ—¥æœŸå’Œæ—¶é—´çš„å¤„ç†ã€æ–‡ä»¶ç³»ç»Ÿç­‰å†…å®¹ æ€»çš„æ¥è¯´ï¼ŒBoost æ˜¯ä¸€ä¸ªç¤¾ç¾¤ï¼Œä¹Ÿæ˜¯ä¸ªç½‘ç«™ã€‚è‡´åŠ›äºå…è´¹ã€æºç å¼€æ”¾ã€åŒè¡Œå¤å®¡çš„ C++ ç¨‹åºåº“å¼€å‘ï¼Œéå¸¸å€¼å¾—ç»å¸¸è®¿é—®ä¸å­¦ä¹ ã€‚ ref: [1]. https://blog.csdn.net/cltcj/category_12098441.html [2]. https://kissingfire123.github.io/2022/05/17_effective-c-%e4%b9%8b%e9%98%85%e8%af%bb%e6%80%bb%e7%bb%93%e5%9b%9b/ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_four/:3:3","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]","uri":"/posts/effective_cpp_part_four/"},{"categories":["C++"],"content":" å‰è¨€ Effective-C++æ€»ç»“ç³»åˆ—åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬äºŒéƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬3~4ç« ï¼Œå†…å®¹èŒƒå›´Rule13~25ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule13ç®€å†™ä¸ºR13ã€‚ Effective-C++ç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››) ç”±äºåŸä¹¦åœ¨C++11ä¹‹å‰å†™æˆï¼Œæœ‰äº›ç°ä»£C++ç‰¹æ€§ä¸ä¼šæåŠï¼Œæ‰€ä»¥ä¼šæ ¹æ®æœ¬äººå¼€å‘ç»éªŒæ–°å¢ä¸€äº›ä¸ªäººæ„Ÿæ‚ŸğŸ‘‰By the wayç¯èŠ‚ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:0:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"CH5. å®ç° ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:1:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R26 å°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´ å°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°ï¼Œå¯å¢åŠ ç¨‹åºæ¸…æ™°åº¦å’Œæ•ˆç‡ å®šä¹‰åï¼Œåœ¨ä½¿ç”¨å‰å°±é­é‡æŠ›å¼‚å¸¸ è¿™ç§æƒ…å†µï¼Œå¦‚æœæ˜¯å®šä¹‰äº†å¯¹è±¡ObjectA aï¼Œä¾¿ç™½ç™½åœ°æµªè´¹äº†å¯¹è±¡açš„æ„é€ å’Œææ„æˆæœ¬ã€‚ ä¸åªæ˜¯å»¶åå˜é‡å®šä¹‰åˆ°ä½¿ç”¨æ—¶ï¼Œè€Œæ˜¯å°½é‡å»¶ååˆ°èƒ½ç»™å®ƒåˆå€¼æ—¶ std::string encryptPassword(const std::string\u0026 password){ if(password.length() \u003c 8){ throw std::logic_error(\"Password is too short\"); }// è€ƒè™‘1ï¼šåœ¨å¼‚å¸¸ä¹‹åå®šä¹‰å˜é‡ std::string encrypted(password);//è€ƒè™‘2ï¼šå®šä¹‰å»¶åè‡³å˜é‡èƒ½èµ‹åˆå€¼çš„æ—¶æœº encrypt(encrypted); return encrypted; } æ€è€ƒå˜é‡å®šä¹‰æ˜¯å¦è¯¥åœ¨å¾ªç¯å†… æ–¹æ³•Aï¼šå®šä¹‰äºå¾ªç¯å¤– Widget w; for(int i = 0 ; i\u003c n; ++i) { w = foo(i); // other... } æ–¹æ³•Bï¼šå®šä¹‰äºå¾ªç¯å†… for (int i = 0; i \u003c n; ++i) { Widget w(foo(i)); // other... } ç©¶ç«Ÿæ˜¯Aè¿˜æ˜¯Bæ–¹æ³•å¥½ï¼Œå–å†³äº ä¸€ä¸ªèµ‹å€¼æˆæœ¬å’Œä¸€ç»„æ„é€ +ææ„æˆæœ¬ï¼Œè¿™2è€…ä¹‹é—´ï¼Œå¦‚æœæ˜¯èµ‹å€¼æˆæœ¬ä½ï¼Œé‚£ä¹ˆAæ›´å¥½ï¼Œå¦åˆ™Bæ›´å¥½ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:1:1","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R27 å°½é‡å°‘åšè½¬å‹åŠ¨ä½œ é€šå¸¸çš„è½¬å‹æ˜¯å¯èƒ½ä¼šè¿™æ ·å†™ï¼šå‡½æ•°é£æ ¼çš„int(expression)æˆ–è€…Cé£æ ¼çš„(int)expressionï¼Œè¿™éƒ½è¢«æˆä¸ºâ€œæ—§å¼è½¬å‹â€ã€‚ åœ¨C++ä¸­ï¼Œæœ‰4ç§æ–°å¼è½¬å‹æ“ä½œç¬¦ï¼š const_cast (expression) ä½œç”¨æ˜¯ç§»é™¤å˜é‡çš„å¸¸é‡æ€§(cast away the constness)ï¼Œæ˜¯å”¯ä¸€æœ‰æ­¤èƒ½åŠ›çš„æ“ä½œç¬¦ã€‚ dynamic_cast(expression) ä½œç”¨æ˜¯â€œå®‰å…¨å‘ä¸‹è½¬å‹â€(safe downcasting)ï¼Œå†³å®šæŸä¸ªå¯¹è±¡æ˜¯å¦å±äºæŸç»§æ‰¿ä½“ç³»ã€‚è€—è´¹é‡å¤§è¿è¡Œæˆæœ¬ï¼ˆåŸå› ï¼šéœ€è¦æŸ¥è¯¢RTTIä¿¡æ¯ï¼Œè€Œä¸”ä¸åŒç¼–è¯‘å™¨å®ç°çš„æ–¹æ³•å’Œæ•ˆç‡æœ‰æ‰€ä¸åŒï¼‰ã€‚ reinterpret_cast(expression) æ‰§è¡Œä½çº§è½¬å‹ï¼Œå®é™…ç»“æœå–å†³äºç¼–è¯‘å™¨ï¼Œç§»æ¤æ€§å·®ã€‚ï¼ˆæ¯”å¦‚int* è½¬ä¸ºintï¼‰è¦æ¸…æ¥šè‡ªå·±åœ¨åšä»€ä¹ˆï¼Œæ…ç”¨ã€‚ static_cast(expression) å¼ºè¿«éšå¼ç±»å‹è½¬æ¢ï¼Œä»£æ›¿Cé£æ ¼çš„\"æ—§å¼è½¬æ¢\"ã€‚ä¹Ÿå¯ä»¥ç»™å˜é‡åŠ ä¸Šconstç‰¹æ€§ã€‚ æ–°å¼è½¬æ¢çš„å¥½å¤„ï¼šå¾ˆå®¹æ˜“åœ¨ä»£ç æ‰¾åˆ°â€œç±»å‹ç³»ç»Ÿåœ¨ä½•å¤„è½¬å˜æˆ–ç ´åâ€ï¼›å¯¹constç‰¹æ€§çš„ä¸¥æ§ï¼Œè®©ç±»å‹ç³»ç»Ÿæ›´å¥å£®ã€‚ æ´¾ç”Ÿç±»é‡Œç›´æ¥è°ƒç”¨åŸºç±»æˆå‘˜å‡½æ•°æ—¶ï¼Œä¸è¦ç”¨è½¬å‹ class SpecialWindow:public Window{ public: virtual void onResize(){ Window::onResize();//ä¸è¦ä½¿ç”¨ static_cast\u003cWindow\u003e(*this).onResize(); } }; å…³äºdynamic_castéœ€è¦æ³¨æ„çš„ å¦‚ä½•æ›¿ä»£å’Œé¿å… ä¸€èˆ¬æ˜¯æŒæœ‰ä¸€ä¸ªBase *pBaseï¼Œä½†æ˜¯æŒ‡å‘çš„æ˜¯DerivedObjï¼Œäºæ˜¯è½¬å‹ä¸ºpDerived å¯ä»¥è¿™æ ·ä¿®æ”¹ï¼š ä¿®æ”¹è®¾è®¡ï¼Œçª„åŒ–ç±»å‹ï¼ŒæŒæœ‰ä¸€ä¸ªpDerivedå³å¯ï¼›æˆ–è€…å°†æƒ³åšçš„äº‹æ”¾åˆ°è™šå‡½æ•°ä¸­ï¼Œåˆ©ç”¨å¤šæ€å»å®Œæˆã€‚ é¿å…ä¸²è” é¿å…ä¸‹æ–¹è¿™æ ·çš„ä»£ç ï¼Œä¸€è¿ä¸²çš„dynamic_castï¼š class Window{ ... }; // å®šä¹‰å­ç±» SpecialWindow1,SpecalWindow2,SpecialWindow3 Window* winPtr; // çœç•¥winPtrçš„å…¶ä»–æ“ä½œ ... if(SpecialWindow1 *psw1 = dynamic_cast\u003cSpecialWindow1*\u003e(winPtr)){ ... } else if(SpecialWindow2 *psw2 = dynamic_cast\u003cSpecialWindow2*\u003e(winPtr)){ ... } else if(SpecialWindow3 *psw3 = dynamic_cast\u003cSpecialWindow3*\u003e(winPtr)){ ... } è¿™æ ·çš„ä»£ç åˆå¤§åˆæ…¢ï¼Œæ¯æ¬¡ç»§æ‰¿ä½“ç³»æœ‰æ‰€æ”¹å˜ï¼Œä»£ç å°±éœ€è¦é‡æ–°æ£€é˜…åˆ¤æ–­ã€‚è¿™æ ·çš„ä»£ç åº”è¯¥ç”¨â€œåŸºäºvirtualå‡½æ•°è°ƒç”¨â€å–ä»£å®ƒã€‚ By the way è‡ª C++11 èµ·ï¼Œé’ˆå¯¹æ™ºèƒ½æŒ‡é’ˆ shared_ptr çš„è½¬å‹ï¼Œæ¨å‡ºäº†å¦å¤– 4 ä¸ªæ¨¡ç‰ˆå‡½æ•°ï¼š std::static_pointer_cast å‡½æ•°çš„åŸå‹å£°æ˜ä¸ºï¼š template\u003c class T, class U \u003e std::shared_ptr\u003cT\u003e static_pointer_cast( const std::shared_ptr\u003cU\u003e\u0026 r ) noexcept; å«ä¹‰ä»¥åŠåº”ç”¨åœºæ™¯ä¸ static_cast ç±»ä¼¼ï¼Œæ¯”å¦‚å­ç±»å‹æŒ‡é’ˆè½¬ä¸ºçˆ¶ç±»å‹ï¼š auto basePtr = std::make_shared\u003cBase\u003e(); auto derivedPtr = std::make_shared\u003cDerived\u003e(); basePtr = std::static_pointer_cast\u003cBase\u003e(derivedPtr); æˆ–è®¸æˆ‘ä»¬ä¼šæœ‰ç–‘é—®ï¼Œæ˜¯å¦æœ‰å¿…è¦ç”¨è¿™ä¸ªå‡½æ•°è¿›è¡Œè½¬å‹å‘¢ï¼Œå¦‚ä¸‹å®ç°ä¸æ˜¯ä¸€æ ·çš„å—? basePtr = std::shared_ptr\u003cBase\u003e(static_cast\u003cBase*\u003e(derivedPtr.get())); ğŸ¤” å½“ç„¶ä¸ä¸€æ ·ï¼Œstatic_cast\u003cT*\u003e((U*)nullptr)æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œè€Œä¸”å°±è¯­æ³•æè¿°ä¸Šæ¥çœ‹ï¼Œå“ªä¸ªæ›´ç®€æ´ä¸è¨€è‡ªæ˜ã€‚ å¦å¤–ï¼Œè‡ª C++20 èµ·æ”¯æŒå³å€¼å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯å¦‚ä¸‹å½¢å¼ï¼š template\u003c class T, class U \u003e std::shared_ptr\u003cT\u003e static_pointer_cast( std::shared_ptr\u003cU\u003e\u0026\u0026 r ) noexcept; std::dynamic_pointer_cast å«ä¹‰ä»¥åŠåº”ç”¨åœºæ™¯ä¸ dynamic_cast ç±»ä¼¼ï¼Œç”¨æ³•ä¼ å‚ä¸ std::static_pointer_cast ç±»ä¼¼ï¼Œä¸”è‡ª C++20 èµ·æ”¯æŒå³å€¼å¼•ç”¨ï¼Œä¸èµ˜è¿°ã€‚ std::const_pointer_castï¼šä¸å‰ 2 è€…ç±»ä¼¼ï¼Œä¸èµ˜è¿°ã€‚ std::reinterpret_pointer_castï¼šä¸å‰ 3 è€…ç±»ä¼¼ï¼Œä¸èµ˜è¿°ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:1:2","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R28 é¿å…è¿”å›handlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ† è¿™é‡Œçš„handlesï¼ˆå·ç ç‰Œï¼‰åŒ…æ‹¬æŒ‡å‘å¯¹è±¡å†…éƒ¨çš„æŒ‡é’ˆã€è¿­ä»£å™¨ã€å¼•ç”¨ã€‚ ä»¥ä¸‹è®²è¿°å½“è¿”å›å¯¹è±¡å†…éƒ¨çš„handlesæ—¶ï¼Œå­˜åœ¨çš„2ä¸ªé—®é¢˜ï¼š å¯èƒ½ä¼šç ´åå°è£…æ€§ è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼špublicå‡½æ•°è¿”å›ä¸€ä¸ªprivateæˆå‘˜çš„éconstå¼•ç”¨ï¼Œå°±è®©å¤–ç•Œæœ‰äº†ä¿®æ”¹privateçš„æœºä¼šï¼Œç ´åäº†å°è£…æ€§ã€‚ æ­¤æ—¶ï¼Œéœ€è¦å°†éconstå¼•ç”¨æ”¹ä¸ºconstå¼•ç”¨ï¼Œåªè¯»å±æ€§ã€‚ struct Pixel { float r,g,b; } class Image { public: //æ³¨æ„ï¼šåé¢è¿™conståªä¿è¯æˆå‘˜å˜é‡vPixPtrs_ä¸æ”¹ Pixel\u0026 GetThePixel(int idx) const{ return vPixPtrs_[i];}//éšæ‚£ï¼šå…¶å®å¤–éƒ¨è°ƒç”¨è€…ä»èƒ½ç›´æ¥ä¿®æ”¹Pixelçš„rgbå€¼ // ä¸Šä¸€å¥çš„è¿”å›å€¼åº”è¯¥æ”¹ä¸º \"const Pixel\u0026\" private: std::vector\u003cstd::shared_ptr\u003cPixel\u003e\u003e vPixPtrs_; } å¯èƒ½ä¼šå¼•èµ·â€œç©ºæ‚¬handlesâ€ å³ä½¿ç”¨constè§£å†³äº†å°è£…æ€§çš„é—®é¢˜ï¼Œå› ä¸ºå¾ˆå®¹æ˜“å‡ºç°**â€œhandlesæ¯”å…¶æ‰€æŒ‡å¯¹è±¡æ›´é•¿å¯¿â€**ï¼Œå¯èƒ½å­˜åœ¨å¯¹è±¡å·²ææ„ï¼Œä½†handlesè¿˜ç•™å­˜çš„é—®é¢˜ã€‚å°¤å…¶æ˜¯ä¸´æ—¶å˜é‡çš„ææ„ï¼Œä¸å¤ªå®¹æ˜“å¯Ÿè§‰ã€‚ class SceneGraph{ ... }; const Image CaptureImage(const SceneGraph\u0026 graph); //é‚£ä¹ˆè°ƒç”¨æ–¹å¯èƒ½ä¼šè¿™æ ·ä½¿ç”¨ SceneGraph Grap; //ä¸‹é¢è¿™å¥ä¹‹åï¼ŒImageä¸´æ—¶å¯¹è±¡è¢«é”€æ¯ï¼ŒpPixæŒ‡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„å¯¹è±¡ const Pixel *pPix = \u0026(CaptureImage(Grap).GetThePixel(0)); æ³¨æ„ï¼ŒCaptureImageçš„ç¡®èƒ½è¿”å›ä¸€ä¸ªä¸´æ—¶Imageå¯¹è±¡ï¼Œèƒ½æˆåŠŸè°ƒç”¨GetThePixelï¼Œä½†è¿™å¥ç»“æŸåï¼Œä¸´æ—¶å¯¹è±¡ç«‹é©¬ä¼šè¢«é”€æ¯ï¼Œé€ æˆç©ºæ‚¬ç°è±¡ï¼Œæˆ–å«è™šåŠ(dangling) ï¼ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:1:3","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R29 ä¸ºâ€œå¼‚å¸¸å®‰å…¨â€è€ŒåŠªåŠ›æ˜¯å€¼å¾—çš„ â€œå¼‚å¸¸å®‰å…¨â€æ˜¯æŒ‡ï¼Œå½“å¼‚å¸¸æŠ›å‡ºæ—¶ï¼Œä»£ç ä¾ç„¶èƒ½åšåˆ°å¦‚ä¸‹2ç‚¹ï¼š ä¸æ³„éœ²ä»»ä½•èµ„æº åŒ…æ‹¬å†…å­˜èµ„æºï¼Œé”èµ„æºã€‚ ä¸å…è®¸æ•°æ®è´¥å ä¸ä¼šå› ä¸ºå¼‚å¸¸è€Œå¯¼è‡´ç©ºæ‚¬æŒ‡é’ˆç­‰æœªå®šä¹‰è¡Œä¸ºã€‚ è€ƒè™‘ä¸‹æ–¹çš„ç¤ºä¾‹ä»£ç ï¼Œï¼ˆå¦‚æœnew ImageæŠ›std::bad_allocå¼‚å¸¸ï¼‰åˆ™ä¼šåŒæ—¶è¿èƒŒäº†ä¸Šè¿°2æ¡ï¼š class PrettyMenu{ private: Mutex mutex_; //äº’æ–¥å™¨ Image* bgImage_ = nullptr; int imageChangeCnt_ = 0; public: void PrettyMenu::changeBackground(std::ifstream\u0026 imgSrc){ lock(\u0026mutex_);// è¿™ä¸ªå¯ä»¥æ”¹ä¸ºRAIIçš„é”ï¼Œæ¥ä¿è¯å¼‚å¸¸å®‰å…¨ delete bgImage_; ++imageChangeCnt_; //è¿™é‡Œnew ImageæŠ›å¼‚å¸¸ï¼Œå¯¼è‡´æ— æ³•è§£é”ï¼›ä¸”bgImage_æŒ‡å‘èµ„æºå·²ç»é‡Šæ”¾ï¼Œç©ºæ‚¬æŒ‡é’ˆ bgImage_ = new Image(imageSrc_); unlock(\u0026mutex_); } }; å¼‚å¸¸å®‰å…¨çš„3ä¸ªç­‰çº§ å¼‚å¸¸å®‰å…¨çš„å‡½æ•°ï¼Œæœ‰3ä¸ªç­‰çº§çš„å¼‚å¸¸å®‰å…¨ä¿è¯ï¼Œä¼šæ»¡è¶³ä¸‰è€…ä¹‹ä¸€ï¼š åŸºæœ¬æ‰¿è¯º å¦‚æœå¼‚å¸¸è¢«æŠ›å‡ºï¼Œç¨‹åºå†…çš„ä»»ä½•äº‹åŠ¡ä»ç„¶ä¿æŒåœ¨æœ‰æ•ˆçŠ¶æ€ä¸‹ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ•°æ®è´¥åã€‚æ¯”å¦‚ä¸Šä¾‹ä¸­å¦‚æœæŠ›å¼‚å¸¸ï¼Œä¼šå¦å¤–æ·»åŠ å®ç°ï¼Œä½¿bgImage_æŒæœ‰æŸä¸ªé»˜è®¤å›¾åƒï¼Œæˆ–ä¿æŒåŸå€¼ï¼Œè®©ç¨‹åºç»§ç»­æœ‰æ•ˆè¿è¡Œã€‚ å¼ºçƒˆä¿è¯ å¦‚æœå¼‚å¸¸è¢«æŠ›å‡ºï¼Œç¨‹åºçŠ¶æ€ä¸æ”¹å˜ã€‚è¿™æ ·çš„å‡½æ•°è¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆé€€å›åˆ°æ‰§è¡Œå‰çš„çŠ¶æ€ã€‚ ä¸Šè¿°æ¡ˆä¾‹åˆ™åº”è¯¥ä¼šè¢«ä¿®æ”¹æˆå¦‚ä¸‹å½¢å¼ï¼š class PrettyMenu{ private: std::shared_ptr\u003cImage\u003e bgImage_; //RAIIé¿å…äº†å¼‚å¸¸å‘ç”Ÿæ—¶çš„èµ„æºæ³„æ¼å’Œæ•°æ®è´¥å //... çœç•¥å…¶ä»–æˆå‘˜ public: void PrettyMenu::changeBackground(std::ifstream\u0026 imgSrc){ CLock ml(\u0026mutex_);//RAIIå°è£…çš„Lockç±»ï¼Œè¯¦ç»†å¯å‚è€ƒ é˜…è¯»æ€»ç»“(äºŒ)-Rule14 bgImage_.reset(new Image(imgSrc));//è‹¥newå¤±è´¥ï¼Œåˆ™ä¸ä¼šreset ++imageChangeCnt_;//æŠŠäº‹æƒ…åšå®Œå†++count } }; ä¸æŠ›å¼‚å¸¸ åœ¨åŸä¹¦ä¸­ï¼Œè¿™ä¸ªâ€œNo Throwâ€ä¸æ˜¯ç»å¯¹ä¸æŠ›å¼‚å¸¸ï¼Œè€Œæ˜¯ä¸€æ—¦æ„å¤–æŠ›å¼‚å¸¸ï¼Œå°±ä¼šè°ƒç”¨unexpectedå‡½æ•°è¿›è€Œabortï¼ˆä¾‹å¦‚int doSomething() throw();//ç©ºç™½çš„å¼‚å¸¸æ˜ç»†ï¼‰ã€‚ By the way åŸä¹¦ä¸­ä¾‹å­çš„ throw() åœ¨ä¸åŒç¼–è¯‘å™¨è¡¨ç°ä¸ä¸€è‡´ï¼Œç°åœ¨å·²ç» ä¸æ¨èä½¿ç”¨ã€‚ æ›´è¯¦ç»†èµ„æ–™å¯å‚è€ƒA Pragmatic Look at Exception Specificationså’ŒShould I use an exception specifier in C++ åœ¨C++11ä¸­ï¼Œæœ‰äº†æ›´å¯é æœ‰æ•ˆçš„å…³é”®å­—noexceptï¼Œä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œæœ‰æ“ä½œç¬¦å’Œå¼‚å¸¸æç¤ºç¬¦ä¸¤ç§ä½œç”¨ï¼Œä¸‹æ–¹å±•ç¤ºç®€å•ç”¨æ³•ï¼š void f() noexcept; // å‡½æ•° f() ä¸ä¼šæŠ›å‡º void (*fp)() noexcept(false); // fp æŒ‡å‘å¯èƒ½ä¼šæŠ›å‡ºçš„å‡½æ•° void g(void pfa() noexcept); // g æ¥æ”¶æŒ‡å‘ä¸ä¼šæŠ›å‡ºçš„å‡½æ•°çš„æŒ‡é’ˆ // typedef int (*pf)() noexcept; // é”™è¯¯ æ›´è¯¦ç»†çš„noexceptä»‹ç»å¯ä»¥è®¿é—®cppreferenceï¼šnoexceptæ“ä½œç¬¦å’Œcppreferenceï¼šnoexceptå¼‚å¸¸è¯´æ˜ç¬¦ ä½¿ç”¨copy-and-swapä¿éšœå¼‚å¸¸å®‰å…¨ copy-and-swapæŠ€æœ¯ï¼šå…ˆæ‹·è´ä¸€ä»½æƒ³ä¿®æ”¹çš„å¯¹è±¡ï¼Œç­‰ä¿®æ”¹å½»åº•å®Œæˆåï¼ˆè¿‡ç¨‹ä¸­ä¸æŠ›å¼‚å¸¸ï¼‰ï¼Œå†ä¸åŸå¯¹è±¡äº¤æ¢ã€‚ ä¸ºäº†æ›´å½¢è±¡å±•ç¤ºè¿™ä¸€è¿‡ç¨‹ï¼Œä½¿ç”¨pImlæ‰‹æ³•å¯¹bgImage_å°è£…ä¸€ä¸‹ï¼š struct ImgPimpl{ //é€‰ç”¨structè€ŒéClassï¼šæ–¹ä¾¿ï¼›æœ€åè¢«privateæˆå‘˜å½¢å¼ä½¿ç”¨ï¼Œå°è£…æ€§ä¸ç”¨æ‹…å¿ƒ std::shared_ptr\u003cImage\u003e bgImage_; int imageChangeCnt_ = 0; }; é‚£ä¹ˆPrettyMenuç±»å¯ä»¥æ”¹ä¸ºå¦‚ä¸‹ï¼š class PrettyMenu{ private: Mutex mutex_; std::shared_ptr\u003cImgPimpl\u003e pImpl_; public: //æ„é€ ç•¥ void PrettyMenu::changeBackground(std::ifstream\u0026 imgSrc){ using std::swap; //å‚è€ƒ é˜…è¯»æ€»ç»“(äºŒ)-Rule25 CLock ml(\u0026mutex_);//RAIIå°è£…çš„Lockç±»ï¼Œè¯¦ç»†å¯å‚è€ƒæ€»ç»“(äºŒ)-Rule14 std::shared_ptr\u003cImgPimpl\u003e pNewCopy(new ImgPimpl(*pImpl_)); pNewCopy-\u003ebgImage_.reset(new Image(imgSrc)); //ä¿®æ”¹å‰¯æœ¬ ++pNewCopy-\u003eimageChangeCnt_; swap(pImpl_,pNewCopy);//æ”¹å®Œä¹‹åswap } }; å¼‚å¸¸å®‰å…¨çš„è¿å¸¦å½±å“(side effects) å‡½æ•°æä¾›çš„â€œå¼‚å¸¸å®‰å…¨ä¿è¯ç­‰çº§â€åªå–å†³äºå…¶è°ƒç”¨çš„å„ä¸ªå­å‡½æ•°çš„â€œæœ€ä¸å®‰å…¨è€…â€ã€‚ è€ƒè™‘ä»¥ä¸‹å‡½æ•°SomeFuncä»£ç ï¼š void SomeFunc{ ... // å¯¹localçŠ¶æ€åšä¸€ä»½å‰¯æœ¬ f1(); f2(); ... //å°†ä¿®æ”¹åçš„çŠ¶æ€ç½®æ¢è¿‡æ¥ } åˆ†æï¼šæ˜¾ç„¶copy-and-swapåœ¨å°½åŠ›å¼ºçƒˆä¿è¯å¼‚å¸¸å®‰å…¨ï¼Œä½†æ˜¯ï¼Œf1æˆ–è€…f2çš„å¼‚å¸¸å®‰å…¨å¦‚æœæ¯”è¾ƒä½ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦å•ç‹¬å¯¹f1ï¼Œf2è¿›è¡Œcopy-and-swapï¼Œæ¥å°è¯•ä¿è¯â€œå¼ºçƒˆå¼‚å¸¸å®‰å…¨â€ï¼›å³ä½¿å¦‚æ­¤ï¼Œå¦‚æœf1èƒ½æˆåŠŸåšäº†ä¿®æ”¹ï¼Œä½†æ˜¯f2ä¿®æ”¹å¤±è´¥äº†å¹¶å›é€€ï¼Œé‚£ä¹ˆf1ã€f2æ•´ä½“çœ‹èµ·æ¥è¿˜æ˜¯â€œæ”¹äº†ä¸€éƒ¨åˆ†â€ã€‚ è¿™ä¹Ÿå‘Šè¯«æˆ‘ä»¬ï¼Œå¦‚æœå¼•å…¥äº†å¼‚å¸¸ä¸å®‰å…¨çš„æ—§ä»£ç ï¼Œé‚£ä¹ˆè¿™ç§ç‰¹æ€§ä¼šæ³¢åŠå…¶ä»–ä»£ç ã€‚ å°±è®¾è®¡è€…è€Œè¨€ï¼Œåªèƒ½æ ¹æ®å®é™…æƒ…å†µï¼Œå°½å¯èƒ½ä¿è¯â€œå¼‚å¸¸å®‰å…¨â€ï¼Œé€‰æ‹©3ä¸ªå¼‚å¸¸å®‰å…¨ç­‰çº§ä¹‹ä¸€å®æ–½ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:1:4","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R30 é€å½»äº†è§£inlineçš„é‡Œé‡Œå¤–å¤– inlineæ˜¯C++çš„å…³é”®å­—ï¼Œè¡¨ç¤ºå†…è”å‡½æ•°ã€‚ç›´æ¥åœ¨å¯¹åº”ä½ç½®å±•å¼€ä»£ç ï¼Œå…å»å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼Œéš¾ä»¥é¿å… â€œä»£ç è†¨èƒ€â€é—®é¢˜ã€‚ ä½¿ç”¨inlineæ—¶åº”è¯¥æ³¨æ„ä»¥ä¸‹é—®é¢˜ï¼š inlineåªæ˜¯å¯¹ç¼–è¯‘å™¨çš„ç”³è¯· inlineåªæ˜¯å¯¹ç¼–è¯‘å™¨çš„ç”³è¯·/å»ºè®®ï¼Œä¸æ˜¯å¼ºåˆ¶å‘½ä»¤ï¼Œç¼–è¯‘å™¨æœ‰æƒåˆ© å¯¹å…¶è®¤ä¸ºä¸é€‚åˆinlineçš„å‡½æ•°æ‹’ç»inlineã€‚ ï¼ˆåŸä¹¦è¯´ï¼šå¦‚æœç¼–è¯‘å™¨æ‹’ç»ï¼Œé€šå¸¸å®ƒä¼šç»™å‡ºwarningä¿¡æ¯ã€‚å®é™…æœ¬äººå®æµ‹VS2017æ²¡çœ‹åˆ°ï¼‰ inlineæœ‰2ç§ç”³è¯·æ–¹å¼ ï¼š åœ¨å‡½æ•°å®šä¹‰ æ—¶ä½¿ç”¨å…³é”®å­—inlineæ˜¾å¼å¼ºè°ƒ å®ç°åœ¨Classå†…çš„æˆå‘˜å‡½æ•°æˆ–friendå‡½æ•°ï¼Œå±äºéšå¼inline inlineå’ŒTemplateæ²¡æœ‰ä»»ä½•å¿…ç„¶è”ç³» è™½ç„¶æœ‰ä¸å°‘ç®€çŸ­çš„Templateå‡½æ•°æ˜¯å¸¦æœ‰inlineï¼ˆä¾‹å¦‚ä¸‹æ–¹çš„std::maxï¼‰ï¼Œä½†ä¸æ˜¯å¿…ç„¶ä¸ºä¹‹ï¼Œä¸¤è€…æ²¡æœ‰å› æœå…³ç³»ã€‚ template\u003ctypename T\u003e inline const T\u0026 std::max(const T\u0026 a, const T\u0026 b){ //å¯ä»¥ç”³è¯·inlineï¼Œä½†ä¸æ˜¯å¿…é¡»ç”³è¯· return a \u003c b ? b : a; } ç¼–è¯‘å™¨æ‹’ç»å¤æ‚å‡½æ•°è¿›è¡Œinline å¤æ‚å‡½æ•°çš„inlineä¼šå¸¦æ¥è¾ƒä¸¥é‡çš„â€œä»£ç è†¨èƒ€â€é—®é¢˜ï¼Œå¹¶ä¸”å¯èƒ½ä¼šæ›´æ…¢ï¼Œå› ä¸ºå¢åŠ äº†è¿è¡Œæ—¶çš„â€œé¢å¤–æ¢é¡µâ€è¡Œä¸ºï¼Œé™ä½äº†æŒ‡ä»¤cacheå‘½ä¸­ç‡ã€‚ inlineå‡½æ•°å†…ä¸è¦å‡ºç°å¾ªç¯æˆ–é€’å½’ è™šå‡½æ•°ä¹Ÿä¸é€‚åˆåšinline å› ä¸ºinlineæ˜¯ç¼–è¯‘æœŸé—´å†³å®šçš„äº‹ï¼Œè€Œè™šå‡½æ•°æ˜¯è¿è¡Œæ—¶å†³å®šçš„äº‹ï¼Œä¸¤è€…å°±ä¸æ˜¯åŒä¸€ä¸ªåœºæ™¯çš„ã€‚ æ„é€ /ææ„å‡½æ•°ä¹Ÿä¸é€‚åˆåšinline ç¼–è¯‘å™¨å¯èƒ½ä¼šåœ¨æ„é€ /ææ„å‡½æ•°å†…éƒ¨åšç²¾å¦™å¤æ‚çš„å¼‚å¸¸å¤„ç†ï¼›ä»¥åŠåœ¨ç»§æ‰¿ä½“ç³»ä¸‹ï¼ŒBaseç±»å‡½æ•°ä½“åˆ°å¤„inlineè†¨èƒ€ã€‚ ä»¥å‡½æ•°æŒ‡é’ˆå½¢å¼çš„è°ƒç”¨é€šå¸¸ä¸èƒ½inline å¯¹ç»å¤§å¤šæ•°ç¼–è¯‘å™¨è€Œè¨€ï¼Œæ˜¯å¦inlineæ˜¯compileé˜¶æ®µå†³å®šçš„äº‹æƒ…ï¼Œå°‘æ•°ç¼–è¯‘å™¨æ”¾åˆ°äº†linké˜¶æ®µã€‚ è®¨è®ºå¤§å¤šæ•°æƒ…å†µï¼šéœ€è¦åœ¨ç¼–è¯‘æ—¶å¾—çŸ¥inlineçš„æœ¬ä½“ï¼Œè€Œå‡½æ•°æŒ‡é’ˆåŠä¸åˆ°ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š inline void f() {...} //å‡è®¾ç¼–è¯‘å™¨æœ‰æ„æ„¿inline â€œå¯¹fçš„è°ƒç”¨â€ void (* pf)() = f;//pf æ‰§è¡Œf ... f(); //è¿™ä¸ªè°ƒç”¨å°†è¢«inlinedï¼Œå› ä¸ºæ˜¯ä¸ªæ­£å¸¸è°ƒç”¨ pf(); //è¿™ä¸ªå¾ˆå¯èƒ½ä¸è¢«inlined è¿‡åº¦inlineå¯¹è°ƒè¯•å’Œå‘å¸ƒå¸¦æ¥å›°éš¾ inlineæ˜¯ä»£ç åµŒå…¥ä¸å±•å¼€ï¼Œè€Œéå‡½æ•°è°ƒç”¨ï¼Œæ‰€ä»¥æŸäº›ç¼–è¯‘å™¨ä¸æ”¯æŒinlineçš„å•æ­¥Debugï¼ˆå°±åƒå®å±•å¼€ä¸€æ ·ä¸æ”¯æŒè°ƒè¯•ï¼‰ï¼›å¦å¤–ï¼Œinlineåªè¦å·²ä¿®æ”¹ï¼Œæ¶‰åŠè°ƒç”¨å®ƒçš„ä»£ç å…¨éƒ½è¦ç¼–è¯‘ï¼Œå¦‚æœæ˜¯non-inlineåˆ™å¯èƒ½åªéœ€è¦é‡æ–°linkå³å¯ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:1:5","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R31 å°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾èµ–å…³ç³»é™è‡³æœ€ä½ C++çš„Classå®šä¹‰å¼åŒ…æ‹¬äº†æˆå‘˜å˜é‡ï¼Œå‡è®¾æŸæˆå‘˜å˜é‡æ˜¯ç±»å¯¹è±¡ClassObjA aï¼Œå¦‚æœClassObjAç±»çš„å†…éƒ¨å®ç°å‘ç”Ÿäº†æ”¹å˜ï¼ˆå“ªæ€•è¿™ä¸ªClassObjA.hå†…åªåœ¨æŸå¤„åŠ äº†ä¸€ä¸ªç©ºæ ¼ ï¼‰ï¼Œé‚£ä¹ˆincludeäº†ClassObjA.hçš„æ‰€æœ‰.hæ–‡ä»¶.cppæ–‡ä»¶éƒ½ä¼šé‡æ–°ç¼–è¯‘ã€‚ ğŸ‘†è¿™å°±æ˜¯ç”±â€œç¼–è¯‘ä¾èµ–â€å…³ç³»å¸¦æ¥çš„é—®é¢˜ã€‚ ä½¿ç”¨ PIMPL æ‰‹æ³•(pointer to implementation)å¯ä»¥å¾ˆå¥½åœ°åˆ†ç¦»å£°æ˜å’Œå®šä¹‰ï¼š //Person.hæ–‡ä»¶ ä¸éœ€è¦include \"PersonImpl.h\"å’Œ\"BirthDay.h\" class PersonImpl; class BirthDay;// å‰ç½®å£°æ˜ä»£æ›¿include class Person { public:// æ„é€ å‡½æ•°è¿™é‡Œæ”¾å®ç°æ— æ‰€è°“ï¼Œå› ä¸ºæ˜¯å‡½æ•°æŒ‡é’ˆï¼Œä¸éœ€çŸ¥é“PersonImplæœ¬ä½“å®ç° Person(const std::shared_ptr\u003cPersonImpl\u003e\u0026 pImpl);//æ„é€ å‡½æ•°çš„å®ç°ä¹Ÿæ”¾åˆ°cppé‡Œå» const BirthDay\u0026 GetBirthDay();// æ³¨æ„ï¼šè¿™é‡Œåªå£°æ˜ï¼ŒæŠŠå®ç°éƒ¨åˆ†æ”¾åˆ°cppé‡Œ std::string GetName();//å®ç°ç»†èŠ‚ç”±pImpl_è½¬å‘å®ç° private: std::shared_ptr\u003cPersonImpl\u003e pImpl_; }; //Person.cppæ–‡ä»¶ #include \"PersonImpl.h\" //åœ¨\"PersonImpl.h\"æ–‡ä»¶å†…includeé‚£ä¸ª\"BirthDay.h\" #include \"Person.h\" æ³¨æ„ï¼šImplç”¨æ³•ï¼Œç›¸å…³çš„å¤´æ–‡ä»¶é‡Œä¸è¦æ”¾ç½®ä»»ä½•å‡½æ•°å®ç°ä»£ç  ã€‚ ä¸Šè¿°åšæ³•å¯ä»¥è®©ä½¿ç”¨Personç±»çš„å®¢æˆ·ä¸éœ€è¦å†å…³å¿ƒPersonImplä»¥åŠBirthDayçš„å®ç°ç»†èŠ‚äº†ï¼Œåšåˆ°äº†â€œæ¥å£ä¸å®ç°åˆ†ç¦»â€ï¼Œå…³é”®ç‚¹åœ¨äºæŠŠâ€œå®šä¹‰çš„ä¾èµ–æ€§â€ æ¢æˆ $\\Rightarrow$ â€œå£°æ˜çš„ä¾èµ–æ€§â€ã€‚ è¿™é‡Œçªå‡ºäº†å¦‚ä½•æœ€å°åŒ–ç¼–è¯‘ä¾èµ–æ€§çš„æœ¬è´¨ï¼šè®©å¤´æ–‡ä»¶å°½å¯èƒ½è‡ªæˆ‘æ»¡è¶³ï¼Œå¦‚æœä¸è¡Œï¼Œä¹Ÿè¦ä¾èµ–äºå…¶ä»–æ–‡ä»¶çš„å£°æ˜å¼è€Œéå®šä¹‰å¼ã€‚ å…·ä½“åˆ°è®¾è®¡ç­–ç•¥ä¸Šï¼Œæœ‰ä»¥ä¸‹å‡ ç§åšæ³•ï¼š å¦‚æœèƒ½ç”¨object references æˆ– object pointerså®Œæˆä»»åŠ¡ï¼Œå°±åˆ«ç”¨objects å¦‚æœè¦å®šä¹‰æŸç±»å‹çš„objectsï¼Œå°±è¦ä½¿ç”¨å®šä¹‰å¼ï¼ŒæŒ‡é’ˆå’Œåº”ç”¨åˆ™å¯ä»¥åªç”¨å£°æ˜å¼ã€‚ å°½é‡ä»¥classå£°æ˜å¼æ›¿æ¢classå®šä¹‰å¼ å‡½æ•°å£°æ˜ç§çš„Classç±»å‹å¯ä»¥åªç”¨å£°æ˜å¼ï¼Œå³ä½¿ä»¥by-object-valueå½¢å¼ä¼ å€¼ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ä¸ºå£°æ˜å¼å’Œå®šä¹‰å¼æä¾›ä¸åŒçš„æ–‡ä»¶ æ¯”å¦‚Dateç±»ï¼Œåˆ†ä¸ºåªåŒ…å«å£°æ˜å¼çš„\"Datefwd.h\"å’ŒåŒ…å«å®šä¹‰å¼çš„\"Date.h\"ï¼Œé‚£ä¹ˆä½¿ç”¨æ—¶ç”¨å£°æ˜å¼å¤´æ–‡ä»¶ä»£æ›¿å‰ç½®å£°æ˜ï¼Œåœ¨éœ€è¦åº”ç”¨ä»£ç client.cppé‡Œincludeå®šä¹‰å¼å¤´æ–‡ä»¶ã€‚è¿™ç§æ–¹å¼åœ¨æ ‡å‡†åº“é‡Œé‡‡ç”¨è¾ƒå¤šï¼Œå‚è€ƒå’Œ,,ç­‰ã€‚ By the way C/C++å¯ä»¥ä½¿ç”¨ç¼–è¯‘å™¨é¢„å¤„ç†æŒ‡ä»¤#pragma messageï¼Œæ‰“å°å‡ºè¯¥æ–‡ä»¶æ˜¯å¦å‚ä¸æ­¤æ¬¡ç¼–è¯‘ï¼Œä»¥åŠå‚ä¸ç¼–è¯‘æ—¶è¢«å“ªä¸ªæ–‡ä»¶æ‰€ä¾èµ–ã€‚ //æ¯”å¦‚å¯ä»¥åœ¨ testEffective.h æ–‡ä»¶å†…åŠ ä¸Šè¿™å¥ï¼Œå°±èƒ½åœ¨ç¼–è¯‘è¾“å‡ºä¿¡æ¯é‡Œçœ‹åˆ°æ‰“å°ä¿¡æ¯ï¼Œè§‚å¯Ÿåˆ°ä¾èµ–å…³ç³» #pragma message(\"testEffective.h å‚ä¸é‡æ–°ç¼–è¯‘\") //è¿˜å¯ä»¥ç”¨äºæµ‹è¯•æŸäº›å®æ˜¯å¦çœŸçš„ç”Ÿæ•ˆï¼Œæœ‰æ—¶IDEçš„é«˜äº®æ˜¾ç¤ºä¸å‡†ç¡®è€Œä»¤äººç”Ÿç–‘ã€‚ å…³äºå¤´æ–‡ä»¶includeçš„å…¶ä»–ç¼–å†™è§„èŒƒï¼Œå¯ä»¥å‚è€ƒï¼šGoogle-C++é£æ ¼æŒ‡å—ï¼š1.å¤´æ–‡ä»¶ ä½¿ç”¨ Interface Class ä¹Ÿèƒ½åšåˆ°æ¥å£å’Œå®ç°çš„çœŸæ­£åˆ†ç¦»ï¼š è¿™ç§æ–¹å¼å¸¸è§äºè¾“å‡ºåŠ¨æ€åº“ç»™åˆ°å®¢æˆ·ä½¿ç”¨ï¼Œå®¢æˆ·èƒ½è§åˆ°æ¥å£å®šä¹‰å’Œä½¿ç”¨ï¼Œä½†æ— æ³•çœ‹åˆ°å†…éƒ¨å®ç°ã€‚ ç”¨æ³•è¾ƒä¸ºå¸¸è§ï¼Œä¸èµ˜è¿°ï¼Œç›´æ¥show-codeï¼š //VirtualPerson.h //å’Œ libæ–‡ä»¶ä¸€èµ·æä¾›ç»™åˆ°å®¢æˆ· class VirtualPerson { public: //createçš„è¿”å›å€¼è¿˜å¯ä»¥æ ¹æ®éœ€æ±‚ï¼Œæ¢æˆRAIIçš„æ™ºèƒ½æŒ‡é’ˆ static VirtualPerson * create(int level, int salary); virtual int Level() = 0; virtual int Salary() = 0; virtual ~VirtualPerson();// avoid memory leak }; //VirtualPerson.cpp //æºç ä¸æä¾›ç»™å®¢æˆ·ï¼Œè€Œæ˜¯ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶ libæ–‡ä»¶ VirtualPerson* VirtualPerson::create(int level, int salary) { if (level == 3) { //å·¥å‚æ–¹æ³•ï¼Œè¿˜å¯ä»¥ç”Ÿæˆå…¶ä»–å­ç±» return new Engineer(level, salary); } return nullptr; } VirtualPerson::~VirtualPerson() { } // Engineer.h //Engineerä¹Ÿæ˜¯å‚ä¸ç¼–è¯‘åˆ° libæ–‡ä»¶ä¸­ class Engineer: public VirtualPerson { public: Engineer(int level,int salary); virtual int Level() ; virtual int Salary() ; private: int level_ = 3; int salary_ = 0; }; ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:1:6","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"CH6. ç»§æ‰¿ä¸é¢å‘å¯¹è±¡è®¾è®¡ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R32 ç¡®å®šä½ çš„publicç»§æ‰¿å¡‘é€ å‡ºis-aå…³ç³» åŸä¹¦æ ‡é¢˜ï¼šMake sure public inheritance models â€œis-aâ€. ä¾¯æ·è€å¸ˆç¿»è¯‘ä¸ºâ€œå¡‘æ¨¡â€ï¼Œæˆ‘ä¸ªäººæ›´æ„¿æ„ç§°ä¸ºâ€œå¡‘é€ â€ã€‚ â€œpublicç»§æ‰¿â€æ„å‘³ç€is-a is-aï¼Œå³â€œæ˜¯ä¸€ç§â€ï¼Œå°±æ˜¯è¯´ï¼Œé€‚ç”¨äºBase Classèº«ä¸Šçš„æ¯ä¸€ä»¶äº‹ï¼Œä¹Ÿä¸€å®šé€‚ç”¨äºDerived Classèº«ä¸Šã€‚ By the way é¢å‘è®¾è®¡å¯¹è±¡çš„è®¾è®¡æœ‰è‘—åçš„5å¤§åŸåˆ™ï¼Œ SOLID åŸåˆ™ï¼Œæ¯ä¸ªå­—æ¯åˆ†åˆ«ä»£è¡¨ä¸€ç§åŸåˆ™ï¼š Sâ€“å•ä¸€è´£ä»»åŸåˆ™(SRP) â€“Single Responsibility Principle Oâ€“å¼€æ”¾å°é—­åŸåˆ™(OCP)â€“ Open-Closed Principle Lâ€“é‡Œå¼æ›¿æ¢åŸåˆ™(LSP)â€“ Liskov Substitution Principle I â€“- æ¥å£åˆ†ç¦»åŸåˆ™(ISP)â€“Interface Segregation Principle Dâ€“-ä¾èµ–å€’ç½®åŸåˆ™(DIP)â€“ Dependency Inversion Principle æ›´è¯¦ç»†çš„å™è¿°å¯ä»¥å‚è€ƒï¼šè…¾è®¯äº‘ï¼šSOLIDåŸåˆ™ æœ¬èŠ‚æ¡æ¬¾çš„ä¸­å¿ƒæ€æƒ³å³é‡Œæ°æ›¿æ¢åŸåˆ™ï¼šä¸€ä¸ªå¯¹è±¡å‡ºç°çš„åœ°æ–¹éƒ½å¯ä»¥ç”±å…¶å­ç±»ä»£æ›¿å¹¶ä¸”ä¸ä¼šå‡ºé”™ã€‚ ç»§æ‰¿å…³ç³»æœ‰æ—¶å€™å¬èµ·æ¥å¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚ Class Student: public Personç†æ‰€åº”å½“ï¼Œä½†æœ‰æ—¶ä¹Ÿä¼šå¯¼è‡´è¯¯è§£ã€‚æ¯”å¦‚ä¼é¹…å±äºé¸Ÿç±»ï¼Œä½†ä¼é¹…ä¸ä¼šé£ï¼Œé‚£ä¹ˆåŸºç±»Bird::Flyæ–¹æ³•åˆå½“å¦‚ä½•å¤„ç†ï¼Œä¸‹æ–¹æ»¡è¶³è®¾è®¡æ„å›¾ï¼š class Bird{ //... ä¸å£°æ˜Fly()æ–¹æ³• }; class FylingBird:public Bird{ public: virtual void Fly(); }; class Penguin: public Bird{ //... ä¸å£°æ˜Fly()æ–¹æ³• }; // æ³¨ï¼šå¦‚æœBirdç±»ä»¥åŠå­ç±»éƒ½ä¸è€ƒè™‘Fly()æ–¹æ³•ï¼Œé‚£ä¹ˆPenguinç›´æ¥ç»§æ‰¿äºBirdå³å¯ è¿˜æœ‰å¦ä¸€ç§åœºæ™¯ï¼Œçˆ¶ç±»å’Œå­ç±»å¯¹äºåŒä¸€ä¸ªæ–¹æ³•çš„æ•°æ®ä¿®æ”¹è§„åˆ™ä¸åŒï¼Œå¯¼è‡´äº†ç»§æ‰¿ä½“ç³»çš„ç¼ºé™·ã€‚ æ¯”å¦‚Class Square:public Rectangle $\\rightarrow$ æ­£æ–¹å½¢ç»§æ‰¿äºé•¿æ–¹å½¢ï¼Œä½†æ˜¯è€ƒè™‘è¿™æ ·ä¸€ä¸ªç±»å¤–æ–¹æ³•: void makeBigger(Rectangle\u0026 r){ //æ™®é€šéæˆå‘˜å‡½æ•° int oldHeight = r.height(); r.setWidth(r.width() + 10);//å¦‚æœræ˜¯Squqreï¼Œå¯èƒ½å†…éƒ¨è‡ªåŠ¨å°±é•¿å®½ä¸€èµ·å˜äº† assert(r.height() == oldHeight);//è¿™ä¸ªassertå¯¹äºæ­£æ–¹å½¢å°±ä¸åˆé€‚äº†,è´¸ç„¶å»é™¤åˆè¿èƒŒè®¾è®¡æœ¬æ„ } åº”å¯¹ä¸Šè¿°è¿™æ ·çš„æƒ…å†µï¼Œå°±éœ€è¦ä¿®æ”¹è®¾è®¡æˆ–ä¿®æ”¹ç»§æ‰¿ä½“ç³»äº†ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:1","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R33 é¿å…é®æ©ç”±ç»§æ‰¿å¾—æ¥çš„åç§° é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯åç§°çš„é®æ©ï¼Œé€šä¿—åœ°è¯´ï¼Œæ˜¯æŒ‡ç”±äºä½œç”¨åŸŸä¸åŒå¸¦æ¥çš„å˜é‡åè¦†ç›–ã€‚è€ƒè™‘ä¸‹æ–¹ä»£ç ï¼š int x = 10; void someFunc(){ double x = 0.1; std::cout\u003c\u003c\"x is\" \u003c\u003c x \u003c\u003c std::endl; // localä½œç”¨åŸŸæ‰¾åˆ°äº†xï¼Œç›´æ¥è¦†ç›–å…¨å±€çš„xï¼Œè¾“å‡º0.1 } é‚£ä¹ˆå¦‚æœå°†ç»§æ‰¿ä½“ç³»è€ƒè™‘è¿›æ¥å‘¢ï¼šDerivedçš„ä½œç”¨åŸŸä¼šè¦†ç›–Baseçš„ä½œç”¨åŸŸï¼ŒåŒ…æ‹¬virtualå’Œnon-virtualã€‚è€ƒè™‘ä¸‹æ–¹ä»£ç ï¼š class Base { public: virtual void mf1() = 0; virtual void mf1(int x) { std::cout \u003c\u003c \"Base::mf1():x =\" \u003c\u003c x \u003c\u003c std::endl; } virtual void mf2() { std::cout \u003c\u003c \"Base::mf2()\\n\"; } void mf3() { std::cout \u003c\u003c \"Base::mf3()\\n\"; } void mf3(int x) { std::cout \u003c\u003c \"Base::mf3():x =\" \u003c\u003c x \u003c\u003c std::endl; } virtual ~Base() {} }; class Derived :public Base { public: virtual void mf1() { std::cout \u003c\u003c \"Derived::mf1()\\n\"; } void mf3(){ std::cout \u003c\u003c \"Derived::mf3()\\n\"; } }; å¾ˆæ˜æ˜¾å­˜åœ¨åç§°é®æ©çš„é—®é¢˜ï¼ŒDerivedçš„mf1ï¼Œmf3ä¼šé®æ©å­ç±»çš„æ‰€æœ‰åŒåå‡½æ•°ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š Derived d; d.mf1(); //OKï¼Œè¾“å‡º: Derived::mf1() //d.mf1(100); ç¼–è¯‘æŠ¥é”™ï¼Œå› ä¸ºåç§°è¢«é®æ© d.mf2(); //OKï¼Œè¾“å‡º: Base::mf2() d.mf3(); //OKï¼Œè¾“å‡º: Derived::mf3() //d.mf3(300); ç¼–è¯‘æŠ¥é”™ï¼ŒåŒç† d.Base::mf3(300); //OKï¼Œè¾“å‡º: Base::mf3():x =300 . ä½†æ˜¯ä¸å¤ªå»ºè®®è¿™ä¹ˆå†™ï¼Œä¸‘ï¼ï¼ ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨usingå£°æ˜å¼æˆ–è½¬å‘å‡½æ•° using å£°æ˜å¼ å¯ä»¥ä½¿ç”¨usingå£°æ˜å¼ï¼Œè®©Derivedå¯ä»¥å¿½ç•¥åç§°é®æ©ï¼Œçœ‹åˆ°Baseä½œç”¨åŸŸå†…çš„å‡½æ•°ã€‚å¯ä»¥è®©ä¸Šæ–¹ä»£ç çš„â€œç¼–è¯‘æŠ¥é”™â€æ¶ˆå¤±ï¼Œæ­£å¸¸è°ƒç”¨d.mf1(100)å’Œd.mf3(300)ã€‚ class Derived :public Base { public: //ä¿®æ”¹æœ¬èŠ‚å†…å®¹ä¸­ä¸Šæ–¹ä»£ç çš„Derivedç±»çš„å£°æ˜ using Base::mf1; using Base::mf3; //è¿™2ä¸ªusingä½¿å¾—Baseç±»ä½œç”¨åŸŸå†…æ‰€æœ‰mf1,mf3å‡½æ•°éƒ½å¯è§ // ... å…¶ä»–ï¼Œç•¥ } è½¬å‘å‡½æ•°(forwarding function) åº”ç”¨åœºæ™¯: åœ¨privateç»§æ‰¿ä¸‹ï¼Œå¼ºè°ƒçš„æ˜¯ç»§æ‰¿å®ç°è€Œéç»§æ‰¿æ¥å£ï¼Œå¦‚æœæƒ³åœ¨å­ç±»çš„æˆå‘˜ä¸­è°ƒç”¨çˆ¶ç±»å‡½æ•°ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡å‡½æ•°è½¬å‘æ¥å®ç°ã€‚ class Derived: private Base{ //æ”¹å†™æœ¬èŠ‚ä¸Šæ–¹ä»£ç ï¼Œæ³¨æ„ï¼Œæ˜¯ç§æœ‰ç»§æ‰¿ public: virtual void mf1(){ Base::mf1(); //æ‹¿åˆ°äº†çˆ¶ç±»çš„å‡½æ•°å®ç° // ... è¯¥å‡½æ•°å…¶ä»–éƒ¨åˆ† } }; // åº”ç”¨ä»£ç  Derived d; d.mf1(); //è°ƒç”¨æˆåŠŸï¼ŒDerived::mf1 d.mf1(100); //ç¼–è¯‘å¤±è´¥ å½“ç„¶ï¼Œpublicç»§æ‰¿ä¹Ÿèƒ½ä½¿ç”¨è½¬å‘å‡½æ•°ï¼Œå†™å‡ºd.Base::mf3(300); è¿™æ ·çš„ä»£ç ã€‚ä½†æ˜¯ï¼Œä¸€æ¥publicç»§æ‰¿ç†åº”éµå¾ª\"is-a\"è§„åˆ™ï¼Œusingå£°æ˜æ‹¿åˆ°æ‰€æœ‰è¢«é®æ©çš„æ¥å£ï¼›äºŒæ¥æ˜æ˜¾ä»£ç ä¸ç¾è§‚ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:2","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R34 åŒºåˆ†æ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿ å½“ä¸€ä¸ªå­ç±»Derivedç»§æ‰¿äºçˆ¶ç±»Baseï¼Œé‚£ä¹ˆè¦æ—¶åˆ»æ¸…æ¥šï¼Œå¯¹äºç±»ä¸­çš„æˆå‘˜å‡½æ•°ï¼Œæ˜¯æƒ³ç»§æ‰¿çˆ¶ç±»çš„æ¥å£ï¼Œè¿˜æ˜¯æƒ³ç»§æ‰¿çˆ¶ç±»çš„å®ç°ã€‚ å¯¹äºPublicç»§æ‰¿ï¼Œæ¥å£æ€»æ˜¯ä¼šè¢«ç»§æ‰¿ åŸºäºâ€œis-aâ€çš„å…³ç³»ï¼Œä½œç”¨äºçˆ¶ç±»çš„ä»»ä½•äº‹æƒ…ä¹Ÿä¸€å®šè¦é€‚ç”¨äºå­ç±»ã€‚ å£°æ˜çº¯è™šå‡½æ•°(pure-virtual)çš„ç›®çš„æ˜¯è®©å­ç±»åªç»§æ‰¿å‡½æ•°æ¥å£ å¯¹äºçº¯è™šå‡½æ•°ï¼Œå­ç±»å¿…é¡»é‡æ–°å®ç°è¯¥æ¥å£ã€‚æ³¨æ„ï¼Œçˆ¶ç±»å¯ä»¥é€‰æ‹©æ€§ç»™å‡ºçº¯è™šå‡½æ•°çš„å®ç°ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸ä¼šç»™ã€‚ éšæ‚£ï¼šä»éçº¯è™šå‡½æ•°(impure-virtual)åŒæ—¶ç»§æ‰¿æ¥å£å’Œç¼ºçœå®ç° éçº¯è™šå‡½æ•°ï¼Œå¯ä»¥è®©å­ç±»é€‰æ‹©æ˜¯å¦é‡æ–°å®ç°è¯¥æ¥å£ã€‚é‚£ä¹ˆï¼Œå¦‚æœå­ç±»æ˜¯æœ‰å¿…è¦é‡å†™ï¼Œä½†æ˜¯å¿˜è®°å†™äº†å´é»˜é»˜ç”¨çˆ¶ç±»ç‰ˆæœ¬ï¼Œä¾¿äº‹ä¸æ„¿è¿äº†ã€‚ ä¸¾ä¾‹ï¼šçˆ¶ç±»Airplaneæœ‰å­ç±»PlaneModelAã€PlaneModelBã€PlaneModelCï¼Œå…¶ä¸­Cå‹é£æœºä¸åŒäºABå‹ï¼Œæ˜¯æ–°å¼é£æœºï¼š class Airport {...};//æœºåœºç±»ï¼Œå®ç°ç•¥ class Airplane{ public: virtual void fly(const Airport\u0026 destination);//çˆ¶ç±»è¿˜ä¼šç»™å‡ºé»˜è®¤çš„flyå®ç° }; class PlaneModelA: public Airplane{ ... }; // ä¸é‡å†™flyï¼Œç»§æ‰¿çˆ¶ç±»çš„flyå®ç° class PlaneModelB: public Airplane{ ... }; // Bå’ŒAä¸€æ · class PlaneModelC: public Airplane{ ... }; //æ–°å‹é£æœºï¼Œæœ¬æ¥è¦é‡å†™flyï¼Œç»“æœå¿˜äº† é‚£ä¹ˆè¿™ä¸ªéšæ‚£è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å®ç°Cå‹é£æœºç±»æ—¶åˆ«å¿˜äº†flyæ–¹æ³•ï¼Ÿ æ ¸å¿ƒæ€æƒ³æ˜¯â€œåˆ‡æ–­virtualå‡½æ•°æ¥å£å’Œå…¶é»˜è®¤å®ç°ä¹‹é—´çš„è¿æ¥â€ã€‚ æ–¹æ³•1ï¼šè®¾ç½®flyä¸ºçº¯è™šå‡½æ•°ï¼Œå¹¶æ–°å¢ä¸€ä¸ªdefaultyFlyæ–¹æ³• æ³¨æ„ç»†èŠ‚ï¼šdefaultFlyæ–¹æ³•è¦è®¾ç½®ä¸ºprotectedå±æ€§çš„non-virtualå‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š class Airplane{ public: virtual void fly(const Airport\u0026 destination) = 0;// çˆ¶ç±»ä¸ç»™å‡ºå®ç° protected: void defaultFly(const Airport\u0026 destination){ ... }//é»˜è®¤çš„flyå®ç° }; class PlaneModelA: public Airplane{ public: //çº¯è™šæ¥å£,å­ç±»å¿…é¡»ç»™å‡ºå®ç° virtual void fly(const Airport\u0026 destination){ defaultFly(destination); //è°ƒç”¨çˆ¶ç±»çš„ç¼ºçœå®ç° } };//PlaneModelB å’Œ PlaneModelA ç±»ä¼¼,ç•¥ class PlaneModelC: public Airplane{ ...};// é‡å†™flyæ–¹æ³• è¿™æ ·å†™è¿˜æœ‰ä¸ªå¥½å¤„ï¼šfly()å’ŒdefaultFly()äº«æœ‰ä¸åŒçš„ä¿æŠ¤çº§åˆ«ã€‚ æ–¹æ³•2ï¼š çˆ¶ç±»çš„é»˜è®¤å®ç°å¡åˆ°çº¯è™šæ¥å£flyä¸­ è¿™æ ·å°±ä¸éœ€è¦å®šä¹‰defaultFlyæ–¹æ³•äº†ï¼Œå› ä¸ºå­ç±»å¿…é¡»å®ç°flyæ–¹æ³•ï¼Œå¯¹äºA å‹ã€Bå‹é£æœºï¼Œå­ç±»fly()è½¬å‘ä¸€æ¬¡çˆ¶ç±»çš„fly()å³å¯ï¼ŒCç±»é£æœºå®ç°æ–°å¼çš„fly()ã€‚ç¼ºç‚¹æ˜¯è®©åŸæœ¬åœ¨defaultFlyå†…çš„å®ç°å†…å®¹æš´éœ²åœ¨å¤–äº†(æŒ‡publicå±æ€§)ã€‚ Note ä¸ªäººè®¤ä¸ºï¼Œè¿™æ–¹æ³•2è¿˜æœ‰ä¸ªç¼ºç‚¹ï¼šå®ƒè®©è™šåŸºç±»çš„çº¯è™šæ¥å£æ‰¿è½½äº†æ¥å£å®ç°ï¼Œä¸å¤Ÿçº¯ç²¹(æ¯”å¦‚éœ€è¦è¾“å‡ºç»™åˆ°å®¢æˆ·ï¼Œåº”è¯¥åªç»§æ‰¿æ¥å£)ã€‚ non-virtualå‡½æ•°å…·ä½“æŒ‡å®šæ¥å£ç»§æ‰¿å’Œå¼ºåˆ¶æ€§å®ç°ç»§æ‰¿ å¦‚æœæˆå‘˜å‡½æ•°æ˜¯non-virtualï¼Œè¡¨ç¤ºå®ƒä¸æ‰“ç®—åœ¨å­ç±»ä¸­æœ‰ä¸åŒçš„è¡Œä¸ºï¼Œæˆ–è€…è¯´ï¼Œä¸å˜æ€§å‡Œé©¾äºç‰¹å¼‚æ€§ã€‚å¯¹åº”åœ°ï¼Œç»ä¸åº”è¯¥åœ¨å­ç±»ä¸­é‡å†™non-virtualå‡½æ•°ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:3","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R35 è€ƒè™‘virtualå‡½æ•°çš„æ›¿ä»£é€‰æ‹© å‡è®¾è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šè®¾è®¡ä¸€æ¬¾æ¸¸æˆï¼Œä¸åŒäººç‰©ä»¥ä¸åŒæ–¹å¼è®¡ç®—ç”Ÿå‘½å€¼ï¼Œé‚£ä¹ˆ$\\Longrightarrow$ è®¾è®¡ç»§æ‰¿ä½“ç³»ï¼Œå­ç±»å…±åŒç»§æ‰¿çˆ¶ç±»çš„public-virtualæ–¹æ³•healthValue()ï¼Œå­ç±»å„è‡ªé‡æ–°å®ç°healthValue()æ¥å£ã€‚ ğŸ˜„å¾ˆå¥½ï¼Œä¸­è§„ä¸­çŸ©ï¼Œé‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰å…¶ä»–æ–¹å¼å‘¢ï¼Ÿ NVIæ‰‹æ³•(non-virtual interface)å®ç°Template Methodæ¨¡å¼ æ€è·¯å°±æ˜¯çˆ¶ç±»å®šä¹‰ä¸ªnon-virtualçš„publicæ–¹æ³•healthValue()ï¼Œè°ƒç”¨virtualçš„privateæ–¹æ³•healthValueImplã€‚å­ç±»ç›´æ¥é‡å†™healthValueImplï¼Œè¾¾åˆ°ç±»ä¼¼æ¨¡ç‰ˆæ–¹æ³•è®¾è®¡æ¨¡å¼çš„æ•ˆæœã€‚ çˆ¶ç±»GameCharacterè®¾è®¡å¦‚ä¸‹ï¼š class GameCharacter{//æ„é€ å‡½æ•°å’Œè™šææ„å‡ç•¥å» public: int healthValue()const{ //ps:æ–¹ä¾¿å±•ç¤ºï¼Œè€Œå†™åœ¨äº†å¤´æ–‡ä»¶é‡Œï¼Œæˆäº†inline std::cout\u003c\u003c \"Do prepare works...\\n\";//äº‹å‰ï¼Œå¦‚åŠ é”,å†™log,éªŒè¯æ¡ä»¶ç­‰ int retVal = healthValueImpl(); std::cout\u003c\u003c \"\\nDo post works...\\n\";//äº‹å,å¦‚è§£é”,æ›´æ–°æ•°æ® return retVal; } private: virtual int healthValueImpl() const{ int val=0; std::cout \u003c\u003c \"default caculate process... GetValue:\" \u003c\u003c val;//éšåè¿›è¡Œè®¡ç®—ï¼Œè¿‡ç¨‹ç•¥ return val; } }; å­ç±»GoodGuyå’ŒBadGuyè®¾è®¡å¦‚ä¸‹ï¼š class GoodGuy:public GameCharacter{ private: virtual int healthValueImpl() const{ int val = 60; std::cout \u003c\u003c \"goodGuy caculate ... GetValue: \" \u003c\u003c val \u003c\u003c \" \";//è¿‡ç¨‹ç•¥ return val; } }; class BadGuy:public GameCharacter{ private: virtual int healthValueImpl() const{ int val = 80; std::cout \u003c\u003c \"badGuy caculate ... GetValue: \" \u003c\u003c val \u003c\u003c \" \";//è¿‡ç¨‹ç•¥ return val; } }; åº”ç”¨ç«¯ä»£ç å¦‚ä¸‹ï¼š std::shared_ptr\u003cGameCharacter\u003e pGood = std::make_shared\u003cGoodGuy\u003e(); pGood-\u003ehealthValue(); //å¾—åˆ°60 std::shared_ptr\u003cGameCharacter\u003e pBad = std::make_shared\u003cBadGuy\u003e(); pBad-\u003ehealthValue();//å¾—åˆ°80 ç”¨å‡½æ•°æŒ‡é’ˆå®ç°Strategyæ¨¡å¼ ä¸»ä½“æ€æƒ³æ˜¯æ·»åŠ ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆä¸ºprivateæˆå‘˜å˜é‡pFuncï¼Œè¿™ä¸ªå‡½æ•°é€šè¿‡å¤–éƒ¨ä¼ å…¥ï¼Œä»è€Œå®ç°ä¸åŒçš„è¡Œä¸ºã€‚ class GameCharacter;//forward declaration int defaultHealthCalc(const GameCharacter\u0026 gc);//é»˜è®¤ç®—æ³•å®ç° class GameCharacter{ public: typedef int (*HealthCalcFunc)(const GameCharacter\u0026 gc); explicit GameCharacter(HealthCalcFunc hcf = defaultHealthCalc):calcFunc_(hcf){}//ä¼ å…¥å‡½æ•°æŒ‡é’ˆ,è‡ªå®šä¹‰å®ç° int healthValue()const{ return calcFunc_(*this); } private: HealthCalcFunc calcFunc_ = nullptr; }; è¿™ä¸ªè®¾è®¡æœ‰2ä¸ªæœ‰è¶£çš„è®¾è®¡å¼¹æ€§ï¼š å³ä½¿åŒä¸€ä¸ªäººç‰©ç±»å‹çš„ä¸åŒå®ä½“ï¼Œå…è®¸æ‹¥æœ‰ä¸åŒçš„ç”Ÿå‘½å€¼è®¡ç®—æ–¹æ³•ï¼› æŸä¸ªäººç‰©å¯¹è±¡çš„ç”Ÿå‘½å€¼è®¡ç®—æ–¹æ³•ï¼Œåœ¨å…¶ç”Ÿå‘½æœŸå†…å¯ä»¥ä»»æ„ä¿®æ”¹ï¼Œåªè¦æ·»åŠ ä¸€ä¸ªsetæ–¹æ³•å³å¯ï¼› ç”¨std::functionå®ç°Strategyæ¨¡å¼ privateæˆå‘˜å˜é‡ç”±ä¸Šæ–‡çš„å‡½æ•°æŒ‡é’ˆæ›¿æ¢æˆstd::functionå¯¹è±¡ï¼Œç›¸å½“äºæ˜¯æŒ‡å‘å‡½æ•°çš„æ³›åŒ–æŒ‡é’ˆã€‚å°±æ›´å…·è®¾è®¡å¼¹æ€§äº†ã€‚std::functionå¯ä»¥ä¼ å…¥å‡½æ•°æŒ‡é’ˆã€ä»¿å‡½æ•°ã€std::bindå‡½æ•°å¯¹è±¡ã€‚GameCharacterçš„ç±»å®ç°ä¿®æ”¹ä¸ºï¼š class GameCharacter{ public: typedef std::function\u003cint (const GameCharacter\u0026)\u003e healthCalcFunc; explicit GameCharacter(healthCalcFunc hcf = defaultHealthCalc):healthValueImpl_(hcf){} int healthValue()const{ std::cout\u003c\u003c \"Do prepare works...\\n\"; int retVal = healthValueImpl_(*this); // è¿™é‡Œæ”¹äº† std::cout\u003c\u003c \"\\nDo post works...\\n\"; return retVal; } private: healthCalcFunc healthValueImpl_ = nullptr; }; ä¼ å…¥å‡½æ•°æŒ‡é’ˆ gameChashort quickHurtHealthCalc(const GameCharacter2\u0026 gc);//è¿”å›å€¼ä¸æ˜¯int,å¯éšå¼è½¬æ¢;å®ç°ç•¥å» //åº”ç”¨ç«¯ä»£ç å¦‚ä¸‹ï¼š GameCharacter quickGuy(quickHurtHealthCalc); quickGuy.healthValue();//å†…éƒ¨è°ƒç”¨quickHurtHealthCalc ä¼ å…¥ä»¿å‡½æ•° ä»¿å‡½æ•°ï¼šå³å‡½æ•°å¯¹è±¡ï¼Œè€Œä¸”é‡è½½äº†operator() ã€‚ struct HealthCalculator{// int operator()(const GameCharacter2\u0026 gc) const{ return 180;//çœç•¥å®ç° } }; //åº”ç”¨ç«¯ä»£ç å¦‚ä¸‹ï¼š GameCharacter functorGuy( (HealthCalculator()) );//ç”¨æ‹¬å·å°†ä»¿å‡½æ•°æ‹¬èµ·æ¥ functorGuy.healthValue(); ä¼ å…¥std::bindå‡½æ•°å¯¹è±¡ std::bindæ˜¯å‡½æ•°å¯¹è±¡æ¨¡æ¿ï¼Œæ¥æ”¶ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆfå’Œè‹¥å¹²å‡½æ•°å…¥å‚å¾—åˆ°fObjï¼Œè°ƒç”¨fObjç­‰åŒäºè°ƒç”¨å¸¦å‚æ•°çš„fã€‚æœ¬ä¾‹ä»£ç å¦‚ä¸‹ï¼š class GameLevel{ public: //ç”¨ç±»å†…å‡½æ•°ä½œä¸ºå‡½æ•°æŒ‡é’ˆf float health(const GameCharacter\u0026 gc) const{ return -20.3; } }; //åº”ç”¨ç«¯ä»£ç å¦‚ä¸‹ï¼š GameLevel curLevel; GameCharacter levelGuy(std::bind(\u0026GameLevel::health, curLevel,std::placeholders::_1)); levelGuy.healthValue();//å†…éƒ¨è°ƒç”¨ç­‰ä»·äºcurLevel.health(leveGuy); By the way å…¶å®è¿™é‡Œä¼ å…¥C++11æ–°å¢çš„Lambdaè¡¨è¾¾å¼ä½œä¸ºstd::functionä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè€Œä¸”æ›´æ–¹ä¾¿ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š ```c++ GameCharacter lamGuy([\u0026](const GameCharacter\u0026 gc){ std::cout\u003c\u003c \"value is \" \u003c\u003c 75 \u003c\u003c std::endl;//å…·ä½“è®¡ç®—ç•¥ return 75; }); lamGuy.healthValue(); ``` å…³äºStrategyè®¾è®¡æ¨¡å¼æ›´å¤šå‚è€ƒï¼š - [Strategyè®¾è®¡æ¨¡å¼-åŸç†è®²è§£](https://refactoringguru.cn/design-patterns/strategy) - [Strategyè®¾è®¡æ¨¡å¼-C++ä»£ç å‚è€ƒ](https://refactoringguru.cn/design-patterns/strategy/cpp/example) ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:4","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R36 ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„non-virtualå‡½æ•° ç”±äºåç§°é®æ©ï¼Œä¸è¦é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„non-virtualå‡½æ•° çœ‹ä¸ªåä¾‹ï¼š class B{ public: void mf(){ std::cout \u003c\u003c \"B::mf()\"; } } class D: public B{ public: void mf(){//é‡æ–°å®šä¹‰mf()ï¼Œè¿åäº†Rule33 std::cout \u003c\u003c \"D::mf()\"; } }; é‚£ä¹ˆçœ‹è¿™æ ·çš„åº”ç”¨ä»£ç ï¼š D d; D* pD = \u0026d; B* pB = \u0026d; d.mf(); // è¾“å‡º D::mf() pD -\u003e mf();// è¾“å‡º D::mf() pB -\u003e mf();// è¾“å‡º B::mf() è¿™å°±å¾ˆè¯¡å¼‚äº†ï¼éƒ½é€šè¿‡å¯¹è±¡dè°ƒç”¨æˆå‘˜å‡½æ•°mfï¼Œè°ƒç”¨ç»“æœåº”è¯¥ç›¸åŒã€‚ å¦å¤–ä¸€ç‚¹ï¼Œå‡ºäºpublicç»§æ‰¿çš„â€œis-aâ€ç‰¹æ€§ï¼Œè¿™æ ·é‡æ–°å®šä¹‰non-virtualå‡½æ•°ä¹Ÿæ˜¯å¯¹\"is-a\"çš„ä¸¥é‡è¿èƒŒã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:5","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R37 ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„ç¼ºçœå…¥å‚å€¼ è¿™é‡Œè¯´çš„ç¼ºçœå…¥å‚ï¼ŒæŒ‡çš„æ˜¯å‡½æ•°å…¥å‚çš„é»˜è®¤å€¼ï¼Œåœ¨é‡å†™å¸¦æœ‰ç¼ºçœå…¥å‚çš„virtualå‡½æ•°æ—¶ï¼Œä¸è¦ä¿®æ”¹é‚£ä¸ªé»˜è®¤å‚æ•°çš„é»˜è®¤å€¼ã€‚ åŸå› ï¼švirtualå‡½æ•°ä¸ºåŠ¨æ€ç»‘å®šç‰¹æ€§ï¼Œè€Œç¼ºçœå‚æ•°å€¼æ˜¯é™æ€ç»‘å®šç‰¹æ€§ã€‚ä¿®æ”¹åä¼šé€ æˆä¸€äº›ä»¤äººè´¹è§£çš„ç°è±¡ã€‚ è¯·çœ‹ä¸‹æ–¹åé¢æ•™æï¼š enum class Color { RED = 0,GREEN ,BLUE }; class Shape { public: // ï¼šçˆ¶ç±»é»˜è®¤å…¥å‚æ˜¯RED virtual void draw(Color col = Color::RED) { std::cout \u003c\u003c \"Shape:col is \" \u003c\u003c int(col) \u003c\u003c std::endl; } }; class Rectangle : public Shape{ // ï¼šå­ç±»ç±»ä¿®æ”¹é»˜è®¤å…¥å‚ä¸ºGREEN virtual void draw(Color col = Color::GREEN) { std::cout \u003c\u003c \"Rectangle:col is \" \u003c\u003c int(col) \u003c\u003c std::endl; } }; é‚£ä¹ˆå½“å‡ºç°å…¸å‹åº”ç”¨åœºæ™¯Base* pB=new Derivedæ—¶ï¼Œå°±ä¼šé€ æˆâ€œçˆ¶ç±»å­ç±»å„å‡ºä¸€åŠåŠ›â€çš„æƒ…å½¢ï¼š Shape *pRec = new Rectangle(); pRec-\u003edraw(); // è¾“å‡ºï¼šRectangle:col is 0 ï¼ˆ0æ˜¯REDï¼‰ ç»“æœç¡®å®è°ƒç”¨å­ç±»drawï¼Œä½†æ˜¯é»˜è®¤å…¥å‚å–çš„æ˜¯åŸºç±»çš„ REDï¼Œè€Œéå­ç±»çš„GREENã€‚ é‚£æ€ä¹ˆä¿®æ”¹åˆé€‚å‘¢ï¼Œéƒ½å¸¦é»˜è®¤å‚æ•°ï¼Œä¸”å­ç±»çˆ¶ç±»ç›¸åŒï¼Ÿå¸¦æ¥ä¸€ä¸ªè€¦åˆé—®é¢˜ï¼Œå¦‚æœçˆ¶ç±»æ”¹äº†ï¼Œæ‰€æœ‰å­ç±»éƒ½å¾—æ”¹ã€‚ æ­£å¦‚Rule35æåˆ°çš„NVI(non-virtual interface)æ‰‹æ³•ï¼Œæ­¤å¤„ä¾¿æ˜¯ç»ä½³çš„åº”ç”¨åœºæ™¯$\\Longrightarrow$ drawæ–¹æ³•æ”¹ä¸ºé»˜è®¤å‚æ•°çš„non-virtualï¼ŒæŠŠvirtualå‡½æ•°æ”¾åˆ°privateé‡Œå»ï¼Œä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š class Shape { public: //å­ç±»ç»§æ‰¿è¯¥é»˜è®¤å…¥å‚çš„non-virtualæ¥å£ï¼Œåˆ«é‡å†™ void draw(Color col = Color::RED) { drawImpl(col); } private: //çº¯è™šå‡½æ•°æ˜¯å¼ºåˆ¶å­ç±»é‡å†™ï¼Œçœ‹å…·ä½“æƒ…å†µï¼Œimpure-virtualä¹Ÿè¡Œ virtual void drawImpl(Color col) = 0;//å­ç±»é‡å†™è¿™ä¸ªdrawImpl }; ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:6","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R38 é€šè¿‡å¤åˆå¡‘é€ å‡ºhas-aæˆ–\"æ ¹æ®æŸç‰©å®ç°å‡ºâ€ åŸä¹¦æ ‡é¢˜ï¼šModel â€œhas-aâ€ or â€œis-implemented-in-terms-ofâ€ through compositionï¼ŒåŒRule32ï¼Œä¾¯æ·è€å¸ˆç¿»è¯‘ä¸ºâ€œå¡‘æ¨¡â€ã€‚ å¤åˆå…³ç³»ï¼ˆcompositionï¼‰æ˜¯ä¸€ç§å¸¸è§çš„ç±»å…³ç³»ï¼Œå½“æŸç§ç±»å‹çš„å¯¹è±¡å†…å«æœ‰å®ƒç§ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œä¾¿æ˜¯æ­¤ç§å…³ç³»ã€‚ å¤åˆå…³ç³»åˆ†ä¸º2ç§ï¼š\"has-a\" å’Œ â€œis-implemented-in-terms-of\"ã€‚ â€œhas-aâ€å…³ç³»ï¼š æŒ‡çš„æ˜¯åº”ç”¨åŸŸéƒ¨åˆ†ï¼Œä¸å‚ä¸å†…çš„å…·ä½“å„é¡¹å®ç°ã€‚æ˜¯ä¸€ç§å•çº¯çš„å®Œå¤‡å¯¹è±¡çš„åŒ…å«å…³ç³»ï¼Œæ¯”å¦‚Personç±»æœ‰Addressã€PhoneNumberã€Jobç­‰ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œåˆæˆ–æ˜¯Imageç±»æœ‰Bufferã€Mutexxã€SearchTreeç­‰ç±»å‹çš„æˆå‘˜ã€‚ â€œis-implemented-in-terms-ofâ€œå…³ç³»ï¼š æŒ‡çš„æ˜¯å®ç°åŸŸéƒ¨åˆ†ï¼Œå‚ä¸ç±»çš„å„ç±»å®ç°ï¼Œæ¯”å¦‚æ•°æ®ç»“æ„çš„è®¾è®¡ä¸­ï¼Œæƒ³ç”¨ç°æœ‰çš„ std::listæ¥å®ç°Setç±»ï¼Œè¿™æ ·å¯èƒ½æ•ˆç‡ä¸é«˜(é€šå¸¸æ›´å…·æ•ˆç‡çš„å®ç°æ˜¯é‡‡ç”¨å¹³è¡¡æŸ¥æ‰¾æ ‘ )ï¼Œä½†æ˜¯å¯è¡Œã€‚ ğŸ“Œï¼šæ­¤å¤„ä¸èƒ½è®©Setä»¥publicç»§æ‰¿äºstd::listï¼Œå› ä¸ºlistå…è®¸é‡å¤å…ƒç´ ï¼Œè€ŒSetä¸è¡Œï¼Œä¸æ»¡è¶³â€œis-aâ€å…³ç³»ã€‚ æ­£ç¡®å®ç°éƒ¨åˆ†ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š template\u003cclass T\u003e class Set { public: bool contains(const T\u0026 item)const{ return std::find(rep_.begin(),rep_.end(),item) != rep_.end(); } void insert(const T\u0026 item){ if(!contains(item)) rep_.push_back(item); } void remove(const T\u0026 item);// å®ç°ç•¥ std::size_t size() const; // å®ç°ç•¥ private: std::list\u003cT\u003e rep_; //ç”¨æ¥è¡¨è¿°Setçš„æ•°æ® }; ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:7","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R39 æ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨privateç»§æ‰¿ â€œæ˜æ™ºè€Œå®¡æ…â€çš„æ„æ€æ˜¯ğŸ‘‰å½“è€ƒè™‘äº†å…¶ä»–æ–¹æ¡ˆå¯¹æ¯”åï¼Œä»ç„¶è§‰å¾—privateç»§æ‰¿æ˜¯æœ€åˆé€‚çš„ï¼Œæ‰ä½¿ç”¨å®ƒã€‚ é¦–å…ˆæ˜ç¡®privateç»§æ‰¿çš„2ä¸ªç‰¹æ€§ï¼š ç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨å°†ä¸€ä¸ªderived-classå¯¹è±¡éšå¼è½¬æ¢ä¸ºbase-classå¯¹è±¡(å‡½æ•°å…¥å‚æ—¶)ï¼› ç»§æ‰¿è€Œæ¥çš„æˆå‘˜ï¼Œåœ¨derived-classä¸­éƒ½ä¼šå˜æˆprivateå±æ€§ï¼› privateç»§æ‰¿çš„æ„ä¹‰ï¼šæ„å‘³ç€implemented-in-terms-ofï¼Œåœ¨ç±»å…³ç³»è®¾è®¡ä¸Šæ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼Œåªçœ‹é‡è½¯ä»¶å®ç°ã€‚ è€ƒè™‘ä»¥ä¸‹ä½¿ç”¨privateçš„2ä¸ªåº”ç”¨åœºæ™¯ï¼š derived-classæƒ³ç»§æ‰¿base-classçš„æŸpublicæ¥å£å®ç°ï¼Œä½†åˆæƒ³éšè—æ­¤æ¥å£ è€ƒè™‘å¦‚ä¸‹åº”ç”¨åœºæ™¯ï¼šå¯¹äºä¸€ä¸ªå·²çŸ¥çš„ç±»Widgetï¼Œæƒ³ç”¨å¦ä¸€ä¸ªå·²çŸ¥çš„è®¡æ—¶ç±»Timerè¾…åŠ©æ€§èƒ½åˆ†æï¼Œåœ¨å°½é‡å°æ”¹åŠ¨å·²æœ‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•å¯ç”¨Timerï¼Ÿ privateç»§æ‰¿åšæ³•ï¼šè®©Widgetç±»privateç»§æ‰¿äºTimerï¼Œé‡å†™çˆ¶ç±»Timerçš„onTickå‡½æ•°ã€‚ å…·ä½“ä»£ç å¦‚ä¸‹ï¼š class Timer{ public: explicit Timer(int tickFrequency); virtual void onTick() const;//å®šæ—¶å™¨æ»´ç­”ä¸€æ¬¡ï¼Œè‡ªåŠ¨è¢«è°ƒç”¨ä¸€æ¬¡ }; class Widget:private Timer{ private: // privateç»§æ‰¿è€Œæ¥çš„æ‰€æœ‰æˆå‘˜éƒ½æ˜¯privateå±æ€§ virtual void onTick() const;//æŸ¥çœ‹å¹¶è®°å½•Widgetæ•°æ®ï¼Œèµ„æºç­‰ }; è¯¥é—®é¢˜é™¤äº†ä¸Šæ–¹çš„privateç»§æ‰¿ï¼Œèƒ½ä¸èƒ½ç”¨å…¶ä»–æ–¹æ¡ˆæ›¿ä»£privateç»§æ‰¿å‘¢ï¼Ÿ ğŸ‘‰ğŸ‘‰â€œpublicç»§æ‰¿+å¤åˆâ€æ›¿ä»£privateç»§æ‰¿ï¼šåœ¨Widgetå†…éƒ¨åµŒå¥—å®šä¹‰privateå±æ€§çš„æ–°ç±»WidgetTimer:private Timerï¼Œå³å¯åŒæ ·å¯ç”¨Timerä¸”éšè—äº†Timerã€‚ä»£ç å¦‚ä¸‹ï¼š class Widget{ private: class WidgetTimer:public Timer{// ç±»å†…åµŒå¥—å®šä¹‰ public: virtual void onTick() const; }; WidgetTimer wTimer_; }; â­â­ WidgetTimerä¹Ÿå¯ä»¥ä¸å®šä¹‰åœ¨Widgetç±»å†…,ç±»å†…åªæ”¾WidgetTimer* å’ŒWidgetTimerçš„å‰ç½®å£°æ˜ï¼Œå®Œå…¨è§£è€¦åˆï¼Œé™ä½ç¼–è¯‘ä¾èµ–æ€§ã€‚è€Œè¿™æ ·çš„è®¾è®¡è‡ªç”±åº¦æ˜¯å•çº¯çš„privateç»§æ‰¿ä¸å…·å¤‡çš„ã€‚ ç©ºç™½åŸºç±»æœ€ä¼˜åŒ–(EBO,empty base optimization) âš¡å€¼å¾—ä¸€æï¼šç©ºç±»(Empty Class)æ˜¯æŒ‡ä¸å«non-staticæ•°æ®æˆå‘˜å’Œvirtual-funcçš„ç±»ã€‚ ç©ºç±»çš„sizeä¼šè¢«C++å¼ºåˆ¶è¦æ±‚è‡³å°‘ä¸º1ï¼Œé€šå¸¸æ˜¯ç”¨1ä¸ªcharå ä½ã€‚å¦‚æœè®©Empty-Classä½œä¸ºæ•°æ®æˆå‘˜ï¼Œå› ä¸ºå†…å­˜å¯¹é½è€Œå¯¼è‡´Derived-Classæµªè´¹å†…å­˜ã€‚ ç¤ºä¾‹ä»£ç  ğŸ‘‡ï¼š class Empty { // ç©ºç±»ï¼Œ1å­—èŠ‚. ä¸å«non-staticæ•°æ®ï¼Œä¸å«virtual void privteFoo() { std::cout \u003c\u003c \"private non-virtual.\";} public: typedef char* pChar; typedef void(*pFuncReadData)(std::string url); enum class clolr { red,green,blue }; void foo() { std::cout \u003c\u003c \"public non-virtual!\"; } static int count ;//static æ•°æ®ä¹Ÿä¸å±äºclasså®ä½“ }; class HoldsIntsAndEmpty { //å†…å­˜å¯¹é½å12å­—èŠ‚ int x_; // 4å­—èŠ‚ Empty e_; // 1å­—èŠ‚ int y_; // 4å­—èŠ‚ }; class HoldsInts:private Empty {//ä½¿ç”¨EBO,ç±»å¤§å°8å­—èŠ‚ int x_;//4å­—èŠ‚ int y_;//4å­—èŠ‚ }; EBOä¼˜åŒ–å¯ä»¥å‡å°‘Derived-Classçš„å†…å­˜å¤§å°ï¼Œæ³¨æ„EBOåªé€‚ç”¨äºå•ç»§æ‰¿ã€‚ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:8","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"R40 æ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨å¤šé‡ç»§æ‰¿ å¤šé‡ç»§æ‰¿(multiple inheritance)æ˜¯æŒ‡ç»§æ‰¿ä¸€ä¸ªä»¥ä¸Šçš„çˆ¶ç±»ã€‚ä½†æ˜¯è¿™äº›çˆ¶ç±»åº”è¯¥é¿å…æ‹¥æœ‰å…±åŒçš„ç¥–çˆ¶ç±»ï¼Œä¼šå½¢æˆæ¯”è¾ƒéº»çƒ¦çš„â€œè±å½¢ç»§æ‰¿â€(æˆ–è€…å«é’»çŸ³ç»§æ‰¿)ã€‚ å¤šé‡ç»§æ‰¿çš„æˆæœ¬ä»¥åŠå‰¯ä½œç”¨ ä¸Šé¢è¯´â€œè±å½¢ç»§æ‰¿â€æ¯”è¾ƒéº»çƒ¦ï¼Œä¸»è¦åŸå› æ˜¯å¦‚æœç¥–çˆ¶ç±»å¦‚æœæ‹¥æœ‰æŸä¸ªæˆå‘˜å˜é‡xï¼Œé‚£ä¹ˆ2ä¸ªçˆ¶ç±»åˆ†åˆ«publicå½¢å¼ç»§æ‰¿äº†xï¼Œåˆ°äº†ç›®æ ‡å­ç±»å°±æœ‰äº†2ä»½xã€‚ è§£å†³é—®é¢˜çš„åŠæ³•æ˜¯è™šç»§æ‰¿(virtual inheritance)ï¼Œå¦‚æ­¤ï¼Œä¸Šè¿°å­ç±»åªæœ‰ä¸€ä»½xã€‚ä¸ºä¿è¯è™šç»§æ‰¿çš„æ­£ç¡®æ€§ï¼Œç¼–è¯‘å™¨åœ¨èƒŒåéœ€è¦ä»˜å‡ºæ›´å¤šä»£ä»·ï¼Œå¯èƒ½é€ æˆå­ç±»å†…å­˜æ›´å¤§æˆ–è¿è¡Œé€Ÿåº¦æ›´æ…¢ã€‚ ğŸ‘‰å¦‚æœå­˜åœ¨è±å½¢ç»§æ‰¿ï¼Œé‚£ä¹ˆç¥–çˆ¶ç±»å°½é‡ä¸è¦æŒæœ‰æ•°æ®æˆå‘˜ã€‚ è™šç»§æ‰¿ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š class File{...}; //ç¥–çˆ¶ç±»æœ€å¥½ä¸è¦æŒæœ‰non-staticæ•°æ®æˆå‘˜ class InputFile: virtual public File{...}; class OutputFile: virtual public File{...}; class IOFile:public InputFile,public OutputFile{...}; åº”ç”¨åœºæ™¯ï¼špublicç»§æ‰¿æ¥å£+privateç»§æ‰¿å®ç° æ€è€ƒè¿™æ ·çš„åº”ç”¨åœºæ™¯ï¼ŒPersonBaseç±»æ˜¯è™šåŸºç±»ï¼ŒRealPersonæ˜¯ç›®æ ‡å­ç±»ï¼ˆéœ€è¦ç»§æ‰¿æ¥å£ï¼‰ï¼Œä½†æ˜¯è·å–nameå’ŒbirthDateä¿¡æ¯çš„å‡½æ•°åœ¨å¦ä¸€ä¸ªPersonInfoç±»éƒ½æœ‰äº†ç°æˆçš„å®ç°ï¼ˆåªéœ€è¦ç®€å•ä¿®æ”¹è¯¥å®ç°ï¼‰ã€‚ ä¸¤è€…ç»“åˆåï¼Œå³è®©RealPersonç±»publicç»§æ‰¿äºPersonBaseï¼Œprivateç»§æ‰¿äºPersonInfoã€‚ class PersonBase { public: virtual ~PersonBase(){} virtual std::string name() const = 0; virtual std::string birthDate() const = 0; }; class PersonInfo { public: virtual ~PersonInfo() {} explicit PersonInfo(int pID):id_(pID) {} virtual const char* theName() const{ static char value[1024]; static const char* exampleName = \"Luka\";// è®¡ç®—è¿‡ç¨‹ç•¥,ç”¨å›ºå®šå­—ç¬¦ä¸²æ›¿ä»£ std::strcpy(value, valueDelimLeft()); // è·å–å·¦ç•Œå®šç¬¦ std::strcat(value, exampleName); std::strcat(value, valueDelimRight());// è·å–å³ç•Œå®šç¬¦ return value; } virtual const char* theBirthDate() const { return \"1990-1-1\"; } virtual const char* valueDelimLeft() const { return \"[\"; }; virtual const char* valueDelimRight() const { return \"]\"; }; private: int id_ = 0; }; å¤šé‡ç»§æ‰¿çš„ä»£ç ä¸ºğŸ‘‡: class RealPerson : public PersonBase, private PersonInfo {//å¤šé‡ç»§æ‰¿ public: explicit RealPerson(int pID) :PersonInfo(pID) {} // å§”æ‰˜æ„é€  virtual std::string name() const{ //å®ç°å¿…è¦çš„è™šåŸºç±»Personçš„pure-virtualæˆå‘˜å‡½æ•° return PersonInfo::theName(); } virtual std::string birthDate() const { return PersonInfo::theBirthDate(); } private: virtual const char* valueDelimLeft() const { return \"\"; };//é‡å†™ç•Œå®šç¬¦å‡½æ•° virtual const char* valueDelimRight() const { return \"\"; }; }; æœ€ååº”ç”¨ç«¯ä»£ç ï¼š RealPerson rPerson(613); std::cout \u003c\u003c rPerson.name(); //è¾“å‡ºLuka ,è€Œä¸æ˜¯[Luka] å¯ä»¥çœ‹åˆ°ï¼Œå¤šé‡ç»§æ‰¿ä½“ç³»å®Œç¾è§£å†³è¯¥é—®é¢˜ã€‚ å›åˆ°æœ¬èŠ‚å¼€å¤´ï¼Œæ˜æ™ºå’Œå®¡æ…çš„æ„æ€æ˜¯ğŸ‘‰å³ä½¿å¤šé‡ç»§æ‰¿å¯ä»¥ç”¨å•ç»§æ‰¿æ–¹æ¡ˆæ›¿ä»£è§£å†³ï¼Œæ€è€ƒåï¼Œå¦‚æœå¤šé‡ç»§æ‰¿ä¾ç„¶æ˜¯æœ€ç®€æ´ã€æœ€æ˜“ç»´æŠ¤ã€æœ€åˆç†çš„åšæ³•ï¼Œé‚£å°±é€‰æ‹©å®ƒã€‚ ref: [1]. https://blog.csdn.net/cltcj/category_12098441.html [2]. https://kissingfire123.github.io/2022/02/14_effective-c-%E4%B9%8B%E9%98%85%E8%AF%BB%E6%80%BB%E7%BB%93%E4%B8%89/ ","date":"2023-07-31","objectID":"/posts/effective_cpp_part_three/:2:9","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]","uri":"/posts/effective_cpp_part_three/"},{"categories":["C++"],"content":"å‰è¨€ Effective-C++æ€»ç»“ç³»åˆ—åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬äºŒéƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬3~4ç« ï¼Œå†…å®¹èŒƒå›´Rule13~25ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule13ç®€å†™ä¸ºR13ã€‚ Effective-C++ç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››) ç”±äºåŸä¹¦åœ¨C++11ä¹‹å‰å†™æˆï¼Œæœ‰äº›ç°ä»£C++ç‰¹æ€§ä¸ä¼šæåŠï¼Œæ‰€ä»¥ä¼šæ ¹æ®æœ¬äººå¼€å‘ç»éªŒæ–°å¢ä¸€äº›ä¸ªäººæ„Ÿæ‚ŸğŸ‘‰By the wayç¯èŠ‚ã€‚ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:0:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"CH3.èµ„æºç®¡ç† ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:1:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R13 ä»¥å¯¹è±¡ç®¡ç†èµ„æº ä¸ºé˜²æ­¢èµ„æºæ³„éœ²ï¼Œå°½é‡ä½¿ç”¨RAIIå¯¹è±¡(èµ„æºè·å–å³åˆå§‹åŒ–ï¼ŒResource Acquisition Is Initialization) å¦‚æœç”¨è€å¼çš„new-deleteç»„åˆæ‰‹åŠ¨ç®¡ç†èµ„æºï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼Œå¤„ç†ä»£ç ä¸­æœ‰å¤šå¤„return/breakä¹‹ç±»çš„åˆ†æ”¯è¯­å¥ï¼Œæ¯å¤„éƒ½æ‰‹åŠ¨æ·»åŠ deleteå›æ”¶èµ„æºéš¾å…ä¼šæœ‰é—æ¼é£é™©ã€‚ auto_ptr æœ¬ä¹¦æåŠçš„æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡std::auto_ptrå¯ä»¥åœ¨èµ„æºAåˆå§‹åŒ–åŒ–æ—¶æ¥ç®¡å¯¹è±¡Aï¼Œå¯¹è±¡è„±ç¦»ä½œç”¨åŸŸï¼Œææ„æ—¶é‡Šæ”¾æ¥ç®¡çš„Aã€‚ ä¸ºé¿å…é‡å¤åˆ é™¤èµ„æºï¼Œstd::auto_ptrç‰¹æ€§: é€šè¿‡copyæ„é€ å‡½æ•°æˆ–copy-assignmentæ“ä½œç¬¦ï¼Œæ“ä½œå®ƒä»¬ï¼Œå®ƒä»¬è‡ªèº«ä¼šå¤±å»èµ„æºæ‰€æœ‰æƒï¼Œå˜æˆNULL ï¼ shared_ptr ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œåæ¥æ¨å‡ºäº†å¼•ç”¨è®¡æ•°ç®¡ç†èµ„æºï¼Œå³RCSP(Reference-counting smart poiner)ï¼Œstd::shared_ptr ã€‚(ä¹¦ä¸­å½“æ—¶è¿˜æ˜¯tr1::shared_ptr)ç‰¹ç‚¹æ˜¯shared_ptråœ¨ä½¿ç”¨copyæ„é€ å‡½æ•°æˆ–copy-assignmentæ“ä½œç¬¦æ—¶ï¼Œä¸ä¼šå¤±å»èµ„æºæ‰€æœ‰æƒï¼Œè€Œæ˜¯è‡ªèº«å¼•ç”¨è®¡æ•°åŠ 1ã€‚ Note auto_ptrç›®å‰å·²ç»è¢«å¼ƒç”¨ï¼Œè½¬è€Œä½¿ç”¨ std::unique_ptræ¥æŒ‡æ¶‰ç‹¬å èµ„æºçš„æ™ºèƒ½æŒ‡é’ˆï¼Œä¸å¯è¢«å¤åˆ¶å’Œèµ‹å€¼ã€‚ shared_ptrå­˜åœ¨çš„é—®é¢˜æ˜¯ç¯å½¢å¾ªç¯åº”ç”¨ï¼Œäº’ç›¸æŒæœ‰å¯¹æ–¹ï¼Œåˆ™æ— æ³•é‡Šæ”¾ï¼Œé’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼Œéœ€è¦å¼•å…¥std::weak_ptræ¥ç ´å±€ã€‚ è¿™äº›æ™ºèƒ½æŒ‡é’ˆçš„å¤´æ–‡ä»¶æ”¯æŒï¼š#include å¸¸ç”¨çš„RAIIæ–¹å¼å­˜åœ¨çš„é—®é¢˜ ä¸Šè¿°çš„shared_ptræ˜¯ä¸æ”¯æŒæ•°ç»„èµ„æºçš„é‡Šæ”¾çš„ï¼Œåœ¨ææ„æ—¶é»˜è®¤è°ƒç”¨deleteï¼Œè€Œä¸æ˜¯delete[] ã€‚å¦‚æœè¦èƒ½é‡Šæ”¾ï¼Œéœ€è¦æ‰‹åŠ¨ä¼ å…¥ææ„å‡½æ•°ã€‚ std::shared_ptr\u003cInvestment\u003e instSpMan(new Investment[5], [](Investment* p) {delete[] p; }); // ä½¿ç”¨lamdaå‡½æ•°ï¼Œè¿˜å¯ä»¥ä¼ å…¥æ™®é€šå‡½æ•°æŒ‡é’ˆ std::shared_ptr\u003cInvestment[]\u003e instSp(new Investment[5]);// shared_ptré‡è½½äº†[] std::unique_ptr\u003cint[]\u003e intUp(new int[5]); // unique_ptré‡è½½äº†[] PS: é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœèƒ½ç”¨vectorä»£æ›¿çš„åœºæ™¯ï¼Œå°±ä¸éœ€è¦è¿™æ ·ä½¿ç”¨å¯¹è±¡æ•°ç»„ã€‚ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:1:1","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R14 åœ¨èµ„æºç®¡ç†ç±»ä¸­å°å¿ƒcopingè¡Œä¸º å¹¶éæ‰€æœ‰èµ„æºéƒ½æ˜¯å †ä¸Šç®¡ç†(heap-based)ï¼Œæ‰€ä»¥ä¹Ÿæœ‰æ™ºèƒ½æŒ‡é’ˆä¸é€‚åˆçš„åœºæ™¯ï¼Œè¿™æ—¶éœ€è¦è‡ªå·±å®ç°ä¸€ä¸ªèµ„æºç®¡ç†ç±»ã€‚ æ¯”å¦‚æœ‰ä¸ªç±»CMutex ï¼Œåªæœ‰2ä¸ªå‡½æ•°lockå’Œunlockï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªç®¡ç†ç±»CLockï¼Œæ¥ç®¡ç†Mutexç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š class CMutex {/*çœç•¥ç±»å®ç°*/}; void lock(CMutex *mtx) { std::cout \u003c\u003c \"has lock...\\n\";/*other operation...*/ } void unlock(CMutex *mtx) { std::cout \u003c\u003c \"release lock...\\n\";/*other operation...*/ } class CLock { public: explicit CLock(CMutex *mtx) :mtx_(mtx) { lock(mtx_); } ~CLock() { unlock(mtx_); } private: CMutex *mtx_; }; å¦‚æœæ¶‰åŠCLockçš„copingç›¸å…³å‡½æ•°ï¼Œé‚£ä¹ˆæœ‰ä»¥ä¸‹å‡ ç§é€‰æ‹©ï¼š ç¦æ­¢å¤åˆ¶ å‚è€ƒæœ¬ä¹¦Part1-Rule06ï¼Œç¦æ­¢copingå‡½æ•°çš„ç”Ÿæˆã€‚ å¯¹åº•å±‚èµ„æºä½¿ç”¨â€œå¼•ç”¨è®¡æ•°æ³•â€ ä»¥shared_pträ»£æ›¿è£¸æŒ‡é’ˆï¼Œå¹¶ä¸”ä¼ å…¥unlockå‡½æ•°ä½œä¸ºè¯¥æŒ‡é’ˆçš„â€œåˆ é™¤å™¨â€ã€‚ å¤åˆ¶åº•éƒ¨èµ„æº å³â€œæ·±åº¦æ‹·è´â€ï¼Œå¤åˆ¶èµ„æºç®¡ç†å¯¹è±¡æ—¶ï¼ŒåŒæ—¶å¤åˆ¶å…¶åŒ…è£¹çš„èµ„æºã€‚ è½¬ç§»åº•éƒ¨èµ„æºæ‰€æœ‰æƒ å³æµ…å¤åˆ¶ï¼Œä¸æ‹·è´åŒ…è£¹çš„èµ„æºï¼Œè€Œæ˜¯è½¬ç§»æ‰€æœ‰æƒï¼Œå’Œå‰æ–‡æåˆ°çš„auto_ptréå¸¸å¥‘åˆã€‚ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:1:2","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R15 åœ¨èµ„æºç®¡ç†ç±»ä¸­æä¾›å¯¹åŸå§‹èµ„æºçš„è®¿é—® æ™ºèƒ½æŒ‡é’ˆauto_ptr, unique_ptr, shared_ptréƒ½æä¾›äº†æ¥å£è®¿é—®åŸå§‹èµ„æºï¼Œæ–¹æ³•åç§°ä¸ºget()ï¼Œå¯¹ç±»Aèµ„æºå¾—åˆ°è£¸æŒ‡é’ˆA*ã€‚ æ™ºèƒ½æŒ‡é’ˆä¹Ÿé‡è½½äº†æ“ä½œç¬¦operator -\u003e å’Œ operator * ï¼Œè®¿é—®ç±»æˆå‘˜å‡½æ•°éƒ½å¯ä»¥åƒæ™®é€šæŒ‡é’ˆé‚£æ ·ä½¿ç”¨ã€‚ å¦‚æœè‡ªè¡Œè®¾è®¡èµ„æºç®¡ç†ç±»ï¼Œä¹Ÿè¦åƒä¸Šè¿°çš„æ™ºèƒ½æŒ‡é’ˆé‚£æ ·ï¼Œåšåˆ°èƒ½å¤Ÿè½»æ¾è®¿é—®åŸå§‹èµ„æºã€‚ æŸäº›æƒ…å†µï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨getæˆå‘˜å‡½æ•°æ˜¾å¼è½¬æ¢ï¼Œè½¬è€Œä½¿ç”¨éšå¼ç±»å‹è½¬æ¢ï¼Œæ–¹ä¾¿å®¢æˆ·è°ƒç”¨: class Font{ public: // éšå¼è½¬æ¢ operator FontHandle() const{ return f;} // æ˜¾å¼è½¬æ¢ FontHandle get() const { return f;} private: FontHandle f; } ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:1:3","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R16 æˆå¯¹ä½¿ç”¨newå’Œdeleteæ—¶è¦é‡‡å–ç›¸åŒå½¢å¼ å…ˆçœ‹ä¸€æ®µé”™è¯¯ä»£ç ï¼š std::string *stringArray = new std::string[100]; delete stringArray;// undefined behavior,æœªå®šä¹‰è¡Œä¸ºï¼›æœ‰å¯èƒ½åªåˆ é™¤äº†ç¬¬ä¸€ä¸ªå…ƒç´  æ³¨æ„ new å’Œ deleteå¯¹åº” new[] å’Œ delete[]å¯¹åº” ä¸å¯é—æ¼æˆ–è€…äº¤å‰é”™é…ï¼ ç®€å•æ¢ç©¶ delete[]çš„åŸç†ï¼šå®é™…ä¸Šï¼Œåœ¨ç¼–è¯‘å™¨çš„å®ç°ä¸­ï¼Œå¯¹è±¡æ•°ç»„çš„èµ·å§‹å†…å­˜ä¼šå­˜æ”¾â€œæ•°ç»„é•¿åº¦â€è¿™ä¸€å˜é‡ï¼Œä»¥ä¾¿å‘ŠçŸ¥delete[]åº”è¯¥è°ƒç”¨å¤šå°‘æ¬¡ææ„ï¼Œåˆ é™¤å¤šå°‘èµ„æºã€‚ ğŸ‘‰ è°¨æ…å¯¹æ•°ç»„ä½¿ç”¨typedefï¼Œå®¹æ˜“äº§ç”Ÿnew-deleteçš„åŒ¹é…è¯¯è§£ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š typedef std::string AddressLines[4]; std::string *pal = new AddressLines;//æ³¨æ„ï¼šè¿™é‡Œå…¶å®å°±æ˜¯ new string[4] delete pal; // è¡Œä¸ºæœªå®šä¹‰ï¼ï¼ delete [] pal; // æ­£è§£ï¼ // è¿™é‡Œå»ºè®®çš„æ›¿ä»£æ–¹æ³•ï¼švector\u003cstring\u003e ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:1:4","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R17 ä»¥ç‹¬ç«‹è¯­å¥å°†newedå¯¹è±¡ç½®å…¥æ™ºèƒ½æŒ‡é’ˆ ä¸è¦å°†ç”³è¯·èµ„æºçš„newè¯­å¥ç›´æ¥å½“ä½œå‡½æ•°å…¥å‚ï¼Œè€Œæ˜¯åº”è¯¥å…ˆä»¥å•ç‹¬è¯­å¥ç”³è¯·åä¼ å…¥ã€‚ è€ƒè™‘ä¸‹è¿°é—®é¢˜ä»£ç ï¼š int priority(); void processWidget(std::shared_ptr\u003cWidget\u003e pw,int pri); //å‡½æ•°è°ƒç”¨ processWidget(std::shared_ptr\u003cWidget\u003e(new Widget),priority()); ä¸Šè¿°ä»£ç ç¬¬4è¡Œï¼Œåœ¨processWidgetå‡½æ•°ä½“æ‰§è¡Œä¹‹å‰ï¼Œè‡³å°‘æœ‰3ä¸ªæ­¥éª¤(å¹¶éä¸¥æ ¼æ¬¡åº)ï¼š æ‰§è¡Œ\"new Widget\" è°ƒç”¨std::shared_ptrçš„æ„é€ å‡½æ•° è°ƒç”¨priorityå‡½æ•° C++ç¼–è¯‘å™¨èƒ½ä¿è¯1-\u003e2çš„æ¬¡åº(2éœ€è¦1åšå…¥å‚)ï¼Œä½†æ˜¯æ— æ³•ä¿è¯3çš„æ¬¡åºä¸åœ¨1ï¼Œ2ä¹‹é—´ï¼Œå¦‚æœæ­¥éª¤3æŠ›å‡ºå¼‚å¸¸ï¼Œå°†ä¼šç›´æ¥å¯¼è‡´å†…å­˜æ³„æ¼ã€‚æ­£ç¡®ç¤ºä¾‹å¦‚ä¸‹ï¼š std::shared_ptr\u003cWidget\u003e pw(new Widget); processWidget(pw,priority()); ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:1:5","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"CH4.è®¾è®¡ä¸å£°æ˜ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:2:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R18 è®©æ¥å£å®¹æ˜“è¢«æ­£ç¡®ä½¿ç”¨ï¼Œä¸æ˜“è¢«è¯¯ç”¨ è¦æƒ³è®¾è®¡ä¸€ä¸ªä¸å®¹æ˜“è¯¯ç”¨çš„æ¥å£ï¼Œå°±è¦å…ˆè€ƒè™‘ä½¿ç”¨è€…å¯èƒ½çŠ¯ä»€ä¹ˆé”™è¯¯ã€‚ é¿å…â€œæ¥å£è¯¯ç”¨â€ï¼Œå¯ä»¥å¯¼å…¥æ–°ç±»å‹è¿›è¡Œé™åˆ¶ æ¯”å¦‚è®¾è®¡ä¸€ä¸ªDateç±»ï¼Œå‚æ•°ä¼ é€’å°±å¯èƒ½å‡ºé”™ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š class Date{ public: Date(int month,int day,int year); }; å®é™…ä½¿ç”¨æ—¶ï¼Œä½¿ç”¨è€…å¯èƒ½å†™å‡ºDate date(30,4,2021);è¿™æ ·çš„é”™è¯¯ä»£ç ï¼Œå¦‚ä½•é˜²èŒƒå‘¢ï¼Ÿ æ–¹æ³•ä¹‹ä¸€ï¼šå°è£…å‡ºMonth,Day,Yearè¿™3ä¸ªStruct/Classï¼Œä½œä¸ºå‚æ•°å…¥å‚ï¼Œå¹¶æ·»åŠ æœˆä»½é™åˆ¶ï¼Œä»£ç ï¼š class Month{ public: static Month Jan() { return Month(1);} // ...çœç•¥å…¶ä»–11ä¸ªæœˆä»½ private: int val; explicit Month(int m):val(m){} //å¯è¢«class-staticè°ƒç”¨ï¼Œä¸èƒ½è¢«å¤–éƒ¨è°ƒç”¨ }; struct Day {explicit Day(int d) :day(d){} int day; }; //çœç•¥ struct Yearå®šä¹‰ï¼Œå’ŒDayç±»ä¼¼ class Date{ public: Date(const Month\u0026 month,const Day\u0026 day,const Year\u0026 year){} }; æœ€ç»ˆå®¢æˆ·ä»£ç ä½¿ç”¨çš„æƒ…å†µå¦‚ä¸‹ï¼š Date date(Month::Jan(),Day(13),Year(2022)); By the way C++11 æ”¯æŒå¯¹æšä¸¾çš„å¼ºåŒ–ï¼Œå³ç±»å‹å®‰å…¨çš„`enum class`ï¼Œå®ƒä¸èƒ½éšå¼åœ°è½¬æ¢ä¸ºæ•´æ•°ï¼›ä¹Ÿæ— æ³•ä¸æ•´æ•°æ•°å€¼åšæ¯”è¾ƒã€‚æ­¤å¤„å¯ä»¥è€ƒè™‘å®šä¹‰ä¸€ä¸ªMonthEmæ¥ä»£æ›¿Monthï¼š ```c++ enum class MonthEm { Jan = 1, Feb = 2, //... çœç•¥å…¶å®ƒçš„æœˆä»½å®šä¹‰ }; // ä¿®æ”¹Dateçš„æ„é€ å‡½æ•°ï¼ŒMonthEmæ¥ä»£æ›¿Month Date(const MonthEm\u0026 monthEm, const Day\u0026 day, const Year\u0026 year) {} // æ„é€ å¯¹è±¡ Date date2(MonthEm::Feb, Day(23), Year(2021)); ``` é™åˆ¶ç±»å‹å†…ä»€ä¹ˆäº‹æ˜¯å¯ä¸å¯åšçš„ å¸¸è§æ“ä½œæ˜¯åŠ ä¸Šconsté™åˆ¶ï¼Œæ¯”å¦‚â€œä»¥const ä¿®é¥°operator * çš„è¿”å›ç±»å‹â€å¯ä»¥é˜»æ­¢è¿™ä¸ªé”™è¯¯ï¼š //æœ¬æ„æ˜¯æƒ³åšæ¯”è¾ƒï¼Œå†™æˆäº†èµ‹å€¼ï¼Œä½†æ˜¯èµ‹ç»™constï¼ŒæŠ¥é”™ï¼ if (a * b = c) æ™ºèƒ½æŒ‡é’ˆä¼ å…¥åˆ é™¤å™¨å¯é¿å…\"Cross-dll-problem\" std::shared_ptrç®¡ç†èµ„æºæ—¶ï¼Œä¼ å…¥åˆ é™¤å™¨ï¼Œå¯é¿å…åœ¨A-Dllä¸­newï¼Œç»“æœåœ¨å¦ä¸€ä¸ªB-Dllä¸­deleteçš„æƒ…å†µï¼Œè¿™ä¼šå¯¼è‡´Runtime-Errorã€‚ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:2:1","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R19 è®¾è®¡ClassçŠ¹å¦‚è®¾è®¡Type è®¾è®¡ä¸€ä¸ªä¼˜ç§€çš„Classå¹¶ä¸å®¹æ˜“ï¼Œå¾ˆå¤šC++ä¹¦ç±éƒ½åƒæœ¬ä¹¦ä¸€æ ·æåˆ°â€œCheck-Tableâ€ï¼Œè®¾è®¡Class/Typeå‰ï¼Œé—®è‡ªå·±ä¸€äº›é‡è¦é—®é¢˜ï¼š æ–°typeçš„å¯¹è±¡åº”è¯¥å¦‚ä½•è¢«åˆ›å»ºå’Œé”€æ¯ï¼Ÿ å¯¹è±¡çš„åˆå§‹åŒ–å’Œèµ‹å€¼è¯¥æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ æ–°typeçš„å¯¹è±¡å¦‚æœå€¼ä¼ é€’(pass-by-value)ï¼Œæ„å‘³ç€ä»€ä¹ˆï¼Ÿ copyæ„é€ å‡½æ•°ç”¨æ¥å®šä¹‰ä¸€ä¸ªtypeçš„å€¼ä¼ é€’å…·ä½“å®ç°ã€‚ ä»€ä¹ˆæ˜¯æ–°typeçš„â€œåˆæ³•å€¼â€ï¼Ÿ æƒ³æ¸…æ¥šçº¦æŸæ¡ä»¶ï¼Œç‰¹åˆ«æ˜¯æ„é€ å‡½æ•°ã€èµ‹å€¼æ“ä½œç¬¦ä»¥åŠsetterå‡½æ•°ï¼Œæ¶‰åŠçš„é”™è¯¯æ£€æŸ¥ä¸éæ³•å€¼æ‹¦æˆªã€‚ æ–°typeéœ€è¦é…åˆæŸä¸ªç»§æ‰¿å›¾è°±å—ï¼Ÿ å¦‚æœç»§æ‰¿è‡ªæŸBaseç±»ï¼Œé‚£ä¹ˆå°±ä¼šæ”¶åˆ°virtual,non-virtualå‡½æ•°çš„çº¦æŸï¼›å¦‚æœè¦åšåç»­ç±»çš„åŸºç±»ï¼Œåˆ™è¯¥typeå°±è¦æ³¨æ„è™šææ„çš„è®¾è®¡ã€‚ æ–°typeæ¶‰åŠä»€ä¹ˆæ ·çš„è½¬æ¢ï¼Ÿ ä¸å…¶ä»–typeä¹‹é—´å¦‚æœ‰è½¬æ¢éœ€æ±‚ï¼Œåˆ™éœ€è¦è‡ªè¡Œå®ç°ç›¸å…³å‡½æ•°ï¼Œå¯å‚è€ƒRule15ã€‚ æ–°typeéœ€è¦æ€æ ·çš„æ“ä½œç¬¦å’Œå‡½æ•°ï¼Ÿ ç¡®å®šå“ªäº›æ˜¯memberå‡½æ•°ï¼Œå“ªäº›ä¸æ˜¯ã€‚å‚è€ƒRule23ï¼ŒRule24ï¼ŒRule26ã€‚ æ˜¯å¦æœ‰éœ€è¦ç«‹å³é©³å›çš„æ ‡å‡†å‡½æ•°ï¼Ÿ æ¯”å¦‚æ˜¯å¦ç¦æ­¢copyæ„é€ ï¼Œcopy-assignmentæ“ä½œç¬¦ç­‰å‡½æ•°ï¼Œå¯ä»¥å£°æ˜ä¸ºprivateï¼›æˆ–è€…ä½¿ç”¨C++æ–°ç‰¹æ€§\"=delete\"ã€‚å‚è€ƒRule6ã€‚ æ–°typeæˆå‘˜çš„è®¿é—®å±æ€§æ§åˆ¶ï¼Ÿ æˆå‘˜å˜é‡éƒ½åº”ä¸ºprivateï¼Œè€ƒè™‘å…¶ä»–memberå‡½æ•°è¯¥ä¸ºprivate/public/protectedã€‚ä»¥åŠå¯ç”¨å‹å…ƒfriendçš„è€ƒè™‘ã€‚ ä»€ä¹ˆæ˜¯æ–°typeçš„â€œæœªå£°æ˜æ¥å£â€? å‚è€ƒRule29ã€‚ æ–°typeæœ‰å¤šä¹ˆä¸€èˆ¬åŒ–ï¼Ÿ å¦‚æœæ˜¯ä¸€èˆ¬åŒ–çš„é—®é¢˜å¤„ç†ï¼Œè¯¥è€ƒè™‘æ˜¯å¦è¯¥å®šä¹‰Class-Templateã€‚ çœŸçš„éœ€è¦ä¸€ä¸ªæ–°typeå—ï¼Ÿ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:2:2","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R20 ä»¥pass-by-reference-to-constä»£æ›¿pass-by-value å°½é‡ä»¥pass-by-reference-to-constä»£æ›¿pass-by-value å‰è€…é€šå¸¸æ›´é«˜æ•ˆï¼Œå¹¶å¯é¿å…â€œå¯¹è±¡åˆ‡å‰²â€é—®é¢˜ã€‚ å¦‚æœå¯¹è±¡å…¥å‚ä»¥å€¼ä¼ é€’ï¼Œå°±ä¼šåœ¨å…¥å‚æ—¶åˆ›å»ºä¸´æ—¶å¯¹è±¡ï¼Œå‡½æ•°å®Œæˆåä¸´æ—¶å¯¹è±¡ææ„ï¼Œæ¶‰åŠæ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„è°ƒç”¨ï¼Œè¿™äº›éƒ½å¯èƒ½æ˜¯ä¸å°çš„å¼€é”€ï¼ å¦‚æœæ˜¯ä»¥const referenceå½¢å¼ï¼Œåˆ™ä¸ä¼šæœ‰ä»»ä½•æ„é€ /ææ„çš„å¼€é”€ã€‚constçš„ä½œç”¨æ˜¯è®©ä½¿ç”¨è€…æ”¾å¿ƒï¼Œä¸ä¼šæ”¹å˜å…¥å‚çš„å€¼ã€‚ â€œå¯¹è±¡åˆ‡å‰²\"é—®é¢˜ï¼š å¦‚æœæ˜¯å€¼ä¼ é€’ï¼ŒDerived-Objä¼ é€’ç»™Base-Paramï¼Œä¼šä¸¢å¤±Derivedç‹¬æœ‰çš„ç‰¹æ€§ï¼Œåªä¿ç•™Baseçš„é‚£éƒ¨åˆ†ã€‚ å¯¹äºC++å†…ç½®ç±»å‹ï¼Œå€¼ä¼ é€’å¾€å¾€æ›´é«˜æ•ˆ ä»C++ç¼–è¯‘å™¨çš„åº•å±‚å®ç°è§’åº¦æ¥çœ‹ï¼Œreferenceså¼•ç”¨å¾€å¾€æ˜¯ä»¥æŒ‡é’ˆçš„å½¢å¼å®ç°ã€‚æ‰€ä»¥å¦‚æœæ˜¯å†…ç½®æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚intç±»å‹ ï¼Œç›´æ¥å€¼ä¼ é€’åè€Œæ•ˆç‡æ›´é«˜ã€‚ æ­¤è§„åˆ™è¿˜é€‚ç”¨äºSTLè¿­ä»£å™¨å’Œå‡½æ•°å¯¹è±¡ã€‚ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:2:3","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R21 å¿…é¡»è¿”å›å¯¹è±¡æ—¶ï¼Œä¸è¦éšæ„è¿”å›reference ä¸è¦è¿”å›æŒ‡é’ˆæˆ–å¼•ç”¨æŒ‡å‘ä»¥ä¸‹å¯¹è±¡: å±€éƒ¨æ ˆå¯¹è±¡(local stack) å‡½æ•°å†…éƒ¨æ–°å»ºçš„æ ˆå˜é‡å¯¹è±¡ï¼Œå‡ºäº†å‡½æ•°å°±é¢ä¸´æ¶ˆäº¡ï¼Œä»æŒæœ‰å®ƒçš„å¼•ç”¨/æŒ‡é’ˆï¼Œæ˜¯å…¸å‹çš„æœªå®šä¹‰è¡Œä¸ºã€‚ å †åˆ†é…å¯¹è±¡(heap allocated) å†…éƒ¨newï¼Œç„¶åreturnå‡ºå»ä½¿ç”¨ï¼Œä¸€æ¥ä¼šå¢åŠ å¤–éƒ¨deleteçš„è´Ÿæ‹…ï¼ŒäºŒæ¥å¯èƒ½deleteçš„æœºä¼šéƒ½æ²¡æœ‰ã€‚ä»£ç å¦‚ä¸‹ï¼š const Rational\u0026 operator*(const Rational\u0026 lhs, const Rational\u0026 rhs){ Rational *result = new Rational(lhs.n * rhs.n,lhs.d * rhs.d); return *result; } // å¦‚ä¸‹ä½¿ç”¨è¿ä¹˜ï¼Œåˆ™æ²¡æœ‰deleteçš„æœºä¼š Rational w,x,y,z; w = x * y * z; // å†…å­˜æ³„æ¼ï¼ï¼ï¼ ä¸Šè¿°ä»£ç è¿”å›çš„æ˜¯å¼•ç”¨ï¼Œè¿”å›æŒ‡é’ˆä¹Ÿæ˜¯ä¸€æ ·çš„è´Ÿä½œç”¨ã€‚ å±€éƒ¨staticå¯¹è±¡(local static) å‡½æ•°å†…éƒ¨çš„staticå¯¹è±¡ï¼Œåªåˆå§‹åŒ–ä¸€æ¬¡ï¼Œä¸”åªæœ‰ä¸€ä»½ï¼Œæœ‰è®°å¿†åŠŸèƒ½ï¼Œå¯ä»¥è¢«æ›´æ–°ã€‚é‚£ä¹ˆä¸‹è¿°ä»£ç å°±ä¼šå‡ºç°é—®é¢˜ï¼š const Rational\u0026 operator*(const Rational\u0026 lhs,const Rational\u0026 rhs){ static Rational result; result = Rational(lhs.n * rhs.n,lhs.d * rhs.d) return result; //åœ¨è°ƒç”¨è€…çœ‹æ¥ï¼Œå› ä¸ºæ˜¯å¼•ç”¨ï¼Œæ°¸è¿œåªçœ‹åˆ°ç‹¬ä¸€ä»½çš„resultçš„â€œæœ€æ–°å€¼ â€ } // ä¸‹æ–¹çš„æ¯”è¾ƒæ°¸è¿œéƒ½æ˜¯trueï¼Œæ°¸è¿œèµ°ifåˆ†æ”¯ ï¼ï¼ Rational a,b,c,d; if((a*b) == (c*d)){ //ä¹˜ç§¯ç›¸ç­‰ï¼Œèµ°ifåˆ†æ”¯ }else{ //ä¹˜ç§¯ä¸ç›¸ç­‰ï¼Œèµ°elseåˆ†æ”¯ } Tips é‚£æ˜¯ä¸æ˜¯æ°¸è¿œä¸èƒ½ä»¥referenceä½œä¸ºè¿”å›å€¼å‘¢ ï¼Ÿ å½“ç„¶ä¸æ˜¯ï¼Œ*thiså¯ä»¥è¿”å›å…¶å¼•ç”¨ï¼Œå‚è€ƒRule10ï¼›æˆ–è€…ç±»æˆå‘˜ä½œä¸ºè¿”å›å€¼æ—¶ï¼Œå¯ä»¥è¿”å›å…¶å¼•ç”¨ï¼Œä½†æœ€å¥½æ˜¯constã€‚ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:2:4","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R22 å°†æˆå‘˜å˜é‡å£°æ˜ä¸ºprivate æˆå‘˜å˜é‡ä¸ºprivateè·å¾—çš„å¥½å¤„ å®¢æˆ·è®¿é—®æ•°æ®çš„ä¸€è‡´æ€§ã€‚éƒ½æ˜¯ç”¨getterå‡½æ•°ï¼ˆéœ€è¦åŠ æ‹¬å·ï¼‰ï¼Œè€Œä¸æ˜¯æ··ç”¨å‡½æ•°è·å–å’Œç›´æ¥è®¿é—®ï¼› ç»†åŒ–æˆå‘˜å˜é‡çš„è®¿é—®æƒé™ã€‚æ ¹æ®æ˜¯å¦æœ‰getterã€setterå‡½æ•°å¯ä»¥ç²¾å‡†æ§åˆ¶read/write/noneè¿™æ ·çš„ç»†åŒ–ã€‚ ä¿æŒå®ç°å¼¹æ€§ã€‚æ¯”å¦‚è·å–æŸç³»ç»ŸæŒ‡æ ‡ï¼Œå¯ä»¥åœ¨getterå‡½æ•°ä¸­ä¿®æ”¹å„ç§çµæ´»çš„ç­–ç•¥å’Œç®—æ³•ï¼Œè€Œè°ƒç”¨è€…æ„ŸçŸ¥ä¸åˆ°ã€‚ å°è£…æ€§ã€‚å°è£…æ€§æ˜¯æŒ‡â˜ è¶Šå¤šå‡½æ•°å¯ä»¥è®¿é—®è¯¥æ•°æ®ï¼Œå°è£…æ€§è¶Šä½ã€‚ å®¢æˆ·è°ƒç”¨ç«¯æ„ŸçŸ¥ä¸åˆ°classå†…éƒ¨çš„å®ç°ï¼Œè¿™äº›ç¡®å®ä¹Ÿæ˜¯ä¸å¿…æš´éœ²çš„ã€‚å¹¶ä¸”ï¼Œå¦‚æœæ˜¯è¦ä¿®æ”¹æŸä¸ªå˜é‡ï¼Œä½¿ç”¨setterå‡½æ•°ä¹Ÿæ›´æ–¹ä¾¿è°ƒè¯•ï¼Œä¸è‡³äºè¢«éšæ„ä¿®æ”¹ã€‚ protectedå’Œpublicå·®ä¸å¤šï¼Œéƒ½ä¸å…·å¤‡å°è£…æ€§ å¦‚æœæŸä¸ªpublic/protectedå˜é‡æƒé™è¢«å–æ¶ˆï¼ˆæ¯”å¦‚æ”¹ä¸ºprivateï¼‰ï¼Œå°†ä¼šå¯¼è‡´å¤§é¢ç§¯çš„ç¼–è¯‘é”™è¯¯ï¼Œèƒ½è®¿é—®çš„å˜æˆunaccessibleï¼Œéœ€è¦å¯¹åº”ä¿®æ”¹è®¸å¤šä»£ç ã€‚ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:2:5","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R23 å®å¯ç”¨non-member,non-friendä»£æ›¿memberå‡½æ•° å®é™…ä¸Šï¼Œnon-member/non-friendå‡½æ•°å…·æœ‰æ›´å¤§çš„å°è£…æ€§ è€ƒè™‘ä¸‹è¿°ä¸€ä¸ªç±»WebBrowserï¼Œmemberå‡½æ•°å’Œnon-memberå‡½æ•°ï¼Œå®é™…ä¸Šï¼Œmemberå‡½æ•°WebBrowser::clearEverythingå…·æœ‰å…¶ä»–privateæ•°æ®çš„è®¿é—®æƒé™ï¼Œå°è£…æ€§æ˜¯æ›´å·®çš„ï¼ class WebBrowser { public: void clearCache() {/*to clear cache*/} void clearHistory() {/*to clear history*/} void removeCookies() {/*to clear cookies*/} void clearEverything() { clearCache(); clearHistory(); removeCookies();} }; void clearBrowser(WebBrowser \u0026wb) { wb.clearCache(); wb.clearHistory(); wb.removeCookies(); } å·¥ç¨‹ç»“æ„å®‰æ’ å¯¹äºä¸Šè¿°WebBrowserçš„ä¾‹å­ï¼Œnon-memberå‡½æ•°æ”¾å“ªé‡Œå‘¢ï¼Œé™¤äº†å¯ä»¥æ˜¯å…¶ä»–classçš„memberå‡½æ•°ï¼Œæ›´é€‚ç”¨è‡ªç„¶çš„ç­”æ¡ˆæ˜¯ç”¨namespaceåŒ…è£¹èµ·æ¥ã€‚ä»£ç å¦‚ä¸‹ï¼š namespace WebBrowserStuff{ class WebBrowser {}; void clearBrowser(WebBrowser \u0026wb); } æ³¨æ„ï¼šnamespaceå¯ä»¥è·¨è¶Šå¤šä¸ªæºç æ–‡ä»¶ï¼Œè€Œclassä¸èƒ½ã€‚ é€šå¸¸çš„ç»„ç»‡æ–¹å¼ï¼šå¤šä¸ª.hå¤´æ–‡ä»¶éƒ½ä½¿ç”¨åŒä¸€ä¸ªnamespaceï¼Œç®¡ç†ä¸åŒçš„åŠŸèƒ½æ¨¡å—ã€‚é™¤äº†è®©æ¨¡å—æ›´æ¸…æ™°ï¼Œè¿˜èƒ½é™ä½ä¸å¿…è¦çš„ç¼–è¯‘ä¾èµ–å…³ç³»ã€‚ å¯¹äºprivateæ•°æ®ï¼Œmemberå’Œfriendå‡½æ•°å…·æœ‰ç›¸åŒçš„è®¿é—®æƒé™ åŸºäºæ­¤ï¼Œè¿™é‡Œè®¨è®ºçš„å°è£…æ€§ä¸åœ¨äºmemberä¸å¦ï¼Œè€Œæ˜¯memberå’Œnon-member ï¼Œnon-friendå‡½æ•°ä¹‹é—´ã€‚ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:2:6","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R24 è‹¥æ‰€æœ‰å‚æ•°çš†éœ€ç±»å‹è½¬æ¢ï¼Œè¯·é‡‡ç”¨non-member æ ‡é¢˜éœ€æ˜æ™°ï¼šæ‰€æœ‰å‚æ•°ï¼Œæ˜¯æŒ‡åŒ…å«äº†è¢«thisæŒ‡é’ˆæ‰€æŒ‡å‘çš„é‚£ä¸ªéšå«å‚æ•°ï¼ˆnon-explicitæ„é€ å‡½æ•°è°ƒç”¨éšå¼ç±»å‹è½¬æ¢æ—¶ï¼‰ã€‚ åº”å¯¹å…·ä½“åœºæ™¯ï¼šæ„é€ å‡½æ•°å…è®¸éšå¼ç±»å‹è½¬æ¢ï¼Œä¸”éœ€è¦è¿™ä¸ªæ„é€ å¥½çš„å¯¹è±¡ç«‹å³è°ƒç”¨æŸmemberå‡½æ•°foo(æ¯”å¦‚operatorå‡½æ•°)ï¼Œæ­¤æ—¶è¿™ä¸ªfooå‡½æ•°åº”è¯¥æ”¹ä¸ºnon-memberçš„fooå‡½æ•°ã€‚ è€ƒè™‘ä¸€ä¸ªæœ‰ç†æ•°ç±»Rationalï¼Œå…è®¸éšå¼ç±»å‹è½¬æ¢æ„é€ ï¼ˆå³non-explicitï¼‰ï¼Œå¦‚æœoperator*æ˜¯memberå‡½æ•°åˆ™ä¼šå‡ºç°é—®é¢˜ã€‚Rationalç±»å®ç°ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š class Rational { public: Rational(int numerator = 0, int denominator = 1) :numerator_(numerator), denominator_(denominator) {} const Rational operator* (const Rational\u0026 rhs)const { return Rational(numerator_*rhs.numerator_, denominator_*rhs.denominator_); } int numerator()const { return numerator_; } int denominator()const { return denominator_; } private: int numerator_ = 0; int denominator_ = 1; }; ä¸Šè¿°ä»£ç å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸èƒ½æ··åˆè¿ç®—ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š Rational rat(2, 5); Rational rat3Tm = rat * 3; //èƒ½æˆåŠŸè°ƒç”¨member-operator* Rational rat3Tm2 = 3 * rat; //ç¼–è¯‘æŠ¥é”™ï¼ï¼ï¼ æœ¬èŠ‚çš„åœºæ™¯å°±åœ¨äºæ­¤. å¦‚æœè¦è®©è¿™ç§æ··åˆè¿ç®—æ— éšœç¢ï¼ŒæŠŠoperator*å‡½æ•°æ”¹æˆnon-memberå³å¯ï¼Œæ³¨æ„è¦åˆ æ‰åŸæ¥memberå†…çš„operator*ï¼Œä¸èƒ½åŒæ—¶å­˜åœ¨è¿™2ä¸ªoperator*ã€‚ class Rational { //... æ³¨æ„ï¼Œè¦åˆ é™¤ç±»å†…çš„memberå‡½æ•°operator* }; const Rational operator* (const Rational\u0026 lhs, const Rational\u0026 rhs) { return Rational(lhs.numerator() * rhs.numerator(), lhs.denominator() * rhs.denominator()); } ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:2:7","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"R25 è€ƒè™‘å†™ä¸€ä¸ªä¸æŠ›å¼‚å¸¸çš„swapå‡½æ•° å½“ std::swapå¯¹æŸä¸ªç±»å‹æ•ˆç‡ä¸é«˜æ—¶ï¼Œæä¾›ä¸€ä¸ªswapæˆå‘˜å‡½æ•°ï¼Œä¸”è¯¥swapä¸æŠ›å¼‚å¸¸ å…ˆçœ‹ä¸€ä¸‹æ•ˆç‡ä¸é«˜çš„std::swapå®ç°ï¼š namespace std { template\u003ctypename T\u003e //std::swapçš„å…¸å‹å®ç° void swap(T\u0026 a,T\u0026 b) { //ç½®æ¢ a å’Œ b çš„å€¼ T temp(a); //è‹¥Tæ˜¯classï¼Œæ­¤å¤„è°ƒç”¨copyæ„é€ å‡½æ•° a = b; //è‹¥Tæ˜¯classï¼Œæ­¤å¤„è°ƒç”¨copy assignmentæ“ä½œç¬¦ b = temp; } } è€ƒè™‘è¿™æ ·çš„ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦swapä¸€ä¸ª\"pimplæ‰‹æ³•â€(pointer to implementation)å®ç°çš„ç±»ï¼Œè¿™ç§ä¼ ç»Ÿçš„std::swapå¿…ç„¶æ˜¯æ•ˆç‡ä¸é«˜(æ·±å¤åˆ¶implç±»çš„æ•°æ®è€—æ—¶è¾ƒé•¿)ã€‚ class WidgetSwImpl { private: int a, b, c; std::vector\u003cdouble\u003e v; //å¾ˆå¤§çš„vector,æ„å‘³ç€å¤åˆ¶æ—¶é—´å¾ˆé•¿ }; class WidgetSw { public: WidgetSw(WidgetSwImpl* pImpl) :pImpl_(pImpl) {} WidgetSw(const WidgetSw\u0026 rhs) {/*å…¶ä»–copy\u0026initialæ“ä½œ*/} WidgetSw\u0026 operator=(const WidgetSw\u0026 rhs) { *pImpl_ = *(rhs.pImpl_); } void swap(WidgetSw\u0026 other) { //public-memberå‡½æ•°swap using std::swap; //ä»¤std::swapåœ¨æ­¤å‡½æ•°å¯ç”¨ swap(pImpl_,other.pImpl_); } private: WidgetSwImpl* pImpl_ = nullptr; }; è°ƒç”¨æ—¶ä»£ç å¦‚ä¸‹ï¼š WidgetSw wSw1(new WidgetSwImpl); WidgetSw wSw2(new WidgetSwImpl); wSw1.swap(wSw2); //æˆåŠŸè¿è¡Œ å¦‚æœæä¾›äº†member swapï¼Œéœ€æä¾›ä¸€ä¸ªnon-memberçš„swapè°ƒç”¨å‰è€… æ³¨æ„ï¼Œå…¶å®ä¸Šè¿°swapæˆå‘˜å‡½æ•°ä½¿ç”¨èµ·æ¥ä¸ç®—ç›´è§‚å’Œç»Ÿä¸€ï¼Œå¯ä»¥å…¨ç‰¹åŒ–std::swapè®©ä½¿ç”¨æ›´ç›´è§‚æ–¹ä¾¿ï¼Œä»£ç å¦‚ä¸‹ï¼š namespace std { template\u003c\u003e void swap\u003cWidgetSw\u003e(WidgetSw\u0026 a, WidgetSw\u0026 b) { a.swap(b); } } // å®¢æˆ·ç«¯åº”ç”¨ä»£ç å¯ä»¥å¦‚ä¸‹è°ƒç”¨ // æ³¨æ„ï¼Œä¸åº”è¯¥ï¼Œä¹Ÿæ²¡å¿…è¦åŠ  std::ï¼Œä¼šé™åˆ¶ç¼–è¯‘å™¨åªä½¿ç”¨stdå‘½åç©ºé—´çš„swap swap(wSw1,wSw2);//ç¼–è¯‘å™¨ä¼šä¼˜å…ˆæŒ‘ä¸­å…¨ç‰¹åŒ–ç‰ˆæœ¬çš„std::swap å¦‚æœæ˜¯Class-Templateï¼Œåˆ™ä¸è¦ç‰¹åŒ–stdå‘½åç©ºé—´çš„swapï¼Œè€Œæ˜¯ç§»åˆ°å…¶å®ƒå‘½åç©ºé—´ namespace WidgetStuff{ template\u003ctypename T\u003e class WidgetSw{ /*çœç•¥ç±»å®šä¹‰*/} // ç±»å†…å«æœ‰swapæˆå‘˜å‡½æ•° template\u003ctypename T\u003e void swap(WidgetSw\u003cT\u003e\u0026 a, WidgetSw\u003cT\u003e\u0026 b) { a.swap(b); } } Notice stdå‘½åç©ºé—´çš„å‡½æ•°ä¸è¦å°è¯•é‡è½½ï¼Œä¹Ÿä¸è¦å¢åŠ ä»»ä½•æ–°ä¸œè¥¿ C++åªå…è®¸å¯¹Class-Templateç›´æ¥åç‰¹åŒ–ï¼Œä¸èƒ½å¯¹Function-Templateåç‰¹åŒ–(å‡½æ•°æ¨¡æ¿å¯ä»¥é€šè¿‡é‡è½½é—´æ¥å®ç°â€œåç‰¹åŒ–â€çš„ä½œç”¨) æˆå‘˜ç‰ˆswapç»å¯¹ä¸è¦æŠ›å‡ºå¼‚å¸¸ï¼Œéæˆå‘˜swapå¯ä»¥(å› ä¸ºæˆå‘˜swapçš„ä¸€ä¸ªæœ€å¥½åº”ç”¨å°±æ˜¯æä¾›å¼‚å¸¸å®‰å…¨æ€§) ref: [1]. https://blog.csdn.net/cltcj/category_12098441.html [2]. https://kissingfire123.github.io/2022/01/11_effective-c-%e4%b9%8b%e5%ad%a6%e4%b9%a0%e6%80%bb%e7%bb%93%e4%ba%8c/ ","date":"2023-07-30","objectID":"/posts/effective_cpp_part_two/:2:8","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]","uri":"/posts/effective_cpp_part_two/"},{"categories":["C++"],"content":"è‡ªå®šä¹‰åˆ†é…å™¨ å¾ˆå¤šæ—¶å€™ï¼Œä½ ä¼šæœ‰å»ºç«‹è‡ªå®šä¹‰åˆ†é…å™¨çš„æƒ³æ³•ï¼š allocator\u003cT\u003eå¯¹çº¿ç¨‹å®‰å…¨é‡‡å–äº†æªæ‹–ï¼Œä½†æ˜¯ä½ åªå¯¹å•çº¿ç¨‹çš„ç¨‹åºæ„Ÿå…´è¶£ï¼Œä½ ä¸æƒ³èŠ±è´¹ä¸éœ€è¦çš„åŒæ­¥å¼€é”€ åœ¨æŸäº›å®¹å™¨é‡Œçš„å¯¹è±¡é€šå¸¸ä¸€åŒè¢«ä½¿ç”¨ï¼Œæ‰€ä»¥ä½ æƒ³åœ¨ä¸€ä¸ªç‰¹åˆ«çš„å †é‡ŒæŠŠå®ƒä»¬æ”¾å¾—å¾ˆè¿‘ä½¿å¼•ç”¨çš„åŒºåŸŸæ€§æœ€å¤§åŒ– ä½ æƒ³å»ºç«‹ä¸€ä¸ªç›¸å½“å…±äº«å†…å­˜çš„å”¯ä¸€çš„å †ï¼Œç„¶åæŠŠä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨æ”¾åœ¨é‚£å—å†…å­˜é‡Œï¼Œå› ä¸ºè¿™æ ·å®ƒä»¬å¯ä»¥è¢«å…¶ä»–è¿›ç¨‹å…±äº«ã€‚ ","date":"2023-07-30","objectID":"/posts/clause_11/:1:0","tags":["Effective","STL"],"title":"Effective STL [11] | ç†è§£è‡ªå®šä¹‰åˆ†é…å™¨çš„æ­£ç¡®ç”¨æ³•","uri":"/posts/clause_11/"},{"categories":["C++"],"content":"ç®¡ç†å…±äº«å†…å­˜ å‡å®šä½ æœ‰ä»¿æ•ˆmallocå’Œfreeçš„ç‰¹åˆ«ç¨‹åºï¼Œç”¨äºç®¡ç†å…±äº«å†…å­˜çš„å † void* mallocShared(size_t bytesNeeded); void freeShared(void *ptr); å¹¶ä¸”ä½ å¸Œæœ›èƒ½æŠŠSTLå®¹å™¨çš„å†…å®¹æ”¾åœ¨å…±äº«å†…å­˜ä¸­: template\u003ctypename T\u003e class SharedMemoryAllocator { public: ... pointer allocate(size_type numObiects, const void *localityHint = 0) { return static_cast\u003cpointer\u003e(mallocShared(numObiects * sizeof(T))); } void deallocate(pointer ptrToMemory, size_type numObjects) { freeShared(ptrToMiemory); } ... }; ä½¿ç”¨SharedMemoryAllocatorï¼š // æ–¹ä¾¿çš„typedef typedef vector\u003cdouble, SharedMemoryAllocator\u003cdouble\u003e \u003e SharedDoubleVec; ... { // å¼€å§‹ä¸€ä¸ªå— SharedDoubleVec v; // å»ºç«‹ä¸€ä¸ªå…ƒç´ åœ¨å…±äº«å†…å­˜ä¸­çš„vector ... // ç»“æŸè¿™ä¸ªå— } ã€Œé—®é¢˜ï¼šã€vä½¿ç”¨SharedMemoryAllocatorï¼Œæ‰€ä»¥våˆ†é…æ¥å®¹çº³å®ƒå…ƒç´ çš„å†…å­˜å°†æ¥è‡ªå…±äº«å†…å­˜ï¼Œä½†væœ¬èº«â€”â€”åŒ…æ‹¬å®ƒçš„å…¨éƒ¨æ•°æ®æˆå‘˜â€”â€”å‡ ä¹å°†è‚¯å®šä¸è¢«æ”¾åœ¨å…±äº«å†…å­˜é‡Œï¼Œvåªæ˜¯ä¸€ä¸ªæ™®é€šçš„åŸºäºå †çš„å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒå°†è¢«æ”¾åœ¨è¿è¡Œæ—¶ç³»ç»Ÿä¸ºæ‰€æœ‰æ™®é€šçš„åŸºäºå †çš„å¯¹è±¡ä½¿ç”¨çš„ä»»ä½•å†…å­˜ã€‚é‚£å‡ ä¹ä¸ä¼šæ˜¯å…±äº«å†…å­˜ã€‚ ä¸ºäº†æŠŠvçš„å†…å®¹å’Œvæœ¬èº«æ”¾è¿›å…±äº«å†…å­˜ï¼Œå¿…é¡»è¿™ä¹ˆåš: void *pVectorMemory = mallocShared(sizeof(SharedDoubleVec));// åˆ†é…è¶³å¤Ÿçš„å…±äº«å†…å­˜æ¥å®¹çº³ä¸€ä¸ªSharedDoubleVecå¯¹è±¡ SharedDoubleVec *pv = new (pVectorMemory) SharedDoubleVec; // ä½¿ç”¨â€œplacement newâ€æ¥ åœ¨é‚£å—å†…å­˜ä¸­å»ºç«‹ ä¸€ä¸ªSharedDoubleVecå¯¹è±¡ï¼› // å‚è§ä¸‹é¢è¿™ä¸ªå¯¹è±¡çš„ä½¿ç”¨ï¼ˆé€šè¿‡pvï¼‰ ... pv-\u003e~SharedDoubleVec(); // é”€æ¯å…±äº«å†…å­˜ä¸­çš„å¯¹è±¡ freeShared(pVectorMemory); // é”€æ¯åŸæ¥çš„å…±äº«å†…å­˜å— è¿™å°±æ˜¯ã€Œæ‰‹å·¥çš„å››æ­¥åˆ†é…/å»ºé€ /é”€æ¯/å›æ”¶çš„è¿‡ç¨‹ã€ï¼šè·å¾—ä¸€äº›å…±äº«å†…å­˜ â€”â€”\u003e åœ¨é‡Œé¢å»ºç«‹ä¸€ä¸ªç”¨å…±äº«å†…å­˜ä¸ºè‡ªå·±å†…éƒ¨åˆ†é…çš„vector â€”â€”\u003e ç”¨å®Œè¿™ä¸ªvectoræ—¶ï¼Œè°ƒç”¨å®ƒçš„ææ„å‡½æ•° â€”â€”\u003e é‡Šæ”¾vectorå ç”¨çš„å†…å­˜ã€‚ è¿™æ®µä»£ç æœ‰2ç‚¹éœ€è¦æ³¨æ„ï¼š å¿½ç•¥äº†mallocSharedå¯èƒ½è¿”å›ä¸€ä¸ªnullæŒ‡é’ˆã€‚ å…±äº«å†…å­˜ä¸­çš„vectorçš„å»ºç«‹ç”±â€œplacement newâ€å®Œæˆã€‚ ","date":"2023-07-30","objectID":"/posts/clause_11/:1:1","tags":["Effective","STL"],"title":"Effective STL [11] | ç†è§£è‡ªå®šä¹‰åˆ†é…å™¨çš„æ­£ç¡®ç”¨æ³•","uri":"/posts/clause_11/"},{"categories":["C++"],"content":"ç®¡ç†åˆ†é…å’Œå›æ”¶çš„å † å‡è®¾æœ‰2ä¸ªå †ï¼Œç±»Heap1å’ŒHeap2ã€‚ æ¯ä¸ªå †ç±»æœ‰ç”¨äºè¿›è¡Œã€Œåˆ†é…ã€å’Œã€Œå›æ”¶ã€çš„ã€Œé™æ€æˆå‘˜å‡½æ•°ã€ï¼š class Heap1 { public: ... static void* alloc(size_t numBytes, const void *memoryBlockToBeNear); static void dealloc(void *ptr); ... }; class Heap2 { ... }; // æœ‰ç›¸åŒçš„alloc/deallocæ¥å£ ä½ æƒ³åœ¨ä¸åŒçš„å †é‡Œè”åˆå®šä½ä¸€äº›STLå®¹å™¨çš„å†…å®¹ã€‚ é¦–å…ˆï¼Œè®¾è®¡ä¸€ä¸ªåˆ†é…å™¨ï¼Œä½¿ç”¨åƒHeap1å’ŒHeap2é‚£æ ·ç”¨äºçœŸå®å†…å­˜ç®¡ç†çš„ç±»ï¼š template\u003ctypenameT, typename Heap\u003e class SpecificHeapAllocator { public: pointer allocate(size_type numObjects, const void *localityHint = 0) { return static_cast\u003cpointer\u003e(Heap::alloc(numObjects * sizeof(T), localityHint)); } void deallocate(pointer ptrToMemory, size_type numObjects) { Heap::dealloc(ptrToMemory); } ... }; ç„¶åï¼Œä½¿ç”¨SpecificHeapAllocatoræ¥æŠŠå®¹å™¨çš„å…ƒç´ é›†åˆåœ¨ä¸€èµ·ï¼š vector\u003cint, SpecificHeapAllocator\u003cint, Heap1 \u003e\u003e v; // æŠŠvå’Œsçš„å…ƒç´ æ”¾è¿›Heap1 set\u003cint, SpecificHeapAllocator\u003cint Heap1 \u003e\u003e s; list\u003cWidget, SpecificHeapAllocator\u003cWidget, Heap2\u003e\u003e L; // æŠŠLå’Œmçš„å…ƒç´  æ”¾è¿›Heap2 map\u003cint, string, less\u003cint\u003e, SpecificHeapAllocator\u003cpair\u003cconst int, string\u003e, Heap2\u003e\u003e m; åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯ã€ŒHeap1å’ŒHeap2æ˜¯ç±»å‹è€Œä¸æ˜¯å¯¹è±¡ã€ã€‚ STLä¸ºç”¨ä¸åŒçš„åˆ†é…å™¨å¯¹è±¡åˆå§‹åŒ–ç›¸åŒç±»å‹çš„ä¸åŒSTLå®¹å™¨æä¾›äº†è¯­æ³•ã€‚é‚£æ˜¯ã€Œå› ä¸ºå¦‚æœHeap1å’ŒHeap2æ˜¯å¯¹è±¡è€Œä¸æ˜¯ç±»å‹ï¼Œé‚£ä¹ˆå®ƒä»¬å°†æ˜¯ä¸ç­‰ä»·çš„åˆ†é…å™¨ï¼Œé‚£å°±è¿åäº†åˆ†é…å™¨çš„ç­‰ä»·çº¦æŸã€ã€‚ åªè¦éµå¾ªã€Œç›¸åŒç±»å‹çš„æ‰€æœ‰åˆ†é…å™¨éƒ½ä¸€å®šç­‰ä»·çš„é™åˆ¶æ¡ä»¶ã€ï¼Œä½ å°†æ¯«ä¸è´¹åŠ›åœ°ä½¿ç”¨è‡ªå®šä¹‰åˆ†é…å™¨æ¥ã€Œæ§åˆ¶ä¸€èˆ¬å†…å­˜ç®¡ç†ç­–ç•¥ï¼Œç¾¤é›†å…³ç³»å’Œä½¿ç”¨å…±äº«å†…å­˜ä»¥åŠå…¶ä»–ç‰¹æ®Šçš„å †ã€ã€‚ ","date":"2023-07-30","objectID":"/posts/clause_11/:1:2","tags":["Effective","STL"],"title":"Effective STL [11] | ç†è§£è‡ªå®šä¹‰åˆ†é…å™¨çš„æ­£ç¡®ç”¨æ³•","uri":"/posts/clause_11/"},{"categories":["C++"],"content":"åºè¨€ è¿™æœ¬C++çš„ç»å…¸ä¹‹ä½œï¼Œä½œè€…æ˜¯å¤§ä½¬Scott MeyersğŸ‘‰å¤§ä½¬ä¸»é¡µï¼Œè¿˜å†™è¿‡å…¶ä»–å‡ æœ¬å½±å“æ·±è¿œçš„C++ç»å…¸ï¼Œä¾‹å¦‚ã€ŠEffective STLã€‹,ã€ŠMore Effective C++ã€‹,ã€ŠEffective Mordern C++ã€‹,ã€ŠOverview of the New C++(C++11/14)ã€‹ç­‰ç­‰ã€‚æœ¬äººçœ‹çš„æ˜¯ä¸­æ–‡ç‰ˆï¼Œä¾¯æ·è€å¸ˆç¿»è¯‘çš„ï¼Œç²¾è¯»åˆ†æå¹¶å®è·µæ¨æ•²åï¼Œæ•´ç†æˆåšå®¢è®°å½•ä¸‹æ¥ã€‚ (Effective-C++æ€»ç»“ç³»åˆ—åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬ä¸€éƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬1~2ç« ï¼Œå†…å®¹èŒƒå›´Rule01~12ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule01ç®€å†™ä¸ºR01)ã€‚ Effective-C++ç³»åˆ—List æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰) ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››) ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:0:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"CH1.è®©è‡ªå·±ä¹ æƒ¯C++ ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:1:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R01 è§†C++ä¸ºä¸€ä¸ªè¯­è¨€è”é‚¦ å¦‚ä»Šçš„C++å·²ç»æ˜¯ä¸ªå¤šé‡èŒƒå¼(multiparadigm)è¯­è¨€ï¼ŒåŒæ—¶æ”¯æŒé¢å‘è¿‡ç¨‹å½¢å¼ã€é¢å‘å¯¹è±¡å½¢å¼ã€å‡½æ•°å½¢å¼ã€æ³›å‹å½¢å¼ã€å…ƒç¼–ç¨‹å½¢å¼ã€‚ è¦ç†è§£è¿™ä¹ˆå¤šç‰¹æ€§ï¼Œå¯ä»¥ç®€å•çš„å½’ç»“ä¸ºå››ç§æ¬¡è¯­è¨€(sublanguage)ç»„æˆï¼š Cè¯­è¨€: C++ä»ä»¥Cä¸ºåŸºç¡€ã€‚C++æ˜¯Cçš„è¶…é›†, ä»ç„¶ä»¥ C ä¸ºåŸºç¡€ã€‚åŒºå—ã€è¯­å¥ã€é¢„å¤„ç†å™¨ã€å†…ç½®æ•°æ®ç±»å‹ ã€æ•°ç»„ã€æŒ‡é’ˆç­‰ç»Ÿç»Ÿæ¥è‡ªCï¼Œè®¸å¤šæ—¶å€™C++å¯¹é—®é¢˜çš„è§£å†³å…¶å®ä¸è¿‡å°±æ˜¯è¾ƒé«˜çº§çš„ C è§£æ³•ï¼Œä½†å½“ä½ C++å†…çš„ C æˆåˆ†å·¥ä½œæ—¶ï¼Œé«˜æ•ˆç¼–ç¨‹å®ˆåˆ™æ˜ ç…§å‡º C è¯­è¨€çš„å±€é™ï¼šæ²¡æœ‰æ¨¡æ¿(template) ï¼Œæ²¡æœ‰å¼‚å¸¸(exceptions)ï¼Œæ²¡æœ‰é‡è½½(overloading)â€¦â€¦ Object-Oriented C++: é¢å‘å¯¹è±¡ç‰¹æ€§ã€‚è¿™éƒ¨åˆ†ä¹Ÿå°±æ˜¯ C with classes æ‰€è¯‰æ±‚çš„: classes(åŒ…æ‹¬æ„é€ å‡½æ•°å’Œææ„å‡½æ•°)ï¼Œå°è£…(encapsulation)ã€ç»§æ‰¿(inheritance)ã€å¤šæ€(polymorhpism)ã€virtualå‡½æ•°(åŠ¨æ€ç»‘å®š)â€¦â€¦ç­‰ç­‰ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯é¢å‘å¯¹è±¡è®¾è®¡ä¹‹å¤å…¸å®ˆåˆ™åœ¨C++ ä¸Šçš„ç›´æ¥å®æ–½ã€‚ Template C++: C++çš„æ³›å‹(generic)ç¼–ç¨‹çš„éƒ¨åˆ†ï¼Œä¹Ÿå¸¦æ¥äº†é»‘é­”æ³•-æ¨¡æ¿å…ƒç¼–ç¨‹(TMP,Metaprogramming)ï¼› STLï¼š STL(Standard Temlate Library)å³æ ‡å‡†æ¨¡æ¿åº“ï¼Œå®ƒæ˜¯templateç¨‹åºåº“ã€‚å°è£…äº†å„ç±»å®¹å™¨(container)ã€é…ç½®å™¨(allocator)ã€è¿­ä»£å™¨(iterator)ã€ç®—æ³•ä»¥åŠå¸¸ç”¨å¯¹è±¡ã€‚ æ€»ç»“: C++é«˜æ•ˆç¼–ç¨‹å®ˆåˆ™è§†çŠ¶å†µè€Œå˜åŒ–ï¼Œå–å†³äºä½ ä½¿ç”¨C++çš„å“ªä¸€éƒ¨åˆ† ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:1:1","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R02 å°½é‡ä»¥const,enum,inlineæ›¿æ¢#define å¯¹äºå®å®šä¹‰çš„å¸¸é‡ï¼Œå»ºè®®ç”¨constå¸¸é‡æˆ–è€…æšä¸¾enumæ›¿æ¢ è¿™æ ·åšçš„å¥½å¤„æ˜¯æ–¹ä¾¿è°ƒè¯•ï¼Œå› ä¸ºå®æŠ¥é”™å°±æ˜¯ä¸ªå¸¸æ•°å€¼ï¼Œæ²¡æœ‰ç¬¦å·è¡¨ï¼›å¹¶ä¸”å®ä¸å…·æœ‰å°è£…æ€§(å®çš„ä½œç”¨åŸŸæ˜¯åœ¨ç¼–è¯‘æ—¶æ˜¯å…¶å®šä¹‰ä¹‹äº‹)ã€‚ // ä¸¾ä¾‹ï¼šMAX_DATA_COUNTåœ¨é¢„å¤„ç†é˜¶æ®µå°±ä¼šè¢«æ›¿æ¢ï¼Œç¼–è¯‘å™¨ä¸ä¼šè§åˆ°å®ƒï¼Œæ‰€ä»¥ä¸€æ—¦æœ‰ç›¸å…³æŠ¥é”™ï¼Œç»™çš„æ˜¯100è¿™ä¸ªå€¼ #define MAX_DATA_COUNT 100 const int MAX_DATA_COUNT = 100 ;// å¸¸é‡åªæœ‰ä¸€ä»½ï¼Œå®ä¼šå¯¼è‡´å¤šä»½å¸¸é‡å€¼ class Buffer{ public://...ç±»å…¶ä»–éƒ¨åˆ†çœç•¥ static const double factor_ ;// staticå¸¸é‡,ç±»å†…å£°æ˜ static const int times_ = 2;// intç±»å‹å…è®¸ç±»å†…åˆå§‹åŒ–,è§„èŒƒä¸Šè¿˜æ˜¯å»ºè®®æ‹¿åˆ°ç±»å¤– private: static const int ArrLength = 5; int arr[ArrLength]; }; const double Buffer::factor_ = 0.1;// ç±»å¤–åˆå§‹åŒ–,ä¸€èˆ¬å†™åœ¨å®ç°æ–‡ä»¶*.cpp,*.ccä¸­ å¦‚æœç¼–è¯‘å™¨ä¸å…è®¸å£°æ˜æ—¶\"in-classåˆå€¼è®¾å®š\",å¦‚æœæ˜¯æ•´å½¢å¸¸é‡ï¼Œå¯ä»¥è®©æšä¸¾å€¼æ¥æ›¿ä»£ï¼Œè€Œä¸”æšä¸¾å€¼ä¸èƒ½è¢«å–åœ°å€ã€‚ å¯¹äºå®å®šä¹‰çš„å‡½æ•°ï¼Œå»ºè®®ç”¨å†…è”inlineå‡½æ•°æ›¿æ¢ å®å‡½æ•°æ²¡åŠæ³•å•è¡Œdebugè°ƒè¯•ï¼Œè€Œå†…è”å‡½æ•°å¯ä»¥ï¼› å®çš„å†™æ³•å³ä½¿å°å¿ƒç¿¼ç¿¼çš„åŠ å¥½äº†æ‹¬å·ï¼Œä¹Ÿå¯èƒ½é€ æˆæ„æƒ³ä¸åˆ°çš„å®å‡½æ•°é‡å¤è®¡ç®—çš„é—®é¢˜ã€‚ #define GET_MAX(a,b) ((a)\u003e(b) ? (a) :(b)) int a = 5, b = 0; GET_MAX(++a,b); // aç´¯åŠ äºŒæ¬¡ GET_MAX(++a,b+10); // aç´¯åŠ ä¸€æ¬¡ // å®šä¹‰ä¸ªinlineå‡½æ•°å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜,(a,b)ä½œä¸ºå‡½æ•°å…¥å‚å°±åªä¼šè®¡ç®—ä¸€æ¬¡ By the way ä¸Šè¿°æƒ…å†µï¼Œä»çº¯Cè¯­è¨€è§’åº¦ï¼Œæƒ³é¿å…â€œå®å‡½æ•°é‡å¤è®¡ç®—â€ï¼Œå…¶å®è¿˜æœ‰ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨GNU C æ‰©å±•çš„ typeof æˆ– GCC çš„ __auto_type å…³é”®å­—ï¼Œè¯¦ç»†å¯å‚è€ƒGCCå®˜æ–¹æ–‡æ¡£é¡µé¢ã€‚2è€…éƒ½é€‚ç”¨äºGCCå’ŒClangï¼Œéƒ½ä¸é€‚ç”¨MSVCï¼‰ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š #define GET_MAX_ONCE(a,b) \\ ( {typeof(a) _a = (a); \\ typeof(b) _b = (b); \\ (_a) \u003e (_b) ? (_a) : (_b); } ) æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š int a = 10,b = 20; int c = GET_MAX(++a, b++); std::cout \u003c\u003c \"a = \" \u003c\u003c a \u003c\u003c \", b = \"\u003c\u003c b \u003c\u003c \", c = \" \u003c\u003c c \u003c\u003c std::endl; a = 10 , b = 20; c = GET_MAX_ONCE(++a, b++); std::cout \u003c\u003c \"a = \" \u003c\u003c a \u003c\u003c \", b = \"\u003c\u003c b \u003c\u003c \", c = \" \u003c\u003c c \u003c\u003c std::endl; æµ‹è¯•ä»£ç è¾“å‡ºï¼š a = 11, b = 22, c = 21 a = 11, b = 21, c = 20 ğŸ¤” ä½¿ç”¨ __auto_type æ¥å–ä»£æ—¶è¦èµ‹åˆå€¼ï¼Œå…³é”®çš„ typeof é‚£è¡Œç”¨æ³•æ”¹ä¸º__auto_type _a = (a); ã€‚ __auto_type æ¯” typeof çš„ä¼˜åŠ¿ä¹‹å¤„åœ¨äºé¢å¯¹å˜é•¿æ•°ç»„(VLA)ï¼Œåªè§£æ1æ¬¡ï¼›ä»¥åŠé¢å¯¹åµŒå¥—å®å®šä¹‰æ—¶ä¹Ÿæ˜¯åªä¸¥æ ¼è§£æä¸€æ¬¡ã€‚ ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:1:2","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R03 å°½å¯èƒ½ç”¨const è¯´èµ·constï¼Œå…ˆå¤ä¹ ä¸ªé¢è¯•é«˜é¢‘é¢˜ğŸ˜ //ç±»å‹charåœ¨å“ªé‡Œæ²¡å…³ç³»ï¼Œå…³é”®çœ‹constå’Œ*çš„ç›¸å¯¹ä½ç½®ï¼š //conståœ¨*å·¦è¾¹ï¼ŒæŒ‡é’ˆæ‰€æŒ‡ç‰©ä¸ºå¸¸é‡; //conståœ¨*å³è¾¹ï¼ŒæŒ‡é’ˆä¸ºå¸¸é‡ï¼› const char* p; // æŒ‡é’ˆpæ‰€æŒ‡çš„å­—ç¬¦ä¸²ä¸ºå¸¸é‡ï¼Œä½†æ˜¯på¯ä»¥ä¿®æ”¹ char* const p; // æŒ‡é’ˆpæ˜¯å¸¸é‡ï¼ŒæŒ‡å‘çš„å­—ç¬¦ä¸²å¯ä¿®æ”¹ constä¿®é¥°å‡½æ•°è¿”å›å€¼æ—¶çš„é˜²å¾¡æ€§ constä¿®é¥°å‡½æ•°çš„è¿”å›å€¼ï¼Œå¯ä»¥é¿å…ä¸€äº›é”™è¯¯ï¼Œå¦‚ä¸‹ï¼š const Rational operator* (const Rational\u0026 lhs,const Rational\u0026 rhs); //å­˜åœ¨Rational a,b,c; if(a*b = c) //ä¾‹å¦‚æ‰‹è¯¯ \"==\"æ‰“æˆäº†\"=\"ï¼Œç¼–è¯‘å™¨ä¼šç›´æ¥æŠ¥é”™ constæˆå‘˜å‡½æ•°çš„é™åˆ¶ constæˆå‘˜å‡½æ•°æœ‰2ä¸ªå¥½å¤„ï¼š(1). æ˜ç¡®ç†è§£å‡½æ•°æ˜¯å¦ä¿®æ”¹å¯¹è±¡å†…å®¹ï¼›(2). ä½¿â€œæ“ä½œconstå¯¹è±¡â€æˆä¸ºå¯èƒ½ã€‚ å¯ä»¥é€šè¿‡constç‰¹æ€§è®©å¯¹è±¡è‡ªåŠ¨è°ƒç”¨æ­£ç¡®çš„ç‰ˆæœ¬ï¼š class TextBlock{//...ç±»å…¶ä»–éƒ¨åˆ†çœç•¥ const char\u0026 operator[](std::size_t index) const{ return text[index];} char\u0026 operator[](std::size_t index) { return text[index];} private: std::string text; } void print(const TextBlock\u0026 ctb){ std::cout \u003c\u003c ctb[0] ;//æ ¹æ®constç‰¹æ€§ï¼Œè°ƒç”¨ const TextBlock::operator[] } æ€è€ƒï¼šconstæˆå‘˜å‡½æ•°ä¸ä¿®æ”¹æˆå‘˜å¯¹è±¡ï¼Œé‚£ä¹ˆï¼Œå¦‚æœæˆå‘˜å¯¹è±¡ä¸ºæŒ‡é’ˆchar *pï¼Œä»…ä¿®æ”¹pæŒ‡å‘çš„å†…å®¹ï¼Œé‚£å®ƒè¿˜æ˜¯constæˆå‘˜å‡½æ•°å—ï¼Ÿ å®æµ‹ï¼šconstæˆå‘˜å‡½æ•°æ˜¯å…è®¸p[2]= 'x'è¿™ä¸€æ“ä½œçš„ï¼Œä½†æ˜¯ä¸å…è®¸p++ï¼› bitwise-constness(åˆç§°ä¸ºphysical constness)ç†å¿µè®¤ä¸ºä¸æ˜¯ï¼Œä¸èƒ½æ›´æ”¹ä»»ä½•å¯¹è±¡å†…çš„ä»»ä½•ä¸€ä¸ªbitã€‚è¿™ç§è¯´æ³•ä¹Ÿæœ‰çº°æ¼ï¼Œconstå‡½æ•°è¿”å›ä¸€ä¸ªå¼•ç”¨å°±å¤±æ§äº†,å¤–éƒ¨å¯æ”¹ï¼› logical-constnessç†å¿µåˆ™å…è®¸constæˆå‘˜å‡½æ•°ä¿®æ”¹æˆå‘˜å˜é‡çš„bitsï¼Œä½†åªæœ‰åœ¨å®¢æˆ·ç«¯ä¾¦æµ‹ä¸å‡ºçš„æƒ…å†µä¸‹; constæˆå‘˜å‡½æ•°å¦‚æœä¸€å®šè¦ä¿®æ”¹æˆå‘˜å˜é‡ï¼Œæˆå‘˜å˜é‡ä½¿ç”¨ mutable ä¿®é¥°å³å¯. constä¸non-constçš„æˆå‘˜å‡½æ•°å®ç°å®Œå…¨ç›¸åŒæ—¶ è¿™ç§æƒ…å†µï¼Œå¦‚ä½•å»é™¤ä»£ç å†—ä½™æ˜¯ä¸ªé—®é¢˜ã€‚ä¸è¦å°è£…å‡ºä¸€ä¸ªprivateå‡½æ•°ç„¶åä¸€èµ·è°ƒç”¨ï¼Œå¤šäº†å±‚è°ƒç”¨ã€‚ æ­£ç¡®åšæ³•ğŸ‘‰ ä½¿ç”¨è½¬å‹,è®©non-constè°ƒç”¨constæˆå‘˜å‡½æ•°ï¼Œå¦‚ä¸‹ä¸ºç¤ºä¾‹ï¼š class Rawdata { public: Rawdata(char *src):p_(src),length_(strlen(src)) {} const int\u0026 GetLength()const{ p_[1] = 'a';//ä¸ºæ±‚ç®€ä¾¿,ä¸ä½œæ£€æŸ¥äº†ã€‚p_å†…å®¹ä¿®æ”¹ç¼–è¯‘å™¨æ˜¯å…è®¸çš„. return length_; } int GetLength() { return const_cast\u003cint\u0026\u003e( (static_cast\u003cconst Rawdata\u0026\u003e(*this)).GetLength()); } private: char *p_ = nullptr; int length_ = 0; }; ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:1:3","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R04 ç¡®å®šå¯¹è±¡ä½¿ç”¨å‰å…ˆåˆå§‹åŒ– åˆ†æ¸…\"èµ‹å€¼\"å’Œ\"åˆå§‹åŒ–\"ï¼Œåœ¨ç±»çš„æ„é€ å‡½æ•°ä½“å†…ä½¿ç”¨ç­‰å·\"=â€œèµ‹å€¼å¹¶é\"åˆå§‹åŒ–â€ã€‚æˆå‘˜å˜é‡çš„åˆå§‹åŒ–æ˜¯åœ¨æ„é€ å‡½æ•°çš„æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨å®ç°ï¼Œæ•ˆç‡æ›´é«˜ã€‚ C++åˆå§‹åŒ–çš„æ¬¡åº: Base classæ€»æ˜¯æ—©äºDerived Classè¢«åˆå§‹åŒ–ï¼› Classå†…çš„æˆå‘˜å˜é‡æ€»æ˜¯ä»¥å£°æ˜æ¬¡åºè¢«åˆå§‹åŒ–ï¼› ä¸¾ä¾‹: ä¸‹å›¾ä¸­çš„ä»£ç åˆå§‹åŒ–é¡ºåºä¸ºå£°æ˜é¡ºåº\"age_$\\rightarrow$name_$\\rightarrow$gender_ $\\rightarrow$isVip_â€ class Customer { public: //è¿™é‡Œåªæ˜¯ä¸ºäº†éªŒè¯ï¼Œå¦‚æœæ˜¯å®é™…å·¥ç¨‹ä»£ç ï¼Œå»ºè®®åˆå€¼åˆ—è¡¨å°½é‡å’Œå£°æ˜é¡ºåºä¿æŒä¸€è‡´ Customer(std::string gender, uint8_t age, std::string name, bool isVip = false) :isVip_(isVip), gender_(gender), name_(name), age_(age) {} private: uint8_t age_; std::string name_; std::string gender_; bool isVip_; }; By the way ğŸ’¡ï¼šä»»ä½•ä¸€ä¸ªæˆå‘˜å˜é‡açš„åˆå§‹åŒ–æµç¨‹ï¼šç±»å†…å£°æ˜èµ‹åˆå€¼(C++11)-\u003eæ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨-\u003eæ„é€ å‡½æ•°ä½“å†…èµ‹å€¼. å‡½æ•°ä½“å¤–staticå˜é‡ç§°ä¸ºnon-local staticå˜é‡ï¼Œè¿™ç§å˜é‡å¯ä»¥åœ¨å„è‡ªçš„ç¼–è¯‘å•å…ƒæ­£å¸¸å·¥ä½œï¼Œä½†C++æ— æ³•ä¿è¯åˆå§‹åŒ–æ¬¡åºï¼Œå½“ç¼–è¯‘å•å…ƒä¹‹é—´éœ€è¦å…±äº«å˜é‡æ—¶ï¼Œè€Œè¯¥å˜é‡ä¾èµ–non-local staticï¼Œå°±å¯èƒ½ä¼šå‡ºé—®é¢˜ã€‚ è§£å†³åŠæ³•æ˜¯å°†è¿™æ ·çš„å˜é‡æ”¾å›å‡½æ•°ä½“å†…ï¼Œæˆä¸ºlocal staticï¼Œå› ä¸ºC++ç¡®ä¿åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ä¸€å®šä¼šåˆå§‹åŒ–è¿™ä¸ªstaticå˜é‡ã€‚ ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:1:4","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"CH2.æ„é€ /ææ„/èµ‹å€¼è¿ç®— ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:2:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R05 äº†è§£C++é»˜è®¤ç¼–å†™å¹¶è°ƒç”¨å“ªäº›å‡½æ•° ç¼–è¯‘å™¨å¯ä»¥æš—è‡ªä¸ºClassåˆ›å»ºdefaultæ„é€ å‡½æ•°ï¼Œcopyæ„é€ å‡½æ•°(å¤åˆ¶æ„é€ )ï¼Œcopy assigment(èµ‹å€¼æ„é€ )æ“ä½œç¬¦ï¼Œä»¥åŠdefaultææ„å‡½æ•°ã€‚ class EmptyClass{}; ç­‰ä»·äº: class EmptyClass { public: EmptyClass() {} // defaultæ„é€ å‡½æ•° EmptyClass(const EmptyClass\u0026 rhs) {}//copyæ„é€ å‡½æ•° ~EmptyClass() {}//defaultææ„å‡½æ•°ï¼Œæ³¨æ„æ˜¯non-virtual EmptyClass\u0026 operator=(const EmptyClass\u0026 rhs) {}//copy assignmentæ“ä½œç¬¦ }; å¦‚æœä¸€ä¸ªéç©ºClassè‡ªè¡Œå£°æ˜äº†æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨å°±ä¸å†ä¸ºå®ƒåˆ›å»ºdefaultæ„é€ å‡½æ•°; å¦‚æœä¸€ä¸ªClasså†…æœ‰å¼•ç”¨å˜é‡æˆ–constå˜é‡ï¼Œç¼–è¯‘å™¨ä¸ä¼šä¸ºå…¶ç”Ÿæˆcopy-assignmentå‡½æ•°ï¼Œéœ€è¦è‡ªå·±å®ç°. class NameObject { public: NameObject(std::string\u0026 name, const int value) :nameValue_(name), objectVal_(value) {} private: std::string\u0026 nameValue_; const int objectVal_; };//è€ƒè™‘ä»¥ä¸‹åº”ç”¨ä»£ç  std::string name(\"Mike\"), name2(\"Nicky\"); NameObject nObj(name,22), nObj2(name2,33); nObj2 = nObj;//è¿™ä¸€å¥ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼Œå› ä¸ºå¼•ç”¨ä¸èƒ½æŒ‡å‘2ä¸ªå¯¹è±¡ï¼Œä¸”constä¸å¯æ”¹ ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:2:1","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R06 ä¸æƒ³ç¼–è¯‘å™¨çš„è‡ªåŠ¨ç”Ÿæˆçš„å‡½æ•°,æ˜ç¡®æ‹’ç» æŸäº›åœºæ™¯ï¼Œç±»å¯¹è±¡æœ¬èº«æ˜¯è®¤ä¸ºç‹¬ä¸€æ— äºŒçš„ï¼Œæ¯”å¦‚æè¿°äººç‰©æ€§æ ¼çš„ç±»Personality(å¯èƒ½ä¸æ°å½“)ï¼Œä¸åŒçš„äººæ€§æ ¼ä¸åŒï¼Œè‚¯å®šæ˜¯ä¸å¸Œæœ›èƒ½å¤åˆ¶/èµ‹å€¼çš„ã€‚ å¦‚æœä¸æƒ³ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆé‚£å‡ ä¸ªå‡½æ•°ï¼Œæ¯”å¦‚ä¸æƒ³è¦å¤åˆ¶æ„é€ æˆ–èµ‹å€¼æ„é€ ï¼Œå°±æ˜ç¡®åœ¨ä»£ç ä¸­ç¦æ­¢ï¼Œä¹Ÿé˜²æ­¢å¤–éƒ¨ç”¨æˆ·ä½¿ç”¨ã€‚ æŠ€å·§1ï¼šå¯ä»¥å£°æ˜ä¸ºprivateå‡½æ•°ä½†æ˜¯ä¸ç»™å‡ºå®ç°ï¼Œè®©ç¼–è¯‘å™¨æŠ¥é”™ï¼› æŠ€å·§2ï¼šå¯ä»¥è®¾ç«‹åŸºç±»Baseï¼Œè®©å¤åˆ¶æ„é€ å’Œèµ‹å€¼æ„é€ éƒ½ä¸ºprivateå‡½æ•°ï¼Œè®©ç›®æ ‡ç±»ç»§æ‰¿äºBaseç±»ã€‚ By the way C++11é’ˆå¯¹æ­¤ç±»æƒ…å†µï¼Œç»™äºˆäº†deleteå…³é”®å­—ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œåœ¨æˆå‘˜å‡½æ•°åé¢æ–°å¢\"=delete\"ï¼Œå³å¯æ˜¾å¼åœ°æ‹’ç»è¿™ä¸ªå‡½æ•°çš„ç”Ÿæˆå’Œè°ƒç”¨.ä¸¾ä¾‹å¦‚ä¸‹: class A { public: A(const A\u0026) = delete; // æ‹·è´æ„é€  A\u0026 operator=(const A\u0026) = delete; // æ‹·è´èµ‹å€¼ }; ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:2:2","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R07 ä¸ºå¤šæ€åŸºç±»å£°æ˜virtualææ„å‡½æ•° é’ˆå¯¹Base* pBase= new DerivedObj()ï¼Œé‡Šæ”¾pBaseæ—¶ï¼Œå¦‚æœBaseåŸºç±»çš„ææ„å‡½æ•°None-Virtualï¼Œåˆ™ä¼šå¯¼è‡´Derivedçš„ææ„å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨ï¼Œé€ æˆå†…å­˜ä¸å®Œå…¨é‡Šæ”¾ï¼Œå³å†…å­˜æ³„æ¼ï¼› Non-Virtualçš„Classä¸è¦åšåŸºç±»ï¼› å¦‚æœä¸åšåŸºç±»ï¼Œå°±ä¸è¦å£°æ˜ææ„å‡½æ•°ä¸ºvirtualå‡½æ•°ï¼Œé¿å…è™šè¡¨ä¸ºå…¶åˆ†é…vptré€ æˆæµªè´¹ï¼› å¦‚æœæƒ³è¦æŠ½è±¡ç±»ï¼Œåˆæš‚æ—¶æ²¡æœ‰åˆé€‚æ¥å£ï¼Œå¯ä»¥è®©å…ˆè™šææ„æˆä¸ºçº¯è™šå‡½æ•°ï¼Œä¾‹å¦‚ class RawData{ public: virtual ~RawData() = 0; }; // è¿™é‡Œç‰¹æ®Šçš„æ˜¯ï¼Œéœ€è¦ä¸ºè¿™ä¸ªçº¯è™šå‡½æ•°æä¾›å®šä¹‰ ~RawData::RawData(){} ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:2:3","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R08 åˆ«è®©å¼‚å¸¸é€ƒç¦»ææ„å‡½æ•° ææ„å‡½æ•°æœ€å¥½ä¸è¦åå‡ºå¼‚å¸¸ å¯¹äºæŸä¸ªWidgetç±»ï¼Œå¦‚æœææ„å‡½æ•°æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆvector\u003cwidget\u003eææ„æ—¶å¯èƒ½è¿ç»­æŠ›å‡ºå¤šä¸ªå¼‚å¸¸ä»¥è‡³äºæ— æ³•å¤„ç†ï¼Œç›´æ¥å¯¼è‡´æå‰ç¨‹åºç»“æŸæˆ–è€…æœªå®šä¹‰è¡Œä¸ºã€‚ å¦‚æœæœ‰æŸä¸ªå‡½æ•°å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¹¶éœ€è¦å¯¹å¼‚å¸¸åšå‡ºååº”ï¼Œåº”è¯¥æä¾›ä¸€ä¸ªéææ„çš„å‡½æ•°æ¥å¤„ç† æ³¨æ„ï¼Œåœ¨ææ„ä¸­æŠ›å¼‚å¸¸å¹¶åä¸‹(catchågo-on-execute)ï¼Œä¼šæ©ç›–é”™è¯¯ï¼Œä¹Ÿä¸æ˜¯ä¸ªå¥½åŠæ³•;æŠ›å¼‚å¸¸åcatchä½å¹¶std::abort()åè€Œå¯ä»¥æå‰ç»ˆç»“ã€æœªå®šä¹‰è¡Œä¸ºã€ã€‚ ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:2:4","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R09 ç»ä¸åœ¨æ„é€ å’Œææ„è¿‡ç¨‹ä¸­è°ƒç”¨virtualå‡½æ•° åœ¨Derived-Classçš„Base-Classæ„é€ æœŸé—´ï¼Œå¯¹è±¡çš„ç±»å‹æ˜¯Base-Classï¼Œè€ŒéDerivedï¼Œå³ä½¿dynamic_castä¹Ÿæ˜¯è¿™æ ·è®¤ä¸ºçš„ï¼Œå› ä¸ºæ­¤æ—¶virtualå‡½æ•°ä¸ä¼šä¸‹é™åˆ°Derived-Classçš„é˜¶å±‚ï¼›æ¢å¥è¯è¯´==\u003e â€œåœ¨Base-Classæ„é€ æœŸé—´ï¼Œvirtualå‡½æ•°ä¸æ˜¯virtualå‡½æ•°â€ï¼› åœ¨ææ„çš„æ—¶å€™ä¹Ÿæ˜¯ç±»ä¼¼é“ç†ï¼Œä¹Ÿä¸è¦åœ¨ææ„å‡½æ•°ä¸­è°ƒç”¨virtualå‡½æ•°ï¼Œé—´æ¥è°ƒç”¨ä¹Ÿä¸è¡Œ(æ¯”å¦‚non-Virtual-\u003evirtual)ï¼› é‚£ä¹ˆæ›¿ä»£æ–¹æ¡ˆæ˜¯ï¼Ÿ å¦‚æœæœ‰è¿™æ ·ä¸€ç§æƒ…å†µï¼Œå¸Œæœ›åœ¨å­ç±»æ„é€ æ—¶èƒ½è°ƒç”¨çˆ¶ç±»çš„fooå‡½æ•°(ä¸‹æ–¹logTransactionå‡½æ•°)ï¼Œé‚£ä¹ˆå°†fooæ”¹ä¸ºnon-Virtualå‡½æ•°ï¼Œå¹¶ä¸”å­ç±»æ„é€ æ—¶è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œæœ‰å‚æ•°æ—¶ä¸€å¹¶ä¼ è¿‡å»ï¼› class Transaction { public: explict Transaction(const std::string\u0026 info,int id):id_(id) { logTransaction(info); } void logTransaction(const std::string\u0026 info) { std::cout \u003c\u003c info.c_str(); }//non-Virtualå‡½æ•° private: int id_; }; class BuyTransaction :public Transaction { public: //å°†logä¿¡æ¯ä¼ é€’ç»™ åŸºç±»Transactionæ„é€ å‡½æ•°ï¼› å¹¶åˆå§‹åŒ–äº†åŸºç±»æˆå‘˜ BuyTransaction(const std::string\u0026 info, int id) :Transaction(info,id) {/**/} }; By the way ä¸Šè¿°ä»£ç ä¸­ï¼Œå¦‚æœæœ‰å‡ ä¸ªBaseæ„é€ å‡½æ•°ï¼Œå°±å¾—å†™å‡ ä¸ªDerivedæ„é€ å‡½æ•°ä¼ å‚ã€‚ä¸ºäº†ç®€åŒ–è¿™ä¸€æ­¥éª¤ï¼Œ åœ¨ç°ä»£C++11ï¼Œæ¨å‡ºäº†ç»§æ‰¿æ„é€ å‡½æ•°(Inheriting Constructor)ï¼Œå­ç±»å¯ä»¥ä¸€ä¸ªéƒ½ä¸ç”¨å†™ï¼Œç›´æ¥å†™ä¸€å¥usingå£°æ˜å³å¯ï¼Œä½¿ç”¨using BaseClass::BaseClassçš„å½¢å¼ï¼Œå¦‚ä¸‹ğŸ‘‡ class BuyTransaction :public Transaction { public: using Transaction::Transaction; //å…¶ä»– }; ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:2:5","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R10 ä»¤operator=è¿”å›ä¸€ä¸ªreference to *this å…³äºèµ‹å€¼æ“ä½œç¬¦operator=ï¼Œä¸»æµåšæ³•æ˜¯: class Widget { public: Widget\u0026 operator=(const Widget \u0026rhs) { //... do some thing return *this; } }; ä¸Šè¿°åšæ³•ä¸å±€é™äºoperator=ï¼Œè¿˜æœ‰operator += ,-=,*=,/=ç­‰å…¶ä»–èµ‹å€¼è¿ç®—ç¬¦ã€‚ è¯¥ä¸»æµåè®®/åšæ³•ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œåªæ˜¯ä¸ªå»ºè®®ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥å…è®¸è¿ç»­èµ‹å€¼($x=y=z$çš„å½¢å¼)ã€‚ è¯¥åè®®è¢«å†…ç½®ç±»å‹ï¼Œä»¥åŠSTLçš„ç±»å‹(å¦‚string,vector,complex,shared_ptr)å…±åŒéµå®ˆã€‚ ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:2:6","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R11 åœ¨operator=ä¸­å¤„ç†\"è‡ªæˆ‘èµ‹å€¼\" ä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™è‡ªå·±ï¼Œè¿™ç§çœ‹èµ·æ¥æœ‰ç‚¹å‚»çš„åšæ³•ï¼Œæœ‰æ—¶å€™ä¼šæ¯”è¾ƒéš¾ä»¥å‘è§‰ã€‚æ¯”å¦‚ï¼ša[i] = a[j]ï¼Œå¦‚æœ $i$ å’Œ $j$ ç›¸ç­‰ï¼Œå°±æ˜¯â€œè‡ªæˆ‘èµ‹å€¼â€çš„ç»å…¸åœºæ™¯äº†ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå°½é‡å®Œå¤‡çš„èµ‹å€¼æ“ä½œç¬¦å‡½æ•°ğŸ¤”ã€‚ è€ƒè™‘å¦‚ä¸‹ç±»MapWidgetï¼Œå†…æœ‰æ•°æ®è£¸æŒ‡é’ˆBitMap *pb_ï¼Œåœ¨èµ‹å€¼æ—¶åŒæ—¶è€ƒè™‘å¼‚å¸¸å®‰å…¨å’Œ â€œè‡ªæˆ‘èµ‹å€¼â€ å®‰å…¨(è®¤åŒæµ‹è¯•ä¿éšœè‡ªæˆ‘èµ‹å€¼å®‰å…¨)ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹ä¸é”™çš„å®ç°ã€‚ä½†æ˜¯ï¼Œè®¤åŒæµ‹è¯•ä¼šé™ä½è¿è¡Œæ•ˆç‡ï¼Œæ ¹æ®å®é™…å·¥ç¨‹å®è·µæƒ…å†µ(è‡ªæˆ‘èµ‹å€¼æ¦‚ç‡æä½ )å¯ä»¥é…Œæƒ…å»æ‰ã€‚ class BitMap {/*çœç•¥ç±»å£°æ˜\u0026å®ç°*/}; class MapWidget { private: BitMap * pb_ = nullptr; public: explicit MapWidget(BitMap *pb) :pb_(pb) {} MapWidget\u0026 operator=(const MapWidget\u0026 rhs) { if (this == \u0026rhs) return *this; //è¿™ä¸€å¥ä¸ºè®¤åŒæµ‹è¯•(identity test) BitMap *pOrig = pb_;//ä¸è¦ä¸€ä¸Šæ¥å°±deleteï¼Œè€Œæ˜¯ä¿å­˜this-\u003epb_ pb_ = new BitMap(*rhs.pb_);//å› ä¸ºè¿™ä¸€å¥å¯èƒ½æŠ›å¼‚å¸¸ delete pOrig; return *this; } }; Copy and SwapæŠ€æœ¯ ä¸Šæ–‡ä¸­ä¿éšœå¼‚å¸¸å®‰å…¨å’Œ **â€œè‡ªæˆ‘èµ‹å€¼â€**å®‰å…¨çš„æŠ€æœ¯æ‰‹æ®µï¼Œå¦å¤–ä¸€ä¸ªåŠæ³•ï¼Œå°±æ˜¯Copy and SwapæŠ€æœ¯ã€‚è¿™ä¸ªæŠ€æœ¯çš„å…³é”®åœ¨äºâ€œä¿®æ”¹å¯¹è±¡æ•°æ®çš„å‰¯æœ¬ï¼Œç„¶ååœ¨ä¸€ä¸ªä¸æŠ›å¼‚å¸¸çš„å‡½æ•°ä¸­å°†ä¿®æ”¹çš„æ•°æ®å’ŒåŸä»¶ç½®æ¢ â€ã€‚ void MapWidget::Swap(MapWidget\u0026 rhs){std::swap(rhs.pb_,pb_);} MapWidget\u0026 MapWidget::operator=(const MapWidget\u0026 rhs) { MapWidget temp(rhs); Swap(temp); return *this; } ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:2:7","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"R12 å¤åˆ¶å¯¹è±¡æ—¶åˆ«å¿˜è®°å…¶æ¯ä¸€ä¸ªæˆåˆ† ç¼–å†™ç±»çš„Copyingå‡½æ•°æ—¶éœ€è¦åšåˆ°2ç‚¹ è¿™é‡Œçš„Copyingå‡½æ•°æ˜¯æŒ‡æœ‰copyå±æ€§çš„ç‰¹æ®Šå‡½æ•°==\u003e copyæ„é€ å‡½æ•°å’Œcopyèµ‹å€¼æ“ä½œç¬¦ã€‚ å¤åˆ¶æ‰€æœ‰Localæˆå‘˜å˜é‡ å¦‚æœæˆå‘˜å¤åˆ¶çš„æ—¶å€™æœ‰é—æ¼ï¼Œç¼–è¯‘å™¨å¹¶ä¸ä¼šæœ‰æ€¨è¨€ï¼Œè¿™å°±åŸ‹ä¸‹äº†éšæ‚£ã€‚å¦‚æœæ–°å¢äº†æˆå‘˜ï¼Œè¦å¯¹åº”ä¿®æ”¹Copyingå‡½æ•°ã€‚ è°ƒç”¨æ‰€æœ‰Base-Classå†…éƒ¨çš„é€‚å½“çš„Copyå‡½æ•° å…·ä½“ä»£ç çš„æ¨èå®ç° å¦‚ä¸‹ğŸ‘‡ï¼š class Customer { public: Customer(std::string name, float money):name_(name),money_(money) {} private: std::string name_; float money_; }; class VipCustomer :public Customer { public: //æ³¨æ„ï¼šæ´¾ç”Ÿç±»è¦å¤åˆ¶åŸºç±»é‚£éƒ¨åˆ†çš„æˆå‘˜å˜é‡ using Customer::Customer; //å‚è€ƒR09 VipCustomer(const VipCustomer\u0026 rhs) :priority_(rhs.priority_),Customer(rhs){} VipCustomer\u0026 operator=(const VipCustomer\u0026 rhs){ Customer::operator=(rhs); priority_ = rhs.priority_; return *this; } void setPriority(int priority) { priority_ = priority; }; private: int priority_;//å­ç±»ç‹¬æœ‰æˆå‘˜å¯ä»¥å•ç‹¬setå‡½æ•°èµ‹å€¼ï¼Œæˆ–è€…æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨èµ‹å€¼ }; ä¸è¦ç”¨ä¸€ä¸ªCopyingå‡½æ•°å»å®ç°å¦ä¸€ä¸ª ä»¤copy-assignmentæ“ä½œç¬¦è°ƒç”¨copyæ„é€ å‡½æ•°æ˜¯ä¸åˆç†çš„ï¼›åä¹‹ï¼Œåè€…è°ƒç”¨å‰è€…ä¹Ÿæ˜¯æ— æ„ä¹‰çš„ã€‚ å¦‚æœ2è€…æœ‰å¤§é‡çš„ä»£ç æ˜¯ç›¸åŒçš„ï¼Œå¯ä»¥å‰¥ç¦»ä¸€ä¸ªç±»å†…privateç±»å‹çš„initå‡½æ•°å‡ºæ¥ï¼Œæä¾›ç»™ä¸Šè¿°2è€…è°ƒç”¨ã€‚ ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:2:8","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["C++"],"content":"ref: [1]. https://blog.csdn.net/cltcj/category_12098441.html [2]. https://kissingfire123.github.io/2021/12/06_effective-c-%e4%b9%8b%e5%ad%a6%e4%b9%a0%e6%80%bb%e7%bb%93%e4%b8%80/ ","date":"2023-07-29","objectID":"/posts/effective_cpp_part_one/:3:0","tags":["Effective"],"title":"Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]","uri":"/posts/effective_cpp_part_one/"},{"categories":["draft"],"content":"åˆ†é…å™¨ åˆ†é…å™¨æœ€åˆæ˜¯ä¸ºæŠ½è±¡å†…å­˜æ¨¡å‹è€Œå¼€å‘çš„ï¼Œå…è®¸åº“å¼€å‘è€…å¿½ç•¥åœ¨æŸäº›16ä½æ“ä½œç³»ç»Ÿä¸Šnearå’ŒfaræŒ‡é’ˆçš„åŒºåˆ«ï¼Œä¹Ÿè¢«è®¾è®¡æˆä¿ƒè¿›å…¨åŠŸèƒ½å†…å­˜ç®¡ç†å™¨çš„å‘å±•ï¼Œä½†äº‹å®è¡¨æ˜é‚£ç§æ–¹æ³•åœ¨STLçš„ä¸€äº›éƒ¨åˆ†ä¼šå¯¼è‡´æ•ˆç‡æŸå¤±ã€‚ åˆ†é…å™¨æœ€åˆè¢«è®¾æƒ³ä¸ºæŠ½è±¡å†…å­˜æ¨¡å‹ï¼Œåœ¨é‚£ç§æƒ…å†µä¸‹ï¼Œåˆ†é…å™¨åœ¨å®ƒä»¬å®šä¹‰çš„å†…å­˜æ¨¡å‹ä¸­æä¾›æŒ‡é’ˆå’Œå¼•ç”¨çš„typedefæ‰æœ‰æ„ä¹‰ã€‚åœ¨C++æ ‡å‡†é‡Œï¼Œç±»å‹Tçš„å¯¹è±¡çš„é»˜è®¤åˆ†é…å™¨ï¼ˆå·§å¦™åœ°ç§°ä¸ºallocator\u003cT\u003eï¼‰æä¾›typedef allocator\u003cT\u003e::pointerå’Œallocator\u003cT\u003e::referenceï¼Œè€Œä¸”ä¹Ÿå¸Œæœ›ç”¨æˆ·å®šä¹‰çš„åˆ†é…å™¨ä¹Ÿæä¾›è¿™äº›typedefã€‚ å»ºç«‹è¡Œä¸ºåƒå¼•ç”¨çš„å¯¹è±¡æ˜¯ä½¿ç”¨ä»£ç†å¯¹è±¡çš„ä¾‹å­ï¼Œè€Œä»£ç†å¯¹è±¡ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ã€‚ å®é™…ä¸Šæ ‡å‡†æ˜ç¡®åœ°å…è®¸åº“å®ç°å‡è®¾æ¯ä¸ªåˆ†é…å™¨çš„pointer typedefæ˜¯T*çš„åŒä¹‰è¯ï¼Œæ¯ä¸ªåˆ†é…å™¨çš„reference typedefä¸T\u0026ç›¸åŒã€‚å¯¹ï¼Œåº“å®ç°å¯ä»¥å¿½è§†typedefå¹¶ç›´æ¥ä½¿ç”¨åŸå§‹æŒ‡é’ˆå’Œå¼•ç”¨ï¼ åˆ†é…å™¨æ˜¯å¯¹è±¡ï¼Œé‚£è¡¨æ˜å®ƒä»¬å¯èƒ½æœ‰æˆå‘˜åŠŸèƒ½ï¼Œå†…åµŒçš„ç±»å‹å’Œtypedefï¼ˆä¾‹å¦‚pointerå’Œreferenceï¼‰ç­‰ç­‰ï¼Œä½†æ ‡å‡†å…è®¸STLå®ç°è®¤ä¸ºæ‰€æœ‰ç›¸åŒç±»å‹çš„åˆ†é…å™¨å¯¹è±¡éƒ½æ˜¯ç­‰ä»·çš„è€Œä¸”æ¯”è¾ƒèµ·æ¥æ€»æ˜¯ç›¸ç­‰ã€‚ template\u003ctypename T\u003e // ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„åˆ†é…å™¨ class SpecialAllocator {...}; // æ¨¡æ¿ typedef SpecialAllocator\u003cWidget\u003e SAW; // SAW = â€œSpecialAllocator for Widgetsâ€ list\u003cWidget, SAW\u003e L1; list\u003cWidget, SAW\u003e L2; ... L1.splice(L1.begin(), L2); // æŠŠL2çš„èŠ‚ç‚¹ç§»åˆ° L1å‰ç«¯ è®°ä½å½“listå…ƒç´ ä»ä¸€ä¸ªlistè¢«æ¥åˆåˆ°å¦ä¸€ä¸ªæ—¶ï¼Œæ²¡æœ‰æ‹·è´ä»€ä¹ˆã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œè°ƒæ•´äº†ä¸€äº›æŒ‡é’ˆï¼Œæ›¾ç»åœ¨ä¸€ä¸ªlistä¸­çš„èŠ‚ç‚¹å‘ç°ä»–ä»¬è‡ªå·±ç°åœ¨åœ¨å¦ä¸€ä¸ªlistä¸­ã€‚è¿™ä½¿æ¥åˆæ“ä½œæ—¢è¿…é€Ÿåˆå¼‚å¸¸å®‰å…¨ã€‚ å½“L1è¢«é”€æ¯æ—¶ï¼Œå½“ç„¶ï¼Œå®ƒå¿…é¡»é”€æ¯å®ƒçš„æ‰€æœ‰èŠ‚ç‚¹ï¼ˆä»¥åŠå›æ”¶å®ƒä»¬çš„å†…å­˜ï¼‰ï¼Œè€Œå› ä¸ºå®ƒç°åœ¨åŒ…å«æœ€åˆæ˜¯L2ä¸€éƒ¨åˆ†çš„èŠ‚ç‚¹ï¼ŒL1çš„åˆ†é…å™¨å¿…é¡»å›æ”¶æœ€åˆç”±L2çš„åˆ†é…å™¨åˆ†é…çš„èŠ‚ç‚¹ã€‚ ç°åœ¨æ¸…æ¥šä¸ºä»€ä¹ˆæ ‡å‡†å…è®¸STLå®ç°è®¤ä¸ºç›¸åŒç±»å‹çš„åˆ†é…å™¨ç­‰ä»·ã€‚æ‰€ä»¥ç”±ä¸€ä¸ªåˆ†é…å™¨å¯¹è±¡ï¼ˆæ¯”å¦‚L2ï¼‰åˆ†é…çš„å†…å­˜å¯ä»¥å®‰å…¨åœ°è¢«å¦ä¸€ä¸ªåˆ†é…å™¨å¯¹è±¡ï¼ˆæ¯”å¦‚L1ï¼‰å›æ”¶ã€‚ STLå®ç°å¯ä»¥è®¤ä¸ºç›¸åŒç±»å‹çš„åˆ†é…å™¨ç­‰ä»·æ˜¯å¤šä¸¥å‰çš„çº¦æŸã€‚é‚£æ„å‘³ç€å¯ç§»æ¤çš„åˆ†é…å™¨å¯¹è±¡â€”â€”ä¸èƒ½æœ‰çŠ¶æ€ã€‚è®©æˆ‘ä»¬æ˜ç¡®è¿™ä¸€ç‚¹ï¼šå®ƒæ„å‘³ç€å¯ç§»æ¤çš„åˆ†é…å™¨ä¸èƒ½æœ‰ä»»ä½•éé™æ€æ•°æ®æˆå‘˜ï¼Œè‡³å°‘æ²¡æœ‰ä¼šå½±å“å®ƒä»¬è¡Œä¸ºçš„ã€‚ ","date":"2023-07-29","objectID":"/posts/clause_10/:1:0","tags":["draft"],"title":"Effective STL [10] | æ³¨æ„åˆ†é…å™¨çš„åå®šå’Œçº¦æŸ","uri":"/posts/clause_10/"},{"categories":["draft"],"content":"åˆ†é…åŸå§‹å†…å­˜ åˆ†é…å™¨åœ¨åˆ†é…åŸå§‹å†…å­˜æ–¹é¢ç±»ä¼¼operator newï¼Œä½†å®ƒä»¬çš„æ¥å£ä¸åŒã€‚å¦‚æœä½ çœ‹çœ‹operator newå’Œallocator::allocateæœ€æ™®é€šå½¢å¼çš„å£°æ˜ï¼Œå°±ä¼šå¾ˆæ¸…æ¥šã€‚ void* operator new(size_t bytes); pointer allocator\u003cT\u003e::allocate(size_type numObjects); // è®°ä½äº‹å®ä¸Šâ€œpointerâ€æ€»æ˜¯ T*çš„typedef ä¸¤è€…éƒ½å¸¦æœ‰ä¸€ä¸ªæŒ‡å®šè¦åˆ†é…å¤šå°‘å†…å­˜çš„å‚æ•°ï¼Œä½†å¯¹äºoperator newï¼Œè¿™ä¸ªå‚æ•°æŒ‡å®šçš„æ˜¯å­—èŠ‚æ•°ï¼Œè€Œå¯¹äºallocator::allocateï¼Œå®ƒæŒ‡å®šçš„æ˜¯å†…å­˜é‡Œè¦èƒ½å®¹çº³å¤šå°‘ä¸ªTå¯¹è±¡ã€‚ é€šå¸¸allocator::size_typeæ˜¯ä¸€ä¸ªsize_tçš„typedefã€‚ operator newå’Œallocator::allocateçš„è¿”å›ç±»å‹ä¹Ÿä¸åŒã€‚operator newè¿”å›voidï¼Œé‚£æ˜¯C++ä¼ ç»Ÿçš„è¡¨ç¤ºä¸€ä¸ªåˆ°æœªåˆå§‹åŒ–å†…å­˜çš„æŒ‡é’ˆçš„æ–¹å¼ã€‚allocator::allocateè¿”å›ä¸€ä¸ªTï¼ˆé€šè¿‡pointer typedefï¼‰ï¼Œä¸ä»…ä¸ä¼ ç»Ÿï¼Œè€Œä¸”æ˜¯æœ‰é¢„è°‹çš„æ¬ºè¯ˆã€‚ä»allocator::allocateè¿”å›çš„æŒ‡é’ˆå¹¶ä¸æŒ‡å‘ä¸€ä¸ªTå¯¹è±¡ï¼Œå› ä¸ºTè¿˜æ²¡æœ‰è¢«æ„é€ ï¼ ","date":"2023-07-29","objectID":"/posts/clause_10/:2:0","tags":["draft"],"title":"Effective STL [10] | æ³¨æ„åˆ†é…å™¨çš„åå®šå’Œçº¦æŸ","uri":"/posts/clause_10/"},{"categories":["draft"],"content":"å¤§å¤šæ•°æ ‡å‡†å®¹å™¨ä»æœªè°ƒç”¨å®ƒä»¬ä¾‹ç¤ºçš„åˆ†é…å™¨ list\u003cint\u003e L; // å’Œlist\u003cint, allocator\u003cint\u003e \u003eä¸€æ ·ï¼› allocator\u003cint\u003eä»æœªç”¨æ¥åˆ†é…å†…å­˜ï¼ set\u003cWidget, SAW\u003e s; // è®°ä½SAWæ˜¯ä¸€ä¸ª SpecialAllocator\u003cWidget\u003eçš„typedefï¼› SAWä»æœªåˆ†é…å†…å­˜ï¼ å› ä¸ºsetã€multisetã€mapå’Œmultimapæ˜¯åŸºäºèŠ‚ç‚¹çš„å®¹å™¨ï¼Œå³ï¼Œè¿™äº›å®¹å™¨æ‰€åŸºäºçš„æ•°æ®ç»“æ„æ˜¯æ¯å½“å€¼è¢«å‚¨å­˜å°±åŠ¨æ€åˆ†é…ä¸€ä¸ªæ–°èŠ‚ç‚¹ã€‚å¯¹äºlistï¼ŒèŠ‚ç‚¹æ˜¯åˆ—è¡¨èŠ‚ç‚¹ã€‚ å¯¹äºæ ‡å‡†å…³è”å®¹å™¨ï¼ŒèŠ‚ç‚¹é€šå¸¸æ˜¯æ ‘èŠ‚ç‚¹ï¼Œå› ä¸ºæ ‡å‡†å…³è”å®¹å™¨é€šå¸¸ç”¨å¹³è¡¡äºŒå‰æœç´¢æ ‘å®ç°ã€‚ listæœ¬èº«ç”±èŠ‚ç‚¹ç»„æˆï¼Œæ¯ä¸ªèŠ‚ç‚¹å®¹çº³ä¸€ä¸ªTå¯¹è±¡å’Œåˆ°listä¸­åä¸€ä¸ªå’Œå‰ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼š template\u003ctypename T, // listçš„å¯èƒ½ typename Allocator = allocator\u003cT\u003e \u003e // å®ç° class list{ private: Allocator alloc; // ç”¨äºTç±»å‹å¯¹è±¡çš„åˆ†é…å™¨ struct ListNode{ // é“¾è¡¨é‡Œçš„èŠ‚ç‚¹ T data: ListNode *prev; ListNode *next; }; ... }; å½“æ·»åŠ ä¸€ä¸ªæ–°èŠ‚ç‚¹åˆ°listæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»åˆ†é…å™¨ä¸ºå®ƒè·å–å†…å­˜ï¼Œæˆ‘ä»¬è¦çš„ä¸æ˜¯Tçš„å†…å­˜ï¼Œæˆ‘ä»¬è¦çš„æ˜¯åŒ…å«äº†ä¸€ä¸ªTçš„ListNodeçš„å†…å­˜ã€‚é‚£ä½¿æˆ‘ä»¬çš„Allocatorå¯¹è±¡æ²¡ç”¨äº†ï¼Œå› ä¸ºå®ƒä¸ä¸ºListNodeåˆ†é…å†…å­˜ï¼Œå®ƒä¸ºTåˆ†é…å†…å­˜ã€‚ç°åœ¨ä½ ç†è§£listä¸ºä»€ä¹ˆä»æœªè®©å®ƒçš„Allocatoråšä»»ä½•åˆ†é…äº†ï¼šåˆ†é…å™¨ä¸èƒ½æä¾›listéœ€è¦çš„ã€‚ listéœ€è¦çš„æ˜¯ä»å®ƒçš„åˆ†é…å™¨ç±»å‹é‚£é‡Œè·å¾—ç”¨äºListNodeçš„å¯¹åº”åˆ†é…å™¨çš„æ–¹æ³•ã€‚ template\u003ctypename T\u003e // æ ‡å‡†åˆ†é…å™¨åƒè¿™æ ·å£°æ˜ï¼Œ class allocator { // ä½†ä¹Ÿå¯ä»¥æ˜¯ç”¨æˆ·å†™çš„åˆ†é…å™¨æ¨¡æ¿ public: template\u003ctypename U\u003e struct rebind{ typedef allocator\u003cU\u003e other; } ... }; åœ¨listçš„å®ç°ä»£ç é‡Œï¼Œéœ€è¦ç¡®å®šæˆ‘ä»¬æŒæœ‰çš„Tçš„åˆ†é…å™¨æ‰€å¯¹åº”çš„ListNodeçš„åˆ†é…å™¨ç±»å‹ã€‚æˆ‘ä»¬æŒæœ‰çš„Tçš„åˆ†é…å™¨ç±»å‹æ˜¯æ¨¡æ¿å‚æ•°Allocatorã€‚ åœ¨æœ¬ä¾‹ä¸­ï¼ŒListNodesçš„å¯¹åº”åˆ†é…å™¨ç±»å‹æ˜¯ï¼š Allocator::rebind\u003cListNode\u003e::other æ¯ä¸ªåˆ†é…å™¨æ¨¡æ¿Aï¼ˆä¾‹å¦‚ï¼Œstd::allocatorï¼ŒSpecialAllocatorç­‰ï¼‰éƒ½è¢«è®¤ä¸ºæœ‰ä¸€ä¸ªå«åšrebindçš„å†…åµŒç»“æ„ä½“æ¨¡æ¿ã€‚rebindå¸¦æœ‰ä¸€ä¸ªç±»å‹å‚æ•°U, å¹¶ä¸”åªå®šä¹‰ä¸€ä¸ªtypedef A\u003cU\u003e other. otheræ˜¯A\u003cU\u003eçš„ä¸€ä¸ªç®€å•åå­—ã€‚ ç»“æœï¼ŒListå¯ä»¥é€šè¿‡Allocator::rebind\u003cListNode\u003e::otherä»å®ƒç”¨äºTå¯¹è±¡çš„åˆ†é…å™¨ï¼ˆå«åšAllocatorï¼‰è·å–å¯¹åº”çš„ListNodeå¯¹è±¡åˆ†é…å™¨ã€‚ ","date":"2023-07-29","objectID":"/posts/clause_10/:3:0","tags":["draft"],"title":"Effective STL [10] | æ³¨æ„åˆ†é…å™¨çš„åå®šå’Œçº¦æŸ","uri":"/posts/clause_10/"},{"categories":["draft"],"content":"ç»“è®º å¦‚æœä½ æƒ³è¦å†™è‡ªå®šä¹‰åˆ†é…å™¨ï¼Œè®©æˆ‘ä»¬æ€»ç»“ä½ éœ€è¦è®°å¾—çš„äº‹æƒ…ã€‚ æŠŠä½ çš„åˆ†é…å™¨åšæˆä¸€ä¸ªæ¨¡æ¿ï¼Œå¸¦æœ‰æ¨¡æ¿å‚æ•°Tï¼Œä»£è¡¨ä½ è¦åˆ†é…å†…å­˜çš„å¯¹è±¡ç±»å‹ã€‚ æä¾›pointerå’Œreferenceçš„typedefï¼Œä½†æ˜¯æ€»æ˜¯è®©pointeræ˜¯T*ï¼Œreferenceæ˜¯T\u0026ã€‚ å†³ä¸è¦ç»™ä½ çš„åˆ†é…å™¨æ¯å¯¹è±¡çŠ¶æ€ã€‚é€šå¸¸ï¼Œåˆ†é…å™¨ä¸èƒ½æœ‰éé™æ€çš„æ•°æ®æˆå‘˜ã€‚- è®°å¾—åº”è¯¥ä¼ ç»™åˆ†é…å™¨çš„allocateæˆå‘˜å‡½æ•°éœ€è¦åˆ†é…çš„å¯¹è±¡ä¸ªæ•°è€Œä¸æ˜¯å­—èŠ‚æ•°ã€‚ä¹Ÿåº”è¯¥è®°å¾—è¿™äº›å‡½æ•°è¿”å›T*æŒ‡é’ˆï¼ˆé€šè¿‡pointer typedefï¼‰ï¼Œå³ä½¿è¿˜æ²¡æœ‰Tå¯¹è±¡è¢«æ„é€ ã€‚ ä¸€å®šè¦æä¾›æ ‡å‡†å®¹å™¨ä¾èµ–çš„å†…åµŒrebindæ¨¡æ¿ã€‚ ","date":"2023-07-29","objectID":"/posts/clause_10/:4:0","tags":["draft"],"title":"Effective STL [10] | æ³¨æ„åˆ†é…å™¨çš„åå®šå’Œçº¦æŸ","uri":"/posts/clause_10/"},{"categories":["draft"],"content":"åˆ é™¤æŒ‡å®šå€¼å¯¹è±¡ å‡å®šä½ æœ‰ä¸€ä¸ªå®¹çº³intæ ‡å‡†STLå®¹å™¨: Container\u003cint\u003e c; è€Œä½ æƒ³æŠŠcä¸­æ‰€æœ‰å€¼ä¸º2023çš„å¯¹è±¡éƒ½å»æ‰ã€‚ ä»¤äººåƒæƒŠçš„æ˜¯ï¼Œå®Œæˆè¿™é¡¹ä»»åŠ¡çš„æ–¹æ³•å› ä¸åŒçš„å®¹å™¨ç±»å‹è€Œä¸åŒï¼šæ²¡æœ‰ä¸€ç§æ–¹æ³•æ˜¯é€šç”¨çš„ã€‚ å½“cæ˜¯è¿ç»­å†…å­˜å®¹å™¨ï¼ˆvectorã€dequeæˆ–stringï¼‰ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯erase-removeæƒ¯ç”¨æ³• c.erase(remove(c.begin(), c.end(), 2023), c.end()); // å½“cæ˜¯vectorã€stringæˆ–dequeæ—¶ï¼Œ // erase-removeæƒ¯ç”¨æ³•æ˜¯å»é™¤ç‰¹å®šå€¼çš„å…ƒç´ çš„æœ€ä½³æ–¹æ³• Note STL å’Œ vectorä¸­çš„removeçš„ä½œç”¨æ˜¯å°†ç­‰äºvalueçš„å…ƒç´ æ”¾åˆ°vectorçš„å°¾éƒ¨ï¼Œä½†å¹¶ä¸å‡å°‘vectorçš„sizeï¼› vectorä¸­eraseçš„ä½œç”¨æ˜¯åˆ é™¤æ‰æŸä¸ªä½ç½®positionæˆ–ä¸€æ®µåŒºåŸŸ(begin, end)ä¸­çš„å…ƒç´ ï¼Œå‡å°‘å…¶sizeï¼Œè¿”å›è¢«åˆ é™¤å…ƒç´ ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ã€‚ è¿™æ–¹æ³•ä¹Ÿé€‚åˆäºlistï¼Œä½†æ˜¯listçš„æˆå‘˜å‡½æ•°removeæ›´é«˜æ•ˆï¼š // å½“cæ˜¯listæ—¶ï¼Œremoveæˆå‘˜å‡½æ•°æ˜¯å»é™¤ç‰¹å®šå€¼çš„å…ƒç´ çš„æœ€ä½³æ–¹æ³• c.remove(1963); å½“cæ˜¯æ ‡å‡†å…³è”å®¹å™¨ï¼ˆå³setã€multisetã€mapæˆ–multimapï¼‰æ—¶ï¼Œä½¿ç”¨ä»»ä½•å«åšremoveçš„ä¸œè¥¿éƒ½æ˜¯å®Œå…¨é”™è¯¯çš„ã€‚è¿™æ ·çš„å®¹å™¨æ²¡æœ‰å«åšremoveçš„æˆå‘˜å‡½æ•°ï¼Œè€Œä¸”ä½¿ç”¨removeç®—æ³•å¯èƒ½è¦†ç›–å®¹å™¨å€¼ï¼Œæ½œåœ¨åœ°ç ´åå®¹å™¨ã€‚å¯¹äºå…³è”å®¹å™¨ï¼Œè§£å†³é—®é¢˜çš„é€‚å½“æ–¹æ³•æ˜¯è°ƒç”¨eraseï¼š // å½“cæ˜¯æ ‡å‡†å…³è”å®¹å™¨æ—¶,eraseæˆå‘˜å‡½æ•°æ˜¯å»é™¤ç‰¹å®šå€¼çš„å…ƒç´ çš„æœ€ä½³æ–¹æ³• c.erase(2023); è¿™å¾ˆé«˜æ•ˆï¼ŒåªèŠ±è´¹å¯¹æ•°æ—¶é—´ï¼Œåºåˆ—å®¹å™¨çš„åŸºäºåˆ é™¤çš„æŠ€æœ¯éœ€è¦çº¿æ€§æ—¶é—´ã€‚å¹¶ä¸”ï¼Œå…³è”å®¹å™¨çš„eraseæˆå‘˜å‡½æ•°æœ‰åŸºäºç­‰ä»·è€Œä¸æ˜¯ç›¸ç­‰çš„ä¼˜åŠ¿ã€‚ ","date":"2023-07-28","objectID":"/posts/clause_9/:1:0","tags":["draft"],"title":"Effective STL [9] | åœ¨åˆ é™¤é€‰é¡¹ä¸­ä»”ç»†é€‰æ‹©","uri":"/posts/clause_9/"},{"categories":["draft"],"content":"æ¶ˆé™¤åˆ¤æ–­å¼ æ¶ˆé™¤ä¸‹é¢åˆ¤æ–­å¼ï¼Œè¿”å›çœŸçš„æ¯ä¸ªå¯¹è±¡: bool badValue(int x); // è¿”å›xæ˜¯å¦æ˜¯â€œbadâ€ å¯¹äºåºåˆ—å®¹å™¨ï¼ˆvectorã€stringã€dequeå’Œlistï¼‰ï¼ŒæŠŠæ¯ä¸ªremoveæ›¿æ¢ä¸ºremove_ifï¼š c.erase(remove_if(c.begin(), c.end(), badValue), // å½“cæ˜¯vectorã€stringæˆ–dequeæ—¶ c.end()); // è¿™æ˜¯å»æ‰badValueè¿”å›çœŸçš„å¯¹è±¡çš„æœ€ä½³æ–¹æ³• c.remove_if(badValue); // å½“cæ˜¯listæ—¶è¿™æ˜¯å»æ‰badValueè¿”å›çœŸçš„å¯¹è±¡çš„æœ€ä½³æ–¹æ³• å¯¹äºæ ‡å‡†å…³è”å®¹å™¨ï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¤„ç†è¯¥é—®é¢˜ï¼Œä¸€ä¸ªæ›´å®¹æ˜“ç¼–ç ï¼Œå¦ä¸€ä¸ªæ›´é«˜æ•ˆã€‚ AssocContainer\u003cint\u003e c; // cç°åœ¨æ˜¯ä¸€ç§æ ‡å‡†å…³è”å®¹å™¨ AssocContainer\u003cint\u003e goodValues; // ç”¨äºå®¹çº³ä¸åˆ é™¤çš„å€¼çš„ä¸´æ—¶å®¹å™¨ remove_copy_if(c.begin(), c.end(),inserter(goodValues, goodValues.end()), badValue); c.swap(goodValues); // äº¤æ¢cå’ŒgoodValuesçš„å†…å®¹ å¯¹è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯å®ƒæ‹·è´äº†æ‰€æœ‰ä¸åˆ é™¤çš„å…ƒç´ ã€‚ å› ä¸ºå…³è”å®¹å™¨æ²¡æœ‰æä¾›ç±»ä¼¼remove_ifçš„æˆå‘˜å‡½æ•°ï¼Œæ‰€ä»¥å¿…é¡»å†™ä¸€ä¸ªå¾ªç¯æ¥è¿­ä»£cä¸­çš„å…ƒç´ ï¼Œå’ŒåŸæ¥ä¸€æ ·åˆ é™¤å…ƒç´ ã€‚ä¸å¹¸çš„æ˜¯ï¼Œé‚£äº›æ­£ç¡®å·¥ä½œçš„ä»£ç å¾ˆå°‘æ˜¯è·ƒå‡ºè„‘æµ·çš„ä»£ç ã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯å¾ˆå¤šç¨‹åºå‘˜é¦–å…ˆæƒ³åˆ°çš„ï¼š AssocContainer\u003cint\u003e c; ... for (AssocContainer\u003cint\u003e::iterator i = c.begin(); i!= c.end(); ++i) { // æ¸…æ™°ï¼Œç›´æˆªäº†å½“è€Œæ¼æ´ç™¾å‡ºçš„,ç”¨äºåˆ é™¤cä¸­badValueè¿”å›çœŸçš„æ¯ä¸ªå…ƒç´ çš„ä»£ç  if (badValue(*i)) { c.erase(i); } } // ä¸è¦è¿™ä¹ˆåšï¼ è¿™æœ‰æœªå®šä¹‰çš„è¡Œä¸ºã€‚å½“å®¹å™¨çš„ä¸€ä¸ªå…ƒç´ è¢«åˆ æ—¶ï¼ŒæŒ‡å‘é‚£ä¸ªå…ƒç´ çš„æ‰€æœ‰è¿­ä»£å™¨éƒ½å¤±æ•ˆäº†ã€‚ å½“c.erase(i)è¿”å›æ—¶ï¼Œiå·²ç»å¤±æ•ˆã€‚é‚£å¯¹äºè¿™ä¸ªå¾ªç¯æ˜¯ä¸ªåæ¶ˆæ¯ï¼Œå› ä¸ºåœ¨eraseè¿”å›åï¼Œié€šè¿‡forå¾ªç¯çš„++iéƒ¨åˆ†è‡ªå¢ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»ä¿è¯åœ¨è°ƒç”¨eraseä¹‹å‰å°±å¾—åˆ°äº†cä¸­ä¸‹ä¸€å…ƒç´ çš„è¿­ä»£å™¨ã€‚æœ€å®¹æ˜“çš„æ–¹æ³•æ˜¯å½“æˆ‘ä»¬è°ƒç”¨æ—¶åœ¨iä¸Šä½¿ç”¨åç½®é€’å¢ï¼š AssocContainer\u003cint\u003e c; ... for (AssocContainer\u003cint\u003e::iterator i = c.begin(); i != c.end();/*nothing*/ ){// forå¾ªç¯çš„ç¬¬ä¸‰éƒ¨åˆ†æ˜¯ç©ºçš„ï¼›iç°åœ¨åœ¨ä¸‹é¢è‡ªå¢ if (badValue(*i)) { c.erase(i++); // å¯¹äºåçš„å€¼ï¼ŒæŠŠå½“å‰çš„iä¼ ç»™eraseï¼Œç„¶åä½œä¸ºå‰¯ä½œç”¨å¢åŠ iï¼› } else { ++i; // å¯¹äºå¥½çš„å€¼ï¼Œåªå¢åŠ i } } ç²¾é«“çš„åœ°æ–¹åœ¨äºï¼šè¿™ç§è°ƒç”¨eraseçš„è§£å†³æ–¹æ³•å¯ä»¥å·¥ä½œï¼Œå› ä¸ºè¡¨è¾¾å¼i++çš„å€¼æ˜¯içš„æ—§å€¼ï¼Œä½†ä½œä¸ºå‰¯ä½œç”¨ï¼Œiå¢åŠ äº†ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬æŠŠiçš„æ—§å€¼ï¼ˆæ²¡å¢åŠ çš„ï¼‰ä¼ ç»™eraseï¼Œä½†åœ¨eraseå¼€å§‹æ‰§è¡Œå‰iå·²ç»è‡ªå¢äº†ã€‚ ç°åœ¨ä¸ä»…åˆ é™¤badValueè¿”å›çœŸçš„æ¯ä¸ªå…ƒç´ ï¼Œè€Œä¸”æ¯å½“ä¸€ä¸ªå…ƒç´ è¢«åˆ æ‰æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿæƒ³æŠŠä¸€æ¡æ¶ˆæ¯å†™åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ã€‚ å¯ä»¥é€šè¿‡ç›´æ¥ä»åŸå®¹å™¨åˆ é™¤å…ƒç´ æ¥é¿å¼€æ‹·è´ã€‚ â€œæ›´å®¹æ˜“ä½†æ•ˆç‡è¾ƒä½â€çš„è§£å†³æ–¹æ¡ˆç”¨remove_copy_ifæŠŠéœ€è¦çš„å€¼æ‹·è´åˆ°ä¸€ä¸ªæ–°å®¹å™¨ä¸­ï¼Œç„¶åæŠŠåŸå®¹å™¨çš„å†…å®¹å’Œæ–°çš„äº¤æ¢ï¼š å¯¹äºå…³è”å®¹å™¨ï¼Œè¿™è¯´å¤šå®¹æ˜“å°±æœ‰å¤šå®¹æ˜“ï¼Œå› ä¸ºåªéœ€è¦å¯¹åˆšæ‰å¼€å‘çš„å¾ªç¯åšä¸€ä¸ªå¾®ä¸è¶³é“çš„ä¿®æ”¹å°±è¡Œäº†ï¼š ofstream logFile; // è¦å†™å…¥çš„æ—¥å¿—æ–‡ä»¶ AssocContainer\u003cint\u003e c; ... for (AssocContainer\u003cint\u003e::iterator i = c.begin(); i !=c.end();){// å¾ªç¯æ¡ä»¶å’Œå‰é¢ä¸€æ · if (badValue(*i)){ logFile \u003c\u003c \"Erasing \" \u003c\u003c *i \u003c\u003c'\\n'; // å†™æ—¥å¿—æ–‡ä»¶ c.erase(i++); // åˆ é™¤å…ƒç´  } else { ++i; } } ç°åœ¨æ˜¯vectorã€stringå’Œdequeä¸èƒ½å†ä½¿ç”¨erase-removeæƒ¯ç”¨æ³•ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•è®©eraseæˆ–removeå†™æ—¥å¿—æ–‡ä»¶ã€‚ è€Œä¸”ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨åˆšåˆšä¸ºå…³è”å®¹å™¨å¼€å‘çš„å¾ªç¯ï¼Œå› ä¸ºå®ƒä¸ºvectorã€stringå’Œdequeäº§ç”Ÿæœªå®šä¹‰çš„è¡Œä¸ºï¼ è¦è®°å¾—å¯¹äºé‚£æ ·çš„å®¹å™¨ï¼Œè°ƒç”¨eraseä¸ä»…ä½¿æ‰€æœ‰æŒ‡å‘è¢«åˆ å…ƒç´ çš„è¿­ä»£å™¨å¤±æ•ˆï¼Œä¹Ÿä½¿è¢«åˆ å…ƒç´ ä¹‹åçš„æ‰€æœ‰è¿­ä»£å™¨å¤±æ•ˆã€‚ åŒ…æ‹¬æ‰€æœ‰iä¹‹åçš„è¿­ä»£å™¨ã€‚æˆ‘ä»¬å†™i++ï¼Œ++iæˆ–ä½ èƒ½æƒ³èµ·çš„å…¶å®ƒä»»ä½•ä¸œè¥¿éƒ½æ²¡æœ‰ç”¨ï¼Œå› ä¸ºæ²¡æœ‰èƒ½å¯¼è‡´è¿­ä»£å™¨æœ‰æ•ˆçš„ã€‚å¿…é¡»åˆ©ç”¨eraseçš„è¿”å›å€¼ã€‚é‚£ä¸ªè¿”å›å€¼æ­£æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼šä¸€æ—¦åˆ é™¤å®Œæˆï¼Œå®ƒå°±æ˜¯æŒ‡å‘ç´§æ¥åœ¨è¢«åˆ å…ƒç´ ä¹‹åçš„å…ƒç´ çš„æœ‰æ•ˆè¿­ä»£å™¨ã€‚ æˆ‘ä»¬è¿™ä¹ˆå†™ï¼š for (SeqContainer\u003cint\u003e::iterator i = c.begin(); i != c.end();){ if (badValue(*i)){ logFile \u003c\u003c \"Erasing \" \u003c\u003c *i \u003c\u003c '\\n'; i = c.erase(i); // é€šè¿‡æŠŠeraseçš„è¿”å›å€¼ } // èµ‹ç»™iæ¥ä¿æŒiæœ‰æ•ˆ else { ++i; } } è¿™å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œï¼Œä½†åªç”¨äºæ ‡å‡†åºåˆ—å®¹å™¨ã€‚ æ ‡å‡†å…³è”å®¹å™¨çš„eraseçš„è¿”å›ç±»å‹æ˜¯voidã€‚å¯¹äºé‚£äº›å®¹å™¨ï¼Œä½ å¿…é¡»ä½¿ç”¨â€œåç½®é€’å¢ä½ è¦ä¼ ç»™eraseçš„è¿­ä»£å™¨â€æŠ€æœ¯ã€‚ä¸ºäº†é¿å…ä½ å¥‡æ€ªlistçš„é€‚å½“æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œäº‹å®è¡¨æ˜å¯¹äºè¿­ä»£å’Œåˆ é™¤ï¼Œä½ å¯ä»¥åƒvector/string/dequeä¸€æ ·æˆ–åƒå…³è”å®¹å™¨ä¸€æ ·å¯¹å¾…listï¼›ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥ä¸ºlistå·¥ä½œã€‚ ","date":"2023-07-28","objectID":"/posts/clause_9/:2:0","tags":["draft"],"title":"Effective STL [9] | åœ¨åˆ é™¤é€‰é¡¹ä¸­ä»”ç»†é€‰æ‹©","uri":"/posts/clause_9/"},{"categories":["draft"],"content":"ç»“è®º å»é™¤ä¸€ä¸ªå®¹å™¨ä¸­æœ‰ç‰¹å®šå€¼çš„æ‰€æœ‰å¯¹è±¡ï¼š å¦‚æœå®¹å™¨æ˜¯vectorã€stringæˆ–dequeï¼Œä½¿ç”¨erase-removeæƒ¯ç”¨æ³• å¦‚æœå®¹å™¨æ˜¯listï¼Œä½¿ç”¨list::remove å¦‚æœå®¹å™¨æ˜¯æ ‡å‡†å…³è”å®¹å™¨ï¼Œä½¿ç”¨å®ƒçš„eraseæˆå‘˜å‡½æ•° å»é™¤ä¸€ä¸ªå®¹å™¨ä¸­æ»¡è¶³ä¸€ä¸ªç‰¹å®šåˆ¤å®šå¼çš„æ‰€æœ‰å¯¹è±¡ï¼š å¦‚æœå®¹å™¨æ˜¯vectorã€stringæˆ–dequeï¼Œä½¿ç”¨erase-remove_ifæƒ¯ç”¨æ³• å¦‚æœå®¹å™¨æ˜¯listï¼Œä½¿ç”¨list::remove_if å¦‚æœå®¹å™¨æ˜¯æ ‡å‡†å…³è”å®¹å™¨ï¼Œä½¿ç”¨remove_copy_ifå’Œswapï¼Œæˆ–å†™ä¸€ä¸ªå¾ªç¯æ¥éå†å®¹å™¨å…ƒç´ ï¼Œå½“ä½ æŠŠè¿­ä»£å™¨ä¼ ç»™eraseæ—¶è®°å¾—åç½®é€’å¢å®ƒ åœ¨å¾ªç¯å†…åšæŸäº›äº‹æƒ…ï¼ˆé™¤äº†åˆ é™¤å¯¹è±¡ä¹‹å¤–ï¼‰ï¼š å¦‚æœå®¹å™¨æ˜¯æ ‡å‡†åºåˆ—å®¹å™¨ï¼Œå†™ä¸€ä¸ªå¾ªç¯æ¥éå†å®¹å™¨å…ƒç´ ï¼Œæ¯å½“è°ƒç”¨eraseæ—¶è®°å¾—éƒ½ç”¨å®ƒçš„è¿”å›å€¼æ›´æ–°ä½ çš„è¿­ä»£å™¨ã€‚ å¦‚æœå®¹å™¨æ˜¯æ ‡å‡†å…³è”å®¹å™¨ï¼Œå†™ä¸€ä¸ªå¾ªç¯æ¥éå†å®¹å™¨å…ƒç´ ï¼Œå½“ä½ æŠŠè¿­ä»£å™¨ä¼ ç»™eraseæ—¶è®°å¾—åç½®é€’å¢å®ƒã€‚ å¦‚ä½ æ‰€è§ï¼Œä¸ä»…ä»…è°ƒç”¨eraseç›¸æ¯”ï¼Œæœ‰æ•ˆåœ°åˆ é™¤å®¹å™¨å…ƒç´ æœ‰æ›´å¤šçš„ä¸œè¥¿ã€‚ è§£å†³é—®é¢˜çš„æœ€å¥½æ–¹æ³•å–å†³äºä½ æ˜¯æ€æ ·é‰´åˆ«å‡ºå“ªä¸ªå¯¹è±¡æ˜¯è¦è¢«å»æ‰çš„ï¼Œå‚¨å­˜å®ƒä»¬çš„å®¹å™¨çš„ç±»å‹ï¼Œå’Œå½“ä½ åˆ é™¤å®ƒä»¬çš„æ—¶å€™ä½ è¿˜æƒ³è¦åšä»€ä¹ˆï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚ è¿™ä»…å¯¹å¸¦æœ‰è¿­ä»£å™¨å®å‚çš„eraseå½¢å¼æ˜¯æ­£ç¡®çš„ã€‚å…³è”å®¹å™¨ä¹Ÿæä¾›ä¸€ä¸ªå¸¦æœ‰ä¸€ä¸ªå€¼çš„å®å‚çš„eraseå½¢å¼ï¼Œè€Œé‚£ç§å½¢å¼è¿”å›è¢«åˆ æ‰çš„å…ƒç´ ä¸ªæ•°ã€‚ä½†è¿™é‡Œï¼Œæˆ‘ä»¬åªå…³å¿ƒé€šè¿‡è¿­ä»£å™¨åˆ é™¤ä¸œè¥¿ã€‚ ","date":"2023-07-28","objectID":"/posts/clause_9/:3:0","tags":["draft"],"title":"Effective STL [9] | åœ¨åˆ é™¤é€‰é¡¹ä¸­ä»”ç»†é€‰æ‹©","uri":"/posts/clause_9/"},{"categories":["ML"],"content":"å¼•å…¥ Notes æœ¬æ–‡ä¹Ÿæ˜¯ä¸ºå†™ Stable Diffusion ç›¸å…³æ–‡ç« åšçš„é“ºå«ï¼Œä¸»è¦å‚è€ƒäº†æå®æ¯…è€å¸ˆçš„è§†é¢‘è¯¾ä»¥åŠBç«™çš„ç™½æ¿æ¨å¯¼ç³»åˆ—ã€‚æœ‰å…³GMMã€è’™ç‰¹å¡æ´›ã€ELBOã€å˜åˆ†æ¨æ–­ã€é‡å‚æ•°åŒ–çš„ç»†èŠ‚æœ¬æ–‡ä¸åšè¯¦ç»†ä»‹ç»ï¼Œä¸»è¦å›´ç»•VAEçš„ç»“æ„ä»¥åŠlossä¼˜åŒ–æ¨å¯¼åšè®²è§£ã€‚ æˆ‘ä»¬å…ˆæ¥ç®€å•çš„å¼•å…¥ä¸€ä¸‹ï¼š Vï¼šå˜åˆ†æ¨æ–­ï¼Œå®ƒçš„æ„æ€æ¥è‡ªäºæ¦‚ç‡å›¾æ¨¡å‹ï¼Œæœ¬æ–‡ä¼šç»™å‡ºå˜åˆ†ä¸‹ç•Œçš„è¯¦ç»†æ¨å¯¼ï¼› AEï¼šAuto-Encoderï¼Œè‡ªç¼–ç å™¨ï¼› VAEï¼šVariational Auto-Encoderï¼Œå˜åˆ†è‡ªç¼–ç å™¨ï¼Œå°†æ¦‚ç‡å›¾æ¨¡å‹å’Œç¥ç»ç½‘ç»œç›¸ç»“åˆçš„æ¨¡å‹ï¼› ","date":"2023-07-27","objectID":"/posts/vae_1/:1:0","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"ä¸€ã€AE å…ˆæ¥ä»‹ç»ä¸€ä¸‹è‡ªç¼–ç å™¨(Auto-Encoder)ï¼Œå®ƒæ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒåŸç†å¯æ¦‚è¿°ä¸ºï¼š å°†é«˜ç»´åŸå§‹æ•°æ®(å¦‚å›¾ç‰‡)é€å…¥ Encoderï¼Œåˆ©ç”¨ Encoder å°†é«˜ç»´æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªä½ç»´ç©ºé—´ï¼Œå°†nç»´å‹ç¼©åˆ°mç»´($mÂ«n$)ï¼Œæˆ‘ä»¬ç”¨éšå˜é‡æ¥è¡¨ç¤ºï¼› ç„¶åå°†ä½ç»´ç©ºé—´çš„ç‰¹å¾é€å…¥ Decoder è¿›è¡Œè§£ç ï¼Œä»¥æ­¤æ¥é‡å»ºåŸå§‹è¾“å…¥æ•°æ®ã€‚ Note Encoderã€Decoderç½‘ç»œå¯ä»¥ä¸ºæ™®é€šçš„å…¨è¿æ¥ã€ä¹Ÿå¯ä»¥ä¸ºCNNã€æˆ–è€…ç±»ä¼¼äºUnetéƒ½å¯ä»¥ï¼Œæ²¡æœ‰å›ºå®šçš„è¦æ±‚ã€‚ è¿™é‡Œä¸ºå’Œåæ–‡çš„æ¨å¯¼è”ç³»èµ·æ¥ï¼Œæˆ‘ä»¬å°† Encoder ç½‘ç»œçš„æ˜ å°„å‡½æ•°å®šä¹‰ä¸º $q_{\\phi}$ ã€Decoder ç½‘ç»œå®šä¹‰ä¸º $p_{\\theta}$ï¼Œå…¶ä¸­ $\\phi$ã€$\\theta$ çš†ä¸ºç½‘ç»œå‚æ•°ã€‚ é‚£ä¹ˆå¯¹äºè¾“å…¥ $x$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Encoderå¾—åˆ° Latent Variableï¼š$z = q_{\\phi}(x)$ï¼Œç„¶åDecoderå¯ä»¥ä»éšå˜é‡zä¸­å¯¹åŸå§‹æ•°æ®è¿›è¡Œé‡å»ºï¼š$xâ€™ = p_{\\theta}(z) = p_{\\theta}(q_{\\phi}(x))$ã€‚ æˆ‘ä»¬å¸Œæœ›é‡å»ºçš„æ•°æ®å’ŒåŸæ¥çš„æ•°æ®è¿‘ä¼¼ä¸€è‡´ï¼Œå³æœ€å°åŒ–è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„é‡æ„è¯¯å·®ï¼Œé‚£ä¹ˆAEçš„è®­ç»ƒæŸå¤±å¯ä»¥é‡‡ç”¨ç®€å•çš„MSEï¼š $$L_{\\text{AE}}(\\theta, \\phi) = \\frac{1}{n}\\sum_{i=1}^{n} (x^{(i)} - xâ€™^{(i)})^2 =\\frac{1}{n}\\sum_{i=1}^{n} (x^{(i)} - p_{\\theta}(q_{\\phi}(x^{(i)})))^2$$ Note å¯ä»¥ç†è§£ä¸ºæ¯”è¾ƒè¾“å…¥å’Œé‡æ„è¾“å…¥çš„åƒç´ ç‚¹çš„è¯¯å·®ã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:2:0","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"äºŒã€AE å­˜åœ¨çš„é—®é¢˜ ä¸Šé¢æˆ‘ä»¬é€šè¿‡AEå¯ä»¥æ„å»ºä¸€ä¸ªé‡æ„å›¾åƒçš„æ¨¡å‹ï¼Œä½†æ˜¯è¿™ä¸ªæ¨¡å‹å¹¶ä¸èƒ½æ»¡è¶³è¦æ±‚ï¼Œæˆ–è€…è¯´å®ƒå¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ç”Ÿæˆæ¨¡å‹ã€‚å¯¹äºä¸€ä¸ªç”Ÿæˆæ¨¡å‹è€Œè¨€ï¼Œå®ƒæ»¡è¶³ï¼š Encoder å’Œ Decoder å¯ä»¥ç‹¬ç«‹æ‹†åˆ†(ç±»æ¯” GAN çš„ Generator å’Œ Discriminator)ï¼› å›ºå®šç»´åº¦ä¸‹ä»»æ„é‡‡æ ·å‡ºæ¥çš„ç¼–ç ï¼Œéƒ½åº”è¯¥èƒ½é€šè¿‡ Decoder äº§ç”Ÿä¸€å¼ æ¸…æ™°ä¸”é€¼çœŸçš„å›¾ç‰‡ã€‚ å½“ç„¶å¯¹äºç¬¬ä¸€ç‚¹å®ƒæ˜¯æ»¡è¶³çš„ï¼Œæˆ‘ä»¬ä¸»è¦åˆ†æç¬¬äºŒç‚¹ï¼Œä¹Ÿå°±æ˜¯AEå­˜åœ¨çš„é—®é¢˜ï¼Œä»è€Œå¼•å‡ºVAEã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç”¨ä¸€å¼ å…¨æœˆå›¾å’Œä¸€å¼ åŠæœˆå›¾å»è®­ç»ƒä¸€ä¸ªAEï¼Œç»è¿‡è®­ç»ƒæ¨¡å‹æ˜¯èƒ½å¤Ÿå¾ˆå¥½çš„è¿˜åŸå‡ºè¿™ä¸¤å¼ å›¾ç‰‡ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ latent code ä¸­ä»»å–ä¸€ç‚¹ï¼Œå°†å…¶äº¤ç»™ Decoder è¿›è¡Œè§£ç ï¼Œç›´è§‰ä¸Šæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€å¼ ä»‹äºå…¨æœˆå’ŒåŠæœˆä¹‹å‰çš„å›¾ç‰‡(æ¯”å¦‚é˜´å½±é¢ç§¯è¦†ç›–çš„æ ·å­)ã€‚ç„¶è€Œå®é™…ä¸Šçš„è¾“å‡ºå›¾ç‰‡ä¸ä»…æ¨¡ç³Šè€Œä¸”è¿˜æ˜¯ä¹±ç çš„ã€‚ å¯¹äºè¿™ä¸ªç°è±¡ï¼Œä¸€ä¸ªç›´è§‚çš„è§£é‡Šå°±æ˜¯AEçš„ Encoder å’Œ Decoder éƒ½ç”¨äº†DNNï¼Œé‚£ä¹ˆNNåªä¼šå¹²ä¸€ä»¶äº‹æƒ…ï¼šå­¦ä¹ ã€è®°ä½ã€ç”¨è®°ä½çš„ä¸œè¥¿é¢„æµ‹ï¼Œæˆ‘ä»¬ä» latent space ä¸­é‡‡æ ·çš„ç‚¹ï¼Œç¼–ç å™¨éƒ½æ²¡æœ‰å­¦ä¹ è¿‡ï¼Œæ€ä¹ˆèƒ½å¤ŸæŒ‡æœ›å®ƒç”Ÿæˆå¸Œæœ›çš„å€¼å‘¢? æ¢å¥è¯è¯´ï¼ŒNNåªè®°ä½äº†å·¦è¾¹å…¨æœˆå›¾ç‰‡çš„éšå‘é‡å’Œå³è¾¹åŠæœˆå›¾ç‰‡çš„éšå‘é‡ï¼Œå¹¶ä¸èƒ½æ³›åŒ–åˆ°ä¸­é—´å°±æ˜¯$\\frac{3}{4}$æœˆäº®çš„å›¾ç‰‡ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæœ€ç›´æ¥çš„æ€æƒ³å°±æ˜¯å¼•å…¥å™ªå£°ï¼Œæ‰©å¤§å›¾ç‰‡çš„ç¼–ç åŒºåŸŸï¼Œä»è€Œèƒ½å¤Ÿè¦†ç›–åˆ°å¤±çœŸçš„ç©ºç™½ç¼–ç åŒºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å…¶å®è¯´ç™½äº†å°±æ˜¯é€šè¿‡å¢åŠ è¾“å…¥çš„å¤šæ ·æ€§ä»è€Œå¢å¼ºè¾“å‡ºçš„é²æ£’æ€§ã€‚ å½“æˆ‘ä»¬ç»™è¾“å…¥å›¾ç‰‡è¿›è¡Œç¼–ç ä¹‹å‰å¼•å…¥ä¸€ç‚¹å™ªå£°ï¼Œä½¿å¾—æ¯å¼ å›¾ç‰‡çš„ç¼–ç ç‚¹å‡ºç°åœ¨ç»¿è‰²ç®­å¤´èŒƒå›´å†…ï¼Œè¿™æ ·ä¸€æ¥æ‰€å¾—åˆ°çš„ latent space å°±èƒ½è¦†ç›–åˆ°æ›´å¤šçš„ç¼–ç ç‚¹ã€‚æ­¤æ—¶æˆ‘ä»¬å†ä»ä¸­é—´ç‚¹æŠ½å–è¿˜åŸä¾¿å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ¯”è¾ƒå¸Œæœ›çš„è¾“å‡ºã€‚ è™½ç„¶æˆ‘ä»¬ç»™è¾“å…¥çš„å›¾ç‰‡å¢åŠ äº†ä¸€äº›å™ªå£°ï¼Œä½¿å¾— latent space èƒ½å¤Ÿè¦†ç›–åˆ°æ¯”è¾ƒå¤šçš„åŒºåŸŸï¼Œä½†æ˜¯è¿˜æœ‰ä¸å°‘åœ°æ–¹æ²¡æœ‰è¦†ç›–åˆ°ï¼Œæ¯”å¦‚ä¸Šå›¾çš„é»„è‰²ç‚¹ä½ç½®ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥å°è¯•åˆ©ç”¨æ›´å¤šçš„å™ªå£°ï¼Œä½¿å¾—å¯¹äºæ¯ä¸€ä¸ªè¾“å…¥æ ·æœ¬ï¼Œå®ƒçš„ç¼–ç éƒ½èƒ½å¤Ÿè¦†ç›–åˆ°æ•´ä¸ªç¼–ç ç©ºé—´ï¼Ÿåªä¸è¿‡æˆ‘ä»¬è¿™é‡Œéœ€è¦ä¿è¯çš„æ˜¯ï¼šå¯¹äºç¼–ç é™„è¿‘çš„æˆ‘ä»¬åº”è¯¥ç»™å®šä¸€ä¸ªé«˜çš„æ¦‚ç‡å€¼ï¼Œå¯¹äºè·ç¦»åŸç¼–ç ç‚¹è¿œçš„åº”è¯¥ç»™å®šä¸€ä¸ªä½çš„æ¦‚ç‡å€¼ã€‚ è¿™æ ·æ€»ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å°±æ˜¯è¦å°†åŸå…ˆçš„ä¸€ä¸ªå•ç‚¹æ‹‰ä¼¸åˆ°æ•´ä¸ªç¼–ç ç©ºé—´ï¼Œå³å°†ç¦»æ•£çš„ç¼–ç ç‚¹æ‹‰ä¼¸ä¸ºä¸€æ¡è¿ç»­çš„æ¥è¿‘æ­£å¤ªåˆ†å¸ƒçš„ç¼–ç æ›²çº¿ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™ä¸ªå…¶å®å°±æ˜¯VAEçš„æ€æƒ³ï¼Œç†Ÿæ‚‰GMMçš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œå®ƒæ˜¯Kä¸ªé«˜æ–¯åˆ†å¸ƒ(Gaussian Distribution)çš„æ··åˆï¼Œå…¶å®VAEå¯ä»¥è¯´æ˜¯æ— é™ä¸ªé«˜æ–¯åˆ†å¸ƒçš„æ··åˆã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:3:0","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"ä¸‰ã€VAE ç»“æ„é¢„è§ˆ å¦‚ä¸Šå›¾æ‰€ç¤ºVAEçš„ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°VAEé‡Œçš„ç¼–ç å™¨ä¸æ˜¯è¾“å‡ºéšå‘é‡$z$ï¼Œè€Œæ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œåˆ†å¸ƒçš„å‡å€¼ä¸º$m$ã€æ–¹å·®ä¸º$\\sigma$ï¼Œ$e$ å³ä¸ºç»™ç¼–ç æ·»åŠ çš„å™ªå£°ï¼Œæ¥è‡ªäºæ­£æ€åˆ†å¸ƒã€‚ tips VAEçš„Encoderçš„è¾“å‡ºä¸æ˜¯éšå‘é‡ï¼Œè€Œæ˜¯å‡å€¼ä¸º$m$, æ–¹å·®ä¸º$\\sigma$çš„æ­£æ€åˆ†å¸ƒã€‚ å…¬å¼æ€ä¹ˆå¾—åˆ°çš„åé¢ä¼šç»™å‡ºæ¨å¯¼ï¼Œæˆ‘ä»¬å…ˆæ¥æè¿°ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼š $$z_{i} = c_{i} = \\exp(\\sigma_i) * e_i + m_i$$ $e$ ä¸ºå™ªå£°ï¼Œ$m$ ä¸ºå‡å€¼ï¼Œ $\\sigma$ ä¸ºæ§åˆ¶å™ªå£°$e$çš„æ–¹å·®; Encoderä¼šè®¡ç®—å‡ºä¸¤ç»„ç¼–ç ï¼Œä¸€ç»„ä¸ºå‡å€¼mã€ä¸€ç»„ä¸ºæ§åˆ¶å™ªå£°å¹²æ‰°ç¨‹åº¦çš„æ–¹å·®$\\sigma$; æ–¹å·®$\\sigma$ä¸»è¦ç”¨æ¥ä¸ºå™ªå£°ç¼–ç  $e$ åˆ†é…æƒé‡; å–æŒ‡æ•°ä¸»è¦æ˜¯ä¸ºäº†ä¿è¯åˆ†é…åˆ°çš„æƒé‡æ˜¯æ­£å€¼; ä¹Ÿå°±æ˜¯è¯´æ•°æ®åˆ†å¸ƒä¼šåœ¨ $\\exp(\\sigma_i) * e$ æ–¹å·®èŒƒå›´å†…é‡‡æ ·ä¸€ä¸ªå€¼ï¼Œå¾—åˆ°ä¸€ä¸ªåç§»é‡ï¼Œå°±æ˜¯ç›¸å½“äºæŠŠåŸå§‹çš„æ ·æœ¬åŠ ä¸Šäº†ä¸€ä¸ªå™ªå£°ã€‚ä»ç»“æ„å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæŸå¤±é™¤äº†AEçš„ é‡æ„æŸå¤±(reconstruction error)å¤–ï¼Œè¿˜å¤šå‡ºäº†ä¸‹é¢è¿™ä¸€é¡¹: $$c = (c_1, c_2, c_3) = \\sum_{i=1}^{3} (e^{\\sigma_i} - (1 + \\sigma_i) + (m_i)^2)$$ è¿™ä¸ªè¾…åŠ©losså¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªçº¦æŸï¼Œä¹Ÿå°±æ˜¯è¯´ç”Ÿæˆçš„ $\\sigma$ è¦æ»¡è¶³è¿™ä¸ªçº¦æŸã€‚ ä¸ºä»€ä¹ˆè¦åŠ è¿™ä¸ªè¾…åŠ©lossï¼Ÿ æˆ‘ä»¬æœ€å°åŒ–äº† reconstruction errorï¼Œå¦‚æœä¸åŠ è¿™ä¸ªè¾…åŠ©lossçš„è¯ï¼ŒEncoderè‚¯å®šå¸Œæœ›å™ªå£°å¯¹è‡ªèº«ç”Ÿæˆçš„å›¾ç‰‡å¹²æ‰°è¶Šå°è¶Šå¥½ï¼Œä¸ºäº†ä¿è¯ç”Ÿæˆå›¾ç‰‡çš„è´¨é‡ï¼Œäºæ˜¯åˆ†é…ç»™å™ªå£°çš„æƒé‡ä¹Ÿå°±æ˜¯è¶Šä½ã€‚å¦‚æœä¸åŠ è¿™ä¸ªçº¦æŸçš„è¯ï¼Œç½‘ç»œåªéœ€è¦å°†æ–¹å·®è®¾ç½®ä¸ºæ¥è¿‘è´Ÿæ— ç©·å¤§çš„å€¼ $\\exp ^ {-\\infty} = 0$ï¼Œå³å¯æ¶ˆé™¤å™ªå£°å¸¦æ¥çš„å½±å“ï¼Œè¿™æ ·å¿…ç„¶ä¼šè¿‡æ‹Ÿåˆå¯¼è‡´é²æ£’æ€§ä¸ä½³ã€‚ tips æ·»åŠ è¾…åŠ©lossæ˜¯ä¸ºäº†é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæé«˜æ¨¡å‹çš„é²æ£’æ€§ã€‚ ä¸ºä»€ä¹ˆåŠ è¿™ä¸ªè¾…åŠ©lossæœ‰ç”¨ï¼Ÿ æˆ‘ä»¬å¯¹ $\\sigma$ æ±‚å¯¼å¯å¾— $c = e^{\\sigma} - 1$ï¼Œä»¤å…¶ç­‰äº0å¯æ±‚å‡º $\\sigma = 0$ æ—¶å–å¾—æå°å€¼ï¼Œè¿™æ ·ä¸€æ¥ä¾¿å¯ä»¥çº¦æŸæ–¹å·®ä¸ä¼šä¸€è·¯èµ°å‘è´Ÿæ— ç©·ï¼Œä»è€Œèµ·åˆ°æ­£åˆ™åŒ–çº¦æŸçš„ä½œç”¨ï¼› å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ$e^{\\sigma}$ æ˜¯è“è‰²æ›²çº¿ï¼Œ$1 + \\sigma$ æ˜¯çº¢è‰²çº¿æ¡ï¼Œé‚£ä¹ˆ $e^{\\sigma} - (1 + \\sigma)$å°±æ˜¯è“è‰²æ›²çº¿å‡å»çº¢è‰²ç›´çº¿ï¼Œå¾—åˆ°ç»¿è‰²æ›²çº¿ï¼Œæ˜¾è€Œæ˜“è§çš„å¯ä»¥å‘ç°å®ƒçš„æœ€å°å€¼ä¸º0ã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:4:0","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"å››ã€æ•°å­¦æè¿° ","date":"2023-07-27","objectID":"/posts/vae_1/:5:0","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"4.1ã€ä½œè€…çš„ Intuition å€Ÿç”¨ä½œè€…åŸæ–‡çš„è¡¨è¿°ï¼Œæˆ‘ä»¬æ¥å¼•å…¥å®šä¹‰ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œé¦–å…ˆæˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªé«˜ç»´çš„éšæœºå˜é‡ï¼Œä¸ä¹‹ç›¸å…³è”çš„æˆ‘ä»¬å«å®ƒéšå˜é‡ $z$ï¼Œ$z$ çš„ç»´åº¦ä¸€èˆ¬è¦æ¯” $x$ ä½å¾ˆå¤šï¼Œç”¨æ¥æè¿° $x$ ä¸­æ‰€åŒ…å«çš„ä¿¡æ¯ã€‚ æˆ‘ä»¬å‡è®¾ $z$ æ»¡è¶³åˆ†å¸ƒ $p_{\\theta}(z)$ï¼Œ$x$ ä¹Ÿæ˜¯ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š åœ¨å·²çŸ¥ $z$ çš„æƒ…å†µä¸‹ï¼Œ$p_{\\theta}(z)$èƒ½ç”Ÿæˆä¸€ä¸ªsample $x$ ï¼› ç»™å®šä¸€ä¸ªsample $x$ï¼Œ$q_{\\phi}(x)$ å°±å¯ä»¥å°è¯•æ¨æµ‹å‡ºè¿™ä¸ªæ¥ã€‚ Note å› ä¸ºå‡è®¾$z$æ»¡è¶³ä¸€å®šåˆ†å¸ƒï¼Œæ‰€ä»¥ä¹Ÿæœ‰ä»$\\theta$åˆ°$z$çš„ç®­å¤´ï¼› ä¹‹åæåˆ°çš„$z$éƒ½æ˜¯Decoderé‡Œçš„å‚æ•°ã€‚ è¿™ä¹ˆè¯´å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå‡è®¾æœ‰ä¸€ä¸ªå›¾åƒï¼Œé‡Œé¢æœ‰3ä¸ªé¢œè‰²ä¸ä¸€è‡´çš„å½¢çŠ¶ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥$x$ã€‚é€šè¿‡å³å›¾çš„å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶$x$ï¼Œè¿™å°±æ˜¯éšå˜é‡$z$ã€‚ é‚£ä¹ˆå›åˆ°å®é™…çš„åº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬æƒ³è¦é€šè¿‡$x$è·å¾—$z$ï¼Œåˆæƒ³é€šè¿‡$z$å¾—åˆ°ç›¸åº”çš„$x$ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„åŒç®­å¤´å°±æ˜¯æˆ‘ä»¬æƒ³è¦åšçš„äº‹æƒ…ã€‚ é‚£ä¹ˆå¯¹äºç”Ÿæˆæ¨¡å‹è€Œè¨€ï¼ŒVAEçš„æ•°æ®äº§ç”ŸåŒ…æ‹¬ä¸¤ä¸ªè¿‡ç¨‹ï¼š ä»ä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒ $p_{\\theta}(z)$ ä¸­é‡‡æ ·ä¸€ä¸ª $z^{(i)}$ï¼› æ ¹æ®æ¡ä»¶åˆ†å¸ƒ $p_{\\theta}(x|z)$ï¼Œç”¨ $z^{(i)}$ ç”Ÿæˆ $x^{(i)}$ã€‚ æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªå‚æ•° $\\theta^*$ æ¥æœ€å¤§åŒ–ç”ŸæˆçœŸå®æ•°æ®çš„æ¦‚ç‡ï¼š $$\\theta^*=\\argmax_{\\theta} \\prod_{i=1}^{n}p_{\\theta}(x^{(i)})$$ è¿™é‡Œ $p_{\\theta}(x^{(i)})$ å¯ä»¥é€šè¿‡å¯¹ $z$ ç§¯åˆ†å¾—åˆ°ï¼š $$p_{\\theta}(x^{(i)}) = \\int_{z} p_{\\theta}(x, z) \\mathrm{d}{z} = \\int_{z} p_{\\theta}(z) p_{\\theta}(x^{(i)}|z)\\mathrm{d}{z}$$ å®é™…ä¸Šæˆ‘ä»¬è¦æ ¹æ®ä¸Šè¿°ç§¯åˆ†æ˜¯ä¸å¯èƒ½å®ç°çš„ï¼Œå…ˆéªŒåˆ†å¸ƒ $p_{\\theta}(z)$ æ˜¯æœªçŸ¥çš„ï¼Œè€Œä¸”å¦‚æœåˆ†å¸ƒæ¯”è¾ƒå¤æ‚ä¸”é«˜ç»´ï¼Œå¯¹å…¶ç©·ä¸¾è®¡ç®—ä¹Ÿæ˜¯ä¸ç°å®çš„ã€‚ å˜åˆ†æ¨æ–­å¼•å…¥åéªŒæ¦‚ç‡æ¥è”åˆå»ºæ¨¡ï¼Œå³given $x$ æƒ³è¦å¾—åˆ°å®ƒçš„ $z$ï¼Œæ ¹æ®è´å¶æ–¯å…¬å¼è¡¨ç¤ºä¸ºï¼š $$p_{\\theta}(z | x) = \\frac{p_{\\theta}(x|z) p_{\\theta}(z)}{p_{\\theta}(x)}$$ æˆ‘ä»¬åˆå›åˆ°æœ€ä¸Šé¢çš„å›¾ï¼š å®çº¿ç®­å¤´å°±æ˜¯æˆ‘ä»¬è¦å¾—åˆ°çš„ç”Ÿæˆæ¨¡å‹ $p_{\\theta}(z) p_{\\theta}(x|z)$ï¼Œè¿™é‡Œ $p_{\\theta} (z)$ å¾€å¾€æ˜¯äº‹å…ˆå®šä¹‰å¥½çš„ï¼Œæ¯”å¦‚æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œè€Œ $p_{\\theta}(x|z)$ å¯ä»¥ç”¨ä¸€ä¸ªç½‘ç»œæ¥å­¦ä¹ ï¼Œå®ƒå°±å¯ä»¥çœ‹æˆæ˜¯ Probabilistic Decoderã€‚ è™šçº¿ç®­å¤´ä»£è¡¨å¯¹åéªŒåˆ†å¸ƒ $p_{\\theta}(z|x)$ çš„å˜åˆ†ä¼°è®¡ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªç½‘ç»œå»è¿‘ä¼¼ï¼Œæˆ‘ä»¬è®°ä¸º $q_{\\phi}(z|x)$ï¼Œåˆ™è¿™ä¸ªç½‘ç»œç§°ä¸º Probabilistic Encoderã€‚ æ‰€ä»¥VAEçš„ä¼˜åŒ–ç›®æ ‡å°±æœ‰äº†ï¼Œä¸ºäº†è¾¾åˆ°ä»xä¼°è®¡zçš„è¿‡ç¨‹ï¼Œå¯¹äºä¼°è®¡çš„åéªŒ $q_{\\phi}(z|x)$ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒæ¥è¿‘çœŸå®çš„åéªŒåˆ†å¸ƒ $p_{\\theta}(z|x)$ ï¼Œå³ï¼š $$p_{\\theta}(z|x) \\cong q_{\\phi}(z|x)$$ è¯´ç™½äº†å°±æ˜¯ä½¿ç”¨å¦ä¸€ä¸ªæ¨¡å‹ï¼Œå‚æ•°ç”± $\\phi$ è¡¨ç¤ºï¼Œåœ¨å‚æ•° $\\phi$ çš„å¸®åŠ©ä¸‹ï¼Œæœ‰äº†ä¸€ä¸ªåˆ†å¸ƒ $q$ ï¼Œç°åœ¨å¸Œæœ›åˆ†å¸ƒ $q$ èƒ½å¤Ÿå°½é‡æ¥è¿‘ $p$ï¼Œä»è€Œè¾¾åˆ°ä» $x$ ä¼°è®¡ $z$ çš„è¿‡ç¨‹ã€‚ Note å¯ä»¥çœ‹åˆ°VAEå’ŒAEæ¶æ„ä¸Šè¿˜æ˜¯ç›¸ä¼¼çš„ï¼ŒVAEçš„æœ€ç»ˆç›®æ ‡æ˜¯å¾—åˆ°ç”Ÿæˆæ¨¡å‹å³Decoderï¼ŒEncoderåªæ˜¯è¾…åŠ©å»ºæ¨¡ã€‚ è€ŒAEå¸¸å¸¸æ˜¯ä¸ºäº†å¾—åˆ°Encoderæ¥è¿›è¡Œç‰¹å¾æå–æˆ–å‹ç¼©ã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:5:1","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"4.2ã€å˜åˆ†ä¸‹ç•Œ ä¸ºäº†è¡¡é‡ä¸¤ä¸ª distribution çš„ç›¸ä¼¼ç¨‹åº¦ï¼Œæˆ‘ä»¬åº”è¯¥å¾ˆè‡ªç„¶çš„æƒ³åˆ°äº†KL divergenceï¼Œå› ä¸ºæˆ‘ä»¬å®é™…ä¸Šè®¡ç®—çš„æ˜¯åˆ†å¸ƒ $q$ ï¼Œæ‰€ä»¥æˆ‘ä»¬ä» $q$ çš„è§†è§’æ¥è®¡ç®—å®ƒåˆ° $p$ çš„KLæ•£åº¦ï¼š $$q_{\\phi}(z|x) \\cong p_{\\theta}(z|x) \\rightarrow D_{\\text{KL}}(q_{\\phi}(z|x) || p_{\\theta}(z|x))$$ Note éœ€è¦å†æ¬¡å¼ºè°ƒçš„æ˜¯ï¼š $\\theta$ ä¸º decoder çš„å‚æ•°ï¼› $\\phi$ ä¸º encoder çš„å‚æ•°ã€‚ æ ¹æ®å®šä¹‰æˆ‘ä»¬å°†KL divergenceå±•å¼€ï¼Œå¯¹ $z$ æ±‚å’Œï¼Œè¡¨ç¤ºå¦‚ä¸‹ï¼š $$ \\begin{align} D_{\\text{KL}}(q_{\\phi}(z|x) || p_{\\theta}(z|x)) \u0026= \\sum_{z} q_{\\phi}(z | x) \\log (\\frac{q_{\\phi}(z | x)}{p_{\\theta}(z | x)}) \\cr \u0026= - \\sum_{z} q_{\\phi}(z | x) \\log (\\frac{p_{\\theta}(z | x)}{q_{\\phi}(z | x)})\\cr \u0026= - \\sum_{z} q_{\\phi}(z | x) \\log (\\frac{\\frac{p_{\\theta}(z,x)}{p_{\\theta}(x)}}{q_{\\phi}(z | x)})\\cr \u0026= - \\sum_{z} q_{\\phi}(z | x) [\\log({\\frac{p_{\\theta}(x, z)}{p_{\\theta}(x)}}) - \\log({q_{\\phi}(z | x)})]\\cr \u0026= - \\sum_{z} q_{\\phi}(z | x) [\\log({\\frac{p_{\\theta}(x, z)}{q_{\\phi}(z|x)}}) - \\log({p_{\\theta}(x)})]\\cr \\end{align} $$ Note $p_{\\theta}(z | x)$ æ˜¯æ ¹æ®æ¡ä»¶æ¦‚ç‡å…¬å¼æ‹†å¼€çš„ã€‚ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ³¨æ„åˆ° $\\log(p_{\\theta}(x))$ æ˜¯å’Œ $z$ æ²¡æœ‰å…³ç³»çš„ï¼Œå¹¶ä¸”logé¡¹æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥åœ¨ä¹˜æ±‚å’Œçš„æ—¶å€™ç›´æ¥æåˆ° $\\sum$ å¤–é¢å»å°±å¯ä»¥äº†ï¼Œå¹¶ä¸” $q_{\\phi} (z | x)$ å¯¹ $z$ æ±‚å’Œçš„ç»“æœæ˜¯1ï¼Œé‚£æ‰€ä»¥ $-\\sum_{z}(q_{\\phi}(z|x))(-\\log(p_{\\theta}(x)))$ çš„ç»“æœå°±æ˜¯ $\\log(p_{\\theta}(x))$ï¼Œå®ƒæ˜¯ä¸ªconstã€‚ æˆ‘ä»¬å°†å®ƒç§»åˆ°ç­‰å¼çš„å·¦è¾¹ï¼Œè¡¨ç¤ºå¦‚ä¸‹ï¼š $$ \\begin{align} \\log(p_{\\theta}(x)) \u0026= D_{KL}(q_{\\phi}(z|x) || p_{\\theta}(z|x)) + \\sum_{z}q_{\\phi}(z|x)\\log(\\frac{p_{\\theta}(x, z)}{q_{\\phi}(z|x)}) \\cr \u0026= D_{KL}(q_{\\phi}(z|x) || p_{\\theta}(z|x)) + L(\\theta, \\phi; x) \\end{align} $$ æˆ‘ä»¬å°† $\\sum_{z}q_{\\phi}(z|x)\\log(\\frac{p_{\\theta}(x, z)}{q_{\\phi}(z|x)})$ å†™æˆ $L(\\theta, \\phi; x)$ ï¼Œç­‰å¼å·¦è¾¹æ˜¯ä¸€ä¸ªconstï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ $x$ çš„åˆ†å¸ƒæ˜¯ä»€ä¹ˆæ ·ï¼Œå®ƒå¯¹ $\\theta$ æ¥è¯´æ²¡ä»€ä¹ˆå½±å“ã€‚ç­‰å¼å³è¾¹ï¼ŒKL divergenceæ˜¯ä¸€ä¸ªéè´Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æŠŠ $L(\\theta, \\phi; x)$ çš„å€¼å°½å¯èƒ½çš„æ‹‰å¤§ï¼Œé‚£ä¹ˆKL divergenceçš„å€¼å°±ä¼šéšä¹‹ç¼©å°ã€‚ æƒ³è¦æœ€å¤§åŒ–çš„$L(\\theta, \\phi; x)$ï¼Œå°±è¢«ç§°ä¸ºå˜åˆ†ä¸‹ç•Œ(Variational lower bound)ã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:5:2","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"4.3ã€Loss Function ç°åœ¨æˆ‘ä»¬åªè¦æƒ³åŠæ³•å°†è¿™ä¸ª lower bound æå‡å°±å¯ä»¥äº†ï¼Œé‚£ä¹ˆè¿™ä¸ª lower bound å°±å¯ä»¥ä½œä¸ºæˆ‘ä»¬çš„ loss functionï¼š $$ \\begin{aligned} L(\\theta, \\phi; x) \u0026= \\sum_{z}q_{\\phi}(z|x)\\log(\\frac{p_{\\theta}(x, z)}{q_{\\phi}(z|x)}) \\cr \u0026= \\sum_{z}q_{\\phi}(z|x)\\log(\\frac{p_{\\theta}(x|z) p_{\\theta}(z)}{q_{\\phi}(z|x)}) \\cr \u0026= \\sum_{z}q_{\\phi}(z|x)[\\log(p_{\\theta}(x|z)) + \\log(\\frac{p_{\\theta}(z)}{q_{\\phi}(z | x)})] \\cr \u0026= {E}{q{\\phi}(z|x)}[\\log(p_{\\theta}(x|z))] - D_{KL}(q_{\\theta}(z | x) || p_{\\theta}(z)) \\end{aligned} $$ ä¸Šè¿°ç­‰å¼ï¼Œæˆ‘ä»¬å°† lower bound å†å±•å¼€ï¼Œå°† $p_{\\theta}(x, z)$ å±•æˆæ¡ä»¶æ¦‚ç‡ï¼Œç„¶åå†å°†logæ‹†åˆ†ã€‚ ç¬¬ä¸‰è¡Œä¸­æ‹¬å·å†…ï¼Œå·¦è¾¹çš„å¯ä»¥å†™æˆæœŸæœ›çš„å½¢å¼ï¼Œå³è¾¹çš„å› ä¸ºéƒ½æœ‰ $q_{\\phi}$ å’Œ $p_{\\theta}$ æ‰€ä»¥ç¬¦åˆKL divergenceçš„å…¬å¼ã€‚ æˆ‘ä»¬å°† ${E}{q{\\phi}(z|x)}[\\log(p_{\\theta}(x|z))]$ ç§°ä¸ºReconstruction Lossï¼Œ å°† $-D_{KL}(q_{\\theta}(z | x) || p_{\\theta}(z))$ ç§°ä¸º Regularization Lossã€‚ æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼°è®¡å‡ºè¿™ä¸¤é¡¹çš„æ¢¯åº¦æ¥ï¼Œå°±å¯ä»¥å¯¹ lower bound è¿›è¡Œä¼˜åŒ–äº†ã€‚ Note æˆ‘ä»¬çš„ç›®çš„æ˜¯æƒ³è®© Probabilistic Encoder æ¥è¿‘äº $p_{\\theta}(z)$ï¼Œå› ä¸ºä¸¤ä¸ªæŸå¤±ï¼Œè¿™æ ·KL divergenceå°±è¶Šå¤§è¶Šå¥½ï¼Œå®é™…-KLæ‰æ˜¯è®­ç»ƒç”¨çš„lossã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:5:3","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"4.4ã€è’™ç‰¹å¡æ´›æ³•æ±‚æ¢¯åº¦ æ¥ä¸‹æ¥è®²å¦‚ä½•æ±‚å‡ºè¿™ä¸¤é¡¹çš„å¯¼æ•°ï¼Œæ¥ä¼˜åŒ–æå‡ lower boundã€‚æˆ‘ä»¬çœ‹åˆ°æƒ³è¦ä¼˜åŒ–çš„è¿™ä¸ªlossï¼Œå…¶å®æ˜¯å¯ä»¥å†™æˆæœŸæœ›çš„å½¢å¼çš„ï¼Œå‡å®šæœŸæœ›é‡Œçš„è¿™ä¸€é¡¹æ˜¯ $f(z)$ï¼Œå¯¹äºä¼°è®¡è¿™ç§æœŸæœ›å®ƒçš„å¯¼æ•°ï¼Œæœ€ç›´æ¥çš„æˆ‘ä»¬å°±æƒ³åˆ°äº†è’™ç‰¹å¡æ´›çš„æ–¹æ³•ã€‚ Note è™½ç„¶è¿™é‡Œæœ‰ä¸ª $\\phi$ï¼Œä½†æˆ‘ä»¬å‡å®šè¿™ä¸ª $f(z)$ å’Œ $\\phi$ æ˜¯æ²¡æœ‰å…³ç³»çš„ã€‚(å‡è®¾ï¼ï¼ï¼ï¼) ä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ï¼Œå¯¹ $f(z)$ åœ¨ $q_{\\phi}$ ä¸Šçš„æœŸæœ›ï¼Œå¯¹ $\\phi$ æ±‚å¯¼æ•°ï¼Œè¡¨ç¤ºå¦‚ä¸‹ï¼š $$ \\begin{aligned} \\eta \u0026= \\triangle_{\\phi} E_{q_{\\phi}(z)}[f(z)]\\cr \u0026= \\triangle_{\\phi} \\int {q_{\\phi}(z)}f(z) \\mathrm{d}z\\cr \u0026= \\int \\triangle_{\\phi}{q_{\\phi}(z)}f(z) \\mathrm{d}z\\cr \u0026= \\int {q_{\\phi}(z)}f(z)\\triangle_{\\phi} \\log {q_{\\phi}(z)}\\mathrm{d}z\\cr \u0026= E_{q_{\\phi}(z)}[f(z)\\triangle_{\\phi} \\log {q_{\\phi}(z)}] \\end{aligned} $$ $line 1 \\sim 2:$ æ ¹æ®æœŸæœ›çš„å®šä¹‰å±•å¼€ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾ $f(z)$ å’Œ $\\phi$ æ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥å¯ä»¥å°†å¯¼æ•°ç¬¦å·æ‹¿è¿›æ¥ï¼› $line 3: $ æ ¹æ®å˜æ¢ $\\triangle_{\\phi} \\log q_{\\phi}(z) = \\frac{\\triangle_{\\phi}q_{\\phi}(z)}{q_{\\phi}(z)}$ å¸¦å…¥å¯å¾—; å¥—ç”¨è’™ç‰¹å¡æ´›å…¬å¼ï¼Œæœ€ç»ˆè¡¨ç¤ºå¦‚ä¸‹ï¼š $$ \\begin{aligned} \\triangle_{\\phi}E_{q_{\\phi}(z)}[f(z)] \u0026= E_{q_{\\phi}(z)}[f(z) \\triangle_{q_{\\phi}(z)} \\log{q_{\\phi}(z)}] \\cr \u0026\\cong \\frac{1}{L}\\sum_{l=1}^{L} f(z) \\triangle_{q_{\\phi}(z^{(l)})} \\log{q_{\\phi}(z^{(l)})}, where z^{(l)} \\sim q_{\\phi}(z|x^{(i)}) \\end{aligned} $$ ä½†æ˜¯ä½œè€…å®éªŒå‘ç°ä½¿ç”¨è¿™ä¸ª estimator æ˜¯æœ‰å¾ˆé«˜çš„ variance çš„ï¼Œå°±æ˜¯ç›´è§‚ä¸Šæ¥è¯´ä¼šå¯¼è‡´è®­ç»ƒå¾ˆä¸ç¨³å®šã€‚ åœ¨æ­¤åŸºç¡€ä¸Šä½œè€…æå‡ºäº† Generic Stochastic Gradient Variational Bayes (SGVB) estimatorï¼Œå¹¶ä½¿ç”¨**é‡å‚æ•°åŒ–(Reparameterization)**trickï¼Œæˆ‘ä»¬å…ˆæ¥è¯´ä¸‹é‡å‚æ•°åŒ–ã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:5:4","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"4.5ã€é‡å‚æ•°åŒ– Trick ä¸Šé¢æˆ‘ä»¬ç”¨è’™ç‰¹å¡æ´›çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªéå¸¸å¼ºçš„å‡è®¾ï¼Œé‚£å°±æ˜¯å‡è®¾ $f(z)$ å’Œ $\\phi$ æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œä½†å®é™…è¡¨è¾¾å¼ä¸­ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒè¿˜æ˜¯æœ‰å…³ç³»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—è€ƒè™‘å®ƒä»¬ä¹‹é—´å­˜åœ¨çš„å…³ç³»ã€è¿™ä¸ªå…³ç³»ä¼šå¸¦æ¥ä»€ä¹ˆæ ·çš„é—®é¢˜ã€‚ æˆ‘ä»¬æŠŠå®ƒæ‰“å¼€æ¥çœ‹ï¼š $$ \\begin{aligned} \\triangle_{\\phi}E_{q_{\\phi}}[f(z)] \u0026= \\triangle_{\\phi}\\int q_{\\phi}(z)f(z) \\mathrm{d}z \\cr \u0026= \\int \\triangle_{\\phi}[q_{\\phi}(z)f(z)] \\mathrm{d}z\\cr \u0026= \\int f(z) \\triangle_{\\phi}q_{\\phi}(z) \\mathrm{d}z + \\int q_{\\phi}(z)\\triangle_{\\phi}f(z) \\mathrm{d}z\\cr \u0026= \\underbrace{\\int f(z) \\triangle_{\\phi}q_{\\phi}(z) \\mathrm{d}z}{what \\ about \\ this \\ ?} + E{q_{\\phi}(z)}[\\triangle_{\\phi}f(z)] \\end{aligned} $$ åˆ†åˆ«æ±‚å¯¼ä¹‹åï¼Œåé¢ä¸€é¡¹å¯ä»¥å†™æˆæœŸæœ›çš„å½¢å¼ï¼Œä½†æ˜¯å‰é¢è¿™ä¸€é¡¹å°±æ— æ³•å¤„ç†äº†ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…ä½¿ç”¨äº†é‡å‚æ•°åŒ–æŠ€å·§(Reparameterization Trick)ã€‚ æ ¸å¿ƒæ€æƒ³å°±æ˜¯å¼•å…¥ä¸€ä¸ªè¾…åŠ©çš„éšæœºå˜é‡ $\\epsilon$ï¼Œ$\\epsilon \\in p(\\epsilon)$ï¼Œè¿™ä¸ªéšæœºå˜é‡å’Œå…¶å®ƒå˜é‡æ²¡æœ‰å…³ç³»ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„éšæœºå˜é‡ï¼Œç”¨æ¥è¡¨ç¤ºäº§ç”Ÿ $z$ çš„è¿‡ç¨‹ä¸­æ‰€æœ‰çš„éšæœºæ€§ã€‚ä¹Ÿå°±æ˜¯è¯´æŠ½æ ·äº§ç”Ÿ $z$ çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„éšæœºæ€§éƒ½æ˜¯ç”±è¿™ä¸ª $\\epsilon \\in p(\\epsilon)$ äº§ç”Ÿçš„ã€‚ è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠ $z$ å†™æˆè¿™ç§å½¢å¼ï¼š $z = g_{\\phi}(\\epsilon, x)$ï¼Œä»è€Œå¯ä»¥æŠŠ $q_{\\phi}(z)$ è¿™ä¸ªæ¦‚ç‡åˆ†å¸ƒè½¬ç§»åˆ° $p_{\\epsilon}$ ä¸Šï¼Œè€Œ $\\epsilon$ æœ‰ä¸€ä¸ªéå¸¸å¥½çš„ç‰¹æ€§ï¼Œé‚£å°±æ˜¯å’Œ $\\phi$ æ˜¯æ²¡æœ‰å…³ç³»çš„ã€‚ è¿™ç§ trick å°±æ˜¯é‡å‚æ•°åŒ–ï¼Œå¾—åˆ°æ–°çš„å˜å½¢åé‡æ–°å¯¹ $\\phi$ æ±‚å¯¼ï¼š $$ \\begin{aligned} E_{q_{\\phi(z)}}[f(z^{(i)})] \u0026= E_{p(\\epsilon)}[f(g_{\\phi}(\\epsilon, x^i))] \\cr \\triangle_{\\phi}E_{q_{\\phi(z)}}[f(z^{(i)})] \u0026= \\triangle_{\\phi}E_{p(\\epsilon)}[f(g_{\\phi}(\\epsilon, x^i)]\\cr \u0026=E_{p(\\epsilon)}[\\triangle_{\\phi}f(g_{\\phi}(\\epsilon, x^i)]\\cr \u0026\\approx \\frac{1}{L} \\sum_{l=1}^{L} \\triangle_{\\phi}f(g_{\\phi}(\\epsilon^{(l)}, x^{(i)})) \\end{aligned} $$ ä¼°è®¡è¿™ä¸ªæœŸæœ›ä¹Ÿæ˜¯é‡‡æ ·ç„¶åæ±‚å¹³å‡å¾—åˆ°æœ€åçš„å¼å­ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠlossçš„æ¢¯åº¦ç»™ä¼°è®¡å‡ºæ¥äº†ã€‚ ä»¥ä¸Šæ˜¯ä»æ•°å­¦è§’åº¦æ¥åˆ†æçš„é‡å‚æ•°åŒ–æŠ€å·§ï¼Œè¿™é‡Œä½œè€…ç»™å‡ºäº†ä¸€ä¸ªæ›´åŠ ç›´è§‚çš„è¡¨è¾¾ï¼š å·¦å›¾ä¸ºåŸæ¥çš„å½¢å¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ $\\phi$ å’Œ $x$ äº§ç”Ÿä¸€ä¸ªdistributionï¼Œç„¶ååœ¨è¿™ä¸ªdistributionä¸­æŠ½æ ·äº§ç”Ÿä¸€ä¸ªzï¼Œç„¶åå†å¾—åˆ°æœ€ç»ˆçš„ $f$ ã€‚ä½†æ˜¯åœ¨ä¼ é€’æ¢¯åº¦çš„æ—¶å€™ï¼Œæ€ä¹ˆæŠŠæ¢¯åº¦é€šè¿‡æŠ½æ ·è¿™ä¸ªè¿‡ç¨‹ä¼ é€’å›æ¥å‘¢ï¼Ÿè¿™ä¸ªæ˜¯æ²¡æ³•ä¼ é€’æ¢¯åº¦çš„ã€‚ åœ¨ä½¿ç”¨äº†é‡å‚æ•°åŒ–trickåï¼Œéšæœºæ€§ç§»åŠ¨åˆ°äº† $\\epsilon$ ä¸Šï¼Œä¹‹å‰æ‰€æœ‰æŠ½æ ·çš„è¿‡ç¨‹åŒ…æ‹¬çš„éšæœºæ€§ï¼Œéƒ½è®© $\\epsilon$ åŒ…æ‹¬äº†ï¼Œè¿™æ ·å°±å¯ä»¥é¡ºåˆ©åœ°å°†æ¢¯åº¦é€šè¿‡ $z$ ä¼ é€’åˆ° $\\phi$ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å·§å¦™çš„æ–¹æ³•. Note å¯ä»¥ç†è§£æˆç”¨å¤šä½™å‚æ•°é€¼è¿‘æŠ½æ ·çš„è¿‡ç¨‹ã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:5:5","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"4.6 Generic SGVB ç®€å•è¯´å®Œé‡å‚æ•°åŒ–ï¼Œæˆ‘ä»¬å›åˆ°SGVB: è¿™é‡Œæ˜¯æƒ³æ±‚è¿™ä¸€ä¸²æœŸæœ›ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬çš„ $f(z)$ ï¼Œæ ¹æ®ä¹‹å‰çš„ Reparameterization Trickï¼Œæˆ‘ä»¬æŠŠ $z$ å†™æˆè¿™æ ·çš„å½¢å¼ï¼š $$z^{(i, l)} = g_{\\phi} (\\epsilon^{(i,l)}, x^{(i)}) \\ and \\ \\epsilon^{(l)} \\sim p(\\epsilon)$$ è®© $\\epsilon$ ä»è¿™ä¸ª distribution ä¸­æŠ½æ ·äº§ç”Ÿï¼Œ$\\epsilon$ æ˜¯ä¸€ä¸ªä¸ $\\phi$ ã€$\\theta$ éƒ½æ²¡æœ‰å…³ç³»çš„éšæœºå˜é‡ï¼Œç„¶å loss å°±å˜æˆï¼š $$L(\\theta, \\phi, x^{(i)}) = \\frac{1}{L} \\sum_{l=1}^{L} \\log p_{\\theta}(x^{(i)}, z^{(i,l)}) - \\log q_{\\phi}(z^{(i,l)} | x^{(i)})$$ æƒ³è¦æ±‚å®ƒå¯¹ $\\phi$ çš„å¯¼æ•°ï¼Œåªéœ€è¦ä¸¤è¾¹åŒæ—¶æ±‚å¯¼å³å¯ã€‚ note å› ä¸ºæœŸæœ›è¿™ä¸ªç§¯åˆ†å·²ç»è¢«æ›¿æ¢æˆäº† $\\epsilon$ çš„distributionï¼Œå®ƒè·Ÿ $\\phi$ æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¼°è®¡æ•´ä¸ªlossçš„å¯¼æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥å¯¹ $\\phi$ æ±‚å¯¼å°±å¯ä»¥äº†ã€‚ è¿™ä¸ªå°±æ˜¯ä½œè€…æå‡ºçš„ç¬¬ä¸€ç§ä¼°è®¡æ¢¯åº¦çš„æ–¹æ³•ã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:5:6","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"4.7ã€Another SGVB åœ¨æ­¤åŸºç¡€ä¸Šä½œè€…è¿˜å‘ç°ï¼Œæœ‰ä¸€äº›å¥½çš„æ€§è´¨å¯ä»¥ç›´æ¥æ‹¿æ¥åˆ©ç”¨ï¼Œæ¯”å¦‚æœŸæœ›çš„ä¸€äº›æ€§è´¨ã€‚ åœ¨ 4.3 èŠ‚ä¸­æˆ‘ä»¬è®²åˆ°åŸæ¥çš„ loss å¯ä»¥å†™æˆ KLæ•£åº¦ + æœŸæœ› çš„å½¢å¼ï¼š $$L(\\theta, \\phi, x^{(i)}) = -D_{KL}(q_{\\phi}(z|x^{(i)})||p_{\\theta}(z)) + E_{q_{\\phi}(z|x)}[\\log(p_{\\theta}(x^{(i)}|z))]$$ è¿™é‡Œæˆ‘ä»¬å‡è®¾è¿™ä¸¤ä¸ªdistributionï¼š$q_{\\phi}$ ã€$p_{\\theta}$ éƒ½æ˜¯ Gaussian distributionï¼Œè¯´ç™½äº†å°±æ˜¯0å‡å€¼1æ–¹å·®ï¼Œæ ¹æ®å®šä¹‰ï¼š $$ \\begin{cases} D_{KL}(P||Q) = E_{x \\sim P}[\\log(\\frac{P(x)}{Q(x)})]\\cr E_{x\\sim P(x)} = \\int P(x)Q(x)\\mathrm{d}x \\end{cases} $$ æˆ‘ä»¬æ ¹æ®ä¸Šè¿°å®šä¹‰æ‰“å¼€è¿™ä¸ªKL divergenceï¼š $$-D_{KL}(q_{\\phi}(z|x)||p_{\\theta}(z)) = \\int q_{\\phi}(z|x)(\\log p_{\\theta}(z)) - \\log q_{\\phi}(z|x) \\mathrm{d}z$$ æˆ‘ä»¬å…ˆæ¥çœ‹ $\\int q_{\\phi}(z|x)\\log p_{\\theta}(z) \\mathrm{d}z$: $$ \\begin{align} \\int q_{\\phi}(z|x)\\log p_{\\theta}(z) \\mathrm{d}z \u0026= \\int N(z; \\mu, \\sigma^2) \\log N(z; 0, 1)\\mathrm{d}z\\cr \u0026= \\int N(z; \\mu, \\sigma^2) (-\\frac{1}{2}z^2 - \\frac{1}{2}\\log(2\\pi))\\mathrm{d}z\\cr \u0026= -\\frac{1}{2} \\int N(z; \\mu, \\sigma^2) z^2\\mathrm{d}z - \\frac{J}{2}\\log(2\\pi) \\cr \u0026= -\\frac{J}{2} \\log (2\\pi) - \\frac{1}{2}(E_{z \\sim N(z;\\mu, \\sigma^2)}[z]^2 + Var(z))\\cr \u0026= -\\frac{J}{2} \\log (2\\pi) - \\frac{1}{2}\\sum_{J}^{j=1}(\\mu^2 + \\sigma_j^2) \\end{align} $$ $line 1\\sim 2:$ æˆ‘ä»¬è®©å·¦é¢åˆ†å¸ƒ $N(z; \\mu, \\sigma^2)$ ä¿æŒä¸åŠ¨ï¼Œå°† normal distribution çš„PDFå¸¦è¿›å»ï¼› normal distribution çš„PDFä¸º: å°†å¸¸æ•°é¡¹ç›´æ¥æ‹¿å‡ºæ¥ï¼ŒæŒ‡æ•°çš„éƒ¨åˆ†ä¹Ÿé€šè¿‡logç›´æ¥æ‹¿ä¸‹æ¥äº†ï¼› $line 3:$ å› ä¸º $\\frac{1}{2}\\log(2\\pi)$ æ˜¯ä¸ªå¸¸æ•°ã€$N(z; \\mu, \\sigma^2)$ è¿™ä¸ªåˆ†å¸ƒç§¯åˆ†ä¹‹åæ˜¯1ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æŠŠå¸¸æ•°é¡¹æ‹¿åˆ°ç§¯åˆ†å¤–é¢ï¼›ä½†æ˜¯å› ä¸º $z$ æ˜¯ä¸€ä¸ªå‘é‡ï¼Œæˆ‘ä»¬å‡è®¾ $z$ æœ‰ $J$ ä¸ªå…ƒç´ elementï¼Œé‚£ä¹ˆæ¯ä¸ªå…ƒç´ éƒ½ä¼šç§¯å‡ºä¸€ä¸ªå€¼æ¥ï¼Œæ‰€ä»¥è¦ä¹˜ä¸Š $J$ï¼Œå³ $\\frac{J}{2}\\log(2\\pi)$; $line 4:$ å¯¹äºç§¯åˆ† $\\int N(z;\\mu,\\sigma^2) z^2\\mathrm{d}z$ æˆ‘ä»¬å¯ä»¥æ¢ä¸ªè§’åº¦ç†è§£å®ƒï¼šè¿™é‡Œæˆ‘ä»¬æŠŠå®ƒå°±å½“æˆä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œæ‰€ä»¥æ•´ä¸ªè¿™ä¸ªç§¯åˆ†å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªæœŸæœ›çš„å½¢å¼ï¼Œä¸è¿‡å®ƒæ˜¯å¯¹ $z^2$ çš„æœŸæœ›ï¼Œç»è¿‡å˜å½¢å¯ä»¥å†™æˆ $-\\frac{1}{2} E_{z \\sim N(z; \\mu, \\sigma^2)}[z]^2$ ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæˆ‘ä»¬ä½¿ç”¨æœŸæœ›çš„æ€§è´¨ $E[z^2] = E[z]^2 + variance(z)$ï¼Œå³ $z^2$ çš„æœŸæœ›ç­‰äºæœŸæœ›çš„å¹³æ–¹åŠ ä¸Š $z$ çš„æ–¹å·®ï¼› é‚£ä¹ˆå¯¹äºä¸€ä¸ª normal distribution æ¥è¯´å®ƒçš„æœŸæœ›å’Œæ–¹å·®æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼š$\\mu$ å’Œ $\\sigma$ï¼Œå¯¹äº $z$ é‡Œçš„æ¯ä¸ªå…ƒç´ (è„šæ ‡æ˜¯ $j$)éƒ½åŠ èµ·æ¥å°±å¥½äº†ï¼Œè¿™æ ·æœ€å¼€å§‹çš„ç§¯åˆ†å°±å¯ä»¥ç®€åŒ–æˆæœ€åçš„å½¢å¼ã€‚ æˆ‘ä»¬å†æ¥çœ‹ $\\int q_{\\phi}(z|x)\\log q_{\\phi}(z|x)\\mathrm{d}z$: $$ \\begin{aligned} \\int q_{\\phi}(z|x)\\log q_{\\phi}(z|x)\\mathrm{d}z \u0026=\\int N(z; \\mu, \\sigma^2)\\log N(z;\\mu,\\sigma^2)\\mathrm{d}z\\cr \u0026= \\int N(z; \\mu, \\sigma^2)(-\\frac{1}{2}(\\frac{z - \\mu}{\\sigma})^2- \\frac{1}{2}\\log (2 \\pi) - \\frac{1}{2}\\log(\\sigma^2))\\mathrm{d}z\\cr \u0026=-\\frac{1}{2}\\int N(z;\\mu,\\sigma^{2})(\\frac{z-\\mu}{\\sigma})^{2}\\mathrm{d}z-\\frac{J}{2}log(2\\pi)-\\frac{1}{2}\\sum_{j=1}^{J}log(\\sigma_{j}^{2}) \\cr \u0026=-\\frac J2log(2\\pi)-\\frac12\\sum_{j=1}^{J}log(\\sigma_{j}^{2})-\\frac12E_{z\\sim N(z;\\mu,\\sigma^{2})}[(\\frac{z-\\mu}\\sigma)^{2}] \\cr \u0026=-\\frac{J}{2}log(2\\pi)-\\frac{1}{2}\\sum_{j=1}^{J}log(\\sigma_{j}^{2})-\\frac{1}{2}(E_{z\\sim N(z;\\mu,\\sigma^{2})}[\\frac{z-\\mu}{\\sigma}]^{2}+Var(\\frac{z-\\mu}{\\sigma})) \\cr \u0026=-\\frac{J}{2}log(2\\pi)-\\frac{1}{2}\\sum_{j=1}^{J}(1+log(\\sigma_j^2)) \\end{aligned} $$ åŒæ ·çš„è¿˜æ˜¯æŠŠå®ƒçš„PDFå¸¦è¿›æ¥ï¼Œå±•æˆä¸Šé¢ç›¸ä¼¼çš„å½¢å¼ï¼Œä½†æ˜¯è¿™ä¸ªåœ°æ–¹çš„å¸¸æ•°é¡¹å’Œå˜é‡è¦æ˜¾å¾—å¤æ‚ä¸€ç‚¹ï¼Œç›¸ä¼¼çš„æ˜¯æˆ‘ä»¬ä¸€æ ·å¯ä»¥æŠŠå¸¸æ•°éƒ¨åˆ†æ‹¿åˆ°ç§¯åˆ†å¤–é¢å»ï¼Œç„¶åå¯¹äºå‰é¢è¿™é¡¹ç§¯åˆ†ä¹ŸæŠŠå®ƒç†è§£æˆæœŸæœ›çš„å½¢å¼ï¼ŒåŒæ ·åˆ©ç”¨æœŸæœ›çš„æ€§è´¨å°†å¹³æ–¹åŒ–ç®€ï¼Œå°±å¯ä»¥å¾—åˆ°æœ€åçš„ç»“æœã€‚ éšåæˆ‘ä»¬æŠŠ KLæ•£åº¦ è¿™ä¸¤é¡¹ç»™åˆå¹¶èµ·æ¥ï¼š $$ \\begin{aligned} -D_{KL}(q_{\\phi}(z\\mid x)\\mid\\mid p_{\\theta}(z))\u0026 =\\int q_\\phi(z\\mid x)(logp_\\theta(z))-logq_\\phi(z\\mid x))\\mathrm{d}z \\cr \u0026=\\frac12\\sum_{j=1}^J(1+log((\\sigma_j)^2)-(\\mu_j)^2-(\\sigma_j)^2) \\end{aligned} $$ æŠŠåˆšåˆšä¸Šé¢çš„ç»“æœå¸¦è¿›æ¥åšå‡æ³•å³å¯å¾—åˆ°è¿™ä¸ªç­‰å¼ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡è¿™ä¸ªå¼å­æ¥ä¼°è®¡å‡ºKLæ•£åº¦ã€‚ å¯¹äºå¦ä¸€éƒ¨åˆ†çš„loss $E_{q_{\\phi}(z|x)}[\\log(p_{\\theta}(x^{(i)} | z))]$ï¼Œå°±åƒæˆ‘ä»¬ä¸Šé¢è¯´çš„ï¼Œè¿™éƒ¨åˆ†çš„æ¦‚ç‡æˆ‘ä»¬å¸Œæœ›given $z$ äº§ç”Ÿçš„ $x$ å°½é‡çš„æ¥è¿‘è¾“å…¥ $x$ï¼Œä¸ºäº†å®ç°è¿™ä¸ªé€¼è¿‘ï¼Œæˆ‘ä»¬ä½¿ç”¨MSEæ¥è®©$f(z)$é€¼è¿‘è¿™ä¸ªxï¼Œå°±å¯ä»¥æœ€å¤§åŒ–è¿™ä¸ªlossï¼š ä»¥ä¸Šå°±æ˜¯æœ€ç»ˆä½¿ç”¨çš„SGVBï¼Œä½œè€…é€šè¿‡ KLæ•£åº¦ çš„æ€§è´¨å’Œ Regularization Loss çš„è¿‘ä¼¼ï¼Œç»™æˆ‘ä»¬æä¾›äº†ä¸€ç§ç›¸å¯¹ç¨³å®šçš„ä¼°è®¡losså’Œæ¢¯åº¦çš„æ–¹æ³•ã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:5:7","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"äº”ã€VAE ç»“æ„å›é¡¾ æ€»çš„æ¥çœ‹ Variational Auto-Encoder çš„modelå°±æ˜¯ï¼š è¾“å…¥ä¸€ä¸ª $x$ï¼Œè¿›äº†Encoderï¼Œè¿™ä¸ª Encoder æ˜¯ç”±å‚æ•°æ¥å†³å®šçš„ï¼ŒEncoder ä¼šäº§ç”Ÿ $Î¼$å’Œ $Ïƒ$ï¼› $Î¼$å’Œ $Ïƒ$é¦–å…ˆè¢«æˆ‘ä»¬ç”¨æ¥è®¡ç®— KL divergenceï¼Œä½œä¸ºè¾…åŠ©æŸå¤±ï¼› åŒæ—¶åœ¨ $Î¼$ å’Œ $Ïƒ$ä¹‹åæˆ‘ä»¬å¯¹å®ƒæŠ½æ ·äº§ç”Ÿä¸€ä¸ª $z$ï¼ŒåŠ ä¸Š $\\epsilon$ å¸®æˆ‘ä»¬äº§ç”Ÿéšæœºçš„é¡¹ï¼› å¾—åˆ°éšå˜é‡ $z$åï¼Œæ”¾åˆ° Decoder é‡Œï¼Œå®ƒæ˜¯ç”±å‚æ•° $\\theta$ æ¥å†³å®šçš„ï¼› ç»è¿‡è¿™ä¸ª Decoder ä¹‹åï¼Œæˆ‘ä»¬é‡å»ºå‡ºäº†ä¸€ä¸ª $x$ï¼› å¯¹æ¯”é‡å»ºåçš„ $x$ å’Œè¾“å…¥ $x$ ä¹‹é—´çš„ MSE å°±æ„æˆäº†lossçš„å¦ä¸€éƒ¨åˆ†ï¼Œ ä¸¤ä¸ªlossåŠ èµ·æ¥å°±æ˜¯æœ€ç»ˆçš„lossã€‚ è¿™ä¸ªå°±æ˜¯æœ€ç»å…¸çš„ Variational Auto-Encoderã€‚ å¯¹æ¯”ç¬¬ä¸€å¤§èŠ‚AEçš„å›¾ï¼Œå¯ä»¥ç”»æˆä¸€ä¸‹å½¢å¼ï¼š ","date":"2023-07-27","objectID":"/posts/vae_1/:6:0","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"å…­ã€åŸæ–‡å®éªŒ ä½œè€…åŸºäºMNIST å’Œ Frey Faceåšäº†å®éªŒéªŒè¯ï¼Œçœ‹ä¸‹åŸæ–‡çš„ç»“æœå›¾ï¼š é¦–å…ˆä½œè€…è¯´äº†ä½¿ç”¨ä¸åŒçš„å­¦ä¹ æ–¹æ³•èƒ½æŠŠè¿™ä¸ª lower bound æå‡å¤šå°‘ï¼Œlower bound çš„æå‡è¶Šå¤§ï¼Œè¯´æ˜ Encoder å’Œæˆ‘ä»¬æƒ³è¦é€¼è¿‘çš„è¿™ä¸ªDistructionï¼Œå®ƒçš„KLæ•£åº¦æ˜¯è¶Šæ¥è¶Šå°ã€‚ Note ç”±å›¾ä¸­å¯ä»¥çœ‹å‡ºAEVBä¸wake-sleepç®—æ³•çš„æ¯”è¾ƒï¼Œå¯ä»¥çœ‹å‡ºAEVBè®­ç»ƒæ•ˆæœæ›´å¥½ã€‚ä¸”éšç€éšå˜é‡ç»´åº¦å¢å¤§ï¼Œå¹¶æœªå‡ºç°è¿‡æ‹Ÿåˆç°è±¡ã€‚ å›¾4æ˜¯é™å®š2ä¸ªç»´åº¦çš„éšå˜é‡ $z$ï¼Œå¹¶è°ƒèŠ‚ä¸¤ä¸ªç»´åº¦çš„å€¼ï¼Œç”Ÿæˆçš„å›¾ç‰‡ã€‚ å›¾5æ˜¯ä¸åŒç»´åº¦çš„éšå˜é‡éšæœºé‡‡æ ·çš„å›¾ç‰‡ã€‚ ","date":"2023-07-27","objectID":"/posts/vae_1/:7:0","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"ä¸ƒã€torchå¤ç° AEã€VAE https://wangguisen.blog.csdn.net/article/details/128476638 ","date":"2023-07-27","objectID":"/posts/vae_1/:8:0","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["ML"],"content":"References [1]. https://arxiv.org/abs/1312.6114 [2]. http://www.gwylab.com/note-vae.html [3]. https://zhuanlan.zhihu.com/p/452743042 [4]. https://www.bilibili.com/video/BV1q64y1y7J2/ [5]. https://www.bilibili.com/video/av15889450/?p=33 [6]. https://gregorygundersen.com/blog/2018/04/29/reparameterization/ [7]. https://mp.weixin.qq.com/s?__biz=Mzk0MzIzODM5MA==\u0026mid=2247486014\u0026idx=1\u0026sn=2ff34f72c869907408ed1b08bec1a238\u0026chksm=c337b7a7f4403eb14a1b5cdc3e1a1b11dca6f957591957cc29a4c270f0ace0a4674a7ae33214\u0026scene=21#wechat_redirect ","date":"2023-07-27","objectID":"/posts/vae_1/:9:0","tags":["VAE"],"title":"å˜åˆ†è‡ªç¼–ç å™¨ VAE è¯¦è§£","uri":"/posts/vae_1/"},{"categories":["C++"],"content":"æ‹·è´ä¸€ä¸ªauto_ptrå°†æ”¹å˜å®ƒçš„å€¼ å½“ä½ æ‹·è´ä¸€ä¸ªauto_ptræ—¶ï¼Œauto_ptræ‰€æŒ‡å‘å¯¹è±¡çš„æ‰€æœ‰æƒè¢«è½¬ç§»åˆ°æ‹·è´çš„auto_ptrï¼Œè€Œè¢«æ‹·è´çš„auto_ptrè¢«è®¾ä¸ºNULLã€‚ class Widget { public: explicit Widget(int in) : randy(in) {} inline bool operator\u003c(Widget\u0026 in) { return randy \u003c in.randy; } public: int randy; }; auto_ptr\u003cWidget\u003e pw1(new Widget); // pw1æŒ‡å‘ä¸€ä¸ªWidget auto_ptr\u003cWidget\u003e pw2(pw1); // pw2æŒ‡å‘pw1çš„Widget; pw1è¢«è®¾ä¸ºNULLã€‚ï¼ˆWidgetçš„æ‰€æœ‰æƒä»pw1è½¬ç§»åˆ°pw2ã€‚ï¼‰ pw1 = pw2; // pw1ç°åœ¨å†æ¬¡æŒ‡å‘Widgetï¼› pw2è¢«è®¾ä¸ºNULL æœ‰æ„æ€çš„æ˜¯ï¼Œå¦‚æœä½ å»ºç«‹ä¸€ä¸ªauto_ptr\u003cWidget\u003eçš„vectorï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªæŒ‡å‘çš„Widgetçš„å€¼çš„å‡½æ•°å¯¹å®ƒè¿›è¡Œæ’åºï¼š bool widgetAPCompare(const auto_ptr\u003cWidget\u003e\u0026 lhs, const auto_ptr\u003cWidget\u003e\u0026 rhs) { return *lhs \u003c *rhs; // å‡è®¾Widget å­˜åœ¨operator\u003c } auto_ptr\u003cWidget\u003e w1(new Widget(3)); auto_ptr\u003cWidget\u003e w2(new Widget(2)); widgets.push_back(w1); widgets.push_back(w2); vector\u003cauto_ptr\u003cWidget\u003e \u003e widgets; // å»ºç«‹ä¸€ä¸ªvectorï¼Œç„¶åç”¨Widgetçš„auto_ptrå¡«å……å®ƒï¼› // è®°ä½è¿™å°†ä¸èƒ½ç¼–è¯‘ï¼ sort(widgets.begin(), widgets.end(), widgetAPCompare);// æ’åºè¿™ä¸ªvector è¿™æ®µä»£ç å°†ä¸èƒ½ç¼–è¯‘ warning: â€˜template\u003cclass\u003e class std::auto_ptrâ€™ is deprecated [-Wdeprecated-declarations] 30 | std::vector\u003cauto_ptr\u003cWidget\u003e \u003e | ^~~~~~~~ In file included from /usr/include/c++/9/memory:80, from temp.cpp:10: /usr/include/c++/9/bits/unique_ptr.h:53:28: note: declared here 53 | template\u003ctypename\u003e class auto_ptr; | ^~~~~~~~ temp.cpp:33:3: warning: â€˜template\u003cclass\u003e class std::auto_ptrâ€™ is deprecated [-Wdeprecated-declarations] 33 | auto_ptr\u003cWidget\u003e w1(new Widget(3)); | ^~~~~~~~ ä»æ¦‚å¿µä¸Šçœ‹æ‰€æœ‰ä¸œè¥¿ä¹Ÿéƒ½å¾ˆåˆç†ï¼Œä½†ç»“æœå´å®Œå…¨ä¸åˆç†ã€‚ä¾‹å¦‚ï¼Œåœ¨æ’åºè¿‡ç¨‹ä¸­widgetsä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªauto_ptrå¯èƒ½å·²ç»è¢«è®¾ä¸ºNULLã€‚ æ’åºè¿™ä¸ªvectorçš„è¡Œä¸ºå¯èƒ½å·²ç»æ”¹å˜äº†å®ƒçš„å†…å®¹ï¼ ","date":"2023-07-27","objectID":"/posts/clause_8/:1:0","tags":["STL"],"title":"Effective STL [8] | æ°¸ä¸å»ºç«‹auto_ptrçš„å®¹å™¨","uri":"/posts/clause_8/"},{"categories":["C++"],"content":"å‰–æ å®ç°sortçš„æ–¹æ³•æ˜¯ä½¿ç”¨äº†å¿«é€Ÿæ’åºç®—æ³•çš„æŸç§å˜ä½“ã€‚ æ’åºä¸€ä¸ªå®¹å™¨çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œé€‰æ‹©å®¹å™¨çš„æŸä¸ªå…ƒç´ ä½œä¸ºâ€œä¸»å…ƒâ€ï¼Œç„¶åå¯¹å¤§äºå’Œå°äºæˆ–ç­‰äºä¸»å…ƒçš„å€¼è¿›è¡Œé€’å½’æ’åºã€‚ åœ¨sortå†…éƒ¨ï¼Œè¿™æ ·çš„æ–¹æ³•çœ‹èµ·æ¥åƒè¿™æ ·ï¼š template\u003cclass RandomAccessIterator, class Compare\u003e// è¿™ä¸ªsortçš„å£°æ˜ç›´æ¥æ¥è‡ªäºæ ‡å‡† void sort(RandomAccessIterator first, RandomAccessIterator last, Compare comp) { // è¿™ä¸ªtypedefåœ¨ä¸‹é¢è§£é‡Š typedef typename iterator_traits\u003cRandomAccessIterator\u003e::value_type ElementType; RandomAccessIterator i; ... // è®©iæŒ‡å‘ä¸»å…ƒ ElementType pivotValue(*); // æŠŠä¸»å…ƒæ‹·è´åˆ°ä¸€ä¸ªå±€éƒ¨ä¸´æ—¶å˜é‡ä¸­ï¼› ... // wor } æºç ä¸ºï¼š template\u003ctypename _RandomAccessIterator, typename _Compare\u003e inline void sort(_RandomAccessIterator __first, _RandomAccessIterator __last, _Compare __comp) { // concept requirements __glibcxx_function_requires(_Mutable_RandomAccessIteratorConcept\u003c _RandomAccessIterator\u003e) __glibcxx_function_requires(_BinaryPredicateConcept\u003c_Compare, typename iterator_traits\u003c_RandomAccessIterator\u003e::value_type, typename iterator_traits\u003c_RandomAccessIterator\u003e::value_type\u003e) __glibcxx_requires_valid_range(__first, __last); __glibcxx_requires_irreflexive_pred(__first, __last, __comp); std::__sort(__first, __last, __gnu_cxx::__ops::__iter_comp_iter(__comp)); } // ä¸Šé¢ __gnu_cxx::__ops::__iter_comp_iter(__comp) çš„å®ç°å¦‚ä¸‹ template\u003ctypename _Compare, typename _Iterator\u003e inline _Iter_comp_to_iter\u003c_Compare, _Iterator\u003e __iter_comp_iter(_Iter_comp_iter\u003c_Compare\u003e __comp, _Iterator __it) { return _Iter_comp_to_iter\u003c_Compare, _Iterator\u003e( _GLIBCXX_MOVE(__comp._M_comp), __it); // è¿™é‡Œæœ‰move } å½“æ¶‰åŠiterator_traits\u003cRandomAccessIterator\u003e::value_typeæ—¶ï¼Œå¿…é¡»åœ¨å®ƒå‰é¢å†™ä¸Štypenameï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªä¾èµ–äºæ¨¡æ¿å‚æ•°ç±»å‹çš„åå­—ï¼Œåœ¨è¿™é‡Œæ˜¯RandomAccessIteratorã€‚ ä¸Šé¢ä»£ç ä¸­æ£˜æ‰‹çš„æ˜¯è¿™ä¸€è¡Œ: ElementType pivotValue(*i); å› ä¸ºå®ƒæŠŠä¸€ä¸ªå…ƒç´ ä»ä¿å­˜çš„åŒºé—´æ‹·è´åˆ°å±€éƒ¨ä¸´æ—¶å¯¹è±¡ä¸­ã€‚ åœ¨ä¾‹å­é‡Œï¼Œè¿™ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªauto_ptr\u003cWidget\u003eï¼Œæ‰€ä»¥è¿™ä¸ªæ‹·è´æ“ä½œé»˜é»˜åœ°æŠŠè¢«æ‹·è´çš„auto_ptrâ€”â€”vectorä¸­çš„é‚£ä¸ªâ€”â€”è®¾ä¸ºNULLã€‚ å¦å¤–ï¼Œå½“pivotValueå‡ºäº†ç”Ÿå­˜æœŸï¼Œå®ƒä¼šè‡ªåŠ¨åˆ é™¤æŒ‡å‘çš„Widgetã€‚è¿™æ—¶sortè°ƒç”¨è¿”å›äº†ï¼Œvectorçš„å†…å®¹å·²ç»æ”¹å˜äº†ï¼Œè€Œä¸”è‡³å°‘ä¸€ä¸ªWidgetå·²ç»è¢«åˆ é™¤äº†ã€‚ ä¹Ÿå¯èƒ½æœ‰å‡ ä¸ªvectorå…ƒç´ å·²ç»è¢«è®¾ä¸ºNULLï¼Œè€Œä¸”å‡ ä¸ªwidgetå·²ç»è¢«åˆ é™¤ï¼Œå› ä¸ºå¿«é€Ÿæ’åºæ˜¯ä¸€ç§é€’å½’ç®—æ³•ï¼Œé€’å½’çš„æ¯ä¸€å±‚éƒ½ä¼šæ‹·è´ä¸€ä¸ªä¸»å…ƒã€‚ ","date":"2023-07-27","objectID":"/posts/clause_8/:2:0","tags":["STL"],"title":"Effective STL [8] | æ°¸ä¸å»ºç«‹auto_ptrçš„å®¹å™¨","uri":"/posts/clause_8/"},{"categories":["C++"],"content":"ç»“è®º æ™ºèƒ½æŒ‡é’ˆçš„å®¹å™¨æ˜¯å¾ˆå¥½çš„ï¼Œ ä½†æ˜¯auto_ptrå®Œå…¨ä¸æ˜¯é‚£æ ·çš„æ™ºèƒ½æŒ‡é’ˆã€‚ ","date":"2023-07-27","objectID":"/posts/clause_8/:3:0","tags":["STL"],"title":"Effective STL [8] | æ°¸ä¸å»ºç«‹auto_ptrçš„å®¹å™¨","uri":"/posts/clause_8/"},{"categories":["C++"],"content":"STLå®¹å™¨èƒ½å¤Ÿåšçš„äº‹æƒ… æä¾›äº†å‰å‘å’Œé€†å‘éå†çš„è¿­ä»£å™¨ï¼ˆé€šè¿‡beginã€endã€rbeginç­‰ï¼‰ï¼› èƒ½å‘Šè¯‰ä½ æ‰€å®¹çº³çš„å¯¹è±¡ç±»å‹ï¼ˆé€šè¿‡value_typeçš„ttypedefï¼‰ï¼› åœ¨æ’å…¥å’Œåˆ é™¤ä¸­ï¼Œè´Ÿè´£ä»»ä½•éœ€è¦çš„å†…å­˜ç®¡ç†ï¼› æŠ¥å‘Šå®¹çº³äº†å¤šå°‘å¯¹è±¡å’Œæœ€å¤šå¯èƒ½å®¹çº³çš„æ•°é‡ï¼ˆåˆ†åˆ«é€šè¿‡sizeå’Œmax_sizeï¼‰ï¼› å½“å®¹å™¨è‡ªå·±è¢«é”€æ¯æ—¶ä¼šè‡ªåŠ¨é”€æ¯å®¹çº³çš„æ¯ä¸ªå¯¹è±¡ã€‚ ","date":"2023-07-26","objectID":"/posts/clause_7/:1:0","tags":["STL"],"title":"Effective STL [7] | å½“ä½¿ç”¨newå¾—æŒ‡é’ˆçš„å®¹å™¨æ—¶ï¼Œè®°å¾—åœ¨é”€æ¯å®¹å™¨å‰deleteé‚£äº›æŒ‡é’ˆ","uri":"/posts/clause_7/"},{"categories":["C++"],"content":"å®¹å™¨å†…åŒ…å«æŒ‡é’ˆ è™½ç„¶STLå®¹å™¨è¢«é”€æ¯æ—¶ï¼Œèƒ½å¤Ÿè‡ªåŠ¨é”€æ¯å®¹çº³çš„æ¯ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å¦‚æœè¿™äº›å¯¹è±¡æ˜¯é€šè¿‡newåˆ†é…çš„å¯¹è±¡çš„æŒ‡é’ˆæ—¶ï¼Œå®ƒä¸ä¼šè°ƒç”¨deleteï¼Œé”€æ¯æŒ‡é’ˆæ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚ Example void doSomething() { vector\u003cWidget*\u003e vwp; for (int i = 0; i \u003c SOME_MAGIC_NUMBER; ++i) vwp.push_back(new Widget); ... // work } // Widgetsåœ¨è¿™é‡Œæ³„æ¼ï¼ è¿™æ®µä»£ç å°†ç›´æ¥å¯¼è‡´å†…å­˜æ³„éœ²ã€‚ å½“vwpç»“æŸå…¶ç”Ÿå‘½å‘¨æœŸåï¼Œvwpçš„æ¯ä¸ªå…ƒç´ éƒ½è¢«é”€æ¯ï¼Œä½†ä¸ä¼šdeleteæ¯ä¸ªnewå¾—åˆ°çš„å¯¹è±¡ã€‚ é‚£æ ·çš„åˆ é™¤æ˜¯ä½ çš„èŒè´£ï¼Œè€Œä¸æ˜¯vectorçš„ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹æ€§ã€‚åªæœ‰ä½ çŸ¥é“ä¸€ä¸ªæŒ‡é’ˆæ˜¯å¦åº”è¯¥è¢«åˆ é™¤ã€‚ å¯ä»¥å¾ˆç®€å•åœ°å®ç°ï¼š void doSomething() { vector\u003cWidget*\u003e vwp; ... // work for (vector\u003cWidget*\u003e::iterator i = vwp.begin(); i != vwp.end(), ++i) { delete *i; } } è¿™æ®µé”€æ¯çš„ä»£ç ï¼Œä»ç„¶æœ‰2ä¸ªé—®é¢˜ï¼š æ–°çš„forå¾ªç¯ä»£ç æ¯”for_eachå¤šå¾—å¤šï¼Œæ²¡æœ‰ä½¿ç”¨for_eachæ¥çš„æ¸…æ¥š è¿™æ®µä»£ç ä¸æ˜¯å¼‚å¸¸å®‰å…¨çš„ã€‚å¦‚æœåœ¨ç”¨æŒ‡é’ˆå¡«å……äº†vwpçš„æ—¶å€™å’Œä½ è¦åˆ é™¤å®ƒä»¬ä¹‹é—´æŠ›å‡ºäº†ä¸€ä¸ªå¼‚å¸¸ï¼Œä½ ä¼šå†æ¬¡èµ„æºæ³„æ¼ã€‚ for_eachåˆ é™¤å¯¹è±¡ è¦æŠŠä½ çš„ç±»ä¼¼for_eachçš„å¾ªç¯è½¬åŒ–ä¸ºçœŸæ­£ä½¿ç”¨for_eachï¼Œä½ éœ€è¦æŠŠdeleteè½¬å…¥ä¸€ä¸ªå‡½æ•°å¯¹è±¡ä¸­ã€‚ template\u003ctypename T\u003e struct DeleteObject : public unary_function\u003cconst T*, void\u003e { // è¿™é‡Œæœ‰è¿™ä¸ªç»§æ‰¿ void operator()(const T* ptr) const { delete ptr; } }; ç°åœ¨å¯ä»¥è¿™ä¹ˆåˆ é™¤å¯¹è±¡ void HappyWork() { ... // work for_each(vwp.begin(), vwp.end(), DeleteObject\u003cWidget\u003e); } é—®é¢˜ å¦‚æœæœ‰äººç¼–å†™äº†ä¸€ä¸ªç±»ï¼Œè¯¥ç±»ç»§æ‰¿äº† string class SpecialString: public string { ... }; è¿™æ˜¯å¾ˆå±é™©çš„è¡Œä¸ºï¼Œå› ä¸ºstringï¼Œå°±åƒæ‰€æœ‰çš„æ ‡å‡†STLå®¹å™¨ï¼Œç¼ºå°‘è™šææ„å‡½æ•°ï¼Œè€Œä»æ²¡æœ‰è™šææ„å‡½æ•°çš„ç±»å…¬æœ‰ç»§æ‰¿æ˜¯ä¸€ä¸ªå¤§çš„C++ç¦å¿Œã€‚ å½“ä»–åˆ é™¤ SpecialString æ—¶å°±ä¼šèµ„æºæ³„éœ² void doSomething() { deque\u003cSpecialString*\u003e dssp; ... for_each(dssp.begin(), dssp.end(), // è¡Œä¸ºæœªå®šä¹‰ï¼é€šè¿‡æ²¡æœ‰ DeleteObject\u003cstring\u003e()); // è™šææ„å‡½æ•°çš„åŸºç±» } // æŒ‡é’ˆæ¥åˆ é™¤æ´¾ç”Ÿå¯¹è±¡ è§£å†³ å¯ä»¥é€šè¿‡ç¼–è¯‘å™¨æ¨æ–­ä¼ ç»™DeleteObject::operator()çš„æŒ‡é’ˆçš„ç±»å‹æ¥æ¶ˆé™¤è¿™ä¸ªé”™è¯¯ï¼ˆä¹Ÿå‡å°‘DeleteObjectçš„ç”¨æˆ·éœ€è¦çš„å‡»é”®æ¬¡æ•°ï¼‰ã€‚ æŠŠæ¨¡æ¿åŒ–ä»DeleteObjectç§»åˆ°å®ƒçš„operator()ï¼š struct DeleteObject { // åˆ é™¤è¿™é‡Œçš„ // æ¨¡æ¿åŒ–å’ŒåŸºç±» template\u003ctypename T\u003e // æ¨¡æ¿åŒ–åŠ åœ¨è¿™é‡Œ void operator()(const T* ptr) const { delete ptr; } } é€šè¿‡ä¼ ç»™DeleteObject::operator()çš„æŒ‡é’ˆçš„ç±»å‹ï¼Œè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªoperator()ã€‚è¿™ç§ç±»å‹æ¼”ç»ä¸‹é™è®©æˆ‘ä»¬æ”¾å¼ƒä½¿DeleteObjectå¯é€‚é…çš„èƒ½åŠ› ç°åœ¨åˆ é™¤ SpecialString å°±ä¼šæ­£å¸¸äº† void doSomething() { deque\u003cSpecialString*\u003e dssp; ... for_each(dssp.begin(), dssp.end(), DeleteObject()); // goodï¼ } ç°åœ¨ä»ä¸æ˜¯å¼‚å¸¸å®‰å…¨çš„ã€‚ æœåœ¨SpecialStringè¢«newä½†åœ¨è°ƒç”¨for_eachä¹‹å‰æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œå°±ä¼šå‘ç”Ÿæ³„æ¼ã€‚ è¿™ä¸ªé—®é¢˜å¯ä»¥ä»¥å¤šç§æ–¹å¼è¢«è§£å†³ï¼Œä½†æœ€ç®€å•çš„å¯èƒ½æ˜¯ç”¨æ™ºèƒ½æŒ‡é’ˆçš„å®¹å™¨æ¥ä»£æ›¿æŒ‡é’ˆçš„å®¹å™¨ï¼Œå…¸å‹çš„æ˜¯å¼•ç”¨è®¡æ•°æŒ‡é’ˆã€‚ ","date":"2023-07-26","objectID":"/posts/clause_7/:2:0","tags":["STL"],"title":"Effective STL [7] | å½“ä½¿ç”¨newå¾—æŒ‡é’ˆçš„å®¹å™¨æ—¶ï¼Œè®°å¾—åœ¨é”€æ¯å®¹å™¨å‰deleteé‚£äº›æŒ‡é’ˆ","uri":"/posts/clause_7/"},{"categories":["C++"],"content":"Booståº“ä¸­çš„shared_ptr åˆ©ç”¨Boostçš„shared_ptrï¼Œæœ¬æ¡æ¬¾çš„åŸå§‹ä¾‹å­å¯ä»¥é‡å†™ä¸ºè¿™æ ·ï¼š void doSomething() { typedef boost::shared_ ptr\u003cWidget\u003e SPW; //SPW = \"shared_ptr to Widget\" vector\u003cSPW\u003e vwp; for (int i = 0; i \u003c SOME_MAGIC_NUMBER; ++i) vwp.push_back(SPW(new Widget)); // ä»ä¸€ä¸ªWidgetå»ºç«‹SPW,ç„¶åè¿›è¡Œä¸€æ¬¡push_back ... // work } // è¿™é‡Œæ²¡æœ‰Widgetæ³„æ¼ï¼Œç”šè‡³åœ¨ä¸Šé¢ä»£ç ä¸­æŠ›å‡ºå¼‚å¸¸ ","date":"2023-07-26","objectID":"/posts/clause_7/:3:0","tags":["STL"],"title":"Effective STL [7] | å½“ä½¿ç”¨newå¾—æŒ‡é’ˆçš„å®¹å™¨æ—¶ï¼Œè®°å¾—åœ¨é”€æ¯å®¹å™¨å‰deleteé‚£äº›æŒ‡é’ˆ","uri":"/posts/clause_7/"},{"categories":["C++"],"content":"ç»“è®º STLå®¹å™¨å¾ˆæ™ºèƒ½ï¼Œä½†å®ƒä»¬æ²¡æœ‰æ™ºèƒ½åˆ°çŸ¥é“æ˜¯å¦åº”è¯¥åˆ é™¤å®ƒä»¬æ‰€åŒ…å«çš„æŒ‡é’ˆã€‚ å½“ä½ è¦åˆ é™¤æŒ‡é’ˆçš„å®¹å™¨æ—¶è¦é¿å…èµ„æºæ³„æ¼ï¼Œä½ å¿…é¡»ç”¨æ™ºèƒ½å¼•ç”¨è®¡æ•°æŒ‡é’ˆå¯¹è±¡ï¼ˆæ¯”å¦‚Boostçš„shared_ptrï¼‰æ¥ä»£æ›¿æŒ‡é’ˆï¼Œæˆ–è€…ä½ å¿…é¡»åœ¨å®¹å™¨é”€æ¯å‰æ‰‹åŠ¨åˆ é™¤å®¹å™¨ä¸­çš„æ¯ä¸ªæŒ‡é’ˆã€‚ ","date":"2023-07-26","objectID":"/posts/clause_7/:4:0","tags":["STL"],"title":"Effective STL [7] | å½“ä½¿ç”¨newå¾—æŒ‡é’ˆçš„å®¹å™¨æ—¶ï¼Œè®°å¾—åœ¨é”€æ¯å®¹å™¨å‰deleteé‚£äº›æŒ‡é’ˆ","uri":"/posts/clause_7/"},{"categories":["ML"],"content":"ä¸€ã€GANçš„å¼•å…¥ GANï¼ˆGenerative Adversarial Networksï¼‰æ˜¯ä¸€ç§æ— ç›‘ç£çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œæå‡ºäº2014å¹´ï¼Œè¢«èª‰ä¸ºâ€œè¿‘å¹´æ¥å¤æ‚åˆ†å¸ƒä¸Šæ— ç›‘ç£å­¦ä¹ æœ€å…·å‰æ™¯çš„æ–¹æ³•ä¹‹ä¸€â€ã€‚ quote Yann Lecunå¯¹å…¶çš„è¯„ä»·æ˜¯ï¼šå¯¹æŠ—å¼è®­ç»ƒæ˜¯è¿„ä»Šä¸ºæ­¢æœ€é…·çš„ä¸€ä»¶äº‹æƒ…ã€‚ Adversarial training is the coolest thing since sliced bread. æˆ‘ä»¬æ¥çœ‹ä¸‹åŸæ–‡çš„æ ‡é¢˜ï¼š Generativeï¼šæˆ‘ä»¬çŸ¥é“æœºå™¨å­¦ä¹ æ¨¡å‹æœ‰ä¸¤å¤§ç±»ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆ†è¾¨æ¨¡å‹ï¼šå¯¹äºä¸€ä¸ªæ•°æ®å»åˆ†è¾¨å®ƒçš„ç±»åˆ«ï¼Œæˆ–è€…æ˜¯é¢„æµ‹ä¸€ä¸ªå®æ•°å€¼ï¼›å¦ä¸€ç±»æ˜¯ç”Ÿæˆæ¨¡å‹ï¼Œæ„æ€æ˜¯æ€ä¹ˆæ ·ç”Ÿæˆè¿™ä¸ªæ•°æ®æœ¬èº«ã€‚æ˜¾ç„¶GANæ˜¯å±äºç”Ÿæˆæ¨¡å‹ã€‚ Adversarialï¼šå¯¹æŠ—çš„ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯GANæå‡ºçš„è¿™ç§ framework é‡‡ç”¨å¯¹æŠ—è®­ç»ƒçš„æ–¹å¼æ¥workã€‚ Netsï¼šNetworkçš„ç®€å†™ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:1:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"äºŒã€GANçš„åº”ç”¨ä¸¾ä¾‹ æ•°æ®ç”Ÿæˆï¼šç”Ÿæˆä¸€äº›å‡çš„å›¾åƒæ•°æ®ï¼Œæ¯”å¦‚æµ·æŠ¥ä¸­çš„äººè„¸ã€æ–‡æœ¬ç”Ÿæˆå›¾åƒç­‰ï¼› æ•°æ®å¢å¼ºï¼šä»åˆ†å‰²å›¾ç”Ÿæˆå‡çš„çœŸå®è¡—æ™¯ï¼Œæ¯”å¦‚å¯ä»¥æ–¹ä¾¿è®­ç»ƒæ— äººæ±½è½¦ç­‰ï¼› é£æ ¼åŒ–å’Œè‰ºæœ¯çš„å›¾åƒåˆ›é€ ï¼šæ¯”å¦‚è½¬æ¢å›¾åƒé£æ ¼ã€AIæ¢è„¸ã€ä¿®è¡¥å›¾åƒç­‰ï¼› å£°éŸ³çš„è½¬æ¢ï¼šæ¯”å¦‚ä¸€ä¸ªäººçš„å£°éŸ³è½¬ä¸ºå¦ä¸€ä¸ªçš„å£°éŸ³ã€å»é™¤å™ªå£°ç­‰ï¼› â€¦â€¦ ","date":"2023-07-26","objectID":"/posts/gan_1/:2:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"ä¸‰ã€GANçš„å¿«é€Ÿæ¦‚è¿° æ¯”å¦‚äººè„¸æ£€æµ‹ã€å›¾åƒè¯†åˆ«ã€è¯­éŸ³è¯†åˆ«ç­‰ï¼Œæœºå™¨æ€»æ˜¯åœ¨ç°æœ‰äº‹ç‰©çš„åŸºç¡€ä¸Šï¼Œåšå‡ºæè¿°å’Œåˆ¤æ–­ã€‚èƒ½ä¸èƒ½åˆ›é€ è¿™ä¸ªä¸–ç•Œä¸å­˜åœ¨çš„ä¸œè¥¿ï¼Ÿ GANå°±æ˜¯ä¸ºæ­¤è€Œæ¥ï¼Œå®ƒåŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼šç”Ÿæˆã€åˆ¤åˆ«ã€å¯¹æŠ—ã€‚å…¶ä¸­ ç”Ÿæˆ å’Œ åˆ¤åˆ« æ˜¯å®ƒçš„ç»“æ„ç»„æˆï¼Œå¯¹æŠ—åˆ™æ˜¯å®ƒçš„è®­ç»ƒè¿‡ç¨‹ã€‚ ç”Ÿæˆï¼šç”Ÿæˆ å’Œ åˆ¤åˆ« æŒ‡çš„æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„æ¨¡å‹ï¼Œç”Ÿæˆå™¨ä¼šæ ¹æ®éšæœºå‘é‡äº§ç”Ÿå‡æ•°æ®ï¼Œè¿™äº›å‡æ•°æ®æ—¢å¯ä»¥æ˜¯å›¾ç‰‡ã€ä¹Ÿå¯ä»¥æ˜¯æ–‡æœ¬ï¼Œå¹¶è¯•å›¾æ¬ºéª—åˆ¤åˆ«ç½‘ç»œï¼› åˆ¤åˆ«ï¼šåˆ¤åˆ«å™¨è´Ÿè´£åˆ¤æ–­æ¥å—åˆ°çš„æ•°æ®æ˜¯å¦æ˜¯çœŸå®çš„ï¼Œå³å¯¹ç”Ÿæˆæ•°æ®è¿›è¡ŒçœŸä¼ªé‰´åˆ«ï¼Œè¯•å›¾æ­£ç¡®è¯†åˆ«æ‰€æœ‰å‡æ•°æ®ï¼Œå®ƒå…¶å®æ˜¯ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œä¼šç»™å‡ºä¸€ä¸ªæ¦‚ç‡ï¼Œä»£è¡¨ç€å†…å®¹çš„çœŸå®ç¨‹åº¦ï¼›ä¸¤è€…ä½¿ç”¨å“ªç§ç½‘ç»œå¹¶æ²¡æœ‰æ˜ç¡®çš„è§„å®šï¼Œæ‰€ä»¥åŸæ–‡ä¸­ä½œè€…ç§°å…¶ä¸ºframeworkã€‚æ¯”å¦‚å¯ä»¥ä½¿ç”¨æ“…é•¿å¤„ç†å›¾ç‰‡çš„CNNã€å¸¸è§çš„å…¨è¿æ¥ç­‰ç­‰ï¼Œåªè¦èƒ½å¤Ÿå®Œæˆç›¸åº”çš„åŠŸèƒ½å°±å¯ä»¥äº†ã€‚ å¯¹æŠ—ï¼šè¿™æŒ‡çš„æ˜¯ GAN çš„äº¤æ›¿è®­ç»ƒè¿‡ç¨‹ã€‚ä»¥å›¾ç‰‡ç”Ÿæˆä¸ºä¾‹ï¼Œå…ˆè®©ç”Ÿæˆå™¨äº§ç”Ÿä¸€äº›å‡å›¾ç‰‡ï¼Œå’Œæ”¶é›†åˆ°çš„çœŸå›¾ç‰‡ä¸€èµ·äº¤ç»™è¾¨åˆ«å™¨ï¼Œè®©å®ƒå­¦ä¹ åŒºåˆ†ä¸¤è€…ï¼Œç»™çœŸçš„é«˜åˆ†ï¼Œç»™å‡çš„ä½åˆ†ï¼Œå½“åˆ¤åˆ«å™¨èƒ½å¤Ÿç†Ÿç»ƒåˆ¤æ–­ç°æœ‰æ•°æ®åï¼›å†è®© ç”Ÿæˆå™¨ ä»¥ä» åˆ¤åˆ«å™¨ å¤„è·å¾—é«˜åˆ†ä¸ºç›®æ ‡ï¼Œä¸æ–­ç”Ÿæˆæ›´å¥½çš„å‡å›¾ç‰‡ï¼Œç›´åˆ°èƒ½éª—è¿‡åˆ¤åˆ«å™¨ï¼Œé‡å¤è¿›è¡Œè¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°è¾¨åˆ«å™¨å¯¹ä»»ä½•å›¾ç‰‡çš„é¢„æµ‹æ¦‚ç‡éƒ½æ¥è¿‘0.5ï¼Œä¹Ÿå°±æ˜¯æ— æ³•åˆ†è¾¨å›¾ç‰‡çš„çœŸå‡ï¼Œå°±åœæ­¢è®­ç»ƒã€‚ ä¹Ÿå°±æ˜¯è¯´åœ¨è®­ç»ƒè¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œä¸¤ä¸ªç½‘ç»œæŒç»­åœ°è¿›åŒ–å’Œå¯¹æŠ—ï¼Œç›´åˆ°åˆ°è¾¾ä¸€ä¸ªå¹³è¡¡çŠ¶æ€ï¼Œå³åˆ¤åˆ«ç½‘ç»œæ— æ³•è¯†åˆ«çœŸå‡ã€‚è™½è¯´æ˜¯å¯¹æŠ—ï¼Œä½†æ˜¯ç”Ÿæˆå™¨å’Œè¾¨åˆ«å™¨çš„å…³ç³»æ›´åƒæ˜¯æœ‹å‹ï¼Œæœ€åˆå¤§å®¶éƒ½æ˜¯â€œæ— åä¹‹è¾ˆâ€ï¼Œéšç€ä¸æ–­çš„è®­ç»ƒâ€œåˆ‡ç£‹â€ï¼Œå…±åŒæˆä¸ºâ€œä¸€ä»£é«˜æ‰‹â€ã€‚ æˆ‘ä»¬è®­ç»ƒGANçš„æœ€ç»ˆç›®æ ‡æ˜¯è·å¾—å¥½ç”¨çš„ç”Ÿæˆå™¨ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆè¶³å¤Ÿä»¥å‡ä¹±çœŸçš„å†…å®¹ï¼Œèƒ½å®Œæˆç±»ä¼¼åŠŸèƒ½çš„è¿˜æœ‰æ³¢å°”æ–¯æ›¼æœºã€å˜åˆ†è‡ªç¼–ç å™¨ç­‰ï¼Œå®ƒä»¬è¢«ç§°ä¸ºç”Ÿæˆæ¨¡å‹ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:3:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"å››ã€åŸæ–‡çš„æ‘˜è¦ quote åˆ°åº•ä»€ä¹ˆæ˜¯GANï¼Ÿ é¦–å…ˆä½œè€…æå‡ºä¸€ä¸ªæ–°çš„frameworkï¼Œé€šè¿‡ä¸€ä¸ªå¯¹æŠ—è¿‡ç¨‹æ¥ä¼°è®¡ä¸€ä¸ªç”Ÿæˆæ¨¡å‹ã€‚ åŒæ—¶ä¼šè®­ç»ƒä¸¤ä¸ªæ¨¡å‹ï¼š ç¬¬ä¸€ä¸ªæ¨¡å‹å«åš ç”Ÿæˆæ¨¡å‹Gï¼Œç”¨æ¥æ•è·æ•´ä¸ªæ•°æ®çš„åˆ†å¸ƒï¼Œå…¶å®å°±æ˜¯é€šè¿‡ ç”Ÿæˆå™¨ å»æ‹Ÿåˆå’Œé€¼è¿‘çœŸå®çš„æ•°æ®åˆ†å¸ƒï¼› ç¬¬äºŒä¸ªæ˜¯ è¾¨åˆ«æ¨¡å‹Dï¼Œå®ƒæ˜¯ç”¨æ¥ä¼°è®¡ä¸€ä¸ªæ ·æœ¬æ˜¯æ¥è‡ªçœŸæ­£çš„æ•°æ®ã€è¿˜æ˜¯æ¥è‡ªäºGç”Ÿæˆçš„ã€‚ Note è¿™é‡Œç¨å¾®è§£é‡Šä¸€ä¸‹ï¼šç”Ÿæˆæ¨¡å‹ å®ƒå°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®çš„åˆ†å¸ƒè¿›è¡Œå»ºæ¨¡ï¼Œä½¿å¾—èƒ½å¤Ÿç”Ÿæˆå„ç§åˆ†å¸ƒã€‚è¿™é‡Œâ€œåˆ†å¸ƒâ€æ˜¯ä¸€ä¸ªå¾ˆä¸€èˆ¬åŒ–çš„è¯ï¼Œæ¯”å¦‚ç”Ÿæˆå›¾ç‰‡ã€ç”Ÿæˆæ–‡æœ¬ã€ç”Ÿæˆè§†é¢‘ç­‰ã€‚åœ¨ç»Ÿè®¡å­¦çœ¼é‡Œï¼Œæ•´ä¸ªä¸–ç•Œæ˜¯é€šè¿‡é‡‡æ ·ä¸åŒçš„åˆ†å¸ƒæ¥å¾—åˆ°çš„ï¼Œæ‰€ä»¥æƒ³è¦ç”Ÿæˆä¸œè¥¿ï¼Œç›®çš„å°±æ˜¯è¦æŠ“ä½æ•´ä¸ªæ•°æ®çš„ä¸€ä¸ªåˆ†å¸ƒã€‚ ç”Ÿæˆæ¨¡å‹çš„ä»»åŠ¡æ˜¯å°½é‡çš„æƒ³è®©è¾¨åˆ«æ¨¡å‹çŠ¯é”™ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸€ä¸ªæœ€å¤§æœ€å°çš„åšå¼ˆã€‚åœ¨ä»»ä½•å‡½æ•°ç©ºé—´çš„Gå’ŒDé‡Œé¢ï¼Œå­˜åœ¨ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„è§£ï¼Œè¿™ä¸ªè§£æ˜¯ä»£è¡¨ï¼šGèƒ½å¤Ÿæ‰¾å‡ºè®­ç»ƒæ•°æ®çš„çœŸå®åˆ†å¸ƒï¼ˆç”Ÿæˆçš„æ•°æ®åˆ†å¸ƒè¶‹å‘äºçœŸå®æ•°æ®åˆ†å¸ƒï¼‰ï¼Œæ­¤æ—¶è¾¨åˆ«å™¨å°±åˆ¤åˆ«ä¸å‡ºæ¥äº†ï¼Œæ‰€ä»¥æ¦‚ç‡å€¼ä¸º$\\frac{1}{2}$ã€‚ å¦‚æœGå’ŒDæ˜¯ä¸€ä¸ªMLPçš„è¯ï¼Œé‚£ä¹ˆæ•´ä¸ªç³»ç»Ÿå°±å¯ä»¥é€šè¿‡è¯¯å·®åå‘ä¼ æ’­æ¥è¿›è¡Œè®­ç»ƒã€‚ä½œè€…è¯´è¿™é‡Œä¸éœ€è¦ä½¿ç”¨ä»»ä½•çš„é©¬å°”ç§‘å¤«é“¾ï¼Œæˆ–è€…è¯´æ˜¯å¯¹ä¸€ä¸ªè¿‘ä¼¼çš„æ¨ç†è¿‡ç¨‹å±•å¼€ï¼ˆè¯´ç™½äº†æ„æ€å¥½åƒå°±æ˜¯å’Œåˆ«äººçš„æ–¹æ³•æ¯”æ¯”è¾ƒç®€å•ä¸€ç‚¹ï¼‰ï¼Œæœ€åå°±æ˜¯è¯´å®éªŒçš„æ•ˆæœéå¸¸å¥½ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:4:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"äº”ã€åŸæ–‡çš„ä¾‹å­ åœ¨å¯¹æŠ—ç½‘ç»œçš„æ¡†æ¶é‡Œæœ‰ä¸¤ç±»æ¨¡å‹ï¼šä¸€ä¸ªæ˜¯ç”Ÿæˆæ¨¡å‹ã€ä¸€ä¸ªæ˜¯åˆ¤åˆ«æ¨¡å‹ï¼š ç”Ÿæˆæ¨¡å‹æ¯”å–»æˆé€ å‡çš„äººï¼Œå®ƒè¦å»äº§ç”Ÿå‡å¸ï¼› åˆ¤åˆ«æ¨¡å‹æ¯”å–»æˆè­¦å¯Ÿï¼Œè­¦å¯Ÿçš„ä»»åŠ¡å°±æ˜¯å¾ˆå¥½çš„é‰´åˆ«å‡å¸å’ŒçœŸå¸ï¼› é€ å‡è€…å’Œè­¦å¯Ÿä¼šä¸æ–­çš„å­¦ä¹ ï¼Œé€ å‡è€…ä¼šæå‡è‡ªå·±çš„é€ å‡æŠ€èƒ½ï¼Œè­¦å¯Ÿä¹Ÿä¼šæå‡è‡ªå·±åˆ¤åˆ«çœŸå¸å’Œå‡å¸çš„æ€§èƒ½ã€‚æœ€åå¸Œæœ›é€ å‡è€…èƒ½å¤Ÿèµ¢ï¼Œå°±æ˜¯è¯´é€ çš„å‡é’±å’ŒçœŸé’±ä¸€æ¨¡ä¸€æ ·ï¼Œç„¶åè­¦å¯Ÿæ²¡æœ‰èƒ½åŠ›å»åŒºåˆ†çœŸå¸å’Œå‡å¸ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ç”Ÿæˆå™¨ç”Ÿæˆå’ŒçœŸå®æ•°æ®ä¸€æ ·çš„æ•°æ®äº†ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:5:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"å…­ã€GANæ¨¡å‹ç»“æ„ \u0026 è®­ç»ƒGANçš„ç›®çš„ æ‘˜è¦è¯´çš„å·²ç»å¾ˆæ¸…æ¥šäº†ï¼ŒGANç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š ç”Ÿæˆå™¨Gï¼ˆGeneratorï¼‰ï¼› åˆ¤åˆ«å™¨Dï¼ˆDiscriminatorï¼‰ï¼› æˆ‘ä»¬çš„æœ€ç»ˆç›®çš„æ˜¯å¸Œæœ›ç”Ÿæˆå™¨Gï¼Œèƒ½å¤Ÿå­¦ä¹ åˆ°æ ·æœ¬çš„çœŸå®åˆ†å¸ƒ$P_{\\text{data}}(x)$ï¼Œé‚£ä¹ˆå°±èƒ½ç”Ÿæˆä¹‹å‰ä¸å­˜åœ¨çš„ã€ä½†æ˜¯å´åˆå¾ˆçœŸå®çš„æ ·æœ¬ã€‚ é‚£å†å•°å—¦çš„è¯´æ˜ç™½ä¸€ç‚¹å°±æ˜¯ï¼š æˆ‘ä»¬æŠŠéšæœºå‘é‡ï¼ˆéšæœºå™ªå£°ï¼‰å®šä¹‰ä¸º $z$ï¼Œ$z \\in F$ï¼Œå¯ä»¥æ˜¯ä»»æ„åˆ†å¸ƒï¼Œæ¯”å¦‚æ­£æ€åˆ†å¸ƒã€å‡åŒ€åˆ†å¸ƒã€‚ å°†éšæœºå™ªå£°è¾“å…¥åˆ° ç”Ÿæˆå™¨G ä¸­ï¼ŒGå…¶å®çœ‹æˆä¸€ä¸ªå‡½æ•°å°±å¯ä»¥ï¼Œå®ƒå¯ä»¥æ˜¯ä»»æ„çš„ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œå› ä¸ºç¥ç»ç½‘ç»œå¯ä»¥é€¼è¿‘ä»»ä½•å½¢å¼çš„å‡½æ•°ã€‚ éšæœºå™ªå£° $z$ ç»è¿‡ç”Ÿæˆå™¨Gåä¼šäº§ç”Ÿä¸€ä¸ª $G(z)$ï¼Œç”Ÿæˆçš„è¿™ä¸ªæ–°çš„å‘é‡ $G(z)$ï¼Œå®ƒå¯ä»¥è®°ä¸ºæœä»$P_G(x)$ã€‚ä½†æ˜¯$P_G(x)$è¿™ä¸ªåˆ†å¸ƒä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ˜¯ç”Ÿæˆå™¨Gç”Ÿæˆä¸€ä¸ªæ»¡è¶³äºçœŸå®åˆ†å¸ƒ$P_{\\text{data}}(x)$çš„æ•°æ®ã€‚ é€šè¿‡ä¸æ–­çš„è®­ç»ƒè¿­ä»£ï¼Œæ›´æ–°è°ƒæ•´ç”Ÿæˆå™¨Gçš„å‚æ•°ï¼Œä½¿å¾—$P_G(x)$è¿‘ä¼¼äº $P_{\\text{data}}(x)$ã€‚ é€šè¿‡è°ƒæ•´ ç”Ÿæˆå™¨G çš„å‚æ•°ï¼Œä½¿å¾—å®ƒç”Ÿæˆçš„åˆ†å¸ƒå’ŒçœŸå®çš„åˆ†å¸ƒå°½å¯èƒ½çš„åƒï¼Œè¿™ä¸ªå°±æ˜¯æœ€ç»ˆè¦è¾¾åˆ°çš„ç›®çš„ï¼Œå¯ä»¥é€šè¿‡ ç”Ÿæˆå™¨G ç”Ÿæˆä¸€äº›æ»¡è¶³çœŸå®åˆ†å¸ƒï¼Œä½†åˆä¸æ˜¯çœŸå®å­˜åœ¨çš„æ•°æ®ã€‚ æˆ‘ä»¬ä»¥æ‰‹å†™æ•°å­—è¯†åˆ«ä¸ºä¾‹ï¼Œå›¾ä¾‹å¦‚ä¸‹ï¼š GANæ¨¡å‹ç»“æ„å›¾å¦‚ä¸‹ç¤ºä¾‹ï¼š æˆ‘ä»¬å°†éšæœºå™ªå£°è¾“å…¥åˆ°ç”Ÿæˆå™¨Gä¸­ï¼Œäº§ç”Ÿ $G(z)$ï¼Œæˆ‘ä»¬æŠŠå®ƒå«åš$x_{\\text{fake}}$ï¼Œ$x_{\\text{fake}}$ä¸ºç”Ÿæˆçš„å›¾ç‰‡ï¼Œå°±æ˜¯å‡çš„å›¾ç‰‡ï¼› æˆ‘ä»¬è¿˜æœ‰æ»¡è¶³äºçœŸå®åˆ†å¸ƒ$P_{\\text{data}}(x)$çš„æ•°æ®ï¼Œè®°ä¸º$x_{\\text{real}}$ï¼› æˆ‘ä»¬æŠŠ $x_{\\text{real}}$ å’Œ $x_{\\text{fake}}$ åŒæ—¶é€åˆ°åˆ¤åˆ«å™¨Dä¸­å»è®­ç»ƒï¼Œåšä¸€ä¸ªäºŒåˆ†ç±»ä»»åŠ¡ï¼Œåˆ¤æ–­æ˜¯çœŸè¿˜æ˜¯å‡ï¼› ","date":"2023-07-26","objectID":"/posts/gan_1/:6:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"ä¸ƒã€ä¸¾ä¾‹ç†è§£GANçš„åŸç† Note å› ä¸ºåŸæ–‡ä¸¾çš„ä¾‹å­æ¯”è¾ƒæ•æ„Ÿï¼Œæˆ‘ä»¬ä»¥æå®æ¯…è€å¸ˆçš„ä¾‹å­ï¼ˆä¸­å¤®ç”µè§†å°é‰´å®èŠ‚ç›®ï¼šä¸€æ§Œå®šéŸ³ï¼‰æ¥è¿›è¡ŒGANåŸç†çš„é˜è¿°ã€‚ å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªäººï¼Œæˆ‘ä»¬ç§°å®ƒä¸ºå°ç‹ï¼Œå°ç‹æ˜¯ä¸€ä¸ªæ”¶è—å®¶ï¼Œå®ƒçš„æ”¶è—å®¤é‡Œæ”¶è—äº†å¾ˆå¤šâ€œå›½å®â€ã€‚ä½†æ˜¯å°ç‹ä¸æƒ³åªåšä¸€ä¸ªæ”¶è—å®¶ï¼Œä»–è¿˜æƒ³é«˜ä»¿è¿™äº›â€œå›½å®â€ï¼Œæˆ‘ä»¬è¿™é‡Œå°†é«˜ä»¿çš„èµå“å®šä¹‰ä¸ºâ€œå·¥è‰ºå“â€ã€‚ åŸºäºGANçš„ç›®æ ‡ï¼Œæˆ‘ä»¬çŸ¥é“ï¼š å°ç‹æœ€ç»ˆæƒ³æˆä¸ºä¸€ä¸ªæ°´å¹³å¾ˆé«˜çš„â€œå·¥è‰ºå“å¤§å¸ˆâ€ï¼› ä½†æ˜¯å¦‚æœæƒ³æˆä¸ºä¸€ä¸ªâ€œå·¥è‰ºå“â€æ–¹é¢çš„ä¸“å®¶ï¼Œå°ç‹è‡ªå·±åœ¨å®¶é—­é—¨é€ è½¦è‚¯å®šæ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ€»ç›®æ ‡æ˜¯æƒ³è®©å°ç‹æˆä¸ºä¸€ä¸ªé«˜æ°´å¹³çš„ã€å¯ä»¥ä»¥å‡ä¹±çœŸçš„å·¥è‰ºå“å¤§å¸ˆã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªé«˜æ°´å¹³çš„é‰´èµä¸“å®¶ï¼ˆé«˜æ°´å¹³çš„å¯¹æ‰‹ï¼‰ï¼Œå…¶æ¬¡å°ç‹æœ¬èº«å°±è¦æ˜¯ä¸ªé«˜æ°´å¹³çš„å·¥è‰ºå“å¤§å¸ˆã€‚æ‰€ä»¥å°ç‹è¿˜éœ€è¦æ‰¾ä¸€ä¸ªæ°´å¹³å¾ˆé«˜çš„å›½å®é‰´èµä¸“å®¶ã€‚é‰´èµä¸“å®¶è´Ÿè´£è¾¨åˆ«å‡ºçœŸçš„â€œå›½å®â€å’Œå°ç‹çš„â€œå·¥è‰ºå“â€ï¼Œå°ç‹è´Ÿè´£é«˜ä»¿ç”Ÿäº§â€œå·¥è‰ºå“â€ã€‚ æ¦‚è¿°æ¥è¯´ï¼šå°ç‹éœ€è¦å…ˆæœ‰ä¸€ä¸ªé«˜æ°´å¹³çš„ä¸“å®¶ï¼Œç„¶åæ‰å¯èƒ½æˆä¸ºä¸€ä¸ªé«˜æ°´å¹³çš„å¤§å¸ˆã€‚é«˜æ°´å¹³çš„ä¸“å®¶å¯ä»¥çœ‹æˆä¸€ç§æ‰‹æ®µï¼Œæˆä¸ºé«˜æ°´å¹³çš„å¤§å¸ˆæ‰æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:7:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"å…«ã€æ•°å­¦æè¿° ","date":"2023-07-26","objectID":"/posts/gan_1/:8:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"8.1 ç›¸å…³ç¬¦å· åŸºäºä¸Šè¿°é‰´å®ä¾‹å­ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹GANçš„æ•°å­¦æè¿°ï¼Œé¦–å…ˆéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼š å·¥è‰ºå“ç»è¿‡é‰´èµä¸“å®¶åˆ¤æ–­åï¼Œæ˜¯ä¼šå—åˆ°ä¸€ä¸ª feedback çš„ï¼› å¯¹äºé‰´èµä¸“å®¶è€Œè¨€ï¼Œå®ƒä¹Ÿä¼šä»å·¥è‰ºå“å—åˆ°ä¸€ä¸ª feedback ï¼Œå½“ç„¶è¿™æ˜¯æ½œåœ¨çš„ï¼› æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹ï¼Œè¿™ä¸ªä¾‹å­å¦‚ä½•ç”¨æ•°å­¦ç¬¦å·å»è¡¨ç¤ºï¼š â€œå›½å®\"æ˜¯é™æ€çš„ï¼Œå®ƒç›¸å½“äºæˆ‘ä»¬çš„çœŸå®æ ·æœ¬ ${x_{\\text{real}i}}^N{i=1}$ ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥ $P_{data}$ è¡¨ç¤ºï¼› å·¥è‰ºå“ä¹Ÿæ˜¯ä»ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒé‡ŒæŠ½æ ·å‡ºæ¥çš„ï¼Œæˆ‘ä»¬å°†å·¥è‰ºå“è®°ä½œ ${x_{\\text{fake}i}}^N{i=1}$ ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ¦‚ç‡åˆ†å¸ƒç§°ä½œ $P_g(x;\\theta_{g})$ï¼Œgå°±ä»£è¡¨Generatorçš„æ„æ€ï¼› Note æ³¨æ„æˆ‘ä»¬å¹¶ä¸ç›´æ¥å¯¹ $P_g$ å»ºæ¨¡ï¼Œå³ä¸ç›´æ¥å¯¹ç”Ÿæˆæ¨¡å‹æœ¬èº«è¿›è¡Œå»ºæ¨¡ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œå»é€¼è¿‘è¿™ä¸ªåˆ†å¸ƒï¼Œçº¯ç²¹çš„ç¥ç»ç½‘ç»œå®ƒæ˜¯ä¸å…·å¤‡éšæœºæ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå‡è®¾å®ƒæœ‰ä¸€ä¸ª $z$ï¼Œå°±æ˜¯å‰é¢æåˆ°çš„éšæœºå™ªå£°ï¼Œæ˜¯æ¥è‡ªäºä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œæ¯”å¦‚é«˜æ–¯åˆ†å¸ƒï¼š $z \\sim P_Z(z)$ ï¼› åŸå§‹çš„GANé‡Œï¼Œç¥ç»ç½‘ç»œå°±ç”¨NNè¡¨ç¤ºï¼Œå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ªç¡®å®šæ€§å˜æ¢ï¼Œå³æ˜¯ä¸€ä¸ªå¤æ‚å‡½æ•°ï¼Œè¡¨ç¤ºä¸º $G(z;\\theta_{g})$ï¼› Note $\\theta_g$ åœ¨NNé‡Œå°±æ˜¯è¡¨ç¤ºæƒé‡å‚æ•°ï¼Œåœ¨ $P_g$ é‡Œå°±æ˜¯ä»£è¡¨æ¦‚ç‡åˆ†å¸ƒå‚æ•°ã€‚ é‰´èµä¸“å®¶ä¹Ÿå¯ä»¥çœ‹æˆä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œæˆ‘ä»¬ä¹Ÿç”¨ä¸€ä¸ªNNæ¥æè¿°å®ƒï¼š$D(x; \\theta_{d})$ï¼Œä»£è¡¨ $x$ æ˜¯å›½å®çš„æ¦‚ç‡ å¯¹äºé‰´èµä¸“å®¶ (åˆ¤åˆ«å™¨D) æ¥æ”¶åˆ°çš„æ¥è¯´ï¼š å¯ä»¥æ˜¯æ¥è‡ªå›½å®ã€ä¹Ÿå¯ä»¥æ˜¯æ¥è‡ªäºå·¥è‰ºå“ï¼Œæ˜¯æ— æ‰€è°“çš„ï¼Œé‡è¦çš„æ˜¯æœ¬èº«æ˜¯ä»£è¡¨æ˜¯å›½å®çš„æ¦‚ç‡ã€‚ å¯¹äºåˆ¤åˆ«å™¨Dçš„è¾“å‡ºæ¥è¯´ï¼š $D(x)$ çš„å€¼è¶Šè¶‹è¿‘äº1ï¼Œè¯´æ˜å®ƒæ˜¯å›½å®çš„æ¦‚ç‡å°±è¶Šå¤§ï¼›è¶Šè¶‹è¿‘äº0ï¼Œè¯´æ˜å®ƒæ˜¯å·¥è‰ºå“çš„æ¦‚ç‡å°±è¶Šå¤§ã€‚ ä¸Šå›¾åˆå¯ç®€åŒ–ä¸ºï¼š ä¸€æ–¹é¢æ˜¯ä» $P_{data}$ é‡Œæ¥çš„ $x_{real}$ï¼Œä¸€æ–¹é¢æ˜¯ $z$ è¾“å…¥åˆ°ç”Ÿæˆå™¨åçš„è¾“å‡º $x_{fake}$ï¼Œ$z$ ä¸ºå™ªå£°ã€‚ Note æ¢å¥è¯è¯´, $z$ æ˜¯ä»ç®€å•åˆ†å¸ƒä¸­é‡‡æ ·ï¼Œç»è¿‡ç”Ÿæˆå™¨åå˜æˆ $x$ï¼Œæ­¤æ—¶ç”Ÿæˆçš„ç”±çš„å…ˆéªŒåˆ†å¸ƒå’Œç”Ÿæˆå™¨å…±åŒå†³å®šã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:8:1","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"8.2ã€â€œé«˜ä¸“å®¶â€çš„ç›®æ ‡å‡½æ•° ç¬¦å·æè¿°è¡¨è¿°æ¸…æ¥šåï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹GANçš„ç›®æ ‡å‡½æ•°ï¼Œé¦–å…ˆå›é¡¾ä¸€ä¸‹GANçš„ç›®æ ‡ï¼šæˆä¸ºä¸€ä¸ªé«˜æ°´å¹³çš„ã€å¯ä»¥ä»¥å‡ä¹±çœŸçš„å¤§å¸ˆã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œæˆ‘ä»¬åˆå¯ä»¥åˆ†ä¸ºä¸€ä¸ªæ‰‹æ®µå’Œä¸€ä¸ªç›®æ ‡ï¼š æ‰‹æ®µï¼šéœ€è¦ä¸€ä¸ªé«˜æ°´å¹³çš„é‰´åˆ«ä¸“å®¶ï¼› ç›®æ ‡ï¼šæˆä¸ºé«˜æ°´å¹³çš„å·¥è‰ºå“å¤§å¸ˆã€‚ ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦å…ˆæˆå°±ä¸€ä¸ªé«˜æ°´å¹³çš„ä¸“å®¶ï¼Œæ‰æœ‰å¯èƒ½æˆå°±ä¸€ä¸ªé«˜æ°´å¹³çš„å¤§å¸ˆï¼Œæ‰€ä»¥å®ƒä»¬çš„å…³ç³»æ˜¯ï¼š(é«˜å¤§å¸ˆ(é«˜ä¸“å®¶))ã€‚ é¦–å…ˆçœ‹é«˜ä¸“å®¶ï¼Œé«˜ä¸“å®¶æ°´å¹³é«˜ä½“ç°åœ¨ï¼šå›½å®åˆ¤åˆ«ä¸ºçœŸã€å·¥è‰ºå“åˆ¤åˆ«ä¸ºå‡ï¼š $$ é«˜ä¸“å®¶ï¼š \\begin{equation} \\left{ \\begin{aligned} %\\nonumber if \\ x \\ is \\ from \\ P_{data}, \\ then D(x) \\uparrow\\ if \\ x \\ is \\ from \\ P_{g}, \\ then D(x) \\downarrow\\ (z \\ is \\ from \\ P_{z}) \\ \\end{aligned} \\right. \\end{equation} $$ ä¸ºäº†å°†å¼å­ç»Ÿä¸€èµ·æ¥ï¼Œæˆ‘ä»¬æ”¹å†™ä¸ºï¼š $$ é«˜ä¸“å®¶ï¼š \\begin{equation} \\left{ \\begin{aligned} %\\nonumber if \\ x \\ is \\ from \\ P_{data}, \\ then D(x) \\uparrow\\ if \\ x \\ is \\ from \\ P_{g}, \\ then \\ 1-D(x) \\uparrow\\ (z \\ is \\ from \\ P_{z}) \\ \\end{aligned} \\right. \\end{equation} $$ Note å› ä¸º $D(x)$ æ˜¯ä¸€ä¸ªæ¦‚ç‡å€¼åˆ†å¸ƒï¼ŒèŒƒå›´æ˜¯0~1ï¼Œ $D(x)$ åå°ï¼Œ $1-D(x)$ åˆ™ç›¸åº”çš„å°±åå¤§ã€‚ å¯¹äºå·¥è‰ºå“ï¼Œ$x$ æ˜¯ä»ç”Ÿæˆå™¨Gæ¥çš„ï¼Œæ‰€ä»¥å¯ä»¥è¡¨ç¤ºæˆ $G(z)$ï¼š $$ é«˜ä¸“å®¶ï¼š \\begin{equation} \\left{ \\begin{aligned} %\\nonumber if \\ x \\ is \\ from \\ P_{data}, \\ then D(x) \\uparrow\\ if \\ x \\ is \\ from \\ P_{g}, \\ then \\ 1 - D(G(z)) \\uparrow\\ (z \\ is \\ from \\ P_{z}) \\ \\end{aligned} \\right. \\end{equation} $$ ä¸ºäº†ä½¿ç›®æ ‡å‡½æ•°æ›´å®¹æ˜“è¡¨è¾¾ï¼Œæˆ–è€…è¯´è®¡ç®—æ›´åŠ æ–¹ä¾¿ï¼Œæˆ‘ä»¬åŠ ä¸Šï¼Œæ‰€ä»¥è¿›ä¸€æ­¥è¡¨è¾¾ä¸ºï¼š $$ é«˜ä¸“å®¶ï¼š \\begin{equation} \\left{ \\begin{aligned} %\\nonumber if \\ x \\ is \\ from \\ P_{data}, \\ then \\ \\log{D(x)} \\uparrow\\ if \\ x \\ is \\ from \\ P_{g}, \\ then \\ \\log{(1 - D(G(z)))} \\uparrow\\ (z \\ is \\ from \\ P_{z}) \\ \\end{aligned} \\right. \\end{equation} $$ Note $\\log$ ä¸ºå¢å‡½æ•°ï¼Œ$\\log(x)$ ä¸ $x$ çš„å¢å‡æ€§ä¿æŒä¸€è‡´ï¼Œåœ¨æå¤§åŒ–å‚æ•°çš„æ—¶å€™ï¼Œä¸åŸå§‹æ±‚è§£æ˜¯ä¸€æ ·çš„ã€‚ æ‰€ä»¥å¯¹äºæˆå°±ä¸€ä¸ªé«˜ä¸“å®¶æ¥è¯´ï¼Œç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š $$\\max_{D} E_{x \\sim P_{data}}[\\log{D(x)}] + E_{z \\sim P_{z}}[\\log (1 - D(G(z)))]$$ note å¯èƒ½æœ‰åŒå­¦ä¸æ˜ç™½ä¸ºä»€ä¹ˆåŸæ–‡è¿™é‡Œç”¨æœŸæœ›ï¼Œå…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬å‡è®¾æ•°æ®åˆ†å¸ƒæ€»å…±æœ‰ä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆå®ƒçš„æœŸæœ›å¯ä»¥è¡¨ç¤ºä¸ºï¼š $$E_{x \\sim P_{data}}[\\log(D(x))] = \\frac{1}{N} \\sum_{i=1}^{N} \\log(D(x_i)), x_i \\sim P_{data}$$ ","date":"2023-07-26","objectID":"/posts/gan_1/:8:2","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"8.3ã€â€œé«˜å¤§å¸ˆâ€çš„ç›®æ ‡å‡½æ•° æˆ‘ä»¬å†æ¥çœ‹é«˜å¤§å¸ˆçš„ç›®æ ‡å‡½æ•°ï¼Œé«˜å¤§å¸ˆæ˜¯å»ºç«‹åœ¨é«˜ä¸“å®¶çš„æ°´å¹³ä¹‹ä¸Šï¼Œå¯¹äºé«˜å¤§å¸ˆæ¥è®²ï¼Œå¸Œæœ›é«˜ä¸“å®¶å°†æ‰€æœ‰çš„å·¥è‰ºå“éƒ½åˆ¤æ–­ä¸ºçœŸï¼š $$é«˜å¤§å¸ˆ: if \\ x \\ from \\ P_g,\\ then \\ D(G(z)) \\uparrow $$ ä¸ºäº†ç»Ÿä¸€èµ·æ¥ï¼Œæˆ‘ä»¬æ”¹å†™ä¸º: $$é«˜å¤§å¸ˆ: if \\ x \\ from \\ P_g,\\ then \\ (1 - D(G(z))) \\downarrow $$ æ‰€ä»¥å¯¹äºé«˜å¤§å¸ˆæ¥è®²ï¼Œç›®æ ‡å‡½æ•°ä¸º: $$\\min_{G} E_{z \\sim P_z}[\\log (1 - D(G(z)))]$$ ","date":"2023-07-26","objectID":"/posts/gan_1/:8:3","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"8.4ã€æ€»ç›®æ ‡å‡½æ•° æœ¬ç€å…ˆæˆå°± é«˜ä¸“å®¶, å†æˆå°± é«˜å¤§å¸ˆçš„åŸåˆ™ï¼ŒGANçš„ç›®æ ‡å‡½æ•°ä¸ºï¼š $$\\min_{G} \\max_{D} V(D, G) = \\mathbb{E_{x\\sim p_{data}(x)}}[\\log(D(x))] + \\mathbb{E_{z\\sim p_{z}(z)}}[\\log(1 - D(G(z)))]$$ Note é€šè¿‡ç›®æ ‡å‡½æ•°æˆ‘ä»¬ä¹Ÿèƒ½çœ‹å‡ºï¼ŒGANæ¨¡å‹çš„å¤æ‚åº¦ï¼Œä¸åœ¨äºæ¨¡å‹çš„å®šä¹‰ï¼Œè€Œåœ¨äºæ¨¡å‹çš„traningï¼Œä¹Ÿå°±æ˜¯Då’ŒGçš„å­¦ä¹ ã€‚ Note è¿˜æœ‰ä¸€ç‚¹éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œè‡ªå§‹è‡³ç»ˆæˆ‘ä»¬éƒ½æ²¡æœ‰å»ç›´æ¥é¢å¯¹ $P_g$ï¼Œæˆ‘ä»¬å®é™…ä¸Šä½¿ç”¨ä¸€ä¸ªå¯å¾®ç¥ç»ç½‘ç»œ $G(z)$ å»é€¼è¿‘è¿™ä¸ª $P_g$ ï¼Œè€Œä¸”æ˜¯ä»é‡‡æ ·çš„è§’åº¦å»é€¼è¿‘ï¼Œæ¢å¥è¯è¯´ï¼Œå¯¹äºç”Ÿæˆç½‘ç»œ $P_g$ï¼ŒGANæ˜¯ç»•è¿‡äº†å®ƒï¼Œå¹¶æ²¡æœ‰ç›´æ¥å»è§£å†³ $P_g$ï¼Œè€Œæ˜¯ä»é‡‡æ ·çš„è§’åº¦å»é€¼è¿‘å®ƒã€‚æ‰€ä»¥GANåˆè¢«ç§°åšï¼šImplicit Density Model. å…¬å¼æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥å¯¹ç›®æ ‡å‡½æ•°å†å•°å—¦çš„ä»‹ç»ä¸‹ï¼š æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œå®ƒå®é™…ä¸Šå°±è¦å¯¹ä»·å€¼å‡½æ•° $V(D, G)$ è¿›è¡Œminã€maxçš„åšå¼ˆï¼Œè¿˜æœ‰éœ€è¦æ³¨æ„çš„æ˜¯ï¼š$D(x)$ æ˜¯åˆ¤åˆ«å™¨çš„è¾“å‡ºï¼Œå®ƒè¦åšäºŒåˆ†ç±»ï¼Œæ‰€ä»¥ç»è¿‡sigmoidä¹‹å $D(x) \\in [0, 1]$ï¼› æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼š é¦–å…ˆå›ºå®šä½Gä¸åŠ¨ï¼Œé€šè¿‡è°ƒæ•´Dçš„å‚æ•°ï¼Œæ¥æœ€å¤§åŒ–ä»·å€¼å‡½æ•° $V(D, G)$ï¼š è¦æƒ³æœ€å¤§åŒ– $V$ ï¼Œå·¦è¾¹çš„ $D(x)$ è¦è¶‹è¿‘äº1ï¼ˆè¿™æ ·æ‰èƒ½ä¿è¯logçš„å€¼å°½å¯èƒ½å¤§ï¼‰ï¼ŒåŒæ—¶è¦è®©å³è¾¹çš„ $D(G(z))$ è¶‹è¿‘äº0ï¼ˆè¿™æ ·æ‰èƒ½ä¿è¯ $log(1-D(G(z)))$ å°½å¯èƒ½å¤§ï¼‰ï¼› $\\max V(D, G)$ å…¶å®å°±æ˜¯æŠŠçœŸå®æ•°æ®å’Œå‡æ•°æ®åŒºåˆ†çš„ä¸€ä¸ªè¿‡ç¨‹. $$\\min_{G} \\max_{D} V(D, G) = \\mathbb{E_{x\\sim p_{data}(x)}}[\\log(D(x))] + \\mathbb{E_{z\\sim p_{z}(z)}}[\\log(1 - D(G(z)))]$$ ç„¶åå›ºå®šä½Dä¸åŠ¨ï¼Œæ­¤æ—¶å…¬å¼çš„å·¦éƒ¨åˆ†å·²ç»æ˜¯ä¸ªå®šå€¼äº†ï¼Œæˆ‘ä»¬è°ƒæ•´Gçš„å‚æ•°ï¼Œæ¥æœ€å°åŒ–ä»·å€¼å‡½æ•° $V(D, G)$ï¼š è¦è®© $V(D, G)$ æœ€å°ï¼Œé‚£ä¹ˆå°±è¦è®© $D(G(z))$ è¶‹è¿‘äº1ï¼Œåªæœ‰ $V(G(z))$ è¶‹è¿‘äº1çš„æ—¶å€™ï¼Œå®šä¹‰åŸŸé‡Œçš„å€¼æ‰èƒ½è¶‹è¿‘äº0ï¼Œä¹Ÿå°±æ˜¯logä¼šå˜å¾—è¶Šæ¥è¶Šå°ï¼Œè¾¾åˆ°æœ€å°åŒ– $V$ çš„è¿‡ç¨‹ï¼› è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æƒ³è®© $D(G(z))$ è¶‹è¿‘äº1ï¼Œzæ»¡è¶³ç”Ÿæˆæ•°æ®çš„åˆ†å¸ƒï¼Œå®ƒæ˜¯å‡çš„ï¼Œé‚£ä¹ˆ $min_G$ çš„è¿‡ç¨‹å°±æ˜¯æƒ³è¦è°ƒæ•´ç”Ÿæˆå™¨ï¼Œæ¥éª—è¿‡åˆ¤åˆ«å™¨ï¼Œä»è€Œä½¿å¾—å‡æ•°æ®è¢«åˆ¤åˆ«ä¸ºçœŸã€‚ $$\\min_{G} \\max_{D} V(D, G) = \\mathbb{E_{x\\sim p_{data}(x)}}[\\log(D(x))] + \\mathbb{E_{z\\sim p_{z}(z)}}[\\log(1 - D(G(z)))]$$ æ€»ç»“å¦‚ä¸‹ï¼š å›ºå®šG, è°ƒæ•´D, æœ€å¤§åŒ– $V(D, G)$, å¯¼è‡´ $D(x) \\rightarrow 1, D(G(z)) \\rightarrow 0$ å›ºå®šD, è°ƒæ•´G, æœ€å°åŒ– $\\max_{D}V(D, G)$, å¯¼è‡´ $D(G(z)) \\rightarrow 1$ æƒ³å¿…è‚¯å®šæœ‰åŒå­¦ä¼šå‘ç°è¿™é‡Œå‡ºç°çš„ä¸€ä¸ªçŸ›ç›¾ï¼šä¸Šé¢çš„è¶‹è¿‘äº0ï¼Œä¸‹é¢çš„è¶‹è¿‘äº1ï¼Œè¿™ä¸ªçŸ›ç›¾ã€å†²çªï¼Œå°±ç†è§£ä¸ºGANä¸­çš„å¯¹æŠ—çš„æ„æ€ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:8:4","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"ä¹ã€å…¨å±€æœ€ä¼˜è§£æ¨å¯¼ å› ä¸ºå…¬å¼å¤šã€ç¯‡å¹…é•¿ï¼Œæ‰€ä»¥åœ¨æ¨å¯¼æœ€ä¼˜è§£ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹GANé‡Œçš„ä¸‰ä¸ªè§’è‰²ï¼š çœŸå®æ ·æœ¬åˆ†å¸ƒ$P_{data}$ï¼› ç”Ÿæˆå™¨ Generator å¯¹åº”æ¦‚ç‡åˆ†å¸ƒä¸º:$P_g$ï¼Œå³ä»£è¡¨ç”Ÿæˆå™¨ç”Ÿæˆæ•°æ®çš„æ¦‚ç‡åˆ†å¸ƒï¼› åˆ¤åˆ«å™¨ Discriminator å¯¹åº”çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒæ˜¯ç¦»æ•£çš„ï¼Œå°±æ˜¯0-1åˆ†å¸ƒï¼ˆä¼¯åŠªåˆ©åˆ†å¸ƒï¼‰ï¼Œç»™å®šxçš„æƒ…å†µä¸‹ï¼Œ1ä»£è¡¨æ­£å“ã€0ä»£è¡¨å·¥è‰ºå“ï¼ˆèµå“ï¼‰ï¼› æˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡ï¼Œå°±æ˜¯æƒ³è®©ç”Ÿæˆå™¨ç”Ÿæˆçš„æ ·æœ¬çš„æ¦‚ç‡åˆ†å¸ƒ$P_g$æ— é™çš„æ¥è¿‘äº$P_{data}$ï¼Œå³ï¼š$P_g \\rightarrow P_{data}$ï¼› note æˆ‘ä»¬å¸¸è§„çš„ç”Ÿæˆæ¨¡å‹ï¼ˆä¸æ˜¯GANï¼‰ï¼Œæ˜¯ç›´æ¥å¯¹$P_g$è¿›è¡Œå»ºæ¨¡: $P_g \\rightarrow \\theta_{g}$, æå¤§ä¼¼ç„¶ä¼°è®¡è¡¨ç¤ºå¦‚ä¸‹ï¼š $$\\theta_g = \\argmax_{\\theta_g} \\sum_{i=1}^N \\log{P_g}(x_i) = \\argmin KL(P_{data} || P_g)$$ ä»è·ç¦»çš„è§’åº¦è®²ï¼Œæ˜¯æœ€å°åŒ–KLæ•£åº¦ï¼Œæœ€ç»ˆæƒ³è®©$P_{data} = P_g$ï¼Œè¿™å°±æ˜¯åŸå…ˆå¦‚ä½•æŠŠå‚æ•°æ±‚å‡ºæ¥çš„ç­–ç•¥ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:9:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"9.1ã€å…³äº D çš„æœ€å¤§å€¼ GANä»å¯¹æŠ—å­¦ä¹ çš„è§’åº¦å»æ„é€ ç›®æ ‡å‡½æ•°ï¼Œæˆ‘ä»¬ä¸Šé¢æ„é€ çš„ç›®æ ‡å‡½æ•°ï¼Œåªæ˜¯ä»é€»è¾‘ä¸Šè§‰å¾—å®ƒæ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¼šè€ƒè™‘ï¼š è¿™ä¸ªæœ€å¤§æœ€å°é—®é¢˜ï¼Œå®ƒçš„æœ€ä¼˜è§£å­˜åœ¨ä¸å­˜åœ¨ï¼Ÿ å¦‚æœæœ€ä¼˜è§£ $P_g$ï¼ˆå°±æ˜¯Gï¼‰å­˜åœ¨ï¼Œé‚£ä¹ˆå…¨å±€æœ€ä¼˜çš„æƒ…å†µä¸‹ï¼Œ$P_g$æ˜¯å¦ç­‰äº$P_{data}$ï¼Ÿ å¦‚æœè¿™ä¸ªä¸æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆå…¶å®è¿™ä¸ªç›®æ ‡å‡½æ•°æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œæ–¹ä¾¿è®°ä½œï¼Œç›´æ¥ç”¨è®ºæ–‡ä¸­çš„ç¬¦å·æ¥æè¿°ï¼š æˆ‘ä»¬è®°ï¼š $$V(D, G) = \\mathbb{E}{x\\sim p{data}(x)}[\\log{D(x)}] + \\mathbb{E}{z\\sim p{z}}[\\log{1 - D(G(z))}]$$ æˆ‘ä»¬å…ˆæ±‚maxï¼Œæ ¹æ®æœŸæœ›çš„å®šä¹‰ï¼š$E_{x \\sim P(x)} = \\int_x p(x)f(x)dx$ï¼Œå°†å…¶å±•ä¸ºç§¯åˆ†çš„å½¢å¼ï¼š $\\quad For \\quad fixed \\quad G, æ±‚ï¼š \\max_D(V(D, G))$ $$ \\begin{align} \\max_D V(D, G) \u0026= \\int P_{data} \\cdot \\log D dx + \\int P_g \\cdot \\log (1 - D) dx \\ \u0026= \\int {[P_{data} \\cdot \\log D + P_g \\cdot \\log(1 - D)]} dx \\end{align} $$ note è¿™é‡Œä¸¤ä¸ªç§¯åˆ†ä¸­çš„xç¡®å®æ˜¯ä¸åŒçš„å˜é‡ï¼Œä½†æ˜¯ç§¯åˆ†å¾®å…ƒçš„ç¬¦å·å¯ä»¥åšä»»æ„å˜æ¢ï¼Œä¸ç”¨çº ç»“è¿™é‡Œã€‚ æˆ‘ä»¬è¦æ±‚é‡Œé¢å‡½æ•°å…³äºxç§¯åˆ†çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆå°±çœ‹ä¸€ä¸‹å®ƒçš„å¯¼æ•°ï¼š $$ \\begin{align} \\frac{\\partial}{\\partial{D}}(\\max V(D, G)) \u0026= \\frac{\\partial}{\\partial D}\\int {[P_{data} \\cdot \\log D + P_g \\cdot \\log(1 - D)]} \\ \u0026= \\int \\frac{\\partial}{\\partial D} {[P_{data} \\cdot \\log D + P_g \\cdot \\log(1 - D)]} \\ \u0026= \\int {[P_{data} \\cdot \\frac{1}{D} + P_g \\cdot \\frac{-1}{\\log(1 - D)}]} \\Longleftrightarrow 0\\ \\end{align} $$ note å› ä¸ºç§¯åˆ†æ˜¯å¯¹xç§¯çš„ï¼Œæ±‚å¯¼æ˜¯å¯¹Dæ±‚çš„ï¼Œä¸¤è€…äº’ä¸å¹²æ‰°å¯ä»¥äº¤æ¢è¯åºã€‚ æœ€ä¼˜çš„æ—¶å€™å¯¼æ•°ä¸º0ã€‚ $$\\therefore P_{data} \\cdot \\frac{1}{D} = P_g \\cdot \\frac{1}{1-D}$$ æ‰€ä»¥å½“å›ºå®šGæ—¶ï¼Œæœ€ä¼˜çš„Dä¸º: $$D^*G = \\frac{P{data}}{P_{data} + P_g}$$ ","date":"2023-07-26","objectID":"/posts/gan_1/:9:1","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"9.2 å…³äº G çš„æœ€å°å€¼ æœ€å¤§å€¼æ±‚å‡ºæ¥ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹å…³äºGçš„æœ€å°å€¼ï¼Œæˆ‘ä»¬å°†$D^*$å¸¦è¿›å»ï¼š $$ \\begin{align} \\min_G \\max_D V(D, G) \u0026= \\min_G V(D^*G, G) \\ \u0026= \\min_G E{x \\sim P_{data}}[\\log(\\frac{P_{data}}{P_{data} + P_g})] + E_{x \\sim P_{g}}[\\log(1 - \\frac{P_{data}}{P_{data} + P_g})] \\ \u0026= \\min_G E_{x \\sim P_{data}}[\\log(\\frac{P_{data}}{P_{data} + P_g})] + E_{x \\sim P_{g}}[\\log(\\frac{P_{g}}{P_{data} + P_g})]\\ \\end{align} $$ è¿™é‡Œ $P_{data}$ å’Œ $P_g$ï¼Œå’ŒKLæ•£åº¦çš„å®šä¹‰éå¸¸ç±»ä¼¼ï¼ŒKL divergenceå®šä¹‰ï¼š $$KL(P||Q) = E_{x \\sim P}[\\log(\\frac{P(x)}{Q(x)})]$$ ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥è¿™ä¹ˆå†™ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯åˆ†å­å’Œåˆ†æ¯å¿…é¡»åŒæ—¶ä¸ºä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œä½†æ˜¯åˆ†æ¯æ˜¯$P_{data} + P_g$ï¼Œæ˜¯ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒç›¸åŠ ï¼Œé‚£å®ƒçš„å–å€¼å°±å˜æˆ[0, 2]äº†ã€‚ æ‰€ä»¥æˆ‘ä»¬ç»™å®ƒå†é™¤ä»¥ä¸ª2å°±å¯ä»¥äº†ï¼Œå–å€¼èŒƒå›´å°±åˆå˜æˆ[0, 1]äº†ã€‚æ¢å¥è¯è¯´ï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œå…·ä½“ä»€ä¹ˆæ ·å­æ— æ‰€è°“ï¼Œå®ƒçš„å–å€¼åœ¨[0, 1]ä¹‹é—´ï¼Œå¹¶ä¸”æ˜¯è¿ç»­çš„ã€‚ $$ \\begin{align} \\min_G \\max_D V(D, G) \u0026= \\min_G V(D^*G, G) \\ \u0026= \\min_G E{x \\sim P_{data}}[\\log(\\frac{P_{data}}{P_{data} + P_g})] + E_{x \\sim P_{g}}[\\log(1 - \\frac{P_{data}}{P_{data} + P_g})] \\ \u0026= \\min_G E_{x \\sim P_{data}}[\\log(\\frac{P_{data}}{P_{data} + P_g})] + E_{x \\sim P_{g}}[\\log(\\frac{P_{g}}{P_{data} + P_g})]\\ \u0026= \\min_G E_{x \\sim P_{data}}[\\log(\\frac{P_{data}}{(P_{data} + P_g)/2} \\cdot\\frac{1}{2})] + E_{x \\sim P_{g}}[\\log(\\frac{P_{g}}{(P_{data} + P_g)/2}\\cdot\\frac{1}{2})]\\ \u0026= \\min_{G} KL (P_{data} || \\frac{P_{data} + P_g}{2}) + KL (P_{g} || \\frac{P_{data} + P_g}{2}) - \\log4\\ \\end{align} $$ tips å°†ä¸¤ä¸ª$\\log(\\frac{1}{2})$æ‹¿å‡ºå»ï¼Œ$\\log(\\frac{1}{2}) = \\log1 - \\log2 = -\\log2,$ï¼Œ$-\\log2$çš„æœŸæœ›å°±æ˜¯å®ƒè‡ªå·±ï¼Œä¸¤ä¸ªå°±æ˜¯$-\\log2-\\log2 = -\\log4$ æˆ‘ä»¬å¾—å‡ºä¸Šå¼ï¼Œå‘ç°å®ƒåˆæ»¡è¶³ JS divergence çš„å®šä¹‰ï¼š $$JSD(P||Q) = \\frac{1}{2} KL(P || M) + \\frac{1}{2} KL (Q||M), å…¶ä¸­ M = \\frac{P + Q}{2}$$ æ‰€ä»¥ä¸Šå¼åˆå¯å†™æˆï¼š $$\\min_G - \\log 4 + 2 JSP(P_{data}||P_g)$$ JS divergenceæ˜¯è¡¡é‡ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„è·ç¦»ï¼Œæ‰€ä»¥åªæœ‰å½“è¿™ä¸¤ä¸ªåˆ†å¸ƒè¶Šæ¥è¶Šç›¸ç­‰çš„æ—¶å€™ï¼Œå°±æ‰¾åˆ°è¿™ä¸ªå¼å­çš„æœ€å°å€¼äº†ï¼Œæ•…ï¼š å½“$P_g(x) = P_{data}(x)$æ—¶ï¼Œä¸Šå¼å¯å¾—æœ€å°å€¼ã€‚ æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼˜åŒ–ï¼š $$\\min_G\\max_D V(D, G) = \\mathbb{E}{x\\sim{p{data}(x)}}[\\log D(x)] + \\mathbb{E}{z\\sim{p{z}(z)}}[1 - \\log D(G(z))]$$ å°±å¯ä»¥å¾—åˆ°$P_g(x) = P_{data}(x)$. tips å¦å¤–ï¼Œå½“ $P_g(x) = P_{data}(x)$ æ—¶ï¼Œåˆå› ä¸º $D^G = \\frac{P{data}}{P_{data} + P_g}$ï¼Œ æ‰€ä»¥æ­¤æ—¶ $D^ = \\frac{1}{2}$ ã€‚æ„æ€æ˜¯ï¼Œåœ¨æœ€ä¼˜çš„æƒ…å†µä¸‹ï¼Œé‰´èµä¸“å®¶å·²ç»æ²¡æœ‰åˆ†è¾¨çœŸå‡çš„èƒ½åŠ›äº†ï¼Œæ¦‚ç‡éƒ½0.5ï¼Œè¿™ä¸ªæ—¶å€™åˆ¤åˆ«å™¨å¯¹äºç”Ÿæˆå™¨è€Œè¨€ï¼Œå·²ç»æ²¡æœ‰ç»§ç»­å­¦ä¹ çš„å¿…è¦äº†ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:9:2","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"åã€åŸæ–‡ç»™å‡ºçš„è®­ç»ƒæ­¥éª¤ åœ¨æ¯ä¸€ä¸ªstepé‡Œå…ˆé‡‡æ ·mä¸ªå™ªéŸ³æ ·æœ¬ï¼› å†é‡‡æ ·mä¸ªæ¥è‡ªäºçœŸå®æ•°æ®çš„æ ·æœ¬ï¼›è¿™æ ·å°±ç»„æˆäº†ä¸€ä¸ªå¤§å°ä¸º2mçš„å°æ‰¹é‡ï¼› å°†æ ·æœ¬åˆ†åˆ«æ”¾åˆ° ç”Ÿæˆå™¨ å’Œ è¾¨åˆ«å™¨ å»æ±‚æ¢¯åº¦ï¼Œæ›´æ–° è¾¨åˆ«å™¨ å‚æ•°ï¼› åšå®Œä¹‹åï¼š å†é‡‡æ ·mä¸ªå™ªéŸ³æ ·æœ¬ï¼Œæ”¾åˆ°å…¬å¼çš„ç¬¬äºŒé¡¹é‡Œé¢ï¼ˆå› ä¸ºæˆ‘ä»¬è¦æ›´æ–°ç”Ÿæˆå™¨ï¼Œç”Ÿæˆå™¨ä¸ç¬¬ä¸€é¡¹æ— å…³ï¼‰ï¼Œç®—å‡ºå®ƒçš„æ¢¯åº¦ï¼› ç„¶åå¯¹ç”Ÿæˆå™¨è¿›è¡Œå‚æ•°æ›´æ–°ã€‚ è¿™æ ·å°±å®Œæˆäº†ä¸€æ¬¡è¿­ä»£ï¼Œå¯ä»¥çœ‹åˆ°æ¯æ¬¡è¿­ä»£é‡Œï¼Œæˆ‘ä»¬æ˜¯å…ˆæ›´æ–°è¾¨åˆ«å™¨ï¼Œå†æ›´æ–°ç”Ÿæˆå™¨ã€‚ tips kæ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œä¸èƒ½å¤ªå°ä¹Ÿä¸èƒ½å¤ªå¤§ï¼Œè¦ä¿è¯è¾¨åˆ«å™¨æœ‰è¶³å¤Ÿçš„æ›´æ–°ï¼Œä½†ä¹Ÿä¸è¦æ›´æ–°å¤ªå¥½äº†ã€‚å¦‚æœæ²¡æœ‰è¶³å¤Ÿå¥½çš„æ›´æ–°ï¼Œå°±æ˜¯ç”Ÿæˆå™¨å˜æ¢äº†ä¹‹åï¼Œæ²¡æœ‰æŠŠè¾¨åˆ«å™¨æ›´æ–°çš„è¶³å¤Ÿå¥½ï¼Œ Gå·²ç»åšäº†å˜åŒ–ï¼Œä½†æ˜¯Dæ²¡æœ‰åšä»€ä¹ˆæ”¹å˜ï¼Œå†æ›´æ–°Gæ¥ç³Šå¼„Dï¼Œå…¶å®æ„ä¹‰ä¸å¤§ã€‚ åè¿‡æ¥è®²ï¼Œå¦‚æœä¸€æ›´æ–°å°±æŠŠDè®­ç»ƒåˆ°å®Œç¾ï¼Œé‚£ä¹ˆ1-Då°±ä¼šå˜æˆ0ï¼Œå¯¹ä¸€ä¸ª0çš„ä¸œè¥¿æ±‚å¯¼ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨ç”Ÿæˆæ¨¡å‹ä¸Šæ›´æ–°æœ‰å›°éš¾ã€‚ å›åˆ°åŸæ–‡çš„ä¾‹å­ï¼Œè¾¨åˆ«å™¨æ˜¯è­¦å¯Ÿï¼Œç”Ÿæˆå™¨å°±æ˜¯é€ å‡è€…ï¼Œå‡è®¾è­¦å¯Ÿç‰¹åˆ«å‰å®³ï¼Œé€ å‡è€…äº§ä¸€ç‚¹å‡é’å‡ºæ¥å°±è¢«è¿é”…ç«¯äº†ï¼Œé‚£é€ å‡è€…å°±æ²¡èƒ½åŠ›æ”¹è¿›å’Œæå‡è‡ªå·±äº†ï¼Œä½†åè¿‡æ¥è®²ï¼Œå¦‚æœè­¦å¯Ÿæ— åŠ›ï¼Œé€ å‡è€…éšä¾¿é€ ç‚¹ä¸œè¥¿ï¼Œè­¦å¯Ÿä¹Ÿçœ‹ä¸å‡ºæ¥ï¼Œé‚£é€ å‡è€…å°±ä¸ä¼šæœ‰åŠ¨åŠ›å»æ”¹è¿›å’Œæå‡è‡ªå·±ã€‚ æ‰€ä»¥æœ€å¥½æ˜¯ä¸¤è€…å®åŠ›ç›¸å½“ã€ç›¸çˆ±ç›¸æ€ï¼Œå¤§å®¶ä¸€èµ·è¿›æ­¥ã€‚æ‰€ä»¥kçš„è°ƒå‚ï¼Œè¦ä½¿å¾—Dçš„æ›´æ–°å’ŒGçš„æ›´æ–°è¿›åº¦éƒ½å·®ä¸å¤šã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:10:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"åä¸€ã€GANåŸç†åŠè®­ç»ƒè¿‡ç¨‹æ€»ç»“ ","date":"2023-07-26","objectID":"/posts/gan_1/:11:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"11.1ã€GANåŸç†æ€»ç»“ GANä¸»è¦åŒ…æ‹¬äº†ä¸¤éƒ¨åˆ†ï¼š ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰ï¼šç”Ÿæˆå™¨ä¸»è¦ç”¨æ¥å­¦ä¹ çœŸå®æ•°æ®çš„åˆ†å¸ƒï¼Œä»è€Œè®©è‡ªèº«ç”Ÿæˆçš„æ•°æ®æ›´åŠ çœŸå®ï¼Œéª—è¿‡åˆ¤åˆ«å™¨ï¼› åˆ¤åˆ«å™¨ï¼ˆDiscriminatorï¼‰ï¼šåˆ¤åˆ«å™¨åˆ™éœ€è¦å¯¹æ¥å—çš„æ•°æ®è¿›è¡ŒçœŸå‡åˆ¤æ–­ã€‚ åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆå™¨åŠªåŠ›åœ°è®©ç”Ÿæˆçš„æ•°æ®æ›´åŠ çœŸå®ï¼Œè€Œåˆ¤åˆ«å™¨åˆ™åŠªåŠ›åœ°å»è¯†åˆ«å‡ºæ•°æ®çš„çœŸå‡ï¼Œè¿™ä¸ªè¿‡ç¨‹ç›¸å½“äºä¸€ä¸ªäºŒäººåšå¼ˆï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨åœ¨ä¸æ–­çš„è¿›è¡Œå¯¹æŠ—ï¼Œè¿™å°±æ˜¯å®ƒå¯¹æŠ—çš„å«ä¹‰ã€‚ æœ€ç»ˆä¸¤ä¸ªç½‘ç»œè¾¾åˆ°äº†ä¸€ä¸ªåŠ¨æ€å‡è¡¡ï¼šç”Ÿæˆå™¨ç”Ÿæˆçš„æ•°æ®æ¥è¿‘äºçœŸå®æ•°æ®åˆ†å¸ƒï¼Œè€Œåˆ¤åˆ«å™¨è¯†åˆ«ä¸å‡ºçœŸå‡æ•°æ®ï¼Œå¯¹äºç»™å®šæ•°æ®çš„é¢„æµ‹ä¸ºçœŸçš„æ¦‚ç‡åŸºæœ¬æ¥è¿‘0.5ï¼ˆç›¸å½“äºéšæœºçŒœæµ‹ç±»åˆ«ï¼‰ã€‚ GANè®¾è®¡çš„å…³é”®åœ¨äºæŸå¤±å‡½æ•°çš„å¤„ç†ï¼š å¯¹äºåˆ¤åˆ«æ¨¡å‹ï¼ŒæŸå¤±å‡½æ•°æ˜¯å®¹æ˜“å®šä¹‰çš„ï¼Œåˆ¤æ–­ä¸€å¼ å›¾ç‰‡æ˜¯çœŸå®çš„è¿˜æ˜¯ç”Ÿæˆçš„ï¼Œæ˜¾ç„¶æ˜¯ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ã€‚ å¯¹äºç”Ÿæˆæ¨¡å‹ï¼ŒæŸå¤±å‡½æ•°çš„å®šä¹‰å°±ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ï¼Œæˆ‘ä»¬å¸Œæœ›ç”Ÿæˆå™¨å¯ä»¥ç”Ÿæˆæ¥è¿‘äºçœŸå®çš„å›¾ç‰‡ï¼Œå¯¹äºç”Ÿæˆçš„å›¾ç‰‡æ˜¯å¦åƒçœŸå®çš„ï¼Œæˆ‘ä»¬äººç±»è‚‰çœ¼å®¹æ˜“åˆ¤æ–­ï¼Œä½†å…·ä½“åˆ°ä»£ç ä¸­ï¼Œæ˜¯ä¸€ä¸ªæŠ½è±¡çš„ï¼Œéš¾ä»¥æ•°å­¦å…¬é‡ŒåŒ–å®šä¹‰çš„èŒƒå¼ã€‚ é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸å¦¨æŠŠç”Ÿæˆæ¨¡å‹çš„è¾“å‡ºï¼Œäº¤ç»™åˆ¤åˆ«æ¨¡å‹å¤„ç†ï¼Œè®©åˆ¤åˆ«å™¨åˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªçœŸå®çš„å›¾åƒè¿˜æ˜¯å‡çš„å›¾åƒï¼Œå› ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹å¾ˆé€‚åˆåšåˆ†ç±»ï¼Œè¿™æ ·å°±å°†ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨ç´§å¯†åœ°è”åˆåœ¨äº†ä¸€èµ·ã€‚ tips å‡å¦‚æˆ‘ä»¬ç›´æ¥ç”¨ç”Ÿæˆå™¨è®­ç»ƒï¼Œå®ƒçš„è®­ç»ƒç»“æœå¹¶ä¸ä¼šå¾—åˆ°ä¸€ä¸ªçœŸå®çš„å›¾åƒï¼Œè€Œä¼šå¾—åˆ°ä¸€ä¸ªæ¯”è¾ƒæ¨¡ç³Šçš„å›¾åƒï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•æ„å»ºä¸€ä¸ªåˆé€‚çš„æŸå¤±å»åˆ¤æ–­å®ƒæ˜¯å¦åƒçœŸå®å›¾ç‰‡ï¼Œæ‰€ä»¥å®ƒä¼šå°†æ‰€æœ‰è®­ç»ƒæ ·æœ¬åšå¹³å‡ï¼Œäº§ç”Ÿä¸€ä¸ªæ¯”è¾ƒç³Šçš„å›¾ç‰‡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦å°†ç”Ÿæˆå™¨çš„æ ·æœ¬äº¤ç»™åˆ¤åˆ«å™¨æ¥æ„å»ºæŸå¤±ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:11:1","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"11.2ã€GANç®—æ³•æµç¨‹æ€»ç»“ $G$ æ˜¯ä¸€ä¸ªç”Ÿæˆå›¾ç‰‡çš„ç½‘ç»œï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªéšæœºçš„å™ªå£°zï¼Œé€šè¿‡è¿™ä¸ªå™ªå£°ç”Ÿæˆå›¾ç‰‡$G(z)$ï¼Œè®°ä½œï¼› $D$ æ˜¯ä¸€ä¸ªåˆ¤åˆ«ç½‘ç»œï¼Œåˆ¤åˆ«ä¸€å¼ å›¾ç‰‡æ˜¯ä¸æ˜¯â€œçœŸå®çš„â€ï¼Œå®ƒçš„è¾“å…¥å‚æ•°æ˜¯xï¼Œxä»£è¡¨ä¸€å¼ å›¾ç‰‡ï¼Œè¾“å‡º$D(x)$ï¼Œä»£è¡¨xä¸ºçœŸå®å›¾ç‰‡çš„æ¦‚ç‡ï¼Œå¦‚æœä¸º1ï¼Œå°±ä»£è¡¨100%æ˜¯çœŸå®çš„å›¾ç‰‡ï¼Œè¾“å‡ºä¸º0ï¼Œå°±ä»£è¡¨ä¸æ˜¯çœŸå®å›¾ç‰‡ã€‚ åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå°†éšæœºå™ªå£°è¾“å…¥ç”Ÿæˆç½‘ç»œGï¼Œå¾—åˆ°ç”Ÿæˆçš„å›¾ç‰‡ï¼›åˆ¤åˆ«å™¨æ¥å—ç”Ÿæˆçš„å›¾ç‰‡å’ŒçœŸå®çš„å›¾ç‰‡ï¼Œå¹¶å°½é‡å°†ä¸¤è€…åŒºåˆ†å¼€æ¥ã€‚åœ¨è¿™ä¸ªè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œèƒ½å¦æ­£ç¡®åŒºåˆ†ç”Ÿæˆçš„å›¾ç‰‡å’ŒçœŸå®çš„å›¾ç‰‡å°†ä½œä¸ºåˆ¤åˆ«å™¨çš„æŸå¤±ï¼›è€Œèƒ½å¦ç”Ÿæˆè¿‘ä¼¼çœŸå®çš„å›¾ç‰‡ã€å¹¶ä½¿å¾—åˆ¤åˆ«å™¨å°†ç”Ÿæˆçš„å›¾ç‰‡åˆ¤å®šä¸ºçœŸï¼Œå°†ä½œä¸ºç”Ÿæˆå™¨çš„æŸå¤±ã€‚ ç”Ÿæˆå™¨çš„æŸå¤±æ˜¯é€šè¿‡åˆ¤åˆ«å™¨çš„è¾“å‡ºæ¥è®¡ç®—çš„ï¼Œè€Œåˆ¤åˆ«å™¨çš„è¾“å‡ºæ˜¯ä¸€ä¸ªæ¦‚ç‡å€¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡äº¤å‰ç†µæ¥è®¡ç®—ã€‚ ","date":"2023-07-26","objectID":"/posts/gan_1/:11:2","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"åäºŒã€torchå¤ç° https://wangguisen.blog.csdn.net/article/details/127820071 ref: [1]. https://arxiv.org/abs/1406.2661 [2]. https://www.bilibili.com/video/BV1eE411g7xc [3]. https://www.bilibili.com/video/BV1rb4y187vD [4]. https://www.bilibili.com/video/BV1HD4y1S7Pe ","date":"2023-07-26","objectID":"/posts/gan_1/:12:0","tags":["GAN"],"title":"ç”Ÿæˆå¯¹æŠ—ç½‘ç»œGAN","uri":"/posts/gan_1/"},{"categories":["ML"],"content":"Transformer è¯¦è§£ Transformer æ˜¯è°·æ­Œå¤§è„‘åœ¨ 2017 å¹´åº•å‘è¡¨çš„è®ºæ–‡ attention is all you need ä¸­æ‰€æå‡ºçš„ seq2seq æ¨¡å‹ã€‚ç°åœ¨å·²ç»å–å¾—äº†å¤§èŒƒå›´çš„åº”ç”¨å’Œæ‰©å±•ï¼Œè€Œ BERT å°±æ˜¯ä» Transformer ä¸­è¡ç”Ÿå‡ºæ¥çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ è¿™ç¯‡æ–‡ç« åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ† Transformer ç›´è§‚è®¤è¯† Positional Encoding Self Attention Mechanism æ®‹å·®è¿æ¥å’Œ Layer Normalization Transformer Encoder æ•´ä½“ç»“æ„ Transformer Decoder æ•´ä½“ç»“æ„ æ€»ç»“ å‚è€ƒæ–‡ç«  ","date":"2023-07-24","objectID":"/posts/transformerdetailedexplanation/:1:0","tags":["Transformer"],"title":"Transformer è¯¦è§£","uri":"/posts/transformerdetailedexplanation/"},{"categories":["ML"],"content":"0. Transformer ç›´è§‚è®¤è¯† Transformer å’Œ LSTM çš„æœ€å¤§åŒºåˆ«ï¼Œå°±æ˜¯ LSTM çš„è®­ç»ƒæ˜¯è¿­ä»£çš„ã€ä¸²è¡Œçš„ï¼Œå¿…é¡»è¦ç­‰å½“å‰å­—å¤„ç†å®Œï¼Œæ‰å¯ä»¥å¤„ç†ä¸‹ä¸€ä¸ªå­—ã€‚è€Œ Transformer çš„è®­ç»ƒæ—¶å¹¶è¡Œçš„ï¼Œå³æ‰€æœ‰å­—æ˜¯åŒæ—¶è®­ç»ƒçš„ï¼Œè¿™æ ·å°±å¤§å¤§å¢åŠ äº†è®¡ç®—æ•ˆç‡ã€‚Transformer ä½¿ç”¨äº†ä½ç½®åµŒå…¥ (Positional Encoding) æ¥ç†è§£è¯­è¨€çš„é¡ºåºï¼Œä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶(Self Attention Mechanism)å’Œå…¨è¿æ¥å±‚è¿›è¡Œè®¡ç®—ï¼Œè¿™äº›åé¢ä¼šè®²åˆ°ã€‚ Transformer æ¨¡å‹ä¸»è¦åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ Encoder å’Œ Decoderã€‚Encoder è´Ÿè´£æŠŠè¾“å…¥(è¯­è¨€åºåˆ—)æ˜ å°„æˆéšè—å±‚(ä¸‹å›¾ä¸­ç¬¬ 2 æ­¥ç”¨ä¹å®«æ ¼ä»£è¡¨çš„éƒ¨åˆ†)ï¼Œç„¶åè§£ç å™¨å†æŠŠéšè—å±‚æ˜ å°„ä¸ºè‡ªç„¶è¯­è¨€åºåˆ—ã€‚ä¾‹å¦‚ä¸‹å›¾æœºå™¨ç¿»è¯‘çš„ä¾‹å­(Decoder è¾“å‡ºçš„æ—¶å€™ï¼Œæ˜¯é€šè¿‡ N å±‚ Decoder Layer æ‰è¾“å‡ºä¸€ä¸ª tokenï¼Œå¹¶ä¸æ˜¯é€šè¿‡ä¸€å±‚ Decoder Layer å°±è¾“å‡ºä¸€ä¸ª token)ã€‚ æœ¬ç¯‡æ–‡ç« å¤§éƒ¨åˆ†å†…å®¹åœ¨äºè§£é‡Š Encoder éƒ¨åˆ†ï¼Œå³ **æŠŠè‡ªç„¶è¯­è¨€åºåˆ—æ˜ å°„ä¸ºéšè—å±‚çš„æ•°å­¦è¡¨è¾¾**çš„è¿‡ç¨‹ã€‚ç†è§£äº† Encoder çš„ç»“æ„ï¼Œå†ç†è§£ Decoder å°±å¾ˆç®€å•äº† ä¸Šå›¾ä¸º Transformer Encoder Block ç»“æ„å›¾ï¼Œæ³¨æ„ï¼šä¸‹é¢çš„å†…å®¹æ ‡é¢˜ç¼–å·åˆ†åˆ«å¯¹åº”ç€å›¾ä¸­ 1,2,3,4 ä¸ªæ–¹æ¡†çš„åºå· ","date":"2023-07-24","objectID":"/posts/transformerdetailedexplanation/:1:1","tags":["Transformer"],"title":"Transformer è¯¦è§£","uri":"/posts/transformerdetailedexplanation/"},{"categories":["ML"],"content":"1. Positional Encoding ç”±äº Transformer æ¨¡å‹æ²¡æœ‰å¾ªç¯ç¥ç»ç½‘ç»œçš„è¿­ä»£æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æä¾›æ¯ä¸ªå­—çš„ä½ç½®ä¿¡æ¯ç»™ Transformerï¼Œè¿™æ ·å®ƒæ‰èƒ½è¯†åˆ«å‡ºè¯­è¨€ä¸­çš„é¡ºåºå…³ç³»ã€‚ ç°åœ¨å®šä¹‰ä¸€ä¸ª ä½ç½®åµŒå…¥ çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯ Positional Encodingï¼Œä½ç½®åµŒå…¥çš„ç»´åº¦ä¸º [max_sequence_length, embedding_dimension], ä½ç½®åµŒå…¥çš„ç»´åº¦ä¸è¯å‘é‡çš„ç»´åº¦æ˜¯ç›¸åŒçš„ï¼Œéƒ½æ˜¯ embedding_dimensionã€‚max_sequence_length å±äºè¶…å‚æ•°ï¼ŒæŒ‡çš„æ˜¯é™å®šæ¯ä¸ªå¥å­æœ€é•¿ç”±å¤šå°‘ä¸ªè¯æ„æˆã€‚ æ³¨æ„ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä»¥å­—ä¸ºå•ä½è®­ç»ƒ Transformer æ¨¡å‹ã€‚é¦–å…ˆåˆå§‹åŒ–å­—ç¼–ç çš„å¤§å°ä¸º [vocab_size, embedding_dimension]ï¼Œvocab_size ä¸ºå­—åº“ä¸­æ‰€æœ‰å­—çš„æ•°é‡ï¼Œembedding_dimension ä¸ºå­—å‘é‡çš„ç»´åº¦ï¼Œå¯¹åº”åˆ° PyTorch ä¸­ï¼Œå…¶å®å°±æ˜¯ nn.Embedding(vocab_size, embedding_dimension) åœ¨è®ºæ–‡ä¸­ä½¿ç”¨äº† sin å’Œ cos å‡½æ•°çš„çº¿æ€§å˜æ¢æ¥æä¾›ç»™æ¨¡å‹ä½ç½®ä¿¡æ¯: $$\\left\\{\\begin{aligned} PE(pos, 2i) = \\sin (pos/10000^{2i/d_{model}}) \\cr PE(pos, 2i + 1) = \\cos (pos/10000^{2i/d_{model}}) \\cr \\end{aligned}\\right.$$ ä¸Šå¼ä¸­ $pos$ æŒ‡çš„æ˜¯ä¸€å¥è¯ä¸­æŸä¸ªå­—çš„ä½ç½®ï¼Œå–å€¼èŒƒå›´æ˜¯ $[0, \\text{max_sequence_length}]$ ï¼Œ $i$ æŒ‡çš„æ˜¯å­—å‘é‡çš„ç»´åº¦åºå·ï¼Œå–å€¼èŒƒå›´æ˜¯ $[0, \\text{embedding_dimension} / 2]$ ï¼Œ $d_{model}$ æŒ‡çš„æ˜¯ embedding_dimensionâ€‹çš„å€¼ ä¸Šé¢æœ‰ sin å’Œ cos ä¸€ç»„å…¬å¼ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”ç€ embedding_dimension ç»´åº¦çš„ä¸€ç»„å¥‡æ•°å’Œå¶æ•°çš„åºå·çš„ç»´åº¦ï¼Œä¾‹å¦‚ 0,1 ä¸€ç»„ï¼Œ2,3 ä¸€ç»„ï¼Œåˆ†åˆ«ç”¨ä¸Šé¢çš„ sin å’Œ cos å‡½æ•°åšå¤„ç†ï¼Œä»è€Œäº§ç”Ÿä¸åŒçš„å‘¨æœŸæ€§å˜åŒ–ï¼Œè€Œä½ç½®åµŒå…¥åœ¨ embedding_dimensionâ€‹ç»´åº¦ä¸Šéšç€ç»´åº¦åºå·å¢å¤§ï¼Œå‘¨æœŸå˜åŒ–ä¼šè¶Šæ¥è¶Šæ…¢ï¼Œæœ€ç»ˆäº§ç”Ÿä¸€ç§åŒ…å«ä½ç½®ä¿¡æ¯çš„çº¹ç†ï¼Œå°±åƒè®ºæ–‡åŸæ–‡ä¸­ç¬¬å…­é¡µè®²çš„ï¼Œä½ç½®åµŒå…¥å‡½æ•°çš„å‘¨æœŸä» $ 2\\pi $ åˆ° $10000 * 2 \\pi$ å˜åŒ–ï¼Œè€Œæ¯ä¸€ä¸ªä½ç½®åœ¨ embedding_dimension â€‹ç»´åº¦ä¸Šéƒ½ä¼šå¾—åˆ°ä¸åŒå‘¨æœŸçš„ $ \\sin $ å’Œ $ \\cos $ å‡½æ•°çš„å–å€¼ç»„åˆï¼Œä»è€Œäº§ç”Ÿå”¯ä¸€çš„çº¹ç†ä½ç½®ä¿¡æ¯ï¼Œæœ€ç»ˆä½¿å¾—æ¨¡å‹å­¦åˆ°ä½ç½®ä¹‹é—´çš„ä¾èµ–å…³ç³»å’Œè‡ªç„¶è¯­è¨€çš„æ—¶åºç‰¹æ€§ã€‚ å¦‚æœä¸ç†è§£è¿™é‡Œä¸ºä½•è¿™ä¹ˆè®¾è®¡ï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç«  Transformer ä¸­çš„ Positional Encoding ä¸‹é¢ç”»ä¸€ä¸‹ä½ç½®åµŒå…¥ï¼Œçºµå‘è§‚å¯Ÿï¼Œå¯è§éšç€ embedding_dimensionâ€‹åºå·å¢å¤§ï¼Œä½ç½®åµŒå…¥å‡½æ•°çš„å‘¨æœŸå˜åŒ–è¶Šæ¥è¶Šå¹³ç¼“ import numpy as np import matplotlib.pyplot as plt import seaborn as sns import math def get_positional_encoding(max_seq_len, embed_dim): # åˆå§‹åŒ–ä¸€ä¸ªpositional encoding # embed_dim: å­—åµŒå…¥çš„ç»´åº¦ # max_seq_len: æœ€å¤§çš„åºåˆ—é•¿åº¦ positional_encoding = np.array([ [pos / np.power(10000, 2 * i / embed_dim) for i in range(embed_dim)] if pos != 0 else np.zeros(embed_dim) for pos in range(max_seq_len)]) positional_encoding[1:, 0::2] = np.sin(positional_encoding[1:, 0::2]) # dim 2i å¶æ•° positional_encoding[1:, 1::2] = np.cos(positional_encoding[1:, 1::2]) # dim 2i+1 å¥‡æ•° return positional_encoding positional_encoding = get_positional_encoding(max_seq_len=100, embed_dim=16) plt.figure(figsize=(10,10)) sns.heatmap(positional_encoding) plt.title(\"Sinusoidal Function\") plt.xlabel(\"hidden dimension\") plt.ylabel(\"sequence length\") plt.figure(figsize=(8, 5)) plt.plot(positional_encoding[1:, 1], label=\"dimension 1\") plt.plot(positional_encoding[1:, 2], label=\"dimension 2\") plt.plot(positional_encoding[1:, 3], label=\"dimension 3\") plt.legend() plt.xlabel(\"Sequence length\") plt.ylabel(\"Period of Positional Encoding\") ","date":"2023-07-24","objectID":"/posts/transformerdetailedexplanation/:1:2","tags":["Transformer"],"title":"Transformer è¯¦è§£","uri":"/posts/transformerdetailedexplanation/"},{"categories":["ML"],"content":"2. Self Attention Mechanism å¯¹äºè¾“å…¥çš„å¥å­ $ X $ï¼Œé€šè¿‡ WordEmbedding å¾—åˆ°è¯¥å¥å­ä¸­æ¯ä¸ªå­—çš„å­—å‘é‡ï¼ŒåŒæ—¶é€šè¿‡ Positional Encoding å¾—åˆ°æ‰€æœ‰å­—çš„ä½ç½®å‘é‡ï¼Œå°†å…¶ç›¸åŠ (ç»´åº¦ç›¸åŒï¼Œå¯ä»¥ç›´æ¥ç›¸åŠ )ï¼Œå¾—åˆ°è¯¥å­—çœŸæ­£çš„å‘é‡è¡¨ç¤ºã€‚ç¬¬ $ t $ ä¸ªå­—çš„å‘é‡è®°ä½œ $ x_t $ã€‚ æ¥ç€æˆ‘ä»¬å®šä¹‰ä¸‰ä¸ªçŸ©é˜µ $ W_Q $, $ W_K $, $ W_V $ï¼Œä½¿ç”¨è¿™ä¸‰ä¸ªçŸ©é˜µåˆ†åˆ«å¯¹æ‰€æœ‰çš„å­—å‘é‡è¿›è¡Œä¸‰æ¬¡çº¿æ€§å˜æ¢ï¼Œäºæ˜¯æ‰€æœ‰çš„å­—å‘é‡åˆè¡ç”Ÿå‡ºä¸‰ä¸ªæ–°çš„å‘é‡ $ q_t $, $ k_t $, $ v_t $ã€‚æˆ‘ä»¬å°†æ‰€æœ‰çš„ $ q_t $ å‘é‡æ‹¼æˆä¸€ä¸ªå¤§çŸ©é˜µï¼Œè®°ä½œæŸ¥è¯¢çŸ©é˜µ $ Q $ ï¼Œå°†æ‰€æœ‰çš„ $ k_t $ å‘é‡æ‹¼æˆä¸€ä¸ªå¤§çŸ©é˜µï¼Œè®°ä½œé”®çŸ©é˜µ $ K $ ï¼Œå°†æ‰€æœ‰çš„ $ v_t $ å‘é‡æ‹¼æˆä¸€ä¸ªå¤§çŸ©é˜µï¼Œè®°ä½œå€¼çŸ©é˜µ $ V $ (è§ä¸‹å›¾) ä¸ºäº†è·å¾—ç¬¬ä¸€ä¸ªå­—çš„æ³¨æ„åŠ›æƒé‡ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ç¬¬ä¸€ä¸ªå­—çš„æŸ¥è¯¢å‘é‡ $ q_1 $ ä¹˜ä»¥é”®çŸ©é˜µ $ K $(è§ä¸‹å›¾) [0, 4, 2] [1, 0, 2] x [1, 4, 3] = [2, 4, 4] [1, 0, 1] ä¹‹åè¿˜éœ€è¦å°†å¾—åˆ°çš„å€¼ç»è¿‡ softmaxï¼Œä½¿å¾—å®ƒä»¬çš„å’Œä¸º 1(è§ä¸‹å›¾) softmax([2, 4, 4]) = [0.0, 0.5, 0.5] æœ‰äº†æƒé‡ä¹‹åï¼Œå°†æƒé‡å…¶åˆ†åˆ«ä¹˜ä»¥å¯¹åº”å­—çš„å€¼å‘é‡ $ v_t $(è§ä¸‹å›¾) 0.0 * [1, 2, 3] = [0.0, 0.0, 0.0] 0.5 * [2, 8, 0] = [1.0, 4.0, 0.0] 0.5 * [2, 6, 3] = [1.0, 3.0, 1.5] æœ€åå°†è¿™äº›æƒé‡åŒ–åçš„å€¼å‘é‡æ±‚å’Œï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªå­—çš„è¾“å‡º(è§ä¸‹å›¾) [0.0, 0.0, 0.0] + [1.0, 4.0, 0.0] + [1.0, 3.0, 1.5] ----------------- = [2.0, 7.0, 1.5] å¯¹å…¶å®ƒçš„è¾“å…¥å‘é‡ä¹Ÿæ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œå³å¯å¾—åˆ°é€šè¿‡ self-attention åçš„æ‰€æœ‰è¾“å‡º çŸ©é˜µè®¡ç®— ä¸Šé¢ä»‹ç»çš„æ–¹æ³•éœ€è¦ä¸€ä¸ªå¾ªç¯éå†æ‰€æœ‰çš„å­—$ x_t $ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢çš„å‘é‡è®¡ç®—å˜æˆçŸ©é˜µçš„å½¢å¼ï¼Œä»è€Œä¸€æ¬¡è®¡ç®—å‡ºæ‰€æœ‰æ—¶åˆ»çš„è¾“å‡º ç¬¬ä¸€æ­¥å°±ä¸æ˜¯è®¡ç®—æŸä¸ªæ—¶åˆ»çš„$ q_t $, $ k_t $, $ v_t $äº†ï¼Œè€Œæ˜¯ä¸€æ¬¡è®¡ç®—æ‰€æœ‰æ—¶åˆ»çš„ $ Q $, $ K $, $ V $ã€‚è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™é‡Œçš„è¾“å…¥æ˜¯ä¸€ä¸ªçŸ©é˜µ $ X $ï¼ŒçŸ©é˜µç¬¬ $ t $ è¡Œä¸ºç¬¬ $ t $ ä¸ªè¯çš„å‘é‡è¡¨ç¤º $x_t$ æ¥ä¸‹æ¥å°† $ Q $ å’Œ $K_T$ ç›¸ä¹˜ï¼Œç„¶åé™¤ä»¥ $ \\sqrt{d_k} $(è¿™æ˜¯è®ºæ–‡ä¸­æåˆ°çš„ä¸€ä¸ª trick)ï¼Œç»è¿‡ softmax ä»¥åå†ä¹˜ä»¥ $ V $ å¾—åˆ°è¾“å‡º Multi-Head Attention è¿™ç¯‡è®ºæ–‡è¿˜æå‡ºäº† Multi-Head Attention çš„æ¦‚å¿µã€‚å…¶å®å¾ˆç®€å•ï¼Œå‰é¢å®šä¹‰çš„ä¸€ç»„ $Q $, $ K $, $ V $, å¯ä»¥è®©ä¸€ä¸ªè¯ attend to ç›¸å…³çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¤šç»„ $Q $, $ K $, $ V $ï¼Œè®©å®ƒä»¬åˆ†åˆ«å…³æ³¨ä¸åŒçš„ä¸Šä¸‹æ–‡ã€‚è®¡ç®— $Q $, $ K $, $ V $ çš„è¿‡ç¨‹è¿˜æ˜¯ä¸€æ ·ï¼Œåªä¸è¿‡çº¿æ€§å˜æ¢çš„çŸ©é˜µä»ä¸€ç»„ $ W^Q $, $ W^K $, $ W^V $ å˜æˆäº†å¤šç»„$ W^Q_0 $, $ W^K_0 $, $ W^V_0 $ ï¼Œ$ W^Q_1 $, $ W^K_1 $, $ W^V_1 $ ï¼Œâ€¦ å¦‚ä¸‹å›¾æ‰€ç¤º: å¯¹äºè¾“å…¥çŸ©é˜µ $ X $ ï¼Œæ¯ä¸€ç»„ $ Q $ ã€$ K $ å’Œ $ V $ éƒ½å¯ä»¥å¾—åˆ°ä¸€ä¸ªè¾“å‡ºçŸ©é˜µ $ Z $ ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º Padding Mask ä¸Šé¢ Self Attention çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ mini-batch æ¥è®¡ç®—ï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡è®¡ç®—å¤šå¥è¯ï¼Œå³ $ X $ çš„ç»´åº¦æ˜¯ [batch_size, sequence_length]ï¼Œsequence_lengthâ€‹æ˜¯å¥é•¿ï¼Œè€Œä¸€ä¸ª mini-batch æ˜¯ç”±å¤šä¸ªä¸ç­‰é•¿çš„å¥å­ç»„æˆçš„ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§è¿™ä¸ª mini-batch ä¸­æœ€å¤§çš„å¥é•¿å¯¹å‰©ä½™çš„å¥å­è¿›è¡Œè¡¥é½ï¼Œä¸€èˆ¬ç”¨ 0 è¿›è¡Œå¡«å……ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åš padding ä½†è¿™æ—¶åœ¨è¿›è¡Œ softmax å°±ä¼šäº§ç”Ÿé—®é¢˜ã€‚å›é¡¾ softmax å‡½æ•° $\\sigma(z_i) = \\frac{e^{z_i}}{\\sum_K^{j=i} e^{z_j}}$ï¼Œ$e^0$ æ˜¯ 1ï¼Œæ˜¯æœ‰å€¼çš„ï¼Œè¿™æ ·çš„è¯ softmax ä¸­è¢« padding çš„éƒ¨åˆ†å°±å‚ä¸äº†è¿ç®—ï¼Œç›¸å½“äºè®©æ— æ•ˆçš„éƒ¨åˆ†å‚ä¸äº†è¿ç®—ï¼Œè¿™å¯èƒ½ä¼šäº§ç”Ÿå¾ˆå¤§çš„éšæ‚£ã€‚å› æ­¤éœ€è¦åšä¸€ä¸ª mask æ“ä½œï¼Œè®©è¿™äº›æ— æ•ˆçš„åŒºåŸŸä¸å‚ä¸è¿ç®—ï¼Œä¸€èˆ¬æ˜¯ç»™æ— æ•ˆåŒºåŸŸåŠ ä¸€ä¸ªå¾ˆå¤§çš„è´Ÿæ•°åç½®ï¼Œå³ $$ \\begin{aligned}Z_{illegal}\u0026=Z_{illegal}+bias_{illegal}\\cr bias_{illegal}\u0026\\to-\\infty\\end{aligned} $$ ","date":"2023-07-24","objectID":"/posts/transformerdetailedexplanation/:1:3","tags":["Transformer"],"title":"Transformer è¯¦è§£","uri":"/posts/transformerdetailedexplanation/"},{"categories":["ML"],"content":"3. æ®‹å·®è¿æ¥å’Œ Layer Normalization æ®‹å·®è¿æ¥ æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥å¾—åˆ°äº†ç»è¿‡ self-attention åŠ æƒä¹‹åè¾“å‡ºï¼Œä¹Ÿå°±æ˜¯$\\text{Self-Attention(Q, K, V)}$ï¼Œç„¶åæŠŠä»–ä»¬åŠ èµ·æ¥åšæ®‹å·®è¿æ¥ $$X_{\\text{embedding}} + \\text{Self-Attention(Q, K, V)}$$ Layer Normalization Layer Normalization çš„ä½œç”¨æ˜¯æŠŠç¥ç»ç½‘ç»œä¸­éšè—å±‚å½’ä¸€ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯ $i.i.d$ ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œä»¥èµ·åˆ°åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼ŒåŠ é€Ÿæ”¶æ•›çš„ä½œç”¨ $$\\mu_j=\\frac1m\\sum_{i=1}^mx_{ij}$$ ä¸Šå¼ä»¥çŸ©é˜µçš„åˆ—(column)ä¸ºå•ä½æ±‚å‡å€¼ï¼› $$\\sigma^2_{j} = \\frac{1}{m}\\sum^m_{i=1}(x_{ij} - \\mu_j)^2$$ ä¸Šå¼ä»¥çŸ©é˜µçš„åˆ—(column)ä¸ºå•ä½æ±‚æ–¹å·® $$LayerNorm(x) = \\frac{x_{ij} - \\mu_{j}}{\\sqrt{\\sigma^2 + \\epsilon}}$$ ç„¶åç”¨æ¯ä¸€åˆ—çš„æ¯ä¸€ä¸ªå…ƒç´ å‡å»è¿™åˆ—çš„å‡å€¼ï¼Œå†é™¤ä»¥è¿™åˆ—çš„æ ‡å‡†å·®ï¼Œä»è€Œå¾—åˆ°å½’ä¸€åŒ–åçš„æ•°å€¼ï¼ŒåŠ  $\\epsilon$ æ˜¯ä¸ºäº†é˜²æ­¢åˆ†æ¯ä¸º 0ã€‚ ä¸‹å›¾å±•ç¤ºäº†æ›´å¤šç»†èŠ‚ï¼šè¾“å…¥ $x_1, x_2$ ç» self-attention å±‚ä¹‹åå˜æˆ $z_1, z_2$ï¼Œç„¶åå’Œè¾“å…¥ $x_1, x_2$ è¿›è¡Œæ®‹å·®è¿æ¥ï¼Œç»è¿‡ LayerNorm åè¾“å‡ºç»™å…¨è¿æ¥å±‚ã€‚å…¨è¿æ¥å±‚ä¹Ÿæœ‰ä¸€ä¸ªæ®‹å·®è¿æ¥å’Œä¸€ä¸ª LayerNormï¼Œæœ€åå†è¾“å‡ºç»™ä¸‹ä¸€ä¸ª Encoder(æ¯ä¸ª Encoder Block ä¸­çš„ FeedForward å±‚æƒé‡éƒ½æ˜¯å…±äº«çš„) ","date":"2023-07-24","objectID":"/posts/transformerdetailedexplanation/:1:4","tags":["Transformer"],"title":"Transformer è¯¦è§£","uri":"/posts/transformerdetailedexplanation/"},{"categories":["ML"],"content":"4. Transformer Encoder æ•´ä½“ç»“æ„ ç»è¿‡ä¸Šé¢ 3 ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬å·²ç»åŸºæœ¬äº†è§£äº† Encoder çš„ä¸»è¦æ„æˆéƒ¨åˆ†ï¼Œä¸‹é¢æˆ‘ä»¬ç”¨å…¬å¼æŠŠä¸€ä¸ª Encoder block çš„è®¡ç®—è¿‡ç¨‹æ•´ç†ä¸€ä¸‹ï¼š (1). å­—å‘é‡ä¸ä½ç½®ç¼–ç  $$X = \\text{Embedding-Lookup(X)} + \\text{Positional-Encoding}$$ (2). è‡ªæ³¨æ„åŠ›æœºåˆ¶ $$Q = Linear_{q}(X) = XW_{Q}$$ $$K = Linear_{k}(X) = XW_{K}$$ $$V = Linear_{v}(X) = XW_{V}$$ $$X_{attention} = \\text{Self-Attention(Q, K, V)}$$ (3). self-attention æ®‹å·®è¿æ¥ä¸ Layer Normalization $$X_{attention} = X + X_{attention}$$ $$X_{attention} = LayerNorm(attention)$$ (4). ä¸‹é¢è¿›è¡Œ Encoder block ç»“æ„å›¾ä¸­çš„ç¬¬ 4 éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯ FeedForwardï¼Œå…¶å®å°±æ˜¯ä¸¤å±‚çº¿æ€§æ˜ å°„å¹¶ç”¨æ¿€æ´»å‡½æ•°æ¿€æ´»ï¼Œæ¯”å¦‚è¯´ $ReLU$ $$X_{hidden} = Linear(ReLU(Linear(X_{attention})))$$ (5). FeedForward æ®‹å·®è¿æ¥ä¸ Layer Normalization $$X_{hidden} = X_{attention} + X_{hidden}$$ $$X_{hidden} = LayerNorm(X_{hidden})$$ å…¶ä¸­ $$X_{hidden} \\in \\mathbb{R}^{batch_size * seq_len * embed_dim}$$ ","date":"2023-07-24","objectID":"/posts/transformerdetailedexplanation/:1:5","tags":["Transformer"],"title":"Transformer è¯¦è§£","uri":"/posts/transformerdetailedexplanation/"},{"categories":["ML"],"content":"5. Transformer Decoder æ•´ä½“ç»“æ„ æˆ‘ä»¬å…ˆä» HighLevel çš„è§’åº¦è§‚å¯Ÿä¸€ä¸‹ Decoder ç»“æ„ï¼Œä»ä¸‹åˆ°ä¸Šä¾æ¬¡æ˜¯ï¼š Masked Multi-Head Self-Attention Multi-Head Encoder-Decoder Attention FeedForward Network å’Œ Encoder ä¸€æ ·ï¼Œä¸Šé¢ä¸‰ä¸ªéƒ¨åˆ†çš„æ¯ä¸€ä¸ªéƒ¨åˆ†ï¼Œéƒ½æœ‰ä¸€ä¸ªæ®‹å·®è¿æ¥ï¼Œåæ¥ä¸€ä¸ª Layer Normalizationã€‚Decoder çš„ä¸­é—´éƒ¨ä»¶å¹¶ä¸å¤æ‚ï¼Œå¤§éƒ¨åˆ†åœ¨å‰é¢ Encoder é‡Œæˆ‘ä»¬å·²ç»ä»‹ç»è¿‡äº†ï¼Œä½†æ˜¯ Decoder ç”±äºå…¶ç‰¹æ®Šçš„åŠŸèƒ½ï¼Œå› æ­¤åœ¨è®­ç»ƒæ—¶ä¼šæ¶‰åŠåˆ°ä¸€äº›ç»†èŠ‚ Masked Self-Attention å…·ä½“æ¥è¯´ï¼Œä¼ ç»Ÿ Seq2Seq ä¸­ Decoder ä½¿ç”¨çš„æ˜¯ RNN æ¨¡å‹ï¼Œå› æ­¤åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¾“å…¥ $t$ æ—¶åˆ»çš„è¯ï¼Œæ¨¡å‹æ— è®ºå¦‚ä½•ä¹Ÿçœ‹ä¸åˆ°æœªæ¥æ—¶åˆ»çš„è¯ï¼Œå› ä¸ºå¾ªç¯ç¥ç»ç½‘ç»œæ˜¯æ—¶é—´é©±åŠ¨çš„ï¼Œåªæœ‰å½“ $t$ æ—¶åˆ»è¿ç®—ç»“æŸäº†ï¼Œæ‰èƒ½çœ‹åˆ° $t + 1$ æ—¶åˆ»çš„è¯ã€‚è€Œ Transformer Decoder æŠ›å¼ƒäº† RNNï¼Œæ”¹ä¸º Self-Attentionï¼Œç”±æ­¤å°±äº§ç”Ÿäº†ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ•´ä¸ª ground truth éƒ½æš´éœ²åœ¨ Decoder ä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯¹çš„ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ Decoder çš„è¾“å…¥è¿›è¡Œä¸€äº›å¤„ç†ï¼Œè¯¥å¤„ç†è¢«ç§°ä¸º Mask ä¸¾ä¸ªä¾‹å­ï¼ŒDecoder çš„ ground truth ä¸º â€œ I am fineâ€ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªå¥å­è¾“å…¥åˆ° Decoder ä¸­ï¼Œç»è¿‡ WordEmbedding å’Œ Positional Encoding ä¹‹åï¼Œå°†å¾—åˆ°çš„çŸ©é˜µåšä¸‰æ¬¡çº¿æ€§å˜æ¢ $(W_Q, W_K, W_V)$ã€‚ç„¶åè¿›è¡Œ self-attention æ“ä½œï¼Œé¦–å…ˆé€šè¿‡å¾—åˆ° Scaled Scoresï¼Œæ¥ä¸‹æ¥éå¸¸å…³é”®ï¼Œæˆ‘ä»¬è¦å¯¹ Scaled Scores è¿›è¡Œ Maskï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå½“æˆ‘ä»¬è¾“å…¥ â€œIâ€ æ—¶ï¼Œæ¨¡å‹ç›®å‰ä»…çŸ¥é“åŒ…æ‹¬ â€œIâ€ åœ¨å†…ä¹‹å‰æ‰€æœ‰å­—çš„ä¿¡æ¯ï¼Œå³ â€œâ€ å’Œ â€œIâ€ çš„ä¿¡æ¯ï¼Œä¸åº”è¯¥è®©å…¶çŸ¥é“ â€œIâ€ ä¹‹åè¯çš„ä¿¡æ¯ã€‚é“ç†å¾ˆç®€å•ï¼Œæˆ‘ä»¬åšé¢„æµ‹çš„æ—¶å€™æ˜¯æŒ‰ç…§é¡ºåºä¸€ä¸ªå­—ä¸€ä¸ªå­—çš„é¢„æµ‹ï¼Œæ€ä¹ˆèƒ½è¿™ä¸ªå­—éƒ½æ²¡é¢„æµ‹å®Œï¼Œå°±å·²ç»çŸ¥é“åé¢å­—çš„ä¿¡æ¯äº†å‘¢ï¼ŸMask éå¸¸ç®€å•ï¼Œé¦–å…ˆç”Ÿæˆä¸€ä¸ªä¸‹ä¸‰è§’å…¨ 0ï¼Œä¸Šä¸‰è§’å…¨ä¸ºè´Ÿæ— ç©·çš„çŸ©é˜µï¼Œç„¶åå°†å…¶ä¸ Scaled Scores ç›¸åŠ å³å¯ ä¹‹åå†åš softmaxï¼Œå°±èƒ½å°† - inf å˜ä¸º 0ï¼Œå¾—åˆ°çš„è¿™ä¸ªçŸ©é˜µå³ä¸ºæ¯ä¸ªå­—ä¹‹é—´çš„æƒé‡ Multi-Head Self-Attention æ— éå°±æ˜¯å¹¶è¡Œçš„å¯¹ä¸Šè¿°æ­¥éª¤å¤šåšå‡ æ¬¡ï¼Œå‰é¢ Encoder ä¹Ÿä»‹ç»äº†ï¼Œè¿™é‡Œå°±ä¸å¤šèµ˜è¿°äº† Masked Encoder-Decoder Attention å…¶å®è¿™ä¸€éƒ¨åˆ†çš„è®¡ç®—æµç¨‹å’Œå‰é¢ Masked Self-Attention å¾ˆç›¸ä¼¼ï¼Œç»“æ„ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯è¿™é‡Œçš„ K, Vä¸º Encoder çš„è¾“å‡ºï¼ŒQ ä¸º Decoder ä¸­ Masked Self-Attention çš„è¾“å‡º ","date":"2023-07-24","objectID":"/posts/transformerdetailedexplanation/:1:6","tags":["Transformer"],"title":"Transformer è¯¦è§£","uri":"/posts/transformerdetailedexplanation/"},{"categories":["ML"],"content":"6. æ€»ç»“ åˆ°æ­¤ä¸ºæ­¢ï¼ŒTransformer ä¸­ 95% çš„å†…å®¹å·²ç»ä»‹ç»å®Œäº†ï¼Œæˆ‘ä»¬ç”¨ä¸€å¼ å›¾å±•ç¤ºå…¶å®Œæ•´ç»“æ„ã€‚ä¸å¾—ä¸è¯´ï¼ŒTransformer è®¾è®¡çš„ååˆ†å·§å¤ºå¤©å·¥ã€‚ ä¸‹é¢æœ‰å‡ ä¸ªé—®é¢˜ï¼Œæ˜¯æˆ‘ä»ç½‘ä¸Šæ‰¾çš„ï¼Œæ„Ÿè§‰çœ‹å®Œä¹‹åèƒ½å¯¹ Transformer æœ‰ä¸€ä¸ªæ›´æ·±çš„ç†è§£ Transformer ä¸ºä»€ä¹ˆéœ€è¦è¿›è¡Œ Multi-head Attentionï¼Ÿ åŸè®ºæ–‡ä¸­è¯´åˆ°è¿›è¡Œ Multi-head Attention çš„åŸå› æ˜¯å°†æ¨¡å‹åˆ†ä¸ºå¤šä¸ªå¤´ï¼Œå½¢æˆå¤šä¸ªå­ç©ºé—´ï¼Œå¯ä»¥è®©æ¨¡å‹å»å…³æ³¨ä¸åŒæ–¹é¢çš„ä¿¡æ¯ï¼Œæœ€åå†å°†å„ä¸ªæ–¹é¢çš„ä¿¡æ¯ç»¼åˆèµ·æ¥ã€‚å…¶å®ç›´è§‚ä¸Šä¹Ÿå¯ä»¥æƒ³åˆ°ï¼Œå¦‚æœè‡ªå·±è®¾è®¡è¿™æ ·çš„ä¸€ä¸ªæ¨¡å‹ï¼Œå¿…ç„¶ä¹Ÿä¸ä¼šåªåšä¸€æ¬¡ attentionï¼Œå¤šæ¬¡ attention ç»¼åˆçš„ç»“æœè‡³å°‘èƒ½å¤Ÿèµ·åˆ°å¢å¼ºæ¨¡å‹çš„ä½œç”¨ï¼Œä¹Ÿå¯ä»¥ç±»æ¯” CNN ä¸­åŒæ—¶ä½¿ç”¨å¤šä¸ªå·ç§¯æ ¸çš„ä½œç”¨ï¼Œç›´è§‚ä¸Šè®²ï¼Œå¤šå¤´çš„æ³¨æ„åŠ›æœ‰åŠ©äºç½‘ç»œæ•æ‰åˆ°æ›´ä¸°å¯Œçš„ç‰¹å¾ä¿¡æ¯ Transformer ç›¸æ¯”äº RNN/LSTMï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ RNN ç³»åˆ—çš„æ¨¡å‹ï¼Œæ— æ³•å¹¶è¡Œè®¡ç®—ï¼Œå› ä¸º T æ—¶åˆ»çš„è®¡ç®—ä¾èµ– T-1 æ—¶åˆ»çš„éšå±‚è®¡ç®—ç»“æœï¼Œè€Œ T-1 æ—¶åˆ»çš„è®¡ç®—ä¾èµ– T-2 æ—¶åˆ»çš„éšå±‚è®¡ç®—ç»“æœ Transformer çš„ç‰¹å¾æŠ½å–èƒ½åŠ›æ¯” RNN ç³»åˆ—çš„æ¨¡å‹è¦å¥½ ä¸ºä»€ä¹ˆè¯´ Transformer å¯ä»¥ä»£æ›¿ seq2seqï¼Ÿ è¿™é‡Œç”¨ä»£æ›¿è¿™ä¸ªè¯ç•¥æ˜¾ä¸å¦¥å½“ï¼Œseq2seq è™½å·²è€ï¼Œä½†å§‹ç»ˆè¿˜æ˜¯æœ‰å…¶ç”¨æ­¦ä¹‹åœ°ï¼Œseq2seq æœ€å¤§çš„é—®é¢˜åœ¨äºå°†Encoderç«¯çš„æ‰€æœ‰ä¿¡æ¯å‹ç¼©åˆ°ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡ä¸­ï¼Œå¹¶å°†å…¶ä½œä¸º Decoder ç«¯é¦–ä¸ªéšè—çŠ¶æ€çš„è¾“å…¥ï¼Œæ¥é¢„æµ‹ Decoder ç«¯ç¬¬ä¸€ä¸ªå•è¯ (token) çš„éšè—çŠ¶æ€ã€‚åœ¨è¾“å…¥åºåˆ—æ¯”è¾ƒé•¿çš„æ—¶å€™ï¼Œè¿™æ ·åšæ˜¾ç„¶ä¼šæŸå¤± Encoder ç«¯çš„å¾ˆå¤šä¿¡æ¯ï¼Œè€Œä¸”è¿™æ ·ä¸€è‚¡è„‘çš„æŠŠè¯¥å›ºå®šå‘é‡é€å…¥ Decoder ç«¯ï¼ŒDecoder ç«¯ä¸èƒ½å¤Ÿå…³æ³¨åˆ°å…¶æƒ³è¦å…³æ³¨çš„ä¿¡æ¯ã€‚ Transformer ä¸ä½†å¯¹ seq2seq æ¨¡å‹è¿™ä¸¤ç‚¹ç¼ºç‚¹æœ‰äº†å®è´¨æ€§çš„æ”¹è¿› (å¤šå¤´äº¤äº’å¼ attention æ¨¡å—)ï¼Œè€Œä¸”è¿˜å¼•å…¥äº† self-attention æ¨¡å—ï¼Œè®©æºåºåˆ—å’Œç›®æ ‡åºåˆ—é¦–å…ˆ â€œè‡ªå…³è”â€ èµ·æ¥ï¼Œè¿™æ ·çš„è¯ï¼Œæºåºåˆ—å’Œç›®æ ‡åºåˆ—è‡ªèº«çš„ embedding è¡¨ç¤ºæ‰€è•´å«çš„ä¿¡æ¯æ›´åŠ ä¸°å¯Œï¼Œè€Œä¸”åç»­çš„ FFN å±‚ä¹Ÿå¢å¼ºäº†æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ï¼Œå¹¶ä¸” Transformer å¹¶è¡Œè®¡ç®—çš„èƒ½åŠ›è¿œè¿œè¶…è¿‡äº† seq2seq ç³»åˆ—æ¨¡å‹ ","date":"2023-07-24","objectID":"/posts/transformerdetailedexplanation/:1:7","tags":["Transformer"],"title":"Transformer è¯¦è§£","uri":"/posts/transformerdetailedexplanation/"},{"categories":["ML"],"content":"7. å‚è€ƒæ–‡ç«  Transformer The Illustrated Transformer TRANSFORMERS FROM SCRATCH Seq2seq pay Attention to Self Attention: Part 2 ref: [1]. Bç«™è®²è§£è§†é¢‘ [2]. https://wmathor.com/index.php/archives/1438/ [3]. Transformerçš„pytorchå®ç° ","date":"2023-07-24","objectID":"/posts/transformerdetailedexplanation/:1:8","tags":["Transformer"],"title":"Transformer è¯¦è§£","uri":"/posts/transformerdetailedexplanation/"},{"categories":["C++"],"content":"å‡½æ•°å£°æ˜çš„å‡ ç§æ–¹å¼ å£°æ˜ä¸€ä¸ªå‡½æ•°få¸¦æœ‰ä¸€ä¸ªdoubleè€Œä¸”è¿”å›ä¸€ä¸ªintï¼š int f(double d); åä¸ºdçš„å‚æ•°å·¦å³çš„æ‹¬å·æ˜¯å¤šä½™çš„ï¼Œè¢«å¿½ç•¥ï¼š int f(double (d)); // åŒä¸Šï¼›då·¦å³çš„æ‹¬å·è¢«å¿½ç•¥ çœç•¥äº†å‚æ•°åï¼š int f(double); // åŒä¸Šï¼›å‚æ•°åè¢«çœç•¥ ç¬¬ä¸€ä¸ªå£°æ˜äº†ä¸€ä¸ªå‡½æ•°gï¼Œå®ƒå¸¦æœ‰ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¸ªå‚æ•°æ˜¯æŒ‡å‘ä¸€ä¸ªæ²¡æœ‰å‚æ•°ã€è¿”å›doubleçš„å‡½æ•°çš„æŒ‡é’ˆï¼š int g(double (*pf)()); // gå¸¦æœ‰ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆä½œä¸ºå‚æ•° å”¯ä¸€çš„ä¸åŒæ˜¯pfä½¿ç”¨éæŒ‡é’ˆè¯­æ³•æ¥å£°æ˜(ä¸€ä¸ªåœ¨Cå’ŒC++ä¸­éƒ½æœ‰æ•ˆçš„è¯­æ³•): int g(double pf()); // åŒä¸Šï¼›pfå…¶å®æ˜¯ä¸€ä¸ªæŒ‡é’ˆ ç…§å¸¸ï¼Œå‚æ•°åå¯ä»¥çœç•¥ï¼Œæ‰€ä»¥è¿™æ˜¯gçš„ç¬¬ä¸‰ç§å£°æ˜ï¼Œå»æ‰äº†pfè¿™ä¸ªåå­—ï¼š int g(double ()); // åŒä¸Šï¼›å‚æ•°åçœç•¥ æ³¨æ„å‚æ•°åå·¦å³çš„æ‹¬å·ï¼ˆå°±åƒfçš„ç¬¬äºŒç§å£°æ˜ä¸­çš„dï¼‰å’Œå•ç‹¬çš„æ‹¬å·ï¼ˆæ­£å¦‚æœ¬ä¾‹ï¼‰ä¹‹é—´çš„åŒºåˆ«ã€‚ å‚æ•°åå·¦å³çš„æ‹¬å·è¢«å¿½ç•¥ï¼Œä½†å•ç‹¬çš„æ‹¬å·æŒ‡å‡ºå­˜åœ¨ä¸€ä¸ªå‚æ•°åˆ—è¡¨ï¼šå®ƒä»¬å£°æ˜äº†å­˜åœ¨æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆçš„å‚æ•°ã€‚ ","date":"2023-07-24","objectID":"/posts/clause_6/:1:0","tags":["Effective STL"],"title":"Effective STL [6] | è­¦æƒ•C++æœ€ä»¤äººæ¼æ€’çš„è§£æ","uri":"/posts/clause_6/"},{"categories":["C++"],"content":"é—®é¢˜æ¢è®¨ å‡è®¾æœ‰ä¸€ä¸ªintçš„æ–‡ä»¶ï¼Œæƒ³è¦æŠŠé‚£äº›intæ‹·è´åˆ°ä¸€ä¸ªlistä¸­ï¼Œå¯èƒ½ä¼šä½¿ç”¨ä¸‹é¢ä»£ç ï¼š ifstream dataFile(\"ints.dat\"); // è­¦å‘Šï¼è¿™å®Œæˆçš„å¹¶ä¸æ˜¯åƒä½ æƒ³è±¡çš„é‚£æ · list\u003cint\u003e data(istream_iterator\u003cint\u003e(dataFile), istream_iterator\u003cint\u003e()); è¿™é‡Œçš„æƒ³æ³•æ˜¯ä¼ ä¸€å¯¹istream_iteratorç»™listçš„åŒºé—´æ„é€ å‡½æ•°ï¼Œå› æ­¤æŠŠintä»æ–‡ä»¶æ‹·è´åˆ°listä¸­ã€‚ è¿™æ®µä»£ç å¯ä»¥ç¼–è¯‘ï¼Œä½†æ˜¯è¿è¡Œæ—¶ä»€ä¹ˆéƒ½ä¸ä¼šåšï¼Œä¸ä¼šä»æ–‡ä»¶ä¸­è¯»å‡ºä»»ä½•æ•°æ®ï¼Œç”šè‡³ä¸ä¼šæ„å»º1ä¸ªlistã€‚ ç¬¬äºŒå¥å¹¶ä¸å£°æ˜listï¼Œä¹Ÿä¸è°ƒç”¨æ„é€ å‡½æ•°ã€‚ è¿™å£°æ˜äº†ä¸€ä¸ªå‡½æ•°dataï¼Œå®ƒçš„è¿”å›ç±»å‹æ˜¯list\u003cint\u003eã€‚è¿™ä¸ªå‡½æ•°dataå¸¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼š â— ç¬¬1ä¸ªå‚æ•°å«åšdataFileã€‚å®ƒçš„ç±»å‹æ˜¯istream_iterator\u003cint\u003eã€‚dataFileå·¦å³çš„æ‹¬å·æ˜¯å¤šä½™çš„è€Œä¸”è¢«å¿½ç•¥ã€‚ â— ç¬¬2ä¸ªå‚æ•°æ²¡æœ‰åå­—ã€‚å®ƒçš„ç±»å‹æ˜¯æŒ‡å‘ä¸€ä¸ªæ²¡æœ‰å‚æ•°è€Œä¸”è¿”å›istream_iterator\u003cint\u003eçš„å‡½æ•°çš„æŒ‡é’ˆã€‚ å°±åƒä¸‹é¢å…·æœ‰è¿™æ¡è§„åˆ™çš„ä»£ç ï¼š class Widget {...}; // å‡è®¾Widgetæœ‰é»˜è®¤æ„é€ å‡½æ•° Widget w(); è¿™å¹¶æ²¡æœ‰å£°æ˜ä¸€ä¸ªå«åšwçš„Widgetï¼Œå®ƒå£°æ˜äº†ä¸€ä¸ªå«ä½œwçš„æ²¡æœ‰å‚æ•°ä¸”è¿”å›Widgetçš„å‡½æ•°ã€‚ æœ¬æ¥ä»£ç çš„åˆè¡·ï¼Œæ˜¯ç”¨ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹æ¥åˆå§‹åŒ–ä¸€ä¸ªlist\u003cint\u003eå¯¹è±¡ï¼Œç°åœ¨å¹¶æ²¡æœ‰è¾¾åˆ°æˆ‘ä»¬çš„æœŸæœ›ã€‚ ","date":"2023-07-24","objectID":"/posts/clause_6/:2:0","tags":["Effective STL"],"title":"Effective STL [6] | è­¦æƒ•C++æœ€ä»¤äººæ¼æ€’çš„è§£æ","uri":"/posts/clause_6/"},{"categories":["C++"],"content":"è§£å†³åŠæ³• å‡½æ•°è°ƒç”¨å‰åå¢åŠ æ‹¬å· ç”¨æ‹¬å·åŒ…å›´ä¸€ä¸ªå®å‚çš„å£°æ˜æ˜¯ä¸åˆæ³•çš„ï¼Œä½†ç”¨æ‹¬å·åŒ…å›´ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„è§‚ç‚¹æ˜¯åˆæ³•çš„ï¼Œæ‰€ä»¥é€šè¿‡å¢åŠ ä¸€å¯¹æ‹¬å·ï¼Œä»£ç å˜ä¸ºï¼š list\u003cint\u003e data((istream_iterator\u003cint\u003e(dataFile)), // æ³¨æ„åœ¨listæ„é€ å‡½æ•°çš„ç¬¬ä¸€ä¸ªå®å‚å·¦å³çš„æ–°æ‹¬å· istream_iterator\u003cint\u003e()); è¿™æ˜¯å¯èƒ½çš„å£°æ˜æ•°æ®æ–¹æ³•ï¼Œç»™äºˆistream_iteratorsçš„å®ç”¨æ€§å’ŒåŒºé—´æ„é€ å‡½æ•°ã€‚ å‘½åè¿­ä»£å™¨å¯¹è±¡ ifstream dataFile(\"ints.dat\"); istream_iterator\u003cint\u003e dataBegin(dataFile); istream_iterator\u003cint\u003e dataEnd; list\u003cint\u003e data(dataBegin, dataEnd); å‘½åè¿­ä»£å™¨å¯¹è±¡çš„ä½¿ç”¨å’Œæ™®é€šçš„STLç¼–ç¨‹é£æ ¼ç›¸åï¼Œä½†æ˜¯ä½ å¾—åˆ¤æ–­è¿™ç§æ–¹æ³•å¯¹ç¼–è¯‘å™¨å’Œå¿…é¡»ä½¿ç”¨ç¼–è¯‘å™¨çš„äººéƒ½æ¨¡æ£±ä¸¤å¯çš„ä»£ç æ˜¯ä¸€ä¸ªå€¼å¾—ä»˜å‡ºçš„ä»£ä»·ã€‚ ","date":"2023-07-24","objectID":"/posts/clause_6/:3:0","tags":["Effective STL"],"title":"Effective STL [6] | è­¦æƒ•C++æœ€ä»¤äººæ¼æ€’çš„è§£æ","uri":"/posts/clause_6/"},{"categories":["C++"],"content":"Example Qï¼šç»™å®šä¸¤ä¸ªvectorï¼Œv1å’Œv2ï¼Œä½¿v1çš„å†…å®¹å’Œv2çš„ååŠéƒ¨åˆ†ä¸€æ ·çš„æœ€ç®€å•æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ Aï¼š v1.assign(v2.begin() + v2.size() / 2, v2.end()); è¿™ä¸ªæµ‹éªŒè®¾è®¡ä¸ºåšä¸¤ä»¶äº‹: å®ƒæä¾›ç»™æˆ‘ä¸€ä¸ªæœºä¼šæ¥æé†’ä½ assignæˆå‘˜å‡½æ•°çš„å­˜åœ¨ å¤ªå¤šçš„ç¨‹åºå‘˜æ²¡æ³¨æ„åˆ°è¿™æ˜¯ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„æ–¹æ³•ã€‚å®ƒå¯¹äºæ‰€æœ‰æ ‡å‡†åºåˆ—å®¹å™¨ï¼ˆvectorï¼Œstringï¼Œdequeå’Œlistï¼‰éƒ½æœ‰æ•ˆã€‚ æ— è®ºä½•æ—¶ä½ å¿…é¡»å®Œå…¨ä»£æ›¿ä¸€ä¸ªå®¹å™¨çš„å†…å®¹ï¼Œä½ å°±åº”è¯¥æƒ³åˆ°èµ‹å€¼ã€‚ å¦‚æœä½ åªæ˜¯æ‹·è´ä¸€ä¸ªå®¹å™¨åˆ°å¦ä¸€ä¸ªåŒç±»å‹çš„å®¹å™¨ï¼Œoperator=å°±æ˜¯é€‰æ‹©çš„èµ‹å€¼å‡½æ•°ï¼Œä½†å¯¹äºç¤ºèŒƒçš„é‚£ä¸ªä¾‹å­ï¼Œå½“ä½ æƒ³è¦ç»™ä¸€ä¸ªå®¹å™¨å®Œå…¨çš„æ–°æ•°æ®é›†æ—¶ï¼Œassignå°±å¯ä»¥åˆ©ç”¨ï¼Œä½†operator=åšä¸äº†ã€‚ æ¼”ç¤ºä¸ºä»€ä¹ˆåŒºé—´æˆå‘˜å‡½æ•°ä¼˜å…ˆäºå®ƒä»¬çš„å•å…ƒç´ æ›¿ä»£å“ã€‚ åŒºé—´æˆå‘˜å‡½æ•°æ˜¯ä¸€ä¸ªåƒSTLç®—æ³•çš„æˆå‘˜å‡½æ•°ï¼Œä½¿ç”¨ä¸¤ä¸ªè¿­ä»£å™¨å‚æ•°æ¥æŒ‡å®šå…ƒç´ çš„ä¸€ä¸ªåŒºé—´æ¥è¿›è¡ŒæŸä¸ªæ“ä½œã€‚ ä¸ç”¨åŒºé—´æˆå‘˜å‡½æ•°æ¥è§£å†³è¿™ä¸ªæ¡æ¬¾å¼€å¤´çš„é—®é¢˜ï¼Œä½ å°±å¿…é¡»å†™ä¸€ä¸ªæ˜¾å¼å¾ªç¯ï¼Œå¯èƒ½å°±åƒè¿™æ ·: vector\u003cRandy\u003e v1, v2; // å‡è®¾v1å’Œv2æ˜¯Randyçš„vector v1.clear(); for (vector\u003cRandy\u003e::const_iterator ci = v2.begin() + v2.size() / 2; ci != v2.end(); ++ci) { v1.push_back(*ci); } å†™è¿™æ®µä»£ç æ¯”å†™assignçš„è°ƒç”¨è¦åšå¤šå¾—å¤šçš„å·¥ä½œã€‚ copy æ›¿ä»£å¾ªç¯ v1.clear(); copy(v2.begin() + v2.size() / 2, v2.end(), back_inserter(v1)) è™½ç„¶åœ¨è¿™æ®µä»£ç ä¸­æ²¡æœ‰è¡¨ç°å‡ºå¾ªç¯ï¼Œåœ¨copyä¸­çš„ç¡®å­˜åœ¨ä¸€ä¸ªå¾ªç¯ ã€‚ æ•ˆç‡æŸå¤±ä»ç„¶å­˜åœ¨ã€‚ å‡ ä¹æ‰€æœ‰ç›®æ ‡åŒºé—´æ˜¯é€šè¿‡æ’å…¥è¿­ä»£å™¨ï¼ˆæ¯”å¦‚ï¼Œé€šè¿‡inserterï¼Œback_inserteræˆ–front_inserterï¼‰æŒ‡å®šçš„copyçš„ä½¿ç”¨éƒ½å¯ä»¥â€”â€”åº”è¯¥â€”â€”é€šè¿‡è°ƒç”¨åŒºé—´ æˆå‘˜å‡½æ•°æ¥ä»£æ›¿ã€‚ æ¯”å¦‚è¿™é‡Œï¼Œè¿™ä¸ªcopyçš„è°ƒç”¨å¯ä»¥ç”¨ä¸€ä¸ªinsertçš„åŒºé—´ç‰ˆæœ¬ä»£æ›¿ï¼š v1.insert(v1.end(), v2.begin() + v2.size() / 2, v2.end()); è¿™ä¸ªè¾“å…¥é‡ç¨å¾®æ¯”è°ƒç”¨copyå°‘ï¼Œä½†å®ƒå‘ç”Ÿçš„ä¹Ÿæ¯”è¯´çš„è¦ç›´æ¥ï¼šæ•°æ®æ’å…¥v1ã€‚ è¿™é‡Œinsert ä¹Ÿæ¯” copy å¥½ï¼Œå› ä¸ºå­—é¢ä¸Šinsert è¡¨ç¤ºæœ‰æ•°æ®æ’å…¥åˆ°äº† v1ä¸­ï¼Œè€Œcopy çš„ä½¿ç”¨æŠŠå®ƒå˜å¾—æ™¦æ¶©ã€‚ å…³äºä¸œè¥¿è¢«æ‹·è´è¿™ä¸ªäº‹å®å¹¶æ²¡æœ‰ä»€ä¹ˆå¥½å…³æ³¨çš„ï¼Œå› ä¸ºSTLæ„å»ºåœ¨ä¸œè¥¿ä¼šè¢«æ‹·è´çš„å‡å®šä¸Šã€‚æ‹·è´å¯¹STLæ¥è¯´å¾ˆåŸºæœ¬ã€‚ å°ç»“ æˆ‘ä»¬å·²ç»ç¡®å®š3ä¸ªå°½é‡ä½¿ç”¨åŒºé—´æˆå‘˜å‡½æ•°ä»£æ›¿å®ƒä»¬çš„å•å…ƒç´ å…„å¼Ÿçš„ç†ç”±ã€‚ â— ä¸€èˆ¬æ¥è¯´ä½¿ç”¨åŒºé—´æˆå‘˜å‡½æ•°å¯ä»¥è¾“å…¥æ›´å°‘çš„ä»£ç ã€‚ â— åŒºé—´æˆå‘˜å‡½æ•°ä¼šå¯¼è‡´ä»£ç æ›´æ¸…æ™°æ›´ç›´æ¥äº†å½“ã€‚ ","date":"2023-07-24","objectID":"/posts/clause_5/:1:0","tags":["Effective STL"],"title":"Effective STL [5] | å°½é‡ä½¿ç”¨åŒºé—´æˆå‘˜å‡½æ•°ä»£æ›¿å®ƒä»¬çš„å•å…ƒç´ å…„å¼Ÿ","uri":"/posts/clause_5/"},{"categories":["C++"],"content":"æ•ˆç‡ å½“å¤„ç†æ ‡å‡†åºåˆ—å®¹å™¨æ—¶ï¼Œåº”ç”¨å•å…ƒç´ æˆå‘˜å‡½æ•°æ¯”å®ŒæˆåŒæ ·ç›®çš„çš„åŒºé—´æˆå‘˜å‡½æ•°éœ€è¦æ›´å¤šåœ°å†…å­˜åˆ†é…ï¼Œæ›´é¢‘ç¹åœ°æ‹·è´å¯¹è±¡ï¼Œè€Œä¸”/æˆ–è€…é€ æˆå¤šä½™æ“ä½œã€‚ å¯¹æ­¤ï¼Œæˆ‘ä¹‹å‰è¿˜åšäº†ä¸ªå•å…ƒç´ å…„å¼Ÿæ’å…¥å’Œæ‰¹é‡æ’å…¥çš„æ•ˆç‡æ¯”è¾ƒçš„æ–‡ç« ã€Švector ç”¨ insert æ‰¹é‡æ’å…¥æ•ˆç‡é«˜è¿˜æ˜¯emplace_backæ•ˆç‡é«˜ã€‹ï¼Œä¹Ÿè¯å®äº†è¿™ä¸ªè§‚ç‚¹ã€‚ æ ‡å‡†è¦æ±‚åŒºé—´insertå‡½æ•°ç›´æ¥æŠŠç°æœ‰å…ƒç´ ç§»åŠ¨åˆ°å®ƒä»¬æœ€åçš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ï¼Œå¼€é”€æ˜¯æ¯ä¸ªå…ƒç´ ä¸€æ¬¡ç§»åŠ¨ã€‚æ€»å…±å¼€é”€æ˜¯næ¬¡ç§»åŠ¨ï¼ŒnumValuesæ¬¡å®¹å™¨ä¸­çš„å¯¹è±¡ç±»å‹çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œå‰©ä¸‹çš„æ˜¯ç±»å‹çš„èµ‹å€¼æ“ä½œç¬¦ã€‚ ç›¸æ¯”å•å…ƒç´ æ’å…¥ç­–ç•¥ï¼ŒåŒºé—´insertå°‘æ‰§è¡Œäº†n*(numValues-1)æ¬¡ç§»åŠ¨ã€‚ èŠ±ä¸€åˆ†é’Ÿæƒ³æƒ³ã€‚è¿™æ„å‘³ç€å¦‚æœnumValuesæ˜¯100ï¼Œinsertçš„åŒºé—´å½¢å¼ä¼šæ¯”é‡å¤è°ƒç”¨insertçš„å•å…ƒç´ å½¢å¼çš„ä»£ç å°‘èŠ±è´¹99%çš„ç§»åŠ¨ï¼ ä»…å½“å¯ä»¥ä¸ç”¨å¤±å»ä¸¤ä¸ªè¿­ä»£å™¨çš„ä½ç½®å°±èƒ½å†³å®šå®ƒä»¬ä¹‹é—´çš„è·ç¦»æ—¶ï¼Œä¸€ä¸ªåŒºé—´insertå‡½æ•°æ‰èƒ½åœ¨ä¸€æ¬¡ç§»åŠ¨ä¸­æŠŠä¸€ä¸ªå…ƒç´ ç§»åŠ¨åˆ°å®ƒçš„æœ€ç»ˆä½ç½®ã€‚ è¿™å‡ ä¹æ€»æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºæ‰€æœ‰å‰å‘è¿­ä»£å™¨æä¾›äº†è¿™ä¸ªåŠŸèƒ½ï¼Œè€Œä¸”å‰å‘è¿­ä»£å™¨å‡ ä¹åˆ°å¤„éƒ½æ˜¯ã€‚ æ‰€æœ‰ç”¨äºæ ‡å‡†å®¹å™¨çš„è¿­ä»£å™¨éƒ½æä¾›äº†å‰å‘è¿­ä»£å™¨çš„åŠŸèƒ½ã€‚éæ ‡å‡†çš„æ•£åˆ—å®¹å™¨çš„è¿­ä»£å™¨ä¹Ÿæ˜¯ã€‚ åœ¨æ•°ç»„ä¸­è¡¨ç°ä¸ºè¿­ä»£å™¨çš„æŒ‡é’ˆä¹Ÿæä¾›äº†è¿™æ ·çš„åŠŸèƒ½ã€‚äº‹å®ä¸Šï¼Œå”¯ä¸€ä¸æä¾›å‰å‘è¿­ä»£å™¨èƒ½åŠ›çš„æ ‡å‡†è¿­ä»£å™¨æ˜¯è¾“å…¥å’Œè¾“å‡ºè¿­ä»£å™¨ã€‚ å•å…ƒç´ æ’å…¥çš„é—®é¢˜ å½“ä½ è¯•å›¾å»æŠŠä¸€ä¸ªå…ƒç´ æ’å…¥å†…å­˜å·²ç»æ»¡äº†çš„vectoræ—¶ï¼Œè¿™ä¸ªvectorä¼šåˆ†é…å…·æœ‰æ›´å¤šå®¹é‡çš„æ–°å†…å­˜ï¼Œä»æ—§å†…å­˜æŠŠå®ƒçš„å…ƒç´ æ‹·è´åˆ°æ–°å†…å­˜ï¼Œé”€æ¯æ—§å†…å­˜é‡Œçš„å…ƒç´ ï¼Œå›æ”¶æ—§å†…å­˜ã€‚ç„¶åå®ƒæ·»åŠ æ’å…¥çš„å…ƒç´ ã€‚ æ¯å½“ç”¨å®Œå†…å­˜æ—¶ï¼Œå¤§éƒ¨åˆ†vectorå®ç°éƒ½ä½¿å®ƒä»¬çš„å®¹é‡ç¿»å€ï¼Œæ‰€ä»¥æ’å…¥numValuesä¸ªæ–°å…ƒç´ ä¼šå¯¼è‡´æœ€å¤š$\\log_2{numValues}$æ¬¡æ–°å†…å­˜çš„åˆ†é…ã€‚ æ¯æ¬¡ä¸€ä¸ªåœ°æ’å…¥1000ä¸ªå…ƒç´ ä¼šå¯¼è‡´10æ¬¡æ–°çš„åˆ†é…ï¼ˆåŒ…æ‹¬å®ƒä»¬è´Ÿè´£çš„å…ƒç´ æ‹·è´ï¼‰ã€‚ ä¸ä¹‹å¯¹æ¯”çš„æ˜¯ï¼Œä¸€ä¸ªåŒºé—´æ’å…¥å¯ä»¥åœ¨å¼€å§‹æ’å…¥ä¸œè¥¿å‰è®¡ç®—å‡ºéœ€è¦å¤šå°‘æ–°å†…å­˜ï¼ˆå‡è®¾ç»™çš„æ˜¯å‰å‘è¿­ä»£å™¨ï¼‰ï¼Œæ‰€ä»¥å®ƒä¸ç”¨å¤šäºä¸€æ¬¡åœ°é‡æ–°åˆ†é…vectorçš„å†…åœ¨å†…å­˜ã€‚ åˆšæ‰è¿›è¡Œåˆ†ææ˜¯ç”¨äºvectorçš„ï¼Œä½†åŒæ ·çš„ç†ç”±ä¹Ÿä½œç”¨äºstringã€‚ deque å¯¹äºdequeï¼Œç†ç”±ä¹Ÿå¾ˆç›¸ä¼¼ï¼Œä½†dequeç®¡ç†å®ƒä»¬å†…å­˜çš„æ–¹å¼å’Œvectorå’Œstringä¸åŒï¼Œæ‰€ä»¥é‡å¤å†…å­˜åˆ†é…çš„è®ºç‚¹ä¸èƒ½åº”ç”¨ã€‚ ä½†æ˜¯ï¼Œå…³äºå¾ˆå¤šæ¬¡ä¸å¿…è¦çš„å…ƒç´ ç§»åŠ¨çš„è®ºç‚¹é€šå¸¸é€šè¿‡å¯¹å‡½æ•°è°ƒç”¨æ¬¡æ•°çš„è§‚å¯Ÿä¹Ÿåº”ç”¨åˆ°äº†ï¼ˆè™½ç„¶ç»†èŠ‚ä¸åŒï¼‰ã€‚ list åœ¨è¿™é‡Œä½¿ç”¨insertåŒºé—´å½¢å¼ä»£æ›¿å•å…ƒç´ å½¢å¼ä¹Ÿæœ‰ä¸€ä¸ªæ€§èƒ½ä¼˜åŠ¿ã€‚ å…³äºé‡å¤å‡½æ•°è°ƒç”¨çš„è®ºç‚¹å½“ç„¶ç»§ç»­æœ‰æ•ˆï¼Œä½†å› ä¸ºé“¾è¡¨çš„å·¥ä½œæ–¹å¼ï¼Œæ‹·è´å’Œå†…å­˜åˆ†é…é—®é¢˜æ²¡æœ‰å‘ç”Ÿã€‚ å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ–°é—®é¢˜ï¼šè¿‡å¤šé‡å¤åœ°å¯¹listä¸­çš„ä¸€äº›èŠ‚ç‚¹çš„nextå’ŒprevæŒ‡é’ˆèµ‹å€¼ã€‚ æ¯å½“ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°ä¸€ä¸ªé“¾è¡¨æ—¶ï¼ŒæŒæœ‰å…ƒç´ çš„é“¾è¡¨èŠ‚ç‚¹å¿…é¡»æœ‰å®ƒçš„nextå’ŒprevæŒ‡é’ˆé›†ï¼Œè€Œä¸”å½“ç„¶æ–°èŠ‚ç‚¹å‰é¢çš„èŠ‚ç‚¹ï¼ˆæˆ‘ä»¬å«å®ƒBï¼Œå°±æ˜¯â€œbeforeâ€ï¼‰å¿…é¡»è®¾ç½®å®ƒçš„nextæŒ‡é’ˆï¼Œæ–°èŠ‚ç‚¹åé¢çš„èŠ‚ç‚¹ï¼ˆæˆ‘ä»¬å«å®ƒAï¼Œå°±æ˜¯â€œafterâ€ï¼‰å¿…é¡»è®¾ç½®å®ƒçš„prevæŒ‡é’ˆ å½“ä¸€ç³»åˆ—æ–°èŠ‚ç‚¹é€šè¿‡è°ƒç”¨listçš„å•å…ƒç´ insertä¸€ä¸ªæ¥ä¸€ä¸ªæ·»åŠ æ—¶ï¼Œé™¤äº†æœ€åä¸€ä¸ªä»¥å¤–çš„å…¶ä»–æ–°èŠ‚ç‚¹éƒ½ä¼šè®¾ç½®å®ƒçš„nextæŒ‡é’ˆä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æŒ‡å‘Aï¼Œç¬¬äºŒæ¬¡æŒ‡å‘åœ¨å®ƒåé¢æ’å…¥çš„å…ƒç´ ã€‚æ¯æ¬¡åœ¨Aå‰é¢æ’å…¥æ—¶ï¼Œå®ƒéƒ½ä¼šè®¾ç½®å®ƒçš„prevæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæ–°èŠ‚ç‚¹ã€‚ å¦‚æœnumValuesä¸ªèŠ‚ç‚¹æ’å…¥Aå‰é¢ï¼Œæ’å…¥èŠ‚ç‚¹çš„nextæŒ‡é’ˆä¼šå‘ç”Ÿæ¬¡å¤šä½™çš„èµ‹å€¼ï¼Œè€Œä¸”Açš„prevæŒ‡é’ˆä¼šå‘ç”ŸnumValues-1æ¬¡å¤šä½™çš„èµ‹å€¼ã€‚åˆè®¡æ¬¡æ²¡æœ‰å¿…è¦çš„æŒ‡é’ˆèµ‹å€¼ã€‚å½“ç„¶ï¼ŒæŒ‡é’ˆèµ‹å€¼å¾ˆè½»é‡ï¼Œä½†å¦‚æœä¸æ˜¯å¿…é¡»ï¼Œä¸ºä»€ä¹ˆè¦ä¸ºå®ƒä»¬èŠ±è´¹å‘¢ï¼Ÿ **é¿å…å¼€é”€çš„å…³é”®æ˜¯ä½¿ç”¨listçš„insertåŒºé—´å½¢å¼ã€‚**å› ä¸ºé‚£ä¸ªå‡½æ•°çŸ¥é“æœ€åæœ‰å¤šå°‘èŠ‚ç‚¹ä¼šè¢«æ’å…¥ï¼Œå®ƒå¯ä»¥é¿å…å¤šä½™çš„æŒ‡é’ˆèµ‹å€¼ï¼Œå¯¹æ¯ä¸ªæŒ‡é’ˆåªä½¿ç”¨ä¸€æ¬¡èµ‹å€¼å°±èƒ½è®¾ç½®å®ƒæ­£ç¡®çš„æ’å…¥åçš„å€¼ ","date":"2023-07-24","objectID":"/posts/clause_5/:2:0","tags":["Effective STL"],"title":"Effective STL [5] | å°½é‡ä½¿ç”¨åŒºé—´æˆå‘˜å‡½æ•°ä»£æ›¿å®ƒä»¬çš„å•å…ƒç´ å…„å¼Ÿ","uri":"/posts/clause_5/"},{"categories":["C++"],"content":"åŒºé—´å‡½æ•° å‚æ•°ç±»å‹iteratoræ„æ€æ˜¯å®¹å™¨çš„è¿­ä»£å™¨ç±»å‹ï¼Œä¹Ÿå°±æ˜¯container::iteratorã€‚ å‚æ•°ç±»å‹InputIteratoræ„æ€æ˜¯å¯ä»¥æ¥å—ä»»ä½•è¾“å…¥è¿­ä»£å™¨ã€‚ åŒºé—´æ„é€  æ‰€æœ‰æ ‡å‡†å®¹å™¨éƒ½æä¾›è¿™ç§å½¢å¼çš„æ„é€ å‡½æ•°ï¼š container::container(InputIterator begin, // åŒºé—´çš„èµ·ç‚¹ InputIterator end); // åŒºé—´çš„ç»ˆç‚¹ å¦‚æœä¼ ç»™è¿™ä¸ªæ„é€ å‡½æ•°çš„è¿­ä»£å™¨æ˜¯istream_iteratorsæˆ–istreambuf_iteratorsï¼Œä½ å¯èƒ½ä¼šé‡åˆ°C++çš„æœ€æƒŠå¼‚çš„è§£æï¼ŒåŸå› ä¹‹ä¸€æ˜¯ä½ çš„ç¼–è¯‘å™¨å¯èƒ½ä¼šå› ä¸ºæŠŠè¿™ä¸ªæ„é€ çœ‹ä½œä¸€ä¸ªå‡½æ•°å£°æ˜è€Œä¸æ˜¯ä¸€ä¸ªæ–°å®¹å™¨å¯¹è±¡çš„å®šä¹‰è€Œä¸­æ–­ã€‚ åŒºé—´æ’å…¥ æ‰€æœ‰æ ‡å‡†åºåˆ—å®¹å™¨éƒ½æä¾›è¿™ç§å½¢å¼çš„insert: void container::insert(iterator position, // åŒºé—´æ’å…¥çš„ä½ç½® InputIterator begin, // æ’å…¥åŒºé—´çš„èµ·ç‚¹ InputIterator end); // æ’å…¥åŒºé—´çš„ç»ˆç‚¹ å…³è”å®¹å™¨ä½¿ç”¨å®ƒä»¬çš„æ¯”è¾ƒå‡½æ•°æ¥å†³å®šå…ƒç´ è¦æ”¾åœ¨å“ªé‡Œï¼Œæ‰€ä»¥å®ƒä»¬äº†çœç•¥positionå‚æ•°ã€‚ void container::insert(lnputIterator begin, InputIterator end); å½“å¯»æ‰¾ç”¨åŒºé—´ç‰ˆæœ¬ä»£æ›¿å•å…ƒç´ æ’å…¥çš„æ–¹æ³•æ—¶ï¼Œä¸è¦å¿˜è®°æœ‰äº›å•å…ƒç´ å˜é‡ç”¨é‡‡ç”¨ä¸åŒçš„å‡½æ•°åä¼ªè£…å®ƒä»¬è‡ªå·±ã€‚æ¯”å¦‚ï¼Œpush_frontå’Œpush_backéƒ½æŠŠå•å…ƒç´ æ’å…¥å®¹å™¨ï¼Œå³ä½¿å®ƒä»¬ä¸å«insertã€‚å¦‚æœä½ çœ‹è§ä¸€ä¸ªå¾ªç¯è°ƒç”¨push_frontæˆ–push_backï¼Œæˆ–å¦‚æœä½ çœ‹è§ä¸€ä¸ªç®—æ³•â€”â€”æ¯”å¦‚copyâ€”â€”çš„å‚æ•°æ˜¯front_inserteræˆ–è€…back_inserterï¼Œä½ å°±å‘ç°äº†ä¸€ä¸ªinsertçš„åŒºé—´å½¢å¼åº”è¯¥ä½œä¸ºä¼˜å…ˆç­–ç•¥çš„åœ°æ–¹ã€‚ åŒºé—´åˆ é™¤ æ¯ä¸ªæ ‡å‡†å®¹å™¨éƒ½æä¾›äº†ä¸€ä¸ªåŒºé—´å½¢å¼çš„eraseï¼Œä½†æ˜¯åºåˆ—å’Œå…³è”å®¹å™¨çš„è¿”å›ç±»å‹ä¸åŒã€‚ åºåˆ—å®¹å™¨æä¾›äº†è¿™ä¸ªï¼š iterator container::erase(iterator begin, iterator end); å…³è”å®¹å™¨æä¾›è¿™ä¸ª: void container::erase(iterator begin, iterator end); Qï¼šä¸ºä»€ä¹ˆä¸åŒï¼Ÿ Aï¼šè§£é‡Šæ˜¯ï¼Œå¦‚æœeraseçš„å…³è”å®¹å™¨ç‰ˆæœ¬è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆè¢«åˆ é™¤çš„é‚£ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªï¼‰ä¼šæ‹›è‡´ä¸€ä¸ªæ— æ³•æ¥å—çš„æ€§èƒ½ä¸‹é™ã€‚ è¿™ä¸ªæ¡æ¬¾çš„å¯¹insertçš„æ€§èƒ½åˆ†æå¤§éƒ¨åˆ†ä¹ŸåŒæ ·å¯ä»¥ç”¨äºeraseã€‚å•å…ƒç´ åˆ é™¤çš„å‡½æ•°è°ƒç”¨æ¬¡æ•°ä»ç„¶å¤§äºä¸€æ¬¡è°ƒç”¨åŒºé—´åˆ é™¤ã€‚å½“ä½¿ç”¨å•å…ƒç´ åˆ é™¤æ—¶ï¼Œæ¯ä¸€æ¬¡å…ƒç´ å€¼ä»ç„¶å¿…é¡»å‘å®ƒä»¬çš„ç›®çš„åœ°ç§»åŠ¨ä¸€ä½ï¼Œè€ŒåŒºé—´åˆ é™¤å¯ä»¥åœ¨ä¸€ä¸ªå•ç‹¬çš„ç§»åŠ¨ä¸­æŠŠå®ƒä»¬ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®ã€‚ å…³äºvectorå’Œstringçš„æ’å…¥å’Œåˆ é™¤çš„ä¸€ä¸ªè®ºç‚¹æ˜¯å¿…é¡»åšå¾ˆå¤šé‡å¤çš„åˆ†é…ã€‚ï¼ˆå½“ç„¶å¯¹äºåˆ é™¤ï¼Œä¼šå‘ç”Ÿé‡å¤çš„å›æ”¶ã€‚ï¼‰é‚£æ˜¯å› ä¸ºç”¨äºvectorå’Œstringçš„å†…å­˜è‡ªåŠ¨å¢é•¿æ¥é€‚åº”äºæ–°å…ƒç´ ï¼Œä½†å½“å…ƒç´ çš„æ•°ç›®å‡å°‘æ—¶å®ƒä¸è‡ªåŠ¨æ”¶ç¼©ã€‚ åŒºé—´èµ‹å€¼ æ‰€æœ‰æ ‡å‡†åˆ—å®¹å™¨éƒ½æä¾›äº†åŒºé—´å½¢å¼çš„assign: void container::assign(InputIterator begin, InputIterator end); ","date":"2023-07-24","objectID":"/posts/clause_5/:3:0","tags":["Effective STL"],"title":"Effective STL [5] | å°½é‡ä½¿ç”¨åŒºé—´æˆå‘˜å‡½æ•°ä»£æ›¿å®ƒä»¬çš„å•å…ƒç´ å…„å¼Ÿ","uri":"/posts/clause_5/"},{"categories":["C++"],"content":"ç»“è®º å‡ ä¹æ‰€æœ‰ç›®æ ‡åŒºé—´è¢«æ’å…¥è¿­ä»£å™¨æŒ‡å®šçš„copyçš„ä½¿ç”¨éƒ½å¯ä»¥ç”¨è°ƒç”¨çš„åŒºé—´æˆå‘˜å‡½æ•°çš„æ¥ä»£æ›¿ ã€‚ å°½é‡ä½¿ç”¨åŒºé—´æˆå‘˜å‡½æ•°æ¥ä»£æ›¿å•å…ƒç´ å…„å¼Ÿçš„ä¸‰ä¸ªå¯é çš„è®ºç‚¹ã€‚åŒºé—´æˆå‘˜å‡½æ•°æ›´å®¹æ˜“å†™ï¼Œå®ƒä»¬æ›´æ¸…æ¥šåœ°è¡¨è¾¾ä½ çš„æ„å›¾ï¼Œè€Œä¸”å®ƒä»¬æä¾›äº†æ›´é«˜çš„æ€§èƒ½ã€‚é‚£æ˜¯å¾ˆéš¾æ‰“è´¥çš„ä¸‰é©¾é©¬è½¦ã€‚ ref: [1]. https://mp.weixin.qq.com/s?__biz=MzUyMDc2MDMxNg==\u0026mid=2247490705\u0026idx=1\u0026sn=830797e69b61fe9693bf4aaea72df4b3\u0026chksm=f9e42202ce93ab1437ad36c37e141b0794328495c0c584d808d0f4ad36251680dbfba257b060\u0026cur_album_id=3009999611861975043\u0026scene=189#wechat_redirect ","date":"2023-07-24","objectID":"/posts/clause_5/:4:0","tags":["Effective STL"],"title":"Effective STL [5] | å°½é‡ä½¿ç”¨åŒºé—´æˆå‘˜å‡½æ•°ä»£æ›¿å®ƒä»¬çš„å•å…ƒç´ å…„å¼Ÿ","uri":"/posts/clause_5/"},{"categories":["draft"],"content":"åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º å¯¹äºä»»æ„å®¹å™¨ randy, å½“åˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„æ—¶å€™ï¼Œä¼šä½¿ç”¨åˆ°ä»¥ä¸‹åˆ¤æ–­è¯­å¥ï¼š if(randy.size() == 0) { ... // work } // or if(randy.empty()) { ... // work } åº”è¯¥é¦–é€‰emptyçš„æ„é€ ï¼Œè€Œä¸”ç†ç”±å¾ˆç®€å•ï¼šå¯¹äºæ‰€æœ‰çš„æ ‡å‡†å®¹å™¨ï¼Œemptyæ˜¯ä¸€ä¸ªå¸¸æ•°æ—¶é—´çš„æ“ä½œï¼Œä½†å¯¹äºä¸€äº›listå®ç°ï¼ŒsizeèŠ±è´¹çº¿æ€§æ—¶é—´ ","date":"2023-07-24","objectID":"/posts/clause_4/:1:0","tags":["draft"],"title":"Effective STL [4] | ç”¨emptyæ¥ä»£æ›¿æ£€æŸ¥size()æ˜¯å¦ä¸º0","uri":"/posts/clause_4/"},{"categories":["draft"],"content":"list sizeè€—æ—¶ Qï¼šä½†æ˜¯ä»€ä¹ˆé€ æˆlistè¿™ä¹ˆéº»çƒ¦ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½ä¹Ÿæä¾›ä¸€ä¸ªå¸¸æ•°æ—¶é—´çš„sizeï¼Ÿ Aï¼šå¯¹äºlistç‰¹æœ‰çš„spliceæœ‰å¾ˆå¤šè¦å¤„ç†çš„ä¸œè¥¿ã€‚ è€ƒè™‘è¿™æ®µä»£ç ï¼š list\u003cint\u003e list1; list\u003cint\u003e list2; ... list1.splice( // æŠŠlist2ä¸­ list1.end(), list2, // ä»ç¬¬ä¸€æ¬¡å‡ºç°5åˆ° find(list2.begin(), list2.end(), 5), // æœ€åä¸€æ¬¡å‡ºç°10 find(list2.rbegin(), list2.rend(), 10).base() // çš„æ‰€æœ‰èŠ‚ç‚¹ç§»åˆ°list1çš„ç»“å°¾ã€‚ ); é™¤élist2åœ¨5çš„åé¢æœ‰ä¸€ä¸ª10ï¼Œå¦åˆ™è¿™æ®µä»£ç æ— æ³•å·¥ä½œï¼Œä½†æ˜¯å’±ä»¬å‡è®¾è¿™ä¸æ˜¯é—®é¢˜ã€‚ Qï¼šå‡è®¾ä¸Šè¿°ä»£ç å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œé‚£ä¹ˆæ¥åˆålist1æœ‰å¤šå°‘å…ƒç´ ï¼Ÿ Aï¼šç»“åˆålist1çš„å…ƒç´ ä¸ªæ•°=æ¥åˆä¹‹åå‰list1çš„å…ƒç´ ä¸ªæ•° + æ¥åˆè¿›å»çš„å…ƒç´ ä¸ªæ•° Qï¼šæœ‰å¤šå°‘å…ƒç´ æ¥åˆè¿›å»äº†ï¼Ÿ Aï¼šå…ƒç´ ä¸ªæ•°ä¸ºfind(list2.rbegin(), list2.rend(), 10).base()æ‰€å®šä¹‰çš„åŒºé—´çš„å…ƒç´ ä¸ªæ•°ã€‚ åˆ°åº•æœ‰å¤šå°‘ï¼Ÿ åœ¨æ²¡æœ‰éå†è¿™ä¸ªåŒºé—´å¹¶è®¡æ•°ä¹‹å‰æ— æ³•çŸ¥é“ã€‚ é—®é¢˜å‰–æ å¦‚æœsizeæ˜¯ä¸€ä¸ªå¸¸æ•°æ—¶é—´æ“ä½œï¼Œå½“æ“ä½œæ—¶æ¯ä¸ªlistæˆå‘˜å‡½æ•°å¿…é¡»æ›´æ–°listçš„å¤§å°ã€‚ä¹ŸåŒ…æ‹¬äº†spliceã€‚ è®©åŒºé—´ç‰ˆæœ¬çš„spliceæ›´æ–°å®ƒæ‰€æ›´æ”¹çš„listå¤§å°çš„å”¯ä¸€çš„æ–¹æ³•æ˜¯ç®—å‡ºæ¥åˆè¿›æ¥çš„å…ƒç´ çš„ä¸ªæ•°ï¼Œä½†é‚£ä¹ˆåšå°±ä¼šä½¿å®ƒä¸å¯èƒ½æœ‰ä½ æ‰€å¸Œæœ›çš„å¸¸æ•°æ—¶é—´çš„æ€§èƒ½ã€‚ å¦‚æœä½ å»æ‰äº†spliceçš„åŒºé—´å½¢å¼è¦æ›´æ–°å®ƒæ‰€ä¿®æ”¹çš„listçš„å¤§å°çš„éœ€æ±‚ï¼Œspliceå°±å¯ä»¥æ˜¯å¸¸æ•°æ—¶é—´ï¼Œä½†sizeå°±å˜æˆçº¿æ€§æ—¶é—´çš„æ“ä½œã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå¿…é¡»éå†å®ƒçš„æ•´ä¸ªæ•°æ®ç»“æ„æ¥æ‰çŸ¥é“åŒ…å«å¤šå°‘å…ƒç´ ã€‚ ä¸åŒçš„listå®ç°ç”¨ä¸åŒçš„æ–¹å¼è§£å†³è¿™ä¸ªçŸ›ç›¾ï¼Œä¾èµ–äºä»–ä»¬çš„ä½œè€…é€‰æ‹©çš„æ˜¯è®©sizeæˆ–spliceçš„åŒºé—´å½¢å¼è¾¾åˆ°æœ€é«˜æ•ˆç‡ã€‚ å¦‚æœä½ ç¢°å·§ä½¿ç”¨äº†ä¸€ä¸ªå¸¸æ•°æ—¶é—´çš„spliceçš„åŒºé—´å½¢å¼æ¯”å¸¸æ•°æ—¶é—´çš„sizeä¼˜å…ˆçº§æ›´é«˜çš„listå®ç°ï¼Œè°ƒç”¨emptyæ¯”è°ƒç”¨sizeæ›´å¥½ï¼Œå› ä¸ºemptyæ€»æ˜¯å¸¸æ•°æ—¶é—´æ“ä½œã€‚ ","date":"2023-07-24","objectID":"/posts/clause_4/:2:0","tags":["draft"],"title":"Effective STL [4] | ç”¨emptyæ¥ä»£æ›¿æ£€æŸ¥size()æ˜¯å¦ä¸º0","uri":"/posts/clause_4/"},{"categories":["draft"],"content":"ç»“è®º ä¸åŒçš„listå®ç°ç”¨ä¸åŒçš„æ–¹å¼è§£å†³è¿™ä¸ªçŸ›ç›¾ï¼Œä¾èµ–äºå®ƒä»¬çš„ä½œè€…é€‰æ‹©çš„æ˜¯è®©sizeæˆ–spliceçš„åŒºé—´å½¢å¼è¾¾åˆ°æœ€é«˜æ•ˆç‡ã€‚ å¦‚æœä½ ç¢°å·§ä½¿ç”¨äº†ä¸€ä¸ªå¸¸æ•°æ—¶é—´çš„spliceçš„åŒºé—´å½¢å¼æ¯”å¸¸æ•°æ—¶é—´çš„sizeä¼˜å…ˆçº§æ›´é«˜çš„listå®ç°ï¼Œè°ƒç”¨emptyæ¯”è°ƒç”¨sizeæ›´å¥½ï¼Œå› ä¸ºemptyæ€»æ˜¯å¸¸æ•°æ—¶é—´æ“ä½œã€‚ ","date":"2023-07-24","objectID":"/posts/clause_4/:3:0","tags":["draft"],"title":"Effective STL [4] | ç”¨emptyæ¥ä»£æ›¿æ£€æŸ¥size()æ˜¯å¦ä¸º0","uri":"/posts/clause_4/"},{"categories":["draft"],"content":"STL vector å’Œ listçš„empty åŠ size å®ç°æºç  vector // vector size_type size() const _GLIBCXX_NOEXCEPT { return size_type(end() - begin()); } bool empty() const _GLIBCXX_NOEXCEPT { return begin() == end(); } list // list /** Returns the number of elements in the %list. */ size_type size() const _GLIBCXX_NOEXCEPT { return _M_node_count(); } // return the stored size size_t _M_node_count() const { return this-\u003e_M_get_size(); } // size() è°ƒç”¨ _M_get_size size_t _M_get_size() const { return _M_impl._M_node._M_size; } // [23.2.2.2] capacity /** * Returns true if the %list is empty. (Thus begin() would equal * end().) */ _GLIBCXX_NODISCARD bool empty() const _GLIBCXX_NOEXCEPT { return this-\u003e_M_impl._M_node._M_next == \u0026this-\u003e_M_impl._M_node; } ","date":"2023-07-24","objectID":"/posts/clause_4/:4:0","tags":["draft"],"title":"Effective STL [4] | ç”¨emptyæ¥ä»£æ›¿æ£€æŸ¥size()æ˜¯å¦ä¸º0","uri":"/posts/clause_4/"},{"categories":["C++"],"content":"æ‹·è´å¯¹è±¡æ˜¯STLçš„æ–¹å¼ å½“ä¸€ä¸ªå¯¹è±¡è¿›å…¥ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒå·²ç»ä¸æ˜¯ä½ æ·»åŠ ï¼ˆinsertæˆ–push_backç­‰ï¼‰çš„é‚£ä¸ªå¯¹è±¡äº†ï¼Œè¿›å…¥å®¹å™¨çš„æ˜¯ä½ æŒ‡å®šçš„å¯¹è±¡çš„æ‹·è´ï¼› å½“ä»å®¹å™¨ä¸­å–å‡ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ‰€å¾—åˆ°çš„ä¹Ÿä¸æ˜¯å®¹å™¨é‡Œçš„å¯¹è±¡ï¼› å¦‚æœä»vectorã€stringæˆ–dequeä¸­æ’å…¥æˆ–åˆ é™¤äº†ä»€ä¹ˆï¼Œç°æœ‰çš„å®¹å™¨å…ƒç´ ä¼šç§»åŠ¨ï¼ˆæ‹·è´ï¼‰ å¦‚æœä½¿ç”¨äº†ä»»ä½•æ’åºç®—æ³•ï¼šnext_permutationæˆ–è€…previous_permutationï¼› removeã€uniqueæˆ–å®ƒä»¬çš„åŒç±»ï¼› rotateæˆ–reverseç­‰ï¼Œå¯¹è±¡ä¼šç§»åŠ¨ï¼ˆæ‹·è´ï¼‰ æ‹·è¿›å»ï¼Œæ‹·å‡ºæ¥ã€‚è¿™å°±æ˜¯STLçš„æ–¹å¼. å› ä¸ºæ‹·è´ï¼Œè¿˜è§£å†³äº†ä¸€ä¸ª double free çš„ bugç‚¹å‡»æŸ¥çœ‹ ","date":"2023-07-24","objectID":"/posts/clause_3/:1:0","tags":["STL"],"title":"Effective STL [3] | ä½¿å®¹å™¨é‡Œå¯¹è±¡çš„æ‹·è´æ“ä½œè½»é‡è€Œæ­£ç¡®","uri":"/posts/clause_3/"},{"categories":["C++"],"content":"How Copy? å¦‚ä½•å®Œæˆæ‹·è´ Notice é€šè¿‡æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´å¤åˆ¶æ“ä½œç¬¦å®Œæˆï¼ ä¸€ä¸ªå¯¹è±¡é€šè¿‡ä½¿ç”¨å®ƒçš„æ‹·è´æˆå‘˜å‡½æ•°æ¥æ‹·è´ï¼Œç‰¹åˆ«æ˜¯å®ƒçš„æ‹·è´æ„é€ å‡½æ•°å’Œå®ƒçš„æ‹·è´èµ‹å€¼æ“ä½œç¬¦ã€‚ å¯¹äºç”¨æˆ·è‡ªå®šä¹‰ç±»ï¼Œæ¯”å¦‚Widgetï¼Œè¿™äº›å‡½æ•°ä¼ ç»Ÿä¸Šæ˜¯è¿™ä¹ˆå£°æ˜çš„ï¼š class Widget { public: ... Widget(const Widget\u0026); // æ‹·è´æ„é€ å‡½æ•° Widget\u0026 operator=(const Widget\u0026); // æ‹·è´èµ‹å€¼æ“ä½œç¬¦ ... }; å¦‚æœä½ è‡ªå·±æ²¡æœ‰å£°æ˜è¿™äº›å‡½æ•°ï¼Œä½ çš„ç¼–è¯‘å™¨å§‹ç»ˆä¼šä¸ºä½ å£°æ˜å®ƒä»¬ã€‚ æ‹·è´å†…å»ºç±»å‹ï¼ˆæ¯”å¦‚intã€æŒ‡é’ˆç­‰ï¼‰ä¹Ÿå§‹ç»ˆæ˜¯é€šè¿‡ç®€å•åœ°æ‹·è´ä»–ä»¬çš„å†…åœ¨æ¯”ç‰¹æ¥å®Œæˆçš„ã€‚ï¼ˆè¯·å‚è€ƒã€ŠEffective C++ã€‹ä¸­ï¼Œæ¡æ¬¾11å’Œ27ä¸“æ³¨äºè¿™äº›å‡½æ•°çš„è¡Œä¸ºã€‚ï¼‰ ","date":"2023-07-24","objectID":"/posts/clause_3/:2:0","tags":["STL"],"title":"Effective STL [3] | ä½¿å®¹å™¨é‡Œå¯¹è±¡çš„æ‹·è´æ“ä½œè½»é‡è€Œæ­£ç¡®","uri":"/posts/clause_3/"},{"categories":["C++"],"content":"æ‹·è´å¸¦æ¥çš„é—®é¢˜ æ€§èƒ½ç“¶é¢ˆ æ‹·è´ä¼šå¯¼è‡´æŠŠå¯¹è±¡æ”¾è¿›å®¹å™¨ä¹Ÿä¼šè¢«è¯æ˜ä¸ºæ˜¯ä¸€ä¸ªæ€§èƒ½ç“¶é¢ˆã€‚ å®¹å™¨ä¸­ç§»åŠ¨è¶Šå¤šçš„ä¸œè¥¿ï¼Œä½ å°±ä¼šåœ¨æ‹·è´ä¸Šæµªè´¹è¶Šå¤šçš„å†…å­˜å’Œæ—¶é’Ÿå‘¨æœŸã€‚ åˆ‡ç‰‡åˆ†å‰² å½“ç„¶ç”±äºç»§æ‰¿çš„å­˜åœ¨ï¼Œæ‹·è´ä¼šå¯¼è‡´åˆ†å‰²ã€‚ å¦‚æœä»¥åŸºç±»å¯¹è±¡å»ºç«‹ä¸€ä¸ªå®¹å™¨ï¼Œè€Œä½ è¯•å›¾æ’å…¥æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œé‚£ä¹ˆå½“å¯¹è±¡ï¼ˆé€šè¿‡åŸºç±»çš„æ‹·è´æ„é€ å‡½æ•°ï¼‰æ‹·å…¥å®¹å™¨çš„æ—¶å€™å¯¹è±¡çš„æ´¾ç”Ÿéƒ¨åˆ†ä¼šè¢«åˆ é™¤ï¼š vector\u003cWidget\u003e randy; class SpecialWidget: public Widget {...}; // SpecialWidgetä»ä¸Šé¢çš„Widgetæ´¾ç”Ÿ SpecialWidget sw; randy.push_back(sw); // swè¢«å½“ä½œåŸºç±»å¯¹è±¡æ‹·å…¥randyï¼Œå½“æ‹·è´æ—¶å®ƒçš„ç‰¹æ®Šéƒ¨åˆ†ä¸¢å¤±äº† åˆ†å‰²é—®é¢˜æš—ç¤ºäº†æŠŠä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡æ’å…¥åŸºç±»å¯¹è±¡çš„å®¹å™¨å‡ ä¹æ€»æ˜¯é”™çš„ã€‚ å¦‚æœä½ å¸Œæœ›ç»“æœå¯¹è±¡è¡¨ç°ä¸ºæ´¾ç”Ÿç±»å¯¹è±¡ï¼Œæ¯”å¦‚ï¼Œè°ƒç”¨æ´¾ç”Ÿç±»çš„è™šå‡½æ•°ç­‰ï¼Œæ€»æ˜¯é”™çš„ã€‚ ","date":"2023-07-24","objectID":"/posts/clause_3/:3:0","tags":["STL"],"title":"Effective STL [3] | ä½¿å®¹å™¨é‡Œå¯¹è±¡çš„æ‹·è´æ“ä½œè½»é‡è€Œæ­£ç¡®","uri":"/posts/clause_3/"},{"categories":["C++"],"content":"è§£å†³ ä¸€ä¸ªä½¿æ‹·è´æ›´é«˜æ•ˆã€æ­£ç¡®è€Œä¸”å¯¹åˆ†å‰²é—®é¢˜å…ç–«çš„ç®€å•çš„æ–¹å¼æ˜¯å»ºç«‹æŒ‡é’ˆçš„å®¹å™¨è€Œä¸æ˜¯å¯¹è±¡çš„å®¹å™¨ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸æ˜¯å»ºç«‹ä¸€ä¸ªWidgetçš„å®¹å™¨ï¼Œå»ºç«‹ä¸€ä¸ªWidget*çš„å®¹å™¨ã€‚ æ‹·è´æŒ‡é’ˆå¾ˆå¿«ï¼Œå®ƒæ€»æ˜¯ä¸¥å¯†åœ°åšä½ å¸Œæœ›çš„ï¼ˆæŒ‡é’ˆæ‹·è´æ¯”ç‰¹ï¼‰ï¼Œè€Œä¸”å½“æŒ‡é’ˆæ‹·è´æ—¶æ²¡æœ‰åˆ†å‰²ï¼Œå°±æ˜¯intç±»å‹çš„åœ°å€ã€‚ ä½†æ˜¯ä¸€å®šè¦è®°å¾—åœ¨é”€æ¯å®¹å™¨çš„æ—¶å€™ï¼Œä½¿ç”¨delete é”€æ¯é‡Œé¢ä¿å­˜çš„æ¯ä¸ªæŒ‡é’ˆã€‚è€Œä¸”ä¸€å®šè¦å®šä¹‰å¯¹è±¡çš„æ·±æ‹·è´æ„é€ å‡½æ•°å’Œæ·±æ‹·è´æ‹·è´èµ‹å€¼æ“ä½œç¬¦ï¼Œå¦åˆ™delete çš„æ—¶å€™ä¼šæŠ¥é”™ã€‚ ","date":"2023-07-24","objectID":"/posts/clause_3/:4:0","tags":["STL"],"title":"Effective STL [3] | ä½¿å®¹å™¨é‡Œå¯¹è±¡çš„æ‹·è´æ“ä½œè½»é‡è€Œæ­£ç¡®","uri":"/posts/clause_3/"},{"categories":["C++"],"content":"å’Œæ•°ç»„å¯¹æ¯”ï¼ŒSTLå®¹å™¨æ›´æ–‡æ˜ STLå®¹å™¨åªå»ºç«‹ï¼ˆé€šè¿‡æ‹·è´ï¼‰ä½ éœ€è¦çš„ä¸ªæ•°çš„å¯¹è±¡ï¼Œè€Œä¸”å®ƒä»¬åªåœ¨ä½ æŒ‡å®šçš„æ—¶å€™åšã€‚ STLè¿›è¡Œäº†å¤§é‡æ‹·è´ï¼Œä½†å®ƒé€šå¸¸è®¾è®¡ä¸ºé¿å…ä¸å¿…è¦çš„å¯¹è±¡æ‹·è´ï¼Œå®é™…ä¸Šï¼Œå®ƒä¹Ÿè¢«å®ç°ä¸ºé¿å…ä¸å¿…è¦çš„å¯¹è±¡æ‹·è´ã€‚ æ•°ç»„åœ¨å£°æ˜çš„æ—¶å€™ï¼Œä¼šé»˜è®¤å…ˆæ„é€ å¥½æ¯ä¸ªå…ƒç´ ï¼›STLå®¹å™¨å¯ä»¥å®ç°åŠ¨æ€æ‰©å±• Widget randy[maxNumWidgets]; // å»ºç«‹ä¸€ä¸ªå¤§å°ä¸ºmaxNumWidgetsçš„Widgetsæ•°ç»„ // é»˜è®¤æ„é€ æ¯ä¸ªå…ƒç´  å³ä½¿åªä½¿ç”¨å…¶ä¸­çš„ä¸€äº›æˆ–è€…æˆ‘ä»¬ç«‹åˆ»ä½¿ç”¨ä»æŸä¸ªåœ°æ–¹è·å–ï¼ˆæ¯”å¦‚ï¼Œä¸€ä¸ªæ–‡ä»¶ï¼‰çš„å€¼è¦†ç›–æ¯ä¸ªé»˜è®¤æ„é€ çš„å€¼ï¼Œè¿™ä¹Ÿå¾—æ„é€ maxNumWidgetsä¸ªWidgetå¯¹è±¡ã€‚ ä½¿ç”¨STLæ¥ä»£æ›¿æ•°ç»„ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å¢é•¿çš„vectorï¼Œå°±æ˜¯åŠ¨æ€æ•°ç»„çš„æ¦‚å¿µï¼š vector\u003cWidget\u003e randy; // å»ºç«‹ä¸€ä¸ª0ä¸ªWidgetå¯¹è±¡çš„vector // éœ€è¦çš„æ—¶å€™å¯ä»¥æ‰©å±• å»ºç«‹ä¸€ä¸ªå¯ä»¥è¶³å¤ŸåŒ…å«maxNumWidgetsä¸ªWidgetçš„ç©ºvectorï¼Œä½†ä¸å»æ„é€ Widgetï¼Œéœ€è¦æ—¶å†æ„é€ ï¼š vector\u003cWidget\u003e randy; randy.reserve(maxNumWidgets); // reserveçš„è¯¦ç»†ä¿¡æ¯è¯·å‚è§æ¡æ¬¾14 å³ä¾¿éœ€è¦çŸ¥é“STLå®¹å™¨ä½¿ç”¨äº†æ‹·è´ï¼Œä½†æ˜¯åˆ«å¿˜äº†ä¸€ä¸ªäº‹å®ï¼šæ¯”èµ·æ•°ç»„å®ƒä»¬ä»ç„¶æ˜¯ä¸€ä¸ªè¿›æ­¥ã€‚ ","date":"2023-07-24","objectID":"/posts/clause_3/:5:0","tags":["STL"],"title":"Effective STL [3] | ä½¿å®¹å™¨é‡Œå¯¹è±¡çš„æ‹·è´æ“ä½œè½»é‡è€Œæ­£ç¡®","uri":"/posts/clause_3/"},{"categories":["C++"],"content":"STL å®¹å™¨ç‰¹ç‚¹ STLæ˜¯å»ºç«‹åœ¨æ³›åŒ–ä¹‹ä¸Šçš„ æ•°ç»„æ³›åŒ–ä¸ºå®¹å™¨ï¼Œå‚æ•°åŒ–äº†æ‰€åŒ…å«çš„å¯¹è±¡çš„ç±»å‹ å‡½æ•°æ³›åŒ–ä¸ºç®—æ³•ï¼Œå‚æ•°åŒ–äº†æ‰€ç”¨çš„è¿­ä»£å™¨çš„ç±»å‹ æŒ‡é’ˆæ³›åŒ–ä¸ºè¿­ä»£å™¨ï¼Œå‚æ•°åŒ–äº†æ‰€æŒ‡å‘çš„å¯¹è±¡çš„ç±»å‹ ç‹¬ç«‹çš„å®¹å™¨ç±»å‹æ³›åŒ–ä¸ºåºåˆ—æˆ–å…³è”å®¹å™¨ï¼Œè€Œä¸”ç±»ä¼¼çš„å®¹å™¨æ‹¥æœ‰ç±»ä¼¼çš„åŠŸèƒ½ã€‚ æ ‡å‡†çš„å†…å­˜ç›¸é‚»å®¹å™¨éƒ½æä¾›éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œæ ‡å‡†çš„åŸºäºèŠ‚ç‚¹çš„å®¹å™¨éƒ½æä¾›åŒå‘è¿­ä»£å™¨ã€‚ åºåˆ—å®¹å™¨æ”¯æŒpush_frontæˆ–push_backï¼Œä½†å…³è”å®¹å™¨ä¸æ”¯æŒã€‚å…³è”å®¹å™¨æä¾›å¯¹æ•°æ—¶é—´å¤æ‚åº¦çš„lower_boundã€upper_boundå’Œequal_rangeæˆå‘˜å‡½æ•°ï¼Œä½†åºåˆ—å®¹å™¨å´æ²¡æœ‰ã€‚ ä¸¾ä¾‹: æ ‡å‡†åºåˆ—å®¹å™¨: vectorã€stringã€deque å’Œ list æ ‡å‡†å…³è”å®¹å™¨: setã€multisetã€map å’Œ multimap ","date":"2023-07-20","objectID":"/posts/clause_2/:1:0","tags":["STL"],"title":"Effective STL [2] | å°å¿ƒå¯¹â€œå®¹å™¨æ— å…³ä»£ç â€çš„å¹»æƒ³","uri":"/posts/clause_2/"},{"categories":["C++"],"content":"æ¨è¡Œè‡ªå·±çš„å®¹å™¨ å¾ˆå¤šäººä¼šè¯•å›¾åœ¨ä»–ä»¬çš„è½¯ä»¶ä¸­æ³›åŒ–å®¹å™¨çš„ä¸åŒï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®¹å™¨çš„ç‰¹æ®Šæ€§ç¼–ç¨‹ï¼Œä»–ä»¬ä¼šæƒ³åœ¨vector ä¸­ä½¿ç”¨ deque æˆ–è€… listçš„ç‰¹æ€§ï¼Œè¿™å¾€å¾€ä¼šå¸¦æ¥éº»çƒ¦ã€‚ æ¯”å¦‚ï¼š åªæœ‰åºåˆ—å®¹å™¨æ”¯æŒpush_frontæˆ–push_backï¼Œåªæœ‰å…³è”å®¹å™¨æ”¯æŒcountå’Œlower_bound å³ä¾¿æ˜¯ insertå’Œeraseè¿™æ ·çš„æ“ä½œåœ¨åç§°å’Œè¯­ä¹‰ä¸Šä¹Ÿæœ‰å·®åˆ« å½“æŠŠå¯¹è±¡æ’å…¥åºåˆ—å®¹å™¨ä¸­ï¼Œè¯¥å¯¹è±¡ä¼šä¿ç•™åœ¨ä½ æ”¾ç½®çš„ä½ç½®ä¸Š; å½“ä½ æŠŠå¯¹è±¡æ’å…¥åˆ°ä¸€ä¸ªå…³è”å®¹å™¨ä¸­ï¼Œå®¹å™¨ä¼šæŒ‰ç…§æ’åˆ—é¡ºåºæŠŠå¯¹è±¡ç§»åˆ°å®ƒåº”è¯¥åœ¨çš„ä½ç½®; åœ¨åºåˆ—å®¹å™¨ä¸Šç”¨ä¸€ä¸ªè¿­ä»£å™¨ä½œä¸ºå‚æ•°è°ƒç”¨ eraseï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ï¼›åœ¨å…³è”å®¹å™¨ä¸Šä»€ä¹ˆéƒ½ä¸è¿”å›ã€‚ å®¹å™¨èƒ½åŠ›çš„äº¤é›† å¦‚æœä½ æƒ³å†™ä¸€ä¸ªå¯ä»¥ç”¨åœ¨å¸¸ç”¨åºåˆ—å®¹å™¨ä¸Šçš„ä»£ç â€”â€” åŒ…å«vector, dequeå’Œlistã€‚ä½ å¿…é¡»ä½¿ç”¨å®ƒä»¬èƒ½åŠ›çš„äº¤é›†æ¥ç¼–å†™ã€‚ ä½†è¦è€ƒè™‘å‡ ç‚¹ï¼š dequeå’Œlistä¸æ”¯æŒreserveæˆ–capacity listä¸æ”¯æŒoperator[]æ“ä½œï¼Œä¸”å—é™äºåŒå‘è¿­ä»£å™¨çš„æ€§èƒ½ ä¸èƒ½ä½¿ç”¨éœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨çš„ç®—æ³•ï¼ŒåŒ…æ‹¬sortï¼Œstable_sortï¼Œpartial_sortå’Œnth_element å¦‚æœæƒ³æ”¯æŒvectorçš„è§„åˆ™ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨push_frontå’Œpop_front vectorå’Œdequeéƒ½ä¼šä½¿spliceå’Œæˆå‘˜å‡½æ•°æ–¹å¼çš„sortå¤±è´¥ å› ä¸ºdeque::insertä¼šä½¿æ‰€æœ‰è¿­ä»£å™¨å¤±æ•ˆï¼Œè€Œä¸”å› ä¸ºç¼ºå°‘capacityï¼Œvector::insertä¹Ÿå¿…é¡»å‡è®¾ä½¿æ‰€æœ‰æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆï¼Œè€Œdequeæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨è¿­ä»£å™¨å¤±æ•ˆçš„æƒ…å†µä¸‹, æŒ‡é’ˆå’Œå¼•ç”¨ä»ç„¶æœ‰æ•ˆçš„ä¸œè¥¿ ä¸èƒ½æŠŠå®¹å™¨é‡Œçš„æ•°æ®ä¼ é€’ç»™Cé£æ ¼çš„ç•Œé¢ï¼Œåªæœ‰vectoræ”¯æŒè¿™ä¹ˆåš ä¸èƒ½ç”¨boolä½œä¸ºä¿å­˜çš„å¯¹è±¡æ¥å®ä¾‹åŒ–ä½ çš„å®¹å™¨ï¼Œå› ä¸ºvector å¹¶éæ€»è¡¨ç°ä¸ºä¸€ä¸ªvectorï¼Œå®é™…ä¸Šå®ƒå¹¶æ²¡æœ‰çœŸæ­£ä¿å­˜boolå€¼ã€‚ ä¸èƒ½æœŸæœ›äº«å—åˆ°listçš„å¸¸æ•°æ—¶é—´å¤æ‚åº¦çš„æ’å…¥å’Œåˆ é™¤ï¼Œvectorå’Œdequeçš„æ’å…¥å’Œåˆ é™¤æ“ä½œæ˜¯çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„ æ‰€ä»¥ï¼ŒçœŸæ­£å¼€å‘æ—¶ï¼Œå¦‚æœéƒ½è€ƒè™‘åˆ°ä¸Šé¢å‡ ç‚¹ï¼Œé‚£æƒ³å¼€å‘çš„å®¹å™¨åªå‰©ä¸‹ä¸€ä¸ª\"æ³›åŒ–çš„åºåˆ—å®¹å™¨\"ï¼Œä½†æ˜¯ä½ ä¸èƒ½è°ƒç”¨reserveã€capacityã€operator[]ã€push_frontã€pop_frontã€spliceæˆ–ä»»ä½•éœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨çš„ç®—æ³•ï¼›è°ƒç”¨insertå’Œeraseä¼šæœ‰çº¿æ€§æ—¶é—´å¤æ‚åº¦è€Œä¸”ä¼šä½¿æ‰€æœ‰è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆï¼›è€Œä¸”ä¸èƒ½å…¼å®¹Cé£æ ¼çš„ç•Œé¢ï¼Œä¸èƒ½å­˜å‚¨boolã€‚ å¦‚æœä½ æ”¾å¼ƒäº†åºåˆ—å®¹å™¨ï¼ŒæŠŠä»£ç æ”¹ä¸ºåªèƒ½å’Œä¸åŒçš„å…³è”å®¹å™¨é…åˆï¼Œè¿™æƒ…å†µå¹¶æ²¡æœ‰ä»€ä¹ˆæ”¹å–„ã€‚ è¦åŒæ—¶å…¼å®¹setå’Œmapå‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºsetä¿å­˜å•ä¸ªå¯¹è±¡ï¼Œè€Œmapä¿å­˜å¯¹è±¡å¯¹ã€‚ ç”šè‡³è¦åŒæ—¶å…¼å®¹setå’Œmultisetï¼ˆæˆ–mapå’Œmultimapï¼‰ä¹Ÿæ˜¯å¾ˆéš¾çš„ã€‚ set/mapçš„insertæˆå‘˜å‡½æ•°åªè¿”å›ä¸€ä¸ªå€¼ï¼Œå’Œä»–ä»¬çš„multiå…„å¼Ÿçš„è¿”å›ç±»å‹ä¸åŒï¼Œè€Œä¸”ä½ å¿…é¡»é¿å…å¯¹ä¸€ä¸ªä¿å­˜åœ¨å®¹å™¨ä¸­çš„å€¼çš„æ‹·è´ä»½æ•°ä½œå‡ºä»»ä½•å‡è®¾ã€‚ å¯¹äºmapå’Œmultimapï¼Œä½ å¿…é¡»é¿å…ä½¿ç”¨operator[]ï¼Œå› ä¸ºè¿™ä¸ªæˆå‘˜å‡½æ•°åªå­˜åœ¨äºmapä¸­ã€‚ ","date":"2023-07-20","objectID":"/posts/clause_2/:2:0","tags":["STL"],"title":"Effective STL [2] | å°å¿ƒå¯¹â€œå®¹å™¨æ— å…³ä»£ç â€çš„å¹»æƒ³","uri":"/posts/clause_2/"},{"categories":["C++"],"content":"å°è£… å¦‚æœæƒ³æ”¹å˜å®¹å™¨ç±»å‹ï¼Œå°±ä½¿ç”¨å°è£…ã€‚ Method 1: typedef ä¸€ç§æœ€ç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡è‡ªç”±åœ°å¯¹å®¹å™¨å’Œè¿­ä»£å™¨ç±»å‹ä½¿ç”¨typedef class Widget {...}; vector\u003cWidget\u003e vw; Widget bestWidget; ... // ç»™bestWidgetä¸€ä¸ªå€¼ vector\u003cWidget\u003e::iterator i = // å¯»æ‰¾å’ŒbestWidgetç›¸ç­‰çš„Widget find(vw.begin(), vw.end(), bestWidget); å¯ä»¥ç®€åŒ–ä¸Šè¿°å†™æ³• class Widget { ... }; typedef vector\u003cWidget\u003e WidgetContainer; typedef WidgetContainer::iterator WCIterator; WidgetContainer cw; Widget bestWidget; ... WCIterator i = find(cw.begin(), cw.end(), bestWidg å¦‚æœéœ€è¦åŠ ä¸Šç”¨æˆ·çš„allocatorï¼Œä¹Ÿç‰¹åˆ«æ–¹ä¾¿ã€‚ï¼ˆä¸€ä¸ªä¸å½±å“å¯¹è¿­ä»£å™¨/æŒ‡é’ˆ/å‚è€ƒçš„å¤±æ•ˆè§„åˆ™çš„æ”¹å˜ï¼‰ class Widget { ... }; template\u003ctypename T\u003e // å…³äºä¸ºä»€ä¹ˆè¿™é‡Œéœ€è¦ä¸€ä¸ªtemplate SpecialAllocator { ... }; // è¯·å‚è§æ¡æ¬¾10 typedef vector\u003cWidget, SpecialAllocator\u003cWidget\u003e \u003e WidgetContainer; typedef WidgetContainer::iterator WCIterator; WidgetContainer cw; // ä»ç„¶èƒ½ç”¨ Widget bestWidget; ... WCIterator i = find(cw.begin(), cw.end(), bestWidget); // ä»ç„¶èƒ½ç”¨ typedefåªæ˜¯å…¶å®ƒç±»å‹çš„åŒä¹‰å­—ï¼Œæ‰€ä»¥å®ƒæä¾›çš„çš„å°è£…æ˜¯çº¯çš„è¯æ³•ï¼ˆè¯‘æ³¨ï¼šä¸åƒ#defineæ˜¯åœ¨é¢„ç¼–è¯‘é˜¶æ®µæ›¿æ¢çš„ï¼‰ã€‚typedefå¹¶ä¸èƒ½é˜»æ­¢ç”¨æˆ·ä½¿ç”¨ï¼ˆæˆ–ä¾èµ–ï¼‰ä»»ä½•ä»–ä»¬ä¸åº”è¯¥ç”¨çš„ï¼ˆæˆ–ä¾èµ–çš„ï¼‰ã€‚ Method 2: class è¦é™åˆ¶å¦‚æœç”¨ä¸€ä¸ªå®¹å™¨ç±»å‹æ›¿æ¢äº†å¦ä¸€ä¸ªå®¹å™¨å¯èƒ½éœ€è¦ä¿®æ”¹çš„ä»£ç ï¼Œå°±éœ€è¦åœ¨ç±»ä¸­éšè—é‚£ä¸ªå®¹å™¨ï¼Œè€Œä¸”è¦é€šè¿‡ç±»çš„æ¥å£é™åˆ¶å®¹å™¨ç‰¹æ®Šä¿¡æ¯å¯è§æ€§çš„æ•°é‡ã€‚ æ¯”å¦‚éœ€è¦éšè— çœŸå®çš„å®¹å™¨ list å»ºç«‹å®¢æˆ·åˆ—è¡¨ï¼š class CustomerList { private: typedef list\u003cCustomer\u003e CustomerContainer; typedef CustomerContainer::iterator CCIterator; CustomerContainer customers; public: // é€šè¿‡è¿™ä¸ªæ¥å£ ... // é™åˆ¶listç‰¹æ®Šä¿¡æ¯çš„å¯è§æ€§ }; å¦‚æœä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä½ å‘ç°ä»åˆ—è¡¨çš„ä¸­éƒ¨æ’å…¥å’Œåˆ é™¤å®¢æˆ·å¹¶ä¸åƒä½ æƒ³è±¡çš„é‚£ä¹ˆé¢‘ç¹ï¼Œä»…ä»…éœ€è¦å¿«é€Ÿç¡®å®šå®¢æˆ·åˆ—è¡¨é¡¶éƒ¨çš„20%â€”â€”ä¸€ä¸ªä¸ºnth_elementç®—æ³•é‡èº«å®šåšçš„ä»»åŠ¡ã€‚ ä½†nth_elementéœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œä¸èƒ½å…¼å®¹listã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ çš„å®¢æˆ·\"list\"å¯èƒ½æ›´åº”è¯¥ç”¨\"vector\"æˆ–\"deque\"æ¥å®ç° å½“ä½ å†³å®šä½œè¿™ç§æ›´æ”¹çš„æ—¶å€™ï¼Œä½ ä»ç„¶å¿…é¡»æ£€æŸ¥æ¯ä¸ªCustomerListçš„æˆå‘˜å‡½æ•°å’Œæ¯ä¸ªå‹å…ƒï¼Œçœ‹çœ‹ä»–ä»¬å—å½±å“çš„ç¨‹åº¦ï¼ˆæ ¹æ®æ€§èƒ½å’Œè¿­ä»£å™¨/æŒ‡é’ˆ/å¼•ç”¨å¤±æ•ˆçš„æƒ…å†µç­‰ç­‰ï¼‰ã€‚ ä½†å¦‚æœä½ åšå¥½äº†å¯¹CustomerListåœ°å®ç°ç»†èŠ‚åšå¥½å°è£…çš„è¯ï¼Œé‚£å¯¹CustomerListçš„å®¢æˆ·çš„å½±å“å°†ä¼šå¾ˆå°ã€‚ ","date":"2023-07-20","objectID":"/posts/clause_2/:3:0","tags":["STL"],"title":"Effective STL [2] | å°å¿ƒå¯¹â€œå®¹å™¨æ— å…³ä»£ç â€çš„å¹»æƒ³","uri":"/posts/clause_2/"},{"categories":["C++"],"content":" quote é€‰æ‹©å®¹å™¨éœ€è¦æ³¨æ„çš„å‡ ä¸ªæ–¹é¢ ","date":"2023-07-19","objectID":"/posts/clause_1/:0:0","tags":["STL"],"title":"Effective STL [1] | ä»”ç»†é€‰æ‹©ä½ çš„å®¹å™¨","uri":"/posts/clause_1/"},{"categories":["C++"],"content":"è¿­ä»£å™¨ è¾“å…¥è¿­ä»£å™¨ æ¯ä¸ªè¿­ä»£ä½ç½®åªèƒ½è¢«è¯»1æ¬¡çš„åªè¯»è¿­ä»£å™¨ï¼Œé€šå¸¸è¡¨ç°ä¸º istream_iterator è¾“å‡ºè¿­ä»£å™¨ æ¯ä¸ªè¿­ä»£ä½ç½®åªèƒ½è¢«å†™1æ¬¡çš„åªå†™è¿­ä»£å™¨ï¼Œé€šå¸¸è¡¨ç°ä¸º ostream_iterator å‰å‘è¿­ä»£å™¨ æœ‰è¾“å…¥å’Œè¾“å‡ºè¿­ä»£å™¨çš„èƒ½åŠ›ï¼Œå¯ä»¥åå¤è¯»å†™1ä¸ªä½ç½®ï¼Œä¸æ”¯æŒ operatorâ€“ï¼Œå¯ä»¥é«˜æ•ˆåœ°å‘å‰ç§»åŠ¨ä»»æ„æ¬¡æ•° æ•£åˆ—å®¹å™¨çš„ä¸€ç§è®¾è®¡å¯ä»¥äº§ç”Ÿå‰å‘è¿­ä»£å™¨ï¼› å•é“¾è¡¨å®¹å™¨ä¹Ÿæä¾›å‰å‘è¿­ä»£å™¨ åŒå‘è¿­ä»£å™¨ åƒå‰å‘è¿­ä»£å™¨ä¸€æ ·ï¼Œåé€€å¾ˆå®¹æ˜“ã€‚æ ‡å‡†å…³è”å®¹å™¨éƒ½æä¾›åŒå‘è¿­ä»£å™¨ï¼Œlistä¹Ÿæœ‰ éšæœºè®¿é—®è¿­ä»£å™¨ å¯ä»¥åšåŒå‘è¿­ä»£å™¨ä¸€æ ·çš„äº‹æƒ…ï¼Œä½†ä¹Ÿæä¾›â€œè¿­ä»£å™¨ç®—æœ¯â€ï¼Œå³è¿­ä»£å™¨æœ‰ä¸€æ­¥å‘å‰æˆ–å‘åè·³çš„èƒ½åŠ›ã€‚ vectorã€string å’Œ deque éƒ½æä¾›éšæœºè®¿é—®è¿­ä»£å™¨ã€‚ æŒ‡é’ˆæ•°ç»„çš„æŒ‡é’ˆå¯ä»¥ä½œä¸ºæ•°ç»„çš„éšæœºè®¿é—®è¿­ä»£å™¨ã€‚ ","date":"2023-07-19","objectID":"/posts/clause_1/:1:0","tags":["STL"],"title":"Effective STL [1] | ä»”ç»†é€‰æ‹©ä½ çš„å®¹å™¨","uri":"/posts/clause_1/"},{"categories":["C++"],"content":"å®¹å™¨ STLæœ‰è¿­ä»£å™¨ã€ç®—æ³•å’Œå‡½æ•°å¯¹è±¡ï¼Œä½†å¯¹äºå¤§å¤šæ•°C++ç¨‹åºå‘˜ï¼Œå®¹å™¨æ˜¯æœ€çªå‡ºçš„ã€‚ å®ƒä»¬æ¯”æ•°ç»„æ›´å¼ºå¤§æ›´çµæ´»ï¼Œå¯ä»¥åŠ¨æ€å¢é•¿ï¼ˆä¹Ÿå¸¸æ˜¯ç¼©å‡ï¼‰ï¼Œå¯ä»¥ç®¡ç†å±äºå®ƒä»¬è‡ªå·±çš„å†…å­˜ï¼Œå¯ä»¥è·Ÿè¸ªå®ƒä»¬æ‹¥æœ‰çš„å¯¹è±¡æ•°ç›®ï¼Œå¯ä»¥é™åˆ¶å®ƒä»¬æ”¯æŒæ“ä½œçš„ç®—æ³•å¤æ‚åº¦ç­‰ç­‰ã€‚ åˆ†ç±» ç±»åˆ« è¯´æ˜ æ ‡å‡†STLåºåˆ—å®¹å™¨ vectorã€stringã€dequeå’Œlist æ ‡å‡†STLå…³è”å®¹å™¨ setã€multisetã€mapå’Œmultimap éæ ‡å‡†åºåˆ—å®¹å™¨slistå’Œrope slistæ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œropeæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé‡å‹å­—ç¬¦ä¸²ã€‚(â€œç»³å­(rope)â€œæ˜¯é‡å‹çš„\"çº¿(string)â€) éæ ‡å‡†å…³è”å®¹å™¨ hash_setã€hash_multisetã€hash_mapå’Œhash_multimap vector å¯ä»¥ä½œä¸ºstringçš„æ›¿ä»£å“ vectorä½œä¸ºæ ‡å‡†å…³è”å®¹å™¨çš„æ›¿ä»£å“ æœ‰æ—¶å€™vectorå¯ä»¥åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½è¡¨ç°å¾—æ¯”æ ‡å‡†å…³è”å®¹å™¨å¥½ æ ‡å‡†éSTLå®¹å™¨ åŒ…æ‹¬æ•°ç»„ã€bitsetã€valarrayã€stackã€queueå’Œpriority_queue ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•°ç»„å¯ä»¥å’ŒSTLç®—æ³•é…åˆï¼Œå› ä¸ºæŒ‡é’ˆå¯ä»¥å½“ä½œæ•°ç»„çš„è¿­ä»£å™¨ä½¿ç”¨ vectorã€listå’Œdequeæä¾›ç»™ç¨‹åºå‘˜ä¸åŒçš„å¤æ‚åº¦ï¼Œå› æ­¤åº”è¯¥è¿™ä¹ˆç”¨ï¼š vectoræ˜¯ä¸€ç§å¯ä»¥é»˜è®¤ä½¿ç”¨çš„åºåˆ—ç±»å‹ å½“å¾ˆé¢‘ç¹åœ°å¯¹åºåˆ—ä¸­éƒ¨è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ—¶åº”è¯¥ç”¨list å½“å¤§éƒ¨åˆ†æ’å…¥å’Œåˆ é™¤å‘ç”Ÿåœ¨åºåˆ—çš„å¤´æˆ–å°¾æ—¶å¯ä»¥é€‰æ‹©dequeè¿™ç§æ•°æ®ç»“æ„ è¿ç»­å†…å­˜å®¹å™¨å’ŒåŸºäºèŠ‚ç‚¹çš„å®¹å™¨çš„åŒºåˆ« è¿ç»­å†…å­˜å®¹å™¨ï¼ˆä¹Ÿå«åšåŸºäºæ•°ç»„çš„å®¹å™¨ï¼‰ åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªï¼ˆåŠ¨æ€åˆ†é…ï¼‰çš„å†…å­˜å—ä¸­ä¿å­˜å®ƒä»¬çš„å…ƒç´ ã€‚ å¦‚æœä¸€ä¸ªæ–°å…ƒç´ è¢«æŸ¥å…¥æˆ–è€…å·²å­˜å…ƒç´ è¢«åˆ é™¤ï¼Œå…¶ä»–åœ¨åŒä¸€ä¸ªå†…å­˜å—çš„å…ƒç´ å°±å¿…é¡»å‘ä¸Šæˆ–è€…å‘ä¸‹ç§»åŠ¨æ¥ä¸ºæ–°å…ƒç´ æä¾›ç©ºé—´æˆ–è€…å¡«å……åŸæ¥è¢«åˆ é™¤çš„å…ƒç´ æ‰€å çš„ç©ºé—´ã€‚ è¿™ç§ç§»åŠ¨å½±å“äº†æ•ˆç‡å’Œå¼‚å¸¸å®‰å…¨ã€‚ æ ‡å‡†çš„è¿ç»­å†…å­˜å®¹å™¨æ˜¯vectorã€stringå’Œdequeã€‚ éæ ‡å‡†çš„ropeä¹Ÿæ˜¯è¿ç»­å†…å­˜å®¹å™¨ã€‚ åŸºäºèŠ‚ç‚¹çš„å®¹å™¨ åœ¨æ¯ä¸ªå†…å­˜å—ï¼ˆåŠ¨æ€åˆ†é…ï¼‰ä¸­åªä¿å­˜ä¸€ä¸ªå…ƒç´ ã€‚ å®¹å™¨å…ƒç´ çš„æ’å…¥æˆ–åˆ é™¤åªå½±å“æŒ‡å‘èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œè€Œä¸æ˜¯èŠ‚ç‚¹è‡ªå·±çš„å†…å®¹ã€‚ æ‰€ä»¥å½“æœ‰ä¸œè¥¿æ’å…¥æˆ–åˆ é™¤æ—¶ï¼Œå…ƒç´ å€¼ä¸éœ€è¦ç§»åŠ¨ã€‚ è¡¨ç°ä¸ºé“¾è¡¨çš„å®¹å™¨â€”â€”æ¯”å¦‚listå’Œslistâ€”â€”æ˜¯åŸºäºèŠ‚ç‚¹çš„ï¼Œæ‰€æœ‰çš„æ ‡å‡†å…³è”å®¹å™¨ä¹Ÿæ˜¯ï¼ˆå®ƒä»¬çš„å…¸å‹å®ç°æ˜¯å¹³è¡¡æ ‘ï¼‰ã€‚ éæ ‡å‡†çš„æ•£åˆ—å®¹å™¨ä½¿ç”¨ä¸åŒçš„åŸºäºèŠ‚ç‚¹çš„å®ç°ã€‚ ","date":"2023-07-19","objectID":"/posts/clause_1/:2:0","tags":["STL"],"title":"Effective STL [1] | ä»”ç»†é€‰æ‹©ä½ çš„å®¹å™¨","uri":"/posts/clause_1/"},{"categories":["C++"],"content":"å¦‚ä½•é€‰æ‹©å®¹å™¨? ä½ éœ€è¦â€œå¯ä»¥åœ¨å®¹å™¨çš„ä»»æ„ä½ç½®æ’å…¥ä¸€ä¸ªæ–°å…ƒç´ â€çš„èƒ½åŠ›å—ï¼Ÿ å¦‚æœæ˜¯ï¼Œä½ éœ€è¦åºåˆ—å®¹å™¨ï¼Œå…³è”å®¹å™¨åšä¸åˆ°ã€‚ ä½ å…³å¿ƒå…ƒç´ åœ¨å®¹å™¨ä¸­çš„é¡ºåºå—ï¼Ÿ å¦‚æœä¸ï¼Œæ•£åˆ—å®¹å™¨å°±æ˜¯å¯è¡Œçš„é€‰æ‹©ã€‚å¦åˆ™ï¼Œä½ è¦é¿å…ä½¿ç”¨æ•£åˆ—å®¹å™¨ã€‚ å¿…é¡»ä½¿ç”¨æ ‡å‡†C++ä¸­çš„å®¹å™¨å—? å¦‚æœæ˜¯ï¼Œå°±å¯ä»¥é™¤å»æ•£åˆ—å®¹å™¨ã€slistå’Œropeã€‚ ä½ éœ€è¦å“ªä¸€ç±»è¿­ä»£å™¨ï¼Ÿ å¦‚æœå¿…é¡»æ˜¯éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œåœ¨æŠ€æœ¯ä¸Šä½ å°±åªèƒ½é™äºvectorã€dequeå’Œstringï¼Œä½†ä½ ä¹Ÿå¯èƒ½ä¼šè€ƒè™‘ropeã€‚ å¦‚æœéœ€è¦åŒå‘è¿­ä»£å™¨ï¼Œä½ å°±ç”¨ä¸äº†slist å’Œæ•£åˆ—å®¹å™¨çš„ä¸€èˆ¬å®ç°ã€‚ å½“æ’å…¥æˆ–è€…åˆ é™¤æ•°æ®æ—¶ï¼Œæ˜¯å¦éå¸¸åœ¨æ„å®¹å™¨å†…ç°æœ‰å…ƒç´ çš„ç§»åŠ¨ï¼Ÿ å¦‚æœæ˜¯ï¼Œä½ å°±å¿…é¡»æ”¾å¼ƒè¿ç»­å†…å­˜å®¹å™¨ã€‚ å®¹å™¨ä¸­çš„æ•°æ®çš„å†…å­˜å¸ƒå±€éœ€è¦å…¼å®¹Cå—ï¼Ÿ å¦‚æœæ˜¯ï¼Œä½ å°±åªèƒ½ç”¨vectorã€‚ æŸ¥æ‰¾é€Ÿåº¦å¾ˆé‡è¦å—ï¼Ÿ å¦‚æœæ˜¯ï¼Œä½ å°±åº”è¯¥çœ‹çœ‹æ•£åˆ—å®¹å™¨ï¼Œæ’åºçš„vectorå’Œæ ‡å‡†çš„å…³è”å®¹å™¨â€”â€”å¤§æ¦‚æ˜¯è¿™ä¸ªé¡ºåºã€‚ ä½ ä»‹æ„å¦‚æœå®¹å™¨çš„åº•å±‚ä½¿ç”¨äº†å¼•ç”¨è®¡æ•°å—ï¼Ÿ å¦‚æœæ˜¯ï¼Œä½ å°±å¾—é¿å¼€stringï¼Œå› ä¸ºå¾ˆå¤šstringçš„å®ç°æ˜¯ç”¨å¼•ç”¨è®¡æ•°ã€‚ ä½ ä¹Ÿä¸èƒ½ç”¨ropeï¼Œå› ä¸ºæƒå¨çš„ropeå®ç°æ˜¯åŸºäºå¼•ç”¨è®¡æ•°çš„ã€‚ äºæ˜¯ä½ å¾—é‡æ–°å®¡æ ¸ä½ çš„stringï¼Œä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨vector ä½ éœ€è¦æ’å…¥å’Œåˆ é™¤çš„äº‹åŠ¡æ€§è¯­ä¹‰å—ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œä½ éœ€è¦æœ‰å¯é åœ°å›é€€æ’å…¥å’Œåˆ é™¤çš„èƒ½åŠ›å—ï¼Ÿ å¦‚æœæ˜¯ï¼Œä½ å°±éœ€è¦ä½¿ç”¨åŸºäºèŠ‚ç‚¹çš„å®¹å™¨ã€‚ å¦‚æœä½ éœ€è¦å¤šå…ƒç´ æ’å…¥ï¼ˆæ¯”å¦‚ï¼Œä»¥èŒƒå›´çš„æ–¹å¼ï¼‰çš„äº‹åŠ¡æ€§è¯­ä¹‰ï¼Œä½ å°±åº”è¯¥é€‰æ‹©listï¼Œå› ä¸ºlistæ˜¯å”¯ä¸€æä¾›å¤šå…ƒç´ æ’å…¥äº‹åŠ¡æ€§è¯­ä¹‰çš„æ ‡å‡†å®¹å™¨ã€‚ äº‹åŠ¡æ€§è¯­ä¹‰å¯¹äºæœ‰å…´è¶£å†™å¼‚å¸¸å®‰å…¨ä»£ç çš„ç¨‹åºå‘˜æ¥è¯´éå¸¸é‡è¦ã€‚ï¼ˆäº‹åŠ¡æ€§è¯­ä¹‰ä¹Ÿå¯ä»¥åœ¨è¿ç»­å†…å­˜å®¹å™¨ä¸Šå®ç°ï¼Œä½†ä¼šæœ‰ä¸€ä¸ªæ€§èƒ½å¼€é”€ï¼Œè€Œä¸”ä»£ç ä¸é‚£ä¹ˆç›´è§‚ï¼‰ ä½ è¦æŠŠè¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨çš„å¤±æ•ˆæ¬¡æ•°å‡åˆ°æœ€å°‘å—ï¼Ÿ å¦‚æœæ˜¯ï¼Œä½ å°±åº”è¯¥ä½¿ç”¨åŸºäºèŠ‚ç‚¹çš„å®¹å™¨ï¼Œå› ä¸ºåœ¨è¿™äº›å®¹å™¨ä¸Šè¿›è¡Œæ’å…¥å’Œåˆ é™¤ä¸ä¼šä½¿è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆï¼ˆé™¤éå®ƒä»¬æŒ‡å‘ä½ åˆ é™¤çš„å…ƒç´ ï¼‰ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨è¿ç»­å†…å­˜å®¹å™¨ä¸Šæ’å…¥å’Œåˆ é™¤ä¼šä½¿æ‰€æœ‰æŒ‡å‘å®¹å™¨çš„è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆã€‚ ä½ éœ€è¦å…·æœ‰ä»¥ä¸‹ç‰¹æ€§çš„åºåˆ—å®¹å™¨å—ï¼š1ï¼‰ å¯ä»¥ä½¿ç”¨éšæœºè®¿é—®è¿­ä»£å™¨ï¼›2ï¼‰ åªè¦æ²¡æœ‰åˆ é™¤è€Œä¸”æ’å…¥åªå‘ç”Ÿåœ¨å®¹å™¨ç»“å°¾ï¼ŒæŒ‡é’ˆå’Œå¼•ç”¨çš„æ•°æ®å°±ä¸ä¼šå¤±æ•ˆï¼Ÿ è¿™ä¸ªä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„æƒ…å†µï¼Œä½†å¦‚æœä½ é‡åˆ°è¿™ç§æƒ…å†µï¼Œdequeå°±æ˜¯ä½ æ¢¦æƒ³çš„å®¹å™¨ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œå½“æ’å…¥åªåœ¨å®¹å™¨ç»“å°¾æ—¶ï¼Œdequeçš„è¿­ä»£å™¨ä¹Ÿå¯èƒ½ä¼šå¤±æ•ˆï¼Œdequeæ˜¯**å”¯ä¸€ä¸€ä¸ªâ€œåœ¨è¿­ä»£å™¨å¤±æ•ˆæ—¶ä¸ä¼šä½¿å®ƒçš„æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆâ€**çš„æ ‡å‡†STLå®¹å™¨ã€‚ ","date":"2023-07-19","objectID":"/posts/clause_1/:3:0","tags":["STL"],"title":"Effective STL [1] | ä»”ç»†é€‰æ‹©ä½ çš„å®¹å™¨","uri":"/posts/clause_1/"},{"categories":["C++"],"content":"ç»“è¯­ å½“é¢å¯¹å®¹å™¨æ—¶ï¼ŒSTLç»™äº†ä½ å¾ˆå¤šé€‰é¡¹ã€‚å¦‚æœä½ çš„è§†çº¿è¶…è¶Šäº†STLçš„èŒƒå›´ï¼Œé‚£å°±ä¼šæœ‰æ›´å¤šçš„é€‰é¡¹ã€‚åœ¨é€‰æ‹©ä¸€ä¸ªå®¹å™¨å‰ï¼Œè¦ä¿è¯è€ƒè™‘äº†æ‰€æœ‰ä½ çš„é€‰é¡¹ã€‚ ","date":"2023-07-19","objectID":"/posts/clause_1/:4:0","tags":["STL"],"title":"Effective STL [1] | ä»”ç»†é€‰æ‹©ä½ çš„å®¹å™¨","uri":"/posts/clause_1/"},{"categories":["Prediction"],"content":"Novel Highlights (1) ä½¿ç”¨çŸ¢é‡åŒ–çš„é«˜ç²¾åœ°å›¾ä»¥åŠéšœç¢ç‰©çš„å†å²è½¨è¿¹ï¼Œä»è€Œé¿å…æœ‰æŸæ¸²æŸ“ä»¥åŠConvNetç¼–ç (è®¡ç®—å¼€é”€æ¯”è¾ƒå¤§)ã€‚ (2) è®¾è®¡å­å›¾ç½‘ç»œä»¥åŠå…¨å±€å›¾ç½‘ç»œï¼Œå»ºæ¨¡ä½é˜¶ä»¥åŠé«˜é˜¶äº¤äº’ (3) auxiliary task æé«˜ç½‘ç»œæ€§èƒ½ ","date":"2023-07-16","objectID":"/posts/vectornet/:1:0","tags":["draft"],"title":"VectorNet è®ºæ–‡è§£è¯»","uri":"/posts/vectornet/"},{"categories":["Prediction"],"content":"VecotorNet ç½‘ç»œä»‹ç» ","date":"2023-07-16","objectID":"/posts/vectornet/:2:0","tags":["draft"],"title":"VectorNet è®ºæ–‡è§£è¯»","uri":"/posts/vectornet/"},{"categories":["Prediction"],"content":"è½¨è¿¹å’Œåœ°å›¾çš„å‘é‡è¡¨ç¤º Representing trajectories and HD maps laneå¯ä»¥è¡¨ç¤ºä¸ºsplinesï¼Œäººè¡Œé“å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªå¾ˆå¤šä¸ªç‚¹ç»„æˆçš„polygonï¼Œstop signæ ‡è®°å¯ä»¥è¡¨ç¤ºä¸ºå•ä¸€ä¸ªç‚¹ã€‚ å¯¹äºagentæ¥è¯´ï¼Œä»–ä»¬çš„è½¨è¿¹ä¹Ÿæ˜¯ä¸€ç§splinesã€‚ è¿™äº›å…ƒç´ éƒ½å¯ä»¥å‘é‡è¡¨ç¤ºã€‚ å¯¹äºåœ°å›¾çš„ç‰¹å¾ï¼šé€‰æ‹©ä¸€ä¸ªstart pointå’Œæœå‘ï¼Œç­‰é—´è·å‡åŒ€é‡‡æ ·å…³é”®ç‚¹ï¼Œå¹¶äºç›¸é‚»çš„å…³é”®ç‚¹ç›¸è¿ä¸ºå‘é‡ å¯¹äºagentè½¨è¿¹ï¼ŒæŒ‰ç…§0.1s sampleå…³é”®ç‚¹ï¼Œå¹¶å°†å®ƒä»¬è¿æ¥æˆå‘é‡ã€‚ é€šè¿‡å‘é‡åŒ–çš„è¿‡ç¨‹ï¼Œå¯ä»¥å¾—åˆ°æŠ˜çº¿polylinesï¼Œè¿™ä¸ªpolylineså’Œè½¨è¿¹ã€åœ°å›¾æ ‡æ³¨ä¹‹é—´æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚å¦‚æœç»™å®šçš„æ—¶ç©ºé—´éš”è¶³å¤Ÿå°ï¼Œå¾—åˆ°çš„è¿™äº›æŠ˜çº¿å°±ä¸åŸå§‹åœ°å›¾å’Œè½¨è¿¹ååˆ†æ¥è¿‘ã€‚ æˆ‘ä»¬å°†å±äºæŠ˜çº¿ $P_j$â€‹ çš„æ¯ä¸€ä¸ªå‘é‡$v_i$çœ‹ä½œå›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ç‰¹å¾å¦‚ä¸‹: $$v_i = [d_i^s, d_i^e, a_i, j]$$ å…¶ä¸­å‰ä¸¤ä¸ªvectoråˆ†åˆ«æ˜¯vectorçš„start pointå’Œend pointçš„åæ ‡ï¼Œå¯ä»¥æ˜¯(x,y)æˆ–è€…(x,y,z)ä¸‰ç»´çš„å½¢å¼ ç¬¬ä¸‰ä¸ªå‘é‡åˆ™æ˜¯attributeå±æ€§çš„ç‰¹å¾ï¼Œæ¯”å¦‚objectçš„ç±»å‹ï¼Œè½¨è¿¹çš„æ—¶é—´æˆ³ï¼Œé“è·¯çš„ç‰¹å¾ï¼Œé“è·¯é™é€Ÿç­‰ æœ€åä¸€ä¸ªæ˜¯éšœç¢ç‰©idï¼Œè¡¨ç¤º $v_i$ â€‹å±äº $P_j$ ","date":"2023-07-16","objectID":"/posts/vectornet/:2:1","tags":["draft"],"title":"VectorNet è®ºæ–‡è§£è¯»","uri":"/posts/vectornet/"},{"categories":["Prediction"],"content":"Polyline å­å›¾æ„å»º å¯¹äºä¸€ä¸ªPolyline P, å®ƒçš„èŠ‚ç‚¹æœ‰ ${v_1,v_2,â€¦,v_p}$ï¼Œ å¯ä»¥å®šä¹‰ä¸€ä¸ªå­å›¾ç½‘ç»œï¼š $$v_i^{l+1} = \\varphi_{rel}(g_{enc}(v_i^{(l)}), \\varphi({g_{enc}(v_j^{(l)})}))$$ $v_i^{(l)}$â€‹ ä»£è¡¨ç¬¬iä¸ªèŠ‚ç‚¹ç¬¬Lå±‚çš„èŠ‚ç‚¹ç‰¹å¾ã€‚ $g_{enc}(\\cdot)$ä»£è¡¨èŠ‚ç‚¹çš„å˜æ¢ï¼Œå®è·µä¸­é‡‡ç”¨MLPæ¥å®ç°ã€‚ $\\varphi_{agg}(\\cdot)$ä»£è¡¨ç‰¹å¾èšåˆï¼Œç”¨æ¥ä»ç›¸é‚»çš„èŠ‚ç‚¹æ¥è·å–ä¿¡æ¯ï¼Œå®è·µä¸­é‡‡ç”¨çš„æ˜¯max_poolingã€‚ $\\varphi_{rel}(\\cdot)$ä»£è¡¨viå’Œå‘¨å›´èŠ‚ç‚¹çš„å…³ç³»ï¼Œå®è·µä¸­é‡‡ç”¨çš„æ˜¯concateçš„æ“ä½œã€‚ æœ€åç»è¿‡å¤šå±‚çš„å †å ï¼Œæ¥è·å–æ•´ä¸ªPolylineçº§åˆ«çš„ç‰¹å¾ï¼š $$P = \\varphi_{agg}(v_i^{L_p})$$ è¿™é‡Œï¼Œ $Ï†_{agg}(â‹…)$ä¹Ÿæ˜¯max poolingæ“ä½œ. ","date":"2023-07-16","objectID":"/posts/vectornet/:2:2","tags":["draft"],"title":"VectorNet è®ºæ–‡è§£è¯»","uri":"/posts/vectornet/"},{"categories":["Prediction"],"content":"å…¨å±€å›¾çš„é«˜é˜¶äº¤äº’ Global graph for high-order interactions ç»è¿‡ä¸Šé¢çš„å­å›¾è¿›è¡Œä½é˜¶æ¨¡å‹å»ºæ¨¡åï¼Œç°åœ¨æœ‰äº†polylineçº§åˆ«èŠ‚ç‚¹çš„ç‰¹å¾${p_1,p_2,â€¦,p_P}$. ä¸ºäº†å»ºç«‹é«˜é˜¶çš„äº¤äº’ï¼Œéœ€è¦å»ºç«‹ä¸€ä¸ªglobalçš„äº¤äº’å›¾ï¼Œè¯¦è§è®ºæ–‡å›¾2çš„ç¬¬3ä¸ªå­å›¾ã€‚ $$P_i^{l+1} = GNN(p^l_i, A)$$ $p_i^l$â€‹ä»£è¡¨polylineèŠ‚ç‚¹çš„é›†åˆ Aä»£è¡¨é‚»æ¥çŸ©é˜µï¼Œå®è·µä¸­é‡‡ç”¨å…¨é“¾æ¥ $GNN(â‹…)$ä»£è¡¨ä¸€å±‚çš„GNNç½‘ç»œï¼Œå®è·µä¸­é‡‡ç”¨çš„æ˜¯self attention layerï¼š $$GNN(P) = softmax(P_Q P_K^T)P_V$$ å…¶ä¸­ï¼ŒPæ˜¯nodeçš„feature matrixï¼Œ $P_Q$,$P_k$,$P_v$ â€‹åˆ™æ˜¯å®ƒçš„çº¿æ€§æŠ•å½±ã€‚ ç»è¿‡äº†å…¨å±€çš„ç½‘ç»œä¹‹åï¼Œå°±ç”Ÿæˆäº†èŠ‚ç‚¹çš„ç‰¹å¾$P^{L_t}_i$ï¼Œå…¶ä¸­Ltæ˜¯å…¨å±€GNNç½‘ç»œçš„å±‚æ•°ã€‚ç„¶åå°†$P^{(L_t)}_i$æ”¾å…¥decoderè¿›è¡Œè½¨è¿¹çš„ç”Ÿæˆ: $$v_i^{future} = \\varphi_{traj}(P_i^{L_t})$$ è®ºæ–‡ä¸­ï¼Œdecoder $Ï†_{traj}(â‹…)$ ä½¿ç”¨çš„æ˜¯MLPï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨MultiPathä¸­anchor-basedçš„æ–¹æ³•æˆ–è€…variational RNNs æ¥è¿›è¡Œå¤šæ¨¡æ€è½¨è¿¹é¢„æµ‹ã€‚ ","date":"2023-07-16","objectID":"/posts/vectornet/:2:3","tags":["draft"],"title":"VectorNet è®ºæ–‡è§£è¯»","uri":"/posts/vectornet/"},{"categories":["Prediction"],"content":"è¾…åŠ©ä»»åŠ¡è®­ç»ƒ auxiliary graph completion task ä¸ºäº†è®©å…¨å±€äº¤äº’å›¾èƒ½æ›´å¥½åœ°æ•æ‰ä¸åŒè½¨è¿¹å’Œåœ°å›¾å…ƒç´ ä¹‹é—´çš„äº¤äº’ä¿¡æ¯ï¼Œè®ºæ–‡è¿˜æå‡ºäº†ä¸€ä¸ªè¾…åŠ©çš„ä»»åŠ¡ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œéšæœºmaskæ‰ä¸€äº›èŠ‚ç‚¹çš„ç‰¹å¾ï¼Œç„¶åå°è¯•å»è¿˜åŸè¢«æ©ç›–çš„èŠ‚ç‚¹ç‰¹å¾: $$\\hat{P}_i = \\varphi_{node}(P_i^{L_t})$$ è¿™é‡ŒèŠ‚ç‚¹çš„decoder $Ï†_{node}(â‹…)$ ä¹Ÿæ˜¯ä¸€ä¸ªMLPï¼Œåªåœ¨è®­ç»ƒçš„æ—¶å€™ä½¿ç”¨,åœ¨inferenceè¿‡ç¨‹ä¸­ä¸ä½¿ç”¨ã€‚ ","date":"2023-07-16","objectID":"/posts/vectornet/:2:4","tags":["draft"],"title":"VectorNet è®ºæ–‡è§£è¯»","uri":"/posts/vectornet/"},{"categories":["Prediction"],"content":"æŸå¤±å‡½æ•° Loss Function å¤šä»»åŠ¡è®­ç»ƒç›®æ ‡ï¼Œ multi-task training task: $$\\mathcal{L} = \\mathcal{L_{traj}} + \\alpha \\mathcal{L_{node}}$$ $L_{traj}â€‹$: negative Gaussian log-likelihood loss $L_{node}$â€‹: æ˜¯é¢„æµ‹çš„èŠ‚ç‚¹å’Œè¢«æ©ç›–èŠ‚ç‚¹çš„huberæŸå¤±å‡½æ•° å…¶ä¸­ï¼Œ negative Gaussian Log Likelihood æŸå¤±å‡½æ•°ä¸º: $$L(x, y) = -\\log P(y) = - \\log P(y|\\mu(x), \\sum(x))$$ where, $$p(y) = p(yâˆ£Î¼,Î£)=1(2Ï€)n/2âˆ£Î£âˆ£1/2expâˆ’12(yâˆ’Î¼)âŠ¤Î£âˆ’1(yâˆ’Î¼)$$ Huber æŸå¤±å‡½æ•°ä¸º: $$ L(Y|f(x))= \\begin{cases} \\frac{1}{2} (Y-f(x))^2, \u0026 |Y-f(x)|\u003c= \\delta \\\\ \\delta |Y-f(x)| - \\frac{1}{2}\\delta^2, \u0026 |Y-f(x)| \u003e \\delta \\end{cases} $$ ","date":"2023-07-16","objectID":"/posts/vectornet/:2:5","tags":["draft"],"title":"VectorNet è®ºæ–‡è§£è¯»","uri":"/posts/vectornet/"},{"categories":["Prediction"],"content":"æ•´ç† VectorNetæ•°æ®å¤„ç†éƒ¨åˆ†: å¯¹actorçš„å¤„ç†: è¾“å…¥: å–è½¨è¿¹ç‚¹ï¼Œæ¯ä¸¤ä¸ªè½¨è¿¹ç‚¹æ„å»ºvector, å½¢å¼ä¸º(x1, x2, y1, y2), å…¶ä»–ç‰¹å¾(object type, timestamp, track_id) å¯¹lane nodeçš„å¤„ç†: è¾“å…¥: é’ˆå¯¹lane segment çš„ç‚¹ï¼Œæ±‚polylineï¼ŒåŸåˆ™ä¸Šæ±‚lane segmentçš„å·¦å³è¾¹ç•Œçš„ç‚¹çš„å‘é‡(x_start, x_end, y_start, y_end, turn_direction, traffic_control, is_intersection, lane_id) ç½‘ç»œéƒ¨åˆ†: æ„å»ºsubgraphnet: é’ˆå¯¹æ¯ä¸€ä¸ªpolylineï¼Œé€šè¿‡mlpå’Œmaxpoolæ„å»ºsubgraphnet æ„å»ºglobalgraphnet: ä»¥æ¯ä¸ªpolylineä½œä¸ºgraph nodeï¼Œæ„å»ºå…¨å±€å›¾ç½‘ç»œï¼Œé‡‡ç”¨å…¨é“¾æ¥ï¼Œé€šè¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶$GNN(P) = softmax(P_Q, P_K)^T(P_V)$ è½¨è¿¹ç”Ÿæˆ: å°†å…¨å±€ç½‘ç»œçš„èŠ‚ç‚¹ç‰¹å¾ï¼Œé€šè¿‡mlpè¿›è¡Œè½¨è¿¹ç”Ÿæˆã€‚ ref link: [1] https://blog.csdn.net/qq_41897558/article/details/120087113 [2] https://zhuanlan.zhihu.com/p/355131328 ref code: [1]https://github.com/xk-huang/yet-another-vectornet [2]https://github.com/DQSSSSS/VectorNet ","date":"2023-07-16","objectID":"/posts/vectornet/:3:0","tags":["draft"],"title":"VectorNet è®ºæ–‡è§£è¯»","uri":"/posts/vectornet/"},{"categories":["Prediction"],"content":"Overview paper link:https://arxiv.org/pdf/2202.04488.pdf ","date":"2023-07-16","objectID":"/posts/crat_pred/:1:0","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"è®ºæ–‡æ¦‚è§ˆ æ–‡ç« æå‡ºäº†ä¸€ç§ç»“åˆCrystal Graph Convolutional Neural Networkå’ŒMulti-Head Self-Attention Mechanismå¯¹äº¤é€šagentå¤„ç†çš„æ–¹å¼ åœ¨argoverseæ•°æ®é›†ä¸Šè¿›è¡ŒéªŒè¯ï¼Œå®ç°äº†map-freeé¢„æµ‹æ¨¡å‹çš„SOTAæ•ˆæœ; ç›¸æ¯”è¾ƒäºå…¶ä»–æ¨¡å‹ï¼Œæ¨¡å‹å‚æ•°æ›´å°‘ã€‚ è¯æ˜: å¯ä»¥é€šè¿‡ Self-Attention Mechanism å­¦ä¹ åˆ°äº¤é€šå‚ä¸è€…ä¹‹é—´çš„äº¤äº’å…³ç³»ã€‚ ","date":"2023-07-16","objectID":"/posts/crat_pred/:2:0","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"ç½‘ç»œç»“æ„ æ•°æ®å¤„ç†: ä»¥argoverse2æ•°æ®ä¸ºä¾‹ï¼Œå–å‰50å¸§æ•°æ®ï¼Œä¸¤ä¸¤ä½œå·®å€¼ï¼Œå–49ç»„ä½ç§»å‘é‡æ•°æ®ä¸ºè¾“å…¥ é¦–å…ˆç”¨EncoderLSTMä½œä¸ºencoder å†å°†æ¯ä¸€ä¸ªagentä½œä¸ºnodeï¼Œé€šè¿‡Crystal Graph Convolutional Neural Networkæ„å»ºå›¾ç¥ç»ç½‘ç»œ é€šè¿‡Multi-Head Self-Attentionå­¦ä¹ nodeä¹‹é—´çš„äº¤äº’å…³ç³» ","date":"2023-07-16","objectID":"/posts/crat_pred/:3:0","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"å®ç°åŸç† ","date":"2023-07-16","objectID":"/posts/crat_pred/:4:0","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"Input Encoder è¾“å…¥ç¼–ç å™¨ è¾“å…¥æ•°æ®ä¸ºè¿‡å»5ç§’çš„ç¦»æ•£ä½ç§»: $$s_i^t = (\\Delta{\\tau_i^t} || b_i^t)$$ å…¶ä¸­ï¼Œ $\\Delta \\tau_i^t = \\tau_i^{t-1}$. ","date":"2023-07-16","objectID":"/posts/crat_pred/:4:1","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"Interaction Module äº¤äº’æ¨¡å— ","date":"2023-07-16","objectID":"/posts/crat_pred/:4:2","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"Output Decoder è¾“å‡ºç¼–ç å™¨ ","date":"2023-07-16","objectID":"/posts/crat_pred/:4:3","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"Training è®­ç»ƒè¿‡ç¨‹ ","date":"2023-07-16","objectID":"/posts/crat_pred/:4:4","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"ä»£ç å®ç°ç»“æ„ æ•°æ®å¤„ç†ç»“æ„ input = dict() input['argo_id'] = list() input['city'] = list() input['past_trajs'] = list() input['fut_trajs'] = list() input['gt'] = list() input['displ'] = list() input['centers'] = list() input['origin'] = list() input['rotation'] = list() 29 + 32 = 61 argo_id: [â€˜01d7deae-31e9-4657-843f-c30009b09f1câ€™, â€˜01ca1736-ec51-41aa-8c73-3338c574a83aâ€™] city: [â€˜austinâ€™, â€˜austinâ€™] past_trajs: torch.Size([29, 50, 3]) torch.Size([32, 50, 3]) fut_trajs: torch.Size([29, 60, 3]) torch.Size([32, 60, 3]) gt: torch.Size([29, 60, 2]) torch.Size([32, 60, 2]) displ: torch.Size([29, 49, 3]) torch.Size([32, 49, 3]) centers: torch.Size([29, 2]) torch.Size([32, 2]) origin: torch.Size([2]) torch.Size([2]) rotation: torch.Size([2, 2]) torch.Size([2, 2]) ç½‘ç»œè¾“å…¥è¾“å‡ºç»“æ„è¯¦è§£ In Inference with two sample data: displ_cat: 61 x 49 x 3 centers_cat: 61 x 2 agents_per_sample: [32, 29] ","date":"2023-07-16","objectID":"/posts/crat_pred/:5:0","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"encoder_lstm input: displ_cat(61 x 49 x 3), agents_per_sample [32,29] $\\downarrow$ input_size = 3; hidden_size = 128; num_layers = 1 $\\downarrow$lstm_hidden_state = torch.randn(num_layers, lstm_in.shape[0], hidden_size) = torch.randn(1, 61, 128) $\\downarrow$lstm_cell_state = torch.randn(num_layers, lstm_in.shape[0], hidden_size) = torch.randn(1, 61, 128) $\\downarrow$lstm_out, lstm_hidden = self.lstm(lstm_in, lstm_hidden) =\u003e lstm((61, 49, 3), (torch((1, 61, 128)), torch(1, 61, 128))) $\\downarrow$ lstm_out(61 x 49 x 128) output: lstm_out[:,-1,:](61 x 128) ","date":"2023-07-16","objectID":"/posts/crat_pred/:5:1","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"agent_gnn input: out_encoder_lstm(61 x 128), centers_cat (61 x 2) agents_per_sample [32,29] $\\downarrow$ x = gnn_in =\u003e (61 x 128) $\\downarrow$ edge_index = build_fully_connected_edge_idx(agents_per_sample).to(gnn_in.device) =\u003e (2, 1804) 1804 = (29 x 29-1) + (32 x (32-1)) $\\downarrow$ $\\downarrow$ edge_attr = build_edge_attr(edge_index, centers).to(gnn_in.device) =\u003e (1804, 2) $\\downarrow$ x = F.relu(self.gcn1(x, edge_index, edge_attr)) =\u003e (61 x 128) output: gnn_out = F.relu(self.gcn2(x, edge_index, edge_attr)) =\u003e (61 x 128) $$\\mathbf{x}^{\\prime}i = \\mathbf{x}i + \\sum{j \\in \\mathcal{N}(i)} \\sigma \\left( \\mathbf{z}{i,j} \\mathbf{W}_f + \\mathbf{b}f \\right) \\odot g \\left( \\mathbf{z}{i,j} \\mathbf{W}_s + \\mathbf{b}_s \\right)$$ ","date":"2023-07-16","objectID":"/posts/crat_pred/:5:2","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"multihead_self_attention input: out_agent_gnn (61 x 128) agents_per_sample[32,29] $\\downarrow$ max_agents = max(agents_per_sample) =\u003e 32 $\\downarrow$ padded_att_in = torch.zeros((len(agents_per_sample), max_agents, self.latent_size), device=att_in[0].device) =\u003e torch: (2 x 32 x 128) $\\downarrow$ mask = torch.arange(max_agents) \u003c torch.tensor(agents_per_sample)[:, None] \u0026\u0026 padded_att_in[mask] = att_in =\u003e torch: (2 x 32 x 128) $\\downarrow$ padded_att_in_swapped = torch.swapaxes(padded_att_in, 0, 1) =\u003e torch: (32, 2, 128) $\\downarrow$ padded_att_in_swapped, _ = self.multihead_attention(padded_att_in_swapped, padded_att_in_swapped, padded_att_in_swapped, key_padding_mask=mask_inverted) =\u003e torch: (32, 2, 128) $\\downarrow$ padded_att_in_reswapped = torch.swapaxes(padded_att_in_swapped, 0, 1) =\u003e torch: (2, 32, 128) $\\downarrow$ att_out_batch = [x[0:agents_per_sample[i]] for i, x in enumerate(padded_att_in_reswapped)] =\u003e list: 2 output: att_out_batch =\u003e list: 2 for each with shape (29, 128) and (32, 128) ","date":"2023-07-16","objectID":"/posts/crat_pred/:5:3","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"torch.stack() input: out_self_attention: list: 2 for each with shape (29, 128) and (32, 128) $\\downarrow$ out_self_attention = torch.stack([x[0] for x in out_self_attention]) output: out_self_attention: torch: (2, 128) ","date":"2023-07-16","objectID":"/posts/crat_pred/:5:4","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"PredictionNet(out_self_attention) ","date":"2023-07-16","objectID":"/posts/crat_pred/:5:5","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"decoder_residual input: out_self_attention(torch: (2, 128)) frozen = False $\\downarrow$ [condition: frozen = False] sample_wise_out.append(PredictionNet(out_self_attention)) =\u003e torch: (2, 120) $\\downarrow$ decoder_out = torch.stack(sample_wise_out) =\u003e torch: (1, 2, 120) $\\downarrow$ decoder_out = torch.swapaxes(decoder_out, 0, 1) =\u003e torch: (2, 1, 120) output: decoder_out =\u003e torch: (2, 1, 120) ","date":"2023-07-16","objectID":"/posts/crat_pred/:5:6","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"out = out_linear.view(len(displ), 1, -1, self.config[â€™num_predsâ€™], 2) input: decoder_out: torch: (2, 1, 120) $\\downarrow$ out = out_linear.view(len(displ), 1, -1, self.config[â€™num_predsâ€™], 2) =\u003e torch: (2, 1, 1, 60, 2) output: out =\u003e torch: (2, 1, 1, 60, 2) ","date":"2023-07-16","objectID":"/posts/crat_pred/:5:7","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"å°†é¢„æµ‹è½¨è¿¹è½¬æ¢åˆ°å…¨å±€åæ ‡ for i in range(len(out)): out[i] = torch.matmul(out[i], rotation[i]) + origin[i].view( 1, 1, 1, -1 ) ","date":"2023-07-16","objectID":"/posts/crat_pred/:5:8","tags":["draft"],"title":"CRAT-Prediction","uri":"/posts/crat_pred/"},{"categories":["Prediction"],"content":"TNT: Target-driveN Trajectory Prediction **ref link:** https://zhuanlan.zhihu.com/p/435953928 https://blog.csdn.net/weixin_40633696/article/details/124542807?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-2-124542807-blog-122758833.pc_relevant_vip_default\u0026spm=1001.2101.3001.4242.2\u0026utm_relevant_index=5 ","date":"2023-07-16","objectID":"/posts/densetnt_tnt/:1:0","tags":["draft"],"title":"DenseTNT and TNT è®ºæ–‡è§£è¯»","uri":"/posts/densetnt_tnt/"},{"categories":["Prediction"],"content":"æ¦‚è§ˆ åœ¨é¢„æµ‹è½¦è¾†çš„è½¨è¿¹æ—¶, éœ€è¦å°½å¯èƒ½è€ƒè™‘åˆ°è½¦è¾†ä¸åŒçš„æƒ…å†µï¼Œå³ä¸åŒçš„æ¨¡æ€ï¼Œå¦‚å‰è¡Œæˆ–å·¦è½¬ï¼Œå¹¶é¢„æµ‹å‡ºå¯¹åº”çš„æ¦‚ç‡ã€‚ æ¨¡æ€çš„å®šä¹‰æ˜¯æ¯”è¾ƒæ¨¡ç³Šçš„ï¼Œä¾‹å¦‚ï¼Œæœ‰ä¸åŒçš„é€Ÿåº¦å‰è¡Œï¼Œå·¦è½¬å¯ä»¥ä»¥ä¸åŒçš„è½¬å¼¯è§’åº¦å®ç°ã€‚ä¸ºäº†èƒ½å¤Ÿæ›´åŠ é€šç”¨ä¸”ç²¾ç¡®åœ°å®šä¹‰æ¯æ¡è½¨è¿¹çš„æ¨¡æ€ï¼Œæˆ‘ä»¬ç›´æ¥å°†æ¯æ¡è½¨è¿¹çš„æ¨¡æ€å®šä¹‰åœ¨æ¯æ¡è½¨è¿¹çš„ç»ˆç‚¹ä¸Šã€‚è¿™é‡Œçš„ä¸€ä¸ªé‡è¦å‡è®¾æ˜¯ï¼Œè½¨è¿¹çš„æ¨¡æ€åŸºæœ¬ç”±ç»ˆç‚¹æ‰€å†³å®šï¼Œå½“ç»ˆç‚¹ç¡®å®šåï¼Œè½¨è¿¹çš„å½¢çŠ¶ä¹Ÿå¤§ä½“ç¡®å®šäº†ã€‚è¿™æ ·æˆ‘ä»¬å°±æŠŠè½¨è¿¹é¢„æµ‹å˜æˆäº†ç»ˆç‚¹é¢„æµ‹é—®é¢˜ï¼Œæå¤§åœ°ç®€åŒ–äº†é—®é¢˜çš„å¤æ‚åº¦ã€‚ TNTçš„é¢„æµ‹æ–¹å¼: é¦–å…ˆé¢„æµ‹è½¨è¿¹çš„ç»ˆç‚¹ï¼Œç„¶ååŸºäºè¿™ä¸ªç»ˆç‚¹è¡¥å……å®Œæ•´æ¡è½¨è¿¹ã€‚ TNT åŸºäºç»ˆç‚¹çš„è½¨è¿¹é¢„æµ‹æµç¨‹å›¾: TNTä½¿ç”¨VectorNetå¯¹é«˜ç²¾åœ°å›¾å’Œè½¦è¾†ä¿¡æ¯è¿›è¡Œç¼–ç ï¼Œå¾—åˆ°è¦é¢„æµ‹çš„è½¦è¾†çš„å…¨å±€ç‰¹å¾ï¼Œä»¥ç”¨äºæ¥ä¸‹æ¥çš„è§£ç ï¼Œä»è€Œå®Œæˆè½¨è¿¹é¢„æµ‹ï¼š (1). ç»ˆç‚¹é¢„æµ‹: ä¸ºæ¯ä¸ªAnchoré¢„æµ‹ä¸€ä¸ªåç§»ï¼Œå¾—åˆ°ç»ˆç‚¹ï¼Œè¿™äº›Anchorä»é“è·¯çš„ä¸­å¿ƒçº¿ä¸Šé‡‡æ ·å¾—åˆ°; (2). è½¨è¿¹è¡¥å…¨: åŸºäºä¸Šä¸€æ­¥é¢„æµ‹çš„ç»ˆç‚¹å°†æ•´æ¡è½¨è¿¹è¡¥å……å®Œæ•´; (3). è½¨è¿¹æ‰“åˆ†å’Œç­›é€‰: æ ¹æ®åœºæ™¯ç‰¹å¾ï¼Œä¸ºæ¯æ¡è½¨è¿¹è¿›è¡Œæ‰“åˆ†ï¼Œå¹¶ç­›é€‰å‡ºæœ€æœ‰å¯èƒ½çš„è‹¥å¹²æ¡è½¨è¿¹ã€‚ ","date":"2023-07-16","objectID":"/posts/densetnt_tnt/:1:1","tags":["draft"],"title":"DenseTNT and TNT è®ºæ–‡è§£è¯»","uri":"/posts/densetnt_tnt/"},{"categories":["Prediction"],"content":"TNT å®ç° åŸç† ç»™å®šä¸€ä¸ªå•ä¸ªéšœç¢ç‰©çš„è§‚æµ‹çŠ¶æ€åºåˆ— $S_P = [s_{-T^{â€™}+1}, s_{-T^{â€™}+2}, â€¦, s_0]$ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯é¢„æµ‹å®ƒçš„æœªæ¥çŠ¶æ€ $S_F = [s_1, s_2, â€¦, s_T]$ åˆ°æŸä¸ªå›ºå®šæ—¶é—´æ­¥ Tã€‚è‡ªç„¶åœ°ï¼Œéšœç¢ç‰©ä¸ç”±å…¶å®ƒéšœç¢ç‰©å’Œåœºæ™¯å…ƒç´ ç»„æˆçš„ç¯å¢ƒäº¤äº’ä½œä¸ºèƒŒæ™¯: $C_Pâ€‹=[c_{-Tâ€²+1}â€‹,c_{-Tâ€²+2}â€‹,â€¦,c_0â€‹]$ã€‚ä¸ºç®€æ´èµ·è§ï¼Œæˆ‘ä»¬è®° $X = (s_P, c_P)$ï¼Œå› æ­¤æˆ‘ä»¬æƒ³æ•æ‰çš„æ•´ä½“æ¦‚ç‡åˆ†å¸ƒæ˜¯ $p(S_F|X)$ ã€‚ å®é™…ä¸Šï¼Œ $p(S_F|X)$ å¯ä»¥æ˜¯é«˜åº¦å¤šæ¨¡æ€çš„ã€‚ä¾‹å¦‚ï¼Œè½¦è¾†é©¶è¿‘åå­—è·¯å£æ—¶å¯èƒ½å·¦è½¬ã€ç›´è¡Œæˆ–æ”¹å˜è½¦é“ã€‚ç›´è§‚ä¸Šï¼Œæœªæ¥çŠ¶æ€çš„ä¸ç¡®å®šæ€§å¯ä»¥è¢«åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†ï¼šç›®æ ‡æˆ–è€…æ„å›¾çš„ä¸ç¡®å®šæ€§ï¼Œæ¯”å¦‚å·¦å³è½¬çš„å†³å®šï¼›ä»¥åŠæ§åˆ¶çš„ä¸ç¡®å®šæ€§ï¼Œæ¯”å¦‚è½¬å¼¯æ—¶éœ€è¦çš„ç»†ç²’åº¦è¿åŠ¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹ç›®æ ‡è®¾å®šæ¡ä»¶ï¼Œç„¶åå°†å…¶è¾¹ç¼˜åŒ–ï¼Œä»è€Œå¯¹æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œåˆ†è§£ï¼š $$p(S_Fâ€‹âˆ£X)=âˆ«_{Ï„âˆˆÏ„(C_Pâ€‹)}â€‹p(Ï„âˆ£X)p(S_Fâ€‹âˆ£Ï„,X)d_Ï„â€‹, \\tag{1}$$ å…¶ä¸­ $\\tau(C_P)$ è¡¨ç¤ºå–å†³äºè§‚å¯Ÿåˆ°çš„èƒŒæ™¯ $C_P$ â€‹çš„åˆç†ç›®æ ‡ç©ºé—´ã€‚ åœ¨è¿™ä¸ªå…¬å¼ä¸‹ï¼Œæˆ‘ä»¬çš„ä¸»è¦è§è§£æ˜¯ï¼Œå¯¹äºè½¨è¿¹é¢„æµ‹ç­‰åº”ç”¨ï¼Œé€šè¿‡æ­£ç¡®è®¾è®¡ç›®æ ‡ç©ºé—´ $\\tau Ï„ ( C_P )$ï¼ˆå¦‚ç›®æ ‡ä½ç½®ï¼‰ï¼Œç›®æ ‡åˆ†å¸ƒ $ p(\\tau|X)$ å¯ä»¥å¾ˆå¥½åœ°æ•æ‰æ„å›¾ä¸ç¡®å®šæ€§ã€‚ä¸€æ—¦ç›®æ ‡ç¡®å®šï¼Œæˆ‘ä»¬ä¼šè¿›ä¸€æ­¥è¯æ˜æ§åˆ¶ä¸ç¡®å®šæ€§ï¼ˆå¦‚è½¨è¿¹ï¼‰å¯ä»¥é€šè¿‡ç®€å•çš„å•æ¨¡æ€åˆ†å¸ƒå¯é åœ°å»ºæ¨¡ã€‚æˆ‘ä»¬ç”¨ä¸€ç»„ç¦»æ•£ä½ç½®æ¥æ¨¡æ‹Ÿç›®æ ‡ç©ºé—´ $\\tau{C_P}$ï¼Œå°† $p(\\tau|X)$ çš„ä¼°è®¡ä¸»è¦è½¬åŒ–ä¸ºä¸€ä¸ªåˆ†ç±»ä»»åŠ¡ã€‚ä¸éšå˜åˆ†æ¨¡å‹ç›¸æ¯”ï¼Œæˆ‘ä»¬çš„æ¨¡å‹ä»¥æ˜ç¡®çš„ç›®æ ‡åˆ†å¸ƒçš„å½¢å¼æä¾›äº†æ›´å¥½çš„å¯è§£é‡Šæ€§ï¼Œå¹¶ä¸”åœ¨è®¾è®¡ç›®æ ‡ç©ºé—´ $\\tau{C_P}$ æ—¶å¯ä»¥è‡ªç„¶åœ°ç»“åˆä¸“å®¶çŸ¥è¯†ï¼ˆå¦‚é“è·¯æ‹“æ‰‘ï¼‰ã€‚ æˆ‘ä»¬çš„æ•´ä½“æ¡†æ¶æœ‰ä¸‰ä¸ªæ¦‚å¿µé˜¶æ®µã€‚ç¬¬ä¸€é˜¶æ®µæ˜¯éšœç¢ç‰©æ„å›¾é¢„æµ‹ï¼Œå…¶ç›®æ ‡æ˜¯ç”¨åŸºäºè§‚å¯ŸèƒŒæ™¯ $X$ çš„ç›®æ ‡ç©ºé—´ $\\tau$ çš„ç¦»æ•£é›†åˆå¯¹æ„å›¾ä¸ç¡®å®šæ€§è¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä¸”è¾“å‡ºç›®æ ‡åˆ†å¸ƒ $p(\\tau|X)$ ã€‚ç¬¬äºŒä¸ªé˜¶æ®µæ˜¯éšœç¢ç‰©æ¡ä»¶è¿åŠ¨ä¼°è®¡ï¼Œå®ƒç”¨å•æ¨¡æ€åˆ†å¸ƒå¯¹ä»åˆå§‹çŠ¶æ€åˆ°ç›®æ ‡å¯èƒ½çš„æœªæ¥è¿åŠ¨è¿›è¡Œå»ºæ¨¡ã€‚å‰ä¸¤ä¸ªé˜¶æ®µäº§ç”Ÿäº†ä»¥ä¸‹æ¦‚ç‡é¢„æµ‹ $p(S_F|X) = \\sum_{\\tau\\in\\tau(C_P)}p(\\tau|X)p(S_F|\\tau, X)$ã€‚ è®¸å¤šä¸‹æ¸¸åº”ç”¨ï¼Œä¾‹å¦‚å®æ—¶è¡Œä¸ºé¢„æµ‹ï¼Œéœ€è¦ä¸€å°ç»„å…·æœ‰ä»£è¡¨æ€§çš„æœªæ¥é¢„æµ‹ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å¯èƒ½æœªæ¥çš„å®Œæ•´åˆ†å¸ƒã€‚æˆ‘ä»¬çš„æœ€ç»ˆé˜¶æ®µï¼Œè¯„åˆ†å’Œé€‰æ‹©ï¼Œå°±æ˜¯ä¸ºæ­¤ç›®çš„é‡èº«å®šåˆ¶çš„ã€‚æˆ‘ä»¬ä»æ‰€æœ‰ä»£è¡¨æ€§é¢„æµ‹ä¸Šå­¦ä¹ ä¸€ä¸ªè¯„åˆ†å‡½æ•° $\\phi(S_F)$ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªæœ€ç»ˆçš„å¤šæ ·åŒ–é¢„æµ‹é›†ã€‚ åœºæ™¯ç¼–ç VectorNet å»ºæ¨¡åœºæ™¯èƒŒæ™¯æ˜¯è½¨è¿¹é¢„æµ‹çš„ç¬¬ä¸€æ­¥ï¼Œä»¥è·å–è½¦è¾†-é“è·¯å’Œè½¦è¾†-è½¦è¾†ä¹‹é—´çš„äº¤äº’ã€‚TNTå¯ä»¥ä½¿ç”¨ä»»ä½•åˆé€‚çš„èƒŒæ™¯ç¼–ç å™¨ï¼šå½“é«˜æ¸…åœ°å›¾å¯ç”¨æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€ä¼˜ç§€çš„å±‚æ¬¡å›¾ç¥ç»ç½‘ç»œ VectorNet å¯¹èƒŒæ™¯è¿›è¡Œç¼–ç ã€‚å…·ä½“æ¥è¯´ï¼Œä½¿ç”¨å¤šæ®µçº¿æ¥æŠ½è±¡å‡ºé«˜æ¸…åœ°å›¾å…ƒç´  $C_P$(è½¦é“ï¼Œäº¤é€šæ ‡å¿—) å’Œä»£ç†è½¨è¿¹ $S_P$â€‹ï¼›é‡‡ç”¨å­å›¾ï¼ˆsubgraphï¼‰ç½‘ç»œå¯¹å¤šæ®µçº¿è¿›è¡Œç¼–ç ï¼Œå¤šæ®µçº¿åŒ…å«å¯å˜æ•°é‡çš„å‘é‡ï¼›ç„¶åä½¿ç”¨å…¨å±€å›¾ï¼ˆglobal graphï¼‰å¯¹å¤šæ®µçº¿ä¹‹é—´çš„äº¤äº’è¿›è¡Œå»ºæ¨¡ã€‚è¾“å‡ºæ˜¯æ¯ä¸ªå»ºæ¨¡ä»£ç†çš„å…¨å±€èƒŒæ™¯ç‰¹å¾ $X$ã€‚å¦‚æœåœºæ™¯èƒŒæ™¯åªåœ¨è‡ªä¸Šè€Œä¸‹çš„å›¾åƒå½¢å¼ä¸­å¯ç”¨ï¼Œåˆ™ä½¿ç”¨å·ç§¯ç½‘ç»œä½œä¸ºèƒŒæ™¯ç¼–ç å™¨ã€‚ ç›®æ ‡é¢„æµ‹ åœ¨æˆ‘ä»¬çš„å…¬å¼ä¸­ï¼Œç›®æ ‡ $\\tau$ è¢«å®šä¹‰ä¸ºä¸€ä¸ªé¢„æµ‹ç›®æ ‡å¯èƒ½åœ¨å›ºå®šæ—¶é—´èŒƒå›´ $T$ ä¸Šçš„ä½ç½® $(x,y)$ ã€‚åœ¨ç¬¬ä¸€æ­¥ç›®æ ‡é¢„æµ‹é˜¶æ®µï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªé¢„æµ‹ç›®æ ‡çš„æœªæ¥ç›®æ ‡çš„åˆ†å¸ƒ $p( \\tau âˆ£ X )$ ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ç»„$N$ä¸ªç¦»æ•£çš„ã€å¸¦æœ‰è¿ç»­åç§»çš„é‡åŒ–ä½ç½®æ¥å»ºæ¨¡æ½œåœ¨çš„æœªæ¥ç›®æ ‡ï¼š $\\tau ={\\tau^n}={(x^n,y^n)+(\\Delta x^n,\\Delta y^n)}^N_{n=1}$â€‹ã€‚ç„¶åè¿™ä¸ªç›®æ ‡ä¸Šåˆ†å¸ƒå¯ä»¥é€šè¿‡ä¸€ä¸ªç¦»æ•£-è¿ç»­åˆ†è§£æ¥å»ºæ¨¡ï¼š $$p(Ï„^nâˆ£X)=Ï€(Ï„^nâˆ£X)â‹…N(Î”x^nâˆ£v^x_nâ€‹(X))â‹…N(Î”_y^nâˆ£v_y^nâ€‹(X)),\\tag{2}$$ ä¸­ $\\pi(\\tau^n|X)=\\frac{e^{f(\\tau^n,X)}}{\\sum_{\\tau^{â€™}}e^{f(\\tau^{â€™},X)}}$ æ˜¯åœ¨ä½ç½®é€‰æ‹© $(x^n,y^n)$ä¸Šçš„ç¦»æ•£åˆ†å¸ƒã€‚æœ¯è¯­ $N(Â·|v(Â·))$ è¡¨ç¤ºä¸€ä¸ªå¹¿ä¹‰æ­£æ€åˆ†å¸ƒï¼Œå…¶ä¸­æˆ‘ä»¬é€‰æ‹©Huberä½œä¸ºè·ç¦»å‡½æ•°ã€‚æˆ‘ä»¬å°†å‡å€¼è¡¨ç¤ºä¸º $v(Â·)$å¹¶å‡è®¾å•ä½æ–¹å·®ã€‚ å¯è®­ç»ƒå‡½æ•° $f(Â·)$ å’Œ $v(Â·)$ ç”±ä¸€ä¸ª2å±‚çš„å¤šå±‚æ„ŸçŸ¥æœº(MLP)å®ç°ï¼Œç›®æ ‡åæ ‡ $(x^k,y^k)$ å’Œåœºæ™¯èƒŒæ™¯ç‰¹å¾ $X$ ä½œä¸ºè¾“å…¥ã€‚å®ƒä»¬é¢„æµ‹ç›®æ ‡ä½ç½®ä¸Šçš„ç¦»æ•£åˆ†å¸ƒåŠå…¶æœ€å¯èƒ½çš„åç§»é‡ã€‚è¿™ä¸€é˜¶æ®µçš„è®­ç»ƒæŸå¤±å‡½æ•°ç”±ä»¥ä¸‹å…¬å¼ç»™å‡ºï¼š $$L_{S1}â€‹=L_{clsâ€‹}(Ï€,u)+L_{offset}â€‹(v_xâ€‹,v_yâ€‹,Î”x^u,Î”y^u),\\tag{3}$$ å…¶ä¸­ $L_{cls}$ æ˜¯äº¤å‰ç†µæŸå¤±ï¼Œ $L_{offset}$â€‹ æ˜¯ Huber æŸå¤±ï¼›$u$ æ˜¯ç¦»çœŸå®ä½ç½®æœ€è¿‘çš„ç›®æ ‡ï¼Œå¹¶ä¸” $\\Delta x^u,\\Delta y^u$ æ˜¯ $u$ ç›¸å¯¹äºçœŸå€¼çš„ç©ºé—´åç§»é‡ã€‚ ç¦»æ•£ç›®æ ‡ç©ºé—´çš„é€‰æ‹©åœ¨ä¸åŒåº”ç”¨ä¸­æ˜¯çµæ´»çš„ï¼Œå¦‚å›¾3æ‰€ç¤ºã€‚åœ¨è½¦è¾†è½¨è¿¹é¢„æµ‹é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬ä»é«˜æ¸…åœ°å›¾é‡Œå‡åŒ€åœ°é‡‡æ ·è½¦é“ä¸­å¿ƒçº¿ä¸Šçš„ç‚¹å¹¶ä¸”å°†ä»–ä»¬ä½œä¸ºç›®æ ‡å€™é€‰ç‚¹(æ ‡è®°ä¸ºé»„è‰²è±å½¢)ï¼Œå‡è®¾è½¦è¾†ä»æœªè¿œç¦»è½¦é“çº¿ï¼›å¯¹äºè¡Œäººï¼Œæˆ‘ä»¬åœ¨ä»£ç†å‘¨å›´ç”Ÿæˆäº†ä¸€ä¸ªè™šæ‹Ÿç½‘æ ¼å¹¶å°†ç½‘æ ¼ç‚¹ä½œä¸ºç›®æ ‡å€™é€‰ç‚¹ã€‚å¯¹æ¯ä¸ªå€™é€‰ç›®æ ‡ï¼ŒTNTç›®æ ‡é¢„æµ‹å™¨ç”Ÿæˆäº†ä¸€ä¸ª $(\\pi,\\Delta x, \\Delta y)$ çš„å…ƒç»„ï¼›å›å½’åçš„ç›®æ ‡ä»¥æ©™è‰²äº”è§’æ˜Ÿæ ‡è®°ã€‚ä¸ç›´æ¥å›å½’ç›¸æ¯”ï¼Œå°†æœªæ¥å»ºæ¨¡æˆä¸€ç»„ç¦»æ•£ç›®æ ‡çš„æœ€æ˜¾è‘—çš„ä¼˜åŠ¿åœ¨äºï¼Œå®ƒä¸å—æ¨¡æ€å¹³å‡çš„å½±å“ï¼Œæ¨¡æ€å¹³å‡æ˜¯é˜»æ­¢å¤šæ¨¡æ€é¢„æµ‹çš„ä¸»è¦å› ç´ ã€‚ åŸºäºç›®æ ‡çš„è¿åŠ¨ä¼°è®¡ åœ¨ç¬¬äºŒé˜¶æ®µï¼Œæˆ‘ä»¬å°†ç»™å®šç›®æ ‡è½¨è¿¹çš„å¯èƒ½æ€§å»ºæ¨¡ä¸º $p(S_F|\\tau,X)=\\prod^T_{t=1}p(s_t|\\tau,X)$ï¼ŒåŒæ ·é‡‡ç”¨äº†å¹¿ä¹‰æ­£æ€åˆ†å¸ƒã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªå‡è®¾ã€‚é¦–å…ˆï¼Œæœªæ¥æ—¶é—´æ­¥æ˜¯æ¡ä»¶ç‹¬ç«‹çš„ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬çš„æ¨¡å‹é€šè¿‡é¿å…é¡ºåºé¢„æµ‹æé«˜äº†è®¡ç®—æ•ˆç‡ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬æ­£åœ¨ä½œå‡ºæœ‰åŠ›ä½†åˆç†çš„å‡è®¾ï¼Œå³ç»™å®šç›®æ ‡çš„è½¨è¿¹åˆ†å¸ƒæ˜¯å•æ¨¡æ€(æ­£æ€)çš„ã€‚å¯¹äºçŸ­çš„æ—¶é—´èŒƒå›´æ¥è¯´ï¼Œè¿™å½“ç„¶æ˜¯æ­£ç¡®çš„ï¼›å¯¹äºæ›´é•¿çš„æ—¶é—´èŒƒå›´ï¼Œå¯ä»¥åœ¨(ä¸­é—´)ç›®æ ‡é¢„æµ‹å’Œè¿åŠ¨ä¼°è®¡ä¹‹é—´è¿­ä»£ï¼Œä»¥ä¾¿å‡è®¾ä»ç„¶æˆç«‹ã€‚ è¿™ä¸€é˜¶æ®µä½¿ç”¨2å±‚çš„MLPå®ç°ã€‚å®ƒå°†èƒŒæ™¯ç‰¹å¾ X å’Œç›®æ ‡ä½ç½® $\\tau$ ä½œä¸ºè¾“å…¥ï¼Œå¹¶ä¸”æ¯ä¸ªç›®æ ‡è¾“å‡ºä¸€æ¡æœ€å¯èƒ½çš„è½¨è¿¹ $[\\hat{s_1},â€¦,\\hat{s_T}] [s1â€‹^â€‹,â€¦,sTâ€‹^â€‹]$ã€‚ç”±äºå®ƒä»¥ç¬¬ä¸€é˜¶æ®µçš„é¢„æµ‹ç›®æ ‡ä¸ºæ¡ä»¶ï¼Œä¸ºäº†å®ç°å¹³æ»‘çš„å­¦ä¹ è¿‡ç¨‹ï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒæ—¶é‡‡ç”¨teacher forcing Technique[36]ï¼Œå°†çœŸå®ä½ç½® $(x^n,y^n)$ ä½œä¸ºç›®æ ‡ã€‚è¯¥é˜¶æ®µçš„æŸå¤±é¡¹æ˜¯é¢„æµ‹çŠ¶æ€ $\\hat{s_t}$â€‹ å’ŒçœŸå€¼ $s_t$â€‹ ä¹‹é—´çš„è·ç¦»ï¼š $$L_{S2}â€‹ = \\sum_{t=1}^{T}â€‹L_{reg}â€‹(\\hat{s},s_tâ€‹),\\tag{4}$$ å…¶ä¸­ï¼Œ $L_{reg}$â€‹ ä½œä¸ºæ¯ä¸€æ­¥åæ ‡åç§»çš„ Huber æŸå¤±æ¥å®ç°ã€‚ è½¨è¿¹è¯„åˆ†å’Œé€‰æ‹© æˆ‘ä»¬çš„æœ€ç»ˆé˜¶æ®µä¼°è®¡æœªæ¥å®Œæ•´è½¨è¿¹ S F S_F SFâ€‹ çš„å¯èƒ½æ€§ã€‚è¿™å’Œç¬¬äºŒé˜¶æ®µä¸åŒï¼Œç¬¬äºŒé˜¶æ®µåˆ†è§£æ—¶é—´æ­¥å’Œç›®æ ‡ï¼Œä¹Ÿå’Œç¬¬ä¸€é˜¶æ®µä¸åŒï¼Œç¬¬ä¸€é˜¶æ®µåªçŸ¥é“ç›®æ ‡ï¼Œä½†æ²¡æœ‰å®Œæ•´çš„è½¨è¿¹â€”â€”ä¾‹å¦‚ï¼Œä¸€ä¸ªç›®æ ‡å¯èƒ½è¢«ä¼°è®¡æœ‰å¾ˆé«˜çš„å¯èƒ½æ€§ï¼Œä½†åˆ°è¾¾è¯¥ç›®æ ‡å®Œæ•´è½¨è¿¹çš„å¯èƒ½æ€§å¯èƒ½ä¸æ˜¯ã€‚ æˆ‘ä»¬ä½¿ç”¨æœ€å¤§ç†µæ¨¡å‹å¯¹ç¬¬äºŒé˜¶æ®µçš„æ‰€æœ‰ M æ¡è½¨è¿¹è¿›è¡Œè¯„åˆ†: $$\\phi (S_F | X) = \\frac{e^{g(S_F, X)}}{{\\sum}_{m=1}^{M} e^{g(S_F^m, X)}}â€‹$$, å…¶ä¸­ $g(Â·)$ è¢«å»ºæ¨¡ä¸ºä¸€ä¸ª2å±‚çš„ MLPã€‚è¿™ä¸€é˜¶æ®µè®­ç»ƒçš„æŸå¤±é¡¹æ˜¯é¢„æµ‹åˆ†æ•°å’ŒçœŸå€¼åˆ†æ•°ä¹‹é—´çš„äº¤å‰ç†µï¼Œ $$L_{S3} = L_{CE}(\\phi (S_F | X), \\psi(S_F))$$ å…¶ä¸­æ¯ä¸ªé¢„æµ‹è½¨è¿¹çš„çœŸå€¼è¯„åˆ†ç”±é¢„æµ‹è½¨è¿¹åˆ°çœŸå€¼è½¨è¿¹çš„è·ç¦» $\\psi(S_F)=\\frac{exp(-D(S,S_{GT})/\\alpha)}{\\sum_{s^{â€™}}exp(-D(S^{â€™},S_{GT})/\\alpha)}$ å®šä¹‰ï¼Œå…¶ä¸­ $D(Â·)$ å•ä½ä¸ºç±³ï¼Œ $\\alpha$ æ˜¯æ¸©åº¦ã€‚è·ç¦»åº¦é‡å®šä¹‰ä¸º $D(S^i,S^j)=max(||s^i_1-s^j_1||^2_2,â€¦,||s^i_t-s^j_t||^2_2)$ã€‚ ä¸ºäº†ä»å·²è¯„åˆ†çš„ $M$ ä¸ªè½¨è¿¹è·å¾—æœ€ç»ˆä¸€å°ç»„ $K$ ä¸ªé¢„æµ‹è½¨è¿¹ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªè½¨è¿¹é€‰æ‹©ç®—æ³•æ¥æ’é™¤è¿‘ä¼¼é‡å¤çš„è½¨è¿¹ã€‚æˆ‘ä»¬é¦–å…ˆæ ¹æ®ä»–ä»¬çš„åˆ†æ•°å¯¹è½¨è¿¹è¿›è¡Œé™åºæ’åˆ—ï¼Œå¹¶ä¸”è´ªå©ªåœ°é€‰æ‹©è½¨è¿¹ï¼› å¦‚æœä¸€ä¸ªè½¨è¿¹è·ç¦»æ‰€æœ‰çš„é€‰æ‹©è½¨è¿¹éƒ½è¶³å¤Ÿè¿œï¼Œæˆ‘ä»¬ä¹Ÿä¼šé€‰æ‹©å®ƒï¼Œå¦åˆ™æ’é™¤å®ƒã€‚è¿™é‡Œä½¿ç”¨çš„è·ç¦»åº¦é‡å’Œè¯„åˆ†è¿‡ç¨‹ç›¸åŒã€‚è¿™ä¸ªè¿‡ç¨‹çš„çµæ„Ÿæ¥æºäºé€šå¸¸åº”ç”¨äºè®¡ç®—æœºè§†è§‰é—®é¢˜ï¼ˆå¦‚ç›®æ ‡æ£€æµ‹ï¼‰çš„éæå¤§å€¼æŠ‘åˆ¶ç®—æ³•ã€‚ è®­ç»ƒå’Œæ¨ç†ç»†èŠ‚ ä¸Šè¿°çš„ TNT å…¬å¼äº§ç”Ÿå…¨ç›‘ç£çš„ç«¯åˆ°ç«¯è®­ç»ƒï¼Œå…·æœ‰æŸå¤±å‡½æ•° $$L = \\lambda_1 L_{S1} + \\lambda_2 L_{S2} + \\lambda_3 L_{S3}$$ å…¶ä¸­ï¼Œé€‰æ‹© $\\lambda_1,\\lambda_2,\\lambda_3$ æ¥å¹³è¡¡è®­ç»ƒè¿‡ç¨‹ã€‚ åœ¨æ¨ç†æ—¶ï¼ŒTNT çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š (1) å·¥ä½œåœºæ™¯ç¼–ç ï¼› (2) é‡‡æ · N ä¸ªå€™é€‰ç›®æ ‡ä½œä¸ºç›®æ ‡é¢„æµ‹å™¨çš„è¾“å…¥ï¼Œå–ç”± $\\pi(\\tau|X)$ ä¼°è®¡çš„å‰ M ä¸ªç›®æ ‡ï¼› (3) ä»è¿åŠ¨ä¼°è®¡æ¨¡å‹ $p(S_F|\\tau,X)$ ä¸­è·å– M ä¸ªç›®æ ‡","date":"2023-07-16","objectID":"/posts/densetnt_tnt/:1:2","tags":["draft"],"title":"DenseTNT and TNT è®ºæ–‡è§£è¯»","uri":"/posts/densetnt_tnt/"},{"categories":["Prediction"],"content":"DenseTNT: ref link: https://blog.csdn.net/weixin_39397852/article/details/122764880 ","date":"2023-07-16","objectID":"/posts/densetnt_tnt/:2:0","tags":["draft"],"title":"DenseTNT and TNT è®ºæ–‡è§£è¯»","uri":"/posts/densetnt_tnt/"},{"categories":["Prediction"],"content":"Comparison between DenseTNT and TNT TNT(å·¦å›¾)æ˜¯æ ¹æ®laneå®šä¹‰ä¸€äº›anchorï¼Œå†regresså’Œclassifyè·å¾—æœ€ç»ˆçš„ä½ç½®ï¼Œä¹‹åè¿˜è¦é€šè¿‡NMSçš„ç­›é€‰æ³•é€‰å‡ºæœ€åçš„è½¨è¿¹ã€‚ DenseTNT(å³å›¾)æ˜¯é€šè¿‡å¯†é›†åœ°é‡‡ç‚¹é¿å…äº†å®šä¹‰anchorï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†ä½¿ç”¨NMSç­‰è§„åˆ™æ¥ç­›é€‰è½¨è¿¹ã€‚ æ„å›¾é¢„æµ‹ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªé—®é¢˜æ˜¯ground truthåªæœ‰ä¸€ä¸ªï¼Œè€Œå¯¹äºå¤šæ„å›¾çš„é¢„æµ‹æ¥è¯´ï¼Œå¤šä¸ªæ–¹å‘çš„é¢„æµ‹éƒ½æ˜¯å…è®¸çš„ï¼Œè¿™å¯¼è‡´äº†labelä¸­æœ‰å¾ˆå¤šéƒ½æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºgtåªåŒ…å«äº†ä¸€ä¸ªæ„å›¾ä¸‹çš„ç»“æœã€‚æ­¤å¤„è®¾è®¡äº†ä¸€ä¸ªofflineçš„modelæ¥æä¾›å¤šä¸ªæ„å›¾ä¸‹çš„labelã€‚è¿™ä¸ªmodelä½¿ç”¨äº†ä¸€ä¸ªä¼˜åŒ–ç®—æ³•ä»goalçš„åˆ†å¸ƒé‡Œå–å‡ºäº†ä¸€ä¸ªsetä½œä¸ºonline modelçš„labelã€‚ ","date":"2023-07-16","objectID":"/posts/densetnt_tnt/:2:1","tags":["draft"],"title":"DenseTNT and TNT è®ºæ–‡è§£è¯»","uri":"/posts/densetnt_tnt/"},{"categories":["Prediction"],"content":"Method å…·ä½“å®ç°æ–¹æ³• sparse context encoding â€“ VectorNet æœ¬æ–‡ä½¿ç”¨VectorNetæ¥æå–åœ°å›¾çš„featureã€‚(æ²¡æœ‰çš„é«˜ç²¾åœ°å›¾çš„è¯ä¹Ÿå¯ä½¿ç”¨CNN) Dense goal probability estimation TNTå¯¹äºä¸€ä¸ªgoalåªé¢„æµ‹ä¸€æ¡è½¨è¿¹çš„æ¦‚ç‡æ˜¯æœ‰é—®é¢˜çš„ï¼šä¸€ä¸ªgoalåªæœ‰ä¸€æ¡é¢„æµ‹(å¯èƒ½é€šå‘è¿™ä¸ªgoalçš„åˆ«çš„é¢„æµ‹æ¦‚ç‡å¾ˆé«˜)ï¼Œä¸€ä¸ªgoalè·å–çš„featureä¸å¤Ÿä¸°å¯Œ(goalé™„è¿‘çš„ç‚¹çš„ä¿¡æ¯ä¹Ÿç”¨ä¸Šä¼šæ›´å¥½)ã€‚ æˆ‘ä»¬ä½¿ç”¨äº†dense goal encoderã€‚å®ƒä»¥ä¸€å®šçš„é‡‡æ ·é¢‘ç‡è·å–äº†åœ°å›¾ä¸Šåœ¨é“è·¯ä¸Šçš„æ‰€æœ‰ç‚¹ã€‚ç„¶åé¢„æµ‹äº†è¿™äº›å¯†é›†ç‚¹çš„æ¦‚ç‡åˆ†å¸ƒã€‚ Lane Scoring åœ¨è®ºæ–‡å®ç°ä¸­ï¼Œå¯ä»¥ç”¨point scoringä»£æ›¿ï¼Œæ•ˆæœæ›´å¥½ã€‚ç›®çš„åœ¨ä¸é€‰å‡ºè·ç¦»final pos(gt)æ›´è¿‘çš„ç‚¹ã€‚ ä¸ºäº†å‡å°‘éœ€è¦sampleçš„ç‚¹ï¼Œæˆ‘ä»¬å…ˆé¢„æµ‹goalè½åœ¨ä¸åŒlaneä¸Šçš„æ¦‚ç‡ï¼Œè¿™æ ·èƒ½è¿‡æ»¤æ‰æ˜æ˜¾ä¸åœ¨candidate laneé™„è¿‘çš„ç‚¹ï¼Œæå‡è¿ç®—é€Ÿåº¦ã€‚ è¿™æ˜¯ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ã€‚å› æ­¤ä½¿ç”¨äº†äºŒåˆ†ç±»çš„äº¤å‰ç†µè®¡ç®—lossã€‚å¯¹äºlabelï¼Œä½¿ç”¨ç¦»gtçš„goalæœ€è¿‘çš„laneä½œä¸º1ï¼Œåˆ«çš„laneä¸º0ã€‚å¯¹äºåˆ«çš„lane $l$ï¼Œå‡è®¾gtçš„goalæ˜¯$y_{gt}$â€‹ï¼Œå®šä¹‰ä¸€ä¸ªdistance $$d(l,y_{gt}) = min(||l_1 - y_{gt}||^2, ||l_2 - y_{gt}||^2, â€¦, ||l_t - y_{gt}||^2,)$$ ç›´è§‰ä¸Šå°±æ˜¯gtçš„goalåˆ°è¿™æ¡laneçš„æœ€çŸ­è·ç¦»çš„å¹³æ–¹ã€‚ Probability Estimation è·å¾—æ¦‚ç‡åˆ†å¸ƒçš„åšæ³•æ˜¯self-attentionã€‚é¦–å…ˆagentçš„featureç»è¿‡ä¸¤æ¬¡MLPã€‚ç„¶åæŠŠgoalçš„feature $F$ä½œä¸ºéœ€è¦queryçš„å˜é‡ï¼Œä»åœ°å›¾ä¸Šæ‰€æœ‰å…ƒç´  (laneï¼Œagent)çš„featureä¸­å»æŸ¥æ‰¾ç´¢å¼•å¯¹åº”çš„é”®å’Œå€¼ã€‚ç›®çš„å°±æ˜¯å»ºç«‹goalçš„featureä¸åœ°å›¾ä¸Šæ‰€æœ‰å…ƒç´ çš„è”ç³»ã€‚ç›´è§‚ä¸Šï¼Œè¿™ä¸€æ­¥æ˜¯æŠŠagentçš„æœªæ¥çŠ¶æ€(goal)è¡¨ç¤ºæˆç”±å†å²çš„ä¿¡æ¯ä½œä¸ºå˜é‡çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°é‡‡ç”¨çš„æ˜¯self-attentionçš„åšæ³•ã€‚ è½¨è¿¹ç›®æ ‡ç‚¹(goals)å’Œé“è·¯çš„å±€éƒ¨ä¿¡æ¯å¯ä»¥ç”¨ä»¥ä¸‹æ³¨æ„åŠ›æœºåˆ¶è¡¨ç¤º: $$\\mathbf{Q} = \\mathbf{FW}^{\\mathbf{Q}}, \\mathbf{K} = \\mathbf{LW}^{\\mathbf{K}}, \\mathbf{V}=\\mathbf{LW}^{\\mathbf{V}}$$ $$\\mathbf{A}(\\mathbf{Q},\\mathbf{K},\\mathbf{V}) = softmax(\\frac{\\mathbf{QK^\\top}}{\\sqrt{d_k}})\\mathbf{V}$$ where $\\mathbf{W}^Q, \\mathbf{W}^{K}, \\mathbf{W}^{V} \\in \\mathbb{R}^{d_h \\times d_k}$ are the matrices for linear projection, $d_k$ is the dimension of query / key / value vectors, and $\\mathbf{F}, \\mathbf{F}$ are feature matrices of the dense goal candidates and all map elements (i.e., lanes or agents), respectively. è¿™ä¸€æ­¥ä¹‹åçš„ç»“æœæ˜¯goalæ–°çš„feature $\\mathbf{F}$ã€‚å†é€šè¿‡ä¸¤æ¬¡MLPï¼Œå³ä¸‹å›¾ä¸­çš„ $g(.)$.ç”¨softmaxä¸­çš„æ–¹æ³•è·å¾—æ¯ä¸ªgoalçš„æ¦‚ç‡ã€‚å°†æ‰€æœ‰goalåœ¨åœ°å›¾ä¸Šè¡¨ç¤ºå‡ºæ¥çš„è¯å°±æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒheatmapã€‚ $$\\phi_i = \\frac{\\exp(g(\\mathbf{F}i))}{\\sum{n=1}^{N}\\exp(g(\\mathbf{F}_n))}$$ å¯¹äºLossçš„è®¡ç®—ï¼Œç¦»gtçš„goalæœ€è¿‘çš„goalçš„labelå®šä¸º1ï¼Œå…¶ä½™éƒ½ä¸º0.é‡‡å–äºŒåˆ†ç±»äº¤å‰ç†µçš„ç®—æ³•ã€‚ $$\\mathcal{L}\\text{goal} = \\mathcal{L}{\\text{CE}}(\\phi, \\psi)$$ Goal Set Prediction å¯¹äºå¤šæ„å›¾çš„é¢„æµ‹ï¼Œåœ¨TNTä¸­ï¼Œé¢„å…ˆè®¾å®šå¥½targetï¼Œé‡‡ç”¨NMS(non-maximum suppression)(é çš„è¿‘æˆ–æ¦‚ç‡ä½çš„è¿‡æ»¤æ‰)ã€‚è€ŒDenseTNTçš„ä¸Šä¸€æ­¥è·å¾—æ˜¯heatmapï¼Œå› æ­¤ä¸èƒ½ç®€å•ä½¿ç”¨NMSï¼Œå› ä¸ºç”¨äºç­›é€‰çš„é˜ˆå€¼æ¯”è¾ƒéš¾å®šã€‚è¿™æ˜¯å› ä¸ºTNTä¸­é‡‡ç”¨çš„æ˜¯ä»é«˜åˆ°ä½æ’åºæ¦‚ç‡ï¼Œè€ŒDenseTNTä¸­çš„æ¦‚ç‡åˆ†å¸ƒæ˜¯é’ˆå¯¹äºæ•´ä¸ªé¸Ÿç°å›¾çš„ï¼Œä¸€æ—¦æ„å›¾çš„å¯èƒ½æ€§å˜å¤šäº†ï¼Œå¹³å‡åˆ†å¸ƒåˆ°æ¯ä¸€ä¸ªæ„å›¾çš„æ¦‚ç‡å°±ä½äº†(å¯¹äºæ¦‚ç‡åˆ†å¸ƒï¼Œæ‰€æœ‰çš„ç‚¹çš„æ¦‚ç‡åŠ èµ·æ¥éœ€è¦ä¸º1)ã€‚ heatmapï¼Œè¾“å‡ºæ˜¯goal setï¼Œè¿™ä¸ªæœ‰ç‚¹åƒç›®æ ‡æ£€æµ‹çš„æ¡†ç”Ÿæˆã€‚ä½†å’Œç›®æ ‡æ£€æµ‹ä¸åŒï¼Œå¯¹äºä¸€ä¸ªè¾“å…¥ï¼Œæˆ‘ä»¬çš„labelåªæœ‰ä¸€ä¸ªï¼Œå³gtã€‚è¿™æ ·çš„è¯å¯èƒ½ä¼šæœ‰åˆ«çš„æ„å›¾çš„ç»“æœåœ¨è®­ç»ƒä¸­è¢«å¿½ç•¥ã€‚ä¸ºæ­¤ï¼Œè®¾è®¡äº†ä¸€ä¸ªoffline modelæ¥åˆ¶é€ è¿™äº›labelã€‚å®ƒå’Œonline modelçš„åŒºåˆ«å°±åœ¨è¿™ä¸€æ­¥ä¸­ã€‚æ²¡æœ‰ä½¿ç”¨goal set predictorè€Œæ˜¯é‡‡ç”¨äº†ä¼˜åŒ–ç®—æ³•ã€‚ Offline Optimization ä¸Šä¸€æ­¥heatmapçš„è¾“å‡ºï¼Œå®é™…ä¸Šæ˜¯å¯¹äºåœ°å›¾ä¸Šä¼—å¤šgoalæ¯ä¸ªç‚¹çš„ä¸€ä¸ªå‡½æ•°ã€‚è®¾å®š $C={c_1,c_2,â€¦,c_m}$ ä¸ºæ‰€æœ‰dense goalçš„candidateï¼Œheatmapå°±æŠŠ $C$ æ˜ å°„åˆ°ä¸€ä¸ª0åˆ°1çš„é›†åˆï¼Œå†™æˆ $h(c_i)$ ï¼Œè¿™ä¹Ÿæ˜¯æ¯ä¸ªgoalçš„æ¦‚ç‡ã€‚ æ¥ä¸‹æ¥å®šä¹‰ä¸€ä¸ªç›®æ ‡å‡½æ•°: $$E[d(\\hat{y}, Y)] = \\sum^m_{i=1}h(c_i)d(\\hat{y}, c_i)$$ å…¶ä¸­ï¼Œ$d(\\hat{y}, c_i) = \\mathop{\\min}\\limits_{y_i \\in \\hat{y}}||y_j - y_{c_i}||$ ä»ç›´è§‚ä¸Šè®²ï¼Œç›®æ ‡æ˜¯æœ‰Mä¸ªgoalï¼ˆå¤§æ± å­ï¼‰ï¼Œè¦ä»ä¸­é€‰å–Kä¸ªé è°±çš„goalï¼ˆå°æ± å­ï¼‰ã€‚ $d$ æ˜¯é’ˆå¯¹äºå¤§æ± å­çš„ï¼Œå¯¹äºå¤§æ± å­é‡Œæ‰€æœ‰candidateéƒ½æœ‰ä¸€ä¸ª $d$ã€‚è¿™æ¯ä¸ªcandidateéƒ½ä¸å°æ± å­ä¸­çš„goalè®¡ç®—è·ç¦»ï¼Œå–æœ€è¿‘çš„ä½œä¸º d d dï¼Œå³å¯»æ‰¾å°æ± å­ä¸­ç¦»candidateæœ€è¿‘çš„ç‚¹ã€‚å¯¹äºæ‰€æœ‰çš„ $d$ï¼Œç”¨æ¦‚ç‡åŠ æƒè®¡ç®—æœŸæœ›ã€‚æ€»ä½“çš„è¯åœ¨æ”¶æ•›æƒ…å†µï¼Œå¤§æ± å­ä¸­çš„æ‰€æœ‰goalåˆ°è·ç¦»è‡ªå·±æœ€è¿‘çš„å°æ± å­ä¸­çš„goalä¹˜ä¸Šæ¦‚ç‡åŠ æƒåº”å½“è¾¾åˆ°æœ€å°ã€‚ä»¥ä¸‹æ˜¯è¿™ä¸ªä¼˜åŒ–ç®—æ³•çš„å®ç°ã€‚ ç¿»è¯‘æˆä¸­æ–‡ï¼š åˆå§‹åŒ–Kä¸ªgoalï¼Œä»Mä¸ªgoalçš„å¤§æ± å­é‡Œéšæœºé€‰ å°æ± å­é‡Œçš„æ¯ä¸ªgoalåšéšæœºæ‰°åŠ¨ï¼Œå˜ä¸ºåˆ«çš„goal è®¡ç®—åŸæ¥çš„å’Œç°åœ¨çš„å°æ± å­çš„dçš„æœŸæœ›eå’Œeâ€™ å¦‚æœç°åœ¨çš„å°æ± å­dçš„æœŸæœ›æ›´å°ï¼Œåˆ™ä½¿ç”¨ç°åœ¨çš„å°æ± å­ã€‚å¦åˆ™ä»¥1%çš„æ¦‚ç‡é‡‡ç”¨ç°åœ¨çš„å°æ± å­ã€‚ï¼ˆé¿å…å±€éƒ¨æœ€ä¼˜ï¼‰ ä¸åœå¾ªç¯2-4ç›´åˆ°æ­¥æ•°è¾¾åˆ°é˜ˆå€¼ï¼ˆæˆ–æ—¶é—´å¤ªé•¿ï¼‰ ä¼˜åŒ–ç®—æ³•ä¹‹åå¾—åˆ°çš„å°±æ˜¯å…¨å±€æœ€ä¼˜çš„é€‰ä¸­çš„å°æ± å­ã€‚è¿™ä¸ªå°æ± å­é‡Œçš„ç»“æœèƒ½ä½œä¸ºè®­ç»ƒonlineæ¨¡å‹çš„ä¼ªlabelã€‚ Goal Set Predictor (online) æ¨¡å‹é‡‡ç”¨äº†encode+decodeçš„åŠæ³•ã€‚encoderéƒ¨åˆ†æ˜¯ä¸€å±‚self-attentionåŠ ä¸Šmax poolingï¼Œdecoderéƒ¨åˆ†æ˜¯2å±‚MLPï¼Œè¾“å…¥æ˜¯heatmapï¼Œè¾“å‡ºæ˜¯2K+1ä¸ªå€¼ï¼Œåˆ†åˆ«å¯¹åº”Kä¸ª2ç»´åæ ‡ï¼ˆgoal setï¼‰å’Œä¸€ä¸ªå½“å‰goal setçš„confidenceã€‚ è€ƒè™‘åˆ°heatmapçš„æ¦‚ç‡åˆ†å¸ƒæ¯”è¾ƒæ•£ï¼Œå¯ä»¥é‡‡ç”¨Nå¤´åŒæ—¶è¿ç®—ã€‚å³Nä¸ªgoal set predictorè¾“å‡ºNä¸ª2K+1çš„å€¼ï¼Œä»å½“ä¸­é€‰å–confidenceæœ€é«˜çš„é‚£ä¸ªgoal seté¢„æµ‹ã€‚ä¸ºäº†è¿ç®—æ•ˆç‡çš„æå‡ï¼Œè¿™Nå¤´ä½¿ç”¨ç›¸åŒçš„self-attentionå±‚ï¼Œä½†æ˜¯ä¸åŒçš„2ä¸ªMLPã€‚ åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé‡‡ç”¨äº†offlineæ¨¡å‹çš„ä¼ªlabelä½œä¸ºç›‘ç£ã€‚ä¸Šè¿°offlineä¸­è®²åˆ°çš„åˆå§‹é€‰å®šçš„å°æ± å­ï¼Œåœ¨è¿™é‡Œé‡‡ç”¨çš„æ˜¯onlineæ¨¡å‹çš„Kä¸ªgoalçš„setçš„é¢„æµ‹ã€‚ç„¶åç»è¿‡Læ¬¡éšæœºæ‰°åŠ¨ï¼ˆå³ä¸åœéšæœºé€‰å–é‚»å±…ç‚¹ï¼ŒL=100ï¼‰ï¼Œé€‰å–å½“ä¸­expected errorï¼ˆofflineé‡Œçš„æœŸæœ›é¡¹ï¼‰æœ€å°çš„é‚£ä¸ªsetä½œä¸ºä¼ªlabelã€‚ æ ‡è®° $\\dot{y}$ â€‹ä¸ºé¢„æµ‹ç»“æœï¼Œ $\\hat{y}$ â€‹ä¸ºä¼ªlabelï¼Œåˆ™lossçš„è®¡ç®—å¦‚ä¸‹ã€‚å³ä¸€ä¸€å¯¹åº”åçš„L1è·ç¦»ä¹‹å’Œã€‚ $$\\mathcal{L_{set}(\\dot{y}, \\hat{y})} = \\sum_{i=1}^{k}\\mathcal{L}_{\\text{reg}}(\\dot{y}, \\hat{y})$$ å†è€ƒè™‘åˆ°é‡‡ç”¨äº†Nå¤´é¢„æµ‹ï¼Œè¿™éƒ¨åˆ†çš„losså°†é‡‡ç”¨äºŒåˆ†ç±»çš„äº¤å‰ç†µã€‚å…¶ä¸­ $\\mu$ ä¸ºæ‰€æœ‰headçš„confidenceï¼Œ$\\nu$ ä¸ºlabelï¼Œåªæœ‰expected erroræœ€ä½çš„labelä¸º1ï¼Œåˆ«çš„ä¸º0ã€‚ $$\\mathcal{L}\\text{head} = \\mathcal{L}{\\text{CE}}(\\mu, \\nu)$$ Trajectory Completion è¿™ä¸€æ­¥å’ŒTNTåšæ³•ç±»ä¼¼ã€‚ç±»ä¼¼äºdense goal encodingï¼ˆ2å±‚MLPåè¿‡self-attentionï¼‰æœ€åè¿‡2å±‚MLPæ¥decodeå¾—åˆ°æ•´æ¡é¢„æµ‹è½¨è¿¹çš„stateã€‚é‡‡ç”¨teacher forcingæŠ€å·§ï¼ˆå› ä¸ºåªæœ‰ä¸€æ¡gtï¼‰è®­ç»ƒæ—¶åªç”¨gtçš„goalæ¥ç®—è¿™æ¡é¢„æµ‹è½¨è¿¹ã€‚Lossçš„ç®—æ³•å’ŒTNTä¸€æ ·ï¼Œç”¨çš„æ˜¯ç‚¹ç‚¹ä¹‹é—´çš„Huber lossã€‚ $$\\mathcal{L}{\\text{completion}}","date":"2023-07-16","objectID":"/posts/densetnt_tnt/:2:2","tags":["draft"],"title":"DenseTNT and TNT è®ºæ–‡è§£è¯»","uri":"/posts/densetnt_tnt/"},{"categories":["Prediction"],"content":"paper link: https://arxiv.org/abs/2007.13732 PPT: https://www.cs.toronto.edu/~byang/slides/LaneGCN.pdf ","date":"2023-07-16","objectID":"/posts/lanegcn/:0:0","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["Prediction"],"content":"Architechture Lane Graph + Actor Map: construct lane graph from vectorized map data to preserve the map structure and can avoid information loss æ„å»ºçŸ¢é‡åŒ–åœ°å›¾ä¿¡æ¯ï¼Œé¿å…åœ°å›¾ä¿¡æ¯ä¸¢å¤± LaneGCN: extends graph convolutions with multiple adjacency matrices and along-lane dilation to capture complex topology and long range dependencies of the lane graph. exploit a fusion network consisting of four types of interactions: actor-to-lane, lane-to-actor, actor-to-actor, lane-to-lane. present both actors and lanes as nodes in the graph and use a 1D CNN and LaneGCN to extract the features for the actor and lane nodes respectively, and then exploit spatial attention and another LaneGCN to model four types of interactions. Difference between VectorNet and LaneGCN: VecotrNet uses vanilla graph networks with undirected full connections; LaneGCN uses connected lane graph following the map topology and propose task specific multi-type and dilated graph operators. VectorNet uses polyline-level nodes for interactions; LaneGCN uses polyline segments as map nodes to capture higher resolution. ","date":"2023-07-16","objectID":"/posts/lanegcn/:1:0","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["Prediction"],"content":"Lane Graph Representations for Motion Forecasting ","date":"2023-07-16","objectID":"/posts/lanegcn/:2:0","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["Prediction"],"content":"ActorNet: Extracting Traffic Participant Representations Each Trajctory is represented as a sequence of displacement ${ \\bigtriangleup{p_{-(T-1)},â€¦,\\bigtriangleup{p_{-1}}, \\bigtriangleup{p_0}}}$, where $\\bigtriangleup{p_t}$ is the 2D displacement from time step $t-1$ to t, and T is the trajectory size. For trajectories with sizes smaller than $T$ , we pad them with zeros. We add a binary $1 Ã— T$ mask to indicate if the element at each step is padded or not and concatenate it with the trajectory tensor, resulting in an input tensor of size $3 Ã— T$. 1D CNN is used to process the trajectory input for its effectiveness in extracting multi-scale features and efficiency in parallel computing. The output of ActorNet is a temporal feature map, whose element at $t = 0$ is used as the actor feature. The network has 3 groups/scales of 1D convolutions. Each group consists of 2 residual blocks, with the stride of the first block as 2. We then use a Feature Pyramid Network (FPN) to fuse the multi-scale features, and apply another residual block to obtain the output tensor. For all layers, the convolution kernel size is 3 and the number of output channels is 128. Layer Normalization and the Rectified Linear Unit (ReLU) are used after each convolution. ","date":"2023-07-16","objectID":"/posts/lanegcn/:2:1","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["Prediction"],"content":"MapNet: Extracting Structured Map Representation General Architecture: part 1: building a lane graph from vectorized map data; part 2: applying our novel LaneGCN to the lane graph to output the map features. Map Data: In this paper, we adopt a simple form of vectorized map data as our representation of HD maps. Specifically, the map data is represented as a set of lanes and their connectivity. Each lane contains a centerline, i.e., a sequence of 2D BEV points, which are arranged following the lane direction (see Fig. 3, top). For any two lanes which are directly reachable, 4 types of connections are given: predecessor, successor, left neighbour and right neighbour. Lane Graph Construction: first define a lane node as the straight line segment formed by any two consecutive points (grey circles in Fig. 3) of the centerline. The location of a lane node is the averaged coordinates of its two end points. Following the connections between lane centerlines, we also derive 4 connectivity types 4 connectivity types for the lane nodes, i.e., predecessor, successor, left neighbour and right neighbour. We denote the lane nodes with $V âˆˆ \\mathbb R^{N Ã—2}$ , where $N$ is the number of lane nodes and the $i$-th row of $V$ is the BEV coordinates of the $i$-th node. We represent the connectivity with 4 adjacency matrices ${\\lbrace A_i \\rbrace}_{i \\in {pre,suc,left,right}}$ , with $A_i \\in \\mathbb R^{N Ã—N}$. We denote $A_{i,j,k}$, as the element in the $j$-th row and $k$-th column of $A_i$. Then $A_{i,j,k} = 1$ if node $k$ is an $i$-type neighbor of node $j$. LaneConv Operator: Node Feature: Each lane node corresponds to a straight line segment of a centerline. To encode all the lane node information, we need to take into account both the shape (size and orientation) and the location (the coordinates of the center) of the corresponding line segment. We parameterize the node feature as follows, $$x_i = MLP_{shape} (v_{i}^{end} - v_{i}^{start}) + MLP_{loc}(v_i) $$ where $MLP$ indicates a multi-layer perceptron and the two subscripts refer to shape and location, respectively. $v_i$ is the location of the i-th lane node, i.e., the center between two end points, $v_i^{start}$ and $v_i^{end}$ are the BEV coordinates of the node $iâ€™s$ starting and ending points, and $x_i$ is the $i$-th row of the node feature matrix $X$, denoting the input feature of the $i$-th lane node. LaneConv: To aggregate the topology information of the lane graph at a larger scale, we design the following LaneConv operator: $$Y = XW_0 + \\sum_{i\\in{pre, suc, left, right}}A_iXW_i,\\tag{2}$$ where $A_i$ and $W_i$ are the adjacency and the weight matrices corresponding to the $i$-th connection type respectively. Since we order the lane nodes from the start to the end of the lane, $A_{suc}$ and $A_{pre}$ are matrices obtained by shifting the identity matrix (diagnal 1) one step towards upper right (non-zero superdiagonal) and lower left (non-zero subdiagonal). $A_{suc}$ and $A_{pre}$ can propagate information from the forward and backward neighbours whereas $A_{left}$ and $A_{right}$ allow information to flow from the cross-lane neighbours. It is not hard to see that our LaneConv builds on top of the general graph convolution and encodes more geometric (e.g., connection type/direction) information. As shown in our experiments this improves over the vanilla graph convolution. Dilated LaneConv: Functionality: The model needs to capture the long range dependency along the lane direction for accurate prediction. the k-dilation LaneConv operator is defined as follows: $$Y = XW_0 + A_{pre}^k XW_{pre,k} + A_{suc}^k X W_{suc,k} \\tag{3}$$ where $A_{pre}^k$ is the $k$-th matrix power of $A_{pre}$. This allows us to directly propagate information along the lane for $k$ steps, with $k$ a hyperparameter. Since $A_{pre}^k$ is highly sparse, one can efficiently compute it using sparse matrix multiplication. Note that the dilated LaneConv is only used for predecessor and successor, as the long range","date":"2023-07-16","objectID":"/posts/lanegcn/:2:2","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["Prediction"],"content":"Fusion Net Four types fusion modules: A2L: introduces real-time traffic information to lane nodes, such as blockage or usage of the lanes. L2L: updates lane node features by propagating the traffic information over the lane graph. -\u003e LaneGCN L2A: fuses updated map features with real-time traffic information back to the actors. A2A: handles the interactions between actors and produces the output actor features, which are then used by the prediction header for motion forecasting. We implement L2L using another LaneGCN, which has the same architecture as the one used in our MapNet (see Section 3.2). In the following we describe the other three modules in detail. We exploit a spatial attention layer for A2L, L2A and A2A. The attention layer applies to each of the three modules in the same way. Taking A2L as an example, given an actor node i, we aggregate the features from its context lane nodes j as follows: $$y_i = x_i W_0 + \\sum_j \\phi (concat(x_i, \\Delta_{i,j}, x_j)W_1)W_2, \\tag{5}$$ with $x_i$ the feature of the $i$-th node, $W$ a weight matrix, $\\phi$ the compositon of layer notmalization and RelU, and $\\Delta_{ij} = MLP(v_j - v_i)$, where $v$ denotes the node location. ","date":"2023-07-16","objectID":"/posts/lanegcn/:2:3","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["Prediction"],"content":"Prediction Header Take after-fusion actor features as input, a multi-modal prediction header outputs the final motion forecasting. For each actor, it predicts $K$ possible future trajectories and their confidence scores. The header has two branches, a regression branch to predict the trajectory of each mode and a classification branch to predict the confidence score of each mode. For the m-th actor, we apply a residual block and a linear layer in the regression branch to regress the K sequences of BEV coordinates: $$O_{m,reg} = \\lbrace (p_{m,1}^k, p_{m,2}^k, â€¦, p_{m,T}^k) \\rbrace _{k\\in[0,K-1]}$$ where $p_{m,i}^k$ is the predicted $m$-th actorâ€™s BEV coordinates of the $k$-th mode at the $i$-th time step. For the classification branch, we apply an MLP to $p^k_{m,T} âˆ’ p_{m,0}$ to get $K$ distance embeddings. We then concatenate each distance embedding with the actor feature, apply a residual block and a linear layer to output $K$ confidence scores, $O_{m,cls} = (c_{m,0}, c_{m,1}, â€¦, c_{m,Kâˆ’1})$. ","date":"2023-07-16","objectID":"/posts/lanegcn/:2:4","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["Prediction"],"content":"Learning use the sum of classification and regreesion losses to train the model: $$ L = L_{cls} + \\alpha L_{reg},$$ where $\\alpha = 1.0$. For classification, we use the max-margin loss: $$L_{cls} = \\frac{1}{M(K-1)}\\sum_{m=1}^M \\sum_{k \\neq \\hat{k}} \\max(0, c_{m,k} + \\epsilon - c_{m, \\hat{k}}) \\tag{6}$$ where $\\epsilon$ is the margin and $M$ is the total number of actors. For regression, we apply the smooth $l1$ loss on all predicted time steps: $$L_{reg} = \\frac{1}{MT} \\sum_{m=1}^M \\sum_{t=1}^T reg(p_{m,y}^{\\hat{k}} - p_{m,t}^*) \\tag{7}$$ where $p_t^*$ is the ground truth BEV coordinates at time step $t$, $reg(x) = \\sum\\limits_i d(x_i)$, $x_i$ is the $i$-th element of $x$, and $d(x_i)$ is the smooth $\\ell1$ loss defined as: $$d(x_i) = \\begin{cases} 0.5x_i^2 \u0026\\text{if} ||x|| \u003c 1, \\ ||x_i|| - 0.5 \u0026 \\text{otherwise,} \\end{cases} \\tag{8}$$ where $||x_i||$ denotes the $\\ell1$ norm of $x_i$. ","date":"2023-07-16","objectID":"/posts/lanegcn/:2:5","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["Prediction"],"content":" Neural Network Layout ","date":"2023-07-16","objectID":"/posts/lanegcn/:2:6","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["Prediction"],"content":"Data Process And Network Construction ä»¥å®˜æ–¹çš„2645.csvæ•°æ®é›†ä¸ºä¾‹å­ agent node: data['city']:åŸå¸‚åç§° data['trajs'] = [agt_traj] + ctx_trajs:è½¨è¿¹ç‚¹ï¼Œ(agent + context vehicles) data['steps'] = [agt_step] + ctx_steps:åœ¨åŸå§‹æ•°æ®ä¸­çš„ä½ç½® data['feats'] = feats: (13 X 20 X 3) å‰20é¢„æµ‹è½¨è¿¹ + ä¸€ç»´æ˜¯å¦å­˜åœ¨ç‚¹ data['ctrs'] = ctrs: (13 X 2) ä¸­å¿ƒç‚¹ data['orig'] = orig: AGENT å½“å‰ç‚¹åæ ‡ data['theta'] = theta: AGENT åè½¬è§’ data['rot'] = rot: (2 X 2) æ—‹è½¬çŸ©é˜µ data['gt_preds'] = gt_preds:(13 X 30 X 2) å30å¸§çœŸå®è½¨è¿¹ data['has_preds'] = has_preds: (13 X 30) æ ‡è¯†å30å¸§è½¨è¿¹æ˜¯å¦å­˜åœ¨ lane node: graph['ctrs'] = np.concatenate(ctrs, 0): lane nodeçš„ä¸­å¿ƒç‚¹åæ ‡ graph['num_nodes'] = num_nodes: lane nodeçš„æ•°é‡ graph['feats'] = np.concatenate(feats, 0): lane node æ–¹å‘å‘é‡ graph['turn'] = np.concatenate(turn, 0): lane node è½¬å‘æ ‡è¯† graph['control'] = np.concatenate(control, 0): lane node çš„ has_traffic_control æ ‡è¯† graph['intersect'] = np.concatenate(intersect, 0): lane node çš„ is_intersection æ ‡è¯† graph['pre'] = [pre]: pre[â€˜uâ€™] å’Œ pre[â€˜vâ€™], v æ˜¯ u çš„preï¼Œ è¿™é‡Œè¡¨è¿°çš„æ˜¯lane nodeä¹‹é—´çš„å…³ç³» graph['suc'] = [suc]: suc[â€˜uâ€™] å’Œ suc[â€˜vâ€™], v æ˜¯ u çš„sucï¼Œ è¿™é‡Œè¡¨è¿°çš„æ˜¯lane nodeä¹‹é—´çš„å…³ç³» graph['lane_idcs'] = lane_idcs: lane node index 0 0 0 ... 0 1 1 1 ... 1 ... 83 83 83 ... 83 graph['pre_pairs'] = pre_pairs: pair è¡¨è¿°çš„æ˜¯laneä¹‹é—´çš„å…³ç³» graph['suc_pairs'] = suc_pairs: pair è¡¨è¿°çš„æ˜¯laneä¹‹é—´çš„å…³ç³» graph['left_pairs'] = left_pairs: pair è¡¨è¿°çš„æ˜¯laneä¹‹é—´çš„å…³ç³» graph['right_pairs'] = right_pairs: pair è¡¨è¿°çš„æ˜¯laneä¹‹é—´çš„å…³ç³» å¯¹äºpre['u']å’Œpre['v'], v æ˜¯ u çš„ pre å¯¹äºsuc['u']å’Œsuc['v'], v æ˜¯ u çš„ suc å¯¹äºleft['u']å’Œleft['v'], v æ˜¯ u çš„ left å¯¹äºright['u']å’Œright['v'], v æ˜¯ u çš„ right Netç»“æ„ ActorNet input: M x 3 x 20 output: M x 128 x 20 è§£é‡Š: MapNet: æŠŠ v æŒ‰ç…§ u åŠ åˆ°centerä¸Š input: N x 4 output: N x 128 A2M input: N x 128 output: N x 128 M2M input: N x 128 output: N x 128 M2A input: N x 128 output: M x 128 A2A input: N x 128 output: N x 128 Prediction Header: input M x 128 MLP Regression MLP Classification ref link: https://zhuanlan.zhihu.com/p/447129428 ","date":"2023-07-16","objectID":"/posts/lanegcn/:2:7","tags":["LaneGCN"],"title":"LaneGCN è®ºæ–‡è§£è¯»","uri":"/posts/lanegcn/"},{"categories":["draft"],"content":"paper link: https://arxiv.org/abs/2012.11717 è®ºæ–‡è§£è¯»å‚è€ƒ: [1] https://zhuanlan.zhihu.com/p/434650863 [2] https://www.gushiciku.cn/pl/amod ","date":"2023-07-16","objectID":"/posts/social_nce/:0:0","tags":["draft"],"title":"Social_NCE è®ºæ–‡è§£è¯»","uri":"/posts/social_nce/"},{"categories":["draft"],"content":"Issue to solve and its Solution Due to the ill-distributed training Data, itâ€™s difficult to capture the notion of the â€œnegativeâ€ examples like collision. Solution: Modeling the negative samples through self-supervision: a social contrastive loss: regularizes the extracted motion representation by discerning the ground-truth positive events from synthetic negative ones; Construct negative samples based on prior knowledge of rare but dangerous circumstances. a social sampling strategy (informed): construct the positive event from the ground-truth location of the primary agent and the negative events from the regions of other neighbors. given that one location cannot be occupied by multiple agents at the same time. ","date":"2023-07-16","objectID":"/posts/social_nce/:1:0","tags":["draft"],"title":"Social_NCE è®ºæ–‡è§£è¯»","uri":"/posts/social_nce/"},{"categories":["draft"],"content":"Method: Contrastive Learning + Social NCE ","date":"2023-07-16","objectID":"/posts/social_nce/:2:0","tags":["draft"],"title":"Social_NCE è®ºæ–‡è§£è¯»","uri":"/posts/social_nce/"},{"categories":["draft"],"content":"Contrastive Representation Learning Functionality: Representation Learning: to learn a parametric function that maps the raw data into a feature space to extract abstract and useful information for downstream tasks. NCE(Noise Contrastive Estimation): to train encoder $$\\mathcal{L_{NCE}} = -\\log \\frac{\\exp(sim(q,k^+)/\\tau)}{\\sum_{n=0}^N \\exp(sim(q,k_n)/ \\tau)}$$ where the encoded query $q$ is brought close to one positive key $k_0 = k^+$ and pushed apart from $N$ negative keys ${ k_1, k_2, â€¦ , k_N}$, $\\tau$ is a temperature hyperparameter, and $sim(u,v) = u^{\\mathsf{T}}v/(||u||||v||)$ is the cosine similarity between two feature vectors. ","date":"2023-07-16","objectID":"/posts/social_nce/:2:1","tags":["draft"],"title":"Social_NCE è®ºæ–‡è§£è¯»","uri":"/posts/social_nce/"},{"categories":["draft"],"content":"Social NCE Social NCE Description: æ™ºèƒ½ä½“ $i$ åœ¨æ—¶åˆ» $t$ ä¸Šçš„ä½ç½®è®°ä¸º $s^i_t=(x^i_t,y^i_t)$ ã€‚é‚£ä¹ˆ $M$ ä¸ªæ™ºèƒ½ä½“çš„è”åˆçŠ¶æ€è®°ä¸º $s_t = { s_t^1, â€¦, s^M_t}$ ã€‚ç»™å®šä¸€ä¸ªå†å²è§‚æµ‹åºåˆ— ${s_1, s_2, â€¦, s_t}$ ï¼Œä»»åŠ¡æ˜¯é¢„æµ‹æ‰€æœ‰æ™ºèƒ½ä½“æœªæ¥ç›´è‡³ $T$ æ—¶åˆ»çš„è½¨è¿¹ ${s_{t+1}, â€¦, s_T}$ï¼Œè®¸å¤šæœ€è¿‘çš„é¢„æµ‹æ¨¡å‹è¢«è®¾è®¡ä¸ºç¼–ç å™¨ - è§£ç å™¨ç¥ç»ç½‘ç»œï¼Œå…¶ä¸­è¿åŠ¨ç¼–ç å™¨ $f(\\cdot)$ é¦–å…ˆæå–ä¸ $i$ ç›¸å…³çš„ç´§å¯†è¡¨ç¤º $h_t^i$ ï¼Œç„¶åè§£ç å™¨ $g(\\cdot)$ éšåæ¨æµ‹å‡ºå…¶æœªæ¥çš„è½¨è¿¹ $\\hat{s}^i_{t+1,T}$ : $$h^i_t = f(s_{1:t}, i), $$ $$\\hat{s}^i_{t+1:T} = g(h^i_t)$$ ä¸ºäº†å¤šæ™ºèƒ½ä½“ä¹‹é—´çš„ç¤¾äº¤äº’åŠ¨ï¼Œ$f(\\cdot)$é€šå¸¸åŒ…å«ä¸¤ä¸ªå­æ¨¡å—ï¼šä¸€ä¸ªåºåˆ—å»ºæ¨¡æ¨¡å— $f_S(\\cdot)$ ç”¨äºç¼–ç æ¯ä¸ªå•ç‹¬çš„åºåˆ—ï¼Œä»¥åŠä¸€ä¸ªäº¤äº’æ¨¡å— $f_I(\\cdot)$ ç”¨äºåœ¨å¤šæ™ºèƒ½ä½“ä¹‹é—´å…±äº«ä¿¡æ¯ï¼š $$z^i_t = f_S(h^i_{t-1}, s^i_t),$$ $$h^i_t = f_I(z_t, i)$$ å…¶ä¸­ï¼Œ $z^i_t$ æ˜¯ç»™å®šæ™ºèƒ½ä½“ $i$ åœ¨æ—¶é—´ $t$ è§‚å¯Ÿå…¶è‡ªèº«çŠ¶æ€çš„æ½œåœ¨è¡¨ç¤ºï¼Œ $z_t = {z^1_t,â€¦,z^M_t}$ ã€‚å¾ˆå¤šæ–¹æ³•å·²ç»æ¢ç´¢äº†å„ç§æ¶æ„ï¼Œå¹¶éªŒè¯äº†å…¶å‡†ç¡®æ€§ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ƒä»¬çš„é²æ£’æ€§ä»ç„¶æ˜¯ä¸€ä¸ªæ‚¬è€Œæœªå†³çš„é—®é¢˜ã€‚ æœ€è¿‘çš„å‡ é¡¹å·¥ä½œè¡¨æ˜ï¼Œç°æœ‰æ¨¡å‹é¢„æµ‹çš„è½¨è¿¹é€šå¸¸ä¼šè¾“å‡ºç¤¾ä¼šä¸å¯æ¥å—çš„è§£å†³æ–¹æ¡ˆï¼ˆä¾‹å¦‚ï¼Œç¢°æ’ï¼‰ï¼Œè¡¨æ˜ç¼ºä¹å…³äºç¤¾ä¼šå‡†åˆ™çš„å¸¸è¯†ã€‚ query: embedding of history observations $q = \\psi(h^i_t)$, where $\\psi(\\cdot)$ is an MLP projection head; key: embedding of a future event $k = \\phi(s^i_{s+\\delta t}, \\delta t)$, where $\\phi(\\cdot)$ is an event encoder modeled by an MLP, $s_{t+\\delta t}^i$ is a sampled spatial location and $\\delta_t \u003e 0$ is the sampling horizon. tuning $\\delta_t \\in \\Lambda$, e.g. $\\Lambda = {1,â€¦,4}$, then future events in the next few step can be taken in account simultaneously. Nevertheless, when $\\delta_t$ is a fixed value, then $\\phi(\\cdot)$ can be simplified as a location encoder, i.e., $\\phi(s^i_{t+\\delta t})$. ç»™å®šä¸€ä¸ªåœºæ™¯ï¼ŒåŒ…æ‹¬æ„Ÿå…´è¶£çš„ä¸»æ™ºä½“ï¼ˆè“è‰²ï¼‰å’Œé™„è¿‘å¤šä¸ªç›¸é‚»æ™ºä½“ï¼ˆç°è‰²ï¼‰ï¼ŒSocial-NCE æŸå¤±é¼“åŠ±åœ¨åµŒå…¥ç©ºé—´ä¸­æå–çš„è¿åŠ¨è¡¨ç¤ºï¼Œæ¥è¿‘æœªæ¥çš„æ­£æ ·æœ¬äº‹ä»¶ï¼Œå¹¶è¿œç¦»å¯èƒ½å¯¼è‡´ç¢°æ’æˆ–ä¸é€‚çš„åˆæˆè´Ÿæ ·æœ¬äº‹ä»¶. Social NCEçš„æŸå¤±å‡½æ•°å¦‚ä¸‹: $$\\mathcal{L_{SocialNCE}} = -\\log\\frac{\\exp(\\psi(h^i_t)\\cdot\\phi(s^{i,+}{t+\\delta t}, \\delta t)/\\tau)}{\\sum{\\delta t\\in\\Lambda}\\sum_{n=0}^{N}\\exp(\\psi(h^i_t)\\cdot\\phi(s^{i,n}_{t+\\delta t}, \\delta t)/\\tau))}$$ æœ€ç»ˆçš„è®­ç»ƒæŸå¤±å‡½æ•°ä¸ºSocial-NCEå’Œä¼ ç»Ÿä»»åŠ¡æŸå¤±é¡¹ä¹‹å’Œï¼Œå³è½¨è¿¹é¢„æµ‹çš„mean squared error (MSE) æˆ–è€…negative log-likelihood (NLL)ï¼š $$\\mathcal{L}(f,g,\\psi, \\phi) = \\mathcal{L}{task}(f,g) + \\lambda \\mathcal{L}{SocialNCE}(f, \\psi, \\phi)$$ å…¶ä¸­ï¼Œ$\\lambda$ ä¸ºè¶…å‚æ•°ï¼Œæ§åˆ¶SocialNCEæŸå¤±å‡½æ•°çš„é‡è¦ç¨‹åº¦ã€‚ ","date":"2023-07-16","objectID":"/posts/social_nce/:2:2","tags":["draft"],"title":"Social_NCE è®ºæ–‡è§£è¯»","uri":"/posts/social_nce/"},{"categories":["draft"],"content":"sampling strategy in multi-agent context é‡‡æ ·ç­–ç•¥ åœ¨å…¶ä»–æ™ºèƒ½ä½“é™„è¿‘å¯»æ±‚æ›´å¤šä¿¡æ¯çš„è´Ÿæ ·æœ¬: $$s^{i,n-}{t+\\delta t} = s^{j}{t+\\delta t} + \\bigtriangleup{s_p} + \\epsilon$$ å…¶ä¸­ï¼Œ $j\\in{1,2,â€¦,M} \\backslash i$ æ˜¯å…¶ä»–agentçš„index, $\\bigtriangleup{s_p}$ æ˜¯é€‚åˆç¤¾äº¤è·ç¦»çš„å±€éƒ¨ä½ç§»ã€‚ å¯¹äºpositive sample, å¯¹è¯¥agentå‘¨å›´ç›´æ¥é‡‡æ ·è·å¾—: $$s^{i,n-}{t+\\delta t} = s^{i}{t+\\delta t} + \\epsilon$$ ","date":"2023-07-16","objectID":"/posts/social_nce/:2:3","tags":["draft"],"title":"Social_NCE è®ºæ–‡è§£è¯»","uri":"/posts/social_nce/"},{"categories":["Prediction"],"content":"paper link: https://arxiv.org/abs/2002.11927?from=leiphonecolumn_paperreview0323 ","date":"2023-07-16","objectID":"/posts/social_stgcnn/:0:0","tags":["draft"],"title":"Social_STGCNN è®ºæ–‡è§£è¯»","uri":"/posts/social_stgcnn/"},{"categories":["Prediction"],"content":"ç½‘ç»œç»“æ„ ç‰¹ç‚¹: Social STGCNNä¸åŒäºå…¶ä»–æ–¹æ³•åªæ˜¯èšåˆå„ç§å­¦ä¹ çš„è¡ŒäººçŠ¶æ€ï¼Œè€Œæ˜¯å¯¹è¡Œäººäº¤äº’åšå›¾å»ºæ¨¡ã€‚å…¶ä¸­æå‡ºä¸€ç§kernel functionæŠŠè¡Œäººç¤¾äº¤äº¤äº’åµŒå…¥ä¸€ä¸ªadjacency matrixã€‚ ä»£ç æ˜¾ç¤ºï¼Œå›¾å»ºæ¨¡ä¸€èˆ¬åœ¨æ•°æ®å‰å¤„ç†å®Œæˆã€‚ ","date":"2023-07-16","objectID":"/posts/social_stgcnn/:1:0","tags":["draft"],"title":"Social_STGCNN è®ºæ–‡è§£è¯»","uri":"/posts/social_stgcnn/"},{"categories":["Prediction"],"content":"Model Description ä¸¤éƒ¨åˆ†ï¼šæ—¶ç©ºå›¾å·ç§¯ç¥ç»ç½‘ç»œST-GCNNã€æ—¶é—´å¤–æ¨å™¨TXP-CNNã€‚ ST-GCNNå¯¹è¡Œäººè½¨è¿¹çš„å›¾è¡¨ç¤ºè¿›è¡Œæ—¶ç©ºå·ç§¯æ“ä½œä»¥æå–ç‰¹å¾ã€‚è¿™äº›ç‰¹å¾æ˜¯è§‚å¯Ÿåˆ°çš„è¡Œäººè½¨è¿¹å†å²çš„ç´§å‡‘è¡¨ç¤ºã€‚ TXP-CNNå°†è¿™äº›ç‰¹å¾ä½œä¸ºè¾“å…¥ï¼Œå¹¶é¢„æµ‹æ‰€æœ‰è¡Œäººä½œä¸ºä¸€ä¸ªæ•´ä½“çš„æœªæ¥è½¨è¿¹ã€‚æˆ‘ä»¬ä½¿ç”¨æ—¶é—´å¤–æ¨å™¨çš„åå­—æ˜¯å› ä¸ºTXP-CNNæœŸæœ›é€šè¿‡å·ç§¯è¿ç®—å¤–æ¨æœªæ¥çš„è½¨è¿¹ã€‚ ç»™å®šTå¸§ï¼Œæ„é€ è¡¨ç¤º $G=(V,A)$ çš„æ—¶ç©ºå›¾. ç„¶åï¼Œ$G$ é€šè¿‡æ—¶ç©ºå›¾å·ç§¯ç¥ç»ç½‘ç»œ(ST-GCNNs)è½¬å‘ï¼Œåˆ›å»ºä¸€ä¸ªæ—¶ç©ºåµŒå…¥ã€‚ ä¹‹åï¼ŒTXP-CNNs é¢„æµ‹äº†æœªæ¥çš„è½¨è¿¹ã€‚ $P$ æ˜¯è¡Œäººä½ç½®çš„ç»´æ•°ï¼Œ$N$ æ˜¯è¡Œäººçš„æ•°ç›®ï¼Œ$T$ æ˜¯æ—¶é—´æ­¥é•¿, $\\hat{P}$æ˜¯æ¥è‡ªST-GCNNçš„åµŒå…¥çš„ç»´æ•°. (1) Graph Representation of Pedestrian Trajectories æˆ‘ä»¬é¦–å…ˆæ„é€ ä¸€ç»„ç©ºé—´å›¾ $G_t$ï¼Œè¡¨ç¤ºæ¯ä¸ªæ—¶é—´æ­¥é•¿ $t$ åœ¨åœºæ™¯ä¸­è¡Œäººçš„ç›¸å¯¹ä½ç½®ï¼Œ$G_t = (V_t, E_t)$ ã€‚ $V_t$æ˜¯å›¾ $G_t$ çš„é¡¶ç‚¹é›†ï¼Œè§‚å¯Ÿåˆ°çš„ä½ç½® $(x^i_tï¼Œy^i_t)$ æ˜¯é¡¶ç‚¹ $v^i_t$ çš„å±æ€§; $E_t$ æ˜¯è¾¹é›†ï¼Œå¦‚æœé¡¶ç‚¹ $v^i_t$ å’Œé¡¶ç‚¹ $v^j_t$ ç›¸è¿ $e^{ij}_t = 1$ ï¼Œå¦åˆ™ $=0$ã€‚ ä¸ºäº†å»ºæ¨¡ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´ç›¸äº’å½±å“çš„å¼ºåº¦ï¼Œæˆ‘ä»¬é™„åŠ äº†ä¸€ä¸ªå€¼$a^{ij}_t$, å®ƒæ˜¯ç”±æ¯ä¸ª$ e^{ij}_t$ çš„æŸç§æ ¸å‡½æ•°è®¡ç®—å¾—åˆ°ã€‚$a^{ij}_t$ è¢«ç»„ç»‡ä¸ºå¸¦æƒé‚»æ¥çŸ©é˜µ$A_t$ã€‚ $a^{ij}_{sim,t}$æ˜¯è¦åœ¨é‚»æ¥çŸ©é˜µ$A_t$ä¸­ä½¿ç”¨çš„å†…æ ¸å‡½æ•°ã€‚ å®šä¹‰ä¸º: $$\\begin{equation} a^{ij}_{sim,t}= \\left { \\begin{aligned} 1/||v^i_t - v^j_t||_2 , ||v^i_t - v^j_t||_1\\neq0 \\ 0, Otherwise \\end{aligned} \\right. \\end{equation}$$ (2) Graph Convolution Neural Network å¯¹äºåœ¨äºŒç»´ç½‘æ ¼åœ°å›¾æˆ–ç‰¹å¾åœ°å›¾ä¸Šå®šä¹‰çš„å·ç§¯è¿ç®—ï¼Œå®šä¹‰å¦‚ä¸‹: $$z^{(l+1)} = \\sigma(\\sum_{h=1}^{k}\\sum_{\\omega=1}^{k}(p(z^{(l)},h, \\omega) \\cdot \\boldsymbol{W}^{(l)}(h, \\omega))$$ å…¶ä¸­ï¼Œ$k$æ˜¯å†…æ ¸å¤§å°ï¼Œ$p(.)$ æ˜¯é‡‡æ ·å‡½æ•°ï¼Œå…¶èšé›†ä»¥$z$ä¸ºä¸­å¿ƒçš„é‚»å±…çš„ä¿¡æ¯ï¼Œ $\\sigma$ æ˜¯æ¿€æ´»å‡½æ•°ã€‚${l}$è¡¨ç¤ºç¥ç»ç½‘ç»œå±‚ã€‚ å›¾å·ç§¯å®šä¹‰å¦‚ä¸‹: $$v^{i(l+1)} =\\sigma (\\frac{1}{\\Omega}\\sum_{v^{j(l)}\\in B(v^{j(l)})}p(v^{i(l)}, v^{j(l)}) \\cdot \\boldsymbol{W}(v^{i(l)}, v^{j(l)}))$$ å…¶ä¸­$\\frac{1}{\\Omega}$ æ˜¯æ­£åˆ™åŒ–é¡¹ï¼Œ$B(v^i) = { v^j|d(v^i,v^j)â‰¤D }$æ˜¯é¡¶ç‚¹çš„é‚»å±…é›†ï¼Œè€Œ$d(v^i,v^j)$è¡¨ç¤ºè¿æ¥$v^i$å’Œ$v^j$çš„æœ€çŸ­è·ç¦»ï¼Œ $\\Omega$æ˜¯é‚»å±…é›†çš„åŸºæ•°ã€‚ (3) Spatio-Temporal Graph Convolution Neural Network(ST-GCNNs) é€šè¿‡å®šä¹‰ä¸€ä¸ªæ–°çš„å›¾Gï¼Œå…¶å±æ€§æ˜¯$G_t$å±æ€§çš„é›†åˆï¼ŒST-GCNNå°†ç©ºé—´å›¾å·ç§¯æ‰©å±•åˆ°æ—¶ç©ºå›¾å·ç§¯ã€‚ $G$ç»“åˆäº†è¡Œäººè½¨è¿¹çš„æ—¶ç©ºä¿¡æ¯ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ$G_1ï¼Œâ€¦ï¼ŒG_T$çš„æ‹“æ‰‘ç»“æ„æ˜¯ç›¸åŒçš„ï¼Œè€Œå½“tå˜åŒ–æ—¶ï¼Œä¸åŒçš„å±æ€§è¢«åˆ†é…ç»™$v^i_t$ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å°†$G$å®šä¹‰ä¸º$(V,E)$ï¼Œå…¶ä¸­$V={v_i|i\\in { 1ï¼Œâ€¦ï¼ŒN }}$ å’Œ $E={e_{ij}|iï¼Œjï¼Œ{1ï¼Œâ€¦ï¼ŒN}}$ã€‚ é¡¶ç‚¹$v_i$åœ¨Gä¸­çš„å±æ€§æ˜¯$v^i_t$çš„é›†åˆï¼Œ$âˆ€tâˆˆ{0ï¼Œâ€¦ï¼ŒT}$ã€‚ å¦å¤–ï¼Œ åŠ æƒé‚»æ¥çŸ©é˜µAå¯¹åº”äº$G$ æ˜¯${ A_1ï¼Œâ€¦ï¼ŒA_T}$çš„é›†åˆã€‚ æˆ‘ä»¬å°†ST-GCNNäº§ç”Ÿçš„åµŒå…¥è¡¨ç¤ºä¸º $\\overline{V}$. (4) Time-Extrapolator Convolution Neural Network (TXP-CNN) ST-GCNNçš„åŠŸèƒ½æ˜¯ä»è¾“å…¥å›¾ä¸­æå–æ—¶ç©ºèŠ‚ç‚¹åµŒå…¥ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é¢„æµ‹è¡Œäººæœªæ¥çš„è¿›ä¸€æ­¥ä½ç½®ã€‚ TXP-CNNç›´æ¥ä½œç”¨äºå›¾åµŒå…¥ $\\overline{V}$ çš„æ—¶é—´ç»´åº¦ï¼Œå¹¶å°†å…¶æ‰©å±•ä¸ºé¢„æµ‹çš„å¿…è¦æ¡ä»¶ã€‚ ç”±äºTXP-CNNä¾èµ–äºç‰¹å¾ç©ºé—´çš„å·ç§¯è¿ç®—ï¼Œå› æ­¤ä¸é€’å½’å•å…ƒç›¸æ¯”ï¼Œå®ƒçš„å‚æ•°è¾ƒå°ã€‚éœ€è¦æ³¨æ„çš„ä¸€ä¸ªç‰¹æ€§æ˜¯ï¼Œ TXP-CNNå±‚ä¸æ˜¯ç½®æ¢ä¸å˜çš„ï¼Œå› ä¸ºåœ¨TXP-CNNä¹‹å‰ï¼Œå›¾åµŒå…¥çš„å˜åŒ–ä¼šå¯¼è‡´ä¸åŒçš„ç»“æœã€‚Other than this, if the order of pedestrians is permutated starting from the input to Social-STGCNN then the predictions are invariant. ","date":"2023-07-16","objectID":"/posts/social_stgcnn/:1:1","tags":["draft"],"title":"Social_STGCNN è®ºæ–‡è§£è¯»","uri":"/posts/social_stgcnn/"},{"categories":["Prediction"],"content":"model(Social STGCNN) Implementation Adjacency Matrix Normalization $$ A_t = \\Lambda_t^{-\\frac{1}{2}}\\hat{A}\\Lambda_t^{-\\frac{1}{2}}$$ where $\\hat{A_t} = A_t + I$ and $\\Lambda_t$ is the diagonal node degree matric of $\\hat{A_t}$. We use $\\hat{A}$ and $\\Lambda$ to denote the stack of $\\hat{A_t}$ and $\\Lambda_t$ repectively. The normalization of adjacency is essential for the graph CNN to work properly. STGCNN Network Mechanism $$f(V^{l}, A) = \\sigma(\\Lambda_t^{-\\frac{1}{2}}\\hat{A}\\Lambda_t^{-\\frac{1}{2}}V^{(l)}W^{(l)})$$ where, $V^{(l)}$ denotes the stack of $V^{(l)}_t$, and $W^{(l)}$ denotes the trainable parameters. ","date":"2023-07-16","objectID":"/posts/social_stgcnn/:1:2","tags":["draft"],"title":"Social_STGCNN è®ºæ–‡è§£è¯»","uri":"/posts/social_stgcnn/"},{"categories":["Prediction"],"content":"Data Processing æ•°æ®å¤„ç†ä»¥åŠå›¾æ„å»º obs_traj - å‰8å¸§è§‚å¯Ÿè½¨è¿¹(ç»å¯¹åæ ‡) pred_traj_gt - å12å¸§é¢„æµ‹è½¨è¿¹(ground truth)(ç»å¯¹åæ ‡) obs_traj_rel - å‰8å¸§è§‚å¯Ÿè½¨è¿¹(ç›¸å¯¹åæ ‡) pred_traj_gt_rel - å12å¸§é¢„æµ‹è½¨è¿¹(ground truth)(ç›¸å¯¹åæ ‡) non_linear_ped - éçº¿æ€§è½¨è¿¹ (å‰”é™¤) loss_mask V_obs - graph nodes A_obs - graph Adjacency Matrix V_tr - é¢„æµ‹è½¨è¿¹ graph nodes A_tr - é¢„æµ‹è½¨è¿¹ graph Adjacency Matrix ","date":"2023-07-16","objectID":"/posts/social_stgcnn/:2:0","tags":["draft"],"title":"Social_STGCNN è®ºæ–‡è§£è¯»","uri":"/posts/social_stgcnn/"},{"categories":["Math"],"content":"ä¸€ã€ æœ€å°äºŒä¹˜æ³•æ‹Ÿåˆç›´çº¿ æœ€å°äºŒä¹˜æ‹Ÿåˆ æ˜¯ä¸€ç§æ•°å­¦ä¸Šçš„è¿‘ä¼¼å’Œä¼˜åŒ–ï¼Œåˆ©ç”¨å·²çŸ¥çš„æ•°æ®å¾—å‡ºä¸€æ¡ç›´çº¿æˆ–è€…æ›²çº¿ï¼Œä½¿ä¹‹åœ¨åæ ‡ç³»ä¸Šä¸å·²çŸ¥æ•°æ®ä¹‹é—´çš„è·ç¦»çš„å¹³æ–¹å’Œæœ€å°ã€‚ TLS(Total Least Squares) vs OLS(Ordinary Least Squares) TSL vs OLS å¦‚ä¸Šå›¾ï¼ŒTLS å’Œ OLS éƒ½æ˜¯æœ€å°äºŒä¹˜æ‹Ÿåˆï¼Œåªæ˜¯åœ¨åå·®è¯„ä¼°ä¸Šé‡‡å–äº†ä¸åŒçš„æ–¹å¼ã€‚ æœ€å°äºŒä¹˜æ³•æ˜¯ä¸€ç§è¾ƒä¸ºç®€å•çš„å›å½’åˆ†ææ–¹æ³•ã€‚ æœ€å¸¸ç”¨çš„æ˜¯ OLS(Ordinary Least Squareï¼Œæ™®é€šæœ€å°äºŒä¹˜æ³•): æ‰€é€‰æ‹©çš„å›å½’æ¨¡å‹åº”è¯¥ä½¿æ‰€æœ‰è§‚å¯Ÿå€¼çš„æ®‹å·®å¹³æ–¹å’Œè¾¾åˆ°æœ€å°ï¼ˆå¦‚ä¸Šå›¾å·¦ï¼‰ã€‚ OLS // Gary: O-Least-Squareæœ€å°äºŒä¹˜æ‹Ÿåˆ Segment::LocalLine Segment::fitLocalLine(const std::list\u003cBin::MinZPoint\u003e \u0026points) { const unsigned int n_points = points.size(); // æ„é€  X/Y çŸ©é˜µ Eigen::MatrixXd X(n_points, 2); Eigen::VectorXd Y(n_points); unsigned int counter = 0; for (auto iter = points.begin(); iter != points.end(); ++iter) { X(counter, 0) = iter-\u003ed; X(counter, 1) = 1; Y(counter) = iter-\u003ez; ++counter; } // è®¡ç®— B const Eigen::MatrixXd X_t = X.transpose(); const Eigen::VectorXd result = (X_t * X).inverse() * X_t * Y; LocalLine line_result; line_result.first = result(0); line_result.second = result(1); return line_result; } Eigen æ˜¯C++ä¸­å¯ä»¥ç”¨æ¥è°ƒç”¨å¹¶è¿›è¡ŒçŸ©é˜µè®¡ç®—çš„ä¸€ä¸ªåº“ï¼Œé‡Œé¢å°è£…äº†ä¸€äº›ç±»ã€‚ BP Network é€šè¿‡è§£ $XB=Y$ æˆ‘ä»¬å°±èƒ½è§£å‡º $B=[m b]$ï¼š $$\\begin{gathered} m = \\frac{\\sum x_{i}^{2}\\sum y_{i}-\\sum x_{i}(\\sum x_{i}y_{i})}{n\\sum x_{i}^{2}-(\\sum x_{i})^{2}} \\\\ b = \\frac{n\\sum x_{i}\\sum y_{i}-\\sum x_{i}(\\sum x_{i}y_{i})}{n\\sum x_{i}^{2}-(\\sum x_{i})^{2}} \\end{gathered}$$ OrdinaryLeastSquare(const vector\u003cdouble\u003e\u0026 x, const vector\u003cdouble\u003e\u0026 y) { double t1=0, t2=0, t3=0, t4=0; for(int i=0; i\u003cx.size(); ++i) { t1 += x[i]*x[i]; t2 += x[i]; t3 += x[i]*y[i]; t4 += y[i]; } m = (t3*x.size() - t2*t4) / (t1*x.size() - t2*t2); b = (t1*t4 - t2*t3) / (t1*x.size() - t2*t2); } OLS è¿™ç§ least square å­˜åœ¨é—®é¢˜ï¼Œæ¯”å¦‚é’ˆå¯¹å‚ç›´çº¿æ®µå°±ä¸è¡Œï¼Œäºæ˜¯å¼•å…¥ç¬¬äºŒç§ Total Least Squareã€‚ BP Network BP Network å…¶ä¸­ï¼Œ$U=\\begin{bmatrix}x_1-\\overline{x}\u0026y_1-\\overline{y}\\\\\\vdots\u0026\\vdots\\\\x_n-\\overline{x}\u0026y_n-\\overline{y}\\end{bmatrix}$; $\\frac{dE}{dN}=\\frac{d(N^TU^TUN)}{dN}=U^TUN+N^TU^TU$ ,å› ä¸º $U^TU $ æ˜¯ä¸€ä¸ªå¯¹ç§°çŸ©é˜µ $(U^TU=(U^TU)^T)$, $U^TUN=N^TU^TU$, æ‰€ä»¥ $\\frac{dE}{dN}=2(U^TU)N$; æ­¤å¤–ï¼Œ$U^TU=\\begin{bmatrix}\\sum(x_i-\\overline x)^2\u0026\\sum(x_i-\\overline x)(y_i-\\overline y)\\\\\\sum(x_i-\\overline x)(y_i-\\overline y)\u0026\\sum(y_i-\\overline y)^2\\end{bmatrix}$ æ˜¯å…³äº Xã€Y çš„ä¸€ä¸ªäºŒé˜¶çŸ©(éšæœºå˜é‡å¹³æ–¹çš„æœŸæœ›)çŸ©é˜µ(second-moment matrix); äºŒé˜¶çŸ©çŸ©é˜µ $U^{T}U$ çš„æœ€å°ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡å³ä¸ºæ±‚è§£çš„ $N=[a b]$ ç‰¹å¾å€¼ \u0026 ç‰¹å¾å‘é‡ è®¾ Aä¸º n é˜¶çŸ©é˜µ $(n Ã— n)$ï¼Œè‹¥å­˜åœ¨å¸¸æ•° Î» åŠ n ç»´éé›¶å‘é‡ x(n Ã— 1)ï¼Œä½¿å¾— $Ax = Î»x$ï¼Œåˆ™ç§° Î»æ˜¯çŸ©é˜µ A çš„ ç‰¹å¾å€¼ï¼Œx æ˜¯ A å±äºç‰¹å¾å€¼ Î» çš„ ç‰¹å¾å‘é‡ã€‚ $eig(U^T U) = [V, D]$, $V$ æ˜¯ç‰¹å¾å‘é‡é˜µï¼ˆæ¯åˆ—ä¸ºä¸€ä¸ªç‰¹å¾å‘é‡ï¼‰ï¼ŒDç‰¹å¾å€¼å¯¹è§’é˜µ âŸ¹ å¯»æ‰¾ D ä¸­ç‰¹å¾å€¼æœ€å°çš„å¯¹è§’å…ƒç´ å¯¹åº”çš„ç‰¹å¾å‘é‡å³ä¸º $U^TU$ æœ€å°ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ ç‰¹å¾å€¼åˆ†è§£ï¼š $U^T U = V D V^{-1}$ é€šè¿‡ SVDï¼ˆå¥‡å¼‚å€¼ï¼‰æ±‚è§£: $SVD(A)=[U,S,V]$,å³ $A=USV^T$ å…¶ä¸­ $U$ æ˜¯ä¸€ä¸ªm*mçš„æ­£äº¤é˜µï¼ˆOrthogonal matrixï¼šæ»¡è¶³ $UU^T=I$ æˆ–è€… $U^TU=I$ çš„ n é˜¶æ–¹é˜µï¼Œå…¶ä¸­ I ä¸º n é˜¶å•ä½é˜µï¼‰ï¼Œ$S$ æ˜¯ä¸€ä¸ªm*nçš„å¯¹è§’é˜µï¼ˆDiagonal matrixï¼šä¸»å¯¹è§’çº¿ä¹‹å¤–çš„å…ƒç´ çš†ä¸º 0 çš„çŸ©é˜µï¼Œå¯¹è§’çº¿ä¸Šçš„å…ƒç´ å¯ä»¥ä¸º 0 æˆ–å…¶ä»–å€¼ï¼‰ï¼Œå¯¹è§’çº¿ä¸Šçš„å…ƒç´ ä¸º $A$ çš„å¥‡å¼‚å€¼ï¼ˆSingular valueï¼‰ï¼Œ$V$ æ˜¯ä¸€ä¸ªn*nçš„æ­£äº¤é˜µã€‚$U$ çš„ m ä¸ªåˆ—å‘é‡ä¸º $A$ çš„å·¦å¥‡å¼‚å‘é‡ï¼ˆLeft singular vectorï¼‰ï¼Œ$V$ çš„ n ä¸ªåˆ—å‘é‡ä¸º $A$ çš„å³å¥‡å¼‚å‘é‡ï¼ˆRight singular vectorï¼‰ã€‚$S$ å®Œå…¨ç”± $A$ å†³å®šå’Œ $U$ã€$V$ æ— å…³ï¼› $A$ çš„å·¦å¥‡å¼‚å‘é‡ï¼ˆ$U$ï¼‰æ˜¯ $AA^T$ çš„ç‰¹å¾å‘é‡ï¼›$A$ çš„å³å¥‡å¼‚å‘é‡æ˜¯ $A^TA$ çš„ç‰¹å¾å‘é‡ã€‚ $A$ çš„éé›¶å¥‡å¼‚å€¼æ˜¯ $A^TA$ ç‰¹å¾å€¼çš„å¹³æ–¹æ ¹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ $AA^T$ ç‰¹å¾å€¼çš„å¹³æ–¹æ ¹ã€‚ å¯»æ‰¾ $S$ ä¸­æœ€å°å¥‡å¼‚å€¼å¯¹åº”çš„ $V$ çš„å³å¥‡å¼‚å‘é‡å³ä¸º $A^TA$ æœ€å°ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚ #include \u003ciostream\u003e #include \u003cEigen/Dense\u003e #include \u003cEigen/Eigenvalues\u003e using namespace Eigen; using namespace std; int main() { // Eigenvalue // typedef Matrix\u003cint, 3, 3\u003e Matrix3d Matrix3d A; A \u003c\u003c 1, 2, 3, 4, 5, 6, 7, 8, 9; cout \u003c\u003c \"Here is a 3x3 matrix, A:\" \u003c\u003c endl \u003c\u003c A \u003c\u003c endl \u003c\u003c endl; EigenSolver\u003cMatrix3d\u003e es(A.transpose() * A); // å¯¹è§’çŸ©é˜µï¼Œæ¯ä¸€ä¸ªå¯¹è§’çº¿å…ƒç´ å°±æ˜¯ä¸€ä¸ªç‰¹å¾å€¼ï¼Œé‡Œé¢çš„ç‰¹å¾å€¼æ˜¯ç”±å¤§åˆ°å°æ’åˆ—çš„ Matrix3d D = es.pseudoEigenvalueMatrix(); // ç‰¹å¾å‘é‡ï¼ˆæ¯ä¸€åˆ—ï¼‰ç»„æˆçš„çŸ©é˜µ Matrix3d V = es.pseudoEigenvectors(); cout \u003c\u003c \"The eigenvalue matrix D is:\" \u003c\u003c endl \u003c\u003c D \u003c\u003c endl \u003c\u003c endl; cout \u003c\u003c \"The eigenvector matrix V is:\" \u003c\u003c endl \u003c\u003c V \u003c\u003c endl \u003c\u003c endl; // ç‰¹å¾å€¼åˆ†è§£ // cout \u003c\u003c \"Finally, V * D * V^(-1) = \" \u003c\u003c endl \u003c\u003c V * D * V.inverse() \u003c\u003c endl; // ç‰¹å¾å€¼\u0026ç‰¹å¾å‘é‡ cout \u003c\u003c \"min-eigenvector \u0026 min-eigenvalue\" \u003c\u003c endl; cout \u003c\u003c \" \u003c1\u003e The min-eigenvalue for A^T*A:\" \u003c\u003c endl \u003c\u003c D(D.rows()-1, D.rows()-1) \u003c\u003c endl; cout \u003c\u003c \" \u003c2\u003e The min-eigenvector for A^T*A:\" \u003c\u003c endl \u003c\u003c V.col(V.cols()-1) \u003c\u003c endl; cout \u003c\u003c \" \u003c3\u003e (A^T*A)*min-eigenvector =\" \u003c\u003c endl \u003c\u003c (A.transpose()*A) * V.col(V.cols()-1) \u003c\u003c endl; cout \u003c\u003c \" \u003c4\u003e min-eigenvalue*min-eigenvector =\" \u003c\u003c endl \u003c\u003c D(D.rows()-1, D.rows()-1)*","date":"2023-07-16","objectID":"/posts/linefitting/:1:0","tags":["æ›²çº¿æ‹Ÿåˆ"],"title":"æ›²çº¿æ‹Ÿåˆ","uri":"/posts/linefitting/"},{"categories":["Math"],"content":"äºŒã€ ä¸‰æ¬¡æ ·æ¡æ›²çº¿ æ ¹æ®èµ·å§‹ç‚¹å’Œç»ˆç‚¹æ±‚ä¸‰æ¬¡æ ·æ¡æ›²çº¿çš„ç³»æ•° å·²çŸ¥ä¸‰æ¬¡æ ·æ¡æ›²çº¿çš„æ–¹ç¨‹ä¸º $y = a_0 + a_1 \\cdot x + a_2 \\cdot x ^ 2 + a_3 \\cdot x ^ 3$ ï¼Œ å¹¶ä¸”å·²çŸ¥èµ·å§‹ç‚¹åæ ‡ $(x_0, y_0)$, èµ·å§‹ç‚¹å¯¼æ•°k_1, ç»ˆç‚¹åæ ‡(x_1, y_1), ç»ˆç‚¹å¯¼æ•°k_2, æ±‚ä¸‰æ¬¡æ ·æ¡æ›²çº¿çš„ç³»æ•° è§£: é€šè¿‡å¹³ç§»å˜æ¢å¯çŸ¥ï¼Œ å°†èµ·å§‹ç‚¹ç½®äºé›¶ç‚¹ï¼Œåˆ™ç»ˆç‚¹ä¸º$(x_1 - x_0, y_1 - y_0)$ï¼Œé‚£ä¹ˆæ ¹æ®ç‚¹å’Œç›¸å…³ç‚¹ä¹‹é—´çš„å¯¼æ•°å¯ä»¥æ±‚ç›¸åº”çš„ç³»æ•°ã€‚æ–¹ç¨‹å¦‚ä¸‹: $a_0 = y_0$ $a_1 = k_0$ $(y_1 - y_1) = a_1 * (x_1 - x_0) + a_2 * (x_1 - x_0) ^ 2 + a_3 * (x_1 - x_0) ^ 3$ $k_1 = a_1 + 2 * a_2 * (x_1 - x_0) + 3 * a_3 * (x_1 - x_0) ^ 2$ æˆ–è€…ä¹Ÿå¯ä»¥è®¾ä¸‰æ¬¡æ ·æ¡æ›²çº¿æ–¹ç¨‹ä¸º:$y = a_0 + a_1 * (x - x_0) + a_2 * (x - x_1) ^ 2 + a_3 * (x - x_2) ^ 3$ ä»£ç å‚è€ƒ: void PredictorManager::GetCubicPolynomialCofficients(double start_s, double start_ds, double end_s, double end_ds, double start_t, double end_t, std::array\u003cdouble, 4\u003e* coeffs) { coeffs-\u003eoperator[](0) = start_s; coeffs-\u003eoperator[](1) = start_ds; double p = end_t - start_t; double p2 = p * p; double p3 = p2 * p; double tmp_var1 = (end_ds - start_ds) * p; double tmp_var2 = end_s - start_s - start_ds * p; coeffs-\u003eoperator[](2) = (3.0 * tmp_var2 - tmp_var1) / p2; coeffs-\u003eoperator[](3) = (tmp_var1 - 2.0 * tmp_var2) / p3; } double EvaluateQuarticPolynomial(const std::array\u003cdouble, 5\u003e\u0026 coeffs, const double t, const uint32_t order, const double end_t, const double end_v) { if (t \u003e= end_t) { switch (order) { case 0: { double end_value = (((coeffs[4] * end_t + coeffs[3]) * end_t + coeffs[2]) * end_t + coeffs[1]) * end_t + coeffs[0]; return end_value + (t - end_t) * end_v; } case 1: { return end_v; } default: { return 0.0; } } } switch (order) { case 0: { return (((coeffs[4] * t + coeffs[3]) * t + coeffs[2]) * t + coeffs[1]) * t + coeffs[0]; } case 1: { return ((4.0 * coeffs[4] * t + 3.0 * coeffs[3]) * t + 2.0 * coeffs[2]) * t + coeffs[1]; } case 2: { return (12.0 * coeffs[4] * t + 6.0 * coeffs[3]) * t + 2.0 * coeffs[2]; } case 3: { return 24.0 * coeffs[4] * t + 6.0 * coeffs[3]; } case 4: { return 24.0 * coeffs[4]; } default: return 0.0; } } ","date":"2023-07-16","objectID":"/posts/linefitting/:1:1","tags":["æ›²çº¿æ‹Ÿåˆ"],"title":"æ›²çº¿æ‹Ÿåˆ","uri":"/posts/linefitting/"},{"categories":["Math"],"content":"ä¸‰ã€Bezieræ›²çº¿ å‚è€ƒæ–‡çŒ®: [1]. [ä¸‰æ¬¡æ ·æ¡æ›²çº¿æ±‚ç³»æ•°1](https://huaweicloud.csdn.net/63a571ddb878a5454594788c.html?spm=1001.2101.3001.6650.2\u0026utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Eactivity-2-90477388-blog-118017126.pc_relevant_vip_default\u0026depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Eactivity-2-90477388-blog-118017126.pc_relevant_vip_default\u0026utm_relevant_index=3#devmenu7) [2]. [ä¸‰æ¬¡æ ·æ¡æ›²çº¿æ±‚ç³»æ•°2](https://blog.csdn.net/ymj7150697/article/details/105713587) [3]. [ä¸‰æ¬¡æ ·æ¡æ›²çº¿æ±‚ç³»æ•°3](https://blog.csdn.net/weixin_37722026/article/details/103778202) ","date":"2023-07-16","objectID":"/posts/linefitting/:1:2","tags":["æ›²çº¿æ‹Ÿåˆ"],"title":"æ›²çº¿æ‹Ÿåˆ","uri":"/posts/linefitting/"},{"categories":["Math"],"content":"References: [1].æœ€å°äºŒä¹˜æ³•æ‹Ÿåˆç›´çº¿ ","date":"2023-07-16","objectID":"/posts/linefitting/:2:0","tags":["æ›²çº¿æ‹Ÿåˆ"],"title":"æ›²çº¿æ‹Ÿåˆ","uri":"/posts/linefitting/"},{"categories":["C++"],"content":"C++ STL (Standard Template Library) æ€»ç»“ C++ STL å®¹å™¨æ˜¯ä½¿ç”¨é¢‘ç‡è¶…é«˜çš„åŸºç¡€è®¾æ–½ï¼Œåªæœ‰äº†è§£å„ä¸ªå®¹å™¨çš„åº•å±‚åŸç†ï¼Œæ‰èƒ½å¾—å¿ƒåº”æ‰‹åœ°ç”¨å¥½ä¸åŒçš„å®¹å™¨ï¼Œåšåˆ°ç”¨æœ€åˆé€‚çš„å®¹å™¨å¹²æœ€åˆé€‚çš„äº‹æƒ…ã€‚ æœ¬æ–‡æ—¨åœ¨å¯¹ C++ æ ‡å‡†æ¨¡æ¿åº“çš„ array, vector, deque, list, forward_list, queue, priority_queue, stack, map, multimap, set, multi_set, unordered_map, unordered_multimap, unordered_set, unordered_multiset å…±åå…­ç±»å®¹å™¨è¿›è¡Œç³»ç»Ÿçš„å¯¹æ¯”åˆ†æï¼Œé‡ç‚¹å…³æ³¨å„ä¸ªå®¹å™¨çš„åº•å±‚åŸç†ä¸æ€§èƒ½ç‰¹ç‚¹ã€‚æœ¬æ–‡å”¯ä¸€å‚è€ƒèµ„æ–™ä¸ºC++å®˜æ–¹æ–‡æ¡£ï¼Œè‹¥æœ‰å…¶å®ƒå‚è€ƒåˆ™ä¼šæŒ‡æ˜å‡ºå¤„ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:0","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"1. array Container properties: Sequence | Contiguous storage | Fixed-size aggregate å®¹å™¨å±æ€§ï¼šé¡ºåºå®¹å™¨ï¼ˆæ”¯æŒéšæœºè®¿é—®ï¼‰ï¼Œè¿ç»­å†…å­˜ç©ºé—´ï¼Œå›ºå®šå¤§å°ï¼›//è¿ç»­å†…å­˜ ç±»æ¨¡æ¿å¤´ï¼štemplate \u003c class T, size_t N \u003e class array; array å³æ•°ç»„ï¼Œå…¶å¤§å°å›ºå®šï¼Œæ‰€æœ‰çš„å…ƒç´ ä¸¥æ ¼æŒ‰ç…§å†…å­˜åœ°å€çº¿æ€§æ’åˆ—ï¼Œarray å¹¶ä¸ç»´æŠ¤å…ƒç´ ä¹‹å¤–çš„ä»»ä½•å¤šä½™æ•°æ®ï¼Œç”šè‡³ä¹Ÿä¸ä¼šç»´æŠ¤ä¸€ä¸ªsizeè¿™æ ·çš„å˜é‡ï¼Œè¿™ä¿è¯äº†å®ƒåœ¨å­˜å‚¨æ€§èƒ½ä¸Šå’ŒC++è¯­æ³•ä¸­çš„æ•°ç»„ç¬¦å·[]æ— å¼‚ã€‚å°½ç®¡å…¶å®ƒå¤§éƒ¨åˆ†æ ‡å‡†å®¹å™¨éƒ½å¯ä»¥é€šè¿‡ std::allocator æ¥åŠ¨æ€çš„åˆ†é…å’Œå›æ”¶å†…å­˜ç©ºé—´ï¼Œä½† Array å¹¶ä¸æ”¯æŒè¿™æ ·åšã€‚ Array å’Œå…¶å®ƒæ ‡å‡†å®¹å™¨ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸åŒæ˜¯ï¼šå¯¹ä¸¤ä¸ª array æ‰§è¡Œ swap æ“ä½œæ„å‘³ç€çœŸçš„ä¼šå¯¹ç›¸åº” range å†…çš„å…ƒç´ ä¸€ä¸€ç½®æ¢ï¼Œå› æ­¤å…¶æ—¶é—´èŠ±é”€æ­£æ¯”äºç½®æ¢è§„æ¨¡ï¼›ä½†åŒæ—¶ï¼Œå¯¹ä¸¤ä¸ª array æ‰§è¡Œ swap æ“ä½œä¸ä¼šæ”¹å˜ä¸¤ä¸ªå®¹å™¨å„è‡ªçš„è¿­ä»£å™¨çš„ä¾é™„å±æ€§ï¼Œè¿™æ˜¯ç”± array çš„ swap æ“ä½œä¸äº¤æ¢å†…å­˜åœ°å€å†³å®šçš„ã€‚ Array çš„å¦ä¸€ä¸ªç‰¹æ€§æ˜¯ï¼šä¸åŒäºå…¶å®ƒå®¹å™¨ï¼Œarray å¯ä»¥è¢«å½“ä½œ std::tuple ä½¿ç”¨ï¼Œå› ä¸º array çš„å¤´æ–‡ä»¶é‡è½½äº†get()ä»¥åŠtuple_size()å’Œtuple_element()å‡½æ•°ï¼ˆæ³¨æ„è¿™äº›å‡½æ•°é array çš„æˆå‘˜å‡½æ•°ï¼Œè€Œæ˜¯å¤–éƒ¨å‡½æ•°ï¼‰ã€‚ æœ€åéœ€è¦æ³¨æ„ï¼Œè™½ç„¶ array å’Œ C++è¯­æ³•ä¸­çš„[]ç¬¦å·æ— é™æ¥è¿‘ï¼Œä½†ä¸¤è€…æ˜¯ä¸¤ä¸ªå­˜åœ¨ï¼Œarray æ¯•ç«Ÿæ˜¯æ ‡å‡†æ¨¡æ¿åº“çš„ä¸€å‘˜ï¼Œæ˜¯ä¸€ä¸ªclassï¼Œå› æ­¤æ”¯æŒ begin(), end(), front(), back(), at(), empty(), data(), fill(), swap(), ... ç­‰ç­‰æ ‡å‡†æ¥å£ï¼Œè€Œ[]æ˜¯çœŸæ­£çš„æœ€æœ´ç´ çš„æ•°ç»„ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:1","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"2. vector Container properties: Sequence | Dynamic array | Allocator-aware å®¹å™¨å±æ€§ï¼šé¡ºåºå®¹å™¨ï¼ˆæ”¯æŒéšæœºè®¿é—®ï¼‰ï¼ŒåŠ¨æ€è°ƒæ•´å¤§å°ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼›//è¿ç»­å†…å­˜ ç±»æ¨¡æ¿å¤´ï¼štemplate \u003c class T, class Alloc = allocator \u003e class vector; ä¸€å¥è¯æ¥è¯´ï¼Œvector å°±æ˜¯èƒ½å¤ŸåŠ¨æ€è°ƒæ•´å¤§å°çš„ arrayã€‚å’Œ array ä¸€æ ·ï¼Œvector ä½¿ç”¨è¿ç»­å†…å­˜ç©ºé—´æ¥ä¿å­˜å…ƒç´ ï¼Œè¿™æ„å‘³ç€å…¶å…ƒç´ å¯ä»¥ç”¨æ™®é€šæŒ‡é’ˆçš„++å’Œ--æ“ä½œæ¥è®¿é—®ï¼›ä¸åŒäº array çš„æ˜¯ï¼Œå…¶å­˜å‚¨ç©ºé—´å¯ä»¥è‡ªåŠ¨è°ƒæ•´ã€‚ åœ¨åº•å±‚ä¸Šï¼Œvector ä½¿ç”¨åŠ¨æ€åˆ†é…çš„ arrayï¼Œå½“ç°æœ‰ç©ºé—´æ— æ³•æ»¡è¶³å¢é•¿éœ€æ±‚æ—¶ï¼Œä¼šé‡æ–°åˆ†é…ï¼ˆreallocateï¼‰ä¸€ä¸ªæ›´å¤§çš„ array å¹¶æŠŠæ‰€æœ‰å…ƒç´ ç§»åŠ¨è¿‡å»ï¼Œå› æ­¤ï¼Œvector çš„ reallocate æ˜¯ä¸€ä¸ªå¾ˆè€—æ—¶çš„å¤„ç†ã€‚æ‰€ä»¥ï¼Œæ¯æ¬¡ reallocate æ—¶éƒ½ä¼šé¢„ç•™å¤šä½™çš„ç©ºé—´ï¼Œä»¥æ»¡è¶³æ½œåœ¨çš„å¢é•¿éœ€æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œvectorçš„capacity()é€šå¸¸ä¼šå¤§äºsize()ã€‚vector ä»€ä¹ˆæ—¶å€™åš reallocateï¼Œreallocate å¤šå°‘å¤šä½™ç©ºé—´ï¼Œæ˜¯æœ‰å…·ä½“ç­–ç•¥çš„ï¼ŒæŒ‰ä¸‹ä¸è¡¨ã€‚æ€»ä½“æ¥è¯´ï¼Œvector æ¯” array å¤šäº†ä¸€äº›å†…å­˜æ¶ˆè€—ï¼Œä»¥æ¢å–æ›´çµæ´»çš„å†…å­˜ç®¡ç†ã€‚ å’Œå…¶å®ƒçš„åŠ¨æ€é¡ºåºå®¹å™¨ï¼ˆdeque, list, forward_listï¼‰ç›¸æ¯”ï¼Œvector åœ¨å…ƒç´ è®¿é—®ä¸Šæ•ˆç‡æœ€é«˜ï¼Œåœ¨å°¾éƒ¨å¢åˆ å…ƒç´ çš„æ•ˆç‡ä¹Ÿç›¸å¯¹æœ€é«˜ã€‚å¦‚æœè°ƒç”¨è€…æœ‰åœ¨å°¾éƒ¨ä»¥å¤–çš„åœ°æ–¹å¢åˆ å…ƒç´ çš„éœ€æ±‚ï¼Œvector åˆ™ä¸å¦‚å…¶å®ƒå®¹å™¨ï¼Œå¹¶ä¸”è¿­ä»£å™¨çš„ä¸€è‡´æ€§ä¹Ÿè¾ƒå·®ï¼ˆhave less consistent iterators and references than lists and forward_listsï¼‰ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:2","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"3. queue å®¹å™¨å±æ€§ï¼šå®¹å™¨é€‚é…å™¨(adapter)ï¼Œå…ˆè¿›å…ˆå‡ºå‹å®¹å™¨ï¼ˆFIFOï¼‰ï¼›//C++è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼ template \u003cclass T, class Container = deque \u003e class queue; queueï¼ˆæ™®é€šé˜Ÿåˆ—ï¼‰æ˜¯ä¸€ä¸ªä¸“ä¸º FIFO è®¾è®¡çš„å®¹å™¨é€‚é…å™¨ï¼Œä¹Ÿå³åªèƒ½ä»ä¸€ç«¯æ’å…¥ã€ä»å¦ä¸€ç«¯åˆ é™¤ï¼›æ‰€è°“å®¹å™¨é€‚é…å™¨ï¼Œæ˜¯æŒ‡å®ƒæœ¬èº«åªæ˜¯ä¸€ä¸ªå°è£…å±‚ï¼Œå¿…é¡»ä¾èµ–æŒ‡å®šçš„åº•å±‚å®¹å™¨ï¼ˆé€šè¿‡æ¨¡æ¿å‚æ•°ä¸­çš„class ContaineræŒ‡å®šï¼‰æ‰èƒ½å®ç°å…·ä½“åŠŸèƒ½ã€‚ **å®¹å™¨é€‚é…å™¨(Adapter)**å®é™…ä¸Šæ˜¯C++è®¾è®¡æ¨¡å¼çš„ä¸€ç§ â€“ ç§°ä¸º Adapter æ¨¡å¼ï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰ï¼ŒAdapter æ¨¡å¼çš„ç›®çš„æ˜¯å°†ç¬¬ä¸‰æ–¹åº“æä¾›çš„æ¥å£åšä¸€ä¸ªå°è£…å’Œè½¬åŒ–ï¼Œä½¿å…¶é€‚é…è‡ªå·±å·¥ç¨‹ä¸­é¢„ç•™çš„æ¥å£ï¼Œæˆ–è€…é€‚åº”è‡ªå·±å·¥ç¨‹çš„è°ƒç”¨é£æ ¼ã€‚æ¢å¥è¯è¯´ï¼ŒAdapter æ¨¡å¼çš„ç›®çš„æ˜¯å°†è¢«è°ƒç”¨ç±»ï¼ˆå¦‚ç¬¬ä¸‰æ–¹åº“ï¼‰çš„æ¥å£è½¬åŒ–ä¸ºå¸Œæœ›çš„æ¥å£ã€‚ å›åˆ°æ­£é¢˜ï¼Œqueue å¯ä»¥æ¥çº³ä»»ä½•ä¸€ä¸ªè‡³å°‘æ”¯æŒä¸‹åˆ—æ¥å£çš„å®¹å™¨ä½œä¸ºåº•å±‚å®¹å™¨ï¼š empty(); size(); front(); back(); push_back(); pop_front(). åœ¨æ ‡å‡†æ¨¡æ¿åº“å®¹å™¨ä¸­ï¼Œdeque å’Œ list æ»¡è¶³ä¸Šè¿°è¦æ±‚ï¼Œå½“ç„¶ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ»¡è¶³ä¸Šè¿°è¦æ±‚çš„å®¹å™¨ã€‚é€šè¿‡æ¨¡æ¿å‚æ•°å¯ä»¥çœ‹å‡ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œqueue ä½¿ç”¨ deque ä½œä¸ºåº•å±‚å®¹å™¨ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:3","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"4. deque Container properties: Sequence | Dynamic array | Allocator-aware å®¹å™¨å±æ€§ï¼šé¡ºåºå®¹å™¨ï¼ˆæ”¯æŒéšæœºè®¿é—®ï¼‰ï¼ŒåŠ¨æ€è°ƒæ•´å¤§å°ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼›//åˆ†æ®µè¿ç»­å†…å­˜ ç±»æ¨¡æ¿å¤´ï¼štemplate \u003c class T, class Alloc = allocator \u003e class deque; dequeï¼ˆè¯»ä½œ\"deck\"ï¼‰æ˜¯ double-ended queue çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥åœ¨é¦–å°¾ä¸¤ç«¯è¿›è¡ŒåŠ¨æ€å¢åˆ çš„é¡ºåºå®¹å™¨ã€‚ ä¸åŒçš„åº“å¯¹ deque çš„å®ç°å¯èƒ½ä¸åŒï¼Œä½†å¤§ä½“ä¸Šéƒ½æ˜¯æŸç§å½¢å¼çš„åŠ¨æ€ arrayï¼Œä¸”éƒ½æ”¯æŒéšæœºè®¿é—®ã€‚deque çš„åŠŸèƒ½å’Œ vector æ¯”è¾ƒæ¥è¿‘ï¼Œä½† deque é¢å¤–æ”¯æŒåœ¨å¤´éƒ¨åŠ¨æ€å¢åˆ å…ƒç´ ã€‚å’Œ vector ä¸ä¸€æ ·çš„æ˜¯ï¼Œdeque ä¸ä¿è¯å­˜å‚¨åŒºåŸŸä¸€å®šæ˜¯è¿ç»­çš„! å› æ­¤ç”¨æŒ‡å‘å…ƒç´ çš„æ™®é€šæŒ‡é’ˆåš++å’Œ--æ“ä½œæ˜¯éå¸¸å±é™©çš„è¡Œä¸ºã€‚ ä»åº•å±‚æœºç†ä¸Šèƒ½æ›´é€å½»åœ°ç†è§£ deque çš„ç‰¹ç‚¹ï¼švector ä½¿ç”¨çš„æ˜¯å•ä¸€çš„ arrayï¼Œdeque åˆ™ä¼šä½¿ç”¨å¾ˆå¤šä¸ªç¦»æ•£çš„ array æ¥ç»„ç»‡æ•°æ®ã€Œthe elements of a deque can be scattered in different chunks of storageã€ï¼å¦‚æœè¯´ vector æ˜¯è¿ç»­çš„ï¼Œdeque åˆ™æ˜¯åˆ†æ®µè¿ç»­ã€‚deque ä¼šç»´æŠ¤ä¸åŒ array ä¹‹é—´çš„å…³è”ä¿¡æ¯ï¼Œä½¿ç”¨æˆ·æ— éœ€å…³å¿ƒåˆ†æ®µè¿™ä¸ªäº‹å®ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¾ˆæ˜æ˜¾çš„ï¼šdeque åœ¨ reallocate æ—¶ï¼Œåªéœ€æ–°å¢/é‡Šæ”¾ä¸¤ç«¯çš„ storage chunk å³å¯ï¼Œæ— éœ€ç§»åŠ¨å·²æœ‰æ•°æ®ï¼ˆvector çš„å¼Šç«¯ï¼‰ï¼Œæå¤§æå‡äº†æ•ˆç‡ï¼Œå°¤å…¶åœ¨æ•°æ®è§„æ¨¡å¾ˆå¤§æ—¶ï¼Œä¼˜åŠ¿æ˜æ˜¾ã€‚ ç›¸æ¯”äº vector å’Œ listï¼Œdeque å¹¶ä¸é€‚åˆéå†ï¼å› ä¸ºæ¯æ¬¡è®¿é—®å…ƒç´ æ—¶ï¼Œdeque åº•å±‚éƒ½è¦æ£€æŸ¥æ˜¯å¦è§¦è¾¾äº†å†…å­˜ç‰‡æ®µçš„è¾¹ç•Œï¼Œé€ æˆäº†é¢å¤–çš„å¼€é”€ï¼deque çš„æ ¸å¿ƒä¼˜åŠ¿æ˜¯åœ¨åŒç«¯éƒ½æ”¯æŒé«˜æ•ˆçš„å¢åˆ æ“ä½œï¼Œç¨‹åºå‘˜é€‰æ‹©ä½¿ç”¨ deque æ—¶éœ€è¦æœ‰åŒç«¯æ“ä½œçš„æ˜ç¡®ç†ç”±ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:4","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"5. priority_queue å®¹å™¨å±æ€§ï¼šå®¹å™¨é€‚é…å™¨ï¼Œä¸¥æ ¼å¼±åºï¼ˆStrict Weak Orderingï¼‰ï¼Œä¼˜å…ˆçº§é˜Ÿåˆ—ï¼› template \u003cclass T, class Container = vector, class Compare = less \u003e class priority_queue; å’Œ queue ç±»ä¼¼ï¼Œpriority_queueï¼ˆæœ¯è¯­å«ä½œä¼˜å…ˆçº§é˜Ÿåˆ—ï¼‰ä¹Ÿåªæ˜¯ä¸€ä¸ªå®¹å™¨é€‚é…å™¨ï¼Œéœ€è¦æŒ‡å®šåº•å±‚å®¹å™¨æ‰èƒ½å®ä¾‹åŒ–ï¼Œå‚è§æ¨¡æ¿å‚æ•°ä¸­çš„class Containerå½¢å‚ã€‚priority_queue çš„æ ¸å¿ƒç‰¹ç‚¹åœ¨äºå…¶ä¸¥æ ¼å¼±åºç‰¹æ€§ï¼ˆstrict weak orderingï¼‰ï¼šä¹Ÿå³ priority_queue ä¿è¯å®¹å™¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å§‹ç»ˆæ˜¯æ‰€æœ‰å…ƒç´ ä¸­æœ€å¤§çš„ï¼ä¸ºæ­¤ï¼Œç”¨æˆ·åœ¨å®ä¾‹åŒ–ä¸€ä¸ª priority_queue æ—¶ï¼Œå¿…é¡»ä¸ºå…ƒç´ ç±»å‹ï¼ˆclass Tï¼‰é‡è½½\u003cè¿ç®—ç¬¦ï¼Œä»¥ç”¨äºå…ƒç´ æ’åºï¼ priority_queue çš„åŸç†å¯ä»¥ç”¨ä¸€ä¸ªå¤§é¡¶å †æ¥è§£é‡Šï¼špriority_queue åœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªåŸºäºäºŒå‰æ ‘çš„å¤§é¡¶å †æ•°æ®ç»“æ„ï¼Œåœ¨è¿™ä¸ªæ•°æ®ç»“æ„ä¸­ï¼Œæœ€å¤§çš„å…ƒç´ å§‹ç»ˆä½äºå †é¡¶éƒ¨ï¼Œä¸”åªæœ‰å †é¡¶éƒ¨çš„å…ƒç´ ï¼ˆmax heap elementï¼‰æ‰èƒ½è¢«è®¿é—®å’Œè·å–ï¼Œå¤§é¡¶å †çš„å…·ä½“åŸç†å¯å‚è§ä»»ä½•ä¸€æœ¬æ•°æ®ç»“æ„ä¹¦ç±ã€‚ ä¸ºäº†æ”¯æŒè¿™ç§å·¥ä½œåŸç†ï¼Œpriority_queue å¯¹åº•å±‚å®¹å™¨ä¹Ÿæ˜¯æœ‰è¦æ±‚çš„ï¼Œpriority_queue çš„åº•å±‚å®¹å™¨å¿…é¡»æ”¯æŒéšæœºè®¿é—®å’Œè‡³å°‘ä»¥ä¸‹æ¥å£ï¼š empty(); size(); front(); push_back(); pop_back(). æ ‡å‡†æ¨¡æ¿åº“ä¸­çš„ vector å’Œ deque èƒ½å¤Ÿæ»¡è¶³ä¸Šè¿°éœ€æ±‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œpriority_queue ä½¿ç”¨ vector ä½œä¸ºåº•å±‚å®¹å™¨ã€‚ æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ï¼Œpriority_queue é»˜è®¤åœ¨ vector ä¸Šä½¿ç”¨å †ç®—æ³•å°† vector ä¸­å…ƒç´ æ„é€ æˆå¤§é¡¶å †çš„ç»“æ„ï¼Œå› æ­¤ priority_queue å°±æ˜¯å † ï¼Œæ‰€æœ‰éœ€è¦ç”¨åˆ°å †çš„ä½ç½®ï¼Œéƒ½å¯ä»¥è€ƒè™‘ä½¿ç”¨ priority_queueã€‚priority_queue é»˜è®¤æ˜¯å¤§é¡¶å †ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ¨¡æ¿å‚æ•°ä¸­çš„ class Compare æ¥å®ç°ä¸€ä¸ªå°é¡¶å †ã€‚ ç›¸æ¯”äº queueï¼ˆæ™®é€šé˜Ÿåˆ—ï¼‰çš„å…ˆè¿›å…ˆå‡ºFIFOï¼Œpriority_queue å®ç°äº†æœ€é«˜ä¼˜å…ˆçº§å…ˆå‡ºã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:5","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"6. list Container properties: Sequence | Doubly-linked list | Allocator-aware å®¹å™¨å±æ€§ï¼šé¡ºåºå®¹å™¨ï¼ˆå¯é¡ºåºè®¿é—®ï¼Œä½†ä¸æ”¯æŒéšæœºè®¿é—®ï¼‰ï¼ŒåŒé“¾è¡¨ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼›//ç¦»æ•£å†…å­˜ ç±»æ¨¡æ¿å¤´ï¼štemplate \u003c class T, class Alloc = allocator \u003e class list; list æ˜¯ä¸€ç§æ”¯æŒåœ¨ä»»æ„ä½ç½®éƒ½å¯ä»¥å¿«é€Ÿåœ°æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„å®¹å™¨ï¼Œä¸”æ”¯æŒåŒå‘éå†ã€‚list å®¹å™¨èƒ½å¤Ÿåšåˆ°è¿™äº›çš„åŸå› åœ¨äºå…¶åº•å±‚ç»“æ„æ˜¯åŒé“¾è¡¨ï¼ŒåŒé“¾è¡¨å…è®¸æŠŠå„ä¸ªå…ƒç´ éƒ½ä¿å­˜åœ¨å½¼æ­¤ä¸ç›¸å¹²çš„å†…å­˜åœ°å€ä¸Šï¼Œä½†æ¯ä¸ªå…ƒç´ éƒ½ä¼šä¸å‰åç›¸é‚»å…ƒç´ å…³è”ã€‚ å’Œå…¶å®ƒçš„é¡ºåºå®¹å™¨ï¼ˆarray, vector, dequeï¼‰ç›¸æ¯”ï¼Œlist çš„æœ€å¤§ä¼˜åŠ¿åœ¨äºæ”¯æŒåœ¨ä»»æ„ä½ç½®æ’å…¥ã€åˆ é™¤å’Œç§»åŠ¨å…ƒç´ ï¼Œå¯¹ list æ¥è¯´ï¼Œåœ¨å“ªä¸ªä½ç½®è¿›è¡Œæ“ä½œå¹¶æ²¡æœ‰åŒºåˆ«ã€‚list åœ¨éƒ¨åˆ†ç®—æ³•ï¼ˆå¦‚ sortingï¼‰ä¸­çš„æ•ˆç‡å¯èƒ½ä¼˜äºå…¶å®ƒé¡ºåºå®¹å™¨ã€‚ list çš„ä¸»è¦ç¼ºç‚¹æ˜¯ä¸æ”¯æŒå…ƒç´ çš„éšæœºè®¿é—®ï¼å¦‚æœæˆ‘ä»¬æƒ³è¦è®¿é—®æŸä¸ªå…ƒç´ ï¼Œåˆ™å¿…é¡»ä»ä¸€ä¸ªå·²çŸ¥å…ƒç´ ï¼ˆå¦‚ begin æˆ– endï¼‰å¼€å§‹æœä¸€ä¸ªæ–¹å‘éå†ï¼Œç›´è‡³åˆ°è¾¾è¦è®¿é—®çš„å…ƒç´ ã€‚æ­¤å¤–ï¼Œlist è¿˜è¦æ¶ˆè€—æ›´å¤šçš„å†…å­˜ç©ºé—´ï¼Œç”¨äºä¿å­˜å„ä¸ªå…ƒç´ çš„å…³è”ä¿¡æ¯ã€‚ [å¦è¯´] list å¯¹å†…å­˜ç©ºé—´çš„ä½¿ç”¨æ•ˆç‡å¹¶ä¸é«˜ï¼Œä¸€æ–¹é¢å…ƒç´ å†…å­˜åœ°å€æ˜¯ç¦»æ•£çš„è€Œéè¿ç»­ï¼Œå¦ä¸€æ–¹é¢ï¼Œlist éœ€è¦ä¿å­˜é¢å¤–çš„å…³è”ä¿¡æ¯ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:6","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"7. forward_list Container properties: Sequence | Linked list | Allocator-aware å®¹å™¨å±æ€§ï¼šé¡ºåºå®¹å™¨ï¼ˆå¯é¡ºåºè®¿é—®ï¼Œä½†ä¸æ”¯æŒéšæœºè®¿é—®ï¼‰ï¼Œå•é“¾è¡¨ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼› ç±»æ¨¡æ¿å¤´ï¼štemplate \u003c class T, class Alloc = allocator \u003e class list; forward_list ä¹Ÿæ˜¯ä¸€ç§æ”¯æŒåœ¨ä»»æ„ä½ç½®å¿«é€Ÿæ’å…¥å’Œåˆ é™¤å…ƒç´ çš„å®¹å™¨ï¼Œforward_list ç›¸æ¯”äº list çš„æ ¸å¿ƒåŒºåˆ«æ˜¯å®ƒæ˜¯ä¸€ä¸ªå•é“¾è¡¨ï¼Œå› æ­¤, æ¯ä¸ªå…ƒç´ åªä¼šä¸ç›¸é‚»çš„ä¸‹ä¸€ä¸ªå…ƒç´ å…³è”ï¼ç”±äºå…³è”ä¿¡æ¯å°‘äº†ä¸€åŠï¼Œå› æ­¤ forward_list å ç”¨çš„å†…å­˜ç©ºé—´æ›´å°ï¼Œä¸”æ’å…¥å’Œåˆ é™¤çš„æ•ˆç‡ç¨ç¨é«˜äº listã€‚ä½œä¸ºä»£ä»·ï¼Œforward_list åªèƒ½å•å‘éå†ã€‚ ç›¸æ¯”äºå…¶å®ƒé¡ºåºå®¹å™¨ï¼ˆarray, vector, dequeï¼‰ï¼Œforward_list çš„ä¼˜ç¼ºç‚¹å’Œ list åŸºæœ¬ç›¸åŒã€‚ æ—¢ç„¶å·²ç»æœ‰äº† listï¼Œä¸ºä»€ä¹ˆ C++ STL åˆè®¾è®¡äº† forward_list è¿™ä¸€å®¹å™¨å‘¢ï¼Ÿè®¾è®¡ forward_list çš„ç›®çš„æ˜¯ä¸ºäº†è¾¾åˆ°ä¸è¾“äºä»»ä½•ä¸€ä¸ªCé£æ ¼æ‰‹å†™é“¾è¡¨çš„æå€¼æ•ˆç‡ï¼ä¸ºæ­¤ï¼Œforward_list æ˜¯ä¸€ä¸ªæœ€å°é“¾è¡¨è®¾è®¡ï¼Œå®ƒç”šè‡³æ²¡æœ‰size()æ¥å£ï¼Œå› ä¸ºå†…éƒ¨ç»´æŠ¤ä¸€ä¸ªsizeå˜é‡ä¼šé™ä½å¢åˆ å…ƒç´ çš„æ•ˆç‡ã€‚å¦‚æœæƒ³è¦è·å– forward_list çš„ sizeï¼Œä¸€ä¸ªé€šå¸¸çš„åšæ³•æ˜¯ï¼Œç”¨ std::distance è®¡ç®— begin åˆ° end çš„è·ç¦»å¾—å‡º sizeã€‚ä¸€å¥è¯æ€»ç»“ï¼šlist å…¼é¡¾äº†æ¥å£ä¸°å¯Œæ€§ç‰ºç‰²äº†æ•ˆç‡ï¼Œè€Œ forward_list èˆå¼ƒäº†ä¸å¿…è¦çš„æ¥å£åªä¸ºè¿½æ±‚æè‡´æ•ˆç‡ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:7","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"8. stack å®¹å™¨å±æ€§ï¼šå®¹å™¨é€‚é…å™¨ï¼Œåè¿›å…ˆå‡ºå‹å®¹å™¨ï¼ˆLIFOï¼‰ï¼› template \u003cclass T, class Container = deque \u003e class stack; stackï¼ˆæ ˆï¼‰æ˜¯ä¸€ä¸ªä¸“ä¸º LIFO è®¾è®¡çš„å®¹å™¨é€‚é…å™¨ï¼Œä¹Ÿå³åªèƒ½ä»ä¸€ç«¯æ’å…¥å’Œåˆ é™¤ï¼›ä½œä¸ºé€‚é…å™¨ï¼Œéœ€è¦æŒ‡å®šåº•å±‚å®¹å™¨æ‰èƒ½å®ä¾‹åŒ–ï¼Œå‚è§æ¨¡æ¿å‚æ•°ä¸­çš„class Containerå½¢å‚ã€‚ stack çš„ç‰¹ç‚¹æ˜¯åè¿›å…ˆå‡ºï¼ˆä¸€ç«¯è¿›å‡ºï¼‰ï¼Œä¸å…è®¸éå†ï¼›ä»»ä½•æ—¶å€™å¤–ç•Œåªèƒ½è®¿é—® stack é¡¶éƒ¨çš„å…ƒç´ ï¼›åªæœ‰åœ¨ç§»é™¤ stack é¡¶éƒ¨çš„å…ƒç´ åï¼Œæ‰èƒ½è®¿é—®ä¸‹æ–¹çš„å…ƒç´ ã€‚stack éœ€è¦åº•å±‚å®¹å™¨èƒ½å¤Ÿåœ¨ä¸€ç«¯å¢åˆ å…ƒç´ ï¼Œè¿™ä¸€ç«¯ä¹Ÿå³ stack çš„â€œæ ˆé¡¶â€ï¼›stack å¯ä»¥æ¥çº³ä»»ä½•ä¸€ä¸ªè‡³å°‘æ”¯æŒä¸‹åˆ—æ¥å£çš„å®¹å™¨ä½œä¸ºåº•å±‚å®¹å™¨ï¼š empty(); size(); back(); push_back(); pop_back() åœ¨æ ‡å‡†æ¨¡æ¿åº“å®¹å™¨ä¸­ï¼Œvectorã€deque å’Œ list æ»¡è¶³ä¸Šè¿°è¦æ±‚ï¼Œå½“ç„¶ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ»¡è¶³ä¸Šè¿°è¦æ±‚çš„å®¹å™¨ã€‚é€šè¿‡æ¨¡æ¿å‚æ•°å¯ä»¥çœ‹å‡ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œstack ä½¿ç”¨ deque ä½œä¸ºåº•å±‚å®¹å™¨ã€‚ stack å®¹å™¨åº”ç”¨å¹¿æ³›ï¼Œä¾‹å¦‚ï¼Œç¼–è¾‘å™¨ä¸­çš„ undo ï¼ˆæ’¤é”€æ“ä½œï¼‰æœºåˆ¶å°±æ˜¯ç”¨æ ˆæ¥è®°å½•è¿ç»­çš„æ“ä½œã€‚stack çš„è®¾è®¡åœºæ™¯å’Œè‡ªåŠ©é¤é¦†ä¸­å †å çš„ç›˜å­ã€æ‘èµ·æ¥çš„ä¸€å †ä¹¦ç±»ä¼¼ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:8","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"9. map Container properties: Associative | Ordered | Map | Unique keys | Allocator-aware å®¹å™¨å±æ€§ï¼šå…³è”å®¹å™¨ï¼Œæœ‰åºï¼Œå…ƒç´ ç±»å‹\u003ckey, value\u003eï¼Œkeyæ˜¯å”¯ä¸€çš„ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼› template \u003c class Key, // map::key_type class T, // map::mapped_type class Compare = less, // map::key_compare class Alloc = allocator\u003cpair\u003cconst Key,T\u003e \u003e // map::allocator_type class map; map æ˜¯ä¸€ä¸ªå…³è”å‹å®¹å™¨ï¼Œå…¶å…ƒç´ ç±»å‹æ˜¯ç”± key å’Œ value ç»„æˆçš„ std::pairï¼Œå®é™…ä¸Š map ä¸­å…ƒç´ çš„æ•°æ®ç±»å‹æ­£æ˜¯ typedef pair\u003cconst Key, T\u003e value_type;ï¼Œè¿™å°±çœ‹çš„å¾ˆæ¸…æ¥šäº†ã€‚ æ‰€è°“å…³è”å®¹å™¨ï¼Œæ˜¯æŒ‡å¯¹æ‰€æœ‰å…ƒç´ çš„æ£€ç´¢éƒ½æ˜¯é€šè¿‡å…ƒç´ çš„ key è¿›è¡Œçš„ï¼ˆè€Œéå…ƒç´ çš„å†…å­˜åœ°å€ï¼‰ï¼Œmap é€šè¿‡åº•å±‚çš„ã€Œçº¢é»‘æ ‘ã€æ•°æ®ç»“æ„æ¥å°†æ‰€æœ‰çš„å…ƒç´ æŒ‰ç…§ key çš„ç›¸å¯¹å¤§å°è¿›è¡Œæ’åºï¼Œæ‰€å®ç°çš„æ’åºæ•ˆæœä¹Ÿæ˜¯ä¸¥æ ¼å¼±åºç‰¹æ€§ï¼ˆstrict weak orderingï¼‰ï¼Œä¸ºæ­¤ï¼Œå¼€å‘è€…éœ€è¦é‡è½½ key çš„\u003cè¿ç®—ç¬¦æˆ–è€…æ¨¡æ¿å‚æ•°ä¸­çš„ class Compareã€‚æ‰€æåˆ°çš„çº¢é»‘æ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼Œå®ƒè¡ç”Ÿè‡ªBæ ‘ï¼Œè¿™é‡Œæ¨èä¸¤ç¯‡æ–‡ç« ï¼ˆè®°ä¸€æ¬¡è…¾è®¯é¢è¯•ï¼šæœ‰äº†äºŒå‰æŸ¥æ‰¾æ ‘ã€å¹³è¡¡æ ‘ï¼ˆAVLï¼‰ä¸ºå•¥è¿˜éœ€è¦çº¢é»‘æ ‘ï¼Ÿï¼Œå›¾è§£ï¼šä»€ä¹ˆæ˜¯çº¢é»‘æ ‘ï¼Ÿï¼‰ä½œä¸ºæ›´æ·±å…¥çš„å‚è€ƒã€‚ å¤§ä½“æ¥è¯´ï¼Œmap è®¿é—®å…ƒç´ çš„é€Ÿåº¦è¦ç¨æ…¢äºä¸‹æ–‡çš„ unordered_mapï¼Œè¿™æ˜¯å› ä¸ºè™½ç„¶éƒ½å«â€œmapâ€ï¼Œä½†ä¸¤è€…çš„åº•å±‚æœºåˆ¶å®Œå…¨ä¸ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œç›¸æ¯”äºåè€…ï¼Œmap æ”¯æŒåœ¨ä¸€ä¸ªå­é›†åˆä¸Šè¿›è¡Œç›´æ¥è¿­ä»£å™¨è®¿é—®ï¼ŒåŸå› åœ¨äº map ä¸­çš„å…ƒç´ æ˜¯è¢«æœ‰åºç»„ç»‡çš„ã€‚ æœ€åï¼Œmap ä¹Ÿæ”¯æŒé€šè¿‡operator[]çš„æ–¹å¼æ¥ç›´æ¥è®¿é—® valueã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:9","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"10. multimap Container properties: Associative | Ordered | Map | Multiple equivalent keys | Allocator-aware å®¹å™¨å±æ€§: å…³è”å®¹å™¨ï¼Œæœ‰åºï¼Œå…ƒç´ ç±»å‹\u003ckey, value\u003eï¼Œå…è®¸ä¸åŒå…ƒç´ keyç›¸åŒï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨ç®¡ç†å†…å­˜ï¼› template \u003c class Key, // map::key_type class T, // map::mapped_type class Compare = less, // map::key_compare class Alloc = allocator\u003cpair\u003cconst Key,T\u003e \u003e // map::allocator_type class map; map ä¸­ä¸å…è®¸å‡ºç° key ç›¸åŒçš„ä¸¤ä¸ªå…ƒç´ ï¼Œä½† multimap åˆ™å¯ä»¥è¿™æ ·åšï¼ multimap ä¸ map åº•å±‚åŸç†å®Œå…¨ä¸€æ ·ï¼Œéƒ½æ˜¯ä½¿ç”¨ã€Œçº¢é»‘æ ‘ã€å¯¹å…ƒç´ æ•°æ®æŒ‰ key çš„æ¯”è¾ƒå…³ç³»ï¼Œè¿›è¡Œå¿«é€Ÿçš„æ’å…¥ã€åˆ é™¤å’Œæ£€ç´¢æ“ä½œï¼›æ‰€ä¸åŒçš„æ˜¯ multimap å…è®¸å°†å…·æœ‰ç›¸åŒ key çš„ä¸åŒå…ƒç´ æ’å…¥å®¹å™¨ï¼ˆè¿™ä¸ªä¸åŒä½“ç°äº† multimap å¯¹çº¢é»‘æ ‘çš„ä½¿ç”¨æ–¹å¼çš„å·®å¼‚ï¼‰ã€‚åœ¨ multimap å®¹å™¨ä¸­ï¼Œå…ƒç´ çš„ key ä¸å…ƒç´  value çš„æ˜ å°„å…³ç³»ï¼Œæ˜¯ä¸€å¯¹å¤šçš„ï¼Œå› æ­¤ï¼Œmultimap æ˜¯å¤šé‡æ˜ å°„å®¹å™¨ã€‚ æ³¨æ„ï¼Œåœ¨å‘ multimap ä¸­æ–°å¢å…ƒç´ æ—¶ï¼Œmultimap åªä¼šåˆ¤æ–­ key æ˜¯å¦ç›¸åŒï¼Œè€Œå®Œå…¨ä¸ä¼šåˆ¤æ–­ value æ˜¯å¦ç›¸åŒï¼è¿™æ„å‘³ç€å¦‚æœç›¸åŒçš„ \u003ckey, value\u003e æ’å…¥äº†å¤šæ¬¡ï¼Œmultimap ä¼šå¯¹å®ƒä»¬æ‚‰æ•°ä¿å­˜ï¼ åœ¨ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿­ä»£å™¨é…åˆ lower_bound() å’Œ upper_bound() æ¥è®¿é—®ä¸€ä¸ª key å¯¹åº”çš„æ‰€æœ‰ valueï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨equal_range()æ¥è®¿é—®ä¸€ä¸ª key å¯¹åº”çš„æ‰€æœ‰ valueï¼Œä¹Ÿå¯ä»¥é€šè¿‡find()é…åˆcount()æ¥è®¿é—®ä¸€ä¸ª key å¯¹åº”çš„æ‰€æœ‰ valueï¼Œä¸ªäººè®¤ä¸ºå‰ä¸¤ç§æ–¹æ³•ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ä¸€ç‚¹ã€‚ ä¸‹æ–‡ä¸­å°†è¦æåˆ°çš„ multiset ä¹‹äº set ç±»ä¼¼äºè¿™é‡Œçš„ multimap ä¹‹äº mapã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:10","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"11. set Container properties: Associative | Ordered | Set | Unique keys | Allocator-aware å®¹å™¨å±æ€§ï¼šå…³è”å®¹å™¨ï¼Œæœ‰åºï¼Œå…ƒç´ è‡ªèº«å³keyï¼Œå…ƒç´ æœ‰å”¯ä¸€æ€§ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼› template \u003c class T, // set::key_type/value_type class Compare = less, // set::key_compare/value_compare class Alloc = allocator // set::allocator_type class set; set æ˜¯ä¸€ä¸ªå…³è”å‹å®¹å™¨ï¼Œå’Œ map ä¸€æ ·ï¼Œå®ƒçš„åº•å±‚ç»“æ„æ˜¯ã€Œçº¢é»‘æ ‘ã€ï¼Œä½†å’Œ map ä¸ä¸€æ ·çš„æ˜¯ï¼Œset æ˜¯ç›´æ¥ä¿å­˜ value çš„ï¼Œæˆ–è€…è¯´ï¼Œset ä¸­çš„ value å°±æ˜¯ keyã€‚ set ä¸­çš„å…ƒç´ å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä¸å…è®¸å‡ºç°é‡å¤çš„å…ƒç´ ï¼Œä¸”å…ƒç´ ä¸å¯æ›´æ”¹ï¼Œä½†å¯ä»¥è‡ªç”±æ’å…¥æˆ–è€…åˆ é™¤ã€‚ ç”±äºåº•å±‚æ˜¯çº¢é»‘æ ‘ï¼Œæ‰€ä»¥ set ä¸­çš„å…ƒç´ ä¹Ÿæ˜¯ä¸¥æ ¼å¼±åºï¼ˆstrict weak orderingï¼‰æ’åºçš„ï¼Œå› æ­¤æ”¯æŒç”¨è¿­ä»£å™¨åšèŒƒå›´è®¿é—®ï¼ˆè¿­ä»£å™¨è‡ªåŠ è‡ªå‡ï¼‰ã€‚ å®é™…ä½¿ç”¨ä¸­ï¼Œset å’Œ map æ˜¯è¿‘äº²ï¼Œæ€§èƒ½ç›¸ä¼¼ï¼Œä»–ä»¬çš„å·®åˆ«æ˜¯å…ƒç´ çš„ value æœ¬èº«æ˜¯å¦ä¹Ÿä½œä¸º key æ¥æ ‡è¯†è‡ªå·±ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:11","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"12. multi_set Container properties: Associative | Ordered | Set | Multiple equivalent keys | Allocator-aware å®¹å™¨å±æ€§ï¼šå…³è”å®¹å™¨ï¼Œæœ‰åºï¼Œå…ƒç´ è‡ªèº«å³keyï¼Œå…è®¸ä¸åŒå…ƒç´ å€¼ç›¸åŒï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼› template \u003c class T, // multiset::key_type/value_type class Compare = less, // multiset::key_compare/value_compare class Alloc = allocator \u003e // multiset::allocator_type class multiset; multiset ä¹‹äº set å°±å¦‚åŒ multimap ä¹‹äº mapï¼š multiset å’Œ set åº•å±‚éƒ½æ˜¯çº¢é»‘æ ‘ï¼Œmultiset ç›¸æ¯”äº set æ”¯æŒä¿å­˜å¤šä¸ªç›¸åŒçš„å…ƒç´ ï¼› multimap å’Œ map åº•å±‚éƒ½æ˜¯çº¢é»‘æ ‘ï¼Œmultimap ç›¸æ¯”äº map æ”¯æŒä¿å­˜å¤šä¸ªkeyç›¸åŒçš„å…ƒç´ ã€‚ é‰´äºä»¥ä¸Šè¿‘äº²å…³ç³»ï¼Œmultiset çš„æ€§èƒ½ç‰¹ç‚¹ä¸å…¶å®ƒä¸‰è€…ç›¸ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:12","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"13. unordered_map Container properties: Associative | Unordered | Map | Unique keys | Allocator-aware å®¹å™¨å±æ€§ï¼šå…³è”å®¹å™¨ï¼Œæ— åºï¼Œå…ƒç´ ç±»å‹\u003ckey, value\u003eï¼Œkeyæ˜¯å”¯ä¸€çš„ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼› template \u003c class Key, // unordered_map::key_type class T, // unordered_map::mapped_type class Hash = hash, // unordered_map::hasher class Pred = equal_to, // unordered_map::key_equal class Alloc = allocator\u003c pair\u003cconst Key,T\u003e \u003e // unordered_map::allocator_type class unordered_map; unordered_map å’Œ map ä¸€æ ·ï¼Œéƒ½æ˜¯å…³è”å®¹å™¨ï¼Œä»¥é”®å€¼å¯¹å„¿ \u003ckey, value\u003e ä½œä¸ºå…ƒç´ è¿›è¡Œå­˜å‚¨ï¼›ä½†æ˜¯ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä¸¤è€…å¯ä»¥è¯´æ˜¯å®Œå…¨ä¸ä¸€æ ·ï¼ è¿™æ˜¯ç”±åº•å±‚çš„æ•°æ®ç»“æ„å†³å®šçš„ï¼Œmap ä»¥çº¢é»‘æ ‘ä½œä¸ºåº•å±‚ç»“æ„ç»„ç»‡æ•°æ®ï¼Œè€Œ unordered_map ä»¥å“ˆå¸Œè¡¨(hash table)ä½œä¸ºåº•å±‚æ•°æ®ç»“æ„æ¥ç»„ç»‡æ•°æ®ï¼Œè¿™é€ æˆäº†ä¸¤ç‚¹é‡è¦å½±å“ï¼š 1. unordered_map ä¸æ”¯æŒæ’åºï¼Œåœ¨ä½¿ç”¨è¿­ä»£å™¨åšèŒƒå›´è®¿é—®æ—¶ï¼ˆè¿­ä»£å™¨è‡ªåŠ è‡ªå‡ï¼‰æ•ˆç‡æ›´ä½ï¼› 2. ä½† unordered_map ç›´æ¥è®¿é—®å…ƒç´ çš„é€Ÿåº¦æ›´å¿«ï¼ˆå°¤å…¶åœ¨è§„æ¨¡å¾ˆå¤§æ—¶ï¼‰ï¼Œå› ä¸ºå®ƒé€šè¿‡ç›´æ¥è®¡ç®— key çš„å“ˆå¸Œå€¼æ¥è®¿é—®å…ƒç´ ï¼Œæ˜¯O(1)å¤æ‚åº¦ï¼ ç½‘ç»œä¸Šæœ‰å¯¹ map VS unordered_map æ•ˆç‡å¯¹æ¯”çš„æµ‹è¯•ï¼Œé€šå¸¸ map å¢åˆ å…ƒç´ çš„æ•ˆç‡æ›´é«˜ï¼Œunordered_map è®¿é—®å…ƒç´ çš„æ•ˆç‡æ›´é«˜ï¼Œå¯ä»¥å‚è§è¿™ç¯‡æ–‡ç« ã€‚å¦å¤–ï¼Œunordered_map å†…å­˜å ç”¨æ›´é«˜ï¼Œå› ä¸ºåº•å±‚çš„å“ˆå¸Œè¡¨éœ€è¦é¢„åˆ†é…è¶³é‡çš„ç©ºé—´ã€‚ ç»¼ä¸Šï¼Œunordered_map æ›´é€‚ç”¨äºå¢åˆ æ“ä½œä¸å¤šï¼Œä½†éœ€è¦é¢‘ç¹è®¿é—®ï¼Œä¸”å†…å­˜èµ„æºå……è¶³çš„åœºåˆã€‚ æ¯”å¦‚åœ¨æœºå™¨äººé¢†åŸŸçš„SLAMæŠ€æœ¯ä¸­ï¼Œå¯ä»¥é€‰æ‹© unordered_map æ¥ç»´æŠ¤ä½“ç´ å½¢å¼çš„ local mapï¼Ÿ å½“ç„¶ deque åº”è¯¥ä¹Ÿæ˜¯ä¸é”™çš„é€‰æ‹©ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:13","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"14. unordered_multimap Container properties: Associative | Unordered | Map | Multiple equivalent keys | Allocator-aware å®¹å™¨å±æ€§ï¼šå…³è”å®¹å™¨ï¼Œæ— åºï¼Œå…ƒç´ ç±»å‹\u003ckey, value\u003eï¼Œå…è®¸ä¸åŒå…ƒç´ keyç›¸åŒï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨ç®¡ç†å†…å­˜ ï¼› template \u003c class Key, // unordered_multimap::key_type class T, // unordered_multimap::mapped_type class Hash = hash, // unordered_multimap::hasher class Pred = equal_to, // unordered_multimap::key_equal class Alloc = allocator\u003c pair\u003cconst Key,T\u003e \u003e // unordered_multimap::allocator_type class unordered_multimap; unordered_multimap æ˜¯å¯¹ unordered_map çš„æ‹“å±•ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äº unordered_multimap å…è®¸ä¸åŒå…ƒç´ çš„ key ç›¸åŒï¼Œä½†ä¸¤è€…æ— è®ºæ˜¯åœ¨åº•å±‚ç»“æ„è¿˜æ˜¯åœ¨å®¹å™¨ç‰¹æ€§ä¸Šéƒ½æ˜¯ç›¸é€šçš„ï¼Œä»…ä»…æ˜¯å¯¹åº•å±‚å“ˆå¸Œè¡¨çš„ä½¿ç”¨æ–¹å¼ç¨æœ‰ä¸åŒã€‚ åœ¨ unordered_multimap ä¸­æƒ³è¦è®¿é—®åŒä¸€ä¸ª key ä¸‹å¯¹åº”çš„æ‰€æœ‰å…ƒç´ çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨equal_range()è½»æ¾åšåˆ°ï¼›å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨find()å’Œcount()é…åˆçš„æ–¹å¼æ¥è®¿é—®ã€‚ unordered_multimap çš„å®¹å™¨ç‰¹æ€§å‚è§ unordered_mapï¼Œä¸å†èµ˜è¿°ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:14","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"15. unordered_set Container properties: Associative | Unordered | Set | Unique keys | Allocator-aware å®¹å™¨å±æ€§ï¼šå…³è”å®¹å™¨ï¼Œæ— åºï¼Œå…ƒç´ è‡ªèº«å³keyï¼Œå…ƒç´ æœ‰å”¯ä¸€æ€§ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼› template \u003c class Key, // unordered_set::key_type/value_type class Hash = hash, // unordered_set::hasher class Pred = equal_to, // unordered_set::key_equal class Alloc = allocator // unordered_set::allocator_type class unordered_set; æ‰€æœ‰unordered_XXXç±»å®¹å™¨çš„ç‰¹ç‚¹éƒ½æ˜¯ä»¥å“ˆå¸Œè¡¨ä½œä¸ºåº•å±‚ç»“æ„ï¼›æ‰€æœ‰ XXX_set ç±»å®¹å™¨çš„ç‰¹ç‚¹éƒ½æ˜¯ã€Œå…ƒç´ è‡ªèº«ä¹Ÿä½œä¸ºkeyã€æ¥æ ‡è¯†è‡ªå·±ã€‚æˆ‘ä»¬åœ¨æŠŠä¸¤ç±»ç‰¹æ€§å åŠ åˆ°ä¸€èµ·ï¼Œå°±å¾—åˆ°äº† unordered_setã€‚ åœ¨ unordered_set ä¸­ï¼Œå…ƒç´ è‡ªèº«åŒæ—¶ä¹Ÿä½œä¸º key ä½¿ç”¨ï¼›æ—¢ç„¶æ˜¯ä½œä¸º key ä½¿ç”¨ï¼Œé‚£ä¹ˆå…ƒç´ å°±ä¸èƒ½è¢«æ›´æ”¹ï¼Œä¹Ÿå³ unordered_set ä¸­çš„å…ƒç´ éƒ½æ˜¯ constant çš„ï¼Œä½†æˆ‘ä»¬å¯ä»¥è‡ªç”±çš„æ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œè¿™ä¹Ÿæ˜¯æ‰€æœ‰XXX_setç±»å®¹å™¨çš„æ€§è´¨ã€‚æ—¢ç„¶åº•å±‚ç»“æ„æ˜¯å“ˆå¸Œè¡¨ï¼Œæ„å‘³ç€ unordered_set ä¸­çš„å…ƒç´ æ˜¯æ— åºçš„ï¼Œä¸èƒ½æŒ‰ç…§å¤§å°æ’åºï¼Œè¿™ä¹Ÿæ˜¯æ‰€æœ‰unordered_XXXç±»å®¹å™¨çš„æ€§è´¨ã€‚ å’Œæ‰€æœ‰çš„unordered_XXXç±»å®¹å™¨ä¸€æ ·ï¼š 1. unordered_set ç›´æ¥ç”¨è¿­ä»£å™¨åšèŒƒå›´è®¿é—®æ—¶ï¼ˆè¿­ä»£å™¨è‡ªåŠ è‡ªå‡ï¼‰æ•ˆç‡æ›´ä½ï¼Œä½äº setï¼› 2. ä½† unordered_set ç›´æ¥è®¿é—®å…ƒç´ çš„é€Ÿåº¦æ›´å¿«ï¼ˆå°¤å…¶åœ¨è§„æ¨¡å¾ˆå¤§æ—¶ï¼‰ï¼Œå› ä¸ºå®ƒé€šè¿‡ç›´æ¥è®¡ç®— key çš„å“ˆå¸Œå€¼æ¥è®¿é—®å…ƒç´ ï¼Œæ˜¯O(1)å¤æ‚åº¦ï¼ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:15","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"16. unordered_multiset Container properties: Associative | Unordered | Set | Multiple equivalent keys | Allocator-aware å®¹å™¨å±æ€§ï¼šå…³è”å®¹å™¨ï¼Œæ— åºï¼Œå…ƒç´ è‡ªèº«å³keyï¼Œå…è®¸ä¸åŒå…ƒç´ å€¼ç›¸åŒï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼› template \u003c class Key, // unordered_multiset::key_type/value_type class Hash = hash, // unordered_multiset::hasher class Pred = equal_to, // unordered_multiset::key_equal class Alloc = allocator // unordered_multiset::allocator_type class unordered_multiset; unordered_multisetï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯é›†é½äº†â€œå“ˆå¸Œè¡¨ä¸ºåº•å±‚ç»“æ„â€ï¼Œâ€œå…ƒç´ è‡ªèº«å³keyâ€ï¼Œâ€œå…è®¸ä¸åŒå…ƒç´ å€¼ç›¸åŒâ€è¿™ä¸‰ä¸ªç‰¹æ€§çš„å®¹å™¨ï¼Œæ˜¯å¯¹ unordered_set çš„ç®€å•æ‹“å±•ã€‚ unordered_multiset çš„æ•ˆç‡ç‰¹æ€§ä¸æ‰€æœ‰åŸºäºå“ˆå¸Œè¡¨çš„å®¹å™¨ç›¸ä¼¼ï¼Œå‚è§ unordered_setï¼Œä¸å†èµ˜è¿°ã€‚ ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:16","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["C++"],"content":"17. pair \u0026\u0026 tuple template \u003cclassâ€¦ Types\u003e class tuple; template \u003cclass T1, class T2\u003e struct pair; std::pair å’Œ std::tuple å¹¶ä¸æ˜¯stlå®¹å™¨åº“ä¸­çš„å®¹å™¨ï¼Œä¸è¿‡é‰´äºç»å¸¸ç”¨åˆ°ï¼Œå°±é¡ºä¾¿æ•´ç†ä¸€ä¸‹ã€‚å…ˆä» tuple è¯´èµ·ï¼Œpair ç›¸å½“äº tuple çš„ç‰¹ä¾‹ã€‚ tuple å«ä½œå…ƒç»„ï¼Œå®ƒå¯ä»¥æŠŠä¸€ç»„ç±»å‹ç›¸åŒæˆ–ä¸åŒçš„å…ƒç´ ç»„åˆåˆ°ä¸€èµ·ï¼Œä¸”å…ƒç´ çš„æ•°é‡ä¸é™ã€‚tuple çš„åº•å±‚åŸç†ä¸ stl ä¸­çš„å®¹å™¨å®Œå…¨ä¸åŒï¼Œä½†åœ¨åŠŸèƒ½ä¸Šï¼Œtuple æ˜¯å¯¹å®¹å™¨çš„æœ‰æ•ˆè¡¥å……ï¼Œå› ä¸ºæ‰€æœ‰çš„å®¹å™¨éƒ½åªèƒ½ç»„åˆç›¸åŒç±»å‹çš„å…ƒç´ ï¼Œä½†tuple å¯ä»¥ç»„åˆä»»æ„ä¸åŒç±»å‹çš„å…ƒç´ ã€‚åœ¨ä½¿ç”¨ä¸Šï¼Œå¯ä»¥ç”¨std::make_tuple()æ¥æ„é€  tuple å¯¹è±¡ï¼Œå¯ä»¥ç”¨std::get()æ¥è·å– tuple å¯¹è±¡çš„æŸä¸ªå…ƒç´ ï¼Œæ³¨æ„std::get()è¿”å›çš„æ˜¯ tuple å¯¹è±¡ä¸­æŸä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Œå› æ­¤æ˜¯å¯ä»¥ç”¨ä½œå·¦å€¼çš„ï¼æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨std::tie()æ‰“åŒ…ä¸€ç»„å˜é‡æ¥ä½œä¸ºå·¦å€¼æ¥å— tuple å¯¹è±¡çš„èµ‹å€¼ã€‚ tuple çš„åº•å±‚åŸç†å¤§æ¦‚æ˜¯ä¸€ä¸ªå±‚å±‚ç»§æ‰¿çš„ç±»ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œå†™çš„éå¸¸é€å½»ã€‚ pair å¯ä»¥çœ‹ä½œæ˜¯æŠŠ tuple çš„ size é™åˆ¶ä¸º 2 çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œpair åªèƒ½æŠŠä¸€å¯¹å„¿å…ƒç´ ç»„åˆåˆ°ä¸€èµ·ã€‚åœ¨ä½¿ç”¨ä¸Šï¼Œå¯ä»¥ç”¨std::make_pair()æ¥ç›´æ¥æ„å»º pair å¯¹è±¡ï¼Œå¯ä»¥ç”¨std::get\u003c0\u003e()å’Œstd::get\u003c1\u003e()æ¥åˆ†åˆ«è·å– pair å¯¹è±¡çš„ä¸¤ä¸ªå…ƒç´ ï¼Œä½†æ›´æ–¹ä¾¿çš„åšæ³•æ˜¯ç›´æ¥è®¿é—® pair ç±»å‹çš„ä¸¤ä¸ªæ•°æ®æˆå‘˜pairå¯¹è±¡.firstå’Œpairå¯¹è±¡.secondæ¥è®¿é—®å…ƒç´  reference: [1]. https://zhuanlan.zhihu.com/p/542115773 ","date":"2023-07-16","objectID":"/posts/datastructrue/:1:17","tags":["draft"],"title":"C++ STL Containers","uri":"/posts/datastructrue/"},{"categories":["Algorithm"],"content":"Runebook www.doc4dev.com ","date":"2023-07-16","objectID":"/posts/treenode/:0:0","tags":["draft"],"title":"TreeNode äºŒå‰æ ‘","uri":"/posts/treenode/"},{"categories":["Algorithm"],"content":"æ·±åº¦ä¼˜å…ˆéå† å‰åºéå†ï¼šä¸­å·¦å³ 5 4 1 2 6 7 8 ä¸­åºéå†ï¼šå·¦ä¸­å³ 1 4 2 5 7 6 8 ååºéå†ï¼šå·¦å³ä¸­ 1 2 4 7 8 6 5 äºŒå‰æ ‘çš„å®šä¹‰ struct TreeNode { int val; TreeNode *left; TreeNode *right; TreeNode(int x) : val(x), left(NULL), right(NULL) {} }; ","date":"2023-07-16","objectID":"/posts/treenode/:1:0","tags":["draft"],"title":"TreeNode äºŒå‰æ ‘","uri":"/posts/treenode/"},{"categories":["Algorithm"],"content":"å‰åºéå† é€’å½’æ³• class Solution { public: void traversal(TreeNode* cur, vector\u003cint\u003e\u0026 vec) { if (cur == nullptr) return; vec.push_back(cur-\u003eval); traversal(root-\u003eleft, vec); traversal(root-\u003eright, vec); } vector\u003cint\u003e preorderTraversal(TreeNode* root) { vector\u003cint\u003e res; traversal(root, vec); return res; } }; è¿­ä»£æ³• class Solution { public: vector\u003cint\u003e preorderTraversal(TreeNode* root) { stack\u003cTreeNode*\u003e st; vector\u003cint\u003e res; if (root == nullptr) return res; st.push(root); while (!st.empty()) { TreeNode* node = st.top(); st.pop(); res.push_back(node-\u003eval); if (node-\u003eright) st.push(node-\u003eright); if (node-\u003eleft) st.push(node-\u003eleft); } return res; } }; ","date":"2023-07-16","objectID":"/posts/treenode/:1:1","tags":["draft"],"title":"TreeNode äºŒå‰æ ‘","uri":"/posts/treenode/"},{"categories":["Algorithm"],"content":"ä¸­åºéå† é€’å½’æ³• class Solution { public: void traversal(TreeNode* cur, vector\u003cint\u003e\u0026 vec) { if (cur == nullptr) return; traversal(root-\u003eleft, vec); vec.push_back(cur-\u003eval); traversal(root-\u003eright, vec); } vector\u003cint\u003e inorderTraversal(TreeNode* root) { vector\u003cint\u003e res; traversal(root, vec); return res; } }; è¿­ä»£æ³• // ä¸­åºéå† class Solution { public: vector\u003cint\u003e inorderTraversal(TreeNode* root) { stack\u003cTreeNode*\u003e st; vector\u003cint\u003e res; if (root == nullptr) return; TreeNode* cur = root; while (!cur || !st.empty()) { if (cur != nullptr) { st.push(cur); cur = cur-\u003eleft; // å·¦ } else { cur = st.top(); st.pop(); res.push_back(cur-\u003eval); cur = cur-\u003eright; } } return res; } }; ","date":"2023-07-16","objectID":"/posts/treenode/:1:2","tags":["draft"],"title":"TreeNode äºŒå‰æ ‘","uri":"/posts/treenode/"},{"categories":["Algorithm"],"content":"ååºéå† é€’å½’æ³• class Solution { public: void traversal(TreeNode* cur, vector\u003cint\u003e\u0026 vec) { if (cur == nullptr) return; traversal(root-\u003eleft, vec); traversal(root-\u003eright, vec); vec.push_back(cur-\u003eval); } vector\u003cint\u003e postorderTraversal(TreeNode* root) { vector\u003cint\u003e res; traversal(root, vec); return res; } }; è¿­ä»£æ³• class Solution { public: vector\u003cint\u003e postorderTraversal(TreeNode* root) { vector\u003cint\u003e res; if (!root) return res; stack\u003cTreeNode*\u003e st; st.push(root); while (!st.empty()) { TreeNode* node = st.top(); st.pop(); res.push(node-\u003eval); if (node-\u003eleft) st.push(node-\u003eleft); if (node-\u003eright) st.push(node-\u003eright); } reverse(res.begin(), res.end()); return res; } }; ","date":"2023-07-16","objectID":"/posts/treenode/:1:3","tags":["draft"],"title":"TreeNode äºŒå‰æ ‘","uri":"/posts/treenode/"},{"categories":["Algorithm"],"content":"äºŒå‰æ ‘çš„ç»Ÿä¸€è¿­ä»£æ³• è¿­ä»£æ³•å‰åºéå† // ä¸­å·¦å³ class Solution { public: vector\u003cint\u003e preorderTraversal(TreeNode* root) { vector\u003cint\u003e res; stack\u003cTreeNode*\u003e st; if (root) st.push(root); while (!st.empty()) { TreeNode* node = st.top(); if (node) { st.pop(); if (node-\u003eright) st.push(node-\u003eright); if (node-\u003eleft) st.push(node-\u003eleft); st.push(node); st.push(nullptr); } else { st.pop(); node = st.top(); st.pop(); res.push_back(node-\u003eval); } } return res; } }; è¿­ä»£æ³•ä¸­åºéå† //å·¦ä¸­å³ class Solution { public: vector\u003cint\u003e inorderTraversal(TreeNode* root) { vector\u003cint\u003e res; stack\u003cTreeNode*\u003e st; if (root != nullptr) st.push(root); while(!st.empty()) { TreeNode* node = st.top(); if (node != nullptr) { st.pop(); //å°†è¯¥èŠ‚ç‚¹å¼¹å‡ºï¼Œé¿å…é‡å¤æ“ä½œ if (node-\u003eright) st.push(node-\u003eright); st.push(node); st.push(nullptr); if (node-\u003eleft) st.push(node-\u003eleft); } else { st.pop(); node = st.top(); st.pop(); res.push_back(node-\u003eval); } } return res; } }; è¿­ä»£æ³•ååºéå† // å·¦å³ä¸­ class Solution { public: vector\u003cint\u003e postorderTraversal(TreeNode* root) { vector\u003cint\u003e res; stack\u003cTreeNode*\u003e st; if (root) st.push(root); while (!st.empty()) { TreeNode* node = st.top(); if (node) { st.pop(); st.push(node); st.push(nullptr); if (node-\u003eright) st.push(node-\u003eright); if (node-\u003eleft) st.push(node-\u003eleft); } else { st.pop(); node = st.top(); st.pop(); res.push_back(node-\u003eval); } } return res; } }; ","date":"2023-07-16","objectID":"/posts/treenode/:2:0","tags":["draft"],"title":"TreeNode äºŒå‰æ ‘","uri":"/posts/treenode/"},{"categories":["Algorithm"],"content":"å¹¿åº¦ä¼˜å…ˆéå† (å±‚åºéå†) é€’å½’æ³• class Solution { public: vector\u003cvector\u003cint\u003e\u003e levelOrder(TreeNode* root) { queue\u003cTreeNode*\u003e que; if (root) que.push(root); vector\u003cvector\u003cint\u003e\u003e ans; while (!que.empty()) { int size = que.size(); vector\u003cint\u003e vec; for (int i = 0; i \u003c size; ++i) { TreeNode* node = que.front(); que.pop(); vec.push_back(node-\u003eval); if (node-\u003eleft) que.push(node-\u003eleft); if (node-\u003eright) que.push(node-\u003eright); } ans.push_back(vec); } return ans; } }; è¿­ä»£æ³• class Solution { public: void order(TreeNode* cur, vector\u003cvector\u003cint\u003e\u003e\u0026 res, int depth) { if (cur == nullptr) return; if (res.size() == depth) res.push_back(vector\u003cint\u003e()); res[depth].push_back(cur-\u003eval); order(cur-\u003eleft, res, depth + 1); order(cur-\u003eright, res, depth + 1); } vector\u003cvector\u003cint\u003e\u003e levelOrder(TreeNode* root) { vector\u003cvector\u003cint\u003e\u003e res; int depth = 0; order(root, res, depth); return res; } }; ","date":"2023-07-16","objectID":"/posts/treenode/:3:0","tags":["draft"],"title":"TreeNode äºŒå‰æ ‘","uri":"/posts/treenode/"},{"categories":["Algorithm"],"content":"Sorting Algotithms Collection æ’åºç®—æ³•åˆé›† ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:0","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"0. æ’åºç®—æ³• æ’åºç®—æ³•åœ¨æ‰€æœ‰è®¡ç®—æœºç®—æ³•ï¼Œä¹ƒè‡³æ•´ä¸ªè®¡ç®—æœºé¢†åŸŸä¸­ï¼Œéƒ½å æ®ç€éå¸¸é‡è¦çš„åœ°ä½ã€‚åŸºç¡€ç®—æ³•æ˜¯è½¯ä»¶çš„æ ¸å¿ƒï¼Œè€ŒæŸ¥æ‰¾ç®—æ³•å’Œæ’åºç®—æ³•åˆ™æ˜¯è®¡ç®—æœºåŸºç¡€ç®—æ³•çš„æ ¸å¿ƒã€‚ æ’åºç®—æ³•æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­ç”¨äºå¯¹å…ƒç´ åºåˆ—è¿›è¡Œæ’åºçš„ä¸€ç³»åˆ—ç®—æ³•ã€‚æ’åºç®—æ³•åœ¨å®é™…åº”ç”¨ä¸­éå¸¸å¹¿æ³›ï¼Œæ¯”å¦‚æ•°æ®åº“ç´¢å¼•ã€æ–‡ä»¶æ’åºã€æ•°æ®æ£€ç´¢ç­‰ã€‚ 0.1 å®šä¹‰ï¼š æ’åºç®—æ³•æ˜¯ä¸€ç§å°†ä¸€ç»„æ•°æ®å…ƒç´ é‡æ–°æ’åˆ—æˆæœ‰åºåºåˆ—çš„ç®—æ³•ã€‚è¿™ä¸ªâ€œæœ‰åºâ€å¯ä»¥æ˜¯å‡åºæˆ–é™åºã€‚ 0.2 ä½œç”¨ï¼š æ’åºç®—æ³•åœ¨è®¸å¤šé¢†åŸŸéƒ½æœ‰å¹¿æ³›çš„åº”ç”¨ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š â€¢æ•°æ®åˆ†æï¼šå¯¹æ•°æ®è¿›è¡Œæ’åºå¯ä»¥æ›´å®¹æ˜“åœ°è¯†åˆ«æ•°æ®ä¸­çš„æ¨¡å¼å’Œè¶‹åŠ¿ã€‚ â€¢æ•°æ®åº“ç®¡ç†ï¼šæ•°æ®åº“æŸ¥è¯¢ç»å¸¸éœ€è¦å¯¹ç»“æœè¿›è¡Œæ’åºã€‚ â€¢æœç´¢ç®—æ³•ï¼šæ’åºç®—æ³•å¯ä»¥ç”¨äºä¼˜åŒ–æœç´¢è¿‡ç¨‹ï¼Œå¦‚äºŒåˆ†æœç´¢ä¾èµ–äºæ’åºå¥½çš„åˆ—è¡¨ã€‚ â€¢ç®—æ³•å®ç°ï¼šè®¸å¤šç®—æ³•çš„å®ç°ä¾èµ–äºæ’åºï¼Œå¦‚å½’å¹¶æ’åºæ˜¯å½’å¹¶ç®—æ³•çš„åŸºç¡€ã€‚ 0.3 åˆ†ç±»ï¼š æŒ‰ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦è¿›è¡Œåˆ†ç±»ï¼š O(n^2) ç®—æ³•ï¼šå†’æ³¡æ’åºã€é€‰æ‹©æ’åºã€æ’å…¥æ’åº O(n log n) ç®—æ³•ï¼šå¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€å †æ’åº O(n) ç®—æ³•ï¼šè®¡æ•°æ’åºã€æ¡¶æ’åºã€åŸºæ•°æ’åº æŒ‰ç…§ç©ºé—´å¤æ‚åº¦ï¼ˆå†…å­˜ä½¿ç”¨é‡ï¼‰è¿›è¡Œåˆ†ç±»ï¼š åŸåœ°æ’åºç®—æ³•ï¼ˆç©ºé—´å¤æ‚åº¦ä¸º O(1)ï¼‰ï¼šå†’æ³¡æ’åºã€é€‰æ‹©æ’åºã€æ’å…¥æ’åºã€å †æ’åº éåŸåœ°æ’åºç®—æ³•ï¼ˆç©ºé—´å¤æ‚åº¦å¤§äº O(1)ï¼‰ï¼šå½’å¹¶æ’åºã€è®¡æ•°æ’åº æŒ‰ç…§å®ç°æ’åºçš„æ–¹æ³•è¿›è¡Œåˆ†ç±»ï¼š æ’å…¥ç±»æ’åºï¼šç›´æ¥æ’å…¥æ’åºã€äºŒåˆ†æ’å…¥æ’åºã€Shellæ’åºï¼ˆå¸Œå°”æ’åºï¼‰ äº¤æ¢ç±»æ’åºï¼šå†’æ³¡æ’åºã€å¿«é€Ÿæ’åºã€éšæœºå¿«é€Ÿæ’åº é€‰æ‹©ç±»æ’åºï¼šç®€å•é€‰æ‹©æ’åºã€å †æ’åº å½’å¹¶ç±»æ’åºï¼šå½’å¹¶æ’åº åˆ†é…ç±»æ’åºï¼šè®¡æ•°æ’åºã€æ¡¶æ’åºã€åŸºæ•°æ’åº æ··åˆç±»æ’åºï¼šé¸¡å°¾é…’æ’åºï¼ˆå†’æ³¡æ’åºçš„å˜ä½“ï¼ŒåŒå‘å†’æ³¡ï¼‰ å…¶ä»–æ’åºï¼šæ‹“æ‰‘æ’åºã€å¾ªç¯æ’åº ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:1","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"1. Quick Sort å¿«é€Ÿæ’åº å¿«é€Ÿæ’åºï¼ˆQuick Sortï¼‰æ˜¯ä¸€ç§é«˜æ•ˆçš„æ’åºç®—æ³•ï¼Œç”±C. A. R. Hoareåœ¨1960å¹´æå‡ºã€‚å®ƒé‡‡ç”¨åˆ†æ²»æ³•çš„ç­–ç•¥ï¼Œé€šè¿‡é€‰æ‹©ä¸€ä¸ªâ€œåŸºå‡†â€å…ƒç´ ï¼Œå°†æ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šä¸€éƒ¨åˆ†åŒ…å«æ‰€æœ‰å°äºåŸºå‡†çš„å…ƒç´ ï¼Œå¦ä¸€éƒ¨åˆ†åŒ…å«æ‰€æœ‰å¤§äºåŸºå‡†çš„å…ƒç´ ã€‚ç„¶åé€’å½’åœ°å¯¹è¿™ä¸¤éƒ¨åˆ†è¿›è¡Œå¿«é€Ÿæ’åºã€‚ 1.1 ç®—æ³•æ­¥éª¤ â€¢é€‰æ‹©åŸºå‡†ï¼šä»æ•°ç»„ä¸­é€‰æ‹©ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†ã€‚ â€¢åˆ†åŒºæ“ä½œï¼šé‡æ–°æ’åˆ—æ•°ç»„ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å°çš„å…ƒç´ æ”¾åœ¨åŸºå‡†çš„å·¦è¾¹ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å¤§çš„å…ƒç´ æ”¾åœ¨åŸºå‡†çš„å³è¾¹ã€‚ â€¢é€’å½’æ’åºï¼šé€’å½’åœ°å¯¹åŸºå‡†å·¦è¾¹å’Œå³è¾¹çš„å­æ•°ç»„è¿›è¡Œå¿«é€Ÿæ’åºã€‚ â€¢å®Œæˆï¼šé€’å½’åˆ°åŸºæƒ…å†µï¼ˆæ•°ç»„åªæœ‰ä¸€ä¸ªæˆ–é›¶ä¸ªå…ƒç´ ï¼‰æ—¶ï¼Œæ’åºå®Œæˆã€‚ 1.2 ç®—æ³•å›¾è§£ å¿«é€Ÿæ’åºé€šè¿‡é€‰æ‹©ä¸€ä¸ªåŸºå‡†å€¼ï¼Œå°†æ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç„¶åé€’å½’åœ°å¯¹è¿™ä¸¤éƒ¨åˆ†è¿›è¡Œæ’åºã€‚ BP Network 1.3 ç®—æ³•ç‰¹ç‚¹ â€¢æ•ˆç‡ï¼šåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¿«é€Ÿæ’åºçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(n log n)ã€‚ â€¢ä¸ç¨³å®šæ€§ï¼šå¿«é€Ÿæ’åºæ˜¯ä¸ç¨³å®šçš„æ’åºç®—æ³•ï¼Œå› ä¸ºåœ¨åˆ†åŒºè¿‡ç¨‹ä¸­å¯èƒ½ä¼šæ”¹å˜ç›¸åŒå…ƒç´ çš„ç›¸å¯¹é¡ºåºã€‚ â€¢æ—¶é—´å¤æ‚åº¦ï¼šå¹³å‡æƒ…å†µä¸‹ä¸ºO(n log n)ï¼Œä½†åœ¨æœ€åæƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ï¼Œæ•°ç»„å·²ç»æ’åºæˆ–å®Œå…¨é€†åºï¼‰ä¸ºO(n^2)ã€‚ â€¢ç©ºé—´å¤æ‚åº¦ï¼šO(log n)ï¼Œå¿«é€Ÿæ’åºæ˜¯åŸåœ°æ’åºç®—æ³•ï¼Œä½†é€’å½’æ€§è´¨å¯¼è‡´å®ƒéœ€è¦O(log n)çš„é¢å¤–æ ˆç©ºé—´ã€‚ 1.4 ä»£ç å®ç° void quick_sort(vector\u003cint\u003e\u0026 nums, int l, int r) { if (l \u003e= r) { return; } int first = l, last = r; while (l \u003c r) { while (l \u003c r \u0026\u0026 nums[l] \u003c nums[first]) { l++; } while (l \u003c r \u0026\u0026 nums[r] \u003e nums[first]) { r--; } swap(nums[l], nums[r]); } swap(nums[first], nums[r]); quick_sort(nums, first, r - 1); quick_sort(nums, r + 1, last); } def quick_sort(arr, low, high): if low \u003c high: # åˆ†åŒºæ“ä½œ pivot_index = partition(arr, low, high) # é€’å½’åœ°å¯¹åŸºå‡†å·¦è¾¹å’Œå³è¾¹çš„å­æ•°ç»„è¿›è¡Œå¿«é€Ÿæ’åº quick_sort(arr, low, pivot_index - 1) quick_sort(arr, pivot_index + 1, high) def partition(arr, low, high): # é€‰æ‹©åŸºå‡†ï¼ˆè¿™é‡Œä»¥æœ€å³ä¾§çš„å…ƒç´ ä½œä¸ºåŸºå‡†ï¼‰ pivot = arr[high] i = low - 1 for j in range(low, high): if arr[j] \u003c pivot: i += 1 arr[i], arr[j] = arr[j], arr[i] # å°†åŸºå‡†æ”¾åˆ°æ­£ç¡®çš„ä½ç½® arr[i + 1], arr[high] = arr[high], arr[i + 1] return i + 1 # ç¤ºä¾‹ arr = [10, 7, 8, 9, 1, 5] quick_sort(arr, 0, len(arr) - 1) print(\"Sorted array is:\", arr) ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:2","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"2. Merge Sort å½’å¹¶æ’åº å½’å¹¶æ’åºï¼ˆMerge Sortï¼‰æ˜¯ä¸€ç§åˆ†æ²»ç®—æ³•ï¼Œç”±çº¦ç¿°Â·å†¯Â·è¯ºä¼Šæ›¼åœ¨1945å¹´å‘æ˜ã€‚å®ƒé€šè¿‡é€’å½’åœ°å°†æ•°ç»„åˆ†æˆä¸¤åŠï¼Œç„¶åå¯¹æ¯ä¸€åŠè¿›è¡Œæ’åºï¼Œæœ€åå°†æ’åºå¥½çš„ä¸¤åŠåˆå¹¶åœ¨ä¸€èµ·ï¼Œä»è€Œå®Œæˆæ•´ä¸ªæ•°ç»„çš„æ’åºã€‚ 2.1 ç®—æ³•æ­¥éª¤ â€¢åˆ†å‰²ï¼šå°†å¾…æ’åºçš„æ•°ç»„åˆ†æˆä¸¤åŠï¼Œç›´åˆ°æ¯ä¸ªå­æ•°ç»„åªåŒ…å«ä¸€ä¸ªå…ƒç´ ã€‚ â€¢é€’å½’æ’åºï¼šé€’å½’åœ°å¯¹æ¯ä¸ªå­æ•°ç»„è¿›è¡Œå½’å¹¶æ’åºã€‚ â€¢åˆå¹¶ï¼šå°†æ’åºå¥½çš„ä¸¤ä¸ªå­æ•°ç»„åˆå¹¶æˆä¸€ä¸ªæœ‰åºæ•°ç»„ã€‚ 2.2 ç®—æ³•å›¾è§£ å½’å¹¶æ’åºé€šè¿‡é€’å½’åœ°å°†æ•°ç»„åˆ†æˆæ›´å°çš„éƒ¨åˆ†ï¼Œç„¶ååˆå¹¶è¿™äº›éƒ¨åˆ†ï¼Œç›´åˆ°æ•´ä¸ªæ•°ç»„è¢«æ’åºã€‚ BP Network BP Network 2.3 ç®—æ³•ç‰¹ç‚¹ â€¢ç¨³å®šæ€§ï¼šå½’å¹¶æ’åºæ˜¯ä¸€ç§ç¨³å®šçš„æ’åºç®—æ³•ï¼Œå› ä¸ºå®ƒä¸ä¼šæ”¹å˜ç›¸åŒå…ƒç´ çš„ç›¸å¯¹é¡ºåºã€‚ â€¢æ—¶é—´å¤æ‚åº¦ï¼šæ— è®ºæœ€å¥½ã€æœ€åè¿˜æ˜¯å¹³å‡æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(n log n)ã€‚ â€¢ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå½’å¹¶æ’åºéœ€è¦ä½¿ç”¨åˆ°é¢å¤–çš„ç©ºé—´æ¥å­˜å‚¨ä¸´æ—¶çš„åˆå¹¶ç»“æœã€‚ 2.4 ä»£ç å®ç° void print_arr(vector\u003cint\u003e\u0026 nums) { for (auto num:nums) { std::cout \u003c\u003c num \u003c\u003c \" \"; } std::cout \u003c\u003c std::endl; } void merge(vector\u003cint\u003e\u0026 nums, int low, int mid, int high) { vector\u003cint\u003e tmp (high - low + 1); int i = low; int j = mid + 1; int k = 0; while (i \u003c= mid \u0026\u0026 j \u003c= high) { if (nums[i] \u003c nums[j]) { tmp[k++] = nums[i++]; } else { tmp[k++] = nums[j++]; } } while (i \u003c= mid) { tmp[k++] = nums[i++]; } while (j \u003c= high) { tmp[k++] = nums[j++]; } for (int i = 0; i \u003c tmp.size(); ++i) { nums[low+i] = tmp[i]; } } void merge_sort(vector\u003cint\u003e\u0026 nums, int l, int r) { if (l == r) return; int mid = l + (r - l) / 2; merge_sort(nums, l, mid); merge_sort(nums, mid + 1, r); merge(nums, l, mid, r); } int main() { vector\u003cint\u003e arr = {64, 34, 25, 12, 22, 11, 90}; print_arr(arr); merge_sort(arr, 0, arr.size() - 1); print_arr(arr); return 0; } Python def merge_sort(arr): if len(arr) \u003e 1: mid = len(arr) // 2 # æ‰¾åˆ°ä¸­é—´ä½ç½® L = arr[:mid] # å·¦ä¾§åºåˆ— R = arr[mid:] # å³ä¾§åºåˆ— merge_sort(L) # é€’å½’å¯¹å·¦ä¾§åºåˆ—è¿›è¡Œæ’åº merge_sort(R) # é€’å½’å¯¹å³ä¾§åºåˆ—è¿›è¡Œæ’åº # åˆå¹¶ä¸¤ä¸ªæ’åºå¥½çš„åºåˆ— i = j = k = 0 # æŒ‰é¡ºåºåˆå¹¶å…ƒç´ ç›´åˆ°ä¸€ä¸ªå­æ•°ç»„ä¸ºç©º while i \u003c len(L) and j \u003c len(R): if L[i] \u003c R[j]: arr[k] = L[i] i += 1 else: arr[k] = R[j] j += 1 k += 1 # å°†å‰©ä½™çš„å…ƒç´ ç§»åˆ°æ•°ç»„çš„æœ«å°¾ while i \u003c len(L): arr[k] = L[i] i += 1 k += 1 while j \u003c len(R): arr[k] = R[j] j += 1 k += 1 return arr # ç¤ºä¾‹ arr = [38, 27, 43, 3, 9, 82, 10] sorted_arr = merge_sort(arr) print(\"Sorted array is:\", sorted_arr) 2.5 é€‚ç”¨åœºæ™¯ å½’å¹¶æ’åºç”±äºå…¶ç¨³å®šæ€§å’Œæ—¶é—´å¤æ‚åº¦ï¼Œé€‚ç”¨äºä»¥ä¸‹æƒ…å†µï¼š â€¢å¤§æ•°æ®é›†ï¼šå½’å¹¶æ’åºé€‚åˆå¤„ç†å¤§å‹æ•°æ®é›†ï¼Œå› ä¸ºå®ƒçš„æ€§èƒ½ä¸ä¼šå—åˆ°æ•°æ®è§„æ¨¡çš„å½±å“ã€‚ â€¢ç¨³å®šæ€§éœ€æ±‚ï¼šå½“æ’åºè¿‡ç¨‹ä¸­ä¿æŒå…ƒç´ çš„ç›¸å¯¹é¡ºåºå¾ˆé‡è¦æ—¶ï¼Œå½’å¹¶æ’åºæ˜¯ä¸€ä¸ªåˆé€‚çš„é€‰æ‹©ã€‚ â€¢å¤–å­˜æ’åºï¼šå½’å¹¶æ’åºé€‚åˆäºç£ç›˜ç­‰å¤–å­˜ä¸Šçš„æ’åºï¼Œå› ä¸ºå®ƒå¯ä»¥æœ‰æ•ˆåœ°å‡å°‘è¯»å–å’Œå†™å…¥çš„æ¬¡æ•°ã€‚ â€¢å†…å­˜é™åˆ¶ï¼šå°½ç®¡å½’å¹¶æ’åºéœ€è¦é¢å¤–çš„å†…å­˜ç©ºé—´ï¼Œä½†é€šè¿‡ä¼˜åŒ–å¯ä»¥å®ç°ä¸ºåŸåœ°æ’åºï¼Œä»è€Œå‡å°‘å†…å­˜ä½¿ç”¨ã€‚ ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:3","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"3. Insertion Sort æ’å…¥æ’åº æ’å…¥æ’åºï¼ˆInsertion Sortï¼‰æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ï¼Œå®ƒé€šè¿‡æ„å»ºæœ‰åºåºåˆ—ï¼Œå¯¹äºæœªæ’åºæ•°æ®ï¼Œåœ¨å·²æ’åºåºåˆ—ä¸­ä»åå‘å‰æ‰«æï¼Œæ‰¾åˆ°ç›¸åº”ä½ç½®å¹¶æ’å…¥ã€‚ 3.1 ç®—æ³•æ­¥éª¤ â€¢å¼€å§‹ï¼šå‡è®¾åºåˆ—ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ å·²ç»æ’åºï¼› â€¢æ’å…¥ï¼šå–ä¸‹ä¸€ä¸ªæœªæ’åºçš„å…ƒç´ ï¼Œä¸å·²æ’åºåºåˆ—ä¸­çš„å…ƒç´ ä»åå‘å‰æ¯”è¾ƒï¼› â€¢ç§»åŠ¨ï¼šå¦‚æœå·²æ’åºåºåˆ—ä¸­çš„å…ƒç´ æ¯”å½“å‰å…ƒç´ å¤§ï¼Œåˆ™å°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ï¼› â€¢æ’å…¥ï¼šå°†å½“å‰å…ƒç´ æ”¾åˆ°åˆé€‚çš„ä½ç½®ï¼› â€¢é‡å¤ï¼šå¯¹åºåˆ—ä¸­å‰©ä½™çš„æ¯ä¸ªå…ƒç´ é‡å¤æ­¥éª¤2-4ã€‚ 3.2 ç®—æ³•å›¾è§£ æ’å…¥æ’åºé€šè¿‡å°†æ¯ä¸ªå…ƒç´ æ’å…¥åˆ°å‰é¢å·²æ’åºåºåˆ—ä¸­çš„é€‚å½“ä½ç½®ï¼Œä»è€Œé€æ­¥æ„å»ºå®Œæ•´çš„æœ‰åºåºåˆ—ã€‚ BP Network åŠ¨æ€ç¤ºæ„å›¾: æ’å…¥æ’åºç¤ºæ„å›¾ 3.3 ç®—æ³•ç‰¹ç‚¹ â€¢ç®€å•ï¼šæ’å…¥æ’åºçš„åŸç†å’Œå®ç°éƒ½å¾ˆç®€å•ï¼Œå®¹æ˜“ç†è§£å’Œç¼–ç¨‹å®ç°ã€‚ â€¢ç¨³å®šï¼šæ’å…¥æ’åºæ˜¯ä¸€ç§ç¨³å®šçš„æ’åºç®—æ³•ï¼Œå› ä¸ºå®ƒä¸ä¼šæ”¹å˜ç›¸åŒå…ƒç´ çš„ç›¸å¯¹é¡ºåºã€‚ â€¢æ—¶é—´å¤æ‚åº¦ï¼šåœ¨æœ€å¥½çš„æƒ…å†µä¸‹ï¼ˆå³æ•°åˆ—å·²ç»æ˜¯æ’åºçŠ¶æ€ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼›åœ¨æœ€åå’Œå¹³å‡æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n^2)ã€‚ â€¢ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œæ’å…¥æ’åºæ˜¯åŸåœ°æ’åºï¼Œä¸éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚ 3.4 ä»£ç å®ç° def insertion_sort(arr): # ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹éå†ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»æ’åº for i in range(1, len(arr)): key = arr[i] # ä»å½“å‰å…ƒç´ çš„å‰ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œå‘å‰éå†å·²æ’åºçš„å…ƒç´  j = i - 1 # å°†å¤§äºkeyçš„å…ƒç´ å‘åç§»åŠ¨ while j \u003e= 0 and key \u003c arr[j]: arr[j + 1] = arr[j] j -= 1 # å°†keyæ”¾åˆ°æ­£ç¡®çš„ä½ç½® arr[j + 1] = key return arr # ç¤ºä¾‹ arr = [12, 11, 13, 5, 6] sorted_arr = insertion_sort(arr) print(\"Sorted array is:\", sorted_arr) void insertion_sort(vector\u003cint\u003e\u0026 nums) { int n = nums.size(); for (int i = 1; i \u003c n; ++i) { int key = nums[i]; int j = i - 1; while (j \u003e= 0 \u0026\u0026 nums[j] \u003e key) { nums[j+1] = nums[j]; j--; } nums[j+1] = key; } } 3.5 é€‚ç”¨åœºæ™¯ æ’å…¥æ’åºè™½ç„¶åœ¨æœ€åæƒ…å†µä¸‹æ•ˆç‡ä¸é«˜ï¼Œä½†åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å¯èƒ½å¾ˆæœ‰ç”¨ï¼š â€¢æ•°æ®è§„æ¨¡è¾ƒå°ï¼šå¯¹äºå°å‹æ•°æ®é›†ï¼Œæ’å…¥æ’åºçš„æ€§èƒ½æ˜¯å¯æ¥å—çš„ã€‚ â€¢åˆå§‹æ•°æ®éƒ¨åˆ†æœ‰åºï¼šå¦‚æœæ•°æ®é›†å·²ç»éƒ¨åˆ†æœ‰åºï¼Œæ’å…¥æ’åºçš„æ€§èƒ½ä¼šæ¥è¿‘çº¿æ€§ã€‚ â€¢æ•™å­¦ç›®çš„ï¼šç”±äºå…¶ç®€å•æ€§ï¼Œæ’å…¥æ’åºå¸¸è¢«ç”¨ä½œæ•™å­¦ç¤ºä¾‹ï¼Œå¸®åŠ©åˆå­¦è€…ç†è§£ç®—æ³•å’Œæ’åºçš„åŸºæœ¬æ¦‚å¿µã€‚ â€¢åœ¨çº¿æ’åºï¼šæ’å…¥æ’åºé€‚åˆåœ¨çº¿æ’åºï¼Œå³æ•°æ®é€ä¸ªåˆ°æ¥æ—¶è¿›è¡Œæ’åºã€‚ ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:4","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"4. å¸Œå°”æ’åº(Shell Sorting) å¸Œå°”æ’åºæ˜¯æ’å…¥æ’åºçš„ä¸€ç§æ›´é«˜æ•ˆçš„æ”¹è¿›ç‰ˆæœ¬ï¼Œä¹Ÿç§°ä¸ºç¼©å°å¢é‡æ’åºã€‚å®ƒé€šè¿‡å¼•å…¥ä¸€ä¸ªâ€œå¢é‡â€çš„æ¦‚å¿µæ¥ä¼˜åŒ–æ’å…¥æ’åºï¼Œå…è®¸è¿›è¡Œè¾ƒè¿œè·ç¦»çš„å…ƒç´ äº¤æ¢ï¼Œä»è€Œå‡å°‘æ¯”è¾ƒå’Œç§»åŠ¨çš„æ¬¡æ•°ã€‚ 4.1 ç®—æ³•æ­¥éª¤ â€¢å¼€å§‹ï¼šé€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ—ï¼Œå®ƒå¯ä»¥æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åŠ¨æ€ç”Ÿæˆçš„ã€‚ â€¢æ’åºï¼šä½¿ç”¨æ’å…¥æ’åºå¯¹å¢é‡åºåˆ—å®šä¹‰çš„å­åºåˆ—è¿›è¡Œæ’åºã€‚ â€¢ç¼©å°ï¼šå‡å°å¢é‡åºåˆ—çš„å€¼ï¼Œé‡å¤ä¸Šä¸€æ­¥ï¼Œç›´åˆ°å¢é‡ä¸º1ã€‚ â€¢å®Œæˆï¼šå½“å¢é‡ä¸º1æ—¶ï¼Œæ•´ä¸ªæ•°ç»„å°†è¢«æ’åºã€‚ 4.2 ç®—æ³•å›¾è§£ å¸Œå°”æ’åºé€šè¿‡å°†åŸå§‹æ•°æ®åˆ†æˆå¤šä¸ªå­åºåˆ—ï¼Œæ¯ä¸ªå­åºåˆ—çš„å…ƒç´ ä¹‹é—´ç›¸éš”ç‰¹å®šçš„å¢é‡ã€‚ç„¶åå¯¹æ¯ä¸ªå­åºåˆ—è¿›è¡Œæ’å…¥æ’åºï¼Œéšç€å¢é‡çš„å‡å°ï¼Œå­åºåˆ—çš„é—´éš”ä¹Ÿé€æ¸å‡å°ï¼Œç›´åˆ°å¢é‡ä¸º1ï¼Œæ­¤æ—¶æ•´ä¸ªæ•°ç»„å·²ç»æ¥è¿‘æœ‰åºï¼Œæœ€ç»ˆè¿›è¡Œä¸€æ¬¡æ™®é€šçš„æ’å…¥æ’åºå³å¯å®Œæˆæ’åºã€‚ BP Network 4.3 ç®—æ³•ç‰¹ç‚¹ â€¢æ•ˆç‡ï¼šå¸Œå°”æ’åºçš„æ•ˆç‡ä¾èµ–äºå¢é‡åºåˆ—çš„é€‰æ‹©ï¼Œé€šå¸¸æ¯”æ™®é€šæ’å…¥æ’åºè¦å¿«ã€‚ â€¢ç¨³å®šæ€§ï¼šå¸Œå°”æ’åºæ˜¯ä¸ç¨³å®šçš„æ’åºç®—æ³•ï¼Œå› ä¸ºå®ƒåœ¨æ’å…¥æ’åºè¿‡ç¨‹ä¸­å¯èƒ½ä¼šæ”¹å˜ç›¸åŒå…ƒç´ çš„ç›¸å¯¹é¡ºåºã€‚ â€¢æ—¶é—´å¤æ‚åº¦ï¼šå¸Œå°”æ’åºçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(n^1.5)åˆ°O(n^2)ï¼Œè¿™å–å†³äºå¢é‡åºåˆ—çš„é€‰æ‹©ã€‚åœ¨æœ€å¥½çš„æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦å¯ä»¥æ¥è¿‘O(n log n)ã€‚ â€¢ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œå¸Œå°”æ’åºæ˜¯åŸåœ°æ’åºï¼Œä¸éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚ 4.4 ä»£ç å®ç° void print_arr(vector\u003cint\u003e\u0026 nums) { for (auto num:nums) { std::cout \u003c\u003c num \u003c\u003c \" \"; } std::cout \u003c\u003c std::endl; } void shell_sort(vector\u003cint\u003e\u0026 nums) { int n = nums.size(); int len = n / 2; while (len \u003e 0) { for (int i = len; i \u003c n; i++) { int j = i; int temp = nums[i]; while (j - len \u003e= 0 \u0026\u0026 temp \u003c nums[j - len]) { nums[j] = nums[j - len]; j -= len; } nums[j] = temp; } len = len / 2; } return; } int main() { vector\u003cint\u003e arr = {64, 34, 25, 12, 22, 11, 90}; print_arr(arr); shell_sort(arr); print_arr(arr); return 0; } def shell_sort(arr): n = len(arr) gap = n // 2 # åˆå§‹å¢é‡ while gap \u003e 0: for i in range(gap, n): temp = arr[i] j = i # å¯¹å­åºåˆ—è¿›è¡Œæ’å…¥æ’åº while j \u003e= gap and arr[j - gap] \u003e temp: arr[j] = arr[j - gap] j -= gap arr[j] = temp gap //= 2 # å‡å°å¢é‡ return arr # ç¤ºä¾‹ arr = [12, 11, 13, 5, 6, 7, 10, 9] sorted_arr = shell_sort(arr) print(\"Sorted array is:\", sorted_arr) 4.5 é€‚ç”¨åœºæ™¯ å¸Œå°”æ’åºç”±äºå…¶è¾ƒå¥½çš„æ€§èƒ½ï¼Œé€‚ç”¨äºä»¥ä¸‹æƒ…å†µï¼š â€¢ä¸­ç­‰æ•°æ®è§„æ¨¡ï¼šå¯¹äºæ•°æ®è§„æ¨¡ä¸æ˜¯éå¸¸å¤§çš„æƒ…å†µï¼Œå¸Œå°”æ’åºå¯ä»¥æä¾›æ¯”æ™®é€šæ’å…¥æ’åºæ›´å¥½çš„æ€§èƒ½ã€‚ â€¢åˆå§‹æ•°æ®éƒ¨åˆ†æœ‰åºï¼šå¦‚æœæ•°æ®éƒ¨åˆ†æœ‰åºï¼Œå¸Œå°”æ’åºçš„æ€§èƒ½ä¼šæœ‰æ‰€æå‡ã€‚ â€¢å¢é‡åºåˆ—é€‰æ‹©ï¼šé€šè¿‡ç²¾å¿ƒé€‰æ‹©å¢é‡åºåˆ—ï¼Œå¸Œå°”æ’åºå¯ä»¥æ¥è¿‘äºO(n log n)çš„æ—¶é—´å¤æ‚åº¦ï¼Œä»è€Œåœ¨æŸäº›æƒ…å†µä¸‹æ¯”å¿«é€Ÿæ’åºç­‰ç®—æ³•æ›´é«˜æ•ˆã€‚ ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:5","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"5. Bubble Sort å†’æ³¡æ’åº å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰æ˜¯ä¸€ç§ç®€å•çš„æ’åºç®—æ³•ï¼Œå®ƒé‡å¤åœ°éå†è¦æ’åºçš„æ•°åˆ—ï¼Œä¸€æ¬¡æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœå®ƒä»¬çš„é¡ºåºé”™è¯¯å°±æŠŠå®ƒä»¬äº¤æ¢è¿‡æ¥ã€‚éå†æ•°åˆ—çš„å·¥ä½œæ˜¯é‡å¤è¿›è¡Œç›´åˆ°æ²¡æœ‰å†éœ€è¦äº¤æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥æ•°åˆ—å·²ç»æ’åºå®Œæˆã€‚ 5.1 ç®—æ³•æ­¥éª¤ â€¢å¼€å§‹ï¼šä»æ•°åˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ¯”è¾ƒç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ ã€‚ â€¢æ¯”è¾ƒä¸äº¤æ¢ï¼šå¦‚æœå·¦è¾¹çš„å…ƒç´ å¤§äºå³è¾¹çš„å…ƒç´ ï¼Œå°±äº¤æ¢å®ƒä»¬ä¸¤ä¸ªã€‚ â€¢ç§»åŠ¨ï¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ å¯¹ï¼Œé‡å¤æ­¥éª¤2ã€‚ â€¢é‡å¤ï¼šç»§ç»­è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æœ€åä¸€æ¬¡äº¤æ¢å‘ç”Ÿï¼Œæ­¤æ—¶æ•°åˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯æœ€å¤§çš„ï¼Œå·²ç»è¢«â€œå†’æ³¡â€åˆ°å®ƒåº”è¯¥åœ¨çš„ä½ç½®ã€‚ â€¢å‡å°‘æ¯”è¾ƒæ¬¡æ•°ï¼šç”±äºæœ€å¤§çš„å…ƒç´ å·²ç»åœ¨å®ƒåº”åœ¨çš„ä½ç½®ï¼Œæ‰€ä»¥ä¸‹ä¸€æ¬¡éå†å¯ä»¥å‡å°‘ä¸€ä¸ªæ¯”è¾ƒï¼ˆå³ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œä¸éœ€è¦å†å’Œå®ƒæ¯”è¾ƒï¼‰ã€‚ 5.2 ç®—æ³•å›¾è§£ å†’æ³¡æ’åºä»å¤´å¼€å§‹ï¼Œä¾æ¬¡æ¯”è¾ƒæ•°ç»„ä¸­ç›¸é‚»çš„2ä¸ªå…ƒç´ ï¼Œå¦‚æœåé¢çš„æ•°æ¯”å‰é¢çš„æ•°å¤§ï¼Œåˆ™äº¤æ¢2ä¸ªæ•°ï¼Œå¦åˆ™ä¸äº¤æ¢ã€‚æ¯è¿›è¡Œä¸€è½®æ¯”è¾ƒï¼Œéƒ½ä¼šæŠŠæ•°ç»„ä¸­æœ€å¤§çš„å…ƒç´ æ”¾åˆ°æœ€åé¢ã€‚ BP Network 5.3 ç®—æ³•ç‰¹ç‚¹ ç®€å•ï¼šå†’æ³¡æ’åºçš„åŸç†ç®€å•ï¼Œå®¹æ˜“å®ç°ã€‚ ç¨³å®šï¼šå†’æ³¡æ’åºæ˜¯ä¸€ç§ç¨³å®šçš„æ’åºç®—æ³•ï¼Œå› ä¸ºå®ƒä¸ä¼šæ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´çš„é¡ºåºã€‚ æ—¶é—´å¤æ‚åº¦ï¼šå¹³å‡å’Œæœ€åæ—¶é—´å¤æ‚åº¦å‡ä¸ºO(n^2)ï¼Œå…¶ä¸­næ˜¯æ•°åˆ—çš„é•¿åº¦ã€‚åœ¨æœ€å¥½çš„æƒ…å†µä¸‹ï¼ˆå³æ•°åˆ—å·²ç»æ˜¯æ’åºçŠ¶æ€ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œå› ä¸ºå†’æ³¡æ’åºæ˜¯åŸåœ°æ’åºï¼Œä¸éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚ 5.4 ä»£ç å®ç° def bubble_sort(arr): n = len(arr) swapped = False for i in range(n): # ç”±äºæ¯æ¬¡æœ€å¤§çš„å…ƒç´ éƒ½ä¼šè¢«æ”¾åˆ°å®ƒåº”åœ¨çš„ä½ç½®ï¼Œæ‰€ä»¥å¯ä»¥å‡å°‘æ¯”è¾ƒæ¬¡æ•° swapped = False for j in range(0, n-i-1): # ç›¸é‚»å…ƒç´ ä¸¤ä¸¤æ¯”è¾ƒ if arr[j] \u003e arr[j+1]: # å‘ç°å…ƒç´ é¡ºåºé”™è¯¯ï¼Œäº¤æ¢å®ƒä»¬ arr[j], arr[j+1] = arr[j+1], arr[j] swapped = True if not flag: break return arr # ç¤ºä¾‹ arr = [64, 34, 25, 12, 22, 11, 90] sorted_arr = bubble_sort(arr) print(\"Sorted array is:\", sorted_arr) void print_arr(vector\u003cint\u003e\u0026 nums) { for (auto num:nums) { std::cout \u003c\u003c num \u003c\u003c \" \"; } std::cout \u003c\u003c std::endl; } void bubble_sort(vector\u003cint\u003e\u0026 nums) { int n = nums.size(); bool swapped = false; for (int i = 0; i \u003c n; ++i) { swapped = false; for (int j = 0; j \u003c n - i - 1; ++j) { if (nums[j] \u003e nums[j+1]) { swap(nums[j], nums[j+1]); swapped = true; } } if (!swapped) { // ä¸€æ—¦æ²¡æœ‰äº¤æ¢æ“ä½œï¼Œè¯´æ˜å·²ç»å®Œæˆæ’åºï¼Œå¯ä»¥è·³å‡ºå¾ªç¯ break; } } } int main() { vector\u003cint\u003e arr = {64, 34, 25, 12, 22, 11, 90}; print_arr(arr); bubble_sort(arr); print_arr(arr); // 11 12 22 25 34 64 90 return 0; } 5.5 ä½¿ç”¨åœºæ™¯ å†’æ³¡æ’åºç”±äºå…¶æ€§èƒ½åŸå› ï¼Œé€šå¸¸ä¸é€‚ç”¨äºå¤§å‹æ•°æ®é›†çš„æ’åºã€‚ç„¶è€Œï¼Œå®ƒåœ¨ä»¥ä¸‹æƒ…å†µä¸‹å¯èƒ½å¾ˆæœ‰ç”¨ï¼š æ•°æ®è§„æ¨¡è¾ƒå°ï¼šå½“æ•°æ®é›†å¾ˆå°æˆ–è€…å‡ ä¹å·²ç»æ’åºæ—¶ï¼Œå†’æ³¡æ’åºçš„æ€§èƒ½æ˜¯å¯æ¥å—çš„ã€‚ æ•™å­¦ç›®çš„ï¼šç”±äºå…¶ç®€å•æ€§ï¼Œå†’æ³¡æ’åºå¸¸è¢«ç”¨ä½œæ•™å­¦ç¤ºä¾‹ï¼Œå¸®åŠ©åˆå­¦è€…ç†è§£ç®—æ³•å’Œæ’åºçš„åŸºæœ¬æ¦‚å¿µã€‚ éœ€è¦ç¨³å®šæ€§ï¼šåœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹ï¼Œä¿æŒå…ƒç´ çš„ç›¸å¯¹é¡ºåºå¾ˆé‡è¦ï¼Œå†’æ³¡æ’åºå¯ä»¥æ»¡è¶³è¿™ç§ç¨³å®šæ€§éœ€æ±‚ã€‚ ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:6","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"6. é€‰æ‹©æ’åº é€‰æ‹©æ’åºæ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯æ¯ä¸€æ¬¡ä»å¾…æ’åºçš„æ•°æ®å…ƒç´ ä¸­é€‰å‡ºæœ€å°ï¼ˆæˆ–æœ€å¤§ï¼‰çš„ä¸€ä¸ªå…ƒç´ ï¼Œå­˜æ”¾åœ¨åºåˆ—çš„èµ·å§‹ä½ç½®ï¼Œç›´åˆ°å…¨éƒ¨å¾…æ’åºçš„æ•°æ®å…ƒç´ æ’å®Œã€‚ 6.1 ç®—æ³•æ­¥éª¤ â€¢å¼€å§‹ï¼šåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼› â€¢äº¤æ¢ï¼šå°†æ‰¾åˆ°çš„æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ä¸åºåˆ—çš„ç¬¬0ä¸ªå…ƒç´ äº¤æ¢ï¼› â€¢ç§»åŠ¨ï¼šä»åºåˆ—çš„ç¬¬1ä¸ªå…ƒç´ å¼€å§‹ï¼Œç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œç„¶åä¸åºåˆ—çš„ç¬¬1ä¸ªå…ƒç´ äº¤æ¢ï¼› â€¢é‡å¤ï¼šé‡å¤æ­¥éª¤2å’Œ3ï¼Œç›´åˆ°åºåˆ—çš„ç¬¬n-1ä¸ªå…ƒç´ ï¼ˆå…¶ä¸­næ˜¯åºåˆ—çš„é•¿åº¦ï¼‰ã€‚ 6.2 ç®—æ³•å›¾è§£ é€‰æ‹©æ’åºé€šè¿‡é‡å¤æ‰«ææ•°ç»„ï¼Œæ‰¾åˆ°æœ€å°çš„å…ƒç´ ï¼Œç„¶åå°†å…¶ä¸å½“å‰ä½ç½®çš„å…ƒç´ äº¤æ¢ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šä¸€ç›´è¿›è¡Œï¼Œç›´åˆ°æ•´ä¸ªæ•°ç»„è¢«æ’åºã€‚ BP Network 6.3 ç®—æ³•ç‰¹ç‚¹ â€¢ç®€å•ï¼šé€‰æ‹©æ’åºçš„å®ç°ç›¸å¯¹ç®€å•ï¼Œå®¹æ˜“ç†è§£å’Œç¼–ç¨‹å®ç°ã€‚ â€¢ä¸ç¨³å®šï¼šé€‰æ‹©æ’åºåœ¨äº¤æ¢è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæ”¹å˜ç›¸åŒå…ƒç´ çš„é¡ºåºï¼Œå› æ­¤å®ƒä¸æ˜¯ç¨³å®šçš„æ’åºç®—æ³•ã€‚ â€¢æ—¶é—´å¤æ‚åº¦ï¼šæ— è®ºæœ€å¥½ã€æœ€å·®è¿˜æ˜¯å¹³å‡æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(n^2)ï¼Œå…¶ä¸­næ˜¯æ•°åˆ—çš„é•¿åº¦ã€‚ â€¢ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œé€‰æ‹©æ’åºæ˜¯åŸåœ°æ’åºï¼Œä¸éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚ 6.4 ä»£ç å®ç° def selection_sort(arr): n = len(arr) for i in range(n-1): # æ‰¾åˆ°æœ€å°å…ƒç´ çš„ç´¢å¼• min_idx = i for j in range(i+1, n): if arr[j] \u003c arr[min_idx]: min_idx = j # å°†æ‰¾åˆ°çš„æœ€å°å…ƒç´ äº¤æ¢åˆ°åºåˆ—çš„å‰é¢ arr[i], arr[min_idx] = arr[min_idx], arr[i] return arr # ç¤ºä¾‹ arr = [64, 34, 25, 12, 22, 11, 90] sorted_arr = selection_sort(arr) print(\"Sorted array is:\", sorted_arr) void print_arr(vector\u003cint\u003e\u0026 nums) { for (auto num:nums) { std::cout \u003c\u003c num \u003c\u003c \" \"; } std::cout \u003c\u003c std::endl; } void selection_sort(vector\u003cint\u003e\u0026 nums) { int mid_idx; int n = nums.size(); for (int i = 0; i \u003c n - 1; ++i) { mid_idx = i; for (int j = i + 1; j \u003c n; ++j) { if (nums[j] \u003c nums[mid_idx]) { mid_idx = j; } } swap(nums[mid_idx], nums[i]); } } int main() { vector\u003cint\u003e arr = {64, 34, 25, 12, 22, 11, 90}; print_arr(arr); selection_sort(arr); print_arr(arr); return 0; } 6.5 é€‚ç”¨åœºæ™¯ é€‰æ‹©æ’åºçš„æ€§èƒ½ç›¸å¯¹è¾ƒå·®ï¼Œå› æ­¤å®ƒä¸é€‚ç”¨äºå¤§å‹æ•°æ®é›†çš„æ’åºã€‚ç„¶è€Œï¼Œåœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼Œé€‰æ‹©æ’åºå¯èƒ½æ¯”è¾ƒé€‚ç”¨ï¼š â€¢æ•°æ®è§„æ¨¡è¾ƒå°ï¼šå½“æ•°æ®é›†è¾ƒå°æ—¶ï¼Œé€‰æ‹©æ’åºçš„ç®€å•æ€§å¯èƒ½ä½¿å…¶æˆä¸ºä¸€ä¸ªåˆé€‚çš„é€‰æ‹©ã€‚ â€¢æ•™å­¦ç›®çš„ï¼šç”±äºå…¶å®ç°ç®€å•ï¼Œé€‰æ‹©æ’åºå¸¸è¢«ç”¨ä½œæ•™å­¦ç¤ºä¾‹ï¼Œå¸®åŠ©åˆå­¦è€…ç†è§£ç®—æ³•å’Œæ’åºçš„åŸºæœ¬æ¦‚å¿µã€‚ â€¢æ’åºè¿‡ç¨‹ä¸­çš„ç‰¹å®šæ“ä½œï¼šåœ¨æŸäº›ç‰¹å®šçš„åº”ç”¨åœºæ™¯ä¸­ï¼Œå¦‚æœæ’åºè¿‡ç¨‹ä¸­éœ€è¦é¢‘ç¹åœ°è®¿é—®æœªæ’åºéƒ¨åˆ†çš„å…ƒç´ ï¼Œé€‰æ‹©æ’åºå¯èƒ½æ¯”å…¶ä»–ç®—æ³•æ›´åˆé€‚ã€‚ã€‚ ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:7","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"6. å †æ’åº ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:8","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"7. è®¡æ•°æ’åº ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:9","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"8. æ¡¶æ’åº ","date":"2023-07-16","objectID":"/posts/sortingalgo/:1:10","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"Reference: [1]. https://mp.weixin.qq.com/s/P8MmmMc4vB_I9tnK3towLQ ","date":"2023-07-16","objectID":"/posts/sortingalgo/:2:0","tags":["ç®—æ³•"],"title":"æ’åºç®—æ³•","uri":"/posts/sortingalgo/"},{"categories":["Algorithm"],"content":"KnapSack èƒŒåŒ…é—®é¢˜ Definiton å®šä¹‰ èƒŒåŒ…é—®é¢˜æ˜¯ä¸€ç§ç»„åˆä¼˜åŒ–çš„NPå®Œå…¨é—®é¢˜:æœ‰Nä¸ªç‰©å“å’Œå®¹é‡ä¸ºWçš„èƒŒåŒ…ï¼Œæ¯ä¸ªç‰©å“éƒ½æœ‰è‡ªå·±çš„ä½“ç§¯wå’Œä»·å€¼vï¼Œæ±‚æ‹¿å“ªäº›ç‰©å“å¯ä»¥ä½¿å¾—èƒŒåŒ…æ‰€è£…ä¸‹çš„ç‰©å“çš„æ€»ä»·å€¼æœ€å¤§ã€‚å¦‚æœé™å®šæ¯ç§ç‰©å“åªèƒ½é€‰æ‹©0ä¸ªæˆ–è€…1ä¸ªï¼Œåˆ™ç§°é—®é¢˜ä¸º0-1èƒŒåŒ…é—®é¢˜;å¦‚æœä¸é™å®šæ¯ç§ç‰©å“çš„æ•°é‡ï¼Œåˆ™é—®é¢˜ç§°ä¸ºæ— ç•ŒèƒŒåŒ…é—®é¢˜å’Œæˆ–è€…å®Œå…¨èƒŒåŒ…é—®é¢˜ã€‚ 0-1 èƒŒåŒ…é—®é¢˜ ä»¥ 0-1 èƒŒåŒ…é—®é¢˜ä¸ºä¾‹ã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„ dp å­˜å‚¨æœ€å¤§ä»·å€¼ï¼Œå…¶ä¸­ dp[i][j] è¡¨ç¤ºå‰ i ä»¶ç‰©å“ä½“ç§¯ä¸è¶…è¿‡ j çš„æƒ…å†µä¸‹èƒ½è¾¾åˆ°çš„æœ€å¤§ä»·å€¼ã€‚åœ¨æˆ‘ä»¬éå†åˆ°ç¬¬ i ä»¶ç‰©å“æ—¶ï¼Œåœ¨å½“å‰èƒŒåŒ…æ€»å®¹é‡ä¸º j çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬ä¸å°†ç‰©å“ i æ”¾å…¥èƒŒåŒ…ï¼Œé‚£ä¹ˆ dp[i][j] = dp[i-1][j]ï¼Œå³å‰ i ä¸ªç‰©å“çš„æœ€å¤§ä»·å€¼ç­‰äºåªå–å‰ i-1 ä¸ªç‰©å“æ—¶çš„æœ€å¤§ä»·å€¼ï¼›å¦‚æœæˆ‘ä»¬å°†ç‰©å“ i æ”¾å…¥èƒŒåŒ…ï¼Œå‡è®¾ç¬¬ i ä»¶ç‰©å“ä½“ç§¯ä¸º wï¼Œä»·å€¼ä¸º vï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—åˆ° dp[i][j] = dp[i-1][j-w] + vã€‚æˆ‘ä»¬åªéœ€åœ¨éå†è¿‡ç¨‹ä¸­å¯¹è¿™ä¸¤ç§æƒ…å†µå–æœ€å¤§å€¼å³å¯ï¼Œæ€»æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½ä¸º O(NW)ã€‚ int knapsack(vector\u003cint\u003e\u0026 weights, vector\u003cint\u003e\u0026 values, int N, int W) { vector\u003cvector\u003cint\u003e\u003e dp(N+1, vector\u003cint\u003e (W+1, 0)); for (int i = 1; i \u003c=N; ++i) { int w = weight[i-1], v = values[i-1]; for (int j = 1; j \u003c= W; ++j) { if (j \u003e= w) { dp[i][j] = max(dp[i-1][j], dp[i-1][j-w] + v); } else { dp[i][j] = dp[i-1][j]; } } } return dp[N][W]; } ç©ºé—´å‹ç¼©: int knapsack(vector\u003cint\u003e\u0026 weights, vector\u003cint\u003e\u0026 values, int N, int W) { vector\u003cint\u003e dp(W+1, 0); for (int i = 1; i \u003c= N; ++i) { int w = weights[i-1], v = values[i-1]; for (j = W; j \u003e= w; ++j) { dp[j] = max(dp[j], dp[j-w] + v); } } return dp[W]; } å®Œå…¨èƒŒåŒ…é—®é¢˜ å®Œå…¨èƒŒåŒ…é—®é¢˜ä¸­ï¼Œä¸€ä¸ªç‰©å“å¯ä»¥æ‹¿å¤šæ¬¡ã€‚å¯¹äºæ‹¿å¤šä¸ªç‰©å“çš„æƒ…å†µï¼Œæˆ‘ä»¬åªéœ€è€ƒè™‘ dp[2][3] å³å¯ï¼Œå³ dp[2][5] = max(dp[1][5], dp[2][3] + 3)ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬ å°±å¾—åˆ°äº†å®Œå…¨èƒŒåŒ…é—®é¢˜çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼šdp[i][j] = max(dp[i-1][j], dp[i][j-w] + v)ï¼Œå…¶ä¸ 0-1èƒŒåŒ…é—®é¢˜çš„å·®åˆ«ä»…ä»…æ˜¯æŠŠçŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸­çš„ç¬¬äºŒä¸ª i-1 å˜æˆäº† iã€‚ int knapsack(vector\u003cint\u003e\u0026 weights, vector\u003cint\u003e\u0026 values, int N, int W) { vector\u003cvector\u003cint\u003e\u003e dp(N+1, vector\u003cint\u003e(W+1, 0)); for (int i = 1; i \u003c= N; ++i) { int w = weights[i-1], v = values[i-1]; for (int j = 1; j \u003c= W; ++j) { if (j \u003e= w) { dp[i][j] = max(dp[i-1][j], dp[i][j-w] + v); } else { dp[i][j] = dp[i-1][j]; } } } return dp[N][W]; } ç©ºé—´å‹ç¼©: int knapsack(vector\u003cint\u003e\u0026 weights, vector\u003cint\u003e\u0026 values, int N, int W) { vector\u003cint\u003e dp(W+1, 0); for (int i = 1; i \u003c= N; ++i) { int w = weights[i-1], v = values[i-1]; for (int j = w; j \u003c= W; ++j) { dp[j] = max(dp[j], dp[j-w] + v); } } return dp[W]; } ref: dp: https://juejin.cn/post/6844903993429196813 knapsack problem: https://blog.csdn.net/qq_38410730/article/details/81667885 å®Œå…¨èƒŒåŒ…é—®é¢˜: https://www.cnblogs.com/darkerg/p/15464987.html ","date":"2023-07-16","objectID":"/posts/knapsack/:0:1","tags":["draft"],"title":"KnapSack Problem èƒŒåŒ…é—®é¢˜","uri":"/posts/knapsack/"},{"categories":["ML"],"content":"æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆMaximum likelihood estimation, ç®€ç§°MLEï¼‰å’Œæœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡ï¼ˆMaximum a posteriori estimation, ç®€ç§°MAPï¼‰æ˜¯å¾ˆå¸¸ç”¨çš„ä¸¤ç§å‚æ•°ä¼°è®¡æ–¹æ³•ï¼Œå¦‚æœä¸ç†è§£è¿™ä¸¤ç§æ–¹æ³•çš„æ€è·¯ï¼Œå¾ˆå®¹æ˜“å¼„æ··å®ƒä»¬ã€‚ä¸‹æ–‡å°†è¯¦ç»†è¯´æ˜MLEå’ŒMAPçš„æ€è·¯ä¸åŒºåˆ«ã€‚ ä½†åˆ«æ€¥ï¼Œæˆ‘ä»¬å…ˆä»æ¦‚ç‡å’Œç»Ÿè®¡çš„åŒºåˆ«è®²èµ·ã€‚ æ¦‚ç‡å’Œç»Ÿè®¡æ˜¯ä¸€ä¸ªä¸œè¥¿å—ï¼Ÿ æ¦‚ç‡(probabilty)å’Œç»Ÿè®¡(statistics)çœ‹ä¼¼ä¸¤ä¸ªç›¸è¿‘çš„æ¦‚å¿µï¼Œå…¶å®ç ”ç©¶çš„é—®é¢˜åˆšå¥½ç›¸åã€‚ æ¦‚ç‡ç ”ç©¶çš„é—®é¢˜æ˜¯ï¼Œå·²çŸ¥ä¸€ä¸ªæ¨¡å‹å’Œå‚æ•°ï¼Œæ€ä¹ˆå»é¢„æµ‹è¿™ä¸ªæ¨¡å‹äº§ç”Ÿçš„ç»“æœçš„ç‰¹æ€§(ä¾‹å¦‚å‡å€¼ï¼Œæ–¹å·®ï¼Œåæ–¹å·®ç­‰ç­‰)ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘æƒ³ç ”ç©¶æ€ä¹ˆå…»çŒª(æ¨¡å‹æ˜¯çŒª)ï¼Œæˆ‘é€‰å¥½äº†æƒ³å…»çš„å“ç§ã€å–‚å…»æ–¹å¼ã€çŒªæ£šçš„è®¾è®¡ç­‰ç­‰(é€‰æ‹©å‚æ•°)ï¼Œæˆ‘æƒ³çŸ¥é“æˆ‘å…»å‡ºæ¥çš„çŒªå¤§æ¦‚èƒ½æœ‰å¤šè‚¥ï¼Œè‚‰è´¨æ€ä¹ˆæ ·(é¢„æµ‹ç»“æœ)ã€‚ ç»Ÿè®¡ç ”ç©¶çš„é—®é¢˜åˆ™ç›¸åã€‚ç»Ÿè®¡æ˜¯ï¼Œæœ‰ä¸€å †æ•°æ®ï¼Œè¦åˆ©ç”¨è¿™å †æ•°æ®å»é¢„æµ‹æ¨¡å‹å’Œå‚æ•°ã€‚ä»ä»¥çŒªä¸ºä¾‹ã€‚ç°åœ¨æˆ‘ä¹°åˆ°äº†ä¸€å †è‚‰ï¼Œé€šè¿‡è§‚å¯Ÿå’Œåˆ¤æ–­ï¼Œæˆ‘ç¡®å®šè¿™æ˜¯çŒªè‚‰(è¿™å°±ç¡®å®šäº†æ¨¡å‹ã€‚åœ¨å®é™…ç ”ç©¶ä¸­ï¼Œä¹Ÿæ˜¯é€šè¿‡è§‚å¯Ÿæ•°æ®æ¨æµ‹æ¨¡å‹æ˜¯ï¼åƒé«˜æ–¯åˆ†å¸ƒçš„ã€æŒ‡æ•°åˆ†å¸ƒçš„ã€æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒçš„ç­‰ç­‰)ï¼Œç„¶åï¼Œå¯ä»¥è¿›ä¸€æ­¥ç ”ç©¶ï¼Œåˆ¤å®šè¿™çŒªçš„å“ç§ã€è¿™æ˜¯åœˆå…»çŒªè¿˜æ˜¯è·‘å±±çŒªè¿˜æ˜¯ç½‘æ˜“çŒªï¼Œç­‰ç­‰(æ¨æµ‹æ¨¡å‹å‚æ•°)ã€‚ ä¸€å¥è¯æ€»ç»“ï¼šæ¦‚ç‡æ˜¯å·²çŸ¥æ¨¡å‹å’Œå‚æ•°ï¼Œæ¨æ•°æ®ã€‚ç»Ÿè®¡æ˜¯å·²çŸ¥æ•°æ®ï¼Œæ¨æ¨¡å‹å’Œå‚æ•°ã€‚ æ˜¾ç„¶ï¼Œæœ¬æ–‡è§£é‡Šçš„MLEå’ŒMAPéƒ½æ˜¯ç»Ÿè®¡é¢†åŸŸçš„é—®é¢˜ã€‚å®ƒä»¬éƒ½æ˜¯ç”¨æ¥æ¨æµ‹å‚æ•°çš„æ–¹æ³•ã€‚ä¸ºä»€ä¹ˆä¼šå­˜åœ¨ç€ä¸¤ç§ä¸åŒæ–¹æ³•å‘¢ï¼Ÿ è¿™éœ€è¦ç†è§£è´å¶æ–¯æ€æƒ³ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹è´å¶æ–¯å…¬å¼ã€‚ è´å¶æ–¯å…¬å¼åˆ°åº•åœ¨è¯´ä»€ä¹ˆï¼Ÿ å­¦ä¹ æœºå™¨å­¦ä¹ å’Œæ¨¡å¼è¯†åˆ«çš„äººä¸€å®šéƒ½å¬è¿‡è´å¶æ–¯å…¬å¼(Bayesâ€™ Theorem)ï¼š å¼[1] $P(A|B)=\\frac{P(B|A)P(A)}{P(B)}$ è´å¶æ–¯å…¬å¼çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œæ— éæ˜¯å€’äº†å€’æ¡ä»¶æ¦‚ç‡å’Œè”åˆæ¦‚ç‡çš„å…¬å¼ã€‚ æŠŠBå±•å¼€ï¼Œå¯ä»¥å†™æˆ: å¼[2] $P(A|B)=\\frac{P(B|A)P(A)}{P(B|A)P(A) + P(B|\\sim A)P(\\sim A)}$ è¿™ä¸ªå¼å­å°±å¾ˆæœ‰æ„æ€äº†ã€‚ æƒ³æƒ³è¿™ä¸ªæƒ…å†µã€‚ä¸€è¾†æ±½è½¦(æˆ–è€…ç”µç“¶è½¦)çš„è­¦æŠ¥å“äº†ï¼Œä½ é€šå¸¸æ˜¯ä»€ä¹ˆååº”ï¼Ÿæœ‰å°å·ï¼Ÿæ’è½¦äº†ï¼Ÿ ä¸ã€‚ã€‚ ä½ é€šå¸¸ä»€ä¹ˆååº”éƒ½æ²¡æœ‰ã€‚å› ä¸ºæ±½è½¦è­¦æŠ¥å“ä¸€å“å®åœ¨æ˜¯å¤ªæ­£å¸¸äº†ï¼æ¯å¤©éƒ½è¦å‘ç”Ÿå¥½å¤šæ¬¡ã€‚æœ¬æ¥ï¼Œæ±½è½¦è­¦æŠ¥è®¾ç½®çš„åŠŸèƒ½æ˜¯ï¼Œå‡ºç°äº†å¼‚å¸¸æƒ…å†µï¼Œéœ€è¦äººå…³æ³¨ã€‚ç„¶è€Œï¼Œç”±äºè™šè­¦å®åœ¨æ˜¯å¤ªå¤šï¼Œäººä»¬æ¸æ¸ä¸ç›¸ä¿¡è­¦æŠ¥çš„åŠŸèƒ½äº†ã€‚ è´å¶æ–¯å…¬å¼å°±æ˜¯åœ¨æè¿°ï¼Œä½ æœ‰å¤šå¤§æŠŠæ¡èƒ½ç›¸ä¿¡ä¸€ä»¶è¯æ®ï¼Ÿï¼ˆhow much you can trust the evidenceï¼‰ æˆ‘ä»¬å‡è®¾å“è­¦æŠ¥çš„ç›®çš„å°±æ˜¯æƒ³è¯´æ±½è½¦è¢«ç ¸äº†ã€‚æŠŠ$A$è®¡ä½œâ€œæ±½è½¦è¢«ç ¸äº†â€ï¼Œ$B$è®¡ä½œâ€œè­¦æŠ¥å“äº†â€ï¼Œå¸¦è¿›è´å¶æ–¯å…¬å¼é‡Œçœ‹ã€‚æˆ‘ä»¬æƒ³æ±‚ç­‰å¼å·¦è¾¹å‘ç”Ÿ$Aâˆ£B$çš„æ¦‚ç‡ï¼Œè¿™æ˜¯åœ¨è¯´è­¦æŠ¥å“äº†ï¼Œæ±½è½¦ä¹Ÿç¡®å®è¢«ç ¸äº†ã€‚æ±½è½¦è¢«ç ¸**å¼•èµ·(trigger)**è­¦æŠ¥å“ï¼Œå³Bâˆ£Aã€‚ä½†æ˜¯ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ±½è½¦è¢«å°å­©å­çš®çƒè¸¢äº†ä¸€ä¸‹ã€è¢«è¡Œäººç¢°äº†ä¸€ä¸‹ç­‰å…¶ä»–åŸå› (ç»Ÿç»Ÿè®¡ä½œ$\\sim A$)ï¼Œå…¶ä»–åŸå› å¼•èµ·æ±½è½¦è­¦æŠ¥å“äº†ï¼Œå³ $B|\\sim A$ã€‚é‚£ä¹ˆï¼Œç°åœ¨çªç„¶å¬è§è­¦æŠ¥å“äº†ï¼Œè¿™æ—¶æ±½è½¦å·²ç»è¢«ç ¸äº†çš„æ¦‚ç‡æ˜¯å¤šå°‘å‘¢(è¿™å³æ˜¯è¯´ï¼Œè­¦æŠ¥å“è¿™ä¸ªè¯æ®æœ‰äº†ï¼Œå¤šå¤§æŠŠæ¡èƒ½ç›¸ä¿¡å®ƒç¡®å®æ˜¯åœ¨æŠ¥è­¦è¯´æ±½è½¦è¢«ç ¸äº†)æƒ³ä¸€æƒ³ï¼Œåº”å½“è¿™æ ·æ¥è®¡ç®—ã€‚ç”¨è­¦æŠ¥å“èµ·ã€æ±½è½¦ä¹Ÿè¢«ç ¸äº†è¿™äº‹ä»¶çš„æ•°é‡ï¼Œé™¤ä»¥å“è­¦æŠ¥äº‹ä»¶çš„æ•°é‡(è¿™å³[å¼1])ã€‚è¿›ä¸€æ­¥å±•å¼€ï¼Œå³è­¦æŠ¥å“èµ·ã€æ±½è½¦ä¹Ÿè¢«ç ¸äº†çš„äº‹ä»¶çš„æ•°é‡ï¼Œé™¤ä»¥è­¦æŠ¥å“èµ·ã€æ±½è½¦è¢«ç ¸äº†çš„äº‹ä»¶æ•°é‡åŠ ä¸Šè­¦æŠ¥å“èµ·ã€æ±½è½¦æ²¡è¢«ç ¸çš„äº‹ä»¶æ•°é‡(è¿™å³[å¼2])ã€‚ å†æ€è€ƒ[å¼2]ã€‚æƒ³è®©$P(Aâˆ£B)=1$ï¼Œå³è­¦æŠ¥å“äº†ï¼Œæ±½è½¦ä¸€å®šè¢«ç ¸äº†ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿè®©$P(B|\\sim A)P(\\sim A) = 0$å³ å¯ ã€‚å¾ˆå®¹æ˜“æƒ³æ¸…æ¥šï¼Œå‡è‹¥è®©$P(\\sim A)=0$,å³æœç»äº†æ±½è½¦è¢«çƒè¸¢ã€è¢«è¡Œäººç¢°åˆ°ç­‰ç­‰å…¶ä»–æ‰€æœ‰æƒ…å†µï¼Œé‚£è‡ªç„¶ï¼Œè­¦æŠ¥å“äº†ï¼Œåªå‰©ä¸‹ä¸€ç§å¯èƒ½â€”â€”æ±½è½¦è¢«ç ¸äº†ã€‚è¿™å³æ˜¯æé«˜äº†å“è­¦æŠ¥è¿™ä¸ªè¯æ®çš„è¯´æœåŠ›ã€‚ **ä»è¿™ä¸ªè§’åº¦æ€»ç»“è´å¶æ–¯å…¬å¼ï¼šåšåˆ¤æ–­çš„æ—¶å€™ï¼Œè¦è€ƒè™‘æ‰€æœ‰çš„å› ç´ ã€‚**è€æ¿éª‚ä½ ï¼Œä¸ä¸€å®šæ˜¯ä½ æŠŠä»€ä¹ˆå·¥ä½œæç ¸äº†ï¼Œå¯èƒ½åªæ˜¯ä»–ä»Šå¤©å‡ºé—¨å‰å’Œå¤ªå¤ªåµäº†ä¸€æ¶ã€‚ å†æ€è€ƒ[å¼2]ã€‚è§‚å¯Ÿã€å¼2ã€‘å³è¾¹çš„åˆ†å­ï¼Œ$P(Bâˆ£A)$ä¸ºæ±½è½¦è¢«ç ¸åå“è­¦æŠ¥çš„æ¦‚ç‡ã€‚å§‘ä¸”è®¤ä¸ºè¿™æ˜¯1å§ã€‚ä½†æ˜¯ï¼Œè‹¥$P(A)$å¾ˆå°ï¼Œå³æ±½è½¦è¢«ç ¸çš„æ¦‚ç‡æœ¬èº«å°±å¾ˆå°ï¼Œåˆ™$P(Bâˆ£A)P(A)$ä»ç„¶å¾ˆå°ï¼Œå³ã€å¼2ã€‘å³è¾¹åˆ†å­ä»ç„¶å¾ˆå°ï¼Œ$P(A|B)$è¿˜æ˜¯å¤§ä¸èµ·æ¥ã€‚ è¿™é‡Œï¼Œ$â€‹P(A)$ å³æ˜¯å¸¸è¯´çš„å…ˆéªŒæ¦‚ç‡ï¼Œå¦‚æœAçš„å…ˆéªŒæ¦‚ç‡å¾ˆå°ï¼Œå°±ç®—$P(Bâˆ£A)$è¾ƒå¤§ï¼Œå¯èƒ½Açš„åéªŒæ¦‚ç‡$P(Aâˆ£B)$è¿˜æ˜¯ä¸ä¼šå¤§(å‡è®¾$P(Bâˆ£\\sim A)P(\\sim A)$ä¸å˜çš„æƒ…å†µä¸‹)ã€‚ ä»è¿™ä¸ªè§’åº¦æ€è€ƒè´å¶æ–¯å…¬å¼ï¼šä¸€ä¸ªæœ¬æ¥å°±éš¾ä»¥å‘ç”Ÿçš„äº‹æƒ…ï¼Œå°±ç®—å‡ºç°æŸä¸ªè¯æ®å’Œä»–å¼ºçƒˆç›¸å…³ï¼Œä¹Ÿè¦è°¨æ…ã€‚è¯æ®å¾ˆå¯èƒ½æ¥è‡ªåˆ«çš„è™½ç„¶ä¸æ˜¯å¾ˆç›¸å…³ï¼Œä½†å‘ç”Ÿæ¦‚ç‡è¾ƒé«˜çš„äº‹æƒ…ã€‚ ä¼¼ç„¶å‡½æ•° ä¼¼ç„¶(likelihood)è¿™ä¸ªè¯å…¶å®å’Œæ¦‚ç‡(probability)æ˜¯å·®ä¸å¤šçš„æ„æ€ï¼ŒColinså­—å…¸è¿™ä¹ˆè§£é‡Š:The likelihood of something happening is how likely it is to happen. ä½ æŠŠlikelihoodæ¢æˆprobabilityï¼Œè¿™è§£é‡Šä¹Ÿè¯»å¾—é€šã€‚ä½†æ˜¯åœ¨ç»Ÿè®¡é‡Œé¢ï¼Œä¼¼ç„¶å‡½æ•°å’Œæ¦‚ç‡å‡½æ•°å´æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µ(å…¶å®ä¹Ÿå¾ˆç›¸è¿‘å°±æ˜¯äº†)ã€‚ å¯¹äºè¿™ä¸ªå‡½æ•°: $$P(x|\\theta)$$ è¾“å…¥æœ‰ä¸¤ä¸ª: $x$è¡¨ç¤ºæŸä¸€ä¸ªå…·ä½“çš„æ•°æ®ï¼›$\\theta$è¡¨ç¤ºæ¨¡å‹çš„å‚æ•°ã€‚ å¦‚æœ$\\theta$æ˜¯å·²çŸ¥ç¡®å®šçš„ï¼Œ$x$æ˜¯å˜é‡ï¼Œè¿™ä¸ªå‡½æ•°å«åšæ¦‚ç‡å‡½æ•°(probability function)ï¼Œå®ƒæè¿°å¯¹äºä¸åŒçš„æ ·æœ¬ç‚¹xï¼Œå…¶å‡ºç°æ¦‚ç‡æ˜¯å¤šå°‘ã€‚ å¦‚æœ$x$æ˜¯å·²çŸ¥ç¡®å®šçš„ï¼Œ$\\theta$æ˜¯å˜é‡ï¼Œè¿™ä¸ªå‡½æ•°å«åšä¼¼ç„¶å‡½æ•°(likelihood function), å®ƒæè¿°å¯¹äºä¸åŒçš„æ¨¡å‹å‚æ•°ï¼Œå‡ºç°$x$è¿™ä¸ªæ ·æœ¬ç‚¹çš„æ¦‚ç‡æ˜¯å¤šå°‘ã€‚ æœ€å¤§ä¼¼ç„¶ä¼°è®¡(MLE) å‡è®¾æœ‰ä¸€ä¸ªé€ å¸å‚ç”Ÿäº§æŸç§ç¡¬å¸ï¼Œç°åœ¨æˆ‘ä»¬æ‹¿åˆ°äº†ä¸€æšè¿™ç§ç¡¬å¸ï¼Œæƒ³è¯•è¯•è¿™ç¡¬å¸æ˜¯ä¸æ˜¯å‡åŒ€çš„ã€‚å³æƒ³çŸ¥é“æŠ›è¿™æšç¡¬å¸ï¼Œæ­£åé¢å‡ºç°çš„æ¦‚ç‡ï¼ˆè®°ä¸º$\\theta$ï¼‰å„æ˜¯å¤šå°‘ï¼Ÿ è¿™æ˜¯ä¸€ä¸ªç»Ÿè®¡é—®é¢˜ï¼Œå›æƒ³ä¸€ä¸‹ï¼Œè§£å†³ç»Ÿè®¡é—®é¢˜éœ€è¦ä»€ä¹ˆï¼Ÿ æ•°æ®ï¼ äºæ˜¯æˆ‘ä»¬æ‹¿è¿™æšç¡¬å¸æŠ›äº†10æ¬¡ï¼Œå¾—åˆ°çš„æ•°æ®($x_0$)æ˜¯ï¼šåæ­£æ­£æ­£æ­£åæ­£æ­£æ­£åã€‚æˆ‘ä»¬æƒ³æ±‚çš„æ­£é¢æ¦‚ç‡$\\theta$æ˜¯æ¨¡å‹å‚æ•°ï¼Œè€ŒæŠ›ç¡¬å¸æ¨¡å‹æˆ‘ä»¬å¯ä»¥å‡è®¾æ˜¯äºŒé¡¹åˆ†å¸ƒã€‚ é‚£ä¹ˆï¼Œå‡ºç°å®éªŒç»“æœ$x_0$(å³åæ­£æ­£æ­£æ­£åæ­£æ­£æ­£å)çš„ä¼¼ç„¶å‡½æ•°æ˜¯å¤šå°‘å‘¢ï¼Ÿ $$f(x_0 ,\\theta) = (1-\\theta)\\times\\theta\\times\\theta\\times\\theta\\times\\theta\\times(1-\\theta)\\times\\theta\\times\\theta\\times\\theta\\times(1-\\theta) = \\theta ^ 7(1 - \\theta)^3 = f(\\theta)$$ â€‹ æ³¨æ„ï¼Œè¿™æ˜¯ä¸ªåªå…³äº$\\theta$çš„å‡½æ•°ã€‚è€Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è¦æœ€å¤§åŒ–è¿™ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç”»å‡º$f(\\theta)$çš„å›¾åƒï¼š å¯ä»¥çœ‹å‡ºï¼Œåœ¨$\\theta = 0.7$æ—¶ï¼Œä¼¼ç„¶å‡½æ•°å–å¾—æœ€å¤§å€¼ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†å¯¹$\\theta$çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚å³ï¼ŒæŠ›10æ¬¡ç¡¬å¸ï¼Œå‘ç°7æ¬¡ç¡¬å¸æ­£é¢å‘ä¸Šï¼Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡è®¤ä¸ºæ­£é¢å‘ä¸Šçš„æ¦‚ç‡æ˜¯0.7ã€‚ï¼ˆummmâ€¦è¿™éå¸¸ç›´è§‚åˆç†ï¼Œå¯¹å§ï¼Ÿï¼‰ ä¸”æ…¢ï¼Œä¸€äº›äººå¯èƒ½ä¼šè¯´ï¼Œç¡¬å¸ä¸€èˆ¬éƒ½æ˜¯å‡åŒ€çš„å•Šï¼ å°±ç®—ä½ åšå®éªŒå‘ç°ç»“æœæ˜¯â€œåæ­£æ­£æ­£æ­£åæ­£æ­£æ­£åâ€ï¼Œæˆ‘ä¹Ÿä¸ä¿¡$\\theta = 0.7$ã€‚ è¿™é‡Œå°±åŒ…å«äº†è´å¶æ–¯å­¦æ´¾çš„æ€æƒ³äº†â€”â€”è¦è€ƒè™‘å…ˆéªŒæ¦‚ç‡ã€‚ ä¸ºæ­¤ï¼Œå¼•å…¥äº†æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡ã€‚ æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡(MAP) æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ˜¯æ±‚å‚æ•°$\\theta$, ä½¿ä¼¼ç„¶å‡½æ•°$P(x_0 | \\theta)$æœ€ å¤§ ã€‚ æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡åˆ™æ˜¯æƒ³æ±‚$\\theta$ä½¿$P(x_0|\\theta)$ æœ€å¤§ã€‚æ±‚å¾—çš„$\\theta$ä¸å•å•è®©ä¼¼ç„¶å‡½æ•°å¤§ï¼Œä¸å•å•è®©ä¼¼ç„¶å‡½æ•°å¤§ï¼Œ$\\theta$è‡ªå·±å‡ºç°çš„å…ˆéªŒæ¦‚ç‡ä¹Ÿå¾—å¤§ã€‚(è¿™æœ‰ç‚¹åƒæ­£åˆ™åŒ–é‡ŒåŠ æƒ©ç½šé¡¹çš„æ€æƒ³ï¼Œä¸è¿‡æ­£åˆ™åŒ–é‡Œæ˜¯åˆ©ç”¨åŠ æ³•ï¼Œè€ŒMAPé‡Œæ˜¯åˆ©ç”¨ä¹˜æ³•). MAPå…¶å®æ˜¯åœ¨æœ€å¤§åŒ–$P(\\theta|x_0) = \\frac{P(x_0|\\theta)P(\\theta)}{P(x_0)}$ï¼Œä¸è¿‡å› ä¸º$x_0$æ˜¯ç¡®å®šçš„(å³æŠ•å‡ºçš„â€œåæ­£æ­£æ­£æ­£åæ­£æ­£æ­£åâ€)ï¼Œ$P(x_0)$æ˜¯ä¸€ä¸ªå·²çŸ¥å€¼ï¼Œæ‰€ä»¥å»æ‰äº†åˆ†æ¯$P(x_0)$(å‡è®¾â€œæŠ•10æ¬¡ç¡¬å¸â€æ˜¯ä¸€æ¬¡å®éªŒï¼Œå®éªŒåšäº†1000æ¬¡ï¼Œâ€œåæ­£æ­£æ­£æ­£åæ­£æ­£æ­£åâ€å‡ºç°äº†næ¬¡ï¼Œåˆ™$P(x_0) = n/1000$)ã€‚æ€»ä¹‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥ç”±æ•°æ®é›†å¾—åˆ°çš„å€¼ï¼‰ã€‚æœ€å¤§åŒ–$P(\\theta | x_0)$çš„æ„ä¹‰ä¹Ÿå¾ˆæ˜ç¡®ï¼Œ$x_0$å·²ç»å‡ºç°äº†ï¼Œè¦æ±‚$\\theta$å–ä»€ä¹ˆå€¼ä½¿$P(\\theta | x_0)$æœ€å¤§ã€‚é¡ºå¸¦ä¸€æï¼Œ$P(\\theta | x_0)$, â€‹å³åéªŒæ¦‚ç‡ï¼Œè¿™å°±æ˜¯â€œæœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡â€åå­—çš„ç”±æ¥ã€‚ å¯¹äºæŠ•ç¡¬å¸çš„ä¾‹å­æ¥çœ‹ï¼Œæˆ‘ä»¬è®¤ä¸ºï¼ˆâ€å…ˆéªŒåœ°çŸ¥é“â€œ$\\theta$å–0.5çš„æ¦‚ç‡å¾ˆå¤§ï¼Œå–å…¶ä»–å€¼çš„æ¦‚ç‡å°ä¸€äº›ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒæ¥å…·ä½“æè¿°æˆ‘ä»¬æŒæ¡çš„è¿™ä¸ªå…ˆéªŒçŸ¥è¯†ï¼Œä¾‹å¦‚å‡è®¾$P(\\theta)$ä¸ºå‡å€¼0.5ï¼Œæ–¹å·®0.1çš„é«˜æ–¯å‡½æ•°ï¼Œå¦‚ä¸‹å›¾ï¼š åˆ™$P(x_0 | \\theta)$çš„å‡½æ•°å›¾åƒä¸ºï¼š æ³¨æ„ï¼Œæ­¤æ—¶å‡½æ•°å–æœ€å¤§å€¼æ—¶ï¼ŒÎ¸ \\thetaÎ¸å–å€¼å·²å‘å·¦åç§»ï¼Œä¸å†æ˜¯0.7ã€‚å®é™…ä¸Šï¼Œåœ¨$\\theta = 0.558$æ—¶å‡½æ•°å–å¾—äº†æœ€å¤§å€¼ã€‚å³ï¼Œç”¨æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡ï¼Œå¾—åˆ°$\\theta = 0.558$ æœ€åï¼Œé‚£è¦æ€æ ·æ‰èƒ½è¯´æœä¸€ä¸ªè´å¶æ–¯æ´¾ç›¸ä¿¡$\\theta = 0.7$å‘¢ï¼Ÿä½ å¾—å¤šåšç‚¹å®éªŒã€‚ã€‚ å¦‚æœåšäº†1000æ¬¡å®éªŒï¼Œå…¶ä¸­700æ¬¡éƒ½æ˜¯æ­£é¢å‘ä¸Šï¼Œè¿™æ—¶ä¼¼ç„¶å‡½æ•°ä¸º: å¦‚æœä»ç„¶å‡","date":"2023-07-16","objectID":"/posts/mleandmap/:0:0","tags":["MLE"],"title":"è¯¦è§£æœ€å¤§ä¼¼ç„¶ä¼°è®¡(MLE)ã€æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡(MAP)ï¼Œä»¥åŠè´å¶æ–¯å…¬å¼çš„ç†è§£","uri":"/posts/mleandmap/"},{"categories":["Memo"],"content":"Linuxç³»ç»Ÿå„ç³»ç»Ÿæ–‡ä»¶å¤¹ä¸‹çš„åŒºåˆ« é¦–å…ˆï¼Œusr æŒ‡ Unix System Resourceï¼Œè€Œä¸æ˜¯Userã€‚ é€šå¸¸ï¼Œ /usr/binä¸‹é¢çš„éƒ½æ˜¯ç³»ç»Ÿé¢„è£…çš„å¯æ‰§è¡Œç¨‹åºï¼Œä¼šéšç€ç³»ç»Ÿå‡çº§è€Œæ”¹å˜ã€‚ /usr/local/binç›®å½•æ˜¯ç»™ç”¨æˆ·æ”¾ç½®è‡ªå·±çš„å¯æ‰§è¡Œç¨‹åºçš„åœ°æ–¹ï¼Œæ¨èæ”¾åœ¨è¿™é‡Œï¼Œä¸ä¼šè¢«ç³»ç»Ÿå‡çº§è€Œè¦†ç›–åŒåæ–‡ä»¶ã€‚ å¦‚æœä¸¤ä¸ªç›®å½•ä¸‹æœ‰ç›¸åŒçš„å¯æ‰§è¡Œç¨‹åºï¼Œè°ä¼˜å…ˆæ‰§è¡Œå—åˆ°PATHç¯å¢ƒå˜é‡çš„å½±å“ï¼Œæ¯”å¦‚æˆ‘çš„ä¸€å°æœåŠ¡å™¨çš„PATHå˜é‡ä¸ºã€‚ echo $PATH è¿™é‡Œ/usr/local/binä¼˜å…ˆäº/usr/bin, ä¸€èˆ¬éƒ½æ˜¯å¦‚æ­¤ã€‚ /libæ˜¯å†…æ ¸çº§çš„, /usr/libæ˜¯ç³»ç»Ÿçº§çš„, /usr/local/libæ˜¯ç”¨æˆ·çº§çš„. / - å¯¹ä½ çš„ç”µè„‘æ¥è¯´, æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ ¹ç›®å½•ã€‚æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯ä»è¿™é‡Œå¼€å§‹ã€‚ä¸¾ä¸ªä¾‹å­: å½“ä½ åœ¨ç»ˆç«¯é‡Œè¾“å…¥\"/home\"ï¼Œä½ å…¶å®æ˜¯åœ¨å‘Šè¯‰ç”µè„‘ï¼Œå…ˆä»/(æ ¹ç›®å½•)å¼€å§‹ï¼Œå†è¿›å…¥åˆ°homeç›®å½•ã€‚ /lib/ â€” åŒ…å«è®¸å¤šè¢«/bin/å’Œ/sbin/ä¸­çš„ç¨‹åºä½¿ç”¨çš„åº“æ–‡ä»¶ã€‚ç›®å½•/usr/lib/ä¸­å«æœ‰æ›´å¤šç”¨äºç”¨æˆ·ç¨‹åºçš„åº“æ–‡ä»¶ã€‚/libç›®å½•ä¸‹æ”¾ç½®çš„æ˜¯/binå’Œ/sbinç›®å½•ä¸‹ç¨‹åºæ‰€éœ€çš„åº“æ–‡ä»¶ã€‚/libç›®å½•ä¸‹çš„æ–‡ä»¶çš„åç§°éµå¾ªä¸‹é¢çš„æ ¼å¼ï¼š libc.so.* ld* ä»…ä»…è¢«/usrç›®å½•ä¸‹çš„ç¨‹åºæ‰€ä½¿ç”¨çš„å…±äº«åº“ä¸å¿…æ”¾åˆ°/libç›®å½•ä¸‹ã€‚åªæœ‰/binå’Œ/sbinä¸‹çš„ç¨‹åºæ‰€éœ€è¦çš„åº“æœ‰å¿…è¦æ”¾åˆ°/libç›®å½•ä¸‹ã€‚å®é™…ä¸Šï¼Œlibm.so.*ç±»å‹çš„åº“æ–‡ä»¶å¦‚æœè¢«æ˜¯/binå’Œ/sbinæ‰€éœ€è¦çš„ï¼Œä¹Ÿå¯ä»¥æ”¾åˆ°/usr/libä¸‹ã€‚ /bin/ â€” ç”¨æ¥è´®å­˜ç”¨æˆ·å‘½ä»¤ã€‚ç›®å½• /usr/bin ä¹Ÿè¢«ç”¨æ¥è´®å­˜ç”¨æˆ·å‘½ä»¤ã€‚ /sbin/ â€” è®¸å¤šç³»ç»Ÿå‘½ä»¤(ä¾‹å¦‚ shutdown)çš„è´®å­˜ä½ç½®ã€‚ç›®å½•/usr/sbinä¸­ä¹ŸåŒ…æ‹¬äº†è®¸å¤šç³»ç»Ÿå‘½ä»¤ã€‚ /root/ â€” æ ¹ç”¨æˆ·(è¶…çº§ç”¨æˆ·)çš„ä¸»ç›®å½•ã€‚ /mnt/ â€” è¯¥ç›®å½•ä¸­é€šå¸¸åŒ…æ‹¬ç³»ç»Ÿå¼•å¯¼åè¢«æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ç‚¹ã€‚è­¬å¦‚ï¼Œé»˜è®¤çš„å…‰ç›˜æŒ‚è½½ç‚¹æ˜¯/mnt/cdrom/. /boot/ â€” åŒ…æ‹¬å†…æ ¸å’Œå…¶å®ƒç³»ç»Ÿå¯åŠ¨æœŸé—´ä½¿ç”¨çš„æ–‡ä»¶ã€‚ /lost+found/ â€” è¢«fsckç”¨æ¥æ”¾ç½®é›¶æ•£æ–‡ä»¶(æ²¡æœ‰åç§°çš„æ–‡ä»¶)ã€‚ /lib/ â€” åŒ…å«è®¸å¤šè¢«/bin/å’Œ/sbin/ä¸­çš„ç¨‹åºä½¿ç”¨çš„åº“æ–‡ä»¶ã€‚ç›®å½•/usr/lib/ä¸­å«æœ‰æ›´å¤šç”¨äºç”¨æˆ·ç¨‹åºçš„åº“æ–‡ä»¶ã€‚ /dev/ â€” è´®å­˜è®¾å¤‡æ–‡ä»¶ã€‚ /etc/ â€” åŒ…å«è®¸å¤šé…ç½®æ–‡ä»¶å’Œç›®å½•ã€‚ç³»ç»Ÿä¸»è¦çš„è®¾å®šæ¡£å‡ ä¹éƒ½æ”¾ç½®åœ¨è¿™ä¸ªç›®å½•å†…ï¼Œä¾‹å¦‚äººå‘˜çš„å¸å·å¯†ç æ¡£ã€å„ç§æœåŠ¡çš„å¯å§‹æ¡£ç­‰ç­‰ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„å„æ¡£æ¡ˆå±æ€§æ˜¯å¯ä»¥è®©ä¸€èˆ¬ä½¿ç”¨è€…æŸ¥é˜…çš„ï¼Œä½†æ˜¯åªæœ‰rootæœ‰æƒåŠ›ä¿®æ”¹ã€‚ /var/ â€” ç”¨äºè´®å­˜variable(æˆ–ä¸æ–­æ”¹å˜çš„)æ–‡ä»¶ï¼Œä¾‹å¦‚æ—¥å¿—æ–‡ä»¶å’Œæ‰“å°æœºå‡è„±æœºæ–‡ä»¶ã€‚ /usr/ â€” åŒ…æ‹¬ä¸ç³»ç»Ÿç”¨æˆ·ç›´æ¥æœ‰å…³çš„æ–‡ä»¶å’Œç›®å½•ï¼Œä¾‹å¦‚åº”ç”¨ç¨‹åºåŠæ”¯æŒå®ƒä»¬çš„åº“æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œä½ å¯ä»¥æ‰¾åˆ°é‚£äº›ä¸é€‚åˆæ”¾åœ¨/binæˆ–/etcç›®å½•ä¸‹çš„é¢å¤–çš„å·¥å…·ã€‚æ¯”å¦‚åƒæ¸¸æˆé˜¿ï¼Œä¸€äº›æ‰“å°å·¥å…·æ‹‰ç­‰ç­‰ã€‚/usrç›®å½•åŒ…å«äº†è®¸å¤šå­ç›®å½•ï¼š /usr/binç›®å½•ç”¨äºå­˜æ”¾ç¨‹åº; /usr/shareç”¨äºå­˜æ”¾ä¸€äº›å…±äº«çš„æ•°æ®ï¼Œæ¯”å¦‚éŸ³ä¹æ–‡ä»¶æˆ–è€…å›¾æ ‡ç­‰ç­‰;/usr/libç›®å½•ç”¨äºå­˜æ”¾é‚£äº›ä¸èƒ½ç›´æ¥è¿è¡Œçš„ï¼Œä½†å´æ˜¯è®¸å¤šç¨‹åºè¿è¡Œæ‰€å¿…éœ€çš„ä¸€äº›å‡½æ•°åº“æ–‡ä»¶ã€‚ /proc/ â€” ä¸€ä¸ªè™šæ‹Ÿçš„æ–‡ä»¶ç³»ç»Ÿ(ä¸æ˜¯å®é™…è´®å­˜åœ¨ç£ç›˜ä¸Šçš„)ï¼Œå®ƒåŒ…æ‹¬è¢«æŸäº›ç¨‹åºä½¿ç”¨çš„ç³»ç»Ÿä¿¡æ¯ã€‚ /initrd/ â€” ç”¨æ¥åœ¨è®¡ç®—æœºå¯åŠ¨æ—¶æŒ‚è½½ initrd.img æ˜ åƒæ–‡ä»¶çš„ç›®å½•ä»¥åŠè½½å…¥æ‰€éœ€è®¾å¤‡æ¨¡å—çš„ç›®å½•ã€‚ è­¦å‘Š: ä¸è¦åˆ é™¤/initrd/ç›®å½•ã€‚å¦‚æœä½ åˆ é™¤äº†è¯¥ç›®å½•åå†é‡æ–°å¼•å¯¼Red Hat Linuxæ—¶ï¼Œä½ å°†æ— æ³•å¼•å¯¼ä½ çš„è®¡ç®—æœºã€‚ /tmp/ â€” ç”¨æˆ·å’Œç¨‹åºçš„ä¸´æ—¶ç›®å½•ã€‚/tmpç»™äºˆæ‰€æœ‰ç³»ç»Ÿç”¨æˆ·è¯»å†™æƒã€‚**è¿™æ˜¯è®©ä¸€èˆ¬ä½¿ç”¨è€…æˆ–è€…æ˜¯æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºæš‚æ—¶æ”¾ç½®æ¡£æ¡ˆçš„åœ°æ–¹ã€‚**è¿™ä¸ªç›®å½•æ˜¯ä»»ä½•äººéƒ½èƒ½å¤Ÿå­˜å–çš„ï¼Œæ‰€ä»¥ä½ éœ€è¦å®šæœŸçš„æ¸…ç†ä¸€ä¸‹ã€‚å½“ç„¶ï¼Œé‡è¦èµ„æ–™ä¸å¯æ”¾ç½®åœ¨æ­¤ç›®å½•å•Šã€‚ å› ä¸ºFHSç”šè‡³å»ºè®®åœ¨å¼€æœºæ—¶ï¼Œåº”è¯¥è¦å°†/tmpä¸‹çš„èµ„æ–™éƒ½åˆ é™¤ã€‚ /home/ â€” ç”¨æˆ·ä¸»ç›®å½•çš„é»˜è®¤ä½ç½®ã€‚ /opt/ â€” å¯é€‰æ–‡ä»¶å’Œç¨‹åºçš„è´®å­˜ç›®å½•ã€‚è¯¥ç›®å½•ä¸»è¦è¢«ç¬¬ä¸‰æ–¹å¼€å‘è€…ç”¨æ¥ç®€æ˜“åœ°å®‰è£…å’Œå¸è£…ä»–ä»¬çš„è½¯ä»¶åŒ…ã€‚è¿™é‡Œä¸»è¦å­˜æ”¾é‚£äº›å¯é€‰çš„ç¨‹åºã€‚ä½ æƒ³å°è¯•æœ€æ–°çš„firefoxæµ‹è¯•ç‰ˆå—?é‚£å°±è£…åˆ°/optç›®å½•ä¸‹å§ï¼Œè¿™æ ·ï¼Œå½“ä½ å°è¯•å®Œï¼Œæƒ³åˆ æ‰firefoxçš„æ—¶å€™ï¼Œä½ å°±å¯ ä»¥ç›´æ¥åˆ é™¤å®ƒï¼Œè€Œä¸å½±å“ç³»ç»Ÿå…¶ä»–ä»»ä½•è®¾ç½®ã€‚å®‰è£…åˆ°/optç›®å½•ä¸‹çš„ç¨‹åºï¼Œå®ƒæ‰€æœ‰çš„æ•°æ®ã€åº“æ–‡ä»¶ç­‰ç­‰éƒ½æ˜¯æ”¾åœ¨åŒä¸ªç›®å½•ä¸‹é¢ã€‚ /usr/local/ - è¿™é‡Œä¸»è¦å­˜æ”¾é‚£äº›æ‰‹åŠ¨å®‰è£…çš„è½¯ä»¶ï¼Œå³aptæˆ–è€…apt-getå®‰è£…çš„è½¯ä»¶ã€‚å®ƒå’Œ/usrç›®å½•å…·æœ‰ç›¸ç±»ä¼¼çš„ç›®å½•ç»“æ„ã€‚è®©è½¯ä»¶åŒ…ç®¡ç†å™¨æ¥ç®¡ç†/usrç›®å½•ï¼Œè€ŒæŠŠè‡ªå®šä¹‰çš„è„šæœ¬(scripts)æ”¾åˆ°/usr/localç›®å½•ä¸‹é¢ï¼Œæˆ‘æƒ³è¿™åº”è¯¥æ˜¯ä¸ªä¸é”™çš„ä¸»æ„ã€‚ /media/ - æœ‰äº›linuxçš„å‘è¡Œç‰ˆä½¿ç”¨è¿™ä¸ªç›®å½•æ¥æŒ‚è½½é‚£äº›usbæ¥å£çš„ç§»åŠ¨ç¡¬ç›˜(åŒ…æ‹¬Uç›˜)ã€CD/DVDé©±åŠ¨å™¨ç­‰ç­‰ã€‚ ","date":"2023-07-16","objectID":"/posts/filesystem/:0:0","tags":["Linux"],"title":"Linux Filesystem","uri":"/posts/filesystem/"},{"categories":["Memo"],"content":"/usr/local/ å’Œ /usr/share/ åŒºåˆ« /usr/local - è¿™ä¸ªç›®å½•ä¸€èˆ¬æ˜¯ç”¨æ¥å­˜æ”¾ç”¨æˆ·è‡ªç¼–è¯‘å®‰è£…è½¯ä»¶çš„å­˜æ”¾ç›®å½•; ä¸€èˆ¬æ˜¯é€šè¿‡æºç åŒ…å®‰è£…çš„è½¯ä»¶ï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡å®šå®‰è£…ç›®å½•çš„è¯ï¼Œä¸€èˆ¬æ˜¯å®‰è£…åœ¨è¿™ä¸ªç›®å½•ä¸­ã€‚è¿™ä¸ªç›®å½•ä¸‹é¢æœ‰å­ç›®å½•ã€‚ /usr/share - ç³»ç»Ÿå…±ç”¨çš„ä¸œè¥¿å­˜æ”¾åœ°ï¼Œæ¯”å¦‚/usr/share/fontsæ˜¯å­—ä½“ç›®å½•ï¼Œ/usr/share/docå’Œ/usr/share/manå¸®åŠ©æ–‡ä»¶ã€‚ /var/log - ç³»ç»Ÿæ—¥å¿—å­˜æ”¾ï¼Œåˆ†ææ—¥å¿—è¦çœ‹è¿™ä¸ªç›®å½•çš„ä¸œè¥¿; /var/spool - æ‰“å°æœºã€é‚®ä»¶ã€ä»£ç†æœåŠ¡å™¨ç­‰è„±æœºç›®å½•ã€‚ Linux Command Notes ","date":"2023-07-16","objectID":"/posts/filesystem/:1:0","tags":["Linux"],"title":"Linux Filesystem","uri":"/posts/filesystem/"},{"categories":["Memo"],"content":"æŸ¥æ‰¾æ–‡ä»¶çš„å‘½ä»¤:find/locate/whereis/which/type/grep ","date":"2023-07-16","objectID":"/posts/filesystem/:2:0","tags":["Linux"],"title":"Linux Filesystem","uri":"/posts/filesystem/"},{"categories":["Memo"],"content":"find findå‘½ä»¤å‡†ç¡®ï¼Œä½†é€Ÿåº¦éå¸¸æ…¢ï¼Œå®ƒå¯ä»¥æŸ¥æ‰¾ä»»ä½•ç±»å‹çš„æ–‡ä»¶ ä½¿ç”¨æ ¼å¼ find [æŒ‡å®šç›®å½•] [æŒ‡å®šæ¡ä»¶] [æŒ‡å®šåŠ¨ä½œ] å‚æ•°è¯´æ˜: [æŒ‡å®šç›®å½•]ï¼š æ‰€è¦æœç´¢çš„ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚é»˜è®¤ä¸ºå½“å‰ç›®å½• [æŒ‡å®šæ¡ä»¶]ï¼š æ‰€è¦æœç´¢çš„æ–‡ä»¶çš„ç‰¹å¾ -nameï¼šæŒ‰æ–‡ä»¶åæ¥æŸ¥æ‰¾æ–‡ä»¶ -userï¼šæŒ‰ç…§æ–‡ä»¶çš„å±ä¸»æ¥æŸ¥æ‰¾æ–‡ä»¶ -groupï¼šæŒ‰ç…§æ–‡ä»¶æ‰€å±çš„ç»„æ¥æŸ¥æ‰¾æ–‡ä»¶ -permï¼šæŒ‰ç…§æ–‡ä»¶æƒé™æ¥æŸ¥æ‰¾æ–‡ä»¶ -pruneï¼šä¸åœ¨å½“å‰æŒ‡å®šç›®å½•ä¸­æŸ¥æ‰¾ [æŒ‡å®šåŠ¨ä½œ]ï¼š å¯¹æœç´¢ç»“æœè¿›è¡Œç‰¹å®šçš„å¤„ç† -printï¼šå°†åŒ¹é…çš„æ–‡ä»¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º -execï¼šå¯¹åŒ¹é…çš„æ–‡ä»¶æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ -okï¼šå’Œ-execçš„ä½œç”¨ç›¸åŒï¼Œåœ¨æ‰§è¡Œæ¯ä¸€ä¸ªå‘½ä»¤ä¹‹å‰ï¼Œè®©ç”¨æˆ·æ¥ç¡®å®šæ˜¯å¦æ‰§è¡Œ findå‘½ä»¤ä¸åŠ ä»»ä½•å‚æ•°æ—¶ï¼Œè¡¨ç¤ºæœç´¢è·¯å¾„ä¸ºå½“å‰ç›®å½•åŠå…¶å­ç›®å½•ï¼Œé»˜è®¤çš„åŠ¨ä½œä¸º-printï¼Œå³ä¸è¿‡æ»¤ä»»ä½•ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´è¾“å‡ºæ‰€æœ‰çš„æ–‡ä»¶ ä½¿ç”¨ç¤ºä¾‹: - é€’å½’æœç´¢å½“å‰ç›®å½•ä¸­ï¼Œæ‰€æœ‰ä»¥fileå¼€å¤´çš„æ–‡ä»¶ shell find . -name 'file*' - é€’å½’æœç´¢å½“å‰ç›®å½•ä¸­ï¼Œæ‰€æœ‰ä»¥fileå¼€å¤´çš„æ–‡ä»¶ï¼Œå¹¶æ˜¾ç¤ºå®ƒä»¬çš„è¯¦ç»†ä¿¡æ¯ shell find . -name 'file*' -ls ","date":"2023-07-16","objectID":"/posts/filesystem/:2:1","tags":["Linux"],"title":"Linux Filesystem","uri":"/posts/filesystem/"},{"categories":["Memo"],"content":"locate locateå‘½ä»¤å¯ä»¥è¯´æ˜¯find -nameçš„å¦ä¸€ç§å†™æ³•ï¼Œä½†æ˜¯è¦æ¯”åè€…å¿«å¾—å¤šï¼ŒåŸå› åœ¨äºå®ƒä¸æœç´¢å…·ä½“ç›®å½•ï¼Œè€Œæ˜¯æœç´¢ä¸€ä¸ªæ•°æ®åº“/var/lib/locatedbï¼Œè¿™ä¸ªæ•°æ®åº“ä¸­å«æœ‰æœ¬åœ°æ‰€æœ‰æ–‡ä»¶ä¿¡æ¯. Linuxè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªæ•°æ®åº“ï¼Œå¹¶ä¸”æ¯å¤©è‡ªåŠ¨æ›´æ–°ä¸€æ¬¡ï¼Œæ‰€ä»¥ä½¿ç”¨locateå‘½ä»¤æŸ¥ä¸åˆ°æœ€æ–°å˜åŠ¨è¿‡çš„æ–‡ä»¶ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥åœ¨ä½¿ç”¨locateä¹‹å‰ï¼Œå…ˆä½¿ç”¨updatedbå‘½ä»¤ï¼Œæ‰‹åŠ¨æ›´æ–°æ•°æ®åº“. ä½¿ç”¨æ ¼å¼: locate [å‚æ•°] \u003cæ–‡ä»¶å\u003e ä½¿ç”¨ç¤ºä¾‹: æœç´¢etcç›®å½•ä¸‹æ‰€æœ‰ä»¥fileå¼€å¤´çš„æ–‡ä»¶ locate /etc/file æœç´¢ç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼Œæ‰€æœ‰ä»¥få¼€å¤´çš„æ–‡ä»¶ï¼Œå¹¶ä¸”å¿½ç•¥å¤§å°å†™ locate -i ~/f ","date":"2023-07-16","objectID":"/posts/filesystem/:2:2","tags":["Linux"],"title":"Linux Filesystem","uri":"/posts/filesystem/"},{"categories":["Memo"],"content":"whereis whereiså‘½ä»¤åªèƒ½æœç´¢ç‰¹å®šæ ¼å¼çš„æ–‡ä»¶ ä½¿ç”¨æ ¼å¼ whereis [å‚æ•°] \u003cæ–‡ä»¶å\u003e å¯æœç´¢æ–‡é›†ç±»å‹ äºŒè¿›åˆ¶æ–‡ä»¶(-b) æºä»£ç æ–‡ä»¶(-s) è¯´æ˜æ–‡ä»¶(-m) å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰ä¿¡æ¯ ä½¿ç”¨ç¤ºä¾‹: æ‰¾å‡ºåä¸ºfindçš„æ–‡ä»¶ä½ç½® whereis find ","date":"2023-07-16","objectID":"/posts/filesystem/:2:3","tags":["Linux"],"title":"Linux Filesystem","uri":"/posts/filesystem/"},{"categories":["Memo"],"content":"which whichå‘½ä»¤çš„ä½œç”¨æ˜¯ï¼Œåœ¨PATHå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­ï¼Œæœç´¢æŸä¸ªç³»ç»Ÿå‘½ä»¤çš„ä½ç½®ï¼Œå¹¶ä¸”è¿”å›ç¬¬ä¸€ä¸ªæœç´¢ç»“æœ, ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨whichå‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°æŸä¸ªç³»ç»Ÿå‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ‰§è¡Œçš„åˆ°åº•æ˜¯å“ªä¸€ä¸ªä½ç½®çš„å‘½ä»¤ã€‚ ä½¿ç”¨æ ¼å¼ which \u003cå‘½ä»¤\u003e ä½¿ç”¨å®ä¾‹: æŸ¥æ‰¾findå‘½ä»¤çš„ä½ç½® which find ","date":"2023-07-16","objectID":"/posts/filesystem/:2:4","tags":["Linux"],"title":"Linux Filesystem","uri":"/posts/filesystem/"},{"categories":["Memo"],"content":"type typeå‘½ä»¤å…¶å®ä¸èƒ½ç®—æŸ¥æ‰¾å‘½ä»¤ï¼Œå®ƒæ˜¯ç”¨æ¥åŒºåˆ†æŸä¸ªå‘½ä»¤åˆ°åº•æ˜¯ç”±shellè‡ªå¸¦çš„ï¼Œè¿˜æ˜¯ç”±shellå¤–éƒ¨çš„ç‹¬ç«‹äºŒè¿›åˆ¶æ–‡ä»¶æä¾›çš„; å¦‚æœä¸€ä¸ªå‘½ä»¤æ˜¯å¤–éƒ¨å‘½ä»¤ï¼Œé‚£ä¹ˆä½¿ç”¨-på‚æ•°ï¼Œä¼šæ˜¾ç¤ºè¯¥å‘½ä»¤çš„è·¯å¾„ï¼Œç›¸å½“äºwhichå‘½ä»¤ã€‚ ä½¿ç”¨æ ¼å¼ type \u003cå‘½ä»¤\u003e ä½¿ç”¨å®ä¾‹: æŸ¥çœ‹cdå‘½ä»¤æ˜¯å¦ä¸ºshellè‡ªå¸¦çš„å‘½ä»¤ type cd æŸ¥çœ‹grepæ˜¯å¦ä¸ºå¤–éƒ¨å‘½ä»¤ type grep ","date":"2023-07-16","objectID":"/posts/filesystem/:2:5","tags":["Linux"],"title":"Linux Filesystem","uri":"/posts/filesystem/"},{"categories":["Memo"],"content":"grep grepå‘½ä»¤ç”¨äºæŸ¥æ‰¾æ‹¥æœ‰ç‰¹æ®Šå­—æ®µçš„æ–‡ä»¶ã€‚ è¯­æ³• grep [-abcEFGhHilLnqrsvVwxy][-A\u003cæ˜¾ç¤ºè¡Œæ•°\u003e][-B\u003cæ˜¾ç¤ºåˆ—æ•°\u003e][-C\u003cæ˜¾ç¤ºåˆ—æ•°\u003e][-d\u003cè¿›è¡ŒåŠ¨ä½œ\u003e][-e\u003cèŒƒæœ¬æ ·å¼\u003e][-f\u003cèŒƒæœ¬æ–‡ä»¶\u003e][--help][èŒƒæœ¬æ ·å¼][æ–‡ä»¶æˆ–ç›®å½•...] å‚æ•°: -a æˆ– â€“text : ä¸è¦å¿½ç•¥äºŒè¿›åˆ¶çš„æ•°æ®ã€‚ -A\u003cæ˜¾ç¤ºè¡Œæ•°\u003e æˆ– â€“after-context=\u003cæ˜¾ç¤ºè¡Œæ•°\u003e : é™¤äº†æ˜¾ç¤ºç¬¦åˆèŒƒæœ¬æ ·å¼çš„é‚£ä¸€åˆ—ä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹åçš„å†…å®¹ã€‚ -b æˆ– â€“byte-offset : åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œæ ‡ç¤ºå‡ºè¯¥è¡Œç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç¼–å·ã€‚ -B\u003cæ˜¾ç¤ºè¡Œæ•°\u003e æˆ– â€“before-context=\u003cæ˜¾ç¤ºè¡Œæ•°\u003e : é™¤äº†æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹å‰çš„å†…å®¹ã€‚ -c æˆ– â€“count : è®¡ç®—ç¬¦åˆæ ·å¼çš„åˆ—æ•°ã€‚ -C\u003cæ˜¾ç¤ºè¡Œæ•°\u003e æˆ– â€“context=\u003cæ˜¾ç¤ºè¡Œæ•°\u003eæˆ–-\u003cæ˜¾ç¤ºè¡Œæ•°\u003e : é™¤äº†æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹å‰åçš„å†…å®¹ã€‚ -d \u003cåŠ¨ä½œ\u003e æˆ– â€“directories=\u003cåŠ¨ä½œ\u003e : å½“æŒ‡å®šè¦æŸ¥æ‰¾çš„æ˜¯ç›®å½•è€Œéæ–‡ä»¶æ—¶ï¼Œå¿…é¡»ä½¿ç”¨è¿™é¡¹å‚æ•°ï¼Œå¦åˆ™grepæŒ‡ä»¤å°†å›æŠ¥ä¿¡æ¯å¹¶åœæ­¢åŠ¨ä½œã€‚ -e\u003cèŒƒæœ¬æ ·å¼\u003e æˆ– â€“regexp=\u003cèŒƒæœ¬æ ·å¼\u003e : æŒ‡å®šå­—ç¬¦ä¸²åšä¸ºæŸ¥æ‰¾æ–‡ä»¶å†…å®¹çš„æ ·å¼ã€‚ -E æˆ– â€“extended-regexp : å°†æ ·å¼ä¸ºå»¶ä¼¸çš„æ­£åˆ™è¡¨è¾¾å¼æ¥ä½¿ç”¨ã€‚ -f\u003cè§„åˆ™æ–‡ä»¶\u003e æˆ– â€“file=\u003cè§„åˆ™æ–‡ä»¶\u003e : æŒ‡å®šè§„åˆ™æ–‡ä»¶ï¼Œå…¶å†…å®¹å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè§„åˆ™æ ·å¼ï¼Œè®©grepæŸ¥æ‰¾ç¬¦åˆè§„åˆ™æ¡ä»¶çš„æ–‡ä»¶å†…å®¹ï¼Œæ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªè§„åˆ™æ ·å¼ã€‚ -F æˆ– â€“fixed-regexp : å°†æ ·å¼è§†ä¸ºå›ºå®šå­—ç¬¦ä¸²çš„åˆ—è¡¨ã€‚ -G æˆ– â€“basic-regexp : å°†æ ·å¼è§†ä¸ºæ™®é€šçš„è¡¨ç¤ºæ³•æ¥ä½¿ç”¨ã€‚ -h æˆ– â€“no-filename : åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œä¸æ ‡ç¤ºè¯¥è¡Œæ‰€å±çš„æ–‡ä»¶åç§°ã€‚ -H æˆ– â€“with-filename : åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œè¡¨ç¤ºè¯¥è¡Œæ‰€å±çš„æ–‡ä»¶åç§°ã€‚ -i æˆ– â€“ignore-case : å¿½ç•¥å­—ç¬¦å¤§å°å†™çš„å·®åˆ«ã€‚ -l æˆ– â€“file-with-matches : åˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°ã€‚ -L æˆ– â€“files-without-match : åˆ—å‡ºæ–‡ä»¶å†…å®¹ä¸ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°ã€‚ -n æˆ– â€“line-number : åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œæ ‡ç¤ºå‡ºè¯¥è¡Œçš„åˆ—æ•°ç¼–å·ã€‚ -o æˆ– â€“only-matching : åªæ˜¾ç¤ºåŒ¹é…PATTERN éƒ¨åˆ†ã€‚ -q æˆ– â€“quietæˆ–â€“silent : ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚ -r æˆ– â€“recursive : æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š\"-d recurse\"å‚æ•°ç›¸åŒã€‚ -s æˆ– â€“no-messages : ä¸æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚ -v æˆ– â€“invert-match : æ˜¾ç¤ºä¸åŒ…å«åŒ¹é…æ–‡æœ¬çš„æ‰€æœ‰è¡Œã€‚ -V æˆ– â€“version : æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚ -w æˆ– â€“word-regexp : åªæ˜¾ç¤ºå…¨å­—ç¬¦åˆçš„åˆ—ã€‚ -x â€“line-regexp : åªæ˜¾ç¤ºå…¨åˆ—ç¬¦åˆçš„åˆ—ã€‚ -y : æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š\"-i\"å‚æ•°ç›¸åŒã€‚ ç¤ºä¾‹: # æŸ¥æ‰¾æŒ‡å®šç›®å½•/etc/acpi åŠå…¶å­ç›®å½•ï¼ˆå¦‚æœå­˜åœ¨å­ç›®å½•çš„è¯ï¼‰ä¸‹æ‰€æœ‰æ–‡ä»¶ä¸­åŒ…å«å­—ç¬¦ä¸²\"update\"çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²æ‰€åœ¨è¡Œçš„å†…å®¹ grep -r update /etc/acpi # æŸ¥çœ‹ç¬¦åˆæ¡ä»¶çš„æ—¥å¿—æ¡ç›®ã€‚ grep -n '2019-10-24 00:01:11' *.log # åªåŒ¹é…æ–‡æœ¬æ–‡ä»¶ï¼Œä¸åŒ¹é…äºŒè¿›åˆ¶æ–‡ä»¶çš„å‘½ä»¤ grep -srn \"parameter\" . --binary-files=without-match ","date":"2023-07-16","objectID":"/posts/filesystem/:2:6","tags":["Linux"],"title":"Linux Filesystem","uri":"/posts/filesystem/"},{"categories":["Memo"],"content":"VIM 8.2 å®‰è£… ","date":"2023-07-16","objectID":"/posts/vim_installation/:0:0","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"1. Install Python3.9 from source Update the packages list and install the packages necessary to build Python sudo apt update \u0026\u0026 sudo apt install build-essential zlib1g-dev libncurses5-dev libgdbm-dev libnss3-dev libssl-dev libreadline-dev libffi-dev libsqlite3-dev wget libbz2-dev Download the latest releaseâ€™s source code from the Python download page using wget wegt https://www.python.org/ftp/python/3.9.0/Python-3.9.1.tgz Switch to the Python source directory and execute the configure script which performs a number of checks to make sure all of the dependencies on your system are present cd Python-3.9.1 ./configure --enable-optimizations --with-lto --enable-shared --prefix=/usr/local/python39 make -j8 When the build process is complete, install the Python binaries by typing sudo make altinstall Do not use the standard make install as it will overwrite the default system python3 binary. copy the dynamic library to usr/lib/x86_64-linux-gnu/libpython3.9.so.1.0 sudo cp /usr/local/python39/lib/libpython3.9.so.1.0 /usr/lib/x86_64-linux-gnu/ the command can slove the error: error while loading shared libraries: libpython3.9.so.1.0: cannot open shared object file: No such file or directory make the soft link to set python39 as default python3 sudo ln -sf /usr/local/python39/bin/python3.9 /usr/bin/python3 sudo ln -s /usr/local/python39/bin/python3.9 /usr/bin/python3.9 using update-alternatives to switch different python version list all the python versions sudo update-alternatives --list python3 display python3 sudo update-alternatives --display python3 set different number for different version sudo update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.10 1 sudo update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.9 2 show different mode and select number to switch another mode sudo update-alternatives --config python3 ","date":"2023-07-16","objectID":"/posts/vim_installation/:1:0","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"2. æºç å®‰è£…cmake ","date":"2023-07-16","objectID":"/posts/vim_installation/:2:0","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"2.1 download the cmake source code download source code wget https://github.com/Kitware/CMake/releases/download/v3.23.1/cmake-3.23.1.tar.gz ","date":"2023-07-16","objectID":"/posts/vim_installation/:2:1","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"2.2 extract the source code directory and run the command to install extraction and configuration cd cmake-2.23.0 ./bootstrap //éœ€è¦çš„è¯ä¹Ÿå¯ä»¥æŒ‡å®šå®‰è£…ç›®å½•ï¼Œä¾‹å¦‚--prefix=/usr/local/cmake make \u0026\u0026 sudo make install ","date":"2023-07-16","objectID":"/posts/vim_installation/:2:2","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"2.3 create soft link and set cmake as default set cmake as default sudo ln -s /usr/local/bin/cmake /usr/bin/cmake ","date":"2023-07-16","objectID":"/posts/vim_installation/:2:3","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"3. é¦–å…ˆä»githubä¸‹è½½æºç vim 8.2 ","date":"2023-07-16","objectID":"/posts/vim_installation/:3:0","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"3.1 æºç å®‰è£…vim8.2 run the following command to downlaod source code of VIM from github git clone git clone https://github.com/vim/vim.git cd vim git pull cd src/ sudo make distclean # å¦‚æœæ‚¨ä»¥å‰æ„å»ºå›½vim cofigure the installation file ./configure --with-features=huge --enable-multibyte --enable-python3interp=dynamic --with-python3-config-dir=/usr/lib/python3.10/config-3.10-x86_64-linux-gnu/ --enable-cscope --enable-gui=auto --enable-gtk2-check --enable-fontset --enable-largefile --disable-netbeans --with-compiledby=\"18817571704@163.com\" --enable-fail-if-missing --prefix=/usr/local/vim82 sudo make sudo make install enable clipboard then you can copy the content from system clipboard to vim sudo apt-get install vim-gtk3 å¸è½½vim ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é‡ç½®ç¼–è¯‘æ“ä½œ sudo make distclean ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼Œå¯ä»¥å¸è½½å‘½ä»¤ sudo make uninstall ","date":"2023-07-16","objectID":"/posts/vim_installation/:3:1","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"3.2 å®‰è£…vim-plugä»¥åŠæ’ä»¶ å®‰è£…vim-plug: curl -fLo ~/.vim/autoload/plug.vim --create-dirs \\ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim å®‰è£…ä¸»é¢˜gruvbox to fix error: Cannot find color scheme â€˜gruvboxâ€™ mkdir ~/.vim/colors/ cp ~/.vim/plugged/gruvbox/gruvbox.vim ~/.vim/colors/ å®‰è£…YCM(YouCompleteMe) æ ¹æ®~/.vimrcæŒ‰è£…YCM cd ~/.vim/plugged/YouCompleteMe/ ./install.py --clang-completer å®‰è£…ctags sudo apt-get install exuberant-ctags å…¶ä»–ä¸»é¢˜ç›´æ¥ç¼–è¾‘:PlugInstallè¿›è¡Œå®‰è£… ","date":"2023-07-16","objectID":"/posts/vim_installation/:3:2","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"3.2 reference å‚è€ƒé“¾æ¥: [1] https://github.com/ycm-core/YouCompleteMe/wiki/Building-Vim-from-source [2] https://wizardforcel.gitbooks.io/use-vim-as-ide/content/0.html ","date":"2023-07-16","objectID":"/posts/vim_installation/:3:3","tags":["vim"],"title":"Vim Installation","uri":"/posts/vim_installation/"},{"categories":["Memo"],"content":"zshè¯´æ˜ zshæ˜¯ä¸€ä¸ªLinuxä¸‹å¼ºå¤§çš„shell, ç”±äºå¤§å¤šæ•°Linuxäº§å“å®‰è£…ä»¥åŠé»˜è®¤ä½¿ç”¨bash shell, ä½†æ˜¯ä¸æ¯«ä¸å½±å“æå®¢ä»¬å¯¹zshçš„çƒ­è¡·, å‡ ä¹æ¯ä¸€æ¬¾Linuxäº§å“éƒ½åŒ…å«æœ‰zshï¼Œé€šå¸¸å¯ä»¥ç”¨apt-getã€urpmiæˆ–yumç­‰åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…. zshæ˜¯bashçš„å¢å¼ºç‰ˆï¼Œå…¶å®zshå’Œbashæ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼Œzshæ›´åŠ å¼ºå¤§ã€‚ é€šå¸¸zshé…ç½®èµ·æ¥éå¸¸éº»çƒ¦ï¼Œä¸”ç›¸å½“çš„å¤æ‚ï¼Œæ‰€ä»¥oh-my-zshæ˜¯ä¸ºäº†ç®€åŒ–zshçš„é…ç½®è€Œå¼€å‘çš„ï¼Œå› æ­¤oh-my-zshç®—æ˜¯zshçš„é…ç½®. ","date":"2023-07-16","objectID":"/posts/zsh_installation/:1:0","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"å‡†å¤‡ æŸ¥çœ‹å½“å‰ç³»ç»Ÿç”¨shellç‰ˆæœ¬ echo $SHELL æŸ¥çœ‹ç³»ç»Ÿè‡ªå¸¦å“ªäº›shell cat /etc/shells ","date":"2023-07-16","objectID":"/posts/zsh_installation/:2:0","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"å®‰è£…zsh é€šè¿‡å‘½ä»¤è¡Œå®‰è£…zsh sudo apt install zsh ","date":"2023-07-16","objectID":"/posts/zsh_installation/:3:0","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"zshé…ç½® å°†zshè®¾ç½®ä¸ºé»˜è®¤çš„shell chsh -s /bin/zsh ç„¶åé‡å¯ç”µè„‘ reboot ","date":"2023-07-16","objectID":"/posts/zsh_installation/:4:0","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"å®‰è£…oh-my-zshåŠå…¶ä¸ªæ€§åŒ–é…ç½® ","date":"2023-07-16","objectID":"/posts/zsh_installation/:5:0","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"å®‰è£…oh-my-zsh æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…oh-my-zsh sh -c \"$(wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)\" æˆ–è€… sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\" ","date":"2023-07-16","objectID":"/posts/zsh_installation/:5:1","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"ä¸»é¢˜é…ç½® æ‰“å¼€é…ç½®æ–‡ä»¶~/.zshrc è¾“å…¥: ZSH_THEME=\"xxf\" xxf.zsh-themeæ–‡ä»¶ä¸‹è½½åœ°å€: xxf.zsh-themeæ–‡ä»¶ä¸‹è½½ ä¸‹è½½ä¹‹åå°†æ–‡ä»¶æ‹·è´åˆ°ä»¥ä¸‹è·¯å¾„: /home/username/.oh-my-zsh/themes/ ","date":"2023-07-16","objectID":"/posts/zsh_installation/:5:2","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"æ’ä»¶ å®‰è£…è‡ªåŠ¨è¡¥å…¨æ’ä»¶incr é¦–å…ˆï¼Œä¸‹è½½incræ’ä»¶åˆ°æœ¬åœ° cd ~/.oh-my-zsh/plugins/ mkdir incr \u0026\u0026 cd incr wget http://mimosa-pudica.net/src/incr-0.2.zsh ç¼–è¾‘~/.zshrcæ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹: source ~/.oh-my-zsh/plugins/incr/incr*.zsh ç„¶åï¼Œsourceä¸€ä¸‹: source ~/.zshrc ç›´æ¥ä½¿ç”¨é»˜è®¤æ’ä»¶ åœ¨~/.zshrcæ–‡ä»¶ä¸­æ·»åŠ æ’ä»¶: plugins=(git extract z) å®‰è£…autojumpæ’ä»¶ é€šè¿‡å‘½ä»¤è¡Œå®‰è£…autojump sudo apt install autojump åœ¨~/.zshrcæ–‡ä»¶ä¸­ç¼–è¾‘: . /usr/share/autojump/autojump.sh ç„¶åï¼Œsourceä¸€ä¸‹: source ~/.zshrc å®‰è£…zsh-syntax-highlightingè¯­æ³•é«˜äº®æ’ä»¶ ä»gihubä¸‹è½½æºç å¹¶æ”¾åœ¨~/.oh-my-zsh/plugins/æ–‡ä»¶å¤¹ä¸‹: cd ~/.oh-my-zsh/plugins/ git clone https://github.com/zsh-users/zsh-syntax-highlighting.git åœ¨~/.zshrcæ–‡ä»¶ä¸­ç¼–è¾‘: source ~/.oh-my-zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ç„¶åï¼Œsourceä¸€ä¸‹: source ~/.zshrc å®‰è£…zsh-autosuggestionsè¯­æ³•å†å²è®°å½•æ’ä»¶ ä»gihubä¸‹è½½æºç å¹¶æ”¾åœ¨~/.oh-my-zsh/plugins/æ–‡ä»¶å¤¹ä¸‹: cd ~/.oh-my-zsh/plugins/ git clone git@github.com:zsh-users/zsh-autosuggestions.git åœ¨~/.zshrcæ–‡ä»¶ä¸­ç¼–è¾‘: source ~/.oh-my-zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh ç„¶åï¼Œsourceä¸€ä¸‹: source ~/.zshrc ","date":"2023-07-16","objectID":"/posts/zsh_installation/:5:3","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"å…¶ä»– è®¾ç½®æ›´æ–°æ—¥æœŸ åœ¨~/.zshrcæ–‡ä»¶ä¸­ç¼–ï¼š exprot UPDATE_ZSH_DAYS=13 ç¦æ­¢è‡ªåŠ¨æ›´æ–° DISABLE_AUTO_UPDATE=\"true\" æ‰‹åŠ¨æ›´æ–°oh-my-zsh upgrade_oh_my_zsh å¸è½½oh-my-zsh uninstall_on_my_zsh zsh ","date":"2023-07-16","objectID":"/posts/zsh_installation/:5:4","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"ä»bashåˆ°zshçš„åˆ‡æ¢ ç›´æ¥æ‰§è¡Œzshå’Œoh-my-zshçš„å®‰è£…ä»¥åŠé…ç½®ï¼Œå¹¶ä¸”åœ¨~/.zshrcæ–‡ä»¶ä¸­æ·»åŠ : source ~/.bashrc ","date":"2023-07-16","objectID":"/posts/zsh_installation/:5:5","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Memo"],"content":"zsh å¿«æ·é”® å¿«æ·é”® âŒƒ + u: æ¸…ç©ºå½“å‰è¡Œ âŒƒ + a: ç§»åŠ¨åˆ°è¡Œé¦– âŒƒ + e: ç§»åŠ¨åˆ°è¡Œå°¾ âŒƒ + f: å‘å‰ç§»åŠ¨ âŒƒ + b: å‘åç§»åŠ¨ âŒƒ + p: ä¸Šä¸€æ¡å‘½ä»¤ âŒƒ + n: ä¸‹ä¸€æ¡å‘½ä»¤ âŒƒ + r: æœç´¢å†å²å‘½ä»¤ âŒƒ + y: å¬å›æœ€è¿‘ç”¨å‘½ä»¤åˆ é™¤çš„æ–‡å­— âŒƒ + h: åˆ é™¤å…‰æ ‡ä¹‹å‰çš„å­—ç¬¦ âŒƒ + d: åˆ é™¤å…‰æ ‡æ‰€æŒ‡çš„å­—ç¬¦ âŒƒ + w: åˆ é™¤å…‰æ ‡ä¹‹å‰çš„å•è¯ âŒƒ + k: åˆ é™¤ä»å…‰æ ‡åˆ°è¡Œå°¾çš„å†…å®¹ âŒƒ + t: äº¤æ¢å…‰æ ‡å’Œä¹‹å‰çš„å­—ç¬¦ ","date":"2023-07-16","objectID":"/posts/zsh_installation/:6:0","tags":["Zsh"],"title":"Zsh Installation","uri":"/posts/zsh_installation/"},{"categories":["Git"],"content":" å·¥ä½œåŒºï¼šå°±æ˜¯ä½ åœ¨ç”µè„‘é‡Œèƒ½çœ‹åˆ°çš„ç›®å½•ã€‚ æš‚å­˜åŒºï¼šè‹±æ–‡å« stage, æˆ– indexã€‚ä¸€èˆ¬å­˜æ”¾åœ¨ â€œ.git ç›®å½•ä¸‹â€ ä¸‹çš„ index æ–‡ä»¶ï¼ˆ.git/indexï¼‰ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæš‚å­˜åŒºæœ‰æ—¶ä¹Ÿå«ä½œç´¢å¼•ï¼ˆindexï¼‰ã€‚ ç‰ˆæœ¬åº“ï¼šå·¥ä½œåŒºæœ‰ä¸€ä¸ªéšè—ç›®å½•ã€‚gitï¼Œè¿™ä¸ªä¸ç®—å·¥ä½œåŒºï¼Œè€Œæ˜¯ Git çš„ç‰ˆæœ¬åº“ã€‚ ","date":"2023-07-16","objectID":"/posts/introduction/:0:0","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"ä»‹ç» https://git-scm.com/ å…ˆé€šè¿‡å‡ å¼ å›¾ç‰‡æ¥å¤§è‡´äº†è§£ä¸€ä¸‹ Git çš„å·¥ä½œåŸç†å§ï¼ æ–‡ç« å¼€å¤´çš„æµç¨‹å›¾å·²ç»ç®€å•æ˜äº†åœ°è¯´æ˜äº† Git å¸¸ç”¨æ“ä½œçš„å·¥ä½œæµç¨‹ï¼Œä¸‹å›¾æ¢ç§é£æ ¼å†å±•ç¤ºä¸€æ¬¡ï¼š æåˆ° Git å°±ä¼šè”æƒ³åˆ° github, ä¸‹å›¾ä» Git çš„è§’åº¦ç®€å•è¯´æ˜äº†ä¸€äº› Github å¸¸ç”¨æ“ä½œçš„å…³ç³»ï¼š ä¸‹é¢è¿™ä¸ªå›¾åˆ™å±•ç¤ºäº†å·¥ä½œåŒºã€ç‰ˆæœ¬åº“ä¸­çš„æš‚å­˜åŒºå’Œç‰ˆæœ¬åº“ä¹‹é—´çš„å…³ç³»ï¼š å›¾ä¸­å·¦ä¾§ä¸ºå·¥ä½œåŒºï¼Œå³ä¾§ä¸ºç‰ˆæœ¬åº“ã€‚åœ¨ç‰ˆæœ¬åº“ä¸­æ ‡è®°ä¸º \"index\" çš„åŒºåŸŸæ˜¯æš‚å­˜åŒºï¼ˆstage, indexï¼‰ï¼Œæ ‡è®°ä¸º â€œmasterâ€ çš„æ˜¯ master åˆ†æ”¯æ‰€ä»£è¡¨çš„ç›®å½•æ ‘ã€‚ HEAD æŒ‡é’ˆï¼šæ¯ä¸ª git ä»“åº“æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª HEAD æŒ‡é’ˆï¼Œå®ƒé€šå¸¸æŒ‡å‘ç•¶å‰æŸä¸ªæ´»å‹•çš„æœ¬åœ°åˆ†æ”¯æŒ‡é’ˆï¼ˆæœ€åˆæœ¬åœ°ä»“åº“ master)ã€‚ä¹Ÿå¯ä»¥æ˜¯æŸä¸ªæäº¤è®°å½•ã€æŸä¸ª tagï¼Œä½†è¿™ä¼šè®©å…¶å¤„äº detached HEADï¼ˆæ¸¸ç¦»å¤´ï¼‰çŠ¶æ€ï¼Œæ­¤çŠ¶æ€ä¸‹çš„æ‰€æœ‰æäº¤éƒ½æ— æ•ˆã€‚ å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ­¤æ—¶ \"HEAD\" å®é™…æ˜¯æŒ‡å‘ master åˆ†æ”¯çš„ä¸€ä¸ª\"æ¸¸æ ‡\"ã€‚æ‰€ä»¥å›¾ç¤ºçš„å‘½ä»¤ä¸­å‡ºç° HEAD çš„åœ°æ–¹å¯ä»¥ç”¨ master æ¥æ›¿æ¢ã€‚ å›¾ä¸­çš„objectsæ ‡è¯†çš„åŒºåŸŸä¸º Git çš„å¯¹è±¡åº“ï¼Œå®é™…ä½äº \".git/objects\" ç›®å½•ä¸‹ï¼Œé‡Œé¢åŒ…å«äº†åˆ›å»ºçš„å„ç§å¯¹è±¡åŠå†…å®¹ã€‚ å½“å¯¹å·¥ä½œåŒºä¿®æ”¹ï¼ˆæˆ–æ–°å¢ï¼‰çš„æ–‡ä»¶æ‰§è¡Œ \"git add\"å‘½ä»¤æ—¶ï¼Œæš‚å­˜åŒºçš„ç›®å½•æ ‘è¢«æ›´æ–°ï¼ŒåŒæ—¶å·¥ä½œåŒºä¿®æ”¹ï¼ˆæˆ–æ–°å¢ï¼‰çš„æ–‡ä»¶å†…å®¹è¢«å†™å…¥åˆ°å¯¹è±¡åº“ä¸­çš„ä¸€ä¸ªæ–°çš„å¯¹è±¡ä¸­ï¼Œè€Œè¯¥å¯¹è±¡çš„ ID è¢«è®°å½•åœ¨æš‚å­˜åŒºçš„æ–‡ä»¶ç´¢å¼•ä¸­ã€‚ å½“æ‰§è¡Œæäº¤æ“ä½œï¼ˆgit commitï¼‰æ—¶ï¼Œæš‚å­˜åŒºçš„ç›®å½•æ ‘å†™åˆ°ç‰ˆæœ¬åº“ï¼ˆå¯¹è±¡åº“ï¼‰ä¸­ï¼Œmaster åˆ†æ”¯ä¼šåšç›¸åº”çš„æ›´æ–°ã€‚å³ master æŒ‡å‘çš„ç›®å½•æ ‘å°±æ˜¯æäº¤æ—¶æš‚å­˜åŒºçš„ç›®å½•æ ‘ã€‚ å½“æ‰§è¡Œ \"git reset HEAD\" å‘½ä»¤æ—¶ï¼Œæš‚å­˜åŒºçš„ç›®å½•æ ‘ä¼šè¢«é‡å†™ï¼Œè¢« master åˆ†æ”¯æŒ‡å‘çš„ç›®å½•æ ‘æ‰€æ›¿æ¢ï¼Œä½†æ˜¯å·¥ä½œåŒºä¸å—å½±å“ã€‚ å½“æ‰§è¡Œ \"git rm --cached \u003cfile\u003e\" å‘½ä»¤æ—¶ï¼Œä¼šç›´æ¥ä»æš‚å­˜åŒºåˆ é™¤æ–‡ä»¶ï¼Œå·¥ä½œåŒºåˆ™ä¸åšå‡ºæ”¹å˜ã€‚ å½“æ‰§è¡Œ \"git checkout .\" æˆ–è€… \"git checkout -- \u003cfile\u003e\" å‘½ä»¤æ—¶ï¼Œä¼šç”¨æš‚å­˜åŒºå…¨éƒ¨æˆ–æŒ‡å®šçš„æ–‡ä»¶æ›¿æ¢å·¥ä½œåŒºçš„æ–‡ä»¶ã€‚è¿™ä¸ªæ“ä½œå¾ˆå±é™©ï¼Œä¼šæ¸…é™¤å·¥ä½œåŒºä¸­æœªæ·»åŠ åˆ°æš‚å­˜åŒºçš„æ”¹åŠ¨ã€‚ å½“æ‰§è¡Œ \"git checkout HEAD .\" æˆ–è€… \"git checkout HEAD \u003cfile\u003e\" å‘½ä»¤æ—¶ï¼Œä¼šç”¨ HEAD æŒ‡å‘çš„ master åˆ†æ”¯ä¸­çš„å…¨éƒ¨æˆ–è€…éƒ¨åˆ†æ–‡ä»¶æ›¿æ¢æš‚å­˜åŒºå’Œä»¥åŠå·¥ä½œåŒºä¸­çš„æ–‡ä»¶ã€‚è¿™ä¸ªå‘½ä»¤ä¹Ÿæ˜¯æå…·å±é™©æ€§çš„ï¼Œå› ä¸ºä¸ä½†ä¼šæ¸…é™¤å·¥ä½œåŒºä¸­æœªæäº¤çš„æ”¹åŠ¨ï¼Œä¹Ÿä¼šæ¸…é™¤æš‚å­˜åŒºä¸­æœªæäº¤çš„æ”¹åŠ¨ã€‚ ","date":"2023-07-16","objectID":"/posts/introduction/:1:0","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"Git é…ç½® git config --global --list #æŸ¥çœ‹å…¨å±€é…ç½® git config --local --list #æŸ¥çœ‹æœ¬é¡¹ç›®é…ç½® # ç¬¬ä¸€æ¬¡ä½¿ç”¨ git çš„æ—¶å€™ï¼Œéœ€è¦è®¾ç½®ç”¨æˆ·ä¿¡æ¯å’Œç”¨æˆ·é‚®ç®±ï¼Œç”¨äºè¾¨è¯†æäº¤è€…èº«ä»½ git config --global user.name \"ç”¨æˆ·å\" git config --global user.email \"é‚®ç®±\" git config --global alias.cm commit git config --global alias.br branch # é…ç½®æŒ‡ä»¤åˆ«åç®€å†™ git config --global credential.helper store # è¾“å…¥ä¸€æ¬¡è´¦å·å¯†ç åç¬¬äºŒæ¬¡å°±ä¼šè®°ä½è´¦å·å¯†ç  git config --global core.ignorecase false # å…³é—­å¿½ç•¥å¤§å°å†™ git config --system core.longpaths true # é…ç½®é•¿è·¯å¾„ git config --global http.sslVerify false # ç¦ç”¨ SSL éªŒè¯ git config --global core.protectNTFS false # å…³é—­ NTFS æ–‡ä»¶ä¿æŠ¤ git config --global url.\"https://\".insteadOf git:// # git:// æŠ¥é”™ ","date":"2023-07-16","objectID":"/posts/introduction/:2:0","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"åŸºæœ¬æ“ä½œ git init ## æŠŠå½“å‰çš„ç›®å½•å˜æˆå¯ä»¥ç”¨ git è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„ git ä»“åº“ï¼Œç”Ÿæˆéšè—ã€‚git æ–‡ä»¶ã€‚ git add XX ## æŠŠ xx æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºå»ã€‚ git add â€“A ## git add --all çš„ç¼©å†™ï¼Œæ·»åŠ å…¨éƒ¨åˆ°æš‚å­˜åŒº git add â€“u ## æŠŠæ–‡ä»¶çš„åˆ é™¤å’Œä¿®æ”¹æ·»åŠ åˆ°æš‚å­˜åŒºï¼ˆä¸åŒ…æ‹¬æ–°å¢ï¼‰ git add . ## ç›‘æ§å·¥ä½œåŒºçš„çŠ¶æ€æ ‘ï¼Œä½¿ç”¨å®ƒä¼šæŠŠå·¥ä½œæ—¶çš„æ‰€æœ‰å˜åŒ–æäº¤åˆ°æš‚å­˜åŒº git commit -m \"message\" ## ä»æš‚å­˜åŒºæäº¤åˆ°æœ¬åœ°ä»“åº“ git commit -a -m \"message\" ## ç›¸å½“äºçœç•¥ git addï¼Œä½†æ˜¯æ— æ³•æäº¤æ–°å¢çš„æ–‡ä»¶ git push origin master ## Git ä¼šæŠŠ master åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹åº“å¯¹åº”çš„è¿œç¨‹åˆ†æ”¯ä¸Š Tips Commit Message å†…å®¹å°½é‡è§„èŒƒï¼ å½“æŸä¸€æ¬¡æäº¤åï¼Œçªç„¶æƒ³èµ·æ¼æäº¤äº†æ–‡ä»¶ï¼Œæˆ–ä¸å°å¿ƒæäº¤äº†ä¸æ»¡æ„çš„ä»£ç æ—¶ï¼Œ å¯ä»¥ä½¿ç”¨git commit --amend -m \"message\"æŒ‡ä»¤ã€‚å®ƒå¯ä»¥åœ¨ä¸å¢åŠ ä¸€ä¸ªæ–°çš„ commit-id çš„æƒ…å†µä¸‹å°†æ–°ä¿®æ”¹çš„ä»£ç è¿½åŠ åˆ°å‰ä¸€æ¬¡çš„ commit-id ä¸­ã€‚æäº¤ä¹‹å message ä¹Ÿå°†è¢«æœ¬æ¬¡çš„ message è¦†ç›–ï¼Œæ‰€ä»¥è¿˜éœ€è¦å†æ¬¡æ·»åŠ ä¸Šæ¬¡çš„ messageã€‚ ","date":"2023-07-16","objectID":"/posts/introduction/:2:1","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"push git push origin branch-name git push â€“u origin master git push origin --delete branch-name ## åˆ é™¤è¿œç¨‹åˆ†æ”¯ æŠŠå½“å‰ master åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹åº“ï¼›-uè¡¨ç¤ºè®°ä½åˆ†æ”¯å’Œåœ°å€ï¼Œä¸‹æ¬¡ä½¿ç”¨git pushå³å¯ã€‚ ","date":"2023-07-16","objectID":"/posts/introduction/:2:2","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"remote git remote add origin reposityUrl ## å…³è”ä¸€ä¸ªè¿œç¨‹åº“ git remote ## æŸ¥çœ‹è¿œç¨‹åº“çš„ä¿¡æ¯ git remote â€“v ## æŸ¥çœ‹è¿œç¨‹åº“çš„è¯¦ç»†ä¿¡æ¯ ","date":"2023-07-16","objectID":"/posts/introduction/:2:3","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"clone git clone reposityUrl ## ä»è¿œç¨‹åº“ä¸­å…‹éš† git clone -b branchName reposityUrl ## å…‹éš†æŒ‡å®šåˆ†æ”¯ ","date":"2023-07-16","objectID":"/posts/introduction/:2:4","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"pull git pull ä»è¿œç¨‹ä»“åº“æ‹‰ä¸‹æ¥åˆ°æœ¬åœ°åº“ç„¶ååˆå¹¶ç›¸å½“äºgit fetch+git mergeã€‚ ä¸€èˆ¬ push å‰å…ˆæ‹‰å»æœ€æ–°ç‰ˆæœ¬ï¼Œé¿å…ä»£ç å†²çªï¼Œå¦‚æœæœ‰å†²çªéœ€è¦è§£å†³äº†å†²çªæ‰èƒ½æäº¤ã€‚ import repositories åŒæ­¥æ›´æ–° git pull åŸé“¾æ¥ git push origin master ","date":"2023-07-16","objectID":"/posts/introduction/:2:5","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"fetch git fetch ## ä»è¿œç¨‹åº“æŠ“ä¸‹æœ€æ–°ç‰ˆæœ¬ï¼Œä½†æ˜¯ä¸åˆå¹¶ fetch æ˜¯ä»è¿œç¨‹åº“åˆ°æœ¬åœ°åº“ï¼Œä½†æ˜¯æœªåœ¨å·¥ä½œåŒºï¼Œéœ€è¦git merge ","date":"2023-07-16","objectID":"/posts/introduction/:2:6","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"merge git merge dev ## åœ¨å½“å‰çš„åˆ†æ”¯ä¸Šåˆå¹¶ dev åˆ†æ”¯ åˆ†æ”¯åˆå¹¶ä¹Ÿæ˜¯åœ¨æœ¬åœ°å®Œæˆ (ä»æœ¬åœ°åº“åˆ°å·¥ä½œåŒº)ï¼Œæ–°çš„åˆ†æ”¯åªæœ‰åœ¨åˆå¹¶åæ‰å…è®¸è¢«åˆ é™¤ã€‚ å¦‚æœåˆ†æ”¯åˆå¹¶æ˜¯å‡ºç°å†²çªéœ€è¦è§£å†³äº†å†²çªæ‰èƒ½åˆå¹¶ï¼Œä½¿ç”¨git statusæŸ¥çœ‹å†²çªæ–‡ä»¶ã€‚ ","date":"2023-07-16","objectID":"/posts/introduction/:2:7","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"branch,checkout git branch ## æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„åˆ†æ”¯ git branch name ## åˆ›å»ºåˆ†æ”¯ git branch â€“r ## çœ‹è¿œç¨‹æ‰€æœ‰åˆ†æ”¯ git branch â€“a ## æŸ¥çœ‹æœ¬åœ°è¿œç¨‹åˆ†æ”¯ git branch â€“d name ## åˆ é™¤åˆ†æ”¯ git checkout name ## åˆ‡æ¢åˆ†æ”¯ git checkout â€“b name ## åˆ›å»ºå¹¶åˆ‡æ¢åˆ° name åˆ†æ”¯ä¸Š git checkout -- file git checkout -- fileç›¸å½“äºå–æ¶ˆå¯¹æ–‡æ¡£çš„ä¿®æ”¹ï¼Œå°†æœ€æ–°çš„æœ¬åœ°ç‰ˆæœ¬åº“çš„æœ¬æ–‡ä»¶å¤åˆ¶è¦†ç›–å®ƒã€‚ï¼ˆæ¯”è¾ƒå±é™©ï¼ï¼‰ ","date":"2023-07-16","objectID":"/posts/introduction/:2:8","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"reflog,log git log ## æ˜¾ç¤ºæ‰€æœ‰æäº¤è¿‡çš„ç‰ˆæœ¬ä¿¡æ¯ï¼šcommit idï¼Œæäº¤è€…ï¼Œæ—¥æœŸ git reflog ## æŸ¥çœ‹å†å²è®°å½•çš„ commit id Tips æƒ³çœ‹åˆ°è‡ªå·±çš„æ“ä½œè®°å½•ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ log ä¸ reflogï¼Œå®ƒä¸¤ä¸ªçš„åŒºåˆ«å¦‚ä¸‹ï¼š git logå‘½ä»¤å¯ä»¥æ˜¾ç¤ºæ‰€æœ‰æäº¤è¿‡çš„ç‰ˆæœ¬ä¿¡æ¯ï¼› å¦‚æœæ„Ÿè§‰å¤ªç¹çï¼Œå¯ä»¥åŠ ä¸Šå‚æ•°--pretty=onelineï¼Œåªä¼šæ˜¾ç¤ºç‰ˆæœ¬å·å’Œæäº¤æ—¶çš„å¤‡æ³¨ä¿¡æ¯ã€‚ git reflogå¯ä»¥æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œè®°å½•ã€‚ï¼ˆåŒ…æ‹¬å·²ç»è¢«åˆ é™¤çš„ commit è®°å½•å’Œ reset çš„æ“ä½œï¼‰ ","date":"2023-07-16","objectID":"/posts/introduction/:2:9","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"reset git reset --hard HEAD^ git reset --hard HEAD~ ## å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ git reset --hard HEAD~100 ## å›é€€åˆ° 100 ä¸ªç‰ˆæœ¬ git reset head -- file ## ä¸åŠ  file åˆ™å…¨éƒ¨é€€å› git reset file ## å°†æœ¬åœ°ä»“åº“çš„å½“å‰ç‰ˆæœ¬é€€å›è‡³æš‚å­˜åŒºï¼Œç›¸å½“äºå–æ¶ˆæš‚å­˜ ç‰ˆæœ¬é€€å›æ˜¯ä»æœ¬åœ°ä»“åº“åˆ°æš‚å­˜åŒºï¼Œå¦‚æœå·²ç»æäº¤è¿œç¨‹åº“ï¼Œæ­¤æ—¶çš„ç‰ˆæœ¬æ˜¯ä½äºæœ€æ–°çš„ç‰ˆæœ¬çš„ä¼šæ‹’ç»æäº¤ï¼Œ éœ€è¦ç”¨git push -f origin masterå¼ºåˆ¶æäº¤ã€‚ ç‰¹åˆ«æé†’ å¦‚æœä½ git reset --hard HEAD^+git push -f origin masteræ‰§è¡Œå®Œï¼Œgithub ä¸­çš„è®°å½•å’Œæœ¬åœ°æ–‡ä»¶éƒ½ä¼šå›åˆ°é€€å›çš„çŠ¶æ€ã€‚ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¿®æ”¹äº†ä¸€å¤©çš„ bug, å®Œå·¥åï¼Œä½ è¿™ä¸€å¥—æ“ä½œç›´æ¥æ‰“å›åŸå½¢ã€‚åˆ«æ…Œï¼ˆå®é™…å†…å¿ƒæ…Œçš„ä¸€éº»çš®ã€‚ï¼‰ é€šè¿‡git log -gå‘½ä»¤æ¥æ‰¾åˆ°éœ€è¦æ¢å¤çš„ä¿¡æ¯å¯¹åº”çš„ commitidï¼Œå¯ä»¥é€šè¿‡æäº¤çš„æ—¶é—´å’Œè®°å½•æ¥è¾¨åˆ«ï¼Œ æ‰¾åˆ°æ‰§è¡Œreset --hardä¹‹å‰çš„é‚£ä¸ª commit å¯¹åº”çš„ commit-id é€šè¿‡git branch recover_branch commit-idæ¥å»ºç«‹ä¸€ä¸ªæ–°çš„åˆ†æ”¯ è¿™æ ·ï¼Œå°±æŠŠåˆ° commitid ä¸ºæ­¢çš„ä»£ç ã€å„ç§æäº¤è®°å½•ç­‰ä¿¡æ¯éƒ½æ¢å¤åˆ°äº† recover_branch åˆ†æ”¯ä¸Šäº†ã€‚ ","date":"2023-07-16","objectID":"/posts/introduction/:2:10","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"status git status æŸ¥çœ‹ä½ çš„æ–‡ä»¶åœ¨æš‚å­˜åŒºå’Œå·¥ä½œç›®å½•çš„çŠ¶æ€ï¼Œé»˜è®¤æ˜¯è¾ƒä¸ºè¯¦ç»†çš„æ˜¾ç¤ºï¼Œå¹¶æç¤ºä½ å¯ä»¥ç”¨ä½•ç§å‘½ä»¤å®Œæˆä½ æ¥ä¸‹æ¥å¯èƒ½è¦åšçš„äº‹æƒ…ã€‚ git status -s è¾ƒä¸ºç®€å•çš„è¾“å‡ºå½“å‰çš„çŠ¶æ€ï¼Œå¦‚ï¼š $ git status -s M README.md D hello.rb ?? world.java ä½ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ç®€çŸ­è¾“å‡ºä¸­ï¼Œæœ‰ä¸¤æ ã€‚ç¬¬ä¸€æ æ˜¯æš‚å­˜åŒºçš„ï¼Œç¬¬äºŒæ åˆ™æ˜¯å·¥ä½œç›®å½•çš„ã€‚è¿™é‡Œè¡¨ç¤ºï¼š README.md åœ¨æš‚å­˜åŒºä¸­çš„çŠ¶æ€æ˜¯ modify hello.rb åœ¨å·¥ä½œç›®å½•ä¸­çš„çŠ¶æ€æ˜¯ delete world.java è¿˜æœªæ·»åŠ åˆ°ç‰ˆæœ¬æ§åˆ¶ã€‚ ","date":"2023-07-16","objectID":"/posts/introduction/:2:11","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"diff git diff XX ## æŸ¥çœ‹ XX æ–‡ä»¶ä¿®æ”¹äº†å“ªäº›å†…å®¹ git diff ## å·¥ä½œç›®å½•å’Œæš‚å­˜åŒº git diff --cached ## æš‚å­˜åŒºå’Œæœ¬åœ°ä»“åº“ git diff HEAD ## å·¥ä½œç›®å½•å’Œæœ¬åœ°ä»“åº“ git diff --stat ## æ˜¾ç¤ºä¿¡æ¯æ‘˜è¦ ","date":"2023-07-16","objectID":"/posts/introduction/:2:12","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"rm, mv git rm ## å°†æ–‡ä»¶ä»æš‚å­˜åŒºå’Œå·¥ä½œç›®å½•åˆ é™¤ï¼Œ-f ä¸ºå¼ºåˆ¶åˆ é™¤ git rm filename ## åˆ é™¤æ–‡ä»¶ git rm â€“r dirname ## åˆ é™¤æ–‡ä»¶å¤¹ â€“r è¡¨ç¤ºé€’å½’æ‰€æœ‰å­ç›®å½• git rm --cached \u003cpath\u003e ## å°†æ–‡ä»¶ä»æš‚å­˜åŒºä¸­åˆ é™¤ git mv \u003cold_path\u003e \u003cnew_path\u003e git rmç”¨æ¥åˆ é™¤æ–‡ä»¶ã€ç›®å½•ã€‚git mvå‘½ä»¤ç”¨äºç§»åŠ¨æˆ–é‡å‘½åä¸€ä¸ªæ–‡ä»¶ã€ç›®å½•ã€‚ æ¯”å¦‚åˆ é™¤ photos æ–‡ä»¶ï¼Œæœ¬åœ°åˆ é™¤åï¼Œè¿œç¨‹ä»“åº“è¿˜ä¼šæœ‰ï¼Œæ‰€ä»¥ git rm -r photos git commit -m \"åˆ é™¤ç›¸å†Œ\" git push ","date":"2023-07-16","objectID":"/posts/introduction/:2:13","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"submodule git submodule add ## æ·»åŠ å­æ¨¡ç»„ git submodule init ## å­æ¨¡ç»„åˆå§‹åŒ– git submodule update ## å­æ¨¡ç»„æ›´æ–° git submodule -help Note å½“ä¸€ä¸ªè¿œç¨‹åº“æœ‰å­æ¨¡ç»„æ—¶ï¼Œç›´æ¥ clone å­æ¨¡ç»„åªæ˜¯ä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼Œéœ€è¦è¿›å…¥å­æ¨¡ç»„çš„ç©ºæ–‡ä»¶å¤¹initå’Œupdateæ‰è¡Œã€‚ æˆ–è€…ä½¿ç”¨é€’å½’å…‹éš†git clone --recursive è¿œç¨‹åº“ å­æ¨¡ç»„æ›´æ–°åï¼Œçˆ¶æ¨¡ç»„å¿…é¡»æ›´æ–°ï¼Œå› ä¸ºéœ€è¦æ›´æ–° commit idã€‚ ","date":"2023-07-16","objectID":"/posts/introduction/:2:14","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"tag git tag v1.0 git tag -a v1.0 ## ç»™æœ€æ–°ä¸€æ¬¡æäº¤æ‰“æ ‡ç­¾ git tag -a \u003ctagname\u003e -m \"æ ‡ç­¾\" ## æŒ‡å®šæ ‡ç­¾ä¿¡æ¯å‘½ä»¤ git show \u003ctagname\u003e ## æ˜¾ç¤ºæ ‡ç­¾ä¿¡æ¯ git tag ## æŸ¥çœ‹ç‰ˆæœ¬æ‰“çš„ Tag git tag -d v1.0 ## åˆ é™¤æœ¬åœ°æ ‡ç­¾ git push origin :refs/tags/v1.0 ## åˆ é™¤è¿œç¨‹æ ‡ç­¾ $ git push [remote] [tag] ## æäº¤æŒ‡å®š tag $ git push [remote] --tags ## æäº¤æ‰€æœ‰ tag Note å½“ä½ æ‰§è¡Œgit tag -aå‘½ä»¤æ—¶ï¼ŒGit ä¼šæ‰“å¼€ä½ çš„ç¼–è¾‘å™¨ï¼Œè®©ä½ å†™ä¸€å¥æ ‡ç­¾æ³¨è§£ï¼Œå°±åƒä½ ç»™æäº¤å†™æ³¨è§£ä¸€æ ·ã€‚ å¦‚æœæˆ‘ä»¬å¿˜äº†ç»™æŸä¸ªæäº¤æ‰“æ ‡ç­¾ï¼Œåˆå°†å®ƒå‘å¸ƒäº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å®ƒè¿½åŠ æ ‡ç­¾ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬å‘å¸ƒäº†æäº¤ 85fc7e7ï¼ˆæœ€åä¸€è¡Œï¼‰ï¼Œä½†æ˜¯é‚£æ—¶å€™å¿˜äº†ç»™å®ƒæ‰“æ ‡ç­¾ã€‚ æˆ‘ä»¬ç°åœ¨ä¹Ÿå¯ä»¥ï¼š $ git tag -a v0.9 85fc7e7 $ git log --oneline --decorate --graph * d5e9fc2 (HEAD -\u003e master) Merge branch 'change_site' |\\ | * 7774248 (change_site) changed the runoob.php * | c68142b ä¿®æ”¹ä»£ç  |/ * c1501a2 removed test.txtã€add runoob.php * 3e92c19 add test.txt * 3b58100 (tag: v0.9) ç¬¬ä¸€æ¬¡ç‰ˆæœ¬æäº¤ ","date":"2023-07-16","objectID":"/posts/introduction/:2:15","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"stash git stash ## æŠŠå½“å‰çš„å·¥ä½œéšè—èµ·æ¥ï¼Œç­‰ä»¥åæ¢å¤ç°åœºåç»§ç»­å·¥ä½œ git stash list ## æŸ¥çœ‹æ‰€æœ‰è¢«éšè—çš„æ–‡ä»¶åˆ—è¡¨ ","date":"2023-07-16","objectID":"/posts/introduction/:2:16","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"gitk gitk ## git è‡ªå¸¦ GUI gitk --all ","date":"2023-07-16","objectID":"/posts/introduction/:2:17","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"github,gitea ç­‰å¹³å° issue çš„å¸¸ç”¨æ ‡ç­¾ bug æè¿°çš„é—®é¢˜æ˜¯ä¸€ä¸ª bug enhancement åŠŸèƒ½å¢å¼ºï¼Œæ²¡æœ‰ feature ä¹Ÿå¯ä»¥æŒ‡ New feature or request feature æ–°åŠŸèƒ½ duplicate é—®é¢˜é‡å¤ invalid å¯ç”¨çš„ï¼Œä¸æ˜¯ bug question ç–‘é—®ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„ä¿¡æ¯ wontfix ä¸ä¼šä¿®å¤æ­¤é—®é¢˜ help-wanted éœ€è¦å¸®åŠ© good first issue Good for newcomers æ›´å¤šæ ‡ç­¾ ","date":"2023-07-16","objectID":"/posts/introduction/:3:0","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"license ","date":"2023-07-16","objectID":"/posts/introduction/:4:0","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"å…¶ä»– å¸¸ç”¨ Git å‘½ä»¤æ¸…å• github ä¸Š fork äº†åˆ«äººçš„é¡¹ç›®åï¼Œå†åŒæ­¥æ›´æ–°åˆ«äººçš„æäº¤ Gearn Git Branching ","date":"2023-07-16","objectID":"/posts/introduction/:5:0","tags":["Git"],"title":"Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€»","uri":"/posts/introduction/"},{"categories":["Git"],"content":"Git å‘½ä»¤æ±‡æ€» ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:0","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"1. git rebase ref: https://git-scm.com/docs/git-rebase ç”¨æ³•ä¸€:git rebase \u003cbranch-name\u003e å°†topicåˆ†æ”¯çš„baseç”±Eæ”¹ä¸ºmaster A---B---C topic / D---E---F---G master è¿è¡Œ: git rebase master git rebase master topic ç»“æœ: A'--B'--C' topic / D---E---F---G master if upstream branch already has a change like below: A---B---C topic / D---E---A'---F master then run the command git rebase master, you will get following result: B'---C' topic / D---E---A'---F master ç”¨æ³•äºŒ:git rebase --onto assume topic is based on next, and next is based on master o---o---o---o---o master \\ o---o---o---o---o next \\ o---o---o topic run the command below: git rebase --onto master next topic then we get the result below: o---o---o---o---o master | \\ | o'--o'--o' topic \\ o---o---o---o---o next Another example: A range of commits could also be removed with rebase. If we have the following situation: E---F---G---H---I---J topicA then the command git rebase --onto topicA~5 topicA~3 topicA would result in the removal of commits F and G: E---H'---I'---J' topicA ç”¨æ³•ä¸‰:git rebase -i \u003ccommit_id\u003e \u003ccommit_id\u003e $\\mathbb{\\rightarrow}$ å°†å¤šä¸ªcommitåˆå¹¶ä¸ºä¸€ä¸ªã€‚ # æ‰§è¡Œgit logï¼Œå¾—åˆ°ä»¥ä¸‹commit_ids \u003e\u003e\u003e21fd585 \u003e\u003e\u003e45j3483 \u003e\u003e\u003e9i8975d \u003e\u003e\u003e73c20ec ç›®æ ‡: å°†21fd585ã€45j3483ã€9i8975d rebase åˆ° 73c20ec git rebase -i 73c20ec 21fd585 å¾—åˆ°: pick pick pick pick æ”¹ä¸º pick squash squash squash æœ€åï¼Œç¼–è¾‘commitå†…å®¹ï¼Œ å¾—åˆ° \u003e\u003e\u003eb8bec33 # æ­¤å¤„ä¸ºæ–°çš„commit \u003e\u003e\u003e73c20ec æ¨é€åˆ°remote: git push -f origin master ref: https://www.bilibili.com/video/BV15h411f74h/ https://blog.csdn.net/weixin_45953517/article/details/114362752 https://blog.csdn.net/weixin_44691608/article/details/118740059#t7 é‡åˆ°detached HEADçš„è§£å†³åŠæ³• git branch b1 git checkout master git merge b1 git push origin master git branch -d b1 ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:1","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"2. git cherrypick å°†æŒ‡å®šçš„æäº¤ç”¨äºå…¶ä»–åˆ†æ”¯ ä¾‹å¦‚: a - b - c - d Master \\ e - f - g Feature run the command below and apply commit(f) to master git checkout master git cherry-pick f get the result a - b - c - d - f Master \\ e - f - g Feature è½¬ç§»å¤šä¸ªæäº¤ # å°† A å’Œ B ä¸¤ä¸ªæäº¤åº”ç”¨åˆ°å½“å‰åˆ†æ”¯ git cherry-pick \u003cHashA\u003e \u003cHashB\u003e æˆ–è€… # è¯¥å‘½ä»¤å¯ä»¥è½¬ç§»ä» A åˆ° B çš„æ‰€æœ‰æäº¤,å®ƒä»¬å¿…é¡»æŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ”¾ç½®ï¼šæäº¤ A å¿…é¡»æ—©äºæäº¤ Bï¼Œå¦åˆ™å‘½ä»¤å°†å¤±è´¥ï¼Œä½†ä¸ä¼šæŠ¥é”™ã€‚ git cherry-pick A..B # ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤ï¼Œæäº¤ A å°†ä¸ä¼šåŒ…å«åœ¨ Cherry pick ä¸­ï¼Œ å¦‚æœè¦åŒ…å«æäº¤ Aï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•ã€‚ git cherry-pick A^..B ref:https://www.ruanyifeng.com/blog/2020/04/git-cherry-pick.html ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:2","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"3. git submodule å°†ä¸€ä¸ªrepoæ·»åŠ ä¸ºsubmodule git submodule add https://github.com/chaconinc/DbConnector å…‹éš†å«æœ‰å­æ¨¡å—çš„é¡¹ç›® git clone https://github.com/chaconinc/MainProject #æ­¤æ—¶åŒ…å«å­æ¨¡å—ç›®å½•ï¼Œä½†æ˜¯å…¶ä¸­æ²¡æœ‰ä»»ä½•æ–‡ä»¶ cd MainProject cd DbConnector/ # æ­¤æ—¶æœ‰DbConnectorç›®å½•ï¼Œä½†æ˜¯æ–‡ä»¶å¤¹æ˜¯ç©ºçš„ git submodule init # ç”¨æ¥åˆå§‹åŒ–æœ¬åœ°é…ç½®æ–‡ä»¶ git submodule update # ä»è¯¥é¡¹ç›®ä¸­æŠ“å–å¹¶æ£€å‡ºçˆ¶é¡¹ç›®ä¸­åˆ—å‡ºçš„åˆé€‚çš„æäº¤ æˆ–è€… git clone --recurse-submodules https://github.com/chaconinc/MainProject æˆ–è€…å·²ç»å…‹éš†äº†é¡¹ç›®ï¼Œä½†æ˜¯å¿˜è®°--recurse-submodule, åˆ™ä½¿ç”¨ git submodule update --init --recursive ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:3","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"4. æ‹‰å–è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ° æ‹‰å–æŸä¸€ä¸ªè¿œç¨‹çš„åˆ†æ”¯ï¼Œå¹¶åœ¨åˆ›å»ºç›¸åº”çš„æœ¬åœ°åˆ†æ”¯åç§° git fetch origin remote-branch-name git checkout -b local-branch-name origin/remote-branch-name ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:4","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"5. git tag ç”¨git tagæ‰“æ ‡ç­¾ git tag -a v1.0 git tag -a v0 85fc7e7 #è¿½åŠ æ ‡ç­¾ git clone æŒ‰ç…§tagæ‹‰å–ä»£ç  # git clone --branch [tagsæ ‡ç­¾] [gitåœ°å€] git clone -b v5.2.0 --depth=1 http://gitlabåœ°å€ ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:5","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"6. git stash git stash:éšè—ä¿®æ”¹ git stash # éšè—ä¿®æ”¹ git stash save \"stash-name\" #ç»™æ¯ä¸€ä¸ªstashå–åå­— git stash pop # æ¢å¤éšè—çš„ä¿®æ”¹ git stash list # åˆ—å‡ºæ‰€æœ‰çš„éšè— git stash apply [number] # æŒ‡å®šæ¢å¤ä½¿ç”¨å“ªä¸€ä¸ªéšè—ä¿®æ”¹ git stash drop # ç§»é™¤æŸä¸€é¡¹ä¿®æ”¹ git stash clear # åˆ é™¤æ‰€æœ‰éšè—çš„ä¿®æ”¹ git stash show # æŸ¥çœ‹éšè—çš„ä¿®æ”¹ git stash show -p git stash show --patch # æŸ¥çœ‹ç‰¹å®šçš„stashçš„diff ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:6","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"7. ä»£ç å›é€€: git reset/git revert ref:https://blog.csdn.net/weixin_35082950/article/details/113629326 æœ¬åœ°åˆ†æ”¯ç‰ˆæœ¬å›é€€çš„æ–¹æ³• git reflog # æ‰¾å›è¦å›é€€çš„ç‰ˆæœ¬çš„commit_id git reset --hard \u003ccommit_id\u003e è‡ªå·±çš„è¿œç¨‹åˆ†æ”¯ç‰ˆæœ¬å›é€€çš„æ–¹æ³• # å¦‚æœä½ çš„é”™è¯¯æäº¤å·²ç»æ¨é€åˆ°è‡ªå·±çš„è¿œç¨‹åˆ†æ”¯äº†ï¼Œé‚£ä¹ˆå°±éœ€è¦å›æ»šè¿œç¨‹åˆ†æ”¯äº†ã€‚ # 1. é¦–å…ˆè¦å›é€€æœ¬åœ°åˆ†æ”¯ï¼š git reflog git reset --hard \u003ccommit_id\u003e # 2. å¼ºåˆ¶æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯ git push -f å…¬å…±è¿œç¨‹åˆ†æ”¯ç‰ˆæœ¬å›é€€çš„é—®é¢˜ ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„é—®é¢˜ï¼šå¦‚æœä½ å›é€€å…¬å…±è¿œç¨‹åˆ†æ”¯ï¼ŒæŠŠåˆ«äººçš„æäº¤ç»™ä¸¢æ‰äº†æ€ä¹ˆåŠï¼Ÿ å‡è®¾ä½ çš„è¿œç¨‹masteråˆ†æ”¯æƒ…å†µæ˜¯è¿™æ ·çš„: A1â€“A2â€“B1 # å…¶ä¸­Aã€Båˆ†åˆ«ä»£è¡¨ä¸¤ä¸ªäººï¼ŒA1ã€A2ã€B1ä»£è¡¨å„è‡ªçš„æäº¤ã€‚å¹¶ä¸”æ‰€æœ‰äººçš„æœ¬åœ°åˆ†æ”¯éƒ½å·²ç»æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œå’Œè¿œç¨‹åˆ†æ”¯ä¸€è‡´ã€‚ è¿™ä¸ªæ—¶å€™ä½ å‘ç°A2è¿™æ¬¡æäº¤æœ‰é”™è¯¯ï¼Œä½ ç”¨resetå›æ»šè¿œç¨‹åˆ†æ”¯masteråˆ°A1ï¼Œé‚£ä¹ˆç†æƒ³çŠ¶æ€æ˜¯ä½ çš„é˜Ÿå‹ä¸€æ‹‰ä»£ç git pullï¼Œä»–ä»¬çš„masteråˆ†æ”¯ä¹Ÿå›æ»šäº†ï¼Œç„¶è€Œç°å®å´æ˜¯ï¼Œä½ çš„é˜Ÿå‹ä¼šçœ‹åˆ°ä¸‹é¢çš„æç¤ºï¼š $ git status On branch master Your branch is ahead of 'origin/master' by 2 commits. (use \"git push\" to publish your local commits) nothing to commit, working directory clean ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ çš„é˜Ÿå‹çš„åˆ†æ”¯å¹¶æ²¡æœ‰ä¸»åŠ¨å›é€€ï¼Œè€Œæ˜¯æ¯”è¿œç¨‹åˆ†æ”¯è¶…å‰äº†ä¸¤æ¬¡æäº¤ï¼Œå› ä¸ºè¿œç¨‹åˆ†æ”¯å›é€€äº†å˜›ã€‚ git revert HEAD #æ’¤é”€æœ€è¿‘ä¸€æ¬¡æäº¤ git revert HEAD~1 #æ’¤é”€ä¸Šä¸Šæ¬¡çš„æäº¤ï¼Œæ³¨æ„ï¼šæ•°å­—ä»0å¼€å§‹ git revert 0ffaacc #æ’¤é”€0ffaaccè¿™æ¬¡æäº¤ git revert å‘½ä»¤æ„æ€æ˜¯æ’¤é”€æŸæ¬¡æäº¤ã€‚å®ƒä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„æäº¤ï¼Œè™½ç„¶ä»£ç å›é€€äº†ï¼Œä½†æ˜¯ç‰ˆæœ¬ä¾ç„¶æ˜¯å‘å‰çš„ï¼Œæ‰€ä»¥ï¼Œå½“ä½ ç”¨revertå›é€€ä¹‹åï¼Œæ‰€æœ‰äººpullä¹‹åï¼Œä»–ä»¬çš„ä»£ç ä¹Ÿè‡ªåŠ¨çš„å›é€€äº†ã€‚ ä½†æ˜¯ï¼Œè¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š 1ã€revert æ˜¯æ’¤é”€ä¸€æ¬¡æäº¤ï¼Œæ‰€ä»¥åé¢çš„commit idæ˜¯ä½ éœ€è¦å›æ»šåˆ°çš„ç‰ˆæœ¬çš„å‰ä¸€æ¬¡æäº¤ã€‚ 2ã€ä½¿ç”¨revert HEADæ˜¯æ’¤é”€æœ€è¿‘çš„ä¸€æ¬¡æäº¤ï¼Œå¦‚æœä½ æœ€è¿‘ä¸€æ¬¡æäº¤æ˜¯ç”¨revertå‘½ä»¤äº§ç”Ÿçš„ï¼Œé‚£ä¹ˆä½ å†æ‰§è¡Œä¸€æ¬¡ï¼Œå°±ç›¸å½“äºæ’¤é”€äº†ä¸Šæ¬¡çš„æ’¤é”€æ“ä½œï¼Œæ¢å¥è¯è¯´ï¼Œä½ è¿ç»­æ‰§è¡Œä¸¤æ¬¡revert HEADå‘½ä»¤ï¼Œå°±è·Ÿæ²¡æ‰§è¡Œæ˜¯ä¸€æ ·çš„ã€‚ 3ã€ä½¿ç”¨revert HEAD~1 è¡¨ç¤ºæ’¤é”€æœ€è¿‘2æ¬¡æäº¤ï¼Œè¿™ä¸ªæ•°å­—æ˜¯ä»0å¼€å§‹çš„ï¼Œå¦‚æœä½ ä¹‹å‰æ’¤é”€è¿‡äº§ç”Ÿäº†commi idï¼Œé‚£ä¹ˆä¹Ÿä¼šè®¡ç®—åœ¨å†…çš„ã€‚ 4ã€å¦‚æœä½¿ç”¨ revert æ’¤é”€çš„ä¸æ˜¯æœ€è¿‘ä¸€æ¬¡æäº¤ï¼Œé‚£ä¹ˆä¸€å®šä¼šæœ‰ä»£ç å†²çªï¼Œéœ€è¦ä½ åˆå¹¶ä»£ç ï¼Œåˆå¹¶ä»£ç åªéœ€è¦æŠŠå½“å‰çš„ä»£ç å…¨éƒ¨å»æ‰ï¼Œä¿ç•™ä¹‹å‰ç‰ˆæœ¬çš„ä»£ç å°±å¯ä»¥äº†ã€‚ git revert å‘½ä»¤çš„å¥½å¤„å°±æ˜¯ä¸ä¼šä¸¢æ‰åˆ«äººçš„æäº¤ï¼Œå³ä½¿ä½ æ’¤é”€åè¦†ç›–äº†åˆ«äººçš„æäº¤ï¼Œä»–æ›´æ–°ä»£ç åï¼Œå¯ä»¥åœ¨æœ¬åœ°ç”¨ reset å‘å‰å›æ»šï¼Œæ‰¾åˆ°è‡ªå·±çš„ä»£ç ï¼Œç„¶åæ‹‰ä¸€ä¸‹åˆ†æ”¯ï¼Œå†å›æ¥åˆå¹¶ä¸Šå»å°±å¯ä»¥æ‰¾å›è¢«ä½ è¦†ç›–çš„æäº¤äº†ã€‚ revert åˆå¹¶ä»£ç ï¼Œè§£å†³å†²çª ä½¿ç”¨revertå‘½ä»¤ï¼Œå¦‚æœä¸æ˜¯æ’¤é”€çš„æœ€è¿‘ä¸€æ¬¡æäº¤ï¼Œé‚£ä¹ˆä¸€å®šä¼šæœ‰å†²çªï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š å…¨éƒ¨æ¸…ç©º ç¬¬ä¸€æ¬¡æäº¤ è§£å†³å†²çªå¾ˆç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬åªæƒ³å›åˆ°æŸæ¬¡æäº¤ï¼Œå› æ­¤éœ€è¦æŠŠå½“å‰æœ€æ–°çš„ä»£ç å»æ‰å³å¯ï¼Œä¹Ÿå°±æ˜¯HEADæ ‡è®°çš„ä»£ç : \u003c\u003c\u003c\u003c\u003c\u003c\u003c HEAD å…¨éƒ¨æ¸…ç©º ç¬¬ä¸€æ¬¡æäº¤ ======= æŠŠä¸Šé¢éƒ¨åˆ†ä»£ç å»æ‰å°±å¯ä»¥äº†ï¼Œç„¶åå†æäº¤ä¸€æ¬¡ä»£ç å°±å¯ä»¥è§£å†³å†²çªäº†ã€‚ ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:7","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"8. git branch å°†æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯å…³è”: git branch --set-upstream=origin/remote_branch your_branch ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:8","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"9. git commit git commit --amend: æäº¤å°ä¿®æ”¹ä½†æ˜¯ä¸å¢åŠ commit_id: git add . git commmit --amend # æ­¤é™¤å¯ä»¥ä¿®æ”¹commit message git push origin master ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:9","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"10. git pull ç¤ºä¾‹: git pull \u003cè¿œç¨‹ä¸»æœºå\u003e \u003cè¿œç¨‹åˆ†æ”¯å\u003e:\u003cæœ¬åœ°åˆ†æ”¯å\u003e Examplesï¼š å–å›originä¸»æœºçš„nextåˆ†æ”¯ï¼Œä¸æœ¬åœ°çš„masteråˆ†æ”¯åˆå¹¶ git pull origin next:master è¿œç¨‹åˆ†æ”¯(next)è¦ä¸å½“å‰åˆ†æ”¯åˆå¹¶ï¼Œåˆ™å†’å·åé¢çš„éƒ¨åˆ†å¯ä»¥çœç•¥ã€‚ git pull origin next å¦‚æœå½“å‰åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯å­˜åœ¨è¿½è¸ªå…³ç³»ï¼Œgit pullå°±å¯ä»¥çœç•¥è¿œç¨‹åˆ†æ”¯å git pull origin å¦‚æœå½“å‰åˆ†æ”¯åªæœ‰ä¸€ä¸ªè¿½è¸ªåˆ†æ”¯ï¼Œè¿è¿œç¨‹ä¸»æœºåéƒ½å¯ä»¥çœç•¥ ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:10","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Git"],"content":"11. git clone https://mp.weixin.qq.com/s?__biz=MzA4NjkwOTQ2OA==\u0026mid=2459742421\u0026idx=1\u0026sn=48b3849c03a8e99aa4a557e9643a68d1\u0026chksm=89af6fd53c65887bd2c4a8ada2d5afabbffabf2b390477bc298e7ed11e7a563f3ba83fff9e13\u0026scene=132\u0026exptype=timeline_recommend_article_extendread_extendread_for_notrec#wechat_redirect git flow git pull ","date":"2023-07-16","objectID":"/posts/gitnotes1/:1:11","tags":["Git"],"title":"Git å‘½ä»¤è®°å½•","uri":"/posts/gitnotes1/"},{"categories":["Pandas"],"content":"Pandas Notes ","date":"2023-07-15","objectID":"/posts/pandasnotes1/:0:0","tags":["draft"],"title":"Pandas Notes 1","uri":"/posts/pandasnotes1/"},{"categories":["Pandas"],"content":"Input/Output pd.read_csv(filepath): è¯»å–csvæ–‡ä»¶ ref: https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html?highlight=read_csv pd.read_pickle():è¯»å–pickleæ•°æ® import pandas pandas.read_pickle(filepath_or_buffer, compression='infer', storage_options=None) ref: https://pandas.pydata.org/docs/reference/api/pandas.read_pickle.html Parameters: filepath_or_buffer: æ–‡ä»¶åæˆ–è€…æ–‡ä»¶è·¯å¾„ å­—ç¬¦ä¸²ã€è·¯å¾„å¯¹è±¡(å®ç° os.PathLike[str] )æˆ– file-like å¯¹è±¡å®ç°äºŒè¿›åˆ¶ readlines() å‡½æ•°ã€‚ compression: str or dict, default â€˜inferâ€™ ç”¨äºon-disk æ•°æ®çš„å³æ—¶è§£å‹ç¼©ã€‚å¦‚æœ â€˜inferâ€™ å’Œ â€˜filepath_or_bufferâ€™ æ˜¯ path-likeï¼Œåˆ™ä»ä»¥ä¸‹æ‰©å±•åæ£€æµ‹å‹ç¼©ï¼šâ€œ.gzâ€ã€â€œ.bz2â€ã€â€œ.zipâ€ã€â€œ.xzâ€æˆ–â€œ.zstâ€(å¦åˆ™ä¸å‹ç¼©)ã€‚å¦‚æœä½¿ç”¨â€˜zipâ€™ï¼ŒZIP æ–‡ä»¶å¿…é¡»åªåŒ…å«ä¸€ä¸ªè¦è¯»å…¥çš„æ•°æ®æ–‡ä»¶ã€‚è®¾ç½®ä¸ºNone ä¸è§£å‹ç¼©ã€‚ä¹Ÿå¯ä»¥æ˜¯é”® â€˜methodâ€™ è®¾ç½®ä¸º {'zip' , 'gzip' , 'bz2' , 'zstd' } ä¹‹ä¸€çš„å­—å…¸ï¼Œå…¶ä»–é”®å€¼å¯¹åˆ†åˆ«è½¬å‘åˆ° zipfile.ZipFile , gzip.GzipFile , bz2.BZ2File æˆ– zstandard.ZstdDecompressor ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰å‹ç¼©å­—å…¸ä¸º Zstandard è§£å‹ç¼©ä¼ é€’ä»¥ä¸‹å†…å®¹ï¼šcompression={â€˜methodâ€™: â€˜zstdâ€™, â€˜dict_dataâ€™: my_compression_dict}ã€‚ storage_options: dict, optional å¯¹ç‰¹å®šå­˜å‚¨è¿æ¥æœ‰æ„ä¹‰çš„é¢å¤–é€‰é¡¹ï¼Œä¾‹å¦‚ä¸»æœºã€ç«¯å£ã€ç”¨æˆ·åã€å¯†ç ç­‰ã€‚å¯¹äº HTTP(S) URLï¼Œé”®å€¼å¯¹ä½œä¸ºæ ‡å¤´é€‰é¡¹è½¬å‘åˆ° urllibã€‚å¯¹äºå…¶ä»– URL(ä¾‹å¦‚ä»¥ â€œs3://â€ å’Œ â€œgcs://â€ å¼€å¤´)ï¼Œé”®å€¼å¯¹è¢«è½¬å‘åˆ°fsspec ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…fsspecå’Œurllibã€‚ ","date":"2023-07-15","objectID":"/posts/pandasnotes1/:1:0","tags":["draft"],"title":"Pandas Notes 1","uri":"/posts/pandasnotes1/"},{"categories":["Pandas"],"content":"General functions é€šç”¨å‡½æ•° ","date":"2023-07-15","objectID":"/posts/pandasnotes1/:2:0","tags":["draft"],"title":"Pandas Notes 1","uri":"/posts/pandasnotes1/"},{"categories":["Pandas"],"content":"Series ","date":"2023-07-15","objectID":"/posts/pandasnotes1/:3:0","tags":["draft"],"title":"Pandas Notes 1","uri":"/posts/pandasnotes1/"},{"categories":["Pandas"],"content":"DataFrame DataFrameæ˜¯ä¸€ä¸ªã€è¡¨æ ¼å‹ã€‘çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥çœ‹åšæ˜¯ã€ç”±Seriesç»„æˆçš„å­—å…¸ã€‘ï¼ˆå…±ç”¨åŒä¸€ä¸ªç´¢å¼•ï¼‰ã€‚DataFrameç”±æŒ‰ä¸€å®šé¡ºåºæ’åˆ—çš„å¤šåˆ—æ•°æ®ç»„æˆã€‚è®¾è®¡åˆè¡·æ˜¯å°†Seriesçš„ä½¿ç”¨åœºæ™¯ä»ä¸€ç»´æ‹“å±•åˆ°å¤šç»´ã€‚ ","date":"2023-07-15","objectID":"/posts/pandasnotes1/:4:0","tags":["draft"],"title":"Pandas Notes 1","uri":"/posts/pandasnotes1/"},{"categories":["Pandas"],"content":"Constructor DataFrame[data, index, columns, dtype, copy]: æ„é€ ä¸€ä¸ªDataFrameå¯¹è±¡ ","date":"2023-07-15","objectID":"/posts/pandasnotes1/:4:1","tags":["draft"],"title":"Pandas Notes 1","uri":"/posts/pandasnotes1/"},{"categories":["Pandas"],"content":"Attributes and underlying data DataFrame.index: è¡Œæ ‡ç­¾(è¡Œä¿¡æ¯)-\u003eç¬¬0åˆ—çš„ä¿¡æ¯ DataFrame.columns: åˆ—æ ‡ç­¾(åˆ—ä¿¡æ¯)-\u003e ç¬¬0è¡Œçš„ä¿¡æ¯ DataFrame.dtypes: è¿”å›DataFrameçš„æ•°æ®ç±»å‹ DataFrame.info([verbose, buf, max_cols, ...]): è¿”å›dfçš„ä¿¡æ¯ DataFrame.select_dtypes([include, exclude]): è¿”å›DataFrameä¸­æ ¹æ®columnsç­›é€‰çš„éƒ¨åˆ†æ•°æ® DataFrame.values: ä»¥numpyæ•°ç»„çš„å½¢å¼è¿”å›æ•°æ® DataFrame.axes: è¿”å›ä¸€ä¸ªlistï¼Œå…¶ä¸­æ˜¯dfçš„axes DataFrame.ndim: è¿”å›intï¼Œä»£è¡¨axes/arrayçš„æ•°é‡ DataFrame.shape: è¿”å›tuple, ä»£è¡¨dfç»´åº¦ DataFrame.memory_usage([index, deep]): è¿”å›æ•°æ®å†…å­˜ä½¿ç”¨æƒ…å†µ DataFrame.empty: åˆ¤æ–­dfæ˜¯å¦ä¸ºç©º DataFrame.set_flags(*[, copy, ...]): è¿”å›å¸¦æœ‰æ›´æ–°æ ‡è®°çš„df DataFrame.set_flags(*, copy=False, allows_duplicate_labels=None) å‚æ•°ï¼šallows_duplicate_labelsï¼šå¸ƒå°”å‹ï¼Œå¯é€‰ã€‚è¿”å›çš„å¯¹è±¡æ˜¯å¦å…è®¸é‡å¤æ ‡ç­¾ã€‚ è¿”å›ï¼šSeriesæˆ–DataFrame, ä¸è°ƒç”¨è€…ç›¸åŒçš„ç±»å‹ã€‚ æ³¨æ„ï¼šæ­¤æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯ä¸è¾“å…¥æ•°æ®ç›¸åŒçš„è§†å›¾ã€‚æ”¹å˜è¾“å…¥æˆ–è¾“å‡ºå€¼å°†åæ˜ åœ¨å¦ä¸€ä¸ªä¸­ã€‚æ­¤æ–¹æ³•æ—¨åœ¨ç”¨äºæ–¹æ³•é“¾ä¸­ã€‚â€œFlagsâ€ ä¸ â€œmetadataâ€ ä¸åŒã€‚æ ‡å¿—åæ˜ äº† pandas å¯¹è±¡(Series æˆ– DataFrame)çš„å±æ€§ã€‚å…ƒæ•°æ®æ˜¯ index æ®é›†çš„å±æ€§ï¼Œåº”å­˜å‚¨åœ¨ DataFrame.attrs ä¸­ã€‚ demo: \u003e\u003e\u003e df = pd.DataFrame({\"A\":[1, 2]}) \u003e\u003e\u003e df.flags.allows_duplicate_labels True \u003e\u003e\u003e df2 = df.set_flags(allows_duplicate_labels=False) \u003e\u003e\u003e df2.flags.allows_duplicate_labels False DataFrame.groupby(): ","date":"2023-07-15","objectID":"/posts/pandasnotes1/:4:2","tags":["draft"],"title":"Pandas Notes 1","uri":"/posts/pandasnotes1/"},{"categories":["Pandas"],"content":"Conversion DataFrame.astype(dtype[,copy, errors]):æ•°æ®ç±»å‹è½¬æ¢ DataFrame.convert_dtypes([infer_objects, ...]):æ ¹æ®ç°å­˜æ•°æ®æ¨æ–­pd.NAæ•°æ®ç±»å‹ DataFrame.infer_objects():æ ¹æ®ç°æœ‰æ•°æ®å¤§éƒ¨åˆ†æ•°æ®æ¨æ–­ç±»å‹ DataFrame.copy([deep]):æ·±åº¦æ‹·è´ demo s = pd.Series([1,2], index=[\"a\",\"b\"]) deep = s.copy()# æ·±æ‹·è´ shallow = s.copy(deep=False) # æµ…æ‹·è´ DataFrame.bool():åˆ¤æ–­æ•°æ®æ˜¯tureè¿˜æ˜¯falseï¼Œåªé’ˆå¯¹å•ä¸ªå…ƒç´ å¯¹è±¡ ","date":"2023-07-15","objectID":"/posts/pandasnotes1/:4:3","tags":["draft"],"title":"Pandas Notes 1","uri":"/posts/pandasnotes1/"},{"categories":["Pandas"],"content":"Indexingï¼Œiteration DataFrame.head([n]): return the first n rows DataFrame.at[4,'B']: ç”¨æ ‡ç­¾å–å€¼(è¡Œåä¸º4ï¼Œåˆ—åä¸ºBçš„å€¼) DataFrame.iat[1,2]: ç”¨è¡Œåˆ—çš„æ•´æ•°å–å€¼(ç¬¬1è¡Œ,ç¬¬äºŒåˆ—çš„å€¼) DataFrame.loc['cobra':'viper', 'max_speed']: å–è¡Œåä¸ºâ€™cobraâ€™è‡³â€™viperâ€™, åˆ—åä¸ºâ€™max_speedâ€™çš„å€¼ DataFrame.iloc: é€šè¿‡è¡Œåˆ—çš„å€¼å–å€¼ df.iloc[0]:å–ç¬¬0è¡Œï¼Œæ‰€æœ‰åˆ—çš„å€¼ï¼Œè¿”å›seriesç±»å‹ df.iloc[[0]]:å–å¾—ç¬¬0è¡Œï¼Œæ‰€æœ‰åˆ—çš„å€¼ï¼Œè¿”å›dfç±»å‹ df.iloc[[0,1]]:å–å¾—ç¬¬0è¡Œå’Œç¬¬1è¡Œçš„æ‰€æœ‰åˆ—çš„å€¼ df.iloc[:3]:å–å¾—ç¬¬0ï¼Œ1ï¼Œ2è¡Œçš„å€¼ df.iloc[[True, False, True]]: ç”¨True/Falseæ ‡è®°è¦å–çš„è¡Œ df.iloc[lambda x:x.index % 2 == 0]: ç”¨lambdaæ ‡è®°è¦å–çš„è¡Œ df.iloc[0,1]:å–å¾—ç¬¬0è¡Œï¼Œç¬¬1åˆ—çš„å€¼ df.iloc[[0,2],[1,3]]: å–å¾—ç¬¬0è¡Œï¼Œç¬¬2è¡Œï¼Œç¬¬1åˆ—ï¼Œç¬¬3åˆ—çš„å€¼ df.iloc[1:3, 0:3]: å–å¾—ç¬¬1è¡Œï¼Œç¬¬2è¡Œï¼Œç¬¬0åˆ—ï¼Œç¬¬1åˆ—ï¼Œç¬¬2åˆ—çš„å€¼ df.iloc[:, [True,False,True,False]]:å–æ‰€æœ‰çš„è¡Œï¼Œç”¨True/Falseå–ç›¸åº”çš„åˆ— df.iloc[:,lambda df:[0,2]]: å–æ‰€æœ‰çš„è¡Œï¼Œå–ç¬¬0åˆ—ï¼Œç¬¬2åˆ— df.insert(loc, column, value, allow_duplicates=False):æ’å…¥ç›¸åº”çš„åˆ— loc:(int), åˆ—çš„ä½ç½® column: åˆ—çš„åå­—ï¼Œä¸€èˆ¬ç±»å‹ä¸ºstring value: åˆ—æ•°æ®çš„å€¼ df.drop():åˆ é™¤å›ºå®šçš„è¡Œæˆ–è€…åˆ— df.drop_duplicates(subset, keep, inplace=False,ignore_index=False):åˆ é™¤é‡å¤çš„è¡Œæˆ–è€…åˆ— subset: æ ¹æ®æŸä¸€åˆ—çš„å€¼ï¼Œåˆ é™¤è¡Œæ•°æ® keep: è®¾ç½®ä¿ç•™ç¬¬ä¸€æ¬¡å‡ºç°çš„æ•°æ®æˆ–è€…æœ€åä¸€æ¬¡å‡ºç°çš„æ•°æ® ","date":"2023-07-15","objectID":"/posts/pandasnotes1/:4:4","tags":["draft"],"title":"Pandas Notes 1","uri":"/posts/pandasnotes1/"},{"categories":["Python"],"content":"pythonæ–‡ä»¶ç›¸å…³ ","date":"2023-07-15","objectID":"/posts/pythonnotes1/:1:0","tags":["draft"],"title":"Python Notes 1","uri":"/posts/pythonnotes1/"},{"categories":["Python"],"content":"os.pathæ¨¡å— os.path.exists(): åˆ¤æ–­å½“å‰ç›®å½•ä»¥åŠæ–‡ä»¶æ˜¯å¦å­˜åœ¨ os.path.mkdir(): è‹¥ç›®å½•æˆ–æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º import os # ç›®å½• dirs = '/Users/joseph/work/python/' if not os.path.exists(dirs): os.makedirs(dirs) # æ–‡ä»¶ filename = '/Users/joseph/work/python/poem.txt' if not os.path.exists(filename): os.system(r\"touch {}\".format(path))#è°ƒç”¨ç³»ç»Ÿå‘½ä»¤è¡Œæ¥åˆ›å»ºæ–‡ä»¶ os.listdir()ï¼š ç”¨äºè¿”å›æŒ‡å®šçš„æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„åå­—çš„åˆ—è¡¨ # æ‰“å¼€æ–‡ä»¶ path = \"/var/www/html/\" # å¦‚æœç›®å½•åå­—ä¸ºä¸­æ–‡ éœ€è¦è½¬ç å¤„ç† path = unicode(path,'utf-8') dirs = os.listdir(path) # è¾“å‡ºæ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ for file in dirs: print(file) os.path.join(): è·¯å¾„æ‹¼æ¥ import os path = \"/home\" # Join various path components print(os.path.join(path, \"User/Desktop\", \"file.txt\")) # /home/User/Desktop/file.txt path = \"User/Documents\" # Join various path components print(os.path.join(path, \"/home\", \"file.txt\")) # /home/file.txt # In above example '/home' # represents an absolute path # so all previous components i.e User / Documents # are thrown away and joining continues # from the absolute path component i.e / home. print(os.path.join(path, \"Downloads\", \"file.txt\", \"/home\")) # /home # In above example '/User' and '/home' # both represents an absolute path # but '/home' is the last value # so all previous components before '/home' # will be discarded and joining will # continue from '/home' os.path.abspath(path): è¿”å›ç»å¯¹è·¯å¾„ os.path.basename(path): è¿”å›æ–‡ä»¶å os.path.commonprefix(list): è¿”å›list(å¤šä¸ªè·¯å¾„)ä¸­ï¼Œæ‰€æœ‰pathå…±æœ‰çš„æœ€é•¿çš„è·¯å¾„ os.path.dirname(path): è¿”å›æ–‡ä»¶è·¯å¾„ os.path.expanduser(path): æŠŠpathä¸­åŒ…å«çš„\"~â€œå’Œâ€~user\"è½¬æ¢æˆç”¨æˆ·ç›®å½• os.path.expandvars(path): æ ¹æ®ç¯å¢ƒå˜é‡çš„å€¼æ›¿æ¢pathä¸­åŒ…å«çš„ â€œ$nameâ€ å’Œ â€œ${name}â€ os.path.getatime(path): è¿”å›æœ€è¿‘è®¿é—®æ—¶é—´(æµ®ç‚¹å‹ç§’æ•°) os.path.getmtime(path): è¿”å›æœ€è¿‘æ–‡ä»¶ä¿®æ”¹æ—¶é—´ os.path.getctime(path): è¿”å›æ–‡ä»¶ path åˆ›å»ºæ—¶é—´ os.path.getsize(path): è¿”å›æ–‡ä»¶å¤§å°ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨å°±è¿”å›é”™è¯¯ os.path.isfile(path): åˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºæ–‡ä»¶ os.path.isdir(path): åˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºç›®å½• os.path.islink(path): åˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºé“¾æ¥ os.path.ismount(path): åˆ¤æ–­è·¯å¾„æ˜¯å¦ä¸ºæŒ‚è½½ç‚¹ os.path.normcase(path): è½¬æ¢pathçš„å¤§å°å†™å’Œæ–œæ  os.path.normpath(path): è§„èŒƒpathå­—ç¬¦ä¸²å½¢å¼ os.path.realpath(path): è¿”å›pathçš„çœŸå®è·¯å¾„ os.path.relpath(path[, start]): ä»startå¼€å§‹è®¡ç®—ç›¸å¯¹è·¯å¾„ os.path.samefile(path1, path2): åˆ¤æ–­ç›®å½•æˆ–æ–‡ä»¶æ˜¯å¦ç›¸åŒ os.path.sameopenfile(fp1, fp2): åˆ¤æ–­fp1å’Œfp2æ˜¯å¦æŒ‡å‘åŒä¸€æ–‡ä»¶ os.path.samestat(stat1, stat2): åˆ¤æ–­stat tuple stat1å’Œstat2æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ os.path.split(path): æŠŠè·¯å¾„åˆ†å‰²æˆ dirname å’Œ basenameï¼Œè¿”å›ä¸€ä¸ªå…ƒç»„ os.path.splitdrive(path): ä¸€èˆ¬ç”¨åœ¨ windows ä¸‹ï¼Œè¿”å›é©±åŠ¨å™¨åå’Œè·¯å¾„ç»„æˆçš„å…ƒç»„ os.path.splitext(path): åˆ†å‰²è·¯å¾„ï¼Œè¿”å›è·¯å¾„åå’Œæ–‡ä»¶æ‰©å±•åçš„å…ƒç»„ os.path.splitunc(path): æŠŠè·¯å¾„åˆ†å‰²ä¸ºåŠ è½½ç‚¹ä¸æ–‡ä»¶ os.path.walk(path, visit, arg): éå†pathï¼Œè¿›å…¥æ¯ä¸ªç›®å½•éƒ½è°ƒç”¨visitå‡½æ•°ï¼Œvisitå‡½æ•°å¿…é¡»æœ‰3ä¸ªå‚æ•°(arg, dirname, names)ï¼Œdirnameè¡¨ç¤ºå½“å‰ç›®å½•çš„ç›®å½•åï¼Œnamesä»£è¡¨å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åï¼Œargsåˆ™ä¸ºwalkçš„ç¬¬ä¸‰ä¸ªå‚æ•° os.walk(path,topdown=True,onerror=None): å‡½æ•°è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œå«æœ‰ä¸‰ä¸ªå…ƒç´ ã€‚è¿™ä¸‰ä¸ªå…ƒç´ åˆ†åˆ«æ˜¯ï¼šæ¯æ¬¡éå†çš„è·¯å¾„åã€è·¯å¾„ä¸‹å­ç›®å½•åˆ—è¡¨ã€ç›®å½•ä¸‹æ–‡ä»¶åˆ—è¡¨ã€‚ path = 'xxx/xxx' for root, dirs, files in os.walk(path): print(root) # pathä»¥åŠpathä¸‹çš„ç›®å½• print(dirs) # pathä¸‹çš„æ–‡ä»¶å¤¹ print(files) # pathä¸‹æ¯ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ åŒºåˆ«ï¼šos.path.walk()ä¸os.walk()äº§ç”Ÿçš„æ–‡ä»¶ååˆ—è¡¨å¹¶ä¸ç›¸åŒ.os.walk()äº§ç”Ÿç›®å½•æ ‘ä¸‹çš„ç›®å½•è·¯å¾„å’Œæ–‡ä»¶è·¯å¾„ï¼Œè€Œos.path.walk()åªäº§ç”Ÿæ–‡ä»¶è·¯å¾„ï¼ˆæ˜¯å­ç›®å½•ä¸æ–‡ä»¶çš„æ··åˆåˆ—è¡¨ï¼‰ã€‚ ref: https://www.cnblogs.com/zmlctt/p/4222621.html os.path.supports_unicode_filenames: è®¾ç½®æ˜¯å¦æ”¯æŒunicodeè·¯å¾„å ","date":"2023-07-15","objectID":"/posts/pythonnotes1/:1:1","tags":["draft"],"title":"Python Notes 1","uri":"/posts/pythonnotes1/"},{"categories":["draft"],"content":"ref: [1] https://chenllliang.github.io/2020/02/04/dataloader/ [2] https://blog.csdn.net/zyq12345678/article/details/90268668 [3] https://cloud.tencent.com/developer/article/1877393 ","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:0:0","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"Dataset PyTorchä¸ºæˆ‘ä»¬æä¾›çš„ä¸¤ä¸ªDatasetå’ŒDataLoaderç±»åˆ†åˆ«è´Ÿè´£å¯è¢«Pytorchä½¿ç”¨çš„æ•°æ®é›†çš„åˆ›å»ºä»¥åŠå‘è®­ç»ƒä¼ é€’æ•°æ®çš„ä»»åŠ¡ã€‚å¦‚æœæƒ³ä¸ªæ€§åŒ–è‡ªå·±çš„æ•°æ®é›†æˆ–è€…æ•°æ®ä¼ é€’æ–¹å¼ï¼Œä¹Ÿå¯ä»¥è‡ªå·±é‡å†™å­ç±»ã€‚ Datasetæ˜¯DataLoaderå®ä¾‹åŒ–çš„ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¼šå…ˆä»Datasetçš„æºä»£ç è®²èµ·ï¼Œç„¶åè®²åˆ°DataLoaderï¼Œå…³æ³¨ä¸»è¦å‡½æ•°ï¼Œå°‘ç»†ææœ«èŠ‚ï¼Œç›®çš„æ˜¯ä½¿å¤§å®¶å­¦ä¼šè‡ªå®šä¹‰è‡ªå·±çš„æ•°æ®é›†ã€‚ ","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:1:0","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"ä»€ä¹ˆæ—¶å€™ä½¿ç”¨Dataset CIFAR10æ˜¯CVè®­ç»ƒä¸­ç»å¸¸ä½¿ç”¨åˆ°çš„ä¸€ä¸ªæ•°æ®é›†ï¼Œåœ¨PyTorchä¸­CIFAR10æ˜¯ä¸€ä¸ªå†™å¥½çš„Datasetï¼Œæˆ‘ä»¬ä½¿ç”¨æ—¶åªéœ€ä»¥ä¸‹ä»£ç ï¼š data = datasets.CIFAR10(\"./data/\", transform=transform, train=True, download=True) datasets.CIFAR10å°±æ˜¯ä¸€ä¸ªDatasetså­ç±»ï¼Œdataæ˜¯è¿™ä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚ æˆ‘ä»¬æœ‰çš„æ—¶å€™éœ€è¦ç”¨è‡ªå·±åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ•°æ®ä½œä¸ºæ•°æ®é›†ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ImageFolderè¿™ä¸ªæ–¹ä¾¿çš„APIã€‚ FaceDataset = datasets.ImageFolder('./data', transform=img_transform) ","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:1:1","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"å¦‚ä½•å®šä¹‰ä¸€ä¸ªè‡ªå·±çš„æ•°æ®é›†åˆ torch.utils.data.dataset æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ•°æ®é›†çš„æŠ½è±¡ç±»ã€‚ä»»ä½•è‡ªå®šä¹‰çš„æ•°æ®é›†éƒ½éœ€è¦ç»§æ‰¿è¿™ä¸ªç±»å¹¶è¦†å†™ç›¸å…³æ–¹æ³•ã€‚ æ‰€è°“æ•°æ®é›†ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªè´Ÿè´£å¤„ç†ç´¢å¼•(index)åˆ°æ ·æœ¬(sample)æ˜ å°„çš„ä¸€ä¸ªç±»(class)ã€‚ Pytorchæä¾›ä¸¤ç§æ•°æ®é›†ï¼š Mapå¼æ•°æ®é›† Iterableå¼æ•°æ®é›† Mapå¼æ•°æ®é›† ä¸€ä¸ªMapå¼çš„æ•°æ®é›†å¿…é¡»è¦é‡å†™__getitem__(self, index), len(self) ä¸¤ä¸ªå†…å»ºæ–¹æ³•ï¼Œç”¨æ¥è¡¨ç¤ºä»ç´¢å¼•åˆ°æ ·æœ¬çš„æ˜ å°„(Map). è¿™æ ·ä¸€ä¸ªæ•°æ®é›†datasetï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½¿ç”¨dataset[idx]å‘½ä»¤æ—¶ï¼Œå¯ä»¥åœ¨ä½ çš„ç¡¬ç›˜ä¸­è¯»å–ä½ çš„æ•°æ®é›†ä¸­ç¬¬idxå¼ å›¾ç‰‡ä»¥åŠå…¶æ ‡ç­¾ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰;len(dataset)åˆ™ä¼šè¿”å›è¿™ä¸ªæ•°æ®é›†çš„å®¹é‡ã€‚ ä¾‹å­-1ï¼š è‡ªå·±å®éªŒä¸­å†™çš„ä¸€ä¸ªä¾‹å­ï¼šè¿™é‡Œæˆ‘ä»¬çš„å›¾ç‰‡æ–‡ä»¶å‚¨å­˜åœ¨â€œ./data/faces/â€æ–‡ä»¶å¤¹ä¸‹ï¼Œå›¾ç‰‡çš„åå­—å¹¶ä¸æ˜¯ä»1å¼€å§‹ï¼Œè€Œæ˜¯ä»final_train_tag_dict.txtè¿™ä¸ªæ–‡ä»¶ä¿å­˜çš„å­—å…¸ä¸­è¯»å–ï¼Œlabelä¿¡æ¯ä¹Ÿæ˜¯ç”¨è¿™ä¸ªæ–‡ä»¶ä¸­è¯»å–ã€‚å¤§å®¶å¯ä»¥ç…§ç€ä¸Šé¢çš„æ³¨é‡Šé˜…è¯»è¿™æ®µä»£ç ã€‚ from torch.utils import data import numpy as np from PIL import Image class face_dataset(data.Dataset): def __init__(self): self.file_path = './data/faces/' f=open(\"final_train_tag_dict.txt\",\"r\") self.label_dict=eval(f.read()) f.close() def __getitem__(self,index): label = list(self.label_dict.values())[index-1] img_id = list(self.label_dict.keys())[index-1] img_path = self.file_path+str(img_id)+\".jpg\" img = np.array(Image.open(img_path)) return img,label def __len__(self): return len(self.label_dict) ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹å®˜æ–¹MNISTæ•°æ®é›†çš„ä¾‹å­ class MNIST(data.Dataset): \"\"\"`MNIST \u003chttp://yann.lecun.com/exdb/mnist/\u003e`_ Dataset. Args: root (string): Root directory of dataset where ``processed/training.pt`` and ``processed/test.pt`` exist. train (bool, optional): If True, creates dataset from ``training.pt``, otherwise from ``test.pt``. download (bool, optional): If true, downloads the dataset from the internet and puts it in root directory. If dataset is already downloaded, it is not downloaded again. transform (callable, optional): A function/transform that takes in an PIL image and returns a transformed version. E.g, ``transforms.RandomCrop`` target_transform (callable, optional): A function/transform that takes in the target and transforms it. \"\"\" urls = [ 'http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz', 'http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz', 'http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz', 'http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz', ] raw_folder = 'raw' processed_folder = 'processed' training_file = 'training.pt' test_file = 'test.pt' classes = ['0 - zero', '1 - one', '2 - two', '3 - three', '4 - four', '5 - five', '6 - six', '7 - seven', '8 - eight', '9 - nine'] class_to_idx = {_class: i for i, _class in enumerate(classes)} @property def targets(self): if self.train: return self.train_labels else: return self.test_labels def __init__(self, root, train=True, transform=None, target_transform=None, download=False): self.root = os.path.expanduser(root) self.transform = transform self.target_transform = target_transform self.train = train # training set or test set if download: self.download() if not self._check_exists(): raise RuntimeError('Dataset not found.' + ' You can use download=True to download it') if self.train: self.train_data, self.train_labels = torch.load( os.path.join(self.root, self.processed_folder, self.training_file)) else: self.test_data, self.test_labels = torch.load( os.path.join(self.root, self.processed_folder, self.test_file)) def __getitem__(self, index): \"\"\" Args: index (int): Index Returns: tuple: (image, target) where target is index of the target class. \"\"\" if self.train: img, target = self.train_data[index], self.train_labels[index] else: img, target = self.test_data[index], self.test_labels[index] # doing this so that it is consistent with all other datasets # to return a PIL Image img = Image.fromarray(img.numpy(), mode='L') if self.transform is not None: img = self.transform(img) if self.target_transform is not None: target = self.target_transform(target) return img, target def __len__(self): if self.train: return len(self.train_data) else: return len(self.test_data) def _check_exists(self): return os.path.exists(os.path.join(self.root, self.processed_folder, self.training_file)) and \\ os.path.exists(os.path.join(self.root, self.processed_folder, self.test_file)) def download(self): \"\"\"Download the MNIST data if it doesn't exist in processed_folder already.\"\"\" from s","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:1:2","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"Iterableæ•°æ®é›† ä¸€ä¸ªIterableï¼ˆè¿­ä»£ï¼‰å¼æ•°æ®é›†æ˜¯æŠ½è±¡ç±»data.IterableDatasetçš„å­ç±»ï¼Œå¹¶ä¸”è¦†å†™äº†__iter__æ–¹æ³•æˆä¸ºä¸€ä¸ªè¿­ä»£å™¨ã€‚è¿™ç§æ•°æ®é›†ä¸»è¦ç”¨äºæ•°æ®å¤§å°æœªçŸ¥ï¼Œæˆ–è€…ä»¥æµçš„å½¢å¼çš„è¾“å…¥ï¼Œæœ¬åœ°æ–‡ä»¶ä¸å›ºå®šçš„æƒ…å†µï¼Œéœ€è¦ä»¥è¿­ä»£çš„æ–¹å¼æ¥è·å–æ ·æœ¬ç´¢å¼•ã€‚ å…³äºè¿­ä»£å™¨ä¸ç”Ÿæˆå™¨çš„çŸ¥è¯†å¯ä»¥å‚è§åšä¸»çš„å¦ä¸€ç¯‡æ–‡ç« Pythonè¿­ä»£å™¨ä¸ç”Ÿæˆå™¨ä»‹ç»åŠåœ¨Pytorchæºç ä¸­åº”ç”¨[https://chenllliang.github.io/2020/02/06/PyIter/]ã€‚ ","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:1:3","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"DataLoader Data loader. Combines a dataset and a sampler, and provides an iterable over the given dataset. â€“PyTorch Documents ä¸€èˆ¬æ¥è¯´PyTorchä¸­æ·±åº¦å­¦ä¹ è®­ç»ƒçš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š åˆ›å»ºDateset Datasetä¼ é€’ç»™DataLoader DataLoaderè¿­ä»£äº§ç”Ÿè®­ç»ƒæ•°æ®æä¾›ç»™æ¨¡å‹ å¯¹åº”çš„ä¸€èˆ¬éƒ½ä¼šæœ‰è¿™ä¸‰éƒ¨åˆ†ä»£ç  # åˆ›å»ºDateset(å¯ä»¥è‡ªå®šä¹‰) dataset = face_dataset # Datasetéƒ¨åˆ†è‡ªå®šä¹‰è¿‡çš„face_dataset # Datasetä¼ é€’ç»™DataLoader dataloader = torch.utils.data.DataLoader(dataset,batch_size=64,shuffle=False,num_workers=8) # DataLoaderè¿­ä»£äº§ç”Ÿè®­ç»ƒæ•°æ®æä¾›ç»™æ¨¡å‹ for i in range(epoch): for index,(img,label) in enumerate(dataloader): pass åˆ°è¿™é‡Œåº”è¯¥å°±PyTorchçš„æ•°æ®é›†å’Œæ•°æ®ä¼ é€’æœºåˆ¶åº”è¯¥å°±æ¯”è¾ƒæ¸…æ™°æ˜äº†äº†ã€‚Datasetè´Ÿè´£å»ºç«‹ç´¢å¼•åˆ°æ ·æœ¬çš„æ˜ å°„ï¼ŒDataLoaderè´Ÿè´£ä»¥ç‰¹å®šçš„æ–¹å¼ä»æ•°æ®é›†ä¸­è¿­ä»£çš„äº§ç”Ÿ ä¸€ä¸ªä¸ªbatchçš„æ ·æœ¬é›†åˆã€‚åœ¨enumerateè¿‡ç¨‹ä¸­å®é™…ä¸Šæ˜¯dataloaderæŒ‰ç…§å…¶å‚æ•°samplerè§„å®šçš„ç­–ç•¥è°ƒç”¨äº†å…¶datasetçš„getitemæ–¹æ³•ã€‚ ","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:2:0","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"å‚æ•°ä»‹ç» å…ˆçœ‹ä¸€ä¸‹å®ä¾‹åŒ–ä¸€ä¸ªDataLoaderæ‰€éœ€çš„å‚æ•°ï¼Œæˆ‘ä»¬åªå…³æ³¨å‡ ä¸ªé‡ç‚¹å³å¯ã€‚ DataLoader(dataset, batch_size=1, shuffle=False, sampler=None, batch_sampler=None, num_workers=0, collate_fn=None, pin_memory=False, drop_last=False, timeout=0, worker_init_fn=None) å‚æ•°ä»‹ç»: dataset (Dataset) â€“ å®šä¹‰å¥½çš„Mapå¼æˆ–è€…Iterableå¼æ•°æ®é›†ã€‚ batch_size (python:int, optional) â€“ ä¸€ä¸ªbatchå«æœ‰å¤šå°‘æ ·æœ¬ (default: 1)ã€‚ shuffle (bool, optional) â€“ æ¯ä¸€ä¸ªepochçš„batchæ ·æœ¬æ˜¯ç›¸åŒè¿˜æ˜¯éšæœº (default: False)ã€‚ sampler (Sampler, optional) â€“ å†³å®šæ•°æ®é›†ä¸­é‡‡æ ·çš„æ–¹æ³•. å¦‚æœæœ‰ï¼Œåˆ™shuffleå‚æ•°å¿…é¡»ä¸ºFalseã€‚ batch_sampler (Sampler, optional) â€“ å’Œ sampler ç±»ä¼¼ï¼Œä½†æ˜¯ä¸€æ¬¡è¿”å›çš„æ˜¯ä¸€ä¸ªbatchå†…æ‰€æœ‰æ ·æœ¬çš„indexã€‚å’Œ batch_size, shuffle, sampler, and drop_last ä¸‰ä¸ªå‚æ•°äº’æ–¥ã€‚ num_workers (python:int, optional) â€“ å¤šå°‘ä¸ªå­ç¨‹åºåŒæ—¶å·¥ä½œæ¥è·å–æ•°æ®ï¼Œå¤šçº¿ç¨‹ã€‚ (default: 0) collate_fn (callable, optional) â€“ åˆå¹¶æ ·æœ¬åˆ—è¡¨ä»¥å½¢æˆå°æ‰¹é‡ã€‚ pin_memory (bool, optional) â€“ å¦‚æœä¸ºTrueï¼Œæ•°æ®åŠ è½½å™¨åœ¨è¿”å›å‰å°†å¼ é‡å¤åˆ¶åˆ°CUDAå›ºå®šå†…å­˜ä¸­ã€‚ drop_last (bool, optional) â€“ å¦‚æœæ•°æ®é›†å¤§å°ä¸èƒ½è¢«batch_sizeæ•´é™¤ï¼Œè®¾ç½®ä¸ºTrueå¯åˆ é™¤æœ€åä¸€ä¸ªä¸å®Œæ•´çš„æ‰¹å¤„ç†ã€‚å¦‚æœè®¾ä¸ºFalseå¹¶ä¸”æ•°æ®é›†çš„å¤§å°ä¸èƒ½è¢«batch_sizeæ•´é™¤ï¼Œåˆ™æœ€åä¸€ä¸ªbatchå°†æ›´å°ã€‚(default: False) timeout (numeric, optional) â€“ å¦‚æœæ˜¯æ­£æ•°ï¼Œè¡¨æ˜ç­‰å¾…ä»workerè¿›ç¨‹ä¸­æ”¶é›†ä¸€ä¸ªbatchç­‰å¾…çš„æ—¶é—´ï¼Œè‹¥è¶…å‡ºè®¾å®šçš„æ—¶é—´è¿˜æ²¡æœ‰æ”¶é›†åˆ°ï¼Œé‚£å°±ä¸æ”¶é›†è¿™ä¸ªå†…å®¹äº†ã€‚è¿™ä¸ªnumericåº”æ€»æ˜¯å¤§äºç­‰äº0ã€‚ (default: 0) worker_init_fn (callable, optional) â€“ æ¯ä¸ªworkeråˆå§‹åŒ–å‡½æ•° (default: None) dataset æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå¾ˆé‡è¦ï¼Œéœ€è¦æŒ‰ç…§å‰é¢æ‰€è¯´çš„ä¸¤ç§datasetå®šä¹‰å¥½ï¼Œå®Œæˆç›¸å…³å‡½æ•°çš„é‡å†™ã€‚ batch_size ä¹Ÿæ²¡å•¥å¥½è¯´çš„ï¼Œå°±æ˜¯è®­ç»ƒçš„ä¸€ä¸ªæ‰¹æ¬¡çš„æ ·æœ¬æ•°ã€‚ shuffle è¡¨ç¤ºæ¯ä¸€ä¸ªepochä¸­è®­ç»ƒæ ·æœ¬çš„é¡ºåºæ˜¯å¦ç›¸åŒï¼Œä¸€èˆ¬Trueã€‚ ","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:3:0","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"é‡‡æ ·å™¨ sampler é‡ç‚¹å‚æ•°ï¼Œé‡‡æ ·å™¨ï¼Œæ˜¯ä¸€ä¸ªè¿­ä»£å™¨ã€‚PyTorchæä¾›äº†å¤šç§é‡‡æ ·å™¨ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é‡‡æ ·å™¨ã€‚ æ‰€æœ‰sampleréƒ½æ˜¯ç»§æ‰¿ torch.utils.data.sampler.Samplerè¿™ä¸ªæŠ½è±¡ç±»ã€‚ å…³äºè¿­ä»£å™¨çš„åŸºç¡€çŸ¥è¯†åœ¨åšä¸»è¿™ç¯‡æ–‡ç« ä¸­å¯ä»¥æ‰¾åˆ°Pythonè¿­ä»£å™¨ä¸ç”Ÿæˆå™¨ä»‹ç»åŠåœ¨Pytorchæºç ä¸­åº”ç”¨ã€‚[] class Sampler(object): # \"\"\"Base class for all Samplers. # Every Sampler subclass has to provide an __iter__ method, providing a way # to iterate over indices of dataset elements, and a __len__ method that # returns the length of the returned iterators. # \"\"\" # ä¸€ä¸ª è¿­ä»£å™¨ åŸºç±» def __init__(self, data_source): pass def __iter__(self): raise NotImplementedError def __len__(self): raise NotImplementedError PyTorchè‡ªå¸¦çš„Sampler SequentialSampler RandomSampler SubsetRandomSampler WeightedRandomSampler SequentialSampler å¾ˆå¥½ç†è§£å°±æ˜¯é¡ºåºé‡‡æ ·å™¨ã€‚ å…¶åŸç†æ˜¯é¦–å…ˆåœ¨åˆå§‹åŒ–çš„æ—¶å€™æ‹¿åˆ°æ•°æ®é›†data_sourceï¼Œä¹‹ååœ¨__iter__æ–¹æ³•ä¸­é¦–å…ˆå¾—åˆ°ä¸€ä¸ªå’Œdata_sourceä¸€æ ·é•¿åº¦çš„rangeå¯è¿­ä»£å™¨ã€‚æ¯æ¬¡åªä¼šè¿”å›ä¸€ä¸ªç´¢å¼•å€¼ã€‚ class SequentialSampler(Sampler): # r\"\"\"Samples elements sequentially, always in the same order. # Arguments: # data_source (Dataset): dataset to sample from # \"\"\" # äº§ç”Ÿé¡ºåº è¿­ä»£å™¨ def __init__(self, data_source): self.data_source = data_source def __iter__(self): return iter(range(len(self.data_source))) def __len__(self): return len(self.data_source) å‚æ•°ä½œç”¨: data_source: åŒä¸Š num_sampler: æŒ‡å®šé‡‡æ ·çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯æ‰€æœ‰ã€‚ replacement: è‹¥ä¸ºTrueï¼Œåˆ™è¡¨ç¤ºå¯ä»¥é‡å¤é‡‡æ ·ï¼Œå³åŒä¸€ä¸ªæ ·æœ¬å¯ä»¥é‡å¤é‡‡æ ·ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æœ‰çš„æ ·æœ¬é‡‡æ ·ä¸åˆ°ã€‚æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬å¯ä»¥è®¾ç½®num_samplesæ¥å¢åŠ é‡‡æ ·æ•°é‡ä½¿å¾—æ¯ä¸ªæ ·æœ¬éƒ½å¯èƒ½è¢«é‡‡æ ·åˆ°ã€‚ class RandomSampler(Sampler): # r\"\"\"Samples elements randomly. If without replacement, then sample from a shuffled dataset. # If with replacement, then user can specify ``num_samples`` to draw. # Arguments: # data_source (Dataset): dataset to sample from # num_samples (int): number of samples to draw, default=len(dataset) # replacement (bool): samples are drawn with replacement if ``True``, default=False # \"\"\" def __init__(self, data_source, replacement=False, num_samples=None): self.data_source = data_source self.replacement = replacement self.num_samples = num_samples if self.num_samples is not None and replacement is False: raise ValueError(\"With replacement=False, num_samples should not be specified, \" \"since a random permute will be performed.\") if self.num_samples is None: self.num_samples = len(self.data_source) if not isinstance(self.num_samples, int) or self.num_samples \u003c= 0: raise ValueError(\"num_samples should be a positive integeral \" \"value, but got num_samples={}\".format(self.num_samples)) if not isinstance(self.replacement, bool): raise ValueError(\"replacement should be a boolean value, but got \" \"replacement={}\".format(self.replacement)) def __iter__(self): n = len(self.data_source) if self.replacement: return iter(torch.randint(high=n, size=(self.num_samples,), dtype=torch.int64).tolist()) return iter(torch.randperm(n).tolist()) def __len__(self): return len(self.data_source) è¿™ä¸ªé‡‡æ ·å™¨å¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯å°†è®­ç»ƒé›†åˆ’åˆ†æˆè®­ç»ƒé›†å’ŒéªŒè¯é›†: class SubsetRandomSampler(Sampler): # r\"\"\"Samples elements randomly from a given list of indices, without replacement. # Arguments: # indices (sequence): a sequence of indices # \"\"\" def __init__(self, indices): self.indices = indices def __iter__(self): return (self.indices[i] for i in torch.randperm(len(self.indices))) def __len__(self): return len(self.indices) batch_sampler å‰é¢çš„é‡‡æ ·å™¨æ¯æ¬¡éƒ½åªè¿”å›ä¸€ä¸ªç´¢å¼•ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è®­ç»ƒæ—¶æ˜¯å¯¹æ‰¹é‡çš„æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œè€Œè¿™ä¸ªå·¥ä½œå°±éœ€è¦BatchSampleræ¥åšã€‚ä¹Ÿå°±æ˜¯è¯´BatchSamplerçš„ä½œç”¨å°±æ˜¯å°†å‰é¢çš„Sampleré‡‡æ ·å¾—åˆ°çš„ç´¢å¼•å€¼è¿›è¡Œåˆå¹¶ï¼Œå½“æ•°é‡ç­‰äºä¸€ä¸ªbatchå¤§å°åå°±å°†è¿™ä¸€æ‰¹çš„ç´¢å¼•å€¼è¿”å›ã€‚ class BatchSampler(Sampler): # Wraps another sampler to yield a mini-batch of indices. # Args: # sampler (Sampler): Base sampler. # batch_size (int): Size of mini-batch. # drop_last (bool): If ``True``, the sampler will drop the last batch if # its size would be less than ``batch_size`` # Example: # \u003e\u003e\u003e list(BatchSampler(SequentialSampler(range(10)), batch_size=3, drop_last=False)) # [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9]] # \u003e\u003e\u003e list(BatchSampler(SequentialSampler(range(10)), batch_size=3, drop_last=True)) # [[0, 1, 2], [3, 4, 5], [6, 7, 8]] # æ‰¹æ¬¡é‡‡æ · def __init__(self, sampler, batch_size, drop_last): if not isinstance(sampler, Sampler): raise ValueError(\"sampler should be an instance of \" \"torch.utils.data.Sampler, but got sampler={}\" .format(sampler)) if","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:3:1","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"å¤šçº¿ç¨‹ num_workers å‚æ•°è¡¨ç¤ºåŒæ—¶å‚ä¸æ•°æ®è¯»å–çš„çº¿ç¨‹æ•°é‡ï¼Œå¤šçº¿ç¨‹æŠ€æœ¯å¯ä»¥åŠ å¿«æ•°æ®è¯»å–ï¼Œæä¾›GPU/CPUåˆ©ç”¨ç‡ã€‚ æœªæ¥ä¼šå‡ºä¸€ç¯‡æ–‡ç« è®²ä¸€è®²PyTorchå¤šçº¿ç¨‹å®ç°çš„åŸç†ã€‚ ","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:3:2","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"DataLoader å’Œ Dataset ç®€å•ä¸¾ä¾‹ # construct dataset import torch from torch.utils.data import Dataset,DataLoader class MyDataset(Dataset): def __init__(self): self.data = torch.tensor([[1,2,3],[2,3,4],[3,4,5],[4,5,6]]) self.label = torch.LongTensor([1,1,0,0]) def __getitem__(self,index): return self.data[index],self.label[index] def __len__(self): return len(self.data) # dataloader mydataloader = DataLoader(dataset=mydataset, batch_size = 2, shuffle=True) for i, (data, label) in enumerate(mydataloader): print(data, label) ","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:3:3","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"DEMO1 - MLPâ€™s Dataset and DataLoader dim_output = 2 class TrainValidDataset(Dataset): ''' Args: - root_dir (string): Directory containing all folders with different dates, each folder containing .cruise.h5 data files. ''' def __init__(self, list_of_files): self.list_of_files_ = list_of_files self.data_size_until_this_file_ = [] self.dataset_size = 0 for file in self.list_of_files_: with h5py.File(file, 'r') as h5_file: data_size = h5_file[list(h5_file.keys())[0]].shape[0] self.dataset_size += data_size self.data_size_until_this_file_.append(self.dataset_size) print ('Total size of dataset: {}'.format(self.data_size_until_this_file_)) def __len__(self): return self.dataset_size def __getitem__(self, index): bin_idx = self.FindBin(index, 0, len( self.data_size_until_this_file_)-1) with h5py.File(self.list_of_files_[bin_idx], 'r') as h5_file: idx_offset = self.data_size_until_this_file_[bin_idx] - \\ h5_file[list(h5_file.keys())[0]].shape[0] data = h5_file[list(h5_file.keys())[0]][index-idx_offset] label = data[-dim_output:] label[0] = (label[0] \u003e 0.0).astype(float) return data[:-dim_output], label # Binary search to expedite the data-loading process. def FindBin(self, index, start, end): if (start == end): return start mid = int((start+end)/2.0) if (self.data_size_until_this_file_[mid] \u003c= index): return self.FindBin(index, mid+1, end) else: return self.FindBin(index, start, mid) # search all the files in the directory def getListOfFiles(dirName): listOfFiles = os.listdir(dirName) allFiles = list() for entry in listOfFiles: fullPath = os.path.join(dirName, entry) if os.path.isdir(fullPath): allFiles = allFiles + getListOfFiles(fullPath) else: allFiles.append(fullPath) return allFiles if __name__ == '__main__': list_of_training_files = getListOfFiles('data') train_dataset = TrainValidDataset(list_of_training_files) myDataLoader = DataLoader(dataset=train_dataset, batch_size=2, drop_last=True, shuffle=True) for i, (data, label) in enumerate(myDataLoader): print(data.shape) ","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:4:0","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["draft"],"content":"DEMO2 - LaneGCNâ€™s Dataset and DataLoader dataset description: class ArgoDataset(Dataset): def __init__(self, split, config, train=True): self.config = config self.train = train if 'preprocess' in config and config['preprocess']: if train: self.split = np.load(self.config['preprocess_train'], allow_pickle=True) else: self.split = np.load(self.config['preprocess_val'], allow_pickle=True) else: self.avl = ArgoverseForecastingLoader(split) self.avl.seq_list = sorted(self.avl.seq_list) self.am = ArgoverseMap() if 'raster' in config and config['raster']: #TODO: DELETE self.map_query = MapQuery(config['map_scale']) def __getitem__(self, idx): if 'preprocess' in self.config and self.config['preprocess']: data = self.split[idx] if self.train and self.config['rot_aug']: new_data = dict() for key in ['city', 'orig', 'gt_preds', 'has_preds']: if key in data: new_data[key] = ref_copy(data[key]) dt = np.random.rand() * self.config['rot_size']#np.pi * 2.0 theta = data['theta'] + dt new_data['theta'] = theta new_data['rot'] = np.asarray([ [np.cos(theta), -np.sin(theta)], [np.sin(theta), np.cos(theta)]], np.float32) rot = np.asarray([ [np.cos(-dt), -np.sin(-dt)], [np.sin(-dt), np.cos(-dt)]], np.float32) new_data['feats'] = data['feats'].copy() new_data['feats'][:, :, :2] = np.matmul(new_data['feats'][:, :, :2], rot) new_data['ctrs'] = np.matmul(data['ctrs'], rot) graph = dict() for key in ['num_nodes', 'turn', 'control', 'intersect', 'pre', 'suc', 'lane_idcs', 'left_pairs', 'right_pairs', 'left', 'right']: graph[key] = ref_copy(data['graph'][key]) graph['ctrs'] = np.matmul(data['graph']['ctrs'], rot) graph['feats'] = np.matmul(data['graph']['feats'], rot) new_data['graph'] = graph data = new_data else: new_data = dict() for key in ['city', 'orig', 'gt_preds', 'has_preds', 'theta', 'rot', 'feats', 'ctrs', 'graph']: if key in data: new_data[key] = ref_copy(data[key]) data = new_data if 'raster' in self.config and self.config['raster']: data.pop('graph') x_min, x_max, y_min, y_max = self.config['pred_range'] cx, cy = data['orig'] region = [cx + x_min, cx + x_max, cy + y_min, cy + y_max] raster = self.map_query.query(region, data['theta'], data['city']) data['raster'] = raster return data data = self.read_argo_data(idx) data = self.get_obj_feats(data) data['idx'] = idx if 'raster' in self.config and self.config['raster']: x_min, x_max, y_min, y_max = self.config['pred_range'] cx, cy = data['orig'] region = [cx + x_min, cx + x_max, cy + y_min, cy + y_max] raster = self.map_query.query(region, data['theta'], data['city']) data['raster'] = raster return data data['graph'] = self.get_lane_graph(data) return data def __len__(self): if 'preprocess' in self.config and self.config['preprocess']: return len(self.split) else: return len(self.avl) def read_argo_data(self, idx): city = copy.deepcopy(self.avl[idx].city) \"\"\"TIMESTAMP,TRACK_ID,OBJECT_TYPE,X,Y,CITY_NAME\"\"\" df = copy.deepcopy(self.avl[idx].seq_df) agt_ts = np.sort(np.unique(df['TIMESTAMP'].values)) mapping = dict() for i, ts in enumerate(agt_ts): mapping[ts] = i trajs = np.concatenate(( df.X.to_numpy().reshape(-1, 1), df.Y.to_numpy().reshape(-1, 1)), 1) steps = [mapping[x] for x in df['TIMESTAMP'].values] steps = np.asarray(steps, np.int64) objs = df.groupby(['TRACK_ID', 'OBJECT_TYPE']).groups keys = list(objs.keys()) obj_type = [x[1] for x in keys] agt_idx = obj_type.index('AGENT') idcs = objs[keys[agt_idx]] agt_traj = trajs[idcs] agt_step = steps[idcs] del keys[agt_idx] ctx_trajs, ctx_steps = [], [] for key in keys: idcs = objs[key] ctx_trajs.append(trajs[idcs]) ctx_steps.append(steps[idcs]) data = dict() data['city'] = city data['trajs'] = [agt_traj] + ctx_trajs data['steps'] = [agt_step] + ctx_steps return data def get_obj_feats(self, data): orig = data['trajs'][0][19].copy().astype(np.float32) if self.train and self.config['rot_aug']: theta = np.random.rand() * np.pi * 2.0 else: pre = data['trajs'][0][18] - orig theta = np.pi - np.arctan2(pre[1], pre[0]) rot = np.asarray([ [np.cos(theta), -np","date":"2023-07-15","objectID":"/posts/datasetanddataloader/:5:0","tags":["draft"],"title":"PyTorch Dataset And DataLoader","uri":"/posts/datasetanddataloader/"},{"categories":["PyTorch"],"content":"Torch åŸºæœ¬å‡½æ•° ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:1:0","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"1. torch.einsum() torch.einsum(equation, *operands)-\u003eTensor:çˆ±å› æ–¯å¦æ±‚å’Œ ref1: ç®—å­éƒ¨ç½²: https://blog.csdn.net/HW140701/article/details/120654252 ref2: ä¾‹å­: https://zhuanlan.zhihu.com/p/361209187 ä¸‰æ¡åŸºæœ¬è§„åˆ™: è§„åˆ™ä¸€: equation ç®­å¤´å·¦è¾¹ï¼Œåœ¨ä¸åŒè¾“å…¥ä¹‹é—´é‡å¤å‡ºç°çš„ç´¢å¼•è¡¨ç¤ºï¼ŒæŠŠè¾“å…¥å¼ é‡æ²¿ç€è¯¥ç»´åº¦åšä¹˜æ³•æ“ä½œï¼Œæ¯”å¦‚è¿˜æ˜¯ä»¥ä¸Šé¢çŸ©é˜µä¹˜æ³•ä¸ºä¾‹ï¼Œ â€œik,kj-\u003eijâ€ï¼Œk åœ¨è¾“å…¥ä¸­é‡å¤å‡ºç°ï¼Œæ‰€ä»¥å°±æ˜¯æŠŠ a å’Œ b æ²¿ç€ k è¿™ä¸ªç»´åº¦ä½œç›¸ä¹˜æ“ä½œï¼› è§„åˆ™äºŒ: åªå‡ºç°åœ¨ equation ç®­å¤´å·¦è¾¹çš„ç´¢å¼•ï¼Œè¡¨ç¤ºä¸­é—´è®¡ç®—ç»“æœéœ€è¦åœ¨è¿™ä¸ªç»´åº¦ä¸Šæ±‚å’Œï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æåˆ°çš„æ±‚å’Œç´¢å¼•ï¼› è§„åˆ™ä¸‰: equation ç®­å¤´å³è¾¹çš„ç´¢å¼•é¡ºåºå¯ä»¥æ˜¯ä»»æ„çš„ï¼Œæ¯”å¦‚ä¸Šé¢çš„ â€œik,kj-\u003eijâ€ å¦‚æœå†™æˆ â€œik,kj-\u003ejiâ€ï¼Œé‚£ä¹ˆå°±æ˜¯è¿”å›è¾“å‡ºç»“æœçš„è½¬ç½®ï¼Œç”¨æˆ·åªéœ€è¦å®šä¹‰å¥½ç´¢å¼•çš„é¡ºåºï¼Œè½¬ç½®æ“ä½œä¼šåœ¨ einsum å†…éƒ¨å®Œæˆ ç‰¹æ®Šè§„åˆ™: equation å¯ä»¥ä¸å†™åŒ…æ‹¬ç®­å¤´åœ¨å†…çš„å³è¾¹éƒ¨åˆ†ï¼Œé‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¾“å‡ºå¼ é‡çš„ç»´åº¦ä¼šæ ¹æ®é»˜è®¤è§„åˆ™æ¨å¯¼ã€‚å°±æ˜¯æŠŠè¾“å…¥ä¸­åªå‡ºç°ä¸€æ¬¡çš„ç´¢å¼•å–å‡ºæ¥ï¼Œç„¶åæŒ‰å­—æ¯è¡¨é¡ºåºæ’åˆ—ï¼Œæ¯”å¦‚ä¸Šé¢çš„çŸ©é˜µä¹˜æ³• â€œik,kj-\u003eijâ€ ä¹Ÿå¯ä»¥ç®€åŒ–ä¸º â€œik,kjâ€ï¼Œæ ¹æ®é»˜è®¤è§„åˆ™ï¼Œè¾“å‡ºå°±æ˜¯ â€œijâ€ ä¸åŸæ¥ä¸€æ ·ï¼› equation ä¸­æ”¯æŒ â€œâ€¦â€ çœç•¥å·ï¼Œç”¨äºè¡¨ç¤ºç”¨æˆ·å¹¶ä¸å…³å¿ƒçš„ç´¢å¼•ã€‚æ¯”å¦‚åªå¯¹ä¸€ä¸ªé«˜ç»´å¼ é‡çš„æœ€åä¸¤ç»´åšè½¬ç½®å¯ä»¥è¿™ä¹ˆå†™ï¼š a = torch.randn(2,3,5,7,9) # i = 7, j = 9 b = torch.einsum('...ij-\u003e...ji', [a]) ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:1:1","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"2. torch.permute()/torch.transpose() torch.permute(dim0, dim1, dim2):ç”¨äºè°ƒæ¢ä¸åŒç»´åº¦çš„é¡ºåº torch.transpose(input, dim0, dim1):äº¤æ¢çŸ©é˜µçš„ä¸¤ä¸ªç»´åº¦ ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:1:2","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"3. torch.rand() torch.rand(dim0, dim1):ç”Ÿæˆdim0 x dim1çš„tensor ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:1:3","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"4. torch.size()/torch.shape torch.size():è¿”å›tensorçš„size torch.shape:è¿”å›tensorçš„size ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:1:4","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"5. torch.tensordot() ref: tensordot()å’Œeinsum()çš„åŒºåˆ«: https://blog.csdn.net/Eric_1993/article/details/105670381 torch.tensordot(tensor1ï¼Œ tensor2ï¼Œ axes=([dim1,dim2],[dim0, dim1])): å°†axesæŒ‡å®šçš„å­æ•°ç»„è¿›è¡Œç‚¹ä¹˜, axes æŒ‡å®šå…·ä½“çš„ç»´åº¦. ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:1:5","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"6. torch.transpose() torch.transpose(tensor, dim0, dim2) â€”\u003e Tensor:åœ¨dim0å’Œdim1æ–¹å‘ä¸Šè½¬ç½® ###7. torch.index_add_() Tensor.index_add_(dim, index, source, *, alpha=1) â†’ Tensor demo: \u003e\u003e\u003e x = torch.ones(5, 3) \u003e\u003e\u003e t = torch.tensor([[1, 2, 3], [4, 5, 6], [7, 8, 9]], dtype=torch.float) \u003e\u003e\u003e index = torch.tensor([0, 4, 2]) \u003e\u003e\u003e x.index_add_(0, index, t) tensor([[ 2., 3., 4.], [ 1., 1., 1.], [ 8., 9., 10.], [ 1., 1., 1.], [ 5., 6., 7.]]) \u003e\u003e\u003e x.index_add_(0, index, t, alpha=-1) tensor([[ 1., 1., 1.], [ 1., 1., 1.], [ 1., 1., 1.], [ 1., 1., 1.], [ 1., 1., 1.]]) ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:1:6","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"Torch NN Module import torch from torch import nn from torch import functional as F ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:2:0","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"1. nn.Conv1d() torch.nn.Conv1d(in_channels, out_channels, kernel_size, stride=1, padding=0, dilation=1, groups=1, bias=True, padding_mode='zeros', device=None, dtype=None) Shape: - Input: $(N, C_{in}, L_{in})$ or $(C_{in}, L_{in})$ - Output: $(N, C_{in}, L_{in})$ or $(C_{in}, L_{in})$, where $$L_{out} = \\frac{L_{in} + 2 \\cdot \\text{padding} - \\text{dilation} \\cdot (\\text{kernel_size} - 1) - 1}{stride}$$ Demo: m = nn.Conv1d(16, 33, 3, stride=2) input = torch.randn(20, 16, 50) # B x C x H or N x C x L output = m(input) print(output.shape) # torch.Size([20, 33, 24]) ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:2:1","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"2. nn.Conv2d() torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride=1, padding=0, dilation=1, groups=1, bias=True, padding_mode='zeros', device=None, dtype=None) Shape: Input: $(N, C_{\\text in}, H_{\\text in}, W_{\\text in})$ or $(C_{\\text in}, H_{\\text in}, W_{\\text in})$ - Output: $(N, C_{\\text out}, H_{\\text out}, W_{\\text out})$ or $(C_{\\text out}, H_{\\text out}, W_{\\text out})$, where $$ H_{out} = \\frac{H_{in} + 2 \\cdot \\text{padding[0]} - \\text{dilation[0]} \\cdot (\\text{kernel_size[0]} - 1) - 1}{stride[0]} + 1 $$ $$ W_{out} = \\frac{W_{in} + 2 \\cdot \\text{padding[1]} - \\text{dilation[1]} \\cdot (\\text{kernel_size[1]} - 1) - 1}{stride[1]} + 1 $$ Demo: # With square kernels and equal stride m = nn.Conv2d(16, 33, 3, stride=2) # non-square kernels and unequal stride and with padding m = nn.Conv2d(16, 33, (3, 5), stride=(2, 1), padding=(4, 2)) # output.shape: 20 x 33 x 28 x 100 # non-square kernels and unequal stride and with padding and dilation m = nn.Conv2d(16, 33, (3, 5), stride=(2, 1), padding=(4, 2), dilation=(3, 1)) # output.shape: 20 x 33 x 26 x 100 input = torch.randn(20, 16, 50, 100) output = m(input) # ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:2:2","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"3. nn.functional.interpolate() torch.nn.functional.interpolate(input, size=None, scale_factor=None, mode='nearest', align_corners=None, recompute_scale_factor=None, antialias=False) ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:2:3","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"4. nn.functional.ReLU() $$ \\text{ReLU} = (x)^+ = \\max {(0,x)}$$ torch.nn.ReLU(inplace=False) ä½œç”¨: Sigmoidçš„å¯¼æ•°åªæœ‰åœ¨0é™„è¿‘çš„æ—¶å€™æœ‰æ¯”è¾ƒå¥½çš„æ¿€æ´»æ€§ï¼Œåœ¨æ­£è´Ÿé¥±å’ŒåŒºçš„æ¢¯åº¦éƒ½æ¥è¿‘äº0ï¼Œæ‰€ä»¥è¿™ä¼šé€ æˆæ¢¯åº¦å¼¥æ•£ï¼Œè€ŒReLUå‡½æ•°åœ¨å¤§äº0çš„éƒ¨åˆ†æ¢¯åº¦ä¸ºå¸¸æ•°ï¼Œæ‰€ä»¥ä¸ä¼šäº§ç”Ÿæ¢¯åº¦å¼¥æ•£ç°è±¡ã€‚ ReLUå‡½æ•°åœ¨è´ŸåŠåŒºçš„å¯¼æ•°ä¸º0 ï¼Œæ‰€ä»¥ä¸€æ—¦ç¥ç»å…ƒæ¿€æ´»å€¼è¿›å…¥è´ŸåŠåŒºï¼Œé‚£ä¹ˆæ¢¯åº¦å°±ä¼šä¸º0ï¼Œè€Œæ­£å€¼ä¸å˜ï¼Œè¿™ç§æ“ä½œè¢«æˆä¸ºå•ä¾§æŠ‘åˆ¶ã€‚ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼šåœ¨è¾“å…¥æ˜¯è´Ÿå€¼çš„æƒ…å†µä¸‹ï¼Œå®ƒä¼šè¾“å‡º0ï¼Œé‚£ä¹ˆç¥ç»å…ƒå°±ä¸ä¼šè¢«æ¿€æ´»ã€‚è¿™æ„å‘³ç€åŒä¸€æ—¶é—´åªæœ‰éƒ¨åˆ†ç¥ç»å…ƒä¼šè¢«æ¿€æ´»ï¼Œä»è€Œä½¿å¾—ç½‘ç»œå¾ˆç¨€ç–ï¼Œè¿›è€Œå¯¹è®¡ç®—æ¥è¯´æ˜¯éå¸¸æœ‰æ•ˆç‡çš„ã€‚ï¼‰æ­£å› ä¸ºæœ‰äº†è¿™å•ä¾§æŠ‘åˆ¶ï¼Œæ‰ä½¿å¾—ç¥ç»ç½‘ç»œä¸­çš„ç¥ç»å…ƒä¹Ÿå…·æœ‰äº†ç¨€ç–æ¿€æ´»æ€§ã€‚å°¤å…¶ä½“ç°åœ¨æ·±åº¦ç¥ç»ç½‘ç»œæ¨¡å‹(å¦‚CNN)ä¸­ï¼Œå½“æ¨¡å‹å¢åŠ Nå±‚ä¹‹åï¼Œç†è®ºä¸ŠReLUç¥ç»å…ƒçš„æ¿€æ´»ç‡å°†é™ä½2çš„Næ¬¡æ–¹å€ã€‚ reluå‡½æ•°çš„å¯¼æ•°è®¡ç®—æ›´å¿«ï¼Œç¨‹åºå®ç°å°±æ˜¯ä¸€ä¸ªif-elseè¯­å¥ï¼Œè€Œsigmoidå‡½æ•°è¦è¿›è¡Œæµ®ç‚¹å››åˆ™è¿ç®—ã€‚ Shape: Input: $(âˆ—)$, where $*$ means any number of dimensions. Output: $(âˆ—)$, same shape as the input. Demo: m = nn.ReLU() input = torch.randn(2) output = m(input) # An implementation of CReLU - https://arxiv.org/abs/1603.05201 m = nn.ReLU() input = torch.randn(2).unsqueeze(0) output = torch.cat((m(input),m(-input))) ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:2:4","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"5. nn.MaxPool2d() torch.nn.MaxPool2d(kernel_size, stride=None, padding=0, dilation=1, return_indices=False, ceil_mode=False) Shape: Input: $(N, C, H_{in}, W_{in})$ or $(C, H_{in}, W_{in})$ Output: $(N, C, H_{out}, W_{out})$ or $(C, H_{out}, W_{out})$ where, $$ H_{out} = \\frac{H_{in} + 2 * \\text{padding}[0] - \\text{dilation}[0] * (\\text{kernel_size}[0]-1) - 1}{\\text{stride}[0]} + 1$$ $$ W_{out} = \\frac{W_{in} + 2 * \\text{padding}[1] - \\text{dilation}[1] * (\\text{kernel_size}[1]-1) - 1}{\\text{stride}[1]} + 1$$ demo: # pool of square window of size=3, stride=2 m = nn.MaxPool2d(3, stride=2) # pool of non-square window m = nn.MaxPool2d((3, 2), stride=(2, 1)) input = torch.randn(20, 16, 50, 32) output = m(input) # 20 16 24 31 ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:2:5","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"6. nn.AvgPool2d() torch.nn.AvgPool2d(kernel_size, stride=None, padding=0, ceil_mode=False, count_include_pad=True, divisor_override=None) Shape: Input: $(N, C, H_{in}, W_{in})$ or $(C, H_{in}, W_{in})$ Output: $(N, C, H_{out}, W_{out})$ or $(C, H_{out}, W_{out})$ where, $$ H_{out} = \\frac{H_{in} + 2 * \\text{padding}[0] - (\\text{kernel_size}[0])}{\\text{stride}[0]} + 1$$ $$ W_{out} = \\frac{W_{in} + 2 * \\text{padding}[1] - (\\text{kernel_size}[1])}{\\text{stride}[1]} + 1$$ demo: # pool of square window of size=3, stride=2 m = nn.AvgPool2d(3, stride=2) # pool of non-square window m = nn.AvgPool2d((3, 2), stride=(2, 1)) input = torch.randn(20, 16, 50, 32) output = m(input) # 20 16, 24 31 ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:2:6","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["PyTorch"],"content":"torch.cuda ref link: https://zhuanlan.zhihu.com/p/76908135 torch.cuda.current_device(): è¿”å›å½“å‰é€‰æ‹©çš„è®¾å¤‡çš„ç´¢å¼• torch.cuda.current_stream(): è¿”å›å‚æ•°è®¾å¤‡çš„å½“å‰çš„Stream torch.cuda.default_stream(): è¿”å›å½“å‰å‚æ•°è®¾å¤‡çš„Stream CLASS torch.cuda.device: å¯ä»¥æ”¹å˜é€‰æ‹©çš„è®¾å¤‡çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ Parametersï¼šdevice (torch.device or int) â€“ device index to select. Itâ€™s a no-op if this argument is a negative integer or None. torch.cuda.device_count(): è¿”å›å¯ä½¿ç”¨GPUçš„æ•°é‡ CLASS torch.cuda.device_of(obj) Context-manager å°†å‚æ•°å¯¹è±¡çš„è®¾å¤‡æ”¹æˆå½“å‰çš„è®¾å¤‡ã€‚ä½ å¯ä»¥ä½¿ç”¨å¼ é‡æˆ–è€…å­˜å‚¨ä½œä¸ºå‚æ•°ã€‚å¦‚æœä¼ å…¥çš„å¯¹è±¡æ²¡æœ‰åˆ†é…åœ¨GPUä¸Šï¼Œè¿™ä¸ªæ“ä½œæ˜¯æ— æ•ˆçš„ã€‚ torch.cuda.empty_cache() é‡Šæ”¾caching allocatorå½“å‰æŒæœ‰çš„æ‰€æœ‰æœªå ç”¨çš„cached memoryï¼Œä½¿å…¶å¯ä»¥ç”¨åœ¨å…¶ä»–GPUåº”ç”¨ä¸”å¯ä»¥åœ¨ nvidia-smiå¯è§†åŒ–ã€‚ æ³¨æ„ï¼šempty_cache() å¹¶ä¸ä¼šå¢åŠ PyTorchå¯ä»¥ä½¿ç”¨çš„GPUæ˜¾å­˜çš„å¤§å°ã€‚ æŸ¥çœ‹ Memory management æ¥è·å–æ›´å¤šçš„GPUæ˜¾å­˜ç®¡ç†çš„ä¿¡æ¯ã€‚ torch.cuda.get_device_capability(device=None) Gets the cuda capability of a device. Parametersï¼šdevice (torch.device or int, optional) â€“ device for which to return the device capability. This function is a no-op if this argument is a negative integer. It uses the current device, given bycurrent_device(), if device is None (default). Returnsï¼šthe major and minor cuda capability of the device Return type ï¼š tuple(int, int) torch.cuda.get_device_name(device=None) torch.cuda.init() åˆå§‹åŒ–PyTorchçš„CUDAçŠ¶æ€ã€‚å¦‚æœä½ é€šè¿‡C APIä¸PyTorchè¿›è¡Œäº¤äº’ï¼Œä½ å¯èƒ½éœ€è¦æ˜¾å¼è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚åªæœ‰CUDAçš„åˆå§‹åŒ–å®Œæˆï¼ŒCUDAçš„åŠŸèƒ½æ‰ä¼šç»‘å®šåˆ°Pythonã€‚ç”¨æˆ·ä¸€èˆ¬ä¸åº”è¯¥éœ€è¦è¿™ä¸ªï¼Œå› ä¸ºæ‰€æœ‰PyTorchçš„CUDAæ–¹æ³•éƒ½ä¼šè‡ªåŠ¨åœ¨éœ€è¦çš„æ—¶å€™åˆå§‹åŒ–CUDAã€‚å¦‚æœCUDAçš„çŠ¶æ€å·²ç»åˆå§‹åŒ–äº†ï¼Œå°†ä¸èµ·ä»»ä½•ä½œç”¨ã€‚ [torch.cuda.is_available()] torch.cuda.max_memory_allocated(device=None) Returns the maximum GPU memory occupied by tensors in bytes for a given device. torch.cuda.max_memory_cached(device=None) torch.cuda.memory_allocated(device=None) Parametersï¼šdevice (torch.device or int, optional) â€“ selected device. Returns statistic for the current device, given by current_device(), if device is None (default). torch.cuda.memory_cached(devide=None) [``] ","date":"2023-07-15","objectID":"/posts/pytorchnotes/:3:0","tags":["draft"],"title":"PyTorch Notes","uri":"/posts/pytorchnotes/"},{"categories":["ML"],"content":"ref: [1] https://www.cnblogs.com/rushup0930/p/13359513.html [2] https://blog.csdn.net/u013250861/article/details/123029585#t12 [3] https://blog.csdn.net/wf592523813/article/details/95202448 [4] https://zhuanlan.zhihu.com/p/69101372 classification åˆ†ç±» ä¸»è¦æ¶‰åŠçš„çŸ¥è¯†ç‚¹ï¼š æ··æ·†çŸ©é˜µã€Precision(ç²¾å‡†ç‡)ã€Recall(å¬å›ç‡)ã€Accuracy(å‡†ç¡®ç‡)ã€F1-score ï¼ˆåŒ…æ‹¬äºŒåˆ†ç±»å’Œå¤šåˆ†ç±»é—®é¢˜ï¼‰ ROCã€AUC æœ€å¸¸è§çš„æŒ‡æ ‡Accuracyåˆ°åº•æœ‰å“ªäº›ä¸è¶³ï¼Ÿ è§£: Accuracyæ˜¯åˆ†ç±»é—®é¢˜ä¸­æœ€å¸¸ç”¨çš„æŒ‡æ ‡ï¼Œå®ƒè®¡ç®—äº†åˆ†ç±»æ­£ç¡®çš„é¢„æµ‹æ•°ä¸æ€»é¢„æµ‹æ•°çš„æ¯”å€¼ã€‚ä½†æ˜¯ï¼Œå¯¹äºä¸å¹³è¡¡æ•°æ®é›†è€Œè¨€ï¼ŒAccuracyå¹¶ä¸æ˜¯ä¸€ä¸ªå¥½æŒ‡æ ‡ã€‚ å‡è®¾æˆ‘ä»¬æœ‰100å¼ å›¾ç‰‡ï¼Œå…¶ä¸­91å¼ å›¾ç‰‡æ˜¯ã€Œç‹—ã€ï¼Œ5å¼ æ˜¯ã€ŒçŒ«ã€ï¼Œ4å¼ æ˜¯ã€ŒçŒªã€ï¼Œæˆ‘ä»¬å¸Œæœ›è®­ç»ƒä¸€ä¸ªä¸‰åˆ†ç±»å™¨ï¼Œèƒ½æ­£ç¡®è¯†åˆ«å›¾ç‰‡é‡ŒåŠ¨ç‰©çš„ç±»åˆ«ã€‚å…¶ä¸­ï¼Œç‹—è¿™ä¸ªç±»åˆ«å°±æ˜¯å¤§å¤šæ•°ç±» (majority class)ã€‚å½“å¤§å¤šæ•°ç±»ä¸­æ ·æœ¬ï¼ˆç‹—ï¼‰çš„æ•°é‡è¿œè¶…è¿‡å…¶ä»–ç±»åˆ«ï¼ˆçŒ«ã€çŒªï¼‰æ—¶ï¼Œå¦‚æœé‡‡ç”¨Accuracyæ¥è¯„ä¼°åˆ†ç±»å™¨çš„å¥½åï¼Œé‚£ä¹ˆå³ä¾¿æ¨¡å‹æ€§èƒ½å¾ˆå·® (å¦‚æ— è®ºè¾“å…¥ä»€ä¹ˆå›¾ç‰‡ï¼Œéƒ½é¢„æµ‹ä¸ºã€Œç‹—ã€)ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°è¾ƒé«˜çš„Accuracy Score (å¦‚91%)ã€‚æ­¤æ—¶ï¼Œè™½ç„¶Accuracy Scoreå¾ˆé«˜ï¼Œä½†æ˜¯æ„ä¹‰ä¸å¤§ã€‚å½“æ•°æ®å¼‚å¸¸ä¸å¹³è¡¡æ—¶ï¼ŒAccuracyè¯„ä¼°æ–¹æ³•çš„ç¼ºé™·å°¤ä¸ºæ˜¾è‘—ã€‚ ","date":"2023-07-15","objectID":"/posts/metrics/:0:0","tags":["draft"],"title":"Classification and Regression Metrics","uri":"/posts/metrics/"},{"categories":["ML"],"content":"äºŒåˆ†ç±»æ¨¡å‹çš„å¸¸è§æŒ‡æ ‡ åœ¨äºŒåˆ†ç±»é—®é¢˜ä¸­ï¼Œå‡è®¾è¯¥æ ·æœ¬ä¸€å…±æœ‰ä¸¤ç§ç±»åˆ«ï¼šPositiveå’ŒNegativeã€‚å½“åˆ†ç±»å™¨é¢„æµ‹ç»“æŸï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶å‡ºæ··æ·†çŸ©é˜µï¼ˆconfusion matrixï¼‰ã€‚å…¶ä¸­åˆ†ç±»ç»“æœåˆ†ä¸ºå¦‚ä¸‹å‡ ç§ï¼š True Positive (TP): æŠŠæ­£æ ·æœ¬æˆåŠŸé¢„æµ‹ä¸ºæ­£ã€‚ True Negative (TN)ï¼šæŠŠè´Ÿæ ·æœ¬æˆåŠŸé¢„æµ‹ä¸ºè´Ÿã€‚ False Positive (FP)ï¼šæŠŠè´Ÿæ ·æœ¬é”™è¯¯åœ°é¢„æµ‹ä¸ºæ­£ã€‚ False Negative (FN)ï¼šæŠŠæ­£æ ·æœ¬é”™è¯¯çš„é¢„æµ‹ä¸ºè´Ÿã€‚ ä¸€ä¸ªå°æŠ€å·§ï¼Œ ç¬¬ä¸€ä¸ªå­—æ¯è¡¨ç¤ºåˆ’åˆ†æ­£ç¡®ä¸å¦ï¼Œ T è¡¨ç¤ºåˆ¤å®šæ­£ç¡®ï¼ˆåˆ¤å®šæ­£ç¡®ï¼‰ï¼Œ Fè¡¨ç¤ºåˆ¤å®šé”™è¯¯(False)ï¼› ç¬¬äºŒä¸ªå­—æ¯è¡¨ç¤ºåˆ†ç±»å™¨åˆ¤å®šç»“æœï¼Œ Pè¡¨ç¤ºåˆ¤å®šä¸ºæ­£ä¾‹ï¼Œ Nè¡¨ç¤ºåˆ¤å®šä¸ºè´Ÿä¾‹ã€‚ åœ¨äºŒåˆ†ç±»æ¨¡å‹ä¸­ï¼ŒAccuracyï¼ŒPrecisionï¼ŒRecallå’ŒF1 scoreçš„å®šä¹‰å¦‚ä¸‹ï¼š $$\\text{Accuracy} = \\frac{TP + TN}{TP + TN + FP + FN}$$ Accuracy èƒ½å¤Ÿæ¸…æ™°çš„åˆ¤æ–­æˆ‘ä»¬æ¨¡å‹çš„è¡¨ç°ï¼Œä½†æœ‰ä¸€ä¸ªä¸¥é‡çš„ç¼ºé™·ï¼š åœ¨æ­£è´Ÿæ ·æœ¬ä¸å‡è¡¡çš„æƒ…å†µä¸‹ï¼Œå æ¯”å¤§çš„ç±»åˆ«å¾€å¾€ä¼šæˆä¸ºå½±å“ Accuracy çš„æœ€ä¸»è¦å› ç´ ï¼Œæ­¤æ—¶çš„ Accuracy å¹¶ä¸èƒ½å¾ˆå¥½çš„åæ˜ æ¨¡å‹çš„æ•´ä½“æƒ…å†µã€‚ $$\\text{Precision} = \\frac{TP}{TP + FP}$$ Precisionç€é‡è¯„ä¼°åœ¨é¢„æµ‹ä¸ºPositiveçš„æ‰€æœ‰æ•°æ®ä¸­ï¼ŒçœŸå®Positveçš„æ•°æ®åˆ°åº•å å¤šå°‘ï¼Ÿ ç²¾ç¡®ç‡é«˜ï¼Œæ„å‘³ç€åˆ†ç±»å™¨è¦å°½é‡åœ¨ â€œæ›´æœ‰æŠŠæ¡â€ çš„æƒ…å†µä¸‹æ‰å°†æ ·æœ¬é¢„æµ‹ä¸ºæ­£æ ·æœ¬ï¼Œ è¿™æ„å‘³ç€ç²¾ç¡®ç‡èƒ½å¤Ÿå¾ˆå¥½çš„ä½“ç°æ¨¡å‹å¯¹äºè´Ÿæ ·æœ¬çš„åŒºåˆ†èƒ½åŠ›ï¼Œç²¾ç¡®ç‡è¶Šé«˜ï¼Œåˆ™æ¨¡å‹å¯¹è´Ÿæ ·æœ¬åŒºåˆ†èƒ½åŠ›è¶Šå¼ºã€‚ $$\\text{Recall} = \\frac{TP}{TP + FN}$$ Recallç€é‡è¯„ä¼°ï¼šåœ¨æ‰€æœ‰çš„Positiveæ•°æ®ä¸­ï¼Œåˆ°åº•æœ‰å¤šå°‘æ•°æ®è¢«æˆåŠŸé¢„æµ‹ä¸ºPositive å¬å›ç‡é«˜ï¼Œæ„å‘³ç€åˆ†ç±»å™¨å°½å¯èƒ½å°†æœ‰å¯èƒ½ä¸ºæ­£æ ·æœ¬çš„æ ·æœ¬é¢„æµ‹ä¸ºæ­£æ ·æœ¬ï¼Œè¿™æ„å‘³ç€å¬å›ç‡èƒ½å¤Ÿå¾ˆå¥½çš„ä½“ç°æ¨¡å‹å¯¹äºæ­£æ ·æœ¬çš„åŒºåˆ†èƒ½åŠ›ï¼Œå¬å›ç‡è¶Šé«˜ï¼Œåˆ™æ¨¡å‹å¯¹æ­£æ ·æœ¬çš„åŒºåˆ†èƒ½åŠ›è¶Šå¼ºã€‚ ä¸¾ä¾‹: ä¸€ä¸ªåŒ»é™¢æ–°å¼€å‘äº†ä¸€å¥—ç™Œç—‡AIè¯Šæ–­ç³»ç»Ÿï¼Œæƒ³è¯„ä¼°å…¶æ€§èƒ½å¥½åã€‚æˆ‘ä»¬æŠŠç—…äººå¾—äº†ç™Œç—‡å®šä¹‰ä¸ºPositiveï¼Œæ²¡å¾—ç™Œç—‡å®šä¹‰ä¸ºNegativeã€‚é‚£ä¹ˆï¼Œ åˆ°åº•è¯¥ç”¨ä»€ä¹ˆæŒ‡æ ‡è¿›è¡Œè¯„ä¼°å‘¢ï¼Ÿ å¦‚ç”¨Precisionå¯¹ç³»ç»Ÿè¿›è¡Œè¯„ä¼°ï¼Œé‚£ä¹ˆå…¶å›ç­”çš„é—®é¢˜å°±æ˜¯ï¼š åœ¨è¯Šæ–­ä¸ºç™Œç—‡çš„ä¸€å †äººä¸­ï¼Œåˆ°åº•æœ‰å¤šå°‘äººçœŸå¾—äº†ç™Œç—‡ï¼Ÿ å¦‚ç”¨Recallå¯¹ç³»ç»Ÿè¿›è¡Œè¯„ä¼°ï¼Œé‚£ä¹ˆå…¶å›ç­”çš„é—®é¢˜å°±æ˜¯ï¼š åœ¨ä¸€å †å¾—äº†ç™Œç—‡çš„ç—…äººä¸­ï¼Œåˆ°åº•æœ‰å¤šå°‘äººèƒ½è¢«æˆåŠŸæ£€æµ‹å‡ºç™Œç—‡ï¼Ÿ å¦‚ç”¨Accuracyå¯¹ç³»ç»Ÿè¿›è¡Œè¯„ä¼°ï¼Œé‚£ä¹ˆå…¶å›ç­”çš„é—®é¢˜å°±æ˜¯ï¼š åœ¨ä¸€å †ç™Œç—‡ç—…äººå’Œæ­£å¸¸äººä¸­ï¼Œæœ‰å¤šå°‘äººè¢«ç³»ç»Ÿç»™å‡ºäº†æ­£ç¡®è¯Šæ–­ç»“æœï¼ˆæ‚£ç™Œæˆ–æ²¡æ‚£ç™Œï¼‰ï¼Ÿ é‚£å•¥æ—¶å€™åº”è¯¥æ›´æ³¨é‡Recallè€Œä¸æ˜¯Precisionå‘¢ï¼Ÿ å½“False Negative (FN)çš„æˆæœ¬ä»£ä»·å¾ˆé«˜ (åæœå¾ˆä¸¥é‡)ï¼Œå¸Œæœ›å°½é‡é¿å…äº§ç”ŸFNæ—¶ï¼Œåº”è¯¥ç€é‡è€ƒè™‘æé«˜RecallæŒ‡æ ‡ã€‚ é‚£å•¥æ—¶å€™åº”è¯¥æ›´æ³¨é‡Precisionè€Œä¸æ˜¯Recallå‘¢ï¼Ÿ å½“False Positive (FP)çš„æˆæœ¬ä»£ä»·å¾ˆé«˜ (åæœå¾ˆä¸¥é‡)æ—¶ï¼Œå³æœŸæœ›å°½é‡é¿å…äº§ç”ŸFPæ—¶ï¼Œåº”è¯¥ç€é‡è€ƒè™‘æé«˜PrecisionæŒ‡æ ‡ã€‚ $$\\text{F1-score} = \\frac{2 \\times Precision \\times Recall}{Precision + Recall}$$ è€ŒF1-scoreæ˜¯Precisionå’ŒRecallä¸¤è€…çš„ç»¼åˆã€‚ ä¸¾ä¸ªæ›´æœ‰æ„æ€çš„ä¾‹å­ï¼ˆæˆ‘æ‹è„‘è¢‹æƒ³å‡ºæ¥çš„ï¼Œç»å¯¹åŸåˆ›å“ˆï¼‰ï¼Œå‡è®¾æ£€å¯Ÿæœºå…³æƒ³å°†ç½ªçŠ¯æ‰æ‹¿å½’æ¡ˆï¼Œéœ€è¦å¯¹æ‰€æœ‰äººç¾¤è¿›è¡Œåˆ†æï¼Œä»¥åˆ¤æ–­æŸäººçŠ¯äº†ç½ªï¼ˆPositiveï¼‰ï¼Œè¿˜æ˜¯æ²¡çŠ¯ç½ªï¼ˆNegativeï¼‰ã€‚æ˜¾ç„¶ï¼Œæ£€å¯Ÿæœºå…³å¸Œæœ›ä¸æ¼æ‰ä¸€ä¸ªç½ªäººï¼ˆæé«˜recallï¼‰ï¼Œä¹Ÿä¸é”™æ€ªä¸€ä¸ªå¥½äººï¼ˆæé«˜precisionï¼‰ï¼Œæ‰€ä»¥å°±éœ€è¦åŒæ—¶æƒè¡¡recallå’Œprecisionä¸¤ä¸ªæŒ‡æ ‡ã€‚ å°¤å…¶åœ¨ä¸Šä¸ªä¸–çºªï¼Œä¸­å›½å¸æ³•ä½“åˆ¶ä¼šæ›´åå‘Recallï¼Œå³ã€Œå¤©ç½‘æ¢æ¢ï¼Œç–è€Œä¸æ¼ï¼Œä»»ä½•ç½ªçŠ¯éƒ½æ’ç¿…éš¾é£ã€ã€‚è€Œè¥¿æ–¹å¸æ³•ç³»ç»Ÿä¼šæ›´åå‘Precisionï¼Œå³ã€Œç»ä¸å†¤æ‰ä¸€ä¸ªå¥½äººï¼Œä½†æ˜¯éš¾å…æœ‰ç½ªçŠ¯æˆä¸ºæ¼ç½‘ä¹‹é±¼ï¼Œé€é¥æ³•å¤–ã€ã€‚åˆ°åº•æ˜¯å“ªç§æ›´å¥½å‘¢ï¼Ÿæ˜¾ç„¶ï¼Œæç«¯å¹¶ä¸å¯å–ã€‚Precisionå’ŒRecalléƒ½åº”è¯¥è¶Šé«˜è¶Šå¥½ï¼Œä¹Ÿå°±æ˜¯F1åº”è¯¥è¶Šé«˜è¶Šå¥½ã€‚ å¦‚ä½•é€šä¿—çš„è§£é‡Šå¬å›ç‡ä¸ç²¾ç¡®ç‡ï¼Ÿ ä¾‹ï¼šå…¬å›­é‡Œæœ‰50åªçš®å¡ä¸˜å’Œ10åªè‡­è‡­æ³¥ã€‚æœ‰æ­£å¸¸å®¡ç¾çš„äººéƒ½ä¼šæƒ³è¦ç”¨ç²¾çµçƒæŠŠå°½å¯èƒ½å¤šçš„çš®å¡ä¸˜æŠ“å›æ¥ï¼ŒåŒæ—¶å°½å¯èƒ½å°‘åœ°æŠ“ä½è‡­è‡­æ³¥ã€‚ æœ€ç»ˆæˆ‘ä»¬çš„ç²¾çµçƒæˆåŠŸæŠ“å›æ¥äº†45åªçš®å¡ä¸˜å’Œ10åªè‡­è‡­æ³¥ã€‚ æˆ‘ä»¬å°±å¯ä»¥è¯´50åªçš®å¡ä¸˜ä¸­æœ‰45åªè¢«å¬å”¤ (call) å›æ¥ (re) äº†ï¼Œæ‰€ä»¥ recall = 45 / 50ã€‚ ä½†åŒæ—¶ï¼Œè¿™å°æœºå™¨è¿˜è¯¯æŠŠ5åªè‡­è‡­æ³¥è¯†åˆ«ä¸ºçš®å¡ä¸˜ï¼Œåœ¨å®ƒæŠ“å›æ¥çš„æ‰€æœ‰55åªç¥å¥‡å®è´ä¸­ï¼Œç²¾çµçƒå¯¹çš®å¡ä¸˜åˆ¤æ–­çš„ç²¾å‡†æ€§ (precision) = 45 / 55ã€‚ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç²¾çµçƒ=é¢„æµ‹æ¨¡å‹ï¼Œçš®å¡ä¸˜=æ­£æ ·æœ¬ï¼Œè‡­è‡­æ³¥=è´Ÿæ ·æœ¬ã€‚ æ€»ç»“è¿™ä¸¤ä¸ªæ¦‚å¿µçš„ç”¨å¤„ï¼šæè¿°æ¨¡å‹å¯¹æ­£æ ·æœ¬çš„é¢„æµ‹æ€§èƒ½ 1ã€recallæè¿°æ¨¡å‹â€œæŠŠæ­£æ ·æœ¬å« (call) å›æ¥(re)â€çš„èƒ½åŠ›ã€‚ 2ã€precisionæè¿°æ¨¡å‹â€œå«å›æ¥çš„æ­£æ ·æœ¬â€æœ‰å¤šå°‘æ˜¯ç²¾ç¡®çš„ã€‚ ","date":"2023-07-15","objectID":"/posts/metrics/:1:0","tags":["draft"],"title":"Classification and Regression Metrics","uri":"/posts/metrics/"},{"categories":["ML"],"content":"AOC / AUC æ··æ·†çŸ©é˜µä¸­æœ‰ç€Positiveã€Negativeã€Trueã€Falseçš„æ¦‚å¿µï¼Œå…¶æ„ä¹‰å¦‚ä¸‹ï¼š ç§°é¢„æµ‹ç±»åˆ«ä¸º1çš„ä¸ºPositiveï¼ˆé˜³æ€§ï¼‰ï¼Œé¢„æµ‹ç±»åˆ«ä¸º0çš„ä¸ºNegativeï¼ˆé˜´æ€§ï¼‰ã€‚ é¢„æµ‹æ­£ç¡®çš„ä¸ºTrueï¼ˆçœŸï¼‰ï¼Œé¢„æµ‹é”™è¯¯çš„ä¸ºFalseï¼ˆä¼ªï¼‰ã€‚ å¯¹ä¸Šè¿°æ¦‚å¿µè¿›è¡Œç»„åˆï¼Œå°±äº§ç”Ÿäº†å¦‚ä¸‹çš„æ··æ·†çŸ©é˜µ: ç„¶åï¼Œç”±æ­¤å¼•å‡ºTrue Positive Rateï¼ˆçœŸé˜³ç‡ï¼‰ã€False Positiveï¼ˆä¼ªé˜³ç‡ï¼‰ä¸¤ä¸ªæ¦‚å¿µï¼š $$TP Rate = \\frac{TP}{TP + FN}$$ $$FP Rate = \\frac{FP}{FP + TN}$$ ä»”ç»†çœ‹è¿™ä¸¤ä¸ªå…¬å¼ï¼Œå‘ç°å…¶å®TPRateå°±æ˜¯TPé™¤ä»¥TPæ‰€åœ¨çš„åˆ—ï¼ŒFPRateå°±æ˜¯FPé™¤ä»¥FPæ‰€åœ¨çš„åˆ—ï¼ŒäºŒè€…æ„ä¹‰å¦‚ä¸‹ï¼š TPRateçš„æ„ä¹‰æ˜¯æ‰€æœ‰çœŸå®ç±»åˆ«ä¸º1çš„æ ·æœ¬ä¸­ï¼Œé¢„æµ‹ç±»åˆ«ä¸º1çš„æ¯”ä¾‹ã€‚ FPRateçš„æ„ä¹‰æ˜¯æ‰€æœ‰çœŸå®ç±»åˆ«ä¸º0çš„æ ·æœ¬ä¸­ï¼Œé¢„æµ‹ç±»åˆ«ä¸º1çš„æ¯”ä¾‹ã€‚ å¦‚æœä¸Šè¿°æ¦‚å¿µéƒ½å¼„æ‡‚äº†ï¼Œé‚£ä¹ˆROCæ›²çº¿å’ŒAUCå°±so easyäº†ï¼š æŒ‰ç…§å®šä¹‰ï¼ŒAUCå³ROCæ›²çº¿ä¸‹çš„é¢ç§¯ï¼Œè€ŒROCæ›²çº¿çš„æ¨ªè½´æ˜¯FPRateï¼Œçºµè½´æ˜¯TPRateï¼Œå½“äºŒè€…ç›¸ç­‰æ—¶ï¼Œå³y=xï¼Œå¦‚ä¸‹å›¾: è¡¨ç¤ºçš„æ„ä¹‰æ˜¯ï¼šå¯¹äºä¸è®ºçœŸå®ç±»åˆ«æ˜¯1è¿˜æ˜¯0çš„æ ·æœ¬ï¼Œåˆ†ç±»å™¨é¢„æµ‹ä¸º1çš„æ¦‚ç‡æ˜¯ç›¸ç­‰çš„ã€‚ æ¢å¥è¯è¯´ï¼Œåˆ†ç±»å™¨å¯¹äºæ­£ä¾‹å’Œè´Ÿä¾‹æ¯«æ— åŒºåˆ†èƒ½åŠ›ï¼Œå’ŒæŠ›ç¡¬å¸æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä¸€ä¸ªæŠ›ç¡¬å¸çš„åˆ†ç±»å™¨æ˜¯æˆ‘ä»¬èƒ½æƒ³è±¡çš„æœ€å·®çš„æƒ…å†µï¼Œå› æ­¤ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬è®¤ä¸ºAUCçš„æœ€å°å€¼ä¸º0.5ï¼ˆå½“ç„¶ä¹Ÿå­˜åœ¨é¢„æµ‹ç›¸åè¿™ç§æç«¯çš„æƒ…å†µï¼ŒAUCå°äº0.5ï¼Œè¿™ç§æƒ…å†µç›¸å½“äºåˆ†ç±»å™¨æ€»æ˜¯æŠŠå¯¹çš„è¯´æˆé”™çš„ï¼Œé”™çš„è®¤ä¸ºæ˜¯å¯¹çš„ï¼Œé‚£ä¹ˆåªè¦æŠŠé¢„æµ‹ç±»åˆ«å–åï¼Œä¾¿å¾—åˆ°äº†ä¸€ä¸ªAUCå¤§äº0.5çš„åˆ†ç±»å™¨ï¼‰ã€‚ è€Œæˆ‘ä»¬å¸Œæœ›åˆ†ç±»å™¨è¾¾åˆ°çš„æ•ˆæœæ˜¯ï¼šå¯¹äºçœŸå®ç±»åˆ«ä¸º1çš„æ ·æœ¬ï¼Œåˆ†ç±»å™¨é¢„æµ‹ä¸º1çš„æ¦‚ç‡ï¼ˆå³TPRateï¼‰ï¼Œè¦å¤§äºçœŸå®ç±»åˆ«ä¸º0è€Œé¢„æµ‹ç±»åˆ«ä¸º1çš„æ¦‚ç‡ï¼ˆå³FPRateï¼‰ï¼Œå³yï¼xï¼Œå› æ­¤å¤§éƒ¨åˆ†çš„ROCæ›²çº¿é•¿æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š è¯´äº†è¿™ä¹ˆå¤šè¿˜æ˜¯ä¸å¤Ÿç›´è§‚ï¼Œä¸å¦¨ä¸¾ä¸ªç®€å•çš„ä¾‹å­ã€‚ é¦–å…ˆå¯¹äºç¡¬åˆ†ç±»å™¨ï¼ˆä¾‹å¦‚SVMï¼ŒNBï¼‰ï¼Œé¢„æµ‹ç±»åˆ«ä¸ºç¦»æ•£æ ‡ç­¾ï¼Œå¯¹äº8ä¸ªæ ·æœ¬çš„é¢„æµ‹æƒ…å†µå¦‚ä¸‹ï¼š å¾—åˆ°æ··æ·†çŸ©é˜µå¦‚ä¸‹ï¼š è¿›è€Œç®—å¾—TPRate=3/4ï¼ŒFPRate=2/4ï¼Œå¾—åˆ°ROCæ›²çº¿ï¼š æœ€ç»ˆå¾—åˆ°AUCä¸º0.625ã€‚ å¯¹äºLRç­‰é¢„æµ‹ç±»åˆ«ä¸ºæ¦‚ç‡çš„åˆ†ç±»å™¨ï¼Œä¾ç„¶ç”¨ä¸Šè¿°ä¾‹å­ï¼Œå‡è®¾é¢„æµ‹ç»“æœå¦‚ä¸‹ï¼š è¿™æ—¶ï¼Œéœ€è¦è®¾ç½®é˜ˆå€¼æ¥å¾—åˆ°æ··æ·†çŸ©é˜µï¼Œä¸åŒçš„é˜ˆå€¼ä¼šå½±å“å¾—åˆ°çš„TPRateï¼ŒFPRateï¼Œå¦‚æœé˜ˆå€¼å–0.5ï¼Œå°äº0.5çš„ä¸º0ï¼Œå¦åˆ™ä¸º1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸ä¹‹å‰ä¸€æ ·çš„æ··æ·†çŸ©é˜µã€‚å…¶ä»–çš„é˜ˆå€¼å°±ä¸å†å•°å—¦äº†ã€‚ä¾æ¬¡ä½¿ç”¨æ‰€æœ‰é¢„æµ‹å€¼ä½œä¸ºé˜ˆå€¼ï¼Œå¾—åˆ°ä¸€ç³»åˆ—TPRateï¼ŒFPRateï¼Œæç‚¹ï¼Œæ±‚é¢ç§¯ï¼Œå³å¯å¾—åˆ°AUCã€‚ æœ€åè¯´è¯´AUCçš„ä¼˜åŠ¿ï¼ŒAUCçš„è®¡ç®—æ–¹æ³•åŒæ—¶è€ƒè™‘äº†åˆ†ç±»å™¨å¯¹äºæ­£ä¾‹å’Œè´Ÿä¾‹çš„åˆ†ç±»èƒ½åŠ›ï¼Œåœ¨æ ·æœ¬ä¸å¹³è¡¡çš„æƒ…å†µä¸‹ï¼Œä¾ç„¶èƒ½å¤Ÿå¯¹åˆ†ç±»å™¨ä½œå‡ºåˆç†çš„è¯„ä»·ã€‚ ä¾‹å¦‚åœ¨åæ¬ºè¯ˆåœºæ™¯ï¼Œè®¾æ¬ºè¯ˆç±»æ ·æœ¬ä¸ºæ­£ä¾‹ï¼Œæ­£ä¾‹å æ¯”å¾ˆå°‘ï¼ˆå‡è®¾0.1%ï¼‰ï¼Œå¦‚æœä½¿ç”¨å‡†ç¡®ç‡è¯„ä¼°ï¼ŒæŠŠæ‰€æœ‰çš„æ ·æœ¬é¢„æµ‹ä¸ºè´Ÿä¾‹ï¼Œä¾¿å¯ä»¥è·å¾—99.9%çš„å‡†ç¡®ç‡ã€‚ ä½†æ˜¯å¦‚æœä½¿ç”¨AUCï¼ŒæŠŠæ‰€æœ‰æ ·æœ¬é¢„æµ‹ä¸ºè´Ÿä¾‹ï¼ŒTPRateå’ŒFPRateåŒæ—¶ä¸º0ï¼ˆæ²¡æœ‰Positiveï¼‰ï¼Œä¸(0,0) (1,1)è¿æ¥ï¼Œå¾—å‡ºAUCä»…ä¸º0.5ï¼ŒæˆåŠŸè§„é¿äº†æ ·æœ¬ä¸å‡åŒ€å¸¦æ¥çš„é—®é¢˜ã€‚ ","date":"2023-07-15","objectID":"/posts/metrics/:2:0","tags":["draft"],"title":"Classification and Regression Metrics","uri":"/posts/metrics/"},{"categories":["ML"],"content":"å¤šåˆ†ç±»æ¨¡å‹çš„å¸¸è§æŒ‡æ ‡è¯¦ç»†è§£æ åœ¨å¤šåˆ†ç±»ï¼ˆå¤§äºä¸¤ä¸ªç±»ï¼‰é—®é¢˜ä¸­ï¼Œå‡è®¾æˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªåŠ¨ç‰©è¯†åˆ«ç³»ç»Ÿï¼Œæ¥åŒºåˆ†è¾“å…¥å›¾ç‰‡æ˜¯çŒ«ï¼Œç‹—è¿˜æ˜¯çŒªã€‚ç»™å®šåˆ†ç±»å™¨ä¸€å †åŠ¨ç‰©å›¾ç‰‡ï¼Œäº§ç”Ÿäº†å¦‚ä¸‹ç»“æœæ··æ·†çŸ©é˜µã€‚ åœ¨æ··æ·†çŸ©é˜µä¸­ï¼Œæ­£ç¡®çš„åˆ†ç±»æ ·æœ¬ï¼ˆActual label = Predicted labelï¼‰åˆ†å¸ƒåœ¨å·¦ä¸Šåˆ°å³ä¸‹çš„å¯¹è§’çº¿ä¸Šã€‚å…¶ä¸­ï¼ŒAccuracyçš„å®šä¹‰ä¸ºåˆ†ç±»æ­£ç¡®ï¼ˆå¯¹è§’çº¿ä¸Šï¼‰çš„æ ·æœ¬æ•°ä¸æ€»æ ·æœ¬æ•°çš„æ¯”å€¼ã€‚Accuracyåº¦é‡çš„æ˜¯å…¨å±€æ ·æœ¬é¢„æµ‹æƒ…å†µã€‚è€Œå¯¹äºPrecisionå’ŒRecallè€Œè¨€ï¼Œæ¯ä¸ªç±»éƒ½éœ€è¦å•ç‹¬è®¡ç®—å…¶Precisionå’ŒRecallã€‚ classify_multiclass_prediction æ¯”å¦‚ï¼Œå¯¹ç±»åˆ«ã€ŒçŒªã€è€Œè¨€ï¼Œå…¶Precisionå’ŒRecallåˆ†åˆ«ä¸º: $$\\text{Precision} = \\frac{TP}{TP + FP} = \\frac{20}{20 + 50} = \\frac{2}{7}$$ $$\\text{Recall} = \\frac{TP}{TP + FN} = \\frac{20}{10} = \\frac{2}{3}$$ ä¹Ÿå°±æ˜¯: $$P_{cat} = \\frac{8}{15}, P_{dog} = \\frac{17}{23}, P_{pig} = \\frac{2}{7}, (Pä»£è¡¨Precision) $$ $$R_{cat} = \\frac{4}{7}, R_{dog} = \\frac{17}{32}, R_{pig} = \\frac{2}{3}, (Rä»£è¡¨Recall) $$ å¦‚æœæƒ³è¯„ä¼°è¯¥è¯†åˆ«ç³»ç»Ÿçš„æ€»ä½“åŠŸèƒ½ï¼Œå¿…é¡»è€ƒè™‘çŒ«ã€ç‹—ã€çŒªä¸‰ä¸ªç±»åˆ«çš„ç»¼åˆé¢„æµ‹æ€§èƒ½ã€‚é‚£ä¹ˆï¼Œåˆ°åº•è¦æ€ä¹ˆç»¼åˆè¿™ä¸‰ä¸ªç±»åˆ«çš„Precisionå‘¢ï¼Ÿæ˜¯ç®€å•åŠ èµ·æ¥åšå¹³å‡å—ï¼Ÿé€šå¸¸æ¥è¯´ï¼Œ æˆ‘ä»¬æœ‰å¦‚ä¸‹å‡ ç§è§£å†³æ–¹æ¡ˆï¼ˆä¹Ÿå¯å‚è€ƒscikit-learnå®˜ç½‘ï¼‰ï¼š 1. Macro-averageæ–¹æ³• è¯¥æ–¹æ³•æœ€ç®€å•ï¼Œç›´æ¥å°†ä¸åŒç±»åˆ«çš„è¯„ä¼°æŒ‡æ ‡ï¼ˆPrecision/ Recall/ F1-scoreï¼‰åŠ èµ·æ¥æ±‚å¹³å‡ï¼Œç»™æ‰€æœ‰ç±»åˆ«ç›¸åŒçš„æƒé‡ã€‚è¯¥æ–¹æ³•èƒ½å¤Ÿå¹³ç­‰çœ‹å¾…æ¯ä¸ªç±»åˆ«ï¼Œä½†æ˜¯å®ƒçš„å€¼ä¼šå—ç¨€æœ‰ç±»åˆ«å½±å“ã€‚ $$\\text{Macro-Precision} = \\frac{P_{cat} + P_{dog} + P_{pig}}{3} = 0.5194$$ $$\\text{Macro-Recall} = \\frac{R_{cat} + R_{dog} + R_{pig}}{3} = 0.5898$$ 2. Weighted-averageæ–¹æ³• è¯¥æ–¹æ³•ç»™ä¸åŒç±»åˆ«ä¸åŒæƒé‡ï¼ˆæƒé‡æ ¹æ®è¯¥ç±»åˆ«çš„çœŸå®åˆ†å¸ƒæ¯”ä¾‹ç¡®å®šï¼‰ï¼Œæ¯ä¸ªç±»åˆ«ä¹˜æƒé‡åå†è¿›è¡Œç›¸åŠ ã€‚è¯¥æ–¹æ³•è€ƒè™‘äº†ç±»åˆ«ä¸å¹³è¡¡æƒ…å†µï¼Œå®ƒçš„å€¼æ›´å®¹æ˜“å—åˆ°å¸¸è§ç±»ï¼ˆmajority classï¼‰çš„å½±å“ã€‚ $$W_{cat} : W_{dog} : W_{pig} = N_{cat} : N_{dog} : N_{pig} = \\frac{7}{26} : \\frac{16}{26} : \\frac{3}{26} (Wä»£è¡¨æƒé‡ï¼ŒNä»£è¡¨æ ·æœ¬åœ¨è¯¥ç±»åˆ«ä¸‹çš„çœŸå®æ•°ç›®)$$ $$\\text{Weighted-Precision} = P_{cat} \\times W_{cat} + P_{dog} \\times W_{dog} + P_{pig} \\times W_{pig} = 0.6314$$ $$\\text{Weighted-Recall} = {R_{cat} \\times W_{cat} + R_{dog} \\times W_{dog} + R_{pig} \\times W_{pig}}= 0.5577$$ 3. Micro-averageæ–¹æ³• è¯¥æ–¹æ³•æŠŠæ¯ä¸ªç±»åˆ«çš„TP, FP, FNå…ˆç›¸åŠ ä¹‹åï¼Œåœ¨æ ¹æ®äºŒåˆ†ç±»çš„å…¬å¼è¿›è¡Œè®¡ç®—ã€‚ $$\\text{Micro-Precision} = \\frac{TP_{cat} + TP_{dog} + TP_{pig}}{TP_{cat} + TP_{dog} + TP_{pig} + FP_{cat} + FP_{dog} + FP_{pig}} = 0.5577$$ $$\\text{Micro-Recall} = \\frac{TP_{cat} + TP_{dog} + TP_{pig}}{TP_{cat} + TP_{dog} + TP_{pig} + FN_{cat} + FN_{dog} + FN_{pig}} = 0.5577$$ å…¶ä¸­ï¼Œç‰¹åˆ«æœ‰æ„æ€çš„æ˜¯ï¼ŒMicro-precision å’Œ Micro-recallç«Ÿç„¶å§‹ç»ˆç›¸åŒï¼è¿™æ˜¯ä¸ºå•¥å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºåœ¨æŸä¸€ç±»ä¸­çš„False Positiveæ ·æœ¬ï¼Œä¸€å®šæ˜¯å…¶ä»–æŸç±»åˆ«çš„False Negativeæ ·æœ¬ã€‚å¬èµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚è¯´ç³»ç»Ÿé”™æŠŠã€Œç‹—ã€é¢„æµ‹æˆã€ŒçŒ«ã€ï¼Œé‚£ä¹ˆå¯¹äºç‹—è€Œè¨€ï¼Œå…¶é”™è¯¯ç±»å‹å°±æ˜¯False Negativeï¼Œå¯¹äºçŒ«è€Œè¨€ï¼Œå…¶é”™è¯¯ç±»å‹å°±æ˜¯False Positiveã€‚äºæ­¤åŒæ—¶ï¼ŒMicro-precisionå’ŒMicro-recallçš„æ•°å€¼éƒ½ç­‰äºAccuracyï¼Œå› ä¸ºå®ƒä»¬è®¡ç®—äº†å¯¹è§’çº¿æ ·æœ¬æ•°å’Œæ€»æ ·æœ¬æ•°çš„æ¯”å€¼ï¼Œæ€»ç»“å°±æ˜¯ $$\\text{Micro-Precision} = \\text{Micro-Recall} = \\text{Micro-F1 score} = \\text{Accuracy}$$ demoç¤ºä¾‹: import numpy as np import seaborn as sns from sklearn.metrics import confusion_matrix import pandas as pd import matplotlib.pyplot as plt from sklearn.metrics import accuracy_score, average_precision_score,precision_score,f1_score,recall_score # create confusion matrix y_true = np.array([-1]*70 + [0]*160 + [1]*30) y_pred = np.array([-1]*40 + [0]*20 + [1]*20 + [-1]*30 + [0]*80 + [1]*30 + [-1]*5 + [0]*15 + [1]*20) cm = confusion_matrix(y_true, y_pred) conf_matrix = pd.DataFrame(cm, index=['Cat','Dog','Pig'], columns=['Cat','Dog','Pig']) # plot size setting fig, ax = plt.subplots(figsize = (4.5,3.5)) sns.heatmap(conf_matrix, annot=True, annot_kws={\"size\": 19}, cmap=\"Blues\") plt.ylabel('True label', fontsize=18) plt.xlabel('Predicted label', fontsize=18) plt.xticks(fontsize=18) plt.yticks(fontsize=18) plt.savefig('confusion.pdf', bbox_inches='tight') plt.show() print('------Weighted------') print('Weighted precision', precision_score(y_true, y_pred, average='weighted')) print('Weighted recall', recall_score(y_true, y_pred, average='weighted')) print('Weighted f1-score', f1_score(y_true, y_pred, average='weighted')) print('------Macro------') print('Macro precision', precision_score(y_true, y_pred, average='macro')) print('Macro recall', recall_score(y_true, y_pred, average='macro')) print('Macro f1-score', f1_score(y_true, y_pred, average='macro')) print('------Micro------') print('Micro precision', precision_score(y_true, y_pred, average='micro')) print('Micro recall', recall_score(y_true, y_pred, average='micro')) print('Micro f1-score', f1_score(y_true, y_pred, average='micro')) Regression å›å½’ å›å½’ç®—æ³•çš„è¯„ä»·æŒ‡æ ‡å°±æ˜¯MSEï¼ŒRMSEï¼ŒMAEã€R-Squaredã€‚ MSEå’ŒMAEé€‚ç”¨äºè¯¯å·®ç›¸å¯¹æ˜æ˜¾çš„æ—¶å€™ï¼Œå¤§çš„è¯¯å·®ä¹Ÿæœ‰æ¯”è¾ƒé«˜çš„æƒé‡ï¼ŒRMSEåˆ™æ˜¯é’ˆå¯¹è¯¯å·®ä¸æ˜¯å¾ˆæ˜æ˜¾çš„æ—¶å€™ï¼›MAEæ˜¯ä¸€ä¸ªçº¿æ€§çš„æŒ‡æ ‡ï¼Œæ‰€æœ‰ä¸ªä½“å·®å¼‚åœ¨å¹³å‡å€¼ä¸Šå‡ç­‰åŠ æƒï¼Œæ‰€ä»¥å®ƒæ›´åŠ å‡¸æ˜¾å‡ºå¼‚å¸¸å€¼ï¼Œç›¸æ¯”MSEï¼› RMSLE: ä¸»è¦é’ˆå¯¹æ•°æ®é›†ä¸­æœ‰ä¸€ä¸ªç‰¹åˆ«å¤§çš„å¼‚å¸¸å€¼ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œdataä¼šè¢«s","date":"2023-07-15","objectID":"/posts/metrics/:3:0","tags":["draft"],"title":"Classification and Regression Metrics","uri":"/posts/metrics/"},{"categories":["ML"],"content":"ç”¨pickleä¿å­˜å’ŒåŠ è½½æ¨¡å‹ ä¿å­˜æ¨¡å‹ import pickle from sklearn.svm import SVC model_dir = './model.pkl' model = SVC() with open(model_dir, 'wb') as f: pickle.dump(model, f) f.close() # æ³¨æ„:ä¿å­˜å®Œæ¨¡å‹ä¹‹åè¦å…³é—­æ–‡ä»¶ åŠ è½½æ¨¡å‹ import pickle model_dir = './model.pkl' with open(model_dir, 'rb') as f: model = pickel.load(f) print(mode.predict(x)) ","date":"2023-07-15","objectID":"/posts/notes_1/:1:0","tags":["ML"],"title":"Maching Learning Notes 1","uri":"/posts/notes_1/"},{"categories":["ML"],"content":"é€»è¾‘å›å½’ Logistic Regression LR Implementation code snippets from sklearn.linear_model import LogisticRegression from sklearn.model_selection import train_test_split from sklearn.metrics import accuracy_score import numpy as np import matplotlib.pyplot as plt import pickle from tqdm import tqdm data_path = './data/merged_data/data.npy' data = np.load(data_path, allow_pickle=True) model_l1_path='./model/logistic_reg_l1.pickle' model_l2_path='./model/logictic_reg_l2.pickle' X = data[:,0:35] y = data[:, -1] X_train, x_test, Y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1) # lr_l1 = LogisticRegression(penalty=\"l1\", C=0.5, solver='sag', multi_class=\"auto\") # lr_l2 = LogisticRegression(penalty=\"l2\", C=0.5, solver='sag', multi_class=\"auto\") # # train model # lr_l1.fit(X_train, Y_train) # lr_l2.fit(X_train, Y_train) # model performence on train set l1_train_predict = [] l2_train_predict = [] # model performence on test set l1_test_predict = [] l2_test_predict = [] for c in tqdm(np.linspace(0.01, 2, 50)): # lr_l1 = LogisticRegression(penalty=\"l1\", C=c, solver='liblinear', max_iter=1000) # lr_l2 = LogisticRegression(penalty='l2', C=c, solver='liblinear', max_iter=1000) lr_l1 = LogisticRegression(penalty=\"l1\", C=c, solver='liblinear', max_iter=1000, multi_class='auto') lr_l2 = LogisticRegression(penalty='l2', C=c, solver='liblinear', max_iter=1000, multi_class='auto') # è®­ç»ƒæ¨¡å‹ï¼Œè®°å½•L1æ­£åˆ™åŒ–æ¨¡å‹åœ¨è®­ç»ƒé›†æµ‹è¯•é›†ä¸Šçš„è¡¨ç° lr_l1.fit(X_train, Y_train) l1_train_predict.append(accuracy_score(lr_l1.predict(X_train), Y_train)) l1_test_predict.append(accuracy_score(lr_l1.predict(x_test), y_test)) # è®°å½•L2æ­£åˆ™åŒ–æ¨¡å‹çš„è¡¨ç° lr_l2.fit(X_train, Y_train) l2_train_predict.append(accuracy_score(lr_l2.predict(X_train), Y_train)) l2_test_predict.append(accuracy_score(lr_l2.predict(x_test), y_test)) if c == 2: pred_y_test = lr_l2.predict(x_test) mask = abs(pred_y_test-y_test) \u003c 5 neg_test = pred_y_test[mask] res = (len(neg_test)/len(pred_y_test)) print(res) with open(model_l1_path, 'wb') as f1: pickle.dump(lr_l1, f1) with open(model_l2_path, 'wb') as f2: pickle.dump(lr_l2, f2) data = [l1_train_predict, l2_train_predict, l1_test_predict, l2_test_predict] label = ['l1_train', 'l2_train', 'l1_test', \"l2_test\"] color = ['red', 'green', 'orange', 'blue'] plt.figure(figsize=(12, 6)) for i in range(4) : plt.plot(np.linspace(0.01, 2, 50), data[i], label=label[i], color=color[i]) plt.legend(loc=\"best\") plt.show() ","date":"2023-07-15","objectID":"/posts/notes_1/:2:0","tags":["ML"],"title":"Maching Learning Notes 1","uri":"/posts/notes_1/"},{"categories":["ML"],"content":"æ”¯æŒå‘é‡æœº Support Vector Machine Using GridSearch to find the best parameters [code snippets] import numpy as np import matplotlib.pyplot as plt from sklearn.linear_model import Perceptron, LogisticRegression from sklearn.svm import SVC from sklearn.model_selection import train_test_split from sklearn.preprocessing import StandardScaler from sklearn import datasets from sklearn import metrics import pickle merged_data_dir = '../data/merged_data/merged_data.npy' model_dir='./svm.pkl' data = np.load(merged_data_dir, allow_pickle=True) #labeling for ele in data: if ele[-1] \u003c 20: ele[-1] = 0 elif ele[-1] \u003e=20 and ele[-1] \u003c 40: ele[-1] = 1 else: ele[-1] = 2 X = data[:,0:34] y = data[:,-1] print(y) # Create training and test split X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1, stratify=y) # feature scaling # sc = StandardScaler() # sc.fit(X_train) # X_train_std = sc.transform(X_train) # X_test_std = sc.transform(X_test) ################################## # # Instantiate the Support Vector Classifier (SVC) # svc = SVC(C=10, random_state=1, kernel='rbf', gamma=0.3) # # Fit the model # svc.fit(X_train, y_train) # # Make the predictions # y_predict = svc.predict(X_test) # # Measure the performance # print(\"Accuracy score %.3f\" %metrics.accuracy_score(y_test, y_predict)) ############################################# def svm_cross_validation(train_x, train_y): from sklearn.model_selection import GridSearchCV from sklearn.svm import SVC model = SVC(kernel='rbf', probability=True) param_grid = {'C': [1e-3, 1e-2, 1e-1, 1, 10, 100, 1000], 'gamma': [0.001, 0.0001]} grid_search = GridSearchCV(model, param_grid, n_jobs = 8, verbose=1, scoring='accuracy') grid_search.fit(train_x, train_y) best_parameters = grid_search.best_estimator_.get_params() for para, val in list(best_parameters.items()): print(para, val) model = SVC(kernel='rbf', C=best_parameters['C'], gamma=best_parameters['gamma'], probability=True) model.fit(train_x, train_y) return model svm_model = svm_cross_validation(X_train, y_train) with open(model_dir, 'wb') as f1: pickle.dump(svm_model, f1) f1.close() print(svm_model.score(X_test, y_test)) y_predict = svm_model.predict(X_test) print(y_predict) ","date":"2023-07-15","objectID":"/posts/notes_1/:3:0","tags":["ML"],"title":"Maching Learning Notes 1","uri":"/posts/notes_1/"},{"categories":["Memo"],"content":"docker å…¥é—¨æ•™ç¨‹ Ref Link: [1] https://ruanyifeng.com/blog/2018/02/docker-tutorial.html [2] https://cloud.tencent.com/developer/article/1885678 [3] ã€ŒDockerã€ - ä¿å­˜é•œåƒ [4] å¦‚ä½•åˆ¶ä½œDockeré•œåƒ(image)? ","date":"2023-07-15","objectID":"/posts/dockerintroduction/:1:0","tags":["docker"],"title":"Dockerå®‰è£…åŠå­¦ä¹ ","uri":"/posts/dockerintroduction/"},{"categories":["Memo"],"content":"ä¸€ã€Docker æ˜¯ä»€ä¹ˆï¼Ÿ \u0026\u0026 Docker çš„ç”¨é€” Docker å±äº Linux å®¹å™¨çš„ä¸€ç§å°è£…ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ã€‚å®ƒæ˜¯ç›®å‰æœ€æµè¡Œçš„ Linux å®¹å™¨è§£å†³æ–¹æ¡ˆã€‚ Docker å°†åº”ç”¨ç¨‹åºä¸è¯¥ç¨‹åºçš„ä¾èµ–ï¼Œæ‰“åŒ…åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ã€‚è¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿå®¹å™¨ã€‚ç¨‹åºåœ¨è¿™ä¸ªè™šæ‹Ÿå®¹å™¨é‡Œè¿è¡Œï¼Œå°±å¥½åƒåœ¨çœŸå®çš„ç‰©ç†æœºä¸Šè¿è¡Œä¸€æ ·ã€‚æœ‰äº† Dockerï¼Œå°±ä¸ç”¨æ‹…å¿ƒç¯å¢ƒé—®é¢˜ã€‚ æ€»ä½“æ¥è¯´ï¼ŒDocker çš„æ¥å£ç›¸å½“ç®€å•ï¼Œç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œä½¿ç”¨å®¹å™¨ï¼ŒæŠŠè‡ªå·±çš„åº”ç”¨æ”¾å…¥å®¹å™¨ã€‚å®¹å™¨è¿˜å¯ä»¥è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€å¤åˆ¶ã€åˆ†äº«ã€ä¿®æ”¹ï¼Œå°±åƒç®¡ç†æ™®é€šçš„ä»£ç ä¸€æ ·ã€‚ ","date":"2023-07-15","objectID":"/posts/dockerintroduction/:1:1","tags":["docker"],"title":"Dockerå®‰è£…åŠå­¦ä¹ ","uri":"/posts/dockerintroduction/"},{"categories":["Memo"],"content":"äºŒã€docker å®‰è£… å‚è€ƒè¿æ¥:ubuntuä¸‹dockerçš„å®‰è£… å®‰è£…å®Œæˆåï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒéªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸã€‚ docker version # or docker info Docker éœ€è¦ç”¨æˆ·å…·æœ‰ sudo æƒé™ï¼Œä¸ºäº†é¿å…æ¯æ¬¡å‘½ä»¤éƒ½è¾“å…¥sudoï¼Œå¯ä»¥æŠŠç”¨æˆ·åŠ å…¥ Docker ç”¨æˆ·ç»„ã€‚ # åˆ›å»ºdockerç”¨æˆ·ç»„ sudo groupadd docker # åº”ç”¨ç”¨æˆ·åŠ å…¥dockerç”¨æˆ·ç»„ sudo usermod -aG docker $USER # é‡å¯dockeræœåŠ¡ sudo systemctl restart docker su root su ${USER} Dockeræ˜¯æœåŠ¡å™¨â€“å®¢æˆ·ç«¯(serverâ€“client)æ¶æ„ã€‚å‘½ä»¤è¡Œè¿è¡Œdockerå‘½ä»¤çš„æ—¶å€™ï¼Œéœ€è¦æœ¬æœºæœ‰ Docker æœåŠ¡ã€‚å¦‚æœè¿™é¡¹æœåŠ¡æ²¡æœ‰å¯åŠ¨ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨: # service å‘½ä»¤çš„ç”¨æ³• sudo service docker start # systemctl å‘½ä»¤çš„ç”¨æ³• sudo systemctl start docker ","date":"2023-07-15","objectID":"/posts/dockerintroduction/:1:2","tags":["docker"],"title":"Dockerå®‰è£…åŠå­¦ä¹ ","uri":"/posts/dockerintroduction/"},{"categories":["Memo"],"content":"ä¸‰ã€image æ–‡ä»¶ Docker æŠŠåº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–ï¼Œæ‰“åŒ…åœ¨ image æ–‡ä»¶é‡Œé¢ã€‚åªæœ‰é€šè¿‡è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰èƒ½ç”Ÿæˆ Docker å®¹å™¨ã€‚image æ–‡ä»¶å¯ä»¥çœ‹ä½œæ˜¯å®¹å™¨çš„æ¨¡æ¿ã€‚Docker æ ¹æ® image æ–‡ä»¶ç”Ÿæˆå®¹å™¨çš„å®ä¾‹ã€‚åŒä¸€ä¸ª image æ–‡ä»¶ï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªåŒæ—¶è¿è¡Œçš„å®¹å™¨å®ä¾‹ã€‚ image æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å®é™…å¼€å‘ä¸­ï¼Œä¸€ä¸ª image æ–‡ä»¶å¾€å¾€é€šè¿‡ç»§æ‰¿å¦ä¸€ä¸ª image æ–‡ä»¶ï¼ŒåŠ ä¸Šä¸€äº›ä¸ªæ€§åŒ–è®¾ç½®è€Œç”Ÿæˆã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä½ å¯ä»¥åœ¨ Ubuntu çš„ image åŸºç¡€ä¸Šï¼Œå¾€é‡Œé¢åŠ å…¥ Apache æœåŠ¡å™¨ï¼Œå½¢æˆä½ çš„ imageã€‚ # åˆ—å‡ºæœ¬æœºçš„æ‰€æœ‰ image æ–‡ä»¶ã€‚ $ docker image ls # åˆ é™¤ image æ–‡ä»¶ $ docker image rm [imageName] image æ–‡ä»¶æ˜¯é€šç”¨çš„ï¼Œä¸€å°æœºå™¨çš„ image æ–‡ä»¶æ‹·è´åˆ°å¦ä¸€å°æœºå™¨ï¼Œç…§æ ·å¯ä»¥ä½¿ç”¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡ä½¿ç”¨åˆ«äººåˆ¶ä½œå¥½çš„ image æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è‡ªå·±åˆ¶ä½œã€‚å³ä½¿è¦å®šåˆ¶ï¼Œä¹Ÿåº”è¯¥åŸºäºåˆ«äººçš„ image æ–‡ä»¶è¿›è¡ŒåŠ å·¥ï¼Œè€Œä¸æ˜¯ä»é›¶å¼€å§‹åˆ¶ä½œã€‚ ä¸ºäº†æ–¹ä¾¿å…±äº«ï¼Œimage æ–‡ä»¶åˆ¶ä½œå®Œæˆåï¼Œå¯ä»¥ä¸Šä¼ åˆ°ç½‘ä¸Šçš„ä»“åº“ã€‚Docker çš„å®˜æ–¹ä»“åº“ Docker Hub æ˜¯æœ€é‡è¦ã€æœ€å¸¸ç”¨çš„ image ä»“åº“ã€‚æ­¤å¤–ï¼Œå‡ºå”®è‡ªå·±åˆ¶ä½œçš„ image æ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ ","date":"2023-07-15","objectID":"/posts/dockerintroduction/:1:3","tags":["docker"],"title":"Dockerå®‰è£…åŠå­¦ä¹ ","uri":"/posts/dockerintroduction/"},{"categories":["Memo"],"content":"å››ã€å®ä¾‹ï¼šhello world é¦–å…ˆï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå°† image æ–‡ä»¶ä»ä»“åº“æŠ“å–åˆ°æœ¬åœ°ã€‚ docker image pull library/hello-world ä¸Šé¢ä»£ç ä¸­ï¼Œdocker image pullæ˜¯æŠ“å– image æ–‡ä»¶çš„å‘½ä»¤ã€‚library/hello-worldæ˜¯ image æ–‡ä»¶åœ¨ä»“åº“é‡Œé¢çš„ä½ç½®ï¼Œå…¶ä¸­libraryæ˜¯ image æ–‡ä»¶æ‰€åœ¨çš„ç»„ï¼Œhello-worldæ˜¯ image æ–‡ä»¶çš„åå­—ã€‚ ç”±äº Docker å®˜æ–¹æä¾›çš„ image æ–‡ä»¶ï¼Œéƒ½æ”¾åœ¨libraryç»„é‡Œé¢ï¼Œæ‰€ä»¥å®ƒçš„æ˜¯é»˜è®¤ç»„ï¼Œå¯ä»¥çœç•¥ã€‚å› æ­¤ï¼Œä¸Šé¢çš„å‘½ä»¤å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚ docker image pull hello-world æŠ“å–æˆåŠŸä»¥åï¼Œå°±å¯ä»¥åœ¨æœ¬æœºçœ‹åˆ°è¿™ä¸ª image æ–‡ä»¶äº†ã€‚ docker image ls è¿è¡Œimage: docker container run hello-world docker container runå‘½ä»¤ä¼šä» image æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨å®ä¾‹ã€‚ æ³¨æ„ï¼Œdocker container runå‘½ä»¤å…·æœ‰è‡ªåŠ¨æŠ“å– image æ–‡ä»¶çš„åŠŸèƒ½ã€‚å¦‚æœå‘ç°æœ¬åœ°æ²¡æœ‰æŒ‡å®šçš„ image æ–‡ä»¶ï¼Œå°±ä¼šä»ä»“åº“è‡ªåŠ¨æŠ“å–ã€‚å› æ­¤ï¼Œå‰é¢çš„docker image pullå‘½ä»¤å¹¶ä¸æ˜¯å¿…éœ€çš„æ­¥éª¤ã€‚ å¦‚æœè¿è¡ŒæˆåŠŸï¼Œä½ ä¼šåœ¨å±å¹•ä¸Šè¯»åˆ°ä¸‹é¢çš„è¾“å‡ºã€‚ $ docker container run hello-world Hello from Docker! This message shows that your installation appears to be working correctly. ... ... è¾“å‡ºè¿™æ®µæç¤ºä»¥åï¼Œhello worldå°±ä¼šåœæ­¢è¿è¡Œï¼Œå®¹å™¨è‡ªåŠ¨ç»ˆæ­¢ã€‚ æœ‰äº›å®¹å™¨ä¸ä¼šè‡ªåŠ¨ç»ˆæ­¢ï¼Œå› ä¸ºæä¾›çš„æ˜¯æœåŠ¡ã€‚æ¯”å¦‚ï¼Œå®‰è£…è¿è¡Œ Ubuntu çš„ imageï¼Œå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œä½“éªŒ Ubuntu ç³»ç»Ÿã€‚ $ docker container run -it ubuntu bash å¯¹äºé‚£äº›ä¸ä¼šè‡ªåŠ¨ç»ˆæ­¢çš„å®¹å™¨ï¼Œå¿…é¡»ä½¿ç”¨docker container killå‘½ä»¤æ‰‹åŠ¨ç»ˆæ­¢ã€‚ $ docker container kill [containID] ","date":"2023-07-15","objectID":"/posts/dockerintroduction/:1:4","tags":["docker"],"title":"Dockerå®‰è£…åŠå­¦ä¹ ","uri":"/posts/dockerintroduction/"},{"categories":["Memo"],"content":"äº”ã€å®¹å™¨æ–‡ä»¶ imageæ–‡ä»¶ç”Ÿæˆçš„å®¹å™¨å®ä¾‹ï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œç§°ä¸ºå®¹å™¨æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦å®¹å™¨ç”Ÿæˆï¼Œå°±ä¼šåŒæ—¶å­˜åœ¨ä¸¤ä¸ªæ–‡ä»¶ï¼š imageæ–‡ä»¶å’Œå®¹å™¨æ–‡ä»¶ã€‚è€Œä¸”å…³é—­å®¹å™¨å¹¶ä¸ä¼šåˆ é™¤å®¹å™¨æ–‡ä»¶ï¼Œåªæ˜¯å®¹å™¨åœæ­¢è¿è¡Œè€Œå·²ã€‚ ä¸Šé¢å‘½ä»¤çš„è¾“å‡ºç»“æœä¹‹ä¸­ï¼ŒåŒ…æ‹¬å®¹å™¨çš„ IDã€‚å¾ˆå¤šåœ°æ–¹éƒ½éœ€è¦æä¾›è¿™ä¸ª IDï¼Œæ¯”å¦‚ä¸Šä¸€èŠ‚ç»ˆæ­¢å®¹å™¨è¿è¡Œçš„docker container killå‘½ä»¤ã€‚ ç»ˆæ­¢è¿è¡Œçš„å®¹å™¨æ–‡ä»¶ï¼Œä¾ç„¶ä¼šå æ®ç¡¬ç›˜ç©ºé—´ï¼Œå¯ä»¥ä½¿ç”¨docker container rmå‘½ä»¤åˆ é™¤ã€‚ $ docker container rm [containerID] è¿è¡Œä¸Šé¢çš„å‘½ä»¤ä¹‹åï¼Œå†ä½¿ç”¨docker container ls --allå‘½ä»¤ï¼Œå°±ä¼šå‘ç°è¢«åˆ é™¤çš„å®¹å™¨æ–‡ä»¶å·²ç»æ¶ˆå¤±äº†ã€‚ ","date":"2023-07-15","objectID":"/posts/dockerintroduction/:1:5","tags":["docker"],"title":"Dockerå®‰è£…åŠå­¦ä¹ ","uri":"/posts/dockerintroduction/"},{"categories":["Memo"],"content":"å…­ã€ Dockerfile æ–‡ä»¶ å­¦ä¼šä½¿ç”¨ image æ–‡ä»¶ä»¥åï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯ï¼Œå¦‚ä½•å¯ä»¥ç”Ÿæˆ image æ–‡ä»¶ï¼Ÿå¦‚æœä½ è¦æ¨å¹¿è‡ªå·±çš„è½¯ä»¶ï¼ŒåŠ¿å¿…è¦è‡ªå·±åˆ¶ä½œ image æ–‡ä»¶ã€‚ è¿™å°±éœ€è¦ç”¨åˆ° Dockerfile æ–‡ä»¶ã€‚å®ƒæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œç”¨æ¥é…ç½® imageã€‚Docker æ ¹æ® è¯¥æ–‡ä»¶ç”ŸæˆäºŒè¿›åˆ¶çš„ image æ–‡ä»¶ã€‚ ä¸‹é¢é€šè¿‡ä¸€ä¸ªå®ä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ç¼–å†™ Dockerfile æ–‡ä»¶ã€‚ ","date":"2023-07-15","objectID":"/posts/dockerintroduction/:1:6","tags":["docker"],"title":"Dockerå®‰è£…åŠå­¦ä¹ ","uri":"/posts/dockerintroduction/"},{"categories":["Memo"],"content":"ä¸ƒã€å®ä¾‹: ä¸‹é¢æˆ‘ä»¥ koa-demos é¡¹ç›®ä¸ºä¾‹ï¼Œä»‹ç»æ€ä¹ˆå†™ Dockerfile æ–‡ä»¶ï¼Œå®ç°è®©ç”¨æˆ·åœ¨ Docker å®¹å™¨é‡Œé¢è¿è¡Œ Koa æ¡†æ¶ã€‚ ä½œä¸ºå‡†å¤‡å·¥ä½œï¼Œè¯·å…ˆä¸‹è½½æºç []ã€‚ $ git clone https://github.com/ruanyf/koa-demos.git $ cd koa-demos 7.1 ç¼–å†™ Dockerfile æ–‡ä»¶ é¦–å…ˆï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶.dockerignoreï¼Œå†™å…¥ä¸‹é¢çš„å†…å®¹ã€‚ .git node_modules npm-debug.log ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œè¿™ä¸‰ä¸ªè·¯å¾„è¦æ’é™¤ï¼Œä¸è¦æ‰“åŒ…è¿›å…¥ image æ–‡ä»¶ã€‚å¦‚æœä½ æ²¡æœ‰è·¯å¾„è¦æ’é™¤ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥ä¸æ–°å»ºã€‚ ç„¶åï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ Dockerfileï¼Œå†™å…¥ä¸‹é¢çš„å†…å®¹ã€‚ FROM node:8.4 COPY . /app WORKDIR /app RUN npm install --registry=https://registry.npm.taobao.org EXPOSE 3000 ä¸Šé¢ä»£ç ä¸€å…±äº”è¡Œï¼Œå«ä¹‰å¦‚ä¸‹ã€‚ FROM node:8.4ï¼šè¯¥ image æ–‡ä»¶ç»§æ‰¿å®˜æ–¹çš„ node imageï¼Œå†’å·è¡¨ç¤ºæ ‡ç­¾ï¼Œè¿™é‡Œæ ‡ç­¾æ˜¯8.4ï¼Œå³8.4ç‰ˆæœ¬çš„ nodeã€‚ COPY . /appï¼šå°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆé™¤äº†.dockerignoreæ’é™¤çš„è·¯å¾„ï¼‰ï¼Œéƒ½æ‹·è´è¿›å…¥ image æ–‡ä»¶çš„/appç›®å½•ã€‚ WORKDIR /appï¼šæŒ‡å®šæ¥ä¸‹æ¥çš„å·¥ä½œè·¯å¾„ä¸º/appã€‚ RUN npm installï¼šåœ¨/appç›®å½•ä¸‹ï¼Œè¿è¡Œnpm installå‘½ä»¤å®‰è£…ä¾èµ–ã€‚æ³¨æ„ï¼Œå®‰è£…åæ‰€æœ‰çš„ä¾èµ–ï¼Œéƒ½å°†æ‰“åŒ…è¿›å…¥ image æ–‡ä»¶ã€‚ EXPOSE 3000ï¼šå°†å®¹å™¨ 3000 ç«¯å£æš´éœ²å‡ºæ¥ï¼Œ å…è®¸å¤–éƒ¨è¿æ¥è¿™ä¸ªç«¯å£ã€‚ 7.2 åˆ›å»ºimageæ–‡ä»¶ æœ‰äº† Dockerfile æ–‡ä»¶ä»¥åï¼Œå°±å¯ä»¥ä½¿ç”¨docker image buildå‘½ä»¤åˆ›å»º image æ–‡ä»¶äº†ã€‚ $ docker image build -t koa-demo . # æˆ–è€… $ docker image build -t koa-demo:0.0.1 . ä¸Šé¢ä»£ç ä¸­ï¼Œ-tå‚æ•°ç”¨æ¥æŒ‡å®š image æ–‡ä»¶çš„åå­—ï¼Œåé¢è¿˜å¯ä»¥ç”¨å†’å·æŒ‡å®šæ ‡ç­¾ã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤çš„æ ‡ç­¾å°±æ˜¯latestã€‚æœ€åçš„é‚£ä¸ªç‚¹è¡¨ç¤º Dockerfile æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„ï¼Œä¸Šä¾‹æ˜¯å½“å‰è·¯å¾„ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªç‚¹ã€‚ å¦‚æœè¿è¡ŒæˆåŠŸï¼Œå°±å¯ä»¥çœ‹åˆ°æ–°ç”Ÿæˆçš„ image æ–‡ä»¶koa-demoäº†ã€‚ docker image ls 7.3 ç”Ÿæˆå®¹å™¨ docker container runå‘½ä»¤ä¼šä» image æ–‡ä»¶ç”Ÿæˆå®¹å™¨ã€‚ $ docker container run -p 8000:3000 -it koa-demo /bin/bash # æˆ–è€… $ docker container run -p 8000:3000 -it koa-demo:0.0.1 /bin/bash ä¸Šé¢å‘½ä»¤çš„å„ä¸ªå‚æ•°å«ä¹‰å¦‚ä¸‹ï¼š på‚æ•°ï¼šå®¹å™¨çš„ 3000 ç«¯å£æ˜ å°„åˆ°æœ¬æœºçš„ 8000 ç«¯å£ã€‚ itå‚æ•°ï¼šå®¹å™¨çš„ Shell æ˜ å°„åˆ°å½“å‰çš„ Shellï¼Œç„¶åä½ åœ¨æœ¬æœºçª—å£è¾“å…¥çš„å‘½ä»¤ï¼Œå°±ä¼šä¼ å…¥å®¹å™¨ã€‚ koa-demo:0.0.1ï¼šimage æ–‡ä»¶çš„åå­—ï¼ˆå¦‚æœæœ‰æ ‡ç­¾ï¼Œè¿˜éœ€è¦æä¾›æ ‡ç­¾ï¼Œé»˜è®¤æ˜¯ latest æ ‡ç­¾ï¼‰ã€‚ /bin/bashï¼šå®¹å™¨å¯åŠ¨ä»¥åï¼Œå†…éƒ¨ç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å‘½ä»¤ã€‚è¿™é‡Œæ˜¯å¯åŠ¨ Bashï¼Œä¿è¯ç”¨æˆ·å¯ä»¥ä½¿ç”¨ Shellã€‚ å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œè¿è¡Œä¸Šé¢çš„å‘½ä»¤ä»¥åï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªå‘½ä»¤è¡Œæç¤ºç¬¦ã€‚ root@66d80f4aaf1e:/app# è¿™è¡¨ç¤ºä½ å·²ç»åœ¨å®¹å™¨é‡Œé¢äº†ï¼Œè¿”å›çš„æç¤ºç¬¦å°±æ˜¯å®¹å™¨å†…éƒ¨çš„ Shell æç¤ºç¬¦ã€‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚ root@66d80f4aaf1e:/app# node demos/01.js è¿™æ—¶ï¼ŒKoa æ¡†æ¶å·²ç»è¿è¡Œèµ·æ¥äº†ã€‚æ‰“å¼€æœ¬æœºçš„æµè§ˆå™¨ï¼Œè®¿é—® http://127.0.0.1:8000ï¼Œç½‘é¡µæ˜¾ç¤º\"Not Found\"ï¼Œè¿™æ˜¯å› ä¸ºè¿™ä¸ª demo æ²¡æœ‰å†™è·¯ç”±ã€‚ è¿™ä¸ªä¾‹å­ä¸­ï¼ŒNode è¿›ç¨‹è¿è¡Œåœ¨ Docker å®¹å™¨çš„è™šæ‹Ÿç¯å¢ƒé‡Œé¢ï¼Œè¿›ç¨‹æ¥è§¦åˆ°çš„æ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œæ¥å£éƒ½æ˜¯è™šæ‹Ÿçš„ï¼Œä¸æœ¬æœºçš„æ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œæ¥å£æ˜¯éš”ç¦»çš„ï¼Œå› æ­¤éœ€è¦å®šä¹‰å®¹å™¨ä¸ç‰©ç†æœºçš„ç«¯å£æ˜ å°„ï¼ˆmapï¼‰ã€‚ ç°åœ¨ï¼Œåœ¨å®¹å™¨çš„å‘½ä»¤è¡Œï¼ŒæŒ‰ä¸‹ Ctrl + c åœæ­¢ Node è¿›ç¨‹ï¼Œç„¶åæŒ‰ä¸‹ Ctrl + d ï¼ˆæˆ–è€…è¾“å…¥ exitï¼‰é€€å‡ºå®¹å™¨ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨docker container killç»ˆæ­¢å®¹å™¨è¿è¡Œã€‚ # åœ¨æœ¬æœºçš„å¦ä¸€ä¸ªç»ˆç«¯çª—å£ï¼ŒæŸ¥å‡ºå®¹å™¨çš„ ID $ docker container ls # åœæ­¢æŒ‡å®šçš„å®¹å™¨è¿è¡Œ $ docker container kill [containerID] å®¹å™¨åœæ­¢è¿è¡Œä¹‹åï¼Œå¹¶ä¸ä¼šæ¶ˆå¤±ï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤åˆ é™¤å®¹å™¨æ–‡ä»¶ã€‚ # æŸ¥å‡ºå®¹å™¨çš„ ID $ docker container ls --all # åˆ é™¤æŒ‡å®šçš„å®¹å™¨æ–‡ä»¶ $ docker container rm [containerID] ä¹Ÿå¯ä»¥ä½¿ç”¨docker container runå‘½ä»¤çš„â€“rmå‚æ•°ï¼Œåœ¨å®¹å™¨ç»ˆæ­¢è¿è¡Œåè‡ªåŠ¨åˆ é™¤å®¹å™¨æ–‡ä»¶ã€‚ $ docker container run --rm -p 8000:3000 -it koa-demo /bin/bash 7.4 CMDå‘½ä»¤ ä¸Šä¸€èŠ‚çš„ä¾‹å­é‡Œé¢ï¼Œå®¹å™¨å¯åŠ¨ä»¥åï¼Œéœ€è¦æ‰‹åŠ¨è¾“å…¥å‘½ä»¤node demos/01.jsã€‚æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªå‘½ä»¤å†™åœ¨ Dockerfile é‡Œé¢ï¼Œè¿™æ ·å®¹å™¨å¯åŠ¨ä»¥åï¼Œè¿™ä¸ªå‘½ä»¤å°±å·²ç»æ‰§è¡Œäº†ï¼Œä¸ç”¨å†æ‰‹åŠ¨è¾“å…¥äº†ã€‚ FROM node:8.4 COPY . /app WORKDIR /app RUN npm install --registry=https://registry.npm.taobao.org EXPOSE 3000 CMD node demos/01.js ä¸Šé¢çš„ Dockerfile é‡Œé¢ï¼Œå¤šäº†æœ€åä¸€è¡ŒCMD node demos/01.jsï¼Œå®ƒè¡¨ç¤ºå®¹å™¨å¯åŠ¨åè‡ªåŠ¨æ‰§è¡Œnode demos/01.jsã€‚ ä½ å¯èƒ½ä¼šé—®ï¼ŒRUNå‘½ä»¤ä¸CMDå‘½ä»¤çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿç®€å•è¯´ï¼ŒRUNå‘½ä»¤åœ¨ image æ–‡ä»¶çš„æ„å»ºé˜¶æ®µæ‰§è¡Œï¼Œæ‰§è¡Œç»“æœéƒ½ä¼šæ‰“åŒ…è¿›å…¥ image æ–‡ä»¶ï¼›CMDå‘½ä»¤åˆ™æ˜¯åœ¨å®¹å™¨å¯åŠ¨åæ‰§è¡Œã€‚å¦å¤–ï¼Œä¸€ä¸ª Dockerfile å¯ä»¥åŒ…å«å¤šä¸ªRUNå‘½ä»¤ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªCMDå‘½ä»¤ã€‚ æ³¨æ„ï¼ŒæŒ‡å®šäº†CMDå‘½ä»¤ä»¥åï¼Œdocker container runå‘½ä»¤å°±ä¸èƒ½é™„åŠ å‘½ä»¤äº†ï¼ˆæ¯”å¦‚å‰é¢çš„/bin/bashï¼‰ï¼Œå¦åˆ™å®ƒä¼šè¦†ç›–CMDå‘½ä»¤ã€‚ç°åœ¨ï¼Œå¯åŠ¨å®¹å™¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚ $ docker container run --rm -p 8000:3000 -it koa-demo:0.0.1 7.5 å‘å¸ƒ image æ–‡ä»¶ å®¹å™¨è¿è¡ŒæˆåŠŸåï¼Œå°±ç¡®è®¤äº† image æ–‡ä»¶çš„æœ‰æ•ˆæ€§ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘æŠŠ image æ–‡ä»¶åˆ†äº«åˆ°ç½‘ä¸Šï¼Œè®©å…¶ä»–äººä½¿ç”¨ã€‚ é¦–å…ˆï¼Œå» hub.docker.com æˆ– cloud.docker.com æ³¨å†Œä¸€ä¸ªè´¦æˆ·ã€‚ç„¶åï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤ç™»å½•ã€‚ $ docker login æ¥ç€ï¼Œä¸ºæœ¬åœ°çš„ image æ ‡æ³¨ç”¨æˆ·åå’Œç‰ˆæœ¬ã€‚ $ docker image tag [imageName] [username]/[repository]:[tag] # å®ä¾‹ $ docker image tag koa-demos:0.0.1 ruanyf/koa-demos:0.0.1 ä¹Ÿå¯ä»¥ä¸æ ‡æ³¨ç”¨æˆ·åï¼Œé‡æ–°æ„å»ºä¸€ä¸‹ image æ–‡ä»¶ã€‚ $ docker image build -t [username]/[repository]:[tag] . æœ€åï¼Œå‘å¸ƒ image æ–‡ä»¶ã€‚ $ docker image push [username]/[repository]:[tag] å‘å¸ƒæˆåŠŸä»¥åï¼Œç™»å½• hub.docker.comï¼Œå°±å¯ä»¥çœ‹åˆ°å·²ç»å‘å¸ƒçš„ image æ–‡ä»¶ã€‚ ","date":"2023-07-15","objectID":"/posts/dockerintroduction/:1:7","tags":["docker"],"title":"Dockerå®‰è£…åŠå­¦ä¹ ","uri":"/posts/dockerintroduction/"},{"categories":["Memo"],"content":"å…«ã€å…¶ä»–æœ‰ç”¨çš„å‘½ä»¤ (1) docker container start å‰é¢çš„docker container runå‘½ä»¤æ˜¯æ–°å»ºå®¹å™¨ï¼Œæ¯è¿è¡Œä¸€æ¬¡ï¼Œå°±ä¼šæ–°å»ºä¸€ä¸ªå®¹å™¨ã€‚åŒæ ·çš„å‘½ä»¤è¿è¡Œä¸¤æ¬¡ï¼Œå°±ä¼šç”Ÿæˆä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·çš„å®¹å™¨æ–‡ä»¶ã€‚å¦‚æœå¸Œæœ›é‡å¤ä½¿ç”¨å®¹å™¨ï¼Œå°±è¦ä½¿ç”¨docker container startå‘½ä»¤ï¼Œå®ƒç”¨æ¥å¯åŠ¨å·²ç»ç”Ÿæˆã€å·²ç»åœæ­¢è¿è¡Œçš„å®¹å™¨æ–‡ä»¶ã€‚ $ docker container start [containerID] (2) docker container stop å‰é¢çš„docker container killå‘½ä»¤ç»ˆæ­¢å®¹å™¨è¿è¡Œï¼Œç›¸å½“äºå‘å®¹å™¨é‡Œé¢çš„ä¸»è¿›ç¨‹å‘å‡º SIGKILL ä¿¡å·ã€‚è€Œdocker container stopå‘½ä»¤ä¹Ÿæ˜¯ç”¨æ¥ç»ˆæ­¢å®¹å™¨è¿è¡Œï¼Œç›¸å½“äºå‘å®¹å™¨é‡Œé¢çš„ä¸»è¿›ç¨‹å‘å‡º SIGTERM ä¿¡å·ï¼Œç„¶åè¿‡ä¸€æ®µæ—¶é—´å†å‘å‡º SIGKILL ä¿¡å·ã€‚ docker container stop [containerID] è¿™ä¸¤ä¸ªä¿¡å·çš„å·®åˆ«æ˜¯ï¼Œåº”ç”¨ç¨‹åºæ”¶åˆ° SIGTERM ä¿¡å·ä»¥åï¼Œå¯ä»¥è‡ªè¡Œè¿›è¡Œæ”¶å°¾æ¸…ç†å·¥ä½œï¼Œä½†ä¹Ÿå¯ä»¥ä¸ç†ä¼šè¿™ä¸ªä¿¡å·ã€‚å¦‚æœæ”¶åˆ° SIGKILL ä¿¡å·ï¼Œå°±ä¼šå¼ºè¡Œç«‹å³ç»ˆæ­¢ï¼Œé‚£äº›æ­£åœ¨è¿›è¡Œä¸­çš„æ“ä½œä¼šå…¨éƒ¨ä¸¢å¤±ã€‚ (3) docker container logs docker container logså‘½ä»¤ç”¨æ¥æŸ¥çœ‹ docker å®¹å™¨çš„è¾“å‡ºï¼Œå³å®¹å™¨é‡Œé¢ Shell çš„æ ‡å‡†è¾“å‡ºã€‚å¦‚æœdocker runå‘½ä»¤è¿è¡Œå®¹å™¨çš„æ—¶å€™ï¼Œæ²¡æœ‰ä½¿ç”¨-itå‚æ•°ï¼Œå°±è¦ç”¨è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹è¾“å‡ºã€‚ docker container logs [containerID] (4) docker container exec docker container execå‘½ä»¤ç”¨äºè¿›å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ docker å®¹å™¨ã€‚å¦‚æœdocker runå‘½ä»¤è¿è¡Œå®¹å™¨çš„æ—¶å€™ï¼Œæ²¡æœ‰ä½¿ç”¨-itå‚æ•°ï¼Œå°±è¦ç”¨è¿™ä¸ªå‘½ä»¤è¿›å…¥å®¹å™¨ã€‚ä¸€æ—¦è¿›å…¥äº†å®¹å™¨ï¼Œå°±å¯ä»¥åœ¨å®¹å™¨çš„ Shell æ‰§è¡Œå‘½ä»¤äº†ã€‚ $ docker container exec -it [containerID] /bin/bash (5) docker container cp å’Œ docker cp docker container cpå‘½ä»¤ç”¨äºä»æ­£åœ¨è¿è¡Œçš„ Docker å®¹å™¨é‡Œé¢ï¼Œå°†æ–‡ä»¶æ‹·è´åˆ°æœ¬æœºã€‚ä¸‹é¢æ˜¯æ‹·è´åˆ°å½“å‰ç›®å½•çš„å†™æ³•ã€‚ docker container cp [containID]:[/path/to/file] . docker cpå‘½ä»¤ç”¨äºä»å°†å®¿ä¸»æœºå†…çš„æ–‡ä»¶æ‹·è´æ–‡ä»¶åˆ°containerä¸­: docker cp [OPTIONS] [src path] [container id]:[dest path] éå¸¸æ„Ÿè°¢ä½ ä¸€ç›´è¯»åˆ°äº†è¿™é‡Œï¼Œè¿™ä¸ªç³»åˆ—è¿˜æœ‰ä¸‹ä¸€ç¯‡ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨ Docker æ­å»ºçœŸæ­£çš„ç½‘ç«™ï¼Œæ¬¢è¿ç»§ç»­é˜…è¯»ã€‚ (6) docker commit docker commitå‘½ä»¤ç”¨äºä¿å­˜containerçš„ä¿®æ”¹ã€‚ docker commit -m \"commit message\" [containr ID] [new REPOSITORY:TAG] (7) docker save and docker load docker save å’Œ docker load å°†imageæ–‡ä»¶ä¿å­˜ä¸ºå‹ç¼©æ–‡ä»¶æˆ–è€…åŠ è½½æœ¬åœ°çš„å‹ç¼©æ–‡ä»¶ä¸ºimageã€‚ docker save -o [outputname path] [REPOSITORY:TAG] docker load -i [outputname.tar] ","date":"2023-07-15","objectID":"/posts/dockerintroduction/:1:8","tags":["docker"],"title":"Dockerå®‰è£…åŠå­¦ä¹ ","uri":"/posts/dockerintroduction/"},{"categories":["Memo"],"content":"ä¸€ã€ apt-get source update apt-get source change the /etc/apt/sources.list file to aliyun source add sudo user in rootlink adduser [name] apt-get install sudo èµ‹äºˆç”¨æˆ·sudoæƒé™: sudo usermod -a -G adm username sudo usermod -a -G sudo username su [name] åœ¨æ–‡ä»¶/etc/sudoersä¸­æ›´æ”¹ç”¨æˆ·çš„sudoæƒé™: # sudoers file. # # This file MUST be edited with the 'vi sudo' command as root. # # See the sudoers man page for the details on how to write a sudoers file. # # Host alias specification # User alias specification # Cmnd alias specification # Defaults specification # User privilege specification root ALL=(ALL) ALL [username] ALL=(ALL) ALL # Uncomment to allow people in group wheel to run all commands # %wheel ALL=(ALL) ALL # Same thing without a password # %wheel ALL=(ALL) NOPASSWD: ALL # Samples # %users ALL=/sbin/mount /cdrom,/sbin/umount /cdrom # %users localhost=/sbin/shutdown -h now ","date":"2023-07-15","objectID":"/posts/softwareinstallation/:1:0","tags":["Linux"],"title":"ç¨‹åºå®‰è£…æ•™ç¨‹","uri":"/posts/softwareinstallation/"},{"categories":["Memo"],"content":"äºŒã€ Anaconda or Miniconda Installation download anaconda or miniconda from tsinghua source website download command: wget https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda3-latest-Linux-x86_64.sh run the command to install: bash Miniconda3-latest-linux-x86_64.sh change the conda channels to tsinghua source nano ~/.condarc paste the following channels into your ~/.condarc file:ref link conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/ conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/ #Conda Forge conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/ #msys2ï¼ˆå¯ç•¥ï¼‰ conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/ #biocondaï¼ˆå¯ç•¥ï¼‰ conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/ #menpoï¼ˆå¯ç•¥ï¼‰ conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/menpo/ #pytorch conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/ # for legacy win-64ï¼ˆå¯ç•¥ï¼‰ conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/peterjc123/ conda config --set show_channel_urls yes anaconda ç¯å¢ƒæ–‡ä»¶environment.ymlä½¿ç”¨å‚è€ƒ åˆ›å»ºç¯å¢ƒ: conda env create -f environment.yml -n myenv å¯¼å‡ºå½“å‰ç¯å¢ƒé…ç½®: conda env export \u003e environment.yml æ›´æ–°ç¯å¢ƒ: conda env update -f environment.yml ","date":"2023-07-15","objectID":"/posts/softwareinstallation/:2:0","tags":["Linux"],"title":"ç¨‹åºå®‰è£…æ•™ç¨‹","uri":"/posts/softwareinstallation/"},{"categories":["Memo"],"content":"ä¸‰ã€ Cmake Installation Ref Link Download cmake source file: wget https://cmake.org/files/v3.20/cmake-3.20.0-linux-x86_64.tar.gz extract the file and move the file to /opt/cmake-3.20.0 tar zxvf cmake-3.20.0-linux-x86_64.tar.gz mv cmake-3.20.0-linux-x86_64 /opt/cmake-3.20.0 link the cmake as system cmake ln -sf /opt/cmake-3.20.0/bin/* /usr/bin/ check if successfully installed cmake --version ","date":"2023-07-15","objectID":"/posts/softwareinstallation/:3:0","tags":["Linux"],"title":"ç¨‹åºå®‰è£…æ•™ç¨‹","uri":"/posts/softwareinstallation/"},{"categories":["Memo"],"content":"å››ã€ Openmpi Installation Ref Link Install openmpi with command line: sudo apt-get install openmpi-bin openmpi-doc libopenmpi-dev åœ¨condaä¸‹å®‰è£…openmapi: conda install openmpi ","date":"2023-07-15","objectID":"/posts/softwareinstallation/:4:0","tags":["Linux"],"title":"ç¨‹åºå®‰è£…æ•™ç¨‹","uri":"/posts/softwareinstallation/"},{"categories":["Memo"],"content":"äº”ã€ Anacondaä¸‹å®‰è£…jupyter notebook å®‰è£…jupyter notebook pip install jupyter notebook==6.1.0 å®‰è£…nbextensions pip install jupyter_contrib_nbextensions jupyter contrib nbextension install --user å¦‚æœé‡åˆ°å¦‚ä¸‹æŠ¥é”™ä¿¡æ¯: ModuleNotFoundError: No module named 'notebook.base' æ³¨æ„: ä¸€èˆ¬ç”±äºnotebookç‰ˆæœ¬\u003e=7.0.0å¯¼è‡´ åŸå› : Notebookçš„ç‰ˆæœ¬å¤ªé«˜äº†ï¼Œå°†notebookçš„ç‰ˆæœ¬é™åˆ°6.1.0 pip install jupyter notebook==6.1.0 # æˆ–è€… pip install --upgrade notebook==6.1.0 ç„¶åå†é‡æ–°å®‰è£…æ’ä»¶ã€‚ å®‰è£…nbextensions_configurator pip install jupyter_nbextensions_configurator jupyter nbextensions_configurator enable --user å¯åŠ¨jupyter Notebook jupyter notebook è‹¥å¦‚ä¸‹æŠ¥é”™: ModuleNotFoundError: No module named 'jupyter_server.contents' TypeError: warn() missing 1 required keyword-only argument: 'stacklevel' åˆ™æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…traitletsåº“: pip install traitlets==5.9.0 åœ¨codemirror.cssæ–‡ä»¶ä¸­æ›´æ”¹å­—ä½“ æ–‡ä»¶è·¯å¾„: /home/{$USERNAME}/miniconda3/envs/pytorch/lib/python3.8/site-packages/notebook/static/components/codemirror/lib/codemirror.css æ¨èå®‰è£…çš„å‡ ä¸ªjupyteræ’ä»¶: zenmode table of content(2) Autopep8 variable inspector ExecuteTime Hide input all éšè—ä»£ç è¾“å…¥ jupyter notebook v7.0 extension installation support: https://github.com/jupyter/notebook/discussions/6881 ","date":"2023-07-15","objectID":"/posts/softwareinstallation/:5:0","tags":["Linux"],"title":"ç¨‹åºå®‰è£…æ•™ç¨‹","uri":"/posts/softwareinstallation/"},{"categories":["Transformer"],"content":"reference: [1]. The Transformer Family [2]. Attention [3]. ç»†èŠ‚è€ƒç©¶ ","date":"2023-07-15","objectID":"/posts/transformerintroduction/:0:0","tags":["draft"],"title":"Transformer Introduction","uri":"/posts/transformerintroduction/"},{"categories":["Transformer"],"content":"Transformer Family ","date":"2023-07-15","objectID":"/posts/transformerintroduction/:1:0","tags":["draft"],"title":"Transformer Introduction","uri":"/posts/transformerintroduction/"},{"categories":["Transformer"],"content":"Notations Symbol Meaning $d$ The model size / hidden state dimension / positional encoding size. $h$ The number of heads in multi-head attention layer. $L$ The segment length of input sequence. $X \\in \\mathbb R ^ {L \\times d}$ The input sequence where each element has been mapped into an embedding vector of shape , same as the model size. $W^k \\in \\mathbb R ^ {d \\times d^k}$ The key weight matrix. $W^q \\in \\mathbb R ^ {d \\times d^k}$ The query weight matrix. $W^v \\in \\mathbb R ^ {d \\times d^k}$ The value weight matrix.Often we have $d_k = d_v = d$. $W^K_i, W^q_i \\in \\mathbb R ^ {d \\times d^k / h}; W^v_i \\in \\mathbb R^{d x d_v / h}$ The weight matrices per head. $W^o \\in \\mathbb d_v \\times d$ The output weight matrix. $Q = XW^q \\in \\mathbb R^{L \\times d_q}$ The query embedding inputs. $K = XW^k \\in \\mathbb R^{L \\times d_k}$ The key embedding inputs. $V = XW^v \\in \\mathbb R^{L \\times d_v}$ The value embedding inputs. $S_i$ A collection of key positions for the -th query to attend to. $A \\in \\mathbb R ^ {L \\times L}$ The self-attention matrix between a input sequence of lenght $L$ and itself. $A = softmax (Q K^T/\\sqrt{(d_k)} )$ $a_ij \\ in A $ The scalar attention score between query $q_i$ and key $k_j$. $P \\in \\mathbb R ^ {L \\times d}$ position encoding matrix, where the $i-th$ row is the positional encoding for input $x_i$. ","date":"2023-07-15","objectID":"/posts/transformerintroduction/:1:1","tags":["draft"],"title":"Transformer Introduction","uri":"/posts/transformerintroduction/"},{"categories":["Transformer"],"content":"Attention and Self-Attention Attention is a mechanism in the neural network that a model can learn to make predictions by selectively attending to a given set of data. The amount of attention is quantified by learned weights and thus the output is usually formed as a weighted average. Self-attention is a type of attention mechanism where the model makes prediction for one part of a data sample using other parts of the observation about the same sample. Conceptually, it feels quite similar to non-local means. Also note that self-attention is permutation-invariant; in other words, it is an operation on sets. There are various forms of attention / self-attention, Transformer (Vaswani et al., 2017) relies on the scaled dot-product attention: given a query matrix $Q$, a key matrix $K$ and a value matrix $V$, the output is a weighted sum of the value vectors, where the weight assigned to each value slot is determined by the dot-product of the query with the corresponding key: $$\\text{Attention}(Q, K, V) = softmax(\\frac{QK^T}{\\sqrt{d_k}})V$$ And for a query and a key vector $q_i, k_j \\in \\mathbb R ^ d$ (row vectors in query and key matrices), we have a scalar score: $$a_{ij} = softmax(\\frac{q_i k_j^T}{\\sqrt{d_k}}) = \\frac{\\exp(q_i k_j^T)}{\\sqrt{d_k}\\sum_{r \\in S_i}(q_i k_j^T)}$$ where $S_i$ is a collection of key positions for the $i$-th query to attend to. See my old post for other types of attention if interested. ","date":"2023-07-15","objectID":"/posts/transformerintroduction/:1:2","tags":["draft"],"title":"Transformer Introduction","uri":"/posts/transformerintroduction/"},{"categories":["Transformer"],"content":"Multi-Head Self-Attention The multi-head self-attention module is a key component in Transformer. Rather than only computing the attention once, the multi-head mechanism splits the inputs into smaller chunks and then computes the scaled dot-product attention over each subspace in parallel. The independent attention outputs are simply concatenated and linearly transformed into expected dimensions. $$\\text{MulitHeadAttention}(X_q, X_k, X_v) = [\\text{head}_1,;â€¦; \\text{head}_h] W^o, where \\text{head}_i = \\text{Attention}(X_qW_i^q, X_kW_i^k, X_vW_i^v)$$ where $[.;.]$ is a concatenation operation. $W_i^q, W_i^k \\in \\mathbb R^{d \\times d_{k} / h}$, $W_i^v \\in \\mathbb R^{d \\times d_{v} / h}$ are weight matrices to map input embeddings of size $L \\times d$ into query, key and value matrices. And $W^o \\in \\mathbb R ^ {d_v \\times d}$ is the output linear transformation. All the weights should be learned during training. ","date":"2023-07-15","objectID":"/posts/transformerintroduction/:1:3","tags":["draft"],"title":"Transformer Introduction","uri":"/posts/transformerintroduction/"},{"categories":["Transformer"],"content":"Transformer The Transformer (which will be referred to as â€œvanilla Transformerâ€ to distinguish it from other enhanced versions; Vaswani, et al., 2017) model has an encoder-decoder architecture, as commonly used in many NMT models. Later decoder-only Transformer was shown to achieve great performance in language modeling tasks, like in GPT and BERT. Encoder-Decoder Architecture The encoder generates an attention-based representation with capability to locate a specific piece of information from a large context. It consists of a stack of 6 identity modules, each containing two submodules, a multi-head self-attention layer and a point-wise fully connected feed-forward network. By point-wise, it means that it applies the same linear transformation (with same weights) to each element in the sequence. This can also be viewed as a convolutional layer with filter size 1. Each submodule has a residual connection and layer normalization. All the submodules output data of the same dimension $d$. The function of Transformer decoder is to retrieve information from the encoded representation. The architecture is quite similar to the encoder, except that the decoder contains two multi-head attention submodules instead of one in each identical repeating module. The first multi-head attention submodule is masked to prevent positions from attending to the future. Positional Encoding Because self-attention operation is permutation invariant, it is important to use proper positional encoding to provide order information to the model. The positional encoding $P \\in \\mathbb R ^ {L \\times d}$ has the same dimension as the input embedding, so it can be added on the input directly. The vanilla Transformer considered two types of encodings: (1). Sinusoidal positional encoding is defined as follows, given the token $i = 1, â€¦, L$ position and the dimension $\\delta = 1, â€¦, d$: $$ \\text{PE}(i, \\delta) = \\left{ \\begin{aligned} \\sin\\big(\\frac{i}{10000^{2\\deltaâ€™/d}}\\big) , if \\delta\u0026=2\\deltaâ€™\\ \\cos\\big(\\frac{i}{10000^{2\\deltaâ€™/d}}\\big) , if \\delta\u0026=2\\deltaâ€™+1 \\ \\end{aligned} \\right.$$ In this way each dimension of the positional encoding corresponds to a sinusoid of different wavelengths in different dimensions, from $2\\pi$ to 10000 * $2\\pi$. (2). Learned positional encoding, as its name suggested, assigns each element with a learned column vector which encodes its absolute position (Gehring, et al. 2017). ","date":"2023-07-15","objectID":"/posts/transformerintroduction/:1:4","tags":["draft"],"title":"Transformer Introduction","uri":"/posts/transformerintroduction/"},{"categories":["Planning"],"content":"[new ref 1] (https://zhuanlan.zhihu.com/p/619039492) [old ref 1] (https://zhuanlan.zhihu.com/p/399545248) ","date":"2023-07-15","objectID":"/posts/latticeplanner/:0:0","tags":["draft"],"title":"Lattice Planner","uri":"/posts/latticeplanner/"},{"categories":["Planning"],"content":"ä¸€ã€Lattice Plannerç®€ä»‹ LatticePlannerç®—æ³•å±äºä¸€ç§å±€éƒ¨è½¨è¿¹è§„åˆ’å™¨ï¼Œè¾“å‡ºè½¨è¿¹å°†ç›´æ¥è¾“å…¥åˆ°æ§åˆ¶å™¨ï¼Œç”±æ§åˆ¶å™¨å®Œæˆå¯¹å±€éƒ¨è½¨è¿¹çš„è·Ÿè¸ªæ§åˆ¶ã€‚å› æ­¤ï¼ŒLattice Plannerè¾“å‡ºçš„è½¨è¿¹æ˜¯ä¸€æ¡å…‰æ»‘æ— ç¢°æ’æ»¡è¶³è½¦è¾†è¿åŠ¨å­¦çº¦æŸå’Œé€Ÿåº¦çº¦æŸçš„å¹³ç¨³å®‰å…¨çš„å±€éƒ¨è½¨è¿¹ã€‚Lattice Plannerçš„è¾“å…¥ç«¯ä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œæ„ŸçŸ¥åŠéšœç¢ç‰©ä¿¡æ¯ã€å‚è€ƒçº¿ä¿¡æ¯åŠå®šä½ä¿¡æ¯ã€‚ [pic] å±€éƒ¨è§„åˆ’æ¨¡å—çš„è¾“å‡ºæ˜¯å¸¦æœ‰é€Ÿåº¦ä¿¡æ¯çš„ä¸€ç³»åˆ—è½¨è¿¹ç‚¹ç»„æˆçš„è½¨è¿¹ï¼Œå…¶ä¿è¯äº†è½¦è¾†æ§åˆ¶å™¨åœ¨è½¦è¾†è·Ÿè¸ªæ§åˆ¶è¿‡ç¨‹ä¸­çš„å¹³ç¨³æ€§å’Œå®‰å…¨æ€§ã€‚ ","date":"2023-07-15","objectID":"/posts/latticeplanner/:1:0","tags":["draft"],"title":"Lattice Planner","uri":"/posts/latticeplanner/"},{"categories":["Planning"],"content":"äºŒã€Latticeè§„åˆ’ç®—æ³•å®ç°è¿‡ç¨‹ Latticeè§„åˆ’ç®—æ³•æ˜¯ä¸€ç§åŸºäºé‡‡æ ·çš„è¿åŠ¨è§„åˆ’ç®—æ³•ï¼Œé€šè¿‡å°†è½¦è¾†åæ ‡ç³»è½¬æ¢åˆ°å‚è€ƒçº¿åæ ‡ç³»ï¼Œä¹Ÿå°±æ˜¯frenetåæ ‡ç³»ä¸‹ï¼Œç„¶ååœ¨frenetåæ ‡ç³»ä¸‹åˆ†åˆ«å¯¹frenetçš„dè½´å’Œsè½´è¿›è¡Œè§„åˆ’ï¼Œå½¢æˆfrenetåæ ‡ç³»ä¸‹çš„è§„åˆ’è½¨è¿¹ï¼Œç„¶åå°†frenetåæ ‡ç³»ä¸‹çš„è½¨è¿¹åˆæˆåˆ°ä¸–ç•Œåæ ‡ç³»ä¸‹è¿˜åŸä¸ºä¸–ç•Œåæ ‡ç³»ä¸‹çš„è½¨è¿¹ã€‚ç®—æ³•å®ç°è¿‡ç¨‹å¤§æ¦‚å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š å°†è½¦è¾†å½“å‰ä½å§¿ä¿¡æ¯è½¬æ¢åˆ°frenetåæ ‡ç³»ä¸‹ï¼Œè·å¾—è½¦è¾†åœ¨frenetåæ ‡ç³»çš„åˆå§‹çŠ¶æ€ï¼›æ ¹æ®å½“å‰é€Ÿåº¦è®¡ç®—å‰ç»è·ç¦»ï¼Œè·å¾—å‰ç»ç‚¹ï¼Œè·å¾—è½¦è¾†åœ¨å‰ç»ç‚¹ä½ç½®frenetåæ ‡ç³»ä¸‹çš„ç›®æ ‡çŠ¶æ€ã€‚ å¯¹è½¨è¿¹çŠ¶æ€è¿›è¡Œé‡‡æ ·ï¼Œåˆ†åˆ«æ˜¯è½¨è¿¹è¿è¡Œæ—¶é—´tï¼Œç›®æ ‡é€Ÿåº¦vï¼ŒåŠåˆ°å‚è€ƒçº¿çš„æ¨ªå‘ä½ç§»dï¼Œé€šè¿‡è¿™ä¸‰ä¸ªè§„åˆ’å‚æ•°å¯ä»¥è·å¾—é‡‡æ ·çŠ¶æ€ã€‚ æ„å»ºæ¨ªå‘ä½ç§»å’Œçºµå‘ä½ç§»çš„å¤šé¡¹å¼è§„åˆ’å‡½æ•°s(t)ï¼Œd(s)ï¼Œè·å¾—æ¨ªå‘ä½ç§»å’Œçºµå‘ä½ç§»çš„è§„åˆ’å‡½æ•°åï¼Œè¿›è¡Œæ—¶é—´æ’å€¼å°±å¯ä»¥è·å¾—å‚è€ƒçº¿frenetåæ ‡ç³»ä¸‹çš„è½¨è¿¹ç‚¹ï¼Œæœ€åå°†è½¨è¿¹ç‚¹ä»frenetåæ ‡ç³»è½¬æ¢åˆ°cartesianåæ ‡ç³»ï¼Œå°±å¯ä»¥è·å¾—ç‰©ç†ä¸–ç•Œé‡‡æ ·è½¨è¿¹ï¼Œç”±äºæ¨ªå‘å’Œçºµå‘éƒ½æ˜¯é€šè¿‡é«˜æ¬¡å¤šé¡¹å¼æ’å€¼è·å¾—ï¼Œä»¥æ­¤cartesianåæ ‡ç³»ä¸‹çš„è½¨è¿¹ä¹Ÿæ˜¯å…‰æ»‘çš„ã€‚ é‡‡æ ·è½¨è¿¹çš„ç¢°æ’æ£€æµ‹ã€æ›²ç‡çº¦æŸåŠæœ€ä¼˜è½¨è¿¹æ‰“åˆ†ã€‚é‡‡æ ·è½¨è¿¹æ˜¯ä¸€ç³»åˆ—æ»¡è¶³é€Ÿåº¦çº¦æŸçš„å…‰æ»‘è½¨è¿¹ï¼Œä½†å…¶è¿˜éœ€è¦æ»¡è¶³æ— ç¢°æ’å’Œè½¦è¾†è¿åŠ¨å­¦æ›²ç‡çº¦æŸçš„å¼ºåˆ¶çº¦æŸï¼ŒåŠè¿œç¦»éšœç¢ç‰©å’Œé è¿‘å‚è€ƒçº¿ç­‰ç»„æˆçš„ä»£ä»·çº¦æŸã€‚é‡‡æ ·è½¨è¿¹çš„æ‰“åˆ†å°±æ˜¯ä¸ºäº†è·å¾—ä¸€æ¡æœ€ä¼˜çš„æ»¡è¶³çº¦æŸæ¡ä»¶çš„æ— ç¢°æ’å…‰æ»‘è½¨è¿¹ã€‚è¯¥è½¨è¿¹ä¹Ÿæ˜¯latticeè¾“å‡ºåˆ°controllerç”¨äºè½¦è¾†è·Ÿéšçš„è½¨è¿¹ã€‚ Frenetåæ ‡ç³»å’ŒCartesianåæ ‡ç³»çš„ç›¸äº’è½¬æ¢ Frenetåæ ‡ç³»æ˜¯å‚è€ƒçº¿ä¸Šçš„åæ ‡ç³»ï¼Œæ˜¯ä¸€ä¸ªåŠ¨åæ ‡ç³»ã€‚Frenetåæ ‡ç³»çš„å»ºç«‹ï¼Œä»¥è½¦è¾†ä½ç½®åˆ°å‚è€ƒçº¿çš„æœ€è¿‘ç‚¹Rä½œä¸ºfrenetåæ ‡ç³»çš„åŸç‚¹ï¼Œä»¥å‚è€ƒçº¿åˆ‡çº¿æ–¹å‘ä½œä¸ºTè½´ï¼Œå‚ç›´äºTè½´å‘å¤–ä¸ºNè½´ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ˜¯frenetåæ ‡ç³»å’Œcartesianåæ ‡ç³»çš„ç›¸äº’è½¬æ¢å…³ç³»ï¼Œé»‘è‰²è™šçº¿æ˜¯è½¦è¾†å½“å‰è¿è¡Œçš„è½¨è¿¹æ–¹å‘ï¼Œé»‘è‰²å®çº¿æ˜¯è½¦è¾†è¿è¡Œçš„å‚è€ƒçº¿ã€‚ [pic] å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå‚è€ƒçº¿ï¼ˆReference lineï¼‰æ˜¯ä¸€æ¡å…‰æ»‘çš„è½¦é“çº¿ï¼ŒæŒ‰ä¸Šå›¾æ‰€ç¤ºå°†æ±½è½¦çš„åæ ‡ç‚¹Pï¼ˆå›¾ä¸­çº¢è‰²ç‚¹ï¼‰æŠ•å½±åˆ°å‚è€ƒçº¿ä¸Šï¼Œå¾—åˆ°ä¸€ä¸ªå‚è€ƒçº¿ä¸Šçš„æŠ•å½±ç‚¹Rï¼ˆå›¾ä¸­ç»¿è‰²ç‚¹ï¼‰ã€‚ä»å‚è€ƒçº¿èµ·ç‚¹åˆ°æŠ•å½±ç‚¹çš„è·¯å¾„é•¿åº¦å°±æ˜¯æ±½è½¦åœ¨Frenetåæ ‡ç³»ä¸‹çš„çºµå‘åç§»é‡ï¼Œç”¨sè¡¨ç¤ºã€‚è€ŒæŠ•å½±ç‚¹åˆ°æ±½è½¦ä½ç½®çš„è·ç¦» $l(s)$ åˆ™æ˜¯æ±½è½¦åœ¨Frenetåæ ‡ç³»ä¸‹çš„æ¨ªå‘åç§»é‡ã€‚å› ä¸ºå‚è€ƒçº¿æ˜¯è¶³å¤Ÿå…‰æ»‘çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯é€šè¿‡æ±½è½¦çš„æœå‘ã€é€Ÿåº¦ã€åŠ é€Ÿåº¦æ¥è®¡ç®—å‡ºFrenetåæ ‡ç³»ä¸‹ï¼Œæ¨ªå‘å’Œçºµå‘åç§»é‡çš„ä¸€é˜¶å¯¼å’ŒäºŒé˜¶å¯¼ã€‚è¿™é‡Œå°†æ¨ªå‘åç§»é‡ $l(s)$ è®¾è®¡æˆçºµå‘åç§»é‡sçš„å‡½æ•°ã€‚è¿™æ˜¯å› ä¸ºå¯¹äºcarlikeæ¨¡å‹çš„æ±½è½¦è€Œè¨€ï¼Œæ¨ªå‘è¿åŠ¨æ˜¯ç”±çºµå‘è¿åŠ¨è¯±å‘çš„ã€‚è€Œ\u003c/font color=red\u003eå°†åæ ‡ç‚¹è½¬æ¢åˆ°frenetåæ ‡ç³»çš„ç›®çš„åˆ™æ˜¯ä¸ºäº†æ–¹ä¾¿è§„åˆ’æ›²çº¿çš„ç”Ÿæˆå’Œè½¦é“çº¿æ¨ªå‘å’Œçºµå‘æ–¹å‘ä¸Šçš„è½¨è¿¹é‡‡æ ·ï¼Œä»è€Œè·å¾—è¦†ç›–æ•´ä¸ªè½¦é“çš„å…‰æ»‘é‡‡æ ·è½¨è¿¹ã€‚ frenetåæ ‡ç³»å’Œcartesianåæ ‡ç³»çš„è½¬æ¢å…³ç³»å¯ä»¥å¯ä»¥å‚è€ƒå¦‚ä¸‹è®ºæ–‡[https://link.zhihu.com/?target=https%3A//www.researchgate.net/profile/Moritz-Werling/publication/224156269_Optimal_Trajectory_Generation_for_Dynamic_Street_Scenarios_in_a_Frenet_Frame/links/54f749df0cf210398e9277af/Optimal-Trajectory-Generation-for-Dynamic-Street-Scenarios-in-a-Frenet-Frame.pdf] å¦‚ä¸‹æ‰€ç¤ºæ˜¯ä¸¤ä¸ªåæ ‡ç³»ä¹‹é—´çš„å˜æ¢å…¬å¼ã€‚ ref:https://blog.csdn.net/u013468614/article/details/108748016 cartesianåæ ‡ç³»åˆ°frenetåæ ‡ç³»çš„å˜æ¢å…¬å¼ï¼š frenetåæ ‡ç³»åˆ°cartesianåæ ‡ç³»çš„å˜æ¢å…¬å¼ï¼š ä¸Šå¼ä¸­ï¼Œå„å˜é‡çš„å«ä¹‰å¦‚ä¸‹ï¼š å¦‚ä¸‹å›¾æ‰€ç¤ºç»¿è‰²çº¿ä»£è¡¨äº†å‚è€ƒçº¿reference_lineï¼Œçº¢è‰²å’Œè“è‰²çº¿ä»£è¡¨ç»è¿‡æ¨ªå‘åç§»ä½ç§»å‡åŒ€å˜åŒ–ä¹‹åå½¢æˆçš„è·¯çº¿ã€‚ ","date":"2023-07-15","objectID":"/posts/latticeplanner/:2:0","tags":["draft"],"title":"Lattice Planner","uri":"/posts/latticeplanner/"},{"categories":["Planning"],"content":"ä¸‰ã€Lattice Plannerè½¨è¿¹é‡‡æ · Latticeè§„åˆ’å™¨çš„è½¨è¿¹é‡‡æ ·ï¼Œä¸»è¦åˆ†ä¸ºæ¨ªå‘é‡‡æ ·ã€çºµå‘é‡‡æ ·ä»¥åŠè½¨è¿¹æ—¶é—´å‘¨æœŸé‡‡æ ·ã€‚ æ¨ªå‘è½¨è¿¹çš„é‡‡æ ·éœ€è¦æ¶µç›–å¤šç§æ¨ªå‘è¿åŠ¨çŠ¶æ€ï¼Œéœ€è¦æ ¹æ®è½¦é“å®½åº¦è®¾ç½®æ¨ªå‘é‡‡æ ·çš„é‡‡æ ·åŒºé—´ï¼Œé€šè¿‡æ¨ªå‘é‡‡æ ·é—´éš”ï¼Œå½¢æˆä¸åŒçš„æ¨ªå‘é‡‡æ ·åç§»é‡ã€‚ çºµå‘é‡‡æ ·çš„é‡‡æ ·åŒºé—´å¯ä»¥é€šè¿‡å‰ç»ç‚¹çš„ä½ç§»é•¿åº¦sï¼Œä½œä¸ºåŸºå‡†é‡‡æ ·é•¿åº¦ï¼Œç„¶åé€šè¿‡å¯¹è½¨è¿¹é€Ÿåº¦dsè¿›è¡Œé‡‡æ ·ã€‚ æ—¶é—´å‘¨æœŸé‡‡æ ·ï¼Œå°±æ˜¯å¯¹è½¨è¿¹çš„è¿è¡Œå‘¨æœŸæ—¶é—´è¿›è¡Œé‡‡æ ·ã€‚è€Œç™¾åº¦Apolloçš„è½¨è¿¹é‡‡æ ·ï¼Œåªå¯¹æ¨ªå‘ä½ç§»å’Œçºµå‘ä½ç§»è¿›è¡Œäº†é‡‡æ ·ï¼Œå¹¶è®¾è®¡äº†é‡‡æ ·çŠ¶æ€æ¨ªå‘åç§»é‡ï¼Œ-0.5ï¼Œ0.0å’Œ0.5ï¼Œä»¥åŠå››ä¸ªåˆ°è¾¾è¿™äº›æ¨ªå‘åç§»é‡çš„çºµå‘ä½ç§»ï¼Œåˆ†åˆ«ä¸º10ï¼Œ20ï¼Œ40ï¼Œ80æ¥å¾—åˆ°é‡‡æ ·çŠ¶æ€ã€‚æ‰€ä»¥Latticeè§„åˆ’å™¨çš„è½¨è¿¹é‡‡æ ·ä¸»è¦æ˜¯å¯¹è½¨è¿¹æ¨ªçºµå‘çŠ¶æ€è¿›è¡Œé‡‡æ ·ï¼Œä½†é‡‡æ ·æ–¹å¼å¯ä»¥æ ¹æ®ç¯å¢ƒæƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ ","date":"2023-07-15","objectID":"/posts/latticeplanner/:3:0","tags":["draft"],"title":"Lattice Planner","uri":"/posts/latticeplanner/"},{"categories":["Planning"],"content":"å››ã€Lattice Planneré€Ÿåº¦è§„åˆ’ æœ‰äº†å‰é¢çš„é‡‡æ ·çŠ¶æ€ï¼Œç°åœ¨éœ€è¦åšçš„æ˜¯æ ¹æ®é‡‡æ ·çŠ¶æ€ç”Ÿæˆæ¨ªå‘ $l(s)$ å’Œçºµå‘ $s(t)$ å’Œè§„åˆ’å‡½æ•°ï¼Œä¸¤ç§è§„åˆ’å‡½æ•°éƒ½æ˜¯é€šè¿‡å¤šé¡¹å¼è¿›è¡Œæ‹Ÿåˆæ±‚è§£ç”Ÿæˆã€‚ä¸»è¦ä½¿ç”¨äº†4æ¬¡å’Œ5æ¬¡å¤šé …å¼æ‹Ÿåˆï¼Œä»è€Œæ»¡è¶³äº†è½¦è¾†è¿è¡Œè¿‡ç¨‹ä¸­çš„ä¸€é˜¶å¯¼ï¼ŒäºŒé˜¶å¯¼è¿ç»­ï¼Œä¹Ÿå°±æ˜¯é€Ÿåº¦å’ŒåŠ é€Ÿåº¦è¿ç»­ï¼Œä¿è¯äº†è½¨è¿¹çš„å¹³æ»‘æ€§è¦æ±‚ã€‚ å¯¹äºçºµå‘è½¨è¿¹ $s(t)$ ï¼Œåœ¨åœè½¦å’Œè·Ÿè½¦çŠ¶æ€ï¼Œéƒ½æ˜¯äº”æ¬¡å¤šé¡¹å¼ï¼Œä½†å¯¹äºå·¡èˆªçŠ¶æ€ï¼Œç”±äºæˆ‘ä»¬ä¸éœ€è¦ç¡®å®šçŠ¶æ€çš„Så€¼ï¼Œæ‰€ä»¥åªæœ‰äº”ä¸ªå˜é‡ï¼Œå› æ­¤ç”¨å››æ¬¡å¤šé¡¹å¼å°±å¯ä»¥äº†ã€‚å¯¹äºæ¨ªå‘è½¨è¿¹$l(s)$ä¹Ÿä½¿ç”¨äº†äº”æ¬¡å¤šé¡¹å¼æ‹Ÿåˆã€‚ è¿™é‡Œè§„åˆ’å™¨çš„é‡‡æ ·æ–¹å¼æ²¡æœ‰ä½¿ç”¨Apolloä¸­Latticeçš„æ¨ªçºµå‘é‡‡æ ·æ–¹å¼ï¼Œè€Œæ˜¯é‡‡ç”¨äº†ä¸Šæ–‡ä¸­æåˆ°çš„é‡‡æ ·æ–¹å¼ï¼Œå› æ­¤çº¦æŸå˜é‡æœ‰ï¼š å·¡èˆªæ¨¡å¼ä¸‹çš„çºµå‘æ‹Ÿåˆå‡½æ•°çš„æ±‚è§£ ","date":"2023-07-15","objectID":"/posts/latticeplanner/:4:0","tags":["draft"],"title":"Lattice Planner","uri":"/posts/latticeplanner/"},{"categories":["Planning"],"content":"äº”ã€è½¨è¿¹ç”ŸæˆåŠè½¨è¿¹è¯„ä»·å‡½æ•° è½¨è¿¹çš„ç”Ÿæˆæˆå°±æ˜¯å°†frenetåæ ‡ç³»ä¸‹çš„è½¨è¿¹è½¬æ¢åˆ°cartesianåæ ‡ç³»ä¸­ï¼Œå‰é¢æˆ‘ä»¬çŸ¥é“äº†ä½å§¿ç‚¹åœ¨frenetåæ ‡ç³»å’Œcartesianåæ ‡ç³»çš„ç›¸äº’è½¬æ¢å…³ç³»ï¼Œå› æ­¤ç°åœ¨æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å¯¹æ¨ªçºµå‘è½¨è¿¹å‡½æ•° $s(t)$ å’Œ $l(s(t))$ è¿›è¡Œè½¨è¿¹çš„æ—¶é—´ç»†åˆ†å½¢æˆè§„åˆ’å‡½æ•°çš„æ¨ªçºµå‘è½¨è¿¹è§„åˆ’ç‚¹ $s(t_i)$ å’Œ $l(s(t_i))$ï¼Œè¯¥è§„åˆ’ç‚¹æ˜¯åœ¨frenetåæ ‡ç³»ä¸­ï¼Œå› æ­¤éœ€è¦è¿›è¡Œfrenetåæ ‡ç³»åˆ°cartesianåæ ‡ç³»çš„åæ ‡è½¬æ¢ï¼Œä»è€Œå½¢æˆæ§åˆ¶å™¨å¯ç”¨çš„é‡‡æ ·è½¨è¿¹ã€‚ è·å¾—é‡‡ç”¨è½¨è¿¹ä¹‹åï¼Œæ¥ç€éœ€è¦è¿›è¡Œç›®æ ‡è½¨è¿¹çš„æ›²ç‡æ£€æŸ¥å’Œç¢°æ’æ£€æµ‹ï¼Œç›®çš„æ˜¯ä¸ºäº†ä½¿ç›®æ ‡é‡‡æ ·è½¨è¿¹æ»¡è¶³è½¦è¾†çš„è¿åŠ¨å­¦æ§åˆ¶è¦æ±‚å’Œæ— ç¢°æ’è¦æ±‚ï¼Œè¿™æ ·å°±å½¢æˆäº†å®‰å…¨å¯é çš„è½¨è¿¹ç°‡ã€‚è¿™äº›è½¨è¿¹ç°‡éƒ½å¯ä»¥æ»¡è¶³è½¦è¾†çš„æ§åˆ¶è¦æ±‚ï¼Œä½†å¹¶ä¸æ˜¯æœ€ä¼˜çš„ï¼Œå› æ­¤éœ€è¦ä»è½¨è¿¹ç°‡ä¸­é€‰å‡ºä¸€ç»„æœ€ä¼˜çš„è¿è¡Œè½¨è¿¹ã€‚è¿™æ—¶å°±éœ€è¦å¼•å…¥è½¨è¿¹è¯„ä»·å‡½æ•°ï¼Œç”¨æ¥å¯¹å€™é€‰è½¨è¿¹è¿›è¡Œæ‰“åˆ†ã€‚ è½¨è¿¹è¯„ä»·å‡½æ•°ä¸»è¦ä¸ºäº†ä½¿å¾—ç›®æ ‡è½¨è¿¹å°½é‡é è¿‘é™æ€å‚è€ƒçº¿è½¨è¿¹è¿è¡Œï¼ŒåŒæ—¶ï¼Œé€Ÿåº¦å°½é‡ä¸å‘ç”Ÿå¤§çªå˜ï¼Œæ»¡è¶³èˆ’é€‚æ€§è¦æ±‚ï¼Œä¸”å°½é‡è¿œç¦»éšœç¢ç‰©ã€‚å› æ­¤æœ€åè½¨è¿¹è¯„ä»·å‡½æ•°å¯ä»¥é€šè¿‡å¦‚ä¸‹ä¼ªä»£ç æè¿°ï¼š $$traj_{cost} = k_{lat} * cost_{lat} + k_{lon} * cost_{lon} + k_{obs} * obs_{cost};$$ ä¸Šå¼ä¸­ï¼Œ - k_lat : è¡¨ç¤ºçºµå‘è¯¯å·®ä»£ä»·æƒé‡ - cost_latï¼š è¡¨ç¤ºçºµå‘è¯¯å·®ï¼Œç»¼åˆè€ƒè™‘çºµå‘é€Ÿåº¦è¯¯å·®ï¼Œæ—¶é—´è¯¯å·®åŠåŠ åŠ é€Ÿåº¦çš„å½±å“ã€‚ - k_lon : è¡¨ç¤ºæ¨ªå‘è¯¯å·®ä»£ä»·æƒé‡ - cost_lonï¼š è¡¨ç¤ºæ¨ªå‘å‘è¯¯å·®ï¼Œç»¼åˆè€ƒè™‘äº†æ¨ªå‘åŠ é€Ÿåº¦è¯¯å·®åŠæ¨ªå‘åç§»è¯¯å·®çš„å½±å“ã€‚ - k_obs : è¡¨ç¤ºéšœç¢ç‰©ä»£ä»·æƒé‡ - obs_costï¼š è¡¨ç¤ºéšœç¢ç‰©è·ç¦»æŸå¤±ã€‚ æœ€åé€‰æ‹©å‡ºä»£ä»·å€¼æœ€å¥½çš„ä¸€æ¡è½¨è¿¹è¾“å…¥åˆ°æ§åˆ¶å™¨ï¼Œç”¨äºæ§åˆ¶å™¨çš„è·Ÿè¸ªæ§åˆ¶ã€‚ ","date":"2023-07-15","objectID":"/posts/latticeplanner/:5:0","tags":["draft"],"title":"Lattice Planner","uri":"/posts/latticeplanner/"},{"categories":["Planning"],"content":"ref: [1]. https://blog.csdn.net/qq_41667348/category_11789612.html [2]. https://zhuanlan.zhihu.com/p/492988036 [3]. https://www.zhihu.com/column/c_1020971709242818560 [4]. https://blog.csdn.net/qq_35503971/article/details/106337900 ç®€ä»‹ EM Planneræ˜¯Apolloé¢å‘L4çš„å®æ—¶è¿åŠ¨è§„åˆ’ç®—æ³•ï¼Œè¯¥ç®—æ³•é¦–å…ˆé€šè¿‡é¡¶å±‚å¤šè½¦é“ç­–ç•¥ï¼Œé€‰æ‹©å‡ºä¸€æ¡å‚è€ƒè·¯å¾„ï¼Œå†æ ¹æ®è¿™æ¡å‚è€ƒçº¿ï¼Œåœ¨Frenetåæ ‡ç³»ä¸‹ï¼Œè¿›è¡Œè½¦é“çº§çš„è·¯å¾„å’Œé€Ÿåº¦è§„åˆ’ï¼Œè§„åˆ’ä¸»è¦é€šè¿‡Dynamic Programmingå’ŒåŸºäºæ ·æ¡çš„Quadratic Programmingå®ç°ã€‚EM Plannerå……åˆ†è€ƒè™‘äº†æ— äººè½¦å®‰å…¨æ€§ã€èˆ’é€‚æ€§ã€å¯æ‰©å±•æ€§çš„éœ€æ±‚ï¼Œé€šè¿‡è€ƒè™‘äº¤é€šè§„åˆ™ã€éšœç¢ç‰©å†³ç­–ã€è½¨è¿¹å…‰æ»‘æ€§ç­‰è¦æ±‚ï¼Œå¯é€‚åº”é«˜é€Ÿå…¬è·¯ã€ä½é€ŸåŸåŒºåœºæ™¯çš„è§„åˆ’éœ€æ±‚ã€‚é€šè¿‡Apolloä»¿çœŸå’Œåœ¨ç¯æµ‹è¯•ï¼ŒEM Plannerç®—æ³•ä½“ç°äº†é«˜åº¦çš„å¯é æ€§ï¼Œå’Œä½è€—æ—¶æ€§ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:0:0","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"å¤šè½¦é“EM Planneræ¡†æ¶ ","date":"2023-07-15","objectID":"/posts/emplanner/:1:0","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"æ•´ä½“æ¡†æ¶ æ‰€æœ‰è§„åˆ’éœ€è¦çš„ä¿¡æ¯åœ¨EM Plannerçš„é¡¶å±‚æ±‡é›†ï¼Œç„¶åå‚è€ƒçº¿ç”Ÿæˆå™¨ä¼šç”Ÿæˆä¸€äº›åŸºäºéšœç¢ç‰©å’Œäº¤é€šè§„åˆ™çš„å€™é€‰è½¦é“çº§å‚è€ƒçº¿ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸»è¦æ˜¯ä¾èµ–äºé«˜ç²¾åº¦åœ°å›¾å’ŒRoutingæ¨¡å—ç»™å‡ºçš„å…¨å±€è§„åˆ’ç»“æœã€‚ä»¥ä¸‹æ˜¯è½¦é“çº§çš„è§„åˆ’è¿‡ç¨‹ï¼š é¦–å…ˆä¼šåŸºäºç»™å®šå‚è€ƒçº¿ç”ŸæˆFrenetåæ ‡ç³»ï¼Œé€šè¿‡ç»™å®šå‚è€ƒçº¿å°†æ‰€æœ‰çš„è‡ªè½¦ä¿¡æ¯å’Œç¯å¢ƒä¿¡æ¯è½¬æ¢åˆ°å‚è€ƒçº¿ä¸‹çš„Frenetåæ ‡ç³»ã€‚ æ¥ä¸‹æ¥æ‰€æœ‰çš„è½¦é“çº§ä¿¡æ¯å°†ä¼šä¼ é€’ç»™è½¦é“çº§æœ€ä¼˜æ±‚è§£å™¨ï¼Œè¯¥æ±‚è§£å™¨ä¼šæ±‚è§£æœ€ä¼˜è·¯å¾„å’Œæœ€ä¼˜é€Ÿåº¦ã€‚åœ¨æ±‚è§£æœ€ä¼˜è·¯å¾„æ—¶ï¼Œå‘¨å›´ç¯å¢ƒä¿¡æ¯å°†ä¼šè¢«æŠ•å½±åˆ°Frenetåæ ‡ç³»ï¼ˆE-stepï¼‰ï¼Œç„¶ååŸºäºæŠ•å½±çš„ä¿¡æ¯ç”Ÿæˆä¸€æ¡å…‰æ»‘è·¯å¾„ï¼ˆM-stepï¼‰ã€‚ åŒæ ·çš„ï¼Œåœ¨æ±‚è§£æœ€ä¼˜é€Ÿåº¦æ—¶ï¼Œä¸€æ—¦ç”Ÿæˆäº†ä¸€æ¡æœ€ä¼˜è·¯å¾„ï¼Œéšœç¢ç‰©å°±ä¼šè¢«æŠ•å½±åˆ°STå›¾ä¸­ï¼ˆE-stepï¼‰ï¼Œç„¶åæœ€ä¼˜é€Ÿåº¦æ±‚è§£å™¨ä¼šç”Ÿæˆä¸€æ¡å…‰æ»‘çš„é€Ÿåº¦è§„åˆ’ï¼ˆM-stepï¼‰ã€‚ç»“åˆè·¯å¾„å’Œé€Ÿåº¦è§„åˆ’ç»“æœï¼Œå°±ç”Ÿæˆäº†ä¸€æ¡ç»™å®šè½¦é“çš„å…‰æ»‘è½¨è¿¹ã€‚ æœ€åä¸€æ­¥ä¼šå°†æ‰€æœ‰çš„è½¦é“çº§è½¨è¿¹ä¼ é€’ç»™å‚è€ƒçº¿è½¨è¿¹å†³ç­–å™¨ï¼ŒåŸºäºå½“å‰è½¦è¾†çŠ¶æ€ã€ç›¸å…³çº¦æŸå’Œæ¯æ¡è½¨è¿¹çš„ä»£ä»·ï¼Œè½¨è¿¹å†³ç­–å™¨ä¼šå†³å®šä¸€æ¡æœ€ä¼˜çš„è½¨è¿¹ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:1:1","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"å¤šè½¦é“ç­–ç•¥ åˆ©ç”¨æœç´¢ç®—æ³•ã€2ã€‘ã€3ã€‘ç»“åˆä»£ä»·ä¼°ç®—å½¢æˆå˜é“ç­–ç•¥æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„å¤„ç†å˜é“é—®é¢˜çš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•å­˜åœ¨è®¡ç®—é‡å¤§ã€éš¾ä»¥é€‚ç”¨äº¤è§„ä»¥åŠå‰åå†³ç­–å¯èƒ½ç¼ºå°‘è¿è´¯æ€§ç­‰ç‰¹ç‚¹ã€‚Apolloçš„è§£å†³åŠæ³•æ˜¯å°†å¤šè½¦é“ç­–ç•¥åˆ’åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šæ— æ³•é€šè¡Œçš„è¢«åŠ¨å˜é“ï¼Œå’Œèƒ½å¤Ÿé€šè¡Œçš„ä¸»åŠ¨å˜é“ã€‚ è¢«åŠ¨å˜é“ä¸€èˆ¬ç”±é“è·¯é˜»æŒ¡é€ æˆçš„ï¼Œé€šè¿‡å…¨å±€è§„åˆ’æ¨¡å—é‡æ–°ç”Ÿæˆå…¨å±€è·¯å¾„è§£å†³ï¼› ä¸»åŠ¨å˜é“æ˜¯è€ƒè™‘åŠ¨æ€éšœç¢ç‰©è€Œåšå‡ºçš„å†³ç­–ã€‚Apolloé€šè¿‡åŒæ­¥ç”Ÿæˆå¤šæ¡å€™é€‰è½¦é“çš„æ–¹æ³•è§£å†³ä¸»åŠ¨å˜é“é—®é¢˜ï¼Œåœ¨Frenetåæ ‡ç³»ä¸‹ï¼ŒæŠ•å½±éšœç¢ç‰©ã€è€ƒè™‘äº¤è§„åç”Ÿæˆå¤šæ¡è½¦é“çº§çš„å€™é€‰è·¯å¾„ï¼Œæœ€åä¼ é€’åˆ°å˜é“å†³ç­–å™¨ä¸­é€‰æ‹©å‡ºä¸€æ¡æœ€ä¼˜çš„è½¦é“å†³ç­–ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:1:2","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"è·¯å¾„-é€Ÿåº¦è¿­ä»£ç®—æ³• åœ¨Frenetåæ ‡ä¸‹çš„è½¨è¿¹è§„åˆ’å®é™…ä¸Šæ˜¯å¸¦çº¦æŸçš„3Dæœ€ä¼˜æ±‚è§£é—®é¢˜ã€‚è¯¥é—®é¢˜ä¸€èˆ¬æœ‰ä¸¤ç§æ±‚è§£æ–¹æ³•ï¼šç›´æ¥3Dæœ€ä¼˜åŒ–æ±‚è§£å’Œè·¯å¾„-é€Ÿåº¦è§£è€¦æ±‚è§£ã€‚ ç›´æ¥æ–¹æ³•ã€4ã€‘ã€5ã€‘è¯•å›¾åœ¨SLTåæ ‡ç³»ä¸‹ä½¿ç”¨è½¨è¿¹é‡‡æ ·æˆ–Latticeæœç´¢,è¿™äº›æ–¹æ³•éƒ½å—åˆ°æœç´¢å¤æ‚åº¦çš„é™åˆ¶ï¼Œå› æ­¤æœç´¢ç»“æœæ˜¯æ¬¡ä¼˜çš„ã€‚ è€Œè·¯å¾„-é€Ÿåº¦è§£è€¦è§„åˆ’ä¼šåˆ†åˆ«æ±‚è§£è·¯å¾„å’Œé€Ÿåº¦çš„æœ€ä¼˜è§£ã€‚é€Ÿåº¦çš„ç”Ÿæˆå°†ä¼šåœ¨ç”Ÿäº§çš„è·¯å¾„ä¸Šè¿›è¡Œã€6ã€‘ã€‚è™½ç„¶ç»“æœå¯èƒ½ä¹Ÿä¸æ˜¯æœ€ä¼˜çš„ï¼Œä½†ä¼šåœ¨é€Ÿåº¦å’Œè·¯å¾„åˆ†åˆ«æ±‚è§£æ—¶æ›´åŠ çµæ´»ã€‚ EM Plannerè¿­ä»£åœ°è¿›è¡Œè·¯å¾„å’Œé€Ÿåº¦æœ€ä¼˜æ±‚è§£ï¼Œé€šè¿‡ä¼°è®¡å’Œæ¥å‘ã€ä½é€Ÿéšœç¢ç‰©çš„äº¤äº’ï¼Œä¸Šä¸€å¸§çš„é€Ÿåº¦è§„åˆ’å°†æœ‰åŠ©äºä¸‹ä¸€å¸§çš„è·¯å¾„è§„åˆ’ã€‚ç„¶åå°†è·¯å¾„è§„åˆ’ç»“æœå†äº¤ç»™é€Ÿåº¦æœ€ä¼˜æ±‚è§£å™¨æ¥æ¨ç®—å‡ºä¸€ä¸ªæœ€ä¼˜çš„é€Ÿåº¦ç»“æœã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:1:3","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"å†³ç­–å’Œäº¤é€šè§„åˆ™çº¦æŸ äº¤é€šè§„åˆ™æ˜¯ç¡¬çº¦æŸï¼Œè€Œä¸éšœç¢ç‰©çš„äº¤äº’æ˜¯è½¯çº¦æŸã€‚ä¸€äº›å†³ç­–æ–¹æ³•ç›´æ¥è€ƒè™‘çš„æ˜¯æ•°å€¼ä¸Šçš„æœ€ä¼˜è§£ã€7ã€‘ï¼Œä¹Ÿæœ‰åƒã€5ã€‘ä¸€æ ·åŒæ—¶è¿›è¡Œè§„åˆ’å’Œå†³ç­–ã€‚è€ŒApollo EM Plannerçš„å†³ç­–æ˜¯ä¼˜å…ˆäºè§„åˆ’çš„ï¼Œå†³ç­–æ¨¡å—å°†ä¼šä¸ºè§„åˆ’å¸¦æ¥æ›´æ˜ç¡®çš„æ„å›¾ï¼Œå‡å°‘æœ€ä¼˜æ±‚è§£çš„æœç´¢ç©ºé—´ã€‚å†³ç­–éƒ¨åˆ†çš„ç¬¬ä¸€æ­¥æ˜¯å°†è½¦è¾†çš„è¿åŠ¨æ„å›¾ç”¨ä¸€æ ¹ç²—ç•¥ã€çµæ´»çš„è½¨è¿¹æ¥æè¿°ã€‚è¿™æ¡è½¨è¿¹ä¹Ÿå¯ä»¥ç”¨æ¥ä¼°è®¡ä¸éšœç¢ç‰©ä¹‹é—´çš„äº¤äº’ï¼Œå¹¶ä¸”å½“æƒ…æ™¯æ›´åŠ å¤æ‚æ—¶ï¼Œè¿™ç§åŸºäºè½¨è¿¹çš„å†³ç­–æ–¹æ³•ä¹Ÿæ˜¯çµæ´»çš„ã€‚ç¬¬äºŒæ­¥æ˜¯åŸºäºå†³ç­–ç”Ÿæˆçš„è½¨è¿¹æ¥æ„é€ ä¸€ä¸ªå‡¸ç©ºé—´ï¼Œç”¨æ¥åšåŸºäºæ ·æ¡å…‰æ»‘çš„è½¨è¿¹ç”Ÿæˆï¼Œä¸»è¦æ˜¯é€šè¿‡äºŒæ¬¡è§„åˆ’æ¥è¾¾åˆ°è¿­ä»£ç”Ÿäº§è·¯å¾„ã€é€Ÿåº¦è§£çš„ç›®çš„ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:1:4","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"è½¦é“çº§EM PLanneræ¡†æ¶ ","date":"2023-07-15","objectID":"/posts/emplanner/:2:0","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"æ•´ä½“æ¡†æ¶ æ¡†æ¶åŒ…æ‹¬äº†ä¸€å¸§è§„åˆ’ä¸­çš„ä¸¤ä¸ªE-stepå’Œä¸¤ä¸ªM-stepï¼Œè½¨è¿¹ä¿¡æ¯å°†ä¼šåœ¨å‰åä¸¤å¸§ä¸­ä¼ é€’ï¼Œä»¥ä¸‹æ˜¯æ•´ä¸ªè½¦é“çº§è§„åˆ’çš„æµç¨‹ï¼š åœ¨ç¬¬ä¸€ä¸ªE-stepä¸­ï¼Œéšœç¢ç‰©ä¼šè¢«æŠ•å½±åˆ°è½¦é“Frenetåæ ‡ç³»ï¼Œéšœç¢ç‰©åŒ…æ‹¬äº†é™æ€éšœç¢ç‰©å’ŒåŠ¨æ€éšœç¢ç‰©ã€‚é™æ€éšœç¢ç‰©ä¼šç›´æ¥ä»ç¬›å¡å°”åæ ‡ç³»è½¬æ¢åˆ°Frenetåæ ‡ç³»ï¼Œè€ŒåŠ¨æ€çš„ä¿¡æ¯åˆ™ä»¥å…¶è¿åŠ¨è½¨è¿¹æ¥æè¿°ã€‚é€šè¿‡ä¸Šä¸€å¸§çš„é¢„æµ‹ä¿¡æ¯ï¼Œå’Œè‡ªè½¦çš„è¿åŠ¨ä¿¡æ¯ï¼Œå¯ä»¥ä¼°ç®—è‡ªè½¦å’ŒåŠ¨æ€éšœç¢ç‰©åœ¨æ¯ä¸ªæ—¶é—´ç‚¹çš„äº¤äº’æƒ…å†µï¼Œè½¨è¿¹é‡å çš„éƒ¨åˆ†ä¼šè¢«æ˜ å°„åˆ°Frenetåæ ‡ç³»ä¸­ã€‚åˆæ¬¡ä¹‹å¤–ï¼Œåœ¨æœ€ä¼˜è·¯å¾„æ±‚è§£è¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€éšœç¢ç‰©çš„å‡ºç°ä¼šæœ€ç»ˆå¯¼è‡´è‡ªè½¦åšå‡ºé¿è®©çš„å†³ç­–ã€‚å› æ­¤ï¼Œå‡ºäºå®‰å…¨çš„è€ƒè™‘ï¼ŒSLæŠ•å½±åªè€ƒè™‘ä½é€Ÿå’Œæ¥å‘éšœç¢ç‰©ï¼Œè€Œå¯¹äºé«˜é€Ÿçš„åŠ¨æ€éšœç¢ç‰©ï¼ŒEM Plannerçš„å¹³è¡Œå˜é“ç­–ç•¥ä¼šè€ƒè™‘è¿™ç§æƒ…æ™¯ã€‚ åœ¨ç¬¬äºŒä¸ªE-stepï¼Œæ‰€æœ‰çš„éšœç¢ç‰©éƒ½ä¼šåœ¨STä¸­ä¸ç”Ÿæˆçš„é€Ÿåº¦ä¿¡æ¯è¿›è¡Œä¼°è®¡ï¼Œå¦‚æœå¯¹åº”çš„STä¸­é‡å éƒ¨åˆ†ï¼Œé‚£ä¹ˆå¯¹åº”åŒºåŸŸå°†ä¼šåœ¨STä¸­è¿›è¡Œé‡æ–°ç”Ÿæˆã€‚ åœ¨ä¸¤æ¬¡M-stepè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡Dynamic Programmingå’ŒQuadratic Programmingç”Ÿæˆè·¯å¾„å’Œé€Ÿåº¦è§„åˆ’ã€‚ç„¶è€Œåœ¨è¿›è¡ŒæŠ•å½±çš„SLå’ŒSTåæ ‡å†…æ±‚è§£æ—¶éå‡¸çš„ï¼Œå› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆä½¿ç”¨Dynamic Programmingè·å¾—ä¸€ä¸ªç²—ç•¥çš„è§£ï¼ŒåŒæ—¶è¿™ä¸ªè§£ä¹Ÿèƒ½å¤Ÿæä¾›è¯¸å¦‚é¿è®©ã€å‡é€Ÿã€è¶…è½¦çš„å†³ç­–ã€‚é€šè¿‡è¿™ä¸ªç²—ç•¥çš„è§£ï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªå‡¸çš„é€šé“ï¼Œç„¶åä½¿ç”¨åŸºäºQuadratic Programmingçš„æ ·æ¡æœ€ä¼˜æ±‚è§£ã€‚ æ¥ä¸‹æ¥çš„éƒ¨åˆ†å°†ä¼šè¯¦ç»†ä»‹ç»æ¡†æ¶ä¸­çš„æ­¥éª¤ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:2:1","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"SLå’ŒSTæŠ•å½±ï¼ˆE-stepï¼‰ SLæŠ•å½± SLæŠ•å½±æ˜¯åŸºäºç±»ä¼¼äºã€3ã€‘ä¸­çš„G2å…‰æ»‘å‚è€ƒçº¿ï¼ˆæ›²ç‡å¯¼æ•°è¿ç»­ï¼‰ã€‚ç»™å®šä¸€ä¸ªæ—¶åˆ»ï¼Œå¦‚æœè‡ªè½¦ä¸é¢„æµ‹çš„éšœç¢ç‰©è½¨è¿¹æœ‰é‡å åŒºåŸŸï¼Œé‚£ä¹ˆè¿™ä¸ªé‡å åŒºåŸŸå°†ä¼šåœ¨SLåæ ‡ç³»è¢«æ ‡æ³¨ä¸ºä¸åŠ¨æ€éšœç¢ç‰©çš„ä¼°è®¡äº¤äº’åŒºåŸŸã€‚è¿™ä¸ªåŒºåŸŸå¯ä»¥ç†è§£ä¸ºè‡ªè½¦å’ŒåŠ¨æ€éšœç¢ç‰©çš„åŒ…å›´ç›’çš„é‡å åŒºåŸŸã€‚å›¾4å±•ç¤ºäº†è¿™ä¸€ç§æ¡ˆä¾‹ï¼Œçº¢è‰²ä»£è¡¨åŠ¨æ€éšœç¢ç‰©çš„é¢„æµ‹è½¨è¿¹ï¼Œç”¨ç¦»æ•£ç‚¹æ¥è¡¨ç¤ºï¼›è“è‰²è¡¨ç¤ºè‡ªè½¦çš„çŠ¶æ€ã€‚ STæŠ•å½± STæŠ•å½±ç”¨äºå¸®åŠ©æˆ‘ä»¬ä¼°è®¡è‡ªè½¦çš„é€Ÿåº¦è§„åˆ’ã€‚å½“ç”Ÿæˆäº†ä¸€æ¡å…‰æ»‘çš„è·¯å¾„ä»¥åï¼Œä¸è‡ªè½¦æœ‰äº¤äº’çš„åŠ¨æ€éšœç¢ç‰©å’Œé™æ€éšœç¢ç‰©éƒ½ä¼šè¢«æŠ•å½±åˆ°è·¯å¾„ä¸Šï¼ŒåŒç†ï¼Œè¿™ç§äº¤äº’ä¹Ÿå®šä¹‰ä¸ºåŒ…å›´ç›’çš„é‡å ã€‚å¦‚å›¾5ï¼Œè¿™æ˜¯ä¸€ä¸ªSTå›¾æŠ•å½±æ¡ˆä¾‹ã€‚ çº¢è‰²åŒºåŸŸè¡¨ç¤ºåœ¨2så¤„è·ç¦»è‡ªè½¦40mè¿œåˆ‡å…¥è§„åˆ’è·¯å¾„çš„åŠ¨æ€éšœç¢ç‰©STä¿¡æ¯ï¼Œç»¿è‰²è¡¨ç¤ºåœ¨è‡ªè½¦åçš„åŠ¨æ€éšœç¢ç‰©STä¿¡æ¯ï¼ŒM-stepå°†ä¼šåœ¨å‰©ä¸‹çš„åŒºåŸŸæ‰¾åˆ°å¯è¡Œå…‰æ»‘æœ€ä¼˜è§£ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:2:2","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"DPè·¯å¾„ï¼ˆM-stepï¼‰ M-stepæ±‚è§£Frenetåæ ‡ç³»ä¸‹çš„æœ€ä¼˜è·¯å¾„è§„åˆ’ï¼Œå®é™…ä¸Šåœ¨ä¸€ä¸ªéå‡¸çš„åŒºé—´ï¼ˆä»å·¦å’Œä»å³é¿è®©æ˜¯ä¸¤ä¸ªå±€éƒ¨æœ€ä¼˜æƒ…æ™¯ï¼‰å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„ $l=f(s)$ æ–¹ç¨‹ã€‚ä¸»è¦åŒ…æ‹¬ä¸¤æ­¥ï¼šåŸºäºDynamic Programmingçš„è·¯å¾„å†³ç­–å’ŒåŸºäºæ ·æ¡çš„è·¯å¾„è§„åˆ’ã€‚ åŸºäºDynamic Programmingçš„è·¯å¾„æ­¥éª¤æä¾›ä¸€æ¡ç²—ç•¥çš„è·¯å¾„ä¿¡æ¯ï¼Œå…¶å¯ä»¥å¸¦æ¥å¯è¡Œé€šé“å’Œç»•éšœå†³ç­–ï¼Œå¦‚å›¾6æ‰€ç¤ºï¼Œè¿™ä¸€æ­¥åŒ…æ‹¬Latticeé‡‡æ ·ã€ä»£ä»·å‡½æ•°ã€Dynamic Programmingæœç´¢ã€‚ Latticeé‡‡æ ·åŸºäºFrenetåæ ‡ç³»ï¼Œå¤šè¡Œçš„ç‚¹åœ¨æ’’åœ¨è‡ªè½¦å‰ã€‚å¦‚å›¾7æ‰€ç¤ºï¼Œè¡Œä¸è¡Œä¹‹é—´çš„ç‚¹ä½¿ç”¨äº”æ¬¡æ–¹å¤šé¡¹å¼è¿æ¥ï¼Œè€Œè¡Œä¸è¡Œä¹‹é—´çš„é—´éš”å–å†³äºè‡ªè½¦é€Ÿåº¦ã€é“è·¯ç»“æ„ã€æ˜¯å¦æ¢é“ç­‰ç­‰ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œè·¯å¾„æ€»é•¿å¯ä»¥è¾¾åˆ°200mæˆ–è€…è¦†ç›–8sçš„è¡Œé©¶é•¿åº¦ã€‚ æ¯æ®µLatticeè·¯å¾„çš„ä»£ä»·é€šè¿‡å…‰æ»‘ç¨‹åº¦ã€éšœç¢ç‰©é¿è®©ã€è½¦é“ä»£ä»·æ¥è¯„ä»·ï¼š è€Œå…‰æ»‘ç¨‹åº¦åˆé€šè¿‡ä»¥ä¸‹æ–¹ç¨‹æ¥è¡¡é‡ï¼Œä¸€é˜¶å¯¼è¡¨ç¤ºæœå‘åå·®ï¼ŒäºŒé˜¶å¯¼è¡¨ç¤ºæ›²ç‡ï¼Œä¸‰é˜¶å¯¼è¡¨ç¤ºæ›²ç‡å¯¼æ•°ï¼š éšœç¢ç‰©çš„ä»£ä»·ç”±ä»¥ä¸‹æ–¹ç¨‹ç»™å‡ºï¼Œæ–¹ç¨‹ä¸­çš„dç”±è‡ªè½¦bounding boxåˆ°éšœç¢ç‰©bounding boxçš„è·ç¦»è¡¨ç¤ºã€‚è¿¹è§„åˆ’ è½¦é“ä»£ä»·ç”±ä»¥ä¸‹æ–¹ç¨‹ç»™å‡ºï¼Œä¸»è¦æ˜¯è€ƒè™‘åœ¨é“è·¯ä¸Šä¸å¦ä»¥åŠä¸å‚è€ƒçº¿ä¹‹é—´çš„å·®å¼‚ï¼Œä¸€èˆ¬æ˜¯ä¸è½¦é“ä¸­å¿ƒçº¿çš„å·®å¼‚ï¼š ","date":"2023-07-15","objectID":"/posts/emplanner/:2:3","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"æ ·æ¡QPè·¯å¾„ï¼ˆM-stepï¼‰ åŸºäºæ ·æ¡çš„è·¯å¾„å¯ä»¥ç†è§£ä¸ºæ˜¯Dynamic Programmingæ›´ç²¾ç»†çš„ç‰ˆæœ¬ã€‚é€šè¿‡DPé‡‡æ ·å‡ºçš„è·¯å¾„ç”Ÿæˆä¸€æ¡å¯é€šè¡Œé€šé“ï¼Œç„¶ååœ¨é€šé“ä¸­åˆ©ç”¨åŸºäºQuadratic Programmingçš„æ ·æ¡æ›²çº¿ç”Ÿäº§å…‰æ»‘è·¯å¾„ã€‚å…·ä½“å®ä¾‹å¦‚å›¾8æ‰€ç¤ºï¼Œæ­¥éª¤æµç¨‹å¯ç”±å›¾9æ‰€ç¤ºï¼š QPçš„ç›®æ ‡å‡½æ•°ä¸ºï¼š å…¶ä¸­ $ g(s) $ ä¸ºDPè§„åˆ’çš„è·¯å¾„ï¼Œ$ f(s) $ çš„ä¸€é˜¶å¯¼è¡¨ç¤ºæœå‘ã€äºŒé˜¶å¯¼è¡¨ç¤ºæ›²ç‡ã€ä¸‰é˜¶å¯¼è¡¨ç¤ºæ›²ç‡çš„å¯¼æ•°ã€‚è¯¥å‡½æ•°æè¿°äº†é¿è®©éšœç¢ç‰©å’Œæ›²çº¿å…‰æ»‘æ€§ä¹‹é—´çš„æƒè¡¡ã€‚ QPçš„çº¦æŸåŒ…æ‹¬è¾¹ç•Œçº¦æŸå’ŒåŠ¨åŠ›å­¦å¯è¡Œæ€§ã€‚è¿™äº›çº¦æŸéƒ½ä¼šæ–½åŠ åœ¨æ¯ä¸ªså¤„ï¼Œé€šè¿‡é™åˆ¶læ¥å°†è½¦è¾†é™åˆ¶åœ¨è½¦é“å†…ã€‚ç”±äºEM Plannerä½¿ç”¨çš„æ˜¯è‡ªè¡Œè½¦æ¨¡å‹ï¼Œå› æ­¤è¿™æ ·å¯¹lçš„é™åˆ¶ä¹Ÿæ˜¯ä¸å¤Ÿçš„ã€‚å¦‚å›¾10æ‰€ç¤ºï¼Œä¸ºäº†ä½¿å¾—è¾¹ç•Œçº¦æŸå˜å‡¸å¹¶ä¸”çº¿æ€§ï¼Œåœ¨è‡ªè½¦çš„å‰åä¸¤ç«¯å„å¢åŠ äº†ä¸€ä¸ªåŠåœ†ã€‚å‰è½®åˆ°åè½®ä¸­å¿ƒçš„è·ç¦»ç”¨ l_f â€‹è¡¨ç¤ºï¼Œè½¦å®½ç”¨wè¡¨ç¤ºï¼Œå› æ­¤è½¦çš„å·¦å‰è§’çš„æ¨ªå‘ä½ç½®å¯ä»¥ç”¨ä»¥ä¸‹æ–¹ç¨‹ç»™å‡ºï¼š é€šè¿‡çº¿æ€§åŒ–å¯ä»¥å˜ä¸ºï¼š åŒç†ï¼Œå…¶ä½™ä¸‰ä¸ªè§’çš„ä½ç½®éƒ½å¯ä»¥è¢«çº¿æ€§åŒ–ï¼Œæ˜¾ç„¶å› ä¸º $ \\theta $ è¶³å¤Ÿå°ï¼Œå°äº $ pi/12 $ï¼Œå› æ­¤å¯ä»¥è¿™æ ·çº¿æ€§åŒ–ã€‚ $ f(s) $ çš„äºŒé˜¶å¯¼å’Œä¸‰é˜¶å¯¼ä¸åŠ¨åŠ›å­¦å¯è¡Œæ€§ç›¸å…³ï¼Œé™¤äº†è¾¹ç•Œæ¡ä»¶ä»¥å¤–ï¼Œç”Ÿæˆçš„è·¯å¾„è¿˜åº”è¯¥å’Œè‡ªè½¦çš„åˆå§‹æ¡ä»¶ç›¸åŒ¹é…ã€‚å› ä¸ºæ‰€æœ‰çš„çº¦æŸéƒ½æ˜¯çº¿æ€§çš„ï¼Œæ‰€ä»¥ä½¿ç”¨Quadratic Programmingæ±‚è§£éå¸¸è¿…é€Ÿã€‚ å…·ä½“çš„å…‰æ»‘æ ·æ¡æ›²çº¿å’ŒQPé—®é¢˜å¯ä»¥åœ¨é™„å½•ä¸­æŸ¥é˜…ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:2:4","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"DPé€Ÿåº¦æ±‚è§£ï¼ˆM-stepï¼‰ M-stepçš„é€Ÿåº¦è§„åˆ’æ˜¯åœ¨STå›¾ä¸­æ±‚è§£æœ€ä¼˜é€Ÿåº¦è§„åˆ’ï¼Œå³æ±‚è§£å‡ºæœ€ä¼˜å‡½æ•° S(t)ã€‚ä¸æ±‚è§£æœ€ä¼˜è·¯å¾„ç›¸ä¼¼ï¼Œåœ¨STå›¾ä¸­æ±‚è§£æœ€ä¼˜é€Ÿåº¦è§„åˆ’ä¹Ÿæ˜¯éå‡¸çš„æœ€ä¼˜åŒ–é—®é¢˜ã€‚åŒæ ·ä¹Ÿé‡‡ç”¨Dynamic Programmingé…åˆæ ·æ¡æ›²çº¿Quadratic Programmingæ¥æ‰¾åˆ°å…‰æ»‘é€Ÿåº¦è§„åˆ’ã€‚å›¾12æ˜¯é€Ÿåº¦æ±‚è§£çš„pipelineï¼š DPé€Ÿåº¦æ±‚è§£åŒ…æ‹¬ä»£ä»·å‡½æ•°ã€STæ …æ ¼å›¾ä»¥åŠDynamic Programmingæœç´¢ã€‚ç”Ÿæˆçš„ç»“æœåŒ…æ‹¬åˆ†æ®µçº¿æ€§çš„é€Ÿåº¦è§„åˆ’ã€å¯é€šè¡Œé€šé“ä»¥åŠéšœç¢ç‰©é€Ÿåº¦å†³ç­–ã€‚å¦‚å›¾11æ‰€ç¤ºï¼Œè¯¥ç»“æœåœ¨QPä¸­ç”¨æ¥ä½œä¸ºå‚è€ƒé€Ÿåº¦è§„åˆ’ï¼Œé€šè¿‡è¯¥å‚è€ƒé€Ÿåº¦ç”Ÿæˆå‡¸çš„åŒºåŸŸã€‚ åœ¨æ …æ ¼å›¾ä¸­ï¼Œä½¿ç”¨æœ‰é™å·®åˆ†æ³•æ¥ä¼°è®¡é€Ÿåº¦ã€åŠ é€Ÿåº¦å’Œjerkï¼š ä»DPç”Ÿæˆçš„é€Ÿåº¦ä¸­é€‰æ‹©å‡ºæœ€ä¼˜çš„ä¸€æ¡çš„æ–¹æ³•æ˜¯æœ€å°åŒ–ä»¥ä¸‹çš„ä»£ä»·å‡½æ•°ï¼š ç¬¬ä¸€é¡¹æ˜¯é€Ÿåº¦è¯¯å·®ï¼Œgç”¨æ¥æƒ©ç½šä¸ $ V_ref $ çš„ä¸åŒçš„è¯¯å·®ã€‚ç¬¬äºŒé¡¹ã€ç¬¬ä¸‰é¡¹ç”¨æ¥æè¿°æ›²çº¿çš„å…‰æ»‘ç¨‹åº¦ã€‚æœ€åä¸€é¡¹ç”¨æ¥æè¿°éšœç¢ç‰©ä»£ä»·ï¼Œä»¥åˆ°éšœç¢ç‰©çš„è·ç¦»æ¥è¡¡é‡ã€‚ DPæœç´¢ç©ºé—´ä¹Ÿæ”¶åˆ°è½¦è¾†åŠ¨åŠ›å­¦çº¦æŸï¼Œå¹¶ä¸”ä¹Ÿæœ‰å•è°ƒæ€§çº¦æŸï¼Œå› ä¸ºä¸å¸Œæœ›è½¦è¾†å€’é€€ã€‚ä¸€äº›å¯¹äºåŠ¨åŠ›å­¦çº¦æŸçš„å¿…è¦ç®€åŒ–ä¹Ÿç”¨æ¥åŠ é€Ÿç®—æ³•ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:2:5","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"QPé€Ÿåº¦æ±‚è§£ï¼ˆM-stepï¼‰ å› ä¸ºåˆ†æ®µçº¿æ€§çš„é€Ÿåº¦è§„åˆ’ä¸èƒ½æ»¡è¶³åŠ¨åŠ›å­¦çš„è¦æ±‚ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨Quadratic Programmingæ¥å¡«è¡¥åŠ¨åŠ›å­¦ç©ºç¼ºã€‚å›¾13æ˜¯æ ·æ¡æ›²çº¿QPé€Ÿåº¦æ±‚è§£çš„pipelineï¼š QPé€Ÿåº¦æ±‚è§£åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼šä»£ä»·å‡½æ•°ã€çº¿æ€§çº¦æŸä»¥åŠæ ·æ¡æ›²çº¿QPæ±‚è§£å™¨ã€‚ é™¤äº†åˆå§‹æ¡ä»¶çº¦æŸä»¥å¤–ï¼Œä¸»è¦æœ‰ä»¥ä¸‹çš„è¾¹ç•Œçº¦æŸï¼š ç¬¬ä¸€ä¸ªçº¦æŸæ˜¯å•è°ƒæ€§çº¦æŸï¼›ç¬¬äºŒã€ç¬¬ä¸‰ã€ç¬¬å››çº¦æŸä¸»è¦æ˜¯äº¤é€šè§„åˆ™å’Œè½¦è¾†åŠ¨åŠ›å­¦çº¦æŸã€‚é€šè¿‡çº¦æŸã€costå‡½æ•°è®¡ç®—ä»¥åï¼Œspline QP speedä¼šç”Ÿæˆä¸€æ¡å¦‚å›¾14ä¸­çš„å…‰æ»‘å¯è¡Œçš„é€Ÿåº¦è§„åˆ’ã€‚ ç»“åˆè·¯å¾„è§„åˆ’ï¼ŒEM Planneræœ€ç»ˆä¼šç”Ÿæˆä¸€æ¡å…‰æ»‘è½¨è¿¹ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:2:6","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"è§£QPé—®é¢˜çš„è¯´æ˜ ä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œè·¯å¾„å’Œé€Ÿåº¦å¤§æ¦‚åœ¨100ä¸ªä¸åŒçš„ä½ç½®æˆ–æ—¶é—´ç‚¹ï¼Œé‚£ä¹ˆçº¦æŸå°±æœ‰è¶…è¿‡600ä¸ªã€‚å¯¹äºé€Ÿåº¦ã€è·¯å¾„æ±‚è§£ï¼Œåˆ†æ®µäº”æ¬¡å¤šé¡¹å¼å·²ç»è¶³å¤Ÿï¼Œå› æ­¤æ ·æ¡æ›²çº¿å¤§æ¦‚æœ‰3-5ä¸ªå¤šé¡¹å¼ï¼Œå¤§æ¦‚å°±æœ‰30ä¸ªå‚æ•°ã€‚å› æ­¤Quadratic Programmingå°±å˜æˆäº†ç›¸å¯¹å°çš„ç›®æ ‡å‡½æ•°ï¼Œå’Œç›¸å¯¹å¤§çš„çº¦æŸã€‚QPèƒ½æ¯”è¾ƒå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸Šä¸€å¸§çš„è§£ä½œä¸ºçƒ­å¯åŠ¨ï¼ŒåŠ é€Ÿæ±‚è§£è¿‡ç¨‹ã€‚å®è·µä¸­ï¼ŒQPé—®é¢˜è§£çš„å¹³å‡æ—¶é—´3msã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:2:7","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"DPå’ŒQPéå‡¸é—®é¢˜çš„è¯´æ˜ åœ¨éå‡¸é—®é¢˜ä¸Šï¼ŒDPå’ŒQPéƒ½æœ‰ä»–ä»¬å•ç‹¬çš„é™åˆ¶ã€‚DPå’ŒQPçš„ç»„åˆï¼Œèƒ½å¤Ÿå¾ˆå¥½å¸æ”¶ä¸¤è€…ä¼˜ç‚¹ï¼Œå¹¶æ±‚å¾—ä¸€ä¸ªç†æ€§è§£ã€‚ DP:DPçš„ä¼˜åŠ£å—åˆ°æ’’ç‚¹åˆ†è¾¨ç‡å’Œæ—¶é—´åˆ†è¾¨ç‡çš„å½±å“ï¼Œé€šå¸¸åœ¨è¿è¡Œæ—¶é—´é™åˆ¶çš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬åªä¼šå¾—å‡ºä¸€ä¸ªç²—ç³™è§£è€Œéæœ€ä¼˜è§£ï¼Œæ¯”å¦‚ä¼šä»éšœç¢ç‰©å·¦ä¾§ç»•å¼€ï¼Œä½†å¹¶ä¸æ˜¯æŒ‰ç…§æœ€å®Œç¾çš„è·¯å¾„ç»•å¼€ã€‚ QP:QPéœ€è¦åœ¨å‡¸ç©ºé—´æ±‚è§£ï¼Œå› æ­¤å¿…é¡»å€ŸåŠ©DPçš„è§£æ¥å½¢æˆå‡¸ç©ºé—´ã€‚éšæœºçš„æˆ–è€…åŸºäºè§„åˆ™çš„å†³ç­–ï¼Œé€šå¸¸ä¼šç»™QPå¸¦æ¥éå‡¸çš„ç©ºé—´ï¼Œå› æ­¤è§£QPé—®é¢˜ä¼šå¤±è´¥æˆ–è€…é™·å…¥å±€éƒ¨æœ€ä¼˜ã€‚ DP+QP:ï¼ˆ1ï¼‰é€šè¿‡DPå¯»æ±‚ç²—ç³™è§£ï¼›ï¼ˆ2ï¼‰DPè§£èƒ½å¤Ÿç”Ÿæˆå‡¸ç©ºé—´ï¼›ï¼ˆ3ï¼‰QPåœ¨DPè§£å½¢æˆçš„å‡¸ç©ºé—´å†…ï¼Œå¾ˆå¤§å¯èƒ½èƒ½å¤Ÿè·å¾—å…¨å±€æœ€ä¼˜è§£ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:2:8","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"æ¡ˆä¾‹åˆ†æ å›¾15å±•ç¤ºäº†EM Planneråœ¨è§„åˆ’å‘¨æœŸå†…ï¼Œå¸§ä¸å¸§ä¹‹é—´å®Œæˆæœ€ä¼˜è½¨è¿¹è§„åˆ’çš„è¿‡ç¨‹ã€‚ å‡è®¾è‡ªè½¦ä»¥10m/sçš„é€Ÿåº¦è¡Œè¿›ï¼Œä¸€åŠ¨æ€éšœç¢ç‰©æ²¿ç€ç›¸åæ–¹å‘æœç€æˆ‘ä»¬ä»¥åŒæ ·10m/sçš„é€Ÿåº¦é©¶æ¥ï¼ŒEM PlanneræŒ‰ä»¥ä¸‹æ­¥éª¤è¿­ä»£ç”Ÿæˆé€Ÿåº¦å’Œè·¯å¾„è§„åˆ’ï¼š å†å²è§„åˆ’ï¼ˆå›¾15-aï¼‰ï¼šåœ¨åŠ¨æ€éšœç¢ç‰©å‡ºç°ä¹‹å‰ï¼Œè‡ªè½¦ä»¥æ’å®šé€Ÿåº¦10m/så‘å‰è¡Œé©¶ã€‚ è·¯å¾„è§„åˆ’è¿­ä»£1ï¼ˆå›¾15-bï¼‰ï¼šåŸºäºå½“å‰è½¦é€Ÿå’ŒåŠ¨æ€éšœç¢ç‰©çš„è½¦é€Ÿï¼Œä¸¤è€…å°†ä¼šåœ¨S=40må¤„ç›¸é‡ï¼Œå› æ­¤ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯åœ¨S=40må¤„ç»•å¼€éšœç¢ç‰©ã€‚ é€Ÿåº¦è§„åˆ’è¿­ä»£1ï¼ˆå›¾15-cï¼‰ï¼šåŸºäºè·¯å¾„è§„åˆ’ç»“æœï¼Œå³ä»å³ä¾§é¿å¼€éšœç¢ç‰©ï¼Œè‡ªè½¦å°†è°ƒæ•´å…¶é€Ÿåº¦è§„åˆ’ï¼Œåœ¨é¿å¼€éšœç¢ç‰©ä¹‹å‰å‡é€Ÿåˆ°5m/sã€‚ è·¯å¾„è§„åˆ’è¿­ä»£2ï¼ˆå›¾15-dï¼‰ï¼šç”±äºäº§ç”Ÿäº†æ–°çš„é€Ÿåº¦è§„åˆ’ï¼Œè‡ªè½¦å°†ä¸å†ä¼šä¸åŠ¨æ€éšœç¢ç‰©åœ¨S=40må¤„é¿å¼€ï¼Œè€Œä¼šåœ¨ä¸€ä¸ªæ–°çš„ä½ç½®S=30må¤„é¿å¼€éšœç¢ç‰©ã€‚å› æ­¤ï¼Œè·¯å¾„è§„åˆ’ç»“æœä¹Ÿå°†ä¼šéšé€Ÿåº¦è§„åˆ’æ”¹å˜è€Œé‡æ–°æ›´æ–°ã€‚ é€Ÿåº¦è§„åˆ’è¿­ä»£2ï¼ˆå›¾15-eï¼‰ï¼šç”±äºè·¯å¾„è§„åˆ’å·²ç»æ›´æ–°ï¼Œæ–°çš„ç»•éšœä½ç½®åœ¨S=30må¤„ï¼Œå› æ­¤åœ¨S=40å¤„å‡é€Ÿä¹Ÿå°±æ²¡æœ‰å¿…è¦äº†ï¼Œæ–°çš„é€Ÿåº¦è§„åˆ’ä½¿å¾—è‡ªè½¦å¯ä»¥åœ¨S=40må¤„åŠ é€Ÿè€Œåœ¨S=30må¤„å½¢æˆä¸€ä¸ªå…‰æ»‘çš„ç»•éšœã€‚ ç»è¿‡è¿­ä»£ä¹‹åï¼Œæœ€ç»ˆè½¦è¾†å°†åœ¨S=30må¤„å‡é€Ÿç»•éšœï¼Œå¹¶ä¸”ç»•éšœç»“æŸä¹‹åä¼šåŠ é€Ÿï¼Œè¿™æ ·ä¸€ä¸ªè¿‡ç¨‹å’Œäººç±»é©¾é©¶å‘˜çš„è¡¨ç°å¾ˆç›¸ä¼¼ã€‚ ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡è§„åˆ’éƒ½å¿…é¡»é‡‡å–å¦‚ä¸Šå››æ­¥éª¤ï¼Œæ ¹æ®åœºæ™¯ä¸åŒå¯èƒ½ä¼šäº§ç”Ÿæ›´å¤šæˆ–æ›´å°‘çš„æ­¥éª¤ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œåœºæ™¯è¶Šå¤æ‚ï¼Œæ‰€éœ€è¦çš„æ­¥éª¤å°±è¶Šå¤šã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:3:0","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"æ€»ç»“ EM Planneræ˜¯ä¸€ç§åŸºäºå¼±å†³ç­–çš„ç®—æ³•ï¼Œç›¸æ¯”äºå¼ºå†³ç­–ç®—æ³•ï¼ŒEM Planneråœ¨å¤æ‚åœºæ™¯ã€å¤šéšœç¢ç‰©æƒ…å†µä¸‹è¡¨ç°æ›´å¥½ã€‚å¼ºå†³ç­–ä¾èµ–äºæå‰åˆ¶å®šå‡ºçš„å†³ç­–è¡Œä¸ºï¼Œå¹¶ä¸”æœ‰éš¾ä»¥ç†è§£å’Œé¢„æµ‹ä¸éšœç¢ç‰©äº¤äº’çš„ç¼ºé™·ã€éš¾ä»¥æ»¡è¶³å¤§é‡éšœç¢ç‰©é˜»æŒ¡ç”ŸæˆåŸºäºè§„åˆ™çš„æœ€ä½³è½¨è¿¹çš„ç¼ºé™·ã€‚ EM Planneré€šè¿‡å°†ä¸‰ç»´è§„åˆ’é—®é¢˜è½¬åŒ–ä¸ºä¸¤ä¸ªäºŒç»´è§„åˆ’é—®é¢˜ï¼Œæ˜¾è‘—åœ°é™ä½äº†è¿ç®—å¤æ‚åº¦ï¼Œå› æ­¤ä¼šå¸¦æ¥è¿è¡Œæ—¶é—´çš„å‹ç¼©å’Œæ•´ä¸ªç³»ç»Ÿçš„å¯äº¤äº’æ€§ã€‚ ","date":"2023-07-15","objectID":"/posts/emplanner/:4:0","tags":["draft"],"title":"EM Planner","uri":"/posts/emplanner/"},{"categories":["Planning"],"content":"å†³ç­–è§„åˆ’ï¼ˆä¸€ï¼‰è‡ªåŠ¨é©¾é©¶å®‰å…¨ã€èˆ’é€‚ã€é«˜æ•ˆçš„â€œå®ˆæŠ¤ç¥â€ ","date":"2023-07-15","objectID":"/posts/decisionandplanning_1/:1:0","tags":["draft"],"title":"Decision and Planning [1]","uri":"/posts/decisionandplanning_1/"},{"categories":["Planning"],"content":"å†³ç­–è§„åˆ’åˆ†å±‚æ¶æ„ å†³ç­–è§„åˆ’çš„ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å¯¹æ„ŸçŸ¥åˆ°çš„å‘¨è¾¹ç‰©ä½“çš„é¢„æµ‹è½¨è¿¹çš„åŸºç¡€ä¸Šï¼Œç»“åˆè‡ªåŠ¨é©¾é©¶è½¦è¾†çš„å’Œå½“å‰ä½ç½®ï¼Œå¯¹è½¦è¾†åšå‡ºæœ€åˆç†çš„å†³ç­–å’Œæ§åˆ¶ã€‚ æ­£å¦‚äººçš„å¤§è„‘åˆåˆ†ä¸ºå·¦è„‘å’Œå³è„‘ã€å¹¶è´Ÿè´£ä¸åŒçš„ä»»åŠ¡ä¸€æ ·ï¼Œæ¨¡å—åŒ–è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿä¸­å†³ç­–è§„åˆ’å±‚ä¹Ÿå¯ä»¥ç»§ç»­ç»†åˆ†ä¸ºæ‰§è¡Œä¸åŒä»»åŠ¡çš„å­å±‚ã€‚è€Œè¿™ä¸€åˆ†å±‚è®¾è®¡æœ€æ—©å…¶å®æ˜¯æºè‡ª2007å¹´ä¸¾åŠçš„DAPRAåŸå¸‚æŒ‘æˆ˜èµ›ï¼Œæ¯”èµ›ä¸­å¤šæ•°å‚èµ›é˜Ÿä¼éƒ½å°†è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿçš„å†³ç­–è§„åˆ’æ–¹å¼åŒ…æ‹¬ä¸‰å±‚ï¼šå…¨å±€è·¯å¾„è§„åˆ’å±‚ï¼ˆRoute Planningï¼‰ã€è¡Œä¸ºå†³ç­–å±‚ï¼ˆBehavioral Layerï¼‰å’Œè¿åŠ¨è§„åˆ’å±‚ï¼ˆMotion Planningï¼‰ï¼Œå¦‚å›¾5æ‰€ç¤ºã€‚ å…¨å±€è·¯å¾„è§„åˆ’å±‚èšç„¦åœ¨ç›¸å¯¹é¡¶å±‚çš„è·¯å¾„è§„åˆ’ï¼Œèšç„¦åœ¨åˆ†é’Ÿåˆ°å°æ—¶çº§åˆ«çš„è§„åˆ’ã€‚è¯¥å±‚åœ¨æ¥æ”¶åˆ°è¾“å…¥çš„ç›®çš„åœ°ä¿¡æ¯åï¼ŒåŸºäºå­˜å‚¨çš„åœ°å›¾ä¿¡æ¯æœç´ å‡ºä¸€æ¡è‡ªèµ·å§‹ç‚¹è‡³ç›®æ ‡ç‚¹çš„ä¸€æ¡å¯é€šè¿‡çš„è·¯å¾„ã€‚å¦‚å›¾6æ‰€ç¤ºï¼Œåœ¨è“è‰²èµ·ç‚¹å’Œé»„è‰²ç»ˆç‚¹ä¹‹é—´ï¼Œé»‘è‰²å°±æ˜¯æœç´¢å‡ºæ¥çš„ä¸€æ¡å¯é€šè¡Œçš„è·¯å¾„ï¼Œå½“ç„¶è·¯å¾„ä¸æ­¢ä¸€æ¡ï¼Œå¦‚ä½•æœç´¢å‡ºæœ€ä¼˜æ˜¯ä¸‹æ–‡å°†è¦ä»‹ç»çš„å†…å®¹ã€‚ è¡Œä¸ºå†³ç­–å±‚åœ¨æ”¶åˆ°å…¨å±€è·¯å¾„åï¼Œç»“åˆæ„ŸçŸ¥ç¯å¢ƒä¿¡æ¯ã€äº¤é€šè§„åˆ™ä¿¡æ¯ã€è½¦è¾†çŠ¶æ€ä¿¡æ¯ã€é©¾é©¶åœºæ™¯ä¿¡æ¯ç­‰ï¼Œæ¨å¯¼åˆ¤æ–­ä¸‹ä¸€åˆ†é’Ÿæˆ–ä¸‹ä¸€ç§’æ—¶åˆ»çš„æƒ…å†µï¼Œä½œå‡ºè½¦é“ä¿æŒã€è½¦è¾†è·Ÿéšã€è½¦é“å˜æ¢å’Œåˆ¶åŠ¨é¿æ’ç­‰çš„é€‚åˆå½“å‰äº¤é€šç¯å¢ƒçš„é©¾é©¶è¡Œä¸ºã€‚å¦‚å›¾8æ‰€ç¤ºï¼Œè‡ªè½¦åœ¨æ£€æµ‹åˆ°å‰æ–¹å­˜åœ¨ä½é€Ÿè¡Œé©¶è½¦è¾†ï¼Œä¸”å³ä¾§è½¦é“æ»¡è¶³å˜é“æ¡ä»¶åï¼Œä½œå‡ºå‘å³å˜é“çš„é©¾é©¶è¡Œä¸ºå†³ç­–ã€‚ è¿åŠ¨è§„åˆ’å±‚ä¹Ÿè¢«æˆä¸ºå±€éƒ¨è·¯å¾„è§„åˆ’å±‚ï¼Œä¸å…¨å±€è·¯å¾„è§„åˆ’èšç„¦åœ¨åˆ†é’Ÿåˆ°å°æ—¶çº§åˆ«çš„è§„åˆ’ä¸åŒï¼Œè¿åŠ¨è§„åˆ’èšç„¦åœ¨æ¯«ç§’çº§åˆ°ç§’çº§çš„è§„åˆ’ã€‚è§„åˆ’çš„æ—¶å€™ï¼Œæ ¹æ®è¾“å…¥çš„è¡Œä¸ºå†³ç­–ä¿¡æ¯ã€ç»“åˆè½¦è¾†å®æ—¶ä½å§¿ä¿¡æ¯ã€å±€éƒ¨ç¯å¢ƒä¿¡æ¯ã€å…¨å±€è·¯å¾„å‚è€ƒä¿¡æ¯ç­‰ï¼Œåœ¨â€œå®‰å…¨ã€èˆ’é€‚ã€æ•ˆç‡â€çš„ç²¾ç¥å¼•é¢†ä¸‹ï¼Œè§„åˆ’ç”Ÿæˆä¸€æ¡æ»¡è¶³ç‰¹å®šçº¦æŸæ¡ä»¶çš„å¹³æ»‘è½¨è¿¹è½¨è¿¹ï¼ˆåŒ…æ‹¬è¡Œé©¶è½¨è¿¹ã€é€Ÿåº¦ã€æ–¹å‘ç­‰ï¼‰ï¼Œå¹¶è¾“å…¥ç»™æ§åˆ¶æ‰§è¡Œå±‚ã€‚ ","date":"2023-07-15","objectID":"/posts/decisionandplanning_1/:1:1","tags":["draft"],"title":"Decision and Planning [1]","uri":"/posts/decisionandplanning_1/"},{"categories":["planning"],"content":"ref: [1]. https://mp.weixin.qq.com/s?__biz=MzI2NDY3OTExNw==\u0026mid=2247487486\u0026idx=1\u0026sn=830e7989f285214903c377b35e4b26d1\u0026chksm=eaa9b45cddde3d4a800aaf20fe318f491db75dda42e195cf14bf40084764c29464e7ccb4aad7\u0026mpshare=1\u0026scene=24\u0026srcid=0304BpDN7zLg79RhCijHZ2vJ\u0026sharer_sharetime=1677894823237\u0026sharer_shareid=56cef55fe29db276ae71bc9f586487a1\u0026key=2feb26e6a61e3d07649dfd6a51be6bb25154bc6376a7efb1822eb9800c6762bdec0839b31eac2d53e7f3a38b41696a04763e2640b202142a465d103b5d979e98f8f58c6e6605e2a76edf1c546c4d4d5f42dfe55935123958e7d001d2f802261f3473e6a62ac38fbb731fa7b486d65f38fe75c7121cb46fbab1e7b14f414379f9\u0026ascene=14\u0026uin=MjUyNzM0ODk1\u0026devicetype=Windows+10+x64\u0026version=6309001c\u0026lang=zh_CN\u0026countrycode=DE\u0026exportkey=n_ChQIAhIQpLbne6sMPw4l4V2IEPhLPxLZAQIE97dBBAEAAAAAAD%2FvOcyN4xcAAAAOpnltbLcz9gKNyK89dVj0cCpL6X4%2F9D%2BOuEd517ZezCwL3LfXM5G32y6FBL094wgcVWCTvgW%2Bz4fcrxht5Et9%2FUDDn2cw7Ay9T9fyCNiz21sZHDrEOhZlmmdWpjj2WKQ1flB1hocdJwzrYu0PN7DoVSQ4LEsw3yErLBUhYBSwGAArxC5y%2FzMbMZ8hFAQhKnpd9GPPRQCQmIeWvMl2Zb6nmhgch5icU5Ro%2F%2BmZx%2BV7tbmT0VIVBN7amHSXzs8eAiXSq0I%3D\u0026acctmode=0\u0026pass_ticket=xjMi8aZX3Oq63c%2B7lWkTHtjTObwzDeknqt%2FUl2bVeVY8VC%2F1bfFzwKgz6ydTfuv150JdS2QIagqoczC%2FeNOvBg%3D%3D\u0026wx_header=1\u0026fontgear=2 ","date":"2023-07-15","objectID":"/posts/decisionandplanning_4/:0:0","tags":["draft"],"title":"Decision and Planning [4]","uri":"/posts/decisionandplanning_4/"},{"categories":["planning"],"content":"å†³ç­–è§„åˆ’ï¼ˆå››ï¼‰è¡Œä¸ºå†³ç­–å¸¸ç”¨ç®—æ³• æ»¡è¶³ä¸¤ä¸ªè¦æ±‚: å®‰å…¨æ€§å’Œèˆ’é€‚æ€§ è¿åŠ¨è§„åˆ’ç”Ÿæˆçš„è½¨è¿¹æ˜¯ä¸€ç§ç”±äºŒç»´ç©ºé—´å’Œä¸€ç»´æ—¶é—´ç»„æˆçš„ä¸‰ç»´ç©ºé—´ä¸­çš„æ›²çº¿ï¼Œæ˜¯ä¸€ç§åå®æ—¶çš„è·¯å¾„è§„åˆ’ã€‚ ","date":"2023-07-15","objectID":"/posts/decisionandplanning_4/:1:0","tags":["draft"],"title":"Decision and Planning [4]","uri":"/posts/decisionandplanning_4/"},{"categories":["planning"],"content":"PRM æ¦‚ç‡è·¯æ ‡æ³• (Probabilistic Road Maps, PRMï¼‰ï¼Œæ˜¯ä¸€ç§ç»å…¸çš„é‡‡æ ·æ–¹æ³•ï¼Œç”±Lydia E.ç­‰äººåœ¨1996å¹´æå‡ºã€‚PRMä¸»è¦åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼Œä¸€æ˜¯é‡‡æ ·é˜¶æ®µï¼ŒäºŒæ˜¯ç¢°æ’æ£€æµ‹é˜¶æ®µï¼Œä¸‰æ˜¯æœç´¢é˜¶æ®µã€‚ é‡‡æ ·é˜¶æ®µ: åœ¨é‡‡æ ·é˜¶æ®µä¸­ï¼ŒPRMé¦–å…ˆåœ¨åœ°å›¾ç©ºé—´è¿›è¡Œå‡åŒ€çš„éšæœºé‡‡æ ·ï¼Œä¹Ÿå°±æ˜¯å¯¹åœ°å›¾è¿›è¡Œç¨€ç–é‡‡æ ·ï¼Œç›®çš„æ˜¯å°†å¤§åœ°å›¾ç®€åŒ–ä¸ºè¾ƒå°‘çš„é‡‡æ ·ç‚¹ã€‚ ç¢°æ’æ£€æµ‹é˜¶æ®µ: å‰”é™¤è½åœ¨éšœç¢ç‰©ä¸Šçš„é‡‡æ ·ç‚¹ï¼Œå¹¶å°†å‰©ä¸‹çš„ç‚¹ä¸å…¶ä¸€å®šè·ç¦»èŒƒå›´å†…çš„ç‚¹ç›¸è¿ï¼ŒåŒæ—¶åˆ é™¤ç©¿è¶Šéšœç¢ç‰©çš„è¿çº¿ï¼Œä»è€Œæ„æˆä¸€å¼ æ— å‘å›¾ã€‚ æœç´¢é˜¶æ®µ: åˆ©ç”¨å…¨å±€è·¯å¾„è§„åˆ’ç®—æ³•ç« èŠ‚ä»‹ç»çš„æœç´¢ç®—æ³•ï¼ˆDijkstraã€A*ç­‰ï¼‰åœ¨æ— å‘å›¾ä¸­è¿›è¡Œæœç´¢ï¼Œä»è€Œæ‰¾å‡ºä¸€æ¡èµ·ç‚¹Aåˆ°ç»ˆç‚¹Bä¹‹é—´çš„å¯è¡Œè·¯å¾„ã€‚ ç®—æ³•æ­¥éª¤å¯ä»¥æ€»ç»“ä¸ºï¼š ï¼ˆ1ï¼‰æ„é€ æ— å‘å›¾G =ï¼ˆVï¼ŒEï¼‰ï¼Œå…¶ä¸­Vä»£è¡¨éšæœºé‡‡æ ·çš„ç‚¹é›†ï¼ŒEä»£è¡¨ä¸¤é‡‡æ ·ç‚¹ä¹‹é—´æ‰€æœ‰å¯èƒ½çš„æ— ç¢°æ’è·¯å¾„ï¼ŒGåˆå§‹çŠ¶æ€ä¸ºç©ºã€‚ ï¼ˆ2ï¼‰éšæœºæ’’ç‚¹ï¼Œå¹¶é€‰å–ä¸€ä¸ªæ— ç¢°æ’çš„ç‚¹c(i)åŠ å…¥åˆ°Vä¸­ã€‚ ï¼ˆ3ï¼‰å®šä¹‰è·ç¦»rï¼Œå¦‚æœc(i)ä¸Vä¸­æŸäº›ç‚¹çš„è·ç¦»å°äºrï¼Œåˆ™å°†Vä¸­è¿™äº›ç‚¹å®šä¹‰ä¸ºc(i)çš„é‚»åŸŸç‚¹ã€‚ ï¼ˆ4ï¼‰å°†c(i)ä¸å…¶é‚»åŸŸç‚¹ç›¸è¿ï¼Œç”Ÿæˆè¿çº¿tï¼Œå¹¶æ£€æµ‹è¿çº¿tæ˜¯å¦ä¸éšœç¢ç‰©å‘ç”Ÿç¢°æ’ï¼Œå¦‚æœæ— ç¢°æ’ï¼Œåˆ™å°†tåŠ å…¥Eä¸­ã€‚ ï¼ˆ5ï¼‰é‡å¤æ­¥éª¤2-4ï¼Œç›´åˆ°æ‰€æœ‰é‡‡æ ·ç‚¹ï¼ˆæ»¡è¶³é‡‡æ ·æ•°é‡è¦æ±‚ï¼‰å‡å·²å®Œæˆä¸Šè¿°æ­¥éª¤ã€‚ ï¼ˆ5ï¼‰é‡‡ç”¨å›¾æœç´¢ç®—æ³•å¯¹æ— å‘å›¾Gè¿›è¡Œæœç´¢ï¼Œå¦‚æœèƒ½æ‰¾åˆ°èµ·å§‹ç‚¹Aåˆ°ç»ˆç‚¹Bçš„è·¯çº¿ï¼Œè¯´æ˜å­˜åœ¨å¯è¡Œçš„è¡Œé©¶è½¨è¿¹ã€‚ PRMç®—æ³•ç›¸æ¯”åŸºäºæœç´¢çš„ç®—æ³•ï¼Œç®€åŒ–äº†ç¯å¢ƒã€æé«˜äº†æ•ˆç‡ã€‚ä½†æ˜¯åœ¨æœ‰ç‹­çª„é€šé“åœºæ™¯ä¸­ï¼Œå¾ˆéš¾é‡‡æ ·å‡ºå¯è¡Œè·¯å¾„ï¼Œæ•ˆç‡ä¼šå¤§å¹…é™ä½ã€‚ ","date":"2023-07-15","objectID":"/posts/decisionandplanning_4/:1:1","tags":["draft"],"title":"Decision and Planning [4]","uri":"/posts/decisionandplanning_4/"},{"categories":["planning"],"content":"RRT å¿«é€Ÿæ¢ç´¢éšæœºæ ‘ï¼ˆRapidly Exploring Random Treesï¼ŒRRTï¼‰ï¼Œæ˜¯Steven M. LaValleå’ŒJames J. Kuffner Jr.åœ¨1998å¹´æå‡ºçš„ä¸€ç§åŸºäºéšæœºç”Ÿé•¿æ ‘æ€æƒ³å®ç°å¯¹éå‡¸é«˜ç»´ç©ºé—´å¿«é€Ÿæœç´¢çš„ç®—æ³•ã€‚ ä¸PRMç›¸åŒçš„æ˜¯ä¸¤è€…éƒ½æ˜¯åŸºäºéšæœºé‡‡æ ·çš„ç®—æ³•ï¼Œä¸åŒçš„æ˜¯PRMæœ€ç»ˆç”Ÿæˆçš„æ˜¯ä¸€ä¸ªæ— å‘å›¾ï¼Œè€ŒRRTç”Ÿæˆçš„æ˜¯ä¸€ä¸ªéšæœºæ ‘ã€‚RRTçš„æœ€æ˜¾è‘—ç‰¹å¾å°±æ˜¯å…·å¤‡ç©ºé—´æ¢ç´¢çš„èƒ½åŠ›ï¼Œå³ä»ä¸€ç‚¹å‘å¤–æ¢ç´¢æ‹“å±•çš„ç‰¹å¾ã€‚ RRTåˆ†å•æ ‘å’ŒåŒæ ‘ä¸¤ç§ç±»å‹ï¼Œå•æ ‘RRTå°†èµ·ç‚¹ä½œä¸ºéšæœºæ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œé€šè¿‡éšæœºé‡‡æ ·ã€ç¢°æ’æ£€æµ‹çš„æ–¹å¼ä¸ºéšæœºæ ‘å¢åŠ å¶å­èŠ‚ç‚¹ï¼Œæœ€ç»ˆç”Ÿæˆä¸€é¢—éšæœºæ ‘ã€‚è€ŒåŒæ ‘RRTåˆ™æ‹¥æœ‰ä¸¤é¢—éšæœºæ ‘ï¼Œåˆ†åˆ«ä»¥èµ·ç‚¹å’Œç»ˆç‚¹ä¸ºæ ¹èŠ‚ç‚¹ï¼Œä»¥åŒæ ·çš„æ–¹å¼è¿›è¡Œå‘å¤–çš„æ¢ç´¢ï¼Œç›´åˆ°ä¸¤é¢—éšæœºæ ‘ç›¸é‡ï¼Œä»è€Œè¾¾åˆ°æé«˜è§„åˆ’æ•ˆç‡çš„ç›®çš„ã€‚ å¯¹äºå•æ ‘RRTç®—æ³•ï¼Œæˆ‘ä»¬å°†èµ·ç‚¹Aè®¾ç½®ä¸ºéšæœºæ ‘çš„æ ¹ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªéšæœºé‡‡æ ·ç‚¹ï¼Œå¦‚å›¾27æ‰€ç¤ºï¼Œéšæœºé‡‡æ ·ç‚¹æœ‰ä¸‹é¢è¿™å‡ ç§æƒ…å†µã€‚ ï¼ˆ1ï¼‰éšæœºé‡‡æ ·ç‚¹1è½åœ¨è‡ªç”±åŒºåŸŸä¸­ï¼Œä½†æ˜¯æ ¹èŠ‚ç‚¹Aå’Œéšæœºé‡‡æ ·ç‚¹1ä¹‹é—´çš„è¿çº¿å­˜åœ¨éšœç¢ç‰©ï¼Œæ— æ³•é€šè¿‡ç¢°æ’æ£€æµ‹ï¼Œé‡‡æ ·ç‚¹1ä¼šè¢«èˆå¼ƒï¼Œé‡æ–°å†ç”Ÿæˆéšæœºé‡‡æ ·ç‚¹ã€‚ ï¼ˆ2ï¼‰éšæœºé‡‡æ ·ç‚¹2è½åœ¨éšœç¢ç‰©çš„ä½ç½®ï¼Œé‡‡æ ·ç‚¹2ä¹Ÿä¼šè¢«èˆå¼ƒï¼Œé‡æ–°å†ç”Ÿæˆéšæœºé‡‡æ ·ç‚¹ã€‚ ï¼ˆ3ï¼‰éšæœºé‡‡æ ·ç‚¹3è½åœ¨è‡ªç”±åŒºåŸŸï¼Œä¸”ä¸æ ¹èŠ‚ç‚¹Aä¹‹é—´çš„è¿çº¿ä¸å­˜åœ¨éšœç¢ç‰©ï¼Œä½†æ˜¯è¶…è¿‡æ ¹èŠ‚ç‚¹çš„æ­¥é•¿é™åˆ¶ã€‚ä½†æ­¤æ—¶è¿™ä¸ªèŠ‚ç‚¹ä¸ä¼šè¢«ç®€å•çš„èˆå¼ƒæ‰ï¼Œè€Œæ˜¯ä¼šæ²¿ç€æ ¹èŠ‚ç‚¹å’Œéšæœºé‡‡æ ·ç‚¹3çš„è¿çº¿ï¼Œæ‰¾å‡ºç¬¦åˆæ­¥é•¿é™åˆ¶çš„ä¸­é—´ç‚¹ï¼Œå°†è¿™ä¸ªä¸­é—´ç‚¹ä½œä¸ºæ–°çš„é‡‡æ ·ç‚¹ï¼Œä¹Ÿå°±æ˜¯å›¾29ä¸­çš„4ã€‚ æ¥ç€æˆ‘ä»¬ç»§ç»­ç”Ÿæˆæ–°çš„éšæœºé‡‡æ ·ç‚¹ï¼Œå¦‚æœæ–°çš„éšæœºé‡‡æ ·ç‚¹ä½äºè‡ªç”±åŒºåŸŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥éå†éšæœºæ ‘ä¸­å·²æœ‰çš„å…¨éƒ¨èŠ‚ç‚¹ï¼Œæ‰¾å‡ºè·ç¦»æ–°çš„éšæœºé‡‡æ ·ç‚¹æœ€è¿‘çš„èŠ‚ç‚¹ï¼ŒåŒæ—¶æ±‚å‡ºä¸¤è€…ä¹‹é—´çš„è·ç¦»ï¼Œå¦‚æœæ»¡è¶³æ­¥é•¿é™åˆ¶çš„è¯ï¼Œæˆ‘ä»¬å°†æ¥ç€å¯¹è¿™ä¸¤ä¸ªèŠ‚ç‚¹è¿›è¡Œç¢°æ’æ£€æµ‹ï¼Œå¦‚æœä¸æ»¡è¶³æ­¥é•¿é™åˆ¶çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦æ²¿ç€æ–°çš„éšæœºé‡‡æ ·ç‚¹å’Œæœ€è¿‘çš„èŠ‚ç‚¹çš„è¿çº¿æ–¹å‘ï¼Œæ‰¾å‡ºä¸€ä¸ªç¬¦åˆæ­¥é•¿é™åˆ¶çš„ä¸­é—´ç‚¹ï¼Œç”¨æ¥æ›¿ä»£æ–°çš„éšæœºé‡‡æ ·ç‚¹ã€‚æœ€åå¦‚æœæ–°çš„éšæœºé‡‡æ ·ç‚¹å’Œæœ€è¿‘çš„èŠ‚ç‚¹é€šè¿‡äº†ç¢°æ’æ£€æµ‹ï¼Œå°±æ„å‘³ç€äºŒè€…ä¹‹é—´å­˜åœ¨è¾¹ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å°†æ–°çš„éšæœºé‡‡æ ·ç‚¹æ·»åŠ è¿›éšæœºæ ‘ä¸­ï¼Œå¹¶å°†æœ€è¿‘çš„ç‚¹è®¾ç½®ä¸ºæ–°çš„éšæœºé‡‡æ ·ç‚¹çš„çˆ¶èŠ‚ç‚¹ã€‚ é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ–°çš„éšæœºé‡‡æ ·ç‚¹åœ¨ç»ˆç‚¹çš„æ­¥é•¿é™åˆ¶èŒƒå›´å†…ï¼Œä¸”æ»¡è¶³ç¢°æ’æ£€æµ‹ã€‚åˆ™å°†æ–°çš„éšæœºé‡‡æ ·ç‚¹è®¾ä¸ºç»ˆç‚¹Bçš„çˆ¶èŠ‚ç‚¹ï¼Œå¹¶å°†ç»ˆç‚¹åŠ å…¥éšæœºæ ‘ï¼Œä»è€Œå®Œæˆè¿­ä»£ï¼Œç”Ÿæˆå¦‚å›¾30æ‰€ç¤ºçš„å®Œæ•´éšæœºæ ‘ã€‚ ç›¸æ¯”PRMï¼ŒRRTæ— éœ€æœç´¢æ­¥éª¤ã€æ•ˆç‡æ›´é«˜ã€‚é€šè¿‡å¢é‡å¼æ‰©å±•çš„æ–¹å¼ï¼Œæ‰¾åˆ°è·¯å¾„åå°±ç«‹å³ç»“æŸï¼Œæœç´¢ç»ˆç‚¹çš„ç›®çš„æ€§æ›´å¼ºã€‚ä½†æ˜¯RRTä½œä¸ºä¸€ç§çº¯ç²¹çš„éšæœºæœç´¢ç®—æ³•ï¼Œå¯¹ç¯å¢ƒç±»å‹ä¸æ•æ„Ÿï¼Œå½“åœ°å›¾ç©ºé—´ä¸­å­˜åœ¨ç‹­çª„é€šé“æ—¶ï¼Œå› è¢«é‡‡æ ·çš„æ¦‚ç‡ä½ï¼Œå¯¼è‡´ç®—æ³•çš„æ”¶æ•›é€Ÿåº¦æ…¢ï¼Œæ•ˆç‡ä¼šå¤§å¹…ä¸‹é™ï¼Œæœ‰æ—¶å€™ç”šè‡³éš¾ä»¥åœ¨æœ‰ç‹­çª„é€šé“çš„ç¯å¢ƒæ‰¾åˆ°è·¯å¾„ã€‚ å›¾31å±•ç¤ºäº† RRTåº”å¯¹å­˜åœ¨ç‹­çª„é€šé“åœ°å›¾ç©ºé—´æ—¶çš„ä¸¤ç§è¡¨ç°ï¼Œä¸€ç§æ˜¯RRTå¾ˆå¿«å°±æ‰¾åˆ°äº†å‡ºè·¯ï¼Œä¸€ç§æ˜¯ä¸€ç›´è¢«å›°åœ¨éšœç¢ç‰©é‡Œé¢ã€‚ å›´ç»•å¦‚ä½•æ›´å¥½çš„â€œè¿›è¡Œéšæœºé‡‡æ ·â€ã€â€œå®šä¹‰æœ€è¿‘çš„ç‚¹â€ä»¥åŠâ€œè¿›è¡Œæ ‘çš„æ‰©å±•â€ç­‰æ–¹é¢ï¼Œè¯ç”Ÿäº†å¤šç§æ”¹è¿›å‹çš„ç®—æ³•ï¼ŒåŒ…æ‹¬åŒæ ‘RRT-Connectï¼ˆåŒæ ‘ï¼‰ã€lazy-RRT, RRT-Extendç­‰ã€‚ PRMå’ŒRRTéƒ½æ˜¯ä¸€ä¸ªæ¦‚ç‡å®Œå¤‡ä½†éæœ€ä¼˜çš„è·¯å¾„è§„åˆ’ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯åªè¦èµ·ç‚¹å’Œç»ˆç‚¹ä¹‹é—´å­˜åœ¨æœ‰æ•ˆçš„è·¯å¾„ï¼Œé‚£ä¹ˆåªè¦è§„åˆ’çš„æ—¶é—´è¶³å¤Ÿé•¿ï¼Œé‡‡æ ·ç‚¹è¶³å¤Ÿå¤šï¼Œå¿…ç„¶å¯ä»¥æ‰¾åˆ°æœ‰æ•ˆçš„è·¯å¾„ã€‚ä½†æ˜¯è¿™ä¸ªè§£æ— æ³•ä¿è¯æ˜¯æœ€ä¼˜çš„ã€‚ é‡‡ç”¨PRMå’ŒRRTç­‰éšæœºé‡‡æ ·ç®—æ³•ç”Ÿæˆçš„è¡Œé©¶è½¨è¿¹ï¼Œå¤§å¤šæ˜¯ä¸€æ¡æ¡çº¿æ®µï¼Œçº¿æ®µä¹‹é—´çš„æ›²ç‡ä¹Ÿä¸ä¸è¿ç»­ï¼Œè¿™æ ·çš„è¡Œé©¶è½¨è¿¹æ˜¯ä¸èƒ½ä¿è¯èˆ’é€‚æ€§çš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦è¿›ä¸€æ­¥è¿›è¡Œæ›²çº¿å¹³æ»‘ã€è§’åº¦å¹³æ»‘å¤„ç†ã€‚ä»£è¡¨ç®—æ³•æ˜¯åŸºäºæ›²çº¿æ’å€¼çš„æ–¹æ³•ï¼šRSæ›²çº¿ã€Dubinsæ›²çº¿ã€å¤šé¡¹å¼æ›²çº¿ã€è´å¡å°”æ›²çº¿å’Œæ ·æ¡æ›²çº¿ç­‰ã€‚ æ‰€æœ‰åŸºäºæ›²çº¿æ’å€¼æ–¹æ³•è¦è§£å†³çš„é—®é¢˜å°±æ˜¯ï¼šåœ¨å›¾32ä¸Šçš„è‹¥å¹²ç‚¹ä¸­ï¼Œæ±‚å‡ºä¸€æ¡å…‰æ»‘æ›²çº¿å°½å¯èƒ½é€¼è¿‘æ‰€æœ‰ç‚¹ã€‚ä¸‹æ–‡ä»¥å¤šé¡¹å¼æ›²çº¿å’Œè´å¡å°”æ›²çº¿ä¸ºä¾‹ï¼Œä»‹ç»æ›²çº¿æ’å€¼ç®—æ³•çš„ç¤ºä¾‹ã€‚ ","date":"2023-07-15","objectID":"/posts/decisionandplanning_4/:1:2","tags":["draft"],"title":"Decision and Planning [4]","uri":"/posts/decisionandplanning_4/"},{"categories":["planning"],"content":"å¤šé¡¹å¼æ›²çº¿ ","date":"2023-07-15","objectID":"/posts/decisionandplanning_4/:1:3","tags":["draft"],"title":"Decision and Planning [4]","uri":"/posts/decisionandplanning_4/"},{"categories":["Planning"],"content":"ref: [1] https://mp.weixin.qq.com/s/hgT-a3Ug9578k1DmioRgUg [2] http://www.gamedev.net/reference/articles/article2003.asp A*ç®—æ³•è¯¦è§£ ","date":"2023-07-15","objectID":"/posts/a_star/:0:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Planning"],"content":"0. æ¦‚è¿° è™½ç„¶æŒæ¡äº† A* ç®—æ³•çš„äººè®¤ä¸ºå®ƒå®¹æ˜“ï¼Œä½†æ˜¯å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œ A* ç®—æ³•è¿˜æ˜¯å¾ˆå¤æ‚çš„ã€‚ ","date":"2023-07-15","objectID":"/posts/a_star/:1:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Planning"],"content":"1. æœç´¢åŒºåŸŸ(The Search Area) æˆ‘ä»¬å‡è®¾æŸäººè¦ä» A ç‚¹ç§»åŠ¨åˆ° B ç‚¹ï¼Œä½†æ˜¯è¿™ä¸¤ç‚¹ä¹‹é—´è¢«ä¸€å µå¢™éš”å¼€ã€‚å¦‚å›¾ 1 ï¼Œç»¿è‰²æ˜¯ A ï¼Œçº¢è‰²æ˜¯ B ï¼Œä¸­é—´è“è‰²æ˜¯å¢™ã€‚ å›¾ 1 ä½ åº”è¯¥æ³¨æ„åˆ°äº†ï¼Œæˆ‘ä»¬æŠŠè¦æœå¯»çš„åŒºåŸŸåˆ’åˆ†æˆäº†æ­£æ–¹å½¢çš„æ ¼å­ã€‚è¿™æ˜¯å¯»è·¯çš„ç¬¬ä¸€æ­¥ï¼Œç®€åŒ–æœç´¢åŒºåŸŸï¼Œå°±åƒæˆ‘ä»¬è¿™é‡Œåšçš„ä¸€æ ·ã€‚è¿™ä¸ªç‰¹æ®Šçš„æ–¹æ³•æŠŠæˆ‘ä»¬çš„æœç´¢åŒºåŸŸç®€åŒ–ä¸ºäº† 2 ç»´æ•°ç»„ã€‚æ•°ç»„çš„æ¯ä¸€é¡¹ä»£è¡¨ä¸€ä¸ªæ ¼å­ï¼Œå®ƒçš„çŠ¶æ€å°±æ˜¯å¯èµ° (walkalbe) å’Œä¸å¯èµ° (unwalkable) ã€‚é€šè¿‡è®¡ç®—å‡ºä» A åˆ° Béœ€è¦èµ°è¿‡å“ªäº›æ–¹æ ¼ï¼Œå°±æ‰¾åˆ°äº†è·¯å¾„ã€‚ä¸€æ—¦è·¯å¾„æ‰¾åˆ°äº†ï¼Œäººç‰©ä¾¿ä»ä¸€ä¸ªæ–¹æ ¼çš„ä¸­å¿ƒç§»åŠ¨åˆ°å¦ä¸€ä¸ªæ–¹æ ¼çš„ä¸­å¿ƒï¼Œç›´è‡³åˆ°è¾¾ç›®çš„åœ°ã€‚ æ–¹æ ¼çš„ä¸­å¿ƒç‚¹æˆ‘ä»¬ç§°ä¸ºâ€œèŠ‚ç‚¹ (nodes) â€ã€‚å¦‚æœä½ è¯»è¿‡å…¶ä»–å…³äº A* å¯»è·¯ç®—æ³•çš„æ–‡ç« ï¼Œä½ ä¼šå‘ç°äººä»¬å¸¸å¸¸éƒ½åœ¨è®¨è®ºèŠ‚ç‚¹ã€‚ä¸ºä»€ä¹ˆä¸ç›´æ¥æè¿°ä¸ºæ–¹æ ¼å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬æœ‰å¯èƒ½æŠŠæœç´¢åŒºåŸŸåˆ’ä¸ºä¸ºå…¶ä»–å¤šå˜å½¢è€Œä¸æ˜¯æ­£æ–¹å½¢ï¼Œä¾‹å¦‚å¯ä»¥æ˜¯å…­è¾¹å½¢ï¼ŒçŸ©å½¢ï¼Œç”šè‡³å¯ä»¥æ˜¯ä»»æ„å¤šè¾¹å½¢ã€‚è€ŒèŠ‚ç‚¹å¯ä»¥æ”¾åœ¨ä»»æ„å¤šè¾¹å½¢é‡Œé¢ï¼Œå¯ä»¥æ”¾åœ¨å¤šè¾¹å½¢çš„ä¸­å¿ƒï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨å¤šè¾¹å½¢çš„è¾¹ä¸Šã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç³»ç»Ÿï¼Œå› ä¸ºå®ƒæœ€ç®€å•ã€‚ ","date":"2023-07-15","objectID":"/posts/a_star/:2:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Planning"],"content":"2. å¼€å§‹æœç´¢(Starting the Search) ä¸€æ—¦æˆ‘ä»¬æŠŠæœå¯»åŒºåŸŸç®€åŒ–ä¸ºä¸€ç»„å¯ä»¥é‡åŒ–çš„èŠ‚ç‚¹åï¼Œå°±åƒä¸Šé¢åšçš„ä¸€æ ·ï¼Œæˆ‘ä»¬ä¸‹ä¸€æ­¥è¦åšçš„ä¾¿æ˜¯æŸ¥æ‰¾æœ€çŸ­è·¯å¾„ã€‚åœ¨ A* ä¸­ï¼Œæˆ‘ä»¬ä»èµ·ç‚¹å¼€å§‹ï¼Œæ£€æŸ¥å…¶ç›¸é‚»çš„æ–¹æ ¼ï¼Œç„¶åå‘å››å‘¨æ‰©å±•ï¼Œç›´è‡³æ‰¾åˆ°ç›®æ ‡ã€‚ æˆ‘ä»¬è¿™æ ·å¼€å§‹æˆ‘ä»¬çš„å¯»è·¯æ—…é€”ï¼š ä»èµ·ç‚¹ A å¼€å§‹ï¼Œå¹¶æŠŠå®ƒå°±åŠ å…¥åˆ°ä¸€ä¸ªç”±æ–¹æ ¼ç»„æˆçš„ open list( å¼€æ”¾åˆ—è¡¨ ) ä¸­ã€‚è¿™ä¸ª open list æœ‰ç‚¹åƒæ˜¯ä¸€ä¸ªè´­ç‰©å•ã€‚å½“ç„¶ç°åœ¨ open list é‡Œåªæœ‰ä¸€é¡¹ï¼Œå®ƒå°±æ˜¯èµ·ç‚¹ A ï¼Œåé¢ä¼šæ…¢æ…¢åŠ å…¥æ›´å¤šçš„é¡¹ã€‚ Open list é‡Œçš„æ ¼å­æ˜¯è·¯å¾„å¯èƒ½ä¼šæ˜¯æ²¿é€”ç»è¿‡çš„ï¼Œä¹Ÿæœ‰å¯èƒ½ä¸ç»è¿‡ã€‚åŸºæœ¬ä¸Š open list æ˜¯ä¸€ä¸ªå¾…æ£€æŸ¥çš„æ–¹æ ¼åˆ—è¡¨ã€‚ æŸ¥çœ‹ä¸èµ·ç‚¹ A ç›¸é‚»çš„æ–¹æ ¼ ( å¿½ç•¥å…¶ä¸­å¢™å£æ‰€å é¢†çš„æ–¹æ ¼ï¼Œæ²³æµæ‰€å é¢†çš„æ–¹æ ¼åŠå…¶ä»–éæ³•åœ°å½¢å é¢†çš„æ–¹æ ¼ ) ï¼ŒæŠŠå…¶ä¸­å¯èµ°çš„ (walkable) æˆ–å¯åˆ°è¾¾çš„ (reachable) æ–¹æ ¼ä¹ŸåŠ å…¥åˆ° open list ä¸­ã€‚æŠŠèµ·ç‚¹ A è®¾ç½®ä¸ºè¿™äº›æ–¹æ ¼çš„çˆ¶äº² (parent node æˆ– parent square) ã€‚å½“æˆ‘ä»¬åœ¨è¿½è¸ªè·¯å¾„æ—¶ï¼Œè¿™äº›çˆ¶èŠ‚ç‚¹çš„å†…å®¹æ˜¯å¾ˆé‡è¦çš„ã€‚ç¨åè§£é‡Šã€‚ æŠŠ A ä» open list ä¸­ç§»é™¤ï¼ŒåŠ å…¥åˆ° close list( å°é—­åˆ—è¡¨ ) ä¸­ï¼Œ close list ä¸­çš„æ¯ä¸ªæ–¹æ ¼éƒ½æ˜¯ç°åœ¨ä¸éœ€è¦å†å…³æ³¨çš„ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ·±ç»¿è‰²çš„æ–¹æ ¼ä¸ºèµ·ç‚¹ï¼Œå®ƒçš„å¤–æ¡†æ˜¯äº®è“è‰²ï¼Œè¡¨ç¤ºè¯¥æ–¹æ ¼è¢«åŠ å…¥åˆ°äº† close list ã€‚ä¸å®ƒç›¸é‚»çš„é»‘è‰²æ–¹æ ¼æ˜¯éœ€è¦è¢«æ£€æŸ¥çš„ï¼Œä»–ä»¬çš„å¤–æ¡†æ˜¯äº®ç»¿è‰²ã€‚æ¯ä¸ªé»‘æ–¹æ ¼éƒ½æœ‰ä¸€ä¸ªç°è‰²çš„æŒ‡é’ˆæŒ‡å‘ä»–ä»¬çš„çˆ¶èŠ‚ç‚¹ï¼Œè¿™é‡Œæ˜¯èµ·ç‚¹ A ã€‚ å›¾ 2 ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦ä» open list ä¸­é€‰ä¸€ä¸ªä¸èµ·ç‚¹ A ç›¸é‚»çš„æ–¹æ ¼ï¼ŒæŒ‰ä¸‹é¢æè¿°çš„ä¸€æ ·æˆ–å¤šæˆ–å°‘çš„é‡å¤å‰é¢çš„æ­¥éª¤ã€‚ä½†æ˜¯åˆ°åº•é€‰æ‹©å“ªä¸ªæ–¹æ ¼å¥½å‘¢ï¼Ÿå…·æœ‰æœ€å° F å€¼çš„é‚£ä¸ªã€‚ ","date":"2023-07-15","objectID":"/posts/a_star/:3:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Planning"],"content":"3. è·¯å¾„æ’åº(Path Sorting) è®¡ç®—å‡ºç»„æˆè·¯å¾„çš„æ–¹æ ¼çš„å…³é”®æ˜¯ä¸‹é¢è¿™ä¸ªç­‰å¼ï¼š $$F = G + H \\tag{1}$$ è¿™é‡Œï¼Œ G = ä»èµ·ç‚¹ A ç§»åŠ¨åˆ°æŒ‡å®šæ–¹æ ¼çš„ç§»åŠ¨ä»£ä»·ï¼Œæ²¿ç€åˆ°è¾¾è¯¥æ–¹æ ¼è€Œç”Ÿæˆçš„è·¯å¾„ã€‚ H = ä»æŒ‡å®šçš„æ–¹æ ¼ç§»åŠ¨åˆ°ç»ˆç‚¹ B çš„ä¼°ç®—æˆæœ¬ã€‚è¿™ä¸ªé€šå¸¸è¢«ç§°ä¸ºè¯•æ¢æ³•ï¼Œæœ‰ç‚¹è®©äººæ··æ·†ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆå«å‘¢ï¼Œå› ä¸ºè¿™æ˜¯ä¸ªçŒœæµ‹ã€‚ç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°äº†è·¯å¾„æˆ‘ä»¬æ‰ä¼šçŸ¥é“çœŸæ­£çš„è·ç¦»ï¼Œå› ä¸ºé€”ä¸­æœ‰å„ç§å„æ ·çš„ä¸œè¥¿ ( æ¯”å¦‚å¢™å£ï¼Œæ°´ç­‰ ) ã€‚æœ¬æ•™ç¨‹å°†æ•™ä½ ä¸€ç§è®¡ç®— H çš„æ–¹æ³•ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ç½‘ä¸Šæ‰¾åˆ°å…¶ä»–æ–¹æ³•ã€‚ æˆ‘ä»¬çš„è·¯å¾„æ˜¯è¿™ä¹ˆäº§ç”Ÿçš„ï¼šåå¤éå† open list ï¼Œé€‰æ‹© F å€¼æœ€å°çš„æ–¹æ ¼ã€‚è¿™ä¸ªè¿‡ç¨‹ç¨åè¯¦ç»†æè¿°ã€‚æˆ‘ä»¬è¿˜æ˜¯å…ˆçœ‹çœ‹æ€ä¹ˆå»è®¡ç®—ä¸Šé¢çš„ç­‰å¼ã€‚ å¦‚ä¸Šæ‰€è¿°ï¼Œ G æ˜¯ä»èµ·ç‚¹ï¼¡ç§»åŠ¨åˆ°æŒ‡å®šæ–¹æ ¼çš„ç§»åŠ¨ä»£ä»·ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæ¨ªå‘å’Œçºµå‘çš„ç§»åŠ¨ä»£ä»·ä¸º 10 ï¼Œå¯¹è§’çº¿çš„ç§»åŠ¨ä»£ä»·ä¸º 14 ã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨è¿™äº›æ•°æ®ï¼Œæ˜¯å› ä¸ºå®é™…çš„å¯¹è§’ç§»åŠ¨è·ç¦»æ˜¯ 2 çš„å¹³æ–¹æ ¹ï¼Œæˆ–è€…æ˜¯è¿‘ä¼¼çš„ 1.414 å€çš„æ¨ªå‘æˆ–çºµå‘ç§»åŠ¨ä»£ä»·ã€‚ä½¿ç”¨ 10 å’Œ 14 å°±æ˜¯ä¸ºäº†ç®€å•èµ·è§ã€‚æ¯”ä¾‹æ˜¯å¯¹çš„ï¼Œæˆ‘ä»¬é¿å…äº†å¼€æ”¾å’Œå°æ•°çš„è®¡ç®—ã€‚è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æ²¡æœ‰è¿™ä¸ªèƒ½åŠ›æˆ–æ˜¯ä¸å–œæ¬¢æ•°å­¦ã€‚ä½¿ç”¨è¿™äº›æ•°å­—ä¹Ÿå¯ä»¥ä½¿è®¡ç®—æœºæ›´å¿«ã€‚ç¨åä½ ä¾¿ä¼šå‘ç°ï¼Œå¦‚æœä¸ä½¿ç”¨è¿™äº›æŠ€å·§ï¼Œå¯»è·¯ç®—æ³•å°†å¾ˆæ…¢ã€‚ æ—¢ç„¶æˆ‘ä»¬æ˜¯æ²¿ç€åˆ°è¾¾æŒ‡å®šæ–¹æ ¼çš„è·¯å¾„æ¥è®¡ç®— G å€¼ï¼Œé‚£ä¹ˆè®¡ç®—å‡ºè¯¥æ–¹æ ¼çš„ G å€¼çš„æ–¹æ³•å°±æ˜¯æ‰¾å‡ºå…¶çˆ¶äº²çš„ G å€¼ï¼Œç„¶åæŒ‰çˆ¶äº²æ˜¯ç›´çº¿æ–¹å‘è¿˜æ˜¯æ–œçº¿æ–¹å‘åŠ ä¸Š 10 æˆ– 14 ã€‚éšç€æˆ‘ä»¬ç¦»å¼€èµ·ç‚¹è€Œå¾—åˆ°æ›´å¤šçš„æ–¹æ ¼ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå˜å¾—æ›´åŠ æ˜æœ—ã€‚ æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥ä¼°ç®— H å€¼ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ Manhattan æ–¹æ³•ï¼Œè®¡ç®—ä»å½“å‰æ–¹æ ¼æ¨ªå‘æˆ–çºµå‘ç§»åŠ¨åˆ°è¾¾ç›®æ ‡æ‰€ç»è¿‡çš„æ–¹æ ¼æ•°ï¼Œå¿½ç•¥å¯¹è§’ç§»åŠ¨ï¼Œç„¶åæŠŠæ€»æ•°ä¹˜ä»¥ 10 ã€‚ä¹‹æ‰€ä»¥å«åš Manhattan æ–¹æ³•ï¼Œæ˜¯å› ä¸ºè¿™å¾ˆåƒç»Ÿè®¡ä»ä¸€ä¸ªåœ°ç‚¹åˆ°å¦ä¸€ä¸ªåœ°ç‚¹æ‰€ç©¿è¿‡çš„è¡—åŒºæ•°ï¼Œè€Œä½ ä¸èƒ½æ–œå‘ç©¿è¿‡è¡—åŒºã€‚é‡è¦çš„æ˜¯ï¼Œè®¡ç®— H æ—¶ï¼Œè¦å¿½ç•¥è·¯å¾„ä¸­çš„éšœç¢ç‰©ã€‚è¿™æ˜¯å¯¹å‰©ä½™è·ç¦»çš„ä¼°ç®—å€¼ï¼Œè€Œä¸æ˜¯å®é™…å€¼ï¼Œå› æ­¤æ‰ç§°ä¸ºè¯•æ¢æ³•ã€‚ æŠŠ G å’Œ H ç›¸åŠ ä¾¿å¾—åˆ° F ã€‚æˆ‘ä»¬ç¬¬ä¸€æ­¥çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ¯ä¸ªæ–¹æ ¼éƒ½æ ‡ä¸Šäº† F ï¼Œ G ï¼Œ H çš„å€¼ï¼Œå°±åƒèµ·ç‚¹å³è¾¹çš„æ–¹æ ¼é‚£æ ·ï¼Œå·¦ä¸Šè§’æ˜¯ F ï¼Œå·¦ä¸‹è§’æ˜¯ G ï¼Œå³ä¸‹è§’æ˜¯ H ã€‚ å›¾ 3 å¥½ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å…¶ä¸­çš„ä¸€äº›æ–¹æ ¼ã€‚åœ¨æ ‡æœ‰å­—æ¯çš„æ–¹æ ¼ï¼Œ G = 10 ã€‚è¿™æ˜¯å› ä¸ºæ°´å¹³æ–¹å‘ä»èµ·ç‚¹åˆ°é‚£é‡Œåªæœ‰ä¸€ä¸ªæ–¹æ ¼çš„è·ç¦»ã€‚ä¸èµ·ç‚¹ç›´æ¥ç›¸é‚»çš„ä¸Šæ–¹ï¼Œä¸‹æ–¹ï¼Œå·¦æ–¹çš„æ–¹æ ¼çš„ G å€¼éƒ½æ˜¯ 10 ï¼Œå¯¹è§’çº¿çš„æ–¹æ ¼ G å€¼éƒ½æ˜¯ 14 ã€‚ H å€¼é€šè¿‡ä¼°ç®—èµ·ç‚¹äºç»ˆç‚¹ ( çº¢è‰²æ–¹æ ¼ ) çš„ Manhattan è·ç¦»å¾—åˆ°ï¼Œä»…ä½œæ¨ªå‘å’Œçºµå‘ç§»åŠ¨ï¼Œå¹¶ä¸”å¿½ç•¥æ²¿é€”çš„å¢™å£ã€‚ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œèµ·ç‚¹å³è¾¹çš„æ–¹æ ¼åˆ°ç»ˆç‚¹æœ‰ 3 ä¸ªæ–¹æ ¼çš„è·ç¦»ï¼Œå› æ­¤ H = 30 ã€‚è¿™ä¸ªæ–¹æ ¼ä¸Šæ–¹çš„æ–¹æ ¼åˆ°ç»ˆç‚¹æœ‰ 4 ä¸ªæ–¹æ ¼çš„è·ç¦» ( æ³¨æ„åªè®¡ç®—æ¨ªå‘å’Œçºµå‘è·ç¦» ) ï¼Œå› æ­¤ H = 40 ã€‚å¯¹äºå…¶ä»–çš„æ–¹æ ¼ï¼Œä½ å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•çŸ¥é“ H å€¼æ˜¯å¦‚ä½•å¾—æ¥çš„ã€‚ æ¯ä¸ªæ–¹æ ¼çš„ F å€¼ï¼Œå†è¯´ä¸€æ¬¡ï¼Œç›´æ¥æŠŠ G å€¼å’Œ H å€¼ç›¸åŠ å°±å¯ä»¥äº†ã€‚ ","date":"2023-07-15","objectID":"/posts/a_star/:4:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Planning"],"content":"4. ç»§ç»­æœç´¢(Continuing the Search) ä¸ºäº†ç»§ç»­æœç´¢ï¼Œæˆ‘ä»¬ä» open list ä¸­é€‰æ‹© F å€¼æœ€å°çš„ ( æ–¹æ ¼ ) èŠ‚ç‚¹ï¼Œç„¶åå¯¹æ‰€é€‰æ‹©çš„æ–¹æ ¼ä½œå¦‚ä¸‹æ“ä½œï¼š æŠŠå®ƒä» open list é‡Œå–å‡ºï¼Œæ”¾åˆ° close list ä¸­ã€‚ æ£€æŸ¥æ‰€æœ‰ä¸å®ƒç›¸é‚»çš„æ–¹æ ¼ï¼Œå¿½ç•¥å…¶ä¸­åœ¨ close list ä¸­æˆ–æ˜¯ä¸å¯èµ° (unwalkable) çš„æ–¹æ ¼ ( æ¯”å¦‚å¢™ï¼Œæ°´ï¼Œæˆ–æ˜¯å…¶ä»–éæ³•åœ°å½¢ ) ï¼Œå¦‚æœæ–¹æ ¼ä¸åœ¨open lsit ä¸­ï¼Œåˆ™æŠŠå®ƒä»¬åŠ å…¥åˆ° open list ä¸­ã€‚ æŠŠæˆ‘ä»¬é€‰å®šçš„æ–¹æ ¼è®¾ç½®ä¸ºè¿™äº›æ–°åŠ å…¥çš„æ–¹æ ¼çš„çˆ¶äº²ã€‚ å¦‚æœæŸä¸ªç›¸é‚»çš„æ–¹æ ¼å·²ç»åœ¨ open list ä¸­ï¼Œåˆ™æ£€æŸ¥è¿™æ¡è·¯å¾„æ˜¯å¦æ›´ä¼˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»ç”±å½“å‰æ–¹æ ¼ ( æˆ‘ä»¬é€‰ä¸­çš„æ–¹æ ¼ ) åˆ°è¾¾é‚£ä¸ªæ–¹æ ¼æ˜¯å¦å…·æœ‰æ›´å°çš„ G å€¼ã€‚å¦‚æœæ²¡æœ‰ï¼Œä¸åšä»»ä½•æ“ä½œã€‚ ç›¸åï¼Œå¦‚æœ G å€¼æ›´å°ï¼Œåˆ™æŠŠé‚£ä¸ªæ–¹æ ¼çš„çˆ¶äº²è®¾ä¸ºå½“å‰æ–¹æ ¼ ( æˆ‘ä»¬é€‰ä¸­çš„æ–¹æ ¼ ) ï¼Œç„¶åé‡æ–°è®¡ç®—é‚£ä¸ªæ–¹æ ¼çš„ F å€¼å’Œ G å€¼ã€‚å¦‚æœä½ è¿˜æ˜¯å¾ˆæ··æ·†ï¼Œè¯·å‚è€ƒä¸‹å›¾ã€‚ å›¾ 4 Ok ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚åœ¨æˆ‘ä»¬æœ€åˆçš„ 9 ä¸ªæ–¹æ ¼ä¸­ï¼Œè¿˜æœ‰ 8 ä¸ªåœ¨ open list ä¸­ï¼Œèµ·ç‚¹è¢«æ”¾å…¥äº† close list ä¸­ã€‚åœ¨è¿™äº›æ–¹æ ¼ä¸­ï¼Œèµ·ç‚¹å³è¾¹çš„æ ¼å­çš„ F å€¼ 40 æœ€å°ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©è¿™ä¸ªæ–¹æ ¼ä½œä¸ºä¸‹ä¸€ä¸ªè¦å¤„ç†çš„æ–¹æ ¼ã€‚å®ƒçš„å¤–æ¡†ç”¨è“çº¿æ‰“äº®ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠå®ƒä» open list ç§»åˆ° close list ä¸­ ( è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç”¨è“çº¿æ‰“äº®çš„åŸå› äº† ) ã€‚ç„¶åæˆ‘ä»¬æ£€æŸ¥ä¸å®ƒç›¸é‚»çš„æ–¹æ ¼ã€‚å®ƒå³è¾¹çš„æ–¹æ ¼æ˜¯å¢™å£ï¼Œæˆ‘ä»¬å¿½ç•¥ã€‚å®ƒå·¦è¾¹çš„æ–¹æ ¼æ˜¯èµ·ç‚¹ï¼Œåœ¨ close list ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¿½ç•¥ã€‚å…¶ä»– 4 ä¸ªç›¸é‚»çš„æ–¹æ ¼å‡åœ¨ open list ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥ç»ç”±è¿™ä¸ªæ–¹æ ¼åˆ°è¾¾é‚£é‡Œçš„è·¯å¾„æ˜¯å¦æ›´å¥½ï¼Œä½¿ç”¨ G å€¼æ¥åˆ¤å®šã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸Šé¢çš„æ–¹æ ¼ã€‚å®ƒç°åœ¨çš„ G å€¼ä¸º 14 ã€‚å¦‚æœæˆ‘ä»¬ç»ç”±å½“å‰æ–¹æ ¼åˆ°è¾¾é‚£é‡Œï¼Œ G å€¼å°†ä¼šä¸º 20(å…¶ä¸­ 10 ä¸ºåˆ°è¾¾å½“å‰æ–¹æ ¼çš„ G å€¼ï¼Œæ­¤å¤–è¿˜è¦åŠ ä¸Šä»å½“å‰æ–¹æ ¼çºµå‘ç§»åŠ¨åˆ°ä¸Šé¢æ–¹æ ¼çš„ G å€¼ 10) ã€‚æ˜¾ç„¶ 20 æ¯” 14 å¤§ï¼Œå› æ­¤è¿™ä¸æ˜¯æœ€ä¼˜çš„è·¯å¾„ã€‚å¦‚æœä½ çœ‹å›¾ä½ å°±ä¼šæ˜ç™½ã€‚ç›´æ¥ä»èµ·ç‚¹æ²¿å¯¹è§’çº¿ç§»åŠ¨åˆ°é‚£ä¸ªæ–¹æ ¼æ¯”å…ˆæ¨ªå‘ç§»åŠ¨å†çºµå‘ç§»åŠ¨è¦å¥½ã€‚ å½“æŠŠ 4 ä¸ªå·²ç»åœ¨ open list ä¸­çš„ç›¸é‚»æ–¹æ ¼éƒ½æ£€æŸ¥åï¼Œæ²¡æœ‰å‘ç°ç»ç”±å½“å‰æ–¹æ ¼çš„æ›´å¥½è·¯å¾„ï¼Œå› æ­¤æˆ‘ä»¬ä¸åšä»»ä½•æ”¹å˜ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»æ£€æŸ¥äº†å½“å‰æ–¹æ ¼çš„æ‰€æœ‰ç›¸é‚»çš„æ–¹æ ¼ï¼Œå¹¶ä¹Ÿå¯¹ä»–ä»¬ä½œäº†å¤„ç†ï¼Œæ˜¯æ—¶å€™é€‰æ‹©ä¸‹ä¸€ä¸ªå¾…å¤„ç†çš„æ–¹æ ¼äº†ã€‚ å› æ­¤å†æ¬¡éå†æˆ‘ä»¬çš„ open list ï¼Œç°åœ¨å®ƒåªæœ‰ 7 ä¸ªæ–¹æ ¼äº†ï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹© F å€¼æœ€å°çš„é‚£ä¸ªã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™æ¬¡æœ‰ä¸¤ä¸ªæ–¹æ ¼çš„ F å€¼éƒ½ 54 ï¼Œé€‰å“ªä¸ªå‘¢ï¼Ÿæ²¡ä»€ä¹ˆå…³ç³»ã€‚ä»é€Ÿåº¦ä¸Šè€ƒè™‘ï¼Œé€‰æ‹©æœ€ååŠ å…¥ open list çš„æ–¹æ ¼æ›´å¿«ã€‚è¿™å¯¼è‡´äº†åœ¨å¯»è·¯è¿‡ç¨‹ä¸­ï¼Œå½“é è¿‘ç›®æ ‡æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨æ–°æ‰¾åˆ°çš„æ–¹æ ¼çš„åå¥½ã€‚ä½†æ˜¯è¿™å¹¶ä¸é‡è¦ã€‚ ( å¯¹ç›¸åŒæ•°æ®çš„ä¸åŒå¯¹å¾…ï¼Œå¯¼è‡´ä¸¤ä¸­ç‰ˆæœ¬çš„ A* æ‰¾åˆ°ç­‰é•¿çš„ä¸åŒè·¯å¾„ ) ã€‚ æˆ‘ä»¬é€‰æ‹©èµ·ç‚¹å³ä¸‹æ–¹çš„æ–¹æ ¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å›¾ 5 è¿™æ¬¡ï¼Œå½“æˆ‘ä»¬æ£€æŸ¥ç›¸é‚»çš„æ–¹æ ¼æ—¶ï¼Œæˆ‘ä»¬å‘ç°å®ƒå³è¾¹çš„æ–¹æ ¼æ˜¯å¢™ï¼Œå¿½ç•¥ä¹‹ã€‚ä¸Šé¢çš„ä¹Ÿä¸€æ ·ã€‚ æˆ‘ä»¬æŠŠå¢™ä¸‹é¢çš„ä¸€æ ¼ä¹Ÿå¿½ç•¥æ‰ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå¦‚æœä¸ç©¿è¶Šå¢™è§’çš„è¯ï¼Œä½ ä¸èƒ½ç›´æ¥ä»å½“å‰æ–¹æ ¼ç§»åŠ¨åˆ°é‚£ä¸ªæ–¹æ ¼ã€‚ä½ éœ€è¦å…ˆå¾€ä¸‹èµ°ï¼Œç„¶åå†ç§»åŠ¨åˆ°é‚£ä¸ªæ–¹æ ¼ï¼Œè¿™æ ·æ¥ç»•è¿‡å¢™è§’ã€‚ ( æ³¨æ„ï¼šç©¿è¶Šå¢™è§’çš„è§„åˆ™æ˜¯å¯é€‰çš„ï¼Œä¾èµ–äºä½ çš„èŠ‚ç‚¹æ˜¯æ€ä¹ˆæ”¾ç½®çš„ ) è¿™æ ·è¿˜å‰©ä¸‹ 5 ä¸ªç›¸é‚»çš„æ–¹æ ¼ã€‚å½“å‰æ–¹æ ¼ä¸‹é¢çš„ 2 ä¸ªæ–¹æ ¼è¿˜æ²¡æœ‰åŠ å…¥ open list ï¼Œæ‰€ä»¥æŠŠå®ƒä»¬åŠ å…¥ï¼ŒåŒæ—¶æŠŠå½“å‰æ–¹æ ¼è®¾ä¸ºä»–ä»¬çš„çˆ¶äº²ã€‚åœ¨å‰©ä¸‹çš„3 ä¸ªæ–¹æ ¼ä¸­ï¼Œæœ‰ 2 ä¸ªå·²ç»åœ¨ close list ä¸­ ( ä¸€ä¸ªæ˜¯èµ·ç‚¹ï¼Œä¸€ä¸ªæ˜¯å½“å‰æ–¹æ ¼ä¸Šé¢çš„æ–¹æ ¼ï¼Œå¤–æ¡†è¢«åŠ äº®çš„ ) ï¼Œæˆ‘ä»¬å¿½ç•¥å®ƒä»¬ã€‚æœ€åä¸€ä¸ªæ–¹æ ¼ï¼Œä¹Ÿå°±æ˜¯å½“å‰æ–¹æ ¼å·¦è¾¹çš„æ–¹æ ¼ï¼Œæˆ‘ä»¬æ£€æŸ¥ç»ç”±å½“å‰æ–¹æ ¼åˆ°è¾¾é‚£é‡Œæ˜¯å¦å…·æœ‰æ›´å°çš„ G å€¼ã€‚æ²¡æœ‰ã€‚å› æ­¤æˆ‘ä»¬å‡†å¤‡ä» open list ä¸­é€‰æ‹©ä¸‹ä¸€ä¸ªå¾…å¤„ç†çš„æ–¹æ ¼ã€‚ ä¸æ–­é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æŠŠç»ˆç‚¹ä¹ŸåŠ å…¥åˆ°äº† open list ä¸­ï¼Œæ­¤æ—¶å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å›¾ 6 æ³¨æ„ï¼Œåœ¨èµ·ç‚¹ä¸‹é¢ 2 æ ¼çš„æ–¹æ ¼çš„çˆ¶äº²å·²ç»ä¸å‰é¢ä¸åŒäº†ã€‚ä¹‹å‰å®ƒçš„ G å€¼æ˜¯ 28 å¹¶ä¸”æŒ‡å‘å®ƒå³ä¸Šæ–¹çš„æ–¹æ ¼ã€‚ç°åœ¨å®ƒçš„ G å€¼ä¸º 20 ï¼Œå¹¶ä¸”æŒ‡å‘å®ƒæ­£ä¸Šæ–¹çš„æ–¹æ ¼ã€‚è¿™åœ¨å¯»è·¯è¿‡ç¨‹ä¸­çš„æŸå¤„å‘ç”Ÿï¼Œä½¿ç”¨æ–°è·¯å¾„æ—¶ G å€¼ç»è¿‡æ£€æŸ¥å¹¶ä¸”å˜å¾—æ›´ä½ï¼Œå› æ­¤çˆ¶èŠ‚ç‚¹è¢«é‡æ–°è®¾ç½®ï¼Œ G å’Œ F å€¼è¢«é‡æ–°è®¡ç®—ã€‚å°½ç®¡è¿™ä¸€å˜åŒ–åœ¨æœ¬ä¾‹ä¸­å¹¶ä¸é‡è¦ï¼Œä½†æ˜¯åœ¨å¾ˆå¤šåœºåˆä¸­ï¼Œè¿™ç§å˜åŒ–ä¼šå¯¼è‡´å¯»è·¯ç»“æœçš„å·¨å¤§å˜åŒ–ã€‚ é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ ·å»ç¡®å®šå®é™…è·¯å¾„å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œä»ç»ˆç‚¹å¼€å§‹ï¼ŒæŒ‰ç€ç®­å¤´å‘çˆ¶èŠ‚ç‚¹ç§»åŠ¨ï¼Œè¿™æ ·ä½ å°±è¢«å¸¦å›åˆ°äº†èµ·ç‚¹ï¼Œè¿™å°±æ˜¯ä½ çš„è·¯å¾„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä»èµ·ç‚¹ A ç§»åŠ¨åˆ°ç»ˆç‚¹ B å°±æ˜¯ç®€å•ä»è·¯å¾„ä¸Šçš„ä¸€ä¸ªæ–¹æ ¼çš„ä¸­å¿ƒç§»åŠ¨åˆ°å¦ä¸€ä¸ªæ–¹æ ¼çš„ä¸­å¿ƒï¼Œç›´è‡³ç›®æ ‡ã€‚å°±æ˜¯è¿™ä¹ˆç®€å•ï¼ å›¾ 7 ","date":"2023-07-15","objectID":"/posts/a_star/:5:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Planning"],"content":"5. A*ç®—æ³•æ€»ç»“(Summary of the A* Method) Ok ï¼Œç°åœ¨ä½ å·²ç»çœ‹å®Œäº†æ•´ä¸ªçš„ä»‹ç»ï¼Œç°åœ¨æˆ‘ä»¬æŠŠæ‰€æœ‰æ­¥éª¤æ”¾åœ¨ä¸€èµ·ï¼š æŠŠèµ·ç‚¹åŠ å…¥ open list ã€‚ é‡å¤å¦‚ä¸‹è¿‡ç¨‹ï¼š a. éå† open list ï¼ŒæŸ¥æ‰¾ F å€¼æœ€å°çš„èŠ‚ç‚¹ï¼ŒæŠŠå®ƒä½œä¸ºå½“å‰è¦å¤„ç†çš„èŠ‚ç‚¹ã€‚ b. æŠŠè¿™ä¸ªèŠ‚ç‚¹ç§»åˆ° close list ã€‚ c. å¯¹å½“å‰æ–¹æ ¼çš„ 8 ä¸ªç›¸é‚»æ–¹æ ¼çš„æ¯ä¸€ä¸ªæ–¹æ ¼æ‰§è¡Œå¦‚ä¸‹æ“ä½œ: å¦‚æœå®ƒæ˜¯ä¸å¯æŠµè¾¾çš„æˆ–è€…å®ƒåœ¨ close list ä¸­ï¼Œå¿½ç•¥å®ƒã€‚å¦åˆ™ï¼Œåšå¦‚ä¸‹æ“ä½œã€‚ å¦‚æœå®ƒä¸åœ¨ open list ä¸­ï¼ŒæŠŠå®ƒåŠ å…¥ open list ï¼Œå¹¶ä¸”æŠŠå½“å‰æ–¹æ ¼è®¾ç½®ä¸ºå®ƒçš„çˆ¶äº²ï¼Œè®°å½•è¯¥æ–¹æ ¼çš„ F ï¼Œ G å’Œ H å€¼ã€‚ å¦‚æœå®ƒå·²ç»åœ¨ open list ä¸­ï¼Œæ£€æŸ¥è¿™æ¡è·¯å¾„ ( å³ç»ç”±å½“å‰æ–¹æ ¼åˆ°è¾¾å®ƒé‚£é‡Œ ) æ˜¯å¦æ›´å¥½ï¼Œç”¨ G å€¼ä½œå‚è€ƒã€‚æ›´å°çš„ G å€¼è¡¨ç¤ºè¿™æ˜¯æ›´å¥½çš„è·¯å¾„ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼ŒæŠŠå®ƒçš„çˆ¶äº²è®¾ç½®ä¸ºå½“å‰æ–¹æ ¼ï¼Œå¹¶é‡æ–°è®¡ç®—å®ƒçš„ G å’Œ F å€¼ã€‚å¦‚æœä½ çš„ open list æ˜¯æŒ‰ F å€¼æ’åºçš„è¯ï¼Œæ”¹å˜åä½ å¯èƒ½éœ€è¦é‡æ–°æ’åºã€‚ d. åœæ­¢ï¼Œå½“ä½  æŠŠç»ˆç‚¹åŠ å…¥åˆ°äº† open list ä¸­ï¼Œæ­¤æ—¶è·¯å¾„å·²ç»æ‰¾åˆ°äº†ï¼Œæˆ–è€… æŸ¥æ‰¾ç»ˆç‚¹å¤±è´¥ï¼Œå¹¶ä¸” open list æ˜¯ç©ºçš„ï¼Œæ­¤æ—¶æ²¡æœ‰è·¯å¾„ã€‚ ä¿å­˜è·¯å¾„ã€‚ä»ç»ˆç‚¹å¼€å§‹ï¼Œæ¯ä¸ªæ–¹æ ¼æ²¿ç€çˆ¶èŠ‚ç‚¹ç§»åŠ¨ç›´è‡³èµ·ç‚¹ï¼Œè¿™å°±æ˜¯ä½ çš„è·¯å¾„ã€‚ ","date":"2023-07-15","objectID":"/posts/a_star/:6:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Planning"],"content":"6. é¢˜å¤–è¯(Small Rant) è¯·åŸè°…æˆ‘çš„ç¦»é¢˜ï¼Œå½“ä½ åœ¨ç½‘ä¸Šæˆ–è®ºå›ä¸Šçœ‹åˆ°å„ç§å…³äº A* ç®—æ³•çš„è®¨è®ºæ—¶ï¼Œä½ å¶å°”ä¼šå‘ç°ä¸€äº› A* çš„ä»£ç ï¼Œå®é™…ä¸Šä»–ä»¬ä¸æ˜¯ã€‚è¦ä½¿ç”¨ A* ï¼Œä½ å¿…é¡»åŒ…å«ä¸Šé¢è®¨è®ºçš„æ‰€æœ‰å…ƒç´  â€”- å°¤å…¶æ˜¯ open list ï¼Œ close list å’Œè·¯å¾„ä»£ä»· G ï¼Œ H å’Œ F ã€‚ä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–çš„å¯»è·¯ç®—æ³•ï¼Œè¿™äº›ç®—æ³•å¹¶ä¸æ˜¯ A* ç®—æ³•ï¼Œ A* è¢«è®¤ä¸ºæ˜¯æœ€å¥½çš„ã€‚åœ¨æœ¬æ–‡æœ«å°¾å¼•ç”¨çš„ä¸€äº›æ–‡ç« ä¸­ Bryan Stout è®¨è®ºäº†ä»–ä»¬çš„ä¸€éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ä»–ä»¬çš„ä¼˜ç¼ºç‚¹ã€‚åœ¨æŸäº›æ—¶å€™ä½ å¯ä»¥äºŒä¸­æ‹©ä¸€ï¼Œä½†ä½ å¿…é¡»æ˜ç™½è‡ªå·±åœ¨åšä»€ä¹ˆã€‚ Ok ï¼Œä¸åºŸè¯äº†ã€‚å›åˆ°æ–‡ç« ã€‚ ","date":"2023-07-15","objectID":"/posts/a_star/:7:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Planning"],"content":"7. å®ç°çš„æ³¨è§£(Notes on Implemetation) ç°åœ¨ä½ å·²ç»æ˜ç™½äº†åŸºæœ¬æ–¹æ³•ï¼Œè¿™é‡Œæ˜¯ä½ åœ¨å†™è‡ªå·±çš„ç¨‹åºæ˜¯éœ€è¦è€ƒè™‘çš„ä¸€äº›é¢å¤–çš„ä¸œè¥¿ã€‚ä¸‹é¢çš„ææ–™å¼•ç”¨äº†ä¸€äº›æˆ‘ç”¨ C++ å’Œ Basic å†™çš„ç¨‹åºï¼Œä½†æ˜¯å¯¹å…¶ä»–è¯­è¨€åŒæ ·æœ‰æ•ˆã€‚ ç»´æŠ¤ Open List ï¼šè¿™æ˜¯ A* ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚æ¯æ¬¡ä½ è®¿é—® Open list ï¼Œä½ éƒ½è¦æ‰¾å‡ºå…·æœ‰æœ€å° F å€¼çš„æ–¹æ ¼ã€‚æœ‰å‡ ç§åšæ³•å¯ä»¥åšåˆ°è¿™ä¸ªã€‚ä½ å¯ä»¥éšæ„ä¿å­˜è·¯å¾„å…ƒç´ ï¼Œå½“ä½ éœ€è¦æ‰¾åˆ°å…·æœ‰æœ€å° F å€¼çš„æ–¹æ ¼æ—¶ï¼Œéå†æ•´ä¸ª open list ã€‚è¿™ä¸ªå¾ˆç®€å•ï¼Œä½†å¯¹äºå¾ˆé•¿çš„è·¯å¾„ä¼šå¾ˆæ…¢ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥é€šè¿‡ç»´æŠ¤ä¸€ä¸ªæ’å¥½åºçš„è¡¨æ¥æ”¹è¿›ï¼Œæ¯æ¬¡å½“ä½ éœ€è¦æ‰¾åˆ°å…·æœ‰æœ€å° F å€¼çš„æ–¹æ ¼æ—¶ï¼Œä»…å–å‡ºè¡¨çš„ç¬¬ä¸€é¡¹å³å¯ã€‚æˆ‘å†™ç¨‹åºæ—¶ï¼Œè¿™æ˜¯æˆ‘ç”¨çš„ç¬¬ä¸€ä¸ªæ–¹æ³•ã€‚ å¯¹äºå°åœ°å›¾ï¼Œè¿™å¯ä»¥å¾ˆå¥½çš„å·¥ä½œï¼Œä½†è¿™ä¸æ˜¯æœ€å¿«çš„æ–¹æ¡ˆã€‚è¿½æ±‚é€Ÿåº¦çš„ A* ç¨‹åºå‘˜ä½¿ç”¨äº†å«åšäºŒå‰å †çš„ä¸œè¥¿ï¼Œæˆ‘çš„ç¨‹åºé‡Œä¹Ÿç”¨äº†è¿™ä¸ªã€‚ä»¥æˆ‘çš„ç»éªŒï¼Œè¿™ç§æ–¹æ³•åœ¨å¤šæ•°åœºåˆä¸‹ä¼šå¿« 2â€”3 å€ï¼Œå¯¹äºæ›´é•¿çš„è·¯å¾„é€Ÿåº¦æˆå‡ ä½•çº§æ•°å¢é•¿ (10 å€ç”šè‡³æ›´å¿« ) ã€‚å¦‚æœä½ æƒ³æ›´å¤šçš„äº†è§£äºŒå‰å †ï¼Œè¯·é˜…è¯»Using Binary Heaps in A* Pathfinding ã€‚ å…¶ä»–å•ä½ï¼šå¦‚æœä½ ç¢°å·§å¾ˆä»”ç»†çš„çœ‹äº†æˆ‘çš„ç¨‹åºï¼Œä½ ä¼šæ³¨æ„åˆ°æˆ‘å®Œå…¨å¿½ç•¥äº†å…¶ä»–å•ä½ã€‚æˆ‘çš„å¯»è·¯è€…å®é™…ä¸Šå¯ä»¥äº’ç›¸ç©¿è¶Šã€‚è¿™å–å†³äºæ¸¸æˆï¼Œä¹Ÿè®¸å¯ä»¥ï¼Œä¹Ÿè®¸ä¸å¯ä»¥ã€‚å¦‚æœä½ æƒ³è€ƒè™‘å…¶ä»–å•ä½ï¼Œå¹¶æƒ³ä½¿ä»–ä»¬ç§»åŠ¨æ—¶ç»•è¿‡å½¼æ­¤ï¼Œæˆ‘å»ºè®®ä½ çš„å¯»è·¯ç¨‹åºå¿½ç•¥å®ƒä»¬ï¼Œå†å†™ä¸€äº›æ–°çš„ç¨‹åºæ¥åˆ¤æ–­ä¸¤ä¸ªå•ä½æ˜¯å¦ä¼šå‘ç”Ÿç¢°æ’ã€‚å¦‚æœå‘ç”Ÿç¢°æ’ï¼Œä½ å¯ä»¥äº§ç”Ÿä¸€ä¸ªæ–°çš„è·¯å¾„ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨ä¸€äº›æ ‡å‡†çš„è¿åŠ¨æ³•åˆ™ï¼ˆæ¯”å¦‚æ°¸è¿œå‘å³ç§»åŠ¨ï¼Œç­‰ç­‰ï¼‰ç›´è‡³éšœç¢ç‰©ä¸åœ¨é€”ä¸­ï¼Œç„¶åäº§ç”Ÿä¸€ä¸ªæ–°çš„è·¯å¾„ã€‚ä¸ºä»€ä¹ˆåœ¨è®¡ç®—åˆå§‹è·¯å¾„æ˜¯ä¸åŒ…æ‹¬å…¶ä»–å•ä½å‘¢ï¼Ÿå› ä¸ºå…¶ä»–å•ä½æ˜¯å¯ä»¥åŠ¨çš„ï¼Œå½“ä½ åˆ°è¾¾çš„æ—¶å€™å®ƒä»¬å¯èƒ½ä¸åœ¨è‡ªå·±çš„ä½ç½®ä¸Šã€‚è¿™å¯ä»¥äº§ç”Ÿä¸€äº›æ€ªå¼‚çš„ç»“æœï¼Œä¸€ä¸ªå•ä½çªç„¶è½¬å‘æ¥é¿å…å’Œä¸€ä¸ªå·²ä¸å­˜åœ¨çš„å•ä½ç¢°æ’ï¼Œåœ¨å®ƒçš„è·¯å¾„è®¡ç®—å‡ºæ¥åå’Œç©¿è¶Šå®ƒè·¯å¾„çš„é‚£äº›å•ä½ç¢°æ’äº†ã€‚ åœ¨å¯»è·¯ä»£ç ä¸­å¿½ç•¥å…¶ä»–å•ä½ï¼Œæ„å‘³ç€ä½ å¿…é¡»å†™å¦ä¸€ä»½ä»£ç æ¥å¤„ç†ç¢°æ’ã€‚è¿™æ˜¯æ¸¸æˆçš„ç»†èŠ‚ï¼Œæ‰€ä»¥æˆ‘æŠŠè§£å†³æ–¹æ¡ˆç•™ç»™ä½ ã€‚æœ¬æ–‡æœ«å°¾å¼•ç”¨çš„ Bryan Stoutâ€™s çš„æ–‡ç« ä¸­çš„å‡ ç§è§£å†³æ–¹æ¡ˆéå¸¸å€¼å¾—äº†è§£ã€‚ ä¸€äº›é€Ÿåº¦æ–¹é¢çš„æç¤ºï¼šå¦‚æœä½ åœ¨å¼€å‘è‡ªå·±çš„ A* ç¨‹åºæˆ–è€…æ˜¯æ”¹ç¼–æˆ‘å†™çš„ç¨‹åºï¼Œæœ€åä½ ä¼šå‘ç°å¯»è·¯å ç”¨äº†å¤§é‡çš„ CPU æ—¶é—´ï¼Œå°¤å…¶æ˜¯å½“ä½ æœ‰ç›¸å½“å¤šçš„å¯»è·¯è€…å’Œä¸€å—å¾ˆå¤§çš„åœ°å›¾æ—¶ã€‚å¦‚æœä½ é˜…è¯»è¿‡ç½‘ä¸Šçš„èµ„æ–™ï¼Œä½ ä¼šå‘ç°å°±ç®—æ˜¯å¼€å‘æ˜Ÿé™…äº‰éœ¸ï¼Œå¸å›½æ—¶ä»£çš„ä¸“å®¶ä¹Ÿæ˜¯è¿™æ ·ã€‚å¦‚æœä½ å‘ç°äº‹æƒ…ç”±äºå¯»è·¯è€Œå˜æ…¢äº†ï¼Œè¿™é‡Œæœ‰äº›ä¸»æ„å¾ˆä¸é”™ï¼š â—† ä½¿ç”¨å°åœ°å›¾æˆ–è€…æ›´å°‘çš„å¯»è·¯è€…ã€‚ â—† åƒä¸‡ä¸è¦åŒæ—¶ç»™å¤šä¸ªå¯»è·¯è€…å¯»è·¯ã€‚å–è€Œä»£ä¹‹çš„æ˜¯æŠŠå®ƒä»¬æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œåˆ†æ•£åˆ°å‡ ä¸ªæ¸¸æˆå‘¨æœŸä¸­ã€‚å¦‚æœä½ çš„æ¸¸æˆä»¥æ¯ç§’ 40 å‘¨æœŸçš„é€Ÿåº¦è¿è¡Œï¼Œæ²¡äººèƒ½å¯Ÿè§‰åˆ°ã€‚ä½†æ˜¯å¦‚æœåŒæ—¶æœ‰å¤§é‡çš„å¯»è·¯è€…åœ¨å¯»è·¯çš„è¯ï¼Œä»–ä»¬ä¼šé©¬ä¸Šå°±å‘ç°æ¸¸æˆæ…¢ä¸‹æ¥äº†ã€‚ â—† è€ƒè™‘åœ¨åœ°å›¾ä¸­ä½¿ç”¨æ›´å¤§çš„æ–¹æ ¼ã€‚è¿™å‡å°‘äº†å¯»è·¯æ—¶éœ€è¦æœç´¢çš„æ–¹æ ¼æ•°é‡ã€‚å¦‚æœä½ æ˜¯æœ‰é›„å¿ƒçš„è¯ï¼Œä½ å¯ä»¥è®¾è®¡å¤šå¥—å¯»è·¯æ–¹æ¡ˆï¼Œæ ¹æ®è·¯å¾„çš„é•¿åº¦è€Œä½¿ç”¨åœ¨ä¸åŒåœºåˆã€‚è¿™ä¹Ÿæ˜¯ä¸“ä¸šäººå£«çš„åšæ³•ï¼Œå¯¹é•¿è·¯å¾„ä½¿ç”¨å¤§æ–¹æ ¼ï¼Œå½“ä½ æ¥è¿‘ç›®æ ‡æ—¶ä½¿ç”¨å°æ–¹æ ¼ã€‚å¦‚æœä½ å¯¹è¿™ä¸ªæœ‰å…´è¶£ï¼Œè¯·çœ‹ Two-Tiered A* Pathfinding ã€‚ â—† å¯¹äºå¾ˆé•¿çš„è·¯å¾„ï¼Œè€ƒè™‘ä½¿ç”¨è·¯å¾„ç‚¹ç³»ç»Ÿï¼Œæˆ–è€…å¯ä»¥é¢„å…ˆè®¡ç®—è·¯å¾„å¹¶åŠ å…¥æ¸¸æˆä¸­ã€‚ â—† é¢„å…ˆå¤„ç†ä½ çš„åœ°å›¾ï¼ŒæŒ‡å‡ºå“ªäº›åŒºåŸŸæ˜¯ä¸å¯åˆ°è¾¾çš„ã€‚è¿™äº›åŒºåŸŸç§°ä¸ºâ€œå­¤å²›â€ã€‚å®é™…ä¸Šï¼Œä»–ä»¬å¯ä»¥æ˜¯å²›å±¿ï¼Œæˆ–è€…æ˜¯è¢«å¢™å£ç­‰åŒ…å›´è€Œä¸å¯åˆ°è¾¾çš„ä»»æ„åŒºåŸŸã€‚ A* çš„ä¸‹é™æ˜¯ï¼Œä½ å‘Šè¯‰ä»–æœå¯»é€šå¾€å“ªäº›åŒºåŸŸçš„è·¯å¾„æ—¶ï¼Œä»–ä¼šæœç´¢æ•´ä¸ªåœ°å›¾ï¼Œç›´åˆ°æ‰€æœ‰å¯ä»¥æŠµè¾¾çš„æ–¹æ ¼éƒ½é€šè¿‡ open list æˆ– close list å¾—åˆ°äº†å¤„ç†ã€‚è¿™ä¼šæµªè´¹å¤§é‡çš„ CPU æ—¶é—´ã€‚è¿™å¯ä»¥é€šè¿‡é¢„å…ˆè®¾å®šä¸å¯åˆ°è¾¾çš„åŒºåŸŸæ¥è§£å†³ã€‚åœ¨æŸç§æ•°ç»„ä¸­è®°å½•è¿™äº›ä¿¡æ¯ï¼Œåœ¨å¯»è·¯å‰æ£€æŸ¥å®ƒã€‚åœ¨æˆ‘çš„ Blitz ç‰ˆç¨‹åºä¸­ï¼Œæˆ‘å†™äº†ä¸ªåœ°å›¾é¢„å¤„ç†ç¨‹åºæ¥å®Œæˆè¿™ä¸ªã€‚å®ƒå¯ä»¥æå‰è¯†åˆ«å¯»è·¯ç®—æ³•ä¼šå¿½ç•¥çš„æ­»è·¯å¾„ï¼Œè¿™åˆè¿›ä¸€æ­¥æé«˜äº†é€Ÿåº¦ã€‚ ä¸åŒçš„åœ°å½¢æŸè€—ï¼šåœ¨è¿™ä¸ªæ•™ç¨‹å’Œæˆ‘çš„ç¨‹åºä¸­ï¼Œåœ°å½¢åªæœ‰ 2 ç§ï¼šå¯æŠµè¾¾çš„å’Œä¸å¯æŠµè¾¾çš„ã€‚ä½†æ˜¯å¦‚æœä½ æœ‰äº›å¯æŠµè¾¾çš„åœ°å½¢ï¼Œç§»åŠ¨ä»£ä»·ä¼šæ›´é«˜äº›ï¼Œæ²¼æ³½ï¼Œå±±ä¸˜ï¼Œåœ°ç‰¢çš„æ¥¼æ¢¯ç­‰éƒ½æ˜¯å¯æŠµè¾¾çš„åœ°å½¢ï¼Œä½†æ˜¯ç§»åŠ¨ä»£ä»·æ¯”å¹³åœ°å°±è¦é«˜ã€‚ç±»ä¼¼çš„ï¼Œé“è·¯çš„ç§»åŠ¨ä»£ä»·å°±æ¯”å®ƒå‘¨å›´çš„åœ°å½¢ä½ã€‚ åœ¨ä½ è®¡ç®—ç»™å®šæ–¹æ ¼çš„ G å€¼æ—¶åŠ ä¸Šåœ°å½¢çš„ä»£ä»·å°±å¾ˆå®¹æ˜“è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ç®€å•çš„ç»™è¿™äº›æ–¹æ ¼åŠ ä¸Šä¸€äº›é¢å¤–çš„ä»£ä»·å°±å¯ä»¥äº†ã€‚ A* ç®—æ³•ç”¨æ¥æŸ¥æ‰¾ä»£ä»·æœ€ä½çš„è·¯å¾„ï¼Œåº”è¯¥å¾ˆå®¹æ˜“å¤„ç†è¿™äº›ã€‚åœ¨æˆ‘çš„ç®€å•ä¾‹å­ä¸­ï¼Œåœ°å½¢åªæœ‰å¯è¾¾å’Œä¸å¯è¾¾ä¸¤ç§ï¼Œ A* ä¼šæœå¯»æœ€çŸ­å’Œæœ€ç›´æ¥çš„è·¯å¾„ã€‚ä½†æ˜¯åœ¨æœ‰åœ°å½¢ä»£ä»·çš„ç¯å¢ƒä¸­ï¼Œä»£ä»·æœ€ä½çš„çš„è·¯å¾„å¯èƒ½ä¼šå¾ˆé•¿ã€‚ å°±åƒæ²¿ç€å…¬è·¯ç»•è¿‡æ²¼æ³½è€Œä¸æ˜¯ç›´æ¥ç©¿è¶Šå®ƒã€‚ å¦ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„æ˜¯ä¸“å®¶æ‰€è°“çš„â€œ influence Mapping â€ï¼Œå°±åƒä¸Šé¢æè¿°çš„å¯å˜æˆæœ¬åœ°å½¢ä¸€æ ·ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªé¢å¤–çš„è®¡åˆ†ç³»ç»Ÿï¼ŒæŠŠå®ƒåº”ç”¨åˆ°å¯»è·¯çš„ AI ä¸­ã€‚å‡è®¾ä½ æœ‰è¿™æ ·ä¸€å¼ åœ°å›¾ï¼Œåœ°å›¾ä¸Šæœ‰ä¸ªé€šé“ç©¿è¿‡å±±ä¸˜ï¼Œæœ‰å¤§æ‰¹çš„å¯»è·¯è€…è¦é€šè¿‡è¿™ä¸ªé€šé“ï¼Œç”µè„‘æ¯æ¬¡äº§ç”Ÿä¸€ä¸ªé€šè¿‡é‚£ä¸ªé€šé“çš„è·¯å¾„éƒ½ä¼šå˜å¾—å¾ˆæ‹¥æŒ¤ã€‚å¦‚æœéœ€è¦ï¼Œä½ å¯ä»¥äº§ç”Ÿä¸€ä¸ª influence map ï¼Œå®ƒæƒ©ç½šé‚£äº›ä¼šå‘ç”Ÿå¤§å± æ€çš„æ–¹æ ¼ã€‚è¿™ä¼šè®©ç”µè„‘é€‰æ‹©æ›´å®‰å…¨çš„è·¯å¾„ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©å®ƒé¿å…å› ä¸ºè·¯å¾„çŸ­ï¼ˆå½“ç„¶ä¹Ÿæ›´å±é™©ï¼‰è€ŒæŒç»­æŠŠé˜Ÿä¼æˆ–å¯»è·¯è€…é€å¾€æŸä¸€ç‰¹å®šè·¯å¾„ã€‚ ç»´æŠ¤æœªæ¢æµ‹çš„åŒºåŸŸï¼šä½ ç© PC æ¸¸æˆçš„æ—¶å€™æ˜¯å¦å‘ç°ç”µè„‘æ€»æ˜¯èƒ½ç²¾ç¡®çš„é€‰æ‹©è·¯å¾„ï¼Œç”šè‡³åœ°å›¾éƒ½æœªè¢«æ¢æµ‹ã€‚å¯¹äºæ¸¸æˆæ¥è¯´ï¼Œå¯»è·¯è¿‡äºç²¾ç¡®åè€Œä¸çœŸå®ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜å¾ˆå®¹æ˜“ä¿®æ­£ã€‚ç­”æ¡ˆå°±æ˜¯ä¸ºæ¯ä¸ªç©å®¶å’Œç”µè„‘ï¼ˆæ¯ä¸ªç©å®¶ï¼Œä¸æ˜¯æ¯ä¸ªå•ä½ â€” é‚£ä¼šæµªè´¹å¾ˆå¤šå†…å­˜ï¼‰åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ knownWalkability æ•°ç»„ã€‚æ¯ä¸ªæ•°ç»„åŒ…å«äº†ç©å®¶å·²ç»æ¢æµ‹çš„åŒºåŸŸçš„ä¿¡æ¯ï¼Œå’Œå‡è®¾æ˜¯å¯åˆ°è¾¾çš„å…¶ä»–åŒºåŸŸï¼Œç›´åˆ°è¢«è¯å®ã€‚ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå•ä½ä¼šåœ¨è·¯çš„æ­»ç«¯å¾˜å¾Šï¼Œå¹¶ä¼šåšå‡ºé”™è¯¯çš„é€‰æ‹©ï¼Œç›´åˆ°åœ¨å®ƒå‘¨å›´æ‰¾åˆ°äº†è·¯å¾„ã€‚åœ°å›¾ä¸€æ—¦è¢«æ¢æµ‹äº†ï¼Œå¯»è·¯åˆå‘å¹³å¸¸ä¸€æ ·å·¥ä½œã€‚ å¹³æ»‘è·¯å¾„ï¼š A* è‡ªåŠ¨ç»™ä½ èŠ±è´¹æœ€å°çš„ï¼Œæœ€çŸ­çš„è·¯å¾„ï¼Œä½†å®ƒä¸ä¼šè‡ªåŠ¨ç»™ä½ æœ€å¹³æ»‘çš„è·¯å¾„ã€‚çœ‹çœ‹æˆ‘ä»¬çš„ä¾‹å­æ‰€æ‰¾åˆ°çš„è·¯å¾„ï¼ˆå›¾ 7 ï¼‰ã€‚åœ¨è¿™æ¡è·¯å¾„ä¸Šï¼Œç¬¬ä¸€æ­¥åœ¨èµ·ç‚¹çš„å³ä¸‹æ–¹ï¼Œå¦‚æœç¬¬ä¸€æ­¥åœ¨èµ·ç‚¹çš„æ­£ä¸‹æ–¹æ˜¯ä¸æ˜¯è·¯å¾„ä¼šæ›´å¹³æ»‘å‘¢ï¼Ÿ æœ‰å‡ ä¸ªæ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨ä½ è®¡ç®—è·¯å¾„æ—¶ï¼Œä½ å¯ä»¥æƒ©ç½šé‚£äº›æ”¹å˜æ–¹å‘çš„æ–¹æ ¼ï¼ŒæŠŠå®ƒçš„ G å€¼å¢åŠ ä¸€ä¸ªé¢å¤–çš„å¼€é”€ã€‚å¦ä¸€ç§é€‰æ‹©æ˜¯ï¼Œä½ å¯ä»¥éå†ä½ ç”Ÿæˆçš„è·¯å¾„ï¼ŒæŸ¥æ‰¾é‚£äº›ç”¨ç›¸é‚»çš„æ–¹æ ¼æ›¿ä»£ä¼šä½¿è·¯å¾„æ›´å¹³æ»‘çš„åœ°æ–¹ã€‚è¦äº†è§£æ›´å¤šï¼Œè¯·çœ‹ Toward More Realistic Pathfinding ã€‚ éæ–¹å½¢æœç´¢åŒºåŸŸï¼šåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨éƒ½æ˜¯ 2D çš„æ–¹å½¢çš„åŒºåŸŸã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸è§„åˆ™çš„åŒºåŸŸã€‚æƒ³æƒ³å†’é™©æ¸¸æˆä¸­çš„é‚£äº›å›½å®¶ï¼Œä½ å¯ä»¥è®¾è®¡ä¸€ä¸ªåƒé‚£æ ·çš„å¯»è·¯å…³å¡ã€‚ä½ éœ€è¦å»ºç«‹ä¸€å¼ è¡¨æ ¼æ¥ä¿å­˜å›½å®¶ç›¸é‚»å…³ç³»ï¼Œä»¥åŠä»ä¸€ä¸ªå›½å®¶ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå›½å®¶çš„ G å€¼ã€‚ä½ è¿˜éœ€è¦ä¸€ä¸ªæ–¹æ³•äº†ä¼°ç®— H å€¼ã€‚å…¶ä»–çš„éƒ½å¯ä»¥å‘ä¸Šé¢çš„ä¾‹å­ä¸€æ ·å¤„ç†ã€‚å½“ä½ å‘ open list æ·»åŠ æ–°é¡¹æ—¶ï¼Œä¸æ˜¯ä½¿ç”¨ç›¸é‚»çš„æ–¹æ ¼ï¼Œè€Œæ˜¯æŸ¥çœ‹è¡¨é‡Œç›¸é‚»çš„å›½å®¶ã€‚ ç±»ä¼¼çš„ï¼Œä½ å¯ä»¥ä¸ºä¸€å¼ å›ºå®šåœ°å½¢çš„åœ°å›¾çš„è·¯å¾„å»ºç«‹è·¯å¾„ç‚¹ç³»ç»Ÿã€‚è·¯å¾„ç‚¹é€šå¸¸æ˜¯é“è·¯æˆ–åœ°ç‰¢é€šé“çš„è½¬æŠ˜ç‚¹ã€‚ä½œä¸ºæ¸¸æˆè®¾è®¡è€…ï¼Œä½ å¯ä»¥é¢„å…ˆè®¾å®šè·¯å¾„ç‚¹ã€‚å¦‚æœä¸¤ä¸ªè·¯å¾„ç‚¹çš„è¿çº¿æ²¡æœ‰éšœç¢ç‰©çš„è¯å®ƒä»¬è¢«è§†ä¸ºç›¸é‚»çš„ã€‚åœ¨å†’é™©æ¸¸æˆçš„ä¾‹å­ä¸­ï¼Œä½ å¯ä»¥ä¿å­˜è¿™äº›ç›¸é‚»ä¿¡æ¯åœ¨æŸç§è¡¨ä¸­ï¼Œå½“ open list å¢åŠ æ–°é¡¹æ—¶ä½¿ç”¨ã€‚ç„¶åè®°å½• G å€¼ï¼ˆå¯èƒ½ç”¨ä¸¤ä¸ªç»“ç‚¹é—´çš„ç›´çº¿è·ç¦»ï¼‰å’Œ H å€¼ï¼ˆå¯èƒ½ä½¿ç”¨ä»èŠ‚ç‚¹åˆ°ç›®æ ‡çš„ç›´çº¿è·ç¦»ï¼‰ã€‚å…¶å®ƒçš„éƒ½æƒ³å¾€å¸¸ä¸€æ ·å¤„ç†ã€‚ ","date":"2023-07-15","objectID":"/posts/a_star/:8:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Planning"],"content":"8. è¿›ä¸€æ­¥é˜…è¯»(Further Reading) Ok ï¼Œç°åœ¨ä½ å·²ç»å¯¹ A* æœ‰äº†ä¸ªåŸºæœ¬çš„äº†è§£ï¼ŒåŒæ—¶ä¹Ÿè®¤è¯†äº†ä¸€äº›é«˜çº§çš„ä¸»é¢˜ã€‚æˆ‘å¼ºçƒˆå»ºè®®ä½ çœ‹çœ‹æˆ‘çš„ä»£ç ï¼Œå‹ç¼©åŒ…é‡ŒåŒ…å«äº† 2 ä¸ªç‰ˆæœ¬çš„å®ç°ï¼Œä¸€ä¸ªæ˜¯ C++ ï¼Œå¦ä¸€ä¸ªæ˜¯ Blitz Basic ã€‚ 2 ä¸ªç‰ˆæœ¬éƒ½æœ‰æ³¨é‡Šï¼Œä½ ä»¥è¯¥å¯ä»¥å¾ˆå®¹æ˜“å°±çœ‹æ‡‚ã€‚ä¸‹é¢æ˜¯é“¾æ¥ï¼š Sample Code: A* Pathfinder (2D) Version 1.71 ã€‚ å¦‚æœä½ ä¸ä¼šä½¿ç”¨ C++ æˆ–æ˜¯ BlitzBasic ï¼Œåœ¨ C++ ç‰ˆæœ¬ä¸‹ä½ å¯ä»¥æ‰¾åˆ°ä¸¤ä¸ª exe æ–‡ä»¶ã€‚ BlitzBasic ç‰ˆæœ¬å¿…é¡»å»ç½‘ç«™ Blitz Basic ä¸‹è½½ BlitzBasic 3D çš„å…è´¹ Demo æ‰èƒ½è¿è¡Œã€‚ åœ¨è¿™é‡Œ here ä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ª Ben Oâ€™Neill çš„ A* åœ¨çº¿éªŒè¯å®ä¾‹ã€‚ ä½ åº”è¯¥é˜…è¯»ä¸‹é¢è¿™å‡ ä¸ªç«™ç‚¹çš„æ–‡ç« ã€‚åœ¨ä½ è¯»å®Œæœ¬æ•™ç¨‹åä½ å¯ä»¥æ›´å®¹æ˜“ç†è§£ä»–ä»¬ã€‚ Amitâ€™s A* Pages ï¼š Amit Patel çš„è¿™ç¯‡æ–‡ç« è¢«å¹¿æ³›å¼•ç”¨ï¼Œä½†æ˜¯å¦‚æœä½ æ²¡æœ‰é˜…è¯»æœ¬æ•™ç¨‹çš„è¯ï¼Œä½ å¯èƒ½ä¼šæ„Ÿåˆ°å¾ˆè¿·æƒ‘ã€‚å°¤å…¶æ˜¯ä½ å¯ä»¥çœ‹åˆ° Amit Patelè‡ªå·±çš„ä¸€äº›æƒ³æ³•ã€‚ Smart Moves: Intelligent Path Finding ï¼š Bryan Stout çš„è¿™ç¯‡éœ€è¦å» Gamasutra.com æ³¨å†Œæ‰èƒ½é˜…è¯»ã€‚ Bryan ç”¨ Delphi å†™çš„ç¨‹åºå¸®åŠ©æˆ‘å­¦ä¹ äº†A* ï¼ŒåŒæ—¶ç»™äº†æˆ‘ä¸€äº›æˆ‘çš„ç¨‹åºä¸­çš„ä¸€äº›çµæ„Ÿã€‚ä»–ä¹Ÿé˜è¿°äº† A* çš„å…¶ä»–é€‰æ‹©ã€‚ Terrain Analysis ï¼š Dave Pottinger ä¸€ç¯‡éå¸¸é«˜é˜¶çš„ï¼Œæœ‰å¸å¼•åŠ›çš„æ–‡ç« ã€‚ä»–æ˜¯ Ensemble Studios çš„ä¸€åä¸“å®¶ã€‚è¿™ä¸ªå®¶ä¼™è°ƒæ•´äº†æ¸¸æˆå¸å›½æ—¶ä»£å’Œç‹è€…æ—¶ä»£ã€‚ä¸è¦æœŸæœ›èƒ½å¤Ÿè¯»æ‡‚è¿™é‡Œçš„æ¯ä¸€æ ·ä¸œè¥¿ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ç¯‡èƒ½ç»™ä½ ä¸€äº›ä¸é”™çš„ä¸»æ„çš„å¾ˆæœ‰å¸å¼•åŠ›çš„æ–‡ç« ã€‚å®ƒè®¨è®ºäº†åŒ… mip-mapping ï¼Œ influence mapping ï¼Œå’Œå…¶ä»–é«˜é˜¶ AI å¯»è·¯ä¸»é¢˜ã€‚ä»–çš„ flood filling ç»™äº†æˆ‘åœ¨å¤„ç†æ­»è·¯å¾„ â€dead endsâ€ å’Œå­¤å²› â€islandâ€ æ—¶çš„çµæ„Ÿã€‚è¿™åŒ…å«åœ¨æˆ‘çš„ Blitzç‰ˆæœ¬çš„ç¨‹åºé‡Œã€‚ ","date":"2023-07-15","objectID":"/posts/a_star/:9:0","tags":["Planning"],"title":"A star (A*) ç®—æ³•","uri":"/posts/a_star/"},{"categories":["Distributed Computing"],"content":"TensorRT ä»‹ç» TensorRTæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„æ·±åº¦å­¦ä¹ æ¨ç†ï¼ˆInferenceï¼‰ä¼˜åŒ–å™¨ï¼Œå¯ä»¥ä¸ºæ·±åº¦å­¦ä¹ åº”ç”¨æä¾›ä½å»¶è¿Ÿã€é«˜ååç‡çš„éƒ¨ç½²æ¨ç†ã€‚TensorRTå¯ç”¨äºå¯¹è¶…å¤§è§„æ¨¡æ•°æ®ä¸­å¿ƒã€åµŒå…¥å¼å¹³å°æˆ–è‡ªåŠ¨é©¾é©¶å¹³å°è¿›è¡Œæ¨ç†åŠ é€Ÿã€‚TensorRTç°å·²èƒ½æ”¯æŒTensorFlowã€Caffeã€Mxnetã€Pytorchç­‰å‡ ä¹æ‰€æœ‰çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œå°†TensorRTå’ŒNVIDIAçš„GPUç»“åˆèµ·æ¥ï¼Œèƒ½åœ¨å‡ ä¹æ‰€æœ‰çš„æ¡†æ¶ä¸­è¿›è¡Œå¿«é€Ÿå’Œé«˜æ•ˆçš„éƒ¨ç½²æ¨ç†ã€‚ TensorRT æ˜¯ä¸€ä¸ªC++åº“ï¼Œä» TensorRT 3 å¼€å§‹æä¾›C++ APIå’ŒPython APIï¼Œä¸»è¦ç”¨æ¥é’ˆå¯¹ NVIDIA GPUè¿›è¡Œ é«˜æ€§èƒ½æ¨ç†ï¼ˆInferenceï¼‰åŠ é€Ÿã€‚ ç”±ä»¥ä¸Šå›¾å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹å‡ºï¼Œè®­ç»ƒ(training)å’Œ æ¨ç†(inference)çš„åŒºåˆ«ï¼š **è®­ç»ƒ(training)**åŒ…å«äº†å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ä¸¤ä¸ªé˜¶æ®µï¼Œé’ˆå¯¹çš„æ˜¯è®­ç»ƒé›†ã€‚è®­ç»ƒæ—¶é€šè¿‡è¯¯å·®åå‘ä¼ æ’­æ¥ä¸æ–­ä¿®æ”¹ç½‘ç»œæƒå€¼(weights)ã€‚ **æ¨ç†(inference)**åªåŒ…å«å‰å‘ä¼ æ’­ä¸€ä¸ªé˜¶æ®µï¼Œé’ˆå¯¹çš„æ˜¯é™¤äº†è®­ç»ƒé›†ä¹‹å¤–çš„æ–°æ•°æ®ã€‚å¯ä»¥æ˜¯æµ‹è¯•é›†ï¼Œä½†ä¸å®Œå…¨æ˜¯ï¼Œæ›´å¤šçš„æ˜¯æ•´ä¸ªæ•°æ®é›†ä¹‹å¤–çš„æ•°æ®ã€‚å…¶å®å°±æ˜¯é’ˆå¯¹æ–°æ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œé¢„æµ‹æ—¶ï¼Œé€Ÿåº¦æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„å› ç´ ã€‚ ä¸€èˆ¬çš„æ·±åº¦å­¦ä¹ é¡¹ç›®ï¼Œè®­ç»ƒæ—¶ä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼Œä¼šä½¿ç”¨å¤šGPUåˆ†å¸ƒå¼è®­ç»ƒã€‚ä½†åœ¨éƒ¨ç½²æ¨ç†æ—¶ï¼Œä¸ºäº†é™ä½æˆæœ¬ï¼Œå¾€å¾€ä½¿ç”¨å•ä¸ªGPUæœºå™¨ç”šè‡³åµŒå…¥å¼å¹³å°ï¼ˆæ¯”å¦‚ NVIDIA Jetsonï¼‰è¿›è¡Œéƒ¨ç½²ï¼Œéƒ¨ç½²ç«¯ä¹Ÿè¦æœ‰ä¸è®­ç»ƒæ—¶ç›¸åŒçš„æ·±åº¦å­¦ä¹ ç¯å¢ƒï¼Œå¦‚caffeï¼ŒTensorFlowç­‰ã€‚ ç”±äºè®­ç»ƒçš„ç½‘ç»œæ¨¡å‹å¯èƒ½ä¼šå¾ˆå¤§ï¼ˆæ¯”å¦‚ï¼Œinceptionï¼Œresnetç­‰ï¼‰ï¼Œå‚æ•°å¾ˆå¤šï¼Œè€Œä¸”éƒ¨ç½²ç«¯çš„æœºå™¨æ€§èƒ½å­˜åœ¨å·®å¼‚ï¼Œå°±ä¼šå¯¼è‡´æ¨ç†é€Ÿåº¦æ…¢ï¼Œå»¶è¿Ÿé«˜ã€‚è¿™å¯¹äºé‚£äº›é«˜å®æ—¶æ€§çš„åº”ç”¨åœºåˆæ˜¯è‡´å‘½çš„ï¼Œæ¯”å¦‚è‡ªåŠ¨é©¾é©¶è¦æ±‚å®æ—¶ç›®æ ‡æ£€æµ‹ï¼Œç›®æ ‡è¿½è¸ªç­‰ã€‚æ‰€ä»¥ä¸ºäº†æé«˜éƒ¨ç½²æ¨ç†çš„é€Ÿåº¦ï¼Œå‡ºç°äº†å¾ˆå¤šè½»é‡çº§ç¥ç»ç½‘ç»œï¼Œæ¯”å¦‚squeezenetï¼Œmobilenetï¼Œshufflenetç­‰ã€‚åŸºæœ¬åšæ³•éƒ½æ˜¯åŸºäºç°æœ‰çš„ç»å…¸æ¨¡å‹æå‡ºä¸€ç§æ–°çš„æ¨¡å‹ç»“æ„ï¼Œç„¶åç”¨è¿™äº›æ”¹é€ è¿‡çš„æ¨¡å‹é‡æ–°è®­ç»ƒï¼Œå†é‡æ–°éƒ¨ç½²ã€‚ è€ŒtensorRT åˆ™æ˜¯å¯¹è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œä¼˜åŒ–ã€‚ tensorRTå°±åªæ˜¯ æ¨ç†ä¼˜åŒ–å™¨ã€‚å½“ä½ çš„ç½‘ç»œè®­ç»ƒå®Œä¹‹åï¼Œå¯ä»¥å°†è®­ç»ƒæ¨¡å‹æ–‡ä»¶ç›´æ¥ä¸¢è¿›tensorRTä¸­ï¼Œè€Œä¸å†éœ€è¦ä¾èµ–æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆCaffeï¼ŒTensorFlowç­‰ï¼‰ï¼Œå¦‚ä¸‹: å¯ä»¥è®¤ä¸ºtensorRTæ˜¯ä¸€ä¸ªåªæœ‰å‰å‘ä¼ æ’­çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œè¿™ä¸ªæ¡†æ¶å¯ä»¥å°† Caffeï¼ŒTensorFlowçš„ç½‘ç»œæ¨¡å‹è§£æï¼Œç„¶åä¸tensorRTä¸­å¯¹åº”çš„å±‚è¿›è¡Œä¸€ä¸€æ˜ å°„ï¼ŒæŠŠå…¶ä»–æ¡†æ¶çš„æ¨¡å‹ç»Ÿä¸€å…¨éƒ¨ è½¬æ¢åˆ°tensorRTä¸­ï¼Œç„¶ååœ¨tensorRTä¸­å¯ä»¥é’ˆå¯¹NVIDIAè‡ªå®¶GPUå®æ–½ä¼˜åŒ–ç­–ç•¥ï¼Œå¹¶è¿›è¡Œéƒ¨ç½²åŠ é€Ÿã€‚ ç›®å‰TensorRT8.0 å‡ ä¹å¯ä»¥æ”¯æŒæ‰€æœ‰å¸¸ç”¨çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œå¯¹äºcaffeå’ŒTensorFlowæ¥è¯´ï¼ŒtensorRTå¯ä»¥ç›´æ¥è§£æä»–ä»¬çš„ç½‘ç»œæ¨¡å‹ï¼›å¯¹äºcaffe2ï¼Œpytorchï¼Œmxnetï¼Œchainerï¼ŒCNTKç­‰æ¡†æ¶åˆ™æ˜¯é¦–å…ˆè¦å°†æ¨¡å‹è½¬ä¸º ONNX çš„é€šç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œç„¶åå¯¹ONNXæ¨¡å‹åšè§£æã€‚è€Œtensorflowå’ŒMATLABå·²ç»å°†TensorRTé›†æˆåˆ°æ¡†æ¶ä¸­å»äº†ã€‚ **ONNX(Open Neural Network Exchange)**æ˜¯å¾®è½¯å’ŒFacebookæºæ‰‹å¼€å‘çš„å¼€æ”¾å¼ç¥ç»ç½‘ç»œäº¤æ¢å·¥å…·ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ç”¨ä»€ä¹ˆæ¡†æ¶è®­ç»ƒï¼Œåªè¦è½¬æ¢ä¸ºONNXæ¨¡å‹ï¼Œå°±å¯ä»¥æ”¾åœ¨å…¶ä»–æ¡†æ¶ä¸Šé¢å»inferenceã€‚è¿™æ˜¯ä¸€ç§ç»Ÿä¸€çš„ç¥ç»ç½‘ç»œæ¨¡å‹å®šä¹‰å’Œä¿å­˜æ–¹å¼ï¼Œä¸Šé¢æåˆ°çš„é™¤äº†tensorflowä¹‹å¤–çš„å…¶ä»–æ¡†æ¶å®˜æ–¹åº”è¯¥éƒ½å¯¹onnxåšäº†æ”¯æŒï¼Œè€ŒONNXè‡ªå·±å¼€å‘äº†å¯¹tensorflowçš„æ”¯æŒã€‚ä»æ·±åº¦å­¦ä¹ æ¡†æ¶æ–¹é¢æ¥è¯´ï¼Œè¿™æ˜¯å„å¤§å‚å•†å¯¹æŠ—è°·æ­Œtensorflowå„æ–­åœ°ä½çš„ä¸€ç§æœ‰æ•ˆæ–¹å¼ï¼›ä»ç ”ç©¶äººå‘˜å’Œå¼€å‘è€…æ–¹é¢æ¥è¯´ï¼Œè¿™å¯ä»¥ä½¿å¼€å‘è€…è½»æ˜“åœ°åœ¨ä¸åŒæœºå™¨å­¦ä¹ å·¥å…·ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œå¹¶ä¸ºé¡¹ç›®é€‰æ‹©æœ€å¥½çš„ç»„åˆæ–¹å¼ï¼ŒåŠ å¿«ä»ç ”ç©¶åˆ°ç”Ÿäº§çš„é€Ÿåº¦ã€‚ ONNX / TensorFlow / Custom deep-learning frameæ¨¡å‹çš„å·¥ä½œæ–¹å¼ï¼š tensorRTä¸­æœ‰ä¸€ä¸ª Plugin å±‚ï¼Œè¿™ä¸ªå±‚æä¾›äº† API å¯ä»¥ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰tensorRTä¸æ”¯æŒçš„å±‚ã€‚ TensorRT-plugin ç›®å‰TensorRTæ”¯æŒçš„å±‚æœ‰:https://github.com/onnx/onnx-tensorrt/blob/main/docs/operators.md ç›®å‰ONNXæ”¯æŒçš„ç®—å­:https://github.com/onnx/onnx/blob/main/docs/Operators.md ","date":"2023-07-14","objectID":"/posts/tensorrt_introduction/:0:1","tags":["TensorRT"],"title":"TensorRT Introduction","uri":"/posts/tensorrt_introduction/"},{"categories":["Distributed Computing"],"content":"TensorRT ä¼˜åŒ–æ–¹å¼ TensorRTä¼˜åŒ–æ–¹æ³•ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼Œæœ€ä¸»è¦çš„æ˜¯å‰é¢ä¸¤ç§ã€‚ å±‚é—´èåˆæˆ–å¼ é‡èåˆ(Layer \u0026 Tensor Fusion) å¦‚ä¸‹å›¾å·¦ä¾§æ˜¯GoogLeNetInceptionæ¨¡å—çš„è®¡ç®—å›¾ã€‚è¿™ä¸ªç»“æ„ä¸­æœ‰å¾ˆå¤šå±‚ï¼Œåœ¨éƒ¨ç½²æ¨¡å‹æ¨ç†æ—¶ï¼Œè¿™æ¯ä¸€å±‚çš„è¿ç®—æ“ä½œéƒ½æ˜¯ç”±GPUå®Œæˆçš„ï¼Œä½†å®é™…ä¸Šæ˜¯GPUé€šè¿‡å¯åŠ¨ä¸åŒçš„CUDAï¼ˆCompute unified device architectureï¼‰æ ¸å¿ƒæ¥å®Œæˆè®¡ç®—çš„ï¼ŒCUDAæ ¸å¿ƒè®¡ç®—å¼ é‡çš„é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œä½†æ˜¯å¾€å¾€å¤§é‡çš„æ—¶é—´æ˜¯æµªè´¹åœ¨CUDAæ ¸å¿ƒçš„å¯åŠ¨å’Œå¯¹æ¯ä¸€å±‚è¾“å…¥/è¾“å‡ºå¼ é‡çš„è¯»å†™æ“ä½œä¸Šé¢ï¼Œè¿™é€ æˆäº†å†…å­˜å¸¦å®½çš„ç“¶é¢ˆå’ŒGPUèµ„æºçš„æµªè´¹ã€‚TensorRTé€šè¿‡å¯¹å±‚é—´çš„æ¨ªå‘æˆ–çºµå‘åˆå¹¶ï¼ˆåˆå¹¶åçš„ç»“æ„ç§°ä¸ºCBRï¼Œæ„æŒ‡ convolution, bias, and ReLU layers are fused to form a single layerï¼‰ï¼Œä½¿å¾—å±‚çš„æ•°é‡å¤§å¤§å‡å°‘ã€‚æ¨ªå‘åˆå¹¶å¯ä»¥æŠŠå·ç§¯ã€åç½®å’Œæ¿€æ´»å±‚åˆå¹¶æˆä¸€ä¸ªCBRç»“æ„ï¼Œåªå ç”¨ä¸€ä¸ªCUDAæ ¸å¿ƒã€‚çºµå‘åˆå¹¶å¯ä»¥æŠŠç»“æ„ç›¸åŒï¼Œä½†æ˜¯æƒå€¼ä¸åŒçš„å±‚åˆå¹¶æˆä¸€ä¸ªæ›´å®½çš„å±‚ï¼Œä¹Ÿåªå ç”¨ä¸€ä¸ªCUDAæ ¸å¿ƒã€‚åˆå¹¶ä¹‹åçš„è®¡ç®—å›¾ï¼ˆå›¾4å³ä¾§ï¼‰çš„å±‚æ¬¡æ›´å°‘äº†ï¼Œå ç”¨çš„CUDAæ ¸å¿ƒæ•°ä¹Ÿå°‘äº†ï¼Œå› æ­¤æ•´ä¸ªæ¨¡å‹ç»“æ„ä¼šæ›´å°ï¼Œæ›´å¿«ï¼Œæ›´é«˜æ•ˆã€‚ æ•°æ®ç²¾åº¦æ ¡å‡†(Weight \u0026Activation Precision Calibration) å¤§éƒ¨åˆ†æ·±åº¦å­¦ä¹ æ¡†æ¶åœ¨è®­ç»ƒç¥ç»ç½‘ç»œæ—¶ç½‘ç»œä¸­çš„å¼ é‡ï¼ˆTensorï¼‰éƒ½æ˜¯32ä½æµ®ç‚¹æ•°çš„ç²¾åº¦ï¼ˆFull 32-bit precisionï¼ŒFP32ï¼‰ï¼Œä¸€æ—¦ç½‘ç»œè®­ç»ƒå®Œæˆï¼Œåœ¨éƒ¨ç½²æ¨ç†çš„è¿‡ç¨‹ä¸­ç”±äºä¸éœ€è¦åå‘ä¼ æ’­ï¼Œå®Œå…¨å¯ä»¥é€‚å½“é™ä½æ•°æ®ç²¾åº¦ï¼Œæ¯”å¦‚é™ä¸ºFP16æˆ–INT8çš„ç²¾åº¦ã€‚æ›´ä½çš„æ•°æ®ç²¾åº¦å°†ä¼šä½¿å¾—å†…å­˜å ç”¨å’Œå»¶è¿Ÿæ›´ä½ï¼Œæ¨¡å‹ä½“ç§¯æ›´å°ã€‚ Precision Dynamic Range FP32 âˆ’3.4Ã—1038 ~ 3.4Ã—1038 FP16 âˆ’65504 ~ 65504 INT8 âˆ’128 ~ 127 UINT8 0 ~ 256 INT8åªæœ‰256ä¸ªä¸åŒçš„æ•°å€¼ï¼Œä½¿ç”¨INT8æ¥è¡¨ç¤º FP32ç²¾åº¦çš„æ•°å€¼ï¼Œè‚¯å®šä¼šä¸¢å¤±ä¿¡æ¯ï¼Œé€ æˆæ€§èƒ½ä¸‹é™ã€‚ä¸è¿‡TensorRTä¼šæä¾›å®Œå…¨è‡ªåŠ¨åŒ–çš„æ ¡å‡†ï¼ˆCalibration ï¼‰è¿‡ç¨‹ï¼Œä¼šä»¥æœ€å¥½çš„åŒ¹é…æ€§èƒ½å°†FP32ç²¾åº¦çš„æ•°æ®é™ä½ä¸ºINT8ç²¾åº¦ï¼Œæœ€å°åŒ–æ€§èƒ½æŸå¤±ã€‚ Kernel Auto-Tuning ç½‘ç»œæ¨¡å‹åœ¨æ¨ç†è®¡ç®—æ—¶ï¼Œæ˜¯è°ƒç”¨GPUçš„CUDAæ ¸è¿›è¡Œè®¡ç®—çš„ã€‚TensorRTå¯ä»¥é’ˆå¯¹ä¸åŒçš„ç®—æ³•ï¼Œä¸åŒçš„ç½‘ç»œæ¨¡å‹ï¼Œä¸åŒçš„GPUå¹³å°ï¼Œè¿›è¡Œ CUDAæ ¸çš„è°ƒæ•´ï¼ˆæ€ä¹ˆè°ƒæ•´çš„è¿˜ä¸æ¸…æ¥šï¼‰ï¼Œä»¥ä¿è¯å½“å‰æ¨¡å‹åœ¨ç‰¹å®šå¹³å°ä¸Šä»¥æœ€ä¼˜æ€§èƒ½è®¡ç®—ã€‚ TensorRT will pick the implementation from a library of kernels that delivers the best performance for the target GPU, input data size, filter size, tensor layout, batch size and other parameters. Dynamic Tensor Memory åœ¨æ¯ä¸ªtensorçš„ä½¿ç”¨æœŸé—´ï¼ŒTensorRTä¼šä¸ºå…¶æŒ‡å®šæ˜¾å­˜ï¼Œé¿å…æ˜¾å­˜é‡å¤ç”³è¯·ï¼Œå‡å°‘å†…å­˜å ç”¨å’Œæé«˜é‡å¤ä½¿ç”¨æ•ˆç‡ã€‚ Multi-Stream Execution Scalable design to process multiple input streams in parallelï¼Œè¿™ä¸ªåº”è¯¥å°±æ˜¯GPUåº•å±‚çš„ä¼˜åŒ–äº†ã€‚ ","date":"2023-07-14","objectID":"/posts/tensorrt_introduction/:0:2","tags":["TensorRT"],"title":"TensorRT Introduction","uri":"/posts/tensorrt_introduction/"},{"categories":["Distributed Computing"],"content":"TensorRT å®‰è£… CUDAçš„å®‰è£… å®‰è£…æ˜¾å¡é©±åŠ¨ å®‰è£…cuda 2.1 è¿›å…¥nvidiaå¼€å‘è€…ç½‘ç«™çš„CUDAä¸‹è½½é¡µé¢é€‰æ‹©runfileæ ¼å¼çš„æ–‡ä»¶ä¸‹è½½ã€‚ 2.2 ä¸‹è½½å®Œæˆåï¼Œè§£å‹ï¼Œå¹¶è¿è¡Œä¸Šå›¾ä¸­çš„å‘½ä»¤ï¼Œä¼šæœ‰æ¡æ¬¾ï¼Œæ¥å—å³å¯ï¼Œæ³¨æ„å®‰è£…CUDAçš„æ—¶å€™ä¸è¦å®‰è£…é©±åŠ¨ 2.3 è·¯å¾„è®¾ç½® $ export PATH=/usr/local/cuda-10.2/bin:/usr/local/cuda-10.2/nsight-compute-2019.5.0${PATH:+:${PATH}} $ export LD_LIBRARY_PATH=/usr/local/cuda-10.2/lib64/${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}} å¹¶ä½¿è®¾ç½®ç”Ÿæ•ˆ: source ~/.bashrc 2.4 éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ è¿›å…¥/usr/local/cuda-10.1/samples/1_Utilities/ç›®å½•ï¼Œ cd deviceQuery sudo make ./deviceQuery å‡ºç°å¦‚ä¸‹è¾“å‡ºï¼Œåˆ™CUDAå®‰è£…æˆåŠŸã€‚ å®‰è£…cuDNN 3.1è¿›å…¥cudnnä¸‹è½½é¡µé¢ï¼Œä¸‹è½½ç‰ˆæœ¬åˆé€‚çš„ç‰ˆ 3.2 è§£å‹ï¼Œå¹¶è¿›å…¥åˆ°ç›¸åº”ç›®å½•ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š sudo cp cuda/include/cudnn*.h /usr/local/cuda-10.2/include sudo cp cuda/lib64/libcudnn* /usr/local/cuda-10.2/lib64 sudo chmod a+r /usr/local/cuda-10.2/include/cudnn*.h sudo chmod a+r /usr/local/cuda-10.2/lib64/libcudnn* 3.3 æŸ¥çœ‹cudnnç‰ˆæœ¬ cat /usr/local/cuda-10.2/include/cudnn.h | grep CUDNN_MAJOR -A 2 æ–°ç‰ˆæœ¬: cat /usr/local/cuda-10.2/include/cudnn_version.h | grep CUDNN_MAJOR -A 2 ref: https://blog.csdn.net/weixin_43592742/article/details/115689886?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-0\u0026spm=1001.2101.3001.4242 TensorRTçš„å®‰è£… è‹±ä¼Ÿè¾¾æä¾›çš„å®‰è£…æŒ‡å¯¼ tensorRT è¦åŒ¹é…cudaå’Œcudnnç‰ˆæœ¬ã€‚åœ¨å®‰è£…ä¹‹å‰è¯·åŒ¹é…ã€‚ OSS å’Œ GA ä¸¤ä¸ªç‰ˆæœ¬: TensorRT OSS: git clone -b master https://github.com/nvidia/TensorRT TensorRT cd TensorRT git submodule update --init --recursive GA ç‰ˆæœ¬(ä¸‹è½½åœ°å€) å¯¹GAç‰ˆæœ¬å’ŒOSSç‰ˆæœ¬åœ¨~/.bashrcæ–‡ä»¶ä¸­å£°æ˜è·¯å¾„: (GA: General Availability Stable Version) (OSS: OPEN SOURCE) [ossç‰ˆæœ¬è·¯å¾„]export TRT_SOURCE=/home/yejian/TensorRT/TensorRT_7.2.1 [GA Release ç‰ˆæœ¬è·¯å¾„]export TRT_RELEASE=/home/yejian/TensorRT/TensorRT_7.2.1/TensorRT-7.2.1.6/TensorRT-7.2.1.6 æµ‹è¯•ç¡®ä¿å®‰è£…æˆåŠŸ cd /home/yejian/TensorRT/TensorRT-8.6.1.6/samples/sampleOnnxMNIST make ../../bin ./sample_onnx_mnist Build TensorRT RSS (è¿™ä¸€æ­¥éœ€è¦åœ¨ç¼–å†™è‡ªå®šä¹‰ç®—å­çš„æ—¶å€™ç¼–è¯‘é€šè¿‡ï¼Œæ‰èƒ½è°ƒç”¨è‡ªå®šä¹‰ç®—å­) cd $TRT_OSSPATH mkdir -p build \u0026\u0026 cd build cmake .. -DTRT_LIB_DIR=$TRT_LIBPATH -DTRT_OUT_DIR=`pwd`/out make -j$(nproc) ref: https://blog.csdn.net/Msjiangmei/article/details/132585145 ","date":"2023-07-14","objectID":"/posts/tensorrt_introduction/:0:3","tags":["TensorRT"],"title":"TensorRT Introduction","uri":"/posts/tensorrt_introduction/"},{"categories":["Distributed Computing"],"content":"è‡ªå®šä¹‰ç®—å­å¼€å‘ â€“ ScatterElements åœ¨è‡ªå®šä¹‰ç®—å­å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ’°å†™ä¸€ä¸‹4ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠæ–‡ä»¶æ”¾åœ¨scatterElementsPluginæ–‡ä»¶å¤¹ä¸­: CmakeLists.txt scatterElements.cu scatterElementsPlugin.cpp scatterElementsPlugin.h å¦‚å›¾æ‰€ç¤º: è‡ªå®šä¹‰ç®—å­çš„ç”Ÿæˆä¸æ³¨å†Œ å°†ä»¥ä¸Šå››ä¸ªæ–‡ä»¶æŠ¥æ‹¬æ–‡ä»¶å¤¹å¤åˆ¶åˆ°TensorRT(OOS)ä¸‹çš„pluginæ–‡ä»¶å¤¹ä¸‹; ç„¶åä¿®æ”¹æ³¨å†Œä¿¡æ¯æ–‡ä»¶:(è¿™äº›æ–‡ä»¶ä¹Ÿåœ¨pluginæ–‡ä»¶å¤¹ä¸‹) ${TRT_SOURCE}/plugin: CMakeLists.txt ${TRT_SOURCE}/InferPlugin.cpp ${TRT_SOURCE}/common/kernels/kernel.h ${TRT_SOURCE}/parsers/onnx/builtin_op_importers.cpp æ‰§è¡Œå®Œä»¥ä¸Šæ­¥éª¤ä»¥åï¼Œé‡æ–°ç¼–è¯‘OOSç‰ˆæœ¬ï¼Œç„¶åå°±å¯ä»¥è°ƒç”¨è‡ªå®šä¹‰ç®—å­: cd $TRT_OSSPATH mkdir -p build \u0026\u0026 cd build cmake .. -DTRT_LIB_DIR=$TRT_LIBPATH -DTRT_OUT_DIR=`pwd`/out make -j$(nproc) ","date":"2023-07-14","objectID":"/posts/tensorrt_introduction/:1:0","tags":["TensorRT"],"title":"TensorRT Introduction","uri":"/posts/tensorrt_introduction/"},{"categories":["RL"],"content":" quote note abstract info tip success question warning failure danger bug example quote https://zhuanlan.zhihu.com/p/337976595 DRL:DQN, PG, AC, DDPG, SACæ¦‚è¿° ","date":"2023-07-14","objectID":"/posts/dpg/:0:0","tags":["draft"],"title":"DPG","uri":"/posts/dpg/"},{"categories":["RL"],"content":"1. å¼•è¨€ â€‹ é¦–å…ˆåœ¨è®ºæ–‡çš„å¼•è¨€éƒ¨åˆ†ç»™å‡ºäº†ç»å…¸çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„ä¸è¶³ä¹‹å¤„:è®¸å¤šçš„ç»å…¸å¼ºåŒ–å­¦ä¹ ç®—æ³•åœ¨å¤§å‹çš„æ¨¡å‹ã€æ•°æ®é‡‡æ ·æ•ˆç‡ã€é²æ£’æ€§(æ— éœ€æ‰‹åŠ¨è¶…å‚è°ƒæ•´)ä¸Šéƒ½æœ‰å¾ˆå¤§çš„æå‡ç©ºé—´ã€‚Q-Learningç®—æ³•(åŒ…æ‹¬å‡½æ•°é€¼è¿‘ç±»ç®—æ³•)åœ¨è®¸å¤šç®€å•é—®é¢˜ä¸Šåº”ç”¨å­˜åœ¨å±€é™æ€§,ä¾‹å¦‚è¦æ»¡è¶³çŠ¶æ€ç©ºé—´ä¸åŠ¨ä½œç©ºé—´çš„ç¦»æ•£å‹è¦æ±‚ï¼Œå¹¶ä¸”å…¶ç†è§£èµ·æ¥ä¹Ÿæ˜¯ä¸€ä»¶å¾ˆå›°éš¾çš„äº‹æƒ…ã€è€Œvanilla policy gradientç®—æ³•çš„æ•°æ®æ•ˆç‡ä¸é²æ£’æ€§è¾ƒå·®ã€ç½®ä¿¡åŸŸä¼˜åŒ–ç®—æ³•(TRPO)ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå¤æ‚ï¼Œè€Œä¸”å¯¹äºåŒ…å«å™ªå£°æˆ–å‚æ•°å…±äº«(åœ¨ç­–ç•¥å‡½æ•°ä¸ä»·å€¼å‡½æ•°ä¹‹é—´æœ‰å…¶ä»–çš„è¾…åŠ©ä»»åŠ¡éœ€æ±‚)çš„ç½‘ç»œç»“æ„ä¸å…¼å®¹(æ¯”å¦‚dropout)ã€‚ â€‹ è¯¥è®ºæ–‡çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œåœ¨TRPOçš„åŸºç¡€ä¸Šè¿ç”¨ä¸€é˜¶ä¼˜åŒ–æé«˜å…¶æ•°æ®çš„ä½¿ç”¨æ•ˆç‡ä¸è‰¯å¥½çš„è¡¨ç°ã€‚åˆ›æ–°çš„ä½¿ç”¨äº†ä¸€ç§å¯¹ç›®æ ‡å‡½æ•°ä½¿ç”¨é™å¹…æ¦‚ç‡æ¯”(clipped probabilty ratios)çš„æ–¹æ³•ï¼Œå¯¹åŸæœ‰ç­–ç•¥çš„è¡¨ç°åšå‡ºæ‚²è§‚ä¸»ä¹‰çš„ä¼°è®¡(ä¸ªäººç†è§£è¿™é‡Œæ˜¯å¯¹åŸæœ‰ç­–ç•¥ç›®æ ‡å‡½æ•° $J(\\theta)$ çš„ä¸‹ç•Œåšå‡ºä¼°è®¡)ã€‚ä¸ºäº†ä¼˜åŒ–ç­–ç•¥ $\\pi_{\\theta}$,æˆ‘ä»¬äº¤æ›¿ä»ç­–ç•¥ä¸­é‡‡æ ·æ•°æ®ï¼Œå¹¶å¯¹é‡‡æ ·æ•°æ®æ‰§è¡Œå‡ ä¸ªä¼˜åŒ–é˜¶æ®µã€‚ â€‹å®éªŒæ¯”è¾ƒäº†å¥½å‡ ä¸ªä»£ç†è€…ç®—æ³•ï¼Œå‘ç°å…¶ä¸­é‡‡ç”¨é™å¹…æ¦‚ç‡æ¯”(clipped probabilty ratios)çš„æ–¹æ³•è¡¨ç°æ•ˆæœæœ€ä½³ã€‚ç›¸æ¯”äºä¹‹å‰çš„ä¸€äº›å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼ŒPPOåœ¨è¿ç»­æ§åˆ¶é—®é¢˜ä¸Šæ¯”ä¹‹å‰çš„ç®—æ³•æ•ˆæœéƒ½è¦å¥½ã€‚åœ¨Atariæ¸¸æˆä¸­ï¼Œå…¶è¡¨ç°è¦æ˜¾è‘—å¼ºäºA2Cå’ŒACERç®—æ³•ï¼Œå› ä¸ºå…¶æ˜¯æ›´åŠ ç®€å•çš„(ä»ç­–ç•¥çš„é‡‡æ ·å¤æ‚åº¦çš„è§’åº¦ä¸Šæ¥è¯´)ã€‚ ","date":"2023-07-14","objectID":"/posts/ppo/:1:0","tags":["PPO"],"title":"å¼ºåŒ–å­¦ä¹  | PPO è®ºæ–‡è§£è¯»","uri":"/posts/ppo/"},{"categories":["RL"],"content":"2. èƒŒæ™¯ ","date":"2023-07-14","objectID":"/posts/ppo/:2:0","tags":["PPO"],"title":"å¼ºåŒ–å­¦ä¹  | PPO è®ºæ–‡è§£è¯»","uri":"/posts/ppo/"},{"categories":["RL"],"content":"2.1 ç­–ç•¥æ¢¯åº¦æ–¹æ³•(Policy Gradient Methods) ç­–ç•¥æ¢¯åº¦æ–¹æ³•ä¸»è¦é€šè¿‡è®¡ç®—ä¸€ä¸ª $estimator s(\\hat{g})$, å¹¶ä¸”å°†å…¶ç”¨äºéšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ä¸­å®ç°ç­–ç•¥çš„æ¢¯åº¦ä¸Šå‡åŠŸèƒ½ $(\\theta\\leftarrow\\theta+\\alpha\\hat{g})$ã€‚æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§estimatorå¦‚ä¸‹æ‰€ç¤º: $$\\hat{g}=\\hat{E}t\\left[\\nabla\\theta\\log\\pi_\\theta\\left(a_t\\left|s_t\\right.\\right)\\hat{A}_t\\right]$$ å…¶ä¸­ $\\pi_{\\theta}$ â€‹æ˜¯éšæœºç­–ç•¥å‡½æ•°ï¼Œ$\\hat{A_t}$ æ˜¯åœ¨ç¬¬ $t$ä¸ªæ­¥é•¿æ—¶çš„ä¼˜åŠ¿å‡½æ•° $A(s_t,a_t)$ çš„ä¼°è®¡å€¼ã€‚ ç”±ä¹‹å‰çš„çŸ¥è¯†æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™é‡Œçš„ $\\hat{ A_t}$ å¦‚æœæ˜¯ç”¨MonteCarloæ–¹æ³•æ¥ä¼°è®¡å³: $\\hat{A_t} = G_t-v_{\\omega}(s_t)$ ï¼Œä¾¿æ˜¯Reinforce with baseline æ–¹æ³•ã€‚å¦‚æœé‡‡ç”¨ $\\hat{A_t} = Q_{\\pi_{\\theta}}(s_t,a_t)-v_{\\omega}(s_t)$ æ¥ä¼°è®¡ï¼Œä¾¿æ˜¯A2Cæ–¹æ³•ã€‚ å…¶ä¸­: $\\hat E_t[â€¦]$è¡¨æ˜é‡‡ç”¨åœ¨ä¸€ç¾¤é‡‡æ ·çš„æ ·æœ¬ä¹‹é—´é‡‡ç”¨ç»éªŒå¹³å‡å€¼æ¥ä¼°è®¡ï¼Œå³: $\\hat{E_t[â€¦]}=\\frac{1}{n}\\sum_{t=1}^n[â€¦]$ã€‚ç”±äºå¯ä»¥ç”¨å¸¦ç”¨è‡ªåŠ¨æ¢¯åº¦è®¡ç®—çš„è½¯ä»¶å¯¹ $\\hat{g}$ è¿›è¡Œè®¡ç®—ï¼Œå› æ­¤ $\\hat{g}$ å¯ä»¥è§†ä¸ºå¯¹ä»¥ä¸‹ç›®æ ‡è¿›è¡Œæ¢¯åº¦è®¡ç®— $\\nabla_{\\theta}$: $$L^{PG}(\\theta)=\\hat{E}t\\left[\\log\\pi\\theta\\left(a_t\\left|s_t\\right.\\right)\\hat{A}_t\\right]$$ â€‹ å°½ç®¡ä¸Šå¼åœ¨ç”¨å¤šä¸ªè½¨è¿¹(trajectory)å¯¹è¯¯å·® $L^{PG}(\\theta)$ è¿›è¡Œå¤šæ­¥çš„å‚æ•°æ›´æ–°ä¼˜åŒ–æ—¶æœ‰ä¸€å®šçš„ä¼˜åŠ¿ã€‚ä½†æ˜¯è¿™ä¹ˆåšç†ç”±å¹¶ä¸å……åˆ†(åŸè¯æ˜¯doing so is not well-justifiedæˆ‘ä¸çŸ¥é“æ€ä¹ˆç¿»è¯‘æ¯”è¾ƒåˆé€‚)ï¼Œå¹¶ä¸”è¿™å¸¸å¸¸ä¼šå¯¼è‡´ä¸€ä¸ªæ¯ç­æ€§çš„æå¤§èŒƒå›´çš„ç­–ç•¥å‚æ•° $\\theta$ çš„æ›´æ–°é—®é¢˜(ä¸ªäººè®¤ä¸ºè¿™é‡Œæƒ³å¼ºè°ƒçš„æ˜¯å­¦ä¹ ç‡$\\alpha$ ä¸å¥½è°ƒï¼Œå®¹æ˜“é€ æˆå‚æ•°çš„ä¼°è®¡å‡ºç°é—®é¢˜)ã€‚ ","date":"2023-07-14","objectID":"/posts/ppo/:2:1","tags":["PPO"],"title":"å¼ºåŒ–å­¦ä¹  | PPO è®ºæ–‡è§£è¯»","uri":"/posts/ppo/"},{"categories":["RL"],"content":"2.2 ç½®ä¿¡åŸŸæ–¹æ³• åœ¨TRPOç®—æ³•ä¸­ï¼Œç›®æ ‡å‡½æ•°(æˆ–è€…ç§°ä¸ºä»£ç†å‡½æ•°)æ˜¯ä¸€ä¸ªè¢«è¦æ±‚æœ€å¤§åŒ–çš„ç›®æ ‡å‡½æ•°ï¼Œå…¶è¢«çº¦æŸåœ¨ä¸€ç³»åˆ—çš„ç­–ç•¥æ›´æ–°çš„çº¦æŸä¸‹ã€‚å…·ä½“è€Œè¨€è¯¥ä¼˜åŒ–é—®é¢˜å¯ä»¥æè¿°å¦‚ä¸‹: $$\\max_\\theta\\hat{E}t\\left[\\frac{\\pi\\theta\\left(a_t\\left|s_t\\right.\\right)}{\\pi_{\\theta_{old}}\\left(a_t\\left|s_t\\right.\\right)}\\hat{A}t\\right]\\s.t.\\hat{E}t\\left[KL[\\pi{\\theta{old}}\\left(.|s_t\\right),\\pi_\\theta\\left(.|s_t\\right)]\\right]\\leq\\delta $$ â€‹ å…¶ä¸­ï¼Œ$\\theta_{old}$ æ˜¯åœ¨ç­–ç•¥å‡½æ•° $\\pi$ æ›´æ–°ä¹‹å‰çš„ $\\theta$ï¼Œæ˜¯ä¸ªå‘é‡ã€‚è¯¥çº¦æŸé—®é¢˜å¯ä»¥åœ¨å¯¹ç›®æ ‡åœ¨ $\\theta_{old}$ â€‹è¿›è¡Œä¸€é˜¶è¿‘ä¼¼(æ³°å‹’ä¸€é˜¶å±•å¼€)ï¼Œåœ¨çº¦æŸå¤„å¯¹ $\\theta_{old}$ â€‹è¿›è¡ŒäºŒé˜¶è¿‘ä¼¼(æ³°å‹’äºŒé˜¶å±•å¼€)å¦‚ä¸‹åï¼Œåˆ©ç”¨å…±è½­æ¢¯åº¦æ³•æ±‚è§£ã€‚ $$\\max_\\theta g(\\theta_{old})(\\theta-\\theta_{old})\\s.t.\\frac12(\\theta-\\theta_{old})^TF(\\theta_{old})(\\theta-\\theta_{old})\\leq\\delta $$ å…¶ä¸­ï¼Œ $F(\\theta)=E_{s_{t} ,a_{t}\\sim\\pi_{\\theta}} [\\nabla_{\\theta} \\operatorname{log}\\pi(a_{t} |s_{t} ;\\theta)[\\nabla_{\\theta} \\operatorname{log}\\pi(a_{t} |s_{t} ;\\theta)]^{T}]$ï¼Œè€Œ $g\\left(\\theta\\right)=\\nabla_{\\theta}E_{\\pi(\\theta_{old})}[\\frac{\\pi_\\theta\\left(a_t\\mid s_t\\right)}{\\pi_{\\theta_{old}\\left(a_t\\mid s_t\\right)}}\\hat{A}_{t}]$ äº‹å®ä¸Šï¼Œä¸Šè¿°çš„ç½®ä¿¡åŸŸä¼˜åŒ–é—®é¢˜çš„æ±‚è§£ä¸€èˆ¬å»ºè®®é‡‡ç”¨ç½šå‡½æ•°æ³•æ±‚è§£ï¼Œè€Œå¹¶ä¸æ˜¯åˆ©ç”¨å¸¦çº¦æŸä¼˜åŒ–é—®é¢˜çš„å¸¸è§„å¥—è·¯æ±‚è§£ã€‚å°†ä¸Šè¿°å¸¦çº¦æŸçš„ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºå¦‚ä¸‹çš„æ— çº¦æŸä¼˜åŒ–é—®é¢˜ï¼š $$\\max_\\theta\\hat{E}t\\left[\\frac{\\pi\\theta\\left(a_t\\left|s_t\\right.\\right)}{\\pi_{\\theta_{old}\\left(a_t\\left|s_t\\right.\\right)}}\\hat{A}t-\\beta KL[\\pi{\\theta_{old}}\\left(.|s_t\\right),\\pi_\\theta\\left(.|s_t\\right)]\\right]$$ â€‹å¯¹äºå…¶ä¸­çš„ $\\beta$ ä¸ºç½šç³»æ•°ã€‚äº‹å®ä¸Šä¸Šå¼ä¸­å¯¹äº $KL$ æ•£åº¦å®é™…ä½¿ç”¨æ—¶ï¼Œç”¨æœ€å¤§æ•£åº¦æ›¿ä»£å¹³å‡æ•£åº¦å®ç°çº¦æŸæ•ˆæœã€‚è€ŒTRPOç®—æ³•ä½¿ç”¨æ—¶ä¸€èˆ¬ç”¨ç¡¬çº¦æŸè€Œéç½šå‡½æ•°ï¼Œè¿™æ˜¯å› ä¸ºé€‰æ‹© $\\beta$ æ—¶ï¼Œä¸åŒçš„ $\\beta$ çš„é€‰æ‹©ä¼šäº§ç”Ÿè®¸å¤šä¸åŒçš„é—®é¢˜ã€‚å› æ­¤ä¸ºäº†å®ç°æˆ‘ä»¬ä¸€é˜¶ä¼˜åŒ–ç®—æ³•çš„ç›®æ ‡ï¼Œé€‰æ‹©ä¸€ä¸ªå›ºå®šçš„æƒ©ç½šç³»æ•° $\\beta$ ç”¨SGDä¼˜åŒ–ä¸Šé¢çš„ç½šæ–¹ç¨‹æ˜¯ä¸ç°å®çš„(è¿™é‡Œä¸»è¦å¼ºè°ƒçš„æ˜¯è°ƒè¶…å‚ $\\beta$ çš„é—®é¢˜)ã€‚ 3.å‰ªè£ä»£ç†ç›®æ ‡(Clipped Surrogate Objective) è®¾$r_t\\left(\\theta\\right)=\\frac{\\pi_\\theta\\left(a_t\\left|s_t\\right.\\right)}{\\pi_{\\theta_{old}}\\left(a_t\\left|s_t\\right.\\right)}$ã€‚TRPOç®—æ³•æœ€å¤§åŒ–ä¸€ä¸ªä»£ç†ç›®æ ‡å‡½æ•°å¦‚ä¸‹: $$L^{CPI}(\\theta)=\\hat{E}t\\left[\\frac{\\pi\\theta\\left(a_t\\left|s_t\\right.\\right)}{\\pi_{\\theta_{old}}\\left(a_t\\left|s_t\\right.\\right)}\\hat{A}_t\\right]=\\hat{E}_t\\left[r_t\\left(\\theta\\right)\\hat{A}_t\\right]$$ â€‹å…¶ä¸­CPIæŒ‡çš„æ˜¯ä¿å®ˆç­–ç•¥è¿­ä»£(conservative policy iteration)ã€‚å¦‚æœæ²¡æœ‰KLæ•£åº¦çš„çº¦æŸï¼Œæœ€å¤§åŒ– $L^{CPI}(\\theta)$ å°†å¯¼è‡´ä¸€ä¸ªå¤§çš„ç­–ç•¥å‚æ•°çš„è¿‡ä¼°è®¡ã€‚å› æ­¤æˆ‘ä»¬è€ƒè™‘ä¿®æ­£è¿™ä¸ªç›®æ ‡ï¼Œå»æƒ©ç½šæ¯”ç‡$r_t(\\theta)$è¿œç¦»1æ—¶çš„æƒ…å†µã€‚ æˆ‘ä»¬ä¸»è¦è€ƒè™‘å¦‚ä¸‹æ‰€ç¤ºçš„æœ€å¤§åŒ–ç›®æ ‡å‡½æ•°: $$L^{CLIP}(\\theta)=\\hat{E}_t\\left[\\min(r_t\\left(\\theta\\right)\\hat{A}_t,\\mathbf{clip}(r_t\\left(\\theta\\right),1-\\varepsilon,1+\\varepsilon)\\hat{A}_t)\\right]$$ â€‹è€Œå…¶ä¸­ $\\varepsilon$ æ˜¯ä¸€ä¸ªå¾…è°ƒçš„è¶…å‚ï¼Œä¸€èˆ¬å¯ä»¥è®¾ä¸º \\varepsilon = 0.2$ï¼Œä¸Šå¼çš„ç¬¬ä¸€ä¸ªæœ€å°é¡¹æ˜¯ $L^{CPI}(\\theta)$ã€‚ç¬¬äºŒä¸ªæœ€å°é¡¹æ˜¯ $\\mathbf{clip}(r_t(\\theta),1-\\varepsilon,1+\\varepsilon)\\hat{A_t})$ï¼Œé€šè¿‡åˆ‡ç‰‡æ¯”ç‡ä¿®æ­£äº†ä»£ç†å‡½æ•°: $$\\left.\\mathbf{clip}(r_t\\left(\\theta\\right),1-\\varepsilon,1+\\varepsilon)=\\left{\\begin{array}{l}1-\\varepsilon,r_t\\left(\\theta\\right)\\leq1-\\varepsilon\\r_t\\left(\\theta\\right)\\quad,1-\\varepsilon\\leq r_t\\left(\\theta\\right)\\leq1+\\varepsilon\\1+\\varepsilon,r_t\\left(\\theta\\right)\\geq1+\\varepsilon\\end{array}\\right.\\right.$$ å½“ $\\hat {A_t}$ â€‹å–ä¸åŒçš„ç¬¦å·æ—¶ï¼Œå…¶ $L^{CLIP}(\\theta)$ å’Œ $r$ çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤º: BP Network ä¸ªäººç†è§£:å½“ $\\hat A_t\\geq 0$æ—¶ï¼Œä¸ºäº†è¾¾åˆ°ç›®æ ‡ $\\max L^{CLIP}(\\theta)$ï¼Œé™åˆ¶ $r_t(\\theta)$ åªåœ¨å°äº $1+\\varepsilon$ æ—¶æœ‰å¢å¤§è¶‹åŠ¿ã€‚è€Œå½“ $r_t(\\theta)$ è¿‡å¤§å³ $r_t(\\theta)\\geq 1+\\varepsilon$ æ—¶ï¼Œé™åˆ¶å…¶ $L^{CLIP}(\\theta)$ çš„ç»§ç»­å¢å¤§ã€‚è¿™æ ·å¯¹äºé‚£äº›ä½¿å¾— $r_t(\\theta)$è¿‡å¤§çš„ $\\theta$ , å…¶ç›®æ ‡å‡½æ•° $L^{CLIP}(\\theta)$ ä¸ä¼šæ›´å¤§ï¼Œä¹Ÿå°±ä¸åœ¨$ \\theta$ çš„æœç´¢çš„è€ƒè™‘èŒƒå›´ä¹‹å†…ã€‚å› æ­¤é‡‡ç”¨æœç´¢ç®—æ³•æœç´¢ $\\theta$ æ—¶ä¸å®¹æ˜“æœç´¢åˆ°ä½¿å¾— $r_t(\\theta)$ è¿‡å¤§çš„ $\\theta$ã€‚è¾¾åˆ°åœ¨å°½å¯èƒ½ç½®ä¿¡åŸŸå†…æœç´¢$\\theta$çš„æ•ˆæœã€‚å½“$\\hat{A_t}\\leq0$æ—¶ï¼ŒåŒç†ä¾ç„¶å¦‚æ­¤ã€‚ å¯¹æ¯”ä¸åŒæ–¹æ³•åœ¨è¿ç»­æ§åˆ¶é—®é¢˜ä¸­çš„è°ƒæ•´å‚æ•° $\\theta$ å¯¹æ•£åº¦ $KL(\\theta,\\theta_{old})$ çš„å½±å“æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º: BP Network è¯¥å›¾å¯ä»¥çœ‹å‡ºåœ¨åˆå§‹å‚æ•° $\\theta_{old}$ çš„ä¸€æ¬¡PPOç®—æ³•è¿­ä»£ä¹‹åï¼Œ$KL(\\pi_{\\theta},\\pi_{\\theta_{old}})$ å‡ ä¹æœ€å¤§å€¼æ‰æ˜¯0.02ã€‚è¿™å……åˆ†ä¿ä½äº†$\\theta$ åœ¨ $\\theta_{old}$ çš„ç½®ä¿¡åŸŸä¹‹å†…ã€‚è¯¥å›¾æ¥è‡ªäº Hopper-v1é—®é¢˜ï¼Œè¶…å‚æ•°å¦‚ä¸‹: BP Network ","date":"2023-07-14","objectID":"/posts/ppo/:2:2","tags":["PPO"],"title":"å¼ºåŒ–å­¦ä¹  | PPO è®ºæ–‡è§£è¯»","uri":"/posts/ppo/"},{"categories":["RL"],"content":"4.è‡ªé€‚åº”ç½šå‡½æ•°ç³»æ•°æ–¹æ³• å‰é¢è®²åˆ°é‡‡ç”¨ç½šå‡½æ•°æ³•è¿›è¡Œå‚æ•°æ›´æ–°æ—¶ï¼Œä¸»è¦æ˜¯ç½šå‡½æ•°ç³»æ•° $\\beta$ çš„é€‰å–æ¯”è¾ƒå›°éš¾ã€‚è€Œç°åœ¨ä¸€ç§å…‹æœæ–¹æ³•æ˜¯è‡ªé€‚åº”è°ƒæ•´ç³»æ•° $\\beta$ã€‚ å…¶ä¼˜åŒ–ç›®æ ‡å¦‚ä¸‹: $$\\max L^{KLPEN}(\\theta)=\\hat{E_t}\\left[\\frac{\\pi_\\theta\\left(a_t\\left|s_t\\right.\\right)}{\\pi_{\\theta_{old}\\left(a_t\\left|s_t\\right.\\right)}}\\hat{A}t-\\beta KL[\\pi{\\theta_{old}}\\left(.|s_t\\right),\\pi_\\theta\\left(.|s_t\\right)]\\right]$$ â€‹è®¡ç®— $d=\\hat{E}{t}\\left[KL[\\pi{\\theta_{old}}\\left(.|s_{t}\\right),\\pi_{\\theta}\\left(.|s_{t}\\right)]\\right]$, å½“$d\\leq\\frac{d_{targ}}{1.5},\\beta\\leftarrow\\frac\\beta2$â€‹; å½“ $d\\geq1.5d_{targ} ,\\beta\\leftarrow2\\beta$ã€‚å€¼å¾—ä¸€æçš„æ˜¯ $\\beta$çš„åˆå€¼ä»¥åŠå‚æ•°1.5å’Œ2å¯¹ç®—æ³•æœ¬èº«å¹¶ä¸æ•æ„Ÿã€‚è¿™æ˜¯å› ä¸ºç®—æ³•ä¼šåœ¨ä½¿ç”¨ä¸­è‡ªåŠ¨åˆ¤æ–­å¹¶ä¸”è°ƒæ•´å‚æ•°ã€‚ ","date":"2023-07-14","objectID":"/posts/ppo/:2:3","tags":["PPO"],"title":"å¼ºåŒ–å­¦ä¹  | PPO è®ºæ–‡è§£è¯»","uri":"/posts/ppo/"},{"categories":["RL"],"content":"5.ç®—æ³•éƒ¨åˆ† BP Network åœ¨ç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªæ¯”è¾ƒè¯¦ç»†çš„ä¼ªä»£ç å›¾: BP Network ç®—æ³•ä¸­ä¼˜åŠ¿å‡½æ•°çš„è®¡ç®—å¦‚ä¸‹(å…·ä½“ç®—æ³•è¿‡ç¨‹ä¸è¿‡å¤šæè¿°è¯·å‚è€ƒåŸè®ºæ–‡)ï¼š BP Network ","date":"2023-07-14","objectID":"/posts/ppo/:2:4","tags":["PPO"],"title":"å¼ºåŒ–å­¦ä¹  | PPO è®ºæ–‡è§£è¯»","uri":"/posts/ppo/"},{"categories":["RL"],"content":"6.å®éªŒéƒ¨åˆ† ä¸è¿‡å¤šæè¿°ï¼Œå°±ç»™å¼ å›¾ï¼š BP Network ","date":"2023-07-14","objectID":"/posts/ppo/:2:5","tags":["PPO"],"title":"å¼ºåŒ–å­¦ä¹  | PPO è®ºæ–‡è§£è¯»","uri":"/posts/ppo/"},{"categories":["RL"],"content":"Ref: [1] PPOç®—æ³•ç»å…¸è®ºæ–‡é˜…è¯» [2] PPO(Proximal Policy Optimization Algorithms)è®ºæ–‡è§£è¯»åŠå®ç° [3] å½±å“PPOç®—æ³•æ€§èƒ½çš„10ä¸ªå…³é”®æŠ€å·§ï¼ˆé™„PPOç®—æ³•ç®€æ´Pytorchå®ç°ï¼‰ ","date":"2023-07-14","objectID":"/posts/ppo/:3:0","tags":["PPO"],"title":"å¼ºåŒ–å­¦ä¹  | PPO è®ºæ–‡è§£è¯»","uri":"/posts/ppo/"},{"categories":["RL"],"content":"[DQN]paper link: https://arxiv.org/pdf/1312.5602v1.pdf ","date":"2023-07-14","objectID":"/posts/dqn/:0:0","tags":null,"title":"DQN","uri":"/posts/dqn/"},{"categories":["RL"],"content":"DQN: Playing Atari with Deep Reinforcement Learning ","date":"2023-07-14","objectID":"/posts/dqn/:1:0","tags":null,"title":"DQN","uri":"/posts/dqn/"},{"categories":["RL"],"content":"General Architecture Here is Network listed: play Atari games using RL and perform better than human CNN + Q Learning: CNN for frame-skiped images features extraction; and Q Learning for policy generation Network Channel Kernel Size Stride Activation Output Size Input NA NA NA NA $84\\times84\\times4$ First Conv 16 8x8 4 Relu $20 \\times 20 \\times 6$ Second Conv 32 4x4 2 Relu $9 \\times 9 \\times 32$ Hidden NA NA NA Relu 256 Output NA NA NA None 4 to 18 åœ¨å½“æ—¶ï¼Œæ™®éçš„åšæ³•æ˜¯ä¸ºæ¯ä¸€ä¸ªactionå­¦ä¹ ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç½‘ç»œç»“æ„ç›´æ¥è¾“å‡ºæ‰€æœ‰qçš„value. ","date":"2023-07-14","objectID":"/posts/dqn/:1:1","tags":null,"title":"DQN","uri":"/posts/dqn/"},{"categories":["RL"],"content":"Key 1: Input Info Process å›¾åƒå¤„ç†éƒ¨åˆ† Grayscale, Downsampling and Cropping RGB channels to gray scale channel (å°†RGBå–å‡å€¼ä¸ºç°åº¦å›¾): 216 x 163 x 3 =\u003e(grayscale) 216 x 163 x 1 =\u003e(downsampling) 110 x 84 x 1 =\u003e(cropping) 84 x 84 x 1 æ¸¸æˆéƒ¨åˆ† Key Frame and Action Repeat select skipped frames (æ¯ä¸ª4å¸§é€‰å–å…³é”®å¸§)ï¼Œå‡è®¾æ™ºèƒ½ä½“çœ‹ä¸è§ä¸­é—´è¿‡ç¨‹; è€Œä¸”agentåœ¨æ¯kå¸§é€‰æ‹©ä¸€ä¸ªactionï¼Œå¯ä»¥åŠ é€Ÿè®­ç»ƒ ä½œç”¨: åŠ é€Ÿæ¸¸æˆè¿›è¡Œ: è®¡ç®—Q-Valueæ˜¯æœ€è€—æ—¶çš„æ­¥éª¤; å‡å°‘å™ªå£°: è¿‡åˆ†ç´§å¯†çš„frameé‡å¤ä¿¡æ¯è¿‡å¤šï¼Œä¹‹å‰çš„actionå®¹æ˜“è¢«å¦å†³; ç¼©çŸ­reward signalåˆ°å…·ä½“acitonä¹‹é—´çš„æ—¶é—´é—´éš”ã€‚ History as Input continuous history key frames as input (è¿ç»­å››ä¸ªå…³é”®å¸§ä½œä¸ºè¾“å…¥) ä½œç”¨: å¯ä»¥å¸®åŠ©æ™ºèƒ½ä½“è·å¾—æ›´å¤šæœ‰æ•ˆä¿¡æ¯è¿›è¡Œè®­ç»ƒ Reward Clipping å°†å¤šæœ‰çš„rewardç®€åŒ–ä¸º+1, -1å’Œ0 ç¼ºç‚¹: æœ‰å¯èƒ½å¯¹è®­ç»ƒæ•ˆæœæœ‰å½±å“ ä½œç”¨: æŸå¤±äº†éƒ¨åˆ†ä¿¡æ¯ï¼Œä½†æ˜¯å¯ä»¥ä¿è¯ä¸åŒæ¸¸æˆçš„reward scaleç›¸åŒï¼Œå¯ä»¥ç”¨ç›¸åŒçš„å‚æ•°è¿›è¡Œè®­ç»ƒ(å› ä¸ºåœ¨è®ºæ–‡ä¸­ï¼Œä½œè€…åœ¨å¤šä¸ªæ¸¸æˆä¸Šå¯¹DQNè¿›è¡Œäº†éªŒè¯)ã€‚ ","date":"2023-07-14","objectID":"/posts/dqn/:1:2","tags":null,"title":"DQN","uri":"/posts/dqn/"},{"categories":["RL"],"content":"Key 2: Replay Buffer åŸç†: DQNä¸­å¯¹ç¥ç»ç½‘ç»œçš„è®­ç»ƒæœ¬è´¨ä¾ç„¶æ˜¯SGDï¼ŒSGDè¦æ±‚å¤šæ¬¡åˆ©ç”¨æ ·æœ¬ï¼Œå¹¶ä¸”æ ·æœ¬ç‹¬ç«‹ï¼Œä½†ç›¸é‚»çš„transitionéƒ½æ˜¯é«˜åº¦ç›¸å…³çš„ï¼Œæ‰€ä»¥è¦è®°ä½è¿‡å»çš„transitionä¸€èµ·æŠ½æ ·; Replay Bufferé€šè¿‡è®°å¿†ä¸€æ®µæ—¶é—´å†…çš„trainsitionï¼Œå¯ä»¥è®©è®­ç»ƒæ•°æ®åˆ†å¸ƒæ›´å¹³ç¨³; Replay Bufferé€šè¿‡å¿˜è®°å¾ˆä¹…ä¹‹å‰çš„trainsitionï¼Œå¯ä»¥ä¿è¯è®°ä½çš„åˆ†å¸ƒå¤§è‡´æ¨¡æ‹Ÿå½“å‰policyçš„åˆ†å¸ƒï¼Œä»è€Œè¿›è¡Œpolicy update; å¯ä»¥å¤šæ¬¡é‡å¤é‡‡æ ·ï¼Œæå‡data efficiency. Replay Bufferç”Ÿæ•ˆçš„ä¸€ä¸ªé‡è¦æ¡ä»¶: å­˜å‚¨transitionæ•°é‡åˆé€‚ å¤ªå¤š: å¯èƒ½ä½¿reward signalå¤ªè¿‡ç¨€ç–ï¼Œå½±å“è®­ç»ƒ å¤ªå°‘: å¯èƒ½ä¼šå¯¼è‡´è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒè¿…é€Ÿå˜åŒ– ","date":"2023-07-14","objectID":"/posts/dqn/:1:3","tags":null,"title":"DQN","uri":"/posts/dqn/"},{"categories":["RL"],"content":"Key 3: Semi-Gradient Method åœ¨Eauation3ä¸­ï¼Œ $$y_i = r + \\gamma \\max_{aâ€™}Q(sâ€™, aâ€™; \\theta_{t-1})$$ ä¸å’Œä¹‹åçš„Qå‡½æ•°å…±äº«å‚æ•°; ä½†æ˜¯åœ¨å®é™…çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé‡‡ç”¨ $$ y_i = r + \\gamma \\max_{aâ€™}Q(sâ€™, aâ€™; \\theta_{t})$$ å’Œä¹‹åçš„Qå‡½æ•°å…±äº«å‚æ•°ï¼Œä½†æ˜¯å®é™…ä¸Šä¸å‚ä¸å¯¼æ•°è®¡ç®—ï¼Œè¿™ç§æ–¹æ³•ç§°ä¸ºSemi-Gradient Methodã€‚ ä½œç”¨: ä½¿è®­ç»ƒæ›´æ–°æ›´ç¨³å®šã€‚ ","date":"2023-07-14","objectID":"/posts/dqn/:1:4","tags":null,"title":"DQN","uri":"/posts/dqn/"},{"categories":["RL"],"content":"1. å¼ºåŒ–å­¦ä¹  Reinforcement Learning (RL): å¼ºåŒ–å­¦ä¹  å¼ºåŒ–å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰å’Œæœºå™¨å­¦ä¹ ï¼ˆMLï¼‰é¢†åŸŸçš„ä¸€ä¸ªé‡è¦å­é¢†åŸŸï¼Œä¸åŒäºç›‘ç£å­¦ä¹ å’Œæ— ç›‘ç£å­¦ä¹ ï¼Œå¼ºåŒ–å­¦ä¹ é€šè¿‡æ™ºèƒ½ä½“ä¸ç¯å¢ƒçš„ä¸æ–­äº¤äº’(å³é‡‡å–åŠ¨ä½œ)ï¼Œè¿›è€Œè·å¾—å¥–åŠ±ï¼Œä»è€Œä¸æ–­ä¼˜åŒ–è‡ªèº«åŠ¨ä½œç­–ç•¥ï¼Œä»¥æœŸå¾…æœ€å¤§åŒ–å…¶é•¿æœŸæ”¶ç›Š(å¥–åŠ±ä¹‹å’Œ)ã€‚å¼ºåŒ–å­¦ä¹ ç‰¹åˆ«é€‚åˆåºè´¯å†³ç­–é—®é¢˜(æ¶‰åŠä¸€ç³»åˆ—æœ‰åºçš„å†³ç­–é—®é¢˜)ã€‚ ML Categories åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé’ˆå¯¹æŸäº›ä»»åŠ¡ï¼Œæˆ‘ä»¬å¾€å¾€æ— æ³•ç»™æ¯ä¸ªæ•°æ®æˆ–è€…çŠ¶æ€è´´ä¸Šå‡†ç¡®çš„æ ‡ç­¾ï¼Œä½†æ˜¯èƒ½å¤ŸçŸ¥é“æˆ–è¯„ä¼°å½“å‰æƒ…å†µæˆ–æ•°æ®æ˜¯å¥½è¿˜æ˜¯åï¼Œå¯ä»¥é‡‡ç”¨å¼ºåŒ–å­¦ä¹ æ¥å¤„ç†ã€‚ä¾‹å¦‚ï¼Œä¸‹å›´æ£‹(Go)ï¼Œæ˜Ÿé™…äº‰éœ¸II(Starcraft II)ç­‰æ¸¸æˆã€‚ 1.1 å¼ºåŒ–å­¦ä¹ çš„å®šä¹‰ Agent interacts with its surroundings known as the environment. Agent will get a reward from the environemnt once it takes an action in the current enrivonment. Meanwhile, the environment evolves to the next state. The goal of the agent is to maximize its total reward (the Return) in the long run. æ™ºèƒ½ä½“ä¸ç¯å¢ƒçš„ä¸æ–­äº¤äº’(å³åœ¨ç»™å®šçŠ¶æ€é‡‡å–åŠ¨ä½œ)ï¼Œè¿›è€Œè·å¾—å¥–åŠ±ï¼Œæ­¤æ—¶ç¯å¢ƒä»ä¸€ä¸ªçŠ¶æ€è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚æ™ºèƒ½ä½“é€šè¿‡ä¸æ–­ä¼˜åŒ–è‡ªèº«åŠ¨ä½œç­–ç•¥ï¼Œä»¥æœŸå¾…æœ€å¤§åŒ–å…¶é•¿æœŸå›æŠ¥æˆ–æ”¶ç›Š(å¥–åŠ±ä¹‹å’Œ)ã€‚ å¼ºåŒ–å­¦ä¹ æµç¨‹å›¾ ","date":"2023-07-14","objectID":"/posts/rl_introduction/:1:0","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"1.2 å¼ºåŒ–å­¦ä¹ çš„ç›¸å…³æ¦‚å¿µ (1) çŠ¶æ€ State ($S$): agentâ€™s observation of its environment; (2) åŠ¨ä½œ Action ($A$): the approaches that agent interacts with the environment; (3) å¥–åŠ± Reward ($R_t$): the bonus that agent get once it takes an action in the environment at the given time step t.å›æŠ¥(Return)ä¸ºAgentæ‰€è·å¾—çš„å¥–åŠ±ä¹‹å’Œã€‚ (4) è½¬ç§»æ¦‚ç‡ Transistion Probability ($P$): the transition possibility that environment evolves from one state to another. ç¯å¢ƒä»ä¸€ä¸ªçŠ¶æ€è½¬ç§»åˆ°å¦ä¸€ä¸ªçŠ¶æ€ï¼Œå¯ä»¥æ˜¯ç¡®å®šæ€§è½¬ç§»è¿‡ç¨‹ï¼Œä¾‹å¦‚ï¼Œ$S_{t+1} = f(S_t, A_t)$, ä¹Ÿå¯ä»¥æ˜¯éšæœºæ€§è½¬ç§»è¿‡ç¨‹ï¼Œä¾‹å¦‚ $S_{t+1} \\sim p\\left( S_{t+1}|S_t, A_t \\right)$ (5) æŠ˜æ‰£å› å­ Discount factor ( $\\gamma$ ): to measure the importance of future reward to agent at the current state. (6) è½¨è¿¹(Trajectory):æ˜¯ä¸€ç³»åˆ—çš„çŠ¶æ€ã€åŠ¨ä½œã€å’Œå¥–åŠ±ï¼Œå¯ä»¥è¡¨è¿°ä¸ºï¼š $$\\tau = (S_0, A_0, R_0, S_1, A_1, R_1, â€¦ )$$ ç”¨è½¨è¿¹$\\tau$æ¥è®°å½•Agentå¦‚ä½•å’Œç¯å¢ƒäº¤äº’ã€‚è½¨è¿¹çš„åˆå§‹çŠ¶æ€æ˜¯ä»èµ·å§‹çŠ¶æ€åˆ†å¸ƒä¸­éšæœºé‡‡æ ·å¾—åˆ°çš„ã€‚ä¸€æ¡è½¨è¿¹æœ‰æ—¶å€™ä¹Ÿç§°ä¸ºç‰‡æ®µ(Episode)æˆ–è€…å›åˆï¼Œæ˜¯ä¸€ä¸ªä»åˆå§‹çŠ¶æ€(Initial Stateï¼Œä¾‹å¦‚æ¸¸æˆçš„å¼€å±€)åˆ°æœ€ç»ˆçŠ¶æ€(Terminal Stateï¼Œå¦‚æ¸¸æˆä¸­æ­»äº¡æˆ–è€…èƒœåˆ©)çš„åºåˆ—ã€‚ (7) æ¢ç´¢-åˆ©ç”¨çš„æŠ˜ä¸­(Exploration-Exploitation Tradeoff): è¿™é‡Œï¼Œæ¢ç´¢æ˜¯æŒ‡Agenté€šè¿‡ä¸ç¯å¢ƒçš„äº¤äº’æ¥è·å–æ›´å¤šçš„ä¿¡æ¯ï¼Œè€Œåˆ©ç”¨æ˜¯æŒ‡ä½¿ç”¨å½“å‰å·²çŸ¥ä¿¡æ¯æ¥ä½¿å¾—Agentçš„è¡¨ç°è¾¾åˆ°æœ€ä½³ï¼Œä¾‹å¦‚ï¼Œè´ªå¿ƒ(greedy)ç­–ç•¥ã€‚åŒä¸€æ—¶é—´ï¼Œåªèƒ½äºŒè€…é€‰ä¸€ã€‚å› æ­¤ï¼Œå¦‚ä½•å¹³è¡¡æ¢ç´¢å’Œåˆ©ç”¨äºŒè€…ï¼Œä»¥å®ç°é•¿æœŸå›æŠ¥(Long-term Return)æœ€å¤§ï¼Œæ˜¯å¼ºåŒ–å­¦ä¹ ä¸­éå¸¸é‡è¦çš„é—®é¢˜ã€‚ å› æ­¤ï¼Œå¯ä»¥ç”¨$ (Sï¼ŒAï¼ŒPï¼ŒRï¼Œ\\gamma) $æ¥æè¿°å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ã€‚ ","date":"2023-07-14","objectID":"/posts/rl_introduction/:1:1","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"1.3 å¼ºåŒ–å­¦ä¹ çš„æ•°å­¦å»ºæ¨¡ (1) é©¬å°”å¯å¤«è¿‡ç¨‹ (Markov Processï¼ŒMP) æ˜¯ä¸€ä¸ªå…·å¤‡é©¬å°”å¯å¤«æ€§è´¨çš„ç¦»æ•£éšæœºè¿‡ç¨‹ã€‚ é©¬å°”å¯å¤«æ€§è´¨æ˜¯æŒ‡ä¸‹ä¸€çŠ¶æ€ $ S_{t+1} $ åªå–å†³äºå½“å‰çŠ¶æ€ $S_t$. $$p(S_{t+1}|S_{t}) = p(S_{t+1} | S_0, S_1, S_2, â€¦, S_t)$$ å¯ä»¥ç”¨æœ‰é™çŠ¶æ€é›†åˆ $\\mathcal{S}$ å’ŒçŠ¶æ€è½¬ç§»çŸ©é˜µ $\\mathbf{P}$ è¡¨ç¤ºMPè¿‡ç¨‹ä¸º $\u003c\\mathcal{S}, \\mathbf{P}\u003e$ã€‚ ä¸ºäº†èƒ½å¤Ÿåˆ»ç”»ç¯å¢ƒå¯¹Agentçš„åé¦ˆå¥–åŠ±ï¼Œé©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹å°†ä¸Šè¿°MPä» $\u003c\\mathcal{S}, \\mathbf{P}\u003e$ æ‰©å±•åˆ°äº†$ \u003c\\mathcal{S}, \\mathbf{P}, R, \\gamma\u003e$ã€‚è¿™é‡Œï¼Œ$R$è¡¨ç¤ºå¥–åŠ±å‡½æ•°ï¼Œè€Œ $\\gamma$ è¡¨ç¤ºå¥–åŠ±æŠ˜æ‰£å› å­ã€‚ $$R_t = R(S_t)$$ å›æŠ¥(Return)æ˜¯Agentåœ¨ä¸€ä¸ªè½¨è¿¹ä¸Šçš„ç´¯è®¡å¥–åŠ±ã€‚æŠ˜æ‰£åŒ–å›æŠ¥å®šä¹‰å¦‚ä¸‹ï¼š $$G_{t=0:T} = R(\\tau) = \\sum_{t=0}^{T}\\gamma^{t}R_t$$ ä»·å€¼å‡½æ•°(Value Function) $V(s)$æ˜¯Agentåœ¨çŠ¶æ€$s$çš„æœŸæœ›å›æŠ¥(Expected Return)ã€‚ $$V^{\\pi} (s) = \\mathbb{E}[R(\\tau) | S_0 = s]$$ (3) é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ (Markov Decision Processï¼ŒMDP) MDPè¢«å¹¿æ³›åº”ç”¨äºç»æµã€æ§åˆ¶è®ºã€æ’é˜Ÿè®ºã€æœºå™¨äººã€ç½‘ç»œåˆ†æç­‰è¯¸å¤šé¢†åŸŸã€‚ é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„ç«‹å³å¥–åŠ±(Rewardï¼Œ$R$)ä¸çŠ¶æ€å’ŒåŠ¨ä½œæœ‰å…³ã€‚MDPå¯ä»¥ç”¨$\u003c\\mathcal{S},\\mathcal{A}, \\mathbf{P}, R, \\gamma\u003e$æ¥åˆ»ç”»ã€‚ $\\mathcal{A}$è¡¨ç¤ºæœ‰é™çš„åŠ¨ä½œé›†åˆï¼Œæ­¤æ—¶ï¼Œç«‹å³å¥–åŠ±å˜ä¸º $$R_t = R(S_t, A_t)$$ ç­–ç•¥(Policy)ç”¨æ¥åˆ»ç”»Agentæ ¹æ®ç¯å¢ƒè§‚æµ‹é‡‡å–åŠ¨ä½œçš„æ–¹å¼ã€‚Policyæ˜¯ä»ä¸€ä¸ªçŠ¶æ€ $s \\in \\mathcal{S}$ åˆ°åŠ¨ä½œ $a \\in \\mathcal{A}$çš„æ¦‚ç‡åˆ†å¸ƒ$\\pi(a|s)$ çš„æ˜ å°„ï¼Œ$\\pi(a|s)$ è¡¨ç¤ºåœ¨çŠ¶æ€$s$ä¸‹ï¼Œé‡‡å–åŠ¨ä½œ $a$ çš„æ¦‚ç‡ã€‚ $$\\pi (a|s) = p (A_t = a | S_t = s), \\exist{t} $$ æœŸæœ›å›æŠ¥(Expected Return)æ˜¯æŒ‡åœ¨ä¸€ä¸ªç»™å®šç­–ç•¥ä¸‹æ‰€æœ‰å¯èƒ½è½¨è¿¹çš„å›æŠ¥çš„æœŸæœ›å€¼ï¼Œå¯ä»¥è¡¨ç¤ºä¸ºï¼š $$J(\\pi) = \\int_{\\tau} p(\\tau | \\pi) R(\\tau) = \\mathbb{E}_{\\tau \\sim \\pi}[R(\\tau)]$$ è¿™é‡Œ, $p(\\tau|\\pi)$è¡¨ç¤ºç»™å®šåˆå§‹çŠ¶æ€åˆ†å¸ƒ $\\rho_0$ å’Œç­–ç•¥ $\\pi$ï¼Œé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¸­ä¸€ä¸ª $T$ æ­¥é•¿çš„è½¨è¿¹ $\\tau$ çš„å‘ç”Ÿæ¦‚ç‡ï¼Œå¦‚ä¸‹ï¼š $$p(\\tau | \\pi) = \\rho_0(s_0)\\prod \\limits_{t=0}^{T-1} p(S_{t+1} | S_t, A_t) \\pi (A_t | S_t)$$ å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–é—®é¢˜é€šè¿‡ä¼˜åŒ–æ–¹æ³•æ¥æå‡ç­–ç•¥ï¼Œä»¥æœ€å¤§åŒ–æœŸæœ›å›æŠ¥ã€‚æœ€ä¼˜ç­–ç•¥$\\pi^*$ å¯ä»¥è¡¨ç¤ºä¸º: $$\\pi ^ * = \\argmax_{\\pi} J(\\pi)$$ ç»™å®šä¸€ä¸ªç­–ç•¥ $\\pi$ï¼Œä»·å€¼å‡½æ•°$V(s)$ï¼Œå³ç»™å®šçŠ¶æ€ä¸‹çš„æœŸæœ›å›æŠ¥ï¼Œå¯ä»¥è¡¨ç¤ºä¸º: $$V^{\\pi}(s) = \\mathbb{E}_{\\tau \\sim \\pi} [R(\\tau) | S_0 = s] = \\mathbb{E}_{A_t \\sim \\pi(\\cdot | S_t)} [\\sum_{t=0}^{\\infin}\\gamma^t R(S_t, A_t) | S_0 = s]$$ åœ¨MDPä¸­ï¼Œç»™å®šä¸€ä¸ªåŠ¨ä½œï¼Œå°±æœ‰åŠ¨ä½œä»·å€¼å‡½æ•°(Action-Value Function)ï¼Œæ˜¯åŸºäºçŠ¶æ€å’ŒåŠ¨ä½œçš„æœŸæœ›å›æŠ¥ã€‚å…¶å®šä¹‰å¦‚ä¸‹ï¼š $$Q^{\\pi}(s, a) = \\mathbb{E}_{\\tau \\sim \\pi}[R(\\tau) | S_0 = s, A_0 = a] = \\mathbb{E}_{A_t \\sim \\pi(\\cdot | S_t)}[\\sum_{t=0}^{\\infin}\\gamma^t R(S_t, A_t)|S_0 = s, A_0 = a]$$ æ ¹æ®ä¸Šè¿°å®šä¹‰ï¼Œå¯ä»¥å¾—åˆ°ï¼š $$V^{\\pi}(s) = \\mathbb{E}_{a \\sim \\pi}[Q^{\\pi}(s,a)]$$ ","date":"2023-07-14","objectID":"/posts/rl_introduction/:1:2","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"2. æ·±åº¦å¼ºåŒ–å­¦ä¹  Deep Learning + Reinforcement Learning = Deep Reinforcement Learning (DRL) æ·±åº¦å­¦ä¹ DLæœ‰å¾ˆå¼ºçš„æŠ½è±¡å’Œè¡¨ç¤ºèƒ½åŠ›ï¼Œç‰¹åˆ«é€‚åˆå»ºæ¨¡RLä¸­çš„å€¼å‡½æ•°ï¼Œä¾‹å¦‚: åŠ¨ä½œä»·å€¼å‡½æ•° $Q^\\pi \\left(s, a \\right)$ã€‚ äºŒè€…ç»“åˆï¼Œæå¤§åœ°æ‹“å±•äº†RLçš„åº”ç”¨èŒƒå›´ã€‚ ","date":"2023-07-14","objectID":"/posts/rl_introduction/:2:0","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"3. å¸¸è§æ·±åº¦å¼ºåŒ–å­¦ä¹ ç®—æ³• æ·±åº¦å¼ºåŒ–å­¦ä¹ çš„ç®—æ³•æ¯”è¾ƒå¤šï¼Œå¸¸è§çš„æœ‰ï¼šDQNï¼ŒDDPGï¼ŒPPOï¼ŒTRPOï¼ŒA3Cï¼ŒSAC ç­‰ç­‰ã€‚ å¸¸è§æ·±åº¦å¼ºåŒ–å­¦ä¹ ç®—æ³• ","date":"2023-07-14","objectID":"/posts/rl_introduction/:3:0","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"3.1 Deep Q-Networks ï¼ˆDQNï¼‰ DQNç½‘è·¯å°†Q-Learningå’Œæ·±åº¦å­¦ä¹ ç»“åˆèµ·æ¥ï¼Œå¹¶å¼•å…¥äº†ä¸¤ç§æ–°é¢–çš„æŠ€æœ¯æ¥è§£å†³ä»¥å¾€é‡‡ç”¨ç¥ç»ç½‘ç»œç­‰éçº¿æ€§å‡½æ•°é€¼è¿‘å™¨è¡¨ç¤ºåŠ¨ä½œä»·å€¼å‡½æ•° Q(s,a) æ‰€äº§ç”Ÿçš„ä¸ç¨³å®šæ€§é—®é¢˜ï¼š æŠ€æœ¯1: ç»éªŒå›æ”¾ç¼“å­˜ï¼ˆReplay Bufferï¼‰ï¼šå°†Agentè·å¾—çš„ç»éªŒå­˜å…¥ç¼“å­˜ä¸­ï¼Œç„¶åä»è¯¥ç¼“å­˜ä¸­å‡åŒ€é‡‡ç”¨ï¼ˆä¹Ÿå¯è€ƒè™‘åŸºäºä¼˜å…ˆçº§é‡‡æ ·ï¼‰å°æ‰¹é‡æ ·æœ¬ç”¨äºQ-Learningçš„æ›´æ–°ï¼› æŠ€æœ¯2: ç›®æ ‡ç½‘ç»œï¼ˆTarget Networkï¼‰ï¼šå¼•å…¥ç‹¬ç«‹çš„ç½‘ç»œï¼Œç”¨æ¥ä»£æ›¿æ‰€éœ€çš„Qç½‘ç»œæ¥ç”ŸæˆQ-Learningçš„ç›®æ ‡ï¼Œè¿›ä¸€æ­¥æé«˜ç¥ç»ç½‘ç»œç¨³å®šæ€§ã€‚ å…¶ä¸­, æŠ€æœ¯1 èƒ½å¤Ÿæé«˜æ ·æœ¬ä½¿ç”¨æ•ˆç‡ï¼Œé™ä½æ ·æœ¬é—´ç›¸å…³æ€§ï¼Œå¹³æ»‘å­¦ä¹ è¿‡ç¨‹ï¼›æŠ€æœ¯2 èƒ½å¤Ÿæ˜¯ç›®æ ‡å€¼ä¸å—æœ€æ–°å‚æ•°çš„å½±å“ï¼Œå¤§å¤§è¾ƒå°‘å‘æ•£å’Œéœ‡è¡ã€‚ DQNç®—æ³•å…·ä½“æè¿°å¦‚ä¸‹ï¼š DQN ä¼ªä»£ç  æ³¨æ„ï¼šè¿™é‡ŒéšæœºåŠ¨ä½œé€‰æ‹©æ¦‚ç‡$\\epsilon$ä¸€èˆ¬æ˜¯éšç€è¿­ä»£Episodeå’ŒTime Stepçš„å¢åŠ ï¼Œè€Œé€æ¸é™ä½ï¼Œç›®çš„æ˜¯é™ä½éšæœºç­–ç•¥çš„å½±å“ï¼Œé€æ­¥æé«˜Qç½‘ç»œå¯¹AgentåŠ¨ä½œé€‰æ‹©çš„å½±å“ã€‚ è¯¥ç®—æ³•ä¸­ï¼ŒLine 14 å…·ä½“æ›´æ–°æ–¹å¼å¦‚ä¸‹ï¼š $$\\theta^Q\\leftarrow\\theta^Q+\\beta\\sum_{i\\in\\mathcal{N}}\\frac{\\partial Q(s,a|\\theta^Q)}{\\partial\\theta^Q}\\left[y_i-Q(s,a|\\theta^Q)\\right]$$ å…¶ä¸­ï¼Œé›†åˆ$N$ä¸­ä¸ºminibatchçš„$N$ä¸ª$(S_t,A_t,R_t,S_{t+1})$ç»éªŒæ ·æœ¬é›†åˆï¼Œ$\\beta$è¡¨ç¤ºä¸€æ¬¡æ¢¯åº¦è¿­ä»£ä¸­çš„è¿­ä»£æ­¥é•¿ã€‚ å‚è€ƒæ–‡çŒ® [1] V. Mnih et al., â€œHuman-level control through deep reinforcement learning,â€ Nature, vol. 518, no. 7540, pp. 529â€“533, Feb. 2015. ","date":"2023-07-14","objectID":"/posts/rl_introduction/:3:1","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"3.2 Deep Deterministic Policy Gradientï¼ˆDDPGï¼‰ DDPGç®—æ³•å¯ä»¥çœ‹ä½œDeterministic Policy Gradientï¼ˆDPGï¼‰ç®—æ³•å’Œæ·±åº¦ç¥ç»ç½‘ç»œçš„ç»“åˆï¼Œæ˜¯å¯¹ä¸Šè¿°æ·±åº¦Qç½‘ç»œï¼ˆDQNï¼‰åœ¨è¿ç»­åŠ¨ä½œç©ºé—´çš„æ‰©å±•ã€‚ DDPGåŒæ—¶å»ºç«‹Qå€¼å‡½æ•°ï¼ˆCriticï¼‰å’Œç­–ç•¥å‡½æ•°ï¼ˆActorï¼‰ã€‚è¿™é‡Œï¼ŒCriticä¸DQNç›¸åŒï¼Œé‡‡ç”¨TDæ–¹æ³•è¿›è¡Œæ›´æ–°ï¼›è€ŒActoråˆ©ç”¨Criticçš„ä¼°è®¡ï¼Œé€šè¿‡ç­–ç•¥æ¢¯åº¦æ–¹æ³•è¿›è¡Œæ›´æ–°ã€‚ DDPGç®—æ³•å…·ä½“æè¿°å¦‚ä¸‹ï¼š DDPG ä¼ªä»£ç  åŸè®ºæ–‡ä¸­é‡‡ç”¨Ornstein-Uhlenbeckè¿‡ç¨‹ï¼ˆO-Uè¿‡ç¨‹ï¼‰ä½œä¸ºæ·»åŠ å™ªå£°é¡¹N \\mathcal{N}Nï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨æ—¶é—´ä¸ç›¸å…³çš„é›¶å‡å€¼é«˜æ–¯å™ªå£°ï¼ˆç›¸å…³å®è·µè¡¨æ˜ï¼Œå…¶æ•ˆæœä¹Ÿå¾ˆå¥½ï¼‰ã€‚ å‚è€ƒæ–‡çŒ® [1] Lillicrap, Timothy P., et al. â€œContinuous control with deep reinforcement learningâ€ï¼ŒarXiv preprint, 2015, online: https://arxiv.org/pdf/1509.02971.pdf ","date":"2023-07-14","objectID":"/posts/rl_introduction/:3:2","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"3.3 Proximal Policy Optimizationï¼ˆPPOï¼‰ PPOç®—æ³•æ˜¯å¯¹ä¿¡èµ–åŸŸç­–ç•¥ä¼˜åŒ–ç®—æ³•(Trust Region Policy Optimization, TRPO) çš„ä¸€ä¸ªæ”¹è¿›ï¼Œç”¨ä¸€ä¸ªæ›´ç®€å•æœ‰æ•ˆçš„æ–¹æ³•æ¥å¼ºåˆ¶ç­–ç•¥$\\pi_\\theta$ä¸$\\pi_{\\theta}^{\\prime}$ç›¸ä¼¼ã€‚ å…·ä½“æ¥è¯´ï¼ŒTRPOä¸­çš„ä¼˜åŒ–é—®é¢˜å¦‚ä¸‹ï¼š $$\\begin{gathered}\\max_{\\pi_{\\theta}^{\\prime}}\\mathcal{L}_{\\pi_{\\theta}}(\\pi_{\\theta}^{\\prime})\\\\s.t.\\mathbb{E}_{s\\sim\\rho_{\\pi_\\theta}}[D_{KL}\\left(\\pi_\\theta\\left|\\left|\\pi_\\theta^{\\prime}\\right.\\right)\\right]\\leq\\delta \\end{gathered}$$ è€ŒPPOç®—æ³•ç›´æ¥ä¼˜åŒ–ä¸Šè¿°é—®é¢˜çš„æ­£åˆ™ç‰ˆæœ¬ï¼Œå³ï¼š $$\\max_{\\pi_{\\theta}^{\\prime}}\\mathcal{L}_{\\pi_{\\theta}}\\left(\\pi_{\\theta}^{\\prime}\\right)-\\lambda\\mathbb{E}_{s\\sim\\rho_{\\pi_{\\theta}}}\\quad[D_{KL}\\left(\\pi_{\\theta}||\\pi_{\\theta}^{\\prime}\\right)]$$ è¿™é‡Œï¼Œå…¥ä¸ºæ­£åˆ™åŒ–ç³»æ•°ï¼Œå¯¹åº”TRPOä¼˜åŒ–é—®é¢˜ä¸­çš„æ¯ä¸€ä¸ª$\\delta$,éƒ½å­˜åœ¨ä¸€ä¸ªç›¸åº”çš„$\\lambda$,ä½¿å¾—ä¸Šè¿°ä¸¤ä¸ªä¼˜åŒ–é—®é¢˜æœ‰ç›¸åŒçš„è§£ã€‚ç„¶è€Œï¼Œå…¥çš„å€¼ä¾èµ–äº$\\pi_\\theta$,å› æ­¤ï¼Œåœ¨PPOä¸­ï¼Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªå¯åŠ¨æ€è°ƒæ•´çš„$\\lambda$ã€‚å…·ä½“æ¥è¯´æœ‰ä¸¤ç§æ–¹æ³•ï¼š (1) é€šè¿‡æ£€éªŒKLæ•£åº¦å€¼æ¥å†³å®š$\\lambda$æ˜¯å¢å¤§è¿˜æ˜¯å‡å°ï¼Œè¯¥ç‰ˆæœ¬çš„PPOç®—æ³•ç§°ä¸ºPPO-Penalty; (2) ç›´æ¥æˆªæ–­ç”¨äºç­–ç•¥æ¢¯åº¦çš„ç›®æ ‡å‡½æ•°ï¼Œä»è€Œå¾—åˆ°æ›´ä¿å®ˆçš„æ›´æ–°ï¼Œè¯¥æ–¹æ³•ç§°ä¸ºPPO-Clipã€‚ PPO-Clipç®—æ³•å…·ä½“æè¿°å¦‚ä¸‹ï¼š PPO ä¼ªä»£ç  $$f(\\thetaâ€™)=\\min\\left(\\ell_t\\left(\\thetaâ€™\\right)A^{\\pi_{\\theta_{dd}}}(S_t,A_t),clip(\\ell_t\\left(\\thetaâ€™\\right),1-\\epsilon,1+\\epsilon)A^{\\pi_{\\theta_{dd}}}(S_t,A_t)\\right)$$ è¿™é‡Œï¼Œ$clip(x,1-\\epsilon,1+\\epsilon)$è¡¨ç¤ºå°†$x$æˆªæ–­åœ¨$[1-\\epsilon,1+\\epsilon]$ä¸­ã€‚ å‚è€ƒæ–‡çŒ® [1] Schulman, J. , et al. â€œProximal Policy Optimization Algorithmsâ€ï¼ŒarXiv preprint, 2017, online: https://arxiv.org/pdf/1707.06347.pdf [2] Schulman J, Levine S, Abbeel P, et al. â€œTrust region policy optimizationâ€, International conference on machine learning. PMLR, 2015: 1889-1897, online: http://proceedings.mlr.press/v37/schulman15.pdf ","date":"2023-07-14","objectID":"/posts/rl_introduction/:3:3","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"4. æ·±åº¦å¼ºåŒ–å­¦ä¹ ç®—æ³•åˆ†ç±» ","date":"2023-07-14","objectID":"/posts/rl_introduction/:4:0","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"4.1 æ ¹æ®Agentè®­ç»ƒä¸æµ‹è¯•æ‰€é‡‡ç”¨çš„ç­–ç•¥æ˜¯å¦ä¸€è‡´ 4.1.1 off-policy (ç¦»è½¨ç­–ç•¥ã€ç¦»çº¿ç­–ç•¥) Agentåœ¨è®­ç»ƒ(äº§ç”Ÿæ•°æ®)æ—¶æ‰€ä½¿ç”¨çš„ç­–ç•¥ $\\pi_1$ä¸ agentæµ‹è¯•(æ–¹æ³•è¯„ä¼°ä¸å®é™…ä½¿ç”¨â€“ç›®æ ‡ç­–ç•¥)æ—¶æ‰€ç”¨çš„ç­–ç•¥ $\\pi_2$ ä¸ä¸€è‡´ã€‚ ä¾‹å¦‚ï¼Œåœ¨DQNç®—æ³•ä¸­ï¼Œè®­ç»ƒæ—¶ï¼Œé€šå¸¸é‡‡ç”¨ $\\epsilon-greedy$ ç­–ç•¥ï¼›è€Œåœ¨æµ‹è¯•æ€§èƒ½æˆ–è€…å®é™…ä½¿ç”¨æ—¶ï¼Œé‡‡ç”¨ $ a^* = arg \\max\\limits_{a} Q^{\\pi}\\left( s, a \\right) $ ç­–ç•¥ã€‚ å¸¸è§ç®—æ³•æœ‰ï¼šDDPGï¼ŒTD3ï¼ŒQ-learningï¼ŒDQNç­‰ã€‚ 4.1.2 on-policy (åŒè½¨ç­–ç•¥ã€åœ¨çº¿ç­–ç•¥) Agentåœ¨è®­ç»ƒæ—¶(äº§ç”Ÿæ•°æ®)æ‰€ä½¿ç”¨çš„ç­–ç•¥ä¸å…¶æµ‹è¯•(æ–¹æ³•è¯„ä¼°ä¸æå‡)æ—¶ä½¿ç”¨çš„ç­–ç•¥ä¸ºåŒä¸€ä¸ªç­–ç•¥ $\\pi$ã€‚ å¸¸è§ç®—æ³•æœ‰ï¼šSarsaï¼ŒPolicy Gradientï¼ŒTRPOï¼ŒPPOï¼ŒA3Cç­‰ã€‚ ","date":"2023-07-14","objectID":"/posts/rl_introduction/:4:1","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"4.2 ç­–ç•¥ä¼˜åŒ–çš„æ–¹å¼ä¸åŒ 4.2.1 Value-based algorithms(åŸºäºä»·å€¼çš„ç®—æ³•) åŸºäºä»·å€¼çš„æ–¹æ³•é€šå¸¸æ„å‘³ç€å¯¹åŠ¨ä½œä»·å€¼å‡½æ•° $Q^{\\pi}(s,a)$çš„ä¼˜åŒ–ï¼Œæœ€ä¼˜ç­–ç•¥é€šè¿‡é€‰å–è¯¥å‡½æ•° $Q^{\\pi}(s,a)$ æœ€å¤§å€¼æ‰€å¯¹åº”çš„åŠ¨ä½œï¼Œå³ $\\pi^* \\approx \\arg \\max\\limits_{\\pi}Q^{\\pi}(s,a)$ï¼Œè¿™é‡Œï¼Œ$\\approx$ ç”±å‡½æ•°è¿‘ä¼¼è¯¯å·®å¯¼è‡´ã€‚ åŸºäºä»·å€¼çš„ç®—æ³•å…·æœ‰é‡‡æ ·æ•ˆç‡ç›¸å¯¹è¾ƒé«˜ï¼Œå€¼å‡½æ•°ä¼°è®¡æ–¹å·®å°ï¼Œä¸æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ç­‰ä¼˜ç‚¹ï¼Œç¼ºç‚¹æ˜¯é€šå¸¸ä¸èƒ½å¤„ç†è¿ç»­åŠ¨ä½œç©ºé—´é—®é¢˜ï¼Œæœ€ç»ˆç­–ç•¥é€šå¸¸ä¸ºç¡®å®šæ€§ç­–ç•¥ã€‚ å¸¸è§ç®—æ³•æœ‰ Q-learningï¼ŒDQNï¼ŒDouble DQNï¼Œç­‰ï¼Œé€‚ç”¨äº Discrete action spaceã€‚å…¶ä¸­ï¼ŒDQNç®—æ³•æ˜¯åŸºäºstate-action function $Q(s,a)$ æ¥è¿›è¡Œé€‰æ‹©æœ€ä¼˜actionçš„ã€‚ 4.2.2 Policy-based algorithms(åŸºäºç­–ç•¥çš„ç®—æ³•) åŸºäºç­–ç•¥çš„æ–¹æ³•ç›´æ¥å¯¹ç­–ç•¥è¿›è¡Œä¼˜åŒ–ï¼Œé€šè¿‡å¯¹ç­–ç•¥è¿­ä»£æ›´æ–°ï¼Œå®ç°ç´¯è®¡å¥–åŠ±(å›æŠ¥)æœ€å¤§åŒ–ã€‚å…¶å…·æœ‰ç­–ç•¥å‚æ•°åŒ–ç®€å•ã€æ”¶æ•›é€Ÿåº¦å¿«çš„ä¼˜ç‚¹ï¼Œè€Œä¸”é€‚ç”¨äºè¿ç»­æˆ–è€…é«˜ç»´åŠ¨ä½œç©ºé—´ã€‚ **ç­–ç•¥æ¢¯åº¦æ–¹æ³•(Policy Gradient Methodï¼ŒPGM)**æ˜¯ä¸€ç±»ç›´æ¥é’ˆå¯¹æœŸæœ›å›æŠ¥é€šè¿‡æ¢¯åº¦ä¸‹é™(Gradient Descentï¼Œé’ˆå¯¹æœ€å°åŒ–é—®é¢˜)è¿›è¡Œç­–ç•¥ä¼˜åŒ–çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ã€‚å…¶ä¸éœ€è¦åœ¨åŠ¨ä½œç©ºé—´ä¸­æ±‚è§£ä»·å€¼æœ€å¤§åŒ–çš„ä¼˜åŒ–é—®é¢˜ï¼Œä»è€Œæ¯”è¾ƒé€‚ç”¨äº continuous and high-Dimension action spaceï¼Œä¹Ÿå¯ä»¥è‡ªç„¶åœ°å¯¹éšæœºç­–ç•¥è¿›è¡Œå»ºæ¨¡ã€‚ PGMæ–¹æ³•é€šè¿‡æ¢¯åº¦ä¸Šå‡çš„æ–¹æ³•ç›´æ¥åœ¨ç¥ç»ç½‘ç»œçš„å‚æ•°ä¸Šä¼˜åŒ–Agentçš„ç­–ç•¥ã€‚ æ ¹æ®ç›¸å…³ç†è®ºï¼ŒæœŸæœ›å›æŠ¥ $J(\\pi_{\\theta})$ å…³äºå‚æ•° $\\theta$ çš„æ¢¯åº¦å¯ä»¥è¡¨ç¤ºä¸ºï¼š $$\\nabla_\\theta J(\\pi_\\theta)=\\mathbb{E}_{\\tau\\sim\\pi_\\theta}\\left[\\sum_{t=0}^TR_t\\nabla_\\theta\\sum_{t^{\\prime}=0}^T\\log\\pi_\\theta(A_{t^{\\prime}}|S_{t^{\\prime}})\\right]=\\mathbb{E}_{\\tau\\sim\\pi_\\theta}\\left[\\sum_{t^{\\prime}=0}^T\\nabla_\\theta\\log\\pi_\\theta\\left(A_{t^{\\prime}}|S_{t^{\\prime}}\\right)\\sum_{t=0}^TR_t\\right]$$ å½“$T \\rightarrow \\infin$ æ—¶ï¼Œä¸Šå¼å¯ä»¥è¡¨ç¤ºä¸ºï¼š $$\\nabla_{\\theta}J(\\pi_{\\theta}) = \\mathbb{E}_{\\tau \\sim \\pi_{\\theta}}[\\sum_{tâ€™=0}^{\\infin}\\nabla_{\\theta} \\log \\pi_{\\theta}(A_{tâ€™} | S_{tâ€™}) \\gamma^{tâ€™}\\sum_{t=tâ€™}^{\\infin} \\gamma^{t-tâ€™}R_t]$$ åœ¨å®é™…ä¸­ï¼Œç»å¸¸å»æ‰ $ \\gamma^{t^{\\prime}} $ï¼Œä»è€Œé¿å…è¿‡åˆ†å¼ºè°ƒè½¨è¿¹æ—©æœŸçŠ¶æ€çš„é—®é¢˜ã€‚ ä¸Šè¿°æ–¹æ³•å¾€å¾€å¯¹æ¢¯åº¦çš„ä¼°è®¡æœ‰è¾ƒå¤§çš„æ–¹æ³•(å¥–åŠ± $R_t$ çš„éšæœºæ€§å¯èƒ½å¯¹è½¨è¿¹é•¿åº¦Lå‘ˆæŒ‡æ•°çº§å¢é•¿)ã€‚ä¸ºæ­¤ï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯å¼•è¿›ä¸€ä¸ªåŸºå‡†å‡½æ•° $b(S_i)$ï¼Œä»…æ˜¯çŠ¶æ€ $S_i$ çš„å‡½æ•°ã€‚å¯å°†ä¸Šè¿°æ¢¯åº¦ä¿®æ”¹ä¸ºï¼š $$\\nabla_{\\theta}J(\\pi_{\\theta}) = \\mathbb{E}_{\\tau \\sim \\pi_{\\theta}}[\\sum_{tâ€™=0}^{\\infin}\\nabla_{\\theta} \\log \\pi_{\\theta}(A_{tâ€™} | S_{tâ€™}) (\\sum_{t=tâ€™}^{\\infin} \\gamma^{t-tâ€™}R_t - b(S_{tâ€™}))]$$ å¸¸è§çš„PGMç®—æ³•æœ‰REINFORCEï¼ŒPGï¼ŒPPOï¼ŒTRPO ç­‰ã€‚ 4.2.3 Actor-Critic algorithms (æ¼”å‘˜-è¯„è®ºå®¶æ–¹æ³•) Actor-Criticæ–¹æ³•ç»“åˆäº†ä¸Šè¿° åŸºäºä»·å€¼ çš„æ–¹æ³•å’Œ åŸºäºç­–ç•¥ çš„æ–¹æ³•ï¼Œåˆ©ç”¨åŸºäºä»·å€¼çš„æ–¹æ³•å­¦ä¹ Qå€¼å‡½æ•°æˆ–çŠ¶æ€ä»·å€¼å‡½æ•°Væ¥æé«˜é‡‡æ ·æ•ˆç‡(Critic)ï¼Œå¹¶åˆ©ç”¨åŸºäºç­–ç•¥çš„æ–¹æ³•å­¦ä¹ ç­–ç•¥å‡½æ•°(Actor)ï¼Œä»è€Œé€‚ç”¨äºè¿ç»­æˆ–é«˜ç»´åŠ¨ä½œç©ºé—´ã€‚å…¶ç¼ºç‚¹ä¹Ÿç»§æ‰¿äº†äºŒè€…çš„ç¼ºç‚¹ï¼Œä¾‹å¦‚ï¼ŒCriticå­˜åœ¨è¿‡ä¼°è®¡é—®é¢˜ï¼Œè€ŒActorå­˜åœ¨æ¢ç´¢ä¸è¶³çš„é—®é¢˜ç­‰ã€‚ å¸¸è§ç®—æ³•æœ‰ DDPG, A3Cï¼ŒTD3ï¼ŒSACç­‰ï¼Œé€‚ç”¨äº continuous and high-Dimension action space ","date":"2023-07-14","objectID":"/posts/rl_introduction/:4:2","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"4.3 å‚æ•°æ›´æ–°çš„æ–¹å¼ä¸åŒ Parameters updating methods 4.3.1 Monte Carlo method(è’™ç‰¹å¡ç½—æ–¹æ³•) è’™ç‰¹å¡ç½—æ–¹æ³•ï¼šå¿…é¡»ç­‰å¾…ä¸€æ¡è½¨è¿¹ $\\tau_k$ ç”Ÿæˆ(çœŸå®å€¼)åæ‰èƒ½æ›´æ–°ã€‚ å¸¸è§ç®—æ³•æœ‰ï¼šPolicy Gradientï¼ŒTRPOï¼ŒPPOç­‰ã€‚ 4.3.2 Temporal Difference method(æ—¶é—´å·®åˆ†æ–¹æ³•) æ—¶é—´å·®åˆ†æ–¹æ³•ï¼šåœ¨æ¯ä¸€æ­¥åŠ¨ä½œæ‰§è¡Œéƒ½å¯ä»¥é€šè¿‡è‡ªä¸¾æ³•(Bootstrapping)(ä¼°è®¡å€¼)åŠæ—¶æ›´æ–°ã€‚ å¸¸è§ç®—æ³•æœ‰ï¼šDDPGï¼ŒQ-learningï¼ŒDQNç­‰ã€‚ ","date":"2023-07-14","objectID":"/posts/rl_introduction/:4:3","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["RL"],"content":"å‚è€ƒ [1]. https://blog.csdn.net/b_b1949/article/details/128997146 [2]. https://blog.csdn.net/magicyangjay111/article/details/132645347 ","date":"2023-07-14","objectID":"/posts/rl_introduction/:5:0","tags":["RL"],"title":"RL | å¼ºåŒ–å­¦ä¹  -- ç®€ä»‹","uri":"/posts/rl_introduction/"},{"categories":["Distributed Computing"],"content":"1. æ¦‚è¿° åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶ä¸é›†åˆé€šä¿¡åº“çš„ç»„åˆæ„æˆäº†åˆ†å¸ƒå¼è®­ç»ƒçš„æ•´ä½“æœåŠ¡è½¯ä»¶æ ˆï¼Œåœ¨ç¬¬3ç¯‡ã€ç¬¬4ç¯‡æ–‡ç« é‡Œå·²ç»å‰–æå®Œé›†åˆé€šä¿¡çš„ç›¸å…³å†…å®¹ï¼Œè€Œæœ¬æ–‡ä¼šä»¥Horovodä¸ºä¾‹ä»‹ç»æ•°æ®å¹¶è¡Œä¸‹åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶çš„åŸºæœ¬åŸç†ä»¥åŠè¿›è¡Œæ¶æ„è§£æã€‚å½“å‰ï¼Œåœ¨åˆ†å¸ƒå¼è®­ç»ƒé‡Œåˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶éœ€è¦è§£å†³ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒé—®é¢˜ ï¼š è®¡ç®—ä¸é€šä¿¡åŒæ­¥è€¦åˆé—®é¢˜ï¼šå¦‚æœåå‘ä¼ æ’­ä¸€äº§ç”Ÿä¸€ä»½æ¢¯åº¦ï¼Œå°±é©¬ä¸Šå¯¹å…¶è°ƒç”¨å…¨å±€AllReduceï¼Œè®¡ç®—ä¸é€šä¿¡åŒæ­¥è€¦åˆï¼Œå®¹æ˜“é€ æˆæ­»é”åŒæ—¶æ€§èƒ½ä¹Ÿä¼šå¾ˆä¸å¦‚æ„ï¼› è®¡ç®—æ—¶é—´ä¸é€šä¿¡æ—¶é—´ä¸²è¡Œé—®é¢˜ï¼šç¥ç»ç½‘ç»œæ˜¯åˆ†å±‚çš„ï¼Œæ¢¯åº¦è®¡ç®—çš„è¿‡ç¨‹æ˜¯æ•°æ®åŠ è½½ï¼Œç„¶åå‰å‘ä¼ æ’­ç®—å‡ºæŸå¤±å€¼ï¼Œå†åå‘ä¼ æ’­ç®—å‡ºæ¢¯åº¦ï¼Œè€Œåå‘è®¡ç®—æ—¶æ¢¯åº¦æ˜¯ä»è¾“å‡ºå±‚å¾€è¾“å…¥å±‚æ–¹å‘ä¸€å±‚ä¸€å±‚äº§ç”Ÿçš„ï¼Œåœ¨æœ‰äº›æ¨¡å‹é‡Œï¼Œå¦‚æœéœ€è¦ç­‰æ‰€æœ‰çš„æ¢¯åº¦éƒ½è®¡ç®—å®Œæ¯•æ‰èƒ½è§¦å‘å…¨å±€AllReduceï¼Œé‚£ä¹ˆå¯¹æ€§èƒ½çš„å½±å“ä¹Ÿä¼šå¾ˆå¤§ï¼› æ¢¯åº¦ç”Ÿæˆçš„è½åè€…é—®é¢˜ï¼šé›†ç¾¤å†…æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹çš„åŒä¸€ä»½æ¢¯åº¦çš„äº§ç”Ÿä¸ä¸€å®šéƒ½æ˜¯åŒä¸€æ—¶åˆ»çš„ï¼Œå¦‚æœæ¢¯åº¦æ²¡æœ‰å…¨éƒ¨ç”Ÿæˆå°±å‘èµ·å¯¹è¿™ä¸ªæ¢¯åº¦çš„å…¨å±€è§„çº¦ï¼Œå¦åˆ™å®¹æ˜“é€ æˆè®­ç»ƒå‡ºæ¥çš„æ¨¡å‹ç²¾åº¦ä¸è¾¾æ ‡æˆ–è€…ä¸æ”¶æ•›çš„é—®é¢˜ï¼› æ¢¯åº¦èåˆé—®é¢˜ï¼šå¦‚æœæ¯ä¸€ä»½æ¢¯åº¦éƒ½è§¦å‘ä¸€æ¬¡å…¨å±€AllReduceï¼Œåœ¨æ¢¯åº¦Tensorè¾ƒå¤šçš„ç¥ç»ç½‘ç»œè®­ç»ƒé‡Œï¼Œæ•´ä½“çš„è®­ç»ƒç³»ç»Ÿæ€§èƒ½ä¼šå˜å¾—æä½ï¼› æ˜“ç”¨æ€§é—®é¢˜ï¼šä»TensorFlowï¼ŒPyTorchè¿ç§»è¿‡æ¥éœ€è¦æ”¹çš„ä»£ç éœ€è¦æå°‘ï¼Œä»å•å¡è®­ç»ƒè¿ç§»åˆ°å¤šå¡è®­ç»ƒéœ€è¦æ”¹åŠ¨çš„ä»£ç ä¹Ÿéœ€è¦æå°‘ï¼› å¯ç§»æ¤é—®é¢˜ï¼šæ”¯æŒå¤šç§å¤šæ ·çš„æ·±åº¦å­¦ä¹ è®­ç»ƒæ¡†æ¶ï¼Œæ¯”å¦‚ TensorFlowã€PyTorchã€MxNetç­‰ï¼Œä¹Ÿèƒ½æ”¯æŒå¤šç§å¤šæ ·çš„é€šä¿¡åº“ï¼Œæ¯”å¦‚openMPIã€NCCLã€Glooã€CCLã€RCCLç­‰ï¼› å¯é æ€§é—®é¢˜ï¼šåœ¨é›†ç¾¤è®­ç»ƒçš„è¿‡ç¨‹ä¸­ç½‘ç»œæ—¶ä¸å¯é çš„ã€è®¡ç®—å¡æ˜¯ä¼šå‡ºæ•…éšœçš„ã€æœåŠ¡å™¨æ˜¯ä¼šå‡ºæ•…éšœçš„ã€ç³»ç»Ÿè½¯ä»¶ä¹Ÿæ˜¯ä¼šå‡ºBugçš„ï¼Œè¿™äº›å› ç´ é€ æˆäº†åˆ†å¸ƒå¼è®­ç»ƒè¿‡ç¨‹ä¸­è¿˜å­˜åœ¨å¯é æ€§é—®é¢˜ï¼Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿæ˜¯ä¸€ä¸ªéš¾é¢˜ã€‚ è½¯ä»¶æ˜¯ç”±äººå®ç°çš„ï¼Œè§£æä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿæœ€éš¾çš„åœ°æ–¹åœ¨äºä»åºæ‚çš„ä»£ç é‡Œå€’æ¨å‡ºèƒŒåå®ç°å®ƒçš„äººçš„è®¾è®¡æ„å›¾ï¼Œä¸ºäº†æ›´å¥½çš„ç†è§£Horovodï¼Œæœ¬æ–‡ä¼šåŸºäºä»¥ä¸Šè¿™å‡ ä¸ªåˆ†å¸ƒå¼è®­ç»ƒçš„æ ¸å¿ƒé—®é¢˜ï¼Œä»¥Horovodä¸ºä¾‹ä»‹ç»åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶çš„åŸºæœ¬åŸç†ä»¥åŠè¿›è¡Œæ¶æ„è§£æã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:1:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"2. åŸºç¡€çŸ¥è¯† ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:2:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"2.1 å•å¡è®­ç»ƒ ç¥ç»ç½‘ç»œçš„è®­ç»ƒï¼Œæœ¬è´¨ä¸Šå°±æ˜¯Y=F(x)çš„è¿­ä»£ï¼Œé€šè¿‡åå¤è¾“å…¥Xã€è¾“å‡ºYï¼Œä½¿å¾—ç¥ç»ç½‘ç»œçš„å‚æ•°å˜åŒ–ä¸è¾“å…¥è¾“å‡ºé—´çš„å¤æ‚å…³ç³»æ‹Ÿåˆã€‚åœ¨ç¥ç»ç½‘ç»œè®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡è¾“å…¥æ•°æ®åˆ©ç”¨æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•è¿›è¡Œè¿­ä»£ä»è€Œä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°ï¼Œå¹¶æœ€ç»ˆè¾“å‡ºç¥ç»ç½‘ç»œæ¨¡å‹ã€‚è€Œç¥ç»ç½‘ç»œå¯ä»¥çœ‹ä½œä¸€ç§è¿ç®—æ¨¡å‹ï¼Œå…¶ç”±å¤§é‡çš„ç¥ç»å…ƒï¼ˆèŠ‚ç‚¹ï¼‰ç›¸äº’è”æ¥æ„æˆï¼Œå…¶ç”±è¾“å…¥å±‚ã€éšè—å±‚ä»¥åŠè¾“å‡ºå±‚ç»„åˆè€Œæˆï¼ˆå¦‚ä¸‹å›¾å·¦ä¾§æ‰€ç¤ºï¼‰ã€‚ç¥ç»å…ƒ(neuron)æ˜¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬è®¡ç®—å•å…ƒï¼Œä¹Ÿè¢«ç§°ä½œèŠ‚ç‚¹(node)ï¼Œå®ƒå¯ä»¥æ¥å—æ¥è‡ªå…¶ä»–ç¥ç»å…ƒæˆ–å¤–éƒ¨æ•°æ®çš„è¾“å…¥ï¼Œç„¶åè®¡ç®—å‡ºä¸€ä¸ªè¾“å‡ºï¼ˆå¦‚ä¸‹å›¾å³ä¸Šè§’æ‰€ç¤ºï¼‰ã€‚ å¦‚ä¸Šå›¾å³ä¸‹è§’æ‰€ç¤ºï¼Œåœ¨å•å¡è®­ç»ƒè¿­ä»£ä¸­ï¼ŒåŸºäºå¹¶è¡Œæ¢¯åº¦ä¸‹é™æ³•ï¼Œä¼šæœ‰ä»¥ä¸‹æ“ä½œï¼š ç¬¬ä¸€æ­¥ï¼Œè¯»å–éƒ¨åˆ†æ•°æ®ï¼Œå¹¶ä¸”å°†æ•°æ®åŠ è½½è¿›è®­ç»ƒå¡çš„å­˜å‚¨ç©ºé—´ï¼› ç¬¬äºŒæ­¥ï¼Œå¯¹æ¨¡å‹è¿›è¡Œå‰å‘ä¼ æ’­è®¡ç®—ï¼Œä»è¾“å…¥å±‚å¾€è¾“å‡ºå±‚ä¸€å±‚ä¸€å±‚çš„è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°æŸå¤±å·®LOSSï¼› ç¬¬ä¸‰æ­¥ï¼Œå¯¹æ¨¡å‹è¿›è¡Œåå‘ä¼ æ’­è®¡ç®—ï¼Œä»è¾“å‡ºå±‚å¾€è¾“å…¥å±‚ä¸€å±‚ä¸€å±‚çš„è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°æ¢¯åº¦å€¼ï¼Œæ³¨æ„è¿™ä¸€æ­¥ä¼šæŠŠæ¯ä¸€å±‚éƒ½è®¡ç®—å‡ºä¸€ä¸ªæ¢¯åº¦å¼ é‡ï¼ˆGradient Tensorï¼‰å‡ºæ¥ï¼› ç¬¬å››æ­¥ï¼Œå°†æ–°çš„åˆ°çš„æ¢¯åº¦ä¸éƒ¨åˆ†æ•°æ® ä½œä¸ºæ–°çš„è¾“å…¥ï¼Œé‡æ–°å¼€å§‹ä»¥ä¸Šæ­¥éª¤çš„è¿­ä»£ã€‚ åœ¨è¿™ä¸€æ­¥é‡Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸æ€§èƒ½ä¼˜åŒ–ç›¸å…³çš„ä¿¡æ¯æ˜¯åå‘ä¼ æ’­æ˜¯æ¯ä¸€å±‚è¾“å‡ºä¸€ä¸ªæ¢¯åº¦å¼ é‡ï¼Œä»¥åŠåå‘ä¼ æ’­æ˜¯ä»è¾“å‡ºå±‚å¾€è¾“å…¥å±‚ä¸€å±‚ä¸€å±‚çš„è¿›è¡Œè®¡ç®—çš„ï¼Œè¿™ä¸€ç‚¹ä¿¡æ¯å¯ä»¥ç”¨é€šä¿¡éšè—æ€§èƒ½ä¼˜åŒ–ä¸æ¢¯åº¦èåˆä¼˜åŒ–ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:2:1","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"2.2 å¤šå¡è®­ç»ƒ ä»¥æ•°æ®å¹¶è¡Œéšæœºæ¢¯åº¦ä¸‹é™æ³•( SGD )ä¸ºä¾‹ï¼Œå¤šå¡ç¥ç»ç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹å›¾ï¼Œä¸å•å¡è®­ç»ƒç›¸æ¯”ï¼Œå¤šå¡è®­ç»ƒå¤šäº†æ¢¯åº¦å…¨å±€è§„çº¦çš„è¿‡ç¨‹ï¼š ç¬¬ä¸€æ­¥ï¼Œé€šè¿‡Broadcastæ“ä½œå°†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å‚æ•°åŒæ­¥åˆ°é›†ç¾¤å†…çš„æ‰€æœ‰çš„è®­ç»ƒå¡ä¸Šï¼Œä¿è¯æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹çš„åˆå§‹å‚æ•°æ˜¯ä¸€è‡´çš„ï¼ŒåŒæ—¶è®­ç»ƒè„šæœ¬åœ¨å¤šä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œæ¯ä¸ªè®¡ç®—èŠ‚ç‚¹åŒ…å«äº†æ•´ä½“çš„æ¨¡å‹å‚æ•°ï¼› ç¬¬äºŒæ­¥ï¼Œå°†æ•°æ®æ ·æœ¬åˆ‡ç‰‡åˆ†å‘åˆ°æ•´ä¸ªé›†ç¾¤å†…çš„ä¸ªè®¡ç®—èŠ‚ç‚¹ï¼ˆè®­ç»ƒå¡ï¼‰ä¸Šå¹¶ä¸”é€šè¿‡æ•°æ®æµæ°´æŠ€æœ¯å°†æ•°æ®æ ·æœ¬åŠ è½½è¿›è®­ç»ƒå¡çš„é«˜é€Ÿå†…å­˜ç©ºé—´å†…ï¼Œä½œä¸ºè¾“å…¥X; ç¬¬ä¸‰æ­¥ï¼Œæ¯ä¸ªè®­ç»ƒå¡åœ¨å…¶æ•°æ®æ ·æœ¬ä¸Šè¿è¡Œå‰å‘ä¼ æ’­ï¼Œè®¡ç®—å‡ºæŸå¤±å·®LOSSiï¼› ç¬¬å››æ­¥ï¼Œå¯¹è®¡ç®—å‡ºçš„LOSSiè¿›è¡Œåå‘ä¼ æ’­ï¼Œå¾—åˆ°æ¢¯åº¦GRADiï¼Œè¿™ä¸€æ­¥ä¹Ÿéœ€è¦æ³¨æ„å¾—æ˜¯æ¯ä¸€å±‚éƒ½ä¼šè®¡ç®—å‡ºä¸€ä¸ªæ¢¯åº¦ï¼ŒåŒæ—¶æ¢¯åº¦æ˜¯ä»¥è¾“å‡ºçš„Tensoræ¥è¡¨ç¤ºçš„ï¼› ç¬¬äº”æ­¥ï¼Œæ‰€æœ‰çš„è®­ç»ƒå¡è®¡ç®—å‡ºæ¥çš„éƒ¨åˆ†æ¢¯åº¦ï¼Œåœ¨ä¸»æœºå†…åŠä¸»æœºä¹‹é—´é€šè¿‡é›†åˆé€šä¿¡è¿›è¡Œå…¨å±€å½’çº¦(AllReduce)å¾—åˆ°å…¨å±€æ¢¯åº¦ï¼› ç¬¬å…­æ­¥ï¼Œæœ€åå†å°†è¿™ä¸ªå…¨å±€æ¢¯åº¦ä½œä¸ºå‚æ•°è¿›è¡Œæ›´æ–°ï¼Œå†è¿›è¡Œä»¥ä¸Š2-5æ­¥éª¤çš„è¿­ä»£ä»è€Œè·å¾—æ–°çš„æ¢¯åº¦ã€‚ ä»¥ä¸Š2-6æ­¥éª¤å°±æ˜¯å¤šå¡å¹¶è¡Œæ¢¯åº¦ä¸‹é™çš„åŸºæœ¬æ€æƒ³ï¼Œå³å¤šä¸ªè®¡ç®—èŠ‚ç‚¹é€šè¿‡åˆ†ç‰‡çš„æ•°æ®æ ·æœ¬è¿›è¡Œæ¢¯åº¦è®¡ç®—ï¼Œå¾—åˆ°åˆ†åŒºæ¢¯åº¦åï¼Œå†é€šè¿‡å…¨å±€æ¢¯åº¦è§„çº¦ä»¥åŠå°†è¿™ä¸ªèšåˆå¥½çš„æ¢¯åº¦ä½œä¸ºæ–°çš„å‚æ•°è¿›è¡Œæ›´æ–°ï¼Œä»è€Œå®ç°å¹¶è¡Œæ¢¯åº¦ä¸‹é™ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:2:2","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"3. å‡ ä¸ªæ ¸å¿ƒé—®é¢˜ åœ¨æœ¬ç« èŠ‚é‡Œä¼šè§£è¯»æœ¬æ–‡æ¦‚è¿°é‡Œæåˆ°çš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶éœ€è¦è§£å†³çš„å‡ ä¸ªä¸æ€§èƒ½ã€æ˜“ç”¨æ€§ç­‰ç›¸å…³çš„å‡ ä¸ªæ ¸å¿ƒé—®é¢˜ï¼Œå¹¶ä¸”ä»¥Horovodä¸ºä¾‹è®²è¿°Horovodæ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªå‡ ä¸ªéš¾é¢˜çš„ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:3:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"3.1 è®¡ç®—ä¸é€šä¿¡è§£è€¦ åœ¨ç¥ç»ç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€ç¥ç»ç½‘ç»œå±‚éƒ½ä¼šè®¡ç®—å‡ºä¸€ä¸ªæ¢¯åº¦ï¼ŒåŒæ—¶æ¢¯åº¦æ˜¯ä»¥è¾“å‡ºTensoræ¥è¡¨ç¤ºçš„ï¼Œå¦‚æœåå‘ä¼ æ’­ä¸€è®¡ç®—å‡ºä¸€ä¸ªæ¢¯åº¦å°±é©¬ä¸Šè°ƒç”¨é€šä¿¡å»åšæ¢¯åº¦è§„çº¦ï¼Œå°†è®¡ç®—ä¸é€šä¿¡åŒæ­¥è€¦åˆï¼Œé‚£ä¹ˆæ•´ä½“çš„æ€§èƒ½çš„è¡¨ç°å°±ä¼šå¾ˆå·®ã€‚æ¯”å¦‚ä¸€ä¸ªResNet-50 v3çš„æ¢¯åº¦å¼ é‡ä¸ªæ•°æ˜¯153ä¸ªï¼Œå¦‚æœä¸€è®¡ç®—å‡ºä¸€ä¸ªæ¢¯åº¦å°±é©¬ä¸Šè¿›è¡Œé€šä¿¡ï¼Œå‡è®¾è®¡ç®—æ¢¯åº¦èŠ±äº†1msï¼Œé€šä¿¡è¿™ä¸ªæ¢¯åº¦èŠ±äº† 500msï¼Œé‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ 501msï¼Œæ€»ä½“ä¸Šå°±éœ€è¦501x153 = 76653msï¼Œå³è¿‘76.6sæ‰èƒ½å®Œæˆä¸€æ¬¡æ¢¯åº¦è¿­ä»£ã€‚è€Œå°†è®¡ç®—ä¸é€šä¿¡è§£è€¦ï¼Œè®¡ç®—çš„å½’è®¡ç®—ï¼Œé€šä¿¡çš„å½’é€šä¿¡ï¼Œé€šè¿‡æ€§èƒ½ä¼˜åŒ–ç­–ç•¥å‡å°‘é€šä¿¡çš„æ¬¡æ•°ï¼Œæ—¢èƒ½æå‡æ•´ä½“è®­ç»ƒæ€§èƒ½ä¹Ÿèƒ½é¿å…æŸäº›æ­»é”é—®é¢˜ï¼Œæ¯”å¦‚è®¡ç®—æ¢¯åº¦grad içš„æ—¶å€™èŠ±äº†å¾ˆé•¿æ—¶é—´ï¼Œè€Œé€šä¿¡çº¿ç¨‹ä¸€ç›´åœ¨ç­‰å¾…è¿™ä¸ªæ¢¯åº¦ï¼Œè¡¨ç°å‡ºæ¥å°±æ˜¯æ­»é”ç°è±¡ã€‚ Horovodé‡‡ç”¨è®¡ç®—ä¸é€šä¿¡åˆ†ç¦»çš„è®¾è®¡æ€æƒ³ï¼Œè§£è€¦äº†è®¡ç®—è¿‡ç¨‹ä¸é€šä¿¡è¿‡ç¨‹ï¼Œä»è€Œæå‡äº†æ•´ä½“è®­ç»ƒçš„æ€§èƒ½ä¸å¯é æ€§ã€‚å¦‚ä¸‹å›¾çš„Horovodé€»è¾‘æ¶æ„å›¾æ‰€ç¤ºï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºHorovodè§£è€¦äº†è®¡ç®—ä¸é€šä¿¡ï¼Œå…¶å°†æ¡†æ¶å±‚è®¡ç®—å‡ºæ¥çš„æ¢¯åº¦requestä¿¡æ¯push åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—message_queueé‡Œï¼ŒåŒæ—¶å°†æ¢¯åº¦ä¿¡æ¯pushåˆ°ä¸€ä¸ªTensor_tableé‡Œï¼Œå†é€šè¿‡æ§åˆ¶å±‚åœ¨åå°èµ·ä¸€ä¸ªloopçº¿ç¨‹ï¼Œå‘¨æœŸæ€§çš„ä»æ¶ˆæ¯é˜Ÿåˆ—é‡Œè¯»å–æ¢¯åº¦æ¶ˆæ¯ï¼Œåœ¨æ§åˆ¶å±‚é›†ç¾¤çš„èŠ‚ç‚¹ä¹‹é—´åå•†è¾¾æˆä¸€è‡´åï¼Œå†è¿›è¡Œæ¶ˆæ¯åˆ†å‘è§¦å‘è®­ç»ƒè¡Œä¸ºã€‚ å¦‚ä¸Šå›¾å¯çœ‹å‡ºï¼ŒHorovodä»ä¸‹åˆ°ä¸Šåˆ†ä¸º7å±‚ï¼šç‰©ç†å±‚ã€é“¾è·¯å±‚ã€æ•°æ®ä¼ è¾“å±‚ã€æ§åˆ¶å±‚ã€æ¶ˆæ¯å±‚ã€æ¡†æ¶å±‚ä»¥åŠç”¨æˆ·å±‚ã€‚æ¡†æ¶å±‚ï¼Œæ§åˆ¶å±‚ä»¥åŠæ•°æ®ä¼ è¾“å±‚ä½“ç°äº†Horovodçš„æ ¸å¿ƒè®¾è®¡ç†å¿µï¼Œå³ï¼šæ¡†æ¶å±‚ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰Opï¼Œä»¥æ’ä»¶çš„å½¢å¼hackè¿›æ¡†æ¶ï¼›åœ¨æ§åˆ¶å±‚ï¼ŒworkerèŠ‚ç‚¹ä¸masterèŠ‚ç‚¹ä¹‹é—´åå•†è¾¾æˆè§¦å‘è®­ç»ƒè¡Œä¸ºçš„çº¦å®šï¼›åœ¨æ•°æ®ä¼ è¾“å±‚ï¼ŒæœåŠ¡å™¨å†…ä»¥åŠæœåŠ¡å™¨ä¹‹é—´é‡‡ç”¨é›†åˆé€šä¿¡åº“ä¼ è¾“æ•°æ®ã€‚ æœ¬è´¨ä¸ŠHorovodçš„æ•´ä½“è®¾è®¡ç†å¿µä¹‹ä¸€éµå¾ªçš„æ˜¯ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åœ¨Horovodé‡Œæ¯ä¸ªè®¡ç®—èŠ‚ç‚¹éƒ½ä¼šæœ‰æœ‰ä¸¤ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼šExecution thread å’Œ Background thread ï¼š ç”Ÿäº§è€…Execution Thread æ˜¯ç”¨æ¥åšæ¢¯åº¦è®¡ç®—çš„ï¼Œåœ¨TensorFlowã€PyTorchä¹‹ç±»çš„ä¹‹ç±»çš„è®­ç»ƒæ¡†æ¶è®¡ç®—å‡ºæ¢¯åº¦Tensoråï¼Œå°†Tensor ä¿¡æ¯pushè¿›tenor_tableé˜Ÿåˆ—ï¼ŒåŒæ—¶å°†Tensorçš„requestä¿¡æ¯pushè¿›message_queueé˜Ÿåˆ—; æ¶ˆè´¹è€…Background thread æ˜¯åšé›†åˆé€šè®¯ä»¥åŠå…¨å±€Allreduceçš„ï¼Œåå°çº¿ç¨‹ä¼šæ¯éš”ä¸€æ®µæ—¶é—´è½®è¯¢æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ‹¿åˆ°ä¸€æ‰¹Tensorä¿¡æ¯ä¹‹åï¼Œä¼šè¿›è¡Œç›¸åº”çš„æ“ä½œã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:3:1","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"3.2 é€šä¿¡éšè— ç¥ç»ç½‘ç»œæ˜¯åˆ†å±‚çš„ï¼Œåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œå…ˆæ˜¯æ•°æ®åŠ è½½ï¼Œç„¶åå‰å‘ä¼ æ’­ç®—å‡ºLOSSï¼Œå†åå‘ä¼ æ’­ç®—å‡ºæ¢¯åº¦ï¼Œè€Œåå‘è®¡ç®—æ—¶æ¢¯åº¦æ˜¯ä»è¾“å‡ºå±‚å¾€è¾“å…¥å±‚æ–¹å‘ä¸€å±‚ä¸€å±‚äº§ç”Ÿçš„ï¼Œå¦‚æœéœ€è¦ç­‰æ‰€æœ‰çš„æ¢¯åº¦éƒ½è®¡ç®—å®Œæ¯•æ‰èƒ½è§¦å‘å…¨å±€AllReduceï¼Œå¯¹æ€§èƒ½ä¸æ˜¯å¾ˆå‹å¥½ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè®¡ç®—æ—¶é—´ä¸é€šä¿¡æ—¶é—´æ˜¯ä¸²è¡Œçš„ï¼Œå¦‚æœèƒ½å°†å…¨å±€æ¢¯åº¦è§„çº¦çš„é€šä¿¡æ—¶é—´ä¸è®¡ç®—æ—¶é—´æƒ³åŠæ³•å¹¶è¡Œèµ·æ¥ï¼Œå°†é€šä¿¡æ—¶é—´éšè—åœ¨è®¡ç®—æ—¶é—´ä¹‹å†…ï¼Œé‚£ä¹ˆå°±èƒ½èŠ‚çº¦æ¢¯åº¦çš„è®­ç»ƒæ—¶é—´ä»è€Œæå‡åˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿæ•´ä½“çš„è®­ç»ƒæ€§èƒ½ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå°†è®¡ç®—å‡ºæ¥çš„æ¢¯åº¦è¿›è¡Œåˆ†æ¡¶è§¦å‘å¼‚æ­¥Allreduceï¼Œä¸€è¾¹åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦ï¼Œä¸€è¾¹åšéƒ¨åˆ†æ¢¯åº¦çš„å…¨å±€è§„çº¦é€šä¿¡ï¼Œä»è€Œè¾¾åˆ°å°†é€šä¿¡æ—¶é—´éšè—åœ¨è®¡ç®—æ—¶é—´å†…çš„æ•ˆæœã€‚è€ŒHorovodä¸ºè¾¾æˆè¿™ä¸€æ•ˆæœï¼ŒBackground thread ä¼šæ¯éš”ä¸€æ®µæ—¶é—´è½®è¯¢æ¢¯åº¦æ¶ˆæ¯é˜Ÿåˆ—é‡Œçš„æ¢¯åº¦ä¿¡æ¯ï¼Œè·å–äº†å¯ä»¥è¿‡å…¨å±€è§„çº¦çš„æ¢¯åº¦åï¼Œå°±è¿›è¡Œå…¨å±€è§„çº¦æ“ä½œï¼Œè€Œè¿™ä¸ªæ—¶é—´å…¶ä»–çš„æ¢¯åº¦è¿˜åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡è°ƒæ•´è½®è¯¢çš„æ—¶é—´é—´éš”ä»è€Œè¾¾åˆ°è°ƒæ•´æ¢¯åº¦åˆ†æ¡¶çš„æ•ˆæœã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:3:2","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"3.3 æ¢¯åº¦åå•† ç¥ç»ç½‘ç»œçš„æ¯ä¸€å±‚å¯¹åº”ä¸€ä¸ªæ¢¯åº¦Tensorï¼Œåœ¨åˆ†å¸ƒå¼è®­ç»ƒé›†ç¾¤é‡Œæ¯å¼ è®­ç»ƒå¡å¯¹åŒä¸€ä»½æ¢¯åº¦è®¡ç®—äº§ç”Ÿçš„æ—¶é—´æ˜¯æœ‰å·®å¼‚çš„ï¼Œå½“é›†ç¾¤å†…æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹çš„åŒä¸€ç¥ç»ç½‘ç»œå±‚çš„åŒä¸€æ¢¯åº¦éƒ½äº§ç”Ÿæ—¶ï¼Œæ‰èƒ½å‘èµ·å¯¹è¿™ä¸ªæ¢¯åº¦çš„å…¨å±€AllReduceè§„çº¦ï¼Œå¦åˆ™å®¹æ˜“é€ æˆä¸¢æ¢¯åº¦ï¼Œè®­ç»ƒå‡ºæ¥æ¨¡å‹ç²¾åº¦ä¸è¾¾æ ‡æˆ–è€…æ¨¡å‹ä¸æ”¶æ•›ã€‚æ¯”å¦‚åœ¨ä¸€ä¸ª128å¡çš„è®­ç»ƒé›†ç¾¤é‡Œï¼ŒåŒä¸€ä»½æ¢¯åº¦æ˜¯å¯¹åº”åŒä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹é‡Œçš„åŒä¸€å±‚ç¥ç»ç½‘ç»œçš„ï¼Œåªæœ‰æ¯å¼ è®­ç»ƒå¡ä¸Šéƒ½è®¡ç®—å‡ºäº†åŒä¸€å±‚ç¥ç»ç½‘ç»œçš„æ¢¯åº¦ æ‰èƒ½å¯¹è¿™ä¸€å±‚ç¥ç»ç½‘ç»œçš„æ¢¯åº¦è¿›è¡Œå…¨å±€è§„çº¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Horovodè®¾è®¡äº†ä¸€ç§æ¢¯åº¦çŠ¶æ€åå•†æœºåˆ¶ï¼Œå®ƒå°† è®¡ç®—èŠ‚ç‚¹Rank0 ä½œä¸ºcoordinatorï¼ˆmasterï¼‰ï¼Œå…¶ä½™çš„rank1-NèŠ‚ç‚¹è¿›ç¨‹ä¸ºworkerï¼Œç”±coordinatoræ¥åå•†ç¡®å®šåŒä¸€ä»½æ¢¯åº¦æ˜¯å¦åœ¨æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šéƒ½å·²ç»è®¡ç®—å‡ºæ¥ï¼Œåªæœ‰åœ¨æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šéƒ½è®¡ç®—å‡ºæ¥çš„åŒä¸€æ¢¯åº¦æ‰å¯ä»¥è¿›è¡Œå…¨å±€è§„çº¦æ“ä½œã€‚åœ¨Horovodé‡Œæ¯ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šéƒ½æœ‰ä¸€ä¸ªmessage_queueä»¥åŠtensor_tableï¼Œè€Œåœ¨coordinatorèŠ‚ç‚¹ä¸Šé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªmessage_tableç”¨äºä¿å­˜å¯ä»¥è¿›è¡Œå…¨å±€Allreduceçš„æ¢¯åº¦è¯·æ±‚æ¬¡æ•°ä¿¡æ¯ã€‚Horovod æ§åˆ¶é¢çš„ComputeResponseList å‡½æ•°é‡Œå®ç°äº†è¿™ä¸€æ¢¯åº¦çš„åå•†è¿‡ç¨‹ï¼Œåœ¨ä»message_queueè·å–äº†æœ¬èŠ‚ç‚¹ç”Ÿæˆçš„æ¢¯åº¦ä¿¡æ¯åï¼Œcoordinatorä¼šä¸å…¶ä»–èŠ‚ç‚¹åå•†è¿™ä¸ªæ¢¯åº¦æ˜¯å¦éƒ½è®¡ç®—å‡ºæ¥ï¼Œè¿™ä¸€è¿‡ç¨‹æ˜¯é˜»å¡è¿›è¡Œçš„ï¼Œè¿™ä¸ªåå•†è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š ä¸€ä¸ªæ¢¯åº¦æ˜¯å¦èƒ½æ»¡è¶³å…¨å±€è§„çº¦AllReduceçš„åå•†è¿‡ç¨‹å¦‚ä¸‹ï¼š é¦–å…ˆï¼Œé›†ç¾¤å†…çš„æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹è¿›ç¨‹éƒ½ä¼šå¾€coordinator Rank0å‘é€ä¸€ä¸ª tensorçš„è¯·æ±‚requestï¼Œè¡¨ç¤ºè¯´æœ¬èŠ‚ç‚¹è¿™ä¸€å±‚ç¥ç»ç½‘ç»œçš„æ¢¯åº¦å·²ç»ç”Ÿæˆï¼Œæ¯”å¦‚tensor1ï¼Œæ¯ä¸ªrankéƒ½ä¼šå¾€rank0 å‘é€ä¸€ä¸ªæœ¬æ¢¯åº¦tensor1å·²ç»è®¡ç®—å‡ºæ¥çš„è¯·æ±‚ä¿¡æ¯ï¼› ç¬¬äºŒæ­¥ï¼Œcoordinatoræ¥æ”¶åˆ°èŠ‚ç‚¹çš„æ¢¯åº¦åå•†è¯·æ±‚åï¼ˆåŒ…æ‹¬æœ¬èŠ‚ç‚¹ï¼‰ï¼Œä¼šæŠŠæ”¶åˆ°çš„tensorè¯·æ±‚æ¬¡æ•°è¿›è¡Œç´¯åŠ ï¼Œå¹¶å°†è¿™ä¸ªä¿¡æ¯è®°å½•åœ¨message_tableé‡Œï¼Œå½“è¿™ä¸ªæ¢¯åº¦çš„è¯·æ±‚ä¿¡æ¯è¾¾åˆ°é›†ç¾¤å†…èŠ‚ç‚¹çš„ä¸ªæ•°æ—¶ï¼Œæ¯”å¦‚åœ¨Nä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ï¼Œä¸€ä¸ªç¥ç»ç½‘ç»œå±‚çš„æ¢¯åº¦tensorçš„é€šä¿¡è¯·æ±‚å‡ºç°äº†Næ¬¡ï¼Œé‚£å°±è¡¨ç¤ºåœ¨æœ¬é›†ç¾¤é‡Œæ‰€æœ‰çš„è®¡ç®—èŠ‚ç‚¹éƒ½å·²ç»å‘å‡ºäº†å¯¹è¯¥æ¢¯åº¦tensorçš„é€šä¿¡requestï¼Œè¿™å°±è¡¨æ˜è¿™ä¸ªæ¢¯åº¦tensoræ˜¯ç¬¦åˆå…¨å±€è§„çº¦è¦æ±‚çš„ï¼Œå°±èƒ½è¿›è¡Œé›†åˆé€šä¿¡å…¨å±€è§„çº¦ï¼Œä¸ç¬¦åˆè¦æ±‚çš„æ¢¯åº¦tensorå°†ç»§ç»­ç•™åœ¨message_tableä¸­ï¼Œç›´åˆ°æ¡ä»¶ç¬¦åˆä¸ºæ­¢ï¼› ç¬¬ä¸‰æ­¥ï¼Œå†æ¥ç€coordinatorä¼šå°†æ»¡è¶³å…¨å±€allreduceè§„çº¦æ¡ä»¶çš„æ¢¯åº¦Tensoré€šè¿‡responseè¿”å›ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œå‘Šè¯‰å…¶ä»–èŠ‚ç‚¹è¿™ä¸ªæ¢¯åº¦å¯ä»¥å¯åŠ¨å…¨å±€è§„çº¦AllReduceã€‚ ç»è¿‡è¿™å‡ æ­¥çš„åå•†è¾¾æˆæ¢¯åº¦å…¨å±€çŠ¶æ€ä¸€è‡´çš„ç›®çš„ï¼Œä»è€Œé¿å…æ¢¯åº¦ä¸¢å¤±é€ æˆçš„æ¨¡å‹ç²¾åº¦ä¸è¾¾æ ‡ã€ä¸æ”¶æ•›æˆ–è€…è¿›ç¨‹æ­»é”é—®é¢˜ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:3:3","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"3.4 æ¢¯åº¦èåˆ ç¥ç»ç½‘ç»œçš„æ¯ä¸€å±‚éƒ½èƒ½å¯¹åº”ä¸€ä¸ªæ¢¯åº¦ï¼Œå‡è®¾æ¯ç”Ÿæˆä¸€ä¸ªæ¢¯åº¦å°±è¿›è¡Œä¸€æ¬¡å…¨å±€è§„çº¦æ—¶ï¼Œ100ä¸ªæ¢¯åº¦å°±éœ€è¦è¿›è¡Œ100æ¬¡å…¨å±€é€šä¿¡100æ¬¡å…¨å±€è§„çº¦ï¼Œè€Œé€šä¿¡å¯¹è®­ç»ƒçš„æ€§èƒ½æœ‰å·¨å¤§çš„å½±å“ï¼Œè¿™ç§æƒ…å†µè¡¨ç°å‡ºæ¥çš„æ•ˆæœå°±æ˜¯åˆ†å¸ƒå¼è®­ç»ƒé›†ç¾¤çš„æ•´ä½“æ€§èƒ½æå·®ã€‚é€šè¿‡æ¢¯åº¦èåˆè®¡ç®—å°†å¤šä¸ªæ¢¯åº¦åˆæˆä¸€ä¸ªï¼Œä»è€Œå‡å°‘å…¨å±€è§„çº¦çš„æ¬¡æ•°èƒ½å¤§å¹…æé«˜åˆ†å¸ƒå¼è®­ç»ƒçš„è®­ç»ƒæ€§èƒ½ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå°†Nä¸ªå°æ¢¯åº¦Tensoråˆæˆä¸¤ä¸ªï¼Œèƒ½å°†å…¨å±€é€šä¿¡çš„æ¬¡æ•°å‡å°‘åˆ°2æ¬¡ï¼Œä»è€Œå¤§å¹…æå‡è®­ç»ƒæ€§èƒ½ï¼Œåœ¨Horovodé‡Œè¿™ä¸ªåŠŸèƒ½å¯¹TensorFusionç‰¹æ€§ã€‚ä½†è¿™ä¸ªç‰¹æ€§ä¹Ÿä¼šä¸3.2é€šä¿¡éšè—ç‰¹æ€§ç›¸å†²çªï¼Œéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œåˆç†çš„è°ƒè¯•ä¼˜åŒ–ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:3:4","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"3.5 æ˜“ç”¨æ€§ ä»TensorFlowï¼ŒPyTorchç­‰æ¡†æ¶è¿ç§»åˆ°Horovodéœ€è¦æ”¹çš„çš„ä»£ç æå°‘ï¼Œhorovodæ¥å…¥æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œä¸åŸç”Ÿè®­ç»ƒæ¡†æ¶å¯¹æ¯”ï¼Œä¸»è¦çš„åŒºåˆ«åœ¨äºï¼š 1ï¼Œåˆå§‹åŒ– Horovodï¼ŒåŒ…æ‹¬æœºå™¨èµ„æºçš„åˆ†é…ï¼š horovod.init() 2ï¼Œå‘æ¯ä¸ªè¿›ç¨‹åˆ†é…XPUèµ„æºï¼Œ å…¸å‹çš„è®¾ç½®æ˜¯ 1 ä¸ª XPU ä¸€ä¸ªè¿›ç¨‹ï¼Œå³è®¾ç½® local rankï¼š config.gpu_options.visible_device_list = str(hvd.local_rank()) 3ï¼Œå¯¹åŸä¼˜åŒ–å™¨è¿›è¡ŒåŒ…è£…ï¼Œåˆ†å¸ƒå¼ä¼˜åŒ–å™¨å°†æ¢¯åº¦è®¡ç®—å§”æ‰˜ç»™åŸå§‹ä¼˜åŒ–å™¨ï¼Œä½¿ç”¨allreduceæˆ–allgatherå¯¹æ¢¯åº¦æ±‚å¹³å‡ï¼Œç„¶ååº”ç”¨è¿™äº›å¹³å‡æ¢¯åº¦ï¼š opt=hvd.DistributedOptimizer(opt) 4ï¼Œ å°†åˆå§‹åŒ–å‚æ•°ä»rank 0å¹¿æ’­ç»™å…¶ä»–è¿›ç¨‹(rankè¡¨ç¤ºè¿›ç¨‹åºå·)ï¼Œå®ç°å‚æ•°çš„åˆå§‹åŒ–ï¼Œç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹çš„åˆå§‹åŒ–å‚æ•°ä¿æŒä¸€è‡´ï¼š hvd.BroadcastGlobalVariablesHook(0)ï¼š ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:3:5","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"3.6 å¯ç§»æ¤ å¯ç§»æ¤é—®é¢˜ï¼ŒHorovodé€šè¿‡ OPå’ŒOpKernelsçš„æ’ä»¶åŒ–æœºåˆ¶æ”¯æŒå¤šç§å¤šæ ·çš„æ·±åº¦å­¦ä¹ è®­ç»ƒæ¡†æ¶ï¼Œæ¯”å¦‚ TensorFlowã€PyTorchã€MxNetç­‰ã€‚åŸºäºçš„opKernelsçš„å¯å®šåˆ¶åŒ–æœºåˆ¶ï¼ŒHorovodè‡ªå®šä¹‰äº†Opç„¶åhackäº†æ•°æ®é“¾è·¯å±‚çš„é€šä¿¡åè®®ï¼Œä»è€Œè¾¾åˆ°åœ¨å¤šä¸ªæ·±åº¦å­¦ä¹ æ¡†æ¶ä¹‹é—´å¯ç§»æ¤ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:3:6","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"3.7 å¯é æ€§é—®é¢˜ åœ¨é›†ç¾¤è®­ç»ƒçš„è¿‡ç¨‹ä¸­ç½‘ç»œæ—¶ä¸å¯é çš„ã€è®¡ç®—å¡æ˜¯ä¼šå‡ºæ•…éšœçš„ã€æœåŠ¡å™¨æ˜¯ä¼šå‡ºæ•…éšœçš„çš„ï¼Œè¿™äº›å› ç´ é€ æˆäº†åˆ†å¸ƒå¼è®­ç»ƒè¿‡ç¨‹ä¸­éœ€è¦è€ƒè™‘è®­ç»ƒé›†ç¾¤çš„å¯é æ€§ï¼ŒHorovodç»“åˆé›†åˆé€šä¿¡åº“Glooå¯¹å¤–æä¾›äº†å¼¹æ€§è®­ç»ƒçš„ç‰¹æ€§ï¼Œä½†å¯é æ€§ä¸åªæ˜¯å¼¹æ€§è®­ç»ƒå°±èƒ½å®Œå…¨è§£å†³çš„ï¼Œå®ƒè¿˜æœ‰æ›´å¤šçš„ç³»ç»Ÿçº§çš„é—®é¢˜éœ€è¦è§£å†³ï¼Œå› æ­¤å¯é æ€§é—®é¢˜ç•™ç€ä¸€ä¸ªåç»­ç ”ç©¶é—®é¢˜ï¼Œä¸åœ¨æœ¬æ–‡é˜è¿°ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:3:7","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"4. ä¼˜ç‚¹ç¼ºç‚¹ã€æ”¹è¿›ç‚¹ ç®€å•æ˜“ç”¨ã€å¯ç§»æ¤ï¼Œå¹¶ä¸”æ”¯æŒå¼¹æ€§è®­ç»ƒæå‡äº†å¯é æ€§ï¼› ä¸ä¾èµ–äºæŸä¸ªæ¡†æ¶ï¼Œå…¶é€šè¿‡MPIæœºåˆ¶ç‹¬ç«‹å»ºç«‹äº†ä¸€å¥—åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡ç³»ç»Ÿï¼› å°†è®¡ç®—ä¸é€šä¿¡åˆ†ç¦»ï¼Œå®Œæˆäº†allreduceã€allgatherç­‰é›†åˆé€šä¿¡å·¥ä½œï¼Œå®ç°äº†è§„æ¨¡å¯æ‰©å±•ï¼› å·§å¦™çš„é€šè¿‡é—´éš”è½®è¯¢çš„æœºåˆ¶æ”¯æŒé€šä¿¡æ—¶é—´éšè—ï¼Œå¹¶ä¸”å®Œæˆäº†æ¢¯åº¦åå•†ä»è€Œä¿è¯è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹æ˜¯å¯æ”¶æ•›ã€ç²¾åº¦è¾¾æ ‡çš„ï¼› æ”¯æŒæ¢¯åº¦èåˆï¼Œæ”¯æŒå°†å°çš„tensoråˆå¹¶æˆä¸€ä¸ªå¤§çš„tensorå†è¿›è¡Œé€šä¿¡ä¼ é€’ï¼Œä»è€Œå‡å°é€šä¿¡æ“ä½œçš„é¢å¤–å¼€é”€ï¼› è‡ªå¸¦å‹ç¼©ç®—æ³•ï¼Œå¯ä»¥å‡å°‘é›†åˆé€šä¿¡çš„æ•°æ®é‡ï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:4:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"5. æ€è€ƒé¢˜ é—®é¢˜1ï¼Œå°†é€šä¿¡æ—¶é—´éšè—åœ¨è®¡ç®—æ—¶é—´å†…èƒ½æœ‰åŠ©äºæå‡è®­ç»ƒç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ï¼Œä½†è¿™ä¸€ç‰¹æ€§æ˜¯é’ˆå¯¹SIMTèŠ¯ç‰‡çš„æ¶æ„çš„è¿›è¡Œæ€§èƒ½ä¼˜åŒ–çš„ï¼Œå¦‚æœDSAèŠ¯ç‰‡ä¸èƒ½æ”¯æŒè¿™ä¸€ç‰¹æ€§ï¼Œé‚£åº”è¯¥å¦‚ä½•ä¼˜åŒ–Horovodä»è€Œå¤§å¹…æå‡æ•´ä½“çš„è®­ç»ƒæ€§èƒ½ï¼Ÿï¼ˆå¯ä»¥ç¡®å®šè¿™ä¸€å®šæ˜¯èƒ½åšåˆ°çš„ï¼‰ é—®é¢˜2ï¼Œæ¢¯åº¦åå•†çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªæ¢¯åº¦éƒ½éœ€è¦åå•†ä¸€æ¬¡ï¼Œåœ¨æ¢¯åº¦è¾ƒå¤šï¼Œç½‘ç»œè§„æ¨¡è¾ƒå¤§çš„é›†ç¾¤é‡Œï¼Œè¿™ä¸€ç‰¹æ€§ä¹Ÿä¼šå½±å“æ€§èƒ½ï¼Œå¦‚ä½•è¿›è¡Œä¼˜åŒ–æ‰èƒ½æœ‰æ•ˆæå‡Horovodæ€§èƒ½ï¼Ÿ\\ é—®é¢˜3ï¼Œä¸åŒçš„æ¨¡å‹å¯¹æ¢¯åº¦èåˆæœ‰ä¸åŒçš„è¦æ±‚ï¼Œé‚£ä¹ˆæ¢¯åº¦èåˆéœ€è¦èåˆåˆ°ä»€ä¹ˆç¨‹åº¦æ‰èƒ½æœ‰æ•ˆæå‡æ€§èƒ½ï¼Ÿ å¯ä»¥è¯´æ˜çš„æ˜¯ï¼Œè¿™ä¸‰ä¸ªé—®é¢˜è§£å†³åè¿˜èƒ½ç»§ç»­æå‡Horovodåœ¨DSAæ¶æ„èŠ¯ç‰‡ä¸Šçš„æ•´ä½“çš„åˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿçº§æ€§èƒ½ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:5:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"6. å°ç»“ æœ¬æ–‡ä»‹ç»äº†åˆ†å¸ƒå¼è®­ç»ƒçš„åŸºç¡€çŸ¥è¯†ä»¥åŠå‰–æäº†åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶æ‰€é¢ä¸´çš„å‡ ä¸ªæ ¸å¿ƒé—®é¢˜ï¼Œä»¥Horovodä¸ºä¾‹ä»è®¡ç®—ä¸é€šä¿¡è§£è€¦ã€é€šä¿¡éšè—ã€æ¢¯åº¦åå•†ã€æ¢¯åº¦èåˆã€æ˜“ç”¨æ€§ä»¥åŠå¯ç§»æ¤è¿™å‡ ä¸ªè§’åº¦å€’æ¨äº†åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶èƒŒåçš„è®¾è®¡æ„å›¾ï¼Œä»è€Œå¸®åŠ©å¤§å®¶èƒ½æ›´å¥½çš„ç†è§£åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶ã€‚ ref: [1] https://www.changping.me [2] https://horovod.ai [3] https://www.cnblogs.com/rossiXYZ/p/14910959.html [4] https://zhuanlan.zhihu.com/p/374575049 ","date":"2023-07-13","objectID":"/posts/distributedtraining_5/:6:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ - ç¬¬5ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒæœåŠ¡æ¡†æ¶åŸºæœ¬åŸç†ä¸æ¶æ„è§£æ","uri":"/posts/distributedtraining_5/"},{"categories":["Distributed Computing"],"content":"ref: [1]. https://www.changping.me/2022/04/10/ai-distributed-training-coll-topo/ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:0:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"1. æ¦‚è¿° åœ¨æ·±åº¦å­¦ä¹ çš„åˆ†å¸ƒå¼è®­ç»ƒé‡Œï¼ŒRing AllReduceæ‹“æ‰‘ç®—æ³•å¥ å®šäº†æ•°æ®å¹¶è¡Œè®­ç»ƒçš„é›†åˆé€šä¿¡åŸºç¡€ï¼Œä½†é›†åˆé€šä¿¡æ‹“æ‰‘ä¸åªæ˜¯ä»…æœ‰Ring Allreduceï¼Œç»å…¸çš„é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•è¿˜æœ‰2D-Ring/Hierarchical Ring AllReduceï¼Œhalving and doubling AllReduceï¼ŒButterfly AllReduceï¼Œ2D-Torus AllReduceï¼Œ2D-Mesh AllReduceï¼Œdouble binary treeç­‰ã€‚æ‹“æ‰‘ç®—æ³•å¾ˆå¤šï¼Œä½†ä¹Ÿä¸æ˜¯æ‰€æœ‰çš„æ‹“æ‰‘ç®—æ³•éƒ½èƒ½æ»¡è¶³å®é™…çš„ç”Ÿäº§éœ€æ±‚çš„ï¼Œè¿™éœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€å…·ä½“åœºæ™¯å…·ä½“è®¾è®¡ã€‚ é›†åˆé€šä¿¡çš„éš¾ç‚¹åœ¨äºéœ€è¦åœ¨å›ºå®šçš„ç½‘ç»œäº’è”ç»“æ„çš„çº¦æŸä¸‹è¿›è¡Œé«˜æ•ˆçš„é€šä¿¡ï¼Œé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•ä¸ç‰©ç†ç½‘ç»œäº’è”ç»“æ„å¼ºç›¸å…³ï¼Œä¸ºäº†å‘æŒ¥ç½‘ç»œé€šä¿¡çš„æ•ˆç‡ï¼Œä¹Ÿä¸æ˜¯è¯´å°±èƒ½éšæ„å‘æŒ¥é€šä¿¡æ‹“æ‰‘ç®—æ³•ï¼Œæ›´å¤šçš„æ˜¯åœ¨æ•ˆç‡ä¸æˆæœ¬ã€å¸¦å®½ä¸æ—¶å»¶ã€å®¢æˆ·è¦æ±‚ä¸è´¨é‡ã€åˆ›æ–°ä¸äº§å“åŒ–ç­‰ä¹‹é—´è¿›è¡Œåˆç†å–èˆã€‚ å……åˆ†å‘æŒ¥è®­ç»ƒåŠ é€Ÿå¡ä¸ç½‘ç»œçš„æ•ˆç‡æ˜¯é€šä¿¡æ‹“æ‰‘ç®—æ³•çš„åˆè¡·ï¼Œä½†é™¤äº†è®¾è®¡é«˜æ•ˆçš„é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•å¤–ï¼Œåˆ†å¸ƒå¼è®­ç»ƒä¸­éœ€è¦è§£å†³çš„é€šä¿¡éš¾é¢˜è¿˜æœ‰ï¼šç½‘ç»œæ˜¯å¼‚æ„çš„ï¼Œç½‘ç»œå¸¦å®½æ˜¯æœ‰é™çš„ï¼Œä¸»æœºå†…PCIE SWITCHæ˜¯æœ‰äº²å’Œæ€§çš„ï¼Œç½‘ç»œæ˜¯ä¼šå‡ºæ•…éšœçš„ï¼ŒèŠ‚ç‚¹æ˜¯æœ‰è½åè€…æ•ˆåº”çš„ï¼Œè®¾å¤‡æˆæœ¬æ˜¯éœ€è¦è€ƒè™‘çš„ï¼Œæ•°æ®ä¸­å¿ƒæ˜¯æœ‰éƒ¨ç½²çº¦æŸçš„ï¼Œç”¨æˆ·æ˜¯æœ‰å¤šç§Ÿæˆ·è¦æ±‚çš„ç­‰ï¼Œè¿™äº›å±äºäº§å“åŒ–çš„èŒƒç•´ä¸åœ¨æœ¬æ–‡é˜è¿°ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:1:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"2. ç½‘ç»œäº’è”ç»“æ„ åˆ†å¸ƒå¼è®­ç»ƒçš„é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•ä¸ç‰©ç†çš„ç½‘ç»œäº’è”ç»“æ„å¼ºç›¸å…³ï¼Œè€Œç½‘ç»œäº’è”ç»“æ„åˆå¤šç§å¤šæ ·ï¼Œå› æ­¤ï¼Œæœ¬æ–‡éœ€è¦å…ˆå¯¹ç½‘ç»œäº’è”ç»“æ„è¿›è¡Œçº¦æŸï¼Œä¾æ®ç”Ÿäº§ä¸­å¸¸ç”¨çš„ã€æ—¢å®šçš„äº’è”ç»“æ„è®¾è®¡é›†åˆé€šä¿¡ç®—æ³•ï¼Œç½‘ç»œäº’è”ç»“æ„æè¿°å¦‚ä¸‹ï¼š ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:2:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"2.1 æœåŠ¡å†…ç½‘ç»œäº’è”ç»“æ„ ä»¥ä¸€å°é›†æˆäº†8å¼ è®­ç»ƒåŠ é€Ÿå¡çš„æœåŠ¡å™¨ä¸ºä¾‹ï¼Œå¦‚ä¸‹å›¾: è¿™å°æœåŠ¡å™¨å†…çš„ç½‘ç»œäº’è”æƒ…å†µå¦‚ä¸‹ï¼š 1ï¼‰åœ¨è¿™å°æœåŠ¡å™¨å†…ï¼Œ8å¼ è®­ç»ƒåŠ é€Ÿå¡é€šè¿‡ç§æœ‰åè®®è¿æ¥ç»„æˆå¤šä¸ªä¸»æœºå†…çš„ç‰©ç†ringç¯ï¼Œä¸”å¯åŒå·¥ï¼› 2ï¼‰æœåŠ¡æœŸå†…ç½‘ç»œå¸¦å®½ NVLINK\u003ePCIE switch \u003e QPIï¼› 3ï¼‰åŠ é€Ÿå¡1ã€2ã€3ã€4ä¹‹é—´ä¸¤ä¸¤å…¨äº’è”ï¼ŒåŠ é€Ÿå¡5,ã€6ã€7ã€8ä¹‹é—´ä¸¤ä¸¤å…¨äº’è”ï¼Œ2ã€5ã€3ã€8ä¹‹é—´éå…¨äº’è”ï¼› 4ï¼‰åŠ é€Ÿå¡1ã€4ä¸ç½‘å¡NIC1 æŒ‚åœ¨åŒä¸€ä¸ªPCIE Switchä¸Šï¼Œå…·æœ‰äº²å’Œæ€§ï¼ŒåŠ é€Ÿå¡2ã€3ä¸ç½‘å¡NIC2æŒ‚åœ¨åŒä¸€ä¸ªPCIE Switchä¸Šï¼Œå…·æœ‰äº²å’Œæ€§ï¼Œè€ŒPCIE Switchä¹‹é—´ä¹Ÿäº’è”ï¼Œå› æ­¤ åŠ é€Ÿå¡ 1ã€2ã€3ã€4 ä¸ç½‘å¡NIC 1ã€NIC2å…·å¤‡äº²å’Œæ€§ï¼Œå®ƒä»¬æ— éœ€é€šè¿‡CPUçš„QPIçº¿è¿›è¡Œé€šä¿¡ï¼› 5ï¼‰åŠ é€Ÿå¡5ã€8ä¸ç½‘å¡NIC3 æŒ‚åœ¨åŒä¸€ä¸ªPCIE Switchä¸Šï¼Œå…·æœ‰äº²å’Œæ€§ï¼ŒåŠ é€Ÿå¡6ã€7ä¸ç½‘å¡NIC4æŒ‚åœ¨åŒä¸€ä¸ªPCIE Switchä¸Šï¼Œå…·æœ‰äº²å’Œæ€§ï¼Œè€ŒPCIE Switchä¹‹é—´ä¹Ÿäº’è”çš„ï¼Œå› æ­¤ åŠ é€Ÿå¡ 5ã€6ã€7ã€8 ä¸ç½‘å¡NIC 3ã€NIC4å…·å¤‡äº²å’Œæ€§ï¼Œå®ƒä»¬ä¹Ÿæ— éœ€é€šè¿‡CPUçš„QPIçº¿è¿›è¡Œé€šä¿¡ï¼› 6ï¼‰ç½‘å¡å¯æ ¹æ®éœ€è¦ é€‰æ‹© 1å¼ ã€2å¼ ã€4å¼ æˆ–8å¼ ï¼Œæœ€å¤šå¯ä»¥é‡‡ç”¨8å¼ RDMAç‰©ç†ç½‘å¡ï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:2:1","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"2.2 æœåŠ¡å™¨é—´ç½‘ç»œäº’è”ç»“æ„ ä»¥ä¸€ä¸ªè®­ç»ƒåŠ é€Ÿå¡é›†ç¾¤ä¸ºä¾‹ï¼Œå¦‚ä¸‹å›¾æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„CLOSäº’è”æ¶æ„æ–¹æ¡ˆ: åœ¨è¿™ä¸ªé›†ç¾¤å†…ï¼Œå…¶ç½‘ç»œäº’è”æƒ…å†µå¦‚ä¸‹ï¼š 1ï¼‰é›†ç¾¤å†…æ¯å°æœåŠ¡å™¨è‡ªå¸¦é«˜é€ŸRDMAç½‘å¡ï¼Œé€šè¿‡RDMA äº¤æ¢æœºåœ¨ä¸»æœºé—´ä¸¤ä¸¤å…¨äº’è”ï¼› 2ï¼‰äº¤æ¢æœºç»„æˆCLOSæ¶æ„ï¼Œåˆ†ä¸ºSpineä¸Leafäº¤æ¢æœºï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯æ›´ä¸ºé«˜ç«¯çš„Spineã€Leafåˆä¸€çš„é«˜ç«¯äº¤æ¢æœºï¼› 3ï¼‰RDMAç½‘å¡ä¸Leafäº¤æ¢æœºäº’è”ï¼Œæ¯å°æœåŠ¡å™¨çš„RDMAç½‘å¡æ•°é‡æ ¹æ®æˆæœ¬ä¸æ€§èƒ½è€ƒè™‘ï¼Œå¯ä»¥æ˜¯1å¼ ã€2å¼ +æ¯å¡è™šæ‹ŸåŒ–4å¡ã€4å¼ +æ¯å¡è™šæ‹ŸåŒ–2å¡æˆ–8å¼ ï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:2:2","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"2.3 é«˜é€Ÿç½‘å¡åŠå…¶è™šæ‹ŸåŒ–ä½¿ç”¨ RDMAç½‘å¡æ˜¯åŒå·¥çš„ä¸”å¯è™šæ‹ŸåŒ–ï¼Œåœ¨è¿™é‡Œæ¯å°æœåŠ¡å™¨å¯æ ¹æ®æˆæœ¬ã€æ€§èƒ½çš„è€ƒè™‘é€‰ç”¨1å¼ ã€2å¼ ã€4å¼ æˆ–8å¼ ï¼Œä¸”åœ¨æœåŠ¡å™¨å†…å·¦å³å¯¹ç§°ï¼Œå¦‚ä¸‹å›¾ï¼š ä»æˆæœ¬ä¸æ•ˆç‡çš„è§’åº¦è€ƒè™‘ï¼Œæ¯å°æœåŠ¡å™¨å†…çš„ç½‘å¡å¯ä»¥æ˜¯ä»¥ä¸‹é…ç½®ï¼š 1å¼ ç‰©ç†RDMAç½‘å¡ï¼Œä¸è¿›è¡Œè™šæ‹ŸåŒ–ï¼Œç›´æ¥ç”¨åŒå·¥é€šé“ï¼Œé€‚åˆé€‰ç”¨2D/Hierarchical Ringæ‹“æ‰‘ç®—æ³•ï¼› 2å¼ ç‰©ç†RDMAç½‘å¡ï¼Œå¯ä»¥æ¯å¼ è™šæ‹ŸåŒ–å‡º4ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œ2X4å…±8å¡ï¼Œé€‚åˆé€‰ç”¨2D-MESHã€2D-Torusæ‹“æ‰‘ç®—æ³•ï¼› 4å¼ ç‰©ç†RDMAç½‘å¡ï¼Œå¯æ¯å¼ è™šæ‹ŸåŒ–å‡º2ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œ4X2å…±8å¡ï¼Œé€‚åˆé€‰ç”¨2D-MESHã€2D-Torusæ‹“æ‰‘ç®—æ³•ï¼› 8å¼ ç‰©ç†RDMAç½‘å¡ï¼Œä¸éœ€è¦è™šæ‹ŸåŒ–ï¼Œç›´æ¥é‡‡ç”¨åŒå·¥é€šé“ï¼Œé€‚åˆé€‰ç”¨2D-MESHã€2D-Torusæ‹“æ‰‘ç®—æ³•ï¼› åœ¨å®é™…çš„åˆ†å¸ƒå¼è®­ç»ƒç”Ÿäº§é›†ç¾¤ä¸­ï¼Œé›†åˆé€šä¿¡ç®—æ³•ä¹Ÿå¯ä»¥ç»“åˆRDMAç½‘å¡ç«¯å£ï¼ˆåŒ…æ‹¬è™šæ‹ŸåŒ–çš„ï¼‰çš„å…·ä½“ä¸ªæ•°è¿›è¡Œè®¾è®¡ï¼Œè€Œæ‹“æ‰‘ç®—æ³•çš„é€‰æ‹©ä¹Ÿæ˜¯éœ€è¦æ ¹æ®æˆæœ¬ä¸æ•ˆç‡çš„è¿›è¡Œåˆç†å–èˆçš„ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:2:3","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"2.4 ç½‘ç»œç»“æ„æŠ½è±¡ ç½‘ç»œæ ¹æ®è¿æ¥æƒ…å†µå¯åˆ†ä¸ºringç»“æ„ã€meshç»“æ„ã€ torus ç»“æ„ä»¥åŠtreeç»“æ„ï¼ŒåŸºäºä»¥ä¸Šçš„æœåŠ¡å™¨å†…ç½‘ç»œäº’è”ç»“æ„ã€æœåŠ¡å™¨é—´ç½‘ç»œäº’è”ç»“æ„ä»¥åŠç½‘å¡çš„å…·ä½“æƒ…å†µï¼Œå¯ä»¥æŠ½è±¡å‡ºä¸€ä¸ªç½‘ç»œç»“æ„ï¼Œå³äºŒç»´ç¯é¢ç½‘ç»œï¼šTorus ç½‘ç»œï¼Œè€ŒTorusç½‘ç»œæ¨ªå‘ä¸çºµå‘éƒ½å¯ä»¥çœ‹æˆringç»“æ„ï¼Œå› æ­¤ç›¸åº”çš„æ‹“æ‰‘ç®—æ³•åŸºæœ¬ä¸Šå°±æ˜¯Ring-Based é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•ã€‚å¦‚ä¸‹å›¾ï¼š TORUSç½‘ç»œæ˜¯å¸¸è§çš„å¤§è§„æ¨¡å¹¶è¡Œè®¡ç®—æœºçš„äº’è¿ç½‘ç»œï¼Œåœ¨ä¸Šå›¾è¿™ä¸ªTorusç½‘ç»œé‡Œï¼š 1ï¼‰æ¨ªå‘ï¼šä¸»æœºå†…8å¡é€šè¿‡ç§æœ‰è¿æ¥åè®®ï¼Œæ¯”å¦‚CXL/CCIX/NVLINKç­‰ç»„æˆä¸€ä¸ªæˆ–å¤šä¸ªringï¼Œå¦‚ä¸Šå›¾çš„é»„è‰²è¿æ¥çº¿ï¼Œæ¨ªå‘8å¡ç»„æˆäºŒç»´Torusçš„æ¨ªå‘ç»´åº¦ï¼› 2ï¼‰çºµå‘ï¼šä¸»æœºé—´é€šè¿‡RDMAï¼ˆRoCE/IBï¼‰ç½‘å¡ã€äº¤æ¢æœºäº’è”ç»„æˆ1åˆ°8ä¸ªringï¼Œå¦‚ä¸Šå›¾çš„çº¢è‰²è¿æ¥çº¿ï¼Œçºµå‘é‡‡ç”¨RDMAç½‘å¡ç»„æˆäºŒç»´Torusçš„çºµå‘ç»´åº¦ï¼› 3ï¼‰æ ¹æ®ç‰©ç†ç½‘å¡æ•°é‡ã€ç½‘å¡è™šæ‹ŸåŒ–ä»¥åŠPCIe Switchäº²å’Œæ€§çš„å®é™…æƒ…å†µï¼š æ¯å°æœåŠ¡å™¨1å¼ ç½‘å¡å¯ç»„æˆä¸»æœºé—´ä¸€ä¸ªringï¼Œç½‘å¡ä¸XPU0 æŒ‚è½½åŒä¸€ä¸ªPCIE switchä¸Šï¼Œä¾æ®æœ€ä½³å®è·µåŸåˆ™ï¼ˆæ¯”å¦‚æ€§èƒ½ã€æˆæœ¬ã€å®¢æˆ·è¦æ±‚ç­‰ï¼‰ï¼Œé€‚åˆé€‰ç”¨2D/Hierarchical Ringæ‹“æ‰‘ç®—æ³•ï¼› ä¸¤å¼ ç½‘å¡å¯ç»„æˆä¸»æœºé—´ä¸¤ä¸ªringæˆ–è€…ç»è¿‡è™šæ‹ŸåŒ–ç»„æˆ8ä¸ªringï¼Œæ ¹æ®PCIE SWITCHäº²å’Œæ€§åŸåˆ™ï¼Œä¸€å¼ ç½‘å¡ä¸XPU0æŒ‚åœ¨åŒä¸€ä¸ªpcie switchï¼Œå¦ä¸€å¼ ç½‘å¡ä¸XPU4æŒ‚åœ¨åŒä¸€ä¸ªpcie switchï¼Œä¾æ®æœ€ä½³å®è·µåŸåˆ™ï¼ˆæ¯”å¦‚æ€§èƒ½ã€æˆæœ¬ã€å®¢æˆ·è¦æ±‚ç­‰ï¼‰ï¼Œé€‚åˆé€‰ç”¨2D-MESHã€2D-Torusæ‹“æ‰‘ç®—æ³•ï¼› 4å¼ ç½‘å¡ã€8å¼ ç½‘å¡ä»¥æ­¤ç±»æ¨ï¼Œä¹Ÿæ˜¯æ ¹æ®PCIE SWITCHäº²å’Œæ€§åŸåˆ™è¿›è¡Œè¿æ¥ï¼Œä¸»æœºé—´RDMAç‰©ç†ç½‘å¡ä¸å¤Ÿå°±è™šæ‹ŸåŒ–ç½‘å£æ¥å‡‘ï¼Œå¹¶ä¸”è¦æœåŠ¡å™¨å†…çš„RDMAå‡ºå£ç«¯å£æ•°å·¦å³å¹³è¡¡ï¼Œä¾æ®æœ€ä½³å®è·µåŸåˆ™ï¼ˆæ¯”å¦‚æ€§èƒ½ã€æˆæœ¬ã€å®¢æˆ·è¦æ±‚ç­‰ï¼‰ï¼Œä¹Ÿæ˜¯é€‚åˆé€‰ç”¨2D-MESHã€2D-Torusæ‹“æ‰‘ç®—æ³•ï¼Œè¿™æ ·æ‰èƒ½å‘æŒ¥å¤šå¼ ç½‘å¡ä»¥åŠXPUçš„ç®—åŠ›ä¼˜åŠ¿ã€‚ 4ï¼‰æ›´å¤æ‚çš„Torusç½‘ç»œç»„åˆå…³ç³»è¿˜å¯ä»¥å¦‚ä¸‹å›¾ï¼Œä»æ¨ªå‘åªæœ‰ ä¸»æœºå†…çš„8å¡çºµå‘åªæœ‰ä¸»æœºé—´çš„RDMAäº’è”ï¼Œæ‰©å±•åˆ° æ¨ªå‘ä¸çºµå‘ ä¸»æœºå†…äº’è”ä¸ä¸»æœºé—´äº’è”æ··åˆï¼Œä½†æœ¬æ–‡ä»…é™äºåœ¨æ¨ªå‘8å¡çš„äºŒç»´Torusç½‘ç»œä¸‹è¿›è¡Œæ‹“æ‰‘ç®—æ³•é€‰æ‹©ä¸è®¾è®¡ï¼Œå› æ­¤ä¸å±•å¼€è®²è¿°ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:2:4","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"3. å¸¸ç”¨çš„é€šä¿¡æ‹“æ‰‘ç®—æ³• Torus ç½‘ç»œç»“æ„å¯ä»¥è§£è¯»æœ¬æ–‡ä¸­çš„ç‰©ç†ç½‘ç»œäº’è”ç»“æ„çš„ä¸€åˆ‡ï¼Œè€ŒTorusç½‘ç»œçš„æ¨ªå‘ä¸çºµå‘éƒ½å¯ä»¥çœ‹æˆringç»“æ„ï¼Œå› æ­¤ï¼Œç›¸åº”çš„é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•éƒ½å¯ä»¥çœ‹æˆæ˜¯Ring-Based é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:3:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"3.1 Ring AllReduce åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼ŒRing æ˜¯æœ€åŸºç¡€çš„äº’è”ç»“æ„ï¼Œåœ¨æœ¬æ–‡ä¸­Ring AllReduceçš„åº”ç”¨åœºæ™¯æ˜¯åœ¨æœåŠ¡å™¨å†…å°†8å¼ åŠ é€Ÿå¡ç»„ç¯é€šä¿¡è¿›è¡Œåˆ†å¸ƒå¼è®­ç»ƒã€‚æ¯ä¸ªXPUéƒ½æ˜¯è¿™ä¸ªä¸»æœºå†…äº’è”ç¯ä¸Šçš„ä¸€ä¸ªè®¡ç®—èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå‰å‘å’Œä¸€ä¸ªåå‘ï¼Œå®ƒåªä¼šå‘å®ƒçš„å‰å‘æ¥æ”¶æ•°æ®ï¼Œå¹¶å‘å®ƒçš„å³å‘å‘é€æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ8å¼ XPU é€šè¿‡ä¸»æœºå†…çš„ç§æœ‰äº’è”ç½‘ç»œç»„æˆä¸€ä¸ªç¯ï¼Œå½“ç„¶å› ä¸ºè¿™äº›é€šä¿¡ç½‘ç»œæ˜¯åŒå·¥çš„ï¼Œè¿™8å¼ XPUè®­ç»ƒåŠ é€Ÿå¡ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯é€šè¿‡å¤šä¸ªé€»è¾‘ç¯äº’è”èµ·æ¥çš„ï¼ŒåŒæ—¶ç¼ºç‚¹æ˜¯ï¼Œå¦‚æœè¿™ä¸ªringå¤ªå¤§ï¼ŒRing Allreduceçš„æ•ˆç‡ä¹Ÿä¼šå˜å¾—å¾ˆä½ã€‚ Ring Allreduce æœ‰ä¸¤ç§ç»„åˆå®ç°ç­–ç•¥ï¼š 1ï¼‰å…ˆReduceåbroadcastï¼› 2ï¼‰å…ˆScatterReduceåAllGatherï¼Œè¿™ä¸¤ä¸ªç­–ç•¥æ‰§è¡Œåéƒ½ä¼šè®©æ¯ä¸ªXPUèŠ‚ç‚¹å¾—åˆ°ä¸€æ ·çš„å¹³å‡æ¢¯åº¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 3.1.1 Reduce +broadcast åœ¨Reduce + broadcasté‡Œï¼Œreduceå…ˆå°†8å¼ å¡çš„æ¢¯åº¦reduce sumåˆ°masterèŠ‚ç‚¹ XPU0 ä¸Šï¼Œå†é€šè¿‡broadcastå°†è¿™ä¸ªæ€»çš„å¹³å‡æ¢¯åº¦å¤åˆ¶ç»™å…¶ä»–XPUï¼Œå¦‚ä¸‹å›¾ï¼š Reduce + broadcastè¿™ç§ç­–ç•¥æœ‰å‡ ä¸ªæ¯”è¾ƒå¤§çš„ç¼ºç‚¹ï¼š 1ï¼‰8å¼ å¡çš„æ•°æ®éƒ½reduce sumåˆ°ä¸€å¼ å¡ï¼Œå‡è®¾æ¯å¼ å¡çš„æ¢¯åº¦æ˜¯100MBï¼Œ8å¼ å¡å°±æ˜¯800MBï¼Œè¿™å¯èƒ½å­˜åœ¨XPU 0è®¡ç®—å¾ˆä¹…ï¼Œè€Œå…¶ä»–7å¼ å¡ç©ºé—²çš„æƒ…å†µå­˜åœ¨ï¼Œæ•´ä½“æ•ˆç‡ä¸é«˜ï¼› 2ï¼‰XPU0 çš„ç½‘ç»œå¸¦å®½å¯èƒ½ä¼šæˆä¸ºç“¶é¢ˆï¼Œ8å¼ å¡çš„æ•°æ®éƒ½åªèƒ½é€šè¿‡XPU0çš„äº’è”ç½‘ç»œè¿›è¡Œreduceå’Œbroadcastï¼Œåœ¨æ•°æ®é‡æ¯”è¾ƒå¤§çš„åœºæ™¯ XPU0çš„å¸¦å®½æˆä¸ºç“¶é¢ˆï¼› 3ï¼‰8å¼ XPUä¸éƒ½æ˜¯ä¸¤ä¸¤å…¨äº’è”çš„ï¼Œå› æ­¤ï¼Œè¦æŠŠ8å¼ å¡çš„æ•°æ®ä¸€æ¬¡Reduceæˆ–broadcastï¼Œè¿™ä¸€ç‚¹å—é™äºç½‘ç»œäº’è”æ¡ä»¶åšä¸åˆ°ï¼Œé‚£ä¹ˆå°±éœ€è¦é‡‡ç”¨ ringæˆ–treeçš„ç­–ç•¥è¿›è¡Œreduceæˆ–broadcastï¼Œè¿™æ ·æ•ˆç‡ä¹Ÿä¸é«˜ã€‚ 3.1.2 ScatterReduce + AllGather Ring AllReduce çš„Ring ScatterReduce + Ring AllGatherç­–ç•¥ç»„åˆé‡Œï¼Œæ¯ä¸ª XPUåªä¼šä»å‰å‘æ¥å—æ•°æ®ï¼Œå¹¶å‘é€æ•°æ®ç»™åå‘ï¼Œå…¶ç®—æ³•ä¸»è¦åˆ†ä¸ºï¼š ScatterReduceï¼šè¿™ä¸€æ­¥ä¼šå…ˆscatteræ‹†åˆ†æ•°æ®å—å†è¿›è¡Œreduceï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œå®Œæ¯•åï¼Œæ¯å¼ XPUéƒ½ä¼šåŒ…æ‹¬ä¸€ä¸ªå®Œæ•´çš„ç»è¿‡èåˆçš„åŒç»´æ¢¯åº¦ï¼› AllGatherï¼šè¿™ä¸€æ­¥ä¼šè¿›è¡Œå…¨å±€GatheråŒæ­¥ï¼Œæœ€åæ‰€æœ‰ XPUéƒ½ä¼šå¾—åˆ°å®Œæ•´çš„å¤§çš„æ•´ä¸ªæ¢¯åº¦ï¼› Ring ScatterReduce + Ring AllGatheræ˜¯æ•ˆç‡æ¯”è¾ƒé«˜çš„ Ring AllReduce ç»„åˆç­–ç•¥ï¼Œè¿™ä¸ªç­–ç•¥è€ƒè™‘åˆ°äº†XPUä¸Šçš„æ¢¯åº¦å¯èƒ½å¾ˆå¤§çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸€ä¸ªæ¢¯åº¦æœ‰400MBï¼Œåœ¨scatterreduceé˜¶æ®µå°±ä¼šå…ˆè¢«æ‹†åˆ†æˆ ringä¸ŠXPUä¸ªæ•°ä»½ï¼Œæ¯”å¦‚ä¸»æœºå†…XPUä¸ªæ•°ç­‰äº8ï¼Œé‚£ä¹ˆ è¿™400MB å°±ä¼šè¢« æ‹†åˆ†æˆ8ä»½ï¼Œæ¯ä»½50MBï¼Œä»è€Œå‡å°‘äº†åŠ é€Ÿå¡çš„è®¡ç®—é‡ä»¥åŠèŠ‚çº¦å¸¦å®½ã€‚æ­¤å¤–ï¼ŒscatterReduceé€šè¿‡å°†æ•°æ®æ‹†åˆ†æˆå°å—ï¼ŒåŒæ—¶å¹¶å‘è¿›è¡ŒscatterReduceï¼Œä»è€Œå°†é€šä¿¡æ—¶é—´éšè—åœ¨è®¡ç®—æ—¶é—´å†…è¿›è€Œæé«˜Ring AllReduceçš„æ•ˆç‡ã€‚ 3.1.2.1 ScatterReduce é¦–å…ˆï¼Œ ScatterReduceå…ˆå°†æ¢¯åº¦æ‹†åˆ†ä¸ºNä¸ªæ›´å°çš„å—ï¼ŒNç­‰äºringé‡ŒXPUä¸ªæ•°ï¼Œ8å¼ å¡å°±æ‹†åˆ†æˆ8ä»½ï¼Œç„¶åè¿›è¡ŒN-1æ¬¡scatterreduceè¿­ä»£ã€‚åœ¨ç¬¬ä¸€è½®è¿­ä»£ä¸­XPU 0ä¸Šçš„A0ä¼ é€’ç»™XPU1ä¸ŠA1å¹¶ç›¸åŠ ï¼ŒXPU1ä¸Šçš„B1ä¼ é€’ç»™XPU2ä¸Šçš„B2å¹¶ç›¸åŠ ï¼ŒXPU 2ä¸Šçš„C2ä¼ é€’ç»™XPU3ä¸ŠC3å¹¶ç›¸åŠ ï¼ŒXPU3ä¸Šçš„D3ä¼ é€’ç»™XPU4ä¸Šçš„D4å¹¶ç›¸åŠ ï¼Œä»¥æ­¤ç±»æ¨ï¼Œè¿‡ç¨‹å¦‚ä¸‹å›¾å·¦ä¾§ï¼š æ¥ä¸‹æ¥ï¼ŒXPUè¿˜ä¼šè¿›è¡ŒN-2æ¬¡ ScatterReduce è¿­ä»£ï¼Œåœ¨æ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­ï¼ŒXPUéƒ½ä¼šä»å‰å‘æ¥æ”¶ä¸€ä¸ªå°æ¢¯åº¦å—å¹¶ç´¯åŠ åˆ°è‡ªå·±çš„æ¢¯åº¦å—ä¸­ï¼Œå¹¶ä¸”ä¹Ÿä¼šå‘å…¶åå‘å‘é€ä¸€ä¸ªå°æ¢¯åº¦å—ï¼Œæ¯ä¸ªXPUæ¥æ”¶å’Œå‘é€çš„å°æ¢¯åº¦å—åœ¨æ¯æ¬¡è¿­ä»£ä¸­éƒ½æ˜¯ä¸åŒçš„ï¼Œè¿™æ ·ç»è¿‡è¿­ä»£ï¼Œåˆ°æœ€åï¼Œæ¯ä¸ªXPUå°†æœ‰ä¸€ä¸ªå®Œæ•´çš„åŒç»´æ¢¯åº¦ï¼Œè¯¥å—æ¢¯åº¦ä¸­åŒ…å«æ‰€æœ‰XPUä¸­è¯¥å—å¯¹åº”çš„æ‰€æœ‰æ¢¯åº¦çš„æ€»å’Œï¼Œå¦‚ä¸Šå›¾å³ä¾§çš„ç´¯åŠ å’Œéƒ¨åˆ†ã€‚ 3.1.2.2 Allgather åœ¨scatterReduceè¿­ä»£å®Œæˆä¹‹åï¼Œæ¯ä¸ªXPUéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªåŒç»´åº¦çš„å®Œæ•´çš„æ¢¯åº¦ç´¯åŠ å€¼ï¼Œå°†è¿™äº›å®Œæ•´çš„ç´¯åŠ å€¼å¤åˆ¶åˆ°å…¶ä»–çš„åŠ é€Ÿå¡åï¼Œæ‰ç®—å®ŒæˆallReduceã€‚Allgatherçš„è¿­ä»£æ¬¡æ•°ä¸scatterReduceæ˜¯ç›¸åŒçš„ï¼Œä¹Ÿéƒ½éœ€è¦è¿›è¡ŒN-1æ¬¡ï¼ˆNæ˜¯ringä¸Šçš„XPUå¡æ•°ï¼‰è¿­ä»£ï¼Œä½†æ˜¯ä¸åŒäºScatterReduceçš„æ˜¯allGatheræ²¡æœ‰reduceçš„è¿‡ç¨‹ï¼Œåªæœ‰æ•°å€¼çš„å¤åˆ¶ã€‚è¿™æ ·è¿­ä»£åˆ°æœ€åï¼Œæ¯ä¸ªXPUéƒ½å¾—åˆ°å¤§çš„æ‹†åˆ†å‰çš„æ¢¯åº¦çš„å®Œæ•´ç´¯åŠ å€¼ï¼Œå¦‚ä¸‹å›¾æ¼”ç¤ºäº†è¿™ä¸€è¿‡ç¨‹ï¼Œä»ç¬¬ä¸€æ¬¡è¿­ä»£å¼€å§‹ï¼Œåˆ°æœ€åAllGatheræ‹¿åˆ°æ•´ä½“çš„ç»“æœã€‚è¿™é‡Œå¤´çš„å…·ä½“è¿‡ç¨‹å°±ä¸åœ¨è¿™é‡Œæè¿°äº†ï¼Œå¯ä»¥æŸ¥ç›¸å…³èµ„æ–™ã€‚ Ring AllReduce å®ç°ç®€å•ï¼Œåœ¨ringè¾ƒå°‘æ—¶ï¼Œæ•ˆç‡ä¹Ÿè¾ƒé«˜ï¼Œä½†æ˜¯åœ¨ringæ¯”è¾ƒå¤§æ—¶éœ€è¦çš„ç½‘ç»œèŠ‚ç‚¹è·³æ•°å˜å¾—æ¯”è¾ƒå¤§ï¼Œé€šä¿¡æ—¶å»¶å¢åŠ ï¼Œå› æ­¤æ•ˆç‡ä¹Ÿä¼šé™ä½ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ª1000å¼ XPUçš„ ringï¼Œè¿™é‡Œå¤´ç½‘ç»œçš„è·³æ•° æ˜¯N-1= 1000-1 =999ï¼Œ åŒæ—¶ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œä¼ è¾“æ•ˆç‡è¿˜å—æ•ˆç‡æœ€ä½ã€å¸¦å®½æœ€ä½çš„XPUçš„é™åˆ¶ï¼Œè¿™æ—¶ç½‘ç»œä¸Šçš„æ—¶å»¶ä¼šå˜å¾—å·¨é«˜ï¼Œè¿™ä¸ªæ—¶å€™ring allreduceæ‹“æ‰‘ç®—æ³•å°±å˜å¾—ä¸å¤§é€‚ç”¨è¿™ä¸ªåœºæ™¯ï¼ŒåŒæ—¶å¦‚æœåœ¨å¼‚æ„ç½‘ç»œé‡Œæ¶‰åŠç½‘ç»œçš„ä¸åŒè¿æ¥æ–¹å¼ï¼ŒRing AllReduceä¹Ÿä¸å¤§é€‚åˆä½¿ç”¨ï¼Œå› æ­¤å°±éœ€è¦é‡‡ç”¨å¦å¤–çš„æ›´é€‚åˆç½‘ç»œç»“æ„çš„æ›´é«˜æ•ˆçš„é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•æ¥è¿›è¡Œä¼˜åŒ–ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:3:1","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"3.2 2D-Ring AllReduce å¦‚æœä¸€å°2.1é‡Œçš„æœåŠ¡å™¨åªé…ç½®äº†ä¸€å¼ RDMAç½‘å¡ï¼Œæ¯å°æœåŠ¡å™¨é€šè¿‡RDMAäº¤æ¢æœºäº’è”ï¼Œè¿™ä¸ªé›†ç¾¤çš„ç½‘ç»œæ˜¯å¼‚æ„çš„ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œé‚£ä¹ˆRing AllReduceæ‹“æ‰‘ç®—æ³•å°±ä¸é€‚ç”¨äº†ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¯¹äºè¿™ä¸ªç½‘ç»œæ‹“æ‰‘ç»“æ„æ¯”è¾ƒé€‚åˆçš„æ˜¯2D-Ring AllReduceä¹Ÿå«Hierarchical Ring AllReduceã€‚ ç»è¿‡æŠ½è±¡ï¼Œå¯ä»¥å°†è¿™ä¸ªç½‘ç»œç»“æ„è¡¨è¾¾æˆå¦‚ä¸‹çš„Torusç»“æ„ï¼š æ¨ªå‘ï¼šæ¯å°æœåŠ¡å™¨8ä¸ªXPUèŠ‚ç‚¹ï¼Œæ¯ä¸ªXPUèŠ‚ç‚¹é€šè¿‡ç§æœ‰åè®®ç½‘ç»œäº’è”ï¼› çºµå‘ï¼šæ¯å°æœåŠ¡å™¨é€šè¿‡ä¸€å¼ RDMAç½‘å¡NIC 0 é€šè¿‡äº¤æ¢æœºäº’è”ï¼Œè¿™ä¸ªç½‘å¡NIC0 ä¸XPU0 æŒ‚åœ¨åŒä¸€ä¸ªPCIE switchä¸Šï¼Œæ»¡è¶³å…·å¤‡äº²å’Œæ€§æ¡ä»¶ï¼ŒXPU0ä¸Šçš„æ¢¯åº¦å¯ä»¥é€šè¿‡NIC 0 ä¸å…¶ä»–æœåŠ¡å™¨ä¸Šçš„XPUè¿›è¡Œå…¨å±€è§„çº¦ã€‚ 2D-Ring AllReduceçš„è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç¬¬1æ­¥ï¼Œå…ˆè¿›è¡Œä¸»æœºå†…Ring AllReduceï¼Œä¹Ÿå¯ä»¥æ˜¯ Ring Reduceæˆ–è€…æ ¹æ®ä¸»æœºå†…çš„äº’è”æƒ…å†µé€‰ç”¨çš„åˆ†å±‚reduceæ–¹å¼ï¼Œå°†8å¼ å¡ä¸Šçš„æ¢¯åº¦ç´¯åŠ åˆ°MasterèŠ‚ç‚¹ XPU0 ä¸Šï¼› ç¬¬2æ­¥ï¼Œè¿›è¡Œä¸»æœºé—´XPU 0çš„ Ring AllReduceï¼Œå°†æ¯å°æœåŠ¡å™¨çš„XPU0ä¸Šçš„æ•°æ®è¿›è¡Œå…¨å±€è§„çº¦ï¼› ç¬¬3æ­¥ï¼Œè¿›è¡Œä¸»æœºå†…Broadcastï¼Œå°†XPU0ä¸Šçš„æ¢¯åº¦å¤åˆ¶åˆ°æœåŠ¡å™¨å†…çš„å…¶ä»–XPUä¸Š 2D-Ring AllReduceèƒ½å……åˆ†å‘æŒ¥å¼‚æ„ç½‘ç»œçš„ä¼˜åŠ¿ï¼Œå°†ä¸»æœºå†…ã€ä¸»æœºé—´çš„ç½‘ç»œå¸¦å®½å……åˆ†åˆ©ç”¨èµ·æ¥ã€‚ä½†æ˜¯XPUçš„åˆ©ç”¨ç‡ä¹Ÿä¸æ˜¯å¾ˆé«˜ï¼Œæ¯”å¦‚åœ¨åšä¸»æœºé—´çš„Ring AllReduceï¼Œæ¯å°æœåŠ¡å™¨å†…çš„å…¶ä»–7å¼ XPUæ˜¯å¤„äºç©ºé—²çŠ¶æ€çš„ã€‚ å†å‡è®¾ï¼Œå¦‚æœæ¯å°æœåŠ¡å™¨é…ç½®äº† 2å¼ /4å¼ /8å¼ RDMAç½‘å¡ï¼Œè¿™ä¸ªæ—¶å€™ 2D-RING AllReduceåˆéš¾ä»¥å°†ç½‘ç»œçš„ä¼˜åŠ¿å‘æŒ¥å‡ºæ¥ï¼Œé‚£ä¹ˆå°±éœ€è¦é€‰ç”¨ 2D-Torus/2D-Mesh AllReduceæ‹“æ‰‘ç®—æ³•ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:3:2","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"3.3 2D-Torus AllReduce è€ƒè™‘åˆ°æœåŠ¡å™¨å†…PCIE SWITCH çš„äº²å’Œæ€§é—®é¢˜ï¼Œ2D-Torusè‡³å°‘éœ€è¦é…å¤‡2å¼  å·¦å³å¯¹ç§°çš„RDMAç½‘å¡æ‰èƒ½å‘æŒ¥è¿™ä¸ªæ‹“æ‰‘ç®—æ³•çš„ä¼˜åŠ¿ã€‚åœ¨è¿™ä¸ªé›†ç¾¤é‡Œä¸»æœºå†…æ¯å¼ å¡éƒ½é€šè¿‡ç§æœ‰çš„é€šä¿¡åè®®ç»„æˆRingï¼Œè€Œä¸»æœºé—´ï¼Œå¯ä»¥é€šè¿‡RDMAç½‘å¡ï¼ˆåŒ…æ‹¬è™šæ‹ŸåŒ–å‡ºæ¥çš„ï¼‰ä¸RDMAäº¤æ¢æœºå°†XPUä¸¤ä¸¤äº’è”ï¼Œè¿™ä¸ªç½‘ç»œä¹Ÿæ˜¯å¼‚æ„çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç»è¿‡æŠ½è±¡ï¼Œå¯ä»¥å°†è¿™ä¸ªç½‘ç»œç»“æ„è¡¨è¾¾æˆå¦‚ä¸‹çš„Torusç»“æ„ï¼š æ¨ªå‘ï¼šæ¯å°æœåŠ¡å™¨8ä¸ªXPUèŠ‚ç‚¹ï¼Œæ¯ä¸ªXPUèŠ‚ç‚¹é€šè¿‡ç§æœ‰åè®®ç½‘ç»œäº’è”ï¼› çºµå‘ï¼šæ¯å°æœåŠ¡å™¨é€šè¿‡è‡³å°‘2å¼ RDMAç½‘å¡NIC 0 /NIC 1é€šè¿‡äº¤æ¢æœºäº’è”ï¼Œè¿™ä¸ªç½‘å¡NIC0 ä¸XPU0ã€1ã€2ã€3 æŒ‚åœ¨åŒä¸€ä¸ªPCIE switchä¸Šï¼Œå…·å¤‡äº²å’Œæ€§æ¡ä»¶ï¼ŒXPU0ã€1ã€2ã€3ä¸Šçš„æ¢¯åº¦æ•°æ®å¯ä»¥é€šè¿‡NIC 0 ä¸å…¶ä»–æœåŠ¡å™¨ä¸Šçš„XPUè¿›è¡Œäº¤æ¢ã€‚ç½‘å¡NIC1 ä¸XPU4ã€5ã€6ã€7 æŒ‚åœ¨åŒä¸€ä¸ªPCIE switchä¸Šï¼Œå…·å¤‡äº²å’Œæ€§æ¡ä»¶ï¼ŒXPU4ã€5ã€6ã€7ä¸Šçš„æ¢¯åº¦æ•°æ®å¯ä»¥é€šè¿‡NIC 1 ä¸å…¶ä»–æœåŠ¡å™¨ä¸Šçš„XPUè¿›è¡Œäº¤æ¢ï¼› å½“ç„¶å¦‚æœç½‘å¡æ˜¯4ä¸ªæˆ–è€…8ä¸ªï¼Œä¹Ÿå¯ä»¥æ ¹æ®PCIE SWITCHçš„äº²å’Œæ€§æƒ…å†µåˆç†å®‰æ’XPUä¸NICçš„å¯¹åº”å…³ç³»ã€‚ 2D-Torus AllReduceçš„è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç¬¬1æ­¥ï¼Œæ¨ªå‘ï¼Œå…ˆè¿›è¡Œä¸»æœºå†…Ring ScatterReduceï¼Œå°†ä¸»æœºå†…8å¼ å¡ä¸Šçš„æ¢¯åº¦è¿›è¡Œæ‹†åˆ†ä¸è§„çº¦ï¼Œè¿™æ ·ç»è¿‡è¿­ä»£ï¼Œåˆ°æœ€åæ¯ä¸ªXPUå°†æœ‰ä¸€ä¸ªå®Œæ•´çš„åŒç»´æ¢¯åº¦ï¼Œè¯¥å—æ¢¯åº¦åŒ…å«æ‰€æœ‰XPUä¸­è¯¥å—æ‰€å¯¹åº”çš„æ‰€æœ‰æ¢¯åº¦çš„æ€»å’Œï¼ˆå‚è€ƒ3.1.2.1 scatterReduce) ç¬¬2æ­¥ï¼Œçºµå‘ï¼Œè¿›è¡Œä¸»æœºé—´Nä¸ªï¼ˆNç­‰äºæœåŠ¡å™¨å†…XPUä¸ªæ•°ï¼Œè¿™é‡Œæ˜¯8ä¸ªï¼‰çºµå‘çš„ Ring AllReduceï¼Œå°†æ¯å°æœåŠ¡å™¨çš„XPU0-XPU7ä¸Šçš„æ•°æ®è¿›è¡Œé›†ç¾¤å†…çºµå‘å…¨å±€è§„çº¦ï¼› ç¬¬3æ­¥ï¼Œæ¨ªå‘ï¼Œè¿›è¡Œä¸»æœºå†…AllGatherï¼Œå°†XPUi(i=0-7)ä¸Šçš„æ¢¯åº¦å¤åˆ¶åˆ°æœåŠ¡å™¨å†…çš„å…¶ä»–XPUä¸Šï¼› 2D-Torus AllReduceèƒ½å……åˆ†æŒ–æ˜XPUçš„æ•ˆç‡ä»¥åŠå‘æŒ¥å¼‚æ„ç½‘ç»œé‡Œå¤šç½‘å¡çš„ä¼˜åŠ¿ï¼Œå°†XPUä»¥åŠä¸»æœºå†…ã€ä¸»æœºé—´çš„ç½‘ç»œå¸¦å®½ä¼˜åŠ¿å……åˆ†åˆ©ç”¨èµ·æ¥ã€‚æ­¤å¤–ï¼Œé™¤äº† 2D-Torus AllReduceå¤–ï¼Œ2D-Mesh AllReduceä¹Ÿèƒ½å‘æŒ¥ç±»ä¼¼æ•ˆç‡ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:3:3","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"3.4 2D-Mesh AllReduce 2D-Mesh AllReduceçš„ä¸»è¦æ€æƒ³ä¹Ÿæ˜¯åˆ†å±‚ï¼Œä¸2D-Torus AllReduceç±»ä¼¼ï¼Œéƒ½æ˜¯æ°´å¹³å’Œå‚ç›´ä¸¤ä¸ªæ–¹å‘ï¼Œä½†æ˜¯æœ‰ç‚¹å·®å¼‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸åŒäº2D-Torus AllReduceçš„æ‹“æ‰‘ç®—æ³•ï¼Œ2D-Mesh AllReduce è¿‡ç¨‹æ˜¯ï¼š ç¬¬1æ­¥ï¼Œæ¨ªå‘ï¼Œå…ˆè¿›è¡Œä¸»æœºå†…Ring AllReduce å°†ä¸»æœºå†…çš„8å¼ XPUçš„æ¢¯åº¦éƒ½è¿›è¡Œè§„çº¦ï¼› ç¬¬2æ­¥ï¼Œçºµå‘ï¼Œè¿›è¡Œä¸»æœºé—´Nä¸ªï¼ˆNç­‰äºä¸»æœºå†…XPUä¸ªæ•°ï¼Œè¿™é‡Œæ˜¯8ä¸ªï¼‰çºµå‘çš„ Ring AllReduceï¼› ç»è¿‡è¿™ä¸¤æ­¥ï¼Œå®Œæˆäº†æ•´ä½“çš„æ¢¯åº¦ç´¯åŠ ï¼Œ2D-Mesh AllReduce ä¹Ÿèƒ½å……åˆ†å‘æŒ¥XPUä¸å¤šç½‘å¡å¼‚æ„ç½‘ç»œçš„ä¼˜åŠ¿ï¼Œå°†XPUä¸ä¸»æœºå†…ã€ä¸»æœºé—´çš„ç½‘ç»œå¸¦å®½ä¼˜åŠ¿å……åˆ†åˆ©ç”¨èµ·æ¥ã€‚è¿™é‡Œçš„2D-Meshä¸Googleè®ºæ–‡ä¸Šçš„æœ‰ç‚¹å·®å¼‚ï¼Œä¸»è¦æ˜¯å¸å–äº†å…¶åˆ†å±‚çš„æ€æƒ³è€Œä¸æ˜¯å¤åˆ¶å…¶ä¸€æ ·çš„è®¾è®¡ã€‚ç†è®ºä¸Š2D-Mesh AllReduceå¯¹æ¯” 2D-Torus AllReduceï¼Œä¸»æœºé—´AllReduceç”¨çš„æ˜¯ ä¸»æœºå†…8å¡çš„å…¨å±€æ¢¯åº¦ï¼Œæ•°æ®é‡ä¼šæ¯”ScatterReduceéƒ¨åˆ†æ¥çš„å¤§ç‚¹ï¼Œå› æ­¤æ•ˆç‡ä¹Ÿä¼šç›¸åº”é™ä½ä¸€ç‚¹ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:3:4","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"4. é—®é¢˜æ¢è®¨ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒåŸºäºTorusç½‘ç»œçš„ç»“æ„ï¼Œç»„åˆRing AllReduceï¼Œ2D-Ring AllReduce, 2D-Mesh AllReduceï¼Œ2D-Torus AllReduceè¿˜èƒ½æ„å»º 3D-Ring/Mesh/Torus AllReduceæ‹“æ‰‘ç®—æ³•ï¼Œä½†æ˜¯è¿™äº›æ‹“æ‰‘ç®—æ³•çš„æ•ˆç‡éœ€è¦è¿›è¡Œå®è·µæ‰èƒ½è¯å®ï¼Œä¹Ÿè®¸åœ¨è§„æ¨¡è¾ƒå¤§çš„é›†ç¾¤é‡Œæ‰èƒ½å‘æŒ¥å‡º3D æ‹“æ‰‘ç®—æ³•çš„ä¼˜åŠ¿ã€‚ å…³äº 3D-Ring/Mesh/Torus AllReduceçš„æ‹“æ‰‘ç®—æ³•ï¼Œè¿™é‡Œå°±ä¸åœ¨é˜è¿°ï¼Œå¯ä½œä¸ºç ”ç©¶ä½¿ç”¨ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:4:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"5. å°ç»“ æœ¬æ–‡è®²è¿°äº†åˆ†å¸ƒå¼è®­ç»ƒé‡Œæœ€å¸¸ç”¨çš„å‡ ä¸ªç½‘ç»œç»“æ„ä»¥åŠé€šä¿¡æ‹“æ‰‘ç®—æ³•ï¼š Ring AllReduce çš„æœ€ä½³ç»„åˆæ˜¯ ScatterReduce + AllGatherï¼› 2D-Ring AllReduce = ä¸»æœºå†… ringAllReduce/Ring Reduce +ä¸»æœºé—´ RingAllReduce + ä¸»æœºå†…Broadcastï¼› 2D-Torus AllReduce = ä¸»æœºå†… Ring ReduceScatter + ä¸»æœºé—´Nä¸ªRing AllReduce + ä¸»æœºå†…Ring AllGatherï¼› 2D-Mesh AllReduce = ä¸»æœºå†…Ring AllReduce + ä¸»æœºé—´Nä¸ªRing AllReduce; Ring AllReduceé€‚åˆä¸»æœºå†…äº’è”Ringçš„æƒ…å†µä½¿ç”¨ï¼Œ2D-Ring AllReduceé€‚åˆä¸€å°æœåŠ¡å™¨é…ç½®äº†ä¸€å¼ ç½‘å¡çš„å¼‚æ„ç½‘ç»œåœºæ™¯ï¼Œ2D-Torus AllReduceä¸2D-Mesh AllReduceé€‚åˆä¸€å°æœåŠ¡å™¨é…ç½®äº†2/4/8å¼ ç½‘å¡çš„å¼‚æ„ç½‘ç»œåœºæ™¯ã€‚ é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•å¤šç§å¤šæ ·ï¼Œä½†åŸºäºæˆæœ¬ä»¥åŠæ•ˆç‡çš„å–èˆè€ƒè™‘ï¼Œå¯ç”Ÿäº§é€‚ç”¨çš„å…¶å®ä¹Ÿä¸å¤šï¼Œé™¤äº†ç†è®ºä¸Šçš„ç†è§£ä¹‹å¤–æ›´é‡è¦çš„æ˜¯è‡ªå·±ç¼–å†™ä»£ç å»å®è·µè½åœ°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦è§£å†³ç½‘ç»œå¸¦å®½æœ‰é™ã€ç½‘ç»œå®¹æ˜“å‡ºæ•…éšœã€è½åè€…æ•ˆåº”ã€éƒ¨ç½²çº¦æŸã€å¤šç§Ÿæˆ·ç­‰äº§å“åŒ–çš„è´¨é‡è¦æ±‚ã€‚ REF: [1] https://www.changping.me [2] ã€Švolta-architecture-whitepaperã€‹ [3] 2D-HRA: Two-Dimensional Hierarchical Ring-based All-reduce Algorithm in Large-Scale Distributed Machine Learning [4] Massively Distributed SGD: ImageNet/ResNet-50 Training in a Flash [5] https://zhuanlan.zhihu.com/p/79030485 , è…¾è®¯æœºæ™ºå›¢é˜Ÿåˆ†äº«â€“AllReduceç®—æ³•çš„å‰ä¸–ä»Šç”Ÿ [6] https://zhuanlan.zhihu.com/p/370548366, ring allreduceå’Œtree allreduceçš„å…·ä½“åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ [7] https://zhuanlan.zhihu.com/p/184942777 , åˆ†å¸ƒå¼æ·±åº¦å­¦ä¹ åˆæ¢ [8] https://arxiv.org/abs/1811.06992 ï¼Œ Image Classification at Supercomputer Scale ","date":"2023-07-13","objectID":"/posts/distributedtraining_4/:5:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬4ç¯‡ - åˆ†å¸ƒå¼è®­ç»ƒå¸¸ç”¨çš„ç½‘ç»œç»“æ„åŠé›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•","uri":"/posts/distributedtraining_4/"},{"categories":["Distributed Computing"],"content":"ref: [1]. https://zhuanlan.zhihu.com/p/493092647 ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:0:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"æ¦‚è¿° é›†åˆé€šä¿¡ï¼ˆCollective Communicationsï¼‰æ˜¯ä¸€ä¸ªè¿›ç¨‹ç»„çš„æ‰€æœ‰è¿›ç¨‹éƒ½å‚ä¸çš„å…¨å±€é€šä¿¡æ“ä½œï¼Œå…¶æœ€ä¸ºåŸºç¡€çš„æ“ä½œæœ‰ å‘é€sendã€æ¥æ”¶receiveã€å¤åˆ¶copyã€ç»„å†…è¿›ç¨‹æ …éšœåŒæ­¥Barrierä»¥åŠèŠ‚ç‚¹é—´è¿›ç¨‹åŒæ­¥(signal+wait)ï¼Œè¿™å‡ ä¸ªæœ€åŸºæœ¬çš„æ“ä½œç»è¿‡ç»„åˆæ„æˆäº†ä¸€ç»„é€šä¿¡æ¨¡æ¿ä¹Ÿå«é€šä¿¡åŸè¯­ï¼Œæ¯”å¦‚ï¼š1å¯¹å¤šçš„å¹¿æ’­broadcastã€å¤šå¯¹1çš„æ”¶é›†gatherã€å¤šå¯¹å¤šçš„æ”¶é›†all-gatherã€1å¯¹å¤šçš„å‘æ•£scatterã€å¤šå¯¹1çš„è§„çº¦reduceã€å¤šå¯¹å¤šçš„è§„çº¦all-reduceã€ç»„åˆçš„è§„çº¦ä¸å‘æ•£reduce-scatterã€å¤šå¯¹å¤šçš„all-to-allç­‰ï¼Œé›†åˆé€šä¿¡çš„éš¾ç‚¹åœ¨äºé€šä¿¡æ•ˆç‡ä»¥åŠç½‘ç»œç¡¬ä»¶è¿æ¥æ‹“æ‰‘ç»“æ„çš„æœ€ä½³é€‚ç”¨ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:1:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"é€šä¿¡åŸè¯­ ä»¥ä¸€å°é›†æˆäº†4å¼ è®­ç»ƒåŠ é€Ÿå¡çš„æœåŠ¡å™¨ä¸ºä¾‹ï¼Œå¦‚ä¸‹å›¾ï¼ŒæœåŠ¡å™¨å†…å››å¼ è®­ç»ƒåŠ é€Ÿå¡æ˜¯å…¨è¿æ¥çš„ï¼Œç‰©ç†è¿æ¥æ–¹å¼å¯ä»¥æ˜¯ç§æœ‰ç‰©ç†äº’è”åè®®ï¼Œæ¯”å¦‚CXLã€NVLINKï¼Œä¹Ÿå¯ä»¥æ˜¯PCIeã€InfiniBandã€Ethernetç­‰ï¼Œæœ¬æ–‡å°†ä»¥æ­¤ç‰©ç†æ‹“æ‰‘ç»“æ„æè¿°é›†åˆé€šä¿¡ä¸­å¸¸ç”¨çš„å‡ ç»„é€šä¿¡åŸè¯­ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"Broadcast Broadcastå±äº1å¯¹å¤šçš„é€šä¿¡åŸè¯­ï¼Œä¸€ä¸ªæ•°æ®å‘é€è€…ï¼Œå¤šä¸ªæ•°æ®æ¥æ”¶è€…ï¼Œå¯ä»¥åœ¨é›†ç¾¤å†…æŠŠä¸€ä¸ªèŠ‚ç‚¹è‡ªèº«çš„æ•°æ®å¹¿æ’­åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœˆåœˆè¡¨ç¤ºé›†ç¾¤ä¸­çš„è®­ç»ƒåŠ é€Ÿå¡èŠ‚ç‚¹ï¼Œç›¸åŒçš„é¢œè‰²çš„å°æ–¹å—åˆ™ä»£è¡¨ç›¸åŒçš„æ•°æ®ã€‚å½“ä¸»èŠ‚ç‚¹ 0 æ‰§è¡ŒBroadcastæ—¶ï¼Œæ•°æ®å³ä»ä¸»èŠ‚ç‚¹0è¢«å¹¿æ’­è‡³å…¶ä»–èŠ‚ç‚¹ã€‚ Broadcastæ˜¯æ•°æ®çš„1å¯¹å¤šçš„åŒæ­¥ï¼Œå®ƒå°†ä¸€å¼ XPUå¡ä¸Šçš„æ•°æ®åŒæ­¥åˆ°å…¶ä»–æ‰€æœ‰çš„XPUå¡ä¸Šï¼Œå…¶åº”ç”¨åœºæ™¯æœ‰ï¼š 1ï¼‰æ•°æ®å¹¶è¡Œçš„å‚æ•°åˆå§‹åŒ–ï¼Œç¡®ä¿æ¯å¼ å¡ä¸Šçš„åˆå§‹å‚æ•°æ˜¯ä¸€è‡´çš„ï¼› 2ï¼‰allReduceé‡Œçš„ broadcast + reduceç»„åˆé‡Œçš„broadcastæ“ä½œï¼› 3ï¼‰åˆ†å¸ƒå¼è®­ç»ƒparameter server å‚æ•°æœåŠ¡å™¨ç»“æ„é‡Œçš„ masterèŠ‚ç‚¹ broadcast æ•°æ®åˆ°workerèŠ‚ç‚¹ï¼Œå†ä»workerèŠ‚ç‚¹reduceæ•°æ®å›masterèŠ‚ç‚¹é‡Œçš„broadcastæ“ä½œï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:1","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"Scatter åŒBroadcastä¸€æ ·ï¼ŒScatterä¹Ÿæ˜¯ä¸€ä¸ª1å¯¹å¤šçš„é€šä¿¡åŸè¯­ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ•°æ®å‘é€è€…ï¼Œå¤šä¸ªæ•°æ®æ¥æ”¶è€…ï¼Œå¯ä»¥åœ¨é›†ç¾¤å†…æŠŠä¸€ä¸ªèŠ‚ç‚¹è‡ªèº«çš„æ•°æ®å‘æ•£åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šã€‚ä¸Broadcastä¸åŒçš„æ˜¯BroadcastæŠŠä¸»èŠ‚ç‚¹0çš„æ•°æ®å‘é€ç»™æ‰€æœ‰èŠ‚ç‚¹ï¼Œè€ŒScatteråˆ™æ˜¯å°†æ•°æ®çš„è¿›è¡Œåˆ‡ç‰‡å†åˆ†å‘ç»™é›†ç¾¤å†…æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸ç›¸åŒçš„é¢œè‰²çš„å°æ–¹å—ä»£è¡¨ä¸ç›¸åŒçš„æ•°æ®ï¼Œä¸»èŠ‚ç‚¹ 0 å°†æ•°æ®åˆ†ä¸ºå››ä»½åˆ†å‘åˆ°äº†èŠ‚ç‚¹0-3ã€‚ Scatteræ˜¯æ•°æ®çš„1å¯¹å¤šçš„åˆ†å‘ï¼Œå®ƒå°†ä¸€å¼ XPUå¡ä¸Šçš„æ•°æ®è¿›è¡Œåˆ†ç‰‡å†åˆ†å‘åˆ°å…¶ä»–æ‰€æœ‰çš„XPUå¡ä¸Šï¼Œä»–çš„åå‘æ“ä½œå¯¹åº”Gatherï¼Œå…¶åº”ç”¨åœºæ™¯æœ‰: 1ï¼‰ReduceScatterç»„åˆé‡Œçš„ Scatteræ“ä½œï¼› 2ï¼‰æ¨¡å‹å¹¶è¡Œé‡Œåˆå§‹åŒ–æ—¶å°†æ¨¡å‹scatteråˆ°ä¸åŒçš„XPUä¸Šï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:2","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"Gather Gatheræ“ä½œå±äºå¤šå¯¹1çš„é€šä¿¡åŸè¯­ï¼Œå…·æœ‰å¤šä¸ªæ•°æ®å‘é€è€…ï¼Œä¸€ä¸ªæ•°æ®æ¥æ”¶è€…ï¼Œå¯ä»¥åœ¨é›†ç¾¤å†…æŠŠå¤šä¸ªèŠ‚ç‚¹çš„æ•°æ®æ”¶é›†åˆ°ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸ç›¸åŒçš„é¢œè‰²çš„å°æ–¹å—ä»£è¡¨ä¸ç›¸åŒçš„æ•°æ®ã€‚ Gatheræ˜¯æ•°æ®çš„å¤šå¯¹1çš„æ”¶é›†ï¼Œå®ƒå°†å¤šå¼ XPUå¡ä¸Šçš„æ•°æ®æ”¶é›†åˆ°1å¼ XPUå¡ä¸Šï¼Œä»–çš„åå‘æ“ä½œå¯¹åº”Scatterï¼Œå…¶åº”ç”¨åœºæ™¯æœ‰ï¼š 1ï¼‰ReduceScatterç»„åˆé‡Œçš„ Scatteræ“ä½œï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:3","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"AllGather AllGatherå±äºå¤šå¯¹å¤šçš„é€šä¿¡åŸè¯­ï¼Œå…·æœ‰å¤šä¸ªæ•°æ®å‘é€è€…ï¼Œå¤šä¸ªæ•°æ®æ¥æ”¶è€…ï¼Œå¯ä»¥åœ¨é›†ç¾¤å†…æŠŠå¤šä¸ªèŠ‚ç‚¹çš„æ•°æ®æ”¶é›†åˆ°ä¸€ä¸ªä¸»èŠ‚ç‚¹ä¸Šï¼ˆGatherï¼‰ï¼Œå†æŠŠè¿™ä¸ªæ”¶é›†åˆ°çš„æ•°æ®åˆ†å‘åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šï¼ˆbroadcastï¼‰ï¼Œå³æ”¶é›†é›†ç¾¤å†…æ‰€æœ‰çš„æ•°æ®åˆ°æ‰€æœ‰çš„èŠ‚ç‚¹ä¸Šã€‚ AllGatheræ˜¯æ•°æ®çš„å¤šå¯¹å¤šçš„åŒæ­¥å…¨æ”¶é›†ï¼Œå®ƒå°†å¤šå¼ XPUå¡ä¸Šçš„æ•°æ®æ”¶é›†åˆ°å¤šå¼ XPUå¡ä¸Šï¼Œå¯ä»¥çœ‹åšGather + Broadcastçš„æ“ä½œç»„åˆï¼Œå®ƒçš„åå‘æ“ä½œå¯¹åº”ReduceScatterï¼Œå…¶æœ€åº”ç”¨åœºæ™¯æœ‰ï¼š 1ï¼‰ AllGatherå¯åº”ç”¨äºæ¨¡å‹å¹¶è¡Œï¼› 2ï¼‰æ¨¡å‹å¹¶è¡Œé‡Œå‰å‘è®¡ç®—é‡Œçš„å‚æ•°å…¨åŒæ­¥ï¼Œéœ€è¦ç”¨allgatheræŠŠæ¨¡å‹å¹¶è¡Œé‡Œå°†åˆ‡åˆ†åˆ°ä¸åŒçš„XPUä¸Šçš„å‚æ•°å…¨åŒæ­¥åˆ°ä¸€å¼ XPUä¸Šæ‰èƒ½è¿›è¡Œå‰å‘è®¡ç®—ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:4","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"Reduce Reduceå±äºå¤šå¯¹1çš„é€šä¿¡åŸè¯­ï¼Œå…·æœ‰å¤šä¸ªæ•°æ®å‘é€è€…ï¼Œä¸€ä¸ªæ•°æ®æ¥æ”¶è€…ï¼Œå¯ä»¥åœ¨é›†ç¾¤å†…æŠŠå¤šä¸ªèŠ‚ç‚¹çš„æ•°æ®è§„çº¦è¿ç®—åˆ°ä¸€ä¸ªä¸»èŠ‚ç‚¹ä¸Šï¼Œå¸¸ç”¨çš„è§„çº¦æ“ä½œç¬¦æœ‰ï¼šæ±‚ç´¯åŠ å’ŒSUMã€æ±‚ç´¯ä¹˜ç§¯PRODã€æ±‚æœ€å¤§å€¼MAXã€æ±‚æœ€å°å€¼MINã€é€»è¾‘ä¸ LANDã€æŒ‰ä½ä¸BANDã€é€»è¾‘æˆ–LORã€æŒ‰ä½æˆ–BORã€é€»è¾‘å¼‚æˆ–LXORã€æŒ‰ä½å¼‚æˆ–BOXRã€æ±‚æœ€å¤§å€¼å’Œæœ€å°å¤§çš„ä½ç½®MAXLOCã€æ±‚æœ€å°å€¼å’Œæœ€å°å€¼çš„ä½ç½®MINLOCç­‰ï¼Œè¿™äº›è§„çº¦è¿ç®—ä¹Ÿéœ€è¦åŠ é€Ÿå¡æ”¯æŒå¯¹åº”çš„ç®—å­æ‰èƒ½ç”Ÿæ•ˆã€‚ Reuduceæ“ä½œä»é›†ç¾¤å†…æ¯ä¸ªèŠ‚ç‚¹ä¸Šè·å–ä¸€ä¸ªè¾“å…¥æ•°æ®ï¼Œé€šè¿‡è§„çº¦è¿ç®—æ“ä½œåï¼Œå¾—åˆ°ç²¾ç®€æ•°æ®ï¼Œå¦‚ä¸‹å›¾çš„SUMæ±‚ç´¯åŠ å’Œï¼šèŠ‚ç‚¹0æ•°å€¼ 5ã€èŠ‚ç‚¹1æ•°å€¼6ã€èŠ‚ç‚¹2æ•°å€¼7ã€èŠ‚ç‚¹3æ•°å€¼8ï¼Œç»è¿‡SUMè¿ç®—å ç´¯ç§¯å’Œä¸º 26ï¼Œå³å¾—åˆ°æ›´ä¸ºç²¾ç®€çš„æ•°å€¼ï¼Œåœ¨reduceåŸè¯­é‡Œå›ä¼šå»è°ƒç”¨ reduce SUMç®—å­æ¥å®Œæˆè¿™ä¸ªæ±‚å’Œç´¯åŠ ã€‚ Reduceæ˜¯æ•°æ®çš„å¤šå¯¹1çš„è§„çº¦è¿ç®—ï¼Œå®ƒå°†æ‰€æœ‰å¼ XPUå¡ä¸Šçš„æ•°æ®è§„çº¦ï¼ˆæ¯”å¦‚SUMæ±‚å’Œï¼‰åˆ°1å¼ XPUå¡ä¸Šï¼Œå…¶åº”ç”¨åœºæ™¯æœ‰ï¼š 1ï¼‰AllReduceé‡Œçš„ broadcast + reduceç»„åˆé‡Œçš„reduceæ“ä½œï¼› 2ï¼‰ReduceScatterç»„åˆé‡Œçš„ reduceæ“ä½œï¼› 3ï¼‰åˆ†å¸ƒå¼è®­ç»ƒparameter server å‚æ•°æœåŠ¡å™¨ç»“æ„é‡Œçš„ masterèŠ‚ç‚¹ broadcast æ•°æ®åˆ°workerèŠ‚ç‚¹ï¼Œå†ä»workerèŠ‚ç‚¹reduceæ•°æ®å›masterèŠ‚ç‚¹é‡Œçš„reduceæ“ä½œï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:5","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"ReduceScatter ReduceScatterå±äºå¤šå¯¹å¤šçš„é€šä¿¡åŸè¯­ï¼Œå…·æœ‰å¤šä¸ªæ•°æ®å‘é€è€…ï¼Œå¤šä¸ªæ•°æ®æ¥æ”¶è€…ï¼Œå…¶åœ¨é›†ç¾¤å†…çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šéƒ½æŒ‰ç»´åº¦æ‰§è¡Œç›¸åŒçš„Reduceè§„çº¦è¿ç®—ï¼Œå†å°†ç»“æœå‘æ•£åˆ°é›†ç¾¤å†…æ‰€æœ‰çš„èŠ‚ç‚¹ä¸Šï¼ŒReduce-scatterç­‰ä»·äºèŠ‚ç‚¹ä¸ªæ•°æ¬¡çš„reduceè§„çº¦è¿ç®—æ“ä½œï¼Œå†åé¢æ‰§è¡ŒèŠ‚ç‚¹ä¸ªæ•°çš„scatteræ¬¡æ“ä½œï¼Œå…¶åå‘æ“ä½œæ˜¯AllGatherã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…ˆreduceæ“ä½œ XPU 0-3çš„æ•°æ®reduceä¸º A(A0+A1+A2+A3) + B(B0 + B1 +B2 + B3) + C(C0 + C1 + C2 + C3) + D(D0 + D1 + D2 + D3 ) åˆ°ä¸€å¼ XPUä¸Šï¼Œå†è¿›è¡Œåˆ†ç‰‡scatteråˆ°é›†ç¾¤å†…æ‰€æœ‰çš„XPUå¡ä¸Šã€‚ ReduceScatteræ˜¯æ•°æ®çš„å¤šå¯¹å¤šçš„reduce + scatterè¿ç®—ï¼Œå®ƒå°†æ‰€æœ‰çš„XPUå¡ä¸Šçš„æ•°æ®å…ˆè§„çº¦ï¼ˆæ¯”å¦‚SUMæ±‚å’Œï¼‰åˆ°1å¼ XPUå¡ä¸Šï¼Œå†è¿›è¡Œscatterï¼Œå…¶åº”ç”¨åœºæ™¯æœ‰ï¼š 1ï¼‰ReduceScatterå³å¯åº”ç”¨äºæ•°æ®å¹¶è¡Œä¹Ÿå¯åº”ç”¨äºæ¨¡å‹å¹¶è¡Œï¼› 2ï¼‰æ•°æ®å¹¶è¡ŒallReduceé‡Œçš„ ReduceScatter+ Allgatherç»„åˆé‡Œçš„ReduceScatteræ“ä½œï¼› 3ï¼‰æ¨¡å‹å¹¶è¡Œé‡Œåœ¨å‰å‘allgatheråçš„åå‘è®¡ç®—é‡Œçš„ReduceScatterï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:6","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"AllReduce AllReduceå±äºå¤šå¯¹å¤šçš„é€šä¿¡åŸè¯­ï¼Œå…·æœ‰å¤šä¸ªæ•°æ®å‘é€è€…ï¼Œå¤šä¸ªæ•°æ®æ¥æ”¶è€…ï¼Œå…¶åœ¨é›†ç¾¤å†…çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šéƒ½æ‰§è¡Œç›¸åŒçš„Reduceæ“ä½œï¼Œå¯ä»¥å°†é›†ç¾¤å†…æ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®è§„çº¦è¿ç®—å¾—åˆ°çš„ç»“æœå‘é€åˆ°æ‰€æœ‰çš„èŠ‚ç‚¹ä¸Šã€‚AllReduceæ“ä½œå¯é€šè¿‡åœ¨ä¸»èŠ‚ç‚¹ä¸Šæ‰§è¡ŒReduce + Broadcastæˆ–ReduceScatter + AllGatherå®ç°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå…ˆåœ¨ä¸»èŠ‚ç‚¹ä¸Šæ‰§è¡Œreduceå¾—åˆ°è§„çº¦ç´¯åŠ å’Œ26ï¼Œå†æŠŠè¿™ä¸ªç´¯åŠ å’Œ26 broadcaståˆ°å…¶ä»–çš„èŠ‚ç‚¹ï¼Œè¿™æ ·æ•´ä¸ªé›†ç¾¤å†…ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„æ•°å€¼å°±éƒ½ä¿æŒä¸€è‡´ã€‚ AllReduceæ˜¯æ•°æ®çš„å¤šå¯¹å¤šçš„è§„çº¦è¿ç®—ï¼Œå®ƒå°†æ‰€æœ‰çš„XPUå¡ä¸Šçš„æ•°æ®è§„çº¦ï¼ˆæ¯”å¦‚SUMæ±‚å’Œï¼‰åˆ°é›†ç¾¤å†…æ¯å¼ XPUå¡ä¸Šï¼Œå…¶åº”ç”¨åœºæ™¯æœ‰ï¼š 1ï¼‰ AllReduceåº”ç”¨äºæ•°æ®å¹¶è¡Œï¼› 2ï¼‰æ•°æ®å¹¶è¡Œå„ç§é€šä¿¡æ‹“æ‰‘ç»“æ„æ¯”å¦‚Ring allReduceã€Tree allReduceé‡Œçš„ allReduceæ“ä½œï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:7","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"All-To-All All-To-Allæ“ä½œæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®ä¼šscatteråˆ°é›†ç¾¤å†…æ‰€æœ‰èŠ‚ç‚¹ä¸Šï¼ŒåŒæ—¶æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿä¼šGatheré›†ç¾¤å†…æ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®ã€‚ALLTOALLæ˜¯å¯¹ALLGATHERçš„æ‰©å±•ï¼ŒåŒºåˆ«æ˜¯ALLGATHER æ“ä½œä¸­ï¼Œä¸åŒèŠ‚ç‚¹å‘æŸä¸€èŠ‚ç‚¹æ”¶é›†åˆ°çš„æ•°æ®æ˜¯ç›¸åŒçš„ï¼Œè€Œåœ¨ALLTOALLä¸­ï¼Œä¸åŒçš„èŠ‚ç‚¹å‘æŸä¸€èŠ‚ç‚¹æ”¶é›†åˆ°çš„æ•°æ®æ˜¯ä¸åŒçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º: AllToAllæ˜¯æ•°æ®çš„å¤šå¯¹å¤šçš„è½¬ç½®ï¼Œå®ƒå°†æ‰€æœ‰å¼ XPUå¡ä¸Šçš„æ•°æ®è½¬ç½®åˆ°æ‰€æœ‰çš„XPUå¡ä¸Šï¼Œå…¶ä¸»è¦åº”ç”¨åœºæ™¯æœ‰ï¼š 1ï¼‰ AllToAllåº”ç”¨äºæ¨¡å‹å¹¶è¡Œï¼› 2ï¼‰æ¨¡å‹å¹¶è¡Œé‡Œçš„çŸ©é˜µè½¬ç½®ï¼› 3ï¼‰æ•°æ®å¹¶è¡Œåˆ°æ¨¡å‹å¹¶è¡Œçš„çŸ©é˜µè½¬ç½®ï¼› ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:8","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"Send ä¸ Receive æ•°æ®æˆ–å‚æ•°åœ¨ä¸åŒXPUä¹‹é—´çš„å‘é€ä¸æ¥æ”¶ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:9","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"Barrier BARRIERåŒæ­¥æ“ä½œä¼šé˜»å¡æ‰€æœ‰çš„è°ƒç”¨è€…ç›´åˆ°æ‰€æœ‰çš„ç»„å†…æˆå‘˜éƒ½è°ƒç”¨äº†å®ƒï¼Œ ç”¨äºä¸€ä¸ªé›†åˆé€šä¿¡å­ä¸­æ‰€æœ‰è¿›ç¨‹çš„åŒæ­¥ï¼Œè°ƒç”¨å‡½æ•°æ—¶è¿›ç¨‹å°†å¤„äºç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°é€šä¿¡å­ä¸­æ‰€æœ‰è¿›ç¨‹ éƒ½è°ƒç”¨äº†è¯¥å‡½æ•°åæ‰ç»§ç»­æ‰§è¡Œã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:10","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"Signalä¸Wait Signalä¸Waitå±äºè®°å½•å‹ä¿¡å·é‡æœºåˆ¶ï¼š wait(s)ï¼Œsignal(s)å¯ç”¨äºè§£å†³è¿›ç¨‹é—´çš„åŒæ­¥é—®é¢˜ï¼Œåœ¨é€šä¿¡åŸè¯­é‡Œä»ä¸€ä¸ªèŠ‚ç‚¹å‘é€ä¸€ä¸ªæ•°æ®åˆ°å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œä¼šåŒæ—¶signalä¸€ä¸ªeventå€¼åˆ°å¯¹ç«¯ï¼Œå¯¹ç«¯çš„waitæ“ä½œæ¥æ”¶åˆ°è¿™ä¸ªeventæ—¶ä¼šè¿”å›ä¸€ä¸ªç¡®è®¤ç»™signalï¼Œè¿™æ ·ä¿è¯åœ¨èŠ‚ç‚¹çš„è¿›ç¨‹é—´è¿›è¡Œæ•°æ®çš„åŒæ­¥æ“ä½œã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:2:11","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"å°ç»“ åœ¨åˆ†å¸ƒå¼è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ·±åº¦å­¦ä¹ è®­ç»ƒæ¡†æ¶ä¸ä¼šå»ç›´æ¥æ“ä½œåº•å±‚çš„é€šä¿¡ç½‘ç»œï¼Œè€Œæ˜¯é€šè¿‡ä½¿ç”¨ç½‘ç»œé€šä¿¡åº“æ¥å®Œæˆæ•°æ®çš„é›†åˆé€šä¿¡ï¼Œå„å®¶AIèŠ¯ç‰‡åŠ é€Ÿå¡å‚å®¶éƒ½ä¼šæä¾›ç§æœ‰çš„ç½‘ç»œé€šä¿¡åº“æ¯”å¦‚ï¼šxxx-AWARE OpenMPIæˆ–xCCLæ¥å®Œæˆè¿™ä¸ªåº•å±‚é€šä¿¡ç¡¬ä»¶çš„å±è”½ä¸æŠ½è±¡ã€‚åœ¨åˆ†å¸ƒå¼è®­ç»ƒé›†ç¾¤é‡Œç½‘ç»œé€šä¿¡ç¡¬ä»¶è¿æ¥æ ·å¼å¤šç§å¤šæ ·ï¼Œå¯ä»¥æ˜¯Ethernetã€InfiniBand ã€RoCE v2/v1 ç­‰ä¹Ÿå¯ä»¥æ˜¯CXLã€NVLINKç­‰ç§æœ‰åè®®ï¼Œè¿™å°±è¦æ±‚åœ¨é€šä¿¡çš„åç«¯å±‚æ ¹æ®å„ä¸ªå‚å®¶çš„è‡ªå·±çš„SDKå¼€å‘åº“æ¥å£ï¼Œæ ¹æ®å®é™…æƒ…å†µå®ç° å„è‡ªçš„ç½‘ç»œé€šä¿¡åº“ï¼Œæ¯”å¦‚cuda-aware MPIã€NCCLã€NVSHMEMï¼Œä»¥åŠæ ¹æ®å®é™…çš„ç½‘ç»œæ‹“æ‰‘ç»„åˆå®Œæˆå¯¹åº”çš„æœ€æœ‰æ•ˆçš„ç½‘ç»œæ‹“æ‰‘ç®—æ³•ã€‚ æœ¬æ–‡è®²è¿°äº†åˆ†å¸ƒå¼è®­ç»ƒé‡Œçš„é›†åˆé€šä¿¡åŸè¯­ï¼Œè¿™äº›åŸè¯­æ˜¯é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•çš„åŸºæœ¬ç»„æˆå•å…ƒï¼Œåç»­çš„æ–‡ç« é‡Œä¼šè®²è¿°å¦‚ä½•ç»„åˆè¿™äº›é€šä¿¡åŸè¯­ä»¥å®Œæˆåˆé€‚çš„é€šä¿¡æ‹“æ‰‘ç®—æ³•ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_3/:3:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬3ç¯‡ - é›†åˆé€šä¿¡åŠå…¶é€šä¿¡åŸè¯­","uri":"/posts/distributedtraining_3/"},{"categories":["Distributed Computing"],"content":"ref: [1]. https://zhuanlan.zhihu.com/p/492667659 ","date":"2023-07-13","objectID":"/posts/distributedtraining_2/:0:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬2ç«  - è®­ç»ƒä¸ç³»ç»Ÿè¯„ä»·æŒ‡æ ‡","uri":"/posts/distributedtraining_2/"},{"categories":["Distributed Computing"],"content":"å‰è¨€ ä¸åŒäºæ•™ç§‘ä¹¦é‡Œè®²çš„æ·±åº¦å­¦ä¹ çš„è¯„ä»·æŒ‡æ ‡ï¼Œè¿™é‡Œä¸»è¦è®²è¿°ç”Ÿäº§è®­ç»ƒä¸­å¸¸ç”¨çš„è¯„ä»·æŒ‡æ ‡ã€‚é€šå¸¸åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­å¯¹è®­ç»ƒçš„è¿‡ç¨‹ä¸ç»“æœä¼šè¿›è¡Œè¯„ä»·ï¼Œæ¯”å¦‚é€‰æ‹©ä¸€ä¸ªè¯„ä»·æŒ‡æ ‡ï¼šå‡†ç¡®ç‡ï¼Œå³è¡¨æ˜æ¨¡å‹æ±‚è§£ç»™å®šé—®é¢˜çš„å‡†ç¡®åº¦ã€‚è€Œæœ¬æ–‡æåˆ°çš„è¯„ä»·æŒ‡æ ‡ä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œå³è®­ç»ƒç»“æœè¯„ä»·ä¸è®­ç»ƒç³»ç»Ÿè¯„ä»·ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_2/:1:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬2ç«  - è®­ç»ƒä¸ç³»ç»Ÿè¯„ä»·æŒ‡æ ‡","uri":"/posts/distributedtraining_2/"},{"categories":["Distributed Computing"],"content":"è®­ç»ƒæŒ‡æ ‡ æ•™ç§‘ä¹¦é‡Œç»å¸¸æåˆ°çš„æ·±åº¦å­¦ä¹ çš„è¯„ä»·æŒ‡æ ‡æœ‰å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1å€¼ç­‰ï¼Œå¦‚ä¸‹ï¼š å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰ï¼Œæ‰€æœ‰çš„é¢„æµ‹æ­£ç¡®ï¼ˆæ­£ç±»è´Ÿç±»ï¼‰çš„å æ€»çš„æ¯”é‡ï¼› ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰ï¼ŒæŸ¥å‡†ç‡ï¼Œå³æ­£ç¡®é¢„æµ‹ä¸ºæ­£çš„å å…¨éƒ¨é¢„æµ‹ä¸ºæ­£çš„æ¯”ä¾‹ï¼› å¬å›ç‡ï¼ˆRecallï¼‰ï¼ŒæŸ¥å…¨ç‡ï¼Œå³æ­£ç¡®é¢„æµ‹ä¸ºæ­£çš„å å…¨éƒ¨å®é™…ä¸ºæ­£çš„æ¯”ä¾‹ï¼› F1å€¼ï¼ˆH-meanå€¼ï¼‰ï¼ŒF1å€¼ä¸ºç®—æ•°å¹³å‡æ•°é™¤ä»¥å‡ ä½•å¹³å‡æ•°ï¼Œä¸”è¶Šå¤§è¶Šå¥½ï¼› å®é™…ä¸Šè¿™äº›æŒ‡æ ‡åœ¨çœŸæ­£çš„ç”Ÿäº§è¿‡ç¨‹ä¸­ç”¨çš„ä¸å¤šï¼Œåœ¨å®é™…çš„åˆ†å¸ƒå¼è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯”è¾ƒå…³å¿ƒçš„è®­ç»ƒè¯„ä»·æŒ‡æ ‡æœ‰ï¼š åŠ é€Ÿæ¯”ï¼ˆspeedupï¼‰ï¼Œå³å¤šå¡è®­ç»ƒä¸‹çš„å•å¡ååé‡å¹³å‡æŒ‡æ ‡é™¤ä»¥å•å¡è®­ç»ƒä¸‹çš„ååé‡å¹³å‡æŒ‡æ ‡ï¼Œæ¯”å¦‚ï¼Œå¤§è§„æ¨¡è®­ç»ƒä¸‹çš„ ResNet-50 v1.5çš„å•å¡FPSæŒ‡æ ‡æ˜¯600ï¼Œè€Œå•å¡è®­ç»ƒçš„FPSæŒ‡æ ‡æ˜¯800ï¼Œé‚£ä¹ˆåŠ é€Ÿæ¯”å³ 600/800 = 0.75ï¼ŒåŠ é€Ÿæ¯”ä½“ç°çš„æ˜¯è®­ç»ƒé›†ç¾¤çš„æ•ˆç‡ä¸å¯æ‰©å±•æ€§ï¼Œè¶Šé«˜çš„åŠ é€Ÿæ¯”è¡¨æ˜è®­ç»ƒé›†ç¾¤çš„èµ„æºåˆ©ç”¨ç‡è¶Šé«˜ï¼Œä½†æ˜¯è¶Šé«˜çš„åŠ é€Ÿæ¯”è¦æ±‚å¯¹è®­ç»ƒé›†ç¾¤çš„æŠ€æœ¯è¦æ±‚ä¹Ÿè¶Šé«˜ã€‚æ¯”å¦‚ ä¸€ä¸ª 1000å¼ å¡çš„è®­ç»ƒé›†ç¾¤ï¼Œè¦æ±‚ åŠ é€Ÿæ¯” 0.9ä»¥ä¸Šï¼Œé‚£ä¹ˆå¯¹äºä¸»æœºé—´çš„ç½‘ç»œã€ä¸»æœºå†…çš„ç½‘ç»œã€å…¨æ ˆè½¯ä»¶ã€è®­ç»ƒå¡å†…éƒ¨çš„ç¡¬ä»¶æ¶æ„ã€é›†åˆé€šä¿¡æ‹“æ‰‘ç®—æ³•ã€è®­ç»ƒç®—æ³•çš„ä¼˜åŒ–ç­‰çš„è¦æ±‚éƒ½æé«˜ï¼Œè¿™å°±æ¶‰åŠåˆ°æ•´ä¸ªåˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿçš„é—®é¢˜ï¼Œè€Œä¸æ˜¯å•ä¸ªç‚¹èƒ½å½»åº•è§£å†³çš„ï¼› ååé‡ï¼Œsequence/sec æˆ– FPS, å³æ¯ç§’èƒ½å¤„ç†çš„å›¾ç‰‡æ•°æˆ–æ•°æ®é‡ï¼› æ”¶æ•›æ—¶é—´ï¼ˆTimeï¼‰ä¸è®­ç»ƒæ¬¡æ•°ï¼ˆepochï¼‰ï¼Œç”Ÿäº§è¿‡ç¨‹ä¸­å¯¹è®­ç»ƒæ‰€æœ‰çš„æ—¶é—´æ˜¯æœ‰è¦æ±‚çš„ï¼Œå‡è®¾ç»™å®šä¸€ä¸ªæ¨¡å‹çš„è®­ç»ƒæ¬¡æ•°(epoch)ä¸º100ï¼Œå¦‚æœè¦æŠŠè¿™ä¸ª100æ¬¡éƒ½è®­ç»ƒå®Œéœ€è¦ å¥½å‡ å¤©ï¼Œç”šè‡³å¥½å‡ ä¸ªæ˜ŸæœŸï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºç”Ÿäº§ä¸é€‚ç”¨ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥å®šä¹‰ è®­ç»ƒä¸€ä¸ªæ¨¡å‹åˆ°æ”¶æ•›éœ€è¦ 24å°æ—¶ä»¥ä¸Šï¼Œéƒ½å¯ä»¥çœ‹åšæ˜¯ç”Ÿäº§ä¸é€‚ç”¨ï¼Œéœ€è¦æ‰©å¤§è®­ç»ƒé›†ç¾¤çš„è§„æ¨¡ï¼Œä½¿ä¹‹è®­ç»ƒæ—¶é—´æ§åˆ¶åœ¨24å°æ—¶ä¹‹å†…ï¼› å¹³å‡å‡†ç¡®ç‡(eval Accuracy)ï¼Œå¹³å‡å‡†ç¡®ç‡æ˜¯è®­ç»ƒæ˜¯å¦æ”¶æ•›çš„é‡è¦è¯„åˆ¤æ ‡å‡†ä¹‹ä¸€ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ª Resnet50 v1.5 çš„è®­ç»ƒæ¨¡å‹çš„å‡†ç¡®ç‡ä¸º 76%ï¼Œå¦‚æœè®­ç»ƒç»“æŸçš„å¹³å‡å‡†ç¡®ç‡èƒ½è¾¾åˆ°è¿™ä¸ªå€¼å°±è®¤ä¸ºè®­ç»ƒæ˜¯æ”¶æ•›çš„ï¼› å¯æ”¶æ•›ï¼Œè®­ç»ƒçš„æœ€ç»ˆç»“æœå¯ä»¥è¾¾åˆ° å¹³å‡å‡†ç¡®ç‡çš„è¦æ±‚ï¼Œå³è®¤ä¸ºå¯æ”¶æ•›ï¼Œå¦è€…å³ä»»åŠ¡è®­ç»ƒå¤±è´¥ï¼› å­¦ä¹ ç‡(Learning rate)ä¸æŸå¤±ç‡(Loss)ï¼Œå­¦ä¹ ç‡å¤§æ¨¡å‹è®­ç»ƒå­¦ä¹ é€Ÿåº¦å¿«ï¼Œä½†æ˜¯æ˜“å¯¼è‡´æŸå¤±ç‡çˆ†ç‚¸, å­¦ä¹ ç‡å°æ¨¡å‹è®­ç»ƒå­¦ä¹ é€Ÿåº¦æ…¢ï¼Œè€Œä¸”å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œæ”¶æ•›é€Ÿåº¦æ…¢ï¼› æ›²çº¿æ‹Ÿåˆ(Curve Fitting)ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„è¯„ä»·æ‰‹æ®µï¼Œåœ¨XPUè®­ç»ƒçš„åœºæ™¯ä¸‹ï¼Œé€šå¸¸å…ˆç”¨ä¸€ä¸ªå·²æœ‰çš„ä¹‹å‰è®­ç»ƒå¥½æ¨¡å‹ä¸ºåŸºç¡€æˆ–å…ˆç”¨GPUè®­ç»ƒå‡ºä¸€ä¸ªåŸºç¡€æ¨¡å‹ï¼Œç„¶åæŠŠXPUè®­ç»ƒçš„ç»“æœæŒ‡æ ‡è·ŸGPUè®­ç»ƒæ¨¡å‹çš„æŒ‡æ ‡è¿›è¡Œæ¯”è¾ƒï¼Œæ›²çº¿æ‹Ÿåˆå³è®¤ä¸ºXPUçš„è®­ç»ƒç»“æœè¾¾æ ‡ï¼Œè¿™ä¹Ÿæ˜¯è°ƒè¯•XPUè®­ç»ƒç»“æœçš„ä¸€ä¸ªé‡è¦æ‰‹æ®µã€‚è¿™é‡ŒåŸ‹ä¸€ä¸ªé—®é¢˜ï¼ŒæŒ‰ç…§æ›²çº¿æ‹Ÿåˆçš„è¯´æ³•ï¼Œå‡è®¾æœ‰ä¸€ä¸ª2000å¼ XPUå¡çš„é›†ç¾¤ï¼Œæ€æ ·è¯„ä»·è¿™ä¸ªé›†ç¾¤è®­ç»ƒçš„ç»“æœæ˜¯æ­£ç¡®çš„ï¼Ÿä»¥GPUè®­ç»ƒçš„ç»“æœåšæ¯”è¾ƒï¼Œé‚£ä¹ˆæ‰¾ä¸€ä¸ªè¿™ä¹ˆå¤§è§„æ¨¡çš„GPUé›†ç¾¤è¿›è¡Œè®­ç»ƒç„¶åå¾—åˆ°æƒ³è¦çš„æ¨¡å‹åšåŸºç¡€åŒ¹é…ä¹Ÿæ˜¯ä¸å¤§ç°å®çš„ï¼Œé‚£ä¹ˆéœ€è¦é‡‡ç”¨ä»€ä¹ˆæŠ€æœ¯æ–¹æ¡ˆæ‰èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ ä»¥TensorBoardä¸ºä¾‹ï¼Œè¯´æ˜æ¨¡å‹çš„è¯„ä»·æŒ‡æ ‡ï¼Œåœ¨ä¸‹é¢çš„å‘½ä»¤è¡Œåˆ—è¾“å…¥ä¸€ä¸ªbaseline:/log_path_2ï¼š tensorboard --logdir=training_model:/log_path_1, baseline:/log_path_2 è¿™ä¸ªbaseline çš„æ¨¡å‹å·²ç»ç¡®å®šæ˜¯ç²¾åº¦è¾¾æ ‡ï¼Œç”Ÿäº§å¯ç”¨çš„ã€‚ç„¶å XPUè®­ç»ƒçš„æ¨¡å‹çš„ training_model:/log_path_1 ä¸è¿™ä¸ªGPUè®­ç»ƒå¤„çš„baselineè¿›è¡Œæ¯”ï¼Œåœ¨tensorboardé‡Œå¯ä»¥è¡¨ç°å¦‚ä¸‹å›¾ï¼š åœ¨ä¸Šå›¾é‡Œï¼Œæ–°çš„æ¨¡å‹çš„eval_accuracyå€¼ä¸baselineçš„å€¼æœ€ç»ˆæ˜¯ä¸€æ ·çš„ï¼Œè¿™è¯´æ˜è®­ç»ƒç»“æœæ˜¯æ”¶æ•›ä¸”ç²¾åº¦è¾¾æ ‡ï¼Œeval_accuracyä¸­é—´çš„çº¿æœ‰ç‚¹å·®å¼‚æ˜¯ç”±äºæŒ‰ä¸åŒçš„è®­ç»ƒæ¬¡æ•°è¿›è¡ŒtensorboardæŒ‡æ ‡ä¿å­˜æ‰€é€ æˆã€‚æ–°æ¨¡å‹çš„Lossçº¿ä¸Learning_rate çº¿ä¹Ÿä¸åŸºç¡€çº¿å»åˆï¼Œè¿™è¯´æ˜XPUè®­ç»ƒçš„æ¨¡å‹è´¨é‡å¯ç”Ÿäº§é€‚ç”¨ã€‚eval_accuracyã€Lossã€Learning_rateæ˜¯ä¸‰ä¸ªæœ€é‡è¦çš„åº¦é‡æŒ‡æ ‡ï¼Œåªè¦è¿™æ ·ä¸‰ä¸ªæŒ‡æ ‡è¾¾æ ‡ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡å³å¯åˆ¤æ–­è¿™ä¸ªåœ¨XPUä¸‹æ–°è®­ç»ƒçš„æ¨¡å‹å…·å¤‡ç”Ÿäº§å¯ç”¨èƒ½åŠ›ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_2/:2:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬2ç«  - è®­ç»ƒä¸ç³»ç»Ÿè¯„ä»·æŒ‡æ ‡","uri":"/posts/distributedtraining_2/"},{"categories":["Distributed Computing"],"content":"ç³»ç»ŸæŒ‡æ ‡ åˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿå…¶æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå› æ­¤é™¤äº†è®­ç»ƒé¢†åŸŸç›¸å…³çš„åº¦é‡æŒ‡æ ‡ï¼Œä¹Ÿæœ‰ä¸åˆ†å¸ƒå¼ç³»ç»Ÿè´¨é‡æœ‰å…³çš„ä¸€å¥—åº¦é‡æŒ‡æ ‡ï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„å‡ é¡¹å†…å®¹å¦‚ä¸‹ï¼š å¯ç”¨æ€§(Availability)ï¼Œå¯ç”¨æ€§æŒ‡çš„æ˜¯åˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿé•¿æ—¶é—´å¯å¯¹å¤–æä¾›æœåŠ¡çš„èƒ½åŠ›ï¼Œé€šå¸¸é‡‡ç”¨å°æ•°ç‚¹åçš„9çš„ä¸ªæ•°ä½œä¸ºåº¦é‡æŒ‡æ ‡ï¼ŒæŒ‰ç…§è¿™ç§çº¦å®šâ€œäº”ä¸ªä¹â€ç­‰äº0.99999ï¼ˆæˆ–99.999ï¼…ï¼‰çš„å¯ç”¨æ€§ï¼Œé»˜è®¤ä¼ä¸šçº§è¾¾æ ‡çš„å¯ç”¨æ€§ä¸º6ä¸ª9ã€‚ä½†æ˜¯å½“å‰ä»æ—¶é—´ç»´åº¦æ¥åº¦é‡å¯ç”¨æ€§å·²ç»æ²¡æœ‰å¤ªå¤§çš„æ„ä¹‰ï¼Œå› ä¸ºè®¾è®¡å¾—å¥½çš„ç³»ç»Ÿå¯ä»¥åœ¨ç³»ç»Ÿå‡ºç°æ•…éšœå¾—æƒ…å†µä¸‹ä¹Ÿèƒ½ä¿è¯å¯¹å¤–æä¾›å¾—æœåŠ¡ä¸ä¸­æ–­ï¼Œå› æ­¤ï¼Œå½“å‰æ›´åˆé€‚å¾—å¯ç”¨æ€§åº¦é‡æŒ‡æ ‡ æ˜¯è¯·æ±‚å¤±è´¥ç‡; å¯é æ€§(Reliability)ï¼Œå¯é æ€§ä¸€èˆ¬æŒ‡ç³»ç»Ÿåœ¨ä¸€å®šæ—¶é—´å†…ã€åœ¨ä¸€å®šæ¡ä»¶ä¸‹å¯ä»¥æ— æ•…éšœåœ°æ‰§è¡ŒæŒ‡å®šåŠŸèƒ½çš„èƒ½åŠ›æˆ–å¯èƒ½æ€§ï¼Œ ä¹Ÿæ˜¯é‡‡ç”¨å°æ•°ç‚¹åçš„9çš„ä¸ªæ•°ä½œä¸ºåº¦é‡æŒ‡æ ‡ï¼Œé€šå¸¸5ä¸ª9çš„å¯é æ€§å°±å¯ä»¥æ»¡è¶³ä¼ä¸šçº§è¾¾æ ‡ï¼› å¯ä¼¸ç¼©æ€§(Scalability)ï¼Œæ˜¯æŒ‡é€šè¿‡å‘ç³»ç»Ÿæ·»åŠ èµ„æºæ¥å¤„ç†è¶Šæ¥è¶Šå¤šçš„å·¥ä½œå¹¶ä¸”ç»´æŒé«˜è´¨é‡æœåŠ¡çš„èƒ½åŠ›ï¼Œå…¶å—å¯ç”¨æ€§ä»¥åŠå¯é æ€§çš„åˆ¶çº¦ï¼Œé›†ç¾¤è§„æ¨¡è¶Šå¤§å‡ºæ•…éšœçš„æ¦‚ç‡è¶Šé«˜ä»è€Œé™ä½å¯ç”¨æ€§ã€å¯é æ€§ï¼Œä¸ºäº†ä¿è¯å¯ç”¨æ€§ä»¥åŠå¯é æ€§è¾¾æ ‡ï¼Œéœ€è¦é€‚é…åˆç†çš„å¯ä¼¸ç¼©æ€§æŒ‡æ ‡ï¼› éŸ§æ€§(resilience)ï¼Œé€šå¸¸ä¹Ÿå«å®¹é”™æ€§ï¼ˆfault-tolerantï¼‰ï¼Œä¹Ÿå°±æ˜¯å¥å£®å’Œå¼ºå£®çš„æ„æ€ï¼ŒæŒ‡çš„æ˜¯ç³»ç»Ÿçš„å¯¹æ•…éšœä¸å¼‚å¸¸çš„å¤„ç†èƒ½åŠ›ï¼Œæ¯”å¦‚åœ¨è½¯ä»¶æ•…éšœã€ç¡¬ä»¶æ•…éšœã€è®¤ä¸ºæ•…éšœè¿™æ ·çš„åœºæ™¯ä¸‹ï¼Œç³»ç»Ÿè¿˜èƒ½ä¿æŒæ­£å¸¸å·¥ä½œçš„èƒ½åŠ›ï¼Œåˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿçš„å®¹é”™èƒ½åŠ›æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æŒ‡æ ‡ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_2/:3:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬2ç«  - è®­ç»ƒä¸ç³»ç»Ÿè¯„ä»·æŒ‡æ ‡","uri":"/posts/distributedtraining_2/"},{"categories":["Distributed Computing"],"content":"å°ç»“ æœ¬æ–‡ä»å®è·µçš„è§’åº¦è®²è¿°äº†åˆ†å¸ƒå¼è®­ç»ƒçš„è®­ç»ƒç»“æœè¯„ä»·æŒ‡æ ‡ä¸ç³»ç»Ÿè¯„ä»·æŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡æ˜¯åº¦é‡ä¸€ä¸ªåˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿä¸è®­ç»ƒçš„æ¨¡å‹æ˜¯å¦ç”Ÿäº§å¯ç”¨çš„é‡è¦å‚è€ƒã€‚æ—¥æ‹±ä¸€å’ï¼ŒåŠŸä¸å”æï¼Œåˆ†äº«æ˜¯æœ€å¥½çš„å­¦ä¹ ï¼Œä¸å…¶è·Ÿéšä¸å¦‚åˆ›æ–°ï¼Œå¸Œæœ›è¿™ä¸ªçŸ¥è¯†ç‚¹å¯¹å¤§å®¶æœ‰ç”¨ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_2/:4:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬2ç«  - è®­ç»ƒä¸ç³»ç»Ÿè¯„ä»·æŒ‡æ ‡","uri":"/posts/distributedtraining_2/"},{"categories":["Distributed Computing"],"content":"ref: [1]. https://zhuanlan.zhihu.com/p/487945343 ","date":"2023-07-13","objectID":"/posts/distributedtraining_1/:0:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬1ç«  - ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒ","uri":"/posts/distributedtraining_1/"},{"categories":["Distributed Computing"],"content":"å‰è¨€ æ·±åº¦å­¦ä¹ è½¯ä»¶å·¥ç¨‹å…·æœ‰ä¸€ä½“ä¸¤é¢æ€§ï¼šå•å¡çš„åŠŸèƒ½å®Œå¤‡æ€§ã€è´¨é‡ã€ç”¨æˆ·ä½“éªŒä»¥åŠå¤šå¡å¤§è§„æ¨¡ã€‚å¤šå¡å¤§è§„æ¨¡çš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³è¿™æ ·ä¸€ä¸ªä¸»è¦çŸ›ç›¾ï¼Œå³ï¼šâ€œæ—¥ç›Šå¢é•¿çš„æ•°æ®ã€æ¨¡å‹è®­ç»ƒçš„éœ€æ±‚ä¸å½“å‰å•å¡è®¡ç®—èƒ½åŠ›æ— æ³•æ»¡è¶³è¿™ä¸ªéœ€æ±‚ä¹‹é—´çš„çŸ›ç›¾â€ï¼Œè€Œåˆ†å¸ƒå¼è®­ç»ƒå¯ä»¥é€šè¿‡æ‰©å±•å¡å­çš„è§„æ¨¡è§£å†³è¿™ä¸ªçŸ›ç›¾ï¼Œå› æ­¤ï¼Œè¿™å°±æ˜¯åˆ†å¸ƒå¼è®­ç»ƒçš„ä»·å€¼ã€‚ ç„¶è€Œï¼Œæ­£å¦‚æ‡‚å¾—å¾ˆå¤šé“ç†ï¼Œä»æ—§è¿‡ä¸å¥½è¿™ä¸€ç”Ÿä¸€æ ·ï¼Œæ‡‚å¾—å¾ˆå¤šåˆ†å¸ƒå¼è®­ç»ƒçš„ç†è®ºä¸çŸ¥è¯†ï¼Œä¹Ÿä¸ä¸€å®šå°±èƒ½åšå¥½ä¸€ä¸ªåˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿã€‚æŠŠè¿™ä¹ˆå¤šæœºå™¨è¿æ¥è·‘èµ·æ¥ã€è·Ÿè·‘å¥½ä¹Ÿæ˜¯ä¸¤å›äº‹ï¼Œåˆ†å¸ƒå¼è®­ç»ƒæ˜¯ä¸€é—¨å®è·µçš„è½¯ä»¶å·¥ç¨‹ï¼Œåªæœ‰ä½ PKè¿‡è®¾è®¡æ–¹æ¡ˆï¼Œè°ƒè¯•è¿‡ä¸€ä¸ªä¸ªBugï¼Œæ‰‹æŠŠæ‰‹çš„æ•²è¿‡ä¸€è¡Œè¡Œçš„ä»£ç ï¼Œä¸ºäº†æ€§èƒ½æŒ‡æ ‡èƒ½è¾¾æ ‡æ— æ‰€ä¸ç”¨å…¶æçš„å»éªŒè¯å„ç§æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼Œæ‰èƒ½çŸ¥é“ç»†èŠ‚åœ¨å“ªé‡Œï¼Œéš¾ç‚¹åœ¨å“ªé‡Œï¼Œç—›ç‚¹ã€æŒ‘æˆ˜ç‚¹åœ¨å“ªé‡Œã€‚å› æ­¤ï¼Œå®è§‚å¤„ç€çœ¼ï¼Œå¾®è§‚å¤„ç€æ‰‹ï¼Œæ‰èƒ½å®Œå…¨ç†è§£åˆ†å¸ƒå¼è®­ç»ƒçš„é“ç†ã€‚ ä¸€ä¸ªçŸ¥è¯†é¢†åŸŸé‡Œçš„ â€œé“ æ³• æœ¯ å™¨â€ è¿™å››ä¸ªå¢ƒç•Œéœ€è¦ä» å¾®è§‚ã€ä¸­è§‚ä»¥åŠå®è§‚ ä¸‰ä¸ªè§’åº¦æ¥æŠŠæ¡ï¼Œå¾®è§‚æ˜¯å®è·µï¼Œä¸­è§‚è®²æ–¹æ³•è®ºï¼Œå®è§‚é é¢†æ‚Ÿã€‚æœ¬ç³»åˆ—æ–‡ç« æˆ‘æŠŠå®ƒå‘½åä¸ºã€Šåˆ†å¸ƒå¼è®­ç»ƒã€‹ï¼Œä»å·¥ç¨‹å®æˆ˜çš„è§’åº¦æ‹†è§£åˆ†å¸ƒå¼è®­ç»ƒé‡Œæœ€é‡è¦çš„å¥—è·¯ï¼Œä¹Ÿæ˜¯ä»â€œå¾®è§‚å®è·µã€ä¸­è§‚æ–¹æ³•è®ºã€å®è§‚é¢†æ‚Ÿâ€è¿™ä¸‰ä¸ªç»´åº¦ç³»ç»Ÿæ€§çš„æ¢è®¨åˆ†å¸ƒå¼è®­ç»ƒæŠ€æœ¯ï¼Œæœ¬æ–‡è®²è¿°ç¬¬ä¸€ç¯‡ï¼Œä¹Ÿæ˜¯æœ€éš¾è®²æ¸…æ¥šçš„ä¸€ç¯‡ï¼ˆåç»­ä¿æŒè¿­ä»£æ›´æ–°ï¼‰ï¼Œå³æœ¬è´¨çš„ä¸€é—®ï¼šâ€œä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒ\"ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_1/:1:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬1ç«  - ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒ","uri":"/posts/distributedtraining_1/"},{"categories":["Distributed Computing"],"content":"ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒ ç®€å•æ¥è¯´ï¼Œåˆ†å¸ƒå¼è®­ç»ƒ = åˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿ = åˆ†å¸ƒå¼ç³»ç»Ÿ + è®­ç»ƒç³»ç»Ÿï¼Œå› æ­¤ï¼Œè¦è§£ç­”ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒå°±éœ€è¦è§£ç­”ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä»¥åŠä»€ä¹ˆæ˜¯è®­ç»ƒç³»ç»Ÿï¼Œè€Œâ€œç³»ç»Ÿ = è¦ç´ xè¿æ¥ + ç›®çš„ + è¾¹ç•Œâ€ï¼Œå› æ­¤è¿›ä¸€æ­¥çš„å°±æ˜¯éœ€è¦åˆ†æåˆ†å¸ƒå¼ç³»ç»Ÿçš„è¦ç´ ã€è¿æ¥ã€ç›®çš„ä¸è¾¹ç•Œä»¥åŠè®­ç»ƒç³»ç»Ÿçš„è¦ç´ ã€è¿æ¥ã€ç›®çš„ä¸è¾¹ç•Œã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_1/:2:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬1ç«  - ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒ","uri":"/posts/distributedtraining_1/"},{"categories":["Distributed Computing"],"content":"åˆ†å¸ƒå¼ç³»ç»Ÿ åœ¨AIè®­ç»ƒè¿‡ç¨‹ä¸­é‡‡ç”¨å•å¡æ€»ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚åŸå§‹çš„æ•°æ®æ ·æœ¬å¤ªå¤§æ— æ³•åŠ è½½è¿›è®­ç»ƒå¡ï¼Œæˆ–è€…æ¨¡å‹å¤ªå¤§æ— æ³•è®­ç»ƒï¼Œé‚£ä¹ˆè¿™å°±éœ€è¦ç”¨åˆ°åˆ†å¸ƒå¼æŠ€æœ¯æŠŠå¤§é‡çš„æ•°æ®åˆ†å‰²æˆå°å—ç”±å¤šä¸ªè®­ç»ƒå¡åˆ†åˆ«è¿›è¡Œè®¡ç®—ï¼Œåœ¨æ›´æ–°è¿ç®—ç»“æœåï¼Œå†å°†ç»“æœç»Ÿä¸€åˆå¹¶å¾—å‡ºæœ€ç»ˆçš„å¯ç”¨æ¨¡å‹ã€‚ç™¾ç§‘ä¸Šå¯¹åˆ†å¸ƒå¼ç³»ç»Ÿçš„å®šä¹‰æœ‰ï¼š A distributed system is a system whose components are located on different networked computers, which communicate and coordinate their actions by passing messages to one another. The components interact with one another in order to achieve a common goal. å³ï¼š åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯æŒ‡å…¶ç»„ä»¶ä½äºä¸åŒçš„ç½‘ç»œè®¡ç®—æœºä¸Šçš„ç³»ç»Ÿï¼Œè¿™äº›ç»„ä»¶é€šè¿‡ç›¸äº’ä¼ é€’æ¶ˆæ¯æ¥è¿›è¡Œé€šä¿¡å’Œåè°ƒå…¶åŠ¨ä½œï¼Œä¸”å½¼æ­¤ç›¸äº’äº¤äº’ä»¥å®Œæˆä¸€ä¸ªå…±åŒçš„ä»»åŠ¡ç›®æ ‡ã€‚ ä»è¿™å¥è¯å¯ä»¥å¾—å‡ºä¸‰ä¸ªç»“è®ºï¼š åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç»„ä»¶æ˜¯ä½äºä¸åŒçš„ç½‘ç»œè®¡ç®—æœºä¸Šçš„ï¼› åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç»„ä»¶é€šè¿‡ä¼ é€’æ¶ˆæ¯è¿›è¡Œé€šä¿¡ä¸åè°ƒçš„ï¼› åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç»„ä»¶æ˜¯é€šè¿‡ç›¸äº’äº¤äº’ä»¥å®Œæˆä¸€ä¸ªå…±åŒçš„ä»»åŠ¡ç›®æ ‡ï¼ŒåŒæ—¶æ˜¯æœ‰è¾¹ç•Œçš„ï¼› å› æ­¤åŸºäºæ­¤å®šä¹‰ï¼Œæ‹†è§£åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¦‚å¿µï¼Œä»ä¸­å¯ä»¥çœ‹åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œçš„è¦ç´ å³ä¸ºç»„ä»¶ï¼Œè¿æ¥å³ç½‘ç»œï¼Œç›®çš„æ˜¯å…±åŒçš„ä»»åŠ¡ç›®æ ‡ã€‚å…¶ä¸­çš„ä½äºä¸åŒçš„ç½‘ç»œè®¡ç®—æœºä¸Šçš„â€œç»„ä»¶â€æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„è¦ç´ ï¼Œå³å„ç§è®¡ç®—å•å…ƒï¼Œæ¯”å¦‚Aiè®­ç»ƒåŠ é€Ÿå¡ï¼Œâ€œç½‘ç»œâ€æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„è¿æ¥ï¼Œå³ç¥ç»ç½‘ä¸æ•°æ®ç½‘ï¼Œâ€œå…±åŒçš„ä»»åŠ¡ç›®æ ‡â€æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç›®çš„ï¼Œå³è®­ç»ƒï¼Œè‡³æ­¤ï¼Œå†è¿›ä¸€æ­¥æŠ½è±¡ï¼Œå¯ä»¥æ¨å¯¼å‡ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„å…¬ç†åŒ–å®šä¹‰ï¼Œä¹Ÿæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœ¬è´¨ç†è®ºå®šä¹‰ï¼š åˆ†å¸ƒå¼ç³»ç»Ÿ = è®¡ç®— x ç½‘ç»œ + åŠŸèƒ½ + è¾¹ç•Œ åœ¨è¿™ä¸ªå…¬å¼é‡Œï¼Œè®¡ç®—å³è®¡ç®—å•å…ƒï¼Œæ˜¯å„ç§AIè®­ç»ƒåŠ é€Ÿå¡ï¼Œæ¯”å¦‚GPU, TPU, DPU, DTUã€‚ç½‘ç»œå³ç½‘ç»œè¿æ¥å•å…ƒï¼Œåœ¨å•ä¸ªè®­ç»ƒå¡å†…ä¸ºè®¡ç®—ç”¨çš„ç¥ç»ç½‘ï¼Œä¸»æœºå†…çš„å¤šä¸ªå¡å­ä¹‹é—´æ˜¯PCIE ä»¥åŠPCIE Switchï¼Œä»¥åŠå„ç§é«˜å¸¦å®½é€šä¿¡ç½‘ï¼Œæ¯”å¦‚GenZ,CXL,NVLINK,OpenCAPI,CCIXç­‰ï¼Œåœ¨ä¸»æœºä¹‹é—´æ˜¯å„ç§é€šä¿¡ç½‘ç»œï¼Œæ¯”å¦‚RDMAç½‘ç»œã€InfiniBandç½‘ç»œã€æ™®é€šçš„TCPç½‘ç»œä»¥åŠå¯¹åº”çš„å„ç§äº¤æ¢æœºï¼Œå¦å¤–ä»ç£ç›˜ + ä¸»æœºå†…å­˜ + è®­ç»ƒå¡çš„HBMè¿™ä¸ªIOè·¯å¾„æˆ‘ä»¬è®¤ä¸ºå±äºIOç½‘ç»œï¼Œè€Œè¿™é‡Œçš„ç›®çš„å³è®­ç»ƒï¼ŒåŒæ—¶è¿™ä¸ªç³»ç»Ÿæ˜¯æœ‰è¾¹ç•Œçš„ï¼Œå…¶ä¸“æ³¨äºè§£å†³Aiè®­ç»ƒè¿‡ç¨‹ä¸­çš„éš¾é¢˜ï¼Œä¸æ˜¯ä»€ä¹ˆåŠŸèƒ½éƒ½èƒ½å¾€é‡Œå¡éƒ½èƒ½è§£å†³çš„ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_1/:2:1","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬1ç«  - ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒ","uri":"/posts/distributedtraining_1/"},{"categories":["Distributed Computing"],"content":"è®­ç»ƒç³»ç»Ÿ ä»¥æ•°æ®å¹¶è¡Œéšæœºæ¢¯åº¦ä¸‹é™( SGD )æŠ€æœ¯ä¸ºä¾‹ï¼Œç¥ç»ç½‘ç»œè®­ç»ƒçš„è¿‡ç¨‹å¦‚ä¸‹: 1ï¼Œé¦–å…ˆéœ€è¦é€šè¿‡åœ¨ç¬¬ä¸€ä¸ªstepè¿›è¡ŒBroadcastæ“ä½œå°†å‚æ•°åŒæ­¥åˆ°é›†ç¾¤å†…çš„æ‰€æœ‰çš„è®­ç»ƒå¡ä¸Š; 2ï¼Œå°†æ•°æ®æ ·æœ¬åˆ‡ç‰‡åˆ†å‘åˆ°æ•´ä¸ªé›†ç¾¤çš„æ¯å¼ è®­ç»ƒå¡ä¸Šå¹¶ä¸”é€šè¿‡data LoaderæŠ€æœ¯å°†æ•°æ®æ ·æœ¬åŠ è½½è¿›è®­ç»ƒå¡çš„é«˜é€Ÿå†…å­˜ç©ºé—´å†…ï¼Œä½œä¸ºè¾“å…¥X; 3ï¼Œæ¯ä¸ªè®­ç»ƒå¡åœ¨å…¶æ•°æ®æ ·æœ¬ä¸Šè¿è¡Œå‰å‘ä¼ æ’­ï¼Œè®¡ç®—å‡ºè¯¯å·®LOSSiï¼› 4ï¼Œå¯¹è®¡ç®—å‡ºçš„LOSSiè¿›è¡Œåå‘ä¼ æ’­ï¼Œå¾—åˆ°æ¢¯åº¦GRADiï¼› 5ï¼Œæ‰€æœ‰çš„è®­ç»ƒå¡åœ¨ä¸»æœºå†…åŠä¸»æœºä¹‹é—´è¿›è¡Œé›†åˆé€šä¿¡å¹¶è¿›è¡Œæ¢¯åº¦å½’çº¦(AllReduce)ï¼› 6ï¼Œæœ€åå†è¿›è¡Œå‚æ•°æ›´æ–°ä»¥è·å¾—æ–°çš„æ¢¯åº¦å‚æ•°ã€‚ æœ¬è´¨ä¸Šåˆ†å¸ƒå¼è®­ç»ƒæ˜¯æ•°æ®åŠ è½½ã€å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­ã€é›†åˆé€šä¿¡ä»¥åŠå‚æ•°æ›´æ–°è¿™5ä¸ªæ­¥éª¤çš„é€»è¾‘ç»„åˆï¼Œå› æ­¤ï¼ŒåŸºäºä»¥ä¸Šæ­¥éª¤ï¼Œè¿™é‡Œå¯ä»¥æ¨å¯¼å‡ºè®­ç»ƒç³»ç»Ÿçš„å…¬å¼å®šä¹‰å¦‚ä¸‹ï¼š è®­ç»ƒç³»ç»Ÿ = æ•°æ®åŠ è½½ + ï¼ˆå‰å‘ä¼ æ’­ + åå‘ä¼ æ’­ï¼‰ + é›†åˆé€šä¿¡ + å‚æ•°æ›´æ–° ä»ä¸Šé¢çš„æ­¥éª¤å¯çŸ¥åˆ†å¸ƒå¼è®­ç»ƒæ˜¯åœ¨å›ºå®šçš„æ­¥éª¤è¿­ä»£ä¸­è¿›è¡Œçš„ï¼Œå¹¶ä¸”éœ€è¦ç³»ç»Ÿå†…çš„æ‰€æœ‰çš„è®­ç»ƒå¡éƒ½å®Œæˆå®ƒä»¬çš„è¿­ä»£æ­¥éª¤ï¼Œæ‰èƒ½è¿›è¡Œæœ€åçš„å‚æ•°æ›´æ–°ï¼Œè¿™ç›¸å½“äºåœ¨å•ä¸ªè®­ç»ƒå¡ä¸Šæ‰§è¡Œæ¢¯åº¦ä¸‹é™æŠ€æœ¯ï¼Œä½†æ˜¯é€šè¿‡åœ¨ç³»ç»Ÿå†…æ‰€æœ‰çš„è®­ç»ƒå¡ä¹‹é—´åˆ†å‘æ•°æ®æ ·æœ¬å¹¶åŒæ—¶æ‰§è¡Œè®¡ç®—æ¥è·å¾—è®­ç»ƒçš„åŠ é€Ÿã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_1/:2:2","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬1ç«  - ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒ","uri":"/posts/distributedtraining_1/"},{"categories":["Distributed Computing"],"content":"ä¸¾ä¾‹è¯´æ˜ ä»¥TensorFlowä¸ºä¾‹è¯´æ˜æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒTensorFlow æ˜¯ç”¨æ•°æ®æµå›¾åšè®¡ç®—çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º: å›¾ä¸­æ˜¾ç¤ºäº† TensorFlow çš„è®­ç»ƒè¿‡ç¨‹ï¼Œå…¶åŒ…å«è¾“å…¥ï¼ˆinputï¼‰ã€å¡‘å½¢ï¼ˆreshapeï¼‰ã€Relu å±‚ï¼ˆRelu layerï¼‰ã€Logit å±‚ï¼ˆLogit layerï¼‰ã€Softmaxã€äº¤å‰ç†µï¼ˆcross entropyï¼‰ã€æ¢¯åº¦ï¼ˆgradientï¼‰ã€SGD è®­ç»ƒï¼ˆSGD Trainerï¼‰ç­‰éƒ¨åˆ†ã€‚ å®ƒçš„è®­ç»ƒè¿‡ç¨‹æ˜¯ï¼Œé¦–å…ˆä»æ•°æ®åˆ†ç‰‡è¾“å…¥å¼€å§‹ï¼Œç»è¿‡Reshapeæ•°æ®æ¸…æ´—åï¼Œè¿›è¡Œå‰å‘ä¼ æ’­è¿ç®—ï¼Œé€šè¿‡Relu å±‚åå¾—åˆ°LOSSå€¼ï¼Œç„¶åè¿›å…¥ Logit å±‚ï¼Œå†è¿›è¡Œåå‘ä¼ æ’­å¹¶ä¸”ç”¨ Cross Entropyã€softmaxç­‰ æ¥è®¡ç®—æ¢¯åº¦ï¼Œæ¥ç€è¿›è¡Œæ¢¯åº¦å½’çº¦(Allreduce)ï¼Œè¿™ä¸€æ­¥åœ¨åˆ†å¸ƒå¼åœºæ™¯å°±æ¶‰åŠé›†åˆé€šä¿¡çš„è¿‡ç¨‹ï¼Œæœ€åè¿›è¡Œå‚æ•°æ›´æ–°SGD Trainerï¼Œå¦‚æ­¤è¿­ä»£å¾ªç¯ç›´åˆ°è·å¾—æ”¶æ•›æŒ‡æ ‡è¾¾æ ‡çš„ç»“æœä¸ºæ­¢ã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_1/:2:3","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬1ç«  - ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒ","uri":"/posts/distributedtraining_1/"},{"categories":["Distributed Computing"],"content":"å°ç»“ é‡‡ç”¨åˆ†å¸ƒå¼è®­ç»ƒçš„ç›®çš„å¾€å¾€ä¹Ÿæ˜¯å› ä¸ºæ•°æ®é‡æˆ–æ¨¡å‹å¤ªå¤§ï¼Œä¸€ä¸ªåŠ é€Ÿå¡çš„é«˜é€Ÿå†…å­˜æ”¾ä¸ä¸‹ï¼Œå› æ­¤å¯¹æ•°æ®æˆ–è€…æ¨¡å‹è¿›è¡Œåˆ‡åˆ†ï¼Œåˆ†å‘åˆ°å¤šå¡ä¸Šè¿›è¡Œè®¡ç®—ä¸å½’çº¦ã€‚æœ¬æ–‡å¾ˆæ¦‚å†µæ€§çš„è®²è¿°äº†ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒï¼Œç®€å•æ¥è¯´åˆ†å¸ƒå¼è®­ç»ƒå°±æ˜¯åˆ†å¸ƒå¼è®¡ç®—çš„ä¸€ç§ï¼Œé€šè¿‡å¯¹æ•°æ®æ ·æœ¬çš„è®¡ç®—ï¼Œå¾—å‡ºæœ€åå¯ç”¨çš„æ¨¡å‹å†ç”¨äºæ•°æ®æ¨ç†ã€‚æœ¬ç³»åˆ—æ–‡ç« çš„åç»­å†…å°†å±•å¼€è®²è¿°åˆ†å¸ƒå¼è®­ç»ƒçš„åŸºç¡€ç†è®ºã€è®­ç»ƒè¿‡ç¨‹ã€è´¨é‡ä¿è¯ã€é›†åˆé€šä¿¡ã€ç³»ç»Ÿå·¥ç¨‹ã€äº§å“åŒ–ç­‰ï¼ŒåŒæ ·åˆ†å¸ƒå¼è®­ç»ƒç³»ç»Ÿé™¤äº†è§£å†³è®­ç»ƒæ‰€å¸¦æ¥çš„å„ç§æ•…éšœä¹Ÿè¿˜éœ€è¦è§£å†³åˆ†å¸ƒå¼æ‰€å¸¦æ¥çš„å„ç§æ•…éšœã€‚ ","date":"2023-07-13","objectID":"/posts/distributedtraining_1/:3:0","tags":["Distributed Training"],"title":"åˆ†å¸ƒå¼è®­ç»ƒ â€“ ç¬¬1ç«  - ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼è®­ç»ƒ","uri":"/posts/distributedtraining_1/"},{"categories":["Distributed Computing"],"content":"Horovod ä»‹ç» Horovod æ˜¯ Uber å¼€æºçš„æ·±åº¦å­¦ä¹ å·¥å…·ï¼Œå®ƒçš„å‘å±•å¸å–äº†Facebook â€œTraining ImageNet In 1 Hourâ€ ä¸ç™¾åº¦ â€œRing Allreduceâ€ çš„ä¼˜ç‚¹ï¼Œåœ¨ä¿è¯åˆ†å¸ƒå¼è®­ç»ƒæ€§èƒ½çš„åŒæ—¶ï¼Œå…¼é¡¾äº†å‰ç«¯çš„ç®€æ´å’Œå¯¹ä¸åŒæ·±åº¦å­¦ä¹ æ¡†æ¶çš„æ”¯æŒï¼Œä½¿ç”¨èµ·æ¥å¯¹å¼€å‘äººå‘˜æ¯”è¾ƒçš„å‹å¥½ï¼Œç®—æ˜¯åˆ†å¸ƒå¼è®­ç»ƒæ–¹å‘çš„æ ‡æ†é¡¹ç›®äº†ã€‚ ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:1:0","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"é›†åˆé€šä¿¡åº“ é›†åˆé€šä¿¡åº“ï¼Œè¿™ä¸ªè¯å¯èƒ½å¬èµ·æ¥ä¼šæ¯”è¾ƒçš„é™Œç”Ÿï¼Œä¸è¿‡å¦‚æœæˆ‘å†æå‡ ä¸ªå…³é”®å­—ï¼Œå¯èƒ½å¤§å®¶å¤šå°‘éƒ½ä¼šæœ‰æ‰€è€³é—»ã€‚èµ„å†æ¯”è¾ƒè€çš„æ˜¯ MPI (Message Passing Interface åŠå…¶å®ç° OpenMPI å’Œ MPICHï¼Œå¹´è½»ä¸€ç‚¹çš„ä¼šæ˜¯ Nvidia é’ˆå¯¹å…¶æ˜¾å¡å¼€æºçš„ NCCLï¼Œæˆ–è€…æ˜¯ facebook å¼€æºçš„ glooï¼Œæˆ–è€…æ˜¯åƒåä¸ºé’ˆå¯¹å…¶é«˜æ€§èƒ½ç¡¬ä»¶æä¾›çš„HCCLï¼Œå¤§ä½“ä¸Šéƒ½å¯ä»¥å½’å…¥åˆ°é›†åˆé€šä¿¡åº“çš„ç±»åˆ«ã€‚ä»–ä»¬ç›¸åŒçš„åœ°æ–¹æ˜¯å¤§ä½“ä¸Šä¼šéµç…§ MPI æä¾›çš„æ¥å£è§„å®šï¼Œå®ç°äº†åŒ…æ‹¬ç‚¹å¯¹ç‚¹é€šä¿¡ï¼ˆSEND,RECVç­‰ï¼‰ï¼Œé›†åˆé€šä¿¡ï¼ˆ REDUCEï¼ŒBROADCASTï¼ŒALLREDUCEç­‰ï¼‰ç­‰ç›¸å…³æ¥å£ï¼Œç„¶åæ ¹æ®è‡ªå·±ç¡¬ä»¶æˆ–è€…æ˜¯ç³»ç»Ÿçš„éœ€è¦ï¼Œåœ¨åº•å±‚å®ç°ä¸Šè¿›è¡Œäº†ç›¸åº”çš„æ”¹åŠ¨ï¼Œä¿è¯æ¥å£çš„ç¨³å®šå’Œæ€§èƒ½ã€‚ ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:2:0","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"ç‚¹å¯¹ç‚¹é€šä¿¡: Point-to-Point Communication Send/Recv: ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:2:1","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"é›†åˆé€šä¿¡ Scatter/Gather reduce/allreduce boradcast/all-gather è¿™é‡Œåœ¨æœºå™¨å­¦ä¹ è®­ç»ƒä¸­ä½¿ç”¨æ¯”è¾ƒå¤šçš„æ˜¯ all-reduceï¼Œåœºæ™¯ç±»ä¼¼åœ¨ä¸åŒçš„ node ä¸Šè·‘ä¸åŒ batch çš„æ•°æ®ï¼Œç„¶åæ›´æ–°æ¢¯åº¦éœ€è¦ä»å„ä¸ªæ±‡æ€»ä¹‹åå¹³å‡å†å›ä¼ åˆ°å„è‡ªçš„ node ä¸­ã€‚è€Œè¿™éƒ¨åˆ†ï¼Œæœ‰å¾ˆå¤šç§å®ç°çš„æ–¹å¼ï¼Œæ¯”è¾ƒç›´è§‚å’Œç®€å•çš„æ˜¯æŠŠæ‰€æœ‰çš„æ¢¯åº¦éƒ½æ±‡æ€»åˆ°çš„æŸä¸€ä¸ª node ä¸Šï¼ˆå¦‚ä¸‹å›¾ node d æ‰€ç¤ºï¼‰ï¼Œç„¶åå†æŠŠæ±‡æ€»çš„ä¿¡æ¯é‡æ–°åˆ†å‘åˆ°ä¸åŒçš„ node ä¸Š ï¼Œè¿™æ ·å¯ä»¥è®¡ç®—é€šä¿¡é‡ï¼Œå¦‚ä¸‹ï¼šå¯¹äº P ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ¶ˆæ¯å¤§å°ä¸º Mï¼Œnode d èŠ‚ç‚¹çš„é€šä¿¡é‡ä¸º 2*(P-1)Mï¼Œè¿™é‡Œå‡è®¾èŠ‚ç‚¹ä¹‹é—´äº’è”äº’é€šï¼Œå¸¦å®½ä¸ºBã€‚ ä¸è¿‡è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´ node d ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆï¼Œå› ä¸º node d éœ€è¦è·Ÿå…¶ä»–æ‰€æœ‰ node é€šä¿¡æ‰€ä»¥å®ƒçš„é€šä¿¡é‡æ˜¯å…¶ä»–èŠ‚ç‚¹çš„ P å€ã€‚å‡è®¾èŠ‚ç‚¹é—´çš„å¸¦å®½è¿˜æ˜¯ä¸€æ ·ï¼Œnode d å®Œæˆæ‰€æœ‰é€šä¿¡æ‰€éœ€è¦çš„æ—¶é—´æ˜¯ 2(P-1)M/B*ã€‚æ‰€ä»¥ç°åœ¨å¾ˆå¤šçš„é›†åˆé€šä¿¡æ¡†æ¶ä¸ä¼šä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæ›´å¤šçš„æ˜¯é€šè¿‡æ ‘çŠ¶æˆ–è€…æ˜¯ç¯çŠ¶(ring) å»å®ç° all-reduceã€‚ å¦‚æœåªæ˜¯åšæˆæ ‘çŠ¶çš„å¯ä»¥åšæˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè™½ç„¶ä¼ é€’çš„æ­¥æ•°å¢å¤šäº†ï¼Œä¸è¿‡æ¶ˆé™¤äº†node d çš„é€šä¿¡ç“¶é¢ˆï¼Œå®Œæˆæ‰€æœ‰çš„é€šä¿¡çš„æ—¶é—´å¤§æ¦‚æ˜¯ 2log_2N(M/B)*ï¼Œéšç€èŠ‚ç‚¹æ•°ç›® P çš„å¢åŠ ï¼Œæ ‘å½¢ç»“æ„çš„æ•ˆæœä¼šè¶Šæ¥è¶Šæ˜æ˜¾ã€‚ ä¸šç•Œç”¨å¾—æœ€å¤šä¸€ç§ä¼˜åŒ–çš„æ–¹å¼æ˜¯ï¼Œæ¯æ¬¡åªä¼ ä¸€éƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†æ˜¯ç™¾åº¦æå‡ºçš„ ring-allreduce çš„æ–¹æ¡ˆï¼Œå…·ä½“çš„ä»‹ç»å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢Bringing HPC Techniques to Deep Learningï¼Œè¿™è¾¹å°±ä¸èµ˜è¿°äº†ã€‚æ•´ä½“ä¸Šå°±æ˜¯æ¯æ¬¡ä¸ä¼šåƒä¸Šé¢è¿™æ ·æ•´ä»½æ•°æ®ä¼ é€’ï¼Œè€Œæ˜¯ä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†ä¼ ï¼Œä¼˜åŒ–åï¼Œæ‰€æœ‰èŠ‚ç‚¹éœ€è¦ä¼ è¾“çš„æ•°æ®é‡çš„ä¼ è¾“ 2(Nâˆ’1)M/N æ¯”è¾ƒå¹³å‡ï¼Œæ‰€éœ€è¦çš„æ—¶é—´å¯ä»¥å¤§æ¦‚æ˜¯ 2(Nâˆ’1)M/(NB)ï¼Œhorovod ä¹Ÿæ˜¯åŸºäºè¿™ç§ all-reduce çš„å½¢å¼å®ç°çš„ã€‚ ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:2:2","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"å®è·µ: pytorch.distributed å°è¯•ä½¿ç”¨ pytorch è‡ªå¸¦çš„åˆ†å¸ƒå¼å·¥å…·åŒ… torch.distributedï¼Œè¿›è¡Œä¸€äº›æ¦‚å¿µæ€§çš„å°è¯•ã€‚ ä¸ºäº†æ–¹ä¾¿å°è¯•ï¼Œæˆ‘è¿™é‡Œæä¾›äº†ä¸€ä¸ªç®€å•çš„ demoï¼Œå¤§å®¶å¦‚æœå®‰è£…äº† gpu ç‰ˆæœ¬çš„ pytorch \u003e= 1.3ï¼Œåº”è¯¥éƒ½å¯ä»¥å°è¯•ä¸‹é¢çš„ä¾‹å­å°è¯•ä½¿ç”¨å¤šè¿›ç¨‹æ¨¡æ‹Ÿåˆ†å¸ƒå¼ï¼ˆå•æœºä¸Šå¯ä»¥è·‘ï¼‰ã€‚ import os import torch import torch.distributed as dist import time import argparse from torch.multiprocessing import Process parser = argparse.ArgumentParser(description='PyTorch MNIST Example') parser.add_argument('-m', '--mode', type=str, default='one_device', metavar='N', help='distribute mode, distributed/one_device') parser.add_argument('-f', '--function', type=str, default='p2p', metavar='N', help='function to run (p2p/all_reduce/gpu_all_reduce)') parser.add_argument('-b', '--backend', type=str, default=\"nccl\", metavar='N', help='distribute backend (gloo/nccl)') def init_process(rank, size, fn, backend='nccl'): \"\"\" Initialize the distributed environment. \"\"\" os.environ['MASTER_ADDR'] = '127.0.0.1' os.environ['MASTER_PORT'] = '29500' dist.init_process_group(backend, rank=rank, world_size=size) fn(rank, size) def run(rank, size): tensor = torch.zeros(1) print('Rank ', rank, ' has data before send/recv', tensor) if rank == 0: tensor += 1 # Send the tensor to process 1 dist.send(tensor=tensor, dst=1) else: # Receive tensor from process 0 dist.recv(tensor=tensor, src=0) print('Rank ', rank, ' has data after send/recv', tensor) def run_allreduce(rank, size): \"\"\" Simple reduce communication. \"\"\" group = dist.new_group([0, 1]) device = torch.device('cuda:%d' % rank) tensor = torch.ones(1).to(device) dist.all_reduce(tensor, op=dist.ReduceOp.SUM, group=group) print('Rank ', rank, ' has data ', tensor[0]) def run_multigpu_allreduce(rank, size): group = dist.new_group([0, 1]) tensor_list = [] for dev_idx in range(2): device = torch.device('cuda:%d' % (2 * rank + dev_idx)) tensor = torch.ones(1).to(device) tensor_list.append(tensor) dist.all_reduce_multigpu(tensor_list) print('all_reduce_multigpu', tensor_list) dist.all_reduce(tensor_list[0], op=dist.ReduceOp.SUM, group=group) print('Rank ', rank, ' has data tensor[0]:', tensor_list[0], \", tensor[1]:\", tensor_list[1]) if __name__ == \"__main__\": args = parser.parse_args() backend = args.backend if args.mode == \"distributed\" or os.environ.get('RANK',None): print(\"in distribute mode\") if args.function == \"all_reduce\": function, size = run_allreduce, 2 elif args.function == \"gpu_all_reduce\": function, size = run_multigpu_allreduce, 2 else: function, size, backend = run, 2, \"gloo\" rank = int(os.environ['RANK']) p = Process(target=init_process, args=(rank, size, function, backend)) p.start() p.join() else: print(\"in one device mode\") if args.function == \"all_reduce\": function, size = run_allreduce, 2 elif args.function == \"gpu_all_reduce\": function, size = run_multigpu_allreduce, 2 else: function, size, backend = run, 2, \"gloo\" processes = [] for rank in range(size): p = Process(target=init_process, args=(rank, size, function, backend)) p.start() processes.append(p) for p in processes: p.join() å¯ä»¥ç®€å•åœ°è¿è¡Œä¸Šé¢çš„ä¾‹å­ï¼š send/recv: $ python3 distribute_test.py # è¾“å‡ºå¦‚ä¸‹ï¼š in one device mode Rank 0 has data before send/recv tensor([0.]) Rank 1 has data before send/recv tensor([0.]) Rank 0 has data after send/recv tensor([1.]) Rank 1 has data after send/recv tensor([1.]) ä¸Šé¢æ˜¯æ¼”ç¤ºçš„æ˜¯é€šè¿‡ pytorch çš„ multiprocessing åŒ…ï¼Œæ¨¡æ‹Ÿä¸€æ¬¡åˆ†å¸ƒå¼çš„ send/recv è¿‡ç¨‹ï¼Œè¿™é‡Œæ˜¯ rank0 çš„è¿›ç¨‹å¾€ rank1 çš„è¿›ç¨‹å‘é€ä¸€ä¸ª tensorï¼Œå¯ä»¥çœ‹åˆ° rank 1 tensor åˆå§‹åŒ–ä¸º 0ï¼Œæ˜¯æ¥æ”¶åˆ° rank 0 çš„tensor åå˜ä¸º 1 çš„ã€‚ï¼ˆæ³¨æ„ï¼šè¿™é‡Œç‰¹åˆ«è®¾ç½®äº† backend ä¸º gloo æ˜¯å› ä¸º nccl ä¸æ”¯æŒ point2point çš„ä¼ è¾“ï¼Œå…·ä½“ä¸åŒ backend æ”¯æŒä»€ä¹ˆå½¢å¼çš„åŸè¯­ï¼Œå‚è€ƒæ–‡æ¡£backendéƒ¨åˆ† ï¼‰ all_reduce $ python3 distribute_test.py -f all_reduce # è¾“å‡ºå¦‚ä¸‹ï¼š in one device mode Rank 0 has data tensor(2., device='cuda:0') Rank 1 has data tensor(2., device='cuda:1') # å¯¹åº”å‡½æ•° def run_allreduce(rank, size): \"\"\" Simple reduce communication. \"\"\" group = dist.new_group([0, 1]) # use rank 0 and rank 1 device = torch.device('cuda:%d' % rank) tensor = torch.ones(1).to(device) dist.all_reduce(tensor, op=dist.ReduceOp.SUM, group=group) print('Rank ', rank, ' has data ', tensor[0]) è¿™é‡Œä¹Ÿå¾ˆæµ…ç™½ï¼Œä¸»è¦å°±æ˜¯å¯¹ä¸¤ä¸ªè¿›ç¨‹ä¸Šçš„ tensor è¿›è¡Œä¸€æ¬¡ allreduceï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ª rank ä¸Šçš„ç»“æœéƒ½ä¸º 2äº†ã€‚ g","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:2:3","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"MPI æ›´æ·±å…¥çš„å°è¯•ï¼Œå¯ä»¥å°è¯•äº†è§£ä¸€ä¸‹ mpi çš„çŸ¥è¯†ï¼Œè¿™ä¸ªmpiæ•™ç¨‹ ç®—æ˜¯å†™å¾—æ¯”è¾ƒç³»ç»Ÿçš„ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒä¸€ä¸‹æ¥ç»ƒä¹ ï¼Œç‰¹åˆ«æ˜¯å¯¹åº•å±‚ä¸æ˜¯å¾ˆäº†è§£çš„åŒå­¦ï¼Œå¯ä»¥å¤šçœ‹çœ‹ Running an MPI cluster within a LAN çš„éƒ¨åˆ†ï¼Œå®æ“ä¸€ä¸‹é€šè¿‡ ssh è·‘èµ·ä¸€ä¸ªåˆ†å¸ƒå¼çš„ demoã€‚é›†åˆé€šä¿¡åº“çš„åŸºç¡€å¤§æ¦‚å…ˆåˆ°è¿™é‡Œï¼Œå¦‚æœè¦æ·±å…¥çš„å¯ä»¥å†å»çœ‹çœ‹ openMPIï¼Œå’Œ nccl çš„å®ç°ã€‚ ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:2:4","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"Horovodæµç¨‹åˆ†æ ä¸‹é¢æˆ‘ä¼šä»¥ä¸€ä¸ªç®€å•çš„ pytorch horovod çš„ demo å°è¯•å»ç†è§£ä¸€ä¸‹ horovod çš„å·¥ä½œæœºç†ï¼Œdemo å¦‚ä¸‹ï¼ˆçœç•¥äº†ä¸€äº›ä¸å…³é”®çš„ä»£ç æ®µï¼‰ã€‚ä¸ºäº†å‡†ç¡®èµ·è§ï¼Œæˆ‘ä»¬æ˜¯æ ¹æ® horovod v0.20.3 çš„ç‰ˆæœ¬è¿›è¡Œé˜…è¯»çš„ï¼Œå¦‚æœæ˜¯å…¶ä»–ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šè·Ÿè¿™é‡Œçš„å†…å®¹æœ‰ä¸€äº›å‡ºå…¥ã€‚ ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:3:0","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"pytorch demo ä¸€èˆ¬çš„ horovod è®­ç»ƒç¨‹åºéƒ½ä¼šåŒ…å«ä»¥ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š 1. hvd.init: å¯¹ horovod 2. åˆå§‹åŒ–ã€‚åˆå§‹åŒ–æ¨¡å‹ï¼Œæ•°æ®é›†ï¼Œä¼˜åŒ–å™¨ï¼Œåˆå§‹åŒ–ä¸åŒ node çš„æ¨¡å‹æƒé‡ã€‚ 3. ä½¿ç”¨ hvd.DistributedOptimizer åŒ…è£…ä¼˜åŒ–å™¨ã€‚ 4. è¿›å…¥è®­ç»ƒæµç¨‹ï¼Œè¿›è¡Œä¼˜åŒ–è¿­ä»£ã€‚ æˆ‘ä»¬ä¼šç€é‡ä»‹ç»ç¬¬ 1 å’Œ 4 æ­¥ï¼Œå› ä¸ºä¸»è¦ä¹Ÿæ˜¯1ï¼Œ4æ­¥ä¼šè·Ÿ c++ åç«¯è¿›è¡Œä¿¡æ¯äº¤æ¢ã€‚ import torch.backends.cudnn as cudnn import torch.nn.functional as F import torch.optim as optim import torch.utils.data.distributed from torchvision import models import horovod.torch as hvd import timeit import numpy as np ... # some argparse hvd.init() # Set up standard model. model = getattr(models, args.model)() optimizer = optim.SGD(model.parameters(), lr=0.01 * lr_scaler) # Horovod: (optional) compression algorithm. compression = hvd.Compression.fp16 if args.fp16_allreduce else hvd.Compression.none # Horovod: wrap optimizer with DistributedOptimizer. optimizer = hvd.DistributedOptimizer(optimizer, named_parameters=model.named_parameters(), compression=compression, op=hvd.Adasum if args.use_adasum else hvd.Average) # Horovod: broadcast parameters \u0026 optimizer state. hvd.broadcast_parameters(model.state_dict(), root_rank=0) hvd.broadcast_optimizer_state(optimizer, root_rank=0) # Set up fixed fake data data = torch.randn(args.batch_size, 3, 224, 224) target = torch.LongTensor(args.batch_size).random_() % 1000 if args.cuda: data, target = data.cuda(), target.cuda() def benchmark_step(): optimizer.zero_grad() output = model(data) loss = F.cross_entropy(output, target) loss.backward() optimizer.step() #... some log configuration img_secs = [] for x in range(args.num_iters): time = timeit.timeit(benchmark_step, number=args.num_batches_per_iter) img_sec = args.batch_size * args.num_batches_per_iter / time img_secs.append(img_sec) # Results ... ç„¶åä¸‹å›¾æ˜¯æˆ‘å¯¹ horovod æ•´ä½“æµç¨‹çš„æ¢³ç†ï¼ŒæŠŠä¸€äº›ä¸æ˜¯å¾ˆå…³é”®çš„éƒ¨åˆ†éšè—äº†ï¼Œå¯èƒ½æœ‰ä¸€äº›ç»†èŠ‚çš„åœ°æ–¹å’Œå®ç°æœ‰å‡ºå…¥ï¼Œä¸è¿‡æˆ‘å¾…ä¼šä¼šæœ‰è¯¦ç»†çš„è¯´æ˜ã€‚è¿™é‡Œå…ˆè§£é‡Šä¸€ä¸‹ï¼Œä¸‹é¢å‡ ä¸ªå¤§çš„éƒ¨åˆ†: main.pyï¼š è¡¨ç¤ºè®­ç»ƒè„šæœ¬ï¼Œä¸€èˆ¬æ˜¯ ä½¿ç”¨ horovod æä¾›çš„å‡½æ•°è·Ÿç‰¹å®šçš„è®­ç»ƒæ¡†æ¶ç›¸äº’åˆä½œå®Œæˆåˆ†å¸ƒå¼è®­ç»ƒï¼ˆä¸‹æ–‡ç§°å‰ç«¯ï¼‰ C++ interfaceï¼šæ˜¯æŒ‡ horovod python å‡½æ•°è°ƒç”¨ C++ çš„æ¥å£ GlobalStateï¼šåœ¨ horovod ä¸­æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå…¶ä¸­çš„å…ƒç´ å¯ä»¥ä¾›ä¸åŒçš„çº¿ç¨‹è®¿é—®ï¼Œåœ¨åŠ è½½ C++ çš„ä»£ç æ—¶å€™å°±å·²ç»åˆ›å»ºäº†ï¼ŒåŒæ—¶åˆ›å»ºçš„è¿˜æœ‰å„ç§ contextï¼ˆmpi_context, nccl_context, gpu_contextï¼‰åé¢ä¼šæåˆ°ï¼Œä¸»è¦ä¼šåœ¨ä¸‹å›¾ backgroundThreadLoop ä¸­å®Œæˆ globalstate ä¸åŒå…ƒç´ åˆå§‹åŒ–ï¼Œæ¯”è¾ƒé‡è¦çš„æœ‰ controller ç®¡ç†æ€»ä½“é€šä¿¡æ§åˆ¶æµï¼Œtensor_queue ä¼šå¤„ç†ä»å‰ç«¯è¿‡æ¥çš„é€šä¿¡éœ€æ±‚ï¼ˆallreduceï¼Œbroadcast ç­‰ï¼‰ã€‚ BackgroundThreadLoopï¼šæ˜¯è®­ç»ƒè¿‡ç¨‹ä¸­çš„åå°çº¿ç¨‹ï¼Œä¸»è¦è´Ÿè´£è·Ÿå…¶ä»–èŠ‚ç‚¹çš„é€šä¿¡ï¼Œå’Œå¤„ç†å‰ç«¯è¿‡æ¥çš„é€šä¿¡éœ€æ±‚ï¼ˆrequestï¼‰ï¼Œä¼šè½®è¯¢è°ƒç”¨ RunLoopOnceï¼Œä¸æ–­æŸ¥çœ‹ tensor_queue ä¸­æœ‰æ²¡æœ‰éœ€è¦é€šä¿¡çš„tensorï¼Œå¦‚æœæœ‰è·Ÿå…¶ä»–èŠ‚ç‚¹åŒæ­¥æ›´æ–°ï¼Œç„¶åæ‰§è¡Œé€šä¿¡æ“ä½œã€‚ ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:3:1","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"æµç¨‹åˆ†æ ä¸‹é¢ä½¿ç”¨ mpi_controller è¿›è¡Œ allreduce æ“ä½œè¿›è¡Œåˆ†æã€‚ 1.hvd.init()-\u003eInitializeHorovodOnce é¦–å…ˆï¼Œhvd.init() ä¼šé€šè¿‡ä¸€ç³»åˆ—çš„è°ƒç”¨å’Œé…ç½®æœ€ç»ˆè°ƒç”¨ horovod/common/http://operations.cc ä¸‹çš„ InitializeHorovodOnce å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæ ¹æ®åŠ è½½çš„é›†åˆé€šè®¯åº“ï¼ˆmpi æˆ–è€… glooï¼‰ä¸º globalstate åˆ›å»ºå¯¹åº”çš„ controllerï¼Œç„¶åä½¿ç”¨ BackgroundThreadLoop å¯åŠ¨ä¸€ä¸ªåå°çº¿ç¨‹ã€‚ horovod/common/http://operations.cc #628 void InitializeHorovodOnce(const int* ranks, int nranks) { // ... some envParse #if HAVE_MPI // Enable mpi is it's used either i[n cpu data transfer or controller if (horovod_global.cpu_operation == LibType::MPI || horovod_global.control_operation == LibType::MPI) { mpi_context.Enable(); } // åˆ›å»ºä¸€ä¸ª MPIController å¯¹è±¡ if (horovod_global.control_operation == LibType::MPI){ horovod_global.controller.reset(new MPIController( horovod_global.response_cache, horovod_global.tensor_queue, horovod_global.timeline, horovod_global.parameter_manager, mpi_context)); horovod_global.controller-\u003eSetRanks(ranks, nranks); } #endif #if HAVE_GLOO //... #endif // Reset initialization flag horovod_global.initialization_done = false; // å¯åŠ¨åå°çº¿ç¨‹ horovod_global.background_thread = std::thread( BackgroundThreadLoop, std::ref(horovod_global)); } while (!horovod_global.initialization_done) { std::this_thread::sleep_for(std::chrono::milliseconds(1)); } } 2.BackgroundThreadLoop BackgroundThreadLoop ä¼šä¸º GlobalState åˆå§‹åŒ–ä¸€ç³»åˆ—åŒ…æ‹¬åˆå§‹åŒ– mpi_contextï¼Œ controllerçš„å…ƒç´ ï¼Œç„¶åè½®è¯¢è°ƒç”¨ RunLoopOnceï¼Œè¿˜æœ‰ä¸€äº›å¯¹ RunLoopOnce ç»“æŸåçš„åå¤„ç†ã€‚ void BackgroundThreadLoop(HorovodGlobalState\u0026 state) { #if HAVE_MPI // Initialize mpi context auto mpi_ctx_manager = MPIContextManager(); #endif // mpi_context ä¼šæ ¹æ®å‰ç«¯å’Œç¯å¢ƒå˜é‡ä¼ è¿‡æ¥çš„ä¿¡æ¯ï¼Œåˆ›å»º mpi çº¿ç¨‹ï¼Œå’Œä¸€äº› mpiOps mpi_context.Initialize(state.controller-\u003eGetRanks(), mpi_ctx_manager); #endif // Initialize controller // ä¼šåŒæ­¥ä¸åŒ node çš„ global_size, local_size, rank, is_coordinator ç­‰ä¿¡æ¯ state.controller-\u003eInitialize(); // Set background thread affinity parse_and_set_affinity(std::getenv(HOROVOD_THREAD_AFFINITY), local_size, local_rank); #if HAVE_GPU ... // è®¾ç½® gpu_context çš„ stream æ•°ç›®ç­‰åˆå§‹åŒ–åŠ¨ä½œ #endif // ä¸‹é¢æ˜¯è®¾ç½® parameter_manager è¿™é‡Œä¸ºäº†èŠ‚çœç¯‡å¹…ç›´æ¥ç»™å‡ºï¼Œè®¾ç½®çš„è¯­å¥ï¼Œ // åŸæ¥è¿™é‡Œä¼šè¯»å–å¯¹åº”çš„ç¯å¢ƒå˜é‡çš„ï¼Œå»è®¾ç½® parameter_managerã€‚ // åé¢ä¹Ÿä¼šæœ‰ç¯‡å¹…ä»‹ç» parameter_managerï¼Œè¿™é‡Œå…ˆä¸å±•å¼€ã€‚ state.parameter_manager.SetTensorFusionThresholdBytes(64 * 1024 * 1024); state.parameter_manager.SetCycleTimeMs(5); state.parameter_manager.SetCacheEnabled(true); state.response_cache.set_capacity( (int)state.parameter_manager.CacheEnabled() * state.cache_capacity); state.parameter_manager.SetHierarchicalAllgather(value, true); state.parameter_manager.SetAutoTuning(true); ... // å…¶ä»–ä¸€äº›åˆå§‹åŒ–è®¾ç½® // è®¾ç½®op_managerï¼Œè¿™é‡Œä¸»è¦æ˜¯æ³¨å†Œä¸åŒçš„é›†åˆé€šä¿¡åº“çš„ ops //ï¼ˆ å¦‚ï¼šNCCLAllreduce, MPI_GPUAllgather ç­‰ï¼‰ op_manager.reset(CreateOperationManager(state)); // åˆå§‹åŒ–å®Œæˆ state.initialization_done = true; // Iterate until shutdown. try { while (RunLoopOnce(state)); } catch (const std::exception\u0026 ex) { LOG(ERROR) \u003c\u003c \"Horovod background loop uncaught exception: \" \u003c\u003c ex.what(); } ... // å…¶ä»–ä¸€äº›åå¤„ç†å‡½æ•° } 3.Optimizer.step()-\u003eDoAllReduce è¿™é‡Œæˆ‘ä»¬å…ˆä¸æ€¥ç€çœ‹ RunLoopOnce å‡½æ•°ï¼Œå…ˆå›åˆ° InitializeHorovodOnce ï¼Œå› ä¸ºä¸Šé¢çš„ initialization_done = Trueï¼Œæ‰€ä»¥ InitializeHorovodOnce å¯ä»¥é€€å‡ºäº†ï¼Œå°±æ˜¯å‰ç«¯çš„ hvd.init() å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥äº†ã€‚è¿™é‡Œ main.py èµ°å®Œå‰å‘ loss = model(data,target)ï¼Œåå‘é€»è¾‘ loss.backward()ï¼Œè°ƒç”¨ optimizer.step() è¿›è¡Œæ¢¯åº¦åŒæ­¥ã€‚optimizer.step() ä¼šé€šè¿‡ä¸€ç³»åˆ—çš„è°ƒç”¨å’Œå¤„ç†ï¼ˆå¦‚ï¼šcompression ç­‰æ“ä½œï¼‰æœ€ç»ˆä¼šè°ƒç”¨ C++ interface çš„ DoAllReduce å‡½æ•°ã€‚ DoAllReduce å‡½æ•°ä¼šè°ƒç”¨ EnqueueTensorAllreduce å‡½æ•°ä¼šæŠŠéœ€è¦ reduce çš„ tensor ç»„è£…æˆä¸€ä¸ªRequest å¾€ GlobalState çš„ tensor_queue é‡Œé¢å¡ã€‚è¿™é‡Œæ³¨æ„æ¯ä¸ª tensor ä¼šåˆ›å»ºå¯¹åº” TensorTableEntryï¼Œç”¨äºä¿å­˜tensor çš„æƒé‡ï¼Œmessage ä¸»è¦æ˜¯ä¸€äº› å…ƒä¿¡æ¯ metadataã€‚ç„¶åå°±ç­‰åå°çº¿ç¨‹å»è¯»å–è¿™äº›allreduce çš„è¯·æ±‚äº†ã€‚ Status EnqueueTensorAllreduce(std::shared_ptr\u003cOpContext\u003e context, std::shared_ptr\u003cTensor\u003e tensor, std::shared_ptr\u003cTensor\u003e output, std::shared_ptr\u003cReadyEvent\u003e ready_event, const std::string name, const int device, StatusCallback callback, ReduceOp reduce_op, double prescale_factor, double postscale_factor) { Status status; ... // some config Request message; message.set_request_rank(horovod_global.controller-\u003eGetRank()); message.set_tensor_name(name); message.set_tensor_type(tensor-\u003edtype()); message.set_device(device); message.set_prescale_factor(prescale_factor); messag","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:3:2","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"å…¶ä»–å…³é”®æ¨¡å— ä¸Šé¢åªæ˜¯ä»‹ç»äº† horovod ä¸»æµç¨‹å·¥ä½œåŸç†ï¼Œä¸è¿‡ horovod è¿˜æœ‰å…¶ä»–ä¸€äº›æ¨¡å—ååŒä¸»æµç¨‹å·¥ä½œçš„ï¼Œä¸‹é¢ä¼šå¯¹å…¶ä¸­çš„ä¸€äº›æˆ‘è®¤ä¸ºå¯ä»¥å€¼å¾—ä¸€è¯´çš„æ¨¡å—è¯´ä¸€ä¸‹ã€‚ Parameter_manager: Parameter_manager ä¸»è¦æ˜¯ GlobalState çš„ä¸€ä¸ªç”¨äºç®¡ç†ä¸€äº›è°ƒèŠ‚ horovod æ€§èƒ½çš„å‚æ•°çš„ç®¡ç†å™¨ï¼Œåœ¨ BackgroundThreadLoop ä¸­è·Ÿå…¶ä»–çš„ GlobalState çš„å…ƒç´ ä¸€åŒåˆå§‹åŒ–ï¼Œç„¶åä¼šè¯»å–ä¸‹é¢è¿™äº›å¯¹åº”çš„ç¯å¢ƒå˜é‡ï¼Œç„¶åè¿›è¡Œè®¾ç½®ã€‚ HOROVOD_FUSION_THRESHOLDï¼šæŒ‡ä¼ è¾“æ•°æ®åˆ‡ç‰‡çš„å¤§å°ï¼Œé»˜è®¤æ˜¯64Mï¼Œå¦‚æœåˆ‡ç‰‡å¤ªå¤§ï¼Œä¼ è¾“çš„æ—¶å€™å°±ä¸èƒ½å¾ˆå¥½åœ° pipeline ä¼ è¾“ï¼Œå¦‚æœå¤ªå°ï¼Œä¸€ä¸ª tensor éœ€è¦ä¼ è¾“å¤šæ¬¡ï¼Œå¢åŠ  IO çš„ overheadã€‚ HOROVOD_CYCLE_TIMEï¼šæŒ‡ RunLoopOnce çš„ç¡çœ æ—¶é•¿ï¼Œé»˜è®¤æ˜¯ 5msï¼Œæˆ‘è‡ªå·±çš„çŒœæµ‹ï¼ˆè¿˜æ²¡è¿›è¡ŒéªŒè¯ï¼‰æ¯”è¾ƒç†æƒ³çš„ç¡çœ æ—¶é—´åº”è¯¥æ˜¯ RunLoopOnce å…¶ä½™é€»è¾‘å¤„ç†çš„æ—¶é—´ + HOROVOD_CYCLE_TIME åˆšå¥½ç­‰äºä¸€æ¬¡å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­æ‰€ç”¨çš„æ—¶é—´ï¼Œå› ä¸ºç¡å¤ªä¹…å‰ç«¯ä¼šåœ¨ç­‰ RunLoopOnce ç¡é†’ï¼›å¦‚æœç¡å¤ªçŸ­ï¼Œä¸æ–­åœ°è·‘ä¸€æ¬¡ RunLoopOnceï¼Œtensor_queue ä¹Ÿä¸ä¼šæœ‰æ–°çš„å…ƒç´ ï¼Œåªæ˜¯ç™½è·‘ã€‚ HOROVOD_CACHE_CAPACITYï¼šæŒ‡ cache çš„å¤§å°ï¼Œè¿™ä¸ªå¯èƒ½è·Ÿ model å±‚æ•°å‚æ•°é‡ç›¸å…³äº†ã€‚ HOROVOD_HIERARCHICAL_ALLGATHERï¼šæ˜¯å¦ä½¿ç”¨åˆ†å±‚çš„allgatherçš„æ–¹å¼ç­‰ Parameter_managerä¹Ÿæä¾›äº†å¯¹è¿™äº›å‚æ•°è‡ªåŠ¨è°ƒèŠ‚çš„åŠŸèƒ½ã€‚é€šè¿‡Parameter_manager.SetAutoTuningè¿›è¡Œè®¾ç½®ï¼Œè®¾ç½®åä¼šåœ¨åˆå§‹çš„å‡ ä¸ªbatchå°è¯•ä¸åŒçš„å‚æ•°ç»„åˆè¿›è¡Œé€šä¿¡ï¼Œåé¢ä¼šæ”¶æ•›åˆ°ä¸€ç»„æœ€ä¼˜çš„å‚æ•°å€¼ã€‚ ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:3:3","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"MPIContext mpi_context æ˜¯åœ¨åŠ è½½ C++ çš„ä»£ç æ—¶å€™å°±å·²ç»åˆ›å»ºäº†ï¼ŒåŒæ—¶åˆ›å»ºçš„è¿˜æœ‰å…¶ä»– contextï¼ˆ nccl_context, gpu_contextï¼‰ï¼Œä¸»è¦æ˜¯ç»´æŠ¤ä¸€äº›èŠ‚ç‚¹ä¸Š mpi é€šä¿¡çš„å¿…è¦ç¯å¢ƒä¿¡æ¯å’Œè®¾ç½®ï¼Œå¦‚ï¼š 3 ä¸ª MPI communicatorï¼Œmpi_commï¼Œlocal_commï¼Œcross_comm åˆ†åˆ«è´Ÿè´£ horovod mpi ä¼ è¾“ï¼ŒèŠ‚ç‚¹å†…ä¼ è¾“ï¼Œå’ŒèŠ‚ç‚¹é—´åˆ†å±‚ä¼ è¾“ï¼ˆä¸»è¦ç”¨äº hierarchical allreduceï¼‰ã€‚ mpi_float16_t: horovod ä¸»è¦ä»¥ float16 ä¼ è¾“ã€‚ mpi_float16_sum: float16 å¯¹åº”çš„sum æ“ä½œã€‚ åœ¨ horovod ä½¿ç”¨ mpi çš„æ—¶å€™ï¼Œéƒ½ä¼šä½¿ç”¨ä¸Šé¢çš„ communicator è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚ ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:3:4","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"Tensorflow2 TensorFlow2 å‰ç«¯å¯¹ horovod çš„è°ƒç”¨è·Ÿ pytorch ç±»ä¼¼ï¼Œåªæ˜¯å› ä¸º tensorflow 2 æ˜¯é€šè¿‡ tape ç­‰çº§åˆ¶è®°å½•æ¢¯åº¦çš„, æ‰€ä»¥ä¼šæœ‰ä¸€äº›ä¸åŒã€‚ hvd.init() # Set up standard model. model = getattr(applications, args.model)(weights=None) opt = tf.optimizers.SGD(0.01) data = tf.random.uniform([args.batch_size, 224, 224, 3]) target = tf.random.uniform([args.batch_size, 1], minval=0, maxval=999, dtype=tf.int64) @tf.function def benchmark_step(first_batch): # Horovod: (optional) compression algorithm. compression = hvd.Compression.fp16 if args.fp16_allreduce else hvd.Compression.none # Horovod: use DistributedGradientTape with tf.GradientTape() as tape: probs = model(data, training=True) loss = tf.losses.sparse_categorical_crossentropy(target, probs) # Horovod: add Horovod Distributed GradientTape. tape = hvd.DistributedGradientTape(tape, compression=compression) gradients = tape.gradient(loss, model.trainable_variables) opt.apply_gradients(zip(gradients, model.trainable_variables)) if first_batch: hvd.broadcast_variables(model.variables, root_rank=0) hvd.broadcast_variables(opt.variables(), root_rank=0) for x in range(args.num_iters): benchmark_step(first_batch=False) with tf.GradientTape() as tapeè¿™ä¸€å¥ä¼šè°ƒç”¨ horovod/tensorflow/__init__.py ä¸­_DistributedGradientTape ä¸‹ init å‡½æ•°æ³¨å†Œ allreduce çš„å¥æŸ„ï¼ˆhandleï¼‰ ç„¶åè°ƒç”¨ gradients = tape.gradient(loss, model.trainable_variables) ä¼šè°ƒç”¨ä¸€ç³»åˆ—çš„è·³è½¬æœ€åä¼šè°ƒç”¨ tensorflow/mpi_ops.py ä¸‹çš„ _allreduce ï¼Œè¿›è€Œè°ƒç”¨ `MPI_LIB.horovod_allreduce MPI_LIB.horovod_allreduce åœ¨ horovod/tensorflow/http://mpi_ops.cc ä¸­è¢« HorovodAllreduceOp æ‰€æ³¨å†Œï¼Œæ ¹æ® TensorFlow çš„ opsæµç¨‹ï¼Œä¼šè°ƒç”¨ ops.ComputeAsyncï¼Œåˆ°è¿™é‡Œä¼šè·Ÿ pytorch ç±»ä¼¼ä¼šè°ƒç”¨ EnqueueTensorAllreduce æŠŠå¯¹åº”çš„ tensor å’Œ ops é€åˆ° GlobalState çš„ tensor_queue ä¸­ã€‚ class HorovodAllreduceOp : public AsyncOpKernel { public: explicit HorovodAllreduceOp(OpKernelConstruction* context) : AsyncOpKernel(context) { OP_REQUIRES_OK(context, context-\u003eGetAttr(\"reduce_op\", \u0026reduce_op_)); OP_REQUIRES_OK(context, context-\u003eGetAttr(\"prescale_factor\", \u0026prescale_factor_)); OP_REQUIRES_OK(context, context-\u003eGetAttr(\"postscale_factor\", \u0026postscale_factor_)); OP_REQUIRES_OK(context, context-\u003eGetAttr(\"ignore_name_scope\", \u0026ignore_name_scope_)); } void ComputeAsync(OpKernelContext* context, DoneCallback done) override { OP_REQUIRES_OK_ASYNC(context, ConvertStatus(common::CheckInitialized()), done); ... // ä¸€äº›å˜é‡éªŒè¯ï¼Œåˆå§‹åŒ– auto enqueue_result = EnqueueTensorAllreduce( hvd_context, hvd_tensor, hvd_output, ready_event, node_name, device, [context, done](const common::Status\u0026 status) { context-\u003eSetStatus(ConvertStatus(status)); done(); }, reduce_op, (double) prescale_factor_, (double) postscale_factor_); OP_REQUIRES_OK_ASYNC(context, ConvertStatus(enqueue_result), done); } private: int reduce_op_; // Using float since TF does not support double OP attributes float prescale_factor_; float postscale_factor_; bool ignore_name_scope_; }; ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:3:5","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["Distributed Computing"],"content":"æ€»ç»“ horovod çš„æµç¨‹åˆ†æå¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼Œæ²¡æœ‰ç‰¹åˆ«å¤æ‚ï¼Œä»£ç çš„é˜…è¯»ä½“éªŒä¹Ÿæ˜¯æ¯”è¾ƒå¥½çš„ï¼Œåœ¨ä¸»æµç¨‹çš„å…³é”®å‡½æ•°éƒ½æœ‰æ¯”è¾ƒæ¸…æ™°çš„æ³¨é‡Šã€‚å¯¹äºç¬¬ä¸‰æ–¹å¼€å‘è€…æ¥è¯´ï¼Œhorovod æœ¬èº«å·²ç»ç”¨äº†å¾ˆå¤šæé«˜æ€§èƒ½çš„ tricksï¼Œå¯ä»¥ custom ä¼˜åŒ–çš„åœ°æ–¹ä¸å¤šï¼Œä¸€äº›å¯ä»¥åŠ¨çš„å‚æ•°ï¼Œä¹Ÿå·²ç»æä¾›äº†autotuningï¼Œç›´æ¥ä½¿ç”¨å°±å¯ä»¥å¾—åˆ°å¾ˆå¥½çš„æ€§èƒ½ã€‚å¦‚æœå°è¯•ä¼˜åŒ–ï¼Œå¯èƒ½è¦ä»ä¼ è¾“ä¸Šç€æ‰‹ï¼Œå¦‚ BytePS ä¼šå°è¯•ä½¿ç”¨ä¸åŒçš„ç½‘ç»œæ‹“æ‰‘å¼•å…¥ä¸€äº› PS èŠ‚ç‚¹æé«˜å¸¦å®½ç­‰ï¼Œå¦‚æœæœ‰æ—¶é—´æˆ‘ä¹Ÿä¼šèŠä¸€ä¸‹è¿™ä¸ªã€‚å¦å¤–ä¸Šé¢çš„åˆ†æä¹Ÿæœ‰å¾ˆå¤šæ˜¯æˆ‘è‡ªå·±é˜…è¯»ä»£ç æ—¶å€™çš„ä¸€äº›æ€è€ƒå¯èƒ½ä¸ä¸€å®šå‡†ç¡®ï¼Œå¦‚æœæœ‰ä¸å‡†ç¡®æˆ–è€…æ¨¡ç³Šçš„åœ°æ–¹ï¼Œä¹Ÿå¸Œæœ›å¤§å®¶å¯ä»¥å¤šå¤šæ–§æ­£ã€‚ References: [1]. https://zhuanlan.zhihu.com/p/332825987 [2]. https://zhuanlan.zhihu.com/p/158584571 [3]. https://zhuanlan.zhihu.com/p/79030485 [4]. https://github.com/zjykzj/pytorch-distributed [5]. MPIæ•™ç¨‹ https://blog.csdn.net/qq_47058489/article/details/125980505 https://blog.csdn.net/weixin_45385568/article/details/121208161?spm=1001.2101.3001.6650.1\u0026utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1-121208161-blog-87971642.pc_relevant_multi_platform_featuressortv2removedup\u0026depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1-121208161-blog-87971642.pc_relevant_multi_platform_featuressortv2removedup\u0026utm_relevant_index=1 [5.] ubuntu20.04 + docker + horovod Horovod and Distributed Training ","date":"2023-07-13","objectID":"/posts/horovod_and_openmpi/:4:0","tags":["Horovod"],"title":"Horovod and Openmpi","uri":"/posts/horovod_and_openmpi/"},{"categories":["OS"],"content":"è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« ","date":"2023-07-13","objectID":"/posts/os_2/:1:0","tags":["OS"],"title":"Process and Coroutine","uri":"/posts/os_2/"},{"categories":["OS"],"content":"è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹çš„æ¦‚å¿µ è¿›ç¨‹ï¼š æ˜¯å¹¶å‘æ‰§è¡Œçš„ç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­åˆ†é…å’Œç®¡ç†èµ„æºçš„åŸºæœ¬å•ä½ï¼Œæ˜¯ä¸€ä¸ªåŠ¨æ€æ¦‚å¿µï¼Œç«äº‰è®¡ç®—æœºç³»ç»Ÿèµ„æºçš„åŸºæœ¬å•ä½ã€‚ çº¿ç¨‹ï¼š æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œæ˜¯è¿›ç¨‹å†…ç§‘è°ƒåº¦å®ä½“ã€‚æ¯”è¿›ç¨‹æ›´å°çš„ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹ä¹Ÿè¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ã€‚ åç¨‹ï¼š æ˜¯ä¸€ç§æ¯”çº¿ç¨‹æ›´åŠ è½»é‡çº§çš„å­˜åœ¨ã€‚ä¸€ä¸ªçº¿ç¨‹ä¹Ÿå¯ä»¥æ‹¥æœ‰å¤šä¸ªåç¨‹ã€‚å…¶æ‰§è¡Œè¿‡ç¨‹æ›´ç±»ä¼¼äºå­ä¾‹ç¨‹ï¼Œæˆ–è€…è¯´ä¸å¸¦è¿”å›å€¼çš„å‡½æ•°è°ƒç”¨ã€‚ ","date":"2023-07-13","objectID":"/posts/os_2/:1:1","tags":["OS"],"title":"Process and Coroutine","uri":"/posts/os_2/"},{"categories":["OS"],"content":"è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« åœ°å€ç©ºé—´ï¼š çº¿ç¨‹å…±äº«æœ¬è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œè€Œè¿›ç¨‹ä¹‹é—´æ˜¯ç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€‚ èµ„æºï¼š çº¿ç¨‹å…±äº«æœ¬è¿›ç¨‹çš„èµ„æºå¦‚å†…å­˜ã€I/Oã€cpuç­‰ï¼Œä¸åˆ©äºèµ„æºçš„ç®¡ç†å’Œä¿æŠ¤ï¼Œè€Œè¿›ç¨‹ä¹‹é—´çš„èµ„æºæ˜¯ç‹¬ç«‹çš„ï¼Œèƒ½å¾ˆå¥½çš„è¿›è¡Œèµ„æºç®¡ç†å’Œä¿æŠ¤ã€‚ å¥å£®æ€§ï¼š å¤šè¿›ç¨‹è¦æ¯”å¤šçº¿ç¨‹å¥å£®ï¼Œä¸€ä¸ªè¿›ç¨‹å´©æºƒåï¼Œåœ¨ä¿æŠ¤æ¨¡å¼ä¸‹ä¸ä¼šå¯¹å…¶ä»–è¿›ç¨‹äº§ç”Ÿå½±å“ï¼Œä½†æ˜¯ä¸€ä¸ªçº¿ç¨‹å´©æºƒæ•´ä¸ªè¿›ç¨‹éƒ½æ­»æ‰ã€‚ æ‰§è¡Œè¿‡ç¨‹ï¼š æ¯ä¸ªç‹¬ç«‹çš„è¿›ç¨‹æœ‰ä¸€ä¸ªç¨‹åºè¿è¡Œçš„å…¥å£ã€é¡ºåºæ‰§è¡Œåºåˆ—å’Œç¨‹åºå…¥å£ï¼Œæ‰§è¡Œå¼€é”€å¤§ã€‚ ä½†æ˜¯çº¿ç¨‹ä¸èƒ½ç‹¬ç«‹æ‰§è¡Œï¼Œå¿…é¡»ä¾å­˜åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œç”±åº”ç”¨ç¨‹åºæä¾›å¤šä¸ªçº¿ç¨‹æ‰§è¡Œæ§åˆ¶ï¼Œæ‰§è¡Œå¼€é”€å°ã€‚ å¯å¹¶å‘æ€§ï¼š ä¸¤è€…å‡å¯å¹¶å‘æ‰§è¡Œã€‚ åˆ‡æ¢æ—¶ï¼š è¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œæ¶ˆè€—çš„èµ„æºå¤§ï¼Œæ•ˆç‡é«˜ã€‚æ‰€ä»¥æ¶‰åŠåˆ°é¢‘ç¹çš„åˆ‡æ¢æ—¶ï¼Œä½¿ç”¨çº¿ç¨‹è¦å¥½äºè¿›ç¨‹ã€‚åŒæ ·å¦‚æœè¦æ±‚åŒæ—¶è¿›è¡Œå¹¶ä¸”åˆè¦å…±äº«æŸäº›å˜é‡çš„å¹¶å‘æ“ä½œï¼Œåªèƒ½ç”¨çº¿ç¨‹ä¸èƒ½ç”¨è¿›ç¨‹ã€‚ å…¶ä»–ï¼š çº¿ç¨‹æ˜¯å¤„ç†å™¨è°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œä½†æ˜¯è¿›ç¨‹ä¸æ˜¯ã€‚ ","date":"2023-07-13","objectID":"/posts/os_2/:1:2","tags":["OS"],"title":"Process and Coroutine","uri":"/posts/os_2/"},{"categories":["OS"],"content":"åç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« åç¨‹é¿å…äº†æ— æ„ä¹‰çš„è°ƒåº¦ï¼Œç”±æ­¤å¯ä»¥æé«˜æ€§èƒ½ï¼Œä½†ç¨‹åºå‘˜å¿…é¡»è‡ªå·±æ‰¿æ‹…è°ƒåº¦çš„è´£ä»»ã€‚åŒæ—¶ï¼Œåç¨‹ä¹Ÿå¤±å»äº†æ ‡å‡†çº¿ç¨‹ä½¿ç”¨å¤šCPUçš„èƒ½åŠ›ã€‚ çº¿ç¨‹ï¼ˆthreadï¼‰ ç›¸å¯¹ç‹¬ç«‹ æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ åˆ‡æ¢å—ç³»ç»Ÿæ§åˆ¶ï¼› åç¨‹ï¼ˆcoroutineï¼‰ ç›¸å¯¹ç‹¬ç«‹ æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ åˆ‡æ¢ç”±è‡ªå·±æ§åˆ¶ï¼Œç”±å½“å‰åç¨‹åˆ‡æ¢åˆ°å…¶ä»–åç¨‹ç”±å½“å‰åç¨‹æ¥æ§åˆ¶ã€‚ ","date":"2023-07-13","objectID":"/posts/os_2/:1:3","tags":["OS"],"title":"Process and Coroutine","uri":"/posts/os_2/"},{"categories":["OS"],"content":"ä½•æ—¶ä½¿ç”¨å¤šè¿›ç¨‹ï¼Œä½•æ—¶ä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ å¯¹èµ„æºçš„ç®¡ç†å’Œä¿æŠ¤è¦æ±‚é«˜ï¼Œä¸é™åˆ¶å¼€é”€å’Œæ•ˆç‡æ—¶ï¼Œä½¿ç”¨å¤šè¿›ç¨‹ã€‚ è¦æ±‚æ•ˆç‡é«˜ï¼Œé¢‘ç¹åˆ‡æ¢æ—¶ï¼Œèµ„æºçš„ä¿æŠ¤ç®¡ç†è¦æ±‚ä¸æ˜¯å¾ˆé«˜æ—¶ï¼Œä½¿ç”¨å¤šçº¿ç¨‹ã€‚ ","date":"2023-07-13","objectID":"/posts/os_2/:1:4","tags":["OS"],"title":"Process and Coroutine","uri":"/posts/os_2/"},{"categories":["OS"],"content":"ä¸ºä»€ä¹ˆä¼šæœ‰çº¿ç¨‹ï¼Ÿ æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ï¼Œå³è¿›ç¨‹ç©ºé—´ï¼Œåœ¨ç½‘ç»œæˆ–å¤šç”¨æˆ·æ¢æœºä¸‹ï¼Œä¸€ä¸ªæœåŠ¡å™¨é€šå¸¸éœ€è¦æ¥æ”¶å¤§é‡ä¸ç¡®å®šæ•°é‡ç”¨æˆ·çš„å¹¶å‘è¯·æ±‚ï¼Œä¸ºæ¯ä¸€ä¸ªè¯·æ±‚éƒ½åˆ›å»ºä¸€ä¸ªè¿›ç¨‹æ˜¾ç„¶è¡Œä¸é€šï¼ˆç³»ç»Ÿå¼€é”€å¤§å“åº”ç”¨æˆ·è¯·æ±‚æ•ˆç‡ä½ï¼‰ï¼Œå› æ­¤æ“ä½œç³»ç»Ÿä¸­çº¿ç¨‹æ¦‚å¿µè¢«å¼•è¿›ã€‚ ","date":"2023-07-13","objectID":"/posts/os_2/:1:5","tags":["OS"],"title":"Process and Coroutine","uri":"/posts/os_2/"},{"categories":["OS"],"content":"*pythonå¤šçº¿ç¨‹å­˜åœ¨çš„é—®é¢˜ å­˜åœ¨é—®é¢˜ï¼š pythonç”±äºå†å²é—ç•™çš„é—®é¢˜ï¼Œä¸¥æ ¼è¯´å¤šä¸ªçº¿ç¨‹å¹¶ä¸ä¼šåŒæ—¶æ‰§è¡Œï¼ˆæ²¡æ³•æœ‰æ•ˆåˆ©ç”¨å¤šæ ¸å¤„ç†å™¨ï¼Œpythonçš„å¹¶å‘åªæ˜¯åœ¨äº¤æ›¿æ‰§è¡Œä¸åŒçš„ä»£ç ï¼‰ã€‚ å¤šçº¿ç¨‹åœ¨Pythonä¸­åªèƒ½äº¤æ›¿æ‰§è¡Œï¼Œå³ä½¿100ä¸ªçº¿ç¨‹è·‘åœ¨100æ ¸CPUä¸Šï¼Œä¹Ÿåªèƒ½ç”¨åˆ°1ä¸ªæ ¸ã€‚æ‰€ä»¥pythonçš„å¤šçº¿ç¨‹å¹¶å‘å¹¶ä¸èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸ï¼Œå¹¶å‘æ²¡æœ‰javaçš„å¹¶å‘ä¸¥æ ¼ã€‚ åŸå› ï¼š åŸå› å°±åœ¨äºGIL ï¼Œåœ¨Cpython è§£é‡Šå™¨ï¼ˆPythonè¯­è¨€çš„ä¸»æµè§£é‡Šå™¨ï¼‰ä¸­ï¼Œæœ‰ä¸€æŠŠå…¨å±€è§£é‡Šé”ï¼ˆGIL, Global Interpreter Lockï¼‰ï¼Œåœ¨è§£é‡Šå™¨è§£é‡Šæ‰§è¡ŒPython ä»£ç æ—¶ï¼Œä»»ä½•Pythonçº¿ç¨‹æ‰§è¡Œå‰ï¼Œéƒ½å…ˆè¦å¾—åˆ°è¿™æŠŠGILé”ã€‚ è¿™ä¸ªGILå…¨å±€é”å®é™…ä¸ŠæŠŠæ‰€æœ‰çº¿ç¨‹çš„æ‰§è¡Œä»£ç éƒ½ç»™ä¸Šäº†é”ã€‚ è¿™æ„å‘³ç€ï¼Œpythonåœ¨ä»»ä½•æ—¶å€™ï¼Œåªå¯èƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œä»£ç ã€‚ å…¶å®ƒçº¿ç¨‹è¦æƒ³è·å¾—CPUæ‰§è¡Œä»£ç æŒ‡ä»¤ï¼Œå°±å¿…é¡»å…ˆè·å¾—è¿™æŠŠé”ï¼Œå¦‚æœé”è¢«å…¶å®ƒçº¿ç¨‹å ç”¨äº†ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹å°±åªèƒ½ç­‰å¾…ï¼Œç›´åˆ°å æœ‰è¯¥é”çš„çº¿ç¨‹é‡Šæ”¾é”æ‰æœ‰æ‰§è¡Œä»£ç æŒ‡ä»¤çš„å¯èƒ½ã€‚ å¤šä¸ªçº¿ç¨‹ä¸€èµ·æ‰§è¡Œåè€Œæ›´åŠ æ…¢çš„åŸå› ï¼š åŒä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œï¼Œå…¶å®ƒçº¿ç¨‹åªèƒ½ç­‰å¾…ï¼Œå³ä½¿æ˜¯å¤šæ ¸CPUï¼Œä¹Ÿæ²¡åŠæ³•è®©å¤šä¸ªçº¿ç¨‹ã€Œå¹¶è¡Œã€åœ°åŒæ—¶æ‰§è¡Œä»£ç ï¼Œåªèƒ½æ˜¯äº¤æ›¿æ‰§è¡Œï¼Œå› ä¸ºå¤šçº¿ç¨‹æ¶‰åŠåˆ°ä¸Šçº¿æ–‡åˆ‡æ¢ã€é”æœºåˆ¶å¤„ç†ï¼ˆè·å–é”ï¼Œé‡Šæ”¾é”ç­‰ï¼‰ï¼Œæ‰€ä»¥ï¼Œå¤šçº¿ç¨‹æ‰§è¡Œä¸å¿«åæ…¢ã€‚ ä»€ä¹ˆæ—¶å€™GILè¢«é‡Šæ”¾ï¼Ÿ å½“ä¸€ä¸ªçº¿ç¨‹é‡åˆ°I/O ä»»åŠ¡æ—¶ï¼Œå°†é‡Šæ”¾GILã€‚ è®¡ç®—å¯†é›†å‹ï¼ˆCPU-boundï¼‰çº¿ç¨‹æ‰§è¡Œ100æ¬¡è§£é‡Šå™¨çš„è®¡æ­¥ï¼ˆticksï¼‰æ—¶ï¼ˆè®¡æ­¥å¯ç²—ç•¥çœ‹ä½œPython è™šæ‹Ÿæœºçš„æŒ‡ä»¤ï¼‰ï¼Œä¹Ÿä¼šé‡Šæ”¾GILã€‚ å³ï¼Œæ¯æ‰§è¡Œ100æ¡å­—èŠ‚ç ï¼Œè§£é‡Šå™¨å°±è‡ªåŠ¨é‡Šæ”¾GILé”ï¼Œè®©åˆ«çš„çº¿ç¨‹æœ‰æœºä¼šæ‰§è¡Œã€‚ Pythonè™½ç„¶ä¸èƒ½åˆ©ç”¨å¤šçº¿ç¨‹å®ç°å¤šæ ¸ä»»åŠ¡ï¼Œä½†å¯ä»¥é€šè¿‡å¤šè¿›ç¨‹å®ç°å¤šæ ¸ä»»åŠ¡ã€‚å¤šä¸ªPythonè¿›ç¨‹æœ‰å„è‡ªç‹¬ç«‹çš„GILé”ï¼Œäº’ä¸å½±å“ã€‚ å‚è€ƒåšå®¢ ","date":"2023-07-13","objectID":"/posts/os_2/:1:6","tags":["OS"],"title":"Process and Coroutine","uri":"/posts/os_2/"},{"categories":["OS"],"content":"*è¿›ç¨‹çš„å‡ ç§é€šä¿¡æ–¹å¼ ç®¡é“ï¼š é€Ÿåº¦æ…¢ï¼Œå®¹é‡æœ‰é™ï¼Œåªæœ‰çˆ¶å­è¿›ç¨‹èƒ½é€šè®¯ FIFOï¼š ä»»ä½•è¿›ç¨‹é—´éƒ½èƒ½é€šè®¯ï¼Œä½†é€Ÿåº¦æ…¢ æ¶ˆæ¯é˜Ÿåˆ—ï¼š å®¹é‡å—åˆ°ç³»ç»Ÿé™åˆ¶ï¼Œä¸”è¦æ³¨æ„ç¬¬ä¸€æ¬¡è¯»çš„æ—¶å€™ï¼Œè¦è€ƒè™‘ä¸Šä¸€æ¬¡æ²¡æœ‰è¯»å®Œæ•°æ®çš„é—®é¢˜ ä¿¡å·é‡ï¼š ä¸èƒ½ä¼ é€’å¤æ‚æ¶ˆæ¯ï¼Œåªèƒ½ç”¨æ¥åŒæ­¥ å…±äº«å†…å­˜åŒºï¼š èƒ½å¤Ÿå¾ˆå®¹æ˜“æ§åˆ¶å®¹é‡ï¼Œé€Ÿåº¦å¿«ï¼Œä½†è¦ä¿æŒåŒæ­¥ï¼Œæ¯”å¦‚ä¸€ä¸ªè¿›ç¨‹åœ¨å†™çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªè¿›ç¨‹è¦æ³¨æ„è¯»å†™çš„é—®é¢˜ï¼Œç›¸å½“äºçº¿ç¨‹ä¸­çš„çº¿ç¨‹å®‰å…¨ï¼Œå½“ç„¶ï¼Œå…±äº«å†…å­˜åŒºåŒæ ·å¯ä»¥ç”¨ä½œçº¿ç¨‹é—´é€šè®¯ï¼Œä¸è¿‡æ²¡è¿™ä¸ªå¿…è¦ï¼Œçº¿ç¨‹é—´æœ¬æ¥å°±å·²ç»å…±äº«äº†åŒä¸€è¿›ç¨‹å†…çš„ä¸€å—å†…å­˜ ","date":"2023-07-13","objectID":"/posts/os_2/:1:7","tags":["OS"],"title":"Process and Coroutine","uri":"/posts/os_2/"},{"categories":["OS"],"content":"*ä¸¾ä¾‹è¯´æ˜è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹ ç¨‹åºï¼š ä¾‹å¦‚main.pyè¿™æ˜¯ç¨‹åºï¼Œæ˜¯ä¸€ä¸ªé™æ€çš„ç¨‹åºã€‚ pythonè¿›ç¨‹ï¼š ä¸€ä¸ªç¨‹åºè¿è¡Œèµ·æ¥åï¼Œä»£ç +ç”¨åˆ°çš„èµ„æº ç§°ä¹‹ä¸ºè¿›ç¨‹ï¼Œå®ƒæ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„åŸºæœ¬å•å…ƒã€‚ multiprocessing.Processå®ç°å¤šè¿›ç¨‹ è¿›ç¨‹æ± ï¼š å¦‚æœè¦å¯åŠ¨å¤§é‡çš„å­è¿›ç¨‹ï¼Œå¯ä»¥ç”¨è¿›ç¨‹æ± çš„æ–¹å¼æ‰¹é‡åˆ›å»ºå­è¿›ç¨‹ã€‚ multiprocessing.Pool è¿›ç¨‹é—´é€šä¿¡ï¼š å„è‡ªåœ¨ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œå¹¶ä¸èƒ½ç›´æ¥è¿›è¡Œå…¨å±€çš„æ•°æ®å…±äº«ï¼Œåœ¨åˆ›å»ºå­è¿›ç¨‹çš„æ—¶å€™ä¼šå°†çˆ¶è¿›ç¨‹çš„æ•°æ®å¤åˆ¶åˆ°å­è¿›ç¨‹ä¸­ä¸€ä»½ã€‚ è¿›ç¨‹é—´é€šä¿¡ Pythonçš„multiprocessingæ¨¡å—åŒ…è£…äº†åº•å±‚çš„æœºåˆ¶ï¼Œæä¾›äº†Queueã€Pipesç­‰å¤šç§æ–¹å¼æ¥äº¤æ¢æ•°æ®ã€‚ pythonçº¿ç¨‹ï¼š threadæ˜¯æ¯”è¾ƒä½çº§,åº•å±‚çš„æ¨¡å—ï¼Œthreadingæ˜¯é«˜çº§æ¨¡å—ï¼Œå¯¹threadè¿›è¡Œäº†å°è£…,å¯ä»¥æ›´åŠ æ–¹ä¾¿çš„è¢«ä½¿ç”¨ã€‚ pythonåç¨‹ï¼š çº¿ç¨‹å’Œè¿›ç¨‹çš„æ“ä½œæ˜¯ç”±ç¨‹åºè§¦å‘ç³»ç»Ÿæ¥å£ï¼Œæœ€åçš„æ‰§è¡Œè€…æ˜¯ç³»ç»Ÿï¼›åç¨‹çš„æ“ä½œåˆ™æ˜¯ç¨‹åºå‘˜,å½“ç¨‹åºä¸­å­˜åœ¨å¤§é‡ä¸éœ€è¦CPUçš„æ“ä½œæ—¶ï¼ˆä¾‹å¦‚ I/Oï¼‰ï¼Œé€‚ç”¨äºåç¨‹ã€‚ ä¾‹å¦‚yield å…¶ä¸­ yield æ˜¯pythonå½“ä¸­çš„è¯­æ³•ã€‚ å½“åç¨‹æ‰§è¡Œåˆ°yieldå…³é”®å­—æ—¶ï¼Œä¼šæš‚åœåœ¨é‚£ä¸€è¡Œï¼Œç­‰åˆ°ä¸»çº¿ç¨‹è°ƒç”¨sendæ–¹æ³•å‘é€äº†æ•°æ®ï¼Œåç¨‹æ‰ä¼šæ¥åˆ°æ•°æ®ç»§ç»­æ‰§è¡Œã€‚ ä½†æ˜¯ï¼Œyieldè®©åç¨‹æš‚åœï¼Œå’Œçº¿ç¨‹çš„é˜»å¡æ˜¯æœ‰æœ¬è´¨åŒºåˆ«çš„ã€‚ \u003c/font color=red\u003eåç¨‹çš„æš‚åœå®Œå…¨ç”±ç¨‹åºæ§åˆ¶ï¼Œçº¿ç¨‹çš„é˜»å¡çŠ¶æ€æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸æ¥è¿›è¡Œåˆ‡æ¢ã€‚ å› æ­¤ï¼Œåç¨‹çš„å¼€é”€è¿œè¿œå°äºçº¿ç¨‹çš„å¼€é”€ã€‚ æœ€é‡è¦çš„æ˜¯ï¼Œåç¨‹ä¸æ˜¯è¢«æ“ä½œç³»ç»Ÿå†…æ ¸æ‰€ç®¡ç†ï¼Œè€Œå®Œå…¨æ˜¯ç”±ç¨‹åºæ‰€æ§åˆ¶(ä¹Ÿå°±æ˜¯åœ¨ç”¨æˆ·æ€æ‰§è¡Œ)ã€‚ è¿™æ ·å¸¦æ¥çš„å¥½å¤„å°±æ˜¯æ€§èƒ½å¾—åˆ°äº†å¾ˆå¤§çš„æå‡ï¼Œä¸ä¼šåƒçº¿ç¨‹åˆ‡æ¢é‚£æ ·æ¶ˆè€—èµ„æºã€‚ pythonå¯ä»¥é€šè¿‡ yield/send çš„æ–¹å¼å®ç°åç¨‹ã€‚åœ¨python 3.5ä»¥åï¼Œasync/await æˆä¸ºäº†æ›´å¥½çš„æ›¿ä»£æ–¹æ¡ˆã€‚ ","date":"2023-07-13","objectID":"/posts/os_2/:1:8","tags":["OS"],"title":"Process and Coroutine","uri":"/posts/os_2/"},{"categories":["OS"],"content":"æ“ä½œç³»ç»Ÿ(ä¸€) ","date":"2023-07-13","objectID":"/posts/os_1/:1:0","tags":["OS"],"title":"è®¡ç®—æœºæ“ä½œç³»ç»Ÿ","uri":"/posts/os_1/"},{"categories":["OS"],"content":"1.1 è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ è¿›ç¨‹å’Œçº¿ç¨‹éƒ½æ˜¯æ“ä½œç³»ç»Ÿä¸­è¿›è¡Œä»»åŠ¡è°ƒåº¦çš„åŸºæœ¬å•ä½ï¼ŒäºŒè€…ä¹‹é—´çš„ä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š èµ„æºå ç”¨ï¼šè¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œè€Œçº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­çš„æ‰§è¡Œå•å…ƒï¼Œæ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚æ¯ä¸ªçº¿ç¨‹å…±äº«æ‰€å±è¿›ç¨‹çš„èµ„æºï¼Œå¦‚ä»£ç æ®µã€æ•°æ®æ®µã€æ‰“å¼€çš„æ–‡ä»¶ç­‰ã€‚è€Œè¿›ç¨‹ä¹‹é—´äº’ç›¸ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„èµ„æºç©ºé—´ï¼Œä¸åŒè¿›ç¨‹ä¹‹é—´éœ€è¦é€šè¿‡IPCï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰æ¥è¿›è¡Œé€šä¿¡å’Œæ•°æ®å…±äº«ã€‚ è°ƒåº¦å’Œåˆ‡æ¢ï¼šæ“ä½œç³»ç»Ÿåœ¨è°ƒåº¦å’Œåˆ†é…CPUæ—¶ï¼Œå°†è¿›ç¨‹ä½œä¸ºåŸºæœ¬çš„è°ƒåº¦å’Œåˆ†é…å•ä½ï¼Œå³è¿›ç¨‹æ‹¥æœ‰è‡ªå·±çš„è°ƒåº¦é˜Ÿåˆ—ã€‚è€Œçº¿ç¨‹æ˜¯ä¾é™„äºè¿›ç¨‹è€Œå­˜åœ¨çš„ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„æ—¶é—´ç‰‡å’Œèµ„æºï¼Œå› æ­¤åœ¨è°ƒåº¦å’Œåˆ‡æ¢æ—¶ï¼Œçº¿ç¨‹åˆ‡æ¢æ¯”è¿›ç¨‹åˆ‡æ¢æ›´å¿«ï¼Œä¹Ÿæ›´åŠ è½»é‡çº§ã€‚ åˆ›å»ºå’Œé”€æ¯ï¼šè¿›ç¨‹çš„åˆ›å»ºå’Œé”€æ¯æ¯”çº¿ç¨‹æ›´åŠ å¤æ‚ï¼Œåˆ›å»ºä¸€ä¸ªè¿›ç¨‹éœ€è¦ä¸ºå…¶åˆ†é…èµ„æºã€å»ºç«‹PCBï¼ˆè¿›ç¨‹æ§åˆ¶å—ï¼‰ã€å»ºç«‹å†…æ ¸å¯¹è±¡ç­‰ï¼Œè€Œé”€æ¯è¿›ç¨‹éœ€è¦å›æ”¶èµ„æºã€å…³é—­æ‰“å¼€çš„æ–‡ä»¶ç­‰ã€‚è€Œçº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯ç›¸å¯¹ç®€å•ï¼Œåªéœ€è¦ä¸ºå…¶åˆ†é…çº¿ç¨‹æ ˆã€å»ºç«‹TCBï¼ˆçº¿ç¨‹æ§åˆ¶å—ï¼‰ç­‰å³å¯ã€‚ é€šä¿¡å’ŒåŒæ­¥ï¼šè¿›ç¨‹ä¹‹é—´é€šè¿‡IPCï¼ˆç®¡é“ã€å¥—æ¥å­—ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼‰è¿›è¡Œé€šä¿¡å’Œæ•°æ®å…±äº«ï¼Œè€Œçº¿ç¨‹ä¹‹é—´å¯ä»¥ç›´æ¥è®¿é—®åŒä¸€è¿›ç¨‹çš„å…±äº«æ•°æ®åŒºï¼Œä¹Ÿå¯ä»¥é€šè¿‡é”æœºåˆ¶å®ç°åŒæ­¥ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼Œè¿›ç¨‹å’Œçº¿ç¨‹åœ¨èµ„æºå ç”¨ã€è°ƒåº¦å’Œåˆ‡æ¢ã€åˆ›å»ºå’Œé”€æ¯ã€é€šä¿¡å’ŒåŒæ­¥ç­‰æ–¹é¢æœ‰ç€ä¸åŒçš„ç‰¹ç‚¹ï¼Œå¼€å‘è€…åœ¨å®é™…ç¼–ç¨‹æ—¶éœ€è¦æ ¹æ®å…·ä½“çš„æƒ…å†µé€‰æ‹©ä½¿ç”¨è¿›ç¨‹è¿˜æ˜¯çº¿ç¨‹æ¥å®Œæˆä»»åŠ¡ã€‚ ","date":"2023-07-13","objectID":"/posts/os_1/:1:1","tags":["OS"],"title":"è®¡ç®—æœºæ“ä½œç³»ç»Ÿ","uri":"/posts/os_1/"},{"categories":["OS"],"content":"1.2 åç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ åç¨‹å’Œçº¿ç¨‹éƒ½æ˜¯ç”¨äºå®ç°å¤šä»»åŠ¡çš„æŠ€æœ¯ï¼Œä½†æ˜¯å®ƒä»¬çš„å®ç°æ–¹å¼æœ‰æ‰€ä¸åŒï¼Œå…·ä½“åŒºåˆ«å¦‚ä¸‹ï¼š è°ƒåº¦æ–¹å¼ä¸åŒï¼šçº¿ç¨‹ç”±æ“ä½œç³»ç»Ÿå†…æ ¸è¿›è¡Œè°ƒåº¦ï¼Œè€Œåç¨‹åˆ™æ˜¯åœ¨ç”¨æˆ·ç©ºé—´ä¸­è¿›è¡Œè°ƒåº¦ï¼Œä¸éœ€è¦åˆ‡æ¢åˆ°å†…æ ¸æ€ã€‚ å¹¶å‘æ€§ä¸åŒï¼šçº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦çš„æœ€å°å•ä½ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼›åç¨‹åˆ™æ˜¯åœ¨å•çº¿ç¨‹å†…éƒ¨é€šè¿‡åä½œå¼è°ƒåº¦å®ç°å¹¶å‘ã€‚ å†…å­˜ä½¿ç”¨ä¸åŒï¼šçº¿ç¨‹æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸åˆ›å»ºçš„ï¼Œéœ€è¦å ç”¨ä¸€å®šçš„ç³»ç»Ÿèµ„æºï¼Œè€Œåç¨‹åˆ™æ˜¯ç”±ç”¨æˆ·ç¨‹åºåˆ›å»ºï¼Œä¸éœ€è¦å ç”¨é¢å¤–çš„ç³»ç»Ÿèµ„æºã€‚ ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ä¸åŒï¼šçº¿ç¨‹åœ¨åˆ‡æ¢æ—¶éœ€è¦ä¿å­˜å’Œæ¢å¤æ‰€æœ‰çš„å¯„å­˜å™¨çŠ¶æ€å’Œå†…æ ¸å †æ ˆï¼Œè€Œåç¨‹åªéœ€è¦ä¿å­˜å’Œæ¢å¤å°‘é‡çš„å¯„å­˜å™¨çŠ¶æ€ï¼Œå¼€é”€è¾ƒå°ã€‚ ç¼–ç¨‹éš¾åº¦ä¸åŒï¼šçº¿ç¨‹çš„ç¼–ç¨‹éš¾åº¦ç›¸å¯¹è¾ƒå¤§ï¼Œå› ä¸ºå¤šçº¿ç¨‹ä¹‹é—´éœ€è¦å…±äº«èµ„æºå¹¶è¿›è¡ŒåŒæ­¥ï¼Œè€Œåç¨‹åˆ™æ˜¯åœ¨å•çº¿ç¨‹å†…éƒ¨è°ƒåº¦ï¼Œå› æ­¤ç¼–ç¨‹éš¾åº¦ç›¸å¯¹è¾ƒå°ã€‚ æ€»ä¹‹ï¼Œçº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸çš„è°ƒåº¦å¯¹è±¡ï¼Œå…·æœ‰ç‹¬ç«‹çš„ç³»ç»Ÿèµ„æºï¼Œå¯ä»¥å¹¶è¡Œæ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼›è€Œåç¨‹æ˜¯ç”¨æˆ·ç¨‹åºçš„è°ƒåº¦å¯¹è±¡ï¼Œä¸éœ€è¦å ç”¨é¢å¤–çš„ç³»ç»Ÿèµ„æºï¼Œé€šè¿‡åä½œå¼è°ƒåº¦å®ç°ä»»åŠ¡ä¹‹é—´çš„åˆ‡æ¢ã€‚ ","date":"2023-07-13","objectID":"/posts/os_1/:1:2","tags":["OS"],"title":"è®¡ç®—æœºæ“ä½œç³»ç»Ÿ","uri":"/posts/os_1/"},{"categories":["OS"],"content":"1.3ã€å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«ï¼Ÿ å¹¶å‘å’Œå¹¶è¡Œéƒ½æ˜¯æŒ‡åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡çš„æ–¹å¼ï¼Œä½†æ˜¯å®ƒä»¬æœ‰ä¸åŒçš„å«ä¹‰ã€‚ å¹¶å‘æ˜¯æŒ‡ä¸€ä¸ªå¤„ç†å™¨åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡é€šå¸¸æ˜¯é€šè¿‡åœ¨ä¸åŒçš„æ—¶é—´é—´éš”å†…äº¤æ›¿è¿›è¡Œçš„ï¼Œè¿™æ ·åœ¨åŒä¸€æ—¶åˆ»å¯ä»¥çœ‹åˆ°æœ‰å¤šä¸ªä»»åŠ¡åœ¨è¿è¡Œã€‚è¿™äº›ä»»åŠ¡å¯ä»¥æ˜¯åœ¨åŒä¸€ä¸ªç¨‹åºå†…çš„ä¸åŒçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨ä¸åŒç¨‹åºä¹‹é—´çš„äº¤äº’ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚ å¹¶è¡Œæ˜¯æŒ‡ä½¿ç”¨å¤šä¸ªå¤„ç†å™¨åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡åœ¨åŒä¸€æ—¶åˆ»å¯ä»¥çœ‹åˆ°æœ‰å¤šä¸ªä»»åŠ¡åœ¨åŒæ—¶è¿è¡Œã€‚ä¸å¹¶å‘ä¸åŒçš„æ˜¯ï¼Œå¹¶è¡Œéœ€è¦å¤šä¸ªå¤„ç†å™¨æˆ–å¤šä¸ªè®¡ç®—æ ¸å¿ƒï¼Œè€Œå¹¶å‘åˆ™å¯ä»¥åœ¨å•ä¸ªå¤„ç†å™¨ä¸Šæ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚ ç®€å•æ¥è¯´ï¼Œå¹¶å‘æ˜¯åœ¨ä¸€ä¸ªå¤„ç†å™¨ä¸ŠåŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè€Œå¹¶è¡Œæ˜¯åœ¨å¤šä¸ªå¤„ç†å™¨æˆ–è®¡ç®—æ ¸å¿ƒä¸ŠåŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚ ","date":"2023-07-13","objectID":"/posts/os_1/:1:3","tags":["OS"],"title":"è®¡ç®—æœºæ“ä½œç³»ç»Ÿ","uri":"/posts/os_1/"},{"categories":["OS"],"content":"1.4 è¿›ç¨‹ä¸çº¿ç¨‹çš„åˆ‡æ¢æµç¨‹ï¼Ÿ è¿›ç¨‹ä¸çº¿ç¨‹çš„åˆ‡æ¢æµç¨‹å¦‚ä¸‹ï¼š å½“å‰è¿›ç¨‹æˆ–çº¿ç¨‹æ‰§è¡Œåˆ°é˜»å¡çŠ¶æ€ï¼ˆå¦‚ç­‰å¾…I/Oå®Œæˆï¼‰æ—¶ï¼Œè§¦å‘åˆ‡æ¢æ“ä½œã€‚ æ“ä½œç³»ç»Ÿå†…æ ¸ä¿å­˜å½“å‰è¿›ç¨‹æˆ–çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ï¼ˆå³å½“å‰çš„å¯„å­˜å™¨å€¼å’Œç¨‹åºè®¡æ•°å™¨ç­‰ä¿¡æ¯ï¼‰ï¼Œå¹¶å°†å¤„ç†å™¨åˆ†é…ç»™å¦ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ã€‚ å†…æ ¸ä»è°ƒåº¦é˜Ÿåˆ—ä¸­é€‰æ‹©å¦ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œå¹¶æ¢å¤å…¶ä¿å­˜çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ å¤„ç†å™¨å¼€å§‹æ‰§è¡Œæ–°çš„è¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œä»ä¹‹å‰ä¿å­˜çš„çŠ¶æ€æ¢å¤æ‰§è¡Œã€‚ åœ¨è¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œéœ€è¦å°†æ•´ä¸ªè¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ä¿å­˜ä¸‹æ¥ï¼ŒåŒ…æ‹¬è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ã€å…¨å±€å˜é‡ç­‰ï¼Œåˆ‡æ¢æ—¶è¿˜éœ€è¦è¿›è¡Œå†…å­˜æ˜ å°„ï¼Œå¼€é”€æ¯”è¾ƒå¤§ã€‚ åœ¨çº¿ç¨‹åˆ‡æ¢æ—¶ï¼Œåªéœ€è¦ä¿å­˜å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å³å¯ï¼Œçº¿ç¨‹å…±äº«è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ï¼Œåˆ‡æ¢æ—¶ä¸éœ€è¦è¿›è¡Œå†…å­˜æ˜ å°„ï¼Œå¼€é”€è¾ƒå°ã€‚ ","date":"2023-07-13","objectID":"/posts/os_1/:1:4","tags":["OS"],"title":"è®¡ç®—æœºæ“ä½œç³»ç»Ÿ","uri":"/posts/os_1/"},{"categories":["OS"],"content":"1.5 ä¸ºä»€ä¹ˆè™šæ‹Ÿåœ°å€ç©ºé—´åˆ‡æ¢æ¯”è¾ƒè€—æ—¶ï¼Ÿ è™šæ‹Ÿåœ°å€ç©ºé—´åˆ‡æ¢çš„è€—æ—¶æ˜¯å› ä¸ºå®ƒæ¶‰åŠåˆ°äº†ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å¤æ‚æ“ä½œã€‚å½“è¿›ç¨‹æˆ–çº¿ç¨‹åˆ‡æ¢æ—¶ï¼Œéœ€è¦ä¿å­˜å½“å‰çš„ç¨‹åºçŠ¶æ€ï¼ˆå¯„å­˜å™¨å€¼ã€å †æ ˆæŒ‡é’ˆç­‰ï¼‰å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå½“å‰æŒ‡ä»¤ä½ç½®ã€ç¨‹åºè®¡æ•°å™¨ç­‰ï¼‰ã€‚ç„¶åï¼Œå†…æ ¸å¿…é¡»é€‰æ‹©å¦ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œå¹¶å°†å®ƒçš„çŠ¶æ€å’Œä¸Šä¸‹æ–‡ä¿¡æ¯è£…å…¥å†…å­˜ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ç¨‹åºèƒ½å¤Ÿç»§ç»­è¿è¡Œã€‚è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°å¤šä¸ªæ“ä½œç³»ç»Ÿçš„å†…æ ¸å’Œç¡¬ä»¶æœºåˆ¶ï¼Œä¾‹å¦‚ä¸Šä¸‹æ–‡åˆ‡æ¢ã€å†…å­˜ç®¡ç†å’Œç¡¬ä»¶ä¸­æ–­ç­‰ã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸ºäº†åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œéœ€è¦ä¿å­˜å’Œæ¢å¤å¤§é‡çš„çŠ¶æ€ä¿¡æ¯ï¼ŒåŒ…æ‹¬å†…æ ¸ä¸Šä¸‹æ–‡å’Œç¡¬ä»¶å¯„å­˜å™¨ç­‰ã€‚è¿™äº›æ“ä½œéœ€è¦è€—è´¹å¤§é‡çš„CPUæ—¶é—´å’Œå†…å­˜å¸¦å®½ï¼Œå› æ­¤åˆ‡æ¢è¿‡ç¨‹é€šå¸¸æ˜¯ç›¸å¯¹æ¯”è¾ƒè€—æ—¶çš„ã€‚ ref: [1].https://zhuanlan.zhihu.com/p/616080301 ","date":"2023-07-13","objectID":"/posts/os_1/:1:5","tags":["OS"],"title":"è®¡ç®—æœºæ“ä½œç³»ç»Ÿ","uri":"/posts/os_1/"},{"categories":["GPU"],"content":"[1] https://blog.csdn.net/Augusdi/article/details/12187291 ","date":"2023-07-12","objectID":"/posts/cuda/:0:0","tags":["CUDA"],"title":"CUDA Introduction","uri":"/posts/cuda/"},{"categories":["GPU"],"content":"CUDAç¼–ç¨‹ ","date":"2023-07-12","objectID":"/posts/cuda/:1:0","tags":["CUDA"],"title":"CUDA Introduction","uri":"/posts/cuda/"},{"categories":["GPU"],"content":"1.ä»€ä¹ˆæ˜¯CUDA CUDA(Compute Unified Device Architecture)ï¼Œç»Ÿä¸€è®¡ç®—æ¶æ„ï¼Œæ˜¯NVidiaæ¨å‡ºçš„å¹¶è¡Œè®¡ç®—å¹³å°ã€‚NVidiaå®˜æ–¹å¯¹å…¶çš„è§£é‡Šæ˜¯ï¼šä¸€ä¸ªå¹¶è¡Œè®¡ç®—å¹³å°å’Œç®€å•ï¼ˆç®€æ´ï¼‰åœ°ä½¿ç”¨å›¾åƒå¤„ç†å•å…ƒï¼ˆGPUï¼‰è¿›è¡Œé€šç”¨è®¡ç®—çš„ç¼–ç¨‹æ¨¡å‹ã€‚åˆ©ç”¨GPUçš„èƒ½åŠ›åœ¨è®¡ç®—æ€§èƒ½ä¸Šæœ‰æƒŠäººçš„æå‡ã€‚ ç®€å•åœ°è¯´CUDAæ˜¯ä¾¿äºç¨‹åºå‘˜åˆ©ç”¨NVidia GPUè¿›è¡Œé€šç”¨è®¡ç®—çš„å¼€å‘ç¯å¢ƒåŠå·¥å…·ï¼Œç›®å‰æ”¯æŒC/C++è¯­è¨€ï¼Œå°†æ¥è¿˜ä¼šæ”¯æŒFortranè¯­è¨€ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda/:1:1","tags":["CUDA"],"title":"CUDA Introduction","uri":"/posts/cuda/"},{"categories":["GPU"],"content":"2.ä¸ºä»€ä¹ˆè¦ç”¨åˆ°CUDA CPUä¸»é¢‘è¦æ¯”GPUé«˜2-3å€å·¦å³ï¼Œä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹GPUæ ¸å¿ƒçš„æ•°é‡è¦æ¯”CPUå¤š2-3ä¸ªæ•°é‡çº§ä»¥ä¸Šã€‚å› æ­¤GPUçš„è®¡ç®—èƒ½åŠ›è¦è¿œå¤§äºCPUï¼Œå……åˆ†å‘æŒ¥GPUçš„è®¡ç®—èƒ½åŠ›ï¼Œå¯ä»¥æœ‰æˆå€çš„æ€§èƒ½æå‡ã€‚ æ—©æœŸåˆ©ç”¨GPUçš„è®¡ç®—èƒ½åŠ›æ˜¯ä½¿ç”¨ç€è‰²å™¨å’Œç€è‰²è¯­è¨€ï¼ˆGLSLç­‰ï¼‰ã€‚ç›®å‰å¹¿æ³›ä½¿ç”¨çš„æ˜¯CUDAå’ŒOpenCLã€‚CUDAæ˜¯é’ˆå¯¹NVidia GPUç¡¬ä»¶è®¾å¤‡è®¾è®¡çš„ï¼Œè€Œ OpenCLæ˜¯é’ˆå¯¹è·¨å¹³å°è®¾è®¡çš„ã€‚å› æ­¤CUDAå¯å……åˆ†å‘æŒ¥NVidia GPUçš„è®¡ç®—æ€§èƒ½ã€‚ CUDAå¯ä»¥ç›´æ¥ä½¿ç”¨C/C++è¯­è¨€æ¥å¼€å‘GPUç¨‹åºï¼Œçœå»äº†ç¨‹åºå‘˜é‡æ–°å­¦ä¸€ç§æ–°è¯­è¨€çš„éº»çƒ¦ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda/:1:2","tags":["CUDA"],"title":"CUDA Introduction","uri":"/posts/cuda/"},{"categories":["GPU"],"content":"3.CUDAç¯å¢ƒæ­å»º CUDAç¯å¢ƒä¸»è¦åˆ†ä¸ºå››ç‚¹ï¼šç¡¬ä»¶ï¼ˆGPUè®¾å¤‡ï¼‰ã€æ“ä½œç³»ç»Ÿã€C/C++ç¼–è¯‘å™¨å’ŒCUDAå·¥å…·åŒ…ã€‚ ç¡¬ä»¶ï¼ˆGPUè®¾å¤‡ï¼‰ï¼Œå¿…é¡»æ˜¯æ”¯æŒCUDAçš„GPUã€‚å¯åˆ°NVidiaå®˜ç½‘æŸ¥è¯¢æ”¯æŒCUDAçš„GPUè®¾å¤‡ï¼Œå…·ä½“åœ°å€ä¸ºï¼šhttp://www.nvidia.com/object/cuda_home_new.html ã€‚ æ“ä½œç³»ç»Ÿï¼Œæ”¯æŒMicrosoft Windowsã€Mac OS Xå’ŒLinuxã€‚ C/C++ç¼–è¯‘å™¨ï¼Œå¯¹ä¸åŒçš„æ“ä½œç³»ç»Ÿæœ‰ä¸åŒçš„è¦æ±‚ã€‚ CUDAå·¥å…·åŒ…ï¼ŒNVidiaæä¾›äº†ä¸åŒæ“ä½œç³»ç»Ÿå¯¹åº”çš„CUDA Toolkitï¼Œå¯ä»https://developer.nvidia.com/cuda-downloads ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬ã€‚ æœ¬æ–‡åªä»¥Microsoft Windowsä¸ºä¾‹ä»‹ç»å¦‚ä½•æ­å»ºCUDAç¯å¢ƒã€‚ å‡†å¤‡ææ–™ï¼š Â·ä¸€å°è£…æœ‰æ”¯æŒCUDA GPUçš„ç”µè„‘ã€‚ Â·Microsoft Windowsæ“ä½œç³»ç»Ÿï¼ˆMicrosoft Windows XP,Vista,7,or 8 or Windows Server 2003 or 2008ï¼‰ã€‚ Â·CUDAå·¥å…·åŒ…ï¼ˆç›¸åº”æ“ä½œç³»ç»Ÿï¼‰ã€‚ä¸‹è½½åœ°å€ï¼šhttps://developer.nvidia.com/cuda-downloads Â·C/C++ç¼–è¯‘å™¨ï¼šMicrosoft Visual Studio 2008 æˆ– 2010ï¼Œæˆ–è€…å¯¹åº”ç‰ˆæœ¬çš„Microsoft Visual C++ Expressäº§å“ã€‚ å®‰è£…æ­¥éª¤ï¼š Â·åœ¨è£…æœ‰æ”¯æŒCUDA GPUçš„ç”µè„‘ä¸Šå®‰è£…Microsoft Windowsæ“ä½œç³»ç»Ÿï¼ˆä¸€èˆ¬æƒ…å†µä¸‹éƒ½å·²ç»å®Œæˆè¿™æ­¥éª¤ï¼‰ã€‚ Â·å®‰è£…C/C++ç¼–è¯‘å™¨ï¼Œå¯åªå®‰è£…å…¶ä¸­çš„C++ç¼–è¯‘å™¨éƒ¨åˆ†ã€‚ Â·å®‰è£…CUDAå·¥å…·åŒ…ã€‚ï¼ˆCUDAå·¥å…·åŒ…ä¸­æœ‰NVidia GPUçš„é©±åŠ¨ç¨‹åºï¼Œå°šæœªå®‰è£…çš„è¯·é€‰æ‹©å®‰è£…ã€‚ï¼‰ å®‰è£…éªŒè¯ï¼š Windows XPç³»ç»Ÿï¼šè¿›å…¥ C:\\Documents and Settings\\All Users\\Application Data\\NVIDIA Corporation\\CUDA Samples\\v5.0\\bin\\win32\\Release ç›®å½•è¿è¡ŒdeviceQuery.exeæ–‡ä»¶ã€‚ Windows Vista, Windows 7, Windows 8, Windows Server 2003, and Windows Server 2008ç³»ç»Ÿï¼šè¿›å…¥ C:\\ProgramData\\NVIDIA Corporation\\CUDA Samples\\v5.0\\bin\\win32\\Release ç›®å½•è¿è¡ŒdeviceQuery.exeæ–‡ä»¶ã€‚ å¦‚æœå®‰è£…æ­£ç¡®ï¼Œæ‰§è¡ŒdeviceQuery.exeæ–‡ä»¶ä¼šå¾—åˆ°GPUè®¾å¤‡çš„ç›¸åº”ä¿¡æ¯ã€‚å¦‚æœæ²¡æœ‰å®‰è£…æ”¯æŒCUDAçš„GPUä¹Ÿä¼šå¾—å‡ºGPUçš„ä¿¡æ¯ï¼Œå…¶ä¸­CUDA Capability Major/Minor version numberä¿¡æ¯ä¸º9999.9999ã€‚ Microsoft Windowsä¸Šæ›´è¯¦ç»†çš„å®‰è£…ä¿¡æ¯è¯·æŸ¥çœ‹ï¼šhttp://docs.nvidia.com/cuda/cuda-getting-started-guide-for-microsoft-windows/index.html ã€‚ Mac OS Xçš„å®‰è£…ï¼šhttp://docs.nvidia.com/cuda/cuda-getting-started-guide-for-mac-os-x/index.html ã€‚ Linuxçš„å®‰è£…ï¼šhttp://docs.nvidia.com/cuda/cuda-getting-started-guide-for-linux/index.html ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda/:1:3","tags":["CUDA"],"title":"CUDA Introduction","uri":"/posts/cuda/"},{"categories":["GPU"],"content":"4.ç¬¬ä¸€ä¸ªCUDAç¨‹åº åœ¨Microsoft Windowsç³»ç»Ÿä¸Šï¼Œå¦‚æœæˆåŠŸæ­å»ºäº†CUDAç¯å¢ƒï¼Œåˆ™åœ¨Microsoft Visual Studioä¸­å·²ç»é›†æˆäº†CUDAçš„å¼€å‘ç»„ä»¶ã€‚ ä»¥ä¸‹ä»¥Windows 7 + Microsoft Visual Studio 2008ä¸ºä¾‹ï¼Œåˆ›å»ºç¬¬ä¸€ä¸ªCUDAç¨‹åºã€‚ æ‰“å¼€Microsoft Visual Studio 2008ï¼Œä¾æ¬¡ï¼šFile-\u003eNew-\u003eProject-\u003eNVIDIA-\u003eCUDA-\u003eCUDA 5.0 Runtimeï¼Œè¾“å…¥ç›¸åº”çš„é¡¹ç›®åç§°ç¡®å®šå³å¯ã€‚ é»˜è®¤ä¼šç”Ÿæˆä¸€ä¸ªkernel.cuæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š #include \"cuda_runtime.h\" #include \"device_launch_parameters.h\" #include \u003cstdio.h\u003e void addWithCuda(int *c, const int *a, const int *b, size_t size); __global__ void addKernel(int *c, const int *a, const int *b) { int i = threadIdx.x; c[i] = a[i] + b[i]; } int main() { const int arraySize = 5; const int a[arraySize] = { 1, 2, 3, 4, 5 }; const int b[arraySize] = { 10, 20, 30, 40, 50 }; int c[arraySize] = { 0 }; // Add vectors in parallel. addWithCuda(c, a, b, arraySize); printf(\"{1,2,3,4,5} + {10,20,30,40,50} = {%d,%d,%d,%d,%d}\\n\", c[0], c[1], c[2], c[3], c[4]); // cudaThreadExit must be called before exiting in order for profiling and // tracing tools such as Nsight and Visual Profiler to show complete traces. cudaThreadExit(); return 0; } // Helper function for using CUDA to add vectors in parallel. void addWithCuda(int *c, const int *a, const int *b, size_t size) { int *dev_a = 0; int *dev_b = 0; int *dev_c = 0; // Choose which GPU to run on, change this on a multi-GPU system. cudaSetDevice(0); // Allocate GPU buffers for three vectors (two input, one output) . cudaMalloc((void**)\u0026dev_c, size * sizeof(int)); cudaMalloc((void**)\u0026dev_a, size * sizeof(int)); cudaMalloc((void**)\u0026dev_b, size * sizeof(int)); // Copy input vectors from host memory to GPU buffers. cudaMemcpy(dev_a, a, size * sizeof(int), cudaMemcpyHostToDevice); cudaMemcpy(dev_b, b, size * sizeof(int), cudaMemcpyHostToDevice); // Launch a kernel on the GPU with one thread for each element. addKernel\u003c\u003c\u003c1, size\u003e\u003e\u003e(dev_c, dev_a, dev_b); // cudaThreadSynchronize waits for the kernel to finish, and returns // any errors encountered during the launch. cudaThreadSynchronize(); // Copy output vector from GPU buffer to host memory. cudaMemcpy(c, dev_c, size * sizeof(int), cudaMemcpyDeviceToHost); cudaFree(dev_c); cudaFree(dev_a); cudaFree(dev_b); } ä»£ç 1 è¿™æ˜¯ä¸€ä¸ªå°†ä¸¤ä¸ªä¸€ç»´æ•°ç»„ç›¸åŠ çš„ä¾‹å­ã€‚ å…¶ä¸­addKernelæ˜¯å†…æ ¸å‡½æ•°ï¼Œå®ƒçš„è®¡ç®—è¿‡ç¨‹æ˜¯åœ¨GPUä¸Šå®ç°çš„ï¼Œç”¨å‡½æ•°ç±»å‹é™å®šç¬¦__global__é™åˆ¶ï¼Œä¸”å‡½æ•°ç±»å‹ä¸ºvoidå‹ã€‚ cuda_runtime.hå¤´æ–‡ä»¶åŒ…æ‹¬äº†è¿è¡Œæ—¶APIå’Œå…¶å‚æ•°çš„å®šä¹‰ã€‚ï¼ˆå¦‚æœä½¿ç”¨é©±åŠ¨APIåˆ™ä½¿ç”¨cuda.hå¤´æ–‡ä»¶ï¼‰ã€‚ device_launch_parameters.hå¤´æ–‡ä»¶åŒ…å«äº†å†…æ ¸å‡½æ•°çš„5ä¸ªå˜é‡threadIdxã€blockDimã€blockIdxã€gridDimå’ŒwrapSizeã€‚ å¯¹å…¶ä¸­CUDAè¿è¡Œæ—¶APIå‡½æ•°çš„è§£é‡Šï¼š cudaSetDevice()ï¼šé€‰æ‹©è®¾å¤‡ï¼ˆGPUï¼‰ã€‚ï¼ˆå¯ä»¥ä¸ä½¿ç”¨ï¼Œä¸ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤é€‰æ‹©è®¾å¤‡0ï¼‰ cudaMalloc()ï¼šåŠ¨æ€åˆ†é…æ˜¾å­˜ã€‚ cudaMemcpy()ï¼šè®¾å¤‡ä¸ä¸»æœºä¹‹å†…çš„æ•°æ®æ‹·è´ã€‚ cudaThreadSynchronize()ï¼šåŒæ­¥æ‰€æœ‰è®¾å¤‡ä¸Šçš„çº¿ç¨‹ï¼Œç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸã€‚ cudaFree():é‡Šæ”¾ç”±cudaMallocåˆ†é…çš„æ˜¾å­˜ã€‚ cudaThreadExit():ç»“æŸCUDAä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œé‡Šæ”¾å…¶ä¸­çš„èµ„æºã€‚ è¿™äº›å‡½æ•°çš„å…·ä½“ä»‹ç»åœ¨ http://docs.nvidia.com/cuda/cuda-runtime-api/index.html ä¸­ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda/:1:4","tags":["CUDA"],"title":"CUDA Introduction","uri":"/posts/cuda/"},{"categories":["GPU"],"content":"5. CUDAç¼–ç¨‹ 5.1. åŸºæœ¬æ¦‚å¿µ CUDAç¼–ç¨‹ä¸­éœ€è¦æ³¨æ„ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œåˆ†åˆ«ä¸ºï¼šä¸»æœº(host)ã€è®¾å¤‡(device)ã€è¿è¡Œæ—¶APIã€é©±åŠ¨APIã€warpã€bankã€å‡½æ•°ç±»å‹é™å®šç¬¦ã€å˜é‡ç±»å‹é™å®šç¬¦ã€threadã€blockã€gridã€è®¡ç®—èƒ½åŠ›ã€SIMTã€å†…ç½®å˜é‡ã€çº¹ç†ã€CUDAæ•°ç»„ç­‰ã€‚ ä¸»æœº(host)ï¼šå¯ç†è§£ä¸ºCPUä¸å†…å­˜çš„ç»„åˆã€‚ è®¾å¤‡(device)ï¼šå¯ç†è§£ä¸ºGPUä¸æ˜¾å­˜çš„ç»„åˆã€‚ è¿è¡Œæ—¶APIï¼šæ˜¯æŒ‡CUDAè¿è¡Œæ—¶APIæ˜¯åœ¨é©±åŠ¨APIçš„åŸºç¡€ä¸Šå°è£…è€Œæˆçš„ï¼Œç®€åŒ–äº†CUDAçš„å¼€å‘ã€‚ é©±åŠ¨APIï¼šæ˜¯æŒ‡CUDAé©±åŠ¨APIï¼Œç›¸æ¯”è¿è¡Œæ—¶APIæ›´æ¥è¿‘äºè®¾å¤‡ï¼Œå¯çµæ´»è¿ç”¨è®¾å¤‡çš„ç‰¹æ€§å¼€å‘CUDAï¼Œå¯å®ç°è¿è¡Œæ—¶APIæ— æ³•å®ç°çš„åŠŸèƒ½ã€‚ warpï¼šå¤šå¤„ç†å™¨æ¿€æ´»ã€ç®¡ç†ã€è°ƒåº¦å’Œæ‰§è¡Œå¹¶è¡Œä»»åŠ¡çš„å•ä½ã€‚è®¡ç®—èƒ½åŠ›2.xçš„è®¾å¤‡warpä¸º32ä¸ªçº¿ç¨‹ã€‚æœªæ¥çš„è®¾å¤‡å¯èƒ½ä¸åŒï¼Œå¯ä»¥é€šè¿‡å†…ç½®å˜é‡warpSizeæŸ¥è¯¢ã€‚ bankï¼šä¸ºäº†è·å¾—è¾ƒé«˜çš„å­˜å‚¨å™¨å¸¦å®½ï¼Œå…±äº«å­˜å‚¨å™¨è¢«åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„å­˜å‚¨å™¨æ¨¡å—ï¼Œç§°ä¸ºå­˜å‚¨ä½“ï¼Œè¿™äº›å­˜å‚¨ä½“å°±å«bankï¼Œå¯åŒæ­¥è®¿é—®ã€‚ å‡½æ•°ç±»å‹é™å®šç¬¦ï¼šæ˜¯CUDA Cä¸­ç‰¹æœ‰çš„ï¼Œç”¨æ¥ä¿®é¥°æ˜¯ä¸»æœºå‡½æ•°ï¼Œè®¾å¤‡è°ƒç”¨çš„è®¾å¤‡å‡½æ•°ï¼Œè¿˜æ˜¯ä¸»æœºè°ƒç”¨çš„è®¾å¤‡å‡½æ•°ã€‚æœ‰__device__ã€globalã€hostã€‚ å˜é‡ç±»å‹é™å®šç¬¦ï¼šæ˜¯ç”¨æ¥ä¿®é¥°è®¾å¤‡å˜é‡çš„ã€‚æœ‰__device__ã€constantã€sharedã€‚ threadï¼šè®¾å¤‡ä¸­çš„çº¿ç¨‹ï¼Œä¸ä¸»æœºä¸­çš„çº¿ç¨‹æ˜¯åŒä¸€ä¸ªæ¦‚å¿µã€‚ blockï¼šçº¿ç¨‹å—ï¼Œç”±ä¸€ç»„çº¿ç¨‹ç»„æˆã€‚ä¸€ä¸ªçº¿ç¨‹å—ä¸­çš„æ‰€ä»¥çº¿ç¨‹ä¼šåœ¨åŒä¸€ä¸ªå¤šå¤„ç†å™¨ä¸Šæ‰§è¡Œï¼Œä¸€ä¸ªå¤šå¤„ç†å™¨ä¸Šå¯åŒæ—¶æ‰§è¡Œå¤šä¸ªçº¿ç¨‹å—ã€‚ gridï¼šæœ‰æ‰€æœ‰çº¿ç¨‹å—ç»„æˆçš„ç½‘æ ¼ã€‚ è®¡ç®—èƒ½åŠ›ï¼šæ˜¯NVidia GPUä¸åŒæ¶æ„çš„è®¡ç®—èƒ½åŠ›ã€‚ SIMTï¼šå•æŒ‡ä»¤å¤šçº¿ç¨‹ï¼Œä¸å•æŒ‡ä»¤å¤šæ•°æ®ï¼ˆSIMDï¼‰ç±»ä¼¼ã€‚ä¸€æ¡æŒ‡ä»¤å¤šä¸ªçº¿ç¨‹ä¸€åŒæ‰§è¡Œï¼Œå®ç°ç¨‹åºçš„å¹¶è¡ŒåŒ–ã€‚ å†…ç½®å˜é‡ï¼šæœ‰threadIdxã€blockDimã€blockIdxã€gridDimã€warpSizeã€‚å…¶ä¸­threadIdxæŒ‡æ­¤çº¿ç¨‹åœ¨çº¿ç¨‹å—ä¸­çš„ä½ç½®ï¼›blockDimæŒ‡çº¿ç¨‹å—ç»´åº¦ï¼›blockIdxæŒ‡è¯¥çº¿ç¨‹å—åœ¨ç½‘æ ¼ä¸­çš„ä½ç½®ï¼›gridDimæŒ‡çº¿ç¨‹å—ç½‘æ ¼ç»´åº¦ï¼›warpSizeæŒ‡ä¸€ä¸ªwarpå¤šå°‘ä¸ªçº¿ç¨‹ã€‚ çº¹ç†ï¼šæœ¬æ–‡ä¸»è¦æ¶‰åŠåˆ°çš„æ˜¯çº¹ç†å‚è€ƒã€çº¹ç†ç»‘å®šã€çº¹ç†è·å–ã€‚ CUDAæ•°ç»„ï¼šåŒºåˆ«äºçº¿æ€§å­˜å‚¨å™¨ï¼Œå¯¹æ•°æ®è¿›è¡Œäº†å¯¹é½ç­‰çš„å¤„ç†ï¼ŒåŒ…æ‹¬ä¸€ç»´ã€äºŒç»´å’Œä¸‰ç»´ã€‚å…¶ä¸­çš„æ•°æ®ä¸ºï¼šä¸€å…ƒã€äºŒå…ƒæˆ–å››å…ƒç»„ã€‚ CUDAç¼–ç¨‹æ¨¡å‹åŸºç¡€ åœ¨ç»™å‡ºCUDAçš„ç¼–ç¨‹å®ä¾‹ä¹‹å‰ï¼Œè¿™é‡Œå…ˆå¯¹CUDAç¼–ç¨‹æ¨¡å‹ä¸­çš„ä¸€äº›æ¦‚å¿µåŠåŸºç¡€çŸ¥è¯†åšä¸ªç®€å•ä»‹ç»ã€‚CUDAç¼–ç¨‹æ¨¡å‹æ˜¯ä¸€ä¸ªå¼‚æ„æ¨¡å‹ï¼Œéœ€è¦CPUå’ŒGPUååŒå·¥ä½œã€‚åœ¨CUDAä¸­ï¼Œhostå’Œdeviceæ˜¯ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œæˆ‘ä»¬ç”¨hostæŒ‡ä»£CPUåŠå…¶å†…å­˜ï¼Œè€Œç”¨deviceæŒ‡ä»£GPUåŠå…¶å†…å­˜ã€‚CUDAç¨‹åºä¸­æ—¢åŒ…å«hostç¨‹åºï¼ŒåˆåŒ…å«deviceç¨‹åºï¼Œå®ƒä»¬åˆ†åˆ«åœ¨CPUå’ŒGPUä¸Šè¿è¡Œã€‚åŒæ—¶ï¼Œhostä¸deviceä¹‹é—´å¯ä»¥è¿›è¡Œé€šä¿¡ï¼Œè¿™æ ·å®ƒä»¬ä¹‹é—´å¯ä»¥è¿›è¡Œæ•°æ®æ‹·è´ã€‚å…¸å‹çš„CUDAç¨‹åºçš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š åˆ†é…hostå†…å­˜ï¼Œå¹¶è¿›è¡Œæ•°æ®åˆå§‹åŒ–ï¼›åˆ†é…deviceå†…å­˜ï¼Œå¹¶ä»hostå°†æ•°æ®æ‹·è´åˆ°deviceä¸Šï¼›è°ƒç”¨CUDAçš„æ ¸å‡½æ•°åœ¨deviceä¸Šå®ŒæˆæŒ‡å®šçš„è¿ç®—ï¼›å°†deviceä¸Šçš„è¿ç®—ç»“æœæ‹·è´åˆ°hostä¸Šï¼›é‡Šæ”¾deviceå’Œhostä¸Šåˆ†é…çš„å†…å­˜ã€‚ ä¸Šé¢æµç¨‹ä¸­æœ€é‡è¦çš„ä¸€ä¸ªè¿‡ç¨‹æ˜¯è°ƒç”¨CUDAçš„æ ¸å‡½æ•°æ¥æ‰§è¡Œå¹¶è¡Œè®¡ç®—ï¼Œkernelæ˜¯CUDAä¸­ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œkernelæ˜¯åœ¨deviceä¸Šçº¿ç¨‹ä¸­å¹¶è¡Œæ‰§è¡Œçš„å‡½æ•°ï¼Œæ ¸å‡½æ•°ç”¨__global__ç¬¦å·å£°æ˜ï¼Œåœ¨è°ƒç”¨æ—¶éœ€è¦ç”¨Â«\u003cgrid, blockÂ»\u003eæ¥æŒ‡å®škernelè¦æ‰§è¡Œçš„çº¿ç¨‹æ•°é‡ï¼Œåœ¨CUDAä¸­ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½è¦æ‰§è¡Œæ ¸å‡½æ•°ï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹ä¼šåˆ†é…ä¸€ä¸ªå”¯ä¸€çš„çº¿ç¨‹å·thread IDï¼Œè¿™ä¸ªIDå€¼å¯ä»¥é€šè¿‡æ ¸å‡½æ•°çš„å†…ç½®å˜é‡threadIdxæ¥è·å¾—ã€‚ ç”±äºGPUå®é™…ä¸Šæ˜¯å¼‚æ„æ¨¡å‹ï¼Œæ‰€ä»¥éœ€è¦åŒºåˆ†hostå’Œdeviceä¸Šçš„ä»£ç ï¼Œåœ¨CUDAä¸­æ˜¯é€šè¿‡å‡½æ•°ç±»å‹é™å®šè¯å¼€åŒºåˆ«hostå’Œdeviceä¸Šçš„å‡½æ•°ï¼Œä¸»è¦çš„ä¸‰ä¸ªå‡½æ•°ç±»å‹é™å®šè¯å¦‚ä¸‹ï¼š __global__ï¼šåœ¨deviceä¸Šæ‰§è¡Œï¼Œä»hostä¸­è°ƒç”¨ï¼ˆä¸€äº›ç‰¹å®šçš„GPUä¹Ÿå¯ä»¥ä»deviceä¸Šè°ƒç”¨ï¼‰ï¼Œè¿”å›ç±»å‹å¿…é¡»æ˜¯voidï¼Œä¸æ”¯æŒå¯å˜å‚æ•°å‚æ•°ï¼Œä¸èƒ½æˆä¸ºç±»æˆå‘˜å‡½æ•°ã€‚æ³¨æ„ç”¨__global__å®šä¹‰çš„kernelæ˜¯å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€hostä¸ä¼šç­‰å¾…kernelæ‰§è¡Œå®Œå°±æ‰§è¡Œä¸‹ä¸€æ­¥ã€‚__device__ï¼šåœ¨deviceä¸Šæ‰§è¡Œï¼Œå•ä»…å¯ä»¥ä»deviceä¸­è°ƒç”¨ï¼Œä¸å¯ä»¥å’Œ__global__åŒæ—¶ç”¨ã€‚__host__ï¼šåœ¨hostä¸Šæ‰§è¡Œï¼Œä»…å¯ä»¥ä»hostä¸Šè°ƒç”¨ï¼Œä¸€èˆ¬çœç•¥ä¸å†™ï¼Œä¸å¯ä»¥å’Œ__global__åŒæ—¶ç”¨ï¼Œä½†å¯å’Œ__device__ï¼Œæ­¤æ—¶å‡½æ•°ä¼šåœ¨deviceå’Œhostéƒ½ç¼–è¯‘ã€‚ è¦æ·±åˆ»ç†è§£kernelï¼Œå¿…é¡»è¦å¯¹kernelçš„çº¿ç¨‹å±‚æ¬¡ç»“æ„æœ‰ä¸€ä¸ªæ¸…æ™°çš„è®¤è¯†ã€‚é¦–å…ˆGPUä¸Šå¾ˆå¤šå¹¶è¡ŒåŒ–çš„è½»é‡çº§çº¿ç¨‹ã€‚kernelåœ¨deviceä¸Šæ‰§è¡Œæ—¶å®é™…ä¸Šæ˜¯å¯åŠ¨å¾ˆå¤šçº¿ç¨‹ï¼Œä¸€ä¸ªkernelæ‰€å¯åŠ¨çš„æ‰€æœ‰çº¿ç¨‹ç§°ä¸ºä¸€ä¸ªç½‘æ ¼ï¼ˆgridï¼‰ï¼ŒåŒä¸€ä¸ªç½‘æ ¼ä¸Šçš„çº¿ç¨‹å…±äº«ç›¸åŒçš„å…¨å±€å†…å­˜ç©ºé—´ï¼Œgridæ˜¯çº¿ç¨‹ç»“æ„çš„ç¬¬ä¸€å±‚æ¬¡ï¼Œè€Œç½‘æ ¼åˆå¯ä»¥åˆ†ä¸ºå¾ˆå¤šçº¿ç¨‹å—ï¼ˆblockï¼‰ï¼Œä¸€ä¸ªçº¿ç¨‹å—é‡Œé¢åŒ…å«å¾ˆå¤šçº¿ç¨‹ï¼Œè¿™æ˜¯ç¬¬äºŒä¸ªå±‚æ¬¡ã€‚çº¿ç¨‹ä¸¤å±‚ç»„ç»‡ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªgirdå’Œblockå‡ä¸º2-dimçš„çº¿ç¨‹ç»„ç»‡ã€‚gridå’Œblockéƒ½æ˜¯å®šä¹‰ä¸ºdim3ç±»å‹çš„å˜é‡ï¼Œdim3å¯ä»¥çœ‹æˆæ˜¯åŒ…å«ä¸‰ä¸ªæ— ç¬¦å·æ•´æ•°ï¼ˆxï¼Œyï¼Œzï¼‰æˆå‘˜çš„ç»“æ„ä½“å˜é‡ï¼Œåœ¨å®šä¹‰æ—¶ï¼Œç¼ºçœå€¼åˆå§‹åŒ–ä¸º1ã€‚å› æ­¤gridå’Œblockå¯ä»¥çµæ´»åœ°å®šä¹‰ä¸º1-dimï¼Œ2-dimä»¥åŠ3-dimç»“æ„ï¼Œå¯¹äºå›¾ä¸­ç»“æ„ï¼ˆä¸»è¦æ°´å¹³æ–¹å‘ä¸ºxè½´ï¼‰ï¼Œå®šä¹‰çš„gridå’Œblockå¦‚ä¸‹æ‰€ç¤ºï¼Œkernelåœ¨è°ƒç”¨æ—¶ä¹Ÿå¿…é¡»é€šè¿‡æ‰§è¡Œé…ç½®Â«\u003cgrid, blockÂ»\u003eæ¥æŒ‡å®škernelæ‰€ä½¿ç”¨çš„çº¿ç¨‹æ•°åŠç»“æ„ã€‚ æ‰€ä»¥ï¼Œä¸€ä¸ªçº¿ç¨‹éœ€è¦ä¸¤ä¸ªå†…ç½®çš„åæ ‡å˜é‡ï¼ˆblockIdxï¼ŒthreadIdxï¼‰æ¥å”¯ä¸€æ ‡è¯†ï¼Œå®ƒä»¬éƒ½æ˜¯dim3ç±»å‹å˜é‡ï¼Œå…¶ä¸­blockIdxæŒ‡æ˜çº¿ç¨‹æ‰€åœ¨gridä¸­çš„ä½ç½®ï¼Œè€ŒthreaIdxæŒ‡æ˜çº¿ç¨‹æ‰€åœ¨blockä¸­çš„ä½ç½®ï¼Œå¦‚å›¾ä¸­çš„Thread (1,1)æ»¡è¶³ï¼š threadIdx.x = 1 threadIdx.y = 1 blockIdx.x = 1 blockIdx.y = 1 ä¸€ä¸ªçº¿ç¨‹å—ä¸Šçš„çº¿ç¨‹æ˜¯æ”¾åœ¨åŒä¸€ä¸ªæµå¼å¤šå¤„ç†å™¨ï¼ˆSM)ä¸Šçš„ï¼Œä½†æ˜¯å•ä¸ªSMçš„èµ„æºæœ‰é™ï¼Œè¿™å¯¼è‡´çº¿ç¨‹å—ä¸­çš„çº¿ç¨‹æ•°æ˜¯æœ‰é™åˆ¶çš„ï¼Œç°ä»£GPUsçš„çº¿ç¨‹å—å¯æ”¯æŒçš„çº¿ç¨‹æ•°å¯è¾¾1024ä¸ªã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬è¦çŸ¥é“ä¸€ä¸ªçº¿ç¨‹åœ¨blcokä¸­çš„å…¨å±€IDï¼Œæ­¤æ—¶å°±å¿…é¡»è¿˜è¦çŸ¥é“blockçš„ç»„ç»‡ç»“æ„ï¼Œè¿™æ˜¯é€šè¿‡çº¿ç¨‹çš„å†…ç½®å˜é‡blockDimæ¥è·å¾—ã€‚å®ƒè·å–çº¿ç¨‹å—å„ä¸ªç»´åº¦çš„å¤§å°ã€‚å¯¹äºä¸€ä¸ª2-dimçš„block ï¼Œçº¿ç¨‹ çš„IDå€¼ä¸º ï¼Œå¦‚æœæ˜¯3-dimçš„block ï¼Œçº¿ç¨‹ çš„IDå€¼ä¸º ã€‚å¦å¤–çº¿ç¨‹è¿˜æœ‰å†…ç½®å˜é‡gridDimï¼Œç”¨äºè·å¾—ç½‘æ ¼å—å„ä¸ªç»´åº¦çš„å¤§å°ã€‚ kernelçš„è¿™ç§çº¿ç¨‹ç»„ç»‡ç»“æ„å¤©ç„¶é€‚åˆvector,matrixç­‰è¿ç®—ï¼Œå¦‚æˆ‘ä»¬å°†åˆ©ç”¨ä¸Šå›¾2-dimç»“æ„å®ç°ä¸¤ä¸ªçŸ©é˜µçš„åŠ æ³•ï¼Œæ¯ä¸ªçº¿ç¨‹è´Ÿè´£å¤„ç†æ¯ä¸ªä½ç½®çš„ä¸¤ä¸ªå…ƒç´ ç›¸åŠ ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚çº¿ç¨‹å—å¤§å°ä¸º(16, 16)ï¼Œç„¶åå°†N*Nå¤§å°çš„çŸ©é˜µå‡åˆ†ä¸ºä¸åŒçš„çº¿ç¨‹å—æ¥æ‰§è¡ŒåŠ æ³•è¿ç®—ã€‚ æ­¤å¤–è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹CUDAçš„å†…å­˜æ¨¡å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„ç§æœ‰æœ¬åœ°å†…å­˜ï¼ˆLocal Memoryï¼‰ï¼Œè€Œæ¯ä¸ªçº¿ç¨‹å—æœ‰åŒ…å«å…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰,å¯ä»¥è¢«çº¿ç¨‹å—ä¸­æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹å—ä¸€è‡´ã€‚æ­¤å¤–ï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®å…¨å±€å†…å­˜ï¼ˆGlobal Memoryï¼‰ã€‚è¿˜å¯ä»¥è®¿é—®ä¸€äº›åªè¯»å†…å­˜å—ï¼šå¸¸é‡å†…å­˜ï¼ˆConstant Memoryï¼‰å’Œçº¹ç†å†…å­˜ï¼ˆTexture Memoryï¼‰ã€‚å†…å­˜ç»“æ„æ¶‰åŠåˆ°ç¨‹åºä¼˜åŒ–ï¼Œè¿™é‡Œä¸æ·±å…¥æ¢è®¨å®ƒä»¬ã€‚ è¿˜æœ‰é‡è¦ä¸€ç‚¹ï¼Œä½ éœ€è¦å¯¹GPUçš„ç¡¬ä»¶å®ç°æœ‰ä¸€ä¸ªåŸºæœ¬çš„è®¤è¯†ã€‚ä¸Šé¢è¯´åˆ°äº†kernelçš„çº¿ç¨‹ç»„ç»‡å±‚æ¬¡ï¼Œé‚£ä¹ˆä¸€ä¸ªkernelå®é™…ä¸Šä¼šå¯åŠ¨å¾ˆå¤šçº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹æ˜¯é€»è¾‘ä¸Šå¹¶è¡Œçš„ï¼Œä½†æ˜¯åœ¨ç‰©ç†å±‚å´å¹¶ä¸ä¸€å®šã€‚è¿™å…¶å®å’ŒCPUçš„å¤šçº¿ç¨‹æœ‰ç±»ä¼¼ä¹‹å¤„ï¼Œå¤šçº¿ç¨‹å¦‚æœæ²¡æœ‰å¤šæ ¸æ”¯æŒï¼Œåœ¨ç‰©ç†å±‚ä¹Ÿæ˜¯æ— æ³•å®ç°å¹¶è¡Œçš„ã€‚ä½†æ˜¯å¥½åœ¨GPUå­˜åœ¨å¾ˆå¤šCUDAæ ¸å¿ƒï¼Œå……åˆ†åˆ©ç”¨CUDAæ ¸å¿ƒå¯ä»¥å……åˆ†å‘æŒ¥GPUçš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ã€‚GPUç¡¬ä»¶çš„ä¸€ä¸ªæ ¸å¿ƒç»„ä»¶æ˜¯SMï¼Œå‰é¢å·²ç»è¯´è¿‡ï¼ŒSMæ˜¯è‹±æ–‡åæ˜¯ Streaming Multiprocessorï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯æµå¼å¤šå¤„ç†å™¨ã€‚SMçš„æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬CUDAæ ¸å¿ƒï¼Œå…±äº«å†…å­˜ï¼Œå¯„å­˜å™¨ç­‰ï¼ŒSMå¯ä»¥å¹¶å‘åœ°æ‰§è¡Œæ•°ç™¾ä¸ªçº¿ç¨‹ï¼Œå¹¶å‘èƒ½åŠ›å°±å–å†³äºSMæ‰€æ‹¥æœ‰çš„èµ„æºæ•°ã€‚å½“ä¸€ä¸ªkernelè¢«æ‰§è¡Œæ—¶ï¼Œå®ƒçš„girdä¸­çš„çº¿ç¨‹å—è¢«åˆ†é…åˆ°SMä¸Šï¼Œä¸€ä¸ªçº¿ç¨‹å—åªèƒ½åœ¨ä¸€ä¸ªSMä¸Šè¢«è°ƒåº¦ã€‚SMä¸€èˆ¬å¯ä»¥è°ƒåº¦å¤šä¸ªçº¿ç¨‹å—ï¼Œè¿™è¦çœ‹SMæœ¬èº«çš„èƒ½åŠ›ã€‚é‚£ä¹ˆæœ‰å¯èƒ½ä¸€ä¸ªkernelçš„å„ä¸ªçº¿ç¨‹å—è¢«åˆ†é…å¤šä¸ªSMï¼Œæ‰€ä»¥gridåªæ˜¯é€»è¾‘å±‚ï¼Œè€ŒSMæ‰æ˜¯æ‰§è¡Œçš„ç‰©ç†å±‚ã€‚SMé‡‡ç”¨çš„æ˜¯SIMT (Single-Instruction, Multiple-Threadï¼Œå•æŒ‡ä»¤å¤šçº¿ç¨‹)æ¶æ„ï¼ŒåŸºæœ¬çš„æ‰§è¡Œå•å…ƒæ˜¯çº¿ç¨‹æŸï¼ˆwarps)ï¼Œçº¿ç¨‹æŸåŒ…å«32ä¸ªçº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹åŒæ—¶æ‰§è¡Œç›¸åŒçš„æŒ‡ä»¤ï¼Œä½†æ˜¯æ¯ä¸ªçº¿ç¨‹éƒ½åŒ…å«è‡ªå·±çš„æŒ‡ä»¤åœ°å€è®¡æ•°å™¨å’Œå¯„å­˜å™¨çŠ¶æ€ï¼Œä¹Ÿæœ‰è‡ªå·±ç‹¬ç«‹çš„æ‰§è¡Œè·¯å¾„ã€‚æ‰€ä»¥å°½ç®¡çº¿ç¨‹æŸä¸­çš„çº¿ç¨‹åŒæ—¶ä»åŒä¸€ç¨‹åºåœ°å€æ‰§è¡Œï¼Œä½†æ˜¯å¯èƒ½å…·æœ‰ä¸åŒçš„è¡Œä¸ºï¼Œæ¯”å¦‚é‡åˆ°äº†åˆ†æ”¯ç»“æ„ï¼Œä¸€äº›çº¿ç¨‹å¯èƒ½è¿›å…¥è¿™ä¸ªåˆ†æ”¯ï¼Œä½†æ˜¯å¦å¤–ä¸€äº›æœ‰å¯èƒ½ä¸æ‰§è¡Œï¼Œå®ƒä»¬åªèƒ½æ­»ç­‰ï¼Œå› ä¸ºGPUè§„å®šçº¿ç¨‹æŸä¸­æ‰€æœ‰çº¿ç¨‹åœ¨åŒä¸€å‘¨æœŸæ‰§è¡Œç›¸åŒçš„æŒ‡ä»¤ï¼Œçº¿ç¨‹æŸåˆ†åŒ–ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚å½“çº¿ç¨‹å—è¢«åˆ’åˆ†åˆ°æŸä¸ªSMä¸Šæ—¶ï¼Œå®ƒå°†è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºå¤šä¸ªçº¿ç¨‹æŸï¼Œå› ä¸ºè¿™æ‰æ˜¯SMçš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œä½†æ˜¯ä¸€ä¸ªSMåŒæ—¶å¹¶å‘çš„çº¿ç¨‹æŸæ•°æ˜¯æœ‰é™çš„ã€‚è¿™æ˜¯å› ä¸ºèµ„æºé™åˆ¶ï¼ŒSMè¦ä¸ºæ¯ä¸ªçº¿ç¨‹å—åˆ†é…å…±äº«å†…å­˜ï¼Œè€Œä¹Ÿè¦ä¸ºæ¯ä¸ªçº¿ç¨‹æŸä¸­çš„çº¿ç¨‹åˆ†é…ç‹¬ç«‹çš„å¯„å­˜å™¨ã€‚","date":"2023-07-12","objectID":"/posts/cuda/:1:5","tags":["CUDA"],"title":"CUDA Introduction","uri":"/posts/cuda/"},{"categories":["GPU"],"content":"5.3. å­˜å‚¨å™¨å±‚æ¬¡ç»“æ„ CUDAå­˜å‚¨å™¨æœ‰ï¼šå¯„å­˜å™¨(register)ã€å…±äº«å­˜å‚¨å™¨(shared memory)ã€å¸¸é‡å­˜å‚¨å™¨(constant memory)ã€æœ¬åœ°å­˜å‚¨å™¨(local memory)ã€å…¨å±€å­˜å‚¨å™¨(global memory)ã€çº¹ç†å­˜å‚¨å™¨ç­‰ã€‚å…¶ä¸­å¯„å­˜å™¨å’Œæœ¬åœ°å­˜å‚¨å™¨æ˜¯çº¿ç¨‹(thread)ç§æœ‰çš„ï¼Œå…±äº«å­˜å‚¨å™¨æ˜¯å¯¹çº¿ç¨‹å—(block)ä¸­çš„æ‰€æœ‰çº¿ç¨‹å¯è§ï¼Œå¸¸é‡å­˜å‚¨å™¨ã€å…¨å±€å­˜å‚¨å™¨å’Œçº¹ç†å­˜å‚¨å™¨æ˜¯å¯¹ç½‘æ ¼(grid)ä¸­æ‰€æœ‰çº¿ç¨‹å¯è§ã€‚ ä¸‹å›¾è§£é‡Šäº†å­˜å‚¨å™¨çš„å±‚æ¬¡ç»“æ„ï¼š 5.4. è¿è¡Œæ—¶API è¿ç”¨è¿è¡Œæ—¶APIå¼€å‘CUDAç¨‹åºéœ€è¦äº†è§£ï¼šåˆå§‹åŒ–ã€è®¾å¤‡ç®¡ç†ã€å­˜å‚¨å™¨ç®¡ç†ã€æµç®¡ç†ã€äº‹ä»¶ç®¡ç†ã€çº¹ç†å‚è€ƒç®¡ç†ã€OpenGLäº’æ“ä½œå’ŒDirect3Däº’æ“ä½œã€‚ è¿è¡Œæ—¶APIæ–‡æ¡£åœ°å€ä¸ºï¼šhttp://docs.nvidia.com/cuda/cuda-runtime-api/index.html ã€‚ 5.4.1. åˆå§‹åŒ– è¿è¡Œæ—¶APIä¸å­˜åœ¨æ˜¾ç¤ºåˆå§‹åŒ–å‡½æ•°ï¼Œåˆå§‹åŒ–ä¼šåœ¨é¦–æ¬¡è°ƒç”¨è¿è¡Œæ—¶å‡½æ•°æ—¶å®Œæˆã€‚è™½ç„¶ä¸éœ€è¦è°ƒç”¨åˆå§‹åŒ–å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œä½†æ˜¯é€€å‡ºæ—¶éœ€è¦è°ƒç”¨é€€å‡ºå‡½æ•°cudaThreadExit()é‡Šæ”¾èµ„æºã€‚ 5.4.2. è®¾å¤‡ç®¡ç† æœ‰äº›ç”µè„‘ä¸Šå¯èƒ½æœ‰å¤šå—è®¾å¤‡ï¼Œå› æ­¤å¯¹äºä¸åŒçš„è¦æ±‚é€‰æ‹©åˆé€‚çš„è®¾å¤‡ã€‚è®¾å¤‡ç®¡ç†ä¸»è¦æ˜¯è·å–è®¾å¤‡ä¿¡æ¯å’Œé€‰æ‹©æ‰§è¡Œè®¾å¤‡ã€‚ ä¸»è¦æœ‰ä¸‰ä¸ªå‡½æ•°ï¼š Â·cudaGetDeviceCount()ï¼šå¾—åˆ°ç”µè„‘ä¸Šè®¾å¤‡çš„ä¸ªæ•°ã€‚ Â·cudaGetDeviceProperties()ï¼šè·å¾—å¯¹åº”è®¾å¤‡çš„ä¿¡æ¯ã€‚ Â·cudaSetDevice()ï¼šè®¾ç½®CUDAä¸Šä¸‹æ–‡å¯¹åº”çš„è®¾å¤‡ã€‚ è¿è¡Œ__global__å‡½æ•°å‰éœ€è¦æå‰é€‰æ‹©è®¾å¤‡ï¼Œå¦‚æœä¸è°ƒç”¨cudaSetDevice()å‡½æ•°ï¼Œåˆ™é»˜è®¤ä½¿ç”¨0å·è®¾å¤‡ã€‚ ä¸Šé¢ä¸‰ä¸ªå‡½æ•°çš„å…·ä½“ç”¨æ³•è¯·æŸ¥çœ‹CUDAè¿è¡Œæ—¶APIæ–‡æ¡£ã€‚ 5.4.3. å­˜å‚¨å™¨ç®¡ç† å…±äº«å­˜å‚¨å™¨ã€å¸¸é‡å­˜å‚¨å™¨ã€çº¿æ€§å­˜å‚¨å™¨å’ŒCUDAæ•°ç»„çš„ä½¿ç”¨æ˜¯å­˜å‚¨å™¨ç®¡ç†çš„ä¸»è¦éƒ¨åˆ†ã€‚ 5.4.3.1 å…±äº«å­˜å‚¨å™¨ å…±äº«å­˜å‚¨å™¨ï¼Œä½¿ç”¨__shared__å˜é‡é™å®šç¬¦ä¿®é¥°ï¼Œå¯é™æ€æˆ–åŠ¨æ€åˆ†é…å…±äº«å­˜å‚¨å™¨ã€‚ ä»£ç ä¸€ï¼š é™æ€åˆ†é…å…±äº«å­˜å‚¨å™¨ï¼Œæ˜¯åœ¨è®¾å¤‡ä»£ç ä¸­ç›´æ¥åˆ†é…å…±äº«å­˜å‚¨å™¨çš„å¤§å°ï¼Œå¦‚ä¸‹ä»£ç ï¼š #define SHARED_MEM 16 __global__ void kernel(â€¦) { __shared__ int shared[SHARED_MEM]; } void main() { kernel\u003c\u003c\u003cnBlock, nThread\u003e\u003e\u003e(â€¦); } ä»£ç 2 åŠ¨æ€åˆ†é…å…±äº«å­˜å‚¨å™¨ï¼Œæ˜¯åœ¨ä¸»æœºä»£ç ä¸­ä½¿ç”¨å†…æ ¸å‡½æ•°çš„ç¬¬ä¸‰ä¸ªç‰¹å®šå‚æ•°ä¼ å…¥åˆ†é…å…±äº«å­˜å‚¨å™¨çš„å¤§å°ï¼Œå¦‚ä¸‹ä»£ç ï¼š #define SHARED_MEM 16 __global__ void kernel(â€¦) { extern __shared__ int shared[]; } void main() { int nSharedMem = (int)SHARED_MEM; kernel\u003c\u003c\u003cnBlock, nThread, nSharedMem*sizeof(int)\u003e\u003e\u003e(â€¦); } 5.4.3.2. å¸¸é‡å­˜å‚¨å™¨ å¸¸é‡å­˜å‚¨å™¨ï¼Œä½¿ç”¨__constant__å˜é‡é™å®šç¬¦ä¿®é¥°ã€‚ä½¿ç”¨å¸¸é‡å­˜å‚¨å™¨ï¼Œæ˜¯ç”±äºå…¶åœ¨è®¾å¤‡ä¸Šæœ‰ç‰‡ä¸Šç¼“å­˜ï¼Œæ¯”å…¨å±€å­˜å‚¨å™¨è¯»å–æ•ˆç‡é«˜å¾ˆå¤šã€‚ ä½¿ç”¨å¸¸é‡å­˜å‚¨å™¨æ—¶ä¼šæ¶‰åŠçš„è¿è¡Œæ—¶APIå‡½æ•°ä¸»è¦æœ‰ï¼š Â·cudaMemcpyToSymbol() Â·cudaMemcpyFromSymbol() Â·cudaGetSymbolAddress() Â·cudaGetSymbolSize() ä¸»æœºä»£ç ä¸­ä½¿ç”¨cudaGetSymbolAddress()è·å–__constant__æˆ–__device__å®šä¹‰çš„å˜é‡åœ°å€ã€‚è®¾å¤‡ä»£ç ä¸­å¯é€šè¿‡æå–__device__ã€__shared__æˆ–__constant__å˜é‡çš„æŒ‡é’ˆè·å–å˜é‡åœ°å€ã€‚ 5.4.3.3. çº¿æ€§å­˜å‚¨å™¨ çº¿æ€§å­˜å‚¨å™¨æ˜¯ä½¿ç”¨cudaMalloc()ã€cudaMallocPitch()æˆ–cudaMalloc3D()åˆ†é…çš„ï¼Œä½¿ç”¨cudaFree()é‡Šæ”¾ã€‚äºŒç»´çš„æ—¶å€™å»ºè®®ä½¿ç”¨cudaMallocPitch()åˆ†é…ï¼ŒcudaMallocPitch()å‡½æ•°å¯¹å¯¹é½è¿›è¡Œäº†è°ƒæ•´ã€‚è¿™ä¸‰ä¸ªåˆ†é…å‡½æ•°å¯¹åº”cudaMemset()ã€cudaMemset2D()ã€cudaMemset3D()ä¸‰ä¸ªmemsetå‡½æ•°å’ŒcudaMemcpy()ã€cudaMemcpy2D()ã€cudaMemcpy3D()ä¸‰ä¸ªmemcpyå‡½æ•°ã€‚ 5.4.3.4. CUDAæ•°ç»„ CUDAæ•°ç»„æ˜¯ä½¿ç”¨cudaMallocArray()ã€cudaMalloc3DArray()åˆ†é…çš„ï¼Œä½¿ç”¨cudaFreeArray()é‡Šæ”¾ã€‚ ç›¸å…³memcpyå‡½æ•°è¯·æŸ¥é˜…CUDAè¿è¡Œæ—¶APIæ–‡æ¡£ã€‚ å…·ä½“ä½¿ç”¨å¯æŸ¥é˜…CUDAç¼–ç¨‹æŒ‡å—ï¼šhttp://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html ã€‚ 5.4.4. æµç®¡ç† ä¸»æœºè®¾å¤‡ä¹‹é—´çš„å†…å­˜æ‹·è´ä¸å†…æ ¸åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œæ˜¯å¼‚æ­¥çš„ã€‚åœ¨ä¸ä½¿ç”¨æµçš„æƒ…å†µä¸‹ï¼Œæ˜¯è¿™æ ·æ‰§è¡Œçš„ï¼šè®¾å¤‡å…ˆä»ä¸»æœºä¸Šæ‹·è´å†…å­˜ï¼Œæ‹·è´å®Œæˆä¹‹åï¼Œå†åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œå†…æ ¸ä»£ç è®¡ç®—ï¼Œæœ€åå½“å†…æ ¸æ‰§è¡Œå®Œæ¯•ï¼Œå†æŠŠè®¾å¤‡ä¸Šçš„å†…å­˜æ‹·è´åˆ°ä¸»æœºä¸Šã€‚å½“ä½¿ç”¨ä¸¤ä¸ªæµçš„æƒ…å†µä¸‹ï¼Œ0å·æµæ‰§è¡Œå†…æ ¸ä»£ç çš„åŒæ—¶1å·æµæ‹·è´ä¸»æœºå†…å­˜åˆ°è®¾å¤‡ï¼Œ1å·æµæ‰§è¡Œçš„åŒæ—¶0å·æµæ‹·è´è®¾å¤‡å†…å­˜åˆ°ä¸»æœºï¼ˆå…·ä½“çš„å®ç°å¹¶ä¸ä¸€å®šå¦‚æ­¤ï¼Œè¿™é‡Œæ˜¯ä¸ºäº†è¯´æ˜æµçš„ä½œç”¨ç®€å•åšäº†å‡è®¾ï¼‰ã€‚ä¸¤ä¸ªæµçš„æƒ…å†µä¸‹ï¼Œéƒ¨åˆ†å†…å­˜æ‹·è´å’Œå†…ç½®æ‰§è¡Œæ˜¯åŒæ—¶è¿›è¡Œçš„ï¼ˆå¼‚æ­¥çš„ï¼‰ï¼Œæ¯”åŒæ­¥çš„å†…å­˜æ‹·è´å’Œå†…æ ¸æ‰§è¡ŒèŠ‚çœäº†æ—¶é—´ã€‚ ä¸æµæœ‰å…³çš„å‡½æ•°æœ‰ï¼š Â·cudaStreamCreate()ï¼šæµçš„åˆ›å»ºï¼› Â·cudaStreamDestroy()ï¼šæµçš„é”€æ¯ï¼› Â·cudaStreamSynchronize()ï¼šæµåŒæ­¥ï¼› Â·*Asyncï¼šä¸æµç›¸å…³çš„å…¶ä»–å‡½æ•°ã€‚ å†…æ ¸\u003c\u003c\u003câ€¦\u003e\u003e\u003eçš„ç¬¬å››ä¸ªå‚æ•°ä¸ºå“ªä¸ªæµã€‚ CUDAç¼–ç¨‹æŒ‡å—ä¸­æœ‰å¯¹æµå…·ä½“å®ç°çš„è®²è§£ã€‚ https://blog.csdn.net/a925907195/article/details/39500915 ","date":"2023-07-12","objectID":"/posts/cuda/:1:6","tags":["CUDA"],"title":"CUDA Introduction","uri":"/posts/cuda/"},{"categories":["GPU"],"content":"ç¬¬5ç«  å…±äº«å†…å­˜å’Œå¸¸é‡å†…å­˜ äº†è§£æ•°æ®åœ¨å…±äº«å†…å­˜ä¸­æ˜¯å¦‚ä½•è¢«å®‰æ’çš„ æŒæ¡ä»äºŒç»´å…±äº«å†…å­˜åˆ°çº¿æ€§å…¨å±€å†…å­˜çš„ç´¢å¼•è½¬æ¢ è§£å†³ä¸åŒè®¿é—®æ¨¡å¼ä¸­å­˜å‚¨ä½“ä¸­çš„å†²çª åœ¨å…±äº«å†…å­˜ä¸­ç¼“å­˜æ•°æ®ä»¥å‡å°‘å¯¹å…¨å±€å†…å­˜çš„è®¿é—® ä½¿ç”¨å…±äº«å†…å­˜é¿å…éåˆå¹¶å…¨å±€å†…å­˜çš„è®¿é—® ç†è§£å¸¸é‡ç¼“å­˜å’Œåªè¯»ç¼“å­˜ä¹‹é—´çš„å·®å¼‚ ä½¿ç”¨çº¿ç¨‹æŸæ´—ç‰ŒæŒ‡ä»¤ç¼–ç¨‹ ","date":"2023-07-12","objectID":"/posts/cuda_05/:1:0","tags":["CUDA"],"title":"CUDA_C_NOTES [5]","uri":"/posts/cuda_05/"},{"categories":["GPU"],"content":"5.1 CUDAå…±äº«å†…å­˜æ¦‚è¿° GPUä¸­æœ‰ä¸¤ç§ç±»å‹çš„å†…å­˜: æ¿è½½å†…å­˜: å…¨å±€å†…å­˜æ˜¯è¾ƒå¤§çš„æ¿è½½å†…å­˜ï¼Œå…·æœ‰ç›¸å¯¹è¾ƒé«˜çš„å»¶è¿Ÿã€‚ ç‰‡ä¸Šå†…å­˜: å…±äº«å†…å­˜æ˜¯è¾ƒå°çš„ç‰‡ä¸Šå†…å­˜ï¼Œå…·æœ‰ç›¸å¯¹è¾ƒä½çš„å»¶è¿Ÿï¼Œå¹¶ä¸”å…±äº«å†…å­˜å¯ä»¥æä¾›æ¯”å…¨å±€å†…å­˜é«˜å¾—å¤šçš„å¸¦å®½ å…±äº«å†…å­˜é€šå¸¸çš„ç”¨é€”æœ‰: å—å†…çº¿ç¨‹é€šä¿¡çš„é€šé“ ç”¨äºå…¨å±€å†…å­˜æ•°æ®çš„å¯ç¼–ç¨‹ç®¡ç†çš„ç¼“å­˜ é«˜é€Ÿæš‚å­˜å­˜å‚¨å™¨ï¼Œç”¨äºè½¬æ¢æ•°æ®ä»¥ä¼˜åŒ–å…¨å±€å†…å­˜è®¿é—®æ¨¡å¼ 5.1.1 å…±äº«å†…å­˜ å…±äº«å†…å­˜ï¼ˆshared memoryï¼ŒSMEMï¼‰æ˜¯GPUçš„ä¸€ä¸ªå…³é”®éƒ¨ä»¶ã€‚ç‰©ç†ä¸Šï¼Œæ¯ä¸ªSMéƒ½æœ‰ä¸€ä¸ªå°çš„ä½å»¶è¿Ÿå†…å­˜æ± ï¼Œè¿™ä¸ªå†…å­˜æ± è¢«å½“å‰æ­£åœ¨è¯¥SMä¸Šæ‰§è¡Œçš„çº¿ç¨‹å—ä¸­çš„æ‰€æœ‰çº¿ç¨‹æ‰€å…±äº«ã€‚(å…±äº«å†…å­˜å°±æ˜¯SMä¸Šçš„ä¸€å—ä½å»¶è¿Ÿå†…å­˜æ± ) å…±äº«å†…å­˜ä½¿åŒä¸€ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹èƒ½å¤Ÿäº’ç›¸åä½œï¼Œä¾¿äºé‡ç”¨ç‰‡ä¸Šæ•°æ®ï¼Œå¹¶å¯ä»¥å¤§å¤§é™ä½æ ¸å‡½æ•°æ‰€éœ€çš„å…¨å±€å†…å­˜å¸¦å®½ã€‚ç”±äºå…±äº«å†…å­˜ä¸­çš„å†…å®¹æ˜¯ç”±åº”ç”¨ç¨‹åºæ˜¾å¼ç®¡ç†çš„ï¼Œæ‰€ä»¥å®ƒé€šå¸¸è¢«æè¿°ä¸ºå¯ç¼–ç¨‹ç®¡ç†çš„ç¼“å­˜ã€‚ å½“æ¯ä¸ªçº¿ç¨‹å—å¼€å§‹æ‰§è¡Œæ—¶ï¼Œä¼šåˆ†é…ç»™å®ƒä¸€å®šæ•°é‡çš„å…±äº«å†…å­˜ã€‚è¿™ä¸ªå…±äº«å†…å­˜çš„åœ°å€ç©ºé—´è¢«çº¿ç¨‹å—ä¸­æ‰€æœ‰çš„çº¿ç¨‹å…±äº«ã€‚å®ƒçš„å†…å®¹å’Œåˆ›å»ºæ—¶æ‰€åœ¨çš„çº¿ç¨‹å—å…·æœ‰ç›¸åŒç”Ÿå‘½å‘¨æœŸã€‚æ¯ä¸ªçº¿ç¨‹æŸå‘å‡ºå…±äº«å†…å­˜è®¿é—®è¯·æ±‚ã€‚åœ¨ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªè¢«çº¿ç¨‹æŸå…±äº«å†…å­˜è®¿é—®çš„è¯·æ±‚åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å®Œæˆã€‚æœ€åçš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªå…±äº«å†…å­˜çš„è¯·æ±‚åœ¨32ä¸ªä¸åŒçš„äº‹åŠ¡ä¸­é¡ºåºæ‰§è¡Œã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹è®¿é—®å…±äº«å†…å­˜ä¸­çš„åŒä¸€ä¸ªå­—ï¼Œä¸€ä¸ªçº¿ç¨‹è¯»å–è¯¥å­—åï¼Œé€šè¿‡å¤šæ’­æŠŠå®ƒå‘é€ç»™å…¶ä»–çº¿ç¨‹ã€‚ å…±äº«å†…å­˜è¢«SMä¸­çš„æ‰€æœ‰å¸¸é©»çº¿ç¨‹å—åˆ’åˆ†ï¼Œå› æ­¤ï¼Œå…±äº«å†…å­˜æ˜¯é™åˆ¶è®¾å¤‡å¹¶è¡Œæ€§çš„å…³é”®èµ„æºã€‚ä¸€ä¸ªæ ¸å‡½æ•°ä½¿ç”¨çš„å…±äº«å†…å­˜è¶Šå¤šï¼Œå¤„äºå¹¶å‘æ´»è·ƒçŠ¶æ€çš„çº¿ç¨‹å—å°±è¶Šå°‘ã€‚ å¯ç¼–ç¨‹ç®¡ç†çš„ç¼“å­˜ å…±äº«å†…å­˜æ˜¯ä¸€ä¸ªå¯ç¼–ç¨‹ç®¡ç†çš„ç¼“å­˜ã€‚å½“æ•°æ®ç§»åŠ¨åˆ°å…±äº«å†…å­˜ä¸­ä»¥åŠæ•°æ®è¢«é‡Šæ”¾æ—¶,æˆ‘ä»¬å¯¹å®ƒæœ‰å……åˆ†çš„æ§åˆ¶æƒã€‚ç”±äºåœ¨CUDAä¸­å…è®¸æ‰‹åŠ¨ç®¡ç†å…±äº«å†…å­˜,æ‰€ä»¥é€šè¿‡åœ¨æ•°æ®å¸ƒå±€ä¸Šæä¾›æ›´å¤šçš„ç»†ç²’åº¦æ§åˆ¶å’Œæ”¹å–„ç‰‡ä¸Šæ•°æ®çš„ç§»åŠ¨,ä½¿å¾—å¯¹åº”ç”¨ç¨‹åºä»£ç è¿›è¡Œä¼˜åŒ–å˜å¾—æ›´ç®€å•äº† 5.1.2 å…±äº«å†…å­˜åˆ†é… æœ‰å¤šç§æ–¹æ³•å¯ä»¥ç”¨æ¥åˆ†é…æˆ–å£°æ˜ç”±åº”ç”¨ç¨‹åºè¯·æ±‚æ‰€å†³å®šçš„å…±äº«å†…å­˜å˜é‡ã€‚å¯ä»¥é™æ€æˆ–åŠ¨æ€åœ°åˆ†é…å…±äº«å†…å­˜å˜é‡ã€‚åœ¨CUDAçš„æºä»£ç æ–‡ä»¶ä¸­,å…±äº«å†…å­˜å¯ä»¥è¢«å£°æ˜ä¸ºä¸€ä¸ªæœ¬åœ°çš„CUDAæ ¸å‡½æ•°æˆ–æ˜¯ä¸€ä¸ªå…¨å±€çš„CUDAæ ¸å‡½æ•°ã€‚CUDAæ”¯æŒä¸€ç»´ã€äºŒç»´å’Œä¸‰ç»´å…±äº«å†…å­˜æ•°ç»„çš„å£°æ˜ã€‚ å…±äº«å†…å­˜å˜é‡ç”¨ä¸‹åˆ—ä¿®é¥°ç¬¦è¿›è¡Œå£°æ˜: __shared__ å¦‚æœåœ¨æ ¸å‡½æ•°ä¸­è¿›è¡Œå£°æ˜,é‚£ä¹ˆè¿™ä¸ªå˜é‡çš„ä½œç”¨åŸŸå°±å±€é™åœ¨è¯¥å†…æ ¸ä¸­ã€‚å¦‚æœåœ¨æ–‡ä»¶çš„ä»»ä½•æ ¸å‡½æ•°å¤–è¿›è¡Œå£°æ˜,é‚£ä¹ˆè¿™ä¸ªå˜é‡çš„ä½œç”¨åŸŸå¯¹æ‰€æœ‰æ ¸å‡½æ•°æ¥è¯´éƒ½æ˜¯å…¨å±€çš„ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda_05/:1:1","tags":["CUDA"],"title":"CUDA_C_NOTES [5]","uri":"/posts/cuda_05/"},{"categories":["GPU"],"content":"CH04 å…¨å±€å†…å­˜ ","date":"2023-07-12","objectID":"/posts/cuda_04/:1:0","tags":["CUDA"],"title":"CUDA_C_NOTES [4]","uri":"/posts/cuda_04/"},{"categories":["GPU"],"content":"4.1 CUDAå†…å­˜æ¨¡å‹æ¦‚è¿° åœ¨ç°æœ‰çš„ç¡¬ä»¶å­˜å‚¨å­ç³»ç»Ÿä¸‹ï¼Œ å¿…é¡»ä¾é å†…å­˜æ¨¡å‹è·å¾—æœ€ä½³çš„å»¶è¿Ÿå’Œå¸¦å®½ã€‚ CUDAå†…å­˜æ¨¡ç»“åˆäº†ä¸»æœºå’Œè®¾å¤‡çš„å†…å­˜ç³»ç»Ÿï¼Œ å±•ç°äº†å®Œæ•´çš„å†…å­˜å±‚æ¬¡ç»“æ„ï¼Œ ä½¿ä½ èƒ½æ˜¾å¼åœ°æ§åˆ¶æ•°æ®å¸ƒä»¥ä¼˜åŒ–æ€§èƒ½.s 4.1.1 å†…å­˜å±‚æ¬¡ç»“æ„çš„ä¼˜ç‚¹ ä¸¤ç§ä¸åŒç±»å‹çš„å±€éƒ¨æ€§: æ—¶é—´å±€éƒ¨æ€§ï¼šæ—¶é—´å±€éƒ¨æ€§è®¤ä¸ºå¦‚æœä¸€ä¸ªæ•°æ®ä½ç½®è¢«å¼•ç”¨ï¼Œ é‚£ä¹ˆè¯¥æ•°æ®åœ¨è¾ƒçŸ­çš„é—´å‘¨æœŸå†…å¾ˆå¯èƒ½ä¼šå†æ¬¡è¢«å¼•ç”¨ï¼Œ éšç€æ—¶é—´æµé€ï¼Œ è¯¥æ•°æ®è¢«å¼•ç”¨çš„å¯èƒ½æ€§é€æ¸é™ä½ ç©ºé—´å±€éƒ¨æ€§ï¼šç©ºé—´å±€éƒ¨æ€§è®¤ä¸ºå¦‚æœä¸€ä¸ªå†…å­˜ä½ç½®è¢«å¼•ç”¨ï¼Œ åˆ™é™„è¿‘çš„ä½ç½®ä¹Ÿå¯èƒ½ä¼šè¢«å¼•ç”¨ ç°ä»£è®¡ç®—æœºä½¿ç”¨ä¸æ–­æ”¹è¿›çš„ä½å»¶è¿Ÿä½å®¹é‡çš„å†…å­˜å±‚æ¬¡ç»“æ„æ¥ä¼˜åŒ–æ€§èƒ½ã€‚ è¿™ç§å†…å­˜å±‚æ¬¡ç»“æ„ä»…åœ¨æ”¯æŒå±€éƒ¨æ€§åŸåˆ™çš„æƒ…å†µä¸‹æœ‰æ•ˆã€‚ ä¸€ä¸ªå†…å­˜å±‚æ¬¡ç»“æ„ç”±å…·æœ‰ä¸åŒå»¶è¿Ÿã€ å¸¦å®½å®¹é‡çš„å¤šçº§å†…å­˜ç»„æˆã€‚ é€šå¸¸ï¼Œ éšç€ä»å¤„ç†å™¨åˆ°å†…å­˜å»¶è¿Ÿçš„å¢åŠ ï¼Œ å†…å­˜çš„å®¹é‡ä¹Ÿåœ¨å¢åŠ ã€‚ CPUå’ŒGPUçš„ä¸»å­˜éƒ½é‡‡ç”¨çš„æ˜¯DRAMï¼ˆåŠ¨æ€éšæœºå­˜å–å­˜å‚¨å™¨ï¼‰ï¼Œè€Œä½å»¶è¿Ÿå†…å­˜ï¼ˆå¦‚CPUä¸€çº§ç¼“å­˜ï¼‰ä½¿ç”¨çš„åˆ™æ˜¯SRAMï¼ˆé™æ€éšæœºå­˜å–å­˜å‚¨å™¨ï¼‰ã€‚å†…å­˜å±‚æ¬¡ç»“æ„ä¸­æœ€å¤§ä¸”æœ€æ…¢çš„çº§åˆ«é€šå¸¸ä½¿ç”¨ç£ç›˜æˆ–é—ªå­˜é©±åŠ¨æ¥å®ç°ã€‚åœ¨è¿™ç§å†…å­˜å±‚æ¬¡ç»“æ„ä¸­ï¼Œå½“æ•°æ®è¢«å¤„ç†å™¨é¢‘ç¹ä½¿ç”¨æ—¶ï¼Œè¯¥æ•°æ®ä¿å­˜åœ¨ä½å»¶è¿Ÿã€ä½å®¹é‡çš„å­˜å‚¨å™¨ä¸­ï¼›è€Œå½“è¯¥æ•°æ®è¢«å­˜å‚¨èµ·æ¥ä»¥å¤‡åç”¨æ—¶ï¼Œæ•°æ®å°±å­˜å‚¨åœ¨é«˜å»¶è¿Ÿã€å¤§å®¹é‡çš„å­˜å‚¨å™¨ä¸­ã€‚è¿™ç§å†…å­˜å±‚æ¬¡ç»“æ„ç¬¦åˆå¤§å†…å­˜ä½å»¶è¿Ÿçš„è®¾æƒ³ã€‚ GPUå’ŒCPUå†…å­˜æ¨¡å‹çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼Œ CUDAç¼–ç¨‹æ¨¡å‹èƒ½å°†å†…å­˜å±‚æ¬¡ç»“æ„æ›´å¥½åœ°å‘ˆç°ç»™ç”¨æˆ·ï¼Œ èƒ½è®©æˆ‘ä»¬æ˜¾å¼åœ°æ§åˆ¶å®ƒçš„è¡Œä¸º. 4.1.2 CUDAå†…å­˜æ¨¡å‹ å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œ ä¸€èˆ¬æœ‰ä¸¤ç§ç±»å‹çš„å­˜å‚¨å™¨ï¼š å¯ç¼–ç¨‹çš„ï¼š ä½ éœ€è¦æ˜¾å¼åœ°æ§åˆ¶å“ªäº›æ•°æ®å­˜æ”¾åœ¨å¯ç¼–ç¨‹å†…å­˜ä¸­ ä¸å¯ç¼–ç¨‹çš„ï¼š ä½ ä¸èƒ½å†³å®šæ•°æ®çš„å­˜æ”¾ä½ç½®ï¼Œ ç¨‹åºå°†è‡ªåŠ¨ç”Ÿæˆå­˜æ”¾ä½ç½®ä»¥è·å¾—å¥½çš„æ€§èƒ½ åœ¨CPUå†…å­˜å±‚æ¬¡ç»“æ„ä¸­ï¼Œ ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜éƒ½æ˜¯ä¸å¯ç¼–ç¨‹çš„å­˜å‚¨å™¨ã€‚ CUDAå†…å­˜æ¨¡å‹æå‡ºäº†å¤šç§å¯ç¼–ç¨‹å†…å­˜çš„ç±»å‹: å¯„å­˜å™¨ (register) å…±äº«å†…å­˜ (shared memory) æœ¬åœ°å†…å­˜ (local memory) å¸¸é‡å†…å­˜ï¼ˆconstant memoryï¼‰ çº¹ç†å†…å­˜ () å…¨å±€å†…å­˜(global memory) ä¸€ä¸ªæ ¸å‡½æ•°ä¸­çš„çº¿ç¨‹éƒ½æœ‰è‡ªå·±ç§æœ‰çš„æœ¬åœ°å†…å­˜ã€‚ ä¸€ä¸ªçº¿ç¨‹å—æœ‰è‡ªå·±çš„å…±äº«å†…å­˜ï¼Œ å¯¹åŒä¸€çº¿ç¨‹å—ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½å¯è§ï¼Œ å…¶å†…å®¹æŒç»­çº¿ç¨‹å—çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚ æ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®å…¨å±€å†…å­˜ã€‚ æ‰€æœ‰çº¿ç¨‹éƒ½èƒ½è®¿é—®çš„åªè¯»å†…å­˜ç©ºé—´æœ‰ï¼š å¸¸é‡å†…å­˜ç©ºé—´å’Œçº¹ç†å†…å­˜ç©ºé—´ã€‚ \u003e å…¨å±€å†…å­˜ã€ å¸¸é‡å†…å­˜å’Œçº¹ç†å†…å­˜ç©ºé—´æœ‰ä¸åŒçš„ç”¨é€”ã€‚ çº¹ç†å†…å­˜ä¸ºå„ç§æ•°æ®å¸ƒå±€æä¾›äº†ä¸åŒçš„å¯»å€æ¨¡å¼å’Œæ»¤æ³¢æ¨¡å¼ã€‚ å¯¹äºä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œ å…¨å±€å†…å­˜ã€ å¸¸é‡å†…å­˜å’Œçº¹ç†å†…å­˜ä¸­çš„å†…å®¹å…·æœ‰ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸ. 4.1.2.1 å¯„å­˜å™¨ å¯„å­˜å™¨æ˜¯GPUä¸Šè¿è¡Œé€Ÿåº¦æœ€å¿«çš„å†…å­˜ç©ºé—´ã€‚ æ ¸å‡½æ•°ä¸­å£°æ˜çš„ä¸€ä¸ªæ²¡æœ‰å…¶ä»–ä¿®é¥°ç¬¦çš„è‡ªå˜é‡ï¼Œ é€šå¸¸å­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­ã€‚ åœ¨æ ¸å‡½æ•°å£°æ˜çš„æ•°ç»„ä¸­ï¼Œ å¦‚æœç”¨äºå¼•ç”¨è¯¥æ•°ç»„çš„ç´¢å¼•æ˜¯å¸¸é‡ä¸”èƒ½åœ¨ç¼–è¯‘æ—¶ç¡®å®šï¼Œ é‚£ä¹ˆè¯¥æ•°ç»„ä¹Ÿå­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­ã€‚ å¯„å­˜å™¨å˜é‡å¯¹äºæ¯ä¸ªçº¿ç¨‹æ¥è¯´éƒ½æ˜¯ç§æœ‰çš„ï¼Œ ä¸€ä¸ªæ ¸å‡½æ•°é€šå¸¸ä½¿ç”¨å¯„å­˜å™¨æ¥ä¿å­˜éœ€è¦é¢‘ ç¹è®¿é—®çš„çº¿ç¨‹ç§æœ‰å˜é‡ã€‚ å¯„å­˜å™¨å˜é‡ä¸æ ¸å‡½æ•°çš„ç”Ÿå‘½å‘¨æœŸç›¸åŒã€‚ ä¸€æ—¦æ ¸å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œ å°±ä¸èƒ½å¯¹å¯„å­˜å™¨å˜é‡è¿›è¡Œè®¿é—®äº†ã€‚ å¯„å­˜å™¨æ˜¯ä¸€ä¸ªåœ¨SMä¸­ç”±æ´»è·ƒçº¿ç¨‹æŸåˆ’åˆ†å‡ºçš„è¾ƒå°‘èµ„æº: åœ¨Fermiæ¶æ„ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹æœ€å¤šæœ‰63ä¸ªå¯„å­˜å™¨ï¼› åœ¨Kepleræ¶æ„ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹æœ€å¤šæœ‰255ä¸ªå¯„å­˜å™¨ï¼› åœ¨æ ¸å‡½æ•°ä¸­ä½¿ç”¨è¾ƒå°‘çš„å¯„å­˜å™¨å°†ä½¿åœ¨SMä¸Šæœ‰æ›´å¤šçš„å¸¸é©»çº¿ç¨‹å—ã€‚ æ¯ä¸ªSMä¸Šå¹¶å‘çº¿ç¨‹å—è¶Šå¤šï¼Œä½¿ç”¨ç‡å’Œæ€§èƒ½å°±è¶Šé«˜ å¦‚æœä¸€ä¸ªæ ¸å‡½æ•°ä½¿ç”¨äº†è¶…è¿‡ç¡¬ä»¶é™åˆ¶æ•°é‡çš„å¯„å­˜å™¨ï¼Œ åˆ™ä¼šç”¨æœ¬åœ°å†…å­˜æ›¿ä»£å¤šå ç”¨çš„å¯„ å­˜å™¨ã€‚ 4.1.2.2 æœ¬åœ°å†…å­˜ï¼ˆlocal memoryï¼‰ ç¼–è¯‘å™¨å¯èƒ½å­˜æ”¾åˆ°æœ¬åœ°å†…å­˜ä¸­çš„å˜é‡æœ‰ï¼š åœ¨ç¼–è¯‘æ—¶ä½¿ç”¨æœªçŸ¥ç´¢å¼•å¼•ç”¨çš„æœ¬åœ°æ•°ç»„ å¯èƒ½ä¼šå ç”¨å¤§é‡å¯„å­˜å™¨ç©ºé—´çš„è¾ƒå¤§æœ¬åœ°ç»“æ„ä½“æˆ–æ•°ç»„ ä»»ä½•ä¸æ»¡è¶³æ ¸å‡½æ•°å¯„å­˜å™¨é™å®šæ¡ä»¶çš„å˜é‡ â€œæœ¬åœ°å†…å­˜â€è¿™ä¸€åè¯æ˜¯æœ‰æ­§ä¹‰çš„ï¼š æº¢å‡ºåˆ°æœ¬åœ°å†…å­˜ä¸­çš„å˜é‡æœ¬è´¨ä¸Šä¸å…¨å±€å†…å­˜åœ¨åŒä¸€ å—å­˜å‚¨åŒºåŸŸï¼Œ å› æ­¤æœ¬åœ°å†…å­˜è®¿é—®çš„ç‰¹ç‚¹æ˜¯é«˜å»¶è¿Ÿå’Œä½å¸¦å®½ï¼Œ å¹¶ä¸”å¦‚åœ¨æœ¬ç« åé¢çš„4.3èŠ‚ä¸­æ‰€æè¿°çš„é‚£æ ·ï¼Œ æœ¬åœ°å†…å­˜è®¿é—®ç¬¦åˆé«˜æ•ˆå†…å­˜è®¿é—®è¦æ±‚. 4.1.2.3 å…±äº«å†…å­˜ åœ¨æ ¸å‡½æ•°ä¸­ä½¿ç”¨å¦‚ä¸‹ä¿®é¥°ç¬¦ä¿®é¥°çš„å˜é‡å­˜æ”¾åœ¨å…±äº«å†…å­˜ä¸­ï¼š __shared__ å› ä¸ºå…±äº«å†…å­˜æ˜¯ç‰‡ä¸Šå†…å­˜ï¼Œ æ‰€ä»¥ä¸æœ¬åœ°å†…å­˜æˆ–å…¨å±€å†…å­˜ç›¸æ¯”ï¼Œ å®ƒå…·æœ‰æ›´é«˜çš„å¸¦å®½å’Œæ›´ ä½çš„å»¶è¿Ÿã€‚ å®ƒçš„ä½¿ç”¨ç±»ä¼¼äºCPUä¸€çº§ç¼“å­˜ï¼Œ ä½†å®ƒæ˜¯å¯ç¼–ç¨‹çš„ã€‚ æ¯ä¸€ä¸ªSMéƒ½æœ‰ä¸€å®šæ•°é‡çš„ç”±çº¿ç¨‹å—åˆ†é…çš„å…±äº«å†…å­˜ã€‚ å› æ­¤ï¼Œ å¿…é¡»éå¸¸å°å¿ƒä¸è¦è¿‡åº¦ä½¿ç”¨å…±äº«å†…å­˜ï¼Œ å¦åˆ™å°†åœ¨ä¸ç»æ„é—´é™åˆ¶æ´»è·ƒçº¿ç¨‹æŸçš„æ•°é‡ã€‚ å…±äº«å†…å­˜åœ¨æ ¸å‡½æ•°çš„èŒƒå›´å†…å£°æ˜ï¼Œ å…¶ç”Ÿå‘½å‘¨æœŸä¼´éšç€æ•´ä¸ªçº¿ç¨‹å—ã€‚ å½“ä¸€ä¸ªçº¿ç¨‹å—æ‰§è¡Œç»“æŸåï¼Œ å…¶åˆ†é…çš„å…±äº«å†…å­˜å°†è¢«é‡Šæ”¾å¹¶é‡æ–°åˆ†é…ç»™å…¶ä»–çº¿ç¨‹å—ã€‚ å…±äº«å†…å­˜æ˜¯çº¿ç¨‹ä¹‹é—´ç›¸äº’é€šä¿¡çš„åŸºæœ¬æ–¹å¼ã€‚ ä¸€ä¸ªå—å†…çš„çº¿ç¨‹é€šè¿‡ä½¿ç”¨å…±äº«å†…å­˜ä¸­çš„æ•° æ®å¯ä»¥ç›¸äº’åˆä½œã€‚ è®¿é—®å…±äº«å†…å­˜å¿…é¡»åŒæ­¥ä½¿ç”¨å¦‚ä¸‹è°ƒç”¨ï¼Œ è¯¥å‘½ä»¤æ˜¯åœ¨ä¹‹å‰ç« èŠ‚ä¸­ä»‹ç»è¿‡çš„CUDAè¿è¡Œæ—¶è°ƒç”¨ï¼š void __syncthreads(); è¯¥å‡½æ•°è®¾ç«‹äº†ä¸€ä¸ªæ‰§è¡Œéšœç¢ç‚¹ï¼Œ å³åŒä¸€ä¸ªçº¿ç¨‹å—ä¸­çš„æ‰€æœ‰çº¿ç¨‹å¿…é¡»åœ¨å…¶ä»–çº¿ç¨‹è¢«å…è®¸ æ‰§è¡Œå‰è¾¾åˆ°è¯¥å¤„ã€‚ ä¸ºçº¿ç¨‹å—é‡Œæ‰€æœ‰çº¿ç¨‹è®¾ç«‹éšœç¢ç‚¹ï¼Œ è¿™æ ·å¯ä»¥é¿å…æ½œåœ¨çš„æ•°æ®å†²çªã€‚ SMä¸­çš„ä¸€çº§ç¼“å­˜å’Œå…±äº«å†…å­˜éƒ½ä½¿ç”¨64KBçš„ç‰‡ä¸Šå†…å­˜ï¼Œ å®ƒé€šè¿‡é™æ€åˆ’åˆ†ï¼Œ ä½†åœ¨è¿è¡Œæ—¶ å¯ä»¥é€šè¿‡å¦‚ä¸‹æŒ‡ä»¤è¿›è¡ŒåŠ¨æ€é…ç½®ï¼š cudaError_t cudaFuncSetCacheConfig(const void* func, enum cadaFuncCache cacheConfig) 4.1.2.4 å¸¸é‡å†…å­˜ å¸¸é‡å†…å­˜é©»ç•™åœ¨è®¾å¤‡å†…å­˜ä¸­ï¼Œ å¹¶åœ¨æ¯ä¸ªSMä¸“ç”¨çš„å¸¸é‡ç¼“å­˜ä¸­ç¼“å­˜ã€‚ å¸¸é‡å˜é‡ç”¨å¦‚ä¸‹ ä¿®é¥°ç¬¦æ¥ä¿®é¥°: __constant__ å¸¸é‡å˜é‡å¿…é¡»åœ¨å…¨å±€ç©ºé—´å†…å’Œæ‰€æœ‰æ ¸å‡½æ•°ä¹‹å¤–è¿›è¡Œå£°æ˜ã€‚ å¯¹äºæ‰€æœ‰è®¡ç®—èƒ½åŠ›çš„è®¾å¤‡ï¼Œ éƒ½åªå¯ä»¥å£°æ˜64KBçš„å¸¸é‡å†…å­˜ã€‚ å¸¸é‡å†…å­˜æ˜¯é™æ€å£°æ˜çš„ï¼Œ å¹¶å¯¹åŒä¸€ç¼–è¯‘å•å…ƒä¸­çš„æ‰€æœ‰æ ¸å‡½æ•°å¯è§ã€‚ æ ¸å‡½æ•°åªèƒ½ä»å¸¸é‡å†…å­˜ä¸­è¯»å–æ•°æ®ã€‚ï¼ˆä¸èƒ½å¾€å¸¸é‡å†…å­˜ä¸­å†™æ•°æ®ï¼‰ å› æ­¤ï¼Œ å¸¸é‡å†…å­˜å¿…é¡»åœ¨ä¸»æœºç«¯ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°æ¥ åˆå§‹åŒ–ï¼š cudaError_t cudaMemoryToSymbol(const void* symbol, const void* src, size_t count) è¿™ä¸ªå‡½æ•°å°†countä¸ªå­—èŠ‚ä»srcæŒ‡å‘çš„å†…å­˜å¤åˆ¶åˆ°symbolæŒ‡å‘çš„å†…å­˜ä¸­ï¼Œ è¿™ä¸ªå˜é‡å­˜æ”¾åœ¨è®¾å¤‡çš„å…¨å±€å†…å­˜æˆ–å¸¸é‡å†…å­˜ä¸­ã€‚ çº¿ç¨‹æŸä¸­çš„æ‰€æœ‰çº¿ç¨‹ä»ç›¸åŒçš„å†…å­˜åœ°å€ä¸­è¯»å–æ•°æ®æ—¶ï¼Œ å¸¸é‡å†…å­˜è¡¨ç°æœ€å¥½ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œ æ•°å­¦å…¬å¼ä¸­çš„ç³»æ•°å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä½¿ç”¨å¸¸é‡å†…å­˜çš„ä¾‹å­ï¼Œ å› ä¸ºä¸€ä¸ªçº¿ç¨‹æŸä¸­æ‰€æœ‰çš„çº¿ç¨‹ä½¿ç”¨ç›¸åŒçš„ç³»æ•°æ¥å¯¹ä¸åŒæ•°æ®è¿›è¡Œç›¸åŒçš„è®¡ç®—ã€‚ å¦‚æœçº¿ç¨‹æŸé‡Œæ¯ä¸ªçº¿ç¨‹éƒ½ä»ä¸åŒçš„åœ°å€ç©ºé—´è¯»å–æ•°æ®ï¼Œ å¹¶ä¸”åªè¯»ä¸€æ¬¡ï¼Œ é‚£ä¹ˆå¸¸é‡å†…å­˜ä¸­å°±ä¸æ˜¯æœ€ä½³é€‰æ‹©ï¼Œ å› ä¸ºæ¯ä»ä¸€ä¸ªå¸¸é‡å†…å­˜ä¸­è¯»å–ä¸€æ¬¡æ•°æ®ï¼Œ éƒ½ä¼šå¹¿æ’­ç»™çº¿ç¨‹æŸé‡Œçš„æ‰€æœ‰çº¿ç¨‹ã€‚ 4.1.2.5 çº¹ç†å†…å­˜ çº¹ç†å†…å­˜æ˜¯ä¸€ç§é€šè¿‡æŒ‡å®šçš„åªè¯»ç¼“å­˜è®¿é—®çš„å…¨å±€å†…å­˜ã€‚ åªè¯»ç¼“å­˜åŒ…æ‹¬ç¡¬ä»¶æ»¤æ³¢çš„æ”¯æŒï¼Œ å®ƒå¯ä»¥å°†æµ®ç‚¹æ’å…¥ä½œä¸ºè¯»è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†æ¥æ‰§è¡Œã€‚ çº¹ç†å†…å­˜æ˜¯å¯¹äºŒç»´ç©ºé—´å±€éƒ¨æ€§çš„ä¼˜åŒ–ï¼Œ æ‰€ä»¥çº¿ç¨‹æŸé‡Œä½¿ç”¨çº¹ç†å†…å­˜è®¿é—®äºŒç»´æ•°æ®çš„çº¿ç¨‹å¯ä»¥è¾¾åˆ°æœ€ä¼˜æ€§èƒ½ã€‚ 4.1.2.6 å…¨å±€å†…å­˜ å…¨å±€å†…å­˜æ˜¯GPUä¸­æœ€å¤§ã€ å»¶è¿Ÿæœ€é«˜å¹¶ä¸”æœ€å¸¸ä½¿ç”¨çš„å†…å­˜ã€‚ globalæŒ‡çš„æ˜¯å…¶ä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸã€‚ å®ƒçš„å£°æ˜å¯ä»¥åœ¨ä»»ä½•SMè®¾å¤‡ä¸Šè¢«è®¿é—®åˆ°ï¼Œ å¹¶ä¸”è´¯ç©¿åº”ç”¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚ ä¸€ä¸ªå…¨å±€å†…å­˜å˜é‡å¯ä»¥è¢«é™æ€å£°æ˜æˆ–åŠ¨æ€å£°æ˜ã€‚ ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä¿®é¥°ç¬¦åœ¨è®¾å¤‡ä»£ç ä¸­ é™æ€åœ°å£°æ˜ä¸€ä¸ªå˜é‡ï¼š __device__ åœ¨ç¬¬2ç« çš„2.1èŠ‚ä¸­ï¼Œ ä½ å·²ç»å­¦ä¹ äº†å¦‚ä½•åŠ¨æ€åˆ†é…å…¨å±€å†…å­˜ã€‚ åœ¨ä¸»æœºç«¯ä½¿ç”¨cuda-Malloc å‡½æ•°åˆ†é…å…¨å±€å†…å­˜ï¼Œ ä½¿ç”¨cudaFreeå‡½æ•°é‡Šæ”¾å…¨å±€å†…å­˜ã€‚ ç„¶åæŒ‡å‘å…¨å±€å†…å­˜çš„æŒ‡é’ˆå°±ä¼šä½œä¸º å‚æ•°ä¼ é€’ç»™æ ¸å‡½æ•°ã€‚ å…¨å±€å†…å­˜åˆ†é…ç©ºé—´å­˜åœ¨äºåº”ç”¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œ å¹¶ä¸”å¯ä»¥è®¿é—® æ‰€æœ‰æ ¸å‡½æ•°ä¸­çš„æ‰€æœ‰çº¿ç¨‹ã€‚ ä»å¤šä¸ªçº¿ç¨‹è®¿é—®å…¨å±€å†…å­˜æ—¶å¿…é¡»æ³¨æ„ã€‚ å› ä¸ºçº¿ç¨‹çš„æ‰§è¡Œä¸èƒ½è·¨ çº¿ç¨‹å—åŒæ­¥ï¼Œ ä¸åŒçº¿ç¨‹å—å†…çš„å¤šä¸ªçº¿ç¨‹å¹¶å‘åœ°ä¿®æ”¹å…¨å±€å†…å­˜çš„åŒä¸€ä½ç½®å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œ è¿™å°†å¯¼è‡´ä¸€ä¸ªæœªå®šä¹‰çš„ç¨‹åºè¡Œä¸ºã€‚ ä¼˜åŒ–å†…å­˜äº‹åŠ¡å¯¹äºè·å¾—æœ€ä¼˜æ€§èƒ½æ¥è¯´æ˜¯è‡³å…³é‡è¦çš„ã€‚ å½“ä¸€ä¸ªçº¿ç¨‹æŸæ‰§è¡Œå†…å­˜åŠ è½½/ å­˜å‚¨æ—¶ï¼Œ éœ€è¦æ»¡è¶³çš„ä¼ è¾“æ•°é‡é€šå¸¸å–å†³äºä»¥ä¸‹ä¸¤ä¸ªå› ç´ ï¼š è·¨çº¿ç¨‹çš„å†…å­˜åœ°å€åˆ†å¸ƒ æ¯ä¸ªäº‹åŠ¡å†…å­˜åœ°å€çš„å¯¹é½æ–¹å¼ å¯¹äºä¸€ä¸ªç»™å®šçš„çº¿ç¨‹æŸå†…å­˜è¯·æ±‚ï¼Œ äº‹åŠ¡æ•°é‡å’Œæ•°æ®ååç‡æ˜¯ç”±è®¾å¤‡çš„è®¡ç®—èƒ½åŠ›æ¥ç¡®å®š çš„ã€‚ å¯¹äºè®¡ç®—èƒ½åŠ›ä¸º1.0å’Œ1.1çš„è®¾å¤‡ï¼Œ å…¨å±€å†…å­˜è®¿é—®çš„è¦æ±‚æ˜¯éå¸¸ä¸¥æ ¼çš„ã€‚ å¯¹äºè®¡ç®—èƒ½åŠ›é«˜äº1.1çš„è®¾å¤‡ï¼Œ ç”±äºå†…å­˜äº‹åŠ¡è¢«ç¼“å­˜ï¼Œ æ‰€ä»¥è¦æ±‚è¾ƒä¸ºå®½æ¾ã€‚ ç¼“å­˜çš„å†…å­˜äº‹åŠ¡åˆ©ç”¨æ•°æ®å±€éƒ¨æ€§æ¥æé«˜æ•°æ®ååç‡ã€‚ 4.1.2.7 GPUç¼“å­˜ è·ŸCPUç¼“å­˜ä¸€æ ·ï¼Œ GPUç¼“å­˜æ˜¯ä¸å¯ç¼–ç¨‹çš„å†…å­˜ã€‚ åœ¨GPUä¸Šæœ‰4ç§ç¼“å­˜ï¼š ä¸€çº§ç¼“å­˜ äºŒçº§ç¼“å­˜ åªè¯»å¸¸é‡ç¼“å­˜ åªè¯»çº¹ç†ç¼“å­˜ æ¯ä¸ªSMéƒ½æœ‰ä¸€ä¸ªä¸€çº§ç¼“å­˜ï¼Œ æ‰€æœ‰çš„SMå…±äº«ä¸€ä¸ªäºŒçº§ç¼“å­˜ã€‚ ä¸€çº§å’ŒäºŒçº§ç¼“å­˜éƒ½è¢«ç”¨æ¥åœ¨å­˜å‚¨æœ¬åœ°å†…å­˜å’Œå…¨å±€å†…å­˜ä¸­çš„æ•°æ®ï¼Œ ä¹ŸåŒ…æ‹¬å¯„å­˜å™¨æº¢å‡ºçš„éƒ¨åˆ†ã€‚å¯¹Fermi GPUå’ŒKepler K40æˆ–å…¶åå‘å¸ƒçš„GPUæ¥è¯´ï¼Œ CUDAå…è®¸æˆ‘ä»¬é…ç½®è¯»æ“ä½œçš„æ•°æ®æ˜¯ä½¿ç”¨ä¸€çº§å’ŒäºŒçº§ç¼“å­˜ï¼Œè¿˜æ˜¯åªä½¿ç”¨äºŒçº§ç¼“å­˜ã€‚ åœ¨GPUä¸Šåªæœ‰å†…å­˜åŠ è½½æ“ä½œå¯ä»¥è¢«ç¼“å­˜ï¼Œå†…å­˜å­˜å‚¨æ“ä½œä¸èƒ½è¢«ç¼“å­˜ã€‚ æ¯ä¸ªSMä¹Ÿæœ‰ä¸€ä¸ªåªè¯»å¸¸é‡ç¼“å­˜å’Œåªè¯»çº¹ç†ç¼“å­˜ï¼Œ å®ƒä»¬ç”¨äºåœ¨è®¾å¤‡å†…å­˜ä¸­æé«˜æ¥è‡ªäºå„è‡ªå†…å­˜ç©ºé—´å†…çš„è¯»å–æ€§èƒ½ã€‚ 4.1.2.8 CUDAå˜é‡å£°æ˜æ€»ç»“ 4.1.2.9 é™æ€å…¨å±€å†…å­˜ ","date":"2023-07-12","objectID":"/posts/cuda_04/:1:1","tags":["CUDA"],"title":"CUDA_C_NOTES [4]","uri":"/posts/cuda_04/"},{"categories":["GPU"],"content":"4.2 å†…å­˜ç®¡ç† CUDAç¼–ç¨‹çš„å†…å­˜ç®¡ç†ä¸Cè¯­è¨€çš„ç±»ä¼¼ï¼Œ éœ€è¦ç¨‹åºå‘˜æ˜¾å¼åœ°ç®¡ç†ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„æ•° æ®ç§»åŠ¨ã€‚ éšç€CUDAç‰ˆæœ¬çš„å‡çº§ï¼Œ NVIDIAæ­£ç³»ç»Ÿåœ°å®ç°ä¸»æœºå’Œè®¾å¤‡å†…å­˜ç©ºé—´çš„ç»Ÿä¸€ï¼Œ ä½†å¯¹äºå¤§å¤šæ•°åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œ ä»éœ€è¦æ‰‹åŠ¨ç§»åŠ¨æ•°æ®ã€‚ åˆ†é…å’Œé‡Šæ”¾è®¾å¤‡å†…å­˜ åœ¨ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´ä¼ è¾“æ•°æ® 4.2.1 å†…å­˜åˆ†é…å’Œé‡Šæ”¾ CUDAç¼–ç¨‹æ¨¡å‹å‡è®¾äº†ä¸€ä¸ªåŒ…å«ä¸€ä¸ªä¸»æœºå’Œä¸€ä¸ªè®¾å¤‡çš„å¼‚æ„ç³»ç»Ÿï¼Œ æ¯ä¸€ä¸ªå¼‚æ„ç³»ç»Ÿéƒ½ æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ã€‚ æ ¸å‡½æ•°åœ¨è®¾å¤‡å†…å­˜ç©ºé—´ä¸­è¿è¡Œï¼Œ CUDAè¿è¡Œæ—¶æä¾›å‡½æ•°ä»¥åˆ†é…å’Œé‡Šæ”¾è®¾å¤‡å†…å­˜ã€‚ ä½ å¯ä»¥åœ¨ä¸»æœºä¸Šä½¿ç”¨ä¸‹åˆ—å‡½æ•°åˆ†é…å…¨å±€å†…å­˜ï¼š cudaError_t cudaMalloc(void **devPrt, size_t count); è¿™ä¸ªå‡½æ•°åœ¨è®¾å¤‡ä¸Šåˆ†é…äº†countå­—èŠ‚çš„å…¨å±€å†…å­˜ï¼Œ å¹¶ç”¨devptræŒ‡é’ˆè¿”å›è¯¥å†…å­˜çš„åœ°å€ã€‚ ä½ éœ€è¦ç”¨ä»ä¸»æœºä¸Šä¼ è¾“çš„æ•°æ®æ¥å¡«å……æ‰€åˆ†é…çš„å…¨å±€å†…å­˜ï¼Œ æˆ–ç”¨ä¸‹åˆ—å‡½æ•°å°†å…¶åˆå§‹ åŒ–: cudaError_t cudaMemset(void *devPtr, int value, size_t count); è¿™ä¸ªå‡½æ•°ç”¨å­˜å‚¨åœ¨å˜é‡valueä¸­çš„å€¼æ¥å¡«å……ä»è®¾å¤‡å†…å­˜åœ°å€devPtrå¤„å¼€å§‹çš„countå­—èŠ‚ã€‚ ä¸€æ—¦ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸å†ä½¿ç”¨å·²åˆ†é…çš„å…¨å±€å†…å­˜ï¼Œ é‚£ä¹ˆå¯ä»¥ä»¥ä¸‹ä»£ç é‡Šæ”¾è¯¥å†…å­˜ç©ºé—´ï¼š cudaError_t cudaFree(void *devPtr); è¿™ä¸ªå‡½æ•°é‡Šæ”¾äº†devPtræŒ‡å‘çš„å…¨å±€å†…å­˜ï¼Œ è¯¥å†…å­˜å¿…é¡»åœ¨æ­¤å‰ä½¿ç”¨äº†ä¸€ä¸ªè®¾å¤‡åˆ†é…å‡½æ•° ï¼ˆå¦‚cudaMallocï¼‰ æ¥è¿›è¡Œåˆ†é…ã€‚ å¦åˆ™ï¼Œ å®ƒå°†è¿”å›ä¸€ä¸ªé”™è¯¯cudaErrorInvalidDevicePointerã€‚ å¦‚æœåœ°å€ç©ºé—´å·²ç»è¢«é‡Šæ”¾ï¼Œ é‚£ä¹ˆcudaFreeä¹Ÿè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ 4.2.2 å†…å­˜ä¼ è¾“ ä¸€æ—¦åˆ†é…å¥½äº†å…¨å±€å†…å­˜ï¼Œ ä½ å°±å¯ä»¥ä½¿ç”¨ä¸‹åˆ—å‡½æ•°ä»ä¸»æœºå‘è®¾å¤‡ä¼ è¾“æ•°æ®ï¼š cudaError_t cudaMemory(void *dst, const void *src, size_t count, enum cudaMemcpyKind kind) è¿™ä¸ªå‡½æ•°ä»å†…å­˜ä½ç½®srcå¤åˆ¶äº†countå­—èŠ‚åˆ°å†…å­˜ä½ç½®dstã€‚ å˜é‡kindæŒ‡å®šäº†å¤åˆ¶çš„æ–¹å‘ï¼Œ å¯ä»¥æœ‰ä¸‹åˆ—å–å€¼ï¼š cudaMemcpyHostToHost cudaMemcpyHostToDevice cudaMemcpyDeviceToHost cudaMemcpyDeviceToDevice CUDAç¼–ç¨‹çš„ä¸€ä¸ªåŸºæœ¬åŸåˆ™åº”æ˜¯å°½å¯èƒ½åœ°å‡å°‘ä¸»æœºä¸è®¾å¤‡ä¹‹é—´çš„ä¼ è¾“. 4.2.3 å›ºå®šå†…å­˜ åˆ†é…çš„ä¸»æœºå†…å­˜é»˜è®¤æ˜¯pageableï¼ˆå¯åˆ†é¡µï¼‰ ï¼Œ å®ƒçš„æ„æ€ä¹Ÿå°±æ˜¯å› é¡µé¢é”™è¯¯å¯¼è‡´çš„æ“ ä½œï¼Œ è¯¥æ“ä½œæŒ‰ç…§æ“ä½œç³»ç»Ÿçš„è¦æ±‚å°†ä¸»æœºè™šæ‹Ÿå†…å­˜ä¸Šçš„æ•°æ®ç§»åŠ¨åˆ°ä¸åŒçš„ç‰©ç†ä½ç½®ã€‚ è™šæ‹Ÿå†…å­˜ç»™äººä¸€ç§æ¯”å®é™…å¯ç”¨å†…å­˜å¤§å¾—å¤šçš„å‡è±¡ï¼Œ å°±å¦‚åŒä¸€çº§ç¼“å­˜å¥½åƒæ¯”å®é™…å¯ç”¨çš„ç‰‡ä¸Šå†…å­˜å¤§å¾—å¤šä¸€æ ·ã€‚ GPUä¸èƒ½åœ¨å¯åˆ†é¡µä¸»æœºå†…å­˜ä¸Šå®‰å…¨åœ°è®¿é—®æ•°æ®ï¼Œ å› ä¸ºå½“ä¸»æœºæ“ä½œç³»ç»Ÿåœ¨ç‰©ç†ä½ç½®ä¸Šç§» åŠ¨è¯¥æ•°æ®æ—¶ï¼Œ å®ƒæ— æ³•æ§åˆ¶ã€‚ å½“ä»å¯åˆ†é¡µä¸»æœºå†…å­˜ä¼ è¾“æ•°æ®åˆ°è®¾å¤‡å†…å­˜æ—¶ï¼Œ CUDAé©±åŠ¨ç¨‹åºé¦–å…ˆåˆ†é…ä¸´æ—¶é¡µé¢é”å®šçš„æˆ–å›ºå®šçš„ä¸»æœºå†…å­˜ï¼Œ å°†ä¸»æœºæºæ•°æ®å¤åˆ¶åˆ°å›ºå®šå†…å­˜ä¸­ï¼Œ ç„¶åä»å›ºå®šå†…å­˜ä¼ è¾“æ•°æ®ç»™è®¾å¤‡å†…å­˜ï¼Œ å¦‚å›¾4-4å·¦è¾¹éƒ¨åˆ†æ‰€ç¤º CUDAè¿è¡Œæ—¶å…è®¸ä½ ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤ç›´æ¥åˆ†é…å›ºå®šä¸»æœºå†…å­˜ï¼š cudaError_t cudaMallocHost(void **devPtr, size_t count); è¿™ä¸ªå‡½æ•°åˆ†é…äº†countå­—èŠ‚çš„ä¸»æœºå†…å­˜ï¼Œ è¿™äº›å†…å­˜æ˜¯é¡µé¢é”å®šçš„å¹¶ä¸”å¯¹è®¾å¤‡æ¥è¯´æ˜¯å¯ è®¿é—®çš„ã€‚ ç”±äºå›ºå®šå†…å­˜èƒ½è¢«è®¾å¤‡ç›´æ¥è®¿é—®ï¼Œ æ‰€ä»¥å®ƒèƒ½ç”¨æ¯”å¯åˆ†é¡µå†…å­˜é«˜å¾—å¤šçš„å¸¦å®½è¿›è¡Œè¯»å†™ã€‚ ç„¶è€Œï¼Œ åˆ†é…è¿‡å¤šçš„å›ºå®šå†…å­˜å¯èƒ½ä¼šé™ä½ä¸»æœºç³»ç»Ÿçš„æ€§èƒ½ï¼Œ å› ä¸ºå®ƒå‡å°‘äº†ç”¨äºå­˜å‚¨è™šæ‹Ÿå†…å­˜æ•°æ®çš„å¯åˆ†é¡µå†…å­˜çš„æ•°é‡ï¼Œ å…¶ä¸­åˆ†é¡µå†…å­˜å¯¹ä¸»æœºç³»ç»Ÿæ˜¯å¯ç”¨çš„ã€‚ ä¸»æœºä¸è®¾å¤‡é—´çš„å†…å­˜ä¼ è¾“ ä¸å¯åˆ†é¡µå†…å­˜ç›¸æ¯”ï¼Œ å›ºå®šå†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾æˆæœ¬æ›´é«˜ï¼Œ ä½†æ˜¯å®ƒä¸ºå¤§è§„æ¨¡æ•°æ®ä¼ è¾“æä¾› äº†æ›´é«˜çš„ä¼ è¾“ååé‡ 4.2.4 é›¶æ‹·è´å†…å­˜ é€šå¸¸æ¥è¯´ï¼Œ ä¸»æœºä¸èƒ½ç›´æ¥è®¿é—®è®¾å¤‡å˜é‡ï¼Œ åŒæ—¶è®¾å¤‡ä¹Ÿä¸èƒ½ç›´æ¥è®¿é—®ä¸»æœºå˜é‡ã€‚ ä½†æœ‰ä¸€ä¸ªä¾‹å¤–ï¼š é›¶æ‹·è´å†…å­˜ã€‚ ä¸»æœºå’Œè®¾å¤‡éƒ½å¯ä»¥è®¿é—®é›¶æ‹·è´å†…å­˜ã€‚ GPUçº¿ç¨‹å¯ä»¥ç›´æ¥è®¿é—®é›¶æ‹·è´å†…å­˜ã€‚ åœ¨CUDAæ ¸å‡½æ•°ä¸­ä½¿ç”¨é›¶æ‹·è´å†…å­˜æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ åŠ¿ã€‚ å½“è®¾å¤‡å†…å­˜ä¸è¶³æ—¶å¯åˆ©ç”¨ä¸»æœºå†…å­˜ é¿å…ä¸»æœºå’Œè®¾å¤‡é—´çš„æ˜¾å¼æ•°æ®ä¼ è¾“ æé«˜PCIeä¼ è¾“ç‡ å½“ä½¿ç”¨é›¶æ‹·è´å†…å­˜æ¥å…±äº«ä¸»æœºå’Œè®¾å¤‡é—´çš„æ•°æ®æ—¶ï¼Œ ä½ å¿…é¡»åŒæ­¥ä¸»æœºå’Œè®¾å¤‡é—´çš„å†…å­˜è®¿ é—®ï¼Œ åŒæ—¶æ›´æ”¹ä¸»æœºå’Œè®¾å¤‡çš„é›¶æ‹·è´å†…å­˜ä¸­çš„æ•°æ®å°†å¯¼è‡´ä¸å¯é¢„çŸ¥çš„åæœã€‚ é›¶æ‹·è´å†…å­˜æ˜¯å›ºå®šï¼ˆä¸å¯åˆ†é¡µï¼‰ å†…å­˜ï¼Œ è¯¥å†…å­˜æ˜ å°„åˆ°è®¾å¤‡åœ°å€ç©ºé—´ä¸­ã€‚ ä½ å¯ä»¥é€šè¿‡ä¸‹åˆ—å‡½æ•°åˆ›å»ºä¸€ä¸ªåˆ°å›ºå®šå†…å­˜çš„æ˜ å°„ï¼š cudaError_t cudaHostAlloc(void **pHost, size_t count, unsigned int flags); è¿™ä¸ªå‡½æ•°åˆ†é…äº†countå­—èŠ‚çš„ä¸»æœºå†…å­˜ï¼Œ è¯¥å†…å­˜æ˜¯é¡µé¢é”å®šçš„ä¸”è®¾å¤‡å¯è®¿é—®çš„ã€‚ ç”¨è¿™ ä¸ªå‡½æ•°åˆ†é…çš„å†…å­˜å¿…é¡»ç”¨cudaFreeHostå‡½æ•°é‡Šæ”¾ã€‚ flagså‚æ•°å¯ä»¥å¯¹å·²åˆ†é…å†…å­˜çš„ç‰¹æ®Šå±æ€§ è¿›ä¸€æ­¥è¿›è¡Œé…ç½®ï¼š - cudaHostAllocDefault - cudaHostAllocPortable - cudaHostAllocWriteCombined - cudaHostAllocMapped cudaHostAllocDefaultå‡½æ•°ä½¿cudaHostAllocå‡½æ•°çš„è¡Œä¸ºä¸cudaMallocHostå‡½æ•°ä¸€è‡´ã€‚ è®¾ç½®cudaHostAllocPortableå‡½æ•°å¯ä»¥è¿”å›èƒ½è¢«æ‰€æœ‰CUDAä¸Šä¸‹æ–‡ä½¿ç”¨çš„å›ºå®šå†…å­˜ï¼Œ è€Œä¸ä»…æ˜¯æ‰§ è¡Œå†…å­˜åˆ†é…çš„é‚£ä¸€ä¸ªã€‚ æ ‡å¿—cudaHostAllocWriteCombinedè¿”å›å†™ç»“åˆå†…å­˜ï¼Œ è¯¥å†…å­˜å¯ä»¥åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸Šé€šè¿‡PCIeæ€»çº¿ä¸Šæ›´å¿«åœ°ä¼ è¾“ï¼Œ ä½†æ˜¯å®ƒåœ¨å¤§å¤šæ•°ä¸»æœºä¸Šä¸èƒ½è¢«æœ‰æ•ˆåœ°è¯»å–ã€‚å› æ­¤ï¼Œ å†™ç»“åˆå†…å­˜å¯¹ç¼“å†²åŒºæ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œ è¯¥å†…å­˜é€šè¿‡è®¾å¤‡ä½¿ç”¨æ˜ å°„çš„å›ºå®šå†…å­˜æˆ–ä¸»æœºåˆ°è®¾å¤‡çš„ä¼ è¾“ã€‚ é›¶æ‹·è´å†…å­˜çš„æœ€æ˜æ˜¾çš„æ ‡å¿—æ˜¯cudaHostAllocMappedï¼Œ è¯¥æ ‡å¿—è¿”å›ï¼Œ å¯ä»¥å®ç°ä¸»æœºå†™å…¥å’Œè®¾å¤‡è¯»å–è¢«æ˜ å°„åˆ°è®¾å¤‡åœ°å€ç©ºé—´ä¸­çš„ä¸»æœºå†…å­˜ã€‚ ä½ å¯ä»¥ä½¿ç”¨ä¸‹åˆ—å‡½æ•°è·å–æ˜ å°„åˆ°å›ºå®šå†…å­˜çš„è®¾å¤‡æŒ‡é’ˆï¼š cudaError_t cudaHostGetDevicePointer(void **pDevice, void *pHost, unsigned int flags); è¯¥å‡½æ•°è¿”å›äº†ä¸€ä¸ªåœ¨pDeviceä¸­çš„è®¾å¤‡æŒ‡é’ˆï¼Œ è¯¥æŒ‡é’ˆå¯ä»¥åœ¨è®¾å¤‡ä¸Šè¢«å¼•ç”¨ä»¥è®¿é—®æ˜ å°„å¾—åˆ°çš„å›ºå®šä¸»æœºå†…å­˜ã€‚ å¦‚æœè®¾å¤‡ä¸æ”¯æŒæ˜ å°„å¾—åˆ°çš„å›ºå®šå†…å­˜ï¼Œ è¯¥å‡½æ•°å°†å¤±æ•ˆã€‚ flagå°†ç•™ä½œä»¥åä½¿ç”¨ã€‚ ç°åœ¨ï¼Œ å®ƒå¿…é¡»è¢«ç½®ä¸º0ã€‚ åœ¨è¿›è¡Œé¢‘ç¹çš„è¯»å†™æ“ä½œæ—¶ï¼Œ ä½¿ç”¨é›¶æ‹·è´å†…å­˜ä½œä¸ºè®¾å¤‡å†…å­˜çš„è¡¥å……å°†æ˜¾è‘—é™ä½æ€§èƒ½ã€‚ å› ä¸ºæ¯ä¸€æ¬¡æ˜ å°„åˆ°å†…å­˜çš„ä¼ è¾“å¿…é¡»ç»è¿‡PCIeæ€»çº¿ã€‚ ä¸å…¨å±€å†…å­˜ç›¸æ¯”ï¼Œ å»¶è¿Ÿä¹Ÿæ˜¾è‘—å¢åŠ ã€‚ é›¶æ‹·è´å†…å­˜ æœ‰ä¸¤ç§å¸¸è§çš„å¼‚æ„è®¡ç®—ç³»ç»Ÿæ¶æ„ï¼š é›†æˆæ¶æ„å’Œç¦»æ•£æ¶æ„ã€‚ åœ¨é›†æˆæ¶æ„ä¸­ï¼Œ CPUå’ŒGPUé›†æˆåœ¨ä¸€ä¸ªèŠ¯ç‰‡ä¸Šï¼Œ å¹¶ä¸”åœ¨ç‰©ç†åœ°å€ä¸Šå…±äº«ä¸»å­˜ã€‚ åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œ ç”±äºæ— é¡»åœ¨PCIeæ€»çº¿ä¸Šå¤‡ä»½ï¼Œ æ‰€ä»¥é›¶æ‹·è´å†…å­˜åœ¨æ€§èƒ½å’Œå¯ç¼–ç¨‹æ€§æ–¹é¢å¯èƒ½æ›´ä½³ã€‚ å¯¹äºé€šè¿‡PCIeæ€»çº¿å°†è®¾å¤‡è¿æ¥åˆ°ä¸»æœºçš„ç¦»æ•£ç³»ç»Ÿè€Œè¨€ï¼Œ é›¶æ‹·è´å†…å­˜åªåœ¨ç‰¹æ®Šæƒ…å†µä¸‹æœ‰ä¼˜åŠ¿ã€‚ å› ä¸ºæ˜ å°„çš„å›ºå®šå†…å­˜åœ¨ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´æ˜¯å…±äº«çš„ï¼Œ ä½ å¿…é¡»åŒæ­¥å†…å­˜è®¿é—®æ¥é¿å…ä»»ä½•æ½œåœ¨çš„æ•°æ®å†²çªï¼Œ è¿™ç§æ•°æ®å†²çªä¸€èˆ¬æ˜¯ç”±å¤šçº¿ç¨‹å¼‚æ­¥è®¿é—®ç›¸åŒçš„å†…å­˜è€Œå¼•èµ·çš„ã€‚ æ³¨æ„ä¸è¦è¿‡åº¦ä½¿ç”¨é›¶æ‹·è´å†…å­˜ã€‚ ç”±äºå…¶å»¶è¿Ÿè¾ƒé«˜ï¼Œ ä»é›¶æ‹·è´å†…å­˜ä¸­è¯»å–è®¾å¤‡æ ¸å‡½æ•°å¯èƒ½å¾ˆæ…¢ã€‚ 4.2.5 ç»Ÿä¸€è™šæ‹Ÿå¯»å€ ","date":"2023-07-12","objectID":"/posts/cuda_04/:1:2","tags":["CUDA"],"title":"CUDA_C_NOTES [4]","uri":"/posts/cuda_04/"},{"categories":["GPU"],"content":"CH03 CUDAæ‰§è¡Œæ¨¡å‹ ","date":"2023-07-12","objectID":"/posts/cuda_03/:1:0","tags":["CUDA"],"title":"CUDA_C_NOTES [3]","uri":"/posts/cuda_03/"},{"categories":["GPU"],"content":"3.1 CUDAæ‰§è¡Œæ¨¡å‹æ¦‚è¿° CUDAæ‰§è¡Œæ¨¡å‹èƒ½å¤Ÿæä¾›æœ‰åŠ©äºåœ¨æŒ‡ä»¤ååé‡å’Œå†…å­˜è®¿é—®æ–¹é¢ç¼–å†™é«˜æ•ˆä»£ç çš„è§è§£ 3.1.1 GPUæ¶æ„æ¦‚è¿° GPUæ¶æ„æ˜¯å›´ç»•ä¸€ä¸ªæµå¼å¤šå¤„ç†å™¨ï¼ˆSMï¼‰ (Stream Multiprocessor)çš„å¯æ‰©å±•é˜µåˆ—æ­å»ºçš„,å¯ä»¥é€šè¿‡å¤åˆ¶è¿™ç§æ¶æ„çš„æ„å»ºå—æ¥å®ç°GPUçš„ç¡¬ä»¶å¹¶è¡Œ Fermi SMçš„å…³é”®ç»„ä»¶ï¼š CUDAæ ¸å¿ƒ å…±äº«å†…å­˜/ä¸€çº§ç¼“å­˜ å¯„å­˜å™¨æ–‡ä»¶ åŠ è½½/å­˜å‚¨å•å…ƒ ç‰¹æ®ŠåŠŸèƒ½å•å…ƒ çº¿ç¨‹æŸè°ƒåº¦å™¨ GPUä¸­çš„æ¯ä¸€ä¸ªSMéƒ½èƒ½æ”¯æŒæ•°ç™¾ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œ æ¯ä¸ªGPUé€šå¸¸æœ‰å¤šä¸ªSMï¼Œ æ‰€ä»¥åœ¨ä¸€ä¸ªGPUä¸Šå¹¶å‘æ‰§è¡Œæ•°åƒä¸ªçº¿ç¨‹æ˜¯æœ‰å¯èƒ½çš„ã€‚ å½“å¯åŠ¨ä¸€ä¸ªå†…æ ¸ç½‘æ ¼æ—¶ï¼Œ å®ƒçš„çº¿ç¨‹å—è¢«åˆ†å¸ƒåœ¨äº†å¯ç”¨çš„SMä¸Šæ¥æ‰§è¡Œã€‚ çº¿ç¨‹å—ä¸€æ—¦è¢«è°ƒåº¦åˆ°ä¸€ä¸ªSMä¸Šï¼Œ å…¶ä¸­çš„çº¿ç¨‹åªä¼šåœ¨é‚£ä¸ªæŒ‡å®šçš„SMä¸Šå¹¶å‘æ‰§è¡Œã€‚ å¤šä¸ªçº¿ç¨‹å—å¯èƒ½ä¼šè¢«åˆ†é…åˆ°åŒä¸€ä¸ªSMä¸Šï¼Œ è€Œä¸”æ˜¯æ ¹æ®SMèµ„æºçš„å¯ç”¨æ€§è¿›è¡Œè°ƒåº¦çš„ã€‚åŒä¸€çº¿ç¨‹ä¸­çš„æŒ‡ä»¤åˆ©ç”¨æŒ‡ä»¤çº§å¹¶è¡Œæ€§è¿›è¡Œæµæ°´çº¿åŒ–ï¼Œ å¦å¤–ï¼Œ åœ¨CUDAä¸­å·²ç»ä»‹ç»äº†çº¿ç¨‹çº§å¹¶è¡Œã€‚ CUDAé‡‡ç”¨å•æŒ‡ä»¤å¤šçº¿ç¨‹ï¼ˆSIMTï¼‰ï¼ˆsingle instruciton multi threadï¼‰ æ¶æ„æ¥ç®¡ç†å’Œæ‰§è¡Œçº¿ç¨‹ï¼Œ æ¯32ä¸ªçº¿ç¨‹ä¸ºä¸€ç»„ï¼Œ è¢«ç§°ä¸ºçº¿ç¨‹æŸï¼ˆwarpï¼‰ ã€‚ çº¿ç¨‹æŸä¸­çš„æ‰€æœ‰çº¿ç¨‹åŒæ—¶æ‰§è¡Œç›¸åŒçš„æŒ‡ä»¤ã€‚ æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æŒ‡ä»¤åœ°å€è®¡æ•°å™¨å’Œå¯„å­˜å™¨çŠ¶æ€ï¼Œ åˆ©ç”¨è‡ªèº«çš„æ•°æ®æ‰§è¡Œå½“å‰çš„æŒ‡ä»¤ã€‚ æ¯ä¸ªSMéƒ½å°†åˆ†é…ç»™å®ƒçš„çº¿ç¨‹å—åˆ’åˆ†åˆ°åŒ…å«32ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æŸä¸­ï¼Œ ç„¶ååœ¨å¯ç”¨çš„ç¡¬ä»¶èµ„æºä¸Šè°ƒåº¦æ‰§è¡Œã€‚ SIMTæ¶æ„ä¸SIMDï¼ˆå•æŒ‡ä»¤å¤šæ•°æ®ï¼‰ æ¶æ„ç›¸ä¼¼ã€‚ ä¸¤è€…éƒ½æ˜¯å°†ç›¸åŒçš„æŒ‡ä»¤å¹¿æ’­ç»™å¤šä¸ªæ‰§è¡Œå•å…ƒæ¥å®ç°å¹¶è¡Œã€‚ ä¸€ä¸ªå…³é”®çš„åŒºåˆ«æ˜¯SIMDè¦æ±‚åŒä¸€ä¸ªå‘é‡ä¸­çš„æ‰€æœ‰å…ƒç´ è¦åœ¨ä¸€ä¸ªç»Ÿä¸€çš„åŒæ­¥ç»„ä¸­ä¸€èµ·æ‰§è¡Œï¼Œ è€ŒSIMTå…è®¸å±äºåŒä¸€çº¿ç¨‹æŸçš„å¤šä¸ªçº¿ç¨‹ç‹¬ç«‹æ‰§è¡Œ. SIMTç¡®ä¿å¯ä»¥ç¼–å†™ç‹¬ç«‹çš„çº¿ç¨‹çº§å¹¶è¡Œä»£ç ã€ æ ‡é‡çº¿ç¨‹ä»¥åŠç”¨äºåè°ƒçº¿ç¨‹çš„æ•°æ®å¹¶è¡Œä»£ç ã€‚ SIMTæ¨¡å‹åŒ…å«3ä¸ªSIMDæ‰€ä¸å…·å¤‡çš„å…³é”®ç‰¹å¾ã€‚ æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æŒ‡ä»¤åœ°å€è®¡æ•°å™¨ æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å¯„å­˜å™¨çŠ¶æ€ æ¯ä¸ªçº¿ç¨‹å¯ä»¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„æ‰§è¡Œè·¯å¾„ ä¸€ä¸ªç¥å¥‡çš„æ•°å­—ï¼š 32 ä»æ¦‚å¿µä¸Šè®²ï¼Œ å®ƒæ˜¯SMç”¨SIMDæ–¹å¼æ‰€åŒæ—¶å¤„ç†çš„å·¥ä½œç²’åº¦ã€‚ ä¼˜åŒ–å·¥ä½œè´Ÿè½½ä»¥é€‚åº”çº¿ç¨‹æŸï¼ˆä¸€ç»„æœ‰32ä¸ªçº¿ç¨‹ï¼‰ çš„è¾¹ç•Œï¼Œ ä¸€èˆ¬è¿™æ ·ä¼šæ›´æœ‰æ•ˆåœ°åˆ©ç”¨GPUè®¡ç®—èµ„æºã€‚ ä¸€ä¸ªçº¿ç¨‹å—åªèƒ½åœ¨ä¸€ä¸ªSMä¸Šè¢«è°ƒåº¦ã€‚ ä¸€æ—¦çº¿ç¨‹å—åœ¨ä¸€ä¸ªSMä¸Šè¢«è°ƒåº¦ï¼Œ å°±ä¼šä¿å­˜åœ¨è¯¥SMä¸Šç›´åˆ°æ‰§è¡Œå®Œæˆã€‚ åœ¨åŒä¸€æ—¶é—´ï¼Œ ä¸€ä¸ªSMå¯ä»¥å®¹çº³å¤šä¸ªçº¿ç¨‹å—. åœ¨SMä¸­ï¼Œ å…±äº«å†…å­˜å’Œå¯„å­˜å™¨æ˜¯éå¸¸é‡è¦çš„èµ„æºã€‚ å…±äº«å†…å­˜è¢«åˆ†é…åœ¨SMä¸Šçš„å¸¸é©»çº¿ç¨‹å—ä¸­ï¼Œ å¯„å­˜å™¨åœ¨çº¿ç¨‹ä¸­è¢«åˆ†é…ã€‚ å°½ç®¡çº¿ç¨‹å—é‡Œçš„æ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥é€»è¾‘åœ°å¹¶è¡Œè¿è¡Œï¼Œ ä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥åŒæ—¶åœ¨ç‰©ç†å±‚é¢æ‰§è¡Œã€‚ å› æ­¤ï¼Œ çº¿ç¨‹å—é‡Œçš„ä¸åŒçº¿ç¨‹å¯èƒ½ä¼šä»¥ä¸åŒçš„é€Ÿåº¦å‰è¿›ã€‚ åœ¨å¹¶è¡Œçº¿ç¨‹ä¸­å…±äº«æ•°æ®å¯èƒ½ä¼šå¼•èµ·ç«äº‰ï¼š å¤šä¸ªçº¿ç¨‹ä½¿ç”¨æœªå®šä¹‰çš„é¡ºåºè®¿é—®åŒä¸€ä¸ªæ•°æ®ï¼Œ ä»è€Œå¯¼è‡´ä¸å¯é¢„æµ‹çš„ç¨‹åºè¡Œä¸ºã€‚ CUDAæä¾›äº†ä¸€ç§ç”¨æ¥åŒæ­¥çº¿ç¨‹å—é‡Œçš„çº¿ç¨‹çš„æ–¹æ³•ï¼Œä»è€Œä¿è¯æ‰€æœ‰çº¿ç¨‹åœ¨è¿›ä¸€æ­¥åŠ¨ä½œä¹‹å‰éƒ½è¾¾åˆ°æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªç‰¹å®šç‚¹ã€‚ ç„¶è€Œï¼Œ æ²¡æœ‰æä¾›å—é—´åŒæ­¥çš„åŸè¯­ã€‚ å½“çº¿ç¨‹æŸç”±äºä»»ä½•ç†ç”±é—²ç½®çš„æ—¶å€™ï¼ˆå¦‚ç­‰å¾…ä»è®¾å¤‡å†…å­˜ä¸­è¯»å–æ•°å€¼ï¼‰ ï¼Œ SMå¯ä»¥ä»åŒä¸€SMä¸Šçš„å¸¸é©»çº¿ç¨‹å—ä¸­è°ƒåº¦å…¶ä»–å¯ç”¨çš„çº¿ç¨‹æŸã€‚ åœ¨å¹¶å‘çš„çº¿ç¨‹æŸé—´åˆ‡æ¢å¹¶æ²¡æœ‰å¼€é”€ï¼Œ å› ä¸ºç¡¬ä»¶èµ„æºå·²ç»è¢«åˆ†é…åˆ°äº†SMä¸Šçš„æ‰€æœ‰çº¿ç¨‹å’Œå—ä¸­ï¼Œ æ‰€ä»¥æœ€æ–°è¢«è°ƒåº¦çš„çº¿ç¨‹æŸçš„çŠ¶æ€å·²ç»å­˜å‚¨åœ¨SMä¸Š SMï¼š GPUæ¶æ„çš„æ ¸å¿ƒ* SMæ˜¯GPUæ¶æ„çš„æ ¸å¿ƒã€‚ å¯„å­˜å™¨å’Œå…±äº«å†…å­˜æ˜¯SMä¸­çš„ç¨€ç¼ºèµ„æºã€‚ CUDAå°†è¿™äº›èµ„æºåˆ†é…åˆ°SMä¸­çš„æ‰€æœ‰å¸¸é©»çº¿ç¨‹é‡Œã€‚ è¿™äº›æœ‰é™çš„èµ„æºé™åˆ¶äº†åœ¨SMä¸Šæ´»è·ƒçš„çº¿ç¨‹æŸæ•°é‡ï¼Œæ´»è·ƒçš„çº¿ç¨‹æŸæ•°é‡å¯¹åº”äºSMä¸Šçš„å¹¶è¡Œé‡ã€‚ äº†è§£ä¸€äº›SMç¡¬ä»¶ç»„æˆçš„åŸºæœ¬çŸ¥è¯†ï¼Œ æœ‰åŠ©äºç»„ç»‡çº¿ç¨‹å’Œé…ç½®å†…æ ¸æ‰§è¡Œä»¥è·å¾—æœ€ä½³çš„æ€§èƒ½ 3.1.2 Fermiæ¶æ„ Fermiçš„ç‰¹å¾æ˜¯å¤šè¾¾512ä¸ªåŠ é€Ÿå™¨æ ¸å¿ƒï¼Œ è¿™è¢«ç§°ä¸ºCUDAæ ¸å¿ƒã€‚ æ¯ä¸ªCUDAæ ¸å¿ƒéƒ½æœ‰ä¸€ä¸ªå…¨æµæ°´çº¿çš„æ•´æ•°ç®—æœ¯é€»è¾‘å•å…ƒï¼ˆALUï¼‰ å’Œä¸€ä¸ªæµ®ç‚¹è¿ç®—å•å…ƒï¼ˆFPUï¼‰ ï¼Œ åœ¨è¿™é‡Œæ¯ä¸ªæ—¶é’Ÿå‘¨æœŸæ‰§è¡Œä¸€ä¸ªæ•´æ•°æˆ–æ˜¯æµ®ç‚¹æ•°æŒ‡ä»¤ã€‚ CUDAæ ¸å¿ƒè¢«ç»„ç»‡åˆ°16ä¸ªSMä¸­ï¼Œ æ¯ä¸€ä¸ªSMå«æœ‰32ä¸ªCUDAæ ¸å¿ƒã€‚ Fermiæ¶æ„æœ‰6ä¸ª384ä½çš„GDDR5 DRAMå­˜å‚¨å™¨æ¥å£ï¼Œ æ”¯æŒå¤šè¾¾6GBçš„å…¨å±€æœºè½½å†…å­˜ï¼Œ è¿™æ˜¯è®¸å¤šåº”ç”¨ç¨‹åºå…³é”®çš„è®¡ç®—èµ„æºã€‚ ä¸»æœºæ¥å£é€šè¿‡PCIeæ€»çº¿å°†GPUä¸CPUç›¸è¿ã€‚ GigaThreadå¼•æ“ï¼ˆå›¾ç¤ºå·¦ä¾§ç¬¬ä¸‰éƒ¨åˆ†ï¼‰ æ˜¯ä¸€ä¸ªå…¨å±€è°ƒåº¦å™¨ï¼Œ ç”¨æ¥åˆ†é…çº¿ç¨‹å—åˆ°SMçº¿ç¨‹æŸè°ƒåº¦å™¨ä¸Šã€‚ ä¸€ä¸ªSM(Stream Multiprocessor)åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š æ‰§è¡Œå•å…ƒï¼ˆCUDAæ ¸å¿ƒï¼‰ è°ƒåº¦çº¿ç¨‹æŸçš„è°ƒåº¦å™¨å’Œè°ƒåº¦å•å…ƒ å…±äº«å†…å­˜ã€ å¯„å­˜å™¨æ–‡ä»¶å’Œä¸€çº§ç¼“å­˜ æ¯ä¸€ä¸ªå¤šå¤„ç†å™¨æœ‰16ä¸ªåŠ è½½/å­˜å‚¨å•å…ƒï¼ˆå¦‚å›¾3-1æ‰€ç¤ºï¼‰ ï¼Œ å…è®¸æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸå†…æœ‰16ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹æŸçš„ä¸€åŠï¼‰ è®¡ç®—æºåœ°å€å’Œç›®çš„åœ°å€ã€‚ ç‰¹æ®ŠåŠŸèƒ½å•å…ƒï¼ˆSFUï¼‰ æ‰§è¡Œå›ºæœ‰æŒ‡ä»¤ï¼Œ å¦‚æ­£å¼¦ã€ ä½™å¼¦ã€ å¹³æ–¹æ ¹å’Œæ’å€¼ã€‚ æ¯ä¸ªSFUæ¯ä¸ªæ—¶é’Ÿå‘¨æœŸå†…çš„æ¯ä¸ªçº¿ç¨‹ä¸Šæ‰§è¡Œä¸€ä¸ªå›ºæœ‰æŒ‡ä»¤ æ¯ä¸ªSMæœ‰ä¸¤ä¸ªçº¿ç¨‹æŸè°ƒåº¦å™¨å’Œä¸¤ä¸ªæŒ‡ä»¤è°ƒåº¦å•å…ƒã€‚ å½“ä¸€ä¸ªçº¿ç¨‹å—è¢«æŒ‡å®šç»™ä¸€ä¸ªSMæ—¶ï¼Œ çº¿ç¨‹å—ä¸­çš„æ‰€æœ‰çº¿ç¨‹è¢«åˆ†æˆäº†çº¿ç¨‹æŸã€‚ ä¸¤ä¸ªçº¿ç¨‹æŸè°ƒåº¦å™¨é€‰æ‹©ä¸¤ä¸ªçº¿ç¨‹æŸï¼Œ å†æŠŠä¸€ä¸ª æŒ‡ä»¤ä»çº¿ç¨‹æŸä¸­å‘é€åˆ°ä¸€ä¸ªç»„ä¸Šï¼Œ ç»„é‡Œæœ‰16ä¸ªCUDAæ ¸å¿ƒã€ 16ä¸ªåŠ è½½/å­˜å‚¨å•å…ƒæˆ–4ä¸ªç‰¹æ®ŠåŠŸèƒ½å•å…ƒï¼ˆå¦‚å›¾3-4æ‰€ç¤ºï¼‰ ã€‚ Fermiæ¶æ„ï¼Œ è®¡ç®—æ€§èƒ½2.xï¼Œ å¯ä»¥åœ¨æ¯ä¸ªSMä¸ŠåŒæ—¶å¤„ç†48ä¸ªçº¿ç¨‹æŸï¼Œ å³å¯åœ¨ä¸€ä¸ªSMä¸ŠåŒæ—¶å¸¸é©»1536ä¸ªçº¿ç¨‹ã€‚ 3.1.3 Kepleræ¶æ„ å‘å¸ƒäº2012å¹´ç§‹å­£çš„Kepler GPUæ¶æ„æ˜¯ä¸€ç§å¿«é€Ÿã€ é«˜æ•ˆã€ é«˜æ€§èƒ½çš„è®¡ç®—æ¶æ„ã€‚ Kepler çš„ç‰¹ç‚¹ä½¿å¾—æ··åˆè®¡ç®—æ›´å®¹æ˜“ç†è§£ã€‚ å›¾3-6è¡¨ç¤ºäº†Kepler K20XèŠ¯ç‰‡æ¡†å›¾ï¼Œ å®ƒåŒ…å«äº†15ä¸ªSM å’Œ6ä¸ª64ä½çš„å†…å­˜æ§åˆ¶å™¨ã€‚ ä»¥ä¸‹æ˜¯Kepleræ¶æ„çš„3ä¸ªé‡è¦çš„åˆ›æ–°ã€‚ å¼ºåŒ–çš„SM åŠ¨æ€å¹¶è¡Œ Hyper-QæŠ€æœ¯ Kepler K20Xçš„å…³é”®éƒ¨åˆ†æ˜¯æœ‰ä¸€ä¸ªæ–°çš„SMå•å…ƒï¼Œ å…¶åŒ…æ‹¬ä¸€äº›ç»“æ„çš„åˆ›æ–°ï¼Œ ä»¥æé«˜ç¼–ç¨‹æ•ˆç‡å’ŒåŠŸç‡æ•ˆç‡ã€‚ æ¯ä¸ªKepler SMå•å…ƒåŒ…å«192ä¸ªå•ç²¾åº¦CUDAæ ¸å¿ƒï¼Œ 64ä¸ªåŒç²¾åº¦å•å…ƒï¼Œ 32ä¸ªç‰¹æ®ŠåŠŸèƒ½å•å…ƒï¼ˆSFUï¼‰ ä»¥åŠ32ä¸ªåŠ è½½/å­˜å‚¨å•å…ƒï¼ˆLD/STï¼‰ 3.1.4 é…ç½®æ–‡ä»¶é©±åŠ¨ä¼˜åŒ– é…ç½®æ–‡ä»¶é©±åŠ¨çš„å‘å±•å¯¹äºCUDAç¼–ç¨‹å°¤ä¸ºé‡è¦ï¼Œ åŸå› ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ã€‚ ä¸€ä¸ªå•çº¯çš„å†…æ ¸åº”ç”¨ä¸€èˆ¬ä¸ä¼šäº§ç”Ÿæœ€ä½³çš„æ€§èƒ½ã€‚ æ€§èƒ½åˆ†æå·¥å…·èƒ½å¸®åŠ©ä½ æ‰¾åˆ°ä»£ç ä¸­å½±å“æ€§èƒ½çš„å…³é”®éƒ¨åˆ†ï¼Œ ä¹Ÿå°±æ˜¯æ€§èƒ½ç“¶é¢ˆã€‚ CUDAå°†SMä¸­çš„è®¡ç®—èµ„æºå½“å‰SMä¸­çš„å¤šä¸ªå¸¸é©»çº¿ç¨‹å—ä¹‹é—´è¿›è¡Œåˆ†é…ã€‚ è¿™ç§åˆ†é…å½¢å¼å¯¼è‡´ä¸€äº›èµ„æºæˆä¸ºäº†æ€§èƒ½é™åˆ¶è€…ã€‚ æ€§èƒ½åˆ†æå·¥å…·èƒ½å¸®åŠ©æˆ‘ä»¬ç†è§£è®¡ç®—èµ„æºæ˜¯å¦‚ä½•è¢«åˆ©ç”¨çš„ã€‚ CUDAæä¾›äº†ä¸€ä¸ªç¡¬ä»¶æ¶æ„çš„æŠ½è±¡ï¼Œ å®ƒèƒ½å¤Ÿè®©ç”¨æˆ·æ§åˆ¶çº¿ç¨‹å¹¶å‘ã€‚ æ€§èƒ½åˆ†æå·¥å…·å¯ä»¥æ£€æµ‹å’Œä¼˜åŒ–ï¼Œ å¹¶å°†ä¼˜åŒ–å¯è§†åŒ–ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda_03/:1:1","tags":["CUDA"],"title":"CUDA_C_NOTES [3]","uri":"/posts/cuda_03/"},{"categories":["GPU"],"content":"3.2 ç†è§£çº¿ç¨‹æŸæ‰§è¡Œçš„æœ¬è´¨ æœ¬ç« å·²ç»æåˆ°äº†æŠŠ32ä¸ªçº¿ç¨‹åˆ’åˆ†åˆ°ä¸€ä¸ªæ‰§è¡Œå•å…ƒä¸­çš„æ¦‚å¿µï¼š çº¿ç¨‹æŸï¼ˆwarpï¼‰ã€‚ ç°åœ¨ä»ç¡¬ä»¶çš„è§’åº¦æ¥ä»‹ç»çº¿ç¨‹æŸæ‰§è¡Œï¼Œ å¹¶èƒ½å¤Ÿè·å¾—æŒ‡å¯¼å†…æ ¸è®¾è®¡çš„æ–¹æ³•ã€‚ 3.2.1 çº¿ç¨‹æŸå’Œçº¿ç¨‹å— çº¿ç¨‹æŸæ˜¯SMä¸­åŸºæœ¬çš„æ‰§è¡Œå•å…ƒã€‚ å½“ä¸€ä¸ªçº¿ç¨‹å—çš„ç½‘æ ¼è¢«å¯åŠ¨åï¼Œ ç½‘æ ¼ä¸­çš„çº¿ç¨‹å—åˆ†å¸ƒåœ¨SMä¸­ã€‚ ä¸€æ—¦çº¿ç¨‹å—è¢«è°ƒåº¦åˆ°ä¸€ä¸ªSMä¸Šï¼Œ çº¿ç¨‹å—ä¸­çš„çº¿ç¨‹ä¼šè¢«è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºçº¿ç¨‹æŸã€‚ ä¸€ä¸ªçº¿ç¨‹æŸç”±32ä¸ªè¿ç»­çš„çº¿ç¨‹ç»„æˆï¼Œ åœ¨ä¸€ä¸ªçº¿ç¨‹æŸä¸­ï¼Œ æ‰€æœ‰çš„çº¿ç¨‹æŒ‰ç…§å•æŒ‡ä»¤å¤šçº¿ç¨‹ï¼ˆSIMTï¼‰ æ–¹å¼æ‰§è¡Œï¼› ä¹Ÿå°±æ˜¯è¯´ï¼Œ æ‰€æœ‰çº¿ç¨‹éƒ½æ‰§è¡Œç›¸åŒçš„æŒ‡ä»¤ï¼Œ æ¯ä¸ªçº¿ç¨‹åœ¨ç§æœ‰æ•°æ®ä¸Šè¿› è¡Œæ“ä½œã€‚ ä¸€ä¸ªç»™å®šçš„äºŒç»´çº¿ç¨‹å—ï¼Œ åœ¨ä¸€ä¸ªå—ä¸­æ¯ä¸ªçº¿ç¨‹çš„ç‹¬ç‰¹æ ‡è¯†ç¬¦éƒ½å¯ä»¥ç”¨å†…ç½®å˜é‡threadIdxå’ŒblockDimæ¥è®¡ç®—ï¼š threadIdx.y * blockDim.x + threadIdx.x å¯¹äºä¸€ä¸ªä¸‰ç»´çº¿ç¨‹å—ï¼Œ è®¡ç®—å¦‚ä¸‹ï¼š threadIdx.x * blockDim.y * block.Dim.x + threadIdx.y * blockDim.x * threadIdx.x ä¸€ä¸ªçº¿ç¨‹å—çš„çº¿ç¨‹æŸçš„æ•°é‡å¯ä»¥æ ¹æ®ä¸‹å¼ç¡®å®šï¼š $$ä¸€ä¸ªçº¿ç¨‹å—ä¸­çº¿ç¨‹æŸçš„æ•°é‡ = å‘æ­£æ— ç©·å–æ•´ï¼ˆ\\frac{ä¸€ä¸ªçº¿ç¨‹å—ä¸­çº¿ç¨‹çš„æ•°é‡}{çº¿ç¨‹æŸå¤§å°}ï¼‰$$ å› æ­¤ï¼Œ ç¡¬ä»¶æ€»æ˜¯ç»™ä¸€ä¸ªçº¿ç¨‹å—åˆ†é…ä¸€å®šæ•°é‡çš„çº¿ç¨‹æŸã€‚ çº¿ç¨‹æŸä¸ä¼šåœ¨ä¸åŒçš„çº¿ç¨‹å—ä¹‹é—´åˆ†ç¦»ã€‚ å¦‚æœçº¿ç¨‹å—çš„å¤§å°ä¸æ˜¯çº¿ç¨‹æŸå¤§å°çš„å¶æ•°å€ï¼Œ é‚£ä¹ˆåœ¨æœ€åçš„çº¿ç¨‹æŸé‡Œæœ‰äº›çº¿ç¨‹å°±ä¸ä¼šæ´»è·ƒã€‚ ä»é€»è¾‘è§’åº¦æ¥çœ‹ï¼Œ çº¿ç¨‹å—æ˜¯çº¿ç¨‹çš„é›†åˆï¼Œ å®ƒä»¬å¯ä»¥è¢«ç»„ç»‡ä¸ºä¸€ç»´ã€ äºŒç»´æˆ–ä¸‰ç»´å¸ƒå±€ã€‚ ä»ç¡¬ä»¶è§’åº¦æ¥çœ‹ï¼Œ çº¿ç¨‹å—æ˜¯ä¸€ç»´çº¿ç¨‹æŸçš„é›†åˆã€‚ åœ¨çº¿ç¨‹å—ä¸­çº¿ç¨‹è¢«ç»„ç»‡æˆä¸€ç»´å¸ƒå±€ï¼Œæ¯32ä¸ªè¿ç»­çº¿ç¨‹ç»„æˆä¸€ä¸ªçº¿ç¨‹æŸã€‚ 3.2.2 çº¿ç¨‹æŸåˆ†åŒ– GPUæ˜¯ç›¸å¯¹ç®€å•çš„è®¾å¤‡ï¼Œ å®ƒæ²¡æœ‰å¤æ‚çš„åˆ†æ”¯é¢„æµ‹æœºåˆ¶ã€‚ ä¸€ä¸ªçº¿ç¨‹æŸä¸­çš„æ‰€æœ‰çº¿ç¨‹åœ¨åŒä¸€å‘¨æœŸä¸­å¿…é¡»æ‰§è¡Œç›¸åŒçš„æŒ‡ä»¤ï¼Œ å¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ï¼Œ é‚£ä¹ˆçº¿ç¨‹æŸä¸­çš„æ‰€æœ‰çº¿ç¨‹éƒ½å¿…é¡»æ‰§è¡Œè¯¥æŒ‡ä»¤ã€‚ å¦‚æœåœ¨åŒä¸€çº¿ç¨‹æŸä¸­çš„çº¿ç¨‹ä½¿ç”¨ä¸åŒçš„è·¯å¾„é€šè¿‡åŒä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œ è¿™å¯èƒ½ä¼šäº§ç”Ÿé—®é¢˜ã€‚ å¦‚æœä¸€ä¸ªçº¿ç¨‹æŸä¸­çš„çº¿ç¨‹äº§ç”Ÿåˆ†åŒ–ï¼Œ çº¿ç¨‹æŸå°†è¿ç»­æ‰§è¡Œæ¯ä¸€ä¸ªåˆ†æ”¯è·¯å¾„ï¼Œ è€Œç¦ç”¨ä¸æ‰§è¡Œè¿™ä¸€è·¯å¾„çš„çº¿ç¨‹ã€‚ çº¿ç¨‹æŸåˆ†åŒ–ä¼šå¯¼è‡´æ€§èƒ½æ˜æ˜¾åœ°ä¸‹é™ã€‚ é‡è¦æç¤º: å½“ä¸€ä¸ªåˆ†åŒ–çš„çº¿ç¨‹é‡‡å–ä¸åŒçš„ä»£ç è·¯å¾„æ—¶ï¼Œ ä¼šäº§ç”Ÿçº¿ç¨‹æŸåˆ†åŒ– ä¸åŒçš„if-then-elseåˆ†æ”¯ä¼šè¿ç»­æ‰§è¡Œ å°è¯•è°ƒæ•´åˆ†æ”¯ç²’åº¦ä»¥é€‚åº”çº¿ç¨‹æŸå¤§å°çš„å€æ•°ï¼Œ é¿å…çº¿ç¨‹æŸåˆ†åŒ– ä¸åŒçš„åˆ†åŒ–å¯ä»¥æ‰§è¡Œä¸åŒçš„ä»£ç ä¸”æ— é¡»ä»¥ç‰ºç‰²æ€§èƒ½ä¸ºä»£ä»· 3.2.3 èµ„æºåˆ†é… çº¿ç¨‹æŸçš„æœ¬åœ°æ‰§è¡Œä¸Šä¸‹æ–‡ä¸»è¦ç”±ä»¥ä¸‹èµ„æºç»„æˆï¼š ç¨‹åºè®¡æ•°å™¨ å¯„å­˜å™¨ å…±äº«å†…å­˜ ç”±SMå¤„ç†çš„æ¯ä¸ªçº¿ç¨‹æŸçš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œ åœ¨æ•´ä¸ªçº¿ç¨‹æŸçš„ç”Ÿå­˜æœŸä¸­æ˜¯ä¿å­˜åœ¨èŠ¯ç‰‡å†…çš„ã€‚ å› æ­¤ï¼Œ ä»ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢åˆ°å¦ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡æ²¡æœ‰æŸå¤±ã€‚ æ¯ä¸ªSMéƒ½æœ‰32ä½çš„å¯„å­˜å™¨ç»„ï¼Œ å®ƒå­˜å‚¨åœ¨å¯„å­˜å™¨æ–‡ä»¶ä¸­ï¼Œ å¹¶ä¸”å¯ä»¥åœ¨çº¿ç¨‹ä¸­è¿›è¡Œåˆ†é…ï¼Œ åŒæ—¶å›ºå®šæ•°é‡çš„å…±äº«å†…å­˜ç”¨æ¥åœ¨çº¿ç¨‹å—ä¸­è¿›è¡Œåˆ†é…ã€‚ å¯¹äºä¸€ä¸ªç»™å®šçš„å†…æ ¸ï¼Œ åŒæ—¶å­˜åœ¨äºåŒä¸€ä¸ªSMä¸­çš„çº¿ç¨‹å—å’Œçº¿ç¨‹æŸçš„æ•°é‡å–å†³äºåœ¨SMä¸­å¯ç”¨çš„ä¸”å†…æ ¸æ‰€éœ€çš„å¯„å­˜å™¨å’Œå…±äº«å†…å­˜çš„æ•°é‡ã€‚ è‹¥æ¯ä¸ªçº¿ç¨‹æ¶ˆè€—çš„å¯„å­˜å™¨è¶Šå¤šï¼Œ åˆ™å¯ä»¥æ”¾åœ¨ä¸€ä¸ªSMä¸­çš„çº¿ç¨‹æŸå°±è¶Šå°‘ã€‚ å¦‚æœå¯ä»¥å‡å°‘å†…æ ¸æ¶ˆè€—å¯„å­˜å™¨çš„æ•°é‡ï¼Œ é‚£ä¹ˆå°±å¯ä»¥åŒæ—¶å¤„ç†æ›´å¤šçš„çº¿ç¨‹æŸã€‚ è‹¥ä¸€ä¸ªçº¿ç¨‹å—æ¶ˆè€—çš„å…±äº«å†…å­˜è¶Šå¤šï¼Œ åˆ™åœ¨ä¸€ä¸ªSMä¸­å¯ä»¥è¢«åŒæ—¶å¤„ç†çš„çº¿ç¨‹å—å°±ä¼šå˜å°‘ã€‚ å¦‚æœæ¯ä¸ªçº¿ç¨‹å—ä½¿ç”¨çš„å…±äº«å†…å­˜æ•°é‡å˜å°‘ï¼Œ é‚£ä¹ˆå¯ä»¥åŒæ—¶å¤„ç†æ›´å¤šçš„çº¿ç¨‹å—ã€‚ å½“è®¡ç®—èµ„æºï¼ˆå¦‚å¯„å­˜å™¨å’Œå…±äº«å†…å­˜ï¼‰ å·²åˆ†é…ç»™çº¿ç¨‹å—æ—¶ï¼Œ çº¿ç¨‹å—è¢«ç§°ä¸ºæ´»è·ƒçš„å—ã€‚ å®ƒæ‰€åŒ…å«çš„çº¿ç¨‹æŸè¢«ç§°ä¸ºæ´»è·ƒçš„çº¿ç¨‹æŸã€‚ æ´»è·ƒçš„çº¿ç¨‹æŸå¯ä»¥è¿›ä¸€æ­¥è¢«åˆ†ä¸ºä»¥ä¸‹3ç§ç±»å‹ï¼š é€‰å®šçš„çº¿ç¨‹æŸ é˜»å¡çš„çº¿ç¨‹æŸ ç¬¦åˆæ¡ä»¶çš„çº¿ç¨‹æŸ ä¸€ä¸ªSMä¸Šçš„çº¿ç¨‹æŸè°ƒåº¦å™¨åœ¨æ¯ä¸ªå‘¨æœŸéƒ½é€‰æ‹©æ´»è·ƒçš„çº¿ç¨‹æŸï¼Œ ç„¶åæŠŠå®ƒä»¬è°ƒåº¦åˆ°æ‰§è¡Œ å•å…ƒã€‚ æ´»è·ƒæ‰§è¡Œçš„çº¿ç¨‹æŸè¢«ç§°ä¸ºé€‰å®šçš„çº¿ç¨‹æŸã€‚ å¦‚æœä¸€ä¸ªæ´»è·ƒçš„çº¿ç¨‹æŸå‡†å¤‡æ‰§è¡Œä½†å°šæœªæ‰§ è¡Œï¼Œ å®ƒæ˜¯ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„çº¿ç¨‹æŸã€‚ å¦‚æœä¸€ä¸ªçº¿ç¨‹æŸæ²¡æœ‰åšå¥½æ‰§è¡Œçš„å‡†å¤‡ï¼Œ å®ƒæ˜¯ä¸€ä¸ªé˜»å¡çš„ çº¿ç¨‹æŸã€‚ å¦‚æœåŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶åˆ™çº¿ç¨‹æŸç¬¦åˆæ‰§è¡Œæ¡ä»¶ã€‚ 32ä¸ªCUDAæ ¸å¿ƒå¯ç”¨äºæ‰§è¡Œ å½“å‰æŒ‡ä»¤ä¸­æ‰€æœ‰çš„å‚æ•°éƒ½å·²å°±ç»ª 3.2.4 å»¶è¿Ÿéšè— SMä¾èµ–çº¿ç¨‹çº§å¹¶è¡Œï¼Œ ä»¥æœ€å¤§åŒ–åŠŸèƒ½å•å…ƒçš„åˆ©ç”¨ç‡ï¼Œ å› æ­¤ï¼Œ åˆ©ç”¨ç‡ä¸å¸¸é©»çº¿ç¨‹æŸçš„æ•°é‡ç›´æ¥ç›¸å…³ã€‚ åœ¨æŒ‡ä»¤å‘å‡ºå’Œå®Œæˆä¹‹é—´çš„æ—¶é’Ÿå‘¨æœŸè¢«å®šä¹‰ä¸ºæŒ‡ä»¤å»¶è¿Ÿã€‚ å½“æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸä¸­æ‰€æœ‰çš„çº¿ç¨‹è°ƒåº¦å™¨éƒ½æœ‰ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„çº¿ç¨‹æŸæ—¶ï¼Œ å¯ä»¥è¾¾åˆ°è®¡ç®—èµ„æºçš„å®Œå…¨åˆ©ç”¨ã€‚ è¿™å°±å¯ä»¥ä¿è¯ï¼Œ é€šè¿‡åœ¨å…¶ä»–å¸¸é©»çº¿ç¨‹æŸä¸­å‘å¸ƒå…¶ä»–æŒ‡ä»¤ï¼Œ å¯ä»¥éšè—æ¯ä¸ªæŒ‡ä»¤çš„å»¶è¿Ÿã€‚ è€ƒè™‘åˆ°æŒ‡ä»¤å»¶è¿Ÿï¼Œ æŒ‡ä»¤å¯ä»¥è¢«åˆ†ä¸ºä¸¤ç§åŸºæœ¬ç±»å‹ï¼š ç®—æœ¯æŒ‡ä»¤: ä¸€ä¸ªç®—æœ¯æ“ä½œä»å¼€å§‹åˆ°å®ƒäº§ç”Ÿè¾“å‡ºä¹‹é—´çš„æ—¶é—´ï¼› å†…å­˜æŒ‡ä»¤: æŒ‡å‘é€å‡ºçš„åŠ è½½æˆ–å­˜å‚¨æ“ä½œå’Œæ•°æ®åˆ°è¾¾ç›®çš„åœ°ä¹‹é—´çš„æ—¶é—´ã€‚ ä½ å¯èƒ½æƒ³çŸ¥é“å¦‚ä½•ä¼°ç®—éšè—å»¶è¿Ÿæ‰€éœ€è¦çš„æ´»è·ƒçº¿ç¨‹æŸçš„æ•°é‡ã€‚ åˆ©ç‰¹å°”æ³•åˆ™ï¼ˆLittleâ€™s Lawï¼‰ å¯ä»¥æä¾›ä¸€ä¸ªåˆç†çš„è¿‘ä¼¼å€¼ã€‚ å®ƒèµ·æºäºé˜Ÿåˆ—ç†è®ºä¸­çš„ä¸€ä¸ªå®šç†ï¼Œ å®ƒä¹Ÿå¯ä»¥åº”ç”¨äº GPUä¸­ï¼š $$æ‰€éœ€çº¿ç¨‹æŸæ•°é‡ = å»¶è¿Ÿ \\times ååé‡$$ ååé‡å’Œå¸¦å®½ ååé‡å’Œå¸¦å®½éƒ½æ˜¯ç”¨æ¥åº¦é‡æ€§èƒ½çš„é€Ÿåº¦æŒ‡æ ‡ã€‚ å¸¦å®½é€šå¸¸æ˜¯æŒ‡ç†è®ºå³°å€¼ï¼Œ è€Œååé‡æ˜¯æŒ‡å·²è¾¾åˆ°çš„å€¼ å¸¦å®½é€šå¸¸æ˜¯ç”¨æ¥æè¿°å•ä½æ—¶é—´å†…æœ€å¤§å¯èƒ½çš„æ•°æ®ä¼ è¾“é‡ï¼Œ è€Œååé‡æ˜¯ç”¨æ¥æè¿°å•ä½æ—¶ é—´å†…ä»»ä½•å½¢å¼çš„ä¿¡æ¯æˆ–æ“ä½œçš„æ‰§è¡Œé€Ÿåº¦ï¼Œ ä¾‹å¦‚ï¼Œ æ¯ä¸ªå‘¨æœŸå®Œæˆå¤šå°‘ä¸ªæŒ‡ä»¤ã€‚ ååé‡ç”±SMä¸­æ¯ä¸ªå‘¨æœŸå†…çš„æ“ä½œæ•°é‡ç¡®å®šï¼Œ è€Œæ‰§è¡Œä¸€æ¡æŒ‡ä»¤çš„ä¸€ä¸ªçº¿ç¨‹æŸå¯¹åº”32ä¸ª æ“ä½œã€‚ è¿™ä¸ªç®€å•çš„å•ä½è½¬æ¢è¡¨æ˜ï¼Œ æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æé«˜å¹¶è¡Œï¼š æŒ‡ä»¤çº§å¹¶è¡Œï¼ˆILPï¼‰ ï¼š ä¸€ä¸ªçº¿ç¨‹ä¸­æœ‰å¾ˆå¤šç‹¬ç«‹çš„æŒ‡ä»¤ çº¿ç¨‹çº§å¹¶è¡Œï¼ˆTLPï¼‰ ï¼š å¾ˆå¤šå¹¶å‘åœ°ç¬¦åˆæ¡ä»¶çš„çº¿ç¨‹ å»¶è¿Ÿéšè—å–å†³äºæ¯ä¸ªSMä¸­æ´»è·ƒçº¿ç¨‹æŸçš„æ•°é‡ï¼Œ è¿™ä¸€æ•°é‡ç”±æ‰§è¡Œé…ç½®å’Œèµ„æºçº¦æŸéšå¼ å†³å®šï¼ˆä¸€ä¸ªå†…æ ¸ä¸­å¯„å­˜å™¨å’Œå…±äº«å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼‰ ã€‚ é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜æ‰§è¡Œé…ç½®çš„å…³é”®æ˜¯åœ¨å»¶ è¿Ÿéšè—å’Œèµ„æºåˆ©ç”¨ä¹‹é—´æ‰¾åˆ°ä¸€ç§å¹³è¡¡ã€‚ æ˜¾ç¤ºå……è¶³çš„å¹¶è¡Œ å› ä¸ºGPUåœ¨çº¿ç¨‹é—´åˆ†é…è®¡ç®—èµ„æºå¹¶åœ¨å¹¶å‘çº¿ç¨‹æŸä¹‹é—´åˆ‡æ¢çš„æ¶ˆè€—ï¼ˆåœ¨ä¸€ä¸ªæˆ–ä¸¤ä¸ªå‘¨æœŸ å‘½ä»¤ä¸Šï¼‰ å¾ˆå°ï¼Œ æ‰€ä»¥æ‰€éœ€çš„çŠ¶æ€å¯ä»¥åœ¨èŠ¯ç‰‡å†…è·å¾—ã€‚ å¦‚æœæœ‰è¶³å¤Ÿçš„å¹¶å‘æ´»è·ƒçº¿ç¨‹ï¼Œ é‚£ä¹ˆå¯ ä»¥è®©GPUåœ¨æ¯ä¸ªå‘¨æœŸå†…çš„æ¯ä¸€ä¸ªæµæ°´çº¿é˜¶æ®µä¸­å¿™ç¢Œã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ ä¸€ä¸ªçº¿ç¨‹æŸçš„å»¶è¿Ÿå¯ ä»¥è¢«å…¶ä»–çº¿ç¨‹æŸçš„æ‰§è¡Œéšè—ã€‚ å› æ­¤ï¼Œ å‘SMæ˜¾ç¤ºè¶³å¤Ÿçš„å¹¶è¡Œå¯¹æ€§èƒ½æ˜¯æœ‰åˆ©çš„ 3.2.5 å ç”¨ç‡ åœ¨æ¯ä¸ªCUDAæ ¸å¿ƒé‡ŒæŒ‡ä»¤æ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚ å½“ä¸€ä¸ªçº¿ç¨‹æŸé˜»å¡æ—¶ï¼Œ SMåˆ‡æ¢æ‰§è¡Œå…¶ä»–ç¬¦ åˆæ¡ä»¶çš„çº¿ç¨‹æŸã€‚ ç†æƒ³æƒ…å†µä¸‹ï¼Œ æˆ‘ä»¬æƒ³è¦æœ‰è¶³å¤Ÿçš„çº¿ç¨‹æŸå ç”¨è®¾å¤‡çš„æ ¸å¿ƒã€‚ å ç”¨ç‡æ˜¯æ¯ä¸ª SMä¸­æ´»è·ƒçš„çº¿ç¨‹æŸå æœ€å¤§çº¿ç¨‹æŸæ•°é‡çš„æ¯”å€¼ã€‚ $$å ç”¨ç‡ = \\frac{æ´»è·ƒçº¿ç¨‹æŸæ•°é‡}{æœ€å¤§çº¿ç¨‹æŸæ•°é‡}$$ æç«¯åœ°æ“çºµçº¿ç¨‹å—ä¼šé™åˆ¶èµ„æºçš„åˆ©ç”¨ï¼š å°çº¿ç¨‹å—ï¼š æ¯ä¸ªå—ä¸­çº¿ç¨‹å¤ªå°‘ï¼Œ ä¼šåœ¨æ‰€æœ‰èµ„æºè¢«å……åˆ†åˆ©ç”¨ä¹‹å‰å¯¼è‡´ç¡¬ä»¶è¾¾åˆ°æ¯ä¸ªSMçš„çº¿ç¨‹æŸæ•°é‡çš„é™åˆ¶ å¤§çº¿ç¨‹å—ï¼š æ¯ä¸ªå—ä¸­æœ‰å¤ªå¤šçš„çº¿ç¨‹ï¼Œ ä¼šå¯¼è‡´åœ¨æ¯ä¸ªSMä¸­æ¯ä¸ªçº¿ç¨‹å¯ç”¨çš„ç¡¬ä»¶èµ„æºè¾ƒå°‘ ç½‘æ ¼å’Œçº¿ç¨‹å—å¤§å°çš„å‡†åˆ™ ä½¿ç”¨è¿™äº›å‡†åˆ™å¯ä»¥ä½¿åº”ç”¨ç¨‹åºé€‚ç”¨äºå½“å‰å’Œå°†æ¥çš„è®¾å¤‡ï¼š ä¿æŒæ¯ä¸ªå—ä¸­çº¿ç¨‹æ•°é‡æ˜¯çº¿ç¨‹æŸå¤§å°ï¼ˆ32ï¼‰ çš„å€æ•° é¿å…å—å¤ªå°ï¼š æ¯ä¸ªå—è‡³å°‘è¦æœ‰128æˆ–256ä¸ªçº¿ç¨‹ æ ¹æ®å†…æ ¸èµ„æºçš„éœ€æ±‚è°ƒæ•´å—å¤§å° å—çš„æ•°é‡è¦è¿œè¿œå¤šäºSMçš„æ•°é‡ï¼Œ ä»è€Œåœ¨è®¾å¤‡ä¸­å¯ä»¥æ˜¾ç¤ºæœ‰è¶³å¤Ÿçš„å¹¶è¡Œ é€šè¿‡å®éªŒå¾—åˆ°æœ€ä½³æ‰§è¡Œé…ç½®å’Œèµ„æºä½¿ç”¨æƒ…å†µ å ç”¨ç‡å”¯ä¸€æ³¨é‡çš„æ˜¯åœ¨æ¯ä¸ªSMä¸­å¹¶å‘çº¿ç¨‹æˆ–çº¿ ç¨‹æŸçš„æ•°é‡ã€‚ ç„¶è€Œï¼Œ å……åˆ†çš„å ç”¨ç‡ä¸æ˜¯æ€§èƒ½ä¼˜åŒ–çš„å”¯ä¸€ç›®æ ‡ã€‚ å†…æ ¸ä¸€æ—¦è¾¾åˆ°ä¸€å®šçº§åˆ«çš„å  ç”¨ç‡ï¼Œ è¿›ä¸€æ­¥å¢åŠ å ç”¨ç‡å¯èƒ½ä¸ä¼šæ”¹è¿›æ€§èƒ½ã€‚ ä¸ºäº†æé«˜æ€§èƒ½ï¼Œ å¯ä»¥è°ƒæ•´å¾ˆå¤šå…¶ä»–å› ç´ ã€‚ 3.2.6 åŒæ­¥ åœ¨CUDAä¸­ï¼Œ åŒæ­¥å¯ä»¥åœ¨ä¸¤ä¸ªçº§åˆ«æ‰§è¡Œï¼š ç³»ç»Ÿçº§ï¼š ç­‰å¾…ä¸»æœºå’Œè®¾å¤‡å®Œæˆæ‰€æœ‰çš„å·¥ä½œ å—çº§ï¼š åœ¨è®¾å¤‡æ‰§è¡Œè¿‡ç¨‹ä¸­ç­‰å¾…ä¸€ä¸ªçº¿ç¨‹å—ä¸­æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾åŒä¸€ç‚¹ å¯¹äºä¸»æœºæ¥è¯´ï¼š cudaError_t cudaDeviceSynchronize(void):cudaDeviceSyn-chronizeå‡½æ•°å¯ä»¥ç”¨æ¥é˜»å¡ä¸»æœºåº”ç”¨ç¨‹åºï¼Œ ç›´åˆ°æ‰€æœ‰çš„CUDAæ“ä½œï¼ˆå¤åˆ¶ã€æ ¸å‡½æ•°ç­‰ï¼‰ å®Œæˆ; __device__ void __syncthreads(void);:CUDAæä¾›äº†ä¸€ä¸ªä½¿ç”¨å—å±€éƒ¨æ …æ æ¥åŒæ­¥å®ƒä»¬çš„æ‰§è¡Œçš„åŠŸèƒ½ã€‚ å½“__syncthreadsè¢«è°ƒç”¨æ—¶ï¼Œ åœ¨åŒä¸€ä¸ªçº¿ç¨‹å—ä¸­æ¯ä¸ªçº¿ç¨‹éƒ½å¿…é¡»ç­‰å¾…ç›´è‡³è¯¥çº¿ç¨‹å—ä¸­æ‰€æœ‰å…¶ä»–çº¿ç¨‹éƒ½å·²ç»è¾¾åˆ°è¿™ä¸ªåŒæ­¥ç‚¹ã€‚ çº¿ç¨‹å—ä¸­çš„çº¿ç¨‹å¯ä»¥é€šè¿‡å…±äº«å†…å­˜å’Œå¯„å­˜å™¨æ¥å…±äº«æ•°æ®ã€‚ åœ¨ä¸åŒçš„å—ä¹‹é—´æ²¡æœ‰çº¿ç¨‹åŒæ­¥ã€‚ å—é—´åŒæ­¥ï¼Œ å”¯ä¸€å®‰å…¨çš„æ–¹æ³•æ˜¯åœ¨æ¯ä¸ªå†…æ ¸æ‰§è¡Œç»“æŸç«¯ä½¿ç”¨å…¨å±€åŒæ­¥ç‚¹ï¼› ä¹Ÿå°±æ˜¯è¯´ï¼Œ åœ¨å…¨å±€åŒæ­¥ä¹‹åï¼Œ ç»ˆæ­¢å½“å‰çš„æ ¸å‡½æ•°ï¼Œ å¼€å§‹æ‰§è¡Œæ–°çš„æ ¸å‡½æ•°ã€‚ ä¸åŒå—ä¸­çš„çº¿ç¨‹ä¸å…è®¸ç›¸äº’åŒæ­¥ï¼Œ å› æ­¤GPUå¯ä»¥ä»¥ä»»æ„é¡ºåºæ‰§è¡Œå—ã€‚ è¿™ä½¿å¾—CUDAç¨‹åºåœ¨å¤§è§„æ¨¡å¹¶è¡ŒGPUä¸Šæ˜¯å¯æ‰©å±•çš„ã€‚ 3.2.7 å¯æ‰©å±•æ€§ å¯¹äºä»»ä½•å¹¶è¡Œåº”ç”¨ç¨‹åºè€Œè¨€ï¼Œ å¯æ‰©å±•æ€§æ˜¯ä¸€ä¸ªç†æƒ³çš„ç‰¹æ€§ã€‚ å¯æ‰©å±•æ€§æ„å‘³ç€ä¸ºå¹¶è¡Œåº”ç”¨ç¨‹åºæä¾›äº†é¢å¤–çš„ç¡¬ä»¶èµ„æºï¼Œ ç›¸å¯¹äºå¢åŠ çš„èµ„æºï¼Œ å¹¶è¡Œåº”ç”¨ç¨‹åºä¼šäº§ç”ŸåŠ é€Ÿã€‚ ä¾‹å¦‚ï¼Œ è‹¥ä¸€ä¸ªCUDAç¨‹åºåœ¨ä¸¤ä¸ªSMä¸­æ˜¯å¯æ‰©å±•çš„ï¼Œ åˆ™ä¸åœ¨ä¸€ä¸ªSMä¸­è¿è¡Œç›¸æ¯”ï¼Œ åœ¨ä¸¤ä¸ªSMä¸­è¿è¡Œä¼šä½¿è¿è¡Œæ—¶é—´å‡åŠã€‚ ä¸€ä¸ªå¯æ‰©å±•çš„å¹¶è¡Œç¨‹åºå¯ä»¥é«˜æ•ˆåœ°ä½¿ç”¨æ‰€æœ‰çš„è®¡ç®—èµ„æºä»¥æé«˜æ€§èƒ½ã€‚ å¯æ‰©å±•æ€§æ„å‘³ç€å¢åŠ çš„è®¡ç®—æ ¸å¿ƒå¯ä»¥æé«˜æ€§èƒ½ã€‚ ä¸²è¡Œä»£ç æœ¬èº«æ˜¯ä¸å¯æ‰©å±•çš„ï¼Œ å› ä¸ºåœ¨æˆåƒä¸Šä¸‡çš„å†…æ ¸ä¸Šè¿è¡Œä¸€ä¸ªä¸²è¡Œå•çº¿ç¨‹åº”ç”¨ç¨‹åºï¼Œ å¯¹æ€§èƒ½æ˜¯æ²¡æœ‰å½±å“çš„ã€‚ å¹¶è¡Œä»£ç æœ‰å¯æ‰©å±•çš„æ½œèƒ½ï¼Œ ä½†çœŸæ­£çš„å¯æ‰©å±•æ€§å–å†³äºç®—æ³•è®¾è®¡å’Œç¡¬ä»¶ç‰¹æ€§ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda_03/:1:2","tags":["CUDA"],"title":"CUDA_C_NOTES [3]","uri":"/posts/cuda_03/"},{"categories":["GPU"],"content":"3.3 å¹¶è¡Œæ€§çš„è¡¨ç° ","date":"2023-07-12","objectID":"/posts/cuda_03/:1:3","tags":["CUDA"],"title":"CUDA_C_NOTES [3]","uri":"/posts/cuda_03/"},{"categories":["GPU"],"content":"3.6 åŠ¨æ€å¹¶è¡Œ åœ¨æœ¬ä¹¦ä¸­ï¼Œ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œ æ‰€æœ‰æ ¸å‡½æ•°éƒ½æ˜¯ä»ä¸»æœºçº¿ç¨‹ä¸­è¢«è°ƒç”¨çš„ã€‚ GPUçš„å·¥ä½œè´Ÿè½½å®Œ å…¨åœ¨CPUçš„æ§åˆ¶ä¸‹ã€‚ CUDAçš„åŠ¨æ€å¹¶è¡Œå…è®¸åœ¨GPUç«¯ç›´æ¥åˆ›å»ºå’ŒåŒæ­¥æ–°çš„GPUå†…æ ¸ã€‚ åœ¨ä¸€ ä¸ªæ ¸å‡½æ•°ä¸­åœ¨ä»»æ„ç‚¹åŠ¨æ€å¢åŠ GPUåº”ç”¨ç¨‹åºçš„å¹¶è¡Œæ€§ï¼Œ æ˜¯ä¸€ä¸ªä»¤äººå…´å¥‹çš„æ–°åŠŸèƒ½ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda_03/:1:4","tags":["CUDA"],"title":"CUDA_C_NOTES [3]","uri":"/posts/cuda_03/"},{"categories":["GPU"],"content":"CH02 CUDAç¼–ç¨‹æ¨¡å‹ ","date":"2023-07-12","objectID":"/posts/cuda_02/:1:0","tags":["CUDA"],"title":"CUDA_C_NOTES [2]","uri":"/posts/cuda_02/"},{"categories":["GPU"],"content":"2.1 CUDAç¼–ç¨‹æ¨¡å‹æ¦‚è¿° CUDAç¼–ç¨‹æ¨¡å‹æä¾›äº†ä¸€ä¸ªè®¡ç®—æœºæ¶æ„æŠ½è±¡ä½œä¸ºåº”ç”¨ç¨‹åºå’Œå…¶å¯ç”¨ç¡¬ä»¶ä¹‹é—´çš„æ¡¥æ¢ã€‚ CUDAç¼–ç¨‹æ¨¡å‹è¿˜åˆ©ç”¨GPUæ¶æ„çš„è®¡ç®—èƒ½åŠ›æä¾›äº†ä»¥ä¸‹å‡ ä¸ªç‰¹æœ‰åŠŸèƒ½: ä¸€ç§é€šè¿‡å±‚æ¬¡ç»“æ„åœ¨GPUä¸­ç»„ç»‡çº¿ç¨‹çš„æ–¹æ³•(2.3) ä¸€ç§é€šè¿‡å±‚æ¬¡ç»“æ„åœ¨GPUä¸­è®¿é—®å†…å­˜çš„æ–¹æ³•(4.5) ç¨‹åºå‘˜å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ä¸ªä¸åŒå±‚é¢æ¥çœ‹å¾…å¹¶è¡Œè®¡ç®—: é¢†åŸŸå±‚ï¼šå¦‚ä½•è§£ææ•°æ®å’Œå‡½æ•°ï¼Œä»¥ä¾¿åœ¨å¹¶è¡Œç¯å¢ƒä¸­æ­£ç¡®é«˜æ•ˆçš„è§£å†³é—®é¢˜ï¼ˆåœ¨å¹¶è¡Œç¼–ç¨‹ä¸­é«˜æ•ˆçš„ä½¿ç”¨pthreadsæˆ–è€…OpemMPæŠ€æœ¯æ˜¾å¼åœ°ç®¡ç†çº¿ç¨‹ï¼‰ é€»è¾‘å±‚ï¼šå¦‚ä½•ç»„ç»‡å¹¶å‘çº¿ç¨‹ ç¡¬ä»¶å±‚ï¼šç†è§£çº¿ç¨‹å¦‚ä½•æ˜ å°„åˆ°æ ¸å¿ƒä»¥å¸®åŠ©æé«˜å…¶æ€§èƒ½ ","date":"2023-07-12","objectID":"/posts/cuda_02/:1:1","tags":["CUDA"],"title":"CUDA_C_NOTES [2]","uri":"/posts/cuda_02/"},{"categories":["GPU"],"content":"2.1.1 CUDAç¼–ç¨‹ åœ¨ä¸€ä¸ªå¼‚æ„ç¯å¢ƒä¸­åŒ…å«å¤šä¸ªCPUå’ŒGPUï¼Œ æ¯ä¸ªGPUå’ŒCPUçš„å†…å­˜éƒ½ç”±ä¸€æ¡PCI-Expressæ€»çº¿åˆ†éš”å¼€ã€‚ ä¸»æœºï¼š CPUåŠå…¶å†…å­˜ï¼ˆä¸»æœºå†…å­˜ï¼‰ è®¾å¤‡ï¼š GPUåŠå…¶å†…å­˜ï¼ˆè®¾å¤‡å†…å­˜ï¼‰ â€œç»Ÿä¸€å¯»å€â€ï¼ˆUnified Memoryï¼‰ çš„ç¼–ç¨‹æ¨¡å‹çš„æ”¹è¿›ï¼Œ å®ƒè¿æ¥äº†ä¸»æœºå†…å­˜å’Œè®¾å¤‡å†…å­˜ç©ºé—´ï¼Œ å¯ä½¿ç”¨å•ä¸ªæŒ‡é’ˆè®¿é—®CPUå’ŒGPUå†…å­˜ï¼Œ æ— é¡»å½¼æ­¤ä¹‹é—´æ‰‹åŠ¨æ‹·è´æ•°æ®ã€‚ ä»€ä¹ˆæ˜¯â€œç»Ÿä¸€å¯»å€â€ï¼ˆUnified Memory)? CUDA 6.0æå‡ºäº†ç»Ÿä¸€å¯»å€ï¼Œ ä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæ¥è®¿é—®CPUå’ŒGPUçš„å†…å­˜ã€‚(è¯¦è§ç¬¬4ç« ) å†…æ ¸ï¼ˆkernelï¼‰ æ˜¯CUDAç¼–ç¨‹æ¨¡å‹çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œ å…¶ä»£ç åœ¨GPUä¸Šè¿è¡Œã€‚ CUDAç¼–ç¨‹æ¨¡å‹ä¸»è¦æ˜¯å¼‚æ­¥çš„ï¼Œ å› æ­¤åœ¨GPUä¸Šè¿›è¡Œçš„è¿ç®—å¯ä»¥ä¸ä¸»æœº-è®¾å¤‡é€šä¿¡é‡å ã€‚ ä¸€ä¸ªå…¸å‹çš„CUDAç¨‹åºåŒ… æ‹¬ç”±å¹¶è¡Œä»£ç äº’è¡¥çš„ä¸²è¡Œä»£ç ã€‚ ä¸²è¡Œä»£ç åœ¨cpuä¸Šæ‰§è¡Œï¼Œå¹¶è¡Œä»£ç åœ¨GPUä¸Šæ‰§è¡Œã€‚ ä¸€ä¸ªå…¸å‹çš„CUDAç¨‹åºå®ç°æµç¨‹éµå¾ªä»¥ä¸‹æ¨¡å¼ï¼š æŠŠæ•°æ®ä»CPUå†…å­˜æ‹·è´åˆ°GPUå†…å­˜ï¼› è°ƒç”¨æ ¸å‡½æ•°å¯¹å­˜å‚¨åœ¨GPUå†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œæ“ä½œï¼› å°†æ•°æ®ä»GPUå†…å­˜ä¼ é€å›åˆ°CPUå†…å­˜ã€‚ 2.1.2 å†…å­˜ç®¡ç† CUDAè¿è¡Œæ—¶è´Ÿè´£åˆ†é…ä¸é‡Šæ”¾è®¾å¤‡å†…å­˜ï¼Œ å¹¶ä¸”åœ¨ä¸»æœºå†…å­˜å’Œè®¾å¤‡å†…å­˜ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚ è¡¨2-1 ä¸»æœºå’Œè®¾å¤‡å†…å­˜å‡½æ•° æ ‡å‡†cå‡½æ•° CUDA Cå‡½æ•° æ ‡å‡†cå‡½æ•° CUDA Cå‡½æ•° malloc cudaMalloc memset cudaMemset memcpy cudaMemcpy free cudaFree cudaMallocå‡½æ•°è´Ÿè´£åœ¨GPUçš„å†…å­˜é‡Œåˆ†é…å†…å­˜ï¼› cudaMemcpyå‡½æ•°è´Ÿè´£ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼› cudaError_t cudaMemcpy(void* dst, const void* src, size_t count, cudaMemcpyKind kind) ä»srcæŒ‡å‘çš„æºå­˜å‚¨åŒºå¤åˆ¶ä¸€å®šæ•°é‡çš„å­—èŠ‚åˆ°dstæŒ‡å‘çš„ç›®æ ‡å­˜å‚¨åŒº kindæœ‰ä»¥ä¸‹å‡ ç§: cudaMemcpyHostToHost cudaMemcpyHostToDevice cudaMemcpyDeviceToHost cudaMemcpyDeviceToDevice CUDAç¼–ç¨‹æ¨¡å‹ä»GPUæ¶æ„ä¸­æŠ½è±¡å‡ºä¸€ä¸ªå†…å­˜å±‚æ¬¡ç»“æ„ï¼šå…¨å±€å†…å­˜å’Œå…±äº«å†…å­˜ã€‚ å†…å­˜å±‚æ¬¡ç»“æ„ å…¨å±€å†…å­˜ å…±äº«å†…å­˜ ä¸ºä»€ä¹ˆCPUå’ŒGPUæ˜¯å¼‚æ­¥çš„ï¼Ÿ å½“æ•°æ®è¢«è½¬ç§»åˆ°GPUçš„å…¨å±€å†…å­˜åï¼Œ ä¸»æœºç«¯è°ƒç”¨æ ¸å‡½æ•°åœ¨GPUä¸Šè¿›è¡Œæ•°ç»„æ±‚å’Œã€‚ ä¸€æ—¦å†…æ ¸è¢«è°ƒç”¨ï¼Œ æ§åˆ¶æƒç«‹åˆ»è¢«ä¼ å›ä¸»æœºï¼Œ è¿™æ ·çš„è¯ï¼Œ å½“æ ¸å‡½æ•°åœ¨GPUä¸Šè¿è¡Œæ—¶ï¼Œ ä¸»æœºå¯ä»¥æ‰§è¡Œå…¶ä»–å‡½æ•°ã€‚ å› æ­¤ï¼Œ å†…æ ¸ä¸ä¸»æœºæ˜¯å¼‚æ­¥çš„ã€‚ ä¸åŒçš„å­˜å‚¨ç©ºé—´ 2.1.3 çº¿ç¨‹ç®¡ç† å½“æ ¸å‡½æ•°åœ¨ä¸»æœºç«¯å¯åŠ¨æ—¶ï¼Œ å®ƒçš„æ‰§è¡Œä¼šç§»åŠ¨åˆ°è®¾å¤‡ä¸Šï¼Œ æ­¤æ—¶è®¾å¤‡ä¸­ä¼šäº§ç”Ÿå¤§é‡çš„çº¿ç¨‹å¹¶ä¸”æ¯ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œç”±æ ¸å‡½æ•°æŒ‡å®šçš„è¯­å¥ã€‚ ç”±ä¸€ä¸ªå†…æ ¸å¯åŠ¨æ‰€äº§ç”Ÿçš„æ‰€æœ‰çº¿ç¨‹ç»Ÿç§°ä¸ºä¸€ä¸ªç½‘æ ¼ã€‚ åŒä¸€ç½‘æ ¼ä¸­çš„æ‰€æœ‰çº¿ç¨‹å…±äº«ç›¸åŒçš„å…¨å±€å†…å­˜ç©ºé—´ã€‚ ä¸€ä¸ªç½‘æ ¼ç”±å¤šä¸ªçº¿ç¨‹å—æ„æˆï¼Œ ä¸€ä¸ªçº¿ç¨‹å—åŒ…å«ä¸€ç»„çº¿ç¨‹ï¼Œ åŒä¸€çº¿ç¨‹å—å†…çš„çº¿ç¨‹åä½œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥å®ç°ï¼š åŒæ­¥ å…±äº«å†…å­˜ ä¸åŒçº¿ç¨‹å—å†…çš„çº¿ç¨‹ä¸èƒ½åä½œã€‚ çº¿ç¨‹ä¾é ä»¥ä¸‹ä¸¤ä¸ªåæ ‡å˜é‡æ¥åŒºåˆ†å½¼æ­¤ blockIdx(çº¿ç¨‹å—åœ¨çº¿ç¨‹æ ¼å†…çš„ç´¢å¼•) threadIdx(å—å†…çš„çº¿ç¨‹ç´¢å¼•) äº›å˜é‡æ˜¯æ ¸å‡½æ•°ä¸­éœ€è¦é¢„åˆå§‹åŒ–çš„å†…ç½®å˜é‡ã€‚ å½“æ‰§è¡Œä¸€ä¸ªæ ¸å‡½æ•°æ—¶ï¼Œ CUDAè¿è¡Œæ—¶ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…åæ ‡å˜é‡blockIdxå’ŒthreadIdxã€‚ åŸºäºè¿™äº›åæ ‡ï¼Œ ä½ å¯ä»¥å°†éƒ¨åˆ†æ•°æ®åˆ†é…ç»™ä¸åŒçš„çº¿ç¨‹ã€‚ è¯¥åæ ‡å˜é‡æ˜¯åŸºäºuint3å®šä¹‰çš„CUDAå†…ç½®çš„å‘é‡ç±»å‹ï¼Œ æ˜¯ä¸€ä¸ªåŒ…å«3ä¸ªæ— ç¬¦å·æ•´æ•°çš„ç»“æ„ï¼Œ å¯ä»¥é€šè¿‡xã€ yã€ zä¸‰ä¸ªå­—æ®µæ¥æŒ‡å®šï¼š blockIdx.x blockIdx.y blockIdx.z threadIdx.x threadIdx.y threadIdx.z CUDAå¯ä»¥ç»„ç»‡ä¸‰ç»´çš„ç½‘æ ¼å’Œå—. ç½‘æ ¼å’Œå—çš„ç»´åº¦ç”±ä¸‹åˆ—ä¸¤ä¸ªå†…ç½®å˜é‡æŒ‡å®š: blockDim(çº¿ç¨‹å—çš„ç»´åº¦ï¼Œ ç”¨æ¯ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹æ•°æ¥è¡¨ç¤º) gridDim(çº¿ç¨‹æ ¼çš„ç»´åº¦ï¼Œ ç”¨æ¯ä¸ªçº¿ç¨‹æ ¼ä¸­çš„çº¿ç¨‹æ•°æ¥è¡¨ç¤º) å®ƒä»¬æ˜¯dim3ç±»å‹çš„å˜é‡ï¼Œ æ˜¯åŸºäºuint3å®šä¹‰çš„æ•´æ•°å‹å‘é‡ï¼Œ ç”¨æ¥è¡¨ç¤ºç»´åº¦ã€‚ å½“å®šä¹‰ä¸€ä¸ªdim3ç±»å‹çš„å˜é‡æ—¶ï¼Œ æ‰€æœ‰æœªæŒ‡å®šçš„å…ƒç´ éƒ½è¢«åˆå§‹åŒ–ä¸º1ã€‚ dim3ç±»å‹å˜é‡ä¸­çš„æ¯ä¸ªç»„ä»¶å¯ä»¥é€šè¿‡å®ƒçš„xã€ yã€ zå­—æ®µè·å¾—ã€‚ å¦‚ä¸‹æ‰€ç¤º: blockDim.x blockDim.y blockDim.z ç½‘æ ¼å’Œçº¿ç¨‹å—çš„ç»´åº¦ ä¸€ä¸ªçº¿ç¨‹æ ¼ä¼šè¢«ç»„ç»‡æˆçº¿ç¨‹å—çš„äºŒç»´æ•°ç»„å½¢å¼ï¼Œ ä¸€ä¸ªçº¿ç¨‹å—ä¼šè¢«ç»„ç»‡æˆçº¿ç¨‹çš„ä¸‰ç»´æ•°ç»„å½¢å¼ åœ¨CUDAç¨‹åºä¸­æœ‰ä¸¤ç»„ä¸åŒçš„ç½‘æ ¼å’Œå—å˜é‡ï¼š æ‰‹åŠ¨å®šä¹‰çš„dim3æ•°æ®ç±»å‹å’Œé¢„å®šä¹‰çš„uint3æ•°æ®ç±»å‹ã€‚ æ‰‹åŠ¨å®šä¹‰çš„dim3ç±»å‹çš„ç½‘æ ¼å’Œå—å˜é‡ä»…åœ¨ä¸»æœºç«¯å¯è§ï¼Œ è€Œunit3ç±»å‹çš„å†…ç½®é¢„åˆå§‹åŒ–çš„ç½‘æ ¼å’Œå—å˜é‡ä»…åœ¨è®¾å¤‡ç«¯å¯è§ã€‚ ä»ä¸»æœºç«¯å’Œè®¾å¤‡ç«¯è®¿é—®ç½‘æ ¼/å—å˜é‡ åŒºåˆ†ä¸»æœºç«¯å’Œè®¾å¤‡ç«¯çš„ç½‘æ ¼å’Œå—å˜é‡çš„è®¿é—®æ˜¯å¾ˆé‡è¦çš„ã€‚ ä¾‹å¦‚ï¼Œ å£°æ˜ä¸€ä¸ªä¸»æœºç«¯çš„å—å˜é‡ï¼Œ ä½ æŒ‰å¦‚ä¸‹å®šä¹‰å®ƒçš„åæ ‡å¹¶å¯¹å…¶è¿›è¡Œè®¿é—®ï¼š block.x, block.y, block.z åœ¨è®¾å¤‡ç«¯ï¼Œ ä½ å·²ç»é¢„å®šä¹‰äº†å†…ç½®å—å˜é‡çš„å¤§å°ï¼š blockDim.x, blockDim.y, and blockDim.z åœ¨å¯åŠ¨å†…æ ¸ä¹‹å‰å°±å®šä¹‰äº†ä¸»æœºç«¯çš„ç½‘æ ¼å’Œå—å˜é‡ï¼Œ å¹¶ä»ä¸»æœºç«¯é€šè¿‡ç”±xã€ yã€ zä¸‰ä¸ªå­—æ®µå†³å®šçš„çŸ¢é‡ç»“æ„æ¥è®¿é—®å®ƒä»¬ã€‚ å½“å†…æ ¸å¯åŠ¨æ—¶ï¼Œ å¯ä»¥ä½¿ç”¨å†…æ ¸ä¸­é¢„åˆå§‹åŒ–çš„å†…ç½®å˜é‡ã€‚ æ€»ä¹‹ï¼Œ åœ¨å¯åŠ¨å†…æ ¸ä¹‹å‰å°±å®šä¹‰äº†ä¸»æœºç«¯çš„ç½‘æ ¼å’Œå—å˜é‡ï¼Œ å¹¶ä»ä¸»æœºç«¯é€šè¿‡ç”±xã€ yã€ zä¸‰ä¸ªå­—æ®µå†³å®šçš„çŸ¢é‡ç»“æ„æ¥è®¿é—®å®ƒä»¬ã€‚ å½“å†…æ ¸å¯åŠ¨æ—¶ï¼Œ å¯ä»¥ä½¿ç”¨å†…æ ¸ä¸­é¢„åˆå§‹åŒ–çš„å†…ç½®å˜é‡. å¯¹äºä¸€ä¸ªç»™å®šçš„æ•°æ®å¤§å°ï¼Œ ç¡®å®šç½‘æ ¼å’Œå—å°ºå¯¸çš„ä¸€èˆ¬æ­¥éª¤ä¸ºï¼š ç¡®å®šå—çš„å¤§å° åœ¨å·²çŸ¥æ•°æ®å¤§å°å’Œå—å¤§å°çš„åŸºç¡€ä¸Šè®¡ç®—ç½‘æ ¼ç»´åº¦ è¦ç¡®å®šå—å°ºå¯¸ï¼Œ é€šå¸¸éœ€è¦è€ƒè™‘ï¼š å†…æ ¸çš„æ€§èƒ½ç‰¹æ€§ GPUèµ„æºçš„é™åˆ¶ çº¿ç¨‹å±‚æ¬¡ç»“æ„ CUDAçš„ç‰¹ç‚¹ä¹‹ä¸€å°±æ˜¯é€šè¿‡ç¼–ç¨‹æ¨¡å‹æ­ç¤ºäº†ä¸€ä¸ªä¸¤å±‚çš„çº¿ç¨‹å±‚æ¬¡ç»“æ„ï¼ˆgrid-\u003eblock-\u003ethreadï¼‰ã€‚ ç”±äºä¸€ä¸ªå†…æ ¸ å¯åŠ¨çš„ç½‘æ ¼å’Œå—çš„ç»´æ•°ä¼šå½±å“æ€§èƒ½ï¼Œ è¿™ä¸€ç»“æ„ä¸ºç¨‹åºå‘˜ä¼˜åŒ–ç¨‹åºæä¾›äº†ä¸€ä¸ªé¢å¤–çš„é€”å¾„ã€‚ 2.1.4 å¯åŠ¨ä¸€ä¸ªCUDAæ ¸å‡½æ•° CUDAå†…æ ¸è°ƒç”¨æ˜¯å¯¹Cè¯­è¨€å‡½æ•°è°ƒç”¨è¯­å¥çš„å»¶ä¼¸ï¼Œ Â«\u003cÂ»\u003eè¿ç®—ç¬¦å†…æ˜¯æ ¸å‡½æ•°çš„æ‰§è¡Œé…ç½®ã€‚ kernel_name \u003c\u003c\u003cgrid, block\u003e\u003e\u003e(argument list) åˆ©ç”¨æ‰§è¡Œé…ç½®å¯ä»¥æŒ‡å®šçº¿ç¨‹åœ¨GPUä¸Šè°ƒåº¦è¿è¡Œçš„æ–¹å¼ã€‚ æ‰§è¡Œé…ç½®çš„ç¬¬ä¸€ä¸ªå€¼æ˜¯ç½‘æ ¼ç»´åº¦ï¼Œ ä¹Ÿå°±æ˜¯å¯åŠ¨å—çš„æ•°ç›®ã€‚ ç¬¬äºŒä¸ªå€¼æ˜¯å—ç»´åº¦ï¼Œ ä¹Ÿå°±æ˜¯æ¯ä¸ªå—ä¸­çº¿ç¨‹çš„æ•°ç›®ã€‚ é€šè¿‡æŒ‡å®šç½‘æ ¼å’Œå—çš„ç»´åº¦ï¼Œ ä½ å¯ä»¥è¿›è¡Œä»¥ä¸‹ é…ç½®ï¼š å†…æ ¸ä¸­çº¿ç¨‹çš„æ•°ç›® å†…æ ¸ä¸­ä½¿ç”¨çš„çº¿ç¨‹å¸ƒå±€ åŒä¸€ä¸ªå—(block)ä¸­çš„çº¿ç¨‹ä¹‹é—´å¯ä»¥ç›¸äº’åä½œï¼Œ ä¸åŒå—å†…çš„çº¿ç¨‹ä¸èƒ½åä½œã€‚ å‡è®¾ä½ æœ‰32ä¸ªæ•°æ®å…ƒç´ ç”¨äºè®¡ç®—ï¼Œ æ¯8ä¸ªå…ƒç´ ä¸€ä¸ªå—ï¼Œ éœ€è¦å¯åŠ¨4ä¸ªå—ï¼š kernel_name\u003c\u003c\u003c4, 8\u003e\u003e\u003e(argument list) ç”±äºæ•°æ®åœ¨å…¨å±€å†…å­˜ä¸­æ˜¯çº¿æ€§å­˜å‚¨çš„ï¼Œ å› æ­¤å¯ä»¥ç”¨å˜é‡blockIdx.xå’ŒthreadId.xæ¥è¿›è¡Œä»¥ä¸‹æ“ä½œã€‚ åœ¨ç½‘æ ¼ä¸­æ ‡è¯†ä¸€ä¸ªå”¯ä¸€çš„çº¿ç¨‹ å»ºç«‹çº¿ç¨‹å’Œæ•°æ®å…ƒç´ ä¹‹é—´çš„æ˜ å°„å…³ç³» å¦‚æœæŠŠæ‰€æœ‰32ä¸ªå…ƒç´ æ”¾åˆ°ä¸€ä¸ªå—é‡Œï¼Œ é‚£ä¹ˆåªä¼šå¾—åˆ°ä¸€ä¸ªå—: kernel_name\u003c\u003c\u003c1, 32\u003e\u003e\u003e(argument list) å¦‚æœæ¯ä¸ªå—åªå«æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œ é‚£ä¹ˆä¼šæœ‰32ä¸ªå—ï¼š kernel_name\u003c\u003c\u003c32, 1\u003e\u003e\u003e(argument list) æ ¸å‡½æ•°çš„è°ƒç”¨ä¸ä¸»æœºçº¿ç¨‹æ˜¯å¼‚æ­¥çš„ã€‚ æ ¸å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œ æ§åˆ¶æƒç«‹åˆ»è¿”å›ç»™ä¸»æœºç«¯. ä½ å¯ä»¥è°ƒç”¨ä»¥ä¸‹å‡½æ•°æ¥å¼ºåˆ¶ä¸»æœºç«¯ç¨‹åºç­‰å¾…æ‰€æœ‰çš„æ ¸å‡½æ•°æ‰§è¡Œç»“æŸï¼š cudaError_t cudaDeivceSynchronize(void); ä¸€äº›CUDAè¿è¡Œæ—¶APIåœ¨ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´æ˜¯éšå¼åŒæ­¥çš„ã€‚ å½“ä½¿ç”¨cudaMemcpyå‡½æ•°åœ¨ä¸» æœºå’Œè®¾å¤‡ä¹‹é—´æ‹·è´æ•°æ®æ—¶ï¼Œ ä¸»æœºç«¯éšå¼åŒæ­¥ï¼Œ å³ä¸»æœºç«¯ç¨‹åºå¿…é¡»ç­‰å¾…æ•°æ®æ‹·è´å®Œæˆåæ‰èƒ½ ç»§ç»­æ‰§è¡Œç¨‹åºã€‚ å¼‚æ­¥è¡Œä¸º ä¸åŒäºCè¯­è¨€çš„å‡½æ•°è°ƒç”¨ï¼Œ æ‰€æœ‰çš„CUDAæ ¸å‡½æ•°çš„å¯åŠ¨éƒ½æ˜¯å¼‚æ­¥çš„ã€‚ CUDAå†…æ ¸è°ƒç”¨å®Œæˆåï¼Œ æ§åˆ¶æƒç«‹åˆ»è¿”å›ç»™CPUã€‚ 2.1.5 ç¼–å†™æ ¸å‡½æ•° æ ¸å‡½æ•°æ˜¯åœ¨è®¾å¤‡ç«¯æ‰§è¡Œçš„ä»£ç ã€‚ ç”¨__global__å£°æ˜å®šä¹‰æ ¸å‡½æ•°: __global__ void kernel_name(argument list); æ ¸å‡½æ•°å¿…é¡»æœ‰ä¸€ä¸ªvoidè¿”å›ç±»å‹ã€‚ è¡¨2-2æ€»ç»“äº†CUDA Cç¨‹åºä¸­çš„å‡½æ•°ç±»å‹é™å®šç¬¦ é™å®šç¬¦ æ‰§è¡Œ è°ƒç”¨ å¤‡æ³¨ global device host CUDAæ ¸å‡½æ•°çš„é™åˆ¶ ä»¥ä¸‹é™åˆ¶é€‚ç”¨äºæ‰€æœ‰æ ¸å‡½æ•°: åªèƒ½è®¿é—®è®¾å¤‡å†…å­˜ å¿…é¡»å…·æœ‰voidè¿”å›ç±»å‹ ä¸æ”¯æŒå¯å˜æ•°é‡çš„å‚æ•° ä¸æ”¯æŒé™æ€å˜é‡ æ˜¾ç¤ºå¼‚æ­¥è¡Œä¸º ","date":"2023-07-12","objectID":"/posts/cuda_02/:1:2","tags":["CUDA"],"title":"CUDA_C_NOTES [2]","uri":"/posts/cuda_02/"},{"categories":["GPU"],"content":"2.3 ç»„ç»‡å¹¶è¡Œçº¿ç¨‹ (ä»¥é˜…è¯»ä¸ºä¸») ä»å‰é¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œ å¦‚æœä½¿ç”¨äº†åˆé€‚çš„ç½‘æ ¼å’Œå—å¤§å°æ¥æ­£ç¡®åœ°ç»„ç»‡çº¿ç¨‹ï¼Œ é‚£ä¹ˆå¯ä»¥å¯¹å†…æ ¸æ€§èƒ½äº§ç”Ÿå¾ˆå¤§çš„å½±å“ã€‚ 2.3.1 ä½¿ç”¨å—å’Œçº¿ç¨‹å»ºç«‹çŸ©é˜µç´¢å¼• åœ¨ä¸€ä¸ªçŸ©é˜µåŠ æ³•æ ¸å‡½æ•°ä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹é€šå¸¸è¢«åˆ†é…ä¸€ä¸ªæ•°æ®å…ƒç´ æ¥å¤„ç†ã€‚é¦–å…ˆè¦å®Œæˆçš„ä»»åŠ¡æ˜¯ä½¿ç”¨å—å’Œçº¿ç¨‹ç´¢å¼•ä»å…¨å±€å†…å­˜ä¸­è®¿é—®æŒ‡å®šçš„æ•°æ®ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda_02/:1:3","tags":["CUDA"],"title":"CUDA_C_NOTES [2]","uri":"/posts/cuda_02/"},{"categories":["GPU"],"content":"Ch01 åŸºäºCUDAçš„å¼‚æ„å¹¶è¡Œè®¡ç®— ","date":"2023-07-12","objectID":"/posts/cuda_01/:1:0","tags":["CUDA"],"title":"CUDA_C_NOTES [1]","uri":"/posts/cuda_01/"},{"categories":["GPU"],"content":"1.1 å¹¶è¡Œè®¡ç®— å¹¶è¡Œè®¡ç®—é€šå¸¸è®¾è®¡ä¸¤ä¸ªä¸åŒçš„è®¡ç®—æœºé¢†åŸŸ è®¡ç®—æœºæ¶æ„(ç¡¬ä»¶)ï¼šåœ¨ç»“æ„çº§åˆ«ä¸Šæ”¯æŒå¹¶è¡Œæ€§ å¹¶è¡Œç¨‹åºè®¾è®¡(è½¯ä»¶)ï¼šå……åˆ†ä½¿ç”¨è®¡ç®—æœºæ¶æ„çš„è®¡ç®—èƒ½åŠ›æ¥å¹¶å‘åœ°è§£å†³é—®é¢˜ 1.1.1 ä¸²è¡Œç¼–ç¨‹å’Œå¹¶è¡Œç¼–ç¨‹ 1.1.2 å¹¶è¡Œæ€§ å¹¶è¡Œæ€§æ–¹å¼ ä»»åŠ¡å¹¶è¡Œï¼š å½“è®¸å¤šä»»åŠ¡æˆ–å‡½æ•°å¯ä»¥ç‹¬ç«‹åœ°ã€å¤§è§„æ¨¡åœ°å¹¶è¡Œæ‰§è¡Œæ—¶ï¼Œè¿™å°±æ˜¯ä»»åŠ¡å¹¶è¡Œã€‚ä»»åŠ¡å¹¶è¡Œçš„æ ¸å¿ƒæ˜¯åœ¨äºåˆ©ç”¨å¤šæ ¸ç³»ç»Ÿå¯¹ä»»åŠ¡è¿›è¡Œåˆ†é…ã€‚ æ•°æ®å¹¶è¡Œï¼š å½“å¯ä»¥å¤„ç†è®¸å¤šæ•°æ®çš„æ—¶å€™ï¼Œå°±æ˜¯æ•°æ®å¹¶è¡Œã€‚æ•°æ®å¹¶è¡Œçš„é‡ç‚¹æ˜¯åˆ©ç”¨å¤šæ ¸ç³»ç»Ÿå¯¹æ•°æ®è¿›è¡Œåˆ†é…ã€‚ CUDAç¼–ç¨‹éå¸¸é€‚åˆè§£å†³æ•°æ®å¹¶è¡Œé—®é¢˜ã€‚ æ•°æ®åˆ’åˆ†æ–¹å¼ï¼š å—åˆ’åˆ†ï¼š æ¯ä¸ªçº¿ç¨‹ä½œç”¨äºä¸€éƒ¨åˆ†æ•°æ®ï¼Œ é€šå¸¸è¿™äº›æ•°æ®å…·æœ‰ç›¸åŒå¤§å°ã€‚ ä¸€ç»„è¿ç»­æ•°æ®è¢«åˆ†åˆ°ä¸€ä¸ªå—å†…ï¼Œæ¯ä¸ªæ•°æ®å—ä»¥ä»»æ„æ¬¡åºè¢«å®‰æ’ç»™ä¸€ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹é€šå¸¸åœ¨åŒä¸€æ—¶é—´åªå¤„ç†ä¸€ä¸ªæ•°æ®å—ã€‚ å‘¨æœŸåˆ’åˆ†ï¼š æ¯ä¸ªçº¿ç¨‹ä½œç”¨äºæ•°æ®çš„å¤šéƒ¨åˆ†ã€‚ åœ¨å‘¨æœŸåˆ’åˆ†ä¸­ï¼Œæ›´å°‘çš„æ•°æ®è¢«åˆ†åˆ°ä¸€ä¸ªå—å†…ã€‚ç›¸é‚»çš„çº¿ç¨‹å¤„ç†ç›¸é‚»çš„æ•°æ®å—ï¼Œæ¯ä¸ªçº¿ç¨‹å¯ä»¥å¤„ç†å¤šä¸ªæ•°æ®å—ã€‚ä¸ºä¸€ä¸ªå¾…å¤„ç†çš„çº¿ç¨‹é€‰æ‹©ä¸€ä¸ªæ–°çš„å—ï¼Œå°±æ„å‘³ç€è¦è·³è¿‡å’Œç°æœ‰çº¿ç¨‹ä¸€æ ·å¤šçš„æ•°æ®å—ã€‚ 1.1.3 è®¡ç®—æœºæ¶æ„ è®¡ç®—æœºæœºæ„åˆ†ç±»(å¼—æ—åˆ†ç±»(Flynnâ€™s Taxonomy))ï¼šæ ¹æ®æŒ‡ä»¤å’Œæ•°æ®è¿›å…¥CPUçš„æ–¹å¼è¿›è¡Œåˆ†ç±» å•æŒ‡ä»¤å•æ•°æ®ï¼ˆSISDï¼‰ ä¸€ç§ä¸²è¡Œæ¶æ„ã€‚ åœ¨è¿™ç§è®¡ç®—æœºä¸Šåªæœ‰ä¸€ä¸ªæ ¸å¿ƒã€‚åœ¨ä»»ä½•æ—¶é—´ç‚¹ä¸Šåªæœ‰ä¸€ä¸ªæŒ‡ä»¤æµåœ¨å¤„ç†ä¸€ä¸ªæ•°æ®æµã€‚ å•æŒ‡ä»¤å¤šæ•°æ®ï¼ˆSIMDï¼‰ ä¸€ç§å¹¶è¡Œæ¶æ„ç±»å‹ã€‚åœ¨è¿™ç§è®¡ç®—æœºä¸Šæœ‰å¤šä¸ªæ ¸å¿ƒã€‚ åœ¨ä»»ä½•æ—¶é—´ç‚¹ä¸Šæ‰€æœ‰çš„æ ¸å¿ƒåªæœ‰ä¸€ä¸ªæŒ‡ä»¤æµå¤„ç†ä¸åŒçš„æ•°æ®æµï¼Œä¾‹å¦‚å‘é‡æœºã€‚ ä¼˜åŠ¿: åœ¨CPUä¸Šç¼–å†™ä»£ç æ—¶ï¼Œ ç¨‹åºå‘˜å¯ä»¥ç»§ç»­æŒ‰ä¸²è¡Œé€»è¾‘æ€è€ƒä½†å¯¹å¹¶è¡Œæ•°æ®æ“ä½œå®ç°å¹¶è¡ŒåŠ é€Ÿï¼Œè€Œå…¶ä»–ç»†èŠ‚åˆ™ç”±ç¼–è¯‘å™¨æ¥è´Ÿè´£ã€‚ å¤šæŒ‡ä»¤å•æ•°æ®ï¼ˆMISDï¼‰ æ¯”è¾ƒå°‘è§, æ¯ä¸ªæ ¸å¿ƒé€šè¿‡ä½¿ç”¨å¤šä¸ªæŒ‡ä»¤æµå¤„ç†åŒä¸€ä¸ªæ•°æ®æµ å¤šæŒ‡ä»¤å¤šæ•°æ®ï¼ˆMIMDï¼‰ ä¸€ç§å¹¶è¡Œæ¶æ„ï¼Œ åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œå¤šä¸ªæ ¸å¿ƒä½¿ç”¨å¤šä¸ªæŒ‡ä»¤æµæ¥å¼‚æ­¥å¤„ç†å¤šä¸ªæ•°æ®æµï¼Œä»è€Œå®ç°ç©ºé—´ä¸Šçš„å¹¶è¡Œæ€§ã€‚ è®¸å¤šMIMDæ¶æ„è¿˜åŒ…æ‹¬SIMDæ‰§è¡Œçš„å­ç»„ä»¶ã€‚ è®¡ç®—æœºæ¶æ„ä¼˜åŠ£çš„è¯„ä»·æŒ‡æ ‡ï¼š é™ä½å»¶è¿Ÿ å»¶è¿Ÿæ˜¯ä¸€ä¸ªæ“ä½œä»å¼€å§‹åˆ°å®Œæˆæ‰€éœ€è¦çš„æ—¶é—´ï¼Œ å¸¸ç”¨å¾®ç§’æ¥è¡¨ç¤º æé«˜å¸¦å®½ å¸¦å®½æ˜¯å•ä½æ—¶é—´å†…å¯å¤„ç†çš„æ•°æ®é‡ï¼Œ é€šå¸¸è¡¨ç¤ºä¸ºMB/sæˆ–GB/sã€‚ æé«˜ååé‡ ååé‡æ˜¯å•ä½æ—¶é—´å†…æˆåŠŸå¤„ç†çš„è¿ç®—æ•°é‡ï¼Œ é€šå¸¸è¡¨ç¤ºä¸ºgflopsï¼ˆå³æ¯ç§’åäº¿æ¬¡çš„æµ®ç‚¹è¿ç®—æ•°é‡ï¼‰ ï¼Œ ç‰¹åˆ«æ˜¯åœ¨é‡ç‚¹ä½¿ç”¨æµ®ç‚¹è®¡ç®—çš„ç§‘å­¦è®¡ç®—é¢†åŸŸç»å¸¸ç”¨åˆ° å»¶è¿Ÿç”¨æ¥è¡¡é‡å®Œæˆä¸€æ¬¡æ“ä½œçš„æ—¶é—´ï¼Œ è€Œååé‡ç”¨æ¥è¡¡é‡åœ¨ç»™å®šçš„å•ä½æ—¶é—´å†…å¤„ç†çš„æ“ä½œé‡ æ ¹æ®å†…å­˜ç»„ç»‡æ–¹å¼è¿›ä¸€æ­¥åˆ’åˆ†è®¡ç®—æœºæ¶æ„: åˆ†å¸ƒå¼å†…å­˜çš„å¤šèŠ‚ç‚¹ç³»ç»Ÿ å¤§å‹è®¡ç®—å¼•æ“æ˜¯ç”±è®¸å¤šç½‘ç»œè¿æ¥çš„å¤„ç†å™¨æ„æˆçš„ã€‚ æ¯ä¸ªå¤„ç†å™¨æœ‰è‡ªå·±çš„æœ¬åœ°å†…å­˜ï¼Œ è€Œä¸”å¤„ç†å™¨ä¹‹é—´å¯ä»¥é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡(ç±»ä¼¼äºå¤šæœºå¤šå¡) å…±äº«å†…å­˜çš„å¤šå¤„ç†å™¨ç³»ç»Ÿ GPUä»£è¡¨äº†ä¸€ç§ä¼—æ ¸æ¶æ„ï¼Œå‡ ä¹åŒ…æ‹¬äº†å‰æ–‡æè¿°çš„æ‰€æœ‰å¹¶è¡Œç»“æ„ï¼š å¤šçº¿ç¨‹ã€MIMDï¼ˆå¤šæŒ‡ä»¤å¤šæ•°æ®ï¼‰ã€ SIMDï¼ˆå•æŒ‡ä»¤å¤šæ•°æ®ï¼‰ï¼Œ ä»¥åŠæŒ‡ä»¤çº§å¹¶è¡Œã€‚ NVIDIAå…¬å¸ç§°è¿™ ç§æ¶æ„ä¸ºSIMTï¼ˆå•æŒ‡ä»¤å¤šçº¿ç¨‹ï¼‰ã€‚ GPUæ ¸å¿ƒå’ŒCPUæ ¸å¿ƒ å°½ç®¡å¯ä»¥ä½¿ç”¨å¤šæ ¸å’Œä¼—æ ¸æ¥åŒºåˆ†CPUå’ŒGPUçš„æ¶æ„ï¼Œ ä½†è¿™ä¸¤ç§æ ¸å¿ƒæ˜¯å®Œå…¨ä¸åŒçš„ã€‚ CPUæ ¸å¿ƒæ¯”è¾ƒé‡ï¼Œ ç”¨æ¥å¤„ç†éå¸¸å¤æ‚çš„æ§åˆ¶é€»è¾‘ï¼Œ ä»¥ä¼˜åŒ–ä¸²è¡Œç¨‹åºæ‰§è¡Œã€‚ GPUæ ¸å¿ƒè¾ƒè½»ï¼Œ ç”¨äºä¼˜åŒ–å…·æœ‰ç®€å•æ§åˆ¶é€»è¾‘çš„æ•°æ®å¹¶è¡Œä»»åŠ¡ï¼Œ æ³¨é‡å¹¶è¡Œç¨‹åºçš„ååé‡ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda_01/:1:1","tags":["CUDA"],"title":"CUDA_C_NOTES [1]","uri":"/posts/cuda_01/"},{"categories":["GPU"],"content":"1.2 å¼‚æ„è®¡ç®— CPUå’ŒGPUæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å¤„ç†å™¨ï¼Œ å®ƒä»¬é€šè¿‡å•ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸­çš„PCI-Expressæ€»çº¿ç›¸è¿ã€‚ åœ¨è¿™ç§å…¸å‹çš„æ¶æ„ä¸­ï¼Œ GPUæŒ‡çš„æ˜¯ç¦»æ•£çš„è®¾å¤‡ï¼Œä»åŒæ„ç³»ç»Ÿåˆ°å¼‚æ„ç³»ç»Ÿçš„è½¬å˜æ˜¯é«˜æ€§èƒ½è®¡ç®— å²ä¸Šçš„ä¸€ä¸ªé‡Œç¨‹ç¢‘ã€‚ åŒæ„è®¡ç®—ä½¿ç”¨çš„æ˜¯åŒä¸€æ¶æ„ä¸‹çš„ä¸€ä¸ªæˆ–å¤šä¸ªå¤„ç†å™¨æ¥æ‰§è¡Œä¸€ä¸ªåº”ç”¨ã€‚ è€Œå¼‚æ„è®¡ç®—åˆ™ä½¿ç”¨ä¸€ä¸ªå¤„ç†å™¨æ¶æ„æ¥æ‰§è¡Œä¸€ä¸ªåº”ç”¨ï¼Œä¸ºä»»åŠ¡é€‰æ‹©é€‚åˆå®ƒçš„æ¶æ„ï¼Œä½¿å…¶æœ€ç»ˆ å¯¹æ€§èƒ½æœ‰æ‰€æ”¹è¿›. 1.2.1 å¼‚æ„æ¶æ„ ä¸€ä¸ªå…¸å‹çš„å¼‚æ„è®¡ç®—èŠ‚ç‚¹åŒ…æ‹¬ä¸¤ä¸ªå¤šæ ¸CPUæ’æ§½å’Œä¸¤ä¸ªæˆ–æ›´å¤šä¸ªçš„ä¼—æ ¸GPUã€‚ GPUä¸ æ˜¯ä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„å¹³å°è€Œæ˜¯CPUçš„åå¤„ç†å™¨ã€‚ å› æ­¤ï¼Œ GPUå¿…é¡»é€šè¿‡PCIeæ€»çº¿ä¸åŸºäºCPUçš„ ä¸»æœºç›¸è¿æ¥è¿›è¡Œæ“ä½œï¼Œ å¦‚å›¾1-9æ‰€ç¤ºã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆCPUæ‰€åœ¨çš„ä½ç½®è¢«ç§°ä½œä¸»æœºç«¯(host)è€ŒGPU æ‰€åœ¨çš„ä½ç½®è¢«ç§°ä½œè®¾å¤‡ç«¯(device)ã€‚ ä¸€ä¸ªå¼‚æ„åº”ç”¨åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š ä¸»æœºä»£ç ï¼šåœ¨CPUä¸Šè¿è¡Œ è®¾å¤‡ä»£ç ï¼šåœ¨GPUä¸Šè¿è¡Œ. æè¿°GPUå®¹é‡çš„ä¸¤ä¸ªé‡è¦ç‰¹å¾ CUDAæ ¸å¿ƒæ•°é‡ å†…å­˜å¤§å° ç›¸åº”çš„ï¼Œ æœ‰ä¸¤ç§ä¸åŒçš„æŒ‡æ ‡æ¥è¯„ä¼°GPUçš„æ€§èƒ½: å³°å€¼è®¡ç®—æ€§èƒ½ï¼šç”¨æ¥è¯„ä¼°è®¡ç®—å®¹é‡çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œ é€šå¸¸å®šä¹‰ä¸ºæ¯ç§’èƒ½å¤„ç†çš„å•ç²¾åº¦æˆ–åŒç²¾åº¦æµ®ç‚¹è¿ç®—çš„æ•°é‡ï¼Œé€šå¸¸ç”¨GFlopsï¼ˆæ¯ç§’åäº¿æ¬¡æµ®ç‚¹è¿ç®—ï¼‰ æˆ–TFlopsï¼ˆæ¯ç§’ä¸‡ äº¿æ¬¡æµ®ç‚¹è¿ç®—ï¼‰ æ¥è¡¨ç¤º å†…å­˜å¸¦å®½ï¼šä»å†…å­˜ä¸­è¯»å–æˆ–å†™å…¥æ•°æ®çš„æ¯”ç‡ã€‚ å†…å­˜å¸¦å®½é€šå¸¸ç”¨GB/sè¡¨ç¤º è®¡ç®—èƒ½åŠ› 1.2.2 å¼‚æ„è®¡ç®—èŒƒä¾‹ GPUä¸CPUç»“åˆåï¼Œ èƒ½æœ‰æ•ˆæé«˜å¤§è§„æ¨¡è®¡ç®—é—®é¢˜çš„å¤„ç†é€Ÿåº¦ä¸æ€§èƒ½ã€‚ CPUé’ˆå¯¹åŠ¨æ€å·¥ä½œè´Ÿè½½è¿›è¡Œäº†ä¼˜åŒ–ï¼Œ è¿™äº›åŠ¨æ€å·¥ä½œè´Ÿè½½æ˜¯ç”±çŸ­åºåˆ—çš„è®¡ç®—æ“ä½œå’Œä¸å¯é¢„æµ‹çš„æ§åˆ¶æµç¨‹æ ‡ è®°çš„ï¼› è€ŒGPUåœ¨å…¶ä»–é¢†åŸŸå†…çš„ç›®çš„æ˜¯ï¼š å¤„ç†ç”±è®¡ç®—ä»»åŠ¡ä¸»å¯¼çš„ä¸”å¸¦æœ‰ç®€å•æ§åˆ¶æµçš„å·¥ä½œè´Ÿè½½ã€‚ CPUçº¿ç¨‹ä¸GPUçº¿ç¨‹ CPUä¸Šçš„çº¿ç¨‹é€šå¸¸æ˜¯é‡é‡çº§çš„å®ä½“ã€‚ æ“ä½œç³»ç»Ÿå¿…é¡»äº¤æ›¿çº¿ç¨‹ä½¿ç”¨å¯ç”¨æˆ–å…³é—­CPUæ‰§è¡Œé€šé“ä»¥æä¾›å¤šçº¿ç¨‹å¤„ç†åŠŸèƒ½ã€‚ ä¸Šä¸‹æ–‡çš„åˆ‡æ¢ç¼“æ…¢ä¸”å¼€é”€å¤§ã€‚ GPUä¸Šçš„çº¿ç¨‹æ˜¯é«˜åº¦è½»é‡çº§çš„ã€‚ åœ¨ä¸€ä¸ªå…¸å‹çš„ç³»ç»Ÿä¸­ä¼šæœ‰æˆåƒä¸Šä¸‡çš„çº¿ç¨‹æ’é˜Ÿç­‰å¾…å·¥ä½œã€‚ å¦‚æœGPUå¿…é¡»ç­‰å¾…ä¸€ç»„çº¿ç¨‹æ‰§è¡Œç»“æŸï¼Œ é‚£ä¹ˆå®ƒåªè¦è°ƒç”¨å¦ä¸€ç»„çº¿ç¨‹æ‰§è¡Œå…¶ä»–ä»»åŠ¡å³å¯ 1.2.3 CUDAï¼š ä¸€ç§å¼‚æ„è®¡ç®—å¹³å° CUDAæ˜¯ä¸€ç§é€šç”¨çš„å¹¶è¡Œè®¡ç®—å¹³å°å’Œç¼–ç¨‹æ¨¡å‹ï¼Œå®ƒåˆ©ç”¨NVIDIA GPUä¸­çš„å¹¶è¡Œè®¡ç®—å¼•æ“èƒ½æ›´æœ‰æ•ˆåœ°è§£å†³å¤æ‚çš„è®¡ç®—é—®é¢˜ã€‚é€šè¿‡ä½¿ç”¨CUDAï¼Œä½ å¯ä»¥åƒåœ¨CPUä¸Šé‚£æ ·ï¼Œé€šè¿‡GPUæ¥è¿›è¡Œè®¡ç®—ã€‚ CUDAæä¾›äº†ä¸¤å±‚APIæ¥ç®¡ç†GPUè®¾å¤‡å’Œç»„ç»‡çº¿ç¨‹ï¼Œ å¦‚å›¾1-13æ‰€ç¤ºã€‚ CUDAé©±åŠ¨APIï¼šé©±åŠ¨APIæ˜¯ä¸€ç§ä½çº§APIï¼Œ å®ƒç›¸å¯¹æ¥è¯´è¾ƒéš¾ç¼–ç¨‹ï¼Œ ä½†æ˜¯å®ƒå¯¹äºåœ¨GPUè®¾å¤‡ä½¿ç”¨ä¸Šæä¾›äº†æ›´å¤šçš„æ§åˆ¶ã€‚ CUDAè¿è¡Œæ—¶APIï¼šè¿è¡Œæ—¶APIæ˜¯ä¸€ä¸ªé«˜çº§APIï¼Œ å®ƒåœ¨é©±åŠ¨APIçš„ä¸Šå±‚å®ç°ã€‚ æ¯ä¸ªè¿è¡Œæ—¶APIå‡½æ•°éƒ½è¢«åˆ†è§£ä¸ºæ›´å¤šä¼ ç»™é©±åŠ¨APIçš„åŸºæœ¬è¿ç®—ã€‚ ä¸€ä¸ªCUDAç¨‹åºåŒ…å«äº†ä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†: åœ¨CPUä¸Šè¿è¡Œçš„ä¸»æœºä»£ç  åœ¨GPUä¸Šè¿è¡Œçš„è®¾å¤‡ä»£ç  NVIDIAçš„CUDA nvccç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å°†è®¾å¤‡ä»£ç ä»ä¸»æœºä»£ç ä¸­åˆ†ç¦»å‡ºæ¥. ä¸»æœºä»£ç æ˜¯æ ‡å‡†çš„Cä»£ç ï¼Œä½¿ç”¨Cç¼–è¯‘å™¨è¿›è¡Œç¼–è¯‘ã€‚ è®¾å¤‡ä»£ç ï¼Œä¹Ÿå°±æ˜¯æ ¸å‡½æ•°ï¼Œ æ˜¯ç”¨æ‰©å±•çš„å¸¦æœ‰æ ‡è®°æ•°æ®å¹¶è¡Œå‡½æ•°å…³é”®å­—çš„CUDA Cè¯­è¨€ç¼–å†™çš„. è®¾å¤‡ä»£ç é€šè¿‡nvccè¿›è¡Œç¼–è¯‘ã€‚ åœ¨é“¾æ¥é˜¶æ®µï¼Œåœ¨å†…æ ¸ç¨‹åºè°ƒç”¨å’Œæ˜¾ç¤ºGPUè®¾å¤‡æ“ä½œä¸­æ·»åŠ CUDAè¿è¡Œæ—¶åº“ã€‚ ","date":"2023-07-12","objectID":"/posts/cuda_01/:1:2","tags":["CUDA"],"title":"CUDA_C_NOTES [1]","uri":"/posts/cuda_01/"},{"categories":["GPU"],"content":"1.3 ç”¨GPUè¾“å‡ºHello World ç”¨ä¸“ç”¨æ‰©å±•å.cuæ¥åˆ›å»ºä¸€ä¸ªæºæ–‡ä»¶ ä½¿ç”¨CUDA nvccç¼–è¯‘å™¨æ¥ç¼–è¯‘ç¨‹åº ä»å‘½ä»¤è¡Œè¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œ è¿™ä¸ªæ–‡ä»¶æœ‰å¯åœ¨GPUä¸Šè¿è¡Œçš„å†…æ ¸ä»£ç ã€‚ é¦–å…ˆï¼Œ æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªCè¯­è¨€ç¨‹åºæ¥è¾“å‡ºâ€œHello Worldâ€ï¼Œ å¦‚ä¸‹æ‰€ç¤º #include\u003cstdio.h\u003e int main(void) { printf(\"Hello World from CPU!\\n\")ï¼› } æŠŠä»£ç ä¿å­˜åˆ°hello.cuä¸­ï¼Œ ç„¶åä½¿ç”¨nvccç¼–è¯‘å™¨æ¥ç¼–è¯‘ã€‚ CUDA nvccç¼–è¯‘å™¨å’Œgccç¼–è¯‘å™¨åŠå…¶ä»–ç¼–è¯‘å™¨æœ‰ç›¸ä¼¼çš„è¯­ä¹‰ nvcc hello.cu -o hello å¦‚æœä½ è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶helloï¼Œ å°†ä¼šè¾“å‡ºï¼š Hello World from CPU! æ¥ä¸‹æ¥ï¼Œ ç¼–å†™ä¸€ä¸ªå†…æ ¸å‡½æ•°ï¼Œ å‘½åä¸ºhelloFromGPUï¼Œ ç”¨å®ƒæ¥è¾“å‡ºå­—ç¬¦ä¸²â€œHello World from GPUï¼ â€ã€‚ __global__ void helloFromGPU(void) { printf(\"Hello World from GPU!\\n\"); } ä¿®é¥°ç¬¦__global__å‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå‡½æ•°å°†ä¼šä»CPUä¸­è°ƒç”¨ï¼Œ ç„¶ååœ¨GPUä¸Šæ‰§è¡Œã€‚ç”¨ä¸‹é¢çš„ä»£ç å¯åŠ¨å†…æ ¸å‡½æ•°. helloFromGPU \u003c\u003c\u003c1, 10\u003e\u003e\u003e() ä¸‰é‡å°–æ‹¬å·æ„å‘³ç€ä»ä¸»çº¿ç¨‹åˆ°è®¾å¤‡ç«¯ä»£ç çš„è°ƒç”¨ã€‚ ä¸€ä¸ªå†…æ ¸å‡½æ•°é€šè¿‡ä¸€ç»„çº¿ç¨‹æ¥æ‰§è¡Œï¼Œ æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œç›¸åŒçš„ä»£ç ã€‚ ä¸‰é‡å°–æ‹¬å·é‡Œé¢çš„å‚æ•°æ˜¯æ‰§è¡Œé…ç½®ï¼Œ ç”¨æ¥è¯´æ˜ä½¿ç”¨å¤šå°‘çº¿ç¨‹æ¥æ‰§è¡Œå†…æ ¸å‡½æ•°ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰10ä¸ªGPUçº¿ç¨‹è¢«è°ƒç”¨ã€‚ cudaDeviceReset()ç”¨æ¥æ˜¾å¼åœ°é‡Šæ”¾å’Œæ¸…ç©ºå½“å‰è¿›ç¨‹ä¸­ä¸å½“å‰è®¾å¤‡æœ‰å…³çš„æ‰€æœ‰èµ„æºã€‚ ä¸€ä¸ªå…¸å‹çš„CUDAç¼–ç¨‹ç»“æ„åŒ…æ‹¬5ä¸ªä¸»è¦æ­¥éª¤: 1. åˆ†é…GPUå†…å­˜ 2. ä»CPUå†…å­˜ä¸­æ‹·è´æ•°æ®åˆ°GPUå†…å­˜ 3. è°ƒç”¨CUDAå†…æ ¸å‡½æ•°æ¥å®Œæˆç¨‹åºæŒ‡å®šçš„è¿ç®— 4. å°†æ•°æ®ä»GPUæ‹·å›CPUå†…å­˜ 5. é‡Šæ”¾GPUå†…å­˜ç©ºé—´ ","date":"2023-07-12","objectID":"/posts/cuda_01/:1:3","tags":["CUDA"],"title":"CUDA_C_NOTES [1]","uri":"/posts/cuda_01/"},{"categories":["GPU"],"content":"1.4 ä½¿ç”¨CUDA Cç¼–ç¨‹éš¾å— æ•°æ®å±€éƒ¨æ€§: æŒ‡çš„æ˜¯æ•°æ®é‡ç”¨ï¼Œ ä»¥é™ä½å†…å­˜è®¿é—®çš„å»¶è¿Ÿ æ—¶é—´å±€éƒ¨æ€§ï¼šæŒ‡åœ¨ç›¸å¯¹è¾ƒçŸ­çš„æ—¶é—´æ®µå†…æ•°æ®æˆ–èµ„æºçš„é‡ç”¨ ç©ºé—´å±€éƒ¨æ€§ï¼šæŒ‡åœ¨ç›¸å¯¹è¾ƒæ¥è¿‘çš„å­˜å‚¨ç©ºé—´å†…æ•°æ®å…ƒç´ çš„é‡ç”¨ã€‚ CUDAä¸­æœ‰å†…å­˜å±‚æ¬¡å’Œçº¿ç¨‹å±‚æ¬¡çš„æ¦‚å¿µ å†…å­˜å±‚æ¬¡ç»“æ„ çº¿ç¨‹å±‚æ¬¡ç»“æ„ CUDAæ ¸ä¸­æœ‰3ä¸ªå…³é”®æŠ½è±¡ çº¿ç¨‹ç»„çš„å±‚æ¬¡ç»“æ„ å†…å­˜çš„å±‚æ¬¡ç»“æ„ éšœç¢åŒæ­¥ ","date":"2023-07-12","objectID":"/posts/cuda_01/:1:4","tags":["CUDA"],"title":"CUDA_C_NOTES [1]","uri":"/posts/cuda_01/"},{"categories":["GPU"],"content":"1.5 æ€»ç»“ CPU + GPUçš„å¼‚æ„ç³»ç»Ÿæˆä¸ºé«˜æ€§èƒ½è®¡ç®—çš„ä¸»æµæ¶æ„: åœ¨GPUä¸Šæ‰§è¡Œæ•°æ®å¹¶è¡Œå·¥ä½œï¼Œ åœ¨CPUä¸Šæ‰§è¡Œä¸²è¡Œå’Œä»»åŠ¡å¹¶è¡Œçš„å·¥ä½œã€‚ ","date":"2023-07-12","objectID":"/posts/cuda_01/:1:5","tags":["CUDA"],"title":"CUDA_C_NOTES [1]","uri":"/posts/cuda_01/"},{"categories":["C++"],"content":" quote note abstract info tip success question warning failure danger bug example quote ref: https://zhuanlan.zhihu.com/p/650986900 ","date":"2023-07-12","objectID":"/posts/newfeature/:0:0","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"C++ 11 æ–°ç‰¹æ€§æ€»ç»“ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:0","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] C++ 11 æ˜¯ä»€ä¹ˆï¼ŒC++ 11æ ‡å‡†çš„ç”±æ¥ C++ è¿™é—¨ç¼–ç¨‹è¯­è¨€çš„å†å²å¯ä»¥è¿½æº¯è‡³ 1979 å¹´ï¼Œå½“æ—¶çš„ Bjarne Stroustrupï¼ˆC++ ä¹‹çˆ¶ï¼Œåç»­ç®€ç§° Stroustrupï¼‰è¿˜åœ¨ä½¿ç”¨ Simula è¯­è¨€è¿›è¡Œå¼€å‘å·¥ä½œã€‚ Simula è¯­è¨€è¢«è®¤ä¸ºæ˜¯ç¬¬ä¸€ä¸ªé¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ã€‚Stroustrup ä¹Ÿéå¸¸èµèµ Simula è¯­è¨€çš„è¿™ç§ç‰¹æ€§ï¼Œä½†ç”±äºå®ä¾‹å¼€å‘ä¸­ Simula è¯­è¨€çš„æ‰§è¡Œæ•ˆç‡å¤ªä½ï¼Œæ‰€ä»¥æ­¤åä¸ä¹…ï¼ŒStroustrup å¼€å§‹ä»äº‹â€œå¸¦ç±»çš„Câ€ç¼–ç¨‹è¯­è¨€çš„å¼€å‘å·¥ä½œã€‚ æ³¨æ„åœ¨å¼€å‘åˆæœŸï¼Œå¹¶æ²¡æœ‰ C++ è¿™ä¸ªç§°è°“ã€‚æ‰€è°“â€œå¸¦ç±»çš„Câ€ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯åœ¨ C è¯­è¨€çš„åŸºç¡€ä¸Šï¼Œä¸ºå…¶åŠ å…¥é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼ˆæ‰©å¢ä¸€äº›å†™å¥½çš„ç±»å’Œå¯¹è±¡ï¼‰ã€‚åˆæœŸçš„ C++ é™¤äº†å…·å¤‡ C è¯­è¨€çš„æ‰€æœ‰åŠŸèƒ½å¤–ï¼Œè¿˜å…·æœ‰ç±»ã€åŸºæœ¬ç»§æ‰¿ã€å†…è”å‡½æ•°ã€é»˜è®¤å‡½æ•°å‚æ•°ä»¥åŠå¼ºç±»å‹æ£€æŸ¥ç­‰ç®€å•åŠŸèƒ½ã€‚ ä¸ä»…å¦‚æ­¤ï¼ŒStroustrup è¿˜åœ¨ CPreï¼ˆCè¯­è¨€ç¼–è¯‘å™¨ï¼‰çš„åŸºç¡€ä¸Šï¼Œä¸“é—¨ä¸ºâ€œå¸¦ç±»çš„Câ€å¼€å‘äº†ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œç§°ä¸º Cfrontï¼Œå®ƒå¯ä»¥å°†å¸¦æœ‰ç±»çš„ C ä»£ç è‡ªåŠ¨è½¬æ¢ä¸ºæ™®é€š C è¯­è¨€ç¨‹åºã€‚å€¼å¾—ä¸€æçš„æ˜¯åœ¨ 1993 å¹´ï¼ŒCfront å› éš¾ä»¥æ”¯æŒ C++ å¼‚å¸¸æœºåˆ¶è¢«å¼ƒç”¨ã€‚ 1983 å¹´ï¼Œâ€œå¸¦ç±»çš„Câ€æ­£å¼è¢«ç§°ä¸ºâ€œC++â€ï¼Œå…¶ä¸­â€œ++â€å°±å–è‡ª C è¯­è¨€ä¸­çš„â€œ++â€è¿ç®—ç¬¦ï¼Œè¿™ä¹Ÿä»ä¾§é¢è¡¨æ˜äº† Stroustrup å¯¹äº C++ è¿™é—¨ç¼–ç¨‹è¯­è¨€çš„å®šä½ã€‚ ä¸æ­¤åŒæ—¶ï¼ŒC++è¿˜å¢æ·»äº†å¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚è™šå‡½æ•°ã€å‡½æ•°é‡è½½ã€å¼•ç”¨ã€const å…³é”®å­—ä»¥åŠ // æ³¨é‡Šç¬¦å·ç­‰ã€‚ åœ¨éšåçš„å‡ å¹´æ—¶é—´é‡Œï¼ŒC++ å¾—åˆ°äº†å¿«é€Ÿåœ°å‘å±•ã€‚æ¯”å¦‚è¯´ï¼Œ C++ ä¸æ–­åœ°è¢«æ›´æ–°ï¼Œç±»ä¸­å¢åŠ äº†å—ä¿æŠ¤æˆå‘˜ï¼ˆprotectedï¼‰å’Œç§æœ‰æˆå‘˜ï¼ˆprivateï¼‰ï¼Œå¹¶å…è®¸ä½¿ç”¨å¤šç»§æ‰¿ç­‰ï¼›Stroustrup å‡ºç‰ˆäº† ã€Šå¸¦æ³¨é‡Šçš„C++å‚è€ƒæ‰‹å†Œã€‹ä¸€ä¹¦ï¼Œå…¶ä¸€åº¦è¢«å½“åš C++ å¼€å‘çš„é‡è¦å‚è€ƒï¼›Borland å‘å¸ƒäº† Turbo C ++ç¼–è¯‘å™¨ï¼Œè¯¥ç¼–è¯‘å™¨åŒ…å«æœ‰å¤§é‡çš„ç¬¬ä¸‰æ–¹ C++ åº“ï¼Œæå¤§ä¾¿åˆ©äº† C ++ çš„å¼€å‘ï¼Œç­‰ç­‰ã€‚ ç›´åˆ° 1998 å¹´ï¼ŒC++ æ ‡å‡†å§”å‘˜ä¼šå‘å¸ƒäº†ç¬¬ä¸€ç‰ˆ C++ æ ‡å‡†ï¼Œå¹¶å°†å…¶å‘½åä¸º C++98 æ ‡å‡†ã€‚æ®ä¸çŸ¥åäººå£«é€éœ²ï¼Œã€Šå¸¦æ³¨é‡Šçš„C++å‚è€ƒæ‰‹å†Œã€‹è¿™æœ¬ä¹¦å¯¹ C++98 æ ‡å‡†çš„åˆ¶å®šäº§ç”Ÿäº†å¾ˆå¤§çš„å½±å“ã€‚ ç»è¿‡ä½œè€…çš„ä¸æ–­è¿­ä»£ï¼Œä¸€æœ¬ä¹¦å¾€å¾€ä¼šå…ˆåå‘å¸ƒå¾ˆå¤šä¸ªç‰ˆæœ¬ï¼Œå…¶ä¸­æ¯ä¸ªæ–°ç‰ˆæœ¬éƒ½æ˜¯å¯¹å‰ä¸€ä¸ªç‰ˆæœ¬çš„ä¿®æ­£å’Œæ›´æ–°ã€‚C++ ç¼–ç¨‹è¯­è¨€çš„å‘å±•ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æˆªæ­¢åˆ°ç›®å‰ï¼ˆ2020å¹´ï¼‰ï¼ŒC++çš„å‘å±•å†ç»äº†ä»¥ä¸‹ 3 ä¸ªä¸ªæ ‡å‡†ï¼š 2011 å¹´ï¼Œæ–°çš„ C++ 11 æ ‡å‡†è¯ç”Ÿï¼Œç”¨äºå–ä»£ C++ 98 æ ‡å‡†ã€‚æ­¤æ ‡å‡†è¿˜æœ‰ä¸€ä¸ªåˆ«åï¼Œä¸ºâ€œC++ 0xâ€ï¼› 2014 å¹´ï¼ŒC++ 14 æ ‡å‡†å‘å¸ƒï¼Œè¯¥æ ‡å‡†åº“å¯¹ C++ 11 æ ‡å‡†åº“åšäº†æ›´ä¼˜çš„ä¿®æ”¹å’Œæ›´æ–°ï¼› 2017 å¹´åº•ï¼ŒC++ 17 æ ‡å‡†æ­£å¼é¢å¸ƒã€‚ æ‰€è°“æ ‡å‡†ï¼Œå³æ˜ç¡® C++ ä»£ç çš„ç¼–å†™è§„èŒƒï¼Œæ‰€æœ‰çš„ C++ ç¨‹åºå‘˜éƒ½åº”éµå®ˆæ­¤æ ‡å‡†ã€‚ å€¼å¾—ä¸€æçš„æ˜¯åœ¨ C++ 11 æ ‡å‡†ä¹‹å‰ï¼ŒC++ æ ‡å‡†å§”å‘˜ä¼šè¿˜åœ¨ 2003 å¹´å¯¹ C++ 98 æ ‡å‡†åšäº†ä¸€æ¬¡ä¿®æ”¹ï¼ˆç§°ä¸º C++ 03 æ ‡å‡†ï¼‰ï¼Œä½†ç”±äºå…¶ä»…ä»…ä¿®å¤äº†ä¸€äº› C++ 98 æ ‡å‡†ä¸­å­˜åœ¨çš„æ¼æ´ï¼Œå¹¶æœªä¿®æ”¹æ ¸å¿ƒè¯­æ³•ï¼Œå› æ­¤äººä»¬ä¹ æƒ¯å°†è¿™æ¬¡ä¿®è®¢å’Œ C++ 98 åˆç§°ä¸º C++98/03 æ ‡å‡†ã€‚ ä»¥ä¸Š 3 ä¸ªæ ‡å‡†ä¸­ï¼Œç›¸æ¯”å¯¹å‰ä¸€ä¸ªç‰ˆæœ¬çš„ä¿®æ”¹å’Œæ›´æ–°ç¨‹åº¦ï¼ŒC++ 11 æ ‡å‡†æ— ç–‘æ˜¯é¢ è¦†æ€§çš„ï¼Œè¯¥æ ‡å‡†åœ¨ C++ 98 çš„åŸºç¡€ä¸Šä¿®æ­£äº†çº¦ 600 ä¸ª C++ è¯­è¨€ä¸­å­˜åœ¨çš„ç¼ºé™·ï¼ŒåŒæ—¶æ·»åŠ äº†çº¦ 140 ä¸ªæ–°ç‰¹æ€§ï¼Œè¿™äº›æ›´æ–°ä½¿å¾— C++ è¯­è¨€ç„•ç„¶ä¸€æ–°ã€‚è¯»è€…å¯ä»¥è¿™æ ·ç†è§£ C++ 11 æ ‡å‡†ï¼Œå®ƒåœ¨ C++ 98/03 æ ‡å‡†çš„åŸºç¡€ä¸Šå­•è‚²å‡ºäº†å…¨æ–°çš„ C++ ç¼–ç¨‹è¯­è¨€ï¼Œé€ å°±äº† C++ æ–°çš„å¼€å§‹ã€‚ é‚£ä¹ˆï¼ŒC++ 11 æ ‡å‡†åˆ°åº•åŒ…å«å“ªäº›æ–°ç‰¹æ€§å‘¢ï¼Ÿåˆ«æ€¥ï¼Œæ¥ä¸‹æ¥ä¼šåˆ†ç¯‡ç»™å¤§å®¶åšè¯¦ç»†åœ°è®²è§£ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:1","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] autoç±»å‹æ¨å¯¼å®Œå…¨æ”»ç•¥ åœ¨ C++11 ä¹‹å‰çš„ç‰ˆæœ¬ï¼ˆC++98 å’Œ C++ 03ï¼‰ä¸­ï¼Œå®šä¹‰å˜é‡æˆ–è€…å£°æ˜å˜é‡ä¹‹å‰éƒ½å¿…é¡»æŒ‡æ˜å®ƒçš„ç±»å‹ï¼Œæ¯”å¦‚ intã€char ç­‰ï¼›ä½†æ˜¯åœ¨ä¸€äº›æ¯”è¾ƒçµæ´»çš„è¯­è¨€ä¸­ï¼Œæ¯”å¦‚ C#ã€JavaScriptã€PHPã€Python ç­‰ï¼Œç¨‹åºå‘˜åœ¨å®šä¹‰å˜é‡æ—¶å¯ä»¥ä¸æŒ‡æ˜å…·ä½“çš„ç±»å‹ï¼Œè€Œæ˜¯è®©ç¼–è¯‘å™¨ï¼ˆæˆ–è€…è§£é‡Šå™¨ï¼‰è‡ªå·±å»æ¨å¯¼ï¼Œè¿™å°±è®©ä»£ç çš„ç¼–å†™æ›´åŠ æ–¹ä¾¿ã€‚ C++11 ä¸ºäº†é¡ºåº”è¿™ç§è¶‹åŠ¿ä¹Ÿå¼€å§‹æ”¯æŒè‡ªåŠ¨ç±»å‹æ¨å¯¼äº†ï¼C++11 ä½¿ç”¨ auto å…³é”®å­—æ¥æ”¯æŒè‡ªåŠ¨ç±»å‹æ¨å¯¼ã€‚ auto ç±»å‹æ¨å¯¼çš„è¯­æ³•å’Œè§„åˆ™ åœ¨ä¹‹å‰çš„ C++ ç‰ˆæœ¬ä¸­ï¼Œauto å…³é”®å­—ç”¨æ¥æŒ‡æ˜å˜é‡çš„å­˜å‚¨ç±»å‹ï¼Œå®ƒå’Œ static å…³é”®å­—æ˜¯ç›¸å¯¹çš„ã€‚auto è¡¨ç¤ºå˜é‡æ˜¯è‡ªåŠ¨å­˜å‚¨çš„ï¼Œè¿™ä¹Ÿæ˜¯ç¼–è¯‘å™¨çš„é»˜è®¤è§„åˆ™ï¼Œæ‰€ä»¥å†™ä¸å†™éƒ½ä¸€æ ·ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¹Ÿä¸å†™ï¼Œè¿™ä½¿å¾— auto å…³é”®å­—çš„å­˜åœ¨å˜å¾—éå¸¸é¸¡è‚‹ã€‚ C++11 èµ‹äºˆ auto å…³é”®å­—æ–°çš„å«ä¹‰ï¼Œä½¿ç”¨å®ƒæ¥åšè‡ªåŠ¨ç±»å‹æ¨å¯¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨äº† auto å…³é”®å­—ä»¥åï¼Œç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æœŸé—´è‡ªåŠ¨æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨æ‰‹åŠ¨æŒ‡æ˜å˜é‡çš„æ•°æ®ç±»å‹äº†ã€‚ auto å…³é”®å­—åŸºæœ¬çš„ä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š auto name = value; name æ˜¯å˜é‡çš„åå­—ï¼Œvalue æ˜¯å˜é‡çš„åˆå§‹å€¼ã€‚ æ³¨æ„ï¼šauto ä»…ä»…æ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œåœ¨ç¼–è¯‘å™¨æœŸé—´å®ƒä¼šè¢«çœŸæ­£çš„ç±»å‹æ‰€æ›¿ä»£ã€‚æˆ–è€…è¯´ï¼ŒC++ ä¸­çš„å˜é‡å¿…é¡»æ˜¯æœ‰æ˜ç¡®ç±»å‹çš„ï¼Œåªæ˜¯è¿™ä¸ªç±»å‹æ˜¯ç”±ç¼–è¯‘å™¨è‡ªå·±æ¨å¯¼å‡ºæ¥çš„ auto ç±»å‹æ¨å¯¼çš„ç®€å•ä¾‹å­ï¼š auto n = 10; auto f = 12.8; auto p = \u0026n; auto url = â€œhttp://c.biancheng.net/cplus/â€; ä¸‹é¢æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ï¼š ç¬¬ 1 è¡Œä¸­ï¼Œ10 æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œé»˜è®¤æ˜¯ int ç±»å‹ï¼Œæ‰€ä»¥æ¨å¯¼å‡ºå˜é‡ n çš„ç±»å‹æ˜¯ intã€‚ ç¬¬ 2 è¡Œä¸­ï¼Œ12.8 æ˜¯ä¸€ä¸ªå°æ•°ï¼Œé»˜è®¤æ˜¯ double ç±»å‹ï¼Œæ‰€ä»¥æ¨å¯¼å‡ºå˜é‡ f çš„ç±»å‹æ˜¯ doubleã€‚ ç¬¬ 3 è¡Œä¸­ï¼Œ\u0026n çš„ç»“æœæ˜¯ä¸€ä¸ª int* ç±»å‹çš„æŒ‡é’ˆï¼Œæ‰€ä»¥æ¨å¯¼å‡ºå˜é‡ p çš„ç±»å‹æ˜¯ int*ã€‚ ç¬¬ 4 è¡Œä¸­ï¼Œç”±åŒå¼•å·\"â€œåŒ…å›´èµ·æ¥çš„å­—ç¬¦ä¸²æ˜¯ const char* ç±»å‹ï¼Œæ‰€ä»¥æ¨å¯¼å‡ºå˜é‡ url çš„ç±»å‹æ˜¯ const char*ï¼Œä¹Ÿå³ä¸€ä¸ªå¸¸é‡æŒ‡é’ˆã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿ç»­å®šä¹‰å¤šä¸ªå˜é‡ï¼š int n = 20; auto *p = \u0026n, m = 99; å…ˆçœ‹å‰é¢çš„ç¬¬ä¸€ä¸ªå­è¡¨è¾¾å¼ï¼Œ\u0026n çš„ç±»å‹æ˜¯ int*ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ® auto *p æ¨å¯¼å‡º auto ä¸º intã€‚åé¢çš„ m å˜é‡è‡ªç„¶ä¹Ÿä¸º int ç±»å‹ï¼Œæ‰€ä»¥æŠŠ 99 èµ‹å€¼ç»™å®ƒä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚ è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„ï¼Œæ¨å¯¼çš„æ—¶å€™ä¸èƒ½æœ‰äºŒä¹‰æ€§ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œç¼–è¯‘å™¨æ ¹æ®ç¬¬ä¸€ä¸ªå­è¡¨è¾¾å¼å·²ç»æ¨å¯¼å‡º auto ä¸º int ç±»å‹ï¼Œé‚£ä¹ˆåé¢çš„ m ä¹Ÿåªèƒ½æ˜¯ int ç±»å‹ï¼Œå¦‚æœå†™ä½œm=12.5å°±æ˜¯é”™è¯¯çš„ï¼Œå› ä¸º 12.5 æ˜¯double ç±»å‹ï¼Œè¿™å’Œ int æ˜¯å†²çªçš„ã€‚ è¿˜æœ‰ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼šä½¿ç”¨ auto ç±»å‹æ¨å¯¼çš„å˜é‡å¿…é¡»é©¬ä¸Šåˆå§‹åŒ–ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸º auto åœ¨ C++11 ä¸­åªæ˜¯â€œå ä½ç¬¦â€ï¼Œå¹¶éå¦‚ int ä¸€æ ·çš„çœŸæ­£çš„ç±»å‹å£°æ˜ã€‚ auto çš„é«˜çº§ç”¨æ³• auto é™¤äº†å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ï¼Œè¿˜å¯ä»¥å’ŒæŸäº›å…·ä½“ç±»å‹æ··åˆä½¿ç”¨ï¼Œè¿™æ · auto è¡¨ç¤ºçš„å°±æ˜¯â€œåŠä¸ªâ€ç±»å‹ï¼Œè€Œä¸æ˜¯å®Œæ•´çš„ç±»å‹ã€‚è¯·çœ‹ä¸‹é¢çš„ä»£ç ï¼š int x = 0; auto *p1 = \u0026x; //p1 ä¸º int *ï¼Œauto æ¨å¯¼ä¸º int auto p2 = \u0026x; //p2 ä¸º int*ï¼Œauto æ¨å¯¼ä¸º int* auto \u0026r1 = x; //r1 ä¸º int\u0026ï¼Œauto æ¨å¯¼ä¸º int auto r2 = r1; //r2 ä¸º intï¼Œauto æ¨å¯¼ä¸º int ä¸‹é¢æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ï¼š ç¬¬ 2 è¡Œä»£ç ä¸­ï¼Œp1 ä¸º int* ç±»å‹ï¼Œä¹Ÿå³ auto * ä¸º int *ï¼Œæ‰€ä»¥ auto è¢«æ¨å¯¼æˆäº† int ç±»å‹ã€‚ ç¬¬ 3 è¡Œä»£ç ä¸­ï¼Œauto è¢«æ¨å¯¼ä¸º int* ç±»å‹ï¼Œå‰è¾¹çš„ä¾‹å­ä¹Ÿå·²ç»æ¼”ç¤ºè¿‡äº†ã€‚ ç¬¬ 4 è¡Œä»£ç ä¸­ï¼Œr1 ä¸º int \u0026 ç±»å‹ï¼Œauto è¢«æ¨å¯¼ä¸º int ç±»å‹ã€‚ ç¬¬ 5 è¡Œä»£ç æ˜¯éœ€è¦é‡ç‚¹è¯´æ˜çš„ï¼Œr1 æœ¬æ¥æ˜¯ int\u0026 ç±»å‹ï¼Œä½†æ˜¯ auto å´è¢«æ¨å¯¼ä¸º int ç±»å‹ï¼Œè¿™è¡¨æ˜å½“=å³è¾¹çš„è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹æ—¶ï¼Œauto ä¼šæŠŠå¼•ç”¨æŠ›å¼ƒï¼Œç›´æ¥æ¨å¯¼å‡ºå®ƒçš„åŸå§‹ç±»å‹ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ auto å’Œ const çš„ç»“åˆï¼š int x = 0; const auto n = x; //n ä¸º const int ï¼Œauto è¢«æ¨å¯¼ä¸º int auto f = n; //f ä¸º const intï¼Œauto è¢«æ¨å¯¼ä¸º intï¼ˆconst å±æ€§è¢«æŠ›å¼ƒï¼‰ const auto \u0026r1 = x; //r1 ä¸º const int\u0026 ç±»å‹ï¼Œauto è¢«æ¨å¯¼ä¸º int auto \u0026r2 = r1; //r1 ä¸º const int\u0026 ç±»å‹ï¼Œauto è¢«æ¨å¯¼ä¸º const int ç±»å‹`åœ¨è¿™é‡Œæ’å…¥ä»£ç ç‰‡` ä¸‹é¢æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ï¼š ç¬¬ 2 è¡Œä»£ç ä¸­ï¼Œn ä¸º const intï¼Œauto è¢«æ¨å¯¼ä¸º intã€‚ ç¬¬ 3 è¡Œä»£ç ä¸­ï¼Œn ä¸º const int ç±»å‹ï¼Œä½†æ˜¯ auto å´è¢«æ¨å¯¼ä¸º int ç±»å‹ï¼Œè¿™è¯´æ˜å½“=å³è¾¹çš„è¡¨è¾¾å¼å¸¦æœ‰ const å±æ€§æ—¶ï¼Œ auto ä¸ä¼šä½¿ç”¨ const å±æ€§ï¼Œè€Œæ˜¯ç›´æ¥æ¨å¯¼å‡º non-const ç±»å‹ã€‚ ç¬¬ 4 è¡Œä»£ç ä¸­ï¼Œauto è¢«æ¨å¯¼ä¸º int ç±»å‹ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“ç†è§£ï¼Œä¸å†èµ˜è¿°ã€‚ ç¬¬ 5 è¡Œä»£ç ä¸­ï¼Œr1 æ˜¯ const int \u0026 ç±»å‹ï¼Œauto ä¹Ÿè¢«æ¨å¯¼ä¸º const int ç±»å‹ï¼Œè¿™è¯´æ˜å½“ const å’Œå¼•ç”¨ç»“åˆæ—¶ï¼Œauto çš„æ¨å¯¼å°†ä¿ç•™è¡¨è¾¾å¼çš„ const ç±»å‹ã€‚ æœ€åæˆ‘ä»¬æ¥ç®€å•æ€»ç»“ä¸€ä¸‹ auto ä¸ const ç»“åˆçš„ç”¨æ³•ï¼š å½“ç±»å‹ä¸ä¸ºå¼•ç”¨æ—¶ï¼Œauto çš„æ¨å¯¼ç»“æœå°†ä¸ä¿ç•™è¡¨è¾¾å¼çš„ const å±æ€§ï¼› å½“ç±»å‹ä¸ºå¼•ç”¨æ—¶ï¼Œauto çš„æ¨å¯¼ç»“æœå°†ä¿ç•™è¡¨è¾¾å¼çš„ const å±æ€§ã€‚ auto çš„é™åˆ¶ å‰é¢ä»‹ç»æ¨å¯¼è§„åˆ™çš„æ—¶å€™æˆ‘ä»¬è¯´è¿‡ï¼Œä½¿ç”¨ auto çš„æ—¶å€™å¿…é¡»å¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ˜¯ auto çš„é™åˆ¶ä¹‹ä¸€ã€‚é‚£ä¹ˆï¼Œé™¤æ­¤ä»¥å¤–ï¼Œauto è¿˜æœ‰å“ªäº›å…¶å®ƒçš„é™åˆ¶å‘¢ï¼Ÿ auto ä¸èƒ½åœ¨å‡½æ•°çš„å‚æ•°ä¸­ä½¿ç”¨ã€‚ è¿™ä¸ªåº”è¯¥å¾ˆå®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬åœ¨å®šä¹‰å‡½æ•°çš„æ—¶å€™åªæ˜¯å¯¹å‚æ•°è¿›è¡Œäº†å£°æ˜ï¼ŒæŒ‡æ˜äº†å‚æ•°çš„ç±»å‹ï¼Œä½†å¹¶æ²¡æœ‰ç»™å®ƒèµ‹å€¼ï¼Œåªæœ‰åœ¨å®é™…è°ƒç”¨å‡½æ•°çš„æ—¶å€™æ‰ä¼šç»™å‚æ•°èµ‹å€¼ï¼›è€Œ auto è¦æ±‚å¿…é¡»å¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œæ‰€ä»¥è¿™æ˜¯çŸ›ç›¾çš„ã€‚ auto ä¸èƒ½ä½œç”¨äºç±»çš„éé™æ€æˆå‘˜å˜é‡ï¼ˆä¹Ÿå°±æ˜¯æ²¡æœ‰ static å…³é”®å­—ä¿®é¥°çš„æˆå‘˜å˜é‡ï¼‰ä¸­ã€‚ auto å…³é”®å­—ä¸èƒ½å®šä¹‰æ•°ç»„ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å°±æ˜¯é”™è¯¯çš„ï¼š char url[] = â€œhttp://c.biancheng.net/â€; auto str[] = url; //arr ä¸ºæ•°ç»„ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ auto auto ä¸èƒ½ä½œç”¨äºæ¨¡æ¿å‚æ•°ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š template \u003ctypename T\u003e class A{ //TODO: }; int main(){ A\u003cint\u003e C1; A\u003cauto\u003e C2 = C1; //é”™è¯¯ return 0; } auto çš„åº”ç”¨ ä½¿ç”¨ auto å®šä¹‰è¿­ä»£å™¨ auto çš„ä¸€ä¸ªå…¸å‹åº”ç”¨åœºæ™¯æ˜¯ç”¨æ¥å®šä¹‰ stl çš„è¿­ä»£å™¨ã€‚ æˆ‘ä»¬åœ¨ä½¿ç”¨ stl å®¹å™¨çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨è¿­ä»£å™¨æ¥éå†å®¹å™¨é‡Œé¢çš„å…ƒç´ ï¼›ä¸åŒå®¹å™¨çš„è¿­ä»£å™¨æœ‰ä¸åŒçš„ç±»å‹ï¼Œåœ¨å®šä¹‰è¿­ä»£å™¨æ—¶å¿…é¡»æŒ‡æ˜ã€‚è€Œè¿­ä»£å™¨çš„ç±»å‹æœ‰æ—¶å€™æ¯”è¾ƒå¤æ‚ï¼Œä¹¦å†™èµ·æ¥å¾ˆéº»çƒ¦ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š #include \u003cvector\u003e using namespace std; int main(){ vector\u003c vector\u003cint\u003e \u003e v; vector\u003c vector\u003cint\u003e \u003e::iterator i = v.begin(); return 0; } å¯ä»¥çœ‹å‡ºæ¥ï¼Œå®šä¹‰è¿­ä»£å™¨ i çš„æ—¶å€™ï¼Œç±»å‹ä¹¦å†™æ¯”è¾ƒå†—é•¿ï¼Œå®¹æ˜“å‡ºé”™ã€‚ç„¶è€Œæœ‰äº† auto ç±»å‹æ¨å¯¼ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…è¿™æ ·ï¼Œåªå†™ä¸€ä¸ª auto å³å¯ã€‚ ä¿®æ”¹ä¸Šé¢çš„ä»£ç ï¼Œä½¿ä¹‹å˜å¾—æ›´åŠ ç®€æ´ï¼š #include \u003cvector\u003e using namespace std; int main(){ vector\u003c vector\u003cint\u003e \u003e v; auto i = v.begin(); //ä½¿ç”¨ auto ä»£æ›¿å…·ä½“çš„ç±»å‹ return 0; } auto å¯ä»¥æ ¹æ®è¡¨è¾¾å¼ v.begin() çš„ç±»å‹ï¼ˆbegin() å‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼‰æ¥æ¨å¯¼å‡ºå˜é‡ i çš„ç±»å‹ã€‚ auto ç”¨äºæ³›å‹ç¼–ç¨‹ auto çš„å¦ä¸€ä¸ªåº”ç”¨å°±æ˜¯å½“æˆ‘ä»¬ä¸çŸ¥é“å˜é‡æ˜¯ä»€ä¹ˆç±»å‹ï¼Œæˆ–è€…ä¸å¸Œæœ›æŒ‡æ˜å…·ä½“ç±»å‹çš„æ—¶å€™ï¼Œæ¯”å¦‚æ³›å‹ç¼–ç¨‹ä¸­ã€‚æˆ‘ä»¬æ¥ç€çœ‹ä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; class A{ public: static int get(void){ return 100; } }; class B{ public: static const char* get(void){ return \"http://c.biancheng.net/cplus/\"; } }; template \u003ctypename T\u003e void func(void){ auto val = T::get(); cout \u003c\u003c val \u003c\u003c endl; } int main(void){ func\u003cA\u003e(); func\u003cB\u003e(); return 0; } è¿è¡Œç»“æœï¼š 100 æœ¬ä¾‹ä¸­çš„æ¨¡æ¿å‡½æ•° func() ä¼šè°ƒç”¨æ‰€æœ‰ç±»çš„é™æ€å‡½æ•° get()ï¼Œå¹¶å¯¹å®ƒçš„è¿”å›å€¼åšç»Ÿä¸€å¤„ç†ï¼Œä½†æ˜¯ get() çš„è¿”å›å€¼ç±»å‹å¹¶ä¸ä¸€æ ·ï¼Œè€Œä¸”ä¸èƒ½è‡ªåŠ¨è½¬æ¢ã€‚è¿™ç§è¦æ±‚åœ¨ä»¥","date":"2023-07-12","objectID":"/posts/newfeature/:1:2","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] decltypeç±»å‹æ¨å¯¼å®Œå…¨æ”»ç•¥ decltype æ˜¯ C++11 æ–°å¢çš„ä¸€ä¸ªå…³é”®å­—ï¼Œå®ƒå’Œ auto çš„åŠŸèƒ½ä¸€æ ·ï¼Œéƒ½ç”¨æ¥åœ¨ç¼–è¯‘æ—¶æœŸè¿›è¡Œè‡ªåŠ¨ç±»å‹æ¨å¯¼ã€‚ä¸äº†è§£ auto ç”¨æ³•çš„è¯»è€…è¯·è½¬åˆ°(ã€ŠC++ autoã€‹)[http://c.biancheng.net/view/6984.html]ã€‚ decltype æ˜¯â€œdeclare typeâ€çš„ç¼©å†™ï¼Œè¯‘ä¸ºâ€œå£°æ˜ç±»å‹â€ã€‚ æ—¢ç„¶å·²ç»æœ‰äº† auto å…³é”®å­—ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ decltype å…³é”®å­—å‘¢ï¼Ÿå› ä¸º auto å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰çš„è‡ªåŠ¨ç±»å‹æ¨å¯¼åœºæ™¯ï¼Œåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ auto ç”¨èµ·æ¥éå¸¸ä¸æ–¹ä¾¿ï¼Œç”šè‡³å‹æ ¹æ— æ³•ä½¿ç”¨ï¼Œæ‰€ä»¥ decltype å…³é”®å­—ä¹Ÿè¢«å¼•å…¥åˆ° C++11 ä¸­ã€‚ auto å’Œ decltype å…³é”®å­—éƒ½å¯ä»¥è‡ªåŠ¨æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ï¼Œä½†å®ƒä»¬çš„ç”¨æ³•æ˜¯æœ‰åŒºåˆ«çš„ï¼š auto varname = value; decltype(exp) varname = value; å…¶ä¸­ï¼Œvarname è¡¨ç¤ºå˜é‡åï¼Œvalue è¡¨ç¤ºèµ‹ç»™å˜é‡çš„å€¼ï¼Œexp è¡¨ç¤ºä¸€ä¸ªè¡¨è¾¾å¼ã€‚ auto æ ¹æ®=å³è¾¹çš„åˆå§‹å€¼ value æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ï¼Œè€Œ decltype æ ¹æ® exp è¡¨è¾¾å¼æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ï¼Œè·Ÿ=å³è¾¹çš„ value æ²¡æœ‰å…³ç³»ã€‚ å¦å¤–ï¼Œauto è¦æ±‚å˜é‡å¿…é¡»åˆå§‹åŒ–ï¼Œè€Œ decltype ä¸è¦æ±‚ã€‚è¿™å¾ˆå®¹æ˜“ç†è§£ï¼Œauto æ˜¯æ ¹æ®å˜é‡çš„åˆå§‹å€¼æ¥æ¨å¯¼å‡ºå˜é‡ç±»å‹çš„ï¼Œå¦‚æœä¸åˆå§‹åŒ–ï¼Œå˜é‡çš„ç±»å‹ä¹Ÿå°±æ— æ³•æ¨å¯¼äº†ã€‚decltype å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼ï¼š decltype(exp) varname; exp æ³¨æ„äº‹é¡¹ åŸåˆ™ä¸Šè®²ï¼Œexp å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„è¡¨è¾¾å¼ï¼Œå®ƒå¯ä»¥æ˜¯ä»»æ„å¤æ‚çš„å½¢å¼ï¼Œä½†æ˜¯æˆ‘ä»¬å¿…é¡»è¦ä¿è¯ exp çš„ç»“æœæ˜¯æœ‰ç±»å‹çš„ï¼Œä¸èƒ½æ˜¯ voidï¼›ä¾‹å¦‚ï¼Œå½“ exp è°ƒç”¨ä¸€ä¸ªè¿”å›å€¼ç±»å‹ä¸º void çš„å‡½æ•°æ—¶ï¼Œexp çš„ç»“æœä¹Ÿæ˜¯ void ç±»å‹ï¼Œæ­¤æ—¶å°±ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ C++ decltype ç”¨æ³•ä¸¾ä¾‹ï¼š int a = 0; decltype(a) b = 1; //b è¢«æ¨å¯¼æˆäº† int decltype(10.8) x = 5.5; //x è¢«æ¨å¯¼æˆäº† double decltype(x + 100) y; //y è¢«æ¨å¯¼æˆäº† double å¯ä»¥çœ‹åˆ°ï¼Œdecltype èƒ½å¤Ÿæ ¹æ®å˜é‡ã€å­—é¢é‡ã€å¸¦æœ‰è¿ç®—ç¬¦çš„è¡¨è¾¾å¼æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ã€‚è¯»è€…è¯·ç•™æ„ç¬¬ 4 è¡Œï¼Œy æ²¡æœ‰è¢«åˆå§‹åŒ–ã€‚ decltype æ¨å¯¼è§„åˆ™ ä¸Šé¢çš„ä¾‹å­è®©æˆ‘ä»¬åˆæ­¥æ„Ÿå—äº†ä¸€ä¸‹ decltype çš„ç”¨æ³•ï¼Œä½†ä½ ä¸è¦è®¤ä¸º decltype å°±è¿™ä¹ˆç®€å•ï¼Œå®ƒçš„ç©æ³•å®é™…ä¸Šå¯ä»¥éå¸¸å¤æ‚ã€‚å½“ç¨‹åºå‘˜ä½¿ç”¨ decltype(exp) è·å–ç±»å‹æ—¶ï¼Œç¼–è¯‘å™¨å°†æ ¹æ®ä»¥ä¸‹ä¸‰æ¡è§„åˆ™å¾—å‡ºç»“æœï¼š å¦‚æœ exp æ˜¯ä¸€ä¸ªä¸è¢«æ‹¬å·( )åŒ…å›´çš„è¡¨è¾¾å¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªç±»æˆå‘˜è®¿é—®è¡¨è¾¾å¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå•ç‹¬çš„å˜é‡ï¼Œé‚£ä¹ˆ decltype(exp) çš„ç±»å‹å°±å’Œ exp ä¸€è‡´ï¼Œè¿™æ˜¯æœ€æ™®éæœ€å¸¸è§çš„æƒ…å†µã€‚ å¦‚æœ exp æ˜¯å‡½æ•°è°ƒç”¨ï¼Œé‚£ä¹ˆ decltype(exp) çš„ç±»å‹å°±å’Œå‡½æ•°è¿”å›å€¼çš„ç±»å‹ä¸€è‡´ã€‚ å¦‚æœ exp æ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œæˆ–è€…è¢«æ‹¬å·( )åŒ…å›´ï¼Œé‚£ä¹ˆ decltype(exp) çš„ç±»å‹å°±æ˜¯ exp çš„å¼•ç”¨ï¼›å‡è®¾ exp çš„ç±»å‹ä¸º Tï¼Œé‚£ä¹ˆ decltype(exp) çš„ç±»å‹å°±æ˜¯ T\u0026ã€‚ ä¸ºäº†æ›´å¥½åœ°ç†è§£ decltype çš„æ¨å¯¼è§„åˆ™ï¼Œä¸‹é¢æ¥çœ‹å‡ ä¸ªå®é™…çš„ä¾‹å­ã€‚ ã€å®ä¾‹1ã€‘exp æ˜¯ä¸€ä¸ªæ™®é€šè¡¨è¾¾å¼ï¼š #include \u003cstring\u003e using namespace std; class Student{ public: static int total; string name; int age; float scores; }; int Student::total = 0; int main(){ int n = 0; const int \u0026r = n; Student stu; decltype(n) a = n; //n ä¸º int ç±»å‹ï¼Œa è¢«æ¨å¯¼ä¸º int ç±»å‹ decltype(r) b = n; //r ä¸º const int\u0026 ç±»å‹, b è¢«æ¨å¯¼ä¸º const int\u0026 ç±»å‹ decltype(Student::total) c = 0; //total ä¸ºç±» Student çš„ä¸€ä¸ª int ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œc è¢«æ¨å¯¼ä¸º int ç±»å‹ decltype(stu.name) url = \"http://c.biancheng.net/cplus/\"; //total ä¸ºç±» Student çš„ä¸€ä¸ª string ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œ url è¢«æ¨å¯¼ä¸º string ç±»å‹ return 0; } è¿™æ®µä»£ç å¾ˆç®€å•ï¼ŒæŒ‰ç…§æ¨å¯¼è§„åˆ™ 1ï¼Œå¯¹äºä¸€èˆ¬çš„è¡¨è¾¾å¼ï¼Œdecltype çš„æ¨å¯¼ç»“æœå°±å’Œè¿™ä¸ªè¡¨è¾¾å¼çš„ç±»å‹ä¸€è‡´ã€‚ ã€å®ä¾‹2ã€‘exp ä¸ºå‡½æ•°è°ƒç”¨ï¼š /å‡½æ•°å£°æ˜ int\u0026 func_int_r(int, char); //è¿”å›å€¼ä¸º int\u0026 int\u0026\u0026 func_int_rr(void); //è¿”å›å€¼ä¸º int\u0026\u0026 int func_int(double); //è¿”å›å€¼ä¸º int const int\u0026 fun_cint_r(int, int, int); //è¿”å›å€¼ä¸º const int\u0026 const int\u0026\u0026 func_cint_rr(void); //è¿”å›å€¼ä¸º const int\u0026\u0026 //decltypeç±»å‹æ¨å¯¼ int n = 100; decltype(func_int_r(100, 'A')) a = n; //a çš„ç±»å‹ä¸º int\u0026 decltype(func_int_rr()) b = 0; //b çš„ç±»å‹ä¸º int\u0026\u0026 decltype(func_int(10.5)) c = 0; //c çš„ç±»å‹ä¸º int decltype(fun_cint_r(1,2,3)) x = n; //x çš„ç±»å‹ä¸º const int \u0026 decltype(func_cint_rr()) y = 0; // y çš„ç±»å‹ä¸º const int\u0026\u0026 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œexp ä¸­è°ƒç”¨å‡½æ•°æ—¶éœ€è¦å¸¦ä¸Šæ‹¬å·å’Œå‚æ•°ï¼Œä½†è¿™ä»…ä»…æ˜¯å½¢å¼ï¼Œå¹¶ä¸ä¼šçœŸçš„å»æ‰§è¡Œå‡½æ•°ä»£ç ã€‚ ã€å®ä¾‹3ã€‘exp æ˜¯å·¦å€¼ï¼Œæˆ–è€…è¢«( )åŒ…å›´ï¼š using namespace std; class Base{ public: int x; }; int main(){ const Base obj; //å¸¦æœ‰æ‹¬å·çš„è¡¨è¾¾å¼ decltype(obj.x) a = 0; //obj.x ä¸ºç±»çš„æˆå‘˜è®¿é—®è¡¨è¾¾å¼ï¼Œç¬¦åˆæ¨å¯¼è§„åˆ™ä¸€ï¼Œa çš„ç±»å‹ä¸º int decltype((obj.x)) b = a; //obj.x å¸¦æœ‰æ‹¬å·ï¼Œç¬¦åˆæ¨å¯¼è§„åˆ™ä¸‰ï¼Œb çš„ç±»å‹ä¸º int\u0026ã€‚ //åŠ æ³•è¡¨è¾¾å¼ int n = 0, m = 0; decltype(n + m) c = 0; //n+m å¾—åˆ°ä¸€ä¸ªå³å€¼ï¼Œç¬¦åˆæ¨å¯¼è§„åˆ™ä¸€ï¼Œæ‰€ä»¥æ¨å¯¼ç»“æœä¸º int decltype(n = n + m) d = c; //n=n+m å¾—åˆ°ä¸€ä¸ªå·¦å€¼ï¼Œç¬¦å·æ¨å¯¼è§„åˆ™ä¸‰ï¼Œæ‰€ä»¥æ¨å¯¼ç»“æœä¸º int\u0026 return 0; } è¿™é‡Œæˆ‘ä»¬éœ€è¦é‡ç‚¹è¯´ä¸€ä¸‹å·¦å€¼å’Œå³å€¼ï¼šå·¦å€¼æ˜¯æŒ‡é‚£äº›åœ¨è¡¨è¾¾å¼æ‰§è¡Œç»“æŸåä¾ç„¶å­˜åœ¨çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æŒä¹…æ€§çš„æ•°æ®ï¼›å³å€¼æ˜¯æŒ‡é‚£äº›åœ¨è¡¨è¾¾å¼æ‰§è¡Œç»“æŸåä¸å†å­˜åœ¨çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¸´æ—¶æ€§çš„æ•°æ®ã€‚æœ‰ä¸€ç§å¾ˆç®€å•çš„æ–¹æ³•æ¥åŒºåˆ†å·¦å€¼å’Œå³å€¼ï¼Œå¯¹è¡¨è¾¾å¼å–åœ°å€ï¼Œå¦‚æœç¼–è¯‘å™¨ä¸æŠ¥é”™å°±ä¸ºå·¦å€¼ï¼Œå¦åˆ™ä¸ºå³å€¼ã€‚ decltype çš„å®é™…åº”ç”¨ auto çš„è¯­æ³•æ ¼å¼æ¯” decltype ç®€å•ï¼Œæ‰€ä»¥åœ¨ä¸€èˆ¬çš„ç±»å‹æ¨å¯¼ä¸­ï¼Œä½¿ç”¨ auto æ¯”ä½¿ç”¨ decltype æ›´åŠ æ–¹ä¾¿ï¼Œä½ å¯ä»¥è½¬åˆ°ã€ŠC++ autoã€‹æŸ¥çœ‹å¾ˆå¤šç±»ä¼¼çš„ä¾‹å­ï¼Œæœ¬èŠ‚ä»…æ¼”ç¤ºåªèƒ½ä½¿ç”¨ decltype çš„æƒ…å½¢ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œauto åªèƒ½ç”¨äºç±»çš„é™æ€æˆå‘˜ï¼Œä¸èƒ½ç”¨äºç±»çš„éé™æ€æˆå‘˜ï¼ˆæ™®é€šæˆå‘˜ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ¨å¯¼éé™æ€æˆå‘˜çš„ç±»å‹ï¼Œè¿™ä¸ªæ—¶å€™å°±å¿…é¡»ä½¿ç”¨ decltype äº†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ¨¡æ¿çš„å®šä¹‰ï¼š #include \u003cvector\u003e using namespace std; template \u003ctypename T\u003e class Base { public: void func(T\u0026 container) { m_it = container.begin(); } private: typename T::iterator m_it; //æ³¨æ„è¿™é‡Œ }; int main() { const vector\u003cint\u003e v; Base\u003cconst vector\u003cint\u003e\u003e obj; obj.func(v); return 0; } å•ç‹¬çœ‹ Base ç±»ä¸­ m_it æˆå‘˜çš„å®šä¹‰ï¼Œå¾ˆéš¾çœ‹å‡ºä¼šæœ‰ä»€ä¹ˆé”™è¯¯ï¼Œä½†åœ¨ä½¿ç”¨ Base ç±»çš„æ—¶å€™ï¼Œå¦‚æœä¼ å…¥ä¸€ä¸ª const ç±»å‹çš„å®¹å™¨ï¼Œç¼–è¯‘å™¨é©¬ä¸Šå°±ä¼šå¼¹å‡ºä¸€å¤§å †é”™è¯¯ä¿¡æ¯ã€‚åŸå› å°±åœ¨äºï¼ŒT::iteratorå¹¶ä¸èƒ½åŒ…æ‹¬æ‰€æœ‰çš„è¿­ä»£å™¨ç±»å‹ï¼Œå½“ T æ˜¯ä¸€ä¸ª const å®¹å™¨æ—¶ï¼Œåº”å½“ä½¿ç”¨ const_iteratorã€‚ è¦æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ä¹‹å‰çš„ C++98/03 ç‰ˆæœ¬ä¸‹åªèƒ½æƒ³åŠæ³•æŠŠ const ç±»å‹çš„å®¹å™¨ç”¨æ¨¡æ¿ç‰¹åŒ–å•ç‹¬å¤„ç†ï¼Œå¢åŠ äº†ä¸å°‘å·¥ä½œé‡ï¼Œçœ‹èµ·æ¥ä¹Ÿéå¸¸æ™¦æ¶©ã€‚ä½†æ˜¯æœ‰äº† C++11 çš„ decltype å…³é”®å­—ï¼Œå°±å¯ä»¥ç›´æ¥è¿™æ ·å†™ï¼š template \u003ctypename T\u003e class Base { public: void func(T\u0026 container) { m_it = container.begin(); } private: decltype(T().begin()) m_it; //æ³¨æ„è¿™é‡Œ }; çœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆæ¸…çˆ½ï¼Ÿ æ³¨æ„ï¼Œæœ‰äº›ä½ç‰ˆæœ¬çš„ç¼–è¯‘å™¨ä¸æ”¯æŒT().begin()","date":"2023-07-12","objectID":"/posts/newfeature/:1:3","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] æ±‡æ€»autoå’Œdecltypeçš„åŒºåˆ« é€šè¿‡(ã€ŠC++ autoã€‹)[http://c.biancheng.net/view/6984.html]å’Œ(ã€ŠC++ decltypeã€‹)[http://c.biancheng.net/view/7151.html]ä¸¤èŠ‚çš„å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»æŒæ¡äº† auto å’Œ decltype çš„è¯­æ³•è§„åˆ™ä»¥åŠä½¿ç”¨åœºæ™¯ï¼Œè¿™èŠ‚æˆ‘ä»¬å°† auto å’Œ decltype æ”¾åœ¨ä¸€èµ·ï¼Œç»¼åˆå¯¹æ¯”ä¸€ä¸‹å®ƒä»¬çš„åŒºåˆ«ï¼Œå¹¶å‘Šè¯‰å¤§å®¶è¯¥å¦‚ä½•é€‰æ‹©ã€‚ è¯­æ³•æ ¼å¼çš„åŒºåˆ« auto å’Œ decltype éƒ½æ˜¯ C++11 æ–°å¢çš„å…³é”®å­—ï¼Œéƒ½ç”¨äºè‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œä½†æ˜¯å®ƒä»¬çš„è¯­æ³•æ ¼å¼æ˜¯æœ‰åŒºåˆ«çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š auto varname = value; //autoçš„è¯­æ³•æ ¼å¼ decltype(exp) varname [= value]; //decltypeçš„è¯­æ³•æ ¼å¼ å…¶ä¸­ï¼Œvarname è¡¨ç¤ºå˜é‡åï¼Œvalue è¡¨ç¤ºèµ‹ç»™å˜é‡çš„å€¼ï¼Œexp è¡¨ç¤ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ–¹æ‹¬å·[ ]è¡¨ç¤ºå¯æœ‰å¯æ— ã€‚ auto å’Œ decltype éƒ½ä¼šè‡ªåŠ¨æ¨å¯¼å‡ºå˜é‡ varname çš„ç±»å‹ï¼š auto æ ¹æ®=å³è¾¹çš„åˆå§‹å€¼ value æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ï¼› decltype æ ¹æ® exp è¡¨è¾¾å¼æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹ï¼Œè·Ÿ=å³è¾¹çš„ value æ²¡æœ‰å…³ç³»ã€‚ å¦å¤–ï¼Œauto è¦æ±‚å˜é‡å¿…é¡»åˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯åœ¨å®šä¹‰å˜é‡çš„åŒæ—¶å¿…é¡»ç»™å®ƒèµ‹å€¼ï¼›è€Œ decltype ä¸è¦æ±‚ï¼Œåˆå§‹åŒ–ä¸å¦éƒ½ä¸å½±å“å˜é‡çš„ç±»å‹ã€‚è¿™å¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸º auto æ˜¯æ ¹æ®å˜é‡çš„åˆå§‹å€¼æ¥æ¨å¯¼å‡ºå˜é‡ç±»å‹çš„ï¼Œå¦‚æœä¸åˆå§‹åŒ–ï¼Œå˜é‡çš„ç±»å‹ä¹Ÿå°±æ— æ³•æ¨å¯¼äº†ã€‚ auto å°†å˜é‡çš„ç±»å‹å’Œåˆå§‹å€¼ç»‘å®šåœ¨ä¸€èµ·ï¼Œè€Œ decltype å°†å˜é‡çš„ç±»å‹å’Œåˆå§‹å€¼åˆ†å¼€ï¼›è™½ç„¶ auto çš„ä¹¦å†™æ›´åŠ ç®€æ´ï¼Œä½† decltype çš„ä½¿ç”¨æ›´åŠ çµæ´»ã€‚ è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š auto n1 = 10; decltype(10) n2 = 99; auto url1 = \"http://c.biancheng.net/cplus/\"; decltype(url1) url2 = \"http://c.biancheng.net/java/\"; auto f1 = 2.5; decltype(n1*6.7) f2; è¿™äº›ç”¨æ³•åœ¨å‰é¢çš„ä¸¤èŠ‚ä¸­å·²ç»è¿›è¡Œäº†åˆ†æï¼Œæ­¤å¤„å°±ä¸å†èµ˜è¿°äº†ã€‚ å¯¹ cv é™å®šç¬¦çš„å¤„ç† ã€Œcv é™å®šç¬¦ã€æ˜¯ const å’Œ volatile å…³é”®å­—çš„ç»Ÿç§°ï¼š const å…³é”®å­—ç”¨æ¥è¡¨ç¤ºæ•°æ®æ˜¯åªè¯»çš„ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½è¢«ä¿®æ”¹ï¼› volatile å’Œ const æ˜¯ç›¸åçš„ï¼Œå®ƒç”¨æ¥è¡¨ç¤ºæ•°æ®æ˜¯å¯å˜çš„ã€æ˜“å˜çš„ï¼Œç›®çš„æ˜¯ä¸è®© CPU å°†æ•°æ®ç¼“å­˜åˆ°å¯„å­˜å™¨ï¼Œè€Œæ˜¯ä»åŸå§‹çš„å†…å­˜ä¸­è¯»å–ã€‚ åœ¨æ¨å¯¼å˜é‡ç±»å‹æ—¶ï¼Œauto å’Œ decltype å¯¹ cv é™åˆ¶ç¬¦çš„å¤„ç†æ˜¯ä¸ä¸€æ ·çš„ã€‚decltype ä¼šä¿ç•™ cv é™å®šç¬¦ï¼Œè€Œ auto æœ‰å¯èƒ½ä¼šå»æ‰ cv é™å®šç¬¦ã€‚ ä»¥ä¸‹æ˜¯ auto å…³é”®å­—å¯¹ cv é™å®šç¬¦çš„æ¨å¯¼è§„åˆ™ï¼š å¦‚æœè¡¨è¾¾å¼çš„ç±»å‹ä¸æ˜¯æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼Œauto ä¼šæŠŠ cv é™å®šç¬¦ç›´æ¥æŠ›å¼ƒï¼Œæ¨å¯¼æˆ non-const æˆ–è€… non-volatile ç±»å‹ã€‚ å¦‚æœè¡¨è¾¾å¼çš„ç±»å‹æ˜¯æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼Œauto å°†ä¿ç•™ cv é™å®šç¬¦ã€‚ ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¯¹ const é™å®šç¬¦çš„æ¨å¯¼ï¼š //éæŒ‡é’ˆéå¼•ç”¨ç±»å‹ const int n1 = 0; auto n2 = 10; n2 = 99; //èµ‹å€¼ä¸æŠ¥é”™ decltype(n1) n3 = 20; n3 = 5; //èµ‹å€¼æŠ¥é”™ //æŒ‡é’ˆç±»å‹ const int *p1 = \u0026n1; auto p2 = p1; *p2 = 66; //èµ‹å€¼æŠ¥é”™ decltype(p1) p3 = p1; *p3 = 19; //èµ‹å€¼æŠ¥é”™ åœ¨ C++ ä¸­æ— æ³•å°†ä¸€ä¸ªå˜é‡çš„å®Œæ•´ç±»å‹è¾“å‡ºï¼Œæˆ‘ä»¬é€šè¿‡å¯¹å˜é‡èµ‹å€¼æ¥åˆ¤æ–­å®ƒæ˜¯å¦è¢« const ä¿®é¥°ï¼›å¦‚æœè¢« const ä¿®é¥°é‚£ä¹ˆèµ‹å€¼å¤±è´¥ï¼Œå¦‚æœä¸è¢« const ä¿®é¥°é‚£ä¹ˆèµ‹å€¼æˆåŠŸã€‚è™½ç„¶è¿™ç§æ–¹æ¡ˆä¸å¤ªç›´è§‚ï¼Œä½†ä¹Ÿæ˜¯èƒ½è¾¾åˆ°ç›®çš„çš„ã€‚ n2 èµ‹å€¼æˆåŠŸï¼Œè¯´æ˜ä¸å¸¦ constï¼Œä¹Ÿå°±æ˜¯ const è¢« auto æŠ›å¼ƒäº†ï¼Œè¿™éªŒè¯äº† auto çš„ç¬¬ä¸€æ¡æ¨å¯¼è§„åˆ™ã€‚p2 èµ‹å€¼å¤±è´¥ï¼Œè¯´æ˜æ˜¯å¸¦ const çš„ï¼Œä¹Ÿå°±æ˜¯ const æ²¡æœ‰è¢« auto æŠ›å¼ƒï¼Œè¿™éªŒè¯äº† auto çš„ç¬¬äºŒæ¡æ¨å¯¼è§„åˆ™ã€‚ n3 å’Œ p3 éƒ½èµ‹å€¼å¤±è´¥ï¼Œè¯´æ˜ decltype ä¸ä¼šå»æ‰è¡¨è¾¾å¼çš„ const å±æ€§ã€‚ å¯¹å¼•ç”¨çš„å¤„ç† å½“è¡¨è¾¾å¼çš„ç±»å‹ä¸ºå¼•ç”¨æ—¶ï¼Œauto å’Œ decltype çš„æ¨å¯¼è§„åˆ™ä¹Ÿä¸ä¸€æ ·ï¼›decltype ä¼šä¿ç•™å¼•ç”¨ç±»å‹ï¼Œè€Œ auto ä¼šæŠ›å¼ƒå¼•ç”¨ç±»å‹ï¼Œç›´æ¥æ¨å¯¼å‡ºå®ƒçš„åŸå§‹ç±»å‹ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; int main() { int n = 10; int \u0026r1 = n; //autoæ¨å¯¼ auto r2 = r1; r2 = 20; cout \u003c\u003c n \u003c\u003c \", \" \u003c\u003c r1 \u003c\u003c \", \" \u003c\u003c r2 \u003c\u003c endl; //decltypeæ¨å¯¼ decltype(r1) r3 = n; r3 = 99; cout \u003c\u003c n \u003c\u003c \", \" \u003c\u003c r1 \u003c\u003c \", \" \u003c\u003c r3 \u003c\u003c endl; return 0; } è¿è¡Œç»“æœï¼š 10, 10, 20 99, 99, 99 æ€»ç»“ ä»è¿è¡Œç»“æœå¯ä»¥å‘ç°ï¼Œç»™ r2 èµ‹å€¼å¹¶æ²¡æœ‰æ”¹å˜ n çš„å€¼ï¼Œè¿™è¯´æ˜ r2 æ²¡æœ‰æŒ‡å‘ nï¼Œè€Œæ˜¯è‡ªç«‹é—¨æˆ·ï¼Œå•ç‹¬æ‹¥æœ‰äº†ä¸€å—å†…å­˜ï¼Œè¿™å°±è¯æ˜ r ä¸å†æ˜¯å¼•ç”¨ç±»å‹ï¼Œå®ƒçš„å¼•ç”¨ç±»å‹è¢« auto æŠ›å¼ƒäº†ã€‚ ç»™ r3 èµ‹å€¼ï¼Œn çš„å€¼ä¹Ÿè·Ÿç€æ”¹å˜äº†ï¼Œè¿™è¯´æ˜ r3 ä»ç„¶æŒ‡å‘ nï¼Œå®ƒçš„å¼•ç”¨ç±»å‹è¢« decltype ä¿ç•™äº†ã€‚ auto è™½ç„¶åœ¨ä¹¦å†™æ ¼å¼ä¸Šæ¯” decltype ç®€å•ï¼Œä½†æ˜¯å®ƒçš„æ¨å¯¼è§„åˆ™å¤æ‚ï¼Œæœ‰æ—¶å€™ä¼šæ”¹å˜è¡¨è¾¾å¼çš„åŸå§‹ç±»å‹ï¼›è€Œ decltype æ¯”è¾ƒçº¯ç²¹ï¼Œå®ƒä¸€èˆ¬ä¼šåšæŒä¿ç•™åŸå§‹è¡¨è¾¾å¼çš„ä»»ä½•ç±»å‹ï¼Œè®©æ¨å¯¼çš„ç»“æœæ›´åŠ åŸæ±åŸå‘³ã€‚ ä»ä»£ç æ˜¯å¦å¥å£®çš„è§’åº¦è€ƒè™‘ï¼Œæˆ‘æ¨èä½¿ç”¨ decltypeï¼Œå®ƒæ²¡æœ‰é‚£ä¹ˆå¤šæ˜¯éï¼›ä½†æ˜¯ decltype æ€»æ˜¯æ˜¾å¾—æ¯”è¾ƒéº»çƒ¦ï¼Œå°¤å…¶æ˜¯å½“è¡¨è¾¾å¼æ¯”è¾ƒå¤æ‚æ—¶ï¼Œä¾‹å¦‚ï¼š vector nums; decltype(nums.begin()) it = nums.begin(); è€Œå¦‚æœä½¿ç”¨ auto å°±ä¼šæ¸…çˆ½å¾ˆå¤šï¼š vector nums; auto it = nums.begin(); åœ¨å®é™…å¼€å‘ä¸­äººä»¬ä»ç„¶å–œæ¬¢ä½¿ç”¨ auto å…³é”®å­—ï¼ˆæˆ‘ä¹Ÿè¿™ä¹ˆå¹²ï¼‰ï¼Œå› ä¸ºå®ƒç”¨èµ·æ¥ç®€å•ç›´è§‚ï¼Œæ›´ç¬¦åˆäººä»¬çš„å®¡ç¾ã€‚å¦‚æœä½ çš„è¡¨è¾¾å¼ç±»å‹ä¸å¤æ‚ï¼Œæˆ‘è¿˜æ˜¯æ¨èä½¿ç”¨ auto å…³é”®å­—ï¼Œä¼˜é›…çš„ä»£ç æ€»æ˜¯å«äººèµå¿ƒæ‚¦ç›®ï¼Œæ²‰æµ¸å…¶ä¸­ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:4","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] è¿”å›å€¼ç±»å‹åç½®ï¼ˆè·Ÿè¸ªè¿”å›å€¼ç±»å‹ï¼‰ åœ¨æ³›å‹ç¼–ç¨‹ä¸­ï¼Œå¯èƒ½éœ€è¦é€šè¿‡å‚æ•°çš„è¿ç®—æ¥å¾—åˆ°è¿”å›å€¼çš„ç±»å‹ã€‚è€ƒè™‘ä¸‹é¢è¿™ä¸ªåœºæ™¯ï¼š template \u003ctypename R, typename T, typename U\u003e R add(T t, U u) { return t+u; } int a = 1; float b = 2.0; auto c = add\u003cdecltype(a + b)\u003e(a, b); æˆ‘ä»¬å¹¶ä¸å…³å¿ƒ a+b çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œå› æ­¤ï¼Œåªéœ€è¦é€šè¿‡ decltype(a+b) ç›´æ¥å¾—åˆ°è¿”å›å€¼ç±»å‹å³å¯ã€‚ä½†æ˜¯åƒä¸Šé¢è¿™æ ·ä½¿ç”¨ååˆ†ä¸æ–¹ä¾¿ï¼Œå› ä¸ºå¤–éƒ¨å…¶å®å¹¶ä¸çŸ¥é“å‚æ•°ä¹‹é—´åº”è¯¥å¦‚ä½•è¿ç®—ï¼Œåªæœ‰ add å‡½æ•°æ‰çŸ¥é“è¿”å›å€¼åº”å½“å¦‚ä½•æ¨å¯¼ã€‚ é‚£ä¹ˆï¼Œåœ¨ add å‡½æ•°çš„å®šä¹‰ä¸Šèƒ½ä¸èƒ½ç›´æ¥é€šè¿‡ decltype æ‹¿åˆ°è¿”å›å€¼å‘¢ï¼Ÿ template \u003ctypename T, typename U\u003e decltype(t + u) add(T t, U u) // error: tã€uå°šæœªå®šä¹‰ { return t + u; } å½“ç„¶ï¼Œç›´æ¥åƒä¸Šé¢è¿™æ ·å†™æ˜¯ç¼–è¯‘ä¸è¿‡çš„ã€‚å› ä¸º tã€u åœ¨å‚æ•°åˆ—è¡¨ä¸­ï¼Œè€Œ C++ çš„è¿”å›å€¼æ˜¯å‰ç½®è¯­æ³•ï¼Œåœ¨è¿”å›å€¼å®šä¹‰çš„æ—¶å€™å‚æ•°å˜é‡è¿˜ä¸å­˜åœ¨ã€‚ å¯è¡Œçš„å†™æ³•å¦‚ä¸‹ï¼š template \u003ctypename T, typename U\u003e decltype(T() + U()) add(T t, U u) { return t + u; } è€ƒè™‘åˆ° Tã€U å¯èƒ½æ˜¯æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°çš„ç±»ï¼Œæ­£ç¡®çš„å†™æ³•åº”è¯¥æ˜¯è¿™æ ·ï¼š template \u003ctypename T, typename U\u003e decltype((*(T*)0) + (*(U*)0)) add(T t, U u) { return t + u; } è™½ç„¶æˆåŠŸåœ°ä½¿ç”¨ decltype å®Œæˆäº†è¿”å›å€¼çš„æ¨å¯¼ï¼Œä½†å†™æ³•è¿‡äºæ™¦æ¶©ï¼Œä¼šå¤§å¤§å¢åŠ  decltype åœ¨è¿”å›å€¼ç±»å‹æ¨å¯¼ä¸Šçš„ä½¿ç”¨éš¾åº¦å¹¶é™ä½ä»£ç çš„å¯è¯»æ€§ã€‚ å› æ­¤ï¼Œåœ¨ C++11 ä¸­å¢åŠ äº†è¿”å›ç±»å‹åç½®(trailing-return-typeï¼Œåˆç§°è·Ÿè¸ªè¿”å›ç±»å‹)è¯­æ³•ï¼Œå°† decltype å’Œ auto ç»“åˆèµ·æ¥å®Œæˆè¿”å›å€¼ç±»å‹çš„æ¨å¯¼ã€‚ è¿”å›ç±»å‹åç½®è¯­æ³•æ˜¯é€šè¿‡ auto å’Œ decltype ç»“åˆèµ·æ¥ä½¿ç”¨çš„ã€‚ä¸Šé¢çš„ add å‡½æ•°ï¼Œä½¿ç”¨æ–°çš„è¯­æ³•å¯ä»¥å†™æˆï¼š template \u003ctypename T, typename U\u003e auto add(T t, U u) -\u003e decltype(t + u) { return t + u; } ä¸ºäº†è¿›ä¸€æ­¥è¯´æ˜è¿™ä¸ªè¯­æ³•ï¼Œå†çœ‹å¦ä¸€ä¸ªä¾‹å­ï¼š int\u0026 foo(int\u0026 i); float foo(float\u0026 f); template \u003ctypename T\u003e auto func(T\u0026 val) -\u003e decltype(foo(val)) { return foo(val); } å¦‚æœè¯´å‰ä¸€ä¸ªä¾‹å­ä¸­çš„ add ä½¿ç”¨ C++98/03 çš„è¿”å›å€¼å†™æ³•è¿˜å‹‰å¼ºå¯ä»¥å®Œæˆï¼Œé‚£ä¹ˆè¿™ä¸ªä¾‹å­å¯¹äº C++ è€Œè¨€å°±æ˜¯ä¸å¯èƒ½å®Œæˆçš„ä»»åŠ¡äº†ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½¿ç”¨ decltype ç»“åˆè¿”å›å€¼åç½®è¯­æ³•å¾ˆå®¹æ˜“æ¨å¯¼å‡ºäº† foo(val) å¯èƒ½å‡ºç°çš„è¿”å›å€¼ç±»å‹ï¼Œå¹¶å°†å…¶ç”¨åˆ°äº† func ä¸Šã€‚ è¿”å›å€¼ç±»å‹åç½®è¯­æ³•ï¼Œæ˜¯ä¸ºäº†è§£å†³å‡½æ•°è¿”å›å€¼ç±»å‹ä¾èµ–äºå‚æ•°è€Œå¯¼è‡´éš¾ä»¥ç¡®å®šè¿”å›å€¼ç±»å‹çš„é—®é¢˜ã€‚æœ‰äº†è¿™ç§è¯­æ³•ä»¥åï¼Œå¯¹è¿”å›å€¼ç±»å‹çš„æ¨å¯¼å°±å¯ä»¥ç”¨æ¸…æ™°çš„æ–¹å¼ï¼ˆç›´æ¥é€šè¿‡å‚æ•°åšè¿ç®—ï¼‰æè¿°å‡ºæ¥ï¼Œè€Œä¸éœ€è¦åƒ C++98/03 é‚£æ ·ä½¿ç”¨æ™¦æ¶©éš¾æ‡‚çš„å†™æ³•ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:5","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] å¯¹æ¨¡æ¿å®ä¾‹åŒ–ä¸­è¿ç»­å³å°–æ‹¬å·Â»çš„æ”¹è¿› åœ¨ C++98/03 çš„æ³›å‹ç¼–ç¨‹ä¸­ï¼Œæ¨¡æ¿å®ä¾‹åŒ–æœ‰ä¸€ä¸ªå¾ˆçƒ¦ççš„åœ°æ–¹ï¼Œé‚£å°±æ˜¯è¿ç»­ä¸¤ä¸ªå³å°–æ‹¬å·ï¼ˆÂ»ï¼‰ä¼šè¢«ç¼–è¯‘å™¨è§£é‡Šæˆå³ç§»æ“ä½œç¬¦ï¼Œè€Œä¸æ˜¯æ¨¡æ¿å‚æ•°è¡¨çš„ç»“æŸã€‚ ã€å®ä¾‹ã€‘C++98/03 ä¸­ä¸æ”¯æŒè¿ç»­ä¸¤ä¸ªå³å°–æ‹¬å·çš„ç¤ºä¾‹ã€‚ template \u003ctypename T\u003e struct Foo { typedef T type; }; template \u003ctypename T\u003e class A { // ... }; int main(void) { Foo\u003cA\u003cint\u003e\u003e::type xx; //ç¼–è¯‘å‡ºé”™ return 0; } ä½¿ç”¨ gcc ç¼–è¯‘æ—¶ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹é”™è¯¯æç¤ºï¼š error: â€˜\u003e\u003eâ€™ should be â€˜\u003e\u003eâ€™ within a nested template argument list Foo\u003cA\u003e::type xx; æ„æ€å°±æ˜¯ï¼ŒFoo\u003cA\u003cint\u003e\u003eè¿™ç§å†™æ³•æ˜¯ä¸è¢«æ”¯æŒçš„ï¼Œè¦å†™æˆè¿™æ ·Foo\u003cA\u003cint\u003e \u003eï¼ˆæ³¨æ„ä¸¤ä¸ªå³å°–æ‹¬å·ä¹‹é—´çš„ç©ºæ ¼ï¼‰ã€‚ è¿™ç§é™åˆ¶æ— ç–‘æ˜¯å¾ˆæ²¡æœ‰å¿…è¦çš„ã€‚åœ¨ C++ çš„å„ç§æˆå¯¹æ‹¬å·ä¸­ï¼Œç›®å‰åªæœ‰å³å°–æ‹¬å·è¿ç»­å†™ä¸¤ä¸ªä¼šå‡ºç°è¿™ç§äºŒä¹‰æ€§ã€‚static_castã€reinterpret_cast ç­‰ C++ æ ‡å‡†è½¬æ¢è¿ç®—ç¬¦ï¼Œéƒ½æ˜¯ä½¿ç”¨\u003c\u003eæ¥è·å¾—å¾…è½¬æ¢ç±»å‹ï¼ˆtype-idï¼‰çš„ã€‚è‹¥è¿™ä¸ª type-id æœ¬èº«æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œç”¨èµ·æ¥ä¼šå¾ˆä¸æ–¹ä¾¿ã€‚ ç°åœ¨åœ¨ C++11 ä¸­ï¼Œè¿™ç§é™åˆ¶ç»ˆäºè¢«å–æ¶ˆäº†ã€‚åœ¨ C++11 æ ‡å‡†ä¸­ï¼Œè¦æ±‚ç¼–è¯‘å™¨å¯¹æ¨¡æ¿çš„å³å°–æ‹¬å·åšå•ç‹¬å¤„ç†ï¼Œä½¿ç¼–è¯‘å™¨èƒ½å¤Ÿæ­£ç¡®åˆ¤æ–­å‡ºÂ»æ˜¯ä¸€ä¸ªå³ç§»æ“ä½œç¬¦è¿˜æ˜¯æ¨¡æ¿å‚æ•°è¡¨çš„ç»“æŸæ ‡è®°ï¼ˆdelimiterï¼Œç•Œå®šç¬¦ï¼‰ã€‚ ä¸è¿‡è¿™ç§è‡ªåŠ¨åŒ–çš„å¤„ç†åœ¨æŸäº›æ—¶å€™ä¼šä¸è€æ ‡å‡†ä¸å…¼å®¹ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š template \u003cint N\u003e struct Foo { // ... }; int main(void) { Foo\u003c100 \u003e\u003e 2\u003e xx; return 0; } åœ¨ C++98/03 çš„ç¼–è¯‘å™¨ä¸­ç¼–è¯‘æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½† C++11 çš„ç¼–è¯‘å™¨ä¼šæ˜¾ç¤ºï¼š error: expected unqualif?ied-id before â€˜\u003eâ€™ token Foo\u003c100 Â» 2\u003e xx; è§£å†³çš„æ–¹æ³•æ˜¯è¿™æ ·å†™ï¼š Foo\u003c(100 Â» 2)\u003e xx; // æ³¨æ„æ‹¬å· è¿™ç§åŠ æ‹¬å·çš„å†™æ³•å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œä½¿å¾—åœ¨ä¹¦å†™æ—¶å€¾å‘äºå†™å‡ºæ— äºŒä¹‰æ€§çš„ä»£ç ã€‚ æ‰©å±•é˜…è¯» å„ç§ C++98/03 ç¼–è¯‘å™¨é™¤äº†æ”¯æŒæ ‡å‡†ï¼ˆISO/IEC 14882ï¼š2003 åŠå…¶ä¹‹å‰çš„æ ‡å‡†ï¼‰ä¹‹å¤–ï¼Œè¿˜è‡ªè¡Œåšäº†ä¸å°‘çš„æ‹“å±•ã€‚è¿™äº›æ‹“å±•ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œåæ¥ç»è¿‡äº† C++ å§”å‘˜ä¼šçš„æ–Ÿé…Œå’Œå®Œå–„ï¼Œè¿›å…¥äº† C++11ã€‚ æ‰€ä»¥æœ‰ä¸€éƒ¨åˆ† C++11 çš„æ–°ç‰¹å¾ï¼Œåœ¨ä¸€äº› C++98/03 çš„è€ç¼–è¯‘å™¨ä¸‹ä¹Ÿæ˜¯å¯ä»¥æ”¯æŒçš„ï¼Œåªæ˜¯ç”±äºæ²¡æœ‰æ ‡å‡†åŒ–ï¼Œæ— æ³•ä¿è¯å„ç§å¹³å°/ç¼–è¯‘å™¨ä¸‹çš„å…¼å®¹æ€§ã€‚æ¯”å¦‚åƒ Microsoft Visual C++2005 è¿™ç§ä¸æ”¯æŒ C++11 çš„ç¼–è¯‘å™¨ï¼Œåœ¨å¯¹æ¨¡æ¿å³å°–æ‹¬å·çš„å¤„ç†ä¸Šå’Œç°åœ¨çš„ C++11 æ˜¯ä¸€è‡´çš„ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:6","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] ä½¿ç”¨usingå®šä¹‰åˆ«åï¼ˆæ›¿ä»£typedefï¼‰ å¤§å®¶éƒ½çŸ¥é“ï¼Œåœ¨ C++ ä¸­å¯ä»¥é€šè¿‡ typedef é‡å®šä¹‰ä¸€ä¸ªç±»å‹ï¼š typedef unsigned int uint_t; è¢«é‡å®šä¹‰çš„ç±»å‹å¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œä»…ä»…åªæ˜¯åŸæœ‰çš„ç±»å‹å–äº†ä¸€ä¸ªæ–°çš„åå­—ã€‚å› æ­¤ï¼Œä¸‹é¢è¿™æ ·å°†ä¸æ˜¯åˆæ³•çš„å‡½æ•°é‡è½½ï¼š void func(unsigned int); void func(uint_t); // error: redefinition ä½¿ç”¨ typedef é‡å®šä¹‰ç±»å‹æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼Œæ¯”å¦‚ï¼Œæ— æ³•é‡å®šä¹‰ä¸€ä¸ªæ¨¡æ¿ã€‚ æƒ³è±¡ä¸‹é¢è¿™ä¸ªåœºæ™¯ï¼š typedef std::map\u003cstd::string, int\u003e map_int_t; // â€¦ typedef std::map\u003cstd::string, std::string\u003e map_str_t; // â€¦ æˆ‘ä»¬éœ€è¦çš„å…¶å®æ˜¯ä¸€ä¸ªå›ºå®šä»¥ std::string ä¸º key çš„ mapï¼Œå®ƒå¯ä»¥æ˜ å°„åˆ° int æˆ–å¦ä¸€ä¸ª std::stringã€‚ç„¶è€Œè¿™ä¸ªç®€å•çš„éœ€æ±‚ä»…é€šè¿‡ typedef å´å¾ˆéš¾åŠåˆ°ã€‚ å› æ­¤ï¼Œåœ¨ C++98/03 ä¸­å¾€å¾€ä¸å¾—ä¸è¿™æ ·å†™ï¼š template \u003ctypename Val\u003e struct str_map { typedef std::map\u003cstd::string, Val\u003e type; }; // ... str_map\u003cint\u003e::type map1; // ... ä¸€ä¸ªè™½ç„¶ç®€å•ä½†å´ç•¥æ˜¾çƒ¦ççš„ str_map å¤–æ•·ç±»æ˜¯å¿…è¦çš„ã€‚è¿™æ˜æ˜¾è®©æˆ‘ä»¬åœ¨å¤ç”¨æŸäº›æ³›å‹ä»£ç æ—¶éå¸¸éš¾å—ã€‚ ç°åœ¨ï¼Œåœ¨ C++11 ä¸­ç»ˆäºå‡ºç°äº†å¯ä»¥é‡å®šä¹‰ä¸€ä¸ªæ¨¡æ¿çš„è¯­æ³•ã€‚è¯·çœ‹ä¸‹é¢çš„ç¤ºä¾‹ï¼š template \u003ctypename Val\u003e using str_map_t = std::map\u003cstd::string, Val\u003e; // ... str_map_t\u003cint\u003e map1; è¿™é‡Œä½¿ç”¨æ–°çš„ using åˆ«åè¯­æ³•å®šä¹‰äº† std::map çš„æ¨¡æ¿åˆ«å str_map_tã€‚æ¯”èµ·å‰é¢ä½¿ç”¨å¤–æ•·æ¨¡æ¿åŠ  typedef æ„å»ºçš„ str_mapï¼Œå®ƒå®Œå…¨å°±åƒæ˜¯ä¸€ä¸ªæ–°çš„ map ç±»æ¨¡æ¿ï¼Œå› æ­¤ï¼Œç®€æ´äº†å¾ˆå¤šã€‚ å®é™…ä¸Šï¼Œusing çš„åˆ«åè¯­æ³•è¦†ç›–äº† typedef çš„å…¨éƒ¨åŠŸèƒ½ã€‚å…ˆæ¥çœ‹çœ‹å¯¹æ™®é€šç±»å‹çš„é‡å®šä¹‰ç¤ºä¾‹ï¼Œå°†è¿™ä¸¤ç§è¯­æ³•å¯¹æ¯”ä¸€ä¸‹ï¼š // é‡å®šä¹‰unsigned int typedef unsigned int uint_t; using uint_t = unsigned int; // é‡å®šä¹‰std::map typedef std::map\u003cstd::string, int\u003e map_int_t; using map_int_t = std::map\u003cstd::string, int\u003e; å¯ä»¥çœ‹åˆ°ï¼Œåœ¨é‡å®šä¹‰æ™®é€šç±»å‹ä¸Šï¼Œä¸¤ç§ä½¿ç”¨æ–¹æ³•çš„æ•ˆæœæ˜¯ç­‰ä»·çš„ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯å®šä¹‰è¯­æ³•ã€‚ typedef çš„å®šä¹‰æ–¹æ³•å’Œå˜é‡çš„å£°æ˜ç±»ä¼¼ï¼šåƒå£°æ˜ä¸€ä¸ªå˜é‡ä¸€æ ·ï¼Œå£°æ˜ä¸€ä¸ªé‡å®šä¹‰ç±»å‹ï¼Œä¹‹ååœ¨å£°æ˜ä¹‹å‰åŠ ä¸Š typedef å³å¯ã€‚è¿™ç§å†™æ³•å‡¸æ˜¾äº† C/C++ ä¸­çš„è¯­æ³•ä¸€è‡´æ€§ï¼Œä½†æœ‰æ—¶å´ä¼šå¢åŠ ä»£ç çš„é˜…è¯»éš¾åº¦ã€‚æ¯”å¦‚é‡å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ—¶ï¼š typedef void (*func_t)(int, int); ä¸ä¹‹ç›¸æ¯”ï¼Œusing åé¢æ€»æ˜¯ç«‹å³è·Ÿéšæ–°æ ‡è¯†ç¬¦ï¼ˆIdentifierï¼‰ï¼Œä¹‹åä½¿ç”¨ç±»ä¼¼èµ‹å€¼çš„è¯­æ³•ï¼ŒæŠŠç°æœ‰çš„ç±»å‹ï¼ˆtype-idï¼‰èµ‹ç»™æ–°ç±»å‹ï¼š using func_t = void (*)(int, int); ä»ä¸Šé¢çš„å¯¹æ¯”ä¸­å¯ä»¥å‘ç°ï¼ŒC++11 çš„ using åˆ«åè¯­æ³•æ¯” typedef æ›´åŠ æ¸…æ™°ã€‚å› ä¸º typedef çš„åˆ«åè¯­æ³•æœ¬è´¨ä¸Šç±»ä¼¼ä¸€ç§è§£æ–¹ç¨‹çš„æ€è·¯ã€‚è€Œ using è¯­æ³•é€šè¿‡èµ‹å€¼æ¥å®šä¹‰åˆ«åï¼Œå’Œæˆ‘ä»¬å¹³æ—¶çš„æ€è€ƒæ–¹å¼ä¸€è‡´ã€‚ ä¸‹é¢å†é€šè¿‡ä¸€ä¸ªå¯¹æ¯”ç¤ºä¾‹ï¼Œçœ‹çœ‹æ–°çš„ using è¯­æ³•æ˜¯å¦‚ä½•å®šä¹‰æ¨¡æ¿åˆ«åçš„ã€‚ /* C++98/03 */ template \u003ctypename T\u003e struct func_t { typedef void (*type)(T, T); }; // ä½¿ç”¨ func_t æ¨¡æ¿ func_t\u003cint\u003e::type xx_1; /* C++11 */ template \u003ctypename T\u003e using func_t = void (*)(T, T); // ä½¿ç”¨ func_t æ¨¡æ¿ func_t\u003cint\u003e xx_2; ä»ç¤ºä¾‹ä¸­å¯ä»¥çœ‹å‡ºï¼Œé€šè¿‡ using å®šä¹‰æ¨¡æ¿åˆ«åçš„è¯­æ³•ï¼Œåªæ˜¯åœ¨æ™®é€šç±»å‹åˆ«åè¯­æ³•çš„åŸºç¡€ä¸Šå¢åŠ  template çš„å‚æ•°åˆ—è¡¨ã€‚ä½¿ç”¨ using å¯ä»¥è½»æ¾åœ°åˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡æ¿åˆ«åï¼Œè€Œä¸éœ€è¦åƒ C++98/03 é‚£æ ·ä½¿ç”¨çƒ¦ççš„å¤–æ•·æ¨¡æ¿ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œusing è¯­æ³•å’Œ typedef ä¸€æ ·ï¼Œå¹¶ä¸ä¼šåˆ›é€ æ–°çš„ç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢ç¤ºä¾‹ä¸­ C++11 çš„ using å†™æ³•åªæ˜¯ typedef çš„ç­‰ä»·ç‰©ã€‚è™½ç„¶ using é‡å®šä¹‰çš„ func_t æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œä½† func_t å®šä¹‰çš„ xx_2 å¹¶ä¸æ˜¯ä¸€ä¸ªç”±ç±»æ¨¡æ¿å®ä¾‹åŒ–åçš„ç±»ï¼Œè€Œæ˜¯ void(*)(int, int) çš„åˆ«åã€‚ å› æ­¤ï¼Œä¸‹é¢è¿™æ ·å†™ï¼š void foo(void (*func_call)(int, int)); void foo(func_t func_call); // error: redefinition åŒæ ·æ˜¯æ— æ³•å®ç°é‡è½½çš„ï¼Œfunc_t åªæ˜¯ void(*)(int, int) ç±»å‹çš„ç­‰ä»·ç‰©ã€‚ ç»†å¿ƒçš„è¯»è€…å¯ä»¥å‘ç°ï¼Œusing é‡å®šä¹‰çš„ func_t æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œä½†å®ƒæ—¢ä¸æ˜¯ç±»æ¨¡æ¿ä¹Ÿä¸æ˜¯å‡½æ•°æ¨¡æ¿ï¼ˆå‡½æ•°æ¨¡æ¿å®ä¾‹åŒ–åæ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰ï¼Œè€Œæ˜¯ä¸€ç§æ–°çš„æ¨¡æ¿å½¢å¼ï¼šæ¨¡æ¿åˆ«å(alias template)ã€‚ å…¶å®ï¼Œé€šè¿‡ using å¯ä»¥è½»æ¾å®šä¹‰ä»»æ„ç±»å‹çš„æ¨¡æ¿è¡¨è¾¾æ–¹å¼ã€‚æ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼š template using type_t = T; // â€¦ type_t i; type_t å®ä¾‹åŒ–åçš„ç±»å‹å’Œå®ƒçš„æ¨¡æ¿å‚æ•°ç±»å‹ç­‰ä»·ã€‚è¿™é‡Œï¼Œtype_t å°†ç­‰ä»·äº intã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:7","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] æ”¯æŒå‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•° åœ¨ C++98/03 æ ‡å‡†ä¸­ï¼Œç±»æ¨¡æ¿å¯ä»¥æœ‰é»˜è®¤çš„æ¨¡æ¿å‚æ•°ï¼Œå¦‚ä¸‹ï¼š template \u003ctypename T, typename U = int, U N = 0\u003e struct Foo { // ... }; ä½†æ˜¯å´ä¸æ”¯æŒå‡½æ•°çš„é»˜è®¤æ¨¡æ¿å‚æ•°ï¼š template \u003ctypename T = int\u003e // error in C++98/03: default template arguments void func() { // ... } ç°åœ¨è¿™ä¸€é™åˆ¶åœ¨ C++11 ä¸­è¢«è§£é™¤äº†ã€‚ä¸Šé¢çš„ func å‡½æ•°åœ¨ C++11 ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä»£ç å¦‚ä¸‹ï¼š int main(void) { func(); //T = int return 0; } æ­¤æ—¶æ¨¡æ¿å‚æ•° T çš„ç±»å‹å°±ä¸ºé»˜è®¤å€¼ intã€‚ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œå½“æ‰€æœ‰æ¨¡æ¿å‚æ•°éƒ½æœ‰é»˜è®¤å‚æ•°æ—¶ï¼Œå‡½æ•°æ¨¡æ¿çš„è°ƒç”¨å¦‚åŒä¸€ä¸ªæ™®é€šå‡½æ•°ã€‚ä½†å¯¹äºç±»æ¨¡æ¿è€Œè¨€ï¼Œå“ªæ€•æ‰€æœ‰å‚æ•°éƒ½æœ‰é»˜è®¤å‚æ•°ï¼Œåœ¨ä½¿ç”¨æ—¶ä¹Ÿå¿…é¡»åœ¨æ¨¡æ¿ååè·Ÿéš\u003c\u003eæ¥å®ä¾‹åŒ–ã€‚ é™¤äº†ä¸Šé¢æåˆ°çš„éƒ¨åˆ†ä¹‹å¤–ï¼Œå‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°åœ¨ä½¿ç”¨è§„åˆ™ä¸Šå’Œå…¶ä»–çš„é»˜è®¤å‚æ•°ä¹Ÿæœ‰ä¸€äº›ä¸åŒï¼Œå®ƒæ²¡æœ‰å¿…é¡»å†™åœ¨å‚æ•°è¡¨æœ€åçš„é™åˆ¶ã€‚ç”šè‡³äºï¼Œæ ¹æ®å®é™…åœºæ™¯ä¸­å‡½æ•°æ¨¡æ¿è¢«è°ƒç”¨çš„æƒ…å½¢ï¼Œç¼–è¯‘å™¨è¿˜å¯ä»¥è‡ªè¡Œæ¨å¯¼å‡ºéƒ¨åˆ†æ¨¡æ¿å‚æ•°çš„ç±»å‹ã€‚ è¿™æ„å‘³ç€ï¼Œå½“é»˜è®¤æ¨¡æ¿å‚æ•°å’Œç¼–è¯‘å™¨è‡ªè¡Œæ¨å¯¼å‡ºæ¨¡æ¿å‚æ•°ç±»å‹çš„èƒ½åŠ›ä¸€èµ·ç»“åˆä½¿ç”¨æ—¶ï¼Œä»£ç çš„ä¹¦å†™å°†å˜å¾—å¼‚å¸¸çµæ´»ã€‚æˆ‘ä»¬å¯ä»¥æŒ‡å®šå‡½æ•°ä¸­çš„ä¸€éƒ¨åˆ†æ¨¡æ¿å‚æ•°é‡‡ç”¨é»˜è®¤å‚æ•°ï¼Œè€Œå¦ä¸€éƒ¨åˆ†ä½¿ç”¨è‡ªåŠ¨æ¨å¯¼ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š template \u003ctypename R = int, typename U\u003e R func(U val) { return val; } int main() { func(97); // R=int, U=int func\u003cchar\u003e(97); // R=char, U=int func\u003cdouble, int\u003e(97); // R=double, U=int return 0; } C++11 æ ‡å‡†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åƒ func(97) è¿™æ ·è°ƒç”¨æ¨¡æ¿å‡½æ•°ï¼Œå› ä¸ºç¼–è¯‘å™¨å¯ä»¥æ ¹æ®å®å‚ 97 è‡ªè¡Œæ¨å¯¼å‡ºæ¨¡æ¿å‚æ•° U çš„ç±»å‹ä¸º intï¼Œå¹¶ä¸”æ ¹æ®è¿”å›å€¼ val=97 æ¨å¯¼å‡º R çš„ç±»å‹ä¹Ÿä¸º intï¼›è€Œ func(97) æ‰‹åŠ¨æŒ‡å®šäº†æ¨¡æ¿å‚æ•° R çš„ç±»å‹ä¸º charï¼ˆé»˜è®¤æ¨¡æ¿å‚æ•°å°†æ— æ•ˆï¼‰ï¼Œå¹¶é€šè¿‡å®å‚ 97 æ¨å¯¼å‡ºäº† U = intï¼›æœ€å func\u003cdouble,int\u003e(97) æ‰‹åŠ¨æŒ‡å®šçš„ R å’Œ U çš„ç±»å‹å€¼ï¼Œå› æ­¤æ— éœ€ç¼–è¯‘å™¨è‡ªè¡Œæ¨å¯¼ã€‚ å†æ¬¡å¼ºè°ƒï¼Œå½“é»˜è®¤æ¨¡æ¿å‚æ•°å’Œè‡ªè¡Œæ¨å¯¼çš„æ¨¡æ¿å‚æ•°åŒæ—¶ä½¿ç”¨æ—¶ï¼Œè‹¥æ— æ³•æ¨å¯¼å‡ºå‡½æ•°æ¨¡æ¿å‚æ•°çš„ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šé€‰æ‹©ä½¿ç”¨é»˜è®¤æ¨¡æ¿å‚æ•°ï¼›å¦‚æœæ¨¡æ¿å‚æ•°å³æ— æ³•æ¨å¯¼å‡ºæ¥ï¼Œåˆæœªè®¾ç½®å…¶é»˜è®¤å€¼ï¼Œåˆ™ç¼–è¯‘å™¨ç›´æ¥æŠ¥é”™ã€‚ä¾‹å¦‚ï¼š template \u003ctypename T, typename U = double\u003e void func(T val1 = 0, U val2 = 0) { //... } int main() { func('c'); //T=char, U=double func(); //ç¼–è¯‘æŠ¥é”™ return 0; } å…¶ä¸­ï¼Œfunc(â€˜câ€™) çš„è¿™ç§è°ƒç”¨æ–¹å¼ï¼Œç¼–è¯‘å™¨é€šè¿‡å®å‚ â€˜câ€™ å¯ä»¥æ¨å¯¼å‡º T=charï¼Œä½†ç”±äºæœªä¼ é€’ç¬¬ 2 ä¸ªå®å‚ï¼Œå› æ­¤æ¨¡æ¿å‚æ•° U ä½¿ç”¨çš„æ˜¯é»˜è®¤å‚æ•° doubleï¼›ä½† func() çš„è°ƒç”¨æ–¹å¼æ˜¯ä¸è¡Œçš„ï¼Œè™½ç„¶ val1 è®¾ç½®æœ‰é»˜è®¤å€¼ï¼Œä½†ç¼–è¯‘å™¨æ— æ³•é€šè¿‡è¯¥é»˜è®¤å€¼æ¨å¯¼å‡ºæ¨¡æ¿å‚æ•° T çš„ç±»å‹ã€‚ç”±æ­¤ä¸éš¾çœ‹å‡ºï¼Œç¼–è¯‘å™¨çš„è‡ªåŠ¨æ¨å¯¼èƒ½åŠ›å¹¶æ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆå¼ºå¤§ã€‚ æ€»çš„æ¥è¯´ï¼ŒC++11 æ”¯æŒä¸ºå‡½æ•°æ¨¡æ¿ä¸­çš„å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œåœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨é»˜è®¤å€¼ï¼Œä¹Ÿå¯ä»¥å°è¯•ç”±ç¼–è¯‘å™¨è‡ªè¡Œæ¨å¯¼å¾—åˆ°ï¼Œè¿˜å¯ä»¥äº²è‡ªæŒ‡å®šå„ä¸ªæ¨¡æ¿å‚æ•°çš„ç±»å‹ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:8","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] åœ¨å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿ä¸­ä½¿ç”¨å¯å˜å‚æ•° æ‰€è°“å¯å˜å‚æ•°ï¼ŒæŒ‡çš„æ˜¯å‚æ•°çš„ä¸ªæ•°å’Œç±»å‹éƒ½å¯ä»¥æ˜¯ä»»æ„çš„ã€‚æåˆ°å‚æ•°ï¼Œå¤§å®¶ä¼šç¬¬ä¸€æ—¶é—´æƒ³åˆ°å‡½æ•°å‚æ•°ï¼Œé™¤æ­¤ä¹‹å¤– C++ çš„æ¨¡æ¿(åŒ…æ‹¬å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿)ä¹Ÿä¼šç”¨åˆ°å‚æ•°ã€‚ å¯¹äºå‡½æ•°å‚æ•°è€Œè¨€ï¼ŒC++ ä¸€ç›´éƒ½æ”¯æŒä¸ºå‡½æ•°è®¾ç½®å¯å˜å‚æ•°ï¼Œæœ€å…¸å‹çš„ä»£è¡¨å°±æ˜¯ printf() å‡½æ•°ï¼Œå®ƒçš„è¯­æ³•æ ¼å¼ä¸ºï¼š int printf ( const char * format, ... ); ...å°±è¡¨ç¤ºçš„æ˜¯å¯å˜å‚æ•°ï¼Œå³ printf() å‡½æ•°å¯ä»¥æ¥æ”¶ä»»æ„ä¸ªå‚æ•°ï¼Œä¸”å„ä¸ªå‚æ•°çš„ç±»å‹å¯ä»¥ä¸åŒï¼Œä¾‹å¦‚ï¼š printf(\"%d\", 10);printf(\"%d %c\",10, 'A');printf(\"%d %c %f\",10, 'A', 1.23); æˆ‘ä»¬é€šå¸¸å°†å®¹çº³å¤šä¸ªå‚æ•°çš„å¯å˜å‚æ•°ç§°ä¸ºå‚æ•°åŒ…ã€‚å€ŸåŠ© format å­—ç¬¦ä¸²ï¼Œprintf() å‡½æ•°å¯ä»¥è½»æ¾åˆ¤æ–­å‡ºå‚æ•°åŒ…ä¸­çš„å‚æ•°ä¸ªæ•°å’Œç±»å‹ã€‚ ä¸‹é¢çš„ç¨‹åºä¸­ï¼Œè‡ªå®šä¹‰äº†ä¸€ä¸ªç®€å•çš„å¯å˜å‚æ•°å‡½æ•°ï¼š #include \u003ciostream\u003e #include \u003ccstdarg\u003e //å¯å˜å‚æ•°çš„å‡½æ•° void vair_fun(int count, ...){ va_list args; va_start(args, count); for (int i = 0; i \u003c count; ++i) { int arg = va_arg(args, int); std::cout \u003c\u003c arg \u003c\u003c \" \"; } va_end(args); } int main(){ //å¯å˜å‚æ•°æœ‰ 4 ä¸ªï¼Œåˆ†åˆ«ä¸º 10ã€20ã€30ã€40 vair_fun(4, 10, 20, 30,40); return 0; } ç¨‹åºä¸­çš„ vair_fun() å‡½æ•°æœ‰ 2 ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ countï¼Œå¦ä¸€ä¸ªå°±æ˜¯ â€¦ å¯å˜å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ count å‚æ•°ï¼Œä½†è¦æƒ³ä½¿ç”¨å‚æ•°åŒ…ä¸­çš„å‚æ•°ï¼Œéœ€è¦å€ŸåŠ©å¤´æ–‡ä»¶ä¸­çš„ va_startã€va_arg ä»¥åŠ va_end è¿™ 3 ä¸ªå¸¦å‚æ•°çš„å®ï¼š va_start(args, count)ï¼šargs æ˜¯ va_list ç±»å‹çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„å°†å…¶è§†ä¸º char * ç±»å‹ã€‚å€ŸåŠ© count å‚æ•°ï¼Œæ‰¾åˆ°å¯å˜å‚æ•°çš„èµ·å§‹ä½ç½®å¹¶èµ‹å€¼ç»™ argsï¼› va_arg(args, int)ï¼šè°ƒç”¨ va_start æ‰¾åˆ°å¯å˜å‚æ•°èµ·å§‹ä½ç½®çš„å‰æä¸‹ï¼Œé€šè¿‡æŒ‡æ˜å‚æ•°ç±»å‹ä¸º intï¼Œva_arg å°±å¯ä»¥å°†å¯å˜å‚æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿”å›ï¼› va_end(args)ï¼šä¸å†ä½¿ç”¨ args å˜é‡åï¼Œåº”åŠæ—¶è°ƒç”¨ va_end å®æ¸…ç† args å˜é‡ã€‚ æ³¨æ„ï¼Œå€ŸåŠ© va_arg è·å–å‚æ•°åŒ…ä¸­çš„å‚æ•°æ—¶ï¼Œva_arg ä¸å…·å¤‡è‡ªè¡Œç»ˆæ­¢çš„èƒ½åŠ›ï¼Œæ‰€ä»¥ç¨‹åºä¸­å€ŸåŠ© count å‚æ•°æ§åˆ¶ va_arg çš„æ‰§è¡Œæ¬¡æ•°ï¼Œç»§è€Œå°†æ‰€æœ‰çš„å‚æ•°è¯»å–å‡ºæ¥ã€‚æ§åˆ¶ va_arg æ‰§è¡Œæ¬¡æ•°è¿˜æœ‰å…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚è¯»å–åˆ°æŒ‡å®šæ•°æ®æ—¶ç»ˆæ­¢ã€‚ ä½¿ç”¨ â€¦ å¯å˜å‚æ•°çš„è¿‡ç¨‹ä¸­ï¼Œéœ€æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š â€¦ å¯å˜å‚æ•°å¿…é¡»ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œä¸”ä¸€ä¸ªå‡½æ•°æœ€å¤šåªèƒ½æ‹¥æœ‰ 1 ä¸ªå¯å˜å‚æ•°ã€‚ å¯å˜å‚æ•°çš„å‰é¢è‡³å°‘è¦æœ‰ 1 ä¸ªæœ‰åå‚æ•°ï¼ˆä¾‹å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„ count å‚æ•°ï¼‰ï¼› å½“å¯å˜å‚æ•°ä¸­åŒ…å« char ç±»å‹çš„å‚æ•°æ—¶ï¼Œva_arg å®è¦ä»¥ int ç±»å‹çš„æ–¹å¼è¯»å–ï¼›å½“å¯å˜å‚æ•°ä¸­åŒ…å« short ç±»å‹çš„å‚æ•°æ—¶ï¼Œva_arg å®è¦ä»¥ double ç±»å‹çš„æ–¹å¼è¯»å–ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œâ€¦å¯å˜å‚æ•°çš„æ–¹æ³•ä»…é€‚ç”¨äºå‡½æ•°å‚æ•°ï¼Œå¹¶ä¸é€‚ç”¨äºæ¨¡æ¿å‚æ•°ã€‚C++11 æ ‡å‡†ä¸­ï¼Œæä¾›äº†ä¸€ç§å®ç°\u003c/font color=red\u003eå¯å˜æ¨¡æ¿å‚æ•°çš„æ–¹æ³•ã€‚ å¯å˜å‚æ•°æ¨¡æ¿ C++ 11 æ ‡å‡†å‘å¸ƒä¹‹å‰ï¼Œå‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿åªèƒ½è®¾å®šå›ºå®šæ•°é‡çš„æ¨¡æ¿å‚æ•°ã€‚C++11 æ ‡å‡†å¯¹æ¨¡æ¿çš„åŠŸèƒ½è¿›è¡Œäº†æ‰©å±•ï¼Œå…è®¸æ¨¡æ¿ä¸­åŒ…å«ä»»æ„æ•°é‡çš„æ¨¡æ¿å‚æ•°ï¼Œè¿™æ ·çš„æ¨¡æ¿åˆç§°å¯å˜å‚æ•°æ¨¡æ¿ã€‚ ï¼ˆ1ï¼‰å¯å˜å‚æ•°å‡½æ•°æ¨¡æ¿ å…ˆè®²è§£å‡½æ•°æ¨¡æ¿ï¼Œå¦‚ä¸‹å®šä¹‰äº†ä¸€ä¸ªå¯å˜å‚æ•°çš„å‡½æ•°æ¨¡æ¿ï¼š template\u003ctypename... T\u003e void vair_fun(T...args) { //å‡½æ•°ä½“ } æ¨¡æ¿å‚æ•°ä¸­ï¼Œ typenameï¼ˆæˆ–è€… classï¼‰åè·Ÿ â€¦ å°±è¡¨æ˜ T æ˜¯ä¸€ä¸ªå¯å˜æ¨¡æ¿å‚æ•°ï¼Œå®ƒå¯ä»¥æ¥æ”¶å¤šç§æ•°æ®ç±»å‹ï¼Œåˆç§°æ¨¡æ¿å‚æ•°åŒ…ã€‚vair_fun() å‡½æ•°ä¸­ï¼Œargs å‚æ•°çš„ç±»å‹ç”¨ Tâ€¦ è¡¨ç¤ºï¼Œè¡¨ç¤º args å‚æ•°å¯ä»¥æ¥æ”¶ä»»æ„ä¸ªå‚æ•°ï¼Œåˆç§°å‡½æ•°å‚æ•°åŒ…ã€‚ è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œæ­¤å‡½æ•°æ¨¡æ¿æœ€ç»ˆå®ä¾‹åŒ–å‡ºçš„ vair_fun() å‡½æ•°å¯ä»¥æŒ‡å®šä»»æ„ç±»å‹ã€ä»»æ„æ•°é‡çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¨¡æ¿ï¼š vair_fun(); vair_fun(1, \"abc\"); vair_fun(1, \"abc\", 1.23); ä½¿ç”¨å¯å˜å‚æ•°æ¨¡æ¿çš„éš¾ç‚¹åœ¨äºï¼Œå¦‚ä½•åœ¨æ¨¡æ¿å‡½æ•°å†…éƒ¨â€œè§£å¼€â€å‚æ•°åŒ…ï¼ˆä½¿ç”¨åŒ…å†…çš„æ•°æ®ï¼‰ï¼Œè¿™é‡Œç»™å¤§å®¶ä»‹ç»ä¸¤ç§ç®€å•çš„æ–¹æ³•ã€‚ [é€’å½’æ–¹å¼è§£åŒ…] å…ˆçœ‹ä¸€ä¸ªå®ä¾‹ï¼š #include \u003ciostream\u003e using namespace std; //æ¨¡æ¿å‡½æ•°é€’å½’çš„å‡ºå£ void vir_fun() { } template \u003ctypename T, typename... args\u003e void vir_fun(T argc, args... argv) { cout \u003c\u003c argc \u003c\u003c endl; //å¼€å§‹é€’å½’ï¼Œå°†ç¬¬ä¸€ä¸ªå‚æ•°å¤–çš„ argv å‚æ•°åŒ…é‡æ–°ä¼ é€’ç»™ vir_fun vir_fun(argv...); } int main() { vir_fun(1, \"http://www.biancheng.net\", 2.34); return 0; } æ‰§è¡Œç»“æœä¸ºï¼š 1 http://www.biancheng.net 2.34 åˆ†æä¸€ä¸ªç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼š é¦–å…ˆï¼Œmain() å‡½æ•°è°ƒç”¨ vir_fun() æ¨¡æ¿å‡½æ•°æ—¶ï¼Œæ ¹æ®æ‰€ä¼ å®å‚çš„å€¼ï¼Œå¯ä»¥å¾ˆè½»æ˜“åœ°åˆ¤æ–­å‡ºæ¨¡æ¿å‚æ•° T çš„ç±»å‹ä¸º intï¼Œå‡½æ•°å‚æ•° argc çš„å€¼ä¸º 1ï¼Œå‰©ä½™çš„æ¨¡æ¿å‚æ•°å’Œå‡½æ•°å‚æ•°éƒ½åˆ†åˆ«ä½äº args å’Œ argv ä¸­ï¼› vir_fun() å‡½æ•°ä¸­ï¼Œé¦–å…ˆè¾“å‡ºäº† argc çš„å€¼ï¼ˆä¸º 1ï¼‰ï¼Œç„¶åé‡å¤è°ƒç”¨è‡ªèº«ï¼ŒåŒæ—¶å°†å‡½æ•°å‚æ•°åŒ… argv ä¸­çš„æ•°æ®ä½œä¸ºå®å‚ä¼ é€’ç»™å½¢å‚ argc å’Œ argvï¼› å†æ¬¡æ‰§è¡Œ vir_fun() å‡½æ•°ï¼Œæ­¤æ—¶æ¨¡æ¿å‚æ•° T çš„ç±»å‹ä¸º char*ï¼Œè¾“å‡º argc çš„å€¼ä¸º â€œhttp:www.biancheng.netâ€ã€‚å†æ¬¡è°ƒç”¨è‡ªèº«ï¼Œç»§ç»­å°† argv åŒ…ä¸­çš„æ•°æ®ä½œä¸ºå®å‚ï¼› å†æ¬¡æ‰§è¡Œ vir_fun() å‡½æ•°ï¼Œæ­¤æ—¶æ¨¡æ¿å‚æ•° T çš„ç±»å‹ä¸º doubleï¼Œè¾“å‡º argc çš„å€¼ä¸º 2.34ã€‚å†æ¬¡è°ƒç”¨è‡ªèº«ï¼Œå°†ç©ºçš„ argv åŒ…ä½œä¸ºå®å‚ï¼› ç”±äº argv åŒ…æ²¡æœ‰æ•°æ®ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨æ— ä»»ä½•å½¢å‚ã€å‡½æ•°ä½“ä¸ºç©ºçš„ vir_fun() å‡½æ•°ï¼Œæœ€ç»ˆæ‰§è¡Œç»“æŸã€‚ ä»¥é€’å½’æ–¹å¼è§£åŒ…ï¼Œä¸€å®šè¦è®¾ç½®é€’å½’ç»“æŸçš„å‡ºå£ã€‚ä¾‹å¦‚æœ¬ä¾‹ä¸­ï¼Œæ— å½¢å‚ã€å‡½æ•°ä½“ä¸ºç©ºçš„ vir_fun() å‡½æ•°å°±æ˜¯é€’å½’ç»“æŸçš„å‡ºå£ã€‚ [éé€’å½’æ–¹æ³•è§£åŒ…] å€ŸåŠ©é€—å·è¡¨è¾¾å¼å’Œåˆå§‹åŒ–åˆ—è¡¨ï¼Œä¹Ÿå¯ä»¥è§£å¼€å‚æ•°åŒ…ã€‚ ä»¥ vir_fun() å‡½æ•°ä¸ºä¾‹ï¼Œä¸‹é¢ç¨‹åºæ¼”ç¤ºäº†éé€’å½’æ–¹æ³•è§£åŒ…çš„è¿‡ç¨‹ï¼š #include \u003ciostream\u003e using namespace std; template \u003ctypename T\u003e void dispaly(T t) { cout \u003c\u003c t \u003c\u003c endl; } template \u003ctypename... args\u003e void vir_fun(args... argv) { //é€—å·è¡¨è¾¾å¼+åˆå§‹åŒ–åˆ—è¡¨ int arr[] = { (dispaly(argv),0)... }; } int main() { vir_fun(1, \"http://www.biancheng.net\", 2.34); return 0; } è¿™é‡Œé‡ç‚¹åˆ†æä¸€ä¸‹ç¬¬ 13 è¡Œä»£ç ï¼Œæˆ‘ä»¬ä»¥{ }åˆå§‹åŒ–åˆ—è¡¨çš„æ–¹å¼å¯¹æ•°ç»„ arr è¿›è¡Œäº†åˆå§‹åŒ–ï¼Œ (display(argv),0)â€¦ ä¼šä¾æ¬¡å±•å¼€ä¸º (display(1),0)ã€(display(â€œhttp://www.biancheng.netâ€),0) å’Œ (display(2.34),0)ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬ 13 è¡Œä»£ç å’Œå¦‚ä¸‹ä»£ç æ˜¯ç­‰ä»·çš„ï¼š int arr[] = { (dispaly(1),0), (dispaly(\"http://www.biancheng.net\"),0), (dispaly(2.34),0) }; å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªé€—å·è¡¨è¾¾å¼ï¼Œä»¥ (display(1), 0) ä¸ºä¾‹ï¼Œå®ƒä¼šå…ˆè®¡ç®— display(1)ï¼Œç„¶åå°† 0 ä½œä¸ºæ•´ä¸ªè¡¨è¾¾å¼çš„å€¼è¿”å›ç»™æ•°ç»„ï¼Œå› æ­¤ arr æ•°ç»„æœ€ç»ˆå­˜å‚¨çš„éƒ½æ˜¯ 0ã€‚arr æ•°ç»„çº¯ç²¹æ˜¯ä¸ºäº†å°†å‚æ•°åŒ…å±•å¼€ï¼Œæ²¡æœ‰å‘æŒ¥å…¶å®ƒä½œç”¨ã€‚ (2) å¯å˜å‚æ•°ç±»æ¨¡æ¿ C++11 æ ‡å‡†ä¸­ï¼Œç±»æ¨¡æ¿ä¸­çš„æ¨¡æ¿å‚æ•°ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯å˜å‚æ•°ã€‚C++ 11 æ ‡å‡†æä¾›çš„ typle å…ƒç»„ç±»å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å¯å˜å‚æ•°æ¨¡æ¿ç±»ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š template \u003ctypename... Types\u003e class tuple; å’Œå›ºå®šæ¨¡æ¿å‚æ•°çš„ç±»ä¸åŒï¼Œtyple æ¨¡æ¿ç±»å®ä¾‹åŒ–æ—¶ï¼Œå¯ä»¥æ¥æ”¶ä»»æ„æ•°é‡ã€ä»»æ„ç±»å‹çš„æ¨¡æ¿å‚æ•°ï¼Œä¾‹å¦‚ï¼š std:tuple\u003c\u003e tp0; std::tuple\u003cint\u003e tp1 = std::make_tuple(1); std::tuple\u003cint, double\u003e tp2 = std::make_tuple(1, 2.34); std::tuple\u003cint, double, string\u003e tp3 = std::make_tuple(1, 2.34, \"http://www.biancheng.net\"); å¦‚ä¸‹ä»£ç å±•ç¤ºäº†ä¸€ä¸ªæ”¯æŒå¯å˜å‚","date":"2023-07-12","objectID":"/posts/newfeature/:1:9","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] tupleå…ƒç»„è¯¦è§£ C++11 æ ‡å‡†æ–°å¼•å…¥äº†ä¸€ç§ç±»æ¨¡æ¿ï¼Œå‘½åä¸º tupleï¼ˆä¸­æ–‡å¯ç›´è¯‘ä¸ºå…ƒç»„ï¼‰ã€‚tuple æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ï¼šå®ä¾‹åŒ–çš„å¯¹è±¡å¯ä»¥å­˜å‚¨ä»»æ„æ•°é‡ã€ä»»æ„ç±»å‹çš„æ•°æ®ã€‚ tuple çš„åº”ç”¨åœºæ™¯å¾ˆå¹¿æ³›ï¼Œä¾‹å¦‚å½“éœ€è¦å­˜å‚¨å¤šä¸ªä¸åŒç±»å‹çš„å…ƒç´ æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ tupleï¼›å½“å‡½æ•°éœ€è¦è¿”å›å¤šä¸ªæ•°æ®æ—¶ï¼Œå¯ä»¥å°†è¿™äº›æ•°æ®å­˜å‚¨åœ¨ tuple ä¸­ï¼Œå‡½æ•°åªéœ€è¿”å›ä¸€ä¸ª tuple å¯¹è±¡å³å¯ã€‚ æœ¬èŠ‚ï¼Œæˆ‘ä»¬å°†ç»™å¤§å®¶è¯¦ç»†åœ°è®²è§£ tuple çš„ç”¨æ³•ã€‚ tupleå¯¹è±¡çš„åˆ›å»º tuple æœ¬è´¨æ˜¯ä¸€ä¸ªä»¥å¯å˜æ¨¡æ¿å‚æ•°å®šä¹‰çš„ç±»æ¨¡æ¿ï¼Œå®ƒå®šä¹‰åœ¨ å¤´æ–‡ä»¶å¹¶ä½äº std å‘½åç©ºé—´ä¸­ã€‚å› æ­¤è¦æƒ³ä½¿ç”¨ tuple ç±»æ¨¡æ¿ï¼Œç¨‹åºä¸­éœ€è¦é¦–å…ˆå¼•å…¥ä»¥ä¸‹ä»£ç ï¼š #include \u003ctuple\u003e using std::tuple; å®ä¾‹åŒ– tuple æ¨¡æ¿ç±»å¯¹è±¡å¸¸ç”¨çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å€ŸåŠ©è¯¥ç±»çš„æ„é€ å‡½æ•°ï¼Œå¦ä¸€ç§æ˜¯å€ŸåŠ© make_tuple() å‡½æ•°ã€‚ (1) ç±»çš„æ„é€ å‡½æ•° tuple æ¨¡æ¿ç±»æä¾›æœ‰å¾ˆå¤šæ„é€ å‡½æ•°ï¼ŒåŒ…æ‹¬: 1) é»˜è®¤æ„é€ å‡½æ•° constexpr tuple(); 2) æ‹·è´æ„é€ å‡½æ•° tuple (const tuple\u0026 tpl); 3) ç§»åŠ¨æ„é€ å‡½æ•° tuple (tuple\u0026\u0026 tpl); 4) éšå¼ç±»å‹è½¬æ¢æ„é€ å‡½æ•° template \u003cclass... UTypes\u003e tuple (const tuple\u003cUTypes...\u003e\u0026 tpl); //å·¦å€¼æ–¹å¼ template \u003cclass... UTypes\u003e tuple (tuple\u003cUTypes...\u003e\u0026\u0026 tpl); //å³å€¼æ–¹å¼ 5) æ”¯æŒåˆå§‹åŒ–åˆ—è¡¨çš„æ„é€ å‡½æ•° explicit tuple (const Types\u0026... elems); //å·¦å€¼æ–¹å¼ template \u003cclass... UTypes\u003e explicit tuple (UTypes\u0026\u0026... elems); //å³å€¼æ–¹å¼ 6) å°†pairå¯¹è±¡è½¬æ¢ä¸ºtupleå¯¹è±¡ template \u003cclass U1, class U2\u003e tuple (const pair\u003cU1,U2\u003e\u0026 pr); //å·¦å€¼æ–¹å¼ template \u003cclass U1, class U2\u003e tuple (pair\u003cU1,U2\u003e\u0026\u0026 pr); //å³å€¼æ–¹å¼ ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e // std::cout #include \u003ctuple\u003e // std::tuple using std::tuple; int main() { std::tuple\u003cint, char\u003e first; // 1) first{} std::tuple\u003cint, char\u003e second(first); // 2) second{} std::tuple\u003cint, char\u003e third(std::make_tuple(20, 'b')); // 3) third{20,'b'} std::tuple\u003clong, char\u003e fourth(third); // 4)çš„å·¦å€¼æ–¹å¼, fourth{20,'b'} std::tuple\u003cint, char\u003e fifth(10, 'a'); // 5)çš„å³å€¼æ–¹å¼, fifth{10.'a'} std::tuple\u003cint, char\u003e sixth(std::make_pair(30, 'c')); // 6)çš„å³å€¼æ–¹å¼, sixth{30,''c} return 0; } (2) make_tuple()å‡½æ•° ä¸Šé¢ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å·²ç»ç”¨åˆ°äº† make_tuple() å‡½æ•°ï¼Œå®ƒä»¥æ¨¡æ¿çš„å½¢å¼å®šä¹‰åœ¨ å¤´æ–‡ä»¶ä¸­ï¼ŒåŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ª tuple å³å€¼å¯¹è±¡ï¼ˆæˆ–è€…ä¸´æ—¶å¯¹è±¡ï¼‰ã€‚ å¯¹äº make_tuple() å‡½æ•°åˆ›å»ºäº† tuple å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä¸Šé¢ç¨‹åºä¸­é‚£æ ·ä½œä¸ºç§»åŠ¨æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥è¿™æ ·ç”¨ï¼š auto first = std::make_tuple (10,'a'); // tuple \u003c int, char \u003e const int a = 0; int b[3]; auto second = std::make_tuple (a,b); // tuple \u003c int, int* \u003e ç¨‹åºä¸­åˆ†åˆ«åˆ›å»ºäº† first å’Œ second ä¸¤ä¸ª tuple å¯¹è±¡ï¼Œå®ƒä»¬çš„ç±»å‹å¯ä»¥ç›´æ¥ç”¨ auto è¡¨ç¤ºã€‚ tupleå¸¸ç”¨å‡½æ•° ä¸ºäº†æ–¹ä¾¿æ‚¨åœ¨å®é™…å¼€å‘ä¸­ä½¿ç”¨ tuple å¯¹è±¡ï¼Œtupe æ¨¡æ¿ç±»æä¾›äº†ä¸€ä¸ªåŠŸèƒ½å®ç”¨çš„æˆå‘˜å‡½æ•°ï¼Œ å¤´æ–‡ä»¶ä¸­ä¹Ÿæä¾›äº†ä¸€äº›å’Œæ“ä½œ tuple å¯¹è±¡ç›¸å…³çš„å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿ï¼Œå¦‚è¡¨ 1 æ‰€ç¤ºã€‚ å‡½æ•°æˆ–ç±»æ¨¡æ¿ æ è¿° tup1.swap(tup2) swap(tup1, tup2) tup1 å’Œ tup2 è¡¨ç¤ºç±»å‹ç›¸åŒçš„ä¸¤ä¸ª tuple å¯¹è±¡ï¼Œtuple æ¨¡æ¿ç±»ä¸­å®šä¹‰æœ‰ä¸€ä¸ª swap() æˆå‘˜å‡½æ•°ï¼Œ å¤´æ–‡ä»¶è¿˜æä¾›äº†ä¸€ä¸ªåŒåçš„ swap() å…¨å±€å‡½æ•°ã€‚ swap() å‡½æ•°çš„åŠŸèƒ½æ˜¯äº¤æ¢ä¸¤ä¸ª tuple å¯¹è±¡å­˜å‚¨çš„å†…å®¹ã€‚ get(tup) tup è¡¨ç¤ºæŸä¸ª tuple å¯¹è±¡ï¼Œnum æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œget() æ˜¯ å¤´æ–‡ä»¶æä¾›çš„å…¨å±€å‡½æ•°ï¼ŒåŠŸèƒ½æ˜¯è¿”å› tup å¯¹è±¡ä¸­ç¬¬ num+1 ä¸ªå…ƒç´ ã€‚ tuple_size::value tuple_size æ˜¯å®šä¹‰åœ¨ å¤´æ–‡ä»¶çš„ç±»æ¨¡æ¿ï¼Œå®ƒåªæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ valueï¼ŒåŠŸèƒ½æ˜¯è·å–æŸä¸ª tuple å¯¹è±¡ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œtype ä¸ºè¯¥tuple å¯¹è±¡çš„ç±»å‹ã€‚ tuple_element\u003cI, type\u003e::type tuple_element æ˜¯å®šä¹‰åœ¨ å¤´æ–‡ä»¶çš„ç±»æ¨¡æ¿ï¼Œå®ƒåªæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ typeï¼ŒåŠŸèƒ½æ˜¯è·å–æŸä¸ª tuple å¯¹è±¡ç¬¬ I+1 ä¸ªå…ƒç´ çš„ç±»å‹ã€‚ forward_as_tuple\u003cargsâ€¦\u003e argsâ€¦ è¡¨ç¤º tuple å¯¹è±¡å­˜å‚¨çš„å¤šä¸ªå…ƒç´ ï¼Œè¯¥å‡½æ•°çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ª tuple å¯¹è±¡ï¼Œå†…éƒ¨å­˜å‚¨çš„ argsâ€¦ å…ƒç´ éƒ½æ˜¯å³å€¼å¼•ç”¨å½¢å¼çš„ã€‚ tie(argsâ€¦) = tup tup è¡¨ç¤ºæŸä¸ª tuple å¯¹è±¡ï¼Œtie() æ˜¯ å¤´æ–‡ä»¶æä¾›çš„ï¼ŒåŠŸèƒ½æ˜¯å°† tup å†…å­˜å‚¨çš„å…ƒç´ é€ä¸€èµ‹å€¼ç»™ argsâ€¦ æŒ‡å®šçš„å·¦å€¼å˜é‡ã€‚ tuple_cat(argsâ€¦) argsâ€¦ è¡¨ç¤ºå¤šä¸ª tuple å¯¹è±¡ï¼Œè¯¥å‡½æ•°æ˜¯ å¤´æ–‡ä»¶æä¾›çš„ï¼ŒåŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ª tuple å¯¹è±¡ï¼Œæ­¤å¯¹è±¡åŒ…å« argsâ€¦ æŒ‡å®šçš„æ‰€æœ‰ tuple å¯¹è±¡å†…çš„å…ƒç´ ã€‚ tuple æ¨¡æ¿ç±»å¯¹èµ‹å€¼è¿ç®—ç¬¦ = è¿›è¡Œäº†é‡è½½ï¼Œä½¿å¾—åŒç±»å‹çš„ tuple å¯¹è±¡å¯ä»¥ç›´æ¥èµ‹å€¼ã€‚æ­¤å¤–ï¼Œtuple æ¨¡æ¿ç±»è¿˜é‡è½½äº† ==ã€!=ã€\u003cã€\u003eã€\u003e=ã€\u003c= è¿™å‡ ä¸ªæ¯”è¾ƒè¿ç®—ç¬¦ï¼ŒåŒç±»å‹çš„ tuple å¯¹è±¡å¯ä»¥ç›¸äº’æ¯”è¾ƒï¼ˆé€ä¸ªæ¯”è¾ƒå„ä¸ªå…ƒç´ ï¼‰ã€‚ ä¸‹é¢çš„ç¨‹åºç»™æ‚¨æ¼”ç¤ºäº†è¡¨ 1 ä¸­ä¸€éƒ¨åˆ†å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿çš„åŠŸèƒ½ï¼š #include \u003ciostream\u003e #include \u003ctuple\u003e int main() { int size; //åˆ›å»ºä¸€ä¸ª tuple å¯¹è±¡å­˜å‚¨ 10 å’Œ 'x' std::tuple\u003cint, char\u003e mytuple(10, 'x'); //è®¡ç®— mytuple å­˜å‚¨å…ƒç´ çš„ä¸ªæ•° size = std::tuple_size\u003cdecltype(mytuple)\u003e::value; //è¾“å‡º mytuple ä¸­å­˜å‚¨çš„å…ƒç´  std::cout \u003c\u003c std::get\u003c0\u003e(mytuple) \u003c\u003c \" \" \u003c\u003c std::get\u003c1\u003e(mytuple) \u003c\u003c std::endl; //ä¿®æ”¹æŒ‡å®šçš„å…ƒç´  std::get\u003c0\u003e(mytuple) = 100; std::cout \u003c\u003c std::get\u003c0\u003e(mytuple) \u003c\u003c std::endl; //ä½¿ç”¨ makde_tuple() åˆ›å»ºä¸€ä¸ª tuple å¯¹è±¡ auto bar = std::make_tuple(\"test\", 3.1, 14); //æ‹†è§£ bar å¯¹è±¡ï¼Œåˆ†åˆ«èµ‹å€¼ç»™ mystrã€mydouã€myint const char* mystr = nullptr; double mydou; int myint; //ä½¿ç”¨ tie() æ—¶ï¼Œå¦‚æœä¸æƒ³æ¥å—æŸä¸ªå…ƒç´ çš„å€¼ï¼Œå®å‚å¯ä»¥ç”¨ std::ignore ä»£æ›¿ std::tie(mystr, mydou, myint) = bar; //std::tie(std::ignore, std::ignore, myint) = bar; //åªæ¥æ”¶ç¬¬ 3 ä¸ªæ•´å½¢å€¼ //å°† mytuple å’Œ bar ä¸­çš„å…ƒç´ æ•´åˆåˆ° 1 ä¸ª tuple å¯¹è±¡ä¸­ auto mycat = std::tuple_cat(mytuple, bar); size = std::tuple_size\u003cdecltype(mycat)\u003e::value; std::cout \u003c\u003c size \u003c\u003c std::endl; return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 10 x 100 5 ","date":"2023-07-12","objectID":"/posts/newfeature/:1:10","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] åˆ—è¡¨åˆå§‹åŒ–ï¼ˆç»Ÿä¸€äº†åˆå§‹åŒ–æ–¹å¼ï¼‰ æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ C++98/03 ä¸­çš„å¯¹è±¡åˆå§‹åŒ–æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œè¯·çœ‹ä¸‹é¢çš„ä»£ç ï¼š //åˆå§‹åŒ–åˆ—è¡¨ int i_arr[3] = { 1, 2, 3 }; //æ™®é€šæ•°ç»„ struct A { int x; struct B { int i; int j; } b; } a = { 1, { 2, 3 } }; //PODç±»å‹ //æ‹·è´åˆå§‹åŒ–ï¼ˆcopy-initializationï¼‰ int i = 0; class Foo { public: Foo(int) {} } foo = 123; //éœ€è¦æ‹·è´æ„é€ å‡½æ•° //ç›´æ¥åˆå§‹åŒ–ï¼ˆdirect-initializationï¼‰ int j(0); Foo bar(123); è¿™äº›ä¸åŒçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œéƒ½æœ‰å„è‡ªçš„é€‚ç”¨èŒƒå›´å’Œä½œç”¨ã€‚æœ€å…³é”®çš„æ˜¯ï¼Œè¿™äº›ç§ç±»ç¹å¤šçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œæ²¡æœ‰ä¸€ç§å¯ä»¥é€šç”¨æ‰€æœ‰æƒ…å†µã€‚ ä¸ºäº†ç»Ÿä¸€åˆå§‹åŒ–æ–¹å¼ï¼Œå¹¶ä¸”è®©åˆå§‹åŒ–è¡Œä¸ºå…·æœ‰ç¡®å®šçš„æ•ˆæœï¼ŒC++11 ä¸­æå‡ºäº†åˆ—è¡¨åˆå§‹åŒ–ï¼ˆList-initializationï¼‰çš„æ¦‚å¿µã€‚ POD ç±»å‹å³ plain old data ç±»å‹ï¼Œç®€å•æ¥è¯´ï¼Œæ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨ memcpy å¤åˆ¶çš„å¯¹è±¡ã€‚ ç»Ÿä¸€çš„åˆå§‹åŒ– åœ¨ä¸Šé¢æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ï¼Œå¯¹äºæ™®é€šæ•°ç»„å’Œ POD ç±»å‹ï¼ŒC++98/03 å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼ˆinitializer listï¼‰è¿›è¡Œåˆå§‹åŒ–: int i_arr[3] = { 1, 2, 3 }; long l_arr[] = { 1, 3, 2, 4 }; struct A { int x; int y; } a = { 1, 2 }; ä½†æ˜¯è¿™ç§åˆå§‹åŒ–æ–¹å¼çš„é€‚ç”¨æ€§éå¸¸ç‹­çª„ï¼Œåªæœ‰ä¸Šé¢æåˆ°çš„è¿™ä¸¤ç§æ•°æ®ç±»å‹å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ã€‚ åœ¨ C++11 ä¸­ï¼Œåˆå§‹åŒ–åˆ—è¡¨çš„é€‚ç”¨æ€§è¢«å¤§å¤§å¢åŠ äº†ï¼Œå®ƒç°åœ¨å¯ä»¥ç”¨äºä»»ä½•ç±»å‹å¯¹è±¡çš„åˆå§‹åŒ–ã€‚ è¯·çœ‹ä¸‹é¢çš„ä»£ç ã€‚ ã€å®ä¾‹ã€‘é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ–å¯¹è±¡ã€‚ class Foo { public: Foo(int) {} private: Foo(const Foo \u0026); }; int main(void) { Foo a1(123); Foo a2 = 123; //error: 'Foo::Foo(const Foo \u0026)' is private Foo a3 = { 123 }; Foo a4 { 123 }; int a5 = { 3 }; int a6 { 3 }; return 0; } åœ¨ä¸Šä¾‹ä¸­ï¼Œa3ã€a4 ä½¿ç”¨äº†æ–°çš„åˆå§‹åŒ–æ–¹å¼æ¥åˆå§‹åŒ–å¯¹è±¡ï¼Œæ•ˆæœå¦‚åŒ a1 çš„ç›´æ¥åˆå§‹åŒ–ã€‚ a5ã€a6 åˆ™æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„åˆ—è¡¨åˆå§‹åŒ–æ–¹å¼ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬çš„å½¢å¼éƒ½æ˜¯ç»Ÿä¸€çš„ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œa3 è™½ç„¶ä½¿ç”¨äº†ç­‰äºå·ï¼Œä½†å®ƒä»ç„¶æ˜¯åˆ—è¡¨åˆå§‹åŒ–ï¼Œå› æ­¤ï¼Œç§æœ‰çš„æ‹·è´æ„é€ å¹¶ä¸ä¼šå½±å“åˆ°å®ƒã€‚ a4 å’Œ a6 çš„å†™æ³•ï¼Œæ˜¯ C++98/03 æ‰€ä¸å…·å¤‡çš„ã€‚åœ¨ C++11 ä¸­ï¼Œå¯ä»¥ç›´æ¥åœ¨å˜é‡ååé¢è·Ÿä¸Šåˆå§‹åŒ–åˆ—è¡¨ï¼Œæ¥è¿›è¡Œå¯¹è±¡çš„åˆå§‹åŒ–ã€‚ è¿™ç§å˜é‡ååé¢è·Ÿä¸Šåˆå§‹åŒ–åˆ—è¡¨æ–¹æ³•åŒæ ·é€‚ç”¨äºæ™®é€šæ•°ç»„å’Œ POD ç±»å‹çš„åˆå§‹åŒ–ï¼š int i_arr[3] { 1, 2, 3 }; //æ™®é€šæ•°ç»„ struct A { int x; struct B { int i; int j; } b; } a { 1, { 2, 3 } }; //PODç±»å‹ åœ¨åˆå§‹åŒ–æ—¶ï¼Œ{}å‰é¢çš„ç­‰äºå·æ˜¯å¦ä¹¦å†™å¯¹åˆå§‹åŒ–è¡Œä¸ºæ²¡æœ‰å½±å“ã€‚ å¦å¤–ï¼Œå¦‚åŒè¯»è€…æ‰€æƒ³çš„é‚£æ ·ï¼Œnew æ“ä½œç¬¦ç­‰å¯ä»¥ç”¨åœ†æ‹¬å·è¿›è¡Œåˆå§‹åŒ–çš„åœ°æ–¹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼š int* a = new int { 123 }; double b = double { 12.12 }; int* arr = new int[3] { 1, 2, 3 }; æŒ‡é’ˆ a æŒ‡å‘äº†ä¸€ä¸ª new æ“ä½œç¬¦è¿”å›çš„å†…å­˜ï¼Œé€šè¿‡åˆå§‹åŒ–åˆ—è¡¨æ–¹å¼åœ¨å†…å­˜åˆå§‹åŒ–æ—¶æŒ‡å®šäº†å€¼ä¸º 123ã€‚ b åˆ™æ˜¯å¯¹åŒ¿åå¯¹è±¡ä½¿ç”¨åˆ—è¡¨åˆå§‹åŒ–åï¼Œå†è¿›è¡Œæ‹·è´åˆå§‹åŒ–ã€‚ è¿™é‡Œè®©äººçœ¼å‰ä¸€äº®çš„æ˜¯ arr çš„åˆå§‹åŒ–æ–¹å¼ã€‚å †ä¸ŠåŠ¨æ€åˆ†é…çš„æ•°ç»„ç»ˆäºä¹Ÿå¯ä»¥ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨è¿›è¡Œåˆå§‹åŒ–äº†ã€‚ é™¤äº†ä¸Šé¢æ‰€è¿°çš„å†…å®¹ä¹‹å¤–ï¼Œåˆ—è¡¨åˆå§‹åŒ–è¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨åœ¨å‡½æ•°çš„è¿”å›å€¼ä¸Šï¼š struct Foo { Foo(int, double) {} }; Foo func(void) { return { 123, 321.0 }; } è¿™é‡Œçš„ return è¯­å¥å°±å¦‚åŒè¿”å›äº†ä¸€ä¸ª Foo(123, 321.0)ã€‚ ç”±ä¸Šé¢çš„è¿™äº›ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ C++11 ä¸­ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨æ˜¯éå¸¸ä¾¿åˆ©çš„ã€‚å®ƒä¸ä»…ç»Ÿä¸€äº†å„ç§å¯¹è±¡çš„åˆå§‹åŒ–æ–¹å¼ï¼Œè€Œä¸”è¿˜ä½¿ä»£ç çš„ä¹¦å†™æ›´åŠ ç®€å•æ¸…æ™°ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:11","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] lambdaåŒ¿åå‡½æ•°ç”¨æ³•è¯¦è§£ lambda æºè‡ªå¸Œè…Šå­—æ¯è¡¨ä¸­ç¬¬ 11 ä½çš„ Î»ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦é¢†åŸŸï¼Œå®ƒåˆ™æ˜¯è¢«ç”¨æ¥è¡¨ç¤ºä¸€ç§åŒ¿åå‡½æ•°ã€‚æ‰€è°“åŒ¿åå‡½æ•°ï¼Œç®€å•åœ°ç†è§£å°±æ˜¯æ²¡æœ‰åç§°çš„å‡½æ•°ï¼Œåˆå¸¸è¢«ç§°ä¸º lambda å‡½æ•°æˆ–è€… lambda è¡¨è¾¾å¼ã€‚ ç»§ Pythonã€Javaã€C#ã€PHP ç­‰ä¼—å¤šé«˜çº§ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒ lambda åŒ¿åå‡½æ•°åï¼ŒC++11 æ ‡å‡†ç»ˆäºå¼•å…¥äº† lambdaï¼Œæœ¬èŠ‚å°†å¸¦é¢†å¤§å®¶ç³»ç»Ÿåœ°å­¦ä¹  lambda è¡¨è¾¾å¼çš„å…·ä½“ç”¨æ³•ã€‚ lambdaåŒ¿åå‡½æ•°çš„å®šä¹‰ å®šä¹‰ä¸€ä¸ª lambda åŒ¿åå‡½æ•°å¾ˆç®€å•ï¼Œå¯ä»¥å¥—ç”¨å¦‚ä¸‹çš„è¯­æ³•æ ¼å¼ï¼š [å¤–éƒ¨å˜é‡è®¿é—®æ–¹å¼è¯´æ˜ç¬¦] (å‚æ•°) mutable noexcept/throw() -\u003e è¿”å›å€¼ç±»å‹ { å‡½æ•°ä½“; }; å…¶ä¸­å„éƒ¨åˆ†çš„å«ä¹‰åˆ†åˆ«ä¸ºï¼š 1. [å¤–éƒ¨å˜é‡æ–¹ä½æ–¹å¼è¯´æ˜ç¬¦] [ ] æ–¹æ‹¬å·ç”¨äºå‘ç¼–è¯‘å™¨è¡¨æ˜å½“å‰æ˜¯ä¸€ä¸ª lambda è¡¨è¾¾å¼ï¼Œå…¶ä¸èƒ½è¢«çœç•¥ã€‚åœ¨æ–¹æ‹¬å·å†…éƒ¨ï¼Œå¯ä»¥æ³¨æ˜å½“å‰ lambda å‡½æ•°çš„å‡½æ•°ä½“ä¸­å¯ä»¥ä½¿ç”¨å“ªäº›â€œå¤–éƒ¨å˜é‡â€ã€‚ \u003e æ‰€è°“å¤–éƒ¨å˜é‡ï¼ŒæŒ‡çš„æ˜¯å’Œå½“å‰ lambda è¡¨è¾¾å¼ä½äºåŒä¸€ä½œç”¨åŸŸå†…çš„æ‰€æœ‰å±€éƒ¨å˜é‡ã€‚\u003c/br\u003e 2. (å‚æ•°) å’Œæ™®é€šå‡½æ•°çš„å®šä¹‰ä¸€æ ·ï¼Œlambda åŒ¿åå‡½æ•°ä¹Ÿå¯ä»¥æ¥æ”¶å¤–éƒ¨ä¼ é€’çš„å¤šä¸ªå‚æ•°ã€‚å’Œæ™®é€šå‡½æ•°ä¸åŒçš„æ˜¯ï¼Œå¦‚æœä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œå¯ä»¥è¿åŒ () å°æ‹¬å·ä¸€èµ·çœç•¥ï¼› 3. mutable æ­¤å…³é”®å­—å¯ä»¥çœç•¥ï¼Œå¦‚æœä½¿ç”¨åˆ™ä¹‹å‰çš„ () å°æ‹¬å·å°†ä¸èƒ½çœç•¥ï¼ˆå‚æ•°ä¸ªæ•°å¯ä»¥ä¸º 0ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹äºä»¥å€¼ä¼ é€’æ–¹å¼å¼•å…¥çš„å¤–éƒ¨å˜é‡ï¼Œä¸å…è®¸åœ¨ lambda è¡¨è¾¾å¼å†…éƒ¨ä¿®æ”¹å®ƒä»¬çš„å€¼ï¼ˆå¯ä»¥ç†è§£ä¸ºè¿™éƒ¨åˆ†å˜é‡éƒ½æ˜¯ const å¸¸é‡ï¼‰ã€‚è€Œå¦‚æœæƒ³ä¿®æ”¹å®ƒä»¬ï¼Œå°±å¿…é¡»ä½¿ç”¨ mutable å…³é”®å­—ã€‚ \u003e å¯¹äºä»¥å€¼ä¼ é€’æ–¹å¼å¼•å…¥çš„å¤–éƒ¨å˜é‡ï¼Œlambda è¡¨è¾¾å¼ä¿®æ”¹çš„æ˜¯æ‹·è´çš„é‚£ä¸€ä»½ï¼Œå¹¶ä¸ä¼šä¿®æ”¹çœŸæ­£çš„å¤–éƒ¨å˜é‡ï¼› 4. noexcept/throw() å¯ä»¥çœç•¥ï¼Œå¦‚æœä½¿ç”¨ï¼Œåœ¨ä¹‹å‰çš„ () å°æ‹¬å·å°†ä¸èƒ½çœç•¥ï¼ˆå‚æ•°ä¸ªæ•°å¯ä»¥ä¸º 0ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œlambda å‡½æ•°çš„å‡½æ•°ä½“ä¸­å¯ä»¥æŠ›å‡ºä»»ä½•ç±»å‹çš„å¼‚å¸¸ã€‚è€Œæ ‡æ³¨ noexcept å…³é”®å­—ï¼Œåˆ™è¡¨ç¤ºå‡½æ•°ä½“å†…ä¸ä¼šæŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼›ä½¿ç”¨ throw() å¯ä»¥æŒ‡å®š lambda å‡½æ•°å†…éƒ¨å¯ä»¥æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚\u003c/br\u003e å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœ lambda å‡½æ•°æ ‡æœ‰ noexcept è€Œå‡½æ•°ä½“å†…æŠ›å‡ºäº†å¼‚å¸¸ï¼Œåˆæˆ–è€…ä½¿ç”¨ throw() é™å®šäº†å¼‚å¸¸ç±»å‹è€Œå‡½æ•°ä½“å†…æŠ›å‡ºäº†éæŒ‡å®šç±»å‹çš„å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸æ— æ³•ä½¿ç”¨ try-catch æ•è·ï¼Œä¼šå¯¼è‡´ç¨‹åºæ‰§è¡Œå¤±è´¥ï¼ˆæœ¬èŠ‚åç»­ä¼šç»™å‡ºå®ä¾‹ï¼‰ã€‚ 5. -\u003e è¿”å›å€¼ç±»å‹ æŒ‡æ˜ lambda åŒ¿åå‡½æ•°çš„è¿”å›å€¼ç±»å‹ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœ lambda å‡½æ•°ä½“å†…åªæœ‰ä¸€ä¸ª return è¯­å¥ï¼Œæˆ–è€…è¯¥å‡½æ•°è¿”å› voidï¼Œåˆ™ç¼–è¯‘å™¨å¯ä»¥è‡ªè¡Œæ¨æ–­å‡ºè¿”å›å€¼ç±»å‹ï¼Œæ­¤æƒ…å†µä¸‹å¯ä»¥ç›´æ¥çœç•¥-\u003e è¿”å›å€¼ç±»å‹ã€‚ 6. å‡½æ•°ä½“ å’Œæ™®é€šå‡½æ•°ä¸€æ ·ï¼Œlambda åŒ¿åå‡½æ•°åŒ…å«çš„å†…éƒ¨ä»£ç éƒ½æ”¾ç½®åœ¨å‡½æ•°ä½“ä¸­ã€‚è¯¥å‡½æ•°ä½“å†…é™¤äº†å¯ä»¥ä½¿ç”¨æŒ‡å®šä¼ é€’è¿›æ¥çš„å‚æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æŒ‡å®šçš„å¤–éƒ¨å˜é‡ä»¥åŠå…¨å±€èŒƒå›´å†…çš„æ‰€æœ‰å…¨å±€å˜é‡ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¤–éƒ¨å˜é‡ä¼šå—åˆ°ä»¥å€¼ä¼ é€’è¿˜æ˜¯ä»¥å¼•ç”¨ä¼ é€’æ–¹å¼å¼•å…¥çš„å½±å“ï¼Œè€Œå…¨å±€å˜é‡åˆ™ä¸ä¼šã€‚æ¢å¥è¯è¯´ï¼Œåœ¨ lambda è¡¨è¾¾å¼å†…å¯ä»¥ä½¿ç”¨ä»»æ„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå¿…è¦æ—¶è¿˜å¯ä»¥ç›´æ¥ä¿®æ”¹å®ƒä»¬çš„å€¼ã€‚ å…¶ä¸­ï¼Œçº¢è‰²æ ‡è¯†çš„å‚æ•°æ˜¯å®šä¹‰ lambda è¡¨è¾¾å¼æ—¶å¿…é¡»å†™çš„ï¼Œè€Œç»¿è‰²æ ‡è¯†çš„å‚æ•°å¯ä»¥çœç•¥ã€‚ æ¯”å¦‚ï¼Œå¦‚ä¸‹å°±å®šä¹‰äº†ä¸€ä¸ªæœ€ç®€å•çš„ lambda åŒ¿åå‡½æ•°ï¼š []{} æ˜¾ç„¶ï¼Œæ­¤ lambda åŒ¿åå‡½æ•°æœªå¼•å…¥ä»»ä½•å¤–éƒ¨å˜é‡ï¼ˆ[] å†…ä¸ºç©ºï¼‰ï¼Œä¹Ÿæ²¡æœ‰ä¼ é€’ä»»ä½•å‚æ•°ï¼Œæ²¡æœ‰æŒ‡å®š mutableã€noexcept ç­‰å…³é”®å­—ï¼Œæ²¡æœ‰è¿”å›å€¼å’Œå‡½æ•°ä½“ã€‚æ‰€ä»¥ï¼Œè¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰ä»»ä½•åŠŸèƒ½çš„ lambda åŒ¿åå‡½æ•°ã€‚ lambdaåŒ¿åå‡½æ•°ä¸­çš„[å¤–éƒ¨å˜é‡] å¯¹äº lambda åŒ¿åå‡½æ•°çš„ä½¿ç”¨ï¼Œä»¤å¤šæ•°åˆå­¦è€…æ„Ÿåˆ°å›°æƒ‘çš„å°±æ˜¯ [å¤–éƒ¨å˜é‡] çš„ä½¿ç”¨ã€‚å…¶å®å¾ˆç®€å•ï¼Œæ— éè¡¨ 1 æ‰€ç¤ºçš„è¿™å‡ ç§ç¼–å†™æ ¼å¼ã€‚ å¤–éƒ¨å˜é‡æ ¼å¼ åŠŸèƒ½ [] ç©ºæ–¹æ‹¬å·è¡¨ç¤ºå½“å‰ lambda åŒ¿åå‡½æ•°ä¸­ä¸å¯¼å…¥ä»»ä½•å¤–éƒ¨å˜é‡ã€‚ [=] åªæœ‰ä¸€ä¸ª = ç­‰å·ï¼Œè¡¨ç¤ºä»¥å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥æ‰€æœ‰å¤–éƒ¨å˜é‡ï¼› [\u0026] åªæœ‰ä¸€ä¸ª \u0026 ç¬¦å·ï¼Œè¡¨ç¤ºä»¥å¼•ç”¨ä¼ é€’çš„æ–¹å¼å¯¼å…¥æ‰€æœ‰å¤–éƒ¨å˜é‡ï¼› [val1, val2, â€¦] è¡¨ç¤ºä»¥å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥ val1ã€val2 ç­‰æŒ‡å®šçš„å¤–éƒ¨å˜é‡ï¼ŒåŒæ—¶å¤šä¸ªå˜é‡ä¹‹é—´æ²¡æœ‰å…ˆåæ¬¡åºï¼› [\u0026val1, \u0026val2, â€¦] è¡¨ç¤ºä»¥å¼•ç”¨ä¼ é€’çš„æ–¹å¼å¯¼å…¥ val1ã€val2ç­‰æŒ‡å®šçš„å¤–éƒ¨å˜é‡ï¼Œå¤šä¸ªå˜é‡ä¹‹é—´æ²¡æœ‰å‰åæ¬¡åºï¼› [val, \u0026val2,â€¦] ä»¥ä¸Š 2 ç§æ–¹å¼è¿˜å¯ä»¥æ··åˆä½¿ç”¨ï¼Œå˜é‡ä¹‹é—´æ²¡æœ‰å‰åæ¬¡åºã€‚ [=ï¼Œ \u0026val1,â€¦] è¡¨ç¤ºé™¤ val1 ä»¥å¼•ç”¨ä¼ é€’çš„æ–¹å¼å¯¼å…¥å¤–ï¼Œå…¶å®ƒå¤–éƒ¨å˜é‡éƒ½ä»¥å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥ã€‚ [this] è¡¨ç¤ºä»¥å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥å½“å‰çš„ this æŒ‡é’ˆã€‚ æ³¨æ„ï¼Œå•ä¸ªå¤–éƒ¨å˜é‡ä¸å…è®¸ä»¥ç›¸åŒçš„ä¼ é€’æ–¹å¼å¯¼å…¥å¤šæ¬¡ã€‚ä¾‹å¦‚ [=ï¼Œval1] ä¸­ï¼Œval1 å…ˆåè¢«ä»¥å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥äº† 2 æ¬¡ï¼Œè¿™æ˜¯éæ³•çš„ã€‚ ã€ä¾‹ 1ã€‘lambda åŒ¿åå‡½æ•°çš„å®šä¹‰å’Œä½¿ç”¨ã€‚ #include \u003ciostream\u003e #include \u003calgorithm\u003e using namespace std; int main() { int num[4] = {4, 2, 3, 1}; //å¯¹ a æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œæ’åº sort(num, num+4, [=](int x, int y) -\u003e bool{ return x \u003c y; } ); for(int n : num){ cout \u003c\u003c n \u003c\u003c \" \"; } return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 1 2 3 4 ç¨‹åºç¬¬ 9 è¡Œé€šè¿‡è°ƒç”¨ sort() å‡½æ•°å®ç°äº†å¯¹ num æ•°ç»„ä¸­å…ƒç´ çš„å‡åºæ’åºï¼Œå…¶ä¸­å°±ç”¨åˆ°äº† lambda åŒ¿åå‡½æ•°ã€‚è€Œå¦‚æœä½¿ç”¨æ™®é€šå‡½æ•°ï¼Œéœ€ä»¥å¦‚ä¸‹ä»£ç å®ç°ï¼š #include \u003ciostream\u003e #include \u003calgorithm\u003e using namespace std; //è‡ªå®šä¹‰çš„å‡åºæ’åºè§„åˆ™ bool sort_up(int x,int y){ return x \u003c y; } int main() { int num[4] = {4, 2, 3, 1}; //å¯¹ a æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œæ’åº sort(num, num+4, sort_up); for(int n : num){ cout \u003c\u003c n \u003c\u003c \" \"; } return 0; } æ­¤ç¨‹åºä¸­ sort_up() å‡½æ•°çš„åŠŸèƒ½å’Œä¸Šä¸€ä¸ªç¨‹åºä¸­çš„ lambda åŒ¿åå‡½æ•°å®Œå…¨ç›¸åŒã€‚æ˜¾ç„¶åœ¨ç±»ä¼¼çš„åœºæ™¯ä¸­ï¼Œä½¿ç”¨ lambda åŒ¿åå‡½æ•°æ›´æœ‰ä¼˜åŠ¿ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè™½ç„¶ lambda åŒ¿åå‡½æ•°æ²¡æœ‰å‡½æ•°åç§°ï¼Œä½†æˆ‘ä»¬ä»å¯ä»¥ä¸ºå…¶æ‰‹åŠ¨è®¾ç½®ä¸€ä¸ªåç§°ï¼Œæ¯”å¦‚ï¼š #include \u003ciostream\u003e using namespace std; int main() { //display å³ä¸º lambda åŒ¿åå‡½æ•°çš„å‡½æ•°å auto display = [](int a,int b) -\u003e void{cout \u003c\u003c a \u003c\u003c \" \" \u003c\u003c b;}; //è°ƒç”¨ lambda å‡½æ•° display(10,20); return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 10 20 å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºä¸­ä½¿ç”¨ auto å…³é”®å­—ä¸º lambda åŒ¿åå‡½æ•°è®¾å®šäº†ä¸€ä¸ªå‡½æ•°åï¼Œç”±æ­¤æˆ‘ä»¬å³å¯åœ¨ä½œç”¨åŸŸå†…è°ƒç”¨è¯¥å‡½æ•°ã€‚ ã€ä¾‹ 2ã€‘å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’çš„åŒºåˆ« #include \u003ciostream\u003e using namespace std; //å…¨å±€å˜é‡ int all_num = 0; int main() { //å±€éƒ¨å˜é‡ int num_1 = 1; int num_2 = 2; int num_3 = 3; cout \u003c\u003c \"lambda1:\\n\"; auto lambda1 = [=]{ //å…¨å±€å˜é‡å¯ä»¥è®¿é—®ç”šè‡³ä¿®æ”¹ all_num = 10; //å‡½æ•°ä½“å†…åªèƒ½ä½¿ç”¨å¤–éƒ¨å˜é‡ï¼Œè€Œæ— æ³•å¯¹å®ƒä»¬è¿›è¡Œä¿®æ”¹ cout \u003c\u003c num_1 \u003c\u003c \" \" \u003c\u003c num_2 \u003c\u003c \" \" \u003c\u003c num_3 \u003c\u003c endl; }; lambda1(); cout \u003c\u003c all_num \u003c\u003cendl; cout \u003c\u003c \"lambda2:\\n\"; auto lambda2 = [\u0026]{ all_num = 100; num_1 = 10; num_2 = 20; num_3 = 30; cout \u003c\u003c num_1 \u003c\u003c \" \" \u003c\u003c num_2 \u003c\u003c \" \" \u003c\u003c num_3 \u003c\u003c endl; }; lambda2(); cout \u003c\u003c all_num \u003c\u003c endl; return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š lambda1: 1 2 3 10 lambda2: 10 20 30 100 å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åˆ›å»º lambda1 å’Œ lambda2 åŒ¿åå‡½æ•°çš„ä½œç”¨åŸŸä¸­ï¼Œæœ‰ num_1ã€num_2 å’Œ num_3 è¿™ 3 ä¸ªå±€éƒ¨å˜é‡ï¼Œå¦å¤–è¿˜æœ‰ all_num å…¨å±€å˜é‡ã€‚ å…¶ä¸­ï¼Œlambda1 åŒ¿åå‡½æ•°æ˜¯ä»¥ [=] å€¼ä¼ é€’çš„æ–¹å¼å¯¼å…¥çš„å±€éƒ¨å˜é‡ï¼Œè¿™æ„å‘³ç€é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤å‡½æ•°å†…éƒ¨æ— æ³•ä¿®æ”¹è¿™ 3 ä¸ªå±€éƒ¨å˜é‡çš„å€¼ï¼Œä½†å…¨å±€å˜é‡ all_num é™¤å¤–ã€‚ç›¸å¯¹åœ°ï¼Œlambda2 åŒ¿åå‡½æ•°ä»¥ [\u0026] å¼•ç”¨ä¼ é€’çš„æ–¹å¼å¯¼å…¥è¿™ 3 ä¸ªå±€éƒ¨å˜é‡ï¼Œå› æ­¤åœ¨è¯¥å‡½æ•°çš„å†…éƒ¨ä¸å°±å¯ä»¥è®¿é—®è¿™ 3 ä¸ªå±€éƒ¨å˜é‡ï¼Œè¿˜å¯ä»¥ä»»æ„ä¿®æ”¹å®ƒä»¬ã€‚åŒæ ·ï¼Œä¹Ÿå¯ä»¥è®¿é—®ç”šè‡³ä¿®æ”¹å…¨å±€å˜é‡ã€‚ æ„Ÿå…´è¶£çš„è¯»è€…ï¼Œå¯è‡ªè¡Œå°è¯•åœ¨ lambda1 åŒ¿åå‡½æ•°ä¸­ä¿®æ”¹ num_1ã€num_2 æˆ–è€… num_3 çš„å€¼ï¼Œè§‚å¯Ÿç¼–è¯‘å™¨çš„æŠ¥é”™ä¿¡æ¯ã€‚ å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨ lambda1 åŒ¿å","date":"2023-07-12","objectID":"/posts/newfeature/:1:12","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] éå—é™è”åˆä½“ï¼ˆunionï¼‰ åœ¨ C/C++ ä¸­ï¼Œè”åˆä½“ï¼ˆUnionï¼‰æ˜¯ä¸€ç§æ„é€ æ•°æ®ç±»å‹ã€‚åœ¨ä¸€ä¸ªè”åˆä½“å†…ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¤šä¸ªä¸åŒç±»å‹çš„æˆå‘˜ï¼Œè¿™äº›æˆå‘˜å°†ä¼šå…±äº«åŒä¸€å—å†…å­˜ç©ºé—´ã€‚è€ç‰ˆæœ¬çš„ C++ ä¸ºäº†å’ŒCè¯­è¨€ä¿æŒå…¼å®¹ï¼Œå¯¹è”åˆä½“çš„æ•°æ®æˆå‘˜çš„ç±»å‹è¿›è¡Œäº†å¾ˆå¤§ç¨‹åº¦çš„é™åˆ¶ï¼Œè¿™äº›é™åˆ¶åœ¨ä»Šå¤©çœ‹æ¥å¹¶æ²¡æœ‰å¿…è¦ï¼Œå› æ­¤ C++11 å–æ¶ˆäº†è¿™äº›é™åˆ¶ã€‚ C++11 æ ‡å‡†è§„å®šï¼Œä»»ä½•éå¼•ç”¨ç±»å‹éƒ½å¯ä»¥æˆä¸ºè”åˆä½“çš„æ•°æ®æˆå‘˜ï¼Œè¿™ç§è”åˆä½“ä¹Ÿè¢«ç§°ä¸ºéå—é™è”åˆä½“ã€‚ä¾‹å¦‚ï¼š class Student{ public: Student(bool g, int a): gender(g), age(a) {} private: bool gender; int age; }; union T{ Student s; // å«æœ‰éPODç±»å‹çš„æˆå‘˜ï¼Œgcc-5.1.0 ç‰ˆæœ¬æŠ¥é”™ char name[10]; }; int main(){ return 0; } ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå› ä¸º Student ç±»å¸¦æœ‰è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªé POD ç±»å‹çš„ï¼Œè¿™å¯¼è‡´ç¼–è¯‘å™¨æŠ¥é”™ã€‚è¿™ç§è§„å®šåªæ˜¯ C++ ä¸ºäº†å…¼å®¹Cè¯­è¨€è€Œåˆ¶å®šï¼Œç„¶è€Œåœ¨é•¿æœŸçš„ç¼–ç¨‹å®è·µä¸­å‘ç°ï¼Œè¿™ç§è§„å®šæ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚ å…³äº POD ç±»å‹ç¨åæˆ‘ä»¬ä¼šè®²è§£ï¼Œå¤§å®¶å…ˆä¸è¦ç€æ€¥ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…·ä½“çœ‹ä¸€ä¸‹ C++11 å¯¹ C++98 çš„æ”¹è¿›ã€‚ 1.C++11 å…è®¸é POD ç±»å‹ C++98 ä¸å…è®¸è”åˆä½“çš„æˆå‘˜æ˜¯é POD ç±»å‹ï¼Œä½†æ˜¯ C++1 1 å–æ¶ˆäº†è¿™ç§é™åˆ¶ã€‚ POD æ˜¯ C++ ä¸­ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ¦‚å¿µï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åšä¸€ä¸ªç®€å•ä»‹ç»ã€‚POD æ˜¯è‹±æ–‡ Plain Old Data çš„ç¼©å†™ï¼Œç”¨æ¥æè¿°ä¸€ä¸ªç±»å‹çš„å±æ€§ã€‚ POD ç±»å‹ä¸€èˆ¬å…·æœ‰ä»¥ä¸‹å‡ ç§ç‰¹å¾ï¼ˆåŒ…æ‹¬ classã€union å’Œ structç­‰ï¼‰: 1. æ²¡æœ‰ç”¨æˆ·è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ã€ææ„å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°å’Œç§»åŠ¨æ„é€ å‡½æ•°ã€‚ 2. ä¸èƒ½åŒ…å«è™šå‡½æ•°å’Œè™šåŸºç±»ã€‚ 3. éé™æ€æˆå‘˜å¿…é¡»å£°æ˜ä¸º publicã€‚ 4. ç±»ä¸­çš„ç¬¬ä¸€ä¸ªéé™æ€æˆå‘˜çš„ç±»å‹ä¸å…¶åŸºç±»ä¸åŒï¼Œä¾‹å¦‚ï¼š c++ class B1{}; class B2 : B1 { B1 b; }; class B2 çš„ç¬¬ä¸€ä¸ªéé™æ€æˆå‘˜ b æ˜¯åŸºç±»ç±»å‹ï¼Œæ‰€ä»¥å®ƒä¸æ˜¯ POD ç±»å‹ã€‚ 5. ç±»æˆ–è€…ç»“æ„ä½“ç»§æ‰¿æ—¶ï¼Œæ»¡è¶³ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¹‹ä¸€ï¼š - æ´¾ç”Ÿç±»ä¸­æœ‰éé™æ€æˆå‘˜ï¼Œä¸”åªæœ‰ä¸€ä¸ªä»…åŒ…å«é™æ€æˆå‘˜çš„åŸºç±»ï¼› - åŸºç±»æœ‰éé™æ€æˆå‘˜ï¼Œè€Œæ´¾ç”Ÿç±»æ²¡æœ‰éé™æ€æˆå‘˜ã€‚ c++ class B1 { static int n; }; class B2 : B1 { int n1; }; class B3 : B2 { static int n2; }; å¯¹äº B2ï¼Œæ´¾ç”Ÿç±» B2 ä¸­æœ‰éé™æ€æˆå‘˜ï¼Œä¸”åªæœ‰ä¸€ä¸ªä»…åŒ…å«é™æ€æˆå‘˜çš„åŸºç±» B1ï¼Œæ‰€ä»¥å®ƒæ˜¯ POD ç±»å‹ã€‚å¯¹äº B3ï¼ŒåŸºç±» B2 æœ‰éé™æ€æˆå‘˜ï¼Œè€Œæ´¾ç”Ÿç±» B3 æ²¡æœ‰éé™æ€æˆå‘˜ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ˜¯ POD ç±»å‹ã€‚ 6. æ‰€æœ‰éé™æ€æ•°æ®æˆå‘˜å‡å’Œå…¶åŸºç±»ä¹Ÿç¬¦åˆä¸Šè¿°è§„åˆ™ï¼ˆé€’å½’å®šä¹‰ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ POD ç±»å‹ä¸èƒ½åŒ…å«é POD ç±»å‹çš„æ•°æ®ã€‚ 7. æ­¤å¤–ï¼Œæ‰€æœ‰å…¼å®¹Cè¯­è¨€çš„æ•°æ®ç±»å‹éƒ½æ˜¯ POD ç±»å‹ï¼ˆstructã€union ç­‰ä¸èƒ½è¿èƒŒä¸Šè¿°è§„åˆ™ï¼‰ã€‚ 2.C++11 å…è®¸è”åˆä½“æœ‰é™æ€æˆå‘˜ C++11 åˆ é™¤äº†è”åˆä½“ä¸å…è®¸æ‹¥æœ‰é™æ€æˆå‘˜çš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼š union U { static int func() { int n = 3; return n; } }; éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé™æ€æˆå‘˜å˜é‡åªèƒ½åœ¨è”åˆä½“å†…å®šä¹‰ï¼Œå´ä¸èƒ½åœ¨è”åˆä½“å¤–ä½¿ç”¨ï¼Œè¿™ä½¿å¾—è¯¥è§„åˆ™å¾ˆæ²¡ç”¨ã€‚ éå—é™è”åˆä½“çš„èµ‹å€¼æ³¨æ„äº‹é¡¹ C++11 è§„å®šï¼Œå¦‚æœéå—é™è”åˆä½“å†…æœ‰ä¸€ä¸ªé POD çš„æˆå‘˜ï¼Œè€Œè¯¥æˆå‘˜æ‹¥æœ‰è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªéå—é™è”åˆä½“çš„é»˜è®¤æ„é€ å‡½æ•°å°†è¢«ç¼–è¯‘å™¨åˆ é™¤ï¼›å…¶ä»–çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œä¾‹å¦‚é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ã€æ‹·è´èµ‹å€¼æ“ä½œç¬¦ä»¥åŠææ„å‡½æ•°ç­‰ï¼Œä¹Ÿå°†è¢«åˆ é™¤ã€‚ è¿™æ¡è§„åˆ™å¯èƒ½å¯¼è‡´å¯¹è±¡æ„é€ å¤±è´¥ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š #include \u003cstring\u003e using namespace std; union U { string s; int n; }; int main() { U u; // æ„é€ å¤±è´¥ï¼Œå› ä¸º U çš„æ„é€ å‡½æ•°è¢«åˆ é™¤ return 0; } åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå› ä¸º string ç±»æ‹¥æœ‰è‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥ U çš„æ„é€ å‡½æ•°è¢«åˆ é™¤ï¼›å®šä¹‰ U çš„ç±»å‹å˜é‡ u éœ€è¦è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥ u ä¹Ÿå°±æ— æ³•å®šä¹‰æˆåŠŸã€‚ è§£å†³ä¸Šé¢é—®é¢˜çš„ä¸€èˆ¬éœ€è¦ç”¨åˆ° placement newï¼ˆç¨åä¼šè®²è§£è¿™ä¸ªæ¦‚å¿µï¼‰ï¼Œä»£ç å¦‚ä¸‹ï¼š #include \u003cstring\u003e using namespace std; union U { string s; int n; public: U() { new(\u0026s) string; } ~U() { s.~string(); } }; int main() { U u; return 0; } æ„é€ æ—¶ï¼Œé‡‡ç”¨ placement new å°† s æ„é€ åœ¨å…¶åœ°å€ \u0026s ä¸Šï¼Œè¿™é‡Œ placement new çš„å”¯ä¸€ä½œç”¨åªæ˜¯è°ƒç”¨äº†ä¸€ä¸‹ string ç±»çš„æ„é€ å‡½æ•°ã€‚æ³¨æ„ï¼Œåœ¨ææ„æ—¶è¿˜éœ€è¦è°ƒç”¨ string ç±»çš„ææ„å‡½æ•°ã€‚ placement new æ˜¯ä»€ä¹ˆï¼Ÿ placement new æ˜¯ new å…³é”®å­—çš„ä¸€ç§è¿›é˜¶ç”¨æ³•ï¼Œæ—¢å¯ä»¥åœ¨æ ˆï¼ˆstackï¼‰ä¸Šç”Ÿæˆå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥åœ¨å †ï¼ˆheapï¼‰ä¸Šç”Ÿæˆå¯¹è±¡ã€‚ç›¸å¯¹åº”åœ°ï¼Œæˆ‘ä»¬æŠŠå¸¸è§çš„ new çš„ç”¨æ³•ç§°ä¸º operator newï¼Œå®ƒåªèƒ½åœ¨ heap ä¸Šç”Ÿæˆå¯¹è±¡ã€‚ placement new çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š new(address) ClassConstruct(â€¦) address è¡¨ç¤ºå·²æœ‰å†…å­˜çš„åœ°å€ï¼Œè¯¥å†…å­˜å¯ä»¥åœ¨æ ˆä¸Šï¼Œä¹Ÿå¯ä»¥åœ¨å †ä¸Šï¼›ClassConstruct(â€¦) è¡¨ç¤ºè°ƒç”¨ç±»çš„æ„é€ å‡½æ•°ï¼Œå¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿå¯ä»¥çœç•¥æ‹¬å·ã€‚ placement new åˆ©ç”¨å·²ç»ç”³è¯·å¥½çš„å†…å­˜æ¥ç”Ÿæˆå¯¹è±¡ï¼Œå®ƒä¸å†ä¸ºå¯¹è±¡åˆ†é…æ–°çš„å†…å­˜ï¼Œè€Œæ˜¯å°†å¯¹è±¡æ•°æ®æ”¾åœ¨ address æŒ‡å®šçš„å†…å­˜ä¸­ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œplacement new ä½¿ç”¨çš„æ˜¯ s çš„å†…å­˜ç©ºé—´ã€‚ éå—é™è”åˆä½“çš„åŒ¿åå£°æ˜å’Œâ€œæšä¸¾å¼ç±»â€ åŒ¿åè”åˆä½“æ˜¯æŒ‡ä¸å…·åçš„è”åˆä½“ï¼ˆä¹Ÿå³æ²¡æœ‰åå­—çš„è”åˆä½“ï¼‰ï¼Œä¸€èˆ¬å®šä¹‰å¦‚ä¸‹ï¼š union U{ union { int x; }; //æ­¤è”åˆä½“ä¸ºåŒ¿åè”åˆä½“ }; å¯ä»¥çœ‹åˆ°ï¼Œè”åˆä½“ U å†…å®šä¹‰äº†ä¸€ä¸ªä¸å…·åçš„è”åˆä½“ï¼Œè¯¥è”åˆä½“åŒ…å«ä¸€ä¸ª int ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªè”åˆä½“ä¸ºåŒ¿åè”åˆä½“ã€‚ åŒæ ·çš„ï¼Œéå—é™è”åˆä½“ä¹Ÿå¯ä»¥åŒ¿åï¼Œè€Œå½“éå—é™çš„åŒ¿åè”åˆä½“è¿ç”¨äºç±»çš„å£°æ˜æ—¶ï¼Œè¿™æ ·çš„ç±»è¢«ç§°ä¸ºâ€œæšä¸¾å¼ç±»â€ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š #include \u003ccstring\u003e using namespace std; class Student{ public: Student(bool g, int a): gender(g), age(a){} bool gender; int age; }; class Singer { public: enum Type { STUDENT, NATIVE, FOREIGENR }; Singer(bool g, int a) : s(g, a) { t = STUDENT; } Singer(int i) : id(i) { t = NATIVE; } Singer(const char* n, int s) { int size = (s \u003e 9) ? 9 : s; memcpy(name , n, size); name[s] = '\\0'; t = FOREIGENR; } ~Singer(){} private: Type t; union { Student s; int id; char name[10]; }; }; int main() { Singer(true, 13); Singer(310217); Singer(\"J Michael\", 9); return 0; } ä¸Šé¢çš„ä»£ç ä¸­ä½¿ç”¨äº†ä¸€ä¸ªåŒ¿åéå—é™è”åˆä½“ï¼Œå®ƒä½œä¸ºç±» Singer çš„â€œå˜é•¿æˆå‘˜â€æ¥ä½¿ç”¨ï¼Œè¿™æ ·çš„å˜é•¿æˆå‘˜ç»™ç±»çš„ç¼–å†™å¸¦æ¥äº†æ›´å¤§çš„çµæ´»æ€§ï¼Œè¿™æ˜¯ C++98 æ ‡å‡†ä¸­æ— æ³•è¾¾åˆ°çš„ï¼ˆç¼–è¯‘å™¨ä¼šæŠ¥member â€˜Student Singer::::sâ€™ with constructor not allowed in unioné”™è¯¯ï¼‰ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:13","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] forå¾ªç¯ï¼ˆåŸºäºèŒƒå›´çš„å¾ªç¯ï¼‰è¯¦è§£ C++ 11æ ‡å‡†ä¹‹å‰ï¼ˆC++ 98/03 æ ‡å‡†ï¼‰ï¼Œå¦‚æœè¦ç”¨ for å¾ªç¯è¯­å¥éå†ä¸€ä¸ªæ•°ç»„æˆ–è€…å®¹å™¨ï¼Œåªèƒ½å¥—ç”¨å¦‚ä¸‹ç»“æ„ï¼š for (è¡¨è¾¾å¼ 1; è¡¨è¾¾å¼ 2; è¡¨è¾¾å¼ 3) { //å¾ªç¯ä½“ } ä¾‹å¦‚ï¼Œä¸‹é¢ç¨‹åºæ¼”ç¤ºäº†ç”¨ä¸Šè¿°ç»“æ„éå†æ•°ç»„å’Œå®¹å™¨çš„å…·ä½“å®ç°è¿‡ç¨‹ï¼ˆå®ä¾‹ä¸€ï¼‰: #include \u003ciostream\u003e #include \u003cvector\u003e #include \u003cstring.h\u003e using namespace std; int main() { char arc[] = \"http://c.biancheng.net/cplus/11/\"; int i; //forå¾ªç¯éå†æ™®é€šæ•°ç»„ for (i = 0; i \u003c strlen(arc); i++) { cout \u003c\u003c arc[i]; } cout \u003c\u003c endl; vector\u003cchar\u003emyvector(arc,arc+23); vector\u003cchar\u003e::iterator iter; //forå¾ªç¯éå† vector å®¹å™¨ for (iter = myvector.begin(); iter != myvector.end(); ++iter) { cout \u003c\u003c *iter; } return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š http://c.biancheng.net/cplus/11/ http://c.biancheng.net/ æ­¤ç¤ºä¾‹ä¸­ï¼Œvector ä¸º STL æ ‡å‡†åº“æä¾›çš„åºåˆ—å¼å®¹å™¨ï¼Œå…³äºè¯¥å®¹å™¨çš„å…·ä½“ç”¨æ³•ï¼Œå¯é˜…è¯»ã€ŠC++ STL vectorå®¹å™¨è¯¦è§£ã€‹ä¸€èŠ‚ï¼Œè¿™é‡Œä¸å†åšé‡å¤èµ˜è¿°ã€‚ è€Œ C++ 11 æ ‡å‡†ä¸­ï¼Œé™¤äº†å¯ä»¥æ²¿ç”¨å‰é¢ä»‹ç»çš„ç”¨æ³•å¤–ï¼Œè¿˜ä¸º for å¾ªç¯æ·»åŠ äº†ä¸€ç§å…¨æ–°çš„è¯­æ³•æ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š for (declaration : expression){ //å¾ªç¯ä½“ } å…¶ä¸­ï¼Œä¸¤ä¸ªå‚æ•°å„è‡ªçš„å«ä¹‰å¦‚ä¸‹: declarationï¼šè¡¨ç¤ºæ­¤å¤„è¦å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œè¯¥å˜é‡çš„ç±»å‹ä¸ºè¦éå†åºåˆ—ä¸­å­˜å‚¨å…ƒç´ çš„ç±»å‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒC++ 11 æ ‡å‡†ä¸­ï¼Œdeclarationå‚æ•°å¤„å®šä¹‰çš„å˜é‡ç±»å‹å¯ä»¥ç”¨ auto å…³é”®å­—è¡¨ç¤ºï¼Œè¯¥å…³é”®å­—å¯ä»¥ä½¿ç¼–è¯‘å™¨è‡ªè¡Œæ¨å¯¼è¯¥å˜é‡çš„æ•°æ®ç±»å‹ã€‚ expressionï¼šè¡¨ç¤ºè¦éå†çš„åºåˆ—ï¼Œå¸¸è§çš„å¯ä»¥ä¸ºäº‹å…ˆå®šä¹‰å¥½çš„æ™®é€šæ•°ç»„æˆ–è€…å®¹å™¨ï¼Œè¿˜å¯ä»¥æ˜¯ç”¨ {} å¤§æ‹¬å·åˆå§‹åŒ–çš„åºåˆ—ã€‚ å¯ä»¥çœ‹åˆ°ï¼ŒåŒ C++ 98/03 ä¸­ for å¾ªç¯çš„è¯­æ³•æ ¼å¼ç›¸æ¯”è¾ƒï¼Œæ­¤æ ¼å¼å¹¶æ²¡æœ‰æ˜ç¡®é™å®š for å¾ªç¯çš„éå†èŒƒå›´ï¼Œè¿™æ˜¯å®ƒä»¬æœ€å¤§çš„åŒºåˆ«ï¼Œå³æ—§æ ¼å¼çš„ for å¾ªç¯å¯ä»¥æŒ‡å®šå¾ªç¯çš„èŒƒå›´ï¼Œè€Œ C++11 æ ‡å‡†å¢åŠ çš„ for å¾ªç¯ï¼Œåªä¼šé€ä¸ªéå† expression å‚æ•°å¤„æŒ‡å®šåºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚ ä¸‹é¢ç¨‹åºæ¼”ç¤ºäº†å¦‚ä½•ç”¨ C++ 11 æ ‡å‡†ä¸­çš„ for å¾ªç¯éå†å®ä¾‹ä¸€å®šä¹‰çš„ arc æ•°ç»„å’Œ myvector å®¹å™¨ï¼š #include \u003ciostream\u003e #include \u003cvector\u003e using namespace std; int main() { char arc[] = \"http://c.biancheng.net/cplus/11/\"; //forå¾ªç¯éå†æ™®é€šæ•°ç»„ for (char ch : arc) { cout \u003c\u003c ch; } cout \u003c\u003c '!' \u003c\u003c endl; vector\u003cchar\u003emyvector(arc, arc + 23); //forå¾ªç¯éå† vector å®¹å™¨ for (auto ch : myvector) { cout \u003c\u003c ch; } cout \u003c\u003c '!'; return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š http://c.biancheng.net/cplus/11/ ! http://c.biancheng.net/! è¿™é‡Œæœ‰ä»¥ä¸‹ 2 ç‚¹éœ€è¦è¯´æ˜ï¼š 1. ç¨‹åºä¸­åœ¨éå† myvector å®¹å™¨æ—¶ï¼Œå®šä¹‰äº† auto ç±»å‹çš„ ch å˜é‡ï¼Œå½“ç¼–è¯‘å™¨ç¼–è¯‘ç¨‹åºæ—¶ï¼Œä¼šé€šè¿‡ myvector å®¹å™¨ä¸­å­˜å‚¨çš„å…ƒç´ ç±»å‹è‡ªåŠ¨æ¨å¯¼å‡º ch ä¸º char ç±»å‹ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„ ch ä¸æ˜¯è¿­ä»£å™¨ç±»å‹ï¼Œè€Œè¡¨ç¤ºçš„æ˜¯ myvector å®¹å™¨ä¸­å­˜å‚¨çš„æ¯ä¸ªå…ƒç´ ã€‚ 2. ä»”ç»†è§‚å¯Ÿç¨‹åºçš„è¾“å‡ºç»“æœï¼Œå…¶ä¸­ç¬¬ä¸€è¡Œè¾“å‡ºçš„å­—ç¬¦ä¸²å’Œ â€œ!â€ ä¹‹é—´è¿˜è¾“å‡ºæœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œè¿™æ˜¯å› ä¸ºæ–°æ ¼å¼çš„ for å¾ªç¯åœ¨éå†å­—ç¬¦ä¸²åºåˆ—æ—¶ï¼Œä¸åªæ˜¯éå†åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œè¿˜ä¼šéå†ä½äºè¯¥å­—ç¬¦ä¸²æœ«å°¾çš„ â€˜\\0â€™ï¼ˆå­—ç¬¦ä¸²çš„ç»“æŸæ ‡å¿—ï¼‰ã€‚ä¹‹æ‰€ä»¥ç¬¬äºŒè¡Œè¾“å‡ºçš„å­—ç¬¦ä¸²å’Œ â€œ!â€ ä¹‹é—´æ²¡æœ‰ç©ºæ ¼ï¼Œæ˜¯å› ä¸º myvector å®¹å™¨ä¸­æ²¡æœ‰å­˜å‚¨ â€˜\\0â€™ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œæ–°è¯­æ³•æ ¼å¼çš„ for å¾ªç¯è¿˜æ”¯æŒéå†ç”¨{ }å¤§æ‹¬å·åˆå§‹åŒ–çš„åˆ—è¡¨ï¼Œæ¯”å¦‚ï¼š #include \u003ciostream\u003e using namespace std; int main() { for (int num : {1, 2, 3, 4, 5}) { cout \u003c\u003c num \u003c\u003c \" \"; } return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 1 2 3 4 5 å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ä½¿ç”¨æ–°è¯­æ³•æ ¼å¼çš„ for å¾ªç¯éå†æŸä¸ªåºåˆ—æ—¶ï¼Œå¦‚æœéœ€è¦éå†çš„åŒæ—¶ä¿®æ”¹åºåˆ—ä¸­å…ƒç´ çš„å€¼ï¼Œå®ç°æ–¹æ¡ˆæ˜¯åœ¨ declaration å‚æ•°å¤„å®šä¹‰å¼•ç”¨å½¢å¼çš„å˜é‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e #include \u003cvector\u003e using namespace std; int main() { char arc[] = \"abcde\"; vector\u003cchar\u003emyvector(arc, arc + 5); //forå¾ªç¯éå†å¹¶ä¿®æ”¹å®¹å™¨ä¸­å„ä¸ªå­—ç¬¦çš„å€¼ for (auto \u0026ch : myvector) { ch++; } //forå¾ªç¯éå†è¾“å‡ºå®¹å™¨ä¸­å„ä¸ªå­—ç¬¦ for (auto ch : myvector) { cout \u003c\u003c ch; } return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š bcdef æ­¤ç¨‹åºä¸­å…ˆåä½¿ç”¨äº† 2 ä¸ªæ–°è¯­æ³•æ ¼å¼çš„ for å¾ªç¯ï¼Œå…¶ä¸­å‰è€…ç”¨äºä¿®æ”¹ myvector å®¹å™¨ä¸­å„ä¸ªå…ƒç´ çš„å€¼ï¼Œåè€…ç”¨äºè¾“å‡ºä¿®æ”¹åçš„ myvector å®¹å™¨ä¸­çš„å„ä¸ªå…ƒç´ ã€‚ æœ‰è¯»è€…å¯èƒ½ä¼šé—®ï¼Œdeclaration å‚æ•°æ—¢å¯ä»¥å®šä¹‰æ™®é€šå½¢å¼çš„å˜é‡ï¼Œä¹Ÿå¯ä»¥å®šä¹‰å¼•ç”¨å½¢å¼çš„å˜é‡ï¼Œåº”è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå¦‚æœéœ€è¦åœ¨éå†åºåˆ—çš„è¿‡ç¨‹ä¸­ä¿®æ”¹å™¨å†…éƒ¨å…ƒç´ çš„å€¼ï¼Œå°±å¿…é¡»å®šä¹‰å¼•ç”¨å½¢å¼çš„å˜é‡ï¼›åä¹‹ï¼Œå»ºè®®å®šä¹‰const \u0026ï¼ˆå¸¸å¼•ç”¨ï¼‰å½¢å¼çš„å˜é‡ï¼ˆé¿å…äº†åº•å±‚å¤åˆ¶å˜é‡çš„è¿‡ç¨‹ï¼Œæ•ˆç‡æ›´é«˜ï¼‰ï¼Œä¹Ÿå¯ä»¥å®šä¹‰æ™®é€šå˜é‡ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:14","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] forå¾ªç¯ä½¿ç”¨æ³¨æ„äº‹é¡¹ ã€ŠC++11 forå¾ªç¯ã€‹ä¸€èŠ‚å·²ç»è¯¦ç»†ä»‹ç»äº† C++11 æ ‡å‡†ä¸­ for å¾ªç¯çš„åŸºæœ¬ç”¨æ³•ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæœ¬èŠ‚å°†ä»‹ç»ä¸€äº› for å¾ªç¯çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼Œå¸®åŠ©è¯»è€…æ›´å‡†ç¡®é«˜æ•ˆåœ°ä½¿ç”¨åŸºäºèŒƒå›´çš„ for å¾ªç¯ã€‚ é¦–å…ˆéœ€è¦æ˜ç¡®çš„ä¸€ç‚¹æ˜¯ï¼Œå½“ä½¿ç”¨ for å¾ªç¯éå†æŸä¸ªåºåˆ—æ—¶ï¼Œæ— è®ºè¯¥åºåˆ—æ˜¯æ™®é€šæ•°ç»„ã€å®¹å™¨è¿˜æ˜¯ç”¨{ }å¤§æ‹¬å·åŒ…è£¹çš„åˆå§‹åŒ–åˆ—è¡¨ï¼Œéå†åºåˆ—çš„å˜é‡éƒ½è¡¨ç¤ºçš„æ˜¯å½“å‰åºåˆ—ä¸­çš„å„ä¸ªå…ƒç´ ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e #include \u003cvector\u003e using namespace std; int main() { //forå¾ªç¯éå†åˆå§‹åŒ–åˆ—è¡¨ for (int ch : {1,2,3,4,5}) { cout \u003c\u003c ch; } cout \u003c\u003c endl; //forå¾ªç¯éå†æ™®é€šæ•°ç»„ char arc[] = \"http://c.biancheng.net/cplus/11/\"; for (char ch : arc) { cout \u003c\u003c ch; } cout \u003c\u003c endl; //forå¾ªç¯éå† vector å®¹å™¨ vector\u003cchar\u003emyvector(arc, arc + 23); for (auto ch : myvector) { cout \u003c\u003c ch; } return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 12345 http://c.biancheng.net/cplus/11/ http://c.biancheng.net/ ä¸Šé¢ç¨‹åºæ¼”ç¤ºäº†ç”¨ for å¾ªç¯éå† 3 ç§åºåˆ—çš„è¿‡ç¨‹ï¼Œå…¶ä¸­å‰ä¸¤ç§æƒ…å†µå¾ˆå®¹æ˜“ç†è§£ï¼Œä½†å¯¹äºç”¨åŸºäºèŒƒå›´çš„ for å¾ªç¯éå†å®¹å™¨ä¸­çš„å…ƒç´ ï¼Œå¾ˆå¤šè¯»è€…ä¼šå°† ch è¯¯è®¤ä¸ºæŒ‡å‘å„ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ï¼Œå…¶å®ä¸ç„¶ï¼Œå®ƒè¡¨ç¤ºçš„ä»æ˜¯å®¹å™¨ä¸­çš„å„ä¸ªå…ƒç´ ã€‚ ä¸ºäº†åŠ æ·±è¯»è€…å¯¹éå†å®¹å™¨çš„ç†è§£ï¼Œä¸‹é¢ç¨‹åºä»¥ map å®¹å™¨ä¸ºä¾‹ï¼Œå†ä¸¾ä¸€ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e #include \u003cmap\u003e #include \u003cstring\u003e using namespace std; int main() { map\u003cstring, string\u003emymap{ {\"C++11\",\"http://c.biancheng.net/cplus/11/\"}, {\"Python\",\"http://c.biancheng.net/python/\"}, {\"Java\",\"http://c.biancheng.net/java/\"} }; for (pair\u003cstring,string\u003e ch : mymap) { cout \u003c\u003c ch.first \u003c\u003c \" \" \u003c\u003c ch.second \u003c\u003c endl; } return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š C++11 http://c.biancheng.net/cplus/11/ Java http://c.biancheng.net/java/ Python http://c.biancheng.net/python/ è¦çŸ¥é“ï¼Œmap å®¹å™¨ä¸­å­˜å‚¨çš„ä¸å†æ˜¯æ™®é€šæ•°æ®ç±»å‹çš„æ•°æ®ï¼Œè€Œæ˜¯ pair ç±»å‹çš„æ•°æ®ï¼Œå› æ­¤ç¨‹åºä¸­åœ¨ä½¿ç”¨åŸºäºèŒƒå›´çš„ for å¾ªç¯éå† map å®¹å™¨æ—¶ï¼Œå®šä¹‰çš„æ˜¯ pair ç±»å‹çš„å˜é‡ã€‚ å€¼å¾—åˆå­¦è€…æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒåŸºäºèŒƒå›´çš„ for å¾ªç¯ä¹Ÿå¯ä»¥ç›´æ¥éå†æŸä¸ªå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼š for (char ch : \"http://c.biancheng.net/cplus/11/\") { cout \u003c\u003c ch; } å‰é¢æåˆ°ï¼Œæ™®é€šæ•°ç»„å¯ä»¥ä½œä¸ºè¢«éå†çš„åºåˆ—ã€‚æ‹¿æ­¤ç¨‹åºä¸­çš„å­—ç¬¦ä¸²æ¥è¯´ï¼Œå…¶æ•°æ®ç±»å‹ä¸ºconst char[33]ï¼Œå³åœ¨ç¼–è¯‘å™¨çœ‹æ¥å­—ç¬¦ä¸²å°±æ˜¯ä¸€ä¸ªæ™®é€šæ•°ç»„ï¼Œå› æ­¤å®Œå…¨å¯ä»¥ç›´æ¥ä½œä¸ºè¢«éå†çš„åºåˆ—ã€‚ å½“ç„¶ï¼ŒåŸºäºèŒƒå›´çš„ for å¾ªç¯ä¹Ÿå¯ä»¥éå† string ç±»å‹çš„å­—ç¬¦ä¸²ï¼Œè¿™ç§æƒ…å†µä¸‹å†’å·å‰å®šä¹‰ char ç±»å‹çš„å˜é‡å³å¯ã€‚ æ€»çš„æ¥è¯´ï¼ŒåŸºäºèŒƒå›´çš„ for å¾ªç¯å¯ä»¥éå†æ™®é€šæ•°ç»„ã€stringå­—ç¬¦ä¸²ã€å®¹å™¨ä»¥åŠåˆå§‹åŒ–åˆ—è¡¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œfor å¾ªç¯å†’å·åè¿˜å¯ä»¥æ”¾ç½®è¿”å› string å­—ç¬¦ä¸²ä»¥åŠå®¹å™¨å¯¹è±¡çš„å‡½æ•°ï¼Œæ¯”å¦‚ï¼š #include \u003ciostream\u003e #include \u003cvector\u003e #include \u003cstring\u003e using namespace std; string str = \"http://c.biancheng.net/cplus/11/\"; vector\u003cint\u003e myvector = { 1,2,3,4,5 }; string retStr() { return str; } vector\u003cint\u003e retVector() { return myvector; } int main() { //éå†å‡½æ•°è¿”å›çš„ string å­—ç¬¦ä¸² for (char ch : retStr()) { cout \u003c\u003c ch; } cout \u003c\u003c endl; //éå†å‡½æ•°è¿”å›çš„ vector å®¹å™¨ for (int num : retVector()) { cout \u003c\u003c num \u003c\u003c \" \"; } return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š http://c.biancheng.net/cplus/11/ 1 2 3 4 5 æ³¨æ„ï¼ŒåŸºäºèŒƒå›´çš„ for å¾ªç¯ä¸æ”¯æŒéå†å‡½æ•°è¿”å›çš„ä»¥æŒ‡é’ˆå½¢å¼è¡¨ç¤ºçš„æ•°ç»„ï¼Œæ¯”å¦‚ï¼š //é”™è¯¯ç¤ºä¾‹ #include \u003ciostream\u003e using namespace std; char str[] = \"http://c.biancheng.net/cplus/11/\"; char* retStr() { return str; } int main() { for (char ch : retStr()) //ç›´æ¥æŠ¥é”™ { cout \u003c\u003c ch; } return 0; } åŸå› å¾ˆç®€å•ï¼Œæ­¤æ ¼å¼çš„ for å¾ªç¯åªèƒ½éå†æœ‰æ˜ç¡®èŒƒå›´çš„ä¸€ç»„æ•°æ®ï¼Œä¸Šé¢ç¨‹åºä¸­ retStr() å‡½æ•°è¿”å›çš„æ˜¯æŒ‡é’ˆå˜é‡ï¼Œéå†èŒƒå›´å¹¶æœªæ˜ç¡®æŒ‡æ˜ï¼Œæ‰€ä»¥ç¼–è¯‘å¤±è´¥ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå½“åŸºäºèŒƒå›´çš„ for å¾ªç¯éå†çš„æ˜¯æŸå‡½æ•°è¿”å›çš„ string å¯¹è±¡æˆ–è€…å®¹å™¨æ—¶ï¼Œæ•´ä¸ªéå†è¿‡ç¨‹ä¸­ï¼Œå‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ ä¸¾ä¸ªä¾‹å­: #include \u003ciostream\u003e #include \u003cstring\u003e using namespace std; string str= \"http://c.biancheng.net/cplus/11/\"; string retStr() { cout \u003c\u003c \"retStr:\" \u003c\u003c endl; return str; } int main() { //éå†å‡½æ•°è¿”å›çš„ string å­—ç¬¦ä¸² for (char ch : retStr()) { cout \u003c\u003c ch; } return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š retStr: http://c.biancheng.net/cplus/11/ å€ŸåŠ©æ‰§è¡Œç»“æœä¸éš¾åˆ†æå‡ºï¼Œæ•´ä¸ª for å¾ªç¯éå† str å­—ç¬¦ä¸²å¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼ŒretStr() å‡½æ•°ä»…åœ¨éå†å¼€å§‹å‰æ‰§è¡Œäº† 1 æ¬¡ã€‚ ç³»ç»Ÿå­¦è¿‡ STL æ ‡å‡†åº“çš„è¯»è€…åº”è¯¥çŸ¥é“ï¼ŒåŸºäºå…³è”å¼å®¹å™¨ï¼ˆåŒ…æ‹¬å“ˆå¸Œå®¹å™¨ï¼‰åº•å±‚å­˜å‚¨æœºåˆ¶çš„é™åˆ¶ï¼š ä¸å…è®¸ä¿®æ”¹ mapã€unordered_mapã€multimap ä»¥åŠ unordered_multimap å®¹å™¨å­˜å‚¨çš„é”®çš„å€¼ï¼› ä¸å…è®¸ä¿®æ”¹ setã€unordered_setã€multiset ä»¥åŠ unordered_multiset å®¹å™¨ä¸­å­˜å‚¨çš„å…ƒç´ çš„å€¼ã€‚ å…³äºä»¥ä¸Šå„ä¸ªå®¹å™¨çš„å…·ä½“ç”¨æ³•ï¼Œè¯»è€…å¯çŒ›å‡»ã€ŠC++ STLæ•™ç¨‹ã€‹è¿›è¡Œç³»ç»Ÿå­¦ä¹ ã€‚ å› æ­¤ï¼Œå½“ä½¿ç”¨åŸºäºèŒƒå›´çš„ for å¾ªç¯éå†æ­¤ç±»å‹å®¹å™¨æ—¶ï¼Œåˆ‡å‹¿ä¿®æ”¹å®¹å™¨ä¸­ä¸å…è®¸è¢«ä¿®æ”¹çš„æ•°æ®éƒ¨åˆ†ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç¨‹åºçš„æ‰§è¡Œå‡ºç°å„ç§ Bugã€‚ å¦å¤–ï¼ŒåŸºäºèŒƒå›´çš„ for å¾ªç¯å®Œæˆå¯¹å®¹å™¨çš„éå†ï¼Œå…¶åº•å±‚ä¹Ÿæ˜¯å€ŸåŠ©å®¹å™¨çš„è¿­ä»£å™¨å®ç°çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e #include \u003cvector\u003e int main(void) { std::vector\u003cint\u003earr = { 1, 2, 3, 4, 5 }; for (auto val : arr) { std::cout \u003c\u003c val \u003c\u003c std::endl; arr.push_back(10); //å‘å®¹å™¨ä¸­æ·»åŠ å…ƒç´  } return 0; } ç¨‹åºæ‰§è¡Œç»“æœå¯èƒ½ä¸ºï¼ˆè¾“å‡ºç»“æœä¸å”¯ä¸€ï¼‰ï¼š 1 -572662307 -572662307 4 5 å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºçš„æ‰§è¡Œç»“æœå¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚å°±æ˜¯å› ä¸ºåœ¨ for å¾ªç¯éå† arr å®¹å™¨çš„åŒæ—¶å‘è¯¥å®¹å™¨å°¾éƒ¨æ·»åŠ äº†æ–°çš„å…ƒç´ ï¼ˆå¯¹ arr å®¹å™¨è¿›è¡Œäº†æ‰©å¢ï¼‰ï¼Œè‡´ä½¿éå†å®¹å™¨æ‰€ä½¿ç”¨çš„è¿­ä»£å™¨å¤±æ•ˆï¼Œæ•´ä¸ªéå†è¿‡ç¨‹å‡ºç°é”™è¯¯ã€‚ å¦‚æœè¯»è€…æƒ³è¦å½»åº•ææ¸…æ¥šç¨‹åºæ‰§è¡Œå¤±è´¥çš„åŸå› ï¼Œè¯»äº†è§£ vector å®¹å™¨çš„åº•å±‚å­˜å‚¨æœºåˆ¶ï¼Œå¯é˜…è¯»ã€ŠC++ vectorå®¹å™¨åº•å±‚å®ç°æœºåˆ¶ã€‹ä¸€æ–‡ã€‚ å› æ­¤ï¼Œåœ¨ä½¿ç”¨åŸºäºèŒƒå›´çš„ for å¾ªç¯éå†å®¹å™¨æ—¶ï¼Œåº”é¿å…åœ¨å¾ªç¯ä½“ä¸­ä¿®æ”¹å®¹å™¨å­˜å‚¨å…ƒç´ çš„ä¸ªæ•°ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:15","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] constexprï¼šéªŒè¯æ˜¯å¦ä¸ºå¸¸é‡è¡¨è¾¾å¼ï¼ˆé•¿ç¯‡ç¥æ–‡ï¼‰ constexpr æ˜¯ C++ 11 æ ‡å‡†æ–°å¼•å…¥çš„å…³é”®å­—ï¼Œä¸è¿‡åœ¨è®²è§£å…¶å…·ä½“ç”¨æ³•å’ŒåŠŸèƒ½ä¹‹å‰ï¼Œè¯»è€…éœ€è¦å…ˆææ¸…æ¥š C++ å¸¸é‡è¡¨è¾¾å¼çš„å«ä¹‰ã€‚ æ‰€è°“å¸¸é‡è¡¨è¾¾å¼ï¼ŒæŒ‡çš„å°±æ˜¯ç”±å¤šä¸ªï¼ˆâ‰¥1ï¼‰å¸¸é‡ç»„æˆçš„è¡¨è¾¾å¼ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœè¡¨è¾¾å¼ä¸­çš„æˆå‘˜éƒ½æ˜¯å¸¸é‡ï¼Œé‚£ä¹ˆè¯¥è¡¨è¾¾å¼å°±æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œå¸¸é‡è¡¨è¾¾å¼ä¸€æ—¦ç¡®å®šï¼Œå…¶å€¼å°†æ— æ³•ä¿®æ”¹ã€‚ å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°å¸¸é‡è¡¨è¾¾å¼ã€‚ä»¥å®šä¹‰æ•°ç»„ä¸ºä¾‹ï¼Œæ•°ç»„çš„é•¿åº¦å°±å¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼: // 1) int url[10];//æ­£ç¡® // 2) int url[6 + 4];//æ­£ç¡® // 3) int length = 6; int url[length];//é”™è¯¯ï¼Œlengthæ˜¯å˜é‡ ä¸Šè¿°ä»£ç æ¼”ç¤ºäº† 3 ç§å®šä¹‰ url æ•°ç»„çš„æ–¹å¼ï¼Œå…¶ä¸­ç¬¬ 1ã€2 ç§å®šä¹‰ url æ•°ç»„æ—¶ï¼Œé•¿åº¦åˆ†åˆ«ä¸º 10 å’Œ 6+4ï¼Œæ˜¾ç„¶å®ƒä»¬éƒ½æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œå¯ä»¥ç”¨äºè¡¨ç¤ºæ•°ç»„çš„é•¿åº¦ï¼›ç¬¬ 3 ç§ url æ•°ç»„çš„é•¿åº¦ä¸º lengthï¼Œå®ƒæ˜¯å˜é‡è€Œéå¸¸é‡ï¼Œå› æ­¤ä¸æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ï¼Œæ— æ³•ç”¨äºè¡¨ç¤ºæ•°ç»„çš„é•¿åº¦ã€‚ å¸¸é‡è¡¨è¾¾å¼çš„åº”ç”¨åœºæ™¯è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚åŒ¿åæšä¸¾ã€switch-case ç»“æ„ä¸­çš„ case è¡¨è¾¾å¼ç­‰ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯è‡ªè¡Œç¼–ç æµ‹è¯•ï¼Œè¿™é‡Œä¸å†è¿‡å¤šä¸¾ä¾‹ã€‚ æˆ‘ä»¬çŸ¥é“ï¼ŒC++ ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹å¤§è‡´è¦ç»å†ç¼–è¯‘ã€é“¾æ¥ã€è¿è¡Œè¿™ 3 ä¸ªé˜¶æ®µã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¸¸é‡è¡¨è¾¾å¼å’Œéå¸¸é‡è¡¨è¾¾å¼çš„è®¡ç®—æ—¶æœºä¸åŒï¼Œéå¸¸é‡è¡¨è¾¾å¼åªèƒ½åœ¨ç¨‹åºè¿è¡Œé˜¶æ®µè®¡ç®—å‡ºç»“æœï¼›è€Œå¸¸é‡è¡¨è¾¾å¼çš„è®¡ç®—å¾€å¾€å‘ç”Ÿåœ¨ç¨‹åºçš„ç¼–è¯‘é˜¶æ®µï¼Œè¿™å¯ä»¥æå¤§æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼Œå› ä¸ºè¡¨è¾¾å¼åªéœ€è¦åœ¨ç¼–è¯‘é˜¶æ®µè®¡ç®—ä¸€æ¬¡ï¼ŒèŠ‚çœäº†æ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶éƒ½éœ€è¦è®¡ç®—ä¸€æ¬¡çš„æ—¶é—´ã€‚ å¯¹äºç”¨ C++ ç¼–å†™çš„ç¨‹åºï¼Œæ€§èƒ½å¾€å¾€æ˜¯æ°¸æ’çš„è¿½æ±‚ã€‚é‚£ä¹ˆåœ¨å®é™…å¼€å‘ä¸­ï¼Œå¦‚ä½•æ‰èƒ½åˆ¤å®šä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦ä¸ºå¸¸é‡è¡¨è¾¾å¼ï¼Œè¿›è€Œè·å¾—åœ¨ç¼–è¯‘é˜¶æ®µå³å¯æ‰§è¡Œçš„â€œç‰¹æƒâ€å‘¢ï¼Ÿé™¤äº†äººä¸ºåˆ¤å®šå¤–ï¼ŒC++11 æ ‡å‡†è¿˜æä¾›æœ‰ constexpr å…³é”®å­—ã€‚ constexpr å…³é”®å­—çš„åŠŸèƒ½æ˜¯ä½¿æŒ‡å®šçš„å¸¸é‡è¡¨è¾¾å¼è·å¾—åœ¨ç¨‹åºç¼–è¯‘é˜¶æ®µè®¡ç®—å‡ºç»“æœçš„èƒ½åŠ›ï¼Œè€Œä¸å¿…ç­‰åˆ°ç¨‹åºè¿è¡Œé˜¶æ®µã€‚C++ 11 æ ‡å‡†ä¸­ï¼Œconstexpr å¯ç”¨äºä¿®é¥°æ™®é€šå˜é‡ã€å‡½æ•°ï¼ˆåŒ…æ‹¬æ¨¡æ¿å‡½æ•°ï¼‰ä»¥åŠç±»çš„æ„é€ å‡½æ•°ã€‚ æ³¨æ„ï¼Œè·å¾—åœ¨ç¼–è¯‘é˜¶æ®µè®¡ç®—å‡ºç»“æœçš„èƒ½åŠ›ï¼Œå¹¶ä¸ä»£è¡¨ constexpr ä¿®é¥°çš„è¡¨è¾¾å¼ä¸€å®šä¼šåœ¨ç¨‹åºç¼–è¯‘é˜¶æ®µè¢«æ‰§è¡Œï¼Œå…·ä½“çš„è®¡ç®—æ—¶æœºè¿˜æ˜¯ç¼–è¯‘å™¨è¯´äº†ç®—ã€‚ constexprä¿®é¥°æ™®é€šå˜é‡ C++11 æ ‡å‡†ä¸­ï¼Œå®šä¹‰å˜é‡æ—¶å¯ä»¥ç”¨ constexpr ä¿®é¥°ï¼Œä»è€Œä½¿è¯¥å˜é‡è·å¾—åœ¨ç¼–è¯‘é˜¶æ®µå³å¯è®¡ç®—å‡ºç»“æœçš„èƒ½åŠ›ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½¿ç”¨ constexpr ä¿®æ”¹æ™®é€šå˜é‡æ—¶ï¼Œå˜é‡å¿…é¡»ç»è¿‡åˆå§‹åŒ–ä¸”åˆå§‹å€¼å¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; int main() { constexpr int num = 1 + 2 + 3; int url[num] = {1,2,3,4,5,6}; couts\u003c\u003c url[1] \u003c\u003c endl; return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 2 è¯»è€…å¯å°è¯•å°† constexpr åˆ é™¤ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨ä¼šæç¤ºâ€œurl[num] å®šä¹‰ä¸­ num ä¸å¯ç”¨ä½œå¸¸é‡â€ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºç¬¬ 6 è¡Œä½¿ç”¨ constexpr ä¿®é¥° num å˜é‡ï¼ŒåŒæ—¶å°† â€œ1+2+3â€ è¿™ä¸ªå¸¸é‡è¡¨è¾¾å¼èµ‹å€¼ç»™ numã€‚ç”±æ­¤ï¼Œç¼–è¯‘å™¨å°±å¯ä»¥åœ¨ç¼–è¯‘æ—¶æœŸå¯¹ num è¿™ä¸ªè¡¨è¾¾å¼è¿›è¡Œè®¡ç®—ï¼Œå› ä¸º num å¯ä»¥ä½œä¸ºå®šä¹‰æ•°ç»„æ—¶çš„é•¿åº¦ã€‚ æœ‰è¯»è€…å¯èƒ½å‘ç°ï¼Œå°†æ­¤ç¤ºä¾‹ç¨‹åºä¸­çš„ constexpr ç”¨ const å…³é”®å­—æ›¿æ¢ä¹Ÿå¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œè¿™æ˜¯å› ä¸º num çš„å®šä¹‰åŒæ—¶æ»¡è¶³â€œnum æ˜¯ const å¸¸é‡ä¸”ä½¿ç”¨å¸¸é‡è¡¨è¾¾å¼ä¸ºå…¶åˆå§‹åŒ–â€è¿™ 2 ä¸ªæ¡ä»¶ï¼Œç”±æ­¤ç¼–è¯‘å™¨ä¼šè®¤å®š num æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ã€‚ æ³¨æ„ï¼Œconst å’Œ constexpr å¹¶ä¸ç›¸åŒï¼Œå…³äºå®ƒä»¬çš„åŒºåˆ«ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€èŠ‚åšè¯¦ç»†è®²è§£ã€‚ å¦å¤–éœ€è¦é‡ç‚¹æå‡ºçš„æ˜¯ï¼Œå½“å¸¸é‡è¡¨è¾¾å¼ä¸­åŒ…å«æµ®ç‚¹æ•°æ—¶ï¼Œè€ƒè™‘åˆ°ç¨‹åºç¼–è¯‘å’Œè¿è¡Œæ‰€åœ¨çš„ç³»ç»Ÿç¯å¢ƒå¯èƒ½ä¸åŒï¼Œå¸¸é‡è¡¨è¾¾å¼åœ¨ç¼–è¯‘é˜¶æ®µå’Œè¿è¡Œé˜¶æ®µè®¡ç®—å‡ºçš„ç»“æœç²¾åº¦å¾ˆå¯èƒ½ä¼šå—åˆ°å½±å“ï¼Œå› æ­¤ C++11 æ ‡å‡†è§„å®šï¼Œæµ®ç‚¹å¸¸é‡è¡¨è¾¾å¼åœ¨ç¼–è¯‘é˜¶æ®µè®¡ç®—çš„ç²¾åº¦è¦è‡³å°‘ç­‰äºï¼ˆæˆ–è€…é«˜äºï¼‰è¿è¡Œé˜¶æ®µè®¡ç®—å‡ºçš„ç²¾åº¦ã€‚ constexprä¿®é¥°å‡½æ•° constexpr è¿˜å¯ä»¥ç”¨äºä¿®é¥°å‡½æ•°çš„è¿”å›å€¼ï¼Œè¿™æ ·çš„å‡½æ•°åˆç§°ä¸ºâ€œå¸¸é‡è¡¨è¾¾å¼å‡½æ•°â€ã€‚ æ³¨æ„ï¼Œconstexpr å¹¶éå¯ä»¥ä¿®æ”¹ä»»æ„å‡½æ•°çš„è¿”å›å€¼ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªå‡½æ•°è¦æƒ³æˆä¸ºå¸¸é‡è¡¨è¾¾å¼å‡½æ•°ï¼Œå¿…é¡»æ»¡è¶³å¦‚ä¸‹ 4 ä¸ªæ¡ä»¶ã€‚ æ•´ä¸ªå‡½æ•°çš„å‡½æ•°ä½“ä¸­ï¼Œé™¤äº†å¯ä»¥åŒ…å« using æŒ‡ä»¤ã€typedef è¯­å¥ä»¥åŠ static_assert æ–­è¨€å¤–ï¼Œåªèƒ½åŒ…å«ä¸€æ¡ return è¿”å›è¯­å¥ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š constexpr int display(int x) { int ret = 1 + 2 + x; return ret; } æ³¨æ„ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„ï¼Œå› ä¸ºè¯¥å‡½æ•°çš„è¿”å›å€¼ç”¨ constexpr ä¿®é¥°ï¼Œä½†å‡½æ•°å†…éƒ¨åŒ…å«å¤šæ¡è¯­å¥ã€‚ å¦‚ä¸‹æ˜¯æ­£ç¡®çš„å®šä¹‰ display() å¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„å†™æ³•ï¼š constexpr int display(int x) { //å¯ä»¥æ·»åŠ  using æ‰§è¡Œã€typedef è¯­å¥ä»¥åŠ static_assert æ–­è¨€ return 1 + 2 + x; } å¯ä»¥çœ‹åˆ°ï¼Œdisplay() å‡½æ•°çš„è¿”å›å€¼æ˜¯ç”¨ constexpr ä¿®é¥°çš„ int ç±»å‹å€¼ï¼Œä¸”è¯¥å‡½æ•°çš„å‡½æ•°ä½“ä¸­åªåŒ…å«ä¸€ä¸ª return è¯­å¥ã€‚ è¯¥å‡½æ•°å¿…é¡»æœ‰è¿”å›å€¼ï¼Œå³å‡½æ•°çš„è¿”å›å€¼ç±»å‹ä¸èƒ½æ˜¯ voidã€‚ ä¸¾ä¸ªä¾‹å­ï¼š constexpr void display() { //å‡½æ•°ä½“ } åƒä¸Šé¢è¿™æ ·å®šä¹‰çš„è¿”å›å€¼ç±»å‹ä¸º void çš„å‡½æ•°ï¼Œä¸å±äºå¸¸é‡è¡¨è¾¾å¼å‡½æ•°ã€‚åŸå› å¾ˆç®€å•ï¼Œå› ä¸ºé€šè¿‡ç±»ä¼¼çš„å‡½æ•°æ ¹æœ¬æ— æ³•è·å¾—ä¸€ä¸ªå¸¸é‡ã€‚ å‡½æ•°åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œå¿…é¡»æœ‰å¯¹åº”çš„å®šä¹‰è¯­å¥ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå‡½æ•°çš„ä½¿ç”¨åˆ†ä¸ºâ€œå£°æ˜â€å’Œâ€œå®šä¹‰â€ä¸¤éƒ¨åˆ†ï¼Œæ™®é€šçš„å‡½æ•°è°ƒç”¨åªéœ€è¦æå‰å†™å¥½è¯¥å‡½æ•°çš„å£°æ˜éƒ¨åˆ†å³å¯ï¼ˆå‡½æ•°çš„å®šä¹‰éƒ¨åˆ†å¯ä»¥æ”¾åœ¨è°ƒç”¨ä½ç½®ä¹‹åç”šè‡³å…¶å®ƒæ–‡ä»¶ä¸­ï¼‰ï¼Œä½†å¸¸é‡è¡¨è¾¾å¼å‡½æ•°åœ¨ä½¿ç”¨å‰ï¼Œå¿…é¡»è¦æœ‰è¯¥å‡½æ•°çš„å®šä¹‰ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; //æ™®é€šå‡½æ•°çš„å£°æ˜ int noconst_dis(int x); //å¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„å£°æ˜ constexpr int display(int x); //å¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„å®šä¹‰ constexpr int display(int x){ return 1 + 2 + x; } int main() { //è°ƒç”¨å¸¸é‡è¡¨è¾¾å¼å‡½æ•° int a[display(3)] = { 1,2,3,4 }; cout \u003c\u003c a[2] \u003c\u003c endl; //è°ƒç”¨æ™®é€šå‡½æ•° cout \u003c\u003c noconst_dis(3) \u003c\u003c endl; return 0; } //æ™®é€šå‡½æ•°çš„å®šä¹‰ int noconst_dis(int x) { return 1 + 2 + x; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 3 6 è¯»è€…å¯è‡ªè¡Œå°† display() å¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„å®šä¹‰è°ƒæ•´åˆ° main() å‡½æ•°ä¹‹åï¼ŒæŸ¥çœ‹ç¼–è¯‘å™¨çš„æŠ¥é”™ä¿¡æ¯ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œæ™®é€šå‡½æ•°åœ¨è°ƒç”¨æ—¶ï¼Œåªéœ€è¦ä¿è¯è°ƒç”¨ä½ç½®ä¹‹å‰æœ‰ç›¸åº”çš„å£°æ˜å³å¯ï¼›è€Œå¸¸é‡è¡¨è¾¾å¼å‡½æ•°åˆ™ä¸åŒï¼Œè°ƒç”¨ä½ç½®ä¹‹å‰å¿…é¡»è¦æœ‰è¯¥å‡½æ•°çš„å®šä¹‰ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç¨‹åºç¼–è¯‘å¤±è´¥ã€‚ return è¿”å›çš„è¡¨è¾¾å¼å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; int num = 3; constexpr int display(int x){ return num + x; } int main() { //è°ƒç”¨å¸¸é‡è¡¨è¾¾å¼å‡½æ•° int a[display(3)] = { 1,2,3,4 }; return 0; } è¯¥ç¨‹åºæ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œç¼–è¯‘å™¨æŠ¥â€œdisplay(3) çš„ç»“æœä¸æ˜¯å¸¸é‡â€çš„å¼‚å¸¸ã€‚ å¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„è¿”å›å€¼å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼çš„åŸå› å¾ˆç®€å•ï¼Œå¦‚æœæƒ³åœ¨ç¨‹åºç¼–è¯‘é˜¶æ®µè·å¾—æŸä¸ªå‡½æ•°è¿”å›çš„å¸¸é‡ï¼Œåˆ™è¯¥å‡½æ•°çš„ return è¯­å¥ä¸­å°±ä¸èƒ½åŒ…å«ç¨‹åºè¿è¡Œé˜¶æ®µæ‰èƒ½ç¡®å®šå€¼çš„å˜é‡ã€‚ æ³¨æ„ï¼Œåœ¨å¸¸é‡è¡¨è¾¾å¼å‡½æ•°çš„ return è¯­å¥ä¸­ï¼Œä¸èƒ½åŒ…å«èµ‹å€¼çš„æ“ä½œï¼ˆä¾‹å¦‚ return x=1 åœ¨å¸¸é‡è¡¨è¾¾å¼å‡½æ•°ä¸­ä¸å…è®¸çš„ï¼‰ã€‚å¦å¤–ï¼Œç”¨ constexpr ä¿®æ”¹å‡½æ•°æ—¶ï¼Œå‡½æ•°æœ¬èº«ä¹Ÿæ˜¯æ”¯æŒé€’å½’çš„ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯è‡ªè¡Œå°è¯•ç¼–ç æµ‹è¯•ã€‚ constexprä¿®é¥°ç±»çš„æ„é€ å‡½æ•° å¯¹äº C++ å†…ç½®ç±»å‹çš„æ•°æ®ï¼Œå¯ä»¥ç›´æ¥ç”¨ constexpr ä¿®é¥°ï¼Œä½†å¦‚æœæ˜¯è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼ˆç”¨ struct æˆ–è€… class å®ç°ï¼‰ï¼Œç›´æ¥ç”¨ constexpr ä¿®é¥°æ˜¯ä¸è¡Œçš„ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; //è‡ªå®šä¹‰ç±»å‹çš„å®šä¹‰ constexpr struct myType { const char* name; int age; //å…¶å®ƒç»“æ„ä½“æˆå‘˜ }; int main() { constexpr struct myType mt { \"zhangsan\", 10 }; cout \u003c\u003c mt.name \u003c\u003c \" \" \u003c\u003c mt.age \u003c\u003c endl; return 0; } æ­¤ç¨‹åºæ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„ï¼Œç¼–è¯‘å™¨ä¼šæŠ›å‡ºâ€œconstexprä¸èƒ½ä¿®é¥°è‡ªå®šä¹‰ç±»å‹â€çš„å¼‚å¸¸ã€‚ å½“æˆ‘ä»¬æƒ³è‡ªå®šä¹‰ä¸€ä¸ªå¯äº§ç”Ÿå¸¸é‡çš„ç±»å‹æ—¶ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯åœ¨è¯¥ç±»å‹çš„å†…éƒ¨æ·»åŠ ä¸€ä¸ªå¸¸é‡æ„é€ å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œä¿®æ”¹ä¸Šé¢çš„é”™è¯¯ç¤ºä¾‹å¦‚ä¸‹ï¼š #include \u003ciostream\u003e using namespace std; //è‡ªå®šä¹‰ç±»å‹çš„å®šä¹‰ s","date":"2023-07-12","objectID":"/posts/newfeature/:1:16","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] constexprå’Œconstçš„åŒºåˆ« ã€ŠC++11 constexprã€‹ä¸€èŠ‚ä¸­ï¼Œè¯¦ç»†è®²è§£äº† constexpr å…³é”®å­—çš„åŠŸèƒ½å’Œç”¨æ³•ã€‚ä¸€äº›è¯»è€…åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šæŠŠ const å’Œ constexpr ææ··ï¼Œä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ç”¨ constï¼Œä»€ä¹ˆæ—¶å€™ç”¨ constexprã€‚æœ¬èŠ‚å°±å¸¦é¢†å¤§å®¶å¯¹ const å’Œ constexpr åšç³»ç»Ÿåœ°åŒºåˆ†ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œconstexpr æ˜¯ C++ 11 æ ‡å‡†æ–°æ·»åŠ çš„å…³é”®å­—ï¼Œåœ¨æ­¤ä¹‹å‰ï¼ˆC++ 98/03æ ‡å‡†ï¼‰åªæœ‰ const å…³é”®å­—ï¼Œå…¶åœ¨å®é™…ä½¿ç”¨ä¸­ç»å¸¸ä¼šè¡¨ç°å‡ºä¸¤ç§ä¸åŒçš„è¯­ä¹‰ã€‚ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e #include \u003carray\u003e using namespace std; void dis_1(const int x){ //é”™è¯¯ï¼Œxæ˜¯åªè¯»çš„å˜é‡ array \u003cint,x\u003e myarr{1,2,3,4,5}; cout \u003c\u003c myarr[1] \u003c\u003c endl; } void dis_2(){ const int x = 5; array \u003cint,x\u003e myarr{1,2,3,4,5}; cout \u003c\u003c myarr[1] \u003c\u003c endl; } int main() { dis_1(5); dis_2(); } å¯ä»¥çœ‹åˆ°ï¼Œdis_1() å’Œ dis_2() å‡½æ•°ä¸­éƒ½åŒ…å«ä¸€ä¸ª const int xï¼Œä½† dis_1() å‡½æ•°ä¸­çš„ x æ— æ³•å®Œæˆåˆå§‹åŒ– array å®¹å™¨çš„ä»»åŠ¡ï¼Œè€Œ dis_2() å‡½æ•°ä¸­çš„ x å´å¯ä»¥ã€‚ è¿™æ˜¯å› ä¸ºï¼Œdis_1() å‡½æ•°ä¸­çš„â€œconst int xâ€åªæ˜¯æƒ³å¼ºè°ƒ x æ˜¯ä¸€ä¸ªåªè¯»çš„å˜é‡ï¼Œå…¶æœ¬è´¨ä»ä¸ºå˜é‡ï¼Œæ— æ³•ç”¨æ¥åˆå§‹åŒ– array å®¹å™¨ï¼›è€Œ dis_2() å‡½æ•°ä¸­çš„â€œconst int xâ€ï¼Œè¡¨æ˜ x æ˜¯ä¸€ä¸ªåªè¯»å˜é‡çš„åŒæ—¶ï¼Œx è¿˜æ˜¯ä¸€ä¸ªå€¼ä¸º 5 çš„å¸¸é‡ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ¥åˆå§‹åŒ– array å®¹å™¨ã€‚ C++ 11æ ‡å‡†ä¸­ï¼Œä¸ºäº†è§£å†³ const å…³é”®å­—çš„åŒé‡è¯­ä¹‰é—®é¢˜ï¼Œä¿ç•™äº† const è¡¨ç¤ºâ€œåªè¯»â€çš„è¯­ä¹‰ï¼Œè€Œå°†â€œå¸¸é‡â€çš„è¯­ä¹‰åˆ’åˆ†ç»™äº†æ–°æ·»åŠ çš„ constexpr å…³é”®å­—ã€‚å› æ­¤ C++11 æ ‡å‡†ä¸­ï¼Œå»ºè®®å°† const å’Œ constexpr çš„åŠŸèƒ½åŒºåˆ†å¼€ï¼Œå³å‡¡æ˜¯è¡¨è¾¾â€œåªè¯»â€è¯­ä¹‰çš„åœºæ™¯éƒ½ä½¿ç”¨ constï¼Œè¡¨è¾¾â€œå¸¸é‡â€è¯­ä¹‰çš„åœºæ™¯éƒ½ä½¿ç”¨ constexprã€‚ åœ¨ä¸Šé¢çš„å®ä¾‹ç¨‹åºä¸­ï¼Œdis_2() å‡½æ•°ä¸­ä½¿ç”¨ const int x æ˜¯ä¸è§„èŒƒçš„ï¼Œåº”ä½¿ç”¨ constexpr å…³é”®å­—ã€‚ æœ‰è¯»è€…å¯èƒ½ä¼šé—®ï¼Œâ€œåªè¯»â€ä¸å°±æ„å‘³ç€å…¶ä¸èƒ½è¢«ä¿®æ”¹å—ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œâ€œåªè¯»â€å’Œâ€œä¸å…è®¸è¢«ä¿®æ”¹â€ä¹‹é—´å¹¶æ²¡æœ‰å¿…ç„¶çš„è”ç³»ï¼Œä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; int main() { int a = 10; const int \u0026 con_b = a; cout \u003c\u003c con_b \u003c\u003c endl; a = 20; cout \u003c\u003c con_b \u003c\u003c endl; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 10 20 å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºä¸­ç”¨ const ä¿®é¥°äº† con_b å˜é‡ï¼Œè¡¨ç¤ºè¯¥å˜é‡â€œåªè¯»â€ï¼Œå³æ— æ³•é€šè¿‡å˜é‡è‡ªèº«å»ä¿®æ”¹è‡ªå·±çš„å€¼ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ con_b çš„å€¼ä¸èƒ½å€ŸåŠ©å…¶å®ƒå˜é‡é—´æ¥æ”¹å˜ï¼Œé€šè¿‡æ”¹å˜ a çš„å€¼å°±å¯ä»¥ä½¿ con_b çš„å€¼å‘ç”Ÿå˜åŒ–ã€‚ åœ¨å¤§éƒ¨åˆ†å®é™…åœºæ™¯ä¸­ï¼Œconst å’Œ constexpr æ˜¯å¯ä»¥æ··ç”¨çš„ï¼Œä¾‹å¦‚ï¼š const int a = 5 + 4; constexpr int a = 5 + 4; å®ƒä»¬æ˜¯å®Œå…¨ç­‰ä»·çš„ï¼Œéƒ½å¯ä»¥åœ¨ç¨‹åºçš„ç¼–è¯‘é˜¶æ®µè®¡ç®—å‡ºç»“æœã€‚ä½†åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œå¿…é¡»æ˜ç¡®ä½¿ç”¨ constexprï¼Œä¾‹å¦‚ï¼š #include \u003ciostream\u003e #include \u003carray\u003e using namespace std; constexpr int sqr1(int arg){ return arg*arg; } const int sqr2(int arg){ return arg*arg; } int main() { array\u003cint,sqr1(10)\u003e mylist1;//å¯ä»¥ï¼Œå› ä¸ºsqr1æ—¶constexprå‡½æ•° array\u003cint,sqr2(10)\u003e mylist1;//ä¸å¯ä»¥ï¼Œå› ä¸ºsqr2ä¸æ˜¯constexprå‡½æ•° return 0; } å…¶ä¸­ï¼Œå› ä¸º sqr2() å‡½æ•°çš„è¿”å›å€¼ä»…æœ‰ const ä¿®é¥°ï¼Œè€Œæ²¡æœ‰ç”¨æ›´æ˜ç¡®çš„ constexpr ä¿®é¥°ï¼Œå¯¼è‡´å…¶æ— æ³•ç”¨äºåˆå§‹åŒ– array å®¹å™¨ï¼ˆåªæœ‰å¸¸é‡æ‰èƒ½åˆå§‹åŒ– array å®¹å™¨ï¼‰ã€‚ æ€»çš„æ¥è¯´åœ¨ C++ 11 æ ‡å‡†ä¸­ï¼Œconst ç”¨äºä¸ºä¿®é¥°çš„å˜é‡æ·»åŠ â€œåªè¯»â€å±æ€§ï¼›è€Œ constexpr å…³é”®å­—åˆ™ç”¨äºæŒ‡æ˜å…¶åæ˜¯ä¸€ä¸ªå¸¸é‡ï¼ˆæˆ–è€…å¸¸é‡è¡¨è¾¾å¼ï¼‰ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘ç¨‹åºæ—¶å¯ä»¥é¡ºå¸¦å°†å…¶ç»“æœè®¡ç®—å‡ºæ¥ï¼Œè€Œæ— éœ€ç­‰åˆ°ç¨‹åºè¿è¡Œé˜¶æ®µï¼Œè¿™æ ·çš„ä¼˜åŒ–æå¤§åœ°æé«˜äº†ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:17","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] long longè¶…é•¿æ•´å½¢è¯¦è§£ C++ 11 æ ‡å‡†ä¸­ï¼ŒåŸºäºæ•´æ•°å¤§å°çš„è€ƒè™‘ï¼Œå…±æä¾›äº†å¦‚è¡¨ 1 æ‰€ç¤ºçš„è¿™äº›æ•°æ®ç±»å‹ã€‚ä¸æ­¤åŒæ—¶ï¼Œæ ‡å‡†ä¸­è¿˜æ˜ç¡®é™å®šäº†å„ä¸ªæ•°æ®ç±»å‹æœ€å°‘å ç”¨çš„ä½æ•°ã€‚ æ•´æ•°ç±»å‹ ç­‰ä»·ç±»å‹ C++11æ ‡å‡†è§„å®šå ç”¨æœ€å°‘ä½æ•° |short|short int(æœ‰ç¬¦å·çŸ­æ•´å‹)|è‡³å°‘ 16 ä½ï¼ˆ2 ä¸ªå­—èŠ‚ï¼‰| |signed short||| |signed short int||| |unsigned short|unsigned short intï¼ˆæ— ç¬¦å·çŸ­æ•´å‹ï¼‰|| |unsigned short int||| |int|int(æœ‰ç¬¦å·æ•´å½¢)|è‡³å°‘ 16 ä½ï¼ˆ2 ä¸ªå­—èŠ‚ï¼‰| |signed||| |signed int||| |unsigned|unsigned int(æ— ç¬¦å·æ•´å½¢)|| |unsigned int||| |long|long int(æœ‰ç¬¦å·é•¿æ•´å½¢)|è‡³å°‘ 32 ä½ï¼ˆ4 ä¸ªå­—èŠ‚ï¼‰| |long int||| |signed long||| |signed long int||| |unsigned long|unsigned long int(æ— ç¬¦å·é•¿æ•´å½¢)|| |unsigned long int||| |long long (C++11)|long long intï¼ˆæœ‰ç¬¦å·è¶…é•¿æ•´å½¢ï¼‰|è‡³å°‘ 64 ä½(8 ä¸ªå­—èŠ‚)| |long long int (C++11)||| |signed long long (C++11)||| |signed long long int (C++11)||| |unsigned long long (C++11)|unsigned long long intï¼ˆæ— ç¬¦å·è¶…é•¿æ•´å‹ï¼‰|| |unsigned long long int (C++11)||| C++11 æ ‡å‡†è§„å®šï¼Œæ¯ç§æ•´æ•°ç±»å‹å¿…é¡»åŒæ—¶å…·å¤‡æœ‰ç¬¦å·ï¼ˆsignedï¼‰å’Œæ— ç¬¦å·ï¼ˆunsignedï¼‰ä¸¤ç§ç±»å‹ï¼Œä¸”æ¯ç§å…·ä½“çš„æœ‰ç¬¦å·æ•´å½¢å’Œæ— ç¬¦å·æ•´å½¢æ‰€å ç”¨çš„å­˜å‚¨ç©ºé—´ï¼ˆä¹Ÿå°±æ˜¯ä½æ•°ï¼‰å¿…é¡»ç›¸åŒã€‚æ³¨æ„ï¼ŒC++11 æ ‡å‡†ä¸­åªé™å®šäº†æ¯ç§ç±»å‹æœ€å°‘å ç”¨å¤šå°‘å­˜å‚¨ç©ºé—´ï¼Œä¸åŒçš„å¹³å°å¯ä»¥å ç”¨ä¸åŒçš„å­˜å‚¨ç©ºé—´ã€‚ åœ¨è¡¨ 1 ç½—åˆ—çš„è¿™äº›æ•°æ®ç±»å‹ä¸­ï¼Œlong long è¶…é•¿æ•´å‹æ˜¯ C++ 11 æ ‡å‡†æ–°æ·»åŠ çš„ï¼Œæ¥ä¸‹æ¥å°±å¯¹è¯¥æ•´æ•°ç±»å‹åšå…·ä½“çš„ä»‹ç»ã€‚ è¯´é“ C++ æ ‡å‡†å§”å‘˜ä¼šå°† long long æ•´å½¢å†™å…¥ C++ 11 æ ‡å‡†ä¸­ï¼Œå…¶å®æ—©åœ¨ 1995 å¹´ï¼Œå°±æœ‰äººæè®®å°† long long æ•´å½¢å†™å…¥ C++ 98 æ ‡å‡†ï¼Œä½†è¢«å§”å‘˜ä¼šæ‹’ç»äº†ã€‚è€Œå long long æ•´å½¢è¢« C99 æ ‡å‡†ï¼ˆCè¯­è¨€æ ‡å‡†ä¹‹ä¸€ï¼‰é‡‡çº³ï¼Œå¹¶é€æ¸è¢«å¾ˆå¤šç¼–è¯‘å™¨æ”¯æŒï¼Œäºæ˜¯ C++ æ ‡å‡†å§”å‘˜ä¼šé‡æ–°å†³å®šå°† long long æ•´å½¢å†™å…¥ C++ 11 æ ‡å‡†ä¸­ã€‚ å¦‚åŒ long ç±»å‹æ•´æ•°éœ€æ˜ç¡®æ ‡æ³¨ â€œLâ€ æˆ–è€… â€œlâ€ åç¼€ä¸€æ ·ï¼Œè¦ä½¿ç”¨ long long ç±»å‹çš„æ•´æ•°ï¼Œä¹Ÿå¿…é¡»æ ‡æ³¨å¯¹åº”çš„åç¼€ï¼š å¯¹äºæœ‰ç¬¦å· long long æ•´å½¢ï¼Œåç¼€ç”¨ â€œLLâ€ æˆ–è€… â€œllâ€ æ ‡è¯†ã€‚ä¾‹å¦‚ï¼Œâ€œ10LLâ€ å°±è¡¨ç¤ºæœ‰ç¬¦å·è¶…é•¿æ•´æ•° 10ï¼› å¯¹äºæ— ç¬¦å· long long æ•´å½¢ï¼Œåç¼€ç”¨ â€œULLâ€ã€â€œullâ€ã€â€œUllâ€ æˆ–è€… â€œuLLâ€ æ ‡è¯†ã€‚ä¾‹å¦‚ï¼Œâ€œ10ULLâ€ å°±è¡¨ç¤ºæ— ç¬¦å·è¶…é•¿æ•´æ•° 10ï¼› å¦‚æœä¸æ·»åŠ ä»»ä½•æ ‡è¯†ï¼Œåˆ™æ‰€æœ‰çš„æ•´æ•°éƒ½ä¼šé»˜è®¤ä¸º int ç±»å‹ã€‚ å¯¹äºä»»æ„ä¸€ç§æ•°æ®ç±»å‹ï¼Œè¯»è€…å¯èƒ½æ›´å…³å¿ƒçš„æ˜¯æ­¤ç±»å‹çš„å–å€¼èŒƒå›´ã€‚å¯¹äº long long ç±»å‹æ¥è¯´ï¼Œå¦‚æœæƒ³äº†è§£å½“å‰å¹³å°ä¸Š long long æ•´å½¢çš„å–å€¼èŒƒå›´ï¼Œå¯ä»¥ä½¿ç”¨\u003cclimits\u003eå¤´æ–‡ä»¶ä¸­ä¸ long long æ•´å½¢ç›¸å…³çš„ 3 ä¸ªå®ï¼Œåˆ†åˆ«ä¸º LLONG_MINã€LLONG_MAX å’Œ ULLONG_MINï¼š 1.LLONG_MINï¼šä»£è¡¨å½“å‰å¹³å°ä¸Šæœ€å°çš„ long long ç±»å‹æ•´æ•°ï¼› 2.LLONG_MAXï¼šä»£è¡¨å½“å‰å¹³å°ä¸Šæœ€å¤§çš„ long long ç±»å‹æ•´æ•°ï¼› 3.ULLONG_MINï¼šä»£è¡¨å½“å‰å¹³å°ä¸Šæœ€å¤§çš„ unsigned long long ç±»å‹æ•´æ•°ï¼ˆæ— ç¬¦å·è¶…é•¿æ•´å‹çš„æœ€å°å€¼ä¸º 0ï¼‰ï¼› ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e #include \u003ciomanip\u003e #include \u003cclimits\u003e using namespace std; int main() { cout \u003c\u003c\"long longæœ€å¤§å€¼ï¼š\" \u003c\u003c LLONG_MIN \u003c\u003c\" \"\u003c\u003c hex \u003c\u003c LLONG_MIN \u003c\u003c\"\\n\"; cout \u003c\u003c dec \u003c\u003c\"long longæœ€å°å€¼ï¼š\" \u003c\u003c LLONG_MAX \u003c\u003c \" \" \u003c\u003c hex \u003c\u003c LLONG_MAX \u003c\u003c \"\\n\"; cout \u003c\u003c dec \u003c\u003c \"unsigned long longæœ€å¤§å€¼ï¼š\" \u003c\u003c ULLONG_MAX \u003c\u003c \" \" \u003c\u003c hex \u003c\u003c ULLONG_MAX; return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼ˆä¸å”¯ä¸€ï¼‰ï¼š long longæœ€å¤§å€¼ï¼š-9223372036854775808 8000000000000000 long longæœ€å°å€¼ï¼š9223372036854775807 7fffffffffffffff unsigned long longæœ€å¤§å€¼ï¼š18446744073709551615 ffffffffffffffff å…³äºæ•´å½¢åœ¨å†…å­˜ä¸­åˆ°åº•æ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Œè¯»è€…å¯é˜…è¯»ã€Šæ•´æ•°åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Œä¸ºä»€ä¹ˆå®ƒå ªç§°å¤©æ‰èˆ¬çš„è®¾è®¡ã€‹ä¸€èŠ‚ã€‚ æ­¤ç¨‹åºä¸­ï¼Œè¾“å‡ºäº†å„æœ€å¤§å€¼å’Œæœ€å°å€¼å¯¹åº”çš„åå…­è¿›åˆ¶ï¼Œæ˜¾ç„¶åœ¨å½“å‰å¹³å°ï¼ˆWindows10 64ä½æ“ä½œç³»ç»Ÿï¼‰ä¸Šï¼Œlong long è¶…é•¿æ•´å‹å ç”¨ 64 ä½ï¼ˆä¹Ÿå°±æ˜¯ 16 ä¸ªå­—èŠ‚ï¼‰çš„å­˜å‚¨ç©ºé—´ã€‚è¯»è€…å¯è‡ªè¡Œåœ¨è‡ªå·±çš„æœºå™¨ä¸Šè¿è¡Œæ­¤æ®µä»£ç ï¼Œå³å¯è½»æ¾å¾—çŸ¥ long long ç±»å‹åœ¨è‡ªå·±æœºå™¨ä¸Šæ‰€å ç”¨çš„å­—èŠ‚æ•°ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:18","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] C++11å³å€¼å¼•ç”¨ï¼ˆä¸€çœ‹å³æ‡‚ï¼‰ (ã€ŠC++11æ˜¯ä»€ä¹ˆã€‹)[http://c.biancheng.net/view/7751.html]ä¸€èŠ‚ä¸­æåˆ°ï¼Œåœ¨ C++98/03 æ ‡å‡†çš„åŸºç¡€ä¸Šï¼ŒC++11 æ ‡å‡†å¯¹ C++ è¯­è¨€å¢æ·»äº†çº¦ 140 ä¸ªæ–°ç‰¹æ€§ã€‚æœ¬èŠ‚è¦è®²çš„å³å€¼å¼•ç”¨å°±æ˜¯ä¼—å¤šæ–°ç‰¹æ€§ä¸­çš„ä¸€ä¸ªï¼ŒåŒæ—¶ä¹Ÿæ˜¯æœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ã€‚ å¾ˆå¤šåˆå­¦è€…éƒ½æ„Ÿè§‰å³å€¼å¼•ç”¨æ™¦æ¶©éš¾æ‡‚ï¼Œå…¶å®ä¸ç„¶ã€‚å³å€¼å¼•ç”¨åªä¸è¿‡æ˜¯ä¸€ç§æ–°çš„ C++ è¯­æ³•ï¼ŒçœŸæ­£ç†è§£èµ·æ¥æœ‰éš¾åº¦çš„æ˜¯åŸºäºå³å€¼å¼•ç”¨å¼•ç”³å‡ºçš„ 2 ç§ C++ ç¼–ç¨‹æŠ€å·§ï¼Œåˆ†åˆ«ä¸ºç§»åŠ¨è¯­ä¹‰å’Œå®Œç¾è½¬å‘ã€‚æœ¬èŠ‚å…ˆç»™è¯»è€…è®²è§£ä»€ä¹ˆæ˜¯å³å€¼å¼•ç”¨ä»¥åŠå®ƒçš„åŸºæœ¬ç”¨æ³•ï¼Œè‡³äºç§»åŠ¨è¯­ä¹‰å’Œå®Œç¾è½¬å‘åˆ™æ”¾åˆ°åç»­ç« èŠ‚è®²è§£ã€‚ åœ¨ C++ æˆ–è€… C è¯­è¨€ä¸­ï¼Œä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆå¯ä»¥æ˜¯å­—é¢é‡ã€å˜é‡ã€å¯¹è±¡ã€å‡½æ•°çš„è¿”å›å€¼ç­‰ï¼‰æ ¹æ®å…¶ä½¿ç”¨åœºæ™¯ä¸åŒï¼Œåˆ†ä¸ºå·¦å€¼è¡¨è¾¾å¼å’Œå³å€¼è¡¨è¾¾å¼ã€‚ç¡®åˆ‡çš„è¯´ C++ ä¸­å·¦å€¼å’Œå³å€¼çš„æ¦‚å¿µæ˜¯ä» C è¯­è¨€ç»§æ‰¿è¿‡æ¥çš„ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå·¦å€¼çš„è‹±æ–‡ç®€å†™ä¸ºâ€œlvalueâ€ï¼Œå³å€¼çš„è‹±æ–‡ç®€å†™ä¸ºâ€œrvalueâ€ã€‚å¾ˆå¤šäººè®¤ä¸ºå®ƒä»¬åˆ†åˆ«æ˜¯\"left valueâ€ã€â€œright valueâ€ çš„ç¼©å†™ï¼Œå…¶å®ä¸ç„¶ã€‚lvalue æ˜¯â€œloactor valueâ€çš„ç¼©å†™ï¼Œå¯æ„ä¸ºå­˜å‚¨åœ¨å†…å­˜ä¸­ã€æœ‰æ˜ç¡®å­˜å‚¨åœ°å€ï¼ˆå¯å¯»å€ï¼‰çš„æ•°æ®ï¼Œè€Œ rvalue è¯‘ä¸º â€œread valueâ€ï¼ŒæŒ‡çš„æ˜¯é‚£äº›å¯ä»¥æä¾›æ•°æ®å€¼çš„æ•°æ®ï¼ˆä¸ä¸€å®šå¯ä»¥å¯»å€ï¼Œä¾‹å¦‚å­˜å‚¨äºå¯„å­˜å™¨ä¸­çš„æ•°æ®ï¼‰ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ¤æ–­æŸä¸ªè¡¨è¾¾å¼æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œæœ€å¸¸ç”¨çš„æœ‰ä»¥ä¸‹ 2 ç§æ–¹æ³•ã€‚ å¯ä½äºèµ‹å€¼å·ï¼ˆ=ï¼‰å·¦ä¾§çš„è¡¨è¾¾å¼å°±æ˜¯å·¦å€¼ï¼›åä¹‹ï¼Œåªèƒ½ä½äºèµ‹å€¼å·å³ä¾§çš„è¡¨è¾¾å¼å°±æ˜¯å³å€¼ã€‚ä¸¾ä¸ªä¾‹å­: int a = 5; 5 = a; //é”™è¯¯ï¼Œ5 ä¸èƒ½ä¸ºå·¦å€¼ å…¶ä¸­ï¼Œå˜é‡ a å°±æ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œè€Œå­—é¢é‡ 5 å°±æ˜¯ä¸€ä¸ªå³å€¼ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒC++ ä¸­çš„å·¦å€¼ä¹Ÿå¯ä»¥å½“åšå³å€¼ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š int b = 10; // b æ˜¯ä¸€ä¸ªå·¦å€¼ a = b; // aã€b éƒ½æ˜¯å·¦å€¼ï¼Œåªä¸è¿‡å°† b å¯ä»¥å½“åšå³å€¼ä½¿ç”¨ æœ‰åç§°çš„ã€å¯ä»¥è·å–åˆ°å­˜å‚¨åœ°å€çš„è¡¨è¾¾å¼å³ä¸ºå·¦å€¼ï¼›åä¹‹åˆ™æ˜¯å³å€¼ã€‚ ä»¥ä¸Šé¢å®šä¹‰çš„å˜é‡ aã€b ä¸ºä¾‹ï¼Œa å’Œ b æ˜¯å˜é‡åï¼Œä¸”é€šè¿‡ \u0026a å’Œ \u0026b å¯ä»¥è·å¾—ä»–ä»¬çš„å­˜å‚¨åœ°å€ï¼Œå› æ­¤ a å’Œ b éƒ½æ˜¯å·¦å€¼ï¼›åä¹‹ï¼Œå­—é¢é‡ 5ã€10ï¼Œå®ƒä»¬æ—¢æ²¡æœ‰åç§°ï¼Œä¹Ÿæ— æ³•è·å–å…¶å­˜å‚¨åœ°å€ï¼ˆå­—é¢é‡é€šå¸¸å­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­ï¼Œæˆ–è€…å’Œä»£ç å­˜å‚¨åœ¨ä¸€èµ·ï¼‰ï¼Œå› æ­¤ 5ã€10 éƒ½æ˜¯å³å€¼ã€‚ æ³¨æ„ï¼Œä»¥ä¸Š 2 ç§åˆ¤å®šæ–¹æ³•åªé€‚ç”¨äºå¤§éƒ¨åˆ†åœºæ™¯ã€‚ç”±äºæœ¬èŠ‚ä¸»è¦è®²è§£å³å€¼å¼•ç”¨ï¼Œå› æ­¤è¿™é‡Œé€‚å¯è€Œæ­¢ï¼Œä¸å†å¯¹ C++ å·¦å€¼å’Œå³å€¼åšæ·±åº¦å‰–æï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯è‡ªè¡Œç ”ç©¶ã€‚ C++å³å€¼å¼•ç”¨ å‰é¢æåˆ°ï¼Œå…¶å® C++98/03 æ ‡å‡†ä¸­å°±æœ‰å¼•ç”¨ï¼Œä½¿ç”¨ â€œ\u0026â€ è¡¨ç¤ºã€‚ä½†æ­¤ç§å¼•ç”¨æ–¹å¼æœ‰ä¸€ä¸ªç¼ºé™·ï¼Œå³æ­£å¸¸æƒ…å†µä¸‹åªèƒ½æ“ä½œ C++ ä¸­çš„å·¦å€¼ï¼Œæ— æ³•å¯¹å³å€¼æ·»åŠ å¼•ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼š int num = 10; int \u0026b = num; //æ­£ç¡® int \u0026c = 10; //é”™è¯¯ å¦‚ä¸Šæ‰€ç¤ºï¼Œç¼–è¯‘å™¨å…è®¸æˆ‘ä»¬ä¸º num å·¦å€¼å»ºç«‹ä¸€ä¸ªå¼•ç”¨ï¼Œä½†ä¸å¯ä»¥ä¸º 10 è¿™ä¸ªå³å€¼å»ºç«‹å¼•ç”¨ã€‚å› æ­¤ï¼ŒC++98/03 æ ‡å‡†ä¸­çš„å¼•ç”¨åˆç§°ä¸ºå·¦å€¼å¼•ç”¨ã€‚ æ³¨æ„ï¼Œè™½ç„¶ C++98/03 æ ‡å‡†ä¸æ”¯æŒä¸ºå³å€¼å»ºç«‹éå¸¸é‡å·¦å€¼å¼•ç”¨ï¼Œä½†å…è®¸ä½¿ç”¨å¸¸é‡å·¦å€¼å¼•ç”¨æ“ä½œå³å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¸¸é‡å·¦å€¼å¼•ç”¨æ—¢å¯ä»¥æ“ä½œå·¦å€¼ï¼Œä¹Ÿå¯ä»¥æ“ä½œå³å€¼ï¼Œä¾‹å¦‚ï¼š int num = 10; const int \u0026b = num; const int \u0026c = 10; æˆ‘ä»¬çŸ¥é“ï¼Œå³å€¼å¾€å¾€æ˜¯æ²¡æœ‰åç§°çš„ï¼Œå› æ­¤è¦ä½¿ç”¨å®ƒåªèƒ½å€ŸåŠ©å¼•ç”¨çš„æ–¹å¼ã€‚è¿™å°±äº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œå®é™…å¼€å‘ä¸­æˆ‘ä»¬å¯èƒ½éœ€è¦å¯¹å³å€¼è¿›è¡Œä¿®æ”¹ï¼ˆå®ç°ç§»åŠ¨è¯­ä¹‰æ—¶å°±éœ€è¦ï¼‰ï¼Œæ˜¾ç„¶å·¦å€¼å¼•ç”¨çš„æ–¹å¼æ˜¯è¡Œä¸é€šçš„ã€‚ ä¸ºæ­¤ï¼ŒC++11 æ ‡å‡†æ–°å¼•å…¥äº†å¦ä¸€ç§å¼•ç”¨æ–¹å¼ï¼Œç§°ä¸ºå³å€¼å¼•ç”¨ï¼Œç”¨ â€œ\u0026\u0026â€ è¡¨ç¤ºã€‚ è¯è¯´ï¼ŒC++æ ‡å‡†å§”å‘˜ä¼šåœ¨é€‰å®šå³å€¼å¼•ç”¨ç¬¦å·æ—¶ï¼Œæ—¢å¸Œæœ›èƒ½é€‰ç”¨ç°æœ‰ C++ å†…éƒ¨å·²æœ‰çš„ç¬¦å·ï¼Œè¿˜ä¸èƒ½ä¸ C++ 98 /03 æ ‡å‡†äº§ç”Ÿå†²çªï¼Œæœ€ç»ˆé€‰å®šäº† 2 ä¸ª â€˜\u0026â€™ è¡¨ç¤ºå³å€¼å¼•ç”¨ã€‚ éœ€è¦æ³¨æ„çš„ï¼Œå’Œå£°æ˜å·¦å€¼å¼•ç”¨ä¸€æ ·ï¼Œå³å€¼å¼•ç”¨ä¹Ÿå¿…é¡»ç«‹å³è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œä¸”åªèƒ½ä½¿ç”¨å³å€¼è¿›è¡Œåˆå§‹åŒ–ï¼Œæ¯”å¦‚ï¼š int num = 10; const int \u0026b = num; const int \u0026c = 10; å’Œå¸¸é‡å·¦å€¼å¼•ç”¨ä¸åŒçš„æ˜¯ï¼Œå³å€¼å¼•ç”¨è¿˜å¯ä»¥å¯¹å³å€¼è¿›è¡Œä¿®æ”¹ã€‚ä¾‹å¦‚ï¼š int num = 10; //int \u0026\u0026 a = num; //å³å€¼å¼•ç”¨ä¸èƒ½åˆå§‹åŒ–ä¸ºå·¦å€¼ int \u0026\u0026 a = 10; ç¨‹åºè¾“å‡ºç»“æœä¸º 100ã€‚ å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒC++ è¯­æ³•ä¸Šæ˜¯æ”¯æŒå®šä¹‰å¸¸é‡å³å€¼å¼•ç”¨çš„ï¼Œä¾‹å¦‚ï¼š int \u0026\u0026 a = 10; a = 100; cout \u003c\u003c a \u003c\u003c endl; ä½†è¿™ç§å®šä¹‰å‡ºæ¥çš„å³å€¼å¼•ç”¨å¹¶æ— å®é™…ç”¨å¤„ã€‚ä¸€æ–¹é¢ï¼Œå³å€¼å¼•ç”¨ä¸»è¦ç”¨äºç§»åŠ¨è¯­ä¹‰å’Œå®Œç¾è½¬å‘ï¼Œå…¶ä¸­å‰è€…éœ€è¦æœ‰ä¿®æ”¹å³å€¼çš„æƒé™ï¼›å…¶æ¬¡ï¼Œå¸¸é‡å³å€¼å¼•ç”¨çš„ä½œç”¨å°±æ˜¯å¼•ç”¨ä¸€ä¸ªä¸å¯ä¿®æ”¹çš„å³å€¼ï¼Œè¿™é¡¹å·¥ä½œå®Œå…¨å¯ä»¥äº¤ç»™å¸¸é‡å·¦å€¼å¼•ç”¨å®Œæˆã€‚ å­¦åˆ°è¿™é‡Œï¼Œä¸€äº›è¯»è€…å¯èƒ½æ— æ³•è®°æ¸…æ¥šå·¦å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨å„è‡ªå¯ä»¥å¼•ç”¨å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œè¿™é‡Œç»™å¤§å®¶ä¸€å¼ è¡¨æ ¼ï¼Œæ–¹ä¾¿å¤§å®¶è®°å¿†ï¼š å¼•ç”¨ç±»å‹ å¯ä»¥å¼•ç”¨çš„å€¼ç±»å‹ ä½¿ç”¨åœºæ™¯ éå¸¸é‡å·¦å€¼ å¸¸é‡å·¦å€¼ éå¸¸é‡å³å€¼ å¸¸é‡å³å€¼ éå¸¸é‡å·¦å€¼å¼•ç”¨ Y N N N æ—  å¸¸é‡å·¦å€¼å¼•ç”¨ Y Y Y Y å¸¸ç”¨äºç±»ä¸­æ„å»ºæ‹·è´æ„é€ å‡½æ•° éå¸¸é‡å³å€¼å¼•ç”¨ N N Y N ç§»åŠ¨è¯­ä¹‰ã€å®Œç¾è½¬å‘ å¸¸é‡å³å€¼å¼•ç”¨ N N Y Y æ— å®é™…ç”¨é€” è¡¨ä¸­ï¼ŒY è¡¨ç¤ºæ”¯æŒï¼ŒN è¡¨ç¤ºä¸æ”¯æŒã€‚ å…¶å®ï¼ŒC++11 æ ‡å‡†ä¸­å¯¹å³å€¼åšäº†æ›´ç»†è‡´çš„åˆ’åˆ†ï¼Œåˆ†åˆ«ç§°ä¸ºçº¯å³å€¼ï¼ˆPure valueï¼Œç®€ç§° pvalueï¼‰å’Œå°†äº¡å€¼ï¼ˆeXpiring valueï¼Œç®€ç§° xvalue ï¼‰ã€‚å…¶ä¸­çº¯å³å€¼å°±æ˜¯ C++98/03 æ ‡å‡†ä¸­çš„å³å€¼ï¼ˆæœ¬èŠ‚ä¸­å·²ç»åšäº†å¤§ç¯‡å¹…çš„è®²è§£ï¼‰ï¼Œè€Œå°†äº¡å€¼åˆ™æŒ‡çš„æ˜¯å’Œå³å€¼å¼•ç”¨ç›¸å…³çš„è¡¨è¾¾å¼ï¼ˆæ¯”å¦‚æŸå‡½æ•°è¿”å›çš„ T \u0026\u0026 ç±»å‹çš„è¡¨è¾¾å¼ï¼‰ã€‚å¯¹äºçº¯å³å€¼å’Œå°†äº¡å€¼ï¼Œéƒ½å±äºå³å€¼ï¼Œè¯»è€…çŸ¥é“å³å¯ï¼Œä¸å¿…æ·±ç©¶ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:19","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] ç§»åŠ¨æ„é€ å‡½æ•°çš„åŠŸèƒ½å’Œç”¨æ³• ã€ŠC++11å³å€¼å¼•ç”¨ã€‹ä¸€èŠ‚ä¸­ï¼Œç»™è¯»è€…è¯¦ç»†ä»‹ç»äº† C++ å³å€¼å¼•ç”¨çš„å«ä¹‰å’Œç”¨æ³•ï¼ŒåŒæ—¶è¿˜æåˆ°â€œå³å€¼å¼•ç”¨ä¸»è¦ç”¨äºå®ç°ç§»åŠ¨ï¼ˆmoveï¼‰è¯­ä¹‰å’Œå®Œç¾è½¬å‘â€ã€‚æœ‰å…³å®Œç¾è½¬å‘ï¼Œåç»­ç« èŠ‚ä¼šåšè¯¦ç»†ä»‹ç»ï¼Œæœ¬èŠ‚ä¸»è¦è®²è§£ç§»åŠ¨è¯­ä¹‰çš„å«ä¹‰ä»¥åŠå®ç°å®ƒçš„æ–¹å¼ã€‚ C++11ç§»åŠ¨è¯­ä¹‰æ˜¯ä»€ä¹ˆ åœ¨ C++ 11 æ ‡å‡†ä¹‹å‰ï¼ˆC++ 98/03 æ ‡å‡†ä¸­ï¼‰ï¼Œå¦‚æœæƒ³ç”¨å…¶å®ƒå¯¹è±¡åˆå§‹åŒ–ä¸€ä¸ªåŒç±»çš„æ–°å¯¹è±¡ï¼Œåªèƒ½å€ŸåŠ©ç±»ä¸­çš„å¤åˆ¶ï¼ˆæ‹·è´ï¼‰æ„é€ å‡½æ•°ã€‚é€šè¿‡ã€ŠC++æ‹·è´æ„é€ å‡½æ•°ã€‹ä¸€èŠ‚çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“ï¼Œæ‹·è´æ„é€ å‡½æ•°çš„å®ç°åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸ºæ–°å¯¹è±¡å¤åˆ¶ä¸€ä»½å’Œå…¶å®ƒå¯¹è±¡ä¸€æ¨¡ä¸€æ ·çš„æ•°æ®ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ç±»ä¸­æ‹¥æœ‰æŒ‡é’ˆç±»å‹çš„æˆå‘˜å˜é‡æ—¶ï¼Œæ‹·è´æ„é€ å‡½æ•°ä¸­éœ€è¦ä»¥æ·±æ‹·è´ï¼ˆè€Œéæµ…æ‹·è´ï¼‰çš„æ–¹å¼å¤åˆ¶è¯¥æŒ‡é’ˆæˆå‘˜ã€‚æœ‰å…³æ·±æ‹·è´å’Œæµ…æ‹·è´ä»¥åŠå®ƒä»¬çš„åŒºåˆ«ï¼Œè¯»è€…å¯é˜…è¯»ã€ŠC++æ·±æ‹·è´å’Œæµ…æ‹·è´ã€‹ä¸€æ–‡åšè¯¦ç»†äº†è§£ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; class demo{ public: demo():num(new int(0)){ cout\u003c\u003c\"construct!\"\u003c\u003cendl; } //æ‹·è´æ„é€ å‡½æ•° demo(const demo \u0026d):num(new int(*d.num)){ cout\u003c\u003c\"copy construct!\"\u003c\u003cendl; } ~demo(){ cout\u003c\u003c\"class destruct!\"\u003c\u003cendl; } private: int *num; }; demo get_demo(){ return demo(); } int main(){ demo a = get_demo(); return 0; } å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬ä¸º demo ç±»è‡ªå®šä¹‰äº†ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ã€‚è¯¥å‡½æ•°åœ¨æ‹·è´ d.num æŒ‡é’ˆæˆå‘˜æ—¶ï¼Œå¿…é¡»é‡‡ç”¨æ·±æ‹·è´çš„æ–¹å¼ï¼Œå³æ‹·è´è¯¥æŒ‡é’ˆæˆå‘˜æœ¬èº«çš„åŒæ—¶ï¼Œè¿˜è¦æ‹·è´æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜èµ„æºã€‚å¦åˆ™ä¸€æ—¦å¤šä¸ªå¯¹è±¡ä¸­çš„æŒ‡é’ˆæˆå‘˜æŒ‡å‘åŒä¸€å—å †ç©ºé—´ï¼Œè¿™äº›å¯¹è±¡ææ„æ—¶å°±ä¼šå¯¹è¯¥ç©ºé—´é‡Šæ”¾å¤šæ¬¡ï¼Œè¿™æ˜¯ä¸å…è®¸çš„ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºä¸­å®šä¹‰äº†ä¸€ä¸ªå¯è¿”å› demo å¯¹è±¡çš„ get_demo() å‡½æ•°ï¼Œç”¨äºåœ¨ main() ä¸»å‡½æ•°ä¸­åˆå§‹åŒ– a å¯¹è±¡ï¼Œå…¶æ•´ä¸ªåˆå§‹åŒ–çš„æµç¨‹åŒ…å«ä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼š æ‰§è¡Œ get_demo() å‡½æ•°å†…éƒ¨çš„ demo() è¯­å¥ï¼Œå³è°ƒç”¨ demo ç±»çš„é»˜è®¤æ„é€ å‡½æ•°ç”Ÿæˆä¸€ä¸ªåŒ¿åå¯¹è±¡ï¼› æ‰§è¡Œ return demo() è¯­å¥ï¼Œä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°å¤åˆ¶ä¸€ä»½ä¹‹å‰ç”Ÿæˆçš„åŒ¿åå¯¹è±¡ï¼Œå¹¶å°†å…¶ä½œä¸º get_demo() å‡½æ•°çš„è¿”å›å€¼ï¼ˆå‡½æ•°ä½“æ‰§è¡Œå®Œæ¯•ä¹‹å‰ï¼ŒåŒ¿åå¯¹è±¡ä¼šè¢«ææ„é”€æ¯ï¼‰ï¼› æ‰§è¡Œ a = get_demo() è¯­å¥ï¼Œå†è°ƒç”¨ä¸€æ¬¡æ‹·è´æ„é€ å‡½æ•°ï¼Œå°†ä¹‹å‰æ‹·è´å¾—åˆ°çš„ä¸´æ—¶å¯¹è±¡å¤åˆ¶ç»™ aï¼ˆæ­¤è¡Œä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œget_demo() å‡½æ•°è¿”å›çš„å¯¹è±¡ä¼šè¢«ææ„ï¼‰ï¼› ç¨‹åºæ‰§è¡Œç»“æŸå‰ï¼Œä¼šè‡ªè¡Œè°ƒç”¨ demo ç±»çš„ææ„å‡½æ•°é”€æ¯ aã€‚ æ³¨æ„ï¼Œç›®å‰å¤šæ•°ç¼–è¯‘å™¨éƒ½ä¼šå¯¹ç¨‹åºä¸­å‘ç”Ÿçš„æ‹·è´æ“ä½œè¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬ä½¿ç”¨ VS 2017ã€codeblocks ç­‰è¿™äº›ç¼–è¯‘å™¨è¿è¡Œæ­¤ç¨‹åºæ—¶ï¼Œçœ‹åˆ°çš„å¾€å¾€æ˜¯ä¼˜åŒ–åçš„è¾“å‡ºç»“æœï¼š construct! class destruct! è€ŒåŒæ ·çš„ç¨‹åºï¼Œå¦‚æœåœ¨ Linux ä¸Šä½¿ç”¨g++ demo.cpp -fno-elide-constructorså‘½ä»¤è¿è¡Œï¼ˆå…¶ä¸­ demo.cpp æ˜¯ç¨‹åºæ–‡ä»¶çš„åç§°ï¼‰ï¼Œå°±å¯ä»¥çœ‹åˆ°å®Œæ•´çš„è¾“å‡ºç»“æœï¼š construct! \u003c-- æ‰§è¡Œ demo() copy construct! \u003c-- æ‰§è¡Œ return demo() class destruct! \u003c-- é”€æ¯ demo() äº§ç”Ÿçš„åŒ¿åå¯¹è±¡ copy construct! \u003c-- æ‰§è¡Œ a = get_demo() class destruct! \u003c-- é”€æ¯ get_demo() è¿”å›çš„ä¸´æ—¶å¯¹è±¡ class destruct! \u003c-- é”€æ¯ a å¦‚ä¸Šæ‰€ç¤ºï¼Œåˆ©ç”¨æ‹·è´æ„é€ å‡½æ•°å®ç°å¯¹ a å¯¹è±¡çš„åˆå§‹åŒ–ï¼Œåº•å±‚å®é™…ä¸Šè¿›è¡Œäº† 2 æ¬¡æ‹·è´ï¼ˆè€Œä¸”æ˜¯æ·±æ‹·è´ï¼‰æ“ä½œã€‚å½“ç„¶ï¼Œå¯¹äºä»…ç”³è¯·å°‘é‡å †ç©ºé—´çš„ä¸´æ—¶å¯¹è±¡æ¥è¯´ï¼Œæ·±æ‹·è´çš„æ‰§è¡Œæ•ˆç‡ä¾æ—§å¯ä»¥æ¥å—ï¼Œä½†å¦‚æœä¸´æ—¶å¯¹è±¡ä¸­çš„æŒ‡é’ˆæˆå‘˜ç”³è¯·äº†å¤§é‡çš„å †ç©ºé—´ï¼Œé‚£ä¹ˆ 2 æ¬¡æ·±æ‹·è´æ“ä½œåŠ¿å¿…ä¼šå½±å“ a å¯¹è±¡åˆå§‹åŒ–çš„æ‰§è¡Œæ•ˆç‡ã€‚ äº‹å®ä¸Šï¼Œæ­¤é—®é¢˜ä¸€ç›´å­˜ç•™åœ¨ä»¥ C++ 98/03 æ ‡å‡†ç¼–å†™çš„ C++ ç¨‹åºä¸­ã€‚ç”±äºä¸´æ—¶å˜é‡çš„äº§ç”Ÿã€é”€æ¯ä»¥åŠå‘ç”Ÿçš„æ‹·è´æ“ä½œæœ¬èº«å°±æ˜¯å¾ˆéšæ™¦çš„ï¼ˆç¼–è¯‘å™¨å¯¹è¿™äº›è¿‡ç¨‹åšäº†ä¸“é—¨çš„ä¼˜åŒ–ï¼‰ï¼Œä¸”å¹¶ä¸ä¼šå½±å“ç¨‹åºçš„æ­£ç¡®æ€§ï¼Œå› æ­¤å¾ˆå°‘è¿›å…¥ç¨‹åºå‘˜çš„è§†é‡ã€‚ é‚£ä¹ˆå½“ç±»ä¸­åŒ…å«æŒ‡é’ˆç±»å‹çš„æˆå‘˜å˜é‡ï¼Œä½¿ç”¨å…¶å®ƒå¯¹è±¡æ¥åˆå§‹åŒ–åŒç±»å¯¹è±¡æ—¶ï¼Œæ€æ ·æ‰èƒ½é¿å…æ·±æ‹·è´å¯¼è‡´çš„æ•ˆç‡é—®é¢˜å‘¢ï¼ŸC++11 æ ‡å‡†å¼•å…¥äº†è§£å†³æ–¹æ¡ˆï¼Œè¯¥æ ‡å‡†ä¸­å¼•å…¥äº†å³å€¼å¼•ç”¨çš„è¯­æ³•ï¼Œå€ŸåŠ©å®ƒå¯ä»¥å®ç°ç§»åŠ¨è¯­ä¹‰ã€‚ C++ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆç§»åŠ¨è¯­ä¹‰çš„å…·ä½“å®ç°ï¼‰ æ‰€è°“ç§»åŠ¨è¯­ä¹‰ï¼ŒæŒ‡çš„å°±æ˜¯ä»¥ç§»åŠ¨è€Œéæ·±æ‹·è´çš„æ–¹å¼åˆå§‹åŒ–å«æœ‰æŒ‡é’ˆæˆå‘˜çš„ç±»å¯¹è±¡ã€‚ç®€å•çš„ç†è§£ï¼Œç§»åŠ¨è¯­ä¹‰æŒ‡çš„å°±æ˜¯å°†å…¶ä»–å¯¹è±¡ï¼ˆé€šå¸¸æ˜¯ä¸´æ—¶å¯¹è±¡ï¼‰æ‹¥æœ‰çš„å†…å­˜èµ„æºâ€œç§»ä¸ºå·²ç”¨â€ã€‚ ä»¥å‰é¢ç¨‹åºä¸­çš„ demo ç±»ä¸ºä¾‹ï¼Œè¯¥ç±»çš„æˆå‘˜éƒ½åŒ…å«ä¸€ä¸ªæ•´å½¢çš„æŒ‡é’ˆæˆå‘˜ï¼Œå…¶é»˜è®¤æŒ‡å‘çš„æ˜¯å®¹çº³ä¸€ä¸ªæ•´å½¢å˜é‡çš„å †ç©ºé—´ã€‚å½“ä½¿ç”¨ get_demo() å‡½æ•°è¿”å›çš„ä¸´æ—¶å¯¹è±¡åˆå§‹åŒ– a æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å°†ä¸´æ—¶å¯¹è±¡çš„ num æŒ‡é’ˆç›´æ¥æµ…æ‹·è´ç»™ a.numï¼Œç„¶åä¿®æ”¹è¯¥ä¸´æ—¶å¯¹è±¡ä¸­ num æŒ‡é’ˆçš„æŒ‡å‘ï¼ˆé€šå¸¸å¦å…¶æŒ‡å‘ NULLï¼‰ï¼Œè¿™æ ·å°±å®Œæˆäº† a.num çš„åˆå§‹åŒ–ã€‚ äº‹å®ä¸Šï¼Œå¯¹äºç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸´æ—¶å¯¹è±¡ï¼Œå¾€å¾€åªç”¨äºä¼ é€’æ•°æ®ï¼ˆæ²¡æœ‰å…¶å®ƒçš„ç”¨å¤„ï¼‰ï¼Œå¹¶ä¸”ä¼šå¾ˆå¿«ä¼šè¢«é”€æ¯ã€‚å› æ­¤åœ¨ä½¿ç”¨ä¸´æ—¶å¯¹è±¡åˆå§‹åŒ–æ–°å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åŒ…å«çš„æŒ‡é’ˆæˆå‘˜æŒ‡å‘çš„å†…å­˜èµ„æºç›´æ¥ç§»ç»™æ–°å¯¹è±¡æ‰€æœ‰ï¼Œæ— éœ€å†æ–°æ‹·è´ä¸€ä»½ï¼Œè¿™å¤§å¤§æé«˜äº†åˆå§‹åŒ–çš„æ‰§è¡Œæ•ˆç‡ã€‚ ä¾‹å¦‚ï¼Œä¸‹é¢ç¨‹åºå¯¹ demo ç±»è¿›è¡Œäº†ä¿®æ”¹ï¼š #include \u003ciostream\u003e using namespace std; class demo{ public: demo():num(new int(0)){ cout\u003c\u003c\"construct!\"\u003c\u003cendl; } demo(const demo \u0026d):num(new int(*d.num)){ cout\u003c\u003c\"copy construct!\"\u003c\u003cendl; } //æ·»åŠ ç§»åŠ¨æ„é€ å‡½æ•° demo(demo \u0026\u0026d):num(d.num){ d.num = NULL; cout\u003c\u003c\"move construct!\"\u003c\u003cendl; } ~demo(){ cout\u003c\u003c\"class destruct!\"\u003c\u003cendl; } private: int *num; }; demo get_demo(){ return demo(); } int main(){ demo a = get_demo(); return 0; } å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¹‹å‰ demo ç±»çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬åˆæ‰‹åŠ¨ä¸ºå…¶æ·»åŠ äº†ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚å’Œå…¶å®ƒæ„é€ å‡½æ•°ä¸åŒï¼Œæ­¤æ„é€ å‡½æ•°ä½¿ç”¨å³å€¼å¼•ç”¨å½¢å¼çš„å‚æ•°ï¼Œåˆç§°ä¸ºç§»åŠ¨æ„é€ å‡½æ•°ã€‚å¹¶ä¸”åœ¨æ­¤æ„é€ å‡½æ•°ä¸­ï¼Œnum æŒ‡é’ˆå˜é‡é‡‡ç”¨çš„æ˜¯æµ…æ‹·è´çš„å¤åˆ¶æ–¹å¼ï¼ŒåŒæ—¶åœ¨å‡½æ•°å†…éƒ¨é‡ç½®äº† d.numï¼Œæœ‰æ•ˆé¿å…äº†â€œåŒä¸€å—å¯¹ç©ºé—´è¢«é‡Šæ”¾å¤šæ¬¡â€æƒ…å†µçš„å‘ç”Ÿã€‚ åœ¨ Linux ç³»ç»Ÿä¸­ä½¿ç”¨g++ demo.cpp -o demo.exe -std=c++0x -fno-elide-constructorså‘½ä»¤æ‰§è¡Œæ­¤ç¨‹åºï¼Œè¾“å‡ºç»“æœä¸ºï¼š construct! move construct! class destruct! move construct! class destruct! class destruct! é€šè¿‡æ‰§è¡Œç»“æœæˆ‘ä»¬ä¸éš¾å¾—çŸ¥ï¼Œå½“ä¸º demo ç±»æ·»åŠ ç§»åŠ¨æ„é€ å‡½æ•°ä¹‹åï¼Œä½¿ç”¨ä¸´æ—¶å¯¹è±¡åˆå§‹åŒ– a å¯¹è±¡è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ 2 æ¬¡æ‹·è´æ“ä½œï¼Œéƒ½è½¬ç”±ç§»åŠ¨æ„é€ å‡½æ•°å®Œæˆã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œé const å³å€¼å¼•ç”¨åªèƒ½æ“ä½œå³å€¼ï¼Œç¨‹åºæ‰§è¡Œç»“æœä¸­äº§ç”Ÿçš„ä¸´æ—¶å¯¹è±¡ï¼ˆä¾‹å¦‚å‡½æ•°è¿”å›å€¼ã€lambda è¡¨è¾¾å¼ç­‰ï¼‰æ—¢æ— åç§°ä¹Ÿæ— æ³•è·å–å…¶å­˜å‚¨åœ°å€ï¼Œæ‰€ä»¥å±äºå³å€¼ã€‚å½“ç±»ä¸­åŒæ—¶åŒ…å«æ‹·è´æ„é€ å‡½æ•°å’Œç§»åŠ¨æ„é€ å‡½æ•°æ—¶ï¼Œå¦‚æœä½¿ç”¨ä¸´æ—¶å¯¹è±¡åˆå§‹åŒ–å½“å‰ç±»çš„å¯¹è±¡ï¼Œç¼–è¯‘å™¨ä¼šä¼˜å…ˆè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°æ¥å®Œæˆæ­¤æ“ä½œã€‚åªæœ‰å½“ç±»ä¸­æ²¡æœ‰åˆé€‚çš„ç§»åŠ¨æ„é€ å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨æ‰ä¼šé€€è€Œæ±‚å…¶æ¬¡ï¼Œè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚ åœ¨å®é™…å¼€å‘ä¸­ï¼Œé€šå¸¸åœ¨ç±»ä¸­è‡ªå®šä¹‰ç§»åŠ¨æ„é€ å‡½æ•°çš„åŒæ—¶ï¼Œä¼šå†ä¸ºå…¶è‡ªå®šä¹‰ä¸€ä¸ªé€‚å½“çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œç”±æ­¤å½“ç”¨æˆ·åˆ©ç”¨å³å€¼åˆå§‹åŒ–ç±»å¯¹è±¡æ—¶ï¼Œä¼šè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼›ä½¿ç”¨å·¦å€¼ï¼ˆéå³å€¼ï¼‰åˆå§‹åŒ–ç±»å¯¹è±¡æ—¶ï¼Œä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚ è¯»è€…å¯èƒ½ä¼šé—®ï¼Œå¦‚æœä½¿ç”¨å·¦å€¼åˆå§‹åŒ–åŒç±»å¯¹è±¡ï¼Œä½†ä¹Ÿæƒ³è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°å®Œæˆï¼Œæœ‰æ²¡æœ‰åŠæ³•å¯ä»¥å®ç°å‘¢ï¼Ÿ é»˜è®¤æƒ…å†µä¸‹ï¼Œå·¦å€¼åˆå§‹åŒ–åŒç±»å¯¹è±¡åªèƒ½é€šè¿‡æ‹·è´æ„é€ å‡½æ•°å®Œæˆï¼Œå¦‚æœæƒ³è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œåˆ™å¿…é¡»ä½¿ç”¨å³å€¼è¿›è¡Œåˆå§‹åŒ–ã€‚C++11 æ ‡å‡†ä¸­ä¸ºäº†æ»¡è¶³ç”¨æˆ·ä½¿ç”¨å·¦å€¼åˆå§‹åŒ–åŒç±»å¯¹è±¡æ—¶ä¹Ÿé€šè¿‡ç§»åŠ¨æ„é€ å‡½æ•°å®Œæˆçš„éœ€æ±‚ï¼Œæ–°å¼•å…¥äº† std::move() å‡½æ•°ï¼Œå®ƒå¯ä»¥å°†å·¦å€¼å¼ºåˆ¶è½¬æ¢æˆå¯¹åº”çš„å³å€¼ï¼Œç”±æ­¤ä¾¿å¯ä»¥ä½¿ç”¨ç§»åŠ¨æ„é€ å‡½æ•°ã€‚ æœ‰å…³ std::move() å‡½æ•°çš„ç”¨æ³•ï¼Œåç»­ç« èŠ‚ä¼šåšè¯¦ç»†è®²è§£ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:20","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] move()å‡½æ•°ï¼šå°†å·¦å€¼å¼ºåˆ¶è½¬æ¢ä¸ºå³å€¼ é€šè¿‡å­¦ä¹  ã€ŠC++11ç§»åŠ¨æ„é€ å‡½æ•°ã€‹ä¸€èŠ‚æˆ‘ä»¬çŸ¥é“ï¼ŒC++11 æ ‡å‡†ä¸­å€ŸåŠ©å³å€¼å¼•ç”¨å¯ä»¥ä¸ºæŒ‡å®šç±»æ·»åŠ ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œè¿™æ ·å½“ä½¿ç”¨è¯¥ç±»çš„å³å€¼å¯¹è±¡ï¼ˆå¯ä»¥ç†è§£ä¸ºä¸´æ—¶å¯¹è±¡ï¼‰åˆå§‹åŒ–åŒç±»å¯¹è±¡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šä¼˜å…ˆé€‰æ‹©ç§»åŠ¨æ„é€ å‡½æ•°ã€‚ æ³¨æ„ï¼Œç§»åŠ¨æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœºæ˜¯ï¼šç”¨åŒç±»çš„å³å€¼å¯¹è±¡åˆå§‹åŒ–æ–°å¯¹è±¡ã€‚é‚£ä¹ˆï¼Œç”¨å½“å‰ç±»çš„å·¦å€¼å¯¹è±¡ï¼ˆæœ‰åç§°ï¼Œèƒ½è·å–å…¶å­˜å‚¨åœ°å€çš„å®ä¾‹å¯¹è±¡ï¼‰åˆå§‹åŒ–åŒç±»å¯¹è±¡æ—¶ï¼Œæ˜¯å¦å°±æ— æ³•è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°äº†å‘¢ï¼Ÿå½“ç„¶ä¸æ˜¯ï¼ŒC++11 æ ‡å‡†ä¸­å·²ç»ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼Œå³è°ƒç”¨ move() å‡½æ•°ã€‚ move æœ¬æ„ä¸º â€œç§»åŠ¨â€ï¼Œä½†è¯¥å‡½æ•°å¹¶ä¸èƒ½ç§»åŠ¨ä»»ä½•æ•°æ®ï¼Œå®ƒçš„åŠŸèƒ½å¾ˆç®€å•ï¼Œå°±æ˜¯å°†æŸä¸ªå·¦å€¼å¼ºåˆ¶è½¬åŒ–ä¸ºå³å€¼ã€‚ åŸºäº move() å‡½æ•°ç‰¹æ®Šçš„åŠŸèƒ½ï¼Œå…¶å¸¸ç”¨äºå®ç°ç§»åŠ¨è¯­ä¹‰ã€‚ move() å‡½æ•°çš„ç”¨æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå…¶è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š move(arg) å…¶ä¸­ï¼Œarg è¡¨ç¤ºæŒ‡å®šçš„å·¦å€¼å¯¹è±¡ã€‚è¯¥å‡½æ•°ä¼šè¿”å› arg å¯¹è±¡çš„å³å€¼å½¢å¼ã€‚ ã€ä¾‹ 1ã€‘move() å‡½æ•°çš„åŸºç¡€åº”ç”¨ã€‚ #include \u003ciostream\u003e using namespace std; class movedemo{ public: movedemo():num(new int(0)){ cout\u003c\u003c\"construct!\"\u003c\u003cendl; } //æ‹·è´æ„é€ å‡½æ•° movedemo(const movedemo \u0026d):num(new int(*d.num)){ cout\u003c\u003c\"copy construct!\"\u003c\u003cendl; } //ç§»åŠ¨æ„é€ å‡½æ•° movedemo(movedemo \u0026\u0026d):num(d.num){ d.num = NULL; cout\u003c\u003c\"move construct!\"\u003c\u003cendl; } public: //è¿™é‡Œåº”è¯¥æ˜¯ privateï¼Œä½¿ç”¨ public æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿è¯´æ˜é—®é¢˜ int *num; }; int main(){ movedemo demo; cout \u003c\u003c \"demo2:\\n\"; movedemo demo2 = demo; //cout \u003c\u003c *demo2.num \u003c\u003c endl; //å¯ä»¥æ‰§è¡Œ cout \u003c\u003c \"demo3:\\n\"; movedemo demo3 = std::move(demo); //æ­¤æ—¶ demo.num = NULLï¼Œå› æ­¤ä¸‹é¢ä»£ç ä¼šæŠ¥è¿è¡Œæ—¶é”™è¯¯ //cout \u003c\u003c *demo.num \u003c\u003c endl; return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š construct! demo2: copy construct! demo3: move construct! é€šè¿‡è§‚å¯Ÿç¨‹åºçš„è¾“å‡ºç»“æœï¼Œä»¥åŠå¯¹æ¯” demo2 å’Œ demo3 åˆå§‹åŒ–æ“ä½œä¸éš¾å¾—çŸ¥ï¼Œdemo å¯¹è±¡ä½œä¸ºå·¦å€¼ï¼Œç›´æ¥ç”¨äºåˆå§‹åŒ– demo2 å¯¹è±¡ï¼Œå…¶åº•å±‚è°ƒç”¨çš„æ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼›è€Œé€šè¿‡è°ƒç”¨ move() å‡½æ•°å¯ä»¥å¾—åˆ° demo å¯¹è±¡çš„å³å€¼å½¢å¼ï¼Œç”¨å…¶åˆå§‹åŒ– demo3 å¯¹è±¡ï¼Œç¼–è¯‘å™¨ä¼šä¼˜å…ˆè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ã€‚ æ³¨æ„ï¼Œè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œå¹¶ä¸å½±å“ demo å¯¹è±¡ï¼Œä½†å¦‚æœè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œç”±äºå‡½æ•°å†…éƒ¨ä¼šé‡ç½® demo.num æŒ‡é’ˆçš„æŒ‡å‘ä¸º NULLï¼Œæ‰€ä»¥ç¨‹åºä¸­ç¬¬ 30 è¡Œä»£ç ä¼šå¯¼è‡´ç¨‹åºè¿è¡Œæ—¶å‘ç”Ÿé”™è¯¯ã€‚ ã€ä¾‹ 2ã€‘çµæ´»ä½¿ç”¨ move() å‡½æ•°ã€‚ #include \u003ciostream\u003e using namespace std; class first { public: first() :num(new int(0)) { cout \u003c\u003c \"construct!\" \u003c\u003c endl; } //ç§»åŠ¨æ„é€ å‡½æ•° first(first \u0026\u0026d) :num(d.num) { d.num = NULL; cout \u003c\u003c \"first move construct!\" \u003c\u003c endl; } public: //è¿™é‡Œåº”è¯¥æ˜¯ privateï¼Œä½¿ç”¨ public æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿è¯´æ˜é—®é¢˜ int *num; }; class second { public: second() :fir() {} //ç”¨ first ç±»çš„ç§»åŠ¨æ„é€ å‡½æ•°åˆå§‹åŒ– fir second(second \u0026\u0026 sec) :fir(move(sec.fir)) { cout \u003c\u003c \"second move construct\" \u003c\u003c endl; } public: //è¿™é‡Œä¹Ÿåº”è¯¥æ˜¯ privateï¼Œä½¿ç”¨ public æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿è¯´æ˜é—®é¢˜ first fir; }; int main() { second oth; second oth2 = move(oth); //cout \u003c\u003c *oth.fir.num \u003c\u003c endl; //ç¨‹åºæŠ¥è¿è¡Œæ—¶é”™è¯¯ return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š construct! first move construct! second move construct ç¨‹åºä¸­åˆ†åˆ«æ„å»ºäº† first å’Œ second è¿™ 2 ä¸ªç±»ï¼Œå…¶ä¸­ second ç±»ä¸­åŒ…å«ä¸€ä¸ª first ç±»å¯¹è±¡ã€‚å¦‚æœè¯»è€…ä»”ç»†è§‚å¯Ÿä¸éš¾å‘ç°ï¼Œç¨‹åºä¸­ä½¿ç”¨äº† 2 æ­¤ move() å‡½æ•°ï¼š ç¨‹åºç¬¬ 31 è¡Œï¼šç”±äº oth ä¸ºå·¦å€¼ï¼Œå¦‚æœæƒ³è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ä¸º oth2 åˆå§‹åŒ–ï¼Œéœ€å…ˆåˆ©ç”¨ move() å‡½æ•°ç”Ÿæˆä¸€ä¸ª oth çš„å³å€¼ç‰ˆæœ¬ï¼› ç¨‹åºç¬¬ 22 è¡Œï¼šoth å¯¹è±¡å†…éƒ¨è¿˜åŒ…å«ä¸€ä¸ª first ç±»å¯¹è±¡ï¼Œå¯¹äº oth.fir æ¥è¯´ï¼Œå…¶ä¹Ÿæ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œæ‰€ä»¥åœ¨åˆå§‹åŒ– oth.fir æ—¶ï¼Œè¿˜éœ€è¦å†è°ƒç”¨ä¸€æ¬¡ move() å‡½æ•°ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:21","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] å¼•ç”¨é™å®šç¬¦çš„ç”¨æ³• åœ¨ã€ŠC++å³å€¼å¼•ç”¨ã€‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ç»™æ‚¨ä»‹ç»äº†å·¦å€¼å’Œå³å€¼ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå·¦å€¼å’Œå³å€¼çš„åŒºåˆ†ä¹ŸåŒæ ·é€‚ç”¨äºç±»å¯¹è±¡ï¼Œæœ¬èŠ‚ä¸­å°†å·¦å€¼çš„ç±»å¯¹è±¡ç§°ä¸ºå·¦å€¼å¯¹è±¡ï¼Œå°†å³å€¼çš„ç±»å¯¹è±¡ç§°ä¸ºå³å€¼å¯¹è±¡ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹äºç±»ä¸­ç”¨ public ä¿®é¥°çš„æˆå‘˜å‡½æ•°ï¼Œæ—¢å¯ä»¥è¢«å·¦å€¼å¯¹è±¡è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è¢«å³å€¼å¯¹è±¡è°ƒç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; class demo { public: demo(int num):num(num){} int get_num(){ return this-\u003enum; } private: int num; }; int main() { demo a(10); cout \u003c\u003c a.get_num() \u003c\u003c endl; cout \u003c\u003c move(a).get_num() \u003c\u003c endl; return 0; } å¯ä»¥çœ‹åˆ°ï¼Œdemo ç±»ä¸­çš„ get_num() æˆå‘˜å‡½æ•°æ—¢å¯ä»¥è¢« a å·¦å€¼å¯¹è±¡è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è¢« move(a) ç”Ÿæˆçš„å³å€¼ demo å¯¹è±¡è°ƒç”¨ï¼Œè¿è¡Œç¨‹åºä¼šè¾“å‡ºä¸¤ä¸ª 10ã€‚ æŸäº›åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦é™åˆ¶è°ƒç”¨æˆå‘˜å‡½æ•°çš„å¯¹è±¡çš„ç±»å‹ï¼ˆå·¦å€¼è¿˜æ˜¯å³å€¼ï¼‰ï¼Œä¸ºæ­¤ C++11 æ–°æ·»åŠ äº†å¼•ç”¨é™å®šç¬¦ã€‚æ‰€è°“å¼•ç”¨é™å®šç¬¦ï¼Œå°±æ˜¯åœ¨æˆå‘˜å‡½æ•°çš„åé¢æ·»åŠ  â€œ\u0026â€ æˆ–è€… â€œ\u0026\u0026â€ï¼Œä»è€Œé™åˆ¶è°ƒç”¨è€…çš„ç±»å‹ï¼ˆå·¦å€¼è¿˜æ˜¯å³å€¼ï¼‰ã€‚ ä¿®æ”¹ä¸Šé¢ç¨‹åºï¼š #include \u003ciostream\u003e using namespace std; class demo { public: demo(int num):num(num){} int get_num()\u0026{ return this-\u003enum; } private: int num; }; int main() { demo a(10); cout \u003c\u003c a.get_num() \u003c\u003c endl; // æ­£ç¡® //cout \u003c\u003c move(a).get_num() \u003c\u003c endl; // é”™è¯¯ return 0; } å’Œä¹‹å‰çš„ç¨‹åºç›¸æ¯”ï¼Œæˆ‘ä»¬ä»…åœ¨ get_num() æˆå‘˜å‡½æ•°çš„åé¢æ·»åŠ äº† â€œ\u0026â€ï¼Œå®ƒå¯ä»¥é™å®šè°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡å¿…é¡»æ˜¯å·¦å€¼å¯¹è±¡ã€‚å› æ­¤ç¬¬ 16 è¡Œä»£ç ä¸­ï¼Œmove(a) ç”Ÿæˆçš„å³å€¼å¯¹è±¡æ˜¯ä¸å…è®¸è°ƒç”¨ get_num() å‡½æ•°çš„ã€‚ åŒç†ï¼Œæˆ‘ä»¬å†æ¬¡ä¿®æ”¹ç¨‹åºï¼š #include \u003ciostream\u003e using namespace std; class demo { public: demo(int num):num(num){} int get_num()\u0026\u0026{ return this-\u003enum; } private: int num; }; int main() { demo a(10); //cout \u003c\u003c a.get_num() \u003c\u003c endl; // é”™è¯¯ cout \u003c\u003c move(a).get_num() \u003c\u003c endl; // æ­£ç¡® return 0; } å’Œå…ˆå‰ç¨‹åºä¸åŒçš„æ˜¯ï¼Œget_num() å‡½æ•°åæ ¹æœ‰ â€œ\u0026\u0026â€ é™å®šç¬¦ï¼Œå®ƒå¯ä»¥é™å®šè°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡å¿…é¡»æ˜¯ä¸€ä¸ªå³å€¼å¯¹è±¡ã€‚ æ³¨æ„ï¼Œå¼•ç”¨é™å®šç¬¦ä¸é€‚ç”¨äºé™æ€æˆå‘˜å‡½æ•°å’Œå‹å…ƒå‡½æ•°ã€‚ constå’Œå¼•ç”¨é™å®šç¬¦ æˆ‘ä»¬çŸ¥é“ï¼Œconst ä¹Ÿå¯ä»¥ç”¨äºä¿®é¥°ç±»çš„æˆå‘˜å‡½æ•°ï¼Œæˆ‘ä»¬ä¹ æƒ¯ç§°ä¸ºå¸¸æˆå‘˜å‡½æ•°ï¼Œä¾‹å¦‚ï¼š class demo{ public: int get_num() const; } è¿™é‡Œçš„ get_num() å°±æ˜¯ä¸€ä¸ªå¸¸æˆå‘˜å‡½æ•°ã€‚ const å’Œå¼•ç”¨é™å®šç¬¦ä¿®é¥°ç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œéƒ½ä½äºå‡½æ•°çš„æœ«å°¾ã€‚C++11 æ ‡å‡†è§„å®šï¼Œå½“å¼•ç”¨é™å®šç¬¦å’Œ const ä¿®é¥°åŒä¸€ä¸ªç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œconst å¿…é¡»ä½äºå¼•ç”¨é™å®šç¬¦å‰é¢ã€‚ éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå½“ const \u0026\u0026 ä¿®é¥°ç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œè°ƒç”¨å®ƒçš„å¯¹è±¡åªèƒ½æ˜¯å³å€¼å¯¹è±¡ï¼›å½“ const \u0026 ä¿®é¥°ç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œè°ƒç”¨å®ƒçš„å¯¹è±¡æ—¢å¯ä»¥æ˜¯å·¦å€¼å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯å³å€¼å¯¹è±¡ã€‚æ— è®ºæ˜¯ const \u0026\u0026 è¿˜æ˜¯ const \u0026 é™å®šçš„æˆå‘˜å‡½æ•°ï¼Œå†…éƒ¨éƒ½ä¸å…è®¸å¯¹å½“å‰å¯¹è±¡åšä¿®æ”¹æ“ä½œã€‚ ä¸¾ä¸ªä¾‹å­ï¼š #include \u003ciostream\u003e using namespace std; class demo { public: demo(int num,int num2) :num(num),num2(num2) {} //å·¦å€¼å’Œå³å€¼å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨ int get_num() const \u0026{ return this-\u003enum; } //ä»…ä¾›å³å€¼å¯¹è±¡è°ƒç”¨ int get_num2() const \u0026\u0026 { return this-\u003enum2; } private: int num; int num2; }; int main() { demo a(10,20); cout \u003c\u003c a.get_num() \u003c\u003c endl; // æ­£ç¡® cout \u003c\u003c move(a).get_num() \u003c\u003c endl; // æ­£ç¡® //cout \u003c\u003c a.get_num2() \u003c\u003c endl; // é”™è¯¯ cout \u003c\u003c move(a).get_num2() \u003c\u003c endl; // æ­£ç¡® return 0; } ","date":"2023-07-12","objectID":"/posts/newfeature/:1:22","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] å®Œç¾è½¬å‘åŠå…¶å®ç° C++11 æ ‡å‡†ä¸º C++ å¼•å…¥å³å€¼å¼•ç”¨è¯­æ³•çš„åŒæ—¶ï¼Œè¿˜è§£å†³äº†ä¸€ä¸ª C++ 98/03 æ ‡å‡†é•¿æœŸå­˜åœ¨çš„çŸ­æ¿ï¼Œå³ä½¿ç”¨ç®€å•çš„æ–¹å¼å³å¯åœ¨å‡½æ•°æ¨¡æ¿ä¸­å®ç°å‚æ•°çš„å®Œç¾è½¬å‘ã€‚é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯å®Œç¾è½¬å‘ï¼Ÿå®ƒä¸ºä»€ä¹ˆæ˜¯ C++98/03 æ ‡å‡†å­˜åœ¨çš„ä¸€ä¸ªçŸ­æ¿ï¼ŸC++11 æ ‡å‡†åˆæ˜¯å¦‚ä½•ä¸º C++ å¼¥è¡¥è¿™ä¸€çŸ­æ¿çš„ï¼Ÿåˆ«æ€¥ï¼Œæœ¬èŠ‚å°†å°±è¿™äº›é—®é¢˜ç»™è¯»è€…åšä¸€ä¸€è®²è§£ã€‚ é¦–å…ˆè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯å®Œç¾è½¬å‘ï¼Œå®ƒæŒ‡çš„æ˜¯å‡½æ•°æ¨¡æ¿å¯ä»¥å°†è‡ªå·±çš„å‚æ•°â€œå®Œç¾â€åœ°è½¬å‘ç»™å†…éƒ¨è°ƒç”¨çš„å…¶å®ƒå‡½æ•°ã€‚æ‰€è°“å®Œç¾ï¼Œå³ä¸ä»…èƒ½å‡†ç¡®åœ°è½¬å‘å‚æ•°çš„å€¼ï¼Œè¿˜èƒ½ä¿è¯è¢«è½¬å‘å‚æ•°çš„å·¦ã€å³å€¼å±æ€§ä¸å˜ã€‚ åœ¨ C++ ä¸­ï¼Œä¸€ä¸ªè¡¨è¾¾å¼ä¸æ˜¯å·¦å€¼å°±æ˜¯å³å€¼ã€‚æœ‰å…³å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œå¯é˜…è¯»ã€ŠC++å³å€¼å¼•ç”¨ã€‹ä¸€æ–‡åšè¯¦ç»†äº†è§£ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š template\u003ctypename T\u003e void function(T t) { otherdef(t); } å¦‚ä¸Šæ‰€ç¤ºï¼Œfunction() å‡½æ•°æ¨¡æ¿ä¸­è°ƒç”¨äº† otherdef() å‡½æ•°ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå®Œç¾è½¬å‘æŒ‡çš„æ˜¯ï¼šå¦‚æœ function() å‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•° t ä¸ºå·¦å€¼ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°ä¼ é€’ç»™ otherdef() çš„å‚æ•° t ä¹Ÿæ˜¯å·¦å€¼ï¼›åä¹‹å¦‚æœ function() å‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•° t ä¸ºå³å€¼ï¼Œé‚£ä¹ˆä¼ é€’ç»™ otherdef() å‡½æ•°çš„å‚æ•° t ä¹Ÿå¿…é¡»ä¸ºå³å€¼ã€‚ æ˜¾ç„¶ï¼Œfunction() å‡½æ•°æ¨¡æ¿å¹¶æ²¡æœ‰å®ç°å®Œç¾è½¬å‘ã€‚ä¸€æ–¹é¢ï¼Œå‚æ•° t ä¸ºéå¼•ç”¨ç±»å‹ï¼Œè¿™æ„å‘³ç€åœ¨è°ƒç”¨ function() å‡½æ•°æ—¶ï¼Œå®å‚å°†å€¼ä¼ é€’ç»™å½¢å‚çš„è¿‡ç¨‹å°±éœ€è¦é¢å¤–è¿›è¡Œä¸€æ¬¡æ‹·è´æ“ä½œï¼›å¦ä¸€æ–¹é¢ï¼Œæ— è®ºè°ƒç”¨ function() å‡½æ•°æ¨¡æ¿æ—¶ä¼ é€’ç»™å‚æ•° t çš„æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œå¯¹äºå‡½æ•°å†…éƒ¨çš„å‚æ•° t æ¥è¯´ï¼Œå®ƒæœ‰è‡ªå·±çš„åç§°ï¼Œä¹Ÿå¯ä»¥è·å–å®ƒçš„å­˜å‚¨åœ°å€ï¼Œå› æ­¤å®ƒæ°¸è¿œéƒ½æ˜¯å·¦å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¼ é€’ç»™ otherdef() å‡½æ•°çš„å‚æ•° t æ°¸è¿œéƒ½æ˜¯å·¦å€¼ã€‚æ€»ä¹‹ï¼Œæ— è®ºä»é‚£ä¸ªè§’åº¦çœ‹ï¼Œfunction() å‡½æ•°çš„å®šä¹‰éƒ½ä¸â€œå®Œç¾â€ã€‚ è¯»è€…å¯èƒ½ä¼šé—®ï¼Œå®Œç¾è½¬å‘è¿™æ ·ä¸¥è‹›çš„å‚æ•°ä¼ é€’æœºåˆ¶ï¼Œå¾ˆå¸¸ç”¨å—ï¼ŸC++98/03 æ ‡å‡†ä¸­å‡ ä¹ä¸ä¼šç”¨åˆ°ï¼Œä½† C++11 æ ‡å‡†ä¸º C++ å¼•å…¥äº†å³å€¼å¼•ç”¨å’Œç§»åŠ¨è¯­ä¹‰ï¼Œå› æ­¤å¾ˆå¤šåœºæ™¯ä¸­æ˜¯å¦å®ç°å®Œç¾è½¬å‘ï¼Œç›´æ¥å†³å®šäº†è¯¥å‚æ•°çš„ä¼ é€’è¿‡ç¨‹ä½¿ç”¨çš„æ˜¯æ‹·è´è¯­ä¹‰ï¼ˆè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼‰è¿˜æ˜¯ç§»åŠ¨è¯­ä¹‰ï¼ˆè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼‰ã€‚ äº‹å®ä¸Šï¼ŒC++98/03 æ ‡å‡†ä¸‹çš„ C++ ä¹Ÿå¯ä»¥å®ç°å®Œç¾è½¬å‘ï¼Œåªæ˜¯å®ç°æ–¹å¼æ¯”è¾ƒç¬¨æ‹™ã€‚é€šè¿‡å‰é¢çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“ï¼ŒC++ 98/03 æ ‡å‡†ä¸­åªæœ‰å·¦å€¼å¼•ç”¨ï¼Œå¹¶ä¸”å¯ä»¥ç»†åˆ†ä¸ºé const å¼•ç”¨å’Œ const å¼•ç”¨ã€‚å…¶ä¸­ï¼Œä½¿ç”¨é const å¼•ç”¨ä½œä¸ºå‡½æ•°æ¨¡æ¿å‚æ•°æ—¶ï¼Œåªèƒ½æ¥æ”¶å·¦å€¼ï¼Œæ— æ³•æ¥æ”¶å³å€¼ï¼›è€Œ const å·¦å€¼å¼•ç”¨æ—¢å¯ä»¥æ¥æ”¶å·¦å€¼ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å³å€¼ï¼Œä½†è€ƒè™‘åˆ°å…¶ const å±æ€§ï¼Œé™¤éè¢«è°ƒç”¨å‡½æ•°çš„å‚æ•°ä¹Ÿæ˜¯ const å±æ€§ï¼Œå¦åˆ™å°†æ— æ³•ç›´æ¥ä¼ é€’ã€‚ è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œå•ç‹¬ä½¿ç”¨ä»»ä½•ä¸€ç§å¼•ç”¨å½¢å¼ï¼Œå¯ä»¥å®ç°è½¬å‘ï¼Œä½†æ— æ³•ä¿è¯å®Œç¾ã€‚å› æ­¤å¦‚æœä½¿ç”¨ C++ 98/03 æ ‡å‡†ä¸‹çš„ C++ è¯­è¨€ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å‡½æ•°æ¨¡æ¿é‡è½½çš„æ–¹å¼å®ç°å®Œç¾è½¬å‘ï¼Œä¾‹å¦‚ï¼š #include \u003ciostream\u003e using namespace std; //é‡è½½è¢«è°ƒç”¨å‡½æ•°ï¼ŒæŸ¥çœ‹å®Œç¾è½¬å‘çš„æ•ˆæœ void otherdef(int \u0026 t) { cout \u003c\u003c \"lvalue\\n\"; } void otherdef(const int \u0026 t) { cout \u003c\u003c \"rvalue\\n\"; } //é‡è½½å‡½æ•°æ¨¡æ¿ï¼Œåˆ†åˆ«æ¥æ”¶å·¦å€¼å’Œå³å€¼ //æ¥æ”¶å³å€¼å‚æ•° template \u003ctypename T\u003e void function(const T\u0026 t) { otherdef(t); } //æ¥æ”¶å·¦å€¼å‚æ•° template \u003ctypename T\u003e void function(T\u0026 t) { otherdef(t); } int main() { function(5);//5 æ˜¯å³å€¼ int x = 1; function(x);//x æ˜¯å·¦å€¼ return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š rvalue lvalue ä»è¾“å‡ºç»“æœä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºå³å€¼ 5 æ¥è¯´ï¼Œå®ƒå®é™…è°ƒç”¨çš„å‚æ•°ç±»å‹ä¸º const T\u0026 çš„å‡½æ•°æ¨¡æ¿ï¼Œç”±äº t ä¸º const ç±»å‹ï¼Œæ‰€ä»¥ otherdef() å‡½æ•°å®é™…è°ƒç”¨çš„ä¹Ÿæ˜¯å‚æ•°ç”¨ const ä¿®é¥°çš„å‡½æ•°ï¼Œæ‰€ä»¥è¾“å‡ºâ€œrvalueâ€ï¼›å¯¹äºå·¦å€¼ x æ¥è¯´ï¼Œ2 ä¸ªé‡è½½æ¨¡æ¿å‡½æ•°éƒ½é€‚ç”¨ï¼ŒC++ç¼–è¯‘å™¨ä¼šé€‰æ‹©æœ€é€‚åˆçš„å‚æ•°ç±»å‹ä¸º T\u0026 çš„å‡½æ•°æ¨¡æ¿ï¼Œè¿›è€Œ therdef() å‡½æ•°å®é™…è°ƒç”¨çš„æ˜¯å‚æ•°ç±»å‹ä¸ºé const çš„å‡½æ•°ï¼Œè¾“å‡ºâ€œlvalueâ€ã€‚ æ˜¾ç„¶ï¼Œä½¿ç”¨é‡è½½çš„æ¨¡æ¿å‡½æ•°å®ç°å®Œç¾è½¬å‘ä¹Ÿæ˜¯æœ‰å¼Šç«¯çš„ï¼Œæ­¤å®ç°æ–¹å¼ä»…é€‚ç”¨äºæ¨¡æ¿å‡½æ•°ä»…æœ‰å°‘é‡å‚æ•°çš„æƒ…å†µï¼Œå¦åˆ™å°±éœ€è¦ç¼–å†™å¤§é‡çš„é‡è½½å‡½æ•°æ¨¡æ¿ï¼Œé€ æˆä»£ç çš„å†—ä½™ã€‚ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·æ›´å¿«é€Ÿåœ°å®ç°å®Œç¾è½¬å‘ï¼ŒC++ 11 æ ‡å‡†ä¸­å…è®¸åœ¨å‡½æ•°æ¨¡æ¿ä¸­ä½¿ç”¨å³å€¼å¼•ç”¨æ¥å®ç°å®Œç¾è½¬å‘ã€‚ C++11 æ ‡å‡†ä¸­è§„å®šï¼Œé€šå¸¸æƒ…å†µä¸‹å³å€¼å¼•ç”¨å½¢å¼çš„å‚æ•°åªèƒ½æ¥æ”¶å³å€¼ï¼Œä¸èƒ½æ¥æ”¶å·¦å€¼ã€‚ä½†å¯¹äºå‡½æ•°æ¨¡æ¿ä¸­ä½¿ç”¨å³å€¼å¼•ç”¨è¯­æ³•å®šä¹‰çš„å‚æ•°æ¥è¯´ï¼Œå®ƒä¸å†éµå®ˆè¿™ä¸€è§„å®šï¼Œæ—¢å¯ä»¥æ¥æ”¶å³å€¼ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å·¦å€¼ï¼ˆæ­¤æ—¶çš„å³å€¼å¼•ç”¨åˆè¢«ç§°ä¸ºâ€œä¸‡èƒ½å¼•ç”¨â€ï¼‰ã€‚ ä»ä»¥ function() å‡½æ•°ä¸ºä¾‹ï¼Œåœ¨ C++11 æ ‡å‡†ä¸­å®ç°å®Œç¾è½¬å‘ï¼Œåªéœ€è¦ç¼–å†™å¦‚ä¸‹ä¸€ä¸ªæ¨¡æ¿å‡½æ•°å³å¯ï¼š template \u003ctypename T\u003e void function(T\u0026\u0026 t) { otherdef(t); } æ­¤æ¨¡æ¿å‡½æ•°çš„å‚æ•° t æ—¢å¯ä»¥æ¥æ”¶å·¦å€¼ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å³å€¼ã€‚ä½†ä»…ä»…ä½¿ç”¨å³å€¼å¼•ç”¨ä½œä¸ºå‡½æ•°æ¨¡æ¿çš„å‚æ•°æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ç»§ç»­è§£å†³ï¼Œå³å¦‚æœè°ƒç”¨ function() å‡½æ•°æ—¶ä¸ºå…¶ä¼ é€’ä¸€ä¸ªå·¦å€¼å¼•ç”¨æˆ–è€…å³å€¼å¼•ç”¨çš„å®å‚ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š int n = 10; int \u0026 num = n; function(num); // T ä¸º int\u0026 int \u0026\u0026 num2 = 11; function(num2); // T ä¸º int \u0026\u0026 å…¶ä¸­ï¼Œç”± function(num) å®ä¾‹åŒ–çš„å‡½æ•°åº•å±‚å°±å˜æˆäº† function(int \u0026 \u0026 t)ï¼ŒåŒæ ·ç”± function(num2) å®ä¾‹åŒ–çš„å‡½æ•°åº•å±‚åˆ™å˜æˆäº† function(int \u0026\u0026 \u0026\u0026 t)ã€‚è¦çŸ¥é“ï¼ŒC++98/03 æ ‡å‡†æ˜¯ä¸æ”¯æŒè¿™ç§ç”¨æ³•çš„ï¼Œè€Œ C++ 11æ ‡å‡†ä¸ºäº†æ›´å¥½åœ°å®ç°å®Œç¾è½¬å‘ï¼Œç‰¹æ„ä¸ºå…¶æŒ‡å®šäº†æ–°çš„ç±»å‹åŒ¹é…è§„åˆ™ï¼Œåˆç§°ä¸ºå¼•ç”¨æŠ˜å è§„åˆ™ï¼ˆå‡è®¾ç”¨ A è¡¨ç¤ºå®é™…ä¼ é€’å‚æ•°çš„ç±»å‹ï¼‰ï¼š å½“å®å‚ä¸ºå·¦å€¼æˆ–è€…å·¦å€¼å¼•ç”¨ï¼ˆA\u0026ï¼‰æ—¶ï¼Œå‡½æ•°æ¨¡æ¿ä¸­ T\u0026\u0026 å°†è½¬å˜ä¸º A\u0026ï¼ˆA\u0026 \u0026\u0026 = A\u0026ï¼‰ï¼› å½“å®å‚ä¸ºå³å€¼æˆ–è€…å³å€¼å¼•ç”¨ï¼ˆA\u0026\u0026ï¼‰æ—¶ï¼Œå‡½æ•°æ¨¡æ¿ä¸­ T\u0026\u0026 å°†è½¬å˜ä¸º A\u0026\u0026ï¼ˆA\u0026\u0026 \u0026\u0026 = A\u0026\u0026ï¼‰ã€‚ è¯»è€…åªéœ€è¦çŸ¥é“ï¼Œåœ¨å®ç°å®Œç¾è½¬å‘æ—¶ï¼Œåªè¦å‡½æ•°æ¨¡æ¿çš„å‚æ•°ç±»å‹ä¸º T\u0026\u0026ï¼Œåˆ™ C++ å¯ä»¥è‡ªè¡Œå‡†ç¡®åœ°åˆ¤å®šå‡ºå®é™…ä¼ å…¥çš„å®å‚æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ã€‚ é€šè¿‡å°†å‡½æ•°æ¨¡æ¿çš„å½¢å‚ç±»å‹è®¾ç½®ä¸º T\u0026\u0026ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¥½åœ°è§£å†³æ¥æ”¶å·¦ã€å³å€¼çš„é—®é¢˜ã€‚ä½†é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œå³æ— è®ºä¼ å…¥çš„å½¢å‚æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œå¯¹äºå‡½æ•°æ¨¡æ¿å†…éƒ¨æ¥è¯´ï¼Œå½¢å‚æ—¢æœ‰åç§°åˆèƒ½å¯»å€ï¼Œå› æ­¤å®ƒéƒ½æ˜¯å·¦å€¼ã€‚é‚£ä¹ˆå¦‚ä½•æ‰èƒ½å°†å‡½æ•°æ¨¡æ¿æ¥æ”¶åˆ°çš„å½¢å‚è¿åŒå…¶å·¦ã€å³å€¼å±æ€§ï¼Œä¸€èµ·ä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°å‘¢ï¼Ÿ C++11 æ ‡å‡†çš„å¼€å‘è€…å·²ç»å¸®æˆ‘ä»¬æƒ³å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œè¯¥æ–°æ ‡å‡†è¿˜å¼•å…¥äº†ä¸€ä¸ªæ¨¡æ¿å‡½æ•° forword()ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨è¯¥å‡½æ•°ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§£å†³æ­¤é—®é¢˜ã€‚ä»ä»¥ function æ¨¡æ¿å‡½æ•°ä¸ºä¾‹ï¼Œå¦‚ä¸‹æ¼”ç¤ºäº†è¯¥å‡½æ•°æ¨¡æ¿çš„ç”¨æ³•ï¼š #include \u003ciostream\u003e using namespace std; //é‡è½½è¢«è°ƒç”¨å‡½æ•°ï¼ŒæŸ¥çœ‹å®Œç¾è½¬å‘çš„æ•ˆæœ void otherdef(int \u0026 t) { cout \u003c\u003c \"lvalue\\n\"; } void otherdef(const int \u0026 t) { cout \u003c\u003c \"rvalue\\n\"; } //å®ç°å®Œç¾è½¬å‘çš„å‡½æ•°æ¨¡æ¿ template \u003ctypename T\u003e void function(T\u0026\u0026 t) { otherdef(forward\u003cT\u003e(t)); } int main() { function(5); int x = 1; function(x); return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š rvalue lvalue æ³¨æ„ç¨‹åºä¸­ç¬¬ 12~16 è¡Œï¼Œæ­¤ function() æ¨¡æ¿å‡½æ•°æ‰æ˜¯å®ç°å®Œç¾è½¬å‘çš„æœ€ç»ˆç‰ˆæœ¬ã€‚å¯ä»¥çœ‹åˆ°ï¼Œforword() å‡½æ•°æ¨¡æ¿ç”¨äºä¿®é¥°è¢«è°ƒç”¨å‡½æ•°ä¸­éœ€è¦ç»´æŒå‚æ•°å·¦ã€å³å€¼å±æ€§çš„å‚æ•°ã€‚ æ€»çš„æ¥è¯´ï¼Œåœ¨å®šä¹‰æ¨¡æ¿å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬é‡‡ç”¨å³å€¼å¼•ç”¨çš„è¯­æ³•æ ¼å¼å®šä¹‰å‚æ•°ç±»å‹ï¼Œç”±æ­¤è¯¥å‡½æ•°æ—¢å¯ä»¥æ¥æ”¶å¤–ç•Œä¼ å…¥çš„å·¦å€¼ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å³å€¼ï¼›å…¶æ¬¡ï¼Œè¿˜éœ€è¦ä½¿ç”¨ C++11 æ ‡å‡†åº“æä¾›çš„ forword() æ¨¡æ¿å‡½æ•°ä¿®é¥°è¢«è°ƒç”¨å‡½æ•°ä¸­éœ€è¦ç»´æŒå·¦ã€å³å€¼å±æ€§çš„å‚æ•°ã€‚ç”±æ­¤å³å¯è½»æ¾å®ç°å‡½æ•°æ¨¡æ¿ä¸­å‚æ•°çš„å®Œç¾è½¬å‘ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:23","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] nullptrï¼šåˆå§‹åŒ–ç©ºæŒ‡é’ˆ å®é™…å¼€å‘ä¸­ï¼Œé¿å…äº§ç”Ÿâ€œé‡æŒ‡é’ˆâ€æœ€æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨å®šä¹‰æŒ‡é’ˆçš„åŒæ—¶å®Œæˆåˆå§‹åŒ–æ“ä½œï¼Œå³ä¾¿è¯¥æŒ‡é’ˆçš„æŒ‡å‘å°šæœªæ˜ç¡®ï¼Œä¹Ÿè¦å°†å…¶åˆå§‹åŒ–ä¸ºç©ºæŒ‡é’ˆã€‚ æ‰€è°“â€œé‡æŒ‡é’ˆâ€ï¼Œåˆç§°â€œæ‚¬æŒ‚æŒ‡é’ˆâ€ï¼ŒæŒ‡çš„æ˜¯æ²¡æœ‰æ˜ç¡®æŒ‡å‘çš„æŒ‡é’ˆã€‚é‡æŒ‡é’ˆå¾€å¾€æŒ‡å‘çš„æ˜¯é‚£äº›ä¸å¯ç”¨çš„å†…å­˜åŒºåŸŸï¼Œè¿™å°±æ„å‘³ç€åƒæ“ä½œæ™®é€šæŒ‡é’ˆé‚£æ ·ä½¿ç”¨é‡æŒ‡é’ˆï¼ˆä¾‹å¦‚ \u0026pï¼‰ï¼Œæå¯èƒ½å¯¼è‡´ç¨‹åºå‘ç”Ÿå¼‚å¸¸ã€‚ C++98/03 æ ‡å‡†ä¸­ï¼Œå°†ä¸€ä¸ªæŒ‡é’ˆåˆå§‹åŒ–ä¸ºç©ºæŒ‡é’ˆçš„æ–¹å¼æœ‰ 2 ç§ï¼š int *p = 0; int *p = NULL; //æ¨èä½¿ç”¨ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŒ‡é’ˆæ˜ç¡®æŒ‡å‘ 0ï¼ˆ0x0000 0000ï¼‰è¿™ä¸ªå†…å­˜ç©ºé—´ã€‚ä¸€æ–¹é¢ï¼Œæ˜ç¡®æŒ‡é’ˆçš„æŒ‡å‘å¯ä»¥é¿å…å…¶æˆä¸ºé‡æŒ‡é’ˆï¼›å¦ä¸€æ–¹é¢ï¼Œå¤§å¤šæ•°æ“ä½œç³»ç»Ÿéƒ½ä¸å…è®¸ç”¨æˆ·å¯¹åœ°å€ä¸º 0 çš„å†…å­˜ç©ºé—´æ‰§è¡Œå†™æ“ä½œï¼Œè‹¥ç”¨æˆ·åœ¨ç¨‹åºä¸­å°è¯•ä¿®æ”¹å…¶å†…å®¹ï¼Œåˆ™ç¨‹åºè¿è¡Œä¼šç›´æ¥æŠ¥é”™ã€‚ ç›¸æ¯”ç¬¬ä¸€ç§æ–¹å¼ï¼Œæˆ‘ä»¬æ›´ä¹ æƒ¯å°†æŒ‡é’ˆåˆå§‹åŒ–ä¸º NULLã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒNULL å¹¶ä¸æ˜¯ C++ çš„å…³é”®å­—ï¼Œå®ƒæ˜¯ C++ ä¸ºæˆ‘ä»¬äº‹å…ˆå®šä¹‰å¥½çš„ä¸€ä¸ªå®ï¼Œå¹¶ä¸”å®ƒçš„å€¼å¾€å¾€å°±æ˜¯å­—é¢é‡ 0ï¼ˆ#define NULL 0ï¼‰ã€‚ C++ ä¸­å°† NULL å®šä¹‰ä¸ºå­—é¢å¸¸é‡ 0ï¼Œè™½ç„¶èƒ½æ»¡è¶³å¤§éƒ¨åˆ†åœºæ™¯çš„éœ€è¦ï¼Œä½†ä¸ªåˆ«æƒ…å†µä¸‹ï¼Œå®ƒä¼šå¯¼è‡´ç¨‹åºçš„è¿è¡Œå’Œæˆ‘ä»¬çš„é¢„æœŸä¸ç¬¦ã€‚ä¾‹å¦‚ï¼š #include \u003ciostream\u003e using namespace std; void isnull(void *c){ cout \u003c\u003c \"void*c\" \u003c\u003c endl; } void isnull(int n){ cout \u003c\u003c \"int n\" \u003c\u003c endl; } int main() { isnull(0); isnull(NULL); return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š int n int n å¯¹äº isnull(0) æ¥è¯´ï¼Œæ˜¾ç„¶å®ƒçœŸæ­£è°ƒç”¨çš„æ˜¯å‚æ•°ä¸ºæ•´å½¢çš„ isnull() å‡½æ•°ï¼›è€Œå¯¹äº isnull(NULL)ï¼Œæˆ‘ä»¬æœŸæœ›å®ƒå®é™…è°ƒç”¨çš„æ˜¯å‚æ•°ä¸º void*c çš„ isnull() å‡½æ•°ï¼Œä½†è§‚å¯Ÿç¨‹åºçš„æ‰§è¡Œç»“æœä¸éš¾çœ‹å‡ºï¼Œå¹¶ä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚ C++ 98/03 æ ‡å‡†ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä»¤ isnull(NULL) å®é™…è°ƒç”¨çš„æ˜¯ isnull(void* c)ï¼Œå°±éœ€è¦å¯¹ NULLï¼ˆæˆ–è€… 0ï¼‰è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼š isnull( (void*)NULL ); isnull( (void*)0 ); å¦‚æ­¤ï¼Œæ‰ä¼šæˆåŠŸè°ƒç”¨æˆ‘ä»¬é¢„æœŸçš„å‡½æ•°ï¼ˆè¯»è€…å¯è‡ªè¡Œæ‰§è¡Œæ­¤ä»£ç ï¼Œè§‚å¯Ÿè¾“å‡ºç»“æœï¼‰ã€‚ ç”±äº C++ 98 æ ‡å‡†ä½¿ç”¨æœŸé—´ï¼ŒNULL å·²ç»å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œå‡ºäºå…¼å®¹æ€§çš„è€ƒè™‘ï¼ŒC++11 æ ‡å‡†å¹¶æ²¡æœ‰å¯¹ NULL çš„å®å®šä¹‰åšä»»ä½•ä¿®æ”¹ã€‚ä¸ºäº†ä¿®æ­£ C++ å­˜åœ¨çš„è¿™ä¸€ BUGï¼ŒC++ æ ‡å‡†å§”å‘˜ä¼šæœ€ç»ˆå†³å®šå¦å…¶ç‚‰ç¶ï¼Œåœ¨ C++11 æ ‡å‡†ä¸­å¼•å…¥ä¸€ä¸ªæ–°å…³é”®å­—ï¼Œå³ nullptrã€‚ åœ¨ä½¿ç”¨ nullptr ä¹‹å‰ï¼Œè¯»è€…éœ€ä¿è¯è‡ªå·±ä½¿ç”¨çš„ç¼–è¯‘å™¨æ”¯æŒè¯¥å…³é”®å­—ã€‚ä»¥ Visual Studio å’Œ codeblocks ä¸ºä¾‹ï¼Œå‰è€…æ—©åœ¨ 2010 ç‰ˆæœ¬å°±å¯¹ C++ 11 æ ‡å‡†ä¸­çš„éƒ¨åˆ†ç‰¹æ€§æä¾›äº†æ”¯æŒï¼Œå…¶ä¸­å°±åŒ…æ‹¬ nullptrï¼›å¦‚æœä½¿ç”¨åè€…ï¼Œè¯»è€…éœ€å°†å…¶ G++ ç¼–è¯‘å™¨ç‰ˆæœ¬è‡³å°‘å‡çº§è‡³ 4.6.1ï¼ˆåŒæ—¶å¼€å¯ -std=c++0x ç¼–è¯‘é€‰é¡¹ï¼‰ã€‚ nullptr æ˜¯ nullptr_t ç±»å‹çš„å³å€¼å¸¸é‡ï¼Œä¸“ç”¨äºåˆå§‹åŒ–ç©ºç±»å‹æŒ‡é’ˆã€‚nullptr_t æ˜¯ C++11 æ–°å¢åŠ çš„æ•°æ®ç±»å‹ï¼Œå¯ç§°ä¸ºâ€œæŒ‡é’ˆç©ºå€¼ç±»å‹â€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œnullpter ä»…æ˜¯è¯¥ç±»å‹çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆå·²ç»å®šä¹‰å¥½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼‰ï¼Œå¦‚æœéœ€è¦æˆ‘ä»¬å®Œå…¨å®šä¹‰å‡ºå¤šä¸ªåŒ nullptr å®Œå…¨ä¸€æ ·çš„å®ä¾‹å¯¹è±¡ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œnullptr å¯ä»¥è¢«éšå¼è½¬æ¢æˆä»»æ„çš„æŒ‡é’ˆç±»å‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼š int * a1 = nullptr; char * a2 = nullptr; double * a3 = nullptr; æ˜¾ç„¶ï¼Œä¸åŒç±»å‹çš„æŒ‡é’ˆå˜é‡éƒ½å¯ä»¥ä½¿ç”¨ nullptr æ¥åˆå§‹åŒ–ï¼Œç¼–è¯‘å™¨åˆ†åˆ«å°† nullptr éšå¼è½¬æ¢æˆ int*ã€char* ä»¥åŠ double* æŒ‡é’ˆç±»å‹ã€‚ å¦å¤–ï¼Œé€šè¿‡å°†æŒ‡é’ˆåˆå§‹åŒ–ä¸º nullptrï¼Œå¯ä»¥å¾ˆå¥½åœ°è§£å†³ NULL é—ç•™çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š #include \u003ciostream\u003e using namespace std; void isnull(void *c){ cout \u003c\u003c \"void*c\" \u003c\u003c endl; } void isnull(int n){ cout \u003c\u003c \"int n\" \u003c\u003c endl; } int main() { isnull(NULL); isnull(nullptr); return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š int n void*c å€ŸåŠ©æ‰§è¡Œç»“æœä¸éš¾çœ‹å‡ºï¼Œç”±äº nullptr æ— æ³•éšå¼è½¬æ¢ä¸ºæ•´å½¢ï¼Œè€Œå¯ä»¥éšå¼åŒ¹é…æŒ‡é’ˆç±»å‹ï¼Œå› æ­¤æ‰§è¡Œç»“æœå’Œæˆ‘ä»¬çš„é¢„æœŸç›¸ç¬¦ã€‚ æ€»ä¹‹åœ¨ C++11 æ ‡å‡†ä¸‹ï¼Œç›¸æ¯” NULL å’Œ 0ï¼Œä½¿ç”¨ nullptr åˆå§‹åŒ–ç©ºæŒ‡é’ˆå¯ä»¥ä»¤æˆ‘ä»¬ç¼–å†™çš„ç¨‹åºæ›´åŠ å¥å£®ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:24","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] shared_ptræ™ºèƒ½æŒ‡é’ˆï¼ˆè¶…çº§è¯¦ç»†ï¼‰ åœ¨å®é™…çš„ C++ å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¯¸å¦‚ç¨‹åºè¿è¡Œä¸­çªç„¶å´©æºƒã€ç¨‹åºè¿è¡Œæ‰€ç”¨å†…å­˜è¶Šæ¥è¶Šå¤šæœ€ç»ˆä¸å¾—ä¸é‡å¯ç­‰é—®é¢˜ï¼Œè¿™äº›é—®é¢˜å¾€å¾€éƒ½æ˜¯å†…å­˜èµ„æºç®¡ç†ä¸å½“é€ æˆçš„ã€‚æ¯”å¦‚ï¼š æœ‰äº›å†…å­˜èµ„æºå·²ç»è¢«é‡Šæ”¾ï¼Œä½†æŒ‡å‘å®ƒçš„æŒ‡é’ˆå¹¶æ²¡æœ‰æ”¹å˜æŒ‡å‘ï¼ˆæˆä¸ºäº†é‡æŒ‡é’ˆï¼‰ï¼Œå¹¶ä¸”åç»­è¿˜åœ¨ä½¿ç”¨ï¼› æœ‰äº›å†…å­˜èµ„æºå·²ç»è¢«é‡Šæ”¾ï¼ŒåæœŸåˆè¯•å›¾å†é‡Šæ”¾ä¸€æ¬¡ï¼ˆé‡å¤é‡Šæ”¾åŒä¸€å—å†…å­˜ä¼šå¯¼è‡´ç¨‹åºè¿è¡Œå´©æºƒï¼‰ï¼› æ²¡æœ‰åŠæ—¶é‡Šæ”¾ä¸å†ä½¿ç”¨çš„å†…å­˜èµ„æºï¼Œé€ æˆå†…å­˜æ³„æ¼ï¼Œç¨‹åºå ç”¨çš„å†…å­˜èµ„æºè¶Šæ¥è¶Šå¤šã€‚ é’ˆå¯¹ä»¥ä¸Šè¿™äº›æƒ…å†µï¼Œå¾ˆå¤šç¨‹åºå‘˜è®¤ä¸º C++ è¯­è¨€åº”è¯¥æä¾›æ›´å‹å¥½çš„å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œè¿™æ ·å°±å¯ä»¥å°†ç²¾åŠ›é›†ä¸­äºå¼€å‘é¡¹ç›®çš„å„ä¸ªåŠŸèƒ½ä¸Šã€‚ äº‹å®ä¸Šï¼Œæ˜¾ç¤ºå†…å­˜ç®¡ç†çš„æ›¿ä»£æ–¹æ¡ˆå¾ˆæ—©å°±æœ‰äº†ï¼Œæ—©åœ¨ 1959 å¹´å‰åï¼Œå°±æœ‰äººæå‡ºäº†â€œåƒåœ¾è‡ªåŠ¨å›æ”¶â€æœºåˆ¶ã€‚æ‰€è°“åƒåœ¾ï¼ŒæŒ‡çš„æ˜¯é‚£äº›ä¸å†ä½¿ç”¨æˆ–è€…æ²¡æœ‰ä»»ä½•æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼Œè€Œâ€œå›æ”¶â€åˆ™æŒ‡çš„æ˜¯å°†è¿™äº›â€œåƒåœ¾â€æ”¶é›†èµ·æ¥ä»¥ä¾¿å†æ¬¡åˆ©ç”¨ã€‚ å¦‚ä»Šï¼Œåƒåœ¾å›æ”¶æœºåˆ¶å·²ç»å¤§è¡Œå…¶é“ï¼Œå¾—åˆ°äº†è¯¸å¤šç¼–ç¨‹è¯­è¨€çš„æ”¯æŒï¼Œä¾‹å¦‚ Javaã€Pythonã€C#ã€PHP ç­‰ã€‚è€Œ C++ è™½ç„¶ä»æ¥æ²¡æœ‰å…¬å¼€å¾—æ”¯æŒè¿‡åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä½† C++98/03 æ ‡å‡†ä¸­ï¼Œæ”¯æŒä½¿ç”¨ auto_ptr æ™ºèƒ½æŒ‡é’ˆæ¥å®ç°å †å†…å­˜çš„è‡ªåŠ¨å›æ”¶ï¼›C++11 æ–°æ ‡å‡†åœ¨åºŸå¼ƒ auto_ptr çš„åŒæ—¶ï¼Œå¢æ·»äº† unique_ptrã€shared_ptr ä»¥åŠ weak_ptr è¿™ 3 ä¸ªæ™ºèƒ½æŒ‡é’ˆæ¥å®ç°å †å†…å­˜çš„è‡ªåŠ¨å›æ”¶ã€‚ æ‰€è°“æ™ºèƒ½æŒ‡é’ˆï¼Œå¯ä»¥ä»å­—é¢ä¸Šç†è§£ä¸ºâ€œæ™ºèƒ½â€çš„æŒ‡é’ˆã€‚å…·ä½“æ¥è®²ï¼Œæ™ºèƒ½æŒ‡é’ˆå’Œæ™®é€šæŒ‡é’ˆçš„ç”¨æ³•æ˜¯ç›¸ä¼¼çš„ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼Œæ™ºèƒ½æŒ‡é’ˆå¯ä»¥åœ¨é€‚å½“æ—¶æœºè‡ªåŠ¨é‡Šæ”¾åˆ†é…çš„å†…å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå¯ä»¥å¾ˆå¥½åœ°é¿å…â€œå¿˜è®°é‡Šæ”¾å†…å­˜è€Œå¯¼è‡´å†…å­˜æ³„æ¼â€é—®é¢˜å‡ºç°ã€‚ç”±æ­¤å¯è§ï¼ŒC++ ä¹Ÿé€æ¸å¼€å§‹æ”¯æŒåƒåœ¾å›æ”¶æœºåˆ¶äº†ï¼Œå°½ç®¡ç›®å‰æ”¯æŒç¨‹åº¦è¿˜æœ‰é™ã€‚ C++ æ™ºèƒ½æŒ‡é’ˆåº•å±‚æ˜¯é‡‡ç”¨å¼•ç”¨è®¡æ•°çš„æ–¹å¼å®ç°çš„ã€‚ç®€å•çš„ç†è§£ï¼Œæ™ºèƒ½æŒ‡é’ˆåœ¨ç”³è¯·å †å†…å­˜ç©ºé—´çš„åŒæ—¶ï¼Œä¼šä¸ºå…¶é…å¤‡ä¸€ä¸ªæ•´å½¢å€¼ï¼ˆåˆå§‹å€¼ä¸º 1ï¼‰ï¼Œæ¯å½“æœ‰æ–°å¯¹è±¡ä½¿ç”¨æ­¤å †å†…å­˜æ—¶ï¼Œè¯¥æ•´å½¢å€¼ +1ï¼›åä¹‹ï¼Œæ¯å½“ä½¿ç”¨æ­¤å †å†…å­˜çš„å¯¹è±¡è¢«é‡Šæ”¾æ—¶ï¼Œè¯¥æ•´å½¢å€¼å‡ 1ã€‚å½“å †ç©ºé—´å¯¹åº”çš„æ•´å½¢å€¼ä¸º 0 æ—¶ï¼Œå³è¡¨æ˜ä¸å†æœ‰å¯¹è±¡ä½¿ç”¨å®ƒï¼Œè¯¥å †ç©ºé—´å°±ä¼šè¢«é‡Šæ”¾æ‰ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ†åˆ«å¯¹ shared_ptrã€unique_ptr ä»¥åŠ weak_ptr è¿™ 3 ä¸ªæ™ºèƒ½æŒ‡é’ˆçš„ç‰¹æ€§å’Œç”¨æ³•åšè¯¦ç»†çš„è®²è§£ï¼Œæœ¬èŠ‚å…ˆä»‹ç» shared_ptr æ™ºèƒ½æŒ‡é’ˆã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:25","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] shared_ptræ™ºèƒ½æŒ‡é’ˆ å®é™…ä¸Šï¼Œæ¯ç§æ™ºèƒ½æŒ‡é’ˆéƒ½æ˜¯ä»¥ç±»æ¨¡æ¿çš„æ–¹å¼å®ç°çš„ï¼Œshared_ptr ä¹Ÿä¸ä¾‹å¤–ã€‚shared_ptrï¼ˆå…¶ä¸­ T è¡¨ç¤ºæŒ‡é’ˆæŒ‡å‘çš„å…·ä½“æ•°æ®ç±»å‹ï¼‰çš„å®šä¹‰ä½äºå¤´æ–‡ä»¶ï¼Œå¹¶ä½äº std å‘½åç©ºé—´ä¸­ï¼Œå› æ­¤åœ¨ä½¿ç”¨è¯¥ç±»å‹æŒ‡é’ˆæ—¶ï¼Œç¨‹åºä¸­åº”åŒ…å«å¦‚ä¸‹ 2 è¡Œä»£ç ï¼š #include \u003cmemory\u003e using namespace std; æ³¨æ„ï¼Œç¬¬ 2 è¡Œä»£ç å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä¹Ÿå¯ä»¥ä¸æ·»åŠ ï¼Œåˆ™åç»­åœ¨ä½¿ç”¨ shared_ptr æ™ºèƒ½æŒ‡é’ˆæ—¶ï¼Œå°±éœ€è¦æ˜ç¡®æŒ‡æ˜std::ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå’Œ unique_ptrã€weak_ptr ä¸åŒä¹‹å¤„åœ¨äºï¼Œå¤šä¸ª shared_ptr æ™ºèƒ½æŒ‡é’ˆå¯ä»¥å…±åŒä½¿ç”¨åŒä¸€å—å †å†…å­˜ã€‚å¹¶ä¸”ï¼Œç”±äºè¯¥ç±»å‹æ™ºèƒ½æŒ‡é’ˆåœ¨å®ç°ä¸Šé‡‡ç”¨çš„æ˜¯å¼•ç”¨è®¡æ•°æœºåˆ¶ï¼Œå³ä¾¿æœ‰ä¸€ä¸ª shared_ptr æŒ‡é’ˆæ”¾å¼ƒäº†å †å†…å­˜çš„â€œä½¿ç”¨æƒâ€ï¼ˆå¼•ç”¨è®¡æ•°å‡ 1ï¼‰ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–æŒ‡å‘åŒä¸€å †å†…å­˜çš„ shared_ptr æŒ‡é’ˆï¼ˆåªæœ‰å¼•ç”¨è®¡æ•°ä¸º 0 æ—¶ï¼Œå †å†…å­˜æ‰ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ï¼‰ã€‚ 1ã€shared_ptræ™ºèƒ½æŒ‡é’ˆçš„åˆ›å»º shared_ptr ç±»æ¨¡æ¿ä¸­ï¼Œæä¾›äº†å¤šç§å®ç”¨çš„æ„é€ å‡½æ•°ï¼Œè¿™é‡Œç»™è¯»è€…åˆ—ä¸¾äº†å‡ ä¸ªå¸¸ç”¨çš„æ„é€ å‡½æ•°ï¼ˆä»¥æ„å»ºæŒ‡å‘ int ç±»å‹æ•°æ®çš„æ™ºèƒ½æŒ‡é’ˆä¸ºä¾‹ï¼‰ã€‚ 1.1 é€šè¿‡å¦‚ä¸‹ 2 ç§æ–¹å¼ï¼Œå¯ä»¥æ„é€ å‡º shared_ptr ç±»å‹çš„ç©ºæ™ºèƒ½æŒ‡é’ˆï¼š std::shared_ptr\u003cint\u003e p1; //ä¸ä¼ å…¥ä»»ä½•å®å‚std::shared_ptr\u003cint\u003e p2(nullptr); //ä¼ å…¥ç©ºæŒ‡é’ˆ nullptr æ³¨æ„ï¼Œç©ºçš„ shared_ptr æŒ‡é’ˆï¼Œå…¶åˆå§‹å¼•ç”¨è®¡æ•°ä¸º 0ï¼Œè€Œä¸æ˜¯ 1ã€‚ 1.2 åœ¨æ„å»º shared_ptr æ™ºèƒ½æŒ‡é’ˆï¼Œä¹Ÿå¯ä»¥æ˜ç¡®å…¶æŒ‡å‘ã€‚ä¾‹å¦‚ï¼š std::shared_ptr\u003cint\u003e p3(new int(10)); ç”±æ­¤ï¼Œæˆ‘ä»¬å°±æˆåŠŸæ„å»ºäº†ä¸€ä¸ª shared_ptr æ™ºèƒ½æŒ‡é’ˆï¼Œå…¶æŒ‡å‘ä¸€å—å­˜æœ‰ 10 è¿™ä¸ª int ç±»å‹æ•°æ®çš„å †å†…å­˜ç©ºé—´ã€‚ åŒæ—¶ï¼ŒC++11 æ ‡å‡†ä¸­è¿˜æä¾›äº† std::make_shared æ¨¡æ¿å‡½æ•°ï¼Œå…¶å¯ä»¥ç”¨äºåˆå§‹åŒ– shared_ptr æ™ºèƒ½æŒ‡é’ˆï¼Œä¾‹å¦‚ï¼š std::shared_ptr\u003cint\u003e p3 = std::make_shared\u003cint\u003e(10); ä»¥ä¸Š 2 ç§æ–¹å¼åˆ›å»ºçš„ p3 æ˜¯å®Œå…¨ç›¸åŒã€‚ 1.3 é™¤æ­¤ä¹‹å¤–ï¼Œshared_ptr æ¨¡æ¿è¿˜æä¾›æœ‰ç›¸åº”çš„æ‹·è´æ„é€ å‡½æ•°å’Œç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä¾‹å¦‚ï¼š //è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° std::shared_ptr\u003cint\u003e p4(p3);//æˆ–è€… std::shared_ptr\u003cint\u003e p4 = p3; //è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° std::shared_ptr\u003cint\u003e p5(std::move(p4)); //æˆ–è€… std::shared_ptr\u003cint\u003e p5 = std::move(p4); æœ‰å…³æ‹·è´æ„é€ å‡½æ•°ï¼Œè¯»è€…å¯é˜…è¯»ã€ŠC++æ‹·è´æ„é€ å‡½æ•°ã€‹ä¸€èŠ‚åšç³»ç»Ÿäº†è§£ï¼›æœ‰å…³ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œè¯»è€…å¯é˜…è¯»ã€ŠC++ç§»åŠ¨æ„é€ å‡½æ•°ã€‹åšè¯¦ç»†äº†è§£ï¼›æœ‰å…³ move() å‡½æ•°çš„åŠŸèƒ½å’Œç”¨æ³•ï¼Œè¯»è€…å¯é˜…è¯»ã€ŠC++11 move()ã€‹ä¸€èŠ‚ã€‚ å¦‚ä¸Šæ‰€ç¤ºï¼Œp3 å’Œ p4 éƒ½æ˜¯ shared_ptr ç±»å‹çš„æ™ºèƒ½æŒ‡é’ˆï¼Œå› æ­¤å¯ä»¥ç”¨ p3 æ¥åˆå§‹åŒ– p4ï¼Œç”±äº p3 æ˜¯å·¦å€¼ï¼Œå› æ­¤ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœ p3 ä¸ºç©ºæ™ºèƒ½æŒ‡é’ˆï¼Œåˆ™ p4 ä¹Ÿä¸ºç©ºæ™ºèƒ½æŒ‡é’ˆï¼Œå…¶å¼•ç”¨è®¡æ•°åˆå§‹å€¼ä¸º 0ï¼›åä¹‹ï¼Œåˆ™è¡¨æ˜ p4 å’Œ p3 æŒ‡å‘åŒä¸€å—å †å†…å­˜ï¼ŒåŒæ—¶è¯¥å †ç©ºé—´çš„å¼•ç”¨è®¡æ•°ä¼šåŠ  1ã€‚ è€Œå¯¹äº std::move(p4) æ¥è¯´ï¼Œè¯¥å‡½æ•°ä¼šå¼ºåˆ¶å°† p4 è½¬æ¢æˆå¯¹åº”çš„å³å€¼ï¼Œå› æ­¤åˆå§‹åŒ– p5 è°ƒç”¨çš„æ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ã€‚å¦å¤–å’Œè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ä¸åŒï¼Œç”¨ std::move(p4) åˆå§‹åŒ– p5ï¼Œä¼šä½¿å¾— p5 æ‹¥æœ‰äº† p4 çš„å †å†…å­˜ï¼Œè€Œ p4 åˆ™å˜æˆäº†ç©ºæ™ºèƒ½æŒ‡é’ˆã€‚ æ³¨æ„ï¼ŒåŒä¸€æ™®é€šæŒ‡é’ˆä¸èƒ½åŒæ—¶ä¸ºå¤šä¸ª shared_ptr å¯¹è±¡èµ‹å€¼ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç¨‹åºå‘ç”Ÿå¼‚å¸¸ã€‚ä¾‹å¦‚ï¼š int* ptr = new int; std::shared_ptr\u003cint\u003e p1(ptr); std::shared_ptr\u003cint\u003e p2(ptr);//é”™è¯¯ 1.4 åœ¨åˆå§‹åŒ– shared_ptr æ™ºèƒ½æŒ‡é’ˆæ—¶ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰æ‰€æŒ‡å †å†…å­˜çš„é‡Šæ”¾è§„åˆ™ï¼Œè¿™æ ·å½“å †å†…å­˜çš„å¼•ç”¨è®¡æ•°ä¸º 0 æ—¶ï¼Œä¼šä¼˜å…ˆè°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„é‡Šæ”¾è§„åˆ™ã€‚ åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œè‡ªå®šä¹‰é‡Šæ”¾è§„åˆ™æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚æ¯”å¦‚ï¼Œå¯¹äºç”³è¯·çš„åŠ¨æ€æ•°ç»„æ¥è¯´ï¼Œshared_ptr æŒ‡é’ˆé»˜è®¤çš„é‡Šæ”¾è§„åˆ™æ˜¯ä¸æ”¯æŒé‡Šæ”¾æ•°ç»„çš„ï¼Œåªèƒ½è‡ªå®šä¹‰å¯¹åº”çš„é‡Šæ”¾è§„åˆ™ï¼Œæ‰èƒ½æ­£ç¡®åœ°é‡Šæ”¾ç”³è¯·çš„å †å†…å­˜ã€‚ å¯¹äºç”³è¯·çš„åŠ¨æ€æ•°ç»„ï¼Œé‡Šæ”¾è§„åˆ™å¯ä»¥ä½¿ç”¨ C++11 æ ‡å‡†ä¸­æä¾›çš„ default_delete æ¨¡æ¿ç±»ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é‡Šæ”¾è§„åˆ™ï¼š //æŒ‡å®š default_delete ä½œä¸ºé‡Šæ”¾è§„åˆ™ std::shared_ptr\u003cint\u003e p6(new int[10], std::default_delete\u003cint[]\u003e()); //è‡ªå®šä¹‰é‡Šæ”¾è§„åˆ™ void deleteInt(int*p) { delete []p; } //åˆå§‹åŒ–æ™ºèƒ½æŒ‡é’ˆï¼Œå¹¶è‡ªå®šä¹‰é‡Šæ”¾è§„åˆ™ std::shared_ptr\u003cint\u003e p7(new int[10], deleteInt); å®é™…ä¸Šå€ŸåŠ© lambda è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åƒå¦‚ä¸‹è¿™æ ·åˆå§‹åŒ– p7ï¼Œå®ƒä»¬æ˜¯å®Œå…¨ç›¸åŒçš„ï¼š std::shared_ptr\u003cint\u003e p7(new int[10], [](int* p) {delete[]p; }); shared_ptr æ¨¡æ¿ç±»è¿˜æä¾›æœ‰å…¶å®ƒä¸€äº›åˆå§‹åŒ–æ™ºèƒ½æŒ‡é’ˆçš„æ–¹æ³•ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯å‰å¾€è®²è§£ shared_ptr çš„å®˜ç½‘åšç³»ç»Ÿäº†è§£ã€‚ 2ã€shared_ptræ¨¡æ¿ç±»æä¾›çš„æˆå‘˜æ–¹æ³• ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ shared_ptr æ™ºèƒ½æŒ‡é’ˆï¼Œshared_ptr æ¨¡æ¿ç±»è¿˜æä¾›æœ‰ä¸€äº›å®ç”¨çš„æˆå‘˜æ–¹æ³•ï¼Œå®ƒä»¬å„è‡ªçš„åŠŸèƒ½å¦‚è¡¨ 1 æ‰€ç¤ºã€‚ æˆå‘˜æ–¹æ³•å åŠŸ èƒ½ operator=() é‡è½½èµ‹å€¼å·ï¼Œä½¿å¾—åŒä¸€ç±»å‹çš„ shared_ptr æ™ºèƒ½æŒ‡é’ˆå¯ä»¥ç›¸äº’èµ‹å€¼ã€‚ operator*() é‡è½½ * å·ï¼Œè·å–å½“å‰ shared_ptr æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡æŒ‡å‘çš„æ•°æ®ã€‚ operator-\u003e() é‡è½½ -\u003e å·ï¼Œå½“æ™ºèƒ½æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ç±»å‹ä¸ºè‡ªå®šä¹‰çš„ç»“æ„ä½“æ—¶ï¼Œé€šè¿‡ -\u003e è¿ç®—ç¬¦å¯ä»¥è·å–å…¶å†…éƒ¨çš„æŒ‡å®šæˆå‘˜ã€‚ swap() äº¤æ¢ 2 ä¸ªç›¸åŒç±»å‹ shared_ptr æ™ºèƒ½æŒ‡é’ˆçš„å†…å®¹ã€‚ reset() å½“å‡½æ•°æ²¡æœ‰å®å‚æ—¶ï¼Œè¯¥å‡½æ•°ä¼šä½¿å½“å‰ shared_ptr æ‰€æŒ‡å †å†…å­˜çš„å¼•ç”¨è®¡æ•°å‡ 1ï¼ŒåŒæ—¶å°†å½“å‰å¯¹è±¡é‡ç½®ä¸ºä¸€ä¸ªç©ºæŒ‡é’ˆï¼›å½“ä¸ºå‡½æ•°ä¼ é€’ä¸€ä¸ªæ–°ç”³è¯·çš„å †å†…å­˜æ—¶ï¼Œåˆ™è°ƒç”¨è¯¥å‡½æ•°çš„ shared_ptr å¯¹è±¡ä¼šè·å¾—è¯¥å­˜å‚¨ç©ºé—´çš„æ‰€æœ‰æƒï¼Œå¹¶ä¸”å¼•ç”¨è®¡æ•°çš„åˆå§‹å€¼ä¸º 1ã€‚ get() è·å¾— shared_ptr å¯¹è±¡å†…éƒ¨åŒ…å«çš„æ™®é€šæŒ‡é’ˆã€‚ use_count() è¿”å›åŒå½“å‰ shared_ptr å¯¹è±¡ï¼ˆåŒ…æ‹¬å®ƒï¼‰æŒ‡å‘ç›¸åŒçš„æ‰€æœ‰ shared_ptr å¯¹è±¡çš„æ•°é‡ã€‚ unique() åˆ¤æ–­å½“å‰ shared_ptr å¯¹è±¡æŒ‡å‘çš„å †å†…å­˜ï¼Œæ˜¯å¦ä¸å†æœ‰å…¶å®ƒ shared_ptr å¯¹è±¡å†æŒ‡å‘å®ƒã€‚ operator bool() åˆ¤æ–­å½“å‰ shared_ptr å¯¹è±¡æ˜¯å¦ä¸ºç©ºæ™ºèƒ½æŒ‡é’ˆï¼Œå¦‚æœæ˜¯ç©ºæŒ‡é’ˆï¼Œè¿”å› falseï¼›åä¹‹ï¼Œè¿”å› trueã€‚ é™¤æ­¤ä¹‹å¤–ï¼ŒC++11 æ ‡å‡†è¿˜æ”¯æŒåŒä¸€ç±»å‹çš„ shared_ptr å¯¹è±¡ï¼Œæˆ–è€… shared_ptr å’Œ nullptr ä¹‹é—´ï¼Œè¿›è¡Œ ==ï¼Œ!=ï¼Œ\u003cï¼Œ\u003c=ï¼Œ\u003eï¼Œ\u003e= è¿ç®—ã€‚ ä¸‹é¢ç¨‹åºç»™å¤§å®¶æ¼”ç¤ºäº† shared_ptr æ™ºèƒ½æŒ‡é’ˆçš„åŸºæœ¬ç”¨æ³•ï¼Œä»¥åŠè¯¥æ¨¡æ¿ç±»æä¾›äº†ä¸€äº›æˆå‘˜æ–¹æ³•çš„ç”¨æ³•ï¼š #include \u003ciostream\u003e #include \u003cmemory\u003e using namespace std; int main() { //æ„å»º 2 ä¸ªæ™ºèƒ½æŒ‡é’ˆ std::shared_ptr\u003cint\u003e p1(new int(10)); std::shared_ptr\u003cint\u003e p2(p1); //è¾“å‡º p2 æŒ‡å‘çš„æ•°æ® cout \u003c\u003c *p2 \u003c\u003c endl; p1.reset();//å¼•ç”¨è®¡æ•°å‡ 1,p1ä¸ºç©ºæŒ‡é’ˆ if (p1) { cout \u003c\u003c \"p1 ä¸ä¸ºç©º\" \u003c\u003c endl; } else { cout \u003c\u003c \"p1 ä¸ºç©º\" \u003c\u003c endl; } //ä»¥ä¸Šæ“ä½œï¼Œå¹¶ä¸ä¼šå½±å“ p2 cout \u003c\u003c *p2 \u003c\u003c endl; //åˆ¤æ–­å½“å‰å’Œ p2 åŒæŒ‡å‘çš„æ™ºèƒ½æŒ‡é’ˆæœ‰å¤šå°‘ä¸ª cout \u003c\u003c p2.use_count() \u003c\u003c endl; return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 10 p1 ä¸ºç©º 10 1 ","date":"2023-07-12","objectID":"/posts/newfeature/:1:26","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] unique_ptræ™ºèƒ½æŒ‡é’ˆ åœ¨ã€ŠC++11 shared_ptræ™ºèƒ½æŒ‡é’ˆã€‹çš„åŸºç¡€ä¸Šï¼Œæœ¬èŠ‚ç»§ç»­è®²è§£ C++11 æ ‡å‡†æä¾›çš„å¦ä¸€ç§æ™ºèƒ½æŒ‡é’ˆï¼Œå³ unique_ptr æ™ºèƒ½æŒ‡é’ˆã€‚ ä½œä¸ºæ™ºèƒ½æŒ‡é’ˆçš„ä¸€ç§ï¼Œunique_ptr æŒ‡é’ˆè‡ªç„¶ä¹Ÿå…·å¤‡â€œåœ¨é€‚å½“æ—¶æœºè‡ªåŠ¨é‡Šæ”¾å †å†…å­˜ç©ºé—´â€çš„èƒ½åŠ›ã€‚å’Œ shared_ptr æŒ‡é’ˆæœ€å¤§çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œunique_ptr æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜æ— æ³•åŒå…¶å®ƒ unique_ptr å…±äº«ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ª unique_ptr æŒ‡é’ˆéƒ½ç‹¬è‡ªæ‹¥æœ‰å¯¹å…¶æ‰€æŒ‡å †å†…å­˜ç©ºé—´çš„æ‰€æœ‰æƒã€‚ è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œæ¯ä¸ª unique_ptr æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜ç©ºé—´çš„å¼•ç”¨è®¡æ•°ï¼Œéƒ½åªèƒ½ä¸º 1ï¼Œä¸€æ—¦è¯¥ unique_ptr æŒ‡é’ˆæ”¾å¼ƒå¯¹æ‰€æŒ‡å †å†…å­˜ç©ºé—´çš„æ‰€æœ‰æƒï¼Œåˆ™è¯¥ç©ºé—´ä¼šè¢«ç«‹å³é‡Šæ”¾å›æ”¶ã€‚ unique_ptr æ™ºèƒ½æŒ‡é’ˆæ˜¯ä»¥æ¨¡æ¿ç±»çš„å½¢å¼æä¾›çš„ï¼Œunique_ptrï¼ˆT ä¸ºæŒ‡é’ˆæ‰€æŒ‡æ•°æ®çš„ç±»å‹ï¼‰å®šä¹‰åœ¨å¤´æ–‡ä»¶ï¼Œå¹¶ä½äº std å‘½åç©ºé—´ä¸­ã€‚å› æ­¤ï¼Œè¦æƒ³ä½¿ç”¨ unique_ptr ç±»å‹æŒ‡é’ˆï¼Œç¨‹åºä¸­åº”é¦–å…ˆåŒ…å«å¦‚ä¸‹ 2 æ¡è¯­å¥ï¼š #include \u003cmemory\u003e using namespace std; ç¬¬ 2 å¥å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå¯ä»¥ä¸æ·»åŠ ï¼Œåˆ™åç»­åœ¨ä½¿ç”¨ unique_ptr æŒ‡é’ˆæ—¶ï¼Œå¿…é¡»æ ‡æ³¨std::ã€‚ unique_ptræ™ºèƒ½æŒ‡é’ˆçš„åˆ›å»º è€ƒè™‘åˆ°ä¸åŒå®é™…åœºæ™¯çš„éœ€è¦ï¼Œunique_ptr æ¨¡æ¿ç±»æä¾›äº†å¤šä¸ªå®ç”¨çš„æ„é€ å‡½æ•°ï¼Œè¿™é‡Œç»™è¯»è€…åˆ—ä¸¾äº†å‡ ç§å¸¸ç”¨çš„æ„é€  unique_ptr æ™ºèƒ½æŒ‡é’ˆçš„æ–¹å¼ã€‚ é€šè¿‡ä»¥ä¸‹ 2 ç§æ–¹å¼ï¼Œå¯ä»¥åˆ›å»ºå‡ºç©ºçš„ unique_ptr æŒ‡é’ˆï¼š std::unique_ptr\u003cint\u003e p1(); std::unique_ptr\u003cint\u003e p2(nullptr); åˆ›å»º unique_ptr æŒ‡é’ˆçš„åŒæ—¶ï¼Œä¹Ÿå¯ä»¥æ˜ç¡®å…¶æŒ‡å‘ã€‚ä¾‹å¦‚ï¼š std::unique_ptr\u003cint\u003e p3(new int); ç”±æ­¤å°±åˆ›å»ºå‡ºäº†ä¸€ä¸ª p3 æ™ºèƒ½æŒ‡é’ˆï¼Œå…¶æŒ‡å‘çš„æ˜¯å¯å®¹çº³ 1 ä¸ªæ•´æ•°çš„å †å­˜å‚¨ç©ºé—´ã€‚ å’Œå¯ä»¥ç”¨ make_shared() æ¨¡æ¿å‡½æ•°åˆå§‹åŒ– shared_ptr æŒ‡é’ˆä¸åŒï¼ŒC++11 æ ‡å‡†ä¸­å¹¶æ²¡æœ‰ä¸º unique_ptr ç±»å‹æŒ‡é’ˆæ·»åŠ ç±»ä¼¼çš„æ¨¡æ¿å‡½æ•°ã€‚ åŸºäº unique_ptr ç±»å‹æŒ‡é’ˆä¸å…±äº«å„è‡ªæ‹¥æœ‰çš„å †å†…å­˜ï¼Œå› æ­¤ C++11 æ ‡å‡†ä¸­çš„ unique_ptr æ¨¡æ¿ç±»æ²¡æœ‰æä¾›æ‹·è´æ„é€ å‡½æ•°ï¼Œåªæä¾›äº†ç§»åŠ¨æ„é€ å‡½æ•°ã€‚ä¾‹å¦‚ï¼š std::unique_ptr\u003cint\u003e p4(new int); std::unique_ptr\u003cint\u003e p5(p4);//é”™è¯¯ï¼Œå †å†…å­˜ä¸å…±äº« std::unique_ptr\u003cint\u003e p5(std::move(p4));//æ­£ç¡®ï¼Œè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¯¹äºè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°çš„ p4 å’Œ p5 æ¥è¯´ï¼Œp5 å°†è·å– p4 æ‰€æŒ‡å †ç©ºé—´çš„æ‰€æœ‰æƒï¼Œè€Œ p4 å°†å˜æˆç©ºæŒ‡é’ˆï¼ˆnullptrï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œunique_ptr æŒ‡é’ˆé‡‡ç”¨ std::default_delete æ–¹æ³•é‡Šæ”¾å †å†…å­˜ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ç¬¦åˆå®é™…åœºæ™¯çš„é‡Šæ”¾è§„åˆ™ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå’Œ shared_ptr æŒ‡é’ˆä¸åŒï¼Œä¸º unique_ptr è‡ªå®šä¹‰é‡Šæ”¾è§„åˆ™ï¼Œåªèƒ½é‡‡ç”¨å‡½æ•°å¯¹è±¡çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼š //è‡ªå®šä¹‰çš„é‡Šæ”¾è§„åˆ™ struct myDel { void operator()(int *p) { delete p; } }; std::unique_ptr\u003cint, myDel\u003e p6(new int); //std::unique_ptr\u003cint, myDel\u003e p6(new int, myDel()); unique_ptræ¨¡æ¿ç±»æä¾›çš„æˆå‘˜æ–¹æ³• ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ unique_ptr æ™ºèƒ½æŒ‡é’ˆï¼Œunique_ptr æ¨¡æ¿ç±»è¿˜æä¾›æœ‰ä¸€äº›å®ç”¨çš„æˆå‘˜æ–¹æ³•ï¼Œå®ƒä»¬å„è‡ªçš„åŠŸèƒ½å¦‚è¡¨ 1 æ‰€ç¤ºã€‚ æˆå‘˜å‡½æ•°å åŠŸèƒ½ operator*() è·å–å½“å‰ unique_ptr æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ã€‚ operator-\u003e() é‡è½½ -\u003e å·ï¼Œå½“æ™ºèƒ½æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ç±»å‹ä¸ºè‡ªå®šä¹‰çš„ç»“æ„ä½“æ—¶ï¼Œé€šè¿‡ -\u003e è¿ç®—ç¬¦å¯ä»¥è·å–å…¶å†…éƒ¨çš„æŒ‡å®šæˆå‘˜ã€‚ operator =() é‡è½½äº† = èµ‹å€¼å·ï¼Œä»è€Œå¯ä»¥å°† nullptr æˆ–è€…ä¸€ä¸ªå³å€¼ unique_ptr æŒ‡é’ˆç›´æ¥èµ‹å€¼ç»™å½“å‰åŒç±»å‹çš„ unique_ptr æŒ‡é’ˆã€‚ operator é‡è½½äº† [] è¿ç®—ç¬¦ï¼Œå½“ unique_ptr æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ [] è·å–æŒ‡å®šä¸‹æ ‡ä½ç½®å¤„çš„æ•°æ®ã€‚ get() è·å–å½“å‰ unique_ptr æŒ‡é’ˆå†…éƒ¨åŒ…å«çš„æ™®é€šæŒ‡é’ˆã€‚ get_deleter() è·å–å½“å‰ unique_ptr æŒ‡é’ˆé‡Šæ”¾å †å†…å­˜ç©ºé—´æ‰€ç”¨çš„è§„åˆ™ã€‚ operator bool() unique_ptr æŒ‡é’ˆå¯ç›´æ¥ä½œä¸º if è¯­å¥çš„åˆ¤æ–­æ¡ä»¶ï¼Œä»¥åˆ¤æ–­è¯¥æŒ‡é’ˆæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™ä¸º falseï¼›åä¹‹ä¸º trueã€‚ release() é‡Šæ”¾å½“å‰ unique_ptr æŒ‡é’ˆå¯¹æ‰€æŒ‡å †å†…å­˜çš„æ‰€æœ‰æƒï¼Œä½†è¯¥å­˜å‚¨ç©ºé—´å¹¶ä¸ä¼šè¢«é”€æ¯ã€‚ reset() å…¶ä¸­ p è¡¨ç¤ºä¸€ä¸ªæ™®é€šæŒ‡é’ˆï¼Œå¦‚æœ p ä¸º nullptrï¼Œåˆ™å½“å‰ unique_ptr ä¹Ÿå˜æˆç©ºæŒ‡é’ˆï¼›åä¹‹ï¼Œåˆ™è¯¥å‡½æ•°ä¼šé‡Šæ”¾å½“å‰ unique_ptr æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜ï¼ˆå¦‚æœæœ‰ï¼‰ï¼Œç„¶åè·å– p æ‰€æŒ‡å †å†…å­˜çš„æ‰€æœ‰æƒï¼ˆp ä¸º nullptrï¼‰ã€‚ swap(x) äº¤æ¢å½“å‰ unique_ptr æŒ‡é’ˆå’ŒåŒç±»å‹çš„ x æŒ‡é’ˆã€‚ é™¤æ­¤ä¹‹å¤–ï¼ŒC++11æ ‡å‡†è¿˜æ”¯æŒåŒç±»å‹çš„ unique_ptr æŒ‡é’ˆä¹‹é—´ï¼Œä»¥åŠ unique_ptr å’Œ nullptr ä¹‹é—´ï¼Œåš ==ï¼Œ!=ï¼Œ\u003cï¼Œ\u003c=ï¼Œ\u003eï¼Œ\u003e= è¿ç®—ã€‚ ä¸‹é¢ç¨‹åºç»™å¤§å®¶æ¼”ç¤ºäº† unique_ptr æ™ºèƒ½æŒ‡é’ˆçš„åŸºæœ¬ç”¨æ³•ï¼Œä»¥åŠè¯¥æ¨¡æ¿ç±»æä¾›äº†ä¸€äº›æˆå‘˜æ–¹æ³•çš„ç”¨æ³•ï¼š #include \u003ciostream\u003e #include \u003cmemory\u003e using namespace std; int main() { std::unique_ptr\u003cint\u003e p5(new int); *p5 = 10; // p æ¥æ”¶ p5 é‡Šæ”¾çš„å †å†…å­˜ int * p = p5.release(); cout \u003c\u003c *p \u003c\u003c endl; //åˆ¤æ–­ p5 æ˜¯å¦ä¸ºç©ºæŒ‡é’ˆ if (p5) { cout \u003c\u003c \"p5 is not nullptr\" \u003c\u003c endl; } else { cout \u003c\u003c \"p5 is nullptr\" \u003c\u003c endl; } std::unique_ptr\u003cint\u003e p6; //p6 è·å– p çš„æ‰€æœ‰æƒ p6.reset(p); cout \u003c\u003c *p6 \u003c\u003c endl;; return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 10 p5 is nullptr 10 ","date":"2023-07-12","objectID":"/posts/newfeature/:1:27","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++11] weak_ptræ™ºèƒ½æŒ‡é’ˆ åœ¨ C++98/03 çš„åŸºç¡€ä¸Šï¼ŒC++11 æ ‡å‡†æ–°å¼•å…¥äº† shared_ptrã€unique_ptr ä»¥åŠ weak_ptr è¿™ 3 ä¸ªæ™ºèƒ½æŒ‡é’ˆã€‚å…¶ä¸­ï¼Œshared_ptr å’Œ unique_ptr å·²ç»åœ¨å‰é¢ç« èŠ‚åšäº†è¯¦ç»†åœ°ä»‹ç»ï¼Œæœ¬èŠ‚é‡ç‚¹è®²è§£ weak_ptr æ™ºèƒ½æŒ‡é’ˆçš„ç‰¹æ€§å’Œç”¨æ³•ã€‚ æ³¨æ„å­¦ä¹  weak_ptr æ™ºèƒ½æŒ‡é’ˆä¹‹å‰ï¼Œè¯»è€…å¿…é¡»å¯¹ shared_ptr æ™ºèƒ½æŒ‡é’ˆæœ‰ä¸€å®šçš„äº†è§£ï¼Œå¯é˜…è¯»ã€ŠC++11 shared_ptræ™ºèƒ½æŒ‡é’ˆã€‹ä¸€èŠ‚ï¼›å…³äº unique_ptr æŒ‡é’ˆï¼Œè¯»è€…å¯é˜…è¯»ã€ŠC++11 unique_ptræ™ºèƒ½æŒ‡é’ˆã€‹ä¸€èŠ‚åšç³»ç»Ÿå­¦ä¹ ã€‚ C++11 weak_ptræ™ºèƒ½æŒ‡é’ˆ å’Œ shared_ptrã€unique_ptr ç±»å‹æŒ‡é’ˆä¸€æ ·ï¼Œweak_ptr æ™ºèƒ½æŒ‡é’ˆä¹Ÿæ˜¯ä»¥æ¨¡æ¿ç±»çš„æ–¹å¼å®ç°çš„ã€‚weak_ptrï¼ˆ T ä¸ºæŒ‡é’ˆæ‰€æŒ‡æ•°æ®çš„ç±»å‹ï¼‰å®šä¹‰åœ¨å¤´æ–‡ä»¶ï¼Œå¹¶ä½äº std å‘½åç©ºé—´ä¸­ã€‚å› æ­¤ï¼Œè¦æƒ³ä½¿ç”¨ weak_ptr ç±»å‹æŒ‡é’ˆï¼Œç¨‹åºä¸­åº”é¦–å…ˆåŒ…å«å¦‚ä¸‹ 2 æ¡è¯­å¥ï¼š #include \u003cmemory\u003e using namespace std; ç¬¬ 2 å¥å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå¯ä»¥ä¸æ·»åŠ ï¼Œåˆ™åç»­åœ¨ä½¿ç”¨ unique_ptr æŒ‡é’ˆæ—¶ï¼Œå¿…é¡»æ ‡æ³¨std::ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒC++11æ ‡å‡†è™½ç„¶å°† weak_ptr å®šä½ä¸ºæ™ºèƒ½æŒ‡é’ˆçš„ä¸€ç§ï¼Œä½†è¯¥ç±»å‹æŒ‡é’ˆé€šå¸¸ä¸å•ç‹¬ä½¿ç”¨ï¼ˆæ²¡æœ‰å®é™…ç”¨å¤„ï¼‰ï¼Œåªèƒ½å’Œ shared_ptr ç±»å‹æŒ‡é’ˆæ­é…ä½¿ç”¨ã€‚ç”šè‡³äºï¼Œæˆ‘ä»¬å¯ä»¥å°† weak_ptr ç±»å‹æŒ‡é’ˆè§†ä¸º shared_ptr æŒ‡é’ˆçš„ä¸€ç§è¾…åŠ©å·¥å…·ï¼Œå€ŸåŠ© weak_ptr ç±»å‹æŒ‡é’ˆï¼Œ æˆ‘ä»¬å¯ä»¥è·å– shared_ptr æŒ‡é’ˆçš„ä¸€äº›çŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚æœ‰å¤šå°‘æŒ‡å‘ç›¸åŒçš„ shared_ptr æŒ‡é’ˆã€shared_ptr æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜æ˜¯å¦å·²ç»è¢«é‡Šæ”¾ç­‰ç­‰ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ weak_ptr ç±»å‹æŒ‡é’ˆçš„æŒ‡å‘å’ŒæŸä¸€ shared_ptr æŒ‡é’ˆç›¸åŒæ—¶ï¼Œweak_ptr æŒ‡é’ˆå¹¶ä¸ä¼šä½¿æ‰€æŒ‡å †å†…å­˜çš„å¼•ç”¨è®¡æ•°åŠ  1ï¼›åŒæ ·ï¼Œå½“ weak_ptr æŒ‡é’ˆè¢«é‡Šæ”¾æ—¶ï¼Œä¹‹å‰æ‰€æŒ‡å †å†…å­˜çš„å¼•ç”¨è®¡æ•°ä¹Ÿä¸ä¼šå› æ­¤è€Œå‡ 1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œweak_ptr ç±»å‹æŒ‡é’ˆå¹¶ä¸ä¼šå½±å“æ‰€æŒ‡å †å†…å­˜ç©ºé—´çš„å¼•ç”¨è®¡æ•°ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œweak_ptr æ¨¡æ¿ç±»ä¸­æ²¡æœ‰é‡è½½ * å’Œ -\u003e è¿ç®—ç¬¦ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œweak_ptr ç±»å‹æŒ‡é’ˆåªèƒ½è®¿é—®æ‰€æŒ‡çš„å †å†…å­˜ï¼Œè€Œæ— æ³•ä¿®æ”¹å®ƒã€‚ weak_ptræŒ‡é’ˆçš„åˆ›å»º åˆ›å»ºä¸€ä¸ª weak_ptr æŒ‡é’ˆï¼Œæœ‰ä»¥ä¸‹ 3 ç§æ–¹å¼ï¼š 1.1 å¯ä»¥åˆ›å»ºä¸€ä¸ªç©º weak_ptr æŒ‡é’ˆï¼Œä¾‹å¦‚ï¼š std::weak_ptr\u003cint\u003e wp1; 1.2 å‡­å€Ÿå·²æœ‰çš„ weak_ptr æŒ‡é’ˆï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ weak_ptr æŒ‡é’ˆï¼Œä¾‹å¦‚ï¼š std::weak_ptr\u003cint\u003e wp2 (wp1); è‹¥ wp1 ä¸ºç©ºæŒ‡é’ˆï¼Œåˆ™ wp2 ä¹Ÿä¸ºç©ºæŒ‡é’ˆï¼›åä¹‹ï¼Œå¦‚æœ wp1 æŒ‡å‘æŸä¸€ shared_ptr æŒ‡é’ˆæ‹¥æœ‰çš„å †å†…å­˜ï¼Œåˆ™ wp2 ä¹ŸæŒ‡å‘è¯¥å—å­˜å‚¨ç©ºé—´ï¼ˆå¯ä»¥è®¿é—®ï¼Œä½†æ— æ‰€æœ‰æƒï¼‰ã€‚ 1.3 weak_ptr æŒ‡é’ˆæ›´å¸¸ç”¨äºæŒ‡å‘æŸä¸€ shared_ptr æŒ‡é’ˆæ‹¥æœ‰çš„å †å†…å­˜ï¼Œå› ä¸ºåœ¨æ„å»º weak_ptr æŒ‡é’ˆå¯¹è±¡æ—¶ï¼Œå¯ä»¥åˆ©ç”¨å·²æœ‰çš„ shared_ptr æŒ‡é’ˆä¸ºå…¶åˆå§‹åŒ–ã€‚ä¾‹å¦‚ï¼š std::shared_ptr\u003cint\u003e sp (new int); std::weak_ptr\u003cint\u003e wp3 (sp); ç”±æ­¤ï¼Œwp3 æŒ‡é’ˆå’Œ sp æŒ‡é’ˆæœ‰ç›¸åŒçš„æŒ‡é’ˆã€‚å†æ¬¡å¼ºè°ƒï¼Œweak_ptr ç±»å‹æŒ‡é’ˆä¸ä¼šå¯¼è‡´å †å†…å­˜ç©ºé—´çš„å¼•ç”¨è®¡æ•°å¢åŠ æˆ–å‡å°‘ã€‚ weak_ptræ¨¡æ¿ç±»æä¾›çš„æˆå‘˜æ–¹æ³• å’Œ shared_ptrã€unique_ptr ç›¸æ¯”ï¼Œweak_ptr æ¨¡æ¿ç±»æä¾›çš„æˆå‘˜æ–¹æ³•ä¸å¤šï¼Œè¡¨ 1 ç½—åˆ—äº†å¸¸ç”¨çš„æˆå‘˜æ–¹æ³•åŠå„è‡ªçš„åŠŸèƒ½ã€‚ æˆå‘˜æ–¹æ³• åŠŸ èƒ½ operator=() é‡è½½ = èµ‹å€¼è¿ç®—ç¬¦ï¼Œæ˜¯çš„ weak_ptr æŒ‡é’ˆå¯ä»¥ç›´æ¥è¢« weak_ptr æˆ–è€… shared_ptr ç±»å‹æŒ‡é’ˆèµ‹å€¼ã€‚ swap(x) å…¶ä¸­ x è¡¨ç¤ºä¸€ä¸ªåŒç±»å‹çš„ weak_ptr ç±»å‹æŒ‡é’ˆï¼Œè¯¥å‡½æ•°å¯ä»¥äº’æ¢ 2 ä¸ªåŒç±»å‹ weak_ptr æŒ‡é’ˆçš„å†…å®¹ã€‚ reset() å°†å½“å‰ weak_ptr æŒ‡é’ˆç½®ä¸ºç©ºæŒ‡é’ˆã€‚ use_count() æŸ¥çœ‹æŒ‡å‘å’Œå½“å‰ weak_ptr æŒ‡é’ˆç›¸åŒçš„ shared_ptr æŒ‡é’ˆçš„æ•°é‡ã€‚ expired() åˆ¤æ–­å½“å‰ weak_ptr æŒ‡é’ˆä¸ºå¦è¿‡æœŸï¼ˆæŒ‡é’ˆä¸ºç©ºï¼Œæˆ–è€…æŒ‡å‘çš„å †å†…å­˜å·²ç»è¢«é‡Šæ”¾ï¼‰ã€‚ lock() å¦‚æœå½“å‰ weak_ptr å·²ç»è¿‡æœŸï¼Œåˆ™è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªç©ºçš„ shared_ptr æŒ‡é’ˆï¼›åä¹‹ï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå’Œå½“å‰ weak_ptr æŒ‡å‘ç›¸åŒçš„ shared_ptr æŒ‡é’ˆã€‚ å†æ¬¡å¼ºè°ƒï¼Œweak_ptr æ¨¡æ¿ç±»æ²¡æœ‰é‡è½½ * å’Œ -\u003e è¿ç®—ç¬¦ï¼Œå› æ­¤ weak_ptr ç±»å‹æŒ‡é’ˆåªèƒ½è®¿é—®æŸä¸€ shared_ptr æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜ç©ºé—´ï¼Œæ— æ³•å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚ ä¸‹é¢çš„æ ·ä¾‹æ¼”ç¤ºäº† weak_ptr æŒ‡é’ˆä»¥åŠè¡¨ 1 ä¸­éƒ¨åˆ†æˆå‘˜æ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ï¼š #include \u003ciostream\u003e #include \u003cmemory\u003e using namespace std; int main() { std::shared_ptr\u003cint\u003e sp1(new int(10)); std::shared_ptr\u003cint\u003e sp2(sp1); std::weak_ptr\u003cint\u003e wp(sp2); //è¾“å‡ºå’Œ wp åŒæŒ‡å‘çš„ shared_ptr ç±»å‹æŒ‡é’ˆçš„æ•°é‡ cout \u003c\u003c wp.use_count() \u003c\u003c endl; //é‡Šæ”¾ sp2 sp2.reset(); cout \u003c\u003c wp.use_count() \u003c\u003c endl; //å€ŸåŠ© lock() å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå’Œ wp åŒæŒ‡å‘çš„ shared_ptr ç±»å‹æŒ‡é’ˆï¼Œè·å–å…¶å­˜å‚¨çš„æ•°æ® cout \u003c\u003c *(wp.lock()) \u003c\u003c endl; return 0; } ç¨‹åºæ‰§è¡Œç»“æœä¸ºï¼š 2 1 10 æœ‰å…³è¡¨ 1 ä¸­å…¶å®ƒæˆå‘˜å‡½æ•°çš„ç”¨æ³•ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ç›´æ¥æŸ¥çœ‹ weak_ptr å®˜ç½‘ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:1:28","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"C++ 14 æ–°ç‰¹æ€§æ€»ç»“ ","date":"2023-07-12","objectID":"/posts/newfeature/:2:0","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] å‡½æ•°è¿”å›å€¼ç±»å‹æ¨å¯¼ C++14å¯¹å‡½æ•°è¿”å›ç±»å‹æ¨å¯¼è§„åˆ™åšäº†ä¼˜åŒ–ï¼Œå…ˆçœ‹ä¸€æ®µä»£ç ï¼š #include \u003ciostream\u003e using namespace std; auto func(int i) { return i; } int main() { cout \u003c\u003c func(4) \u003c\u003c endl; return 0; } ä½¿ç”¨C++11ç¼–è¯‘ï¼š ~/test$ g++ test.cc -std=c++11 test.cc:5:16: error: â€˜funcâ€™ function uses â€˜autoâ€™ type specifier without trailing return type auto func(int i) { ^ test.cc:5:16: note: deduced return type only available with -std=c++14 or -std=gnu++14 ä¸Šé¢çš„ä»£ç ä½¿ç”¨C++11æ˜¯ä¸èƒ½é€šè¿‡ç¼–è¯‘çš„ï¼Œé€šè¿‡ç¼–è¯‘å™¨è¾“å‡ºçš„ä¿¡æ¯ä¹Ÿå¯ä»¥çœ‹è§è¿™ä¸ªç‰¹æ€§éœ€è¦åˆ°C++14æ‰è¢«æ”¯æŒã€‚ è¿”å›å€¼ç±»å‹æ¨å¯¼ä¹Ÿå¯ä»¥ç”¨åœ¨æ¨¡æ¿ä¸­ï¼š #include \u003ciostream\u003e using namespace std; template\u003ctypename T\u003e auto func(T t) { return t; } int main() { cout \u003c\u003c func(4) \u003c\u003c endl; cout \u003c\u003c func(3.4) \u003c\u003c endl; return 0; } æ³¨æ„ï¼š å‡½æ•°å†…å¦‚æœæœ‰å¤šä¸ªreturnè¯­å¥ï¼Œå®ƒä»¬å¿…é¡»è¿”å›ç›¸åŒçš„ç±»å‹ï¼Œå¦åˆ™ç¼–è¯‘å¤±è´¥ã€‚ auto func(bool flag) { if (flag) return 1; else return 2.3; // error } // inconsistent deduction for auto return type: â€˜intâ€™ and then â€˜doubleâ€™ å¦‚æœreturnè¯­å¥è¿”å›åˆå§‹åŒ–åˆ—è¡¨ï¼Œè¿”å›å€¼ç±»å‹æ¨å¯¼ä¹Ÿä¼šå¤±è´¥ auto func() { return {1, 2, 3}; // error returning initializer list } å¦‚æœå‡½æ•°æ˜¯è™šå‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨è¿”å›å€¼ç±»å‹æ¨å¯¼ struct A { // error: virtual function cannot have deduced return type virtual auto func() { return 1; } } è¿”å›ç±»å‹æ¨å¯¼å¯ä»¥ç”¨åœ¨å‰å‘å£°æ˜ä¸­ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨å®ƒä»¬ä¹‹å‰ï¼Œç¿»è¯‘å•å…ƒä¸­å¿…é¡»èƒ½å¤Ÿå¾—åˆ°å‡½æ•°å®šä¹‰ auto f(); // declared, not yet defined auto f() { return 42; } // defined, return type is int int main() { cout \u003c\u003c f() \u003c\u003c endl; } è¿”å›ç±»å‹æ¨å¯¼å¯ä»¥ç”¨åœ¨é€’å½’å‡½æ•°ä¸­ï¼Œä½†æ˜¯é€’å½’è°ƒç”¨å¿…é¡»ä»¥è‡³å°‘ä¸€ä¸ªè¿”å›è¯­å¥ä½œä¸ºå…ˆå¯¼ï¼Œä»¥ä¾¿ç¼–è¯‘å™¨æ¨å¯¼å‡ºè¿”å›ç±»å‹ã€‚ auto sum(int i) { if (i == 1) return i; // return int else return sum(i - 1) + i; // ok } ","date":"2023-07-12","objectID":"/posts/newfeature/:2:1","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] lambdaå‚æ•°auto åœ¨C++11ä¸­ï¼Œlambdaè¡¨è¾¾å¼å‚æ•°éœ€è¦ä½¿ç”¨å…·ä½“çš„ç±»å‹å£°æ˜ï¼š auto f = [] (int a) { return a; } åœ¨C++14ä¸­ï¼Œå¯¹æ­¤è¿›è¡Œä¼˜åŒ–ï¼Œlambdaè¡¨è¾¾å¼å‚æ•°å¯ä»¥ç›´æ¥æ˜¯autoï¼š auto f = [] (auto a) { return a; }; cout \u003c\u003c f(1) \u003c\u003c endl; cout \u003c\u003c f(2.3f) \u003c\u003c endl; ","date":"2023-07-12","objectID":"/posts/newfeature/:2:2","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] å˜é‡æ¨¡æ¿ C++14æ”¯æŒå˜é‡æ¨¡æ¿ï¼š template\u003cclass T\u003e constexpr T pi = T(3.1415926535897932385L); int main() { cout \u003c\u003c pi\u003cint\u003e \u003c\u003c endl; // 3 cout \u003c\u003c pi\u003cdouble\u003e \u003c\u003c endl; // 3.14159 return 0; } ","date":"2023-07-12","objectID":"/posts/newfeature/:2:3","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] åˆ«åæ¨¡æ¿ C++14ä¹Ÿæ”¯æŒåˆ«åæ¨¡æ¿ï¼š template\u003ctypename T, typename U\u003e struct A { T t; U u; }; template\u003ctypename T\u003e using B = A\u003cT, int\u003e; int main() { B\u003cdouble\u003e b; b.t = 10; b.u = 20; cout \u003c\u003c b.t \u003c\u003c endl; cout \u003c\u003c b.u \u003c\u003c endl; return 0; } ","date":"2023-07-12","objectID":"/posts/newfeature/:2:4","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] constexprçš„é™åˆ¶ C++14ç›¸è¾ƒäºC++11å¯¹constexprå‡å°‘äº†ä¸€äº›é™åˆ¶ï¼š C++11ä¸­constexprå‡½æ•°å¯ä»¥ä½¿ç”¨é€’å½’ï¼Œåœ¨C++14ä¸­å¯ä»¥ä½¿ç”¨å±€éƒ¨å˜é‡å’Œå¾ªç¯ constexpr int factorial(int n) { // C++14 å’Œ C++11å‡å¯ return n \u003c= 1 ? 1 : (n * factorial(n - 1)); } åœ¨C++14ä¸­å¯ä»¥è¿™æ ·åšï¼š constexpr int factorial(int n) { // C++11ä¸­ä¸å¯ï¼ŒC++14ä¸­å¯ä»¥ int ret = 0; for (int i = 0; i \u003c n; ++i) { ret += i; } return ret; } C++11ä¸­constexprå‡½æ•°å¿…é¡»å¿…é¡»æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„returnè¯­å¥ä¸­ï¼Œè€Œconstexpråˆ™æ— æ­¤é™åˆ¶ï¼š constexpr int func(bool flag) { // C++14 å’Œ C++11å‡å¯ return 0; } åœ¨C++14ä¸­å¯ä»¥è¿™æ ·ï¼š constexpr int func(bool flag) { // C++11ä¸­ä¸å¯ï¼ŒC++14ä¸­å¯ä»¥ if (flag) return 1; else return 0; } ","date":"2023-07-12","objectID":"/posts/newfeature/:2:5","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] [[deprecated]]æ ‡è®° C++14ä¸­å¢åŠ äº†deprecatedæ ‡è®°ï¼Œä¿®é¥°ç±»ã€å˜ã€å‡½æ•°ç­‰ï¼Œå½“ç¨‹åºä¸­ä½¿ç”¨åˆ°äº†è¢«å…¶ä¿®é¥°çš„ä»£ç æ—¶ï¼Œç¼–è¯‘æ—¶è¢«äº§ç”Ÿè­¦å‘Šï¼Œç”¨æˆ·æç¤ºå¼€å‘è€…è¯¥æ ‡è®°ä¿®é¥°çš„å†…å®¹å°†æ¥å¯èƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œå°½é‡ä¸è¦ä½¿ç”¨ã€‚ struct [[deprecated]] A { }; int main() { A a; return 0; } å½“ç¼–è¯‘æ—¶ï¼Œä¼šå‡ºç°å¦‚ä¸‹è­¦å‘Šï¼š ~/test$ g++ test.cc -std=c++14 test.cc: In function â€˜int main()â€™: test.cc:11:7: warning: â€˜Aâ€™ is deprecated [-Wdeprecated-declarations] A a; ^ test.cc:6:23: note: declared here struct [[deprecated]] A { ","date":"2023-07-12","objectID":"/posts/newfeature/:2:6","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] äºŒè¿›åˆ¶å­—é¢é‡ä¸æ•´å½¢å­—é¢é‡åˆ†éš”ç¬¦ C++14å¼•å…¥äº†äºŒè¿›åˆ¶å­—é¢é‡ï¼Œä¹Ÿå¼•å…¥äº†åˆ†éš”ç¬¦ï¼Œé˜²æ­¢çœ‹èµ·æ¥çœ¼èŠ±å“ˆ~ int a = 0b0001'0011'1010; double b = 3.14'1234'1234'1234; ","date":"2023-07-12","objectID":"/posts/newfeature/:2:7","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] std::make_unique æˆ‘ä»¬éƒ½çŸ¥é“C++11ä¸­æœ‰std::make_sharedï¼Œå´æ²¡æœ‰std::make_uniqueï¼Œåœ¨C++14å·²ç»æ”¹å–„ã€‚ struct A {}; std::unique_ptr\u003cA\u003e ptr = std::make_unique\u003cA\u003e(); ","date":"2023-07-12","objectID":"/posts/newfeature/:2:8","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] std::shared_timed_mutexä¸std::shared_lock C++14é€šè¿‡std::shared_timed_mutexå’Œstd::shared_lockæ¥å®ç°è¯»å†™é”ï¼Œä¿è¯å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¯»ï¼Œä½†æ˜¯å†™çº¿ç¨‹å¿…é¡»ç‹¬ç«‹è¿è¡Œï¼Œå†™æ“ä½œä¸å¯ä»¥åŒæ—¶å’Œè¯»æ“ä½œä¸€èµ·è¿›è¡Œã€‚ å®ç°æ–¹å¼å¦‚ä¸‹ï¼š struct ThreadSafe { mutable std::shared_timed_mutex mutex_; int value_; ThreadSafe() { value_ = 0; } int get() const { std::shared_lock\u003cstd::shared_timed_mutex\u003e loc(mutex_); return value_; } void increase() { std::unique_lock\u003cstd::shared_timed_mutex\u003e lock(mutex_); value_ += 1; } }; ä¸ºä»€ä¹ˆæ˜¯timedçš„é”å‘¢ï¼Œå› ä¸ºå¯ä»¥å¸¦è¶…æ—¶æ—¶é—´ï¼Œå…·ä½“å¯ä»¥è‡ªè¡ŒæŸ¥è¯¢ç›¸å…³èµ„æ–™å“ˆï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:2:9","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] std::integer_sequence template\u003ctypename T, T... ints\u003e void print_sequence(std::integer_sequence\u003cT, ints...\u003e int_seq) { std::cout \u003c\u003c \"The sequence of size \" \u003c\u003c int_seq.size() \u003c\u003c \": \"; ((std::cout \u003c\u003c ints \u003c\u003c ' '), ...); std::cout \u003c\u003c '\\n'; } int main() { print_sequence(std::integer_sequence\u003cint, 9, 2, 5, 1, 9, 1, 6\u003e{}); return 0; } è¾“å‡ºï¼š7 9 2 5 1 9 1 6 std::integer_sequenceå’Œstd::tupleçš„é…åˆä½¿ç”¨ï¼š template \u003cstd::size_t... Is, typename F, typename T\u003e auto map_filter_tuple(F f, T\u0026 t) { return std::make_tuple(f(std::get\u003cIs\u003e(t))...); } template \u003cstd::size_t... Is, typename F, typename T\u003e auto map_filter_tuple(std::index_sequence\u003cIs...\u003e, F f, T\u0026 t) { return std::make_tuple(f(std::get\u003cIs\u003e(t))...); } template \u003ctypename S, typename F, typename T\u003e auto map_filter_tuple(F\u0026\u0026 f, T\u0026 t) { return map_filter_tuple(S{}, std::forward\u003cF\u003e(f), t); } ","date":"2023-07-12","objectID":"/posts/newfeature/:2:10","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] std::exchange ç›´æ¥çœ‹ä»£ç å§ï¼š int main() { std::vector\u003cint\u003e v; std::exchange(v, {1,2,3,4}); cout \u003c\u003c v.size() \u003c\u003c endl; for (int a : v) { cout \u003c\u003c a \u003c\u003c \" \"; } return 0; } çœ‹æ ·å­è²Œä¼¼å’Œstd::swapä½œç”¨ç›¸åŒï¼Œé‚£å®ƒä¿©æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ å¯ä»¥çœ‹ä¸‹exchangeçš„å®ç°ï¼š template\u003cclass T, class U = T\u003e constexpr T exchange(T\u0026 obj, U\u0026\u0026 new_value) { T old_value = std::move(obj); obj = std::forward\u003cU\u003e(new_value); return old_value; } å¯ä»¥çœ‹è§new_valueçš„å€¼ç»™äº†objï¼Œè€Œæ²¡æœ‰å¯¹new_valueèµ‹å€¼ï¼Œè¿™é‡Œç›¸ä¿¡æ‚¨å·²ç»çŸ¥é“äº†å®ƒå’Œswapçš„åŒºåˆ«äº†å§ï¼ ","date":"2023-07-12","objectID":"/posts/newfeature/:2:11","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++14] std::quoted C++14å¼•å…¥std::quotedç”¨äºç»™å­—ç¬¦ä¸²æ·»åŠ åŒå¼•å·ï¼Œç›´æ¥çœ‹ä»£ç ï¼š int main() { string str = \"hello world\"; cout \u003c\u003c str \u003c\u003c endl; cout \u003c\u003c std::quoted(str) \u003c\u003c endl; return 0; } ç¼–è¯‘\u0026è¾“å‡ºï¼š ~/test$ g++ test.cc -std=c++14 ~/test$ ./a.out hello world \"hello world\" ","date":"2023-07-12","objectID":"/posts/newfeature/:2:12","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"C++ 17 æ–°ç‰¹æ€§æ€»ç»“ ä¸»è¦æ–°ç‰¹æ€§å¦‚ä¸‹ï¼š æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼ ç»“æ„åŒ–ç»‘å®š if-switchè¯­å¥åˆå§‹åŒ– å†…è”å˜é‡ æŠ˜å è¡¨è¾¾å¼ constexpr lambdaè¡¨è¾¾å¼ namespaceåµŒå¥— __has_includeé¢„å¤„ç†è¡¨è¾¾å¼ åœ¨lambdaè¡¨è¾¾å¼ç”¨*thisæ•è·å¯¹è±¡å‰¯æœ¬ æ–°å¢Attribute å­—ç¬¦ä¸²è½¬æ¢ std::variant std::optional std::any std::apply std::make_from_tuple as_const std::string_view file_system std::shared_mutex ","date":"2023-07-12","objectID":"/posts/newfeature/:3:0","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼ åœ¨C++17å‰æ„é€ ä¸€ä¸ªæ¨¡æ¿ç±»å¯¹è±¡éœ€è¦æŒ‡æ˜ç±»å‹ï¼š pair\u003cint, double\u003e p(1, 2.2); // before c++17 C++17å°±ä¸éœ€è¦ç‰¹æ®ŠæŒ‡å®šï¼Œç›´æ¥å¯ä»¥æ¨å¯¼å‡ºç±»å‹ï¼Œä»£ç å¦‚ä¸‹ï¼š pair p(1, 2.2); // c++17 è‡ªåŠ¨æ¨å¯¼ vector v = {1, 2, 3}; // c++17 ","date":"2023-07-12","objectID":"/posts/newfeature/:3:1","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] ç»“æ„åŒ–ç»‘å®š é€šè¿‡ç»“æ„åŒ–ç»‘å®šï¼Œå¯¹äºtupleã€mapç­‰ç±»å‹ï¼Œè·å–ç›¸åº”å€¼ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œçœ‹ä»£ç ï¼š std::tuple\u003cint, double\u003e func() { return std::tuple(1, 2.2); } int main() { auto[i, d] = func(); //æ˜¯C++11çš„tieå—ï¼Ÿæ›´é«˜çº§ cout \u003c\u003c i \u003c\u003c endl; cout \u003c\u003c d \u003c\u003c endl; } //========================== void f() { map\u003cint, string\u003e m = { {0, \"a\"}, {1, \"b\"}, }; for (const auto \u0026[i, s] : m) { cout \u003c\u003c i \u003c\u003c \" \" \u003c\u003c s \u003c\u003c endl; } } // ==================== int main() { std::pair a(1, 2.3f); auto[i, f] = a; cout \u003c\u003c i \u003c\u003c endl; // 1 cout \u003c\u003c f \u003c\u003c endl; // 2.3f return 0; } ç»“æ„åŒ–ç»‘å®šè¿˜å¯ä»¥æ”¹å˜å¯¹è±¡çš„å€¼ï¼Œä½¿ç”¨å¼•ç”¨å³å¯ï¼š // è¿›åŒ–ï¼Œå¯ä»¥é€šè¿‡ç»“æ„åŒ–ç»‘å®šæ”¹å˜å¯¹è±¡çš„å€¼ int main() { std::pair a(1, 2.3f); auto\u0026 [i, f] = a; i = 2; cout \u003c\u003c a.first \u003c\u003c endl; // 2 } æ³¨æ„ç»“æ„åŒ–ç»‘å®šä¸èƒ½åº”ç”¨äºconstexpr constexpr auto[x, y] = std::pair(1, 2.3f); // compile error, C++20å¯ä»¥ ç»“æ„åŒ–ç»‘å®šä¸æ­¢å¯ä»¥ç»‘å®špairå’Œtupleï¼Œè¿˜å¯ä»¥ç»‘å®šæ•°ç»„å’Œç»“æ„ä½“ç­‰ int array[3] = {1, 2, 3}; auto [a, b, c] = array; cout \u003c\u003c a \u003c\u003c \" \" \u003c\u003c b \u003c\u003c \" \" \u003c\u003c c \u003c\u003c endl; // æ³¨æ„è¿™é‡Œçš„structçš„æˆå‘˜ä¸€å®šè¦æ˜¯publicçš„ struct Point { int x; int y; }; Point func() { return {1, 2}; } const auto [x, y] = func(); è¿™é‡Œå…¶å®å¯ä»¥å®ç°è‡ªå®šä¹‰ç±»çš„ç»“æ„åŒ–ç»‘å®šï¼Œä»£ç å¦‚ä¸‹ï¼š // éœ€è¦å®ç°ç›¸å…³çš„tuple_sizeå’Œtuple_elementå’Œget\u003cN\u003eæ–¹æ³•ã€‚ class Entry { public: void Init() { name_ = \"name\"; age_ = 10; } std::string GetName() const { return name_; } int GetAge() const { return age_; } private: std::string name_; int age_; }; template \u003csize_t I\u003e auto get(const Entry\u0026 e) { if constexpr (I == 0) return e.GetName(); else if constexpr (I == 1) return e.GetAge(); } namespace std { template\u003c\u003e struct tuple_size\u003cEntry\u003e : integral_constant\u003csize_t, 2\u003e {}; template\u003c\u003e struct tuple_element\u003c0, Entry\u003e { using type = std::string; }; template\u003c\u003e struct tuple_element\u003c1, Entry\u003e { using type = int; }; } int main() { Entry e; e.Init(); auto [name, age] = e; cout \u003c\u003c name \u003c\u003c \" \" \u003c\u003c age \u003c\u003c endl; // name 10 return 0; } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:2","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] if-switchè¯­å¥åˆå§‹åŒ– C++17å‰ifè¯­å¥éœ€è¦è¿™æ ·å†™ä»£ç ï¼š int a = GetValue(); if (a \u003c 101) { cout \u003c\u003c a; } C++17ä¹‹åå¯ä»¥è¿™æ ·ï¼š // if (init; condition) if (int a = GetValue()); a \u003c 101) { cout \u003c\u003c a; } string str = \"Hi World\"; if (auto [pos, size] = pair(str.find(\"Hi\"), str.size()); pos != string::npos) { std::cout \u003c\u003c pos \u003c\u003c \" Hello, size is \" \u003c\u003c size; } ä½¿ç”¨è¿™ç§æ–¹å¼å¯ä»¥å°½å¯èƒ½çº¦æŸä½œç”¨åŸŸï¼Œè®©ä»£ç æ›´ç®€æ´ï¼Œå¯è¯»æ€§å¯èƒ½ç•¥æœ‰ä¸‹é™ï¼Œä½†æ˜¯è¿˜å¥½ ","date":"2023-07-12","objectID":"/posts/newfeature/:3:3","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] å†…è”å˜é‡ C++17å‰åªæœ‰å†…è”å‡½æ•°ï¼Œç°åœ¨æœ‰äº†å†…è”å˜é‡ï¼Œæˆ‘ä»¬å°è±¡ä¸­C++ç±»çš„é™æ€æˆå‘˜å˜é‡åœ¨å¤´æ–‡ä»¶ä¸­æ˜¯ä¸èƒ½åˆå§‹åŒ–çš„ï¼Œä½†æ˜¯æœ‰äº†å†…è”å˜é‡ï¼Œå°±å¯ä»¥è¾¾åˆ°æ­¤ç›®çš„ï¼š // header file struct A { static const int value; }; inline int const A::value = 10; // ==========æˆ–è€…======== struct A { inline static const int value = 10; } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:4","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] æŠ˜å è¡¨è¾¾å¼ C++17å¼•å…¥äº†æŠ˜å è¡¨è¾¾å¼ä½¿å¯å˜å‚æ•°æ¨¡æ¿ç¼–ç¨‹æ›´æ–¹ä¾¿ï¼š template \u003ctypename ... Ts\u003e auto sum(Ts ... ts) { return (ts + ...); } int a {sum(1, 2, 3, 4, 5)}; // 15 std::string a{\"hello \"}; std::string b{\"world\"}; cout \u003c\u003c sum(a, b) \u003c\u003c endl; // hello world ","date":"2023-07-12","objectID":"/posts/newfeature/:3:5","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] constexpr lambdaè¡¨è¾¾å¼ C++17å‰lambdaè¡¨è¾¾å¼åªèƒ½åœ¨è¿è¡Œæ—¶ä½¿ç”¨ï¼ŒC++17å¼•å…¥äº†constexpr lambdaè¡¨è¾¾å¼ï¼Œå¯ä»¥ç”¨äºåœ¨ç¼–è¯‘æœŸè¿›è¡Œè®¡ç®—ã€‚ int main() { // c++17å¯ç¼–è¯‘ constexpr auto lamb = [] (int n) { return n * n; }; static_assert(lamb(3) == 9, \"a\"); } æ³¨æ„ï¼šconstexprå‡½æ•°æœ‰å¦‚ä¸‹é™åˆ¶ï¼š å‡½æ•°ä½“ä¸èƒ½åŒ…å«æ±‡ç¼–è¯­å¥ã€gotoè¯­å¥ã€labelã€tryå—ã€é™æ€å˜é‡ã€çº¿ç¨‹å±€éƒ¨å­˜å‚¨ã€æ²¡æœ‰åˆå§‹åŒ–çš„æ™®é€šå˜é‡ï¼Œä¸èƒ½åŠ¨æ€åˆ†é…å†…å­˜ï¼Œä¸èƒ½æœ‰new deleteç­‰ï¼Œä¸èƒ½è™šå‡½æ•°ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:3:6","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] namespaceåµŒå¥— namespace A { namespace B { namespace C { void func(); } } } // c++17ï¼Œæ›´æ–¹ä¾¿æ›´èˆ’é€‚ namespace A::B::C { void func();) } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:7","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] __has_includeé¢„å¤„ç†è¡¨è¾¾å¼ å¯ä»¥åˆ¤æ–­æ˜¯å¦æœ‰æŸä¸ªå¤´æ–‡ä»¶ï¼Œä»£ç å¯èƒ½ä¼šåœ¨ä¸åŒç¼–è¯‘å™¨ä¸‹å·¥ä½œï¼Œä¸åŒç¼–è¯‘å™¨çš„å¯ç”¨å¤´æ–‡ä»¶æœ‰å¯èƒ½ä¸åŒï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ­¤æ¥åˆ¤æ–­ï¼š #if defined __has_include #if __has_include(\u003ccharconv\u003e) #define has_charconv 1 #include \u003ccharconv\u003e #endif #endif std::optional\u003cint\u003e ConvertToInt(const std::string\u0026 str) { int value{}; #ifdef has_charconv const auto last = str.data() + str.size(); const auto res = std::from_chars(str.data(), last, value); if (res.ec == std::errc{} \u0026\u0026 res.ptr == last) return value; #else // alternative implementation... å…¶å®ƒæ–¹å¼å®ç° #endif return std::nullopt; } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:8","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] åœ¨lambdaè¡¨è¾¾å¼ç”¨*thisæ•è·å¯¹è±¡å‰¯æœ¬ æ­£å¸¸æƒ…å†µä¸‹ï¼Œlambdaè¡¨è¾¾å¼ä¸­è®¿é—®ç±»çš„å¯¹è±¡æˆå‘˜å˜é‡éœ€è¦æ•è·thisï¼Œä½†æ˜¯è¿™é‡Œæ•è·çš„æ˜¯thisæŒ‡é’ˆï¼ŒæŒ‡å‘çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯èƒ½æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœå¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå‡½æ•°çš„ä½œç”¨åŸŸè¶…è¿‡äº†å¯¹è±¡çš„ä½œç”¨åŸŸï¼Œå¯¹è±¡å·²ç»è¢«ææ„äº†ï¼Œè¿˜è®¿é—®äº†æˆå‘˜å˜é‡ï¼Œå°±ä¼šæœ‰é—®é¢˜ã€‚ struct A { int a; void func() { auto f = [this] { cout \u003c\u003c a \u003c\u003c endl; }; f(); } }; int main() { A a; a.func(); return 0; } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:9","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] æ‰€ä»¥C++17å¢åŠ äº†æ–°ç‰¹æ€§ï¼Œæ•è·*thisï¼Œä¸æŒæœ‰thisæŒ‡é’ˆï¼Œè€Œæ˜¯æŒæœ‰å¯¹è±¡çš„æ‹·è´ï¼Œè¿™æ ·ç”Ÿå‘½å‘¨æœŸå°±ä¸å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸ç›¸å…³å•¦ã€‚ struct A { int a; void func() { auto f = [*this] { // è¿™é‡Œ cout \u003c\u003c a \u003c\u003c endl; }; f(); } }; int main() { A a; a.func(); return 0; } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:10","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] æ–°å¢Attribute æˆ‘ä»¬å¯èƒ½å¹³æ—¶åœ¨é¡¹ç›®ä¸­è§è¿‡__declspec, attribute , #pragmaæŒ‡ç¤ºç¬¦ï¼Œä½¿ç”¨å®ƒä»¬æ¥ç»™ç¼–è¯‘å™¨æä¾›ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œæ¥äº§ç”Ÿä¸€äº›ä¼˜åŒ–æˆ–ç‰¹å®šçš„ä»£ç ï¼Œä¹Ÿå¯ä»¥ç»™å…¶å®ƒå¼€å‘è€…ä¸€äº›æç¤ºä¿¡æ¯ã€‚ ä¾‹å¦‚: struct A { short f[3]; } __attribute__((aligned(8))); void fatal() __attribute__((noreturn)); åœ¨C++11å’ŒC++14ä¸­æœ‰æ›´æ–¹ä¾¿çš„æ–¹æ³•ï¼š [[carries_dependency]] è®©ç¼–è¯‘æœŸè·³è¿‡ä¸å¿…è¦çš„å†…å­˜æ …æ æŒ‡ä»¤ [[noreturn]] å‡½æ•°ä¸ä¼šè¿”å› [[deprecated]] å‡½æ•°å°†å¼ƒç”¨çš„è­¦å‘Š [[noreturn]] void terminate() noexcept; [[deprecated(\"use new func instead\")]] void func() {} C++17åˆæ–°å¢äº†ä¸‰ä¸ªï¼š [[fallthrough]]ï¼Œç”¨åœ¨switchä¸­æç¤ºå¯ä»¥ç›´æ¥è½ä¸‹å»ï¼Œä¸éœ€è¦breakï¼Œè®©ç¼–è¯‘æœŸå¿½ç•¥è­¦å‘Š switch (i) {} case 1: xxx; // warning case 2: xxx; [[fallthrough]]; // è­¦å‘Šæ¶ˆé™¤ case 3: xxx; break; } ä½¿å¾—ç¼–è¯‘å™¨å’Œå…¶å®ƒå¼€å‘è€…éƒ½å¯ä»¥ç†è§£å¼€å‘è€…çš„æ„å›¾ã€‚ [[nodiscard]] ï¼šè¡¨ç¤ºä¿®é¥°çš„å†…å®¹ä¸èƒ½è¢«å¿½ç•¥ï¼Œå¯ç”¨äºä¿®é¥°å‡½æ•°ï¼Œæ ‡æ˜è¿”å›å€¼ä¸€å®šè¦è¢«å¤„ç† [[nodiscard]] int func(); void F() { func(); // warning æ²¡æœ‰å¤„ç†å‡½æ•°è¿”å›å€¼ } [[maybe_unused]] ï¼šæç¤ºç¼–è¯‘å™¨ä¿®é¥°çš„å†…å®¹å¯èƒ½æš‚æ—¶æ²¡æœ‰ä½¿ç”¨ï¼Œé¿å…äº§ç”Ÿè­¦å‘Š void func1() {} [[maybe_unused]] void func2() {} // è­¦å‘Šæ¶ˆé™¤ void func3() { int x = 1; [[maybe_unused]] int y = 2; // è­¦å‘Šæ¶ˆé™¤ } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:11","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] å­—ç¬¦ä¸²è½¬æ¢ æ–°å¢from_charså‡½æ•°å’Œto_charså‡½æ•°ï¼Œç›´æ¥çœ‹ä»£ç ï¼š #include \u003ccharconv\u003e int main() { const std::string str{\"123456098\"}; int value = 0; const auto res = std::from_chars(str.data(), str.data() + 4, value); if (res.ec == std::errc()) { cout \u003c\u003c value \u003c\u003c \", distance \" \u003c\u003c res.ptr - str.data() \u003c\u003c endl; } else if (res.ec == std::errc::invalid_argument) { cout \u003c\u003c \"invalid\" \u003c\u003c endl; } str = std::string(\"12.34); double val = 0; const auto format = std::chars_format::general; res = std::from_chars(str.data(), str.data() + str.size(), value, format); str = std::string(\"xxxxxxxx\"); const int v = 1234; res = std::to_chars(str.data(), str.data() + str.size(), v); cout \u003c\u003c str \u003c\u003c \", filled \" \u003c\u003c res.ptr - str.data() \u003c\u003c \" characters \\n\"; // 1234xxxx, filled 4 characters } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:12","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] std::variant C++17å¢åŠ std::variantå®ç°ç±»ä¼¼unionçš„åŠŸèƒ½ï¼Œä½†å´æ¯”unionæ›´é«˜çº§ï¼Œä¸¾ä¸ªä¾‹å­unioné‡Œé¢ä¸èƒ½æœ‰stringè¿™ç§ç±»å‹ï¼Œä½†std::variantå´å¯ä»¥ï¼Œè¿˜å¯ä»¥æ”¯æŒæ›´å¤šå¤æ‚ç±»å‹ï¼Œå¦‚mapç­‰ï¼Œçœ‹ä»£ç ï¼š int main() { // c++17å¯ç¼–è¯‘ std::variant\u003cint, std::string\u003e var(\"hello\"); cout \u003c\u003c var.index() \u003c\u003c endl; var = 123; cout \u003c\u003c var.index() \u003c\u003c endl; try { var = \"world\"; std::string str = std::get\u003cstd::string\u003e(var); // é€šè¿‡ç±»å‹è·å–å€¼ var = 3; int i = std::get\u003c0\u003e(var); // é€šè¿‡indexè·å–å¯¹åº”å€¼ cout \u003c\u003c str \u003c\u003c endl; cout \u003c\u003c i \u003c\u003c endl; } catch(...) { // xxx; } return 0; } æ³¨æ„ï¼šä¸€èˆ¬æƒ…å†µä¸‹variantçš„ç¬¬ä¸€ä¸ªç±»å‹ä¸€èˆ¬è¦æœ‰å¯¹åº”çš„æ„é€ å‡½æ•°ï¼Œå¦åˆ™ç¼–è¯‘å¤±è´¥ï¼š struct A { A(int i){} }; int main() { std::variant\u003cA, int\u003e var; // ç¼–è¯‘å¤±è´¥ } å¦‚ä½•é¿å…è¿™ç§æƒ…å†µå‘¢ï¼Œå¯ä»¥ä½¿ç”¨std::monostateæ¥æ‰“ä¸ªæ¡©ï¼Œæ¨¡æ‹Ÿä¸€ä¸ªç©ºçŠ¶æ€ã€‚ std::variant\u003cstd::monostate, A\u003e var; // å¯ä»¥ç¼–è¯‘æˆåŠŸ ","date":"2023-07-12","objectID":"/posts/newfeature/:3:13","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] std::optional æˆ‘ä»¬æœ‰æ—¶å€™å¯èƒ½ä¼šæœ‰éœ€æ±‚ï¼Œè®©å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š struct A {}; A func() { if (flag) return A(); else { // å¼‚å¸¸æƒ…å†µä¸‹ï¼Œæ€ä¹ˆè¿”å›å¼‚å¸¸å€¼å‘¢ï¼Œæƒ³è¿”å›ä¸ªç©ºå‘¢ } } æœ‰ä¸€ç§åŠæ³•æ˜¯è¿”å›å¯¹è±¡æŒ‡é’ˆï¼Œå¼‚å¸¸æƒ…å†µä¸‹å°±å¯ä»¥è¿”å›nullptrå•¦ï¼Œä½†æ˜¯è¿™å°±æ¶‰åŠåˆ°äº†å†…å­˜ç®¡ç†ï¼Œä¹Ÿè®¸ä½ ä¼šä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œä½†è¿™é‡Œå…¶å®æœ‰æ›´æ–¹ä¾¿çš„åŠæ³•å°±æ˜¯std::optionalã€‚ std::optional\u003cint\u003e StoI(const std::string \u0026s) { try { return std::stoi(s); } catch(...) { return std::nullopt; } } void func() { std::string s{\"123\"}; std::optional\u003cint\u003e o = StoI(s); if (o) { cout \u003c\u003c *o \u003c\u003c endl; } else { cout \u003c\u003c \"error\" \u003c\u003c endl; } } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:14","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] std::any C++17å¼•å…¥äº†anyå¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å•ä¸ªå€¼ï¼Œè§ä»£ç ï¼š int main() { // c++17å¯ç¼–è¯‘ std::any a = 1; cout \u003c\u003c a.type().name() \u003c\u003c \" \" \u003c\u003c std::any_cast\u003cint\u003e(a) \u003c\u003c endl; a = 2.2f; cout \u003c\u003c a.type().name() \u003c\u003c \" \" \u003c\u003c std::any_cast\u003cfloat\u003e(a) \u003c\u003c endl; if (a.has_value()) { cout \u003c\u003c a.type().name(); } a.reset(); if (a.has_value()) { cout \u003c\u003c a.type().name(); } a = std::string(\"a\"); cout \u003c\u003c a.type().name() \u003c\u003c \" \" \u003c\u003c std::any_cast\u003cstd::string\u003e(a) \u003c\u003c endl; return 0; } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:15","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] std::apply ä½¿ç”¨std::applyå¯ä»¥å°†tupleå±•å¼€ä½œä¸ºå‡½æ•°çš„å‚æ•°ä¼ å…¥ï¼Œè§ä»£ç ï¼š int add(int first, int second) { return first + second; } auto add_lambda = [](auto first, auto second) { return first + second; }; int main() { std::cout \u003c\u003c std::apply(add, std::pair(1, 2)) \u003c\u003c '\\n'; std::cout \u003c\u003c add(std::pair(1, 2)) \u003c\u003c \"\\n\"; // error std::cout \u003c\u003c std::apply(add_lambda, std::tuple(2.0f, 3.0f)) \u003c\u003c '\\n'; } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:16","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] std::make_from_tuple ä½¿ç”¨make_from_tupleå¯ä»¥å°†tupleå±•å¼€ä½œä¸ºæ„é€ å‡½æ•°å‚æ•° struct Foo { Foo(int first, float second, int third) { std::cout \u003c\u003c first \u003c\u003c \", \" \u003c\u003c second \u003c\u003c \", \" \u003c\u003c third \u003c\u003c \"\\n\"; } }; int main() { auto tuple = std::make_tuple(42, 3.14f, 0); std::make_from_tuple\u003cFoo\u003e(std::move(tuple)); } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:17","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] std::string_view é€šå¸¸æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªstringæ—¶ä¼šè§¦å‘å¯¹è±¡çš„æ‹·è´æ“ä½œï¼Œå¤§å­—ç¬¦ä¸²çš„æ‹·è´èµ‹å€¼æ“ä½œä¼šè§¦å‘å †å†…å­˜åˆ†é…ï¼Œå¾ˆå½±å“è¿è¡Œæ•ˆç‡ï¼Œæœ‰äº†string_viewå°±å¯ä»¥é¿å…æ‹·è´æ“ä½œï¼Œå¹³æ—¶ä¼ é€’è¿‡ç¨‹ä¸­ä¼ é€’string_viewå³å¯ã€‚ void func(std::string_view stv) { cout \u003c\u003c stv \u003c\u003c endl; } int main(void) { std::string str = \"Hello World\"; std::cout \u003c\u003c str \u003c\u003c std::endl; std::string_view stv(str.c_str(), str.size()); cout \u003c\u003c stv \u003c\u003c endl; func(stv); return 0; } ","date":"2023-07-12","objectID":"/posts/newfeature/:3:18","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] as_const C++17ä½¿ç”¨as_constå¯ä»¥å°†å·¦å€¼è½¬æˆconstç±»å‹ std::string str = \"str\"; const std::string\u0026 constStr = std::as_const(str); ","date":"2023-07-12","objectID":"/posts/newfeature/:3:19","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] file_system C++17æ­£å¼å°†file_systemçº³å…¥æ ‡å‡†ä¸­ï¼Œæä¾›äº†å…³äºæ–‡ä»¶çš„å¤§å¤šæ•°åŠŸèƒ½ï¼ŒåŸºæœ¬ä¸Šåº”æœ‰å°½æœ‰ï¼Œè¿™é‡Œç®€å•ä¸¾å‡ ä¸ªä¾‹å­ï¼š namespace fs = std::filesystem; fs::create_directory(dir_path); fs::copy_file(src, dst, fs::copy_options::skip_existing); fs::exists(filename); fs::current_path(err_code); ","date":"2023-07-12","objectID":"/posts/newfeature/:3:20","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++17] std::shared_mutex C++17å¼•å…¥äº†shared_mutexï¼Œå¯ä»¥å®ç°è¯»å†™é” ","date":"2023-07-12","objectID":"/posts/newfeature/:3:21","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"C++ 20 æ–°ç‰¹æ€§æ€»ç»“ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:0","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] æ–°å¢å…³é”®å­—(keywords) concept requires constinit consteval co_await co_return co_yield char8_t ","date":"2023-07-12","objectID":"/posts/newfeature/:4:1","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] æ–°å¢æ ‡è¯†ç¬¦(Identifies) import module ","date":"2023-07-12","objectID":"/posts/newfeature/:4:2","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] æ¨¡å—(Modules) ä¼˜ç‚¹ æ²¡æœ‰å¤´æ–‡ä»¶ å£°æ˜å®ç°ä»ç„¶å¯åˆ†ç¦», ä½†éå¿…è¦ å¯ä»¥æ˜¾å¼æŒ‡å®šé‚£äº›å¯¼å‡º(ç±», å‡½æ•°ç­‰) ä¸éœ€è¦å¤´æ–‡ä»¶é‡å¤å¼•å…¥å® (include guards) æ¨¡å—ä¹‹é—´åç§°å¯ä»¥ç›¸åŒä¸ä¼šå†²çª æ¨¡å—åªå¤„ç†ä¸€æ¬¡, ç¼–è¯‘æ›´å¿« (å¤´æ–‡ä»¶æ¯æ¬¡å¼•å…¥éƒ½éœ€è¦å¤„ç†) é¢„å¤„ç†å®åªåœ¨æ¨¡å—å†…æœ‰æ•ˆ æ¨¡å—å¼•å…¥é¡ºåºæ— å…³ç´§è¦ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:3","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] åˆ›å»ºæ¨¡å— // cppcon.cpp export module cppcon; namespace CppCon { auto GetWelcomeHelper() { return \"Welcome to CppCon 2019!\"; } export auto GetWelcome() { return GetWelcomeHelper();} } ","date":"2023-07-12","objectID":"/posts/newfeature/:4:4","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] å¼•ç”¨æ¨¡å— // main.cpp import cppcon; int main(){ std::cout \u003c\u003c CppCon::GetWelcome(); } ","date":"2023-07-12","objectID":"/posts/newfeature/:4:5","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] import å¤´æ–‡ä»¶ import éšå¼åœ°å°† iostream è½¬æ¢ä¸ºæ¨¡å— åŠ é€Ÿæ„å»º, å› ä¸º iostream åªä¼šå¤„ç†ä¸€æ¬¡ å’Œé¢„ç¼–è¯‘å¤´ (PCH) å…·æœ‰ç›¸ä¼¼çš„æ•ˆæœ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:6","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] Ranges Ranges æ˜¯ä»€ä¹ˆ ? Range ä»£è¡¨ä¸€ä¸²å…ƒç´ , æˆ–è€…ä¸€ä¸²å…ƒç´ ä¸­çš„ä¸€æ®µï¼Œç±»ä¼¼ begin/end å¯¹ å¥½å¤„: ç®€åŒ–è¯­æ³•å’Œæ–¹ä¾¿ä½¿ç”¨ vector\u003cint\u003e data{11, 22, 33}; sort(begin(data), end(data)); sort(data); // ä½¿ç”¨ Ranges é˜²æ­¢ begin/end ä¸é…å¯¹ ä½¿å˜æ¢/è¿‡æ»¤ç­‰ä¸²è”æ“ä½œæˆä¸ºå¯èƒ½ ç›¸å…³åŠŸèƒ½ è§†å›¾(View): å»¶è¿Ÿè®¡ç®—, ä¸æŒæœ‰, ä¸æ”¹å†™ Actions: å³æ—¶å¤„ç†(eagerly evaluated), æ”¹å†™ Algorithms: æ‰€æœ‰æ¥å— begin/end å¯¹çš„ç®—æ³•éƒ½å¯ç”¨ Views å’Œ actions ä½¿ç”¨ç®¡é“ç¬¦|ä¸²è” ä¾‹å­ ä¸²è”è§†å›¾ vector\u003cint\u003e data {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; auto result = data | views::remove_if([](int i) { return i % 2 == 1;}) | views::transform([](int i) { return to_string(i);}); // result = {\"2\", \"4\", \"6\", \"8\", \"10\" }; // æ³¨æ„ ä»¥ä¸Šæ“ä½œè¢«å»¶è¿Ÿ, å½“ä½ éå†resultçš„æ—¶å€™æ‰è§¦å‘ ä¸²è”actions vector\u003cint\u003e data{4, 3, 4, 1, 8, 0, 8}; vector\u003cint\u003e result = data | actions::sort | actions::unique; æ’åºç„¶åå»é‡ æ“ä½œä¼šåŸåœ°å¯¹dataè¿›è¡Œæ›´æ”¹, ç„¶åè¿”å› è¿‡æ»¤å’Œå˜æ¢ int total = accumulate ( view::ints(1) | view::transform([](int i) {return i * i;}) | view::take(10), 0); view::ints(1) äº§ç”Ÿä¸€ä¸ªæ— é™çš„æ•´å‹æ•°åˆ— å¹³æ–¹ å–å‰10ä¸ªå…ƒç´ , ç„¶åç´¯åŠ (accumulate) æ‰€æœ‰çš„è®¡ç®—å»¶è¿Ÿåˆ°accumulateç´¯åŠ éå†çš„æ—¶å€™å‘ç”Ÿ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:7","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] åç¨‹(Coroutines) ä»€ä¹ˆæ˜¯åç¨‹ å®ƒæ˜¯ä¸€ä¸ªå‡½æ•° å…·å¤‡å¦‚ä¸‹å…³é”®å­—ä¹‹ä¸€: co_wait: æŒ‚èµ·åç¨‹, ç­‰å¾…å…¶å®ƒè®¡ç®—å®Œæˆ co_return: ä»åç¨‹è¿”å› (åç¨‹ return ç¦æ­¢ä½¿ç”¨) co_yield: åŒ python yield, å¼¹å‡ºä¸€ä¸ªå€¼, æŒ‚èµ·åç¨‹, ä¸‹ä¸€æ¬¡è°ƒç”¨ç»§ç»­åç¨‹çš„è¿è¡Œ for co_await å¾ªç¯ä½“ for co_await (for-range-declaration: expression) statement ç”¨å¤„ ç®€åŒ–å¦‚ä¸‹é—®é¢˜çš„å®ç°: generator å¼‚æ­¥I/O å»¶è¿Ÿè®¡ç®— äº‹ä»¶é©±åŠ¨çš„ç¨‹åº ä¾‹å­ experimental::generator\u003cint\u003e GetSequenceGenerator( int startValue, size_t numberOfValues) { for (int i = 0 startValue; i \u003c startValue + numberOfValues; ++i){ time_t t = system_clock::to_time_t(system_clock::now()); cout \u003c\u003c std:: ctime(\u0026t); co_yield i; } } int main() { auto gen = GetSequenceGenerator(10, 5); for (const auto\u0026 value : gen) { cout \u003c\u003c value \u003c\u003c \"(Press enter for next value)\" \u003c\u003c endl; cin.ignore(); } } ","date":"2023-07-12","objectID":"/posts/newfeature/:4:8","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] Concepts å¯¹æ¨¡æ¿ç±»å’Œå‡½æ•°çš„æ¨¡æ¿å½¢å‚çš„çº¦æŸ ç¼–è¯‘æœŸæ–­è¨€ å¯å£°æ˜å¤šä¸ª å¦‚ä½•å®šä¹‰ template\u003ctypename T\u003e concept Incrementable = requires(T x) {x++; ++x;}; ä½¿ç”¨ template\u003cIncrementable T\u003e void Foo(T t); template\u003ctypename T\u003e requires Incrementable\u003cT\u003e void Foo(T t); template\u003ctypename T\u003e void Foo(T t) requires Incrementable\u003cT\u003e; void Foo(Incrementable auto t); ä¾‹å­ å…·å¤‡size() æ–¹æ³•, ä¸”è¿”å›size_t template \u003ctypename T\u003e concept HasSize = requires (T x){ {x.size()} -\u003e std::convertible_to\u003cstd::size_t\u003e; }; ç»„åˆconcept template\u003ctypename T\u003e requires Incrementable\u003cT\u003e \u0026\u0026 Decrementable\u003cT\u003e void Foo(T t); // or template\u003ctypename T\u003e concept Incr_Decrementable = Incrementable\u003cT\u003e \u0026\u0026 Decrementable\u003cT\u003e; template\u003cIncr_Decrementable T\u003e void Foo(T t); ","date":"2023-07-12","objectID":"/posts/newfeature/:4:9","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] Lambda è¡¨è¾¾å¼çš„æ›´æ–° [=, this] éœ€è¦æ˜¾å¼æ•è·thiså˜é‡ C++20 ä¹‹å‰ [=] éšå¼æ•è·this C++20 å¼€å§‹ éœ€è¦æ˜¾å¼æ•è·this: [=, this] æ¨¡æ¿å½¢å¼çš„ Lambda è¡¨è¾¾å¼ å¯ä»¥åœ¨lambdaè¡¨è¾¾å¼ä¸­ä½¿ç”¨æ¨¡æ¿è¯­æ³• []template\u003cT\u003e(T x) {/* ... */}; []template\u003cT\u003e(T* p) {/* ... */}; []template\u003cT, int N\u003e(T (\u0026a)[N]) {/* ... */}; åŸå› 1 C++20ä¹‹å‰: è·å– vector å…ƒç´ ç±»å‹, ä½ éœ€è¦è¿™ä¹ˆå†™ auto func = [](auto vec){ using T = typename decltype(vec)::value_type; } C++20 ä½ å¯ä»¥: auto func = []\u003ctypename T\u003e(vector\u003cT\u003e vec){ // ... } åŸå› 2: æ–¹ä¾¿è·å–é€šç”¨lambdaå½¢å‚ç±»å‹, è®¿é—®é™æ€å‡½æ•° c++20 ä»¥å‰ auto func = [](auto const\u0026 x){ using T = std::decay_t\u003cdecltype(x)\u003e; T copy = x; T::static_function(); using Iterator = typename T::iterator; } C++20 å¼€å§‹ auto func = []\u003ctypename T\u003e(const T\u0026 x){ T copy = x; T::static_function(); using Iterator = typename T::iterator; } åŸå› 3: å®Œç¾è½¬å‘ pre c++20 auto func = [](auto\u0026\u0026 ...args) { return foo(std::forward\u003cdecltype(args)\u003e(args)...); } since c++20 auto func = []\u003ctypename â€¦T\u003e(T\u0026\u0026 â€¦args){ return foo(std::forward(args)...); } Lambda è¡¨è¾¾å¼æ•è·æ”¯æŒæ‰“åŒ…å±•å¼€(Pack Expansion) Pre C++20 template\u003cclass F, class... Args\u003e auto delay_invoke(F f, Args... args){ return [f, args...]{ return std::invoke(f, args...); } } Since c++20 template\u003cclass F, class... Args\u003e auto delay_invoke(F f, Args... args){ // Pack Expansion: args = std::move(args)... return [f = std::move(f), args = std::move(args)...](){ return std::invoke(f, args...); } } ","date":"2023-07-12","objectID":"/posts/newfeature/:4:10","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] å¸¸é‡è¡¨è¾¾å¼(constexpr) çš„æ›´æ–° constexpr è™šå‡½æ•° constexpr çš„è™šå‡½æ•°å¯ä»¥é‡å†™é constexpr çš„è™šå‡½æ•° é constexpr è™šå‡½æ•°å¯ä»¥é‡å†™ constexpr çš„è™šå‡½æ•° constexpr å‡½æ•°å¯ä»¥: ä½¿ç”¨ dynamic_cast() å’Œ typeid åŠ¨æ€å†…å­˜åˆ†é… æ›´æ”¹unionæˆå‘˜çš„å€¼ åŒ…å« try/catch ä½†æ˜¯ä¸å…è®¸****throwè¯­å¥ åœ¨è§¦å‘å¸¸é‡æ±‚å€¼çš„æ—¶å€™ try/catch ä¸å‘ç”Ÿä½œç”¨ éœ€è¦å¼€å¯ constexpr std::vector constexpr string \u0026 vector - std::string å’Œ std::vector ç±»å‹ç°åœ¨å¯ä»¥ä½œä¸º constexpr - æœªæ¥éœ€è¦æ”¯æŒ constexpr åå°„ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:11","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] åŸå­(Atomic)æ™ºèƒ½æŒ‡é’ˆ æ™ºèƒ½æŒ‡é’ˆ(shared_ptr)çº¿ç¨‹å®‰å…¨å—? æ˜¯: å¼•ç”¨è®¡æ•°æ§åˆ¶å•å…ƒçº¿ç¨‹å®‰å…¨, ä¿è¯å¯¹è±¡åªè¢«é‡Šæ”¾ä¸€æ¬¡ å¦: å¯¹äºæ•°æ®çš„è¯»å†™æ²¡æœ‰çº¿ç¨‹å®‰å…¨ å¦‚ä½•å°†æ™ºèƒ½æŒ‡é’ˆå˜æˆçº¿ç¨‹å®‰å…¨? ä½¿ç”¨ mutex æ§åˆ¶æ™ºèƒ½æŒ‡é’ˆçš„è®¿é—® ä½¿ç”¨å…¨å±€éæˆå‘˜åŸå­æ“ä½œå‡½æ•°è®¿é—®, è¯¸å¦‚: std::atomic_load(), atomic_store(), â€¦ ç¼ºç‚¹: å®¹æ˜“å‡ºé”™, å¿˜è®°ä½¿ç”¨è¿™äº›æ“ä½œ C++20: atomic\u003cshared_ptr\u003e, atomic\u003cweak_ptr\u003e å†…éƒ¨åŸç†å¯èƒ½ä½¿ç”¨äº†mutex å…¨å±€éæˆå‘˜åŸå­æ“ä½œå‡½æ•°æ ‡è®°ä¸ºä¸æ¨èä½¿ç”¨(deprecated) ä¾‹å­ template\u003ctypename T\u003e class concurrent_stack { struct Node { T t; shared_ptr\u003cNode\u003e next; }; atomic_shared_ptr\u003cNode\u003e head; // C++11: å»æ‰ \"atomic_\" å¹¶ä¸”åœ¨è®¿é—®æ—¶, éœ€è¦ç”¨ // ç‰¹æ®Šçš„å‡½æ•°æ§åˆ¶çº¿ç¨‹å®‰å…¨, ä¾‹å¦‚ç”¨std::tomic_load public: class reference { shared_ptr\u003cNode\u003e p; \u003csnip\u003e }; auto find(T t) const { auto p = head.load(); // C++11: atomic_load(\u0026head) while (p \u0026\u0026 p-\u003et != t) p = p-\u003enext; return reference(move(p)); } auto front() const { return reference(head); } void push_front(T t) { auto p = make_shared\u003cNode\u003e(); p-\u003et = t; p-\u003enext = head; while (!head.compare_exchange_weak(p-\u003enext, p)){ } // C++11: atomic_compare_exchange_weak(\u0026head, \u0026p-\u003enext, p); } void pop_front() { auto p = head.load(); while (p \u0026\u0026 !head.compare_exchange_weak(p, p-\u003enext)) { } // C++11: atomic_compare_exchange_weak(\u0026head, \u0026p, p-\u003enext); } }; ","date":"2023-07-12","objectID":"/posts/newfeature/:4:12","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] è‡ªåŠ¨åˆæµ(Joining), å¯ä¸­æ–­(Cancellable) çš„çº¿ç¨‹ std::jthread å¤´æ–‡ä»¶ æ”¯æŒä¸­æ–­ ææ„å‡½æ•°ä¸­è‡ªåŠ¨ Join ææ„å‡½æ•°è°ƒç”¨ stop_source.request_stop() ç„¶å join() ä¸­æ–­çº¿ç¨‹æ‰§è¡Œ å¤´æ–‡ä»¶ \u003cstop_token\u003e std::stop_token ç”¨æ¥æŸ¥è¯¢çº¿ç¨‹æ˜¯å¦ä¸­æ–­ å¯ä»¥å’Œcondition_variable_anyé…åˆä½¿ç”¨ std::stop_source ç”¨æ¥è¯·æ±‚çº¿ç¨‹åœæ­¢è¿è¡Œ stop_resources å’Œ stop_tokens éƒ½å¯ä»¥æŸ¥è¯¢åˆ°åœæ­¢è¯·æ±‚ std::stop_callback å¦‚æœå¯¹åº”çš„stop_token è¢«è¦æ±‚ç»ˆæ­¢, å°†ä¼šè§¦å‘å›è°ƒå‡½æ•° ç”¨æ³•: std::stop_callback myCallback(myStopToken, []{ /* â€¦ */ }); ä¾‹å­ è‡ªåŠ¨åˆæµ Join std::thread åœ¨ææ„å‡½æ•°ä¸­å¦‚æœçº¿ç¨‹ joinable() ä¼šç›´æ¥è°ƒç”¨ std::terminate() ç›´æ¥å¯¼è‡´ç¨‹åºé€€å‡º void DoWorkPreCpp20() { std::thread job([] { /* ... */ }); try { // ... Do something else ... } catch (...) { job.join(); throw; // rethrow } job.join(); } void DoWork() { std::jthread job([] { /* ... */ }); // ... Do something else ... } // jthread destructor automatically calls join() ä¸­æ–­ std::jthread job([](std::stop_token token) { while (!token.stop_requested()) { //... } }); //... job.request_stop(); // auto source = job.get_stop_source() // auto token = job.get_stop_token() ","date":"2023-07-12","objectID":"/posts/newfeature/:4:13","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] C++20 åŒæ­¥(Synchronization)åº“ ä¿¡å·é‡(Semaphore), ç»´åŸºç™¾ç§‘è¯·èµ°è¿™é‡Œ å¤´æ–‡ä»¶ è½»é‡çº§çš„åŒæ­¥åŸè¯­ å¯ç”¨æ¥å®ç°ä»»ä½•å…¶ä»–åŒæ­¥æ¦‚å¿µ, å¦‚: mutex, latches, barriers, â€¦ ä¸¤ç§ç±»å‹: å¤šå…ƒä¿¡å·é‡(counting semaphore): å»ºæ¨¡éè´Ÿå€¼èµ„æºè®¡æ•° äºŒå…ƒä¿¡å·é‡(binary semaphore): åªæœ‰ä¸€ä¸ªæ’å­”, ä¸¤ç§çŠ¶æ€, æœ€é€‚åˆå®ç°mutex std::atomic ç­‰å¾…å’Œé€šçŸ¥æ¥å£ ç­‰å¾…/é˜»å¡åœ¨åŸå­å¯¹è±¡ç›´åˆ°å…¶å€¼å‘ç”Ÿæ”¹å˜, é€šè¿‡é€šçŸ¥å‡½æ•°å‘é€é€šçŸ¥ æ¯”è½®è®­(polling)æ¥çš„æ›´é«˜æ•ˆ æ–¹æ³• wait() notify_one() notify_all() é”å­˜å™¨(Latch)å’Œå±éšœ(Barrier) å¤´æ–‡ä»¶ çº¿ç¨‹çš„åŒæ­¥ç‚¹ çº¿ç¨‹å°†é˜»å¡åœ¨è¿™ä¸ªä½ç½®, ç›´åˆ°åˆ°è¾¾çš„çº¿ç¨‹ä¸ªæ•°è¾¾æ ‡æ‰æ”¾è¡Œ, æ”¾è¡Œä¹‹åä¸å†å…³é—­ é”å­˜å™¨åªä¼šä½œç”¨ä¸€æ¬¡ å±éšœ(Barriers) åœ¨æ¯ä¸ªé˜¶æ®µä¸­ ä¸€ä¸ªå‚ä¸è€…è¿è¡Œè‡³å±éšœç‚¹æ—¶è¢«é˜»å¡ï¼Œéœ€è¦ç­‰å¾…å…¶ä»–å‚ä¸è€…éƒ½åˆ°è¾¾å±éšœç‚¹, å½“åˆ°è¾¾çº¿ç¨‹æ•°è¾¾æ ‡ä¹‹å é˜¶æ®µå®Œæˆçš„å›è°ƒå°†è¢«æ‰§è¡Œ çº¿ç¨‹è®¡æ•°å™¨è¢«é‡ç½® å¼€å¯ä¸‹ä¸€é˜¶æ®µ çº¿ç¨‹å¾—ä»¥ç»§ç»­æ‰§è¡Œ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:14","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] std::atomic_ref å¤´æ–‡ä»¶ Atomic å¼•ç”¨ é€šè¿‡å¼•ç”¨è®¿é—®å˜ä¸ºåŸå­æ“ä½œ, è¢«å¼•ç”¨å¯¹è±¡å¯ä»¥ä¸ºéåŸå­ç±»å‹ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:15","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] æŒ‡å®šåˆå§‹åŒ–(Designated Initializers) struct Data { int anInt = 0; std::string aString; }; Data d{ .aString = \"Hello\" }; ","date":"2023-07-12","objectID":"/posts/newfeature/:4:16","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] èˆªå¤©é£æœºæ“ä½œç¬¦ \u003c=\u003e æ­£è§„åç§°: ä¸‰è·¯æ¯”è¾ƒè¿ç®—ç¬¦ ä¸‰è·¯æ¯”è¾ƒç»“æœå¦‚ä¸‹ (a \u003c=\u003e b) \u003c 0 // å¦‚æœ a \u003c b åˆ™ä¸º true (a \u003c=\u003e b) \u003e 0 // å¦‚æœ a \u003e b åˆ™ä¸º true (a \u003c=\u003e b) == 0 // å¦‚æœ a ä¸ b ç›¸ç­‰æˆ–è€…ç­‰ä»· åˆ™ä¸º true ç±»ä¼¼äºCçš„strcmp å‡½æ•°è¿”å›-1, 0, 1 ä¸€èˆ¬æƒ…å†µ: è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰çš„æ¯”è¾ƒæ“ä½œç¬¦, å¦‚æœå¯¹è±¡æ˜¯ç»“æ„ä½“åˆ™é€ä¸ªæ¯”è¾ƒ, å¯ä»¥ç”¨ä¸‹é¢ä»£ç ä»£æ›¿æ‰€æœ‰çš„æ¯”è¾ƒè¿ç®—ç¬¦ auto X::operator\u003c=\u003e(const Y\u0026) = default; é«˜çº§æƒ…å†µ: æŒ‡å®šè¿”å›ç±»å‹(æ”¯æŒ6ç§æ‰€æœ‰çš„æ¯”è¾ƒè¿ç®—ç¬¦) ç¤ºä¾‹: class Point { int x; int y; public: friend bool operator==(const Point\u0026 a, const Point\u0026 b){ return a.x==b.x \u0026\u0026 a.y==b.y; } friend bool operator\u003c (const Point\u0026 a, const Point\u0026 b){ return a.x \u003c b.x || (a.x == b.x \u0026\u0026 a.y \u003c b.y); } friend bool operator!=(const Point\u0026 a, const Point\u0026 b) { return !(a==b); } friend bool operator\u003c=(const Point\u0026 a, const Point\u0026 b) { return !(b\u003ca); } friend bool operator\u003e (const Point\u0026 a, const Point\u0026 b) { return b\u003ca; } friend bool operator\u003e=(const Point\u0026 a, const Point\u0026 b) { return !(a\u003cb); } // ... å…¶ä»–éæ¯”è¾ƒå‡½æ•° ... }; #include \u003ccompare\u003e class Point { int x; int y; public: auto operator\u003c=\u003e(const Point\u0026) const = default; // æ¯”è¾ƒæ“ä½œç¬¦è‡ªåŠ¨ç”Ÿæˆ // ... å…¶ä»–éæ¯”è¾ƒå‡½æ•° ... }; æ ‡å‡†åº“ç±»å‹æ”¯æŒ \u003c=\u003e vector, string, map, set, sub_match, â€¦ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:17","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] èŒƒå›´ for å¾ªç¯è¯­å¥æ”¯æŒåˆå§‹åŒ–è¯­å¥ switch è¯­å¥åˆå§‹åŒ– (C++17): struct Foo { int value; int result; }; Foo GetData() { return Foo(); } int main() { switch (auto data = GetData(); data.value) { case 1: return data.result; } } if è¯­å¥åˆå§‹åŒ– (C++17): struct Foo { int value; int result; }; Foo* GetData() { return new Foo(); } int main() { if (auto data = GetData(); data) { // Use 'dataâ€™ } } åˆ›å»ºå®Œæ•´çš„æ—¥æœŸ year_mouth_day fulldate1{2019y, September, 18d}; auto fulldate2 = 2019y / September / 18d; year_mouth_day fulldate3{Monday[3]/September/2019}; // Monday[3] è¡¨ç¤ºç¬¬ä¸‰ä¸ªæ˜ŸæœŸä¸€ æ–°çš„äº‹ä»¶é—´éš”å•ä½, ç±»ä¼¼äºç§’, åˆ†é’Ÿ, â€¦ using days = duration\u003csigned interger type of at least 25bits, ratio_multiply\u003cratio\u003c24\u003e, hours::period\u003e\u003e; using weeks = ...; using mouths = ...; using years = ...; ä¾‹å­ weeks w{1}; // 1 å‘¨ days d{w}; // å°† 1 å‘¨ è½¬æ¢æˆå¤©æ•° æ–°çš„æ—¶é’Ÿç±»å‹, (ä¹‹å‰æœ‰ system_clock, steady_clock, high_resolution_clock): utc_clock: represents Coordinated Universal Time (UTC), measures time since 00:00:00 UTC, Thursday, 1 January 1970, including leap seconds tai_clock: represents International Atomic Time (TAI), measures time since 00:00:00, 1 January 1958, and was offseted 10 seconds ahead of UTC at that date, it does not include leap seconds gps_clock: represents Global Positioning System (GPS) time, measures time since 00:00:00, 6 January 1980 UTC, it does not include leap seconds file_clock: alias for the clock used for std::filesystem::file_time_type, epoch is unspecified æ–°å¢system_clockç›¸å…³çš„åˆ«å template\u003cclass Duration\u003e using sys_time = std::chrono::time_point\u003cstd::chrono::system_clock, Duration\u003e; using sys_seconds = sys_time\u003cstd::chrono::seconds\u003e; using sys_days = sys_time\u003cstd::chrono::days\u003e; // ç”¨ä¾‹: system_clock::time_point t = sys_days{ 2019y / September / 18d }; // date -\u003e time_point auto yearmonthday = year_month_day{ floor\u003cdays\u003e(t) }; // time_point -\u003e date æ—¥æœŸ + äº‹ä»¶ auto t = sys_days{2019y/September/18d} + 9h + 35min + 10s; // 2019-09-18 09:35:10 UTC æ—¶åŒºè½¬æ¢ // Convert UTC to Denver time: zoned_time denver = { \"America/Denver\", t }; // Construct a local time in Denver: auto t = zoned_time{ \"America/Denver\", local_days{Wednesday[3] / September / 2019} + 9h }; // Get current local time: auto t = zoned_time{ current_zone(), system_clock::now() }; ","date":"2023-07-12","objectID":"/posts/newfeature/:4:18","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] std::span å¤´æ–‡ä»¶ æŸæ®µè¿ç»­æ•°æ®çš„â€è§†å›¾â€ ä¸æŒæœ‰æ•°æ®, ä¸åˆ†é…å’Œé”€æ¯æ•°æ® æ‹·è´éå¸¸å¿«, æ¨èå¤åˆ¶çš„æ–¹å¼ä¼ å‚(ç±»ä¼¼ string_view) ä¸æ”¯æŒæ•°æ®è·¨æ­¥(stride) å¯é€šè¿‡è¿è¡ŒæœŸç¡®å®šé•¿åº¦ä¹Ÿå¯ç¼–è¯‘å™¨ç¡®å®šé•¿åº¦ int data[42]; span\u003cint, 42\u003e a {data}; // fixed-size: 42 ints span\u003cint\u003e b {data}; // dynamic-size: 42 ints span\u003cint, 50\u003e c {data}; // compilation error span\u003cint\u003e d{ ptr, len }; // dynamic-size: len ints ","date":"2023-07-12","objectID":"/posts/newfeature/:4:19","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] ç‰¹æ€§æµ‹è¯•å® é€šè¿‡å®ƒå¯ä»¥åˆ¤æ–­ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒæŸä¸ªåŠŸèƒ½, ä¾‹å¦‚ è¯­è¨€ç‰¹æ€§ __has_cpp_attribute(fallthrough) __cpp_binary_literals __cpp_char8_t __cpp_coroutines æ ‡å‡†åº“ç‰¹æ€§ __cpp_lib_concepts __cpp_lib_ranges __cpp_lib_scoped_lock åŒ…å« C++ æ ‡å‡†åº“ç‰ˆæœ¬, å‘å¸ƒæ—¥æœŸ, ç‰ˆæƒè¯ä¹¦, ç‰¹æ€§å®ç­‰ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:20","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] constevalå‡½æ•° constexpr å‡½æ•°å¯èƒ½ç¼–è¯‘æœŸæ‰§è¡Œ, ä¹Ÿå¯ä»¥åœ¨è¿è¡ŒæœŸæ‰§è¡Œ, consteval åªèƒ½åœ¨ç¼–è¯‘å™¨æ‰§è¡Œ, å¦‚æœä¸æ»¡è¶³è¦æ±‚ç¼–è¯‘ä¸é€šè¿‡ã€‚ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:21","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] constinit å¼ºåˆ¶æŒ‡å®šä»¥å¸¸é‡æ–¹å¼åˆå§‹åŒ– const char* GetStringDyn() { return \"dynamic init\"; } constexpr const char* GetString(bool constInit) { return constInit ? \"constant init\" : GetStringDyn(); } constinit const char* a = GetString(true); // âœ” constinit const char* b = GetString(false); // âŒ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:22","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] ç”¨ using å¼•ç”¨ enum ç±»å‹ enum class CardTypeSuit { Clubs, Diamonds, Hearts, Spades }; std::string_view GetString(const CardTypeSuit cardTypeSuit) { switch (cardTypeSuit) { case CardTypeSuit::Clubs: return \"Clubs\"; case CardTypeSuit::Diamonds: return \"Diamonds\"; case CardTypeSuit::Hearts: return \"Hearts\"; case CardTypeSuit::Spades: return \"Spades\"; } } std::string_view GetString(const CardTypeSuit cardTypeSuit) { switch (cardTypeSuit) { using enum CardTypeSuit; // è¿™é‡Œ case Clubs: return \"Clubs\"; case Diamonds: return \"Diamonds\"; case Hearts: return \"Hearts\"; case Spades: return \"Spades\"; } } ","date":"2023-07-12","objectID":"/posts/newfeature/:4:23","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] æ ¼å¼åŒ–åº“(std::format) ä¸å±•å¼€, ç±»ä¼¼Python çš„æ ¼å¼åŒ–, std::string s = std::format(\"Hello CppCon {}!\", 2019); ","date":"2023-07-12","objectID":"/posts/newfeature/:4:24","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] å¢åŠ æ•°å­¦å¸¸é‡ å†ä¹Ÿä¸ç”¨ä¸º M_PI å‘æ„å•¦ å¤´æ–‡ä»¶ åŒ…å« e, log2e, log10e pi, inv_pi, inv_sqrt pi ln2, ln10 sqrt2, sqrt3, inv_sqrt3 egamma ","date":"2023-07-12","objectID":"/posts/newfeature/:4:25","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] std::source_location ç”¨äºè·å–ä»£ç ä½ç½®, å¯¹äºæ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯å°¤å…¶æœ‰ç”¨ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:26","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] [[nodiscard(reason)]] è¡¨æ˜è¿”å›å€¼ä¸å¯æŠ›å¼ƒ, åŠ å…¥ç†ç”±çš„æ”¯æŒ [[nodiscard(\"Ignoring the return value will result in memory leaks.\")]] void* GetData() { /* ... */ } ","date":"2023-07-12","objectID":"/posts/newfeature/:4:27","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] ä½è¿ç®— åŠ å…¥å¾ªç¯ç§»ä½, è®¡æ•°0å’Œ1ä½ç­‰åŠŸèƒ½ ","date":"2023-07-12","objectID":"/posts/newfeature/:4:28","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":"[C++20] ä¸€äº›å°æ›´æ–° å­—ç¬¦ä¸²æ”¯æŒ starts_with, ends_with map æ”¯æŒ contains æŸ¥è¯¢æ˜¯å¦å­˜åœ¨æŸä¸ªé”® list å’Œ forward list çš„ remove, remove_if å’Œ unique æ“ä½œè¿”å› size_type è¡¨æ˜åˆ é™¤ä¸ªæ•° å¢åŠ  shift_left, shift_right midpoint è®¡ç®—ä¸­ä½æ•°, å¯é¿å…æº¢å‡º lerp çº¿æ€§æ’å€¼ lerp( float a, float b, float t ) è¿”å› [å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-SIYwBQJu-1628786141278)(https://www.zhihu.com/equation?tex=a+%2B+t(b-a)]) æ–°çš„å‘é‡åŒ–ç­–ç•¥ unsequenced_policy(execution::unseq) std::string str = \"Hello world!\"; bool b = str.starts_with(\"Hello\"); // starts_with, ends_with std::map myMap{ std::pair{1, \"one\"s}, {2, \"two\"s}, {3, \"three\"s} }; bool result = myMap.contains(2); // contains, å†ä¹Ÿä¸ç”¨ .find() == .end() äº† ref: [1]. https://blog.csdn.net/qq_41854911/article/details/119657617 ","date":"2023-07-12","objectID":"/posts/newfeature/:4:29","tags":["C++"],"title":"C++ æ–°ç‰¹æ€§ | C++11\\C++14\\C++17","uri":"/posts/newfeature/"},{"categories":["C++"],"content":" quote c++ å…«è‚¡æ–‡ ç¬¬ä¸€éƒ¨åˆ† ","date":"2023-07-11","objectID":"/posts/basics_two/:0:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"6 åŸºç¡€çŸ¥è¯†(å…­) ","date":"2023-07-11","objectID":"/posts/basics_two/:1:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"6.1 æ„é€ å‡½æ•°ä¸ºä»€ä¹ˆä¸èƒ½å®šä¹‰ä¸ºè™šå‡½æ•°ï¼Ÿ â½½ææ„å‡½æ•°â¼€èˆ¬å†™æˆè™šå‡½æ•°çš„åŸå›  ï¼Ÿ æ„é€ å‡½æ•°ä¸èƒ½å£°æ˜ä¸ºè™šå‡½æ•°çš„åŸå› æ˜¯: 1 æ„é€ ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå¿…é¡»çŸ¥é“å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œè€Œè™šå‡½æ•°è¡Œä¸ºæ˜¯åœ¨è¿è¡ŒæœŸé—´ç¡®å®šå®é™…ç±»å‹çš„ã€‚è€Œåœ¨æ„é€ ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç”±äºå¯¹è±¡è¿˜æœªæ„é€ æˆåŠŸã€‚ç¼–è¯‘å™¨æ— æ³•çŸ¥é“å¯¹è±¡ çš„å®é™…ç±»å‹ï¼Œæ˜¯è¯¥ç±»æœ¬èº«ï¼Œè¿˜æ˜¯è¯¥ç±»çš„ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼Œæˆ–æ˜¯æ›´æ·±å±‚æ¬¡çš„æ´¾ç”Ÿç±»ã€‚æ— æ³•ç¡®å®šã€‚ 2 è™šå‡½æ•°çš„æ‰§è¡Œä¾èµ–äºè™šå‡½æ•°è¡¨ã€‚è€Œè™šå‡½æ•°è¡¨åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œåˆå§‹åŒ–å·¥ä½œï¼Œå³åˆå§‹åŒ–vptrï¼Œè®©ä»–æŒ‡å‘æ­£ç¡®çš„è™šå‡½æ•°è¡¨ã€‚è€Œåœ¨æ„é€ å¯¹è±¡æœŸé—´ï¼Œè™šå‡½æ•°è¡¨è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå°†æ— æ³•è¿›è¡Œã€‚ è™šå‡½æ•°çš„æ„æ€å°±æ˜¯å¼€å¯åŠ¨æ€ç»‘å®šï¼Œç¨‹åºä¼šæ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹æ¥é€‰æ‹©è¦è°ƒç”¨çš„æ–¹æ³•ã€‚ç„¶è€Œåœ¨æ„é€ å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡çš„åŠ¨æ€ç±»å‹è¿˜ä¸å®Œæ•´ï¼Œæ²¡æœ‰åŠæ³•ç¡®å®šå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹ï¼Œæ•…æ„é€ å‡½æ•°ä¸èƒ½åŠ¨æ€ç»‘å®šã€‚ï¼ˆåŠ¨æ€ç»‘å®šæ˜¯æ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹è€Œä¸æ˜¯å‡½æ•°åï¼Œåœ¨è°ƒç”¨æ„é€ å‡½æ•°ä¹‹å‰ï¼Œè¿™ä¸ªå¯¹è±¡æ ¹æœ¬å°±ä¸å­˜åœ¨ï¼Œå®ƒæ€ä¹ˆåŠ¨æ€ç»‘å®šï¼Ÿï¼‰ ç¼–è¯‘å™¨åœ¨è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°çš„æ—¶å€™å¹¶ä¸çŸ¥é“ä½ è¦æ„é€ çš„æ˜¯ä¸€ä¸ªåŸºç±»çš„å¯¹è±¡è¿˜æ˜¯ä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚ ææ„å‡½æ•°è®¾ä¸ºè™šå‡½æ•°çš„ä½œç”¨: è§£é‡Šï¼šåœ¨ç±»çš„ç»§æ‰¿ä¸­ï¼Œå¦‚æœæœ‰åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»ï¼Œé‚£ä¹ˆç”¨åŸºç±»æŒ‡é’ˆdeleteæ—¶ï¼Œå¦‚æœä¸å®šä¹‰æˆè™šå‡½æ•°ï¼Œæ´¾ç”Ÿç±»ä¸­æ´¾ç”Ÿçš„é‚£éƒ¨åˆ†æ— æ³•ææ„ã€‚ï¼ˆå¦‚æœåŸºç±»çš„ææ„å‡½æ•°ä¸æ˜¯è™šå‡½æ•°ï¼Œé‚£ä¹ˆåœ¨delete åŸºç±»æŒ‡é’ˆæ—¶ï¼Œåªè°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ï¼Œä¸ä¼šè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼Œæ•…æ´¾ç”Ÿç±»éƒ¨åˆ†ä¸ä¼šè¢«ææ„ã€‚ï¼‰ ","date":"2023-07-11","objectID":"/posts/basics_two/:1:1","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"6.2 c/c++ä¸­registerå…³é”®å­—ï¼ˆå¯„å­˜å™¨ã€ç¼“å­˜ã€å†…å­˜ï¼‰ c/c++ä¸­registerå…³é”®å­—ï¼ˆå¯„å­˜å™¨ã€ç¼“å­˜ã€å†…å­˜ï¼‰ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå˜é‡çš„å€¼æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼ŒCPU æ¯æ¬¡ä½¿ç”¨æ•°æ®éƒ½è¦ä»å†…å­˜ä¸­è¯»å–ã€‚å¦‚æœæœ‰ä¸€äº›å˜é‡ä½¿ç”¨éå¸¸é¢‘ç¹ï¼Œä»å†…å­˜ä¸­è¯»å–å°±ä¼šæ¶ˆè€—å¾ˆå¤šæ—¶é—´ï¼Œä¾‹å¦‚ for å¾ªç¯ä¸­çš„å¢é‡æ§åˆ¶ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†ä½¿ç”¨é¢‘ç¹çš„å˜é‡æ”¾åœ¨CPUçš„é€šç”¨å¯„å­˜å™¨ä¸­ï¼Œè¿™æ ·ä½¿ç”¨è¯¥å˜é‡æ—¶å°±ä¸å¿…è®¿é—®å†…å­˜ï¼Œç›´æ¥ä»å¯„å­˜å™¨ä¸­è¯»å–ï¼Œå¤§å¤§æé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚ å¯„å­˜å™¨ã€ç¼“å­˜ã€å†…å­˜ ä¸ºäº†åŠ æ·±å¯¹ register å˜é‡çš„ç†è§£ï¼Œè¿™é‡Œæœ‰å¿…è¦è®²ä¸€ä¸‹CPUå¯„å­˜å™¨ã€‚ æŒ‰ç…§ä¸CPUçš„è¿œè¿‘æ¥åˆ†ï¼Œç¦»CPUæœ€è¿‘çš„æ˜¯å¯„å­˜å™¨ï¼Œç„¶åæ˜¯ç¼“å­˜ï¼Œæœ€åæ˜¯å†…å­˜ã€‚ å¯„å­˜å™¨æ˜¯æœ€è´´è¿‘CPUçš„ï¼Œè€Œä¸”CPUåªåœ¨å¯„å­˜å™¨ä¸­è¿›è¡Œå­˜å–ã€‚å¯„å­˜çš„æ„æ€æ˜¯æš‚æ—¶å­˜æ”¾æ•°æ®ï¼Œä¸ç”¨æ¯æ¬¡éƒ½ä»å†…å­˜ä¸­è¯»å–ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸´æ—¶çš„å­˜æ”¾æ•°æ®çš„ç©ºé—´ã€‚ è€Œå¯„å­˜å™¨çš„æ•°æ®åˆæ¥æºäºå†…å­˜ï¼Œäºæ˜¯ CPU \u003câ€“ å¯„å­˜å™¨ \u003câ€“ å†…å­˜ï¼Œè¿™å°±æ˜¯å®ƒä»¬ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜éœ€è¦ç¼“å­˜å‘¢ï¼Ÿå› ä¸ºå¦‚æœé¢‘ç¹åœ°æ“ä½œå†…å­˜ä¸­åŒä¸€åœ°å€ä¸Šçš„æ•°æ®ä¼šå½±å“é€Ÿåº¦ï¼Œäºæ˜¯å°±åœ¨å¯„å­˜å™¨å’Œå†…å­˜ä¹‹é—´è®¾ç½®ä¸€ä¸ªç¼“å­˜ï¼ŒæŠŠä½¿ç”¨é¢‘ç¹çš„æ•°æ®æš‚æ—¶ä¿å­˜åˆ°ç¼“å­˜ï¼Œå¦‚æœå¯„å­˜å™¨éœ€è¦è¯»å–å†…å­˜ä¸­åŒä¸€åœ°å€ä¸Šçš„æ•°æ®ï¼Œå°±ä¸ç”¨å¤§è€è¿œåœ°å†å»è®¿é—®å†…å­˜ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–å³å¯ã€‚ ç¼“å­˜çš„é€Ÿåº¦è¿œé«˜äºå†…å­˜ï¼Œä»·æ ¼ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ æ³¨æ„ï¼šç¼“å­˜çš„å®¹é‡æ˜¯æœ‰é™çš„ï¼Œå¯„å­˜å™¨åªèƒ½ä»ç¼“å­˜ä¸­è¯»å–åˆ°éƒ¨åˆ†æ•°æ®ï¼Œå¯¹äºä½¿ç”¨ä¸æ˜¯å¾ˆé¢‘ç¹çš„æ•°æ®ï¼Œä¼šç»•è¿‡ç¼“å­˜ï¼Œç›´æ¥åˆ°å†…å­˜ä¸­è¯»å–ã€‚æ‰€ä»¥ä¸æ˜¯æ¯æ¬¡éƒ½èƒ½ä»ç¼“å­˜ä¸­å¾—åˆ°æ•°æ®ï¼Œè¿™å°±æ˜¯ç¼“å­˜çš„å‘½ä¸­ç‡ï¼Œèƒ½å¤Ÿä»ç¼“å­˜ä¸­è¯»å–å°±å‘½ä¸­ï¼Œå¦åˆ™å°±æ²¡å‘½ä¸­ã€‚ å…³äºç¼“å­˜çš„å‘½ä¸­ç‡åˆæ˜¯ä¸€é—¨å­¦é—®ï¼Œå“ªäº›æ•°æ®ä¿ç•™åœ¨ç¼“å­˜ï¼Œå“ªäº›æ•°æ®ä¸ä¿ç•™ï¼Œéƒ½æœ‰å¤æ‚çš„ç®—æ³•ã€‚ æ³¨æ„ï¼šä¸Šé¢æ‰€è¯´çš„CPUæ˜¯æŒ‡CPUæ ¸å¿ƒï¼Œä»å¸‚åœºä¸Šè´­ä¹°çš„CPUå·²æ˜¯å°è£…å¥½çš„å¥—ä»¶ï¼Œé™„å¸¦äº†å¯„å­˜å™¨å’Œç¼“å­˜ï¼Œæ’åˆ°ä¸»æ¿ä¸Šå°±å¯ä»¥ç”¨ã€‚ ä»ç»æµå’Œé€Ÿåº¦çš„ç»¼åˆè€ƒè™‘ï¼Œç¼“å­˜åˆè¢«åˆ†ä¸ºä¸€çº§ç¼“å­˜ã€äºŒçº§ç¼“å­˜å’Œä¸‰çº§ç¼“å­˜ï¼Œå®ƒä»¬çš„å­˜å–é€Ÿåº¦å’Œä»·æ ¼ä¾æ¬¡é™ä½ï¼Œå®¹é‡ä¾æ¬¡å¢åŠ ã€‚è´­ä¹°åˆ°çš„CPUä¸€èˆ¬ä¼šæ ‡å‡ºä¸‰çº§ç¼“å­˜çš„å®¹é‡ã€‚ register å˜é‡ å¯„å­˜å™¨çš„æ•°é‡æ˜¯æœ‰é™çš„ï¼Œé€šå¸¸æ˜¯æŠŠä½¿ç”¨æœ€é¢‘ç¹çš„å˜é‡å®šä¹‰ä¸º register çš„ã€‚ å…³äºå¯„å­˜å™¨å˜é‡æœ‰ä»¥ä¸‹äº‹é¡¹éœ€è¦æ³¨æ„ï¼š ä¸ºå¯„å­˜å™¨å˜é‡åˆ†é…å¯„å­˜å™¨æ˜¯åŠ¨æ€å®Œæˆçš„ï¼Œå› æ­¤ï¼Œåªæœ‰å±€éƒ¨å˜é‡å’Œå½¢å¼å‚æ•°æ‰èƒ½å®šä¹‰ä¸ºå¯„å­˜å™¨å˜é‡ã€‚ å±€éƒ¨é™æ€å˜é‡ä¸èƒ½å®šä¹‰ä¸ºå¯„å­˜å™¨å˜é‡ï¼Œå› ä¸ºä¸€ä¸ªå˜é‡åªèƒ½å£°æ˜ä¸ºä¸€ç§å­˜å‚¨ç±»åˆ«ã€‚ å¯„å­˜å™¨çš„é•¿åº¦ä¸€èˆ¬å’Œæœºå™¨çš„å­—é•¿ä¸€è‡´ï¼Œæ‰€ä»¥ï¼Œåªæœ‰è¾ƒçŸ­çš„ç±»å‹å¦‚intã€charã€shortç­‰æ‰é€‚åˆå®šä¹‰ä¸ºå¯„å­˜å™¨å˜é‡ï¼Œè¯¸å¦‚doubleç­‰è¾ƒå¤§çš„ç±»å‹ï¼Œä¸æ¨èå°†å…¶å®šä¹‰ä¸ºå¯„å­˜å™¨ç±»å‹ã€‚ CPUçš„å¯„å­˜å™¨æ•°ç›®æœ‰é™ï¼Œå› æ­¤ï¼Œå³ä½¿å®šä¹‰äº†å¯„å­˜å™¨å˜é‡ï¼Œç¼–è¯‘å™¨å¯èƒ½å¹¶ä¸çœŸæ­£ä¸ºå…¶åˆ†é…å¯„å­˜å™¨ï¼Œè€Œæ˜¯å°†å…¶å½“åšæ™®é€šçš„autoå˜é‡æ¥å¯¹å¾…ï¼Œä¸ºå…¶åˆ†é…æ ˆå†…å­˜ã€‚å½“ç„¶ï¼Œæœ‰äº›ä¼˜ç§€çš„ç¼–è¯‘å™¨ï¼Œèƒ½è‡ªåŠ¨è¯†åˆ«ä½¿ç”¨é¢‘ç¹çš„å˜é‡ï¼Œå¦‚å¾ªç¯æ§åˆ¶å˜é‡ç­‰ï¼Œåœ¨æœ‰å¯ç”¨çš„å¯„å­˜å™¨æ—¶ï¼Œå³ä½¿æ²¡æœ‰ä½¿ç”¨ register å…³é”®å­—ï¼Œä¹Ÿè‡ªåŠ¨ä¸ºå…¶åˆ†é…å¯„å­˜å™¨ï¼Œæ— é¡»ç”±ç¨‹åºå‘˜æ¥æŒ‡å®šã€‚ c++ä¸­register åœ¨æ—©æœŸcè¯­è¨€ç¼–è¯‘å™¨ä¸ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤ä½¿ç”¨registerå…³é”®å­—ä¿®é¥°å˜é‡æ˜¯å¾ˆå¥½çš„è¡¥å……ï¼Œå¤§å¤§æé«˜çš„é€Ÿåº¦ã€‚ registerå…³é”®å­—è¯·æ±‚è®©ç¼–è¯‘å™¨å°†å˜é‡aç›´æ¥æ”¾å…¥å¯„å­˜å™¨é‡Œé¢ï¼Œä»¥æé«˜è¯»å–é€Ÿåº¦ï¼Œåœ¨Cè¯­è¨€ä¸­registerå…³é”®å­—ä¿®é¥°çš„å˜é‡ä¸å¯ä»¥è¢«å–åœ°å€ï¼Œä½†æ˜¯c++ä¸­è¿›è¡Œäº†ä¼˜åŒ–ã€‚ c++ä¸­ä¾ç„¶æ”¯æŒregisterå…³é”®å­—ï¼Œä½†æ˜¯c++ç¼–è¯‘å™¨ä¹Ÿæœ‰è‡ªå·±çš„ä¼˜åŒ–æ–¹å¼ï¼Œå³æŸäº›å˜é‡ä¸ç”¨registerå…³é”®å­—è¿›è¡Œä¿®é¥°ï¼Œç¼–è¯‘å™¨ä¹Ÿä¼šå°†å¤šæ¬¡è¿ç»­ä½¿ç”¨çš„å˜é‡ä¼˜åŒ–æ”¾å…¥å¯„å­˜å™¨ä¸­ï¼Œä¾‹å¦‚å…¥forå¾ªç¯çš„å¾ªç¯å˜é‡iã€‚ c++ä¸­ä¹Ÿå¯ä»¥å¯¹registerä¿®é¥°çš„å˜é‡å–åœ°å€ï¼Œä¸è¿‡c++ç¼–è¯‘å™¨å‘ç°ç¨‹åºä¸­éœ€è¦å–registerå…³é”®å­—ä¿®é¥°çš„å˜é‡çš„åœ°å€æ—¶ï¼Œregisterå…³é”®å­—çš„å£°æ˜å°†å˜å¾—æ— æ•ˆã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:1:2","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"6.3 c/c++ä¸­è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« c++å¤šçº¿ç¨‹ç¼–ç¨‹ â€“ è¿›ç¨‹ä¸çº¿ç¨‹åŒºåˆ« c++é¢è¯•-æ“ä½œç³»ç»Ÿç¯‡ é¢è¯•å¿…è€ƒ | è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ« ä½•ä¸ºè¿›ç¨‹(process)? è¿›ç¨‹æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºè¢«æ“ä½œç³»ç»Ÿæ‹‰èµ·æ¥åŠ è½½åˆ°å†…å­˜ä¹‹åä»å¼€å§‹æ‰§è¡Œåˆ°æ‰§è¡Œç»“æŸçš„è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹ã€‚ç®€å•æ¥è¯´ï¼Œè¿›ç¨‹æ˜¯ç¨‹åºï¼ˆåº”ç”¨ç¨‹åºï¼Œå¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„ä¸€æ¬¡æ‰§è¡Œã€‚è¿›ç¨‹é€šå¸¸ç”±ç¨‹åºã€æ•°æ®å’Œè¿›ç¨‹æ§åˆ¶å—ï¼ˆPCBï¼‰ç»„æˆã€‚æ¯”å¦‚åŒå‡»æ‰“å¼€ä¸€ä¸ªæ¡Œé¢åº”ç”¨è½¯ä»¶å°±æ˜¯å¼€å¯äº†ä¸€ä¸ªè¿›ç¨‹ã€‚ ä¼ ç»Ÿçš„è¿›ç¨‹æœ‰ä¸¤ä¸ªåŸºæœ¬å±æ€§ï¼šå¯æ‹¥æœ‰èµ„æºçš„ç‹¬ç«‹å•ä½ï¼›å¯ç‹¬ç«‹è°ƒåº¦å’Œåˆ†é…çš„åŸºæœ¬å•ä½ã€‚å¯¹äºè¿™å¥è¯æˆ‘çš„ç†è§£æ˜¯ï¼šè¿›ç¨‹å¯ä»¥è·å–æ“ä½œç³»ç»Ÿåˆ†é…çš„èµ„æºï¼Œå¦‚å†…å­˜ç­‰ï¼›è¿›ç¨‹å¯ä»¥å‚ä¸æ“ä½œç³»ç»Ÿçš„è°ƒåº¦ï¼Œå‚ä¸CPUçš„ç«äº‰ï¼Œå¾—åˆ°åˆ†é…çš„æ—¶é—´ç‰‡ï¼Œè·å¾—å¤„ç†æœºï¼ˆCPUï¼‰è¿è¡Œã€‚ è¿›ç¨‹åœ¨åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢ä¸­ï¼Œç³»ç»Ÿå¿…é¡»ä¸ºä¹‹ä»˜å‡ºè¾ƒå¤§çš„æ—¶ç©ºå¼€é”€ï¼Œå› æ­¤åœ¨ç³»ç»Ÿä¸­å¼€å¯çš„è¿›ç¨‹æ•°ä¸å®œè¿‡å¤šã€‚æ¯”å¦‚ä½ åŒæ—¶æ‰“å¼€åå‡ ä¸ªåº”ç”¨è½¯ä»¶è¯•è¯•ï¼Œç”µè„‘è‚¯å®šä¼šå¡æ­»çš„ã€‚äºæ˜¯ç´§æ¥ç€å°±å¼•å…¥äº†çº¿ç¨‹çš„æ¦‚å¿µã€‚ ä½•ä¸ºçº¿ç¨‹(thread)? çº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯è¢«ç³»ç»Ÿç‹¬ç«‹åˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚ä¹Ÿæœ‰è¯´ï¼Œçº¿ç¨‹æ˜¯CPUå¯æ‰§è¡Œè°ƒåº¦çš„æœ€å°å•ä½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿›ç¨‹æœ¬èº«å¹¶ä¸èƒ½è·å–CPUæ—¶é—´ï¼Œåªæœ‰å®ƒçš„çº¿ç¨‹æ‰å¯ä»¥ã€‚ å¼•å…¥çº¿ç¨‹ä¹‹åï¼Œå°†ä¼ ç»Ÿè¿›ç¨‹çš„ä¸¤ä¸ªåŸºæœ¬å±æ€§åˆ†å¼€äº†ï¼Œçº¿ç¨‹ä½œä¸ºè°ƒåº¦å’Œåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œè¿›ç¨‹ä½œä¸ºç‹¬ç«‹åˆ†é…èµ„æºçš„å•ä½ã€‚æˆ‘å¯¹è¿™å¥è¯çš„ç†è§£æ˜¯ï¼šçº¿ç¨‹å‚ä¸æ“ä½œç³»ç»Ÿçš„è°ƒåº¦ï¼Œå‚ä¸CPUçš„ç«äº‰ï¼Œå¾—åˆ°åˆ†é…çš„æ—¶é—´ç‰‡ï¼Œè·å¾—å¤„ç†æœºï¼ˆCPUï¼‰è¿è¡Œã€‚è€Œè¿›ç¨‹è´Ÿè´£è·å–æ“ä½œç³»ç»Ÿåˆ†é…çš„èµ„æºï¼Œå¦‚å†…å­˜ã€‚ çº¿ç¨‹åŸºæœ¬ä¸Šä¸æ‹¥æœ‰èµ„æºï¼Œåªæ‹¥æœ‰ä¸€ç‚¹è¿è¡Œä¸­å¿…ä¸å¯å°‘çš„èµ„æºï¼Œå®ƒå¯ä¸åŒå±ä¸€ä¸ªè¿›ç¨‹çš„å…¶ä»–çº¿ç¨‹å…±äº«è¿›ç¨‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æºã€‚ çº¿ç¨‹å…·æœ‰è®¸å¤šä¼ ç»Ÿè¿›ç¨‹æ‰€å…·æœ‰çš„ç‰¹æ€§ï¼Œæ•…ç§°ä¸ºâ€œè½»é‡å‹è¿›ç¨‹â€ã€‚åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹å¯ä»¥å¹¶å‘æ‰§è¡Œã€‚ è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ çº¿ç¨‹åˆ†ä¸ºç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸æ”¯æŒçº¿ç¨‹ä¸¤ç±»ï¼Œç”¨æˆ·çº§çº¿ç¨‹ä¸ä¾èµ–äºå†…æ ¸ï¼Œè¯¥ç±»çº¿ç¨‹çš„åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢éƒ½ä¸åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨æ¥å®ç°; å†…æ ¸æ”¯æŒçº¿ç¨‹ä¾èµ–äºå†…æ ¸ï¼Œå³æ— è®ºæ˜¯åœ¨ç”¨æˆ·è¿›ç¨‹ä¸­çš„çº¿ç¨‹ï¼Œè¿˜æ˜¯åœ¨ç³»ç»Ÿä¸­çš„çº¿ç¨‹ï¼Œå®ƒä»¬çš„åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢éƒ½åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨æ¥å®ç°ã€‚ ä½†æ˜¯ï¼Œä¸çº¿ç¨‹ä¸åŒçš„æ˜¯ï¼Œæ— è®ºæ˜¯ç³»ç»Ÿè¿›ç¨‹è¿˜æ˜¯ç”¨æˆ·è¿›ç¨‹ï¼Œåœ¨è¿›è¡Œåˆ‡æ¢æ—¶ï¼Œéƒ½è¦ä¾èµ–äºå†…æ ¸ä¸­çš„è¿›ç¨‹(process)è°ƒåº¦ã€‚å› æ­¤ï¼Œæ— è®ºæ˜¯ä»€ä¹ˆè¿›ç¨‹éƒ½æ˜¯ä¸å†…æ ¸æœ‰å…³çš„ï¼Œæ˜¯åœ¨å†…æ ¸æ”¯æŒä¸‹è¿›ç¨‹åˆ‡æ¢çš„ã€‚å°½ç®¡çº¿ç¨‹å’Œè¿›ç¨‹è¡¨é¢ä¸Šçœ‹èµ·æ¥ç›¸ä¼¼ï¼Œä½†æ˜¯ä»–ä»¬åœ¨æœ¬è´¨ä¸Šæ˜¯ä¸åŒçš„ã€‚ æ ¹æ®æ“ä½œç³»ç»Ÿä¸­çš„çŸ¥è¯†ï¼Œè¿›ç¨‹è‡³å°‘å¿…é¡»æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œé€šå¸¸å°†æ­¤çº¿ç¨‹ç§°ä¸ºä¸»çº¿ç¨‹ã€‚ è¿›ç¨‹è¦ç‹¬ç«‹åœ°å ç”¨ç³»ç»Ÿèµ„æºï¼ˆå¦‚å†…å­˜ï¼‰ï¼Œè€ŒåŒä¸€è¿›ç¨‹çš„çº¿ç¨‹ä¹‹é—´æ˜¯å…±äº«èµ„æºçš„ã€‚è¿›ç¨‹æœ¬èº«å¹¶ä¸èƒ½è·å–CPUæ—¶é—´ï¼Œåªæœ‰å®ƒçš„çº¿ç¨‹æ‰å¯ä»¥ã€‚ å…¶ä»– è¿›ç¨‹åœ¨åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿçš„æ—¶ç©ºå¼€é”€éå¸¸å¤§ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡åˆ›å»ºçº¿ç¨‹æ¥å®Œæˆä»»åŠ¡ï¼Œä»¥å‡å°‘ç¨‹åºå¹¶å‘æ‰§è¡Œæ—¶ä»˜å‡ºçš„æ—¶ç©ºå¼€é”€ã€‚ä¾‹å¦‚å¯ä»¥åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­è®¾ç½®å¤šä¸ªçº¿ç¨‹ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å—é˜»æ—¶ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹å¯ä»¥ç»§ç»­è¿è¡Œï¼Œå½“ç¬¬äºŒä¸ªçº¿ç¨‹å—é˜»æ—¶ï¼Œç¬¬ä¸‰ä¸ªçº¿ç¨‹å¯ä»¥ç»§ç»­è¿è¡Œâ€¦â€¦ã€‚è¿™æ ·ï¼Œå¯¹äºæ‹¥æœ‰èµ„æºçš„åŸºæœ¬å•ä½ï¼ˆè¿›ç¨‹ï¼‰ï¼Œä¸ç”¨é¢‘ç¹çš„åˆ‡æ¢ï¼Œè¿›ä¸€æ­¥æé«˜äº†ç³»ç»Ÿä¸­å„ç§ç¨‹åºçš„å¹¶å‘ç¨‹åº¦ã€‚ ref: [1].https://blog.csdn.net/qq_41803340/category_10405604.html [å¾…æ•´ç†å†…å®¹] ","date":"2023-07-11","objectID":"/posts/basics_two/:1:3","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"ä¸€.å¸¸è€ƒC++åŸºç¡€æ¦‚å¿µ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"1.C++ä¸‰å¤§ç‰¹æ€§ï¼ˆå°è£…ã€ç»§æ‰¿ã€å¤šæ€ï¼‰ å°è£…ï¼š éšè—ç±»çš„å±æ€§å’Œå®ç°ç»†èŠ‚ï¼Œä»…ä»…å¯¹å¤–æä¾›æ¥å£ï¼Œ å°è£…æ€§å®é™…ä¸Šæ˜¯ç”±ç¼–è¯‘å™¨å»è¯†åˆ«å…³é”®å­—publicã€privateå’Œprotectedæ¥å®ç°çš„ï¼Œ ä½“ç°åœ¨ç±»çš„æˆå‘˜å¯ä»¥æœ‰å…¬æœ‰æˆå‘˜(public)ï¼Œç§æœ‰æˆå‘˜(private)ï¼Œä¿æŠ¤æˆå‘˜(protected)ã€‚ ç§æœ‰æˆå‘˜æ˜¯åœ¨å°è£…ä½“å†…è¢«éšè—çš„éƒ¨åˆ†ï¼Œåªæœ‰ç±»ä½“å†…å£°æ˜çš„å‡½æ•°(ç±»çš„æˆå‘˜å‡½æ•°)æ‰å¯ä»¥è®¿é—®ç§æœ‰æˆå‘˜ï¼Œ è€Œåœ¨ç±»ä½“å¤–çš„å‡½æ•°æ˜¯ä¸èƒ½è®¿é—®çš„ï¼Œå…¬æœ‰æˆå‘˜(public)æ˜¯å°è£…ä½“ä¸å¤–ç•Œçš„ä¸€ä¸ªæ¥å£ï¼Œ ç±»ä½“å¤–çš„å‡½æ•°å¯ä»¥è®¿é—®å…¬æœ‰æˆå‘˜ï¼Œä¿æŠ¤æˆå‘˜æ˜¯åªæœ‰è¯¥ç±»çš„æˆå‘˜å‡½æ•°å’Œè¯¥ç±»çš„æ´¾ç”Ÿç±»æ‰å¯ä»¥è®¿é—®çš„ã€‚ ä¼˜ç‚¹ï¼šéš”ç¦»å˜åŒ–ï¼›ä¾¿äºä½¿ç”¨ï¼›æé«˜é‡ç”¨æ€§ï¼›æé«˜å®‰å…¨æ€§ ç¼ºç‚¹ï¼šå¦‚æœå°è£…å¤ªå¤šï¼Œå½±å“æ•ˆç‡ï¼›ä½¿ç”¨è€…ä¸èƒ½çŸ¥é“ä»£ç å…·ä½“å®ç°ã€‚ ç»§æ‰¿ï¼š è¢«ç»§æ‰¿çš„æ˜¯çˆ¶ç±»ï¼ˆåŸºç±»ï¼‰ï¼Œç»§æ‰¿å‡ºæ¥çš„æ˜¯å­ç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰ï¼Œå­ç±»æ‹¥æœ‰çˆ¶ç±»çš„æ‰€æœ‰çš„ç‰¹æ€§ã€‚ ç»§æ‰¿æ–¹å¼æœ‰å…¬æœ‰ç»§æ‰¿ã€ç§æœ‰ç»§æ‰¿ï¼Œä¿æŠ¤ç»§æ‰¿ã€‚é»˜è®¤æ˜¯ç§æœ‰ç»§æ‰¿ *å…¬æœ‰ç»§æ‰¿ä¸­çˆ¶ç±»çš„å…¬æœ‰å’Œä¿æŠ¤æˆå‘˜åœ¨å­ç±»ä¸­ä¸å˜ï¼Œç§æœ‰çš„åœ¨å­ç±»ä¸­ä¸å¯è®¿é—®ã€‚ *ç§æœ‰ç»§æ‰¿ä¸­çˆ¶ç±»çš„å…¬æœ‰å’Œä¿æŠ¤æˆå‘˜åœ¨å­ç±»ä¸­å˜ä¸ºç§æœ‰ï¼Œä½†ç§æœ‰çš„åœ¨å­ç±»ä¸­ä¸å¯è®¿é—®ã€‚ *ä¿æŠ¤ç»§æ‰¿ä¸­çˆ¶ç±»çš„å…¬æœ‰å’Œä¿æŠ¤æˆå‘˜åœ¨å­ç±»ä¸­å˜ä¸ºä¿æŠ¤ï¼Œä½†ç§æœ‰çš„åœ¨å­ç±»ä¸­ä¸å¯è®¿é—®ã€‚ c++è¯­è¨€å…è®¸å•ç»§æ‰¿å’Œå¤šç»§æ‰¿ ä¼˜ç‚¹ï¼šç»§æ‰¿å‡å°‘äº†é‡å¤çš„ä»£ç ã€ç»§æ‰¿æ˜¯å¤šæ€çš„å‰æã€ç»§æ‰¿å¢åŠ äº†ç±»çš„è€¦åˆæ€§ï¼› ç¼ºç‚¹ï¼šç»§æ‰¿åœ¨ç¼–è¯‘æ—¶åˆ»å°±å®šä¹‰äº†ï¼Œæ— æ³•åœ¨è¿è¡Œæ—¶åˆ»æ”¹å˜çˆ¶ç±»ç»§æ‰¿çš„å®ç°ï¼› çˆ¶ç±»é€šå¸¸è‡³å°‘å®šä¹‰äº†å­ç±»çš„éƒ¨åˆ†è¡Œä¸ºï¼Œçˆ¶ç±»çš„æ”¹å˜éƒ½å¯èƒ½å½±å“å­ç±»çš„è¡Œä¸ºï¼› å¦‚æœç»§æ‰¿ä¸‹æ¥çš„å­ç±»ä¸é€‚åˆè§£å†³æ–°é—®é¢˜ï¼Œçˆ¶ç±»å¿…é¡»é‡å†™æˆ–æ›¿æ¢ï¼Œé‚£ä¹ˆè¿™ç§ä¾èµ–å…³ç³»å°±é™åˆ¶äº†çµæ´»æ€§ï¼Œ æœ€ç»ˆé™åˆ¶äº†å¤ç”¨æ€§ã€‚ è™šç»§æ‰¿ï¼šä¸ºäº†è§£å†³å¤šé‡ç»§æ‰¿ä¸­çš„äºŒä¹‰æ€§é—®é¢˜ï¼Œå®ƒç»´æŠ¤äº†ä¸€å¼ è™šåŸºç±»è¡¨ã€‚ (è±å½¢ç»§æ‰¿é—®é¢˜) å¤šæ€: ref: å¤šæ€çš„å››ç§è¡¨ç°å½¢å¼ è¿è¡Œæ—¶å¤šæ€(è™šå‡½æ•°) ç¼–è¯‘æ—¶å¤šæ€(æ¨¡æ¿) é‡è½½ ç±»å‹è½¬æ¢ è¿è¡Œæ—¶å¤šæ€(Subtype Polymorphism/Runtime Polymorphism) è¿è¡Œæ—¶å¤šæ€å°±æ˜¯æ´¾ç”Ÿç±»é‡å†™åŸºç±»çš„è™šå‡½æ•°ï¼Œåœ¨è°ƒç”¨å‡½æ•°é‡Œï¼Œå‚æ•°ä¸ºåŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œä¼šæ„æˆå¤šæ€ã€‚æˆ‘ä¹‹å‰å†™è¿‡ä¸€ç¯‡å¤šæ€çš„åŸç†ï¼Œå°±æ˜¯åœ¨è®²å¤šæ€(è¿è¡Œæ—¶å¤šæ€)åœ¨åº•å±‚æ˜¯æ€ä¹ˆå®ç°çš„ å¤šæ€çš„åº•å±‚å®ç° ä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚ä¹°ç¥¨è¿™ä¸ªè¡Œä¸ºï¼Œæˆäººå»ä¹°å°±æ˜¯å…¨ä»·ï¼Œå­¦ç”Ÿä¹°å°±æ˜¯åŠä»·ç¥¨ã€‚ä½†æ˜¯ä¸ç®¡æˆäººè¿˜æ˜¯å­¦ç”Ÿéƒ½æ˜¯äººè¿™ä¸ªä½“ç³»ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ¹æ®è°æ¥ä¹°ç¥¨æ‰èƒ½å†³å®šä»·æ ¼ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å¤šæ€ã€‚ #include \u003ciostream\u003e class ticket { public: virtual void price() = 0; }; class adult : public ticket { public: virtual void price() override { std::cout \u003c\u003c \"æˆäººå…¨ä»·ï¼\" \u003c\u003c std::endl; } }; class student : public ticket { public: virtual void price() override { std::cout \u003c\u003c \"å­¦ç”ŸåŠä»·ï¼\" \u003c\u003c std::endl; } }; void BuyTicket(ticket\u0026 t) { t.price(); } int main(void) { adult a; student s; BuyTicket(a); BuyTicket(s); return 0; } ç¼–è¯‘æ—¶å¤šæ€(Parametric Polymorphism/Compile-Time Polymorphism) ç¼–è¯‘æ—¶å¤šæ€å°±æ˜¯æ¨¡æ¿ã€‚åœ¨ç¨‹åºç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨æ ¹æ®å‚æ•°çš„ç±»å‹ï¼Œå°±å°†ç”ŸæˆæŸç§ç±»å‹çš„å‡½æ•°æˆ–ç±»ã€‚æˆ‘ä¹‹å‰å…³äºæ¨¡æ¿çš„(æ€»ç»“)[https://blog.csdn.net/weixin_42678507/article/details/88658291] ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼šAdd() å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å‡½æ•°ï¼Œä½†æ˜¯å¦‚æœä½ å†™ä¸€ä¸ªæ•´å‹çš„ Add å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘æƒ³åŠ  double å‹çš„å‘¢ï¼Ÿä½ å†å†™ä¸€ä¸ª double å‹çš„ Add å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘æƒ³åŠ  char å‹çš„å‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº†æ¨¡æ¿ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªé€»è¾‘ï¼Œå…·ä½“ç±»å‹ç­‰ç¼–è¯‘æ—¶å†ç”Ÿæˆè¯¥ç±»å‹çš„å‡½æ•°æˆ–ç±»ã€‚ #include \u003ciostream\u003e template\u003cclass T\u003e T Add(T lhs, T rhs) { return lhs + rhs; } int main(void) { Add(1, 2); Add(2.0, 3.0); Add('a', 'b'); return 0; } é‡è½½(Ad-hoc Polymorphism/Overloading) å‡½æ•°åç›¸åŒï¼Œå‚æ•°ä¸åŒå°±æ„æˆäº†é‡è½½ã€‚é‡è½½ä¸»è¦ç”¨äºå‡½æ•°ï¼Œå½“æŸä¸ªå‡½æ•°çš„åŠŸèƒ½æ— æ³•å¤„ç†æŸäº›å‚æ•°çš„æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡è½½ä¸€ä¸ªå‡½æ•°æ¥å•ç‹¬å¤„ç†ã€‚ ä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚è¯´ä¸Šé¢çš„ Add å‡½æ•°ï¼Œå½“å‰å†…ç½®ç±»å‹éƒ½å¯ä»¥å¤„ç†ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä¼ ä¸¤ä¸ªå­—ç¬¦ä¸²æ€ä¹ˆåŠï¼Ÿå°±ä¸å¯ä»¥åƒåˆšæ‰é‚£ä¹ˆåŠ äº†ã€‚å¾—é‡è½½ä¸€ä¸ªå‡½æ•°å•ç‹¬å¤„ç†ã€‚ #include \u003ciostream\u003e #include \u003cstring\u003e int Add(int lhs, int rhs) { return lhs + rhs; } std::string Add(const std::string\u0026 lhs, const std::string\u0026 rhs) { std::string ans(lhs); ans += rhs; return ans; } int main(void) { Add(1, 2); Add(\"abc\", \"def\"); return 0; } ç±»å‹è½¬æ¢(Coercion Polymorphism/Casting) ç±»å‹è½¬æ¢ä¸»è¦åˆ†ä¸ºå››ç§ï¼š static_cast: ç›¸å½“äºéšå¼ç±»å‹è½¬æ¢ã€‚ const_cast: è¿™ä¸ªå¯ä»¥å»é™¤ä¸€ä¸ª const å˜é‡çš„ const æ€§è´¨ï¼Œä½¿å¯ä»¥æ”¹å˜å®ƒçš„å€¼ã€‚ reinterpret_cast: ç›¸å½“äºå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚ dynamic_cast: è¿™ä¸ªå¯ä»¥ä½¿å­ç±»æŒ‡é’ˆæˆ–å¼•ç”¨èµ‹å€¼ç»™çˆ¶ç±»æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚ ç±»å‹è½¬æ¢å¾ˆç®€å•ï¼Œè¿™é‡Œå°±ä¸å¤šèµ˜è¿°äº†ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:1","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"2.æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ« æ•°ç»„å’Œé“¾è¡¨æ˜¯ä¸¤ç§ä¸åŒçš„æ•°æ®å­˜å‚¨æ–¹å¼ æ•°ç»„çš„å®šä¹‰ æ•°ç»„æ˜¯ä¸€ç»„å…·æœ‰ç›¸åŒæ•°æ®ç±»å‹çš„å˜é‡çš„é›†åˆï¼Œè¿™äº›å˜é‡ç§°ä¹‹ä¸ºé›†åˆçš„å…ƒç´ ã€‚ æ¯ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼Œç§°ä¹‹ä¸ºä¸‹æ ‡ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡æ¥åŒºåˆ«å¹¶è®¿é—®æ•°ç»„å…ƒç´ ï¼Œæ•°ç»„å…ƒç´ çš„ä¸ªæ•°å«åšæ•°æ®çš„é•¿åº¦ã€‚ é“¾è¡¨çš„å®šä¹‰ é“¾è¡¨æ˜¯ä¸€ç§ç‰©ç†å­˜å‚¨å•å…ƒä¸Šéè¿ç»­ã€éé¡ºåºçš„å­˜å‚¨ç»“æ„,æ•°æ®å…ƒç´ çš„é€»è¾‘é¡ºåºæ˜¯é€šè¿‡é“¾è¡¨ä¸­çš„æŒ‡é’ˆé“¾æ¥æ¬¡åºå®ç°çš„ã€‚ é“¾è¡¨çš„ç‰¹æ€§æ˜¯åœ¨ä¸­é—´ä»»æ„ä½ç½®æ’å…¥å’Œåˆ é™¤å…ƒç´ éƒ½éå¸¸å¿«ï¼Œä¸éœ€è¦ç§»åŠ¨å…¶å®ƒå…ƒç´ ã€‚ å¯¹äºå•å‘é“¾è¡¨è€Œè¨€ï¼Œé“¾è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½è¦ä¿å­˜ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚ å¯¹äºåŒå‘é“¾è¡¨è€Œè¨€ï¼Œé“¾è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ—¢è¦ä¿å­˜æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼Œåˆè¦ä¿å­˜æŒ‡å‘ä¸Šä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚ å¯¹äºåŒå‘å¾ªç¯é“¾è¡¨è€Œè¨€ï¼Œé“¾è¡¨ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ä¿å­˜ä¸€ä¸ªæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚ æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ«ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ æ¯”è¾ƒ æ•°ç»„ é“¾è¡¨ é€»è¾‘ç»“æ„ (1) æ•°ç»„åœ¨å†…å­˜ä¸­è¿ç»­ï¼› (2)ä½¿ç”¨æ•°ç»„ä¹‹å‰ï¼Œå¿…é¡»äº‹å…ˆå›ºå®šæ•°ç»„é•¿åº¦ï¼Œä¸æ”¯æŒåŠ¨æ€æ”¹å˜æ•°ç»„å¤§å°ï¼› (3) æ•°ç»„å…ƒç´ å¢åŠ æ—¶ï¼Œæœ‰å¯èƒ½ä¼šæ•°ç»„è¶Šç•Œï¼› (4) æ•°ç»„å…ƒç´ å‡å°‘æ—¶ï¼Œä¼šé€ æˆå†…å­˜æµªè´¹ï¼› ï¼ˆ5ï¼‰æ•°ç»„å¢åˆ æ—¶éœ€è¦ç§»åŠ¨å…¶å®ƒå…ƒç´  (1) é“¾è¡¨é‡‡ç”¨åŠ¨æ€å†…å­˜åˆ†é…çš„æ–¹å¼ï¼Œåœ¨å†…å­˜ä¸­ä¸è¿ç»­ (2)æ”¯æŒåŠ¨æ€å¢åŠ æˆ–è€…åˆ é™¤å…ƒç´  (3) éœ€è¦æ—¶å¯ä»¥ä½¿ç”¨mallocæˆ–è€…newæ¥ç”³è¯·å†…å­˜ï¼Œä¸ç”¨æ—¶ä½¿ç”¨freeæˆ–è€…deleteæ¥é‡Šæ”¾å†…å­˜ å†…å­˜ç»“æ„ æ•°ç»„ä»æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œä½†æ˜¯è‡ªç”±åº¦å° é“¾è¡¨ä»å †ä¸Šåˆ†é…å†…å­˜ï¼Œè‡ªç”±åº¦å¤§ï¼Œä½†æ˜¯è¦æ³¨æ„å†…å­˜æ³„æ¼ è®¿é—®æ•ˆç‡ æ•°ç»„åœ¨å†…å­˜ä¸­é¡ºåºå­˜å‚¨ï¼Œå¯é€šè¿‡ä¸‹æ ‡è®¿é—®ï¼Œè®¿é—®æ•ˆç‡é«˜ é“¾è¡¨è®¿é—®æ•ˆç‡ä½ï¼Œå¦‚æœæƒ³è¦è®¿é—®æŸä¸ªå…ƒç´ ï¼Œéœ€è¦ä»å¤´éå† è¶Šç•Œé—®é¢˜ æ•°ç»„çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥å­˜åœ¨è®¿é—®è¶Šç•Œçš„é£é™© è¶Šç•Œçš„é£é™© åªè¦å¯ä»¥ç”³è¯·å¾—åˆ°é“¾è¡¨ç©ºé—´ï¼Œé“¾è¡¨å°±æ— è¶Šç•Œé£é™© æ•°ç»„å’Œé“¾è¡¨çš„ä½¿ç”¨åœºæ™¯ æ¯”è¾ƒ æ•°ç»„ä½¿ç”¨åœºæ™¯ é“¾è¡¨ä½¿ç”¨åœºæ™¯ ç©ºé—´ æ•°ç»„çš„å­˜å‚¨ç©ºé—´æ˜¯æ ˆä¸Šåˆ†é…çš„ï¼Œå­˜å‚¨å¯†åº¦å¤§ï¼Œå½“è¦æ±‚å­˜å‚¨çš„å¤§å°å˜åŒ–ä¸å¤§æ—¶ï¼Œä¸”å¯ä»¥äº‹å…ˆç¡®å®šå¤§å°ï¼Œå®œé‡‡ç”¨æ•°ç»„å­˜å‚¨æ•°æ® é“¾è¡¨çš„å­˜å‚¨ç©ºé—´æ˜¯å †ä¸ŠåŠ¨æ€ç”³è¯·çš„ï¼Œå½“è¦æ±‚å­˜å‚¨çš„é•¿åº¦å˜åŒ–è¾ƒå¤§æ—¶ï¼Œä¸”äº‹å…ˆæ— æ³•ä¼°é‡æ•°æ®è§„æ¨¡ï¼Œå®œé‡‡ç”¨é“¾è¡¨å­˜å‚¨ æ—¶é—´ æ•°ç»„è®¿é—®æ•ˆç‡é«˜ã€‚å½“çº¿æ€§è¡¨çš„æ“ä½œä¸»è¦æ˜¯è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¾ˆå°‘æ’å…¥å’Œåˆ é™¤æ—¶ï¼Œå®œé‡‡ç”¨æ•°ç»„ç»“æ„ é“¾è¡¨æ’å…¥ã€åˆ é™¤æ•ˆç‡é«˜ï¼Œå½“çº¿æ€§è¡¨è¦æ±‚é¢‘ç¹æ’å…¥å’Œåˆ é™¤æ—¶ï¼Œå®œé‡‡ç”¨é“¾è¡¨ç»“æ„ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:2","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"3. æ™ºèƒ½æŒ‡é’ˆ æˆ‘ä»¬çŸ¥é“é™¤äº†é™æ€å†…å­˜å’Œæ ˆå†…å­˜å¤–ï¼Œæ¯ä¸ªç¨‹åºè¿˜æœ‰ä¸€ä¸ªå†…å­˜æ± ï¼Œè¿™éƒ¨åˆ†å†…å­˜è¢«ç§°ä¸ºè‡ªç”±ç©ºé—´æˆ–è€…å †ã€‚ç¨‹åºç”¨å †æ¥å­˜å‚¨åŠ¨æ€åˆ†é…çš„å¯¹è±¡å³é‚£äº›åœ¨ç¨‹åºè¿è¡Œæ—¶åˆ†é…çš„å¯¹è±¡ï¼Œå½“åŠ¨æ€å¯¹è±¡ä¸å†ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬çš„ä»£ç å¿…é¡»æ˜¾å¼çš„é”€æ¯å®ƒä»¬ã€‚ åœ¨C++ä¸­ï¼ŒåŠ¨æ€å†…å­˜çš„ç®¡ç†æ˜¯ç”¨ä¸€å¯¹è¿ç®—ç¬¦å®Œæˆçš„ï¼šnewå’Œdeleteï¼Œnew:åœ¨åŠ¨æ€å†…å­˜ä¸­ä¸ºå¯¹è±¡åˆ†é…ä¸€å—ç©ºé—´å¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆï¼Œdeleteï¼šæŒ‡å‘ä¸€ä¸ªåŠ¨æ€ç‹¬äº«çš„æŒ‡é’ˆï¼Œé”€æ¯å¯¹è±¡ï¼Œå¹¶é‡Šæ”¾ä¸ä¹‹å…³è”çš„å†…å­˜ã€‚ åŠ¨æ€å†…å­˜ç®¡ç†ç»å¸¸ä¼šå‡ºç°ä¸¤ç§é—®é¢˜ï¼šä¸€ç§æ˜¯å¿˜è®°é‡Šæ”¾å†…å­˜ï¼Œä¼šé€ æˆå†…å­˜æ³„æ¼ï¼›ä¸€ç§æ˜¯å°šæœ‰æŒ‡é’ˆå¼•ç”¨å†…å­˜çš„æƒ…å†µä¸‹å°±é‡Šæ”¾äº†å®ƒï¼Œå°±ä¼šäº§ç”Ÿå¼•ç”¨éæ³•å†…å­˜çš„æŒ‡é’ˆã€‚ ä¸ºäº†æ›´åŠ å®¹æ˜“ï¼ˆæ›´åŠ å®‰å…¨ï¼‰çš„ä½¿ç”¨åŠ¨æ€å†…å­˜ï¼Œå¼•å…¥äº†æ™ºèƒ½æŒ‡é’ˆçš„æ¦‚å¿µã€‚æ™ºèƒ½æŒ‡é’ˆçš„è¡Œä¸ºç±»ä¼¼å¸¸è§„æŒ‡é’ˆï¼Œé‡è¦çš„åŒºåˆ«æ˜¯å®ƒè´Ÿè´£è‡ªåŠ¨é‡Šæ”¾æ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚æ ‡å‡†åº“æä¾›çš„ä¸¤ç§æ™ºèƒ½æŒ‡é’ˆçš„åŒºåˆ«åœ¨äºç®¡ç†åº•å±‚æŒ‡é’ˆçš„æ–¹æ³•ä¸åŒï¼Œshared_ptrå…è®¸å¤šä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œunique_ptråˆ™â€œç‹¬å â€æ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚æ ‡å‡†åº“è¿˜å®šä¹‰äº†ä¸€ç§åä¸ºweak_ptrçš„ä¼´éšç±»ï¼Œå®ƒæ˜¯ä¸€ç§å¼±å¼•ç”¨ï¼ŒæŒ‡å‘shared_ptræ‰€ç®¡ç†çš„å¯¹è±¡ï¼Œè¿™ä¸‰ç§æ™ºèƒ½æŒ‡é’ˆéƒ½å®šä¹‰åœ¨memoryå¤´æ–‡ä»¶ä¸­ã€‚ 1 æ™ºèƒ½æŒ‡é’ˆçš„ä½œç”¨ æ™ºèƒ½æŒ‡é’ˆæ˜¯ä¸€ä¸ªç±»ï¼Œç”¨æ¥å­˜å‚¨æŒ‡å‘åŠ¨æ€åˆ†é…å¯¹è±¡çš„æŒ‡é’ˆï¼Œè´Ÿè´£è‡ªåŠ¨é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å¯¹è±¡ï¼Œé˜²æ­¢å †å†…å­˜æ³„æ¼ã€‚åŠ¨æ€åˆ†é…çš„èµ„æºï¼Œäº¤ç»™ä¸€ä¸ªç±»å¯¹è±¡å»ç®¡ç†ï¼Œå½“ç±»å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°é‡Šæ”¾èµ„æº 2 æ™ºèƒ½æŒ‡é’ˆçš„ç§ç±»: shared_ptrã€unique_ptrã€weak_ptrã€auto_ptr å››ç§æŒ‡é’ˆè¯¦æƒ… 2.1 æ™ºèƒ½æŒ‡é’ˆçš„å®ç°åŸç† æ™ºèƒ½æŒ‡é’ˆçš„å®ç°åŸç†å°±æ˜¯åœ¨ä¸€ä¸ªç±»çš„å†…éƒ¨å°è£…äº†ç±»å¯¹è±¡çš„æŒ‡é’ˆï¼Œç„¶ååœ¨ææ„å‡½æ•°é‡Œå¯¹æˆ‘ä»¬çš„ç±»å¯¹è±¡æŒ‡é’ˆè¿›è¡Œé‡Šæ”¾ï¼Œå› ä¸ºç±»çš„ææ„æ˜¯åœ¨ç±»å¯¹è±¡ç”Ÿå‘½æœŸç»“æŸæ—¶è‡ªåŠ¨è°ƒç”¨çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±çœå»äº†æ‰‹åŠ¨é‡Šæ”¾å†…å­˜çš„æ“ä½œï¼Œé¿å…å¿˜è®°æ‰‹åŠ¨é‡Šæ”¾å¯¼è‡´çš„å†…å­˜æ³„æ¼ã€‚ 2.2 C++11å››ç§æ™ºèƒ½æŒ‡é’ˆæ€»ç»“ 2.2.1 auto_ptrï¼š auto_pträ»¥å‰æ˜¯ç”¨åœ¨C98ä¸­ï¼ŒC++11è¢«æŠ›å¼ƒï¼Œå¤´æ–‡ä»¶ä¸€èˆ¬ç”¨æ¥ä½œä¸ºç‹¬å æŒ‡é’ˆ auto_ptrè¢«èµ‹å€¼æˆ–è€…æ‹·è´åï¼Œå¤±å»å¯¹åŸæŒ‡é’ˆçš„ç®¡ç† auto_pträ¸èƒ½ç®¡ç†æ•°ç»„æŒ‡é’ˆï¼Œå› ä¸ºauto_ptrçš„å†…éƒ¨å®ç°ä¸­ï¼Œææ„å‡½æ•°ä¸­åˆ é™¤å¯¹è±¡ä½¿ç”¨deleteè€Œä¸æ˜¯delete[]ï¼Œé‡Šæ”¾å†…å­˜çš„æ—¶å€™ä»…é‡Šæ”¾äº†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç©ºé—´ï¼Œä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚ auto_pträ¸èƒ½ä½œä¸ºå®¹å™¨å¯¹è±¡ï¼Œå› ä¸ºSTLå®¹å™¨ä¸­çš„å…ƒç´ ç»å¸¸è¦æ”¯æŒæ‹·è´ï¼Œèµ‹å€¼ç­‰æ“ä½œã€‚ 2.2.2 unique_ptr: C++11ä¸­ç”¨æ¥æ›¿ä»£auto_ptr æ‹·è´æ„é€ å’Œèµ‹å€¼è¿ç®—ç¬¦è¢«ç¦ç”¨ï¼Œä¸èƒ½è¿›è¡Œæ‹·è´æ„é€ å’Œèµ‹å€¼è¿ç®— è™½ç„¶ç¦ç”¨äº†æ‹·è´æ„é€ å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼Œä½†unique_ptrå¯ä»¥ä½œä¸ºè¿”å›å€¼ï¼Œç”¨äºä»æŸä¸ªå‡½æ•°ä¸­è¿”å›åŠ¨æ€ç”³è¯·å†…å­˜çš„æ‰€æœ‰æƒï¼Œæœ¬è´¨ä¸Šæ˜¯ç§»åŠ¨æ‹·è´ï¼Œå°±æ˜¯ä½¿ç”¨std:move()å‡½æ•°ï¼Œå°†æ‰€æœ‰æƒè½¬ç§»ã€‚ 2.2.3 share_ptr: å¤šä¸ªæŒ‡é’ˆå¯ä»¥æŒ‡å‘ç›¸åŒçš„å¯¹è±¡ï¼Œè°ƒç”¨release()è®¡æ•°-1ï¼Œè®¡æ•°0æ—¶èµ„æºé‡Šæ”¾ .use_count()æŸ¥è®¡æ•° .reset()æ”¾å¼ƒå†…éƒ¨æ‰€æœ‰æƒ share_ptrå¤šæ¬¡å¼•ç”¨åŒä¸€æ•°æ®ä¼šå¯¼è‡´å†…å­˜å¤šæ¬¡é‡Šæ”¾ å¾ªç¯å¼•ç”¨ä¼šå¯¼è‡´æ­»é”ï¼Œ å¼•ç”¨è®¡æ•°ä¸æ˜¯åŸå­æ“ä½œã€‚ shared_ptr æœ‰ä¸¤ä¸ªæ•°æ®æˆå‘˜ï¼Œä¸€ä¸ªæ˜¯æŒ‡å‘ å¯¹è±¡çš„æŒ‡é’ˆ ptrï¼Œå¦ä¸€ä¸ªæ˜¯ ref_count æŒ‡é’ˆï¼ˆåŒ…å«vptrã€use_countã€weak_countã€ptrç­‰ï¼‰ï¼› åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° shared_ptr\u003cFoo\u003e x(new Foo); shared_ptr\u003cFoo\u003e y = x; æ­¥éª¤ä¸€ï¼š `y=x` æ¶‰åŠä¸¤ä¸ªæˆå‘˜çš„å¤åˆ¶ï¼Œè¿™ä¸¤æ­¥æ‹·è´ä¸ä¼šåŒæ—¶ï¼ˆåŸå­ï¼‰å‘ç”Ÿï¼Œä¸­é—´æ­¥éª¤ 1ï¼Œå¤åˆ¶ ptr æŒ‡é’ˆï¼Œä¸­é—´æ­¥éª¤ 2ï¼Œå¤åˆ¶ ref_count æŒ‡é’ˆï¼Œå¯¼è‡´å¼•ç”¨è®¡æ•°åŠ  1 æ­¥éª¤äºŒ: å› ä¸ºæ˜¯ä¸¤æ­¥ï¼Œå¦‚æœæ²¡æœ‰ mutex ä¿æŠ¤ï¼Œé‚£ä¹ˆåœ¨å¤šçº¿ç¨‹é‡Œå°±æœ‰æ•°æ®ç«äº‰ã€‚ å¤šçº¿ç¨‹è¯»å†™åŒä¸€ä¸ª shared_ptr å¿…é¡»åŠ é”ã€‚ 2.2.4 weak_ptr: 1.è§£å†³ä¸¤ä¸ªshare_pträº’ç›¸å¼•ç”¨äº§ç”Ÿæ­»é”ï¼Œè®¡æ•°æ°¸è¿œé™ä¸åˆ°0ï¼Œæ²¡åŠæ³•è¿›è¡Œèµ„æºé‡Šæ”¾ï¼Œé€ æˆå†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚ 2.ä½¿ç”¨æ—¶é…åˆshare_pträ½¿ç”¨ï¼ŒæŠŠå…¶ä¸­ä¸€ä¸ªshare_ptræ›´æ¢ä¸ºweak_ptrã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:3","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"4. é‡è½½ã€é‡å†™ã€é‡å®šä¹‰ (1) é‡è½½ï¼ˆoverloadï¼‰ï¼š æŒ‡å‡½æ•°åç›¸åŒï¼Œä½†æ˜¯å®ƒçš„å‚æ•°è¡¨åˆ—ä¸ªæ•°æˆ–é¡ºåºï¼Œç±»å‹ä¸åŒã€‚ä½†æ˜¯ä¸èƒ½é è¿”å›ç±»å‹æ¥åˆ¤æ–­ã€‚ a ç›¸åŒçš„èŒƒå›´ï¼ˆåœ¨åŒä¸€ä¸ªç±»ä¸­ï¼‰ b å‡½æ•°åå­—ç›¸åŒã€ å‚æ•°ä¸åŒ c virtualå…³é”®å­—å¯æœ‰å¯æ—  d è¿”å›å€¼å¯ä»¥ä¸åŒï¼› (2) é‡å†™ï¼ˆè¦†ç›–override)æ˜¯æŒ‡æ´¾ç”Ÿç±»å‡½æ•°è¦†ç›–åŸºç±»å‡½æ•°ï¼Œç‰¹å¾æ˜¯ï¼š a ä¸åŒçš„èŒƒå›´ï¼Œåˆ†åˆ«ä½äºåŸºç±»å’Œæ´¾ç”Ÿç±»ä¸­ b å‡½æ•°çš„åå­—ç›¸åŒã€ å‚æ•°ç›¸åŒ c åŸºç±»å‡½æ•°å¿…é¡»æœ‰virtualå…³é”®å­—ï¼Œä¸èƒ½æœ‰static d è¿”å›å€¼ç›¸åŒï¼ˆæˆ–è€…åå˜ï¼‰ï¼Œå¦åˆ™æŠ¥é”™ï¼› e é‡å†™å‡½æ•°çš„è®¿é—®ä¿®é¥°ç¬¦å¯ä»¥ä¸åŒã€‚å°½ç®¡virtualæ˜¯privateçš„ï¼Œæ´¾ç”Ÿç±»ä¸­é‡å†™æ”¹å†™ä¸ºpublic, protectedä¹Ÿæ˜¯å¯ä»¥çš„ (3) é‡å®šä¹‰(éšè—redefine)æ˜¯æŒ‡æ´¾ç”Ÿç±»çš„å‡½æ•°å±è”½äº†ä¸å…¶åŒåçš„åŸºç±»å‡½æ•°ï¼Œç‰¹å¾æ˜¯ï¼š a ä¸åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸï¼ˆåˆ†åˆ«ä½äºæ´¾ç”Ÿç±»ä¸åŸºç±»ï¼‰ b å‡½æ•°åå­—ç›¸åŒ c è¿”å›å€¼å¯ä»¥ä¸åŒ d è§„åˆ™ï¼š å¦‚æœæ´¾ç”Ÿç±»çš„å‡½æ•°å’ŒåŸºç±»çš„å‡½æ•°åŒåï¼Œä½†æ˜¯å‚æ•°ä¸åŒï¼Œæ­¤æ—¶ï¼Œä¸ç®¡æœ‰æ— virtualï¼ŒåŸºç±»çš„å‡½æ•°è¢«éšè—ï¼› å¦‚æœæ´¾ç”Ÿç±»çš„å‡½æ•°ä¸åŸºç±»çš„å‡½æ•°åŒåï¼Œå¹¶ä¸”å‚æ•°ä¹Ÿç›¸åŒï¼Œä½†æ˜¯åŸºç±»å‡½æ•°æ²¡æœ‰vitualå…³é”®å­—ï¼Œæ­¤æ—¶ï¼ŒåŸºç±»çš„å‡½æ•°è¢«éšè—ã€‚ ps: å¤šæ€æ€§å¯ä»¥åˆ†ä¸ºé™æ€å¤šæ€æ€§ï¼ˆæ–¹æ³•çš„é‡è½½ï¼Œä¸€ä¸ªç±»ï¼‰å’ŒåŠ¨æ€å¤šæ€æ€§ï¼ˆæ–¹æ³•çš„è¦†ç›–ï¼Œæœ‰ç»§æ‰¿å…³ç³»çš„ç±»ä¹‹é—´çš„è¡Œä¸ºï¼‰ã€‚è¿›è€Œå¤šæ€æ€§å¯ä»¥ç”±é‡è½½å’Œè¦†ç›–æ¥å®ç°ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:4","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"5.staticä¸conståŒºåˆ«å’Œä½œç”¨ static: 1.**staticå±€éƒ¨å˜é‡**å°†ä¸€ä¸ªå˜é‡å£°æ˜ä¸ºå‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå±€éƒ¨å˜é‡åœ¨å‡½æ•°æ‰§è¡Œå®Œä¸ä¼šé‡Šæ”¾ï¼Œè€Œæ˜¯ç»§ç»­ä¿ç•™åœ¨å†…å­˜ä¸­ï¼› 2.**staticå…¨å±€å˜é‡**è¡¨ç¤ºä¸€ä¸ªå˜é‡åœ¨å½“å‰æ–‡ä»¶çš„å…¨å±€å¯ä»¥è®¿é—®ï¼› 3.**staticå‡½æ•°**è¡¨ç¤ºä¸€ä¸ªå‡½æ•°åªèƒ½åœ¨å½“å‰æ–‡ä»¶ä¸­è¢«è®¿é—®ï¼› 4.**staticç±»æˆå‘˜å˜é‡**è¡¨ç¤ºè¿™ä¸ªæˆå‘˜ä¸ºå…¨ç±»æ‰€å…±æœ‰ï¼› 5.**staticç±»æˆå‘˜å‡½æ•°**è¡¨ç¤ºè¿™ä¸ªå‡½æ•°ä¸ºå…¨ç±»æ‰€æœ‰ï¼Œä¸”åªèƒ½è®¿é—®æˆå‘˜å˜é‡ã€‚ 6.å…¨å±€å˜é‡åœ¨æ•´ä¸ªå·¥ç¨‹æ–‡ä»¶å†…æœ‰æ•ˆï¼›é™æ€å…¨å±€å˜é‡åªåœ¨å®šä¹‰å®ƒçš„æ–‡ä»¶ä¸­æœ‰æ•ˆï¼› 7.é™æ€å±€éƒ¨å˜é‡åªåœ¨å®šä¹‰å®ƒçš„å‡½æ•°å†…æœ‰æ•ˆï¼Œä¸”ç¨‹åºåªåˆ†é…ä¸€æ¬¡å†…å­˜ï¼Œå‡½æ•°è¿”å›æ—¶ä¸ä¼šé‡Šæ”¾ï¼Œä¸‹æ¬¡è°ƒç”¨æ—¶ä¸ä¼šé‡æ–°èµ‹å€¼ï¼Œè¿˜ä¿ç•™ä¸Šæ¬¡ç»“æœå€¼ï¼›å±€éƒ¨å˜é‡åœ¨å‡½æ•°è¿”å›æ—¶å°±é‡Šæ”¾æ‰ï¼› 8.å…¨å±€å˜é‡å’Œé™æ€å˜é‡ç¼–è¯‘å™¨ä¼šé»˜è®¤åˆå§‹åŒ–ä¸º0ï¼›å±€éƒ¨å˜é‡çš„é»˜è®¤å€¼æœªçŸ¥ï¼› 9.å±€éƒ¨é™æ€å˜é‡ä¸å…¨å±€å˜é‡å…±äº«å…¨å±€æ•°æ®ï¼Œä½†æ˜¯é™æ€å±€éƒ¨å˜é‡å€¼åœ¨å®šä¹‰è¯¥å˜é‡çš„å‡½æ•°å†…éƒ¨å¯è§ã€‚ 10.é™æ€æˆå‘˜ï¼ˆé™æ€æˆå‘˜å‡½æ•°ï¼‰ä¸éé™æ€æˆå‘˜ï¼ˆæˆå‘˜å‡½æ•°ï¼‰çš„åŒºåˆ«åœ¨äºæœ‰æ— thisæŒ‡é’ˆï¼›é™æ€æˆå‘˜æ˜¯é™æ€å­˜å‚¨ï¼Œå¿…é¡»è¿›è¡Œåˆå§‹åŒ–ï¼› 11.é™æ€æˆå‘˜å‡½æ•°è®¿é—®éé™æ€æˆå‘˜æŠ¥é”™: é™æ€æˆå‘˜åœ¨ç±»åŠ è½½æ—¶å°±å·²ç»åˆ†é…å†…å­˜ï¼Œè€Œæ­¤æ—¶éé™æ€æˆå‘˜å°šæœªåˆ†é…å†…å­˜ï¼Œè®¿é—®ä¸å­˜åœ¨çš„å†…å­˜è‡ªç„¶ä¼šæŠ¥é”™ï¼› const 1.\u003cfont color=red\u003econstå¸¸é‡\u003c/font\u003e å®šä¹‰æ—¶å¿…é¡»åˆå§‹åŒ–ï¼Œä»¥åä¸èƒ½ä¿®æ”¹ï¼› 2.\u003cfont color=red\u003econstå½¢å‚\u003c/font\u003e è¯¥å½¢å‚åœ¨å‡½æ•°é‡Œä¸èƒ½è¢«ä¿®æ”¹ï¼› 3.\u003cfont color=red\u003econstä¿®é¥°ç±»æˆå‘˜å‡½æ•°\u003c/font\u003e è¯¥å‡½æ•°å¯¹æˆå‘˜å˜é‡åªèƒ½è¿›è¡Œè¯»æ“ä½œï¼› staticå…³é”®å­—ä½œç”¨ 1.å‡½æ•°ä½“å†…staticå˜é‡çš„ä½œç”¨èŒƒå›´ä¸ºè¯¥å‡½æ•°ä½“ï¼Œè¯¥å˜é‡çš„å†…å­˜åªè¢«åˆ†é…ä¸€æ¬¡ï¼Œå› æ­¤è¯¥å€¼åœ¨ä¸‹æ¬¡è°ƒç”¨æ—¶è¿˜ç»´æŒä¸Šä¸€æ¬¡çš„å€¼ï¼› 2.åœ¨æ¨¡å—å†…çš„staticå‡½æ•°å’Œå˜é‡å¯ä»¥è¢«å¯ä»¥è¢«æ¨¡å—å†…çš„å‡½æ•°è®¿é—®ï¼Œä¸èƒ½è¢«æ¨¡å—å¤–çš„å‡½æ•°è®¿é—®ï¼› 3.åœ¨ç±»å†…çš„staticæˆå‘˜å˜é‡ä¸ºæ•´ä¸ªç±»æ‰€æœ‰ï¼Œç±»çš„æ‰€æœ‰å¯¹è±¡åªæœ‰ä¸€ä»½æ‹·è´ï¼› 4.åœ¨ç±»å†…çš„staticæˆå‘˜å‡½æ•°ä¸ºæ•´ä¸ªç±»æ‰€æœ‰ï¼Œè¿™ä¸ªå‡½æ•°ä¸æ¥æ”¶thisæŒ‡é’ˆï¼Œå› æ­¤åªèƒ½è®¿é—®ç±»çš„staticæˆå‘˜å˜é‡ï¼› constå…³é”®å­— 1.é˜»æ­¢ä¸€ä¸ªå˜é‡è¢«æ”¹å˜ï¼› 2.å£°æ˜å¸¸é‡æŒ‡é’ˆå’ŒæŒ‡é’ˆå¸¸é‡ï¼› 3.constä¿®é¥°å½¢å‚ï¼Œè¡¨ç¤ºä¸ºè¾“å…¥å‚æ•°ï¼Œåœ¨å‡½æ•°ä½“å†…ä¸èƒ½ä¿®æ”¹è¯¥å‚æ•°çš„å€¼ï¼› 4.constä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œè¡¨æ˜ä¸ºä¸€ä¸ªå¸¸å‡½æ•°ï¼Œä¸èƒ½ä¿®æ”¹æˆå‘˜å˜é‡çš„å€¼ï¼› 5.ç±»çš„æˆå‘˜å‡½æ•°ï¼Œæœ‰æ—¶å¿…é¡»è¿”å›constç±»å‹çš„å€¼ï¼Œä½¿å¾—è¿”å›å€¼ä¸èƒ½ä¸ºå·¦å€¼ã€‚ constä¿®é¥°æŒ‡é’ˆæœ‰ä¸‰ç§æƒ…å†µ constä¿®é¥°æŒ‡é’ˆ â€” å¸¸é‡æŒ‡é’ˆ (constä¿®é¥°çš„æ˜¯æŒ‡é’ˆ,æŒ‡é’ˆæŒ‡å‘å¯ä»¥æ”¹,æŒ‡é’ˆæŒ‡å‘çš„å€¼ä¸å¯ä»¥æ›´æ”¹) const int * p1 = \u0026a; p1 = \u0026b; //æ­£ç¡® //*p1 = 100; æŠ¥é”™ constä¿®é¥°å¸¸é‡ â€” æŒ‡é’ˆå¸¸é‡ (constä¿®é¥°çš„æ˜¯å¸¸é‡,æŒ‡é’ˆæŒ‡å‘ä¸å¯ä»¥æ”¹,æŒ‡é’ˆæŒ‡å‘çš„å€¼å¯ä»¥æ›´æ”¹) int * const p2 = \u0026a; //p2 = \u0026b; //é”™è¯¯ *p2 = 100; //æ­£ç¡® constå³ä¿®é¥°æŒ‡é’ˆ,åˆä¿®é¥°å¸¸é‡ (constæ—¢ä¿®é¥°æŒ‡é’ˆåˆä¿®é¥°å¸¸é‡ï¼Œéƒ½ä¸å¯ä»¥æ”¹) const int * const p3 = \u0026a; //p3 = \u0026b; //é”™è¯¯ //*p3 = 100; //é”™è¯¯ æŠ€å·§:çœ‹constå³ä¾§ç´§è·Ÿç€çš„æ˜¯æŒ‡é’ˆè¿˜æ˜¯å¸¸é‡, æ˜¯æŒ‡é’ˆå°±æ˜¯å¸¸æŒ‡é’ˆ,æ˜¯å¸¸é‡å°±æ˜¯æŒ‡é’ˆå¸¸é‡ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:5","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"6. constä¸å®å®šä¹‰ï¼ˆ#defineï¼‰åŒºåˆ«å’Œä½œç”¨ const å®šä¹‰çš„æ˜¯å˜é‡ä¸æ˜¯å¸¸é‡ï¼Œåªæ˜¯è¿™ä¸ªå˜é‡çš„å€¼ä¸å…è®¸æ”¹å˜ï¼Œæ˜¯å¸¸å˜é‡ï¼Œå¸¦æœ‰ç±»å‹ã€‚ç¼–è¯‘è¿è¡Œçš„æ—¶å€™èµ·ä½œç”¨ï¼Œå­˜åœ¨ç±»å‹æ£€æŸ¥ã€‚ define å®šä¹‰çš„æ˜¯ä¸å¸¦ç±»å‹çš„å¸¸æ•°ï¼Œåªè¿›è¡Œç®€å•çš„å­—ç¬¦æ›¿æ¢ã€‚åœ¨é¢„ç¼–è¯‘çš„æ—¶å€™èµ·ä½œç”¨ï¼Œä¸å­˜åœ¨ç±»å‹æ£€æŸ¥ã€‚ 1ã€ä¸¤è€…çš„åŒºåˆ« (1) ç¼–è¯‘å™¨å¤„ç†æ–¹å¼ä¸åŒ #define å®æ˜¯åœ¨é¢„å¤„ç†é˜¶æ®µå±•å¼€ã€‚ const å¸¸é‡æ˜¯ç¼–è¯‘è¿è¡Œé˜¶æ®µä½¿ç”¨ã€‚ (2) ç±»å‹å’Œå®‰å…¨æ£€æŸ¥ä¸åŒ #define å®æ²¡æœ‰ç±»å‹ï¼Œä¸åšä»»ä½•ç±»å‹æ£€æŸ¥ï¼Œä»…ä»…æ˜¯å±•å¼€ã€‚ const å¸¸é‡æœ‰å…·ä½“çš„ç±»å‹ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šæ‰§è¡Œç±»å‹æ£€æŸ¥ã€‚ (3) å­˜å‚¨æ–¹å¼ä¸åŒ #defineå®ä»…ä»…æ˜¯å±•å¼€ï¼Œæœ‰å¤šå°‘åœ°æ–¹ä½¿ç”¨ï¼Œå°±å±•å¼€å¤šå°‘æ¬¡ï¼Œä¸ä¼šåˆ†é…å†…å­˜ã€‚ï¼ˆå®å®šä¹‰ä¸åˆ†é…å†…å­˜ï¼Œå˜é‡å®šä¹‰åˆ†é…å†…å­˜ã€‚ï¼‰ constå¸¸é‡ä¼šåœ¨å†…å­˜ä¸­åˆ†é…(å¯ä»¥æ˜¯å †ä¸­ä¹Ÿå¯ä»¥æ˜¯æ ˆä¸­)ã€‚ (4) const å¯ä»¥èŠ‚çœç©ºé—´ï¼Œé¿å…ä¸å¿…è¦çš„å†…å­˜åˆ†é…ã€‚ ä¾‹å¦‚ï¼š const å®šä¹‰å¸¸é‡ä»æ±‡ç¼–çš„è§’åº¦æ¥çœ‹ï¼Œåªæ˜¯ç»™å‡ºäº†å¯¹åº”çš„å†…å­˜åœ°å€ï¼Œè€Œä¸æ˜¯è±¡ #define ä¸€æ ·ç»™å‡ºçš„æ˜¯ç«‹å³æ•°ï¼Œæ‰€ä»¥ï¼Œconst å®šä¹‰çš„å¸¸é‡åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åªæœ‰ä¸€ä»½æ‹·è´ï¼ˆå› ä¸ºæ˜¯å…¨å±€çš„åªè¯»å˜é‡ï¼Œå­˜åœ¨é™æ€åŒºï¼‰ï¼Œè€Œ #define å®šä¹‰çš„å¸¸é‡åœ¨å†…å­˜ä¸­æœ‰è‹¥å¹²ä¸ªæ‹·è´ã€‚ (5) æé«˜äº†æ•ˆç‡ã€‚ ç¼–è¯‘å™¨é€šå¸¸ä¸ä¸ºæ™®é€šconstå¸¸é‡åˆ†é…å­˜å‚¨ç©ºé—´ï¼Œè€Œæ˜¯å°†å®ƒä»¬ä¿å­˜åœ¨ç¬¦å·è¡¨ä¸­ï¼Œè¿™ä½¿å¾—å®ƒæˆä¸ºä¸€ä¸ªç¼–è¯‘æœŸé—´çš„å¸¸é‡ï¼Œæ²¡æœ‰äº†å­˜å‚¨ä¸è¯»å†…å­˜çš„æ“ä½œï¼Œä½¿å¾—å®ƒçš„æ•ˆç‡ä¹Ÿå¾ˆé«˜ã€‚ (6) å®æ›¿æ¢åªä½œæ›¿æ¢ï¼Œä¸åšè®¡ç®—ï¼Œä¸åšè¡¨è¾¾å¼æ±‚è§£;å®é¢„ç¼–è¯‘æ—¶å°±æ›¿æ¢äº†ï¼Œç¨‹åºè¿è¡Œæ—¶ï¼Œå¹¶ä¸åˆ†é…å†…å­˜ã€‚è®¡ç®—æ—¶æ³¨æ„è¾¹ç¼˜æ•ˆåº” ","date":"2023-07-11","objectID":"/posts/basics_two/:2:6","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"7.è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°åŒºåˆ« 1.è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°å¯ä»¥å®šä¹‰åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œå«æœ‰çº¯è™šå‡½æ•°çš„ç±»è¢«ç§°ä¸ºæŠ½è±¡ç±»ï¼Œè€Œåªå«æœ‰è™šå‡½æ•°çš„ç±»ä¸èƒ½è¢«ç§°ä¸ºæŠ½è±¡ç±»ã€‚ 2.è™šå‡½æ•°å¯ä»¥è¢«ç›´æ¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥è¢«å­ç±»é‡è½½ä»¥åï¼Œä»¥å¤šæ€çš„å½¢å¼è°ƒç”¨ï¼Œè€Œçº¯è™šå‡½æ•°å¿…é¡»åœ¨å­ç±»ä¸­å®ç°è¯¥å‡½æ•°æ‰å¯ä»¥ä½¿ç”¨ï¼Œå› ä¸ºçº¯è™šå‡½æ•°åœ¨åŸºç±»æœ‰å£°æ˜è€Œæ²¡æœ‰å®šä¹‰ã€‚ 3.è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°éƒ½å¯ä»¥åœ¨å­ç±»ä¸­è¢«é‡è½½ï¼Œä»¥å¤šæ€çš„å½¢å¼è¢«è°ƒç”¨ã€‚ 4.è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°é€šå¸¸å­˜åœ¨äºæŠ½è±¡åŸºç±»ä¹‹ä¸­ï¼Œè¢«ç»§æ‰¿çš„å­ç±»é‡è½½ï¼Œç›®çš„æ˜¯æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ã€‚ 5.è™šå‡½æ•°çš„å®šä¹‰å½¢å¼ï¼švirtual{};çº¯è™šå‡½æ•°çš„å®šä¹‰å½¢å¼ï¼švirtual { } = 0;åœ¨è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°çš„å®šä¹‰ä¸­ä¸èƒ½æœ‰staticæ ‡è¯†ç¬¦ï¼ŒåŸå› å¾ˆç®€å•ï¼Œè¢«staticä¿®é¥°çš„å‡½æ•°åœ¨ç¼–è¯‘æ—¶è¦æ±‚å‰æœŸç»‘å®š,ç„¶è€Œè™šå‡½æ•°å´æ˜¯åŠ¨æ€ç»‘å®šï¼Œè€Œä¸”è¢«ä¸¤è€…ä¿®é¥°çš„å‡½æ•°ç”Ÿå‘½å‘¨æœŸä¹Ÿä¸ä¸€æ ·ã€‚ 6.è™šå‡½æ•°å……åˆ†ä½“ç°äº†é¢å‘å¯¹è±¡æ€æƒ³ä¸­çš„ç»§æ‰¿å’Œå¤šæ€æ€§è¿™ä¸¤å¤§ç‰¹æ€§ï¼Œåœ¨C++è¯­è¨€é‡Œåº”ç”¨æå¹¿ã€‚æ¯”å¦‚åœ¨å¾®è½¯çš„MFCç±»åº“ä¸­ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šå‡½æ•°éƒ½æœ‰virtualå…³é”®å­—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬éƒ½æ˜¯è™šå‡½æ•°ã€‚éš¾æ€ªæœ‰äººç”šè‡³ç§°è™šå‡½æ•°æ˜¯C++è¯­è¨€çš„ç²¾é«“ã€‚ 7.å®šä¹‰çº¯è™šå‡½æ•°å°±æ˜¯ä¸ºäº†è®©åŸºç±»ä¸å¯å®ä¾‹åŒ–ï¼Œå› ä¸ºå®ä¾‹åŒ–è¿™æ ·çš„æŠ½è±¡æ•°æ®ç»“æ„æœ¬èº«å¹¶æ²¡æœ‰æ„ä¹‰æˆ–è€…ç»™å‡ºå®ç°ä¹Ÿæ²¡æœ‰æ„ä¹‰ã€‚ çº¯è™šå‡½æ•°åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ˜¯ä¸ªå‡½æ•°çš„å£°æ˜è€Œå·²ï¼Œå®ƒè¦ç•™åˆ°å­ç±»é‡Œå»å®ç°ã€‚ è™šå‡½æ•°åœ¨å­ç±»é‡Œé¢ä¹Ÿå¯ä»¥ä¸é‡è½½çš„ï¼›ä½†çº¯è™šå¿…é¡»åœ¨å­ç±»å»å®ç°ï¼Œè¿™å°±åƒJavaçš„æ¥å£ä¸€æ ·ã€‚é€šå¸¸æˆ‘ä»¬æŠŠå¾ˆå¤šå‡½æ•°åŠ ä¸Švirtualï¼Œæ˜¯ä¸€ä¸ªå¥½çš„ä¹ æƒ¯ï¼Œè™½ç„¶ç‰ºç‰²äº†ä¸€äº›æ€§èƒ½ï¼Œä½†æ˜¯å¢åŠ äº†é¢å‘å¯¹è±¡çš„å¤šæ€æ€§ï¼Œå› ä¸ºä½ å¾ˆéš¾é¢„æ–™åˆ°çˆ¶ç±»é‡Œé¢çš„è¿™ä¸ªå‡½æ•°ä¸åœ¨å­ç±»é‡Œé¢ä¸å»ä¿®æ”¹å®ƒçš„å®ç° è™šå‡½æ•°: https://www.cnblogs.com/zkfopen/p/11061414.html ","date":"2023-07-11","objectID":"/posts/basics_two/:2:7","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"8. æŒ‡é’ˆå’Œå¼•ç”¨çš„åŒºåˆ« 1.æŒ‡é’ˆå’Œå¼•ç”¨çš„å®šä¹‰å’Œæ€§è´¨åŒºåˆ«ï¼š (1) æŒ‡é’ˆï¼šæŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œåªä¸è¿‡è¿™ä¸ªå˜é‡å­˜å‚¨çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼ŒæŒ‡å‘å†…å­˜çš„ä¸€ä¸ªå­˜å‚¨å•å…ƒï¼›è€Œå¼•ç”¨è·ŸåŸæ¥çš„å˜é‡å®è´¨ä¸Šæ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œåªä¸è¿‡æ˜¯åŸå˜é‡çš„ä¸€ä¸ªåˆ«åè€Œå·²ã€‚å¦‚ï¼š int a=1;int *p=\u0026a; int a=1;int \u0026b=a; ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªæ•´å½¢å˜é‡å’Œä¸€ä¸ªæŒ‡é’ˆå˜é‡pï¼Œè¯¥æŒ‡é’ˆå˜é‡æŒ‡å‘açš„å­˜å‚¨å•å…ƒï¼Œå³pçš„å€¼æ˜¯aå­˜å‚¨å•å…ƒçš„åœ°å€ã€‚ è€Œä¸‹é¢2å¥å®šä¹‰äº†ä¸€ä¸ªæ•´å½¢å˜é‡aå’Œè¿™ä¸ªæ•´å½¢açš„å¼•ç”¨bï¼Œäº‹å®ä¸Šaå’Œbæ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œåœ¨å†…å­˜å æœ‰åŒä¸€ä¸ªå­˜å‚¨å•å…ƒã€‚ (2)å¼•ç”¨ä¸å¯ä»¥ä¸ºç©ºï¼Œå½“è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œå¿…é¡»åˆå§‹åŒ–ï¼Œè€ŒæŒ‡é’ˆå¯ä»¥æ˜¯ç©ºå€¼ï¼Œå¯ä»¥åœ¨ä»»ä½•æ—¶å€™è¢«åˆå§‹åŒ–ã€‚ (3)å¯ä»¥æœ‰constæŒ‡é’ˆï¼Œä½†æ˜¯æ²¡æœ‰constå¼•ç”¨ï¼› (4)æŒ‡é’ˆå¯ä»¥æœ‰å¤šçº§ï¼Œä½†æ˜¯å¼•ç”¨åªèƒ½æ˜¯ä¸€çº§ï¼ˆint **pï¼›åˆæ³• è€Œ int \u0026\u0026aæ˜¯ä¸åˆæ³•çš„ï¼‰ (5)æŒ‡é’ˆçš„å€¼å¯ä»¥ä¸ºç©ºï¼Œä½†æ˜¯å¼•ç”¨çš„å€¼ä¸èƒ½ä¸ºNULLï¼Œå¹¶ä¸”å¼•ç”¨åœ¨å®šä¹‰çš„æ—¶å€™å¿…é¡»åˆå§‹åŒ–ï¼› (6)æŒ‡é’ˆçš„å€¼åœ¨åˆå§‹åŒ–åå¯ä»¥æ”¹å˜ï¼Œå³æŒ‡å‘å…¶å®ƒçš„å­˜å‚¨å•å…ƒï¼Œè€Œå¼•ç”¨åœ¨è¿›è¡Œåˆå§‹åŒ–åå°±ä¸ä¼šå†æ”¹å˜äº†ã€‚ (7)â€œsizeofå¼•ç”¨\"å¾—åˆ°çš„æ˜¯æ‰€æŒ‡å‘çš„å˜é‡(å¯¹è±¡)çš„å¤§å°ï¼Œè€Œ\"sizeofæŒ‡é’ˆ\"å¾—åˆ°çš„æ˜¯æŒ‡é’ˆæœ¬èº«çš„å¤§å°ï¼› (8)æŒ‡é’ˆå’Œå¼•ç”¨çš„è‡ªå¢(++)è¿ç®—æ„ä¹‰ä¸ä¸€æ ·ï¼› (9)å¦‚æœè¿”å›åŠ¨æ€å†…å­˜åˆ†é…çš„å¯¹è±¡æˆ–è€…å†…å­˜ï¼Œå¿…é¡»ä½¿ç”¨æŒ‡é’ˆï¼Œå¼•ç”¨å¯èƒ½å¼•èµ·å†…å­˜æ³„æ¼ï¼› ","date":"2023-07-11","objectID":"/posts/basics_two/:2:8","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"9. ç»“æ„ä½“èµ‹å€¼ (ç»“æ„ä½“èµ‹å€¼)[https://blog.csdn.net/datase/article/details/78988320] ","date":"2023-07-11","objectID":"/posts/basics_two/:2:9","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"10. Cå’ŒC++åŒºåˆ« (Cå’ŒC++åŒºåˆ«)[https://blog.csdn.net/czc1997/article/details/81254971] ","date":"2023-07-11","objectID":"/posts/basics_two/:2:10","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"11. Cå’ŒC++ä¼ å‚æ–¹å¼åŒºåˆ« Cè¯­è¨€ä¸æ”¯æŒå¼•ç”¨ä¼ å‚ï¼Œå¦‚æœæƒ³è¦æ”¹å˜ä¼ å…¥å‚æ•°çš„å€¼ï¼Œåªèƒ½ç”¨ä¼ å…¥æŒ‡é’ˆçš„æ–¹å¼ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:11","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"12. æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ« (æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«)[https://blog.csdn.net/Situo/article/details/110225143] ","date":"2023-07-11","objectID":"/posts/basics_two/:2:12","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"13. é¿å…å¤´æ–‡ä»¶é‡å¤åŒ…å«ä»¥åŠå®å®šä¹‰é‡å®šä¹‰ #ifndef LWIP_TCP_KEEPALIVE #define LWIP_TCP_KEEPALIVE #endif ","date":"2023-07-11","objectID":"/posts/basics_two/:2:13","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"14. ä½ æ€ä¹ˆç†è§£è™šæ‹Ÿç±»ï¼Ÿè™šæ‹Ÿç±»å¯ä»¥å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿå®ƒçš„ä½œç”¨å’Œå…¶ä»–ç±»çš„åŒºåˆ« ç­”æ¡ˆï¼šè™šæ‹Ÿç±»å¯ä»¥æ´¾ç”Ÿå¯¹è±¡ï¼Œçº¯è™šç±»ä¸å¯ä»¥å®ä¾‹åŒ–å¯¹è±¡ã€‚å› ä¸ºçº¯è™šç±»å­˜åœ¨æœªå®šä¹‰çš„å‡½æ•°ï¼Œåªæ˜¯ä¸ªæ¦‚å¿µï¼Œä¸å¯çœŸå®å­˜åœ¨ã€‚è™šæ‹Ÿç±»ç”¨åšå¤šæ€ï¼Œçº¯è™šç±»åšæ¥å£ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:14","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"15. å†…è”å‡½æ•°æ€ä¹ˆå®ç°çš„ï¼Œä»€ä¹ˆæ—¶æœŸå¤„ç†çš„ï¼Œä¼˜ç¼ºç‚¹ ç­”æ¡ˆï¼šåœ¨ç¨‹åºç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨å°†ç¨‹åºä¸­å‡ºç°çš„å†…è”å‡½æ•°çš„è°ƒç”¨è¡¨è¾¾å¼ç”¨å†…è”å‡½æ•°çš„å‡½æ•°ä½“æ¥è¿›è¡Œæ›¿æ¢ã€‚ ä¼˜ç‚¹ï¼šä¸ä¼šäº§ç”Ÿå‡½æ•°è°ƒç”¨çš„å¼€é”€ ç¼ºç‚¹ï¼šå¢åŠ ç›®æ ‡ç¨‹åºçš„ä»£ç é‡ï¼Œå³å¢åŠ ç©ºé—´å¼€é”€ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:15","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"16 .ä½è¿ç®—ï¼ˆæŒ‰ä½ä¸ã€æŒ‰ä½æˆ–ã€å¼‚æˆ–ï¼‰ æŒ‰ä½ä¸è¿ç®—ç¬¦ï¼ˆ\u0026ï¼‰ å‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€œä¸â€è¿ç®—ã€‚ è¿ç®—è§„åˆ™ï¼šåªæœ‰ä¸¤ä¸ªæ•°çš„äºŒè¿›åˆ¶åŒæ—¶ä¸º1ï¼Œç»“æœæ‰ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚ï¼ˆè´Ÿæ•°æŒ‰è¡¥ç å½¢å¼å‚åŠ æŒ‰ä½ä¸è¿ç®—ï¼‰ å³ 0 \u0026 0= 0 ï¼Œ0 \u0026 1= 0ï¼Œ1 \u0026 0= 0ï¼Œ 1 \u0026 1= 1ã€‚ ä¾‹ï¼š3 \u00265 å³ 00000011 \u0026 00000101 = 00000001 ï¼Œæ‰€ä»¥ 3 \u0026 5çš„å€¼ä¸º1ã€‚ æŒ‰ä½æˆ–è¿ç®—ç¬¦ï¼ˆ|ï¼‰ å‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€œæˆ–â€è¿ç®—ã€‚ è¿ç®—è§„åˆ™ï¼šå‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°åªè¦ä¸¤ä¸ªæ•°ä¸­çš„ä¸€ä¸ªä¸º1ï¼Œç»“æœå°±ä¸º1ã€‚ å³ 0 | 0= 0 , 1 | 0= 1 ï¼Œ 0 | 1= 1 , 1 | 1= 1 ã€‚ ä¾‹ï¼š2 | 4 å³ 00000010 | 00000100 = 00000110 ï¼Œæ‰€ä»¥2 | 4çš„å€¼ä¸º 6 ã€‚ å¼‚æˆ–è¿ç®—ç¬¦ï¼ˆ^ï¼‰ å‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€œå¼‚æˆ–â€è¿ç®—ã€‚ è¿ç®—è§„åˆ™ï¼šå‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°ï¼Œå¦‚æœä¸¤ä¸ªç›¸åº”ä½ä¸ºâ€œå¼‚â€ï¼ˆå€¼ä¸åŒï¼‰ï¼Œåˆ™è¯¥ä½ç»“æœä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚ å³ 0 ^ 0=0 ï¼Œ 0 ^ 1= 1 ï¼Œ 1 ^ 0= 1 ï¼Œ 1 ^ 1= 0 ã€‚ ä¾‹ï¼š 2 ^ 4 å³ 00000010 ^ 00000100 =00000110 ï¼Œæ‰€ä»¥ 2 ^ 4 çš„å€¼ä¸º6 ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:16","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"17. åŸç ã€åç ã€è¡¥ç  åŸç ï¼šæ˜¯æœ€ç®€å•çš„æœºå™¨æ•°è¡¨ç¤ºæ³•ã€‚ç”¨æœ€é«˜ä½è¡¨ç¤ºç¬¦å·ä½ï¼Œâ€˜1â€™è¡¨ç¤ºè´Ÿå·ï¼Œâ€˜0â€™è¡¨ç¤ºæ­£å·ã€‚å…¶ä»–ä½å­˜æ”¾è¯¥æ•°çš„äºŒè¿›åˆ¶çš„ç»å¯¹å€¼ã€‚ åç ï¼šæ­£æ•°çš„åç è¿˜æ˜¯ç­‰äºåŸç  è´Ÿæ•°çš„åç å°±æ˜¯ä»–çš„åŸç é™¤ç¬¦å·ä½å¤–ï¼ŒæŒ‰ä½å–åã€‚ è¡¥ç ï¼šæ­£æ•°çš„è¡¥ç ç­‰äºä»–çš„åŸç  è´Ÿæ•°çš„è¡¥ç ç­‰äºåç +1ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:17","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"18 . å †å’Œæ ˆ (å †å’Œæ ˆ)[https://blog.csdn.net/qq_45856289/article/details/106473750] ","date":"2023-07-11","objectID":"/posts/basics_two/:2:18","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"19. ç±»å’Œå¯¹è±¡ é¢å‘å¯¹è±¡(Object Oriented,OO)ã€‚ èµ·åˆï¼Œâ€œé¢å‘å¯¹è±¡â€æ˜¯æŒ‡åœ¨ç¨‹åºè®¾è®¡ä¸­é‡‡ç”¨å°è£…ã€ç»§æ‰¿ã€å¤šæ€ç­‰è®¾è®¡æ–¹æ³•ã€‚ç°åœ¨ï¼Œé¢å‘å¯¹è±¡çš„æ€æƒ³å·²ç»æ¶‰åŠåˆ°è½¯ä»¶å¼€å‘çš„å„ä¸ªæ–¹é¢ã€‚å¦‚ï¼Œé¢å‘å¯¹è±¡çš„åˆ†æï¼ˆOOAï¼ŒObjectOriented Analysisï¼‰ï¼Œé¢å‘å¯¹è±¡çš„è®¾è®¡ï¼ˆOODï¼ŒObject Oriented Designï¼‰ã€ä»¥åŠé¢å‘å¯¹è±¡çš„ç¼–ç¨‹å®ç°ï¼ˆOOPï¼ŒObject Oriented Programmingï¼‰ã€‚ å¯¹è±¡å’Œç±»è§£é‡Šï¼š 1ï¼‰å¯¹è±¡ï¼šå¯¹è±¡æ˜¯äººä»¬è¦è¿›è¡Œç ”ç©¶çš„ä»»ä½•äº‹ç‰©ï¼Œå®ƒä¸ä»…èƒ½è¡¨ç¤ºå…·ä½“çš„äº‹ç‰©ï¼Œè¿˜èƒ½è¡¨ç¤ºæŠ½è±¡çš„è§„åˆ™ã€è®¡åˆ’æˆ–äº‹ä»¶ã€‚å¯¹è±¡å…·æœ‰çŠ¶æ€ï¼Œä¸€ä¸ªå¯¹è±¡ç”¨æ•°æ®å€¼æ¥æè¿°å®ƒçš„çŠ¶æ€ã€‚å¯¹è±¡è¿˜æœ‰æ“ä½œï¼Œç”¨äºæ”¹å˜å¯¹è±¡çš„çŠ¶æ€ï¼Œå¯¹è±¡åŠå…¶æ“ä½œå°±æ˜¯å¯¹è±¡çš„è¡Œä¸ºã€‚å¯¹è±¡å®ç°äº†æ•°æ®å’Œæ“ä½œçš„ç»“åˆï¼Œä½¿æ•°æ®å’Œæ“ä½œå°è£…äºå¯¹è±¡çš„ç»Ÿä¸€ä½“ä¸­ã€‚ 2ï¼‰ç±»ï¼šå…·æœ‰ç›¸åŒç‰¹æ€§ï¼ˆæ•°æ®å…ƒç´ ï¼‰å’Œè¡Œä¸ºï¼ˆåŠŸèƒ½ï¼‰çš„å¯¹è±¡çš„æŠ½è±¡å°±æ˜¯ç±»ã€‚å› æ­¤ï¼Œå¯¹è±¡çš„æŠ½è±¡æ˜¯ç±»ï¼Œç±»çš„å…·ä½“åŒ–å°±æ˜¯å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥è¯´ç±»çš„å®ä¾‹æ˜¯å¯¹è±¡ï¼Œç±»å®é™…ä¸Šå°±æ˜¯ä¸€ç§æ•°æ®ç±»å‹ã€‚ç±»å…·æœ‰å±æ€§ï¼Œå®ƒæ˜¯å¯¹è±¡çš„çŠ¶æ€çš„æŠ½è±¡ï¼Œç”¨æ•°æ®ç»“æ„æ¥æè¿°ç±»çš„å±æ€§ã€‚ç±»å…·æœ‰æ“ä½œï¼Œå®ƒæ˜¯å¯¹è±¡çš„è¡Œä¸ºçš„æŠ½è±¡ï¼Œç”¨æ“ä½œåå’Œå®ç°è¯¥æ“ä½œçš„æ–¹æ³•æ¥æè¿°ã€‚ å¯¹è±¡å’Œç±»çš„å…³ç³»ï¼š ç±»ä¸å¯¹è±¡çš„å…³ç³»å°±å¦‚æ¨¡å…·å’Œé“¸ä»¶çš„å…³ç³»ï¼Œç±»çš„å®åŠ›åŒ–çš„ç»“æœå°±æ˜¯å¯¹è±¡ï¼Œè€Œå¯¹å¯¹è±¡çš„æŠ½è±¡å°±æ˜¯ç±»ï¼Œç±»æè¿°äº†ä¸€ç»„æœ‰ç›¸åŒç‰¹æ€§ï¼ˆå±æ€§ï¼‰å’Œç›¸åŒè¡Œä¸ºçš„å¯¹è±¡ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:19","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"20 . newå’ŒmallocåŒºåˆ« 0.å±æ€§ new/deleteæ˜¯C++å…³é”®å­—ï¼Œéœ€è¦ç¼–è¯‘å™¨æ”¯æŒã€‚malloc/freeæ˜¯åº“å‡½æ•°ï¼Œéœ€è¦å¤´æ–‡ä»¶æ”¯æŒã€‚ 1.å‚æ•° ä½¿ç”¨newæ“ä½œç¬¦ç”³è¯·å†…å­˜åˆ†é…æ—¶æ— é¡»æŒ‡å®šå†…å­˜å—çš„å¤§å°ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®ç±»å‹ä¿¡æ¯è‡ªè¡Œè®¡ç®—ã€‚è€Œmallocåˆ™éœ€è¦æ˜¾å¼åœ°æŒ‡å‡ºæ‰€éœ€å†…å­˜çš„å°ºå¯¸ã€‚ 2.è¿”å›ç±»å‹ newæ“ä½œç¬¦å†…å­˜åˆ†é…æˆåŠŸæ—¶ï¼Œè¿”å›çš„æ˜¯å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆï¼Œç±»å‹ä¸¥æ ¼ä¸å¯¹è±¡åŒ¹é…ï¼Œæ— é¡»è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ•…newæ˜¯ç¬¦åˆç±»å‹å®‰å…¨æ€§çš„æ“ä½œç¬¦ã€‚ è€Œmallocå†…å­˜åˆ†é…æˆåŠŸåˆ™æ˜¯è¿”å›void * ï¼Œéœ€è¦é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢å°†void*æŒ‡é’ˆè½¬æ¢æˆæˆ‘ä»¬éœ€è¦çš„ç±»å‹ã€‚ 3.åˆ†é…å¤±è´¥ newå†…å­˜åˆ†é…å¤±è´¥æ—¶ï¼Œä¼šæŠ›å‡ºbac_allocå¼‚å¸¸ã€‚mallocåˆ†é…å†…å­˜å¤±è´¥æ—¶è¿”å›NULLã€‚ 4.è‡ªå®šä¹‰ç±»å‹ newä¼šå…ˆè°ƒç”¨operator newå‡½æ•°ï¼Œç”³è¯·è¶³å¤Ÿçš„å†…å­˜ï¼ˆé€šå¸¸åº•å±‚ä½¿ç”¨mallocå®ç°ï¼‰ã€‚ç„¶åè°ƒç”¨ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æˆå‘˜å˜é‡ï¼Œæœ€åè¿”å›è‡ªå®šä¹‰ç±»å‹æŒ‡é’ˆã€‚deleteå…ˆè°ƒç”¨ææ„å‡½æ•°ï¼Œç„¶åè°ƒç”¨operator deleteå‡½æ•°é‡Šæ”¾å†…å­˜ï¼ˆé€šå¸¸åº•å±‚ä½¿ç”¨freeå®ç°ï¼‰ã€‚ malloc/freeæ˜¯åº“å‡½æ•°ï¼Œåªèƒ½åŠ¨æ€çš„ç”³è¯·å’Œé‡Šæ”¾å†…å­˜ï¼Œæ— æ³•å¼ºåˆ¶è¦æ±‚å…¶åšè‡ªå®šä¹‰ç±»å‹å¯¹è±¡æ„é€ å’Œææ„å·¥ä½œã€‚ 5.é‡è½½ C++å…è®¸é‡è½½new/deleteæ“ä½œç¬¦ï¼Œç‰¹åˆ«çš„ï¼Œå¸ƒå±€newçš„å°±ä¸éœ€è¦ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ï¼Œè€Œæ˜¯æŒ‡å®šäº†ä¸€ä¸ªåœ°å€ä½œä¸ºå†…å­˜èµ·å§‹åŒºåŸŸï¼Œnewåœ¨è¿™æ®µå†…å­˜ä¸Šä¸ºå¯¹è±¡è°ƒç”¨æ„é€ å‡½æ•°å®Œæˆåˆå§‹åŒ–å·¥ä½œï¼Œå¹¶è¿”å›æ­¤åœ°å€ã€‚è€Œmallocä¸å…è®¸é‡è½½ã€‚ 6.å†…å­˜åŒºåŸŸ newæ“ä½œç¬¦ä»è‡ªç”±å­˜å‚¨åŒºï¼ˆfree storeï¼‰ä¸Šä¸ºå¯¹è±¡åŠ¨æ€åˆ†é…å†…å­˜ç©ºé—´ï¼Œè€Œmallocå‡½æ•°ä»å †ä¸ŠåŠ¨æ€åˆ†é…å†…å­˜ã€‚è‡ªç”±å­˜å‚¨åŒºæ˜¯C++åŸºäºnewæ“ä½œç¬¦çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå‡¡æ˜¯é€šè¿‡newæ“ä½œç¬¦è¿›è¡Œå†…å­˜ç”³è¯·ï¼Œè¯¥å†…å­˜å³ä¸ºè‡ªç”±å­˜å‚¨åŒºã€‚è€Œå †æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„æœ¯è¯­ï¼Œæ˜¯æ“ä½œç³»ç»Ÿæ‰€ç»´æŠ¤çš„ä¸€å—ç‰¹æ®Šå†…å­˜ï¼Œç”¨äºç¨‹åºçš„å†…å­˜åŠ¨æ€åˆ†é…ï¼ŒCè¯­è¨€ä½¿ç”¨mallocä»å †ä¸Šåˆ†é…å†…å­˜ï¼Œä½¿ç”¨freeé‡Šæ”¾å·²åˆ†é…çš„å¯¹åº”å†…å­˜ã€‚è‡ªç”±å­˜å‚¨åŒºä¸ç­‰äºå †ï¼Œå¦‚ä¸Šæ‰€è¿°ï¼Œå¸ƒå±€newå°±å¯ä»¥ä¸ä½äºå †ä¸­ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:20","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"21. å†…æ ¸é“¾è¡¨ä¸åŒå‘å¾ªç¯é“¾è¡¨ (å†…æ ¸é“¾è¡¨ä¸åŒå‘å¾ªç¯é“¾è¡¨)[https://blog.csdn.net/liebao_han/article/details/53956609] ","date":"2023-07-11","objectID":"/posts/basics_two/:2:21","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"22. ç»“æ„ä½“å’Œç±»çš„åŒºåˆ« 1.ç»“æ„ä½“æ˜¯ä¸€ç§å€¼ç±»å‹ï¼Œè€Œç±»æ˜¯å¼•ç”¨ç±»å‹ã€‚å€¼ç±»å‹ç”¨äºå­˜å‚¨æ•°æ®çš„å€¼ï¼Œå¼•ç”¨ç±»å‹ç”¨äºå­˜å‚¨å¯¹å®é™…æ•°æ®çš„å¼•ç”¨ã€‚ é‚£ä¹ˆç»“æ„ä½“å°±æ˜¯å½“æˆå€¼æ¥ä½¿ç”¨çš„ï¼Œç±»åˆ™é€šè¿‡å¼•ç”¨æ¥å¯¹å®é™…æ•°æ®æ“ä½œã€‚ ç»“æ„ä½“ä½¿ç”¨æ ˆå­˜å‚¨ï¼ˆStack Allocationï¼‰ï¼Œè€Œç±»ä½¿ç”¨å †å­˜å‚¨ï¼ˆHeap Allocation) æ ˆçš„ç©ºé—´ç›¸å¯¹è¾ƒå°.ä½†æ˜¯å­˜å‚¨åœ¨æ ˆä¸­çš„æ•°æ®è®¿é—®æ•ˆç‡ç›¸å¯¹è¾ƒé«˜. å †çš„ç©ºé—´ç›¸å¯¹è¾ƒå¤§.ä½†æ˜¯å­˜å‚¨åœ¨å †ä¸­çš„æ•°æ®çš„è®¿é—®æ•ˆç‡ç›¸å¯¹è¾ƒä½. 3.ç±»æ˜¯åæ˜ ç°å®äº‹ç‰©çš„ä¸€ç§æŠ½è±¡ï¼Œè€Œç»“æ„ä½“çš„ä½œç”¨åªæ˜¯ä¸€ç§åŒ…å«äº†å…·ä½“ä¸åŒç±»åˆ«æ•°æ®çš„ä¸€ç§åŒ…è£…ï¼Œç»“æ„ä½“ä¸å…·å¤‡ç±»çš„ç»§æ‰¿å¤šæ€ç‰¹æ€§ 4.ç»“æ„ä½“èµ‹å€¼æ˜¯ ç›´æ¥èµ‹å€¼çš„å€¼. è€Œå¯¹è±¡çš„æŒ‡é’ˆ èµ‹å€¼çš„æ˜¯å¯¹è±¡çš„åœ°å€ 5.Structå˜é‡ä½¿ç”¨å®Œä¹‹åå°±è‡ªåŠ¨è§£é™¤å†…å­˜åˆ†é…ï¼ŒClasså®ä¾‹æœ‰åƒåœ¾å›æ”¶æœºåˆ¶æ¥ä¿è¯å†…å­˜çš„å›æ”¶å¤„ç†ã€‚ 6.ç»“æ„ä½“çš„æ„é€ å‡½æ•°ä¸­ï¼Œå¿…é¡»ä¸ºç»“æ„ä½“æ‰€æœ‰å­—æ®µèµ‹å€¼ï¼Œç±»çš„æ„é€ å‡½æ•°æ— æ­¤é™åˆ¶ é¦–å…ˆ,å…³äºéšå¼æ„é€ å‡½æ•°.æˆ‘ä»¬çŸ¥é“,åœ¨1ä¸ªç±»ä¸­å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¸ºç±»å†™ä»»æ„çš„æ„é€ å‡½æ•°,é‚£ä¹ˆC++ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šè‡ªåŠ¨çš„ä¸ºè¿™ä¸ªç±»ç”Ÿæˆ1ä¸ªæ— å‚æ•°çš„æ„é€ å‡½æ•°.æˆ‘ä»¬å°†è¿™ä¸ªæ„é€ å‡½æ•°ç§°ä¹‹ä¸ºéšå¼æ„é€ å‡½æ•° ä½†æ˜¯ä¸€æ—¦æˆ‘ä»¬ä¸ºè¿™ä¸ªç±»å†™äº†ä»»æ„çš„1ä¸ªæ„é€ å‡½æ•°çš„æ—¶å€™,è¿™ä¸ªéšå¼çš„æ„é€ å‡½æ•°å°±ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆäº†.åœ¨ç»“æ„ä½“ä¸­,å°±ä¸æ˜¯è¿™æ ·äº†,åœ¨ç»“æ„ä½“ä¸­éšå¼çš„æ„é€ å‡½æ•°æ— è®ºå¦‚ä½•éƒ½å­˜åœ¨ã€‚æ‰€ä»¥ç¨‹åºå‘˜ä¸èƒ½æ‰‹åŠ¨çš„ä¸ºç»“æ„æ·»åŠ 1ä¸ªæ— å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ 7.ç»“æ„ä½“ä¸­å£°æ˜çš„å­—æ®µæ— æ³•èµ‹äºˆåˆå€¼ï¼Œç±»å¯ä»¥: å¦‚ä½•é€‰æ‹©ç»“æ„ä½“è¿˜æ˜¯ç±» 1ï¼ å †æ ˆçš„ç©ºé—´æœ‰é™ï¼Œå¯¹äºå¤§é‡çš„é€»è¾‘çš„å¯¹è±¡ï¼Œåˆ›å»ºç±»è¦æ¯”åˆ›å»ºç»“æ„å¥½ä¸€äº› 2ï¼ ç»“æ„è¡¨ç¤ºå¦‚ç‚¹ã€çŸ©å½¢å’Œé¢œè‰²è¿™æ ·çš„è½»é‡å¯¹è±¡ï¼Œä¾‹å¦‚ï¼Œå¦‚æœå£°æ˜ä¸€ä¸ªå«æœ‰ 1000 ä¸ªç‚¹å¯¹è±¡çš„æ•°ç»„ï¼Œåˆ™å°†ä¸ºå¼•ç”¨æ¯ä¸ªå¯¹è±¡åˆ†é…é™„åŠ çš„å†…å­˜ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œç»“æ„çš„æˆæœ¬è¾ƒä½ã€‚ 3ï¼ åœ¨è¡¨ç°æŠ½è±¡å’Œå¤šçº§åˆ«çš„å¯¹è±¡å±‚æ¬¡æ—¶ï¼Œç±»æ˜¯æœ€å¥½çš„é€‰æ‹© 4ï¼ å¤§å¤šæ•°æƒ…å†µä¸‹è¯¥ç±»å‹åªæ˜¯ä¸€äº›æ•°æ®æ—¶ï¼Œç»“æ„æ—¶æœ€ä½³çš„é€‰æ‹© ","date":"2023-07-11","objectID":"/posts/basics_two/:2:22","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"23. ç»“æ„ä½“å’Œè”åˆä½“åŒºåˆ« ä¸¤è€…æœ€å¤§çš„åŒºåˆ«åœ¨äºå†…å­˜åˆ©ç”¨ ä¸€ã€ç»“æ„ä½“struct å„æˆå‘˜å„è‡ªæ‹¥æœ‰è‡ªå·±çš„å†…å­˜ï¼Œå„è‡ªä½¿ç”¨äº’ä¸å¹²æ¶‰ï¼ŒåŒæ—¶å­˜åœ¨çš„ï¼Œéµå¾ªå†…å­˜å¯¹é½åŸåˆ™ã€‚ä¸€ä¸ªstructå˜é‡çš„æ€»é•¿åº¦ç­‰äºæ‰€æœ‰æˆå‘˜çš„é•¿åº¦ä¹‹å’Œã€‚ äºŒã€è”åˆä½“union å„æˆå‘˜å…±ç”¨ä¸€å—å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”åŒæ—¶åªæœ‰ä¸€ä¸ªæˆå‘˜å¯ä»¥å¾—åˆ°è¿™å—å†…å­˜çš„ä½¿ç”¨æƒ(å¯¹è¯¥å†…å­˜çš„è¯»å†™)ï¼Œå„å˜é‡å…±ç”¨ä¸€ä¸ªå†…å­˜é¦–åœ°å€ã€‚å› è€Œï¼Œè”åˆä½“æ¯”ç»“æ„ä½“æ›´èŠ‚çº¦å†…å­˜ã€‚ä¸€ä¸ªunionå˜é‡çš„æ€»é•¿åº¦è‡³å°‘èƒ½å®¹çº³æœ€å¤§çš„æˆå‘˜å˜é‡ï¼Œè€Œä¸”è¦æ»¡è¶³æ˜¯æ‰€æœ‰æˆå‘˜å˜é‡ç±»å‹å¤§å°çš„æ•´æ•°å€ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:23","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"24. ç»“æ„ä½“å’Œæšä¸¾ ä¸€ã€ç»“æ„ä½“ ç»“æ„ä½“:å¾ˆåƒé¢å‘å¯¹è±¡ä¸­çš„å¯¹è±¡ï¼Œä½†æ˜¯ç»“æ„ä½“æ²¡æœ‰æ–¹æ³•åªæœ‰å±æ€§ï¼Œä¸€ä¸ªç»“æ„ä½“ç”±ä¸åŒç±»å‹çš„å…ƒç´ ç»„æˆï¼Œè€Œç›¸è¾ƒäºæ•°ç»„æ¥è¯´ï¼Œæ•°ç»„åªèƒ½å­˜å‚¨ç›¸åŒç±»å‹çš„å…ƒç´ ã€‚ç»“æ„ä½“å ç”¨çš„ç©ºé—´ç­‰äºå†…éƒ¨å„å…ƒç´ å ç”¨ç©ºé—´çš„å’Œï¼Œå¹¶ä¸”å…ƒç´ åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼ˆæŒ‰ç…§å…ƒç´ å®šä¹‰çš„é¡ºåºï¼‰æ˜¯è¿ç»­çš„ã€‚ æ³¨æ„ï¼šç»“æ„ä½“ä¸èƒ½åƒé¢å‘å¯¹è±¡ä¸­é‚£æ ·é€’å½’è°ƒç”¨ï¼Œè‡ªå·±åŒ…å«è‡ªå·±ï¼Œä½†æ˜¯å¯ä»¥åŒ…å«å…¶ä»–ç±»å‹çš„ç»“æ„ä½“ã€‚ äºŒã€æšä¸¾ æšä¸¾:å’Œé¢å‘å¯¹è±¡ä¸­ä¸€æ ·ï¼Œæšä¸¾éƒ½æ˜¯ç”¨æ¥å®šä¹‰ä¸€äº›å›ºå®šå–å€¼çš„å¸¸é‡,ä½†æ˜¯Cä¸­çš„æšä¸¾ä¸­çš„å€¼æ˜¯æ•´æ•°ï¼Œé»˜è®¤æŒ‰ç…§0é€’å¢,ä¹Ÿå¯ä»¥åœ¨å®šä¹‰æšä¸¾çš„æ—¶å€™èµ‹å€¼ï¼Œé‚£ä¹ˆåé¢çš„å…ƒç´ çš„å€¼å°±ä¼šä»¥è¿™ä¸ªå…ƒç´ ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ é€’å¢ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:24","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"25 . æ•°ç»„å’ŒæŒ‡é’ˆçš„åŒºåˆ«ä¸è”ç³» (æ•°ç»„å’ŒæŒ‡é’ˆçš„åŒºåˆ«ä¸è”ç³»)[https://blog.csdn.net/cherrydreamsover/article/details/81741459] ","date":"2023-07-11","objectID":"/posts/basics_two/:2:25","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"26 . å‡½æ•°æŒ‡é’ˆ\u0026æŒ‡é’ˆå‡½æ•° https://blog.csdn.net/baidu_37973494/article/details/83150266 ","date":"2023-07-11","objectID":"/posts/basics_two/:2:26","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"27 . constæ”¾åœ¨å‡½æ•°å‰åçš„åŒºåˆ« 1ã€int GetY() const; 2ã€const int * GetPosition(); å¯¹äº1 è¯¥å‡½æ•°ä¸ºåªè¯»å‡½æ•°ï¼Œä¸å…è®¸ä¿®æ”¹å…¶ä¸­çš„æ•°æ®æˆå‘˜çš„å€¼ã€‚ å¯¹äº2 ä¿®é¥°çš„æ˜¯è¿”å›å€¼ï¼Œè¡¨ç¤ºè¿”å›çš„æ˜¯æŒ‡é’ˆæ‰€æŒ‡å‘å€¼æ˜¯å¸¸é‡ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:27","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"28 . gotoè¯­å¥ gotoè¯­å¥ä¹Ÿç§°ä¸ºæ— æ¡ä»¶è½¬ç§»è¯­å¥ï¼Œå…¶ä¸€èˆ¬æ ¼å¼å¦‚ä¸‹ï¼š goto è¯­å¥æ ‡å·ï¼› å…¶ä¸­è¯­å¥æ ‡å·æ˜¯æŒ‰æ ‡è¯†ç¬¦è§„å®šä¹¦å†™çš„ç¬¦å·ï¼Œ æ”¾åœ¨æŸä¸€è¯­å¥è¡Œçš„å‰é¢ï¼Œæ ‡å·ååŠ å†’å·(ï¼š)ã€‚è¯­å¥æ ‡å·èµ·æ ‡è¯†è¯­å¥çš„ä½œç”¨ï¼Œä¸goto è¯­å¥é…åˆä½¿ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼š goto label; cout \u003c\u003c \"This is the\" ","date":"2023-07-11","objectID":"/posts/basics_two/:2:28","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"29 . externå…³é”®å­— 1ã€externç”¨åœ¨å˜é‡æˆ–è€…å‡½æ•°çš„å£°æ˜å‰ï¼Œç”¨æ¥è¯´æ˜â€œæ­¤å˜é‡/å‡½æ•°æ˜¯åœ¨åˆ«å¤„å®šä¹‰çš„ï¼Œè¦åœ¨æ­¤å¤„å¼•ç”¨â€ã€‚externå£°æ˜ä¸æ˜¯å®šä¹‰ï¼Œå³ä¸åˆ†é…å­˜å‚¨ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å®šä¹‰äº†å˜é‡å’Œå‡½æ•°ï¼Œ åœ¨å…¶ä»–æ–‡ä»¶ä¸­è¦ä½¿ç”¨å®ƒä»¬ï¼Œ å¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼šä½¿ç”¨å¤´æ–‡ä»¶ï¼Œç„¶åå£°æ˜å®ƒä»¬ï¼Œç„¶åå…¶ä»–æ–‡ä»¶å»åŒ…å«å¤´æ–‡ä»¶ï¼›åœ¨å…¶ä»–æ–‡ä»¶ä¸­ç›´æ¥externã€‚ 2ã€extern Cä½œç”¨ é“¾æ¥æŒ‡ç¤ºç¬¦extern C å¦‚æœç¨‹åºå‘˜å¸Œæœ›è°ƒç”¨å…¶ä»–ç¨‹åºè®¾è®¡è¯­è¨€å°¤å…¶æ˜¯C å†™çš„å‡½æ•°ï¼Œé‚£ä¹ˆè°ƒç”¨å‡½æ•°æ—¶å¿…é¡»å‘Šè¯‰ç¼–è¯‘å™¨ä½¿ç”¨ä¸åŒçš„è¦æ±‚ï¼Œä¾‹å¦‚å½“è¿™æ ·çš„å‡½æ•°è¢«è°ƒç”¨æ—¶å‡½æ•°åæˆ–å‚æ•°æ’åˆ—çš„é¡ºåºå¯èƒ½ä¸åŒï¼Œæ— è®ºæ˜¯C++å‡½æ•°è°ƒç”¨å®ƒè¿˜æ˜¯ç”¨å…¶ä»–è¯­è¨€å†™çš„å‡½æ•°è°ƒç”¨å®ƒï¼Œç¨‹åºå‘˜ç”¨é“¾æ¥æŒ‡ç¤ºç¬¦å‘Šè¯‰ç¼–è¯‘å™¨è¯¥å‡½æ•°æ˜¯ç”¨å…¶ä»–çš„ç¨‹åºè®¾è®¡è¯­è¨€ç¼–å†™çš„ï¼Œé“¾æ¥æŒ‡ç¤ºç¬¦æœ‰ä¸¤ç§å½¢å¼æ—¢å¯ä»¥æ˜¯å•ä¸€è¯­å¥å½¢å¼ä¹Ÿå¯ä»¥æ˜¯å¤åˆè¯­å¥å½¢å¼ã€‚ // å•ä¸€è¯­å¥å½¢å¼çš„é“¾æ¥æŒ‡ç¤ºç¬¦ extern â€œCâ€ void exit(int); // å¤åˆè¯­å¥å½¢å¼çš„é“¾æ¥æŒ‡ç¤ºç¬¦ extern â€œCâ€ { int printf( const char* â€¦ ); int scanf( const char* â€¦ ); } // å¤åˆè¯­å¥å½¢å¼çš„é“¾æ¥æŒ‡ç¤ºç¬¦ extern â€œCâ€ { #include } é“¾æ¥æŒ‡ç¤ºç¬¦çš„ç¬¬ä¸€ç§å½¢å¼ç”±å…³é”®å­—extern åè·Ÿä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ä»¥åŠä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œå£°æ˜æ„æˆè™½ç„¶å‡½æ•°æ˜¯ç”¨å¦å¤–ä¸€ç§è¯­è¨€ç¼–å†™çš„ä½†è°ƒç”¨å®ƒä»ç„¶éœ€è¦ç±»å‹æ£€æŸ¥ä¾‹å¦‚ç¼–è¯‘å™¨ä¼šæ£€æŸ¥ä¼ é€’ç»™å‡½æ•°exit()çš„å®å‚çš„ç±»å‹æ˜¯å¦æ˜¯int æˆ–è€…èƒ½å¤Ÿéšå¼åœ°è½¬æ¢æˆint å‹ï¼Œå¤šä¸ªå‡½æ•°å£°æ˜å¯ä»¥ç”¨èŠ±æ‹¬å·åŒ…å«åœ¨é“¾æ¥æŒ‡ç¤ºç¬¦å¤åˆè¯­å¥ä¸­ï¼Œè¿™æ˜¯é“¾æ¥æŒ‡ç¤ºç¬¦çš„ç¬¬äºŒç§å½¢å¼èŠ±æ‰©å·è¢«ç”¨ä½œåˆ†å‰²ç¬¦è¡¨ç¤ºé“¾æ¥æŒ‡ç¤ºç¬¦åº”ç”¨åœ¨å“ªäº›å£°æ˜ä¸Šåœ¨å…¶ä»–æ„ä¹‰ä¸Šè¯¥èŠ±æ‹¬å·è¢«å¿½ç•¥ï¼Œæ‰€ä»¥åœ¨èŠ±æ‹¬å·ä¸­å£°æ˜çš„å‡½æ•°åå¯¹å¤–æ˜¯å¯è§çš„å°±å¥½åƒå‡½æ•°æ˜¯åœ¨å¤åˆè¯­å¥å¤–å£°æ˜çš„ä¸€æ ·ï¼Œä¾‹å¦‚åœ¨å‰é¢çš„ä¾‹å­ä¸­å¤åˆè¯­å¥extern â€œC\"è¡¨ç¤ºå‡½æ•°printf()å’Œscanf()æ˜¯åœ¨C è¯­è¨€ä¸­å†™çš„ï¼Œå‡½æ•°å› æ­¤è¿™ä¸ªå£°æ˜çš„æ„ä¹‰å°±å¦‚åŒprintf()å’Œscanf()æ˜¯åœ¨extern â€œC\"å¤åˆè¯­å¥å¤–é¢å£°æ˜çš„ä¸€æ ·ï¼Œå½“å¤åˆè¯­å¥é“¾æ¥æŒ‡ç¤ºç¬¦çš„æ‹¬å·ä¸­å«æœ‰#include æ—¶ï¼Œåœ¨å¤´æ–‡ä»¶ä¸­çš„å‡½æ•°å£°æ˜éƒ½è¢«å‡å®šæ˜¯ç”¨é“¾æ¥æŒ‡ç¤ºç¬¦çš„ç¨‹åºè®¾è®¡è¯­è¨€æ‰€å†™çš„ï¼Œåœ¨å‰é¢çš„ä¾‹å­ä¸­åœ¨å¤´æ–‡ä»¶ä¸­å£°æ˜çš„å‡½æ•°éƒ½æ˜¯Cå‡½æ•°é“¾æ¥æŒ‡ç¤ºç¬¦ä¸èƒ½å‡ºç°åœ¨å‡½æ•°ä½“ä¸­ä¸‹åˆ—ä»£ç æ®µå°†ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ int main() { // é”™è¯¯: é“¾æ¥æŒ‡ç¤ºç¬¦ä¸èƒ½å‡ºç°åœ¨å‡½æ•°å†… extern \"C\" double sqrt( double ); 305 ç¬¬ä¸ƒç« å‡½æ•° double getValue(); //ok double result = sqrt ( getValue() ); //... return 0; } å¦‚æœæŠŠé“¾æ¥æŒ‡ç¤ºç¬¦ç§»åˆ°å‡½æ•°ä½“å¤–ç¨‹åºç¼–è¯‘å°†æ— é”™è¯¯ extern \"C\" double sqrt( double ); int main() { double getValue(); //ok double result = sqrt ( getValue() ); //... return 0; } ä½†æ˜¯æŠŠé“¾æ¥æŒ‡ç¤ºç¬¦æ”¾åœ¨å¤´æ–‡ä»¶ä¸­æ›´åˆé€‚ï¼Œåœ¨é‚£é‡Œå‡½æ•°å£°æ˜æè¿°äº†å‡½æ•°çš„æ¥å£æ‰€å±ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›C++å‡½æ•°èƒ½å¤Ÿä¸ºC ç¨‹åºæ‰€ç”¨åˆè¯¥æ€ä¹ˆåŠå‘¢æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨extern \"C\"é“¾æ¥æŒ‡ç¤ºç¬¦æ¥ä½¿C++å‡½æ•°ä¸ºC ç¨‹åºå¯ç”¨ä¾‹å¦‚ã€‚ // å‡½æ•°calc() å¯ä»¥è¢«C ç¨‹åºè°ƒç”¨ extern \"C\" double calc( double dparm ) { /* ... */ } å¦‚æœä¸€ä¸ªå‡½æ•°åœ¨åŒä¸€æ–‡ä»¶ä¸­ä¸åªè¢«å£°æ˜ä¸€æ¬¡åˆ™é“¾æ¥æŒ‡ç¤ºç¬¦å¯ä»¥å‡ºç°åœ¨æ¯ä¸ªå£°æ˜ä¸­å®ƒï¼Œä¹Ÿå¯ä»¥åªå‡ºç°åœ¨å‡½æ•°çš„ç¬¬ä¸€æ¬¡å£°æ˜ä¸­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ç¬¬äºŒä¸ªåŠä»¥åçš„å£°æ˜éƒ½æ¥å—ç¬¬ä¸€ä¸ªå£°æ˜ä¸­é“¾æ¥æŒ‡ç¤ºç¬¦æŒ‡å®šçš„é“¾æ¥è§„åˆ™ä¾‹å¦‚ // ---- myMath.h ---- extern \"C\" double calc( double ); // ---- myMath.C ---- // åœ¨Math.h ä¸­çš„calc() çš„å£°æ˜ #include \"myMath.h\" // å®šä¹‰äº†extern \"C\" calc() å‡½æ•° // calc() å¯ä»¥ä»C ç¨‹åºä¸­è¢«è°ƒç”¨ double calc( double dparm ) { // ... åœ¨æœ¬èŠ‚ä¸­æˆ‘ä»¬åªçœ‹åˆ°ä¸ºC è¯­è¨€æä¾›çš„é“¾æ¥æŒ‡ç¤ºextern \"C\"ï¼Œextern \"C\"æ˜¯æƒŸä¸€è¢«ä¿è¯ç”±æ‰€æœ‰C++å®ç°éƒ½æ”¯æŒçš„ï¼Œæ¯ä¸ªç¼–è¯‘å™¨å®ç°éƒ½å¯ä»¥ä¸ºå…¶ç¯å¢ƒä¸‹å¸¸ç”¨çš„è¯­è¨€æä¾›å…¶ä»–é“¾æ¥æŒ‡ç¤ºä¾‹å¦‚extern \"Ada\"å¯ä»¥ç”¨æ¥å£°æ˜æ˜¯ç”¨Ada è¯­è¨€å†™çš„å‡½æ•°ï¼Œextern \"FORTRAN\"ç”¨æ¥å£°æ˜æ˜¯ç”¨FORTRAN è¯­è¨€å†™çš„å‡½æ•°ï¼Œç­‰ç­‰å› ä¸ºå…¶ä»–çš„é“¾æ¥æŒ‡ç¤ºéšç€å…·ä½“å®ç°çš„ä¸åŒè€Œä¸åŒæ‰€ä»¥å»ºè®®è¯»è€…æŸ¥çœ‹ç¼–è¯‘å™¨çš„ç”¨æˆ·æŒ‡å—ä»¥è·å¾—å…¶ä»–é“¾æ¥æŒ‡ç¤ºç¬¦çš„è¿›ä¸€æ­¥ä¿¡æ¯ã€‚ æ€»ç»“ extern â€œCâ€ extern â€œCâ€ ä¸ä½†å…·æœ‰ä¼ ç»Ÿçš„å£°æ˜å¤–éƒ¨å˜é‡çš„åŠŸèƒ½ï¼Œè¿˜å…·æœ‰å‘ŠçŸ¥C++é“¾æ¥å™¨ä½¿ç”¨Cå‡½æ•°è§„èŒƒæ¥é“¾æ¥çš„åŠŸèƒ½ã€‚ è¿˜å…·æœ‰å‘ŠçŸ¥C++ç¼–è¯‘å™¨ä½¿ç”¨Cè§„èŒƒæ¥å‘½åçš„åŠŸèƒ½ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:29","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"30 . åŠ¨æ€å†…å­˜ç®¡ç† (åŠ¨æ€å†…å­˜ç®¡ç†)[https://blog.csdn.net/zgege/article/details/82054076] ","date":"2023-07-11","objectID":"/posts/basics_two/:2:30","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"31 .æ•°ç»„ã€é“¾è¡¨ã€å“ˆå¸Œã€é˜Ÿåˆ—ã€æ ˆæ•°æ®ç»“æ„ç‰¹ç‚¹ï¼Œå„è‡ªä¼˜ç‚¹å’Œç¼ºç‚¹ æ•°ç»„(Array)ï¼š ä¼˜ç‚¹ï¼šæŸ¥è¯¢å¿«ï¼Œé€šè¿‡ç´¢å¼•ç›´æ¥æŸ¥æ‰¾ï¼›æœ‰åºæ·»åŠ ï¼Œæ·»åŠ é€Ÿåº¦å¿«ï¼Œå…è®¸é‡å¤ï¼› ç¼ºç‚¹ï¼šåœ¨ä¸­é—´éƒ¨ä½æ·»åŠ ã€åˆ é™¤æ¯”è¾ƒå¤æ‚ï¼Œå¤§å°å›ºå®šï¼Œåªèƒ½å­˜å‚¨ä¸€ç§ç±»å‹çš„æ•°æ®ï¼› å¦‚æœåº”ç”¨éœ€è¦å¿«é€Ÿè®¿é—®æ•°æ®ï¼Œå¾ˆå°‘æ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œå°±åº”è¯¥ç”¨æ•°ç»„ã€‚ é“¾è¡¨(LinkedList)ï¼š ä¼˜ç‚¹ï¼šæœ‰åºæ·»åŠ ã€å¢åˆ æ”¹é€Ÿåº¦å¿«ï¼Œå¯¹äºé“¾è¡¨æ•°æ®ç»“æ„ï¼Œå¢åŠ å’Œåˆ é™¤åªè¦ä¿®æ”¹å…ƒç´ ä¸­çš„æŒ‡é’ˆå°±å¯ä»¥äº†ï¼› ç¼ºç‚¹ï¼šæŸ¥è¯¢æ…¢ï¼Œå¦‚æœè¦è®¿é—®é“¾è¡¨ä¸­ä¸€ä¸ªå…ƒç´ ï¼Œå°±éœ€è¦ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹æŸ¥æ‰¾ï¼› å¦‚æœåº”ç”¨éœ€è¦ç»å¸¸æ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œå°±åº”è¯¥ç”¨é“¾è¡¨ã€‚ æ ˆ(Stack)ï¼š ä¼˜ç‚¹ï¼šæä¾›åè¿›å…ˆå‡ºçš„å­˜å‚¨æ–¹å¼ï¼Œæ·»åŠ é€Ÿåº¦å¿«ï¼Œå…è®¸é‡å¤ï¼› ç¼ºç‚¹ï¼šåªèƒ½åœ¨ä¸€å¤´æ“ä½œæ•°æ®ï¼Œå­˜å–å…¶ä»–é¡¹å¾ˆæ…¢ï¼› é˜Ÿåˆ—(Queue)ï¼š ä¼˜ç‚¹ï¼šæä¾›å…ˆè¿›å…ˆå‡ºçš„å­˜å‚¨æ–¹å¼ï¼Œæ·»åŠ é€Ÿåº¦å¿«ï¼Œå…è®¸é‡å¤ï¼› ç¼ºç‚¹ï¼šåªèƒ½åœ¨ä¸€å¤´æ·»åŠ ï¼Œå¦ä¸€å¤´è·å–ï¼Œå­˜å–å…¶ä»–é¡¹å¾ˆæ…¢ï¼› å“ˆå¸Œ(Hash)ï¼š ç‰¹ç‚¹ï¼šæ•£åˆ—è¡¨ï¼Œä¸å…è®¸é‡å¤ï¼› ä¼˜ç‚¹ï¼šå¦‚æœå…³é”®å­—å·²çŸ¥åˆ™å­˜å–é€Ÿåº¦æå¿«ï¼› ç¼ºç‚¹ï¼šå¦‚æœä¸çŸ¥é“å…³é”®å­—åˆ™å­˜å–å¾ˆæ…¢ï¼Œå¯¹å­˜å‚¨ç©ºé—´ä½¿ç”¨ä¸å……åˆ†ï¼› ","date":"2023-07-11","objectID":"/posts/basics_two/:2:31","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"32. å‹å…ƒå‡½æ•° å¼•å…¥å‹å…ƒå‡½æ•°çš„åŸå›  ç±»å…·æœ‰å°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€ä¿¡æ¯éšè—çš„ç‰¹æ€§ï¼Œåªæœ‰ç±»çš„æˆå‘˜å‡½æ•°æ‰å¯ä»¥è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜ï¼Œéæˆå‘˜å‡½æ•°åªèƒ½è®¿é—®ç±»çš„å…¬æœ‰æˆå‘˜ã€‚ä¸ºäº†ä½¿ç±»çš„éæˆå‘˜å‡½æ•°è®¿é—®ç±»çš„æˆå‘˜ï¼Œå”¯ä¸€çš„åšæ³•å°±æ˜¯å°†æˆå‘˜å®šä¹‰ä¸ºpublicï¼Œä½†è¿™æ ·åšä¼šç ´åä¿¡æ¯éšè—çš„ç‰¹æ€§ã€‚åŸºäºä»¥ä¸ŠåŸå› ï¼Œå¼•å…¥å‹å…ƒå‡½æ•°è§£å†³ã€‚ (å‹å…ƒå‡½æ•°)[https://blog.csdn.net/qq_26337701/article/details/53996104] ","date":"2023-07-11","objectID":"/posts/basics_two/:2:32","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"33. è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€å‘å¸ƒè®¢é˜…æ¨¡å¼ä»¥åŠè§‚å¯Ÿè€…æ¨¡å¼ (è®¾è®¡æ¨¡å¼)[https://blog.csdn.net/m0_37322399/article/details/108515158] ","date":"2023-07-11","objectID":"/posts/basics_two/:2:33","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"34. æ„é€ å‡½æ•°ï¼š ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ é€šä¿—çš„è®²ï¼Œåœ¨ç±»ä¸­ï¼Œå‡½æ•°åå’Œç±»åç›¸åŒçš„å‡½æ•°ç§°ä¸ºæ„é€ å‡½æ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯åœ¨å»ºç«‹ä¸€ä¸ªå¯¹è±¡æ—¶ï¼ŒåšæŸäº›åˆå§‹åŒ–çš„å·¥ä½œï¼ˆä¾‹å¦‚å¯¹æ•°æ®èµ‹äºˆåˆå€¼ï¼‰ã€‚C++å…è®¸åŒåå‡½æ•°ï¼Œä¹Ÿå°±å…è®¸åœ¨ä¸€ä¸ªç±»ä¸­æœ‰å¤šä¸ªæ„é€ å‡½æ•°ã€‚å¦‚æœä¸€ä¸ªéƒ½æ²¡æœ‰ï¼Œç¼–è¯‘å™¨å°†ä¸ºè¯¥ç±»äº§ç”Ÿä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°ã€‚ æ„é€ å‡½æ•°ä¸ŠæƒŸä¸€çš„è¯­æ³•é™åˆ¶æ˜¯å®ƒä¸èƒ½æŒ‡å®šè¿”å›ç±»å‹ï¼Œç”šè‡³void ä¹Ÿä¸è¡Œã€‚ ä¸å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼šä¸€èˆ¬å½¢å¼ä¸º ç±»å å¯¹è±¡å(){å‡½æ•°ä½“} å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼šä¸å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œåªèƒ½ä»¥å›ºå®šä¸å˜çš„å€¼åˆå§‹åŒ–å¯¹è±¡ã€‚å¸¦å‚æ•°æ„é€ å‡½æ•°çš„åˆå§‹åŒ–è¦çµæ´»çš„å¤šï¼Œé€šè¿‡ä¼ é€’ç»™æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œå¯ä»¥èµ‹äºˆå¯¹è±¡ä¸åŒçš„åˆå§‹å€¼ã€‚ä¸€èˆ¬å½¢å¼ä¸ºï¼šæ„é€ å‡½æ•°åï¼ˆå½¢å‚è¡¨ï¼‰ï¼› åˆ›å»ºå¯¹è±¡ä½¿ç”¨æ—¶ï¼šç±»å å¯¹è±¡åï¼ˆå®å‚è¡¨ï¼‰ï¼› æ„é€ å‡½æ•°å‚æ•°çš„åˆå§‹å€¼ï¼šæ„é€ å‡½æ•°çš„å‚æ•°å¯ä»¥æœ‰ç¼ºçœå€¼ã€‚å½“å®šä¹‰å¯¹è±¡æ—¶ï¼Œå¦‚æœä¸ç»™å‡ºå‚æ•°ï¼Œå°±è‡ªåŠ¨æŠŠç›¸åº”çš„ç¼ºçœå‚æ•°å€¼èµ‹ç»™å¯¹è±¡ã€‚ä¸€èˆ¬å½¢å¼ä¸ºï¼š æ„é€ å‡½æ•°åï¼ˆå‚æ•°=ç¼ºçœå€¼ï¼Œå‚æ•°=ç¼ºçœå€¼ï¼Œâ€¦â€¦ï¼‰; ææ„å‡½æ•°ï¼š å½“ä¸€ä¸ªç±»çš„å¯¹è±¡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œææ„å‡½æ•°å°†è¢«è°ƒç”¨(ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨)ã€‚ææ„å‡½æ•°çš„åå­—å’Œç±»åä¸€æ ·ï¼Œä¸è¿‡è¦åœ¨å‰é¢åŠ ä¸Š ~ ã€‚å¯¹ä¸€ä¸ªç±»æ¥è¯´ï¼Œåªèƒ½å…è®¸ä¸€ä¸ªææ„å‡½æ•°ï¼Œææ„å‡½æ•°ä¸èƒ½æœ‰å‚æ•°ï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰è¿”å›å€¼ã€‚ææ„å‡½æ•°çš„ä½œç”¨æ˜¯å®Œæˆä¸€ä¸ªæ¸…ç†å·¥ä½œï¼Œå¦‚é‡Šæ”¾ä»å †ä¸­åˆ†é…çš„å†…å­˜ã€‚ ä¸€ä¸ªç±»ä¸­å¯ä»¥æœ‰å¤šä¸ªæ„é€ å‡½æ•°ï¼Œä½†ææ„å‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªã€‚å¯¹è±¡è¢«ææ„çš„é¡ºåºï¼Œä¸å…¶å»ºç«‹æ—¶çš„é¡ºåºç›¸åï¼Œå³åæ„é€ çš„å¯¹è±¡å…ˆææ„ã€‚ 1ã€æ¦‚å¿µä¸åŒï¼š ææ„å‡½æ•°ï¼šå¯¹è±¡æ‰€åœ¨çš„å‡½æ•°å·²è°ƒç”¨å®Œæ¯•æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œææ„å‡½æ•°ã€‚ æ„é€ å‡½æ•°ï¼šæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ã€‚ç‰¹åˆ«çš„ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªæ„é€ å‡½æ•° ï¼Œå¯æ ¹æ®å…¶å‚æ•°ä¸ªæ•°çš„ä¸åŒæˆ–å‚æ•°ç±»å‹çš„ä¸åŒæ¥åŒºåˆ†å®ƒä»¬ å³æ„é€ å‡½æ•°çš„é‡è½½ã€‚ 2ã€ä½œç”¨ä¸åŒï¼š ææ„å‡½æ•°ï¼šææ„å‡½æ•°è¢«è°ƒç”¨ã€‚ æ„é€ å‡½æ•°ï¼šä¸ºå¯¹è±¡æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼ 3ã€ç›®çš„ä¸åŒï¼š ææ„å‡½æ•°ï¼šâ€æ¸…ç†å–„åâ€ çš„å·¥ä½œ æ„é€ å‡½æ•°ï¼šä¸»è¦ç”¨æ¥åœ¨åˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–å¯¹è±¡ï¼Œ å³ä¸ºå¯¹è±¡æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼ï¼Œæ€»ä¸newè¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨åœ¨åˆ›å»ºå¯¹è±¡çš„è¯­å¥ä¸­ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_two/:2:34","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"35. C++æ¨¡æ¿ https://blog.csdn.net/zhaizhaizhaiaaa/article/details/104091658 ","date":"2023-07-11","objectID":"/posts/basics_two/:2:35","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"36. C++ STL https://www.cnblogs.com/shiyangxt/archive/2008/09/11/1289493.html ref: https://blog.csdn.net/qq_52621551/article/details/122960158 ","date":"2023-07-11","objectID":"/posts/basics_two/:2:36","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"c++ å…«è‚¡æ–‡ ","date":"2023-07-11","objectID":"/posts/basics_two/:3:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":"å…³é”®å­—ä¸è¿ç®—ç¬¦ 1. æŒ‡é’ˆä¸å¼•â½¤ æŒ‡é’ˆï¼šå­˜æ”¾æŸä¸ªå¯¹è±¡çš„åœ°å€ï¼Œå…¶æœ¬â¾å°±æ˜¯å˜é‡ï¼ˆå‘½äº†åçš„å¯¹è±¡ï¼‰ï¼Œæœ¬â¾å°±æœ‰åœ°å€ï¼Œæ‰€ä»¥å¯ä»¥æœ‰æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼›å¯å˜ï¼ŒåŒ…æ‹¬å…¶æ‰€æŒ‡å‘çš„åœ°å€çš„æ”¹å˜å’Œå…¶æŒ‡å‘çš„åœ°å€ä¸­æ‰€å­˜æ”¾çš„æ•°æ®çš„æ”¹å˜ (åœ°å€å¯å˜ï¼Œåœ°å€å­˜å‚¨çš„å€¼ä¹Ÿå¯å˜) å¼•â½¤ï¼šå°±æ˜¯å˜é‡çš„åˆ«åï¼Œä»â¼€â½½ç»ˆï¼Œä¸å¯å˜ï¼Œå¿…é¡»åˆå§‹åŒ–ï¼Œ ä¸å­˜åœ¨æŒ‡å‘ç©ºå€¼çš„å¼•â½¤ï¼Œä½†æ˜¯å­˜åœ¨æŒ‡å‘ç©ºå€¼çš„æŒ‡é’ˆ 2. const å…³é”®å­— constçš„ä½œâ½¤ï¼šè¢«å®ƒä¿®é¥°çš„å€¼ä¸èƒ½æ”¹å˜ï¼Œæ˜¯åªè¯»å˜é‡ã€‚å¿…é¡»åœ¨å®šä¹‰çš„æ—¶å€™å°±ç»™å®ƒèµ‹åˆå€¼ã€‚ é¡¶å±‚const: è¡¨ç¤ºæŒ‡é’ˆæœ¬èº«æ˜¯ä¸ªå¸¸é‡ åº•å±‚const: è¡¨ç¤ºæŒ‡é’ˆæ‰€æŒ‡çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå¸¸é‡ 2.1 å¸¸é‡æŒ‡é’ˆï¼ˆåº•å±‚constï¼‰ï¼ˆæŒ‡é’ˆæŒ‡çš„å¯¹è±¡ä¸å¯æ”¹å˜ï¼‰ å¸¸é‡æŒ‡é’ˆï¼šæ˜¯æŒ‡å®šä¹‰äº†â¼€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘â¼€ä¸ªåªè¯»çš„å¯¹è±¡ï¼Œä¸èƒ½é€šè¿‡å¸¸é‡æŒ‡é’ˆæ¥æ”¹å˜è¿™ä¸ªå¯¹è±¡çš„å€¼ã€‚å¸¸é‡æŒ‡é’ˆå¼ºè°ƒçš„æ˜¯æŒ‡é’ˆå¯¹å…¶æ‰€æŒ‡å¯¹è±¡çš„ä¸å¯æ”¹å˜æ€§ã€‚ ç‰¹ç‚¹ï¼šé è¿‘å˜é‡å å½¢å¼: const æ•°æ®ç±»å‹ *æŒ‡é’ˆå˜é‡ = å˜é‡å æ•°æ®ç±»å‹ const *æŒ‡é’ˆå˜é‡ = å˜é‡å ä¸¾ä¾‹: int temp = 10; const int* a = \u0026temp; int const *a = \u0026temp; 2.2 æŒ‡é’ˆå¸¸é‡ï¼ˆé¡¶å±‚constï¼‰(æŒ‡é’ˆä¸èƒ½æ”¹å˜) æŒ‡é’ˆå¸¸é‡ï¼šæŒ‡é’ˆå¸¸é‡æ˜¯æŒ‡å®šä¹‰äº†â¼€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆçš„å€¼åªèƒ½åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œå…¶ä»–åœ°â½…ä¸èƒ½æ”¹å˜ã€‚æŒ‡é’ˆå¸¸é‡å¼ºè°ƒçš„æ˜¯æŒ‡é’ˆçš„ä¸å¯æ”¹å˜æ€§ã€‚ ç‰¹ç‚¹: é è¿‘å˜é‡ç±»å‹ å½¢å¼: æ•°æ®ç±»å‹ * const æŒ‡é’ˆå˜é‡=å˜é‡å å®ä¾‹: int* const p = \u0026temp 3. define å’Œ typedefçš„åŒºåˆ« ref : https://blog.csdn.net/CSSDCC/article/details/122049204 ref : https://zhuanlan.zhihu.com/p/513450251 ","date":"2023-07-11","objectID":"/posts/basics_two/:3:1","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[äºŒ]","uri":"/posts/basics_two/"},{"categories":["C++"],"content":" Overview c++ å…«è‚¡æ–‡ ç¬¬ä¸€éƒ¨åˆ† ","date":"2023-07-11","objectID":"/posts/basics_one/:0:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1. åŸºç¡€çŸ¥è¯†(ä¸€) ","date":"2023-07-11","objectID":"/posts/basics_one/:1:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.1 C++è¯­è¨€çš„ç‰¹ç‚¹ â‘ C++åœ¨Cçš„åŸºç¡€ä¸Šå¼•å…¥äº†é¢å‘å¯¹è±¡æœºåˆ¶ï¼ŒåŒæ—¶ä¹Ÿå…¼å®¹Cè¯­è¨€ï¼› â‘¡C++ä¸‰å¤§ç‰¹æ€§ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ï¼› â‘¢C++ç¨‹åºç»“æ„æ¸…æ™°ã€æ˜“äºæ‰©å……ã€ç¨‹åºå¯è¯»æ€§å¥½ï¼› â‘£C++ä»£ç è´¨é‡é«˜ï¼Œè¿è¡Œæ•ˆç‡é«˜ã€ä»…æ¯”æ±‡ç¼–è¯­è¨€æ…¢10%~20%ï¼› â‘¥C++å¯å¤ç”¨æ€§é«˜ï¼ŒC++å¼•å…¥äº†æ¨¡æ¿çš„æ¦‚å¿µï¼Œæœ‰ä¸“é—¨çš„æ¨¡æ¿åº“(STL)ï¼› â‘¦C++æ˜¯ä¸æ–­å‘å±•çš„è¯­è¨€ï¼ŒC++11ä¸­æ–°å¼•å…¥äº†nullptrã€autoå˜é‡ã€LambdaåŒ¿åå‡½æ•°ã€å³å€¼å¼•ç”¨ã€æ™ºèƒ½æŒ‡é’ˆã€‚ C++é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹å¾ å°è£…æ€§ï¼š å°†å®¢è§‚äº‹ç‰©æŠ½è±¡æˆç±»ï¼Œæ¯ä¸ªç±»å¯¹è‡ªèº«çš„æ•°æ®å’Œæ–¹æ³•å®è¡Œè®¿é—®æ§åˆ¶ï¼ŒåŒ…æ‹¬(privateï¼Œprotectedï¼Œpublic)ã€‚ ç»§æ‰¿æ€§ï¼š å¹¿ä¹‰çš„ç»§æ‰¿æœ‰ä¸‰ç§å®ç°å½¢å¼ï¼šå®ç°ç»§æ‰¿(ä½¿ç”¨åŸºç±»çš„å±æ€§å’Œæ–¹æ³•è€Œæ— éœ€é¢å¤–ç¼–ç çš„èƒ½åŠ›)ã€å¯è§†ç»§æ‰¿(å­çª—ä½“ä½¿ç”¨çˆ¶çª—ä½“çš„å¤–è§‚å’Œå®ç°ä»£ç )ã€æ¥å£ç»§æ‰¿(ä»…ä½¿ç”¨å±æ€§å’Œæ–¹æ³•ï¼Œå®ç°æ»ååˆ°å­ç±»å®ç°)ã€‚ å¤šæ€æ€§ï¼š æ˜¯å°†çˆ¶ç±»å¯¹è±¡è®¾ç½®æˆä¸ºå’Œä¸€ä¸ªæˆ–æ›´å¤šå®ƒçš„å­å¯¹è±¡ç›¸ç­‰çš„æŠ€æœ¯ã€‚ç”¨å­ç±»å¯¹è±¡ç»™çˆ¶ç±»å¯¹è±¡èµ‹å€¼ä¹‹åï¼Œçˆ¶ç±»å¯¹è±¡å°±å¯ä»¥æ ¹æ®å½“å‰èµ‹å€¼ç»™å®ƒçš„å­å¯¹è±¡çš„ç‰¹æ€§ä»¥ä¸åŒçš„æ–¹å¼è¿ä½œã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:1","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.2 C++å’ŒCè¯­è¨€çš„åŒºåˆ« â‘  Cè¯­è¨€æ˜¯C++çš„å­é›†ï¼ŒC++å¯ä»¥å¾ˆå¥½å…¼å®¹Cè¯­è¨€ã€‚ä½†æ˜¯C++åˆæœ‰å¾ˆå¤šæ–°ç‰¹æ€§ï¼Œå¦‚å¼•ç”¨ã€æ™ºèƒ½æŒ‡é’ˆã€autoå˜é‡ç­‰ï¼› â‘¡ C++æ˜¯é¢å¯¹å¯¹è±¡(object-oriented)çš„ç¼–ç¨‹è¯­è¨€ï¼›Cè¯­è¨€æ˜¯é¢å¯¹è¿‡ç¨‹(process-oriented)çš„ç¼–ç¨‹è¯­è¨€ï¼› â‘¢ Cè¯­è¨€æœ‰ä¸€äº›ä¸å®‰å…¨çš„è¯­è¨€ç‰¹æ€§ï¼Œå¦‚æŒ‡é’ˆä½¿ç”¨çš„æ½œåœ¨å±é™©ã€å¼ºåˆ¶è½¬æ¢çš„ä¸ç¡®å®šæ€§ã€å†…å­˜æ³„éœ²ç­‰ã€‚è€ŒC++å¯¹æ­¤å¢åŠ äº†ä¸å°‘æ–°ç‰¹æ€§æ¥æ”¹å–„å®‰å…¨æ€§ï¼Œå¦‚constå¸¸é‡ã€å¼•ç”¨ã€castè½¬æ¢ã€æ™ºèƒ½æŒ‡é’ˆã€tryâ€”catchç­‰ç­‰ï¼› â‘£ C++å¯å¤ç”¨æ€§é«˜ï¼ŒC++å¼•å…¥äº†æ¨¡æ¿çš„æ¦‚å¿µï¼Œåé¢åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå®ç°äº†æ–¹ä¾¿å¼€å‘çš„æ ‡å‡†æ¨¡æ¿åº“STLã€‚C++çš„STLåº“ç›¸å¯¹äºCè¯­è¨€çš„å‡½æ•°åº“æ›´çµæ´»ã€æ›´é€šç”¨ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:2","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.3 C++ä¸­ struct å’Œ class çš„åŒºåˆ« â‘  struct ä¸€èˆ¬ç”¨äºæè¿°ä¸€ä¸ªæ•°æ®ç»“æ„é›†åˆï¼Œè€Œ class æ˜¯å¼ºè°ƒå¯¹ä¸€ä¸ªå¯¹è±¡æ•°æ®çš„å°è£…ï¼› â‘¡ struct ä¸­é»˜è®¤çš„è®¿é—®æ§åˆ¶æƒé™æ˜¯ public çš„ï¼Œè€Œ class ä¸­é»˜è®¤çš„è®¿é—®æ§åˆ¶æƒé™æ˜¯ private çš„ï¼› â‘¢ åœ¨ç»§æ‰¿å…³ç³»ä¸­ï¼Œstruct é»˜è®¤æ˜¯å…¬æœ‰ç»§æ‰¿ï¼Œè€Œ class æ˜¯ç§æœ‰ç»§æ‰¿ï¼› â‘£ classå…³é”®å­—å¯ä»¥ç”¨äºå®šä¹‰æ¨¡æ¿å‚æ•°ï¼Œå°±åƒtypenameï¼Œè€Œ struct ä¸èƒ½ç”¨äºå®šä¹‰æ¨¡æ¿å‚æ•°ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:3","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.4 includeå¤´æ–‡ä»¶çš„é¡ºåºä»¥åŠåŒå¼•å·\"\"å’Œå°–æ‹¬å·\u003c\u003eçš„åŒºåˆ« åŒºåˆ«ï¼š â‘  å°–æ‹¬å·\u003c \u003eçš„å¤´æ–‡ä»¶æ˜¯ç³»ç»Ÿæ–‡ä»¶ï¼ŒåŒå¼•å·\" \"çš„å¤´æ–‡ä»¶æ˜¯è‡ªå®šä¹‰æ–‡ä»¶; â‘¡ ç¼–è¯‘å™¨é¢„å¤„ç†é˜¶æ®µæŸ¥æ‰¾å¤´æ–‡ä»¶çš„è·¯å¾„ä¸ä¸€æ ·ï¼› æŸ¥æ‰¾è·¯å¾„ï¼š â‘  ä½¿ç”¨å°–æ‹¬å·\u003c \u003e(ç³»ç»Ÿæ–‡ä»¶)çš„å¤´æ–‡ä»¶çš„æŸ¥æ‰¾è·¯å¾„ï¼šç¼–è¯‘å™¨è®¾ç½®çš„å¤´æ–‡ä»¶è·¯å¾„$\\rightarrow$ç³»ç»Ÿå˜é‡; â‘¡ ä½¿ç”¨åŒå¼•å·\" \"(è‡ªå®šä¹‰æ–‡ä»¶)çš„å¤´æ–‡ä»¶çš„æŸ¥æ‰¾è·¯å¾„ï¼šå½“å‰å¤´æ–‡ä»¶ç›®å½•$\\rightarrow$ç¼–è¯‘å™¨è®¾ç½®çš„å¤´æ–‡ä»¶è·¯å¾„$\\rightarrow$ç³»ç»Ÿå˜é‡ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:4","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.5 C++ç»“æ„ä½“å’ŒCç»“æ„ä½“çš„åŒºåˆ« â‘ Cçš„ç»“æ„ä½“å†…ä¸å…è®¸æœ‰å‡½æ•°å­˜åœ¨ï¼ŒC++å…è®¸æœ‰å†…éƒ¨æˆå‘˜å‡½æ•°ï¼Œä¸”å…è®¸è¯¥å‡½æ•°æ˜¯è™šå‡½æ•°ï¼› â‘¡Cçš„ç»“æ„ä½“å¯¹å†…éƒ¨æˆå‘˜å˜é‡çš„è®¿é—®æƒé™åªèƒ½æ˜¯publicï¼Œè€ŒC++å…è®¸ publicï¼Œprotectedï¼Œprivateä¸‰ç§ï¼› â‘¢C ä¸­ä½¿ç”¨ç»“æ„ä½“éœ€è¦åŠ ä¸Š struct å…³é”®å­—ï¼Œæˆ–è€…å¯¹ç»“æ„ä½“ä½¿ç”¨ typedef å–åˆ«åï¼Œè€Œ C++ ä¸­å¯ä»¥çœç•¥ struct å…³é”®å­—ç›´æ¥ä½¿ç”¨ï¼› â‘£Cè¯­è¨€çš„ç»“æ„ä½“æ˜¯ä¸å¯ä»¥ç»§æ‰¿çš„ï¼ŒC++çš„ç»“æ„ä½“æ˜¯å¯ä»¥ä»å…¶ä»–çš„ç»“æ„ä½“æˆ–è€…ç±»ç»§æ‰¿è¿‡æ¥çš„ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:5","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.6 å¯¼å…¥Cå‡½æ•°çš„å…³é”®å­—æ˜¯ä»€ä¹ˆï¼ŒC++ç¼–è¯‘æ—¶å’ŒCæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ å…³é”®å­—ï¼š åœ¨C++ä¸­ï¼Œå¯¼å…¥Cå‡½æ•°çš„å…³é”®å­—æ˜¯externï¼Œè¡¨è¾¾å½¢å¼ä¸ºextern \"C\"ï¼Œ extern \"C\" çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®å®ç°C++ä»£ç è°ƒç”¨å…¶ä»–Cè¯­è¨€ä»£ç ã€‚åŠ ä¸Šextern \"C\"åï¼Œä¼šæŒ‡ç¤ºç¼–è¯‘å™¨è¿™éƒ¨åˆ†ä»£ç æŒ‰Cè¯­è¨€çš„è¿›è¡Œç¼–è¯‘ï¼Œè€Œä¸æ˜¯C++çš„ã€‚ ç¼–è¯‘åŒºåˆ«ï¼š ç”±äºC++æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘å™¨ç¼–è¯‘å‡½æ•°çš„è¿‡ç¨‹ä¸­ä¼šå°†å‡½æ•°çš„å‚æ•°ç±»å‹ä¹ŸåŠ åˆ°ç¼–è¯‘åçš„ä»£ç ä¸­ï¼Œè€Œä¸ä»…ä»…æ˜¯å‡½æ•°åï¼›è€ŒCè¯­è¨€å¹¶ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘Cè¯­è¨€ä»£ç çš„å‡½æ•°æ—¶ä¸ä¼šå¸¦ä¸Šå‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œä¸€èˆ¬åªåŒ…æ‹¬å‡½æ•°åã€‚ æ€»ç»“: åŒºåˆ«åœ¨äºåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ˜¯å¦å¸¦ä¸Šå‡½æ•°çš„å‚æ•°ç±»å‹ï¼ŒC++å¸¦ï¼ŒCä¸å¸¦ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:6","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.7 ç®€è¿°C++ä»ä»£ç åˆ°å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„è¿‡ç¨‹ é¢„ç¼–è¯‘ã€ç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥ â‘ é¢„ç¼–è¯‘ï¼šè¿™ä¸ªè¿‡ç¨‹ä¸»è¦çš„å¤„ç†æ“ä½œå¦‚ä¸‹ï¼š (1) å°†æ‰€æœ‰çš„#defineåˆ é™¤ï¼Œå¹¶ä¸”å±•å¼€æ‰€æœ‰çš„å®å®šä¹‰ (2) å¤„ç†æ‰€æœ‰çš„æ¡ä»¶é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œå¦‚#ifã€#ifdef (3) å¤„ç†#includeé¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œå°†è¢«åŒ…å«çš„æ–‡ä»¶æ’å…¥åˆ°è¯¥é¢„ç¼–è¯‘æŒ‡ä»¤çš„ä½ç½®ã€‚ (4) è¿‡æ»¤æ‰€æœ‰çš„æ³¨é‡Š (5) æ·»åŠ è¡Œå·å’Œæ–‡ä»¶åæ ‡è¯† â‘¡ç¼–è¯‘ï¼šè¿™ä¸ªè¿‡ç¨‹ä¸»è¦çš„å¤„ç†æ“ä½œå¦‚ä¸‹ï¼š (1) è¯æ³•åˆ†æï¼šå°†æºä»£ç çš„å­—ç¬¦åºåˆ—åˆ†å‰²æˆä¸€ç³»åˆ—çš„è®°å·ã€‚ (2) è¯­æ³•åˆ†æï¼šå¯¹è®°å·è¿›è¡Œè¯­æ³•åˆ†æï¼Œäº§ç”Ÿè¯­æ³•æ ‘ã€‚ (3) è¯­ä¹‰åˆ†æï¼šåˆ¤æ–­è¡¨è¾¾å¼æ˜¯å¦æœ‰æ„ä¹‰ã€‚ (4) ä»£ç ä¼˜åŒ–ï¼š (5) ç›®æ ‡ä»£ç ç”Ÿæˆï¼šç”Ÿæˆæ±‡ç¼–ä»£ç ã€‚ (6) ç›®æ ‡ä»£ç ä¼˜åŒ– â‘¢æ±‡ç¼–ï¼šè¿™ä¸ªè¿‡ç¨‹ä¸»è¦æ˜¯å°†æ±‡ç¼–ä»£ç è½¬å˜æˆæœºå™¨å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤(æ±‡ç¼–ä»£ç è½¬ä¸ºæœºå™¨ç )ã€‚ â‘£é“¾æ¥ï¼šå°†ä¸åŒçš„æºæ–‡ä»¶äº§ç”Ÿçš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œé“¾æ¥ï¼Œä»è€Œå½¢æˆä¸€ä¸ªå¯ä»¥æ‰§è¡Œçš„ç¨‹åº(é“¾æ¥ç›®æ ‡æ–‡ä»¶ï¼Œå½¢æˆå¯æ‰§è¡Œç¨‹åº)ã€‚ â€‹ é“¾æ¥åˆ†ä¸ºé™æ€é“¾æ¥å’ŒåŠ¨æ€é“¾æ¥ã€‚ (1) é™æ€é“¾æ¥ï¼Œæ˜¯åœ¨é“¾æ¥çš„æ—¶å€™å°±å·²ç»æŠŠè¦è°ƒç”¨çš„å‡½æ•°æˆ–è€…è¿‡ç¨‹é“¾æ¥åˆ°äº†ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå°±ç®—ä½ å†å»æŠŠé™æ€åº“åˆ é™¤ä¹Ÿä¸ä¼šå½±å“å¯æ‰§è¡Œç¨‹åºçš„æ‰§è¡Œï¼›ç”Ÿæˆçš„é™æ€é“¾æ¥åº“ï¼ŒWindowsä¸‹ä»¥.libä¸ºåç¼€ï¼ŒLinuxä¸‹ä»¥.aä¸ºåç¼€ã€‚ (2) åŠ¨æ€é“¾æ¥ï¼Œæ˜¯åœ¨é“¾æ¥çš„æ—¶å€™æ²¡æœ‰æŠŠè°ƒç”¨çš„å‡½æ•°ä»£ç é“¾æ¥è¿›å»ï¼Œè€Œæ˜¯åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå†å»æ‰¾è¦é“¾æ¥çš„å‡½æ•°ï¼Œç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­æ²¡æœ‰å‡½æ•°ä»£ç ï¼ŒåªåŒ…å«å‡½æ•°çš„é‡å®šä½ä¿¡æ¯ï¼Œæ‰€ä»¥å½“ä½ åˆ é™¤åŠ¨æ€åº“æ—¶ï¼Œå¯æ‰§è¡Œç¨‹åºå°±ä¸èƒ½è¿è¡Œã€‚ç”Ÿæˆçš„åŠ¨æ€é“¾æ¥åº“ï¼ŒWindowsä¸‹ä»¥.dllä¸ºåç¼€ï¼ŒLinuxä¸‹ä»¥.soä¸ºåç¼€ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:7","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.8 staticå…³é”®å­—çš„ä½œç”¨ â‘ å®šä¹‰å…¨å±€é™æ€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡ï¼šåœ¨å˜é‡å‰é¢åŠ ä¸Šstaticå…³é”®å­—ã€‚staticçš„å˜é‡é»˜è®¤åˆå§‹åŒ–ä¸º0ã€‚åˆå§‹åŒ–çš„é™æ€å˜é‡ä¼šåœ¨æ•°æ®æ®µåˆ†é…å†…å­˜ï¼Œæœªåˆå§‹åŒ–çš„é™æ€å˜é‡ä¼šåœ¨BSSæ®µåˆ†é…å†…å­˜ã€‚ç›´åˆ°ç¨‹åºç»“æŸï¼Œé™æ€å˜é‡å§‹ç»ˆä¼šç»´æŒå‰å€¼ã€‚åªä¸è¿‡å…¨å±€é™æ€å˜é‡(åœ¨æ•´ä¸ªå·¥ç¨‹æ–‡ä»¶æœ‰æ•ˆ)å’Œå±€éƒ¨é™æ€å˜é‡(åœ¨å½“å‰å®šä¹‰çš„æ–‡ä»¶å†…æœ‰æ•ˆ)çš„ä½œç”¨åŸŸä¸ä¸€æ ·ï¼›(ä»€ä¹ˆæ˜¯æ•°æ®æ®µå’ŒBBSæ®µå†…å­˜åˆ†é…?) â‘¡å®šä¹‰é™æ€å‡½æ•°ï¼šåœ¨å‡½æ•°è¿”å›ç±»å‹å‰åŠ ä¸Šstaticå…³é”®å­—ï¼Œå‡½æ•°å³è¢«å®šä¹‰ä¸ºé™æ€å‡½æ•°ã€‚é™æ€å‡½æ•°åªèƒ½åœ¨æœ¬æºæ–‡ä»¶ä¸­ä½¿ç”¨ï¼›static int func() â‘¢åœ¨å˜é‡ç±»å‹å‰åŠ ä¸Šstaticå…³é”®å­—ï¼Œå˜é‡å³è¢«å®šä¹‰ä¸ºé™æ€å˜é‡ã€‚é™æ€å˜é‡åªèƒ½åœ¨æœ¬æºæ–‡ä»¶ä¸­ä½¿ç”¨; â‘£ç±»å†…é™æ€æˆå‘˜å˜é‡: åœ¨c++ä¸­ï¼Œstaticå…³é”®å­—å¯ä»¥ç”¨äºå®šä¹‰ç±»ä¸­çš„é™æ€æˆå‘˜å˜é‡ï¼šä½¿ç”¨é™æ€æ•°æ®æˆå‘˜ï¼Œå®ƒæ—¢å¯ä»¥è¢«å½“æˆå…¨å±€å˜é‡é‚£æ ·å»å­˜å‚¨ï¼Œä½†åˆè¢«éšè—åœ¨ç±»çš„å†…éƒ¨ã€‚ç±»ä¸­çš„staticé™æ€æ•°æ®æˆå‘˜æ‹¥æœ‰ä¸€å—å•ç‹¬çš„å­˜å‚¨åŒºï¼Œè€Œä¸ç®¡åˆ›å»ºäº†å¤šå°‘ä¸ªè¯¥ç±»çš„å¯¹è±¡ã€‚æ‰€æœ‰è¿™äº›å¯¹è±¡çš„é™æ€æ•°æ®æˆå‘˜éƒ½å…±äº«è¿™ä¸€å—é™æ€å­˜å‚¨ç©ºé—´ï¼Œstaticä¿®é¥°çš„å˜é‡è¦åœ¨ç±»å¤–åˆå§‹åŒ–ã€‚ â‘¤ç±»å†…é™æ€æˆå‘˜å‡½æ•°:åœ¨c++ä¸­ï¼Œstaticå…³é”®å­—å¯ä»¥ç”¨äºå®šä¹‰ç±»ä¸­çš„é™æ€æˆå‘˜å‡½æ•°ï¼šä¸é™æ€æˆå‘˜å˜é‡ç±»ä¼¼ï¼Œç±»é‡Œé¢åŒæ ·å¯ä»¥å®šä¹‰é™æ€æˆå‘˜å‡½æ•°ã€‚åªéœ€è¦åœ¨å‡½æ•°å‰åŠ ä¸Šå…³é”®å­—staticå³å¯ã€‚å¦‚é™æ€æˆå‘˜å‡½æ•°ä¹Ÿæ˜¯ç±»çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚æ‰€æœ‰è¿™äº›å¯¹è±¡çš„é™æ€æ•°æ®æˆå‘˜éƒ½å…±äº«è¿™ä¸€å—é™æ€å­˜å‚¨ç©ºé—´ï¼Œåªèƒ½è®¿é—®ç±»çš„staticæˆå‘˜å˜é‡ï¼Œstaticä¿®é¥°çš„å˜é‡è¦åœ¨ç±»å¤–åˆå§‹åŒ–ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:8","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.9 æ•°ç»„å’ŒæŒ‡é’ˆçš„åŒºåˆ« æ¦‚å¿µï¼š (1)æ•°ç»„ï¼šæ•°ç»„æ˜¯ç”¨äºå‚¨å­˜å¤šä¸ªç›¸åŒç±»å‹æ•°æ®çš„é›†åˆã€‚æ•°ç»„åæ˜¯é¦–å…ƒç´ çš„åœ°å€ã€‚ (2)æŒ‡é’ˆï¼šæŒ‡é’ˆç›¸å½“äºä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯å®ƒå’Œä¸€èˆ¬å˜é‡ä¸ä¸€æ ·ï¼Œå®ƒå­˜æ”¾çš„æ˜¯å…¶å®ƒå˜é‡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚æŒ‡é’ˆåæŒ‡å‘äº†å†…å­˜çš„é¦–åœ°å€ã€‚ åŒºåˆ«ï¼š èµ‹å€¼ï¼šåŒç±»å‹æŒ‡é’ˆå˜é‡å¯ä»¥ç›¸äº’èµ‹å€¼ï¼›æ•°ç»„ä¸è¡Œï¼Œåªèƒ½ä¸€ä¸ªä¸€ä¸ªå…ƒç´ çš„èµ‹å€¼æˆ–æ‹·è´ï¼› å­˜å‚¨æ–¹å¼ï¼š æ•°ç»„ï¼šæ•°ç»„åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­å­˜æ”¾çš„ï¼Œå¼€è¾Ÿä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´ã€‚æ•°ç»„æ˜¯æ ¹æ®æ•°ç»„çš„ä¸‹æ ‡è¿›è¡Œè®¿é—®çš„ï¼Œæ•°ç»„çš„å­˜å‚¨ç©ºé—´ï¼Œä¸æ˜¯åœ¨é™æ€åŒºå°±æ˜¯åœ¨æ ˆä¸Šã€‚ æŒ‡é’ˆï¼šæŒ‡é’ˆå¾ˆçµæ´»ï¼Œå®ƒå¯ä»¥æŒ‡å‘ä»»æ„ç±»å‹çš„æ•°æ®ã€‚æŒ‡é’ˆçš„ç±»å‹è¯´æ˜äº†å®ƒæ‰€æŒ‡å‘åœ°å€ç©ºé—´çš„å†…å­˜ã€‚ç”±äºæŒ‡é’ˆæœ¬èº«å°±æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå†åŠ ä¸Šå®ƒæ‰€å­˜æ”¾çš„ä¹Ÿæ˜¯å˜é‡ï¼Œæ‰€ä»¥æŒ‡é’ˆçš„å­˜å‚¨ç©ºé—´ä¸èƒ½ç¡®å®šã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:9","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.10 ä»€ä¹ˆæ˜¯å‡½æ•°æŒ‡é’ˆï¼Œå¦‚ä½•å®šä¹‰å‡½æ•°æŒ‡é’ˆï¼Œæœ‰ä»€ä¹ˆä½¿ç”¨åœºæ™¯ æ¦‚å¿µï¼š å‡½æ•°æŒ‡é’ˆå°±æ˜¯æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡ã€‚æ¯ä¸€ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªå…¥å£åœ°å€ï¼Œè¯¥å‡½æ•°å…¥å£åœ°å€å°±æ˜¯å‡½æ•°æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ã€‚ Note å‡½æ•°æŒ‡é’ˆæŒ‡å‘å‡½æ•°çš„å…¥å£åœ°å€ï¼ å®šä¹‰å½¢å¼ï¼š int func(int a); // å‡½æ•° int (*f)(int a); // å‡½æ•°æŒ‡é’ˆ f = \u0026func; ä½¿ç”¨åœºæ™¯ï¼š å›è°ƒ(callback)ã€‚æˆ‘ä»¬è°ƒç”¨åˆ«äººæä¾›çš„ APIå‡½æ•°(Application Programming Interface,åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£)ï¼Œç§°ä¸ºCallï¼›å¦‚æœåˆ«äººçš„åº“é‡Œé¢è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°ï¼Œå°±å«Callbackã€‚ //ä»¥åº“å‡½æ•°qsortæ’åºå‡½æ•°ä¸ºä¾‹ï¼Œå®ƒçš„åŸå‹å¦‚ä¸‹ï¼š void qsort(void *base,//void*ç±»å‹ï¼Œä»£è¡¨åŸå§‹æ•°ç»„ size_t nmemb, //ç¬¬äºŒä¸ªæ˜¯size_tç±»å‹ï¼Œä»£è¡¨æ•°æ®æ•°é‡ size_t size, //ç¬¬ä¸‰ä¸ªæ˜¯size_tç±»å‹ï¼Œä»£è¡¨å•ä¸ªæ•°æ®å ç”¨ç©ºé—´å¤§å° int(*compar)(const void *,const void *)//ç¬¬å››ä¸ªå‚æ•°æ˜¯å‡½æ•°æŒ‡é’ˆ ); //ç¬¬å››ä¸ªå‚æ•°å‘Šè¯‰qsortï¼Œåº”è¯¥ä½¿ç”¨å“ªä¸ªå‡½æ•°æ¥æ¯”è¾ƒå…ƒç´ ï¼Œ //å³åªè¦æˆ‘ä»¬å‘Šè¯‰qsortæ¯”è¾ƒå¤§å°çš„è§„åˆ™ï¼Œå®ƒå°±å¯ä»¥å¸®æˆ‘ä»¬å¯¹ä»»æ„æ•°æ®ç±»å‹çš„æ•°ç»„è¿›è¡Œæ’åºã€‚ //åœ¨åº“å‡½æ•°qsortè°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°ï¼Œè¿™å°±æ˜¯å›è°ƒçš„åº”ç”¨ã€‚ //ç¤ºä¾‹ int num[100]; int cmp_int(const void* _a , const void* _b){//å‚æ•°æ ¼å¼å›ºå®š int* a = (int*)_a; //å¼ºåˆ¶ç±»å‹è½¬æ¢ int* b = (int*)_b; return *a - *b;ã€€} qsort(num,100,sizeof(num[0]),cmp_int); //å›è°ƒcmp_intå‡½æ•° ","date":"2023-07-11","objectID":"/posts/basics_one/:1:10","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.11 é™æ€å˜é‡ä»€ä¹ˆæ—¶å€™åˆå§‹åŒ– å¯¹äºCè¯­è¨€çš„å…¨å±€å’Œé™æ€å˜é‡ï¼Œåˆå§‹åŒ–å‘ç”Ÿåœ¨ä»»ä½•ä»£ç æ‰§è¡Œä¹‹å‰ï¼Œå±äºç¼–è¯‘æœŸåˆå§‹åŒ–ã€‚ è€ŒC++æ ‡å‡†è§„å®šï¼šå…¨å±€æˆ–é™æ€å¯¹è±¡å½“ä¸”ä»…å½“å¯¹è±¡é¦–æ¬¡ç”¨åˆ°æ—¶æ‰è¿›è¡Œæ„é€ ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:11","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.12 nullptrè°ƒç”¨æˆå‘˜å‡½æ•°å¯ä»¥å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ å¯ä»¥ã€‚å› ä¸ºåœ¨ç¼–è¯‘æ—¶å¯¹è±¡å°±ç»‘å®šäº†å‡½æ•°åœ°å€ï¼Œå’ŒæŒ‡é’ˆç©ºä¸ç©ºæ²¡å…³ç³»ã€‚ //ç»™å‡ºå®ä¾‹ class animal { public: void sleep() { cout \u003c\u003c \"animal sleep\" \u003c\u003c endl; } void breathe() { cout \u003c\u003c \"animal breathe haha\" \u003c\u003c endl; } }; class fish :public animal { public: void breathe(){ cout \u003c\u003c \"fish bubble\" \u003c\u003c endl; } }; int main() { animal *pAn=nullptr; //ç±»æŒ‡é’ˆ pAn-\u003ebreathe(); // è¾“å‡ºï¼šanimal breathe haha fish *pFish = nullptr; pFish-\u003ebreathe(); // è¾“å‡ºï¼šfish bubble return 0; } // åŸå› ï¼šå› ä¸ºåœ¨ç¼–è¯‘æ—¶å¯¹è±¡å°±ç»‘å®šäº†å‡½æ•°åœ°å€ï¼Œå’ŒæŒ‡é’ˆç©ºä¸ç©ºæ²¡å…³ç³»ã€‚ // pAn-\u003ebreathe();ç¼–è¯‘çš„æ—¶å€™ï¼Œå‡½æ•°çš„åœ°å€å°±å’ŒæŒ‡é’ˆpAnç»‘å®šäº†ï¼› // è°ƒç”¨breath(*this), thiså°±ç­‰äºpAnã€‚ç”±äºå‡½æ•°ä¸­æ²¡æœ‰éœ€è¦è§£å¼•ç”¨thisçš„åœ°æ–¹ï¼Œæ‰€ä»¥å‡½æ•°è¿è¡Œä¸ä¼šå‡ºé”™ï¼Œ // ä½†æ˜¯è‹¥ç”¨åˆ°thisï¼Œå› ä¸ºthis=nullptrï¼Œè¿è¡Œå‡ºé”™ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:12","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.13 ä»€ä¹ˆæ˜¯é‡æŒ‡é’ˆï¼Œæ€ä¹ˆäº§ç”Ÿçš„ï¼Œå¦‚ä½•é¿å…ï¼Ÿ æ¦‚å¿µï¼š é‡æŒ‡é’ˆå°±æ˜¯æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®æ˜¯ä¸å¯çŸ¥çš„(éšæœºçš„ã€ä¸æ­£ç¡®çš„ã€æ²¡æœ‰æ˜ç¡®é™åˆ¶çš„)ï¼› Note æŒ‡å‘ä½ç½®ä¸å¯çŸ¥ç§°ä¸ºé‡æŒ‡é’ˆï¼ äº§ç”ŸåŸå› ï¼šé‡Šæ”¾å†…å­˜åæŒ‡é’ˆä¸åŠæ—¶ç½®ç©º(é‡æŒ‡é’ˆ)ï¼Œä¾ç„¶æŒ‡å‘äº†è¯¥å†…å­˜ï¼Œé‚£ä¹ˆå¯èƒ½å‡ºç°éæ³•è®¿é—®çš„é”™è¯¯ã€‚è¿™äº›æˆ‘ä»¬éƒ½è¦æ³¨æ„é¿å…ã€‚(å†…å­˜æ³„éœ²) é¿å…åŠæ³•ï¼š (1)åˆå§‹åŒ–ç½®NULL (2)ç”³è¯·å†…å­˜ååˆ¤ç©º (3)æŒ‡é’ˆé‡Šæ”¾åç½®NULL (4)ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:13","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.14 é™æ€å±€éƒ¨å˜é‡ï¼Œå…¨å±€å˜é‡ï¼Œå±€éƒ¨å˜é‡çš„ç‰¹ç‚¹ï¼Œä»¥åŠä½¿ç”¨åœºæ™¯ â‘ é¦–å…ˆä»ä½œç”¨åŸŸè€ƒè™‘: C++é‡Œä½œç”¨åŸŸå¯åˆ†ä¸º6ç§: å…¨å±€ï¼Œå±€éƒ¨ï¼Œç±»ï¼Œè¯­å¥ï¼Œå‘½åç©ºé—´å’Œæ–‡ä»¶ä½œç”¨åŸŸã€‚ å…¨å±€å˜é‡: å…¨å±€ä½œç”¨åŸŸï¼Œå¯ä»¥é€šè¿‡externä½œç”¨äºå…¶ä»–éå®šä¹‰çš„æºæ–‡ä»¶ã€‚ é™æ€å…¨å±€å˜é‡: å…¨å±€ä½œç”¨åŸŸ+æ–‡ä»¶ä½œç”¨åŸŸï¼Œæ‰€ä»¥æ— æ³•åœ¨å…¶ä»–æ–‡ä»¶ä¸­ä½¿ç”¨ã€‚ å±€éƒ¨å˜é‡: å±€éƒ¨ä½œç”¨åŸŸï¼Œæ¯”å¦‚å‡½æ•°çš„å‚æ•°ï¼Œå‡½æ•°å†…çš„å±€éƒ¨å˜é‡ç­‰ç­‰ã€‚ é™æ€å±€éƒ¨å˜é‡: å±€éƒ¨ä½œç”¨åŸŸï¼Œåªè¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œç›´åˆ°ç¨‹åºç»“æŸã€‚ â‘¡ä»æ‰€åœ¨ç©ºé—´è€ƒè™‘ï¼šé™¤äº†å±€éƒ¨å˜é‡åœ¨æ ˆä¸Šå¤–ï¼Œå…¶ä»–éƒ½åœ¨é™æ€å­˜å‚¨åŒºã€‚å› ä¸ºé™æ€å˜é‡éƒ½åœ¨é™æ€å­˜å‚¨åŒºï¼Œæ‰€ä»¥ä¸‹æ¬¡è°ƒç”¨å‡½æ•°çš„æ—¶å€™è¿˜æ˜¯èƒ½å–åˆ°åŸæ¥çš„å€¼ã€‚ â‘¢ç”Ÿå‘½å‘¨æœŸï¼š å±€éƒ¨å˜é‡åœ¨æ ˆä¸Šï¼Œå‡ºäº†ä½œç”¨åŸŸå°±å›æ”¶å†…å­˜ï¼›è€Œå…¨å±€å˜é‡ã€é™æ€å…¨å±€å˜é‡ã€é™æ€å±€éƒ¨å˜é‡éƒ½åœ¨é™æ€å­˜å‚¨åŒºï¼Œç›´åˆ°ç¨‹åºç»“æŸæ‰ä¼šå›æ”¶å†…å­˜ã€‚ â‘£ä½¿ç”¨åœºæ™¯ï¼šä»å®ƒä»¬å„è‡ªç‰¹ç‚¹å°±å¯ä»¥çœ‹å‡ºå„è‡ªçš„åº”ç”¨åœºæ™¯ï¼Œä¸å†èµ˜è¿°ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:14","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.15 C++ç»§æ‰¿ â‘ å…¬æœ‰ç»§æ‰¿publicï¼šåŸºç±»çš„å…¬æœ‰æˆå‘˜å’Œä¿æŠ¤æˆå‘˜ä½œä¸ºæ´¾ç”Ÿç±»çš„æˆå‘˜æ—¶ï¼Œå®ƒä»¬éƒ½ä¿æŒåŸæœ‰çš„çŠ¶æ€ï¼Œè€ŒåŸºç±»çš„ç§æœ‰æˆå‘˜ä»ç„¶æ˜¯ç§æœ‰çš„ï¼Œä¸èƒ½è¢«è¿™ä¸ªæ´¾ç”Ÿç±»çš„å­ç±»æ‰€è®¿é—®ã€‚ â‘¡ç§æœ‰ç»§æ‰¿privateï¼šç§æœ‰ç»§æ‰¿çš„ç‰¹ç‚¹æ˜¯åŸºç±»çš„å…¬æœ‰æˆå‘˜å’Œä¿æŠ¤æˆå‘˜éƒ½ä½œä¸ºæ´¾ç”Ÿç±»çš„ç§æœ‰æˆå‘˜ï¼Œå¹¶ä¸”ä¸èƒ½è¢«è¿™ä¸ªæ´¾ç”Ÿç±»çš„å­ç±»æ‰€è®¿é—®ã€‚ â‘¢ä¿æŠ¤ç»§æ‰¿protectï¼šä¿æŠ¤ç»§æ‰¿çš„ç‰¹ç‚¹æ˜¯åŸºç±»çš„æ‰€æœ‰å…¬æœ‰æˆå‘˜å’Œä¿æŠ¤æˆå‘˜éƒ½æˆä¸ºæ´¾ç”Ÿç±»çš„ä¿æŠ¤æˆå‘˜ï¼Œå¹¶ä¸”åªèƒ½è¢«å®ƒçš„æ´¾ç”Ÿç±»æˆå‘˜å‡½æ•°æˆ–å‹å…ƒè®¿é—®ï¼ŒåŸºç±»çš„ç§æœ‰æˆå‘˜ä»ç„¶æ˜¯ç§æœ‰çš„ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:15","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.16 å¸¸é‡æŒ‡é’ˆå’ŒæŒ‡é’ˆå¸¸é‡ å¸¸é‡æŒ‡é’ˆå’ŒæŒ‡é’ˆå¸¸é‡çš„åŒºåˆ« å¸¸é‡æŒ‡é’ˆ: å†…å­˜é‡Œçš„å€¼ä¸å˜ æŒ‡é’ˆå¸¸é‡: æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åœ°å€ä¸å˜ 1. const int a; //æŒ‡çš„æ˜¯aæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œä¸å…è®¸ä¿®æ”¹ã€‚ 2. const int *a; //aæŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜é‡Œçš„å€¼ä¸å˜ï¼Œå³(*a)ä¸å˜ å¸¸é‡æŒ‡é’ˆ 3. int const *a; //åŒconst int *a; 4. int *const a; //aæŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜åœ°å€ä¸å˜ï¼Œå³aä¸å˜ æŒ‡é’ˆå¸¸é‡ 5. const int *const a; //éƒ½ä¸å˜ï¼Œå³(*a)ä¸å˜ï¼Œaä¹Ÿä¸å˜ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:16","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.17 å†…è”å‡½æ•°å’Œå‡½æ•°çš„åŒºåˆ« â‘ å†…è”å‡½æ•°æ¯”æ™®é€šå‡½æ•°å¤šäº†å…³é”®å­—inlineï¼› â‘¡å†…è”å‡½æ•°é¿å…äº†å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼›æ™®é€šå‡½æ•°æœ‰è°ƒç”¨çš„å¼€é”€ï¼› â‘¢æ™®é€šå‡½æ•°åœ¨è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œéœ€è¦å¯»å€(å‡½æ•°å…¥å£åœ°å€)ï¼›å†…è”å‡½æ•°ä¸éœ€è¦å¯»å€ã€‚ â‘£å†…è”å‡½æ•°æœ‰ä¸€å®šçš„é™åˆ¶ï¼Œå†…è”å‡½æ•°ä½“è¦æ±‚ä»£ç ç®€å•ï¼Œä¸èƒ½åŒ…å«å¤æ‚çš„ç»“æ„æ§åˆ¶è¯­å¥(å†…è”å‡½æ•°å†…ä¸å…è®¸ç”¨å¾ªç¯è¯­å¥å’Œå¼€å…³è¯­å¥ã€‚æ™®é€šå‡½æ•°æ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:1:17","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.18 ç®€è¿°C++æœ‰å‡ ç§ä¼ å€¼æ–¹å¼ï¼Œä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ å€¼ä¼ é€’ã€å¼•ç”¨ä¼ é€’ã€æŒ‡é’ˆä¼ é€’ â‘ å€¼ä¼ é€’: å½¢å‚å³ä½¿åœ¨å‡½æ•°ä½“å†…å€¼å‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿä¸ä¼šå½±å“å®å‚çš„å€¼ï¼› â‘¡å¼•ç”¨ä¼ é€’: å½¢å‚åœ¨å‡½æ•°ä½“å†…å€¼å‘ç”Ÿå˜åŒ–ï¼Œä¼šå½±å“å®å‚çš„å€¼ï¼› â‘¢æŒ‡é’ˆä¼ é€’: åœ¨æŒ‡é’ˆæŒ‡å‘æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„å‰æä¸‹ï¼Œå½¢å‚åœ¨å‡½æ•°ä½“å†…å€¼å‘ç”Ÿå˜åŒ–ï¼Œä¼šå½±å“å®å‚çš„å€¼ï¼› ","date":"2023-07-11","objectID":"/posts/basics_one/:1:18","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.19 å†…è”å‡½æ•°å’Œå®å‡½æ•°çš„åŒºåˆ« å®å¸¸é‡\u0026å®å‡½æ•° å®šä¹‰: // a. å®šä¹‰ä¸€ä¸ªå®å¸¸é‡ #define MAX 1024 // å®å¸¸é‡ MAXç§°ä¸ºç¬¦å·å¸¸é‡ // b. å®šä¹‰ä¸€ä¸ªå®å‡½æ•° // å®å‡½æ•°:å®å‡½æ•°å°±æ˜¯ä½¿ç”¨å®å®šä¹‰å®šä¹‰å‡ºæ¥çš„å‡½æ•°,å¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„å‡½æ•°ã€‚ #define GETSUM(x, y) ((x) + (y)) // å®å‡½æ•° ä½¿ç”¨å®å‡½æ•°çš„æ³¨æ„äº‹é¡¹: 1.è¦ä¿è¯è¿ç®—çš„å®Œæ•´æ€§ï¼› 2.å®å‡½æ•°çš„ä½¿ç”¨åœºæ™¯:é¢‘ç¹è°ƒç”¨å’ŒçŸ­å°çš„å‡½æ•°,å°è£…æˆå®å‡½æ•°ï¼› 3.ä½¿ç”¨å®å‡½æ•°çš„ä¼˜ç‚¹:ä»¥ç©ºé—´æ¢æ—¶é—´ï¼› å®å®šä¹‰å’Œå‡½æ•°çš„åŒºåˆ«: 1.å®åœ¨ é¢„å¤„ç†é˜¶æ®µå®Œæˆæ›¿æ¢ï¼Œä¹‹åè¢«æ›¿æ¢çš„æ–‡æœ¬å‚ä¸ç¼–è¯‘ï¼Œç›¸å½“äº ç›´æ¥æ’å…¥ä»£ç ï¼Œè¿è¡Œæ—¶ä¸å­˜åœ¨å‡½æ•°è°ƒç”¨ï¼Œæ‰§è¡Œèµ·æ¥æ›´å¿«ï¼›å‡½æ•°è°ƒç”¨åœ¨è¿è¡Œæ—¶éœ€è¦è·³è½¬åˆ°å…·ä½“è°ƒç”¨å‡½æ•°; 2.å®å®šä¹‰å±äºåœ¨ç»“æ„ä¸­æ’å…¥ä»£ç ï¼Œæ²¡æœ‰è¿”å›å€¼; å‡½æ•°è°ƒç”¨å…·æœ‰è¿”å›å€¼; 3.å®å®šä¹‰å‚æ•°æ²¡æœ‰ç±»å‹ï¼Œä¸è¿›è¡Œç±»å‹æ£€æŸ¥ï¼›å‡½æ•°å‚æ•°å…·æœ‰ç±»å‹ï¼Œéœ€è¦æ£€æŸ¥ç±»å‹; 4.å®å®šä¹‰ä¸è¦åœ¨æœ€ååŠ åˆ†å·ï¼› å®å®šä¹‰å’Œtypedefçš„åŒºåˆ«: 1.å®ä¸»è¦ç”¨äº å®šä¹‰å¸¸é‡åŠä¹¦å†™å¤æ‚çš„å†…å®¹; typedefä¸»è¦ç”¨äº å®šä¹‰ç±»å‹åˆ«å; 2.å®æ›¿æ¢å‘ç”Ÿåœ¨é¢„ç¼–è¯‘é˜¶æ®µï¼Œå±äºæ–‡æœ¬æ’å…¥æ›¿æ¢ï¼›typedefæ˜¯ç¼–è¯‘çš„ä¸€éƒ¨åˆ†; 3.å®ä¸æ£€æŸ¥ç±»å‹ï¼›typedefä¼šæ£€æŸ¥æ•°æ®ç±»å‹; 4.å®ä¸æ˜¯è¯­å¥ï¼Œä¸éœ€è¦åœ¨æœ€ååŠ åˆ†å·; typedefæ˜¯è¯­å¥ï¼Œè¦åŠ åˆ†å·æ ‡è¯†ç»“æŸ; 5.æ³¨æ„å¯¹æŒ‡é’ˆçš„æ“ä½œï¼Œtypedef char * p_charå’Œ#define p_char char *åŒºåˆ«å·¨å¤§; å®å‡½æ•°å’Œå†…è”å‡½æ•°çš„åŒºåˆ«: 1.åœ¨ä½¿ç”¨æ—¶ï¼Œå®åªåšç®€å•å­—ç¬¦ä¸²æ›¿æ¢(ç¼–è¯‘å‰æˆ–è€…é¢„ç¼–è¯‘é˜¶æ®µ)ã€‚è€Œå†…è”å‡½æ•°å¯ä»¥è¿›è¡Œå‚æ•°ç±»å‹æ£€æŸ¥(ç¼–è¯‘æ—¶)ï¼Œä¸”å…·æœ‰è¿”å›å€¼ï¼› 2.å†…è”å‡½æ•°åœ¨ç¼–è¯‘æ—¶ç›´æ¥å°†å‡½æ•°ä»£ç åµŒå…¥åˆ°ç›®æ ‡ä»£ç ä¸­ï¼Œçœå»å‡½æ•°è°ƒç”¨çš„å¼€é”€æ¥æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œå¹¶ä¸”è¿›è¡Œå‚æ•°ç±»å‹æ£€æŸ¥ï¼Œå…·æœ‰è¿”å›å€¼ï¼Œå¯ä»¥å®ç°é‡è½½ï¼› 3.å®å®šä¹‰æ—¶è¦æ³¨æ„ä¹¦å†™(å‚æ•°è¦æ‹¬èµ·æ¥)å¦åˆ™å®¹æ˜“å‡ºç°æ­§ä¹‰(ä¿è¯è¿ç®—çš„å®Œæ•´æ€§)ï¼Œå†…è”å‡½æ•°ä¸ä¼šäº§ç”Ÿæ­§ä¹‰ï¼› 4.å†…è”å‡½æ•°æœ‰ç±»å‹æ£€æŸ¥ã€è¯­æ³•åˆ¤æ–­ç­‰åŠŸèƒ½ï¼Œè€Œå®æ²¡æœ‰ï¼› defineå®å®šä¹‰å’Œconstçš„åŒºåˆ«: å¤„ç†é˜¶æ®µ: defineæ˜¯åœ¨ç¼–è¯‘çš„é¢„å¤„ç†é˜¶æ®µèµ·ä½œç”¨ï¼Œè€Œconstæ˜¯åœ¨ç¼–è¯‘ã€è¿è¡Œçš„æ—¶å€™èµ·ä½œç”¨ï¼› å®‰å…¨æ€§ï¼š 1.defineåªåšæ›¿æ¢ï¼Œä¸åšç±»å‹æ£€æŸ¥å’Œè®¡ç®—ï¼Œä¹Ÿä¸æ±‚è§£ï¼Œå®¹æ˜“äº§ç”Ÿé”™è¯¯ï¼Œä¸€èˆ¬æœ€å¥½åŠ ä¸Šä¸€ä¸ªå¤§æ‹¬å·åŒ…å«ä½å…¨éƒ¨çš„å†…å®¹ï¼Œè¦ä¸ç„¶å¾ˆå®¹æ˜“å‡ºé”™; 2.constå¸¸é‡æœ‰æ•°æ®ç±»å‹ï¼Œç¼–è¯‘å™¨å¯ä»¥å¯¹å…¶è¿›è¡Œç±»å‹å®‰å…¨æ£€æŸ¥; å†…å­˜å ç”¨ï¼š 1.defineåªæ˜¯å°†å®åç§°è¿›è¡Œæ›¿æ¢ï¼Œåœ¨å†…å­˜ä¸­ä¼šäº§ç”Ÿå¤šä»½ç›¸åŒçš„å¤‡ä»½ã€‚conståœ¨ç¨‹åºè¿è¡Œä¸­åªæœ‰ä¸€ä»½å¤‡ä»½ï¼Œä¸”å¯ä»¥æ‰§è¡Œå¸¸é‡æŠ˜å ï¼Œèƒ½å°†å¤æ‚çš„çš„è¡¨è¾¾å¼è®¡ç®—å‡ºç»“æœæ”¾å…¥å¸¸é‡è¡¨; 2.å®å®šä¹‰çš„æ•°æ®æ²¡æœ‰åˆ†é…å†…å­˜ç©ºé—´ï¼Œåªæ˜¯æ’å…¥æ›¿æ¢æ‰ï¼›constå®šä¹‰çš„å˜é‡åªæ˜¯å€¼ä¸èƒ½æ”¹å˜ï¼Œä½†è¦åˆ†é…å†…å­˜ç©ºé—´; ","date":"2023-07-11","objectID":"/posts/basics_one/:1:19","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"1.20Â å››ç§castç±»å‹è½¬æ¢ castç±»å‹è½¬æ¢çš„ä½œç”¨ ä½œç”¨ï¼šå…‹æœcè¯­è¨€ä¸­å¼ºåˆ¶ç±»å‹è½¬åŒ–å¸¦æ¥çš„é£é™©ï¼ŒC++å¼•å…¥äº†å››ç§æ›´åŠ å®‰å…¨çš„å¼ºåˆ¶ç±»å‹è½¬æ¢è¿ç®—ç¬¦(æ˜ç¡®è½¬æ¢çš„ç›®çš„ï¼Œä¾¿äºç¨‹åºçš„ç»´æŠ¤å’Œåˆ†æ) const_cast: å»é™¤å˜é‡çš„constå±æ€§ // 1.å»é™¤constå±æ€§ï¼Œå°†åªè¯»å˜ä¸ºåªè¯»å†™ // 2.é’ˆå¯¹å¸¸é‡æŒ‡é’ˆã€å¸¸é‡å¼•ç”¨å’Œå¸¸é‡å¯¹è±¡ const char *p; char *p1 = const_cast\u003cchar*\u003e(p); static_cast: å†…ç½®æ•°æ®ç±»å‹ä¹‹é—´ã€åŸºç±»-æ´¾ç”Ÿç±»ä¹‹é—´çš„è½¬æ¢ å†…ç½®æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼Œintè½¬doubleï¼Œcharè½¬int åŸºç±»æŒ‡é’ˆä¸æ´¾ç”Ÿç±»æŒ‡é’ˆä¹‹é—´çš„è½¬æ¢ï¼Œåªèƒ½è½¬æ¢æœ‰ç»§æ‰¿æˆ–æ´¾ç”Ÿå…³ç³»çš„ç±»ã€‚ç”¨äºç±»å±‚æ¬¡ç»“æ„ä¹‹é—´åŸºç±»å’Œæ´¾ç”Ÿç±»æŒ‡é’ˆå’Œå¼•ç”¨ä¹‹é—´çš„è½¬æ¢ï¼Œè¿›è¡Œå‘ä¸Šè½¬å‹æ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯è¿›è¡Œå‘ä¸‹è½¬å‹æ˜¯ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯æ˜¯å¯ä»¥è½¬æ¢çš„; å‘ä¸Šè½¬å‹(æ´¾ç”Ÿç±»å‘åŸºç±»è½¬æ¢ -\u003e å®‰å…¨)ï¼šæˆ‘ä»¬çŸ¥é“åŸºç±»çš„å¼•ç”¨å’ŒæŒ‡é’ˆéƒ½å¯ä»¥æŒ‡å‘æ´¾ç”Ÿç±»çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå°†æ´¾ç”Ÿç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨å¼ºè½¬ä¸ºåŸºç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯å‘ä¸Šè½¬å‹ï¼Œä¹Ÿå°±æ˜¯å‘çˆ¶ç±»è½¬; å‘ä¸‹è½¬å‹(åŸºç±»å‘æ´¾ç”Ÿç±»è½¬æ¢ -\u003e ä¸å®‰å…¨)ï¼šå‘ä¸‹è½¬å‹å°±å’Œå‘ä¸Šè½¬å‹ç›¸åï¼Œå®ƒæ˜¯å°†çˆ¶ç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼Œå¼ºåˆ¶è½¬æ¢ä¸ºå­ç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ æŠŠvoidç±»å‹æŒ‡é’ˆè½¬æ¢ä¸ºç›®æ ‡ç±»å‹çš„æŒ‡é’ˆ ä»»ä½•ç±»å‹çš„è¡¨è¾¾å¼è½¬åŒ–ä¸ºvoidç±»å‹ // æ•´å½¢è½¬æµ®ç‚¹å‹ int a = 10; double b = static_cast\u003cdouble\u003e(a); //åŸºç±»æŒ‡é’ˆè½¬æ´¾ç”Ÿç±» class A{}; class B : public A{}; A *pA = new A; B *pB = static_cast\u003cB*\u003e(pA); // å‘ä¸‹è½¬æ¢ä¸å®‰å…¨ reinterpret_cast: å¯ä»¥å°†ä¸€ä¸ªç±»å‹çš„æŒ‡é’ˆè½¬æ¢ä¸ºå…¶å®ƒä»»æ„ç±»å‹çš„æŒ‡é’ˆï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨æŒ‡é’ˆå’Œæ•´å½¢æ•°æ®ä¹‹é—´çš„è½¬æ¢ã€‚å®ƒæ˜¯å¾ˆå±é™©çš„ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨å®ƒçš„å……åˆ†ç†ç”±ï¼Œé‚£ä¹ˆå°±ä¸è¦ä½¿ç”¨å®ƒ ä¸ºè¿ç®—å¯¹è±¡çš„ä½æ¨¡å¼æä¾›è¾ƒä½å±‚æ¬¡ä¸Šçš„é‡æ–°è§£é‡Š ç”¨äºåº•å±‚çš„å¼ºåˆ¶è½¬æ¢ï¼Œä¾èµ–äºæœºå™¨ï¼Œä¸€èˆ¬ä½¿ç”¨è¾ƒå°‘ dynamic_cast: è¿è¡Œæ—¶å¤„ç†; åŸºç±»å‘æ´¾ç”Ÿç±»è½¬æ¢æ—¶æ¯”static_castæ›´å®‰å…¨ dynamic_castæ˜¯è¿è¡Œæ—¶å¤„ç†çš„ï¼Œè¿è¡Œæ—¶è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå…¶ä»–ä¸‰ç§æ˜¯ç¼–è¯‘æ—¶å¤„ç†çš„ ä¸èƒ½ç”¨äºå†…ç½®æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢ dynamic_caståœ¨è¿›è¡Œå‘ä¸Šè½¬æ¢æ—¶å’Œstatic_castæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯è¿›è¡Œå‘ä¸‹è½¬æ¢æ—¶ä¼šè¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œæ¯”static_castæ›´åŠ å®‰å…¨ï¼Œä¸‹è¡Œè½¬æ¢æ˜¯å¦æˆåŠŸå–å†³äºè½¬æ¢å¯¹è±¡çš„å®é™…ç±»å‹ä¸ç›®æ ‡ç±»å‹æ˜¯å¦ç›¸åŒ è¦æ±‚åŸºç±»å¿…é¡»å…·æœ‰è™šå‡½æ•°ï¼Œå¦åˆ™ç¼–è¯‘ä¸é€šè¿‡ è‹¥è½¬æ¢æˆåŠŸï¼Œè¿”å›çš„æ˜¯æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œä¸æˆåŠŸè¿”å›NULL ","date":"2023-07-11","objectID":"/posts/basics_one/:1:20","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2. åŸºç¡€çŸ¥è¯†(äºŒ) ","date":"2023-07-11","objectID":"/posts/basics_one/:2:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.1 å†™å‡º int ã€boolã€ float ã€æŒ‡é’ˆå˜é‡ä¸ â€œé›¶å€¼â€æ¯”è¾ƒçš„if è¯­å¥ //intä¸é›¶å€¼æ¯”è¾ƒ if ( n == 0 ) if ( n != 0 ) //boolä¸é›¶å€¼æ¯”è¾ƒ if (flag) // è¡¨ç¤ºflagä¸ºçœŸ if (!flag) // è¡¨ç¤ºflagä¸ºå‡ //floatä¸é›¶å€¼æ¯”è¾ƒ const float EPSINON = 0.00001; if ((x \u003e= - EPSINON) \u0026\u0026 (x \u003c= EPSINON) //å…¶ä¸­EPSINONæ˜¯å…è®¸çš„è¯¯å·®(å³ç²¾åº¦)ã€‚ //æŒ‡é’ˆå˜é‡ä¸é›¶å€¼æ¯”è¾ƒ if (p == nullptr) if (p != nullptr) ","date":"2023-07-11","objectID":"/posts/basics_one/:2:1","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.2 å˜é‡çš„å£°æ˜å’Œå®šä¹‰æœ‰ä»€ä¹ˆåŒºåˆ« â‘  å˜é‡çš„å®šä¹‰ä¸ºå˜é‡åˆ†é…åœ°å€å’Œå­˜å‚¨ç©ºé—´ï¼Œ å˜é‡çš„å£°æ˜ä¸åˆ†é…åœ°å€ã€‚ â‘¡ ä¸€ä¸ªå˜é‡å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹å£°æ˜ï¼Œ ä½†æ˜¯åªåœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰ã€‚å£°æ˜å¤šæ¬¡ï¼Œå®šä¹‰ä¸€æ¬¡ã€‚ â‘¢ åŠ å…¥extern ä¿®é¥°çš„æ˜¯å˜é‡çš„å£°æ˜ï¼Œè¯´æ˜æ­¤å˜é‡å°†åœ¨æ–‡ä»¶å¤–éƒ¨æˆ–åœ¨æ–‡ä»¶åé¢éƒ¨åˆ†å®šä¹‰ã€‚ â‘£ è¯´æ˜ï¼šå¾ˆå¤šæ—¶å€™ä¸€ä¸ªå˜é‡ï¼Œåªæ˜¯å£°æ˜ï¼Œä¸åˆ†é…å†…å­˜ç©ºé—´ï¼Œç›´åˆ°å…·ä½“ä½¿ç”¨æ—¶æ‰åˆå§‹åŒ–ï¼Œåˆ†é…å†…å­˜ç©ºé—´ï¼Œ å¦‚å¤–éƒ¨å˜é‡ã€‚ int main() { extern int A; //è¿™æ˜¯ä¸ªå£°æ˜è€Œä¸æ˜¯å®šä¹‰ï¼Œå£°æ˜Aæ˜¯ä¸€ä¸ªå·²ç»å®šä¹‰äº†çš„å¤–éƒ¨å˜é‡ //æ³¨æ„ï¼šå£°æ˜å¤–éƒ¨å˜é‡æ—¶å¯ä»¥æŠŠå˜é‡ç±»å‹å»æ‰å¦‚ï¼šextern A; dosth(); //æ‰§è¡Œå‡½æ•° } int A; //æ˜¯å®šä¹‰ï¼Œå®šä¹‰äº†Aä¸ºæ•´å‹çš„å¤–éƒ¨å˜é‡ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:2","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.3 ç®€è¿° #ifdefã€#elseã€#endifå’Œ#ifndefçš„ä½œç”¨ åˆ©ç”¨ #ifdefã€#endif å°†æŸç¨‹åºåŠŸèƒ½æ¨¡å—åŒ…æ‹¬è¿›å»ï¼Œä»¥å‘ç‰¹å®šç”¨æˆ·æä¾›è¯¥åŠŸèƒ½ã€‚åœ¨ä¸éœ€è¦æ—¶, ç”¨æˆ·å¯è½»æ˜“å°†å…¶å±è”½ã€‚ #ifdef MATH #include â€œmath.câ€ #endif //åœ¨å­ç¨‹åºå‰åŠ ä¸Šæ ‡è®°ï¼Œä»¥ä¾¿äºè¿½è¸ªå’Œè°ƒè¯•ã€‚ #ifdef DEBUG printf (â€œIndebuggingâ€¦!â€); #endif åº”å¯¹ç¡¬ä»¶çš„é™åˆ¶ã€‚ç”±äºä¸€äº›å…·ä½“åº”ç”¨ç¯å¢ƒçš„ç¡¬ä»¶ä¸ä¸€æ ·ï¼Œé™äºæ¡ä»¶ï¼Œæœ¬åœ°ç¼ºä¹è¿™ç§è®¾å¤‡ï¼Œåªèƒ½ç»•è¿‡ç¡¬ä»¶ï¼Œç›´æ¥å†™å‡ºé¢„æœŸç»“æœã€‚ æ³¨æ„ï¼šè™½ç„¶ä¸ç”¨æ¡ä»¶ç¼–è¯‘å‘½ä»¤è€Œç›´æ¥ç”¨ifè¯­å¥ä¹Ÿèƒ½è¾¾åˆ°è¦æ±‚ï¼Œä½†é‚£æ ·åšç›®æ ‡ç¨‹åºé•¿(å› ä¸ºæ‰€æœ‰è¯­å¥éƒ½ç¼–è¯‘)ï¼Œè¿è¡Œæ—¶é—´é•¿(å› ä¸ºåœ¨ç¨‹åºè¿è¡Œæ—¶é—´å¯¹ifè¯­å¥è¿›è¡Œæµ‹è¯•)ã€‚è€Œé‡‡ç”¨æ¡ä»¶ç¼–è¯‘ï¼Œå¯ä»¥å‡å°‘è¢«ç¼–è¯‘çš„è¯­å¥ï¼Œä»è€Œå‡å°‘ç›®æ ‡ç¨‹åºçš„é•¿åº¦ï¼Œå‡å°‘è¿è¡Œæ—¶é—´ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:3","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.4 ç»“æ„ä½“å¯ä»¥ç›´æ¥èµ‹å€¼å—? â‘ ç»“æ„ä½“å£°æ˜æ—¶å¯ä»¥ç›´æ¥åˆå§‹åŒ–ï¼ŒåŒä¸€ç»“æ„ä½“çš„ä¸åŒå¯¹è±¡ä¹‹é—´ä¹Ÿå¯ä»¥ç›´æ¥èµ‹å€¼ï¼Œä½†æ˜¯å½“ç»“æ„ä½“ä¸­å«æœ‰æŒ‡é’ˆâ€œæˆå‘˜â€æ—¶ä¸€å®šè¦å°å¿ƒã€‚ â‘¡æ³¨æ„ï¼šå½“æœ‰å¤šä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€æ®µå†…å­˜æ—¶ï¼ŒæŸä¸ªæŒ‡é’ˆé‡Šæ”¾è¿™æ®µå†…å­˜å¯èƒ½ä¼šå¯¼è‡´å…¶ä»–æŒ‡é’ˆçš„éæ³•æ“ä½œã€‚å› æ­¤ï¼Œåœ¨é‡Šæ”¾å‰ä¸€å®šè¦ç¡®ä¿å…¶ä»–æŒ‡é’ˆä¸å†ä½¿ç”¨è¿™æ®µå†…å­˜ç©ºé—´ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:4","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.5 sizeof å’Œstrlen çš„åŒºåˆ« â‘ sizeofæ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œstrlenæ˜¯åº“å‡½æ•°ã€‚ â‘¡sizeofçš„å‚æ•°å¯ä»¥æ˜¯æ•°æ®çš„ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å˜é‡ï¼Œè€Œstrlenåªèƒ½ä»¥ç»“å°¾ä¸ºâ€™\\0â€™çš„å­—ç¬¦ä¸²ä½œå‚æ•°ã€‚ â‘¢ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å°±è®¡ç®—å‡ºäº†sizeofçš„ç»“æœï¼Œè€Œstrlenå‡½æ•°å¿…é¡»åœ¨è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºæ¥ã€‚å¹¶ä¸”sizeofè®¡ç®—çš„æ˜¯æ•°æ®ç±»å‹å å†…å­˜çš„å¤§å°ï¼Œè€Œstrlenè®¡ç®—çš„æ˜¯å­—ç¬¦ä¸²å®é™…çš„é•¿åº¦ã€‚ â‘£æ•°ç»„(array)åšsizeofçš„å‚æ•°ä¸é€€åŒ–ï¼Œä¼ é€’ç»™strlenå°±é€€åŒ–ä¸ºæŒ‡é’ˆäº† ","date":"2023-07-11","objectID":"/posts/basics_one/:2:5","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.6 sizeofæ±‚ç±»å‹å¤§å° ref: https://www.cnblogs.com/maji233/p/11439880.html â‘ ç±»çš„å¤§å°ä¸ºç±»çš„éé™æ€æˆå‘˜æ•°æ®çš„ç±»å‹å¤§å°ä¹‹å’Œï¼Œä¹Ÿå°±æ˜¯è¯´é™æ€æˆå‘˜æ•°æ®ä¸ä½œè€ƒè™‘ã€‚ æ™®é€šæˆå‘˜å‡½æ•°ä¸sizeofæ— å…³ã€‚ â‘¡è™šå‡½æ•°ç”±äºè¦ç»´æŠ¤è™šå‡½æ•°è¡¨ï¼Œæ‰€ä»¥è¦å æ®ä¸€ä¸ªæŒ‡é’ˆå¤§å°ï¼Œä¹Ÿå°±æ˜¯4å­—èŠ‚ã€‚ ç±»çš„æ€»å¤§å°ä¹Ÿéµå®ˆç±»ä¼¼classå­—èŠ‚å¯¹é½çš„ï¼Œè°ƒæ•´è§„åˆ™ã€‚ ref: =\u003e(32 ä½) æŒ‡é’ˆéƒ½æ˜¯ 4ä¸ªå­—èŠ‚ char 1ä¸ªå­—èŠ‚ short 2ä¸ªå­—èŠ‚ int 4ä¸ªå­—èŠ‚ long 4ä¸ªå­—èŠ‚ long int 4ä¸ªå­—èŠ‚ float 4ä¸ªå­—èŠ‚ double 8ä¸ªå­—èŠ‚ long double 8ä¸ªå­—èŠ‚ =\u003e(64 ä½) æŒ‡é’ˆéƒ½æ˜¯ä¸€ä¸ªå­—é•¿, 8ä¸ªå­—èŠ‚ char 1ä¸ªå­—èŠ‚ short 2ä¸ªå­—èŠ‚ int 4ä¸ªå­—èŠ‚ long 8ä¸ªå­—èŠ‚ long int 8ä¸ªå­—èŠ‚ double 8ä¸ªå­—èŠ‚ long double ä¹Ÿå¯ä»¥å˜é•¿äº†, 16ä¸ªå­—èŠ‚ ä¾‹å¦‚æœ‰å¦‚ä¸‹ç»“æ„ä½“ï¼š struct Stu //è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œå…è®¸ç”¨æˆ·å­˜å‚¨ä¸åŒçš„æ•°æ®ç±»å‹ { int id; // 4ä¸ªå­—èŠ‚ char sex; // 1ä¸ªå­—èŠ‚ float hight; // 4ä¸ªå­—èŠ‚ }; é‚£ä¹ˆä¸€ä¸ªè¿™æ ·çš„ç»“æ„ä½“å˜é‡å å¤šå¤§å†…å­˜å‘¢ï¼Ÿä¹Ÿå°±æ˜¯ cout\u003c\u003csizeof(Stu)\u003c\u003cendl; ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ åœ¨äº†è§£å­—èŠ‚å¯¹é½æ–¹å¼ä¹‹å‰æƒ³å½“ç„¶çš„ä¼šä»¥ä¸ºï¼šsizeof(Stu) = sizeof(int)+sizeof(char)+sizeof(float) = 9. ç„¶è€Œäº‹å®å¹¶éå¦‚æ­¤ï¼ å­—èŠ‚å¯¹é½åŸåˆ™ åœ¨ç³»ç»Ÿé»˜è®¤çš„å¯¹é½æ–¹å¼ä¸‹: æ¯ä¸ªæˆå‘˜ç›¸å¯¹äºè¿™ä¸ªç»“æ„ä½“å˜é‡åœ°å€çš„åç§»é‡æ­£å¥½æ˜¯è¯¥æˆå‘˜ç±»å‹æ‰€å å­—èŠ‚çš„æ•´æ•°å€ï¼Œä¸”æœ€ç»ˆå ç”¨å­—èŠ‚æ•°ä¸ºæˆå‘˜ç±»å‹ä¸­æœ€å¤§å ç”¨å­—èŠ‚æ•°çš„æ•´æ•°å€ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œint idçš„åç§»é‡ä¸º0(0=4x0)ï¼Œchar sexçš„åç§»é‡ä¸º4(4=1x4)ï¼Œfloat heightçš„åç§»é‡ä¸º8(8=2x4)ï¼Œæ­¤æ—¶å ç”¨12å­—èŠ‚ï¼Œä¹ŸåŒæ—¶æ»¡è¶³12=3x4.æ‰€ä»¥sizeof(Stu)=12. æ€»ç»“ï¼š â‘ æœ€ç»ˆå¤§å°ä¸€å®šæ˜¯æœ€å¤§æ•°æ®ç±»å‹çš„æ•´æ•°å€; â‘¡é™æ€å˜é‡ä¸å ç©ºé—´; â‘¢æ¯ç§ç±»å‹çš„åç§»é‡ä¸ºè‡ªèº«çš„nå€; è¯¦ç»†è¯·æŸ¥é˜…ï¼šstruct/classç­‰å†…å­˜å­—èŠ‚å¯¹é½é—®é¢˜è¯¦è§£ ref: structåœ°å€åç§»é‡è®¡ç®— ","date":"2023-07-11","objectID":"/posts/basics_one/:2:6","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.7 Cè¯­è¨€çš„å…³é”®å­—staticå’ŒC++çš„å…³é”®å­—staticæœ‰ä»€ä¹ˆåŒºåˆ« â‘ åœ¨ Cè¯­è¨€ ä¸­ï¼Œstatic ç”¨æ¥ä¿®é¥°å±€éƒ¨é™æ€å˜é‡å’Œå¤–éƒ¨é™æ€å˜é‡ã€å‡½æ•°ã€‚è€Œ C++ä¸­é™¤äº†ä¸Šè¿°åŠŸèƒ½å¤–ï¼Œè¿˜ç”¨æ¥å®šä¹‰ç±»çš„æˆå‘˜å˜é‡å’Œå‡½æ•°ã€‚å³é™æ€æˆå‘˜å˜é‡å’Œé™æ€æˆå‘˜å‡½æ•°ã€‚ â‘¡æ³¨æ„ï¼šç¼–ç¨‹æ—¶ï¼Œstatic çš„è®°å¿†æ€§å’Œå…¨å±€æ€§çš„ç‰¹ç‚¹å¯ä»¥è®©åœ¨ä¸åŒæ—¶æœŸè°ƒç”¨çš„å‡½æ•°è¿›è¡Œé€šä¿¡ï¼Œä¼ é€’ä¿¡æ¯ï¼Œè€Œ C++çš„é™æ€æˆå‘˜åˆ™å¯ä»¥åœ¨å¤šä¸ªå¯¹è±¡å®ä¾‹é—´è¿›è¡Œé€šä¿¡ï¼Œä¼ é€’ä¿¡æ¯ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:7","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.8 ï¼£è¯­è¨€çš„mallocå’Œï¼£ï¼‹ï¼‹ä¸­çš„newæœ‰ä»€ä¹ˆåŒºåˆ« â‘ new ã€delete æ˜¯æ“ä½œç¬¦ï¼Œå¯ä»¥é‡è½½ï¼Œåªèƒ½åœ¨C++ ä¸­ä½¿ç”¨ã€‚ â‘¡mallocã€free æ˜¯å‡½æ•°ï¼Œå¯ä»¥è¦†ç›–ï¼ŒCã€C++ ä¸­éƒ½å¯ä»¥ä½¿ç”¨ã€‚ â‘¢new å¯ä»¥è°ƒç”¨å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œå¯¹åº”çš„delete è°ƒç”¨ç›¸åº”çš„ææ„å‡½æ•°ã€‚ â‘£malloc ä»…ä»…åˆ†é…å†…å­˜ï¼Œfree ä»…ä»…å›æ”¶å†…å­˜ï¼Œå¹¶ä¸æ‰§è¡Œæ„é€ å’Œææ„å‡½æ•°ã€‚ â‘¤new ã€delete è¿”å›çš„æ˜¯æŸç§æ•°æ®ç±»å‹æŒ‡é’ˆï¼Œmallocã€free è¿”å›çš„æ˜¯**voidæŒ‡é’ˆ**ã€‚ æ³¨æ„ï¼šmallocç”³è¯·çš„å†…å­˜ç©ºé—´è¦ç”¨freeé‡Šæ”¾ï¼Œè€Œnewç”³è¯·çš„å†…å­˜ç©ºé—´è¦ç”¨deleteé‡Šæ”¾ï¼Œä¸è¦æ··ç”¨ã€‚ ref: 2.11 new å’Œ mallocçš„åŒºåˆ« ","date":"2023-07-11","objectID":"/posts/basics_one/:2:8","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.9 å†™ä¸€ä¸ª â€œæ ‡å‡†â€ å®MIN #define min(a,b) ((a)\u003c=(b)?(a):(b)) ","date":"2023-07-11","objectID":"/posts/basics_one/:2:9","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.10 ++iå’Œi++çš„åŒºåˆ« ++iå…ˆè‡ªå¢1ï¼Œå†è¿”å›ï¼›i++å…ˆè¿”å›i,å†è‡ªå¢1 å‰ç½®ç‰ˆæœ¬å°†å¯¹è±¡æœ¬èº«ä½œä¸ºå·¦å€¼è¿”å›ï¼Œåç½®ç‰ˆæœ¬å°†å¯¹è±¡åŸå§‹å€¼çš„å‰¯æœ¬ä½œä¸ºå³å€¼è¿”å›ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:10","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.11 newå’Œmallocçš„åŒºåˆ«ï¼Œå„è‡ªåº•å±‚å®ç°åŸç†(deleteå’Œfreeç±»ä¼¼) â‘ new(delete)æ˜¯æ“ä½œç¬¦ï¼Œè€Œmalloc(free)æ˜¯å‡½æ•°ã€‚ â‘¡newåœ¨è°ƒç”¨çš„æ—¶å€™å…ˆåˆ†é…å†…å­˜ï¼Œå†è°ƒç”¨æ„é€ å‡½æ•°ï¼Œé‡Šæ”¾çš„æ—¶å€™è°ƒç”¨ææ„å‡½æ•°ï¼›è€Œmallocæ²¡æœ‰è°ƒç”¨æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ã€‚ â‘¢mallocéœ€è¦ç»™å®šç”³è¯·å†…å­˜çš„å¤§å°ï¼Œè¿”å›çš„æŒ‡é’ˆéœ€è¦å¼ºè½¬(è¿”å›voidæŒ‡é’ˆ)ï¼›newä¼šè°ƒç”¨æ„é€ å‡½æ•°ï¼Œä¸ç”¨æŒ‡å®šå†…å­˜çš„å¤§å°ï¼Œè¿”å›æŒ‡é’ˆä¸éœ€è¦å¼ºè½¬ã€‚ â‘£newæ˜¯æ“ä½œç¬¦ï¼Œå¯ä»¥è¢«é‡è½½; mallocä¸è¡Œ â‘¤newåˆ†é…å†…å­˜, æ›´ç›´æ¥å’Œå®‰å…¨ã€‚ â‘¥newå‘ç”Ÿé”™è¯¯æŠ›å‡ºå¼‚å¸¸ï¼Œmallocè¿”å›null ","date":"2023-07-11","objectID":"/posts/basics_one/:2:11","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.12 const å’Œ define çš„åŒºåˆ« åŒºåˆ« (1)å°±èµ·ä½œç”¨çš„é˜¶æ®µè€Œè¨€ï¼š#defineæ˜¯åœ¨ç¼–è¯‘çš„é¢„å¤„ç†é˜¶æ®µèµ·ä½œç”¨ï¼Œè€Œconstæ˜¯åœ¨ ç¼–è¯‘ã€è¿è¡Œçš„æ—¶å€™èµ·ä½œç”¨ã€‚ (2)å°±èµ·ä½œç”¨çš„æ–¹å¼è€Œè¨€ï¼š#defineåªæ˜¯ç®€å•çš„å­—ç¬¦ä¸²æ›¿æ¢ï¼Œæ²¡æœ‰ç±»å‹æ£€æŸ¥ã€‚è€Œconstæœ‰å¯¹åº”çš„æ•°æ®ç±»å‹ï¼Œæ˜¯è¦è¿›è¡Œåˆ¤æ–­çš„ï¼Œå¯ä»¥é¿å…ä¸€äº›ä½çº§çš„é”™è¯¯ã€‚ (3)å°±å­˜å‚¨æ–¹å¼è€Œè¨€ï¼š#defineåªæ˜¯è¿›è¡Œå±•å¼€ï¼Œæœ‰å¤šå°‘åœ°æ–¹ä½¿ç”¨ï¼Œå°±æ›¿æ¢å¤šå°‘æ¬¡ï¼Œå®ƒå®šä¹‰çš„å®å¸¸é‡åœ¨å†…å­˜ä¸­æœ‰è‹¥å¹²ä¸ªå¤‡ä»½;constå®šä¹‰çš„åªè¯»å˜é‡åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åªæœ‰ä¸€ä»½å¤‡ä»½ã€‚ (4)ä»ä»£ç è°ƒè¯•çš„æ–¹ä¾¿ç¨‹åº¦è€Œè¨€ï¼š constå¸¸é‡å¯ä»¥è¿›è¡Œè°ƒè¯•çš„ï¼Œdefineæ˜¯ä¸èƒ½è¿›è¡Œè°ƒè¯•çš„ï¼Œå› ä¸ºåœ¨é¢„ç¼–è¯‘é˜¶æ®µå°±å·²ç»æ›¿æ¢æ‰äº†ã€‚ constä¼˜ç‚¹ï¼š (1)constå¸¸é‡æœ‰æ•°æ®ç±»å‹ï¼Œè€Œå®å¸¸é‡æ²¡æœ‰æ•°æ®ç±»å‹ã€‚ç¼–è¯‘å™¨å¯ä»¥å¯¹å‰è€…è¿›è¡Œç±»å‹å®‰å…¨æ£€æŸ¥ã€‚è€Œå¯¹åè€…åªè¿›è¡Œå­—ç¬¦æ›¿æ¢ï¼Œæ²¡æœ‰ç±»å‹å®‰å…¨æ£€æŸ¥ï¼Œå¹¶ä¸”åœ¨å­—ç¬¦æ›¿æ¢å¯èƒ½ä¼šäº§ç”Ÿæ„æ–™ä¸åˆ°çš„é”™è¯¯ã€‚ (2)æœ‰äº›é›†æˆåŒ–çš„è°ƒè¯•å·¥å…·å¯ä»¥å¯¹constå¸¸é‡è¿›è¡Œè°ƒè¯•ï¼Œä½†æ˜¯ä¸èƒ½å¯¹å®å¸¸é‡è¿›è¡Œè°ƒè¯•ã€‚ (3)constå¯èŠ‚çœç©ºé—´ï¼Œé¿å…ä¸å¿…è¦çš„å†…å­˜åˆ†é…ï¼Œæé«˜æ•ˆç‡ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:12","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.13Â C++ä¸­å‡½æ•°æŒ‡é’ˆå’ŒæŒ‡é’ˆå‡½æ•°çš„åŒºåˆ« å®šä¹‰ä¸åŒ æŒ‡é’ˆå‡½æ•°: æœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…¶è¿”å›å€¼ä¸ºæŒ‡é’ˆã€‚ å‡½æ•°æŒ‡é’ˆ: æœ¬è´¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå…¶æŒ‡å‘ä¸€ä¸ªå‡½æ•°ã€‚ å†™æ³•ä¸åŒ æŒ‡é’ˆå‡½æ•°ï¼šint *fun(int x, int y); å‡½æ•°æŒ‡é’ˆï¼šint (*fun)(int x, int y); ç”¨æ³•ä¸åŒ //æŒ‡é’ˆå‡½æ•°ç¤ºä¾‹ typedef struct _Data{ int a; int b; }Data; //æŒ‡é’ˆå‡½æ•° Data* f(int a,int b){ Data * data = new Data; //... return data; } int main(){ //è°ƒç”¨æŒ‡é’ˆå‡½æ•° Data * myData = f(4,5); //Data * myData = static_cast\u003cData*\u003e(f(4,5)); //... } //å‡½æ•°æŒ‡é’ˆç¤ºä¾‹ int add(int x,int y){ return x+y; } //å‡½æ•°æŒ‡é’ˆ int (*fun)(int x,int y); //èµ‹å€¼, å‡½æ•°æŒ‡é’ˆæŒ‡å‘å‡½æ•°add fun = add; //è°ƒç”¨ cout \u003c\u003c \"(*fun)(1,2) = \" \u003c\u003c (*fun)(1,2) ; //è¾“å‡ºç»“æœ //(*fun)(1,2) = 3 ","date":"2023-07-11","objectID":"/posts/basics_one/:2:13","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.14Â ä½¿ç”¨æŒ‡é’ˆéœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ â‘ å®šä¹‰æŒ‡é’ˆæ—¶ï¼Œå…ˆåˆå§‹åŒ–ä¸ºNULLç©ºæŒ‡é’ˆã€‚ â‘¡ç”¨mallocæˆ–newç”³è¯·å†…å­˜ä¹‹åï¼Œåº”è¯¥ç«‹å³æ£€æŸ¥æŒ‡é’ˆå€¼æ˜¯å¦ä¸ºNULLã€‚é˜²æ­¢ä½¿ç”¨æŒ‡é’ˆå€¼ä¸ºNULLçš„å†…å­˜ã€‚ â‘¢ä¸è¦å¿˜è®°ä¸ºæ•°ç»„å’ŒåŠ¨æ€å†…å­˜èµ‹åˆå€¼ã€‚é˜²æ­¢å°†æœªè¢«åˆå§‹åŒ–çš„å†…å­˜ä½œä¸ºå³å€¼ä½¿ç”¨ã€‚ â‘£é¿å…æ•°å­—æˆ–æŒ‡é’ˆçš„ä¸‹æ ‡è¶Šç•Œï¼Œç‰¹åˆ«è¦å½“å¿ƒå‘ç”Ÿâ€œå¤š1â€æˆ–è€…â€œå°‘1â€æ“ä½œã€‚ â‘¤åŠ¨æ€å†…å­˜çš„ç”³è¯·ä¸é‡Šæ”¾å¿…é¡»é…å¯¹ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ â‘¥ç”¨freeæˆ–deleteé‡Šæ”¾äº†å†…å­˜ä¹‹åï¼Œç«‹å³å°†æŒ‡é’ˆè®¾ç½®ä¸ºNULLï¼Œé˜²æ­¢â€œé‡æŒ‡é’ˆâ€ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:14","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.15Â volatileæœ‰ä»€ä¹ˆä½œç”¨ â‘ volatileä¸ºçŠ¶æ€å¯„å­˜å™¨ä¸€ç±»çš„å¹¶è¡Œè®¾å¤‡ç¡¬ä»¶å¯„å­˜å™¨ã€‚ â‘¡ä¸€ä¸ªä¸­æ–­æœåŠ¡å­ç¨‹åºä¼šè®¿é—®åˆ°çš„éè‡ªåŠ¨å˜é‡ã€‚ â‘¢å¤šçº¿ç¨‹é—´è¢«å‡ ä¸ªä»»åŠ¡å…±äº«çš„å˜é‡ã€‚ æ³¨æ„: è™½ç„¶volatileåœ¨åµŒå…¥å¼æ–¹é¢åº”ç”¨æ¯”è¾ƒå¤šï¼Œä½†æ˜¯åœ¨PCè½¯ä»¶çš„å¤šçº¿ç¨‹ä¸­ï¼Œvolatileä¿®é¥°çš„ä¸´ç•Œå˜é‡ä¹Ÿæ˜¯éå¸¸å®ç”¨çš„ã€‚ C++ä¸­volatileçš„ä½œç”¨: æ€»ç»“: å»ºè®®ç¼–è¯‘å™¨ä¸è¦å¯¹è¯¥å˜é‡è¿›è¡Œä¼˜åŒ–ï¼Œæ¯æ¬¡éƒ½ä»å†…å­˜ä¸­è¯»å–è¯¥å˜é‡ï¼Œè€Œä¸æ˜¯ä»ç¼“å­˜(å¯„å­˜å™¨)ä¸­è¯»å–å˜é‡ã€‚ volatileæ˜¯â€œæ˜“å˜/ä¸ç¨³å®šâ€çš„æ„æ€ã€‚volatileæ˜¯Cçš„ä¸€ä¸ªè¾ƒä¸ºå°‘ç”¨çš„å…³é”®å­—ï¼Œè§£å†³å˜é‡åœ¨â€œå…±äº«â€ç¯å¢ƒä¸‹å®¹æ˜“å‡ºç°è¯»å–é”™è¯¯çš„é—®é¢˜ã€‚ å®šä¹‰ä¸ºvolatileçš„å˜é‡æ˜¯è¯´è¿™å˜é‡å¯èƒ½ä¼šè¢«æ„æƒ³ä¸åˆ°åœ°æ”¹å˜ï¼Œå³åœ¨ä½ ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸€ç›´ä¼šå˜ï¼Œä½ å¸Œæœ›è¿™ä¸ªå€¼è¢«æ­£ç¡®åœ°å¤„ç†ï¼Œæ¯æ¬¡ä»å†…å­˜ä¸­å»è¯»è¿™ä¸ªå€¼ï¼Œè€Œä¸æ˜¯å› ç¼–è¯‘å™¨ä¼˜åŒ–ä»ç¼“å­˜çš„åœ°æ–¹è¯»å–ï¼Œæ¯”å¦‚è¯»å–ç¼“å­˜åœ¨å¯„å­˜å™¨ä¸­çš„æ•°å€¼ï¼Œä»è€Œä¿è¯volatileå˜é‡è¢«æ­£ç¡®çš„è¯»å–ã€‚ åœ¨å•ä»»åŠ¡çš„ç¯å¢ƒä¸­ï¼Œä¸€ä¸ªå‡½æ•°ä½“å†…éƒ¨ï¼Œå¦‚æœåœ¨ä¸¤æ¬¡è¯»å–å˜é‡çš„å€¼ä¹‹é—´çš„è¯­å¥æ²¡æœ‰å¯¹å˜é‡çš„å€¼è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±ä¼šè®¾æ³•å¯¹å¯æ‰§è¡Œä»£ç è¿›è¡Œä¼˜åŒ–ã€‚ç”±äºè®¿é—®å¯„å­˜å™¨çš„é€Ÿåº¦è¦å¿«è¿‡RAM(ä»RAMä¸­è¯»å–å˜é‡çš„å€¼åˆ°å¯„å­˜å™¨)ï¼Œä»¥ååªè¦å˜é‡çš„å€¼æ²¡æœ‰æ”¹å˜ï¼Œå°±ä¸€ç›´ä»å¯„å­˜å™¨ä¸­è¯»å–å˜é‡çš„å€¼ï¼Œè€Œä¸å¯¹RAMè¿›è¡Œè®¿é—®ã€‚ è€Œåœ¨å¤šä»»åŠ¡ç¯å¢ƒä¸­ï¼Œè™½ç„¶åœ¨ä¸€ä¸ªå‡½æ•°ä½“å†…éƒ¨ï¼Œåœ¨ä¸¤æ¬¡è¯»å–å˜é‡ä¹‹é—´æ²¡æœ‰å¯¹å˜é‡çš„å€¼è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯è¯¥å˜é‡ä»ç„¶æœ‰å¯èƒ½è¢«å…¶ä»–çš„ç¨‹åº(å¦‚ä¸­æ–­ç¨‹åºã€å¦å¤–çš„çº¿ç¨‹ç­‰)æ‰€ä¿®æ”¹ã€‚å¦‚æœè¿™æ—¶è¿˜æ˜¯ä»å¯„å­˜å™¨è€Œä¸æ˜¯ä»RAMä¸­è¯»å–ï¼Œå°±ä¼šå‡ºç°è¢«ä¿®æ”¹äº†çš„å˜é‡å€¼ä¸èƒ½å¾—åˆ°åŠæ—¶ååº”çš„é—®é¢˜ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:15","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.16 ä¸€ä¸ªå‚æ•°å¯ä»¥æ—¢æ˜¯conståˆæ˜¯volatileå— å¯ä»¥ã€‚ç”¨constå’ŒvolatileåŒæ—¶ä¿®é¥°å˜é‡ï¼Œè¡¨ç¤ºè¿™ä¸ªå˜é‡åœ¨ç¨‹åºå†…éƒ¨æ˜¯åªè¯»çš„ï¼Œä¸èƒ½æ”¹å˜çš„ï¼Œåªåœ¨ç¨‹åºå¤–éƒ¨æ¡ä»¶å˜åŒ–ä¸‹æ”¹å˜ï¼Œå¹¶ä¸”ç¼–è¯‘å™¨ä¸ä¼šä¼˜åŒ–è¿™ä¸ªå˜é‡ã€‚æ¯æ¬¡ä½¿ç”¨è¿™ä¸ªå˜é‡æ—¶ï¼Œéƒ½è¦å°å¿ƒåœ°å»å†…å­˜è¯»å–è¿™ä¸ªå˜é‡çš„å€¼ï¼Œè€Œä¸æ˜¯å»å¯„å­˜å™¨è¯»å–å®ƒçš„å¤‡ä»½ã€‚ æ³¨æ„ï¼šåœ¨æ­¤ä¸€å®šè¦æ³¨æ„constçš„æ„æ€ï¼Œconståªæ˜¯ä¸å…è®¸ç¨‹åºä¸­çš„ä»£ç æ”¹å˜æŸä¸€å˜é‡ï¼Œå…¶åœ¨ç¼–è¯‘æœŸå‘æŒ¥ä½œç”¨ï¼Œå®ƒå¹¶æ²¡æœ‰å®é™…åœ°ç¦æ­¢æŸæ®µå†…å­˜çš„è¯»å†™ç‰¹æ€§ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:16","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.17Â *aå’Œ\u0026aæœ‰ä»€ä¹ˆåŒºåˆ« \u0026aï¼šå…¶å«ä¹‰å°±æ˜¯â€œå˜é‡açš„åœ°å€â€ã€‚ *aï¼šç”¨åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œå«ä¹‰ä¹Ÿä¸ä¸€æ ·ã€‚ â‘ åœ¨å£°æ˜è¯­å¥ä¸­ï¼Œ*aåªè¯´æ˜aæ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œå¦‚int *aï¼› â‘¡åœ¨å…¶ä»–è¯­å¥ä¸­ï¼Œ*aå‰é¢æ²¡æœ‰æ“ä½œæ•°ä¸”aæ˜¯ä¸€ä¸ªæŒ‡é’ˆæ—¶ï¼Œ*aä»£è¡¨æŒ‡é’ˆaæŒ‡å‘çš„åœ°å€å†…å­˜æ”¾çš„æ•°æ®(è§£å¼•ç”¨)ï¼Œå¦‚b=*aï¼› â‘¢*aå‰é¢æœ‰æ“ä½œæ•°ä¸”aæ˜¯ä¸€ä¸ªæ™®é€šå˜é‡æ—¶ï¼Œaä»£è¡¨ä¹˜ä»¥aï¼Œå¦‚c=ba ","date":"2023-07-11","objectID":"/posts/basics_one/:2:17","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.18 ç”¨C ç¼–å†™ä¸€ä¸ªæ­»å¾ªç¯ç¨‹åº while(1) { } æ³¨æ„ï¼šå¾ˆå¤šç§é€”å¾„éƒ½å¯å®ç°åŒä¸€ç§åŠŸèƒ½ï¼Œä½†æ˜¯ä¸åŒçš„æ–¹æ³•æ—¶é—´å’Œç©ºé—´å ç”¨åº¦ä¸åŒï¼Œç‰¹åˆ«æ˜¯å¯¹äºåµŒå…¥å¼è½¯ä»¶ï¼Œå¤„ç†å™¨é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œå­˜å‚¨ç©ºé—´è¾ƒå°ï¼Œæ‰€ä»¥æ—¶é—´å’Œç©ºé—´ä¼˜åŠ¿æ˜¯é€‰æ‹©å„ç§æ–¹æ³•çš„é¦–è¦è€ƒè™‘æ¡ä»¶ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:18","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.19Â å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿæ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨æ˜¯æ€ä¹ˆçŸ¥é“çš„ï¼Ÿ â‘ å…¨å±€å˜é‡æ˜¯æ•´ä¸ªç¨‹åºéƒ½å¯è®¿é—®çš„å˜é‡ï¼Œè°éƒ½å¯ä»¥è®¿é—®ï¼Œç”Ÿå­˜æœŸåœ¨æ•´ä¸ªç¨‹åºä»è¿è¡Œåˆ°ç»“æŸ(åœ¨ç¨‹åºç»“æŸæ—¶æ‰€å å†…å­˜é‡Šæ”¾)ï¼› â‘¡è€Œå±€éƒ¨å˜é‡å­˜åœ¨äºæ¨¡å—(å­ç¨‹åºï¼Œå‡½æ•°)ä¸­ï¼Œåªæœ‰æ‰€åœ¨æ¨¡å—å¯ä»¥è®¿é—®ï¼Œå…¶ä»–æ¨¡å—ä¸å¯ç›´æ¥è®¿é—®ï¼Œæ¨¡å—ç»“æŸ(å‡½æ•°è°ƒç”¨å®Œæ¯•)ï¼Œå±€éƒ¨å˜é‡æ¶ˆå¤±ï¼Œæ‰€å æ®çš„å†…å­˜é‡Šæ”¾ã€‚ â‘¢æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨ï¼Œå¯èƒ½æ˜¯é€šè¿‡å†…å­˜åˆ†é…çš„ä½ç½®æ¥çŸ¥é“çš„ï¼Œå…¨å±€å˜é‡åˆ†é…åœ¨å…¨å±€æ•°æ®æ®µå¹¶ä¸”åœ¨ç¨‹åºå¼€å§‹è¿è¡Œçš„æ—¶å€™è¢«åŠ è½½.å±€éƒ¨å˜é‡åˆ™åˆ†é…åœ¨å †æ ˆé‡Œé¢ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:19","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"2.20 ç»“æ„ä½“å†…å­˜å¯¹é½é—®é¢˜ è¯·å†™å‡ºä»¥ä¸‹ä»£ç çš„è¾“å‡ºç»“æœï¼š #include \u003cstdio.h\u003e using namespace std; /************************************************************** * ç»“æ„ä½“å†…å­˜å¯¹â»¬é—®é¢˜ * ä»åç§»ä¸º0çš„ä½ç½®å¼€å§‹å­˜å‚¨ï¼› * å¦‚æœæ²¡æœ‰å®šä¹‰ #pragma pack(n) * sizeof çš„æœ€ç»ˆç»“æœå¿…ç„¶æ˜¯ç»“æ„å†…éƒ¨æœ€â¼¤æˆå‘˜çš„æ•´æ•°å€ï¼Œä¸å¤Ÿè¡¥â»¬ï¼› * ç»“æ„å†…éƒ¨å„ä¸ªæˆå‘˜çš„â¾¸åœ°å€å¿…ç„¶æ˜¯â¾ƒèº«â¼¤â¼©çš„æ•´æ•°å€ï¼› * ***************************************************************/ struct S1 { int i ; //èµ·å§‹åç§»0ï¼Œsizeof(i)=4; åœ°å€0ã€1ã€2ã€3åˆ†é…ç»™æˆå‘˜i char j ; //èµ·å§‹åç§»4ï¼Œsizeof(j)=1; int a ; //sizeof(a)=4,å†…å­˜å¯¹é½åˆ°8ä¸ªå­—èŠ‚ï¼Œä»åç§»é‡ä¸º8å¤„å­˜æ”¾a; double b;//sizeof(b)=8,å†…å­˜å¯¹é½åˆ°16ä¸ªå­—èŠ‚ï¼Œå†å­˜æ”¾b,ç»“æ„ä½“æ€»å¤§å°24; }; //ç»“æ„ä½“æˆå‘˜çš„é¦–åœ°å€å¿…é¡»æ˜¯è‡ªèº«å¤§å°çš„æ•´æ•°å€ struct S3 { char j;//èµ·å§‹åç§»0ï¼Œsizeof(j)=1; float i;//sizeof(i)=4ï¼Œå†…å­˜å¯¹é½åˆ°4ï¼Œèµ·å§‹åç§»é‡ä¸º4,å†å­˜æ”¾i double b;//å½“å‰åœ°å€ä¸º8ï¼Œæ˜¯bå¤§å°çš„æ•´æ•°å€ï¼Œæ— éœ€å¯¹é½ï¼Œç›´æ¥å­˜æ”¾æˆå‘˜b 8ä¸ªå­—èŠ‚ int a;//sizeof(a)=4,å†…å­˜å¯¹é½åˆ°20ï¼Œå†å­˜æ”¾a,æ€»å¤§å°24å­—èŠ‚ï¼› }; int main() { printf(\"%d\\n\", sizeof(S1)); printf(\"%d\\n\", sizeof(S3)); return 0; } è¾“å‡º: 24 24 è¯´æ˜ï¼š â‘ ç»“æ„ä½“ä½œä¸ºä¸€ç§å¤åˆæ•°æ®ç±»å‹ï¼Œå…¶æ„æˆå…ƒç´ æ—¢å¯ä»¥æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€äº›å¤åˆå‹ç±»å‹æ•°æ®ã€‚å¯¹æ­¤ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œæˆå‘˜å˜é‡çš„å¯¹é½ä»¥æé«˜è¿ç®—æ•ˆç‡ã€‚ â‘¡é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŒ‰è‡ªç„¶å¯¹é½æ¡ä»¶åˆ†é…ç©ºé—´ã€‚å„ä¸ªæˆå‘˜æŒ‰ç…§å®ƒä»¬è¢«å£°æ˜çš„é¡ºåºåœ¨å†…å­˜ä¸­é¡ºåºå­˜å‚¨ï¼Œç¬¬ä¸€ä¸ªæˆå‘˜çš„åœ°å€å’Œæ•´ä¸ªç»“æ„çš„åœ°å€ç›¸åŒï¼Œå‘ç»“æ„ä½“æˆå‘˜ä¸­sizeæœ€å¤§çš„æˆå‘˜å¯¹é½ã€‚ â‘¢è®¸å¤šå®é™…çš„è®¡ç®—æœºç³»ç»Ÿå¯¹åŸºæœ¬ç±»å‹æ•°æ®åœ¨å†…å­˜ä¸­å­˜æ”¾çš„ä½ç½®æœ‰é™åˆ¶ï¼Œå®ƒä»¬ä¼šè¦æ±‚è¿™äº›æ•°æ®çš„é¦–åœ°å€çš„å€¼æ˜¯æŸä¸ªæ•°k(é€šå¸¸å®ƒä¸º4æˆ–8)çš„å€æ•°ï¼Œè€Œè¿™ä¸ªkåˆ™è¢«ç§°ä¸ºè¯¥æ•°æ®ç±»å‹çš„å¯¹é½æ¨¡æ•°ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:2:20","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3 åŸºç¡€çŸ¥è¯†(ä¸‰) ","date":"2023-07-11","objectID":"/posts/basics_one/:3:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.1 ç®€è¿°Cã€C++ç¨‹åºç¼–è¯‘çš„å†…å­˜åˆ†é…æƒ…å†µ â‘ ä»é™æ€å­˜å‚¨åŒºåŸŸåˆ†é…ï¼š å†…å­˜åœ¨ç¨‹åºç¼–è¯‘æ—¶å°±å·²ç»åˆ†é…å¥½ï¼Œè¿™å—å†…å­˜åœ¨ç¨‹åºçš„æ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ã€‚é€Ÿåº¦å¿«ã€ä¸å®¹æ˜“å‡ºé”™ï¼Œ å› ä¸ºæœ‰ç³»ç»Ÿä¼šå–„åã€‚ä¾‹å¦‚å…¨å±€å˜é‡ï¼Œstatic å˜é‡ï¼Œå¸¸é‡å­—ç¬¦ä¸²ç­‰ã€‚ â‘¡åœ¨æ ˆä¸Šåˆ†é…ï¼š åœ¨æ‰§è¡Œå‡½æ•°æ—¶ï¼Œå‡½æ•°å†…å±€éƒ¨å˜é‡çš„å­˜å‚¨å•å…ƒéƒ½åœ¨æ ˆä¸Šåˆ›å»ºï¼Œå‡½æ•°æ‰§è¡Œç»“æŸæ—¶, è¿™äº›å­˜å‚¨å•å…ƒè‡ªåŠ¨è¢«é‡Šæ”¾ã€‚æ ˆå†…å­˜åˆ†é…è¿ç®—å†…ç½®äºå¤„ç†å™¨çš„æŒ‡ä»¤é›†ä¸­ï¼Œæ•ˆç‡å¾ˆé«˜ï¼Œä½†æ˜¯åˆ†é…çš„å†…å­˜å®¹é‡æœ‰é™ã€‚å¤§å°ä¸º2Mã€‚ â‘¢ä»å †ä¸Šåˆ†é…ï¼š å³åŠ¨æ€å†…å­˜åˆ†é…ã€‚ç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™ç”¨ malloc æˆ– new ç”³è¯·ä»»æ„å¤§å°çš„å†…å­˜ï¼Œç¨‹åºå‘˜è‡ªå·±è´Ÿè´£åœ¨ä½•æ—¶ç”¨ free æˆ– delete é‡Šæ”¾å†…å­˜ã€‚åŠ¨æ€å†…å­˜çš„ç”Ÿå­˜æœŸç”±ç¨‹åºå‘˜å†³å®šï¼Œä½¿ç”¨éå¸¸çµæ´»ã€‚å¦‚æœåœ¨å †ä¸Šåˆ†é…äº†ç©ºé—´ï¼Œå°±æœ‰è´£ä»»å›æ”¶å®ƒï¼Œå¦åˆ™è¿è¡Œçš„ç¨‹åºä¼šå‡ºç°å†…å­˜æ³„æ¼ï¼Œå¦å¤–é¢‘ç¹åœ°åˆ†é…å’Œé‡Šæ”¾ä¸åŒå¤§å°çš„å †ç©ºé—´å°†ä¼šäº§ç”Ÿå †å†…ç¢å—ã€‚ ä¸€ä¸ªCã€C++ç¨‹åºç¼–è¯‘æ—¶å†…å­˜åˆ†ä¸º5å¤§å­˜å‚¨åŒºï¼šå †åŒºã€æ ˆåŒºã€å…¨å±€åŒºã€æ–‡å­—å¸¸é‡åŒºã€ç¨‹åºä»£ç åŒºã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:1","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.2Â ç®€è¿°strcpyã€sprintf ä¸memcpy çš„åŒºåˆ« â‘  æ“ä½œå¯¹è±¡ä¸åŒï¼Œstrcpy çš„ä¸¤ä¸ªæ“ä½œå¯¹è±¡å‡ä¸ºå­—ç¬¦ä¸²ï¼Œsprintf çš„æ“ä½œæºå¯¹è±¡å¯ä»¥æ˜¯å¤šç§æ•°æ®ç±»å‹ï¼Œ ç›®çš„æ“ä½œå¯¹è±¡æ˜¯å­—ç¬¦ä¸²ï¼Œmemcpy çš„ä¸¤ä¸ªå¯¹è±¡å°±æ˜¯ä¸¤ä¸ªä»»æ„å¯æ“ä½œçš„å†…å­˜åœ°å€ï¼Œå¹¶ä¸é™äºä½•ç§æ•°æ®ç±»å‹ã€‚ â‘¡ æ‰§è¡Œæ•ˆç‡ä¸åŒï¼Œmemcpy æœ€é«˜ï¼Œstrcpy æ¬¡ä¹‹ï¼Œsprintf çš„æ•ˆç‡æœ€ä½ã€‚ â‘¢ å®ç°åŠŸèƒ½ä¸åŒï¼Œstrcpy ä¸»è¦å®ç°å­—ç¬¦ä¸²å˜é‡é—´çš„æ‹·è´ï¼Œsprintf ä¸»è¦å®ç°å…¶ä»–æ•°æ®ç±»å‹æ ¼å¼åˆ°å­—ç¬¦ä¸²çš„è½¬åŒ–ï¼Œmemcpy ä¸»è¦æ˜¯å†…å­˜å—é—´çš„æ‹·è´ã€‚ æ³¨æ„ï¼šstrcpyã€sprintf ä¸memcpy éƒ½å¯ä»¥å®ç°æ‹·è´çš„åŠŸèƒ½ï¼Œä½†æ˜¯é’ˆå¯¹çš„å¯¹è±¡ä¸åŒï¼Œæ ¹æ®å®é™…éœ€æ±‚ï¼Œæ¥é€‰æ‹©åˆé€‚çš„å‡½æ•°å®ç°æ‹·è´åŠŸèƒ½ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:2","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.3 è¯·è§£æ((void ()( ) )0)( )çš„å«ä¹‰ void (0)( ) ï¼šæ˜¯ä¸€ä¸ªè¿”å›å€¼ä¸ºvoidï¼Œå‚æ•°ä¸ºç©ºçš„å‡½æ•°æŒ‡é’ˆ0ã€‚ (void ()( ))0ï¼šæŠŠ0è½¬å˜æˆä¸€ä¸ªè¿”å›å€¼ä¸ºvoidï¼Œå‚æ•°ä¸ºç©ºçš„å‡½æ•°æŒ‡é’ˆã€‚ ((void ()( ))0()ï¼šåœ¨ä¸Šå¥çš„åŸºç¡€ä¸ŠåŠ æ‹¬å·è¡¨ç¤ºæ•´ä¸ªæ˜¯ä¸€ä¸ªè¿”å›å€¼ä¸ºvoidï¼Œæ— å‚æ•°ï¼Œå¹¶ä¸”èµ·å§‹åœ°å€ä¸º0çš„å‡½æ•°çš„åå­—ã€‚ ((void (*)( ))0)( )ï¼šè¿™å°±æ˜¯ä¸Šå¥çš„å‡½æ•°åæ‰€å¯¹åº”çš„å‡½æ•°çš„è°ƒç”¨ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:3","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.4 typedef å’Œdefine æœ‰ä»€ä¹ˆåŒºåˆ« â‘ ç”¨æ³•ä¸åŒï¼š typedef ç”¨æ¥å®šä¹‰ä¸€ç§æ•°æ®ç±»å‹çš„åˆ«åï¼Œå¢å¼ºç¨‹åºçš„å¯è¯»æ€§ã€‚define ä¸»è¦ç”¨æ¥å®šä¹‰å¸¸é‡ï¼Œä»¥åŠä¹¦å†™å¤æ‚ä½¿ç”¨é¢‘ç¹çš„å®ã€‚ â‘¡æ‰§è¡Œæ—¶é—´ä¸åŒï¼š typedef æ˜¯ç¼–è¯‘è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæœ‰ç±»å‹æ£€æŸ¥çš„åŠŸèƒ½ã€‚define æ˜¯å®å®šä¹‰ï¼Œæ˜¯é¢„ç¼–è¯‘çš„éƒ¨åˆ†ï¼Œå…¶å‘ç”Ÿåœ¨ç¼–è¯‘ä¹‹å‰ï¼Œåªæ˜¯ç®€å•çš„è¿›è¡Œå­—ç¬¦ä¸²çš„æ›¿æ¢ï¼Œä¸è¿›è¡Œç±»å‹çš„æ£€æŸ¥ã€‚ â‘¢ä½œç”¨åŸŸä¸åŒï¼š typedef æœ‰ä½œç”¨åŸŸé™å®šï¼šdefine ä¸å—ä½œç”¨åŸŸçº¦æŸï¼Œåªè¦åœ¨define å£°æ˜åçš„å¼•ç”¨éƒ½æ˜¯æ­£ç¡®çš„ã€‚ â‘£å¯¹æŒ‡é’ˆçš„æ“ä½œä¸åŒï¼š typedef å’Œ define å®šä¹‰çš„æŒ‡é’ˆæ—¶æœ‰å¾ˆå¤§çš„åŒºåˆ«ã€‚ æ³¨æ„ï¼štypedef å®šä¹‰æ˜¯è¯­å¥ï¼Œå› ä¸ºå¥å°¾è¦åŠ ä¸Šåˆ†å·ã€‚è€Œdefine ä¸æ˜¯è¯­å¥ï¼Œåƒä¸‡ä¸èƒ½åœ¨å¥å°¾åŠ åˆ†å·ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:4","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.5Â æŒ‡é’ˆå¸¸é‡ä¸å¸¸é‡æŒ‡é’ˆåŒºåˆ« æŒ‡é’ˆå¸¸é‡æ˜¯æŒ‡å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆçš„å€¼åªèƒ½åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œå…¶ä»–åœ°æ–¹ä¸èƒ½æ”¹å˜ã€‚(åœ°å€ä¸å¯å˜) å¸¸é‡æŒ‡é’ˆæ˜¯æŒ‡å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªåªè¯»çš„å¯¹è±¡ï¼Œä¸èƒ½é€šè¿‡å¸¸é‡æŒ‡é’ˆæ¥æ”¹å˜è¿™ä¸ªå¯¹è±¡çš„å€¼ã€‚(å€¼ä¸å¯å˜) æŒ‡é’ˆå¸¸é‡å¼ºè°ƒçš„æ˜¯æŒ‡é’ˆçš„ä¸å¯æ”¹å˜æ€§ï¼Œè€Œå¸¸é‡æŒ‡é’ˆå¼ºè°ƒçš„æ˜¯æŒ‡é’ˆå¯¹å…¶æ‰€æŒ‡å¯¹è±¡çš„ä¸å¯æ”¹å˜æ€§ã€‚ æ³¨æ„ï¼šæ— è®ºæ˜¯æŒ‡é’ˆå¸¸é‡è¿˜æ˜¯å¸¸é‡æŒ‡é’ˆï¼Œå…¶æœ€å¤§çš„ç”¨é€”å°±æ˜¯ä½œä¸ºå‡½æ•°çš„å½¢å¼å‚æ•°ï¼Œä¿è¯å®å‚åœ¨è¢«è°ƒç”¨å‡½æ•°ä¸­çš„ä¸å¯æ”¹å˜ç‰¹æ€§ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:5","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.6Â ç®€è¿°é˜Ÿåˆ—å’Œæ ˆçš„å¼‚åŒ é˜Ÿåˆ—å’Œæ ˆéƒ½æ˜¯çº¿æ€§å­˜å‚¨ç»“æ„ï¼Œä½†æ˜¯ä¸¤è€…çš„æ’å…¥å’Œåˆ é™¤æ•°æ®çš„æ“ä½œä¸åŒï¼Œé˜Ÿåˆ—æ˜¯â€œå…ˆè¿›å…ˆå‡ºâ€ï¼Œæ ˆæ˜¯ â€œåè¿›å…ˆå‡ºâ€ã€‚ æ³¨æ„ï¼šåŒºåˆ«æ ˆåŒºå’Œå †åŒºã€‚å †åŒºçš„å­˜å–æ˜¯â€œé¡ºåºéšæ„â€ï¼Œè€Œæ ˆåŒºæ˜¯â€œåè¿›å…ˆå‡ºâ€ã€‚æ ˆç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾ ï¼Œå­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼ï¼Œå±€éƒ¨å˜é‡çš„å€¼ç­‰ã€‚å…¶æ“ä½œæ–¹å¼ç±»ä¼¼äºæ•°æ®ç»“æ„ä¸­çš„æ ˆã€‚å †ä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…é‡Šæ”¾ï¼Œ è‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾ï¼Œç¨‹åºç»“æŸæ—¶å¯èƒ½ç”±OS å›æ”¶ã€‚åˆ†é…æ–¹å¼ç±»ä¼¼äºé“¾è¡¨ã€‚ å®ƒä¸æœ¬é¢˜ä¸­çš„å †å’Œæ ˆæ˜¯ä¸¤å›äº‹ã€‚å †æ ˆåªæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œè€Œå †åŒºå’Œæ ˆåŒºæ˜¯ç¨‹åºçš„ä¸åŒå†…å­˜å­˜å‚¨åŒºåŸŸã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:6","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.7Â è®¾ç½®åœ°å€ä¸º0x67a9 çš„æ•´å‹å˜é‡çš„å€¼ä¸º0xaa66 int *ptr; ptr = (int *)0x67a9; *ptr = 0xaa66; // å¯¹æŒ‡é’ˆå–åœ°å€ æ³¨æ„ï¼šè¿™é“é¢˜å°±æ˜¯å¼ºåˆ¶ç±»å‹è½¬æ¢çš„å…¸å‹ä¾‹å­ï¼Œæ— è®ºåœ¨ä»€ä¹ˆå¹³å°ï¼Œåœ°å€é•¿åº¦å’Œæ•´å‹æ•°æ®çš„é•¿åº¦æ˜¯ä¸€æ ·çš„ï¼Œ å³ä¸€ä¸ªæ•´å‹æ•°æ®å¯ä»¥å¼ºåˆ¶è½¬æ¢æˆåœ°å€æŒ‡é’ˆç±»å‹ï¼Œåªè¦æœ‰æ„ä¹‰å³å¯ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:7","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.8Â ç¼–ç å®ç°å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­— ç¼–ç å®ç°å‡½æ•°atoi()ï¼Œè®¾è®¡ä¸€ä¸ªç¨‹åºï¼ŒæŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬åŒ–ä¸ºä¸€ä¸ªæ•´å‹æ•°å€¼ã€‚ä¾‹å¦‚å­—ç¬¦ï¼šâ€œ5486321 â€è½¬åŒ–æˆæ•´å‹ï¼š5486321ã€‚ int myAtoi(const char * str) { int num = 0; //ä¿å­˜è½¬æ¢åçš„æ•°å€¼ int isNegative = 0; //è®°å½•å­—ç¬¦ä¸²ä¸­æ˜¯å¦æœ‰è´Ÿå· int n =0; char *p = str; if(p == NULL) //åˆ¤æ–­æŒ‡é’ˆçš„åˆæ³•æ€§ { return -1; } while(*p++ != '\\0') //è®¡ç®—æ•°å­—ç¬¦ä¸²åº¦ { n++; } p = str; if(p[0] == '-') //åˆ¤æ–­æ•°ç»„æ˜¯å¦æœ‰è´Ÿå· { isNegative = 1; } char temp = '0'; for(int i = 0 ; i \u003c n; i++) { char temp = *p++; if(temp \u003e '9' ||temp \u003c '0') //æ»¤é™¤éæ•°å­—å­—ç¬¦ { continue; } if(num !=0 || temp != '0') //æ»¤é™¤å­—ç¬¦ä¸²å¼€å§‹çš„0 å­—ç¬¦ { temp -= 0x30; //å°†æ•°å­—å­—ç¬¦è½¬æ¢ä¸ºæ•°å€¼ num += temp *int( pow(10 , n - 1 -i) ); } } if(isNegative) //å¦‚æœå­—ç¬¦ä¸²ä¸­æœ‰è´Ÿå·ï¼Œå°†æ•°å€¼å–å { return (0 - num); } else { return num; //è¿”å›è½¬æ¢åçš„æ•°å€¼ } } ","date":"2023-07-11","objectID":"/posts/basics_one/:3:8","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.9Â Cè¯­è¨€çš„ç»“æ„ä½“(struct)å’ŒC++çš„ç±»(class)æœ‰ä»€ä¹ˆåŒºåˆ« â‘ Cè¯­è¨€çš„ç»“æ„ä½“æ˜¯ä¸èƒ½æœ‰æˆå‘˜å‡½æ•°çš„ï¼Œè€ŒC++çš„ç±»å¯ä»¥æœ‰ã€‚ â‘¡Cè¯­è¨€çš„ç»“æ„ä½“ä¸­æ•°æ®æˆå‘˜æ˜¯æ²¡æœ‰privateã€publicå’Œprotectedè®¿é—®é™å®šçš„ã€‚è€ŒC++çš„ç±»çš„æˆå‘˜æœ‰è¿™äº›è®¿é—®æƒé™é™å®šã€‚ â‘¢Cè¯­è¨€çš„ç»“æ„ä½“æ˜¯æ²¡æœ‰ç»§æ‰¿å…³ç³»çš„ï¼Œè€ŒC++çš„ç±»å´æœ‰ä¸°å¯Œçš„ç»§æ‰¿å…³ç³»ã€‚ æ³¨æ„ï¼šè™½ç„¶Cçš„ç»“æ„ä½“å’ŒC++çš„ç±»æœ‰å¾ˆå¤§çš„ç›¸ä¼¼åº¦ï¼Œä½†æ˜¯ç±»æ˜¯å®ç°é¢å‘å¯¹è±¡çš„åŸºç¡€ã€‚è€Œç»“æ„ä½“åªå¯ä»¥ç®€å•åœ°ç†è§£ä¸ºç±»çš„å‰èº«ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:9","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.10 ç®€è¿°æŒ‡é’ˆå¸¸é‡ä¸å¸¸é‡æŒ‡é’ˆçš„åŒºåˆ« â‘ æŒ‡é’ˆå¸¸é‡æ˜¯æŒ‡å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆçš„å€¼åªèƒ½åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œå…¶ä»–åœ°æ–¹ä¸èƒ½æ”¹å˜ã€‚å¸¸é‡æŒ‡é’ˆæ˜¯å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªåªè¯»çš„å¯¹è±¡ï¼Œä¸èƒ½é€šè¿‡å¸¸é‡æŒ‡é’ˆæ¥æ”¹å˜è¿™ä¸ªå¯¹è±¡çš„å€¼ã€‚æŒ‡é’ˆå¸¸é‡çš„å€¼åªèƒ½åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œå¸¸é‡æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªåªè¯»çš„å¯¹è±¡ â‘¡æŒ‡é’ˆå¸¸é‡å¼ºè°ƒçš„æ˜¯æŒ‡é’ˆçš„ä¸å¯æ”¹å˜æ€§ï¼Œè€Œå¸¸é‡æŒ‡é’ˆå¼ºè°ƒçš„æ˜¯æŒ‡é’ˆå¯¹å…¶æ‰€æŒ‡å¯¹è±¡çš„ä¸å¯æ”¹å˜æ€§ã€‚ æ³¨æ„ï¼šæ— è®ºæ˜¯æŒ‡é’ˆå¸¸é‡è¿˜æ˜¯å¸¸é‡æŒ‡é’ˆï¼Œå…¶æœ€å¤§çš„ç”¨é€”å°±æ˜¯ä½œä¸ºå‡½æ•°çš„å½¢å¼å‚æ•°ï¼Œä¿è¯å®å‚åœ¨è¢«è°ƒç”¨å‡½æ•°ä¸­çš„ä¸å¯æ”¹å˜ç‰¹æ€§ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:10","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.11 å“ªäº›æƒ…å†µä¼šå¯¼è‡´â€œé‡æŒ‡é’ˆâ€ä»¥åŠå¦‚ä½•é¿å… â‘ æŒ‡é’ˆå˜é‡å£°æ˜æ—¶æ²¡æœ‰è¢«åˆå§‹åŒ–ã€‚è§£å†³åŠæ³•ï¼šæŒ‡é’ˆå£°æ˜æ—¶åˆå§‹åŒ–ï¼Œå¯ä»¥æ˜¯å…·ä½“çš„åœ°å€å€¼ï¼Œä¹Ÿå¯è®©å®ƒæŒ‡å‘NULLã€‚ â‘¡æŒ‡é’ˆpè¢«freeæˆ–è€…deleteä¹‹åï¼Œæ²¡æœ‰ç½®ä¸ºNULLã€‚è§£å†³åŠæ³•ï¼šæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´è¢«é‡Šæ”¾åæŒ‡é’ˆåº”è¯¥æŒ‡å‘NULLã€‚ â‘¢æŒ‡é’ˆæ“ä½œè¶…è¶Šäº†å˜é‡çš„ä½œç”¨èŒƒå›´ã€‚è§£å†³åŠæ³•ï¼šåœ¨å˜é‡çš„ä½œç”¨åŸŸç»“æŸå‰é‡Šæ”¾æ‰å˜é‡çš„åœ°å€ç©ºé—´å¹¶ä¸”è®©æŒ‡é’ˆæŒ‡å‘NULLã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:11","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.12Â å¥æŸ„å’ŒæŒ‡é’ˆçš„åŒºåˆ«å’Œè”ç³»æ˜¯ä»€ä¹ˆï¼Ÿ å¥æŸ„å’ŒæŒ‡é’ˆå…¶å®æ˜¯ä¸¤ä¸ªæˆªç„¶ä¸åŒçš„æ¦‚å¿µã€‚Windowsç³»ç»Ÿç”¨å¥æŸ„æ ‡è®°ç³»ç»Ÿèµ„æºï¼Œéšè—ç³»ç»Ÿçš„ä¿¡æ¯ã€‚ä½ åªè¦çŸ¥é“æœ‰è¿™ä¸ªä¸œè¥¿ï¼Œç„¶åå»è°ƒç”¨å°±è¡Œäº†ï¼Œå®ƒæ˜¯ä¸ª32bitçš„uintã€‚æŒ‡é’ˆåˆ™æ ‡è®°æŸä¸ªç‰©ç†å†…å­˜åœ°å€ï¼Œä¸¤è€…æ˜¯ä¸åŒçš„æ¦‚å¿µã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:12","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.13Â new/deleteä¸malloc/freeçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ newèƒ½è‡ªåŠ¨è®¡ç®—éœ€è¦åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œè€Œmallocéœ€è¦æ‰‹å·¥è®¡ç®—å­—èŠ‚æ•°ã€‚ int *p = new int[2]; int *q = (int )malloc(2sizeof(int)); â‘ newä¸deleteç›´æ¥å¸¦å…·ä½“ç±»å‹çš„æŒ‡é’ˆï¼Œmallocå’Œfreeè¿”å›voidç±»å‹çš„æŒ‡é’ˆã€‚ â‘¡newæ“ä½œç¬¦èƒ½ä¿è¯ç±»å‹å®‰å…¨ï¼Œè€Œmallocä¸èƒ½ã€‚ä¾‹å¦‚int *p = new float[2];å°±ä¼šæŠ¥é”™ï¼›è€Œint p = malloc(2sizeof(int))ç¼–è¯‘æ—¶ç¼–è¯‘å™¨å°±æ— æ³•æŒ‡å‡ºé”™è¯¯æ¥ã€‚ â‘¢newä¸€èˆ¬åˆ†ä¸ºä¸¤æ­¥ï¼šnewæ“ä½œå’Œè°ƒç”¨æ„é€ å‡½æ•°ã€‚newæ“ä½œå¯¹åº”äºmallocï¼Œä½†newæ“ä½œå¯ä»¥é‡è½½ï¼Œå¯ä»¥è‡ªå®šä¹‰å†…å­˜åˆ†é…ç­–ç•¥ï¼Œä¸åšå†…å­˜åˆ†é…ï¼Œç”šè‡³åˆ†é…åˆ°éå†…å­˜è®¾å¤‡ä¸Šï¼Œè€Œmallocä¸è¡Œã€‚ â‘£newè°ƒç”¨æ„é€ å‡½æ•°ï¼Œmallocä¸èƒ½ï¼›deleteè°ƒç”¨ææ„å‡½æ•°ï¼Œè€Œfreeä¸èƒ½ã€‚ â‘¤malloc/freeéœ€è¦åº“æ–‡ä»¶stdlib.hçš„æ”¯æŒï¼Œnew/deleteåˆ™ä¸éœ€è¦ï¼ â‘¥new/deleteæ˜¯C++çš„å…³é”®å­—,ç”³è¯·å†…å­˜å¤±è´¥æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œmalloc/freeæ˜¯åº“å‡½æ•°ï¼Œç”³è¯·å†…å­˜å¤±è´¥åè¿”å›nullã€‚ â‘¦new/deleteæ˜¯C++çš„å†…å­˜åˆ†é…å’Œå›æ”¶æœºåˆ¶ï¼Œmalloc/freeæ˜¯Cçš„å†…å­˜åˆ†é…å’Œå›æ”¶æœºåˆ¶ã€‚ æ³¨æ„ï¼šdeleteå’Œfreeè¢«è°ƒç”¨åï¼Œå†…å­˜ä¸ä¼šç«‹å³å›æ”¶ï¼ŒæŒ‡é’ˆä¹Ÿä¸ä¼šæŒ‡å‘ç©ºï¼Œdeleteæˆ–freeä»…ä»…æ˜¯å‘Šè¯‰æ“ä½œç³»ç»Ÿï¼Œè¿™ä¸€å—å†…å­˜è¢«é‡Šæ”¾äº†ï¼Œå¯ä»¥ç”¨ä½œå…¶ä»–ç”¨é€”ã€‚ä½†æ˜¯ç”±äºæ²¡æœ‰é‡æ–°å¯¹è¿™å—å†…å­˜è¿›è¡Œå†™æ“ä½œï¼Œæ‰€ä»¥å†…å­˜ä¸­çš„å˜é‡æ•°å€¼å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå‡ºç°é‡æŒ‡é’ˆçš„æƒ…å†µã€‚å› æ­¤ï¼Œé‡Šæ”¾å®Œå†…å­˜åï¼Œåº”è¯¥å°†æŒ‡é’ˆæŒ‡å‘NULLã€‚ new delete è¯¦è§£ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:13","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.14Â è¯´ä¸€è¯´externâ€œCâ€ extern \"C\"çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®å®ç°åœ¨C++ä»£ç ä¸­è°ƒç”¨Cè¯­è¨€ä»£ç ã€‚åŠ ä¸Šextern \"C\"åï¼Œä¼šæŒ‡ç¤ºç¼–è¯‘å™¨è¿™éƒ¨åˆ†ä»£ç æŒ‰Cè¯­è¨€(è€Œä¸æ˜¯C++)çš„æ–¹å¼è¿›è¡Œç¼–è¯‘ã€‚ç”±äºC++æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘å™¨ç¼–è¯‘å‡½æ•°çš„è¿‡ç¨‹ä¸­ä¼šå°†å‡½æ•°çš„å‚æ•°ç±»å‹ä¹ŸåŠ åˆ°ç¼–è¯‘åçš„ä»£ç ä¸­ï¼Œè€Œä¸ä»…ä»…æ˜¯å‡½æ•°åï¼›è€ŒCè¯­è¨€å¹¶ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘Cè¯­è¨€ä»£ç çš„å‡½æ•°æ—¶ä¸ä¼šå¸¦ä¸Šå‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œä¸€èˆ¬åªåŒ…æ‹¬å‡½æ•°åã€‚ è¿™ä¸ªåŠŸèƒ½ååˆ†æœ‰ç”¨ï¼Œå› ä¸ºåœ¨C++å‡ºç°ä»¥å‰ï¼Œå¾ˆå¤šä»£ç (åŒ…æ‹¬å¾ˆå¤šåº•å±‚çš„åº“)éƒ½æ˜¯Cè¯­è¨€å†™çš„ï¼Œä¸ºäº†æ›´å¥½åœ°æ”¯æŒåŸæ¥çš„Cä»£ç å’Œå·²ç»å†™å¥½çš„Cè¯­è¨€åº“ï¼Œéœ€è¦åœ¨C++ä¸­å°½å¯èƒ½çš„æ”¯æŒCï¼Œè€Œextern \"C\"å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªç­–ç•¥ã€‚ åœ¨å¤šä¸ªäººååŒå¼€å‘æ—¶ï¼Œå¯èƒ½æœ‰çš„äººæ¯”è¾ƒæ“…é•¿Cè¯­è¨€ï¼Œè€Œæœ‰çš„äººæ“…é•¿C++ï¼Œè¿™æ ·çš„æƒ…å†µä¸‹ä¹Ÿä¼šå‡ºç°åœ¨C++çš„ä»£ç ä¸­è°ƒç”¨Cè¯­è¨€ä»£ç çš„æƒ…å†µã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:14","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.15Â è¯·ä½ æ¥è¯´ä¸€ä¸‹C++ä¸­structå’Œclassçš„åŒºåˆ« åœ¨C++ä¸­ï¼Œclasså’Œstructåšç±»å‹å®šä¹‰æ˜¯åªæœ‰ä¸¤ç‚¹åŒºåˆ«ï¼š â‘ é»˜è®¤ç»§æ‰¿æƒé™ä¸åŒï¼Œclassç»§æ‰¿é»˜è®¤æ˜¯privateç»§æ‰¿ï¼Œè€Œstructé»˜è®¤æ˜¯publicç»§æ‰¿ â‘¡classè¿˜å¯ç”¨äºå®šä¹‰æ¨¡æ¿å‚æ•°ï¼Œåƒtypenameï¼Œä½†æ˜¯å…³é”®å­—structä¸èƒ½ç”¨äºå®šä¹‰æ¨¡æ¿å‚æ•° â‘¢C++ä¿ç•™structå…³é”®å­—ï¼ŒåŸå› : ä¿è¯ä¸Cè¯­è¨€çš„å‘ä¸‹å…¼å®¹æ€§ï¼ŒC++å¿…é¡»æä¾›ä¸€ä¸ªstruct â‘£C++ä¸­çš„structå®šä¹‰å¿…é¡»ç™¾åˆ†ç™¾åœ°ä¿è¯ä¸Cè¯­è¨€ä¸­çš„structçš„å‘ä¸‹å…¼å®¹æ€§ï¼ŒæŠŠC++ä¸­çš„æœ€åŸºæœ¬çš„å¯¹è±¡å•å…ƒè§„å®šä¸ºclassè€Œä¸æ˜¯structï¼Œå°±æ˜¯ä¸ºäº†é¿å…å„ç§å…¼å®¹æ€§è¦æ±‚çš„é™åˆ¶ â‘¤å¯¹structå®šä¹‰çš„æ‰©å±•ä½¿Cè¯­è¨€çš„ä»£ç èƒ½å¤Ÿæ›´å®¹æ˜“çš„è¢«ç§»æ¤åˆ°C++ä¸­ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:15","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.16Â C++ç±»å†…å¯ä»¥å®šä¹‰å¼•ç”¨æ•°æ®æˆå‘˜å—ï¼Ÿ å¯ä»¥ï¼Œå¿…é¡»é€šè¿‡æˆå‘˜å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ–ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:16","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.17Â C++ä¸­ç±»æˆå‘˜çš„è®¿é—®æƒé™ â‘ C++é€šè¿‡ publicã€protectedã€private ä¸‰ä¸ªå…³é”®å­—æ¥æ§åˆ¶æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°çš„è®¿é—®æƒé™ï¼Œå®ƒä»¬åˆ†åˆ«è¡¨ç¤ºå…¬æœ‰çš„ã€å—ä¿æŠ¤çš„ã€ç§æœ‰çš„ï¼Œè¢«ç§°ä¸ºæˆå‘˜è®¿é—®é™å®šç¬¦ã€‚ â‘¡åœ¨ç±»çš„å†…éƒ¨(å®šä¹‰ç±»çš„ä»£ç å†…éƒ¨)ï¼Œæ— è®ºæˆå‘˜è¢«å£°æ˜ä¸º publicã€protected è¿˜æ˜¯ privateï¼Œéƒ½æ˜¯å¯ä»¥äº’ç›¸è®¿é—®çš„ï¼Œæ²¡æœ‰è®¿é—®æƒé™çš„é™åˆ¶ã€‚ â‘¢åœ¨ç±»çš„å¤–éƒ¨(å®šä¹‰ç±»çš„ä»£ç ä¹‹å¤–)ï¼Œåªèƒ½é€šè¿‡å¯¹è±¡è®¿é—®æˆå‘˜ï¼Œå¹¶ä¸”é€šè¿‡å¯¹è±¡åªèƒ½è®¿é—® public å±æ€§çš„æˆå‘˜ï¼Œä¸èƒ½è®¿é—® privateã€protected å±æ€§çš„æˆå‘˜ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:17","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.18Â ä»€ä¹ˆæ˜¯å³å€¼å¼•ç”¨ï¼Œè·Ÿå·¦å€¼åˆæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å·¦å€¼å’Œå³å€¼çš„æ¦‚å¿µ: â‘ å·¦å€¼: èƒ½å–åœ°å€ï¼Œæˆ–è€…å…·åå¯¹è±¡ï¼Œè¡¨è¾¾å¼ç»“æŸåä¾ç„¶å­˜åœ¨çš„æŒä¹…å¯¹è±¡ï¼› å³å€¼: ä¸èƒ½å–åœ°å€ï¼ŒåŒ¿åå¯¹è±¡ï¼Œè¡¨è¾¾å¼ç»“æŸåå°±ä¸å†å­˜åœ¨çš„ä¸´æ—¶å¯¹è±¡ï¼› â‘¡åŒºåˆ«: å·¦å€¼èƒ½å¯»å€ï¼Œå³å€¼ä¸èƒ½; å·¦å€¼èƒ½èµ‹å€¼ï¼Œå³å€¼ä¸èƒ½; å·¦å€¼å¯å˜ï¼Œå³å€¼ä¸èƒ½(ä»…å¯¹åŸºç¡€ç±»å‹é€‚ç”¨ï¼Œç”¨æˆ·è‡ªå®šä¹‰ç±»å‹å³å€¼å¼•ç”¨å¯ä»¥é€šè¿‡æˆå‘˜å‡½æ•°æ”¹å˜); ","date":"2023-07-11","objectID":"/posts/basics_one/:3:18","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.19Â é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹å¾ å°è£…æ€§: å°†å®¢è§‚äº‹ç‰©æŠ½è±¡æˆç±»ï¼Œæ¯ä¸ªç±»å¯¹è‡ªèº«çš„æ•°æ®å’Œæ–¹æ³•å®è¡Œè®¿é—®æƒé™ä¿æŠ¤(private ï¼Œ protected ï¼Œ public)ã€‚ ç»§æ‰¿æ€§: å¹¿ä¹‰çš„ç»§æ‰¿æœ‰ä¸‰ç§å®ç°å½¢å¼ï¼šå®ç°ç»§æ‰¿(ä½¿ç”¨åŸºç±»çš„å±æ€§å’Œæ–¹æ³•è€Œæ— éœ€é¢å¤–ç¼–ç çš„èƒ½åŠ›)ã€å¯è§†ç»§æ‰¿(å­çª—ä½“ä½¿ç”¨çˆ¶çª—ä½“çš„å¤–è§‚å’Œå®ç°ä»£ç )ã€æ¥å£ç»§æ‰¿(ä»…ä½¿ç”¨å±æ€§å’Œæ–¹æ³•,å®ç°æ»ååˆ°å­ç±»å®ç°)ã€‚ å¤šæ€æ€§: æ˜¯å°†çˆ¶ç±»å¯¹è±¡è®¾ç½®æˆä¸ºå’Œä¸€ä¸ªæˆ–æ›´å¤šå®ƒçš„å­å¯¹è±¡ç›¸ç­‰çš„æŠ€æœ¯ã€‚ç”¨å­ç±»å¯¹è±¡ç»™çˆ¶ç±»å¯¹è±¡èµ‹å€¼ä¹‹åï¼Œçˆ¶ç±»å¯¹è±¡å°±å¯ä»¥æ ¹æ®å½“å‰èµ‹å€¼ç»™å®ƒçš„å­å¯¹è±¡çš„ç‰¹æ€§ä»¥ä¸åŒçš„æ–¹å¼è¿ä½œã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:19","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"3.20Â C++çš„ç©ºç±»æœ‰å“ªäº›æˆå‘˜å‡½æ•° C++ç©ºç±»æˆå‘˜å‡½æ•°ï¼š ç¼ºçœæ„é€ å‡½æ•°ã€‚ ç¼ºçœæ‹·è´æ„é€ å‡½æ•°ã€‚ ç¼ºçœææ„å‡½æ•°ã€‚ ç¼ºçœèµ‹å€¼è¿ç®—ç¬¦ã€‚ ç¼ºçœå–å€è¿ç®—ç¬¦ã€‚ ç¼ºçœå–å€è¿ç®—ç¬¦ const ã€‚ æ³¨æ„ï¼šæœ‰äº›ä¹¦ä¸Šåªæ˜¯ç®€å•çš„ä»‹ç»äº†å‰å››ä¸ªå‡½æ•°ã€‚æ²¡æœ‰æåŠåé¢è¿™ä¸¤ä¸ªå‡½æ•°ã€‚ä½†åé¢è¿™ä¸¤ä¸ªå‡½æ•°ä¹Ÿæ˜¯ç©ºç±»çš„é»˜è®¤å‡½æ•°ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰å½“å®é™…ä½¿ç”¨è¿™äº›ç©ºç±»æˆå‘˜å‡½æ•°çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨æ‰ä¼šå»å®šä¹‰å®ƒä»¬ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:3:20","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4. åŸºç¡€çŸ¥è¯†(å››) ","date":"2023-07-11","objectID":"/posts/basics_one/:4:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.1 è¯´ä¸€è¯´c++ä¸­å››ç§castè½¬æ¢ C++ä¸­å››ç§ç±»å‹è½¬æ¢æ˜¯ï¼šstatic_cast, dynamic_cast, const_cast, reinterpret_cast 1ã€const_cast ç”¨äºå°†constå˜é‡è½¬ä¸ºéconst, å»é™¤constå±æ€§ 2ã€static_cast ç”¨äºå„ç§éšå¼è½¬æ¢ï¼Œæ¯”å¦‚éconstè½¬constï¼Œvoid*è½¬æŒ‡é’ˆç­‰, static_castèƒ½ç”¨äºå¤šæ€å‘ä¸Šè½¬åŒ–ï¼Œå¦‚æœå‘ä¸‹è½¬èƒ½æˆåŠŸä½†æ˜¯ä¸å®‰å…¨ï¼Œç»“æœæœªçŸ¥ï¼› 3ã€dynamic_cast ç”¨äºåŠ¨æ€ç±»å‹è½¬æ¢ã€‚åªèƒ½ç”¨äºå«æœ‰è™šå‡½æ•°çš„ç±»ï¼Œç”¨äºç±»å±‚æ¬¡é—´çš„å‘ä¸Šå’Œå‘ä¸‹è½¬åŒ–ã€‚åªèƒ½è½¬æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚å‘ä¸‹è½¬åŒ–æ—¶ï¼Œå¦‚æœæ˜¯éæ³•çš„ï¼Œå¯¹äºæŒ‡é’ˆè¿”å›NULLï¼Œå¯¹äºå¼•ç”¨æŠ›å¼‚å¸¸ã€‚è¦æ·±å…¥äº†è§£å†…éƒ¨è½¬æ¢çš„åŸç†ã€‚ å‘ä¸Šè½¬æ¢ï¼šæŒ‡çš„æ˜¯å­ç±»å‘åŸºç±»çš„è½¬æ¢ å‘ä¸‹è½¬æ¢ï¼šæŒ‡çš„æ˜¯åŸºç±»å‘å­ç±»çš„è½¬æ¢ å®ƒé€šè¿‡åˆ¤æ–­åœ¨æ‰§è¡Œåˆ°è¯¥è¯­å¥çš„æ—¶å€™å˜é‡çš„è¿è¡Œæ—¶ç±»å‹å’Œè¦è½¬æ¢çš„ç±»å‹æ˜¯å¦ç›¸åŒæ¥åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œå‘ä¸‹è½¬æ¢ã€‚ 4ã€reinterpret_cast å‡ ä¹ä»€ä¹ˆéƒ½å¯ä»¥è½¬ï¼Œæ¯”å¦‚å°†intè½¬æŒ‡é’ˆï¼Œå¯èƒ½ä¼šå‡ºé—®é¢˜ï¼Œå°½é‡å°‘ç”¨ï¼› 5ã€ä¸ºä»€ä¹ˆä¸ä½¿ç”¨Cçš„å¼ºåˆ¶è½¬æ¢ï¼Ÿ Cçš„å¼ºåˆ¶è½¬æ¢è¡¨é¢ä¸Šçœ‹èµ·æ¥åŠŸèƒ½å¼ºå¤§ä»€ä¹ˆéƒ½èƒ½è½¬ï¼Œä½†æ˜¯è½¬åŒ–ä¸å¤Ÿæ˜ç¡®ï¼Œä¸èƒ½è¿›è¡Œé”™è¯¯æ£€æŸ¥ï¼Œå®¹æ˜“å‡ºé”™ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:1","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.2 å¯¹c++ä¸­çš„smart pointerå››ä¸ªæ™ºèƒ½æŒ‡é’ˆçš„ç†è§£ï¼šshared_ptr,unique_ptr,weak_ptr,auto_ptr â‘ C++é‡Œé¢çš„å››ä¸ªæ™ºèƒ½æŒ‡é’ˆ: auto_ptr, shared_ptr, weak_ptr, unique_ptr å…¶ä¸­åä¸‰ä¸ªæ˜¯c++11æ”¯æŒï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªå·²ç»è¢«C++11å¼ƒç”¨ã€‚ â‘¡æ™ºèƒ½æŒ‡é’ˆçš„ä½œç”¨æ˜¯ç®¡ç†ä¸€ä¸ªæŒ‡é’ˆï¼Œå› ä¸ºå­˜åœ¨ä»¥ä¸‹è¿™ç§æƒ…å†µï¼š ç”³è¯·çš„ç©ºé—´åœ¨å‡½æ•°ç»“æŸæ—¶å¿˜è®°é‡Šæ”¾ï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šçš„é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ™ºèƒ½æŒ‡é’ˆå°±æ˜¯ä¸€ä¸ªç±»ï¼Œå½“è¶…å‡ºäº†ç±»çš„ä½œç”¨åŸŸæ—¶ï¼Œç±»ä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ï¼Œææ„å‡½æ•°ä¼šè‡ªåŠ¨é‡Šæ”¾èµ„æºã€‚æ‰€ä»¥æ™ºèƒ½æŒ‡é’ˆçš„ä½œç”¨åŸç†å°±æ˜¯åœ¨å‡½æ•°ç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾å†…å­˜ç©ºé—´ã€‚ â‘¢auto_ptr(c++98çš„æ–¹æ¡ˆï¼Œcpp11å·²ç»æŠ›å¼ƒ) é‡‡ç”¨æ‰€æœ‰æƒæ¨¡å¼ã€‚ unique_ptr p3 (new string (â€œautoâ€)); //#4 unique_ptr p4ï¼› //#5 p4 = p3;//æ­¤æ—¶ä¼šæŠ¥é”™ï¼ï¼ ç¼–è¯‘å™¨è®¤ä¸ºp4=p3éæ³•ï¼Œé¿å…äº†p3ä¸å†æŒ‡å‘æœ‰æ•ˆæ•°æ®çš„é—®é¢˜ã€‚å› æ­¤ï¼Œunique_ptræ¯”auto_ptræ›´å®‰å…¨ã€‚ å¦å¤–unique_ptrè¿˜æœ‰æ›´èªæ˜çš„åœ°æ–¹ï¼šå½“ç¨‹åºè¯•å›¾å°†ä¸€ä¸ª unique_ptr èµ‹å€¼ç»™å¦ä¸€ä¸ªæ—¶ï¼Œå¦‚æœæº unique_ptr æ˜¯ä¸ªä¸´æ—¶å³å€¼ï¼Œç¼–è¯‘å™¨å…è®¸è¿™ä¹ˆåšï¼›å¦‚æœæº unique_ptr å°†å­˜åœ¨ä¸€æ®µæ—¶é—´ï¼Œç¼–è¯‘å™¨å°†ç¦æ­¢è¿™ä¹ˆåšï¼Œæ¯”å¦‚: unique_ptr pu1(new string (â€œhello worldâ€)); unique_ptr pu2; pu2 = pu1; // #1 not allowed unique_ptr pu3; pu3 = unique_ptr(new string (â€œYouâ€)); // #2 allowed å…¶ä¸­#1ç•™ä¸‹æ‚¬æŒ‚çš„ unique_ptr(pu1)ï¼Œè¿™å¯èƒ½å¯¼è‡´å±å®³ã€‚è€Œ#2ä¸ä¼šç•™ä¸‹æ‚¬æŒ‚çš„unique_ptrï¼Œå› ä¸ºå®ƒè°ƒç”¨ unique_ptr çš„æ„é€ å‡½æ•°ï¼Œè¯¥æ„é€ å‡½æ•°åˆ›å»ºçš„ä¸´æ—¶å¯¹è±¡åœ¨å…¶æ‰€æœ‰æƒè®©ç»™ pu3 åå°±ä¼šè¢«é”€æ¯ã€‚è¿™ç§éšæƒ…å†µè€Œå·²çš„è¡Œä¸ºè¡¨æ˜ï¼Œunique_ptr ä¼˜äºå…è®¸ä¸¤ç§èµ‹å€¼çš„auto_ptr ã€‚ æ³¨ï¼šå¦‚æœç¡®å®æƒ³æ‰§è¡Œç±»ä¼¼ä¸#1çš„æ“ä½œï¼Œè¦å®‰å…¨çš„é‡ç”¨è¿™ç§æŒ‡é’ˆï¼Œå¯ç»™å®ƒèµ‹æ–°å€¼ã€‚C++æœ‰ä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°std::move()ï¼Œè®©ä½ èƒ½å¤Ÿå°†ä¸€ä¸ªunique_ptrèµ‹ç»™å¦ä¸€ä¸ªã€‚ä¾‹å¦‚ï¼š unique_ptr ps1, ps2; ps1 = demo(â€œhelloâ€); ps2 = move(ps1); ps1 = demo(â€œalexiaâ€); cout \u003c\u003c *ps2 \u003c\u003c *ps1 \u003c\u003c endl; shared_ptrå®ç°å…±äº«å¼æ‹¥æœ‰æ¦‚å¿µã€‚å¤šä¸ªæ™ºèƒ½æŒ‡é’ˆå¯ä»¥æŒ‡å‘ç›¸åŒå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å’Œå…¶ç›¸å…³èµ„æºä¼šåœ¨â€œæœ€åä¸€ä¸ªå¼•ç”¨è¢«é”€æ¯â€æ—¶å€™é‡Šæ”¾ã€‚ä»åå­—shareå°±å¯ä»¥çœ‹å‡ºäº†èµ„æºå¯ä»¥è¢«å¤šä¸ªæŒ‡é’ˆå…±äº«ï¼Œå®ƒä½¿ç”¨è®¡æ•°æœºåˆ¶æ¥è¡¨æ˜èµ„æºè¢«å‡ ä¸ªæŒ‡é’ˆå…±äº«ã€‚å¯ä»¥é€šè¿‡æˆå‘˜å‡½æ•°use_count()æ¥æŸ¥çœ‹èµ„æºçš„æ‰€æœ‰è€…ä¸ªæ•°ã€‚é™¤äº†å¯ä»¥é€šè¿‡newæ¥æ„é€ ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¼ å…¥auto_ptr, unique_ptr,weak_ptræ¥æ„é€ ã€‚å½“æˆ‘ä»¬è°ƒç”¨release()æ—¶ï¼Œå½“å‰æŒ‡é’ˆä¼šé‡Šæ”¾èµ„æºæ‰€æœ‰æƒï¼Œè®¡æ•°å‡ä¸€ã€‚å½“è®¡æ•°ç­‰äº0æ—¶ï¼Œèµ„æºä¼šè¢«é‡Šæ”¾ã€‚ shared_ptr æ˜¯ä¸ºäº†è§£å†³ auto_ptr åœ¨å¯¹è±¡æ‰€æœ‰æƒä¸Šçš„å±€é™æ€§(auto_ptr æ˜¯ç‹¬å çš„), åœ¨ä½¿ç”¨å¼•ç”¨è®¡æ•°çš„æœºåˆ¶ä¸Šæä¾›äº†å¯ä»¥å…±äº«æ‰€æœ‰æƒçš„æ™ºèƒ½æŒ‡é’ˆã€‚ æˆå‘˜å‡½æ•°ï¼š use_count è¿”å›å¼•ç”¨è®¡æ•°çš„ä¸ªæ•° unique è¿”å›æ˜¯å¦æ˜¯ç‹¬å æ‰€æœ‰æƒ( use_count ä¸º 1) swap äº¤æ¢ä¸¤ä¸ª shared_ptr å¯¹è±¡(å³äº¤æ¢æ‰€æ‹¥æœ‰çš„å¯¹è±¡) reset æ”¾å¼ƒå†…éƒ¨å¯¹è±¡çš„æ‰€æœ‰æƒæˆ–æ‹¥æœ‰å¯¹è±¡çš„å˜æ›´, ä¼šå¼•èµ·åŸæœ‰å¯¹è±¡çš„å¼•ç”¨è®¡æ•°çš„å‡å°‘ get è¿”å›å†…éƒ¨å¯¹è±¡(æŒ‡é’ˆ), ç”±äºå·²ç»é‡è½½äº†()æ–¹æ³•, å› æ­¤å’Œç›´æ¥ä½¿ç”¨å¯¹è±¡æ˜¯ä¸€æ ·çš„.å¦‚ shared_ptr sp(new int(1)); sp ä¸ sp.get()æ˜¯ç­‰ä»·çš„ weak_ptr: weak_ptr æ˜¯ä¸€ç§ä¸æ§åˆ¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„æ™ºèƒ½æŒ‡é’ˆ, å®ƒæŒ‡å‘ä¸€ä¸ª shared_ptr ç®¡ç†çš„å¯¹è±¡. å¯¹è¯¥å¯¹è±¡è¿›è¡Œå†…å­˜ç®¡ç†çš„æ˜¯é‚£ä¸ªå¼ºå¼•ç”¨çš„shared_ptr. weak_ptråªæ˜¯æä¾›äº†å¯¹ç®¡ç†å¯¹è±¡çš„ä¸€ä¸ªè®¿é—®æ‰‹æ®µã€‚ weak_ptr è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†é…åˆ shared_ptr è€Œå¼•å…¥çš„ä¸€ç§æ™ºèƒ½æŒ‡é’ˆæ¥ååŠ© shared_ptr å·¥ä½œ, å®ƒåªå¯ä»¥ä»ä¸€ä¸ª shared_ptr æˆ–å¦ä¸€ä¸ª weak_ptr å¯¹è±¡æ„é€ , å®ƒçš„æ„é€ å’Œææ„ä¸ä¼šå¼•èµ·å¼•ç”¨è®°æ•°çš„å¢åŠ æˆ–å‡å°‘ã€‚ weak_ptræ˜¯ç”¨æ¥è§£å†³shared_ptrç›¸äº’å¼•ç”¨æ—¶çš„æ­»é”é—®é¢˜,å¦‚æœè¯´ä¸¤ä¸ªshared_ptrç›¸äº’å¼•ç”¨,é‚£ä¹ˆè¿™ä¸¤ä¸ªæŒ‡é’ˆçš„å¼•ç”¨è®¡æ•°æ°¸è¿œä¸å¯èƒ½ä¸‹é™ä¸º0,èµ„æºæ°¸è¿œä¸ä¼šé‡Šæ”¾ã€‚å®ƒæ˜¯å¯¹å¯¹è±¡çš„ä¸€ç§å¼±å¼•ç”¨ï¼Œä¸ä¼šå¢åŠ å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œå’Œshared_pträ¹‹é—´å¯ä»¥ç›¸äº’è½¬åŒ–ï¼Œshared_ptrå¯ä»¥ç›´æ¥èµ‹å€¼ç»™å®ƒï¼Œå®ƒå¯ä»¥é€šè¿‡è°ƒç”¨lockå‡½æ•°æ¥è·å¾—shared_ptrã€‚ class B; class A { public: shared_ptr\u003cB\u003e pb_; ~A(){ cout\u003c\u003c\"A delete\"; } }; class B { public: shared_ptr\u003cA\u003e pa_; ~B(){ cout\u003c\u003c\"B delete\"; } }; void fun() { shared_ptr\u003cB\u003e pb(new B()); shared_ptr\u003cA\u003e pa(new A()); pb-\u003epa_ = pa; pa-\u003epb_ = pb; cout \u003c\u003c pb.use_count() \u003c\u003c endl; cout \u003c\u003c pa.use_count() \u003c\u003c endl; } int main() { fun(); return 0; } å¯ä»¥çœ‹åˆ°funå‡½æ•°ä¸­pa ï¼Œpbä¹‹é—´äº’ç›¸å¼•ç”¨ï¼Œä¸¤ä¸ªèµ„æºçš„å¼•ç”¨è®¡æ•°ä¸º2ï¼Œå½“è¦è·³å‡ºå‡½æ•°æ—¶ï¼Œæ™ºèƒ½æŒ‡é’ˆpaï¼Œpbææ„æ—¶ä¸¤ä¸ªèµ„æºå¼•ç”¨è®¡æ•°ä¼šå‡ä¸€ï¼Œä½†æ˜¯ä¸¤è€…å¼•ç”¨è®¡æ•°è¿˜æ˜¯ä¸º1ï¼Œå¯¼è‡´è·³å‡ºå‡½æ•°æ—¶èµ„æºæ²¡æœ‰è¢«é‡Šæ”¾(A Bçš„ææ„å‡½æ•°æ²¡æœ‰è¢«è°ƒç”¨)ï¼Œå¦‚æœæŠŠå…¶ä¸­ä¸€ä¸ªæ”¹ä¸ºweak_ptrå°±å¯ä»¥äº†ï¼Œæˆ‘ä»¬æŠŠç±»Aé‡Œé¢çš„shared_ptr pb_; æ”¹ä¸ºweak_ptr pb_; è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œè¿™æ ·çš„è¯ï¼Œèµ„æºBçš„å¼•ç”¨å¼€å§‹å°±åªæœ‰1ï¼Œå½“pbææ„æ—¶ï¼ŒBçš„è®¡æ•°å˜ä¸º0ï¼ŒBå¾—åˆ°é‡Šæ”¾ï¼ŒBé‡Šæ”¾çš„åŒæ—¶ä¹Ÿä¼šä½¿Açš„è®¡æ•°å‡ä¸€ï¼ŒåŒæ—¶paææ„æ—¶ä½¿Açš„è®¡æ•°å‡ä¸€ï¼Œé‚£ä¹ˆAçš„è®¡æ•°ä¸º0ï¼ŒAå¾—åˆ°é‡Šæ”¾ã€‚ æ³¨æ„ï¼šä¸èƒ½é€šè¿‡weak_ptrç›´æ¥è®¿é—®å¯¹è±¡çš„æ–¹æ³•ï¼Œæ¯”å¦‚Bå¯¹è±¡ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•print(),æˆ‘ä»¬ä¸èƒ½è¿™æ ·è®¿é—®ï¼Œpa-\u003epb_-\u003eprint(); è‹±æ–‡pb_æ˜¯ä¸€ä¸ªweak_ptrï¼Œåº”è¯¥å…ˆæŠŠå®ƒè½¬åŒ–ä¸ºshared_ptr,å¦‚ï¼šshared_ptr p = pa-\u003epb_.lock(); p-\u003eprint(); ","date":"2023-07-11","objectID":"/posts/basics_one/:4:2","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.3 è¯´è¯´å¼ºåˆ¶ç±»å‹è½¬æ¢è¿ç®—ç¬¦ â‘ static_castÂ ç”¨äºéå¤šæ€ç±»å‹çš„è½¬æ¢ ç”¨äºéå¤šæ€ç±»å‹çš„è½¬æ¢ ä¸æ‰§è¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥(è½¬æ¢å®‰å…¨æ€§ä¸å¦‚ dynamic_cast) é€šå¸¸ç”¨äºè½¬æ¢æ•°å€¼æ•°æ®ç±»å‹(å¦‚ float -\u003e int) å¯ä»¥åœ¨æ•´ä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­ç§»åŠ¨æŒ‡é’ˆï¼Œå­ç±»è½¬åŒ–ä¸ºçˆ¶ç±»å®‰å…¨(å‘ä¸Šè½¬æ¢)ï¼Œçˆ¶ç±»è½¬åŒ–ä¸ºå­ç±»ä¸å®‰å…¨(å› ä¸ºå­ç±»å¯èƒ½æœ‰ä¸åœ¨çˆ¶ç±»çš„å­—æ®µæˆ–æ–¹æ³•) â‘¡dynamic_castÂ ç”¨äºå¤šæ€ç±»å‹çš„è½¬æ¢ ç”¨äºå¤šæ€ç±»å‹çš„è½¬æ¢ æ‰§è¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ åªé€‚ç”¨äºæŒ‡é’ˆæˆ–å¼•ç”¨ å¯¹ä¸æ˜ç¡®çš„æŒ‡é’ˆçš„è½¬æ¢å°†å¤±è´¥(è¿”å› nullptr)ï¼Œä½†ä¸å¼•å‘å¼‚å¸¸ å¯ä»¥åœ¨æ•´ä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­ç§»åŠ¨æŒ‡é’ˆï¼ŒåŒ…æ‹¬å‘ä¸Šè½¬æ¢ã€å‘ä¸‹è½¬æ¢ â‘¢const_cast ç”¨äºåˆ é™¤ constã€volatile å’Œ __unaligned ç‰¹æ€§(å¦‚å°† const int ç±»å‹è½¬æ¢ä¸º int ç±»å‹ ) â‘£reinterpret_cast ç”¨äºä½çš„ç®€å•é‡æ–°è§£é‡Š æ»¥ç”¨ reinterpret_cast è¿ç®—ç¬¦å®¹æ˜“å¸¦æ¥é£é™©ã€‚é™¤éæ‰€éœ€è½¬æ¢æœ¬èº«æ˜¯ä½çº§åˆ«çš„ï¼Œå¦åˆ™åº”ä½¿ç”¨å…¶ä»–å¼ºåˆ¶è½¬æ¢è¿ç®—ç¬¦ä¹‹ä¸€ã€‚ å…è®¸å°†ä»»ä½•æŒ‡é’ˆè½¬æ¢ä¸ºä»»ä½•å…¶ä»–æŒ‡é’ˆç±»å‹(å¦‚ char* åˆ° int* æˆ– One_class* åˆ° Unrelated_class* ä¹‹ç±»çš„è½¬æ¢ï¼Œä½†å…¶æœ¬èº«å¹¶ä¸å®‰å…¨) ä¹Ÿå…è®¸å°†ä»»ä½•æ•´æ•°ç±»å‹è½¬æ¢ä¸ºä»»ä½•æŒ‡é’ˆç±»å‹ä»¥åŠåå‘è½¬æ¢ã€‚ reinterpret_cast è¿ç®—ç¬¦ä¸èƒ½ä¸¢æ‰ constã€volatile æˆ– __unaligned ç‰¹æ€§ã€‚ reinterpret_cast çš„ä¸€ä¸ªå®é™…ç”¨é€”æ˜¯åœ¨å“ˆå¸Œå‡½æ•°ä¸­ï¼Œå³ï¼Œé€šè¿‡è®©ä¸¤ä¸ªä¸åŒçš„å€¼å‡ ä¹ä¸ä»¥ç›¸åŒçš„ç´¢å¼•ç»“å°¾çš„æ–¹å¼å°†å€¼æ˜ å°„åˆ°ç´¢å¼•ã€‚ â‘¤bad_castè½¬æ¢å¤±è´¥å¼‚å¸¸ ç”±äºå¼ºåˆ¶è½¬æ¢ä¸ºå¼•ç”¨ç±»å‹å¤±è´¥ï¼Œdynamic_cast è¿ç®—ç¬¦å¼•å‘ bad_cast å¼‚å¸¸ã€‚ bad_cast ä½¿ç”¨: try { Circle\u0026 ref_circle = dynamic_cast\u003cCircle\u0026\u003e(ref_shape); } catch (bad_cast b) { cout \u003c\u003c \"Caught: \" \u003c\u003c b.what(); } ","date":"2023-07-11","objectID":"/posts/basics_one/:4:3","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.4 è°ˆè°ˆä½ å¯¹æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦çš„è®¤è¯† æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦é‡è½½æœ‰ä»¥ä¸‹ä¸¤ä¸ªä¸åŒä¹‹å¤„ï¼š â‘ æ‹·è´æ„é€ å‡½æ•°ç”Ÿæˆæ–°çš„ç±»å¯¹è±¡ï¼Œè€Œèµ‹å€¼è¿ç®—ç¬¦ä¸èƒ½ã€‚ â‘¡ç”±äºæ‹·è´æ„é€ å‡½æ•°æ˜¯ç›´æ¥æ„é€ ä¸€ä¸ªæ–°çš„ç±»å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨åˆå§‹åŒ–è¿™ä¸ªå¯¹è±¡ä¹‹å‰ä¸ç”¨æ£€éªŒåŸå¯¹è±¡æ˜¯å¦å’Œæ–°å»ºå¯¹è±¡ç›¸åŒï¼Œè€Œèµ‹å€¼è¿ç®—ç¬¦åˆ™éœ€è¦è¿™ä¸ªæ“ä½œ; â‘¢å¦å¤–ï¼Œèµ‹å€¼è¿ç®—ä¸­ï¼Œå¦‚æœåŸæ¥çš„å¯¹è±¡ä¸­æœ‰å†…å­˜åˆ†é…è¦å…ˆæŠŠå†…å­˜é‡Šæ”¾æ‰ã€‚ æ³¨æ„ï¼šå½“æœ‰ç±»ä¸­æœ‰æŒ‡é’ˆç±»å‹çš„æˆå‘˜å˜é‡æ—¶ï¼Œä¸€å®šè¦é‡å†™æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼Œä¸è¦ä½¿ç”¨é»˜è®¤çš„ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:4","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.5 åœ¨C++ä¸­ï¼Œä½¿ç”¨mallocç”³è¯·çš„å†…å­˜èƒ½å¦é€šè¿‡deleteé‡Šæ”¾ï¼Ÿä½¿ç”¨newç”³è¯·çš„å†…å­˜èƒ½å¦ç”¨freeï¼Ÿ ä¸èƒ½ï¼Œmalloc /freeä¸»è¦ä¸ºäº†å…¼å®¹Cï¼Œnewå’Œdelete å®Œå…¨å¯ä»¥å–ä»£malloc /freeçš„ã€‚ â‘ malloc /freeçš„æ“ä½œå¯¹è±¡éƒ½æ˜¯å¿…é¡»æ˜ç¡®å¤§å°çš„ã€‚è€Œä¸”ä¸èƒ½ç”¨åœ¨åŠ¨æ€ç±»ä¸Šã€‚ â‘¡new å’Œdeleteä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹æ£€æŸ¥å’Œå¤§å°ï¼Œmalloc/freeä¸èƒ½æ‰§è¡Œæ„é€ å‡½æ•°ä¸ææ„å‡½æ•°ï¼Œæ‰€ä»¥åŠ¨æ€å¯¹è±¡å®ƒæ˜¯ä¸è¡Œçš„ã€‚ å½“ç„¶ä»ç†è®ºä¸Šè¯´ä½¿ç”¨mallocç”³è¯·çš„å†…å­˜æ˜¯å¯ä»¥é€šè¿‡deleteé‡Šæ”¾çš„ã€‚ä¸è¿‡ä¸€èˆ¬ä¸è¿™æ ·å†™çš„ã€‚è€Œä¸”ä¹Ÿä¸èƒ½ä¿è¯æ¯ä¸ªC++çš„è¿è¡Œæ—¶éƒ½èƒ½æ­£å¸¸ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:5","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.6 ç”¨C++è®¾è®¡ä¸€ä¸ªä¸èƒ½è¢«ç»§æ‰¿çš„ç±» ref: https://blog.csdn.net/wei_cheng18/article/details/81043858 template \u003ctypename T\u003e class A { friend T; private: A() {} ~A() {} }; class B : virtual public A\u003cB\u003e { public: B() {} ~B() {} }; class C : virtual public B{ public: C() {} ~C() {} }; void main( void ) { B b; //C c; return; } æ³¨æ„ï¼šæ„é€ å‡½æ•°æ˜¯å®ç°ç»§æ‰¿çš„å…³é”®ï¼Œæ¯æ¬¡å­ç±»å¯¹è±¡æ„é€ æ—¶ï¼Œé¦–å…ˆè°ƒç”¨çš„æ˜¯çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œç„¶åæ‰æ˜¯è‡ªå·±çš„ã€‚å®ç°ä¸èƒ½è¢«ç»§æ‰¿çš„ç±»å…³é”®åœ¨äºæƒ³çˆ¶ç±»çš„æ„é€ å‡½æ•°ä½¿ç”¨privateæ§åˆ¶ è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼šæˆ‘ä»¬è®¾è®¡çš„ä¸èƒ½è¢«ç»§æ‰¿çš„ç±»Bå¯¹åŸºç±»Açš„ç»§æ‰¿å¿…é¡»æ˜¯è™šç»§æ‰¿ï¼Œè¿™æ ·ä¸€æ¥Cç±»ç»§æ‰¿Bç±»æ—¶ä¼šå»ç›´æ¥è°ƒç”¨Açš„æ„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯åƒæ™®é€šç»§æ‰¿é‚£æ ·ï¼Œå…ˆè°ƒç”¨Bçš„æ„é€ å‡½æ•°å†è°ƒç”¨Açš„æ„é€ å‡½æ•°ï¼› Cç±»ç›´æ¥è°ƒç”¨Aç±»çš„æ„é€ å‡½æ•°ï¼Œç”±äºAç±»çš„æ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„ï¼Œè€ŒBæ˜¯Açš„å‹å…ƒï¼ŒCç±»ä¸æ˜¯Açš„å‹å…ƒï¼Œå‹å…ƒå…³ç³»ä¸ä¼šç»§æ‰¿ï¼Œå› æ­¤ä¼šç¼–è¯‘æŠ¥é”™ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:6","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.8 è®¿é—®åŸºç±»çš„ç§æœ‰è™šå‡½æ•° å†™å‡ºä»¥ä¸‹ç¨‹åºçš„è¾“å‡ºç»“æœï¼š #include \u003ciostream.h\u003e class A { virtual void g() { cout \u003c\u003c \"A::g\" \u003c\u003c endl; } private: virtual void f() { cout \u003c\u003c \"A::f\" \u003c\u003c endl; } }; class B : public A { void g() { cout \u003c\u003c \"B::g\" \u003c\u003c endl; } virtual void h() { cout \u003c\u003c \"B::h\" \u003c\u003c endl; } }; typedef void( *Fun )( void ); void main() { B b; Fun pFun; for(int i = 0 ; i \u003c 3; i++) { pFun = ( Fun )*( ( int* ) * ( int* )( \u0026b ) + i ); pFun(); } } è¾“å‡ºç»“æœ: B::g A::f B::h æ³¨æ„ï¼šè€ƒå¯Ÿäº†é¢è¯•è€…å¯¹è™šå‡½æ•°çš„ç†è§£ç¨‹åº¦ã€‚ä¸€ä¸ªå¯¹è™šå‡½æ•°ä¸äº†è§£çš„äººå¾ˆéš¾æ­£ç¡®çš„åšå‡ºæœ¬é¢˜ã€‚ åœ¨å­¦ä¹ é¢å‘å¯¹è±¡çš„å¤šæ€æ€§æ—¶ä¸€å®šè¦æ·±åˆ»ç†è§£è™šå‡½æ•°è¡¨çš„å·¥ä½œåŸç†ã€‚ è™šå‡½æ•°: é€šè¿‡åŸºç±»è®¿é—®æ´¾ç”Ÿç±»å®šä¹‰çš„å‡½æ•°ï¼Œå¤šæ€æ—¶ä½¿ç”¨ï¼Œä½¿ç”¨è™šå‡½æ•°åŠ ä¸Švirtualå…³é”®å­—ã€‚ è™šå‡½æ•°å°±æ˜¯åœ¨åŸºç±»å®šä¹‰ä¸€ä¸ªæœªå®ç°çš„å‡½æ•°åï¼Œä¸ºäº†æé«˜ç¨‹åºçš„å¯è¯»æ€§ è™šå‡½æ•°è¯¦è§£ C++è™šå‡½æ•°è¯¦è§£_ç–¯ç‹‚çš„éº¦å…‹æ–¯_maxçš„åšå®¢-CSDNåšå®¢_c++è™šå‡½æ•° è±å½¢ç»§æ‰¿1 è±å½¢ç»§æ‰¿2 ","date":"2023-07-11","objectID":"/posts/basics_one/:4:7","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.9 å¯¹è™šå‡½æ•°å’Œå¤šæ€çš„ç†è§£ â‘ å¤šæ€çš„å®ç°ä¸»è¦åˆ†ä¸ºé™æ€å¤šæ€å’ŒåŠ¨æ€å¤šæ€ é™æ€å¤šæ€ä¸»è¦æ˜¯é‡è½½ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™å°±å·²ç»ç¡®å®šï¼› åŠ¨æ€å¤šæ€æ˜¯ç”¨è™šå‡½æ•°æœºåˆ¶å®ç°çš„ï¼Œåœ¨è¿è¡ŒæœŸé—´åŠ¨æ€ç»‘å®šã€‚ ä¸¾ä¸ªä¾‹å­: ä¸€ä¸ªçˆ¶ç±»ç±»å‹çš„æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå­ç±»å¯¹è±¡æ—¶å€™ï¼Œä½¿ç”¨çˆ¶ç±»çš„æŒ‡é’ˆå»è°ƒç”¨å­ç±»ä¸­é‡å†™äº†çš„çˆ¶ç±»ä¸­çš„è™šå‡½æ•°çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨å­ç±»é‡å†™è¿‡åçš„å‡½æ•°ï¼Œåœ¨çˆ¶ç±»ä¸­å£°æ˜ä¸ºåŠ äº†virtualå…³é”®å­—çš„å‡½æ•°ï¼Œåœ¨å­ç±»ä¸­é‡å†™æ—¶å€™ä¸éœ€è¦åŠ virtualä¹Ÿæ˜¯è™šå‡½æ•°ã€‚ â‘¡è™šå‡½æ•°çš„å®ç°: åœ¨æœ‰è™šå‡½æ•°çš„ç±»ä¸­ï¼Œç±»çš„æœ€å¼€å§‹éƒ¨åˆ†æ˜¯ä¸€ä¸ªè™šå‡½æ•°è¡¨çš„æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªè™šå‡½æ•°è¡¨ï¼Œè¡¨ä¸­æ”¾äº†è™šå‡½æ•°çš„åœ°å€ï¼Œå®é™…çš„è™šå‡½æ•°åœ¨ä»£ç æ®µ(.text)ä¸­ã€‚å½“å­ç±»ç»§æ‰¿äº†çˆ¶ç±»çš„æ—¶å€™ä¹Ÿä¼šç»§æ‰¿å…¶è™šå‡½æ•°è¡¨ï¼Œå½“å­ç±»é‡å†™çˆ¶ç±»ä¸­è™šå‡½æ•°æ—¶å€™ï¼Œä¼šå°†å…¶ç»§æ‰¿åˆ°çš„è™šå‡½æ•°è¡¨ä¸­çš„åœ°å€æ›¿æ¢ä¸ºé‡æ–°å†™çš„å‡½æ•°åœ°å€ã€‚ä½¿ç”¨äº†è™šå‡½æ•°ï¼Œä¼šå¢åŠ è®¿é—®å†…å­˜å¼€é”€ï¼Œé™ä½æ•ˆç‡ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:8","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.10 ç®€è¿°ç±»æˆå‘˜å‡½æ•°çš„é‡å†™(overwrite)ã€é‡è½½(overload)å’Œéšè—çš„åŒºåˆ« (1) é‡å†™å’Œé‡è½½ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ä¸åŒã€‚ â‘ èŒƒå›´çš„åŒºåˆ«: è¢«é‡å†™çš„å‡½æ•°å’Œé‡å†™çš„å‡½æ•°åœ¨ä¸¤ä¸ªç±»ä¸­ï¼Œè€Œé‡è½½å’Œè¢«é‡è½½çš„å‡½æ•°åœ¨åŒä¸€ä¸ªç±»ä¸­ã€‚ â‘¡å‚æ•°çš„åŒºåˆ«: è¢«é‡å†™å‡½æ•°å’Œé‡å†™å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸€å®šç›¸åŒï¼Œè€Œè¢«é‡è½½å‡½æ•°å’Œé‡è½½å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸€å®šä¸åŒã€‚ â‘¢virtualçš„åŒºåˆ«ï¼šé‡å†™çš„åŸºç±»ä¸­è¢«é‡å†™çš„å‡½æ•°å¿…é¡»è¦æœ‰virtualä¿®é¥°ï¼Œè€Œé‡è½½å‡½æ•°å’Œè¢«é‡è½½å‡½æ•°å¯ä»¥è¢«virtualä¿®é¥°ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ã€‚ (2) éšè—å’Œé‡å†™ã€é‡è½½æœ‰ä»¥ä¸‹å‡ ç‚¹ä¸åŒã€‚ ä¸é‡è½½çš„èŒƒå›´ä¸åŒ: å’Œé‡å†™ä¸€æ ·ï¼Œéšè—å‡½æ•°å’Œè¢«éšè—å‡½æ•°ä¸åœ¨åŒä¸€ä¸ªç±»ä¸­ã€‚ å‚æ•°çš„åŒºåˆ«: éšè—å‡½æ•°å’Œè¢«éšè—çš„å‡½æ•°çš„å‚æ•°åˆ—è¡¨å¯ä»¥ç›¸åŒï¼Œä¹Ÿå¯ä¸åŒï¼Œä½†æ˜¯å‡½æ•°åè‚¯å®šè¦ç›¸åŒã€‚ å½“å‚æ•°ä¸ç›¸åŒæ—¶ï¼Œæ— è®ºåŸºç±»ä¸­çš„å‚æ•°æ˜¯å¦è¢«virtual ä¿®é¥°ï¼ŒåŸºç±»çš„å‡½æ•°éƒ½æ˜¯è¢«éšè—ï¼Œè€Œä¸æ˜¯è¢«é‡å†™ã€‚ æ³¨æ„ï¼šè™½ç„¶é‡è½½å’Œè¦†ç›–éƒ½æ˜¯å®ç°å¤šæ€çš„åŸºç¡€ï¼Œä½†æ˜¯ä¸¤è€…å®ç°çš„æŠ€æœ¯å®Œå…¨ä¸ç›¸åŒï¼Œè¾¾åˆ°çš„ç›®çš„ä¹Ÿæ˜¯å®Œå…¨ä¸åŒçš„ï¼Œè¦†ç›–æ˜¯åŠ¨æ€ç»‘å®šçš„å¤šæ€ï¼Œè€Œé‡è½½æ˜¯é™æ€ç»‘å®šçš„å¤šæ€ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:9","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.11 é“¾è¡¨å’Œæ•°ç»„æœ‰ä»€ä¹ˆåŒºåˆ« å­˜å‚¨å½¢å¼: æ•°ç»„æ˜¯ä¸€å—è¿ç»­çš„ç©ºé—´ï¼Œå£°æ˜æ—¶å°±è¦ç¡®å®šé•¿åº¦ã€‚ é“¾è¡¨æ˜¯ä¸€å—å¯ä¸è¿ç»­çš„åŠ¨æ€ç©ºé—´ï¼Œé•¿åº¦å¯å˜ï¼Œæ¯ä¸ªç»“ç‚¹è¦ä¿å­˜ç›¸é‚»ç»“ç‚¹æŒ‡é’ˆã€‚ æ•°æ®æŸ¥æ‰¾: æ•°ç»„çš„çº¿æ€§æŸ¥æ‰¾é€Ÿåº¦å¿«ï¼ŒæŸ¥æ‰¾æ“ä½œç›´æ¥ä½¿ç”¨åç§»åœ°å€ã€‚ é“¾è¡¨éœ€è¦æŒ‰é¡ºåºæ£€ç´¢ç»“ç‚¹ï¼Œ æ•ˆç‡ä½ã€‚ æ•°æ®æ’å…¥æˆ–åˆ é™¤: é“¾è¡¨å¯ä»¥å¿«é€Ÿæ’å…¥å’Œåˆ é™¤ç»“ç‚¹ï¼Œè€Œæ•°ç»„åˆ™å¯èƒ½éœ€è¦å¤§é‡æ•°æ®ç§»åŠ¨ã€‚ è¶Šç•Œé—®é¢˜ï¼š é“¾è¡¨ä¸å­˜åœ¨è¶Šç•Œé—®é¢˜ï¼Œæ•°ç»„æœ‰è¶Šç•Œé—®é¢˜ã€‚ æ³¨æ„ï¼š åœ¨é€‰æ‹©æ•°ç»„æˆ–é“¾è¡¨æ•°æ®ç»“æ„æ—¶ï¼Œä¸€å®šè¦æ ¹æ®å®é™…éœ€è¦è¿›è¡Œé€‰æ‹©ã€‚æ•°ç»„ä¾¿äºæŸ¥è¯¢ï¼Œé“¾è¡¨ä¾¿äºæ’å…¥åˆ é™¤ã€‚æ•°ç»„èŠ‚çœç©ºé—´ä½†æ˜¯é•¿åº¦å›ºå®šï¼Œé“¾è¡¨è™½ç„¶å˜é•¿ä½†æ˜¯å äº†æ›´å¤šçš„å­˜å‚¨ç©ºé—´ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:10","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.12 ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—çš„åŠŸèƒ½ typedef struct node { int data; node *next; }node,*LinkStack; //åˆ›å»ºç©ºæ ˆï¼š LinkStack CreateNULLStack( LinkStack \u0026S) { S = (LinkStack)malloc( sizeof( node ) ); // ç”³è¯·æ–°ç»“ç‚¹ if( NULL == S) { printf(\"Fail to malloc a new node.\\n\"); return NULL; } S-\u003edata = 0; //åˆå§‹åŒ–æ–°ç»“ç‚¹ S-\u003enext = NULL; return S; } //æ ˆçš„æ’å…¥å‡½æ•°ï¼š LinkStack Push( LinkStack \u0026S, int data) { if( NULL == S) //æ£€éªŒæ ˆ { printf(\"There no node in stack!\"); return NULL; } LinkStack p = NULL; p = (LinkStack)malloc( sizeof( node ) ); // ç”³è¯·æ–°ç»“ç‚¹ if( NULL == p) { printf(\"Fail to malloc a new node.\\n\"); return S; } if( NULL == S-\u003enext) { p-\u003enext = NULL; } else { p-\u003enext = S-\u003enext; } p-\u003edata = data; //åˆå§‹åŒ–æ–°ç»“ç‚¹ S-\u003enext = p; //æ’å…¥æ–°ç»“ç‚¹ return S; } //å‡ºæ ˆå‡½æ•°ï¼š node Pop( LinkStack \u0026S) { node temp; temp.data = 0; temp.next = NULL; if( NULL == S) //æ£€éªŒæ ˆ { printf(\"There no node in stack!\"); return temp; } temp = *S; if( S-\u003enext == NULL ) { printf(\"The stack is NULL,can't pop!\\n\"); return temp; } LinkStack p = S -\u003enext; //èŠ‚ç‚¹å‡ºæ ˆ S-\u003enext = S-\u003enext-\u003enext; temp = *p; free( p ); p = NULL; return temp; } //åŒæ ˆå®ç°é˜Ÿåˆ—çš„å…¥é˜Ÿå‡½æ•°ï¼š LinkStack StackToQueuPush( LinkStack \u0026S, int data) { node n; LinkStack S1 = NULL; CreateNULLStack( S1 ); //åˆ›å»ºç©ºæ ˆ while( NULL != S-\u003enext ) //S å‡ºæ ˆå…¥S1 { n = Pop( S ); Push( S1, n.data ); } Push( S1, data ); //æ–°ç»“ç‚¹å…¥æ ˆ while( NULL != S1-\u003enext ) //S1 å‡ºæ ˆå…¥S { n = Pop( S1 ); Push( S, n.data ); } return S; } æ³¨æ„ï¼šç”¨ä¸¤ä¸ªæ ˆèƒ½å¤Ÿå®ç°ä¸€ä¸ªé˜Ÿåˆ—çš„åŠŸèƒ½ï¼Œé‚£ç”¨ä¸¤ä¸ªé˜Ÿåˆ—èƒ½å¦å®ç°ä¸€ä¸ªæ ˆçš„åŠŸèƒ½å‘¢ï¼Ÿç»“æœæ˜¯å¦å®šçš„ï¼Œå› ä¸ºæ ˆæ˜¯å…ˆè¿›åå‡ºï¼Œå°†ä¸¤ä¸ªæ ˆè¿åœ¨ä¸€èµ·ï¼Œå°±æ˜¯å…ˆè¿›å…ˆå‡ºã€‚è€Œé˜Ÿåˆ—æ˜¯ç°å…ˆè¿›å…ˆå‡ºï¼Œæ— è®ºå¤šå°‘ä¸ªè¿åœ¨ä¸€èµ·éƒ½æ˜¯å…ˆè¿›å…ˆå‡ºï¼Œè€Œæ— æ³•å®ç°å…ˆè¿›åå‡ºã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:11","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.13 å…±äº«æ•°æ®çš„ä¿æŠ¤ â‘ å¸¸å¼•ç”¨: ä½¿æ‰€å¼•ç”¨çš„å½¢å‚ä¸èƒ½è¢«æ›´æ–° void display(const double\u0026 a); â‘¡å¸¸å¯¹è±¡ï¼šåœ¨ç”Ÿå­˜æœŸå†…ä¸èƒ½è¢«æ›´æ–°ï¼Œä½† å¿…é¡»è¢«åˆå§‹åŒ– A const a(3,4); â‘¢å¸¸æˆå‘˜å‡½æ•°ï¼š ä¸èƒ½ä¿®æ”¹å¯¹è±¡ä¸­æ•°æ®æˆå‘˜ï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ç±»ä¸­æ²¡æœ‰è¢«const ä¿®é¥°çš„æˆå‘˜å‡½æ•°(å¸¸å¯¹è±¡å”¯ä¸€çš„å¯¹å¤–æ¥å£).å¦‚æœå£°æ˜äº†ä¸€ä¸ªå¸¸å¯¹è±¡ï¼Œåˆ™è¯¥å¯¹è±¡åªèƒ½è°ƒç”¨ä»–çš„å¸¸å‡½æ•°ï¼-\u003eå¯ä»¥ç”¨äºå¯¹é‡è½½å‡½æ•°çš„åŒºåˆ†; void print(); void print() const; â‘£extern int a: ä½¿å…¶ä»–æ–‡ä»¶ä¹Ÿèƒ½è®¿é—®è¯¥å˜é‡ å£°æ˜ä¸€ä¸ªå‡½æ•°æˆ–å®šä¹‰å‡½æ•°æ—¶ï¼Œå† ä»¥staticçš„è¯ï¼Œå‡½æ•°çš„ä½œç”¨åŸŸå°±è¢«é™åˆ¶åœ¨äº†å½“å‰ç¼–è¯‘å•å…ƒï¼Œå½“å‰ç¼–è¯‘å•å…ƒå†…ä¹Ÿå¿…é¡»åŒ…å«å‡½æ•°çš„å®šä¹‰ï¼Œä¹Ÿåªåœ¨å…¶ç¼–è¯‘å•å…ƒå¯è§ï¼Œå…¶ä»–å•å…ƒä¸èƒ½è°ƒç”¨è¿™ä¸ªå‡½æ•°(æ¯ä¸€ä¸ªcppæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªç¼–è¯‘å•å…ƒ)ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:12","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.14 ç¨‹åºå†…å­˜åˆ†é…æ–¹å¼ä»¥åŠå®ƒä»¬çš„åŒºåˆ« å†…å­˜åˆ†é…å¤§è‡´ä¸Šå¯ä»¥åˆ†æˆ5å—: æ ˆåŒº(stack) æ ˆï¼Œå°±æ˜¯é‚£äº›ç”±ç¼–è¯‘å™¨åœ¨éœ€è¦æ—¶åˆ†é…ï¼Œåœ¨ä¸éœ€è¦çš„æ—¶å€™è‡ªåŠ¨æ¸…é™¤çš„å˜é‡çš„å­˜å‚¨åŒºã€‚é‡Œé¢çš„å˜é‡é€šå¸¸æ˜¯å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°ç­‰ã€‚(ç”±ç¼–è¯‘å™¨ç®¡ç†) å †åŒº(heap) ä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…ã€é‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾ï¼Œç¨‹åºç»“æŸæ—¶å¯èƒ½ç”±ç³»ç»Ÿå›æ”¶ã€‚æ³¨æ„ï¼Œå®ƒä¸æ•°æ®ç»“æ„ä¸­çš„å †æ˜¯ä¸¤å›äº‹ï¼Œåˆ†é…æ–¹å¼ç±»ä¼¼äºé“¾è¡¨ã€‚ å…¨å±€åŒº(é™æ€åŒº)(static) å…¨å±€å˜é‡å’Œé™æ€å˜é‡è¢«åˆ†é…åˆ°åŒä¸€å—å†…å­˜ä¸­ã€‚ç¨‹åºç»“æŸåç”±ç³»ç»Ÿé‡Šæ”¾ã€‚ å¸¸é‡å­˜å‚¨åŒº å¸¸é‡å­—ç¬¦ä¸²å°±æ˜¯æ”¾åœ¨è¿™é‡Œçš„ï¼Œä¸å…è®¸ä¿®æ”¹ï¼Œç¨‹åºç»“æŸåç”±ç³»ç»Ÿé‡Šæ”¾ã€‚ ç¨‹åºä»£ç åŒº å­˜æ”¾å‡½æ•°ä½“çš„äºŒè¿›åˆ¶ä»£ç ã€‚ C++ç¨‹åºåœ¨æ‰§è¡Œæ—¶ï¼Œå°†å†…å­˜å¤§æ–¹å‘åˆ’åˆ†ä¸º4ä¸ªåŒºåŸŸ: ç¨‹åºè¿è¡Œå‰ ä»£ç åŒºï¼šå­˜æ”¾å‡½æ•°ä½“çš„äºŒè¿›åˆ¶ä»£ç ï¼Œç”±æ“ä½œç³»ç»Ÿè¿›è¡Œç®¡ç†çš„ å…¨å±€åŒºï¼šå­˜æ”¾å…¨å±€å˜é‡å’Œé™æ€å˜é‡ä»¥åŠå¸¸é‡ ç¨‹åºè¿è¡Œå æ ˆåŒºï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾, å­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼,å±€éƒ¨å˜é‡ç­‰ å †åŒºï¼šç”±ç¨‹åºå‘˜åˆ†é…å’Œé‡Šæ”¾,è‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾,ç¨‹åºç»“æŸæ—¶ç”±æ“ä½œç³»ç»Ÿå›æ”¶ å†…å­˜å››åŒºæ„ä¹‰ï¼š ä¸åŒåŒºåŸŸå­˜æ”¾çš„æ•°æ®ï¼Œèµ‹äºˆä¸åŒçš„ç”Ÿå‘½å‘¨æœŸ, ç»™æˆ‘ä»¬æ›´å¤§çš„çµæ´»ç¼–ç¨‹ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:13","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.15 explicit å‡½æ•°å£°æ˜æ—¶åŠ ä¸Šexplicitå¯ä»¥é˜»æ­¢å‡½æ•°å‚æ•°è¢«éšå¼è½¬æ¢ã€‚ Class A { explicit A(int a); } Void main() { A a1=12; //ä¸åŠ explicitæ—¶ä¼šè¢«éšå¼è½¬æ¢ä½ A a1=A(12);åŠ äº†æ­¤æ—¶ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚ } è¢«å£°æ˜ä¸ºexplicitçš„æ„é€ å‡½æ•°é€šå¸¸æ¯”non-explicit å‡½æ•°æ›´å—æ¬¢è¿ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:14","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.16 mutableå…³é”®å­— mutableçš„ä¸­æ–‡æ„æ€æ˜¯â€œå¯å˜çš„ï¼Œæ˜“å˜çš„â€ï¼Œè·Ÿconstant(æ—¢C++ä¸­çš„const)æ˜¯åä¹‰è¯ã€‚åœ¨C++ä¸­ï¼Œmutableä¹Ÿæ˜¯ä¸ºäº†çªç ´constçš„é™åˆ¶è€Œè®¾ç½®çš„ã€‚ è¢«mutableä¿®é¥°çš„å˜é‡(mutableåªèƒ½ç”¨äºä¿®é¥°ç±»çš„éé™æ€æ•°æ®æˆå‘˜)ï¼Œå°†æ°¸è¿œå¤„äºå¯å˜çš„çŠ¶æ€ï¼Œå³ä½¿åœ¨ä¸€ä¸ªconstå‡½æ•°ä¸­ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œå‡å¦‚ç±»çš„æˆå‘˜å‡½æ•°ä¸ä¼šæ”¹å˜å¯¹è±¡çš„çŠ¶æ€ï¼Œé‚£ä¹ˆè¿™ä¸ªæˆå‘˜å‡½æ•°ä¸€èˆ¬ä¼šå£°æ˜ä¸ºconstã€‚ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨constçš„å‡½æ•°é‡Œé¢ä¿®æ”¹ä¸€äº›è·Ÿç±»çŠ¶æ€æ— å…³çš„æ•°æ®æˆå‘˜ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®æˆå‘˜å°±åº”è¯¥è¢«mutalbeæ¥ä¿®é¥°ã€‚(ä½¿ç”¨mutableä¿®é¥°çš„æ•°æ®æˆå‘˜å¯ä»¥è¢«constæˆå‘˜å‡½æ•°ä¿®æ”¹)ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:15","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.17 ç”¨constä¿®é¥°å‡½æ•°çš„è¿”å›å€¼ å¦‚æœç»™ä»¥â€œæŒ‡é’ˆä¼ é€’â€æ–¹å¼çš„å‡½æ•°è¿”å›å€¼åŠ constä¿®é¥°ï¼Œé‚£ä¹ˆå‡½æ•°è¿”å›å€¼(å³æŒ‡é’ˆ)çš„å†…å®¹ä¸èƒ½è¢«ä¿®æ”¹ï¼Œè¯¥è¿”å›å€¼åªèƒ½è¢«èµ‹ç»™åŠ constä¿®é¥°çš„åŒç±»å‹æŒ‡é’ˆã€‚ä¾‹å¦‚å‡½æ•°ï¼š const char * GetString(void); // å¦‚ä¸‹è¯­å¥å°†å‡ºç°ç¼–è¯‘é”™è¯¯ï¼š char*str = GetString(); // æ­£ç¡®çš„ç”¨æ³•æ˜¯ const char *str =GetString(); ","date":"2023-07-11","objectID":"/posts/basics_one/:4:16","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.18 å®ã€constå’Œenum #defineä¸è¢«è§†ä¸ºè¯­è¨€çš„ä¸€éƒ¨åˆ†ã€‚å¯¹äºå•çº¯å¸¸é‡ï¼Œæœ€å¥½ç”¨constå¯¹è±¡æˆ–è€…enumæ›¿æ¢#defineã€‚ å¯¹äºç±»ä¼¼å‡½æ•°çš„å®ï¼Œå°½é‡ä½¿ç”¨å†…è”å‡½æ•°inlineæ›¿æ¢æ‰#define enumæšä¸¾ç±»å‹æ˜¯è¢«å½“åš int æˆ–è€… unsigned int ç±»å‹æ¥å¤„ç†çš„ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:17","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.19 static å¯¹è±¡å’Œ non-local staticå¯¹è±¡åŒºåˆ« â‘ C++ä¸­çš„staticå¯¹è±¡æ˜¯æŒ‡å­˜å‚¨åŒºä¸å±äºstackå’Œheapã€â€œå¯¿å‘½\"ä»è¢«æ„é€ å‡ºæ¥ç›´è‡³ç¨‹åºç»“æŸä¸ºæ­¢çš„å¯¹è±¡ã€‚ â‘¡è¿™äº›å¯¹è±¡åŒ…æ‹¬å…¨å±€å¯¹è±¡ï¼Œå®šä¹‰äºnamespaceä½œç”¨åŸŸçš„å¯¹è±¡ï¼Œåœ¨classã€functionä»¥åŠfileä½œç”¨åŸŸä¸­è¢«å£°æ˜ä¸ºstaticçš„å¯¹è±¡ã€‚ â‘¢å…¶ä¸­ï¼Œå‡½æ•°å†…çš„staticå¯¹è±¡ç§°ä¸ºlocal staticå¯¹è±¡ï¼Œè€Œå…¶å®ƒstaticå¯¹è±¡ç§°ä¸ºnon-local staticå¯¹è±¡ã€‚ local static å¯¹è±¡å’Œnon-local staticå¯¹è±¡åœ¨ä½•æ—¶è¢«åˆå§‹åŒ–(æ„é€ )è¿™ä¸ªé—®é¢˜ä¸Šå­˜åœ¨ç»†å¾®çš„å·®åˆ«: â‘ å¯¹äºlocal staticå¯¹è±¡ï¼Œåœ¨å…¶æ‰€å±çš„å‡½æ•°è¢«è°ƒç”¨ä¹‹å‰ï¼Œè¯¥å¯¹è±¡å¹¶ä¸å­˜åœ¨ï¼Œå³åªæœ‰åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨å¯¹åº”å‡½æ•°æ—¶ï¼Œlocal staticå¯¹è±¡æ‰è¢«æ„é€ å‡ºæ¥ã€‚ â‘¡è€Œå¯¹äºnon-local staticå¯¹è±¡ï¼Œåœ¨main()å‡½æ•°å¼€å§‹å‰å°±å·²ç»è¢«æ„é€ å‡ºæ¥ï¼Œå¹¶åœ¨main()å‡½æ•°ç»“æŸåè¢«ææ„ã€‚ å»ºè®®ï¼š 1.å¯¹å†…ç½®å¯¹è±¡è¿›è¡Œæ‰‹å·¥åˆå§‹åŒ–ï¼Œå› ä¸ºC++ä¸ä¿è¯åˆå§‹åŒ–å®ƒä»¬ã€‚ 2.æ„é€ å‡½æ•°æœ€å¥½ä½¿ç”¨æˆå‘˜åˆå€¼åˆ—ï¼Œè€Œä¸è¦åœ¨æ„é€ å‡½æ•°æœ¬ä½“ä¸­ä½¿ç”¨èµ‹å€¼æ“ä½œã€‚åˆå€¼åˆ—ä¸­åˆ—å‡ºçš„æˆå‘˜å˜é‡ï¼Œå…¶æ’åºæ¬¡åºåº”è¯¥å’Œå®ƒä»¬åœ¨classä¸­çš„å£°æ˜æ¬¡åºç›¸åŒ(åˆå§‹åŒ–é¡ºåºä¸å£°æ˜å˜é‡é¡ºåºä¸€è‡´)ã€‚ 3.ä¸ºå…é™¤â€œè·¨ç¼–è¯‘å•å…ƒçš„åˆå§‹åŒ–æ¬¡åºé—®é¢˜â€ï¼Œå°½é‡ä»¥local staticå¯¹è±¡æ›¿æ¢non-local staticå¯¹è±¡ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:18","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"4.20 å…¨å±€å˜é‡å’Œstaticå˜é‡çš„åŒºåˆ« â‘ å…¨å±€å˜é‡æœ¬èº«å°±æ˜¯é™æ€å­˜å‚¨æ–¹å¼ï¼Œ é™æ€å…¨å±€å˜é‡å½“ç„¶ä¹Ÿæ˜¯é™æ€å­˜å‚¨æ–¹å¼ã€‚ è¿™ä¸¤è€…åœ¨å­˜å‚¨æ–¹å¼ä¸Šå¹¶æ— ä¸åŒã€‚ â‘¡è¿™ä¸¤è€…çš„åŒºåˆ«åœ¨äºéé™æ€å…¨å±€å˜é‡çš„ä½œç”¨åŸŸæ˜¯æ•´ä¸ªæºç¨‹åºï¼Œ å½“ä¸€ä¸ªæºç¨‹åºç”±å¤šä¸ªæºæ–‡ä»¶ç»„æˆæ—¶ï¼Œéé™æ€çš„å…¨å±€å˜é‡åœ¨å„ä¸ªæºæ–‡ä»¶ä¸­éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚ â‘¢è€Œé™æ€å…¨å±€å˜é‡åˆ™é™åˆ¶äº†å…¶ä½œç”¨åŸŸï¼Œ å³åªåœ¨å®šä¹‰è¯¥å˜é‡çš„æºæ–‡ä»¶å†…æœ‰æ•ˆï¼Œ åœ¨åŒä¸€æºç¨‹åºçš„å…¶å®ƒæºæ–‡ä»¶ä¸­ä¸èƒ½ä½¿ç”¨å®ƒã€‚ â‘£ç”±äºé™æ€å…¨å±€å˜é‡çš„ä½œç”¨åŸŸå±€é™äºä¸€ä¸ªæºæ–‡ä»¶å†…ï¼Œåªèƒ½ä¸ºè¯¥æºæ–‡ä»¶å†…çš„å‡½æ•°å…¬ç”¨ï¼Œ å› æ­¤å¯ä»¥é¿å…åœ¨å…¶å®ƒæºæ–‡ä»¶ä¸­å¼•èµ·é”™è¯¯ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:4:19","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5. åŸºç¡€çŸ¥è¯†(äº”) ","date":"2023-07-11","objectID":"/posts/basics_one/:5:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.1 ä¸ºä»€ä¹ˆæ ˆè¦æ¯”å †é€Ÿåº¦è¦å¿« â‘ é¦–å…ˆ, æ ˆæ˜¯æœ¬ç€LIFOåŸåˆ™çš„å­˜å‚¨æœºåˆ¶, å¯¹æ ˆæ•°æ®çš„å®šä½ç›¸å¯¹æ¯”è¾ƒå¿«é€Ÿ, è€Œå †åˆ™æ˜¯éšæœºåˆ†é…çš„ç©ºé—´, å¤„ç†çš„æ•°æ®æ¯”è¾ƒå¤š, æ— è®ºå¦‚ä½•, è‡³å°‘è¦ä¸¤æ¬¡å®šä½. â‘¡å…¶æ¬¡, æ ˆæ˜¯ç”±CPUæä¾›æŒ‡ä»¤æ”¯æŒçš„, åœ¨æŒ‡ä»¤çš„å¤„ç†é€Ÿåº¦ä¸Š, å¯¹æ ˆæ•°æ®è¿›è¡Œå¤„ç†çš„é€Ÿåº¦è‡ªç„¶è¦ä¼˜äºç”±æ“ä½œç³»ç»Ÿæ”¯æŒçš„å †æ•°æ®. â‘¢å†è€…, æ ˆæ˜¯åœ¨ä¸€çº§ç¼“å­˜ä¸­åšç¼“å­˜çš„, è€Œå †åˆ™æ˜¯åœ¨äºŒçº§ç¼“å­˜ä¸­, ä¸¤è€…åœ¨ç¡¬ä»¶æ€§èƒ½ä¸Šå·®å¼‚å·¨å¤§. â‘£æœ€å, å„è¯­è¨€å¯¹æ ˆçš„ä¼˜åŒ–æ”¯æŒè¦ä¼˜äºå¯¹å †çš„æ”¯æŒ, æ¯”å¦‚swiftè¯­è¨€ä¸­, ä¸‰ä¸ªå­—åŠä»¥å†…çš„structç»“æ„, å¯ä»¥åœ¨æ ˆä¸­å†…è”, ä»è€Œè¾¾åˆ°æ›´å¿«çš„å¤„ç†é€Ÿåº¦. ","date":"2023-07-11","objectID":"/posts/basics_one/:5:1","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.2 c++ ææ„å‡½æ•°è°ƒç”¨æ—¶é—´ å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸï¼Œè¢«é”€æ¯æ—¶; deleteæŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆæ—¶ï¼Œæˆ–deleteæŒ‡å‘å¯¹è±¡çš„åŸºç±»ç±»å‹æŒ‡é’ˆï¼Œè€Œå…¶åŸºç±»ææ„å‡½æ•°æ˜¯è™šå‡½æ•°æ—¶; å¯¹è±¡iæ˜¯å¯¹è±¡oçš„æˆå‘˜ï¼Œoçš„ææ„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå¯¹è±¡içš„ææ„å‡½æ•°ä¹Ÿè¢«è°ƒç”¨ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:2","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.3 é™æ€ç»‘å®š åŠ¨æ€ç»‘å®š (ä¹Ÿå«åŠ¨æ€è¿ç¼–ï¼Œé™æ€è¿ç¼–) å¦‚æœçˆ¶ç±»ä¸­å­˜åœ¨æœ‰è™šå‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¾¿ä¼šä¸ºä¹‹ç”Ÿæˆè™šè¡¨(å±äºç±»)ä¸è™šæŒ‡é’ˆ(å±äºæŸä¸ªå¯¹è±¡)ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ ¹æ®è™šæŒ‡é’ˆçš„æŒ‡å‘ï¼Œæ¥å†³å®šè°ƒç”¨å“ªä¸ªè™šå‡½æ•°ï¼Œè¿™ç§°ä¹‹ä¸åŠ¨æ€ç»‘å®šï¼Œä¸ä¹‹ç›¸å¯¹çš„æ˜¯é™æ€ç»‘å®šï¼Œé™æ€ç»‘å®šåœ¨ç¼–è¯‘æœŸå°±å†³å®šäº†ã€‚ classå’Œtemplateéƒ½æ”¯æŒæ¥å£ä¸å¤šæ€: â‘ å¯¹classesè€Œè¨€ï¼Œæ¥å£æ˜¯æ˜¾å¼çš„ï¼Œä»¥å‡½æ•°ç­¾åä¸ºä¸­å¿ƒã€‚å¤šæ€åˆ™æ˜¯é€šè¿‡virtualå‡½æ•°(è™šå‡½æ•°)å‘ç”Ÿäºè¿è¡ŒæœŸï¼› â‘¡å¯¹templateå‚æ•°è€Œè¨€ï¼Œæ¥å£æ˜¯éšå¼çš„ï¼Œå¥ åŸºäºæœ‰æ•ˆè¡¨è¾¾å¼ã€‚å¤šæ€åˆ™æ˜¯é€šè¿‡templateå…·ç°åŒ–å’Œå‡½æ•°é‡è½½è§£æå‘ç”Ÿäºç¼–è¯‘æœŸã€‚ æ³›å‹ æ³›å‹æ˜¯é€šè¿‡å‚æ•°åŒ–ç±»å‹æ¥å®ç°åœ¨åŒä¸€ä»½ä»£ç ä¸Šæ“ä½œå¤šç§æ•°æ®ç±»å‹ã€‚åˆ©ç”¨â€œå‚æ•°åŒ–ç±»å‹â€å°†ç±»å‹æŠ½è±¡åŒ–ï¼Œä»è€Œå®ç°çµæ´»çš„å¤ç”¨ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:3","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.4 Cè¯­è¨€çš„æŒ‡é’ˆå’ŒC++çš„å¼•ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ æŒ‡é’ˆæœ‰è‡ªå·±çš„ä¸€å—ç©ºé—´ï¼ŒæŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œåªä¸è¿‡è¿™ä¸ªå˜é‡å­˜å‚¨çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼ŒæŒ‡å‘å†…å­˜çš„ä¸€ä¸ªå­˜å‚¨å•å…ƒï¼Œå³æŒ‡é’ˆæ˜¯ä¸€ä¸ªå®ä½“ã€‚è€Œå¼•ç”¨åªæ˜¯ä¸€ä¸ªåˆ«å; ä½¿ç”¨sizeofçœ‹ä¸€ä¸ªæŒ‡é’ˆçš„å¤§å°æ˜¯4ï¼Œè€Œå¼•ç”¨åˆ™æ˜¯è¢«å¼•ç”¨å¯¹è±¡çš„å¤§å°; æŒ‡é’ˆå¯ä»¥è¢«åˆå§‹åŒ–ä¸ºNULLï¼Œè€Œå¼•ç”¨å¿…é¡»è¢«åˆå§‹åŒ–ä¸”å¿…é¡»æ˜¯ä¸€ä¸ªå·²æœ‰å¯¹è±¡çš„å¼•ç”¨; ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ï¼ŒæŒ‡é’ˆéœ€è¦è¢«è§£å¼•ç”¨æ‰å¯ä»¥å¯¹å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œè€Œç›´æ¥å¯¹å¼•ç”¨çš„ä¿®æ”¹éƒ½ä¼šæ”¹å˜å¼•ç”¨æ‰€æŒ‡å‘çš„å¯¹è±¡; ","date":"2023-07-11","objectID":"/posts/basics_one/:5:4","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.5 è¯·ä½ è¯´è¯´Cè¯­è¨€æ˜¯æ€ä¹ˆè¿›è¡Œå‡½æ•°è°ƒç”¨çš„ æ¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨éƒ½ä¼šåˆ†é…å‡½æ•°æ ˆï¼Œåœ¨æ ˆå†…è¿›è¡Œå‡½æ•°æ‰§è¡Œè¿‡ç¨‹ã€‚è°ƒç”¨å‰ï¼Œå…ˆæŠŠè¿”å›åœ°å€å‹æ ˆï¼Œç„¶åæŠŠå½“å‰å‡½æ•°çš„espæŒ‡é’ˆå‹æ ˆã€‚(ESP(Extended Stack Pointer)ä¸ºæ‰©å±•æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œæ˜¯æŒ‡é’ˆå¯„å­˜å™¨çš„ä¸€ç§ï¼Œç”¨äºå­˜æ”¾å‡½æ•°æ ˆé¡¶æŒ‡é’ˆ) Cè¯­è¨€å‚æ•°å‹æ ˆé¡ºåºï¼Ÿï¼šä»å³åˆ°å·¦ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:5","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.6 C++ä¸­æ‹·è´èµ‹å€¼å‡½æ•°çš„å½¢å‚èƒ½å¦è¿›è¡Œå€¼ä¼ é€’ï¼Ÿ â­ ä¸èƒ½ã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œé¦–å…ˆè¦å°†å®å‚ä¼ é€’ç»™å½¢å‚ï¼Œè¿™ä¸ªä¼ é€’çš„æ—¶å€™åˆè¦è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°(aa = ex.aa; //æ­¤å¤„è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°)ã€‚å¦‚æ­¤å¾ªç¯ï¼Œæ— æ³•å®Œæˆæ‹·è´ï¼Œæ ˆä¹Ÿä¼šæ»¡ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:6","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.7 includeå¤´æ–‡ä»¶çš„é¡ºåºä»¥åŠåŒå¼•å·\"\"å’Œå°–æ‹¬å·\u003c\u003eçš„åŒºåˆ« ç¼–è¯‘å™¨é¢„å¤„ç†é˜¶æ®µæŸ¥æ‰¾å¤´æ–‡ä»¶çš„è·¯å¾„ä¸ä¸€æ · ä½¿ç”¨åŒå¼•å·\"\"åŒ…å«çš„å¤´æ–‡ä»¶ï¼ŒæŸ¥æ‰¾å¤´æ–‡ä»¶è·¯å¾„çš„é¡ºåºä¸ºï¼š â‘ å½“å‰å¤´æ–‡ä»¶ç›®å½• â‘¡ç¼–è¯‘å™¨è®¾ç½®çš„å¤´æ–‡ä»¶è·¯å¾„(ç¼–è¯‘å™¨å¯ä½¿ç”¨-Iæ˜¾å¼æŒ‡å®šæœç´¢è·¯å¾„) â‘¢ç³»ç»Ÿå˜é‡CPLUS_INCLUDE_PATH/C_INCLUDE_PATHæŒ‡å®šçš„å¤´æ–‡ä»¶è·¯å¾„ å¯¹äºä½¿ç”¨å°–æ‹¬å·\u003c\u003eåŒ…å«çš„å¤´æ–‡ä»¶ï¼ŒæŸ¥æ‰¾å¤´æ–‡ä»¶çš„è·¯å¾„é¡ºåºä¸ºï¼š â‘ ç¼–è¯‘å™¨è®¾ç½®çš„å¤´æ–‡ä»¶è·¯å¾„(ç¼–è¯‘å™¨å¯ä½¿ç”¨-Iæ˜¾å¼æŒ‡å®šæœç´¢è·¯å¾„) â‘¡ç³»ç»Ÿå˜é‡CPLUS_INCLUDE_PATH/C_INCLUDE_PATHæŒ‡å®šçš„å¤´æ–‡ä»¶è·¯å¾„ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:7","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.8 ä¸€ä¸ªC++æºæ–‡ä»¶ä»æ–‡æœ¬åˆ°å¯æ‰§è¡Œæ–‡ä»¶ç»å†çš„è¿‡ç¨‹ å¯¹äºC/C++ç¼–å†™çš„ç¨‹åºï¼Œä»æºä»£ç åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸€èˆ¬ç»è¿‡ä¸‹é¢å››ä¸ªæ­¥éª¤ï¼š é¢„ç¼–è¯‘ï¼Œé¢„ç¼–è¯‘çš„æ—¶å€™åšä¸€äº›ç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼Œæ¯”å¦‚å®æ›¿æ¢ï¼Œè€Œä¸è¿›è¡Œè¯­æ³•çš„æ£€æŸ¥ï¼› ç¼–è¯‘ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µï¼Œç¼–è¯‘å™¨å°†æ£€æŸ¥ä¸€äº›è¯­æ³•é”™è¯¯ï¼Œä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨çš„å‡½æ•°äº‹å…ˆæ²¡æœ‰å®šä¹‰è¿™ç§æƒ…å†µï¼Œä¸å†è¿™ä¸€é˜¶æ®µæ£€æŸ¥ï¼Œç¼–è¯‘åï¼Œå¾—åˆ°.sæ–‡ä»¶ æ±‡ç¼–ï¼Œå°†C/C++ä»£ç å˜ä¸ºæ±‡ç¼–ä»£ç ï¼Œå¾—åˆ°.oæˆ–è€….objæ–‡ä»¶ é“¾æ¥ï¼Œå°†æ‰€ç”¨åˆ°çš„å¤–éƒ¨æ–‡ä»¶é“¾æ¥åœ¨ä¸€èµ·ï¼Œåœ¨è¿™ä¸€é˜¶æ®µï¼Œå°±ä¼šæ£€æŸ¥ä½¿ç”¨çš„å‡½æ•°æœ‰æ²¡æœ‰å®šä¹‰ é“¾æ¥è¿‡åï¼Œå½¢æˆå¯æ‰§è¡Œæ–‡ä»¶.exe è¯¦ç»†è¯·å‚é˜…: ä¸€ä¸ªC++æºæ–‡ä»¶ä»æ–‡æœ¬åˆ°å¯æ‰§è¡Œæ–‡ä»¶ç»å†çš„è¿‡ç¨‹ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:8","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.9 å†…å­˜æ³„æ¼åŸå› å’Œåˆ¤æ–­æ–¹æ³• å†…å­˜æ³„æ¼é€šå¸¸æ˜¯å› ä¸ºè°ƒç”¨äº†malloc/newç­‰å†…å­˜ç”³è¯·æ“ä½œï¼Œä½†æ˜¯ç¼ºå°‘äº†å¯¹åº”çš„free/deleteã€‚ ä¸ºäº†åˆ¤æ–­å†…å­˜æ˜¯å¦æ³„æ¼ï¼Œæˆ‘ä»¬ä¸€æ–¹é¢å¯ä»¥ä½¿ç”¨Linuxç¯å¢ƒä¸‹çš„å†…å­˜æ³„æ¼æ£€æŸ¥å·¥å…·Valgrindï¼Œå¦ä¸€æ–¹é¢æˆ‘ä»¬å†™ä»£ç çš„æ—¶å€™ï¼Œå¯ä»¥æ·»åŠ å†…å­˜ç”³è¯·å’Œé‡Šæ”¾çš„ç»Ÿè®¡åŠŸèƒ½ï¼Œç»Ÿè®¡å½“å‰ç”³è¯·å’Œé‡Šæ”¾çš„å†…å­˜æ˜¯å¦ä¸€è‡´ï¼Œä»¥æ­¤æ¥åˆ¤æ–­å†…å­˜æ˜¯å¦æœ‰æ³„æ¼ã€‚ å†…å­˜æ³„æ¼åˆ†ç±»: å †å†…å­˜æ³„æ¼(heap leak)ã€‚å †å†…å­˜æ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æ ¹æ®éœ€è¦é€šè¿‡malloc\\realloc\\newç­‰ä»å †ä¸­åˆ†é…çš„ä¸€å—å†…å­˜ï¼Œåœ¨å®Œæˆä¹‹åï¼Œå¿…é¡»è¦é€šè¿‡è°ƒç”¨å¯¹åº”çš„freeæˆ–è€…deleteåˆ é™¤ã€‚å¦‚æœç¨‹åºçš„è®¾è®¡çš„é”™è¯¯å¯¼è‡´è¿™éƒ¨åˆ†å†…å­˜æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œé‚£ä¹ˆæ­¤åè¿™å—å†…å­˜å°†ä¸ä¼šè¢«ä½¿ç”¨ï¼Œå°±ä¼šäº§ç”ŸHeap Leakã€‚ ç³»ç»Ÿèµ„æºæ³„éœ²(Resource Leak)ã€‚ä¸»è¦æŒ‡ç¨‹åºä½¿ç”¨ç³»ç»Ÿåˆ†é…çš„èµ„æºæ¯”å¦‚ Bitmapï¼Œhandleï¼ŒSOCKETç­‰æ²¡æœ‰ä½¿ç”¨ç›¸åº”çš„å‡½æ•°é‡Šæ”¾æ‰ï¼Œå¯¼è‡´ç³»ç»Ÿèµ„æºçš„æµªè´¹ï¼Œä¸¥é‡å¯å¯¼è‡´ç³»ç»Ÿæ•ˆèƒ½é™ä½ï¼Œç³»ç»Ÿè¿è¡Œä¸ç¨³å®šã€‚ æ²¡æœ‰å°†åŸºç±»çš„ææ„å‡½æ•°å®šä¹‰ä¸ºè™šå‡½æ•°ã€‚å½“åŸºç±»æŒ‡é’ˆæŒ‡å‘å­ç±»å¯¹è±¡æ—¶ï¼Œå¦‚æœåŸºç±»çš„ææ„å‡½æ•°ä¸æ˜¯virtualï¼Œé‚£ä¹ˆå­ç±»çš„ææ„å‡½æ•°å°†ä¸ä¼šè¢«è°ƒç”¨ï¼Œå­ç±»çš„èµ„æºæ²¡æœ‰æ­£ç¡®çš„é‡Šæ”¾ï¼Œä»è€Œé€ æˆå†…å­˜æ³„æ¼ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:9","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.10 æ®µé”™è¯¯çš„äº§ç”ŸåŸå›  æ®µé”™è¯¯æ˜¯ä»€ä¹ˆ? ä¸€å¥è¯æ¥è¯´ï¼Œæ®µé”™è¯¯æ˜¯æŒ‡è®¿é—®çš„å†…å­˜è¶…å‡ºäº†ç³»ç»Ÿç»™è¿™ä¸ªç¨‹åºæ‰€è®¾å®šçš„å†…å­˜ç©ºé—´ï¼Œä¾‹å¦‚è®¿é—®äº†ä¸å­˜åœ¨çš„å†…å­˜åœ°å€ã€è®¿é—®äº†ç³»ç»Ÿä¿æŠ¤çš„å†…å­˜åœ°å€ã€è®¿é—®äº†åªè¯»çš„å†…å­˜åœ°å€ç­‰ç­‰æƒ…å†µã€‚è¿™é‡Œè´´ä¸€ä¸ªå¯¹äºâ€œæ®µé”™è¯¯â€çš„å‡†ç¡®å®šä¹‰ã€‚ æ®µé”™è¯¯äº§ç”Ÿçš„åŸå›  è®¿é—®ä¸å­˜åœ¨çš„å†…å­˜åœ°å€ è®¿é—®ç³»ç»Ÿä¿æŠ¤çš„å†…å­˜åœ°å€ è®¿é—®åªè¯»çš„å†…å­˜åœ°å€ æ ˆæº¢å‡º è¯¦ç»†è¯·å‚é˜…ï¼šLinuxç¯å¢ƒä¸‹æ®µé”™è¯¯çš„äº§ç”ŸåŸå› åŠè°ƒè¯•æ–¹æ³•å°ç»“ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:10","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.11 C++ å‡½æ•°è°ƒç”¨è¿‡ç¨‹ æ€»ç»“èµ·æ¥æ•´ä¸ªè¿‡ç¨‹å°±ä¸‰æ­¥: æ ¹æ®è°ƒç”¨çš„å‡½æ•°åæ‰¾åˆ°å‡½æ•°å…¥å£; åœ¨æ ˆä¸­ç”³è¯·è°ƒç”¨å‡½æ•°ä¸­çš„å‚æ•°åŠå‡½æ•°ä½“å†…å®šä¹‰çš„å˜é‡çš„å†…å­˜ç©ºé—´; å‡½æ•°æ‰§è¡Œå®Œåï¼Œé‡Šæ”¾å‡½æ•°åœ¨æ ˆä¸­çš„ç”³è¯·çš„å‚æ•°å’Œå˜é‡çš„ç©ºé—´ï¼Œæœ€åè¿”å›å€¼(å¦‚æœæœ‰çš„è¯)ã€‚ è¯¦ç»†è¯·æŸ¥é˜…ï¼šå‡½æ•°è°ƒç”¨è¿‡ç¨‹ / C/C++å‡½æ•°è°ƒç”¨è¿‡ç¨‹åˆ†æ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:11","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.12 å¦‚ä½•è°ƒè¯•c++å¤šçº¿ç¨‹ç¨‹åºï¼Ÿ æ‰“å°æ—¥å¿—ï¼Œæ—¥å¿—ä¸­åŠ ä¸Šçº¿ç¨‹IDï¼›(ç®€å•ç²—æš´) gdbæœ‰threadç›¸å…³å‘½ä»¤ï¼Œå¦‚infothread(ç®€å†™infoth)æ˜¾ç¤ºçº¿ç¨‹æ¶ˆæ¯ï¼Œbxxthreadyyå¯ä»¥å¯¹æŸä¸ªthreadè®¾ç½®æ–­ç‚¹ï¼Œthreadxx(ç®€å†™æˆthrxx)åˆ‡æ¢åˆ°æŸä¸ªthreadã€‚å†é…åˆframe(ç®€å†™f)ç›¸å…³çš„å‘½ä»¤(æ¯”å¦‚upï¼Œdownåœ¨ä¸åŒframeé—´è·³è½¬)ï¼ŒåŸºæœ¬å¯ä»¥å¤„ç†è‹¥å¹²ä¸ªä¸åŒçš„çº¿ç¨‹é—´çš„debugâ€¦â€¦ è¯¦ç»†è¯·æŸ¥é˜…ï¼šC++(vs)å¤šçº¿ç¨‹è°ƒè¯• (è½¬) ","date":"2023-07-11","objectID":"/posts/basics_one/:5:12","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.13Â é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ« â‘ é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼ŒæŠŠæ•°æ®å’Œæ•°æ®æ“ä½œæ”¾åœ¨ä¸€èµ·ï¼Œç»„æˆå¯¹è±¡; å¯¹åŒç±»çš„å¯¹è±¡æŠ½è±¡å‡ºå…¶å…±æ€§ç»„æˆç±»; ç±»é€šè¿‡ç®€å•çš„æ¥å£ä¸å¤–ç•Œå‘ç”Ÿè”ç³»ï¼Œå¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´é€šè¿‡æ¶ˆæ¯è¿›è¡Œé€šä¿¡ã€‚ â‘¡é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§æ˜¯\"å°è£…ã€â€œå¤šæ€â€ã€â€œç»§æ‰¿â€ï¼Œäº”å¤§åŸåˆ™æ˜¯\"å•ä¸€èŒè´£åŸåˆ™â€ã€â€œå¼€æ”¾å°é—­åŸåˆ™â€ã€â€œé‡Œæ°æ›¿æ¢åŸåˆ™â€ã€â€œä¾èµ–å€’ç½®åŸåˆ™â€ã€â€œæ¥å£åˆ†ç¦»åŸåˆ™â€ã€‚ â‘¢è€Œé¢å‘è¿‡ç¨‹æ–¹æ³•æ˜¯ä»¥è¿‡ç¨‹ä¸ºä¸­å¿ƒçš„å¼€å‘æ–¹æ³•ï¼Œå®ƒè‡ªé¡¶å‘ä¸‹é¡ºåºè¿›è¡Œï¼Œ ç¨‹åºç»“æ„æŒ‰ç…§åŠŸèƒ½åˆ’åˆ†æˆè‹¥å¹²ä¸ªåŸºæœ¬æ¨¡å—ï¼Œè¿™äº›æ¨¡å—å½¢æˆæ ‘çŠ¶ç»“æ„ã€‚ (è¿‡ç¨‹)ä¼˜ç‚¹ï¼š æ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ï¼Œå› ä¸ºç±»è°ƒç”¨æ—¶éœ€è¦å®ä¾‹åŒ–ï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œæ¯”è¾ƒæ¶ˆè€—æº;æ¯”å¦‚åµŒå…¥å¼å¼€å‘ã€Linux/Unixç­‰ä¸€èˆ¬é‡‡ç”¨é¢å‘è¿‡ç¨‹å¼€å‘ï¼Œæ€§èƒ½æ˜¯æœ€é‡è¦çš„å› ç´ ã€‚ ç¼ºç‚¹ï¼šæ²¡æœ‰é¢å‘å¯¹è±¡æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ã€‚ (å¯¹è±¡)ä¼˜ç‚¹ï¼š æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ï¼Œç”±äºé¢å‘å¯¹è±¡æœ‰å°è£…ã€ç»§æ‰¿ã€å¤šæ€æ€§çš„ç‰¹æ€§ï¼Œå¯ä»¥è®¾è®¡å‡ºä½è€¦åˆçš„ç³»ç»Ÿã€‚ ç¼ºç‚¹ï¼šæ€§èƒ½æ¯”é¢å‘è¿‡ç¨‹ä½ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:13","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.14 å…³äºå¼•ç”¨èµ‹å€¼çš„å¤šæ€ï¼š Class B; Class D : public B; B\u0026 b; D\u0026 d; B\u0026 b1 = d ; //çˆ¶ç±»å¯ä»¥ä½œä¸ºå­ç±»çš„å¼•ç”¨ï¼Œæ­¤æ—¶b1è¡¨ç°å’ŒæŒ‡é’ˆå½¢å¼ä¸€è‡´(ä¼šè°ƒç”¨Bçš„éè™šå‡½æ•°) D\u0026 d1 = bï¼› //é”™è¯¯ï¼Œä¸èƒ½å°†å­ç±»ä½œä¸ºçˆ¶ç±»çš„å¼•ç”¨ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:14","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.15 æ¨¡æ¿çš„å£°æ˜å’Œå®ç°ä¸èƒ½åˆ†å¼€çš„åŸå›  é“¾æ¥çš„æ—¶å€™ï¼Œéœ€è¦å®ä¾‹åŒ–æ¨¡æ¿ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ‰¾æ¨¡æ¿çš„å…·ä½“å®ç°äº†ã€‚å‡è®¾åœ¨mainå‡½æ•°ä¸­è°ƒç”¨äº†ä¸€ä¸ªæ¨¡æ¿å‡½æ•°ï¼Œè¿™æ—¶å€™å°±éœ€è¦å»å®ä¾‹åŒ–è¯¥ç±»å‹çš„æ¨¡æ¿ã€‚æ³¨æ„mainå‡½æ•°é‡Œé¢åªåŒ…å«äº†.hæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯åªæœ‰æ¨¡æ¿çš„å£°æ˜ï¼Œæ²¡æœ‰å…·ä½“å®ç°ã€‚å°±ä¼šæŠ¥é”™ã€‚ è€Œæ¨¡æ¿çš„å®ç°.cppé‡Œé¢ï¼Œè™½ç„¶æœ‰æ¨¡æ¿çš„å…·ä½“å®ç°ï¼Œä½†æ˜¯æ²¡æœ‰è°åœ¨è¯¥.cppé‡Œé¢ä½¿ç”¨ä¸€ä¸ªæ¨¡æ¿å‡½æ•°ï¼Œå°±ä¸ä¼šç”Ÿæˆä¸€ä¸ªå…·ä½“åŒ–çš„å®ä¾‹ è¯¦ç»†è¯·å‚é˜…ï¼šC++ æ¨¡æ¿ç±»çš„å£°æ˜ä¸å®ç°åˆ†ç¦»é—®é¢˜ / â€‹â€‹â€‹â€‹â€‹â€‹C++ æ¨¡æ¿ç±»çš„å£°æ˜ä¸å®ç°åˆ†ç¦»é—®é¢˜(æ¨¡æ¿å®ä¾‹åŒ–)â€‹â€‹â€‹â€‹â€‹â€‹ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:15","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.16 C++ç±»ä¸­å¼•ç”¨æˆå‘˜å’Œå¸¸é‡æˆå‘˜çš„åˆå§‹åŒ–(å¿…é¡»ç”¨åˆå§‹åŒ–åˆ—è¡¨è¿›è¡Œåˆå§‹åŒ–) å¦‚æœä¸€ä¸ªç±»æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š Class A { public: A(int pram1, int pram2, int pram3); private: int a; int \u0026b; // å¼•ç”¨æˆå‘˜ const int c; // å¸¸é‡æˆå‘˜ } å‡å¦‚åœ¨æ„é€ å‡½æ•°ä¸­å¯¹ä¸‰ä¸ªç§æœ‰å˜é‡è¿›è¡Œèµ‹å€¼åˆ™é€šå¸¸ä¼šè¿™æ ·å†™ï¼š A::A(int pram1, int pram2, int pram3) { a=pram1; b=pram2; c=pram3; } ä½†æ˜¯ï¼Œè¿™æ ·æ˜¯ç¼–è¯‘ä¸è¿‡çš„ã€‚å› ä¸ºå¸¸é‡å’Œå¼•ç”¨åˆå§‹åŒ–å¿…é¡»èµ‹å€¼ã€‚æ‰€ä»¥ä¸Šé¢çš„æ„é€ å‡½æ•°çš„å†™æ³•åªæ˜¯ç®€å•çš„èµ‹å€¼ï¼Œå¹¶ä¸æ˜¯åˆå§‹åŒ–ã€‚ æ­£ç¡®å†™æ³•åº”è¯¥æ˜¯ï¼š A::A(int pram1, int pram2, int pram3):b(pram2),c(pram3) { a=pram1; } é‡‡ç”¨åˆå§‹åŒ–åˆ—è¡¨å®ç°äº†å¯¹å¸¸é‡å’Œå¼•ç”¨çš„åˆå§‹åŒ–ã€‚é‡‡ç”¨æ‹¬å·èµ‹å€¼çš„æ–¹æ³•ï¼Œæ‹¬å·èµ‹å€¼åªèƒ½ç”¨åœ¨å˜é‡çš„åˆå§‹åŒ–è€Œä¸èƒ½ç”¨åœ¨å®šä¹‰ä¹‹åçš„èµ‹å€¼ã€‚ å‡¡æ˜¯æœ‰å¼•ç”¨ç±»å‹çš„æˆå‘˜å˜é‡æˆ–è€…å¸¸é‡ç±»å‹çš„å˜é‡çš„ç±»ï¼Œä¸èƒ½æœ‰ç¼ºçœæ„é€ å‡½æ•°ã€‚é»˜è®¤æ„é€ å‡½æ•°æ²¡æœ‰å¯¹å¼•ç”¨æˆå‘˜æä¾›é»˜è®¤çš„åˆå§‹åŒ–æœºåˆ¶ï¼Œä¹Ÿå› æ­¤é€ æˆå¼•ç”¨æœªåˆå§‹åŒ–çš„ç¼–è¯‘é”™è¯¯ã€‚å¹¶ä¸”å¿…é¡»ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨è¿›è¡Œåˆå§‹åŒ–constå¯¹è±¡ã€å¼•ç”¨å¯¹è±¡ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:16","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.17 memsetä¸ºintå‹æ•°ç»„åˆå§‹åŒ–é—®é¢˜ å¤´æ–‡ä»¶: #include \u003cstring.h\u003e memset() å‡½æ•°ç”¨æ¥å°†æŒ‡å®šå†…å­˜çš„å‰nä¸ªå­—èŠ‚è®¾ç½®ä¸ºç‰¹å®šçš„å€¼ï¼Œå…¶åŸå‹ä¸º: å‡½æ•°è¯´æ˜ void * memset(void * ptr, int value, size_t num); å‚æ•°è¯´æ˜ï¼š ptr ä¸ºè¦æ“ä½œçš„å†…å­˜çš„æŒ‡é’ˆã€‚ value ä¸ºè¦è®¾ç½®çš„å€¼ã€‚ä½ æ—¢å¯ä»¥å‘ value ä¼ é€’ int ç±»å‹çš„å€¼ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ char ç±»å‹çš„å€¼ï¼Œint å’Œ char å¯ä»¥æ ¹æ® ASCII ç ç›¸äº’è½¬æ¢ã€‚ num ä¸º ptr çš„å‰ num ä¸ªå­—èŠ‚ï¼Œsize_t å°±æ˜¯unsigned intã€‚ memset() ä¼šå°† ptr æ‰€æŒ‡çš„å†…å­˜åŒºåŸŸçš„å‰ num ä¸ªå­—èŠ‚çš„å€¼éƒ½è®¾ç½®ä¸º valueï¼Œç„¶åè¿”å›æŒ‡å‘ ptr çš„æŒ‡é’ˆã€‚ æ— æ³•ä¸‹é¢è¿™æ ·åˆå§‹åŒ–ï¼Œè¿™æ ·çš„ç»“æœæ˜¯aè¢«èµ‹å€¼æˆ168430090ï¼Œ168430090â€¦.. int a[10]; // array memset(a, 1, sizeof(a)); è¿™æ˜¯å› ä¸ºintç”±4ä¸ªå­—èŠ‚(è¯´)è¡¨ç¤ºï¼Œå¹¶ä¸”ä¸èƒ½å¾—åˆ°æ•°ç»„aä¸­æ•´æ•°çš„æœŸæœ›å€¼ã€‚ ä½†æˆ‘ç»å¸¸çœ‹åˆ°ç¨‹åºå‘˜ä½¿ç”¨memsetå°†intæ•°ç»„å…ƒç´ è®¾ç½®ä¸º 0 æˆ– -1ã€‚å…¶ä»–å€¼ä¸è¡Œï¼ int a[10]; int b[10]; memset(a, 0, sizeof(a)); memset(b, -1, sizeof(b)); //å‡è®¾aä¸ºintå‹æ•°ç»„ï¼š memset(a, 0x7f, sizeof(a)); //aæ•°ç»„æ¯ä¸ªç©ºé—´å°†è¢«åˆå§‹åŒ–ä¸º0x7f7f7f7f,åŸå› æ˜¯Cå‡½æ•°ä¼ å‚è¿‡ç¨‹ä¸­çš„æŒ‡é’ˆé™çº§ï¼Œå¯¼è‡´sizeof(a)ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª something*æŒ‡é’ˆç±»å‹å¤§å°çš„çš„å­—èŠ‚æ•°ï¼Œå¦‚æœæ˜¯32ä½ï¼Œå°±æ˜¯4å­—èŠ‚ã€‚æ‰€ä»¥memsetæŒ‰å­—èŠ‚èµ‹å€¼ã€‚ memset(a,0xaf,sizeof(a)); //aæ•°ç»„æ¯ä¸ªç©ºé—´å°†è¢«åˆå§‹åŒ–ä¸º0xafafafaf ","date":"2023-07-11","objectID":"/posts/basics_one/:5:17","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.18 ç¼–è¯‘å™¨å¯¹ inline å‡½æ•°çš„å¤„ç†æ­¥éª¤ ç¼–è¯‘å™¨å¯¹ inline å‡½æ•°çš„å¤„ç†: å°† inline å‡½æ•°ä½“å¤åˆ¶åˆ° inline å‡½æ•°è°ƒç”¨ç‚¹å¤„; ä¸ºæ‰€æœ‰ inline å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡åˆ†é…å†…å­˜ç©ºé—´; å°† inline å‡½æ•°çš„è¾“å…¥å‚æ•°å’Œè¿”å›å€¼æ˜ å°„åˆ°è°ƒç”¨æ–¹æ³•çš„å±€éƒ¨å˜é‡ç©ºé—´ä¸­; å¦‚æœ inline å‡½æ•°æœ‰å¤šä¸ªè¿”å›ç‚¹ï¼Œå°†å…¶è½¬å˜ä¸º inline å‡½æ•°ä»£ç å—æœ«å°¾çš„åˆ†æ”¯(ä½¿ç”¨ GOTO); ä¼˜ç‚¹: å†…è”å‡½æ•°åŒå®å‡½æ•°ä¸€æ ·å°†åœ¨è¢«è°ƒç”¨å¤„è¿›è¡Œä»£ç å±•å¼€ï¼Œçœå»äº†å‚æ•°å‹æ ˆã€æ ˆå¸§å¼€è¾Ÿä¸å›æ”¶ï¼Œç»“æœè¿”å›ç­‰ï¼Œä»è€Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ã€‚ å†…è”å‡½æ•°ç›¸æ¯”å®å‡½æ•°æ¥è¯´ï¼Œåœ¨ä»£ç å±•å¼€æ—¶ï¼Œä¼šåšå®‰å…¨æ£€æŸ¥æˆ–è‡ªåŠ¨ç±»å‹è½¬æ¢(åŒæ™®é€šå‡½æ•°)ï¼Œè€Œå®å®šä¹‰åˆ™ä¸ä¼šã€‚ åœ¨ç±»ä¸­å£°æ˜åŒæ—¶å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œè‡ªåŠ¨è½¬åŒ–ä¸ºå†…è”å‡½æ•°ï¼Œå› æ­¤å†…è”å‡½æ•°å¯ä»¥è®¿é—®ç±»çš„æˆå‘˜å˜é‡ï¼Œå®å®šä¹‰åˆ™ä¸èƒ½ã€‚ å†…è”å‡½æ•°åœ¨è¿è¡Œæ—¶å¯è°ƒè¯•ï¼Œè€Œå®å®šä¹‰ä¸å¯ä»¥ã€‚ ç¼ºç‚¹: ä»£ç è†¨èƒ€ã€‚å†…è”æ˜¯ä»¥ä»£ç è†¨èƒ€(å¤åˆ¶)ä¸ºä»£ä»·ï¼Œæ¶ˆé™¤å‡½æ•°è°ƒç”¨å¸¦æ¥çš„å¼€é”€ã€‚å¦‚æœæ‰§è¡Œå‡½æ•°ä½“å†…ä»£ç çš„æ—¶é—´ï¼Œç›¸æ¯”äºå‡½æ•°è°ƒç”¨çš„å¼€é”€è¾ƒå¤§ï¼Œé‚£ä¹ˆæ•ˆç‡çš„æ”¶è·ä¼šå¾ˆå°‘ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¯ä¸€å¤„å†…è”å‡½æ•°çš„è°ƒç”¨éƒ½è¦å¤åˆ¶ä»£ç ï¼Œå°†ä½¿ç¨‹åºçš„æ€»ä»£ç é‡å¢å¤§ï¼Œæ¶ˆè€—æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚ inline å‡½æ•°æ— æ³•éšç€å‡½æ•°åº“å‡çº§è€Œå‡çº§ã€‚inlineå‡½æ•°çš„æ”¹å˜éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œä¸åƒ non-inline å¯ä»¥ç›´æ¥é“¾æ¥ã€‚ æ˜¯å¦å†…è”ï¼Œç¨‹åºå‘˜ä¸å¯æ§ã€‚å†…è”å‡½æ•°åªæ˜¯å¯¹ç¼–è¯‘å™¨çš„å»ºè®®ï¼Œæ˜¯å¦å¯¹å‡½æ•°å†…è”ï¼Œå†³å®šæƒåœ¨äºç¼–è¯‘å™¨ã€‚ ","date":"2023-07-11","objectID":"/posts/basics_one/:5:18","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.19 è™šå‡½æ•°(virtual)å¯ä»¥æ˜¯å†…è”å‡½æ•°(inline)å—ï¼Ÿ è™šå‡½æ•°å¯ä»¥æ˜¯å†…è”å‡½æ•°ï¼Œå†…è”æ˜¯å¯ä»¥ä¿®é¥°è™šå‡½æ•°çš„ï¼Œä½†æ˜¯å½“è™šå‡½æ•°è¡¨ç°å¤šæ€æ€§çš„æ—¶å€™ä¸èƒ½å†…è”ã€‚ å†…è”æ˜¯åœ¨ç¼–è¯‘æœŸå»ºè®®ç¼–è¯‘å™¨å†…è”ï¼Œè€Œè™šå‡½æ•°çš„å¤šæ€æ€§åœ¨è¿è¡ŒæœŸï¼Œç¼–è¯‘å™¨æ— æ³•çŸ¥é“è¿è¡ŒæœŸè°ƒç”¨å“ªä¸ªä»£ç ï¼Œå› æ­¤è™šå‡½æ•°è¡¨ç°ä¸ºå¤šæ€æ€§æ—¶(è¿è¡ŒæœŸ)ä¸å¯ä»¥å†…è”ã€‚ inline virtual å”¯ä¸€å¯ä»¥å†…è”çš„æ—¶å€™æ˜¯ï¼šç¼–è¯‘å™¨çŸ¥é“æ‰€è°ƒç”¨çš„å¯¹è±¡æ˜¯å“ªä¸ªç±»(å¦‚ Base::who())ï¼Œè¿™åªæœ‰åœ¨ç¼–è¯‘æœŸå…·æœ‰å®é™…å¯¹è±¡è€Œä¸æ˜¯å¯¹è±¡çš„æŒ‡é’ˆæˆ–å¼•ç”¨æ—¶æ‰ä¼šå‘ç”Ÿ; ","date":"2023-07-11","objectID":"/posts/basics_one/:5:19","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"5.20Â é™æ€åº“å’ŒåŠ¨æ€åº“æ¯”è¾ƒ é™æ€åº“Â (.aã€.lib): å°†é™æ€åº“çš„å†…å®¹æ·»åŠ åˆ°ç¨‹åºä¸­ï¼Œæ­¤æ—¶ç¨‹åºçš„ç©ºé—´ï¼Œå˜æˆäº†æºç¨‹åºç©ºé—´å¤§å° + é™æ€åº“ç©ºé—´å¤§å°ã€‚ åŠ¨æ€åº“(å…±äº«åº“)(.soã€.dll): å¸¸é©»å†…å­˜ï¼Œå½“ç¨‹åºéœ€è¦è°ƒç”¨ç›¸å…³å‡½æ•°æ—¶ï¼Œä¼šä»å†…å­˜è°ƒç”¨ã€‚ åŒºåˆ«: é™æ€åº“ï¼šå¯¹ç©ºé—´è¦æ±‚è¾ƒä½ï¼Œè€Œæ—¶é—´è¦æ±‚è¾ƒé«˜çš„æ ¸å¿ƒç¨‹åºä¸­ã€‚(.aã€.lib) åŠ¨æ€åº“ï¼šå¯¹æ—¶é—´è¦æ±‚è¾ƒä½ï¼Œå¯¹ç©ºé—´è¦æ±‚è¾ƒé«˜ã€‚(.soã€.dll)Â hash ","date":"2023-07-11","objectID":"/posts/basics_one/:5:20","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"6 åŸºç¡€çŸ¥è¯†(å…­) ","date":"2023-07-11","objectID":"/posts/basics_one/:6:0","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["C++"],"content":"6.1 æ„é€ å‡½æ•°ä¸ºä»€ä¹ˆä¸èƒ½å®šä¹‰ä¸ºè™šå‡½æ•°ï¼Ÿ â½½ææ„å‡½æ•°â¼€èˆ¬å†™æˆè™šå‡½æ•°çš„åŸå›  ï¼Ÿ æ„é€ å‡½æ•°ä¸èƒ½å£°æ˜ä¸ºè™šå‡½æ•°çš„åŸå› æ˜¯: æ„é€ ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå¿…é¡»çŸ¥é“å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œè€Œè™šå‡½æ•°è¡Œä¸ºæ˜¯åœ¨è¿è¡ŒæœŸé—´ç¡®å®šå®é™…ç±»å‹çš„ã€‚è€Œåœ¨æ„é€ ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç”±äºå¯¹è±¡è¿˜æœªæ„é€ æˆåŠŸã€‚ç¼–è¯‘å™¨æ— æ³•çŸ¥é“å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œæ˜¯è¯¥ç±»æœ¬èº«ï¼Œè¿˜æ˜¯è¯¥ç±»çš„ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼Œæˆ–æ˜¯æ›´æ·±å±‚æ¬¡çš„æ´¾ç”Ÿç±»ã€‚æ— æ³•ç¡®å®šã€‚ è™šå‡½æ•°çš„æ‰§è¡Œä¾èµ–äºè™šå‡½æ•°è¡¨ã€‚è€Œè™šå‡½æ•°è¡¨åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œåˆå§‹åŒ–å·¥ä½œï¼Œå³åˆå§‹åŒ–vptrï¼Œè®©ä»–æŒ‡å‘æ­£ç¡®çš„è™šå‡½æ•°è¡¨ã€‚è€Œåœ¨æ„é€ å¯¹è±¡æœŸé—´ï¼Œè™šå‡½æ•°è¡¨è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå°†æ— æ³•è¿›è¡Œã€‚ è™šå‡½æ•°çš„æ„æ€å°±æ˜¯å¼€å¯åŠ¨æ€ç»‘å®šï¼Œç¨‹åºä¼šæ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹æ¥é€‰æ‹©è¦è°ƒç”¨çš„æ–¹æ³•ã€‚ç„¶è€Œåœ¨æ„é€ å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡çš„åŠ¨æ€ç±»å‹è¿˜ä¸å®Œæ•´ï¼Œæ²¡æœ‰åŠæ³•ç¡®å®šå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹ï¼Œæ•…æ„é€ å‡½æ•°ä¸èƒ½åŠ¨æ€ç»‘å®šã€‚(åŠ¨æ€ç»‘å®šæ˜¯æ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹è€Œä¸æ˜¯å‡½æ•°åï¼Œåœ¨è°ƒç”¨æ„é€ å‡½æ•°ä¹‹å‰ï¼Œè¿™ä¸ªå¯¹è±¡æ ¹æœ¬å°±ä¸å­˜åœ¨ï¼Œå®ƒæ€ä¹ˆåŠ¨æ€ç»‘å®šï¼Ÿ) ç¼–è¯‘å™¨åœ¨è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°çš„æ—¶å€™å¹¶ä¸çŸ¥é“ä½ è¦æ„é€ çš„æ˜¯ä¸€ä¸ªåŸºç±»çš„å¯¹è±¡è¿˜æ˜¯ä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚ ææ„å‡½æ•°è®¾ä¸ºè™šå‡½æ•°çš„ä½œç”¨: è§£é‡Šï¼šåœ¨ç±»çš„ç»§æ‰¿ä¸­ï¼Œå¦‚æœæœ‰åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»ï¼Œé‚£ä¹ˆç”¨åŸºç±»æŒ‡é’ˆdeleteæ—¶ï¼Œå¦‚æœä¸å®šä¹‰æˆè™šå‡½æ•°ï¼Œæ´¾ç”Ÿç±»ä¸­æ´¾ç”Ÿçš„é‚£éƒ¨åˆ†æ— æ³•ææ„ã€‚(å¦‚æœåŸºç±»çš„ææ„å‡½æ•°ä¸æ˜¯è™šå‡½æ•°ï¼Œé‚£ä¹ˆåœ¨delete åŸºç±»æŒ‡é’ˆæ—¶ï¼Œåªè°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ï¼Œä¸ä¼šè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼Œæ•…æ´¾ç”Ÿç±»éƒ¨åˆ†ä¸ä¼šè¢«ææ„ã€‚) ref: [1]. https://blog.csdn.net/Yangy_Jiaojiao/article/details/127588598 [2]. https://blog.csdn.net/Yangy_Jiaojiao/article/details/128145609 å‚è€ƒ(å¾…è¡¥å……): [1]. https://zhuanlan.zhihu.com/p/401341063 [2]. https://zhuanlan.zhihu.com/p/602866792 [3]. ä¸‡å­—é•¿æ–‡è¶…å…¨ C++é¢ç» ref: https://blog.csdn.net/m0_46245582/category_11569287.html ","date":"2023-07-11","objectID":"/posts/basics_one/:6:1","tags":["basics"],"title":"C++ åŸºç¡€çŸ¥è¯†[ä¸€]","uri":"/posts/basics_one/"},{"categories":["Distributed Computing"],"content":"0 æ‘˜è¦ Horovod æ˜¯Uberäº2017å¹´å‘å¸ƒçš„ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ï¼Œåœ¨ä¸šç•Œå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚ æœ¬ç³»åˆ—å°†é€šè¿‡æºç åˆ†ææ¥å¸¦é¢†å¤§å®¶äº†è§£ Horovodã€‚æœ¬æ–‡æ˜¯ç³»åˆ—ç¬¬å››ç¯‡ï¼Œçœ‹çœ‹å¦‚ä½•è·å– host ä¹‹é—´çš„è·¯ç”±ç­‰ç½‘ç»œä¿¡æ¯ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:1:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"1 å¼•å­ åœ¨ horovod/runner/launch.py æ–‡ä»¶ä¸­ï¼Œ_run_static å‡½æ•°ä¸­ä½¿ç”¨ driver_service.get_common_interfaces æ¥è·å–è·¯ç”±ä¿¡æ¯ç­‰ã€‚ def _run_static(args): nics = driver_service.get_common_interfaces(settings, all_host_names, remote_host_names, fn_cache) å› ä¸ºè¿™éƒ¨åˆ†æ¯”è¾ƒå¤æ‚ï¼ˆ Driver çš„æ¦‚å¿µå¾ˆç±»ä¼¼ Spark ä¹‹ä¸­ Driver çš„æ¦‚å¿µï¼‰ï¼Œæ‰€ä»¥æœ¬æ–‡æˆ‘ä»¬å•ç‹¬æ¥åˆ†æã€‚ æœ¬æ–‡çš„åˆ†æé—®é¢˜ç‚¹æ˜¯ï¼š ä¸ºä»€ä¹ˆè¦çŸ¥é“è·¯ç”±ä¿¡æ¯ï¼Ÿ å½“æœ‰å¤šä¸ªhostæ—¶å€™ï¼Œhorovodå¦‚ä½•å¤„ç†ï¼Ÿ å¦‚ä½•æ‰¾åˆ°è·¯ç”±ä¿¡æ¯ï¼Ÿ æ€ä¹ˆäº’ç›¸äº¤äº’ï¼Ÿ ï¼ˆåæ–‡ä¼šè¯¦ç»†åˆ†æï¼‰SparkDriverServiceï¼ŒSparkTaskServiceï¼ŒElasticDriver, Worker éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ æœ¬æ–‡é‡ç‚¹åˆ†æ HorovodRunDriverService å’Œ HorovodRunTaskService ç›¸å…³ã€‚ å…ˆç»™å‡ºä¸€ä¸ªå›¾ä¾‹ï¼Œå¤§å®¶å¯ä»¥æœ‰äº›æ¦‚å¿µã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:2:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"2 æ€»ä½“æ¶æ„ ä»æ³¨é‡Šå¯çŸ¥ï¼Œget_common_interfaces å®Œæˆäº†è·å¾—è·¯ç”±ä¿¡æ¯ï¼ˆæ‰€æœ‰hostä¹‹é—´çš„å…±æœ‰è·¯ç”±æ¥å£é›†åˆï¼‰çš„åŠŸèƒ½ï¼Œä¸»è¦æ˜¯è°ƒç”¨ _driver_fn æ¥å®Œæˆç›¸å…³å·¥ä½œã€‚ def get_common_interfaces(settings, all_host_names, remote_host_names=None, fn_cache=None): ''' Find the set of common and routed interfaces on all the hosts. ''' # å¾—åˆ°è¿œç«¯hoståœ°å€ if remote_host_names is None: remote_host_names = network.filter_local_addresses(all_host_names) if len(remote_host_names) \u003e 0: if settings.nics: # å¦‚æœå‚æ•°æœ‰è®¾å®šç½‘ç»œæ¥å£ï¼Œå°±ä½¿ç”¨ # If args.nics is provided, we will use those interfaces. All the workers # must have at least one of those interfaces available. nics = settings.nics else: # Find the set of common, routed interfaces on all the hosts (remote # and local) and specify it in the args to be used by NCCL. It is # expected that the following function will find at least one interface # otherwise, it will raise an exception. local_host_names = set(all_host_names) - set(remote_host_names) # è·å–å…¶ä»–hostçš„ç½‘ç»œæ¥å£ nics = _driver_fn(all_host_names, local_host_names, settings, fn_cache=fn_cache) else: nics = get_local_interfaces(settings) # è·å–æœ¬åœ°çš„ç½‘ç»œæ¥å£ return nics ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:3:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"2.1 get_local_interfaces æ­¤å‡½æ•°æ¯”è¾ƒç®€å•ï¼Œç›®çš„æ˜¯è·å–æœ¬åœ°çš„ç½‘ç»œæ¥å£ã€‚ def get_local_interfaces(settings): # If all the given hosts are local, find the interfaces with address # 127.0.0.1 nics = set() for iface, addrs in net_if_addrs().items(): if settings.nics and iface not in settings.nics: continue for addr in addrs: if addr.family == AF_INET and addr.address == '127.0.0.1': nics.add(iface) break return nics ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:3:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"2.2 _driver_fn è¿™æ˜¯æœ¬æ–‡é‡ç‚¹ï¼Œè·å–å…¶ä»–host çš„ç½‘ç»œæ¥å£ï¼Œ_driver_fn çš„ä½œç”¨æ˜¯ï¼š å¯åŠ¨ service æœåŠ¡ï¼› ä½¿ç”¨ driver.addresses() è·å– Driver æœåŠ¡çš„åœ°å€ï¼ˆä½¿ç”¨self._addresses = self._get_local_addresses()å®Œæˆï¼‰ï¼› ä½¿ç”¨ _launch_task_serversï¼ˆåˆ©ç”¨ Driver æœåŠ¡çš„åœ°å€ï¼‰åœ¨æ¯ä¸ª worker ä¹‹ä¸­å¯åŠ¨ task æœåŠ¡ï¼Œç„¶å task æœåŠ¡ä¼šåœ¨ service æœåŠ¡ä¸­æ³¨å†Œï¼› å› ä¸ºæ˜¯ä¸€ä¸ªç¯å½¢ï¼Œæ¯ä¸ª worker ä¼šæ¢æµ‹ worker index + 1 çš„æ‰€æœ‰ç½‘ç»œæ¥å£ï¼› æœ€å _run_probe è¿”å›ä¸€ä¸ªæ‰€æœ‰ workers ä¸Šçš„æ‰€æœ‰è·¯ç”±æ¥å£çš„äº¤é›†ï¼› ä»£ç å¦‚ä¸‹ï¼š è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼š@cache.use_cache() çš„ä½¿ç”¨ï¼šå½“ç¬¬ä¸€æ¬¡ä½¿ç”¨è¿‡ä¹‹åï¼Œä¼šæŠŠç»“æœæ”¾å…¥ç¼“å­˜ã€‚ @cache.use_cache() def _driver_fn(all_host_names, local_host_names, settings): \"\"\" launches the service service, launches the task service on each worker and have them register with the service service. Each worker probes all the interfaces of the worker index + 1 (in a ring manner) and only keeps the routed interfaces. Function returns the intersection of the set of all the routed interfaces on all the workers. :param all_host_names: list of addresses. for example, ['worker-0','worker-1'] ['10.11.11.11', '10.11.11.12'] :type all_host_names: list(string) :param local_host_names: host names that resolve into a local addresses. :type local_host_names: set :param settings: the object that contains the setting for running horovod :type settings: horovod.runner.common.util.settings.Settings :return: example: ['eth0', 'eth1'] :rtype: list[string] \"\"\" # Launch a TCP server called service service on the host running horovod # å¯åŠ¨ service æœåŠ¡ num_hosts = len(all_host_names) driver = HorovodRunDriverService(num_hosts, settings.key, settings.nics) # Have all the workers register themselves with the service service. #ï¼ˆåˆ©ç”¨ Driver æœåŠ¡çš„åœ°å€ï¼‰åœ¨æ¯ä¸ªworkerä¹‹ä¸­å¯åŠ¨ task æœåŠ¡ï¼Œç„¶åtaskæœåŠ¡ä¼šåœ¨ service æœåŠ¡ä¸­æ³¨å†Œ _launch_task_servers(all_host_names, local_host_names, driver.addresses(), settings) try: # è¿”å›ä¸€ä¸ªæ‰€æœ‰ workers ä¸Šçš„æ‰€æœ‰è·¯ç”±æ¥å£çš„äº¤é›† return _run_probe(driver, settings, num_hosts) finally: driver.shutdown() ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:3:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"2.3 è·å–è·¯ç”±æ¥å£ æˆ‘ä»¬å¯¹ _run_probe å‡½æ•°åšè¿›ä¸€æ­¥åˆ†æã€‚ 2.3.1 probeé€»è¾‘ _run_probe å‡½æ•°å°±æ˜¯å½“æ‰€æœ‰ task éƒ½å¯åŠ¨ï¼Œæ³¨å†Œï¼Œprobe ç¯ä¸­ä¸‹ä¸€ä¸ªworker é‚»å±…å®Œæˆ ä¹‹åï¼Œå¾—åˆ° æ¥å£é›†åˆã€‚ åˆ©ç”¨ wait_for_initial_registration ç­‰å¾…æ‰€æœ‰ task å®Œæˆæ³¨å†Œï¼› å¯¹äºæ‰€æœ‰ taskï¼Œå®Œæˆ task.notify_initial_registration_complete é€šçŸ¥ï¼› åˆ©ç”¨ driver.wait_for_task_to_task_address_updates ç­‰å¾… æ¯ä¸€ä¸ª worker probe å®Œæˆï¼› åˆ©ç”¨ nics.intersection_update å¾—åˆ°æ¥å£é›†åˆï¼› def _run_probe(driver, settings, num_hosts): # wait for all the hosts to register with the service service. driver.wait_for_initial_registration(settings.start_timeout) tasks = [ task_service.HorovodRunTaskClient( index, driver.task_addresses_for_driver(index), settings.key, settings.verbose) for index in range( num_hosts)] # Notify all the drivers that the initial registration is complete. for task in tasks: task.notify_initial_registration_complete() # Each worker should probe the interfaces of the next worker in a ring # manner and filter only the routed ones -- it should filter out # interfaces that are not really connected to any external networks # such as lo0 with address 127.0.0.1. driver.wait_for_task_to_task_address_updates(settings.start_timeout) # Determine a set of common interfaces for task-to-task communication. nics = set(driver.task_addresses_for_tasks(0).keys()) for index in range(1, num_hosts): nics.intersection_update( driver.task_addresses_for_tasks(index).keys()) return nics 2.3.2 ç­‰å¾…å‡½æ•° probe åˆ©ç”¨ wait_for_initial_registration ç­‰å¾…æ‰€æœ‰ task å®Œæˆæ³¨å†Œï¼Œå…·ä½“ç­‰å¾…å‡½æ•°å¦‚ä¸‹ï¼š def wait_for_initial_registration(self, timeout): self._wait_cond.acquire() try: while len(self._all_task_addresses) \u003c self._num_proc: self._wait_cond.wait(timeout.remaining()) timeout.check_time_out_for('tasks to start') finally: self._wait_cond.release() def wait_for_task_to_task_address_updates(self, timeout): self._wait_cond.acquire() try: while len(self._task_addresses_for_tasks) \u003c self._num_proc: self._wait_cond.wait(timeout.remaining()) timeout.check_time_out_for( 'tasks to update task-to-task addresses') finally: self._wait_cond.release() ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:3:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"3 åŸºç¡€ç½‘ç»œæœåŠ¡ å‰é¢æåˆ°ï¼ŒHorovod Driver çš„æ¦‚å¿µå¾ˆç±»ä¼¼ Spark ä¹‹ä¸­ Driver çš„æ¦‚å¿µã€‚Sparkåº”ç”¨ç¨‹åºè¿è¡Œæ—¶ä¸»è¦åˆ†ä¸º Driver å’Œ Executorï¼ŒDriverè´Ÿè´£æ€»ä½“è°ƒåº¦åŠUIå±•ç¤ºï¼ŒExecutorè´Ÿè´£Taskè¿è¡Œã€‚ç”¨æˆ·çš„Sparkåº”ç”¨ç¨‹åºè¿è¡Œåœ¨Driverä¸Šï¼ˆæŸç§ç¨‹åº¦ä¸Šè¯´ï¼Œç”¨æˆ·çš„ç¨‹åºå°±æ˜¯Spark Driverç¨‹åºï¼‰ï¼Œç»è¿‡Sparkè°ƒåº¦å°è£…æˆä¸€ä¸ªä¸ªTaskï¼Œå†å°†è¿™äº›Taskä¿¡æ¯å‘ç»™Executoræ‰§è¡Œï¼ŒTaskä¿¡æ¯åŒ…æ‹¬ä»£ç é€»è¾‘ä»¥åŠæ•°æ®ä¿¡æ¯ï¼ŒExecutorä¸ç›´æ¥è¿è¡Œç”¨æˆ·çš„ä»£ç ã€‚ å¯¹äº Horovod æ¥è¯´ï¼š HorovodRunDriverService å°±æ˜¯ Driver çš„å®ç°ç±»ã€‚ HorovodRunTaskService æä¾›äº† Task éƒ¨åˆ†æœåŠ¡åŠŸèƒ½ï¼Œè¿™äº› task éœ€è¦æ³¨å†Œåˆ° HorovodRunDriverService ä¹‹ä¸­ã€‚ è¿™å¥— driver \u0026 task æœºåˆ¶çš„åº•å±‚ç”± â€œåŸºç¡€ç½‘ç»œæœåŠ¡â€ æ”¯æ’‘ã€‚ æ‰€ä»¥æˆ‘ä»¬å°±ä»”ç»†åˆ†æä¸‹åŸºç¡€ç½‘ç»œæœåŠ¡ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:4:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"3.1 ç»§æ‰¿å…³ç³» é¦–å…ˆç»™å‡ºç»§æ‰¿å…³ç³»ï¼Œæˆ‘ä»¬ä¸‹é¢è®²è§£çš„ Driver æœåŠ¡ç”± HorovodRunDriverService æä¾›ï¼ŒTask æœåŠ¡ç”±HorovodRunTaskService æä¾›ã€‚ è¿™ä¸¤ä¸ªç±»æœ€ç»ˆéƒ½ç»§æ‰¿äº† network.BasicServiceã€‚ network.BasicService ^ ^ | | +-------------------+ +-------------+ | | + + driver_service.BasicDriverService task_service.BasicTaskService ^ ^ | | | | | | + + HorovodRunDriverService HorovodRunTaskService ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:4:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"3.2 network.BasicService BasicService æä¾›äº†ä¸€ä¸ªç½‘ç»œæœåŠ¡å™¨åŠŸèƒ½ã€‚å³é€šè¿‡find_portå‡½æ•°æ„å»ºäº†ä¸€ä¸ªThreadingTCPServerå¯¹å¤–æä¾›æœåŠ¡ã€‚ class BasicService(object): def __init__(self, service_name, key, nics): self._service_name = service_name self._wire = Wire(key) self._nics = nics self._server, _ = find_port( lambda addr: socketserver.ThreadingTCPServer( addr, self._make_handler())) self._server._block_on_close = True self._port = self._server.socket.getsockname()[1] self._addresses = self._get_local_addresses() self._thread = in_thread(target=self._server.serve_forever) 3.2.1 åˆ›å»ºServer åˆ›å»ºæœåŠ¡å™¨ä»£ç å¦‚ä¸‹ï¼Œè¿™é‡Œæ˜¯æœç´¢ä¸€ä¸ªéšæœºç«¯å£ï¼Œç„¶åè®¾ç½®ï¼š def find_port(server_factory): min_port = 1024 max_port = 65536 num_ports = max_port - min_port start_port = random.randrange(0, num_ports) for port_offset in range(num_ports): try: port = min_port + (start_port + port_offset) % num_ports addr = ('', port) server = server_factory(addr) return server, port except Exception as e: pass raise Exception('Unable to find a port to bind to.') 3.2.2 ServeråŠŸèƒ½ æœåŠ¡å™¨å°±æ˜¯åŸºæœ¬çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è·å–æœ¬serveråœ°å€ï¼Œå¤„ç† pingï¼Œç½‘ç»œäº¤äº’ç­‰ã€‚ def _make_handler(self): server = self class _Handler(socketserver.StreamRequestHandler): def handle(self): try: req = server._wire.read(self.rfile) resp = server._handle(req, self.client_address) # A tuple is the usual response object followed by a utf8 text stream if type(resp) == tuple: (resp, stream) = resp server._wire.write(resp, self.wfile) server._wire.stream(stream, self.wfile) else: server._wire.write(resp, self.wfile) except (EOFError, BrokenPipeError): # Happens when client is abruptly terminated, don't want to pollute the logs. pass return _Handler def _handle(self, req, client_address): if isinstance(req, PingRequest): return PingResponse(self._service_name, client_address[0]) raise NotImplementedError(req) def _get_local_addresses(self): result = {} for intf, intf_addresses in psutil.net_if_addrs().items(): if self._nics and intf not in self._nics: continue for addr in intf_addresses: if addr.family == socket.AF_INET: if intf not in result: result[intf] = [] result[intf].append((addr.address, self._port)) return result def addresses(self): return self._addresses.copy() def shutdown(self): self._server.shutdown() self._server.server_close() self._thread.join() def get_port(self): return self._port ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:4:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"3.3 network.BasicClient HorovodRunDriverClient å’Œ HorovodRunTaskClient è¿™ä¸¤ä¸ªç±»éƒ½ç»§æ‰¿äº†network.BasicClientã€‚ network.BasicClient çš„ä½œç”¨å°±æ˜¯è¿æ¥ network.BasicServiceï¼Œä¸å…¶äº¤äº’ã€‚å³ network.BasicClient æ˜¯ä¸€ä¸ªæ“ä½œæ¥å£ã€‚ network.BasicClient ^ ^ | | +------------------+ +---------------+ | | + | + driver_service.BasicDriverClient task_service.BasicTaskClient ^ ^ | | | | + + HorovodRunDriverClient HorovodRunTaskClient ä¸¤ä¸ªä¸»è¦ API å¦‚ä¸‹ï¼š 3.3.1 _probe _probe è·å– server çš„ç½‘ç»œæ¥å£ã€‚ def _probe(self, addresses): result_queue = queue.Queue() threads = [] for intf, intf_addresses in addresses.items(): for addr in intf_addresses: thread = in_thread(target=self._probe_one, args=(intf, addr, result_queue)) threads.append(thread) for t in threads: t.join() result = {} while not result_queue.empty(): intf, addr = result_queue.get() if intf not in result: result[intf] = [] result[intf].append(addr) return result 3.3.2 å‘é€æ¶ˆæ¯ _send çš„ä½œç”¨æ˜¯ç»™serverå‘é€æ¶ˆæ¯ã€‚ def _send(self, req, stream=None): \"\"\" Sends the request and returns the response object. Streaming data response is transferred to the optional stream parameter. \"\"\" # Since all the addresses were vetted, use the first one. addr = list(self._addresses.values())[0][0] return self._send_one(addr, req, stream) ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:4:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"3.4 æ€»ç»“ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œnetwork.BasicService ä¼šæä¾›äº†ä¸€ä¸ªserverï¼Œè¿™ä¸ª Service éƒ½æ˜¯é€šè¿‡ network.BasicClient æ¥è®¿é—®ã€‚åŸºäºæ­¤ï¼ŒHorovod çš„HorovodRunDriverService å’Œ HorovodRunTaskService è¿™ä¸¤ä¸ªç±»å°±å¯ä»¥äº’ç›¸äº¤äº’ï¼Œè¿›è¡Œæ²Ÿé€šã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:4:4","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"4 Driver æœåŠ¡ Driver æœåŠ¡ç”± HorovodRunDriverService æä¾›ï¼Œå…¶åŠŸèƒ½ä¸»è¦æ˜¯ç»´æŠ¤ç»´æŠ¤å„ç§ task åœ°å€ä»¥åŠç›¸åº”å…³ç³»ã€‚å…·ä½“å„ç§ task åœ°å€ å°±æ˜¯ Task æœåŠ¡ æ¥æ³¨å†Œçš„ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šHorovodRunDriverService å’Œ HorovodRunTaskService éƒ½æœ€ç»ˆç»§æ‰¿äº† network.BasicServiceï¼Œä»–ä»¬ä¹‹é—´å¯ä»¥æ˜¯å¼‚åœ°è¿è¡Œäº¤äº’ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:5:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"4.1 HorovodRunDriverService HorovodRunDriverService æ˜¯å¯¹ BasicDriverService çš„å°è£…ã€‚ HorovodRunDriverClient æ˜¯ å…¶ è®¿é—®æ¥å£ã€‚ class HorovodRunDriverService(driver_service.BasicDriverService): NAME = 'horovod driver service' def __init__(self, num_hosts, key, nics): super(HorovodRunDriverService, self).__init__(num_hosts, HorovodRunDriverService.NAME, key, nics) class HorovodRunDriverClient(driver_service.BasicDriverClient): def __init__(self, driver_addresses, key, verbose, match_intf=False): super(HorovodRunDriverClient, self).__init__( HorovodRunDriverService.NAME, driver_addresses, key, verbose, match_intf=match_intf) ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:5:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"4.2 BasicDriverService BasicDriverServiceåŸºç±» ä¸»è¦å°±æ˜¯ ç»´æŠ¤å„ç§ task åœ°å€ä»¥åŠç›¸åº”å…³ç³»ã€‚ class BasicDriverService(network.BasicService): def __init__(self, num_proc, name, key, nics): super(BasicDriverService, self).__init__(name, key, nics) self._num_proc = num_proc self._all_task_addresses = {} self._task_addresses_for_driver = {} self._task_addresses_for_tasks = {} self._task_index_host_hash = {} self._task_host_hash_indices = {} self._wait_cond = threading.Condition() è¿™é‡Œçš„å„ç§ task åœ°å€å°±æ˜¯ Task æœåŠ¡ æ³¨å†Œåˆ° Driver çš„æ•°å€¼ã€‚ å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰å„ç§å…³äºåœ°å€çš„å˜é‡ï¼Œä¸ºäº†è®©å¤§å®¶ç†è§£è¿™äº›å˜é‡çš„ä½œç”¨ï¼Œå¯¹äºæ¯ä¸€ä¸ªå˜é‡æˆ‘ä»¬ä¸¾ä¾‹å¦‚ä¸‹ï¼ˆè¿™é‡Œæœ‰äº›å˜é‡æ˜¯ä¸“é—¨ä¸º spark è®¾è®¡ï¼Œéƒ½æ”¾åˆ°åŸºç±»é‡Œé¢æœ‰ç‚¹å¥‡æ€ªï¼‰ï¼š 4.2.1 _all_task_addresses æœ¬å˜é‡æ˜¯è®°å½•äº†æ‰€æœ‰ task çš„åœ°å€ï¼Œå˜é‡ä¸¾ä¾‹å¦‚ä¸‹ï¼š self._all_task_addresses = { 1: { 'lo' : [('1.1.1.1', 12345)], 'eth0' : [('10.10.10.01', 12345)] }, 0: { 'lo' : [('2.2.2.2', 54321)], 'eth0' : [('10.10.10.02', 54321)] } } æœ¬å˜é‡ç”± task è°ƒç”¨ RegisterTaskRequest æ¥æ³¨å†Œã€‚ if isinstance(req, RegisterTaskRequest): self._wait_cond.acquire() try: assert 0 \u003c= req.index \u003c self._num_proc self._all_task_addresses[req.index] = req.task_addresses 4.2.2 _task_addresses_for_driver æœ¬å˜é‡æ˜¯è®°å½•äº†æ‰€æœ‰ task çš„åœ°å€ï¼Œä½†æ˜¯ç½‘å¡æ¥å£æœ‰å¤šç§ï¼Œè¿™é‡Œé€‰æ‹©ä¸ æœ¬ driver åœ°å€åŒ¹é…çš„åœ°å€ã€‚ å˜é‡ä¸¾ä¾‹å¦‚ä¸‹ï¼š self._task_addresses_for_driver = { 1: { 'eth0' : [('10.10.10.01', 12345)] }, 0: { 'eth0' : [('10.10.10.02', 54321)] } } æœ¬å˜é‡ç”± task è°ƒç”¨ RegisterTaskRequest æ¥æ³¨å†Œã€‚ # Just use source address for service for fast probing. self._task_addresses_for_driver[req.index] = \\ self._filter_by_ip(req.task_addresses, client_address[0]) å…·ä½“ä½¿ç”¨ä¸¾ä¾‹å¦‚ä¸‹ï¼š def task_addresses_for_driver(self, index): self._wait_cond.acquire() try: return self._task_addresses_for_driver[index].copy() finally: self._wait_cond.release() driverç”¨è¿™ä¸ªåœ°å€æ¥ç”Ÿæˆ å…¶å†…éƒ¨ task å˜é‡ã€‚ tasks = [ task_service.HorovodRunTaskClient( index, driver.task_addresses_for_driver(index), settings.key, settings.verbose) for index in range( num_hosts)] 4.2.3 _task_addresses_for_tasks è¯¥å˜é‡ä¸¾ä¾‹å¦‚ä¸‹ï¼š self._task_addresses_for_tasks = { 1: { 'eth0' : [('10.10.10.01', 12345)] }, 0: { 'eth0' : [('10.10.10.02', 54321)] } } æœ¬å˜é‡ç”±RegisterTaskToTaskAddressesRequestæ³¨å†Œã€‚ if isinstance(req, RegisterTaskToTaskAddressesRequest): self.register_task_to_task_addresses(req.index, req.task_addresses) return network.AckResponse() def register_task_to_task_addresses(self, index, task_addresses): self._wait_cond.acquire() try: assert 0 \u003c= index \u003c self._num_proc self._task_addresses_for_tasks[index] = task_addresses # è¿™é‡Œèµ‹å€¼ finally: self._wait_cond.notify_all() self._wait_cond.release() è¯¥å˜é‡è¢« task ç”¨æ¥è·å– æŸä¸ª task çš„ä¸€å¥—ç½‘ç»œæ¥å£ï¼Œæ¯”å¦‚ï¼š # Determine a set of common interfaces for task-to-task communication. nics = set(driver.task_addresses_for_tasks(0).keys()) 4.2.4 _task_index_host_hash æ¯ä¸€ä¸ª task æœ‰ä¸€ä¸ªå¯¹åº”çš„ host hashï¼Œè¯¥æ•°å€¼è¢« MPI ä½œä¸º host name æ¥æ“ä½œã€‚ self._task_index_host_hash = { 1: { 'ip-10-10-10-01-dfdsfdsfdsfdsf2' }, 0: { 'ip-10-10-10-02-treterwrtqwer' } } å…·ä½“ä½¿ç”¨å¦‚ä¸‹ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ spark ç›¸å…³ä¼šä½¿ç”¨ï¼Œå…·ä½“æ˜¯é€ä¸€é€šçŸ¥ spark task è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚ def task_indices(self): self._wait_cond.acquire() try: return list(self._task_index_host_hash.keys()) finally: self._wait_cond.release() æˆ–è€…ä½¿ç”¨å¦‚ä¸‹ï¼Œæ˜¯ä¸ºäº†è·å–æŸä¸€ä¸ª host å¯¹åº”çš„ host hash nameã€‚ def task_index_host_hash(self, index): self._wait_cond.acquire() try: assert 0 \u003c= index \u003c self._num_proc return self._task_index_host_hash[index] finally: self._wait_cond.release() 4.2.5 _task_host_hash_indices è¯¥å˜é‡ä¸¾ä¾‹å¦‚ä¸‹ï¼š self._task_host_hash_indices = { { 'ip-10-10-10-01-dfdsfdsfdsfdsf2' : [1] }, { 'ip-10-10-10-02-treterwrtqwer' : [0] } } å…·ä½“æ˜¯åœ¨æ³¨å†Œ RegisterTaskRequest æ—¶å€™ç”Ÿæˆã€‚ self._task_host_hash_indices[req.host_hash].append(req.index) ä½¿ç”¨å…·ä½“ä»£ç æ˜¯ï¼š def task_host_hash_indices(self): self._wait_cond.acquire() try: return self._task_host_hash_indices.copy() finally: self._wait_cond.release() å…·ä½“æ˜¯è¢« rsh ä½¿ç”¨ã€‚rsh å°±æ˜¯åœ¨æŸä¸€ä¸ª host ä¸Šï¼Œè®©æŸä¸€ä¸ª horovod rank å¯åŠ¨ã€‚å…·ä½“é€»è¾‘æ˜¯ï¼š è·å–æŸä¸€ä¸ª host ä¸Šæ‰€æœ‰çš„ task indices ï¼› åˆ©ç”¨ task_host_hash_indices å–å‡ºæœ¬è¿›ç¨‹ local rank å¯¹åº”çš„ task indexï¼› å–å‡ºåœ¨ driver ä¸­ task index å¯¹åº”ä¿æŒçš„ task addressï¼› æœ€åä¾æ®è¿™ä¸ª task addresses ç”Ÿæˆä¸€ä¸ª SparkTaskClientï¼Œè¿›è¡Œåç»­æ“ä½œã€‚ driver_client = driver_service.SparkDriverClient(driver_addresses, key, verbose=verbose) task_indices = driver_client.task_host_hash_indices(host_hash) task_index = task_indices[local_rank] tas","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:5:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"4.3 æ€»ä½“é€»è¾‘ æ€»ä½“é€»è¾‘å¦‚ä¸‹ï¼š network.BasicService ^ ^ | | +-------------------+ +-------------+ | | + + driver_service.BasicDriverService task_service.BasicTaskService ^ ^ | | | | | | | + +----------------+------------------+ HorovodRunTaskService | HorovodRunDriverService | | | | | | _all_task_addresses | | | | _task_addresses_for_driver | | | | _task_addresses_for_tasks | | | | _task_index_host_hash | | | | _task_host_hash_indices | | | +-----------------------------------+ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:5:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"5 Task æœåŠ¡ HorovodRunTaskService æä¾›äº† Task éƒ¨åˆ†æœåŠ¡åŠŸèƒ½ã€‚æ•´ä½“é€»è¾‘æ˜¯ç”±å‡ ä¸ªå‡½æ•°å…±åŒå®Œæˆã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:6:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"5.1 å¯åŠ¨å…·ä½“æœåŠ¡ _launch_task_servers ç”¨æ¥å¯åŠ¨å…·ä½“æœåŠ¡ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯ï¼šå¤šçº¿ç¨‹è¿è¡Œï¼Œåœ¨æ¯ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œè¿œç¨‹è¿è¡Œ horovod.runner.task_fnã€‚ å…¶ä¸­ï¼š ä¼ å…¥å‚æ•°ä¸­ï¼Œall_host_names å°±æ˜¯ç¨‹åºå¯åŠ¨æ—¶å€™é…ç½®çš„æ‰€æœ‰hostï¼Œæ¯”å¦‚ [â€œ1.1.1.1â€, â€œ2.2.2.2â€]ï¼› ä½¿ç”¨äº†æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ safe_shell_exec.execute å®Œæˆäº†å®‰å…¨è¿è¡Œä¿è¯ï¼› ä½¿ç”¨æˆ‘ä»¬å‰æ–‡æåˆ°çš„ get_remote_command å®Œæˆäº†è¿œç¨‹å‘½ä»¤çš„è·å–ï¼Œå³åœ¨å‘½ä»¤ä¹‹å‰åŠ ä¸Šäº† ssh -o PasswordAuthentication=no -o StrictHostKeyChecking=noç­‰ç­‰é…ç½®ï¼› æœ€ç»ˆæ¯ä¸ªå¯åŠ¨çš„å‘½ä»¤ä¸¾ä¾‹å¦‚ä¸‹ï¼š ssh -o PasswordAuthentication=no -o StrictHostKeyChecking=no 1.1.1.1 python -m horovod.runner.task_fn xxxxxxxï¼› ä½¿ç”¨ execute_function_multithreaded åœ¨æ¯ä¸€ä¸ª host ä¸Šè¿è¡Œï¼Œå¯åŠ¨ task æœåŠ¡ï¼› å…·ä½“ä»£ç å¦‚ä¸‹ï¼š def _launch_task_servers(all_host_names, local_host_names, driver_addresses, settings): \"\"\" Executes the task server and service client task for registration on the hosts. :param all_host_names: list of addresses. for example, ['worker-0','worker-1'] ['10.11.11.11', '10.11.11.12'] :type all_host_names: list(string) :param local_host_names: names that are resolved to one of the addresses of local hosts interfaces. For example, set(['localhost', '127.0.0.1']) :type local_host_names: set :param driver_addresses: map of interfaces and their address and port for the service. For example: { 'lo': [('127.0.0.1', 34588)], 'docker0': [('172.122.10.1', 34588)], 'eth0': [('11.111.33.73', 34588)] } :type driver_addresses: map :param settings: the object that contains the setting for running horovod :type settings: horovod.runner.common.util.settings.Settings :return: :rtype: \"\"\" def _exec_command(command): host_output = io.StringIO() try: # å®Œæˆäº†å®‰å…¨è¿è¡Œä¿è¯ exit_code = safe_shell_exec.execute(command, stdout=host_output, stderr=host_output) finally: host_output.close() return exit_code args_list = [] num_hosts = len(all_host_names) for index in range(num_hosts): host_name = all_host_names[index] # all_host_names å°±æ˜¯ç¨‹åºå¯åŠ¨æ—¶å€™é…ç½®çš„æ‰€æœ‰hostï¼Œæ¯”å¦‚ [\"1.1.1.1\", \"2.2.2.2\"] command = \\ '{python} -m horovod.runner.task_fn {index} {num_hosts} ' \\ '{driver_addresses} {settings}' \\ .format(python=sys.executable, index=codec.dumps_base64(index), num_hosts=codec.dumps_base64(num_hosts), driver_addresses=codec.dumps_base64(driver_addresses), settings=codec.dumps_base64(settings)) if host_name not in local_host_names: # å®Œæˆäº†è¿œç¨‹å‘½ä»¤çš„è·å–ï¼Œå³åœ¨å‘½ä»¤ä¹‹å‰åŠ ä¸Šäº† `ssh -o PasswordAuthentication=no -o StrictHostKeyChecking=no`ç­‰ç­‰é…ç½® command = get_remote_command(command, host=host_name, port=settings.ssh_port, identity_file=settings.ssh_identity_file) args_list.append([command]) # Each thread will use ssh command to launch the server on one task. If an # error occurs in one thread, entire process will be terminated. Otherwise, # threads will keep running and ssh session -- and the the task server -- # will be bound to the thread. In case, the horovod process dies, all # the ssh sessions and all the task servers will die as well. # ä½¿ç”¨ execute_function_multithreaded åœ¨æ¯ä¸€ä¸ª host ä¸Šè¿è¡Œï¼Œå¯åŠ¨ task æœåŠ¡ threads.execute_function_multithreaded(_exec_command, args_list, block_until_all_done=False) ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:6:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"5.2 å…·ä½“æœåŠ¡é€»è¾‘ ä¸Šæ®µæœ‰ï¼š{python} -m horovod.runner.task_fn {index} {num_hosts} {driver_addresses} {settings}æ‰§è¡Œå…·ä½“æœåŠ¡é€»è¾‘ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»‹ç»ä¸‹ horovod.runner.task_fnã€‚ _task_fn å‡½æ•°å®Œæˆäº† ç”Ÿæˆäº† HorovodRunTaskService å®ä¾‹ï¼Œèµ‹å€¼ç»™ taskï¼› ä½¿ç”¨ HorovodRunDriverClient . register_task æ¥å‘ Driver æœåŠ¡æ³¨å†Œtaskï¼ˆè‡ªå·±ï¼‰çš„åœ°å€ï¼› ä½¿ç”¨ HorovodRunDriverClient . register_task_to_task_addresses æ¥å‘ Driver æœåŠ¡æ³¨å†Œè‡ªå·±åœ¨Ringä¸Š ä¸‹ä¸€ä¸ªé‚»å±…çš„åœ°å€ï¼› æ¯ä¸€ä¸ª task éƒ½åšè¿™ä¸ªæ“ä½œï¼Œæœ€åå°±å¾—åˆ°äº†åœ¨è¿™ä¸ª ring cluster ä¹‹ä¸­çš„ä¸€ä¸ªè·¯ç”±æ¥å£ï¼› å…·ä½“ä»£ç å¦‚ä¸‹ï¼š def _task_fn(index, num_hosts, driver_addresses, settings): task = task_service.HorovodRunTaskService(index, settings.key, settings.nics) try: driver = driver_service.HorovodRunDriverClient( driver_addresses, settings.key, settings.verbose) # å‘ Driver æœåŠ¡æ³¨å†Œtaskï¼ˆè‡ªå·±ï¼‰çš„åœ°å€ driver.register_task(index, task.addresses(), host_hash.host_hash()) task.wait_for_initial_registration(settings.start_timeout) # Tasks ping each other in a circular fashion to determine interfaces # reachable within the cluster. next_task_index = (index + 1) % num_hosts next_task_addresses = driver.all_task_addresses(next_task_index) # We request interface matching to weed out all the NAT'ed interfaces. next_task = task_service.HorovodRunTaskClient( next_task_index, next_task_addresses, settings.key, settings.verbose, match_intf=True, attempts=10) # å‘ Driver æœåŠ¡æ³¨å†Œè‡ªå·±åœ¨Ringä¸Š ä¸‹ä¸€ä¸ªé‚»å±…çš„åœ°å€ driver.register_task_to_task_addresses(next_task_index, next_task.addresses()) # Notify the next task that the address checks are completed. next_task.task_to_task_address_check_completed() # Wait to get a notification from previous task that its address checks # are completed as well. task.wait_for_task_to_task_address_check_finish_signal(settings.start_timeout) finally: task.shutdown() if __name__ == '__main__': index = codec.loads_base64(sys.argv[1]) num_hosts = codec.loads_base64(sys.argv[2]) driver_addresses = codec.loads_base64(sys.argv[3]) settings = codec.loads_base64(sys.argv[4]) _task_fn(index, num_hosts, driver_addresses, settings) ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:6:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"5.3 HorovodRunTaskService HorovodRunTaskService ä¸»è¦çš„ä½œç”¨æ˜¯æä¾›äº†ä¸¤ä¸ªç­‰å¾…å‡½æ•°ã€‚å› ä¸ºå…·ä½“è·¯ç”±æ“ä½œæ˜¯éœ€è¦å½¼æ­¤é€šçŸ¥ï¼Œæ‰€ä»¥éœ€è¦äº’ç›¸ç­‰å¾…ã€‚ class HorovodRunTaskService(task_service.BasicTaskService): NAME_FORMAT = 'horovod task service #%d' def __init__(self, index, key, nics): super(HorovodRunTaskService, self).__init__( HorovodRunTaskService.NAME_FORMAT % index, index, key, nics) self.index = index self._task_to_task_address_check_completed = False def _handle(self, req, client_address): if isinstance(req, TaskToTaskAddressCheckFinishedSignal): self._wait_cond.acquire() try: self._task_to_task_address_check_completed = True finally: self._wait_cond.notify_all() self._wait_cond.release() return TaskToTaskAddressCheckFinishedSignalResponse(self.index) return super(HorovodRunTaskService, self)._handle(req, client_address) def wait_for_task_to_task_address_check_finish_signal(self, timeout): self._wait_cond.acquire() try: while not self._task_to_task_address_check_completed: self._wait_cond.wait(timeout.remaining()) timeout.check_time_out_for('Task to task address check') finally: self._wait_cond.release() class HorovodRunTaskClient(task_service.BasicTaskClient): def __init__(self, index, task_addresses, key, verbose, match_intf=False, attempts=3): super(HorovodRunTaskClient, self).__init__( HorovodRunTaskService.NAME_FORMAT % index, task_addresses, key, verbose, match_intf=match_intf, attempts=attempts) self.index = index def task_to_task_address_check_completed(self): resp = self._send(TaskToTaskAddressCheckFinishedSignal(self.index)) return resp.index é€»è¾‘å¦‚ä¸‹ï¼š _driver_fn + | | +---------------------------------------+-------------------------------------v | | | v | _launch_task_servers v + driver = HorovodRunDriverService | + +--------------+-------------------+ | | | | | | v v v +-------------------+---------------+ horovod.runner.task_fn ...... horovod.runner.task_fn | HorovodRunDriverService | + + | | | | | | | | | _all_task_addresses | | | | | v v | _task_addresses_for_driver | register_task +-----------+---------------+ +-------+--------------------+ | | | HorovodRunTaskService | | HorovodRunTaskService | | _task_addresses_for_tasks | \u003c--------------------------------+ | | | | | | | wait | | | _task_index_host_hash | | | \u003c------\u003e | | | | \u003c--------------------------------+ | | | | _task_host_hash_indices | register_task_to_task_addresses | | | | | | +---------------------------+ +----------------------------+ +-----------------------------------+ ` å›¾ç¤º: ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:6:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"6 æ€»ç»“ æœ¬æ–‡æ€»ç»“å¦‚ä¸‹ï¼š å› ä¸º Horovod åˆ†å¸ƒå¼è®­ç»ƒ æ¶‰åŠåˆ°å¤šä¸ª hostsï¼Œæ‰€ä»¥å¦‚æœè¦å½¼æ­¤è®¿é—®ï¼Œéœ€è¦çŸ¥é“è·¯ç”±ä¿¡æ¯ï¼› å½“æ‰€æœ‰ task éƒ½å¯åŠ¨ï¼Œæ³¨å†Œï¼Œprobe ç¯ä¸­ä¸‹ä¸€ä¸ªworker é‚»å±…å®Œæˆ ä¹‹åï¼ŒDriverService ä¼šå¾—åˆ°è·¯ç”±ä¿¡æ¯ï¼ˆæ‰€æœ‰hostä¹‹é—´çš„å…±æœ‰è·¯ç”±æ¥å£é›†åˆï¼‰ï¼Œè¿”å›ç»™ Horovod ä¸»ä½“éƒ¨åˆ†ä½¿ç”¨ï¼› network.BasicService æä¾›äº†ç½‘ç»œæœåŠ¡åŠŸèƒ½ï¼› XXXService éƒ½æ˜¯é€šè¿‡ XXXClientä½œä¸ºæ¥å£æ‰èƒ½è®¿é—®ï¼› HorovodRunDriverService å’Œ HorovodRunTaskService éƒ½æœ€ç»ˆç»§æ‰¿äº† network.BasicServiceï¼Œä»–ä»¬ä¹‹é—´å¯ä»¥æ˜¯å¼‚åœ°è¿è¡Œäº¤äº’ã€‚ HorovodRunTaskService æä¾›äº† Task éƒ¨åˆ†æœåŠ¡åŠŸèƒ½ï¼Œè¿™äº› task éœ€è¦æ³¨å†Œåˆ° Driver ä¹‹ä¸­ï¼ˆå’ŒSparkæ€è·¯ç±»ä¼¼ï¼‰ã€‚ HorovodRunDriverService æ˜¯å¯¹ BasicDriverService çš„å°è£…ã€‚BasicDriverService å°±æ˜¯ ç»´æŠ¤å„ç§ task åœ°å€ä»¥åŠç›¸åº”å…³ç³»ï¼Œæ¯”å¦‚ï¼š _all_task_addresses ï¼šè®°å½•äº†æ‰€æœ‰ task çš„åœ°å€ï¼› _task_addresses_for_driver ï¼šè®°å½•äº†æ‰€æœ‰ task çš„åœ°å€ï¼Œä½†æ˜¯å› ä¸ºç½‘å¡æ¥å£æœ‰å¤šç§ï¼Œè¿™é‡Œé€‰æ‹©ä¸ æœ¬driver åœ°å€åŒ¹é…çš„åœ°å€ï¼› _task_addresses_for_tasks ï¼šç”¨æ¥ç»™æŸä¸€ä¸ª task åˆ†é…ä¸€ä¸ªåœ°å€ï¼ŒåŒæ—¶è·å–æœ¬ task çš„ä¸€å¥—ç½‘ç»œæ¥å£ï¼› _task_index_host_hash ï¼šæ¯ä¸€ä¸ª task æœ‰ä¸€ä¸ªå¯¹åº”çš„ host hashã€‚è¿™ä¸ªå‡½æ•°æ˜¯ spark ç›¸å…³ä¼šä½¿ç”¨ï¼Œå…·ä½“æ˜¯é€ä¸€é€šçŸ¥ spark task è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚æˆ–è€…æ˜¯ä¸ºäº†è·å–æŸä¸€ä¸ª host å¯¹åº”çš„ host hash nameï¼› _task_host_hash_indices ï¼šå…·ä½“æ˜¯è¢« rsh ä½¿ç”¨ï¼Œç”± rank å¾—åˆ° åœ¨ driver ä¸­ task index å¯¹åº”ä¿æŒçš„ task addressï¼› SparkDriverServiceï¼ŒSparkTaskServiceï¼ŒElasticDriver, Worker éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ HorovodRunDriverService è¿™é‡Œåªæ˜¯ç”¨æ¥å¾—åˆ°è·¯ç”±ä¿¡æ¯ï¼Œè®°å½•å„ç§ Task åœ°å€ï¼› SparkDriverService é™¤äº†è®°å½•è·¯ç”±å’Œåœ°å€ä¹‹å¤–ï¼Œè¿˜æäº¤æ‰§è¡Œä»»åŠ¡ï¼ˆCommandï¼‰ï¼Œå› ä¸ºå…·ä½“åœ¨å“ªä¸€ä¸ªSpark Executorå¯åŠ¨ä¹‹åï¼ŒSparkDriverService å°±éœ€è¦çŸ¥é“ å¯¹åº” SparkTaskService çš„åœ°å€ï¼Œè¿™æ ·æ‰èƒ½çŸ¥é“æäº¤åˆ°å“ªé‡Œï¼› SparkTaskService è´Ÿè´£æ‰§è¡Œå‘½ä»¤ï¼ˆæŠ›å¼ƒäº†Spark Executorçš„é€»è¾‘ï¼Œè‡ªå·±æäº†ä¸€å¥—ï¼‰ï¼Œå°±æ˜¯ä» SparkDriverService é‚£é‡Œè·å¾—è®­ç»ƒå‡½æ•°ï¼Œç„¶åå¯åŠ¨ python è¿›ç¨‹æ¥æ‰§è¡Œï¼› ElasticDriver åšå¾—æ›´å¤šï¼Œå› ä¸ºè¿˜æœ‰å¼¹æ€§ï¼Œéœ€è¦å®¹é”™ï¼› references: [1]. https://www.cnblogs.com/rossiXYZ/p/14882053.html [2]. https://www.zhihu.com/column/c_1491039346714746880 ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_4/:7:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[4] -- ç½‘ç»œåŸºç¡€ \u0026 Driver","uri":"/posts/2022-10-08_horovod_4/"},{"categories":["Distributed Computing"],"content":"references: [1]. https://www.cnblogs.com/rossiXYZ/p/14881812.html ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:0:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"0 æ‘˜è¦ Horovod æ˜¯Uberäº2017å¹´å‘å¸ƒçš„ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ï¼Œåœ¨ä¸šç•Œå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚ æœ¬ç³»åˆ—å°†é€šè¿‡æºç åˆ†ææ¥å¸¦é¢†å¤§å®¶äº†è§£ Horovodã€‚æœ¬æ–‡æ˜¯ç³»åˆ—ç¬¬ä¸‰ç¯‡ï¼Œä» python å¼€å§‹è¿›å…¥ Horovod ä¸–ç•Œï¼Œçœ‹çœ‹ Horovodrun åšäº†ä»€ä¹ˆã€‚ å‰ä¸¤ç¯‡é“¾æ¥å¦‚ä¸‹ï¼š æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod (1) â€” åŸºç¡€çŸ¥è¯† æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod (2) â€” ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:1:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"1 èƒŒæ™¯çŸ¥è¯† é¦–å…ˆä»‹ç»ä¸€äº›ç›¸å…³èƒŒæ™¯çŸ¥è¯†ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:2:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"1.1 åˆ†å¸ƒå¼ä½“ç³» åœ¨è®¾è®¡å¹¶è¡Œè®¡ç®—æœºæ—¶ï¼Œæœ€ç›´æ¥çš„æ–¹å¼å°±æ˜¯å¤šä¸ªè®¡ç®—å•å…ƒå…±äº«ä¸€ä¸ªå†…å­˜ã€‚å…±äº«å†…å­˜çš„ç¼–ç¨‹åœ¨æ•°æ®äº¤æ¢å’Œè®¿é—®ä¸Šæœ‰è¾ƒå¤§çš„ä¼˜åŠ¿ï¼Œç¨‹åºç¼–å†™èµ·æ¥æ›´åŠ ç®€å•ã€‚ä½†åœ¨æ‰©å±•æ€§ä¸Šæœ‰è¾ƒå¤§çš„ç“¶é¢ˆã€‚ å¦ä¸€ç§æ–¹å¼ä¸ºåˆ†å¸ƒå¼å†…å­˜ã€‚å³æ¯ä¸ªè®¡ç®—å•å…ƒæœ‰å•ç‹¬çš„å†…å­˜ï¼Œè®¡ç®—å•å…ƒä¹‹é—´çš„æ•°æ®è®¿é—®é€šè¿‡äº’è”ç½‘ç»œå»ä¼ è¾“ã€‚è¿™ä¸€æ¶æ„åœ¨å¯ç§»æ¤æ€§å’Œæ‰©å±•ä¸Šä¼šå¼ºå¾ˆå¤šï¼Œä½†æ¶ˆæ¯çš„ä¼ é€’ä¼šæˆä¸ºç¨‹åºè®¾è®¡ä¸­çš„éš¾ç‚¹ã€‚ å°†è¿™ä¸¤ç‚¹ç»“åˆï¼Œå³æ˜¯åˆ†å¸ƒå¼å…±äº«å†…å­˜å¹¶è¡Œè®¡ç®—æœºçš„æ¶æ„ï¼Œä¹Ÿæ˜¯å½“ä»Šæœ€å¸¸ç”¨çš„ä½“ç³»ç»“æ„ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:2:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"1.2 å¹¶è¡Œä»»åŠ¡é€šä¿¡ å¹¶è¡Œä»»åŠ¡é€šä¿¡ä¸€èˆ¬åˆ†ä¸ºP2P(Point-to-point communication)å’Œ Collective communicationã€‚ P2Pé€šä¿¡è¿™ç§æ¨¡å¼åªæœ‰ä¸€ä¸ªsenderå’Œä¸€ä¸ªreceiverï¼Œå³ç‚¹åˆ°ç‚¹é€šä¿¡. Collective communicationå«å¤šä¸ªsenderå¤šä¸ªreceive Collective communicationåŒ…å«ä¸€äº›å¸¸è§çš„åŸè¯­ broadcast reduceï¼Œallreduce scatterï¼Œscatter reduce gatherï¼Œallgather ring-base collectives ring-allreduce ä¼ ç»ŸCollective communicationå‡è®¾é€šä¿¡èŠ‚ç‚¹ç»„æˆçš„topologyæ˜¯ä¸€é¢—fat treeï¼Œè¿™æ ·é€šä¿¡æ•ˆç‡æœ€é«˜ã€‚ä½†å®é™…çš„é€šä¿¡topologyå¯èƒ½æ¯”è¾ƒå¤æ‚ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªfat treeã€‚å› æ­¤ä¸€èˆ¬ç”¨ring-based Collective communicationã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:2:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"1.3 MPI MPI(Message Passing Interface) æ˜¯ä¸€ç§å¯ä»¥æ”¯æŒç‚¹å¯¹ç‚¹å’Œå¹¿æ’­çš„é€šä¿¡åè®®ï¼Œå…·ä½“å®ç°çš„åº“æœ‰å¾ˆå¤šï¼Œä½¿ç”¨æ¯”è¾ƒæµè¡Œçš„åŒ…æ‹¬ Open Mpiï¼Œ Intel MPI ç­‰ç­‰ã€‚ MPI æ˜¯ä¸€ç§æ¶ˆæ¯ä¼ é€’ç¼–ç¨‹æ¨¡å‹ã€‚æ¶ˆæ¯ä¼ é€’æŒ‡ç”¨æˆ·å¿…é¡»é€šè¿‡æ˜¾å¼åœ°å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ¥å®ç°å¤„ç†å™¨é—´çš„æ•°æ®äº¤æ¢ã€‚åœ¨è¿™ç§å¹¶è¡Œç¼–ç¨‹ä¸­ï¼Œæ¯ä¸ªæ§åˆ¶æµå‡æœ‰è‡ªå·±ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä¸åŒçš„æ§åˆ¶æµä¹‹é—´ä¸èƒ½ç›´æ¥è®¿é—®å½¼æ­¤çš„åœ°å€ç©ºé—´ï¼Œå¿…é¡»é€šè¿‡æ˜¾å¼çš„æ¶ˆæ¯ä¼ é€’æ¥å®ç°ã€‚è¿™ç§ç¼–ç¨‹æ–¹å¼æ˜¯å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†æœº(MPP)å’Œæœºç¾¤(Cluster)é‡‡ç”¨çš„ä¸»è¦ç¼–ç¨‹æ–¹å¼ã€‚ç”±äºæ¶ˆæ¯ä¼ é€’ç¨‹åºè®¾è®¡è¦æ±‚ç”¨æˆ·å¾ˆå¥½åœ°åˆ†è§£é—®é¢˜ï¼Œç»„ç»‡ä¸åŒæ§åˆ¶æµé—´çš„æ•°æ®äº¤æ¢ï¼Œå¹¶è¡Œè®¡ç®—ç²’åº¦å¤§ï¼Œç‰¹åˆ«é€‚åˆäºå¤§è§„æ¨¡å¯æ‰©å±•å¹¶è¡Œç®—æ³•ã€‚ MPI æ˜¯åŸºäºè¿›ç¨‹çš„å¹¶è¡Œç¯å¢ƒã€‚è¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´å’Œå¤„ç†å™¨è°ƒåº¦ï¼Œå¹¶ä¸”æ‰§è¡Œç›¸äº’ç‹¬ç«‹ã€‚MPI è®¾è®¡ä¸ºæ”¯æŒé€šè¿‡ç½‘ç»œè¿æ¥çš„æœºç¾¤ç³»ç»Ÿï¼Œä¸”é€šè¿‡æ¶ˆæ¯ä¼ é€’æ¥å®ç°é€šä¿¡ï¼Œæ¶ˆæ¯ä¼ é€’æ˜¯ MPI çš„æœ€åŸºæœ¬ç‰¹è‰²ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:2:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"1.4 Open-MPI OpenMPI æ˜¯ä¸€ç§é«˜æ€§èƒ½æ¶ˆæ¯ä¼ é€’åº“ï¼Œæœ€åˆæ˜¯ä½œä¸ºèåˆçš„æŠ€æœ¯å’Œèµ„æºä»å…¶ä»–å‡ ä¸ªé¡¹ç›®ï¼ˆFT-MPIï¼Œ LA-MPIï¼Œ LAM/MPIï¼Œ ä»¥åŠ PACX-MPIï¼‰ï¼Œå®ƒæ˜¯ MPI-2 æ ‡å‡†çš„ä¸€ä¸ªå¼€æºå®ç°ï¼Œç”±ä¸€äº›ç§‘ç ”æœºæ„å’Œä¼ä¸šä¸€èµ·å¼€å‘å’Œç»´æŠ¤ã€‚å› æ­¤ï¼ŒOpenMPI èƒ½å¤Ÿä»é«˜æ€§èƒ½ç¤¾åŒºä¸­è·å¾—ä¸“ä¸šæŠ€æœ¯ã€å·¥ä¸šæŠ€æœ¯å’Œèµ„æºæ”¯æŒï¼Œæ¥åˆ›å»ºæœ€å¥½çš„ MPI åº“ã€‚OpenMPI æä¾›ç»™ç³»ç»Ÿå’Œè½¯ä»¶ä¾›åº”å•†ã€ç¨‹åºå¼€å‘è€…å’Œç ”ç©¶äººå‘˜å¾ˆå¤šä¾¿åˆ©ã€‚æ˜“äºä½¿ç”¨ï¼Œå¹¶è¿è¡Œæœ¬èº«åœ¨å„ç§å„æ ·çš„æ“ä½œç³»ç»Ÿï¼Œç½‘ç»œäº’è¿ï¼Œä»¥åŠä¸€æ‰¹/è°ƒåº¦ç³»ç»Ÿã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:2:4","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"1.5 MPI ä½¿ç”¨é—®é¢˜ å› ä¸ºMPIæ˜¯åˆ†å¸ƒå¼å†…å­˜ç¼–ç¨‹ï¼Œåœ¨åé¢çš„å¼€å‘ä¸­æ¶‰åŠèŠ‚ç‚¹é—´ä¿¡æ¯çš„ä¼ é€’ã€‚å¾€å¾€æ•°æ®å’Œç¨‹åºæ˜¯åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥éœ€è¦ä¿è¯æ‰§è¡Œå‘½ä»¤æ—¶å„èŠ‚ç‚¹ä¹‹é—´ä¿¡æ¯çš„äº¤æ¢ã€‚ å…·ä½“ä½¿ç”¨ä¹‹ä¸­ï¼Œå°±æœ‰ä¸¤ä¸ªé—®é¢˜: è¿™ä¸ªå¤šå°æœºå™¨Open-MPIæ˜¯å¦‚ä½•å‘ç°å¹¶å»ºç«‹è¿æ¥çš„å‘¢ï¼Ÿ å¤šæœºå¤šå¡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¼ è¾“ç¯å¦‚ä½•å»ºç«‹ï¼Œè¿™ä¸ªä¹Ÿæ˜¯å†³å®šäº†è®­ç»ƒæ•ˆç‡ï¼Œé‚£ä¹ˆOpen-MPIå¦‚ä½•å»åšå‘¢ï¼Ÿ å…³äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼š è®¾ç½®SSHå…å¯†ç™»å½•å¯ä»¥å…å»æ“ä½œä¸­å¯†ç çš„è¾“å…¥ã€‚å„èŠ‚ç‚¹ç”Ÿæˆç§é’¥å’Œå…¬é’¥åéœ€è¦è®¤è¯ï¼Œæ­¤æ—¶å¯ä»¥ä¿è¯æœ¬æœºå…å¯†ç™»å½•ã€‚å°†å„ä¸ªå­èŠ‚ç‚¹çš„å…¬é’¥æ–‡ä»¶å‘é€ç»™ä¸»èŠ‚ç‚¹ï¼Œç„¶ååˆ†åˆ«åŠ å…¥åˆ°ä¸»èŠ‚ç‚¹çš„è®¤è¯æ–‡ä»¶ä¸­ï¼Œæ­¤æ—¶å¯ä»¥ä¿è¯ä¸»èŠ‚ç‚¹å¯¹å„ä¸ªå­èŠ‚ç‚¹çš„å…å¯†ç™»å½•ã€‚æœ€åå°†è®¤è¯æ–‡ä»¶ä¼ å›åˆ°æ¯ä¸ªå­èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯å„ä¸ªå­èŠ‚ç‚¹å¯¹å…¶ä»–èŠ‚ç‚¹ä¹‹é—´çš„å…å¯†ç™»å½•ã€‚ åœ¨ Open-MPI å¯åŠ¨çš„æ—¶å€™ï¼Œå¯ä»¥æŒ‡å®š--hostfileæˆ–è€…--hostå»æŒ‡å®šè¦è¿è¡Œä»»åŠ¡çš„ IP æˆ– Hostnameï¼Œè¿™æ · Open-MPI å°±ä¼šè¯•å›¾é€šè¿‡ ssh å…ç§˜é’¥çš„æ–¹å¼è¯•å›¾å»é“¾æ¥å¯¹æ–¹æœºå™¨ï¼Œå¹¶æ‰§è¡Œä¸€ç³»åˆ—å‘½ä»¤ï¼Œä¸»è¦æ˜¯ä¸ºäº†åŒæ­¥ç¯å¢ƒå˜é‡ã€å½“å‰è·¯å¾„ä»¥åŠä¸‹å‘å¯åŠ¨å‘½ä»¤ã€‚ å½“ç„¶ç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼ç»™è¿œç¨‹æœºå™¨ä¸‹å‘å‘½ä»¤ï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡OMPI_MCA_plm_rsh_agentæŒ‡å®šã€‚ å…³äºç¬¬äºŒä¸ªé—®é¢˜ï¼š å½“æ‰€æœ‰çš„æœºå™¨å»ºç«‹å¥½è¿æ¥ï¼Œå‡†å¤‡å¼€å§‹è®¡ç®—ï¼Œä¸ºäº†èƒ½å¤Ÿæœ€é«˜æ•ˆçš„å»é€šä¿¡ï¼ŒOpen-MPIä¸­é›†æˆäº†ç»„ä»¶â€”â€”hwlocã€‚è¯¥ç»„ä»¶ä¸»è¦æ˜¯ä¸ºäº†å•æœºç¡¬ä»¶èµ„æºæ‹“æ‰‘æ„å»ºï¼Œè¿›è€Œæ„å»ºæœ€çŸ­è·¯å¾„é€šä¿¡ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:2:5","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"2 å…¥å£ç‚¹ å¾ˆå¤šæœºå™¨å­¦ä¹ æ¡†æ¶éƒ½ä¼šé‡‡ç”¨å¦‚ä¸‹å¥—è·¯ï¼šshellè„šæœ¬ï¼ˆå¯é€‰ï¼‰ï¼Œpythonç«¯ å’Œ C++ç«¯ã€‚ Shellè„šæœ¬æ˜¯å¯åŠ¨è¿è¡Œçš„å…¥å£ï¼Œè´Ÿè´£è§£æå‚æ•°ï¼Œç¡®è®¤å¹¶ä¸”è°ƒç”¨è®­ç»ƒç¨‹åºï¼› Pythonæ˜¯ç”¨æˆ·çš„æ¥å£ï¼Œå¼•å…¥äº†C++åº“ï¼Œå°è£…äº†APIï¼Œè´Ÿè´£è¿è¡Œæ—¶å’Œåº•å±‚C++äº¤äº’ï¼› C++å®ç°åº•å±‚è®­ç»ƒé€»è¾‘ï¼› ä»¥æˆ‘ä»¬å…ˆçœ‹çœ‹ hordovodrun è„šæœ¬ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:3:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"2.1 å¦‚ä½•è¿è¡Œ å®˜æ–¹ç»™å‡ºçš„ Hovorod è¿è¡ŒèŒƒä¾‹ä¹‹ä¸€å¦‚ä¸‹ï¼š horovodrun -np 2 -H localhost:4 --gloo python /horovod/examples/tensorflow2/tensorflow2_mnist.py è¿™é‡Œ -np æŒ‡çš„æ˜¯è¿›ç¨‹çš„æ•°é‡ï¼Œlocalhost:4è¡¨ç¤ºlocalhostèŠ‚ç‚¹ä¸Š4ä¸ªGPUã€‚ æ³¨æ„ï¼Œå¦‚æœè™šæ‹Ÿæœºåªæœ‰ä¸€ä¸ªæ ¸ã€‚æƒ³è¦å¼ºè¡Œåœ°è¾¾åˆ°å¹¶è¡Œçš„æ•ˆæœï¼Œå¯ä»¥ä½¿ç”¨ -npå‚æ•°ï¼Œå®ƒä¼šè‡ªåŠ¨å¸®ä½ æŠŠä¸€ä¸ªæ ¸å¿ƒåˆ‡æˆå¤šä»½å¤„ç†å™¨ï¼Œæ¯ä¸€ä¸ªåˆ†å¸ƒå¼å¤„ç†å°±æ˜¯ä¸€ä¸ªslotã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä» horovodrun è¿™ä¸ªå‘½ä»¤å…¥æ‰‹çœ‹çœ‹ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:3:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"2.2 horovodrun å…¥å£æ–‡ä»¶å¯ä»¥ä» setup.py çœ‹åˆ°ï¼Œå…¶å°±è¢«æ˜ å°„æˆ horovod.runner.launch:run_commandlineã€‚ entry_points={ 'console_scripts': [ 'horovodrun = horovod.runner.launch:run_commandline' ] } æ‰€ä»¥æˆ‘ä»¬çœ‹çœ‹ run_commandline ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:3:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"2.3 run_commandline è¯¥å‘½ä»¤ä½äºï¼šhorovod-master/horovod/runner/launch.pyï¼Œæˆ‘ä»¬æ‘˜å½•é‡è¦éƒ¨åˆ†ã€‚ def run_commandline(): args = parse_args() _run(args) äºæ˜¯è¿›å…¥åˆ° _run å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒHorovod ä¼šä¾æ®æ˜¯å¦æ˜¯å¼¹æ€§è®­ç»ƒæ¥é€‰æ‹©ä¸åŒçš„è·¯å¾„ã€‚æˆ‘ä»¬åœ¨æ­¤ç³»åˆ—ä¸­ï¼Œä¼šé¦–å…ˆåˆ†æ éå¼¹æ€§è®­ç»ƒ _run_staticã€‚ def _run(args): # if hosts are not specified, either parse from hostfile, or default as # localhost if not args.hosts and not args.host_discovery_script: if args.hostfile: args.hosts = hosts.parse_host_files(args.hostfile) else: # Set hosts to localhost if not specified args.hosts = 'localhost:{np}'.format(np=args.np) # Convert nics into set args.nics = set(args.nics.split(',')) if args.nics else None if _is_elastic(args): return _run_elastic(args) else: return _run_static(args) # æˆ‘ä»¬å…ˆçœ‹è¿™é‡Œ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:3:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"2.4 éå¼¹æ€§è®­ç»ƒ _run_static() åœ¨ _run_static ä¹‹ä¸­åšäº†å¦‚ä¸‹æ“ä½œï¼š é¦–å…ˆè§£æå„ç§å‚æ•°ï¼Œå¾—åˆ° settingsï¼› ä¼šè°ƒç”¨ driver_service.get_common_interfaces è·å–ç½‘å¡ä»¥åŠå…¶ä»–hostçš„ä¿¡æ¯ï¼Œä¾æ®è¿™äº›ä¿¡æ¯ä¼šè¿›è¡Œslotåˆ†é…ï¼Œè¿™éƒ¨åˆ†å¾ˆå¤æ‚ï¼Œå…·ä½“æˆ‘ä»¬ä¼šæœ‰ä¸“æ–‡è®²è§£ï¼ˆä¸‹ä¸€ç¯‡ï¼‰ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦å¾—åˆ° host, slot, rank ä¹‹é—´çš„å…³ç³»ä¿¡æ¯ï¼Ÿç”±äºå·¥ç¨‹ä¸Šçš„è€ƒè™‘ï¼Œåº•å±‚ C++ ä¸–ç•Œä¸­å¯¹äº rank çš„è§’è‰²åšäº†åŒºåˆ†ï¼šrank 0 æ˜¯ masterï¼Œrank n æ˜¯ workerï¼Œæ‰€ä»¥è¿™äº›ä¿¡æ¯éœ€è¦å†³å®šå¹¶ä¸”ä¼ é€’ç»™ C++ä¸–ç•Œï¼› ä¼šæ ¹æ®æ˜¯å¦åœ¨å‚æ•°ä¸­ä¼ é€’è¿è¡Œå‡½æ•°æ¥å†³å®šé‡‡å–ä½•ç§è·¯å¾„ï¼Œä¸€èˆ¬é»˜è®¤æ²¡æœ‰è¿è¡Œå‚æ•°ï¼Œæ‰€ä»¥ä¼šæ‰§è¡Œ_launch_job æ¥å¯åŠ¨è®­ç»ƒ jobï¼› å…·ä½“ä»£ç å¦‚ä¸‹ï¼š def _run_static(args): settings = hvd_settings.Settings(verbose=2 if args.verbose else 0, ssh_port=args.ssh_port, ssh_identity_file=args.ssh_identity_file, extra_mpi_args=args.mpi_args, tcp_flag=args.tcp_flag, binding_args=args.binding_args, key=secret.make_secret_key(), start_timeout=tmout, num_proc=args.np, hosts=args.hosts, output_filename=args.output_filename, run_func_mode=args.run_func is not None, nics=args.nics,...) # é¦–å…ˆè§£æå„ç§å‚æ•°ï¼Œå¾—åˆ° settings fn_cache = None if not args.disable_cache: params = '' if args.np: params += str(args.np) + ' ' if args.hosts: params += str(args.hosts) + ' ' if args.ssh_port: params += str(args.ssh_port) if args.ssh_identity_file: params += args.ssh_identity_file parameters_hash = hashlib.md5(params.encode('utf-8')).hexdigest() fn_cache = cache.Cache(CACHE_FOLDER, CACHE_STALENESS_THRESHOLD_MINUTES, parameters_hash) # è·å–ç½‘å¡ä»¥åŠå…¶ä»–hostçš„ä¿¡æ¯ï¼Œä¾æ®è¿™äº›ä¿¡æ¯ä¼šè¿›è¡Œslotåˆ†é… all_host_names, _ = hosts.parse_hosts_and_slots(args.hosts) remote_host_names = network.filter_local_addresses(all_host_names) nics = driver_service.get_common_interfaces(settings, all_host_names, remote_host_names, fn_cache) if args.run_func: # get the driver IPv4 address driver_ip = network.get_driver_ip(nics) run_func_server = KVStoreServer(verbose=settings.verbose) # å¯åŠ¨å†…éƒ¨KVæœåŠ¡å™¨ run_func_server_port = run_func_server.start_server() put_data_into_kvstore(driver_ip, run_func_server_port, 'runfunc', 'func', args.run_func) # æŠŠ'func', args.run_funcå­˜å‚¨æˆKV command = [sys.executable, '-m', 'horovod.runner.run_task', str(driver_ip), str(run_func_server_port)] try: _launch_job(args, settings, nics, command) results = [None] * args.np for i in range(args.np): results[i] = read_data_from_kvstore(driver_ip, run_func_server_port,'runfunc_result', str(i)) return results finally: run_func_server.shutdown_server() else: command = args.command _launch_job(args, settings, nics, command) # æˆ‘ä»¬é‡ç‚¹è®²è§£è¿™é‡Œ return None ç›®å‰é€»è¾‘å¦‚ä¸‹ï¼š +-----------+ |horovodrun | +-----+-----+ | | v +--------+--------+ | run_commandline | +----+------+-----+ | | +---------+ +--------+ | | | | v v +-----+--------+ +----+--------+ | _run_elastic | | _run_static | | | | | +--------------+ +-------------+ è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»åˆ†æå®Œæˆ horovod çš„å…¥å£ï¼Œä¸‹é¢ä¼šåˆ†æå…·ä½“å¦‚ä½•å¯åŠ¨ Jobã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:3:4","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"3 è¿è¡Œè®­ç»ƒ Job ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:4:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"3.1 _launch_job _launch_job ä¼šæ ¹æ®é…ç½®æˆ–è€…å®‰è£…æƒ…å†µæ¥è¿›è¡Œå…·ä½“è°ƒç”¨ã€‚æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸‰ç§å¯èƒ½ï¼šgloo, mpi, jsã€‚ jsrunçš„èµ„æ–™å¾ˆéš¾æ‰¾ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹çœ‹çœ‹ gloo, mpi è¿™ä¸¤ç§ã€‚ def _launch_job(args, settings, nics, command): env = os.environ.copy() config_parser.set_env_from_args(env, args) def gloo_run_fn(): driver_ip = network.get_driver_ip(nics) gloo_run(settings, nics, env, driver_ip, command) def mpi_run_fn(): mpi_run(settings, nics, env, command) def js_run_fn(): js_run(settings, nics, env, command) run_controller(args.use_gloo, gloo_run_fn, args.use_mpi, mpi_run_fn, args.use_jsrun, js_run_fn, args.verbose) ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:4:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"3.2 run_controller run_controller ä¾ç„¶æ˜¯ä¸€ä¸ªä¸­ä»‹å‡½æ•°ï¼Œå…·ä½“å¯¼å…¥ gloo æˆ–è€… mpiã€‚ def run_controller(use_gloo, gloo_run, use_mpi, mpi_run, use_jsrun, js_run, verbosity): if use_gloo: gloo_run() elif use_mpi: mpi_run() elif use_jsrun: js_run() else: if mpi_built(verbose=verbose): if lsf.LSFUtils.using_lsf() and is_jsrun_installed(): js_run() else: mpi_run() elif gloo_built(verbose=verbose): gloo_run() ç›®å‰é€»è¾‘å¦‚ä¸‹ï¼š +-----------+ |horovodrun | +-----+-----+ | | v +--------+--------+ | run_commandline | +----+------+-----+ | | +---------+ +--------+ | | | | v v +-----+--------+ +----+--------+ | _run_elastic | | _run_static | | | | | +--------------+ +------+------+ | | v +------+------+ | _launch_job | | | +------+------+ | | v +---------+--------+ | run_controller | | | +----+----+-----+--+ | | | +-------------+ | +--------+ | | | | | | v v v +------+---+ +------+----+ +---+-----+ | gloo_run | | mpi_run | | js_run | | | | | | | +----------+ +-----------+ +---------+ äºæ˜¯æˆ‘ä»¬ä¸‹é¢å°±åˆ†ä¸ºä¸¤ä¸ªåˆ†æ”¯ä»‹ç»ï¼šgloo \u0026 mpiã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:4:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"4 Gloo å®ç° ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:5:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"4.1 Gloo ç®€ä»‹ Gloo æ˜¯ facebookå‡ºå“çš„ä¸€ä¸ªç±»ä¼¼MPIçš„é›†åˆé€šä¿¡åº“ï¼ˆhttps://github.com/facebookincubator/glooï¼‰ã€‚ é›†åˆé€šä¿¡åº“çš„ä¸»è¦ç‰¹å¾æ˜¯ï¼šå¤§ä½“ä¸Šä¼šéµç…§ MPI æä¾›çš„æ¥å£è§„å®šï¼Œå®ç°äº†åŒ…æ‹¬ç‚¹å¯¹ç‚¹é€šä¿¡ï¼ˆSEND,RECVç­‰ï¼‰ï¼Œé›†åˆé€šä¿¡ï¼ˆ REDUCEï¼ŒBROADCASTï¼ŒALLREDUCEç­‰ï¼‰ç­‰ç›¸å…³æ¥å£ï¼Œç„¶åæ ¹æ®è‡ªå·±ç¡¬ä»¶æˆ–è€…æ˜¯ç³»ç»Ÿçš„éœ€è¦ï¼Œåœ¨åº•å±‚å®ç°ä¸Šè¿›è¡Œç›¸åº”æ”¹åŠ¨ï¼Œä¿è¯æ¥å£çš„ç¨³å®šå’Œæ€§èƒ½ã€‚ Gloo ä¸ºCPUå’ŒGPUæä¾›äº†é›†åˆé€šä¿¡ç¨‹åºçš„ä¼˜åŒ–å®ç°ã€‚ å®ƒç‰¹åˆ«é€‚ç”¨äºGPUï¼Œå› ä¸ºå®ƒå¯ä»¥æ‰§è¡Œé€šä¿¡è€Œæ— éœ€ä½¿ç”¨GPUDirect å°†æ•°æ®ä¼ è¾“åˆ°CPUçš„å†…å­˜ã€‚ å®ƒè¿˜èƒ½å¤Ÿä½¿ç”¨ NCCL æ‰§è¡Œå¿«é€Ÿçš„èŠ‚ç‚¹å†…é€šä¿¡ï¼Œå¹¶å®ç°å…¶è‡ªå·±çš„èŠ‚ç‚¹é—´ä¾‹ç¨‹è®¡ç®—ã€‚ä½ ä¸éœ€è¦è€ƒè™‘å†…å­˜æ•°æ®çš„æ‹·è´ï¼Œåªéœ€è¦å®ç°é€»è¾‘å°±å¯ä»¥ã€‚ Gloo æ”¯æŒé›†åˆé€šä¿¡ï¼ˆcollective Communicationï¼‰ï¼Œå¹¶å¯¹å…¶è¿›è¡Œäº†ä¼˜åŒ–ã€‚ç”±äº GPU ä¹‹é—´å¯ä»¥ç›´æ¥è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œè€Œæ— éœ€ç»è¿‡ CPU å’Œå†…å­˜ï¼Œå› æ­¤ï¼Œåœ¨ GPU ä¸Šä½¿ç”¨ glooåç«¯é€Ÿåº¦æ›´å¿«ã€‚ Horovod ä¸ºä»€ä¹ˆä¼šé€‰æ‹© Glooï¼Ÿä¸ªäººè®¤ä¸ºé™¤äº†å…¶åŠŸèƒ½çš„å…¨é¢æ€§å’Œæ€§èƒ½ä¹‹å¤–ï¼ŒåŸºäºå®ƒå¯ä»¥äºŒæ¬¡å¼€å‘æ˜¯ä¸€ä¸ªäº®ç‚¹ï¼Œæ¯”å¦‚ä¸‹é¢æˆ‘ä»¬æ‰€è¯´çš„ Rendezvous åŠŸèƒ½å°±è¢« Horovod ç”¨æ¥å®ç°å¼¹æ€§è®­ç»ƒï¼ˆæˆ‘ä»¬åæ–‡æœ‰ä¸“é—¨è®²è§£ï¼‰ã€‚ Gloo å’Œ MPI éƒ½èµ·åˆ°äº†åŒæ ·ç±»ä¼¼ä½œç”¨ï¼š ä¸€æ–¹é¢Horovodå†…é›†æˆäº†åŸºäº Gloo çš„AllReduceï¼Œç±»ä¼¼äºNCCLï¼Œéƒ½æ˜¯ç”¨ä½œæ¢¯åº¦è§„çº¦ï¼› å¦ä¸€æ–¹é¢ï¼ŒGloo å¯ä»¥ç”¨æ¥å¯åŠ¨å¤šä¸ªè¿›ç¨‹ï¼ˆHovorodé‡Œç”¨Rankè¡¨ç¤ºï¼‰ï¼Œå®ç°å¹¶è¡Œè®¡ç®—ï¼› å…·ä½“å¦‚ä¸‹ï¼š +-----------------------+ +-----------------------+ +------------------------+ | gloo_run slot 1 | | gloo_run slot 2 | | gloo_run slot 3 | | | | | | | | +-------------------+ | | +------------------+ | | +------------------+ | | | python train.py | | | | python train.py | | | | python train.py | | +----+ +\u003c------+ +\u003c------+ +\u003c------+ | | | | | | | | | | | | | | | | +-------------------+ | | +------------------+ | | +------------------+ | | | | | | | | | | | +-----------------------+ +-----------------------+ +------------------------+ | | | | | | | v--------------------------------------------------------------------------------------\u003e Ring Allreduce on Gloo ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:5:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"4.2 Rendezvous åŠŸèƒ½ 4.2.1 Rendezvous æ¦‚å¿µ åœ¨ Gloo çš„æ–‡æ¡£ä¸­ï¼Œå¦‚æ­¤è¯´: The rendezvous process needs to happen exactly once per Gloo context. It makes participating Gloo processes exchange details for setting up their communication channels. For example, when the TCP transport is used, processes exchange IP address and port number details of listening sockets. Rendezvous can be executed by accessing a key/value store that is accessible by all participating processes. Every process is responsible for setting a number of keys and will wait until their peers have set their keys. The values stored against these keys hold the information that is passed to the transport layer. å¤§è‡´æ„æ€æ˜¯ï¼š Gloo åœ¨æ¯ä¸€ä¸ª Gloo context ä¹‹ä¸­æœ‰ä¸€ä¸ª rendezvous processï¼ŒGloo åˆ©ç”¨å®ƒæ¥äº¤æ¢é€šè®¯éœ€è¦çš„ç»†èŠ‚ã€‚ Rendezvous å…·ä½“å®ç°æ˜¯å¯ä»¥ä¾é è®¿é—®ä¸€ä¸ª KVstore æ¥å®Œæˆã€‚å…·ä½“ç»†èŠ‚å°±æ˜¯é€šè¿‡ KVstore æ¥è¿›è¡Œäº¤äº’ã€‚ ä»¥ Horovod ä¸ºä¾‹ï¼š Horovod åœ¨è¿›è¡Œå®¹é”™ AllReduce è®­ç»ƒæ—¶ï¼Œé™¤äº†å¯åŠ¨ worker è¿›ç¨‹å¤–ï¼Œè¿˜ä¼šå¯åŠ¨ä¸€ä¸ªdriver è¿›ç¨‹ã€‚è¿™ä¸ª driver è¿›ç¨‹ç”¨äºå¸®åŠ© worker è°ƒç”¨ gloo æ„é€  AllReduce é€šä¿¡ç¯ã€‚ driver è¿›ç¨‹ä¸­ä¼šåˆ›å»ºä¸€ä¸ªå¸¦æœ‰ KVStore çš„ RendezvousServerï¼Œdriver ä¼šå°†å‚ä¸é€šä¿¡çš„ worker çš„ ip ç­‰ä¿¡æ¯å­˜å…¥ KVstore ä¸­ã€‚ ç„¶å worker å°±å¯ä»¥è°ƒç”¨ gloo æ¥è®¿é—® RendezvousServer æ„é€ é€šä¿¡ç¯äº†ã€‚ 4.2.2 RendezvousServer å…·ä½“ä»£ç å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯å¯åŠ¨äº†RendezvousHTTPServer(å°±æ˜¯ç»§æ‰¿æ‹“å±•äº† HTTPServer): class RendezvousServer: def __init__(self, verbose=0): self._httpd = None self._listen_thread = None self._verbose = verbose # Rendezvous function finds a available port, create http socket, # and start listening loop to handle request # self.httpd.init needs to be called after server start def start(self, handler_cls=RendezvousHandler): # ä¸‹é¢é©¬ä¸Šä»‹ç» self._httpd, port = find_port( lambda addr: RendezvousHTTPServer( addr, handler_cls, self._verbose)) # start the listening loop self._listen_thread = in_thread(target=self._httpd.serve_forever) return port def init(self, host_alloc_plan): self._httpd.init(host_alloc_plan) def stop(self): self._httpd.shutdown() self._listen_thread.join() 4.2.3 KVStore KVStore æ˜¯ç”± KVStoreHandler æ¥ä½“ç°ï¼ŒRendezvousHandler ç»§æ‰¿äº† KVStoreHandlerï¼Œè¿›è€Œè¢« RendezvousServer ä½œä¸º handler ä½¿ç”¨ã€‚ KVStoreHandler ç²¾ç®€ç‰ˆä»£ç å¦‚ä¸‹ï¼š class KVStoreHandler(SimpleHTTPRequestHandler): # Override PUT handler def do_PUT(self): paths = self.path.split('/') _, scope, key = paths # Get body length content_length = int(self.headers['Content-Length']) value = self.rfile.read(content_length) self._put_value(scope, key, value) self.send_status_code(OK) def _put_value(self, scope, key, value): with self.server.cache_lock: scope_dict = self.server.cache.setdefault(scope, {}) scope_dict[key] = value 4.2.4 åº•å±‚ä½¿ç”¨ Rendezvous å…·ä½“å¦‚ä½•ä½¿ç”¨ï¼Ÿç®€è¦çš„è¯´ï¼š Pythonä¸–ç•Œæ„å»ºäº†ä¸€ä¸ª RendezvousServerï¼Œå…¶åœ°å€é…ç½®åœ¨ç¯å¢ƒå˜é‡ï¼ˆæˆ–è€…å…¶ä»–æ–¹å¼ï¼‰ä¸­ã€‚ åœ¨ C++ ä¸–ç•Œä¸­ï¼Œæ¯”å¦‚ horovod/common/gloo/gloo_context.hï¼Œhorovod/common/gloo/gloo_context.cc ä¹‹ä¸­æœ‰ä½¿ç”¨ã€‚å³å¾—åˆ° Python é…ç½®çš„ RendezvousServer çš„åœ°å€ç«¯å£ç­‰ï¼Œç„¶åæ„å»º gloo æ‰€éœ€çš„ contextã€‚ #define HOROVOD_HOSTNAME \"HOROVOD_HOSTNAME\" #define HOROVOD_RANK \"HOROVOD_RANK\" #define HOROVOD_SIZE \"HOROVOD_SIZE\" #define HOROVOD_LOCAL_RANK \"HOROVOD_LOCAL_RANK\" #define HOROVOD_LOCAL_SIZE \"HOROVOD_LOCAL_SIZE\" #define HOROVOD_CROSS_RANK \"HOROVOD_CROSS_RANK\" #define HOROVOD_CROSS_SIZE \"HOROVOD_CROSS_SIZE\" #define HOROVOD_ELASTIC \"HOROVOD_ELASTIC\" ctx = Rendezvous(HOROVOD_GLOO_GLOBAL_PREFIX, rendezvous_addr_env, rendezvous_port, rank, size, dev, timeout); local_ctx = Rendezvous(HOROVOD_GLOO_LOCAL_PREFIX + hostname, rendezvous_addr_env, rendezvous_port, local_rank, local_size, dev, timeout); cross_ctx = Rendezvous(HOROVOD_GLOO_CROSS_PREFIX + std::to_string(local_rank), rendezvous_addr_env, rendezvous_port, cross_rank, cross_size, dev, timeout); é€»è¾‘å¦‚ä¸‹ï¼ŒC++ä¸–ç•Œä¼šä»pythonä¸–ç•Œçš„è·å–åˆ°RendezvousServerçš„ IPï¼Œportï¼š +---------------------\u003e System Env +------------------+ | addr, port, ... addr, port, ... | | + | | | | | | | | | | | | | | | | | Python | C++ | | | | | | | | | | | | v +---------+---------------+ | +------------+--------+ | RendezvousServer | | |GlooContext | | | | | | | | | | | | | | | | | RendezvousHandler | | | Rendezvous | | | | | | +-------------------------+ | +---------------------+ | + ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:5:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"4.3 Horovd çš„ gloo å…¥å£ gloo_run æ˜¯ horovod ä¹‹ä¸­ï¼Œgloo æ¨¡å—çš„ ç›¸å…³å…¥å£ã€‚ æ³¨é‡Šè¯´çš„å¾ˆæ¸…æ¥šï¼šæ¯ä¸€ä¸ª thread å°†ä½¿ç”¨ ssh å‘½ä»¤åœ¨è¿œç¨‹hostä¹‹ä¸Šå¯åŠ¨è®­ç»ƒjobã€‚ def gloo_run(settings, nics, env, server_ip, command): # Each thread will use ssh command to launch the job on each remote host. If an # error occurs in one thread, entire process will be terminated. Otherwise, # threads will keep running and ssh session. exec_command = _exec_command_fn(settings) launch_gloo(command, exec_command, settings, nics, env, server_ip) å°±æ˜¯ç”¨ launch_gloo æ¥è¿è¡Œ exec_commandã€‚ æ­¤æ—¶ command å‚æ•°ç±»ä¼¼ \"['python', 'train.py']\"ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:5:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"4.4 æ„å»ºå¯æ‰§è¡Œç¯å¢ƒ gloo_run çš„ç¬¬ä¸€éƒ¨åˆ†æ˜¯ exec_command = _exec_command_fn(settings)ï¼Œå°±æ˜¯åŸºäºå„ç§é…ç½®æ¥ç”Ÿæˆå¯ä»¥æ‰§è¡Œå‘½ä»¤ç¯å¢ƒã€‚å¦‚æœæ˜¯è¿œç¨‹ï¼Œå°±å¾—ç”Ÿæˆç›¸å…³è¿œç¨‹å¯è¿è¡Œå‘½ä»¤ç¯å¢ƒï¼ˆåŒ…æ‹¬åˆ‡æ¢ç›®å½•ï¼Œè¿œç¨‹æ‰§è¡Œç­‰ç­‰ï¼‰ã€‚ 4.4.1 _exec_command_fn å…·ä½“åˆå¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š åˆ©ç”¨ get_remote_command æ¥ç”Ÿæˆç›¸å…³è¿œç¨‹å¯è¿è¡Œç¯å¢ƒï¼Œæ¯”å¦‚åœ¨è®­ç»ƒè„šæœ¬å‰é¢åŠ ä¸Š 'ssh -o PasswordAuthentication=no -o StrictHostKeyChecking=no'ï¼› è°ƒæ•´è¾“å…¥è¾“å‡ºï¼Œåˆ©ç”¨ safe_shell_exec.execute æ¥å®ç°å®‰å…¨æ‰§è¡Œèƒ½åŠ›ï¼› å…·ä½“å¦‚ä¸‹ï¼š def _exec_command_fn(settings): \"\"\" executes the jobs defined by run command on hosts. :param hosts_alloc: list of dict indicating the allocating info. For example, [{'Hostname':'worker-0', 'Rank': 0, 'Local_rank': 0, 'Cross_rank':0, 'Size':2, 'Local_size':1, 'Cross_size':2}, {'Hostname':'worker-1', 'Rank': 1, 'Local_rank': 0, 'Cross_rank':1, 'Size':2, 'Local_size':1, 'Cross_size':2} ] :type hosts_alloc: list(dict) :param remote_host_names: names that are resolved to one of the addresses of remote hosts interfaces. :param _run_command: command to execute \"\"\" def _exec_command(command, slot_info, events): index = slot_info.rank host_name = slot_info.hostname host_address = network.resolve_host_address(host_name) local_addresses = network.get_local_host_addresses() # éœ€è¦æ„å»ºè¿œç¨‹å‘½ä»¤ if host_address not in local_addresses: local_command = quote('cd {pwd} \u003e /dev/null 2\u003e\u00261 ; {command}' .format(pwd=os.getcwd(), command=command)) command = get_remote_command(local_command, host=host_name, port=settings.ssh_port, identity_file=settings.ssh_identity_file) # Redirect output if requested # è°ƒæ•´è¾“å…¥è¾“å‡ºï¼Œåˆ©ç”¨ safe_shell_exec.execute æ¥å®ç°å®‰å…¨æ‰§è¡Œèƒ½åŠ› stdout = stderr = None stdout_file = stderr_file = None if settings.output_filename: padded_rank = _pad_rank(index, settings.num_proc) output_dir_rank = os.path.join(settings.output_filename, 'rank.{rank}'.format(rank=padded_rank)) if not os.path.exists(output_dir_rank): os.mkdir(output_dir_rank) stdout_file = open(os.path.join(output_dir_rank, 'stdout'), 'w') stderr_file = open(os.path.join(output_dir_rank, 'stderr'), 'w') stdout = MultiFile([sys.stdout, stdout_file]) stderr = MultiFile([sys.stderr, stderr_file]) # å®ç°å®‰å…¨æ‰§è¡Œèƒ½åŠ› exit_code = safe_shell_exec.execute(command, index=index, stdout=stdout, stderr=stderr, events=events,...) return exit_code, time.time() return _exec_command 4.4.2 get_remote_command æœ¬å‡½æ•°æ˜¯é’ˆå¯¹è¿œç¨‹ hostï¼Œè·å–å¦‚ä½•åœ¨å…¶ä¸Šè¿è¡Œçš„æ–¹å¼ã€‚è¿™ä¸ªå‡½æ•°æ˜¯æ¯”è¾ƒæ–°åŠ å…¥çš„ï¼Œå…·ä½“å’Œ kubeflow mpi operator ä¹Ÿç›¸å…³ï¼Œä»¥åæœ‰æœºä¼šå†åˆ†æã€‚ SSH_COMMAND_PREFIX = 'ssh -o PasswordAuthentication=no -o StrictHostKeyChecking=no' def get_ssh_command(local_command, host, port=None, identity_file=None, timeout_s=None): port_arg = f'-p {port}' if port is not None else '' identity_file_arg = f'-i {identity_file}' if identity_file is not None else '' timeout_arg = f'-o ConnectTimeout={timeout_s}' if timeout_s is not None else '' return f'{SSH_COMMAND_PREFIX} {host} {port_arg} {identity_file_arg} {timeout_arg} {local_command}' def get_remote_command(local_command, host, port=None, identity_file=None, timeout_s=None): return f'{env_util.KUBEFLOW_MPI_EXEC} {host} {local_command}' if env_util.is_kubeflow_mpi() \\ else get_ssh_command(local_command, host, port, identity_file, timeout_s) å¤§è‡´é€»è¾‘å¦‚ä¸‹ï¼š command : python train.py + | | v +---------+-------------+ | | | get_remote_command | | | +---------+-------------+ | | v ssh -o ... python train.py + | | | v +---------+--------------+ |safe_shell_exec.execute | | | +------------------------+ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:5:4","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"4.5 ä½¿ç”¨ gloo æ‰§è¡Œå‘½ä»¤ è·å–åˆ°äº†å¯æ‰§è¡Œç¯å¢ƒ exec_command ä¸ æ‰§è¡Œå‘½ä»¤ command ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨ gloo æ¥æ‰§è¡Œå‘½ä»¤äº†ã€‚ æ¯ä¸ª command éƒ½æ˜¯è¢« exec_command æ¥æ‰§è¡Œã€‚ launch_gloo æ¥è·å–å‘½ä»¤ï¼Œå„ç§é…ç½®ä¿¡æ¯ï¼Œç½‘å¡ä¿¡æ¯ï¼ˆnicsï¼Œæ¯”å¦‚ {â€™loâ€™}ï¼‰ï¼Œhostä¿¡æ¯ç­‰ï¼Œç„¶åå¼€å§‹è¿è¡Œï¼Œå°±æ˜¯å¼€å§‹è¿è¡Œæˆ‘ä»¬çš„è®­ç»ƒä»£ç äº†ï¼Œå…·ä½“æ˜¯ï¼š å»ºç«‹ RendezvousServerï¼Œè¿™ä¸ªä¼šè¢«åº•å±‚ Gloo C++ ç¯å¢ƒä½¿ç”¨åˆ°; host_alloc_plan = get_host_assignments æ¥æ ¹æ®hostè¿›è¡Œåˆ†é…slotï¼Œå°±æ˜¯horovodçš„å“ªä¸ªrankåº”è¯¥åœ¨å“ªä¸ªhostä¸Šçš„å“ªä¸ªslotä¹‹ä¸Šè¿è¡Œï¼› get_run_command è·å–åˆ°å¯æ‰§è¡Œå‘½ä»¤ï¼› slot_info_to_command_fn æ¥å¾—åˆ°åœ¨slotä¹‹ä¸Šå¯æ‰§è¡Œçš„ slot commandï¼› ä¾æ® slot_info_to_command_fn æ„å»º args_listï¼Œè¿™ä¸ª list ä¹‹ä¸­ï¼Œæ¯ä¸€ä¸ªargå°±æ˜¯ä¸€ä¸ª slot commandï¼› å¤šçº¿ç¨‹æ‰§è¡Œï¼Œåœ¨æ¯ä¸€ä¸ª exec_command ä¹‹ä¸Šæ‰§è¡Œæ¯ä¸€ä¸ª argï¼ˆslot commandï¼‰ï¼› ä»£ç å¦‚ä¸‹ï¼š def launch_gloo(command, exec_command, settings, nics, env, server_ip): \"\"\" Launches the given command multiple times using gloo. Each command is launched via exec_command. :param command: command to launch :param exec_command: means to execute a single command :param settings: settings for the distribution :param nics: common interfaces :param env: environment to use :param server_ip: ip to use for rendezvous server \"\"\" # Make the output directory if it does not exist if settings.output_filename: _mkdir_p(settings.output_filename) # start global rendezvous server and get port that it is listening on # å»ºç«‹ RendezvousServerï¼Œè¿™ä¸ªä¼šè¢«åº•å±‚ Gloo C++ ç¯å¢ƒä½¿ç”¨åˆ° rendezvous = RendezvousServer(settings.verbose) # allocate processes into slots # æ¥æ ¹æ®hostè¿›è¡Œåˆ†é…slotï¼Œå°±æ˜¯horovodçš„å“ªä¸ªrankåº”è¯¥åœ¨å“ªä¸ªhostä¸Šçš„å“ªä¸ªslotä¹‹ä¸Šè¿è¡Œ hosts = parse_hosts(settings.hosts) host_alloc_plan = get_host_assignments(hosts, settings.num_proc) # start global rendezvous server and get port that it is listening on global_rendezv_port = rendezvous.start() rendezvous.init(host_alloc_plan) # è·å–åˆ°å¯æ‰§è¡Œå‘½ä»¤ run_command = get_run_command(command, server_ip, nics, global_rendezv_port) # å¾—åˆ°åœ¨slotä¹‹ä¸Šå¯æ‰§è¡Œçš„ slot command slot_info_to_command = _slot_info_to_command_fn(run_command, env) event = register_shutdown_event() # ä¾æ® slot_info_to_command_fn æ„å»º args_listï¼Œè¿™ä¸ª list ä¹‹ä¸­ï¼Œæ¯ä¸€ä¸ªargå°±æ˜¯ä¸€ä¸ª slot command args_list = [[slot_info_to_command(slot_info), slot_info, [event]] for slot_info in host_alloc_plan] # If an error occurs in one thread, entire process will be terminated. # Otherwise, threads will keep running. # å¤šçº¿ç¨‹æ‰§è¡Œï¼Œåœ¨æ¯ä¸€ä¸ª exec_command ä¹‹ä¸Šæ‰§è¡Œæ¯ä¸€ä¸ª argï¼ˆslot commandï¼‰ res = threads.execute_function_multithreaded(exec_command, args_list, block_until_all_done=True) for name, value in sorted(res.items(), key=lambda item: item[1][1]): exit_code, timestamp = value å…·ä½“ HostInfo.from_string ä¿¡æ¯å¦‚ä¸‹ï¼š class HostInfo: def __init__(self, hostname, slots): self.hostname = hostname self.slots = slots @staticmethod def from_string(host_string): hostname, slots = host_string.strip().split(':') return HostInfo(hostname, int(slots)) 4.5.1.2 åˆ†é…æ–¹æ¡ˆ get_host_assignments ä¼šä¾æ® host å’Œ process capacities (slots) æ¥ç»™ Horovod ä¹‹ä¸­çš„è¿›ç¨‹åˆ†é…ï¼Œå³ç»™å‡ºä¸€ä¸ª horovod rank å’Œ slot çš„å¯¹åº”å…³ç³»ã€‚è®¾ç½®äº†å‡ ä¸ª npï¼Œå°±æœ‰å‡ ä¸ª slotã€‚ ç»™å‡ºçš„åˆ†é…æ–¹æ¡ˆç±»ä¼¼å¦‚ä¸‹ï¼Œè¿™æ ·å°±çŸ¥é“äº†å“ªä¸ªrankå¯¹åº”äºå“ªä¸ªhostä¸Šçš„å“ªä¸ªslotï¼š [ SlotInfo(hostname='h1', rank=0, local_rank=0, cross_rank=0, size=2, local_size=2, coress_size=1), SlotInfo(hostname='h2', rank=1, local_rank=0, cross_rank=0, size=2, local_size=2, coress_size=1), ] def get_host_assignments(hosts, min_np, max_np=None): \"\"\"Assign hosts with process capacities (slots) to ranks in the Horovod process. This function will try to allocate as many as possible processes on the same host to leverage local network. :param hosts: list of HostInfo objects describing host and slot capacity :type hosts: list[HostInfo] :param min_np: minimum number of processes to be allocated :param max_np: (optional) maximum number of processes to be allocated :return: a list of the allocation of process on hosts in a `SlotInfo` object. :rtype: list[SlotInfo] \"\"\" host_ranks = [] cross_ranks = collections.defaultdict(dict) rank = 0 # ä¾æ® hosts ä¿¡æ¯æ„å»º rank, local rank, cross rank(hierarchical allreduceæ‰€éœ€è¦) for host_info in hosts: ranks = [] for local_rank in range(host_info.slots): if rank == max_np: break ranks.append(rank) rank += 1 cross_ranks_at_local = cross_ranks[local_rank] cross_ranks_at_local[host_info.hostname] = len(cross_ranks_at_local) host_ranks.append((host_info, ranks)) world_size = rank # ç»™å‡ºä¸€ä¸ª ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:5:5","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"4.6 C++ä¸¾ä¾‹ æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªåº•å±‚ä»£ç ï¼Œå¤§å®¶å°±è¿›ä¸€æ­¥äº†è§£ Gloo å¯ä»¥èµ·åˆ°ä»€ä¹ˆä½œç”¨ã€‚ è¿™ä¸ªå°±æ˜¯ Horovod ä¹‹ä¸­ï¼Œrank 0 æœ€ç»ˆç»™å…¶ä»– rank å‘é€æ„å»ºå¥½çš„ Tensorã€‚ void GlooController::SendFinalTensors(ResponseList\u0026 response_list) { // Notify all nodes which tensors we'd like to reduce at this step. std::string encoded_response; ResponseList::SerializeToString(response_list, encoded_response); // Boardcast the response length int encoded_response_length = (int)encoded_response.length() + 1; { gloo::BroadcastOptions opts(gloo_context_.ctx); opts.setOutput(\u0026encoded_response_length, 1); opts.setRoot(RANK_ZERO); gloo::broadcast(opts); // å¹¿æ’­ç»™å…¶ä»–rank } // Boardcast the response { gloo::BroadcastOptions opts(gloo_context_.ctx); opts.setOutput((uint8_t*)(encoded_response.c_str()), encoded_response_length); opts.setRoot(RANK_ZERO); gloo::broadcast(opts); // å¹¿æ’­ç»™å…¶ä»–rank } } ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:5:6","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"5 Mpi å®ç° ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:6:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"5.1 openmpi åº“ horovod è¿™é‡Œä¸»è¦ä¾èµ– openmpiã€‚ MPIï¼šè‹±æ–‡å…¨ç§°æ˜¯Message Passing Interfaceï¼ŒMPIæ˜¯ä¸€ä¸ªè·¨è¯­è¨€çš„é€šè®¯åè®®ï¼Œç”¨äºç¼–å†™å¹¶è¡Œè®¡ç®—æœºã€‚æ”¯æŒç‚¹å¯¹ç‚¹å’Œå¹¿æ’­ã€‚MPIæ˜¯ä¸€ä¸ªä¿¡æ¯ä¼ é€’åº”ç”¨ç¨‹åºæ¥å£ï¼ŒåŒ…æ‹¬åè®®å’Œå’Œè¯­ä¹‰è¯´æ˜ï¼Œä»–ä»¬æŒ‡æ˜å…¶å¦‚ä½•åœ¨å„ç§å®ç°ä¸­å‘æŒ¥å…¶ç‰¹æ€§ã€‚MPIçš„ç›®æ ‡æ˜¯é«˜æ€§èƒ½ï¼Œå¤§è§„æ¨¡æ€§ï¼Œå’Œå¯ç§»æ¤æ€§ã€‚ openMPIï¼šè‹±æ–‡å…¨ç§°æ˜¯open Message Passing Interfaceã€‚openMPIæ˜¯MPIçš„ä¸€ç§å®ç°ï¼Œä¸€ç§åº“é¡¹ç›®ã€‚ MPIåœ¨Hovorodçš„è§’è‰²æ¯”è¾ƒç‰¹æ®Šï¼š ä¸€æ–¹é¢Horovodå†…é›†æˆäº†åŸºäºMPIçš„AllReduceï¼Œç±»ä¼¼äºNCCLï¼Œéƒ½æ˜¯ç”¨ä½œæ¢¯åº¦è§„çº¦ï¼› å¦ä¸€æ–¹é¢ï¼ŒMPIå¯ä»¥ç”¨æ¥åœ¨æ‰€æœ‰æœºå™¨ä¸Šå¯åŠ¨å¤šä¸ªè¿›ç¨‹(Hovorodé‡Œç”¨Rankè¡¨ç¤º)ï¼Œå®ç°å¹¶è¡Œè®¡ç®—ï¼› ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:6:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"5.2 mpi_run å‡½æ•° æ­¤éƒ¨åˆ†ä»£ç ä½äºï¼šhorovod/runner/mpi_run.pyã€‚ é¦–å…ˆæ‘˜å½•å…¶å…³é”®ä»£ç å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºæ¥å…¶æ ¸å¿ƒæ˜¯è¿è¡Œ mpirun å‘½ä»¤ã€‚ # æˆ‘æ˜¯ä¸‹é¢å¤§æ®µä»£ç ä¸­çš„å…³é”®ä»£ç ï¼ mpirun_command = ( 'mpirun {basic_args} ' '-np {num_proc}{ppn_arg}{hosts_arg} ' '{binding_args} ' '{mpi_args} ' '{mpi_ssh_args} ' '{tcp_intf_arg} ' '{nccl_socket_intf_arg} ' '{output_filename_arg} ' '{env} {extra_mpi_args} {command}' .format(basic_args=basic_args, num_proc=settings.num_proc, ppn_arg=ppn_arg, hosts_arg=hosts_arg, binding_args=binding_args, mpi_args=' '.join(mpi_impl_flags), tcp_intf_arg=tcp_intf_arg, nccl_socket_intf_arg=nccl_socket_intf_arg, mpi_ssh_args=mpi_ssh_args, output_filename_arg=' '.join(output), env=env_list, extra_mpi_args=settings.extra_mpi_args if settings.extra_mpi_args else '', command=' '.join(quote(par) for par in command)) ) # Execute the mpirun command. if settings.run_func_mode: exit_code = safe_shell_exec.execute(mpirun_command, env=env, stdout=stdout, stderr=stderr) else: os.execve('/bin/sh', ['/bin/sh', '-c', mpirun_command], env) å°±æ˜¯ä¾æ®å„ç§é…ç½®ä»¥åŠå‚æ•°æ¥æ„å»º mpirun å‘½ä»¤çš„æ‰€æœ‰å‚æ•°ï¼Œæ¯”å¦‚ ssh çš„å‚æ•°ï¼Œmpi å‚æ•°ï¼Œnccl å‚æ•°ç­‰ç­‰ã€‚ æœ€åå¾—åˆ°çš„ mpirun å‘½ä»¤ä¸¾ä¾‹å¦‚ä¸‹ï¼š mpirun --allow-run-as-root --np 2 -bind-to none -map-by slot \\ -x NCCL_DEBUG=INFO -x LD_LIBRARY_PATH -x PATH \\ -mca pml ob1 -mca btl ^openib \\ python train.py å…·ä½“ä»£ç å¦‚ä¸‹ï¼Œå…·ä½“æ˜¯ï¼š # ä¸Šé¢ä»£ç æ˜¯æˆ‘ä¹‹ä¸­çš„ç‰‡æ®µ def mpi_run(settings, nics, env, command, stdout=None, stderr=None): \"\"\" Runs mpi_run. Args: settings: Settings for running MPI. Note: settings.num_proc and settings.hosts must not be None. nics: Interfaces to include by MPI. env: Environment dictionary to use for running command. command: Command and arguments to run as a list of string. stdout: Stdout of the mpi process. Only used when settings.run_func_mode is True. stderr: Stderr of the mpi process. Only used when settings.run_func_mode is True. \"\"\" # å¾—åˆ°å„ç§é…ç½® mpi_impl_flags, impl_binding_args, mpi = _get_mpi_implementation_flags(settings.tcp_flag, env=env) impi = _IMPI_IMPL == mpi # å¤„ç†sshå‚æ•° ssh_args = [] if settings.ssh_port: ssh_args += [f'-p {settings.ssh_port}'] if settings.ssh_identity_file: ssh_args += [f'-i {settings.ssh_identity_file}'] mpi_ssh_args = '' if ssh_args: joined_ssh_args = ' '.join(ssh_args) mpi_ssh_args = f'-bootstrap=ssh -bootstrap-exec-args \\\"{joined_ssh_args}\\\"' if impi else f'-mca plm_rsh_args \\\"{joined_ssh_args}\\\"' # å¤„ç†ç½‘ç»œé…ç½®ï¼Œç½‘å¡ä¿¡æ¯ç­‰ tcp_intf_arg = '-mca btl_tcp_if_include {nics}'.format( nics=','.join(nics)) if nics and not impi else '' nccl_socket_intf_arg = '-{opt} NCCL_SOCKET_IFNAME={nics}'.format( opt='genv' if impi else 'x', nics=','.join(nics)) if nics else '' # å¤„ç†hostä¿¡æ¯ # On large cluster runs (e.g. Summit), we need extra settings to work around OpenMPI issues host_names, host_to_slots = hosts.parse_hosts_and_slots(settings.hosts) if not impi and host_names and len(host_names) \u003e= _LARGE_CLUSTER_THRESHOLD: mpi_impl_flags.append('-mca plm_rsh_no_tree_spawn true') mpi_impl_flags.append('-mca plm_rsh_num_concurrent {}'.format(len(host_names))) # if user does not specify any hosts, mpirun by default uses local host. # There is no need to specify localhost. hosts_arg = '-{opt} {hosts}'.format(opt='hosts' if impi else 'H', hosts=','.join(host_names) if host_names and impi else settings.hosts) # å¤„ç†ppné…ç½® ppn_arg = ' ' if host_to_slots and impi: ppn = host_to_slots[host_names[0]] for h_name in host_names[1:]: ppn_arg = ' -ppn {} '.format(ppn) # å¤„ç†è¶…æ—¶é…ç½® if settings.prefix_output_with_timestamp and not impi: mpi_impl_flags.append('--timestamp-output') binding_args = settings.binding_args if settings.binding_args and not impi else ' '.join(impl_binding_args) # é…ç½®éœ€è¦rootèº«ä»½è¿è¡Œ basic_args = '-l' if impi else '--allow-run-as-root --tag-output' output = [] if settings.output_filename: output.append('-outfile-pattern' if impi else '--output-filename') output.append(settings.output_filename) # æ„å»ºç¯å¢ƒä¿¡æ¯åˆ—è¡¨ env_list = '' if impi else ' '.join( '-x %s' % key for key in sorted(env.keys()) if env_util.is_exportable(key)) # æ„å»ºæœ€ç»ˆçš„ MPI å‘½ä»¤ # Pass all the env variables to the mpirun command. mpirun_command = ( 'mpirun {basic_args} ' '-np {num_proc}{ppn_","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:6:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"5.3 mpirunå‘½ä»¤ å› ä¸º mpi_run ä½¿ç”¨çš„æ˜¯ mpirun å‘½ä»¤æ¥è¿è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹ã€‚ mpirunæ˜¯MPIç¨‹åºçš„å¯åŠ¨è„šæœ¬ï¼Œå®ƒç®€åŒ–äº†å¹¶è¡Œè¿›ç¨‹çš„å¯åŠ¨è¿‡ç¨‹ï¼Œå°½å¯èƒ½å±è”½äº†åº•å±‚çš„å®ç°ç»†èŠ‚ï¼Œä»è€Œä¸ºç”¨æˆ·æä¾›äº†ä¸€ä¸ªé€šç”¨çš„MPIå¹¶è¡Œæœºåˆ¶ã€‚ åœ¨ç”¨mpirunå‘½ä»¤æ‰§è¡Œå¹¶è¡Œç¨‹åºæ—¶ï¼Œå‚æ•°-npæŒ‡æ˜äº†éœ€è¦å¹¶è¡Œè¿è¡Œçš„è¿›ç¨‹ä¸ªæ•°ã€‚mpiruné¦–å…ˆåœ¨æœ¬åœ°ç»“ç‚¹ä¸Šå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œç„¶åæ ¹æ®/usr/local/share/machines.LINUXæ–‡ä»¶ä¸­æ‰€åˆ—å‡ºçš„ä¸»æœºï¼Œä¸ºæ¯ä¸ªä¸»æœºå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ã€‚è‹¥è¿›ç¨‹æ•°æ¯”å¯ç”¨çš„å¹¶è¡ŒèŠ‚ç‚¹æ•°å¤šï¼Œåˆ™å¤šä½™çš„è¿›ç¨‹å°†é‡æ–°æŒ‰ç…§ä¸Šè¿°è§„åˆ™è¿›è¡Œã€‚æŒ‰è¿™ä¸ªæœºåˆ¶åˆ†é…å¥½è¿›ç¨‹åï¼Œä¸€èˆ¬ä¼šç»™æ¯ä¸ªèŠ‚ç‚¹åˆ†ä¸€ä¸ªå›ºå®šçš„æ ‡å·ï¼Œç±»ä¼¼äºèº«ä»½è¯äº†ï¼Œåç»­åœ¨æ¶ˆæ¯ä¼ é€’ä¸­ä¼šç”¨åˆ°ã€‚ è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå®é™…è¿è¡Œçš„ orterun(Open MPI SPMD / MPMDå¯åŠ¨å™¨; mpirun / mpiexecåªæ˜¯å®ƒçš„ç¬¦å·é“¾æ¥) å‘½ä»¤ä¸¾ä¾‹å¦‚ä¸‹ï¼š mpirun -np 4 \\ -bind-to none -map-by slot \\ -x NCCL_DEBUG=INFO -x LD_LIBRARY_PATH -x PATH \\ -mca pml ob1 -mca btl ^openib \\ python train.py ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:6:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"6 æ€»ç»“ å¯¹æ¯” gloo å’Œ mpi çš„å®ç°ï¼Œæˆ‘ä»¬è¿˜æ˜¯èƒ½çœ‹å‡ºæ¥åŒºåˆ«ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:7:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"6.1 gloo gloo åªæ˜¯ä¸€ä¸ªåº“ï¼Œéœ€è¦ horovod æ¥å®Œæˆå‘½ä»¤åˆ†å‘åŠŸèƒ½ã€‚ gloo éœ€è¦ horovod è‡ªå·±å®ç°æœ¬åœ°è¿è¡Œå’Œè¿œç«¯è¿è¡Œæ–¹å¼ï¼Œå³ get_remote_command å‡½æ•° å®ç° 'ssh -o PasswordAuthentication=no -o StrictHostKeyChecking=no'ã€‚ gloo éœ€è¦å®ç° RendezvousServerï¼Œåº•å±‚ä¼šåˆ©ç”¨ RendezvousServer è¿›è¡Œé€šè®¯ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:7:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"6.2 mpi mpi åˆ™åŠŸèƒ½å¼ºå¤§å¾ˆå¤šï¼Œåªè¦æŠŠå‘½ä»¤é…ç½®æˆè¢« mpirun åŒ…è£…ï¼Œopenmpi å°±å¯ä»¥è‡ªè¡Œå®Œæˆå‘½ä»¤åˆ†å‘æ‰§è¡Œã€‚è¯´åˆ°åº•ï¼Œhorovod æ˜¯ä¸€ä¸ª mpirun ç¨‹åºï¼Œå³ä½¿è¿è¡Œäº† tensor flowï¼Œä¹Ÿæ˜¯ä¸€ä¸ªmpiç¨‹åºï¼Œå¯ä»¥äº’ç›¸äº¤äº’ã€‚ references: [1]. https://www.cnblogs.com/rossiXYZ/p/14881812.html ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_3/:7:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ horovod[3] -- HorovodrunèƒŒååšäº†ä»€ä¹ˆ","uri":"/posts/2022-10-08_horovod_3/"},{"categories":["Distributed Computing"],"content":"0 æ‘˜è¦ Horovod æ˜¯Uberäº2017å¹´å‘å¸ƒçš„ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ï¼Œåœ¨ä¸šç•Œå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚ æœ¬ç³»åˆ—å°†é€šè¿‡æºç åˆ†ææ¥å¸¦é¢†å¤§å®¶äº†è§£ Horovodã€‚ç³»åˆ—å¤§çº¦æœ‰15 ï½ 18 ç¯‡ï¼Œæœ¬æ–‡æ˜¯ç³»åˆ—ç¬¬äºŒç¯‡ï¼Œä»ç”¨æˆ·è§’åº¦åˆ‡å…¥ Horovodã€‚ å‰ä¸€ç¯‡å‚è§å¦‚ä¸‹ï¼š æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] â€“ åŸºç¡€çŸ¥è¯† ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:1:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"1 Horovod ç®€ä»‹ Horovod æ˜¯Uberäº2017å¹´å‘å¸ƒçš„ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ï¼Œæ”¯æŒTensorFlowï¼ŒKerasï¼ŒPyTorchå’ŒMXNetã€‚Horovod çš„åå­—æ¥è‡ªäºä¿„å›½ä¼ ç»Ÿæ°‘é—´èˆè¹ˆï¼Œèˆè€…æ‰‹ç‰µæ‰‹å›´æˆä¸€ä¸ªåœˆè·³èˆï¼Œä¸åˆ†å¸ƒå¼ TensorFlow æµç¨‹ä½¿ç”¨ Horovod äº’ç›¸é€šä¿¡çš„åœºæ™¯å¾ˆåƒã€‚ å› ä¸ºå„ä¸ªæœºå™¨å­¦ä¹ æ¡†æ¶å¯¹äºåº•å±‚é›†åˆé€šä¿¡åº“ï¼ˆ ncclï¼Œopenmpiï¼Œgloo ç­‰ç­‰ï¼‰çš„åˆ©ç”¨æ°´å¹³å¯èƒ½å„ä¸ç›¸åŒï¼Œä½¿å¾—ä»–ä»¬æ— æ³•å……åˆ†åˆ©ç”¨è¿™äº›åº•å±‚é›†åˆé€šä¿¡åº“çš„å¨åŠ›ã€‚å› è€Œï¼Œhovorod å°±æ•´åˆè¿™äº›æ¡†æ¶ï¼Œæä¾›ä¸€ä¸ªæ˜“ç”¨é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚ Uberçš„å·¥ç¨‹å¸ˆå°±æ˜¯æ ¹æ®FaceBookçš„ä¸€ç¯‡paperï¼šâ€œAccurate, Large Minibatch SGD: Training ImageNet in 1 Hourâ€å’Œç™¾åº¦çš„ä¸€ç¯‡â€œBringing HPC Techniques to Deep Learningâ€ æ”¹è¿›å¹¶å‘å¸ƒäº†å¼€æºæ¡†æ¶Horovodã€‚ Horovod ç›¸æ¯”äºç™¾åº¦çš„å·¥ä½œï¼Œå¹¶æ— å­¦æœ¯ä¸Šçš„è´¡çŒ®ã€‚ä½†æ˜¯ Horovod æ‰å®çš„å·¥ç¨‹å®ç°ï¼Œä½¿å¾—å®ƒå—åˆ°äº†æ›´å¤šçš„å…³æ³¨ã€‚å®ƒæœ€å¤§çš„ä¼˜åŠ¿åœ¨äºå¯¹ RingAllReduce è¿›è¡Œäº†æ›´é«˜å±‚æ¬¡çš„æŠ½è±¡ï¼Œä½¿å…¶æ”¯æŒå¤šç§ä¸åŒçš„æ¡†æ¶ã€‚åŒæ—¶å¼•å…¥äº† Nvidia NCCLï¼Œå¯¹ GPU æ›´åŠ å‹å¥½ã€‚ Horovodä¾èµ–äºNvidiaçš„ NCCL2 åš All Reduceï¼Œä¾èµ–äºMPIåšè¿›ç¨‹é—´é€šä¿¡ï¼Œç®€åŒ–äº†åŒæ­¥å¤š GPU æˆ–å¤šèŠ‚ç‚¹åˆ†å¸ƒå¼è®­ç»ƒçš„å¼€å‘æµç¨‹ã€‚ç”±äºä½¿ç”¨äº†NCCL2ï¼ŒHorovodä¹Ÿå¯ä»¥åˆ©ç”¨ä»¥ä¸‹åŠŸèƒ½ï¼šNVLINKï¼ŒRDMAï¼ŒGPUDirectRDMAï¼Œè‡ªåŠ¨æ£€æµ‹é€šä¿¡æ‹“æ‰‘ï¼Œèƒ½å¤Ÿå›é€€åˆ° PCIe å’Œ TCP/IP é€šä¿¡ã€‚ æˆ‘ä»¬éœ€è¦å‡ ä¸ªé—®é¢˜æ¥å¼•å¯¼åˆ†æï¼š Hovorod æ€ä¹ˆè¿›è¡Œæ•°æ®åˆ†å‰²ï¼Ÿ Hovorod æ€ä¹ˆè¿›è¡Œè®­ç»ƒä»£ç åˆ†å‘ï¼Ÿ Hovorod å¯åŠ¨æ—¶å€™ï¼Œpython å’Œ C++ éƒ½åšäº†ä»€ä¹ˆï¼Ÿ å¦‚ä½•ç¡®ä¿ Hovorod å¯åŠ¨æ—¶å€™æ­¥éª¤ä¸€è‡´ï¼› ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:2:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"2 Hovorod æœºåˆ¶æ¦‚è¿° ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:3:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"2.1 Horovod æœºåˆ¶ Horovodä½¿ç”¨æ•°æ®å¹¶è¡ŒåŒ–ç­–ç•¥åœ¨GPUä¸Šåˆ†é…è®­ç»ƒã€‚ åœ¨æ•°æ®å¹¶è¡ŒåŒ–ä¸­ï¼Œä½œä¸šä¸­çš„æ¯ä¸ªGPUéƒ½ä¼šæ¥æ”¶å…¶è‡ªå·±çš„æ•°æ®æ‰¹å¤„ç†çš„ç‹¬ç«‹åˆ‡ç‰‡ï¼Œå³å®ƒçš„â€œæ‰¹å¤„ç†åˆ‡ç‰‡â€ã€‚ æ¯ä¸ªGPUéƒ½ä½¿ç”¨è‡ªå·±åˆ†é…åˆ°çš„æ•°æ®æ¥ç‹¬ç«‹è®¡ç®—ï¼Œè¿›è¡Œæ¢¯åº¦æ›´æ–°ã€‚ å‡å¦‚ä½¿ç”¨ä¸¤ä¸ªGPUï¼Œæ‰¹å¤„ç†å¤§å°ä¸º32ï¼Œåˆ™ç¬¬ä¸€ä¸ªGPUå°†å¤„ç†å‰16æ¡è®°å½•çš„æ­£å‘ä¼ æ’­å’Œå‘åä¼ æ’­ï¼Œä»¥åŠç¬¬äºŒä¸ªGPUå¤„ç†å16æ¡è®°å½•çš„æ­£å‘ä¼ æ’­å’Œå‘åä¼ æ’­ã€‚ç„¶åï¼Œè¿™äº›æ¢¯åº¦æ›´æ–°å°†åœ¨GPUä¹‹é—´å¹³å‡åœ¨ä¸€èµ·ï¼Œæœ€ååº”ç”¨äºæ¨¡å‹ã€‚ æ¯ä¸€ä¸ªè¿­ä»£çš„æ“ä½œæ–¹æ³•å¦‚ä¸‹ï¼š æ¯ä¸ª worker å°†ç»´æŠ¤è‡ªå·±çš„æ¨¡å‹æƒé‡å‰¯æœ¬å’Œè‡ªå·±çš„æ•°æ®é›†å‰¯æœ¬ã€‚ æ”¶åˆ°æ‰§è¡Œä¿¡å·åï¼Œæ¯ä¸ªå·¥ä½œè¿›ç¨‹éƒ½ä¼šä»æ•°æ®é›†ä¸­æå–ä¸€ä¸ªä¸ç›¸äº¤çš„æ‰¹æ¬¡ï¼Œå¹¶è®¡ç®—è¯¥æ‰¹æ¬¡çš„æ¢¯åº¦ã€‚ Workers ä½¿ç”¨ring all-reduceç®—æ³•æ¥åŒæ­¥å½¼æ­¤çš„æ¢¯åº¦ï¼Œä»è€Œåœ¨æœ¬åœ°æ‰€æœ‰èŠ‚ç‚¹ä¸Šè®¡ç®—åŒæ ·çš„å¹³å‡æ¢¯åº¦ã€‚ å°†æ¯ä¸ªè®¾å¤‡ä¸Šçš„æ¢¯åº¦ tensor åˆ‡åˆ†æˆé•¿åº¦å¤§è‡´ç›¸ç­‰çš„ num_devices ä¸ªåˆ†ç‰‡ï¼Œåç»­æ¯ä¸€æ¬¡é€šä¿¡éƒ½å°†ç»™ä¸‹ä¸€ä¸ªé‚»å±…å‘é€ä¸€ä¸ªè‡ªå·±çš„åˆ†ç‰‡ï¼ˆåŒæ—¶ä»ä¸Šä¸€ä¸ªé‚»å±…æ¥å—ä¸€ä¸ªæ–°åˆ†ç‰‡ï¼‰ã€‚ ScatterReduce é˜¶æ®µï¼šé€šè¿‡ num_devices - 1 è½®é€šä¿¡å’Œç›¸åŠ ï¼Œåœ¨æ¯ä¸ª device ä¸Šéƒ½è®¡ç®—å‡ºä¸€ä¸ª tensor åˆ†ç‰‡çš„å’Œï¼Œå³æ¯ä¸ª device å°†æœ‰ä¸€ä¸ªå—ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰device ä¸­è¯¥å—ä¸­æ‰€æœ‰å€¼çš„æ€»å’Œï¼›å…·ä½“å¦‚ä¸‹ï¼š AllGather é˜¶æ®µï¼šé€šè¿‡ num_devices - 1 è½®é€šä¿¡å’Œè¦†ç›–ï¼Œå°†ä¸Šä¸ªé˜¶æ®µè®¡ç®—å‡ºçš„æ¯ä¸ª tensor åˆ†ç‰‡çš„å’Œ å¹¿æ’­åˆ°å…¶ä»– deviceï¼›æœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹éƒ½æ‹¥æœ‰æ‰€æœ‰tensoråˆ†ç‰‡å’Œã€‚å…·ä½“å¦‚ä¸‹ï¼š åœ¨æ¯ä¸ªè®¾å¤‡ä¸Šåˆå¹¶åˆ†ç‰‡ï¼Œå¾—åˆ°æ¢¯åº¦å’Œï¼Œç„¶åé™¤ä»¥ num_devicesï¼Œå¾—åˆ°å¹³å‡æ¢¯åº¦ï¼› æ¯ä¸ª worker å°† æ¢¯åº¦æ›´æ–° åº”ç”¨äºå…¶æ¨¡å‹çš„æœ¬åœ°å‰¯æœ¬ã€‚ æ‰§è¡Œä¸‹ä¸€ä¸ªbatchã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:3:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"3 ç¤ºä¾‹ä»£ç  ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:4:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"3.1 æ‘˜è¦ä»£ç  æˆ‘ä»¬æ­¤å¤„ç»™å‡ºå®˜ç½‘ç¤ºä¾‹ä»£ç éƒ¨åˆ†æ‘˜è¦ï¼Œå…·ä½“åˆ†æå‚è§ä¸‹é¢ä»£ç ä¸­çš„æ³¨é‡Šã€‚ import tensorflow as tf import horovod.tensorflow.keras as hvd # Horovod: initialize Horovod. hvd.init() # åˆå§‹åŒ– Horovodï¼Œå¯åŠ¨ç›¸å…³çº¿ç¨‹å’ŒMPIçº¿ç¨‹ # Horovod: pin GPU to be used to process local rank (one GPU per process) # ä¾æ® local rank ä¸ºä¸åŒçš„è¿›ç¨‹åˆ†é…ä¸åŒçš„GPU gpus = tf.config.experimental.list_physical_devices('GPU') for gpu in gpus: tf.config.experimental.set_memory_growth(gpu, True) if gpus: tf.config.experimental.set_visible_devices(gpus[hvd.local_rank()], 'GPU') (mnist_images, mnist_labels), _ = \\ tf.keras.datasets.mnist.load_data(path='mnist-%d.npz' % hvd.rank()) # åˆ‡åˆ†æ•°æ® dataset = tf.data.Dataset.from_tensor_slices( (tf.cast(mnist_images[..., tf.newaxis] / 255.0, tf.float32), tf.cast(mnist_labels, tf.int64)) ) dataset = dataset.repeat().shuffle(10000).batch(128) mnist_model = tf.keras.Sequential([ tf.keras.layers.Conv2D(32, [3, 3], activation='relu'), ...... tf.keras.layers.Dense(10, activation='softmax') ]) # Horovod: adjust learning rate based on number of GPUs. scaled_lr = 0.001 * hvd.size() # æ ¹æ®Workerçš„æ•°é‡å¢åŠ å­¦ä¹ ç‡çš„å¤§å° opt = tf.optimizers.Adam(scaled_lr) # Horovod: add Horovod DistributedOptimizer. # æŠŠå¸¸è§„TensorFlow Optimizeré€šè¿‡HorovodåŒ…è£…èµ·æ¥ï¼Œè¿›è€Œä½¿ç”¨ ring-allreduce æ¥å¾—åˆ°å¹³å‡æ¢¯åº¦ opt = hvd.DistributedOptimizer( opt, backward_passes_per_step=1, average_aggregated_gradients=True) # Horovod: Specify `experimental_run_tf_function=False` to ensure TensorFlow # uses hvd.DistributedOptimizer() to compute gradients. mnist_model.compile(loss=tf.losses.SparseCategoricalCrossentropy(), optimizer=opt, metrics=['accuracy'], experimental_run_tf_function=False) callbacks = [ hvd.callbacks.BroadcastGlobalVariablesCallback(0), # å¹¿æ’­åˆå§‹åŒ–ï¼Œå°†æ¨¡å‹çš„å‚æ•°ä»ç¬¬ä¸€ä¸ªè®¾å¤‡ä¼ å‘å…¶ä»–è®¾å¤‡ï¼Œä»¥ä¿è¯åˆå§‹åŒ–æ¨¡å‹å‚æ•°çš„ä¸€è‡´æ€§ hvd.callbacks.MetricAverageCallback(), hvd.callbacks.LearningRateWarmupCallback(initial_lr=scaled_lr, warmup_epochs=3, verbose=1), ] # Horovod: save checkpoints only on worker 0 to prevent other workers from corrupting them. # åªæœ‰è®¾å¤‡0éœ€è¦ä¿å­˜æ¨¡å‹å‚æ•°ä½œä¸ºcheckpoint if hvd.rank() == 0: callbacks.append(tf.keras.callbacks.ModelCheckpoint('./checkpoint-{epoch}.h5')) # Horovod: write logs on worker 0. verbose = 1 if hvd.rank() == 0 else 0 # Train the model. # Horovod: adjust number of steps based on number of GPUs. mnist_model.fit(dataset, steps_per_epoch=500 // hvd.size(), callbacks=callbacks, epochs=24, verbose=verbose) ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:4:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"3.2 horovodrun Horovodè®­ç»ƒè„šæœ¬æœªä½œä¸ºPythonè„šæœ¬å¯åŠ¨ã€‚ ä¾‹å¦‚ï¼Œæ‚¨ä¸èƒ½ä½¿ç”¨python train.pyè¿è¡Œæ­¤è„šæœ¬ã€‚ éœ€è¦é‡‡ç”¨ç‰¹æ®Šçš„CLIå‘½ä»¤ horovodrun æ¥å¯åŠ¨ï¼ˆè®­ç»ƒä»£ç  train.py éœ€è¦æ‰‹åŠ¨æ‹·è´åˆ°å„ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä¸”ç›®å½•ç›¸åŒï¼‰ï¼š $ horovodrun -np 4 -H localhost:4 python train.py ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:4:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"4 è¿è¡Œé€»è¾‘ æˆ‘ä»¬æŒ‰ç…§é¡ºåºæ¢³ç†ï¼Œçœ‹çœ‹åœ¨ç¨‹åºåˆå§‹åŒ–è¿‡ç¨‹èƒŒåéƒ½åšäº†ä»€ä¹ˆã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:5:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"4.1 å¼•å…¥pythonæ–‡ä»¶ å¦‚ä¸‹ä»£ç ä¼šå¼•å…¥å„ç§ç›¸å…³pythonæ–‡ä»¶ã€‚ import tensorflow as tf import horovod.tensorflow.keras as hvd ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:5:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"4.2 åˆå§‹åŒ– in python python ä¸–ç•Œçš„åˆå§‹åŒ–ä½äº horovod-master/horovod/mxnet/mpi_ops.py 4.2.1 å¼•å…¥SOåº“ 4.2.1.1 SOåº“ horovod/tensorflow/mpi_ops.py ä¹‹ä¸­ä¼šå¼•å…¥SOåº“ã€‚ æ¯”å¦‚ dist-packages/horovod/tensorflow/mpi_lib.cpython-36m-x86_64-linux-gnu.soã€‚ SOåº“ å°±æ˜¯ horovod ä¸­ C++ ä»£ç ç¼–è¯‘å‡ºæ¥çš„ç»“æœã€‚ def _load_library(name): \"\"\"Loads a .so file containing the specified operators. \"\"\" filename = resource_loader.get_path_to_datafile(name) library = load_library.load_op_library(filename) return library # Check possible symbol not found error from tensorflow version mismatch try: MPI_LIB = _load_library('mpi_lib' + get_ext_suffix()) except Exception as e: check_installed_version('tensorflow', tf.__version__, e) raise e else: check_installed_version('tensorflow', tf.__version__) 4.2.2.2 SOä½œç”¨ å¼•å…¥åº“çš„ä½œç”¨æ˜¯è·å–åˆ° C++ çš„å‡½æ•°ï¼Œå¹¶ä¸”ç”¨ python å°è£…ä¸€ä¸‹ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ python ä¸–ç•Œä½¿ç”¨ C++ä»£ç äº†ã€‚ ç”±ä¸‹æ–‡å¯ä»¥çœ‹å‡ºæ¥ï¼Œpython çš„ _allreduce å‡½æ•°å°±ä¼šæŠŠåŠŸèƒ½è½¬å‘ç»™ C++ï¼Œç”± MPI_LIB.horovod_allreduce å®Œæˆã€‚ def _allreduce(tensor, name=None, op=Sum, prescale_factor=1.0, postscale_factor=1.0, ignore_name_scope=False): if name is None and not _executing_eagerly(): name = 'HorovodAllreduce_%s' % _normalize_name(tensor.name) return MPI_LIB.horovod_allreduce(tensor, name=name, reduce_op=op, prescale_factor=prescale_factor, postscale_factor=postscale_factor, ignore_name_scope=ignore_name_scope) 4.2.2 åˆå§‹åŒ–é…ç½® æˆ‘ä»¬æ‘˜å½•äº†ä¸»è¦éƒ¨åˆ†ï¼Œå°±æ˜¯åˆå§‹åŒ– _HorovodBasicsï¼Œç„¶åä» _HorovodBasics å†…è·å–å„ç§å‡½æ•°ï¼Œå˜é‡å’Œé…ç½®ï¼Œæ¯”å¦‚æ˜¯å¦ç¼–è¯‘äº†mpiï¼Œglooç­‰ç­‰. from horovod.common.basics import HorovodBasics as _HorovodBasics _basics = _HorovodBasics(__file__, 'mpi_lib') # import basic methods init = _basics.init size = _basics.size local_size = _basics.local_size rank = _basics.rank local_rank = _basics.local_rank mpi_built = _basics.mpi_built gloo_enabled = _basics.gloo_enabled ...... 4.2.3 hvd.init() åˆå§‹åŒ– é¦–å…ˆéœ€è¦ç”¨ hvd.init() æ¥åˆå§‹åŒ–ï¼Œhorovod ç®¡ç†çš„æ‰€æœ‰çŠ¶æ€éƒ½ä¼šä¼ åˆ° hvd å¯¹è±¡ä¸­ã€‚ # Horovod: initialize Horovod. hvd.init() æ­¤å¤„è°ƒç”¨çš„æ˜¯ HorovodBasics ä¸­çš„å‡½æ•°ï¼Œæˆ‘ä»¬çœ‹çœ‹åšäº†ä»€ä¹ˆã€‚ å¯ä»¥çœ‹åˆ°ï¼Œè¿™éƒ¨åˆ†ä¼šä¸€ç›´æ·±å…¥åˆ° C++ä¸–ç•Œï¼Œè°ƒç”¨äº†å¤§é‡çš„ MPI_LIB_CTYPES å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦è¿›å…¥åˆ° C++çš„ä¸–ç•Œçœ‹çœ‹ã€‚ def init(self, comm=None): \"\"\"A function that initializes Horovod. \"\"\" atexit.register(self.shutdown) if not isinstance(comm, list): mpi_built = self.MPI_LIB_CTYPES.horovod_mpi_built() from mpi4py import MPI if MPI._sizeof(MPI.Comm) == ctypes.sizeof(ctypes.c_int): MPI_Comm = ctypes.c_int else: MPI_Comm = ctypes.c_void_p self.MPI_LIB_CTYPES.horovod_init_comm.argtypes = [MPI_Comm] comm_obj = MPI_Comm.from_address(MPI._addressof(comm)) self.MPI_LIB_CTYPES.horovod_init_comm(comm_obj) else: comm_size = len(comm) self.MPI_LIB_CTYPES.horovod_init( (ctypes.c_int * comm_size)(*comm), ctypes.c_int(comm_size)) ç›®å‰é€»è¾‘å¦‚ä¸‹å›¾ï¼š Import python files + | | v Import C++ SO files | | | v Create _HorovodBasics + | | v hvd.init() + Python | +------------------------------------------+ C++ | | v ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:5:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"4.3 åˆå§‹åŒ– in C++ 4.3.1 horovod_init_comm åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼ŒHorovod ä¼šï¼š è°ƒç”¨ MPI_Comm_dup è·å–ä¸€ä¸ª Communicatorï¼Œè¿™æ ·å°±æœ‰äº†å’Œ MPI åè°ƒçš„åŸºç¡€ã€‚ ç„¶åè°ƒç”¨ InitializeHorovodOnceã€‚ void horovod_init_comm(MPI_Comm comm) { MPI_Comm_dup(comm, \u0026mpi_context.mpi_comm); InitializeHorovodOnce(nullptr, 0); } 4.3.2 InitializeHorovodOnce InitializeHorovodOnce æ˜¯åˆå§‹åŒ–çš„ä¸»è¦å·¥ä½œï¼Œä¸»è¦æ˜¯ï¼š ä¾æ®æ˜¯å¦ç¼–è¯‘äº† mpi æˆ–è€… glooï¼Œå¯¹å„è‡ªçš„ context è¿›è¡Œå¤„ç†ï¼Œä¸º globalstate åˆ›å»ºå¯¹åº”çš„ controllerï¼› å¯åŠ¨äº†åå°çº¿ç¨‹ BackgroundThreadLoop ç”¨æ¥åœ¨å„ä¸ªworkerä¹‹é—´åè°ƒï¼› void horovod_init(const int* ranks, int nranks) { InitializeHorovodOnce(ranks, nranks); } void InitializeHorovodOnce(const int* ranks, int nranks) { // Ensure background thread is only started once. if (!horovod_global.initialize_flag.test_and_set()) { horovod_global.control_operation = ParseControllerOpsFromEnv(); horovod_global.cpu_operation = ParseCPUOpsFromEnv(); #if HAVE_MPI // ä¾æ®æ˜¯å¦ç¼–è¯‘äº†MPIè¿›è¡Œå¤„ç† // Enable mpi is it's used either in cpu data transfer or controller if (horovod_global.cpu_operation == LibType::MPI || horovod_global.control_operation == LibType::MPI) { mpi_context.Enable(); } if (horovod_global.control_operation == LibType::MPI){ // åˆ›å»ºä¸€ä¸ª MPIController å¯¹è±¡ horovod_global.controller.reset(new MPIController( horovod_global.response_cache, horovod_global.tensor_queue, horovod_global.timeline, horovod_global.parameter_manager, horovod_global.group_table, mpi_context)); horovod_global.controller-\u003eSetRanks(ranks, nranks); } #endif #if HAVE_GLOO // ä¾æ®æ˜¯å¦ç¼–è¯‘äº† GLOO è¿›è¡Œå¤„ç† // Enable gloo is it's used either in cpu data transfer or controller if (horovod_global.cpu_operation == LibType::GLOO || horovod_global.control_operation == LibType::GLOO) { gloo_context.Enable(); } if (horovod_global.control_operation == LibType::GLOO) { horovod_global.controller.reset(new GlooController( horovod_global.response_cache, horovod_global.tensor_queue, horovod_global.timeline, horovod_global.parameter_manager, horovod_global.group_table, gloo_context)); } #endif // Reset initialization flag // å¯åŠ¨åå°çº¿ç¨‹ horovod_global.initialization_done = false; horovod_global.background_thread = std::thread( BackgroundThreadLoop, std::ref(horovod_global)); } // Wait to ensure that the background thread has finished initializing MPI. while (!horovod_global.initialization_done) { std::this_thread::sleep_for(std::chrono::milliseconds(1)); } } 4.3.3 HorovodGlobalState åœ¨ C++ ä¸–ç•Œï¼ŒHorovodGlobalState èµ·åˆ°äº†é›†ä¸­ç®¡ç†å„ç§å…¨å±€å˜é‡çš„ä½œç”¨ã€‚ HorovodGlobalState åœ¨ horovod ä¸­æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå…¶ä¸­çš„å…ƒç´ å¯ä»¥ä¾›ä¸åŒçš„çº¿ç¨‹è®¿é—®ã€‚HorovodGlobalState åœ¨åŠ è½½ C++ çš„ä»£ç æ—¶å€™å°±å·²ç»åˆ›å»ºäº†ï¼ŒåŒæ—¶åˆ›å»ºçš„è¿˜æœ‰å„ç§ contextï¼ˆmpi_context, nccl_context, gpu_contextï¼‰ã€‚ Horovod ä¸»è¦ä¼šåœ¨backgroundThreadLoop ä¸­å®Œæˆ HorovodGlobalState ä¸åŒå…ƒç´ åˆå§‹åŒ–ï¼Œæ¯”è¾ƒé‡è¦çš„æœ‰ï¼š controller ç®¡ç†æ€»ä½“é€šä¿¡æ§åˆ¶æµï¼› tensor_queue ä¼šå¤„ç†ä»å‰ç«¯è¿‡æ¥çš„é€šä¿¡éœ€æ±‚ï¼ˆallreduceï¼Œbroadcast ç­‰)ï¼› // All the Horovod state that must be stored globally per-process. HorovodGlobalState horovod_global; #if HAVE_MPI MPIContext mpi_context; #endif #if HAVE_GLOO GlooContext gloo_context; #endif .... std::unique_ptr\u003cOperationManager\u003e op_manager; HorovodGlobalState æ‘˜è¦å¦‚ä¸‹ï¼š struct HorovodGlobalState { // Background thread running MPI communication. std::thread background_thread; // åå°çº¿ç¨‹ï¼Œç”¨æ¥åœ¨å„ä¸ªworkerä¹‹é—´åè°ƒ ParameterManager parameter_manager; // ç»´æŠ¤åå°æ€»ä½“å‚æ•°é…ç½® // Encapsulates the fusion buffers, handles resizing and auto-tuning of buffer // size. FusionBufferManager fusion_buffer; // èåˆtensorï¼Œä»¥ä¾¿ç¼©å‡é€šä¿¡å¼€é”€ std::shared_ptr\u003cController\u003e controller; //ç®¡ç†æ€»ä½“é€šä¿¡æ§åˆ¶æµ TensorQueue tensor_queue; //å¤„ç†ä»å‰ç«¯è¿‡æ¥çš„é€šä¿¡éœ€æ±‚ï¼ˆallreduceï¼Œbroadcast ç­‰ï¼‰ // Pointer to shared buffer for allgather void* shared_buffer = nullptr; // LRU cache of Responses ResponseCache response_cache; // Information on registered groups. GroupTable group_table; ~HorovodGlobalState() { // Make sure that the destructor of the background thread is safe to // call. If a thread is still joinable (not detached or complete) its // destructor cannot be called. if (background_thread.joinable()) { shut_down = true; background_thread.join(); } } }; ç›®å‰å…·ä½“é€»è¾‘å¦‚ä¸‹ï¼š Import python files + | | v Import C++ SO files | | | v Create _HorovodBasics + | | v hvd.init() + Python | +--------------------------------------------------------","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:5:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"4.3 hvd æ¦‚å¿µ åœ¨ç”¨æˆ·ä»£ç ä¸­ï¼Œæ¥ä¸‹æ¥æ˜¯rankæ¦‚å¿µã€‚ hvd.local_rank() hvd.rank() æˆ‘ä»¬ä»‹ç»ä¸‹å‡ ä¸ªç›¸å…³æ¦‚å¿µï¼š Horovodä¸ºè®¾å¤‡ä¸Šçš„æ¯ä¸ªGPUå¯åŠ¨äº†è¯¥è®­ç»ƒè„šæœ¬çš„ä¸€ä¸ªå‰¯æœ¬ã€‚local rankå°±æ˜¯åˆ†é…ç»™æŸä¸€å°è®¡ç®—æœºä¸Šæ¯ä¸ªæ‰§è¡Œè®­ç»ƒçš„å”¯ä¸€ç¼–å·ï¼ˆä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯è¿›ç¨‹å·æˆ–è€…GPUè®¾å¤‡çš„IDå·ï¼‰ï¼ŒèŒƒå›´æ˜¯ 0 åˆ° n-1ï¼Œå…¶ä¸­ n æ˜¯è¯¥è®¡ç®—æœºä¸ŠGPUè®¾å¤‡çš„æ•°é‡ã€‚ rank å¯ä»¥è®¤ä¸ºæ˜¯ä»£è¡¨åˆ†å¸ƒå¼ä»»åŠ¡é‡Œçš„ä¸€ä¸ªæ‰§è¡Œè®­ç»ƒçš„å”¯ä¸€å…¨å±€ç¼–å·ï¼ˆç”¨äºè¿›ç¨‹é—´é€šè®¯ï¼‰ã€‚Rank 0 åœ¨Horovodä¸­é€šå¸¸å…·æœ‰ç‰¹æ®Šçš„æ„ä¹‰ï¼šå®ƒæ˜¯è´Ÿè´£æ­¤åŒæ­¥çš„è®¾å¤‡ã€‚ åœ¨ç™¾åº¦çš„å®ç°ä¸­ï¼Œä¸åŒ Rank çš„è§’è‰²æ˜¯ä¸ä¸€æ ·çš„ï¼ŒRank 0 ä¼šå……å½“ coordinator çš„è§’è‰²ã€‚å®ƒä¼šåè°ƒæ¥è‡ªå…¶ä»– Rank çš„ MPI è¯·æ±‚ï¼Œæ˜¯ä¸€ä¸ªå·¥ç¨‹ä¸Šçš„è€ƒé‡ã€‚è¿™ä¸€è®¾è®¡ä¹Ÿè¢«åæ¥çš„ Horovod é‡‡ç”¨ã€‚ Rank 0 ä¹Ÿç”¨æ¥æŠŠå‚æ•°å¹¿æ’­åˆ°å…¶ä»–è¿›ç¨‹ \u0026 å­˜å‚¨ checkpointã€‚ world_sizeï¼šè¿›ç¨‹æ€»æ•°é‡ï¼Œä¼šç­‰åˆ°æ‰€æœ‰world_sizeä¸ªè¿›ç¨‹å°±ç»ªä¹‹åæ‰ä¼šå¼€å§‹è®­ç»ƒã€‚ hvd.init è¿™éƒ¨åˆ†çš„ç›®çš„å°±æ˜¯è®©å¹¶è¡Œè¿›ç¨‹ä»¬å¯ä»¥çŸ¥é“è‡ªå·±è¢«åˆ†é…çš„ rank / local rank ç­‰ä¿¡æ¯ï¼Œäºæ˜¯åç»­å¯ä»¥æ ¹æ® local rankï¼ˆæ‰€åœ¨èŠ‚ç‚¹ä¸Šçš„ç¬¬å‡ å¼  GPU å¡ï¼‰ æ¥è®¾ç½®æ‰€éœ€çš„æ˜¾å­˜åˆ†é…ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:5:4","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"4.5 æ•°æ®å¤„ç† æ¥ä¸‹æ¥æ˜¯æ•°æ®å¤„ç†ã€‚ dataset = tf.data.Dataset.from_tensor_slices( (tf.cast(mnist_images[..., tf.newaxis] / 255.0, tf.float32), tf.cast(mnist_labels, tf.int64)) ) dataset = dataset.repeat().shuffle(10000).batch(128) è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦è¯´æ˜ï¼š é¦–å…ˆï¼Œè®­ç»ƒçš„æ•°æ®éœ€è¦æ”¾ç½®åœ¨ä»»ä½•èŠ‚ç‚¹éƒ½èƒ½è®¿é—®çš„åœ°æ–¹ã€‚ å…¶æ¬¡ï¼ŒHorovod éœ€è¦å¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡å¤„ç†ï¼Œéœ€è¦åœ¨ä¸åŒæœºå™¨ä¸ŠæŒ‰Rankè¿›è¡Œåˆ‡åˆ†ï¼Œä»¥ä¿è¯æ¯ä¸ªGPUè¿›ç¨‹è®­ç»ƒçš„æ•°æ®é›†æ˜¯ä¸ä¸€æ ·çš„ã€‚ æ•°æ®é›†æœ¬ä½“éœ€è¦å‡ºäºæ•°æ®å¹¶è¡Œæ€§çš„éœ€æ±‚è€Œè¢«æ‹†åˆ†ä¸ºå¤šä¸ªåˆ†ç‰‡ï¼ŒHorovodçš„ä¸åŒå·¥ä½œèŠ‚ç‚¹éƒ½å°†åˆ†åˆ«è¯»å–è‡ªå·±çš„æ•°æ®é›†åˆ†ç‰‡ã€‚ ä» PyTorch ç¤ºä¾‹è„šæœ¬çœ‹å¾—æ›´åŠ æ¸…æ¥šã€‚ # Horovod: use DistributedSampler to partition the training data. train_sampler = torch.utils.data.distributed.DistributedSampler( train_dataset, num_replicas=hvd.size(), rank=hvd.rank()) train_loader = torch.utils.data.DataLoader( train_dataset, batch_size=args.batch_size, sampler=train_sampler, **kwargs) DataLoaderçš„é‡‡æ ·å™¨ç»„ä»¶ä»è¦ç»˜åˆ¶çš„æ•°æ®é›†ä¸­è¿”å›å¯è¿­ä»£çš„ç´¢å¼•ã€‚ PyTorchä¸­çš„é»˜è®¤é‡‡æ ·å™¨æ˜¯é¡ºåºçš„ï¼Œè¿”å›åºåˆ—0, 1, 2, â€¦, n ã€‚ Horovodä½¿ç”¨å…¶DistributedSamplerè¦†ç›–äº†æ­¤è¡Œä¸ºï¼Œè¯¥DistributedSamplerå¤„ç†è·¨è®¡ç®—æœºçš„æ•°æ®é›†åˆ†åŒºã€‚ DistributedSampleræœ¬èº«æ¥å—ä¸¤ä¸ªå‚æ•°ä½œä¸ºè¾“å…¥ï¼š hvd.size() (GPUçš„æ€»æ•°ï¼Œä¾‹å¦‚16)å’Œhvd.rank() (ä»æ€»ä½“åˆ—è¡¨ä¸­åˆ†é…ç»™è¯¥è®¾å¤‡çš„IDï¼Œä¾‹å¦‚0â€¦15)ã€‚ Pytorchä½¿ç”¨çš„æ˜¯æ•°æ®åˆ†å¸ƒå¼è®­ç»ƒï¼Œæ¯ä¸ªè¿›ç¨‹å®é™…ä¸Šæ˜¯ç‹¬ç«‹åŠ è½½æ•°æ®çš„ï¼Œæ‰€ä»¥éœ€è¦åŠ è½½ç›¸åŒæ•°æ®é›†åç”¨ä¸€å®šçš„è§„åˆ™æ ¹æ®rankæ¥é¡ºåºåˆ‡å‰²è·å–ä¸åŒçš„æ•°æ®å­é›†ï¼ŒDistributedSamplerå°±æ˜¯ç”¨æ¥ç¡®ä¿dataloaderåªä¼šloadåˆ°æ•´ä¸ªæ•°æ®é›†çš„ä¸€ä¸ªç‰¹å®šå­é›†çš„åšæ³•(å®é™…ä¸Šä¸ç”¨Pytorchæä¾›çš„DistributedSamplerå·¥å…·ï¼Œè‡ªå·±åšåŠ è½½æ•°æ®ååˆ‡åˆ†word_sizeä¸ªå­é›†æŒ‰ranké¡ºåºæ‹¿åˆ°å­é›†æ•ˆæœä¹Ÿæ˜¯ä¸€æ ·)ã€‚ åŒæ—¶ä¸ºäº†èƒ½å¤ŸæŒ‰é¡ºåºåˆ’åˆ†æ•°æ®å­é›†ï¼Œæ‹¿åˆ°ä¸åŒéƒ¨åˆ†æ•°æ®ï¼Œæ‰€ä»¥æ•°æ®é›†ä¸èƒ½å¤Ÿè¿›è¡Œéšæœºæ‰“æ•£ï¼Œæ‰€ä»¥ç”¨äº†å‚æ•° 'shuffle': Falseã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:5:5","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"4.6 å¹¿æ’­åˆå§‹åŒ–å˜é‡ ä»¥ä¸‹ä»£ç å®Œæˆå¹¿æ’­åˆå§‹åŒ–çš„åŠŸèƒ½ã€‚ hvd.callbacks.BroadcastGlobalVariablesCallback(0) è¿™å¥ä»£ç ä¿è¯çš„æ˜¯ rank 0 ä¸Šçš„æ‰€æœ‰å‚æ•°åªåœ¨ rank 0 åˆå§‹åŒ–ï¼Œç„¶åå¹¿æ’­ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œå³å˜é‡ä»ç¬¬ä¸€ä¸ªæµç¨‹å‘å…¶ä»–æµç¨‹ä¼ æ’­ï¼Œä»¥å®ç°å‚æ•°ä¸€è‡´æ€§åˆå§‹åŒ–ã€‚ ä¸‹é¢å°±ä»‹ç»ä¸‹ Horvod ä¹‹ä¸­å¹¿æ’­çš„ä½¿ç”¨ã€‚ 4.6.1 å¹¿æ’­å®šä¹‰ å¹¿æ’­çš„å…·ä½“å®ç°æ˜¯ï¼š class BroadcastGlobalVariablesCallbackImpl(object): def __init__(self, backend, root_rank, device='', *args): super(BroadcastGlobalVariablesCallbackImpl, self).__init__(*args) self.backend = backend self.root_rank = root_rank self.device = device self.broadcast_done = False def on_batch_end(self, batch, logs=None): if self.broadcast_done: return with tf.device(self.device): if hvd._executing_eagerly() and hasattr(self.model, 'variables'): # TensorFlow 2.0 or TensorFlow eager hvd.broadcast_variables(self.model.variables, root_rank=self.root_rank) hvd.broadcast_variables(self.model.optimizer.variables(), root_rank=self.root_rank) else: bcast_op = hvd.broadcast_global_variables(self.root_rank) self.backend.get_session().run(bcast_op) self.broadcast_done = True 4.6.2 broadcast_variables broadcast_variables è°ƒç”¨äº† _make_broadcast_group_fn å®ŒæˆåŠŸèƒ½ï¼Œå¯ä»¥çœ‹åˆ°å¯¹äº æ‰§è¡Œå›¾ çš„æ¯ä¸ªå˜é‡ï¼Œè°ƒç”¨äº† broadcastã€‚ def broadcast_variables(variables, root_rank): \"\"\"Broadcasts variables from root rank to all other processes. Arguments: variables: variables for broadcast root_rank: rank of the process from which global variables will be broadcasted to all other processes. \"\"\" broadcast_group = _make_broadcast_group_fn() return broadcast_group(variables, root_rank) ä»¥åŠ @_cache def _make_broadcast_group_fn(): if _executing_eagerly(): # Eager mode will parallelize independent control flow def broadcast_group(variables, root_rank): for var in variables: var.assign(broadcast(var, root_rank)) return _make_subgraph(broadcast_group) else: # Graph mode requires an Op def broadcast_group(variables, root_rank): return tf.group(*[var.assign(broadcast(var, root_rank)) for var in variables]) return broadcast_group 4.6.3 è°ƒç”¨ MPI broadcast å°±æ˜¯è°ƒç”¨äº† MPI å‡½æ•°çœŸæ­£å®Œæˆäº†åŠŸèƒ½ã€‚ def broadcast(tensor, root_rank, name=None, ignore_name_scope=False): \"\"\"An op which broadcasts the input tensor on root rank to the same input tensor on all other Horovod processes. The broadcast operation is keyed by the name of the op. The tensor type and shape must be the same on all Horovod processes for a given name. The broadcast will not start until all processes are ready to send and receive the tensor. Returns: A tensor of the same shape and type as `tensor`, with the value broadcasted from root rank. \"\"\" if name is None and not _executing_eagerly(): name = 'HorovodBroadcast_%s' % _normalize_name(tensor.name) return MPI_LIB.horovod_broadcast(tensor, name=name, root_rank=root_rank, ignore_name_scope=ignore_name_scope) 4.6.4 åŒæ­¥å‚æ•° åœ¨åå°è¿›ç¨‹ä¸­ï¼Œä¼šæ ¹æ®æƒ…å†µå®šæœŸåŒæ­¥å‚æ•°ã€‚ bool RunLoopOnce(HorovodGlobalState\u0026 state) { // ä¸šåŠ¡é€»è¾‘åŠŸèƒ½ if (state.parameter_manager.IsAutoTuning()) { bool should_sync = state.parameter_manager.Update(tensor_names, total_tensor_size); // çœ‹çœ‹æ˜¯å¦éœ€è¦åŒæ­¥ï¼Œå¦‚æœéœ€è¦ï¼Œå°±åŒæ­¥ã€‚ if (should_sync) { state.controller-\u003eSynchronizeParameters(); } } ...... } åŒæ­¥å‚æ•°ä»£ç ä¹Ÿæ˜¯è°ƒç”¨äº† Bcast åŠŸèƒ½å®Œæˆã€‚ void Controller::SynchronizeParameters() { ParameterManager::Params param; if (is_coordinator_) { // rank 0 æ‰§è¡Œæ“ä½œ param = parameter_manager_.GetParams(); } void* buffer = (void*)(\u0026param); size_t param_size = sizeof(param); Bcast(buffer, param_size, 0, Communicator::GLOBAL); if (!is_coordinator_) { // worker æ‰§è¡Œæ“ä½œ parameter_manager_.SetParams(param); } } ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:5:6","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"4.7 DistributedOptimizer æœ€åéœ€è¦é…ç½®DistributedOptimizerï¼Œè¿™å°±æ˜¯å…³é”®ç‚¹ä¹‹ä¸€ã€‚ # Horovod: add Horovod DistributedOptimizer. opt = hvd.DistributedOptimizer( opt, backward_passes_per_step=1, average_aggregated_gradients=True) TF Optimizer æ˜¯æ¨¡å‹è®­ç»ƒçš„å…³é”®APIï¼Œå¯ä»¥è·å–åˆ°æ¯ä¸ªOPçš„æ¢¯åº¦å¹¶ç”¨æ¥æ›´æ–°æƒé‡ã€‚HVD åœ¨åŸå§‹ TF Optimizerçš„åŸºç¡€ä¸ŠåŒ…è£…äº†hvd.DistributedOptimizerã€‚ DistributedOptimizeråŒ…è£…å™¨å°†åŸå§‹ä¼˜åŒ–å™¨ä½œä¸ºè¾“å…¥ï¼Œå°†æ¢¯åº¦è®¡ç®—å§”æ‰˜ç»™å®ƒã€‚ å³DistributedOptimizerä¼šè°ƒç”¨åŸå§‹ä¼˜åŒ–å™¨è¿›è¡Œæ¢¯åº¦è®¡ç®—ã€‚è¿™æ ·ï¼Œåœ¨é›†ç¾¤ä¸­æ¯å°æœºå™¨éƒ½ä¼šç”¨åŸå§‹ä¼˜åŒ–å™¨å¾—åˆ°è‡ªå·±çš„æ¢¯åº¦ï¼ˆLocal Gradientï¼‰ã€‚ Horovod DistributedOptimizeræ¥ä¸‹æ¥ä¼šä½¿ç”¨all-reduceæˆ–all-gatheræ¥å®Œæˆå…¨å±€æ¢¯åº¦å½’å¹¶ï¼Œç„¶åå°†è¿™äº›å¹³å‡æ¢¯åº¦åº”ç”¨äºæ‰€æœ‰è®¾å¤‡ã€‚ æˆ‘ä»¬æ¢³ç†ä¸‹å…¶ä¸­çš„è°ƒç”¨å…³ç³»ï¼š hvd.DistributedOptimizerç»§æ‰¿ keras Optimizerï¼Œåœ¨è®¡ç®—æ—¶å€™ï¼Œä¾ç„¶ç”±ä¼ å…¥çš„åŸå§‹ä¼˜åŒ–å™¨åšè®¡ç®—ã€‚ åœ¨å¾—åˆ°è®¡ç®—çš„æ¢¯åº¦ä¹‹åï¼Œè°ƒç”¨ hvd.allreduce æˆ–è€… hvd.allgather æ¥è®¡ç®—ã€‚ æœ€åå®æ–½è¿™äº›å¹³å‡ä¹‹åçš„æ¢¯åº¦ã€‚ä»è€Œå®ç°æ•´ä¸ªé›†ç¾¤çš„æ¢¯åº¦å½’å¹¶æ“ä½œã€‚ å…·ä½“åæ–‡ä¼šè¯¦ç»†ä»‹ç»ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:5:7","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"4.8 æœªæ¥å¯èƒ½ Horovod ç›®å‰æ¶æ„çš„åŸºç¡€æ˜¯ï¼šæœºå™¨å­¦ä¹ çš„æ¨¡å‹å‚æ•°åœ¨ä¸€å¼  GPU ä¸Šå¯ä»¥å­˜ä¸‹ã€‚ æœªæ¥æ˜¯å¦å¯ä»¥æŠŠæ¨¡å‹åˆ†ç‰‡ç»“åˆè¿›æ¥ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„çœ‹ç‚¹ã€‚ å¦å¤–ï¼Œå¦‚æœæ¨¡å‹çš„å…¨è¿æ¥å±‚è¾ƒå¤šï¼Œåˆ™å…¨è¿æ¥å±‚çš„å¼ºè€¦åˆæ€§ç»“åˆ allreduce ç±»ä¼¼ bsp çš„åŒæ­¥æœºåˆ¶ï¼Œè¿˜æ˜¯ä¼šè®©ç½‘ç»œé€šä¿¡æ—¶é—´æˆä¸ºç“¶é¢ˆã€‚å› æ­¤ï¼Œåœ¨ ring-allreduce ç¯å¢ƒä¸‹ï¼ŒåŒæ­¥åè®®çš„æ”¹é€ ï¼Œæ¯”å¦‚åˆ©ç”¨ SSP æ¥æ›¿æ¢ BSPï¼Œæˆ–è€…åˆ©ç”¨æ¢¯åº¦å‹ç¼©æ¥åŠ å¿« allreduce è¿›ç¨‹ä¹Ÿæ˜¯å€¼å¾—æ¢ç´¢çš„æ–¹å‘ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:5:8","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"5 æ€»ç»“ é’ˆå¯¹æ–‡åˆæå‡ºçš„å‡ ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç°åœ¨å›ç­”å¦‚ä¸‹ï¼š Hovorod æ€ä¹ˆè¿›è¡Œæ•°æ®åˆ†å‰²ï¼Ÿ ç­”æ¡ˆï¼šæœ‰çš„æ¡†æ¶å¯ä»¥è‡ªåŠ¨åšæ•°æ®åˆ†å‰²ã€‚å¦‚æœæ¡†æ¶ä¸æä¾›ï¼Œåˆ™éœ€è¦ç”¨æˆ·è‡ªå·±è¿›è¡Œæ•°æ®åˆ†å‰²ï¼Œä»¥ä¿è¯æ¯ä¸ªGPUè¿›ç¨‹è®­ç»ƒçš„æ•°æ®é›†æ˜¯ä¸ä¸€æ ·çš„ã€‚ Hovorod æ€ä¹ˆè¿›è¡Œæ¨¡å‹åˆ†å‘ï¼Ÿ ç”¨æˆ·éœ€è¦æ‰‹åŠ¨æ‹·è´è®­ç»ƒä»£ç åˆ°å„ä¸ªèŠ‚ç‚¹ä¸Šã€‚ Hovorod å¯åŠ¨æ—¶å€™ï¼Œpython å’Œ C++ éƒ½åšäº†ä»€ä¹ˆï¼Ÿ ç­”æ¡ˆï¼špython ä¼šå¼•å…¥ C++åº“ï¼Œåˆå§‹åŒ–å„ç§å˜é‡å’Œé…ç½®ã€‚C++éƒ¨åˆ†ä¼šå¯¹ MPIï¼ŒGLOOä¸Šä¸‹æ–‡è¿›è¡Œåˆå§‹åŒ–ï¼Œå¯åŠ¨åå°è¿›ç¨‹å¤„ç†å†…éƒ¨é€šä¿¡ã€‚ å¦‚ä½•ç¡®ä¿ Hovorod å¯åŠ¨æ—¶å€™æ­¥éª¤ä¸€è‡´ï¼› ç­”æ¡ˆï¼š rank 0 ä¸Šçš„æ‰€æœ‰å‚æ•°åªåœ¨ rank 0 åˆå§‹åŒ–ï¼Œç„¶åå¹¿æ’­ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œå³å˜é‡ä»ç¬¬ä¸€ä¸ªæµç¨‹å‘å…¶ä»–æµç¨‹ä¼ æ’­ï¼Œä»¥å®ç°å‚æ•°ä¸€è‡´æ€§åˆå§‹åŒ–ã€‚ ä¸‹ä¸€ç¯‡æ–‡ç« å°†æ·±å…¥åˆ°pythonä¸–ç•Œçœ‹çœ‹ã€‚ reference: [1].https://www.cnblogs.com/rossiXYZ/p/14856543.html ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_2/:6:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[2] -- ä»ä½¿ç”¨è€…è§’åº¦åˆ‡å…¥","uri":"/posts/2022-10-08_horovod_2/"},{"categories":["Distributed Computing"],"content":"0 æ‘˜è¦ Horovod æ˜¯Uberäº2017å¹´å‘å¸ƒçš„ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ï¼Œåœ¨ä¸šç•Œå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚ æœ¬ç³»åˆ—å°†é€šè¿‡æºç åˆ†ææ¥å¸¦é¢†å¤§å®¶äº†è§£ Horovodã€‚ç³»åˆ—å¤§çº¦æœ‰15 ï½ 18 ç¯‡ï¼Œæœ¬æ–‡æ˜¯ç³»åˆ—ç¬¬ä¸€ç¯‡ï¼Œä»‹ç»ç›¸å…³èƒŒæ™¯çŸ¥è¯†ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:1:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"1 åˆ†å¸ƒå¼å¹¶è¡Œè®­ç»ƒ æˆ‘ä»¬é¦–å…ˆè¦ä»‹ç»ä¸‹åˆ†å¸ƒå¼å¹¶è¡Œè®­ç»ƒã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:2:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"1.1 åˆ†å¸ƒå¼å¹¶è¡Œè®­ç»ƒçš„å¿…è¦ ä¼ ç»Ÿçš„æ¨¡å‹è®­ç»ƒä¸­ï¼Œè¿­ä»£è®¡ç®—åªèƒ½åˆ©ç”¨å½“å‰è¿›ç¨‹æ‰€åœ¨ä¸»æœºä¸Šçš„æ‰€æœ‰ç¡¬ä»¶èµ„æºï¼Œå¯æ˜¯å•æœºæ‰©å±•æ€§å§‹ç»ˆæœ‰é™ã€‚è€Œç›®å‰çš„æœºå™¨å­¦ä¹ æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š æ ·æœ¬æ•°é‡å¤§ ç›®å‰è®­ç»ƒæ•°æ®è¶Šæ¥è¶Šå¤šï¼Œåœ¨å¤§å‹äº’è”ç½‘åœºæ™¯ä¸‹ï¼Œæ¯å¤©çš„æ ·æœ¬é‡å¯ä»¥è¾¾åˆ°ç™¾äº¿çº§åˆ«ã€‚ ç‰¹å¾ç»´åº¦å¤š å› ä¸ºå·¨å¤§æ ·æœ¬é‡å¯¼è‡´æœºå™¨å­¦ä¹ æ¨¡å‹å‚æ•°è¶Šæ¥è¶Šå¤šï¼Œç‰¹å¾ç»´åº¦å¯ä»¥è¾¾åˆ°åƒäº¿æˆ–è€…ä¸‡äº¿çº§åˆ«ã€‚ è®­ç»ƒæ€§èƒ½è¦æ±‚é«˜ è™½ç„¶æ ·æœ¬é‡å’Œæ¨¡å‹å‚æ•°å·¨å¤§ï¼Œä½†æ˜¯ä¸šåŠ¡éœ€è¦æˆ‘ä»¬åœ¨çŸ­æœŸå†…è®­ç»ƒå‡ºä¸€ä¸ªä¼˜ç§€çš„æ¨¡å‹æ¥éªŒè¯ã€‚ æ¨¡å‹å®æ—¶ä¸Šçº¿ å¯¹äºæ¨èèµ„è®¯ç±»åº”ç”¨ï¼Œå¾€å¾€è¦æ±‚æ ¹æ®ç”¨æˆ·æœ€æ–°è¡Œä¸ºåŠæ—¶è°ƒæ•´æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚ å› æ­¤ï¼Œå•æœºé¢å¯¹æµ·é‡æ•°æ®å’Œå·¨å¤§æ¨¡å‹æ—¶æ˜¯æ— èƒ½ä¸ºåŠ›çš„ï¼Œæœ‰å¿…è¦æŠŠæ•°æ®æˆ–è€…æ¨¡å‹åˆ†å‰²æˆä¸ºå¤šä»½ï¼Œåœ¨å¤šä¸ªæœºå™¨ä¸Šå€ŸåŠ©ä¸åŒä¸»æœºä¸Šçš„ç¡¬ä»¶èµ„æºè¿›è¡Œè®­ç»ƒåŠ é€Ÿã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:2:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"1.2 åˆ†å¸ƒå¼è®­ç»ƒ æœ¬æ–‡æ‰€è¯´çš„è®­ç»ƒï¼ŒæŒ‡çš„æ˜¯åˆ©ç”¨è®­ç»ƒæ•°æ®é€šè¿‡è®¡ç®—æ¢¯åº¦ä¸‹é™çš„æ–¹å¼è¿­ä»£åœ°å»ä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°ï¼Œå¹¶æœ€ç»ˆè¾“å‡ºç½‘ç»œæ¨¡å‹çš„è¿‡ç¨‹ã€‚åœ¨å•æ¬¡æ¨¡å‹è®­ç»ƒè¿­ä»£ä¸­ï¼Œä¼šæœ‰å¦‚ä¸‹æ“ä½œï¼š é¦–å…ˆåˆ©ç”¨æ•°æ®å¯¹æ¨¡å‹è¿›è¡Œå‰å‘çš„è®¡ç®—ã€‚æ‰€è°“çš„å‰å‘è®¡ç®—ï¼Œå°±æ˜¯å°†æ¨¡å‹ä¸Šä¸€å±‚çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ï¼Œå¹¶è®¡ç®—ä¸‹ä¸€å±‚çš„è¾“å‡ºï¼Œä»è¾“å…¥å±‚ä¸€ç›´ç®—åˆ°è¾“å‡ºå±‚ä¸ºæ­¢ã€‚ å…¶æ¬¡ä¼šæ ¹æ®ç›®æ ‡å‡½æ•°ï¼Œæˆ‘ä»¬å°†åå‘è®¡ç®—æ¨¡å‹ä¸­æ¯ä¸ªå‚æ•°çš„å¯¼æ•°ï¼Œå¹¶ä¸”ç»“åˆå­¦ä¹ ç‡æ¥æ›´æ–°æ¨¡å‹çš„å‚æ•°ã€‚ è€Œå¹¶è¡Œæ¢¯åº¦ä¸‹é™çš„åŸºæœ¬æ€æƒ³ä¾¿æ˜¯ï¼šå¤šä¸ªå¤„ç†å™¨åˆ†åˆ«åˆ©ç”¨è‡ªå·±çš„æ•°æ®æ¥è®¡ç®—æ¢¯åº¦ï¼Œæœ€åé€šè¿‡èšåˆæˆ–å…¶ä»–æ–¹å¼æ¥å®ç°å¹¶è¡Œè®¡ç®—æ¢¯åº¦ä¸‹é™ä»¥åŠ é€Ÿæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ã€‚ æ¯”å¦‚ä¸¤ä¸ªå¤„ç†å™¨åˆ†åˆ«å¤„ç†ä¸€åŠæ•°æ®è®¡ç®—æ¢¯åº¦ g_1, g_2ï¼Œç„¶åæŠŠä¸¤ä¸ªæ¢¯åº¦ç»“æœè¿›è¡Œèšåˆæ›´æ–°ï¼Œè¿™æ ·å°±å®ç°äº†å¹¶è¡Œæ¢¯åº¦ä¸‹é™ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:2:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"1.3 è®­ç»ƒå¹¶è¡Œæœºåˆ¶ 1.3.1 ä¸‰ç§æœºåˆ¶ ç”±äºä½¿ç”¨å°æ‰¹é‡ç®—æ³•ï¼Œå¯ä»¥æŠŠå®½åº¦$(âˆW)$å’Œæ·±åº¦$(âˆD)$çš„å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­åˆ†å‘åˆ°å¹¶è¡Œçš„å¤„ç†å™¨ä¸Šï¼Œè¿™æ ·æ·±åº¦è®­ç»ƒçš„å¹¶è¡Œæœºåˆ¶ä¸»è¦æœ‰ä¸‰ç§ï¼š ç¬¬ä¸€ä¸ªæ˜¯æ¨¡å‹å¹¶è¡Œæœºåˆ¶ï¼ˆæŒ‰ç…§ç½‘ç»œç»“æ„åˆ†åŒºï¼‰ã€‚ é€šå¸¸æ˜¯é’ˆå¯¹ä¸€ä¸ªèŠ‚ç‚¹æ— æ³•å­˜ä¸‹æ•´ä¸ªæ¨¡å‹çš„æƒ…å†µä¸‹ï¼Œå»å¯¹å›¾è¿›è¡Œæ‹†åˆ†ã€‚ å°†æ¨¡å‹å‚æ•°è¿›è¡Œåˆ†å¸ƒå¼å­˜å‚¨ã€‚è®¡ç®—æœºä¸Šæ¯ä¸ªè®¡ç®—å¯ä»¥å»ºæ¨¡ä¸ºä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ï¼Œé¡¶ç‚¹æ˜¯è®¡ç®—æŒ‡ä»¤ï¼Œè¾¹æ˜¯æ•°æ®ä¾èµ–ï¼ˆæ•°æ®æµï¼‰ã€‚â€œåŸºäºå›¾å»æ‹†åˆ†â€ ä¼šæ ¹æ®æ¯ä¸€å±‚ä¸­çš„ç¥ç»å…ƒï¼ˆå³å››ç»´å¼ é‡ä¸­çš„Cã€Hæˆ–Wç»´ï¼‰æ¥æŠŠä¸€å¼ å¤§çš„å›¾æ‹†åˆ†æˆå¾ˆå¤šéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½ä¼šåœ¨å¾ˆå¤šè®¾å¤‡ä¸Šå»è®¡ç®—ã€‚ æˆ–è€…å¯ä»¥è¿™ä¹ˆç†è§£ï¼šæ·±åº¦å­¦ä¹ çš„è®¡ç®—ä¸»è¦æ˜¯çŸ©é˜µè¿ç®—ï¼Œæœ‰æ—¶å€™çŸ©é˜µéå¸¸å¤§æ— æ³•æ”¾åˆ°æ˜¾å­˜ä¸­ï¼Œå°±åªèƒ½æŠŠè¶…å¤§çŸ©é˜µæ‹†åˆ†äº†æ”¾åˆ°ä¸åŒå¡ä¸Šè®¡ç®—ã€‚ æ¨¡å‹è¾ƒåéƒ¨åˆ†çš„è®¡ç®—å¿…é¡»ç­‰å‰é¢è®¡ç®—å®Œæˆï¼Œå› æ­¤ä¸åŒèŠ‚ç‚¹é—´çš„è®¡ç®—å®é™…æ˜¯ä¸²è¡Œçš„ã€‚ä½†æ¯ä¸ªéƒ¨åˆ†è®¡ç®—äº’ä¸å¦¨ç¢ï¼Œæ›´åƒæ˜¯æµæ°´çº¿ç»“æ„ã€‚ ç¬¬äºŒä¸ªæ˜¯æ•°æ®å¹¶è¡Œæœºåˆ¶ï¼ˆæŒ‰ç…§è¾“å…¥æ ·æœ¬åˆ†åŒºï¼‰ã€‚ æ›´å¤šåœºæ™¯ä¸‹æˆ‘ä»¬æ¨¡å‹è§„æ¨¡ä¸å¤§ï¼Œåœ¨ä¸€å¼  GPU å¯ä»¥å®¹çº³ï¼Œä½†æ˜¯è®­ç»ƒæ•°æ®é‡ä¼šæ¯”è¾ƒå¤§ï¼Œè¿™æ—¶å€™å°±é‡‡ç”¨æ•°æ®å¹¶è¡Œæœºåˆ¶ã€‚ å…·ä½“å°±æ˜¯åœ¨å¤šèŠ‚ç‚¹ä¸Šå¹¶è¡Œåˆ†å‰²æ•°æ®å’Œè®­ç»ƒã€‚ ç¬¬ä¸‰ç§ä¸å¸¸ç”¨çš„å¹¶è¡Œæœºåˆ¶æ˜¯ æµæ°´çº¿æœºåˆ¶ï¼ˆæŒ‰å±‚åˆ†åŒºï¼‰ã€‚ åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæµæ°´çº¿å¯ä»¥æ˜¯æŒ‡é‡å çš„è®¡ç®—ï¼Œå³åœ¨ä¸€å±‚å’Œä¸‹ä¸€å±‚ä¹‹é—´ï¼ˆå½“æ•°æ®å‡†å¤‡å°±ç»ªæ—¶ï¼‰è¿ç»­è®¡ç®—ï¼›æˆ–è€…æ ¹æ®æ·±åº¦åˆ’åˆ†DNNï¼Œå°†å±‚åˆ†é…ç»™ç‰¹å®šå¤„ç†å™¨ã€‚ æµæ°´çº¿å¯ä»¥çœ‹ä½œæ˜¯æ•°æ®å¹¶è¡Œçš„ä¸€ç§å½¢å¼ï¼Œå› ä¸ºå…ƒç´ ï¼ˆæ ·æœ¬ï¼‰æ˜¯é€šè¿‡ç½‘ç»œå¹¶è¡Œå¤„ç†çš„ï¼Œä½†ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯æ¨¡å‹å¹¶è¡Œï¼Œå› ä¸ºæµæ°´çº¿çš„é•¿åº¦æ˜¯ç”±DNNç»“æ„å†³å®šçš„ã€‚ å…·ä½“å¯è§ä¸‹å›¾: 1.3.2 å¦‚ä½•ä½¿ç”¨ æ•°æ®çš„å¹¶è¡Œå¾€å¾€æ„å‘³ç€è®¡ç®—æ€§èƒ½çš„å¯æ‰©å±•ï¼Œè€Œæ¨¡å‹çš„å¹¶è¡Œå¾€å¾€æ„å‘³ç€å†…å­˜ä½¿ç”¨çš„å¯æ‰©å±•ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ•°æ®å¹¶è¡Œå’Œæ¨¡å‹å¹¶è¡Œä¹Ÿå¹¶ä¸å†²çªï¼Œä¸¤è€…å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œè€Œæµæ°´çº¿æœºåˆ¶ä¹Ÿå¯ä»¥å’Œæ¨¡å‹å¹¶è¡Œä¸€èµ·æ··ç”¨ã€‚æ¯”å¦‚ï¼ŒDistBeliefåˆ†å¸ƒå¼æ·±åº¦å­¦ä¹ ç³»ç»Ÿç»“åˆäº†ä¸‰ç§å¹¶è¡Œç­–ç•¥ã€‚è®­ç»ƒåœ¨åŒæ—¶å¤åˆ¶çš„å¤šä¸ªæ¨¡å‹ä¸Šè®­ç»ƒï¼Œæ¯ä¸ªæ¨¡å‹å‰¯æœ¬åœ¨ä¸åŒçš„æ ·æœ¬ä¸Šè®­ç»ƒï¼ˆæ•°æ®å¹¶è¡Œï¼‰ï¼Œæ¯ä¸ªå‰¯æœ¬ä¸Šï¼Œä¾æ®åŒä¸€å±‚çš„ç¥ç»å…ƒï¼ˆæ¨¡å‹å¹¶è¡Œæ€§ï¼‰å’Œä¸åŒå±‚ï¼ˆæµæ°´çº¿ï¼‰ä¸Šåˆ’åˆ†ä»»åŠ¡ï¼Œè¿›è¡Œåˆ†å¸ƒè®­ç»ƒã€‚ å¦å¤–ä¹Ÿéœ€è¦æ ¹æ®å…·ä½“é—®é¢˜å…·ä½“åˆ†æï¼Œæ¯”å¦‚ç°ä»£å·ç§¯ç¥ç»ç½‘ç»œä¸»è¦ç”±ä¸¤ç§å±‚æ„æˆï¼Œä»–ä»¬å…·æœ‰ä¸ä¸€æ ·çš„å±æ€§å’Œæ€§èƒ½ã€‚ å·ç§¯å±‚ï¼Œå æ®äº†90% ~ 95% çš„è®¡ç®—é‡ï¼Œ5% çš„å‚æ•°ï¼Œä½†æ˜¯å¯¹ç»“æœå…·æœ‰å¾ˆå¤§çš„è¡¨è¾¾èƒ½åŠ›ã€‚ å…¨è¿æ¥å±‚ï¼Œå æ®äº† 5% ~ 10% çš„è®¡ç®—é‡ï¼Œ 95% çš„å‚æ•°ï¼Œä½†æ˜¯å¯¹äºç»“æœå…·æœ‰ç›¸å¯¹è¾ƒå°çš„è¡¨è¾¾çš„èƒ½åŠ›ã€‚ ç»¼ä¸Šï¼šå·ç§¯å±‚è®¡ç®—é‡å¤§ï¼Œæ‰€éœ€å‚æ•°ç³»æ•° W å°‘ï¼Œå…¨è¿æ¥å±‚è®¡ç®—é‡å°ï¼Œæ‰€éœ€å‚æ•°ç³»æ•° W å¤šã€‚å› æ­¤å¯¹äºå·ç§¯å±‚é€‚åˆä½¿ç”¨æ•°æ®å¹¶è¡Œï¼Œå¯¹äºå…¨è¿æ¥å±‚é€‚åˆä½¿ç”¨æ¨¡å‹å¹¶è¡Œã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:2:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"1.4 æ•°æ®å¹¶è¡Œè®­ç»ƒ æˆ‘ä»¬æœ¬ç³»åˆ—ä¸»è¦è®¨è®ºæ•°æ®å¹¶è¡Œè®­ç»ƒï¼ˆå…¶ä¸­çš„ä¸€ç§æ¶æ„ï¼‰. æ•°æ®å¹¶è¡Œè®­ç»ƒåªæ˜¯ä¸€ç§é€»è¾‘æ¶æ„ã€‚æˆ‘ä»¬ä»æ²ç¥çš„ä¹¦é‡Œé¢æ‘˜å½•ï¼š å‡è®¾æœºå™¨ä¸Šæœ‰kä¸ªGPUã€‚ç»™å®šè¦è®­ç»ƒçš„æ¨¡å‹ï¼Œæ¯ä¸ªGPUå°†ç‹¬ç«‹åœ°ç»´æŠ¤ä¸€ç»„å®Œæ•´çš„æ¨¡å‹å‚æ•°ï¼Œå°½ç®¡GPUä¸Šçš„å‚æ•°å€¼æ˜¯ç›¸åŒä¸”åŒæ­¥çš„ã€‚ä¾‹å¦‚ï¼Œä¸‹å›¾æ¼”ç¤ºäº†åœ¨k=2æ—¶ä½¿ç”¨æ•°æ®å¹¶è¡Œçš„è®­ç»ƒã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œè®­ç»ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š åœ¨è®­ç»ƒçš„ä»»ä½•è¿­ä»£ä¸­ï¼Œç»™å®šä¸€ä¸ªéšæœºçš„å°æ‰¹é‡ï¼Œæˆ‘ä»¬å°†è¯¥å°æ‰¹é‡ä¸­çš„æ ·æœ¬åˆ†æˆkä¸ªéƒ¨åˆ†ï¼Œå¹¶å°†å®ƒä»¬å‡åŒ€åœ°åˆ†åœ¨å¤šä¸ªGPUä¸Šã€‚ æ¯ä¸ªGPUæ ¹æ®åˆ†é…ç»™å®ƒçš„å°æ‰¹é‡å­é›†è®¡ç®—æ¨¡å‹å‚æ•°çš„æŸå¤±å’Œæ¢¯åº¦ã€‚ å°†kä¸ªGPUä¸­æ¯ä¸ªGPUçš„å±€éƒ¨æ¢¯åº¦èšåˆä»¥è·å¾—å½“å‰çš„å°æ‰¹é‡éšæœºæ¢¯åº¦ã€‚ èšåˆæ¢¯åº¦è¢«é‡æ–°åˆ†é…åˆ°æ¯ä¸ªGPUã€‚ æ¯ä¸ªGPUä½¿ç”¨è¿™ä¸ªå°æ‰¹é‡éšæœºæ¢¯åº¦æ¥æ›´æ–°å®ƒç»´æŠ¤çš„å®Œæ•´çš„æ¨¡å‹å‚æ•°é›†ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:2:4","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"2 é€šä¿¡å’Œæ¶æ„ å‰é¢æåˆ°å¹¶è¡Œæ¢¯åº¦ä¸‹é™çš„ä¾‹å­ï¼šä¸¤ä¸ªå¤„ç†å™¨åˆ†åˆ«å¤„ç†ä¸€èˆ¬æ•°æ®è®¡ç®—æ¢¯åº¦ $g_1$, $g_2$ï¼Œç„¶åæŠŠä¸¤ä¸ªæ¢¯åº¦ç»“æœè¿›è¡Œèšåˆï¼Œæœ€åå†æŠŠæœ€æ–°å‚æ•°å‘ç»™å„ä¸ªåˆ†å¸ƒè®¡ç®—å•å…ƒï¼Œè¿™ç§è®­ç»ƒç®—æ³•å«æ¨¡å‹ä¸€è‡´æ€§æ–¹æ³•ï¼ˆconsistent model methodsï¼‰ã€‚è¿™å°±æ¶‰åŠåˆ°äº†é€šä¿¡é—®é¢˜ï¼Œå³å¦‚ä½•åšèšåˆã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:3:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"2.1 æ–¹æ³•å’Œæ¶æ„ ä¸€èˆ¬æœ‰ä¸¤ç§é€šä¿¡æ–¹æ³•ï¼šShare memory å’Œ Message passingã€‚ Share memory å°±æ˜¯æ‰€æœ‰å¤„ç†å™¨å…±äº«åŒä¸€å—å†…å­˜ï¼Œè¿™æ ·é€šä¿¡å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹å†…çš„å¤„ç†å™¨ä¹‹é—´æ‰å¯ä»¥å…±äº«å†…å­˜ï¼Œä¸åŒèŠ‚ç‚¹å¤„ç†å™¨ä¹‹é—´æ— æ³•å…±äº«å†…å­˜ã€‚ Message passing å°±æ˜¯ä¸åŒèŠ‚ç‚¹ä¹‹é—´ç”¨æ¶ˆæ¯ï¼ˆæ¯”å¦‚åŸºäº TCP/IP æˆ–è€… RDMAï¼‰è¿›è¡Œä¼ é€’/é€šä¿¡ï¼Œè¿™æ ·å®¹æ˜“æ‰©å±•ï¼Œå¯ä»¥è¿›è¡Œå¤§è§„æ¨¡è®­ç»ƒã€‚ å› æ­¤æˆ‘ä»¬çŸ¥é“ï¼ŒMessage passing æ‰æ˜¯è§£å†³æ–¹æ¡ˆï¼Œäºæ˜¯å¸¦æ¥äº†é—®é¢˜ï¼šå¦‚ä½•åè°ƒè¿™äº›èŠ‚ç‚¹ä¹‹é—´çš„é€šè®¯ã€‚ æœ‰ä¸¤ç§æ¶æ„ï¼š Client-Serveræ¶æ„: ä¸€ä¸ª server èŠ‚ç‚¹åè°ƒå…¶ä»–èŠ‚ç‚¹å·¥ä½œï¼Œå…¶ä»–èŠ‚ç‚¹æ˜¯ç”¨æ¥æ‰§è¡Œè®¡ç®—ä»»åŠ¡çš„ workerã€‚ Peer-to-Peeræ¶æ„ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰é‚»å±…ï¼Œé‚»å±…ä¹‹é—´å¯ä»¥äº’ç›¸é€šä¿¡ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:3:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"2.2 å¼‚æ­¥ vs åŒæ­¥ å¼‚æ­¥ vs åŒæ­¥ æ˜¯é€šä¿¡çš„å¦å¤–ä¸€ä¸ªä¾§é¢ã€‚ åœ¨æ•°æ®å¹¶è¡Œè®­ç»ƒä¹‹ä¸­ï¼Œå„ä¸ªè®¡ç®—è®¾å¤‡åˆ†åˆ«æ ¹æ®å„è‡ªè·å¾—çš„batchï¼Œå‰å‘è®¡ç®—è·å¾—æŸå¤±ï¼Œè¿›è€Œåå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦ã€‚è®¡ç®—å¥½æ¢¯åº¦åï¼Œå°±æ¶‰åŠåˆ°ä¸€ä¸ªæ¢¯åº¦åŒæ­¥çš„é—®é¢˜ï¼šæ¯ä¸ªè®¡ç®—è®¾å¤‡ éƒ½æœ‰æ ¹æ®è‡ªå·±çš„æ•°æ®è®¡ç®—çš„æ¢¯åº¦ï¼Œå¦‚ä½•åœ¨ä¸åŒGPUä¹‹é—´ç»´æŠ¤æ¨¡å‹çš„ä¸åŒå‰¯æœ¬ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Ÿ å¦‚æœä¸åŒçš„æ¨¡å‹ä»¥æŸç§æ–¹å¼æœ€ç»ˆè·å¾—ä¸åŒçš„æƒé‡ï¼Œåˆ™æƒé‡æ›´æ–°å°†å˜å¾—ä¸ä¸€è‡´ï¼Œå¹¶ä¸”æ¨¡å‹è®­ç»ƒå°†æœ‰æ‰€ä¸åŒã€‚ æ€ä¹ˆåšè¿™ä¸ªåŒæ­¥å°±æ˜¯è®¾è®¡åˆ†å¸ƒå¼æœºå™¨å­¦ä¹ ç³»ç»Ÿçš„ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ã€‚ åˆ†å¸ƒå¼è®­ç»ƒçš„æ¢¯åº¦åŒæ­¥ç­–ç•¥å¯åˆ†ä¸ºå¼‚æ­¥ï¼ˆasynchronousï¼‰æ¢¯åº¦æ›´æ–° å’Œ åŒæ­¥ï¼ˆsynchronousï¼‰æ¢¯åº¦æ›´æ–°æœºåˆ¶ã€‚ åŒæ­¥æŒ‡çš„æ˜¯æ‰€æœ‰çš„è®¾å¤‡éƒ½æ˜¯é‡‡ç”¨ç›¸åŒçš„æ¨¡å‹å‚æ•°æ¥è®­ç»ƒï¼Œç­‰å¾…æ‰€æœ‰è®¾å¤‡çš„mini-batchè®­ç»ƒå®Œæˆåï¼Œæ”¶é›†å®ƒä»¬çš„æ¢¯åº¦ç„¶åå–å‡å€¼ï¼Œç„¶åæ‰§è¡Œæ¨¡å‹çš„ä¸€æ¬¡å‚æ•°æ›´æ–°ã€‚ åŒæ­¥è®­ç»ƒç›¸å½“äºé€šè¿‡èšåˆå¾ˆå¤šè®¾å¤‡ä¸Šçš„mini-batchå½¢æˆä¸€ä¸ªå¾ˆå¤§çš„batchæ¥è®­ç»ƒæ¨¡å‹ï¼ŒFacebookå°±æ˜¯è¿™æ ·åšçš„ï¼Œä½†æ˜¯ä»–ä»¬å‘ç°å½“batchå¤§å°å¢åŠ æ—¶ï¼ŒåŒæ—¶çº¿æ€§å¢åŠ å­¦ä¹ é€Ÿç‡ä¼šå–å¾—ä¸é”™çš„æ•ˆæœã€‚ åŒæ­¥è®­ç»ƒçœ‹èµ·æ¥å¾ˆä¸é”™ï¼Œä½†æ˜¯å®é™…ä¸Šéœ€è¦å„ä¸ªè®¾å¤‡çš„è®¡ç®—èƒ½åŠ›è¦å‡è¡¡ï¼Œè€Œä¸”è¦æ±‚é›†ç¾¤çš„é€šä¿¡ä¹Ÿè¦å‡è¡¡ã€‚ å› ä¸ºæ¯ä¸€è½®ç»“æŸæ—¶ç®—å¾—å¿«çš„èŠ‚ç‚¹éƒ½éœ€ç­‰å¾…ç®—å¾—æ…¢çš„èŠ‚ç‚¹ç®—å®Œï¼Œå†è¿›è¡Œä¸‹ä¸€è½®è¿­ä»£ã€‚ç±»ä¼¼äºæœ¨æ¡¶æ•ˆåº”ï¼Œä¸€ä¸ªæ‹–æ²¹ç“¶ä¼šä¸¥é‡æ‹–æ…¢è®­ç»ƒè¿›åº¦ï¼Œæ‰€ä»¥åŒæ­¥è®­ç»ƒæ–¹å¼ç›¸å¯¹æ¥è¯´è®­ç»ƒé€Ÿåº¦ä¼šæ…¢ä¸€äº›ã€‚è¿™ä¸ªæ‹–æ²¹ç“¶ä¸€èˆ¬å°±å«åš stragglerã€‚(ç¼ºç‚¹) å¼‚æ­¥è®­ç»ƒä¸­ï¼Œå„ä¸ªè®¾å¤‡å®Œæˆä¸€ä¸ªmini-batchè®­ç»ƒä¹‹åï¼Œä¸éœ€è¦ç­‰å¾…å…¶å®ƒèŠ‚ç‚¹ï¼Œç›´æ¥å»æ›´æ–°æ¨¡å‹çš„å‚æ•°ï¼Œè¿™æ ·æ€»ä½“ä¼šè®­ç»ƒé€Ÿåº¦ä¼šå¿«å¾ˆå¤š å¼‚æ­¥è®­ç»ƒçš„ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜æ˜¯æ¢¯åº¦å¤±æ•ˆé—®é¢˜ï¼ˆstale gradientsï¼‰ï¼Œåˆšå¼€å§‹æ‰€æœ‰è®¾å¤‡é‡‡ç”¨ç›¸åŒçš„å‚æ•°æ¥è®­ç»ƒï¼Œä½†æ˜¯å¼‚æ­¥æƒ…å†µä¸‹ï¼ŒæŸä¸ªè®¾å¤‡å®Œæˆä¸€æ­¥è®­ç»ƒåï¼Œå¯èƒ½å‘ç°æ¨¡å‹å‚æ•°å…¶å®å·²ç»è¢«å…¶å®ƒè®¾å¤‡æ›´æ–°è¿‡äº†ï¼Œæ­¤æ—¶è¿™ä¸ªæ¢¯åº¦å°±è¿‡æœŸäº†ï¼Œå› ä¸ºç°åœ¨çš„æ¨¡å‹å‚æ•°å’Œè®­ç»ƒå‰é‡‡ç”¨çš„å‚æ•°æ˜¯ä¸ä¸€æ ·çš„ã€‚ç”±äºæ¢¯åº¦å¤±æ•ˆé—®é¢˜ï¼Œå¼‚æ­¥è®­ç»ƒè™½ç„¶é€Ÿåº¦å¿«ï¼Œä½†æ˜¯å¯èƒ½é™·å…¥æ¬¡ä¼˜è§£ï¼ˆsub-optimal training performanceï¼‰ã€‚ å…·ä½“å¦‚å›¾æ‰€ç¤º: è¿™ä¸¤ç§æ›´æ–°æ–¹å¼å„æœ‰ä¼˜ç¼ºç‚¹ï¼š å¼‚æ­¥æ›´æ–°å¯èƒ½ä¼šæ›´å¿«é€Ÿåœ°å®Œæˆæ•´ä¸ªæ¢¯åº¦è®¡ç®—ã€‚ åŒæ­¥æ›´æ–° å¯ä»¥æ›´å¿«åœ°è¿›è¡Œä¸€ä¸ªæ”¶æ•›ã€‚ é€‰æ‹©å“ªç§æ–¹å¼å–å†³äºå®é™…çš„åº”ç”¨åœºæ™¯ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:3:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"3 å…·ä½“æ¶æ„ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å‡ ç§å…·ä½“æ¶æ„å®ç°ï¼Œå…ˆç»™å‡ºä¸€ä¸ªæ€»ä½“è¯´æ˜ï¼š åç§° é€šä¿¡ æ¶æ„ å¹¶è¡Œæ€§ MapReduce æ¶ˆæ¯ä¼ é€’ client-server æ‰¹åŒæ­¥ Parameter Server æ¶ˆæ¯ä¼ é€’ client-server å¼‚æ­¥ Decentralized Network æ¶ˆæ¯ä¼ é€’ P2P(Peer to Peer) åŒæ­¥æˆ–å¼‚æ­¥ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:4:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"3.1 MapReduce MapReduceæ˜¯Client-Serveræ¶æ„ã€‚ä»¥ Spark ä¸ºä¾‹çœ‹çœ‹æ˜¯å¦‚ä½•è¿›è¡Œå¹¶è¡ŒåŒ–ï¼š Spark Driver å°±æ˜¯ Serverï¼ŒSpark Executor å°±æ˜¯ Worker èŠ‚ç‚¹ï¼Œæ¯ä¸€ä¸ªæ¢¯åº¦ä¸‹é™è¿‡ç¨‹åŒ…å«ä¸€ä¸ªå¹¿æ’­ã€mapå’Œä¸€ä¸ª reduce æ“ä½œã€‚ Server å®šä¹‰äº† mapæ“ä½œï¼ˆå°±æ˜¯å…·ä½“çš„è®­ç»ƒï¼‰ï¼Œä¹Ÿå¯ä»¥æŠŠä¿¡æ¯å¹¿æ’­åˆ°workerèŠ‚ç‚¹ã€‚ Worker ä¼šæ‰§è¡Œ map æ“ä½œè¿›è¡Œè®­ç»ƒï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæ•°æ®è¢«åˆ†ç»™ worker è¿›è¡Œè®¡ç®—ã€‚ è®¡ç®—ç»“æŸåï¼ŒworkeræŠŠè®¡ç®—ç»“æœä¼ å› driver å¤„ç†ï¼Œè¿™ä¸ªå«åšreduceã€‚ åœ¨ reduce è¿‡ç¨‹ä¸­ï¼ŒServer èŠ‚ç‚¹å¯¹ worker ä¼ æ¥çš„è®¡ç®—ç»“æœè¿›è¡Œèšåˆä¹‹åï¼ŒæŠŠèšåˆç»“æœå¹¿æ’­åˆ°å„ä¸ªworkerèŠ‚ç‚¹ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:4:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"3.2 Parameter Server å‚æ•°æœåŠ¡å™¨ Parameter server ä¹Ÿæ˜¯ä¸€ç§client-serveræ¶æ„ã€‚å’ŒMapReduceä¸åŒåœ¨äº Parameter server å¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼ŒMapReduceåªæœ‰ç­‰æ‰€æœ‰mapéƒ½å®Œæˆäº†æ‰èƒ½åšreduceæ“ä½œã€‚ å‚æ•°æœåŠ¡å™¨æ¶æ„ä¸­ï¼Œè®¡ç®—è®¾å¤‡è¢«åˆ’åˆ†ä¸ºå‚æ•°æœåŠ¡å™¨ï¼ˆPSï¼‰å’Œworkerã€‚ å‚æ•°æœåŠ¡å™¨ï¼ˆserverï¼‰ã€‚æ˜¯ä¸­å¿ƒåŒ–çš„ç»„ä»¶ï¼Œä¸»è¦æ˜¯è´Ÿè´£æ¨¡å‹å‚æ•°çš„å­˜å‚¨ï¼Œå¹³å‡æ¢¯åº¦å’Œäº¤æ¢æ›´æ–°ã€‚å‚æ•°æœåŠ¡å™¨å¯ä»¥æŒ‰ç…§ä¸åŒæ¯”ä¾‹çš„å‚æ•°æœåŠ¡å™¨å’Œå·¥ä½œçº¿ç¨‹è¿›è¡Œé…ç½®ï¼Œæ¯ä¸ªå‚æ•°æœåŠ¡å™¨éƒ½æœ‰ç€ä¸åŒçš„é…ç½®æ•°æ®ã€‚ å·¥ä½œèŠ‚ç‚¹ï¼ˆworkerï¼‰ã€‚æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ä¼šè´Ÿè´£å®ƒé¢†åŸŸå†…çš„æ•°æ®åˆ†ç‰‡æ‰€å¯¹åº”æ¨¡å‹å‚æ•°çš„æ›´æ–°è®¡ç®—ï¼ˆæ¯”å¦‚å‰å‘å’Œåå‘ä¼ æ’­è¿™ç±»è®¡ç®—å¯†é›†çš„è¿ç®—ï¼‰ï¼ŒåŒæ—¶å®ƒä»¬åˆä¼šå‘å‚æ•°æœåŠ¡å™¨å»ä¼ é€’å®ƒæ‰€è®¡ç®—çš„æ¢¯åº¦ï¼Œç”±å‚æ•°æœåŠ¡å™¨æ¥æ±‡æ€»æ‰€æœ‰çš„æ¢¯åº¦ï¼Œå†è¿›ä¸€æ­¥åé¦ˆåˆ°æ‰€æœ‰èŠ‚ç‚¹ã€‚ å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š æ‰€æœ‰çš„å‚æ•°éƒ½å­˜å‚¨åœ¨å‚æ•°æœåŠ¡å™¨ä¸­ï¼Œè€Œ å·¥ä½œèŠ‚ç‚¹ï¼ˆworkerï¼‰ æ˜¯ä¸‡å¹´æ‰“å·¥ä»”ã€‚ å·¥ä½œèŠ‚ç‚¹ ä»¬åªè´Ÿè´£è®¡ç®—æ¢¯åº¦ï¼Œå¾…æ‰€æœ‰è®¡ç®—è®¾å¤‡å®Œæˆæ¢¯åº¦è®¡ç®—ä¹‹åï¼ŒæŠŠè®¡ç®—å¥½çš„æ¢¯åº¦å‘é€ç»™å‚æ•°æœåŠ¡å™¨ï¼Œè¿™æ ·å‚æ•°æœåŠ¡å™¨æ”¶åˆ°æ¢¯åº¦ä¹‹åï¼Œæ‰§è¡Œä¸€å®šçš„è®¡ç®—ï¼ˆæ¢¯åº¦å¹³å‡ç­‰ï¼‰ä¹‹åï¼Œå°±æ›´æ–°å…¶ç»´æŠ¤çš„å‚æ•°ï¼Œåšåˆ°äº†åœ¨èŠ‚ç‚¹ä¹‹é—´å¯¹æ¢¯åº¦è¿›è¡Œå¹³å‡ï¼Œåˆ©ç”¨å¹³å‡æ¢¯åº¦å¯¹æ¨¡å‹è¿›è¡Œæ›´æ–°ã€‚ ç„¶åå‚æ•°æœåŠ¡å™¨å†æŠŠæ›´æ–°å¥½çš„æ–°å‚æ•°è¿”å›ç»™æ‰€æœ‰çš„å·¥ä½œèŠ‚ç‚¹ï¼Œä»¥å¯¹æ¯ä¸ªèŠ‚ç‚¹ä¸­çš„æ¨¡å‹å‰¯æœ¬åº”ç”¨ä¸€è‡´åŒ–æ›´æ–°ã€‚ æ‰“å·¥ä»”ä»¬ä¼šå†è¿›è¡Œä¸‹ä¸€è½®çš„å‰åå‘è®¡ç®—ã€‚ é€»è¾‘å¦‚ä¸‹ï¼š +----------------------------------------------+ | Parameter Server | | | | | | Compute : New P = P + Sum(Delta P ...) | | | | | | Parameter 1, Parameter 2, Parameter 3 ... | | | | | +--+----+----------+--+----------------+--+----+ ^ | ^ | ^ | | | | | | | Delta P | | Delta P| | Delta P| | +-----+ | | | | +------+ | +-----+ | | | | | | New P | | New P +------+ | | | | | | | New P | v | | | | | | v | v +-+-----------+ +-----+--+---+ +-----+--+---+ | Worker | | Worker | | Worker | | | | | | | | | | | ...... | | | Model | | Model | | Model | +------+------+ +------+-----+ +----+-------+ ^ ^ ^ | | | | | | +----+----+ +----+-----+ +--+-----+ | Data 1 | | Data 2 | | Data 3 | +---------+ +----------+ +--------+ å¦‚å›¾: å‚æ•°æœåŠ¡å™¨æ—¢å¯ä»¥ç”¨åœ¨æ•°æ®å¹¶è¡Œä¸Šï¼Œä¹Ÿå¯ä»¥è¢«ç”¨åˆ°æ¨¡å‹å¹¶è¡Œè®­ç»ƒä¸Šã€‚æ¯”å¦‚å¯ä»¥å°†æ¨¡å‹åˆ‡åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼Œå­˜å‚¨åœ¨ä¸åŒçš„PS ServerèŠ‚ç‚¹ä¸Šï¼Œå¹¶æä¾›æ–¹ä¾¿çš„è®¿é—®æœåŠ¡ï¼Œè¿™æ˜¯å‚æ•°æœåŠ¡å™¨çš„æœ¬è´¨ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:4:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"3.3 Decentralized Network Decentralized Network å°±æ˜¯å»ä¸­å¿ƒåŒ–ç½‘ç»œï¼Œå…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š å»ä¸­å¿ƒåŒ–ç½‘ç»œæ²¡æœ‰ä¸€ä¸ªä¸­å¿ƒèŠ‚ç‚¹ï¼Œå±äº Peer-to-Peer æ¶æ„ã€‚ é‡‡ç”¨ message passing è¿›è¡Œé€šä¿¡ï¼Œä¸”èŠ‚ç‚¹åªå’Œé‚»å±…é€šä¿¡ã€‚ å¹¶è¡Œæ–¹å¼å¯ä»¥é‡‡ç”¨å¼‚æ­¥æˆ–è€…åŒæ­¥ã€‚ å»ä¸­å¿ƒåŒ–ç½‘ç»œçš„æ”¶æ•›æƒ…å†µå–å†³äºç½‘ç»œè¿æ¥æƒ…å†µï¼š è¿æ¥è¶Šç´§å¯†ï¼Œæ”¶æ•›æ€§è¶Šå¿«ï¼Œå½“å¼ºè¿æ¥æ—¶å€™ï¼Œæ¨¡å‹å¯ä»¥å¾ˆå¿«æ”¶æ•›ï¼› å¦‚æœä¸æ˜¯å¼ºè¿æ¥ï¼Œå®ƒå¯èƒ½ä¸æ”¶æ•›ï¼› ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:4:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"4 AllReduce å› ä¸ºæœ¬ç³»åˆ—æ˜¯ Horovodï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆè¯´è¯´å‚æ•°æœåŠ¡å™¨çš„åŠ£åŠ¿ï¼Œä¸‹ä¸€ä¸ªç³»åˆ—æˆ‘ä»¬å†è¯´å‚æ•°æœåŠ¡å™¨ä¼˜åŠ¿ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:5:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"4.1 å‚æ•°æœåŠ¡å™¨åŠ£åŠ¿ å°½ç®¡å‚æ•°æœåŠ¡å™¨å¯ä»¥æå‡è¡¨ç°ï¼Œä½†ä»ç„¶é¢ä¸´å‡ ä¸ªé—®é¢˜ï¼š ç¡®å®šå·¥ä½œè€…ä¸å‚æ•°æœåŠ¡å™¨çš„æ­£ç¡®æ¯”ä¾‹ï¼šå¦‚æœä½¿ç”¨ä¸€ä¸ªå‚æ•°æœåŠ¡å™¨ï¼Œå®ƒå¯èƒ½ä¼šæˆä¸ºç½‘ç»œæˆ–è®¡ç®—ç“¶é¢ˆã€‚ å¦‚æœä½¿ç”¨å¤šä¸ªå‚æ•°æœåŠ¡å™¨ï¼Œåˆ™é€šä¿¡æ¨¡å¼å˜ä¸ºâ€œAll-to-Allâ€ï¼Œè¿™å¯èƒ½ä½¿ç½‘ç»œé¥±å’Œã€‚ å¤„ç†ç¨‹åºå¤æ‚æ€§ï¼šå‚æ•°æœåŠ¡å™¨çš„æ¦‚å¿µè¾ƒå¤šï¼Œè¿™é€šå¸¸å¯¼è‡´é™¡å³­çš„å­¦ä¹ æ›²çº¿å’Œå¤§é‡çš„ä»£ç é‡æ„ï¼Œå‹ç¼©äº†å®é™…å»ºæ¨¡çš„æ—¶é—´ã€‚ ç¡¬ä»¶æˆæœ¬ : å‚æ•°æœåŠ¡å™¨çš„å¼•å…¥ä¹Ÿå¢åŠ äº†ç³»ç»Ÿçš„ç¡¬ä»¶æˆæœ¬ã€‚ äººä»¬å‘ç°ï¼ŒMPI_AllReduce è¯­ä¹‰ä¹Ÿå¯ä»¥å¾ˆå¥½åœ°æ»¡è¶³æ•°æ®å¹¶è¡Œè®­ç»ƒè¿™ä¸€éœ€è¦ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šAllReduce æ—¢å¯ä»¥æ˜¯å»ä¸­å¿ƒåŒ–ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸»ä»å¼çš„ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:5:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"4.2 å¹¶è¡Œä»»åŠ¡é€šä¿¡åˆ†ç±» å¹¶è¡Œä»»åŠ¡çš„é€šä¿¡ä¸€èˆ¬å¯ä»¥åˆ†ä¸º Point-to-point communicationå’Œ Collective communicationã€‚ P2P è¿™ç§æ¨¡å¼åªæœ‰ä¸€ä¸ªsenderå’Œä¸€ä¸ªreceiverï¼Œå®ç°èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œæ¯”å¦‚NV GPU Direct P2PæŠ€æœ¯æœåŠ¡äºå•æœºå¤šå¡çš„å•æœºå¡é—´æ•°æ®é€šä¿¡ ã€‚ Collective communicationåŒ…å«å¤šä¸ªsenderå’Œå¤šä¸ªreceiverï¼Œä¸€èˆ¬çš„é€šä¿¡åŸç†åŒ…æ‹¬ broadcastï¼Œgather,all-gatherï¼Œscatterï¼Œreduceï¼Œall-reduceï¼Œreduce-scatterï¼Œall-to-allç­‰ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:5:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"4.3 MPI_AllReduce AllReduce(å¯¹mä¸ªç‹¬ç«‹å‚æ•°è¿›è¡Œè§„çº¦ï¼Œå¹¶å°†è§„çº¦ç»“æœè¿”å›ç»™æ‰€æœ‰è¿›ç¨‹), å…¶å®æ˜¯æœ€æ˜¾ç„¶å’Œç›´æ¥çš„åˆ†å¸ƒå¼æœºå™¨å­¦ä¹ æŠ½è±¡ï¼Œå› ä¸ºå¤§éƒ¨åˆ†ç®—æ³•çš„ç»“æ„éƒ½æ˜¯åˆ†å¸ƒæ•°æ®ã€‚åœ¨æ¯ä¸ªå­é›†ä¸Šé¢ç®—å‡ºä¸€äº›å±€éƒ¨ç»Ÿè®¡é‡ï¼Œç„¶åæ•´åˆå‡ºå…¨å±€ç»Ÿè®¡é‡ï¼Œå¹¶ä¸”å†åˆ†é…ç»™å„ä¸ªèŠ‚ç‚¹å»è¿›è¡Œä¸‹ä¸€è½®çš„è¿­ä»£ï¼Œè¿™æ ·ä¸€ä¸ªè¿‡ç¨‹å°±æ˜¯AllReduceã€‚ å¯ä»¥æŠŠæ¯ä¸ª Worker çœ‹ä½œæ˜¯ MPI æ¦‚å¿µä¸­çš„ä¸€ä¸ªè¿›ç¨‹ï¼Œæ¯”å¦‚å¯ä»¥ç”¨ 4 ä¸ª Worker ç»„æˆäº†ä¸€ä¸ªç»„ï¼Œè¯¥ç»„ç”± 4 ä¸ªè¿›ç¨‹ç»„æˆã€‚æˆ‘ä»¬åœ¨è¿™å››ä¸ªè¿›ç¨‹ä¸­å¯¹æ¢¯åº¦è¿›è¡Œä¸€æ¬¡ MPI_AllReduceã€‚ æ ¹æ® MPI_AllReduce çš„è¯­ä¹‰ï¼Œæ‰€æœ‰å‚ä¸è®¡ç®—çš„è¿›ç¨‹éƒ½æœ‰ç»“æœï¼Œæ‰€ä»¥æ¢¯åº¦å°±å®Œæˆäº†åˆ†å‘ã€‚åªè¦åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯æ¯ä¸ª Worker çš„å‚æ•°æ˜¯ä¸€è‡´çš„ï¼Œé‚£åœ¨åç»­çš„è¿­ä»£è®¡ç®—ä¸­ï¼Œå‚æ•°ä¼šä¸€ç›´ä¿æŒä¸€è‡´ï¼Œå› ä¸ºæ¢¯åº¦ä¿¡æ¯æ˜¯ä¸€è‡´çš„ã€‚ AllReduce è·Ÿ MapReduce æœ‰ç±»ä¼¼ï¼Œä½†åè€…é‡‡ç”¨çš„æ˜¯é¢å‘é€šç”¨ä»»åŠ¡å¤„ç†çš„å¤šé˜¶æ®µæ‰§è¡Œä»»åŠ¡çš„æ–¹å¼ï¼Œè€ŒAllReduceåˆ™è®©ä¸€ä¸ªç¨‹åºåœ¨å¿…è¦çš„æ—¶å€™å é¢†ä¸€å°æœºå™¨ï¼Œå¹¶ä¸”åœ¨æ‰€æœ‰è¿­ä»£çš„æ—¶å€™ä¸€ç›´è·‘åˆ°åº•ï¼Œæ¥é˜²æ­¢é‡æ–°åˆ†é…èµ„æºçš„å¼€é”€ï¼Œè¿™æ›´åŠ é€‚åˆäºæœºå™¨å­¦ä¹ çš„ä»»åŠ¡å¤„ç†ã€‚ æ‰€ä»¥ï¼ŒMPI_AllReduce çš„è¯­ä¹‰å¯ä»¥å¾ˆå¥½åœ°è§£å†³æ·±åº¦å­¦ä¹ ä¸­æ¢¯åº¦åŒæ­¥çš„é—®é¢˜ã€‚ä½†æ˜¯åˆ°åº•èƒ½ä¸èƒ½ä½¿ç”¨å®ƒï¼Œè¿˜æ˜¯è¦çœ‹ä¸‹å±‚çš„å®ç°å¯¹è¿™ä¸€åœºæ™¯æ˜¯å¦è¶³å¤Ÿå‹å¥½ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:5:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"5 ring-allreduce ç™¾åº¦æå‡ºä½¿ç”¨æ–°ç®—æ³•æ¥å¹³å‡æ¢¯åº¦ï¼Œå–æ¶ˆ Reducerï¼Œå¹¶è®©è¿™äº›æ¢¯åº¦åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¹‹é—´äº¤æµï¼Œè¿™è¢«ç§°ä¸º ring-allreduceï¼Œä»–ä»¬ä½¿ç”¨ TensorFlow ä¹Ÿå®ç°äº†è¿™ç§ç®—æ³•ï¼ˆhttps://github.com/baidu-research/tensorflow-allreduceï¼‰ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:6:0","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"5.1 ç‰¹ç‚¹ Ring-Allreduceç‰¹ç‚¹å¦‚ä¸‹ï¼š Ring Allreduce ç®—æ³•ä½¿ç”¨å®šä¹‰è‰¯å¥½çš„æˆå¯¹æ¶ˆæ¯ä¼ é€’æ­¥éª¤åºåˆ—åœ¨ä¸€ç»„è¿›ç¨‹ä¹‹é—´åŒæ­¥çŠ¶æ€ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸ºå¼ é‡ï¼‰ã€‚ Ring-Allreduce çš„å‘½åä¸­ Ring æ„å‘³ç€è®¾å¤‡ä¹‹é—´çš„æ‹“æ‰‘ç»“æ„ä¸ºä¸€ä¸ªé€»è¾‘ç¯å½¢ï¼Œæ¯ä¸ªè®¾å¤‡éƒ½åº”è¯¥æœ‰ä¸€ä¸ªå·¦é‚»å’Œä¸€ä¸ªå³é‚»å±…ï¼Œä¸”æœ¬è®¾å¤‡åªä¼šå‘å®ƒå³é‚»å±…å‘é€æ•°æ®ï¼Œå¹¶ä¸”ä»å®ƒçš„å·¦é‚»å±…æ¥å—æ•°æ®ã€‚ Ring-Allreduce çš„å‘½åä¸­çš„ Allreduce åˆ™ä»£è¡¨ç€æ²¡æœ‰ä¸­å¿ƒèŠ‚ç‚¹ï¼Œæ¶æ„ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯æ¢¯åº¦çš„æ±‡æ€»è®¡ç®—èŠ‚ç‚¹ã€‚ æ­¤ç§ç®—æ³•å„ä¸ªèŠ‚ç‚¹ä¹‹é—´åªä¸ç›¸é‚»çš„ä¸¤ä¸ªèŠ‚ç‚¹é€šä¿¡ï¼Œå¹¶ä¸éœ€è¦å‚æ•°æœåŠ¡å™¨ã€‚å› æ­¤ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½å‚ä¸è®¡ç®—ä¹Ÿå‚ä¸å­˜å‚¨ï¼Œä¹Ÿé¿å…äº§ç”Ÿä¸­å¿ƒåŒ–çš„é€šä¿¡ç“¶é¢ˆã€‚ ç›¸æ¯”PSæ¶æ„ï¼ŒRing-Allreduce æ¶æ„æ˜¯å¸¦å®½ä¼˜åŒ–çš„ï¼Œå› ä¸ºé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å¸¦å®½éƒ½è¢«å……åˆ†åˆ©ç”¨ã€‚ åœ¨ ring-allreduce ç®—æ³•ä¸­ï¼Œæ¯ä¸ª N èŠ‚ç‚¹ä¸å…¶ä»–ä¸¤ä¸ªèŠ‚ç‚¹è¿›è¡Œ 2 * (N-1) æ¬¡é€šä¿¡ã€‚åœ¨è¿™ä¸ªé€šä¿¡è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹å‘é€å¹¶æ¥æ”¶æ•°æ®ç¼“å†²åŒºä¼ æ¥çš„å—ã€‚åœ¨ç¬¬ä¸€ä¸ªN-1è¿­ä»£ä¸­ï¼Œæ¥æ”¶çš„å€¼è¢«æ·»åŠ åˆ°èŠ‚ç‚¹ç¼“å†²åŒºä¸­çš„å€¼ã€‚åœ¨ç¬¬äºŒä¸ªN-1è¿­ä»£ä¸­ï¼Œæ¥æ”¶çš„å€¼ä»£æ›¿èŠ‚ç‚¹ç¼“å†²åŒºä¸­ä¿å­˜çš„å€¼ã€‚ç™¾åº¦çš„æ–‡ç« è¯æ˜äº†è¿™ç§ç®—æ³•æ˜¯å¸¦å®½ä¸Šæœ€ä¼˜çš„ï¼Œè¿™æ„å‘³ç€å¦‚æœç¼“å†²åŒºè¶³å¤Ÿå¤§ï¼Œå®ƒå°†æœ€å¤§åŒ–åœ°åˆ©ç”¨å¯ç”¨çš„ç½‘ç»œã€‚ åœ¨æ·±åº¦å­¦ä¹ è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®¡ç®—æ¢¯åº¦é‡‡ç”¨BPç®—æ³•ï¼Œå…¶ç‰¹ç‚¹æ˜¯åé¢å±‚çš„æ¢¯åº¦å…ˆè¢«è®¡ç®—ï¼Œè€Œå‰é¢å±‚çš„æ¢¯åº¦æ…¢äºåé¢å±‚ï¼ŒRing-allreduceæ¶æ„å¯ä»¥å……åˆ†åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ï¼Œåœ¨å‰é¢å±‚æ¢¯åº¦è®¡ç®—çš„åŒæ—¶è¿›è¡Œåé¢å±‚æ¢¯åº¦çš„ä¼ é€’ï¼Œä»è€Œè¿›ä¸€æ­¥å‡å°‘è®­ç»ƒæ—¶é—´ã€‚ Ringæ¶æ„ä¸‹çš„åŒæ­¥ç®—æ³•å°†å‚æ•°åœ¨é€šä¿¡ç¯ä¸­ä¾æ¬¡ä¼ é€’ï¼Œå¾€å¾€éœ€è¦å¤šæ­¥æ‰èƒ½å®Œæˆä¸€æ¬¡å‚æ•°åŒæ­¥ã€‚åœ¨å¤§è§„æ¨¡è®­ç»ƒæ—¶ä¼šå¼•å…¥å¾ˆå¤§çš„é€šä¿¡å¼€é”€ï¼Œå¹¶ä¸”å¯¹å°å°ºå¯¸å¼ é‡ï¼ˆtensorï¼‰ä¸å¤Ÿå‹å¥½ã€‚å¯¹äºå°å°ºå¯¸å¼ é‡ï¼Œå¯ä»¥é‡‡ç”¨æ‰¹é‡æ“ä½œï¼ˆbatchï¼‰çš„æ–¹æ³•æ¥å‡å°é€šä¿¡å¼€é”€ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼ŒRing-based AllReduce æ¶æ„çš„ç½‘ç»œé€šè®¯é‡å¦‚æœå¤„ç†é€‚å½“ï¼Œä¸ä¼šéšç€æœºå™¨å¢åŠ è€Œå¢åŠ ï¼Œè€Œä»…ä»…å’Œæ¨¡å‹ \u0026 ç½‘ç»œå¸¦å®½æœ‰å…³ï¼Œè¿™é’ˆå¯¹å‚æ•°æœåŠ¡å™¨æ˜¯ä¸ªå·¨å¤§çš„æå‡ã€‚ ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:6:1","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"5.2 ç­–ç•¥ Ring-based AllReduce ç­–ç•¥åŒ…æ‹¬ Scatter-Reduce å’Œ AllGather ä¸¤ä¸ªé˜¶æ®µã€‚ é¦–å…ˆæ˜¯scatter-reduceï¼Œscatter-reduce ä¼šé€æ­¥äº¤æ¢å½¼æ­¤çš„æ¢¯åº¦å¹¶èåˆï¼Œæœ€åæ¯ä¸ª GPU éƒ½ä¼šåŒ…å«å®Œæ•´èåˆæ¢¯åº¦çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯æœ€ç»ˆç»“æœçš„ä¸€ä¸ªå—ã€‚ å‡è®¾ç¯ä¸­æœ‰ N ä¸ª workerï¼Œæ¯ä¸ª worker æœ‰é•¿åº¦ç›¸åŒçš„æ•°ç»„ï¼Œéœ€è¦å°† worker çš„æ•°ç»„è¿›è¡Œæ±‚å’Œã€‚åœ¨ Scatter-Reduce é˜¶æ®µï¼Œæ¯ä¸ª worker ä¼šå°†æ•°ç»„åˆ†æˆ N ä»½æ•°æ®å—ï¼Œç„¶å worker ä¹‹é—´è¿›è¡Œ N æ¬¡æ•°æ®äº¤æ¢ã€‚åœ¨ç¬¬ k æ¬¡æ•°æ®äº¤æ¢æ—¶ï¼Œç¬¬ i ä¸ª worker ä¼šå°†è‡ªå·±çš„ (i - k) % N ä»½æ•°æ®å—å‘é€ç»™ä¸‹ä¸€ä¸ª workerã€‚æ¥æ”¶åˆ°ä¸Šä¸€ä¸ª worker çš„æ•°æ®å—åï¼Œworker ä¼šå°†å…¶ä¸è‡ªå·±å¯¹åº”çš„æ•°æ®å—æ±‚å’Œã€‚ ç„¶åæ˜¯allgatherã€‚GPU ä¼šé€æ­¥äº¤æ¢å½¼æ­¤ä¸å®Œæ•´çš„èåˆæ¢¯åº¦ï¼Œæœ€åæ‰€æœ‰ GPU éƒ½ä¼šå¾—åˆ°å®Œæ•´çš„æœ€ç»ˆèåˆæ¢¯åº¦ã€‚ åœ¨æ‰§è¡Œå®Œ Scatter-Reduce åï¼Œæ¯ä¸ª worker çš„æ•°ç»„é‡Œéƒ½æœ‰æŸä¸ªæ•°æ®å—æ˜¯æœ€ç»ˆæ±‚å’Œçš„ç»“æœï¼Œç°åœ¨éœ€è¦å°†å„æ•°æ®å—çš„æœ€åæ±‚å’Œç»“æœå‘é€åˆ°æ¯ä¸ª worker ä¸Šã€‚å’Œ Scatter-Reduce ä¸€æ ·ï¼Œä¹Ÿéœ€è¦ N æ¬¡å¾ªç¯ã€‚åœ¨ç¬¬ k æ¬¡å¾ªç¯æ—¶ï¼Œç¬¬ i ä¸ª worker ä¼šå°†å…¶ç¬¬ (i+1-k)%N ä¸ªæ•°æ®å—å‘é€ç»™ä¸‹ä¸€ä¸ª worker ã€‚æ¥æ”¶åˆ°å‰ä¸€ä¸ª worker çš„æ•°æ®å—åï¼Œworker ä¼šç”¨æ¥æ”¶çš„æ•°æ®å¿«è¦†ç›–è‡ªå·±å¯¹åº”çš„æ•°æ®å—ã€‚è¿›è¡Œ N æ¬¡å¾ªç¯åï¼Œæ¯ä¸ª worker å°±æ‹¥æœ‰äº†æ•°ç»„å„æ•°æ®å—çš„æœ€ç»ˆæ±‚å’Œç»“æœäº†ã€‚ ä»¥ä¸‹éƒ¨åˆ†æ¥è‡ª https://andrew.gibiansky.com/blog/machine-learning/baidu-allreduce/ï¼Œè¿™æ˜¯æˆ‘èƒ½æ‰¾åˆ°æœ€ä¼˜ç§€çš„è§£è¯»ã€‚ 5.2.1 ç»“æ„ ç¯å½¢ç»“æ„å¦‚ä¸‹ï¼Œæ¯ä¸ª GPU åº”è¯¥æœ‰ä¸€ä¸ªå·¦é‚»å±…å’Œä¸€ä¸ªå³é‚»å±…ï¼›å®ƒåªä¼šå‘å…¶å³ä¾§é‚»å±…å‘é€æ•°æ®ï¼Œå¹¶ä»å…¶å·¦ä¾§é‚»å±…æ¥æ”¶æ•°æ®ã€‚ 5.2.2 scatter reduce scatter-reduceï¼šä¼šé€æ­¥äº¤æ¢å½¼æ­¤çš„æ¢¯åº¦å¹¶èåˆï¼Œæœ€åæ¯ä¸ª GPU éƒ½ä¼šåŒ…å«å®Œæ•´èåˆæ¢¯åº¦çš„ä¸€éƒ¨åˆ†ã€‚ ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾ç›®æ ‡æ˜¯æŒ‰å…ƒç´ å¯¹å•ä¸ªå¤§å‹æµ®ç‚¹æ•°æ•°ç»„çš„æ‰€æœ‰å…ƒç´ æ±‚å’Œï¼›ç³»ç»Ÿä¸­æœ‰ N ä¸ª GPUï¼Œæ¯ä¸ª GPU éƒ½æœ‰ä¸€ä¸ªç›¸åŒå¤§å°çš„æ•°ç»„ï¼Œåœ¨ allreduce çš„æœ€åç¯èŠ‚ï¼Œæ¯ä¸ª GPU éƒ½åº”è¯¥æœ‰ä¸€ä¸ªç›¸åŒå¤§å°çš„æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«åŸå§‹æ•°ç»„ä¸­æ•°å­—çš„æ€»å’Œã€‚ 5.2.2.1 åˆ†å— é¦–å…ˆï¼ŒGPU å°†é˜µåˆ—åˆ’åˆ†ä¸º N ä¸ªè¾ƒå°çš„å—ï¼ˆå…¶ä¸­ N æ˜¯ç¯ä¸­çš„ GPU æ•°é‡ï¼‰ã€‚ æ¥ä¸‹æ¥ï¼ŒGPU å°†è¿›è¡Œ N-1 æ¬¡ scatter-reduce è¿­ä»£ã€‚ åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼ŒGPU ä¼šå°†å…¶ä¸€ä¸ªå—å‘é€åˆ°å…¶å³é‚»å±…ï¼Œå¹¶å°†ä»å…¶å·¦é‚»å±…æ¥æ”¶ä¸€ä¸ªå—å¹¶ç´¯ç§¯åˆ°è¯¥å—ä¸­ã€‚æ¯ä¸ª GPU å‘é€å’Œæ¥æ”¶çš„æ•°æ®å—æ¯æ¬¡è¿­ä»£éƒ½ä¸åŒã€‚ç¬¬ n ä¸ª GPU é€šè¿‡å‘é€å— n å’Œæ¥æ”¶å— n â€“ 1 å¼€å§‹ï¼Œç„¶åé€æ­¥å‘åè¿›è¡Œï¼Œæ¯æ¬¡è¿­ä»£å‘é€å®ƒåœ¨å‰ä¸€æ¬¡è¿­ä»£ä¸­æ¥æ”¶åˆ°çš„å—ã€‚ 5.2.2.2 ç¬¬ä¸€æ¬¡è¿­ä»£ åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œä¸Šå›¾ä¸­çš„äº”ä¸ª GPU å°†å‘é€å’Œæ¥æ”¶ä»¥ä¸‹å—ï¼š GPU å‘é€ æ¥æ”¶ 0 å—0 å—4 1 å—1 å—0 2 å—2 å—1 3 å—3 å—2 4 å—4 å—3 scatter-reduce çš„ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­çš„æ•°æ®ä¼ è¾“å¦‚ä¸‹ï¼š ç¬¬ä¸€æ¬¡å‘é€å’Œæ¥æ”¶å®Œæˆåï¼Œæ¯ä¸ª GPU éƒ½ä¼šæœ‰ä¸€ä¸ªå—ï¼Œè¯¥å—ç”±ä¸¤ä¸ªä¸åŒ GPU ä¸Šç›¸åŒå—çš„æ€»å’Œç»„æˆã€‚ä¾‹å¦‚ï¼Œç¬¬äºŒä¸ª GPU ä¸Šçš„ç¬¬ä¸€ä¸ªå—å°†æ˜¯è¯¥å—ä¸­æ¥è‡ªç¬¬äºŒä¸ª GPU å’Œç¬¬ä¸€ä¸ª GPU çš„å€¼çš„æ€»å’Œã€‚ 5.2.2.2 å…¨éƒ¨è¿­ä»£ åœ¨åç»­è¿­ä»£ä¸­ï¼Œè¯¥è¿‡ç¨‹ç»§ç»­ç›´åˆ°æœ€åã€‚æœ€ç»ˆæ¯ä¸ª GPU å°†æœ‰ä¸€ä¸ªå—ï¼Œè¿™ä¸ªå—åŒ…å«æ‰€æœ‰ GPU ä¸­è¯¥å—ä¸­æ‰€æœ‰å€¼çš„æ€»å’Œã€‚ ä¸‹é¢ç³»åˆ—å›¾å±•ç¤ºäº†æ‰€æœ‰æ•°æ®ä¼ è¾“å’Œä¸­é—´ç»“æœï¼Œä»ç¬¬ä¸€æ¬¡è¿­ä»£å¼€å§‹ï¼Œä¸€ç›´æŒç»­åˆ°scatter-reduceå®Œæˆã€‚ iter 1ï¼š iter2ï¼š iter3ï¼š iter4ï¼š æ‰€æœ‰ scatter-reduce ä¼ è¾“åçš„æœ€ç»ˆçŠ¶æ€ 5.2.3 Allgather åœ¨ scatter-reduce æ­¥éª¤å®Œæˆåï¼Œåœ¨æ¯ä¸ª GPU çš„æ•°ç»„ä¸­éƒ½æœ‰æŸä¸€äº›å€¼ï¼ˆæ¯ä¸ª GPU æœ‰ä¸€ä¸ªå—ï¼‰æ˜¯æœ€ç»ˆå€¼ï¼Œå…¶ä¸­åŒ…æ‹¬æ¥è‡ªæ‰€æœ‰ GPU çš„è´¡çŒ®ã€‚ä¸ºäº†å®Œæˆ allreduceï¼ŒGPU å¿…é¡»æ¥ä¸‹æ¥äº¤æ¢è¿™äº›å—ï¼Œä»¥ä¾¿æ‰€æœ‰ GPU éƒ½å…·æœ‰æœ€ç»ˆæ‰€éœ€çš„å€¼ã€‚ ring allgather ä¸ scatter-reduce è¿›è¡Œç›¸åŒçš„å¤„ç†ï¼ˆå‘é€å’Œæ¥æ”¶çš„ N-1 æ¬¡è¿­ä»£ï¼‰ï¼Œä½†æ˜¯ä»–ä»¬è¿™æ¬¡ä¸æ˜¯ç´¯ç§¯ GPU æ¥æ”¶çš„å€¼ï¼Œè€Œåªæ˜¯ç®€å•åœ°è¦†ç›–å—ã€‚ç¬¬ n ä¸ª GPU å¼€å§‹å‘é€ç¬¬ n+1 ä¸ªå—å¹¶æ¥æ”¶ç¬¬ n ä¸ªå—ï¼Œç„¶ååœ¨ä»¥åçš„è¿­ä»£ä¸­å§‹ç»ˆå‘é€å®ƒåˆšåˆšæ¥æ”¶åˆ°çš„å—ã€‚ 5.2.3.1 ç¬¬ä¸€æ¬¡è¿­ä»£ ä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„ 5-GPU è®¾ç½®çš„ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­ï¼ŒGPU å°†å‘é€å’Œæ¥æ”¶ä»¥ä¸‹å—ï¼š GPU å‘é€ æ¥æ”¶ 0 å—1 å—0 1 å—2 å—1 2 å—3 å—2 3 å—4 å—3 4 å—0 å—4 allgather çš„ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­çš„æ•°æ®ä¼ è¾“å¦‚ä¸‹ã€‚ ç¬¬ä¸€æ¬¡è¿­ä»£å®Œæˆåï¼Œæ¯ä¸ª GPU éƒ½ä¼šæœ‰æœ€ç»ˆæ•°ç»„çš„ä¸¤ä¸ªå—ã€‚åœ¨æ¥ä¸‹æ¥çš„è¿­ä»£ä¸­ï¼Œè¯¥è¿‡ç¨‹ç»§ç»­ä¸€ç›´åˆ°æœ€åï¼Œæœ€ç»ˆæ¯ä¸ª GPU å°†æ‹¥æœ‰æ•´ä¸ªæ•°ç»„çš„å®Œå…¨ç´¯åŠ å€¼ã€‚ 5.2.3.2 å…¨éƒ¨è¿­ä»£ ä¸‹é¢ç³»åˆ—å›¾å±•ç¤ºäº†æ‰€æœ‰æ•°æ®ä¼ è¾“å’Œä¸­é—´ç»“æœï¼Œä»ç¬¬ä¸€æ¬¡è¿­ä»£å¼€å§‹ï¼Œä¸€ç›´æŒç»­åˆ°å…¨éƒ¨æ”¶é›†å®Œæˆã€‚ Allgather æ•°æ®ä¼ è¾“ï¼ˆè¿­ä»£ 1ï¼‰ Allgather æ•°æ®ä¼ è¾“ï¼ˆè¿­ä»£ 2ï¼‰å¦‚ä¸‹ï¼š Allgather æ•°æ®ä¼ è¾“ï¼ˆè¿­ä»£ 3ï¼‰ï¼š Allgather æ•°æ®ä¼ è¾“ï¼ˆè¿­ä»£ 4ï¼‰ï¼š æ‰€æœ‰å…¨éƒ¨è½¬ç§»åçš„æœ€ç»ˆçŠ¶æ€ã€‚ 5.2.4 Horovod æ¶æ„å›¾ å·¥ä½œåŸç†ä¹Ÿå¯ä»¥å€ŸåŠ©Horovodçš„å‘å¸ƒå¸–å­ æ¥çœ‹çœ‹ã€‚ 5.2.5 ç™¾åº¦æ€è·¯ æˆ–è€…æˆ‘ä»¬ä»ç™¾åº¦çš„æºç ä¸­ä¹Ÿå¯ä»¥ç›´æ¥çœ‹åˆ°æ€è·¯ï¼Œç°åœ¨æ‘˜å½•ç»™å¤§å®¶ã€‚ å…·ä½“ä»£ç å‚è§ https://github.com/baidu-research/tensorflow-allreduce/commit/66d5b855e90b0949e9fa5cca5599fd729a70e874#diff-3d530d590e551619acd776cfe7eaff06R517 /* Perform a ring allreduce on the data. Allocate the necessary output tensor and * store it in the output parameter. * * Assumes that all MPI processes are doing an allreduce of the same tensor, * with the same dimensions. * * A ring allreduce is a bandwidth-optimal way to do an allreduce. To do the allreduce, * the nodes involved are arranged in a ring: * * .--0--. * / \\ * 3 1 * \\ / * *--2--* * * Each node always sends to the next clockwise node in the ring, and receives * from the previous one. * * The allreduce is done in two parts: a scatter-reduce and an allgather. In * the scatter reduce, a reduction is done, so that each node ends up with a * chunk of the final output tensor which has contributions from all other * nodes. In the allgather, those chunks are distributed among all the nodes, * so that all nodes have the entire output tensor. * * Both of these operations are done by dividing the input tensor into N * evenly sized chunks (where N is the number of nodes in the ring). * * The scatter-reduce is done in N-1 steps. In the ith step, node j will send * the (j - i)th chunk and receive the (j - i - 1)th chunk, adding it in to * its existing data for that chunk. For example, in the first iteration with * the ring depicted above, you will have the following transfers: * * Segment 0: Node 0 --\u003e Node 1 * Segment 1: Node 1 --\u003e Node 2 * Segment 2: Node 2 --\u003e Node 3 * Segment 3: Node 3 --\u003e Node 0 * * In the second iteration, you'll have ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:6:2","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Distributed Computing"],"content":"5.3 åŒºåˆ« åœ¨ä¸­ç­‰è§„æ¨¡æ¨¡å‹æƒ…å†µä¸‹ï¼Œall-reduce æ›´é€‚åˆã€‚å½“è§„æ¨¡å·¨å¤§æ—¶å€™åˆ™åº”è¯¥ä½¿ç”¨å‚æ•°æœåŠ¡å™¨ã€‚ å‚æ•°æœåŠ¡å™¨ é€‚åˆçš„æ˜¯é«˜ç»´ç¨€ç–æ¨¡å‹è®­ç»ƒï¼Œå®ƒåˆ©ç”¨çš„æ˜¯ç»´åº¦ç¨€ç–çš„ç‰¹ç‚¹ï¼Œæ¯æ¬¡ pull or push åªæ›´æ–°æœ‰æ•ˆçš„å€¼ã€‚ä½†æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹æ˜¯å…¸å‹çš„denseåœºæ™¯ï¼Œembeddingåšçš„å°±æ˜¯æŠŠç¨€ç–å˜æˆç¨ å¯†ã€‚æ‰€ä»¥è¿™ç§ pull or push çš„ä¸å¤ªé€‚åˆã€‚è€Œ ç½‘ç»œé€šä¿¡ä¸Šæ›´ä¼˜åŒ–çš„ all-reduce é€‚åˆä¸­ç­‰è§„æ¨¡çš„æ·±åº¦å­¦ä¹ ã€‚ åˆæ¯”å¦‚ç”±äºæ¨èæœç´¢é¢†åŸŸæ¨¡å‹çš„ Embedding å±‚è§„æ¨¡åºå¤§ä»¥åŠè®­ç»ƒæ•°æ®æ ·æœ¬é•¿åº¦ä¸å›ºå®šç­‰åŸå› ï¼Œå¯¼è‡´å®¹æ˜“å‡ºç°æ˜¾å­˜ä¸è¶³å’Œå¡é—´åŒæ­¥æ—¶é—´è€—è´¹ç­‰é—®é¢˜ï¼Œæ‰€ä»¥ all-reduce æ¶æ„å¾ˆå°‘è¢«ç”¨äºæœç´¢æ¨èé¢†åŸŸã€‚ è‡³æ­¤ï¼ŒèƒŒæ™¯çŸ¥è¯†å·²ç»ä»‹ç»å®Œæ¯•ï¼Œä¸‹ä¸€ç¯‡æˆ‘ä»¬å¼€å§‹ä»‹ç» Horovod çš„ä½¿ç”¨ã€‚ reference: [1] https://www.cnblogs.com/rossiXYZ/p/14856464.html ","date":"2023-07-10","objectID":"/posts/2022-10-08_horovod_1/:6:3","tags":["Horovod"],"title":"æ·±åº¦å­¦ä¹ åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ Horovod[1] -- åŸºç¡€çŸ¥è¯†","uri":"/posts/2022-10-08_horovod_1/"},{"categories":["Memo"],"content":" quote tips for hugo installation and new site creation. Commands for creating sites backend with hugo create a new markdown file hugo new posts/tech/name-of-file.md hugo new content/posts/tech/name-of-file.md create new site hugo new site name Install hugo Linux wget https://github.com/gohugoio/hugo/releases/download/v0.83.1/hugo_0.83.1_Linux-64bit.tar.gz tar -xf hugo_0.83.1_Linux-64bit.tar.gz sudo mv hugo /usr/local/bin/ hugo version ","date":"2023-07-09","objectID":"/posts/hugo_command/:0:0","tags":["hugo"],"title":"Hugo_command","uri":"/posts/hugo_command/"},{"categories":["Node.js","JavaScript"],"content":"æœ€è¿‘åœ¨å†™ä¸€ä¸ª Vue æ’ä»¶ï¼Œéœ€è¦åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€äº›æµ‹è¯•é¡µé¢ï¼Œç”±äºéƒ½æ˜¯äº›é™æ€è·¯ç”±ï¼Œå°±æƒ³åˆ°ä¹‹å‰çœ‹åˆ°è¿‡çš„ä¸€ä¸ªé¡¹ç›®å°±æ˜¯ç”¨ Node.js æ¥è‡ªåŠ¨ç”Ÿæˆè·¯ç”±çš„ï¼Œäºæ˜¯å°±å€Ÿé‰´è¿‡æ¥æ”¹äº†ä¸€ä¸‹ã€‚ ","date":"2023-06-14","objectID":"/posts/gen-router/:0:0","tags":["Node.js","JavaScript","Vue"],"title":"ä½¿ç”¨ Node.js è‡ªåŠ¨åˆ›å»º Vue çš„è·¯ç”±","uri":"/posts/gen-router/"},{"categories":["Node.js","JavaScript"],"content":"æºç  const fs = require('fs') const os = require('os') const vueDir = './src/views/' const routerFile = './src/router.js' fs.readdir(vueDir, function (err, files) { if (err) { console.error('âŒ Could not list the directory.', err) return } const routes = [] for (const filename of files) { if (filename.indexOf('.') \u003c 0) { continue } const [name, ext] = filename.split('.') if (ext !== 'vue') { continue } const routeName = name.replace(/-([a-z])/g, (_, match) =\u003e match.toUpperCase()) let routeDescription = '' const contentFull = fs.readFileSync(`${vueDir}${filename}`, 'utf-8') // get route description from first line comment const match = /\u003c!--\\s*(.*)\\s*--\u003e/g.exec(contentFull.split(os.EOL)[0]) if (match) { routeDescription = match[1].trim() } routes.push(` { path: '/${name === 'home' ? '' : name}', name: '${routeName}',${routeDescription ? `\\n description: '${routeDescription}',` : ''} component: () =\u003e import(/* webpackChunkName: \"${routeName}\" */ '@/views/${filename}'), },`) } const result = `// This file is automatically generated by gen-router.js, please do not modify it manuallyï¼ import VueRouter from 'vue-router' import Vue from 'vue' Vue.use(VueRouter) const routes = [ ${routes.join(os.EOL)} ] const router = new VueRouter({ mode: 'hash', routes, }) export default router ` fs.writeFile(routerFile, result, 'utf-8', (err) =\u003e { if (err) throw err console.log(`âœ… Router generated successfully in ${routerFile}`) }) }) ç”Ÿæˆæ•ˆæœå¦‚ä¸‹ï¼š // This file is automatically generated by gen-router.js, please do not modify it manuallyï¼ import VueRouter from 'vue-router' import Vue from 'vue' Vue.use(VueRouter) const routes = [ { path: '/', name: 'home', description: 'Home', component: () =\u003e import(/* webpackChunkName: \"home\" */ '@/views/home.vue'), }, ] const router = new VueRouter({ mode: 'hash', routes, }) export default router ","date":"2023-06-14","objectID":"/posts/gen-router/:1:0","tags":["Node.js","JavaScript","Vue"],"title":"ä½¿ç”¨ Node.js è‡ªåŠ¨åˆ›å»º Vue çš„è·¯ç”±","uri":"/posts/gen-router/"},{"categories":["Node.js","JavaScript"],"content":"å‚è€ƒ sunzsh/vue-el-demo ","date":"2023-06-14","objectID":"/posts/gen-router/:2:0","tags":["Node.js","JavaScript","Vue"],"title":"ä½¿ç”¨ Node.js è‡ªåŠ¨åˆ›å»º Vue çš„è·¯ç”±","uri":"/posts/gen-router/"},{"categories":["Git"],"content":"é—®é¢˜æè¿° åœ¨ä½¿ç”¨ SourceTree æäº¤ä»£ç çš„æ—¶å€™ï¼Œä¼šå‡ºç° husky å‘½ä»¤å¤±è´¥çš„é—®é¢˜ï¼ˆé€šè¿‡å‘½ä»¤è¡Œæäº¤ä»£ç æ²¡æœ‰é—®é¢˜ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š çœ‹é”™è¯¯ï¼Œæ˜¯ä¸€ä¸ª catch å‚æ•°çš„é—®é¢˜ï¼Œåœ¨æ–°ç‰ˆæœ¬çš„ Node ä¸­ï¼Œcatch å‚æ•°æ˜¯å¯ä»¥çœç•¥çš„ï¼Œä½†æ˜¯åœ¨æ—§ç‰ˆæœ¬ä¸­ï¼Œcatch å‚æ•°æ˜¯å¿…é¡»çš„ã€‚ ç”±äºä½¿ç”¨äº† nvm ç®¡ç† Node ç‰ˆæœ¬ï¼Œé¡¹ç›®ä¸­çš„ Node æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯ SourceTree ä½¿ç”¨çš„æ˜¯ç³»ç»Ÿçš„ Nodeï¼Œæ‰€ä»¥ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚ ","date":"2023-06-12","objectID":"/posts/sourcetree-husky/:1:0","tags":["Git","husky","Mac"],"title":"è§£å†³ SourceTree æäº¤æ—¶å€™ husky å‘½ä»¤å¤±è´¥é—®é¢˜","uri":"/posts/sourcetree-husky/"},{"categories":["Git"],"content":"è§£å†³æ–¹æ¡ˆ çŸ¥é“äº†é—®é¢˜çš„åŸå› ï¼Œè§£å†³èµ·æ¥å°±å¾ˆç®€å•äº†ï¼Œåªéœ€è¦å°† SourceTree husky hook é˜¶æ®µçš„ Node ç‰ˆæœ¬åˆ‡æ¢åˆ°é¡¹ç›®ä¸­çš„ Node ç‰ˆæœ¬å³å¯ã€‚ é…ç½® .huskyrc æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š echo \"export PATH=\\\"$(dirname $(which node)):\\$PATH\\\"\" \u003e ~/.huskyrc å¦‚æœä½ ä½¿ç”¨äº† zsh å’Œ nvm, å»ºè®®åœ¨ $ZSH_CUSTOM ç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰ zsh è„šæœ¬ã€‚ è¿™ä¸ªè„šæœ¬ä¼šåœ¨ä½ è¿›å…¥åŒ…å«äº† .nvmrc æ–‡ä»¶ç›®å½•ä¸­è‡ªåŠ¨åˆ‡æ¢ node ç‰ˆæœ¬ï¼Œåˆ‡æ¢ç‰ˆæœ¬åä¿®æ­£ ~/.huskyrc çš„ path å†…å®¹ã€‚ vim $ZSH_CUSTOM/nvm_custom.zsh # https://github.com/nvm-sh/nvm#manual-install export NVM_DIR=\"$HOME/.nvm\" [ -s \"$NVM_DIR/nvm.sh\" ] \u0026\u0026 \\. \"$NVM_DIR/nvm.sh\" # This loads nvm [ -s \"$NVM_DIR/bash_completion\" ] \u0026\u0026 \\. \"$NVM_DIR/bash_completion\" # This loads nvm bash_completion # https://github.com/nvm-sh/nvm#deeper-shell-integration autoload -U add-zsh-hook load-nvmrc() { local node_version=\"$(nvm version)\" local nvmrc_path=\"$(nvm_find_nvmrc)\" if [ -n \"$nvmrc_path\" ]; then local nvmrc_node_version=$(nvm version \"$(cat \"${nvmrc_path}\")\") if [ \"$nvmrc_node_version\" = \"N/A\" ]; then nvm install elif [ \"$nvmrc_node_version\" != \"$node_version\" ]; then nvm use fi elif [ \"$node_version\" != \"$(nvm version default)\" ]; then echo \"Reverting to nvm default version\" nvm use default fi # fix husky hook # ref: https://github.com/typicode/husky/issues/390#issuecomment-762213421 echo \"export PATH=\\\"$(dirname $(which node)):\\$PATH\\\"\" \u003e ~/.huskyrc } add-zsh-hook chpwd load-nvmrc load-nvmrc # https://github.com/nvm-sh/nvm#use-a-mirror-of-node-binaries export NVM_NODEJS_ORG_MIRROR=https://mirrors.ustc.edu.cn/node/ ","date":"2023-06-12","objectID":"/posts/sourcetree-husky/:2:0","tags":["Git","husky","Mac"],"title":"è§£å†³ SourceTree æäº¤æ—¶å€™ husky å‘½ä»¤å¤±è´¥é—®é¢˜","uri":"/posts/sourcetree-husky/"},{"categories":["Git"],"content":"å‚è€ƒ https://wxhboy.cn/2022/04/12/è§£å†³SourceTreeæäº¤æ—¶å€™huskyå‘½ä»¤å¤±è´¥é—®é¢˜/ https://github.com/typicode/husky/issues/390#issuecomment-762213421 https://github.com/typicode/husky/issues/904#issuecomment-862184954 https://github.com/nvm-sh/nvm#deeper-shell-integration ","date":"2023-06-12","objectID":"/posts/sourcetree-husky/:3:0","tags":["Git","husky","Mac"],"title":"è§£å†³ SourceTree æäº¤æ—¶å€™ husky å‘½ä»¤å¤±è´¥é—®é¢˜","uri":"/posts/sourcetree-husky/"},{"categories":["CSS","JavaScript"],"content":"æ–°å»º Vue2 é¡¹ç›® é€šè¿‡ vue-cli åˆ›å»ºä¸€ä¸ªå« v2-tailwind çš„é¡¹ç›®ï¼š vue create vue2-tailwind æ ¹æ®éœ€è¦é€‰æ‹©å…¶ä»–çš„åŠŸèƒ½æ’ä»¶ï¼Œä¾‹å¦‚ï¼šBabel, Router, Vuex, CSS Pre-processors, Linterã€‚ å…³äº ESLint å½“åœ¨ Vue åˆ›å»ºé¡¹ç›®æ—¶ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©ä¸åŒçš„ ESLint é…ç½®ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„é€‰é¡¹åŠå…¶ä¼˜ç¼ºç‚¹å’Œæ³¨æ„äº‹é¡¹ï¼š ESLint with error prevention only: ä¼˜ç‚¹ï¼šè¿™ä¸ªé…ç½®åªä¼šå¸®åŠ©ä½ é˜²æ­¢ä»£ç ä¸­çš„é”™è¯¯ï¼Œå®ƒçš„è§„åˆ™ç›¸å¯¹å®½æ¾ã€‚é€‚ç”¨äºåˆšå¼€å§‹ä½¿ç”¨ ESLint æˆ–è€…å¸Œæœ›é¿å…å¤ªå¤šçº¦æŸçš„å¼€å‘è€…ã€‚ ç¼ºç‚¹ï¼šç”±äºè§„åˆ™ç›¸å¯¹å®½æ¾ï¼Œå¯èƒ½æ— æ³•å®Œå…¨ç¡®ä¿ä»£ç é£æ ¼çš„ä¸€è‡´æ€§ã€‚ æ³¨æ„äº‹é¡¹ï¼šå¦‚æœä½ æƒ³è¦æ›´ä¸¥æ ¼çš„ä»£ç æ£€æŸ¥ï¼Œå¯ä»¥è€ƒè™‘å…¶ä»–é…ç½®ã€‚ ESLint + Airbnb config: ä¼˜ç‚¹ï¼šAirbnb çš„é…ç½®éå¸¸ä¸¥æ ¼ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ éµå¾ªæœ€ä½³å®è·µå’Œç¼–å†™é«˜è´¨é‡çš„ä»£ç ã€‚æ­¤å¤–ï¼Œå®ƒä¹ŸåŒ…å«äº†è®¸å¤š ES6+ çš„è§„åˆ™ã€‚ ç¼ºç‚¹ï¼šç”±äºå…¶ä¸¥æ ¼æ€§ï¼Œåˆå­¦è€…å¯èƒ½éœ€è¦èŠ±è´¹æ›´å¤šæ—¶é—´æ¥è§£å†³ ESLint æŠ¥å‘Šçš„é—®é¢˜ã€‚ æ³¨æ„äº‹é¡¹ï¼šåœ¨ä½¿ç”¨æ­¤é…ç½®æ—¶ï¼Œè¯·ç¡®ä¿ä½ ç†è§£å¹¶æ¥å— Airbnb çš„ä»£ç è§„èŒƒã€‚ ESLint + Standard config: ä¼˜ç‚¹ï¼šStandard çš„é…ç½®æ—¨åœ¨æä¾›ä¸€ä¸ªç›¸å¯¹ç®€å•ã€ä¸€è‡´çš„ä»£ç é£æ ¼ï¼Œé€‚åˆé‚£äº›å–œæ¬¢â€œé›¶é…ç½®â€çš„å¼€å‘è€…ã€‚ ç¼ºç‚¹ï¼šè¿™ä¸ªé…ç½®å¯èƒ½ä¸é€‚ç”¨äºæ‰€æœ‰é¡¹ç›®ï¼Œå› ä¸ºå®ƒæœ‰è‡ªå·±çš„ä»£ç é£æ ¼è¦æ±‚ã€‚ æ³¨æ„äº‹é¡¹ï¼šå¦‚æœä½ çš„å›¢é˜Ÿæˆ–é¡¹ç›®å·²ç»æœ‰è‡ªå·±çš„ç¼–ç è§„èŒƒï¼Œä½¿ç”¨ Standard é…ç½®å¯èƒ½ä¼šå¯¼è‡´ä¸ä¸€è‡´ã€‚ ESLint + Prettier: ä¼˜ç‚¹ï¼šPrettier æ˜¯ä¸€ä¸ªè‡ªåŠ¨æ ¼å¼åŒ–å·¥å…·ï¼Œå¯ä»¥ä¸ ESLint ç»“åˆä½¿ç”¨ï¼Œä»¥ç¡®ä¿ä»£ç é£æ ¼çš„ä¸€è‡´æ€§ã€‚è¿™å¯ä»¥æé«˜ä»£ç å¯è¯»æ€§ï¼Œå¹¶å‡å°‘åœ¨ä»£ç å®¡æŸ¥è¿‡ç¨‹ä¸­å…³æ³¨æ ¼å¼é—®é¢˜çš„æ—¶é—´ã€‚ ç¼ºç‚¹ï¼šPrettier å¯èƒ½ä¼šè¦†ç›–æŸäº› ESLint è§„åˆ™ï¼Œæ‰€ä»¥éœ€è¦èŠ±ä¸€äº›æ—¶é—´ç¡®ä¿é…ç½®æ­£ç¡®ã€‚ æ³¨æ„äº‹é¡¹ï¼šä¸ºäº†é¿å…å†²çªï¼Œè¯·ç¡®ä¿ ESLint å’Œ Prettier çš„è§„åˆ™æ­£ç¡®é…ç½®ã€‚ æ€»ä¹‹ï¼Œåœ¨é€‰æ‹© ESLint é…ç½®æ—¶ï¼Œéœ€è¦æ ¹æ®ä½ çš„å›¢é˜Ÿã€é¡¹ç›®éœ€æ±‚å’Œä¸ªäººåå¥½æ¥æƒè¡¡ã€‚é€‰æ‹©é€‚å½“çš„é…ç½®å¯ä»¥å¸®åŠ©ä½ æé«˜ä»£ç è´¨é‡å¹¶ä¿æŒä¸€è‡´çš„ä»£ç é£æ ¼ã€‚ ","date":"2023-06-03","objectID":"/posts/v2-tailwind/:1:0","tags":["tailwindcss","Vue"],"title":"Vue2 + tailwindcss åˆå§‹åŒ–","uri":"/posts/v2-tailwind/"},{"categories":["CSS","JavaScript"],"content":"å®‰è£… tailwindcss æ‰“å¼€é¡¹ç›®ï¼Œå®‰è£… tailwindcssï¼š cd vue2-tailwind # å®‰è£… tailwindcss ä½ç‰ˆæœ¬åŠç›¸å…³æ’ä»¶ npm install tailwindcss@npm:@tailwindcss/postcss7-compat @tailwindcss/postcss7-compat postcss@^7 autoprefixer@^9 ç„¶ååˆ›å»ºé…ç½®æ–‡ä»¶ï¼š # åˆ›å»º postcss.config.js, tailwind.config.js npx tailwindcss init -p module.exports = { plugins: { tailwindcss: {}, autoprefixer: {}, } } module.exports = { purge: [ \"./src/App.vue\", \"./src/views/**/*.{vue,js,ts,jsx,tsx}\", \"./src/components/**/*.{vue,js,ts,jsx,tsx}\", ], darkMode: 'class', // or 'media' or 'class' mode: 'jit', // æ˜¯å¦å¼€å¯ jit æ¨¡å¼ï¼Œå¼€å¯ä»¥åç¼–è¯‘ä¼šæ›´å¿«ï¼Œå½“ç„¶ï¼Œtailwindcss ç‰ˆæœ¬éœ€è¦åœ¨ 2.1 ä»¥ä¸Š theme: { extend: {}, }, variants: { extend: {}, }, plugins: [], } æœ€ååœ¨ main.js ä¸­å¼•å…¥ tailwindcss import \"tailwindcss/tailwind.css\" ","date":"2023-06-03","objectID":"/posts/v2-tailwind/:2:0","tags":["tailwindcss","Vue"],"title":"Vue2 + tailwindcss åˆå§‹åŒ–","uri":"/posts/v2-tailwind/"},{"categories":["CSS","JavaScript"],"content":"å¯åŠ¨é¡¹ç›® å¯åŠ¨é¡¹ç›®ï¼Œä¿®æ”¹æ¨¡æ¿ä¸­çš„ class è¿›è¡Œæµ‹è¯•ã€‚ npm run serve \u003ctemplate\u003e \u003cdiv id=\"app\"\u003e \u003cdiv class=\"bg-gray-100\"\u003e \u003cdiv class=\"container mx-auto\"\u003e \u003cdiv class=\"flex justify-center items-center h-screen\"\u003e \u003cdiv class=\"text-4xl text-gray-700\"\u003eHello Vue2 + tailwindcss\u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c/template\u003e ","date":"2023-06-03","objectID":"/posts/v2-tailwind/:3:0","tags":["tailwindcss","Vue"],"title":"Vue2 + tailwindcss åˆå§‹åŒ–","uri":"/posts/v2-tailwind/"},{"categories":["HTML"],"content":"è®°å½•ä½¿ç”¨ HTML åŸç”Ÿæ–¹æ¡ˆå®ç°å›¾ç‰‡çš„æ‡’åŠ è½½ã€‚ ","date":"2023-02-12","objectID":"/posts/native-img-loading-lazy/:0:0","tags":["HTML","eager","lazy","loading"],"title":"æµè§ˆå™¨ IMG å›¾ç‰‡åŸç”Ÿæ‡’åŠ è½½ loading=\"lazy\"","uri":"/posts/native-img-loading-lazy/"},{"categories":["HTML"],"content":"è¯­æ³•è§„èŒƒ HTML loading å±æ€§é€‚ç”¨äº img å’Œ iframeï¼Œè¯­æ³•è§„èŒƒè§ HTML Standard - Lazy loading attributesã€‚ å…³é”®è¯ çŠ¶æ€ æè¿° lazy æ‡’æƒ°çš„ ç”¨äºå»¶è¿Ÿè·å–èµ„æºï¼Œç›´åˆ°æ»¡è¶³æŸäº›æ¡ä»¶ã€‚ eager æ¸´æœ›çš„ ç”¨äºç«‹å³è·å–èµ„æºï¼›é»˜è®¤çŠ¶æ€ã€‚ å±æ€§çš„ ç¼ºå¤±å€¼é»˜è®¤å€¼ å’Œ æ— æ•ˆå€¼é»˜è®¤å€¼ éƒ½æ˜¯ EagerçŠ¶æ€ã€‚ ","date":"2023-02-12","objectID":"/posts/native-img-loading-lazy/:1:0","tags":["HTML","eager","lazy","loading"],"title":"æµè§ˆå™¨ IMG å›¾ç‰‡åŸç”Ÿæ‡’åŠ è½½ loading=\"lazy\"","uri":"/posts/native-img-loading-lazy/"},{"categories":["HTML"],"content":"å®é™…åº”ç”¨ åŸºäº FixIt ä¸»é¢˜ ç‰ˆæœ¬å¤§äº v0.2.18 çš„åšå®¢ç½‘ç«™ä½¿ç”¨å°±æ˜¯åŸç”Ÿçš„æ‡’åŠ è½½æ–¹æ¡ˆï¼Œå¤§è‡´å¦‚ä¸‹ï¼š \u003cimg loading=\"lazy\" src=\"./example.jpg\" data-title=\"title text\" data-alt=\"alt text\" onload=\"this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';\" onerror=\"this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['data-title','data-alt','onerror','onload']){this.removeAttribute(a);}\" /\u003e ä¸ºäº†è¾¾åˆ° loading çš„æ•ˆæœï¼Œä»¥ä¸Šä»£ç ä¸­åœ¨ onload åä¼šç»™å›¾ç‰‡åŠ ä¸Šä¸€ä¸ª data-lazyloaded å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥å†™ css ä»¥è¾¾åˆ°æ˜¾ç¤º loading å›¾æ ‡çš„æ•ˆæœï¼š img[loading='lazy']:not([data-lazyloaded]) { background: url(loading.svg) no-repeat center; } è®¾ç½® data-title å’Œ data-alt æ˜¯å› ä¸ºç§»åŠ¨æµè§ˆå™¨å¤§å¤šæ•°åªè¦æœ‰ title æˆ– alt å°±ä¼šæ˜¾ç¤ºå›¾ç‰‡çš„æ›¿ä»£å­—ç¬¦ï¼Œæ‰€ä»¥ç­‰åˆ°å›¾ç‰‡åŠ è½½å®Œæˆ–åŠ è½½å¤±è´¥åå†å›å¡«ã€‚ ","date":"2023-02-12","objectID":"/posts/native-img-loading-lazy/:2:0","tags":["HTML","eager","lazy","loading"],"title":"æµè§ˆå™¨ IMG å›¾ç‰‡åŸç”Ÿæ‡’åŠ è½½ loading=\"lazy\"","uri":"/posts/native-img-loading-lazy/"},{"categories":["HTML"],"content":"æ‡’åŠ è½½ç‰¹æ€§çš„ç ”ç©¶ ä»¥ä¸‹ç»“è®ºæ¥è‡ª æµè§ˆå™¨ IMG å›¾ç‰‡åŸç”Ÿæ‡’åŠ è½½ loading=â€lazyâ€å®è·µæŒ‡å— Â« å¼ é‘«æ—­-é‘«ç©ºé—´-é‘«ç”Ÿæ´» æ€»ç»“éƒ¨åˆ†ã€‚ Lazy loading åŠ è½½æ•°é‡ä¸å±å¹•é«˜åº¦æœ‰å…³ï¼Œé«˜åº¦è¶Šå°åŠ è½½æ•°é‡è¶Šå°‘ï¼Œä½†å¹¶ä¸æ˜¯çº¿æ€§å…³ç³». Lazy loading åŠ è½½æ•°é‡ä¸ç½‘é€Ÿæœ‰å…³ï¼Œç½‘é€Ÿè¶Šæ…¢ï¼ŒåŠ è½½æ•°é‡è¶Šå¤šï¼Œä½†å¹¶ä¸æ˜¯çº¿æ€§å…³ç³»ã€‚ Lazy loading åŠ è½½æ²¡æœ‰ç¼“å†²ï¼Œæ»šåŠ¨å³ä¼šè§¦å‘æ–°çš„å›¾ç‰‡èµ„æºåŠ è½½ã€‚ Lazy loading åŠ è½½åœ¨çª—å£ resize å°ºå¯¸å˜åŒ–æ—¶å€™ä¹Ÿä¼šè§¦å‘ï¼Œä¾‹å¦‚å±å¹•é«˜åº¦ä»å°å˜å¤§çš„æ—¶å€™ã€‚ Lazy loading åŠ è½½ä¹Ÿæœ‰å¯èƒ½ä¼šå…ˆåŠ è½½åé¢çš„å›¾ç‰‡èµ„æºï¼Œä¾‹å¦‚é¡µé¢åŠ è½½æ—¶æ»šåŠ¨é«˜åº¦å¾ˆé«˜çš„æ—¶å€™ã€‚ ","date":"2023-02-12","objectID":"/posts/native-img-loading-lazy/:3:0","tags":["HTML","eager","lazy","loading"],"title":"æµè§ˆå™¨ IMG å›¾ç‰‡åŸç”Ÿæ‡’åŠ è½½ loading=\"lazy\"","uri":"/posts/native-img-loading-lazy/"},{"categories":["HTML"],"content":"å‚è€ƒé“¾æ¥ Lazy loading - Web æ€§èƒ½ | MDN Lazy loading via attribute for images \u0026 iframes å…¼å®¹æ€§ ","date":"2023-02-12","objectID":"/posts/native-img-loading-lazy/:4:0","tags":["HTML","eager","lazy","loading"],"title":"æµè§ˆå™¨ IMG å›¾ç‰‡åŸç”Ÿæ‡’åŠ è½½ loading=\"lazy\"","uri":"/posts/native-img-loading-lazy/"},{"categories":["Browser"],"content":"æµè§ˆå™¨æ˜¯å¦‚ä½•æ¸²æŸ“é¡µé¢çš„ï¼Ÿ å½“æµè§ˆå™¨çš„ç½‘ç»œçº¿ç¨‹æ”¶åˆ° HTML æ–‡æ¡£åï¼Œä¼šäº§ç”Ÿä¸€ä¸ªæ¸²æŸ“ä»»åŠ¡ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™æ¸²æŸ“ä¸»çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚ åœ¨äº‹ä»¶å¾ªç¯æœºåˆ¶çš„ä½œç”¨ä¸‹ï¼Œæ¸²æŸ“ä¸»çº¿ç¨‹å–å‡ºæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¸²æŸ“ä»»åŠ¡ï¼Œå¼€å¯æ¸²æŸ“æµç¨‹ã€‚ æ•´ä¸ªæ¸²æŸ“æµç¨‹åˆ†ä¸ºå¤šä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯ï¼š HTML è§£æã€æ ·å¼è®¡ç®—ã€å¸ƒå±€ã€åˆ†å±‚ã€ç»˜åˆ¶ã€åˆ†å—ã€å…‰æ …åŒ–ã€ç”» æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„è¾“å…¥è¾“å‡ºï¼Œä¸Šä¸€ä¸ªé˜¶æ®µçš„è¾“å‡ºä¼šæˆä¸ºä¸‹ä¸€ä¸ªé˜¶æ®µçš„è¾“å…¥ã€‚ è¿™æ ·ï¼Œæ•´ä¸ªæ¸²æŸ“æµç¨‹å°±å½¢æˆäº†ä¸€å¥—ç»„ç»‡ä¸¥å¯†çš„ç”Ÿäº§æµæ°´çº¿ã€‚ æ¸²æŸ“çš„ç¬¬ä¸€æ­¥æ˜¯è§£æ HTMLã€‚ è§£æè¿‡ç¨‹ä¸­é‡åˆ° CSS è§£æ CSSï¼Œé‡åˆ° JS æ‰§è¡Œ JSã€‚ä¸ºäº†æé«˜è§£ææ•ˆç‡ï¼Œæµè§ˆå™¨åœ¨å¼€å§‹è§£æå‰ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªé¢„è§£æçš„çº¿ç¨‹ï¼Œç‡å…ˆä¸‹è½½ HTML ä¸­çš„å¤–éƒ¨ CSS æ–‡ä»¶å’Œ å¤–éƒ¨çš„ JS æ–‡ä»¶ã€‚ å¦‚æœä¸»çº¿ç¨‹è§£æåˆ°linkä½ç½®ï¼Œæ­¤æ—¶å¤–éƒ¨çš„ CSS æ–‡ä»¶è¿˜æ²¡æœ‰ä¸‹è½½è§£æå¥½ï¼Œä¸»çº¿ç¨‹ä¸ä¼šç­‰å¾…ï¼Œç»§ç»­è§£æåç»­çš„ HTMLã€‚è¿™æ˜¯å› ä¸ºä¸‹è½½å’Œè§£æ CSS çš„å·¥ä½œæ˜¯åœ¨é¢„è§£æçº¿ç¨‹ä¸­è¿›è¡Œçš„ã€‚è¿™å°±æ˜¯ CSS ä¸ä¼šé˜»å¡ HTML è§£æçš„æ ¹æœ¬åŸå› ã€‚ å¦‚æœä¸»çº¿ç¨‹è§£æåˆ°scriptä½ç½®ï¼Œä¼šåœæ­¢è§£æ HTMLï¼Œè½¬è€Œç­‰å¾… JS æ–‡ä»¶ä¸‹è½½å¥½ï¼Œå¹¶å°†å…¨å±€ä»£ç è§£ææ‰§è¡Œå®Œæˆåï¼Œæ‰èƒ½ç»§ç»­è§£æ HTMLã€‚è¿™æ˜¯å› ä¸º JS ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹å¯èƒ½ä¼šä¿®æ”¹å½“å‰çš„ DOM æ ‘ï¼Œæ‰€ä»¥ DOM æ ‘çš„ç”Ÿæˆå¿…é¡»æš‚åœã€‚è¿™å°±æ˜¯ JS ä¼šé˜»å¡ HTML è§£æçš„æ ¹æœ¬åŸå› ã€‚ ç¬¬ä¸€æ­¥å®Œæˆåï¼Œä¼šå¾—åˆ° DOM æ ‘å’Œ CSSOM æ ‘ï¼Œæµè§ˆå™¨çš„é»˜è®¤æ ·å¼ã€å†…éƒ¨æ ·å¼ã€å¤–éƒ¨æ ·å¼ã€è¡Œå†…æ ·å¼å‡ä¼šåŒ…å«åœ¨ CSSOM æ ‘ä¸­ã€‚ æ¸²æŸ“çš„ä¸‹ä¸€æ­¥æ˜¯æ ·å¼è®¡ç®—ã€‚ ä¸»çº¿ç¨‹ä¼šéå†å¾—åˆ°çš„ DOM æ ‘ï¼Œä¾æ¬¡ä¸ºæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è®¡ç®—å‡ºå®ƒæœ€ç»ˆçš„æ ·å¼ï¼Œç§°ä¹‹ä¸º Computed Styleã€‚ åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œå¾ˆå¤šé¢„è®¾å€¼ä¼šå˜æˆç»å¯¹å€¼ï¼Œæ¯”å¦‚redä¼šå˜æˆrgb(255,0,0)ï¼›ç›¸å¯¹å•ä½ä¼šå˜æˆç»å¯¹å•ä½ï¼Œæ¯”å¦‚emä¼šå˜æˆpx è¿™ä¸€æ­¥å®Œæˆåï¼Œä¼šå¾—åˆ°ä¸€æ£µå¸¦æœ‰æ ·å¼çš„ DOM æ ‘ã€‚ æ¥ä¸‹æ¥æ˜¯å¸ƒå±€ï¼Œå¸ƒå±€å®Œæˆåä¼šå¾—åˆ°å¸ƒå±€æ ‘ã€‚ å¸ƒå±€é˜¶æ®µä¼šä¾æ¬¡éå† DOM æ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å‡ ä½•ä¿¡æ¯ã€‚ä¾‹å¦‚èŠ‚ç‚¹çš„å®½é«˜ã€ç›¸å¯¹åŒ…å«å—çš„ä½ç½®ã€‚ å¤§éƒ¨åˆ†æ—¶å€™ï¼ŒDOM æ ‘å’Œå¸ƒå±€æ ‘å¹¶éä¸€ä¸€å¯¹åº”ã€‚ æ¯”å¦‚display:noneçš„èŠ‚ç‚¹æ²¡æœ‰å‡ ä½•ä¿¡æ¯ï¼Œå› æ­¤ä¸ä¼šç”Ÿæˆåˆ°å¸ƒå±€æ ‘ï¼›åˆæ¯”å¦‚ä½¿ç”¨äº†ä¼ªå…ƒç´ é€‰æ‹©å™¨ï¼Œè™½ç„¶ DOM æ ‘ä¸­ä¸å­˜åœ¨è¿™äº›ä¼ªå…ƒç´ èŠ‚ç‚¹ï¼Œä½†å®ƒä»¬æ‹¥æœ‰å‡ ä½•ä¿¡æ¯ï¼Œæ‰€ä»¥ä¼šç”Ÿæˆåˆ°å¸ƒå±€æ ‘ä¸­ã€‚è¿˜æœ‰åŒ¿åè¡Œç›’ã€åŒ¿åå—ç›’ç­‰ç­‰éƒ½ä¼šå¯¼è‡´ DOM æ ‘å’Œå¸ƒå±€æ ‘æ— æ³•ä¸€ä¸€å¯¹åº”ã€‚ ä¸‹ä¸€æ­¥æ˜¯åˆ†å±‚ ä¸»çº¿ç¨‹ä¼šä½¿ç”¨ä¸€å¥—å¤æ‚çš„ç­–ç•¥å¯¹æ•´ä¸ªå¸ƒå±€æ ‘ä¸­è¿›è¡Œåˆ†å±‚ã€‚ åˆ†å±‚çš„å¥½å¤„åœ¨äºï¼Œå°†æ¥æŸä¸€ä¸ªå±‚æ”¹å˜åï¼Œä»…ä¼šå¯¹è¯¥å±‚è¿›è¡Œåç»­å¤„ç†ï¼Œä»è€Œæå‡æ•ˆç‡ã€‚ æ»šåŠ¨æ¡ã€å †å ä¸Šä¸‹æ–‡ã€transformã€opacity ç­‰æ ·å¼éƒ½ä¼šæˆ–å¤šæˆ–å°‘çš„å½±å“åˆ†å±‚ç»“æœï¼Œä¹Ÿå¯ä»¥é€šè¿‡will-changeå±æ€§æ›´å¤§ç¨‹åº¦çš„å½±å“åˆ†å±‚ç»“æœã€‚ å†ä¸‹ä¸€æ­¥æ˜¯ç»˜åˆ¶ ä¸»çº¿ç¨‹ä¼šä¸ºæ¯ä¸ªå±‚å•ç‹¬äº§ç”Ÿç»˜åˆ¶æŒ‡ä»¤é›†ï¼Œç”¨äºæè¿°è¿™ä¸€å±‚çš„å†…å®¹è¯¥å¦‚ä½•ç”»å‡ºæ¥ã€‚ å®Œæˆç»˜åˆ¶åï¼Œä¸»çº¿ç¨‹å°†æ¯ä¸ªå›¾å±‚çš„ç»˜åˆ¶ä¿¡æ¯æäº¤ç»™åˆæˆçº¿ç¨‹ï¼Œå‰©ä½™å·¥ä½œå°†ç”±åˆæˆçº¿ç¨‹å®Œæˆã€‚ åˆæˆçº¿ç¨‹é¦–å…ˆå¯¹æ¯ä¸ªå›¾å±‚è¿›è¡Œåˆ†å—ï¼Œå°†å…¶åˆ’åˆ†ä¸ºæ›´å¤šçš„å°åŒºåŸŸã€‚ å®ƒä¼šä»çº¿ç¨‹æ± ä¸­æ‹¿å–å¤šä¸ªçº¿ç¨‹æ¥å®Œæˆåˆ†å—å·¥ä½œã€‚ åˆ†å—å®Œæˆåï¼Œè¿›å…¥å…‰æ …åŒ–é˜¶æ®µã€‚ åˆæˆçº¿ç¨‹ä¼šå°†å—ä¿¡æ¯äº¤ç»™ GPU è¿›ç¨‹ï¼Œä»¥æé«˜çš„é€Ÿåº¦å®Œæˆå…‰æ …åŒ–ã€‚ GPU è¿›ç¨‹ä¼šå¼€å¯å¤šä¸ªçº¿ç¨‹æ¥å®Œæˆå…‰æ …åŒ–ï¼Œå¹¶ä¸”ä¼˜å…ˆå¤„ç†é è¿‘è§†å£åŒºåŸŸçš„å—ã€‚ å…‰æ …åŒ–çš„ç»“æœï¼Œå°±æ˜¯ä¸€å—ä¸€å—çš„ä½å›¾ æœ€åä¸€ä¸ªé˜¶æ®µå°±æ˜¯ç”»äº† åˆæˆçº¿ç¨‹æ‹¿åˆ°æ¯ä¸ªå±‚ã€æ¯ä¸ªå—çš„ä½å›¾åï¼Œç”Ÿæˆä¸€ä¸ªä¸ªã€ŒæŒ‡å¼•ï¼ˆquadï¼‰ã€ä¿¡æ¯ã€‚ æŒ‡å¼•ä¼šæ ‡è¯†å‡ºæ¯ä¸ªä½å›¾åº”è¯¥ç”»åˆ°å±å¹•çš„å“ªä¸ªä½ç½®ï¼Œä»¥åŠä¼šè€ƒè™‘åˆ°æ—‹è½¬ã€ç¼©æ”¾ç­‰å˜å½¢ã€‚ å˜å½¢å‘ç”Ÿåœ¨åˆæˆçº¿ç¨‹ï¼Œä¸æ¸²æŸ“ä¸»çº¿ç¨‹æ— å…³ï¼Œè¿™å°±æ˜¯transformæ•ˆç‡é«˜çš„æœ¬è´¨åŸå› ã€‚ åˆæˆçº¿ç¨‹ä¼šæŠŠ quad æäº¤ç»™ GPU è¿›ç¨‹ï¼Œç”± GPU è¿›ç¨‹äº§ç”Ÿç³»ç»Ÿè°ƒç”¨ï¼Œæäº¤ç»™ GPU ç¡¬ä»¶ï¼Œå®Œæˆæœ€ç»ˆçš„å±å¹•æˆåƒã€‚ ","date":"2023-02-05","objectID":"/posts/browser-rendering/:1:0","tags":["Browser","JavaScript","HTML","CSS"],"title":"æµè§ˆå™¨æ¸²æŸ“åŸç†","uri":"/posts/browser-rendering/"},{"categories":["Browser"],"content":"ä»€ä¹ˆæ˜¯ reflowï¼Ÿ reflow çš„æœ¬è´¨å°±æ˜¯é‡æ–°è®¡ç®— layout æ ‘ã€‚ å½“è¿›è¡Œäº†ä¼šå½±å“å¸ƒå±€æ ‘çš„æ“ä½œåï¼Œéœ€è¦é‡æ–°è®¡ç®—å¸ƒå±€æ ‘ï¼Œä¼šå¼•å‘ layoutã€‚ ä¸ºäº†é¿å…è¿ç»­çš„å¤šæ¬¡æ“ä½œå¯¼è‡´å¸ƒå±€æ ‘åå¤è®¡ç®—ï¼Œæµè§ˆå™¨ä¼šåˆå¹¶è¿™äº›æ“ä½œï¼Œå½“ JS ä»£ç å…¨éƒ¨å®Œæˆåå†è¿›è¡Œç»Ÿä¸€è®¡ç®—ã€‚æ‰€ä»¥ï¼Œæ”¹åŠ¨å±æ€§é€ æˆçš„ reflow æ˜¯å¼‚æ­¥å®Œæˆçš„ã€‚ ä¹ŸåŒæ ·å› ä¸ºå¦‚æ­¤ï¼Œå½“ JS è·å–å¸ƒå±€å±æ€§æ—¶ï¼Œå°±å¯èƒ½é€ æˆæ— æ³•è·å–åˆ°æœ€æ–°çš„å¸ƒå±€ä¿¡æ¯ã€‚ æµè§ˆå™¨åœ¨åå¤æƒè¡¡ä¸‹ï¼Œæœ€ç»ˆå†³å®šè·å–å±æ€§ç«‹å³ reflowã€‚ ","date":"2023-02-05","objectID":"/posts/browser-rendering/:2:0","tags":["Browser","JavaScript","HTML","CSS"],"title":"æµè§ˆå™¨æ¸²æŸ“åŸç†","uri":"/posts/browser-rendering/"},{"categories":["Browser"],"content":"ä»€ä¹ˆæ˜¯ repaintï¼Ÿ repaint çš„æœ¬è´¨å°±æ˜¯é‡æ–°æ ¹æ®åˆ†å±‚ä¿¡æ¯è®¡ç®—äº†ç»˜åˆ¶æŒ‡ä»¤ã€‚ å½“æ”¹åŠ¨äº†å¯è§æ ·å¼åï¼Œå°±éœ€è¦é‡æ–°è®¡ç®—ï¼Œä¼šå¼•å‘ repaintã€‚ ç”±äºå…ƒç´ çš„å¸ƒå±€ä¿¡æ¯ä¹Ÿå±äºå¯è§æ ·å¼ï¼Œæ‰€ä»¥ reflow ä¸€å®šä¼šå¼•èµ· repaintã€‚ ","date":"2023-02-05","objectID":"/posts/browser-rendering/:3:0","tags":["Browser","JavaScript","HTML","CSS"],"title":"æµè§ˆå™¨æ¸²æŸ“åŸç†","uri":"/posts/browser-rendering/"},{"categories":["Browser"],"content":"ä¸ºä»€ä¹ˆ transform çš„æ•ˆç‡é«˜ï¼Ÿ å› ä¸º transform æ—¢ä¸ä¼šå½±å“å¸ƒå±€ä¹Ÿä¸ä¼šå½±å“ç»˜åˆ¶æŒ‡ä»¤ï¼Œå®ƒå½±å“çš„åªæ˜¯æ¸²æŸ“æµç¨‹çš„æœ€åä¸€ä¸ªã€Œdrawã€é˜¶æ®µ ç”±äº draw é˜¶æ®µåœ¨åˆæˆçº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥ transform çš„å˜åŒ–å‡ ä¹ä¸ä¼šå½±å“æ¸²æŸ“ä¸»çº¿ç¨‹ã€‚åä¹‹ï¼Œæ¸²æŸ“ä¸»çº¿ç¨‹æ— è®ºå¦‚ä½•å¿™ç¢Œï¼Œä¹Ÿä¸ä¼šå½±å“ transform çš„å˜åŒ–ã€‚ ","date":"2023-02-05","objectID":"/posts/browser-rendering/:4:0","tags":["Browser","JavaScript","HTML","CSS"],"title":"æµè§ˆå™¨æ¸²æŸ“åŸç†","uri":"/posts/browser-rendering/"},{"categories":["Spec"],"content":" ä»¥ä¸‹å‚è€ƒæ¥æºï¼šé˜®ä¸€å³°çš„ ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ è‹±è¯­ä¸–ç•Œé‡Œï¼Œæ–‡æ¡£éå¸¸å—é‡è§†ï¼Œè®¸å¤šå…¬å¸å’Œç»„ç»‡éƒ½æœ‰è‡ªå·±çš„æ–‡æ¡£è§„èŒƒï¼Œæ¸…æ¥šåœ°è§„å®šå†™ä½œè¦æ±‚ï¼Œæ¯”å¦‚å¾®è½¯ã€MailChimpã€Appleã€Yahooã€dockerã€Struts ç­‰ç­‰ï¼ˆç»´åŸºç™¾ç§‘æœ‰ä¸€ä»½å®Œæ•´çš„æ¸…å•ï¼‰ã€‚ä¸­æ–‡çš„ä¹Ÿæœ‰ä¸å°‘ï¼Œä½†éƒ½ä¸ä»¤äººæ»¡æ„ï¼Œè¦ä¹ˆå¤ªç®€å•ï¼Œè¦ä¹ˆä¸å¤ªé€‚ç”¨ã€‚ å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œåœ¨å·¥ä½œä¸­ä¹Ÿéœ€è¦é€‚å½“åœ°äº§å‡ºä¸€äº›æŠ€æœ¯æ–‡æ¡£ï¼Œä½†æ˜¯å¾ˆå¤šäººéƒ½ä¸çŸ¥é“æ€ä¹ˆå†™æ–‡æ¡£ï¼Œéƒ½æ˜¯å‡­ç€æ„Ÿè§‰å†™ã€‚ å¯¹äºå¼€å‘çš„ç³»ç»Ÿã€è½¯ä»¶è€Œè¨€ï¼Œç³»ç»Ÿç”¨è¯çš„å‡†ç¡®æ€§å’Œç»Ÿä¸€æ€§ä¹Ÿæ˜¾å¾—ååˆ†é‡è¦ã€‚ å‚è€ƒä¸Šé¢çš„è§„èŒƒï¼Œäºæ˜¯æœ‰äº†ä¸‹é¢ä¸€ä»½ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:0:0","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ ‡é¢˜ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:1:0","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å±‚çº§ æ ‡é¢˜åˆ†ä¸ºå››çº§ã€‚ ä¸€çº§æ ‡é¢˜ï¼šæ–‡ç« çš„æ ‡é¢˜ äºŒçº§æ ‡é¢˜ï¼šæ–‡ç« ä¸»è¦éƒ¨åˆ†çš„å¤§æ ‡é¢˜ ä¸‰çº§æ ‡é¢˜ï¼šäºŒçº§æ ‡é¢˜ä¸‹é¢ä¸€çº§çš„å°æ ‡é¢˜ å››çº§æ ‡é¢˜ï¼šä¸‰çº§æ ‡é¢˜ä¸‹é¢æŸä¸€æ–¹é¢çš„å°æ ‡é¢˜ ä¸‹é¢æ˜¯ç¤ºä¾‹ã€‚ # ä¸€çº§æ ‡é¢˜ ## äºŒçº§æ ‡é¢˜ ### ä¸‰çº§æ ‡é¢˜ #### å››çº§æ ‡é¢˜ æ³¨ï¼šæœ€å¤šæ”¯æŒå…­çº§ï¼Œä½†æ˜¯åŒè®ºæ–‡å†™ä½œä¸€æ ·ï¼Œå±‚çº§å¤ªæ·±ï¼Œä¼šä½¿å¾—æ•´ä½“æ˜¾å¾—æ‚ä¹±æ— ç« ï¼Œå½“ç¡®å®éœ€è¦æ›´æ·±å±‚çº§æ—¶ï¼Œåº”å¦èµ·æ–°ç¯‡å•ç‹¬è®ºè¿°ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:1:1","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"åŸåˆ™ ï¼ˆ1ï¼‰ä¸€çº§æ ‡é¢˜ä¸‹ï¼Œä¸èƒ½ç›´æ¥å‡ºç°ä¸‰çº§æ ‡é¢˜ã€‚ ç¤ºä¾‹ï¼šä¸‹é¢çš„æ–‡ç« ç»“æ„ï¼Œç¼ºå°‘äºŒçº§æ ‡é¢˜ã€‚ # ä¸€çº§æ ‡é¢˜ ### ä¸‰çº§æ ‡é¢˜ ï¼ˆ2ï¼‰æ ‡é¢˜è¦é¿å…å­¤ç«‹ç¼–å·ï¼ˆå³åŒçº§æ ‡é¢˜åªæœ‰ä¸€ä¸ªï¼‰ã€‚ ç¤ºä¾‹ï¼šä¸‹é¢çš„æ–‡ç« ç»“æ„ï¼ŒäºŒçº§æ ‡é¢˜ AåªåŒ…å«ä¸€ä¸ªä¸‰çº§æ ‡é¢˜ï¼Œå®Œå…¨å¯ä»¥çœç•¥ä¸‰çº§æ ‡é¢˜ Aã€‚ ## äºŒçº§æ ‡é¢˜ A ### ä¸‰çº§æ ‡é¢˜ A ## äºŒçº§æ ‡é¢˜ B ï¼ˆ3ï¼‰ä¸‹çº§æ ‡é¢˜ä¸é‡å¤ä¸Šä¸€çº§æ ‡é¢˜çš„åå­—ã€‚ ç¤ºä¾‹ï¼šä¸‹é¢çš„æ–‡ç« ç»“æ„ï¼ŒäºŒçº§æ ‡é¢˜ä¸ä¸‹å±çš„ä¸‰çº§æ ‡é¢˜åŒåï¼Œå»ºè®®é¿å…ã€‚ ## æ¦‚è¿° ### æ¦‚è¿° ï¼ˆ4ï¼‰è°¨æ…ä½¿ç”¨å››çº§æ ‡é¢˜ï¼Œå°½é‡é¿å…å‡ºç°ï¼Œä¿æŒå±‚çº§çš„ç®€å•ï¼Œé˜²æ­¢å‡ºç°è¿‡äºå¤æ‚çš„ç« èŠ‚ã€‚ å¦‚æœä¸‰çº§æ ‡é¢˜ä¸‹æœ‰å¹¶åˆ—æ€§çš„å†…å®¹ï¼Œå»ºè®®åªä½¿ç”¨é¡¹ç›®åˆ—è¡¨ï¼ˆItem listï¼‰ã€‚ ç¤ºä¾‹ï¼šä¸‹é¢çš„ç»“æ„äºŒè¦å¥½äºç»“æ„ä¸€ã€‚ç»“æ„ä¸€é€‚ç”¨çš„åœºæ™¯ï¼Œä¸»è¦æ˜¯è¾ƒé•¿ç¯‡å¹…çš„å†…å®¹ã€‚ ç»“æ„ä¸€ ### ä¸‰çº§æ ‡é¢˜ #### å››çº§æ ‡é¢˜ A #### å››çº§æ ‡é¢˜ B #### å››çº§æ ‡é¢˜ C ç»“æ„äºŒ ### ä¸‰çº§æ ‡é¢˜ **ï¼ˆ1ï¼‰A** **ï¼ˆ2ï¼‰B** **ï¼ˆ3ï¼‰C** ","date":"2023-02-04","objectID":"/posts/document-style-guide/:1:2","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ–‡æœ¬ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:2:0","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å­—é—´è· ï¼ˆ1ï¼‰å…¨è§’ä¸­æ–‡å­—ç¬¦ä¸åŠè§’è‹±æ–‡å­—ç¬¦ä¹‹é—´ï¼Œåº”æœ‰ä¸€ä¸ªåŠè§’ç©ºæ ¼ã€‚ é”™è¯¯ï¼šæœ¬æ–‡ä»‹ç»å¦‚ä½•å¿«é€Ÿå¯åŠ¨Windowsç³»ç»Ÿã€‚ æ­£ç¡®ï¼šæœ¬æ–‡ä»‹ç»å¦‚ä½•å¿«é€Ÿå¯åŠ¨ Windows ç³»ç»Ÿã€‚ ï¼ˆ2ï¼‰å…¨è§’ä¸­æ–‡å­—ç¬¦ä¸åŠè§’é˜¿æ‹‰ä¼¯æ•°å­—ä¹‹é—´ï¼Œæœ‰æ²¡æœ‰åŠè§’ç©ºæ ¼éƒ½å¯ï¼Œä½†å¿…é¡»ä¿è¯é£æ ¼ç»Ÿä¸€ï¼Œä¸èƒ½ä¸¤ç§é£æ ¼æ··æ‚ã€‚ æ­£ç¡®ï¼š2011å¹´5æœˆ15æ—¥ï¼Œæˆ‘è®¢è´­äº†5å°ç¬”è®°æœ¬ç”µè„‘ä¸10å°å¹³æ¿ç”µè„‘ã€‚ æ­£ç¡®ï¼š2011 å¹´ 5 æœˆ 15 æ—¥ï¼Œæˆ‘è®¢è´­äº† 5 å°ç¬”è®°æœ¬ç”µè„‘ä¸ 10 å°å¹³æ¿ç”µè„‘ã€‚ åŠè§’çš„ç™¾åˆ†å·ï¼Œè§†åŒé˜¿æ‹‰ä¼¯æ•°å­—ã€‚ æ­£ç¡®ï¼šä»Šå¹´æˆ‘å›½ç»æµå¢é•¿ç‡æ˜¯6.5%ã€‚ æ­£ç¡®ï¼šä»Šå¹´æˆ‘å›½ç»æµå¢é•¿ç‡æ˜¯ 6.5%ã€‚ ï¼ˆ3ï¼‰è‹±æ–‡å•ä½è‹¥ä¸ç¿»è¯‘ï¼Œå•ä½å‰çš„é˜¿æ‹‰ä¼¯æ•°å­—ä¸å•ä½ç¬¦å·ä¹‹é—´ï¼Œåº”ç•™å‡ºé€‚å½“çš„ç©ºéš™ã€‚ ä¾‹1ï¼šä¸€éƒ¨å®¹é‡ä¸º 16 GB çš„æ™ºèƒ½æ‰‹æœº ä¾‹2ï¼š1 h = 60 min = 3,600 s ï¼ˆ4ï¼‰åŠè§’è‹±æ–‡å­—ç¬¦å’ŒåŠè§’é˜¿æ‹‰ä¼¯æ•°å­—ï¼Œä¸å…¨è§’æ ‡ç‚¹ç¬¦å·ä¹‹é—´ä¸ç•™ç©ºæ ¼ã€‚ é”™è¯¯ï¼šä»–çš„ç”µè„‘æ˜¯ MacBook Air ã€‚ æ­£ç¡®ï¼šä»–çš„ç”µè„‘æ˜¯ MacBook Airã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:2:1","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å¥å­ ï¼ˆ1ï¼‰é¿å…ä½¿ç”¨é•¿å¥ã€‚ ä¸åŒ…å«ä»»ä½•æ ‡ç‚¹ç¬¦å·çš„å•ä¸ªå¥å­ï¼Œæˆ–è€…ä»¥é€—å·åˆ†éš”çš„å¥å­æ„ä»¶ï¼Œé•¿åº¦å°½é‡ä¿æŒåœ¨ 20 ä¸ªå­—ä»¥å†…ï¼›20 ï½ 29 ä¸ªå­—çš„å¥å­ï¼Œå¯ä»¥æ¥å—ï¼›30 ï½ 39 ä¸ªå­—çš„å¥å­ï¼Œè¯­ä¹‰å¿…é¡»æ˜ç¡®ï¼Œæ‰èƒ½æ¥å—ï¼›å¤šäº 40 ä¸ªå­—çš„å¥å­ï¼Œä»»ä½•æƒ…å†µä¸‹éƒ½ä¸èƒ½æ¥å—ã€‚ é”™è¯¯ï¼šæœ¬äº§å“é€‚ç”¨äºä»ç”±ä¸€å°æœåŠ¡å™¨è¿›è¡ŒåŠ¨ä½œæ§åˆ¶çš„å•ä¸€èŠ‚ç‚¹ç»“æ„åˆ°ç”±å¤šå°æœåŠ¡å™¨è¿›è¡ŒåŠ¨ä½œæ§åˆ¶çš„å¹¶è¡Œå¤„ç†ç¨‹åºç»“æ„ç­‰å¤šç§ä½“ç³»ç»“æ„ã€‚ æ­£ç¡®ï¼šæœ¬äº§å“é€‚ç”¨äºå¤šç§ä½“ç³»ç»“æ„ã€‚æ— è®ºæ˜¯ç”±ä¸€å°æœåŠ¡å™¨ï¼ˆå•ä¸€èŠ‚ç‚¹ç»“æ„ï¼‰ï¼Œè¿˜æ˜¯ç”±å¤šå°æœåŠ¡å™¨ï¼ˆå¹¶è¡Œå¤„ç†ç»“æ„ï¼‰è¿›è¡ŒåŠ¨ä½œæ§åˆ¶ï¼Œå‡å¯ä»¥ä½¿ç”¨æœ¬äº§å“ã€‚ é€—å·åˆ†å‰²çš„é•¿å¥ï¼Œæ€»é•¿åº¦ä¸åº”è¯¥è¶…è¿‡ 100 å­—æˆ–è€…æ­£æ–‡çš„ 3 è¡Œã€‚ ï¼ˆ2ï¼‰å°½é‡ä½¿ç”¨ç®€å•å¥å’Œå¹¶åˆ—å¥ï¼Œé¿å…ä½¿ç”¨å¤åˆå¥ã€‚ å¹¶åˆ—å¥ï¼šä»–æ˜¨å¤©ç”Ÿç—…äº†ï¼Œæ²¡æœ‰å‚åŠ ä¼šè®®ã€‚ å¤åˆå¥ï¼šé‚£ä¸ªæ˜¨å¤©ç”Ÿç—…çš„äººæ²¡æœ‰å‚åŠ ä¼šè®®ã€‚ ï¼ˆ3ï¼‰åŒæ ·ä¸€ä¸ªæ„æ€ï¼Œå°½é‡ä½¿ç”¨è‚¯å®šå¥è¡¨è¾¾ï¼Œä¸ä½¿ç”¨å¦å®šå¥è¡¨è¾¾ã€‚ é”™è¯¯ï¼šè¯·ç¡®è®¤æ²¡æœ‰æ¥é€šè£…ç½®çš„ç”µæºã€‚ æ­£ç¡®ï¼šè¯·ç¡®è®¤è£…ç½®çš„ç”µæºå·²å…³é—­ã€‚ ï¼ˆ4ï¼‰é¿å…ä½¿ç”¨åŒé‡å¦å®šå¥ã€‚ é”™è¯¯ï¼šæ²¡æœ‰åˆ é™¤æƒé™çš„ç”¨æˆ·ï¼Œä¸èƒ½åˆ é™¤æ­¤æ–‡ä»¶ã€‚ æ­£ç¡®ï¼šç”¨æˆ·å¿…é¡»æ‹¥æœ‰åˆ é™¤æƒé™ï¼Œæ‰èƒ½åˆ é™¤æ­¤æ–‡ä»¶ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:2:2","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å†™ä½œé£æ ¼ ï¼ˆ1ï¼‰å°½é‡ä¸ä½¿ç”¨è¢«åŠ¨è¯­æ€ï¼Œæ”¹ä¸ºä½¿ç”¨ä¸»åŠ¨è¯­æ€ã€‚ é”™è¯¯ï¼šå‡å¦‚æ­¤è½¯ä»¶å°šæœªè¢«å®‰è£…ï¼Œ æ­£ç¡®ï¼šå‡å¦‚å°šæœªå®‰è£…è¿™ä¸ªè½¯ä»¶ï¼Œ ï¼ˆ2ï¼‰ä¸ä½¿ç”¨éæ­£å¼çš„è¯­è¨€é£æ ¼ã€‚ é”™è¯¯ï¼šLady Gaga çš„æ¼”å”±ä¼šçœŸæ˜¯é…·æ¯™äº†ï¼Œä»æ²¡çœ‹è¿‡è¿™ä¹ˆç»™åŠ›çš„è¡¨æ¼”ï¼ï¼ï¼ æ­£ç¡®ï¼šæ— æ³•å‚åŠ æœ¬æ¬¡æ´»åŠ¨ï¼Œæˆ‘æ·±æ„Ÿé—æ†¾ã€‚ ï¼ˆ3ï¼‰ä¸ä½¿ç”¨å†·åƒ»ã€ç”Ÿé€ æˆ–è€…æ–‡è¨€æ–‡çš„è¯è¯­ï¼Œè€Œè¦ä½¿ç”¨ç°ä»£æ±‰è¯­çš„å¸¸ç”¨è¡¨è¾¾æ–¹å¼ã€‚ é”™è¯¯ï¼šè¿™æ˜¯å”¯äºŒçš„å¿«é€Ÿå¯åŠ¨çš„æ–¹æ³•ã€‚ æ­£ç¡®ï¼šè¿™æ˜¯ä»…æœ‰çš„ä¸¤ç§å¿«é€Ÿå¯åŠ¨çš„æ–¹æ³•ã€‚ ï¼ˆ4ï¼‰ç”¨å¯¹â€œçš„â€ã€â€œåœ°â€ã€â€œå¾—â€ã€‚ å¥¹éœ²å‡ºäº†å¼€å¿ƒçš„ç¬‘å®¹ã€‚ ï¼ˆå½¢å®¹è¯ï¼‹çš„ï¼‹åè¯ï¼‰ å¥¹å¼€å¿ƒåœ°ç¬‘äº†ã€‚ ï¼ˆå‰¯è¯ï¼‹åœ°ï¼‹åŠ¨è¯ï¼‰ å¥¹ç¬‘å¾—å¾ˆå¼€å¿ƒã€‚ ï¼ˆåŠ¨è¯ï¼‹å¾—ï¼‹å‰¯è¯ï¼‰ ï¼ˆ5ï¼‰ä½¿ç”¨ä»£è¯æ—¶ï¼ˆæ¯”å¦‚â€œå…¶â€ã€â€œè¯¥â€ã€â€œæ­¤â€ã€â€œè¿™â€ç­‰è¯ï¼‰ï¼Œå¿…é¡»æ˜ç¡®æŒ‡ä»£çš„å†…å®¹ï¼Œä¿è¯åªæœ‰ä¸€ä¸ªå«ä¹‰ã€‚ é”™è¯¯ï¼šä»ç®¡ç†ç³»ç»Ÿå¯ä»¥ç›‘è§†ä¸­ç»§ç³»ç»Ÿå’Œå—å…¶ç›´æ¥æ§åˆ¶çš„åˆ†é…ç³»ç»Ÿã€‚ æ­£ç¡®ï¼šä»ç®¡ç†ç³»ç»Ÿå¯ä»¥ç›‘è§†ä¸¤ä¸ªç³»ç»Ÿï¼šä¸­ç»§ç³»ç»Ÿå’Œå—ä¸­ç»§ç³»ç»Ÿç›´æ¥æ§åˆ¶çš„åˆ†é…ç³»ç»Ÿã€‚ ï¼ˆ6ï¼‰åè¯å‰ä¸è¦ä½¿ç”¨è¿‡å¤šçš„å½¢å®¹è¯ã€‚ é”™è¯¯ï¼šæ­¤è®¾å¤‡çš„ä½¿ç”¨å¿…é¡»åœ¨æ¥å—è¿‡æœ¬å…¬å¸ä¸¾åŠçš„æ­£å¼çš„è®¾å¤‡åŸ¹è®­çš„æŠ€å¸ˆçš„æŒ‡å¯¼ä¸‹è¿›è¡Œã€‚ æ­£ç¡®ï¼šæ­¤è®¾å¤‡å¿…é¡»åœ¨æŠ€å¸ˆçš„æŒ‡å¯¼ä¸‹ä½¿ç”¨ï¼Œä¸”æŒ‡å¯¼æŠ€å¸ˆå¿…é¡»æ¥å—è¿‡ç”±æœ¬å…¬å¸ä¸¾åŠçš„æ­£å¼è®¾å¤‡åŸ¹è®­ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:2:3","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"è‹±æ–‡å¤„ç† ï¼ˆ1ï¼‰è‹±æ–‡åŸæ–‡å¦‚æœä½¿ç”¨äº†å¤æ•°å½¢å¼ï¼Œç¿»è¯‘æˆä¸­æ–‡æ—¶ï¼Œåº”è¯¥å°†å…¶è¿˜åŸä¸ºå•æ•°å½¢å¼ã€‚ è‹±æ–‡ï¼š...information stored in random access memory (RAMs)... ä¸­æ–‡ï¼šâ‹¯â‹¯å­˜å‚¨åœ¨éšæœºå­˜å–å­˜å‚¨å™¨ï¼ˆRAMï¼‰é‡Œçš„ä¿¡æ¯â‹¯â‹¯ ï¼ˆ2ï¼‰å¤–æ–‡ç¼©å†™å¯ä»¥ä½¿ç”¨åŠè§’åœ†ç‚¹(.)è¡¨ç¤ºç¼©å†™ã€‚ U.S.A. Apple, Inc. ï¼ˆ3ï¼‰è¡¨ç¤ºä¸­æ–‡æ—¶ï¼Œè‹±æ–‡çœç•¥å·ï¼ˆ...ï¼‰åº”æ”¹ä¸ºä¸­æ–‡çœç•¥å·ï¼ˆâ‹¯â‹¯ï¼‰ã€‚ è‹±æ–‡ï¼š5 minutes later... ä¸­æ–‡ï¼š5 åˆ†é’Ÿè¿‡å»äº†â‹¯â‹¯ ï¼ˆ4ï¼‰è‹±æ–‡ä¹¦åæˆ–ç”µå½±åæ”¹ç”¨ä¸­æ–‡è¡¨è¾¾æ—¶ï¼ŒåŒå¼•å·åº”æ”¹ä¸ºä¹¦åå·ã€‚ è‹±æ–‡ï¼šHe published an article entitled \"The Future of the Aviation\". ä¸­æ–‡ï¼šä»–å‘è¡¨äº†ä¸€ç¯‡åä¸ºã€Šèˆªç©ºä¸šçš„æœªæ¥ã€‹çš„æ–‡ç« ã€‚ ï¼ˆ5ï¼‰ç¬¬ä¸€æ¬¡å‡ºç°è‹±æ–‡è¯æ±‡æ—¶ï¼Œåœ¨æ‹¬å·ä¸­ç»™å‡ºä¸­æ–‡æ ‡æ³¨ã€‚æ­¤åå†æ¬¡å‡ºç°æ—¶ï¼Œç›´æ¥ä½¿ç”¨è‹±æ–‡ç¼©å†™å³å¯ã€‚ IOCï¼ˆInternational Olympic Committeeï¼Œå›½é™…å¥¥æ—åŒ¹å…‹å§”å‘˜ä¼šï¼‰ã€‚è¿™æ ·å®šä¹‰åï¼Œä¾¿å¯ä»¥ç›´æ¥ä½¿ç”¨â€œIOCâ€äº†ã€‚ ï¼ˆ6ï¼‰ä¸“æœ‰åè¯ä¸­æ¯ä¸ªè¯ç¬¬ä¸€ä¸ªå­—æ¯å‡åº”å¤§å†™ï¼Œéä¸“æœ‰åè¯åˆ™ä¸éœ€è¦å¤§å†™ã€‚ â€œAmerican Association of Physicists in Medicineâ€ï¼ˆç¾å›½åŒ»å­¦ç‰©ç†å­¦å®¶åä¼šï¼‰æ˜¯ä¸“æœ‰åè¯ï¼Œéœ€è¦å¤§å†™ã€‚ â€œonline transaction processingâ€ï¼ˆåœ¨çº¿äº‹åŠ¡å¤„ç†ï¼‰ä¸æ˜¯ä¸“æœ‰åè¯ï¼Œä¸åº”å¤§å†™ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:2:4","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ®µè½ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:3:0","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"åŸåˆ™ ä¸€ä¸ªæ®µè½åªèƒ½æœ‰ä¸€ä¸ªä¸»é¢˜ï¼Œæˆ–ä¸€ä¸ªä¸­å¿ƒå¥å­ã€‚ æ®µè½çš„ä¸­å¿ƒå¥å­æ”¾åœ¨æ®µé¦–ï¼Œå¯¹å…¨æ®µå†…å®¹è¿›è¡Œæ¦‚è¿°ã€‚åé¢é™ˆè¿°çš„å¥å­ä¸ºä¸­å¿ƒå¥å­æœåŠ¡ã€‚ ä¸€ä¸ªæ®µè½çš„é•¿åº¦ä¸èƒ½è¶…è¿‡ä¸ƒè¡Œï¼Œæœ€ä½³æ®µè½é•¿åº¦å°äºç­‰äºå››è¡Œã€‚ æ®µè½çš„å¥å­è¯­æ°”è¦ä½¿ç”¨é™ˆè¿°å’Œè‚¯å®šè¯­æ°”ï¼Œé¿å…ä½¿ç”¨æ„Ÿå¹è¯­æ°”ã€‚ æ®µè½ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªç©ºè¡Œéš”å¼€ã€‚ æ®µè½å¼€å¤´ä¸è¦ç•™å‡ºç©ºç™½å­—ç¬¦ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:3:1","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å¼•ç”¨ å¼•ç”¨ç¬¬ä¸‰æ–¹å†…å®¹æ—¶ï¼Œåº”æ³¨æ˜å‡ºå¤„ã€‚ One manâ€™s constant is another manâ€™s variable. â€” Alan Perlis å¦‚æœæ˜¯å…¨ç¯‡è½¬è½½ï¼Œè¯·åœ¨å…¨æ–‡å¼€å¤´æ˜¾è‘—ä½ç½®æ³¨æ˜ä½œè€…å’Œå‡ºå¤„ï¼Œå¹¶é“¾æ¥è‡³åŸæ–‡ã€‚ æœ¬æ–‡è½¬è½½è‡ª WikiQuote ä½¿ç”¨å¤–éƒ¨å›¾ç‰‡æ—¶ï¼Œå¿…é¡»åœ¨å›¾ç‰‡ä¸‹æ–¹æˆ–æ–‡æœ«æ ‡æ˜æ¥æºã€‚ æœ¬æ–‡éƒ¨åˆ†å›¾ç‰‡æ¥è‡ª Wikipedia ","date":"2023-02-04","objectID":"/posts/document-style-guide/:3:2","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ•°å€¼ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:4:0","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"åŠè§’æ•°å­— é˜¿æ‹‰ä¼¯æ•°å­—ä¸€å¾‹ä½¿ç”¨åŠè§’å½¢å¼ï¼Œä¸å¾—ä½¿ç”¨å…¨è§’å½¢å¼ã€‚ é”™è¯¯ï¼šè¿™ä»¶å•†å“çš„ä»·æ ¼æ˜¯ï¼‘ï¼ï¼ï¼å…ƒã€‚ æ­£ç¡®ï¼šè¿™ä»¶å•†å“çš„ä»·æ ¼æ˜¯ 1000 å…ƒã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:4:1","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"åƒåˆ†å· æ•°å€¼ä¸ºåƒä½ä»¥ä¸Šï¼Œåº”æ·»åŠ åƒåˆ†å·ï¼ˆåŠè§’é€—å·ï¼‰ã€‚ XXX å…¬å¸çš„å®æ”¶èµ„æœ¬ä¸º ï¿¥1,258,000 äººæ°‘å¸ã€‚ å¯¹äº 4 ä½çš„æ•°å€¼ï¼Œåƒåˆ†å·æ˜¯é€‰ç”¨çš„ï¼Œæ¯”å¦‚1000å’Œ1,000éƒ½å¯ä»¥æ¥å—ã€‚å¯¹äº 4 ä½ä»¥ä¸Šçš„æ•°å€¼ï¼Œåº”æ·»åŠ åƒåˆ†å·ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:4:2","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"è´§å¸ è´§å¸åº”ä¸ºé˜¿æ‹‰ä¼¯æ•°å­—ï¼Œå¹¶åœ¨æ•°å­—å‰å†™å‡ºè´§å¸ç¬¦å·ï¼Œæˆ–åœ¨æ•°å­—åå†™å‡ºè´§å¸ä¸­æ–‡åç§°ã€‚ $1,000 1,000 ç¾å…ƒ è‹±æ–‡çš„è´§å¸åç§°ï¼Œå»ºè®®å‚è€ƒå›½é™…æ ‡å‡† ISO 4217ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:4:3","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ•°å€¼èŒƒå›´ è¡¨ç¤ºæ•°å€¼èŒƒå›´æ—¶ï¼Œç”¨æ³¢æµªçº¿ï¼ˆï½ï¼‰æˆ–ä¸€å­—çº¿ï¼ˆâ€”ï¼‰è¿æ¥ã€‚å‚è§ã€Šæ ‡ç‚¹ç¬¦å·ã€‹ä¸€èŠ‚çš„â€œè¿æ¥å·â€éƒ¨åˆ†ã€‚ å¸¦æœ‰å•ä½æˆ–ç™¾åˆ†å·æ—¶ï¼Œä¸¤ä¸ªæ•°å­—å»ºè®®éƒ½è¦åŠ ä¸Šå•ä½æˆ–ç™¾åˆ†å·ã€‚ 132 kgï½234 kg 67%ï½89% ","date":"2023-02-04","objectID":"/posts/document-style-guide/:4:4","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å˜åŒ–ç¨‹åº¦çš„è¡¨ç¤ºæ³• æ•°å­—çš„å¢åŠ è¦ä½¿ç”¨â€œå¢åŠ äº†â€ã€â€œå¢åŠ åˆ°â€ã€‚â€œäº†â€è¡¨ç¤ºå¢é‡ï¼Œâ€œåˆ°â€è¡¨ç¤ºå®šé‡ã€‚ å¢åŠ åˆ°è¿‡å»çš„ä¸¤å€ ï¼ˆè¿‡å»ä¸ºä¸€ï¼Œç°åœ¨ä¸ºäºŒï¼‰ å¢åŠ äº†ä¸¤å€ ï¼ˆè¿‡å»ä¸ºä¸€ï¼Œç°åœ¨ä¸ºä¸‰ï¼‰ æ•°å­—çš„å‡å°‘è¦ä½¿ç”¨â€œé™ä½äº†â€ã€â€œé™ä½åˆ°â€ã€‚â€œäº†â€è¡¨ç¤ºå¢é‡ï¼Œâ€œåˆ°â€è¡¨ç¤ºå®šé‡ã€‚ é™ä½åˆ°ç™¾åˆ†ä¹‹å…«å ï¼ˆå®šé¢æ˜¯ä¸€ç™¾ï¼Œç°åœ¨æ˜¯å…«åï¼‰ é™ä½äº†ç™¾åˆ†ä¹‹å…«å ï¼ˆåŸæ¥æ˜¯ä¸€ç™¾ï¼Œç°åœ¨æ˜¯äºŒåï¼‰ ä¸èƒ½ç”¨â€œé™ä½ N å€â€æˆ–â€œå‡å°‘ N å€â€çš„è¡¨ç¤ºæ³•ï¼Œè¦ç”¨â€œé™ä½ç™¾åˆ†ä¹‹å‡ â€æˆ–â€œå‡å°‘ç™¾åˆ†ä¹‹å‡ â€ã€‚å› ä¸ºå‡å°‘ï¼ˆæˆ–é™ä½ï¼‰ä¸€å€è¡¨ç¤ºæ•°å€¼åŸæ¥ä¸ºä¸€ç™¾ï¼Œç°åœ¨ç­‰äºé›¶ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:4:5","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ ‡ç‚¹ç¬¦å· ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:0","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"åŸåˆ™ ï¼ˆ1ï¼‰ä¸­æ–‡è¯­å¥çš„æ ‡ç‚¹ç¬¦å·ï¼Œå‡åº”è¯¥é‡‡å–å…¨è§’ç¬¦å·ï¼Œè¿™æ ·å¯ä»¥ä¸å…¨è§’æ–‡å­—ä¿æŒè§†è§‰çš„ä¸€è‡´ã€‚ ï¼ˆ2ï¼‰å¦‚æœæ•´å¥ä¸ºè‹±æ–‡ï¼Œåˆ™è¯¥å¥ä½¿ç”¨è‹±æ–‡/åŠè§’æ ‡ç‚¹ã€‚ ï¼ˆ3ï¼‰å¥å·ã€é—®å·ã€å¹å·ã€é€—å·ã€é¡¿å·ã€åˆ†å·å’Œå†’å·ä¸å¾—å‡ºç°åœ¨ä¸€è¡Œä¹‹é¦–ã€‚ ï¼ˆ4ï¼‰ç‚¹å·ï¼ˆå¥å·ã€é€—å·ã€é¡¿å·ã€åˆ†å·ã€å†’å·ï¼‰ä¸å¾—å‡ºç°åœ¨æ ‡é¢˜çš„æœ«å°¾ï¼Œè€Œæ ‡å·ï¼ˆå¼•å·ã€æ‹¬å·ã€ç ´æŠ˜å·ã€çœç•¥å·ã€ä¹¦åå·ã€ç€é‡å·ã€é—´éš”å·ã€å¹å·ã€é—®å·ï¼‰å¯ä»¥ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:1","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å¥å· ï¼ˆ1ï¼‰ä¸­æ–‡è¯­å¥çš„ç»“å°¾å¤„åº”è¯¥ç”¨å…¨è§’å¥å·ï¼ˆã€‚ï¼‰ã€‚ ï¼ˆ2ï¼‰å¥å­æœ«å°¾ç”¨æ‹¬å·åŠ æ³¨æ—¶ï¼Œå¥å·åº”åœ¨æ‹¬å·ä¹‹å¤–ã€‚ é”™è¯¯ï¼šå…³äºæ–‡ä»¶çš„è¾“å‡ºï¼Œè¯·å‚ç…§ç¬¬ 1.3 èŠ‚ï¼ˆè§ç¬¬ 26 é¡µã€‚ï¼‰ æ­£ç¡®ï¼šå…³äºæ–‡ä»¶çš„è¾“å‡ºï¼Œè¯·å‚ç…§ç¬¬ 1.3 èŠ‚ï¼ˆè§ç¬¬ 26 é¡µï¼‰ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:2","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"é€—å· ï¼ˆ1ï¼‰é€—å·ï¼ˆï¼Œï¼‰è¡¨ç¤ºå¥å­å†…éƒ¨çš„ä¸€èˆ¬æ€§åœé¡¿ã€‚ ï¼ˆ2ï¼‰æ³¨æ„é¿å…â€œä¸€é€—åˆ°åº•â€ï¼Œå³æ•´ä¸ªæ®µè½é™¤äº†ç»“å°¾ï¼Œå…¨éƒ¨åœé¡¿éƒ½ä½¿ç”¨é€—å·ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:3","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"é¡¿å· ï¼ˆ1ï¼‰å¥å­å†…éƒ¨çš„å¹¶åˆ—è¯ï¼Œåº”è¯¥ç”¨å…¨è§’é¡¿å·(ã€) åˆ†éš”ï¼Œè€Œä¸ç”¨é€—å·ï¼Œå³ä½¿å¹¶åˆ—è¯æ˜¯è‹±è¯­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ é”™è¯¯ï¼šæˆ‘æœ€æ¬£èµçš„ç§‘æŠ€å…¬å¸æœ‰ Google, Facebook, è…¾è®¯, é˜¿é‡Œå’Œç™¾åº¦ç­‰ã€‚ æ­£ç¡®ï¼šæˆ‘æœ€æ¬£èµçš„ç§‘æŠ€å…¬å¸æœ‰ Googleã€Facebookã€è…¾è®¯ã€é˜¿é‡Œå’Œç™¾åº¦ç­‰ã€‚ ï¼ˆ2ï¼‰è‹±æ–‡å¥å­ä¸­ï¼Œå¹¶åˆ—è¯è¯­ä¹‹é—´ä½¿ç”¨åŠè§’é€—å·ï¼ˆ,ï¼‰åˆ†éš”ã€‚ ä¾‹å¥ï¼šMicrosoft Office includes Word, Excel, PowerPoint, Outlook and other components. ï¼ˆ3ï¼‰ä¸­æ–‡å¥å­å†…éƒ¨çš„å¹¶åˆ—è¯ï¼Œæœ€åä¸€ä¸ªå°½é‡ä½¿ç”¨ï¼ˆå’Œï¼‰æ¥è¿æ¥ï¼Œä½¿å¥å­è¯»èµ·æ¥æ›´åŠ è¿è´¯ï¼Œä¸‹é¢ä¸¤ä¸ªå¥å­éƒ½å¯ä»¥ï¼Œç¬¬äºŒä¸ªæ›´ä¼˜ã€‚ æ­£ç¡®ï¼šæˆ‘æœ€æ¬£èµçš„ç§‘æŠ€å…¬å¸æœ‰ Googleã€Facebookã€è…¾è®¯ã€é˜¿é‡Œï¼Œä»¥åŠç™¾åº¦ç­‰ã€‚ æ­£ç¡®ï¼šæˆ‘æœ€æ¬£èµçš„ç§‘æŠ€å…¬å¸æœ‰ Googleã€Facebookã€è…¾è®¯ã€é˜¿é‡Œå’Œç™¾åº¦ç­‰ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:4","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"åˆ†å· ï¼ˆ1ï¼‰åˆ†å·ï¼ˆï¼›ï¼‰è¡¨ç¤ºå¤å¥å†…éƒ¨å¹¶åˆ—åˆ†å¥ä¹‹é—´çš„åœé¡¿ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:5","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å¼•å· ï¼ˆ1ï¼‰å¼•ç”¨æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å…¨è§’åŒå¼•å·ï¼ˆâ€œ â€ï¼‰ï¼Œæ³¨æ„å‰ååŒå¼•å·ä¸åŒã€‚ ä¾‹å¥ï¼šè®¸å¤šäººéƒ½è®¤ä¸ºå®¢æˆ·æœåŠ¡çš„æ ¸å¿ƒæ˜¯â€œå‹å¥½â€å’Œâ€œä¸“ä¸šâ€ã€‚ ï¼ˆ2ï¼‰å¼•å·é‡Œé¢è¿˜è¦ç”¨å¼•å·æ—¶ï¼Œå¤–é¢ä¸€å±‚ç”¨åŒå¼•å·ï¼Œé‡Œé¢ä¸€å±‚ç”¨å•å¼•å·ï¼ˆâ€˜ â€™ï¼‰ï¼Œæ³¨æ„å‰åå•å¼•å·ä¸åŒã€‚ ä¾‹å¥ï¼šé²å‹ƒè§£é‡Šé“ï¼šâ€œæˆ‘è¦æ”¾éŸ³ä¹ï¼Œå¯è¨åˆ©è¯´ï¼Œâ€˜ä¸è¡Œï¼â€™ã€‚â€ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:6","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ‹¬å· ï¼ˆ1ï¼‰è¡¥å……è¯´æ˜æ—¶ï¼Œä½¿ç”¨å…¨è§’åœ†æ‹¬å·ï¼ˆï¼ˆï¼‰ï¼‰ï¼Œæ‹¬å·å‰åä¸åŠ ç©ºæ ¼ã€‚ ä¾‹å¥ï¼šè¯·ç¡®è®¤æ‰€æœ‰çš„è¿æ¥ï¼ˆç”µç¼†å’Œæ¥æ’ä»¶ï¼‰å‡å®‰è£…ç‰¢å›ºã€‚ ï¼ˆ2ï¼‰å‡ ç§æ‹¬å·çš„ä¸­è‹±æ–‡åç§°ã€‚ è‹±æ–‡ ä¸­æ–‡ { } braces æˆ– curly brackets å¤§æ‹¬å· [ ] square brackets æˆ– brackets æ–¹æ‹¬å· \u003c \u003e angled brackets å°–æ‹¬å· ( ) parentheses åœ†æ‹¬å· ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:7","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å†’å· ï¼ˆ1ï¼‰å…¨è§’å†’å·ï¼ˆï¼šï¼‰å¸¸ç”¨åœ¨éœ€è¦è§£é‡Šçš„è¯è¯­åè¾¹ï¼Œå¼•å‡ºè§£é‡Šå’Œè¯´æ˜ã€‚ ä¾‹å¥ï¼šè¯·ç¡®è®¤ä»¥ä¸‹å‡ é¡¹å†…å®¹ï¼šæ—¶é—´ã€åœ°ç‚¹ã€æ´»åŠ¨åç§°å’Œæ¥å®¾æ•°é‡ã€‚ ï¼ˆ2ï¼‰è¡¨ç¤ºæ—¶é—´æ—¶ï¼Œåº”ä½¿ç”¨åŠè§’å†’å·ï¼ˆ:ï¼‰ã€‚ ä¾‹å¥ï¼šæ—©ä¸Š 8:00 ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:8","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"çœç•¥å· ï¼ˆ1ï¼‰çœç•¥å·ï¼ˆâ‹¯â‹¯ï¼‰è¡¨ç¤ºè¯­å¥æœªå®Œã€æˆ–è€…è¯­æ°”çš„ä¸è¿ç»­ã€‚ ï¼ˆ2ï¼‰çœç•¥å·å ä¸¤ä¸ªæ±‰å­—ç©ºé—´ã€åŒ…å«å…­ä¸ªçœç•¥ç‚¹ï¼Œä¸è¦ä½¿ç”¨ã€‚ã€‚ã€‚æˆ–...ç­‰éæ ‡å‡†å½¢å¼ã€‚ ï¼ˆ3ï¼‰çœç•¥å·ä¸åº”ä¸â€œç­‰â€è¿™ä¸ªè¯ä¸€èµ·ä½¿ç”¨ã€‚ é”™è¯¯ï¼šæˆ‘ä»¬ä¸ºä¼šé¤å‡†å¤‡äº†é¦™è•‰ã€è‹¹æœã€æ¢¨â€¦ç­‰å„è‰²æ°´æœã€‚ æ­£ç¡®ï¼šæˆ‘ä»¬ä¸ºä¼šé¤å‡†å¤‡äº†å„è‰²æ°´æœï¼Œæœ‰é¦™è•‰ã€è‹¹æœã€æ¢¨â‹¯â‹¯ æ­£ç¡®ï¼šæˆ‘ä»¬ä¸ºä¼šé¤å‡†å¤‡äº†é¦™è•‰ã€è‹¹æœã€æ¢¨ç­‰å„è‰²æ°´æœã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:9","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ„Ÿå¹å· ï¼ˆ1ï¼‰åº”è¯¥ä½¿ç”¨å¹³é™çš„è¯­æ°”å™è¿°ï¼Œå°½é‡é¿å…ä½¿ç”¨æ„Ÿå¹å·ï¼ˆï¼ï¼‰ã€‚ ï¼ˆ2ï¼‰ä¸å¾—å¤šä¸ªæ„Ÿå¹å·è¿ç”¨ï¼Œæ¯”å¦‚ï¼ï¼å’Œ!!!ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:10","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"ç ´æŠ˜å· ï¼ˆ1ï¼‰ç ´æŠ˜å·â€”â€”â€”â€”ä¸€èˆ¬ç”¨äºè¿›ä¸€æ­¥è§£é‡Šã€‚ ï¼ˆ2ï¼‰ç ´æŠ˜å·åº”å ä¸¤ä¸ªæ±‰å­—çš„ä½ç½®ã€‚å¦‚æœç ´æŠ˜å·æœ¬èº«åªå ä¸€ä¸ªæ±‰å­—çš„ä½ç½®ï¼Œé‚£ä¹ˆå‰ååº”è¯¥ç•™å‡ºä¸€ä¸ªåŠè§’ç©ºæ ¼ã€‚ ä¾‹å¥ï¼šç›´è§‰â€”â€”â€”â€”å°½ç®¡å®ƒå¹¶ä¸æ€»æ˜¯å¯é çš„â€”â€”â€”â€”å‘Šè¯‰æˆ‘ï¼Œè¿™äº‹å¯èƒ½å‡ºäº†äº›é—®é¢˜ã€‚ ä¾‹å¥ï¼šç›´è§‰ â€”â€” å°½ç®¡å®ƒå¹¶ä¸æ€»æ˜¯å¯é çš„ â€”â€” å‘Šè¯‰æˆ‘ï¼Œè¿™äº‹å¯èƒ½å‡ºäº†äº›é—®é¢˜ã€‚ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:11","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"è¿æ¥å· ï¼ˆ1ï¼‰è¿æ¥å·ç”¨äºè¿æ¥ä¸¤ä¸ªç±»ä¼¼çš„è¯ã€‚ ï¼ˆ2ï¼‰ä»¥ä¸‹åœºåˆåº”è¯¥ä½¿ç”¨ç›´çº¿è¿æ¥å·ï¼ˆ-ï¼‰ï¼Œå ä¸€ä¸ªåŠè§’å­—ç¬¦çš„ä½ç½®ã€‚ ä¸¤ä¸ªåè¯çš„å¤åˆ å›¾è¡¨ç¼–å· ä¾‹å¥ï¼šæ°§åŒ–-è¿˜åŸååº” ä¾‹å¥ï¼šå›¾ 1-1 ï¼ˆ3ï¼‰æ•°å€¼èŒƒå›´ï¼ˆä¾‹å¦‚æ—¥æœŸã€æ—¶é—´æˆ–æ•°å­—ï¼‰åº”è¯¥ä½¿ç”¨æ³¢æµªè¿æ¥å·ï¼ˆï½ï¼‰æˆ–ä¸€å­—å·ï¼ˆâ€”ï¼‰ï¼Œå ä¸€ä¸ªå…¨è§’å­—ç¬¦çš„ä½ç½®ã€‚ ä¾‹å¥ï¼š2009 å¹´ï½2011 å¹´ æ³¨æ„ï¼Œæ³¢æµªè¿æ¥å·å‰åä¸¤ä¸ªå€¼éƒ½å»ºè®®åŠ ä¸Šå•ä½ã€‚ ï¼ˆ4ï¼‰æ³¢æµªè¿æ¥å·ä¹Ÿå¯ä»¥ç”¨æ±‰å­—â€œè‡³â€ä»£æ›¿ã€‚ ä¾‹å¥ï¼šå‘¨å›´æ¸©åº¦ï¼š-20 Â°C è‡³ -10 Â°C ","date":"2023-02-04","objectID":"/posts/document-style-guide/:5:12","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ–‡æ¡£ä½“ç³» ","date":"2023-02-04","objectID":"/posts/document-style-guide/:6:0","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"ç»“æ„ è½¯ä»¶æ‰‹å†Œæ˜¯ä¸€éƒ¨å®Œæ•´çš„ä¹¦ï¼Œå»ºè®®é‡‡ç”¨ä¸‹é¢çš„ç»“æ„ã€‚ ç®€ä»‹ï¼ˆIntroductionï¼‰ï¼š[å¿…å¤‡] [æ–‡ä»¶] æä¾›å¯¹äº§å“å’Œæ–‡æ¡£æœ¬èº«çš„æ€»ä½“çš„ã€æ‰¼è¦çš„è¯´æ˜ å¿«é€Ÿä¸Šæ‰‹ï¼ˆGetting Startedï¼‰ï¼š[å¯é€‰] [æ–‡ä»¶] å¦‚ä½•æœ€å¿«é€Ÿåœ°ä½¿ç”¨äº§å“ å…¥é—¨ç¯‡ï¼ˆBasicsï¼‰ï¼š[å¿…å¤‡] [ç›®å½•] åˆç§°â€œä½¿ç”¨ç¯‡â€ï¼Œæä¾›åˆçº§çš„ä½¿ç”¨æ•™ç¨‹ ç¯å¢ƒå‡†å¤‡ï¼ˆPrerequisiteï¼‰ï¼š[å¿…å¤‡] [æ–‡ä»¶] è½¯ä»¶ä½¿ç”¨éœ€è¦æ»¡è¶³çš„å‰ç½®æ¡ä»¶ å®‰è£…ï¼ˆInstallationï¼‰ï¼š[å¯é€‰] [æ–‡ä»¶] è½¯ä»¶çš„å®‰è£…æ–¹æ³• è®¾ç½®ï¼ˆConfigurationï¼‰ï¼š[å¿…å¤‡] [æ–‡ä»¶] è½¯ä»¶çš„è®¾ç½® è¿›é˜¶ç¯‡ï¼ˆAdvanced)ï¼š[å¯é€‰] [ç›®å½•] åˆç§°â€œå¼€å‘ç¯‡â€ï¼Œæä¾›ä¸­é«˜çº§çš„å¼€å‘æ•™ç¨‹ APIï¼ˆReferenceï¼‰ï¼š[å¯é€‰] [ç›®å½•|æ–‡ä»¶] è½¯ä»¶ API çš„é€ä¸€ä»‹ç» FAQï¼š[å¯é€‰] [æ–‡ä»¶] å¸¸è§é—®é¢˜è§£ç­” é™„å½•ï¼ˆAppendixï¼‰ï¼š[å¯é€‰] [ç›®å½•] ä¸å±äºæ•™ç¨‹æœ¬èº«ã€ä½†å¯¹é˜…è¯»æ•™ç¨‹æœ‰å¸®åŠ©çš„å†…å®¹ Glossaryï¼š[å¯é€‰] [æ–‡ä»¶] åè¯è§£é‡Š Recipesï¼š[å¯é€‰] [æ–‡ä»¶] æœ€ä½³å®è·µ Troubleshootingï¼š[å¯é€‰] [æ–‡ä»¶] æ•…éšœå¤„ç† ChangeLogï¼š[å¯é€‰] [æ–‡ä»¶] ç‰ˆæœ¬è¯´æ˜ Feedbackï¼š[å¯é€‰] [æ–‡ä»¶] åé¦ˆæ–¹å¼ ä¸‹é¢æ˜¯ä¸¤ä¸ªçœŸå®èŒƒä¾‹ï¼Œå¯å‚è€ƒã€‚ Redux æ‰‹å†Œ Atom æ‰‹å†Œ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:6:1","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"æ–‡ä»¶å æ–‡æ¡£çš„æ–‡ä»¶åä¸å¾—å«æœ‰ç©ºæ ¼ã€‚ æ–‡ä»¶åå¿…é¡»ä½¿ç”¨åŠè§’å­—ç¬¦ï¼Œä¸å¾—ä½¿ç”¨å…¨è§’å­—ç¬¦ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œä¸­æ–‡ä¸èƒ½ç”¨äºæ–‡ä»¶åã€‚ é”™è¯¯ï¼šåè¯è§£é‡Š.md æ­£ç¡®ï¼šglossary.md æ–‡ä»¶åå»ºè®®åªä½¿ç”¨å°å†™å­—æ¯ï¼Œä¸ä½¿ç”¨å¤§å†™å­—æ¯ã€‚ é”™è¯¯ï¼šTroubleShooting.md æ­£ç¡®ï¼štroubleshooting.md ä¸ºäº†é†’ç›®ï¼ŒæŸäº›è¯´æ˜æ–‡ä»¶çš„æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨å¤§å†™å­—æ¯ï¼Œæ¯”å¦‚READMEã€LICENSEã€‚ æ–‡ä»¶ååŒ…å«å¤šä¸ªå•è¯æ—¶ï¼Œå•è¯ä¹‹é—´å»ºè®®ä½¿ç”¨åŠè§’çš„è¿è¯çº¿ï¼ˆ-ï¼‰åˆ†éš”ã€‚ ä¸ä½³ï¼šadvanced_usage.md æ­£ç¡®ï¼šadvanced-usage.md ","date":"2023-02-04","objectID":"/posts/document-style-guide/:6:2","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Spec"],"content":"å‚è€ƒé“¾æ¥ äº§å“æ‰‹å†Œä¸­æ–‡å†™ä½œè§„èŒƒ, by åä¸º å†™ä½œè§„èŒƒå’Œæ ¼å¼è§„èŒƒ, by DaoCloud æŠ€æœ¯å†™ä½œæŠ€å·§åœ¨æ—¥æ±‰ç¿»è¯‘ä¸­çš„åº”ç”¨, by åˆ˜æ–¹ ç®€ä½“ä¸­æ–‡è§„èŒƒæŒ‡å—, by lengoo æ–‡æ¡£é£æ ¼æŒ‡å—, by LeanCloud è±Œè±†èšæ–‡æ¡ˆé£æ ¼æŒ‡å—, by è±Œè±†èš ä¸­æ–‡æ–‡æ¡ˆæ’ç‰ˆæŒ‡åŒ—, by sparanoid ä¸­æ–‡æ’ç‰ˆéœ€æ±‚, by W3C ä¸ºä»€ä¹ˆæ–‡ä»¶åè¦å°å†™ï¼Ÿ, by é˜®ä¸€å³° Google Developer Documentation Style Guide, by Google å‡ºç‰ˆç‰©ä¸Šæ•°å­—ç”¨æ³•çš„è§„å®šï¼ˆå›½å®¶æ ‡å‡† GBT15835ï¼2011ï¼‰ GB 3100-1993 å›½é™…å•ä½åˆ¶åŠå…¶åº”ç”¨ markdownlint, VSCode æ’ä»¶ pangu.js, ç›˜å¤ä¹‹ç™½ç³»åˆ—æ’ä»¶ ","date":"2023-02-04","objectID":"/posts/document-style-guide/:7:0","tags":null,"title":"ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ","uri":"/posts/document-style-guide/"},{"categories":["Browser"],"content":"æœ€è¿‘åœ¨æŠ–éŸ³ä¸Šåˆ·åˆ°å¾ˆå¤šæ¬¡ è¢è¿›è€å¸ˆ çš„å‰ç«¯è§†é¢‘ï¼Œç„¶åå°±å¬äº†ä¸€ä¸‹ä»–çš„å‰ç«¯å¤§å¸ˆè¯¾ï¼Œæ„Ÿè§‰äº†è§£ä¸€äº›æµè§ˆå™¨åŸç†åï¼ŒåŸæ¥å·¥ä½œä¸­çš„ä¸€äº›ç–‘é—®ä¹Ÿè‡ªç„¶è§£å¼€äº†ã€‚ ","date":"2023-01-11","objectID":"/posts/event-loop/:0:0","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Browser"],"content":"æµè§ˆå™¨çš„è¿›ç¨‹æ¨¡å‹ ","date":"2023-01-11","objectID":"/posts/event-loop/:1:0","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Browser"],"content":"ä½•ä¸ºè¿›ç¨‹ï¼Ÿ ç¨‹åºè¿è¡Œéœ€è¦æœ‰å®ƒè‡ªå·±ä¸“å±çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥æŠŠè¿™å—å†…å­˜ç©ºé—´ç®€å•çš„ç†è§£ä¸ºè¿›ç¨‹ è¿›ç¨‹ æ¯ä¸ªåº”ç”¨è‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿›ç¨‹ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œå³ä½¿è¦é€šä¿¡ï¼Œä¹Ÿéœ€è¦åŒæ–¹åŒæ„ã€‚ ","date":"2023-01-11","objectID":"/posts/event-loop/:1:1","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Browser"],"content":"ä½•ä¸ºçº¿ç¨‹ï¼Ÿ æœ‰äº†è¿›ç¨‹åï¼Œå°±å¯ä»¥è¿è¡Œç¨‹åºçš„ä»£ç äº†ã€‚ è¿è¡Œä»£ç çš„ã€Œäººã€ç§°ä¹‹ä¸ºã€Œçº¿ç¨‹ã€ã€‚ ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥åœ¨è¿›ç¨‹å¼€å¯åä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥è¿è¡Œä»£ç ï¼Œè¯¥çº¿ç¨‹ç§°ä¹‹ä¸ºä¸»çº¿ç¨‹ã€‚ å¦‚æœç¨‹åºéœ€è¦åŒæ—¶æ‰§è¡Œå¤šå—ä»£ç ï¼Œä¸»çº¿ç¨‹å°±ä¼šå¯åŠ¨æ›´å¤šçš„çº¿ç¨‹æ¥æ‰§è¡Œä»£ç ï¼Œæ‰€ä»¥ä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ã€‚ çº¿ç¨‹ ","date":"2023-01-11","objectID":"/posts/event-loop/:1:2","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Browser"],"content":"æµè§ˆå™¨æœ‰å“ªäº›è¿›ç¨‹å’Œçº¿ç¨‹ï¼Ÿ æµè§ˆå™¨æ˜¯ä¸€ä¸ªå¤šè¿›ç¨‹å¤šçº¿ç¨‹çš„åº”ç”¨ç¨‹åºï¼Œæµè§ˆå™¨å†…éƒ¨å·¥ä½œæå…¶å¤æ‚ã€‚ ä¸ºäº†é¿å…ç›¸äº’å½±å“ï¼Œä¸ºäº†å‡å°‘è¿ç¯å´©æºƒçš„å‡ ç‡ï¼Œå½“å¯åŠ¨æµè§ˆå™¨åï¼Œå®ƒä¼šè‡ªåŠ¨å¯åŠ¨å¤šä¸ªè¿›ç¨‹ã€‚ æµè§ˆå™¨è¿›ç¨‹ å¯ä»¥åœ¨æµè§ˆå™¨çš„ä»»åŠ¡ç®¡ç†å™¨ä¸­æŸ¥çœ‹å½“å‰çš„æ‰€æœ‰è¿›ç¨‹ å…¶ä¸­ï¼Œæœ€ä¸»è¦çš„è¿›ç¨‹æœ‰ï¼š æµè§ˆå™¨è¿›ç¨‹ ä¸»è¦è´Ÿè´£ç•Œé¢æ˜¾ç¤ºã€ç”¨æˆ·äº¤äº’ã€å­è¿›ç¨‹ç®¡ç†ç­‰ã€‚æµè§ˆå™¨è¿›ç¨‹å†…éƒ¨ä¼šå¯åŠ¨å¤šä¸ªçº¿ç¨‹å¤„ç†ä¸åŒçš„ä»»åŠ¡ã€‚ ç½‘ç»œè¿›ç¨‹ è´Ÿè´£åŠ è½½ç½‘ç»œèµ„æºã€‚ç½‘ç»œè¿›ç¨‹å†…éƒ¨ä¼šå¯åŠ¨å¤šä¸ªçº¿ç¨‹æ¥å¤„ç†ä¸åŒçš„ç½‘ç»œä»»åŠ¡ã€‚ æ¸²æŸ“è¿›ç¨‹ï¼ˆæœ¬ç¯‡é‡ç‚¹è®²è§£çš„è¿›ç¨‹ï¼‰ æ¸²æŸ“è¿›ç¨‹å¯åŠ¨åï¼Œä¼šå¼€å¯ä¸€ä¸ªæ¸²æŸ“ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹è´Ÿè´£æ‰§è¡Œ HTMLã€CSSã€JS ä»£ç ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šä¸ºæ¯ä¸ªæ ‡ç­¾é¡µå¼€å¯ä¸€ä¸ªæ–°çš„æ¸²æŸ“è¿›ç¨‹ï¼Œä»¥ä¿è¯ä¸åŒçš„æ ‡ç­¾é¡µä¹‹é—´ä¸ç›¸äº’å½±å“ã€‚ å°†æ¥è¯¥é»˜è®¤æ¨¡å¼å¯èƒ½ä¼šæœ‰æ‰€æ”¹å˜ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯å‚è§ chrome å®˜æ–¹è¯´æ˜æ–‡æ¡£ ","date":"2023-01-11","objectID":"/posts/event-loop/:1:3","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Browser"],"content":"æ¸²æŸ“ä¸»çº¿ç¨‹æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ æ¸²æŸ“ä¸»çº¿ç¨‹æ˜¯æµè§ˆå™¨ä¸­æœ€ç¹å¿™çš„çº¿ç¨‹ï¼Œéœ€è¦å®ƒå¤„ç†çš„ä»»åŠ¡åŒ…æ‹¬ä½†ä¸é™äºï¼š è§£æ HTML è§£æ CSS è®¡ç®—æ ·å¼ å¸ƒå±€ å¤„ç†å›¾å±‚ æ¯ç§’æŠŠé¡µé¢ç”» 60 æ¬¡ æ‰§è¡Œå…¨å±€ JS ä»£ç  æ‰§è¡Œäº‹ä»¶å¤„ç†å‡½æ•° æ‰§è¡Œè®¡æ—¶å™¨çš„å›è°ƒå‡½æ•° â€¦â€¦ æ€è€ƒé¢˜ï¼šä¸ºä»€ä¹ˆæ¸²æŸ“è¿›ç¨‹ä¸é€‚ç”¨å¤šä¸ªçº¿ç¨‹æ¥å¤„ç†è¿™äº›äº‹æƒ…ï¼Ÿ è¦å¤„ç†è¿™ä¹ˆå¤šçš„ä»»åŠ¡ï¼Œä¸»çº¿ç¨‹é‡åˆ°äº†ä¸€ä¸ªå‰æ‰€æœªæœ‰çš„éš¾é¢˜ï¼šå¦‚ä½•è°ƒåº¦ä»»åŠ¡ï¼Ÿ æ¯”å¦‚ï¼š æˆ‘æ­£åœ¨æ‰§è¡Œä¸€ä¸ª JS å‡½æ•°ï¼Œæ‰§è¡Œåˆ°ä¸€åŠçš„æ—¶å€™ç”¨æˆ·ç‚¹å‡»äº†æŒ‰é’®ï¼Œæˆ‘è¯¥ç«‹å³å»æ‰§è¡Œç‚¹å‡»äº‹ä»¶çš„å¤„ç†å‡½æ•°å—ï¼Ÿ æˆ‘æ­£åœ¨æ‰§è¡Œä¸€ä¸ª JS å‡½æ•°ï¼Œæ‰§è¡Œåˆ°ä¸€åŠçš„æ—¶å€™æŸä¸ªè®¡æ—¶å™¨åˆ°è¾¾äº†æ—¶é—´ï¼Œæˆ‘è¯¥ç«‹å³å»æ‰§è¡Œå®ƒçš„å›è°ƒå—ï¼Ÿ æµè§ˆå™¨è¿›ç¨‹é€šçŸ¥æˆ‘â€œç”¨æˆ·ç‚¹å‡»äº†æŒ‰é’®â€ï¼Œä¸æ­¤åŒæ—¶ï¼ŒæŸä¸ªè®¡æ—¶å™¨ä¹Ÿåˆ°è¾¾äº†æ—¶é—´ï¼Œæˆ‘åº”è¯¥å¤„ç†å“ªä¸€ä¸ªå‘¢ï¼Ÿ â€¦â€¦ æ¸²æŸ“ä¸»çº¿ç¨‹æƒ³å‡ºäº†ä¸€ä¸ªç»å¦™çš„ä¸»æ„æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼šæ’é˜Ÿ æ¶ˆæ¯é˜Ÿåˆ— åœ¨æœ€å¼€å§‹çš„æ—¶å€™ï¼Œæ¸²æŸ“ä¸»çº¿ç¨‹ä¼šè¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯ æ¯ä¸€æ¬¡å¾ªç¯ä¼šæ£€æŸ¥æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ä»»åŠ¡å­˜åœ¨ã€‚å¦‚æœæœ‰ï¼Œå°±å–å‡ºç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œï¼Œæ‰§è¡Œå®Œä¸€ä¸ªåè¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™è¿›å…¥ä¼‘çœ çŠ¶æ€ã€‚ å…¶ä»–æ‰€æœ‰çº¿ç¨‹ï¼ˆåŒ…æ‹¬å…¶ä»–è¿›ç¨‹çš„çº¿ç¨‹ï¼‰å¯ä»¥éšæ—¶å‘æ¶ˆæ¯é˜Ÿåˆ—æ·»åŠ ä»»åŠ¡ã€‚æ–°ä»»åŠ¡ä¼šåŠ åˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„æœ«å°¾ã€‚åœ¨æ·»åŠ æ–°ä»»åŠ¡æ—¶ï¼Œå¦‚æœä¸»çº¿ç¨‹æ˜¯ä¼‘çœ çŠ¶æ€ï¼Œåˆ™ä¼šå°†å…¶å”¤é†’ä»¥ç»§ç»­å¾ªç¯æ‹¿å–ä»»åŠ¡ è¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥è®©æ¯ä¸ªä»»åŠ¡æœ‰æ¡ä¸ç´Šçš„ã€æŒç»­çš„è¿›è¡Œä¸‹å»äº†ã€‚æ•´ä¸ªè¿‡ç¨‹ï¼Œè¢«ç§°ä¹‹ä¸ºäº‹ä»¶å¾ªç¯ï¼ˆæ¶ˆæ¯å¾ªç¯ï¼‰ã€‚ ","date":"2023-01-11","objectID":"/posts/event-loop/:2:0","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Browser"],"content":"è‹¥å¹²è§£é‡Š ","date":"2023-01-11","objectID":"/posts/event-loop/:3:0","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Browser"],"content":"ä½•ä¸ºå¼‚æ­¥ï¼Ÿ ä»£ç åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šé‡åˆ°ä¸€äº›æ— æ³•ç«‹å³å¤„ç†çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ï¼š è®¡æ—¶å®Œæˆåéœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ â€”â€” setTimeoutã€setInterval ç½‘ç»œé€šä¿¡å®Œæˆåéœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ â€“ XHRã€Fetch ç”¨æˆ·æ“ä½œåéœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ â€“ addEventListener å¦‚æœè®©æ¸²æŸ“ä¸»çº¿ç¨‹ç­‰å¾…è¿™äº›ä»»åŠ¡çš„æ—¶æœºè¾¾åˆ°ï¼Œå°±ä¼šå¯¼è‡´ä¸»çº¿ç¨‹é•¿æœŸå¤„äºã€Œé˜»å¡ã€çš„çŠ¶æ€ï¼Œä»è€Œå¯¼è‡´æµè§ˆå™¨ã€Œå¡æ­»ã€ åŒæ­¥ç­–ç•¥ æ¸²æŸ“ä¸»çº¿ç¨‹æ‰¿æ‹…ç€æå…¶é‡è¦çš„å·¥ä½œï¼Œæ— è®ºå¦‚ä½•éƒ½ä¸èƒ½é˜»å¡ï¼ å› æ­¤ï¼Œæµè§ˆå™¨é€‰æ‹©å¼‚æ­¥æ¥è§£å†³è¿™ä¸ªé—®é¢˜ å¼‚æ­¥ç­–ç•¥ ä½¿ç”¨å¼‚æ­¥çš„æ–¹å¼ï¼Œæ¸²æŸ“ä¸»çº¿ç¨‹æ°¸ä¸é˜»å¡ é¢è¯•é¢˜ï¼šå¦‚ä½•ç†è§£ JS çš„å¼‚æ­¥ï¼Ÿ å‚è€ƒç­”æ¡ˆï¼š JS æ˜¯ä¸€é—¨å•çº¿ç¨‹çš„è¯­è¨€ï¼Œè¿™æ˜¯å› ä¸ºå®ƒè¿è¡Œåœ¨æµè§ˆå™¨çš„æ¸²æŸ“ä¸»çº¿ç¨‹ä¸­ï¼Œè€Œæ¸²æŸ“ä¸»çº¿ç¨‹åªæœ‰ä¸€ä¸ªã€‚ è€Œæ¸²æŸ“ä¸»çº¿ç¨‹æ‰¿æ‹…ç€è¯¸å¤šçš„å·¥ä½œï¼Œæ¸²æŸ“é¡µé¢ã€æ‰§è¡Œ JS éƒ½åœ¨å…¶ä¸­è¿è¡Œã€‚ å¦‚æœä½¿ç”¨åŒæ­¥çš„æ–¹å¼ï¼Œå°±ææœ‰å¯èƒ½å¯¼è‡´ä¸»çº¿ç¨‹äº§ç”Ÿé˜»å¡ï¼Œä»è€Œå¯¼è‡´æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„å¾ˆå¤šå…¶ä»–ä»»åŠ¡æ— æ³•å¾—åˆ°æ‰§è¡Œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸€æ–¹é¢ä¼šå¯¼è‡´ç¹å¿™çš„ä¸»çº¿ç¨‹ç™½ç™½çš„æ¶ˆè€—æ—¶é—´ï¼Œå¦ä¸€æ–¹é¢å¯¼è‡´é¡µé¢æ— æ³•åŠæ—¶æ›´æ–°ï¼Œç»™ç”¨æˆ·é€ æˆå¡æ­»ç°è±¡ã€‚ æ‰€ä»¥æµè§ˆå™¨é‡‡ç”¨å¼‚æ­¥çš„æ–¹å¼æ¥é¿å…ã€‚å…·ä½“åšæ³•æ˜¯å½“æŸäº›ä»»åŠ¡å‘ç”Ÿæ—¶ï¼Œæ¯”å¦‚è®¡æ—¶å™¨ã€ç½‘ç»œã€äº‹ä»¶ç›‘å¬ï¼Œä¸»çº¿ç¨‹å°†ä»»åŠ¡äº¤ç»™å…¶ä»–çº¿ç¨‹å»å¤„ç†ï¼Œè‡ªèº«ç«‹å³ç»“æŸä»»åŠ¡çš„æ‰§è¡Œï¼Œè½¬è€Œæ‰§è¡Œåç»­ä»£ç ã€‚å½“å…¶ä»–çº¿ç¨‹å®Œæˆæ—¶ï¼Œå°†äº‹å…ˆä¼ é€’çš„å›è°ƒå‡½æ•°åŒ…è£…æˆä»»åŠ¡ï¼ŒåŠ å…¥åˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„æœ«å°¾æ’é˜Ÿï¼Œç­‰å¾…ä¸»çº¿ç¨‹è°ƒåº¦æ‰§è¡Œã€‚ åœ¨è¿™ç§å¼‚æ­¥æ¨¡å¼ä¸‹ï¼Œæµè§ˆå™¨æ°¸ä¸é˜»å¡ï¼Œä»è€Œæœ€å¤§é™åº¦çš„ä¿è¯äº†å•çº¿ç¨‹çš„æµç•…è¿è¡Œã€‚ ","date":"2023-01-11","objectID":"/posts/event-loop/:3:1","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Browser"],"content":"JS ä¸ºä½•ä¼šé˜»ç¢æ¸²æŸ“ï¼Ÿ å…ˆçœ‹ä»£ç  \u003ch1\u003eMr.Yuan is awesome!\u003c/h1\u003e \u003cbutton\u003echange\u003c/button\u003e \u003cscript\u003e var h1 = document.querySelector('h1'); var btn = document.querySelector('button'); // æ­»å¾ªç¯æŒ‡å®šçš„æ—¶é—´ function delay(duration) { var start = Date.now(); while (Date.now() - start \u003c duration) {} } btn.onclick = function () { h1.textContent = 'è¢è€å¸ˆå¾ˆå¸…ï¼'; delay(3000); }; \u003c/script\u003e ç‚¹å‡»æŒ‰é’®åï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ \u003cå¤åˆ¶ä»£ç è‡ªè¡Œæ¼”ç¤º\u003e ","date":"2023-01-11","objectID":"/posts/event-loop/:3:2","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Browser"],"content":"ä»»åŠ¡æœ‰ä¼˜å…ˆçº§å—ï¼Ÿ ä»»åŠ¡æ²¡æœ‰ä¼˜å…ˆçº§ï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­å…ˆè¿›å…ˆå‡º ä½†æ¶ˆæ¯é˜Ÿåˆ—æ˜¯æœ‰ä¼˜å…ˆçº§çš„ æ ¹æ® W3C çš„æœ€æ–°è§£é‡Šï¼š æ¯ä¸ªä»»åŠ¡éƒ½æœ‰ä¸€ä¸ªä»»åŠ¡ç±»å‹ï¼ŒåŒä¸€ä¸ªç±»å‹çš„ä»»åŠ¡å¿…é¡»åœ¨ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸åŒç±»å‹çš„ä»»åŠ¡å¯ä»¥åˆ†å±äºä¸åŒçš„é˜Ÿåˆ—ã€‚ åœ¨ä¸€æ¬¡äº‹ä»¶å¾ªç¯ä¸­ï¼Œæµè§ˆå™¨å¯ä»¥æ ¹æ®å®é™…æƒ…å†µä»ä¸åŒçš„é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ‰§è¡Œã€‚ æµè§ˆå™¨å¿…é¡»å‡†å¤‡å¥½ä¸€ä¸ªå¾®é˜Ÿåˆ—ï¼Œå¾®é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ä¼˜å…ˆæ‰€æœ‰å…¶ä»–ä»»åŠ¡æ‰§è¡Œ https://html.spec.whatwg.org/multipage/webappapis.html#perform-a-microtask-checkpoint éšç€æµè§ˆå™¨çš„å¤æ‚åº¦æ€¥å‰§æå‡ï¼ŒW3C ä¸å†ä½¿ç”¨å®é˜Ÿåˆ—çš„è¯´æ³• åœ¨ç›®å‰ chrome çš„å®ç°ä¸­ï¼Œè‡³å°‘åŒ…å«äº†ä¸‹é¢çš„é˜Ÿåˆ—ï¼š å¾®é˜Ÿåˆ—ï¼šç”¨æˆ·å­˜æ”¾éœ€è¦æœ€å¿«æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä¼˜å…ˆçº§ã€Œæœ€é«˜ã€ å»¶æ—¶é˜Ÿåˆ—ï¼šç”¨äºå­˜æ”¾è®¡æ—¶å™¨åˆ°è¾¾åçš„å›è°ƒä»»åŠ¡ï¼Œä¼˜å…ˆçº§ã€Œä¸­ã€ äº¤äº’é˜Ÿåˆ—ï¼šç”¨äºå­˜æ”¾ç”¨æˆ·æ“ä½œåäº§ç”Ÿçš„äº‹ä»¶å¤„ç†ä»»åŠ¡ï¼Œä¼˜å…ˆçº§ã€Œé«˜ã€ å¤šé˜Ÿåˆ—æ¼”ç¤ºå›¾ æ·»åŠ ä»»åŠ¡åˆ°å¾®é˜Ÿåˆ—çš„ä¸»è¦æ–¹å¼ä¸»è¦æ˜¯ä½¿ç”¨ Promiseã€MutationObserverï¼Œä¾‹å¦‚ï¼š // ç«‹å³æŠŠä¸€ä¸ªå‡½æ•°æ·»åŠ åˆ°å¾®é˜Ÿåˆ— Promise.resolve().then(() =\u003e {}); æµè§ˆå™¨è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„é˜Ÿåˆ—ï¼Œç”±äºå’Œæˆ‘ä»¬å¼€å‘å…³ç³»ä¸å¤§ï¼Œä¸ä½œè€ƒè™‘ã€‚ é¢è¯•é¢˜ï¼šé˜è¿°ä¸€ä¸‹ JS çš„äº‹ä»¶å¾ªç¯ å‚è€ƒç­”æ¡ˆï¼š äº‹ä»¶å¾ªç¯åˆå«åšæ¶ˆæ¯å¾ªç¯ï¼Œæ˜¯æµè§ˆå™¨æ¸²æŸ“ä¸»çº¿ç¨‹çš„å·¥ä½œæ–¹å¼ã€‚ åœ¨ Chrome çš„æºç ä¸­ï¼Œå®ƒå¼€å¯ä¸€ä¸ªä¸ä¼šç»“æŸçš„ for å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œï¼Œè€Œå…¶ä»–çº¿ç¨‹åªéœ€è¦åœ¨åˆé€‚çš„æ—¶å€™å°†ä»»åŠ¡åŠ å…¥åˆ°é˜Ÿåˆ—æœ«å°¾å³å¯ã€‚ è¿‡å»æŠŠæ¶ˆæ¯é˜Ÿåˆ—ç®€å•åˆ†ä¸ºå®é˜Ÿåˆ—å’Œå¾®é˜Ÿåˆ—ï¼Œè¿™ç§è¯´æ³•ç›®å‰å·²æ— æ³•æ»¡è¶³å¤æ‚çš„æµè§ˆå™¨ç¯å¢ƒï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¸€ç§æ›´åŠ çµæ´»å¤šå˜çš„å¤„ç†æ–¹å¼ã€‚ æ ¹æ® W3C å®˜æ–¹çš„è§£é‡Šï¼Œæ¯ä¸ªä»»åŠ¡æœ‰ä¸åŒçš„ç±»å‹ï¼ŒåŒç±»å‹çš„ä»»åŠ¡å¿…é¡»åœ¨åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸åŒçš„ä»»åŠ¡å¯ä»¥å±äºä¸åŒçš„é˜Ÿåˆ—ã€‚ä¸åŒä»»åŠ¡é˜Ÿåˆ—æœ‰ä¸åŒçš„ä¼˜å…ˆçº§ï¼Œåœ¨ä¸€æ¬¡äº‹ä»¶å¾ªç¯ä¸­ï¼Œç”±æµè§ˆå™¨è‡ªè¡Œå†³å®šå–å“ªä¸€ä¸ªé˜Ÿåˆ—çš„ä»»åŠ¡ã€‚ä½†æµè§ˆå™¨å¿…é¡»æœ‰ä¸€ä¸ªå¾®é˜Ÿåˆ—ï¼Œå¾®é˜Ÿåˆ—çš„ä»»åŠ¡ä¸€å®šå…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œå¿…é¡»ä¼˜å…ˆè°ƒåº¦æ‰§è¡Œã€‚ é¢è¯•é¢˜ï¼šJS ä¸­çš„è®¡æ—¶å™¨èƒ½åšåˆ°ç²¾ç¡®è®¡æ—¶å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ å‚è€ƒç­”æ¡ˆï¼š ä¸è¡Œï¼Œå› ä¸ºï¼š è®¡ç®—æœºç¡¬ä»¶æ²¡æœ‰åŸå­é’Ÿï¼Œæ— æ³•åšåˆ°ç²¾ç¡®è®¡æ—¶ æ“ä½œç³»ç»Ÿçš„è®¡æ—¶å‡½æ•°æœ¬èº«å°±æœ‰å°‘é‡åå·®ï¼Œç”±äº JS çš„è®¡æ—¶å™¨æœ€ç»ˆè°ƒç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿçš„å‡½æ•°ï¼Œä¹Ÿå°±æºå¸¦äº†è¿™äº›åå·® æŒ‰ç…§ W3C çš„æ ‡å‡†ï¼Œæµè§ˆå™¨å®ç°è®¡æ—¶å™¨æ—¶ï¼Œå¦‚æœåµŒå¥—å±‚çº§è¶…è¿‡ 5 å±‚ï¼Œåˆ™ä¼šå¸¦æœ‰ 4 æ¯«ç§’çš„æœ€å°‘æ—¶é—´ï¼Œè¿™æ ·åœ¨è®¡æ—¶æ—¶é—´å°‘äº 4 æ¯«ç§’æ—¶åˆå¸¦æ¥äº†åå·® å—äº‹ä»¶å¾ªç¯çš„å½±å“ï¼Œè®¡æ—¶å™¨çš„å›è°ƒå‡½æ•°åªèƒ½åœ¨ä¸»çº¿ç¨‹ç©ºé—²æ—¶è¿è¡Œï¼Œå› æ­¤åˆå¸¦æ¥äº†åå·® ","date":"2023-01-11","objectID":"/posts/event-loop/:3:3","tags":["Browser","JavaScript"],"title":"æµè§ˆå™¨åŸç† - äº‹ä»¶å¾ªç¯","uri":"/posts/event-loop/"},{"categories":["Debug"],"content":"å®‰è£… Homebrew åå¯¼è‡´ç³»ç»Ÿä¸­åŸæœ‰çš„ npm å’Œ npx å¤±æ•ˆçš„è§£å†³åŠæ³•","date":"2022-12-15","objectID":"/posts/homebrew-npm/","tags":["Homebrew","npm","npx","Mac"],"title":"å®‰è£… Homebrew åå¯¼è‡´ç³»ç»Ÿä¸­åŸæœ‰çš„ npm å’Œ npx å¤±æ•ˆ","uri":"/posts/homebrew-npm/"},{"categories":["Debug"],"content":" é—®é¢˜ å‰é¢ä¸€æ®µæ—¶é—´ï¼Œå®‰è£…äº† Homebrew, ä½†æ˜¯ä»Šå¤©åˆ‡æ¢ node ç‰ˆæœ¬åˆ° system version (8.10.0) åï¼Œå‘ç°è™½ç„¶ node ç‰ˆæœ¬åˆ‡æ¢æˆåŠŸï¼Œä½†æ˜¯ node ç‰ˆæœ¬å¯¹åº”çš„ npm å’Œ npx ç‰ˆæœ¬ä¸ç›¸ç¬¦ï¼Œä¸‹é¢è®°å½•ä¸€ä¸‹é—®é¢˜æ’æŸ¥è¿‡ç¨‹ã€‚ ","date":"2022-12-15","objectID":"/posts/homebrew-npm/:0:0","tags":["Homebrew","npm","npx","Mac"],"title":"å®‰è£… Homebrew åå¯¼è‡´ç³»ç»Ÿä¸­åŸæœ‰çš„ npm å’Œ npx å¤±æ•ˆ","uri":"/posts/homebrew-npm/"},{"categories":["Debug"],"content":"ç½ªé­ç¥¸é¦– é¦–å…ˆå®šä½åˆ°è¿™æ¬¡é—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯å®‰è£… Homebrew å¯¼è‡´çš„ï¼Œè¿™ç‚¹å¯ä»¥å¾ˆå¿«ä¹Ÿå¾ˆæ˜ç¡®åœ°å®šä½åˆ°ï¼Œå› ä¸ºä»¥å‰å®‰è£… Homebrew ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å½“æ—¶çš„åšæ³•æ˜¯å¸è½½ Homebrew é¿å…å†²çªã€‚ ","date":"2022-12-15","objectID":"/posts/homebrew-npm/:1:0","tags":["Homebrew","npm","npx","Mac"],"title":"å®‰è£… Homebrew åå¯¼è‡´ç³»ç»Ÿä¸­åŸæœ‰çš„ npm å’Œ npx å¤±æ•ˆ","uri":"/posts/homebrew-npm/"},{"categories":["Debug"],"content":"Why åˆ†æä¸ºå•¥ä¼šå†²çªï¼ŒHomebrew å®‰è£…çš„å·¥ç¨‹ä¸­ä¹Ÿä¼šé»˜è®¤ä¸€éƒ¨åˆ†ä¾èµ–çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œnpm å’Œ npx ä¹Ÿåœ¨å…¶ä¸­ï¼Œæ‰€ä»¥è¿™å¯¼è‡´äº† Homebrew çš„å®‰è£… npm å’Œ npx è¦†ç›–äº†ç³»ç»Ÿä¸­ node çš„ npm å’Œ npx è¿›è€Œå¯¼è‡´ node å’Œ npm ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œæ— æ³•ä½¿ç”¨ npm å¯åŠ¨é¡¹ç›®ã€‚ ","date":"2022-12-15","objectID":"/posts/homebrew-npm/:2:0","tags":["Homebrew","npm","npx","Mac"],"title":"å®‰è£… Homebrew åå¯¼è‡´ç³»ç»Ÿä¸­åŸæœ‰çš„ npm å’Œ npx å¤±æ•ˆ","uri":"/posts/homebrew-npm/"},{"categories":["Debug"],"content":"Where æ‰¾ä¸€ä¸‹ç›®å‰ npm å’Œ npx çš„äºŒè¿›åˆ¶æ–‡ä»¶åœ¨å“ªã€‚ nvm use system node -v # 8.10.0 which npm # /opt/homebrew/bin/npm which npx # /opt/homebrew/bin/npx ","date":"2022-12-15","objectID":"/posts/homebrew-npm/:3:0","tags":["Homebrew","npm","npx","Mac"],"title":"å®‰è£… Homebrew åå¯¼è‡´ç³»ç»Ÿä¸­åŸæœ‰çš„ npm å’Œ npx å¤±æ•ˆ","uri":"/posts/homebrew-npm/"},{"categories":["Debug"],"content":"How å¾ˆæ˜æ˜¾å‰é¢çš„çŒœæµ‹æ˜¯å¯¹çš„ï¼Œé‚£å°±æ‰“å¼€è¿™ä¸ªç›®å½•çœ‹çœ‹ï¼š open /opt/homebrew/bin æ‰¾åˆ° npm å’Œ npxï¼ŒæŠŠä»–ä»¬é‡å‘½åä¸º npm-brew å’Œ npx-brew, è¿™æ ·é€šè¿‡åˆ«åä¹Ÿä¿ç•™ Homebrew çš„ npm å’Œ npx. ä¿®æ”¹å®Œåï¼Œé‡å¯ç»ˆç«¯ï¼Œå†çœ‹çœ‹ npm å’Œ npx æ˜¯å¦ç”Ÿæ•ˆï¼š nvm use system node -v # 8.10.0 which npm # /usr/local/bin/npm which npx # /usr/local/bin/npx npm -v npx -v ä¸€åˆ‡æ­£å¸¸äº†ï¼Œå¯ä»¥ç”¨ npm ç»§ç»­å¯åŠ¨åŸæ¥çš„é¡¹ç›®äº†ã€‚ ","date":"2022-12-15","objectID":"/posts/homebrew-npm/:4:0","tags":["Homebrew","npm","npx","Mac"],"title":"å®‰è£… Homebrew åå¯¼è‡´ç³»ç»Ÿä¸­åŸæœ‰çš„ npm å’Œ npx å¤±æ•ˆ","uri":"/posts/homebrew-npm/"},{"categories":["Go"],"content":"è®°å½• GO åŠ Beego æ¡†æ¶å®‰è£…åŠåŸºç¡€é…ç½®ã€‚ ","date":"2022-08-31","objectID":"/posts/beego-install/:0:0","tags":["Beego","Go"],"title":"Beego å®‰è£…åŠé…ç½®","uri":"/posts/beego-install/"},{"categories":["Go"],"content":"å®‰è£… Go å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ï¼šhttps://golang.google.cn/dl/ é€šè¿‡äºŒè¿›åˆ¶æ–‡ä»¶å¿«é€Ÿå®‰è£…ï¼Œé»˜è®¤å®‰è£…ç›®å½•ï¼š/usr/local/go é…ç½®ç¯å¢ƒå˜é‡ vim ~/.bash_profile # golang export GOROOT=/usr/local/go export GOBIN=$GOROOT/bin export PATH=$PATH:$GOBIN export GOPATH=$HOME/go export GOPROXY=https://goproxy.cn # Go work bin export PATH=$PATH:$GOPATH/bin ","date":"2022-08-31","objectID":"/posts/beego-install/:1:0","tags":["Beego","Go"],"title":"Beego å®‰è£…åŠé…ç½®","uri":"/posts/beego-install/"},{"categories":["Go"],"content":"å®‰è£… Beego Beego repository Beego docs Beego new docs Beego çš„å®‰è£…éœ€è¦åœ¨æ–°å»ºé¡¹ç›®ä¸” go mod init \u003cmodule_name\u003eä¹‹åï¼Œåœ¨é¡¹ç›®ä¸‹æ‰§è¡Œï¼Œå…·ä½“å‚è€ƒ beego#quick-startã€‚ ","date":"2022-08-31","objectID":"/posts/beego-install/:2:0","tags":["Beego","Go"],"title":"Beego å®‰è£…åŠé…ç½®","uri":"/posts/beego-install/"},{"categories":["Go"],"content":"å®‰è£… bee bee repository æ³¨æ„ï¼šarm64 æ¶æ„çš„ mac (M1 ï½ç³»åˆ—)ï¼Œä¸‹è½½å®‰è£… bee æ—¶æœ€å¥½ï¼Œä½¿ç”¨ Rosetta æ‰“å¼€ç»ˆç«¯ï¼Œä¸ç„¶æ— æ³•ä¸‹è½½ darwin_arm64 çš„ä¾èµ–ï¼Œå¦‚æœå·²ç»å®‰è£…äº†ï¼Œå¯ä»¥ä½¿ç”¨ Rosetta æ‰“å¼€ç»ˆç«¯åï¼Œè¿è¡Œ bee update å‡çº§ï¼Œå‡çº§å®Œåå°†ç»ˆç«¯å¤åŸã€‚ bee å·¥å…·å®‰è£…ï¼Œgo install å®‰è£æŒ‡å®šç‰ˆæœ¬çš„ bee å·¥å…·ï¼Œä¾‹å¦‚ï¼š go install github.com/beego/bee/v2@latest å®‰è£…æˆåŠŸåï¼Œå¯ä»¥åœ¨ $GOPATH/bin ä¸‹çœ‹åˆ° bee çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ æ£€éªŒ bee å·¥å…·æ˜¯å¦å®‰è£…æˆåŠŸï¼š bee version åˆ›å»ºä¸€ä¸ªæ–°çš„ Beego é¡¹ç›® bee new hello cd hello go mod tidy bee run ","date":"2022-08-31","objectID":"/posts/beego-install/:3:0","tags":["Beego","Go"],"title":"Beego å®‰è£…åŠé…ç½®","uri":"/posts/beego-install/"},{"categories":["Spec"],"content":" æ‘˜è¦ ç‰ˆæœ¬æ ¼å¼ï¼šMAJOR.MINOR.PATCHï¼Œç‰ˆæœ¬å·é€’å¢è§„åˆ™å¦‚ä¸‹ï¼š MAJOR: ä¸»ç‰ˆæœ¬å·ï¼Œå½“ä½ åšäº†ä¸å…¼å®¹çš„ API ä¿®æ”¹ MINOR: æ¬¡ç‰ˆæœ¬å·ï¼Œå½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢ PATCH: ä¿®è®¢å·ï¼Œå½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£ å…ˆè¡Œç‰ˆæœ¬å·åŠç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯å¯ä»¥åŠ åˆ° MAJOR.MINOR.PATCH çš„åé¢ï¼Œä½œä¸ºå»¶ä¼¸ã€‚ ","date":"2022-08-13","objectID":"/posts/semver/:0:0","tags":["SemVer"],"title":"è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰","uri":"/posts/semver/"},{"categories":["Spec"],"content":"æ ¼å¼ åŸºæœ¬çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼Œæ›´å¤šè¯·å‚è€ƒ Backusâ€“Naur Form Grammar for Valid SemVer Versions \u003cvalid semver\u003e ::= \u003cversion core\u003e | \u003cversion core\u003e \"-\" \u003cpre-release\u003e | \u003cversion core\u003e \"+\" \u003cbuild\u003e | \u003cversion core\u003e \"-\" \u003cpre-release\u003e \"+\" \u003cbuild\u003e èŒƒä¾‹ï¼š ä»£ç çŠ¶æ€ ç­‰çº§ è§„åˆ™ ç‰ˆæœ¬æ ·ä¾‹ é¦–æ¬¡å‘å¸ƒ æ–°å“å‘å¸ƒ ä»¥ 1.0.0 å¼€å§‹ 1.0.0 bug ä¿®å¤ï¼Œå‘åå…¼å®¹ è¡¥ä¸ç‰ˆæœ¬å‘å¸ƒ å˜æ›´ç¬¬ä¸‰ä½æ•°å­— 1.0.1 æ–°åŠŸèƒ½ï¼Œå‘åå…¼å®¹ æ¬¡ç‰ˆæœ¬å‘å¸ƒ å˜æ›´ç¬¬äºŒä½æ•°å­—ï¼Œå¹¶ä¸”ç¬¬ä¸‰ä½æ•°å­—é‡ç½®ä¸º 0 1.1.0 é‡å¤§å˜æ›´ï¼Œä¸å‘åå…¼å®¹ ä¸»ç‰ˆæœ¬å‘å¸ƒ å˜æ›´ç¬¬ä¸€ä½æ•°å­—ï¼Œå¹¶ä¸”ç¬¬äºŒä½ï¼Œç¬¬ä¸‰ä½æ•°å­—é‡ç½®ä¸º 0 2.0.0 â€œv1.2.3â€ æ˜¯ä¸€ä¸ªè¯­ä¹‰åŒ–ç‰ˆæœ¬å·å—ï¼Ÿ â€œv1.2.3â€ å¹¶ä¸æ˜¯çš„ä¸€ä¸ªè¯­ä¹‰åŒ–çš„ç‰ˆæœ¬å·ã€‚ ä½†æ˜¯ï¼Œåœ¨è¯­ä¹‰åŒ–ç‰ˆæœ¬å·ä¹‹å‰å¢åŠ å‰ç¼€ â€œvâ€ æ˜¯ç”¨æ¥è¡¨ç¤ºç‰ˆæœ¬å·çš„å¸¸ç”¨åšæ³•ã€‚ åœ¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ï¼Œå°† â€œversionâ€ ç¼©å†™ä¸º â€œvâ€ æ˜¯å¾ˆå¸¸è§çš„ã€‚ æ¯”å¦‚ï¼šgit tag v1.2.3 -m \"Release version 1.2.3\" ä¸­ï¼Œæ ‡ç­¾æ˜¯ â€œv1.2.3â€ï¼Œè¯­ä¹‰åŒ–ç‰ˆæœ¬å·æ˜¯ â€œ1.2.3â€ã€‚ ","date":"2022-08-13","objectID":"/posts/semver/:1:0","tags":["SemVer"],"title":"è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰","uri":"/posts/semver/"},{"categories":["Spec"],"content":"è§„èŒƒ ä»¥ä¸‹å…³é”®è¯ MUSTã€MUST NOTã€REQUIREDã€SHALLã€SHALL NOTã€SHOULDã€SHOULD NOTã€ RECOMMENDEDã€MAYã€OPTIONAL ä¾ç…§ RFC 2119 çš„å™è¿°è§£è¯»ã€‚ è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„èŒƒï¼ˆSemVerï¼‰ ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶çš„è½¯ä»¶å¿…é¡»ï¼ˆMUSTï¼‰å®šä¹‰å…¬å…± APIã€‚è¯¥ API å¯ä»¥åœ¨ä»£ç ä¸­è¢«å®šä¹‰æˆ–å‡ºç°äºä¸¥è°¨çš„æ–‡æ¡£å†…ã€‚æ— è®ºä½•ç§å½¢å¼éƒ½åº”è¯¥åŠ›æ±‚ç²¾ç¡®ä¸”å®Œæ•´ã€‚ æ ‡å‡†çš„ç‰ˆæœ¬å·å¿…é¡»ï¼ˆMUSTï¼‰é‡‡ç”¨ X.Y.Z çš„æ ¼å¼ï¼Œå…¶ä¸­ Xã€Y å’Œ Z ä¸ºéè´Ÿçš„æ•´æ•°ï¼Œä¸”ç¦æ­¢ï¼ˆMUST NOTï¼‰åœ¨æ•°å­—å‰æ–¹è¡¥é›¶ã€‚X æ˜¯ä¸»ç‰ˆæœ¬å·ã€Y æ˜¯æ¬¡ç‰ˆæœ¬å·ã€è€Œ Z ä¸ºä¿®è®¢å·ã€‚æ¯ä¸ªå…ƒç´ å¿…é¡»ï¼ˆMUSTï¼‰ä»¥æ•°å€¼æ¥é€’å¢ã€‚ä¾‹å¦‚ï¼š1.9.1 -\u003e 1.10.0 -\u003e 1.11.0ã€‚ æ ‡è®°ç‰ˆæœ¬å·çš„è½¯ä»¶å‘è¡Œåï¼Œç¦æ­¢ï¼ˆMUST NOTï¼‰æ”¹å˜è¯¥ç‰ˆæœ¬è½¯ä»¶çš„å†…å®¹ã€‚ä»»ä½•ä¿®æ”¹éƒ½å¿…é¡»ï¼ˆMUSTï¼‰ä»¥æ–°ç‰ˆæœ¬å‘è¡Œã€‚ ä¸»ç‰ˆæœ¬å·ä¸ºé›¶ï¼ˆ0.y.zï¼‰çš„è½¯ä»¶å¤„äºå¼€å‘åˆå§‹é˜¶æ®µï¼Œä¸€åˆ‡éƒ½å¯èƒ½éšæ—¶è¢«æ”¹å˜ã€‚è¿™æ ·çš„å…¬å…± API ä¸åº”è¯¥è¢«è§†ä¸ºç¨³å®šç‰ˆã€‚ 1.0.0 çš„ç‰ˆæœ¬å·ç”¨äºç•Œå®šå…¬å…± API çš„å½¢æˆã€‚è¿™ä¸€ç‰ˆæœ¬ä¹‹åæ‰€æœ‰çš„ç‰ˆæœ¬å·æ›´æ–°éƒ½åŸºäºå…¬å…± API åŠå…¶ä¿®æ”¹å†…å®¹ã€‚ ä¿®è®¢å· Zï¼ˆx.y.Z | x \u003e 0ï¼‰å¿…é¡»ï¼ˆMUSTï¼‰åœ¨åªåšäº†å‘ä¸‹å…¼å®¹çš„ä¿®æ­£æ—¶æ‰é€’å¢ã€‚è¿™é‡Œçš„ä¿®æ­£æŒ‡çš„æ˜¯é’ˆå¯¹ä¸æ­£ç¡®ç»“æœè€Œè¿›è¡Œçš„å†…éƒ¨ä¿®æ”¹ã€‚ æ¬¡ç‰ˆæœ¬å· Yï¼ˆx.Y.z | x \u003e 0ï¼‰å¿…é¡»ï¼ˆMUSTï¼‰åœ¨æœ‰å‘ä¸‹å…¼å®¹çš„æ–°åŠŸèƒ½å‡ºç°æ—¶é€’å¢ã€‚åœ¨ä»»ä½•å…¬å…± API çš„åŠŸèƒ½è¢«æ ‡è®°ä¸ºå¼ƒç”¨ï¼ˆdeprecatedï¼‰æ—¶ä¹Ÿå¿…é¡»ï¼ˆMUSTï¼‰é€’å¢ã€‚ä¹Ÿå¯ä»¥ï¼ˆMAYï¼‰åœ¨å†…éƒ¨ç¨‹åºæœ‰å¤§é‡æ–°åŠŸèƒ½æˆ–æ”¹è¿›è¢«åŠ å…¥æ—¶é€’å¢ï¼Œå…¶ä¸­å¯ä»¥ï¼ˆMAYï¼‰åŒ…æ‹¬ä¿®è®¢çº§åˆ«çš„æ”¹å˜ã€‚æ¯å½“æ¬¡ç‰ˆæœ¬å·é€’å¢æ—¶ï¼Œä¿®è®¢å·å¿…é¡»ï¼ˆMUSTï¼‰å½’é›¶ã€‚ ä¸»ç‰ˆæœ¬å· Xï¼ˆX.y.z | X \u003e 0ï¼‰å¿…é¡»ï¼ˆMUSTï¼‰åœ¨æœ‰ä»»ä½•ä¸å…¼å®¹çš„ä¿®æ”¹è¢«åŠ å…¥å…¬å…± API æ—¶é€’å¢ã€‚å…¶ä¸­å¯ä»¥ï¼ˆMAYï¼‰åŒ…æ‹¬æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢çº§åˆ«çš„æ”¹å˜ã€‚æ¯å½“ä¸»ç‰ˆæœ¬å·é€’å¢æ—¶ï¼Œæ¬¡ç‰ˆæœ¬å·å’Œä¿®è®¢å·å¿…é¡»ï¼ˆMUSTï¼‰å½’é›¶ã€‚ å…ˆè¡Œç‰ˆæœ¬å·å¯ä»¥ï¼ˆMAYï¼‰è¢«æ ‡æ³¨åœ¨ä¿®è®¢ç‰ˆä¹‹åï¼Œå…ˆåŠ ä¸Šä¸€ä¸ªè¿æ¥å·å†åŠ ä¸Šä¸€è¿ä¸²ä»¥å¥ç‚¹åˆ†éš”çš„æ ‡è¯†ç¬¦æ¥ä¿®é¥°ã€‚æ ‡è¯†ç¬¦å¿…é¡»ï¼ˆMUSTï¼‰ç”± ASCII å­—æ¯æ•°å­—å’Œè¿æ¥å· [0-9A-Za-z-] ç»„æˆï¼Œä¸”ç¦æ­¢ï¼ˆMUST NOTï¼‰ç•™ç™½ã€‚æ•°å­—å‹çš„æ ‡è¯†ç¬¦ç¦æ­¢ï¼ˆMUST NOTï¼‰åœ¨å‰æ–¹è¡¥é›¶ã€‚å…ˆè¡Œç‰ˆçš„ä¼˜å…ˆçº§ä½äºç›¸å…³è”çš„æ ‡å‡†ç‰ˆæœ¬ã€‚è¢«æ ‡ä¸Šå…ˆè¡Œç‰ˆæœ¬å·åˆ™è¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬å¹¶éç¨³å®šè€Œä¸”å¯èƒ½æ— æ³•æ»¡è¶³é¢„æœŸçš„å…¼å®¹æ€§éœ€æ±‚ã€‚èŒƒä¾‹ï¼š1.0.0-alphaã€1.0.0-alpha.1ã€1.0.0-0.3.7ã€1.0.0-x.7.z.92ã€‚ ç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯å¯ä»¥ï¼ˆMAYï¼‰è¢«æ ‡æ³¨åœ¨ä¿®è®¢ç‰ˆæˆ–å…ˆè¡Œç‰ˆæœ¬å·ä¹‹åï¼Œå…ˆåŠ ä¸Šä¸€ä¸ªåŠ å·å†åŠ ä¸Šä¸€è¿ä¸²ä»¥å¥ç‚¹åˆ†éš”çš„æ ‡è¯†ç¬¦æ¥ä¿®é¥°ã€‚æ ‡è¯†ç¬¦å¿…é¡»ï¼ˆMUSTï¼‰ç”± ASCII å­—æ¯æ•°å­—å’Œè¿æ¥å· [0-9A-Za-z-] ç»„æˆï¼Œä¸”ç¦æ­¢ï¼ˆMUST NOTï¼‰ç•™ç™½ã€‚å½“åˆ¤æ–­ç‰ˆæœ¬çš„ä¼˜å…ˆå±‚çº§æ—¶ï¼Œç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯å¯ï¼ˆSHOULDï¼‰è¢«å¿½ç•¥ã€‚å› æ­¤å½“ä¸¤ä¸ªç‰ˆæœ¬åªæœ‰åœ¨ç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯æœ‰å·®åˆ«æ—¶ï¼Œå±äºç›¸åŒçš„ä¼˜å…ˆå±‚çº§ã€‚èŒƒä¾‹ï¼š1.0.0-alpha+001ã€1.0.0+20130313144700ã€1.0.0-beta+exp.sha.5114f85ã€‚ ç‰ˆæœ¬çš„ä¼˜å…ˆå±‚çº§æŒ‡çš„æ˜¯ä¸åŒç‰ˆæœ¬åœ¨æ’åºæ—¶å¦‚ä½•æ¯”è¾ƒã€‚ åˆ¤æ–­ä¼˜å…ˆå±‚çº§æ—¶ï¼Œå¿…é¡»ï¼ˆMUSTï¼‰æŠŠç‰ˆæœ¬ä¾åºæ‹†åˆ†ä¸ºä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·ã€ä¿®è®¢å·åŠå…ˆè¡Œç‰ˆæœ¬å·åè¿›è¡Œæ¯”è¾ƒï¼ˆç‰ˆæœ¬ç¼–è¯‘ä¿¡æ¯ä¸åœ¨è¿™ä»½æ¯”è¾ƒçš„åˆ—è¡¨ä¸­ï¼‰ã€‚ ç”±å·¦åˆ°å³ä¾åºæ¯”è¾ƒæ¯ä¸ªæ ‡è¯†ç¬¦ï¼Œç¬¬ä¸€ä¸ªå·®å¼‚å€¼ç”¨æ¥å†³å®šä¼˜å…ˆå±‚çº§ï¼šä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢å·ä»¥æ•°å€¼æ¯”è¾ƒã€‚ ä¾‹å¦‚ï¼š1.0.0 \u003c 2.0.0 \u003c 2.1.0 \u003c 2.1.1ã€‚ å½“ä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢å·éƒ½ç›¸åŒæ—¶ï¼Œæ”¹ä»¥ä¼˜å…ˆå±‚çº§æ¯”è¾ƒä½çš„å…ˆè¡Œç‰ˆæœ¬å·å†³å®šã€‚ ä¾‹å¦‚ï¼š1.0.0-alpha \u003c 1.0.0ã€‚ æœ‰ç›¸åŒä¸»ç‰ˆæœ¬å·ã€æ¬¡ç‰ˆæœ¬å·åŠä¿®è®¢å·çš„ä¸¤ä¸ªå…ˆè¡Œç‰ˆæœ¬å·ï¼Œå…¶ä¼˜å…ˆå±‚çº§å¿…é¡»ï¼ˆMUSTï¼‰é€è¿‡ç”±å·¦åˆ°å³çš„æ¯ä¸ªè¢«å¥ç‚¹åˆ†éš”çš„æ ‡è¯†ç¬¦æ¥æ¯”è¾ƒï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå·®å¼‚å€¼åå†³å®šï¼š åªæœ‰æ•°å­—çš„æ ‡è¯†ç¬¦ä»¥æ•°å€¼é«˜ä½æ¯”è¾ƒã€‚ æœ‰å­—æ¯æˆ–è¿æ¥å·æ—¶åˆ™é€å­—ä»¥ ASCII çš„æ’åºæ¥æ¯”è¾ƒã€‚ æ•°å­—çš„æ ‡è¯†ç¬¦æ¯”éæ•°å­—çš„æ ‡è¯†ç¬¦ä¼˜å…ˆå±‚çº§ä½ã€‚ è‹¥å¼€å¤´çš„æ ‡è¯†ç¬¦éƒ½ç›¸åŒæ—¶ï¼Œæ ä½æ¯”è¾ƒå¤šçš„å…ˆè¡Œç‰ˆæœ¬å·ä¼˜å…ˆå±‚çº§æ¯”è¾ƒé«˜ã€‚ ä¾‹å¦‚ï¼š1.0.0-alpha \u003c 1.0.0-alpha.1 \u003c 1.0.0-alpha.beta \u003c 1.0.0-beta \u003c 1.0.0-beta.2 \u003c 1.0.0-beta.11 \u003c 1.0.0-rc.1 \u003c 1.0.0 ","date":"2022-08-13","objectID":"/posts/semver/:2:0","tags":["SemVer"],"title":"è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰","uri":"/posts/semver/"},{"categories":["Spec"],"content":"ç‰ˆæœ¬é˜¶æ®µ Base: è®¾è®¡é˜¶æ®µï¼Œåªæœ‰ç›¸åº”çš„è®¾è®¡æ²¡æœ‰å…·ä½“çš„åŠŸèƒ½å®ç° Alpha: è½¯ä»¶çš„åˆçº§ç‰ˆæœ¬ï¼ŒåŸºæœ¬åŠŸèƒ½å·²ç»å®ç°ï¼Œä½†å­˜åœ¨è¾ƒå¤šçš„ bug Bate: ç›¸å¯¹äº Alpha å·²ç»æœ‰äº†å¾ˆå¤§çš„è¿›æ­¥ï¼Œæ¶ˆé™¤äº†ä¸¥é‡çš„ BUGï¼Œä½†è¿˜å­˜åœ¨ä¸€äº›æ½œåœ¨çš„ BUGï¼Œè¿˜éœ€è¦ä¸æ–­æµ‹è¯• RC: è¯¥ç‰ˆæœ¬å·²ç»ç›¸å½“æˆç†Ÿäº†ï¼ŒåŸºæœ¬ä¸Šä¸å­˜åœ¨å¯¼è‡´é”™è¯¯çš„ Bugï¼Œä¸å³å°†å‘è¡Œçš„æ­£å¼ç‰ˆæœ¬ç›¸å·®æ— å‡  RELEASE: æœ€ç»ˆå‘å¸ƒç‰ˆæœ¬ï¼Œæ²¡æœ‰å¤ªå¤§çš„é—®é¢˜ æœ€ç»ˆå‘å¸ƒç‰ˆæœ¬ï¼ˆRELEASEï¼‰ä¹‹å‰çš„æ‰€æœ‰ç‰ˆæœ¬ï¼Œéƒ½ç§°ä¸ºå…ˆè¡Œç‰ˆæœ¬ï¼ˆpre-releaseï¼‰ã€‚ ","date":"2022-08-13","objectID":"/posts/semver/:3:0","tags":["SemVer"],"title":"è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰","uri":"/posts/semver/"},{"categories":["Spec"],"content":"FAQ ","date":"2022-08-13","objectID":"/posts/semver/:4:0","tags":["SemVer"],"title":"è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰","uri":"/posts/semver/"},{"categories":["Spec"],"content":"å…¶ä»–ç›¸å…³ ","date":"2022-08-13","objectID":"/posts/semver/:5:0","tags":["SemVer"],"title":"è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰","uri":"/posts/semver/"},{"categories":["Spec"],"content":"npm SemVer é€šå¸¸æˆ‘ä»¬å‘å¸ƒä¸€ä¸ªåŒ…åˆ° npm ä»“åº“æ—¶ï¼Œæˆ‘ä»¬çš„åšæ³•æ˜¯å…ˆä¿®æ”¹ package.json ä¸ºæŸä¸ªç‰ˆæœ¬ï¼Œç„¶åæ‰§è¡Œ npm publish å‘½ä»¤ã€‚æ‰‹åŠ¨ä¿®æ”¹ç‰ˆæœ¬å·çš„åšæ³•å»ºç«‹åœ¨ä½ å¯¹ SemVer è§„èŒƒç‰¹åˆ«ç†Ÿæ‚‰çš„åŸºç¡€ä¹‹ä¸Šï¼Œå¦åˆ™å¯èƒ½ä¼šé€ æˆç‰ˆæœ¬æ··ä¹±ã€‚npm å’Œ yarn ä¸¤ä¸ªåŒ…ç®¡ç†éƒ½æä¾›äº† SemVer è§„èŒƒçš„ç‰ˆæœ¬æ§åˆ¶å‘½ä»¤ï¼š npm-version yarn version npm å‘åŒ…åŸºç¡€å‘½ä»¤ï¼š # 1. åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ… npm init # 2. æŸ¥çœ‹æ˜¯å¦å®˜æ–¹æº npm config get registry # 3. ç™»å½• npm login # 4. å‘å¸ƒ npm publish # ç‰ˆæœ¬å˜åŒ– major.minor.patch npm version patch # å‡çº§è¡¥ä¸ç‰ˆæœ¬ npm version minor # å‡çº§å°ç‰ˆå· npm version major # å‡çº§å¤§ç‰ˆå· # ä¸‹æ¶ [-force] npm unpublish å…¨å±€è®¾ç½®ç‰ˆæœ¬å·å‰ç¼€ # https://docs.npmjs.com/cli/v8/using-npm/config#tag-version-prefix npm config set tag-version-prefix \"\" # å…¨å±€è®¾ç½®ç‰ˆæœ¬æ›´æ–° commit æäº¤ä¿¡æ¯ # https://docs.npmjs.com/cli/v8/using-npm/config#message npm config set message \"Chore(release): %s\" æˆ–è€…è®¾ç½®é¡¹ç›®çš„ .npmrc æˆ–è€… .yarnrc # .npmrc tag-version-prefix=\"\" message=\"Chore(release): %s\" # .yarnrc version-tag-prefix \"\" version-git-message \"Chore(release): %s\" package.json ç‰ˆæœ¬æ§åˆ¶è§„åˆ™ä½¿ç”¨äº†ä¸€äº›äº›ç¬¦å·ï¼š ^ ~ \u003e \u003e= \u003c \u003c= = - || è¿™äº›è§„åˆ™çš„è¯¦æƒ…å¦‚ä¸‹ï¼š ^: åªä¼šæ‰§è¡Œä¸æ›´æ”¹æœ€å·¦è¾¹éé›¶æ•°å­—çš„æ›´æ–°ã€‚ å¦‚æœå†™å…¥çš„æ˜¯ ^0.13.0ï¼Œåˆ™å½“è¿è¡Œ npm update æ—¶ï¼Œå¯ä»¥æ›´æ–°åˆ° 0.13.1ã€0.13.2 ç­‰ï¼Œä½†ä¸èƒ½æ›´æ–°åˆ° 0.14.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚ å¦‚æœå†™å…¥çš„æ˜¯ ^1.13.0ï¼Œåˆ™å½“è¿è¡Œ npm update æ—¶ï¼Œå¯ä»¥æ›´æ–°åˆ° 1.13.1ã€1.14.0 ç­‰ï¼Œä½†ä¸èƒ½æ›´æ–°åˆ° 2.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚ ~: å¦‚æœå†™å…¥çš„æ˜¯ ã€œ0.13.0ï¼Œåˆ™å½“è¿è¡Œ npm update æ—¶ï¼Œä¼šæ›´æ–°åˆ°è¡¥ä¸ç‰ˆæœ¬ï¼šå³ 0.13.1 å¯ä»¥ï¼Œä½† 0.14.0 ä¸å¯ä»¥ã€‚ \u003e: æ¥å—é«˜äºæŒ‡å®šç‰ˆæœ¬çš„ä»»ä½•ç‰ˆæœ¬ã€‚ \u003e=: æ¥å—ç­‰äºæˆ–é«˜äºæŒ‡å®šç‰ˆæœ¬çš„ä»»ä½•ç‰ˆæœ¬ã€‚ \u003c=: æ¥å—ç­‰äºæˆ–ä½äºæŒ‡å®šç‰ˆæœ¬çš„ä»»ä½•ç‰ˆæœ¬ã€‚ \u003c: æ¥å—ä½äºæŒ‡å®šç‰ˆæœ¬çš„ä»»ä½•ç‰ˆæœ¬ã€‚ =: æ¥å—ç¡®åˆ‡çš„ç‰ˆæœ¬ã€‚ -: æ¥å—ä¸€å®šèŒƒå›´çš„ç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼š2.1.0 - 2.6.2ã€‚ ||: ç»„åˆé›†åˆã€‚ä¾‹å¦‚ \u003c 2.1 || \u003e 2.6ã€‚ å¯ä»¥åˆå¹¶å…¶ä¸­çš„ä¸€äº›ç¬¦å·ï¼Œä¾‹å¦‚ 1.0.0 || \u003e=1.1.0 \u003c1.2.0ï¼Œå³ä½¿ç”¨ 1.0.0 æˆ–ä» 1.1.0 å¼€å§‹ä½†ä½äº 1.2.0 çš„ç‰ˆæœ¬ã€‚ è¿˜æœ‰å…¶ä»–çš„è§„åˆ™ï¼š æ— ç¬¦å·ï¼šä»…æ¥å—æŒ‡å®šçš„ç‰¹å®šç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 1.2.1ï¼‰ã€‚ latest: ä½¿ç”¨å¯ç”¨çš„æœ€æ–°ç‰ˆæœ¬ã€‚ ","date":"2022-08-13","objectID":"/posts/semver/:5:1","tags":["SemVer"],"title":"è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰","uri":"/posts/semver/"},{"categories":["Spec"],"content":"ç‰ˆæœ¬ä¿ç•™ å¯¹äºå¤§å‹è½¯ä»¶ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½æœ‰ä½¿ç”¨ä»·å€¼æ—¶ï¼Œåº”ä¿ç•™æ‰€æœ‰å†å²ç‰ˆæœ¬ å¯¹äºå§‹ç»ˆä»¥æœ€æ–°ç‰ˆæœ¬ä¸ºå‡†çš„è½¯ä»¶ï¼Œåˆ™å¯ä¿ç•™è‡³å°‘æœ€è¿‘çš„ 10 ä¸ªæ¬¡ç‰ˆæœ¬ ","date":"2022-08-13","objectID":"/posts/semver/:5:2","tags":["SemVer"],"title":"è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰","uri":"/posts/semver/"},{"categories":["Spec"],"content":"å‚è€ƒ Semantic Versioning 2.0.0 ä½¿ç”¨ npm çš„è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ ","date":"2022-08-13","objectID":"/posts/semver/:6:0","tags":["SemVer"],"title":"è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰","uri":"/posts/semver/"},{"categories":["Spec","Git"],"content":"Commit messages are short descriptions of changes to a repository. We should follow certain standards to effectively describe changes, such as the Conventional Commits specification based on the Angular convention that is most used on GitHub, or each development team can simplify and formulate their own commit specification. This is not only conducive to the automatic generation of Changelog in the later stage, but more importantly, when a bug occurs, the entire warehouse can be quickly checked, the problem point can be accurately located, and the version can be reverted. ","date":"2022-08-12","objectID":"/posts/commit-spec/:0:0","tags":["Git"],"title":"Commit Message Spec","uri":"/posts/commit-spec/"},{"categories":["Spec","Git"],"content":"Format [{emoji} ]{type}[({module})]: {subject within 50 words}[ (#{issue/pull request})] example: ğŸ‰ Feat: add shortcode fixit-encryptor shortcode (#123) â¬†ï¸ Chore(libs): update Artalk from 2.2.12 to 2.3.4 (#150) ","date":"2022-08-12","objectID":"/posts/commit-spec/:1:0","tags":["Git"],"title":"Commit Message Spec","uri":"/posts/commit-spec/"},{"categories":["Spec","Git"],"content":"Emoji https://gitmoji.dev vscode plugin utools plugin GitEmoji ","date":"2022-08-12","objectID":"/posts/commit-spec/:2:0","tags":["Git"],"title":"Commit Message Spec","uri":"/posts/commit-spec/"},{"categories":["Spec","Git"],"content":"Message Emoji Type Example Description (No Ambiguous) ğŸ‰ âœ¨ Feat Feat: add {feature} new feature ğŸšš Feat: adjust/migrate {feature name}, {change details} For the adjustment feature, it is necessary to describe the current situation (before) and after adjustment (after) ğŸ”¥ Feat: delete {feature name}, {deletion reason} If the feature is deleted, the reason for deletion must be explained ğŸ› ğŸš§ ğŸš¨ Fix Fix: fix {bug description} Fix known bugs ğŸ¨ ğŸ’„ âœï¸ Style Style: Typesetting/CSS style {optimizing content} Changes that do not affect code operation, such as code layout and style change â™»ï¸ Refactor Refactor: override {feature name} It is neither a new function nor a code change to fix a bug. Simply rewriting the code of a function does not affect the function result âš¡ Perf Perf: improve performance {function name}, {improve content} Optimize code performance âª Revert Revert: restore version {commit message of restore version} Restore the version of one commit ğŸ“ âœï¸ Docs Docs: revise comments/update documents Adjustment of documents and notes ğŸ”§ Chore Chore: update plugin version Changes in the construction process or auxiliary tools ","date":"2022-08-12","objectID":"/posts/commit-spec/:3:0","tags":["Git"],"title":"Commit Message Spec","uri":"/posts/commit-spec/"},{"categories":["JavaScript"],"content":"æ€»ç»“ä¸€ä¸‹æœ€è¿‘ electron å¼€å‘é‡åˆ°çš„é—®é¢˜å’Œä¸€äº›é‡è¦çŸ¥è¯†ç‚¹ã€‚ ","date":"2022-08-12","objectID":"/posts/electron-summary/:0:0","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"ç®€ä»‹ å¦‚æœä½ å¯ä»¥å»ºä¸€ä¸ªç½‘ç«™ï¼Œä½ å°±å¯ä»¥å»ºä¸€ä¸ªæ¡Œé¢åº”ç”¨ç¨‹åºã€‚ Electron æ˜¯ä¸€ä¸ªä½¿ç”¨ JavaScript, HTML å’Œ CSS ç­‰ Web æŠ€æœ¯åˆ›å»ºåŸç”Ÿç¨‹åºçš„å¼€æºæ¡†æ¶ï¼Œå®ƒè´Ÿè´£æ¯”è¾ƒéš¾æçš„éƒ¨åˆ†ï¼Œä½ åªéœ€æŠŠç²¾åŠ›æ”¾åœ¨ä½ çš„åº”ç”¨çš„æ ¸å¿ƒä¸Šå³å¯ã€‚ ","date":"2022-08-12","objectID":"/posts/electron-summary/:1:0","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"çŸ¥è¯†ç‚¹ ","date":"2022-08-12","objectID":"/posts/electron-summary/:2:0","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"è¿›ç¨‹ electron ç”±ä¸¤ç§è¿›ç¨‹ç»„æˆï¼ŒåŒ…æ‹¬ä¸»è¿›ç¨‹å’Œ 0 ä¸ªæˆ– n ä¸ªæ¸²æŸ“è¿›ç¨‹ã€‚ ä¸»è¿›ç¨‹ï¼šæ‰¿æ‹…åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼ˆåŒ…æ‹¬å¯åŠ¨ï¼Œé€€å‡ºï¼Œå‡†å¤‡ï¼Œæ­£åœ¨åˆ‡æ¢åˆ°åå°ï¼Œæ­£åœ¨åˆ‡æ¢åˆ°å‰å°ç­‰ï¼Œè¿˜è´Ÿè´£ä¸åŸç”Ÿæ“ä½œç³»ç»Ÿ API é€šä¿¡ï¼‰ æ¸²æŸ“è¿›ç¨‹ï¼šåš web é¡µé¢çš„ uiï¼Œæ¸²æŸ“è¿›ç¨‹ä¹‹é—´ç‹¬ç«‹åœ¨å„è‡ªçš„å•çº¿ç¨‹ï¼Œæ¸²æŸ“è¿›ç¨‹ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œä¸èƒ½ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿï¼Œéœ€è¦é€šä¿¡åˆ°ä¸»çº¿ç¨‹ï¼Œåœ¨é€šè¿‡ä¸»çº¿ç¨‹æ“ä½œè®¿é—®æ“ä½œå½¢æ€ï¼Œä¸€ä¸ª BrowserWindow å®ä¾‹å³ä¸ºä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ ","date":"2022-08-12","objectID":"/posts/electron-summary/:2:1","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"æŠ€æœ¯æ ˆ electron æ•´åˆäº† Node å’Œæµè§ˆå™¨çš„æ‰€æœ‰èƒ½åŠ›ï¼Œå¯ä»¥éšæ„å‘æŒ¥è¿™äº›æŠ€æœ¯æ ˆçš„ç‰¹ç‚¹ã€‚ç”±äºå›ºå®šæµè§ˆå™¨å†…æ ¸ï¼Œå¯ä»¥æ— éœ€è€ƒè™‘å…¼å®¹æ€§åœ°ä½¿ç”¨ html/js/css æ–°ç‰¹æ€§ã€‚ ","date":"2022-08-12","objectID":"/posts/electron-summary/:2:2","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"å®‰è£… å®‰è£… electron æ—¶ï¼Œå¯èƒ½å› ä¸ºç½‘ç»œé—®é¢˜å¯¼è‡´ä¸‹è½½å¤±è´¥ï¼Œéœ€è¦ä½¿ç”¨é•œåƒä»“åº“æ¥ä¸‹è½½ã€‚ # è®¾ç½® electron é•œåƒä»“åº“ # https://registry.npmmirror.com/-/binary/electron # 13.1.7 ç‰ˆæœ¬ ä¸‹è½½é“¾æ¥å¯èƒ½ä¼šæ‹¼é”™å¯¼è‡´ 404ï¼Œè¦è®¾ç½®æˆ https://registry.npmmirror.com/-/binary/electron/v npm config set electron_mirror=https://npmmirror.com/mirrors/electron/ M1 Mac å®‰è£…è¾ƒä½ç‰ˆæœ¬ electron æ—¶å¯èƒ½ä¼šæŠ¥é”™ï¼ŒFailed to find Electron v xxx for darwin-arm64ï¼Œå› ä¸ºè¿™äº›ç‰ˆæœ¬çš„ electron ä¸æ”¯æŒ darwin-arm64 æ¶æ„ã€‚Apple é’ˆå¯¹æœªé€‚é…çš„ X64 åº”ç”¨æä¾›äº† Rosetta2 è½¬æ¢å™¨ï¼Œå®‰è£… darwin-x64 ç‰ˆæœ¬çš„ electron åœ¨ Intel æ¨¡å¼ä¸‹è¿è¡Œå³å¯ï¼Œå‚è€ƒã€‚ ","date":"2022-08-12","objectID":"/posts/electron-summary/:2:3","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"remote ä¸è¦é¢‘ç¹ä½¿ç”¨ remote, æ›´å¤šåº”è¯¥æ‰‹åŠ¨è¿›è¡Œå’Œä¸»è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ ä½¿ç”¨æ—¶éœ€åœ¨çª—å£åˆ›å»ºæ—¶è®¾ç½® webPreferences.enableRemoteModule ä¸º trueã€‚ æ—§ç‰ˆæœ¬çš„ electron.remote å·²ç»å¼ƒç”¨ï¼Œåº”è¯¥ä½¿ç”¨ä¾èµ– electron/remote ä»£æ›¿ã€‚ ä½¿ç”¨äº†æ—§ç‰ˆæœ¬çš„ remote æ—¶ä¼šæœ‰æ§åˆ¶å°è­¦å‘Šä¿¡æ¯ï¼š (electron) The remote module is deprecated. Use https://github.com/electron/remote instead. è·å–å½“å‰çª—å£ï¼šremote.getCurrentWindow() ","date":"2022-08-12","objectID":"/posts/electron-summary/:2:4","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"é—®é¢˜ç‚¹ ","date":"2022-08-12","objectID":"/posts/electron-summary/:3:0","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"æ‰“å¼€å¤–éƒ¨æµè§ˆå™¨ electron çš„ shell æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨ shell.openExternal(url) åœ¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€é“¾æ¥ã€‚ ","date":"2022-08-12","objectID":"/posts/electron-summary/:3:1","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"é˜²æŠ–ä¸èŠ‚æµ é˜²æŠ–ï¼šçŸ­æœŸå†…å¤§é‡è§¦å‘äº‹ä»¶æ—¶ï¼Œåªæ‰§è¡Œæœ€åä¸€æ¬¡ã€‚ function debounce(fn) { let timer = null; return function () { clearTimeOut(timer); timer = setTimeOut(() =\u003e { fn.applay(this, arguments); }, 300); }; } èŠ‚æµï¼šçŸ­æœŸå†…å¤§é‡è§¦å‘äº‹ä»¶æ—¶ï¼Œåªæ‰§è¡Œç¬¬ä¸€æ¬¡ã€‚ function throttle(fn) { let timer = null; return function () { if (timer) return; timer = setTimeOut(() =\u003e { fn.applay(this, arguments); timer = null; }, 300); }; } ","date":"2022-08-12","objectID":"/posts/electron-summary/:3:2","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"devTools åˆå§‹åŒ–çª—å£æ—¶è®¾ç½® webPreferences.devTools ä¸º trueï¼Œç„¶åé€šè¿‡ mainWindow.webContents.openDevTools() æ‰“å¼€å¼€å‘è€…å·¥å…·ã€‚ å¦‚æœåªåœ¨å¼€å‘ç¯å¢ƒå¯ç”¨å¼€å‘è€…å·¥å…·ï¼Œåˆ™éœ€è¦è®¾ç½® webPreferences.devTools ä¸º process.env.NODE_ENV === 'development' ","date":"2022-08-12","objectID":"/posts/electron-summary/:3:3","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"å¯åŠ¨ç™½å± åœ¨åˆ›å»ºçª—å£æ—¶è®¾ç½® show: falseï¼Œåœ¨ ready-to-show äº‹ä»¶ä¹‹åæ‰§è¡Œ mainWindow.show()ï¼Œ å¯è§å®˜æ–¹æ–‡æ¡£ ä¼˜é›…åœ°æ˜¾ç¤ºçª—å£ã€‚ å¯åŠ¨å‰ loading é¢å¤–åˆ›å»ºä¸€ä¸ª loading çª—å£ï¼Œè¯¥çª—å£å¯è®¾ç½®ä¸ºé€æ˜åªåŒ…å« loading å›¾æ ‡å’Œæ–‡å­—ï¼Œåœ¨ mainWindow.show() åå…³é—­ã€‚ å¯åŠ¨å loading å¦‚æœä½¿ç”¨äº† Vue æ¡†æ¶ï¼Œåœ¨ Vue åˆå§‹åŒ–ä¹‹å‰çª—å£è™½ç„¶å‡ºç°äº†ï¼Œä½†æ˜¯å†…å®¹æ—¶ç©ºç™½çš„ï¼Œå¯ä»¥åœ¨ Vue å®ä¾‹ #app é‡Œå†™ä¸€ä¸ª loading, Vue åŠ è½½å®Œåä¼šè¦†ç›–æ‰ã€‚ \u003cdiv id=\"app\"\u003e \u003c!-- Display the loading icon and text until Vue initialization is complete --\u003e \u003cstyle type=\"text/css\"\u003e html, body { height: 100%; margin: 0; } body { display: flex; } #app { margin: auto; display: flex; align-items: center; } @media (prefers-color-scheme: dark) { body { color: #fff; background-color: #202124; } } \u003c/style\u003e \u003csvg xmlns=\"http://www.w3.org/2000/svg\" style=\"margin:auto;background:0 0\" width=\"60\" height=\"60\" viewBox=\"0 0 100 100\" preserveAspectRatio=\"xMidYMid\" display=\"block\" \u003e \u003ccircle cx=\"50\" cy=\"50\" r=\"20\" stroke-width=\"4\" stroke=\"#a5a5a5\" stroke-dasharray=\"31.416 31.416\" fill=\"none\" stroke-linecap=\"round\" transform=\"rotate(67.21 50 50)\" \u003e \u003canimateTransform attributeName=\"transform\" type=\"rotate\" repeatCount=\"indefinite\" dur=\"1s\" keyTimes=\"0;1\" values=\"0 50 50;360 50 50\" /\u003e \u003c/circle\u003e \u003c/svg\u003e \u003cspan\u003eåŠ è½½ä¸­ ...\u003c/span\u003e \u003c/div\u003e ","date":"2022-08-12","objectID":"/posts/electron-summary/:3:4","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"é˜»æ­¢çª—å£å…³é—­ å¯ä»¥åœ¨å…³é—­å‰ä¸€äº›äº‹ä»¶é‡Œåšæ‹¦æˆªï¼Œæ¯”å¦‚ï¼šonbeforeunload ç­‰ï¼Œè¯¦è§ å®ä¾‹äº‹ä»¶ã€‚ ","date":"2022-08-12","objectID":"/posts/electron-summary/:3:5","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"æ‰‹åŠ¨å…³é—­çª—å£ å½“è‡ªå®šä¹‰å…³é—­æ—¶ï¼Œä½¿ç”¨ mainWindow.destroy() æ¥å…³é—­çª—å£ï¼Œå› ä¸ºä½¿ç”¨ mainWindow.close() æ—¶ï¼Œwindows ç³»ç»Ÿæ‰“å¼€å¼€å‘è€…å·¥å…·æ—¶ä¼šå‡ºç°æ— æ³•å…³é—­çª—å£çš„æƒ…å†µã€‚ ","date":"2022-08-12","objectID":"/posts/electron-summary/:3:6","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"å…¨å±€å¿«æ·é”® å½“ electron ç‰ˆæœ¬è¾ƒä½æ—¶ï¼Œæ¯”å¦‚ 13.1.7ï¼Œä¼šå‡ºç°åœ¨ mac ç³»ç»Ÿä¸Šå¤åˆ¶ç²˜è´´ç­‰å¸¸ç”¨å¿«æ·é”®å¤±æ•ˆçš„é—®é¢˜ã€‚å¯é€šè¿‡è®¾ç½®èœå•å¹¶ç»‘å®šå¿«æ·é”®çš„æ–¹å¼è§£å†³ã€‚ const main = [ { label: '', submenu: [ { label: 'å…³äº', role: 'about' }, { label: 'å…³é—­', role: 'close' }, { label: 'é€€å‡º', role: 'quit' } ] }, { label: 'ç¼–è¾‘', submenu: [ { label: 'æ’¤é”€', role: 'undo' }, { label: 'æ¢å¤', role: 'redo' }, { type: 'separator' }, { label: 'å‰ªåˆ‡', role: 'cut' }, { label: 'å¤åˆ¶', role: 'copy' }, { label: 'ç²˜è´´', role: 'paste' }, { type: 'separator' }, { label: 'å…¨é€‰', role: 'selectAll' } ] } ]; const dev = [ { label: 'å¼€å‘è€…', submenu: [ { label: 'åˆ·æ–°', role: 'reload' }, { label: 'å¼ºåˆ¶åˆ·æ–°', role: 'forcereload' }, { type: 'separator' }, { label: 'å¼€å‘è€…å·¥å…·', role: 'toggledevtools' } ] } ]; if (process.env.NODE_ENV === 'development') { main.push(...dev); } export default main; import memuConfig from './menu'; import { Menu } from 'electron'; if (process.platform === 'darwin') { const menu = Menu.buildFromTemplate(memuConfig); Menu.setApplicationMenu(menu); } ","date":"2022-08-12","objectID":"/posts/electron-summary/:3:7","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"electron-builder ä¸‹è½½æ—¶ï¼Œå¯èƒ½å› ä¸ºç½‘ç»œé—®é¢˜å¯¼è‡´ä¸‹è½½å¤±è´¥ï¼Œå¯è®¾ç½® GitHub ä¸‹è½½é•œåƒã€‚ # GitHub ä»“åº“ä¸‹è½½åœ°å€å‰ç¼€é•œåƒ # disturl=https://registry.npmmirror.com/-/binary/ æˆ–è€…å» GitHub æ‰‹åŠ¨ä¸‹è½½ï¼Œç„¶åè§£å‹åˆ°ç¼“å­˜ç›®å½•ï¼š macOS: ~/Library/Caches/electron-builder/ linux: ~/.cache/electron-builder/ windows: %LOCALAPPDATA%\\electron-builder\\cache\\ mac ä¸Šç¼“å­˜ç›®å½•å¦‚ä¸‹ï¼Œå…¶ä»–å¯ å‚è€ƒ â–¸ nsis/ â–¸ nsis-resources-3.4.1/ â–¸ nsis-3.0.4.1/ â–¸ winCodeSign/ â–¸ winCodeSign-2.6.0/ â–¸ wine/ â–¸ wine-4.0.1-mac/ windows æ‰“åŒ… windows ç³»ç»Ÿæ‰“åŒ…é…ç½®ï¼Œå½“æ²¡æœ‰é…ç½®ç­¾åæ—¶ï¼Œsign å­—æ®µåº”åˆ é™¤æˆ–è€…é…ç½®ä¸º nullï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´æ‰“åŒ…æ—¶æŠ¥é”™ã€‚ { \"win\": { \"icon\": \"static/icons/icon.ico\", \"verifyUpdateCodeSignature\": false, \"target\": \"nsis\", \"sign\": null } } æ³¨ï¼šwin11 æ‰“åŒ…åœ¨ win10 ä¸Šå¯èƒ½è¿è¡Œä¸äº†ï¼Œæœ€å¥½ä½¿ç”¨ win10 æ‰“åŒ…æˆ–è€… mac æ‰“åŒ…æŒ‡å®šç³»ç»Ÿå’Œä½æ•°ã€‚ macOS æ‰“åŒ… é—®é¢˜ï¼šmac å‡çº§ä¹‹å electron æ‰“åŒ…æŠ¥é”™ Exit code: ENOENT. spawn /usr/bin/python ENOENT è§£å†³ï¼šç½‘ä¸Šæœåˆ°çš„ä¸‹è½½ python 2.7 æ˜¯æ²»æ ‡ä¸æ²»æœ¬ï¼Œæ­£ç¡®åšæ³•æ˜¯å‡çº§ electron-builder åˆ° 23.0.2 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå‚è€ƒ electron-builder#6726 å‚è€ƒé“¾æ¥ Electron-Mac åº”ç”¨çš„ç­¾åæ­¥éª¤è¯´æ˜ ","date":"2022-08-12","objectID":"/posts/electron-summary/:3:8","tags":["electron"],"title":"electron è¸©å‘æ€»ç»“","uri":"/posts/electron-summary/"},{"categories":["JavaScript"],"content":"è®°å½•ä¸€ä¸‹å‰ç«¯å®ç°é¡µé¢åŠ å¯†çš„æ€è·¯ã€‚ ","date":"2022-08-08","objectID":"/posts/encryption-fe/:0:0","tags":["JavaScript","åŠ å¯†"],"title":"å‰ç«¯é¡µé¢å†…å®¹åŠ å¯†æ€»ç»“","uri":"/posts/encryption-fe/"},{"categories":["JavaScript"],"content":"åŠ å¯†åŸºç¡€çŸ¥è¯† ","date":"2022-08-08","objectID":"/posts/encryption-fe/:1:0","tags":["JavaScript","åŠ å¯†"],"title":"å‰ç«¯é¡µé¢å†…å®¹åŠ å¯†æ€»ç»“","uri":"/posts/encryption-fe/"},{"categories":["JavaScript"],"content":"åŒå‘åŠ å¯† å¯è¿˜åŸçš„åŠ å¯†ç®—æ³•ï¼Œå¯ä»¥é€†å‘è§£å¯†ã€‚ å¯¹ç§°åŠ å¯†ï¼ˆå•å¯†é’¥åŠ å¯†ï¼‰ é‡‡ç”¨å•é’¥å¯†ç ç³»ç»Ÿçš„åŠ å¯†æ–¹æ³•ï¼ŒåŒä¸€ä¸ªå¯†é’¥åŒæ—¶ç”¨ä½œä¿¡æ¯çš„åŠ å¯†å’Œè§£å¯†ã€‚ å¯†é’¥ç”Ÿæˆç®—æ³•æœ‰ DESã€3DESã€AESã€‚ éå¯¹ç§°åŠ å¯†ï¼ˆå…¬å¼€å¯†é’¥ç³»ç»Ÿï¼‰ ä¸¤ä¸ªå¯†é’¥ï¼šå…¬å¼€å¯†é’¥ï¼ˆpublickeyï¼‰å’Œç§æœ‰å¯†é’¥ï¼ˆprivatekeyï¼‰ã€‚ å…¬é’¥/ç§é’¥åŠ å¯†/ç­¾åï¼Œç”¨ç§é’¥/å…¬é’¥è§£å¯†/éªŒè¯ç­¾åã€‚ å¯†é’¥ç”Ÿæˆç®—æ³•æœ‰ RSAï¼ˆå…¬é’¥ã€ç§é’¥ï¼‰ã€DSAï¼ˆå…¬é’¥ã€ç§é’¥ã€æ•°å­—ç­¾åï¼‰ã€‚ ","date":"2022-08-08","objectID":"/posts/encryption-fe/:1:1","tags":["JavaScript","åŠ å¯†"],"title":"å‰ç«¯é¡µé¢å†…å®¹åŠ å¯†æ€»ç»“","uri":"/posts/encryption-fe/"},{"categories":["JavaScript"],"content":"å•å‘åŠ å¯† ä¸å¯è¿˜åŸçš„åŠ å¯†ç®—æ³•ï¼ˆæš´åŠ›æ’åº“é™¤å¤–ï¼‰ï¼Œå¸¸è§çš„ç®—æ³•æœ‰ï¼šMD5ã€SHA1ã€SHA256ã€SHA512ã€‚ ","date":"2022-08-08","objectID":"/posts/encryption-fe/:1:2","tags":["JavaScript","åŠ å¯†"],"title":"å‰ç«¯é¡µé¢å†…å®¹åŠ å¯†æ€»ç»“","uri":"/posts/encryption-fe/"},{"categories":["JavaScript"],"content":"é¡µé¢å†…å®¹åŠ å¯† å†…å®¹åŠ å¯†ç®—æ³• é€šè¿‡æ¯”å¯¹å¯†ç å’Œè¾“å…¥çš„ md5 å€¼æ¥åˆ¤æ–­å¯†ç æ˜¯å¦è¾“å…¥æ­£ç¡® å¯†ç éªŒè¯é€šè¿‡åï¼Œå¼€å§‹è§£å¯†å†…å®¹ æ‹¿åˆ°æ­£ç¡®çš„è¾“å…¥å€¼çš„ sha256 å€¼çš„éƒ¨åˆ†å†…å®¹ ç„¶åæŒ‰ç…§åŠ å¯†è§„åˆ™è§£ç§˜å†…å®¹ è¿™é‡Œåˆ©ç”¨ Set è¿›è¡Œäº‹ä»¶ç®¡ç†ï¼Œç®€å•æ¨¡æ‹Ÿäº† addEventListener å’Œ removeEventListener çš„æ“ä½œã€‚å¹¶æä¾›äº†ä¸¤ä¸ªäº‹ä»¶ï¼šdecrypted å’Œ resetï¼Œè¯¦è§ fixit-decryptor.jsã€‚ ","date":"2022-08-08","objectID":"/posts/encryption-fe/:2:0","tags":["JavaScript","åŠ å¯†"],"title":"å‰ç«¯é¡µé¢å†…å®¹åŠ å¯†æ€»ç»“","uri":"/posts/encryption-fe/"},{"categories":["Node.js","JavaScript"],"content":" é—®é¢˜ è…¾è®¯äº‘äº‘å‡½æ•°ä» 2022 å¹´ 6 æœˆ 1 æ—¥å¼€å§‹æ”¶è´¹äº†ï¼Œå·®ä¸å¤šæ¯ä¸ªæœˆ 12 å—ï¼Œå¯¹äºå¯èƒ½å‡ ä¸ªæœˆéƒ½ç”¨ä¸ä¸Šä¸€æ¬¡äº‘å‡½æ•°åˆ·æ–°ç¼“å­˜çš„äººæ¥è¯´ï¼Œæœ‰ç‚¹å¤ªè´µäº†ã€‚ ä½¿ç”¨ Node.js å’Œ GitHub Actions åˆ·æ–° CDN çš„æ–¹å¼ï¼Œå¯ä»¥èŠ‚çœä¸å°‘é’±ã€‚ ","date":"2022-08-07","objectID":"/posts/qcloudcdn/:0:0","tags":["CDN","GitHub Actions","Node.js"],"title":"Node.js + GitHub Actions è‡ªåŠ¨åˆ·æ–° CDN","uri":"/posts/qcloudcdn/"},{"categories":["Node.js","JavaScript"],"content":"å®‰è£…ä¾èµ– npm install qcloud-cdn-node-sdk ","date":"2022-08-07","objectID":"/posts/qcloudcdn/:1:0","tags":["CDN","GitHub Actions","Node.js"],"title":"Node.js + GitHub Actions è‡ªåŠ¨åˆ·æ–° CDN","uri":"/posts/qcloudcdn/"},{"categories":["Node.js","JavaScript"],"content":"ç¼–å†™è„šæœ¬ vim .scripts/qcloudcdn.js /** * Refresh Qcloud CDN cache * @command `node qcloudcdn.js $SECRET_ID $SECRET_KEY` */ const qcloudSDK = require('qcloud-cdn-node-sdk'); // Get the config from https://console.qcloud.com/capi qcloudSDK.config({ secretId: process?.argv[2], secretKey: process?.argv[3] }); qcloudSDK.request( 'RefreshCdnDir', { // See https://cloud.tencent.com/document/api/228/3947 'dirs.0': 'https://lruihao.cn/' }, (res) =\u003e { res.code \u0026\u0026 console.log(res); } ); ","date":"2022-08-07","objectID":"/posts/qcloudcdn/:2:0","tags":["CDN","GitHub Actions","Node.js"],"title":"Node.js + GitHub Actions è‡ªåŠ¨åˆ·æ–° CDN","uri":"/posts/qcloudcdn/"},{"categories":["Node.js","JavaScript"],"content":"å¢åŠ å¿«æ·æŒ‡ä»¤ æ‰“å¼€ package.json å¢åŠ  scripts: { \"scripts\": { \"qcloudcdn\": \"node .scripts/qcloudcdn.js $SECRET_ID $SECRET_KEY\" } } è¿è¡Œæ–¹å¼ï¼š SECRET_ID=\u003csecretId\u003e SECRET_KEY=\u003csecretKey\u003e npm run qcloudcdn Mac OS ç¯å¢ƒå˜é‡é…ç½®ï¼ˆå¯é€‰ï¼‰ vim ~/.bash_profile # Qcloud secret key-value export SECRET_ID=\u003csecretId\u003e export SECRET_KEY=\u003csecretKey\u003e source ~/.bash_profile ç„¶åï¼Œåœ¨æœ¬åœ°å¯ç®€åŒ–æŒ‡ä»¤ä¸º npm run qcloudcdn æˆ–è€… yarn qcloudcdnã€‚ ç­‰åŒäº SECRET_ID=$SECRET_ID SECRET_KEY=$SECRET_KEY npm run qcloudcdn ","date":"2022-08-07","objectID":"/posts/qcloudcdn/:3:0","tags":["CDN","GitHub Actions","Node.js"],"title":"Node.js + GitHub Actions è‡ªåŠ¨åˆ·æ–° CDN","uri":"/posts/qcloudcdn/"},{"categories":["Node.js","JavaScript"],"content":"é…ç½® GitHub Actions åœ¨åŸæœ‰ GitHub Actions ä¸­éƒ¨ç½²åå¢åŠ ä¸€ä¸ªæ­¥éª¤ï¼š - name: Refresh Qcloud CDN cache env: SECRET_ID: ${{ secrets.SECRET_ID }} SECRET_KEY: ${{ secrets.SECRET_KEY }} run: npm run qcloudcdn åœ¨ä»“åº“ Settings \u003e Secrets \u003e Actions ä¸­å¢åŠ ä¸¤ä¸ª Secret: SECRET_ID å’Œ SECRET_KEYï¼ŒåŸæ¥æœ‰é…ç½®è¿‡çš„å°±ä¸ç”¨äº†ï¼Œæ¯”å¦‚ï¼Œæˆ‘åŸæ¥çš„å« COS_SECRET_ID å’Œ COS_SECRET_IDï¼Œé‚£ä¿®æ”¹ä¸Šé¢é…ç½® env ä¸­çš„å˜é‡åå³å¯ã€‚ æœ€åä¸Šä¼ ä»£ç ï¼Œä»¥åæ›´æ–°ä»“åº“æ—¶å°±ä¼šè‡ªåŠ¨åˆ·æ–° CDN ç¼“å­˜äº†ã€‚ ","date":"2022-08-07","objectID":"/posts/qcloudcdn/:4:0","tags":["CDN","GitHub Actions","Node.js"],"title":"Node.js + GitHub Actions è‡ªåŠ¨åˆ·æ–° CDN","uri":"/posts/qcloudcdn/"},{"categories":["Node.js","JavaScript"],"content":"å‚è€ƒèµ„æ–™ Qcloud_CDN_API/nodejs æœ¬æ–¹æ¡ˆä½¿ç”¨çš„æ—§çš„ API è¯·æ±‚æ–¹å¼ï¼Œå¦‚æœå¤±æ•ˆï¼Œå¯ä»¥å‚è€ƒæ–°çš„ APIï¼Œè§ SDK ä¸­å¿ƒã€‚ ","date":"2022-08-07","objectID":"/posts/qcloudcdn/:5:0","tags":["CDN","GitHub Actions","Node.js"],"title":"Node.js + GitHub Actions è‡ªåŠ¨åˆ·æ–° CDN","uri":"/posts/qcloudcdn/"},{"categories":["OS"],"content":"æ¢è¡Œç¬¦ï¼ˆé€šå¸¸ç§°ä¸ºè¡Œå°¾ã€è¡Œå°¾ (EOL)ã€ä¸‹ä¸€è¡Œ (NEL) æˆ–æ¢è¡Œç¬¦ï¼‰æ˜¯å­—ç¬¦ç¼–ç è§„èŒƒï¼ˆä¾‹å¦‚ï¼ŒASCIIã€EBCDICï¼‰ä¸­çš„æ§åˆ¶å­—ç¬¦æˆ–æ§åˆ¶å­—ç¬¦åºåˆ—ï¼Œç”¨äºè¡¨ç¤ºä¸€è¡Œæ–‡æœ¬çš„ç»“å°¾å’Œæ–°æ–‡æœ¬çš„å¼€å¤´ã€‚ å‘¨äº”ä¸‹ç­çš„æ—¶å€™æƒ³åœ¨ windows ç”µè„‘ä¸Šè·‘ä¸€ä¸‹ FixIt çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆ bug, ç„¶åå°±å‘ç°äº† typyit shortcode å¼€å¤´å¤šå‡ºä¸€è¡Œç©ºè¡Œï¼Œmermaid shortcode åˆ™ç›´æ¥è¯­æ³•æŠ¥é”™äº†ã€‚ çœ‹äº†ä¸€ä¸‹ä»£ç æ˜æ˜æœ‰ trim \\n å¤„ç†ï¼Œè€Œä¸” Vercel æ‰“åŒ…å’Œ Mac ä¸Šè¿è¡Œæ‰“åŒ…éƒ½æ²¡é—®é¢˜ã€‚debug äº†ä¸€ä¸‹æ‰å‘ç° Windows ç³»ç»Ÿä¸Šçš„æ¢è¡Œæ˜¯ \\r\\n, è€Œ Mac ç³»ç»Ÿä¸Šçš„æ¢è¡Œæ˜¯ \\nã€‚äºæ˜¯æŸ¥äº†ä¸€ä¸‹ä¸åŒç³»ç»Ÿçš„æ¢è¡Œç¬¦çš„å·®å¼‚é—®é¢˜ã€‚ ","date":"2022-08-07","objectID":"/posts/newline/:0:0","tags":["newline"],"title":"ä¸åŒç³»ç»Ÿçš„æ¢è¡Œç¬¦çš„å·®å¼‚","uri":"/posts/newline/"},{"categories":["OS"],"content":"å†å² ç®€å•æ¥è¯´ï¼Œå›è½¦æ¢è¡Œè¿™äº›è¯´æ³•æ˜¯ä»æ‰“å­—æœºé‚£ä¸ªæ—¶ä»£å¼€å§‹å«çš„ï¼Œç„¶ååœ¨ä¸åŒçš„æ ‡å‡†ä¸‹æ¢è¡Œç¬¦æœ‰ä¸åŒçš„è¡¨ç°ç¬¦å·ã€‚ Windows ç³»ç»Ÿè®¾è®¡éµå¾ªäº† CR + LF çš„çº¦å®šï¼Œè€Œ Unix ç³»ç»Ÿåˆ™éµå¾ªäº† LF çš„çº¦å®šï¼Œä¹‹åçš„ ç±» Unix (Linux, macOS) ç³»ç»Ÿä¹Ÿéµå¾ªäº† LF çš„çº¦å®šã€‚ å½“ç„¶ä¹Ÿæœ‰å¼‚ç±»ï¼Œè€ç‰ˆçš„ mac ç³»ç»Ÿä½¿ç”¨ CR ä½œä¸ºæ¢è¡Œç¬¦ã€‚ ","date":"2022-08-07","objectID":"/posts/newline/:1:0","tags":["newline"],"title":"ä¸åŒç³»ç»Ÿçš„æ¢è¡Œç¬¦çš„å·®å¼‚","uri":"/posts/newline/"},{"categories":["OS"],"content":"è¡¨ç¤º CR å›è½¦ï¼š\\r LF æ¢è¡Œï¼š\\n æ“ä½œç³»ç»Ÿ æ¢è¡Œç¬¦å· Windows \\r\\n Unixã€Linuxã€MacOS \\n classic Mac OS \\r ","date":"2022-08-07","objectID":"/posts/newline/:2:0","tags":["newline"],"title":"ä¸åŒç³»ç»Ÿçš„æ¢è¡Œç¬¦çš„å·®å¼‚","uri":"/posts/newline/"},{"categories":["OS"],"content":"é—®é¢˜ ç”±äºè¿™ä¸ªå·®å¼‚ï¼Œä¼šå¯¼è‡´æ–‡æœ¬ç±»çš„æ–‡ä»¶åœ¨è·¨ç³»ç»Ÿæµè§ˆæ—¶ä¼šäº§ç”Ÿä¸€äº›å·®å¼‚ï¼Œæ¯”å¦‚è¯´ï¼ŒMac çš„æ–‡æœ¬æ–‡ä»¶åœ¨ Windows æ‰“å¼€ä¼šå…¨éƒ¨æŒ¤åœ¨ä¸€è¡Œç­‰ç­‰ã€‚ å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œè¿™å¾ˆæœ‰å¯èƒ½å¯¼è‡´æŸäº›ç¨‹åºå¤±æ•ˆï¼Œæ¯”å¦‚æ­£åˆ™å»é™¤ç©ºè¡Œç­‰ç­‰ã€‚ ç”šè‡³å› æ­¤ï¼ŒLinux ç³»ç»Ÿä¸‹æä¾›æœ‰ä¸¤ä¸ªå‘½ä»¤ç”¨æ¥è¿›è¡Œ Windows å’Œ Unix æ–‡ä»¶çš„è½¬åŒ–ï¼šdos2unixå’Œ unix2dosã€‚ ","date":"2022-08-07","objectID":"/posts/newline/:3:0","tags":["newline"],"title":"ä¸åŒç³»ç»Ÿçš„æ¢è¡Œç¬¦çš„å·®å¼‚","uri":"/posts/newline/"},{"categories":["OS"],"content":"å‚è€ƒ Newline ","date":"2022-08-07","objectID":"/posts/newline/:4:0","tags":["newline"],"title":"ä¸åŒç³»ç»Ÿçš„æ¢è¡Œç¬¦çš„å·®å¼‚","uri":"/posts/newline/"},{"categories":["Grocery"],"content":"ohmyzsh è‡ªå¸¦äº†å¾ˆå¤šä¸»é¢˜ï¼Œä¹Ÿæœ‰å¾ˆå¤šæ²¡æœ‰æ”¶å½•çš„æ‰©å±•ä¸»é¢˜ï¼Œæˆ‘å°±æƒ³è¦ä¸ªç®€çº¦çš„ä¸»é¢˜ï¼Œä½†æ˜¯æ¯ä¸ªéƒ½å·®ç‚¹æ„æ€ï¼Œå¹²è„†æ”¹ä¸€ä¸ªä¸»é¢˜ã€‚ ","date":"2022-07-31","objectID":"/posts/ohmyzsh-custom/:0:0","tags":null,"title":"è‡ªå®šä¹‰ ohmyzsh ä¸»é¢˜","uri":"/posts/ohmyzsh-custom/"},{"categories":["Grocery"],"content":"è‡ªå®šä¹‰ä¸»é¢˜ å¤åˆ¶é»˜è®¤ä¸»é¢˜ï¼Œå½“ä½œæ¨¡æ¿ï¼š cd ~/.oh-my-zsh cat themes/robbyrussell.zsh-theme \u003e custom/custom.zsh-theme vim custom/custom.zsh-theme ç„¶åä¿®æ”¹é‡Œé¢çš„å†…å®¹ï¼š if [[ -z $ZSH_THEME_CUSTOM_PREFIX ]]; then ZSH_THEME_CUSTOM_PREFIX=\"\u003e\" fi PROMPT=\"%(?:%{$fg_bold[blue]%}$ZSH_THEME_CUSTOM_PREFIX:%{$fg_bold[red]%}$ZSH_THEME_CUSTOM_PREFIX)\" PROMPT+=' %{$fg[blue]%}%c%{$reset_color%} $(git_prompt_info)' ZSH_THEME_GIT_PROMPT_PREFIX=\"%{$fg_bold[green]%}git:(%{$fg[magenta]%}\" ZSH_THEME_GIT_PROMPT_SUFFIX=\"%{$reset_color%} \" ZSH_THEME_GIT_PROMPT_DIRTY=\"%{$fg[green]%}) %{$fg[yellow]%}âœ—\" ZSH_THEME_GIT_PROMPT_CLEAN=\"%{$fg[green]%})\" ","date":"2022-07-31","objectID":"/posts/ohmyzsh-custom/:1:0","tags":null,"title":"è‡ªå®šä¹‰ ohmyzsh ä¸»é¢˜","uri":"/posts/ohmyzsh-custom/"},{"categories":["Grocery"],"content":"é…ç½® vim ~/.zshrc ZSH_THEME=custom ç„¶åé‡å¯ç»ˆç«¯å³å¯ã€‚ ","date":"2022-07-31","objectID":"/posts/ohmyzsh-custom/:2:0","tags":null,"title":"è‡ªå®šä¹‰ ohmyzsh ä¸»é¢˜","uri":"/posts/ohmyzsh-custom/"},{"categories":["OS"],"content":"è®°å½• linux ç³»ç»Ÿä¸‹æ–‡ä»¶æƒé™ç›¸å…³çš„å†…å®¹ï¼ŒMac OS ä¸‹ç±»ä¼¼ã€‚ ","date":"2022-07-30","objectID":"/posts/linux-permission/:0:0","tags":["linux","Mac","ä»–å±±ä¹‹çŸ³"],"title":"linux æ–‡ä»¶æƒé™","uri":"/posts/linux-permission/"},{"categories":["OS"],"content":"æŸ¥çœ‹æ–‡ä»¶æƒé™ æŸ¥çœ‹ linux ç³»ç»Ÿä¸‹çš„æ–‡ä»¶æƒé™ï¼Œå¯ä»¥ä½¿ç”¨ ll å‘½ä»¤æˆ–è€… ls å‘½ä»¤ å¸¦ -lï¼ˆé•¿åˆ—è¡¨é€‰é¡¹ï¼‰ âœ ~ ll total 160 drwx------@ 8 liruihao staff 256B Jul 5 14:47 Applications drwx------@ 10 liruihao staff 320B Jul 27 11:31 Desktop drwx------+ 7 liruihao staff 224B Jun 17 15:01 Documents drwx------@ 22 liruihao staff 704B Jul 29 16:35 Downloads drwx------@ 94 liruihao staff 2.9K Jul 23 19:02 Library drwx------ 4 liruihao staff 128B Nov 13 2021 Movies drwx------+ 6 liruihao staff 192B Nov 18 2021 Music drwx------+ 9 liruihao staff 288B Apr 26 10:25 Pictures drwxr-xr-x+ 5 liruihao staff 160B Nov 14 2021 Public drwxr-xr-x 5 liruihao staff 160B Jul 29 17:48 file-share drwxr-xr-x 3 liruihao staff 96B Jul 26 17:17 node_modules -rw-r--r-- 1 liruihao staff 27B Jun 24 13:47 package-lock.json drwxr-xr-x 20 liruihao staff 640B Jul 29 22:20 workspace -rw-r--r-- 1 liruihao staff 86B Jul 26 17:17 yarn.lock æ–‡ä»¶åˆ—è¡¨ä¿¡æ¯åˆ†ä¸ºï¼šæ–‡ä»¶ç±»å‹ã€æƒé™ã€é“¾æ¥æ•°ã€æ‰€å±ç”¨æˆ·ã€æ‰€å±ç”¨æˆ·ç»„ã€æ–‡ä»¶å¤§å°ã€æœ€åä¿®æ”¹æ—¶é—´ã€æ–‡ä»¶åã€‚ ","date":"2022-07-30","objectID":"/posts/linux-permission/:1:0","tags":["linux","Mac","ä»–å±±ä¹‹çŸ³"],"title":"linux æ–‡ä»¶æƒé™","uri":"/posts/linux-permission/"},{"categories":["OS"],"content":"æ–‡ä»¶ç±»å‹ linux ä¸€å…±æœ‰ 7 ç§æ–‡ä»¶ç±»å‹ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š -: æ™®é€šæ–‡ä»¶ d: ç›®å½•æ–‡ä»¶ l: é“¾æ¥æ–‡ä»¶ b: å—è®¾å¤‡æ–‡ä»¶ p: ç®¡é“æ–‡ä»¶ c: å­—ç¬¦è®¾å¤‡æ–‡ä»¶ s: å¥—æ¥å£æ–‡ä»¶/æ•°æ®æ¥å£æ–‡ä»¶ åå››ç§æ˜¯ç‰¹æ®Šæ–‡ä»¶ ","date":"2022-07-30","objectID":"/posts/linux-permission/:2:0","tags":["linux","Mac","ä»–å±±ä¹‹çŸ³"],"title":"linux æ–‡ä»¶æƒé™","uri":"/posts/linux-permission/"},{"categories":["OS"],"content":"æ–‡ä»¶æƒé™å¯¹åº”å…³ç³» æƒé™ å«ä¹‰ å¯¹åº”æ•°å­— r è¯»æƒé™ 4 w å†™æƒé™ 2 x æ‰§è¡Œæƒé™ 1 è¯»ã€å†™ã€è¿è¡Œä¸‰é¡¹æƒé™ç”¨æ•°å­—è¡¨ç¤ºå°±æ˜¯ r=4,w=2,x=1ã€‚æ‰€ä»¥ï¼Œ-rw-r--r-- ç”¨æ•°å­—è¡¨ç¤ºæˆ 644ã€‚ æƒé™å­—æ®µ -rwxrwxrwx çš„å†…å®¹æ€»å…±ä¼šæœ‰ 10 ä¸ª -ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºæ–‡ä»¶ç±»å‹ï¼Œå¦‚è¯¥æ–‡ä»¶æ˜¯æ–‡ä»¶ (-è¡¨ç¤ºï¼‰ï¼Œæ–‡ä»¶å¤¹ (d è¡¨ç¤ºï¼‰, è¿æ¥æ–‡ä»¶ (l è¡¨ç¤ºï¼‰ï¼Œåé¢ 9 ä¸ªæŒ‰ç…§æ¯ä¸‰ä½ä¸ºä¸€ç»„åˆ†ã€‚ drwxr-xr-x 5 liruihao staff 160B Jul 29 17:48 file-share d: ä»£è¡¨æ–‡ä»¶å¤¹ rwx: ä»£è¡¨æ–‡ä»¶æ‰€æœ‰è€… (u è¡¨ç¤ºï¼‰æƒé™ï¼Œè¿™é‡Œæ˜¯ liruihaoï¼Œliruihao å¯¹è¯¥æ–‡ä»¶æ‹¥æœ‰è¯»å†™æ‰§è¡Œæƒé™ã€‚ r-x: ä»£è¡¨æ‰€å±ï¼ˆg è¡¨ç¤ºï¼‰çš„æƒé™ï¼Œè¿™é‡ŒåŒç»„ç”¨æˆ·æ‹¥æœ‰å¯¹è¯¥æ–‡ä»¶è¯»å’Œæ‰§è¡Œçš„æƒé™ã€‚ r-x: ä»£è¡¨å…¶ä»–ç”¨æˆ·ï¼ˆo è¡¨ç¤ºï¼‰çš„æƒé™ï¼Œè¿™é‡Œå’Œä¸Šé¢æƒé™ä¸€æ ·ã€‚ ","date":"2022-07-30","objectID":"/posts/linux-permission/:3:0","tags":["linux","Mac","ä»–å±±ä¹‹çŸ³"],"title":"linux æ–‡ä»¶æƒé™","uri":"/posts/linux-permission/"},{"categories":["Memo"],"content":"è®°å½•ä¸€ä¸‹ä½¿ç”¨ Mac ä½œä¸ºç”Ÿäº§å·¥å…·å¼€å‘çš„ä¸€äº›åŸºæœ¬é…ç½®å’Œç»éªŒã€‚ ","date":"2022-07-29","objectID":"/posts/config4mac/:0:0","tags":["Git","Mac","Node.js"],"title":"Mac ä¸Šçš„å¼€å‘é…ç½®æ€»ç»“","uri":"/posts/config4mac/"},{"categories":["Memo"],"content":"é…ç½®æ–‡ä»¶ Mac ä¸Šæœ‰å¾ˆå¤šé…ç½®æ–‡ä»¶éƒ½å¯ä»¥ç”¨æ¥ä¿å­˜ç¯å¢ƒå˜é‡ç­‰é…ç½®ï¼Œæ ¹æ®è‡ªå·±çš„ç†è§£è®°å½•äº†å››ä¸ªæ–‡ä»¶çš„ç”¨é€”ï¼š # etc/profile ç³»ç»Ÿé…ç½®æ–‡ä»¶ # etc/.bash_profile ç³»ç»Ÿç¯å¢ƒå˜é‡é…ç½® # ~/.bash_profile ä¸ªäººç¯å¢ƒå˜é‡é…ç½® # ~/.zshrc zsh çš„é…ç½®æ–‡ä»¶ # $ZSH_CUSTOM/*.zsh è‡ªå®šä¹‰ zsh è„šæœ¬ï¼Œåœ¨ zsh å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ ç¼–è¾‘æœ€å¤šçš„åº”è¯¥æ˜¯ ~/.bash_profile å’Œ ~/.zshrc, åŸºæœ¬ä¸Šå»ºè®®æ‰€æœ‰çš„ä¸ªäººé…ç½®éƒ½æ”¾åœ¨ ~/.bash_profile ä¸­ï¼Œç„¶ååœ¨ ~/.zshrc æœ€åæ‰§è¡Œ source ~/.bash_profile, è¿™æ ·ä¹Ÿæ–¹ä¾¿å°†è‡ªå·±çš„ä¸ªäººç¯å¢ƒå˜é‡é…ç½®å¤‡ä»½ã€‚ ","date":"2022-07-29","objectID":"/posts/config4mac/:1:0","tags":["Git","Mac","Node.js"],"title":"Mac ä¸Šçš„å¼€å‘é…ç½®æ€»ç»“","uri":"/posts/config4mac/"},{"categories":["Memo"],"content":"å¸¸ç”¨å‘½ä»¤ # å®‰è£…/å¸è½½ homebrew install.sh/uninstall.sh /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\" # æ³¨æ„ï¼šå®‰è£… Homebrew ä¼šä¸‹è½½ node, è¯·åšå¥½ node ç¯å¢ƒè¢«ç ´åçš„å‡†å¤‡ # æ˜¾ç¤ºéšè—æ–‡ä»¶ true/false or cmd+shift+. defaults write com.apple.finder AppleShowAllFiles -boolean true ; killall Finder # é‡Šæ”¾ç«¯å£ lsof -i:$your_port # 1. æŸ¥çœ‹ä½¿ç”¨ç«¯å£è¿›ç¨‹ kill -9 $your_PID # 2. é‡Šæ”¾è¿›ç¨‹ ","date":"2022-07-29","objectID":"/posts/config4mac/:2:0","tags":["Git","Mac","Node.js"],"title":"Mac ä¸Šçš„å¼€å‘é…ç½®æ€»ç»“","uri":"/posts/config4mac/"},{"categories":["Memo"],"content":"Node # è®¾ç½®é˜¿é‡Œé•œåƒ npm config set registry=https://registry.npmmirror.com # npm config set registry https://registry.npmjs.org # GitHub ä»“åº“ä¸‹è½½åœ°å€å‰ç¼€é•œåƒ # disturl=https://registry.npmmirror.com/-/binary/ # å…¨å±€å®‰è£…çš„ä¾èµ– npm install -g npm@8.13.1 npm install -g cnpm npm install -g @vue/cli npm install -g nvm npm install -g nrm npm install -g yarn npm install -g yrm # npm å‚æ•° --ignore-scripts # å¿½ç•¥è„šæœ¬é”™è¯¯ --force # ä¼šæ— è§†å†²çªï¼Œå¹¶å¼ºåˆ¶è·å–è¿œç«¯ npm åº“èµ„æºï¼Œå³ä½¿æœ¬åœ°æœ‰èµ„æºä¹Ÿä¼šè¦†ç›–æ‰ --legacy-peer-deps # å®‰è£…æ—¶å¿½ç•¥æ‰€æœ‰ peerDependenciesï¼Œå¿½è§†ä¾èµ–å†²çªï¼Œé‡‡ç”¨ npm ç‰ˆæœ¬ 4 åˆ°ç‰ˆæœ¬ 6 çš„æ ·å¼å»å®‰è£…ä¾èµ–ï¼Œå·²æœ‰çš„ä¾èµ–ä¸ä¼šè¦†ç›– # æ¸…é™¤ç¼“å­˜ npm cache clean --force rm -rf node_modules rm -rf package-lock.json npm install # nvm nvm alias default [node_version] # è®¾ç½®é»˜è®¤ç‰ˆæœ¬ # æ£€æŸ¥è¿‡æ—¶ä¾èµ– npm outdated # å®‰å…¨æ›´æ–° npm update # ncu æ›´æ–°æ£€æŸ¥å·¥å…· # https://blog.51cto.com/u_13028258/5115637?b=totalstatistic npm install -g npm-check-updates ## æ£€æŸ¥ ncu ncu vue ## æ›´æ–° ncu -u ncu -u vue electron ç›¸å…³é…ç½® # è®¾ç½® electron é•œåƒä»“åº“ # https://registry.npmmirror.com/-/binary/electron # 13.1.7 ç‰ˆæœ¬ ä¸‹è½½é“¾æ¥å¯èƒ½ä¼šæ‹¼é”™å¯¼è‡´ 404ï¼Œè¦è®¾ç½®æˆ https://registry.npmmirror.com/-/binary/electron/v npm config set electron_mirror=https://npmmirror.com/mirrors/electron/ ","date":"2022-07-29","objectID":"/posts/config4mac/:3:0","tags":["Git","Mac","Node.js"],"title":"Mac ä¸Šçš„å¼€å‘é…ç½®æ€»ç»“","uri":"/posts/config4mac/"},{"categories":["Memo"],"content":"SourceTree Custom actions Script target: /bin/bash Parameters: /Users/liruihao/workspace/.shell/sync_tags.sh æŠ€å·§ æ ¹æ®ä¸åŒçš„ shell ç¨‹åºé€‰æ‹©ä¸åŒçš„æ–‡ä»¶åç¼€åï¼Œå¹¶ç»™æ–‡ä»¶å¢åŠ å¯æ‰§è¡Œæƒé™ï¼š zsh: .zsh bash: .sh #! /bin/bash # åŒæ­¥è¿œç¨‹ä»“åº“æ ‡ç­¾åˆ†æ”¯è„šæœ¬ git tag -l | xargs git tag -d # git fetch origin --prune # git fetch origin --tags git fetch origin --prune --prune-tags #! /bin/bash # åŒæ­¥æ‰€æœ‰å­æ¨¡ç»„ git submodule update --remote --merge #! /bin/zsh # ssh é…ç½®ä½†æ— æ³•è¿æ¥æ—¶ ssh-agent -s ssh-add ~/.ssh/Lruihao-Github # ç§é’¥è·¯å¾„ æŠ€å·§ å¼€æœºå¯åŠ¨æ—¶ç³»ç»Ÿä¼šå»è‡ªåŠ¨è¯»å– id_rsa çš„ç§é’¥æ¥å¯åŠ¨ SSH é“¾æ¥ï¼Œè‹¥ä¸æ˜¯é»˜è®¤å‘½ä»¤å°±ä¼šå¤±è´¥éœ€è¦æ‰‹åŠ¨æ‰§è¡Œä¸Šè¯‰å‘½ä»¤å¯åŠ¨ï¼Œå¯æ·»åŠ åˆ°å¼€æœºè‡ªå¯åŠ¨ã€‚ SourceTree ç›¸å…³æ–‡ç«  è§£å†³ SourceTree æäº¤æ—¶å€™ husky å‘½ä»¤å¤±è´¥é—®é¢˜ ","date":"2022-07-29","objectID":"/posts/config4mac/:4:0","tags":["Git","Mac","Node.js"],"title":"Mac ä¸Šçš„å¼€å‘é…ç½®æ€»ç»“","uri":"/posts/config4mac/"},{"categories":["Memo"],"content":"Terminal Terminal: ç³»ç»Ÿè‡ªå¸¦ Shell: zsh ç¾åŒ–: ohmyzsh ä¿®æ”¹å¯åŠ¨è¯­ vim $PREFIX/etc/motd ","date":"2022-07-29","objectID":"/posts/config4mac/:5:0","tags":["Git","Mac","Node.js"],"title":"Mac ä¸Šçš„å¼€å‘é…ç½®æ€»ç»“","uri":"/posts/config4mac/"},{"categories":["Memo"],"content":"sublime-text 3 # Terminal å¯ç”¨ sublime åˆ«å subl ## 1.è®¾ç½®è½¯é“¾ï¼ˆæ¨èï¼‰ sudo ln -s \"/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl\" /usr/local/bin/subl ## 2.è®¾ç½®åˆ«å vim ~/.bash_profile alias subl=\"'/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl'\" source ~/.bash_profile # æ¯æ‰“å¼€ä¸€ä¸ªå‘½ä»¤çª—å£ï¼Œéœ€è¦å…ˆè®©å‘½ä»¤ç”Ÿæ•ˆ ","date":"2022-07-29","objectID":"/posts/config4mac/:6:0","tags":["Git","Mac","Node.js"],"title":"Mac ä¸Šçš„å¼€å‘é…ç½®æ€»ç»“","uri":"/posts/config4mac/"},{"categories":["Memo"],"content":"å¼€æœºè‡ªå¯åŠ¨ ç³»ç»Ÿåå¥½è®¾ç½® -\u003e ç”¨æˆ·ä¸ç¾¤ç»„ -\u003e ç™»å½•é¡¹ -\u003e å¢åˆ å¯æ‰§è¡Œæ–‡ä»¶ (éœ€é…ç½®é»˜è®¤å¯åŠ¨è½¯ä»¶) å°† shell å‘½ä»¤æ·»åŠ åˆ° /System/Library/StartupItems/ æˆ– /Library/StartupItems/ æ–‡ä»¶å¤¹ï¼ˆæµ‹è¯•æ— æ•ˆï¼‰ ","date":"2022-07-29","objectID":"/posts/config4mac/:7:0","tags":["Git","Mac","Node.js"],"title":"Mac ä¸Šçš„å¼€å‘é…ç½®æ€»ç»“","uri":"/posts/config4mac/"},{"categories":["Memo"],"content":"å¤‡ä»½ # ------------------------------------- # This configuration is for Lruihao. # https://lruihao.cn/posts/config4mac/ # ------------------------------------- export LC_ALL=en_US.UTF-8 export LANG=en_US.UTF-8 # workspace export WORKSPACE=\"$HOME/workspace\" # alias alias subl=\"'/Applications/Sublime Text.app/Contents/SharedSupport/bin/subl'\" alias mysql=/usr/local/mysql/bin/mysql alias mysqladmin=/usr/local/mysql/bin/mysqladmin alias incr=\"source $WORKSPACE/.shell/incr*.zsh\" alias typora=\"open -a typora\" # maven export M2_HOME=$HOME/Applications/apache-maven-3.8.5 export PATH=$PATH:$M2_HOME/bin # jenv export PATH=\"$HOME/.jenv/bin:$PATH\" eval \"$(jenv init -)\" # java export JAVA_8_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_321.jdk/Contents/Home export JAVA_17_HOME=/Library/Java/JavaVirtualMachines/jdk-17.0.2.jdk/Contents/Home export JAVA_HOME=$JAVA_8_HOME # è®¾ç½®ä¸€ä¸ªä¸­é—´å˜é‡ï¼Œä¸ºäº†æ–¹ä¾¿å¤šä¸ª JDK ç‰ˆæœ¬æ—¶æ›´æ¢ JAVA_HOME export PATH=$JAVA_HOME/bin:$PATH:. # å†’å·å‰ä»£è¡¨ JDK ç›®å½•ä¸‹çš„ bin ç›®å½•ï¼Œå†’å·åä»£è¡¨å½“å‰ç›®å½• export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar # jmeter export JMETER_HOME=$HOME/jmeter/apache-jmeter-5.4.1 export PATH=$JAVA_HOME/bin:$PATH:.:$JMETER_HOME/bin:$PATH export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JMETER_HOME/lib/ext/ApacheJMeter_core.jar:$JMETER_HOME/lib/jorphan.jar:$JMETER_HOME/lib/logkit-2.0.jar # platform-tools of Android SDK export PATH=$PATH:$HOME/Applications/platform-tools # Electron-Mac app development export CSC_LINK=$WORKSPACE/mac_app_dev/Mac.p12 export CSC_KEY_PASSWORD=xxxxxxxxx # yarn export PATH=\"$HOME/.yarn/bin:$HOME/.config/yarn/global/node_modules/.bin:$PATH\" # zsh custom plugin # https://mimosa-pudica.net/zsh-incremental.html # source $WORKSPACE/.shell/incr*.zsh # Qcloud secret key-value export SECRET_ID=\"\" export SECRET_KEY=\"\" # golang export GOROOT=/usr/local/go export GOBIN=$GOROOT/bin export PATH=$PATH:$GOBIN export GOPATH=$HOME/go export GOPROXY=https://goproxy.cn # Go work bin export PATH=$PATH:$GOPATH/bin # sass_embedded export PATH=$PATH:$HOME/Applications/sass_embedded # https://github.com/nvm-sh/nvm#manual-install export NVM_DIR=\"$HOME/.nvm\" [ -s \"$NVM_DIR/nvm.sh\" ] \u0026\u0026 \\. \"$NVM_DIR/nvm.sh\" # This loads nvm [ -s \"$NVM_DIR/bash_completion\" ] \u0026\u0026 \\. \"$NVM_DIR/bash_completion\" # This loads nvm bash_completion # https://github.com/nvm-sh/nvm#deeper-shell-integration autoload -U add-zsh-hook load-nvmrc() { local node_version=\"$(nvm version)\" local nvmrc_path=\"$(nvm_find_nvmrc)\" if [ -n \"$nvmrc_path\" ]; then local nvmrc_node_version=$(nvm version \"$(cat \"${nvmrc_path}\")\") if [ \"$nvmrc_node_version\" = \"N/A\" ]; then nvm install elif [ \"$nvmrc_node_version\" != \"$node_version\" ]; then nvm use fi elif [ \"$node_version\" != \"$(nvm version default)\" ]; then echo \"Reverting to nvm default version\" nvm use default fi # fix husky hook # ref: https://github.com/typicode/husky/issues/390#issuecomment-762213421 echo \"export PATH=\\\"$(dirname $(which node)):\\$PATH\\\"\" \u003e ~/.huskyrc } add-zsh-hook chpwd load-nvmrc load-nvmrc # https://github.com/nvm-sh/nvm#use-a-mirror-of-node-binaries export NVM_NODEJS_ORG_MIRROR=https://mirrors.ustc.edu.cn/node/ å…ˆæ·»åŠ ä¸€äº›åŸºç¡€é…ç½® basic.vim \"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\" \" =\u003e Custom config for Lruihao \"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\" \" Enable mouse set mouse=a \" Enable line-number set number ","date":"2022-07-29","objectID":"/posts/config4mac/:8:0","tags":["Git","Mac","Node.js"],"title":"Mac ä¸Šçš„å¼€å‘é…ç½®æ€»ç»“","uri":"/posts/config4mac/"},{"categories":["Memo"],"content":"ä½œä¸ºéå®‰å“ä¸“ä¸šå¼€å‘ï¼Œæ— éœ€ä¸‹è½½ Android SDKï¼Œ ä»…ä¸‹è½½ Android SDK ä¸­çš„ platform-tools å‘½ä»¤è¡Œå·¥å…·å³å¯ï¼Œå¹¶é…ç½®å¥½ç¯å¢ƒå˜é‡ã€‚ ","date":"2022-07-05","objectID":"/posts/adb-for-mac/:0:0","tags":["Android","ADB"],"title":"Mac é…ç½® ADB","uri":"/posts/adb-for-mac/"},{"categories":["Memo"],"content":"å®‰è£… platform-tools ","date":"2022-07-05","objectID":"/posts/adb-for-mac/:1:0","tags":["Android","ADB"],"title":"Mac é…ç½® ADB","uri":"/posts/adb-for-mac/"},{"categories":["Memo"],"content":"é…ç½®ç¯å¢ƒå˜é‡ open .bash_profile å†™å…¥ä»¥ä¸‹å†…å®¹ # platform-tools of Android SDK export PATH=$PATH:$HOME/Applications/platform-tools source .bash_profile Windows ç³»ç»Ÿæ‰“å¼€é«˜çº§è®¾ç½®ï¼Œé…ç½® PATH å˜é‡ï¼Œå¢åŠ ä¸€æ¡è·¯å¾„å³å¯ã€‚ ","date":"2022-07-05","objectID":"/posts/adb-for-mac/:2:0","tags":["Android","ADB"],"title":"Mac é…ç½® ADB","uri":"/posts/adb-for-mac/"},{"categories":["Memo"],"content":"ADB å‘½ä»¤ é€šè¿‡ USB è¿æ¥æ‰‹æœºå’Œç”µè„‘ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ # 1. æ‰“å¼€æ‰‹æœº tcpip 5555 ç«¯å£ adb tcpip 5555 # 2. æŸ¥çœ‹æ‰‹æœºç½‘ç»œ IP adb shell ifconfig # 3. åœ¨ç”µè„‘ä¸Š ping æ‰‹æœºç½‘ç»œ IP # 4. adb connect [Android IP] Android è°ƒè¯•æ¡¥ (adb) awesome-adb ","date":"2022-07-05","objectID":"/posts/adb-for-mac/:3:0","tags":["Android","ADB"],"title":"Mac é…ç½® ADB","uri":"/posts/adb-for-mac/"},{"categories":["Memo"],"content":"æ³¨æ„ windows ç³»ç»Ÿä¸‹çš„æ–‡ä»¶ï¼ˆå¤¹ï¼‰å‘½åæ‰€é‡‡ç”¨çš„æ˜¯ GBK ç¼–ç ï¼Œè€Œ linux æ˜¯é‡‡ç”¨çš„ UTF-8 ç¼–ç ï¼Œä½¿ç”¨ adb çš„ push å’Œ pull å‘½ä»¤æ—¶ç”±äºç¼–ç æ–¹å¼çš„ä¸åŒä¼šäº§ç”Ÿé”™è¯¯ï¼Œå› æ­¤éœ€è¦ä¿®æ”¹ adb çš„æºä»£ç æ¥æ”¯æŒç¼–ç è½¬æ¢ã€‚ ","date":"2022-07-05","objectID":"/posts/adb-for-mac/:4:0","tags":["Android","ADB"],"title":"Mac é…ç½® ADB","uri":"/posts/adb-for-mac/"},{"categories":["JavaScript"],"content":" å‰è¨€ å‰ç«¯æ¡†æ¶è½®æ›¿å˜åŒ–è¶Šæ¥è¶Šå¿«ï¼ŒJavaScript ä¹Ÿåœ¨ä¸æ–­åœ°å‡çº§è¿­ä»£ï¼Œè¶Šæ¥è¶Šå¤šçš„æ–°ç‰¹æ€§è®©æˆ‘ä»¬çš„ä»£ç å†™èµ·æ¥å˜å¾—ç®€æ´æœ‰è¶£ã€‚ æ¯éš”ä¸€æ®µæ—¶é—´å°±è¯¥é‡æ–°è®¤è¯†ä¸€ä¸‹ JSï¼Œè¿™ç¯‡æ–‡ç« ä¼šä»‹ç» 6 ç§æ–°ç‰¹æ€§ï¼Œä¸€èµ·ç ”ç©¶ä¸€ä¸‹å§ã€‚ ","date":"2022-05-01","objectID":"/posts/js-rediscover/:0:0","tags":["JavaScript","ES6"],"title":"é‡æ–°è®¤è¯† JavaScript","uri":"/posts/js-rediscover/"},{"categories":["JavaScript"],"content":"æ•°ç»„æ–¹æ³• some, every, find, filter, map å…±åŒç‚¹ï¼šè¿™å‡ ä¸ªæ–¹æ³•éƒ½ä¸ä¼šæ”¹å˜åŸå§‹æ•°ç»„ã€‚ some some() æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­æ˜¯ä¸æ˜¯è‡³å°‘æœ‰ 1 ä¸ªå…ƒç´ é€šè¿‡äº†è¢«æä¾›çš„å‡½æ•°æµ‹è¯•ï¼Œå®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚ æ•°ç»„ä¸­æœ‰è‡³å°‘ä¸€ä¸ªå…ƒç´ é€šè¿‡å›è°ƒå‡½æ•°çš„æµ‹è¯•å°±ä¼šè¿”å› trueï¼Œæ‰€æœ‰å…ƒç´ éƒ½æ²¡æœ‰é€šè¿‡å›è°ƒå‡½æ•°çš„æµ‹è¯•è¿”å›å€¼æ‰ä¼šä¸º falseã€‚ arr.some(callback(element[, index[, array]])[, thisArg]) [2, 5, 8, 1, 4].some((x) =\u003e x \u003e 10); // false [12, 5, 8, 1, 4].some((x) =\u003e x \u003e 10); // true æŠ€å·§ some() ä¸ä¼šå¯¹ç©ºæ•°ç»„è¿›è¡Œæ£€æµ‹ï¼Œç©ºæ•°ç»„è¿”å› false every åŠ©è®°ï¼ševery() å’Œ some() åŠŸèƒ½ç›¸å every() æ–¹æ³•æµ‹è¯•ä¸€ä¸ªæ•°ç»„å†…çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½èƒ½é€šè¿‡æŸä¸ªæŒ‡å®šå‡½æ•°çš„æµ‹è¯•ï¼Œå®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚ å¦‚æœå›è°ƒå‡½æ•°çš„æ¯ä¸€æ¬¡è¿”å›éƒ½ä¸º truthy å€¼ï¼Œè¿”å› true ï¼Œå¦åˆ™è¿”å› falseã€‚ arr.every(callback(element[, index[, array]])[, thisArg]) [12, 5, 8, 130, 44].every((x) =\u003e x \u003e= 10); // false [12, 54, 18, 130, 44].every((x) =\u003e x \u003e= 10); // true æŠ€å·§ every() ä¸ä¼šå¯¹ç©ºæ•°ç»„è¿›è¡Œæ£€æµ‹ï¼Œç©ºæ•°ç»„è¿”å› true Find åŠ©è®°ï¼šåŠŸèƒ½å’Œ some() ç±»ä¼¼ï¼Œsome() è¿”å›å¸ƒå°”å€¼ï¼Œfind() è¿”å›æ‰¾åˆ°çš„å…ƒç´  find() æ–¹æ³•è¿”å›æ•°ç»„ä¸­æ»¡è¶³æä¾›çš„æµ‹è¯•å‡½æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œå¦åˆ™è¿”å› undefinedã€‚ arr.find(callback[, thisArg]) const array1 = [5, 12, 8, 130, 44]; const found = array1.find((element) =\u003e element \u003e 10); console.log(found); // expected output: 12 å¼•ç”¨ å¦è¯·å‚è§ findIndex() æ–¹æ³•ï¼Œå®ƒè¿”å›æ•°ç»„ä¸­æ‰¾åˆ°çš„å…ƒç´ çš„ç´¢å¼•ï¼Œè€Œä¸æ˜¯å…¶å€¼ã€‚ å¦‚æœä½ éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå…ƒç´ çš„ä½ç½®æˆ–è€…ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œä½¿ç”¨ Array.prototype.indexOf() æˆ– Array.prototype.includes()ã€‚ filter åŠ©è®°ï¼šå¦‚å­—é¢æ„æ€ï¼Œå®ƒæ˜¯ä¸€ä¸ªç­›å­ï¼Œä¼šç­›é€‰å‡ºæ»¡è¶³æ¡ä»¶çš„å…ƒç´  filter() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶åŒ…å«é€šè¿‡æ‰€æä¾›å‡½æ•°å®ç°çš„æµ‹è¯•çš„æ‰€æœ‰å…ƒç´ ã€‚ è¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°çš„ã€ç”±é€šè¿‡æµ‹è¯•çš„å…ƒç´ ç»„æˆçš„æ•°ç»„ï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•æ•°ç»„å…ƒç´ é€šè¿‡æµ‹è¯•ï¼Œåˆ™è¿”å›ç©ºæ•°ç»„ã€‚ var newArray = arr.filter(callback(element[, index[, array]])[, thisArg]) const words = ['spray', 'limit', 'elite', 'exuberant', 'destruction', 'present']; const result = words.filter((word) =\u003e word.length \u003e 6); console.log(result); // expected output: Array [\"exuberant\", \"destruction\", \"present\"] map åŠ©è®°ï¼šåŠŸèƒ½å’Œ filter() ç±»ä¼¼ï¼Œfilter() è¿”å›ç­›é€‰çš„å…ƒç´ ï¼Œmap() è¿”å›ç­›é€‰çš„ç»“æœå€¼ map() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œè¿™ä¸ªæ–°æ•°ç»„ç”±åŸæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨ä¸€æ¬¡æä¾›çš„å‡½æ•°åçš„è¿”å›å€¼ç»„æˆã€‚ è¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°çš„ã€ç”±é€šè¿‡æµ‹è¯•çš„å…ƒç´ ç»„æˆçš„æ•°ç»„ï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•æ•°ç»„å…ƒç´ é€šè¿‡æµ‹è¯•ï¼Œåˆ™è¿”å›ç©ºæ•°ç»„ã€‚ var new_array = arr.map(function callback(currentValue[, index[, array]]) { // Return element for new_array }[, thisArg]) const array1 = [1, 4, 9, 16]; // pass a function to map const map1 = array1.map((x) =\u003e x * 2); console.log(map1); // expected output: Array [2, 8, 18, 32] ","date":"2022-05-01","objectID":"/posts/js-rediscover/:1:0","tags":["JavaScript","ES6"],"title":"é‡æ–°è®¤è¯† JavaScript","uri":"/posts/js-rediscover/"},{"categories":["JavaScript"],"content":"ä½¿ç”¨ Object.hasOwn æ›¿ä»£ in æ“ä½œç¬¦ æœ‰æ—¶ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“å¯¹è±¡ä¸Šæ˜¯å¦å­˜åœ¨æŸä¸ªå±æ€§ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ in æ“ä½œç¬¦æˆ– obj.hasOwnPropertyï¼Œä½†å®ƒä»¬éƒ½æœ‰å„è‡ªçš„ç¼ºé™·ã€‚ in å¦‚æœæŒ‡å®šçš„å±æ€§ä½äºå¯¹è±¡æˆ–å…¶åŸå‹é“¾ä¸­ï¼Œin è¿ç®—ç¬¦å°†è¿”å› trueã€‚ const Person = function (age) { this.age = age; }; Person.prototype.name = 'fatfish'; const p1 = new Person(24); console.log('age' in p1); // true console.log('name' in p1); // true æ³¨æ„è¿™é‡Œ obj.hasOwnProperty hasOwnProperty æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå¯¹è±¡è‡ªèº«å±æ€§ä¸­æ˜¯å¦å…·æœ‰å¯¹åº”çš„å€¼ï¼ˆåŸå‹é“¾ä¸Šçš„å±æ€§ä¸ä¼šè¯»å–ï¼‰ã€‚ const Person = function (age) { this.age = age; }; Person.prototype.name = 'fatfish'; const p1 = new Person(24); console.log(p1.hasOwnProperty('age')); // true console.log(p1.hasOwnProperty('name')); // fasle æ³¨æ„è¿™é‡Œ obj.hasOwnProperty å·²ç»å¯ä»¥è¿‡æ»¤æ‰åŸå‹é“¾ä¸Šçš„å±æ€§ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒè¿˜æ˜¯ä¸å®‰å…¨ã€‚ Object.create(null).hasOwnProperty('name'); // Uncaught TypeError: Object.create(...).hasOwnProperty is not a function Object.hasOwn åˆ«æ€¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Object.hasOwn æ¥é¿å…è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œè¿™æ¯” obj.hasOwnProperty æ–¹æ³•æ›´åŠ æ–¹ä¾¿ã€å®‰å…¨ã€‚ let object = { age: 24 }; Object.hasOwn(object, 'age'); // true let object3 = Object.create(null); Object.hasOwn(object3, 'age'); // false ","date":"2022-05-01","objectID":"/posts/js-rediscover/:2:0","tags":["JavaScript","ES6"],"title":"é‡æ–°è®¤è¯† JavaScript","uri":"/posts/js-rediscover/"},{"categories":["JavaScript"],"content":"ä½¿ç”¨ â€œ#â€ å£°æ˜ç§æœ‰å±æ€§ ä»¥å‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨ _ è¡¨ç¤ºç§æœ‰å±æ€§ï¼Œä½†å®ƒå¹¶ä¸é è°±ï¼Œè¿˜æ˜¯ä¼šè¢«å¤–éƒ¨ä¿®æ”¹ã€‚ class Person { constructor(name) { this._money = 1; this.name = name; } get money() { return this._money; } set money(money) { this._money = money; } showMoney() { console.log(this._money); } } const p1 = new Person('fatfish'); console.log(p1.money); // 1 console.log(p1._money); // 1 p1._money = 2; // ä¾æ—§å¯ä»¥ä»å¤–éƒ¨ä¿®æ”¹_money å±æ€§ï¼Œæ‰€ä»¥è¿™ç§åšæ³•å¹¶ä¸å®‰å…¨ console.log(p1.money); // 2 console.log(p1._money); // 2 ä½¿ç”¨ # å®ç°çœŸæ­£ç§æœ‰å±æ€§ class Person { #money = 1; constructor(name) { this.name = name; } get money() { return this.#money; } set money(money) { this.#money = money; } showMoney() { console.log(this.#money); } } const p1 = new Person('fatfish'); console.log(p1.money); // 1 // p1.#money = 2 // æ²¡æ³•ä»å¤–éƒ¨ç›´æ¥ä¿®æ”¹ p1.money = 2; console.log(p1.money); // 2 console.log(p1.#money); // Uncaught SyntaxError: Private field '#money' must be declared in an enclosing class ","date":"2022-05-01","objectID":"/posts/js-rediscover/:3:0","tags":["JavaScript","ES6"],"title":"é‡æ–°è®¤è¯† JavaScript","uri":"/posts/js-rediscover/"},{"categories":["JavaScript"],"content":"æœ‰ç”¨çš„æ•°å­—åˆ†éš”ç¬¦ å¯ä»¥ä½¿ç”¨ _ åˆ†éš”æ•°å­—ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨äºè®¡ç®— // âœ… æ›´åŠ æ˜“äºé˜…è¯» const newSixBillion = 6000_000_000; // âŒ éš¾ä»¥é˜…è¯» const originSixBillion = 6000000000; console.log(newSixBillion === originSixBillion); // expected output: true const sum = 1000 + 6000_000_000; // expected output: 6000001000 æŠ€å·§ å¦å¤–ï¼Œæˆ‘ä»¬å†™æ—¶é—´æ—¶ï¼Œ24*60*60*1000 çš„å¯è¯»æ€§ä¹Ÿæ˜¯è¿œå¤§äº 86400000 çš„ã€‚ ","date":"2022-05-01","objectID":"/posts/js-rediscover/:4:0","tags":["JavaScript","ES6"],"title":"é‡æ–°è®¤è¯† JavaScript","uri":"/posts/js-rediscover/"},{"categories":["JavaScript"],"content":"â€œ?.â€, â€œ??â€, â€œ??=â€ çš„ä½¿ç”¨ å¯é€‰é“¾ ?. ä»¥å‰æˆ‘ä»¬ä¸ºäº†ç®€åŒ– if elseï¼Œé€šå¸¸ä¼šå†™å‡ºè¿™æ ·çš„ä»£ç  const obj = null; console.log(obj \u0026\u0026 obj.name); const $title = document.querySelector('.title'); const title = $title ? title.innerText : undefined; ä½¿ç”¨ ?. ç®€åŒ– \u0026\u0026 å’Œä¸‰å…ƒè¿ç®—ç¬¦ const obj = null; console.log(obj?.name); const $title = document.querySelector('.title'); const title = $title?.innerText; ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦ ?? ä¹‹å‰ç»™å˜é‡èµ‹é»˜è®¤å€¼æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šç”¨ || æ¥å†™ï¼Œæ¯”å¦‚ let foo = 1; let bar = foo || 2; console.log(bar); // 1 let foo = 0; let bar = foo || 2; console.log(bar); // 2 æ³¨æ„è¿™é‡Œ æ‰€ä»¥ï¼Œ|| æœ‰æ—¶å€™å¹¶ä¸æ˜¯å¾ˆå®‰å…¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸åŠ åˆ¤æ–­ let foo = 0; let bar = foo !== undefined ? foo : 2; console.log(bar); // 0 ç°åœ¨ä½¿ç”¨ ?? å¯ä»¥ä½¿ä»£ç æ›´åŠ ä¼˜é›… let foo = 1; let bar = foo ?? 2; console.log(bar); // 1 let foo = 0; let bar = foo ?? 2; console.log(bar); // 0 ç©ºå€¼èµ‹å€¼è¿ç®—ç¬¦ ??= let foo = 0; foo ??= 2; console.log(foo); // 0 let foo = 1; foo ??= 2; console.log(foo); // 1 å¾ˆå¥½ç†è§£ï¼Œè¿™é‡Œçš„ foo ??= 2 ç­‰ä»·äº foo = foo ?? 2 ","date":"2022-05-01","objectID":"/posts/js-rediscover/:5:0","tags":["JavaScript","ES6"],"title":"é‡æ–°è®¤è¯† JavaScript","uri":"/posts/js-rediscover/"},{"categories":["JavaScript"],"content":"ä½¿ç”¨ BigInt æ”¯æŒå¤§æ•°è®¡ç®— JS ä¸­è¶…è¿‡ Number.MAX_SAFE_INTEGER çš„æ•°å­—è®¡ç®—å°†æ˜¯ä¸å®‰å…¨çš„ã€‚ Example: Math.pow(2, 53) === Math.pow(2, 53) + 1; // true // Math.pow(2, 53) =\u003e 9007199254740992 // Math.pow(2, 53) + 1 =\u003e 9007199254740992 ä½¿ç”¨ BigInt å®Œå…¨å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ BigInt(Math.pow(2, 53)) === BigInt(Math.pow(2, 53)) + BigInt(1); // false // BigInt(Math.pow(2, 53)) =\u003e 9007199254740992n // BigInt(Math.pow(2, 53)) + BigInt(1) =\u003e 9007199254740993n è¦åˆ›å»ºä¸€ä¸ª BigIntï¼Œå¯ä»¥åœ¨ä¸€ä¸ªæ•´æ•°çš„æœ«å°¾æ·»åŠ å­—ç¬¦nï¼Œæˆ–è€…è°ƒç”¨å‡½æ•° BigInt()ã€‚ let foo = BigInt(1); // 1n let bar = BigInt(2); // 2n console.log(foo \u003e bar); // false console.log(1n \u003e 2n); // false å­¦æ— æ­¢å¢ƒï¼Œä¸æœªæ¥çš„è‡ªå·±å…±å‹‰ ","date":"2022-05-01","objectID":"/posts/js-rediscover/:6:0","tags":["JavaScript","ES6"],"title":"é‡æ–°è®¤è¯† JavaScript","uri":"/posts/js-rediscover/"},{"categories":["CSS"],"content":"å…³äº CSS å’Œ Scss å˜é‡è¿ç®—é‚£äº›äº‹","date":"2022-04-30","objectID":"/posts/css-scss-var/","tags":["CSS","Scss"],"title":"å…³äº CSS å’Œ Scss å˜é‡è¿ç®—é‚£äº›äº‹","uri":"/posts/css-scss-var/"},{"categories":["CSS"],"content":"é—®é¢˜åˆ†æ æ˜¨å¤©åœ¨å¼€å‘ FixIt çš„æ—¶å€™ï¼Œåœ¨ Scss ä¸­å†™ max(foo, bar) å‡½æ•°æ¯”è¾ƒä¸åŒçš„å•ä½å˜é‡æ—¶æŠ¥é”™äº†ï¼Œä½†æ˜¯åœ¨ CSS ä¸­ä½¿ç”¨ max æˆ–è€… min å‡½æ•°å‡½æ•°æ¯”è¾ƒä¸åŒçš„å•ä½å˜é‡æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ é€ æˆè¿™ä¸€é—®é¢˜çš„åŸå› æ˜¯ï¼Œåœ¨ Scss ä¸­ï¼Œä¹Ÿå®ç°äº† max å’Œ min å‡½æ•°ï¼Œä½†æ˜¯åœ¨ Scss ä¸­ï¼Œä¸åŒå•ä½çš„å˜é‡æ˜¯ä¸èƒ½è¿›è¡Œè¿ç®—çš„ï¼Œæ‰€ä»¥ä½¿å¾—åœ¨ Scss ä¸­ç›´æ¥ä½¿ç”¨ max æˆ–è€… min å‡½æ•°ä¼šæç¤ºå•ä½ä¸åŒçš„æŠ¥é”™ã€‚ï¼ˆåŒç±» Less ä¸­çš„å˜é‡è¿ç®—æ˜¯æ”¯æŒä¸åŒå•ä½çš„ï¼‰ çŸ¥é“é€ æˆé—®é¢˜çš„åŸå› åï¼Œè§£å†³è¿™ä¸ªé—®é¢˜å°±å¾ˆç®€å•äº†ï¼Œæœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œæœ‰äº›æ–¹æ³•æ„Ÿè§‰åƒåœ¨å¡ BUGï¼Œæœ‰ç‚¹æ„æ€ï¼Œè®°å½•ä¸€ä¸‹ã€‚ ","date":"2022-04-30","objectID":"/posts/css-scss-var/:1:0","tags":["CSS","Scss"],"title":"å…³äº CSS å’Œ Scss å˜é‡è¿ç®—é‚£äº›äº‹","uri":"/posts/css-scss-var/"},{"categories":["CSS"],"content":"å¥‡æ€æ·«æŠ€ ç”±äº Scss åŒºåˆ†å¤§å°å†™è€Œ CSS ä¸åŒºåˆ†ï¼Œæ‰€ä»¥ä¸ºäº†ä¸è®© Scss ä¸­çš„å‡½æ•°è¦†ç›– CSS çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é™¤äº† max ä»¥å¤–çš„ 23 - 1 ç§å†™æ³•ï¼Œè¿™æ ·å°±èƒ½ä½¿ç”¨åŸç”Ÿ CSS çš„ max å‡½æ•°æ¥æ¯”è¾ƒäº†ï¼Œå°±ä¸ä¼šæŠ¥é”™äº†ã€‚ .foo { padding-left: MAX(10vh, 3.5rem); } ä½¿ç”¨ Scss æ²¡æœ‰çš„ CSS å‡½æ•° clamp: clamp(MIN, VAL, MAX) å…¶å®å°±æ˜¯è¡¨ç¤º max(MIN, min(VAL, MAX)) .foo { padding-left: clamp($header-height, 10vh, 10vh); } ä½¿ç”¨ unquote($string) å‡½æ•°è®© Scss åˆ é™¤å­—ç¬¦ä¸²æœ€å‰å’Œæœ€åçš„å•å¼•å·æˆ–åŒå¼•å· .foo { padding-left: unquote('max(10vh, #{$header-height})'); } ","date":"2022-04-30","objectID":"/posts/css-scss-var/:2:0","tags":["CSS","Scss"],"title":"å…³äº CSS å’Œ Scss å˜é‡è¿ç®—é‚£äº›äº‹","uri":"/posts/css-scss-var/"},{"categories":["CSS"],"content":"By the way å¦‚æœéœ€è¦åœ¨ CSS å‡½æ•°å†…éƒ¨æ¢å¤ Scss è§£æï¼ˆå¼•ç”¨ Scss å˜é‡ï¼‰ï¼Œåªéœ€ç”¨ #{...} åŒ…å›´ Scss ä»£ç ã€‚ $header-height: 3.5rem !default; .foo { margin: calc(10vh - $header-height); } ä¸Šé¢çš„ Scss å°†è§£ææˆ ä»¥ä¸‹æ— æ•ˆçš„ CSS ä»£ç ï¼š .foo { margin: calc(10vh - $header-height); } ç”¨ #{...} åŒ…å›´ Scss å˜é‡ $header-height: 3.5rem !default; .foo { margin: calc(10vh - #{$header-height}); } ","date":"2022-04-30","objectID":"/posts/css-scss-var/:3:0","tags":["CSS","Scss"],"title":"å…³äº CSS å’Œ Scss å˜é‡è¿ç®—é‚£äº›äº‹","uri":"/posts/css-scss-var/"},{"categories":["Memo"],"content":" æ’ä»¶åœ°å€ https://github.com/robinchenyu/imagepaste ","date":"2021-10-05","objectID":"/posts/subl_imgpaste2/:0:0","tags":["Markdown","Sublime"],"title":"Sublime å‰ªè´´æ¿å›¾ç‰‡ç²˜è´´æ’ä»¶ â€”â€” Markdown å¿…å¤‡","uri":"/posts/subl_imgpaste2/"},{"categories":["Memo"],"content":"åŠŸèƒ½ æ”¯æŒ Windows/Linux ç³»ç»Ÿä¸‹ï¼Œå®ç°å¯¹å‰ªåˆ‡æ¿å›¾åƒçš„å¤„ç†è°ƒç”¨ (Ctrl+Shift+V) é»˜è®¤ä½¿ç”¨ JPG çš„æ–¹å¼ä¿å­˜ï¼Œå¯ä»¥æ˜¾è‘—å‡å°å›¾ç‰‡çš„å­˜å‚¨ä½“ç§¯ã€‚ å¯¹å‰ªåˆ‡æ¿å›¾åƒä¿å­˜åˆ°æœ¬åœ°å¹¶åœ¨ Markdown æ–‡æœ¬ä¸­æ’å…¥é“¾æ¥åœ°å€ å¯¹å‰ªåˆ‡æ¿ä¸­çš„å›¾åƒåœ°å€ï¼Œç›´æ¥æ’å…¥åˆ° Markdown æ–‡æœ¬ä¸­ ","date":"2021-10-05","objectID":"/posts/subl_imgpaste2/:1:0","tags":["Markdown","Sublime"],"title":"Sublime å‰ªè´´æ¿å›¾ç‰‡ç²˜è´´æ’ä»¶ â€”â€” Markdown å¿…å¤‡","uri":"/posts/subl_imgpaste2/"},{"categories":["Memo"],"content":"é£Ÿç”¨è¯´æ˜ é¦–å…ˆä¸‹è½½ zip åˆ°æœ¬åœ°ï¼Œæ”¾åˆ° sublime å®‰è£…ç›®å½•çš„ xxx\\sublime\\Data\\Packages ä¸­ï¼Œæ³¨æ„ä¸æ˜¯ xxx\\sublime\\Packages ä¸‹å“¦ã€‚ è®°å¾—è¦æŠŠ subl_imgpaste2-master çš„ -master åˆ é™¤æ‰ã€‚æ¥ç€é‡æ–°æ‰“å¼€ sublime, é€‰æ‹© Preferences-\u003ePackage Settings-\u003eImaPaste2-\u003esettings-Default è¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š { \"caption\": \"ImagePaste: Paste Image From Clipboard\", \"command\": \"image_paste\", \"image_dir_name\": \"images/\" # å›¾ç‰‡ä¿å­˜ç›®å½• } ç„¶åå°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨æˆªå›¾ï¼Œç„¶ååœ¨ sublime é‡Œä½¿ç”¨ ctrl+shift+v ç²˜è´´ Markdown æ ¼å¼çš„å›¾ç‰‡ã€‚é»˜è®¤ä¼šè‡ªåŠ¨æ ¹æ® md æ–‡ä»¶ååœ¨åŒçº§ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ï¼Œå›¾ç‰‡å°±é»˜è®¤ä¿å­˜åœ¨é‚£ã€‚å¦‚å›¾ï¼š VScode ä¹Ÿæœ‰æ›´å¥½ç”¨çš„æ’ä»¶ï¼šPast Image \"pasteImage.defaultName\": \"YY_X\", \"pasteImage.path\": \"${currentFileDir}/images/\" ","date":"2021-10-05","objectID":"/posts/subl_imgpaste2/:2:0","tags":["Markdown","Sublime"],"title":"Sublime å‰ªè´´æ¿å›¾ç‰‡ç²˜è´´æ’ä»¶ â€”â€” Markdown å¿…å¤‡","uri":"/posts/subl_imgpaste2/"},{"categories":["Memo"],"content":" å¡ç‰‡å¼é“¾æ¥å·²æ•´åˆåˆ° FixIt ä¸»é¢˜ https://github.com/Lruihao/FixIt å›é¡§ ä¹‹å‰åœ¨ä½¿ç”¨ hexo çš„æ™‚å€™ä¹Ÿæœ‰ç”¨åˆ°ï¼Œæ¨¡ä»¿çŸ¥ä¹å¡ç‰‡å¼é“¾æ¥ å’Œä¹‹å‰çš„ç›¸æ¯”ï¼Œå„ªåŒ–ä¹‹å‰æ˜¯ååŠ è¼‰ï¼Œç”± JS åœ¨ ç€è¦½å™¨è™•ç†ï¼Œ ä½¿ç”¨ shortcodes æ–¹å¼åï¼Œå‰‡æ˜¯åœ¨ GO æ§‹å»ºé é¢çš„æ™‚å€™è™•ç†ï¼Œæ•ˆèƒ½ä¸Šæœƒå¥½å¾ˆå¤šã€‚ ","date":"2021-10-05","objectID":"/posts/hugo-cardlink/:0:0","tags":["Shortcodes","hugo"],"title":"Hugo æ·»åŠ çŸ¥ä¹å¡ç‰‡å¼é“¾æ¥ Shortcodes","uri":"/posts/hugo-cardlink/"},{"categories":["Memo"],"content":"æºç¢¼ åŸºæ–¼ LoveIt ä¸»é¡Œçš„ Link Shortcodes, ä¸»è¦æ”¹åˆ°ä»¥ä¸‹å¹¾å€‹æ–‡ä»¶ï¼Œå®Œæ•´æäº¤è¨˜éŒ„ assets/css/custom.scss assets/css/partial/cardlink.scss # å¡ç‰‡å¼éˆæ¥æ¨£å¼ layouts/partials/plugin/cardlink.html # å¡ç‰‡å¼éˆæ¥æ¨¡æ¿ layouts/shortcodes/cardlink.html static/images/card-link-bg.jpg ","date":"2021-10-05","objectID":"/posts/hugo-cardlink/:1:0","tags":["Shortcodes","hugo"],"title":"Hugo æ·»åŠ çŸ¥ä¹å¡ç‰‡å¼é“¾æ¥ Shortcodes","uri":"/posts/hugo-cardlink/"},{"categories":["Memo"],"content":"ä½¿ç”¨ ä½¿ç”¨åƒæ•¸è§ FixIt æ“´å±• Shortcodes - Link {{\u003c cardlink href=\"https://github.com/Lruihao/hugo-blog/commit/089c303693e806bff855ecf3fee110baa62b870b\" content=\"çŸ¥ä¹å¡ç‰‡å¼é“¾æ¥ Git è¨˜éŒ„\" \u003e}} ğŸ’¡ æ³¨ï¼šFixIt å·²åˆä½µ shortcode cardlink åˆ° shortcode linkï¼Œåªéœ€æ·»åŠ  card=true {{\u003c link href=\"https://github.com/Lruihao/FixIt\" content=\"å¡ç‰‡å¼é“¾æ¥å·²æ•´åˆåˆ° FixIt ä¸»é¢˜\" card=true \u003e}} ä¿¡æ¯ æˆ‘çš„åšå®¢å³å°†åŒæ­¥è‡³è…¾è®¯äº‘+ç¤¾åŒºï¼Œé‚€è¯·å¤§å®¶ä¸€åŒå…¥é©»ï¼š https://cloud.tencent.com/developer/support-plan?invite_code=3o5dmfzf0xkwk ","date":"2021-10-05","objectID":"/posts/hugo-cardlink/:2:0","tags":["Shortcodes","hugo"],"title":"Hugo æ·»åŠ çŸ¥ä¹å¡ç‰‡å¼é“¾æ¥ Shortcodes","uri":"/posts/hugo-cardlink/"},{"categories":["Memo"],"content":" å·¥ä½œä¸Šä¸€ç›´å¸¸ç”¨ç¹é«”ï¼Œæœ€è¿‘è‡¨å¸–ä¹Ÿéƒ½å¯«çš„ç¹é«”ï¼Œæ‰€ä»¥åšå®¢çš„èªè¨€ä¹Ÿæƒ³æ›æˆç¹é«”ï¼Œä½†æ˜¯ LoveIt ä¸»é¡Œæ²’æœ‰æ”¯æŒä¸­æ–‡ç¹é«”ã€‚å°±åªå¥½è‡ªå·±æ·»åŠ äº†ã€‚ ","date":"2021-10-05","objectID":"/posts/hugo-i18n-zh-tw/:0:0","tags":["hugo","i18n"],"title":"Hugo i18n æ·»åŠ ä¸­æ–‡ç¹é«”ç¿»è­¯","uri":"/posts/hugo-i18n-zh-tw/"},{"categories":["Memo"],"content":"ç¿»è­¯ å±¬æ–¼ç›´è­¯ï¼Œæœ‰äº›è©èªå¯èƒ½ä¸¦ä¸ç¬¦åˆç¾åœ¨è‡ºç£æˆ–è€…é¦™æ¸¯é‚£é‚Šçš„èªªæ³•ã€‚æ¯”å¦‚ï¼Œåˆ†é¡å¥½åƒè‡ºç£å¸¸èªªæ­¸é¡å§ æ–°å»º i18n/zh-TW.toml # Translations for Traditional Chinese # ç°¡é«”ä¸­æ–‡çš„ç¿»è­¯ # https://gohugo.io/content-management/multilingual/#translation-of-strings # === baseof == [backToTop] other = \"å›åˆ°é ‚éƒ¨\" [viewComments] other = \"æŸ¥çœ‹è©•è«–\" # === baseof == # === Post === [posts] other = \"æ–‡ç« \" # === Post === # === Taxonomy === [allSome] other = \"æ‰€æœ‰{{ .Some }}\" [tag] other = \"æ¨™ç±¤\" [tags] other = \"æ¨™ç±¤\" [category] other = \"åˆ†é¡\" [categories] other = \"åˆ†é¡\" [years] other = \"å¹´åº¦ç¸½çµ\" # === Taxonomy === # === Pagination === [more] other = \"æ›´å¤š\" # === Pagination === # === partials/header.html === [selectLanguage] other = \"é¸æ“‡èªè¨€\" [switchTheme] other = \"åˆ‡æ›ä¸»é¡Œ\" # === partials/header.html === # === partials/footer.html === [poweredBySome] other = \"ç”± {{ .Hugo }} å¼·åŠ›é©…å‹• | ä¸»é¡Œ - {{ .Theme }}\" # === partials/footer.html === # === partials/comment.html === [valineLang] other = \"zh-TW\" [valinePlaceholder] other = \"ä½ çš„è©•è«– ...\" [facebookLanguageCode] other = \"zh-TW\" # === partials/comment.html === # === partials/assets.html === [search] other = \"æœç´¢\" [searchPlaceholder] other = \"æœç´¢æ–‡ç« æ¨™é¡Œæˆ–å…§å®¹ ...\" [clear] other = \"æ¸…ç©º\" [cancel] other = \"å–æ¶ˆ\" [noResultsFound] other = \"æ²’æœ‰æ‰¾åˆ°çµæœ\" [lunrLanguageCode] other = \"zh\" [lunrLanguageLib] other = \"lib/lunr/lunr.zh.js\" [lunrSegmentitLib] other = \"lib/lunr/lunr.segmentit.js\" [copyToClipboard] other = \"è¤‡è£½åˆ°å‰ªè²¼æ¿\" [cookieconsentMessage] other = \"æœ¬ç¶²ç«™ä½¿ç”¨ Cookies ä¾†æ”¹å–„æ‚¨çš„æµè¦½é«”é©—ã€‚\" [cookieconsentDismiss] other = \"åŒæ„\" [cookieconsentLink] other = \"ç­è§£æ›´å¤š\" # === partials/assets.html === # === partials/plugin/share.html === [shareOn] other = \"åˆ†äº«åˆ°\" # === partials/plugin/share.html === # === posts/single.html === [contents] other = \"ç›®éŒ„\" [publishedOnDate] other = \"ç™¼ä½ˆæ–¼ {{ .Date }}\" [includedInCategories] other = \"æ”¶éŒ„æ–¼ {{ .Categories }}\" [wordCount] other = \"ç´„ {{ .Count }} å­—\" [readingTime] other = \"é è¨ˆé–±è®€ {{ .Count }} åˆ†é˜\" [views] other = \"æ¬¡é–±è®€\" [author] other = \"ä½œè€…\" [updatedOnDate] other = \"æ›´æ–°æ–¼ {{ .Date }}\" [readMarkdown] other = \"é–±è®€åŸå§‹æ–‡æª”\" [back] other = \"è¿”å›\" [home] other = \"ä¸»é \" [readMore] other = \"é–±è®€å…¨æ–‡\" # === posts/single.html === # === 404.html === [pageNotFound] other = \"é é¢æ²’æ‰¾åˆ°\" [pageNotFoundText] other = \"æŠ±æ­‰ï¼Œæ‚¨è¦æŸ¥æ‰¾çš„é é¢ä¸å­˜åœ¨ã€‚\" # === 404.html === # === shortcodes/admonition.html === [note] other = \"æ³¨æ„\" [abstract] other = \"æ‘˜è¦\" [info] other = \"ä¿¡æ¯\" [tip] other = \"æŠ€å·§\" [success] other = \"æˆåŠŸ\" [question] other = \"å•é¡Œ\" [warning] other = \"è­¦å‘Š\" [failure] other = \"å¤±æ•—\" [danger] other = \"å±éšª\" [bug] other = \"Bug\" [example] other = \"ç¤ºä¾‹\" [quote] other = \"å¼•ç”¨\" # === shortcodes/admonition.html === # === shortcodes/version.html === [new] other = \"æ–°å¢\" [changed] other = \"æ›´æ”¹\" [deleted] other = \"åˆªé™¤\" # === shortcodes/version.html === ","date":"2021-10-05","objectID":"/posts/hugo-i18n-zh-tw/:1:0","tags":["hugo","i18n"],"title":"Hugo i18n æ·»åŠ ä¸­æ–‡ç¹é«”ç¿»è­¯","uri":"/posts/hugo-i18n-zh-tw/"},{"categories":["Memo"],"content":"é…ç½® æ‰“é–‹ config.toml defaultContentLanguage = \"zh-tw\" ","date":"2021-10-05","objectID":"/posts/hugo-i18n-zh-tw/:2:0","tags":["hugo","i18n"],"title":"Hugo i18n æ·»åŠ ä¸­æ–‡ç¹é«”ç¿»è­¯","uri":"/posts/hugo-i18n-zh-tw/"},{"categories":["Memo"],"content":" éç¨‹ ä»¥å‰çš„ hexo åšå®¢æ˜¯è‡ªå·±å¯«çš„å‹éˆæ¨¡æ¿ï¼Œæ›åˆ° hugo å¾Œæƒ³è‘—åœ¨ç¶²ä¸Šéš¨ä¾¿æ‰¾ä¸€å€‹ç¯„æœ¬ç”¨è‘—å°±å¥½ï¼Œç„¶è€Œä¸¦æ²’æœ‰è‡ªå·±æƒ³è¦çš„ layout, å¹¾ä¹éƒ½æ˜¯ä½¿ç”¨ shortcodes çš„ï¼Œä»£ç¢¼é¢¨æ ¼æœ‰é»å•é¡Œä¸” shortcodes ä½œç‚ºå‹éˆæ·»åŠ çš„æ–¹å¼æ˜¯çœŸçš„éº»ç…©ã€‚å°±åªå¥½è‡ªå·±å¯«ç¾…ã€‚ å‹æƒ…éˆæ¥æ¨¡æ¿å·²æ•´åˆåˆ° FixIt ä¸»é¡Œ https://github.com/Lruihao/FixIt å‹æƒ…éˆæ¥ç¯„æœ¬ https://lruihao.cn/friends/ ","date":"2021-10-05","objectID":"/posts/hugo-friends/:0:0","tags":["hugo"],"title":"Hugo å‹æƒ…é€£çµæ¨¡æ¿","uri":"/posts/hugo-friends/"},{"categories":["Memo"],"content":"å‰µå»ºæ¨¡æ¿ é–‹å§‹ä¹‹å‰å»çœ‹äº† hugo çš„å®˜ç¶²ï¼Œå†çœ‹äº†ä¸€ä¸‹ go æ¨¡æ¿çš„èªæ³•ã€‚ æ–°å»º layouts/friends/single.html {{- define \"title\" }}{{ .Title }} - {{ .Site.Title }}{{ end -}} {{- define \"content\" -}} {{- $params := .Scratch.Get \"params\" -}} \u003cdiv class=\"page single special\"\u003e {{- /* Title */ -}} \u003ch1 class=\"single-title animated pulse faster\"\u003e{{- .Title -}}\u003c/h1\u003e {{- /* Subtitle */ -}} {{- with $params.subtitle -}} \u003ch2 class=\"single-subtitle\"\u003e{{ . }}\u003c/h2\u003e {{- end -}} {{- /* Friend links */ -}} {{- $loading := resources.Get \"svg/loading.svg\" | minify -}} \u003cscript src=\"//at.alicdn.com/t/font_578712_g26jo2kbzd5qm2t9.js\"\u003e\u003c/script\u003e \u003clink rel=\"stylesheet\" href=\"/friends/css/_friends.css\" /\u003e \u003cdiv class=\"friend-links\"\u003e {{ range $index, $friend := .Site.Data.friends }} \u003ca class=\"friend-link\" title=\"{{ $friend.description }}\" href=\"{{ $friend.url | safeURL }}\" rel=\"external nofollow noopener noreferrer\" target=\"_blank\" \u003e {{ if $friend.avatar }} \u003cimg class=\"friend-avatar lazyload\" src=\"{{ $loading.RelPermalink }}\" data-src=\"{{ $friend.avatar }}\" alt=\"{{ $friend.nickname }}\" /\u003e {{ else }} \u003csvg class=\"friend-avatar\" aria-hidden=\"true\"\u003e \u003cuse xlink:href=\"#icon-{{ add 1 $index }}\"\u003e\u003c/use\u003e \u003c/svg\u003e {{ end }} \u003cspan class=\"friend-nickname\" title=\"{{ $friend.nickname }}\"\u003e@{{ $friend.nickname }}\u003c/span\u003e \u003c/a\u003e {{ end }} \u003c/div\u003e {{- /* Content */ -}} \u003cdiv class=\"content\" id=\"content\"\u003e {{- dict \"Content\" .Content \"Ruby\" $params.ruby \"Fraction\" $params.fraction \"Fontawesome\" $params.fontawesome | partial \"function/content.html\" | safeHTML -}} \u003c/div\u003e {{- /* Comment */ -}} {{- partial \"comment.html\" . -}} \u003c/div\u003e {{- end -}} ","date":"2021-10-05","objectID":"/posts/hugo-friends/:1:0","tags":["hugo"],"title":"Hugo å‹æƒ…é€£çµæ¨¡æ¿","uri":"/posts/hugo-friends/"},{"categories":["Memo"],"content":"æ¨¡æ¿æ¨£å¼ æ–°å»ºæ–‡ä»¶ _friends.css /** * @Description: Style of layout named 'Friend links'. * @Author: lruihao.cn * @Updated: 2021/9/20 19:26 */ .friend-links { margin-top: 1rem; display: flex; flex-direction: row; justify-content: space-between; flex-wrap: wrap; } @media (max-width: 576px) { .friend-links { justify-content: space-around; } } .friend-link { width: 150px; height: 200px; font-size: 1rem; text-align: center; background: rgba(255, 255, 255, 0.3); box-sizing: border-box; box-shadow: 3px 3px 5px #aaa; border-radius: 5px; border: none; transition-duration: 0.3s; margin-bottom: 1rem; display: flex; flex-direction: column; justify-content: space-between; } .friend-link:hover { background: #fff; transform: scale(1.03); box-shadow: 0 0 3px #aaa; } .friend-avatar { object-fit: cover; object-position: center; width: 100% !important; height: 150px !important; border-radius: 5px; margin: 0; padding: 0; } .friend-nickname { display: block; position: relative; color: #2bbc8a; font-weight: bold; max-width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; line-height: 18px; margin-bottom: 1rem; } .friend-nickname:hover { color: #d480aa; } ","date":"2021-10-05","objectID":"/posts/hugo-friends/:2:0","tags":["hugo"],"title":"Hugo å‹æƒ…é€£çµæ¨¡æ¿","uri":"/posts/hugo-friends/"},{"categories":["Memo"],"content":"å‹éˆé é¢ hugo new friends/index.md å°‡ _friends.css æ”¾åˆ° content/friends/css/ æ‰“é–‹å‹éˆé é¢ content/friends/index.md --- title: 'å‹éˆ' date: 2021-09-19T12:33:48+08:00 type: 'friends' --- ","date":"2021-10-05","objectID":"/posts/hugo-friends/:3:0","tags":["hugo"],"title":"Hugo å‹æƒ…é€£çµæ¨¡æ¿","uri":"/posts/hugo-friends/"},{"categories":["Memo"],"content":"æ•¸æ“š æ–°å»ºæ•¸æ“šæ–‡ä»¶ data/friends.yml, æ•¸æ“šæ ¼å¼ç‚ºï¼š # - nickname: æ ‡é¢˜ # avatar: å¤´åƒ # url: ç«™ç‚¹ # description: æè¿° - nickname: Lruihao avatar: https://gravatar.loli.net/avatar/3f985efb5907ca52944a3cd7edd51606?d=wavatar\u0026v=1.3.10 url: https://lruihao.cn description: ä¸æ€•è¬äººé˜»æ“‹ï¼Œåªæ€•è‡ªå·±æŠ•é™ ","date":"2021-10-05","objectID":"/posts/hugo-friends/:4:0","tags":["hugo"],"title":"Hugo å‹æƒ…é€£çµæ¨¡æ¿","uri":"/posts/hugo-friends/"},{"categories":["Memo"],"content":"çµèª é€™æ¨£æ¯æ¬¡æ·»åŠ å‹éˆæˆ–è€…åˆªé™¤å‹éˆè¡¹è¦æ“ä½œæ•¸æ“šæ–‡ä»¶ friends.yml å°±å¥½ï¼Œä¹¾æ·¨åˆè¡›ç”Ÿï¼ å‹éˆé é¢ content/friends/index.md ç¹¼æ‰¿äº†åŸºç¤é é¢çš„åŠŸèƒ½ï¼Œå…§å®¹è©•è«–ç­‰ ","date":"2021-10-05","objectID":"/posts/hugo-friends/:5:0","tags":["hugo"],"title":"Hugo å‹æƒ…é€£çµæ¨¡æ¿","uri":"/posts/hugo-friends/"},{"categories":["Memo"],"content":"ä½¿ç”¨ Shell è…³æœ¬ç®¡ç† Hugo æœ¬åœ°åšå®¢","date":"2021-10-04","objectID":"/posts/hugo-admin/","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo"],"content":" æ‘˜è¦ åœ¨ä½¿ç”¨ hugo å¯«åšå®¢çš„éç¨‹ä¸­æœƒä½¿ç”¨åˆ°ä¸€äº›å‘½ä»¤ï¼ŒåŒ…æ‹¬ Git çš„ä½¿ç”¨ä¹Ÿæœƒç”¨åˆ° Git å‘½ä»¤ï¼Œä½†æ˜¯é€™äº›å‘½ä»¤æˆ‘æ„Ÿè¦ºçŸ¥é“å°±å¥½ï¼Œæ²’å¿…è¦å› è¼¸å…¥å‘½ä»¤è€Œå¢åŠ å¯«åšå®¢å’Œéƒ¨ç½²åšå®¢çš„é¡å¤–å·¥ä½œã€‚ è‡ªç„¶è¦æƒ³è¾¦æ³•ç°¡åŒ–é€™äº›éç¨‹ï¼ŒGit é‚„å¥½æœ‰ SourceTree ç­‰å·¥å…·ï¼ŒHugo å»æ²’æœ‰ï¼Œä¹Ÿæ‡¶å¾—å»ç¶²çµ¡ä¸Šæ‰¾é¡ä¼¼ä»¥å‰ hexo æœ‰ hexo-admin çš„æ’ä»¶å¯ä»¥è®“å¤§å®¶åœ¨ç€è¦½å™¨å¯«åšå®¢ï¼Œå› ç‚ºæˆ‘è¦ºå¾—é€™å’Œéœæ…‹åšå®¢åˆè¡·èƒŒé“è€Œé¦³ï¼Œæ–¼æ˜¯æˆ‘å°±æŠ˜ä¸­æ–¹æ¡ˆï¼Œå¯«äº†ä¸€å€‹æ»¿è¶³æ—¥å¸¸éœ€æ±‚çš„ Shell è…³æœ¬ï¼Œç”Ÿæˆç®¡ç†æœ¬åœ°åšå®¢ã€‚ ","date":"2021-10-04","objectID":"/posts/hugo-admin/:0:0","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo"],"content":"å¯¦ç¾ ä¸€å…±å…­å€‹è…³æœ¬ï¼Œæ”¾åœ¨ hugo-site/_localadmin/ ä¸‹ _localadmin/ â”œâ”€â”€ auto_push.sh # è‡ªå‹•åŒ–æäº¤æºç¢¼ â”œâ”€â”€ hugo_builder.sh # æ§‹å»º hugo å‘½ä»¤ â”œâ”€â”€ hugo_main.sh # ä¸»ä»‹é¢å…¥å£ â”œâ”€â”€ hugo_server.sh # å•Ÿå‹•æœ¬åœ°æœå‹™ â”œâ”€â”€ post_generator.sh # å‰µå»ºæ–‡ç«  â””â”€â”€ public_async.sh # åŒæ­¥ public å­æ¨¡çµ„ ","date":"2021-10-04","objectID":"/posts/hugo-admin/:1:0","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo"],"content":"post_generator.sh è¼¸å…¥æ–‡ç« åç¨± ï¼ˆå»ºè­°ä½¿ç”¨è‹±æ–‡ï¼‰ æ–‡ç« æ˜¯å¦æœƒæ’å…¥åœ–ç‰‡ç­‰è³‡æº ï¼ˆé»˜èªï¼šå¦ï¼‰ #!/bin/bash #author: Lruihao cd .. read -p \"Please enter the article name: \" postName if [ -z $postName ];then echo \"The article name is required!\" else read -p \"Will there be pictures in this article? [y/n]...\" choice if [ $choice = \"y\" ];then hugo new posts/$postName/index.md else hugo new posts/$postName.md fi fi ","date":"2021-10-04","objectID":"/posts/hugo-admin/:1:1","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo"],"content":"hugo_server.sh cd .. hugo server --disableFastRender ","date":"2021-10-04","objectID":"/posts/hugo-admin/:1:2","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo"],"content":"hugo_builder.sh cd .. hugo --minify ","date":"2021-10-04","objectID":"/posts/hugo-admin/:1:3","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo"],"content":"public_async.sh cd .. git submodule update --remote git add public git commit -m \"Feat: Update public module commit id\" ","date":"2021-10-04","objectID":"/posts/hugo-admin/:1:4","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo"],"content":"auto_push.sh ä¸è¼¸å…¥ Git æäº¤è¨Šæ¯æœƒä½¿ç”¨è…³æœ¬ä¸­é»˜èªè¨Šæ¯ Docs: ã€è èœçœ¾é•·ã€å†…å®¹æ›´æ–° YYYY-MM-DD week hh:mm::ss #!/bin/bash #author: Lruihao cd .. # æ˜¯å¦éœ€è¦æ¯æ¬¡æäº¤è‡ªå‹•æ›´æ–°å­æ¨¡çµ„ # git submodule update --remote # git add public # git commit -m \"Feat: Update public module commit id\" git add . read -p \"Please enter commit message: \" commitMsg if [ -z $commitMsg ];then commitMsg=\"Docs: ã€è èœçœ¾é•·ã€å†…å®¹æ›´æ–° $(date +'%F %a %T')\" fi git commit -m \"$commitMsg\" git push ","date":"2021-10-04","objectID":"/posts/hugo-admin/:1:5","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo"],"content":"hugo_main.sh å¯å–®ç¨åŸ·è¡Œå­è…³æœ¬ä¹Ÿå¯ä»¥é€šéä¸»ä»‹é¢ä¾†é¸æ“‡åºè™ŸåŸ·è¡Œ #!/bin/bash #author: Lruihao echo \"Please enter the serial number to work\" echo \"--------------------------------------\" echo \"1. post generator\" echo \"2. hugo server\" echo \"3. hugo build\" echo \"4. public async\" echo \"5. auto push\" echo \"--------------------------------------\" echo \"Press Ctrl+C to stop\" read num case $num in 1) sh post_generator.sh ;; 2) sh hugo_server.sh ;; 3) sh hugo_builder.sh ;; 4) sh public_async.sh ;; 5) sh auto_push.sh ;; *) echo \"There is no such serial number\" ;; esac echo \"Press any key to continue...\" read x clear sh hugo_main.sh ","date":"2021-10-04","objectID":"/posts/hugo-admin/:1:6","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo"],"content":"ä½¿ç”¨ å°‡ hugo_main.sh å»ºç«‹æ¡Œé¢å¿«æ·éµ é›™æ“Š hugo_main.sh é€²å…¥æ ¹æ“šæç¤ºä½¿ç”¨å³å¯ ç”±æ–¼ä¸€èˆ¬å¯«åšå®¢æœƒä¾¿é‚Šå¯«é‚Šé è¦½ï¼Œæ‰€ä»¥ä¸€èˆ¬é–‹å…©å€‹ä¸»ä»‹é¢çª—å£ï¼Œå¦‚ä¸‹åœ–ï¼š ä¸€å€‹é¸æ“‡ 2 å•Ÿå‹•æœ¬åœ°æœå‹™ ä¸€å€‹ç”¨æ–¼ç”Ÿæˆæ–‡ç« ï¼Œéƒ¨ç½²æ–‡ç« ç­‰ Hugo Admin ","date":"2021-10-04","objectID":"/posts/hugo-admin/:2:0","tags":["shell","hugo"],"title":"Hugo æœ¬åœ°ç®¡ç† Shell è…³æœ¬","uri":"/posts/hugo-admin/"},{"categories":["Memo","Git"],"content":" è§£æ±ºç—›é» Github Actions çœŸæ˜¯éœæ…‹åšå®¢çš„ç¦éŸ³ï¼Œæœ‰äº†å®ƒ hugo, hexo ç­‰åšå®¢æ§‹å»ºéç¨‹å¯ä»¥ä¸Ÿçµ¦ Github çš„æœå‹™å™¨å¹«æˆ‘å€‘åšäº†ã€‚ ä¹Ÿå°±æ˜¯èª¬å¯¦ç¾äº†åœ¨ç·šå¯«éœæ…‹åšå®¢çš„éœ€æ±‚ã€‚ ","date":"2021-10-04","objectID":"/posts/github-actions/:0:0","tags":["hugo","GitHub Actions","Git","è…¾è®¯äº‘ cos æ¡¶"],"title":"Hugo ä½¿ç”¨ GitHub Actions éƒ¨ç½²åˆ° GithHb Pages å’Œ è…¾è®¯äº‘ cos æ¡¶","uri":"/posts/github-actions/"},{"categories":["Memo","Git"],"content":"æº–å‚™ å·¥ä½œæµç¨‹æ¶‰åŠåˆ°å…©å€‹å€‰åº«å’Œä¸€å€‹ cos æ¡¶ï¼Œä¾‹å¦‚ï¼š Lruihao/hugo-blog # Blog source repository Lruihao/lruihao.github.io # GitHub pages repository blog-1256932288 # COS bucket ","date":"2021-10-04","objectID":"/posts/github-actions/:1:0","tags":["hugo","GitHub Actions","Git","è…¾è®¯äº‘ cos æ¡¶"],"title":"Hugo ä½¿ç”¨ GitHub Actions éƒ¨ç½²åˆ° GithHb Pages å’Œ è…¾è®¯äº‘ cos æ¡¶","uri":"/posts/github-actions/"},{"categories":["Memo","Git"],"content":"Github Actions ","date":"2021-10-04","objectID":"/posts/github-actions/:2:0","tags":["hugo","GitHub Actions","Git","è…¾è®¯äº‘ cos æ¡¶"],"title":"Hugo ä½¿ç”¨ GitHub Actions éƒ¨ç½²åˆ° GithHb Pages å’Œ è…¾è®¯äº‘ cos æ¡¶","uri":"/posts/github-actions/"},{"categories":["Memo","Git"],"content":"å‰µå»º workflows ä»»å‹™ å‰µå»º hugo-site/.github/workflows/deploy.yml, é€™å€‹æ–‡ä»¶æœƒå¯«ä¸€äº›å‘½ä»¤å‘Šè¨´ Github åœ¨æˆ‘å€‘æäº¤æºç¢¼çš„æ™‚å€™ï¼Œå®ƒè¦å¹«æˆ‘å€‘åšå“ªäº›äº‹æƒ…ã€‚ name: Auto Deploy hugo on: [push] jobs: Explore-GitHub-Actions: runs-on: ubuntu-latest steps: - name: Check out repository code uses: actions/checkout@v2 with: submodules: recursive # Fetch Hugo themes (true OR recursive) fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: latest extended: true - name: Build Hugo static files run: hugo --minify - name: Deploy to Github Pages uses: peaceiris/actions-gh-pages@v3 with: deploy_key: ${{ secrets.GP_DEPLOY_KEY }} external_repository: Lruihao/lruihao.github.io publish_branch: main publish_dir: ./public commit_message: ${{ github.event.head_commit.message }} - name: Install coscmd run: sudo pip install coscmd - name: Configure coscmd env: COS_SECRET_ID: ${{ secrets.COS_SECRET_ID }} COS_SECRET_KEY: ${{ secrets.COS_SECRET_KEY }} COS_BUCKET_NAME: blog-1256932288 # Change for yourself COS_BUCKET_REGION: ap-chengdu # Change for yourself run: coscmd config -a $COS_SECRET_ID -s $COS_SECRET_KEY -b $COS_BUCKET_NAME -r $COS_BUCKET_REGION - name: Deploy to COS Bucket run: coscmd upload -r -s --delete -f public/ / ","date":"2021-10-04","objectID":"/posts/github-actions/:2:1","tags":["hugo","GitHub Actions","Git","è…¾è®¯äº‘ cos æ¡¶"],"title":"Hugo ä½¿ç”¨ GitHub Actions éƒ¨ç½²åˆ° GithHb Pages å’Œ è…¾è®¯äº‘ cos æ¡¶","uri":"/posts/github-actions/"},{"categories":["Memo","Git"],"content":"é…ç½® Github Pages å¯†é‘° ç‚ºäº†è®“ Lruihao/hugo-blog æäº¤ä»£ç¢¼åè‡ªå‹•éƒ¨ç½²åˆ° Lruihao/lruihao.github.io, éœ€è¦ç”Ÿæˆä¸€å° ssh key. ssh-keygen -t rsa -b 4096 -C \"$(git config user.email)\" -f gh-pages -N \"\" # You will get 2 files: # gh-pages.pub (public key) # gh-pages (private key) æ‰“é–‹ Lruihao/hugo-blog å€‰åº«çš„ settings, å†ç‚¹å‡» Secrets, ç„¶å¾Œæ·»åŠ  private key, name ä¸º GP_DEPLOY_KEY æ‰“é–‹ Lruihao/lruihao.github.io, ç‚¹å‡» Deploy keys, æ·»åŠ  public key, name éš¨æ„ï¼ŒAllow write access ä¸€å®šè¦å‹¾ä¸Šï¼Œå¦å‰‡ç„¡æ³•æäº¤ ","date":"2021-10-04","objectID":"/posts/github-actions/:2:2","tags":["hugo","GitHub Actions","Git","è…¾è®¯äº‘ cos æ¡¶"],"title":"Hugo ä½¿ç”¨ GitHub Actions éƒ¨ç½²åˆ° GithHb Pages å’Œ è…¾è®¯äº‘ cos æ¡¶","uri":"/posts/github-actions/"},{"categories":["Memo","Git"],"content":"é…ç½® COS å¯†é‘° æ‰“é–‹ Lruihao/hugo-blog å€‰åº«çš„ settings, å†ç‚¹å‡» Secrets, ç„¶å¾Œæ·»åŠ  COS æ¡¶çš„ secret_id å’Œ secret_key: COS_SECRET_ID COS_SECRET_KEY è‡³æ­¤ï¼ŒGithub Pages å’Œ COS éƒ½å·²ç¶“å¯ä»¥é€šé Github Actions è‡ªå‹•éƒ¨ç½²äº†ï¼Œæœ‰éƒ¨ç½²è¨˜éŒ„åï¼Œ æ‰“é–‹ Lruihao/hugo-blog -\u003e Actions å¯ä»¥çœ‹åˆ°æ§‹å»ºéç¨‹å’Œçµæœï¼Œæ§‹å»ºå¤±æ•—ä¹Ÿæœƒæ”¶åˆ° Github ç™¼çµ¦ä½ çš„éƒµä»¶ã€‚ ","date":"2021-10-04","objectID":"/posts/github-actions/:2:3","tags":["hugo","GitHub Actions","Git","è…¾è®¯äº‘ cos æ¡¶"],"title":"Hugo ä½¿ç”¨ GitHub Actions éƒ¨ç½²åˆ° GithHb Pages å’Œ è…¾è®¯äº‘ cos æ¡¶","uri":"/posts/github-actions/"},{"categories":["Memo","Git"],"content":"COS è‡ªå‹•åŒæ­¥ ï¼ˆå‚™ç”¨ï¼‰ æœ¬å°ç¯€å…§å®¹å’Œ Github Actions ç„¡é—œï¼Œåƒ…ä½œç‚º COS å‚™ç”¨ä¸Šå‚³æ–¹å¼ã€‚ COSBrowser ä¸‹è¼‰ COS å®˜æ–¹è»Ÿä»¶ COSBrowser é»é–‹å³ä¸Šè§’ å·¥å…·ç®± é¸æ“‡ æ–‡ä»¶åŒæ­¥ é¸æ“‡ æœ¬åœ°æ–‡ä»¶å¤¹ eg. hugo-site/public é¸æ“‡ å­˜å‚¨æ¡¶ç›®å½• åŒæ­¥ç±»å‹ï¼šå–®æ¬¡åŒæ­¥ã€è‡ªå‹•åŒæ­¥ã€å®šæ™‚åŒæ­¥ åŒæ­¥å‰å…ˆåŸ·è¡Œ hugo æ§‹å»ºå‘½ä»¤ï¼Œeg. hugo --minify æœ‰ Github actions é¸å–®æ¬¡åŒæ­¥å°±å¥½ï¼Œåœ¨ Github ä¸å¥½ç”¨æ™‚å¯ç”¨ã€‚ ","date":"2021-10-04","objectID":"/posts/github-actions/:3:0","tags":["hugo","GitHub Actions","Git","è…¾è®¯äº‘ cos æ¡¶"],"title":"Hugo ä½¿ç”¨ GitHub Actions éƒ¨ç½²åˆ° GithHb Pages å’Œ è…¾è®¯äº‘ cos æ¡¶","uri":"/posts/github-actions/"},{"categories":["Memo"],"content":" ç”µè„‘å‡çº§ win 11 åï¼Œåˆ†ç›˜æ“ä½œå­˜åœ¨ bug, ç„¶ååˆä¸å°å¿ƒæŠŠè£…ä»£ç çš„ç›˜æ ¼å¼åŒ–äº†ï¼Œè™½ç„¶éƒ½æœ‰å¤‡ä»½åˆ° github, ä½†æ˜¯å½“æ—¶ä¸ºäº†çœäº‹ï¼Œhexo Node å®‰è£…çš„å¾ˆå¤šä»¥æ¥æ’ä»¶éƒ½æ²¡æœ‰å¤‡ä»½ï¼Œç°åœ¨åˆä¸‹è½½ä¸åˆ°äº†ï¼Œæ‰€ä»¥ hexo åšå®¢æ²¡åŠæ³•å®Œæ•´å¤åŸï¼Œå¦å¤–ï¼Œæ—©å°±è§‰å¾—åŸºäº Node çš„ hexo å®åœ¨æœ‰äº›è‡ƒè‚¿ï¼Œä¸”åšå®¢å†…å®¹å¤šäº†ä»¥åéƒ¨ç½²å¤ªæ…¢ï¼Œå°±å¹²è„†ä¹˜æœºæ¢äº†å¥½äº†ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´å¯»æ‰¾ï¼Œæœ€ç»ˆé€‰æ‹©äº†åŸºäº Go çš„ hugo, è®°å½•ä¸€ä¸‹è¿ç§»è¿‡ç¨‹åŠå¾…åŠäº‹é¡¹ã€‚ ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:0:0","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"Hugo å‡†å¤‡ ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:1:0","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"æ¦‚å¿µ Hugo is a fast and modern static site generator written in Go, and designed to make website creation fun again. é‚£ hugo åŸºäºç¼–è¯‘è¯­è¨€ GO æ„å»ºï¼Œå¯¹äºé™æ€é¡µé¢çš„æ„å»ºè‚¯å®šæ˜¯ç¢¾å‹ hexo çš„å­˜åœ¨ï¼Œå…¶å®˜æ–¹æ ‡è¯­ä¹Ÿæ˜¯å¾ˆç›´ç™½ \"The worldâ€™s fastest framework for building websites\", ä½œä¸ºå…ˆåä½¿ç”¨è¿‡ hexo å’Œ hugo çš„æˆ‘æ¥è¯´ï¼Œè¿™ç¡®å®åå‰¯å…¶å®ã€‚ gohugo ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:1:1","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"å®‰è£… hugo æä¾›äº†å¾ˆå¤šç§å®‰è£…æ–¹å¼ï¼ŒGit, Docker, Binary. ä¸ªäººç”µè„‘ä½¿ç”¨äºŒè¿›åˆ¶å®‰è£…æ˜¯æœ€æ–¹ä¾¿å¿«æ·çš„ï¼Œæ— éœ€å®‰è£…å…¶ä»–ä¾èµ–ã€‚ åˆ° Hugo Releases ä¸‹è½½å¯¹åº”çš„ windows æ“ä½œç³»ç»Ÿç‰ˆæœ¬çš„ Hugo äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç©å°±è¦ç©å…¨çš„ï¼Œæ‰€ä»¥æˆ‘å°±é€‰æ‹©äº†æ‰©å±•ç‰ˆæœ¬ï¼Œæ­¤æ¬¡é€‰æ‹©çš„æœ€æ–°ç‰ˆä¸º hugo_extended_0.88.1_Windows-64bit.zip, ç„¶åè‡ªè¡Œè§£å‹å®‰è£…å³å¯ã€‚ ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:1:2","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"ç”Ÿæˆç«™ç‚¹ ä½¿ç”¨ Hugo å¿«é€Ÿç”Ÿæˆç«™ç‚¹ï¼Œæ¯”å¦‚å¸Œæœ›ç”Ÿæˆåˆ° /path/to/site è·¯å¾„ï¼š hugo new site /path/to/site ç«™ç‚¹ç›®å½•ç»“æ„ï¼š â–¸ archetypes/ # é…ç½®æ–‡ç« æ¨¡æ¿ï¼Œç›¸å½“äº hexo çš„ scaffolds â–¸ content/ # æ–‡ç« é¡µé¢å†…å®¹ï¼Œç›¸å½“äº hexo çš„ source â–¸ data/ # å¯å­˜æ”¾ä¸€äº› yaml, json, toml æ ¼å¼çš„æ•°æ® â–¸ layouts/ # é¡µé¢å¸ƒå±€æºç ï¼Œæ”¹é€ ä¸»é¢˜å¯ä¸åŠ¨ä¸»é¢˜æºç  â–¸ static/ # é™æ€æ–‡ä»¶å­˜æ”¾ config.toml # ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œç›¸å½“äº hexo çš„ _config.yml ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:1:3","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"åˆ›å»ºæ–‡ç«  æ³¨ï¼š è·¯å¾„è¦å†™ä»¥ content/ ä¸ºæ ¹ç›®å½•çš„ç›¸å¯¹è·¯å¾„ hugo new path/fileName ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:1:4","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"æ·»åŠ ä¸»é¢˜ æ·»åŠ ä¸»é¢˜çš„æ–¹å¼é€‰ç”¨ Git å­æ¨¡ç»„çš„å½¢å¼ï¼Œä¸ºäº†æ—¥åå¿«é€Ÿå‡çº§ï¼Œé¿å…åœ¨ä½¿ç”¨ hexo ä¸­å› å¤§é‡é­”æ”¹ next ä¸»é¢˜è€Œå¯¼è‡´éš¾ä»¥å‡çº§çš„å›°æ‰°ã€‚ ç²¾æŒ‘ç»†é€‰æœ€ç»ˆé€‰æ‹©äº† LoveIt =\u003e FixIt git init git submodule add https://github.com/Lruihao/FixIt.git themes/FixIt åœ¨ config.toml æ·»åŠ  theme = â€œLoveItâ€ theme = \"FixIt\" ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:1:5","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"åœ¨æœ¬åœ°å¯åŠ¨ç½‘ç«™ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ç½‘ç«™ï¼š hugo serve --disableFastRender å»æŸ¥çœ‹ http://localhost:1313 ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:1:6","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"hugo build ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œç„¶åè‡ªå·±å¯æ‰‹åŠ¨é€‰æ‹©éƒ¨ç½²åˆ° github pages æˆ– COS ç­‰æœåŠ¡å™¨ hugo --minify ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:1:7","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"å†™ä½œæŒ‡åŒ— FixIt ä¸»é¢˜æ–‡æ¡£ - åŸºæœ¬æ¦‚å¿µ FixIt ä¸»é¢˜æ–‡æ¡£ - å†…å®¹ FixIt ä¸»é¢˜æ–‡æ¡£ - å†…ç½® Shortcodes FixIt ä¸»é¢˜æ–‡æ¡£ - æ‰©å±• Shortcodes ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:2:0","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"Todo list æœ¬ç«™æºç å¤‡ä»½ https://github.com/Lruihao/hugo-blog åŸæ¥ hexo åšäº†å¤§é‡çš„ç¾åŒ–å’Œæ‰©å±•åŠŸèƒ½ï¼Œè¿ç§»åˆ° hugo æƒ³å°½å¯èƒ½å¤šçš„ä¿ç•™ã€‚å–ä¹‹ç²¾åï¼Œå»å…¶ç³Ÿç²•ã€‚ ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:3:0","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"Base è¿ç§» hexo æ‰€æœ‰æ–‡ç« å†…å®¹ è¿ç§» hexo æ‰€æœ‰é¡µé¢å†…å®¹ ç•™è¨€é¡µé¢ ç½‘å‹æ‰“èµæ”¯æŒé¡µé¢ï¼Œæ•´åˆåˆ°ç•™è¨€é¡µé¢ é‡å†™å…³äºé¡µé¢ï¼Œä¸€åˆ‡ä»ç®€ å‹æƒ…é“¾æ¥é¡µé¢ é‡å†™ 404 é¡µé¢ ç«™ç‚¹æ—¶é—´å’Œä¸è’œå­è®¡æ•°æ”¹åˆ° hello-world é¡µé¢ cos-album å’Œ ğŸš é¥­é†‰å›¢ä¼™ ğŸ· æ•´åˆåˆ°åšå®¢ cos-album/ #7 (wontfix) æ–°å¢ demo/, ä»¥å­æ¨¡ç»„çš„å½¢å¼å­˜æ”¾å‰ç«¯ demo, serverless è®°è´¦æœ¬ç­‰ ï¼ˆä¿æŒåŸæœ¬åšå®¢çš„çº¯ç²¹æ€§ï¼‰ åšå®¢ valine è¯„è®ºï¼Œé˜…è¯»æ•°è¿ç§»ï¼Œå¯ç”¨ leancloud API å†™ä»£ç è½¬åŒ–ï¼ˆä½†ä¼¼ä¹æ²¡å¿…è¦ï¼‰ åšå®¢ SEO ä¼˜åŒ–è¿ç§» baidu_urls.txt Github actions è‡ªåŠ¨éƒ¨ç½²åˆ° Github pages å’Œ COS è„šæœ¬ç¼–å†™ hugo æœ¬åœ°ç®¡ç† shell è„šæœ¬å·¥å…·ç¼–å†™ çŸ¥ä¹å¡ç‰‡å¼é“¾æ¥ æ”¹æˆ hugo shortcodes, å–å cardlink zxm/æ²ç›®ä½“ å½’æ¡£ :( #6 å®‰è£… æ²ç›®ä½“ å‹ç¼© æ²ç›®ä½“ fontspider æ²ç›®ä½“ post ä¿®è®¢ typyit é…åˆ éšæœºè¯—è¯å’Œç½‘æ˜“äº‘çƒ­è¯„ API å®æ—¶é¢„è§ˆåŠŸèƒ½ base on Vuejs [æ‹çˆ±å™äº‹ä½“] love å½’æ¡£ [å…‰] å½’æ¡£ hugo å†…å®¹åŠ å¯†ç ”ç©¶ #3 Lruihao/hugo-blog/README.md æ’°å†™ï¼ŒMIT, å‘å¸ƒ 1.0.0 ç‰ˆæœ¬åšå®Œæ•´å¤‡ä»½ï¼Œbase on theme version æ›´æ¢ gravatar å¤´åƒ #4 åšå®¢åœ¨çº¿ç¼–è¾‘å™¨ç ”ç©¶ github1s ç­‰ #5 [baidu_urls.txt]:â†©ï¸ ç”Ÿæˆç™¾åº¦é“¾æ¥é›†åˆå°æŠ€å·§ï¼Œå…³æ‰å½’æ¡£åˆ†é¡µï¼Œåœ¨å½’æ¡£é¡µé¢æ§åˆ¶å°æ‰§è¡Œä»¥ä¸‹ä»£ç å³å¯è·å¾—æ‰€æœ‰æ–‡ç« é“¾æ¥ let urls = []; for (let a of document.querySelectorAll('.archive-item a')) { urls.push(a.href); } console.log(urls.join('\\n')); FixIt ä¸»é¢˜å·²æ”¯æŒè‡ªåŠ¨è¾“å‡º baidu_urls.txt æ–‡ä»¶ ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:3:1","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":["Memo"],"content":"Theme FixIt hugo LoveIt ä¸»é¢˜æ•´ä½“ä¼˜åŒ–ï¼Œå¿…è¦æ—¶å»º PR æˆ– issue åˆ° LoveIt ä»“åº“ (LoveIt å·²åœæ›´ä¸€å¹´å¤šï¼‰ å…ˆæŠŠè‡ªå·±å‘ç°å’Œ LoveIt åŸ repo çš„ issue å°½å¯èƒ½çš„ä¿®å¤ï¼Œä¿®æ”¹çš„åŸåˆ™æ˜¯ï¼šä¸æ”¹åŠ¨åŸé¡¹ç›®ä»£ç ï¼Œ å”¯ä¸€é€”å¾„å°±æ˜¯åœ¨ç«™ç‚¹ç›¸åŒçš„ç›®å½•ç”¨æ–°å¢çš„æ–¹å¼æ›¿ä»£ä¿®æ”¹ã€åˆ é™¤æ“ä½œã€‚ ä¹‹åå†ç­‰ç­‰çœ‹ä½œè€…æ˜¯å¦è¿˜ä¼šæ›´æ–°ï¼Œå¦‚å·²åšå¤§é‡çš„æ›´æ”¹ï¼Œå†åšè€ƒè™‘æ•´åˆä¸ºä¸€ä¸ªæ–°çš„ä¸»é¢˜ã€‚ ä¸ºäº†æ›´å¥½çš„å®Œå–„åšå®¢åŠŸèƒ½ä»¥åŠä¿®å¤ BUG å·²åˆ›å»ºæ–°çš„ä¸»é¢˜ FixIt (fork from LoveIt) Hugo theme FixIt https://github.com/Lruihao/FixIt è¿›åº¦æ›´æ–°è‡³ #8 CSS ä¼˜åŒ–ï¼ŒèƒŒæ™¯ï¼Œå…ƒç´ åœ†è§’åŒ–ï¼Œå¤–åœ†å†…æ–¹ï¼Œå±…ä¸­å¯¹é½ç­‰ æ²ç›®ä½“å¼•å…¥ TOC åºå·ç”Ÿæˆ Fix: æ— æ ‡é¢˜æ—¶ä¹Ÿä¼šç”Ÿæˆç›®å½•çš„ BUG subtitle ç­‰ç»†èŠ‚ä¼˜åŒ– Fix: typeit æ‰“å°ä»£ç æ—¶è·‘ç‰ˆçš„é—®é¢˜ Fix: æ–‡ç«  h1 æ ‡é¢˜å¤šè¡Œè·‘ç‰ˆ Code Review ","date":"2021-10-03","objectID":"/posts/hexo-to-hugo/:3:2","tags":["hugo","hexo"],"title":"ä¸ªäººåšå®¢ä» Hexo è¿ç§»è‡³ Hugo","uri":"/posts/hexo-to-hugo/"},{"categories":null,"content":"Lruihao's friends","date":"2021-09-19","objectID":"/friends/","tags":null,"title":"å‹æƒ…éˆæ¥","uri":"/friends/"},{"categories":null,"content":" Â Subscribe ours https://lruihao.cn/friends/opml.xml ","date":"2021-09-19","objectID":"/friends/:0:0","tags":null,"title":"å‹æƒ…éˆæ¥","uri":"/friends/"},{"categories":null,"content":"åŸºæœ¬è³‡è¨Š - nickname: jian avatar: url: description: ","date":"2021-09-19","objectID":"/friends/:1:0","tags":null,"title":"å‹æƒ…éˆæ¥","uri":"/friends/"},{"categories":null,"content":"å‹æƒ…æé†’ Notice äº’æ›å‹éˆè«‹æŒ‰ä»¥ä¸Šæ ¼å¼åœ¨è©•è«–ç•™è¨€ã€‚ï¼ˆåƒ…é™å€‹äººéå•†æ¥­éƒ¨è½æ ¼/ç¶²ç«™ï¼‰ Â ç¶²ç«™å¤±æ•ˆã€åœæ­¢ç¶­è­·ã€å…§å®¹ä¸ç•¶éƒ½å¯èƒ½è¢«å–æ¶ˆé€£çµï¼ é‚£äº›ä¸å°Šé‡ä»–äººå‹å‹•æˆæœï¼Œè½‰è¼‰ä¸åŠ å‡ºè™•çš„ï¼Œæˆ–æƒ¡æ„è¡Œç‚ºçš„ç¶²ç«™ï¼Œé‚„è«‹æ‚¨ä¸è¦ä¾†é€²è¡Œäº¤æ›äº†ã€‚ ","date":"2021-09-19","objectID":"/friends/:2:0","tags":null,"title":"å‹æƒ…éˆæ¥","uri":"/friends/"},{"categories":null,"content":"äº’è”ç½‘çš„å¹¿å¤§æœ‹å‹ä»¬ï¼Œæ¬¢è¿å…‰ä¸´æˆ‘çš„å°åšå®¢ï¼æ¬¢è¿ç•™è¨€ï¼","date":"2021-09-13","objectID":"/guestbook/","tags":null,"title":"ç•™è¨€","uri":"/guestbook/"},{"categories":null,"content":" Welcome å…³äº FixIt ä¸»é¢˜ çš„é—®é¢˜ï¼Œè¯·ç§»æ­¥ FixIt å®˜ç½‘ ç›¸å…³æ–‡ç« å“¦ï½ æ¸©é¦¨æç¤ºï¼ŒéŸ³ä¹è‡ªåŠ¨æ’­æ”¾ï¼Œè¯·å¸¦å¥½è€³æœºï½ From playlist, Powered By mmt-netease ç»™åšä¸»ä¹°æ¯å¡å¸ƒå¥‡è¯ºï½ èµèµ æ”¯ä»˜å® å¾®ä¿¡ ","date":"2021-09-13","objectID":"/guestbook/:0:0","tags":null,"title":"ç•™è¨€","uri":"/guestbook/"},{"categories":null,"content":"å…³äºæˆ‘ ä¸å‘ä¸äº¢ï¼Œä¸çŸœä¸ä¼ï¼Œæˆ’éª„æˆ’èº ä¸å—”ä¸æ€’ï¼Œä¸çˆ­ä¸å¼ƒï¼Œç‹¬å–„å…¶èº« è‡ªæˆ‘æœŸè¨±ï¼š ç”¨æˆ‘æ‰€å­¸ï¼Œå­¸æˆ‘æ‰€ç”¨ã€‚ä¿æŒè¬™éœï¼Œä¿æŒæ¢ç´¢æ¬²ï¼Œç ¥ç¤ªå‰è¡Œã€‚ ","date":"2021-09-07","objectID":"/about/:1:0","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"è¨‚é–± ","date":"2021-09-07","objectID":"/about/:2:0","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":null,"content":"è‡´è¬ æ„Ÿè¬å¤§å®¶çš„æ”¯æŒ ğŸ™ ç»™åšä¸»ä¹°æ¯å¡å¸ƒå¥‡è¯ºï½ èµèµ æ”¯ä»˜å® å¾®ä¿¡ francs é€šè¿‡ æ”¯ä»˜å® æ‰“èµäº† Â¥50.00å¤§å­¦ç”Ÿæ—¶æœŸï¼Œç¬¬ä¸€æ¬¡æ”¶åˆ°åˆ«äººçš„æ”¯æŒï¼Œå†…å¿ƒè¡¨ç¤ºå—å® è‹¥æƒŠåˆéå¸¸å¼€å¿ƒã€‚éå¸¸æ„Ÿè°¢è€å“¥çš„æ”¯æŒï¼2018-09-28 francs é€šè¿‡ QQ æ‰“èµäº† Â¥8.80ä»Šå¤©å­¦æ ¡è¿åŠ¨ä¼šæ²¡è¯¾ï¼Œç¡åˆ° 9 ç‚¹å¤šèµ·æ¥çœ‹åˆ° QQ æ”¶åˆ°ä¸€ä¸ªçº¢åŒ…ï¼Œæ„Ÿè°¢æ”¯æŒï¼2018-10-26 francs é€šè¿‡ QQ æ‰“èµäº† Â¥8.802018-11 âœ˜æ˜Œå‡ é€šè¿‡ æ”¯ä»˜å® æ‰“èµäº† Â¥10.00ä¸Šè¯¾çš„æ—¶å€™å¬åˆ°äº†æ”¯ä»˜å®æ¸…è„†çš„æ”¯ä»˜å®åˆ°è´¦ 10 å…ƒçš„å£°éŸ³ï¼2018-12-04 âœ˜æ˜Œå‡ é€šè¿‡ æ”¯ä»˜å® æ‰“èµäº† Â¥18.002018-12-04 âœ˜æ˜Œå‡ é€šè¿‡ å¾®ä¿¡ æ‰“èµäº† Â¥2.00æ¥è‡ª 231****047#qq.com2019-03-19 âœ˜å–œæ´² é€šè¿‡ QQ æ‰“èµäº† Â¥20.20æ¥è‡ª 101****0732020-01-17 âœ˜âœ˜æ¾ é€šè¿‡ æ”¯ä»˜å® æ‰“èµäº† Â¥2.002022-12-02 13:01:48 âœ˜âœ˜æ³¢ é€šè¿‡ æ”¯ä»˜å® æ‰“èµäº† Â¥20.00ç•™è¨€ï¼šâ€œæ„Ÿè°¢å¸®å¿™è§£å†³ FixIt çš„é—®é¢˜â€2023-02-13 10:01:58 K*n é€šè¿‡ å¾®ä¿¡ æ‰“èµäº† Â¥50.002023-03-17 14:05:49 D*n é€šè¿‡ å¾®ä¿¡ æ‰“èµäº† Â¥11.11ç•™è¨€ï¼šâ€œåŠ æ²¹â€2023-03-17 14:57:41 ä¹è¯­ é€šè¿‡ å¾®ä¿¡ æ‰“èµäº† Â¥5.00ç•™è¨€ï¼šâ€œå¾ˆå¥½ç”¨çš„ä¸»é¢˜ï¼Œè°¢è°¢ä½œè€…ğŸ’ªâ€2023-04-03 17:49:12 å»ºè®®å»ä¸– é€šè¿‡ å¾®ä¿¡ æ‰“èµäº† Â¥20.00ç•™è¨€ï¼šâ€œä¸»é¢˜ä¸é”™â€2023-04-17 10:35:26 ğŸŸ é€šè¿‡ å¾®ä¿¡ æ‰“èµäº† Â¥1.00ç•™è¨€ï¼šâ€œæ„Ÿè°¢fixitä½œè€…â€2023-05-24 15:49:46 ","date":"2021-09-07","objectID":"/about/:3:0","tags":null,"title":"å…³äºæˆ‘","uri":"/about/"},{"categories":["CSS"],"content":" Sass å’Œ Less éƒ½å±¬æ–¼ CSS å‰ç½®è™•ç†å™¨ï¼ŒCSS å‰ç½®è™•ç†å™¨å®šç¾©äº†ä¸€ç¨®æ–°çš„èªè¨€ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼Œç”¨ä¸€ç¨®å°ˆé–€çš„ç¨‹å¼è¨­è¨ˆèªè¨€ï¼Œç‚º CSS å¢åŠ äº†ä¸€äº›ç¨‹å¼è¨­è¨ˆçš„ç‰¹æ€§ï¼Œå°‡ CSS ä½œç‚ºç›®æ¨™ç”Ÿæˆæª”ï¼Œç„¶å¾Œé–‹ç™¼è€…å°±åªè¦ä½¿ç”¨é€™ç¨®èªè¨€é€²è¡Œ CSS çš„ç·¨ç¢¼å·¥ä½œã€‚ è½‰åŒ–æˆé€šä¿—æ˜“æ‡‚çš„è©±ä¾†èªªå°±æ˜¯ â€œç”¨ä¸€ç¨®å°ˆé–€çš„ç¨‹å¼è¨­è¨ˆèªè¨€ï¼Œé€²è¡Œ Web é é¢æ¨£å¼è¨­è¨ˆï¼Œå†é€šéç·¨è­¯å™¨è½‰åŒ–ç‚ºæ­£å¸¸çš„ CSS æª”ï¼Œä»¥ä¾›å°ˆæ¡ˆä½¿ç”¨â€ã€‚ ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:0:0","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["CSS"],"content":"ç‚ºä»€éº¼ï¼Œä»€éº¼æ™‚å€™è¦ä½¿ç”¨ CSS å‰ç½®è™•ç†å™¨ï¼Ÿ (Why, When) CSS æœ‰å…·é«”ä»¥ä¸‹å¹¾å€‹ç¼ºé»ï¼š èªæ³•ä¸å¤ å¼·å¤§ï¼Œæ¯”å¦‚ç„¡æ³•åµŒå¥—æ›¸å¯«ï¼Œå°è‡´æ¨¡çµ„åŒ–é–‹ç™¼ä¸­éœ€è¦æ›¸å¯«å¾ˆå¤šé‡è¤‡çš„é¸æ“‡å™¨ æ²’æœ‰è®Šæ•¸å’Œåˆç†çš„æ¨£å¼è¤‡ç”¨æ©Ÿåˆ¶ï¼Œä½¿å¾—é‚è¼¯ä¸Šç›¸é—œçš„å±¬æ€§å€¼å¿…é ˆä»¥å­—é¢é‡çš„å½¢å¼é‡è¤‡è¼¸å‡ºï¼Œå°è‡´é›£ä»¥ç¶­è­· é€™å°±å°è‡´äº†æˆ‘å€‘åœ¨å·¥ä½œä¸­ç„¡ç«¯å¢åŠ äº†è¨±å¤šå·¥ä½œé‡ã€‚è€Œä½¿ç”¨ CSS å‰ç½®è™•ç†å™¨å¯å¤§å¤§æé«˜äº†æˆ‘å€‘çš„é–‹ç™¼æ•ˆç‡ï¼š æä¾› CSS ç¼ºå¤±çš„æ¨£å¼å±¤è¤‡ç”¨æ©Ÿåˆ¶ æ¸›å°‘å†—é¤˜ç¢¼ æé«˜æ¨£å¼ä»£ç¢¼çš„å¯ç¶­è­·æ€§ã€‚ ä½†æ˜¯ï¼ŒCSS çš„å¥½è™•åœ¨æ–¼ç°¡ä¾¿ã€éš¨æ™‚éš¨åœ°è¢«ä½¿ç”¨å’Œèª¿è©¦ã€‚é€™å°±ä½¿å¾—é ç·¨è­¯ CSS æ­¥é©Ÿçš„åŠ å…¥å…·æœ‰ä»¥ä¸‹ç¼ºé»ï¼š é–‹ç™¼å·¥ä½œæµä¸­å¤šäº†ä¸€å€‹ç’°ç¯€ï¼Œèª¿è©¦ä¹Ÿè®Šå¾—æ›´éº»ç…© é ç·¨è­¯å¾ˆå®¹æ˜“é€ æˆå¾Œä»£é¸æ“‡å™¨çš„æ¿«ç”¨ æ‰€ä»¥æˆ‘å€‘åœ¨å¯¦éš›é …ç›®ä¸­è¡¡é‡é ç·¨è­¯æ–¹æ¡ˆæ™‚ï¼Œé‚„æ˜¯å¾—æƒ³æƒ³ï¼Œæ¯”èµ·å¸¶ä¾†çš„é¡å¤–ç¶­è­·é–‹éŠ·ï¼ŒCSS å‰ç½®è™•ç†å™¨æœ‰æ²’æœ‰è§£æ±ºæ›´å¤§çš„éº»ç…©ã€‚ ç³»çµ±ç´šæ¡†æ¶é–‹ç™¼ ï¼ˆå¤§å‹è¤‡é›œçš„æ¨£å¼è¨­è¨ˆï¼‰ æŒçºŒç¶­è­· ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:1:0","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["CSS"],"content":"Lessã€Sass/Scss æ˜¯ä»€éº¼ï¼Ÿ (What) ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:2:0","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["CSS"],"content":"Less æ˜¯ä¸€ç¨®å‹•æ…‹æ¨£å¼èªè¨€ã€‚å° CSS è³¦äºˆäº†å‹•æ…‹èªè¨€çš„ç‰¹æ€§ï¼Œå¦‚è®Šæ•¸ã€ç¹¼æ‰¿ã€é‹ç®—ã€å‡½æ•¸ã€‚ Less æ—¢å¯ä»¥åœ¨ç”¨æˆ¶ç«¯ä¸Šé‹è¡Œ ï¼ˆæ”¯æ´ IE 6+, Webkit, Firefox)ï¼Œä¹Ÿå¯åœ¨æœå‹™ç«¯é‹è¡Œã€‚ ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:2:1","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["CSS"],"content":"Sass æ˜¯ä¸€ç¨®å‹•æ…‹æ¨£å¼èªè¨€ï¼ŒSass èªæ³•å±¬æ–¼ç¸®æ’èªæ³•ï¼Œ æ¯” CSS æ¯”å¤šå‡ºå¥½äº›åŠŸèƒ½ï¼ˆå¦‚è®Šæ•¸ã€åµŒå¥—ã€é‹ç®—ï¼Œæ··å…¥ (Mixin)ã€ç¹¼æ‰¿ã€é¡è‰²è™•ç†ï¼Œå‡½æ•¸ç­‰ï¼‰ï¼Œæ›´å®¹æ˜“é–±è®€ã€‚ ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:2:2","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["CSS"],"content":"Sass èˆ‡ Scss çš„é—œä¿‚ Sass çš„ç¸®æ’èªæ³•ï¼Œå°æ–¼å¯«æ…£ CSS çš„å‰ç«¯é–‹ç™¼è€…ä¾†èªªå¾ˆä¸ç›´è§€ï¼Œä¹Ÿä¸èƒ½å°‡ CSS ä»£ç¢¼åŠ å…¥åˆ° Sass è£¡é¢ï¼Œå› æ­¤ Sass èªæ³•é€²è¡Œäº†æ”¹è‰¯ï¼ŒSass 3 å°±è®Šæˆäº† Scss(Sassy CSS)ã€‚èˆ‡åŸä¾†çš„èªæ³•ç›¸å®¹ï¼Œåªæ˜¯ç”¨{}å–ä»£äº†åŸä¾†çš„ç¸®é€²ã€‚Sass ç›¸ç•¶æ–¼ Scss çš„åš´æ ¼æ¨¡å¼ã€‚ ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:2:3","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["CSS"],"content":"Sass å’Œ Less çš„æ¯”è¼ƒ ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:3:0","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["CSS"],"content":"ç›¸åŒé» Less å’Œ Sass åœ¨èªæ³•ä¸Šæœ‰äº›å…±æ€§ï¼Œæ¯”å¦‚ä¸‹é¢é€™äº›ï¼š æ··å…¥ (Mixins)â€”â€”class ä¸­çš„ class åƒæ•¸æ··å…¥â€”â€”å¯ä»¥å‚³éåƒæ•¸çš„ classï¼Œå°±åƒå‡½æ•¸ä¸€æ¨£ åµŒå¥—è¦å‰‡â€”â€”Class ä¸­åµŒå¥— classï¼Œå¾è€Œæ¸›å°‘é‡è¤‡çš„ä»£ç¢¼ é‹ç®—â€”â€”CSS ä¸­ç”¨ä¸Šæ•¸å­¸ é¡è‰²åŠŸèƒ½â€”â€”å¯ä»¥ç·¨è¼¯é¡è‰² åå­—ç©ºé–“ (namespace)â€”â€”åˆ†çµ„æ¨£å¼ï¼Œå¾è€Œå¯ä»¥è¢«èª¿ç”¨ ä½œç”¨åŸŸâ€”â€”å±€éƒ¨ä¿®æ”¹æ¨£å¼ JavaScript è³¦å€¼â€”â€”åœ¨ CSS ä¸­ä½¿ç”¨ JavaScript é‹ç®—å¼è³¦å€¼ ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:3:1","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["CSS"],"content":"ä¸åŒé» å¯¦ç¾æ–¹å¼ Less æ˜¯åŸºæ–¼ JavaScriptï¼Œæ˜¯åœ¨ç”¨æˆ¶ç«¯è™•ç†çš„ Sass æ˜¯åŸºæ–¼ Ruby çš„ï¼Œæ˜¯åœ¨ä¼ºæœå™¨ç«¯è™•ç†çš„ é—œæ–¼è®Šæ•¸åœ¨ Less å’Œ Sass ä¸­çš„å”¯ä¸€å€åˆ¥å°±æ˜¯ Less ç”¨@ï¼ŒSass ç”¨$ less ä¸­çš„è®Šé‡é‹ç®—å¯å¸¶ã€å¯ä¸å¸¶å–®ä½ï¼ŒSass éœ€è¦å¸¶å–®ä½å…ƒ èªæ³•ä¸åŒï¼Œè«‹è©³è¦‹ Lessã€Sass å®˜ç¶² ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:3:2","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["CSS"],"content":"é¸ç”¨ Less é‚„æ˜¯ Sass ? ç„¡è«–æ˜¯å­¸ç¿’è³‡æ–™ï¼Œè¨è«–æƒ…æ³ï¼Œä»¥åŠé …ç›®ä½¿ç”¨æƒ…æ³ Sass/Scss éƒ½å„ªæ–¼ Lessï¼Œæ¯”å¦‚ Bootstrap 4 å°±ä½¿ç”¨çš„ Sass, ä½†æ˜¯ Less çš„ä½¿ç”¨æ›´åŠ ç°¡å–®ï¼Œä½¿ç”¨é–€æª»ä¹Ÿè¼ƒä½ï¼Œå…§ç¶²é–‹ç™¼çš„æƒ…æ³ï¼ŒLess å‰‡æ›´åŠ é©åˆã€‚ ","date":"2021-06-22","objectID":"/posts/less-sass-scss/:4:0","tags":["Less","Sass","Scss"],"title":"less\u0026sass\u0026scss","uri":"/posts/less-sass-scss/"},{"categories":["JavaScript"],"content":"ç°¡ä»‹ Lightbox ï¼ˆç‡ˆç®±ï¼‰ï¼Œç”¨æ¥æ”¾å¤§æ˜¾ç¤ºå›¾ç‰‡è¦†ç›–äºå½“å‰é¡µé¢ä¹‹ä¸Šã€‚å…¶æ˜¯ç”¨ CSS æ¥å®šä¹‰å›¾ç‰‡å®¹å™¨ï¼Œç”¨ä¸€å¹…åŠé€æ˜çš„ png å›¾ç‰‡å®ç°æ¸å˜é˜´æš—çš„æ•ˆæœã€‚ ä¸€èˆ¬çš„ç¶²é ï¼Œåœ–ç‰‡æ˜¯ä½¿ç”¨ img æ¨™ç±¤å¯«åœ¨ HTML é é¢ä¸­ï¼Œåœ–ç‰‡é»æ“Šå¹¶ä¸æœƒæ”¾å¤§ï¼Œæƒ³æ”¾å¤§çœ‹åœ–ç‰‡è¦éº¼æ–¹æ³•æ•´å€‹ç¶²é ï¼Œè¦éº¼è¤‡è£½åœ–ç‰‡éˆæ¥æ–°é–‹çª—å£ï¼Œæ“ä½œç¹ç‘£ï¼Œè€Œä½¿ç”¨ Lightbox çš„ç¶²ç«™å¯ä»¥ç‚¹å‡»ç¼©ç•¥å›¾æµ®å±‚æ˜¾ç¤ºå¤§å›¾ï¼Œæ”¾å¤§å¾Œå¯ç‚¹å‡»é”®ç›˜ â†ã€â†’ é”®åˆ‡æ¢å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥é¼ æ ‡ç‚¹å‡»å·¦å³ç®­å¤´åˆ‡æ¢ã€‚æŒ‰ä¸‹é”®ç›˜ Esc é”®æˆ–è€…ç‚¹å‡»å…³é—­æŒ‰é’®å¯è¼•é¬†é—œé–‰åœ–å±¤ï¼Œåœ–ç‰‡æµè¦½çš„é«”é©—åº¦æ˜¯é é å¤§æ–¼æœªä½¿ç”¨çš„ Lightbox çš„ç¶²ç«™ã€‚ ","date":"2021-06-21","objectID":"/posts/lightbox/:1:0","tags":["Lightbox","JavaScript"],"title":"Lightbox","uri":"/posts/lightbox/"},{"categories":["JavaScript"],"content":"å¯¦ç¾æ€è·¯ å¤§æ¦‚æ€è·¯å°±åœ¨æ¯ä¸ªå›¾ç‰‡çš„ç‚¹å‡»äº‹ä»¶ä¸­æ·»åŠ å›¾å±‚ä¸å›¾ç‰‡å‰¯æœ¬ã€‚ /** * @author github.com@flymysql */ let container = document.documentElement || document.body; let img, div, src, btnleft, btnright; var imgid = 0; let x, y, w, h, tx, ty, tw, th, ww, wh; let closeMove = function () { if (div == undefined) { return false; } div.style.opacity = 0; img.style.height = h + 'px'; img.style.width = w + 'px'; img.style.left = x + 'px'; img.style.top = y - container.scrollTop + 'px'; // å»¶è¿Ÿç§»é™¤ dom setTimeout(function () { div.remove(); img.remove(); btnright.remove(); btnleft.remove(); }, 100); }; let closeFade = function () { if (div == undefined) { return false; } div.style.opacity = 0; img.style.opacity = 0; // å»¶è¿Ÿç§»é™¤ dom setTimeout(function () { div.remove(); img.remove(); btnright.remove(); btnleft.remove(); }, 100); }; let style = function () { btnleft.style.cssText = ` position:fixed; border-radius: 50%;; left:${x - 20}px; top:${y - container.scrollTop + h / 2}px; width:50px; height:50px; border: 0px; background-color: rgba(200,200,200,0.8); font-size: 20px; z-index: 999999999; transition:all .3s cubic-bezier(0.165, 0.84, 0.44, 1); `; btnright.style.cssText = ` position:fixed; border-radius: 50%; left:${x + w + 20}px; top:${y - container.scrollTop + h / 2}px; width:50px; border: 0px; height:50px; font-size: 20px; background-color: rgba(200,200,200,0.8); z-index: 999999999; transition:all .3s cubic-bezier(0.165, 0.84, 0.44, 1); `; btnleft.innerText = '\u003c'; btnright.innerText = '\u003e'; img.style.cssText = ` position:fixed; border-radius: 12px; left:${x}px; top:${y - container.scrollTop}px; width:${w}px; height:${h}px; z-index: 999999999; transition:all .3s cubic-bezier(0.165, 0.84, 0.44, 1); opacity:0; `; }; // ç›‘å¬æ»šåŠ¨å…³é—­å±‚ document.addEventListener('scroll', function () { closeFade(); }); document.querySelectorAll('img').forEach((v) =\u003e { if (v.parentNode.localName != 'a') { v.id = imgid; imgid++; v.addEventListener('click', function (e) { // æ³¨å†Œäº‹ä»¶ // è®°å½•å°å›¾çš„ä½ç½®ä¸ªå¤§å° x = e.target.offsetLeft; y = e.target.offsetTop; w = e.target.offsetWidth; h = e.target.offsetHeight; src = e.target.src; id = e.target.id; // åˆ›å»ºé®ç½©å±‚ div = document.createElement('div'); div.style.cssText = ` position:fixed; left:0; top:0; bottom:0; right:0; background-color: rgba(25,25,25,0.8); z-index:99999999; transition:all .3s cubic-bezier(0.165, 0.84, 0.44, 1); `; document.body.appendChild(div); setTimeout(function () { div.style.opacity = 1; }, 0); // ï¼ˆæ­¤å¤„å¯ä»¥åŠ  loading) // åˆ›å»ºå‰¯æœ¬ img = new Image(); btnright = document.createElement('button'); btnleft = document.createElement('button'); img.src = src; style(); btnleft.onclick = function () { if (id === 0) { alert('å·²ç»æ˜¯ç¬¬ä¸€å¼ äº†ï¼'); return; } var left = document.getElementById(id - 1); img.src = left.src; x = left.offsetLeft; y = left.offsetTop; w = left.offsetWidth; h = left.offsetHeight; style(); id--; }; btnright.onclick = function () { id++; if (id \u003e= imgid) { alert('å·²ç»æ˜¯æœ€åä¸€å¼ äº†ï¼'); return; } var right = document.getElementById(id); img.src = right.src; x = right.offsetLeft; y = right.offsetTop; w = right.offsetWidth; h = right.offsetHeight; style(); }; img.onload = function () { document.body.appendChild(img); document.body.appendChild(btnright); document.body.appendChild(btnleft); // æµè§ˆå™¨å®½é«˜ wh = window.innerHeight; ww = window.innerWidth; // ç›®æ ‡å®½é«˜å’Œåæ ‡ if (w / h \u003c ww / wh) { th = wh - 80; tw = ((w / h) * th) \u003e\u003e 0; tx = (ww - tw) / 2; ty = 40; } else { tw = ww * 0.8; th = ((h / w) * tw) \u003e\u003e 0; tx = ww * 0.1; ty = (wh - th) / 2; } // å»¶è¿Ÿå†™å…¥å¦åˆ™ä¸ä¼šæœ‰åŠ¨ç”» setTimeout(function () { img.style.opacity = 1; img.style.height = th + 'px'; img.style.width = tw + 'px'; img.style.left = tx + 'px'; img.style.top = ty + 'px'; btnleft.style.left = tx - 90 + 'px'; btnleft.style.top = ty + th / 2 + 'px'; btnright.style.left = tx + tw + 40 + 'px'; btnright.style.top = ty + th / 2 + 'px'; // ç‚¹å‡»éšè— div.onclick = img.onclick = closeMove; }, 10); }; }); //end event } }); //end forEach ","date":"2021-06-21","objectID":"/posts/lightbox/:2:0","tags":["Lightbox","JavaScript"],"title":"Lightbox","uri":"/posts/lightbox/"},{"categories":["JavaScript"],"content":"fancybox fancybox æ˜¯ä¸€å€‹å®Œå–„çš„ lightbox æ’ä»¶ jQuery lightbox script for displaying images, videos and more. Touch enabled, responsive and fully customizable. ","date":"2021-06-21","objectID":"/posts/lightbox/:3:0","tags":["Lightbox","JavaScript"],"title":"Lightbox","uri":"/posts/lightbox/"},{"categories":["JavaScript"],"content":"Quick start Add latest jQuery and fancyBox files \u003cscript src=\"https://code.jquery.com/jquery-3.3.1.min.js\"\u003e\u003c/script\u003e \u003clink href=\"/path/to/jquery.fancybox.min.css\" rel=\"stylesheet\" /\u003e \u003cscript src=\"/path/to/jquery.fancybox.min.js\"\u003e\u003c/script\u003e Create links \u003ca data-fancybox=\"gallery\" href=\"big_1.jpg\"\u003e \u003cimg src=\"small_1.jpg\" /\u003e \u003c/a\u003e \u003ca data-fancybox=\"gallery\" href=\"big_2.jpg\"\u003e \u003cimg src=\"small_2.jpg\" /\u003e \u003c/a\u003e Enjoy! ","date":"2021-06-21","objectID":"/posts/lightbox/:3:1","tags":["Lightbox","JavaScript"],"title":"Lightbox","uri":"/posts/lightbox/"},{"categories":["Projects","JavaScript"],"content":"Usage ","date":"2021-05-23","objectID":"/projects/cell-watermark/:0:0","tags":["watermark","JavaScript"],"title":"Cell Watermark","uri":"/projects/cell-watermark/"},{"categories":["Projects","JavaScript"],"content":"Browser Clone source git clone git@github.com:Lruihao/watermark.git Load Watermark \u003cscript type=\"text/javascript\" src=\"./src/watermark.js\"\u003e\u003c/script\u003e \u003cscript type=\"text/javascript\" src=\"./src/watermark.min.js\"\u003e\u003c/script\u003e \u003c!-- Or CDN --\u003e \u003cscript type=\"text/javascript\" src=\"https://cdn.jsdelivr.net/npm/cell-watermark@1.0.3/src/watermark.js\"\u003e\u003c/script\u003e \u003cscript type=\"text/javascript\" src=\"https://cdn.jsdelivr.net/npm/cell-watermark@1.0.3/src/watermark.min.js\"\u003e\u003c/script\u003e Initialization document.addEventListener('DOMContentLoaded', function () { new Watermark({ content: \"cell-watermark\" }) }); ","date":"2021-05-23","objectID":"/projects/cell-watermark/:1:0","tags":["watermark","JavaScript"],"title":"Cell Watermark","uri":"/projects/cell-watermark/"},{"categories":["Projects","JavaScript"],"content":"NPM Install npm i cell-watermark Import import Watermark from 'cell-watermark' /* Or */ var Watermark = require(\"cell-watermark\") Class: Watermark ","date":"2021-05-23","objectID":"/projects/cell-watermark/:2:0","tags":["watermark","JavaScript"],"title":"Cell Watermark","uri":"/projects/cell-watermark/"},{"categories":["Projects","JavaScript"],"content":"Watermark(options) new Watermark(options) Parameters: Name Type Description options Object The options of watermarkï¼ˆPropertiesï¼‰ Properties: Name Type Attributes Default Description content String \u003coptional\u003e watermarkâ€™s text appendTo String \u003coptional\u003e â€˜bodyâ€™ parent of watermarkâ€™s container width Number \u003coptional\u003e 150 watermarkâ€™s width. unit: px height Number \u003coptional\u003e 20 watermarkâ€™s height. unit: px rowSpacing Number \u003coptional\u003e 60 row spacing of watermarks. unit: px colSpacing Number \u003coptional\u003e 30 col spacing of watermarks. unit: px rotate Number \u003coptional\u003e 15 watermarkâ€™s tangent angle. unit: deg opacity Number \u003coptional\u003e 0.1 watermarkâ€™s transparency fontSize Number \u003coptional\u003e 0.85 watermarkâ€™s fontSize. unit: rem fontFamily String \u003coptional\u003e â€˜inheritâ€™ watermarkâ€™s fontFamily Author: Lruihao ","date":"2021-05-23","objectID":"/projects/cell-watermark/:3:0","tags":["watermark","JavaScript"],"title":"Cell Watermark","uri":"/projects/cell-watermark/"},{"categories":["Projects","JavaScript"],"content":"Methods upload(content) Upload watermarkâ€™s text content Parameters: Name Type Description content String watermarkâ€™s text render(options) Rerender watermark Parameters: Name Type Description options Object The options of watermarkï¼ˆPropertiesï¼‰ destroy() Force destroy watermark ","date":"2021-05-23","objectID":"/projects/cell-watermark/:3:1","tags":["watermark","JavaScript"],"title":"Cell Watermark","uri":"/projects/cell-watermark/"},{"categories":["Memo"],"content":"ç¨‹å¼ç¢¼çš„æŒçºŒå„ªåŒ– å°ä¸€å€‹å…¥é–€çš„å·¥ç¨‹å¸«ä¾†èªªï¼ŒæŒæ¡ç¨‹å¼èªæ³•èˆ‡æ¨¡ä»¿ç¯„ä¾‹å¯¦ä½œæ˜¯åŸºæœ¬çš„èƒ½åŠ›ã€‚é‚£æœ‰äº†é€™æ¨£çš„åŸºæœ¬èƒ½ä¹‹å¾Œï¼Œè¦å¦‚ä½•å¯«å‡ºæ›´å¥½çš„ç¨‹å¼å‘¢ï¼Ÿæ€æ¨£æ‰èƒ½å¤ æˆç‚ºä¸€å€‹ã€Œå„ªç§€ã€çš„æ–°æ‰‹å·¥ç¨‹å¸«å‘¢ï¼Ÿäº‹å¯¦ä¸Šï¼Œå¯«å‡ºæœƒå‹•çš„ç¨‹å¼ä¸é›£ï¼Œä½†æƒ³å¯«å‡ºå¥½çš„ç¨‹å¼å…¶å¯¦æ˜¯éœ€è¦åˆ»æ„ç·´ç¿’çš„ã€‚å¤§éƒ¨åˆ†çš„äººæœƒå»ºè­°è¦ã€Œå¤šç·´ç¿’ã€å¤šå¯¦ä½œã€ï¼Œä½†æˆ‘èªç‚ºåœ¨å¤§é‡ç·´ç¿’ä¹‹å¤–ï¼Œé©æ™‚çš„ã€Œå„ªåŒ–ç¨‹å¼ã€ä¹Ÿæ˜¯æå‡ã€Œç¨‹å¼ç¢¼å“è³ªã€é‡è¦çš„é—œéµã€‚è€Œåœ¨ã€Œå„ªåŒ–ç¨‹å¼ã€å¯ä»¥åˆ†æˆå…©å€‹è§’åº¦ï¼š ç¨‹å¼åŸ·è¡Œæ•ˆèƒ½æ›´å¥½ ç¨‹å¼ç¢¼çµæ§‹æ›´ç²¾ç°¡ ç¨‹å¼åŸ·è¡Œæ•ˆèƒ½å°±æ˜¯å¾é€Ÿåº¦è·Ÿç©ºé–“ä¾†æ€è€ƒï¼ŒåŸ·è¡Œæ™‚é–“è¶ŠçŸ­ã€è®Šæ•¸ä½”ç”¨ç©ºé–“è¶Šå°ã€‚è€Œç¨‹å¼ç¢¼çµæ§‹å‰‡æœƒå¾å¯è®€æ€§å’Œç²¾ç°¡ä¾†è¡¡é‡ï¼Œä¾‹å¦‚ï¼šè®Šæ•¸çš„å‘½åæœ‰æ²’æœ‰æ„ç¾©ã€ç¨‹å¼ç¢¼æœ‰æ²’æœ‰å†—ä½™ã€ç¹ç‘£çš„éƒ¨åˆ†ç­‰ç­‰ã€‚åªä¸éæ–°æ‰‹å¾ˆå®¹æ˜“åœç•™åœ¨å¯«å‡ºç¨‹å¼çš„å–œæ‚…ä»¥åŠå—åˆ°å›ºæœ‰çš„è§£é¡Œæ€è€ƒï¼Œè€Œå¿½ç•¥å„ªåŒ–çš„éç¨‹ã€‚ é€éã€ŒCode Reviewã€æ˜¯æ¨è–¦æ–°æ‰‹çš„æ–¹æ³•ï¼Œç¶“ç”±åé¥‹èˆ‡è¨è«–ä¾†æ‰¾å‡ºç¨‹å¼ä¸­å¯å„ªåŒ–çš„ç©ºé–“ã€‚ ","date":"2021-03-04","objectID":"/posts/codereview/:1:0","tags":["codereview"],"title":"Code Review æ€éº¼åšï¼Ÿæ–°æ‰‹å·¥ç¨‹å¸«å¦‚ä½•æå‡ã€Œç¨‹å¼ç¢¼å“è³ªã€","uri":"/posts/codereview/"},{"categories":["Memo"],"content":"Code Review çš„é—œæ³¨é» ä»¥æˆ‘è‡ªå·±çš„ç¶“é©—ä¾†èªªï¼ŒReview ä¸€ä»½å°ˆæ¡ˆçš„æ™‚å€™æœƒé—œæ³¨ï¼š ç¨‹å¼èƒ½ä¸èƒ½æ­£å¸¸æ“ä½œï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ˜æ˜¾çš„é”™è¯¯ï¼Ÿï¼ˆä½æ¨™ï¼‰ ç¨‹å¼ç¢¼ç•¶ä¸­æœ‰æ²’æœ‰å¥‡æ€ªçš„åœ°æ–¹ï¼Ÿï¼ˆå„ªåŒ–ï¼‰ ç¬¬ä¸€å€‹é—œæ³¨é»æ˜¯ç¨‹å¼ç¢¼çš„ä½æ¨™ï¼Œçµæœæ­£ç¢ºèˆ‡å¯æ­£å¸¸é‹è¡Œä¸€å®šæ˜¯æœ€é‡è¦çš„ã€‚å¦‚æœç¨‹å¼ç„¡æ³•é‹è¡Œå‹•æˆ–å­˜åœ¨å¾ˆæ˜é¡¯çš„å•é¡Œï¼Œé‚£å†å¤šçš„å„ªåŒ–éƒ½æ²’æœ‰æ„ç¾©ã€‚é™¤äº†ç¢ºä¿åŸ·è¡Œä¹‹å¤–ï¼ŒåŒæ™‚ä¹Ÿæœƒæª¢æŸ¥ä¸€ä¸‹æ˜¯å¦æœ‰ä½ç´šçš„é‚è¼¯å¤±èª¤æˆ–æ˜¯å®‰å…¨æ€§çš„ç–‘æ…®ï¼Œåƒæ˜¯è³‡æ–™åº«æ²’æœ‰æ­£ç¢ºé—œé–‰æˆ–å¯†ç¢¼æ˜ç¢¼æ²’æœ‰åŠ å¯†ä¹‹é¡çš„å•é¡Œã€‚ ç¬¬äºŒå€‹é—œæ³¨é»æ˜¯ã€Œç¨‹å¼ç¢¼å“è³ªæå‡ã€çš„éƒ¨åˆ†ï¼Œæˆ‘æœƒæŠŠå®ƒå®šç¾©æˆç¨‹å¼é‹ä½œä¸Šæ²’æœ‰å•é¡Œï¼Œä½†çœ‹èµ·ä¾†å¾ˆä¸èˆ’æœæˆ–åŸ·è¡Œæ•ˆç‡å¾ˆå·®çš„éƒ¨åˆ†ã€‚å¤§è‡´ä¸Šå¯ä»¥å¾ä»¥ä¸‹å¹¾é»ä¸‹æ‰‹ï¼š å‘½åæœ‰æ²’æœ‰æ„ç¾©/ä¸ä¸€è‡´ è³‡æ–™åº«çš„æ­£è¦åŒ–æƒ…æ³ æ˜¯å¦å­˜åœ¨ç‰¹åˆ¥è¤‡é›œçš„ç¨‹å¼ç‰‡æ®µï¼ˆä¾‹å¦‚å¤šæ¬¡çš„è³‡æ–™åº«æŸ¥è©¢ã€å¤šå±¤çš„è¿´åœˆä½¿ç”¨ï¼‰ é‡è¤‡çš„ç¨‹å¼ç¢¼æœ‰æ²’æœ‰å®šç¾©æˆ function å†—é•·çš„ç¨‹å¼ç¢¼èƒ½ä¸èƒ½æ‹†åˆ†æˆ function ä¸éä¸€æ¬¡çš„ Code Review å»ºè­°è‘—é‡åœ¨ 3 - 5 å€‹å„ªåŒ–åœ°æ–¹ï¼Œæ¯”è¼ƒå®¹æ˜“èšç„¦åœ¨å„ªåŒ–çš„å“è³ªã€‚æ ¹æ“šæ™‚ç¨‹çš„å£“åŠ›ï¼Œæ±ºå®š Code Review è¿­ä»£çš„æ¬¡æ•¸ã€‚ ","date":"2021-03-04","objectID":"/posts/codereview/:2:0","tags":["codereview"],"title":"Code Review æ€éº¼åšï¼Ÿæ–°æ‰‹å·¥ç¨‹å¸«å¦‚ä½•æå‡ã€Œç¨‹å¼ç¢¼å“è³ªã€","uri":"/posts/codereview/"},{"categories":["Memo"],"content":"å¾æ¶æ§‹çš„è¦åŠƒåˆ°ç´°ç¯€çš„å„ªåŒ– åœ¨æ‹¿åˆ°ä¸€ä»½ç¨‹å¼ç¢¼æ™‚ï¼Œé€šå¸¸æœƒå…ˆæƒéä¸€çœ¼ç¨‹å¼çš„æª”æ¡ˆçµæ§‹ï¼Œæ˜¯å¦æœ‰ä¸è©²ä¸Šå‚³çš„æª”æ¡ˆæˆ–ç¼ºæ¼ã€‚ ä»¥é€™å€‹ä¾‹å­ä¾†èªªï¼Œç¬¬ä¸€çœ¼æœƒè¦ºå¾—æª”æ¡ˆé…ç½®è »çµæ§‹åŒ–çš„ã€‚ä½†å†å¤šçœ‹ä¸€é»æœƒç™¼ç¾å­˜åœ¨å¹¾å€‹å†—é¤˜çš„æª”æ¡ˆï¼Œä¾‹å¦‚ï¼š-filesqqqqã€diffï¼Œç”šè‡³ /icon è³‡æ–™å¤¾ä¹Ÿä¸è©²æ”¾åœ¨æœ€ä¸Šå±¤ã€‚ é€²å…¥ç¨‹å¼çš„ç¬¬ä¸€æ­¥å…ˆå¾ package.json æª”æ¡ˆé–‹å§‹ï¼Œç¢ºèªä¸€ä¸‹å°ˆæ¡ˆçš„åŸºæœ¬è³‡è¨Šæ˜¯å¦å®Œæ•´ã€ä½¿ç”¨åˆ°çš„å¥—ä»¶èˆ‡ç‰ˆæœ¬ï¼Œä»¥åŠç¨‹å¼çš„é€²å…¥é»æ˜¯ä»€éº¼ã€‚ç„¶å¾Œæ‰“é–‹é€²å…¥é»çš„æª”æ¡ˆï¼ˆé€šå¸¸æœƒå‘½åæˆ app æˆ– mainï¼‰ï¼Œé€šå¸¸æœ‰å¹¾å€‹é»éœ€è¦æ³¨æ„ï¼šã€Œå¥—ä»¶çš„è¼‰å…¥é †åºã€æœƒå»ºè­°å¾ç¬¬ä¸‰æ–¹å¥—ä»¶ â†’ è‡ªå®šç¾©çš„æ¨¡çµ„ â†’ ç¨‹å¼å…§çš„è®Šæ•¸é€™æ¨£é †åºå®šç¾©ï¼›ã€Œå–„ç”¨ MVC çš„æ¶æ§‹ã€å°‡éä¸»ç¨‹å¼çš„éƒ¨åˆ†ä¾ç…§åŠŸèƒ½æ‹†åˆ†æ¨¡çµ„ï¼Œé¿å…æª”æ¡ˆè³‡è¨Šé‡å¤ªé›œäº‚ã€‚æ¥è‘—å°±æœƒå¾ Router â†’ Controller â†’ Service â†’ View çš„æµç¨‹ä¸€å€‹ä¸€å€‹åŠŸèƒ½ï¼Œä»¥ä¸‹åˆ†äº«ä¸€äº›å­˜åœ¨å„ªåŒ–ç©ºé–“çš„ç¨‹å¼ç¢¼ï¼š å–„ç”¨å·¥å…·ï¼Œå·²æœ‰çš„å·¥å…·ï¼Œä¸ç”¨è‡ªå·±æ‰‹åˆ» è®Šæ•¸åç¨±ä¸å»ºè­°ç”¨å¤§å¯«é–‹é ­ï¼ˆé€šå¸¸æ˜¯ç”¨åœ¨ Class çš„å‘½åï¼‰ ä¿æŒå„ªåŒ–çš„ç©ºé–“èˆ‡å½ˆæ€§ ã€Œå„ªåŒ–å…¶å¯¦æ˜¯ä¸€ç¨®å–æ¨ã€ï¼Œä¸éœ€è¦ä¹Ÿä¸æ‡‰è©²è¿½æ±‚ä¸€æ­¥åˆ°ä½ã€‚é–‹ç™¼å¾€å¾€éƒ½æ˜¯åœ¨å“è³ªè·Ÿç”¢å‡ºåšå–æ¨ï¼ŒåˆæœŸå¯ä»¥æŠŠé–‹ç™¼ç›®æ¨™æ”¾åœ¨ã€Œå…ˆæ±‚å¯ä»¥å‹•ï¼Œå†æ±‚æŒçºŒå„ªåŒ–ã€çš„ç¯€å¥ä¸Šã€‚æ–°æ‰‹éœ€è¦åœ¨æ„çš„é»æœ‰å¹¾ä¸‹å…©é»ï¼š å¾ˆå®¹æ˜“æŠŠé‡é»å…¨éƒ¨æ”¾åœ¨ç¨‹å¼ç¢¼çš„ç”¢å‡ºä¸Šè€Œå¿½ç•¥çš„ç¨‹å¼ç¢¼çš„å“è³ªã€‚ åœç•™åœ¨åšå‡ºæˆæœçš„å–œæ‚…ï¼Œè€Œåœæ»¯äº†å„ªåŒ–çš„æ­¥èª¿ã€‚ å› æ­¤ï¼Œæœƒå»ºè­°åœ¨é–‹ç™¼ç•¶ä¸‹å°±ã€Œå¤šæƒ³ã€å…©ç§’é˜ï¼Œæ„Ÿè¦ºå¯å„ªåŒ–ä½†ä¾†ä¸åŠçš„éƒ¨åˆ†å…ˆåœ¨æ—é‚ŠåŠ å€‹è¨»è§£æé†’è‡ªå·±ã€‚å¦å¤–ä¹Ÿé¤Šæˆä¸€æ®µæ™‚é–“å›é ­çœ‹ä¹‹å‰çš„ç¨‹å¼ç¢¼çš„ç¿’æ…£ï¼Œè©¦è‘—åˆ»æ„æ‰¾å‡ºå¯ä»¥å„ªåŒ–æ”¹é€²çš„éƒ¨åˆ†ã€‚å°ˆæ¡ˆçš„æäº¤å¯èƒ½æœƒæœ‰æœŸé™ï¼Œä½†ç¨‹å¼ç¢¼çš„å„ªåŒ–æ²’æœ‰ç›¡é ­ã€‚é¢å°ç›¸åŒçš„å°ˆæ¡ˆèˆ‡ç¨‹å¼ç¢¼ï¼Œå”¯æœ‰é€éä¸åœçš„è¿­ä»£å„ªåŒ–æ‰èƒ½æ‰“é€ æ›´å¥½çš„ç¨‹å¼ï¼ŒåŒæ™‚ä¹Ÿè¦‹è­‰äº†ä½ å’Œç¨‹å¼ä¸€èµ·è®Šå¾—æ›´å¥½çš„éç¨‹ã€‚æ‰€ä»¥å»ºç«‹é€æ­¥å„ªåŒ–çš„ç©ºé–“ï¼Œé¤ŠæˆæŒçºŒæå‡ç¨‹å¼ç¢¼å“è³ªçš„ç¿’æ…£ï¼Œæ‰æ˜¯ä¸€å€‹æ–°æ‰‹å·¥ç¨‹å¸«éœ€è¦ä¿®ç…‰çš„å¿ƒæ³•ã€‚ ","date":"2021-03-04","objectID":"/posts/codereview/:3:0","tags":["codereview"],"title":"Code Review æ€éº¼åšï¼Ÿæ–°æ‰‹å·¥ç¨‹å¸«å¦‚ä½•æå‡ã€Œç¨‹å¼ç¢¼å“è³ªã€","uri":"/posts/codereview/"},{"categories":["Projects","çæŠ˜è…¾"],"content":"èµ·å›  èµ·å›  äº‹æƒ…æ˜¯é€™æ¨£ï¼Œå¹´å‰å’Œæœ‹å‹ä¸€èµ·åˆç§Ÿäº†ä¸€å€‹æˆ¿å­ï¼Œç„¶å¾Œæï¼Œç”Ÿæ´»å˜›ï¼Œé™¤äº†é–‹å¿ƒï¼Œç•¶ç„¶æ˜¯ä¹¾é£¯æœ€å¤§å•¦ï¼ è‡ªç„¶å°±æœƒæœ‰è³¼ç‰©ï¼Œè²·èœç­‰æ—¥å¸¸æ¶ˆè²»ï¼Œé‚£å°±è¦è¨˜è³¬ï¼Œä¸€é–‹å§‹æ˜¯å„è‡ªè¨˜åœ¨æ‰‹æ©Ÿçš„ä¾¿ç°½ä¸Šï¼Œæœ€å¾Œå†ç®—ä¸€ä¸‹ï¼› ä¸‰å€‹äººï¼Œä¸€å…±ä¸ƒç§çµ„åˆæ¶ˆè²»ï¼Œæ’é™¤å„è‡ªæ¶ˆè²»çš„ä¸‰ç¨®æƒ…æ³ï¼Œä¹Ÿæœ‰å››ç¨® (AB, AC, BC, ABC)ã€‚å¥½éº»ç…©å•Šï¼ï¼ï¼ ","date":"2021-03-02","objectID":"/projects/bill-note/:1:0","tags":["JavaScript","leancloud","Vue"],"title":"åŸºäº leancloud-storage å®ç°çš„æ— åç«¯è®°è´¦æœ¬","uri":"/projects/bill-note/"},{"categories":["Projects","çæŠ˜è…¾"],"content":"ç¶“é ä½œç‚ºä¸€å€‹ç¨‹åºçŒ¿ï¼Œæ€éº¼èƒ½æ¥å—é€™éº¼éº»ç…©çš„è¨˜è³¬æ–¹å¼å‘¢ï¼Œæ‹¿èµ·ç­†å°±é–‹å§‹ç•«ï¼Œæ–¼æ˜¯æœ‰äº†ä¸‹é¢é€™å¼µåœ–çš„å…¬å¼ã€‚ç°¡å–®èªªæ˜ä¸€ä¸‹å°±æ˜¯ï¼š è¨­å‰é¢èªªçš„å››ç¨®çµ„åˆç‚ºï¼šX1, X2, X3, X4ï¼Œå€‹äººå¯¦éš›ä»˜æ¬¾ç¸½é¡ç‚ºï¼šY1, Y2, Y3ï¼Œé‚£éº¼å¸¶å…¥æœªçŸ¥æ•¸ï¼Œæˆ‘å€‘å°±å¯ä»¥ç®—å‡ºæ¯å€‹äººæœ€å¾Œçµç®—æ™‚çš„éŒ¢ï¼šS1, S2, S3ï¼Œ ç¶œä¸Šæ‰€è¿°ï¼Œå¾ˆå¥½ç†è§£ï¼Œç•¶ S \u003e= 0 æ™‚ï¼Œæ”¶ç´…åŒ…ï¼Œç•¶ S \u003c 0 æ™‚ï¼Œç™¼ç´…åŒ…ã€‚ OKï¼Œä¸€å€‹ç°¡å–®çš„åˆä¸­æ–¹ç¨‹å¼å·²ç¶“åˆ°ä½äº†ï¼Œä¸‹ä¸€æ­¥ï¼Œæ€è€ƒä¸€ä¸‹ï¼Œç”¨ä»€éº¼ä¾†é‹ä½œé€™å€‹é€™å€‹æ–¹ç¨‹ã€‚ä¾†ï¼Œå…ˆè·‘å€‹é¡Œï¼Œæ˜¥ç¯€æœŸé–“ï¼Œä¸æ˜¯æ¯å¤©éƒ½è¦åœ¨é¨°è¨Šæ–‡æª”ä¸Šå¡«è¡¨è¨˜éŒ„æ´»å‹•è»Œè·¡å—ï¼Ÿ å†å›ä¾†ï¼Œé‚£ä¸å¦‚å°±ç”¨ excel å¯¦ç¾å§ï¼Œä¸‰å€‹äººéƒ½å¯ä»¥åœ¨æ‰‹æ©Ÿä¸Šç·¨è¼¯ã€‚å¥½çš„ï¼Œèªªåšå°±åšã€‚ ä¸€é “æ“ä½œï¼Œ10 minutes laterâ€¦ åªæ–°å»ºäº†ä¸€å€‹ excel æ–‡ä»¶ï¼ŒO.o! ä¸æœƒ excelï¼Œæœæ–·æ”¾æ£„ï¼Œå¦å°‹ä»–è·¯ã€‚ ","date":"2021-03-02","objectID":"/projects/bill-note/:2:0","tags":["JavaScript","leancloud","Vue"],"title":"åŸºäº leancloud-storage å®ç°çš„æ— åç«¯è®°è´¦æœ¬","uri":"/projects/bill-note/"},{"categories":["Projects","çæŠ˜è…¾"],"content":"çµæœ å›åˆ°æœ¬è·ï¼Œé‚£ä¸å¦‚å¯«å€‹ç¶²ç«™å§ï¼Œå¯æ˜¯ç•¢æ¥­å¾Œï¼Œå­¸ç”Ÿæ©Ÿæœå‹™å™¨ä¹ŸéæœŸäº†ï¼Œæ€éº¼æï¼Ÿé‚£å°±å¯«å€‹ç´”å‰ç«¯çš„ï¼Œæ•¸æ“šå‘¢å­˜å“ªè£¡ï¼Ÿ åˆ¥æ€¥ï¼Œé‡æ–°æ“¼ä¸€æ“¼éœ€æ±‚å…ˆï¼š å­˜å–æ¶ˆè²»æ•¸æ“š è¨ˆç®—æ¯æœˆï¼Œå¯¦ä»˜ï¼ˆç¸½åˆ†ï¼‰ï¼Œæ‡‰ä»˜ä»¥åŠæœ€å¾Œè¨ˆç®—çµç®—é‡‘é¡ æŒ‰æœˆæŸ¥è©¢ï¼Œæœˆçµè³¬å–® ä¸‰äººçš†å¯ç·¨è¼¯ ä¸»è¦å°±æ˜¯å­˜å–æ•¸æ“šé€™é»ï¼Œæ²’æœ‰æœå‹™å™¨ï¼Œæ•¸æ“šåº«æ€éº¼å¯¦ç¾ï¼Ÿ valine å¯ä»¥å¯¦ç¾ç„¡å¾Œç«¯ï¼Œé‚£æˆ‘æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ï¼Œleancloud æ–‡æª”èµ°ä¸€æ³¢ï¼Œç„¶å¾Œâ€œæ•¸æ“šè¡¨â€è¨­è¨ˆä¸€ä¸‹ï¼Œå…¶å¯¦æ˜¯ leancloud-storage Object ï¼Œæ–¼æ˜¯æœ‰äº†ä»¥ä¸‹æ±è¥¿ï¼Œæºç¢¼æ”¾åœ¨ Github bill-note http://github.com/Lruihao/bill-note ","date":"2021-03-02","objectID":"/projects/bill-note/:3:0","tags":["JavaScript","leancloud","Vue"],"title":"åŸºäº leancloud-storage å®ç°çš„æ— åç«¯è®°è´¦æœ¬","uri":"/projects/bill-note/"},{"categories":["Projects","çæŠ˜è…¾"],"content":"æ•¸æ“šè¨­è¨ˆ å» leancloud åˆ›å»ºä¸€ä¸ªåº”ç”¨ï¼Œå†æ–°å¢ä¸€ä¸ª Bill Class, è¡¥å……ä¸€ä¸‹å­—æ®µï¼š name type description pay Number æ¶ˆè´¹é‡‘é¢ pay_description String æ¶ˆè´¹æè¿° pay_type String æ¶ˆè´¹ç±»å‹ pay_user String ä»˜æ¬¾äºº ","date":"2021-03-02","objectID":"/projects/bill-note/:3:1","tags":["JavaScript","leancloud","Vue"],"title":"åŸºäº leancloud-storage å®ç°çš„æ— åç«¯è®°è´¦æœ¬","uri":"/projects/bill-note/"},{"categories":["Projects","çæŠ˜è…¾"],"content":"ä¸»è¦é‚è¼¯ åˆå§‹åŒ– set for yourself. AV.init({ appId: '', appKey: '', serverURL: '' }); å­˜æ•¸æ“š //è¨˜è³¬æäº¤æŒ‰éˆ•äº‹ä»¶ç›£è½ document.querySelector('.submit').addEventListener('click', function (event) { event.preventDefault(); let formPay = document.querySelector('#form-pay'); let bill = new AV.Object('Bill'); bill.set('pay', Number(formPay.pay.value)); bill.set('pay_type', Number(formPay.pay_type.value)); bill.set('pay_user', Number(formPay.pay_user.value)); bill.set('pay_description', formPay.pay_description.value); bill.save().then( (object) =\u003e { formPay.reset(); }, function (error) { console.log(JSON.stringify(error)); alert('ä¿å­˜å¤±æ•—'); } ); }); å–æ•¸æ“š /** * ç²å–æ­·å²æ¶ˆè²»è¨˜éŒ„æ•¸æ“š * @param [start=0] é–‹å§‹ä½ç½® * @param [count=15] æ¯æ¬¡æŸ¥è©¢ç­†æ•¸ */ function getBillData(start = 0, count = 15) { queryBill .descending('createdAt') .skip(start * count) .limit(count) .find() .then(function (response) { let billLength = response.length; if (billLength \u003e 0) { billVm.noMore = billLength !== count ? true : false; for (bill of response) { billVm.bills.push({ pay: bill.attributes.pay, payType: payType[bill.attributes.pay_type], payUser: payUser[bill.attributes.pay_user], payDescription: bill.attributes.pay_description, payDt: new Date(bill.createdAt).toLocaleString() }); } } else { billVm.noMore = true; } }); } /** * ç²å–æœˆè³¬å–®æ•¸æ“š * @param month å¹´æœˆä»½ fmt: yyyy-MM */ function getMonthBill(month) { let dateTime = `${month} 00:00:00`; let startMonth = new Date(dateTime); let nextMonth = new Date(new Date(dateTime).setMonth(startMonth.getMonth() + 1)); let startDateQuery = new AV.Query('Bill'); startDateQuery.greaterThanOrEqualTo('createdAt', startMonth); let endDateQuery = new AV.Query('Bill'); endDateQuery.lessThan('createdAt', nextMonth); let MonthBillQuery = AV.Query.and(startDateQuery, endDateQuery); MonthBillQuery.find().then(function (response) { billVm.monthBill = { payType0: 0, payType1: 0, payType2: 0, payType3: 0, payUser0: 0, payUser1: 0, payUser2: 0 }; for (bill of response) { let { pay, pay_type, pay_user } = bill.attributes; billVm.monthBill[`payType${pay_type}`] += pay; billVm.monthBill[`payUser${pay_user}`] += pay; } }); } ","date":"2021-03-02","objectID":"/projects/bill-note/:3:2","tags":["JavaScript","leancloud","Vue"],"title":"åŸºäº leancloud-storage å®ç°çš„æ— åç«¯è®°è´¦æœ¬","uri":"/projects/bill-note/"},{"categories":["Projects","çæŠ˜è…¾"],"content":"æŠ€è¡“æ£§ leancloud-storage Vue.js HTML,CSS,JS ","date":"2021-03-02","objectID":"/projects/bill-note/:3:3","tags":["JavaScript","leancloud","Vue"],"title":"åŸºäº leancloud-storage å®ç°çš„æ— åç«¯è®°è´¦æœ¬","uri":"/projects/bill-note/"},{"categories":["Projects","çæŠ˜è…¾"],"content":"ç¸½çµ ç°¡å–®ç¸½çµä¸€ä¸‹ï¼Œç™»å½•åŠŸèƒ½ä¸åšï¼Œå®‰ä¸å®‰å…¨è‡ªå·±è¯´äº†ç®—ã€‚åˆ é™¤ä¿®æ”¹åŠŸèƒ½ä¹Ÿä¸åšï¼Œç›´æ¥ä¸Š leancloud æ“ä½œï¼Œcss ç¾åŒ–çš„æ ·å¼ä¹Ÿä¸å†™ï¼Œå¹²å‡€åˆå«ç”Ÿï¼ ç„¶åè¡ç”Ÿä¸€ä¸‹ï¼Œä»€ä¹ˆè¿‡å¹´æ–—åœ°ä¸»ï¼Œå¤©ç‚¸ï¼Œéº»å°†ï¼Œå­—ç‰Œè®°è´¦ç³»ç»Ÿé‚£ä¸ä¹Ÿæ˜¯åŒç†å¯å¾—å˜›ï¼ over! æ•ˆæœ ","date":"2021-03-02","objectID":"/projects/bill-note/:4:0","tags":["JavaScript","leancloud","Vue"],"title":"åŸºäº leancloud-storage å®ç°çš„æ— åç«¯è®°è´¦æœ¬","uri":"/projects/bill-note/"},{"categories":["Projects"],"content":" åŸºäº Laravel7 å¼€å‘ï¼ŒMarkdown è¯­æ³•çš„ä¸ªäººç‹¬ç«‹åšå®¢ã€‚Cell Blog, ä¹Ÿæ˜¯æˆ‘çš„æ¯•ä¸šè®¾è®¡ä½œå“ï¼Œç›®å‰å·²é–‹æºã€‚ ","date":"2020-07-25","objectID":"/projects/cell-blog/:0:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog åŠŸèƒ½ä»‹ç»ä¸å®‰è£…","uri":"/projects/cell-blog/"},{"categories":["Projects"],"content":"åŠŸèƒ½ æ”¯æŒ Markdown, æ–‡ç« å®æ—¶é¢„è§ˆæ•ˆæœ æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ä»£ç é«˜äº® ç¼–è¾‘å™¨å›¾ç‰‡ä¸Šä¼  åå°ä¸Šä¼ æ–‡ä»¶ç®¡ç† æ–‡ç« æœç´¢ æ–‡ç« åˆ†ç±» æ–‡ç« æ ‡ç­¾ çƒ­é—¨æ–‡ç«  éšæœºæ ¼è¨€ æ–‡ç« ç®¡ç†ï¼ˆå‘å¸ƒï¼Œè¯„è®ºå¼€å…³ï¼Œæ’åºï¼‰ è‡ªå®šä¹‰å¯¼èˆªï¼ˆæ˜¾ç¤ºå¼€å…³ï¼Œæ’åºï¼‰ è‡ªå®šä¹‰é¡µé¢ï¼ˆå‘å¸ƒå¼€å…³ï¼‰ å‹æƒ…é“¾æ¥ï¼ˆæ˜¾ç¤ºå¼€å…³ï¼Œæ’åºï¼‰ COS æ¡¶ç›¸å†Œ ä¸°å¯Œçš„åšå®¢é…ç½®ï¼ˆæ–¹ä¾¿æ‰©å±•ï¼Œæ”¯æŒè‡ªå®šä¹‰ JS è„šæœ¬ï¼‰ ä¸è’œå­è®¡æ•° Leancloud è®¡æ•° Valine è¯„è®ºæ’ä»¶ æ–‡ç« åˆ†äº«æ’ä»¶ ","date":"2020-07-25","objectID":"/projects/cell-blog/:1:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog åŠŸèƒ½ä»‹ç»ä¸å®‰è£…","uri":"/projects/cell-blog/"},{"categories":["Projects"],"content":"æˆªå›¾ ","date":"2020-07-25","objectID":"/projects/cell-blog/:2:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog åŠŸèƒ½ä»‹ç»ä¸å®‰è£…","uri":"/projects/cell-blog/"},{"categories":["Projects"],"content":"å®‰è£… æ³¨æ„äº‹é¡¹ï¼šPHP å–æ¶ˆç¦ç”¨å‡½æ•°putenv()å’Œsymlink()ï¼Œå®‰è£…fileinfoæ‰©å±•ã€‚ ä¸‹è½½ git clone https://github.com/Lruihao/cell-blog.git è¿›å…¥ç«™ç‚¹ cd cell-blog ç”Ÿæˆã€‚env cp .env.example .env ç¼–è¾‘ã€‚env ç¯å¢ƒé…ç½® APP_URL=http://localhost #ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨æ–‡ä»¶æ—¶ï¼Œå¿…é¡»å¡«å†™æ­£ç¡®åœ°å€ APP_DEBUG=false #å…³é—­è°ƒè¯• DB_HOST= #æ•°æ®åº“åœ°å€ DB_PORT=3306 #æ•°æ®åº“ç«¯å£ DB_DATABASE= #æ•°æ®åº“åç§° DB_USERNAME= #æ•°æ®åº“ç”¨æˆ· DB_PASSWORD= #æ•°æ®åº“å¯†ç  æ‰“å¼€app\\Providers\\AppServiceProvider.php, æ³¨é‡ŠSystemController:load() é˜²æ­¢åç»­æ­¥éª¤æŠ¥é”™ public function boot() { Schema::defaultStringLength(191); //SystemController::load(); } å®‰è£…é¡¹ç›®ä¾èµ– composer install ç”Ÿæˆ key php artisan key:generate è¿è¡Œæ•°æ®è¿ç§»å’Œåå°æ•°æ®å¡«å…… php artisan admin:installå·²åŒ…å«æ•°æ®è¿ç§»å‘½ä»¤php artisan migrate G:\\cell-blog\\app\\Admin directory already exists !æ— éœ€ç†ä¼šï¼Œç»§ç»­æ‰§è¡Œå‰©ä¸‹å‘½ä»¤å³å¯ã€‚ php artisan admin:install php artisan admin:import media-manager php artisan db:seed é»˜è®¤ä¸‹ä½¿ç”¨äº†æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåˆ›å»º storage ç›®å½•åœ¨ public çš„è½¯é“¾æ¥ php artisan storage:link æ‰“å¼€app\\Providers\\AppServiceProvider.php, å–æ¶ˆæ³¨é‡ŠSystemController:load() public function boot() { Schema::defaultStringLength(191); SystemController::load(); } å°†åšå®¢ç½‘ç«™æ ¹ç›®å½•æŒ‡å‘å…¥å£ public ç›®å½• å¦‚æœä½¿ç”¨ Nginxï¼Œè¦è®¾ç½®ä¼ªé™æ€ location / { try_files $uri $uri/ /index.php?$query_string; } å¯åŠ¨æœåŠ¡åï¼Œåœ¨æµè§ˆå™¨æ‰“å¼€http://localhost/admin/, ä½¿ç”¨ç”¨æˆ·åadminå’Œå¯†ç adminç™»å½•ã€‚ ","date":"2020-07-25","objectID":"/projects/cell-blog/:3:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog åŠŸèƒ½ä»‹ç»ä¸å®‰è£…","uri":"/projects/cell-blog/"},{"categories":["Projects"],"content":"License Cell Blog is open-sourced software licensed under the MIT license. ","date":"2020-07-25","objectID":"/projects/cell-blog/:4:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog åŠŸèƒ½ä»‹ç»ä¸å®‰è£…","uri":"/projects/cell-blog/"},{"categories":["Memo"],"content":" Cell Blog å¼€å‘è®°å½•ï¼Œé¡¹ç›®åœ°å€ ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:0:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"æ­å»º php ç¯å¢ƒ å®‰è£… wampserver å®‰è£… composer æ›´æ¢ aliyun æº composer config -g repo.packagist composer https://mirrors.aliyun.com/composer/ ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:1:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"æ–°å»º laravel é¡¹ç›® composer create-project --prefer-dist laravel/laravel cell-blog \"7.*\" æˆ–è€… composer global require laravel/installer laravel new blog ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:2:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"ä¸‹è½½ debugbar composer require barryvdh/laravel-debugbar --dev ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:3:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"ä¿®æ”¹è¯­è¨€æ—¶åŒº ä¿®æ”¹ config/app.phpï¼Œå°† local çš„å€¼ en æ”¹æˆ zh-CN(laravel-admin è‡ªå¸¦ zh-CN)ï¼š ## æ—¶åŒº 'timezone' =\u003e 'Asia/Shanghai', ## è¯­è¨€ 'locale' =\u003e 'zh-CN', ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:4:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"é…ç½®æ•°æ®åº“ é¦–å…ˆç¡®ä¿å®‰è£…å¥½äº† laravelï¼Œå¹¶ä¸”æ•°æ®åº“è¿æ¥è®¾ç½®æ­£ç¡®ã€‚ APP_URL=http://cell.blog DB_CONNECTION=mysql DB_HOST=127.0.0.1 DB_PORT=3307 DB_DATABASE=cell_blog DB_USERNAME=root DB_PASSWORD=123456 ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:5:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"ä¸‹è½½ laravel-admin cd cell-blog composer require encore/laravel-admin å¸è½½å‘½ä»¤composer remove xxx ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å‘å¸ƒèµ„æºï¼š php artisan vendor:publish --provider=\"Encore\\Admin\\AdminServiceProvider\" åœ¨è¯¥å‘½ä»¤ä¼šç”Ÿæˆé…ç½®æ–‡ä»¶config/admin.phpï¼Œå¯ä»¥åœ¨é‡Œé¢ä¿®æ”¹å®‰è£…çš„åœ°å€ã€æ•°æ®åº“è¿æ¥ã€ä»¥åŠè¡¨åï¼Œå»ºè®®éƒ½æ˜¯ç”¨é»˜è®¤é…ç½®ä¸ä¿®æ”¹ã€‚ ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤å®Œæˆå®‰è£…ï¼š php artisan admin:install è¿è¡Œè¿™ä¸ªå‘½ä»¤çš„æ—¶å€™ï¼Œå¦‚æœé‡åˆ°äº†ä¸‹é¢çš„é”™è¯¯ï¼š SQLSTATE[42000]: Syntax error or access violation: 1071 Specified key was too long; max key length is 1000 bytes (SQL: alter tableusersadd uniqueusers_email_unique(email)) å‚è€ƒè¿™ä¸ª issue æ¥è§£å†³ https://github.com/z-song/laravel-admin/issues/1541 åœ¨app\\Providers\\AppServiceProvider.phpæ·»åŠ é»˜è®¤å€¼ \u003c?php namespace App\\Providers; use Illuminate\\Support\\ServiceProvider; use Illuminate\\Support\\Facades\\Schema; //add fixed sql class AppServiceProvider extends ServiceProvider { /** * Bootstrap any application services. * * @return void */ public function boot() { Schema::defaultStringLength(191); //add fixed sql } /** * Register any application services. * * @return void */ public function register() { // } } å¯åŠ¨æœåŠ¡åï¼Œåœ¨æµè§ˆå™¨æ‰“å¼€ http://localhost/admin/ , ä½¿ç”¨ç”¨æˆ·å admin å’Œå¯†ç  admin ç™»å½•ã€‚ æŠ¥é”™Disk [admin] not configured, please add a disk config in config/filesystems.php åœ¨config/filesystems.phpä¸­ disks å¤„æ·»åŠ ä»¥ä¸‹é…ç½®åæ‰§è¡Œphp artisan storage:linkæ¥åˆ›å»ºè½¯é“¾æ¥ï¼ˆwindows å’Œ linux çš„è½¯é“¾æ¥ä¸ä¸€æ ·ä¸èƒ½ç›´æ¥å¤åˆ¶ï¼ï¼‰ å®å¡”æ‰§è¡Œæ—¶åˆ é™¤ç¦ç”¨å‡½æ•° putenv(),symlink() 'admin' =\u003e [ 'driver' =\u003e 'local', 'root' =\u003e storage_path('app/public/system'), 'url' =\u003e env('APP_URL').'/storage/system', 'visibility' =\u003e 'public', ], æˆ– 'admin' =\u003e [ 'driver' =\u003e 'local', 'root' =\u003e public_path('uploads'), 'url' =\u003e env('APP_URL').'/public/uploads/', 'visibility' =\u003e 'public', ], ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:6:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"ä¸‹è½½ dcat-admin composer require dcat/laravel-admin ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å‘å¸ƒèµ„æºï¼š php artisan admin:publish åœ¨è¯¥å‘½ä»¤ä¼šç”Ÿæˆé…ç½®æ–‡ä»¶config/admin.phpï¼Œå¯ä»¥åœ¨é‡Œé¢ä¿®æ”¹å®‰è£…çš„åœ°å€ã€æ•°æ®åº“è¿æ¥ã€ä»¥åŠè¡¨åï¼Œå»ºè®®éƒ½æ˜¯ç”¨é»˜è®¤é…ç½®ä¸ä¿®æ”¹ã€‚ ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤å®Œæˆå®‰è£…ï¼š php artisan admin:install ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:7:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"è¿ç§»æ–‡ä»¶åˆ›å»ºè¡¨ php artisan make:migration create_articles_table php artisan make:migration create_tags_table php artisan make:migration create_categories_table php artisan make:migration create_article_tags_table php artisan make:migration create_navigations_table php artisan make:migration create_friendship_links_table php artisan make:migration create_pages_table php artisan make:migration create_systems_table php artisan make:migration create_mottoes_table è¿è¡Œè¿ç§» php artisan migrate ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:8:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"åˆ›å»ºæ¨¡å‹ model php artisan make:model Models/Article php artisan make:model Models/Category php artisan make:model Models/Tag php artisan make:model Models/Navigation php artisan make:model Models/FriendshipLink php artisan make:model Models/Page php artisan make:model Models/System php artisan make:model Models/Motto ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:9:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"åˆ›å»ºæ§åˆ¶å™¨ php artisan admin:make ArticleController --model=App\\Models\\Article php artisan admin:make CategoryController --model=App\\Models\\Category php artisan admin:make TagController --model=App\\Models\\Tag php artisan admin:make NavigationController --model=App\\Models\\Navigation php artisan admin:make FriendshipLinkController --model=App\\Models\\FriendshipLink php artisan admin:make PageController --model=App\\Models\\Page php artisan admin:make SystemController --model=App\\Models\\System php artisan admin:make MottoController --model=App\\Models\\Motto ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:10:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"æ·»åŠ åå°è·¯ç”± app/Admin/routes.php $router-\u003eresource('articles', ArticleController::class); $router-\u003eresource('categories', CategoryController::class); $router-\u003eresource('tags', TagController::class); $router-\u003eresource('navigations', NavigationController::class); $router-\u003eresource('friendship-links', FriendshipLinkController::class); $router-\u003eresource('pages', PageController::class); $router-\u003eresource('systems', SystemController::class); $router-\u003eresource('mottoes', MottoController::class); ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:11:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"editormd å®‰è£… editormd github å›¾åƒé—®é¢˜ ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:12:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"å­˜æ”¾æœ¬åœ°è¡¨æƒ… public\\vendor\\laravel-admin-ext\\editormd\\editormd-1.5.0\\images\\emojis ä¿®æ”¹ editormd.js åŠ editormd.min.js // Emoji graphics files url path editormd.emoji = { path : \"/iamges/emojis/\", ext : \".png\" }; ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:12:1","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"å›¾ç‰‡ä¸Šä¼  csrf 419 é”™è¯¯ å¯ä»¥åœ¨VerifyCsrfToken.phpä¸­æ·»åŠ ç™½åå•è·³è¿‡éªŒè¯ï¼Œæˆ–è€…æ‰‹åŠ¨æ·»åŠ  csrf éªŒè¯å™¨ï¼š ä¿®æ”¹ image-dialog.js çš„var dialogContent å‚è€ƒ if (settings.crossDomainUpload) { action += \"\u0026callback=\" + settings.uploadCallbackURL + \"\u0026dialog_id=editormd-image-dialog-\" + guid; } //æ·»åŠ  csrf éªŒè¯ var csrfToken = $('meta[name=\"csrf-token\"]').attr('content'); var csrfField = \"\"; if (csrfToken) { csrfField = \"\u003cinput type='hidden' name='_token' value='\" + csrfToken + \"' /\u003e\"; } ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:12:2","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"markdown è½¬ HTML https://www.zhiqiexing.com/119.html Laravel Markdown å®‰è£… composer require graham-campbell/markdown php artisan vendor:publish æ‰©å±•è¡¨æ ¼ composer require league/commonmark config/markdown.php 'extensions' =\u003e [ League\\CommonMark\\Extension\\TaskList\\TaskListExtension::class, ], ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:13:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"Eloquent æ¨¡å‹äº‹ä»¶ Eloquent æ¨¡å‹å¯ä»¥è§¦å‘äº‹ä»¶ï¼Œå…è®¸ä½ åœ¨æ¨¡å‹ç”Ÿå‘½å‘¨æœŸä¸­çš„å¤šä¸ªæ—¶é—´ç‚¹è°ƒç”¨å¦‚ä¸‹è¿™äº›æ–¹æ³•ï¼šretrieved, creating, created, updating, updated, saving, saved, deleting, deleted, restoring, restoredã€‚äº‹ä»¶å…è®¸ä½ åœ¨ä¸€ä¸ªæŒ‡å®šæ¨¡å‹ç±»æ¯æ¬¡ä¿å­˜æˆ–æ›´æ–°çš„æ—¶å€™æ‰§è¡Œä»£ç ã€‚ retrieved äº‹ä»¶ä¼šåœ¨ä»æ•°æ®åº“ä¸­è·å–å·²å­˜åœ¨æ¨¡å‹æ—¶è§¦å‘ã€‚å½“ä¸€ä¸ªæ–°æ¨¡å‹è¢«é¦–æ¬¡ä¿å­˜çš„æ—¶å€™ï¼Œcreating å’Œ created äº‹ä»¶ä¼šè¢«è§¦å‘ã€‚å¦‚æœä¸€ä¸ªæ¨¡å‹å·²ç»åœ¨æ•°æ®åº“ä¸­å­˜åœ¨å¹¶è°ƒç”¨ save æ–¹æ³•ï¼Œupdating/updated äº‹ä»¶ä¼šè¢«è§¦å‘ï¼Œæ— è®ºæ˜¯åˆ›å»ºè¿˜æ˜¯æ›´æ–°ï¼Œsaving/saved äº‹ä»¶éƒ½ä¼šè¢«è§¦å‘ã€‚ ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:14:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"æ·»åŠ åå°éªŒè¯ç  ä¾èµ– php æ‰©å±•fileinfo æ·»åŠ éªŒè¯ç  ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:15:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"Media manager composer require laravel-admin-ext/media-manager php artisan admin:import media-manager â€™extensionsâ€™ =\u003e [ â€˜media-managerâ€™ =\u003e [ // Select a local disk that you configured in config/filesystem.php â€˜diskâ€™ =\u003e â€˜publicâ€™ ], ], ## ç»™ laravel-admin å¢åŠ é”å±åŠŸèƒ½ composer require laravel-admin-ext/lock-screen 'route' =\u003e [ 'prefix' =\u003e 'demo', 'namespace' =\u003e 'App\\\\Admin\\\\Controllers', // åœ¨ä¸­é—´ä»¶æ•°ç»„ä¸­åŠ ä¸Š'admin.lock' 'middleware' =\u003e ['web', 'admin', 'admin.lock'], ], ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:16:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"å‰å°è®¾è®¡ åˆ›å»ºæ§åˆ¶å™¨ php artisan make:controller HomeController php artisan make:controller ArticleController php artisan make:controller CategoryController php artisan make:controller TagController php artisan make:controller PageController ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:17:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["Memo"],"content":"åå° img ç¯ç®± https://github.com/laravel-admin-extensions/grid-lightbox composer require laravel-admin-ext/grid-lightbox php artisan vendor:publish --tag=laravel-admin-grid-lightbox ","date":"2020-07-25","objectID":"/posts/cell-blog-dev/:18:0","tags":["PHP","Laravel","Markdown"],"title":"cell-blog å¼€å‘è®°å½•","uri":"/posts/cell-blog-dev/"},{"categories":["çæŠ˜è…¾","Python"],"content":" ä½¿ç”¨ python æ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºåˆ· csdn è®¿é—®é‡ï¼Œè„šæœ¬ä»…åšå­¦ä¹ ï¼Œè¯·å‹¿æ»¥ç”¨~ ç›´æ¥ä¸¢ä»£ç ï¼ŒæŠŠä»£ç æŒ‚åˆ°æœåŠ¡å™¨ä¸Šå¯ä»¥ç­–é©¬å¥”è…¾~ï¼Œä¹Ÿå¯ä»¥ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶æ”¾åˆ° Windows æ¡Œé¢ä¸Šéšæ—¶ä½¿ç”¨~ æ‰“åŒ… exe å‚è€ƒ #!/usr/bin/python # -*- coding: utf-8 -*- __author__ = 'lruihao.cn' import urllib.request import re import time from bs4 import BeautifulSoup opener = urllib.request.build_opener() opener.addheaders = [('User-agent', 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 UBrowser/4.0.3214.0 Safari/537.36')] def get_article_url(page,name): endurl = \"/\"+name+\"/article/details/........\" print(name) p = re.compile(endurl) url = \"http://blog.csdn.net/\"+name+\"/article/list/\"+str(page) # ä½¿ç”¨ build_opener() æ˜¯ä¸ºäº†è®© python ç¨‹åºæ¨¡ä»¿æµè§ˆå™¨è¿›è¡Œè®¿é—® html = opener.open(url).read().decode('utf-8') allfinds = p.findall(html) return allfinds #print('allfinds',allfinds) def start_do(allfinds): urlBase = \"http://blog.csdn.net\" # éœ€è¦å°†ç½‘å€åˆå¹¶çš„éƒ¨åˆ† # é¡µé¢ä¸­çš„ç½‘å€æœ‰é‡å¤çš„ï¼Œéœ€è¦ä½¿ç”¨ set è¿›è¡Œå»é‡å¤ mypages = list(set(allfinds)) for i in range(len(mypages)): mypages[i] = urlBase + mypages[i] print('è¦åˆ·çš„ç½‘é¡µæœ‰ï¼š') for index, page in enumerate(mypages): print(str(index), page) # è®¾ç½®æ¯ä¸ªç½‘é¡µè¦åˆ·çš„æ¬¡æ•° brushNum = 1 # æ‰€æœ‰çš„é¡µé¢éƒ½åˆ· print('ä¸‹é¢å¼€å§‹åˆ·äº†å“¦ï¼š') for index, page in enumerate(mypages): for j in range(brushNum): try: pageContent = opener.open(page).read().decode('utf-8') # ä½¿ç”¨ BeautifulSoup è§£ææ¯ç¯‡åšå®¢çš„æ ‡é¢˜ soup = BeautifulSoup(pageContent) blogTitle = str(soup.title.string) blogTitle = blogTitle[0:blogTitle.find('-')] print(str(j), blogTitle) except urllib.error.HTTPError: print('urllib.error.HTTPError') time.sleep(3) # å‡ºç°é”™è¯¯ï¼Œåœå‡ ç§’å…ˆ except urllib.error.URLError: print('urllib.error.URLError') time.sleep(3) # å‡ºç°é”™è¯¯ï¼Œåœå‡ ç§’å…ˆ time.sleep(0.5) # æ­£å¸¸åœé¡¿ï¼Œä»¥å…æœåŠ¡å™¨æ‹’ç»è®¿é—® def main(name): for page in range(1,5): print(\"************ç¬¬\"+str(page)+\"é¡µ*************\") endurl = get_article_url(page,name) start_do(endurl) if __name__ == '__main__': name = input(\"è¾“å…¥ä½ çš„ csdn ç”¨æˆ·åï¼š\") if name==\"\": name = \"qq_39520417\" #cheung99857 while 1: main(name) print(\"å¼€å§‹ä¼‘æ¯ ...\") time.sleep(40) ä¸»å‡½æ•°ä¹Ÿå¯ä»¥è¿™æ ·å†™å®ç°åŒæ—¶åˆ·å¤šäººçš„è®¿é—®é‡ï¼Œäººå¤šå¯ä»¥é€‚å½“å‡å°‘ä¼‘çœ æ—¶é—´ï¼Œå½“ç„¶æœ‰å…´è¶£çš„å¯ä»¥å°è¯•ä¸€ä¸‹å¤šçº¿ç¨‹~ if __name__ == '__main__': # å¤šç”¨æˆ· names = [\"qq_39520417\",\"cheung99857\"] while 1: for name in names: main(name) print(\"å¼€å§‹ä¼‘æ¯ ...\") # æ§åˆ¶ä¼‘çœ æ—¶é—´ç›¸å½“äºæ§åˆ¶åˆ·æ–°çš„é€Ÿåº¦ time.sleep(30) ","date":"2020-03-26","objectID":"/posts/csdnvisiter/:0:0","tags":["Python"],"title":"ä½¿ç”¨ Python åˆ· csdn è®¿é—®é‡","uri":"/posts/csdnvisiter/"},{"categories":["OS"],"content":"åŸºæœ¬è¯­æ³• \u003cç§’\u003e \u003cåˆ†é’Ÿ\u003e \u003cå°æ—¶\u003e \u003cæ—¥æœŸ day-of-month\u003e \u003cæœˆä»½\u003e \u003cæ˜ŸæœŸ day-of-week\u003e Cron è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå…·æœ‰æ—¶é—´å«ä¹‰çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä»¥ 5 ä¸ªç©ºæ ¼éš”å¼€ï¼Œåˆ†ä¸º 6 ä¸ªåŸŸï¼Œæ ¼å¼ä¸º X X X X X Xã€‚å…¶ä¸­ X æ˜¯ä¸€ä¸ªåŸŸçš„å ä½ç¬¦ã€‚å•ä¸ªåŸŸæœ‰å¤šä¸ªå–å€¼æ—¶ï¼Œä½¿ç”¨åŠè§’é€—å·ï¼Œéš”å¼€å–å€¼ã€‚æ¯ä¸ªåŸŸå¯ä»¥æ˜¯ç¡®å®šçš„å–å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å…·æœ‰é€»è¾‘æ„ä¹‰çš„ç‰¹æ®Šå­—ç¬¦ã€‚ ","date":"2020-03-25","objectID":"/posts/cron/:1:0","tags":["linux","shell","Cron"],"title":"Cron è¡¨è¾¾å¼çš„åŸºæœ¬è¯­æ³•","uri":"/posts/cron/"},{"categories":["OS"],"content":"åŸŸå–å€¼ ä½ç½® å­—æ®µ çº¦æŸ å–å€¼ å¯ä½¿ç”¨çš„ç‰¹æ®Šç¬¦å· 1 ç§’ å¿…é¡» 0-59 , - * / 2 åˆ†é’Ÿ å¿…é¡» 0-59 , - * / 3 å°æ—¶ å¿…é¡» 0-23ï¼ˆ0 ä¸ºåˆå¤œï¼‰ , - * / 4 æ—¥æœŸ å¿…é¡» 1-31 , - * ? / L W 5 æœˆä»½ å¿…é¡» 1-12 æˆ–è€… JAN-DEC , - * / 6 æ˜ŸæœŸ å¿…é¡» 1-7 æˆ–è€… SUN-SAT (1 ä»£è¡¨æ˜ŸæœŸä¸€ï¼‰ , - ? / L # ","date":"2020-03-25","objectID":"/posts/cron/:2:0","tags":["linux","shell","Cron"],"title":"Cron è¡¨è¾¾å¼çš„åŸºæœ¬è¯­æ³•","uri":"/posts/cron/"},{"categories":["OS"],"content":"ç‰¹æ®Šç¬¦å· ç¬¦å· å«ä¹‰ ç¤ºä¾‹ * æ‰€æœ‰å¯èƒ½çš„å€¼ã€‚ åœ¨æœˆåŸŸä¸­ï¼Œ*è¡¨ç¤ºæ¯ä¸ªæœˆï¼›åœ¨æ˜ŸæœŸåŸŸä¸­ï¼Œ*è¡¨ç¤ºæ˜ŸæœŸçš„æ¯ä¸€å¤©ã€‚ , åˆ—å‡ºæšä¸¾å€¼ã€‚ åœ¨åˆ†é’ŸåŸŸä¸­ï¼Œ5,20è¡¨ç¤ºåˆ†åˆ«åœ¨ 5 åˆ†é’Ÿå’Œ 20 åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‚ - èŒƒå›´ã€‚ åœ¨åˆ†é’ŸåŸŸä¸­ï¼Œ5-20è¡¨ç¤ºä» 5 åˆ†é’Ÿåˆ° 20 åˆ†é’Ÿä¹‹é—´æ¯éš”ä¸€åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‚ / æŒ‡å®šæ•°å€¼çš„å¢é‡ã€‚ åœ¨åˆ†é’ŸåŸŸä¸­ï¼Œ0/15è¡¨ç¤ºä»ç¬¬ 0 åˆ†é’Ÿå¼€å§‹ï¼Œæ¯ 15 åˆ†é’Ÿã€‚åœ¨åˆ†é’ŸåŸŸä¸­3/20è¡¨ç¤ºä»ç¬¬ 3 åˆ†é’Ÿå¼€å§‹ï¼Œæ¯ 20 åˆ†é’Ÿã€‚*/ å’Œ 0/ ç›¸åŒ ? ä¸æŒ‡å®šå€¼ï¼Œä»…æ—¥æœŸå’Œæ˜ŸæœŸåŸŸæ”¯æŒè¯¥å­—ç¬¦ã€‚ å½“æ—¥æœŸæˆ–æ˜ŸæœŸåŸŸå…¶ä¸­ä¹‹ä¸€è¢«æŒ‡å®šäº†å€¼ä»¥åï¼Œä¸ºäº†é¿å…å†²çªï¼Œéœ€è¦å°†å¦ä¸€ä¸ªåŸŸçš„å€¼è®¾ä¸º?ã€‚ L å•è¯ Last çš„é¦–å­—æ¯ï¼Œè¡¨ç¤ºæœ€åä¸€å¤©ï¼Œä»…æ—¥æœŸå’Œæ˜ŸæœŸåŸŸæ”¯æŒè¯¥å­—ç¬¦ã€‚è¯´æ˜ æŒ‡å®šLå­—ç¬¦æ—¶ï¼Œé¿å…æŒ‡å®šåˆ—è¡¨æˆ–è€…èŒƒå›´ï¼Œå¦åˆ™ï¼Œä¼šå¯¼è‡´é€»è¾‘é—®é¢˜ã€‚ åœ¨æ—¥æœŸåŸŸä¸­ï¼ŒLè¡¨ç¤ºæŸä¸ªæœˆçš„æœ€åä¸€å¤©ã€‚åœ¨æ˜ŸæœŸåŸŸä¸­ï¼ŒLè¡¨ç¤ºä¸€ä¸ªæ˜ŸæœŸçš„æœ€åä¸€å¤©ï¼Œä¹Ÿå°±æ˜¯æ˜ŸæœŸæ—¥ï¼ˆSUNï¼‰ã€‚å¦‚æœåœ¨Lå‰æœ‰å…·ä½“çš„å†…å®¹ï¼Œä¾‹å¦‚ï¼Œåœ¨æ˜ŸæœŸåŸŸä¸­çš„6Lè¡¨ç¤ºè¿™ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸå…­ã€‚ W é™¤å‘¨æœ«ä»¥å¤–çš„æœ‰æ•ˆå·¥ä½œæ—¥ï¼Œåœ¨ç¦»æŒ‡å®šæ—¥æœŸçš„æœ€è¿‘çš„æœ‰æ•ˆå·¥ä½œæ—¥è§¦å‘äº‹ä»¶ã€‚Wå­—ç¬¦å¯»æ‰¾æœ€è¿‘æœ‰æ•ˆå·¥ä½œæ—¥æ—¶ä¸ä¼šè·¨è¿‡å½“å‰æœˆä»½ï¼Œè¿ç”¨å­—ç¬¦LWæ—¶è¡¨ç¤ºä¸ºæŒ‡å®šæœˆä»½çš„æœ€åä¸€ä¸ªå·¥ä½œæ—¥ã€‚ åœ¨æ—¥æœŸåŸŸä¸­5Wï¼Œå¦‚æœ 5 æ—¥æ˜¯æ˜ŸæœŸå…­ï¼Œåˆ™å°†åœ¨æœ€è¿‘çš„å·¥ä½œæ—¥æ˜ŸæœŸäº”ï¼Œå³ 4 æ—¥è§¦å‘ã€‚å¦‚æœ 5 æ—¥æ˜¯æ˜ŸæœŸå¤©ï¼Œåˆ™å°†åœ¨æœ€è¿‘çš„å·¥ä½œæ—¥æ˜ŸæœŸä¸€ï¼Œå³ 6 æ—¥è§¦å‘ï¼›å¦‚æœ 5 æ—¥åœ¨æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸäº”ä¸­çš„ä¸€å¤©ï¼Œåˆ™å°±åœ¨ 5 æ—¥è§¦å‘ã€‚ # ç¡®å®šæ¯ä¸ªæœˆç¬¬å‡ ä¸ªæ˜ŸæœŸå‡ ï¼Œä»…æ˜ŸæœŸåŸŸæ”¯æŒè¯¥å­—ç¬¦ã€‚ åœ¨æ˜ŸæœŸåŸŸä¸­ï¼Œ4#2è¡¨ç¤ºæŸæœˆçš„ç¬¬äºŒä¸ªæ˜ŸæœŸå››ã€‚ ","date":"2020-03-25","objectID":"/posts/cron/:3:0","tags":["linux","shell","Cron"],"title":"Cron è¡¨è¾¾å¼çš„åŸºæœ¬è¯­æ³•","uri":"/posts/cron/"},{"categories":["OS"],"content":"ä¸¾ä¸ªæ —å­ ğŸŒ° è¡¨è¾¾å¼ è¯´æ˜ 0 0/5 * * * ? æ¯éš” 5 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ 10 0/5 * * * ? æ¯éš” 5 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæ¯æ¬¡æ‰§è¡Œéƒ½åœ¨åˆ†é’Ÿå¼€å§‹çš„ 10 ç§’ï¼Œä¾‹å¦‚ 10:00:10ã€10:05:10 ç­‰ç­‰ã€‚ 0 30 10-13 ? * WED,FRI æ¯å‘¨ä¸‰å’Œæ¯å‘¨äº”çš„ 10:30ã€11:30ã€12:30ã€13:30 æ‰§è¡Œã€‚ 0 0/30 8-9 5,20 * ? æ¯ä¸ªæœˆçš„ 5 å·å’Œ 20 å·çš„ 8 ç‚¹å’Œ 10 ç‚¹ä¹‹é—´æ¯éš” 30 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯ 8:00ã€8:30ã€9:00 å’Œ 9:30ã€‚ 0 15 10 ? * * æ¯å¤©ä¸Šåˆ 10:15 æ‰§è¡Œä»»åŠ¡ 0 15 10 * * ? æ¯å¤©ä¸Šåˆ 10:15 æ‰§è¡Œä»»åŠ¡ 0 0 12 * * ? æ¯å¤©ä¸­åˆ 12:00 æ‰§è¡Œä»»åŠ¡ 0 0 10,14,16 * * ? æ¯å¤©ä¸Šåˆ 10:00 ç‚¹ã€ä¸‹åˆ 14:00 ä»¥åŠä¸‹åˆ 16:00 æ‰§è¡Œä»»åŠ¡ 0 0/30 9-17 * * ? æ¯å¤©ä¸Šåˆ 09:00 åˆ°ä¸‹åˆ 17:00 æ—¶é—´æ®µå†…æ¯éš”åŠå°æ—¶æ‰§è¡Œä»»åŠ¡ 0 * 14 * * ? æ¯å¤©ä¸‹åˆ 14:00 åˆ°ä¸‹åˆ 14:59 æ—¶é—´æ®µå†…æ¯éš” 1 åˆ†é’Ÿæ‰§è¡Œä»»åŠ¡ 0 0-5 14 * * ? æ¯å¤©ä¸‹åˆ 14:00 åˆ°ä¸‹åˆ 14:05 æ—¶é—´æ®µå†…æ¯éš” 1 åˆ†é’Ÿæ‰§è¡Œä»»åŠ¡ 0 0/5 14 * * ? æ¯å¤©ä¸‹åˆ 14:00 åˆ°ä¸‹åˆ 14:55 æ—¶é—´æ®µå†…æ¯éš” 5 åˆ†é’Ÿæ‰§è¡Œä»»åŠ¡ 0 0/5 14,18 * * ? æ¯å¤©ä¸‹åˆ 14:00 åˆ°ä¸‹åˆ 14:55ã€ä¸‹åˆ 18:00 åˆ°ä¸‹åˆ 18:55 æ—¶é—´æ®µå†…æ¯éš” 5 åˆ†é’Ÿæ‰§è¡Œä»»åŠ¡ 0 0 12 ? * WED æ¯ä¸ªæ˜ŸæœŸä¸‰ä¸­åˆ 12:00 æ‰§è¡Œä»»åŠ¡ 0 15 10 15 * ? æ¯æœˆ 15 æ—¥ä¸Šåˆ 10:15 æ‰§è¡Œä»»åŠ¡ 0 15 10 L * ? æ¯æœˆæœ€åä¸€æ—¥ä¸Šåˆ 10:15 æ‰§è¡Œä»»åŠ¡ 0 15 10 ? * 6L æ¯æœˆæœ€åä¸€ä¸ªæ˜ŸæœŸå…­ä¸Šåˆ 10:15 æ‰§è¡Œä»»åŠ¡ 0 15 10 ? * 6#3 æ¯æœˆç¬¬ä¸‰ä¸ªæ˜ŸæœŸå…­ä¸Šåˆ 10:15 æ‰§è¡Œä»»åŠ¡ 0 10,44 14 ? 3 WED æ¯å¹´ 3 æœˆçš„æ¯ä¸ªæ˜ŸæœŸä¸‰ä¸‹åˆ 14:10 å’Œ 14:44 æ‰§è¡Œä»»åŠ¡ ","date":"2020-03-25","objectID":"/posts/cron/:4:0","tags":["linux","shell","Cron"],"title":"Cron è¡¨è¾¾å¼çš„åŸºæœ¬è¯­æ³•","uri":"/posts/cron/"},{"categories":["çæŠ˜è…¾","Python"],"content":" ä¿¡æ¯ è¿™ä»¶äº‹è¿˜å¾—ä»ä¸€åªè™è è¯´èµ· â€¦ ç®—äº†ï¼Œæ˜¨å¤©ä¸‹åˆ 3 ç‚¹åŠï¼Œæˆ‘è¿˜åœ¨ç‹è€…å³¡è°· Timing, çªç„¶æ½‡ X å·´å“¥æ‰“äº†ä¸ªç”µè¯ç»™æˆ‘è¯´å…³äºè‡ªåŠ¨æ‰“å¡çš„æƒ³æ³• â€¦ å“ï¼Œåæ­£å°±æ˜¯ç”±äºç–«æƒ…éœ€è¦æ¯å¤©å¥åº·æ‰“å¡æ±‡æŠ¥ç»™å­¦æ ¡ï¼Œç„¶åæ¯å¤©æäº¤ä¸€æ ·çš„å¤ªéº»çƒ¦äº†ï¼Œå°±æƒ³å†™ä¸ªç¨‹åºè‡ªåŠ¨æ‰“å¡ â€¦ æˆ‘å’Œæ½‡ X å·´å“¥ç¡®å®šæ€è·¯åå…µåˆ†ä¸¤è·¯ï¼š ä»–ç”¨ java å†™ä¸ªåå°è‡ªåŠ¨åˆ·å¤šäººçš„ï¼Œå†å¼„ä¸ªç½‘é¡µç»™ç”¨æˆ·å¡«å†™è´¦å·å¯†ç ä¿å­˜åœ¨æ•°æ®åº“ï¼› æˆ‘æƒ³çš„å°±å¾ˆç›´æ¥ï¼Œåªåˆ·ä¸€ä¸ªäººçš„ï¼Œpython æ¨¡æ‹Ÿæµè§ˆå™¨ç™»å½•åæ‰“å¡ï¼Œå†è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼ˆå¤šäººåˆ™è®¾å®šå¤šä¸ªï¼‰ï¼› ","date":"2020-03-25","objectID":"/posts/daka/:0:0","tags":["Python","HTTP"],"title":"æ–°å† ç–«æƒ…æœªè¿”æ ¡æœªè¿”å·¥ç¬¬ N å¤©ä¹‹â€œè‡ªåŠ¨æ‰“å¡â€","uri":"/posts/daka/"},{"categories":["çæŠ˜è…¾","Python"],"content":"Windows è¿è¡Œæ•ˆæœ æ‰“å¡æˆåŠŸ é‡å¤æ‰“å¡ å®šæ—¶ä»»åŠ¡æ—¥å¿— ","date":"2020-03-25","objectID":"/posts/daka/:1:0","tags":["Python","HTTP"],"title":"æ–°å† ç–«æƒ…æœªè¿”æ ¡æœªè¿”å·¥ç¬¬ N å¤©ä¹‹â€œè‡ªåŠ¨æ‰“å¡â€","uri":"/posts/daka/"},{"categories":["çæŠ˜è…¾","Python"],"content":"æ ¸å¿ƒä»£ç  é€‚ç”¨æ¹–å—å·¥ç¨‹å­¦é™¢çš„æ‰“å¡ç³»ç»Ÿã€‚ è¯·å‹¿æ»¥ç”¨ä»£ç æäº¤ä¸å®å¥åº·ä¿¡æ¯ï¼Œéšç’ç–«æƒ…å°†å—åˆ°ç›¸å…³æ³•å¾‹å¤„ç†ï¼ å®Œæ•´ä»£ç  def lajaDaka(): # ç™»å½• r1 = requests.post(login_url, data=login,headers=headers,verify=False) if r1.status_code == 200: print(time.strftime(\"%Y:%m:%d:%H:%M\", time.localtime())) print(login[\"username\"] + \" ç™»å½•æˆåŠŸï¼\") # æ‹¿åˆ°ç™»å½•åçš„ cookie å¹¶æ·»åŠ åˆ° header ä¸­ header1 = r1.headers headers[\"Cookie\"] = header1[\"Set-Cookie\"] else: return # æ‰“å¡ r2 = requests.post(daka_url, data=daka,headers=headers,verify=False) response2=r2.json() if r2.status_code != 200: print(\"æ‰“å¡å¤±è´¥ï¼\") return if response2[\"result\"] == True: print(\"æ‰“å¡æˆåŠŸï¼\") else: print(response2[\"errorInfoList\"][0][\"message\"]) if __name__==\"__main__\": lajaDaka() ","date":"2020-03-25","objectID":"/posts/daka/:2:0","tags":["Python","HTTP"],"title":"æ–°å† ç–«æƒ…æœªè¿”æ ¡æœªè¿”å·¥ç¬¬ N å¤©ä¹‹â€œè‡ªåŠ¨æ‰“å¡â€","uri":"/posts/daka/"},{"categories":["çæŠ˜è…¾","Python"],"content":"è‡ªåŠ¨è¿è¡Œ ","date":"2020-03-25","objectID":"/posts/daka/:3:0","tags":["Python","HTTP"],"title":"æ–°å† ç–«æƒ…æœªè¿”æ ¡æœªè¿”å·¥ç¬¬ N å¤©ä¹‹â€œè‡ªåŠ¨æ‰“å¡â€","uri":"/posts/daka/"},{"categories":["çæŠ˜è…¾","Python"],"content":"Windows é€‚ç”¨ python ä»£ç æ§åˆ¶ä¼‘çœ æ—¶é—´ if __name__==\"__main__\": while True: now_hour = time.strftime(\"%H\", time.localtime()) now_min = time.strftime(\"%M\", time.localtime()) # è®¾ç½®æ¯å¤© 8 ç‚¹å‘é€ if now_hour \u003c \"08\": rest = 8 - int(now_hour) sleeptime = (rest-1)*3600 + (60-int(now_min))*60 print(\"å¯åŠ¨æ—¶åŒ—äº¬æ—¶é—´ä¸ºï¼š\"+time.strftime(\"%H:%M\", time.localtime()),\"\\t è„šæœ¬å°†åœ¨\",rest-1,\"å°æ—¶\",int((sleeptime-(rest-1)*3600)/60),\"åˆ†é’Ÿåæ‰“å¡\") time.sleep(sleeptime) elif now_hour \u003e \"08\": rest = 8 - int(now_hour) + 24 sleeptime = (rest-1)*3600 + (60-int(now_min))*60 print(\"å¯åŠ¨æ—¶åŒ—äº¬æ—¶é—´ä¸ºï¼š\"+time.strftime(\"%H:%M\", time.localtime()),\"\\t è„šæœ¬å°†åœ¨\",rest-1,\"å°æ—¶\",int((sleeptime-(rest-1)*3600)/60),\"åˆ†é’Ÿåæ‰“å¡\") time.sleep(sleeptime) elif now_hour == \"08\": print(\"è½¯ä»¶æ˜å¤©å¼€å§‹å°†åœ¨æ¯å¤© 8 ç‚¹å‘é€æ•°æ®ï¼\") lajaDaka() time.sleep(24*60*60-int(now_min)*60) ","date":"2020-03-25","objectID":"/posts/daka/:3:1","tags":["Python","HTTP"],"title":"æ–°å† ç–«æƒ…æœªè¿”æ ¡æœªè¿”å·¥ç¬¬ N å¤©ä¹‹â€œè‡ªåŠ¨æ‰“å¡â€","uri":"/posts/daka/"},{"categories":["çæŠ˜è…¾","Python"],"content":"linuxï¼ˆäº‘æœåŠ¡å™¨ï¼‰ æ­å»º python ç¯å¢ƒä¸‹è½½ä¾èµ–åï¼Œä½¿ç”¨ shell è„šæœ¬å®šæ—¶æ‰§è¡Œã€‚ python /home/python/yiban_daka/daka.py CRON è¡¨è¾¾å¼çš„åŸºæœ¬è¯­æ³• ","date":"2020-03-25","objectID":"/posts/daka/:3:2","tags":["Python","HTTP"],"title":"æ–°å† ç–«æƒ…æœªè¿”æ ¡æœªè¿”å·¥ç¬¬ N å¤©ä¹‹â€œè‡ªåŠ¨æ‰“å¡â€","uri":"/posts/daka/"},{"categories":["çæŠ˜è…¾","Python"],"content":"æ½‡ x å·´å“¥çš„ java web ç‰ˆæœ¬ ç¬¦åˆç¨‹åºå‘˜çš„åº”è¯¥æœ‰çš„ç®€æ´å’Œæ–¹ä¾¿ï¼Œå¹²å‡€åˆå«ç”Ÿï¼ http://39.105.174.214/index.html java web ç‰ˆ ","date":"2020-03-25","objectID":"/posts/daka/:4:0","tags":["Python","HTTP"],"title":"æ–°å† ç–«æƒ…æœªè¿”æ ¡æœªè¿”å·¥ç¬¬ N å¤©ä¹‹â€œè‡ªåŠ¨æ‰“å¡â€","uri":"/posts/daka/"},{"categories":["MySQL"],"content":" SQL å¢åˆ æ”¹æŸ¥ (CRUD) è¯­å¥ä¸å¸¸ç”¨å‡½æ•°æ€»ç»“ã€‚ ","date":"2020-01-16","objectID":"/posts/sql/:0:0","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"SQL Introduction ä¸€èˆ¬æˆ‘ä»¬å¯¹æ•°æ®åº“çš„æ“ä½œä¸»è¦åˆ†ä¸ºå››ç§ï¼Œå¢** C**(CREATE)ã€åˆ ** D**(DELETE)ã€æ”¹** U**(UPDATE)ã€æŸ¥** R**(READ)ï¼Œæ‰€ä»¥ï¼Œæˆ‘å°±ä»** CRUD **è¿™å››ä¸ªæ–¹é¢æ¥åˆ¶ä½œæŸ¥è¯¢è¡¨ã€‚ å¼€å‘è§„åˆ™ï¼š å°½é‡å‡å°‘å¯¹æ•°æ®åº“çš„è®¿é—®æ¬¡æ•°ï¼Œä¸”ä¸èƒ½æŸ¥è¯¢æ— ç”¨çš„æ•°æ®ï¼Œæµªè´¹æ•ˆèƒ½ï¼ˆä¾‹å¦‚ï¼šæˆ‘åªè¦ç”·ç”Ÿçš„æ•°æ®ï¼Œä½ æŠŠæ‰€æœ‰äººçš„æ•°æ®éƒ½æŸ¥è¯¢å‡ºæ¥ï¼‰ã€‚ å±äºSQLè¯­æ³•çš„è¦ä½¿ç”¨å¤§å†™ ï¼ˆSELECT, WHERE, INSERT etcâ€¦ï¼‰ã€‚ å±äºä½¿ç”¨è€…è‡ªå·±å®šä¹‰çš„è¦ä½¿ç”¨å°å†™ï¼ˆè¡¨åã€åˆ—å etcâ€¦ï¼‰ã€‚ è¡¨åä¸åˆ—åå‰åä½¿ç”¨ ` åŒ…èµ·æ¥ï¼Œé˜²æ­¢ä¸å…³é”®å­—å†²çªï¼ˆä¾‹å¦‚ï¼š INSERT INTO `user` VALUES(â€˜aâ€™,â€˜bâ€™); ï¼‰ã€‚ ç¦æ­¢ä½¿ç”¨ Table Joinã€‚ ç¦æ­¢ä½¿ç”¨ Oracle Triggerã€‚ ç¦æ­¢ä½¿ç”¨ SELECT * ï¼ˆä¸ºäº†åŠ å¼ºä»£ç å¯è¯»æ€§ï¼‰ã€‚ ä¸èƒ½å°†æŸ¥è¯¢æ•°æ®åº“çš„ SQL æ”¾åœ¨å¾ªç¯ä¸­æŸ¥è¯¢ã€‚ ","date":"2020-01-16","objectID":"/posts/sql/:1:0","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"æ–°å¢ï¼ˆCREATEï¼‰ åŠŸèƒ½ è¯­å¥ åˆ›å»ºæ•°æ®åº“ CREATE DATABASE \u003cæ•°æ®åº“å\u003e; åˆ›å»ºæ•°æ®è¡¨ CREATE TABLE \u003cè¡¨å\u003e (\u003cåˆ—å 1\u003e \u003cæ•°æ®ç±»å‹\u003e \u003cçº¦æŸæ¡ä»¶\u003e,\u003cåˆ—å 2\u003e \u003cæ•°æ®ç±»å‹\u003e \u003cçº¦æŸæ¡ä»¶\u003e,\u003cåˆ—å 3\u003e \u003cæ•°æ®ç±»å‹\u003e \u003cçº¦æŸæ¡ä»¶\u003e,......\u003cè¯¥è¡¨çš„çš„çº¦æŸæ¡ä»¶ 1\u003e \u003cè¯¥è¡¨çš„çš„çº¦æŸæ¡ä»¶ 2\u003e...); æ’å…¥æ•°æ® INSERT INTO \u003cè¡¨å\u003e ï¼ˆåˆ—å 1, åˆ—å 2,...) VALUES ï¼ˆå€¼ 1, å€¼ 2,...);ï¼ˆæ¯åˆ—éƒ½æœ‰æ•°æ®æ’å…¥æ—¶ï¼Œå¯çœç•¥åˆ—åã€‚ä½†æ˜¯ä¸ºäº†ä»£ç çš„å¯è¯»æ€§ï¼Œä¸å»ºè®®å¦‚æ­¤æ“ä½œã€‚ï¼‰ å¢åŠ åˆ— ALTER TABLE \u003cè¡¨å\u003e ADD \u003cåˆ—å\u003e \u003cæ•°æ®ç±»å‹\u003e \u003cçº¦æŸæ¡ä»¶\u003e AFTER \u003cå‰ä¸€åˆ—åˆ—å\u003e;ï¼ˆé»˜è®¤æ’å…¥åˆ°æœ€åä¸€åˆ—ï¼‰ ","date":"2020-01-16","objectID":"/posts/sql/:2:0","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"åˆ é™¤ï¼ˆDELETEï¼‰ åŠŸèƒ½ è¯­å¥ åˆ é™¤æ•°æ®åº“ DROP DATABASE \u003cæ•°æ®åº“å\u003e; åˆ é™¤æ•°æ®è¡¨ DROP TABLE \u003cè¡¨å\u003e; æ¸…ç©ºè¡¨æ•°æ® DELETE FROM \u003cè¡¨å\u003e; æˆ–è€… TRUNCATE TABLE \u003cè¡¨å\u003e; åˆ é™¤è¡Œæ•°æ® DELETE FROM \u003cè¡¨å\u003e WHERE \u003cæ¡ä»¶\u003e; åˆ é™¤åˆ—æ•°æ® ALTER TABLE \u003cè¡¨å\u003e DROP \u003cåˆ—å\u003e; ","date":"2020-01-16","objectID":"/posts/sql/:3:0","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"ä¿®æ”¹ï¼ˆUPDATEï¼‰ åŠŸèƒ½ è¯­å¥ ä¿®æ”¹æ•°æ®åº“å RENAME DATABASE \u003cæ—§åç§°\u003e TO \u003cæ–°åç§°\u003e; ä¿®æ”¹è¡¨å RENAME TABLE \u003cæ—§åç§°\u003e TO \u003cæ–°åç§°\u003e; ä¿®æ”¹æ•°æ® UPDATE \u003cè¡¨å\u003e SET \u003cåˆ—å 1\u003e = \u003cæ–°å€¼ 1\u003e,\u003cåˆ—å 2\u003e = \u003cæ–°å€¼ 2\u003e WHERE \u003cæ¡ä»¶\u003e; ä¿®æ”¹åˆ—å ALTER TABLE \u003cè¡¨å\u003e CHANGE \u003cæ—§åˆ—å\u003e \u003cæ–°åˆ—å\u003e \u003cæ•°æ®ç±»å‹\u003e \u003cçº¦æŸæ¡ä»¶\u003e; æ³¨æ„ï¼šé‡å‘½åæ•°æ®åº“ä¸æ•°æ®è¡¨ä¸€èˆ¬ä¸æ¨èä½¿ç”¨ï¼Œè‹¥æƒ³æµ‹è¯•ï¼Œè¯·å…ˆå¤‡ä»½å¥½è‡ªå·±çš„æ•°æ®åº“~ ","date":"2020-01-16","objectID":"/posts/sql/:4:0","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"æŸ¥è¯¢ï¼ˆÂ RÂ EÂ AÂ DÂ ï¼‰ åŠŸèƒ½ è¯­å¥ æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“ SHOW DATABASES; æŸ¥è¯¢æŒ‡å®šæ•°æ®åº“ä¸­æ‰€æœ‰è¡¨å USE \u003cæ•°æ®åº“å\u003e; ç„¶å SHOW TABLES;æˆ–è€… SHOW TABLES FROM \u003cæ•°æ®åº“å\u003e; æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰åˆ—ä¿¡æ¯ SHOW COLUMNS FROM \u003cè¡¨å\u003e; æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰æ•°æ® SELECT \u003cåˆ—å 1\u003e,\u003cåˆ—å 2\u003e,\u003cåˆ—å 3\u003e,... FROM \u003cè¡¨å\u003e; æŸ¥è¯¢è¡¨ä¸­æŸä¸ªæ•°æ® SELECT \u003cåˆ—å\u003e FROM \u003cè¡¨å\u003e; æŸ¥è¯¢è¡¨ä¸­æŒ‡å®šå¤šä¸ªæ•°æ® SELECT \u003cåˆ—å 1\u003e,\u003cåˆ—å 2\u003e,\u003cåˆ—å 3\u003e,... FROM \u003cè¡¨å\u003e WHERE \u003cæ¡ä»¶\u003e; æŸ¥è¯¢è¡¨ä¸­æŒ‡å®šä¸€ä¸ªæ•°æ® SELECT \u003cåˆ—å\u003e FROM \u003cè¡¨å\u003e WHERE \u003cæ¡ä»¶\u003e; æŸ¥è¯¢æŒ‡å®šèŒƒå›´æ•°æ® SELECT \u003cåˆ—å 1\u003e,\u003cåˆ—å 2\u003e,\u003cåˆ—å 3\u003e,... FROM \u003cè¡¨å\u003e WHERE \u003cæŸåˆ—å\u003e BETWEEN \u003cæŸåˆ—åèŒƒå›´å€¼-å°\u003e AND \u003cæŸåˆ—åèŒƒå›´å€¼-å¤§\u003e; å­—ç¬¦ä¸²æ¨¡å¼åŒ¹é…æŸ¥è¯¢ SELECT \u003cåˆ—å\u003e FROM \u003cè¡¨å\u003e WHERE name LIKE 'Y%';ï¼ˆæŸ¥è¯¢ä»¥ Y å¼€å¤´çš„ï¼Œæ›´å¤šåŒ¹é…æ–¹å¼è‡ªè¡Œç™¾åº¦å“¦~ã€‚ï¼‰ æŒ‡å®šå¤šä¸ªå€¼æ•°æ®æŸ¥è¯¢ SELECT \u003cåˆ—å 1\u003e,\u003cåˆ—å 2\u003e,\u003cåˆ—å 3\u003e,... FROM \u003cè¡¨å\u003e WHERE \u003cæŸåˆ—å\u003e IN ('\u003cæŸåˆ—åå€¼ 1\u003e','\u003cæŸåˆ—åå€¼ 2\u003e','\u003cæŸåˆ—åå€¼ 3\u003e',...); æŸ¥è¯¢ç»“æœæ’åº SELECT \u003cåˆ—å 1\u003e,\u003cåˆ—å 2\u003e,\u003cåˆ—å 3\u003e,... FROM \u003cè¡¨å\u003e ORDER BY \u003cæŸåˆ—å\u003e DESC;ï¼ˆæ­¤å¤„ä¸ºé€’å‡æ’åˆ—ï¼Œé»˜è®¤ä¸ºé€’å¢ASCï¼‰ æŸ¥è¯¢æŒ‡å®šå‡ ç¬”æ•°æ® SELECT \u003cåˆ—å 1\u003e,\u003cåˆ—å 2\u003e,\u003cåˆ—å 3\u003e,... FROM \u003cè¡¨å\u003e LIMIT n,m;ï¼ˆä»nåˆ°mç¬”æ•°æ®ï¼‰ åˆ†ç¾¤æŸ¥è¯¢ SELECT \u003cåˆ—å 1\u003e,\u003cåˆ—å 2\u003e,\u003cåˆ—å 3\u003e,...,\u003cå‡½æ•°\u003e FROM \u003cè¡¨å\u003e GROUP BY \u003cåˆ—å 1\u003e,\u003cåˆ—å 2\u003e,\u003cåˆ—å 3\u003e,...;ï¼ˆå¸¸æ­é…å‡½æ•°æœ‰ï¼šSUM()ã€AVG()ã€COUNT()ã€MAX()ã€MIN()ï¼‰ ","date":"2020-01-16","objectID":"/posts/sql/:5:0","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"å¸¸ç”¨å‡½æ•° å‡½æ•°å ç”¨é€” ABSï¼ˆæ•°å€¼ï¼‰ ABS å‡½æ•°ï¼ˆæ±‚ç»å¯¹å€¼ï¼‰ MODï¼ˆè¢«é™¤æ•°ï¼Œé™¤æ•°ï¼‰ MOD å‡½æ•°ï¼ˆæ±‚ä½™ï¼‰ ROUNDï¼ˆå¯¹è±¡æ•°å€¼ï¼Œä¿ç•™å°æ•°çš„ä½æ•°ï¼‰ ROUND å‡½æ•°ï¼ˆå››èˆäº”å…¥ï¼‰ å­—ç¬¦ä¸² 1 Î™Î™ å­—ç¬¦ä¸² 2 Î™Î™ å‡½æ•°ï¼ˆæ‹¼æ¥ï¼‰ LENGTHï¼ˆå­—ç¬¦ä¸²ï¼‰ LENGTH å‡½æ•°ï¼ˆæ±‚å­—ç¬¦ä¸²é•¿åº¦ï¼‰ LOWERï¼ˆå­—ç¬¦ä¸²ï¼‰ LOWER å‡½æ•°ï¼ˆå°å†™è½¬æ¢ï¼‰ UPPERï¼ˆå­—ç¬¦ä¸²ï¼‰ UPPER å‡½æ•°ï¼ˆå¤§å†™è½¬æ¢ï¼‰ REPLACEï¼ˆå¯¹è±¡å­—ç¬¦ä¸²ï¼Œæ›¿æ¢å‰çš„å­—ç¬¦ä¸²ï¼Œæ›¿æ¢åçš„å­—ç¬¦ä¸²ï¼‰ REPLACE å‡½æ•°ï¼ˆå­—ç¬¦ä¸²çš„æ›¿æ¢ï¼‰ SUBSTRING ï¼ˆå¯¹è±¡å­—ç¬¦ä¸²ï¼Œæˆªå–çš„èµ·å§‹ä½ç½®ï¼Œæˆªå–çš„å­—ç¬¦æ•°ï¼‰ SUBSTRING å‡½æ•°ï¼ˆå­—ç¬¦ä¸²çš„æˆªå–ï¼‰ CURRENT_DATE CURRENT_DATE å‡½æ•°ï¼ˆå½“å‰æ—¥æœŸï¼‰ CURRENT_TIME CURRENT_TIME å‡½æ•°ï¼ˆå½“å‰æ—¶é—´ï¼‰ CURRENT_TIMESTAMP CURRENT_TIMESTAMP å‡½æ•°ï¼ˆå½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼‰ EXTRACTï¼ˆæ—¥æœŸå…ƒç´  FROM æ—¥æœŸï¼‰ EXTRACT å‡½æ•°ï¼ˆæˆªå–æ—¥æœŸå…ƒç´ ï¼‰ CASTï¼ˆè½¬æ¢å‰çš„å€¼ AS æƒ³è¦è½¬æ¢çš„æ•°æ®ç±»å‹ï¼‰ CAST å‡½æ•°ï¼ˆç±»å‹è½¬æ¢ï¼‰ COALESCEï¼ˆæ•°æ® 1, æ•°æ® 2, æ•°æ® 3â€¦.) COALESCE å‡½æ•°ï¼ˆå°† NULL è½¬æ¢ä¸ºå…¶ä»–å€¼ï¼‰ è¡¥å……ï¼šCASE è¡¨è¾¾å¼ã€‚ CASE WHEN \u003cæ±‚å€¼è¡¨è¾¾å¼\u003e THEN \u003cè¡¨è¾¾å¼\u003e WHEN \u003cæ±‚å€¼è¡¨è¾¾å¼\u003e THEN \u003cè¡¨è¾¾å¼\u003e WHEN \u003cæ±‚å€¼è¡¨è¾¾å¼\u003e THEN \u003cè¡¨è¾¾å¼\u003e ...... ELSE \u003cè¡¨è¾¾å¼\u003e END ","date":"2020-01-16","objectID":"/posts/sql/:6:0","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"å…¶ä»–çŸ¥è¯† ","date":"2020-01-16","objectID":"/posts/sql/:7:0","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"å¸¸è§æ•°æ®ç±»å‹ ","date":"2020-01-16","objectID":"/posts/sql/:7:1","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"åˆ«å ç»™è¡¨è®¾ç½®åˆ«åï¼Œè®© SQL æ›´ç®€æ´ã€‚ä¾‹å¦‚ï¼š SELECT \u003ccol-1\u003e,\u003ccol-2\u003e,\u003ccol-3\u003e,... FROM \u003ctable1\u003e \u003calias-a\u003e,\u003ctable2\u003e \u003calias-b\u003e WHERE \u003calias-a\u003e.\u003cid\u003e = \u003calias-b\u003e.\u003cid\u003e; åˆ—åä¹Ÿå¯ä»¥è®¾ç½®åˆ«åã€‚ä¾‹å¦‚ï¼š SELECT \u003ccol-1\u003e \u003calias-a\u003e,\u003ccol-2\u003e \u003calias-b\u003e,\u003ccol-3\u003e \u003calias-c\u003e,... FROM \u003ctable\u003e; æˆ–è€… SELECT \u003ccol-1\u003e AS \u003calias-a\u003e,\u003ccol-2\u003e AS \u003calias-b\u003e,\u003ccol-3\u003e AS \u003calias-c\u003e,... FROM \u003ctable\u003e; ","date":"2020-01-16","objectID":"/posts/sql/:7:2","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["MySQL"],"content":"æ€»ç»“ ä»¥ä¸Šæ•´ç†çš„å†…å®¹å‡ä¸ºåŸºç¡€å†…å®¹ï¼Œæ›´å¤šè¿›é˜¶çŸ¥è¯†è¿˜éœ€å„ä½è‡ªè¡Œ Googleã€‚ ","date":"2020-01-16","objectID":"/posts/sql/:8:0","tags":["MySQL"],"title":"SQL æ€»ç»“","uri":"/posts/sql/"},{"categories":["Projects","JavaScript"],"content":" ä¿¡æ¯ cos æ¡¶ç›¸å†Œï¼Œç»ˆäºï¼ï¼ç»ˆäºæ¥äº†ï¼ï¼ï¼Œidea æ¥è‡ª [å…°å·å°çº¢é¸¡ - ç»™ hexo é™æ€åšå®¢æ·»åŠ åŠ¨æ€ç›¸å†ŒåŠŸèƒ½]ï¼Œ åŠŸèƒ½è™½å¥½ï¼Œä½†æ˜¯è¿˜æ˜¯å…ˆå‹æƒ…æç¤ºï¼ å¼€æ”¾ API æ˜¯ä¸€ä¸ªå¾ˆå±é™©çš„æ“ä½œï¼Œæ„å‘³ç€ä½ çš„ cos æ¡¶é‡Œé¢çš„æ‰€æœ‰èµ„æºåŒ…æ‹¬ç›®å½•ç»“æ„éƒ½æš´éœ²çš„æ•´ä¸ªä¸–ç•Œä¸­ï¼Œæ‰€ä»¥å»ºè®®ä¸è¦æ”¾ä¸€äº›æ¯”è¾ƒç§å¯†çš„ç…§ç‰‡ï¼Œä¿æŠ¤è‡ªå·±çš„éšç§ï¼Œæé˜²ä¸è‰¯ç”¨å¿ƒä¹‹äººã€‚ä¸‹é¢å°±å¼€å§‹å§ï¼ ","date":"2019-11-24","objectID":"/projects/cos-album/:0:0","tags":["CosAlbum","è…¾è®¯äº‘ cos æ¡¶","JavaScript"],"title":"åˆ©ç”¨è…¾è®¯äº‘ä¸ºé™æ€é¡µé¢æ·»åŠ â€œåŠ¨æ€â€ç›¸å†Œ","uri":"/projects/cos-album/"},{"categories":["Projects","JavaScript"],"content":"åˆ›å»ºè…¾è®¯äº‘ cos å­˜å‚¨æ¡¶ å°±åˆ›å»ºä¸€ä¸ª COS å°±å¥½äº†ï¼æœ‰å‡ ç‚¹æ³¨æ„äº‹é¡¹ï¼š æƒé™è®¾ç½®ä¸ºå…±æœ‰è¯»ç§æœ‰å†™ policy æƒé™è®¾ç½®æ•´ä¸ªæ¡¶çš„è¯»æ“ä½œ è·¨åŸŸè®¿é—® CORS è®¾ç½®ï¼Œè‡ªå·±éšæ„ ","date":"2019-11-24","objectID":"/projects/cos-album/:1:0","tags":["CosAlbum","è…¾è®¯äº‘ cos æ¡¶","JavaScript"],"title":"åˆ©ç”¨è…¾è®¯äº‘ä¸ºé™æ€é¡µé¢æ·»åŠ â€œåŠ¨æ€â€ç›¸å†Œ","uri":"/projects/cos-album/"},{"categories":["Projects","JavaScript"],"content":"ä¸Šä¼ ç…§ç‰‡ é¦–å…ˆæˆ‘è¿™ä¸ª cos ç›¸å†Œï¼Œç›¸å†Œåˆ†ç±»å°±æ˜¯æ–‡ä»¶å¤¹åˆ†ç±»ï¼Œæ‰€ä»¥ cos æ¡¶é‡Œé¢å…ˆæ–°å»ºä¸åŒçš„æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹åç§°å°±æ˜¯ç›¸å†Œåç§°ï¼Œ æ¯ä¸ªç›¸å†Œé‡Œé¢éœ€è¦æ”¾ç½®ä¸€å¼ åç§°ä¸º**â€œå°é¢.jpgâ€**çš„å›¾ç‰‡ä½œä¸ºè¯¥ç›¸å†Œçš„å°é¢ã€‚ ","date":"2019-11-24","objectID":"/projects/cos-album/:2:0","tags":["CosAlbum","è…¾è®¯äº‘ cos æ¡¶","JavaScript"],"title":"åˆ©ç”¨è…¾è®¯äº‘ä¸ºé™æ€é¡µé¢æ·»åŠ â€œåŠ¨æ€â€ç›¸å†Œ","uri":"/projects/cos-album/"},{"categories":["Projects","JavaScript"],"content":"ä¸Šä¼ å·¥å…· COSBrowser GUI å·¥å…·ï¼Œæ¡Œé¢/ç§»åŠ¨ç‰ˆ ã€å®˜æ–¹ã€æ¨èã€‘ COSCMD å‘½ä»¤è¡Œå·¥å…· ã€å®˜æ–¹ã€‘ PicGo å›¾åºŠä¸Šä¼ å·¥å…· ã€ç¬¬ä¸‰æ–¹ã€æ¨èã€‘ ","date":"2019-11-24","objectID":"/projects/cos-album/:2:1","tags":["CosAlbum","è…¾è®¯äº‘ cos æ¡¶","JavaScript"],"title":"åˆ©ç”¨è…¾è®¯äº‘ä¸ºé™æ€é¡µé¢æ·»åŠ â€œåŠ¨æ€â€ç›¸å†Œ","uri":"/projects/cos-album/"},{"categories":["Projects","JavaScript"],"content":"é£Ÿç”¨æ–¹å¼ cos album ç›¸å†Œæºç ä¸‹è½½åœ°å€ï¼Œåˆ«å¿˜ç‚¹èµå“ˆ http://github.com/Lruihao/cos-album é¦–å…ˆï¼Œä¸‹è½½æºç ï¼Œå¼•å…¥ cos-album.css å’Œ cos-album.js ç„¶åï¼Œåœ¨ä½ çš„ js ä¸­ new ä¸€ä¸ª Cosalbum å¯¹è±¡ ( xmlLink åä¸éœ€è¦æ·»åŠ /) ","date":"2019-11-24","objectID":"/projects/cos-album/:3:0","tags":["CosAlbum","è…¾è®¯äº‘ cos æ¡¶","JavaScript"],"title":"åˆ©ç”¨è…¾è®¯äº‘ä¸ºé™æ€é¡µé¢æ·»åŠ â€œåŠ¨æ€â€ç›¸å†Œ","uri":"/projects/cos-album/"},{"categories":["Projects","JavaScript"],"content":"Step1 \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"cos-album.min.css?v=1.1.2\"\u003e \u003cscript type=\"text/javascript\" src=\"cos-album.min.js?v=1.1.2\"\u003e\u003c/script\u003e ","date":"2019-11-24","objectID":"/projects/cos-album/:3:1","tags":["CosAlbum","è…¾è®¯äº‘ cos æ¡¶","JavaScript"],"title":"åˆ©ç”¨è…¾è®¯äº‘ä¸ºé™æ€é¡µé¢æ·»åŠ â€œåŠ¨æ€â€ç›¸å†Œ","uri":"/projects/cos-album/"},{"categories":["Projects","JavaScript"],"content":"Step2 \u003cscript type=\"text/javascript\"\u003e new Cosalbum({ 'xmlLink': 'https://img-xxxxxxxxxx.cos.ap-chengdu.myqcloud.com', 'prependTo': '.cos-album', 'viewNum': 8, 'imgUrl': '//img.lruihao.cn' }); \u003c/script\u003e ","date":"2019-11-24","objectID":"/projects/cos-album/:3:2","tags":["CosAlbum","è…¾è®¯äº‘ cos æ¡¶","JavaScript"],"title":"åˆ©ç”¨è…¾è®¯äº‘ä¸ºé™æ€é¡µé¢æ·»åŠ â€œåŠ¨æ€â€ç›¸å†Œ","uri":"/projects/cos-album/"},{"categories":["Projects","JavaScript"],"content":"Params param type default description xmlLink String éœ€è¦è§£æçš„é¨°è¨Šäº‘ COS æ¡¶ XML éˆæ¥ prependTo String â€˜bodyâ€™ å¯é¸è§£æç›¸å†Šåˆ°æŸå€‹ç¯€é» viewNum Number 4 æ¯å€‹ç›¸å†Šé¡¯ç¤ºçš„ç…§ç‰‡æ•¸ç›® copyUrl String href CDN é“¾æ¥ï¼Œé›™æ“Šè¤‡è£½ URL Since: 1.1.6 imgType String [â€˜jpgâ€™, â€˜jpegâ€™, â€˜pngâ€™, â€˜gifâ€™, â€˜svgâ€™] å›¾ç‰‡é¡å‹ Since: 1.1.6 videoType String [â€˜mp4â€™, â€˜mp3â€™, â€˜aviâ€™, â€˜movâ€™, â€˜qtâ€™] è¦–é »é¡å‹ Since: 1.1.6 viewport è§†ä¸ªäººæƒ…å†µæ·»åŠ ã€‚ hexo ä¸­ä½¿ç”¨æ—¶ css å’Œ js éƒ½éœ€è¦åšé€‚å½“è°ƒæ•´ï¼Œé…åˆåŠ å¯†åŠŸèƒ½ä½¿ç”¨ç­‰ç­‰ï¼Œè¿™é‡Œä¸å†å±•å¼€ã€‚ æ³¨ï¼šä»£ç è®¾å®šä¸åŠ è½½æ ¹ç›®å½•æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨é™æ€æœåŠ¡æŠŠæºç éƒ¨ç½²åœ¨æ ¹ç›®å½•ï¼Œé…åˆ PicGoã€COSBrowser ä¸Šä¼ æ¥æ­å»ºä¸ªäººå›¾åºŠã€‚ \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\" /\u003e \u003ctitle\u003ecos-album\u003c/title\u003e \u003c!-- \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e --\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"cos-album.css\" /\u003e \u003cscript type=\"text/javascript\" src=\"cos-album.js\" defer\u003e\u003c/script\u003e \u003c/head\u003e \u003cbody\u003e \u003cscript type=\"text/javascript\"\u003e new Cosalbum({ xmlLink: 'https://img-xxxxxxxxxx.cos.ap-chengdu.myqcloud.com', prependTo: '.cos-album', viewNum: 8, copyUrl: '//img.lruihao.cn' }); \u003c/script\u003e \u003c!-- ä½ çš„å…¶ä»–å†…å®¹ï¼Œå¦‚è¯„è®ºç­‰ --\u003e \u003c/body\u003e \u003c/html\u003e cos-album demo ","date":"2019-11-24","objectID":"/projects/cos-album/:3:3","tags":["CosAlbum","è…¾è®¯äº‘ cos æ¡¶","JavaScript"],"title":"åˆ©ç”¨è…¾è®¯äº‘ä¸ºé™æ€é¡µé¢æ·»åŠ â€œåŠ¨æ€â€ç›¸å†Œ","uri":"/projects/cos-album/"},{"categories":["Projects","JavaScript"],"content":"changelog 2020-9-28 22:46 å‡ç´šï¼šç›¸å†Šå°è£æˆé¡ï¼Œå¯ä»¥æ›´æ–¹ä¾¿ new å‡ºä¾† å„ªåŒ–ï¼šç›¸å†Šåœ–ç‰‡æ¨£å¼å„ªåŒ– 2019-11-24 10:52:34 ä¿®æ”¹æ•´ç†äº†ä¸€ä¸‹ä»£ç ï¼Œåˆ†å‰²åŠŸèƒ½ä¸ºå‡½æ•°ï¼Œå¹¶å†™äº†æ³¨é‡Šï¼Œæ›´åŠ æ–¹ä¾¿ ä¼¸æ‰‹å…š! ","date":"2019-11-24","objectID":"/projects/cos-album/:4:0","tags":["CosAlbum","è…¾è®¯äº‘ cos æ¡¶","JavaScript"],"title":"åˆ©ç”¨è…¾è®¯äº‘ä¸ºé™æ€é¡µé¢æ·»åŠ â€œåŠ¨æ€â€ç›¸å†Œ","uri":"/projects/cos-album/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":" RESTful æ˜¯ä¸€ç§ç³»ç»Ÿå¼€å‘è®¾è®¡é£æ ¼ã€åŸåˆ™ã€‚å¯è§†æƒ…å†µè°ƒæ•´ï¼Œä»¥ä¸‹å‚è€ƒæ¥æº RFC5789 ","date":"2019-11-14","objectID":"/posts/restful/:0:0","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":"Noun ä¸€èˆ¬èµ„æº é€šç”¨äºä¸€å¾‹ä½¿ç”¨å¤æ•°åè¯ ä¾‹å¦‚ï¼š/books æˆ– /books/123ã€‚ä½†æœ‰éƒ¨åˆ†äººè®¤ä¸ºåº”è¯¥ä½¿ç”¨å•æ•°åè¯ï¼Œå› ä¸ºï¼š /book/123 çœ‹ä¼¼æ¯” /books/123 åˆç†ã€‚ä½†æƒ³æƒ³æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•å‘½åï¼ˆä¾‹å¦‚ /Users æˆ– /Documents)ï¼Œå…¶å®ç”¨å¤æ•°ä¹Ÿæ²¡é—®é¢˜ã€‚å¤æ•°å¯ä»¥ä¿æŒ API endpoint çš„ä¸€è‡´æ€§ï¼Œæ‰€ä»¥ä¸€èˆ¬èµ„æºå»ºè®®ç”¨å¤æ•°ã€‚ å”¯ä¸€èµ„æºï¼šå¯¹ client è€Œè¨€åªæœ‰ä¸€ä»½çš„èµ„æº é€šç”¨äºå•æ•°åè¯ ä¾‹å¦‚ï¼šuser æ˜¯æŒ‡ç›®å‰éªŒè¯çš„ä½¿ç”¨è€…ï¼Œä½¿ç”¨è€…æ°¸è¿œåªèƒ½åŒæ—¶ç™»å…¥ä¸€ä¸ªä½¿ç”¨è€… ","date":"2019-11-14","objectID":"/posts/restful/:1:0","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":"Http Method MethodIdempotentSafeCRUDOOç”Ÿæ´»åŠ¨è¯ç”¨é€”GETYYReadgetgetå–å¾—èµ„æ–™liståˆ—å‡ºèµ„æ–™POSTCreateaddcreateå»ºç«‹ä¸€ä¸ªå¯ä»¥å®Œå…¨ç‹¬ç«‹å­˜åœ¨çš„å®ä½“addå¢åŠ ä¸€ä¸ªå¿…é¡»ä¾èµ–äºæŸä¸ªå®ä½“çš„å®ä½“PUTYUpdatesetreplaceå–ä»£ä¸€ä¸ªå…³ç³»ï¼Œå·²å­˜åœ¨æ—¶å…ˆåˆ é™¤åå»ºç«‹ï¼Œä¸å­˜åœ¨æ—¶ç›´æ¥å»ºç«‹addé™„åŠ å”¯ä¸€å…³ç³»ï¼Œä¸¤ä¸ªå…³ç³»å®ä½“å¯ä»¥äº’ç›¸ç‹¬ç«‹å­˜åœ¨ï¼Œä¸”å·²ç»å­˜åœ¨PATCHeditç¼–è¾‘æŸä¸ªå®ä½“DELETEDeleteremoveremove deleteåˆ é™¤æŸä¸ªå®ä½“ Safeï¼šè¯¥æ“ä½œä¸ä¼šæ”¹å˜ä¼ºæœå™¨ç«¯çš„èµ„æºçŠ¶æ€ï¼ˆè€Œä¸”ç»“æœå¯ä»¥è¢« cacheï¼‰ï¼Œå±äº Safe çš„æ“ä½œå¿…å®šå±äº Idempotent Idempotent (å¹‚ç­‰æ€§)ï¼šè¯¥æ“ä½œä¸ç®¡åš 1 éæˆ–åš n éï¼Œéƒ½ä¼šå¾—åˆ°åŒæ ·çš„èµ„æºçŠ¶æ€ç»“æœï¼ˆä½†ä¸ä¸€å®šå¾—åˆ°åŒæ ·çš„è¿”å›å€¼ï¼Œä¾‹å¦‚ç¬¬ 2 æ¬¡ DELETE è¯·æ±‚å¯èƒ½å›ä¼  404ï¼‰ï¼Œå› æ­¤ client ç«¯å¯ä»¥æ”¾å¿ƒ retry ","date":"2019-11-14","objectID":"/posts/restful/:2:0","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":"GET Safeï¼šæ¯æ¬¡æ‰§è¡Œæ“ä½œæ—¶ï¼ŒGET åªæœ‰è¯»å– Resourceï¼Œä¸ä¼šæ”¹å˜åˆ°ä»»ä½•çš„ Resource ï¼ˆèµ„æºï¼Œèµ„æ–™ï¼‰ Idempotentï¼šæ¯æ¬¡æ‰§è¡Œæ“ä½œæ—¶ï¼ŒGET åªæœ‰è¯»å– Resourceï¼Œä¸ä¼šæ”¹å˜åˆ°ä»»ä½•çš„ Resource ï¼ˆèµ„æºï¼Œèµ„æ–™ï¼‰ï¼Œæ‰€ä»¥ä»»ä½•èµ„æºçš„ä»»ä½•çŠ¶æ€éƒ½æ˜¯ä¸€æ ·çš„ ","date":"2019-11-14","objectID":"/posts/restful/:2:1","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":"POST æ¯æ¬¡æ‰§è¡Œæ“ä½œæ—¶ï¼ŒPOST éƒ½ä¼šå»ºç«‹ä¸€ä¸ª Resource ï¼ˆèµ„æºï¼Œèµ„æ–™ï¼‰ Createï¼šå»ºç«‹ä¸€ä¸ªå¯ä»¥å®Œå…¨ç‹¬ç«‹å­˜åœ¨çš„å®ä½“ èŒƒä¾‹ï¼šå»ºç«‹ä½¿ç”¨è€… æ‰§è¡Œç¬¬ä¸€æ¬¡æ—¶ï¼šå»ºç«‹ä¸€ä¸ª name = â€œæå››â€ çš„ userï¼Œä½†å…¶ id = 1ï¼Œæ‰§è¡Œç¬¬äºŒæ¬¡æ—¶ï¼šå»ºç«‹ä¸€ä¸ª name = â€œæå››â€ çš„ userï¼Œä½†å…¶ id = 2ï¼Œå‘é€åŒæ ·çš„è¯·æ±‚ï¼Œå¯æ¯æ¬¡éƒ½æ˜¯ä¸åŒçš„ Resource å»ºç«‹ä½¿ç”¨è€…å‰ä¸éœ€è¦å»ºç«‹ä»»ä½•çš„ä¸œè¥¿ï¼Œå°±å¯ä»¥å»ºç«‹ä½¿ç”¨è€…äº†ï¼Œä½¿ç”¨è€…æ˜¯å¯ä»¥å®Œå…¨ç‹¬ç«‹çš„å­˜åœ¨ POST /users HTTP/1.1 Host: 127.0.0.1 { \"name\": \"æå››\" } Addï¼šå¢åŠ ä¸€ä¸ªå¿…é¡»ä¾èµ–äºæŸä¸ªå®ä½“çš„å®ä½“ èµ„æ–™ç»“æ„ï¼šä¸€å¯¹å¤šçš„å…³ç³» èŒƒä¾‹ï¼šAdd a public key on behalf of a user å¢åŠ ä¸€ä¸ªä»£è¡¨ä½¿ç”¨è€…çš„å…¬é’¥ (Gitea API) å¢åŠ è¿™ä¸ªå…¬é’¥ä¹‹å‰ï¼Œä½¿ç”¨è€…å¿…é¡»å­˜åœ¨ï¼Œå…¬é’¥å¿…é¡»å½’å±äºæŸä¸ªä½¿ç”¨è€…ä¹‹ä¸‹ï¼Œå…¬é’¥è·Ÿå§“åä¸€æ ·ï¼Œä½¿ç”¨ç›¸åŒç”µè„‘çš„å…¬é’¥å°±ä¼šç›¸åŒï¼Œä½†ä¸è¡¨ç¤ºæ˜¯åŒä¸€ä¸ªä½¿ç”¨è€…ï¼Œæ•…å…¬é’¥ä¹Ÿä¼šæœ‰è‡ªå·±çš„ ID æˆ‘æ¯æ¬¡å¢åŠ å…¬é’¥æ—¶ï¼Œéƒ½å°†ç”Ÿæˆä¸åŒçš„å…¬é’¥ ID POST /api/v1/admin/users/{username}/keys HTTP/1.1 Host: gitea.com { \"key\": \"string\", \"read_only\": true, \"title\": \"string\" } ","date":"2019-11-14","objectID":"/posts/restful/:2:2","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":"PUT Idempotentï¼šæ¯æ¬¡æ‰§è¡Œæ“ä½œæ—¶ï¼ŒPUT éƒ½ä¼šå–ä»£ Resourceï¼Œä¸ç®¡æ“ä½œå‡ æ¬¡ï¼Œä½¿ç”¨è€…è·å–å¾— Resource ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ Replaceï¼šä¸è®ºèµ„æºå¦‚ä½•ï¼Œæœ€ç»ˆçš„èµ„æºçŠ¶æ€éƒ½æ˜¯ä¸€æ ·çš„ï¼ŒResource å·²å­˜åœ¨æ—¶ï¼Œæˆ–è®¸ä¸ç†ä¼šã€æˆ–è®¸å…ˆåˆ é™¤åå»ºç«‹ï¼ˆå–ä»£ï¼‰Resource ä¸å­˜åœ¨æ—¶ï¼Œç›´æ¥å»ºç«‹ Addï¼šæ·»åŠ å”¯ä¸€å…³ç³»ï¼Œå»ºç«‹è¿™ä¸ªå”¯ä¸€å…³ç³»å‰ï¼Œä¸¤ä¸ªå…³è¿å®ä½“éƒ½å¿…é¡»å­˜åœ¨ã€‚åœ¨æ²¡æœ‰å»ºç«‹å…³ç³»å‰ï¼Œä¸¤ä¸ªå…³è¿å®ä½“éƒ½å¯ä»¥äº’ç›¸ç‹¬ç«‹å­˜åœ¨ èµ„æ–™ç»“æ„ï¼šå¤šå¯¹å¤šï¼Œä¸”ä¸¤ä¸ªå…³è¿å®ä½“çš„ PKï¼ŒåŒæ—¶ä¹Ÿæ˜¯å…³ç³»å®ä½“çš„ PKã€FK èŒƒä¾‹ï¼šå¢åŠ ä½¿ç”¨è€…ä¸è§’è‰²çš„å…³ç³» å¢åŠ ä½¿ç”¨è€…è·Ÿè§’è‰²çš„å…³ç³»å‰ï¼Œä½¿ç”¨è€…è·Ÿè§’è‰²éƒ½å¿…é¡»å­˜åœ¨ï¼›å¢åŠ ä½¿ç”¨è€…è·Ÿè§’è‰²çš„å…³ç³»å‰ï¼Œä½¿ç”¨è€…è·Ÿè§’è‰²å¯ä»¥ç‹¬ç«‹å­˜åœ¨ï¼Œ ä½¿ç”¨è€… 12262 è·Ÿ è§’è‰² 2 çš„å…³ç³»æœ€å¤šåªèƒ½æœ‰ä¸€æ¡å…³ç³»ï¼ˆ ä½¿ç”¨è€… 12262 æœ‰ è§’è‰² 2)ï¼Œæœ€å°‘æ²¡æœ‰å…³ç³»ï¼ˆä½¿ç”¨è€… 12262 æ²¡æœ‰ è§’è‰² 2 ) ï¼Œæ‰§è¡Œç¬¬äºŒæ¬¡æ“ä½œæ—¶ï¼Œä½¿ç”¨è€… 12262 è·Ÿ è§’è‰² 2 çš„ä»å±å…³ç³»ä»ç„¶å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šè·‘å‡ºç¬¬äºŒæ¡ ä½¿ç”¨è€… 12262 è·Ÿ è§’è‰² 2 çš„ä»å±å…³ç³» PUT user/{account}/roles HTTP/1.1 Host: 127.0.0.1 { \"role_id\": \"2\" } èŒƒä¾‹ï¼šFollow a user å…³æ³¨ä¸€ä¸ªä½¿ç”¨è€… (Gitea API) å¢åŠ å…³æ³¨å…³ç³»æ—¶ï¼Œå…³æ³¨è€…ä¸è¢«å…³æ³¨è€…ï¼ˆéƒ½æ˜¯ä½¿ç”¨è€…ï¼‰ éƒ½å¿…é¡»å­˜åœ¨ï¼›å…³æ³¨è€… 12262 è·Ÿè¢«å…³æ³¨è€… 12231 çš„å…³ç³»æœ€å¤šåªèƒ½æœ‰ä¸€æ¡å…³ç³»ï¼ˆ12262 å…³æ³¨ 12231ï¼‰ï¼Œæœ€å°‘æ²¡æœ‰å…³ç³»ï¼ˆ12262 ä¸å…³æ³¨ 12231ï¼‰ï¼Œæ‰§è¡Œç¬¬äºŒæ¬¡æ“ä½œæ—¶ï¼Œå…³æ³¨è€… 12262 è·Ÿè¢«å…³æ³¨è€… 12231 çš„å…³æ³¨å…³ç³»ä»ç„¶å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šè·‘å‡ºç¬¬äºŒæ¡å…³æ³¨è€… 12262 è·Ÿè¢«å…³æ³¨è€… 12231 çš„å…³æ³¨å…³ç³» PUT /api/v1/user/following/{username} HTTP/1.1 Host: gitea.com ","date":"2019-11-14","objectID":"/posts/restful/:2:3","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":"PATCH Editï¼šç¼–è¾‘å¯ç‹¬ç«‹å­˜åœ¨ã€ä¸”å·²ç»å­˜åœ¨çš„å®ä½“ï¼Œä¹Ÿå°±æ˜¯äº§ç”Ÿæ–°ç‰ˆæœ¬çš„å®ä½“ï¼Œå¯èƒ½ä¼šå½±å“å…¶ä»– Resource èŒƒä¾‹ï¼šç¼–è¾‘ä½¿ç”¨è€… ç¼–è¾‘ä½¿ç”¨è€…ï¼Œä½¿ç”¨è€…å·²ç»å­˜åœ¨ï¼Œä¸”æˆ‘ä»¬å¯èƒ½æœ‰çºªå½•ç¼–è¾‘æ—¶é—´ã€ç¼–è¾‘äººã€ç¼–è¾‘ IPï¼Œæ‰€ä»¥æ¯æ¬¡çš„ç¼–è¾‘éƒ½ä¼šé€ æˆä¸ä¸€æ ·çš„ç»“æœ ç¬¬ä¸€æ¬¡ç¼–è¾‘ä½¿ç”¨è€…ï¼Œæ›´æ–°æ—¶é—´å˜ä¸º 08:00ï¼Œç¼–è¾‘äºº 12262ï¼ŒIP 172.18.0.66 ç¬¬äºŒæ¬¡ç¼–è¾‘ä½¿ç”¨è€…ï¼Œæ›´æ–°æ—¶é—´å˜ä¸º 09:00ï¼Œç¼–è¾‘äºº 12263ï¼ŒIP 172.18.0.67 PATCH /users/{account} HTTP/1.1 Host: 127.0.0.1 { \"username\": \"æå››\", \"age\": \"18\", \"gender\": \"male\" } ","date":"2019-11-14","objectID":"/posts/restful/:2:4","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":"DELETE Idempotentï¼šæ¯æ¬¡æ‰§è¡Œæ“ä½œæ—¶ï¼ŒDELETE éƒ½ä¼šåˆ é™¤ç›¸åŒçš„ä¸œè¥¿ èŒƒä¾‹ï¼šåˆ é™¤ä½¿ç”¨è€… ç¬¬ä¸€æ¬¡åˆ é™¤ä½¿ç”¨è€… 12262ï¼Œåˆ é™¤ä½¿ç”¨è€… 12262, ç¬¬äºŒæ¬¡åˆ é™¤ä½¿ç”¨è€… 12262ï¼Œè¿˜æ˜¯åˆ é™¤ä½¿ç”¨è€… 12262ï¼Œåªä¸è¿‡ä½¿ç”¨è€… 12262 ä¸å­˜åœ¨äº† DELETE /users/{account} HTTP/1.1 Host: 127.0.0.1 ","date":"2019-11-14","objectID":"/posts/restful/:2:5","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":"HTTP Status Code HTTP çŠ¶æ€ç ï¼ˆHTTP Status Codeï¼‰æ˜¯ç”¨ä»¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨ HTTP å“åº”çŠ¶æ€çš„ 3 ä½æ•°å­—ä»£ç ã€‚æ‰€æœ‰çŠ¶æ€ç çš„ç¬¬ä¸€ä¸ªæ•°å­—ä»£è¡¨äº†å“åº”çš„äº”ç§çŠ¶æ€ä¹‹ä¸€ã€‚é™¤éå¦æœ‰è¯´æ˜ï¼ŒçŠ¶æ€ç æ˜¯ HTTP/1.1 æ ‡å‡†ï¼ˆRFC 7231ï¼‰çš„ä¸€éƒ¨åˆ†ã€‚ è€Œå…³äº RESTful API çš„è¯·æ±‚çŠ¶æ€ï¼Œé€šå¸¸æœ‰ä»¥ä¸‹ä¸¤ç§è®¾è®¡æ–¹æ¡ˆï¼š æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ HTTP çŠ¶æ€ç æ¥è¡¨ç¤ºè¯·æ±‚çŠ¶æ€ï¼Œ200 æ—¶è¿”å›çš„å†…å®¹å°±æ˜¯æ•°æ® æ–¹æ¡ˆäºŒï¼šæ‰€æœ‰æ¥å£éƒ½è¿”å› 200 ï¼Œåœ¨å“åº”å†…å®¹é‡Œçº¦å®šé”™è¯¯ç æˆ–é”™è¯¯ä¿¡æ¯ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œåº”æ®å…·ä½“æƒ…æ™¯åŠéœ€è¦è¿›è¡Œé€‰æ‹©ä¸è°ƒæ•´ã€‚ æ–¹æ¡ˆä¼˜åŠ£æ¯”è¾ƒæ–¹æ¡ˆä¸€ä¼˜ç‚¹å¯¹æœåŠ¡ç«¯æ¥è¯´è¾ƒä¸ºç®€å•æ–¹ä¾¿ç¼ºç‚¹å®¢æˆ·ç«¯éš¾ä»¥æ ¹æ®çŠ¶æ€ç å¤„ç†å¤æ‚é—®é¢˜æ–¹æ¡ˆäºŒä¼˜ç‚¹æ–¹ä¾¿å¯¹è¿”å›èµ„æ–™è¿›è¡Œç»Ÿä¸€å¤„ç†å’Œç»†å¾®æ€§çš„æ§åˆ¶ç¼ºç‚¹ç›¸å½“äºæ”¾å¼ƒäº† HTTP çŠ¶æ€ç çš„è¯­ä¹‰ ","date":"2019-11-14","objectID":"/posts/restful/:3:0","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["Spec","è®¡ç®—æœºç½‘ç»œ"],"content":"å¸¸ç”¨ HTTP çŠ¶æ€ç  Code Message ç”¨é€” 1XX Informational response æ­¤ç±»çŠ¶æ€ç é€šå¸¸ä»£è¡¨çš„å“åº”éƒ½æ˜¯ä¿¡æ¯æ€§çš„ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ 100 Continue è¡¨ç¤ºæœåŠ¡ç«¯å·²æ¥æ”¶åˆ°è¯·æ±‚å¤´ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç»§ç»­å‘é€è¯·æ±‚ä½“ï¼ˆå¦‚ POST è¯·æ±‚ï¼‰ã€‚ 101 Switching Protocols è¡¨ç¤ºæœåŠ¡ç«¯æ”¯æŒæ›´ä¼˜åè®®ï¼Œè®©å®¢æˆ·ç«¯åœ¨æœåŠ¡ç«¯æ›´æ¢åè®®åé‡æ–°è®¿é—®ã€‚ 2XX Successful æ­¤ç±»çŠ¶æ€ç é€šå¸¸ä»£è¡¨è¯·æ±‚å·²æˆåŠŸè¢«æœåŠ¡ç«¯æ¥æ”¶ã€ç†è§£å¹¶æ¥å—ã€‚ 200 OK è¡¨ç¤ºè¯·æ±‚æˆåŠŸã€‚ 201 Created è¡¨ç¤ºè¯·æ±‚å·²è¢«å®ç°ï¼Œé€šå¸¸æ˜¯åœ¨æˆåŠŸåˆ›å»ºäº†æŸä¸ªèµ„æºã€‚ 202 Accepted è¡¨ç¤ºè¯·æ±‚å·²è¢«æœåŠ¡ç«¯æ¥æ”¶ï¼Œä½†å°šæœªè¿›è¡Œå¤„ç†ã€‚ 204 No Content è¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†ä¸ä¼šè¿”å›ä»»ä½•å†…å®¹ã€‚ 205 Reset Content è¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†ä¸ä¼šè¿”å›ä»»ä½•å†…å®¹ï¼Œå¹¶ä¸”è¦æ±‚å®¢æˆ·ç«¯é‡ç½®è¡¨å•ã€‚ 3XX Redirect æ­¤ç±»çŠ¶æ€ç é€šå¸¸ä»£è¡¨æœ¬æ¬¡è¯·æ±‚éœ€è¦å®¢æˆ·ç«¯é‡‡å–è¿›ä¸€æ­¥æ“ä½œæ‰èƒ½å®Œæˆã€‚é€šå¸¸ç”¨äºé‡å®šå‘ã€‚ 300 Multiple Choices è¡¨ç¤ºè¯·æ±‚çš„èµ„æºæœ‰å¤šä¸ªä¾›å¯é€‰æ‹©ï¼Œå®¢æˆ·ç«¯å¯è‡ªè¡Œé€‰æ‹©ä¸€ä¸ªè¿›è¡Œè¯·æ±‚çš„é‡å®šå‘ã€‚ 301 Moved Permanently è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²ç»æ°¸ä¹…åœ°ç§»åŠ¨åˆ°äº†æ–°ä½ç½®ï¼Œå¹¶ä¸”å°†åœ¨ Location åŸŸä¸­æºå¸¦è¯¥èµ„æºæ–°çš„ URIã€‚ 304 Not Modified è¡¨ç¤ºè¯·æ±‚çš„èµ„æºæ— å‘ç”Ÿä¿®æ”¹ï¼Œå°†ä¸ä¼šè¿”å›ä»»ä½•èµ„æºã€‚ 4XX Client Error æ­¤ç±»çŠ¶æ€ç é€šå¸¸ä»£è¡¨å®¢æˆ·ç«¯å¯èƒ½å‡ºç°äº†é”™è¯¯ã€‚ 400 Bad Request è¡¨ç¤ºå®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚æœ‰è¯¯ï¼ˆæ ¼å¼ã€å¤§å°ã€æ— æ•ˆçš„â€¦)ï¼ŒæœåŠ¡ç«¯ä¸èƒ½/ ä¸ä¼šå¤„ç†è¯¥è¯·æ±‚ã€‚ 401 Unauthorized è¡¨ç¤ºå®¢æˆ·ç«¯æœªèƒ½æä¾›å¿…è¦çš„éªŒè¯ï¼ŒæœåŠ¡ç«¯æ‹’ç»æä¾›èµ„æºã€‚ 403 Forbidden è¡¨ç¤ºæœåŠ¡ç«¯ç†è§£äº†è¯¥è¯·æ±‚ï¼Œä½†å®¢æˆ·ç«¯æ²¡æœ‰è¶³å¤Ÿæƒé™ä»¥è®¿é—®ï¼Œé‚æ‹’ç»æä¾›è¯¥èµ„æºã€‚ 404 Not Found è¡¨ç¤ºæœåŠ¡ç«¯æ— æ³•æ‰¾åˆ°è¯·æ±‚çš„èµ„æºï¼Œå…¶å¯èƒ½å·²ç»æš‚æ—¶ï¼ˆæ°¸ä¹…ï¼‰å¤±æ•ˆã€‚ 408 Request Timeout è¡¨ç¤ºè¯·æ±‚è¶…æ—¶ã€‚ 409 Conflict è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå‘é€äº†å†²çªï¼Œé€šå¸¸æ˜¯ PUT è¯·æ±‚ã€‚ 410 Gone è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²ç»æ°¸ä¹…å¤±æ•ˆï¼Œå®¢æˆ·ç«¯ä¸åº”å†æ¬¡è¯·æ±‚ã€‚ 411 Length Required è¡¨ç¤ºæœåŠ¡ç«¯æ‹’ç»åœ¨æ²¡æœ‰å®šä¹‰ Content-Length å¤´çš„æƒ…å†µä¸‹æ¥æ”¶è¯¥è¯·æ±‚ã€‚ 5XX Server Error æ­¤ç±»çŠ¶æ€ç é€šå¸¸ä»£è¡¨ç”±äºæœåŠ¡ç«¯çš„åŸå› ï¼Œå¯¼è‡´æ— æ³•å®Œæˆè¯·æ±‚ã€‚ 500 Internal Server Error è¡¨ç¤ºç”±äºæœåŠ¡ç«¯é‡åˆ°æ„æ–™ä¹‹å¤–çš„å˜æ•…ï¼Œå¯¼è‡´æ— æ³•å®Œæˆè¯·æ±‚ã€‚ 501 Not Implemented è¡¨ç¤ºæœåŠ¡ç«¯ä¸æ”¯æŒå®Œæˆè¯·æ±‚æ‰€éœ€çš„åŠŸèƒ½ï¼Œå¯¼è‡´æ— æ³•å®Œæˆè¯·æ±‚ã€‚ 502 Bad Gateway è¡¨ç¤ºä½œä¸ºç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡æ®µåœ¨æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨è·å¾—äº†æ— æ•ˆçš„å“åº”ã€‚ 503 Service Unavailable è¡¨ç¤ºç”±äºæŸäº›åŸå› ï¼ˆæœåŠ¡å™¨è¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ç­‰ï¼‰ï¼Œå¯¼è‡´æš‚æ—¶æ— æ³•å®Œæˆè¯·æ±‚ã€‚ 504 Gatewy Timeout è¡¨ç¤ºä½œä¸ºç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡æ®µåœ¨æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œæœªèƒ½åŠæ—¶ä»ä¸Šæ¸¸æœåŠ¡å™¨è·å¾—å“åº”ã€‚ 505 HTTP Version Not Supported è¡¨ç¤ºæœåŠ¡ç«¯ä¸æ”¯æŒè¯·æ±‚çš„ HTTP åè®®ç‰ˆæœ¬ï¼Œå¯¼è‡´æ— æ³•å®Œæˆè¯·æ±‚ã€‚ ä»¥ä¸Šå†…å®¹å‚è€ƒè‡ªhttps://zh.wikipedia.org/zh-cn/HTTPçŠ¶æ€ç ï¼Œ éœ€è¦æŸ¥çœ‹å®Œæ•´ HTTP çŠ¶æ€ç è¯·ç‚¹å‡» https://www.rfc-editor.org/rfc/rfc9110.html#name-status-codes ","date":"2019-11-14","objectID":"/posts/restful/:3:1","tags":["REST","HTTP"],"title":"RESTful","uri":"/posts/restful/"},{"categories":["PHP"],"content":" php ä¸»åŠ¨æ¨é€ç«™ç‚¹é“¾æ¥åˆ°ç™¾åº¦ç«™é•¿ï¼Œç¥é©¬ç«™é•¿è¿›è¡Œ SEOã€‚ ","date":"2019-09-28","objectID":"/posts/phppushurl/:0:0","tags":["PHP"],"title":"php åŒæ—¶ä¸»åŠ¨æ¨é€é“¾æ¥åˆ°ç™¾åº¦ï¼Œç¥é©¬ç­‰ç«™é•¿å¹³å°","uri":"/posts/phppushurl/"},{"categories":["PHP"],"content":"ä»£ç  æŠŠéœ€è¦æäº¤çš„é“¾æ¥å’Œå„ç«™é•¿ api åˆ†åˆ«æ”¾åœ¨ä¸¤ä¸ª txt æ–‡ä»¶é‡Œé¢ï¼Œç„¶åè¿è¡Œ php æ–‡ä»¶è¿›è¡Œæäº¤ï¼Œä¸åŒç«™é•¿æäº¤æˆåŠŸä¸€èˆ¬è¿”å›çš„éƒ½æ˜¯ 200 çŠ¶æ€ç ã€‚ \u003c?php //é“¾æ¥å­˜æ”¾è·¯å¾„å’Œç«™é•¿ api æ–‡ä»¶å­˜æ”¾è·¯å¾„ $urls_path = \"H:\\\\lruihao.cn\\\\public\\\\baidu_urls.txt\"; $apis_path = \"G:\\\\Demo\\\\lrh01\\\\zhanzhang_api.txt\"; //å°†æ–‡ä»¶æ¯ä¸€è¡Œè¯»åˆ°ä¸€ä¸ªæ•°ç»„é‡Œé¢å» $urls = file($urls_path, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES); $apis = file($apis_path, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES); for($x=0;$x\u003ccount($apis);$x++){ $ch = curl_init(); $options = array( CURLOPT_URL =\u003e $apis[$x], CURLOPT_POST =\u003e true, CURLOPT_RETURNTRANSFER =\u003e true, CURLOPT_POSTFIELDS =\u003e implode(\"\\n\", $urls), CURLOPT_HTTPHEADER =\u003e array('Content-Type: text/plain'), ); curl_setopt_array($ch, $options); $result = curl_exec($ch); echo \"API: \u003cbr/\u003e\u0026emsp;\".$apis[$x].\"\u003cbr/\u003e\"; echo \"result: \u003cbr/\u003e\u0026emsp;\".$result.\"\u003chr/\u003e\"; } ?\u003e ","date":"2019-09-28","objectID":"/posts/phppushurl/:1:0","tags":["PHP"],"title":"php åŒæ—¶ä¸»åŠ¨æ¨é€é“¾æ¥åˆ°ç™¾åº¦ï¼Œç¥é©¬ç­‰ç«™é•¿å¹³å°","uri":"/posts/phppushurl/"},{"categories":["PHP"],"content":"æäº¤ç»“æœ ","date":"2019-09-28","objectID":"/posts/phppushurl/:2:0","tags":["PHP"],"title":"php åŒæ—¶ä¸»åŠ¨æ¨é€é“¾æ¥åˆ°ç™¾åº¦ï¼Œç¥é©¬ç­‰ç«™é•¿å¹³å°","uri":"/posts/phppushurl/"},{"categories":["PHP"],"content":"æ™®é€šæ–¹æ³• é¦–å…ˆé‡‡ç”¨fopen()å‡½æ•°æ‰“å¼€æ–‡ä»¶ï¼Œå¾—åˆ°è¿”å›å€¼çš„å°±æ˜¯èµ„æºç±»å‹ã€‚æ¥ç€é‡‡ç”¨ while å¾ªç¯ä¸€è¡Œè¡Œåœ°è¯»å–æ–‡ä»¶ï¼Œç„¶åè¾“å‡ºæ¯è¡Œçš„æ–‡å­—ã€‚feof()åˆ¤æ–­æ˜¯å¦åˆ°æœ€åä¸€è¡Œï¼Œfgets()è¯»å–ä¸€è¡Œæ–‡æœ¬ã€‚ \u003c?php //é¦–å…ˆé‡‡ç”¨â€œfopenâ€å‡½æ•°æ‰“å¼€æ–‡ä»¶ï¼Œå¾—åˆ°è¿”å›å€¼çš„å°±æ˜¯èµ„æºç±»å‹ã€‚ $file_handle = fopen(\"C:\\\\Users\\\\æç‘è±ªã€\\Desktop\\\\å¤‡å¿˜å½•ã€‚txt\",\"r\"); if ($file_handle){ //æ¥ç€é‡‡ç”¨ while å¾ªç¯ä¸€è¡Œè¡Œåœ°è¯»å–æ–‡ä»¶ï¼Œç„¶åè¾“å‡ºæ¯è¡Œçš„æ–‡å­— while (!feof($file_handle)) { //åˆ¤æ–­æ˜¯å¦åˆ°æœ€åä¸€è¡Œ $line = fgets($file_handle); //è¯»å–ä¸€è¡Œæ–‡æœ¬ echo $line; //è¾“å‡ºä¸€è¡Œæ–‡æœ¬ echo \"\u003cbr /\u003e\"; //æ¢è¡Œ } } fclose($file_handle);//å…³é—­æ–‡ä»¶ ?\u003e readfileï¼ˆï¼‰å‡½æ•°ï¼Œè¿”å›ä¸€æ•´ä¸ª String echo readfile(\"C:\\\\Users\\\\æç‘è±ªã€\\Desktop\\\\å¤‡å¿˜å½•ã€‚txt\"); ","date":"2019-09-28","objectID":"/posts/phpfile/:1:0","tags":["PHP"],"title":"php æŒ‰è¡Œè¯»å–æ–‡ä»¶ä¿¡æ¯","uri":"/posts/phpfile/"},{"categories":["PHP"],"content":"å¿«é€Ÿæ–¹æ³• file()å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­ã€‚ æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æ–‡ä»¶ä¸­ç›¸åº”çš„ä¸€è¡Œï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…ã€‚ è¯­æ³• file(path,include_path,context) å‚æ•° æè¿° path å¿…éœ€ã€‚è§„å®šè¦è¯»å–çš„æ–‡ä»¶ã€‚ include_path å¯é€‰å‚æ•°include_path å¯ä»¥æ˜¯ä»¥ä¸‹ä¸€ä¸ªæˆ–å¤šä¸ªå¸¸é‡ï¼š**FILE_USE_INCLUDE_PATHåœ¨ include_path ä¸­æŸ¥æ‰¾æ–‡ä»¶ã€‚FILE_IGNORE_NEW_LINESåœ¨æ•°ç»„æ¯ä¸ªå…ƒç´ çš„æœ«å°¾ä¸è¦æ·»åŠ æ¢è¡Œç¬¦FILE_SKIP_EMPTY_LINES**è·³è¿‡ç©ºè¡Œ context å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚è‹¥ä½¿ç”¨ NULLï¼Œåˆ™å¿½ç•¥ã€‚ \u003c?php $filepath=\"H:\\\\lruihao.cn\\\\public\\\\baidu_urls.txt\"; echo \"\u003chr/\u003e\"; //å°†æ–‡ä»¶æ¯ä¸€è¡Œè¯»åˆ°ä¸€ä¸ªæ•°ç»„é‡Œé¢å» $texts = file($filepath, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES); var_dump($texts); ?\u003e ","date":"2019-09-28","objectID":"/posts/phpfile/:2:0","tags":["PHP"],"title":"php æŒ‰è¡Œè¯»å–æ–‡ä»¶ä¿¡æ¯","uri":"/posts/phpfile/"},{"categories":["PHP"],"content":"ç»“æœ ","date":"2019-09-28","objectID":"/posts/phpfile/:3:0","tags":["PHP"],"title":"php æŒ‰è¡Œè¯»å–æ–‡ä»¶ä¿¡æ¯","uri":"/posts/phpfile/"},{"categories":["JavaScript"],"content":" ä½¿ç”¨javascriptè®¡ç®—åšå®¢ç­‰ç½‘ç«™çš„è¿è¡Œæ—¶é—´ã€‚ è¯ä¸å¤šè¯´ï¼Œç›´æ¥è´´ç ï¼ function createTime() { var now = new Date(); var run = new Date('05/28/2018 20:01:01'); //ç¸½çš„ç§’æ•¸ var runTime = (now - run) / 1000, days = Math.floor(runTime / 60 / 60 / 24), hours = Math.floor(runTime / 60 / 60 - 24 * days), minutes = Math.floor(runTime / 60 - 24 * 60 * days - 60 * hours), seconds = Math.floor((now - run) / 1000 - 24 * 60 * 60 * days - 60 * 60 * hours - 60 * minutes); //å‰ç½®é›¶ if (String(hours).length === 1) { hours = '0' + hours; } if (String(minutes).length === 1) { minutes = '0' + minutes; } if (String(seconds).length === 1) { seconds = '0' + seconds; } /*document.querySelector(\".run-times\").innerHTML = days + \"\u0026thinsp; å¤©\u0026thinsp;\" + hours + \"\u0026thinsp; æ—¶\u0026thinsp;\" + minutes + \"\u0026thinsp; åˆ†\u0026thinsp;\" + seconds + \"\u0026thinsp; ç§’\"; */ document.querySelector('.run-times').innerHTML = 'RunTime: ' + days + ',' + hours + ':' + minutes + ':' + seconds + ''; } //setInterval(\"createTime()\", 500); if (!document.hidden) { var siteTime = setInterval('createTime()', 500); } else { clearInterval(siteTime); } /** * HTML å†™æ³• \u003cspan class=\"run-times\" title=\"ç½‘ç«™è¿è¡Œæ—¶é—´\"\u003eè½½å…¥æ—¶åˆ†ç§’ ...\u003c/span\u003e \u003cp class=\"run-times\" title=\"ä¸»é è¿è¡Œæ—¶é—´\"\u003eRunTime Loading...\u003c/p\u003e */ ","date":"2019-09-19","objectID":"/posts/site-time/:0:0","tags":["JavaScript"],"title":"è®¾ç½®ç½‘ç«™è¿è¡Œæ—¶é—´","uri":"/posts/site-time/"},{"categories":["JavaScript"],"content":" æ³¨æ„ JS çš„åŠ è½½åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸‹è½½å’Œæ‰§è¡Œã€‚ æµè§ˆå™¨åœ¨æ‰§è¡Œ HTML çš„æ—¶å€™å¦‚æœé‡åˆ°\u003cscript\u003eæ—¶ä¼šåœæ­¢é¡µé¢çš„æ¸²æŸ“ï¼Œå»ä¸‹è½½å’Œæ‰§è¡Œ js çš„æ–‡ä»¶ç›´æ¥é‡è§\u003c/scirpt\u003eä¼šç»§ç»­æ¸²æŸ“é¡µé¢ã€‚æ•…æµè§ˆå™¨åœ¨æ‰§è¡Œ js æ–‡ä»¶çš„æ—¶å€™æµè§ˆå™¨è¡¨ç°ä¸ºä¸€ç‰‡ç©ºç™½ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ ECMAScript å®šä¹‰äº† defer å’Œ async ä¸¤ä¸ªå±æ€§ç”¨äºæ§åˆ¶ JS çš„ä¸‹è½½å’Œæ‰§è¡Œã€‚ ","date":"2019-09-08","objectID":"/posts/async-defer/:0:0","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["JavaScript"],"content":"ä¸å¸¦ä»»ä½•å±æ€§ åŒæ­¥æ¨¡å¼ï¼Œåˆç§°é˜»å¡æ¨¡å¼ï¼Œæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„æœ€å¤šçš„ä¸€ç§æ–¹å¼ã€‚å½“æµè§ˆå™¨è§£æåˆ°\u003cscript\u003eæ ‡ç­¾æ—¶ï¼Œæµè§ˆå™¨ä¼šåœæ­¢è§£æå…¶åçš„å†…å®¹ï¼Œè€Œä¼˜å…ˆä¸‹è½½è„šæœ¬æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼Œæ˜¯ä¸ªåŒæ­¥é˜»å¡çš„è¿‡ç¨‹ã€‚ ä¸€èˆ¬å»ºè®®æŠŠ\u003cscript\u003eæ ‡ç­¾æ”¾åœ¨\u003cbody\u003eç»“å°¾å¤„ï¼Œè¿™æ ·å°½å¯èƒ½å‡å°‘é¡µé¢é˜»å¡ã€‚ è€Œå¦‚æœæƒ³è¦å¼‚æ­¥æ‰§è¡Œ scriptï¼Œåˆ™å¯ä»¥ç»™å…¶åŠ ä¸Š async æˆ– defer å±æ€§ã€‚ \u003cscript\u003e ","date":"2019-09-08","objectID":"/posts/async-defer/:1:0","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["JavaScript"],"content":"defer defer å±æ€§åœ¨ HTML è§£ææœŸé—´å¼‚æ­¥ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶ä¸”åªåœ¨ HTML è§£æå®Œæˆåæ‰æ‰§è¡Œå®ƒã€‚å¯¹äº deferï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£æ˜¯å°†å¤–é“¾çš„ js æ”¾åœ¨äº†é¡µé¢åº•éƒ¨ã€‚js çš„åŠ è½½ä¸ä¼šé˜»å¡é¡µé¢çš„æ¸²æŸ“å’Œèµ„æºçš„åŠ è½½ã€‚ä¸è¿‡ defer ä¼šæŒ‰ç…§åŸæœ¬çš„ js çš„é¡ºåºæ‰§è¡Œï¼Œæ‰€ä»¥å¦‚æœå‰åæœ‰ä¾èµ–å…³ç³»çš„ js å¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚ \u003cscript defer\u003e ","date":"2019-09-08","objectID":"/posts/async-defer/:2:0","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["JavaScript"],"content":"async async å±æ€§ä¼šåœ¨ HTML è§£ææœŸé—´å¼‚æ­¥ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶åœ¨å®Œæˆä¸‹è½½åç«‹å³æš‚åœ HTML è§£æå™¨å»æ‰§è¡Œ script ä¸­çš„ä»£ç ã€‚åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æµè§ˆå™¨å¤„äºé˜»å¡çŠ¶æ€ï¼Œå“åº”ä¸äº†ä»»ä½•éœ€æ±‚ã€‚å¦‚æœ js å‰åæœ‰ä¾èµ–æ€§ï¼Œç”¨ asyncï¼Œå°±å¾ˆæœ‰å¯èƒ½å‡ºé”™ã€‚ \u003cscript async\u003e ","date":"2019-09-08","objectID":"/posts/async-defer/:3:0","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["JavaScript"],"content":"åŒºåˆ« ","date":"2019-09-08","objectID":"/posts/async-defer/:4:0","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["JavaScript"],"content":"ç›¸åŒç‚¹ åŠ è½½æ–‡ä»¶æ—¶ä¸é˜»å¡é¡µé¢æ¸²æŸ“ å¯¹äº inline çš„ script æ— æ•ˆï¼ˆåªé€‚ç”¨æœ‰srcçš„å¤–éƒ¨ jsï¼‰ ä½¿ç”¨è¿™ä¸¤ä¸ªå±æ€§çš„è„šæœ¬ä¸­ä¸èƒ½è°ƒç”¨ document.write æ–¹æ³• æœ‰è„šæœ¬çš„ onload çš„äº‹ä»¶å›è°ƒ ","date":"2019-09-08","objectID":"/posts/async-defer/:4:1","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["JavaScript"],"content":"åŒºåˆ«ç‚¹ html4.0 ä¸­å®šä¹‰äº† deferï¼›html5.0 ä¸­å®šä¹‰äº† async æµè§ˆå™¨æ”¯æŒä¸åŒ æ¯ä¸€ä¸ª async å±æ€§çš„è„šæœ¬éƒ½åœ¨å®ƒä¸‹è½½ç»“æŸä¹‹åç«‹åˆ»æ‰§è¡Œï¼ŒåŒæ—¶ä¼šåœ¨ window çš„ load äº‹ä»¶ä¹‹å‰æ‰§è¡Œã€‚æ‰€ä»¥å°±æœ‰å¯èƒ½å‡ºç°è„šæœ¬æ‰§è¡Œé¡ºåºè¢«æ‰“ä¹±çš„æƒ…å†µï¼›æ¯ä¸€ä¸ª defer å±æ€§çš„è„šæœ¬éƒ½æ˜¯åœ¨é¡µé¢è§£æå®Œæ¯•ä¹‹åï¼ŒæŒ‰ç…§åŸæœ¬çš„é¡ºåºæ‰§è¡Œï¼ŒåŒæ—¶ä¼šåœ¨ document çš„ DOMContentLoaded ä¹‹å‰æ‰§è¡Œã€‚ ","date":"2019-09-08","objectID":"/posts/async-defer/:4:2","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["JavaScript"],"content":"é‚£ä¹ˆè¿™ä¸‰ç§æ–¹å¼å„åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨å‘¢ï¼Ÿ é€šå¸¸æ¥è¯´ï¼Œå°½å¯èƒ½ä½¿ç”¨asyncï¼Œç„¶åæ˜¯deferï¼Œæœ€åä¸ä½¿ç”¨å±æ€§ã€‚ å¹¶éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š å¦‚æœè„šæœ¬æ˜¯æ¨¡å—åŒ–çš„ï¼Œå¹¶ä¸”ä¸ä¾èµ–äºä»»ä½•è„šæœ¬ï¼Œåˆ™ä½¿ç”¨asyncã€‚ å¦‚æœè„šæœ¬ä¾èµ–äºæˆ–ä¾èµ–äºå¦ä¸€ä¸ªè„šæœ¬ï¼Œåˆ™ä½¿ç”¨deferã€‚ å¦‚æœè„šæœ¬å¾ˆå°å¹¶ä¸”æœ‰asyncè„šæœ¬ä¾èµ–è¯¥è„šæœ¬ï¼Œåˆ™ä¸åŠ å±æ€§ã€‚ ","date":"2019-09-08","objectID":"/posts/async-defer/:5:0","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["JavaScript"],"content":"å…¼å®¹æ€§ Internet Explorer 10ã€Firefoxã€Operaã€Chrome å’Œ Safari æ”¯æŒ async å±æ€§ã€‚ æ‰€æœ‰ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒ defer å±æ€§ã€‚ ","date":"2019-09-08","objectID":"/posts/async-defer/:6:0","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["JavaScript"],"content":"å‚è€ƒ https://www.growingwiththeweb.com/2014/02/async-vs-defer-attributes.html https://www.jianshu.com/p/17dc82bf08f1 ","date":"2019-09-08","objectID":"/posts/async-defer/:7:0","tags":["JavaScript","defer","async"],"title":"script çš„ä¸‰ç§åŠ è½½æ–¹å¼ (async, defer)","uri":"/posts/async-defer/"},{"categories":["Memo"],"content":"Sublime Text3 å¿«æ·é”®ä¸€è§ˆè¡¨ ","date":"2019-08-15","objectID":"/posts/sublime-text3/:0:0","tags":["Sublime","ä»–å±±ä¹‹çŸ³"],"title":"Sublime Text3 å¿«æ·é”®å¤§å…¨","uri":"/posts/sublime-text3/"},{"categories":["Memo"],"content":"tab è½¬ space æ‰“å¼€ Settings, åŠ å…¥å‡ è¡Œé…ç½® { \"color_scheme\": \"Packages/Color Scheme - Default/Monokai.sublime-color-scheme\", \"font_size\": 14, \"ignored_packages\": [ \"Vintage\" ], \"theme\": \"Adaptive.sublime-theme\", + \"expand_tabs_on_save\": true, + \"tab_size\": 2, + \"translate_tabs_to_spaces\": true } ","date":"2019-08-15","objectID":"/posts/sublime-text3/:1:0","tags":["Sublime","ä»–å±±ä¹‹çŸ³"],"title":"Sublime Text3 å¿«æ·é”®å¤§å…¨","uri":"/posts/sublime-text3/"},{"categories":["Memo"],"content":"é€‰æ‹©ç±» Ctrl+D é€‰ä¸­å…‰æ ‡æ‰€å çš„æ–‡æœ¬ï¼Œç»§ç»­æ“ä½œåˆ™ä¼šé€‰ä¸­ä¸‹ä¸€ä¸ªç›¸åŒçš„æ–‡æœ¬ã€‚ Alt+F3 é€‰ä¸­æ–‡æœ¬æŒ‰ä¸‹å¿«æ·é”®ï¼Œå³å¯ä¸€æ¬¡æ€§é€‰æ‹©å…¨éƒ¨çš„ç›¸åŒæ–‡æœ¬è¿›è¡ŒåŒæ—¶ç¼–è¾‘ã€‚ä¸¾ä¸ªæ —å­ï¼šå¿«é€Ÿé€‰ä¸­å¹¶æ›´æ”¹æ‰€æœ‰ç›¸åŒçš„å˜é‡åã€å‡½æ•°åç­‰ã€‚ Ctrl+L é€‰ä¸­æ•´è¡Œï¼Œç»§ç»­æ“ä½œåˆ™ç»§ç»­é€‰æ‹©ä¸‹ä¸€è¡Œï¼Œæ•ˆæœå’Œ Shift+â†“ æ•ˆæœä¸€æ ·ã€‚ Ctrl+Shift+L å…ˆé€‰ä¸­å¤šè¡Œï¼Œå†æŒ‰ä¸‹å¿«æ·é”®ï¼Œä¼šåœ¨æ¯è¡Œè¡Œå°¾æ’å…¥å…‰æ ‡ï¼Œå³å¯åŒæ—¶ç¼–è¾‘è¿™äº›è¡Œã€‚ Ctrl+Shift+M é€‰æ‹©æ‹¬å·å†…çš„å†…å®¹ï¼ˆç»§ç»­é€‰æ‹©çˆ¶æ‹¬å·ï¼‰ã€‚ä¸¾ä¸ªæ —å­ï¼šå¿«é€Ÿé€‰ä¸­åˆ é™¤å‡½æ•°ä¸­çš„ä»£ç ï¼Œé‡å†™å‡½æ•°ä½“ä»£ç æˆ–é‡å†™æ‹¬å·å†…é‡Œçš„å†…å®¹ã€‚ Ctrl+M å…‰æ ‡ç§»åŠ¨è‡³æ‹¬å·å†…ç»“æŸæˆ–å¼€å§‹çš„ä½ç½®ã€‚ Ctrl+Enter åœ¨ä¸‹ä¸€è¡Œæ’å…¥æ–°è¡Œã€‚ä¸¾ä¸ªæ —å­ï¼šå³ä½¿å…‰æ ‡ä¸åœ¨è¡Œå°¾ï¼Œä¹Ÿèƒ½å¿«é€Ÿå‘ä¸‹æ’å…¥ä¸€è¡Œã€‚ Ctrl+Shift+Enter åœ¨ä¸Šä¸€è¡Œæ’å…¥æ–°è¡Œã€‚ä¸¾ä¸ªæ —å­ï¼šå³ä½¿å…‰æ ‡ä¸åœ¨è¡Œé¦–ï¼Œä¹Ÿèƒ½å¿«é€Ÿå‘ä¸Šæ’å…¥ä¸€è¡Œã€‚ Ctrl+Shift+[ é€‰ä¸­ä»£ç ï¼ŒæŒ‰ä¸‹å¿«æ·é”®ï¼ŒæŠ˜å ä»£ç ã€‚ Ctrl+Shift+] é€‰ä¸­ä»£ç ï¼ŒæŒ‰ä¸‹å¿«æ·é”®ï¼Œå±•å¼€ä»£ç ã€‚ Ctrl+K+0 å±•å¼€æ‰€æœ‰æŠ˜å ä»£ç ã€‚ Ctrl+â† å‘å·¦å•ä½æ€§åœ°ç§»åŠ¨å…‰æ ‡ï¼Œå¿«é€Ÿç§»åŠ¨å…‰æ ‡ã€‚ Ctrl+â†’ å‘å³å•ä½æ€§åœ°ç§»åŠ¨å…‰æ ‡ï¼Œå¿«é€Ÿç§»åŠ¨å…‰æ ‡ã€‚ shift+â†‘ å‘ä¸Šé€‰ä¸­å¤šè¡Œã€‚ shift+â†“ å‘ä¸‹é€‰ä¸­å¤šè¡Œã€‚ Shift+â† å‘å·¦é€‰ä¸­æ–‡æœ¬ã€‚ Shift+â†’ å‘å³é€‰ä¸­æ–‡æœ¬ã€‚ Ctrl+Shift+â† å‘å·¦å•ä½æ€§åœ°é€‰ä¸­æ–‡æœ¬ã€‚ Ctrl+Shift+â†’ å‘å³å•ä½æ€§åœ°é€‰ä¸­æ–‡æœ¬ã€‚ Ctrl+Shift+â†‘ å°†å…‰æ ‡æ‰€åœ¨è¡Œå’Œä¸Šä¸€è¡Œä»£ç äº’æ¢ï¼ˆå°†å…‰æ ‡æ‰€åœ¨è¡Œæ’å…¥åˆ°ä¸Šä¸€è¡Œä¹‹å‰ï¼‰ã€‚ Ctrl+Shift+â†“ å°†å…‰æ ‡æ‰€åœ¨è¡Œå’Œä¸‹ä¸€è¡Œä»£ç äº’æ¢ï¼ˆå°†å…‰æ ‡æ‰€åœ¨è¡Œæ’å…¥åˆ°ä¸‹ä¸€è¡Œä¹‹åï¼‰ã€‚ Ctrl+Alt+â†‘ å‘ä¸Šæ·»åŠ å¤šè¡Œå…‰æ ‡ï¼Œå¯åŒæ—¶ç¼–è¾‘å¤šè¡Œã€‚ Ctrl+Alt+â†“ å‘ä¸‹æ·»åŠ å¤šè¡Œå…‰æ ‡ï¼Œå¯åŒæ—¶ç¼–è¾‘å¤šè¡Œã€‚ ","date":"2019-08-15","objectID":"/posts/sublime-text3/:2:0","tags":["Sublime","ä»–å±±ä¹‹çŸ³"],"title":"Sublime Text3 å¿«æ·é”®å¤§å…¨","uri":"/posts/sublime-text3/"},{"categories":["Memo"],"content":"ç¼–è¾‘ç±» Ctrl+J åˆå¹¶é€‰ä¸­çš„å¤šè¡Œä»£ç ä¸ºä¸€è¡Œã€‚ä¸¾ä¸ªæ —å­ï¼šå°†å¤šè¡Œæ ¼å¼çš„ CSS å±æ€§åˆå¹¶ä¸ºä¸€è¡Œã€‚ Ctrl+Shift+D å¤åˆ¶å…‰æ ‡æ‰€åœ¨æ•´è¡Œï¼Œæ’å…¥åˆ°ä¸‹ä¸€è¡Œã€‚ Tab å‘å³ç¼©è¿›ã€‚ Shift+Tab å‘å·¦ç¼©è¿›ã€‚ Ctrl+K+K ä»å…‰æ ‡å¤„å¼€å§‹åˆ é™¤ä»£ç è‡³è¡Œå°¾ã€‚ Ctrl+Shift+K åˆ é™¤æ•´è¡Œã€‚ Ctrl+/ æ³¨é‡Šå•è¡Œã€‚ Ctrl+Shift+/ æ³¨é‡Šå¤šè¡Œã€‚ Ctrl+K+U è½¬æ¢å¤§å†™ã€‚ Ctrl+K+L è½¬æ¢å°å†™ã€‚ Ctrl+Z æ’¤é”€ã€‚ Ctrl+Y æ¢å¤æ’¤é”€ã€‚ Ctrl+U è½¯æ’¤é”€ï¼Œæ„Ÿè§‰å’Œ Gtrl+Z ä¸€æ ·ã€‚ Ctrl+F2 è®¾ç½®ä¹¦ç­¾ Ctrl+T å·¦å³å­—æ¯äº’æ¢ã€‚ F6 å•è¯æ£€æµ‹æ‹¼å†™ ","date":"2019-08-15","objectID":"/posts/sublime-text3/:3:0","tags":["Sublime","ä»–å±±ä¹‹çŸ³"],"title":"Sublime Text3 å¿«æ·é”®å¤§å…¨","uri":"/posts/sublime-text3/"},{"categories":["Memo"],"content":"æœç´¢ç±» Ctrl+F æ‰“å¼€åº•éƒ¨æœç´¢æ¡†ï¼ŒæŸ¥æ‰¾å…³é”®å­—ã€‚ Ctrl+shift+F åœ¨æ–‡ä»¶å¤¹å†…æŸ¥æ‰¾ï¼Œä¸æ™®é€šç¼–è¾‘å™¨ä¸åŒçš„åœ°æ–¹æ˜¯ sublime å…è®¸æ·»åŠ å¤šä¸ªæ–‡ä»¶å¤¹è¿›è¡ŒæŸ¥æ‰¾ï¼Œç•¥é«˜ç«¯ï¼Œæœªç ”ç©¶ã€‚ Ctrl+P æ‰“å¼€æœç´¢æ¡†ã€‚ä¸¾ä¸ªæ —å­ï¼š1ã€è¾“å…¥å½“å‰é¡¹ç›®ä¸­çš„æ–‡ä»¶åï¼Œå¿«é€Ÿæœç´¢æ–‡ä»¶ï¼Œ2ã€è¾“å…¥@å’Œå…³é”®å­—ï¼ŒæŸ¥æ‰¾æ–‡ä»¶ä¸­å‡½æ•°åï¼Œ3ã€è¾“å…¥ï¼šå’Œæ•°å­—ï¼Œè·³è½¬åˆ°æ–‡ä»¶ä¸­è¯¥è¡Œä»£ç ï¼Œ4ã€è¾“å…¥#å’Œå…³é”®å­—ï¼ŒæŸ¥æ‰¾å˜é‡åã€‚ Ctrl+G æ‰“å¼€æœç´¢æ¡†ï¼Œè‡ªåŠ¨å¸¦ï¼šï¼Œè¾“å…¥æ•°å­—è·³è½¬åˆ°è¯¥è¡Œä»£ç ã€‚ä¸¾ä¸ªæ —å­ï¼šåœ¨é¡µé¢ä»£ç æ¯”è¾ƒé•¿çš„æ–‡ä»¶ä¸­å¿«é€Ÿå®šä½ã€‚ Ctrl+R æ‰“å¼€æœç´¢æ¡†ï¼Œè‡ªåŠ¨å¸¦@ï¼Œè¾“å…¥å…³é”®å­—ï¼ŒæŸ¥æ‰¾æ–‡ä»¶ä¸­çš„å‡½æ•°åã€‚ä¸¾ä¸ªæ —å­ï¼šåœ¨å‡½æ•°è¾ƒå¤šçš„é¡µé¢å¿«é€ŸæŸ¥æ‰¾æŸä¸ªå‡½æ•°ã€‚ Ctrl+ï¼š æ‰“å¼€æœç´¢æ¡†ï¼Œè‡ªåŠ¨å¸¦#ï¼Œè¾“å…¥å…³é”®å­—ï¼ŒæŸ¥æ‰¾æ–‡ä»¶ä¸­çš„å˜é‡åã€å±æ€§åç­‰ã€‚ Ctrl+Shift+P æ‰“å¼€å‘½ä»¤æ¡†ã€‚åœºæ™¯æ —å­ï¼šæ‰“å¼€å‘½åæ¡†ï¼Œè¾“å…¥å…³é”®å­—ï¼Œè°ƒç”¨ sublime text æˆ–æ’ä»¶çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ä½¿ç”¨ package å®‰è£…æ’ä»¶ã€‚ Esc é€€å‡ºå…‰æ ‡å¤šè¡Œé€‰æ‹©ï¼Œé€€å‡ºæœç´¢æ¡†ï¼Œå‘½ä»¤æ¡†ç­‰ã€‚ ","date":"2019-08-15","objectID":"/posts/sublime-text3/:4:0","tags":["Sublime","ä»–å±±ä¹‹çŸ³"],"title":"Sublime Text3 å¿«æ·é”®å¤§å…¨","uri":"/posts/sublime-text3/"},{"categories":["Memo"],"content":"æ˜¾ç¤ºç±» Ctrl+Tab æŒ‰æ–‡ä»¶æµè§ˆè¿‡çš„é¡ºåºï¼Œåˆ‡æ¢å½“å‰çª—å£çš„æ ‡ç­¾é¡µã€‚ Ctrl+PageDown å‘å·¦åˆ‡æ¢å½“å‰çª—å£çš„æ ‡ç­¾é¡µã€‚ Ctrl+PageUp å‘å³åˆ‡æ¢å½“å‰çª—å£çš„æ ‡ç­¾é¡µã€‚ Alt+Shift+1 çª—å£åˆ†å±ï¼Œæ¢å¤é»˜è®¤ 1 å±ï¼ˆéå°é”®ç›˜çš„æ•°å­—ï¼‰ Alt+Shift+2 å·¦å³åˆ†å±-2 åˆ— Alt+Shift+3 å·¦å³åˆ†å±-3 åˆ— Alt+Shift+4 å·¦å³åˆ†å±-4 åˆ— Alt+Shift+5 ç­‰åˆ† 4 å± Alt+Shift+8 å‚ç›´åˆ†å±-2 å± Alt+Shift+9 å‚ç›´åˆ†å±-3 å± Ctrl+K+B å¼€å¯/å…³é—­ä¾§è¾¹æ ã€‚ F11 å…¨å±æ¨¡å¼ Shift+F11 å…æ‰“æ‰°æ¨¡å¼ ","date":"2019-08-15","objectID":"/posts/sublime-text3/:5:0","tags":["Sublime","ä»–å±±ä¹‹çŸ³"],"title":"Sublime Text3 å¿«æ·é”®å¤§å…¨","uri":"/posts/sublime-text3/"},{"categories":["Memo"],"content":"å®‰è£ å®˜æ–¹ä¸‹è¼‰é» ","date":"2019-08-15","objectID":"/posts/netbeans/:1:0","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"æ“´å……åŠŸèƒ½ ","date":"2019-08-15","objectID":"/posts/netbeans/:2:0","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"å®‰è£æ“´å……åŠŸèƒ½ ä¸‹è¼‰æ“´å……å¥—ä»¶åŒ… å®˜æ–¹å¥—ä»¶åº« æˆ–è€…åœ¨ NetBeans IDE è£é¢ä¸‹è¼‰æ’ä»¶ï¼ˆæ–¹ä¾¿ï¼‰ é–‹å•Ÿ NetBeansâ†’Toolsâ†’Pluginsâ†’Downloadedâ†’Add Plugins é¸æ“‡è¦å®‰è£çš„æ“´å……å¥—ä»¶åŒ… ","date":"2019-08-15","objectID":"/posts/netbeans/:2:1","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"å•Ÿç”¨å·²å®‰è£çš„æ“´å……åŠŸèƒ½ é–‹å•Ÿ NetBeansâ†’Toolsâ†’Pluginsâ†’Installed é¸æ“‡è¦å•Ÿç”¨çš„å¥—ä»¶ (*.npm) é»æ“Š Activate ","date":"2019-08-15","objectID":"/posts/netbeans/:2:2","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"åŒ¯å…¥è¨­å®š é–‹å•Ÿ NetBeansâ†’Toolsâ†’Options é»æ“Š Import åŒ¯å…¥è¨­å®š é¸æ“‡è¦åŒ¯å…¥çš„å¥—ä»¶åŒ… (*.zip) ","date":"2019-08-15","objectID":"/posts/netbeans/:2:3","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"å¸¸ç”¨è¨­å®š ","date":"2019-08-15","objectID":"/posts/netbeans/:3:0","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"ç¨‹å¼ç¢¼æ’ç‰ˆ åœ¨ç¨‹å¼é–‹ç™¼ä¸­ï¼Œç¨‹å¼ç¢¼æ’ç‰ˆå¾ˆé‡è¦ã€‚ä¸€å€‹å¥½çš„æ’ç‰ˆåˆ©æ–¼é–‹ç™¼äººå“¡ç¨‹å¼é–±è®€ï¼Œä¹Ÿä¾¿æ–¼å¾ŒæœŸç¶­è­·äººå“¡é–±è®€ã€‚ åœ¨ NetBeans ä¸­è¨­ç½®ç¨‹å¼ç¢¼æ’ç‰ˆ æ‰“é–‹ NetBeans-\u003eTools-\u003eOptions-\u003eEditor-\u003eFormattingï¼› Language é¸æ“‡ All Languagesï¼Œå‹¾é¸\"Expand Tabs to Spaces\", ç”¨å…©å€‹ç©ºæ ¼éµä»£æ›¿ Tab éµï¼Œé¦–è¡Œç•™å…©å€‹ Tab éµã€‚ é»æ“Š Apply æˆ– Ok å®Œæˆè¨­ç½®ã€‚å…·é«”è¨­ç½®åŠæ•ˆæœå¦‚ä¸‹åœ–æ‰€ç¤ºï¼š ","date":"2019-08-15","objectID":"/posts/netbeans/:3:1","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"ç¨‹å¼ç¢¼æ¨£æ¿ ç¨‹å¼ç¢¼æ¨£æ¿å¯ä»¥å¹«åŠ©ä½ å¿«é€Ÿæ›¸å¯«ç¨‹åºï¼Œä¸å¿…ç¹ç‘£åœ°è²æ˜å‡½æ•¸æˆ–å…¶ä»–ä»£ç¢¼å¡Šï¼Œæ›´å°ˆæ³¨èˆ‡é‚è¼¯çš„æ›¸å¯«ã€‚ åœ¨ NetBeans ä¸­è¨­ç½®ç¨‹å¼ç¢¼æ¨£æ¿ æ‰“é–‹ NetBeansâ†’Toolsâ†’Optionsâ†’Editorâ†’Code Templatesï¼› é¸æ“‡ä½ æ‰€ç”¨çš„èªè¨€ï¼ˆé€™è£¡ä»¥ JavaScript ç‚ºä¾‹ï¼‰ï¼› é»æ“Š\"New\"æ–°å»ºå±¬æ–¼ä½ çš„æˆ–ä¿®æ”¹åŸæœ‰çš„ç¨‹å¼ç¢¼æ¨£æ¿ï¼ˆä¾‹å­åƒ…ç‚ºæ¼”ç¤ºï¼‰ï¼› åœ¨ç·¨ç¨‹ä¸­æ‡‰ç”¨å®ƒã€‚ ","date":"2019-08-15","objectID":"/posts/netbeans/:3:2","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"å‰ç«¯å£“ç¸® ä¸‹è¼‰æ“´å……å¥—ä»¶netbeans minify æˆ–è€… minifierBeans é–‹å•Ÿ NetBeansâ†’Toolsâ†’Pluginsâ†’Downloadedâ†’Add Plugins é¸æ“‡ä½ ä¸‹è¼‰çš„æ“´å……å¥—ä»¶é–‹å•Ÿ é–‹å•Ÿ NetBeansâ†’Toolsâ†’options ","date":"2019-08-15","objectID":"/posts/netbeans/:3:3","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"å¿«æ·éµ é”®ä½ ä½œç”¨ Ctrl+/ æ³¨é‡Šä¸€è¡Œï¼ˆæˆ–é€‰ä¸­éƒ¨åˆ†ï¼‰ Ctrl+X å‰ªåˆ‡ä¸€è¡Œï¼ˆæˆ–é€‰ä¸­éƒ¨åˆ†ï¼‰ Ctrl+E åˆ é™¤ä¸€è¡Œï¼ˆæˆ–é€‰ä¸­éƒ¨åˆ†ï¼‰ Shift+Alt+ä¸Šä¸‹æ–¹å‘é”® ç§»åŠ¨å½“å‰è¡Œ Ctrl+Shift+ä¸Šä¸‹æ–¹å‘é”® å¤åˆ¶å½“å‰è¡Œï¼ˆè¯¥æ“ä½œå¹¶éå¤åˆ¶åˆ°ç²˜è´´æ¿ï¼‰ Shift+Alt+F æ•´ç†ä»£ç  TAB ä»£ç¢¼è‡ªå‹•è£œå…¨/ç¼©è¿›/é¸ä¸­æ–‡å­—åŒæ™‚ç¼©è¿› Shift+TAB é¸ä¸­æ–‡å­—åŒæ™‚å–æ¶ˆç¼©è¿› Ctrl+F æŸ¥æ‰¾æŸä¸ªå­— Ctrl+Shift+F æ•´ä¸ªé¡¹ç›®ä¸­æŸ¥æ‰¾æŸä¸ªå­— Ctrl+H æ›¿æ¢æŸä¸ªå­— Ctrl+Enter å¢åŠ ç©ºç™½è¡Œï¼Œå…‰æ ‡ä¸åŠ¨ã€‚ Ctrl+(0~7) æ‰“å¼€å„ç§å°çª—å£ Shift+æ–¹å‘é”® é¸ä¸­æ–‡å­— Ctrl+Alt+Space ä»£ç è¾“å…¥æç¤ºï¼Œä¸ä¹ æƒ¯çš„å¯ä»¥è®¾ç½®ä¸º (Alt+/)ï¼Œè¶…çº§å¥½ç”¨ï¼ï¼ï¼ Ctrl+Shift+F5 è°ƒè¯•å½“å‰ç¨‹åº Shift+F6 è¿è¡Œå½“å‰ç¨‹åº F6 è¿è¡Œä¸»ç¨‹åº Alt+Enter æ˜¾ç¤ºç¨‹å¼ bug å»ºè®®æˆ–è€…è­¦ç¤ºç­‰ NetBeans ä¸­å¸¸ç”¨çš„å¿«æ·éµ â†‘ï¼š ä¸‰ç¨®è¤‡è£½è¡Œæ–¹æ³• å¤åˆ¶ä¸€è¡Œï¼šCtrl + Shift + ä¸Šä¸‹æ–¹å‘é”®ï¼ˆè¯¥æ“ä½œå¹¶éå¤åˆ¶åˆ°ç²˜è´´æ¿ï¼‰ï¼› å¤åˆ¶ä¸€è¡Œï¼šåœ¨è¯¥è¡Œä»»ä½•åœ°æ–¹è¿ç»­ä¸‰å‡»é€‰ä¸­ä¸€æ ·ï¼Œç„¶å Ctrl + C å³å¯å¤åˆ¶ä¸€è¡Œã€‚ï¼› å¤åˆ¶ä¸€è¡Œï¼ˆä½¿ç”¨å®ï¼‰: ç¼–è¾‘-å¼€å§‹å½•åˆ¶å® (Home,Shift + End,Ctrl + C)-åœæ­¢å½•åˆ¶å®-è®¾ç½®å®åç§°ï¼ˆå¦‚ select-entire-line)-è®¾ç½®å¿«æ·é”®ï¼ˆå¦‚ Ctrl + Alt + C)ï¼› ä¹Ÿå¯è‡ªå·±ä¿®æ”¹å¿«æ·éµ (Toolsâ†’Optionsâ†’Keympa), å¦‚ä¸‹åœ– {% asset_img quickkey.png quickkey %} ","date":"2019-08-15","objectID":"/posts/netbeans/:3:4","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"é ç¨‹é–‹ç™¼ (FTP) å·¥ä½œä¸ºä¾‹ æ–°å»ºé¡¹ç›® æ‰“å¼€è½¯ä»¶ï¼Œè¿›å…¥æ–°å»ºé¡¹ç›®é¡µé¢ï¼ˆFile-New Projectï¼‰ï¼Œæ–°å»º php é¡¹ç›®ï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªï¼ˆPHP-PHP Applicationï¼‰ é¡¹ç›®åå’Œåœ°å€è‡ªå·±é€‰æ‹©ï¼ˆæ³¨æ„ï¼Œé€‰æ‹©åœ°å€åéœ€åœ¨åœ°å€æœ€åé¢åŠ ä¸Š\"/é¡¹ç›®å\"ï¼‰ FTP è®¾ç½® ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè¿›å…¥ FTP è®¾ç½®ï¼ŒRun As é€‰æ‹© Remote Web Site(FTP,SFTP) Project URL å¡«å†™http://127.0.0.1/training/å·¥å· Manage è®¾ç½® ç‚¹å‡» Manage, è¿›å…¥é¡µé¢ã€‚åå­—è‡ªå–ã€‚Host Name å¡«å†™ï¼š127.0.0.1 Encryption é€‰æ‹© Pure FTP,User Name å’Œ Passwordï¼ˆå¡«å†™å·¥å·/è¯¾åŠ¡ç³»ç»Ÿç™»å½•å¯†ç ï¼‰ Initial Directory å¡«å†™_training ç‚¹å‡» Test Connection æµ‹è¯•æ˜¯å¦è¿æ¥æˆåŠŸ å…¶ä»–è®¾ç½® Upload Directory, ä¸Šä¼ ç›®å½•ä¸å¡«ï¼Œç›´æ¥ä¸Šä¼ è‡³ä¸ªäººæ ¹ç›®å½• Upload File æ”¹ä¸ºä¿å­˜æ—¶ä¸Šä¼ æ–‡ä»¶ï¼ˆOn Saveï¼‰ ","date":"2019-08-15","objectID":"/posts/netbeans/:3:5","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Memo"],"content":"Chrome with NetNeans Connector æ‰“é–‹ chrome ä¸­çš„æ‡‰ç”¨ç¨‹å¼å•†åº—ï¼ˆä½¿ç”¨ chrome ç€è¦½å™¨é»æ“Šä¸‹æ–¹éˆæ¥å³å¯ï¼‰ chrome æ‡‰ç”¨ç¨‹å¼å•†åº— åœ¨æœç´¢æ¡†ä¸­è¼¸å…¥ NetNeans Connector åæœç´¢ï¼Œç„¶å¾Œé»æ“Šå³é‚Šçš„åŠ åˆ° Chrome å³å¯ï¼Œå®‰è£æˆåŠŸåå³ä¸Šè§’æœƒé¡¯ç¤º NetBeans åœ–æ¨™ã€‚ é–‹å•Ÿ netbeans é¸æ“‡ Runâ†’Set Project Browserâ†’ é¸ä¸­ Chrome with NetBeans Connector é¸æ“‡ default ä¸‹çš„ Customize â†’ é¸æ“‡ Browser â†’ é¸æ“‡ Browser ä¸‹ Chrome with NetBeans Connector å³å¯ ","date":"2019-08-15","objectID":"/posts/netbeans/:3:6","tags":["NetBeans","PHP"],"title":"NetBeans IDE å¼€å‘è®¾ç½®","uri":"/posts/netbeans/"},{"categories":["Spec"],"content":"ç²¾ç¥ ç»ä¸å†™æ­»ä»£ç ï¼Œç¡¬ç¼–ç  ä¸ç•™ä¸è¦ç”¨çš„ã€åƒåœ¾ä»£ç  ","date":"2019-08-15","objectID":"/posts/dev-rules/:1:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"Git Master çš„ BUG å¿…é¡»æœ€å°‘ä¸”è¶‹è¿‘äºé›¶ï¼Œä¸ºæœ€ç¨³å®šçš„ç‰ˆæœ¬ æ¯æ¬¡ Commit ä¿¡æ¯åº”è¯¥å‡†ç¡®å¡«å†™ã€‚ä¸å¯æ¨¡æ£±ä¸¤å¯ï¼Œeg: ä¿®å¤ BUGã€å¢åŠ åŠŸèƒ½ ç¦æ­¢ Commit IDE çš„ project dataï¼Œe.g: .vscode ç¦æ­¢ä¸Šä¼ åƒåœ¾ä»£ç  æ›´å¤šè§„åˆ™è¯¦è§æ–‡æ¡£ Commit è§„èŒƒ ","date":"2019-08-15","objectID":"/posts/dev-rules/:2:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"åˆ†æ”¯ï¼ˆBranchï¼‰ å‘½åè§„åˆ™ï¼šåº”ä»¥æ­¤åˆ†æ”¯ä¸»è¦ç›®çš„å‘½åï¼ˆä¿®å¤ä»€ä¹ˆ BUGï¼Œæ–°å¢ç‰¹å®šåŠŸèƒ½ï¼‰ åˆå¹¶åçš„åˆ†æ”¯åº”è¯¥åˆ é™¤ ","date":"2019-08-15","objectID":"/posts/dev-rules/:2:1","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"commit éµå¾ªä¸€ä¸ªåŠŸèƒ½ä¸€ä¸ª commit çš„åŸåˆ™ ","date":"2019-08-15","objectID":"/posts/dev-rules/:2:2","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"Restful èµ„æºåè¯ç«™åœ¨ API çš„è§’åº¦æ€è€ƒ å¤æ•°åè¯ï¼šå¯ä»¥å¤æ•°ç¬”æ•°æ®ï¼Œå›ä¼ ç»“æœä¸º Array ä¸¾ä¾‹ï¼šGET/users å–å¾—å¤šç¬”ä½¿ç”¨è€…èµ„æ–™ åˆªé™¤ï¼Œæ”¾åœ¨å¤æ•°åè¯å…§ï¼Œè®© Router ä¿æŒä¸€è‡´æ€§ å¢åŠ ï¼Œæ”¾åœ¨å¤æ•°åè©å…§ï¼Œè®© Router ä¿æŒä¸€è‡´æ€§ å•æ•°åè¯ï¼šä»…å–å¾—å•ç¬”æ•°æ®ï¼Œå¿…é¡»æŒ‡å®š PKï¼Œä¸¤ä¸¤ä¸€ç»„ï¼Œå›ä¼ ç»“æœä¸º Object ä¸¾ä¾‹ï¼šGET/user/{accont} å–å¾—å•ç¬”ä½¿ç”¨è€…èµ„æ–™ï¼Œå¿…é¡»æŒ‡å®š PK URL ä¸­ä¸€å¾‹ä¸å¸¦ id å‚æ•° æ­£ç¡®èŒƒä¾‹ï¼š calendar_manager/calendar/29 é”™è¯¯èŒƒä¾‹ï¼š calendar_manager/calendar/29?id=29 æ›´å¤šè§„åˆ™è¯¦è§æ–‡æ¡£ RESTful ","date":"2019-08-15","objectID":"/posts/dev-rules/:3:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"å‘½å å‘½ååº”æ ¹æ®å†…å®¹åšæœ‰æ„ä¹‰çš„å‘½åï¼Œè®©åç»­ç»´æŠ¤äººå‘˜å¯ä»¥é¡¾åæ€ä¹‰ï¼ å³ä½¿ä¸ä¼šå‘ç”Ÿé”™è¯¯ï¼Œä»£ç è‹±æ–‡å¤§å°å†™ä¹Ÿéœ€æ˜ç¡®åŒºåˆ†ã€‚ ","date":"2019-08-15","objectID":"/posts/dev-rules/:4:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"è¯­æ„ ç±»å‹ å‘½åè§„åˆ™ è¯´æ˜ å±æ€§ (Attribute, Property) åè¯ user_nameã€userName æ–¹æ³• (Method, Function) åŠ¨è¯ + åè¯ getUserNameã€get_user_name å¸¸è¦‹çš„åŠ¨è¯æœ‰ï¼šgetã€setã€updateã€deleteã€remove ","date":"2019-08-15","objectID":"/posts/dev-rules/:4:1","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"å­—æ¯ä¸åˆ†éš” è¯­è¨€ å˜é‡ (Variable, Parameter, Argument) å¸¸é‡ (Constant) é¢å‘å¯¹è±¡ - ç±»å (Class Name) é¢å‘å¯¹è±¡ - æˆå‘˜ (mebmer) HTML å…¨éƒ¨å°å†™ï¼Œä¸åŒå•è¯ä»¥ã€Œ-ã€åˆ†éš” e.g: user-id CSSã€SCSS å…¨éƒ¨å°å†™ï¼Œä¸åŒå•è¯ä»¥ã€Œ-ã€åˆ†éš”ï¼ŒCSS å˜é‡ä»¥ã€Œâ€“ã€å¼€å¤´ï¼ŒSCSS å˜é‡ä»¥ã€Œ$ã€å¼€å¤´ e.g: .user-idã€â€“header-heightã€$header-height JavaScript é©¼å³°å¼å‘½åæ³• é¦–å­—å°å†™ï¼Œä¸åŒå•å­—ã€Œé¦–å­—ä»¥å¤§å†™ã€åˆ†éš” e.g: userId å…¨éƒ¨å¤§å†™ï¼Œä¸åŒå•å­—ä»¥ã€Œ_ã€åˆ†éš” MAX_COUNT é©¼å³°å¼å‘½åæ³• é¦–å­—å¤§å†™ï¼Œä¸åŒå•å­—ã€Œé¦–å­—ä»¥å¤§å†™ã€åˆ†éš” ä¸€ä¸ªæ–‡ä»¶æ”¾ä¸€ä¸ª Class, æ–‡ä»¶åå³ä¸º Class Name e.g: User é©¼å³°å¼å‘½åæ³• å…¬æœ‰ (public) : é¦–å­—å°å†™ï¼Œä¸åŒå•è¯ã€Œé¦–å­—ä»¥å¤§å†™ã€åˆ†éš” e.g: name, getName ç§æœ‰ (private): _å…¬æœ‰å‘½åè§„åˆ™ e.g: _name,_getName Vue Java PHP å…¨éƒ¨å°å†™ï¼Œä¸åŒå•è¯ä»¥ã€Œ_ã€åˆ†éš” e.g: user_id Python SQL ç”±ä½¿ç”¨è€…å®šä¹‰çš„ï¼šè¡¨åã€å­—æ®µå å…¨éƒ¨å°å†™ï¼Œä¸åŒå•è¯ä»¥ã€Œ_ã€åˆ†éš” SQL è¯­æ³•ã€å‡½æ•°å…¨éƒ¨å¤§å†™ e.g: SELECTã€INSERT INTO ","date":"2019-08-15","objectID":"/posts/dev-rules/:4:2","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"é€šç”¨ ä»£ç ç¼–å†™ æ¯ä¸ªå‡½æ•°åº”è¯¥ä½¿ç”¨å—æ³¨é‡Šï¼Œæ³¨é‡Šåº”åŒ…å«å‡½æ•°åŠŸèƒ½è¯´æ˜ã€å‚æ•°è¯´æ˜ã€‚è§„åˆ™è§ï¼šJSDocã€JavaDoc ä¸å¿…è¦çš„ä»£ç ä¸è¦å†™ï¼Œä¹Ÿåº”ç¦æ­¢æ”¾åˆ°æ³¨é‡Šé‡Œé¢ï¼ if-else çš„ {} ä¸¥ç¦çœç•¥ ä»£ç è§„èŒƒã€ä»£ç æ’ç‰ˆç­‰å¯é€šè¿‡ eslint ç­‰å·¥å…·åšç»Ÿä¸€å¤„ç† ","date":"2019-08-15","objectID":"/posts/dev-rules/:5:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"æ­£ç¡®å†™æ³• public function test () { // do something if (a === b) { // do something } } ","date":"2019-08-15","objectID":"/posts/dev-rules/:5:1","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"é”™è¯¯å†™æ³• public function test () { // do something if (a === b) { // do something } } ä»£ç æ’ç‰ˆ ä»»ä½•ä»£ç åº”è¯¥ä»¥ 2 ä¸ª space ä¸ºä¸€ä¸ªç¼©è¿›åšå¥½æ’ç‰ˆã€ä¸å¯ä½¿ç”¨ tab å‡½æ•° (Function, Methd) å‡½æ•°å£°æ˜æ—¶éœ€åœ¨å‡½æ•°ä¸Šæ–¹åŠ ä¸Šå‡½æ•°æ³¨é‡Šï¼Œæ³¨é‡Šåº”åŒ…å«å‡½æ•°è¯´æ˜ã€å‚æ•°å†…å®¹ï¼ˆå‚æ•°ç±»å‹ã€å‚æ•°è‹±æ–‡åç§°ã€å‚æ•°è¯´æ˜ï¼‰ã€è¿”å›å€¼å†…å®¹ï¼ˆè¿”å›å€¼ç±»å‹ã€è¿”å›å€¼è¯´æ˜ï¼‰ ç±» (Class) ä¸€ä¸ªç±»ï¼ˆClassï¼‰çš„å£°æ˜åªèƒ½å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ ç±»ï¼ˆClassï¼‰çš„å£°æ˜æ–‡ä»¶ï¼Œæ–‡ä»¶åå¿…é¡»ä¸ºç±»å å…¶ä»– è¿æ¥æœ¬åœ°ä»»ä½•å…¶ä»–èµ„æºï¼ˆå›¾ç‰‡ã€æ–‡ä»¶ã€ç½‘ç«™ï¼‰çš†ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œç¦æ­¢ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œéæœ¬åœ°èµ„æºé™¤å¤– ","date":"2019-08-15","objectID":"/posts/dev-rules/:6:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"HTML ","date":"2019-08-15","objectID":"/posts/dev-rules/:7:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"ä»£ç ç¼–å†™ ç¦æ­¢åœ¨ HTML ä½¿ç”¨ \u003cstyle\u003eã€\u003cscript\u003eï¼Œä¸€å¾‹ä½¿ç”¨å¤–éƒ¨æ¡£æ¡ˆå¼•ç”¨æ–¹å¼å¼•ç”¨ CSSã€JavaScript æ–‡ä»¶ HTML æ ‡ç­¾éœ€æˆåŒæˆå¯¹ï¼Œæœ‰å¤´æœ‰å°¾ å—çº§æ ‡ç­¾ï¼š\u003ctag\u003e\u003c/tag\u003e å•æ ‡ç­¾ï¼š\u003ctag /\u003e ç¦æ­¢ä½¿ç”¨å·²è¢« HTML èˆå¼ƒçš„æ—§æ ‡ç­¾ã€å±æ€§ï¼Œå¦‚ï¼š \u003c!-- html tag --\u003e \u003ccenter\u003e \u003cfont\u003e \u003cbasefont\u003e \u003cs\u003e \u003cstrike\u003e \u003cu\u003e \u003clisting\u003e \u003cplaintext\u003e \u003cxmp\u003e \u003c!-- html attribute --\u003e align bgcolor color ","date":"2019-08-15","objectID":"/posts/dev-rules/:7:1","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"CSS CSS çš„å®šä¹‰åº”è¯¥ç‹¬ç«‹ä¸€ä¸ª CSS æ–‡ä»¶ï¼Œç¦æ­¢ä½¿ç”¨ \u003cstyle\u003e æˆ– style å±æ€§ç›´æ¥åœ¨ HTML ä¸­å®šä¹‰æ ·å¼ã€‚ ","date":"2019-08-15","objectID":"/posts/dev-rules/:8:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"JavaScript ç¦æ­¢ä½¿ç”¨ HTML å­—ä¸²ï¼Œä¸€å¾‹ä½¿ç”¨ Dom äº§ç”Ÿ HTML, e.g: document.createDocumentFragment() ","date":"2019-08-15","objectID":"/posts/dev-rules/:9:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"æ³¨é‡Š JavaScript æ³¨é‡Šåº”è¯¥éµå¾ª JSDoc çš„æ ‡å‡†æ’°å†™ å…¨å±€å˜é‡ (Global) /* global ZT */ å¸¸é‡ (Constant) /** * å¸¸é‡èªªæ˜ * @type {å¸¸é‡ç±»å‹} */ Example /** * è¯·æ±‚åœ°å€ * @type {String} */ const REQUEST_URL = 'http://localhost:8080'; å‡½æ•¸ã€æ–¹æ³• (Function, Method) /** * å‡½æ•°ç”¨é€”è¯´æ˜ * @param {å‚æ•°ç±»å‹} å‚æ•°åç§°å‚æ•°è¯´æ˜ * @param {å‚æ•°ç±»å‹} [é€‰æ‹©æ€§å‚æ•°åç§°] å‚æ•°è¯´æ˜ * @param {å‚æ•°ç±»å‹} [é€‰æ‹©æ€§å‚æ•°åç§°=å‚æ•°é¢„è®¾å€¼] å‚æ•°è¯´æ˜ * @returns {è¿”å›å€¼ç±»å‹} è¿”å›å€¼è¯´æ˜ */ Example /** * å–å¾—ä½¿ç”¨è€… * @param {Int} userId ä½¿ç”¨è€… ID * @param {Object} [options] å…¶ä»–é€‰é¡¹ * @param {String} [options.query='a'] æŸ¥è¯¢å…³é”®è¯ é»˜è®¤ä¸º 'a' * @returns {Object} ä½¿ç”¨è€…èµ„æ–™ */ function getUser(userId, options) { // do something return user; } ","date":"2019-08-15","objectID":"/posts/dev-rules/:9:1","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"Vue å¾…è¡¥å…… ","date":"2019-08-15","objectID":"/posts/dev-rules/:10:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"Java Java æ³¨é‡Šåº”è¯¥éµå¾ª JavaDoc çš„æ ‡å‡†æ’°å†™ å¾…è¡¥å…… ","date":"2019-08-15","objectID":"/posts/dev-rules/:11:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"PHP ","date":"2019-08-15","objectID":"/posts/dev-rules/:12:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"å‰ç«¯å‚æ•°å–å¾— å‚æ•°å–å¾—éœ€é€šè¿‡ filter_input å‡½æ•°å–å¾—ï¼Œä¸å¾—ä½¿ç”¨ _GET ã€_POST ","date":"2019-08-15","objectID":"/posts/dev-rules/:12:1","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"è¾“å‡ºåˆ°å‰å° å‚æ•°å‘½åå¿…é¡»ä¸ºï¼šå…¨éƒ¨å°å†™ï¼Œä¸åŒå•å­—ä»¥ã€Œ_ã€åˆ†éš” ","date":"2019-08-15","objectID":"/posts/dev-rules/:12:2","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"æ³¨è§£ PHP æ³¨è§£åº”è¯¥éµå¾ª PHPDoc çš„æ ‡å‡†æ’°å†™ ","date":"2019-08-15","objectID":"/posts/dev-rules/:12:3","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"æˆå‘˜å˜é‡ (Member) æˆå‘˜å˜é‡åªçš„æ˜¯ Class å†…çš„æˆå‘˜å˜æ•°ï¼Œæˆ‘ä»¬éƒ½ä¼šè¦æ±‚æ›¿æˆå‘˜å˜é‡å¢åŠ æ³¨è§£è¯´æ˜ã€‚é€šå¸¸ Function çš„å˜é‡é™¤éå¤ªç‰¹åˆ«å¦åˆ™éƒ½ä¸éœ€è¦ç‰¹åˆ«æ³¨è§£è¯´æ˜ã€‚ /** * æˆå‘˜å˜é‡èªªæ˜ * @type {ç±»å‹} */ Example /** * ä½¿ç”¨è€… ID * @type {String} */ $userId = 'Hello'; ","date":"2019-08-15","objectID":"/posts/dev-rules/:12:4","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"å‡½æ•°ã€æ–¹æ³• (Function, Method) /** * å‡½æ•°ç”¨é€”è¯´æ˜ * @param å‚æ•°å‹æ€ å‚æ•°åç§° å‚æ•°è¯´æ˜ * @option å‚æ•°é€‰é¡¹ç±»å‹ å‚æ•°é€‰é¡¹åç§° å‚æ•°é€‰é¡¹è¯´æ˜ * @uses å…¨å±€å˜é‡ å…¨åŸŸå˜æ•°è¯´æ˜ * @returns è¿”å›å€¼ç±»å‹ è¿”å›å€¼è¯´æ˜ */ Example /** * å–å¾—ä½¿ç”¨è€… * @param int userId ä½¿ç”¨è€… ID * @param object options å…¶ä»–é€‰é¡¹ * @option string options['query'] æŸ¥è¯¢å…³é”®å­— * @uses $_POST['role_id'] ä»å‰ç«¯ä»¥ POST å–å¾—è§’è‰² ID * @returns object ä½¿ç”¨è€…èµ„æ–™ */ function getUser ($userId, $options) { // do something return $user; }; ","date":"2019-08-15","objectID":"/posts/dev-rules/:12:5","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"Python å¾…è¡¥å…… ","date":"2019-08-15","objectID":"/posts/dev-rules/:13:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"Database ç¦æ­¢ä½¿ç”¨ Table Joinã€‚ ç¦æ­¢ä½¿ç”¨ Oracle Triggerã€‚ ç¦æ­¢å°†æŸ¥è¯¢æ•°æ®åº“çš„ SQL æ”¾åœ¨å¾ªç¯ä¸­æŸ¥è¯¢ ","date":"2019-08-15","objectID":"/posts/dev-rules/:14:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"SQL æ’°å†™ å±äº SQL è¯­æ³•ä½¿ç”¨å¤§å†™ï¼ˆSELECTï¼ŒWHEREï¼ŒINSERT etc..ï¼‰ å±äºä½¿ç”¨è€…è‡ªå·±å®šä¹‰çš„ä½¿ç”¨å°å†™ï¼ˆè¡¨å table nameï¼Œå­—æ®µå column name etc..ï¼‰ è¡¨åã€å­—æ®µåå‰åéœ€åŠ ä¸Š ` Example INSERT INTO `user` VALUES('a', 'b'); ","date":"2019-08-15","objectID":"/posts/dev-rules/:14:1","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["Spec"],"content":"ç»Ÿä¸€ç”¨è¯ ç³»ç»Ÿä¸­å¸¸ç”¨è¯ï¼Œä¾‹å¦‚å¼¹å‡ºæ¡†æŒ‰é’®ã€æœç´¢æ¡†ç­‰ï¼Œä»…ä¸ºä¸¾ä¾‹ï¼Œä¸é™ä¸æ­¤ã€‚ ç”¨è¯ ç»Ÿä¸€ æœ€åã€æœ€ç»ˆ æœ€å å…³é—­ã€Cancelã€å–æ¶ˆ å–æ¶ˆ å­˜å‚¨ã€ä¿å­˜ã€ä¿®æ”¹ã€OKã€ç¡®å®š ç¡®å®š æœå¯»ã€æŸ¥è¯¢ã€æŸ¥æ‰¾ã€æœç´¢ æœç´¢ ","date":"2019-08-15","objectID":"/posts/dev-rules/:15:0","tags":["Git","REST","HTML","CSS","Scss","JavaScript","Vue","Java","PHP","Python"],"title":"Web å¼€å‘è§„åˆ™ï¼Œä»£ç è§„èŒƒ","uri":"/posts/dev-rules/"},{"categories":["PHP"],"content":" ç®€å•æ¨¡ä»¿äº†ä¸€ä¸ªè¯„è®ºæ¨¡æ¿ï¼Œå½“ç„¶è‚¯å®šæ˜¯æ²¡æœ‰åšå®¢çš„ valine è¿™ä¹ˆå¼ºå¤§çš„ hhhhï¼Œ PHP è¡¨å•å®‰å…¨æ€§çš„é‡è¦æç¤º $_SERVER[\"PHP_SELF\"]å˜é‡èƒ½å¤Ÿè¢«é»‘å®¢åˆ©ç”¨ï¼ å¦‚æœé¡µé¢ä¸­ä½¿ç”¨äº†PHP_SELFï¼Œç”¨æˆ·èƒ½å¤Ÿè¾“å…¥ä¸‹åˆ’çº¿ç„¶åæ‰§è¡Œè·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰ã€‚ æ¯”å¦‚è¯´æ³¨å…¥ js è„šæœ¬ç­‰ï¼Œvaline ä»¥å‰çš„ç‰ˆæœ¬ä¹Ÿæœ‰è¿‡è¿™æ ·çš„æ¼æ´ã€‚ è·¨ç«™ç‚¹è„šæœ¬ï¼ˆCross-site scriptingï¼ŒXSSï¼‰æ˜¯ä¸€ç§è®¡ç®—æœºå®‰å…¨æ¼æ´ç±»å‹ï¼Œå¸¸è§äº Web åº”ç”¨ç¨‹åºã€‚XSS èƒ½å¤Ÿä½¿æ”»å‡»è€…å‘å…¶ä»–ç”¨æˆ·æµè§ˆçš„ç½‘é¡µä¸­è¾“å…¥å®¢æˆ·ç«¯è„šæœ¬ã€‚ å¯ä»¥åƒ valine ä¸€æ ·åœ¨ç”¨æˆ·è¾“å…¥å®Œåä¿ç•™è¾“å…¥ï¼Œè¿˜æœ‰ä¸€äº›æ­£åˆ™æ§åˆ¶è¾“å…¥æç¤ºç­‰ç®€å•åŠŸèƒ½ã€‚UI å°±ä¸‘çˆ†äº†ç®—äº†ã€‚ \u003c!DOCTYPE HTML\u003e \u003chtml\u003e \u003chead\u003e \u003cstyle\u003e .error {color: #FF0000;} .main{ width: 20%; height: 100%; border: 1px #000 solid; padding: 20px; } \u003c/style\u003e \u003c/head\u003e \u003cbody\u003e \u003c?php // å®šä¹‰å˜é‡å¹¶è®¾ç½®ä¸ºç©ºå€¼ $nameErr = $emailErr = $genderErr = $websiteErr = \"\"; $name = $email = $gender = $comment = $website = \"\"; if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") { if (empty($_POST[\"name\"])) { $nameErr = \"Name is required\"; } else { $name = test_input($_POST[\"name\"]); // æ£€æŸ¥åå­—æ˜¯å¦åŒ…å«å­—æ¯å’Œç©ºæ ¼ if (!preg_match(\"/^[a-zA-Z ]*$/\",$name)) { $nameErr = \"Only letters and white space allowed\"; } } if (empty($_POST[\"email\"])) { $emailErr = \"Email is required\"; } else { $email = test_input($_POST[\"email\"]); // æ£€æŸ¥ç”µé‚®åœ°å€è¯­æ³•æ˜¯å¦æœ‰æ•ˆ if (!preg_match(\"/([\\w\\-]+\\@[\\w\\-]+\\.[\\w\\-]+)/\",$email)) { $emailErr = \"Invalid email format\"; } } if (empty($_POST[\"website\"])) { $website = \"\"; } else { $website = test_input($_POST[\"website\"]); // æ£€æŸ¥ URL åœ°å€è¯­è¨€æ˜¯å¦æœ‰æ•ˆï¼ˆæ­¤æ­£åˆ™è¡¨è¾¾å¼åŒæ ·å…è®¸ URL ä¸­çš„ä¸‹åˆ’çº¿ï¼‰ if (!preg_match(\"/\\b(?:(?:https?|ftp):\\/\\/|www\\.)[-a-z0-9+\u0026@#\\/%?=~_|!:,.;]*[-a-z0-9+\u0026@#\\/% =~_|]/i\",$website)) { $websiteErr = \"Invalid URL\"; } } if (empty($_POST[\"comment\"])) { $comment = \"\"; } else { $comment = test_input($_POST[\"comment\"]); } if (empty($_POST[\"gender\"])) { $genderErr = \"Gender is required\"; } else { $gender = test_input($_POST[\"gender\"]); } } function test_input($data) { $data = trim($data); $data = stripslashes($data); $data = htmlspecialchars($data); return $data; } ?\u003e \u003cdiv class=\"main\"\u003e \u003ch2\u003ePHP éªŒè¯å®ä¾‹\u003c/h2\u003e \u003cform method=\"post\" action=\"\u003c?php echo htmlspecialchars($_SERVER['PHP_SELF']);?\u003e\"\u003e å§“åï¼š\u003cinput type=\"text\" name=\"name\" value=\"\u003c?php echo $name;?\u003e\"\u003e \u003cspan class=\"error\"\u003e* \u003c?php echo $nameErr;?\u003e\u003c/span\u003e \u003cbr\u003e\u003cbr\u003e æ€§åˆ«ï¼š \u003cinput type=\"radio\" name=\"gender\" \u003c?php if (isset($gender) \u0026\u0026 $gender==\"å¥³æ€§\") echo \"checked\";?\u003e value=\"å¥³æ€§\"\u003eå¥³æ€§ \u003cinput type=\"radio\" name=\"gender\" \u003c?php if (isset($gender) \u0026\u0026 $gender==\"ç”·æ€§\") echo \"checked\";?\u003e value=\"ç”·æ€§\"\u003eç”·æ€§ \u003cspan class=\"error\"\u003e* \u003c?php echo $genderErr;?\u003e\u003c/span\u003e \u003cbr\u003e\u003cbr\u003e ç”µé‚®ï¼š\u003cinput type=\"text\" name=\"email\" value=\"\u003c?php echo $email;?\u003e\"\u003e \u003cspan class=\"error\"\u003e* \u003c?php echo $emailErr;?\u003e\u003c/span\u003e \u003cbr\u003e\u003cbr\u003e ç½‘å€ï¼š\u003cinput type=\"text\" name=\"website\" value=\"\u003c?php echo $website;?\u003e\"\u003e \u003cspan class=\"error\"\u003e\u003c?php echo $websiteErr;?\u003e\u003c/span\u003e \u003cbr\u003e\u003cbr\u003e è¯„è®ºï¼š\u003ctextarea name=\"comment\" rows=\"5\" cols=\"40\"\u003e\u003c?php echo $comment;?\u003e\u003c/textarea\u003e \u003cbr\u003e\u003cbr\u003e \u003cinput type=\"submit\" name=\"submit\" value=\"æäº¤\"\u003e \u003ch2\u003eä½ çš„è¾“å…¥æ˜¯ï¼š\u003c/h2\u003e \u003c?php echo $name.\"\u003cbr/\u003e\"; echo $gender.\"\u003cbr/\u003e\"; echo $email.\"\u003cbr/\u003e\"; echo $website.\"\u003cbr/\u003e\"; echo $comment.\"\u003cbr/\u003e\"; ?\u003e \u003cbr/\u003e \u003c/form\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e ","date":"2019-07-19","objectID":"/posts/phpform/:0:0","tags":["PHP"],"title":"ç®€å•è¯„è®ºæ¨¡å—--php è¡¨å•ç»ƒä¹ ","uri":"/posts/phpform/"},{"categories":["PHP"],"content":" ç»ƒä¹  php å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨ã€‚ æ³¨ï¼š å¿…é€‰å‚æ•°åœ¨å¯é€‰å‚æ•°çš„å‰é¢ã€‚ å¯åœ¨å‡½æ•°ä¸­å®šä¹‰å‡½æ•°ï¼Œéœ€è¦å…ˆè°ƒç”¨å¤–å±‚å‡½æ•°æ‰èƒ½è°ƒç”¨å†…å±‚å‡½æ•°ã€‚ \u003c?php /* åˆ›å»ºè¡¨æ ¼ */ function createTable($rows,$cols,$bgcolor='pink',$content='x'){ $table = \"\u003ctable border='1' bgcolor='{$bgcolor}' cellpadding='10' cellspacing='0' width='50%' \u003e\"; for($i=1;$i\u003c=$rows;$i++){ $table.=\"\u003ctr\u003e\"; for($j=1;$j\u003c=$cols;$j++){ $table.=\"\u003ctd\u003e{$content}\u003c/td\u003e\"; } $table .=\"\u003c/tr\u003e\"; } $table.=\"\u003c/table\u003e\"; return $table; } echo createTable(5,5,'pink','hello lruihao'); ?\u003e ","date":"2019-07-15","objectID":"/posts/phpfunc/:0:0","tags":["PHP"],"title":"php å‡½æ•°å­¦ä¹ ","uri":"/posts/phpfunc/"},{"categories":["Memo"],"content":" ä½¿ç”¨ WAMPServer æ—¶è‡ªå®šä¹‰ç½‘ç«™æ ¹ç›®å½•ã€‚ ","date":"2019-07-12","objectID":"/posts/wamproot/:0:0","tags":["WAMP","PHP","windows","server"],"title":"WAMPServer è‡ªå®šä¹‰ç½‘ç«™æ ¹ç›®å½•ç­‰è®¾ç½®","uri":"/posts/wamproot/"},{"categories":["Memo"],"content":"WAMPServer è‡ªå®šä¹‰ç½‘ç«™æ ¹ç›®å½• ","date":"2019-07-12","objectID":"/posts/wamproot/:1:0","tags":["WAMP","PHP","windows","server"],"title":"WAMPServer è‡ªå®šä¹‰ç½‘ç«™æ ¹ç›®å½•ç­‰è®¾ç½®","uri":"/posts/wamproot/"},{"categories":["Memo"],"content":"ä¿®æ”¹ apache é…ç½®æ–‡ä»¶ æ‰“å¼€httpd.confæ–‡ä»¶æœç´¢documentrootåï¼Œæ‰¾åˆ°è·¯å¾„ä¿®æ”¹ä¸ºè‡ªå®šä¹‰çš„ã€‚ å†æ‰“å¼€httpd-vhost.confæ–‡ä»¶ä¿®æ”¹å¯¹åº”çš„è·¯å¾„ã€‚ ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶éœ€è¦é‡å¯æ‰€æœ‰æœåŠ¡ï¼ ","date":"2019-07-12","objectID":"/posts/wamproot/:1:1","tags":["WAMP","PHP","windows","server"],"title":"WAMPServer è‡ªå®šä¹‰ç½‘ç«™æ ¹ç›®å½•ç­‰è®¾ç½®","uri":"/posts/wamproot/"},{"categories":["Memo"],"content":"ä¿®æ”¹ wampmanager æ–‡ä»¶ åœ¨ wampserver å®‰è£…è·¯å¾„æ ¹ç›®å½•çŸ¥é“wampmanager.iniå’Œwampmanager.tplä¸¤ä¸ªæ–‡ä»¶ã€‚æœç´¢menu.left, ç„¶åä¹Ÿä¿®æ”¹ä¸ºè‡ªå®šä¹‰çš„è·¯å¾„ã€‚ ç„¶åé€€å‡ºï¼Œé‡å¯è½¯ä»¶ï¼ ","date":"2019-07-12","objectID":"/posts/wamproot/:1:2","tags":["WAMP","PHP","windows","server"],"title":"WAMPServer è‡ªå®šä¹‰ç½‘ç«™æ ¹ç›®å½•ç­‰è®¾ç½®","uri":"/posts/wamproot/"},{"categories":["Memo"],"content":"ç¼–å†™ php æ–‡ä»¶æµ‹è¯• \u003c?php echo \"hello world\"; ?\u003e ","date":"2019-07-12","objectID":"/posts/wamproot/:1:3","tags":["WAMP","PHP","windows","server"],"title":"WAMPServer è‡ªå®šä¹‰ç½‘ç«™æ ¹ç›®å½•ç­‰è®¾ç½®","uri":"/posts/wamproot/"},{"categories":["Memo"],"content":"WAMPServer å¤šç«™ç‚¹é…ç½® æ‰“å¼€httpd-vhost.confæ–‡ä»¶ï¼Œå¤åˆ¶åŸæœ‰çš„å‡ è¡Œé…ç½®æ–‡ä»¶ï¼Œç²˜è´´ä¿®æ”¹è·¯å¾„å’ŒåŸŸåç­‰é…ç½®ã€‚æ¯”å¦‚ ## Virtual Hosts # \u003cVirtualHost *:80\u003e ServerName localhost ServerAlias localhost DocumentRoot \"g:/Demo\" \u003cDirectory \"g:/Demo\"\u003e Options +Indexes +Includes +FollowSymLinks +MultiViews AllowOverride All Require local \u003c/Directory\u003e \u003c/VirtualHost\u003e \u003cVirtualHost *:80\u003e ServerName test01.com DocumentRoot \"g:/Demo/test01\" \u003c/VirtualHost\u003e \u003cVirtualHost *:80\u003e ServerName test02.com DocumentRoot \"g:/Demo/test02\" \u003c/VirtualHost\u003e å†æ‰“å¼€C:\\Windows\\System32\\drivers\\etc\\hostsæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åæ·»åŠ ç±»ä¼¼äºäº‘æœåŠ¡å™¨çš„åŸŸåè§£æï¼Œè¿›è¡Œæœ¬åœ°åŸŸåè§£æï¼Œå½“è¾“å…¥åŸŸåæ—¶ä¼˜å…ˆä»æœ¬åœ°ç”³è¯·èµ„æºã€‚ ... ## For example: # ## 102.54.94.97 rhino.acme.com ## source server ## 38.25.63.10 x.acme.com ## x client host ## localhost name resolution is handled within DNS itself. # 127.0.0.1 localhost # ::1 localhost 127.0.0.1 steamcommunity.com 192.168.28.1 windows10.microdone.cn 127.0.0.1 localhost ::1 localhost 127.0.0.1 test01.com 127.0.0.1 test02.com ","date":"2019-07-12","objectID":"/posts/wamproot/:2:0","tags":["WAMP","PHP","windows","server"],"title":"WAMPServer è‡ªå®šä¹‰ç½‘ç«™æ ¹ç›®å½•ç­‰è®¾ç½®","uri":"/posts/wamproot/"},{"categories":["Memo"],"content":"WAMPServer è‡ªæ‹Ÿå®šç«¯å£ WAMP æœåŠ¡æˆ‘å®‰è£…äº†å¥½å‡ æ¬¡ï¼Œæ¯æ¬¡å› ä¸ºä¿®æ”¹é…ç½®æ–‡ä»¶æå´©äº†ã€‚ç¬¬ä¸€æ¬¡è£…çš„æ—¶å€™å‘ç° 80 ç«¯å£è¢«å ç”¨äº†ï¼Œå› ä¸ºä»¥å‰ç©äº†ä¸€ä¸‹ Windows çš„ IISï¼Œæš‚åœ IIS çš„ç½‘ç«™ï¼Œå†ä½¿ç”¨å‘½ä»¤æˆ–è€…ç›´æ¥åœ¨æ§åˆ¶é¢æ¿å…³æ‰å°±å¥½äº†ã€‚ å¦‚æœä¸ä½¿ç”¨ 80 å¤šä¸ºé»˜è®¤ç«¯å£ï¼Œæ¯”å¦‚ä¿®æ”¹ä¸º 8080ï¼Œè¿˜æ˜¯åœ¨httpd.confæ–‡ä»¶é‡Œä¿®æ”¹ã€‚æœç´¢80éƒ½æ”¹æˆ8080ç„¶åï¼ŒCtrl+S ä¿å­˜ï¼Œé‡æ–°å¯åŠ¨ WampServer åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥localhost:8000 #ç›‘å¬ç«¯å£ Listen 0.0.0.0:8080 Listen [::0]:8080 ServerName localhost:8080 ä½¿ç”¨ Notepad++æ‰“å¼€ C:\\wamp ç›®å½•ä¸‹çš„ wampmanager.ini å’Œ wampmanager.tpl Ctrl+F æŸ¥æ‰¾ localhost å°†å…¶å…¨éƒ¨æ›¿æ¢ä¸ºlocalhost:8000 ç„¶åï¼ŒCtrl+S ä¿å­˜ï¼Œé‡æ–°å¯åŠ¨ WampServer ","date":"2019-07-12","objectID":"/posts/wamproot/:3:0","tags":["WAMP","PHP","windows","server"],"title":"WAMPServer è‡ªå®šä¹‰ç½‘ç«™æ ¹ç›®å½•ç­‰è®¾ç½®","uri":"/posts/wamproot/"},{"categories":["Python"],"content":" åé¢å‡ å¤©è®²çš„æœ‰ç‚¹æ‚ï¼Œç®€å•è®°å½•ä¸€ä¸‹çŸ¥è¯†ç‚¹ã€‚ ","date":"2019-06-21","objectID":"/posts/pysx2/:0:0","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"6.19 è¿™äº›çŸ¥è¯†ç‚¹åœ¨è¯¾ä¸Šéƒ½åªæ˜¯ç®€å•çš„æåˆ°äº†ä¸€ä¸‹ã€‚ æ¯”å¦‚ä¸€äº›åº“çš„ä½¿ç”¨ä¸å®‰è£…éƒ½ä¸ä¼šå†è¯¾ä¸Šè¯¦ç»†è®²è§£ï¼Œéœ€è¦è¯¾åå†å»ç ”ç©¶ã€‚ ","date":"2019-06-21","objectID":"/posts/pysx2/:1:0","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"åˆ‡ç‰‡æ“ä½œ åˆ—è¡¨åˆ‡ç‰‡æ“ä½œ ","date":"2019-06-21","objectID":"/posts/pysx2/:1:1","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"å­—ç¬¦ä¸² python åŸå§‹å­—ç¬¦ä¸² print(r\"D:\\three\\two\") é•¿å­—ç¬¦ä¸² ç”¨ä¸‰ä¸ªå•å¼•å·æˆ–è€…åŒå¼•å·åŒ…è£¹ï¼Œå‰åå‘¼åº”ï¼ŒæˆåŒæˆå¯¹ã€‚ ç”¨ã€æ¢è¡Œå­—ç¬¦è¡¨ç¤ºå­—ç¬¦æœªç»“æŸ ","date":"2019-06-21","objectID":"/posts/pysx2/:1:2","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"æ ¼å¼åŒ–è¾“å‡º format \"=={}==\"ï¼Œ{}è¡¨ç¤ºå ä½ç¬¦ï¼Œå…¶å‰åå­—ç¬¦ä¿æŒåŸæ ·è¾“å‡ºã€‚ #TempConvert.py TempStr = input(\"è¯·è¾“å…¥å¸¦æœ‰ç¬¦å·çš„æ¸©åº¦å€¼ï¼š\") if TempStr[-1] in ['F','f']: C = (eval(TempStr[0:-1]) - 32)/1.8 print(\"è½¬æ¢åçš„æ¸©åº¦æ˜¯{:.2f}C\".format(C)) elif TempStr[-1] in ['C','c']: F = 1.8*eval(TempStr[0:-1]) + 32 print(\"è½¬æ¢åçš„æ¸©åº¦æ˜¯{:.2f}F\".format(F)) else: print(\"è¾“å…¥æ ¼å¼é”™è¯¯\") ","date":"2019-06-21","objectID":"/posts/pysx2/:1:3","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"å¤šå˜é‡èµ‹å€¼ä¸äº¤æ¢ï¼ˆæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼‰ python 3.x ç‰ˆæœ¬ end=\"\" å¯ä½¿è¾“å‡ºä¸æ¢è¡Œ print(x, end=\"\") #æ–æ³¢é‚£å¥‘æ•°åˆ— a, b = 1,1 while a \u003c 500: ## è¾“å‡ºä¸å¤§äº 500 çš„åºåˆ— print(a,end=\",\") a,b = b,a + b #äº¤æ¢å˜é‡ ","date":"2019-06-21","objectID":"/posts/pysx2/:1:4","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"ç¬‘å‚²æ±Ÿæ¹–ç»Ÿè®¡å­—ç¬¦ (dict, æ–‡ä»¶æµï¼‰ ç»Ÿè®¡ã€Šç¬‘å‚²æ±Ÿæ¹–ã€‹å°è¯´ä¸­å‡ºç°çš„æ‰€æœ‰ä¸­æ–‡å­—ç¬¦åŠæ ‡ç‚¹ç¬¦å·çš„æ•°é‡ï¼Œæ¯ä¸ªå­—ç¬¦åŠæ•°ç›®é—´ç”¨å†’å·:éš”å¼€ï¼Œä¾‹å¦‚\"ç¬‘ï¼š1024\"ï¼Œå°†æ‰€æœ‰å­—ç¬¦åŠæ•°é‡çš„å¯¹åº”é‡‡ç”¨é€—å·åˆ†éš”ï¼Œä»¥ CSV æ–‡ä»¶æ ¼å¼ä¿å­˜åˆ°â€œç¬‘å‚²æ±Ÿæ¹–--å­—ç¬¦ç»Ÿè®¡ã€‚txtâ€æ–‡ä»¶ä¸­ã€‚æ³¨æ„ï¼Œç»Ÿè®¡å­—ç¬¦ä¸åŒ…æ‹¬ç©ºæ ¼å’Œå›è½¦ã€‚ csv æ–‡ä»¶æ ¼å¼ï¼š â€˜,â€™é€—å·è¿æ¥å…ƒç´  fi = open(\"data/ç¬‘å‚²æ±Ÿæ¹–-ç½‘ç»œç‰ˆã€‚txt\",\"r\",encoding=\"utf-8\") fo = open(\"data/ç¬‘å‚²æ±Ÿæ¹–-å­—ç¬¦ç»Ÿè®¡ã€‚txt\",\"w\",encoding=\"utf-8\") txt = fi.read() #æ‰“å¼€æ–‡ä»¶ #txt d = {} for c in txt: d[c] = d.get(c,0)+1 del d[' '] #åˆ é™¤å­—å…¸ä¸­çš„ç©ºæ ¼å’Œå›è½¦çš„é”®å€¼å¯¹ del d['\\n'] ls = [] for key in d: ls.append(\"{}:{}\".format(key,d[key])) fo.write(\",\".join(ls)) fi.close() fo.close() ","date":"2019-06-21","objectID":"/posts/pysx2/:1:5","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"numpy æ¨¡å— â€¦ ","date":"2019-06-21","objectID":"/posts/pysx2/:1:6","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"pandas æ¨¡å— â€¦ ","date":"2019-06-21","objectID":"/posts/pysx2/:1:7","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"6.20 ","date":"2019-06-21","objectID":"/posts/pysx2/:2:0","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"matplotlib ç»˜å›¾ import matplotlib.pyplot as plt import numpy as np x = np.arange(-5,5,0.01) y = 2**x+1 plt.plot(x,y) plt.title(\"y=2^x+1\",fontsize=24) plt.xlabel(\"X\",fontsize=14) plt.ylabel(\"Y\",fontsize=14) plt.tick_params(axis=\"both\",labelsize=14) plt.show() ","date":"2019-06-21","objectID":"/posts/pysx2/:2:1","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"çˆ¬è™« ä¸¾äº†ä¸€ä¸ªé‡‘èç•Œï¼Œç‚’è‚¡ï¼Œè·å–æ•°æ®çš„çˆ¬è™« ï¼ˆä»Šå¤©æ²¡ä»”ç»†å¬è¯¾ï¼Œè¿™æ•°æ®çˆ¬è¿‡ä»€ä¹ˆæ„æ€ï¼Œå’±ä¸æ‡‚ï¼Œå’±ä¹Ÿä¸æ•¢é—®ï¼ï¼‰ #! /usr/bin/env python #-*- encoding: utf-8 -*- #author pythontab.com import numpy as np import matplotlib.pyplot as plt import pandas as pd import pandas_datareader.data as web import datetime #import tushare as ts df_stockload = web.DataReader(\"000001.SS\", \"yahoo\", datetime.datetime(2017,1,1), datetime.date.today()) #print(type(datetime.datetime.now().strftime('%Y-%m-%d'))) #df_stockload = ts.get_hist_data('sh',start='2017-01-01',end=datetime.datetime.now().strftime('%Y-%m-%d')) print (df_stockload.columns)#æŸ¥çœ‹åˆ—å print (df_stockload.index)#æŸ¥çœ‹ç´¢å¼• print (df_stockload.describe())#æŸ¥çœ‹å„åˆ—æ•°æ®æè¿°æ€§ç»Ÿè®¡ #ç»˜åˆ¶ç§»åŠ¨å¹³å‡çº¿ df_stockload.Close.plot(c='b') df_stockload.Close.rolling(window=30).mean().plot(c='r') #pd.rolling_mean(df_stockload.Close,window=30).plot(c='r') df_stockload.Close.rolling(window=60).mean().plot(c='g') #pd.rolling_mean(df_stockload.Close,window=60).plot(c='g') plt.legend(['Close','30ave','60ave'],loc='best') plt.show() Index(['High', 'Low', 'Open', 'Close', 'Volume', 'Adj Close'], dtype='object') DatetimeIndex(['2017-01-03', '2017-01-04', '2017-01-05', '2017-01-06', '2017-01-09', '2017-01-10', '2017-01-11', '2017-01-12', '2017-01-13', '2017-01-16', ... '2019-06-05', '2019-06-06', '2019-06-10', '2019-06-11', '2019-06-12', '2019-06-13', '2019-06-14', '2019-06-19', '2019-06-20', '2019-06-21'], dtype='datetime64[ns]', name='Date', length=596, freq=None) High Low Open Close Volume \\ count 596.000000 596.000000 596.000000 596.000000 5.960000e+02 mean 3076.147753 3039.201569 3056.960338 3060.169056 5.098201e+06 std 269.276147 273.757358 271.612122 272.072346 1.199107e+08 min 2488.479004 2440.906982 2446.019043 2464.363037 8.820000e+04 25% 2845.308228 2800.168762 2825.239502 2827.754822 1.375250e+05 50% 3153.184937 3118.613525 3134.300537 3139.085449 1.666500e+05 75% 3280.115234 3244.825256 3265.322021 3268.600342 2.091250e+05 max 3587.031982 3534.195068 3563.639893 3559.465088 2.927580e+09 Adj Close count 596.000000 mean 3060.169056 std 272.072346 min 2464.363037 25% 2827.754822 50% 3139.085449 75% 3268.600342 max 3559.465088 ","date":"2019-06-21","objectID":"/posts/pysx2/:2:2","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"6.21 ","date":"2019-06-21","objectID":"/posts/pysx2/:3:0","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"ç±» æ¯”ç¬¬ä¸€å¤©ç¨å¾®ä»”ç»†ä¸€ç‚¹è®²äº†ä¸€ä¸‹ç±»ï¼Œæœ‰ç‚¹éœ€è¦æ³¨æ„ï¼š selfç›¸å½“äºthisè¡¨ç¤ºå½“å‰å¯¹è±¡ python ç±»çš„æ‰€æœ‰å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½è¦å†™selfå‚æ•°ï¼Œself ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„æ¯”å¦‚lrhç­‰å­—ç¬¦æ›¿ä»£ï¼Œä½†æ˜¯å¿…é¡»ä¿æŒä¸€è‡´ã€‚ __è¡¨ç¤ºç§æœ‰çš„ class çš„å®šä¹‰å¯ä»¥ä¸åŠ  (),() å†…å¯å†™ç»§æ‰¿çš„çˆ¶ç±» ","date":"2019-06-21","objectID":"/posts/pysx2/:3:1","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"GUI è®¾è®¡ wxPython pip install wxPython import wx import wx #å¯¼å…¥ wxPython åº“ class Panel(wx.Panel): def __init__(self,parent): wx.Panel.__init__(self,parent=parent, id=-1) pass class Frame(wx.Frame): def __init__(self): wx.Frame.__init__(self, parent = None, title = u'é‡åŒ–è½¯ä»¶', size=(1000,600), style=wx.DEFAULT_FRAME_STYLE^wx.MAXIMIZE_BOX) self.DispPanel= Panel(self) pass class App(wx.App): def OnInit(self): self.frame = Frame() self.frame.Show() self.SetTopWindow(self.frame) return True if __name__ == '__main__': app = App() app.MainLoop() import wx app = wx.App() window = wx.Frame(None, title=\"wxPython ä½ å¥½ï¼\", size=(400, 300)) panel = wx.Panel(window) label = wx.StaticText(panel, label=\"Hello World\", pos=(100, 100)) window.Show(True) app.MainLoop() ","date":"2019-06-21","objectID":"/posts/pysx2/:3:2","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"talib åº“çš„å®‰è£… ä¸‹è½½ whl æ–‡ä»¶ pip install TA_Lib-0.4.17-cp37-cp37m-win_amd64.whl pip install TA-Lib ","date":"2019-06-21","objectID":"/posts/pysx2/:3:3","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"é€‰æ‹©æ’åºé€’å½’ç‰ˆ def SelectSort(L): L=L[:] if len(L)\u003c=1: return L min = 0 for i in range(1,len(L)): if L[i]\u003cL[min]: min = i L[min],L[0] = L[0],L[min] return [L[0]]+SelectSort(L[1:]) L = [5,2,3,6,1,9,8,10,0] print(SelectSort(L)) [0, 1, 2, 3, 5, 6, 8, 9, 10] ","date":"2019-06-21","objectID":"/posts/pysx2/:3:4","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"æœºæˆ¿ä¸Šæœºç³»ç»Ÿï¼ˆè‡ªæˆ‘å®è·µï¼‰ import time class student(): def __init__(self,stu_no=\"\",stu_name=\"\",stu_xi=\"\",stu_time=\"\"): self.stu_no = stu_no self.stu_name = stu_name self.stu_xi = stu_xi self.stu_time = stu_time def print(self): print(\"å­¦å·ï¼š\"+self.stu_no+\"\\t å§“åï¼š\"+self.stu_name+\"\\t ç³»åˆ«ï¼š\"+self.stu_xi+\"\\t æœºæ—¶ (h)ï¼š\"+self.stu_time) def get_stu_name(self): return self.stu_name def get_stu_time(self): return int(self.stu_time) def set_stu_time(self,add_time): self.stu_time = add_time def menu(): print(\"\\t æœºæˆ¿ä¸Šæœºç³»ç»Ÿ V0.1\") print(\"********************************\") print(\"\\tâ€”\u003e1. å½•å…¥å­¦ç”Ÿä¿¡æ¯\") print(\"\\tâ€”\u003e2. ä¸Šæœº\") print(\"\\tâ€”\u003e3. ä¸‹æœº\") print(\"\\tâ€”\u003e4. ç¼´è´¹\") print(\"\\tâ€”\u003e5. é€€å‡º\") print(\"********************************\") select = eval(input(\"è¯·è¾“å…¥åºå·ï¼š\")) while select not in [1,2,3,4,5]: print(\"è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼\") select = eval(input(\"è¯·è¾“å…¥åºå·ï¼š\")) return select def get_time(): #è·å–å½“å‰æ—¶é—´ return time.strftime(\"%H:%M:%S\", time.localtime()) def main(): ## å…¨å±€å˜é‡ text = [] ## ä¸Šæœºè®°å½•åˆ—è¡¨ start_time = \"\" end_time = \"\" sum = 0 ## æœ¬ç³»ç»ŸæŒ‰å°æ—¶è®¡è´¹ï¼Œä¸è¶³ä¸€å°æ—¶æŒ‰ä¸€å°æ—¶ç®— people = student() online_flag = False down_flag = False input_flag = False while True: select = menu() ## å¯ç”¨èœå• if select == 1: if input_flag: print(\"å·²å½•å…¥ï¼Œæ— éœ€é‡å¤æ“ä½œï¼Œç¼´è´¹è¯·è¾“å…¥ 4:\") continue else: input_flag = True stu_no = input(\"è¯·è¾“å…¥å­¦å·ï¼š\") stu_name = input(\"è¯·è¾“å…¥å§“åï¼š\") stu_xi = input(\"è¯·è¾“å…¥ç³»åˆ«ï¼š\") stu_time = input(\"è¯·è¾“å…¥æœºæ—¶ï¼š\") people = student(stu_no,stu_name,stu_xi,stu_time) people.print() continue elif select == 2: if not input_flag: print(\"æœªå½•å…¥å­¦ç”Ÿä¿¡æ¯ï¼Œè¯·å½•å…¥ï¼\") continue if not online_flag: online_flag = True start_time = get_time() start_num = int(start_time[0:2]) #print(start_num) text.append(\"ä¸Šæœºæ—¶é—´ï¼š\"+start_time) print(\"å·²ä¸Šæœºï¼ä¸Šæœºæ—¶é—´ä¸ºï¼š\"+start_time) continue else: print(\"å·²ä¸Šæœºï¼ä¸Šæœºæ—¶é—´ä¸ºï¼š\"+start_time) continue elif select == 3: if not online_flag: print(\"è¿˜æœªä¸Šæœºï¼Œè¯·ä¸Šæœºï¼\") continue else: end_time = get_time() end_num = int(end_time[0:2]) sum = end_num - start_num sum = sum if(sum\u003e=0) else sum+24 sum = sum+1 if(sum==0) else sum print(\"å·²ä¸‹æœºï¼ä¸‹æœºæ—¶é—´ä¸ºï¼š\"+end_time+\"\\n ä¸Šæœºæ—¶é•¿ (h)ï¼š\"+str(sum)+\"\\t å‰©ä½™æœºæ—¶ (h)ï¼š\"+str(people.get_stu_time()-sum)) text.append(\"ä¸‹æœºæ—¶é—´ï¼š\"+end_time+\"\\n ä¸Šæœºæ—¶é•¿ (h)ï¼š\"+str(sum)+\"\\t\"+people.get_stu_name()+\"å‰©ä½™æœºæ—¶ (h)ï¼š\"+str(people.get_stu_time()-sum)) people.set_stu_time(str(people.get_stu_time()-sum)) down_flag = True continue elif select == 4: if not input_flag: print(\"æœªå½•å…¥å­¦ç”Ÿä¿¡æ¯ï¼Œè¯·å½•å…¥ï¼\") continue else: people.print() add_time = eval(input(\"è¯·è¾“å…¥æœºæ—¶ï¼š\")) people.set_stu_time(str(add_time+people.get_stu_time())) people.print() else: if down_flag: print(\"3s åé€€å‡ºç³»ç»Ÿï¼Œæ„Ÿè°¢ä½¿ç”¨ï¼\") time.sleep(3) ## å»¶è¿Ÿ 3sï¼Œæ˜¾ç¤ºæç¤ºæ–‡å­— break ## é€€å‡ºç³»ç»Ÿ å†™å…¥æ–‡ä»¶ else: print(\"è¯·ä¸‹æœºï¼\") continue #å†™å…¥ computer.txt æ–‡ä»¶ fo = open(\"D:\\\\computer.txt\",\"w\",encoding=\"utf-8\") fo.write(\"\\n\".join(text)) fo.close() if __name__==\"__main__\": main() ","date":"2019-06-21","objectID":"/posts/pysx2/:3:5","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":"é‡åŒ–äº¤æ˜“ä»£ç åˆ†æä¸è°ƒè¯• ç”±äº python çš„ç‰ˆæœ¬é—®é¢˜å’Œä¸€äº›åº“çš„å¯¼å…¥é—®é¢˜æ‰€ä»¥è¿˜æœªè°ƒè¯•æˆåŠŸï¼Œå…ˆæŒ‚ä¸Šä»£ç ã€‚ä»¥åæ”¹ç¯‡å†è®ºã€‚ #! /usr/bin/env python #-*- encoding: utf-8 -*- #author pythontab.com import wx import wx.adv import numpy as np import pandas as pd import pandas_datareader.data as web import matplotlib import matplotlib.pyplot as plt from matplotlib.figure import Figure import matplotlib.dates as mdates import mpl_finance as mpf from matplotlib.backends.backend_wxagg import FigureCanvasWxAgg as FigureCanvas import matplotlib.gridspec as gridspec#åˆ†å‰²å­å›¾ import datetime import talib import csv,os import codecs from RedefPanelMod import MPL_Panel_Base,Loop_Panel_Base from StockDataMod import GetStockDatPro from IndicatStrateMod import Excave_Indic_Base, QuantPickTimeSys,FactorPickStockAng plt.rcParams['font.sans-serif']=['SimHei'] #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾ plt.rcParams['axes.unicode_minus']=False #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå· class UserDialog(wx.Dialog):## user-defined def __init__(self,parent,text): wx.Dialog.__init__(self,parent,-1,u\"é€‰è‚¡æç¤º\",size=(400,500),style=wx.CAPTION|wx.CLOSE_BOX|wx.MAXIMIZE_BOX|wx.MINIMIZE_BOX) sizer = wx.BoxSizer(wx.VERTICAL) pstock_Text = wx.StaticText(self, -1, u'é€‰è‚¡ç­–ç•¥ç­›é€‰ç»“æœ') pstock_Text.SetFont(wx.Font(18,wx.DEFAULT,wx.NORMAL,wx.BOLD)) pstock_sure = wx.TextCtrl(self, -1, \"è§’åº¦å€¼ï¼š\\n\",size=(350,300),style = wx.TE_MULTILINE|wx.TE_READONLY)#å¤šè¡Œ|åªè¯» pstock_sure.SetFont(wx.Font(10,wx.DEFAULT,wx.NORMAL,wx.BOLD)) okbtn = wx.Button(self,wx.ID_OK,u\"ç¡®è®¤\") okbtn.SetDefault() sizer.Add(pstock_Text,flag=wx.ALIGN_CENTER) sizer.Add(pstock_sure,flag=wx.ALIGN_CENTER) sizer.Add(okbtn,flag=wx.ALIGN_CENTER) self.SetSizer(sizer) for i in text:pstock_sure.AppendText(i) class Frame(wx.Frame): def __init__(self): wx.Frame.__init__(self, parent = None, title = u'é‡åŒ–è½¯ä»¶', size=(1500,800), style=wx.DEFAULT_FRAME_STYLE^wx.MAXIMIZE_BOX) #åˆ›å»ºæ˜¾ç¤ºåŒºé¢æ¿ self.DispPanel = MPL_Panel_Base(self) self.BackPanel = Loop_Panel_Base(self) self.am = self.DispPanel.am self.vol = self.DispPanel.vol self.devol = self.DispPanel.devol self.macd = self.DispPanel.macd #åˆ›å»ºå‚æ•°åŒºé¢æ¿ self.ParaPanel = wx.Panel(self,-1) paraInput_Box = wx.StaticBox(self.ParaPanel, -1, u'å‚æ•°è¾“å…¥') paraInput_Sizer = wx.StaticBoxSizer(paraInput_Box, wx.VERTICAL) self.StNameCodedict = {u\"å¼€å±±è‚¡ä»½\":\"300257.SZ\",u\"æµ™å¤§ç½‘æ–°\":\"600797.SS\",u\"æ°´æ™¶å…‰ç”µ\":\"002273.SZ\", u\"é«˜é¸¿è‚¡ä»½\":\"000851.SZ\"} #åˆå§‹åŒ–è‚¡ç¥¨ä»£ç å˜é‡ self.stockName_Val = u\"å¼€å±±è‚¡ä»½\" self.stockCode_Val = self.StNameCodedict[self.stockName_Val] self.stockName_CMBO = wx.ComboBox(self.ParaPanel, -1,self.stockName_Val, choices = list(self.StNameCodedict.keys()), style = wx.CB_READONLY|wx.CB_DROPDOWN) #è‚¡ç¥¨åç§° stockCode_Text = wx.StaticText(self.ParaPanel, -1, u'è‚¡ç¥¨åç§°') #ç­–ç•¥é€‰å– strate_Text = wx.StaticText(self.ParaPanel, -1, u'ç­–ç•¥åç§°') strate_Combo_Val = [u\"åŒè¶‹åŠ¿èåˆ\", u\"é˜¿å°”æ³•\", u\"å¸ƒæ—å¸¦\"] self.pickstrate_Val = u\"åŒè¶‹åŠ¿èåˆ\" self.pickstrate_CMBO = wx.ComboBox(self.ParaPanel, -1, self.pickstrate_Val, choices = strate_Combo_Val, style = wx.CB_READONLY|wx.CB_DROPDOWN) #ç­–ç•¥åç§° #æ—¥å†æ§ä»¶é€‰æ‹©æ•°æ®å‘¨æœŸ self.dpcEndTime = wx.adv.DatePickerCtrl(self.ParaPanel, -1,style = wx.adv.DP_DROPDOWN|wx.adv.DP_SHOWCENTURY|wx.adv.DP_ALLOWNONE)#ç»“æŸæ—¶é—´ self.dpcStartTime = wx.adv.DatePickerCtrl(self.ParaPanel, -1,style = wx.adv.DP_DROPDOWN|wx.adv.DP_SHOWCENTURY|wx.adv.DP_ALLOWNONE)#èµ·å§‹æ—¶é—´ DateTimeNow = wx.DateTime.Now()#wx.DateTime æ ¼å¼\"03/03/18 00:00:00\" #DateTimeNow = datetime.datetime.fromtimestamp(wx.DateTime.Now().GetTicks()) #DateTimeNow = datetime.datetime.fromtimestamp(DateTimeNow) self.dpcEndTime.SetValue(DateTimeNow) DateTimeNow.SetYear(DateTimeNow.year-1) self.dpcStartTime.SetValue(DateTimeNow) stockData_Text = wx.StaticText(self.ParaPanel, -1, u'æ—¥æœŸ (Start-End)') #åˆå§‹åŒ–æ—¶é—´å˜é‡ dateVal = self.dpcStartTime.GetValue() self.stockSdate_Val = datetime.datetime(dateVal.year,dateVal.month+1,dateVal.day) dateVal = self.dpcEndTime.GetValue() self.stockEdate_Val = datetime.datetime(dateVal.year,dateVal.month+1,dateVal.day) paraInput_Sizer.Add(stockCode_Text,proportion=0,flag=wx.EXPAND|wx.ALL,border=2) paraInput_Sizer.Add(self.stockName_CMBO, 0, wx.EXPAND|wx.ALL|wx.CENTER, 2) paraInput_Sizer.Add(stockData_Text,proportion=0,flag=wx.EXPAND|wx.ALL","date":"2019-06-21","objectID":"/posts/pysx2/:3:6","tags":["Python"],"title":"python å®è®­æ€»ç»“â…¡","uri":"/posts/pysx2/"},{"categories":["Python"],"content":" ä»¥å‰å’Œå‰ä¸€æ®µæ—¶é—´è‡ªå·±ä¹Ÿå­¦ä¹ äº†ä¸€ä¸‹ pythonï¼Œä¹Ÿå†™äº†å‡ ä¸ªå°çˆ¬è™«ï¼› è¿™æ¬¡æ­£å¥½åˆè¯¾ç¨‹å®‰æ’äº†ä¸ºæœŸä¸¤å‘¨çš„ç»¼åˆå®è®­ï¼Œä¸»è¦æ˜¯â€œç”¨ python åšé‡åŒ–äº¤æ˜“â€ è¿›è¡Œäº†ä¸¤å¤©ï¼Œè®²çš„éƒ½æ˜¯ä¸€äº›åŸºæœ¬çš„ä¸œè¥¿ï¼Œä»¥å‰ä¹Ÿæ¥è§¦è¿‡ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“ç†è§£ã€‚è¿˜è®²äº†ä¸€äº›è½¯ä»¶ï¼Œpycharmï¼Œanaconda,sublime ç­‰å¤§éƒ½ä¹Ÿéƒ½ç”¨è¿‡ã€‚anaconda å€’æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦ã€‚ ","date":"2019-06-18","objectID":"/posts/pysx1/:0:0","tags":["Python","turtle"],"title":"python å®è®­æ€»ç»“â… ","uri":"/posts/pysx1/"},{"categories":["Python"],"content":"6.17 print(\"Hello World!\") è®²äº†ä¸€ä¸‹å˜é‡å’Œ python çš„ç‰¹è‰²ä»€ä¹ˆçš„ã€‚ è¿˜è®²äº†æ¨¡å—å®šä¹‰defå’Œç±»å®šä¹‰ class zxm(): def __init__(self): self.x=0 self.y=0 def move_up(self): self.y +=1 my_zxm=zxm() print(my_zxm) \u003c__main__.zxm object at 0x000001D99CFEF668\u003e ","date":"2019-06-18","objectID":"/posts/pysx1/:1:0","tags":["Python","turtle"],"title":"python å®è®­æ€»ç»“â… ","uri":"/posts/pysx1/"},{"categories":["Python"],"content":"6.18 ","date":"2019-06-18","objectID":"/posts/pysx1/:2:0","tags":["Python","turtle"],"title":"python å®è®­æ€»ç»“â… ","uri":"/posts/pysx1/"},{"categories":["Python"],"content":"è¾“å…¥è¾“å‡º print è¾“å‡º input è¾“å…¥ eval æ‰§è¡Œä¸€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼ï¼Œå¹¶è¿”å›è¡¨è¾¾å¼çš„å€¼ x=eval(input(\"è¯·è¾“å…¥ x çš„å€¼ï¼š\")) y=eval(input(\"è¯·è¾“å…¥ y çš„å€¼ï¼š\")) z=(x**2+y**2)**0.5 print(z) # å¯¼å…¥å¤æ•°æ•°å­¦æ¨¡å— import cmath num = int(input(\"è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼š\")) num_sqrt = cmath.sqrt(num) print('{0} çš„å¹³æ–¹æ ¹ä¸º {1:0.3f}+{2:0.3f}j'.format(num ,num_sqrt.real,num_sqrt.imag)) ","date":"2019-06-18","objectID":"/posts/pysx1/:2:1","tags":["Python","turtle"],"title":"python å®è®­æ€»ç»“â… ","uri":"/posts/pysx1/"},{"categories":["Python"],"content":"æ•°æ®ç±»å‹ ä»Šå¤©è¿˜è®²äº†ä¸€ä¸‹æ•°æ®ç±»å‹ å­—ç¬¦ä¸²ï¼š \"\" '' å…ƒç»„ tuple(2,3) åˆ—è¡¨ list[2,3] å­—å…¸ dict{Key:Value} é›†åˆ{} x=[1,10] type(x)#åˆ¤æ–­å…ƒç´ ç±»å‹ list ","date":"2019-06-18","objectID":"/posts/pysx1/:2:2","tags":["Python","turtle"],"title":"python å®è®­æ€»ç»“â… ","uri":"/posts/pysx1/"},{"categories":["Python"],"content":"å¾ªç¯åˆ¤æ–­ for x in range(1,10,2): # (start,stop,step) pass # pass ä¸åšä»»ä½•äº‹æƒ…ï¼Œä¸€èˆ¬ç”¨åšå ä½è¯­å¥ for letter in 'Python': if letter == 'h': pass print('è¿™æ˜¯ pass å—') print('å½“å‰å­—æ¯ :'+ letter) print(\"Good bye!\") å½“å‰å­—æ¯ :P å½“å‰å­—æ¯ :y å½“å‰å­—æ¯ :t è¿™æ˜¯ pass å— å½“å‰å­—æ¯ :h å½“å‰å­—æ¯ :o å½“å‰å­—æ¯ :n Good bye! ","date":"2019-06-18","objectID":"/posts/pysx1/:2:3","tags":["Python","turtle"],"title":"python å®è®­æ€»ç»“â… ","uri":"/posts/pysx1/"},{"categories":["Python"],"content":"str() ã€ import å¯¼åº“ x=10 print(\"æ•´æ•°è½¬å­—ç¬¦ä¸²\"+str(x)) import this The Zen of Python, by Tim Peters Beautiful is better than ugly. Explicit is better than implicit. Simple is better than complex. Complex is better than complicated. Flat is better than nested. Sparse is better than dense. Readability counts. Special cases aren't special enough to break the rules. Although practicality beats purity. Errors should never pass silently. Unless explicitly silenced. In the face of ambiguity, refuse the temptation to guess. There should be one-- and preferably only one --obvious way to do it. Although that way may not be obvious at first unless you're Dutch. Now is better than never. Although never is often better than *right* now. If the implementation is hard to explain, it's a bad idea. If the implementation is easy to explain, it may be a good idea. Namespaces are one honking great idea -- let's do more of those! Google ç¿»è¯‘æ„æ€æ˜¯ï¼š ç¾ä¸½èƒœè¿‡ä¸‘é™‹ã€‚æ˜¾å¼ä¼˜äºéšå¼ã€‚ç®€å•æ¯”å¤æ‚æ›´å¥½ã€‚å¤æ‚æ¯”å¤æ‚æ›´å¥½ã€‚Flat ä¼˜äºåµŒå¥—ã€‚ç¨€ç–ä¼˜äºå¯†é›†ã€‚å¯è¯»æ€§å¾ˆé‡è¦ã€‚ç‰¹æ®Šæƒ…å†µä¸è¶³ä»¥æ‰“ç ´è§„åˆ™ã€‚è™½ç„¶å®ç”¨æ€§èƒœè¿‡çº¯æ´ã€‚é”™è¯¯ä¸åº”è¯¥é»˜é»˜åœ°ä¼ é€’ã€‚é™¤éæ˜ç¡®æ²‰é»˜ã€‚é¢å¯¹æ¨¡æ£±ä¸¤å¯ï¼Œæ‹’ç»çŒœæµ‹çš„è¯±æƒ‘ã€‚åº”è¯¥æœ‰ä¸€ä¸ªæœ€å¥½åªæœ‰ä¸€ä¸ªæ˜æ˜¾çš„æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚è™½ç„¶è¿™ç§æ–¹å¼èµ·åˆå¯èƒ½å¹¶ä¸æ˜æ˜¾ï¼Œé™¤éä½ æ˜¯è·å…°äººã€‚ç°åœ¨æ¯”æ°¸è¿œå¥½ã€‚è™½ç„¶ç°åœ¨æ°¸è¿œä¸ä¼šæ¯”æ­£ç¡®å¥½ã€‚å¦‚æœå®æ–½å¾ˆéš¾è§£é‡Šï¼Œè¿™æ˜¯ä¸€ä¸ªåä¸»æ„ã€‚å¦‚æœå®ç°å¾ˆå®¹æ˜“è§£é‡Šï¼Œé‚£å¯èƒ½æ˜¯ä¸ªå¥½ä¸»æ„ã€‚å‘½åç©ºé—´æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ä¸»æ„ï¼Œè®©æˆ‘ä»¬åšæ›´å¤šçš„äº‹æƒ…å§ï¼ ","date":"2019-06-18","objectID":"/posts/pysx1/:2:4","tags":["Python","turtle"],"title":"python å®è®­æ€»ç»“â… ","uri":"/posts/pysx1/"},{"categories":["Python"],"content":"turtle ç»˜å›¾åº“ï¼ˆå†…ç½®æ¨¡å—ï¼‰","date":"2019-06-18","objectID":"/posts/pysx1/:2:5","tags":["Python","turtle"],"title":"python å®è®­æ€»ç»“â… ","uri":"/posts/pysx1/"},{"categories":["Grocery"],"content":" é»‘ç›’æµ‹è¯•ç€é‡æµ‹è¯•è½¯ä»¶åŠŸèƒ½ï¼Œå®ƒå¹¶ä¸æ¶‰åŠç¨‹åºçš„å†…éƒ¨ç»“æ„å’Œå†…å®¹ç‰¹æ€§ï¼Œä¸»è¦æ ¹æ®è§„æ ¼è¯´æ˜ï¼Œåªä¾é è¢«æµ‹è¯•ç¨‹åºçš„è¾“å…¥å’Œè¾“å‡ºä¹‹é—´å…³ç³»æˆ–ç¨‹åºçš„åŠŸèƒ½æ¥è®¾è®¡æµ‹è¯•ç”¨ä¾‹ã€‚ ç™½ç›’æµ‹è¯•åˆ™æ¸…æ¥šç¨‹åºå†…éƒ¨çš„ç»“æ„ä»¥åŠæ˜¯å¦‚ä½•è¿ä½œçš„ï¼Œå› æ­¤ç™½ç›’æµ‹è¯•éœ€è¦å¯¹ç³»ç»Ÿå†…éƒ¨çš„ç»“æ„å’Œå·¥ä½œåŸç†æœ‰ä¸€ä¸ªæ¸…æ¥šçš„äº†è§£ã€‚ ","date":"2019-05-26","objectID":"/posts/judgetriangle/:0:0","tags":["é»‘ç›’æµ‹è¯•","C"],"title":"åˆ¤æ–­ä¸‰è§’å½¢çš„é»‘ç›’æµ‹è¯•","uri":"/posts/judgetriangle/"},{"categories":["Grocery"],"content":"ç¨‹åº #include\u003cstdio.h\u003e #include\u003cstdlib.h\u003e #define N 2\u003c\u003c25 int a=N,b=N,c=N,d=N; void shuru(); void panduan(int a1,int b1,int c1); int main() { char se; shuru(); panduan(a,b,c); while(1) { printf(\"æ˜¯å¦è¦ç»§ç»­ y or n :\"); scanf(\"%c\",\u0026se); if(se=='\\n') scanf(\"%c\",\u0026se); switch(se) { case 'y': shuru(); panduan(a,b,c); break; case 'n': return 0; } } } void shuru() { printf(\"Please enter ä¸‰è§’å½¢ä¸‰è¾¹ (a,b,c)\\n\"); while(!scanf(\"%d,%d,%d,%d\",\u0026a,\u0026b,\u0026c,\u0026d)){//åˆ¤æ–­éæ•°å­—å­—ç¬¦ fflush(stdin);//æ¸…ç†ç¼“å­˜ a=N;b=N;c=N;d=N; printf(\"è¾“å…¥é”™è¯¯ã€n\"); } fflush(stdin); while((a\u003c1||a\u003e100)||(b\u003c1||b\u003e100)||(c\u003c1||c\u003e100)||d!=N) { if(b==N||c==N||d!=N) printf(\"è¾“å…¥é”™è¯¯ã€n\");//è¾¹æ•°ä¸º 1ã€2ã€4 æ¡ else if(a==0||b==0||c==0) printf(\"è¾¹é•¿ä¸èƒ½ä¸º 0\\n\"); else if(a\u003c0||b\u003c0||c\u003c0) printf(\"è¾¹é•¿ä¸èƒ½ä¸ºè´Ÿã€n\"); else printf(\"Please enter 1-100 ä¹‹é—´çš„æ•´æ•°ã€n\"); a=N;b=N;c=N;d=N; while(!scanf(\"%d,%d,%d,%d\",\u0026a,\u0026b,\u0026c,\u0026d)){//åˆ¤æ–­éæ•°å­—å­—ç¬¦ fflush(stdin);//æ¸…ç†ç¼“å­˜ a=N;b=N;c=N;d=N; printf(\"è¾“å…¥é”™è¯¯ã€n\"); } fflush(stdin); } } void panduan(int a1,int b1,int c1) { if(a1+b1\u003ec1\u0026\u0026b1+c1\u003ea1\u0026\u0026a1+c1\u003eb1) { if(a1==b1\u0026\u0026a1==c1) printf(\"ç­‰è¾¹ä¸‰è§’å½¢ã€n\"); else if(a1==b1||a1==c1||b1==c1) printf(\"ç­‰è…°ä¸‰è§’å½¢ã€n\"); else printf(\"ä¸€èˆ¬ä¸‰è§’å½¢ã€n\"); } else printf(\"éä¸‰è§’å½¢ã€n\"); } ","date":"2019-05-26","objectID":"/posts/judgetriangle/:1:0","tags":["é»‘ç›’æµ‹è¯•","C"],"title":"åˆ¤æ–­ä¸‰è§’å½¢çš„é»‘ç›’æµ‹è¯•","uri":"/posts/judgetriangle/"},{"categories":["Grocery"],"content":"æµ‹è¯• æµ‹è¯• 1 æµ‹è¯• 2 æµ‹è¯• 3 ","date":"2019-05-26","objectID":"/posts/judgetriangle/:2:0","tags":["é»‘ç›’æµ‹è¯•","C"],"title":"åˆ¤æ–­ä¸‰è§’å½¢çš„é»‘ç›’æµ‹è¯•","uri":"/posts/judgetriangle/"},{"categories":["Memo"],"content":" ç›®å‰ HustOj åœ¨ GitHUb åœ°å€æ˜¯ï¼šhttps://github.com/zhblue/hustoj å®‰è£…æ—¶æ³¨æ„ ubuntu ç‰ˆæœ¬ï¼Œæ²¡æ¡ä»¶çš„å¯ä»¥åœ¨è‡ªå·± ubuntu ä¸Šå°è¯•ï¼Œæˆ–è€…è™šæ‹Ÿæœºä¸Šï¼ˆå…³æ³¨å…¬ä¼—å·å›å¤ubuntu16.04è·å– iso é•œåƒæ–‡ä»¶ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨äº‘å®éªŒå®¤çš„äº‘æœåŠ¡å™¨ä¸Šåšåšå®éªŒã€‚ æ›´å¤šè¯´æ˜åŠ ACM/NOIP é¢˜åº“ä¸‹è½½è§å®˜ç½‘åšå®¢ ä»£ç çš„é‚£äº›äº‹|ç¨‹åºå‘˜å›å¿†å½• ","date":"2019-05-17","objectID":"/posts/hustoj/:0:0","tags":["hustoj","ACM","ubuntu","linux"],"title":"HustOJ åŸºç¡€æ­å»ºæ•™ç¨‹","uri":"/posts/hustoj/"},{"categories":["Memo"],"content":"å¿«é€Ÿå®‰è£… OJ ä¸‹è½½ wget https://raw.githubusercontent.com/zhblue/hustoj/master/trunk/install/install-ubuntu16+.sh å®‰è£… sudo bash install-ubuntu16+.sh ç­‰å¾…ä¸­ä¸€è·¯å›è½¦ï¼Œå½“æç¤º doneï¼ åˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸï¼š ","date":"2019-05-17","objectID":"/posts/hustoj/:1:0","tags":["hustoj","ACM","ubuntu","linux"],"title":"HustOJ åŸºç¡€æ­å»ºæ•™ç¨‹","uri":"/posts/hustoj/"},{"categories":["Memo"],"content":"ä½¿ç”¨ HustOJ æ‰“å¼€ç½‘é¡µ/IP åœ°å€ æ³¨å†Œ admin ç”¨ admin ä½œä¸ºç”¨æˆ·åæ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œå°†ä¼šè‡ªåŠ¨æˆä¸ºç®¡ç†å‘˜ã€‚ æ³¨å†ŒæˆåŠŸï¼Œä¼šæç¤ºï¼š ç™»å½•åå° ç™»å½•è´¦å·ï¼Œå¹¶ç‚¹å‡»å³ä¸Šè§’çš„ç®¡ç†ï¼š æ·»åŠ æµ‹è¯•é¢˜ç›® åœ¨åå°é€‰æ‹©æ·»åŠ é¢˜ç›®ï¼Œæ·»åŠ æˆåŠŸï¼š ç„¶åå†æäº¤ä»£ç æµ‹è¯•åˆ¤é¢˜æœºã€‚ ","date":"2019-05-17","objectID":"/posts/hustoj/:2:0","tags":["hustoj","ACM","ubuntu","linux"],"title":"HustOJ åŸºç¡€æ­å»ºæ•™ç¨‹","uri":"/posts/hustoj/"},{"categories":["Memo"],"content":"è¯´æ˜ å®‰è£…åå‡ ä¸ªé‡è¦é…ç½®æ–‡ä»¶çš„ä½ç½® /home/judge/etc/judge.conf /home/judge/src/web/include/db_info.inc.php /etc/php5/fpm/php.ini æˆ– /etc/php7.0/fpm/php.ini /etc/nginx/sites-enabled/default ","date":"2019-05-17","objectID":"/posts/hustoj/:3:0","tags":["hustoj","ACM","ubuntu","linux"],"title":"HustOJ åŸºç¡€æ­å»ºæ•™ç¨‹","uri":"/posts/hustoj/"},{"categories":["ACM"],"content":" äºŒè¿›åˆ¶æœ€å¤§å…¬çº¦æ•°ç®—æ³•é¿å…äº†æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆè¾—è½¬ç›¸é™¤æ³•ï¼‰çš„å¤§é‡å–æ¨¡æ“ä½œï¼Œæœ‰æ•ˆå‡å°‘äº†æ—¶é—´æ¶ˆè€—ï¼Œä¸”æ›´ä¸ºæ–¹ä¾¿ã€‚ ","date":"2019-05-17","objectID":"/posts/gcd-bit/:0:0","tags":["æ¬§å‡ é‡Œå¾—","æ•°å­¦","æ•°è®º","C"],"title":"æœ€å¤§å…¬çº¦æ•°ï¼ˆäºŒè¿›åˆ¶ç®—æ³•ï¼‰","uri":"/posts/gcd-bit/"},{"categories":["ACM"],"content":"åŸç† æœ¬ç®—æ³•åŸºäºä»¥ä¸‹äº‹å®ï¼š å¯¹äºä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬çº¦æ•° gcd(m, n)ï¼Œæœ‰ m\u003cn æ—¶ï¼Œgcd(m, n)=gcd(n, m) m å¶ n å¶æ—¶ï¼Œgcd(m, n)=2*gcd(m/2, n/2) m å¶ n å¥‡æ—¶ï¼Œgcd(m, n)=gcd(m/2, n) m å¥‡ n å¶æ—¶ï¼Œgcd(m, n)=gcd(m, n/2) m å¥‡ n å¥‡æ—¶ï¼Œgcd(m, n)=gcd(n, m-n) é‡‡ç”¨é€’å½’å³å¯ã€‚ ","date":"2019-05-17","objectID":"/posts/gcd-bit/:1:0","tags":["æ¬§å‡ é‡Œå¾—","æ•°å­¦","æ•°è®º","C"],"title":"æœ€å¤§å…¬çº¦æ•°ï¼ˆäºŒè¿›åˆ¶ç®—æ³•ï¼‰","uri":"/posts/gcd-bit/"},{"categories":["ACM"],"content":"å®ç° inline int GCD(int x,int y) { int i,j; if(x==0) return y; if(y==0) return x; for(i=0;0==(x\u00261);++i)x\u003e\u003e=1; // å»æ‰æ‰€æœ‰çš„ 2 for(j=0;0==(y\u00261);++j)y\u003e\u003e=1; // å»æ‰æ‰€æœ‰çš„ 2 if(j\u003ci) i=j; while(1){ if(x\u003cy)x^=y,y^=x,x^=y; // è‹¥ x \u003c y äº¤æ¢ x, y if(0==(x-=y)) return y\u003c\u003ci; // è‹¥ x == yï¼Œ gcd == x == y ï¼ˆå°±æ˜¯åœ¨è¾—è½¬å‡ï¼Œwhile(1) æ§åˆ¶ï¼‰ while(0==(x\u00261))x\u003e\u003e=1; // å»æ‰æ‰€æœ‰çš„ 2 } } int get_lcm(int a,int b)///è·å¾—æœ€å°å…¬å€æ•° { int x=a; int y=b; while(b) { int t=a; a=b; b=t%b; } return x/a*y; } ","date":"2019-05-17","objectID":"/posts/gcd-bit/:2:0","tags":["æ¬§å‡ é‡Œå¾—","æ•°å­¦","æ•°è®º","C"],"title":"æœ€å¤§å…¬çº¦æ•°ï¼ˆäºŒè¿›åˆ¶ç®—æ³•ï¼‰","uri":"/posts/gcd-bit/"},{"categories":["Grocery"],"content":" ImgURL æ˜¯ä¸€ä¸ªå¼€æºã€å…è´¹çš„å›¾åºŠç¨‹åºï¼ŒImgURL 2.x ä¹‹åå¯¹ç¯å¢ƒè¦æ±‚æ›´é«˜ï¼Œå°¤å…¶æ˜¯ ImageMagick ç»„ä»¶çš„æ”¯æŒï¼Œå¾ˆå¤šæœ‹å‹ä¸æ¸…æ¥šæ€æ ·å®‰è£…è¿™ä¸ªç»„ä»¶ï¼Œè¿™ç¯‡æ–‡ç« åˆ†äº«å®å¡”é¢æ¿å®‰è£… ImgURL 2.x å›¾åºŠçš„è¿‡ç¨‹ï¼ˆåŒ…æ‹¬ ImgURL 2.x éœ€è¦çš„å„ç§ç»„ä»¶ï¼‰ é˜…è¯»åŸæ–‡ ","date":"2019-05-16","objectID":"/posts/imgurl/:0:0","tags":["ImgURL","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£… ImgURL å›¾åºŠ","uri":"/posts/imgurl/"},{"categories":["Grocery"],"content":"å‡†å¤‡å·¥ä½œ å·²ç»å®‰è£…å®å¡”é¢æ¿ åœ¨å®å¡”åå°åˆ›å»ºä¸€ä¸ªç«™ç‚¹ ä¸‹è½½ ImgURL 2.x ä¸Šä¼ åˆ°ç«™ç‚¹æ ¹ç›®å½•å¹¶è§£å‹ ","date":"2019-05-16","objectID":"/posts/imgurl/:1:0","tags":["ImgURL","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£… ImgURL å›¾åºŠ","uri":"/posts/imgurl/"},{"categories":["Grocery"],"content":"è®¾ç½®ä¼ªé™æ€ å¦‚æœæ‚¨å®å¡”é¢æ¿å®‰è£…çš„ Apache åˆ™ä¸éœ€è¦å†è®¾ç½®ä¼ªé™æ€ï¼Œç›´æ¥è·³è¿‡è¿™ä¸ªæ­¥éª¤ï¼Œå¦‚æœä½¿ç”¨çš„ Nginx ç¯å¢ƒï¼Œè¯·ç»§ç»­å¾€ä¸‹çœ‹ã€‚ æ‰¾åˆ°å¯¹åº”çš„ç«™ç‚¹ - ç‚¹å‡»åé¢è®¾ç½®æŒ‰é’® - ä¼ªé™æ€ - æ·»åŠ ä¸‹é¢çš„ä¼ªé™æ€è§„åˆ™ location / { try_files $uri $uri/ /index.php?$query_string; } location ~* \\.(db3|json)$ { deny all; } location ~* ^/(temp|upload|imgs|data|application|static|system)/.*.(php|php5)$ { return 403; } ","date":"2019-05-16","objectID":"/posts/imgurl/:2:0","tags":["ImgURL","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£… ImgURL å›¾åºŠ","uri":"/posts/imgurl/"},{"categories":["Grocery"],"content":"å®‰è£… fileinfo \u0026 imagemagick åœ¨å®å¡”åå° - è½¯ä»¶ç®¡ç† - æ‰¾åˆ°æ‚¨ç«™ç‚¹å¯¹åº”çš„ PHP ç‰ˆæœ¬ - è®¾ç½® PHP - å®‰è£…æ‰©å±• - å‹¾é€‰fileinfoå’Œimagemagickï¼Œå¦‚ä¸‹æˆªå›¾ã€‚ ","date":"2019-05-16","objectID":"/posts/imgurl/:3:0","tags":["ImgURL","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£… ImgURL å›¾åºŠ","uri":"/posts/imgurl/"},{"categories":["Grocery"],"content":"å®‰è£… ImgURL 2.x å…¶å®ƒæ‰€éœ€æ‰©å±•å®å¡”é»˜è®¤å·²ç»æ”¯æŒï¼Œé‡ç‚¹æ˜¯å®‰è£…fileinfoå’Œimagemagickï¼Œæ‰©å±•å®‰è£…å®Œæ¯•åå°±å¯ä»¥è®¿é—®æ‚¨è‡ªå·±çš„åŸŸåå®‰è£… ImgURL äº†ï¼Œå¦‚æœæ­£å¸¸ä¼šçœ‹åˆ° ImgURL å®‰è£…ç•Œé¢ã€‚ ","date":"2019-05-16","objectID":"/posts/imgurl/:4:0","tags":["ImgURL","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£… ImgURL å›¾åºŠ","uri":"/posts/imgurl/"},{"categories":["Grocery"],"content":"å…¶å®ƒè¯´æ˜ å¦‚æœå®‰è£…é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·ç•™è¨€åé¦ˆæˆ–åˆ° 3T å®˜æ–¹ç¤¾åŒº è¿›è¡Œåé¦ˆ ImgURL æ›´å¤šä½¿ç”¨è¯´æ˜è¯·å‚è€ƒå¸®åŠ©æ–‡æ¡£ï¼šhttps://dwz.ovh/imgurldoc ","date":"2019-05-16","objectID":"/posts/imgurl/:5:0","tags":["ImgURL","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£… ImgURL å›¾åºŠ","uri":"/posts/imgurl/"},{"categories":["Python"],"content":" ç”¨ python æ¨¡æ‹Ÿ post è¯·æ±‚è·å–â€œéº»å°ç§‘æŠ€â€ç¤ºä¾‹é…’åº—åå°çš„æ•°æ®ï¼Œå†æ‰“åŒ…å‘é€è‡³æŒ‡å®šçš„å¾®ä¿¡ç¾¤æˆ–è€…å¥½å‹ã€‚ è¦æ±‚æ¯å¤©æ—©ä¸Š 8 ç‚¹å®šæ—¶æŠŠæ¯ä¸ªé…’åº—çš„æ•°æ®å‘é€è‡³æ¯ä¸ªé…’åº—çš„å¾®ä¿¡å·¥ä½œç¾¤ã€‚ ","date":"2019-05-11","objectID":"/posts/mx2wx/:0:0","tags":["Python","wxpy","pyinstaller","HTTP","JSON","Cron"],"title":"python å®æˆ˜ï¼šæ¨¡æ‹Ÿ post è¯·æ±‚å®šæ—¶è·å–åå°æ•°æ®å¹¶æ‰“åŒ…å‘é€è‡³å¾®ä¿¡","uri":"/posts/mx2wx/"},{"categories":["Python"],"content":"èƒŒæ™¯ éº»å°ç§‘æŠ€ï¼š éº»å°ç§‘æŠ€å…¨åæ·±åœ³å¸‚éº»å°ç§‘æŠ€æœ‰é™å…¬å¸ï¼Œæˆç«‹äº 2017 å¹´ 1 æœˆã€‚æ˜¯æˆ‘é«˜ä¸€çš„æ—¶å€™å‚åŠ Peer å¤ä»¤è¥å¸¦æˆ‘ä»¬ä¸€ä¸ªç©çš„â€œè€å¸ˆâ€å’Œä»–çš„æœ‹å‹çš„åˆ›ä¸šå…¬å¸ï¼Œè¯´è€å¸ˆæœ‰ç‚¹å¥‡æ€ªï¼Œæˆ‘ä»¬éƒ½æ˜¯ç›´æ¥å«åå­—çš„ï¼Œæ¯”å¦‚å¤§å®¶éƒ½å«æˆ‘ç‘è±ªï¼Œæˆ‘ä¹Ÿå°±å«ä»–æ–‡æ·å“¥ï¼Œç®€ç§°æ·å“¥å§ã€‚ä»–ä»¬å…¬å¸ä¸»è¦çš„å¼€å‘æ¨¡å¼æ˜¯ï¼Œå°ç¨‹åºå‰ç«¯+php åç«¯ï¼Œç„¶ååšçš„æ˜¯é…’åº—å°ç¨‹åºï¼Œä¸ºæ¯ä¸ªé…’åº—å®šåˆ¶å°ç¨‹åºã€‚è¿™äº›å°ç¨‹åºå¯ä»¥è´´åœ¨å®¢æˆ¿ä¸­ç»™è®¿å®¢æä¾›ä¸€äº›æœåŠ¡ï¼Œå¤§å¤§èŠ‚çœäº†æˆæœ¬ä¹Ÿæé«˜äº†æ•ˆç‡ã€‚ ç„¶åæ¯ä¸ªé…’åº—å°ç¨‹åºéƒ½æœ‰ç‹¬ç«‹çš„åå°ï¼Œåå°ä¼šè®°å½•ä¸€äº›ç‚¹å‡»éœ€æ±‚çš„æ•°æ®ã€‚ç°åœ¨ä»–ä»¬æœ‰ä¸€ä¸ªéœ€æ±‚éœ€è¦æŠŠæ¯ä¸ªé…’åº—å°ç¨‹åºåå°çš„æ•°æ®åœ¨æ¯å¤©æ—©ä¸Š 9 ç‚¹å‘é€è‡³å¯¹åº”é…’åº—çš„å¾®ä¿¡ç¾¤ã€‚ ","date":"2019-05-11","objectID":"/posts/mx2wx/:1:0","tags":["Python","wxpy","pyinstaller","HTTP","JSON","Cron"],"title":"python å®æˆ˜ï¼šæ¨¡æ‹Ÿ post è¯·æ±‚å®šæ—¶è·å–åå°æ•°æ®å¹¶æ‰“åŒ…å‘é€è‡³å¾®ä¿¡","uri":"/posts/mx2wx/"},{"categories":["Python"],"content":"å®ç°ä»£ç  ç¼“å­˜ç™»å½•ä¿¡æ¯ï¼ŒçŸ­æ—¶é—´ç±»æ— éœ€é‡å¤ç™»å½•ï¼Œä»…ç¬¬ä¸€æ¬¡éœ€è¦æ‰«ç ç™»å½•ï¼ˆç›¸å½“äºå¾®ä¿¡ç½‘é¡µç‰ˆï¼‰ï¼Œåé¢çš„ç™»å½•åªéœ€åœ¨æ‰‹æœºä¸Šç¡®è®¤ç™»å½•ä¿¡æ¯ã€‚ #!/usr/bin/python import requests import json import time from wxpy import * ## åŸºæœ¬ä¿¡æ¯å¡«å†™ï¼š ## é…’åº— idï¼Œé…’åº—åç§°åŠç¾¤ååˆ—è¡¨æ•°æ®ï¼Œæ ¼å¼ï¼š[\"xxx\",\"xxx\",\"xxx\"] ## ä½¿ç”¨æ—¶è¯·å°†ä»¥ä¸‹ä¸‰ä¸ªåˆ—è¡¨ä¸€ä¸€å¯¹åº” hotel=[\"xxxx\",\"xxxx\"] ## é…’åº—åå°æ•°æ®æ¥å£äºŒçº§åŸŸåï¼Œå·²åŒ¿å hotel_name=[\"å¢åŸå®¾é¦†\",\"ç™¾ä¸½é…’åº—\"] grouplist = [\"éº»å°\",\"å¯Œå¼ºæ°‘ä¸»æ–‡æ˜å’Œè°è‡ªç”±å¹³ç­‰å…¬æ­£æ³•æ²»\"] ## post è¯·æ±‚å‘é€çš„æ•°æ® postData = { ## 'username':'test', ## 'password':'123456', } def get_data(): result = [] #ç»“æœåˆ—è¡¨ i = 0 #è®¡æ•°å™¨ for each in hotel: url=\"http://\"+each+\".maxiaokeji.com/xxx/xxxxxxx/xxx\" ## ä¸ºä¿æŠ¤éšç§åŠæƒç›Šï¼Œè¿™é‡Œä¸æä¾›æ¥å£ r = requests.post(url,data=postData) ## print(r.text) ## æŠŠç»“æœè½¬åŒ–ä¸º json å­—ç¬¦ä¸² response=json.dumps(r.json(),indent=4,ensure_ascii=False) #sort_keys=True ## æŠŠ json è½¬æ¢ä¸º dict å­—å…¸ä½œä¸ºä¸­é—´ç»“æœï¼Œå†å–å‡ºæ˜¨æ—¥æ•°æ® midresult=json.loads(response) result.append(\"æ—©ä¸Šå¥½ï¼\"+hotel_name[i]+\"å°ç¨‹åºæ˜¨æ—¥æ•°æ®å¦‚ä¸‹ï¼š\\n è®¿é—®æ•°ï¼š\"+str(midresult[\"data\"][\"yesterday_data\"][\"type1\"])+\"\\n æˆ¿é—´æ•°ï¼š\"+str(midresult[\"data\"][\"yesterday_data\"][\"type2\"])+\"\\n éœ€æ±‚é‡ï¼š\"+str(midresult[\"data\"][\"yesterday_data\"][\"type3\"])+\"\\n å•†å“ç‚¹å‡»é‡ï¼š\"+str(midresult[\"data\"][\"yesterday_data\"][\"type4\"])) i+=1 ## print(result) return result def wechat_send(bot,result): ## my_friend = bot.friends().search('lrh')[0] ## my_friend.send(result) i = 0 ## è®¡æ•°å™¨ for group in grouplist: my_group = bot.groups().search(group)[0] #ä¾æ¬¡æœç´¢æ¯ä¸€ä¸ªç¾¤åç§°ï¼Œæ¯æ¬¡ä¸€ä¸ª my_group.send(result[i]) print(result[i]) print(\"å·²å‘é€è‡³ç¾¤ï¼š\"+group) i+=1 def main(bot): ## è®¾ç½®æœ€å¤§ä¼‘çœ æ—¶é—´ï¼Œé˜²æ­¢ç¨‹åºé•¿æ—¶é—´å ç”¨ç³»ç»Ÿèµ„æº while True: now_hour = time.strftime(\"%H\", time.localtime()) now_min = time.strftime(\"%M\", time.localtime()) ## è®¾ç½®æ¯å¤© 8 ç‚¹å‘é€ if now_hour \u003c \"08\": rest = 8 - int(now_hour) sleeptime = (rest-1)*3600 + (60-int(now_min))*60 print(\"å¯åŠ¨æ—¶åŒ—äº¬æ—¶é—´ä¸ºï¼š\"+time.strftime(\"%H:%M\", time.localtime()),\"\\t è½¯ä»¶å°†åœ¨\",rest-1,\"å°æ—¶\",int((sleeptime-(rest-1)*3600)/60),\"åˆ†é’Ÿåå‘é€æ•°æ®\") time.sleep(sleeptime) elif now_hour \u003e \"08\": rest = 8 - int(now_hour) + 24 sleeptime = (rest-1)*3600 + (60-int(now_min))*60 print(\"å¯åŠ¨æ—¶åŒ—äº¬æ—¶é—´ä¸ºï¼š\"+time.strftime(\"%H:%M\", time.localtime()),\"\\t è½¯ä»¶å°†åœ¨\",rest-1,\"å°æ—¶\",int((sleeptime-(rest-1)*3600)/60),\"åˆ†é’Ÿåå‘é€æ•°æ®\") time.sleep(sleeptime) elif now_hour == \"08\": print(\"è½¯ä»¶æ˜å¤©å¼€å§‹å°†åœ¨æ¯å¤© 8 ç‚¹å‘é€æ•°æ®ï¼\") result=get_data() ## è·å–æ•°æ® wechat_send(bot,result) ## å‘é€æ•°æ® time.sleep(86400-int(now_min)*60) if __name__==\"__main__\": bot = Bot(cache_path=True) ## åˆå§‹åŒ–æœºå™¨äººï¼Œæ‰«ç ç™»é™† main(bot); ","date":"2019-05-11","objectID":"/posts/mx2wx/:2:0","tags":["Python","wxpy","pyinstaller","HTTP","JSON","Cron"],"title":"python å®æˆ˜ï¼šæ¨¡æ‹Ÿ post è¯·æ±‚å®šæ—¶è·å–åå°æ•°æ®å¹¶æ‰“åŒ…å‘é€è‡³å¾®ä¿¡","uri":"/posts/mx2wx/"},{"categories":["Python"],"content":"æµ‹è¯•ç»“æœ ","date":"2019-05-11","objectID":"/posts/mx2wx/:3:0","tags":["Python","wxpy","pyinstaller","HTTP","JSON","Cron"],"title":"python å®æˆ˜ï¼šæ¨¡æ‹Ÿ post è¯·æ±‚å®šæ—¶è·å–åå°æ•°æ®å¹¶æ‰“åŒ…å‘é€è‡³å¾®ä¿¡","uri":"/posts/mx2wx/"},{"categories":["Python"],"content":"ç¨‹åºæ‰“åŒ… ä½¿ç”¨ pyinstaller å·¥å…·æ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶å³å¯ã€‚ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ä¸å¯è·¨å¹³å°è¿è¡Œï¼Œåˆ†å¹³å°æ‰“åŒ…ï¼‰ ç›®å‰è¯¥ç¨‹åºå·²ç»ä¸Šçº¿æµ‹è¯•ä¸­ â€¦ æš‚æœªåé¦ˆé—®é¢˜ ","date":"2019-05-11","objectID":"/posts/mx2wx/:4:0","tags":["Python","wxpy","pyinstaller","HTTP","JSON","Cron"],"title":"python å®æˆ˜ï¼šæ¨¡æ‹Ÿ post è¯·æ±‚å®šæ—¶è·å–åå°æ•°æ®å¹¶æ‰“åŒ…å‘é€è‡³å¾®ä¿¡","uri":"/posts/mx2wx/"},{"categories":["Python"],"content":"æ”¶è· ç¬¬ä¸€æ¬¡å‚ä¸å®é™…å…¬å¸çš„é¡¹ç›®å¼€å‘ï¼Œè™½ç„¶åªæ˜¯ä¸€ä¸ªå°çš„éœ€æ±‚è®¾è®¡ï¼Œä½†æ˜¯æˆ‘åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿå­¦åˆ°äº†å¾ˆå¤šï¼Œæ¯”å¦‚é€šè¿‡å®é™…ä¸€ä¸¤å‘¨çš„ç¼–ç¨‹å¯¹ Python çš„ç†Ÿæ‚‰åº¦è¿œè¿œå¥½è¿‡ä»¥å‰åœ¨å®éªŒå®¤çœ‹çš„ä¸€ä¸ªæœˆè§†é¢‘ã€‚ è¿˜æœ‰å°±æ˜¯åœ¨æ­¤æ¬¡å¼€å‘ä¸­ï¼Œä¹Ÿæ„Ÿå—åˆ°äº†å®é™…é¡¹ç›®å¼€å‘çš„å›¢é˜Ÿåˆä½œé‡è¦æ€§ï¼Œåˆšå¼€å§‹æ‹¿åˆ°è¿™ä¸ªéœ€æ±‚ï¼Œç”±äºæˆ‘å¯¹ python å’Œåå°ï¼Œä»¥åŠæ•°æ®æ¥å£è¿™äº›åŸºæœ¬çš„æ“ä½œéƒ½ä¸æ‡‚ï¼Œå°±æ‹¿æ•°æ®è·å–æ¥è¯´ï¼Œæˆ‘ä¸€å¼€å§‹ä¸€ä½è¦è‡ªå·±æ¨¡æ‹Ÿç™»é™†åå°ï¼ˆå·²çŸ¥å¯†ç ï¼‰ï¼Œä¸€é¡¿æ“ä½œã€ç™¾åº¦ç­‰ç­‰å¤±è´¥å‘Šç»ˆï¼Œåæ¥æ¶›å“¥ç»™äº†ä¸€ä¸ªæ•°æ®æ¥å£ï¼ŒåŠ ä¸Šæ¶›å“¥è€å¿ƒæŒ‡ç‚¹ï¼Œæˆ‘æ‰ç»ˆäºæ‹¿åˆ°äº†æ•°æ®ã€‚ è¿˜æœ‰åœ¨å¤šäººåˆä½œçš„é¡¹ç›®ä¸­ï¼Œä¸ºä¿æŒä»£ç çš„å¯è¯»æ€§ï¼Œè¦å°½é‡çš„å¤šäº›æ³¨é‡Šï¼Œè¿˜æœ‰å‡½æ•°æ–¹æ³•çš„å‘½åå°½é‡å…·å¤‡å¯è¯»æ€§ã€‚æ¯”å¦‚æˆ‘ä»£ç ä¸­çš„wechat_send()ï¼Œä¸€å¼€å§‹çš„å‘½åæ˜¯wxfs()ï¼Œç»æ·å“¥æŒ‡æ­£æˆ‘æ‰æ”¹è¿‡æ¥çš„ã€‚ ","date":"2019-05-11","objectID":"/posts/mx2wx/:5:0","tags":["Python","wxpy","pyinstaller","HTTP","JSON","Cron"],"title":"python å®æˆ˜ï¼šæ¨¡æ‹Ÿ post è¯·æ±‚å®šæ—¶è·å–åå°æ•°æ®å¹¶æ‰“åŒ…å‘é€è‡³å¾®ä¿¡","uri":"/posts/mx2wx/"},{"categories":["Grocery"],"content":" \u003c!--[if !IE]\u003e\u003c!--\u003e é™¤ IE å¤–éƒ½å¯è¯†åˆ« \u003c!--\u003c![endif]--\u003e \u003c!--[if IE]\u003e æ‰€æœ‰çš„ IE å¯è¯†åˆ« \u003c![endif]--\u003e \u003c!--[if IE 6]\u003e ä»… IE6 å¯è¯†åˆ« \u003c![endif]--\u003e \u003c!--[if lt IE 6]\u003e IE6 ä»¥åŠ IE6 ä»¥ä¸‹ç‰ˆæœ¬å¯è¯†åˆ« \u003c![endif]--\u003e \u003c!--[if gte IE 6]\u003e IE6 ä»¥åŠ IE6 ä»¥ä¸Šç‰ˆæœ¬å¯è¯†åˆ« \u003c![endif]--\u003e \u003c!--[if IE 7]\u003e ä»… IE7 å¯è¯†åˆ« \u003c![endif]--\u003e \u003c!--[if lt IE 7]\u003e IE7 ä»¥åŠ IE7 ä»¥ä¸‹ç‰ˆæœ¬å¯è¯†åˆ« \u003c![endif]--\u003e \u003c!--[if gte IE 7]\u003e IE7 ä»¥åŠ IE7 ä»¥ä¸Šç‰ˆæœ¬å¯è¯†åˆ« \u003c![endif]--\u003e \u003c!--[if IE 8]\u003e ä»… IE8 å¯è¯†åˆ« \u003c![endif]--\u003e \u003c!--[if IE 9]\u003e ä»… IE9 å¯è¯†åˆ« \u003c![endif]--\u003e é¡¹ç›®èŒƒä¾‹è¯´æ˜ ![if !IE]The NOT operator. This is placed immediately in front of theÂ feature,Â operator, orÂ subexpressionÂ to reverse the Boolean meaning of the expression. NOT è¿ç®—ç¬¦ã€‚è¿™æ˜¯æ‘†ç«‹å³åœ¨å‰é¢çš„åŠŸèƒ½ï¼Œæ“ä½œå‘˜ï¼Œæˆ–å­è¡¨è¾¾å¼æ‰­è½¬å¸ƒå°”è¡¨è¾¾å¼çš„æ„ä¹‰ã€‚lt [if lt IE 5.5] The less-than operator. Returns true if the first argument is less than the second argument. å°äºè¿ç®—ç¬¦ã€‚å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°å°äºç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™è¿”å› trueã€‚ lte[if lte IE 6]The less-than or equal operator. Returns true if the first argument is less than or equal to the second argument. å°äºæˆ–ç­‰äºè¿ç®—ã€‚å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å°äºæˆ–ç­‰äºç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™è¿”å› trueã€‚ gt[if gt IE 5]The greater-than operator. Returns true if the first argument is greater than the second argument. å¤§äºè¿ç®—ç¬¦ã€‚å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°å¤§äºç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™è¿”å› trueã€‚ gte [if gte IE 7]The greater-than or equal operator. Returns true if the first argument is greater than or equal to the second argument. å¤§äºæˆ–ç­‰äºè¿ç®—ã€‚å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¤§äºæˆ–ç­‰äºç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™è¿”å› trueã€‚ ( )[if !(IE 7)]Subexpression operators. Used in conjunction with boolean operators to create more complex expressions. å­è¡¨è¾¾å¼è¿è¥å•†ã€‚åœ¨ä¸å¸ƒå°”è¿ç®—ç¬¦ç”¨äºåˆ›å»ºæ›´å¤æ‚çš„è¡¨è¾¾å¼ã€‚\u0026[if (gt IE 5)\u0026(lt IE 7)]The AND operator. Returns true if all subexpressions evaluate to true AND è¿ç®—ç¬¦ã€‚å¦‚æœæ‰€æœ‰çš„å­è¡¨è¾¾å¼è®¡ç®—ç»“æœä¸º trueï¼Œè¿”å› true|[if (IE 6)|(IE 7)]The OR operator. Returns true if any of the subexpressions evaluates to true. OR è¿ç®—ç¬¦ã€‚è¿”å› trueï¼Œå¦‚æœå­è¡¨è¾¾å¼è®¡ç®—ç»“æœä¸º trueã€‚ \u003c!--[if lt IE 9]\u003e åŠ è½½ CSS1 \u003c!--[else]\u003e åŠ è½½ CSS2 \u003c![endif]--\u003e è¿™æ ·æœ‰æ•ˆæ˜¯æœ‰æ•ˆï¼Œä½†æ˜¯ç”¨ HTML VALIDATOR é‡Œï¼ŒæŠ¥é”™ï¼Œå› ä¸ºè¿™ä¸ªä¸ç¬¦åˆ XHTML 1.1 çš„è§„èŒƒï¼Œ å¦‚æœæŠŠ ELSE è¯­å¥å»æ‰ï¼Œåˆ™æ­£ç¡®ã€‚ åŠ è½½ CSS2 \u003c!--[if lt IE 9]\u003e åŠ è½½ CSS1ï¼ˆå¯ä»¥æŠŠè¦é‡å†™çš„å†™åœ¨è¿™é‡Œï¼‰. \u003c![endif]--\u003e ","date":"2019-05-10","objectID":"/posts/ifzhushi/:0:0","tags":["HTML","ä»–å±±ä¹‹çŸ³"],"title":"æ¡ä»¶æ³¨é‡Šåˆ¤æ–­æµè§ˆå™¨ç‰ˆæœ¬\u003c!--[if lt IE 9]\u003e;","uri":"/posts/ifzhushi/"},{"categories":["Python"],"content":" ç¬¬ä¸€æ¬¡è¿è¡Œæ ¹æ®ç¨‹åºæ‰§è¡Œæ—¶é—´ï¼Œåˆ¤æ–­ç¨‹åºä¼‘çœ çš„æ—¶é—´ï¼Œå°½æœ€å¤§å¯èƒ½ä¼‘çœ ï¼ŒèŠ‚çœç³»ç»Ÿèµ„æºã€‚ ç¬¬äºŒæ¬¡è¿è¡Œåç›´æ¥ä¼‘çœ ä¸€å¤©ï¼Œåˆ°æ¯å¤©æ—©ä¸Š 8 ç‚¹æ‰§è¡Œä»»åŠ¡ã€‚ ï¼ˆè¯¥ç¨‹åºéœ€è¦ä¸€ç›´æŒ‚ç€ï¼Œä¿æŒç½‘ç»œä¸æ–­ï¼‰ import time while True: now_hour = time.strftime(\"%H\", time.localtime()) now_min = time.strftime(\"%M\", time.localtime()) if now_hour \u003c \"08\": rest = 8 - int(now_hour) sleeptime = (rest-1)*3600 + (60-int(now_min))*60 print(\"å¯åŠ¨æ—¶åŒ—äº¬æ—¶é—´ä¸ºï¼š\"+time.strftime(\"%H:%M\", time.localtime()),\"\\t è½¯ä»¶å°†åœ¨\",rest-1,\"å°æ—¶\",int((sleeptime-(rest-1)*3600)/60),\"åˆ†é’Ÿåå‘é€æ•°æ®\") time.sleep(sleeptime) elif now_hour \u003e \"08\": rest = 8 - int(now_hour) + 24 sleeptime = (rest-1)*3600 + (60-int(now_min))*60 print(\"å¯åŠ¨æ—¶åŒ—äº¬æ—¶é—´ä¸ºï¼š\"+time.strftime(\"%H:%M\", time.localtime()),\"\\t è½¯ä»¶å°†åœ¨\",rest-1,\"å°æ—¶\",int((sleeptime-(rest-1)*3600)/60),\"åˆ†é’Ÿåå‘é€æ•°æ®\") time.sleep(sleeptime) elif now_hour == \"08\": print(\"å¯åŠ¨æ—¶åŒ—äº¬æ—¶é—´ä¸ºï¼š\" + time.strftime(\"%H:%M\", time.localtime()), \"\\t è½¯ä»¶å°†åœ¨æ¯å¤© 8 ç‚¹å‘é€æ•°æ®ï¼\") # ä»¥ä¸‹ä¸ºå®šæ—¶ä»»åŠ¡ print(\"æ•°æ®\") time.sleep(86400-int(now_min)*60) ","date":"2019-05-09","objectID":"/posts/pysettime/:0:0","tags":["Python","Cron"],"title":"python è®¾ç½®ç¨‹åºæ¯å¤© 8 ç‚¹å®šæ—¶æ‰§è¡Œä»»åŠ¡","uri":"/posts/pysettime/"},{"categories":["Python"],"content":" ç”¨è¿‡å‘½ä»¤pip install pyinstallerå®‰è£…å¤±è´¥ï¼Œæ­¤åŒ…ä¾èµ–äº pywin32ï¼Œå®‰è£…å‰éœ€è¦å…ˆpip install pywin32, æˆ‘å®‰è£…äº†è¿˜æ˜¯å‡ºé”™ï¼Œç¨å¾®ç™¾åº¦äº†ä¸€ä¸‹ä¹Ÿæ²¡æœ‰çœ‹åˆ°è§£å†³åŠæ³•ã€‚ è¿™é‡Œé€šè¿‡æ‰‹åŠ¨ä¸‹è½½å®‰è£…è§£å†³çš„ï¼Œè®°å½•ä¸€ä¸‹ã€‚ ","date":"2019-05-09","objectID":"/posts/pyinstallererror/:0:0","tags":["Python","pyinstaller"],"title":"å®‰è£… pyinstaller å‡ºé”™çš„è§£å†³åŠæ³•åŠ csdn å·¥å…·å®ä¾‹æ‰“åŒ…","uri":"/posts/pyinstallererror/"},{"categories":["Python"],"content":"ä¸‹è½½ å»å®˜ç½‘ä¸‹è½½ pyinstaller å®‰è£…åŒ…ï¼šhttps://pypi.org/project/PyInstaller/#files ","date":"2019-05-09","objectID":"/posts/pyinstallererror/:1:0","tags":["Python","pyinstaller"],"title":"å®‰è£… pyinstaller å‡ºé”™çš„è§£å†³åŠæ³•åŠ csdn å·¥å…·å®ä¾‹æ‰“åŒ…","uri":"/posts/pyinstallererror/"},{"categories":["Python"],"content":"è§£å‹ æˆ‘è¿™é‡Œè§£å‹åˆ°E:\\åº”ç”¨ã€Python37\\Lib\\site-packages\\PyInstaller-3.4 ","date":"2019-05-09","objectID":"/posts/pyinstallererror/:2:0","tags":["Python","pyinstaller"],"title":"å®‰è£… pyinstaller å‡ºé”™çš„è§£å†³åŠæ³•åŠ csdn å·¥å…·å®ä¾‹æ‰“åŒ…","uri":"/posts/pyinstallererror/"},{"categories":["Python"],"content":"å®‰è£… cmd ä¹Ÿè¿›å…¥åˆ°ä¸Šé¢çš„è·¯å¾„ä¸‹ï¼Œç„¶åæ‰§è¡ŒPython setup.py installï¼Œç­‰å¾…å®‰è£…å®Œæ¯• ","date":"2019-05-09","objectID":"/posts/pyinstallererror/:3:0","tags":["Python","pyinstaller"],"title":"å®‰è£… pyinstaller å‡ºé”™çš„è§£å†³åŠæ³•åŠ csdn å·¥å…·å®ä¾‹æ‰“åŒ…","uri":"/posts/pyinstallererror/"},{"categories":["Python"],"content":"pyinstaller ç®€ä»‹ pyinstaller å°† Python è„šæœ¬æ‰“åŒ…æˆå¯æ‰§è¡Œç¨‹åºï¼Œä½¿åœ¨æ²¡æœ‰ Python ç¯å¢ƒçš„æœºå™¨ä¸Šè¿è¡Œã€‚ æœ€æ–°ç‰ˆæ˜¯ pyinstaller 3.4ï¼Œå¯è¿è¡Œåœ¨ Windowsï¼ŒMac å’Œ Linux æ“ä½œç³»ç»Ÿä¸‹ã€‚ ä½†å®ƒä¸æ˜¯è·¨ç¼–è¯‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ Windows ä¸‹ç”¨ PyInstaller ç”Ÿæˆçš„ exe åªèƒ½è¿è¡Œåœ¨ Windows ä¸‹ï¼Œåœ¨ Linux ä¸‹ç”Ÿæˆçš„åªèƒ½è¿è¡Œåœ¨ Linux ä¸‹ã€‚ ","date":"2019-05-09","objectID":"/posts/pyinstallererror/:4:0","tags":["Python","pyinstaller"],"title":"å®‰è£… pyinstaller å‡ºé”™çš„è§£å†³åŠæ³•åŠ csdn å·¥å…·å®ä¾‹æ‰“åŒ…","uri":"/posts/pyinstallererror/"},{"categories":["Python"],"content":"æ‰“åŒ… æ‰“åŒ…çš„ app é‡Œå¹¶ä¸åŒ…å«ä»»ä½•æºç ï¼Œä½†å°†è„šæœ¬çš„ .pyc æ–‡ä»¶æ‰“åŒ…äº†ã€‚ åŸºæœ¬è¯­æ³•ï¼š pyinstaller options myscript.py å¸¸ç”¨çš„å¯é€‰å‚æ•°å¦‚ä¸‹ï¼š --onefile å°†ç»“æœæ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ --onedir å°†æ‰€æœ‰ç»“æœæ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œè¯¥æ–‡ä»¶å¤¹åŒ…æ‹¬ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶æ‰§è¡Œæ—¶éœ€è¦çš„ä¾èµ–æ–‡ä»¶ï¼ˆé»˜è®¤ï¼‰ --paths=DIR è®¾ç½®å¯¼å…¥è·¯å¾„ --distpath=DIR è®¾ç½®å°†æ‰“åŒ…çš„ç»“æœæ–‡ä»¶æ”¾ç½®çš„è·¯å¾„ --specpath=DIR è®¾ç½®å°† spec æ–‡ä»¶æ”¾ç½®çš„è·¯å¾„ --windowed ä½¿ç”¨ windows å­ç³»ç»Ÿæ‰§è¡Œï¼Œä¸ä¼šæ‰“å¼€å‘½ä»¤è¡Œï¼ˆåªå¯¹ windows æœ‰æ•ˆï¼‰ --nowindowed ä½¿ç”¨æ§åˆ¶å°å­ç³»ç»Ÿæ‰§è¡Œï¼ˆé»˜è®¤ï¼‰ï¼ˆåªå¯¹ windows æœ‰æ•ˆï¼‰ --icon=\u003cFILE.ICO\u003e å°† file.ico æ·»åŠ ä¸ºå¯æ‰§è¡Œæ–‡ä»¶çš„èµ„æºï¼ˆåªå¯¹ windows æœ‰æ•ˆï¼‰ å¦‚pyinstaller --paths=\"D:\\\" test.py ","date":"2019-05-09","objectID":"/posts/pyinstallererror/:5:0","tags":["Python","pyinstaller"],"title":"å®‰è£… pyinstaller å‡ºé”™çš„è§£å†³åŠæ³•åŠ csdn å·¥å…·å®ä¾‹æ‰“åŒ…","uri":"/posts/pyinstallererror/"},{"categories":["Python"],"content":"CSDN è®¿é—®é‡è„šæœ¬å®ä¾‹ æ¯”å¦‚ï¼Œæ‹¿ä»¥å‰å†™çš„ä¸€ä¸ªåˆ· csdn è®¿é—®é‡å·¥å…· csdn.pyï¼ˆæ”¾åœ¨æ¡Œé¢ä¸Šï¼‰ï¼Œä»£ç è¯¦è§ åœ¨ cmd è¿›å…¥æ¡Œé¢è·¯å¾„ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ pyinstaller --onefile --nowindowed csdn.py ","date":"2019-05-09","objectID":"/posts/pyinstallererror/:6:0","tags":["Python","pyinstaller"],"title":"å®‰è£… pyinstaller å‡ºé”™çš„è§£å†³åŠæ³•åŠ csdn å·¥å…·å®ä¾‹æ‰“åŒ…","uri":"/posts/pyinstallererror/"},{"categories":["Java"],"content":" å®ç°ä¸€ä¸ªç®€å•çš„åŸºäºå•çº¿ç¨‹çš„èµ„æºä¸‹è½½å™¨ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œç”¨æˆ·å¯ä»¥ä»»æ„æŒ‡å®šä¸‹è½½èµ„æºçš„é“¾æ¥åœ°å€ï¼Œç³»ç»Ÿæ ¹æ®è¯¥åœ°å€åˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™å°†è¯¥èµ„æºä¸‹è½½åˆ°æœ¬åœ°ã€‚ ","date":"2019-05-08","objectID":"/posts/singlethreaddown/:0:0","tags":["GUI","URLConnection","HTTP","Java"],"title":"java å®ç°ä¸€ä¸ªå•çº¿ç¨‹çš„èµ„æºä¸‹è½½å™¨","uri":"/posts/singlethreaddown/"},{"categories":["Java"],"content":"GUI è®¾è®¡åŸºæœ¬æµç¨‹ å…ˆè®°å½•ä¸€ä¸‹ GUI è®¾è®¡çš„åŸºæœ¬æµç¨‹ï¼š æ ¹æ®éœ€è¦ä»ç›¸åº”çš„é¡¶å±‚å®¹å™¨ç»§æ‰¿ï¼ˆå¦‚æœåˆ›å»ºçª—ä½“å°±ç»§æ‰¿ JFrameï¼Œå¯¹è¯æ¡†å°±ç»§æ‰¿ JDialogï¼‰ï¼Œæ–°å»ºä¸€ä¸ªå­ç±»ã€‚ ç„¶åè®¾ç½®é¡¶å±‚å®¹å™¨çš„å±æ€§ï¼ŒåŒ…æ‹¬å¤§å°ã€ä½ç½®ã€æ ‡é¢˜å’Œå…³é—­äº‹ä»¶ç­‰ã€‚ è®¾ç½®ç•Œé¢ä¸Š GUI ç»„ä»¶çš„äº‹ä»¶å“åº”ã€‚ public void actionPerformed(ActionEvent e) {} å‘é¡¶å±‚å®¹å™¨ä¸Šæ·»åŠ  GUI ç»„ä»¶ï¼Œå¹¶è®¾ç½®å¸ƒå±€ã€‚ï¼ˆé€šå¸¸åˆ©ç”¨ JPanel ç»„ä»¶å…ˆä½œä¸ºå¾®å‹å®¹å™¨ï¼‰ åˆ›å»ºæ–°å»ºå­ç±»çš„å®ä¾‹ï¼Œè°ƒç”¨ setVisible(true) æ–¹æ³•æ˜¾ç¤ºé¡µé¢ã€‚ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥åœ¨å­ç±»ä¸­è®¾ç½® setVisible(true)ï¼‰ ","date":"2019-05-08","objectID":"/posts/singlethreaddown/:1:0","tags":["GUI","URLConnection","HTTP","Java"],"title":"java å®ç°ä¸€ä¸ªå•çº¿ç¨‹çš„èµ„æºä¸‹è½½å™¨","uri":"/posts/singlethreaddown/"},{"categories":["Java"],"content":"å®ç°ä»£ç  package cn.lruihao.base; import java.awt.FlowLayout; import java.awt.Font; import java.awt.HeadlessException; import java.awt.event.ActionEvent; import java.awt.event.ActionListener; import java.io.FileOutputStream; import java.io.InputStream; import java.net.URL; import java.net.URLConnection; import javax.swing.JButton; import javax.swing.JFrame; import javax.swing.JLabel; import javax.swing.JOptionPane; import javax.swing.JPanel; import javax.swing.JTextField; public class SingleThreadDown extends JFrame implements ActionListener { private final JPanel panel=new JPanel(); private final JLabel label1=new JLabel(\"ç½‘ç»œèµ„æºçš„å•çº¿ç¨‹ä¸‹è½½ï¼š\"); private final JLabel label2=new JLabel(\"ç½‘ç»œèµ„æºçš„ç½‘å€ï¼š\"); JButton StartButton = new JButton(\"å•å‡»å¼€å§‹ä¸‹è½½\"); JButton resetButton = new JButton(\"æ¸…ç©º\"); JButton exitButton = new JButton(\"é€€å‡º\"); JTextField urlField = new JTextField(20); public SingleThreadDown() { panel.setLayout(new FlowLayout()); //å¸ƒå±€ç®¡ç†å™¨ label1.setFont(new Font(\"é›…é»‘\",Font.BOLD,15)); panel.add(label1); panel.add(label2); panel.add(urlField); panel.add(StartButton); panel.add(resetButton); panel.add(exitButton); setContentPane(panel); setSize(400,200); setLocation(400,400); setVisible(true); //é¢æ¿å¯è§†åŒ–ï¼Œä¹Ÿå¯ä»¥åœ¨ main ä¸­é€šè¿‡ JFrame å­ç±»å¯¹è±¡è°ƒç”¨æ–¹æ³•è®¾ç½® setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); //é»˜è®¤å…³é—­äº‹ä»¶ StartButton.addActionListener(this);//æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œä¼ å…¥ ActionListener å¯¹è±¡ï¼Œç”±äºå­ç±»ç»§æ‰¿äº† ActionListener æ¥å£ï¼Œæ‰€ä»¥ this resetButton.addActionListener(this); exitButton.addActionListener(this); } public void download(String address) throws Exception { URL url = new URL(address); URLConnection urlcon = url.openConnection(); urlcon.connect(); InputStream in=urlcon.getInputStream();//è·å–çš„å­—èŠ‚æµå¯¹è±¡ String filePath = url.getFile(); int pos=filePath.lastIndexOf(\"/\"); //\"/\"åˆ†å‰²çš„æœ€åä¸€ä¸ªä¸²çš„ä¸‹æ ‡ String fileName = filePath.substring(pos+1); FileOutputStream out = new FileOutputStream(\"C:\\\\Users\\\\æç‘è±ªã€\\Desktop\\\\\"+fileName); byte[] b = new byte[1024]; int len=0; while((len=in.read(b,0,1024))!=-1) { out.write(b,0,len); } out.close(); in.close(); JOptionPane.showMessageDialog(this, \"ä¸‹è½½å®Œæ¯•\"); } @Override public void actionPerformed(ActionEvent e) { if(e.getSource()==StartButton) { if(\"\".equals(urlField.getText())){ JOptionPane.showMessageDialog(this, \"è¯·è¾“å…¥èµ„æºåœ°å€\"); } String url = urlField.getText(); try { download(url); } catch (Exception e1) { JOptionPane.showMessageDialog(this, \"èµ„æºåœ°å€æœ‰è¯¯ï¼Œè¯·æ£€æŸ¥~\"); e1.printStackTrace(); } }else if(e.getSource()==resetButton) { urlField.setText(\"\"); }else { System.exit(0); } } public static void main(String[] args) { new SingleThreadDown(); } } ","date":"2019-05-08","objectID":"/posts/singlethreaddown/:2:0","tags":["GUI","URLConnection","HTTP","Java"],"title":"java å®ç°ä¸€ä¸ªå•çº¿ç¨‹çš„èµ„æºä¸‹è½½å™¨","uri":"/posts/singlethreaddown/"},{"categories":["Java"],"content":"è¿è¡Œç»“æœæµ‹è¯• é€šè¿‡https://github.com/Lruihao/Grocery/raw/master/fonts/MMT_last.ttfä¸‹è½½æ²ç›®ä½“ ttf å­—ä½“æ–‡ä»¶ï¼Œç¨å¾®ç­‰å¾…ä¸€ä¸‹å¼¹å‡ºå¯¹è¯æ¡†â€œä¸‹è½½å®Œæ¯•â€ï¼Œç»æ£€æŸ¥ä¸‹è½½å†…å®¹æ­£å¸¸ã€‚ ","date":"2019-05-08","objectID":"/posts/singlethreaddown/:3:0","tags":["GUI","URLConnection","HTTP","Java"],"title":"java å®ç°ä¸€ä¸ªå•çº¿ç¨‹çš„èµ„æºä¸‹è½½å™¨","uri":"/posts/singlethreaddown/"},{"categories":["Python"],"content":" Jsonï¼ˆJavaScript Object Notationï¼‰å®ƒæ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå…·æœ‰æ•°æ®æ ¼å¼ç®€å•ï¼Œè¯»å†™æ–¹ä¾¿æ˜“æ‡‚ç­‰å¾ˆå¤šä¼˜ç‚¹ã€‚è®¸å¤šä¸»æµçš„ç¼–ç¨‹è¯­è¨€éƒ½åœ¨ç”¨å®ƒæ¥è¿›è¡Œå‰åç«¯çš„æ•°æ®ä¼ è¾“ï¼Œå¤§å¤§çš„ç®€åŒ–äº†æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„å¼€å‘å·¥ä½œé‡ã€‚ç›¸å¯¹äº XML æ¥è¯´ï¼Œæ›´åŠ çš„è½»é‡çº§ï¼Œæ›´æ–¹ä¾¿è§£æï¼Œå› æ­¤è®¸å¤šå¼€å‘è€…éƒ½éµå¾ª Json æ ¼å¼æ¥è¿›è¡Œæ•°æ®çš„ä¼ è¾“å’Œäº¤æ¢ã€‚ä»Šå¤©æˆ‘ä»¬è¯¦ç»†ä»‹ç»ä¸€ä¸‹ Python åœ¨ Json çš„ç¼–è§£ç æ–¹é¢çš„çŸ¥è¯†ã€‚ ","date":"2019-05-07","objectID":"/posts/jsoninfo/:0:0","tags":["Python","JSON","ä»–å±±ä¹‹çŸ³"],"title":"Python å¦‚ä½•æ“ä½œ Jsonï¼Ÿ","uri":"/posts/jsoninfo/"},{"categories":["Python"],"content":"json çš„æ•°æ®æ ¼å¼ åœ¨ json ä¸­ï¼Œéµå¾ªâ€œé”®å€¼å¯¹â€çš„è¿™æ ·ä¸€ç§æ–¹å¼ï¼Œæ¯”å¦‚ï¼šâ€œ{â€œnameâ€:â€œtomâ€}â€, å°±æ˜¯ä¸€ä¸ª json æ ¼å¼çš„æ•°æ®ï¼Œjson çš„æ ¼å¼å½’çº³ä¸‹æ¥ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š å¯¹è±¡é€šè¿‡é”®å€¼å¯¹è¡¨ç°ï¼› é”®é€šè¿‡åŒå¼•å·åŒ…è£¹ï¼Œåé¢è·Ÿå†’å·â€œ:â€ï¼Œç„¶åè·Ÿè¯¥é”®çš„å€¼ï¼› å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°å­—ã€æ•°ç»„ç­‰æ•°æ®ç±»å‹ï¼› å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´ç”¨é€—å·éš”å¼€ï¼› â€œ{}â€ç”¨æ¥è¡¨è¾¾å¯¹è±¡ï¼› â€œ[]â€ç”¨æ¥è¡¨è¾¾æ•°ç»„ï¼› æˆ‘ä»¬çœ‹ä¸€ä¸ªç•¥ä¸ºå¤æ‚ä¸€ç‚¹çš„ä¾‹å­ï¼š ä¸Šä¾‹åˆ™æ˜¯ä¸€ä¸ªå…¸å‹çš„ json æ ¼å¼çš„æ•°æ®ï¼Œå¼ºå¤§çš„ Python æä¾›äº†ä¸€ä¸ªâ€œjsonâ€æ¨¡å—ï¼Œå¯ä»¥æ–¹ä¾¿çš„å°†å„ç§é›¶æ•£çš„æ•°æ®é€šè¿‡æ¨¡å—çš„å†…ç½®å‡½æ•°ç¼–ç å½¢æˆä¸€ä¸ª json æ ¼å¼çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥å°†ä¸€ä¸ª json æ ¼å¼çš„æ•°æ®è§£ç å½¢æˆè‡ªå·±éœ€è¦çš„æ•°æ®ï¼Œéå¸¸å¥½ç”¨ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥ä»‹ç»ä¸€ä¸‹ã€‚ ","date":"2019-05-07","objectID":"/posts/jsoninfo/:1:0","tags":["Python","JSON","ä»–å±±ä¹‹çŸ³"],"title":"Python å¦‚ä½•æ“ä½œ Jsonï¼Ÿ","uri":"/posts/jsoninfo/"},{"categories":["Python"],"content":"json.dumps() json æ¨¡å—é‡Œçš„ dumps å‡½æ•°æ˜¯å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œå½¢æˆ json æ ¼å¼çš„æ•°æ®ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼š é€šè¿‡è¾“å‡ºçš„ç»“æœå¾ˆå®¹æ˜“çœ‹å‡ºï¼Œé€šè¿‡ dumps æ–¹æ³•ä½¿å­—å…¸è½¬æ¢æˆä¸ºäº† json æ ¼å¼ï¼Œè™½ç„¶å®ƒä»¬éå¸¸ç›¸ä¼¼ã€‚å…¶ä¸­ï¼Œåœ¨ dumps é‡Œçš„å‚æ•°â€œsort_keys=Trueâ€ï¼Œä½¿å¾—è¾“å‡º json åå¯¹ key å’Œ value è¿›è¡Œ 0~9ã€a~ z çš„é¡ºåºæ’åºï¼Œå¦‚æœä¸å¡«ï¼Œåˆ™æŒ‰ç…§æ— åºæ’åˆ—ã€‚æœ‰æ—¶å€™ï¼Œé€šè¿‡æ’åºå¯ä»¥æ–¹ä¾¿åœ°æ¯”è¾ƒ json ä¸­çš„æ•°æ®ï¼Œå› æ­¤ï¼Œé€‚å½“çš„æ’åºæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ æ­¤å¤–ï¼Œâ€œIndentâ€å‚æ•°è¡¨ç¤ºç¼©è¿›çš„æ„æ€ï¼Œå®ƒå¯ä»¥ä½¿å¾—è¾“å‡ºçš„ Json çœ‹èµ·æ¥æ›´åŠ æ•´é½å¥½çœ‹ï¼Œå¯è¯»æ€§æ›´å¼ºï¼Œä¾‹å¦‚ï¼š ä¸‹é¢åˆ—ä¸¾ä¸€ä¸‹ dumpsï¼ˆï¼‰çš„å¯å¡«å‚æ•°ï¼š skipkeyï¼šé»˜è®¤ä¸º Falseï¼Œå½“ dict å¯¹è±¡é‡Œçš„æ•°æ®ä¸æ˜¯ Python çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼›ï¼ˆstr,unicode,int,long,float,bool,Noneï¼‰æ—¶ï¼Œå½“ skipkey ä¸º Falseï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¦‚æœ skipkey ä¸º Trueï¼Œåˆ™å¯ä»¥è·³è¿‡è¿™ç±» keyï¼› indentï¼šå¦‚æœå¡« 0 æˆ–è€…ä¸å¡«ï¼Œåˆ™æŒ‰ç…§ä¸€è¡Œè¿›è¡Œæ‰“å°ï¼Œå¦åˆ™æŒ‰ç…§ indent çš„æ•°å€¼æ˜¾ç¤ºå‰é¢çš„ç©ºæ ¼ï¼ˆæ­£æ•´æ•°å½¢å¼ï¼‰ï¼› separatorsï¼šåˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸ºâ€œ(â€™,â€™,â€™:â€™)â€ï¼Œå®ƒè¡¨ç¤º key ä¹‹é—´ç”¨â€œ,â€éš”å¼€ï¼Œkey å’Œ value ä¹‹é—´ç”¨â€œ:â€éš”å¼€ï¼› encodingï¼šç¼–ç æ ¼å¼ï¼Œé»˜è®¤å€¼æ˜¯ UTF-8ï¼› sort_keysï¼šå¯¹ keyã€value è¿›è¡Œæ’åºï¼Œé»˜è®¤å€¼æ˜¯ Falseï¼Œå³ä¸æ’åºï¼› ensure_asciiï¼šé»˜è®¤ä¸º Trueï¼Œå¦‚æœ dict å¯¹è±¡é‡Œå«æœ‰ none-ASCII çš„å­—ç¬¦ï¼Œåˆ™æ˜¾ç¤ºã€uXX çš„æ ¼å¼ï¼Œå¦‚æœä¸º Falseï¼Œåˆ™èƒ½æ­£å¸¸æ˜¾ç¤ºå‡ºæ¥ï¼› ","date":"2019-05-07","objectID":"/posts/jsoninfo/:2:0","tags":["Python","JSON","ä»–å±±ä¹‹çŸ³"],"title":"Python å¦‚ä½•æ“ä½œ Jsonï¼Ÿ","uri":"/posts/jsoninfo/"},{"categories":["Python"],"content":"json.loads() å’Œ dumps ç›¸åï¼Œloads å‡½æ•°åˆ™æ˜¯å°† json æ ¼å¼çš„æ•°æ®è§£ç ï¼Œè½¬æ¢ä¸º Python å­—å…¸ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼š æœ‰æ—¶å€™ï¼Œè¾“å‡ºç»“æœé‡åˆ°ä¸­æ–‡çš„æ—¶å€™ï¼Œä¼šå‡ºç°ç¼–ç æ ¼å¼ä¸ä¸€æ ·çš„æƒ…å†µï¼Œæ˜¾ç¤ºå‡ºä¸º Unicode çš„ç¼–ç æ ¼å¼ï¼Œä½¿å¾—ä¸æ˜“è¯»æ‡‚ï¼Œè§£å†³åŠæ³•æ˜¯æ·»åŠ å‚æ•°â€œencodingâ€å‚æ•°ï¼Œå³ä¸Šé¢çš„æ”¹å†™æˆè¿™æ ·ï¼šd1 = json.loads(data1,encoding=â€˜utf-8â€™) å³å¯ã€‚ ","date":"2019-05-07","objectID":"/posts/jsoninfo/:3:0","tags":["Python","JSON","ä»–å±±ä¹‹çŸ³"],"title":"Python å¦‚ä½•æ“ä½œ Jsonï¼Ÿ","uri":"/posts/jsoninfo/"},{"categories":["Python"],"content":"json.dump() å’Œ json.load() ç›¸å¯¹äºä¸Šé¢æ‰€è®²çš„ dumps å’Œ loads æ¥è¯´ï¼Œdump å’Œ load å‡½æ•°çš„åŠŸèƒ½ç±»ä¼¼ï¼Œåªä¸è¿‡å‰è€…æ˜¯ç”¨æ¥å¤„ç†å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œè€Œåè€…æ˜¯ç”¨äºå¤„ç†æ–‡ä»¶ç±»å‹çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š ä¸Šä¾‹åˆ—ä¸¾å‡ºäº† json çš„å››ä¸ªæ–¹æ³•ï¼šdumpsï¼ˆï¼‰å’Œ dumpï¼ˆï¼‰ã€loadsï¼ˆï¼‰å’Œ loadï¼ˆï¼‰çš„ç®€å•ä½¿ç”¨æ–¹æ³•ï¼Œå¯è§ï¼ŒPython å¯¹äº json çš„å¤„ç†ç›¸å½“æ–¹ä¾¿ï¼Œä¸åƒ c++é‚£æ ·ï¼ˆè°ç”¨è°çŸ¥é“ï¼‰ã€‚ ","date":"2019-05-07","objectID":"/posts/jsoninfo/:4:0","tags":["Python","JSON","ä»–å±±ä¹‹çŸ³"],"title":"Python å¦‚ä½•æ“ä½œ Jsonï¼Ÿ","uri":"/posts/jsoninfo/"},{"categories":["Python"],"content":" é€šè¿‡ requests å¯ä»¥å‘æŸä¸ªåœ°å€å‘é€è¯·æ±‚ï¼Œå¯ä»¥ç”¨æ¥åšä¸€äº›æ¥å£çš„æµ‹è¯•ï¼›ä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š requests.get() requests.post() æœ€è¿‘å¸®æœ‹å‹çš„é¡¹ç›®åšä¸€ä¸ªå°éœ€æ±‚ï¼Œéœ€è¦æŠŠåå°æ•°æ®å®šæœŸæ‰“åŒ…å‘é€åˆ°å¾®ä¿¡ç¾¤ï¼Œéº»å°ç§‘æŠ€æ¶›å“¥ç»™äº†æˆ‘ä¸€ä¸ªæ¥å£ï¼Œpost è®¿é—®ã€‚ #!/usr/bin/python import requests \"\"\" é€šè¿‡ requests å¯ä»¥å‘æŸä¸ªåœ°å€å‘é€è¯·æ±‚ requests.post(url,json date) post æ–¹æ³•è¿˜æœ‰å…¶ä»–å‚æ•°ï¼Œå¦‚ header ç­‰ \"\"\" # post å‘é€çš„æ•°æ® postData = { # 'username':'test', # 'password':'123456', # 'salary':2000, } # æ¥å£è¿™é‡Œä¸ä¾¿å…¬å¼€ r = requests.post('http://demo.maxiaokeji.com/xx/xxxxx/xxxx',data=postData) # print(r.text) response=r.json() print(response) è¿è¡Œåä¼šåœ¨å±å¹•æ‰“å°å‡ºè¿”å›çš„ json æ•°æ® ","date":"2019-05-07","objectID":"/posts/posttest/:0:0","tags":["Python","HTTP"],"title":"python å‘é€ post è¯·æ±‚è¿›è¡Œç®€å•çš„æ¥å£æµ‹è¯•","uri":"/posts/posttest/"},{"categories":["Java"],"content":" è¯¥ä¾‹ä¸­é¦–å…ˆç”Ÿæˆä¸€ä¸ª URL å¯¹è±¡ lrhï¼ŒæŒ‡å‘ RUI è±ªå°æ ˆï¼Œç„¶åå†è°ƒç”¨ lrh.openStream() æ–¹æ³•ç”Ÿæˆè¯¥ URL çš„ä¸€ä¸ªè¾“å…¥æµï¼Œè¿™æ˜¯ä¸€ä¸ªå­—èŠ‚æµï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè¿›ä¸€æ­¥é€šè¿‡ InputStreamReader å’Œ BufferedReader æ„é€ ä¸€ä¸ªå¸¦ç¼“å†²åŠŸèƒ½çš„å­—ç¬¦æµï¼Œå¹¶é€šè¿‡è¿™ä¸ªå­—ç¬¦æµå¯¹è±¡è¯»å–è¯¥ URL çš„ html å†…å®¹ï¼Œè¿›è€Œè¾“å‡ºåˆ°æ¡Œé¢æ–‡ä»¶å’Œæ§åˆ¶å°å±å¹•ã€‚URLConnection ç±»ä¹Ÿå¯ä»¥ç”¨æ¥å¯¹ç”± URL å¼•ç”¨çš„èµ„æºè¿›è¡Œè¯»å†™æ“ä½œï¼Œå‰ææ˜¯å…ˆé€šè¿‡ connect() æ–¹æ³•å»ºç«‹è¿æ¥ï¼Œç„¶åå†å»è·å–å“åº”å¤´ä¿¡æ¯æˆ–å“åº”å†…å®¹ã€‚ package cn.lruihao.base; import java.io.BufferedReader; import java.io.File; import java.io.FileWriter; import java.io.InputStreamReader; import java.net.URL; import java.net.URLConnection; public class URLReader { public static void main(String[] args) throws Exception{ try { URL lrh=new URL(\"https://www.lruihao.cn\"); File file=new File(\"C:\\\\Users\\\\æç‘è±ªã€\\Desktop\\\\lrh.html\"); FileWriter fout=new FileWriter(file); BufferedReader in =new BufferedReader(new InputStreamReader(lrh.openStream()));//å­—èŠ‚æµè½¬åŒ–æˆå­—ç¬¦æµï¼Œå†æ„å»ºç¼“å†²å­—ç¬¦æµ String inputLine; while((inputLine=in.readLine())!=null) { System.out.println(inputLine); fout.write(inputLine); } in.close(); fout.close(); //è·å–å“åº” header ä¿¡æ¯ URLConnection conn=lrh.openConnection(); conn.connect(); System.out.println(\"è·å–åˆ°çš„å“åº”é•¿åº¦ï¼š\"+conn.getContentLength()); System.out.println(\"å“åº”ç±»å‹ï¼š\"+conn.getContentType()); //ç”¨ BufferedReader è¯»å– URL çš„å“åº” in =new BufferedReader(new InputStreamReader(conn.getInputStream())); String line; String result=null; while((line=in.readLine())!=null) { result+=line; } System.out.println(result); } catch (Exception e) { e.printStackTrace(); } } } ","date":"2019-05-06","objectID":"/posts/java-urlreader/:0:0","tags":["URLConnection","Java"],"title":"java é€šè¿‡ URL å’Œ URLConnection è®¿é—®ç½‘é¡µèµ„æº","uri":"/posts/java-urlreader/"},{"categories":["Java"],"content":" åŸºæœ¬åŠŸèƒ½ï¼š ç»™å®šä¸€ä¸ªå¯†é’¥ï¼Œè¯»å–æ–‡ä»¶å†…å®¹ï¼ŒåŠ å¯†åï¼Œè¾“å‡ºåˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶ã€‚ è¿™é‡Œä½¿ç”¨æ–‡ä»¶è¾“å…¥æµè¯»å–æ–‡ä»¶å†…å®¹ï¼Œç„¶åæ¯ä¸ªå­—èŠ‚å’Œå¯†ç è¿›è¡Œå¼‚æˆ–ç®€å•åŠ å¯†ã€‚åŠ å¯†å®Œæˆï¼Œä½¿ç”¨æ–‡ä»¶è¾“å‡ºæµå†™å…¥å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚è§£å¯†å’ŒåŠ å¯†æ–¹æ³•ä¸€æ ·ã€‚åˆ©ç”¨çš„æ˜¯å¯¹åŒä¸€ä¸ªæ•°å¼‚æˆ–ä¸¤éå…¶å€¼ä¸å˜çš„æ€§è´¨ã€‚å› æ­¤ä¸€ä¸ªç¨‹åºå¯ä»¥å®ŒæˆåŠ å¯†å’Œè§£å¯†åŠŸèƒ½ã€‚åªéœ€ä¿®æ”¹æ–‡ä»¶åå³å¯ã€‚ ","date":"2019-05-02","objectID":"/posts/byteio/:0:0","tags":["Java"],"title":"æ–‡ä»¶åŠ å¯†è§£å¯†ï¼ˆå­—èŠ‚æµï¼‰","uri":"/posts/byteio/"},{"categories":["Java"],"content":"æ–‡ä»¶åŠ å¯†è§£å¯† package cn.lruihao.base; import java.io.FileInputStream; import java.io.FileOutputStream; import java.io.IOException; public class EncryptFile { public static void main(String[] args) throws IOException { byte pwd=123;//åŠ å¯†/è§£å¯†å¯†ç  FileInputStream f=new FileInputStream(\"src/cn/lruihao/base/EncryptFile.java\");//å¾…åŠ å¯†æ–‡ä»¶ FileOutputStream fout=new FileOutputStream(\"encrypted.txt\");//å·²åŠ å¯†æ–‡ä»¶ System.out.println(\"å¼€å§‹åŠ å¯†ã€‚\"); int n=f.available()/5; byte[] b=new byte[n];//ä»¥ä¸€ä¸ªå­—èŠ‚æ•°ç»„çš„é•¿åº¦è¯»å–å’Œå¤åˆ¶ int count=0; while((count=f.read(b,0,n))!=-1) { //å†™å…¥ä¹‹å‰å…ˆåŠ å¯†/è§£å¯† for(int i=0;i\u003ccount;i++) { b[i]=(byte)(b[i]^pwd);// } fout.write(b,0,count); } System.out.println(\"å®ŒæˆåŠ å¯†\"); f.close(); fout.close(); // f=new FileInputStream(\"encrypted.txt\"); // fout=new FileOutputStream(\"unencrypted.txt\"); // System.out.println(\"å¼€å§‹è§£å¯†ã€‚\"); // n=f.available()/5; // b=new byte[n];//ä»¥ä¸€ä¸ªå­—èŠ‚æ•°ç»„çš„é•¿åº¦è¯»å–å’Œå¤åˆ¶ // count=0; // while((count=f.read(b,0,n))!=-1) { // //å†™å…¥ä¹‹å‰å…ˆåŠ å¯†/è§£å¯† // for(int i=0;i\u003ccount;i++) { // b[i]=(byte)(b[i]^pwd); // } // fout.write(b,0,count); // } // System.out.println(\"å®Œæˆè§£å¯†\"); // f.close(); // fout.close(); } } ","date":"2019-05-02","objectID":"/posts/byteio/:1:0","tags":["Java"],"title":"æ–‡ä»¶åŠ å¯†è§£å¯†ï¼ˆå­—èŠ‚æµï¼‰","uri":"/posts/byteio/"},{"categories":["Java"],"content":"æ–‡ä»¶å¤åˆ¶ package cn.lruihao.base; import java.io.FileInputStream; import java.io.FileOutputStream; import java.io.IOException; public class FileStreamCopy { public static void main(String[] args) throws IOException { int size; FileInputStream f=new FileInputStream(\"src/cn/lruihao/base/FileStreamCopy.java\"); FileOutputStream fout=new FileOutputStream(\"copy-of-file.txt\"); System.out.println(\"æ€»é•¿åº¦ï¼š\"+(size=f.available())); int n=size/10; System.out.print(\"ä½¿ç”¨å•å­—èŠ‚æ–¹æ³•è¯»å–åï¼š\"); for(int i=0;i\u003cn;i++) { fout.write(f.read()); } System.out.println(\"å‰©ä½™é•¿åº¦ï¼š\"+f.available()); System.out.println(\"è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°ç»„åï¼š\"); byte b[]=new byte[n]; f.read(b); fout.write(b); System.out.println(\"å‰©ä½™é•¿åº¦ï¼š\"+f.available()); System.out.println(\"è¯»å–ä½™ä¸‹æ•°æ®ï¼š\"); int count=0; while((count=f.read(b,0,n))!=-1) { //System.out.println(count); fout.write(b,0,count); } System.out.println(\"å‰©ä½™é•¿åº¦ï¼š\"+f.available()); f.close(); fout.flush(); fout.close(); } } package cn.lruihao.base; import java.io.BufferedInputStream; import java.io.BufferedOutputStream; import java.io.FileInputStream; import java.io.FileOutputStream; import java.io.IOException; public class BufferedStreamCopy { public static void main(String[] args) throws IOException { FileInputStream f=new FileInputStream(\"src/cn/lruihao/base/BufferedStreamCopy.java\"); FileOutputStream fout=new FileOutputStream(\"copy-of-file.txt\"); BufferedInputStream bis=new BufferedInputStream(f); BufferedOutputStream bos=new BufferedOutputStream(fout); System.out.println(\"å¼€å§‹å¤åˆ¶ã€‚\"); int n=f.available()/5; byte[] b=new byte[n]; int count=0; while((count=bis.read(b,0,n))!=-1) { bos.write(b,0,count); } System.out.println(\"å¤åˆ¶å®Œæˆ\"); bis.close(); bos.flush(); bos.close(); f.close(); fout.flush(); fout.close(); } } ","date":"2019-05-02","objectID":"/posts/byteio/:2:0","tags":["Java"],"title":"æ–‡ä»¶åŠ å¯†è§£å¯†ï¼ˆå­—èŠ‚æµï¼‰","uri":"/posts/byteio/"},{"categories":["Java"],"content":"å®ç°ä»£ç  è¿™é‡Œçš„å¼‚å¸¸ä¸»è¦æ˜¯InputMismatchException, å¯ä»¥ç›´æ¥æ•è·è¯¥å¼‚å¸¸ï¼Œæˆ‘ç›´æ¥æ•è·äº†çˆ¶ç±»å¼‚å¸¸ã€‚ package cn.lruihao.Exception; import java.util.Scanner; /** * @author æç‘è±ª * å€Ÿä¹¦ç³»ç»Ÿï¼ˆå¼‚å¸¸ç»ƒä¹ ï¼‰ */ public class ExceptionDemo { private final Book[] books = { new Book(\"æ•°æ®ç»“æ„\"), new Book(\"Java\"), new Book(\"php\"), new Book(\"c\") }; public static void main(String[] args) { System.out.println(\"æ¬¢è¿æ¥åˆ°å€Ÿä¹¦ç³»ç»Ÿï¼\"); ExceptionDemo jieshu= new ExceptionDemo(); jieshu.menu(); } public void menu() { System.out.println(\"è¾“å…¥å‘½ä»¤ï¼š1. ä¹¦åæŸ¥æ‰¾ï¼›\\t2. åºå·æŸ¥æ‰¾ï¼›\"); //åˆå§‹åŒ–å¹¶æ•è·ç”¨æˆ·è¾“å…¥ Scanner sc = new Scanner(System.in); // æ•è·å¼‚å¸¸ try { int id =sc.nextInt(); if(id==1||id==2) { inquire(id); }else { System.out.println(\"è¾“å…¥é”™è¯¯ï¼è¯·æ ¹æ®æç¤ºè¾“å…¥~~\");//è¾“å…¥é 1ï¼Œ2 çš„æ•°å­—æƒ…å†µ menu(); } }catch (Exception e) {//è¾“å…¥å­—ç¬¦ä¸ºéæ•°å­— e.printStackTrace(); System.out.println(\"è¾“å…¥é”™è¯¯ï¼Œè¯·è¾“å…¥æ•°å­—å‘½ä»¤~~\"); menu(); }finally{ sc.close(); } } private void inquire(int id) { Scanner sc = new Scanner(System.in); if(id==1) { System.out.println(\"è¯·è¾“å…¥è¦æŸ¥æ‰¾çš„ä¹¦åï¼\"); String name=sc.nextLine(); int num=FindName(name); if(num==0?false:true) {//éªŒè¯ä¹¦åæ˜¯å¦å­˜åœ¨ å­˜åœ¨åˆ™æ‰“å° System.out.println(\"bookï¼š\"+name+\"\\t åºå·ï¼š\"+num); //menu();//å›åˆ°è®¿é—®èµ·ç‚¹ ä¹Ÿå¯ä»¥å»æ‰ç»ˆæ­¢ç¨‹åº }else{ System.out.println(\"å›¾ä¹¦ä¸å­˜åœ¨\"); menu(); } sc.close(); }else if(id == 2) { System.out.println(\"è¯·è¾“å…¥æ‚¨è¦æŸ¥æ‰¾çš„åºå·ï¼š\"); int id2=sc.nextInt(); FindNum(id2); sc.close(); } } private void FindNum(int num) { try { if(num\u003e=0\u0026\u0026num\u003cbooks.length) { System.out.println(books[num].getName()); //menu();//å›åˆ°è®¿é—®èµ·ç‚¹ ä¹Ÿå¯ä»¥å»æ‰ç»ˆæ­¢ç¨‹åº }else{ System.out.println(\"å›¾ä¹¦ä¸å­˜åœ¨\"); menu(); } }catch (Exception e) { e.printStackTrace(); System.out.println(\"è¾“å…¥æœ‰è¯¯ï¼~~\"); } } private int FindName(String name) { int num=0; for(Book i:books) { String name1=i.getName(); if(name1.equals(name)) { return num; } num++; } return 0; } } package cn.lruihao.Exception; public class Book { private String name; public String getName() { return name; } public void setName(String name) { this.name = name; } public Book(String name) { this.name = name; } } ","date":"2019-05-01","objectID":"/posts/javaexception/:1:0","tags":["Java"],"title":"æ¨¡æ‹Ÿå€Ÿä¹¦ç³»ç»Ÿï¼ˆjava å¼‚å¸¸ç»ƒä¹ ï¼‰","uri":"/posts/javaexception/"},{"categories":["Java"],"content":"å¤§è‡´è¿è¡Œæ•ˆæœ ","date":"2019-05-01","objectID":"/posts/javaexception/:2:0","tags":["Java"],"title":"æ¨¡æ‹Ÿå€Ÿä¹¦ç³»ç»Ÿï¼ˆjava å¼‚å¸¸ç»ƒä¹ ï¼‰","uri":"/posts/javaexception/"},{"categories":["çæŠ˜è…¾","Python"],"content":" Python äºŒç»´ç ç”Ÿæˆå™¨æ˜¯ github ä¸Š@sylnsfar å¼€æºçš„ä¸€ä¸ª python ç”ŸæˆäºŒç»´ç å·¥å…·ã€‚æœ‰ python, ç½‘é¡µåŠ exe ç‰ˆæœ¬ï¼Œè¯¦è§ sylnsfar/qrcodeï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»è®°å½•ä¸€ä¸‹ python ç‰ˆæœ¬ä½¿ç”¨ã€‚exe å¯ä»¥å» é¡¹ç›®å¼€æºåœ°å€ ä¸‹è½½ï¼Œå…¬ä¼—å·æ–‡ç« åå°å›å¤å…³é”®è¯â€œqrcodeâ€è·å–é“¾æ¥ã€‚ å¯ç”Ÿæˆæ™®é€šäºŒç»´ç ã€å¸¦å›¾ç‰‡çš„è‰ºæœ¯äºŒç»´ç ï¼ˆé»‘ç™½ä¸å½©è‰²ï¼‰ã€åŠ¨æ€äºŒç»´ç ï¼ˆé»‘ç™½ä¸å½©è‰²ï¼‰ã€‚ ","date":"2019-04-27","objectID":"/posts/qrcode/:0:0","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["çæŠ˜è…¾","Python"],"content":"ç¤ºä¾‹ from MyQR import myqr import os version, level, qr_name = myqr.run( words='https://lruihao.cn', version=1, level='H', picture='2.jpg', colorized=True, contrast=1.0, brightness=1.0, save_name=None, save_dir=os.getcwd() ) # help(myqr) # https://github.com/sylnsfar/qrcode/ ''' Positional parameter words: str # é“¾æ¥æˆ–è€…æ–‡å­— Optional parameters version: int, from 1 to 40 # æ§åˆ¶è¾¹é•¿ level: str, just one of ('L','M','Q','H') # æ§åˆ¶çº é”™æ°´å¹³ï¼Œä»å·¦åˆ°å³ä¾æ¬¡å‡é«˜ã€‚ picutre: str, a filename of a image # å›¾ç‰‡ï¼Œéœ€åœ¨åŒè·¯å¾„ï¼Œé»˜è®¤ None colorized: bool # æ˜¯å¦å½©è‰² é»˜è®¤ False constrast: float # å¯¹æ¯”åº¦ é»˜è®¤ 1.0 brightness: float # äº®åº¦ é»˜è®¤ 1.0 save_name: str, the output filename like 'example.png' #æ§åˆ¶æ–‡ä»¶åï¼Œé»˜è®¤ None,'qrcode.png' save_dir: str, the output directory # å‚¨å­˜è·¯å¾„ ''' ","date":"2019-04-27","objectID":"/posts/qrcode/:1:0","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["çæŠ˜è…¾","Python"],"content":"å®‰è£… # é€šè¿‡ pip pip(3) install myqr(or MyQR) ","date":"2019-04-27","objectID":"/posts/qrcode/:2:0","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["çæŠ˜è…¾","Python"],"content":"ä½¿ç”¨æ–¹æ³• ","date":"2019-04-27","objectID":"/posts/qrcode/:3:0","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["çæŠ˜è…¾","Python"],"content":"å‘½ä»¤è¡Œæ–¹å¼ ï¼ˆæç¤ºï¼šå¦‚æœä½ å°šæœªå®‰è£… MyQR ï¼Œä»¥ä¸‹å†…å®¹è¯·ä½¿ç”¨python(3) myqr.py è€Œémyqr ã€‚ï¼‰ # æ¦‚æ‹¬ myqr Words [-v {1,2,3,...,40}] [-l {L,M,Q,H}] [-n output-filename] [-d output-directory] [-p picture_file] [-c] [-con contrast] [-bri brightness] æ™®é€šäºŒç»´ç  ä»‹ç»äº† Words, -v, -l, -n, -d è‰ºæœ¯äºŒç»´ç  ä»‹ç»äº† -p, -c, -con, -bri åŠ¨æ€ GIF äºŒç»´ç  ä»‹ç»äº†åŠ¨æ€çš„ç”Ÿæˆæ–¹æ³•å’Œæ³¨æ„ç‚¹ æ™®é€šäºŒç»´ç  #1 Words myqr https://github.com åœ¨å‘½ä»¤åè¾“å…¥é“¾æ¥æˆ–è€…å¥å­ä½œä¸ºå‚æ•°ï¼Œç„¶ååœ¨ç¨‹åºçš„å½“å‰ç›®å½•ä¸­äº§ç”Ÿç›¸åº”çš„äºŒç»´ç å›¾ç‰‡æ–‡ä»¶ï¼Œé»˜è®¤å‘½åä¸º â€œqrcode.pngâ€ã€‚ #2 -v, -l myqr https://github.com -v 10 -l Q é»˜è®¤è¾¹é•¿æ˜¯å–å†³äºä½ è¾“å…¥çš„ä¿¡æ¯çš„é•¿åº¦å’Œä½¿ç”¨çš„çº é”™ç­‰çº§ï¼› è€Œé»˜è®¤çº é”™ç­‰çº§æ˜¯æœ€é«˜çº§çš„ Hã€‚ è‡ªå®šä¹‰ï¼šå¦‚æœæƒ³è¦æ§åˆ¶è¾¹é•¿å’Œçº é”™æ°´å¹³å°±ä½¿ç”¨ -v å’Œ -l å‚æ•°ã€‚ -v æ§åˆ¶è¾¹é•¿ï¼ŒèŒƒå›´æ˜¯** 1 è‡³ 40**ï¼Œæ•°å­—è¶Šå¤§è¾¹é•¿è¶Šå¤§ï¼› -l æ§åˆ¶çº é”™æ°´å¹³ï¼ŒèŒƒå›´æ˜¯** Lã€Mã€Qã€H**ï¼Œä»å·¦åˆ°å³ä¾æ¬¡å‡é«˜ã€‚ #3 -n, -d myqr https://github.com -n github_qr.jpg -d .../paths/ é»˜è®¤è¾“å‡ºæ–‡ä»¶åæ˜¯â€œ qrcode.png â€œï¼Œè€Œé»˜è®¤å­˜å‚¨ä½ç½®æ˜¯å½“å‰ç›®å½•ã€‚ è‡ªå®šä¹‰ï¼šå¯ä»¥è‡ªå·±å®šä¹‰è¾“å‡ºåç§°å’Œä½ç½®ã€‚æ³¨æ„åŒåæ–‡ä»¶ä¼šè¦†ç›–æ—§çš„ã€‚ -n æ§åˆ¶æ–‡ä»¶åï¼Œæ ¼å¼å¯ä»¥æ˜¯ .jpgï¼Œ .png ï¼Œ.bmp ï¼Œ.gif ï¼› -d æ§åˆ¶ä½ç½®ã€‚ è‰ºæœ¯äºŒç»´ç  #1 -p myqr https://github.com -p github.jpg å‚æ•°-p ç”¨æ¥å°† QR äºŒç»´ç å›¾åƒä¸ä¸€å¼ åŒç›®å½•ä¸‹çš„å›¾ç‰‡ç›¸ç»“åˆï¼Œäº§ç”Ÿä¸€å¼ é»‘ç™½å›¾ç‰‡ã€‚ #2 -c myqr https://github.com -p github.jpg -c åŠ ä¸Šå‚æ•° -c å¯ä»¥ä½¿äº§ç”Ÿçš„å›¾ç‰‡ç”±é»‘ç™½å˜ä¸ºå½©è‰²çš„ã€‚ #3 -con, -bri myqr https://github.com -p github.jpg [-c] -con 1.5 -bri 1.6 å‚æ•°-con ç”¨ä»¥è°ƒèŠ‚å›¾ç‰‡çš„å¯¹æ¯”åº¦ï¼Œ1.0 è¡¨ç¤ºåŸå§‹å›¾ç‰‡ï¼Œæ›´å°çš„å€¼è¡¨ç¤ºæ›´ä½å¯¹æ¯”åº¦ï¼Œæ›´å¤§åä¹‹ã€‚é»˜è®¤ä¸º 1.0ã€‚ å‚æ•° -bri ç”¨æ¥è°ƒèŠ‚å›¾ç‰‡çš„äº®åº¦ï¼Œå…¶ä½™ç”¨æ³•å’Œå–å€¼ä¸ -con ç›¸åŒã€‚ åŠ¨æ€ GIF äºŒç»´ç  åŠ¨æ€äºŒç»´ç ä¸ä¸Šè¿°çš„å¸¦å›¾ç‰‡çš„äºŒç»´ç çš„ç”Ÿæˆæ–¹æ³•æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½ åªè¦é‡‡ç”¨ .gif æ ¼å¼çš„å›¾ç‰‡å³å¯ç”Ÿæˆé»‘ç™½æˆ–è€…å½©è‰²çš„åŠ¨æ€äºŒç»´ç ã€‚ä½†æ³¨æ„å¦‚æœä½¿ç”¨äº† -n å‚æ•°è‡ªå®šä¹‰è¾“å‡ºçš„æ–‡ä»¶åï¼Œåˆ‡è®°å…¶æ ¼å¼ä¹Ÿå¿…é¡»æ˜¯ .gif æ ¼å¼ã€‚ ","date":"2019-04-27","objectID":"/posts/qrcode/:3:1","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["çæŠ˜è…¾","Python"],"content":"ä½œä¸ºå¯¼å…¥æ–‡ä»¶ # å®‰è£…æ¨¡å—å from MyQR import myqr version, level, qr_name = myqr.run( words, version=1, level='H', picture=None, colorized=False, contrast=1.0, brightness=1.0, save_name=None, save_dir=os.getcwd() ) ä»¥ä¸‹å„ä¸ªå‚æ•°å·²ç»åœ¨ä¸Šæ–‡å‘½ä»¤è¡Œæ–¹å¼æœ‰æ‰€ä»‹ç» # help(myqr) Positional parameter words: str Optional parameters version: int, from 1 to 40 level: str, just one of ('L','M','Q','H') picutre: str, a filename of a image colorized: bool constrast: float brightness: float save_name: str, the output filename like 'example.png' save_dir: str, the output directory ","date":"2019-04-27","objectID":"/posts/qrcode/:3:2","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["çæŠ˜è…¾","Python"],"content":"ä½¿ç”¨æç¤º è¯·é‡‡ç”¨æ­£æ–¹å½¢æˆ–è¿‘ä¼¼æ­£æ–¹å½¢çš„å›¾ç‰‡ å»ºè®®åœ¨å›¾ç‰‡å°ºå¯¸å¤§çš„æ—¶å€™ä½¿ç”¨ -v çš„å€¼ä¹Ÿåº”è¯¥é€‚å½“å˜å¤§ã€‚ ","date":"2019-04-27","objectID":"/posts/qrcode/:4:0","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["çæŠ˜è…¾","Python"],"content":"å¯ç”¨å­—ç¬¦ æ•°å­— 0 åˆ° 9 å¤§å°å†™çš„è‹±æ–‡å­—æ¯ å¸¸ç”¨è‹±æ–‡æ ‡ç‚¹ç¬¦å·å’Œç©ºæ ¼ Â· , . : ; + - * / \\ ~ ! @ # $ % ^ \u0026 ` ' = \u003c \u003e [ ] ( ) ? _ { } | and (space) ","date":"2019-04-27","objectID":"/posts/qrcode/:5:0","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["çæŠ˜è…¾","Python"],"content":"ä¾èµ–åº“ pillow numpy imageio ","date":"2019-04-27","objectID":"/posts/qrcode/:6:0","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["çæŠ˜è…¾","Python"],"content":"è¿è¡Œç¯å¢ƒ Linux, Python 3 Windows, Python 3 Mac, Python 3 ","date":"2019-04-27","objectID":"/posts/qrcode/:7:0","tags":["pillow","numpy","imageio","Python"],"title":"ç”¨ MyQR åˆ¶ä½œä¸“å±åŠ¨æ€äºŒç»´ç  (py å’Œ exe ç‰ˆæœ¬ï¼‰","uri":"/posts/qrcode/"},{"categories":["éšç¬”"],"content":" æ—¶é—´è¿‡å¾—çœŸå¿«ï¼Œä¸€ä¸‹ä»å¤§ä¸€åˆ°äº†å¤§ä¸‰ï¼Œé©¬ä¸Šå°±è¦å®ä¹ æ¯•ä¸šç­‰ç­‰äº†ã€‚ Success å¯Œå£«åº·åœ¨å­¦æ ¡æœ‰ä¸€ä¸ªæ˜¥æ‹›çš„æœºä¼šï¼Œæˆ‘å’Œæœ‹å‹æŠ±ç€ä¾¥å¹¸çš„å¿ƒç†å»è¯•äº†è¯•ã€‚ è™½ç„¶æ·±çŸ¥è‡ªå·±è¿˜èº«æœ‰å¾ˆå¤šç¼ºç‚¹ï¼Œä½†æ˜¯ä¸é¢è¯•ä¸çŸ¥é“ï¼Œä¸€é¢è¯•éƒ½æš´éœ²å‡ºæ¥äº†ï¼Œä»¥ä¸‹è®°å½•ä¸€ä¸‹è‡ªå·±çš„ä¸è¶³ä¹‹å¤„ï¼š php å’Œ sql çš„ç»å…¸ç»„åˆè™½ç„¶æœ‰æ‰€æ¥è§¦äº†è§£ï¼Œä½†æ˜¯ç¡®å®ä»€ä¹ˆéƒ½ä¼šï¼Œå¾—èŠ±æ—¶é—´å­¦ html/css ç­‰è™½ç„¶å¹³æ—¶æŠ˜è…¾åšå®¢è¿™äº›åº”ç”¨çš„æ¯”è¾ƒå¤šï¼Œä½†æ˜¯ä»Šå¤©ç«Ÿç„¶ç´§å¼ åœ°å¿˜è®°äº† margin å’Œ padding éƒ½ä¸ä¼šå†™äº† å¦‚ä¸Šä¸€æ¡ï¼Œå…¬ä¼—è¡¨ç°èƒ½åŠ›æœ‰å¾…åŠ å¼ºã€‚æ­£å¦‚å½“ä»Šâ€œé…’é¦™ä¹Ÿæ€•å··å­æ·±â€ï¼Œä½•å†µâ€œä¸é¦™â€ã€‚ æƒŠå–œçš„äº‹è¯´æ¥å°±æ¥ï¼Œæœ¬æ¥çŸ¥é“è‡ªå·±è¿™ä¹ˆå¤šç¼ºç‚¹ï¼Œè¿™ä¹ˆèœåï¼Œè§‰å¾—è¿™ä¸ªå®ä¹ çš„ offer æ˜¯æ²¡æˆäº†ï¼Œæ²¡æƒ³åˆ°ä¸‹åˆæŠ€æœ¯ä¸»ç®¡å¾®ä¿¡å‘æ¥æ¶ˆæ¯ï¼Œè¯´å½•ç”¨äº†ã€‚å½“åœºæ‡µé€¼ï¼Œå—å® è‹¥æƒŠçš„æ„Ÿè§‰ï¼éå¸¸è°¢è°¢é¢è¯•å®˜è€å¸ˆï¼ æ— è®ºç”Ÿæ´»è¿˜æ˜¯å­¦ä¹ ï¼Œå¸Œæœ›ä»¥åçš„è‡ªå·±ä¸€å®šè¦ä¿æŒä¸€é¢—è°¦é€Šçˆ±å­¦çš„å¿ƒï¼Œæ—©æ—¥å®ç°å…¨æ ˆå·¥ç¨‹å¸ˆçš„æ¢¦æƒ³ï¼Œè¿˜æœ‰æ—©ç‚¹å­˜é’±æŠŠå¤§å­¦å­¦è´¹çš„è´·æ¬¾è¿˜æ‰ï¼ ","date":"2019-04-24","objectID":"/posts/1thintervivew/:0:0","tags":["é¢è¯•"],"title":"ç¬¬ä¸€æ¬¡é¢è¯•ç»å†","uri":"/posts/1thintervivew/"},{"categories":["çæŠ˜è…¾","Python"],"content":" ä»¥ä¸‹ç¨‹åºå¯¹ è¯¥ç½‘å€ å†…çš„æ‰‹å†™ä½“å›¾ç‰‡è¿›è¡Œçˆ¬å–ï¼è¿™ä¸ªæ‰‹å†™ä½“æ˜¯æˆ‘åœ¨æ‰‹æœºä¸Šé€šè¿‡ã€Šæ‰‹è¿¹é€ å­—ã€‹app ä¹¦å†™çš„ï¼Œå¤§æ¦‚ 6886 ä¸ªå­—ç¬¦ï¼Œå†æ—¶ä¸¤å¹´å¤šï¼Œç›®å‰ä»åœ¨ä¿®æ”¹ä¸­ã€‚å­—ä½“æ•ˆæœæŸ¥çœ‹ ","date":"2019-04-22","objectID":"/posts/mmtimgpy/:0:0","tags":["Python"],"title":"python çˆ¬å–ç½‘ç«™å›¾ç‰‡ï¼ˆå›¾ç‰‡é“¾æ¥ç›¸ä¼¼ï¼‰","uri":"/posts/mmtimgpy/"},{"categories":["çæŠ˜è…¾","Python"],"content":"æ€è·¯è®¾è®¡ é€šè¿‡è§‚å¯Ÿç›®æ ‡ç½‘é¡µä¸­å­—ç¬¦å›¾ç‰‡çš„é“¾æ¥ï¼Œå¾ˆå®¹æ˜“å‘ç°æ¯ä¸ªå­—ç¬¦å›¾ç‰‡çš„ç›´é“¾æ˜¯ç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚ å›ºå®šé“¾æ¥ å›¾ç‰‡æ–‡ä»¶ç¼–å· å…¶ä¸­å›ºå®šè¿æ¥ä¸ºhttps://image.xiezixiansheng.com/users/2010/700/unzip/579767/, å›¾ç‰‡æ–‡ä»¶ä¸ºxxxxx.png@50qï¼Œå¦‚æœå»æ‰@50qï¼Œè·å–åˆ°çš„å›¾ç‰‡å°±æ˜¯é€æ˜èƒŒæ™¯çš„ä¸ç„¶å°±æ˜¯ç™½è‰²èƒŒæ™¯ã€‚ç„¶åå‘ç°ç¼–å·å¤§å¤šæ˜¯ 5 ä½æ•°çš„å½¢å¼ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€äº›æ˜¯ 4 ä½çš„ï¼Œç”šè‡³è¿˜æœ‰ 2-3 ä½çš„æ•°å­—ã€‚ä»”ç»†çœ‹çœ‹ 127 å‰çš„ç¼–å·éƒ½æ˜¯ä¸€äº›å›½é™…ç¬¦å·è¯¸å¦‚è‹±æ–‡å’Œæ•°å­—ç­‰ã€‚æ¯”å¯¹ä¸€ä¸‹å‘ç°æ­£æ˜¯ ASCII ç å¯¹åº”çš„å‘½åæ–¹å¼ã€‚å¯æƒ³è€ŒçŸ¥ä¸­æ–‡è‡ªç„¶ä¹Ÿæ˜¯é€šè¿‡ç¼–ç æ¥å‘½åçš„ã€‚ä¸€ä¸ªæ ‡å‡†çš„å­—åº“æ–‡ä»¶è‡³å°‘åŒ…å« 6763 ä¸ªæ±‰å­—ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä¹¦å†™çš„è¿™ä¸ªGB2312-80, èŒƒå›´ï¼š 0xA1A1 - 0xFEFEï¼Œå…¶ä¸­æ±‰å­—èŒƒå›´ï¼š 0xB0A1 - 0xF7FEã€‚ä¸¤ä¸ª 16 è¿›åˆ¶ä½å¯¹åº”ä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªæ±‰å­—è‡³å°‘ç”±ä¸¤ä¸ªå­—èŠ‚ç»„æˆï¼Œè¿™æ ·ç†è§£ï¼ŒèŒƒå›´è‡ªç„¶æ˜¯ 4 ä¸ª 16 è¿›åˆ¶ä½ã€‚æ‰€ä»¥è½¬æ¢æˆ 10 è¿›åˆ¶ï¼ŒèŒƒå›´å¤§è‡´åœ¨ 65278 ä»¥ä¸‹ã€‚è¦äº†è§£æ›´åŠ å…·ä½“ä¸€ç‚¹çš„èŒƒå›´è¿˜éœ€è¦å»æŸ¥ä¸€ä¸‹æ±‰å­—ç¼–ç çš„åˆ†åŒºç­‰ã€‚è¿™é‡Œæš‚æ—¶ä¸å¿…äº†è§£ï¼Œå› ä¸ºæœ¬æ¥å°±æ‰“ç®—æš´åŠ›ä¸‹è½½ã€‚ è¯´äº†è¿™ä¹ˆå¤šï¼Œæ—¢ç„¶å›¾ç‰‡é“¾æ¥è¿™ä¹ˆç®€å•ï¼Œæ‰€ä»¥æˆ‘æ˜¯æƒ³æš´åŠ›éå†ï¼Œæœç´¢å›¾ç‰‡ï¼Œåˆ¤æ–­é“¾æ¥çŠ¶æ€ç ï¼Œç„¶åä¸‹è½½å›¾ç‰‡ã€‚ ","date":"2019-04-22","objectID":"/posts/mmtimgpy/:1:0","tags":["Python"],"title":"python çˆ¬å–ç½‘ç«™å›¾ç‰‡ï¼ˆå›¾ç‰‡é“¾æ¥ç›¸ä¼¼ï¼‰","uri":"/posts/mmtimgpy/"},{"categories":["çæŠ˜è…¾","Python"],"content":"æºç è®¾è®¡ å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªèŒƒå›´å§ è‹±æ–‡å­—ç¬¦ ä¸­æ–‡ç¬¦å· æ±‰å­—èŒƒå›´ æˆ‘ä¸»è¦åˆ†è¿™å‡ ä¸ªåŒºé—´æŸ¥æ‰¾ 33 ~ 126 8212 ~ 8243 12289 ~ 12305 19968 ~ 40864 65281 ~ 65509 ç£¨åˆ€ä¸è¯¯ç æŸ´å·¥ï¼Œåˆ†æè§‚å¯Ÿäº†è¿™ä¹ˆä¹…ï¼Œç»ˆäºå¯ä»¥è¿è¡Œç¨‹åºäº†ï¼ŒF5 åå°±é™é™ç­‰å¾…å§ï¼Œå¯ä»¥å»çœ‹çœ‹ javaï¼Œæˆ–è€…æ‰“ä¸€æŠŠç‹è€… hhhhh! import os import requests path=\"C:\\\\Users\\\\æç‘è±ªã€\\Desktop\\\\MMT_images\\\\\" #ä¸‹è½½è·¯å¾„ï¼š ç»å¯¹æˆ–è€…ç›¸å¯¹è·¯å¾„æ¯”å¦‚ã€‚/image/ os.makedirs(path+\"0\\\\\", exist_ok=True) ## åˆ›å»ºæ–‡ä»¶å¤¹ os.makedirs(path+\"1\\\\\", exist_ok=True) ## ä¸‹è½½å›¾ç‰‡ def urllib_download(url,num): ## ï¼ˆä¸‹è½½é“¾æ¥ï¼Œå›¾ç‰‡ç¼–å·ï¼‰ from urllib.request import urlretrieve urlretrieve(url,path+num+\".png\") ## åˆ¤æ–­çŠ¶æ€ç  def get_status(url): r = requests.get(url, allow_redirects = False) return r.status_code def main(): BASE_URL = \"https://image.xiezixiansheng.com/users/2010/700/unzip/579767/\" n=33 total=0 print(\"æ­£åœ¨çˆ¬å–ç¬¬ 1 å¼ å›¾ç‰‡ï¼\") while n \u003c 65510: #åˆ†æ®µçˆ¬å–ï¼Œä¸ç„¶ä¼šè¶…æ—¶ï¼ï¼ï¼## 33 ~ 126 ## 8212 ~ 8243 ## 12289 ~ 12305 ## 19968 ~ 40864 ## 65281 ~ 65509 if n == 127: n = 8212 continue elif n == 8244: n = 12289 continue elif n ==12306: n = 19968 continue elif n == 40865: n = 65281 continue ## for n in range(37341,40865): num = str(n) IMAGE_URL = BASE_URL+num+\".png\" ## xxx.png æ˜¯é€æ˜èƒŒæ™¯ï¼Œxxx.png@50q æ˜¯ç™½è‰²èƒŒæ™¯ï¼Œåˆ†åˆ«å­˜æ”¾åœ¨ 0ï¼Œ1 æ–‡ä»¶å¤¹ p æ˜¯ä¸­å° w æ˜¯å°å›¾ if(get_status(IMAGE_URL)==200): ## åŒæ—¶ä¸‹è½½é€æ˜å’Œç™½è‰²èƒŒæ™¯çš„å›¾ç‰‡ total+=1 urllib_download(IMAGE_URL,\"0\\\\\"+num) IMAGE_URL += \"@50q\" urllib_download(IMAGE_URL,\"1\\\\\"+num) print(\"Downloaded \"+num+\".png\") print(\"æ­£åœ¨çˆ¬å–ç¬¬\",total+1,\"å¼ å›¾ç‰‡ï¼\") n+=1 print(\"\\n çˆ¬å–å®Œæ¯•ï¼å…±çˆ¬å–\",total,\"å¼ å›¾ç‰‡ï¼\") print(\"å›¾ç‰‡å­˜æ”¾è·¯å¾„ï¼š\"+path) print(\"ä½œè€…åšå®¢ï¼šlruihao.cn\") if __name__==\"__main__\": main(); ","date":"2019-04-22","objectID":"/posts/mmtimgpy/:2:0","tags":["Python"],"title":"python çˆ¬å–ç½‘ç«™å›¾ç‰‡ï¼ˆå›¾ç‰‡é“¾æ¥ç›¸ä¼¼ï¼‰","uri":"/posts/mmtimgpy/"},{"categories":["çæŠ˜è…¾","Python"],"content":"çˆ¬å–è¿‡ç¨‹åŠç»“æœ æ–‡ä»¶å¤¹å·¦ä¸‹è§’æ•°ç›®å˜åŒ– çˆ¬å–è¿‡ç¨‹ å±é™© è¯´å®è¯çœ‹ç€æ§åˆ¶å°ä¸åœåœ°è¾“å‡ºæç¤ºä¿¡æ¯æœ‰æ²¡æœ‰å¾ˆçˆ½ï¼Œå¯¹äºå¼ºè¿«ç—‡æ¥è¯´çœŸçš„æ˜¯å¾ˆæ²»æ„ˆäº†ï¼ä½†æ˜¯çˆ¬å–ç¬¬ 6042 å¼ å›¾ç‰‡çš„æ—¶å€™ï¼Œæˆ‘æ‰“å¼€äº†ä¸€ä¸‹ç›®æ ‡ç½‘é¡µå‘ç°æ— æ³•åŠ è½½å›¾ç‰‡äº†ï¼Œå°±æƒ³è¿™åº”è¯¥ä¹Ÿç®—æ˜¯ä¸€æ¬¡ Dos æ”»å‡»äº†å§ï¼æ‰“å¼€æ§åˆ¶å°æœç„¶åœäº†ï¼Œç›¸å½“äºè®¿é—®äº†è¿‘ä¸¤ä¸‡æ¬¡ï¼å”‰ï¼Œè¿˜æ˜¯å¤ªæš´åŠ›äº†ï¼ï¼è¿˜å·® 800 å¤šå¼ ï¼Œåªå¥½åˆé‡æ–°æ¥ç€å†™ä¸Šæ¬¡çš„ä½ç½®çˆ¬ï¼ä¸æ…é€ æˆç›®æ ‡ç½‘ç«™æœåŠ¡å™¨å‹åŠ›ï¼Œå®åœ¨å¯¹ä¸èµ·ï¼ é”™è¯¯æç¤º ä¸€ä¸ªåŠå°æ—¶å·¦å³åç»ˆäºä¸‹è½½å®Œäº†ï¼Œä¸€å…±æ˜¯ 6886 å¼ ï¼›ç¨‹åºæ˜¯åŒæ—¶ä¸‹è½½äº†é€æ˜å’Œç™½è‰²èƒŒæ™¯çš„å›¾ç‰‡çš„ï¼åˆ†åˆ«åœ¨ 0,1 å­æ–‡ä»¶å¤¹ï¼ çˆ¬å–å®Œæ¯• ","date":"2019-04-22","objectID":"/posts/mmtimgpy/:3:0","tags":["Python"],"title":"python çˆ¬å–ç½‘ç«™å›¾ç‰‡ï¼ˆå›¾ç‰‡é“¾æ¥ç›¸ä¼¼ï¼‰","uri":"/posts/mmtimgpy/"},{"categories":["çæŠ˜è…¾","Python"],"content":"å…¶ä»–æ€è·¯ æ¨¡æ‹Ÿæµè§ˆå™¨è½½å…¥ html æ–‡ä»¶ï¼Œè·å–æºç ï¼ŒæŸ¥æ‰¾åˆ°æ‰€æœ‰\u003cimg\u003eæ ‡ç­¾å†…é“¾æ¥ï¼Œå¿…è¦æ—¶é…åˆæ­£åˆ™è¡¨è¾¾å¼ï¼Œç„¶åä¸‹è½½å›¾ç‰‡ã€‚ ","date":"2019-04-22","objectID":"/posts/mmtimgpy/:4:0","tags":["Python"],"title":"python çˆ¬å–ç½‘ç«™å›¾ç‰‡ï¼ˆå›¾ç‰‡é“¾æ¥ç›¸ä¼¼ï¼‰","uri":"/posts/mmtimgpy/"},{"categories":["çæŠ˜è…¾","Python"],"content":" æ–‡ä¸­æ¶‰åŠçš„å›¾ç‰‡æ¶‰åŠä¸ªäººéšç§ï¼Œä»…åšä¸¾ä¾‹ï¼Œè¯·å‹¿ä¼ æ’­ æŸ¥çœ‹å¾®ä¿¡å¥½å‹ç”·å¥³æ¯”ä¾‹ æŸ¥çœ‹å¥½å‹åœ°åŒºåˆ†å¸ƒ ç¾¤æ€§åˆ«ç»Ÿè®¡ ","date":"2019-04-20","objectID":"/posts/wxpy1/:0:0","tags":["Python","wxpy","pyecharts","jieba","ä»–å±±ä¹‹çŸ³"],"title":"python ç©å¾®ä¿¡ï¼šåˆæ¢ wxpy","uri":"/posts/wxpy1/"},{"categories":["çæŠ˜è…¾","Python"],"content":"å‰æœŸå‡†å¤‡ wxpy pyechartsï¼ˆç™¾åº¦ echartsï¼‰ ","date":"2019-04-20","objectID":"/posts/wxpy1/:1:0","tags":["Python","wxpy","pyecharts","jieba","ä»–å±±ä¹‹çŸ³"],"title":"python ç©å¾®ä¿¡ï¼šåˆæ¢ wxpy","uri":"/posts/wxpy1/"},{"categories":["çæŠ˜è…¾","Python"],"content":"æŸ¥çœ‹å¾®ä¿¡å¥½å‹ç”·å¥³æ¯”ä¾‹ from wxpy import * from pyecharts import Pie bot = Bot(cache_path = True) #å®šä¹‰ä¸€ä¸ªå¾®ä¿¡æœºå™¨äºº friends = bot.friends(update=False) #è·å–æ›´æ–°å¥½å‹åˆ—è¡¨ male = female = other = 0 for i in friends[1:]: #[1:] è‡ªå·±æ˜¯ç¬¬ä¸€ä¸ªï¼Œæ’é™¤æ‰ sex = i.sex if sex == 1: male += 1 elif sex == 2: female += 1 else: other += 1 total = len(friends[1:]) #è®¡ç®—æ€»æ•° #ä¸‹é¢ä¸ºåˆ†æ attr = [\"ç”·æ€§\",\"å¥³æ€§\",\"å…¶ä»–\"] v1 = [float(male),float(female),float(other)] pie = Pie(\"é¥¼å›¾-åœ†ç¯å›¾ç¤ºä¾‹\", title_pos='center') pie.add(\"\", attr, v1, radius=[40, 75], label_text_color=None, is_label_show=True, legend_orient='vertical', legend_pos='left') pie.render(\"sex.html\") ","date":"2019-04-20","objectID":"/posts/wxpy1/:2:0","tags":["Python","wxpy","pyecharts","jieba","ä»–å±±ä¹‹çŸ³"],"title":"python ç©å¾®ä¿¡ï¼šåˆæ¢ wxpy","uri":"/posts/wxpy1/"},{"categories":["çæŠ˜è…¾","Python"],"content":"æŸ¥çœ‹å¥½å‹åœ°åŒºåˆ†å¸ƒ from wxpy import * from pyecharts import Map #å› ä¸ºè·å–çš„åˆ—è¡¨åŸå¸‚éƒ½æ²¡æœ‰å¸¦å¸‚å­—ï¼Œè€Œ pyecharts éœ€è¦å¸¦ä¸ªå¸‚å­— b = 'å¸‚' def s(x): return x+b #åªæå–æ¹–å—çš„ bot = Bot(cache_path = True) friends = bot.friends(update=False).search(province = 'æ¹–å—') citys = [] for f in friends : city = f.city citys.append(city) r = map(s,citys) cityss = list(r) #ä¸ºåŸå¸‚è®¡æ•° a = {} for i in cityss: a[i] = cityss.count(i) a.pop('å¸‚') #æŠŠå­—å…¸è¿›è¡Œæœ‰åºæ‹†åˆ†ä¸º 2 ä¸ªåˆ—è¡¨ attrs = [] values = [] for value, attr in a.items(): values.append(attr) attrs.append(value) #å¼€å§‹ç»˜å›¾ map = Map(\"æ¹–å—åœ°å›¾ç¤ºä¾‹\", width=1200, height=600) map.add(\"\", attrs, values, maptype='æ¹–å—', is_visualmap=True, visual_text_color='#000') map.render(\"city.html\") ä»¥ä¸Šå‚è€ƒç®€ä¹¦ é™ˆæ€ç…œ ","date":"2019-04-20","objectID":"/posts/wxpy1/:3:0","tags":["Python","wxpy","pyecharts","jieba","ä»–å±±ä¹‹çŸ³"],"title":"python ç©å¾®ä¿¡ï¼šåˆæ¢ wxpy","uri":"/posts/wxpy1/"},{"categories":["çæŠ˜è…¾","Python"],"content":"ç»Ÿè®¡æ‰€æœ‰ç¾¤ç”·å¥³æ•°ç›® ç»Ÿè®¡ç»“æœä¼šè‡ªåŠ¨å‘é€åˆ°æ‰€æœ‰ç¾¤èŠ ç”·å¥³äººæ•°å’Œä¸ä¸€å®šç­‰äºæ€»æ•°ï¼ˆæœ‰äº›äººä¸æ˜¾ç¤ºæ€§åˆ«ï¼‰ #encoding=utf-8 from wxpy import * import numpy def removeAll(the_list, val): return [value for value in the_list if value != val] def stats_text(target_group, group_name): print(group_name + \"ç¾¤å…±æœ‰ï¼š\" + str(len(target_group)) + \"äººï¼Œå…¶ä¸­ï¼š\") all_stats_text = [] all_dict = {} ## ä¹±åºå…ˆæ•´ç†ä¸€ä»½çœä»½ + åœ°ç‚¹çš„åˆ—è¡¨ for user in target_group.members: trimed_data = user.province.replace(' ', '') + user.city.replace(' ', '') if trimed_data != '': all_stats_text.append(trimed_data) ## è®¡æ•° for data in all_stats_text: if all_stats_text.count(data) != 0: all_dict[data] = all_stats_text.count(data) all_stats_text = removeAll(all_stats_text, data) final_dict = {} for i in sorted(all_dict.keys()): final_dict[i] = all_dict[i] return final_dict def stats_sex(target_group): male = 0 female = 0 other = 0 for user in target_group.members: if user.sex == 1: male = male + 1 if user.sex == 2: female = female + 1 else: other = other + 1 print(\"ç”·çš„æœ‰ï¼š\" + str(male) + \"äºº\") print(\"å¥³çš„æœ‰ï¼š\" + str(female) + \"äºº\") msg = \"ç”·çš„æœ‰ï¼š\" + str(male) + \"äººã€n\" + \"å¥³çš„æœ‰ï¼š\" + str(female) + \"äººã€n\" return msg bot = Bot() target_group = bot.groups(update=True, contact_only=False) for curr_group in target_group: ## å°äº 10 äººçš„ç¾¤è¿‡æ»¤æ‰ if len(curr_group) \u003c 10: continue curr_group.update_group(members_details=True) print(curr_group.name + \"ä¸€å…±æœ‰ï¼š\" + str(len(curr_group)) + \"äººã€n\") msg = stats_sex(curr_group) curr_group.send(curr_group.name + \"ç¾¤ï¼Œä¸€å…±æœ‰ï¼š\" + str(len(curr_group)) + \"äººã€n\" + msg) ","date":"2019-04-20","objectID":"/posts/wxpy1/:4:0","tags":["Python","wxpy","pyecharts","jieba","ä»–å±±ä¹‹çŸ³"],"title":"python ç©å¾®ä¿¡ï¼šåˆæ¢ wxpy","uri":"/posts/wxpy1/"},{"categories":["çæŠ˜è…¾","Python"],"content":" Python é€šè¿‡ wxpy ç™»å½•å¾®ä¿¡ç½‘é¡µç‰ˆï¼Œçˆ¬å–å¥½å‹æ‰€æœ‰å¤´åƒå¹¶æ‹¼æ¥æˆä¸€å¼ å¤§å›¾ã€‚ç„¶ååˆ é™¤æ‰€æœ‰å­å›¾ã€‚ï¼ˆæ³¨é‡Šç›¸å…³ä»£ç å¯ä»¥ä¸åˆ é™¤ï¼‰ æ–‡ä¸­æ¶‰åŠçš„å›¾ç‰‡æ¶‰åŠä¸ªäººéšç§ï¼Œä»…åšä¸¾ä¾‹ï¼Œè¯·å‹¿ä¼ æ’­ æ–‡ä¸­ç¼–ç ç”± Sunbelife æä¾›ï¼Œæ¥è‡ªä»–çš„åŒåå¾®ä¿¡å…¬ä¼—å·ï¼Œæœ¬åšä»…ç”¨äºå­¦ä¹ ï¼Œä¾µåˆ  ","date":"2019-04-20","objectID":"/posts/wximgpy/:0:0","tags":["wxpy","pillow","Python"],"title":"åŸºæœ¬ python å®ç°çš„çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒï¼Œå¹¶æ‹¼æ¥æˆå¤§å›¾","uri":"/posts/wximgpy/"},{"categories":["çæŠ˜è…¾","Python"],"content":"ä¾èµ– wxpyï¼ˆPythone ç™»å½•å¾®ä¿¡ï¼‰ pillowï¼ˆæ‹¼æ¥å¤´åƒï¼‰ osï¼ˆæ–‡ä»¶å¤¹æ“ä½œï¼‰ mathï¼ˆæ•°å­¦è®¡ç®—ï¼‰ wxpy: wxpy åœ¨ itchat çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡å¤§é‡æ¥å£ä¼˜åŒ–æå‡äº†æ¨¡å—çš„æ˜“ç”¨æ€§ï¼Œå¹¶è¿›è¡Œä¸°å¯Œçš„åŠŸèƒ½æ‰©å±•ã€‚ PILï¼š Python Imaging Libraryï¼Œå·²ç»æ˜¯ Python å¹³å°äº‹å®ä¸Šçš„å›¾åƒå¤„ç†æ ‡å‡†åº“äº†ã€‚PIL åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œä½† API å´éå¸¸ç®€å•æ˜“ç”¨ã€‚ç”±äº PIL ä»…æ”¯æŒåˆ° Python 2.7ï¼ŒåŠ ä¸Šå¹´ä¹…å¤±ä¿®ï¼Œäºæ˜¯ä¸€ç¾¤å¿—æ„¿è€…åœ¨ PIL çš„åŸºç¡€ä¸Šåˆ›å»ºäº†å…¼å®¹çš„ç‰ˆæœ¬ï¼Œåå­—å« Pillowï¼Œæ”¯æŒæœ€æ–° Python 3.xï¼ŒåˆåŠ å…¥äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å®‰è£…ä½¿ç”¨ Pillowã€‚ ","date":"2019-04-20","objectID":"/posts/wximgpy/:1:0","tags":["wxpy","pillow","Python"],"title":"åŸºæœ¬ python å®ç°çš„çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒï¼Œå¹¶æ‹¼æ¥æˆå¤§å›¾","uri":"/posts/wximgpy/"},{"categories":["çæŠ˜è…¾","Python"],"content":"å®‰è£… pip install -U wxpy -i \"https://pypi.doubanio.com/simple/\" pip install pillow ","date":"2019-04-20","objectID":"/posts/wximgpy/:2:0","tags":["wxpy","pillow","Python"],"title":"åŸºæœ¬ python å®ç°çš„çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒï¼Œå¹¶æ‹¼æ¥æˆå¤§å›¾","uri":"/posts/wximgpy/"},{"categories":["çæŠ˜è…¾","Python"],"content":"è¿è¡Œ å¦‚æœåœ¨ Python IDE è¿è¡Œå‡ºé”™ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¾®ä¿¡å¥½å‹çš„ id æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œåœ¨ IDE æ‰“å°å‡ºé”™ï¼Œæ³¨é‡Šæ‰ä»£ç  36 è¡Œå³å¯ã€‚ from wxpy import * import math import PIL.Image as Image import os import sys import shutil # ### è·å–æ–‡ä»¶æ‰€åœ¨çš„ç»å¯¹è·¯å¾„ def get_dir(sys_arg): sys_arg = sys_arg.split(\"/\") dir_str = \"\" count = 0 for cur_dir in sys_arg: if count == 0: count = count + 1 if count == len(sys_arg): break dir_str = dir_str + cur_dir + \"/\" count = count + 1 return dir_str curr_dir = get_dir(sys.argv[0]) bot = Bot() ## æœºå™¨äººè´¦å·è‡ªèº« myself = bot.self my_friends = bot.friends(update=True) if not os.path.exists(curr_dir + \"group-images/\"): os.mkdir(curr_dir + \"group-images/\") count = 0 for friend in my_friends: print(friend.nick_name) friend.get_avatar(curr_dir + \"group-images/\" + str(count) + \".jpg\") count = count + 1 ## è·å–ä¸‹è½½çš„å¤´åƒæ–‡ä»¶ ls = os.listdir(curr_dir + 'group-images') ## å»é™¤é .jpg æ–‡ä»¶ for filter_ls in ls: if \".jpg\" in filter_ls: continue else: ls.remove(filter_ls) ## æ’åº ls.sort(key=lambda x:int(x[:-4])) ## å¤´åƒå¢™å°ºå¯¸ image_size = 2560 each_size = math.floor(image_size/math.floor(math.sqrt(len(ls)))) x_lines = math.ceil(math.sqrt(len(ls))) y_lines = math.ceil(math.sqrt(len(ls))) image = Image.new('RGB', (each_size * x_lines, each_size * y_lines)) x = 0 y = 0 for file_names in ls: try: img = Image.open(curr_dir + \"group-images/\" + file_names) print(\"æ­£åœ¨å¤„ç†\" + file_names.split('.jpg')[0] + \"/\" + str(len(ls))) except IOError: continue else: img = img.resize((each_size, each_size)) image.paste(img, (x * each_size, y * each_size)) x += 1 if x == x_lines: x = 0 y += 1 img = image.save(curr_dir + \"all.jpg\") try: shutil.rmtree(curr_dir + \"group-images/\") print(\"æ”¶å°¾ï¼Œæ¸…ç†ä¸´æ—¶æ–‡ä»¶\") except FileNotFoundError: print(\"æ²¡ä»€ä¹ˆå¥½åˆ çš„\") print(\"ï¼ï¼ï¼\\n ç”Ÿæˆå®Œæ¯•äº†ï¼Œæ”¾åœ¨äº†ç›®å½•\" + curr_dir + \"ï¼Œå»çœ‹çœ‹å§ã€‚\") print(\"å·¥å…·ä½œè€…ï¼š@Sunbelifeï¼ˆæ–°æµªå¾®åšï¼‰\") print(\"å…¬ä¼—å·ï¼šSunbelife\") print(\"æ„Ÿè°¢ä½¿ç”¨\") print(\"v1.2\") print(\"2019.4.18\") ","date":"2019-04-20","objectID":"/posts/wximgpy/:3:0","tags":["wxpy","pillow","Python"],"title":"åŸºæœ¬ python å®ç°çš„çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒï¼Œå¹¶æ‹¼æ¥æˆå¤§å›¾","uri":"/posts/wximgpy/"},{"categories":["çæŠ˜è…¾","Python"],"content":"ç¾¤å‹å…¨å®¶ç¦ ä¿®æ”¹ 11 è¡Œç¾¤åç§° import itchat import math import PIL.Image as Image import os import shutil ## å˜é‡ itchat.auto_login(hotReload=True,enableCmdQR=False) roomslist = itchat.get_chatrooms(update=True)[0:] itchat.dump_login_status() ## æ˜¾ç¤ºæ‰€æœ‰çš„ç¾¤èŠä¿¡æ¯ï¼Œé»˜è®¤æ˜¯è¿”å›ä¿å­˜åˆ°é€šè®¯å½•ä¸­çš„ç¾¤èŠ myroom=itchat.search_chatrooms(name=u'ç»¥å®ä¸€ä¸­é«˜ 396 ç­') #ç¾¤èŠåç§° gsq=itchat.update_chatroom(myroom[0]['UserName'], detailedMember=True) num = 0 if not os.path.exists(\"./group-images/\"): os.mkdir(\"./group-images/\") for i in gsq['MemberList']: print(i[\"UserName\"]) img = itchat.get_head_img(userName=i[\"UserName\"],chatroomUserName=myroom[0]['UserName']) fileImage = open(\"./group-images/\" + str(num) + \".jpg\",'wb') fileImage.write(img) fileImage.close() num += 1 ls = os.listdir('./group-images') each_size = int(math.sqrt(float(640*640)/len(ls))) lines = int(640/each_size) image = Image.new('RGBA', (640, 640)) x = 0 y = 0 for i in range(0,len(ls)+1): try: img = Image.open(\"./group-images/\" + str(i) + \".jpg\") except IOError: print(\"Error\") else: img = img.resize((each_size, each_size), Image.ANTIALIAS) image.paste(img, (x * each_size, y * each_size)) x += 1 if x == lines: x = 0 y += 1 image.save(\"all.png\") shutil.rmtree(\"./group-images\") ç»¥å®ä¸€ä¸­é«˜ 396 ç­ åŠ ä¸ªåˆ—è¡¨ï¼ŒåŠ ä¸ªå¾ªç¯å®ç°è‡ªåŠ¨çˆ¬å–æ‰€æœ‰ç¾¤èŠå¤´åƒå¹¶å‘é€ import itchat import math import PIL.Image as Image import os import shutil ## å˜é‡ itchat.auto_login(hotReload=True,enableCmdQR=False) roomslist = itchat.get_chatrooms(update=True)[0:] itchat.dump_login_status() ## æ˜¾ç¤ºæ‰€æœ‰çš„ç¾¤èŠä¿¡æ¯ï¼Œé»˜è®¤æ˜¯è¿”å›ä¿å­˜åˆ°é€šè®¯å½•ä¸­çš„ç¾¤èŠ for room in roomslist: print(room['UserName']) gsq=itchat.update_chatroom(room['UserName'], detailedMember=True) num = 0 if not os.path.exists(\"./group-images/\"): os.mkdir(\"./group-images/\") for i in gsq['MemberList']: print(i[\"UserName\"]) img = itchat.get_head_img(userName=i[\"UserName\"],chatroomUserName=room['UserName']) fileImage = open(\"./group-images/\" + str(num) + \".jpg\",'wb') fileImage.write(img) fileImage.close() num += 1 ls = os.listdir('./group-images') each_size = int(math.sqrt(float(640*640)/len(ls))) lines = int(640/each_size) image = Image.new('RGB', (640, 640)) x = 0 y = 0 for i in range(0,len(ls)+1): try: img = Image.open(\"./group-images/\" + str(i) + \".jpg\") except IOError: print(\"Error\") else: img = img.resize((each_size, each_size), Image.ANTIALIAS) image.paste(img, (x * each_size, y * each_size)) x += 1 if x == lines: x = 0 y += 1 image.save(\"all.jpg\") itchat.send(\"å†™äº†ä¸ªå¥½ç©çš„â€¦ æµ‹è¯•ä¸€ä¸‹\", room['UserName']) itchat.send_image(\"all.jpg\", room['UserName']) shutil.rmtree(\"./group-images\") ","date":"2019-04-20","objectID":"/posts/wximgpy/:4:0","tags":["wxpy","pillow","Python"],"title":"åŸºæœ¬ python å®ç°çš„çˆ¬å–å¾®ä¿¡å¥½å‹å¤´åƒï¼Œå¹¶æ‹¼æ¥æˆå¤§å›¾","uri":"/posts/wximgpy/"},{"categories":["Java"],"content":" ä¹‹æ‰€ä»¥ç”¨è®°äº‹æœ¬æ¥å†™ä¸æ˜¯ä¸ºäº†è£… X æˆ–è€…ä»€ä¹ˆçš„ã€‚åè€Œæ°æ°æ˜¯è¿”ç’å½’çœŸï¼Œå› ä¸ºåœ¨ç”¨ java è¯­è¨€è¿›è¡Œç¨‹åºå¼€å‘æ—¶ï¼Œé¦–å…ˆæ˜¯ä»¥çº¯æ–‡æœ¬çš„æ–¹å¼ç¼–å†™æ‰€æœ‰çš„ java æºç¨‹åºï¼Œå¹¶ä¿å­˜æˆä»¥.javaä¸ºåç¼€çš„æ–‡ä»¶ï¼›ç„¶åå°†è¿™äº›æºç¨‹åºç”¨javacç¼–è¯‘æˆ.classåç¼€åçš„å­—èŠ‚ä»£ç æ–‡ä»¶ï¼›å­—èŠ‚ä»£ç ä¸æ˜¯è¢«æœ¬åœ°å¤„ç†å™¨æ‰§è¡Œçš„ä»£ç ï¼Œè€Œæ˜¯èƒ½å¤Ÿè¢« java è™šæ‹Ÿæœºï¼ˆJVMï¼‰æ‰§è¡Œçš„ä»£ç ã€‚æœ€åç”¨ java è¿è¡Œå·¥å…·åœ¨ JVM æ‰§è¡Œ java åº”ç”¨ç¨‹åºã€‚ ç”±äº JVM å¯ä»¥è¿è¡Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šï¼Œå› æ­¤åŒä¸€ä¸ªå­—èŠ‚ä»£ç æ–‡ä»¶å¯ä»¥è·¨å¹³å°è¿è¡Œã€‚ javac java ","date":"2019-04-19","objectID":"/posts/hellojava/:0:0","tags":["Java"],"title":"ç”¨è®°äº‹æœ¬ç¼–å†™ç¬¬ä¸€ä¸ª java ç¨‹åº","uri":"/posts/hellojava/"},{"categories":["Java"],"content":"ç¼–å†™ java ç”¨è®°äº‹æœ¬ç¼–è¾‘ java æ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠåç¼€æ”¹æˆ.javaï¼Œæ–‡ä»¶åå’Œç±»åè¦ä¸€æ ·ã€‚ public class HelloWorld{ public static void main(String[] args){ System.out.println(\"Hello World!\"); } } ","date":"2019-04-19","objectID":"/posts/hellojava/:1:0","tags":["Java"],"title":"ç”¨è®°äº‹æœ¬ç¼–å†™ç¬¬ä¸€ä¸ª java ç¨‹åº","uri":"/posts/hellojava/"},{"categories":["Java"],"content":"æ‰“å¼€ cmd ","date":"2019-04-19","objectID":"/posts/hellojava/:2:0","tags":["Java"],"title":"ç”¨è®°äº‹æœ¬ç¼–å†™ç¬¬ä¸€ä¸ª java ç¨‹åº","uri":"/posts/hellojava/"},{"categories":["Java"],"content":"é‚®ç®± import java.util.regex.Matcher; import java.util.regex.Pattern; public class RegexDemo { public static void main(String[] args) { // Pattern ç±» æ­£åˆ™è¡¨è¾¾å¼çš„ç¼–è¯‘è¡¨ç¤ºã€‚ Pattern pattern = Pattern.compile(\"^[a-zA-Z0-9_!#$%\u0026'*+/=?`{|}~^.-]+@[a-zA-Z0-9.-]+$\"); String[] emails = {\"admin@lruihao.cn\", \"lruihao.cn\"}; for (String email : emails) { //Matcher é€šè¿‡è§£é‡Š Pattern å¯¹å­—ç¬¦åºåˆ—æ‰§è¡ŒåŒ¹é…æ“ä½œçš„å¼•æ“ Matcher matcher = pattern.matcher(email); System.out.println(email + \"åŒ¹é…ç»“æœï¼š\" + matcher.matches()); } } } admin@lruihao.cn åŒ¹é…ç»“æœï¼štrue lruihao.cn åŒ¹é…ç»“æœï¼šfalse ","date":"2019-04-18","objectID":"/posts/java-regex/:1:0","tags":["regex","Java"],"title":"java æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ ","uri":"/posts/java-regex/"},{"categories":["Java"],"content":"ç”µè¯ package base; import java.util.Scanner; import java.util.regex.Matcher; import java.util.regex.Pattern; public class RegexTest { public static void main(String[] args) { Pattern patter=Pattern.compile(\"^[1][3,4,5,7,8][0-9]{9}$\"); Scanner sc=new Scanner(System.in); String telnum=sc.nextLine(); sc.close(); Matcher matcher=patter.matcher(telnum); System.out.println(telnum+\"åŒ¹é…ç»“æœï¼š \"+matcher.matches()); } } /** * è·å–å½“å‰çš„ httpSession * @return */ public static HttpSession getSession() { return getRequest().getSession(); } /** * æ‰‹æœºå·éªŒè¯ * @param str * @return éªŒè¯é€šè¿‡è¿”å› true */ public static boolean isMobile(final String str) { Pattern p = null; Matcher m = null; boolean b = false; p = Pattern.compile(\"^[1][3,4,5,7,8][0-9]{9}$\"); // éªŒè¯æ‰‹æœºå· m = p.matcher(str); b = m.matches(); return b; } /** * ç”µè¯å·ç éªŒè¯ * @param str * @return éªŒè¯é€šè¿‡è¿”å› true */ public static boolean isPhone(final String str) { Pattern p1 = null, p2 = null; Matcher m = null; boolean b = false; p1 = Pattern.compile(\"^[0][1-9]{2,3}-[0-9]{5,10}$\"); // éªŒè¯å¸¦åŒºå·çš„ p2 = Pattern.compile(\"^[1-9]{1}[0-9]{5,8}$\"); // éªŒè¯æ²¡æœ‰åŒºå·çš„ if (str.length() \u003e 9) { m = p1.matcher(str); b = m.matches(); } else { m = p2.matcher(str); b = m.matches(); } return b; } ","date":"2019-04-18","objectID":"/posts/java-regex/:2:0","tags":["regex","Java"],"title":"java æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ ","uri":"/posts/java-regex/"},{"categories":["Java"],"content":"èº«ä»½è¯ /* èº«ä»½è¯æ­£åˆ™è¡¨è¾¾å¼ 16 æˆ– 18 */ public static final String IDCARD=\"((11|12|13|14|15|21|22|23|31|32|33|34|35|36|37|41|42|43|44|45|46|50|51|52|53|54|61|62|63|64|65)[0-9]{4})\" + \"(([1|2][0-9]{3}[0|1][0-9][0-3][0-9][0-9]{3}\" + \"[Xx0-9])|([0-9]{2}[0|1][0-9][0-3][0-9][0-9]{3}))\"; ","date":"2019-04-18","objectID":"/posts/java-regex/:3:0","tags":["regex","Java"],"title":"java æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ ","uri":"/posts/java-regex/"},{"categories":["Java"],"content":"StringBuffer/StringBuilderï¼ˆæŒæ¡ï¼‰ ","date":"2019-04-14","objectID":"/posts/stringbuffer/:1:0","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"StringBuffer æ˜¯çº¿ç¨‹å®‰å…¨çš„å¯å˜å­—ç¬¦ä¸²ã€‚ StringBuilder æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„å¯å˜å­—ç¬¦ä¸²ã€‚ å’Œ StringBuffer çš„åŠŸèƒ½ä¸€æ ·ã€‚å°±æ˜¯æ•ˆç‡é«˜ä¸€äº›ï¼Œä½†æ˜¯ä¸å®‰å…¨ã€‚ ","date":"2019-04-14","objectID":"/posts/stringbuffer/:1:1","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"æ„é€ æ–¹æ³•ï¼š StringBuffer sb = new StringBuffer(); StringBuffer sb = new StringBuffer(50); StringBuffer sb = new StringBuffer(â€œhelloâ€); ","date":"2019-04-14","objectID":"/posts/stringbuffer/:1:2","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"æˆå‘˜æ–¹æ³•ï¼šï¼ˆè‡ªå·±è¡¥é½æ–¹æ³•å’Œæ„æ€ï¼‰ æ·»åŠ åŠŸèƒ½ public StringBuffer append(String str): è¿½åŠ å­—ç¬¦ä¸² public StringBuffer insert(int offset,String str): åœ¨æŒ‡å®šä½ç½®æ’å…¥å­—ç¬¦ä¸² åˆ é™¤åŠŸèƒ½ public StringBuffer deleteCharAt(int index): åˆ é™¤æŒ‡å®šä½ç½®å­—ç¬¦ public StringBuffer delete(int start,int end): åˆ é™¤ä»æŒ‡å®šå¼€å§‹åˆ°ç»“æŸçš„å­—ç¬¦ï¼Œå·¦é—­å³å¼€ æ›¿æ¢åŠŸèƒ½ public StringBuffer replace(int start,int end,String str): ä»¥å­—ç¬¦ä¸²æ›¿ä»£ä»æŒ‡å®šå¼€å§‹åˆ°ç»“æŸçš„å­—ç¬¦ åè½¬åŠŸèƒ½ public StringBuffer reverse(): åè½¬ æˆªå–åŠŸèƒ½ public String substring(int start): ä»æŒ‡å®šç´¢å¼•åˆ°æœ«å°¾çš„å­—ç¬¦ä¸² public String substring(int start,int end): ä»æŒ‡å®šç´¢å¼•å¼€å§‹åˆ°æŒ‡å®šç´¢å¼•ç»“æŸçš„å­—ç¬¦ä¸² ","date":"2019-04-14","objectID":"/posts/stringbuffer/:1:3","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"æ¡ˆä¾‹ï¼š String å’Œ StringBuffer çš„ç›¸äº’è½¬æ¢ï¼Œé€šè¿‡æ„é€ å³å¯ã€‚ æŠŠæ•°ç»„è½¬æˆæŒ‡å®šçš„å­—ç¬¦ä¸²æ ¼å¼ æŠŠå­—ç¬¦ä¸²åè½¬ åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯å¯¹ç§°å­—ç¬¦ä¸² ","date":"2019-04-14","objectID":"/posts/stringbuffer/:1:4","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"æ•°ç»„é«˜çº§éƒ¨åˆ†ï¼ˆç†è§£ï¼‰ ","date":"2019-04-14","objectID":"/posts/stringbuffer/:2:0","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"æ’åº å†’æ³¡æ’åº ç›¸é‚»å…ƒç´ ï¼Œä¸¤ä¸¤æ¯”è¾ƒï¼Œå¤§çš„å¾€åæ”¾ã€‚ public static void bubbleSort(int[] arr) { for(int x=0; x\u003carr.length-1; x++) { for(int y=0; y\u003carr.length-1-x; y++) { if(arr[y]\u003earr[y+1]) { int temp = arr[y]; arr[y] = arr[y+1]; arr[y+1] = temp; } } } } é€‰æ‹©æ’åº ä» 0 å¼€å§‹ï¼Œä¾æ¬¡å’Œåé¢çš„æ¯”è¾ƒï¼Œå°çš„å¾€å‰æ”¾ã€‚ public static void selectSort(int[] arr) { for(int x=0; x\u003carr.length-1; x++) { for(int y=x+1; y\u003carr.length; y++) { if(arr[y] \u003c arr[x]) { int temp = arr[x]; arr[x] = arr[y]; arr[y] = temp; } } } } public static void selectSort(int[] a) { int min=0; int temp=0; if((a==null)||(a.length==0)) return; for(int i=0;i\u003ca.length-1;i++) { min=i;//æ— åºåŒºçš„æœ€å°æ•°æ®æ•°ç»„ä¸‹æ ‡ for(int j=i+1;j\u003ca.length;j++) { //åœ¨æ— åºåŒºä¸­æ‰¾åˆ°æœ€å°æ•°æ®å¹¶ä¿å­˜å…¶æ•°ç»„ä¸‹æ ‡ if(a[j]\u003ca[min]) { min=j; } } //å°†æœ€å°å…ƒç´ æ”¾åˆ°æœ¬æ¬¡å¾ªç¯çš„å‰ç«¯ temp=a[i]; a[i]=a[min]; a[min]=temp; } } ","date":"2019-04-14","objectID":"/posts/stringbuffer/:2:1","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"æŸ¥æ‰¾ åŸºæœ¬æŸ¥æ‰¾ æ•°ç»„æ— åº äºŒåˆ†æŸ¥æ‰¾ æ•°ç»„æœ‰åº public static int getIndex(int[] arr,int value) { int max = arr.length-1; int min = 0; int mid = (max+min)/2; while(arr[mid] != value) { if(arr[mid] \u003e value) { max = mid - 1; }else if(arr[mid] \u003c value) { min = mid + 1; } if(max \u003c min) { return -1; } mid = (max+min)/2; } return mid; } ","date":"2019-04-14","objectID":"/posts/stringbuffer/:2:2","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"Arrays å·¥å…·ç±»ï¼ˆæŒæ¡ï¼‰ ","date":"2019-04-14","objectID":"/posts/stringbuffer/:3:0","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"Arrays æ˜¯é’ˆå¯¹æ•°ç»„è¿›è¡Œæ“ä½œçš„å·¥å…·ç±»ï¼Œæä¾›äº†æ’åºå’ŒæŸ¥æ‰¾ç­‰åŠŸèƒ½ ","date":"2019-04-14","objectID":"/posts/stringbuffer/:3:1","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"æˆå‘˜æ–¹æ³•ï¼šï¼ˆè‡ªå·±è¡¥é½æ–¹æ³•å’Œæ„æ€ï¼‰ æŠŠæ•°ç»„è½¬æˆå­—ç¬¦ä¸² public static String toString(): å°†ä»»æ„ç±»å‹æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸² æ’åº public static void sort()ï¼š äºŒåˆ†æŸ¥æ‰¾ public static int binarySearch(int[] arr,int key) ","date":"2019-04-14","objectID":"/posts/stringbuffer/:3:2","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"æ¡ˆä¾‹ï¼š æŠŠå­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦è¿›è¡Œæ’åº ","date":"2019-04-14","objectID":"/posts/stringbuffer/:3:3","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"åŸºæœ¬ç±»å‹åŒ…è£…ç±»ï¼ˆæŒæ¡ï¼‰ ","date":"2019-04-14","objectID":"/posts/stringbuffer/:4:0","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"ä¸ºäº†è®©æˆ‘ä»¬å¯¹åŸºæœ¬ç±»å‹è¿›è¡Œæ›´å¤šçš„æ“ä½œï¼Œjava é’ˆå¯¹æ¯ç§åŸºæœ¬ç±»å‹æä¾›äº†å¯¹åº”çš„åŒ…è£…ç±»ç±»å‹ã€‚ ","date":"2019-04-14","objectID":"/posts/stringbuffer/:4:1","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"åˆ†åˆ«æ˜¯å“ªäº›å‘¢ï¼Ÿ byte Byte short Short int Integer long Long float Float double Double char Character boolean Boolean ç‰¹æ®Šï¼š void Void ","date":"2019-04-14","objectID":"/posts/stringbuffer/:4:2","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"Integer æ„é€ æ–¹æ³• Integer i = new Integer(100); Integer i = new Integer(â€œ100â€); æˆå‘˜æ–¹æ³•ï¼ˆè‡ªå·±è¡¥é½æ–¹æ³•å’Œæ„æ€ï¼‰ æŠŠå­—ç¬¦ä¸²è½¬æˆ int ç±»å‹ String-\u003eint: Integer.parseInt() int-\u003eString: String.valueOf() æˆ– Integer.toString() JDK5 çš„æ–°ç‰¹æ€§ è‡ªåŠ¨è£…ç®±ï¼š int --\u003e Integer //Integer.valueOf() è‡ªåŠ¨æ‹†ç®±ï¼š Integer --\u003e int //Integer.intValue() è¯·è§£é‡Šï¼š Integer i = 100; i+=200; System.out.println(i); byte ç¼“å­˜æ± é¢è¯•é¢˜ byte,short,charâ€”\u003eå°äº 127ï¼Œå¦åˆ™æŠ¥-6 çš„é”™è¯¯ï¼ˆæŸ¥çœ‹ JDK) ","date":"2019-04-14","objectID":"/posts/stringbuffer/:4:3","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["Java"],"content":"Character æ„é€ æ–¹æ³• Character ch = new Character(â€˜aâ€™); æˆå‘˜æ–¹æ³•ï¼ˆè‡ªå·±è¡¥é½æ–¹æ³•å’Œæ„æ€ï¼‰ åˆ¤æ–­å­—ç¬¦æ˜¯å¦æ˜¯å¤§å†™å­—æ¯ public boolean isUpperCase(char ch) åˆ¤æ–­å­—ç¬¦æ˜¯å¦æ˜¯å°å†™å­—æ¯ public boolean isLowerCase(Char ch) åˆ¤æ–­å­—ç¬¦æ˜¯å¦æ˜¯æ•°å­—å­—ç¬¦ public boolean isDigit(Char ch) æŠŠå­—ç¬¦è½¬æˆå¤§å†™ public Char toUpperCase(Char ch) æŠŠå­—ç¬¦è½¬æˆå°å†™ public Char toLowerCase(Char ch) ","date":"2019-04-14","objectID":"/posts/stringbuffer/:4:4","tags":["StringBuffer","sort","Java"],"title":"java å¸¸ç”¨ç±»","uri":"/posts/stringbuffer/"},{"categories":["ACM"],"content":"é¢˜ç›®å¤§æ„ï¼š é¢˜ç›®é“¾æ¥ è€é¼ æœ‰ M ç£…çŒ«é£Ÿ , æœ‰ N ä¸ªæˆ¿é—´ , æ¯ä¸ªæˆ¿é—´å‰æœ‰ä¸€åªçŒ« , æˆ¿é—´é‡Œæœ‰è€é¼ æœ€å–œæ¬¢çš„é£Ÿå“ J[i] , è‹¥è¦å¾—åˆ°æˆ¿é—´çš„é£Ÿç‰© , å¿…é¡»ä»˜å‡ºç›¸åº”çš„çŒ«é£Ÿ F[i] , å½“ç„¶è¿™åªè€é¼ æ²¡å¿…è¦æ¯æ¬¡éƒ½ä»˜å‡ºæ‰€æœ‰çš„ F[i]ï¼Œè‹¥å®ƒä»˜å‡º F[i] çš„ a%ï¼Œ åˆ™å¾—åˆ° J[i] çš„ a%ï¼Œæ±‚è€é¼ èƒ½åƒåˆ°çš„æœ€å¤šçš„é£Ÿç‰©ã€‚ ","date":"2019-04-12","objectID":"/posts/hdu1009/:1:0","tags":["ACM","è´ªå¿ƒ","HDU"],"title":"HDU 1009 FatMouse' Tradeï¼ˆè´ªå¿ƒï¼‰","uri":"/posts/hdu1009/"},{"categories":["ACM"],"content":"Sample Input 5 3 7 2 4 3 5 2 20 3 25 18 24 15 15 10 -1 -1 ","date":"2019-04-12","objectID":"/posts/hdu1009/:1:1","tags":["ACM","è´ªå¿ƒ","HDU"],"title":"HDU 1009 FatMouse' Tradeï¼ˆè´ªå¿ƒï¼‰","uri":"/posts/hdu1009/"},{"categories":["ACM"],"content":"Sample Output 13.333 31.500 ","date":"2019-04-12","objectID":"/posts/hdu1009/:1:2","tags":["ACM","è´ªå¿ƒ","HDU"],"title":"HDU 1009 FatMouse' Tradeï¼ˆè´ªå¿ƒï¼‰","uri":"/posts/hdu1009/"},{"categories":["ACM"],"content":"åˆ†æ è€é¼ è¦ç”¨æœ€å°‘çš„çŒ«ç²®æ¥æ¢å–æœ€å¤šçš„é£Ÿç‰© , ä¹Ÿå°±æ˜¯ J[i]/F[i] è¶Šå¤§è¶Šå¥½ , æ‰€ä»¥æŒ‰ç…§ J[i]/F[i] è¿›è¡Œé™åºæ’åˆ— , ç„¶åä¾æ¬¡ç”¨çŒ«ç²®æ¥æ¢å–é£Ÿç‰© , å½“æ‰€å‰©ä¸‹çš„çŒ«ç²®ä¸è¶³ä»¥å®Œå…¨æ¢å–é£Ÿç‰© , èƒ½æ¢å¤šå°‘æ˜¯å¤šå°‘ã€‚ #include\u003cstdio.h\u003e #include\u003calgorithm\u003e using namespace std; struct node{ double j; double f; double s; }a[1005]; int cmp(node x,node y){ return x.s\u003ey.s; } int main(){ int m,n,i; while(scanf(\"%d%d\",\u0026m,\u0026n)\u0026\u0026(m!=-1\u0026\u0026n!=-1)){ memset(a,0,sizeof(a)); for(i=0;i\u003cn;i++){ scanf(\"%lf%lf\",\u0026a[i].j,\u0026a[i].f); a[i].s=a[i].j/a[i].f; } sort(a,a+n,cmp); double sum=0; for(i=0;i\u003cn;i++){ if(m\u003e=a[i].f){ sum+=a[i].j; m-=a[i].f; }else{ sum+=a[i].s*m; m=0; } if(m\u003c=0) break; } printf(\"%.3lf\\n\",sum); } return 0; } ","date":"2019-04-12","objectID":"/posts/hdu1009/:2:0","tags":["ACM","è´ªå¿ƒ","HDU"],"title":"HDU 1009 FatMouse' Tradeï¼ˆè´ªå¿ƒï¼‰","uri":"/posts/hdu1009/"},{"categories":["OS"],"content":" ä¸€ç›´éƒ½æƒ³åœ¨è‡ªå·±ç”µè„‘ä¸Šæ­å»ºä¸€ä¸ªç½‘ç«™æˆ–è€…æŠŠè‡ªå·±çš„ç”µè„‘åšæˆæœåŠ¡å™¨ï¼Œä»Šå¤©ç»ˆäºç®€å•å®ç°äº†ã€‚è¿˜æœ‰å¾ˆå¤šçŸ¥è¯†éœ€è¦å­¦ä¹ ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚ ","date":"2019-04-03","objectID":"/posts/ngrok/:0:0","tags":["ngrok","linux","å®å¡”é¢æ¿","server","ubuntu"],"title":"æœ¬åœ°æ­å»ºç½‘ç«™æœåŠ¡å™¨å¹¶ç©¿é€å†…ç½‘","uri":"/posts/ngrok/"},{"categories":["OS"],"content":"æ­å»ºç¯å¢ƒ æˆ‘çš„ç”µè„‘æ˜¯ubuntu+windowsåŒç³»ç»Ÿçš„ï¼Œæ‰€ä»¥æˆ‘å…ˆåœ¨ ubuntu ä¸Šé¢è£…äº†ä¸€ä¸ªå®å¡”é¢æ¿ï¼Œæ–¹ä¾¿é€šè¿‡ web ç®¡ç†ç”µè„‘ï¼Œå®å¡”å®‰è£…å¥½åå®‰è£…ç›¸å…³çš„ç¯å¢ƒmysql,php,nginxç­‰ã€‚æˆ‘ä»¬ç°åœ¨åªèƒ½é€šè¿‡æœ¬åœ° ip127.0.0.1:8888è®¿é—®é¢æ¿ã€‚ ","date":"2019-04-03","objectID":"/posts/ngrok/:1:0","tags":["ngrok","linux","å®å¡”é¢æ¿","server","ubuntu"],"title":"æœ¬åœ°æ­å»ºç½‘ç«™æœåŠ¡å™¨å¹¶ç©¿é€å†…ç½‘","uri":"/posts/ngrok/"},{"categories":["OS"],"content":"ngrok ç©¿é€ å» ngrok æ³¨å†Œç™»å½•ï¼Œè´­ä¹°éš§é“ï¼ˆæœ‰å…è´¹çš„ï¼‰ï¼Œç„¶åç»‘å®šç«¯å£ï¼Œç»‘å®šåŸŸåï¼Œè¿™é‡Œæˆ‘ä»¬æ‹¿ç«¯å£8888å’ŒåŸŸåtest.lruihao.cnåšå®éªŒï¼Œä¹Ÿå°±æ˜¯å®å¡”é¢æ¿çš„ç«¯å£ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€è¿‡åŸŸåè¿œç¨‹è®¿é—®æœ¬åœ°æœåŠ¡å™¨ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯å¼€å§‹æœ‰äº‘æœåŠ¡å™¨çš„æ„Ÿè§‰äº†ã€‚ç„¶åå®å¡”é¢æ¿è®¾ç½®ä¹Ÿç»‘å®šå¥½åŸŸåtest.lruihao.cn,dns æœåŠ¡å•†é‚£é‡Œåšå¥½ç›¸åº”çš„è§£æã€‚ ç„¶ååœ¨ ngrok é‚£é‡Œä¸‹è½½ sunny å®¢æˆ·ç«¯æ–‡ä»¶ï¼Œæˆ‘ä»¬æ˜¯ ubuntu é€‰æ‹©linux-64bitsç‰ˆæœ¬ã€‚è§£å‹ååœ¨ ubuntu æ‰“å¼€ç»ˆç«¯è¿›å…¥ sunny æ–‡ä»¶ç›®å½•ï¼Œæƒé™ç»™åˆ° 755ï¼Œè¿è¡Œå‘½ä»¤./sunny clientid xxxxxxx åé¢çš„ä½ çš„éš§é“è®¢å•çš„ idã€‚ ç°åœ¨å°±å¯ä»¥é€šè¿‡äº’è”ç½‘è®¿é—®æˆ‘çš„ ubuntu æœåŠ¡å™¨äº†ã€‚ ","date":"2019-04-03","objectID":"/posts/ngrok/:2:0","tags":["ngrok","linux","å®å¡”é¢æ¿","server","ubuntu"],"title":"æœ¬åœ°æ­å»ºç½‘ç«™æœåŠ¡å™¨å¹¶ç©¿é€å†…ç½‘","uri":"/posts/ngrok/"},{"categories":["OS"],"content":"æ­å»ºç½‘ç«™ å‰é¢ä¸¤æ­¥æå®šï¼Œæ­å»ºç½‘ç«™å°±æ²¡é—®é¢˜äº†ã€‚ æˆ‘ä»¬åªè¦æŠŠç½‘ç«™çš„ç«¯å£æŒ‰ç¬¬äºŒæ­¥çš„åœ¨ ngrok è®¾ç½®å¥½å°±å¯ä»¥ç©¿é€äº†ã€‚ ","date":"2019-04-03","objectID":"/posts/ngrok/:3:0","tags":["ngrok","linux","å®å¡”é¢æ¿","server","ubuntu"],"title":"æœ¬åœ°æ­å»ºç½‘ç«™æœåŠ¡å™¨å¹¶ç©¿é€å†…ç½‘","uri":"/posts/ngrok/"},{"categories":["OS"],"content":"æ³¨æ„ è®¿é—®æœ¬åœ°ç½‘ç«™çš„å¿…è¦æ¡ä»¶æ˜¯ä½ çš„ç”µè„‘å¾—æ˜¯å¼€æœºçŠ¶æ€è€Œä¸”æœ‰ç½‘ç»œã€‚ ","date":"2019-04-03","objectID":"/posts/ngrok/:4:0","tags":["ngrok","linux","å®å¡”é¢æ¿","server","ubuntu"],"title":"æœ¬åœ°æ­å»ºç½‘ç«™æœåŠ¡å™¨å¹¶ç©¿é€å†…ç½‘","uri":"/posts/ngrok/"},{"categories":["Memo"],"content":" åŸæ–‡é“¾æ¥ â€œå“è¶Šç­â€åˆ°äº†å¤§ä¸‰çªç„¶æ€èµ·ä¸€è‚¡æ¯•ä¸šæ…Œï¼Œä¸€éƒ¨åˆ†äººæŠ•èº«äºè€ƒç ”çš„çƒ­æ½®ä¸­ï¼Œä¸€éƒ¨åˆ†äººé€‰æ‹©äº†åŸ¹è®­æœºæ„å­¦ä¹ æŠ€æœ¯ã€‚è€Œæˆ‘å‡ºäºç§ç§åŸå› æ—¢ä¸è€ƒç ”ä¹Ÿä¸åŸ¹è®­ï¼Œé€‰æ‹©è‡ªå­¦ java å’Œ web ç›¸å…³çš„çŸ¥è¯†ï¼Œä¹Ÿå¸Œæœ›å› æ­¤èƒ½åœ¨ä»¥åè°‹å¾—ä¸€ä»½å¿ƒä»ªçš„å·¥ä½œã€‚ å¦‚æœæ–‡ç« ä¸­æœ‰å‡ºç°çº°æ¼ã€é”™è¯¯ä¹‹å¤„ï¼Œè¿˜è¯·çœ‹åˆ°çš„å°ä¼™ä¼´å¤šå¤šæŒ‡æ•™ï¼Œå…ˆè¡Œè°¢è¿‡ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:0:0","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"HTML ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:0","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"1. Doctype ä½œç”¨ï¼ŒHTML5 ä¸ºä»€ä¹ˆåªéœ€è¦å†™ \u003c!DOCTYPE HTML\u003e doctype æ˜¯ä¸€ç§æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„æ–‡æ¡£ç±»å‹å£°æ˜ï¼Œç›®çš„æ˜¯å‘Šè¯‰æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€è§£æå™¨è¦ä½¿ç”¨ä»€ä¹ˆæ ·çš„æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰æ¥è§£ææ–‡æ¡£ã€‚\u003c!DOCTYPE\u003eå£°æ˜å¿…é¡»æ˜¯ HTML æ–‡æ¡£çš„ç¬¬ä¸€è¡Œï¼Œä½äº html æ ‡ç­¾ä¹‹å‰ HTML5 ä¸åŸºäº SGMLï¼Œæ‰€ä»¥ä¸éœ€è¦å¼•ç”¨ DTDã€‚åœ¨ HTML5 ä¸­\u003c!DOCTYPE\u003eåªæœ‰ä¸€ç§ SGML: æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ï¼Œæ˜¯ç°æ—¶å¸¸ç”¨çš„è¶…æ–‡æœ¬æ ¼å¼çš„æœ€é«˜å±‚æ¬¡æ ‡å‡† ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:1","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"2. è¡Œå†…å…ƒç´ æœ‰å“ªäº›ï¼Œå—çº§å…ƒç´ æœ‰å“ªäº›ï¼Œç©º (void) å…ƒç´ æœ‰é‚£äº› è¡Œå†…å…ƒç´ ï¼ša span i img input select b ç­‰ å—çº§å…ƒç´ ï¼šdiv ul ol li h1~h6 p table ç­‰ ç©ºå…ƒç´ ï¼šbr hr link ç­‰ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:2","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"3. ç®€è¿°ä¸€ä¸‹ä½ å¯¹ HTML è¯­ä¹‰åŒ–çš„ç†è§£ ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åˆé€‚çš„æ ‡ç­¾åšåˆé€‚çš„äº‹æƒ…ï¼Œè¿™æ ·å…·æœ‰ä»¥ä¸‹å¥½å¤„ï¼š æœ‰åŠ©äºæ„æ¶è‰¯å¥½çš„ HTML ç»“æ„ï¼Œæœ‰åˆ©äºæœç´¢å¼•æ“çš„å»ºç«‹ç´¢å¼•ã€æŠ“å–ï¼Œåˆ©äº SEO æœ‰åˆ©äºä¸åŒè®¾å¤‡çš„è§£æ æœ‰åˆ©äºæ„å»ºæ¸…æ™°çš„æœºæ„ï¼Œæœ‰åˆ©äºå›¢é˜Ÿçš„å¼€å‘ã€ç»´æŠ¤ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:3","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"4. å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æœ‰å“ªäº›ï¼Œä»‹ç»ä¸€ä¸‹ä½ å¯¹æµè§ˆå™¨å†…æ ¸çš„ç†è§£ Trident å†…æ ¸ï¼šIE Gecko å†…æ ¸ï¼šNETSCAPE6 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œç«ç‹ Presto å†…æ ¸ï¼šOpera7 åŠä»¥ä¸Šã€‚[Opera å†…æ ¸åŸä¸ºï¼šPrestoï¼Œç°ä¸ºï¼šBlink;] Webkit å†…æ ¸ï¼šSafariï¼ŒChrome ç­‰ã€‚[Chrome çš„ï¼šBlinkï¼ˆWebKit çš„åˆ†æ”¯ï¼‰] æµè§ˆå™¨å†…æ ¸åˆå¯ä»¥åˆ†æˆä¸¤éƒ¨åˆ†ï¼šæ¸²æŸ“å¼•æ“å’Œ JS å¼•æ“ã€‚ æ¸²æŸ“å¼•æ“ä¸»è¦è´Ÿè´£å–å¾—ç½‘é¡µçš„å†…å®¹ã€æ•´ç†è®¯æ¯ã€è®¡ç®—ç½‘é¡µçš„æ˜¾ç¤ºæ–¹å¼ç­‰ï¼ŒJS å¼•æ“åˆ™æ˜¯è§£æ Javascript è¯­è¨€ï¼Œæ‰§è¡Œ javascript è¯­è¨€æ¥å®ç°ç½‘é¡µçš„åŠ¨æ€æ•ˆæœã€‚ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:4","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"5. html5 æœ‰å“ªäº›æ–°ç‰¹æ€§ è¯­ä¹‰åŒ–æ ‡ç­¾ï¼šheader footer nav section article aside ç­‰ å¢å¼ºå‹è¡¨å•ï¼šdateï¼ˆä»ä¸€ä¸ªæ—¥æœŸé€‰æ‹©å™¨é€‰æ‹©ä¸€ä¸ªæ—¥æœŸï¼‰ emailï¼ˆåŒ…å« e-mail åœ°å€çš„è¾“å…¥åŸŸï¼‰ numberï¼ˆæ•°å€¼çš„è¾“å…¥åŸŸï¼‰ rangeï¼ˆä¸€å®šèŒƒå›´å†…æ•°å­—å€¼çš„è¾“å…¥åŸŸï¼‰ searchï¼ˆç”¨äºæœç´¢åŸŸï¼‰ telï¼ˆå®šä¹‰è¾“å…¥ç”µè¯å·ç å­—æ®µï¼‰ ç­‰ è§†é¢‘å’ŒéŸ³é¢‘ï¼šaudio video Canvas ç»˜å›¾ SVG ç»˜å›¾ åœ°ç†å®šä½ï¼šGeolocation æ‹–æ”¾ APIï¼šdrag web workerï¼šæ˜¯è¿è¡Œåœ¨åå°çš„ JavaScriptï¼Œç‹¬ç«‹äºå…¶ä»–è„šæœ¬ï¼Œä¸ä¼šå½±å“é¡µé¢çš„æ€§èƒ½ web storage: localStorage sessionStorage WebSocket: HTML5 å¼€å§‹æä¾›çš„ä¸€ç§åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯çš„åè®® ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:5","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"6. æè¿°ä¸€ä¸‹ cookieï¼ŒsessionStorage å’Œ localStorage çš„åŒºåˆ« ç‰¹æ€§ Cookie localStorage sessionStorage ç”Ÿå‘½å‘¨æœŸ å¯è®¾ç½®å¤±æ•ˆæ—¶é—´ï¼Œæ²¡æœ‰è®¾ç½®çš„è¯ï¼Œé»˜è®¤æ˜¯å…³é—­æµè§ˆå™¨åå¤±æ•ˆ é™¤éè¢«æ‰‹åŠ¨æ¸…é™¤ï¼Œå¦åˆ™å°†ä¼šæ°¸ä¹…ä¿å­˜ ä»…åœ¨å½“å‰ç½‘é¡µä¼šè¯ä¸‹æœ‰æ•ˆï¼Œå…³é—­é¡µé¢æˆ–æµè§ˆå™¨åå°±ä¼šè¢«æ¸…é™¤ å­˜æ”¾æ•°æ®å¤§å° 4KB å·¦å³ å¯ä»¥ä¿å­˜ 5MB çš„ä¿¡æ¯ å¯ä»¥ä¿å­˜ 5MB çš„ä¿¡æ¯ http è¯·æ±‚ æ¯æ¬¡éƒ½ä¼šæºå¸¦åœ¨ HTTP å¤´ä¸­ï¼Œå¦‚æœä½¿ç”¨ cookie ä¿å­˜è¿‡å¤šæ•°æ®ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ ä»…åœ¨å®¢æˆ·ç«¯ï¼ˆå³æµè§ˆå™¨ï¼‰ä¸­ä¿å­˜ï¼Œä¸å‚ä¸å’ŒæœåŠ¡å™¨çš„é€šä¿¡ ä»…åœ¨å®¢æˆ·ç«¯ï¼ˆå³æµè§ˆå™¨ï¼‰ä¸­ä¿å­˜ï¼Œä¸å‚ä¸å’ŒæœåŠ¡å™¨çš„é€šä¿¡ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:6","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"7. å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡ ä½¿ç”¨ localStorage: localStorage.setItem(key,value)ã€localStorage.getItem(key) websocket åè®® webworker å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:7","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"8. HTML5 çš„ç¦»çº¿å­˜å‚¨æ€ä¹ˆä½¿ç”¨ï¼Œè§£é‡Šä¸€ä¸‹å·¥ä½œåŸç† HTML5 çš„ç¦»çº¿å­˜å‚¨ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:8","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"9. src ä¸ href çš„åŒºåˆ« åŒºåˆ«ï¼šsrc ç”¨äºæ›¿ä»£è¿™ä¸ªå…ƒç´ ï¼Œè€Œ href ç”¨äºå»ºç«‹è¿™ä¸ªæ ‡ç­¾ä¸å¤–éƒ¨èµ„æºä¹‹é—´çš„å…³ç³» \u003clink href=\"style.css\" rel=\"stylesheet\" /\u003eæµè§ˆå™¨åŠ è½½åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œhtml çš„æ¸²æŸ“å’Œè§£æä¸ä¼šæš‚åœï¼Œcss æ–‡ä»¶çš„åŠ è½½æ˜¯åŒæ—¶è¿›è¡Œçš„ \u003cscript src=\"script.js\"\u003e\u003c/script\u003eå½“æµè§ˆå™¨è§£æåˆ°è¿™å¥ä»£ç æ—¶ï¼Œé¡µé¢çš„åŠ è½½å’Œè§£æéƒ½ä¼šæš‚åœç›´åˆ°æµè§ˆå™¨æ‹¿åˆ°å¹¶æ‰§è¡Œå®Œè¿™ä¸ª js æ–‡ä»¶ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:9","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"10. è¡¨å•æäº¤ä¸­ Get å’Œ Post æ–¹å¼çš„åŒºåˆ« Get ä¸€èˆ¬ç”¨äºä»æœåŠ¡å™¨ä¸Šè·å–æ•°æ®ï¼ŒPost å‘æœåŠ¡å™¨ä¼ é€æ•°æ® Get ä¼ è¾“çš„æ•°æ®æ˜¯æ‹¼æ¥åœ¨ Url ä¹‹åçš„ï¼Œå¯¹ç”¨æˆ·æ˜¯å¯è§çš„ï¼›Post çš„ä¼ è¾“æ•°æ®å¯¹ç”¨æˆ·æ˜¯ä¸å¯è§çš„ Get ä¼ é€çš„æ•°æ®é‡è¾ƒå°ï¼Œä¸èƒ½å¤§äº 2KBã€‚Post ä¼ é€çš„æ•°æ®é‡è¾ƒå¤§ï¼Œä¸€èˆ¬è¢«é»˜è®¤ä¸ºä¸å—é™åˆ¶ Get å®‰å…¨æ€§éå¸¸ä½ï¼ŒPost å®‰å…¨æ€§è¾ƒé«˜ åœ¨ FORM æäº¤çš„æ—¶å€™ï¼Œå¦‚æœä¸æŒ‡å®š Methodï¼Œåˆ™é»˜è®¤ä¸º Get è¯·æ±‚ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:1:10","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"CSS ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:0","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"1. css ç›’å­æ¨¡å‹ï¼Œbox-sizing å±æ€§çš„ç†è§£ css çš„ç›’æ¨¡å‹ç”± contentï¼ˆå†…å®¹ï¼‰ã€paddingï¼ˆå†…è¾¹è·ï¼‰ã€borderï¼ˆè¾¹æ¡†ï¼‰ã€marginï¼ˆå¤–è¾¹è·ï¼‰ç»„æˆã€‚ä½†ç›’å­çš„å¤§å°ç”± content+padding+border è¿™å‡ éƒ¨åˆ†å†³å®š box-sizing æ˜¯ä¸€ä¸ª CSS3 å±æ€§ï¼Œä¸ç›’å­æ¨¡å‹æœ‰ç€å¯†åˆ‡è”ç³»ã€‚å³å†³å®šå…ƒç´ çš„å®½é«˜å¦‚ä½•è®¡ç®—ï¼Œbox-sizing æœ‰ä¸‰ä¸ªå±æ€§ï¼š box-sizing: content-box|border-box|inherit: content-box ä½¿å¾—å…ƒç´ çš„å®½é«˜å³ä¸ºå†…å®¹åŒºçš„å®½é«˜ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰ border-box: è®¡ç®—æ–¹å¼ content + padding + border = æœ¬èº«å…ƒç´ å¤§å°ï¼Œå³ç¼©å°äº† content å¤§å° inherit æŒ‡å®š box-sizing å±æ€§çš„å€¼ï¼Œåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:1","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"2. æ¸…é™¤æµ®åŠ¨ï¼Œä»€ä¹ˆæ—¶å€™éœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Œæ¸…é™¤æµ®åŠ¨éƒ½æœ‰å“ªäº›æ–¹æ³• æµ®åŠ¨çš„å…ƒç´ æ˜¯è„±ç¦»æ–‡æ¡£æ ‡å‡†æµçš„ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ¸…æ¥šæµ®åŠ¨ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆçˆ¶å…ƒç´ é«˜åº¦å¡Œé™·ï¼Œå½±å“é¡µé¢å¸ƒå±€ã€‚ æ¸…é™¤æµ®åŠ¨çš„æ–¹å¼ï¼š ä¸ºçˆ¶å…ƒç´ è®¾ç½®é«˜åº¦ ä¸ºçˆ¶å…ƒç´ æ·»åŠ overflow:hidden ä¼ªå…ƒç´  .fix::after { content: ''; display: block; clear: both; } ä½¿ç”¨ä¼ªå…ƒç´ çš„å¥½å¤„ï¼šä¸å¢åŠ å†—ä½™çš„ DOM èŠ‚ç‚¹ï¼Œç¬¦åˆè¯­ä¹‰åŒ– overflow:hidden å¯ä»¥è§¦å‘ BFC æœºåˆ¶ã€‚BFCï¼šå—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼Œåˆ›å»ºäº† BFC çš„å…ƒç´ å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç›’å­ï¼Œå®ƒè§„å®šäº†å†…éƒ¨å¦‚ä½•å¸ƒå±€ï¼Œå¹¶ä¸”ä¸è¿™ä¸ªç‹¬ç«‹ç›’å­é‡Œçš„å¸ƒå±€ä¸å—å¤–éƒ¨å½±å“ï¼Œå½“ç„¶å®ƒä¹Ÿä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ï¼Œè®¡ç®— BFC çš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿå‚ä¸è®¡ç®— ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:2","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"3. å¦‚ä½•è®©ä¸€ä¸ªä¸å®šå®½é«˜çš„ç›’å­æ°´å¹³å‚ç›´å±…ä¸­ å®šä½çš„æ–¹å¼ .father { position: relative; } .son { position: absolute; top: 0; right: 0; bottom: 0; left: 0; margin: auto; } css3 å±æ€§ .father { position: relative; } .son { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); } flex å¸ƒå±€ .father { display: flex; justify-content: center; align-items: center; } ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:3","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"4. px å’Œ em å’Œ rem çš„åŒºåˆ« px: åƒç´ ï¼Œç›¸å¯¹é•¿åº¦å•ä½ã€‚åƒç´ pxæ˜¯ç›¸å¯¹äºæ˜¾ç¤ºå™¨å±å¹•åˆ†è¾¨ç‡è€Œè¨€çš„ emçš„å€¼å¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œä¼šç»§æ‰¿çˆ¶çº§å…ƒç´ çš„å­—ä½“å¤§å°ï¼Œä»£è¡¨å€æ•° remçš„å€¼å¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œå§‹ç»ˆæ˜¯åŸºäºæ ¹å…ƒç´  \u003chtml\u003e çš„ï¼Œä¹Ÿä»£è¡¨å€æ•° ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:4","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"5. position çš„å€¼æœ‰å“ªäº› staticï¼š é»˜è®¤å€¼ã€‚æ²¡æœ‰å®šä½ï¼Œå…ƒç´ å‡ºç°åœ¨æ­£å¸¸çš„æµä¸­ relativeï¼ˆç›¸å¯¹å®šä½ï¼‰ï¼šç”Ÿæˆç›¸å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºå…¶æ­£å¸¸ï¼ˆåŸå…ˆæœ¬èº«ï¼‰ä½ç½®è¿›è¡Œå®šä½ absoluteï¼ˆç»å¯¹å®šä½ï¼‰ï¼šç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äº static å®šä½ä»¥å¤–çš„ç¬¬ä¸€ä¸ªçˆ¶å…ƒç´ è¿›è¡Œå®šä½ fixedï¼ˆå›ºå®šå®šä½ï¼‰ï¼šç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:5","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"6. display:none ä¸ visibilityï¼šhidden çš„åŒºåˆ« åŒºåˆ« display:none visibilityï¼šhidden çš„ æ˜¯å¦å æ®ç©ºé—´ ä¸å æ®ä»»ä½•ç©ºé—´ï¼Œåœ¨æ–‡æ¡£æ¸²æŸ“æ—¶ï¼Œè¯¥å…ƒç´ å¦‚åŒä¸å­˜åœ¨ï¼ˆä½†ä¾ç„¶å­˜åœ¨æ–‡æ¡£å¯¹è±¡æ¨¡å‹æ ‘ä¸­ï¼‰ è¯¥å…ƒç´ ç©ºé—´ä¾æ—§å­˜åœ¨ æ˜¯å¦æ¸²æŸ“ ä¼šè§¦å‘ reflowï¼ˆå›æµï¼‰ï¼Œè¿›è¡Œæ¸²æŸ“ åªä¼šè§¦å‘ repaintï¼ˆé‡ç»˜ï¼‰ï¼Œå› ä¸ºæ²¡æœ‰å‘ç°ä½ç½®å˜åŒ–ï¼Œä¸è¿›è¡Œæ¸²æŸ“ æ˜¯å¦æ˜¯ç»§æ‰¿å±æ€§ ä¸æ˜¯ç»§æ‰¿å±æ€§ï¼Œå…ƒç´ åŠå…¶å­å…ƒç´ éƒ½ä¼šæ¶ˆå¤± æ˜¯ç»§æ‰¿å±æ€§ï¼Œè‹¥å­å…ƒç´ ä½¿ç”¨äº† visibility:visibleï¼Œåˆ™ä¸ç»§æ‰¿ï¼Œè¿™ä¸ªå­å­™å…ƒç´ åˆä¼šæ˜¾ç°å‡º ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:6","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"7. CSS ä¸­ link å’Œ@import çš„åŒºåˆ« link å±äº XHTML æ ‡ç­¾ï¼Œ@import å®Œå…¨æ˜¯ CSS æä¾›çš„ä¸€ç§æ–¹å¼ï¼Œåªèƒ½åŠ è½½ CSS åŠ è½½é¡ºåºçš„å·®åˆ«ï¼Œå½“ä¸€ä¸ªé¡µé¢è¢«åŠ è½½çš„æ—¶å€™ï¼Œlink å¼•ç”¨çš„ CSS ä¼šåŒæ—¶è¢«åŠ è½½ï¼Œè€Œ@import å¼•ç”¨çš„ CSS ä¼šç­‰åˆ°é¡µé¢å…¨éƒ¨è¢«ä¸‹è½½å®Œå†è¢«åŠ è½½ å…¼å®¹æ€§çš„å·®åˆ«ã€‚ç”±äº@import æ˜¯ CSS2.1 æå‡ºçš„æ‰€ä»¥è€çš„æµè§ˆå™¨ä¸æ”¯æŒï¼Œè€Œ link æ ‡ç­¾æ— æ­¤é—®é¢˜ å½“ä½¿ç”¨ javascript æ§åˆ¶ dom å»æ”¹å˜æ ·å¼çš„æ—¶å€™ï¼Œåªèƒ½ä½¿ç”¨ link æ ‡ç­¾ï¼Œå› ä¸º@import ä¸æ˜¯ dom å¯ä»¥æ§åˆ¶çš„ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:7","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"8. ä»€ä¹ˆæ˜¯å“åº”å¼è®¾è®¡ï¼Œå“åº”å¼è®¾è®¡çš„åŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆ å“åº”å¼ç½‘ç«™è®¾è®¡æ˜¯ä¸€ä¸ªç½‘ç«™èƒ½å¤Ÿå…¼å®¹å¤šä¸ªç»ˆç«¯ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸€ä¸ªç»ˆç«¯åšä¸€ä¸ªç‰¹å®šçš„ç‰ˆæœ¬ã€‚åŸºæœ¬åŸç†æ˜¯é€šè¿‡åª’ä½“æŸ¥è¯¢æ£€æµ‹ä¸åŒçš„è®¾å¤‡å±å¹•å°ºå¯¸åšå¤„ç† ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:8","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"9. ä¸ºä»€ä¹ˆè¦åˆå§‹åŒ– CSS æ ·å¼ å› ä¸ºæµè§ˆå™¨çš„å…¼å®¹é—®é¢˜ï¼Œä¸åŒæµè§ˆå™¨å¯¹æœ‰äº›æ ‡ç­¾çš„é»˜è®¤å€¼æ˜¯ä¸åŒçš„ï¼Œå¦‚æœæ²¡å¯¹ CSS åˆå§‹åŒ–å¾€å¾€ä¼šå‡ºç°æµè§ˆå™¨ä¹‹é—´çš„é¡µé¢æ˜¾ç¤ºå·®å¼‚ åˆå§‹åŒ–æ ·å¼ä¼šå¯¹ SEO æœ‰ä¸€å®šçš„å½±å“ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:9","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"10. CSS3 æœ‰å“ªäº›æ–°ç‰¹æ€§ å®ç°åœ†è§’border-radiusï¼Œé˜´å½±box-shadowï¼Œè¾¹æ¡†å›¾ç‰‡border-image å¯¹æ–‡å­—åŠ ç‰¹æ•ˆtext-shadowï¼Œå¼ºåˆ¶æ–‡æœ¬æ¢è¡Œword-wrapï¼Œçº¿æ€§æ¸å˜linear-gradient å®ç°æ—‹è½¬transform:rotate(90deg), ç¼©æ”¾scale(0.85,0.90),translate(0px,-30px)å®šä½ï¼Œå€¾æ–œskew(-9deg,0deg); å¢åŠ äº†æ›´å¤šçš„ CSS é€‰æ‹©å™¨ã€å¤šèƒŒæ™¯ã€rgba() å”¯ä¸€å¼•å…¥çš„ä¼ªå…ƒç´ æ˜¯::selectionï¼› å®ç°åª’ä½“æŸ¥è¯¢@mediaï¼Œå¤šæ å¸ƒå±€flex è¿‡æ¸¡transition åŠ¨ç”»animation ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:10","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"11. ::before å’Œ :after ä¸­åŒå†’å·å’Œå•å†’å·æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿè§£é‡Šä¸€ä¸‹è¿™ 2 ä¸ªä¼ªå…ƒç´ çš„ä½œç”¨ å•å†’å· (:) ç”¨äº CSS3 ä¼ªç±»ï¼ŒåŒå†’å· (::) ç”¨äº CSS3 ä¼ªå…ƒç´ ã€‚ï¼ˆä¼ªå…ƒç´ ç”±åŒå†’å·å’Œä¼ªå…ƒç´ åç§°ç»„æˆï¼‰, åŒå†’å·æ˜¯åœ¨å½“å‰è§„èŒƒä¸­å¼•å…¥çš„ï¼Œç”¨äºåŒºåˆ†ä¼ªç±»å’Œä¼ªå…ƒç´  ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:11","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"12. CSS ä¼˜åŒ–ã€æé«˜æ€§èƒ½çš„æ–¹æ³•æœ‰å“ªäº› ç§»é™¤ç©ºçš„ css è§„åˆ™ï¼ˆRemove empty rulesï¼‰ æ­£ç¡®ä½¿ç”¨ display çš„å±æ€§ ä¸æ»¥ç”¨æµ®åŠ¨ã€web å­—ä½“ ä¸å£°æ˜è¿‡å¤šçš„ font-size ä¸åœ¨é€‰æ‹©ç¬¦ä¸­ä½¿ç”¨ ID æ ‡è¯†ç¬¦ éµå®ˆç›’æ¨¡å‹è§„åˆ™ å°½é‡å‡å°‘é¡µé¢é‡æ’ã€é‡ç»˜ æŠ½è±¡æå–å…¬å…±æ ·å¼ï¼Œå‡å°‘ä»£ç é‡ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:12","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"13. é‡ç»˜å’Œå›æµ é‡ç»˜å’Œå›æµ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:13","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"14. flex å¸ƒå±€ flex å¸ƒå±€æ•™ç¨‹â€“é˜®ä¸€å³° ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:14","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["Memo"],"content":"15. css é¢„å¤„ç†å™¨ æä¾›äº†ä¸€ç§ css çš„ä¹¦å†™æ–¹å¼ï¼Œå¸¸è§çš„å°±æ˜¯ SAAS æ–‡æ¡£ å’Œ LESS æ–‡æ¡£ ","date":"2019-03-30","objectID":"/posts/ms-html-css/:2:15","tags":["HTML","CSS"],"title":"å‰ç«¯é¢è¯•é¢˜ - HTML+CSS","uri":"/posts/ms-html-css/"},{"categories":["ACM"],"content":" æˆ‘å›½å¤ä»£æ•°å­¦å®¶å¼ ä¸˜å»ºåœ¨ã€Šç®—ç»ã€‹ä¸€ä¹¦ä¸­æå‡ºçš„æ•°å­¦é—®é¢˜ï¼šé¸¡ç¿ä¸€å€¼é’±äº”ï¼Œé¸¡æ¯ä¸€å€¼é’±ä¸‰ï¼Œé¸¡é›ä¸‰å€¼é’±ä¸€ã€‚ç™¾é’±ä¹°ç™¾é¸¡ï¼Œé—®é¸¡ç¿ã€é¸¡æ¯ã€é¸¡é›å„å‡ ä½•ï¼Ÿ è®¾å…¬é¸¡ï¼Œæ¯é¸¡ï¼Œå°é¸¡æ•°ç›®åˆ†åˆ«ä¸º x,y,z(x\u003c=20,y\u003c=33,z\u003c=100) ","date":"2019-03-30","objectID":"/posts/bqbj/:0:0","tags":["ACM"],"title":"ç™¾é’±ç™¾é¸¡ï¼ˆæšä¸¾æ³•ï¼‰","uri":"/posts/bqbj/"},{"categories":["ACM"],"content":"çº¦æŸæ¡ä»¶ x+y+z=100 5x+3y+z/3=100 ","date":"2019-03-30","objectID":"/posts/bqbj/:1:0","tags":["ACM"],"title":"ç™¾é’±ç™¾é¸¡ï¼ˆæšä¸¾æ³•ï¼‰","uri":"/posts/bqbj/"},{"categories":["ACM"],"content":"ç®—æ³•åˆ†æ è‹¥ä¾æ¬¡æšä¸¾ x,y,x, åˆ™è‡³å°‘å°è¯• 21*34*100=71400 æ¬¡ï¼Œæ˜¾ç„¶æ•ˆç‡å¤ªä½ã€‚ åœ¨ x,y çš„æ•°ç›®ç¡®å®šåï¼Œz çš„æ•°ç›®ä¹Ÿå°±ç¡®å®šä¸‹æ¥äº† 100-x-yï¼Œæ— é¡»å†è¿›è¡Œæšä¸¾ï¼Œæ­¤æ—¶çº¦æŸæ¡ä»¶åªæœ‰ä¸€ä¸ª 5x+3y+z/3=100. åªéœ€æšä¸¾ x,yï¼Œå…± 21*34=714 æ¬¡ã€‚ ","date":"2019-03-30","objectID":"/posts/bqbj/:2:0","tags":["ACM"],"title":"ç™¾é’±ç™¾é¸¡ï¼ˆæšä¸¾æ³•ï¼‰","uri":"/posts/bqbj/"},{"categories":["ACM"],"content":"ç®—æ³•è®¾è®¡ #include\u003cstdio.h\u003e int main(){ int x,y,z; for(x=0;x\u003c=20;x++) //21*34=714 for(y=0;y\u003c=33;y++){ z=100-y-x; if(z%3==0 \u0026\u0026 (5*x+3*y+z/3)==100){//é™å®š z èƒ½è¢« 3 æ•´é™¤ï¼Œè¿›ä¸€æ­¥æé«˜æ•ˆç‡ printf(\"cock number:%d\\t\",x); printf(\"hen number:%d\\t\",y); printf(\"chick number:%d\\n\",z); } } return 0; } è¿è¡Œè§£ cock number:0 hen number:25 chick number:75 cock number:4 hen number:18 chick number:78 cock number:8 hen number:11 chick number:81 cock number:12 hen number:4 chick number:84 ","date":"2019-03-30","objectID":"/posts/bqbj/:3:0","tags":["ACM"],"title":"ç™¾é’±ç™¾é¸¡ï¼ˆæšä¸¾æ³•ï¼‰","uri":"/posts/bqbj/"},{"categories":["ACM"],"content":" å¤§æ•°ä¹˜æ³• c ç‰ˆ(åŸºç¡€å†™æ³•) #include\u003cstdio.h\u003e #include\u003cstring.h\u003e #define N 202 int main() { int a[N] = {0}, b[N] = {0}, c[404] = {0}, la, lb, i, j,k, d = 0, n1, n2;//202ä½æ•°ç›¸ä¹˜ï¼Œæœ€é•¿404ä½æ•° int get(int *p); void change(int *a, int *b, int n); la = get(a); lb = get(b); n1 = la \u003e lb ? la : lb;//è¾ƒé•¿çš„æ•°é•¿ n2 = la \u003c lb ? la : lb;//è¾ƒçŸ­çš„æ•°é•¿ if (la \u003c lb) change(a, b, lb); //æ¨¡æ‹Ÿä¹˜æ³•è¿ç®—è¿‡ç¨‹ï¼ˆè¿›ä½ç­‰è€ƒè™‘ï¼‰ for (i = 0; i \u003c n2; i++) { for (j = 0; j \u003c n1; j++) { c[j + i] += (b[i] * a[j] + d)%10; d = (b[i] * a[j] + d) / 10; if (c[j+i]\u003e9){ d++; c[j+i]%=10; } if (a[j+1]==0\u0026\u0026d!=0){ k=j+i+1; c[k]=d; } } d=0; } k=k\u003e(j+i-2)?k:j+i-2; for (i = k; i \u003e= 0; i--)//å°†å€’åºè£…å…¥çš„ç»“æœæ‰“å° printf(\"%d\", c[i]); return 0; } //è¾“å…¥å­—ç¬¦ä¸²ä½œä¸ºæ•°å­—ï¼Œå¹¶è¿”å›æ•°å­—å»é™¤å‰å¯¼0åçš„é•¿åº¦ int get(int *p) { char x[N]; int l, i, ex = 0; scanf(\"%s\", x); l = strlen(x); while (x[ex] == '0') ex++; for (i = ex; i \u003c l; i++) //æå–å­—ç¬¦ä¸²æ•°å­—åˆ°intæ•°ç»„ï¼Œå€’åºæ’åˆ— *(p + l - i - 1) = x[i] - '0'; return l - ex; } void change(int *a, int *b, int n) { int i, t; for (i = 0; i \u003c n; i++) { t = a[i]; a[i] = b[i]; b[i] = t; } } ç¨‹åºè¿è¡Œç»“æœ 1234567890123456789 98765432109876543210 121932631124517831023715309991126352690 ","date":"2019-03-28","objectID":"/posts/dacheng/:0:0","tags":["æ•°å­¦","å¤§æ•°è¿ç®—","ACM","C"],"title":"å¤§æ•°ä¹˜æ³•","uri":"/posts/dacheng/"},{"categories":["Grocery"],"content":" è®°å½•è‡ªå·±åœ¨é…ç½® vps åŠåšå®¢ SSL è¯ä¹¦æ—¶é‡åˆ°çš„é—®é¢˜ã€‚ ","date":"2019-03-28","objectID":"/posts/http2https/:0:0","tags":["SSL","redirect","CDN","JavaScript","server"],"title":"vps é…ç½® ssl åŠ https é‡å®šå‘","uri":"/posts/http2https/"},{"categories":["Grocery"],"content":"å¼ºåˆ¶é‡å®šå‘ https æœ‰ä¸€ç§æƒ…å†µç›¸ä¿¡å¾ˆå¤šäººéƒ½é‡åˆ°è¿‡ï¼Œå°±æ˜¯è™½ç„¶æˆ‘ä»¬é…ç½®äº† ssl è¯ä¹¦ï¼Œä½†æ˜¯ https å’Œ http åœ°å€éƒ½æ˜¯å„è‡ªéƒ½å¯ä»¥å•ç‹¬è®¿é—®ã€‚æˆ‘ä»¬åº”è¯¥ä¹Ÿè§è¿‡ç±»ä¼¼äº github çš„ä»£ç æ‰˜ç®¡ç½‘ç«™æœ‰å¼ºåˆ¶ https çš„å¼€å…³ã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ js è¿›è¡Œ 301 å®šå‘ã€‚ \u003cscript\u003e var targetProtocol = \"https:\"; var host = \"lruihao.cn\"; if (window.location.host == host \u0026\u0026 window.location.protocol != targetProtocol){ window.location.href = targetProtocol + window.location.href.substring(window.location.protocol.length); } \u003c/script\u003e ","date":"2019-03-28","objectID":"/posts/http2https/:1:0","tags":["SSL","redirect","CDN","JavaScript","server"],"title":"vps é…ç½® ssl åŠ https é‡å®šå‘","uri":"/posts/http2https/"},{"categories":["Grocery"],"content":"è…¾è®¯äº‘ CDN é…ç½® è¿™ä¸ªåšå®¢åæ¥æ˜¯è½¬åˆ°äº†è…¾è®¯äº‘çš„ cos æ¡¶å­˜å‚¨ã€‚å½“æ—¶åœ¨æ¡¶å†…é™æ€ç½‘ç«™è®¾ç½®çš„æ—¶å€™ï¼Œè®¾ç½®å¼ºåˆ¶ https å‘ç°ä¼šå‡ºé”™ã€‚è€Œä¸”è¿˜æ¥å…¥äº† CDNï¼Œæ‰€ä»¥ä»Šå¤©åœ¨ CDN è®¾ç½®é‚£é‡Œä¹Ÿçœ‹åˆ°äº† https çš„è®¾ç½®ï¼Œæ‰“å¼€å¼ºåˆ¶ https å°± OK äº†ã€‚è¿™å¤©åœ¨ä¸‰ä¸°äº‘æ’¸äº†ä¸€ä¸ªå…è´¹çš„ä¸»æœºï¼Œæ­äº†ä¸€ä¸ª WordPressï¼ˆæƒ³è¯•è¯• wp çš„æ„Ÿè§‰ï¼‰ï¼Œç„¶å vps çš„ SSL é—®é¢˜ç°åœ¨ä¹Ÿå¾ˆç®€å•äº†ï¼Œç¬¬ä¸€æ­¥ï¼Œåˆ°è…¾è®¯äº‘ç”³è¯·å…è´¹è¯ä¹¦ï¼›ç¬¬äºŒæ­¥ï¼Œé…ç½® CDNï¼ŒæŒ‰æ­¥éª¤æ¥ï¼Œå…¶ä¸­æ¥å…¥æ–¹å¼é€‰æ‹©è‡ªæœ‰æºç«™ï¼›ç¬¬ä¸‰æ­¥ï¼Œå¼ºåˆ¶ httpsï¼ˆå¯é€‰ï¼‰ã€‚ ","date":"2019-03-28","objectID":"/posts/http2https/:2:0","tags":["SSL","redirect","CDN","JavaScript","server"],"title":"vps é…ç½® ssl åŠ https é‡å®šå‘","uri":"/posts/http2https/"},{"categories":["Memo"],"content":"åŸºäº hexo-theme-next 6.0+çš„ Pisces æ¨¡æ¿åšçš„ DIY æ‰©å±•æ€§è®¾è®¡","date":"2019-03-21","objectID":"/posts/hexo-theme-next/","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":" å±é™© å¦‚æ— å¿…è¦ï¼Œä¸å†æ›´æ–°ï¼ï¼ˆ2019.09.13ï¼‰ ä»Šæ™šæˆ‘åšå‡ºäº†ä¸€ä¸ªæ…é‡çš„å†³å®šï¼Œç”±äºåšä¸»æ—¶é—´ç²¾åŠ›æœ‰é™ï¼Œéœ€è¦æ›´å¤šçš„æ—¶é—´æ¥å·¥ä½œå’Œå­¦ä¹ ã€‚æ‰€ä»¥æˆ‘å°†æ”¾å¼ƒå¯¹ next çš„ä¸»é¢˜çš„è‡ªå®šä¹‰ä¿®æ”¹ï¼Œnext ä¸»é¢˜å®˜æ–¹å·²ç»æ›´æ–°åˆ°äº† 7.0+çš„ç‰ˆæœ¬ï¼Œå–œæ¬¢ next ä¸»é¢˜é£æ ¼çš„æœ‹å‹å¯ä»¥åœ¨ github æ›´æ–°ã€‚ æˆ‘è¿™ä¹Ÿç®—æ˜¯ä¸Šå¤ç‰ˆæœ¬äº†ï¼Œç‰ˆæœ¬å·®è·å®åœ¨è¿‡å¤§ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿå°†æ”¾å¼ƒåšå®¢ä½¿ç”¨ä¸»é¢˜çš„æ›´æ–°ã€‚ ä»¥ä¸‹ä»ä¸ºå½“å‰åšå®¢ä½¿ç”¨ä¸»é¢˜ï¼Œlib èµ„æºå·²æ‰“åŒ… githubã€‚ next åŸºäº hexo-theme-next 6.0+ çš„ Pisces æ¨¡æ¿åšçš„ DIY æ‰©å±•æ€§è®¾è®¡ï¼ˆéƒ¨åˆ†å…¼å®¹ next å…¶ä»–å‡ ç§æ¨¡æ¿ï¼‰ã€‚ä¸»è¦æ˜¯ä¸€äº› custom style è¿˜æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹çš„ jsã€‚ä¿®æ”¹çš„åœ°æ–¹å¤ªå¤šä¹Ÿæœ‰ç‚¹å°ä¹±å°±ä¸æ PR äº†ã€‚ modifiedâ€ƒå®˜æ–¹ Demo =\u003e https://theme-next.org è®°å½•ä¸€ä¸‹æŠ˜è…¾è¿‡ç¨‹ï¼Œä»¥åå¤‡ä»½æ¢å¤åšå®¢ä¹Ÿå¥½æ–¹ä¾¿è‡ªå·±ã€‚æœ¬æ–‡ä¹‹å‰çš„ç¾åŒ–ä¿®æ”¹è¯·è§ hexo æ ‡ç­¾ã€‚ ä¸»é¢˜ä¸­è‹¥æœ‰é—æ¼ç¬¬ä¸‰æ–¹æ’ä»¶æˆ–åº”ç”¨çš„ key åŠ id å€¼ç­‰è¯·ä¿®æ”¹ä¸ºè‡ªå·±å¯¹åº”çš„å€¼ ä¸»è¦çš„å‡ ä¸ªè‡ªå®šä¹‰æ–‡ä»¶ _config.swig #ä¸»é¢˜é…ç½®æ–‡ä»¶ ç›¸å…³è´¦æˆ·ä¿¡æ¯è‡ªå·±æ³¨å†Œæ›¿æ¢ \\layout\\custom\\head.swig #åœ¨å¤´éƒ¨è‡ªå®šä¹‰åŠ å…¥æ ‡ç­¾ \\layout\\custom\\google_adsense.swig #è°·æ­Œå¹¿å‘Šæ¨¡å—ï¼Œå†…æœ‰æ³¨é‡Šæš‚æ—¶å¼ƒç”¨ \\layout\\_layout.swig #ä¸»å¸ƒå±€ \\layout\\_macro\\post.swig #æ–‡ç« å¸ƒå±€ \\layout\\_macro\\post-copyright.swig #æ–‡ç« ç‰ˆæƒ \\layout\\_macro\\siderbar.swig #ä¾§æ æ¨¡æ¿ \\layout\\_third-party\\copy-code.swig #å¤åˆ¶æŒ‰é’® \\layout\\_partials\\comments.swig #è¯„è®ºä¸»æ¨¡æ¿ \\layout\\_partials\\footer.swig #åº•éƒ¨æ¨¡æ¿#è¯¥æ¨¡å—åœ¨ layout.swig å¼•å…¥ï¼Œç”¨äºåœ¨ body è‡ªå®šä¹‰æ ‡ç­¾ \\layout\\_partials\\footer_custom.swig #footer è‡ªå®šä¹‰æ–‡ä»¶ \\layout\\_third-party\\custom.swig #è¯¥æ¨¡å—åœ¨ layout.swig å¼•å…¥ç”¨äºåœ¨ body è‡ªå®šä¹‰æ ‡ç­¾ \\source\\css\\_custom\\customs.styl #ä¸»è¦ç”¨æˆ·è‡ªå®šä¹‰æ ·å¼è¡¨ \\source\\fonts\\ #å¼•å…¥äº†ä¸€äº›æˆ‘çš„æ‰‹å†™ä½“åŠå¤–éƒ¨å­—ä½“ \\scripts\\qcloudcdn.js #è…¾è®¯äº‘ cos æ¡¶åˆ·æ–°ç¼“å­˜çš„è„šæœ¬ï¼Œä¸éœ€è¦å¯åˆ æ‰ [^1] ^1 ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:0:0","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"åˆæ­¥å®‰è£… å®‰è£…æ•´ä¸ªæ”¹è¿‡çš„ä¸»é¢˜ï¼Œç„¶åä¸‹è½½ç›¸åº”çš„ lib èµ„æºè§£å‹æ”¾å…¥ source æ–‡ä»¶å¤¹ cd hexo git clone https://github.com/Lruihao/hexo-theme-next themes/next ä¸»é¢˜é…ç½®æ–‡ä»¶_config.yml, é€‰æ‹©ä¸»é¢˜ theme: next lib ä¸‹è½½ http://github.com/Lruihao/hexo-theme-next/releases/tag/v6.9.1 ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:1:0","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"æ›´æ–°å†…å®¹ æ›´å¤šè‡ªå®šä¹‰è¯¦è§æºç  ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:0","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"links æ¨¡æ¿ è‡ªå®šä¹‰å‹é“¾æ¨¡æ¿ï¼Œæ‰“å¼€hexo\\themes\\next\\layout\\æ–°å»ºlinks.swigæ–‡ä»¶ï¼Œå†™ä¸‹ä»¥ä¸‹å†…å®¹åä¿å­˜ã€‚ {% extends '_layout.swig' %} {% import '_macro/sidebar.swig' as sidebar_template %} {% block title %}{# #}{% set page_title_suffix = ' | ' + title %}{# #}{% if page.type === \"categories\" and not page.title %}{# #}{{ __('title.category') + page_title_suffix }}{# #}{% elif page.type === \"tags\" and not page.title %}{# #}{{ __('title.tag') + page_title_suffix }}{# #}{% elif page.type === \"photos\" and not page.title %}{# #}{{ __('title.photos') + page_title_suffix }}{# #}{% else %}{# #}{{ page.title + page_title_suffix }}{# #}{% endif %}{# #}{% endblock %} {% block page_class %}page-post-detail{% endblock %} {% block content %} \u003cdiv id=\"posts\" class=\"posts-expand\"\u003e {##################} {#### PAGE BLOCK ###} {##################} \u003cdiv class=\"post-block page\"\u003e {% include '_partials/page-header.swig' %} {#################} {#### PAGE BODY ###} {#################} \u003cscript src=\"//at.alicdn.com/t/font_578712_g26jo2kbzd5qm2t9.js\"\u003e\u003c/script\u003e \u003cdiv class=\"post-body{% if theme.han %} han-init-context{% endif %}{% if page.direction \u0026\u0026 page.direction.toLowerCase() === 'rtl' %} rtl{% endif %}\"\u003e \u003cdiv class=\"links-list\"\u003e {% for svg,link in site.data.links %} \u003cdiv class=\"card-box\" title=\"{{ link.info }}\"\u003e \u003ca href=\"{{ link.site }}\" target=\"_blank\"\u003e {% if link.avatar %} \u003cimg class=\"card-avatar\" data-original=\"{{ link.avatar }}\" alt=\"{{ link.nickname }}\"/\u003e {% else %} \u003csvg class=\"card-avatar\" aria-hidden=\"true\"\u003e \u003cuse xlink:href=\"#icon-{{svg+1}}\"\u003e\u003c/use\u003e \u003c/svg\u003e {% endif %} \u003cspan title=\"{{ link.nickname }}\"\u003e@{{ link.nickname }}\u003c/span\u003e \u003c/a\u003e \u003c/div\u003e {% endfor %} \u003c/div\u003e {{ page.content }} \u003c/div\u003e \u003cstyle\u003e /* @Author: lruihao.cn */ .links-list { margin-top: 1rem; display: flex; flex-direction: row; justify-content: space-between; flex-wrap: wrap; } .card-box { width: 150px; height: 200px; font-size: 1rem; text-align: center; background: rgba(255,255,255,0.3); box-sizing: border-box; box-shadow: 3px 3px 5px #aaa; border-radius: 5px; transition-duration: 0.3s; margin-bottom: 1rem; display: flex; flex-direction: column; } .card-box:hover { background: #fff; transform: scale(1.03); box-shadow: 0 0 3px #aaa; } .card-box a { border:none; } .card-avatar { width: 100%!important; height: 150px!important; border-radius: 5px; margin: 0; padding: 0; } .card-box span{ display: block; position: relative; bottom: 1rem; align-self: flex-end; color: #2bbc8a; font-weight: bold; max-width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; margin-top: 15px; } .card-box span:hover { color: #d480aa; } \u003c/style\u003e {#####################} {#### END PAGE BODY ###} {#####################} \u003c/div\u003e {% include '_partials/breadcrumb.swig' %} {######################} {#### END PAGE BLOCK ###} {######################} \u003c/div\u003e {% endblock %} {% block sidebar %} {{ sidebar_template.render(false) }} {% endblock %} {% block script_extra %} {% include '_scripts/pages/post-details.swig' %} {% endblock %} è‹¥æœªä½¿ç”¨æ‡’åŠ è½½è¯·å°†æ¨¡æ¿ä¸­çš„data-originalå±æ€§æ”¹ä¸ºsrc è‹¥æ‡’åŠ è½½æ— æ³•åŠ è½½é¢„è§ˆå›¾è¯·æ‰‹åŠ¨æ·»åŠ src=\"/images/loading.gif\" è‹¥ fancybox æ˜¾ç¤º alt å†…å®¹è¯·æ›´æ¢ fancybox2 æˆ–è€…å°† alt å±å€¼åˆ é™¤ \u003cimg class=\"card-avatar\" data-original=\"{{ link.avatar }}\" alt=\"{{ link.nickname }}\"/\u003e ç„¶åhexo n page linksæ–°å»ºä¸€ä¸ªé¡µé¢æ–‡ç« é…ç½®å†™ä¸‹å¦‚ä¸‹å†…å®¹ï¼š --- title: å‹æƒ…é“¾æ¥ layout: links --- ç„¶ååœ¨linksé¡µé¢æ–‡ä»¶å¤¹ä¸‹é¢æ–°å»ºæ–‡ä»¶å¤¹_dataï¼Œå†åœ¨é‡Œé¢æ–°å»ºlinks.ymlï¼Œå†…å®¹å¦‚ä¸‹ - nickname: åšæ¡çœ¾é•· avatar: http://lruihao.cn/images/avatar.png site: http://lruihao.cn info: ä¸€ä¸ªèœé¸Ÿçš„åšå®¢ - nickname: #å‹é“¾åç§° avatar: #å‹é“¾å¤´åƒ site: #å‹é“¾åœ°å€ info: #å‹é“¾è¯´æ˜ ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:1","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"å¤‡æ¡ˆä¿¡æ¯è‡ªå®šä¹‰ ## ------------------------------------------------------------- ## footer_custom Settings ## ------------------------------------------------------------- beian: enable: true gov: æ¹˜å…¬ç½‘å®‰å¤‡ 43030402000254 å· recordcode: 43030402000254 icp: æ¹˜ ICP å¤‡ 18020535 å· ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:2","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"æ–‡å­—æŠ–åŠ¨ç‰¹æ•ˆ \u003cdiv class=\"shaky\"\u003eï¼ˆã¥â—'â—¡'â—) ã¥ â¥å†…å®¹åŒº\u003c/div\u003e ï¼ˆã¥â—'â—¡'â—) ã¥ â¥å†…å®¹åŒº ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:3","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"å·¦ä¸‹è§’å¾®ä¿¡å…¬ä¼—å· \\source\\css\\_custom\\customs.styl ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:4","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"ç›¸å…³æ–‡ç« æ”¶çº³ åŠ å…¥ H5 æ ‡ç­¾ï¼Œå®ç°å¯æ”¶çº³åŠŸèƒ½ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…ã€‚ ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:5","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"Chat Services å…± chatra,tidio,daovoice ä¸‰ä¸ªé€‰é¡¹ï¼Œä¸‰é€‰ä¸€ ## Chatra Support ## See: https://chatra.io ## Dashboard: https://app.chatra.io/settings/general chatra: enable: false async: true id: ## visit Dashboard to get your ChatraID #embed: ## unfinished experimental feature for developers, See: https://chatra.io/help/api/#injectto ## Tidio Support ## See: https://www.tidiochat.com ## Dashboard: https://www.tidiochat.com/panel/dashboard tidio: enable: false key: ## Public Key, get it from Dashboard, See: https://www.tidiochat.com/panel/settings/developer #åœ¨çº¿å®¢æœ daovoice: true daovoice_app_id: xxxx ## http://www.daovoice.io/ ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:6","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"pdf å’Œ Mermaid è§£ææ¨¡å— pdf ä¼ é€é—¨ pdf: enable: false ## Default height height: 500px pdfobject: cdn: //cdn.jsdelivr.net/npm/pdfobject@2/pdfobject.min.js #cdn: //cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js ## Mermaid tag mermaid: enable: false ## Available themes: default | dark | forest | neutral theme: forest cdn: //cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js #cdn: //cdnjs.cloudflare.com/ajax/libs/mermaid/8.0.0/mermaid.min.js ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:7","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"æ¨¡ä»¿ csdn è½¬å‘æ ·å¼ ... \u003ca class=\"post-title-link\" href=\"{{ url_for(post.path) }}\" itemprop=\"url\"\u003e + {% if post.repost %} + \u003cspan class=\"repost\"\u003eè½¬\u003c/span\u003e + {% endif %} {{ post.title | default(__('post.untitled'))}} \u003c/a\u003e {% else -%} + {% if post.repost %} + \u003cspan class=\"repost\"\u003eè½¬\u003c/span\u003e + {% endif %} {{- post.title -}} ... .repost { color: #5acc79; border: 1px solid #e7f4df; border-radius: 20px; padding: 2px 5px; font-size: 15px; font-weight: 500; } --- title: xxxx repost: true --- é¢„è§ˆ ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:8","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"çƒ­åº¦é¡µé¢ æ‰“å¼€hexo\\themes\\next\\layoutæ–°å»º top.swig æ–‡ä»¶ï¼Œå†™ä¸‹å¦‚ä¸‹å†…å®¹ä¿å­˜ï¼š {% extends '_layout.swig' %} {% import '_macro/sidebar.swig' as sidebar_template %} {% block title %}{# #}{% set page_title_suffix = ' | ' + title %}{# #}{% if page.type === \"categories\" and not page.title %}{# #}{{ __('title.category') + page_title_suffix }}{# #}{% elif page.type === \"tags\" and not page.title %}{# #}{{ __('title.tag') + page_title_suffix }}{# #}{% elif page.type === \"photos\" and not page.title %}{# #}{{ __('title.photos') + page_title_suffix }}{# #}{% else %}{# #}{{ page.title + page_title_suffix }}{# #}{% endif %}{# #}{% endblock %} {% block page_class %}page-post-detail{% endblock %} {% block content %} \u003cdiv id=\"posts\" class=\"posts-expand\"\u003e {##################} {#### PAGE BLOCK ###} {##################} \u003cdiv class=\"post-block page\"\u003e {% include '_partials/page-header.swig' %} {#################} {#### PAGE BODY ###} {#################} \u003cdiv class=\"post-body{% if theme.han %} han-init-context{% endif %}{% if page.direction \u0026\u0026 page.direction.toLowerCase() === 'rtl' %} rtl{% endif %}\"\u003e {{ page.content }} \u003cdiv id=\"top\"\u003e\u003c/div\u003e \u003c/div\u003e \u003cstyle\u003e #top{ display: flex; flex-direction: row; justify-content: space-between; flex-wrap: wrap; width: 100%; min-height: calc({{ page.limit }} * 20px); } #top div{ width: 400px; height: 40px; max-width: 400px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; } #top a{ color: #555; text-decoration: none; outline: 0; border-bottom: 1px solid #999; word-wrap: break-word; } \u003c/style\u003e \u003cscript src=\"https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js\"\u003e\u003c/script\u003e \u003cscript\u003eAV.initialize(\"{{ theme.valine.appid }}\", \"{{ theme.valine.appkey }}\");\u003c/script\u003e \u003cscript type=\"text/javascript\"\u003e setTimeout(function(){ var time=0 var title=\"\" var url=\"\" var query = new AV.Query('Counter'); query.notEqualTo('id',0); query.descending('time'); query.limit({{ page.limit }}); //è®¾ç½®ç¯‡æ•° query.find().then(function (todo) { for (var i=0;i\u003c{{ page.limit }};i++){ var result=todo[i].attributes; time=result.time; title=result.title; category=result.categories url=result.url; var content=\"\u003cdiv\u003e\"+\"ã€æ–‡ç« çƒ­åº¦ï¼š\"+time+\"â„ƒã€‘\"+\"\u003ca href='\"+\"{{ config.url }}\"+\"\"+url+\"'\u003e\"+title+\"\u003c/a\u003e\"+\"\u003c/div\u003e\"; document.getElementById(\"top\").innerHTML+=content; } }, function (error) { console.log(\"error\"); }); },1000) \u003c/script\u003e {#####################} {#### END PAGE BODY ###} {#####################} \u003c/div\u003e {% include '_partials/breadcrumb.swig' %} {######################} {#### END PAGE BLOCK ###} {######################} \u003c/div\u003e {% endblock %} {% block sidebar %} {{ sidebar_template.render(false) }} {% endblock %} {% block script_extra %} {% include '_scripts/pages/post-details.swig' %} {% endblock %} å…¶ä¸­ç¬¬ 36 è¡Œæ”¹æˆä½ è‡ªå·±çš„ leancloud çš„ appid å’Œ appkey, æ¯”å¦‚æˆ‘çš„æ˜¯åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶é‡Œé¢çš„ valine é…ç½®ä¸‹ï¼Œæ‰€ä»¥æˆ‘å°±å†™æˆtheme.valine.appidã€‚å’Œæˆ‘ä¸€æ ·å°±ä¸éœ€è¦ä¿®æ”¹ï¼Œå…¶ä»–è‡ªè¡Œé…ç½®ã€‚ ç„¶åhexo n page topæ–°å»ºä¸€ä¸ªé¡µé¢æ–‡ç« é…ç½®å†™ä¸‹å¦‚ä¸‹å†…å®¹ï¼Œlimit è¡¨ç¤ºæ˜¾ç¤ºç¯‡æ•°ï¼š --- title: çƒ­åº¦ layout: top limit: 20 --- ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:9","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Memo"],"content":"å¤åˆ¶æŒ‰é’®æ ·å¼ æœ¬æ¥åªæƒ³ç®€å•ç¾åŒ–ä¸€ä¸‹å˜æˆ night æ ·å¼çš„ï¼Œåæ¥å†™å®Œå‘ç° 3dbtn ä¹ŸæŒºå–œæ¬¢çš„ã€‚ codeblock: ## Manual define the border radius in codeblock ## Leave it empty for the default 1 border_radius: 5 ## Add copy button on codeblock copy_button: enable: true ## Show text copy result show_result: true ## Style: 'light,night,flat,3dbtn' is currently available, leave it empty or light is default theme style: night ","date":"2019-03-21","objectID":"/posts/hexo-theme-next/:2:10","tags":["hexo"],"title":"hexo-theme-next @modified LRH","uri":"/posts/hexo-theme-next/"},{"categories":["Java"],"content":" æ‘˜è¦ï¼šJava åŸºæœ¬çš„å¯¹è±¡åˆå§‹åŒ–è¿‡ç¨‹ï¼Œå­ç±»çš„åˆå§‹åŒ–ï¼Œä»¥åŠæ¶‰åŠåˆ°çˆ¶ç±»å’Œå­ç±»çš„è½¬åŒ–æ—¶å¯èƒ½å¼•èµ·æ··ä¹±çš„æƒ…å†µã€‚ ","date":"2019-03-21","objectID":"/posts/substatus/:0:0","tags":["Java"],"title":"Java çˆ¶ç±»å­ç±»çš„å¯¹è±¡åˆå§‹åŒ–è¿‡ç¨‹","uri":"/posts/substatus/"},{"categories":["Java"],"content":"åŸºæœ¬åˆå§‹åŒ–è¿‡ç¨‹ å¯¹äºä¸€ä¸ªç®€å•ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹æ˜¯ï¼š static ä¿®é¥°çš„æ¨¡å—ï¼ˆstatic å˜é‡å’Œ static å—ï¼‰ =\u003e æŒ‰ç…§ä»£ç é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ â†“ å®ä¾‹å˜é‡ åŠé static æ¨¡å— =\u003e æŒ‰ç…§ä»£ç é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ â†“ æ„é€ å‡½æ•° =\u003e æ‰§è¡Œå¯¹åº”çš„æ„é€ å‡½æ•°ã€‚ ","date":"2019-03-21","objectID":"/posts/substatus/:1:0","tags":["Java"],"title":"Java çˆ¶ç±»å­ç±»çš„å¯¹è±¡åˆå§‹åŒ–è¿‡ç¨‹","uri":"/posts/substatus/"},{"categories":["Java"],"content":"å­ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ çˆ¶ç±» static ä¿®é¥°çš„æ¨¡å— â†“ å­ç±» static ä¿®é¥°æ¨¡å— â†“ çˆ¶ç±»å®ä¾‹å˜é‡å’Œé static å— â†“ çˆ¶ç±»å¯¹åº”æ„é€ å‡½æ•°ã€‚å½“å­ç±»å¯¹åº”æ„é€ å‡½æ•°ä¸­æ²¡æœ‰æ˜¾ç¤ºè°ƒç”¨æ—¶è°ƒç”¨çš„æ˜¯çˆ¶ç±»é»˜è®¤çš„æ„é€ å‡½æ•°ã€‚ â†“ å­ç±»å®ä¾‹å˜é‡å’Œé static å— â†“ å­ç±»æ„é€ å‡½æ•° package code0507; public class Demo { public static void main(String[] args) { Sub sub = new Sub(); System.out.println(sub); } } class Super { int a = 6; public Super() { test(); //è¢«å­ç±»åŒåå‡½æ•°è¦†ç›–ï¼Œä¼˜å…ˆè®¿é—®å­ç±» test } int b=9; public void test() { System.out.println(a); } } class Sub extends Super { int a = 8; public Sub() { test(); } public void test() { System.out.println(a); } } è¿è¡Œç»“æœ 0 8 ","date":"2019-03-21","objectID":"/posts/substatus/:2:0","tags":["Java"],"title":"Java çˆ¶ç±»å­ç±»çš„å¯¹è±¡åˆå§‹åŒ–è¿‡ç¨‹","uri":"/posts/substatus/"},{"categories":["OS"],"content":" åŒç³»ç»Ÿé»˜è®¤å¯åŠ¨é¡¹æ˜¯ Ubuntuï¼Œè€Œæ—¥å¸¸ä½¿ç”¨æœ€å¤šçš„è¿˜æ˜¯ Windowsï¼Œæ‰€ä»¥è¯´å¾ˆä¸æ–¹ä¾¿ï¼Œä¸€ä¸å°å¿ƒå°±å¼€æœºåˆ° Ubuntu å»äº†ã€‚ä»Šå¤©æ¥è®¾ç½®ä¸€ä¸‹ã€‚ ","date":"2019-03-21","objectID":"/posts/windefault/:0:0","tags":["linux","windows","ubuntu"],"title":"ubuntu + windows åŒç³»ç»Ÿé»˜è®¤å¯åŠ¨é¡¹è®¾ç½®","uri":"/posts/windefault/"},{"categories":["OS"],"content":"ä¿®æ”¹/etc/default/grubæ–‡ä»¶ åŒæ—¶æŒ‰ä½é”®ç›˜ä¸Šçš„â€œCtrl Alt Tâ€ä¸‰ä¸ªé”®ï¼ˆå³å¿«æ·é”®â€œCtrl+Alt+Tâ€ï¼‰ï¼Œæ‰“å¼€ç»ˆç«¯çª—å£ã€‚åœ¨ç»ˆç«¯å†…è¾“å…¥ sudo gedit /etc/default/grub æŒ‰ Enter é”®ç¡®è®¤ï¼Œæç¤ºè¾“å…¥ç”¨æˆ·å¯†ç ï¼Œè¾“å…¥çš„ç”¨æˆ·å¯†ç æ˜¯çœ‹ä¸è§çš„ï¼Œä¸è¦ç®¡å®ƒï¼Œè¾“å…¥å®Œæˆç¡®è®¤å³å¯æ‰“å¼€ grub æ–‡ä»¶ã€‚ æŠŠ grub æ–‡ä»¶ä¸­çš„ GRUB_DEFAULT=0 ä¸­çš„ 0 æ”¹ä¸º saved, æŠŠ GRUB_TIMEOUT=10 ä¸­çš„ 10 æ”¹ä¸º 5ã€‚ï¼ˆè¿™é‡Œçš„ 5 è¡¨ç¤ºå¼€æœºæ—¶ç­‰å¾…é€‰æ‹©æ“ä½œç³»ç»Ÿæ˜¯æ—¶é—´æ˜¯ 5 ç§’ï¼‰ åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ  GRUB_SAVEDEFAULT=trueåä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºã€‚ ","date":"2019-03-21","objectID":"/posts/windefault/:1:0","tags":["linux","windows","ubuntu"],"title":"ubuntu + windows åŒç³»ç»Ÿé»˜è®¤å¯åŠ¨é¡¹è®¾ç½®","uri":"/posts/windefault/"},{"categories":["OS"],"content":"æ›´æ–°å¯åŠ¨é…ç½®æ–‡ä»¶ åœ¨ç»ˆç«¯è¾“å…¥ sudo update-grub æŒ‰ Enter é”®ç¡®è®¤ ","date":"2019-03-21","objectID":"/posts/windefault/:2:0","tags":["linux","windows","ubuntu"],"title":"ubuntu + windows åŒç³»ç»Ÿé»˜è®¤å¯åŠ¨é¡¹è®¾ç½®","uri":"/posts/windefault/"},{"categories":["OS"],"content":"é‡å¯ sudo rebootæˆ–è€…ç‚¹å‡»é‡å¯ï¼Œé‡å¯åˆ°å¯åŠ¨èœå•æ—¶ï¼Œé€‰æ‹©ä½ è¦æ›´æ”¹ä¸ºé»˜è®¤å¯åŠ¨é¡¹çš„ç³»ç»Ÿï¼ŒæŒ‰ Enter é”®ç¡®è®¤å¯åŠ¨å³å¯ï¼Œä¸‹æ¬¡å¯åŠ¨æ—¶åˆšåˆšé€‰æ‹©çš„ç³»ç»Ÿå³ä¸ºé»˜è®¤å¯åŠ¨ç³»ç»Ÿï¼Œç›´åˆ°ä½ æ‰‹åŠ¨é€‰æ‹©å¯åŠ¨å…¶ä»–çš„ç³»ç»Ÿä¸ºæ­¢ã€‚ä»¥åå¯ä»¥è½»æ¾çš„æ¥å›åˆ‡æ¢é»˜è®¤ç³»ç»Ÿäº†ã€‚ ","date":"2019-03-21","objectID":"/posts/windefault/:3:0","tags":["linux","windows","ubuntu"],"title":"ubuntu + windows åŒç³»ç»Ÿé»˜è®¤å¯åŠ¨é¡¹è®¾ç½®","uri":"/posts/windefault/"},{"categories":["çæŠ˜è…¾","PHP"],"content":" å®…éŸ³ä¹æ’­æ”¾å™¨ï¼ŒHTML5 ç½‘é¡µæ’­æ”¾å™¨ï¼Œé›†æˆåå°ç®¡ç†åŠ API è°ƒç”¨ï¼Œç›®å‰æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·å…³æ³¨~ åŸé¡¹ç›® ç”± IT æŠ€æœ¯å®… å¼€æºï¼Œä½¿ç”¨ thinkPHP å¼€å‘åå°ã€‚ fork åœ°å€ æ˜¯æˆ‘ä¸ªäººå­¦ä¹ æ¨¡ä»¿çš„åº“ï¼Œä¹Ÿæ˜¯ç›¸å½“äºå¤‡ä»½æºç ã€‚ æ³¨ï¼š æ’ä»¶ä¿®æ”¹äºæ˜æœˆæµ©ç©ºå…è´¹ç‰ˆï¼Œä»…ç”¨äºå­¦ä¹ äº¤æµï¼Œæ— å•†ä¸šä»·å€¼ï¼Œå¦‚å‘ç°å•†ä¸šä¼ æ’­ï¼Œå°†ç¦æ­¢è½¯ä»¶çš„å…è´¹ä½¿ç”¨ã€‚ ","date":"2019-03-19","objectID":"/posts/player/:0:0","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"æŠ€æœ¯æ ˆ åç«¯ï¼šthinkphp 5.1 å‰ç«¯ï¼šlayui æ•°æ®åº“ï¼šmysql ","date":"2019-03-19","objectID":"/posts/player/:1:0","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"æ¼”ç¤ºç«™ å·²å…¼å®¹ç§»åŠ¨ç«¯ï¼Œæµ‹è¯•è´¦å·ä»…ä¾›æµ‹è¯•è¯·å‹¿ä¿®æ”¹å¯†ç ï¼ test test123 https://player.ilt.me/ https://player.lruihao.cn/ ","date":"2019-03-19","objectID":"/posts/player/:2:0","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"å®‰è£… ","date":"2019-03-19","objectID":"/posts/player/:3:0","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"è§†é¢‘å®‰è£…æ•™ç¨‹ https://www.bilibili.com/video/av46476706 ","date":"2019-03-19","objectID":"/posts/player/:3:1","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"ä¾èµ– composer php 5.6+ mysql 5.5+ ","date":"2019-03-19","objectID":"/posts/player/:3:2","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"æ­¥éª¤ å®‰è£… php ä¾èµ–åŒ… composer install é…ç½®æ•°æ®åº“ï¼Œé…ç½®é“¾æ¥æ•°æ®åº“åä»¥åŠç”¨æˆ·åå¯†ç  /config/database.php åˆ›å»ºæ•°æ®åº“ å­—ç¬¦ç¼–ç ï¼šutf8 -- UTF-8 Unicode å¯¼å…¥æ•°æ®åº“è„šæœ¬ï¼Œè„šæœ¬ä½ç½® extend/database ","date":"2019-03-19","objectID":"/posts/player/:3:3","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"ä¼ªé™æ€é…ç½® nginx location / { index index.htm index.html index.php; #è®¿é—®è·¯å¾„çš„æ–‡ä»¶ä¸å­˜åœ¨åˆ™é‡å†™ URL è½¬äº¤ç»™ ThinkPHP å¤„ç† if (!-e $request_filename) { rewrite ^/(.*)$ /index.php?s=$1 last; break; } } apache é¡¹ç›®è‡ªå¸¦ apache é™æ€åŒ–æ— éœ€é…ç½® ","date":"2019-03-19","objectID":"/posts/player/:3:4","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"å¯åŠ¨é¡¹ç›® æ·»åŠ  public ä¸º web æ ¹ç›®å½• è‹¥ä¸º apache æœåŠ¡å™¨åˆ™é»˜è®¤ä¼ªé™æ€ï¼Œnginx å¯è‡ªè¡Œé…ç½®ä¼ªé™æ€ ","date":"2019-03-19","objectID":"/posts/player/:3:5","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"é¢„è§ˆ ","date":"2019-03-19","objectID":"/posts/player/:4:0","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"é¦–é¡µ ","date":"2019-03-19","objectID":"/posts/player/:4:1","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"ç™»é™†é¡µé¢ ","date":"2019-03-19","objectID":"/posts/player/:4:2","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"åå°é¦–é¡µ ","date":"2019-03-19","objectID":"/posts/player/:4:3","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"åå°æ’­æ”¾å™¨ç®¡ç†é¡µé¢ ","date":"2019-03-19","objectID":"/posts/player/:4:4","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["çæŠ˜è…¾","PHP"],"content":"åå°æ­Œå•ç®¡ç†é¡µé¢ ","date":"2019-03-19","objectID":"/posts/player/:4:5","tags":["PHP","ThinkPHP","Layui","MySQL"],"title":"å®…éŸ³ä¹æ’­æ”¾å™¨","uri":"/posts/player/"},{"categories":["OS"],"content":"æé€Ÿæ–¹ä¾¿çš„ä¸€é”®é…ç½®ä¸ç®¡ç†ï¼Œå…é™¤ç¹ççš„å‘½ä»¤è¡Œæ“ä½œï¼Œé€šè¿‡ Web é¢æ¿ä¸€é”®å³å¯æ“ä½œå®ç°ã€‚å¯é€‰æ‹©å®‰è£… lamp æˆ–è€… lnmp ç¯å¢ƒï¼Œå¯åˆ›å»ºåŠç®¡ç†ç½‘ç«™ï¼Œå¯åˆ›å»ºåŠç®¡ç†æ•°æ®åº“ï¼Œå¯åˆ›å»ºåŠç®¡ç† FTP ç­‰ç­‰ã€‚å®å¡”å®˜ç½‘ä»‹ç» ","date":"2019-03-18","objectID":"/posts/bt/:0:0","tags":["linux","server","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£…","uri":"/posts/bt/"},{"categories":["OS"],"content":"ç³»ç»Ÿè¦æ±‚ æ“ä½œç³»ç»Ÿï¼šå…¨æ–°ç³»ç»Ÿï¼ˆæ”¯æŒ CentOSã€Ubuntuã€Debianã€Fedoraã€Deepin)ï¼Œ ç¡®ä¿æ˜¯å¹²å‡€çš„æ“ä½œç³»ç»Ÿï¼Œæ²¡æœ‰å®‰è£…è¿‡å…¶å®ƒç¯å¢ƒå¸¦çš„ Apache/Nginx/php/MySQL å®å¡” Linux6.0 ç‰ˆæœ¬æ˜¯åŸºäº centos7 å¼€å‘çš„ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ centos7.x ç³»ç»Ÿ å†…å­˜è¦æ±‚ï¼šå†…å­˜è¦æ±‚æœ€ä½ 512MBï¼Œæ¨è 768MB ä»¥ä¸Šï¼Œçº¯é¢æ¿çº¦å ç³»ç»Ÿ 60MB å†…å­˜. ","date":"2019-03-18","objectID":"/posts/bt/:1:0","tags":["linux","server","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£…","uri":"/posts/bt/"},{"categories":["OS"],"content":"å®‰è£…æ–¹æ³• å®˜æ–¹å·ç§° 2 åˆ†é’Ÿè£…å¥½é¢æ¿ï¼Œä¸€é”®ç®¡ç†æœåŠ¡å™¨ã€‚ ä½¿ç”¨ SSH è¿æ¥å·¥å…·ï¼Œå¦‚å®å¡”è¿œç¨‹æ¡Œé¢åŠ©æ‰‹è¿æ¥åˆ°æ‚¨çš„ Linux æœåŠ¡å™¨åï¼ŒæŒ‚è½½ç£ç›˜ï¼Œæ ¹æ®ç³»ç»Ÿæ‰§è¡Œç›¸åº”å‘½ä»¤å¼€å§‹å®‰è£…ï¼ˆå¤§çº¦ 2 åˆ†é’Ÿå®Œæˆé¢æ¿å®‰è£…ï¼‰ï¼š yum install -y wget \u0026\u0026 wget -O install.sh http://download.bt.cn/install/install_6.0.sh \u0026\u0026 sh install.sh wget -O install.sh http://download.bt.cn/install/install-ubuntu_6.0.sh \u0026\u0026 sudo bash install.sh wget -O install.sh http://download.bt.cn/install/install-ubuntu_6.0.sh \u0026\u0026 bash install.sh wget -O install.sh http://download.bt.cn/install/install_6.0.sh \u0026\u0026 bash install.sh ","date":"2019-03-18","objectID":"/posts/bt/:2:0","tags":["linux","server","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£…","uri":"/posts/bt/"},{"categories":["OS"],"content":"æ­å»º ftp å’Œäº‘ç›˜æœåŠ¡å™¨ å¯ä»¥å¾ˆå‚»ç“œå¼çš„æ­å»ºè‡ªå·±çš„äº‘ç›˜ï¼Œå’Œå¹³æ—¶ç”¨çš„æ¯”è¾ƒå¤šçš„ ftp æœåŠ¡å™¨ã€‚æ­å»ºé™æ€ç½‘ç«™ä¹Ÿå¯ä»¥ç”¨ ftp æ¥ä¸Šä¼ æ–‡ä»¶ã€‚ ","date":"2019-03-18","objectID":"/posts/bt/:3:0","tags":["linux","server","å®å¡”é¢æ¿"],"title":"å®å¡”é¢æ¿å®‰è£…","uri":"/posts/bt/"},{"categories":["Memo"],"content":" ä¸‹é¢ä¸€äº› web å¼€å‘çš„ä¸€äº›æ€»ç»“ï¼Œè¿˜æœ‰ä¸€äº›å¸¸ç”¨åˆ°çš„ä»£ç ï¼Œè„šæœ¬ç­‰ï¼ ","date":"2019-03-18","objectID":"/posts/webbiji/:0:0","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"front-end ","date":"2019-03-18","objectID":"/posts/webbiji/:1:0","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"html HTML+CSS oblique å’Œ intalic çš„åŒºåˆ« è¿™ä¸¤ä¸ªéƒ½æ˜¯font-styleå±æ€§çš„å€¼ï¼Œè¿™ä¸¤ä¸ªå€¼éƒ½èƒ½å®ç°å€¾æ–œçš„æ•ˆæœï¼Œä½†æ˜¯æœ‰åŒºåˆ«çš„ã€‚ intalic: è¿™ä¸ªæ˜¯å­—ä½“çš„å€¾æ–œï¼Œç›¸å½“äºæ–œä½“ï¼Œå­—ä½“å¿…é¡»æœ‰å€¾æ–œå±æ€§ã€‚ oblique: è¿™ä¸ªå‡†ç¡®åœ°è¯´æ˜¯è®©æ–‡å­—å€¾æ–œã€‚ç›¸å½“äºæ–œå­—ï¼Œå­—ä½“ä¸ä¸€å®šè¦æœ‰å€¾æ–œå±æ€§ã€‚ title æ˜¾ç¤ºæ¢è¡Œ ä½¿ç”¨\u0026#10;æˆ–ä½¿ç”¨\u0026#13; \u003ca href=\"#\" title=\"ç¬¬ä¸€è¡Œ\u0026#10; ç¬¬äºŒè¡Œ\u0026#10; ç¬¬ä¸‰è¡Œ\"\u003eä½¿ç”¨`\u0026#10;`\u003c/a\u003e \u003ca href=\"#\" title=\"ç¬¬ä¸€æ’\u0026#13; ç¬¬äºŒæ’\u0026#13; ç¬¬ä¸‰æ’\"\u003eä½¿ç”¨`\u0026#13;`\u003c/a\u003e å›¾ç‰‡ç±»å‹é€‰æ‹© å›¾ç‰‡ç±»å‹é€‰æ‹© ","date":"2019-03-18","objectID":"/posts/webbiji/:1:1","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"css flexbox Flex å¸ƒå±€å°†æˆä¸ºæœªæ¥å¸ƒå±€çš„é¦–é€‰æ–¹æ¡ˆï¼Œæ¯”å¦‚è¯´å¸¸è§çš„ bootstrap4 çš„ç‰ˆæœ¬å°±ç”¨ flex æ›¿ä»£äº† float æ¥è¿›è¡Œæ’ç‰ˆã€‚ æˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°å‡ ä¸ªå¾ˆå¥½çš„æ•™ç¨‹ï¼Œå›¾æ–‡å¹¶èŒ‚ï¼Œä¸€ç›®äº†ç„¶ã€‚ A Complete Guide to Flexbox Flex å¸ƒå±€æ•™ç¨‹ï¼šè¯­æ³•ç¯‡ å®åœ¨æ‡’ç™Œå‘ä½œï¼Œç¬”è®°æœ¬ä¸Šæ‰‹æŠ„äº†ç¬”è®°æˆ‘å°±ä¸å†™å­¦ä¹ æ€»ç»“äº†ï¼Œè¿˜æœ‰ç½‘å‹ Demo ä¹Ÿå†™äº†ã€‚ ","date":"2019-03-18","objectID":"/posts/webbiji/:1:2","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"javascript keydown å’Œ keypress keydownï¼šæŒ‰ä¸‹é”®ç›˜é”® keypressï¼šç´§æ¥ç€keydownäº‹ä»¶è§¦å‘ï¼ˆåªæœ‰æŒ‰ä¸‹å­—ç¬¦é”®æ—¶è§¦å‘ï¼‰ å¦‚æœç”¨æˆ·æŒ‰ä¸‹äº†ä¸€ä¸ªå­—ç¬¦é”®ä¸æ”¾ï¼Œå°±ä¼šé‡å¤è§¦å‘keydownå’Œkeypressäº‹ä»¶ï¼Œç›´åˆ°ç”¨æˆ·æ¾å¼€è¯¥é”®ä¸ºæ­¢ã€‚ å¦‚æœç”¨æˆ·æŒ‰ä¸‹äº†ä¸€ä¸ªéå­—ç¬¦é”®ä¸æ”¾ï¼Œå°±ä¼šé‡å¤è§¦å‘keydownäº‹ä»¶ï¼Œç›´åˆ°ç”¨æˆ·æ¾å¼€è¯¥é”®ä¸ºæ­¢ã€‚ è¯¦è§£é”®ç›˜äº‹ä»¶ (keydownï¼Œkeypressï¼Œkeyup) textContentã€innerText å’Œ innerHTML çš„åŒºåˆ« è®¾ç½®æ ‡ç­¾ä¸­çš„æ–‡æœ¬å†…å®¹ï¼Œåº”è¯¥ä½¿ç”¨textContentæˆ–innerTextï¼ˆæ›´è€ï¼‰å±æ€§ï¼ŒåŒºåˆ«åœ¨äºæµè§ˆå™¨æ”¯æ´ç¨‹åº¦ innerHTMLèƒ½å¤Ÿè·å¾—å…ƒç´ å†…çš„æ‰€æœ‰æ ‡ç­¾å†…å®¹ï¼Œä¹Ÿå¯ä»¥è®¾ç½®æ ‡ç­¾ä½¿ä¹‹ç”Ÿæ•ˆã€‚ï¼ˆæ³¨æ„é˜²æ­¢ XSS æ³¨å…¥ï¼‰ å¦‚æœæŸä¸ªå±æ€§åœ¨æµè§ˆå™¨ä¸­ä¸æ”¯æŒï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§çš„ç±»å‹æ˜¯undefinedï¼Œåˆ¤æ–­è¿™ä¸ªå±æ€§çš„ç±»å‹æ˜¯ä¸æ˜¯undefinedï¼Œå°±çŸ¥é“æµè§ˆå™¨æ˜¯å¦æ”¯æŒã€‚ \u003cscript\u003e // è®¾ç½®ä»»æ„çš„æ ‡ç­¾ä¸­é—´çš„ä»»æ„æ–‡æœ¬å†…å®¹ function setInnerText(element, text) { //åˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒè¿™ä¸ªå±æ€§ if (typeof element.textContent == \"undefined\") {//ä¸æ”¯æŒ element.innerText = text; } else {//æ”¯æŒè¿™ä¸ªå±æ€§ element.textContent = text; } }; \u003c/script\u003e ","date":"2019-03-18","objectID":"/posts/webbiji/:1:3","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"å›¾åºŠæ–¹æ¡ˆ è‡ªè¡Œæ­å»º æ¯”å¦‚ä½¿ç”¨å¼€æºå›¾åºŠ ImgURL æ­å»ºçš„img.lruihao.cnï¼ˆéœ€è¦æœåŠ¡å™¨ï¼‰ ä½¿ç”¨ä¸Šä¼ å·¥å…·åŠ ç¬¬ä¸‰æ–¹å…è´¹ç©ºé—´ï¼Œæ¯”å¦‚PicGo + è…¾è®¯äº‘ COSï¼ˆæ— éœ€æœåŠ¡å™¨ï¼‰ ä½¿ç”¨å„å¤§å›¾åºŠ è¯¸å¦‚ sm.msï¼Œè…¾è®¯äº‘ COSï¼Œé˜¿é‡Œäº‘ OSSï¼Œä¸ƒç‰›äº‘ï¼Œåˆæ‹äº‘ï¼ŒGithubï¼Œå¾®åšå›¾åºŠï¼ŒImgURL å›¾åºŠç­‰ç­‰ ","date":"2019-03-18","objectID":"/posts/webbiji/:1:4","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"font-awesome ç°åœ¨ä½¿ç”¨ 5 çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨webfont+cssæˆ–svg+js \u003clink rel=\"stylesheet\" href=\"https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css\"\u003e å…¶ä»–çš„å›¾æ ‡ js \u003cscript src=\"//at.alicdn.com/t/font_578712_g26jo2kbzd5qm2t9.js\"\u003e\u003c/script\u003e \u003csvg class=\"card-avatar\" aria-hidden=\"true\"\u003e \u003cuse xlink:href=\"#icon-{{n+1}}\"\u003e\u003c/use\u003e \u003c!--n ä¸ºä¸€ä¸ªæ•°å­—--\u003e \u003c/svg\u003e ","date":"2019-03-18","objectID":"/posts/webbiji/:1:5","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"å“åº”å¼ï¼ˆè‡ªé€‚åº”ï¼‰ \u003clink rel=\"stylesheet\" href=\"https://apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css\"\u003e \u003cscript src=\"https://apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=0\"\u003e .col-xs- è¶…å°å±å¹• æ‰‹æœº \u003c768px .col-sm- å°å±å¹• å¹³æ¿ \u003e=768px .col-md- ä¸­ç­‰å±å¹• \u003e=992px .col-lg- å¤§å±å¹• \u003e1200px css3 å†™æ³• @media ï¼ˆå®½åº¦å…·ä½“è°ƒæ•´ï¼‰ /* æ‰‹æœºç­‰å°å±å¹•æ‰‹æŒè®¾å¤‡ */ @media screen and (min-width: 320px) and (max-width: 480px) { /*æ‰‹æœºç«¯ css æ ·å¼è¡¨*/ } /* å¹³æ¿ä¹‹ç±»çš„å®½åº¦ 1024 ä»¥ä¸‹è®¾å¤‡ */ @media only screen and (min-width: 321px) and (max-width: 1024px) { /*ç”µè„‘ç«¯ css æ ·å¼è¡¨*/ } link å¼•å…¥ä¸åŒ css \u003c!--æ‰‹æœºç«¯--\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"style_phone.css\" media=\"screen and (max-width: 960px)\"/\u003e \u003c!--ç”µè„‘ç«¯--\u003e \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"style_PC.css\" media=\"screen and (min-width: 960px)\"/\u003e ","date":"2019-03-18","objectID":"/posts/webbiji/:1:6","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"jquery \u003cscript src=\"https://code.jquery.com/jquery-3.3.1.min.js\"\u003e\u003c/script\u003e \u003cscript src=\"https://lib.sinaapp.com/js/jquery/2.0.2/jquery-2.0.2.min.js\"\u003e\u003c/script\u003e \u003cscript src=\"https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js\"\u003e\u003c/script\u003e \u003cscript src=\"http://cdn.bootcss.com/jquery/1.11.0/jquery.min.js\"\u003e\u003c/script\u003e //è¿˜æœ‰å…¶ä»–çš„æº ... ","date":"2019-03-18","objectID":"/posts/webbiji/:1:7","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"QQ æ¨å¹¿é“¾æ¥ QQ æ¨å¹¿ QQ ç¾¤ \u003ca target=\"_blank\" href=\"https://wpa.qq.com/msgrd?v=3\u0026uin=1074627678\u0026site=qq\u0026menu=yes\"\u003e\u003cimg border=\"0\" src=\"http://wpa.qq.com/pa?p=2:1074627678:51\" alt=\"ç‚¹å‡»è¿™é‡Œç»™æˆ‘å‘æ¶ˆæ¯\" title=\"ç‚¹å‡»è¿™é‡Œç»™æˆ‘å‘æ¶ˆæ¯\"/\u003e\u003c/a\u003e ","date":"2019-03-18","objectID":"/posts/webbiji/:1:8","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"Google fonts https://fonts.google.com/ ä¸€èˆ¬é€‰ç”¨å›½å†…æºé•œåƒæ›¿ä»£ï¼ˆå¾…è¡¥å…… ...ï¼‰ + https://fonts.loli.net + //fonts.lug.ustc.edu.cn ","date":"2019-03-18","objectID":"/posts/webbiji/:1:9","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"fancybox github ä»‹ç»â€ƒfancybox æº \u003clink href=\"https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css\" rel=\"stylesheet\"\u003e \u003cscript src=\"https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js\"\u003e\u003c/script\u003e ","date":"2019-03-18","objectID":"/posts/webbiji/:1:10","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Memo"],"content":"back-end æ›´å¤šå­¦ä¹ å†…å®¹è§ å­¦ä¹ è¯¾ä»¶ ç»ƒä¹ ä½œä¸š æºç +Demo ","date":"2019-03-18","objectID":"/posts/webbiji/:2:0","tags":["JavaScript"],"title":"web æ±‡æ€»","uri":"/posts/webbiji/"},{"categories":["Java"],"content":" æ³›å‹æ–¹æ³•ï¼Œå®ƒåœ¨ä¿®é¥°ç¬¦åï¼Œè¿”å›å€¼ç±»å‹å‰å¢åŠ äº†ç±»å‹å‚æ•° (\u003c\u003e) ç±»å‹é€šé…ç¬¦ä¸€èˆ¬ä½¿ç”¨é—®å·?ä»£æ›¿å…·ä½“çš„ç±»å‹å®å‚ï¼Œæ³¨æ„ä¸æ˜¯ç±»å‹å½¢å‚ã€‚ ","date":"2019-03-16","objectID":"/posts/fanxing/:0:0","tags":["æ³›å‹","Java"],"title":"java æ³›å‹ test","uri":"/posts/fanxing/"},{"categories":["Java"],"content":"ä»£ç  package code0507; public class WildCardTest { public static void main(String[] args) { Box\u003cString\u003ename=new Box\u003cString\u003e(\"hello\"); Box\u003cInteger\u003eage=new Box\u003cInteger\u003e(12); Box\u003cDouble\u003enumber=new Box\u003cDouble\u003e(210.50); Box\u003cInteger\u003epoint=new Box\u003cInteger\u003e(); getData(name); getData(age); getData(number); point.printpoint(520, 1314); point.printpoint(\"me\", \"too\"); } public static void getData(Box\u003c?\u003edata){//ç±»å‹é€šé…ç¬¦ System.out.println(\"data:\"+data.getData()); } } class Box\u003cT\u003e{ private T data; public Box() {}//æ„é€ æ–¹æ³•é‡è½½ public Box(T data) { setData(data); } public T getData() { return data; } public void setData(T data) { this.data = data; } //å®šä¹‰æ³›å‹æ–¹æ³• public\u003cT1,T2\u003evoid printpoint(T1 x,T2 y){ T1 m=x; T2 n=y; System.out.println(\"This point is:\"+m+\",\"+n); } } ","date":"2019-03-16","objectID":"/posts/fanxing/:1:0","tags":["æ³›å‹","Java"],"title":"java æ³›å‹ test","uri":"/posts/fanxing/"},{"categories":["Java"],"content":"è¿è¡Œç»“æœ data:hello data:12 data:210.5 This point is:520,1314 This point is:me,too ","date":"2019-03-16","objectID":"/posts/fanxing/:2:0","tags":["æ³›å‹","Java"],"title":"java æ³›å‹ test","uri":"/posts/fanxing/"},{"categories":["Memo"],"content":"åŸºæœ¬ä½¿ç”¨ A: é€‰æ‹©ä¸€ä¸ªå·¥ä½œç©ºé—´ D:\\develop\\eclipse-SDK-3.7.2-win64\\workspace B: å¦‚ä½•å†™ä¸€ä¸ª HelloWorld æ¡ˆä¾‹ï¼ˆä»£ç ä»¥é¡¹ç›®ä¸ºåŸºæœ¬å•ä½ï¼‰ a: åˆ›å»ºé¡¹ç›®ï¼ˆå·¥ç¨‹ï¼‰ *File -- New -- Java Project *åœ¨å·¦è¾¹ç©ºç™½å¤„ï¼Œç›´æ¥å³é”® -- New -- Java Project é”®å…¥é¡¹ç›®åç§°åç›´æ¥ Finishã€‚ b: æ‰€æœ‰çš„ java æ–‡ä»¶å¿…é¡»å†™åˆ° src ä¸‹é¢æ‰æœ‰æ•ˆ c: åˆ›å»ºä¸€ä¸ªåŒ… cn.lruihao d: åœ¨åŒ…ä¸‹åˆ›å»ºä¸€ä¸ªç±» HelloWorld åŒæ—¶è®©å®ƒå¸®æˆ‘ä»¬å†™å¥½äº† main æ–¹æ³•ã€‚ e: åœ¨ main æ–¹æ³•ä¸­å†™å†…å®¹å³å¯ f: ç¼–è¯‘ç¨‹åº è‡ªåŠ¨ç¼–è¯‘ï¼Œåœ¨ä¿å­˜çš„é‚£ä¸€åˆ»å¸®ä½ åšå¥½äº† g: è¿è¡Œç¨‹åº é€‰æ‹©è¦è¿è¡Œçš„æ–‡ä»¶æˆ–è€…åœ¨è¦è¿è¡Œçš„æ–‡ä»¶å†…å®¹ä¸­ å³é”® -- Run as - Java Application å³å¯ h: å†…å®¹æ˜¾ç¤º åœ¨ Console æ§åˆ¶å°æ˜¾ç¤ºå†…å®¹ ","date":"2019-03-15","objectID":"/posts/eclipseuse/:1:0","tags":["eclipse","Java"],"title":"eclipse çš„åŸºæœ¬ä½¿ç”¨","uri":"/posts/eclipseuse/"},{"categories":["Memo"],"content":"Eclipse çš„åŸºæœ¬è®¾ç½® A: ç¨‹åºçš„ç¼–è¯‘å’Œè¿è¡Œçš„ç¯å¢ƒé…ç½®ï¼ˆå¦‚æœä½ çš„ Eclipse å¯åŠ¨æ²¡æœ‰é—®é¢˜ï¼Œå°±ä¸è¦é…ç½®äº†ï¼‰ B: å»æ‰é»˜è®¤æ³¨é‡Šï¼ˆå¯ä»¥ä¸ç”¨æ”¹ï¼‰ C: è¡Œå·çš„æ˜¾ç¤ºå’Œéšè— æ˜¾ç¤ºï¼šåœ¨ä»£ç åŒºåŸŸçš„æœ€å·¦è¾¹çš„ç©ºç™½åŒºåŸŸï¼Œå³é”® -- Show Line Numbers å³å¯ã€‚ éšè—ï¼šæŠŠä¸Šé¢çš„åŠ¨ä½œå†åšä¸€æ¬¡ã€‚ D: å­—ä½“å¤§å°åŠé¢œè‰² a:Java ä»£ç åŒºåŸŸçš„å­—ä½“å¤§å°å’Œé¢œè‰²ï¼š window -- Preferences -- General -- Appearance -- Colors And Fonts -- Java ä¿®æ”¹ -- Java Edit Text Font b: æ§åˆ¶å° window -- Preferences -- General -- Appearance -- Colors And Fonts -- Debug -- Console font c: å…¶ä»–æ–‡ä»¶ window -- Preferences -- General -- Appearance -- Colors And Fonts -- Basic -- Text Font E: çª—ä½“ç»™å¼„ä¹±äº†ï¼Œæ€ä¹ˆåŠ window -- Reset Perspective F: æ§åˆ¶å°æ‰¾ä¸åˆ°äº† Window--Show Viewâ€”Console ","date":"2019-03-15","objectID":"/posts/eclipseuse/:2:0","tags":["eclipse","Java"],"title":"eclipse çš„åŸºæœ¬ä½¿ç”¨","uri":"/posts/eclipseuse/"},{"categories":["Memo"],"content":"å¿«æ·é”®çš„ä½¿ç”¨ A: å†…å®¹è¾…åŠ©é”® Alt+/ èµ·æç¤ºä½œç”¨ main+alt+/,syso+alt+/, ç»™å‡ºå…¶ä»–æç¤º B: å¿«æ·é”® æ ¼å¼åŒ– ctrl+shift+f å¯¼å…¥åŒ… ctrl+shift+o æ³¨é‡Š ctrl+/ ctrl+shift+/,ctrl+shift+\\ ä»£ç ä¸Šä¸‹ç§»åŠ¨ é€‰ä¸­ä»£ç  alt+ä¸Š/ä¸‹ç®­å¤´ æŸ¥çœ‹æºç  é€‰ä¸­ç±»å (F3 æˆ–è€… Ctrl+é¼ æ ‡ç‚¹å‡»ï¼‰ ","date":"2019-03-15","objectID":"/posts/eclipseuse/:3:0","tags":["eclipse","Java"],"title":"eclipse çš„åŸºæœ¬ä½¿ç”¨","uri":"/posts/eclipseuse/"},{"categories":["Memo"],"content":"Eclipse ä¸­å¦‚ä½•æé«˜å¼€å‘æ•ˆç‡ A: è‡ªåŠ¨ç”Ÿæˆæ„é€ æ–¹æ³• a: æ— å‚æ„é€ æ–¹æ³• åœ¨ä»£ç åŒºåŸŸå³é”®--source--Generate Constructors from Superclass b: å¸¦å‚æ„é€ æ–¹æ³• åœ¨ä»£ç åŒºåŸŸå³é”®--source--Generate Constructors using fields.. -- finish B: è‡ªåŠ¨ç”Ÿæˆ get/set æ–¹æ³• åœ¨ä»£ç åŒºåŸŸå³é”®--source--Generate Getters and Setters... ","date":"2019-03-15","objectID":"/posts/eclipseuse/:4:0","tags":["eclipse","Java"],"title":"eclipse çš„åŸºæœ¬ä½¿ç”¨","uri":"/posts/eclipseuse/"},{"categories":["Java"],"content":" java ä¸­åŒ¿åç±»ç”¨çš„æœ€å¤šçš„åœ°æ–¹å°±æ˜¯å¯è§†åŒ–ç•Œé¢è®¾è®¡ä¸­ï¼Œç‰¹åˆ«æ˜¯å°†äº‹ä»¶ç›‘å¬å™¨æ³¨å†Œåˆ°æŸä¸ªç»„ä»¶ä¸Šçš„æ—¶å€™ã€‚ ","date":"2019-03-15","objectID":"/posts/qframe/:0:0","tags":["GUI","Java"],"title":"åŒ¿åç±»åœ¨å¯è§†åŒ–ç•Œé¢ä¸­çš„åº”ç”¨","uri":"/posts/qframe/"},{"categories":["Java"],"content":"ä»£ç  package cn.lruihao; import java.awt.event.*; import javax.swing.*; public class QFrame extends JFrame { public QFrame() { JButton jbtnew=new JButton(\"New\");//æ–°å»ºæŒ‰é’® JPanel panel=new JPanel();//é¢æ¿å®¹å™¨ panel.add(jbtnew);//æ·»åŠ ç»„ä»¶ add(panel); jbtnew.addActionListener(new ActionListener() { //æ–°å»ºä¸€åŒ¿åç±»ï¼Œå¹¶å°†è¯¥å¯¹åº”çš„äº‹ä»¶ç›‘å¬å™¨æ³¨å†Œåˆ°â€œæ–°å»ºâ€æŒ‰é’® å°± jbtnew ä¸Š @Override public void actionPerformed(ActionEvent e) { JOptionPane.showMessageDialog(null, \"å•å‡»äº†æ–°å»ºæŒ‰é’®\"); System.out.println(\"lruihao.cn\"); } }); } public static void main(String[] args) { JFrame frame=new QFrame(); frame.setTitle(\"QFrame\"); frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); frame.setLocationRelativeTo(null); frame.pack(); frame.setVisible(true); } } åˆ›å»ºä¸€ä¸ªå¯è§†åŒ–ç•Œé¢ï¼Œç•Œé¢ä¸­æœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œå•å‡»æŒ‰é’®æ˜¾ç¤ºâ€œå•å‡»äº†æ–°å»ºæŒ‰é’®â€ã€‚ ","date":"2019-03-15","objectID":"/posts/qframe/:1:0","tags":["GUI","Java"],"title":"åŒ¿åç±»åœ¨å¯è§†åŒ–ç•Œé¢ä¸­çš„åº”ç”¨","uri":"/posts/qframe/"},{"categories":["Java"],"content":"ç»“æœ ","date":"2019-03-15","objectID":"/posts/qframe/:2:0","tags":["GUI","Java"],"title":"åŒ¿åç±»åœ¨å¯è§†åŒ–ç•Œé¢ä¸­çš„åº”ç”¨","uri":"/posts/qframe/"},{"categories":["Java"],"content":"å‚è€ƒ JOptionPane çš„ä½¿ç”¨ ","date":"2019-03-15","objectID":"/posts/qframe/:3:0","tags":["GUI","Java"],"title":"åŒ¿åç±»åœ¨å¯è§†åŒ–ç•Œé¢ä¸­çš„åº”ç”¨","uri":"/posts/qframe/"},{"categories":["JavaScript"],"content":" æ¨¡ä»¿çŸ¥ä¹çš„å¡ç‰‡å¼é“¾æ¥ï¼Œidea æ¥è‡ª [å…°å·å°çº¢é¸¡] ","date":"2019-03-15","objectID":"/posts/linkcard/:0:0","tags":["JavaScript","hexo"],"title":"æ¨¡ä»¿çŸ¥ä¹å¡ç‰‡å¼é“¾æ¥","uri":"/posts/linkcard/"},{"categories":["JavaScript"],"content":"æºç  2021/10/2 1:29 æ›´æ–° è¿™æ˜¯ä¸€ç§ååŠ è½½ï¼Œåˆ›å»ºlinkcard.jsæ”¾åˆ°source/js/src/ï¼Œç„¶ååœ¨next\\layout\\_macro\\post.swigä¸­å¼•ç”¨ function cardLink() { let $cardLinks = document.querySelectorAll('.card-link'); if ($cardLinks.length === 0) { return; } //æ’å…¥æ ·å¼ let $linkStyle = document.createElement('style'); $linkStyle.innerHTML = '.card-link,.card-link:hover{text-decoration:none;border:none!important;color:inherit!important}.card-link{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;color:inherit;text-decoration:none}.ztext{word-break:break-word;line-height:1.6}.card-link-backdrop{position:absolute;top:0;left:0;right:0;bottom:0;background-image:url(/images/card-link-bg.jpg);background-repeat:no-repeat;-webkit-filter:blur(20px);filter:blur(20px);background-size:cover;background-position:center}.card-link,.card-link:hover{text-decoration:none;border:none!important;color:inherit!important}.card-link-content{position:relative;display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:inherit;background-color:rgba(246,246,246,0.88)}.card-link-text{overflow:hidden}.card-link-title{display:-webkit-box;-webkit-line-clamp:2;overflow:hidden;text-overflow:ellipsis;max-height:calc(16px * 1.25 * 2);font-size:16px;font-weight:500;line-height:1.25;color:#1a1a1a}.card-link-meta{display:flex;margin-top:4px;font-size:14px;line-height:20px;color:#999;white-space:nowrap}.card-link-url{display: inline-flex;align-items: center;}.card-link-imageCell{margin-left:8px;border-radius:6px}.card-link-image{display:block;width:60px;height:60px;border-radius:inherit}'; document.querySelector('body').appendChild($linkStyle); //æ¸²æŸ“ DOM for (let $cardLink of $cardLinks) { $cardLink.innerHTML = `\u003cspan class='card-link-backdrop'\u003e\u003c/span\u003e\u003cspan class='card-link-content'\u003e\u003cspan class='card-link-text'\u003e\u003cspan class='card-link-title'\u003e${$cardLink.innerText}\u003c/span\u003e\u003cspan class='card-link-meta'\u003e\u003cspan class='card-link-url'\u003e\u003csvg class='Zi Zi--InsertLink' fill='currentColor' viewBox='0 0 24 24' width='17' height='17'\u003e\u003cpath d='M6.77 17.23c-.905-.904-.94-2.333-.08-3.193l3.059-3.06-1.192-1.19-3.059 3.058c-1.489 1.489-1.427 3.954.138 5.519s4.03 1.627 5.519.138l3.059-3.059-1.192-1.192-3.059 3.06c-.86.86-2.289.824-3.193-.08zm3.016-8.673l1.192 1.192 3.059-3.06c.86-.86 2.289-.824 3.193.08.905.905.94 2.334.08 3.194l-3.059 3.06 1.192 1.19 3.059-3.058c1.489-1.489 1.427-3.954-.138-5.519s-4.03-1.627-5.519-.138L9.786 8.557zm-1.023 6.68c.33.33.863.343 1.177.029l5.34-5.34c.314-.314.3-.846-.03-1.176-.33-.33-.862-.344-1.176-.03l-5.34 5.34c-.314.314-.3.846.03 1.177z' fill-rule='evenodd'\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/span\u003e${$cardLink.href}\u003c/span\u003e\u003c/span\u003e\u003cspan class='card-link-imageCell'\u003e\u003cimg class='card-link-image' alt='card-link icon' src='/images/linkicon.png'\u003e\u003c/span\u003e\u003c/span\u003e`; } } window.onload = () =\u003e { cardLink(); }; ","date":"2019-03-15","objectID":"/posts/linkcard/:1:0","tags":["JavaScript","hexo"],"title":"æ¨¡ä»¿çŸ¥ä¹å¡ç‰‡å¼é“¾æ¥","uri":"/posts/linkcard/"},{"categories":["JavaScript"],"content":"ä½¿ç”¨ \u003c!--çŸ¥ä¹å¡ç‰‡é“¾æ¥--\u003e \u003cscript type=\"text/javascript\" src=\"/js/src/card-link.js\"\u003e\u003c/script\u003e html é“¾æ¥å†™æ³•ï¼Œa æ ‡ç­¾åŠ ä¸Šclass=\"card-link\" \u003ca href=\"https://github.com/Lruihao/lruihao.github.io\" target=\"_blank\" class=\"card-link\"\u003eLruihao åšå®¢\u003c/a\u003e Lruihao åšå®¢ https://github.com/Lruihao/lruihao.github.io ","date":"2019-03-15","objectID":"/posts/linkcard/:2:0","tags":["JavaScript","hexo"],"title":"æ¨¡ä»¿çŸ¥ä¹å¡ç‰‡å¼é“¾æ¥","uri":"/posts/linkcard/"},{"categories":["OS"],"content":" æˆ‘çš„ Ubuntu å’Œ Windows åŒç³»ç»Ÿæ˜¯ Ubuntu æ˜¯ç¬¬ä¸€å¯åŠ¨é¡¹ï¼Œæ‰€ä»¥æ€»æ˜¯å¼€æœºå¿˜è®°ç‚¹ä¸‹é”®ï¼Œä¸€è¿› Ubuntu ç³»ç»Ÿæ—¶é—´å°±ä¸å¯¹äº†ï¼ˆæ€»æ˜¯å°‘äº† 8 å°æ—¶ï¼‰ï¼Œå›åˆ° Windows æ—¶é—´ä¹Ÿæ˜¯é”™çš„ã€‚çŸ¥é“æ˜¯é”™çš„è°ƒæ•´ä¸€ä¸‹è¿˜å¥½ã€‚å¿˜è®°è°ƒäº†æœ‰æ—¶å€™çœŸçš„ä¼šè¯¯äº‹ã€‚æ¯”å¦‚è¯´ git ç‰ˆæœ¬æ§åˆ¶æäº¤ä¼šé‡åˆ°é—®é¢˜ç§ç§ç­‰ã€‚ ","date":"2019-03-15","objectID":"/posts/ubuntutime/:0:0","tags":["ubuntu","linux","windows"],"title":"win10,ubuntu åŒç³»ç»Ÿæ—¶é—´ä¸ä¸€è‡´","uri":"/posts/ubuntutime/"},{"categories":["OS"],"content":"åŸå›  åœ¨å®‰è£… Ubuntu å’Œ Windows åŒç³»ç»Ÿçš„æƒ…å†µä¸‹ï¼ŒUbuntu çš„æ—¶é—´æ€»ä¼šå’Œ Windows çš„æ—¶é—´ç›¸å·® 8 å°æ—¶ï¼ŒåŸå› åœ¨äº widows è®¤ä¸º BIOS æ—¶é—´æ˜¯æœ¬åœ°æ—¶é—´ï¼ŒUbuntu è®¤ä¸º BIOS æ—¶é—´æ˜¯ UTC æ—¶é—´ï¼Œå³åè°ƒä¸–ç•Œæ—¶ï¼Œ(Universal Time Coordinated) è‹±æ–‡ç¼©å†™ï¼Œæ˜¯ç”±å›½é™…æ— çº¿ç”µå’¨è¯¢å§”å‘˜ä¼šè§„å®šå’Œæ¨èï¼Œå¹¶ç”±å›½é™…æ—¶é—´å±€ (BIH) è´Ÿè´£ä¿æŒçš„ä»¥ç§’ä¸ºåŸºç¡€çš„æ—¶é—´æ ‡åº¦ã€‚UTC ç›¸å½“äºæœ¬åˆå­åˆçº¿ï¼ˆå³ç»åº¦ 0 åº¦ï¼‰ä¸Šçš„å¹³å‡å¤ªé˜³æ—¶ï¼Œè¿‡å»æ›¾ç”¨æ ¼æ—å¨æ²»å¹³å‡æ—¶ (GMT) æ¥è¡¨ç¤ºã€‚åŒ—äº¬æ—¶é—´æ¯” UTC æ—¶é—´æ—© 8 å°æ—¶ï¼Œä»¥ 1999 å¹´ 1 æœˆ 1 æ—¥ 00:00 UTC ä¸ºä¾‹ï¼ŒUTC æ—¶é—´æ˜¯é›¶ç‚¹ï¼ŒåŒ—äº¬æ—¶é—´ä¸º 1999 å¹´ 1 æœˆ 1 æ—¥æ—©ä¸Š 8 ç‚¹æ•´ã€‚)ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ—¶é—´ä¸Šé¢ç›¸éš”äº† 8 ä¸ªå°æ—¶ã€‚è¿™ä¸ªæ—¶å€™ bios çš„æ—¶é—´å’Œç³»ç»Ÿçš„æ—¶é—´å½“ç„¶æ˜¯ä¸ä¸€è‡´ï¼Œä¸€ä¸ªä»£è¡¨ utc æ—¶é—´ï¼Œä¸€ä¸ªä»£è¡¨ cstï¼ˆï¼‹ 8 æ—¶åŒºï¼‰ï¼Œå³æˆ‘ä»¬å¸¸ç”¨çš„æ—¶é—´ã€‚ ","date":"2019-03-15","objectID":"/posts/ubuntutime/:1:0","tags":["ubuntu","linux","windows"],"title":"win10,ubuntu åŒç³»ç»Ÿæ—¶é—´ä¸ä¸€è‡´","uri":"/posts/ubuntutime/"},{"categories":["OS"],"content":"æ–¹æ³•ä¸€ åœ¨ Windows ä¸‹ è¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼šï¼ˆåšä¸» win10,win7 è‡ªæµ‹ï¼‰ ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ CMDï¼ˆwin+x åé€‰æ‹© Windows Powershellï¼ˆç®¡ç†å‘˜ï¼‰ Reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation /v RealTimeIsUniversal /t REG_DWORD /d 1 é‡å¯çœ‹çœ‹æ—¶é—´å‘ç° ok äº†ã€‚ ","date":"2019-03-15","objectID":"/posts/ubuntutime/:2:0","tags":["ubuntu","linux","windows"],"title":"win10,ubuntu åŒç³»ç»Ÿæ—¶é—´ä¸ä¸€è‡´","uri":"/posts/ubuntutime/"},{"categories":["OS"],"content":"æ–¹æ³•äºŒ è€ç‰ˆ Ubuntuï¼ˆUbuntu10 å·¦å³ï¼‰ï¼š ä¿®æ”¹ /etc/default/rcS æ–‡ä»¶ ç¼–è¾‘ /etc/default/rcS å°† UTC=yesæ”¹æˆ UTC=no ã€‚ æ–°ç‰ˆ Ubuntuï¼ˆUbuntu16.04ï¼‰ï¼š æ–°ç‰ˆæœ¬çš„ Ubuntu ä½¿ç”¨ systemd å¯åŠ¨ä¹‹åï¼Œæ—¶é—´ä¹Ÿæ”¹æˆäº†ç”± timedatectl æ¥ç®¡ç†ï¼Œæ­¤æ–¹æ³•å°±ä¸é€‚ç”¨äº†ã€‚ $sudo timedatectl set-local-rtc 1 å…ˆåœ¨ ubuntu ä¸‹æ›´æ–°ä¸€ä¸‹æ—¶é—´ï¼Œç¡®ä¿æ—¶é—´æ— è¯¯ï¼š $sudo apt-get install ntpdate $sudo ntpdate time.windows.com ç„¶åå°†æ—¶é—´æ›´æ–°åˆ°ç¡¬ä»¶ä¸Šï¼š $sudo hwclock --localtime --systohc é‡æ–°è¿›å…¥ windows10ï¼Œå‘ç°æ—¶é—´æ¢å¤æ­£å¸¸äº†ï¼ ","date":"2019-03-15","objectID":"/posts/ubuntutime/:3:0","tags":["ubuntu","linux","windows"],"title":"win10,ubuntu åŒç³»ç»Ÿæ—¶é—´ä¸ä¸€è‡´","uri":"/posts/ubuntutime/"},{"categories":["JavaScript"],"content":" ä»¥å‰åœ¨ QQ é‡Œé¢èŠå¤©çš„æ—¶å€™å‘ç°ï¼Œæœ‰äº›é“¾æ¥æ˜¯å¡ç‰‡å¼çš„é“¾æ¥ï¼ŒåƒçŸ¥ä¹é‡Œé‚£äº›ä¸€æ ·ï¼Œå°±å¥½å¥‡ä¸ºå•¥æˆ‘çš„åŸŸåæ²¡æœ‰ç”Ÿæˆå¡ç‰‡ã€‚ æŸ¥äº†ä¸€ä¸‹ç™¾åº¦çŸ¥é“äº†å¤§æ¦‚å°±æ˜¯ qq æ²¡æœ‰æŠ“å–åˆ°ä½ çš„ç½‘ç«™çš„ xmlã€‚å¹¶åœ¨å…¶ä»–æ•™ç¨‹ä¸­å¾—åˆ°äº†ä¸€ä¸ªå¼ºåˆ¶æäº¤æŠ“å–çš„ url https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshareget_urlinfo?url= äºæ˜¯å°±æœ‰äº†è„šæœ¬åˆ·æ–°çš„æƒ³æ³•ã€‚ç®€é™‹çš„å†™äº†ä¸€ä¸‹ã€‚ ","date":"2019-03-08","objectID":"/posts/qqxml/:0:0","tags":["JavaScript"],"title":"QQ å¼ºåˆ¶ç”Ÿæˆå¡ç‰‡å¼é“¾æ¥","uri":"/posts/qqxml/"},{"categories":["JavaScript"],"content":"æ‰¹é‡å¼åˆ·æ–° //è®¾ç½®åˆ·æ–°å‰ç¼€ url=é¦–é¡µåœ°å€ï¼ˆæœ€å¥½ä½¿ç”¨ httpsï¼‰ var base_src = 'https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshareget_urlinfo?url=https://lruihao.cn'; //ç”¨æˆ·åœ°å€ //var custom_src = \"https://lruihao.cn\"; //åˆå§‹åŒ–å·¥ä½œåœ°å€ var new_src = ''; function createArrayAndOpenWindow() { //alert(\"number function\"); //å®šä¹‰æ•°ç»„å­˜å‚¨åç¼€ var numberArray = new Array(4); //å­˜å‚¨åç¼€ numberArray[0] = '/about/'; numberArray[1] = '/categories/'; numberArray[2] = '/tags/'; numberArray[3] = '/archives/'; //numberArray[4] = \"/guestbook/\"; //éå† for (var i = 0; i \u003c numberArray.length; i++) { new_src = base_src + numberArray[i]; //æ‰“å¼€è¯¥åœ°å€ open_new(); //æ¸…ç©ºåç¼€ new_src = ''; } } //è´Ÿè´£æ‰“å¼€çª—å£ï¼Œå¹¶å…³é—­ function open_new() { var new_window = window.open(new_src, '', 'width=400,height=200'); setTimeout(function () { //å¼€å¯å 200msï¼ˆå•é¡µï¼‰å…³é—­ï¼Œé€Ÿåº¦è‡ªè¡ŒæŠŠæ¡æ•°ç»„è¶Šå¤§æ—¶é—´è¶Šå¤š new_window.close(); }, 2000); } window.onload = function () { createArrayAndOpenWindow(); //è®¾ç½®å®šæ—¶å‡½æ•°ï¼Œç–¯ç‹‚åˆ·æ–°ç›´åˆ° xml å‡ºç°å†…å®¹ var timer = setInterval('createArrayAndOpenWindow()', 2000); }; ","date":"2019-03-08","objectID":"/posts/qqxml/:1:0","tags":["JavaScript"],"title":"QQ å¼ºåˆ¶ç”Ÿæˆå¡ç‰‡å¼é“¾æ¥","uri":"/posts/qqxml/"},{"categories":["JavaScript"],"content":"å•é“¾æ¥åˆ·æ–° \u003cdiv style=\"text-align: center;\"\u003e \u003cinput type=\"text\" id=\"input\" value=\"\" /\u003e \u003cinput type=\"button\" value=\"ç–¯ç‹‚åˆ·æ–°\" onclick=\"yanzheng()\" /\u003e \u003c/div\u003e //è®¾ç½®åˆ·æ–°å‰ç¼€ url=é¦–é¡µåœ°å€ï¼ˆæœ€å¥½ä½¿ç”¨ httpsï¼‰https://lruihao.cn var base_src = 'https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshareget_urlinfo?url='; //ç”¨æˆ·åœ°å€ var custom_src = ''; //åˆå§‹åŒ–å·¥ä½œåœ°å€ var new_src = ''; //è´Ÿè´£æ‰“å¼€çª—å£ï¼Œå¹¶å…³é—­ function open_new() { var new_window = window.open(new_src, '', 'width=400,height=200'); setTimeout(function () { //å¼€å¯å 200ms å…³é—­ new_window.close(); }, 200); } // è·å–éªŒè¯ç”¨æˆ·è¾“å…¥ function yanzheng() { var Input = document.getElementById('input'); var oValue = Input.value; custom_src = oValue; new_src = base_src + custom_src; if (oValue == 0) { alert('è¯·è¾“å…¥åœ°å€'); } else { var timer = setInterval('open_new()', 200); } } ","date":"2019-03-08","objectID":"/posts/qqxml/:2:0","tags":["JavaScript"],"title":"QQ å¼ºåˆ¶ç”Ÿæˆå¡ç‰‡å¼é“¾æ¥","uri":"/posts/qqxml/"},{"categories":["JavaScript"],"content":"demo çº¿ä¸Š demo ä»…åšå‚è€ƒè¯·è‡ªè¡Œä¸‹è½½ æ•ˆæœ ","date":"2019-03-08","objectID":"/posts/qqxml/:3:0","tags":["JavaScript"],"title":"QQ å¼ºåˆ¶ç”Ÿæˆå¡ç‰‡å¼é“¾æ¥","uri":"/posts/qqxml/"},{"categories":["OS"],"content":"å¤–å­˜çš„ç»„ç»‡æ–¹å¼ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:1:0","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"è¿ç»­ç»„ç»‡æ–¹å¼ è¿ç»­ç»„ç»‡æ–¹å¼çš„ä¼˜ç‚¹ é¡ºåºè®¿é—®å®¹æ˜“ é¡ºåºè®¿é—®é€Ÿåº¦å¿« è¿ç»­ç»„ç»‡æ–¹å¼çš„ç¼ºç‚¹ åˆ†é…è¿ç»­çš„å­˜å‚¨ç©ºé—´ å¿…é¡»çŸ¥é“æ–‡ä»¶é•¿åº¦ åˆ é™¤ä¸æ’å…¥æ•°æ®ä¸çµæ´» åŠ¨æ€å¢é•¿çš„æ–‡ä»¶åˆ†é…ç©ºé—´é—®é¢˜ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:1:1","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"é“¾æ¥ç»„ç»‡æ–¹å¼ éšå¼é“¾æ¥ æ˜¾å¼é“¾æ¥ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:1:2","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"FAT æŠ€æœ¯ FAT12 æ—©æœŸçš„ FAT12 æ–‡ä»¶ç³»ç»Ÿ ä»¥ç°‡ä¸ºå•ä½çš„ FAT12 æ–‡ä»¶ç³»ç»Ÿ FAT16 FAT32 ","date":"2019-03-04","objectID":"/posts/cipanadmin/:1:3","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"NTFS çš„æ–‡ä»¶ç»„ç»‡æ–¹å¼ NTFS æ–°ç‰¹å¾ ç£ç›˜ç»„ç»‡ æ–‡ä»¶çš„ç»„ç»‡ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:1:4","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"ç´¢å¼•ç»„ç»‡æ–¹å¼ å•çº§ç´¢å¼•ç»„ç»‡æ–¹å¼ å¤šçº§ç´¢å¼•ç»„ç»‡æ–¹å¼ å¢é‡å¼ç´¢å¼•ç»„ç»‡æ–¹å¼ å¢é‡å¼ç´¢å¼•ç»„ç»‡æ–¹å¼çš„åŸºæœ¬æ€æƒ³ UNIX System V çš„ç»„ç»‡æ–¹å¼ ç›´æ¥åœ°å€ ä¸€æ¬¡é—´æ¥åœ°å€ å¤šæ¬¡é—´æ¥åœ°å€ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:1:5","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"æ–‡ä»¶å­˜å‚¨ç©ºé—´çš„ç®¡ç† ","date":"2019-03-04","objectID":"/posts/cipanadmin/:2:0","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"ç©ºé—²è¡¨æ³•å’Œç©ºé—²é“¾è¡¨æ³• ç©ºé—²è¡¨æ³• ç©ºé—²è¡¨ å­˜å‚¨ç©ºé—´çš„åˆ†é…ä¸å›æ”¶ ç©ºé—²é“¾è¡¨æ³• ç©ºé—²ç›˜å—é“¾ ç©ºé—²ç›˜åŒºé“¾ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:2:1","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"ä½ç¤ºå›¾æ³• ä½ç¤ºå›¾ ç›˜å—çš„åˆ†é…ï¼ˆæ­¥éª¤ï¼‰ é¡ºåºæ‰«æç¤ºå›¾ è½¬æ¢ç›˜å—å· ä¿®æ”¹ä½ç¤ºå›¾ ç›˜å—çš„å›æ”¶ï¼ˆæ­¥éª¤ï¼‰ ç›˜å—å·è½¬æ¢æˆè¡Œåˆ—å· ä¿®æ”¹ä½ç¤ºå›¾ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:2:2","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"æˆç»„é“¾æ¥æ³• ç©ºé—²ç›˜å—çš„ç»„ç»‡ ç©ºé—²ç›˜å—çš„åˆ†é…ä¸å›æ”¶ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:2:3","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"æé«˜ç£ç›˜ I/O é€Ÿåº¦çš„é€”å¾„ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:3:0","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"ç£ç›˜é«˜é€Ÿç¼“å­˜ æ•°æ®äº¤ä»˜æ–¹å¼ æ•°æ®äº¤ä»˜ æŒ‡é’ˆäº¤ä»˜ ç½®æ¢ç®—æ³• å‘¨æœŸæ€§åœ°å†™å›ç£ç›˜ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:3:1","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"æé«˜ç£ç›˜ I/O é€Ÿåº¦çš„å…¶ä»–æ–¹æ³• æå‰è¯» å»¶è¿Ÿå†™ ä¼˜åŒ–ç‰©ç†å—çš„åˆ†å¸ƒ è™šæ‹Ÿç›˜ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:3:2","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ— (RAID) å¹¶è¡Œäº¤å‰å­˜å– RAID çš„åˆ†çº§ RAID 0 çº§ RAID 1 çº§ RAID 2 çº§ RAID 3 çº§ RAID 4 çº§ RAID 5 çº§ RAID 6 çº§å’Œ RAID 7 çº§ RAID çš„ä¼˜ç‚¹ å¯é æ€§é«˜ ç£ç›˜ I/O é€Ÿåº¦é«˜ æ€§ä»·æ¯”é«˜ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:3:3","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"æé«˜ç£ç›˜å¯é æ€§çš„æŠ€æœ¯ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:4:0","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"ç¬¬ä¸€çº§å®¹é”™æŠ€æœ¯ SFT-â…  åŒä»½ç›®å½•å’ŒåŒä»½æ–‡ä»¶åˆ†é…è¡¨ çƒ­ä¿®å¤é‡å®šå‘å’Œå†™åè¯»æ ¡éªŒ çƒ­ä¿®å¤é‡å®šå‘ å†™åè¯»æ ¡éªŒæ–¹å¼ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:4:1","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"ç¬¬äºŒçº§å®¹é”™æŠ€æœ¯ SFT-â…¡ ç£ç›˜é•œåƒ ç£ç›˜åŒå·¥ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:4:2","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"åŸºäºé›†ç¾¤æŠ€æœ¯çš„å®¹é”™åŠŸèƒ½ åŒæœºçƒ­å¤‡ä»½æ¨¡å¼ åŒæœºäº’ä¸ºå¤‡ä»½æ¨¡å¼ å…¬ç”¨ç£ç›˜æ¨¡å¼ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:4:3","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"åå¤‡ç³»ç»Ÿ ç£å¸¦æœº ç¡¬ç›˜ ç§»åŠ¨ç£ç›˜ å›ºå®šç¡¬ç›˜é©±åŠ¨å™¨ å…‰ç›˜é©±åŠ¨å™¨ CD-ROM å’Œ DVD-ROM åˆ»å½•æœº ","date":"2019-03-04","objectID":"/posts/cipanadmin/:4:4","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"æ•°æ®ä¸€è‡´æ€§æ§åˆ¶ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:5:0","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"äº‹åŠ¡ äº‹åŠ¡çš„å®šä¹‰ äº‹åŠ¡è®°å½• æ¢å¤ç®—æ³• undo \u003cTi\u003e redo \u003cTi\u003e ","date":"2019-03-04","objectID":"/posts/cipanadmin/:5:1","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"æ£€æŸ¥ç‚¹ æ£€æŸ¥ç‚¹çš„ä½œç”¨ æ–°çš„æ¢å¤ç®—æ³• ","date":"2019-03-04","objectID":"/posts/cipanadmin/:5:2","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"å¹¶å‘æ§åˆ¶ åˆ©ç”¨äº’æ–¥é”å®ç°â€œé¡ºåºæ€§â€ åˆ©ç”¨äº’æ–¥é”å’Œå…±äº«é”å®ç°é¡ºåºæ€§ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:5:3","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["OS"],"content":"é‡å¤æ•°æ®çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ é‡å¤æ–‡ä»¶çš„ä¸€è‡´æ€§ é“¾æ¥æ•°ä¸€è‡´æ€§æ£€æŸ¥ ","date":"2019-03-04","objectID":"/posts/cipanadmin/:5:4","tags":["OS","ç£ç›˜"],"title":"ç£ç›˜å­˜å‚¨å™¨çš„ç®¡ç†","uri":"/posts/cipanadmin/"},{"categories":["JavaScript"],"content":" è¯·ç‚¹å‡»éªŒè¯ç å¤„ï¼šâ†‘ ","date":"2019-03-04","objectID":"/posts/js-vcode/:0:0","tags":["JavaScript"],"title":"JS éªŒè¯ç ","uri":"/posts/js-vcode/"},{"categories":["JavaScript"],"content":" éªŒè¯ç  JS æ¥æºäº’è”ç½‘ \u003cscript type=\"text/javascript\"\u003e //è®¾ç½®ä¸€ä¸ªå…¨å±€çš„å˜é‡ï¼Œä¾¿äºä¿å­˜éªŒè¯ç  var code; function createCode(){ //é¦–å…ˆé»˜è®¤ code ä¸ºç©ºå­—ç¬¦ä¸² code = ''; //è®¾ç½®é•¿åº¦ï¼Œè¿™é‡Œçœ‹éœ€æ±‚ï¼Œæˆ‘è¿™é‡Œè®¾ç½®äº† 4 var codeLength = 4; var codeV = document.getElementById('code'); //è®¾ç½®éšæœºå­—ç¬¦ var random = new Array(0,1,2,3,4,5,6,7,8,9,'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R', 'S','T','U','V','W','X','Y','Z'); //å¾ªç¯ codeLength æˆ‘è®¾ç½®çš„ 4 å°±æ˜¯å¾ªç¯ 4 æ¬¡ for(var i = 0; i \u003c codeLength; i++){ //è®¾ç½®éšæœºæ•°èŒƒå›´ï¼Œè¿™è®¾ç½®ä¸º 0 ~ 36 var index = Math.floor(Math.random()*36); //å­—ç¬¦ä¸²æ‹¼æ¥ å°†æ¯æ¬¡éšæœºçš„å­—ç¬¦ è¿›è¡Œæ‹¼æ¥ code += random[index]; } //å°†æ‹¼æ¥å¥½çš„å­—ç¬¦ä¸²èµ‹å€¼ç»™å±•ç¤ºçš„ Value codeV.value = code; } //ä¸‹é¢å°±æ˜¯åˆ¤æ–­æ˜¯å¦== çš„ä»£ç ï¼Œæ— éœ€è§£é‡Šï¼Œä¹Ÿå¯ä»¥ç»“åˆ ajax åœ¨åå°åšåˆ¤æ–­ function validate(){ var Input = document.getElementById('input'); var oValue = Input.value.toUpperCase(); if(oValue ==0){ alert('è¯·è¾“å…¥éªŒè¯ç '); }else if(oValue != code){ Input.value = ''; alert('éªŒè¯ç ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°è¾“å…¥'); createCode(); }else{ Input.value = ''; alert('éªŒè¯ç æ­£ç¡®ï¼');//window.open('http://lruihao.cn','_self'); } } //è®¾ç½®æ­¤å¤„çš„åŸå› æ˜¯æ¯æ¬¡è¿›å…¥ç•Œé¢å±•ç¤ºä¸€ä¸ªéšæœºçš„éªŒè¯ç ï¼Œä¸è®¾ç½®åˆ™ä¸ºç©º window.onload = function (){ createCode(); } \u003c/script\u003e ","date":"2019-03-04","objectID":"/posts/js-vcode/:1:0","tags":["JavaScript"],"title":"JS éªŒè¯ç ","uri":"/posts/js-vcode/"},{"categories":["Java"],"content":" å¼•ç”¨ ç»§æ‰¿çš„å¥½å¤„ï¼š æé«˜äº†ä»£ç çš„å¤ç”¨æ€§ æé«˜äº†ä»£ç çš„ç»´æŠ¤æ€§ è®©ç±»ä¸ç±»ä¹‹é—´äº§ç”Ÿäº†å…³ç³»ï¼Œæ˜¯å¤šæ€çš„å‰æ ç»§æ‰¿çš„å¼Šç«¯ï¼šç±»çš„è€¦åˆæ€§å¾ˆå¼º è®¾è®¡åŸåˆ™ï¼šä½è€¦åˆï¼Œé«˜å†…èšã€‚ è€¦åˆï¼šç±»ä¸ç±»çš„å…³ç³»ã€‚ å†…èšï¼šè‡ªå·±å®Œæˆäº‹æƒ…çš„èƒ½åŠ›ã€‚ ","date":"2019-01-24","objectID":"/posts/jicheng/:0:0","tags":["Java"],"title":"java ç»§æ‰¿ test","uri":"/posts/jicheng/"},{"categories":["Java"],"content":"java ä¸­çš„ç»§æ‰¿ç‰¹ç‚¹ Java åªæ”¯æŒå•ç»§æ‰¿ï¼Œä¸æ”¯æŒå¤šç»§æ‰¿ã€‚Java æ”¯æŒå¤šå±‚ç»§æ‰¿ï¼ˆç»§æ‰¿ä½“ç³»ï¼‰ class A { } class B extends A { } /* class C extends A,B { } */ class C extends B { } class ExtendsDemo { public static void main(String[] args) { } } ","date":"2019-01-24","objectID":"/posts/jicheng/:0:1","tags":["Java"],"title":"java ç»§æ‰¿ test","uri":"/posts/jicheng/"},{"categories":["Java"],"content":"java ä¸­çš„ç»§æ‰¿æ³¨æ„äº‹é¡¹ å­ç±»åªèƒ½ç»§æ‰¿çˆ¶ç±»æ‰€æœ‰éç§æœ‰çš„æˆå‘˜ï¼ˆæˆå‘˜æ–¹æ³•å’Œæˆå‘˜å˜é‡ï¼‰ å­ç±»ä¸èƒ½ç»§æ‰¿çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ super å…³é”®å­—å»è®¿é—®çˆ¶ç±»æ„é€ æ–¹æ³•ã€‚ ä¸è¦ä¸ºäº†éƒ¨åˆ†åŠŸèƒ½è€Œå»ç»§æ‰¿ é‚£ä¹ˆï¼Œæˆ‘ä»¬ä»€ä¹ˆæ—¶å€™è€ƒè™‘ä½¿ç”¨ç»§æ‰¿å‘¢ï¼Ÿ ç»§æ‰¿ä¸­ç±»ä¹‹é—´ä½“ç°çš„æ˜¯ï¼šâ€is aâ€çš„å…³ç³»ã€‚ å¦‚æœä¸¤ä¸ªç±»æ»¡è¶³è¿™ä¸ªå…³ç³»ï¼šxxx is a yyyï¼Œé‚£ä¹ˆä»–ä»¬å°±å¯ä»¥ä½¿ç”¨ç»§æ‰¿ã€‚ Student,Person å¯¹ Dog,Animal å¯¹ Dog,Pig é”™ ","date":"2019-01-24","objectID":"/posts/jicheng/:0:2","tags":["Java"],"title":"java ç»§æ‰¿ test","uri":"/posts/jicheng/"},{"categories":["Java"],"content":"ç»§æ‰¿ ç»§æ‰¿é—´çš„æ„é€ æ–¹æ³•å…³ç³»ï¼šåˆ›å»ºå­ç±»å¯¹è±¡ï¼Œä¼šå…ˆå»è®¿é—®çˆ¶ç±»çš„æ„é€ æ–¹æ³•ã€‚å¯¹çˆ¶ç±»çš„æ•°æ®è¿›è¡Œåˆå§‹åŒ–ã€‚ package jicheng; class Fu{ public int num = 10; public Fu(){ System.out.println(\"çˆ¶ç±»\"); } } class Zi extends Fu{ public int num = 20; public Zi(){ System.out.println(\"å­ç±»\"); } public void show(){ int num = 30; System.out.println(num);//30 System.out.println(this.num);//20 System.out.println(super.num);//10 } } public class test { public static void main(String[] args) { Zi z = new Zi(); z.show(); } } ç¨‹åºè¿è¡Œç»“æœ çˆ¶ç±» å­ç±» 30 20 10 ","date":"2019-01-24","objectID":"/posts/jicheng/:0:3","tags":["Java"],"title":"java ç»§æ‰¿ test","uri":"/posts/jicheng/"},{"categories":["Java"],"content":"ä»£ç å— ä»£ç å—çš„æ‰§è¡Œé¡ºåºï¼š é™æ€ä»£ç å— â€“\u003e æ„é€ ä»£ç å— â€“\u003e æ„é€ æ–¹æ³• ä»£ç çš„æ‰§è¡Œç‰¹ç‚¹ï¼šé™æ€ä»£ç å—åªæ‰§è¡Œä¸€æ¬¡ï¼Œæ„é€ ä»£ç å—æ¯æ¬¡è°ƒç”¨æ„é€ æ–¹æ³•éƒ½æ‰§è¡Œã€‚ package jicheng; class Fu { static { System.out.println(\"çˆ¶ç±»é™æ€ä»£ç å—\"); } { System.out.println(\"çˆ¶ç±»æ„é€ ä»£ç å—\"); } public Fu() { System.out.println(\"çˆ¶ç±»æ„é€ æ–¹æ³•\"); } } class Zi extends Fu { static { System.out.println(\"å­ç±»é™æ€ä»£ç å—\"); } { System.out.println(\"å­ç±»æ„é€ ä»£ç å—\"); } public Zi() { System.out.println(\"å­ç±»æ„é€ æ–¹æ³•\"); } } public class test { public static void main(String[] args) { Zi z = new Zi(); Zi z2 = new Zi(); } } ç¨‹åºè¿è¡Œç»“æœï¼š çˆ¶ç±»é™æ€ä»£ç å— å­ç±»é™æ€ä»£ç å— çˆ¶ç±»æ„é€ ä»£ç å— çˆ¶ç±»æ„é€ æ–¹æ³• å­ç±»æ„é€ ä»£ç å— å­ç±»æ„é€ æ–¹æ³• çˆ¶ç±»æ„é€ ä»£ç å— çˆ¶ç±»æ„é€ æ–¹æ³• å­ç±»æ„é€ ä»£ç å— å­ç±»æ„é€ æ–¹æ³• ","date":"2019-01-24","objectID":"/posts/jicheng/:0:4","tags":["Java"],"title":"java ç»§æ‰¿ test","uri":"/posts/jicheng/"},{"categories":["Java"],"content":"ç»§æ‰¿é—´çš„æˆå‘˜å…³ç³» æˆå‘˜æ–¹æ³• ä¸åŒåç§°ï¼š éå¸¸ç®€å•ï¼Œä¸€çœ‹å°±çŸ¥é“è°ƒç”¨è° ç›¸åŒåç§°ï¼š å…ˆåœ¨å­ç±»æ‰¾ï¼Œå†åœ¨çˆ¶ç±»æ‰¾ â€¦ æ‰¾ä¸åˆ°å°±æŠ¥é”™ã€‚ æˆå‘˜å˜é‡ï¼š åå­—ä¸åŒï¼š éå¸¸çš„ç®€å•ï¼Œä¸€çœ‹å°±çŸ¥é“ä½¿ç”¨çš„æ˜¯è°ã€‚ åå­—ç›¸åŒï¼š å°±è¿‘åŸåˆ™ã€‚ ä½¿ç”¨å˜é‡çš„æ—¶å€™ï¼Œä¼šå…ˆæ‰¾å±€éƒ¨èŒƒå›´ã€‚ å¦‚æœæƒ³ç›´æ¥ä½¿ç”¨æˆå‘˜å˜é‡ï¼ŒåŠ å…³é”®å­—ï¼šthis å³å¯ã€‚ å¦‚æœæƒ³ç›´æ¥ä½¿ç”¨çˆ¶ç±»çš„æˆå‘˜å˜é‡ï¼ŒåŠ å…³é”®å­—ï¼šsuper å³å¯ã€‚ ","date":"2019-01-24","objectID":"/posts/jicheng/:0:5","tags":["Java"],"title":"java ç»§æ‰¿ test","uri":"/posts/jicheng/"},{"categories":["Java"],"content":"æ³¨æ„äº‹é¡¹ å­ç±»ä¸­æ‰€æœ‰çš„æ„é€ æ–¹æ³•é»˜è®¤éƒ½ä¼šè®¿é—®çˆ¶ç±»ä¸­ç©ºå‚æ•°çš„æ„é€ æ–¹æ³•ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå­ç±»ä¼šç»§æ‰¿çˆ¶ç±»ä¸­çš„æ•°æ®ï¼Œå¯èƒ½è¿˜ä¼šä½¿ç”¨çˆ¶ç±»çš„æ•°æ®ã€‚æ‰€ä»¥ï¼Œå­ç±»åˆå§‹åŒ–ä¹‹å‰ï¼Œä¸€å®šè¦å…ˆå®Œæˆçˆ¶ç±»æ•°æ®çš„åˆå§‹åŒ–ã€‚ ","date":"2019-01-24","objectID":"/posts/jicheng/:0:6","tags":["Java"],"title":"java ç»§æ‰¿ test","uri":"/posts/jicheng/"},{"categories":["Memo"],"content":" æœ¬ä»¥ä¸º coding pages ä¸è…¾è®¯äº‘åˆä½œåä¼šæ›´å¥½ï¼Œæ²¡æƒ³åˆ°æ­£æ˜¯è¿™ç§åˆæœŸ bug ä¸æ–­ï¼Œé€Ÿåº¦ä¹Ÿæ˜¯éå¸¸æ…¢ã€‚æ¯” gitee, ç”šè‡³ github éƒ½è¦æ…¢å¾ˆå¤šäº†ã€‚æ‰€ä»¥å†³å®šæ”¾å¼ƒ coding äº†ï¼Œæœ¬æƒ³æŒ‚åˆ°äº‘æœåŠ¡å™¨ä¸Šï¼Œä½†æ˜¯è¿™ä¸ªäº‘æœåŠ¡å™¨åªç»­è´¹äº†åŠå¹´ï¼Œå¯èƒ½ä¸ä¼šå†ç»­è´¹ï¼Œå‰å‡ å¤©çœ‹åˆ°ç”¨è…¾è®¯äº‘çš„ cos æ¡¶ xml åˆ¶ä½œåŠ¨æ€ç›¸å†Œçš„æ–‡ç« ï¼ŒçŸ¥é“äº†å¯¹è±¡å­˜å‚¨è¿™ä¸ªç©æ„ï¼Œè…¾è®¯äº‘ COS æä¾›å…è´¹ 50G çš„å­˜å‚¨ç©ºé—´ï¼Œè¿˜æœ‰ CDN åŠ é€ŸæœåŠ¡ï¼Œæˆ‘è§‰å¾—æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œéƒ¨ç½²åå‘ç°é€Ÿåº¦è¿˜æŒºå¥½ã€‚ é€‚ç”¨äº hexo, hugo ç­‰é™æ€åšå®¢çš„éƒ¨ç½²ã€‚ ","date":"2019-01-22","objectID":"/posts/cos-hexo/:0:0","tags":["hexo","hugo","è…¾è®¯äº‘ cos æ¡¶","å¯¹è±¡å­˜å‚¨"],"title":"åˆ©ç”¨è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ COS æ¡¶æ‰˜ç®¡ hexo åšå®¢","uri":"/posts/cos-hexo/"},{"categories":["Memo"],"content":"åˆ›å»ºå­˜å‚¨æ¡¶ æ‰“å¼€è…¾è®¯äº‘æ§åˆ¶å°â€“äº‘äº§å“â€“å­˜å‚¨â€“å¯¹è±¡å­˜å‚¨ï¼Œç„¶ååˆ›å»ºå­˜å‚¨æ¡¶ã€‚ ","date":"2019-01-22","objectID":"/posts/cos-hexo/:1:0","tags":["hexo","hugo","è…¾è®¯äº‘ cos æ¡¶","å¯¹è±¡å­˜å‚¨"],"title":"åˆ©ç”¨è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ COS æ¡¶æ‰˜ç®¡ hexo åšå®¢","uri":"/posts/cos-hexo/"},{"categories":["Memo"],"content":"å¼€å¯é™æ€ç½‘ç«™è®¾ç½® åœ¨åŸºç¡€é…ç½®æ‰“å¼€é™æ€ç½‘ç«™ï¼ˆå…³æ‰å¼ºåˆ¶ https) ","date":"2019-01-22","objectID":"/posts/cos-hexo/:2:0","tags":["hexo","hugo","è…¾è®¯äº‘ cos æ¡¶","å¯¹è±¡å­˜å‚¨"],"title":"åˆ©ç”¨è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ COS æ¡¶æ‰˜ç®¡ hexo åšå®¢","uri":"/posts/cos-hexo/"},{"categories":["Memo"],"content":"ç»‘å®šåŸŸå SSL è®¾ç½® ","date":"2019-01-22","objectID":"/posts/cos-hexo/:3:0","tags":["hexo","hugo","è…¾è®¯äº‘ cos æ¡¶","å¯¹è±¡å­˜å‚¨"],"title":"åˆ©ç”¨è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ COS æ¡¶æ‰˜ç®¡ hexo åšå®¢","uri":"/posts/cos-hexo/"},{"categories":["Memo"],"content":"åŸŸåè§£æï¼Œæ·»åŠ è®°å½• å» dns æœåŠ¡å•†æ·»åŠ åŸŸåè§£æè®°å½• CNAME æŒ‡å‘ä¸Šé¢çš„åŸŸå ","date":"2019-01-22","objectID":"/posts/cos-hexo/:4:0","tags":["hexo","hugo","è…¾è®¯äº‘ cos æ¡¶","å¯¹è±¡å­˜å‚¨"],"title":"åˆ©ç”¨è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ COS æ¡¶æ‰˜ç®¡ hexo åšå®¢","uri":"/posts/cos-hexo/"},{"categories":["Memo"],"content":"hexo è®¾ç½® å®‰è£…æ’ä»¶ npm install hexo-deployer-cos --save ç«™ç‚¹é…ç½®æ–‡ä»¶ deploy: type: cos bucket: yourBucketName #cos æ¡¶åç§° appId: yourAppId #cos æ¡¶åç§°åæ•°å­— secretId: yourSecretId #äº‘ API å¯†é’¥ secretKey: yourSecretKey #äº‘ API å¯†é’¥ region: yourRegion #æ‰€å±åœ°åŸŸ å‘å¸ƒè¿˜æ˜¯ä¸€æ ·çš„ hexo clean hexo g -d ç»“æœç±»ä¼¼äº ","date":"2019-01-22","objectID":"/posts/cos-hexo/:5:0","tags":["hexo","hugo","è…¾è®¯äº‘ cos æ¡¶","å¯¹è±¡å­˜å‚¨"],"title":"åˆ©ç”¨è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ COS æ¡¶æ‰˜ç®¡ hexo åšå®¢","uri":"/posts/cos-hexo/"},{"categories":["Memo"],"content":"CDN åˆ·æ–° æ¯æ¬¡æ›´æ–°åšå®¢å†…å®¹å®Œåï¼Œéƒ½è¦ç™»é™†è…¾è®¯äº‘ CDNâ€“ç¼“å­˜åˆ·æ–°ï¼Œæ‰‹åŠ¨åˆ·æ–°ä¸€ä¸‹ CDNã€‚ ç”¨è„šæœ¬åœ¨æ¯æ¬¡æ›´æ–°ååˆ·æ–° å®‰è£… npm install qcloud-cdn-node-sdk --save åˆ›å»ºqcloudcdn.jsæ”¾å…¥scriptæ–‡ä»¶å¤¹ const qcloudSDK = require('qcloud-cdn-node-sdk'); qcloudSDK.config({ secretId: 'ä½ çš„ ID', secretKey: 'ä½ çš„å¯†é’¥' }); qcloudSDK.request( 'RefreshCdnDir', { 'dirs.1': 'http://åšå®¢åœ°å€' }, (res) =\u003e { console.log(res); } ); ","date":"2019-01-22","objectID":"/posts/cos-hexo/:6:0","tags":["hexo","hugo","è…¾è®¯äº‘ cos æ¡¶","å¯¹è±¡å­˜å‚¨"],"title":"åˆ©ç”¨è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ COS æ¡¶æ‰˜ç®¡ hexo åšå®¢","uri":"/posts/cos-hexo/"},{"categories":["Memo"],"content":"è‡ªåŠ¨ CDN åˆ·æ–°é…ç½® ï¼ˆæ¨èï¼‰ è¿›å…¥è…¾è®¯äº‘ï¼Œæ‰¾åˆ° å‡½æ•°è®¡ç®— -\u003e CDN ç¼“å­˜åˆ·æ–°å‡½æ•° -\u003e åˆ›å»º CDN ç¼“å­˜åˆ·æ–°å‡½æ•° ä¿®æ”¹ index.js å†…å®¹åé‡æ–°éƒ¨ç½² 'use strict'; const CosSdk = require('cos-nodejs-sdk-v5'); const CdnSdk = require('./common/CdnSdk'); const CdnRefreshTask = require('./common/CdnRefreshTask'); const { getParams, getObjectUrl, logger, getLogSummary } = require('./common/utils'); exports.main_handler = async (event, context, callback) =\u003e { /** * parse param from event and process.env */ const { objects, cdnHosts, secretId, secretKey, token } = getParams(event); logger({ title: 'param is parsed success, param as follow: ', data: { objects, cdnHosts, event } }); /** * init cos instance */ if (!secretId || !secretKey || !token) { throw new Error(`secretId, secretKey or token is missing`); } const cdnSdkInstance = new CdnSdk({ secretId, secretKey, token }); const cosInstance = new CosSdk({ SecretId: secretId, SecretKey: secretKey, XCosSecurityToken: token }); const taskList = objects.map(({ bucket, region, key }) =\u003e { /* å˜æ›´å†…å®¹-START */ const purgeUrls = []; cdnHosts.forEach((host) =\u003e { const tempUrl = getObjectUrl({ cosInstance, bucket, region, key, origin: `${/^(http\\:\\/\\/|https\\:\\/\\/)/.test(host) ? '' : 'https://'}${host}` }); purgeUrls.push(tempUrl); // å¦‚æœä»¥ /index.html ç»“å°¾ï¼Œåˆ™å¢åŠ ç›®å½•é¦–é¡µ/ã€‚ // ä¾‹å¦‚ https://www.xxxx.com/index.html, åˆ™å¢åŠ  https://www.xxxx.com/ã€‚ if (tempUrl.lastIndexOf('/index.html') == tempUrl.length - 11) { purgeUrls.push(tempUrl.substr(0, tempUrl.length - 10)); } }); return new CdnRefreshTask({ cdnSdkInstance, urls: purgeUrls }); /* å˜æ›´å†…å®¹-END */ }); const taskResults = []; for (const task of taskList) { const results = await task.runPurgeTasks(); taskResults.push(...results); } logger({ title: 'cdn refresh full logs:', data: taskResults }); const { status, messages } = getLogSummary(taskResults); logger({ messages: messages.map((item) =\u003e item.replace(/\\,\\ /g, '\\n')) }); if (status === 'fail') { throw messages.join('; '); } else { return messages.join('; '); } }; ","date":"2019-01-22","objectID":"/posts/cos-hexo/:7:0","tags":["hexo","hugo","è…¾è®¯äº‘ cos æ¡¶","å¯¹è±¡å­˜å‚¨"],"title":"åˆ©ç”¨è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ COS æ¡¶æ‰˜ç®¡ hexo åšå®¢","uri":"/posts/cos-hexo/"},{"categories":["Java"],"content":"ä¸»è¦æ–¹æ³• static type[] copyof(type[] original,int length) static int binarysearch(type[] a,type key) static boolean equals(type[] a,type[] b) static void fill(type[] a,type val) static void fill(type[] a,int fromindex,int toindex,type val) static void sort(type[] a) ","date":"2019-01-18","objectID":"/posts/java-arrays/:0:1","tags":["Java","Collator","Comparator"],"title":"Arrays ç±»åŠåŸºæœ¬ä½¿ç”¨","uri":"/posts/java-arrays/"},{"categories":["Java"],"content":"å®ä¾‹ä»£ç  package Arrays; import java.text.Collator; import java.util.Arrays; import java.util.Comparator; public class ArraysDemo { public static void main(String agrs[]) { Integer arr[]=new Integer[9]; for(int i=0;i\u003c9;i++) arr[i]=(int)(Math.random()*100); //æ˜¾ç¤ºï¼Œæ’åºæ•°ç»„ System.out.print(\"åŸå†…å®¹ï¼š\"); display(arr); Arrays.sort(arr); System.out.print(\"æ’åºåï¼š\"); display(arr); //å°†å€¼-1 åˆ†é…ç»™æ•°ç»„ arr ä¸­ä¸‹æ ‡ä» 0 åˆ° 3-1 çš„ä½ç½® Arrays.fill(arr, 0,3,-1); System.out.print(\"fill() åï¼š\"); display(arr); //æœç´¢ 23 System.out.print(\"å€¼ 23 çš„ä½ç½®ï¼š\"); int index =Arrays.binarySearch(arr, 23);//äºŒåˆ†æŸ¥æ‰¾ System.out.print(index);//å¦‚æœæŸ¥æ‰¾ä¸åˆ°ï¼Œindex ä¸ºè´Ÿ System.out.print(\"\\n æ’å…¥ 0 åœ¨ 3 å·ä½ç½®ï¼š\"); Arrays.fill(arr,3,4,0); display(arr); System.out.print(\"å€¼ 0 çš„ä½ç½®ï¼š\"); index =Arrays.binarySearch(arr, 0); System.out.print(index); Integer arr2[]=new Integer[8]; arr2=Arrays.copyOf(arr, arr2.length); //å¤åˆ¶ 8 ä¸ª System.out.print(\"\\n å¤åˆ¶åçš„æ•°ç»„ï¼š\"); display(arr2); if(Arrays.equals(arr, arr2)) System.out.println(\"ä¸¤æ•°ç»„ç›¸åŒï¼\"); else System.out.println(\"ä¸¤æ•°ç»„ä¸ç›¸åŒï¼\"); System.out.println(\"----------------------------------------\"); String[] str = {\"è®¡ç®—æœº\",\"é»„æ¡‘\",\"é€šä¿¡\",\"æç‘è±ª\"}; Arrays.sort(str); for(int i=0;i\u003cstr.length;i++) System.out.print(str[i]+\" \"); System.out.println(\"\"); //Collator ç±»æ˜¯ç”¨æ¥æ‰§è¡Œåˆ†è¯­è¨€ç¯å¢ƒçš„å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œè¿™é‡Œç”¨çš„ CHINA Comparator com=Collator.getInstance(java.util.Locale.CHINA);//è·å– Comparator å¯¹è±¡ï¼Œå‚æ•°è¡¨ç¤ºæŒ‰ä¸­æ–‡æ’åº //æ ¹æ®æŒ‡å®šçš„ \"æ¯”è¾ƒå™¨\" äº§ç”Ÿçš„é¡ºåºå¯¹ \"æŒ‡å®šå¯¹è±¡æ•°ç»„\" è¿›è¡Œæ’åº Arrays.sort(str,com);//sort(T[] a,Comparator\u003c?super T\u003ec) for(int i=0;i\u003cstr.length;i++) System.out.print(str[i]+\" \"); } static void display(Integer arr[]) { for(int i=0;i\u003carr.length;i++) System.out.print(arr[i]+\" \"); System.out.println(\"\"); } } ","date":"2019-01-18","objectID":"/posts/java-arrays/:0:2","tags":["Java","Collator","Comparator"],"title":"Arrays ç±»åŠåŸºæœ¬ä½¿ç”¨","uri":"/posts/java-arrays/"},{"categories":["Java"],"content":"ç¨‹åºè¿è¡Œç»“æœ åŸå†…å®¹ï¼š41 0 44 96 49 96 30 6 87 æ’åºåï¼š0 6 30 41 44 49 87 96 96 fill() åï¼š-1 -1 -1 41 44 49 87 96 96 å€¼ 23 çš„ä½ç½®ï¼š-4 æ’å…¥ 0 åœ¨ 3 å·ä½ç½®ï¼š-1 -1 -1 0 44 49 87 96 96 å€¼ 0 çš„ä½ç½®ï¼š3 å¤åˆ¶åçš„æ•°ç»„ï¼š-1 -1 -1 0 44 49 87 96 ä¸¤æ•°ç»„ä¸ç›¸åŒï¼ ---------------------------------------- æç‘è±ª è®¡ç®—æœº é€šä¿¡ é»„æ¡‘ é»„æ¡‘ è®¡ç®—æœº æç‘è±ª é€šä¿¡ ","date":"2019-01-18","objectID":"/posts/java-arrays/:0:3","tags":["Java","Collator","Comparator"],"title":"Arrays ç±»åŠåŸºæœ¬ä½¿ç”¨","uri":"/posts/java-arrays/"},{"categories":["Memo"],"content":" é¦–å…ˆåœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶æ·»åŠ ä»¥ä¸‹å…³é”®å­— recent_posts: enable: true search: true post: false sidebar: false icon: history title: è¿‘æœŸæ–‡ç«  layout: block ","date":"2019-01-16","objectID":"/posts/recent-posts/:0:0","tags":["hexo"],"title":"åœ¨æœç´¢ã€æ–‡ç« åº•éƒ¨ã€ä¾§æ æ·»åŠ æœ€è¿‘æ–‡ç« æ¨¡å—","uri":"/posts/recent-posts/"},{"categories":["Memo"],"content":"ä¾§æ  åœ¨ next/layout/_macro/sidebar.swig ä¸­çš„ if theme.links å¯¹åº”çš„ endif åé¢ã€‚ {% if theme.recent_posts.enable and theme.recent_posts.sidebar %} \u003cdiv class=\"links-of-blogroll motion-element {{ \"links-of-blogroll-\" + theme.recent_posts.layout }}\"\u003e \u003cdiv class=\"links-of-blogroll-title\"\u003e \u003ci class=\"fa fa-history fa-{{ theme.recent_posts.icon | lower }}\" aria-hidden=\"true\"\u003e\u003c/i\u003e {{ theme.recent_posts.title }} \u003c/div\u003e \u003cul class=\"links-of-blogroll-list\"\u003e {% set posts = site.posts.sort('-date') %} {% for post in posts.slice('0', '3') %} \u003cli\u003e \u003ca href=\"{{ url_for(post.path) }}\" title=\"{{ post.title }}\" target=\"_blank\"\u003e{{ post.title }}\u003c/a\u003e \u003c/li\u003e {% endfor %} \u003c/ul\u003e \u003c/div\u003e {% endif %} ","date":"2019-01-16","objectID":"/posts/recent-posts/:1:0","tags":["hexo"],"title":"åœ¨æœç´¢ã€æ–‡ç« åº•éƒ¨ã€ä¾§æ æ·»åŠ æœ€è¿‘æ–‡ç« æ¨¡å—","uri":"/posts/recent-posts/"},{"categories":["Memo"],"content":"æœç´¢ç»“æœå¤„æ·»åŠ  æ‰¾åˆ°è·¯å¾„H:\\hexo\\themes\\hexo-theme-next\\layout\\_partials\\searchä¸‹localsearch.swigæ–‡ä»¶ æŠŠ\u003cdiv id=\"local-search-result\"\u003e\u003c/div\u003eä¿®æ”¹æˆä»¥ä¸‹å†…å®¹ï¼ˆè¿™é‡Œæ˜¾ç¤º 15 ç¯‡ï¼‰ \u003cdiv id=\"local-search-result\"\u003e {% if theme.recent_posts.enable and theme.recent_posts.search %} \u003cdiv style=\"text-align: center;padding: 3px 0 0;\"\u003e \u003cdiv style=\"margin-top: 20px;font-size: 18px;font-weight: 600;border-bottom: 1px solid #ccc;\"\u003e \u003ci class=\"fa fa-{{ theme.recent_posts.icon }}\" aria-hidden=\"true\"\u003e\u003c/i\u003e {{ theme.recent_posts.title }} \u003c/div\u003e \u003cul style=\"margin: 0;padding: 0;list-style: none;\"\u003e {% set posts = site.posts.sort('-date') %} {% for post in posts.slice('0', '15') %} \u003cli\u003e \u003ca href=\"{{ url_for(post.path) }}\" title=\"{{ post.title }}\" target=\"_blank\"\u003e{{ post.title }}\u003c/a\u003e \u003c/li\u003e {% endfor %} \u003c/ul\u003e \u003c/div\u003e {% endif %} \u003c/div\u003e ","date":"2019-01-16","objectID":"/posts/recent-posts/:2:0","tags":["hexo"],"title":"åœ¨æœç´¢ã€æ–‡ç« åº•éƒ¨ã€ä¾§æ æ·»åŠ æœ€è¿‘æ–‡ç« æ¨¡å—","uri":"/posts/recent-posts/"},{"categories":["Memo"],"content":"æ–‡ç« å°¾éƒ¨æ·»åŠ  æŠŠä»£ç åŠ åœ¨H:\\hexo\\themes\\hexo-theme-next\\layout\\_macro\\post.swigé‡Œçš„ç›¸åº”ä½ç½®ï¼ˆæˆ‘åŠ åœ¨ tags åï¼‰ {% if not is_index and theme.recent_posts.enable and theme.recent_posts.post %} \u003cdiv style=\"text-align: center;padding: 10px 0 0;\"\u003e \u003cdiv style=\"margin: 60px 0px 10px;font-size: 18px;border-bottom: 1px solid #eee;\"\u003e \u003ci class=\"fa fa-{{ theme.recent_posts.icon }}\" aria-hidden=\"true\"\u003e\u003c/i\u003e {{ theme.recent_posts.title }} \u003c/div\u003e \u003cul style=\"margin: 0;padding: 0;list-style: none;font-size: 11px;\"\u003e {% set posts = site.posts.sort('-date') %} {% for post in posts.slice('0', '5') %} \u003ca href=\"{{ url_for(post.path) }}\" title=\"{{ post.title }}\" target=\"_blank\"\u003e{{ post.title }}\u003c/a\u003e\u0026emsp; {% endfor %} \u003c/ul\u003e \u003c/div\u003e {% endif %} ","date":"2019-01-16","objectID":"/posts/recent-posts/:3:0","tags":["hexo"],"title":"åœ¨æœç´¢ã€æ–‡ç« åº•éƒ¨ã€ä¾§æ æ·»åŠ æœ€è¿‘æ–‡ç« æ¨¡å—","uri":"/posts/recent-posts/"},{"categories":["Memo"],"content":"å…¶ä»– å¯å°è¯•å°†-dateæ”¹ä¸º-update ","date":"2019-01-16","objectID":"/posts/recent-posts/:4:0","tags":["hexo"],"title":"åœ¨æœç´¢ã€æ–‡ç« åº•éƒ¨ã€ä¾§æ æ·»åŠ æœ€è¿‘æ–‡ç« æ¨¡å—","uri":"/posts/recent-posts/"},{"categories":["Java"],"content":" å¤§ä¸€åˆšå­¦ c çš„æ—¶å€™ä»¥å‰å†™è¿‡ c è¯­è¨€ç‰ˆ çš„ã€‚ Math: é’ˆå¯¹æ•°å­¦è¿›è¡Œè¿ç®—çš„ç±» ç‰¹ç‚¹ï¼šæ²¡æœ‰æ„é€ æ–¹æ³•ï¼Œå› ä¸ºå®ƒçš„æˆå‘˜éƒ½æ˜¯é™æ€çš„ äº§ç”Ÿéšæœºæ•°ï¼š public static double random(): äº§ç”Ÿéšæœºæ•°ï¼ŒèŒƒå›´ [0.0,1.0) äº§ç”Ÿ 1-100 ä¹‹é—´çš„éšæœºæ•° int number = (int)(Math.random()*100)+1; çŒœæ•°å­—å°æ¸¸æˆæ¡ˆä¾‹ class MathDemo { public static void main(String[] args) { //è·å–éšæœºæ•° //double d = Math.random(); //System.out.println(d); /* for(int x=0; x\u003c10; x++) { //System.out.println(Math.random()); System.out.println(Math.random()*100); } */ //æˆ‘ä»¬å¦‚ä½•è·å– 1-100 ä¹‹é—´çš„éšæœºæ•°å‘¢ï¼Ÿ for(int x=0; x\u003c100; x++) { int number = (int)(Math.random()*100)+1; System.out.println(number); } } } ","date":"2019-01-15","objectID":"/posts/mathclass/:0:0","tags":["Java"],"title":"java çŒœæ•°å­—å°æ¸¸æˆï¼ˆMath ç±»ï¼‰","uri":"/posts/mathclass/"},{"categories":["Java"],"content":"å°æ¸¸æˆ è¯¥æ¸¸æˆå¯ä»¥ç”±ç¨‹åºéšæœºäº§ç”Ÿæˆ–ç”±ç”¨æˆ·è¾“å…¥å››ä¸ª 0 åˆ° 9 ä¹‹é—´çš„æ•°å­—ï¼Œä¸”ä¸é‡å¤ã€‚ç©æ¸¸æˆè€…é€šè¿‡æ¸¸æˆæç¤ºè¾“å…¥å…«æ¬¡æ¥åŒ¹é…ä¸Šé¢æ‰€è¾“å…¥çš„æ•°å­—ã€‚A è¡¨ç¤ºä½ç½®æ­£ç¡®ä¸”æ•°å­—æ­£ç¡®ï¼ŒB è¡¨ç¤ºæ•°å­—æ­£ç¡®è€Œä½ç½®ä¸æ­£ç¡®ã€‚ ç®—æ³•ï¼š å¯ä»¥ç›´æ¥ç®—å‡º A ç±»çš„æ•°ç›®ï¼Œä½†æ˜¯ B ç±»çš„æ•°ç›®ç›´æ¥ç®—å‡ºæˆ–è®¸ä¼šå¾ˆéº»çƒ¦ï¼Œæ­£å¥½æˆ‘ä»¬å¯ä»¥å…ˆç®—å‡º C ç±»æ•°ç›®æ°å¥½å‡å» A ç±»å°±æ˜¯ B ç±»äº†ã€‚ package caishuzi; import java.util.Scanner; class Num { private int[] a= {0,0,0,0}; public Num() {} public void setx() { /*for(int i=0;i\u003c4;i++) { a[i]=(int)(Math.random()*10); }*/ //ä¸ºäº†å››ä¸ªäº’ä¸ç›¸åŒçš„éšæœºæ•° a[0]=(int)Math.random()*10+1; for(int i=1;i\u003c4;i++) { int t=(int)(Math.random()*10); for(int j=0;j\u003ci;j++) { if(t==a[j]) { t=(int)(Math.random()*10); j=0; } } a[i]=t; } } public int[] getx() { return a; } public void show() { System.out.println(); for(int i=0;i\u003c4;i++) System.out.print(a[i]+\" \"); System.out.println(); } } public class caishuzi { public static void main(String agrs[]) { int a[] = {0,0,0,0},b[] = {0,0,0,0}; System.out.println(\"* * * *\\n è¯·è¾“å…¥ 4 ä¸ªæ•°å­—ï¼A è¡¨ç¤ºä½ç½®æ•°å­—éƒ½æ­£ç¡®ï¼ŒB è¡¨ç¤ºæ•°å­—æ­£ç¡®ä½ç½®é”™è¯¯ã€‚\"); Scanner sc=new Scanner(System.in); Num n=new Num(); n.setx(); a=n.getx(); /*for(int i=0;i\u003c4;i++) System.out.print(a[i]+\" \"); n.show();*/ for(int k=0;k\u003c10;k++) {//çŒœæµ‹æ¬¡æ•° int A=0,B=0,C=0; for(int i=0;i\u003c4;i++) { b[i]=sc.nextInt(); } sc.close(); for(int i=0;i\u003c4;i++){ if (b[i]==a[i])A++; for(int j=0;j\u003c4;j++){ C=b[i]==a[j]?++C:C;//C è¡¨ç¤ºçŒœæµ‹æ•°å†…å’Œéšæœºæ•°ä¸­ A ç±»å’Œ B ç±»æ•°çš„æ•°ç›® if (b[i]==a[j])break; } } B=C-A;// å…³é”®ç®—æ³•ï¼ˆæ„Ÿå¹æ•°å­¦é­…åŠ›ï¼‰ if(A==4) { System.out.println(\"æ­å–œçŒœå¯¹å•¦ï¼\"); }else { System.out.println(A+\"A\"+B+\"B\"); } } } } ","date":"2019-01-15","objectID":"/posts/mathclass/:0:1","tags":["Java"],"title":"java çŒœæ•°å­—å°æ¸¸æˆï¼ˆMath ç±»ï¼‰","uri":"/posts/mathclass/"},{"categories":["Java"],"content":"ä¸€æ¬¡æ¸¸æˆè¿‡ç¨‹ * * * * è¯·è¾“å…¥ 4 ä¸ªæ•°å­—ï¼A è¡¨ç¤ºä½ç½®æ•°å­—éƒ½æ­£ç¡®ï¼ŒB è¡¨ç¤ºæ•°å­—æ­£ç¡®ä½ç½®é”™è¯¯ã€‚ 0 1 2 3 0A1B 0 1 2 4 0A1B 0 1 2 5 1A1B 6 1 2 5 1A2B 1 6 2 5 3A0B 1 6 7 5 æ­å–œçŒœå¯¹å•¦ï¼ ","date":"2019-01-15","objectID":"/posts/mathclass/:0:2","tags":["Java"],"title":"java çŒœæ•°å­—å°æ¸¸æˆï¼ˆMath ç±»ï¼‰","uri":"/posts/mathclass/"},{"categories":["Java"],"content":"é¢å‘å¯¹è±¡æ€æƒ³ï¼ˆç†è§£ï¼‰ é¢å‘å¯¹è±¡æ˜¯åŸºäºé¢å‘è¿‡ç¨‹çš„ä¸€ç§ç¼–ç¨‹æ€æƒ³ æ€æƒ³ç‰¹ç‚¹ï¼š A: æ˜¯ä¸€ç§æ›´ç¬¦åˆæˆ‘ä»¬æ€è€ƒä¹ æƒ¯çš„æ€æƒ³ B: æŠŠå¤æ‚çš„é—®é¢˜ç®€å•åŒ– C: è®©æˆ‘ä»¬ä»æ‰§è¡Œè€…å˜æˆäº†æŒ‡æŒ¥è€… ä¸¾ä¾‹ï¼š A: æ´—è¡£æœ B: åƒé¥­ C: ä¹°ç”µè„‘ ä¸¾ä¾‹å¹¶ä»£ç ä½“ç° æŠŠå¤§è±¡è£…è¿›å†°ç®± ","date":"2019-01-15","objectID":"/posts/duixiang/:0:1","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"ç±»ä¸å¯¹è±¡ï¼ˆæŒæ¡ï¼‰ æˆ‘ä»¬å­¦ä¹ ç¼–ç¨‹æ˜¯ä¸ºäº†æŠŠç°å®ä¸–ç•Œçš„äº‹ç‰©ç”¨ç¼–ç¨‹è¯­è¨€æè¿°æ¥å®ç°ä¿¡æ¯åŒ–ã€‚ ç°å®ä¸–ç•Œäº‹ç‰©æ˜¯å¦‚ä½•è¡¨è¾¾çš„å‘¢ï¼Ÿ å±æ€§ï¼šå¤–åœ¨ç‰¹å¾ è¡Œä¸ºï¼šå†…åœ¨è¡Œä¸º æˆ‘ä»¬å­¦ä¹ çš„æ˜¯ java è¯­è¨€ï¼Œå®ƒæœ€åŸºæœ¬çš„å•ä½æ˜¯ç±»ã€‚ æ‰€ä»¥æˆ‘ä»¬è¦å­¦ä¼šç”¨ç±»æ¥ä½“ç°ä¸€ä¸ªäº‹ç‰©ã€‚ ç±»ï¼šæ˜¯ä¸€ç»„ç›¸å…³çš„å±æ€§å’Œè¡Œä¸ºçš„é›†åˆ å¯¹è±¡ï¼šæ˜¯è¯¥ç±»äº‹ç‰©çš„å…·ä½“ä¸ªä½“ã€‚ ä¸¾ä¾‹ï¼š å­¦ç”Ÿ ç±» å¼ ä¸‰ å¯¹è±¡ ","date":"2019-01-15","objectID":"/posts/duixiang/:0:2","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"ç±»çš„ç»„æˆï¼ˆæŒæ¡ï¼‰ æˆå‘˜å˜é‡ å…¶å®å°±æ˜¯å˜é‡ï¼Œåªä¸è¿‡å®šä¹‰åœ¨ç±»ä¸­ï¼Œæ–¹æ³•å¤–ï¼Œå¹¶ä¸”å¯ä»¥ä¸ç”¨åˆå§‹åŒ–ã€‚ æˆå‘˜æ–¹æ³• å…¶å®å°±æ˜¯æ–¹æ³•ï¼Œåªä¸è¿‡ä¸éœ€è¦ static äº† æ¡ˆä¾‹ï¼š å­¦ç”Ÿç±» class Student { String name; int age; public void study() {} } ","date":"2019-01-15","objectID":"/posts/duixiang/:0:3","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"ç±»çš„ä½¿ç”¨ï¼ˆæŒæ¡ï¼‰ åˆ›å»ºå¯¹è±¡ æ ¼å¼ï¼šç±»å å¯¹è±¡å = new ç±»å (); ä½¿ç”¨æˆå‘˜ æˆå‘˜å˜é‡ï¼šå¯¹è±¡åã€‚å˜é‡åï¼› æˆå‘˜æ–¹æ³•ï¼šå¯¹è±¡åã€‚æ–¹æ³•å (â€¦); ","date":"2019-01-15","objectID":"/posts/duixiang/:0:4","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«ï¼ˆç†è§£ï¼‰ åœ¨ç±»ä¸­çš„ä½ç½®ä¸åŒ A: æˆå‘˜å˜é‡ ç±»ä¸­ï¼Œæ–¹æ³•å¤– B: å±€éƒ¨å˜é‡ æ–¹æ³•çš„å½¢å¼å‚æ•°ï¼Œæˆ–è€…æ–¹æ³•ä½“ä¸­ åœ¨å†…å­˜ä¸­çš„ä½ç½®ä¸åŒ A: æˆå‘˜å˜é‡ åœ¨å †ä¸­ B: å±€éƒ¨å˜é‡ åœ¨æ ˆä¸­ ç”Ÿå‘½å‘¨æœŸä¸åŒ A: æˆå‘˜å˜é‡ éšç€å¯¹è±¡çš„å­˜åœ¨è€Œå­˜åœ¨ï¼Œéšç€å¯¹è±¡çš„æ¶ˆå¤±è€Œæ¶ˆå¤± B: å±€éƒ¨å˜é‡ éšç€æ–¹æ³•çš„è°ƒç”¨è€Œå­˜åœ¨ï¼Œéšç€æ–¹æ³•çš„è°ƒç”¨å®Œæ¯•è€Œæ¶ˆå¤± åˆå§‹åŒ–å€¼ä¸åŒ A: æˆå‘˜å˜é‡ æœ‰é»˜è®¤åˆå§‹åŒ–å€¼ B: å±€éƒ¨å˜é‡ æ²¡æœ‰é»˜è®¤å€¼ï¼Œå¿…é¡»å…ˆå£°æ˜ï¼Œèµ‹å€¼ï¼Œæœ€åæ‰èƒ½ä½¿ç”¨ ","date":"2019-01-15","objectID":"/posts/duixiang/:0:5","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"å½¢å¼å‚æ•°é—®é¢˜ï¼ˆç†è§£ï¼‰ åŸºæœ¬ç±»å‹ åŸºæœ¬ç±»å‹ä½œä¸ºå½¢å¼å‚æ•°ï¼Œéœ€è¦çš„æ˜¯è¯¥åŸºæœ¬ç±»å‹çš„å€¼ã€‚ å¼•ç”¨ç±»å‹ å¼•ç”¨ç±»å‹ä½œä¸ºå½¢å¼å‚æ•°ï¼Œéœ€è¦çš„æ˜¯è¯¥å¼•ç”¨ç±»å‹çš„åœ°å€å€¼ã€‚ï¼ˆå¯¹è±¡ï¼‰ ","date":"2019-01-15","objectID":"/posts/duixiang/:0:6","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"åŒ¿åå¯¹è±¡ï¼ˆç†è§£ï¼‰ åŒ¿åå¯¹è±¡ï¼šæ²¡æœ‰åå­—çš„å¯¹è±¡ã€‚æ˜¯å¯¹è±¡çš„ç®€åŒ–ä¹¦å†™æ–¹å¼ã€‚ ä½¿ç”¨åœºæ™¯ A: è°ƒç”¨æ–¹æ³•ï¼Œä»…ä»…åªè°ƒç”¨ä¸€æ¬¡ B: ä½œä¸ºå®é™…å‚æ•°ä¼ é€’ ","date":"2019-01-15","objectID":"/posts/duixiang/:0:7","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"å°è£…ï¼ˆæŒæ¡ï¼‰ éšè—å®ç°ç»†èŠ‚ï¼Œæä¾›å…¬å…±çš„è®¿é—®æ–¹å¼ å¥½å¤„ï¼š A: éšè—å®ç°ç»†èŠ‚ï¼Œæä¾›å…¬å…±çš„è®¿é—®æ–¹å¼ B: æé«˜äº†ä»£ç çš„å¤ç”¨æ€§ C: æé«˜äº†ä»£ç çš„å®‰å…¨æ€§ ä½¿ç”¨åŸåˆ™ A: æŠŠæˆå‘˜å˜é‡éšè— B: ç»™å‡ºè¯¥æˆå‘˜å˜é‡å¯¹åº”çš„å…¬å…±è®¿é—®æ–¹å¼ ","date":"2019-01-15","objectID":"/posts/duixiang/:0:8","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"private å…³é”®å­—ï¼ˆæŒæ¡ï¼‰ æ˜¯ä¸€ä¸ªæƒé™ä¿®é¥°ç¬¦ å¯ä»¥ä¿®é¥°ç±»çš„æˆå‘˜ï¼ˆæˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•ï¼‰ ä»…ä»…åœ¨æœ¬ç±»ä¸­å¯ä»¥è®¿é—®ï¼Œå¯¹å¤–æä¾›å¯¹åº”çš„ GetXXX()ï¼ŒSetXXX() ç­‰æ–¹æ³• æ ‡å‡†ä»£ç ï¼š class Student { private String name; private int age; public void setName(String n) { name = n; } public String getName() { return name; } public void setAge(int a) { age = a; } public int getAge() { return age; } public void study() {} } ","date":"2019-01-15","objectID":"/posts/duixiang/:0:9","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"this å…³é”®å­—ï¼ˆæŒæ¡ï¼‰ thisï¼šä»£è¡¨æœ¬ç±»çš„å¯¹è±¡ åº”ç”¨åœºæ™¯ï¼š è§£å†³äº†å±€éƒ¨å˜é‡éšè—æˆå‘˜å˜é‡çš„é—®é¢˜ã€‚ å…¶ä»–ç”¨æ³•å’Œ super ä¸€èµ·è®²ã€‚ æ ‡å‡†ä»£ç ï¼š class Student { private String name; private int age; public void setName(String name) {//å±€éƒ¨å˜é‡ this.name = name; } public String getName() { return name; } public void setAge(int age) { this.age = age; } public int getAge() { return age; } public void show() { System.out.println(\"å§“åæ˜¯ï¼š\"+name+\", å¹´é¾„æ˜¯ï¼š\"+age); } public void study() { System.out.println(\"å­¦ç”Ÿçˆ±å­¦ä¹ \"); } public void eat() { System.out.println(\"å­¦ç”Ÿè¦åƒé¥­\"); } public void sleep() { System.out.println(\"å­¦ç”Ÿæƒ³ç¡è§‰\"); } } class StudentTest { public static void main(String[] args) { Student s = new Student(); s.setName(\"æ—é’éœ\"); s.setAge(28); s.show(); s.study(); s.eat(); s.sleep(); System.out.println(\"å§“åæ˜¯ï¼š\"+s.getName()); System.out.println(\"å¹´é¾„æ˜¯ï¼š\"+s.getAge()); } } ","date":"2019-01-15","objectID":"/posts/duixiang/:0:10","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"æ„é€ æ–¹æ³•ï¼ˆæŒæ¡ï¼‰ ä½œç”¨ï¼šå¯¹å¯¹è±¡çš„æ•°æ®è¿›è¡Œåˆå§‹åŒ–ã€‚ ç‰¹ç‚¹ï¼š A: æ–¹æ³•åå’Œç±»åç›¸åŒ B: æ²¡æœ‰è¿”å›å€¼ç±»å‹ C: æ²¡æœ‰è¿”å›å€¼ æ³¨æ„äº‹é¡¹ A: å¦‚æœæˆ‘ä»¬æ²¡å†™æ„é€ æ–¹æ³•ï¼Œç³»ç»Ÿå°†é»˜è®¤ç»™å‡ºæ— å‚æ„é€ æ–¹æ³• B: å¦‚æœæˆ‘ä»¬å†™äº†æ„é€ æ–¹æ³•ï¼Œç³»ç»Ÿå°†ä¸å†ç»™å‡ºé»˜è®¤æ— å‚æ„é€ æ–¹æ³• å»ºè®®ï¼šæˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨ç»™å‡ºæ— å‚æ„é€ æ–¹æ³• ç»™æˆå‘˜å˜é‡èµ‹å€¼ï¼š A: æ— å‚+setXxx() B: å¸¦å‚ ä¸€ä¸ªæ ‡å‡†çš„ä»£ç ï¼š class Student { private String name; private int age; public Student() {} public Student(String name,int age) {//æ„é€ æ–¹æ³• this.name = name; this.age = age; } public void setName(String name) { this.name = name; } public String getName() { return name; } public void setAge(int age) { this.age = age; } public int getAge() { return age; } public void show() { System.out.println(\"å§“åæ˜¯ï¼š\"+name+\", å¹´é¾„æ˜¯ï¼š\"+age); } } class StudentTest { public static void main(String[] args) { //æ— å‚+setXxx() Student s = new Student(); s.setName(\"æ—é’éœ\"); s.setAge(28); s.show(); //å¸¦å‚ Student ss = new Student(\"å¼ æ›¼ç‰\",20); ss.show(); } } ","date":"2019-01-15","objectID":"/posts/duixiang/:0:11","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"å¯¹è±¡çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼ˆç†è§£ï¼‰ Student s = new Student(); åšäº†å“ªäº›äº‹æƒ… A: åŠ è½½ Student.class æ–‡ä»¶è¿›å†…å­˜ B: åœ¨æ ˆä¸­ä¸º s å¼€è¾Ÿç©ºé—´ C: åœ¨å †ä¸­ä¸ºå­¦ç”Ÿå¯¹è±¡å¼€è¾Ÿç©ºé—´ D: ä¸ºå­¦ç”Ÿå¯¹è±¡çš„æˆå‘˜å˜é‡èµ‹é»˜è®¤å€¼ E: ä¸ºå­¦ç”Ÿå¯¹è±¡çš„æˆå‘˜å˜é‡èµ‹æ˜¾ç¤ºå€¼ F: é€šè¿‡æ„é€ æ–¹æ³•ç»™æˆå‘˜å˜é‡èµ‹å€¼ G: å¯¹è±¡æ„é€ å®Œæ¯•ï¼ŒæŠŠåœ°å€èµ‹å€¼ç»™ s å˜é‡ ","date":"2019-01-15","objectID":"/posts/duixiang/:0:12","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"static å…³é”®å­—ï¼ˆæŒæ¡ï¼‰ æ˜¯ä¸€ä¸ªçŠ¶æ€ä¿®é¥°ç¬¦ã€‚é™æ€çš„æ„æ€ å®ƒå¯ä»¥ä¿®é¥°æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³• ç‰¹ç‚¹ï¼š A: éšç€ç±»çš„åŠ è½½è€ŒåŠ è½½ B: ä¼˜å…ˆäºå¯¹è±¡å­˜åœ¨ C: è¢«æ‰€æœ‰å¯¹è±¡å…±äº« è¿™ä¹Ÿæ˜¯åˆ¤æ–­æˆ‘ä»¬æ˜¯ä¸æ˜¯è¯¥ä½¿ç”¨é™æ€çš„æ¡ä»¶ ä¸¾ä¾‹ï¼šé¥®æ°´æœºï¼ˆå¯å…±äº« static) å’Œæ°´æ¯ä¾‹å­ã€‚ D: å¯ä»¥é€šè¿‡ç±»åè°ƒç”¨ é™æ€ä¿®é¥°çš„å†…å®¹ï¼Œå¯ä»¥é€šè¿‡ç±»åè°ƒç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¯¹è±¡åè°ƒç”¨ æ–¹æ³•è®¿é—®ç‰¹ç‚¹ A: æ™®é€šæˆå‘˜æ–¹æ³• å¯ä»¥è®¿é—®é™æ€æˆå‘˜å˜é‡ï¼Œéé™æ€æˆå‘˜å˜é‡ï¼Œé™æ€æˆå‘˜æ–¹æ³•ï¼Œéé™æ€æˆå‘˜æ–¹æ³• B: é™æ€æˆå‘˜æ–¹æ³• åªèƒ½è®¿é—®é™æ€æˆå‘˜å˜é‡ï¼Œé™æ€æˆå‘˜æ–¹æ³• ç®€è®°ï¼šé™æ€åªèƒ½è®¿é—®é™æ€ æ³¨æ„ï¼š é™æ€ä¸­æ˜¯ä¸èƒ½æœ‰ this çš„ã€‚ å…ˆè¿›å†…å­˜çš„ä¸èƒ½è®¿é—®åè¿›å†…å­˜çš„ã€‚åä¹‹å¯ä»¥ã€‚ /* ç­çº§ç¼–å·åº”è¯¥æ˜¯è¢«ç­çº§æ¯ä¸ªäººéƒ½å…±äº«çš„ï¼Œæ‰€ä»¥å®šä¹‰ä¸€ä¸ªå°±åº”è¯¥å¯ä»¥äº†ã€‚ è€Œå§“åå’Œå¹´é¾„ï¼Œæ¯ä¸ªäººåº”è¯¥æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥ï¼Œæ¯ä¸ªå¯¹è±¡ï¼Œéƒ½åº”è¯¥å®šä¹‰è‡ªå·±çš„ã€‚ åœ¨ java ä¸­ï¼Œç”¨ä»€ä¹ˆæ¥è¡¨ç¤ºæˆå‘˜å˜é‡æ˜¯è¢«å…±äº«çš„å‘¢ï¼Ÿstatic */ class Student { //å§“å String name; //å¹´é¾„ int age; //ç­çº§ç¼–å· //String classNumber; static String classNumber; public Student(String name,int age) { this.name = name; this.age = age; } public Student(String name,int age,String classNumber) { this.name = name; this.age = age; this.classNumber = classNumber; } public void show() { System.out.println(name+\"---\"+age+\"---\"+classNumber); } } class StudentDemo { public static void main(String[] args) { //åˆ›å»ºå­¦ç”Ÿå¯¹è±¡ Student s1 = new Student(\"æ—é’éœ\",28,\"20150306\"); s1.show(); /* Student s2 = new Student(\"é©¬äº‘\",35,\"20150306\"); s2.show(); Student s3 = new Student(\"é©¬åŒ–è…¾\",33,\"20150306\"); s3.show(); */ Student s2 = new Student(\"é©¬äº‘\",35); s2.show(); Student s3 = new Student(\"é©¬åŒ–è…¾\",33); s3.show(); } } /* static: é™æ€å…³é”®å­—ã€‚ ä½œç”¨ï¼š å¯ä»¥ä¿®é¥°æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³• ç‰¹ç‚¹ï¼š A: éšç€ç±»çš„åŠ è½½è€ŒåŠ è½½ B: ä¼˜å…ˆäºå¯¹è±¡å­˜åœ¨ C: è¢«ç±»çš„æ‰€æœ‰å¯¹è±¡å…±äº« è¿™ä¹Ÿæ˜¯æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦ä½¿ç”¨é™æ€å…³é”®å­—çš„æ¡ä»¶ é¥®æ°´æœºï¼šå¯ä»¥è¢«é™æ€ä¿®é¥° æ°´æ¯ï¼šä¸å¯ä»¥è¢«é™æ€ä¿®é¥° D: å¯ä»¥é€šè¿‡ç±»åè°ƒç”¨ æˆ‘ä»¬çš„è°ƒç”¨æ—¢å¯ä»¥æ˜¯å¯¹è±¡ï¼Œè¿˜å¯ä»¥æ˜¯ç±»å */ class Student { public void show() { System.out.println(\"show\"); } public static void show2() { System.out.println(\"show2\"); } } class StudentDemo2 { public static void main(String[] args) { Student s = new Student(); s.show(); s.show2(); Student.show2(); //Student.show();\u0026ensp; } } /* static çš„æ³¨æ„äº‹é¡¹ï¼š A: åœ¨é™æ€æ–¹æ³•ä¸­æ˜¯æ²¡æœ‰ this å…³é”®å­—çš„ å› ä¸ºé™æ€æ˜¯éšç€ç±»çš„åŠ è½½è€ŒåŠ è½½ï¼Œä¼˜å…ˆäºå¯¹è±¡è€Œå­˜åœ¨ã€‚è€Œ this æ˜¯éšç€å¯¹è±¡çš„åˆ›å»ºè€Œå­˜åœ¨ã€‚ å…ˆè¿›å†…å­˜çš„ï¼Œ ä¸èƒ½è®¿é—®åè¿›å†…å­˜çš„ï¼›è€Œåè¿›å†…å­˜çš„ï¼Œå¯ä»¥è®¿é—®å…ˆè¿›å†…å­˜çš„ã€‚ B: é™æ€åªèƒ½è®¿é—®é™æ€ã€‚ éé™æ€çš„æˆå‘˜æ–¹æ³•ï¼š å¯ä»¥è®¿é—®é™æ€æˆå‘˜å˜é‡ï¼Œéé™æ€æˆå‘˜å˜é‡ï¼Œé™æ€æˆå‘˜æ–¹æ³•ï¼Œéé™æ€æˆå‘˜æ–¹æ³• é™æ€çš„æˆå‘˜æ–¹æ³•ï¼š åªèƒ½è®¿é—®é™æ€çš„æˆå‘˜å˜é‡ï¼Œé™æ€çš„æˆå‘˜æ–¹æ³• */ /* class Student { private String name; public static void setName(String name) {//\u0026ensp; é™æ€æ–¹æ³•ä¸èƒ½ç”¨ this this.name = name; } public void show() { System.out.println(name); } }*/ class Demo { int x = 10; static int y = 20; public void show() { System.out.println(x); System.out.println(y); } public static void show2() { //System.out.println(x);\u0026ensp; System.out.println(y);//âˆš } public void show3() { show(); show2(); } public static void show4() { //show(); åªèƒ½è®¿é—®é™æ€çš„æˆå‘˜æ–¹æ³• show2(); } } class StudentDemo3 { public static void main(String[] args) { //Student.setName(\"æ—é’éœ\"); } } ","date":"2019-01-15","objectID":"/posts/duixiang/:0:13","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"é™æ€æˆå‘˜å˜é‡å’Œæ™®é€šæˆå‘˜å˜é‡çš„åŒºåˆ«ï¼ˆç†è§£ï¼‰ æ‰€å±ä¸åŒ é™æ€å±äºç±»çš„ï¼Œç§°ä¸ºç±»å˜é‡ éé™æ€å±äºå¯¹è±¡çš„ï¼Œç§°ä¸ºå¯¹è±¡å˜é‡ï¼Œå®ä¾‹å˜é‡ å†…å­˜ç©ºé—´ä¸åŒ é™æ€åœ¨æ–¹æ³•åŒºçš„é™æ€åŒº éé™æ€åœ¨å †å†…å­˜ ç”Ÿå‘½å‘¨æœŸä¸åŒ é™æ€éšç€ç±»çš„åŠ è½½è€ŒåŠ è½½ï¼Œéšç€ç±»çš„æ¶ˆå¤±è€Œæ¶ˆå¤± éé™æ€éšç€å¯¹è±¡çš„åˆ›å»ºè€Œå­˜åœ¨ï¼Œéšç€å¯¹è±¡çš„æ¶ˆå¤±è€Œæ¶ˆå¤± è°ƒç”¨ä¸åŒ é™æ€å¯ä»¥é€šè¿‡ç±»åè°ƒç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¯¹è±¡åè°ƒç”¨ã€‚å»ºè®®é€šè¿‡ç±»åè°ƒç”¨ éé™æ€åªèƒ½é€šè¿‡å¯¹è±¡åè°ƒç”¨ ","date":"2019-01-15","objectID":"/posts/duixiang/:0:14","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"main æ–¹æ³•æ˜¯é™æ€çš„ï¼ˆç†è§£ï¼‰ public static void main(String[] args) public: è®¿é—®æƒé™ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤ºæœ€å¤§çš„è®¿é—®æƒé™ï¼Œè¢« jvm è°ƒç”¨ï¼Œæ‰€æœ‰æƒé™è¦å¤Ÿå¤§ã€‚ static: è¢« jvm è°ƒç”¨ï¼Œä¸ç”¨åˆ›å»ºå¯¹è±¡ï¼Œç›´æ¥ç±»åè®¿é—® void: è¢« jvm è°ƒç”¨ï¼Œä¸éœ€è¦ç»™ jvm è¿”å›å€¼ main: ä¸€ä¸ªé€šç”¨çš„åç§°ï¼Œè™½ç„¶ä¸æ˜¯å…³é”®å­—ï¼Œä½†æ˜¯è¢« jvm è¯†åˆ« String[] args: æ—©æœŸå‡ºç°æ˜¯ä¸ºäº†æ¥æ”¶é”®ç›˜å½•å…¥æ•°æ®çš„ã€‚ ","date":"2019-01-15","objectID":"/posts/duixiang/:0:15","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"å®ä¾‹ /*æ±‚å’Œ*/ class Demo { private int x; private int y; public Demo() {} public Demo(int x,int y) { this.x = x; this.y = y; } public void setX(int x) { this.x = x; } public int getX() { return x; } public void setY(int y) { this.y = y; } public int getY() { return y; } //æˆå‘˜å˜é‡å·²ç»æœ‰ x,y äº†ã€‚è¿™é‡Œå°±æ²¡æœ‰å¿…è¦åœ¨å®šä¹‰äº† /* public int sum(int x,int y) { return x + y; } */ public int sum() { return x + y; } } class Test { public static void main(String[] args) { Demo d = new Demo(); d.setX(10); d.setY(20); int result = d.sum(); System.out.println(result); } } /*æ±‚å’Œ*/ class Demo { public int sum(int x,int y) { return x + y; } } class Test2 { public static void main(String[] args) { Demo d = new Demo(); int result = d.sum(10,20); System.out.println(result); } } /* å®šä¹‰ä¸€ä¸ªå‘˜å·¥ç±»ï¼Œè‡ªå·±åˆ†æå‡ºå‡ ä¸ªæˆå‘˜ï¼Œ ç„¶åç»™å‡ºæˆå‘˜å˜é‡ï¼Œæ„é€ æ–¹æ³•ï¼ŒgetXxx()/setXxx() æ–¹æ³•ï¼Œ ä»¥åŠä¸€ä¸ªæ˜¾ç¤ºæ‰€æœ‰æˆå‘˜ä¿¡æ¯çš„æ–¹æ³•ã€‚å¹¶æµ‹è¯•ã€‚ Employeeï¼š æˆå‘˜å˜é‡ï¼šå‘˜å·¥ç¼–å·ï¼Œå§“åï¼ŒèŒä½ æ„é€ æ–¹æ³•ï¼šæ— å‚ï¼Œå¸¦å‚ æˆå‘˜æ–¹æ³•ï¼šgetXxx()/setXxx() æ–¹æ³•ï¼Œshow() */ class Employee { private String eid; private String name; private String job; public Employee() {} public Employee(String eid,String name,String job) { this.eid = eid; this.name = name; this.job = job; } public void setEid(String eid) { this.eid = eid; } public String getEid() { return eid; } public void setName(String name) { this.name = name; } public String getName() { return name; } public void setJob(String job) { this.job = job; } public String getJob() { return job; } public void show() { System.out.println(\"å‘˜å·¥ç¼–å·æ˜¯ï¼š\"+eid+\", å§“åæ˜¯ï¼š\"+name+\", èŒä½æ˜¯ï¼š\"+job); } } class EmployeeDemo { public static void main(String[] args) { //æ— å‚ Employee e = new Employee(); e.setEid(\"itcast007\"); e.setName(\"å‘¨æ˜Ÿé©°\"); e.setJob(\"é«˜çº§å·¥ç¨‹å¸ˆ\"); e.show(); //å¸¦å‚ Employee e2 = new Employee(\"itcast003\",\"åˆ˜å¾·å\",\"æŒ–æ˜æœºå·¥ç¨‹å¸ˆ\"); e2.show(); } } ","date":"2019-01-15","objectID":"/posts/duixiang/:0:16","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":"java ç±»ä¸­çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•è®¿é—®æƒé™ å…³é”®è¯ åŒä¸€ä¸ªç±» åŒä¸€ä¸ªåŒ… ä¸åŒåŒ…ä¸­çš„å­ç±» ä¸åŒåŒ…ä¸­çš„éå­ç±» private âˆš default âˆš âˆš protected âˆš âˆš âˆš public âˆš âˆš âˆš âˆš ","date":"2019-01-15","objectID":"/posts/duixiang/:0:17","tags":["é¢å‘å¯¹è±¡","Java"],"title":"é¢å‘å¯¹è±¡åŸºç¡€çŸ¥è¯†æ€»ç»“","uri":"/posts/duixiang/"},{"categories":["Java"],"content":" æ°´ä»™èŠ±æ•°ï¼ˆNarcissistic numberï¼‰ä¹Ÿè¢«ç§°ä¸ºè¶…å®Œå…¨æ•°å­—ä¸å˜æ•°ï¼ˆpluperfect digital invariant, PPDIï¼‰ã€è‡ªæ‹æ•°ã€è‡ªå¹‚æ•°ã€é˜¿å§†æ–¯å£®æ•°æˆ–é˜¿å§†æ–¯ç‰¹æœ—æ•°ï¼ˆArmstrong numberï¼‰ï¼Œæ°´ä»™èŠ±æ•°æ˜¯æŒ‡ä¸€ä¸ª 3 ä½æ•°ï¼Œå®ƒçš„æ¯ä¸ªä½ä¸Šçš„æ•°å­—çš„ 3 æ¬¡å¹‚ä¹‹å’Œç­‰äºå®ƒæœ¬èº«ï¼ˆä¾‹å¦‚ï¼š1^3 + 5^3+ 3^3 = 153ï¼‰ã€‚ ","date":"2019-01-14","objectID":"/posts/java-range/:0:0","tags":["æ°´ä»™èŠ±æ•°","Java"],"title":"java æ°´ä»™èŠ±æ•°ï¼ˆå¾ªç¯ï¼‰","uri":"/posts/java-range/"},{"categories":["Java"],"content":"å®šä¹‰ æ°´ä»™èŠ±æ•°åªæ˜¯è‡ªå¹‚æ•°çš„ä¸€ç§ï¼Œä¸¥æ ¼æ¥è¯´ 3 ä½æ•°çš„ 3 æ¬¡å¹‚æ•°æ‰ç§°ä¸ºæ°´ä»™èŠ±æ•°ã€‚ é™„ï¼šå…¶ä»–ä½æ•°çš„è‡ªå¹‚æ•°åå­— ä¸€ä½è‡ªå¹‚æ•°ï¼šç‹¬èº«æ•° ä¸¤ä½è‡ªå¹‚æ•°ï¼šæ²¡æœ‰ ä¸‰ä½è‡ªå¹‚æ•°ï¼šæ°´ä»™èŠ±æ•° å››ä½è‡ªå¹‚æ•°ï¼šå››å¶ç«ç‘°æ•° äº”ä½è‡ªå¹‚æ•°ï¼šäº”è§’æ˜Ÿæ•° å…­ä½è‡ªå¹‚æ•°ï¼šå…­åˆæ•° ä¸ƒä½è‡ªå¹‚æ•°ï¼šåŒ—æ–—ä¸ƒæ˜Ÿæ•° å…«ä½è‡ªå¹‚æ•°ï¼šå…«ä»™æ•° ä¹ä½è‡ªå¹‚æ•°ï¼šä¹ä¹é‡é˜³æ•° åä½è‡ªå¹‚æ•°ï¼šåå…¨åç¾æ•° package xunhuan; import java.util.Scanner; public class shuixianhua { public static void main(String[] agrs) { System.out.print(\"æŒ‡å®šæœ€å¤§ä½æ•° N:\"); Scanner input = new Scanner(System.in); int N = input.nextInt(); input.close(); for (int i = 3; i \u003c= N; i++) { int a[] = new int[i]; int num = (int) Math.pow(10, i - 1) + 1; System.out.print(i + \"ä½çš„æ°´ä»™èŠ±æ•°æœ‰ï¼š\\t\"); while (num \u003c= Math.pow(10, i)) { int sum = 0; for (int j = 0; j \u003c i; j++) a[j] = (int) (num / Math.pow(10, j) % 10);//å–å„ä¸ªä½çš„æ•° for (int j = 0; j \u003c i; j++) sum = sum + (int) Math.pow(a[j], i); if (num == sum) System.out.print(num + \"\\t\"); num++; } System.out.print(\"\\n\"); } } } ç”±äº int ç²¾åº¦é™åˆ¶ï¼Œæœ€å¤šç®—åˆ° 9 ä½ï¼Œè€Œä¸”ä½¿ç”¨å¸¸è§„ç®—æ³•ï¼Œç®—åˆ° 8ï¼Œ9 ä½çš„æ—¶å€™å°±ç‰¹åˆ«æ…¢äº†ã€‚ æŒ‡å®šæœ€å¤§ä½æ•° N:10 3 ä½çš„æ°´ä»™èŠ±æ•°æœ‰ï¼š 153 370 371 407 4 ä½çš„æ°´ä»™èŠ±æ•°æœ‰ï¼š 1634 8208 9474 5 ä½çš„æ°´ä»™èŠ±æ•°æœ‰ï¼š 54748 92727 93084 6 ä½çš„æ°´ä»™èŠ±æ•°æœ‰ï¼š 548834 7 ä½çš„æ°´ä»™èŠ±æ•°æœ‰ï¼š 1741725 4210818 9800817 9926315 8 ä½çš„æ°´ä»™èŠ±æ•°æœ‰ï¼š 24678050 24678051 88593477 9 ä½çš„æ°´ä»™èŠ±æ•°æœ‰ï¼š 146511208 ","date":"2019-01-14","objectID":"/posts/java-range/:0:1","tags":["æ°´ä»™èŠ±æ•°","Java"],"title":"java æ°´ä»™èŠ±æ•°ï¼ˆå¾ªç¯ï¼‰","uri":"/posts/java-range/"},{"categories":["Java"],"content":"è®°å¿†æ ¼å¼ï¼š (1) å¯¼åŒ…ï¼š import java.util.Scanner; æ³¨æ„ï¼šä½ç½®åœ¨ class çš„ä¸Šé¢ã€‚ (2) åˆ›å»ºé”®ç›˜å½•å…¥å¯¹è±¡ï¼š Scanner sc = new Scanner(System.in); (3) è·å–æ•°æ® int i = sc.nextInt(); (4) ç»ƒä¹ ï¼š A: æ±‚ä¸¤ä¸ªæ•°æ®çš„å’Œ B: è·å–ä¸¤ä¸ªæ•°æ®ä¸­è¾ƒå¤§çš„å€¼ C: è·å–ä¸‰ä¸ªæ•°æ®ä¸­è¾ƒå¤§çš„å€¼ D: æ¯”è¾ƒä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ ","date":"2019-01-14","objectID":"/posts/java-input/:0:1","tags":["Java"],"title":"java å½•å…¥æ•°æ®","uri":"/posts/java-input/"},{"categories":["Java"],"content":"å®ä¾‹ package helloworld; import java.util.Scanner; public class helloworld { public static void main(String[] args) { Scanner sc = new Scanner(System.in); int i=sc.nextInt(),j=sc.nextInt(),k=sc.nextInt(); sc.close(); System.out.println(i+\"+\"+j+\"=\"+(i+j)); System.out.println(\"MAXij=\"+Max(i,j)); System.out.println(\"MAXijk=\"+Max(i,j,k)); } //Max() æ–¹æ³•é‡è½½ static int Max(int i,int j) { return i\u003ej?i:j; } static int Max(int i,int j,int k) { if(i==j) System.out.println(\"i å’Œ j ç›¸ç­‰\"); else if(i==k) System.out.println(\"i å’Œ k ç›¸ç­‰\"); else if(j==k) System.out.println(\"j å’Œ k ç›¸ç­‰\"); return (i=i\u003ej?i:j)\u003ek?i:k; } } ç»“æœ 5 5 6 5+5=10 MAXij=5 i å’Œ j ç›¸ç­‰ MAXijk=6 ","date":"2019-01-14","objectID":"/posts/java-input/:0:2","tags":["Java"],"title":"java å½•å…¥æ•°æ®","uri":"/posts/java-input/"},{"categories":["Java"],"content":"æ ‡è¯†ç¬¦ï¼š ç»™ç±»ï¼Œæ¥å£ï¼Œæ–¹æ³•æˆ–è€…å˜é‡èµ·åå­—çš„ç¬¦å· ","date":"2019-01-14","objectID":"/posts/biaoshi/:0:1","tags":["Java"],"title":"java æ ‡è¯†ç¬¦","uri":"/posts/biaoshi/"},{"categories":["Java"],"content":"ç»„æˆè§„åˆ™ï¼š A: è‹±æ–‡å­—æ¯å¤§å°å†™ B: æ•°å­— C:_å’Œ$ ","date":"2019-01-14","objectID":"/posts/biaoshi/:0:2","tags":["Java"],"title":"java æ ‡è¯†ç¬¦","uri":"/posts/biaoshi/"},{"categories":["Java"],"content":"æ³¨æ„äº‹é¡¹ï¼š A: ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ B: ä¸èƒ½æ˜¯ Java ä¸­çš„å…³é”®å­— C: åŒºåˆ†å¤§å°å†™ Student,student è¿™æ˜¯ä¸¤ä¸ªåç§° ","date":"2019-01-14","objectID":"/posts/biaoshi/:0:3","tags":["Java"],"title":"java æ ‡è¯†ç¬¦","uri":"/posts/biaoshi/"},{"categories":["Java"],"content":"å¸¸è§å‘½åæ–¹å¼ï¼š A: åŒ… å…¶å®å°±æ˜¯æ–‡ä»¶å¤¹ï¼Œç”¨äºè§£å†³ç›¸åŒç±»åé—®é¢˜ å…¨éƒ¨å°å†™ å•çº§ï¼šcom å¤šçº§ï¼šcn.itcast B: ç±»æˆ–è€…æ¥å£ ä¸€ä¸ªå•è¯ï¼šé¦–å­—æ¯å¤§å†™ Student,Person,Teacher å¤šä¸ªå•è¯ï¼šæ¯ä¸ªå•è¯çš„é¦–å­—æ¯å¤§å†™ HelloWorld,MyName,NameDemo C: æ–¹æ³•æˆ–è€…å˜é‡ ä¸€ä¸ªå•è¯ï¼šå…¨éƒ¨å°å†™ name,age,show() å¤šä¸ªå•è¯ï¼šä»ç¬¬äºŒä¸ªå•è¯å¼€å§‹ï¼Œæ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™ myName,showAllStudentNames() D: å¸¸é‡ ä¸€ä¸ªå•è¯ï¼šå…¨éƒ¨å¤§å†™ AGE å¤šä¸ªå•è¯ï¼šæ¯ä¸ªå•è¯éƒ½å¤§å†™ï¼Œç”¨_è¿æ¥ STUDENT_MAX_AGE ","date":"2019-01-14","objectID":"/posts/biaoshi/:0:4","tags":["Java"],"title":"java æ ‡è¯†ç¬¦","uri":"/posts/biaoshi/"},{"categories":["Study"],"content":"å¸¸è§æƒ…å†µ ","date":"2019-01-12","objectID":"/posts/subject-verb/:1:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"ç”± and æˆ– both and è¿æ¥çš„å¹¶åˆ—ä¸»è¯­ï¼Œè°“è¯­åŠ¨è¯ä¸€èˆ¬ç”¨å¤æ•° English and chinese are two quite different languages. Both brother and sister tire of city life. ","date":"2019-01-12","objectID":"/posts/subject-verb/:1:1","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"ä¸€ä½†ä¸»è¯­å‰è¢« no,every,each æ‰€ä¿®é¥°æ—¶ï¼Œè°“è¯­åŠ¨è¯ç”¨å•æ•° No desk and (no) chair is seen in the hall. All work and no play makes Jack a dull boy. They each have been to the Forbidden city. each ä½äºä¸»è¯­åï¼Œæ‰€ä»¥è°“è¯­åŠ¨è¯ç”¨å¤æ•° ","date":"2019-01-12","objectID":"/posts/subject-verb/:1:2","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"å½“ä¸»è¯­è¡¨ç¤ºåŒä¸€äº‹ç‰©çš„ä¸¤ä¸ªéƒ¨åˆ†ï¼ŒåŒä¸€ä¸ªäººçš„ä¸¤ä¸ªèº«ä»½ï¼ˆç¬¬äºŒä¸ªåè¯å‰æ— å† è¯ï¼‰ï¼Œè°“è¯­åŠ¨è¯ç”¨å•æ•° æ¯”å¦‚ theï¼ˆaï¼‰horse and cart a watch and chain a knife and fork a cup and soucer the butter and bread The horse and cart has fallen down the cliffï¼ˆæ‚¬å´–ï¼‰. Butter and bread is his favourate. The poetï¼ˆè¯—äººï¼‰ and writer has been sentencedï¼ˆåˆ¤å†³ï¼‰ to death. The poet and the writer have been sentencedï¼ˆåˆ¤å†³ï¼‰ to death. ","date":"2019-01-12","objectID":"/posts/subject-verb/:1:3","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"ä¸¤æ•°ç›¸åŠ æˆ–ç›¸ä¹˜ï¼Œå•å¤çš†å¯ï¼Œç›¸å‡æˆ–ç›¸é™¤ï¼Œåªèƒ½ç”¨å•æ•°ï¼Œé‡è¯åšä¸»è¯­ï¼Œç”¨å•æ•° ç­‰äºï¼š be,equal,be equal to,make ç›¸åŠ ï¼š and,plus ç›¸å‡ï¼š minus ç›¸ä¹˜ï¼š multily,time ç›¸é™¤ï¼š divided by One and one make(makes) two. ","date":"2019-01-12","objectID":"/posts/subject-verb/:1:4","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"å°±è¿‘åŸåˆ™ not onlyâ€¦but also there/here be or,nor,eitherâ€¦or,neitherâ€¦nor,notâ€¦but There is a desk and two chairs in the room. Are you or your sister fond of classical music? An apple or two lies on the desk.ï¼ˆæ•°é‡è¯åç”¨å•æ•°ï¼‰ One or two apples lie on the desk. Not he but you have come. ","date":"2019-01-12","objectID":"/posts/subject-verb/:2:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"å°±è¿œåŸåˆ™ ä¸¤å•ä½“ä¸¤ç»“æ„ä¸‰ with å››é™¤å¤– like,including rather than,as well as with,together with,along with except,besides,but,in addition to The couple in addition to their child are mean. Lauren,rather than anyone else was chose his partener. A library together with 3000 books was destroyed in the fire. ","date":"2019-01-12","objectID":"/posts/subject-verb/:3:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"æ—¶é—´ï¼Œé‡‘é’±ï¼Œè·ç¦»ï¼Œæ¸©åº¦ï¼Œå¤©æ°”ï¼Œé‡é‡ç­‰ä¸å¯æ•°åè¯ï¼Œto do,doing, ä»å¥åšä¸»è¯­æ—¶ï¼Œè°“ v ç”¨å•æ•° To go to bed early and rise early is a good habit. What he says and behaives doesnâ€™t concern me. ","date":"2019-01-12","objectID":"/posts/subject-verb/:4:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"åˆ†æ•°ï¼Œç™¾åˆ†æ•°ï¼Œthe rest(+of+n) åšä¸»è¯­ï¼Œç”¨å•æ•° è°“è¯­åŠ¨è¯ç”± of åé¢çš„åè¯å†³å®šï¼Œä¸€èˆ¬ç”¨å•æ•°ã€‚ åˆ†æ•°ç”¨æ³•ï¼š é€šå¸¸åˆ†å­è¯»åŸºæ•°ï¼Œåˆ†æ¯è¯»åºæ•°ï¼Œåˆ†å­è¶…è¿‡ 1 æ—¶ï¼Œåˆ†æ¯åŠ  sã€‚å³ åŸº+åº (s)+of+n+è°“ Most students are in favaour of the contractï¼ˆå¥‘çº¦ï¼‰ but the rest disagree. be favaour of: be for,approve of,support,agree with About two thirds of the earthâ€™s surface is covered by water. ","date":"2019-01-12","objectID":"/posts/subject-verb/:5:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"ä¸€äº›çŸ­è¯­ one of+n æˆ– the only one of+n, ä¸€èˆ¬ç”¨å•æ•°ï¼ˆå®šä»æ ¹æ®ä¸­å¿ƒè¯åœ¨ of å‰åï¼‰ a number of+nï¼ˆç”¨å¤æ•°ï¼‰ \u0026 the number of+nï¼ˆç”¨å•æ•°ï¼‰ one in æˆ– one out of+n ï¼ˆç”¨å•æ•°ï¼‰ a large quantity of \u0026 large quantity of + å¯ã€ä¸å¯æ•° n a large amount of \u0026 large amounts of + ä¸å¯æ•° n He is one of the students who were awarded the other day. He is the only one of the students who was awarded the other day. One of his family was a traitorï¼ˆå–å›½è´¼ï¼Œå›å¾’ï¼‰ during the world war two. A number of teenagers are addicted to the Internet. The number of students who are addicted to the Internet is up toï¼ˆæ¥è¿‘äºï¼‰ 15. Large amounts of power are foused on him alone.==a large amount of power is foused on him alone. ","date":"2019-01-12","objectID":"/posts/subject-verb/:6:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"ä¸å®šä»£è¯åšä¸»è¯­ï¼Œè°“è¯­åŠ¨è¯ç”¨å•æ•° all ä¿®é¥°äººï¼Œè°“è¯­åŠ¨è¯ç”¨å¤æ•°ï¼Œä¿®é¥°ç‰©ï¼Œè°“è¯­åŠ¨è¯ç”¨å•æ•° All are present besides the professor. All that glittersï¼ˆå‘å…‰ä½“ï¼‰ is not gold. not ä¸ all/both ç­‰è¿ç”¨è¡¨éƒ¨åˆ†å¦å®š ","date":"2019-01-12","objectID":"/posts/subject-verb/:7:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"the +adj è¡¨ä¸€ç±»äººåšä¸»è¯­æ—¶ï¼Œè°“è¯­åŠ¨è¯ç”¨å¤æ•° The injured are taken good care of in hospital. The agreeable is not always the useful.ï¼ˆä¸è¡¨äººï¼‰ ","date":"2019-01-12","objectID":"/posts/subject-verb/:8:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"æˆåŒæˆå¯¹çš„è¯åšä¸»è¯­ï¼Œç”¨å¤æ•° trousersï¼ˆè£¤å­ï¼‰,chopsticks,scissorsï¼ˆå‰ªåˆ€ï¼‰,glasses Pants are what I want. The pair of glasses seems expensive.ï¼ˆè°“è¯­åŠ¨è¯ä¸è¡¨ç¤ºè®¡é‡å•ä½çš„åè¯å½¢å¼ä¸€è‡´ï¼‰ Three set of fashionable socks are shown in todayâ€™s evening properï¼ˆæ°å½“åœ°ï¼‰. ä¸€ç³»åˆ—ï¼š a piece/pair/set/suit/series of ","date":"2019-01-12","objectID":"/posts/subject-verb/:9:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"ä»¥ s ç»“å°¾ç‰¹æ®Šä¸“ç”¨åè¯ï¼Œç”¨å•æ•° è¡¨å­¦ç§‘ï¼Œç–¾ç—…ï¼Œå±±è„‰ï¼Œæ²³æµï¼Œä¹¦åï¼Œæ­Œåï¼Œæ ¼è¨€ç­‰ maths,physicsaï¼ˆç‰©ç†ï¼‰,politicsï¼ˆæ”¿æ²»ï¼‰,classics,economics,Aids,SARs,diabetesï¼ˆç³–å°¿ç—…ï¼‰,arthritisï¼ˆå…³èŠ‚ç‚ï¼‰,bronchitisï¼ˆæ”¯æ°”ç®¡ç‚ï¼‰,Himalayas,Arabian Night Arabian Night sounds beautiful. ","date":"2019-01-12","objectID":"/posts/subject-verb/:10:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"many a +å• n+å•è°“ï¼š â€œè®¸å¤šâ€ more than one +å• n+å•è°“ï¼š â€œä¸æ­¢ä¸€ä¸ªâ€ Many a man thinks life is meaningless without a purpose/an aim. More than one student has put forward the suggestion. More students than one are against the proposal. More than 20% students were absent at the meeting yesterday.ï¼ˆä¸æ­¢ï¼‰ ","date":"2019-01-12","objectID":"/posts/subject-verb/:11:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"police,people,cattle åšä¸»è¯­ï¼Œç”¨å¤æ•° It is reported that police are trying their best to capture the murder. ","date":"2019-01-12","objectID":"/posts/subject-verb/:12:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"the Olympics \u0026 the Olympic games The Olympices is hold every four years. == The Olympic games are hold every four year. ","date":"2019-01-12","objectID":"/posts/subject-verb/:13:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"é›†ä½“åè¯åšä¸»è¯­ï¼Œè¡¨æ•´ä½“ç”¨å•æ•°ï¼Œè¡¨æˆå‘˜ç”¨å¤æ•° family,class,group,team,army,public,crew,population The innovation experimentï¼ˆé©æ–°å®éªŒï¼‰ class consists of 24 students and enjoy chinese. Population in China is 1.4 billion or so(about) 20% (Population) have no access to clean water. ","date":"2019-01-12","objectID":"/posts/subject-verb/:14:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"å•å¤åŒå½¢ï¼Œsheep,deer,means,Chinese ç­‰è°“è¯­åŠ¨è¯ä¾æ®æƒ…å†µè€Œå®š Many deer live on the African grassland. ","date":"2019-01-12","objectID":"/posts/subject-verb/:15:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"åœ°ç‚¹çŠ¶è¯­ä½äºå¥é¦– Among the crow stand his parents. On the wall hangs an alarm clock. ","date":"2019-01-12","objectID":"/posts/subject-verb/:16:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":"â€œofâ€: of è¡¨æ‰€å±æ—¶ï¼Œä¸­å¿ƒè¯åœ¨ of ä¹‹å‰ï¼Œè°“è¯­åŠ¨è¯ç”±ä¸­å¿ƒè¯å†³å®šï¼Œç‰¹ä¾‹é™¤å¤–ã€‚ ","date":"2019-01-12","objectID":"/posts/subject-verb/:17:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--ä¸»è°“ä¸€è‡´","uri":"/posts/subject-verb/"},{"categories":["Study"],"content":" å½¢å¼å€’è£…ï¼Œå¥å­æœ¬ä¸æ˜¯æœ¬æ¥çš„è¯­åºã€‚ ","date":"2018-12-10","objectID":"/posts/inversion-3/:0:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--å½¢å¼å€’è£…","uri":"/posts/inversion-3/"},{"categories":["Study"],"content":"may ä½äºå¥é¦–ï¼Œæ ‡ç¥æ„¿ ä¾‹å¥ May you succeed. May you have a happy holiday. Long live chairman Mao.ï¼ˆæ¯›ä¸»å¸­ä¸‡å¤é•¿é’ï¼‰ ","date":"2018-12-10","objectID":"/posts/inversion-3/:0:1","tags":["English"],"title":"è‹±è¯­è¯­æ³•--å½¢å¼å€’è£…","uri":"/posts/inversion-3/"},{"categories":["Study"],"content":"whatever ç›´æ¥åšæˆåˆ†æˆ–æ”¾åœ¨åè¯ä¹‹å‰ï¼Œhowever æ”¾åœ¨ adv,adj ä¹‹å‰æˆ– many,much ç­‰è¯ä¹‹å‰ ä¾‹å¥ Whatever the weather is,he sticks outï¼ˆåšæŒï¼‰ walking outside. Go to stamp sales and buy whatever you can offord. Whatever reasons you have,you should carry out your promise. However many difficulties(n.) you meet with,you should try to overcome them. Whatever difficulties(n.) you meet with,you should try to overcome them. However difficult(adj.) the problem is,we must work it out today. ","date":"2018-12-10","objectID":"/posts/inversion-3/:0:2","tags":["English"],"title":"è‹±è¯­è¯­æ³•--å½¢å¼å€’è£…","uri":"/posts/inversion-3/"},{"categories":["Study"],"content":"the + æ¯”è¾ƒçº§ï¼Œthe + æ¯”è¾ƒçº§ --\u003eâ€œè¶Š â€¦ è¶Š â€¦â€ ä¾‹å¥ The hander you study,the greater progress you will make. The more you listen to English,the easier it becomes. The older you grow,the more challenges you will meet. ","date":"2018-12-10","objectID":"/posts/inversion-3/:0:3","tags":["English"],"title":"è‹±è¯­è¯­æ³•--å½¢å¼å€’è£…","uri":"/posts/inversion-3/"},{"categories":["Study"],"content":"æ„Ÿå¹å¥ ä¾‹å¥ What an interesting talk they had! How interesting the talk was! ","date":"2018-12-10","objectID":"/posts/inversion-3/:0:4","tags":["English"],"title":"è‹±è¯­è¯­æ³•--å½¢å¼å€’è£…","uri":"/posts/inversion-3/"},{"categories":["Study"],"content":" å®Œå…¨å€’è£…ï¼š æŠŠæ•´ä¸ªè°“è¯­åŠ¨è¯æ”¾åˆ°ä¸»è¯­å‰ã€‚ ","date":"2018-12-10","objectID":"/posts/inversion-2/:0:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--å®Œå…¨å€’è£…","uri":"/posts/inversion-2/"},{"categories":["Study"],"content":"è¡¨æ–¹ä½æˆ–æ—¶é—´çš„å‰¯è¯ (adv)ã€è¡¨åœ°ç‚¹çš„ä»‹è¯çŸ­è¯­ä½äºå¥é¦–æ—¶ ä¾‹å¥ Here comes the bus. In the lecture hall of a university sits a professor. Out rushed the children. Now comes your turn. Up jumped the cat and caught the mouse. Down came the rain and up went the umbrellas. Among the people stood his friend,Jim. (To be) South of the river lies a small factory. ä½†ä¸»è¯­ä¸ºè¡¨ç¤ºäººç§°çš„ä»£è¯æ—¶æ— éœ€å€’è£… Here are you.â€ƒAway it flew. ","date":"2018-12-10","objectID":"/posts/inversion-2/:0:1","tags":["English"],"title":"è‹±è¯­è¯­æ³•--å®Œå…¨å€’è£…","uri":"/posts/inversion-2/"},{"categories":["Study"],"content":"è¡¨è¯­ï¼ˆè¯/çŸ­è¯­ï¼‰ä½äºå¥é¦–æ—¶ï¼Œadj/doing/done ä¾‹å¥ Written on the blackboard are the name of these who were late. Gone are the days when we worked together. Standing at the tree is a shy girl with two big eges. Present(adj) at the conference were all leaders of this city. Lying on the grassland is the boy who was injured in the fire. ","date":"2018-12-10","objectID":"/posts/inversion-2/:0:2","tags":["English"],"title":"è‹±è¯­è¯­æ³•--å®Œå…¨å€’è£…","uri":"/posts/inversion-2/"},{"categories":["Study"],"content":"å­˜åœ¨å¥ there be ä¸­ï¼Œå…¶ä¸­ be -\u003eexist/arise/follow/enter/appear/live ç­‰è¡¨çŠ¶æ€ vi ä¾‹å¥ There come shows for help from the river. There seems something wrong with machine. There remains nothing to be done. There happened an event last week. ","date":"2018-12-10","objectID":"/posts/inversion-2/:0:3","tags":["English"],"title":"è‹±è¯­è¯­æ³•--å®Œå…¨å€’è£…","uri":"/posts/inversion-2/"},{"categories":["Study"],"content":" è™½ç„¶æˆ‘è‹±è¯­å››çº§æ²¡è¿‡ï¼Œè¯æ±‡é‡ä¹Ÿä¸å¾ˆå¤šï¼Œç”šè‡³ä¸‹é™äº†å¾ˆå¤šï¼Œä½†æ˜¯å¯¹äºè‹±è¯­çš„è¯­æ³•æˆ‘è¿˜æ˜¯å¾ˆå–œæ¬¢çš„ï¼Œé©¬ä¸Šå¿«å››çº§äº†åˆï¼Œå¤ä¹ æ•´ç†ä¸€ä¸‹ä»¥å‰çš„è¯­æ³•ç¬”è®°ã€‚ä»¥ä¸‹å†…å®¹çº¯æ‰‹æ‰“ï¼ï¼ å…ˆä»å€’è£…å¥å¼€å§‹å§ï¼åˆ†ä¸ºä¸‰å¤§ç±»ï¼Œéƒ¨åˆ†å€’è£…ï¼Œå®Œå…¨å€’è£…å’Œå½¢å¼å€’è£…ã€‚å…ˆå¤ä¹ ç¬¬ä¸€ç§ã€‚ éƒ¨åˆ†å€’è£…ï¼š æŠŠè°“è¯­åŠ¨è¯çš„ä¸€éƒ¨åˆ†ï¼ˆåŠ©åŠ¨è¯ï¼Œbe åŠ¨è¯ï¼Œæƒ…æ€åŠ¨è¯ï¼‰æåˆ°ä¸»è¯­å‰é¢ã€‚ ","date":"2018-12-08","objectID":"/posts/inversion-1/:0:0","tags":["English"],"title":"è‹±è¯­è¯­æ³•--éƒ¨åˆ†å€’è£…","uri":"/posts/inversion-1/"},{"categories":["Study"],"content":"xx ä¹Ÿå¦‚æ­¤ï¼Œxx ä¹Ÿä¸€æ · è¡¨ç¤ºå‰é¢çš„å†…å®¹ä¹Ÿé€‚ç”¨äºåè€…ï¼Œç”¨\"so/nor/neither + åŠ¨è¯ + ä¸»è¯­\"å¥å‹ã€‚è¡¨â€œxx ä¹Ÿå¦‚æ­¤ï¼Œxx ä¹Ÿä¸€æ ·â€ã€‚å¯ç”¨,ã€;ã€andéš”å¼€ï¼ˆæ³¨æ„æƒ…å½¢ï¼‰ã€‚ ä¾‹å¥ They love having lots of friends, so dothe disabled.ï¼ˆè¿™é‡Œthe + å½¢å®¹è¯è¡¨ä¸€ç±»äººï¼‰ I have had a new idea; so hasmy friends. Lily canâ€™t ride bicycle, nor/neither canlucy. The injured look disappointedï¼ˆæ²®ä¸§çš„ï¼‰, so didsenior citizens.ï¼ˆè€äººï¼‰ ï¼ˆå¦å®šå‰ç¼€è¯ â‰  å¦å®šï¼‰ If you arenâ€™t for the plan; nor/neither willI. , æˆ– ; å‰çš„å¥å­è‹¥ä¸ºä»å¥ï¼Œå…ˆå°†ä¸»å¥è¡¥å……å‡ºï¼Œå…¶åå†æ ¹æ®ä¸»å¥æ”¹ã€‚ è¿™é‡Œä¸»å¥åº”ä¸ºï¼š I will not be for the plan.(be for åŒæ„ï¼‰ It is burningï¼ˆç‡ƒçƒ§ï¼‰ hot today, so it isï¼ˆé‚£ç¡®å®ï¼‰ and/; so was (it)yesterday.ï¼ˆè¿™é‡Œåªç”¨ç”¨ and æˆ–ï¼›) Everyone is here and looks upset, so it is with Mary = it is the same withMary. è¿™ä¸ªå¥å‹åŒæ ·é€‚ç”¨äºå‰é¢çš„å…­ä¸ªä¾‹å­ï¼Œä½†æ˜¯å‰é¢æ˜¯å¹¶åˆ—å¥å¿…é¡»ç”¨è¿™ä¸ªå¥å‹ã€‚ The truth is that no one is perfect.When all potentialï¼ˆæ½œåœ¨çš„ï¼‰ for ugliness in removed, so is all of the potential for beauty. ","date":"2018-12-08","objectID":"/posts/inversion-1/:0:1","tags":["English"],"title":"è‹±è¯­è¯­æ³•--éƒ¨åˆ†å€’è£…","uri":"/posts/inversion-1/"},{"categories":["Study"],"content":"å¦å®šå‰¯è¯æˆ–å«æœ‰å¦å®šçš„ä»‹è¯çŸ­ä½äºå¥é¦– ä¾‹å¥ Neither does Mr.Green know the matterï¼ˆäº‹ä»¶ï¼‰ nor does he care about it. neitherâ€¦â€¦norâ€¦â€¦ æ—¢ä¸ä¹Ÿä¸â€ƒeitherâ€¦â€¦orâ€¦â€¦è¦ä¹ˆè¦ä¹ˆï¼Œä¸æ˜¯å°±æ˜¯ Not only did we lose our way but also (we) came close to losing our lives.(come close to æ¥è¿‘ï¼Œå·®ä¸€ç‚¹å°±ï¼‰ Not until I began to work hard did I realize how much time I had wasted. ä»å¥ä¸å€’è£…ï¼ŒåŸå¥ä¸ºï¼š I didnâ€™t realize how much time I had wasted until I began to work hard. No sooner had they arrived at the tomb than they fell ill.ï¼ˆä¸€â€¦â€¦å°±â€¦â€¦) In no case will we give up half-way. Hardly does Jim think it possible to finish the task before/when dark. hardlyâ€¦before/when ä¸€â€¦â€¦å°±â€¦â€¦ è¿™é‡Œå–\"å‡ ä¹ä¸\"é‡Šä¹‰åº”è¯¥æ›´åˆé€‚ã€‚ Not a (single) mistake has Mary made so far.ï¼ˆç›ä¸½åˆ°ç›®å‰ä¸ºæ­¢ä¸€ä¸ªé”™è¯¯ä¹Ÿæ²¡çŠ¯ã€‚) not a (single) + å•æ•°åè¯ è¡¨ç¤ºâ€œä¸€ä¸ªä¹Ÿæ²¡æœ‰â€%} In no timeï¼ˆç«‹åˆ»é©¬ä¸Šï¼‰ Jone worked out the figureï¼ˆä½“ç§¯ï¼‰. ï¼ˆæ— å¦å®šä¸å€’è£…ï¼‰ ","date":"2018-12-08","objectID":"/posts/inversion-1/:0:2","tags":["English"],"title":"è‹±è¯­è¯­æ³•--éƒ¨åˆ†å€’è£…","uri":"/posts/inversion-1/"},{"categories":["Study"],"content":"only + çŠ¶è¯­ä½äºå¥é¦– ä¾‹å¥ Only in this way are you able to do it well. å€’è£…å‰ï¼š You are able to do it well only in this way. Only when they returned home did they understand what had happened. Only on such a trip will you gain a better appreciationï¼ˆç†è§£ï¼‰ of Eurepean literature. Only the teacher got the news that our school could have a 4-day holiday.ï¼ˆåŒä½è¯­ä»å¥ï¼Œonly+ä¸»è¯­æ‰€ä»¥ä¸å€’è£…ï¼‰ ","date":"2018-12-08","objectID":"/posts/inversion-1/:0:3","tags":["English"],"title":"è‹±è¯­è¯­æ³•--éƒ¨åˆ†å€’è£…","uri":"/posts/inversion-1/"},{"categories":["Study"],"content":"So/Suchâ€¦thatâ€¦ å¥å‹ä½äºå¥é¦– So + adj + a/an + å•æ•°åè¯ = Such + a/an + adj + å•æ•°åè¯ å¦‚æ­¤ ... ä»¥è‡³äº ... so ä¾§é‡äº adj/advâ€ƒsuch ä¾§é‡äº n. æ¯”å¦‚ï¼Œso many/much/few/little ä¾‹å¥ So crowded was the art galleryï¼ˆå±•è§ˆä¼šï¼‰ that I couldnâ€™t move about (it). Such good weather was it that we all went out last week. Such a lovely girl is kate that everyone likes her. So loudly did he speak that even people next room could hear him. ","date":"2018-12-08","objectID":"/posts/inversion-1/:0:4","tags":["English"],"title":"è‹±è¯­è¯­æ³•--éƒ¨åˆ†å€’è£…","uri":"/posts/inversion-1/"},{"categories":["Study"],"content":"as å¼•å¯¼è®©æ­¥ç‹€è¯­ä»å¥ as å¼•å¯¼è®©æ­¥çŠ¶è¯­ä»å¥ï¼ˆè™½ç„¶ï¼Œå³ä½¿ï¼Œå°½ç®¡ï¼Œæ— è®ºï¼‰ï¼ŒæŠŠä»å¥ä¸­çš„è¡¨è¯­ï¼ŒåŠ¨è¯ï¼Œå‰¯è¯æè‡³å¥é¦– (as åä¸ç”¨å†å€’è£…äº†ï¼‰ï¼Œå½“è¡¨è¯­æ˜¯åè¯æ—¶ï¼Œæè‡³å¥é¦–æ—¶ä¸€å¾‹ç”¨é›¶å† è¯ï¼ˆå…¶ä¸­ as å¯ç”¨ though æ›¿ä»£ï¼Œå€’è£…åçœç•¥ but,though,however,even,though,although ç­‰ï¼‰ ä¾‹å¥ Child as he is,he knows a lot. Poor as King was,he tried his best to help others. Try as he may,he has never made his boss satisfied. Search as you would,you could find no body in the room. Much as I want to buy the car,I canâ€™t affordï¼ˆæ”¯ä»˜ï¼‰ it. ","date":"2018-12-08","objectID":"/posts/inversion-1/:0:5","tags":["English"],"title":"è‹±è¯­è¯­æ³•--éƒ¨åˆ†å€’è£…","uri":"/posts/inversion-1/"},{"categories":["Study"],"content":"æŠŠè™šæ‹Ÿè¯­æ°”ä»å¥ä¸­çš„ were,had,should æè‡³å¥é¦–ï¼Œå¹¶çœç•¥ if ä¾‹å¥ Had you followwed my advice,you couldnâ€™t have made such a silly mistake. Were you not a boy,you could wear a dress. Should he invite me,I might take part in this party. ","date":"2018-12-08","objectID":"/posts/inversion-1/:0:6","tags":["English"],"title":"è‹±è¯­è¯­æ³•--éƒ¨åˆ†å€’è£…","uri":"/posts/inversion-1/"},{"categories":["Study"],"content":"è¡¨è‚¯å®šå«ä¹‰çš„æ—¶é—´é¢‘ç‡è¯ä½äºå¥é¦– always,often,many a time(many times å¤šæ¬¡ï¼‰,every + æ—¶é—´ï¼Œnow and thenï¼ˆæ—¶ä¸æ—¶çš„ï¼‰ ä¾‹å¥ Many a time has he offered me some good suggestions. Now and then does my class teacher warn us not yo use cellphones in the classroom. ","date":"2018-12-08","objectID":"/posts/inversion-1/:0:7","tags":["English"],"title":"è‹±è¯­è¯­æ³•--éƒ¨åˆ†å€’è£…","uri":"/posts/inversion-1/"},{"categories":["Study"],"content":"ç–‘é—®å¥ç”¨éƒ¨åˆ†å€’è£… æ™®é€šçš„ç–‘é—®å¥ï¼š How do you do that? é™¤äº†ï¼š What is wrong? = What is the matter? â€¦ ","date":"2018-12-08","objectID":"/posts/inversion-1/:0:8","tags":["English"],"title":"è‹±è¯­è¯­æ³•--éƒ¨åˆ†å€’è£…","uri":"/posts/inversion-1/"},{"categories":["Memo"],"content":" 2021/10/2 æ›´æ–° åšå®¢å·²è¿ç§»è‡³ Hugo, æ’ä»¶æ¼”ç¤ºä¸é€‚ç”¨ï¼Œå·²åˆ é™¤ã€‚ è®©æ–‡ç« å†™çš„å¥½çœ‹åˆç®€æ´åˆå¥½ç”¨çš„æ’ä»¶ï¼hexo å®Œæ•´çš„æ ‡ç­¾åˆ—è¡¨ï¼Œnext æ’ä»¶åˆ—è¡¨ ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:0","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"hexo æ’ä»¶ hexo-lazyload-image npm install hexo-lazyload-image --save First add configuration in _config.yml from your hexo project. lazyload: enable: true onlypost: false loadingImg: # eg ./images/loading.gif hexo-ruby-marks ä¸æ”¯æŒrubyæ–°æ ‡ç­¾çš„æµè§ˆå™¨å°†æ˜¾ç¤ºrpä¸­çš„å†…å®¹ã€‚ \u003cruby\u003eåšæ¡çœ¾é•·\u003crp\u003eï¼ˆ\u003c/rp\u003e \u003crt\u003elruihao.cn\u003c/rt\u003e\u003crp\u003eï¼‰\u003c/rp\u003e\u003c/ruby\u003e åšæ¡çœ¾é•·ï¼ˆ lruihao.cnï¼‰ æ’ä»¶ä½¿ç”¨ npm i hexo-ruby-marks {% ruby _**base**_|_**top text**_ %} hexo-pwa npm install --save hexo-pwa You can configure this plugin in _config.yml.ï¼ˆé…ç½®å®Œå³å¯ä½¿ç”¨ä¸è®¸å•ç‹¬è®¾ç½®manifest.jsonæ–‡ä»¶åŠé…ç½®ï¼Œæ’ä»¶ç”Ÿæˆï¼‰ pwa: manifest: path: /manifest.json body: name: hexo short_name: hexo icons: - src: /images/android-chrome-192x192.png sizes: 192x192 type: image/png - src: /images/android-chrome-512x512.png sizes: 512x512 type: image/png start_url: /index.html theme_color: '#ffffff' background_color: '#ffffff' display: standalone serviceWorker: path: /sw.js preload: urls: - / posts: 5 opts: networkTimeoutSeconds: 5 routes: - pattern: !!js/regexp /hm.baidu.com/ strategy: networkOnly - pattern: !!js/regexp /.*\\.(js|css|jpg|jpeg|png|gif)$/ strategy: cacheFirst - pattern: !!js/regexp /\\// strategy: networkFirst priority: 5 hexo-tag-dplayer hexo-tag-dplayer npm install hexo-tag-dplayer --save {% dplayer key=value ... %} key can be dplayer options: 'autoplay', 'loop', 'screenshot', 'hotkey', 'mutex', 'dmunlimited' : bool options, use \"yes\" \"y\" \"true\" \"1\" \"on\" or just without value to enable 'preload', 'theme', 'lang', 'logo', 'url', 'pic', 'thumbnails', 'vidtype', 'suburl', 'subtype', 'subbottom', 'subcolor', 'subcolor', 'id', 'api', 'token', 'addition', 'dmuser' : string arguments 'volume', 'maximum' : number arguments container options: 'width', 'height' : string, used in container element style other: 'code' : value of this key will be append to script tag {% dplayer \"url=https://moeplayer.b0.upaiyun.com/dplayer/hikarunara.mp4\" \"addition=https://dplayer.daoapp.io/bilibili?aid=4157142\" \"api=https://api.prprpr.me/dplayer/\" \"pic=https://moeplayer.b0.upaiyun.com/dplayer/hikarunara.jpg\" \"id=9E2E3368B56CDBB4\" \"loop=yes\" \"theme=#FADFA3\" \"autoplay=false\" \"token=tokendemo\" %} hexo-tag-aplayer more npm install --save hexo-tag-aplayer {% aplayer title author url [picture_url, narrow, autoplay, width:xxx, lrc:xxx] %} æ ‡ç­¾å‚æ•° title : æ›²ç›®æ ‡é¢˜ author: æ›²ç›®ä½œè€… url: éŸ³ä¹æ–‡ä»¶ URL åœ°å€ picture_url: ï¼ˆå¯é€‰ï¼‰ éŸ³ä¹å¯¹åº”çš„å›¾ç‰‡åœ°å€ narrow: ï¼ˆå¯é€‰ï¼‰æ’­æ”¾å™¨è¢–çé£æ ¼ autoplay: ï¼ˆå¯é€‰ï¼‰ è‡ªåŠ¨æ’­æ”¾ï¼Œç§»åŠ¨ç«¯æµè§ˆå™¨æš‚æ—¶ä¸æ”¯æŒæ­¤åŠŸèƒ½ width:xxx: ï¼ˆå¯é€‰ï¼‰ æ’­æ”¾å™¨å®½åº¦ ï¼ˆé»˜è®¤ï¼š100%) lrc:xxx: ï¼ˆå¯é€‰ï¼‰æ­Œè¯æ–‡ä»¶ URL åœ°å€ å½“å¼€å¯ Hexo çš„ æ–‡ç« èµ„æºæ–‡ä»¶å¤¹ åŠŸèƒ½æ—¶ï¼Œå¯ä»¥å°†å›¾ç‰‡ã€éŸ³ä¹æ–‡ä»¶ã€æ­Œè¯æ–‡ä»¶æ”¾å…¥ä¸æ–‡ç« å¯¹åº”çš„èµ„æºæ–‡ä»¶å¤¹ä¸­ï¼Œç„¶åç›´æ¥å¼•ç”¨ï¼š {% aplayer \"Caffeine\" \"Jeff Williams\" \"caffeine.mp3\" \"picture.jpg\" \"lrc:caffeine.txt\" %} {% aplayer \"ä½ ç¦»å¼€äº†å—äº¬ï¼Œä»æ­¤æ²¡äººå’Œæˆ‘è¯´è¯\" \"æå¿—\" \"https://cdn-1256932288.cos.ap-chengdu.myqcloud.com/files/nanjing.mp3\" \"https://p2.music.126.net/UuSe-Vc6rS7JtRJSQgDU2g==/2323268069553116.jpg?param=300x300\" %} hexo-pdf pdf ä¼ é€é—¨ hexo-filter-flowchartï¼ˆæµç¨‹å›¾ï¼‰ è¯­æ³• npm install --save hexo-filter-flowchart ```%flow #å»æ‰%å· st=\u003estart: Start|past:\u003ehttps://lruihao.cn[blank] e=\u003eend: End:\u003ehttps://www.lruihao.cn[blank] op1=\u003eoperation: My Operation|past op2=\u003eoperation: Stuff|current sub1=\u003esubroutine: My Subroutine|invalid cond=\u003econdition: Yes or No?|approved:\u003e/hexo/nextplugin.html c2=\u003econdition: Good idea|rejected io=\u003einputoutput: catch something...|request st-\u003eop1(right)-\u003econd cond(yes, right)-\u003ec2 cond(no)-\u003esub1(left)-\u003eop1 c2(yes)-\u003eio-\u003ee c2(no)-\u003eop2-\u003ee ``` hexo-spoiler npm install hexo-spoiler --save If hexo canâ€™t detect this plugin automatically, you need to modify the plugins section of [path_to_your_site]/_config.yml manually, like: plugins: - hexo-spoiler {% spoiler [text] %} It will pixelate your text, and click to reveal. Click again to hide your text again. But you need to add \u003cbr\u003e manually if you want line breaks after/before it. When you writes: {% spoiler text %} {% spoiler ~~text~~ %} {% spoiler *text* %} {% spoiler **text** %}\u003cbr\u003e {% spoiler **hello welcome to åšæ¡çœ¾é•·ï¼** %} ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:1","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"å®…éŸ³ä¹ä¾§æ æ’­æ”¾å™¨æ’ä»¶ ä½“éªŒ æºç  ç›®å‰åœ¨ next ä¸­å¯èƒ½å¼•èµ·éƒ¨åˆ† css å†²çªï¼Œå»ºè®®åœ¨ next ä¸­ä½¿ç”¨åœ¨å•ä¸ªé¡µé¢ä¸­ã€‚ ä¾èµ–äº jQueryï¼Œä¸€è¡Œ js å¯ä»¥å¼•å…¥æ’­æ”¾å™¨æ’ä»¶ã€‚ ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:2","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"caniuse ä½¿ç”¨ {% caniuse feature @ periods %} \u003c!-- Tag Alias --\u003e {% can feature @ periods %} feature : Search for the feature you want on https://caniuse.com, then click on the hash sign to the left of the search result heading and you will get the unique name of this feature. periods : Select the browser versions to display. Supported values: past_1, past_2, past_3, past_4, past_5, current, future_3, future_2, future_1. If this value is empty, the default value 'current' will be used. æ —å­ Caniuse without periods {% caniuse fetch %} Caniuse with current period {% can sharedarraybuffer @ current %} Caniuse with future periods {% caniuse loading-lazy-attr @ future_3,future_2,future_1 %} Caniuse with past periods {% caniuse link-rel-modulepreload @ past_1,past_2,past_3,past_4,past_5 %} ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:3","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"Include Raw This tag include any raw content into your posts. Path is relative to your site source directory. {% include_raw '_data/path/to/file.html' %} Letâ€™s create include-raw.html file in _data directory under site root directory with following content: Any \u003cstrong\u003eraw content\u003c/strong\u003e may be included with this tag. Then in any post we can use this content with include_raw tag: {% include_raw '_data/path/to/include-raw.html' %} Any raw content may be included with this tag. ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:4","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"button more info {% button url, text, icon [class], [title] %} \u003c!-- Tag Alias --\u003e {% btn url, text, icon [class], [title] %} url : Absolute or relative path to URL. text : Button text. Required if no icon specified. icon : FontAwesome icon name (without 'fa-' at the begining). Required if no text specified. [class] : FontAwesome class(es): fa-fw | fa-lg | fa-2x | fa-3x | fa-4x | fa-5x Optional parameter. [title] : Tooltip at mouseover. Optional parameter. {% btn #, Text \u0026 Large Icon \u0026 Title, home fa-fw fa-lg, Title %} ``` ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:5","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"Mermaid more info example {% mermaid gitGraph: %} options { \"nodeSpacing\": 150, \"nodeRadius\": 10 } end commit branch newbranch checkout newbranch commit checkout master commit merge newbranch {% endmermaid %} ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:6","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"video Usage {% video url %} Examples {% video https://example.com/sample.mp4 %} {% video /path/to/your/video.mp4 %} ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:7","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"tab é€‰é¡¹å¡ â€œtab\"ä¸ºé€‰é¡¹å¡çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œæ•°å­—æ˜¯å‡ è¡¨ç¤ºä»ç¬¬å‡ ä¸ªé€‰é¡¹å¡å¼€å§‹ã€‚éå¿…é¡»ï¼Œè‹¥æ•°å€¼ä¸º-1 åˆ™éšè—é€‰é¡¹å¡å†…å®¹ã€‚ æŸ¥çœ‹æ›´å¤š {% tabs Unique name, [index] %} \u003c!-- tab [Tab caption] [@icon] --\u003e Any content (support inline tags too). \u003c!-- endtab --\u003e {% endtabs %} Unique name : Unique name of tabs block tag without comma. Will be used in #id's as prefix for each tab with their index numbers. If there are whitespaces in name, for generate #id all whitespaces will replaced by dashes. Only for current url of post/page must be unique! [index] : Index number of active tab. If not specified, first tab (1) will be selected. If index is -1, no tab will be selected. It's will be something like spoiler. Optional parameter. [Tab caption] : Caption of current tab. If not caption specified, unique name with tab index suffix will be used as caption of tab. If not caption specified, but specified icon, caption will empty. Optional parameter. [@icon] : FontAwesome icon name (without 'fa-' at the begining). Can be specified with or without space; e.g. 'Tab caption @icon' similar to 'Tab caption@icon'. Optional parameter. {% tabs tab,2 %} \u003c!-- tab --\u003e this is tab1 \u003c!-- endtab --\u003e \u003c!-- tab --\u003e this is tab2 \u003c!-- endtab --\u003e \u003c!-- tab --\u003e this is tab3 \u003c!-- endtab --\u003e {% endtabs %} æ•°å€¼ä¸º-1 {% tabs é€‰é¡¹ï¼Œ-1 %} \u003c!-- tab --\u003e **é€‰é¡¹ 1** \u003c!-- endtab --\u003e \u003c!-- tab --\u003e **é€‰é¡¹ 2** \u003c!-- endtab --\u003e \u003c!-- tab --\u003e **é€‰é¡¹ 3** \u003c!-- endtab --\u003e {% endtabs %} åå­—å†™åœ¨é€‰é¡¹é‡Œé¢ {% tabs Fourth unique name %} \u003c!-- tab Solution 1 --\u003e **This is Tab 1.** \u003c!-- endtab --\u003e \u003c!-- tab Solution 2 --\u003e **This is Tab 2.** \u003c!-- endtab --\u003e \u003c!-- tab Solution 3 --\u003e **This is Tab 3.** \u003c!-- endtab --\u003e {% endtabs %} ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:8","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"note ä¾¿ç­¾ ä¸»é¢˜é…ç½®æ–‡ä»¶æœç´¢ note, å¯è®¾ç½®é£æ ¼å’Œå›¾æ ‡æ˜¯å¦æ˜¾ç¤ºã€‚ # Note tag (bs-callout). note: # Note tag style values: # - simple bs-callout old alert style. Default. # - modern bs-callout new (v2-v3) alert style. # - flat flat callout style with background, like on Mozilla or StackOverflow. # - disabled disable all CSS styles import of note tag. style: flat icons: true border_radius: 15 # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6). # Offset also applied to label tag variables. This option can work with disabled note tag. light_bg_offset: 0 å†™æ³• {% note default %} default ç±»å‹è¿˜æœ‰ä»¥ä¸‹å‡ ç§ {% endnote %} {% note primary %} primary å†…å®¹ {% endnote %} {% note success %} success å†…å®¹ {% endnote %} {% note info %} info å†…å®¹ {% endnote %} {% note warning %} warning å†…å®¹ {% endnote %} {% note danger %} danger å†…å®¹ {% endnote %} {% note %} ä¸å¡« å†…å®¹ {% endnote %} {% note danger no-icon %} danger no-icon å†…å®¹ {% endnote %} ### å¼•ç”¨ï¼ˆæ–‡æœ¬å±…ä¸­ï¼‰ {% cq %} there are test words {% endcq %} ### [Font Awesome å›¾æ ‡](https://www.runoob.com/font-awesome/fontawesome-tutorial.html) \u003e Font Awesome æ˜¯ä¸€å¥—ç»ä½³çš„å›¾æ ‡å­—ä½“åº“å’Œ CSS æ¡†æ¶ã€‚ \u003e Font Awesome å­—ä½“ä¸ºæ‚¨æä¾›å¯ç¼©æ”¾çŸ¢é‡å›¾æ ‡ï¼Œå®ƒå¯ä»¥è¢«å®šåˆ¶å¤§å°ã€é¢œè‰²ã€é˜´å½±ä»¥åŠä»»ä½•å¯ä»¥ç”¨ CSS çš„æ ·å¼ã€‚ \u003e è¦ä½¿ç”¨ Font Awesome å›¾æ ‡ï¼Œè¯·åœ¨ HTML é¡µé¢çš„ éƒ¨åˆ†ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼š #### 1ã€å›½å†…æ¨è CDN ``` #### 2ã€æµ·å¤–æ¨è CDN \u003clink rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\"\u003e next å·²ç»å¼•ç”¨äº†ï¼Œå¯ä»¥ç›´æ¥ç”¨ï¼Œæ¯”å¦‚ï¼š \u003ci class=\"fa fa-car\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-car\" style=\"font-size:48px;\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-car\" style=\"font-size:60px;color:red;\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-car fa-lg\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-car fa-2x\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-car fa-3x\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-car fa-4x\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-car fa-5x\"\u003e\u003c/i\u003e åŠ¨æ€å›¾æ ‡ \u003ci class=\"fa fa-spinner fa-spin\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-circle-o-notch fa-spin\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-refresh fa-spin\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-cog fa-spin\"\u003e\u003c/i\u003e \u003ci class=\"fa fa-spinner fa-pulse\"\u003e\u003c/i\u003e ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:9","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"ä»£ç å—ç­‰ [language] [title] [url] [link text] code snippet - printf(\"Hello World!\"); + printf(\"Hello_World!\"); iframe åœ¨æ–‡ç« ä¸­æ’å…¥ iframeã€‚ {% iframe url [width] [height] %} ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:10","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"Todo list å·²å®Œæˆ æœªå®Œæˆ \u003cul\u003e \u003cli\u003e\u003ci class=\"fa fa-check-square\"\u003e\u003c/i\u003e å·²å®Œæˆ\u003c/li\u003e \u003cli\u003e\u003ci class=\"fa fa-square\"\u003e\u003c/i\u003e æœªå®Œæˆ\u003c/li\u003e \u003c/ul\u003e \u003c!--æˆ–è€…--\u003e - \u003ci class=\"fa fa-check-square\"\u003e\u003c/i\u003e å·²å®Œæˆ - \u003ci class=\"fa fa-square\"\u003e\u003c/i\u003e æœªå®Œæˆ ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:11","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"Label ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­æ‰“å¼€ # Label tag. label: true @å‰é¢çš„æ˜¯ label çš„åå­—ï¼Œåé¢çš„æ˜¯è¦æ˜¾ç¤ºçš„æ–‡å­— {% label default@default %} primary success info warning danger ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:12","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["Memo"],"content":"å…¶ä»– åŒ…æ‹¬å°è‰²å—ã€å·¦ä¾§è‰²æ¡ã€å³ä¾§è‰²æ¡ã€ä¸Šæ–¹è‰²æ¡ã€æ•°å­—è‰²å—ï¼ˆéœ€è¦è‡ªå®šä¹‰æ ·å¼ï¼‰ ","date":"2018-11-24","objectID":"/posts/nextplugin/:0:13","tags":["hexo"],"title":"hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›†","uri":"/posts/nextplugin/"},{"categories":["OS"],"content":" å‰é¢æˆ‘æœ‰æ–‡ç« æåˆ°æ€ä¹ˆæäº¤æœ¬åœ°æ–‡ä»¶åˆ° github,coding ç­‰è¿œç¨‹ä»“åº“ã€‚æ¯æ¬¡å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ git add * ï¼ˆæ·»åŠ éœ€è¦æäº¤çš„æ–‡ä»¶ï¼Œè¿™é‡Œå…¨é€‰ï¼‰ git commit -m â€œæäº¤ä¿¡æ¯â€ git push ä½†æ˜¯è¿™æ ·æ„Ÿè§‰å¾ˆéº»çƒ¦æ¯æ¬¡éƒ½è¦é‡å¤è¾“å…¥æäº¤å‘½ä»¤å’Œæç¤ºä¿¡æ¯ã€‚ è¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨åˆ° windows æ‰¹å¤„ç† bat æ–‡ä»¶ (linux çš„è¯å¯ä»¥ç”¨ shell è„šæœ¬ï¼‰ã€‚ç”¨å®Œå‘ç°å¥½ç”¨åˆ°ä¸è¡Œï¼ ","date":"2018-11-17","objectID":"/posts/commit-bat/:0:0","tags":["bat"],"title":"é€šè¿‡ bat æ‰¹å¤„ç†æ–‡ä»¶è‡ªåŠ¨æäº¤åšå®¢ä»£ç ","uri":"/posts/commit-bat/"},{"categories":["OS"],"content":"æ–°å»ºæ–‡æœ¬æ–‡æ¡£ @echo off title Commit git add . set /p m=Message: git commit -m \"%m%\" git push ç„¶åå¦å­˜ä¸ºcommit.batæ–‡ä»¶ï¼Œåªè¦åç¼€æ˜¯batå°±è¡Œäº†ã€‚ ","date":"2018-11-17","objectID":"/posts/commit-bat/:0:1","tags":["bat"],"title":"é€šè¿‡ bat æ‰¹å¤„ç†æ–‡ä»¶è‡ªåŠ¨æäº¤åšå®¢ä»£ç ","uri":"/posts/commit-bat/"},{"categories":["OS"],"content":"ä½¿ç”¨ æŠŠæ–‡ä»¶æ”¾åˆ°ä½ åŸæœ¬éœ€è¦æäº¤ä»£ç çš„æœ¬åœ°æ–‡ä»¶å¤¹ã€‚åŒå‡»è¿è¡Œï¼Œè¾“å…¥æäº¤ä¿¡æ¯å›è½¦å³å¯ã€‚ ","date":"2018-11-17","objectID":"/posts/commit-bat/:0:2","tags":["bat"],"title":"é€šè¿‡ bat æ‰¹å¤„ç†æ–‡ä»¶è‡ªåŠ¨æäº¤åšå®¢ä»£ç ","uri":"/posts/commit-bat/"},{"categories":["OS"],"content":"hexo åšå®¢æ–°å§¿åŠ¿ hexo æäº¤ä¹Ÿå¾ˆéº»çƒ¦ï¼Œå½“ç„¶ä¹Ÿè¦æ‰¹å¤„ç†ä¸€ä¸‹å‘€ hexo clean\u0026\u0026hexo g -d ","date":"2018-11-17","objectID":"/posts/commit-bat/:0:3","tags":["bat"],"title":"é€šè¿‡ bat æ‰¹å¤„ç†æ–‡ä»¶è‡ªåŠ¨æäº¤åšå®¢ä»£ç ","uri":"/posts/commit-bat/"},{"categories":["OS"],"content":"å…¶ä»– æ­»æœºè„šæœ¬ (å‹æƒ…æé†’åƒä¸‡ä¸è¦åœ¨çœŸæœºå®éªŒï¼Œè¯·åœ¨è™šæ‹Ÿæœºè¿è¡Œ) start cmd ifconfig å¦å¤–ä¹Ÿè¯´ä¸€ä¸‹ linux æ­»æœºå‘½ä»¤ã€‚fork ç‚¸å¼¹ã€‚ æ­»æœºæ— éæ˜¯è€—å°½ç³»ç»Ÿèµ„æº _(){ _ | _ \u0026 }; _ è¿™ä¸ª\u0026æŒ‡åå°è¿è¡Œçš„æ„æ€ã€‚ ç»Ÿè®¡æ–‡ä»¶å dir \\\\?\\%1 /a:-d /b /o /p /w \u003eFilelist.txt å°†éœ€è¦ç»Ÿè®¡çš„æ–‡ä»¶å¤¹æ‹–åˆ° bat æ–‡ä»¶ä¸Šã€‚ ","date":"2018-11-17","objectID":"/posts/commit-bat/:0:4","tags":["bat"],"title":"é€šè¿‡ bat æ‰¹å¤„ç†æ–‡ä»¶è‡ªåŠ¨æäº¤åšå®¢ä»£ç ","uri":"/posts/commit-bat/"},{"categories":["Grocery"],"content":"ä»‹ç» ä½¿ç”¨ fusion app å¯¹ç½‘é¡µè¿›è¡Œçš„å°è£…ã€‚ åŠŸèƒ½ï¼š æµè§ˆæœ¬åšå®¢ï¼Œä¸»é¡µ ç§äººç½‘ç›˜ 2048 ç­‰å°æ¸¸æˆ åœ¨çº¿å®¢æœï¼ŒQQ ç­‰ pc ä¸ç§»åŠ¨æµè§ˆå™¨æ ‡è¯†åˆ‡æ¢ ç•™è¨€ï¼Œæ‰“èµï¼Œåšä¸»æ—¥å¿—ç­‰ åˆ†äº«åŠŸèƒ½ï¼Œåˆ†äº«åˆ° QQï¼Œå¾®ä¿¡ï¼Œæµè§ˆå™¨æ‰“å¼€ç­‰ app å†…æ·»åŠ ä¹¦ç­¾ï¼Œè‡ªåŠ¨è®°å½•å†å²è®°å½•ï¼Œåˆ·æ–°ç­‰ é…åˆåšå®¢çš„PWA + quicklinkåŠŸèƒ½å¯å®ç°ç¦»çº¿æµè§ˆ ","date":"2018-11-12","objectID":"/posts/fas-app/:0:1","tags":["lua","fusion"],"title":"åšæ¡çœ¾é•· app","uri":"/posts/fas-app/"},{"categories":["Grocery"],"content":"ä¸‹è½½ app å†…ä¹Ÿå¯ä»¥æ›´æ–°ï¼Œä¸è¿‡å°±æˆ‘è‡ªå·±ç”¨ï¼Œæ‡’å¾—æ›´æ–°ã€‚ ç™¾åº¦äº‘ï¼Œå¯†ç ï¼š479l github ä¸‹è½½ PWA åº”ç”¨ åœ°å€æ è¾“å…¥ï¼šChrome://flags æœç´¢å¹¶å¯ç”¨ä»¥ä¸‹é¡¹ç›®ï¼šDesktop PWAsï¼ˆæ¡Œé¢ PWAs)ã€App Bannersï¼ˆåº”ç”¨æ¨ªå¹…ï¼‰ã€Experimental App Bannersï¼ˆå®éªŒæ€§åº”ç”¨æ¨ªå¹…ï¼‰ é‡å¯æµè§ˆå™¨ä½¿ä¿®æ”¹çš„è®¾ç½®ç”Ÿæ•ˆ ç‚¹å‡»åœ°å€æ æœ€å³è¾¹æŒ‰é’® å®‰è£…â€œåšæ¡çœ¾é•·â€ ","date":"2018-11-12","objectID":"/posts/fas-app/:0:2","tags":["lua","fusion"],"title":"åšæ¡çœ¾é•· app","uri":"/posts/fas-app/"},{"categories":["Grocery"],"content":"éƒ¨åˆ†æºç  çœ‹åˆ°è¿™äº›ä¸­æ–‡çš„å‡½æ•°æ€»è§‰å¾—æ€ªæ€ªçš„å“ˆå“ˆå“ˆ ğŸ˜‚ è¯­è¨€ï¼šlua æ£€æµ‹æ›´æ–° --æ£€æŸ¥æµ‹å½“å‰æ˜¯å¦æœ€æ–°ç‰ˆæœ¬ local dl=ProgressDialog.show(activity,nil,'æ›´æ–°æ£€æµ‹ä¸­â€¦') dl.show() local tt=Ticker() tt.start() packinfo=this.getPackageManager().getPackageInfo(this.getPackageName(),((32552732/2/2-8183)/10000-6-231)/9) version=tostring(packinfo.versionName) versioncode=tostring(packinfo.versionCode) url=\"https://share.weiyun.com/43fa66d8fc95db27141530ed2d006be2\"; function è¿‡æ»¤ (content) ç‰ˆæœ¬å=content:match(\"ã€ç‰ˆæœ¬åã€‘(.-)ã€ç‰ˆæœ¬åã€‘\") ç‰ˆæœ¬=content:match(\"ã€ç‰ˆæœ¬ã€‘(.-)ã€ç‰ˆæœ¬ã€‘\") å†…å®¹=content:match(\"ã€å†…å®¹ã€‘(.-)ã€å†…å®¹ã€‘\") é“¾æ¥=content:match(\"ã€é“¾æ¥ã€‘(.-)ã€é“¾æ¥ã€‘\") ifï¼ˆç‰ˆæœ¬å==nil) then ç‰ˆæœ¬å=\"è·å–å¤±è´¥\" end ifï¼ˆç‰ˆæœ¬==nil) then ç‰ˆæœ¬=\"0\" end ifï¼ˆå†…å®¹==nil) then å†…å®¹=\"è·å–å¤±è´¥\" end ifï¼ˆé“¾æ¥==nil) then å¼¹å‡ºæ¶ˆæ¯ (\"æœåŠ¡å™¨å‚æ•°é…ç½®é”™è¯¯ï¼Œè¯·è¿‡æ®µæ—¶é—´å†æ¬¡å°è¯•\") end ifï¼ˆç‰ˆæœ¬ \u003e versioncode) then dl.dismiss() tt.stop() å¯¹è¯æ¡† () . è®¾ç½®æ ‡é¢˜ (\"æ£€æµ‹åˆ°æ›´æ–°\") . è®¾ç½®æ¶ˆæ¯ (\"ç‰ˆæœ¬ï¼š\"..version..\"â†’\".. ç‰ˆæœ¬åã€‚.\"\\n æ›´æ–°å†…å®¹ï¼š\".. å†…å®¹ï¼‰ . è®¾ç½®ç§¯ææŒ‰é’® (\"ä¸‹è½½æ›´æ–°\",function() ä¸‹è½½æ–‡ä»¶ï¼ˆé“¾æ¥ï¼‰ å¼¹å‡ºæ¶ˆæ¯ (\"ä¸‹è½½æ›´æ–°ä¸­â€¦\") end) . è®¾ç½®æ¶ˆææŒ‰é’® (\"å–æ¶ˆæ›´æ–°\") . æ˜¾ç¤º () else dl.dismiss() tt.stop() å¼¹å‡ºæ¶ˆæ¯ (\"å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼\") end Http.get(url,nil,\"UTF-8\",nil,function(code,content,cookie,header) if(code==200 and content)then content=content:match(\"\\\"html_content\\\":(.-),\"):gsub(\"\\\\u003C/?.-%\u003e\",\"\"):gsub(\"\\\\\\\\\",\"\u0026revs;\"):gsub(\"\\\\n\",\"\\n\"):gsub(\"\u0026nbsp;\",\" \"):gsub(\"\u0026lt;\",\"\u003c\"):gsub(\"\u0026gt;\",\"\u003e\"):gsub(\"\u0026quot;\",\"\\\"\"):gsub(\"\u0026apos;\",\"'\"):gsub(\"\u0026revs;\",\"\\\\\"):gsub(\"\u0026amp;\",\"\u0026\"); è¿‡æ»¤ (content) else dl.dismiss() tt.stop() å¼¹å‡ºæ¶ˆæ¯ (\"æœ¬åœ°ç½‘ç»œæˆ–æœåŠ¡å™¨å¼‚å¸¸ \"..code) end end) æ–¹å‘é”å®š --flag åœ¨ç¨‹åºå¯åŠ¨äº‹ä»¶å£°æ˜çš„å…¨å±€å˜é‡ if flag==1 then activity.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR); SetHSP=\"H\" else SetHSP=nil end if SetHSP==nil then --ç«–å±é”å®š activity.setRequestedOrientation(1); flag=1 else flag=0 end ç¨‹åºå¯åŠ¨äº‹ä»¶ å¼¹å‡ºæ¶ˆæ¯ (\"Â©2018 æç‘è±ª\") --è‡ªåŠ¨ï¼Œç”±ç‰©ç†æ„Ÿåº”å™¨å†³å®š import \"android.content.pm.ActivityInfo\" flag=1 --ç¨‹åºé€€å‡ºæ—¶æ‰§è¡Œå¯¹è¯æ¡† function onKeyDown(key,event) if(key==4)then if(webView.canGoBack())then webView.goBack() else appinfo=this.getPackageManager().getApplicationInfo(this.getPackageName(),0) applabel=this.getPackageManager().getApplicationLabel(appinfo) é€€å‡ºç¡®è®¤=å¯¹è¯æ¡† () . è®¾ç½®æ¶ˆæ¯ (\"æ‚¨ç¡®å®šè¦é€€å‡º \"..applabel..\" å—ï¼Ÿ\") é€€å‡ºæŒ‰é’®={ [1]=function() é€€å‡ºç¡®è®¤ . è®¾ç½®ç§¯ææŒ‰é’® (\"ç¡®è®¤\",function() é€€å‡ºç¨‹åº () end ) . è®¾ç½®ä¸­ç«‹æŒ‰é’® (\"æ¸…é™¤ç¼“å­˜\",function() å¯¹è¯æ¡† () . è®¾ç½®æ¶ˆæ¯ (\"æ¸…é™¤ç¼“å­˜åå†æ¬¡è¿è¡Œç¨‹åºå°†å˜å¾—ç¼“æ…¢ã€n æ‚¨ç¡®å®šè¦æ¸…é™¤ \"..applabel..\" çš„ç¼“å­˜å—ï¼Ÿ\") . è®¾ç½®ç§¯ææŒ‰é’® (\"ç¡®å®š\",function() os.execute(\"pm clear \"..this.packageName) é€€å‡ºç¨‹åº () end) . è®¾ç½®æ¶ˆææŒ‰é’® (\"å–æ¶ˆ\",function() end) . æ˜¾ç¤º () end ) . è®¾ç½®æ¶ˆææŒ‰é’® (\"å–æ¶ˆ\") end } math.randomseed(tonumber(tostring(os.time()):reverse():sub(1, 6))) é€€å‡ºæŒ‰é’® [math.random(1,1)]() é€€å‡ºç¡®è®¤ã€‚show() end return true end end --å†å²è®°å½• lstads=\"/data/data/\"..activity.getPackageName()..\"/lst.lua\" lstwebads=\"/data/data/\"..activity.getPackageName()..\"/lstweb.lua\" --2. åºåˆ—åŒ– function slz(obj) local lua = \"\" local t = type(obj) if t == \"number\" then lua = lua .. obj elseif t == \"boolean\" then lua = lua .. tostring(obj) elseif t == \"string\" then lua = lua .. string.format(\"%q\", obj) elseif t == \"table\" then lua = lua .. \"{\\n\" for k, v in pairs(obj) do lua = lua .. \"[\" .. slz(k) .. \"]=\" .. slz(v) .. \",\\n\" end local metatable = getmetatable(obj) if metatable ~= nil and type(metatable.__index) == \"table\" then for k, v in pairs(metatable.__index) do lua = lua .. \"[\" .. slz(k) .. \"]=\" .. slz(v) .. \",\\n\" end end lua = lua .. \"}\" elseif t == \"nil\" then return nil else error(\"can not serialize a \" .. t .. \" type.\") end return lua end function rslz(lua) local t = type(lua) if t == \"nil\" or lua == \"\" then return {} elseif t == \"number\" or t == \"string\" or t == \"boolean\" then lua = tostring(lua) else error(\"can not unserialize a \" .. t .. \" type.\") end lua = \"return \" .. lua local func = loadstring(lua) if func == nil then return nil end return func() end --3. å†å²è®°å½•æ¡†å¸ƒå±€ function hstshow() hstlayout={ LinearLayout, orientation=\"1\", gravity=\"center\", layout_width=\"wrap_content\", layout_height=\"wrap_content\", { TextView, text=\"\", gravity=\"center\", layout_width=\"wrap_content\", textSize=\"0sp\", background=\"#000000\", layout_height=\"15dp\",}, { TextView, text=\"å†å²è®°å½•\", gravity=\"center\", layout_width=\"wrap_content\", textSize=\"30sp\", textStyle=\"bold\", layout_height=\"50dp\",}, { ListView, id=\"hlst\", items=","date":"2018-11-12","objectID":"/posts/fas-app/:0:3","tags":["lua","fusion"],"title":"åšæ¡çœ¾é•· app","uri":"/posts/fas-app/"},{"categories":["Grocery"],"content":"å®‰è£… cd ~ curl https://getcaddy.com | bash -s personal http.filemanager ","date":"2018-11-11","objectID":"/posts/caddy-file/:1:0","tags":["äº‘ç›˜","caddy","server"],"title":"caddy-ä¸¤æ­¥æ­å»ºè¶…ç®€å•äº‘ç›˜","uri":"/posts/caddy-file/"},{"categories":["Grocery"],"content":"ç¼–å†™é…ç½®æ–‡ä»¶ vim Caddyfile å†…å®¹å¦‚ä¸‹ï¼š :80 { filemanager / /sdcard timeouts none gzip } è¿™é‡Œçš„ 8080 ç«¯å£å·å¯ä»¥éšæ„æŒ‡å®šï¼Œå¦‚æœåœ¨æ‰‹æœº termux ç­‰æ­å»ºï¼Œç”±äºæ‰‹æœºæƒé™æ¯”è¾ƒä½ï¼Œæ‰€ä»¥ä¸€èˆ¬è®¾ç½® 1024 ä»¥ä¸Šçš„ç«¯å£ã€‚80ç«¯å£å¯ä»¥ç›´æ¥é€šè¿‡ ip è®¿é—®ã€‚å¦‚118.24.217.167 å¦‚æœç”¨åŸŸåï¼Œå…ˆåœ¨åŸŸåæœåŠ¡å•†è§£æ ip, å†é…ç½®æ–‡ä»¶å¦‚ä¸‹ https://pan.lruihao.cn { filemanager / /sdcard timeouts none tls admin@lruihao.cn gzip } æŒ‡å®šé‚®ç®±æ˜¯ä¸ºäº†ç”³è¯· ssl, å®ç° https. ","date":"2018-11-11","objectID":"/posts/caddy-file/:2:0","tags":["äº‘ç›˜","caddy","server"],"title":"caddy-ä¸¤æ­¥æ­å»ºè¶…ç®€å•äº‘ç›˜","uri":"/posts/caddy-file/"},{"categories":["Grocery"],"content":"demo å¯åŠ¨ caddy caddy è´¦å·å¯†ç é»˜è®¤admin ","date":"2018-11-11","objectID":"/posts/caddy-file/:3:0","tags":["äº‘ç›˜","caddy","server"],"title":"caddy-ä¸¤æ­¥æ­å»ºè¶…ç®€å•äº‘ç›˜","uri":"/posts/caddy-file/"},{"categories":["Grocery"],"content":"è®¾ç½®å®šæ—¶å™¨å¯åŠ¨ caddyï¼ˆå¥½åƒæ²¡ç”¨ï¼Œæˆ‘ä¸ä¼šï¼‰ ä¸ºäº†æ–­å¼€ xshell å caddy è¿˜åœ¨è¿è¡Œã€‚ vim run.sh ç¼–è¾‘ä»¥ä¸‹å†…å®¹ #!/bin/bash caddy åŠ æƒ chmod +x run.sh è®¾ç½®ä»»åŠ¡ å‚è€ƒ crontab -e åŠ å…¥ * * * * * /root/run.sh service crond start ","date":"2018-11-11","objectID":"/posts/caddy-file/:4:0","tags":["äº‘ç›˜","caddy","server"],"title":"caddy-ä¸¤æ­¥æ­å»ºè¶…ç®€å•äº‘ç›˜","uri":"/posts/caddy-file/"},{"categories":["Grocery"],"content":"ï¼Ÿï¼Ÿï¼Ÿ æœ€åè¯¯æ‰“è¯¯æ’å¼€å¯äº† caddy æ˜¨æ™šåŒåä¸€è¦æŠ¢è£¤å­ï¼ŒåŠ ä¸Šæ¹˜æ½­å¤©æ°”å¤ª tm å†·äº†ï¼Œå°±ä¸ŠåºŠäº†ï¼Œæ¥ç€ç”¨ termux è¿œç¨‹è¿æ¥æœåŠ¡å™¨ç»§ç»­æã€‚ç»“æœè¿æ¥çš„æ—¶å€™å‘½ä»¤è¾“é”™äº†-_-! æœ¬æ¥æ˜¯ssh root@118.24.217.167å†è¾“å…¥å¯†ç å°±å¯ä»¥äº†ã€‚è¿™æ¬¡æé”™äº†å¤šå†™äº†ä¸ª-T, ç„¶åè¿è¡Œcaddy,ctrl+c å†æ–­å¼€ï¼Œæ„å¤–åœ°å‘ç° filemanager ç«Ÿç„¶å¯ä»¥è®¿é—®äº†ã€‚ ssh -T root@118.24.217.167 caddy Ctrl+c ","date":"2018-11-11","objectID":"/posts/caddy-file/:5:0","tags":["äº‘ç›˜","caddy","server"],"title":"caddy-ä¸¤æ­¥æ­å»ºè¶…ç®€å•äº‘ç›˜","uri":"/posts/caddy-file/"},{"categories":["Memo"],"content":" æœ€æ–°çš„ next ä¸»é¢˜å·²ç»æ›´æ–°äº†æ”¯æŒ PDF åŠŸèƒ½ï¼Œå†™æ³•ä¹Ÿå’Œé“¾æ¥å†™æ³•ä¸€æ ·ï¼Œå¯æ˜¯æˆ‘æ²¡æœ‰æ›´æ–°ï¼Œæˆ‘æŒ‰ github ä¸Šé‚£ä¸ª readme è¯•äº†ä¸€ä¸‹å¥½åƒä¸å¯ä»¥ï¼Œæ‰€ä»¥ç”¨äº†å¦å¤–ä¸€ç§æ’ä»¶çš„æ–¹æ³•ã€‚ ","date":"2018-11-09","objectID":"/posts/next-pdf/:0:0","tags":["hexo"],"title":"nextæ·»åŠ æ”¯æŒpdf","uri":"/posts/next-pdf/"},{"categories":["Memo"],"content":"iframe(æ¨è) \u003ciframe src=\"/posts/next-pdf/1.pdf\" style=\"width: 100%;height: 800px;\"\u003e\u003c/iframe\u003e ","date":"2018-11-09","objectID":"/posts/next-pdf/:1:0","tags":["hexo"],"title":"nextæ·»åŠ æ”¯æŒpdf","uri":"/posts/next-pdf/"},{"categories":["Memo"],"content":"æ¨¡æ¿è‡ªå¸¦ ä»Šå¤©ï¼ˆ2019.4.3ï¼‰åˆçœ‹äº†ä¸€ä¸‹ï¼Œæ”¹äº†å†™æ³•ï¼Œå†™æ³•å’Œæ’ä»¶ä¸€æ ·ï¼Œæˆ‘åœ¨æˆ‘çš„æ¨¡æ¿é‡Œä¹Ÿæ›´æ–°äº†ã€‚ï¼ˆæ’ä»¶æ¨¡æ¿äºŒé€‰ä¸€å³å¯,ä¸ªäººæ›´å–œæ¬¢æ’ä»¶ï¼‰ ä½†æ˜¯å¦‚æœå®‰è£…æ’ä»¶åï¼Œä¹Ÿæ˜¯ä¼˜å…ˆæ¨¡æ¿çš„ pdf è„šæœ¬è§£æ pdf,æ‰€ä»¥åœ¨æˆ‘çš„æ¨¡æ¿ä¸­æŠŠæ¨¡æ¿çš„ pdf è„šæœ¬å…ˆæ³¨é‡Šäº†ã€‚è¦å¯ç”¨å»æ‰æ³¨é‡Šå³å¯ã€‚ /* 'use strict'; function pdf(args) { return `\u003cdiv class=\"pdf\" target=\"${args[0]}\" height=\"${args[1] || ''}\"\u003e\u003c/div\u003e`; } hexo.extend.tag.register('pdf', pdf, {ends: false}); */ ","date":"2018-11-09","objectID":"/posts/next-pdf/:2:0","tags":["hexo"],"title":"nextæ·»åŠ æ”¯æŒpdf","uri":"/posts/next-pdf/"},{"categories":["Memo"],"content":"pdf æ’ä»¶(æ¨è) ","date":"2018-11-09","objectID":"/posts/next-pdf/:3:0","tags":["hexo"],"title":"nextæ·»åŠ æ”¯æŒpdf","uri":"/posts/next-pdf/"},{"categories":["Memo"],"content":"å®‰è£… npm install --save hexo-pdf ","date":"2018-11-09","objectID":"/posts/next-pdf/:3:1","tags":["hexo"],"title":"nextæ·»åŠ æ”¯æŒpdf","uri":"/posts/next-pdf/"},{"categories":["Memo"],"content":"ä½¿ç”¨ {% pdf url %} æ¯”å¦‚æœ¬æ–‡ {% pdf /posts/next-pdf/1.pdf %} ","date":"2018-11-09","objectID":"/posts/next-pdf/:3:2","tags":["hexo"],"title":"nextæ·»åŠ æ”¯æŒpdf","uri":"/posts/next-pdf/"},{"categories":["JavaScript"],"content":"å‰ç«¯å¼€å‘ç»å¸¸é‡åˆ°éœ€è¦åˆ¤æ–­ç”¨æˆ·çš„æµè§ˆè®¾å¤‡ï¼Œæ˜¯ pc ç«¯è¿˜æ˜¯ç§»åŠ¨ç«¯ï¼Œç§»åŠ¨ç«¯ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆæ‰‹æœºç³»ç»Ÿï¼Ÿandroidã€iosã€ipadã€windows phone ç­‰ç­‰ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦çŸ¥é“ç”¨æˆ·æµè§ˆé¡µé¢æ˜¯åœ¨å¾®ä¿¡ä¸­æ‰“å¼€è¿˜æ˜¯åœ¨ç§»åŠ¨ç«¯æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œç­‰ç­‰ä¸€ç³»åˆ—åˆ¤æ–­åšä¸€äº›ç›¸åº”çš„å¤„ç†ã€‚ ","date":"2018-11-03","objectID":"/posts/js-device/:0:0","tags":["JavaScript","ä»–å±±ä¹‹çŸ³"],"title":"js åˆ¤æ–­ç”¨æˆ·è®¾å¤‡ç±»å‹åŠå¹³å°","uri":"/posts/js-device/"},{"categories":["JavaScript"],"content":"é¦–å…ˆåˆ¤æ–­ pc ç«¯è¿˜æ˜¯ç§»åŠ¨ç«¯ function IsPC() { var userAgentInfo = navigator.userAgent; var Agents = [\"Android\", \"iPhone\", \"SymbianOS\", \"Windows Phone\", \"iPad\", \"iPod\"]; var flag = true; for (var v = 0; v \u003c Agents.length; v++) { if (userAgentInfo.indexOf(Agents[v]) \u003e 0) { flag = false; break; } } return flag; } ","date":"2018-11-03","objectID":"/posts/js-device/:0:1","tags":["JavaScript","ä»–å±±ä¹‹çŸ³"],"title":"js åˆ¤æ–­ç”¨æˆ·è®¾å¤‡ç±»å‹åŠå¹³å°","uri":"/posts/js-device/"},{"categories":["JavaScript"],"content":"åˆ¤æ–­ç”¨æˆ·ç§»åŠ¨ç«¯ä½¿ç”¨çš„ç³»ç»Ÿå¹³å° var u = navigator.userAgent; if (u.indexOf('Android') \u003e -1 || u.indexOf('Linux') \u003e -1) { //å®‰å“æ‰‹æœº } else if (u.indexOf('iPhone') \u003e -1) { //è‹¹æœæ‰‹æœº } else if (u.indexOf('Windows Phone') \u003e -1) { //winphone æ‰‹æœº } ","date":"2018-11-03","objectID":"/posts/js-device/:0:2","tags":["JavaScript","ä»–å±±ä¹‹çŸ³"],"title":"js åˆ¤æ–­ç”¨æˆ·è®¾å¤‡ç±»å‹åŠå¹³å°","uri":"/posts/js-device/"},{"categories":["JavaScript"],"content":"åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨å¾®ä¿¡ä¸­æ‰“å¼€ function isWeiXin(){ var ua = navigator.userAgent.toLowerCase(); if(ua.indexOf('micromessenger') != -1) { return true; } else { return false; } } ","date":"2018-11-03","objectID":"/posts/js-device/:0:3","tags":["JavaScript","ä»–å±±ä¹‹çŸ³"],"title":"js åˆ¤æ–­ç”¨æˆ·è®¾å¤‡ç±»å‹åŠå¹³å°","uri":"/posts/js-device/"},{"categories":["JavaScript"],"content":"å®é™…è¿ç”¨ æ ¹æ® pc æˆ–è€…ç§»åŠ¨ç«¯æ§åˆ¶é£˜èŠ±æ•°ç›®ï¼Œé™ä½ cpu æ¶ˆè€—ï¼Œå‡å°‘å¡é¡¿ã€‚demo \u003cscript\u003e function sakuraInit() { $(document).snowfall('clear'); var userAgentInfo = navigator.userAgent; var Agents = [\"Android\", \"iPhone\", \"SymbianOS\", \"Windows Phone\", \"iPad\", \"iPod\"]; var flag = true; for (var v = 0; v \u003c Agents.length; v++) { if (userAgentInfo.indexOf(Agents[v]) \u003e 0) { flag = false; break; } } if (flag) { $(document).snowfall({image:\"images/1.png\", flakeCount:5, minSpeed:1, minSize:8, maxSize:15,}); $(document).snowfall({image:\"images/2.png\", flakeCount:5, minSpeed:1, minSize:8, maxSize:15,}); $(document).snowfall({image:\"images/3.png\", flakeCount:5, minSpeed:1, minSize:8, maxSize:15,}); $(document).snowfall({image:\"images/4.png\", flakeCount:5, minSpeed:1, minSize:8, maxSize:15,}); } else { $(document).snowfall({image:\"images/1.png\", flakeCount:2, minSpeed:1, minSize:8, maxSize:15,}); $(document).snowfall({image:\"images/2.png\", flakeCount:2, minSpeed:1, minSize:8, maxSize:15,}); $(document).snowfall({image:\"images/3.png\", flakeCount:2, minSpeed:1, minSize:8, maxSize:15,}); $(document).snowfall({image:\"images/4.png\", flakeCount:2, minSpeed:1, minSize:8, maxSize:15,}); } } window.onload = sakuraInit(); \u003c/script\u003e ","date":"2018-11-03","objectID":"/posts/js-device/:0:4","tags":["JavaScript","ä»–å±±ä¹‹çŸ³"],"title":"js åˆ¤æ–­ç”¨æˆ·è®¾å¤‡ç±»å‹åŠå¹³å°","uri":"/posts/js-device/"},{"categories":["Memo","Git"],"content":"å¤‡ä»½ hexo åšå®¢ //å¦‚æœ themes/nextï¼ˆä¸»é¢˜æ–‡ä»¶ï¼‰ä¸‹é¢æœ‰ã€‚gitï¼Œè¯·åˆ é™¤è¿™ä¸ªã€‚git æ–‡ä»¶å¤¹ã€‚ cd hexo git init //åˆå§‹åŒ–æœ¬åœ°ä»“åº“ git add source themes scaffolds _config.yml package.json package-lock.json //å°†å¿…è¦çš„æ–‡ä»¶ä¾æ¬¡æ·»åŠ  git commit -m \"blog hexo\" git branch hexo //æ–°å»º hexo åˆ†æ”¯ git checkout hexo //åˆ‡æ¢åˆ° hexo åˆ†æ”¯ä¸Š git remote add origin git@github.com:username/username.github.io.git //å°†æœ¬åœ°ä¸ Github é¡¹ç›®å¯¹æ¥ git push origin hexo //push åˆ° Github é¡¹ç›®çš„ hexo åˆ†æ”¯ä¸Š ","date":"2018-11-03","objectID":"/posts/blog-backup/:1:0","tags":["Git","Node.js","hexo"],"title":"hexo åšå®¢æºç å¤‡ä»½","uri":"/posts/blog-backup/"},{"categories":["Memo","Git"],"content":"åœ¨å…¶ä»–ç»ˆç«¯å…‹éš†å’Œæ›´æ–° hexo åšå®¢ nodejs,git,hexo å·²ç»å®‰è£…å¥½ï¼Œå³æ­å»ºå®Œæˆ ","date":"2018-11-03","objectID":"/posts/blog-backup/:2:0","tags":["Git","Node.js","hexo"],"title":"hexo åšå®¢æºç å¤‡ä»½","uri":"/posts/blog-backup/"},{"categories":["Memo","Git"],"content":"å…‹éš† hexo åšå®¢å¤‡ä»½ git clone -b hexo git@github.com:username/username.github.io.git //å°† Github ä¸­ hexo åˆ†æ”¯ clone åˆ°æœ¬åœ° cd user.github.io npm install //æ³¨æ„ï¼Œè¿™é‡Œä¸€å®šè¦åˆ‡æ¢åˆ°åˆšåˆš clone çš„æ–‡ä»¶å¤¹å†…æ‰§è¡Œï¼Œå®‰è£…å¿…è¦çš„æ‰€éœ€ç»„ä»¶ï¼Œä¸ç”¨å† init è¿™æ ·æˆ‘ä»¬çš„å¤‡ä»½æ–‡ä»¶å°±ä¼šåŸå°ä¸åŠ¨çš„æ‹·è´åˆ°æœ¬åœ°ã€‚ ","date":"2018-11-03","objectID":"/posts/blog-backup/:2:1","tags":["Git","Node.js","hexo"],"title":"hexo åšå®¢æºç å¤‡ä»½","uri":"/posts/blog-backup/"},{"categories":["Memo","Git"],"content":"å†™æ–°æ–‡ç« å¹¶å¤‡ä»½å’Œéƒ¨ç½²ï¼ˆå¤‡ç”¨æ“ä½œï¼‰ å…¶å®æºç æ‹·ä¸‹æ¥äº†ï¼Œè¿™æ­¥ä¸åšæˆ‘ä»¬ä¹ŸçŸ¥é“æ€ä¹ˆåšäº†ï¼Œå®Œå…¨æ²¡å¿…è¦æŒ‰ç…§æ•™ç¨‹æ­»æ¬ç¡¬å¥—ã€‚çµæ´»ä¸€ç‚¹å°±è¡Œäº†ã€‚ //è¿›å…¥ username.github.io æ–‡ä»¶å¤¹ï¼Œåº”æ˜¯ hexo åˆ†æ”¯ git pull origin hexo //æœ¬åœ°å’Œè¿œç«¯çš„èåˆ hexo new post \"new post name\" //å†™æ–°æ–‡ç«  git add source git commit -m \"xxx\" git push origin hexo //å¤‡ä»½ hexo d -g //éƒ¨ç½² å‚è€ƒ ","date":"2018-11-03","objectID":"/posts/blog-backup/:2:2","tags":["Git","Node.js","hexo"],"title":"hexo åšå®¢æºç å¤‡ä»½","uri":"/posts/blog-backup/"},{"categories":["éšç¬”"],"content":" å¤‡æ¡ˆ ç»è¿‡æ—¶é—´é•¿è¾¾ 20 å¤šå¤©çš„å¤‡æ¡ˆä¹‹æ—…ä»Šå¤©ç»ˆäºç»“æŸäº†ï¼Œä¹Ÿé—­é¦†äº† 20 å¤šå¤©ï¼Œä¹ŸæŒ‰ç›¸å…³è¦æ±‚æŠŠ ICP å¤‡æ¡ˆå·å’Œå…¬å®‰å¤‡æ¡ˆå·åŠ è½½äº†ç½‘ç«™å’Œåšå®¢åº•éƒ¨ã€‚åªæ˜¯ä»Šå¤©å»å²³å¡˜åˆ†å±€ç­¾ç½‘ç»œå®‰å…¨å‘ŠçŸ¥ä¹¦çš„æ—¶å€™ä¸å°å¿ƒæŠŠèº«ä»½è¯è½åœ¨é‚£ä¸ªåŠå…¬å®¤äº†ã€‚äºæˆ‘èµ°ä¹‹å‰ä¸€ç§’è¿˜åœ¨æé†’è‡ªå·±ï¼Œå”‰ï¼ä¸è¿‡é‚£ä¸ªåŠå…¬å®¤çš„å¤§å§å§æŒºå¥½çš„ï¼Œå‰é¢è·Ÿæˆ‘è¯´å¥½æ˜ŸæœŸä¸€æ¥ï¼Œæˆ‘è¿˜ä»Šå¤©ä¸Šåˆæå‰ç»™å¥¹æ‰“äº†ç”µè¯ï¼Œå¥¹è¿˜ä¸‹æ¥¼ç»™æˆ‘å¼€åŠå…¬æ¥¼æ¥¼é“çš„é—¨ç¦ï¼Œè¿˜æœ‰æˆ‘èº«ä»½è¯è½åœ¨é‚£é‡Œå¥¹è¯´å…ˆå¸®æˆ‘æ”¶ç€ï¼Œæœ‰æ—¶é—´å†å»æ‹¿ï¼æ€»ä¹‹ï¼Œè¿™ä¸ªå§å§çš„æœåŠ¡æ€åº¦äº”æ˜Ÿå¥½è¯„ï¼æ‰‹åŠ¨@å²³å¡˜åˆ†å±€ B204 çš„å§å§ã€‚ å¤‡æ¡ˆå®Œæˆä¹Ÿç®—æ”¾ä¸‹ä¸€å—æç€çš„çŸ³å¤´ï¼Œå¯ä»¥ç¡ä¸ªå¥½è§‰äº†ï¼ZzZzzzz ","date":"2018-10-29","objectID":"/posts/beian/:0:0","tags":["éšç¬”","ç½‘ç«™å¤‡æ¡ˆ"],"title":"ç½‘ç«™å¤‡æ¡ˆä¹‹æ—…","uri":"/posts/beian/"},{"categories":["OS"],"content":"ä»Šå¤©ä¸Šæœºå­¦äº†å‡ ä¸ªå°å‘½ä»¤ read echo if ç„¶åè‡ªå·±å†™äº†ä¸€ä¸ªå°è„šæœ¬è§‰å¾—è¿˜æŒºæœ‰è¶£çš„ #!/bin/bash #liruihao #menu.sh #sudo apt curl install nyancat sl figlet toilet cowsay echo \"-------------èœ-å•--------------\" echo \"------------1-æ‰“å°äºŒç»´ç --------\" echo \"------------2-å½©è™¹çŒ«------------\" echo \"------------3-å°ç«åˆ‡------------\" echo \"------------4-æ‰“å­—æœº------------\" echo \"------------5-å°è®¸ç‰›------------\" echo \"----------Ctrl+c æš‚åœç¨‹åº--------\" echo \"\" echo \"è¯·è¾“å…¥åºå·ï¼\" read i if test $i -eq 1 then echo \"è¯·è¾“å…¥ç½‘å€ï¼\" read s1 echo $s1 |curl -F-=\\\u003c- qrenco.de fi if test $i -eq 2 then nyancat fi if test $i -eq 3 then sl fi if test $i -eq 4 then echo \"è¯·è¾“å…¥å­—ç¬¦ä¸²ï¼\" read s2 echo \"é€‰æ‹©æ ·å¼ï¼š\" echo \"------æ ·å¼ 1-----\" echo \"------æ ·å¼ 2-----\" read j if test $j -eq 1 then figlet $s2 else toilet -f mono12 -F gay $s2 fi fi if test $i -eq 5 then echo \"è¯·è¾“å…¥å­—ç¬¦ä¸²ï¼\" read s3 cowsay $s3 fi echo \"ä»»æ„å»ºç»§ç»­ï¼\" read x clear ./menu.sh ","date":"2018-10-29","objectID":"/posts/shell/:0:0","tags":["shell","linux"],"title":"shell è„šæœ¬åˆä½“éªŒ","uri":"/posts/shell/"},{"categories":["OS"],"content":"æ­å»º Apache web æœåŠ¡ å®‰è£… Apache è¶…æ–‡æœ¬ä¼ è¾“åè®® (HTTP) æœåŠ¡å™¨çš„ä¸»ç¨‹åº [root@VM_0_6_centos /]# yum install -y httpd æ³¨æ„å®‰è£…ç›®å½•ï¼Œå¯é€šè¿‡ cd å‘½ä»¤åˆ‡æ¢ã€‚ å¯åŠ¨ HTTP æœåŠ¡ [root@VM_0_6_centos /]# systemctl start httpd.service å¦‚æœå¯åŠ¨å¤±è´¥ï¼Œå¯é€šè¿‡ systemctl status httpd.service æŸ¥çœ‹é”™è¯¯åŸå› ã€‚ å¯åŠ¨æˆåŠŸï¼Œè¯æ˜ http æœåŠ¡å·²ç»å¯ä»¥ä½¿ç”¨ï¼Œå‘ç°è¿˜éœ€è¦æŠŠæœ¬åœ°æ–‡ä»¶ä¼ åˆ°æœåŠ¡å™¨ã€‚ é»˜è®¤æ ¹ç›®å½•/var/www/html/ ","date":"2018-10-29","objectID":"/posts/web-server-yun/:0:1","tags":["server","linux","ä»–å±±ä¹‹çŸ³"],"title":"äº‘æœåŠ¡å™¨ CentOS ç³»ç»Ÿæ­å»º web æœåŠ¡","uri":"/posts/web-server-yun/"},{"categories":["OS"],"content":"ä½¿ç”¨ SSH è¿æ¥æœåŠ¡å™¨ å°è¯•äº†ä¸¤ç§æ–¹å¼ï¼šPuTTY å’Œ Xshellï¼ˆæ¨èï¼‰ Xshell æ–¹å¼ å®˜ç½‘ä¸‹è½½å®‰è£… Xshell æ‰“å¼€ï¼Œè¾“å…¥ ip è´¦å·å¯†ç è¿æ¥ä¸»æœºã€‚ ä½¿ç”¨ lrzsz æ–¹å¼ä¸Šä¼ ä¸‹è½½æ–‡ä»¶ æ­¥éª¤ 1ï¼šåœ¨æœåŠ¡å™¨å®‰è£… lrzsz [root@VM_0_6_centos /]# yum -y install lrzsz æ­¥éª¤ 2ï¼šè¾“å…¥å‘½ä»¤rzæ‰“å¼€ä¸Šä¼ çª—å£ï¼ˆå¯ä»¥é€‰æ‹©å¤šä¸ªæ–‡ä»¶ã€‚) ä½¿ç”¨szæ–‡ä»¶åå‘½ä»¤å¯æ‰“å¼€ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶çš„ä¿å­˜çª—å£ã€‚ ","date":"2018-10-29","objectID":"/posts/web-server-yun/:0:2","tags":["server","linux","ä»–å±±ä¹‹çŸ³"],"title":"äº‘æœåŠ¡å™¨ CentOS ç³»ç»Ÿæ­å»º web æœåŠ¡","uri":"/posts/web-server-yun/"},{"categories":["OS"],"content":"ä¿®æ”¹ HTTP é…ç½® 1.VIM ç¼–è¾‘å™¨æ‰“å¼€é…ç½®æ–‡ä»¶ [root@VM_0_6_centos /]# vim /etc/httpd/conf/httpd.conf æŒ‰Ié”®è¿›å…¥ç¼–è¾‘æ¨¡å¼ æ‰¾åˆ°å¹¶ä¿®æ”¹ä»¥ä¸‹å†…å®¹ ServerAdmin ç®¡ç†å‘˜é‚®ç®±ï¼Œç”¨äºæµè§ˆå™¨è¯·æ±‚æŠ¥é”™æ—¶å±•ç¤º DocumentRoot è®¿é—®æ ¹ç›®å½•ï¼ˆé»˜è®¤ï¼š/var/www/htmlï¼‰ï¼Œå¦‚é¡¹ç›®å­˜æ”¾åœ¨å…¶ä»–åœ°æ–¹ï¼Œå¯ä¿®æ”¹ä¸ºé¡¹ç›®å­˜æ”¾ä½ç½® \u003cDirectory \"/var/www/html\"\u003e åŒ DocumentRoot é…ç½® ServerName æœåŠ¡å™¨ IP æˆ– åŸŸå æŒ‰ä¸‹ ESC é”®è¾“å…¥:wqä¿å­˜é€€å‡º é‡å¯æœåŠ¡service httpd restart æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥åœ°å€è®¿é—® å¦‚ï¼šæˆ‘çš„é¡¹ç›®ç´¢å¼• html è·¯å¾„ä¸º love/index.htmlï¼Œè¾“å…¥ http://IP åœ°å€æˆ–åŸŸå/love/index.html è®¿é—®ä¸æˆåŠŸï¼Œå…ˆæ£€æŸ¥ç½‘ç»œï¼Œå†æŸ¥çœ‹ http æœåŠ¡æ˜¯å¦å¼€å¯ï¼Œæœ€åæ£€æŸ¥é…ç½®ï¼› è®¿é—®æˆåŠŸï¼Œé…ç½®å®Œæˆã€‚ ","date":"2018-10-29","objectID":"/posts/web-server-yun/:0:3","tags":["server","linux","ä»–å±±ä¹‹çŸ³"],"title":"äº‘æœåŠ¡å™¨ CentOS ç³»ç»Ÿæ­å»º web æœåŠ¡","uri":"/posts/web-server-yun/"},{"categories":["JavaScript"],"content":"è·å–é“¾æ¥ï¼ˆè½¬ï¼‰ ä¼ é€é—¨ åœ¨ WEB å¼€å‘ä¸­ï¼Œæ—¶å¸¸ä¼šç”¨åˆ° javascript æ¥è·å–å½“å‰é¡µé¢çš„ url ç½‘å€ä¿¡æ¯ï¼Œåœ¨è¿™é‡Œæ˜¯æˆ‘çš„ä¸€äº›è·å– url ä¿¡æ¯çš„å°æ€»ç»“ã€‚ ä¸‹é¢æˆ‘ä»¬ä¸¾ä¾‹ä¸€ä¸ª URLï¼Œç„¶åè·å¾—å®ƒçš„å„ä¸ªç»„æˆéƒ¨åˆ†ï¼šhttp://i.cnblogs.com/EditPosts.aspx?opt=1 window.location.hrefï¼ˆè®¾ç½®æˆ–è·å–æ•´ä¸ª URL ä¸ºå­—ç¬¦ä¸²ï¼‰ var test = window.location.href; alert(test); è¿”å›ï¼šhttp://i.cnblogs.com/EditPosts.aspx?opt=1 window.location.protocolï¼ˆè®¾ç½®æˆ–è·å– URL çš„åè®®éƒ¨åˆ†ï¼‰ var test = window.location.protocol; alert(test); è¿”å›ï¼šhttp: window.location.hostï¼ˆè®¾ç½®æˆ–è·å– URL çš„ä¸»æœºéƒ¨åˆ†ï¼‰ var test = window.location.host; alert(test); è¿”å›ï¼ši.cnblogs.com window.location.portï¼ˆè®¾ç½®æˆ–è·å–ä¸ URL å…³è”çš„ç«¯å£å·ç ï¼‰ var test = window.location.port; alert(test); è¿”å›ï¼šç©ºå­—ç¬¦ï¼ˆå¦‚æœé‡‡ç”¨é»˜è®¤çš„ 80 ç«¯å£ (update: å³ä½¿æ·»åŠ äº†ï¼š80)ï¼Œé‚£ä¹ˆè¿”å›å€¼å¹¶ä¸æ˜¯é»˜è®¤çš„ 80 è€Œæ˜¯ç©ºå­—ç¬¦ï¼‰ window.location.pathnameï¼ˆè®¾ç½®æˆ–è·å–ä¸ URL çš„è·¯å¾„éƒ¨åˆ†ï¼ˆå°±æ˜¯æ–‡ä»¶åœ°å€ï¼‰) var test = window.location.pathname; alert(test); è¿”å›ï¼š/EditPosts.aspx window.location.searchï¼ˆè®¾ç½®æˆ–è·å– href å±æ€§ä¸­è·Ÿåœ¨é—®å·åé¢çš„éƒ¨åˆ†ï¼‰ var test = window.location.search; alert(test); è¿”å›ï¼š?opt=1 PSï¼šè·å¾—æŸ¥è¯¢ï¼ˆå‚æ•°ï¼‰éƒ¨åˆ†ï¼Œé™¤äº†ç»™åŠ¨æ€è¯­è¨€èµ‹å€¼ä»¥å¤–ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥ç»™é™æ€é¡µé¢ï¼Œå¹¶ä½¿ç”¨ javascript æ¥è·å¾—ç›¸ä¿¡åº”çš„å‚æ•°å€¼ã€‚ window.location.hashï¼ˆè®¾ç½®æˆ–è·å– href å±æ€§ä¸­åœ¨äº•å·â€œ#â€åé¢çš„åˆ†æ®µï¼‰ var test = window.location.hash; alert(test); è¿”å›ï¼šç©ºå­—ç¬¦ï¼ˆå› ä¸º url ä¸­æ²¡æœ‰ï¼‰ js è·å– url ä¸­çš„å‚æ•°å€¼ æ­£åˆ™æ³• function getQueryString(name) { var reg = new RegExp('(^|\u0026)' + name + '=([^\u0026]*)(\u0026|$)', 'i'); var r = window.location.search.substr(1).match(reg); if (r != null) { return unescape(r[2]); } return null; } // è¿™æ ·è°ƒç”¨ï¼š alert(GetQueryString(\"å‚æ•°å 1\")); alert(GetQueryString(\"å‚æ•°å 2\")); alert(GetQueryString(\"å‚æ•°å 3\")); split æ‹†åˆ†æ³• function GetRequest() { var url = location.search; //è·å– url ä¸­\"?\"ç¬¦åçš„å­—ä¸² var theRequest = new Object(); if (url.indexOf(\"?\") != -1) { var str = url.substr(1); strs = str.split(\"\u0026\"); for(var i = 0; i \u003c strs.length; i ++) { theRequest[strs[i].split(\"=\")[0]] = unescape(strs[i].split(\"=\")[1]); } } return theRequest; } var Request = new Object(); Request = GetRequest();\u003cbr\u003e// var id=Request[\"id\"]; // var å‚æ•° 1, å‚æ•° 2, å‚æ•° 3, å‚æ•° N; // å‚æ•° 1 = Request['å‚æ•° 1']; // å‚æ•° 2 = Request['å‚æ•° 2']; // å‚æ•° 3 = Request['å‚æ•° 3']; // å‚æ•° N = Request['å‚æ•° N']; æŒ‡å®šå– æ¯”å¦‚è¯´ä¸€ä¸ª urlï¼šhttp://i.cnblogs.com/?j=js, æˆ‘ä»¬æƒ³å¾—åˆ°å‚æ•° j çš„å€¼ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‡½æ•°è°ƒç”¨ã€‚ function GetQueryString(name) { var reg = new RegExp(\"(^|\u0026)\" + name + \"=([^\u0026]*)(\u0026|$)\", \"i\"); var r = window.location.search.substr(1).match(reg); //è·å– url ä¸­\"?\"ç¬¦åçš„å­—ç¬¦ä¸²å¹¶æ­£åˆ™åŒ¹é… var context = \"\"; if (r != null) context = r[2]; reg = null; r = null; return context == null || context == \"\" || context == \"undefined\" ? \"\" : context; } alert(GetQueryString(\"j\")); ","date":"2018-10-28","objectID":"/posts/href-301/:0:1","tags":["redirect","JavaScript","ä»–å±±ä¹‹çŸ³"],"title":"ä½¿ç”¨ js å‡†ç¡®è·å–å½“å‰é¡µé¢ url ç½‘å€ä¿¡æ¯åŠ 301 é‡å®šå‘å®æˆ˜","uri":"/posts/href-301/"},{"categories":["JavaScript"],"content":"301 é‡å®šå‘ï¼ˆå®è·µï¼‰ ç”±äºä¹‹å‰æŠŠ blog å’Œç½‘ç«™ä¸»é¡µåˆ†å¼€åœ¨ä¸¤ä¸ªä»“åº“æ‰€ä»¥è¦æƒ³åœ¨ blog ä¸­ menu é‡Œè·³è½¬åˆ°ç«™å¤–é“¾æ¥å°±è¦åšä¸€äº›å¤„ç†ã€‚ä»¥å‰ä¸€ç›´ç™¾åº¦ä¸åˆ°ã€‚ å…¶å®æƒ³æ³•æ—©å°±æœ‰äº†ï¼Œåªè¦åœ¨ blog é¦–é¡µæˆ–è€…ç½‘ç«™é¦–é¡µæ£€æµ‹åˆ°https://lruihao.cn/homeè¿™ä¸ªé“¾æ¥ï¼Œæˆ–è€…æ£€æµ‹åˆ° home å­—æ®µå°±è‡ªåŠ¨è·³è½¬ã€‚æƒ³æ³•å¾ˆç®€å•ã€‚å¯æ˜¯å¯¹ js çœŸçš„ä¸€ç‚¹éƒ½ä¸äº†è§£ï¼Œä»¥å‰ç™¾åº¦ä¹Ÿæ‰¾ä¸åˆ°å®é™…çš„æ•ˆæœæ¡ˆä¾‹ã€‚æ‰€ä»¥è¿˜æ˜¯è‡ªå·±å†™å§ï¼é™„ä¸Šè¹©è„šä»£ç ã€‚ var path = window.location.href; //alert(path); if (path=='https://lruihao.cn/home/') { window.location.replace(\"https://www.lruihao.cn\"); } æˆ–è€… var path = window.location.pathname; //alert(path); if (path=='/home/') { window.location.replace(\"https://www.lruihao.cn\"); } http å¼ºåˆ¶é‡å®šå‘ https \u003cscript\u003e var targetProtocol = \"https:\"; var host = \"lruihao.cn\"; //åŸŸååˆ¤æ–­ï¼Œå› ä¸º localhost ä»…æ”¯æŒ http if (window.location.host == host \u0026\u0026 window.location.protocol != targetProtocol){ window.location.href = targetProtocol + window.location.href.substring(window.location.protocol.length); } \u003c/script\u003e ","date":"2018-10-28","objectID":"/posts/href-301/:0:2","tags":["redirect","JavaScript","ä»–å±±ä¹‹çŸ³"],"title":"ä½¿ç”¨ js å‡†ç¡®è·å–å½“å‰é¡µé¢ url ç½‘å€ä¿¡æ¯åŠ 301 é‡å®šå‘å®æˆ˜","uri":"/posts/href-301/"},{"categories":["Grocery"],"content":" æˆ‘ç”¨çš„ win10 ","date":"2018-10-26","objectID":"/posts/web-server-win/:0:0","tags":["server","windows"],"title":"windows ä¸Šæ­å»º web æœåŠ¡å™¨","uri":"/posts/web-server-win/"},{"categories":["Grocery"],"content":"æ‰“å¼€æ§åˆ¶é¢æ¿ é€‰æ‹©å¹¶è¿›å…¥â€œç¨‹åºâ€ï¼ŒåŒå‡»â€œå¯ç”¨æˆ–å…³é—­ Windows æœåŠ¡â€ï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©â€œInternet Information Servicesâ€ä¸‹é¢æ‰€æœ‰åœ°é€‰é¡¹ï¼Œç‚¹å‡»ç¡®å®šåï¼Œå¼€å§‹æ›´æ–°æœåŠ¡ã€‚ æ‰“å¼€æ§åˆ¶é¢æ¿ ","date":"2018-10-26","objectID":"/posts/web-server-win/:0:1","tags":["server","windows"],"title":"windows ä¸Šæ­å»º web æœåŠ¡å™¨","uri":"/posts/web-server-win/"},{"categories":["Grocery"],"content":"æŸ¥çœ‹ æ›´æ–°å®Œæˆåï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥http://localhostæˆ–è€…127.0.0.1å›è½¦ï¼Œå¦‚æœæ­¤æ—¶å‡ºç° IIS7 æ¬¢è¿ç•Œé¢ï¼Œè¯´æ˜ Web æœåŠ¡å™¨å·²ç»æ­å»ºæˆåŠŸã€‚ æŸ¥çœ‹ ","date":"2018-10-26","objectID":"/posts/web-server-win/:0:2","tags":["server","windows"],"title":"windows ä¸Šæ­å»º web æœåŠ¡å™¨","uri":"/posts/web-server-win/"},{"categories":["Grocery"],"content":"ç½‘ç«™è®¾ç½® å½“ web æœåŠ¡å™¨æ­å»ºæˆåŠŸåï¼Œæˆ‘ä»¬ä¸‹ä¸€æ­¥æ‰€è¦åšçš„å°±æ˜¯æŠŠæˆ‘ä»¬å¼€å‘çš„ç½‘ç«™å®‰è£…åˆ° Web æœåŠ¡å™¨çš„ç›®å½•ä¸­ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“ Web æœåŠ¡å™¨å®‰è£…å®Œæˆåï¼Œä¼šåˆ›å»ºè·¯å¾„%ç³»ç»Ÿæ ¹ç›®å½•%inetpub/wwwrootï¼Œå°†æˆ‘ä»¬å¼€å‘çš„ç½‘ç«™ COPY åˆ°è¯¥è·¯å¾„ä¸‹ã€‚å³å¯å®ç°æœ¬åœ°è®¿é—®è¯¥ç½‘ç«™ã€‚ ä¹Ÿå¯ä»¥æ›´æ”¹æ ¹ç›®å½•ï¼Œæœç´¢ IISï¼Œç‚¹å‡»ç½‘ç«™ï¼ŒDefault Web Siteï¼ŒåŸºæœ¬è®¾ç½®ä¿®æ”¹ç‰©ç†è·¯å¾„ï¼ˆé»˜è®¤ç«™ç‚¹åç§°ä¸è¦æ”¹ï¼‰ æˆ‘è¿™é‡Œæ”¹åˆ°äº† hexo çš„ public ç›¸å½“äº hexo éƒ¨ç½²åœ¨æœ¬åœ°æœåŠ¡å™¨58.45.227.225 ","date":"2018-10-26","objectID":"/posts/web-server-win/:0:3","tags":["server","windows"],"title":"windows ä¸Šæ­å»º web æœåŠ¡å™¨","uri":"/posts/web-server-win/"},{"categories":["Grocery"],"content":"è®¾ç½®é˜²ç«å¢™ è®©å±€åŸŸç½‘å½“å…¶å®ƒè®¡ç®—æœºä¹Ÿèƒ½è®¿é—®æœ¬åœ°ç½‘ç«™èµ„æºã€‚å…·ä½“æ–¹æ³•ï¼šæ‰“å¼€æ§åˆ¶é¢æ¿ï¼Œé€‰æ‹©â€œç³»ç»Ÿå’Œå®‰å…¨â€ï¼Œç‚¹å‡»â€œå…è®¸ç¨‹åºé€šè¿‡ Windows é˜²ç«å¢™â€ï¼Œåœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­å‹¾é€‰â€œä¸‡ç»´ç½‘æœåŠ¡ HTTPâ€å³ä¾§çš„ä¸¤ä¸ªå¤é€‰æ¡†ï¼Œæœ€åç‚¹å‡»ç¡®å®šé€€å‡ºã€‚ åœ¨å±€åŸŸç½‘ä¸­å…¶å®ƒè®¡ç®—æœºä¸Šï¼Œæ‰“å¼€æµè§ˆå™¨å°±å¯ä»¥é€šè¿‡ä½ ç”µè„‘çš„ ip åœ°å€è®¿é—®äº†ï¼ˆæ‰‹æœºä¹Ÿå¯ä»¥ï¼‰ æœ¬åœ° ip å¯ä»¥é€šè¿‡ cmd ç”¨ ipconfig æŸ¥çœ‹ ","date":"2018-10-26","objectID":"/posts/web-server-win/:0:4","tags":["server","windows"],"title":"windows ä¸Šæ­å»º web æœåŠ¡å™¨","uri":"/posts/web-server-win/"},{"categories":["Git"],"content":"config git config --global user.name \"Your Name\" git config --global user.email \"email@example.com\" ç¬¬ä¸€æ¬¡ä½¿ç”¨ git çš„æ—¶å€™éœ€è¦è®¾ç½®æäº¤è€…ä¿¡æ¯ã€‚ æ³¨æ„ï¼š å¦‚æœç”¨äº† --global é€‰é¡¹ï¼Œé‚£ä¹ˆæ›´æ”¹çš„é…ç½®æ–‡ä»¶å°±æ˜¯ä½äºä½ ç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„é‚£ä¸ªï¼Œä»¥åä½ æ‰€æœ‰çš„é¡¹ç›®éƒ½ä¼šé»˜è®¤ä½¿ç”¨è¿™é‡Œé…ç½®çš„ç”¨æˆ·ä¿¡æ¯ã€‚ å¦‚æœè¦åœ¨æŸä¸ªç‰¹å®šçš„é¡¹ç›®ä¸­ä½¿ç”¨å…¶ä»–åå­—æˆ–è€…ç”µé‚®ï¼Œåªè¦å»æ‰ --global é€‰é¡¹é‡æ–°é…ç½®å³å¯ï¼Œæ–°çš„è®¾å®šä¿å­˜åœ¨å½“å‰é¡¹ç›®çš„ .git/config æ–‡ä»¶é‡Œã€‚ ","date":"2018-10-26","objectID":"/posts/gituse/:0:1","tags":["Git"],"title":"ä½¿ç”¨ Git ä¸Šä¼ ä»£ç åˆ° github, coding ç­‰ä»“åº“","uri":"/posts/gituse/"},{"categories":["Git"],"content":"ç”Ÿæˆ ssh ç”±äºä½ çš„æœ¬åœ° Git ä»“åº“å’Œ GitHub ä»“åº“ä¹‹é—´çš„ä¼ è¾“æ˜¯é€šè¿‡ SSH åŠ å¯†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é…ç½®éªŒè¯ä¿¡æ¯ï¼š ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆ SSH Keyï¼š ssh-keygen -t rsa -C \"youremail@example.com\" åé¢çš„ your_email@youremail.com æ”¹ä¸ºä½ åœ¨ Github ä¸Šæ³¨å†Œçš„é‚®ç®±ï¼Œä¹‹åä¼šè¦æ±‚ç¡®è®¤è·¯å¾„å’Œè¾“å…¥å¯†ç ï¼Œæˆ‘ä»¬è¿™ä½¿ç”¨é»˜è®¤çš„ä¸€è·¯å›è½¦å°±è¡Œã€‚æˆåŠŸçš„è¯ä¼šåœ¨ C:\\Users\\ç”¨æˆ·åã€æˆ–è€…~/ ä¸‹ç”Ÿæˆ .sshæ–‡ä»¶å¤¹ï¼Œè¿›å»ï¼Œæ‰“å¼€ id_rsa.pubï¼Œå¤åˆ¶é‡Œé¢çš„ keyã€‚å» githubã€coding ç­‰å¹³å°é…ç½® SSH å…¬é’¥ï¼ˆæ ¹æ®è‡ªå·±æƒ…å†µï¼‰ ","date":"2018-10-26","objectID":"/posts/gituse/:0:2","tags":["Git"],"title":"ä½¿ç”¨ Git ä¸Šä¼ ä»£ç åˆ° github, coding ç­‰ä»“åº“","uri":"/posts/gituse/"},{"categories":["Git"],"content":"åˆ›å»ºæœ¬åœ°ä»£ç åº“ åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä½œä¸ºä½ ä¸Šä¼ ä»£ç çš„æœ¬åœ°ä»“åº“ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶å¤¹å†…ç‚¹å‡»å³é”®ï¼Œé€‰æ‹© Git Bash Hereï¼Œé¦–å…ˆè¦åˆå§‹åŒ–æœ¬åœ°ä»“åº“ï¼š git init æ¥ä¸‹æ¥è¿›è¡Œè¿œç¨‹ä»£ç åº“å…‹éš†ï¼ˆäº‹å…ˆåœ¨ coding ç­‰ä¸­å»ºç«‹ä¸€ä¸ªé¡¹ç›®ï¼Œå°±æ˜¯ä½ éœ€è¦é“¾æ¥çš„ä»“åº“ï¼‰ git clone https://github.com/Lruihao/Lruihao.github.io.git å…‹éš†æ—¶ä¼šå‡ºç°è¾“å…¥è´¦å·å¯†ç çš„ç¯èŠ‚æ­£ç¡®è¾“å…¥å³å¯ã€‚ ","date":"2018-10-26","objectID":"/posts/gituse/:0:3","tags":["Git"],"title":"ä½¿ç”¨ Git ä¸Šä¼ ä»£ç åˆ° github, coding ç­‰ä»“åº“","uri":"/posts/gituse/"},{"categories":["Git"],"content":"ä»£ç æ¨é€ï¼ˆé‡ç‚¹ï¼‰ git status git add * git commit -m \"ä»£ç å¤‡æ³¨éšä¾¿å†™\" git push origin master Gearn Git Branching ","date":"2018-10-26","objectID":"/posts/gituse/:0:4","tags":["Git"],"title":"ä½¿ç”¨ Git ä¸Šä¼ ä»£ç åˆ° github, coding ç­‰ä»“åº“","uri":"/posts/gituse/"},{"categories":["Memo"],"content":" å‰é¢æœ‰ä¸€ç¯‡æ–‡ç« å†™åˆ°ä¸€äº›ï¼Œåœ¨ Android ä¸Šæ­å»º hexo åšå®¢ æœ¬æ–‡å½“åˆæ‘˜è¦è‡ª å›½å…‰ä¸ªäººåšå®¢ å¦‚è‹¥ä½œè€…åšå®¢ IP è¢«å¢™ï¼Œå¯å‰å¾€å›½å…‰ç¬¬ä¸‰æ–¹åšå®¢è¯¸å¦‚ csdn ç­‰ã€‚å¤‡ç”¨ ","date":"2018-10-23","objectID":"/posts/termux1/:0:0","tags":["Node.js","linux","termux"],"title":"termux åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","uri":"/posts/termux1/"},{"categories":["Memo"],"content":"åˆå§‹åŒ– ä¸‹è½½å¹¶åˆå§‹åŒ– termux å®‰è£… vim å®‰è£…ç¼–è¾‘å™¨ vim pkg install vim è§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜ åœ¨ home ç›®å½•ä¸‹ï¼Œæ–°å»º .vimrc æ–‡ä»¶ vim .vimrc æ·»åŠ å†…å®¹å¦‚ä¸‹ï¼š set fileencodings=utf-8,gb2312,gb18030,gbk,ucs-bom,cp936,latin1 set enc=utf8 set fencs=utf8,gbk,gb2312,gb18030 ç„¶å source ä¸‹å˜é‡ï¼š source .vimrc ä¿®æ”¹å¯åŠ¨é—®å€™è¯­ vim $PREFIX/etc/motd æŒ‰ i ç„¶åç¼–è¾‘ï¼Œæ¯”å¦‚ www.lruihao.cn æç‘è±ª Esc ç„¶åï¼šwq é€€å‡º ç®¡ç†å‘˜æƒé™ æ‰‹æœºå·²ç» root, å®‰è£… tsu, è¿™æ˜¯ä¸€ä¸ª su çš„ termux ç‰ˆæœ¬ï¼Œç”¨æ¥åœ¨ termux ä¸Šæ›¿ä»£ su: pkg install tsu ç„¶åç»ˆç«¯ä¸‹é¢è¾“å…¥ï¼š tsu å³å¯åˆ‡æ¢ root ç”¨æˆ·ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå¼¹å‡º root æˆæƒæç¤ºã€‚åœ¨ç®¡ç†å‘˜èº«ä»½ä¸‹ï¼Œè¾“å…¥ exit å¯å›åˆ°æ™®é€šç”¨æˆ·èº«ä»½ã€‚ ","date":"2018-10-23","objectID":"/posts/termux1/:0:1","tags":["Node.js","linux","termux"],"title":"termux åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","uri":"/posts/termux1/"},{"categories":["Memo"],"content":"ç¾åŒ– Termux-ohmyzsh ä½œç”¨ ï¼š ç¾åŒ–ä¹‹å¤–ï¼Œä¸»è¦ä½¿ç”¨äº† zsh æ¥æ›¿ä»£ bash ä½œä¸ºé»˜è®¤ shellã€‚ä½¿ç”¨ä¸€é”®å®‰è£…è„šæœ¬æ¥å®‰è£…ï¼Œä¸€æ­¥åˆ°ä½ï¼Œé¡ºä¾¿å¯åŠ¨äº†å¤–ç½®å­˜å‚¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—® SD å¡ä¸‹çš„ç›®å½•ï¼Œåˆ›å»ºè½¯æ–‡ä»¶å¤¹ã€‚ ä½¿ç”¨ sh -c \"$(curl -fsSL https://github.com/Cabbagec/termux-ohmyzsh/raw/master/install.sh)\" è®¾ç½®è‰²å½©æ ·å¼ï¼š è¿è¡Œ chcolor æ›´æ¢è‰²å½©æ ·å¼ï¼Œæˆ–è€…ï¼š ~/.termux/colors.sh è®¾ç½®å­—ä½“ è¿è¡Œ chfont æ›´æ¢å­—ä½“ï¼Œæˆ–è€…ï¼š ~/.termux/fonts.sh éœ€è¦è½¯ä»¶åŒ…ï¼š curl ","date":"2018-10-23","objectID":"/posts/termux1/:0:2","tags":["Node.js","linux","termux"],"title":"termux åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","uri":"/posts/termux1/"},{"categories":["Memo"],"content":"è®¿é—®å¤–ç½®å­˜å‚¨ æ‰§è¡Œè¿‡ä¸Šé¢çš„ zsh ä¸€é”®é…ç½®è„šæœ¬åï¼Œå¹¶ä¸”æˆäºˆæ–‡ä»¶è®¿é—®æƒé™çš„è¯ï¼Œä¼šåœ¨å®¶ç›®å½•ç”Ÿæˆ storage ç›®å½•ï¼Œå¹¶ä¸”ç”Ÿæˆè‹¥å¹²ç›®å½•ï¼Œè½¯è¿æ¥éƒ½æŒ‡å‘å¤–ç½®å­˜å‚¨å¡çš„ç›¸åº”ç›®å½• å¯ä»¥è®©ä»å¤–ç½®å‚¨å­˜å¤åˆ¶æ–‡ä»¶è¿› system åˆ†åŒº åˆ›å»º QQ æ–‡ä»¶å¤¹è½¯è¿æ¥ ln -s /data/data/com.termux/files/home/storage/shared/tencent/QQfile_recv QQ åˆ›å»º blog2 æ–‡ä»¶å¤¹è½¯è¿æ¥å¤‡ä»½æ–‡ä»¶ ln -s /data/data/com.termux/files/home/storage/shared/blog2 blog2 ","date":"2018-10-23","objectID":"/posts/termux1/:0:3","tags":["Node.js","linux","termux"],"title":"termux åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","uri":"/posts/termux1/"},{"categories":["Memo"],"content":"å®‰è£… hexo å®‰è£…å‡†å¤‡ pkg install nodejs pkg install git npm install hexo-cli -g npm install hexo-deployer-git --save pkg install openssh åˆå§‹åŒ– hexo hexo init blog cd blog hexo g hexo s æµè§ˆå™¨è¾“å…¥127.0.0.1:4000æŸ¥çœ‹æ•ˆæœ é“¾æ¥ github,coding,gitee ç­‰è¿œç¨‹ä»“åº“ ssh-keygen -t rsa -C \"your_email@example.com\" #è¿™å°†æŒ‰ç…§ä½ æä¾›çš„é‚®ç®±åœ°å€ï¼Œåˆ›å»ºä¸€å¯¹å¯†é’¥ï¼ˆä¸ªäººå–œæ¬¢ä¸€è·¯å›è½¦ï¼‰ æ‰¾åˆ°~/.ssh/id_rsa.pubè¿™ä¸ªæ–‡ä»¶å¤åˆ¶é‡Œé¢çš„å†…å®¹ï¼Œåˆ°å¯¹åº”çš„å¹³å°ç”Ÿæˆ SSH å…¬é’¥ è®¾ç½®ç”¨æˆ·ä¿¡æ¯ git config --global user.name \"lruihao\" git config --global user.email \"1074627678@qq.com\" æµ‹è¯•é“¾æ¥ ssh -T git@github.com #github ssh -T git@coding.net #coding ssh -T git@gitee.com #gitee æ³¨æ„#æ³¨é‡Šéƒ¨åˆ†ä¸è¦çš„ ç«™ç‚¹é…ç½®æ–‡ä»¶ æ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶å¡«å†™ä»£ç åº“ ä¾‹å¦‚æˆ‘çš„ deploy: - type: git repository: github: git@github.com:Lruihao/Lruihao.github.io.git,master coding: git@git.coding.net:liruihao/liruihao.git,master #message: \"æ—¥å¸¸æ›´æ–°\" éƒ¨ç½² hexo clean hexo g -d æ²¡å‡ºé”™å°±å¯ä»¥æ­£å¸¸é€šè¿‡ç›¸åº”åŸŸåè®¿é—®äº†ã€‚ https://lruihao.github.io https://liruihao.coding.me https://lruihao.gitee.io //æ‰‹æœº hexo æ•ˆæœå±•ç¤º ","date":"2018-10-23","objectID":"/posts/termux1/:0:4","tags":["Node.js","linux","termux"],"title":"termux åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","uri":"/posts/termux1/"},{"categories":["Memo"],"content":"ssh è¿æ¥ç”µè„‘æˆ–è€…æœåŠ¡å™¨ ssh root@118.24.217.167 ä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œlinux ä¸‹è¾“å…¥å¯†ç æ˜¯çœ‹ä¸åˆ°çš„ï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼Œå°å¿ƒç‚¹åˆ«è¾“å…¥é”™è¯¯ã€‚ ä¹‹åå°±å¯ä»¥æ‰‹æœºæ“ä½œæœåŠ¡å™¨äº†ã€‚ ","date":"2018-10-23","objectID":"/posts/termux1/:0:5","tags":["Node.js","linux","termux"],"title":"termux åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","uri":"/posts/termux1/"},{"categories":["Memo"],"content":"è§£å†³ npm å®‰è£…æŠ¥é”™ï¼ˆæœªéªŒè¯ï¼‰ vim $PREFIX/lib/node_modules/npm/node_modules/worker-farm/lib/farm.js æŠŠé‡Œé¢çš„ length æ”¹æˆ 4ï¼Œæˆ‘é»˜è®¤çš„æ˜¯ 1ã€‚ ","date":"2018-10-23","objectID":"/posts/termux1/:0:6","tags":["Node.js","linux","termux"],"title":"termux åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","uri":"/posts/termux1/"},{"categories":["Memo"],"content":"nyancat å½©è™¹çŒ« å½©è™¹è²“ï¼ˆè‹±è¯­ï¼šNyan Catï¼‰æ˜¯åœ¨ 2011 å¹´ 4 æœˆä¸Šä¼ åœ¨ Youtube çš„è§†é¢‘ï¼Œå¹¶ä¸”è¿…é€Ÿçˆ†çº¢äºç½‘ç»œï¼Œä¸¦åœ¨ 2011 å¹´ YouTube æµè§ˆé‡æœ€é«˜çš„è§†é¢‘ä¸­æ’åç¬¬äº”ã€‚ pkg install nyancat nyancat è¿˜æœ‰æ›´å¤šå§¿åŠ¿è¿™é‡Œå°±ä¸å†™äº†ï¼Œåªå†™ä¸€ä¸‹æ—¥å¸¸ç”¨åˆ°çš„ï¼Œå°±è¿™æ · OK ç¡è§‰ï¼ ","date":"2018-10-23","objectID":"/posts/termux1/:0:7","tags":["Node.js","linux","termux"],"title":"termux åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","uri":"/posts/termux1/"},{"categories":["Memo"],"content":"termux æ›´å¤šå¸¸ç”¨æœ‰è¶£å‘½ä»¤ï¼ˆé€‚ç”¨äº linuxï¼‰ vim $PREFIX/etc/motd chcolor chfont ~/.termux/colors.sh ~/.termux/fonts.sh echo \"https://www.lruihao.cn\" |curl -F-=\\\u003c- qrenco.de pkg install nyancat nyancat pkg install sl sl pkg install figlet figlet hello pkg install toilet toilet hello toilet -f mono12 -F gay \"hello\" pkg cowsay cowsay \"hello\" pkg install cmatrix cmatrix pkg install w3m w3m www.lruihao.cn cmatrix å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š cmatrix-a : å¼‚æ­¥æ»šåŠ¨ï¼ˆé»˜è®¤ï¼‰ cmatrix-b : éšæœºç²—ä½“ cmatrix-B : å…¨éƒ¨ç²—ä½“ cmatrix-o : ä½¿ç”¨æ—§é£æ ¼æ»šåŠ¨ cmatrix-x :X window æ¨¡å¼ cmatrix-V : æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ cmatrix-u : åˆ·æ–°é¢‘ç‡ï¼Œ0-9ï¼Œä¹Ÿå°±æ˜¯æ»šåŠ¨çš„å¿«æ…¢ cmatrix-C : æ˜¾ç¤ºçš„é¢œè‰²ï¼Œæ”¯æŒ greenï¼ˆé»˜è®¤ï¼‰,red,blue,white,yellow,cyan, magenta and black ä¾‹å¦‚ï¼šä½¿ç”¨çº¢è‰² cmatrix -b -C red ä½¿ç”¨è“è‰² cmatrix -b -C blue ç­‰ç­‰ ........ ä¸»ä¹‰ï¼šåœ¨è¿è¡ŒçŠ¶æ€ä¸‹ï¼Œä½¿ç”¨ 0-9 æ•°å­—ï¼Œå¯ä»¥æ”¹å˜è¿è¡Œé€Ÿåº¦å¿«æ…¢ã€‚ å¼€å¯ä½ çš„è£…é€¼ä¹‹è·¯æŠŠï¼Œéªšå¹´ï¼ ","date":"2018-10-23","objectID":"/posts/termux1/:0:8","tags":["Node.js","linux","termux"],"title":"termux åŸºæœ¬ä½¿ç”¨æ•™ç¨‹","uri":"/posts/termux1/"},{"categories":["Grocery"],"content":"html ç½‘é¡µå¼•ç”¨ä¸­æ–‡å­—ä½“ï¼Œæ–‡ä»¶è¿‡å¤§ï¼ŒåŠ è½½ç¼“æ…¢çš„è§£å†³åŠæ³•","date":"2018-10-17","objectID":"/posts/web-font/","tags":["Node.js","å­—ä½“å‹ç¼©"],"title":"ttf å­—ä½“å‹ç¼©","uri":"/posts/web-font/"},{"categories":["Grocery"],"content":"å®‰è£… nodeJs è¿™ä¸ªä¸å¤šè¯´ï¼Œéƒ½æœ‰ã€‚ ","date":"2018-10-17","objectID":"/posts/web-font/:0:1","tags":["Node.js","å­—ä½“å‹ç¼©"],"title":"ttf å­—ä½“å‹ç¼©","uri":"/posts/web-font/"},{"categories":["Grocery"],"content":"å®‰è£…å­—è›› è¾“å…¥å‘½ä»¤ npm install font-spider -g ","date":"2018-10-17","objectID":"/posts/web-font/:0:2","tags":["Node.js","å­—ä½“å‹ç¼©"],"title":"ttf å­—ä½“å‹ç¼©","uri":"/posts/web-font/"},{"categories":["Grocery"],"content":"è¿è¡Œ å®‰è£…æˆåŠŸä¹‹åå°±å¼€å§‹å‹ç¼©äº† æˆ‘çš„ css \u003cstyle type=\"text/css\"\u003e @font-face { font-family: MMT; src: url(\"font/MMT_579767_SOAJ0_0.ttf\"); } \u003c/style\u003e ç”Ÿæˆæ–°çš„å­—ä½“åº“ï¼Œå‘½ä»¤è¡Œè¾“å…¥ font-spider C:\\Users\\æç‘è±ªã€Desktop\\love\\index.html å®˜ç½‘ ","date":"2018-10-17","objectID":"/posts/web-font/:0:3","tags":["Node.js","å­—ä½“å‹ç¼©"],"title":"ttf å­—ä½“å‹ç¼©","uri":"/posts/web-font/"},{"categories":["OS"],"content":" åœ¨ Linux ä¸Šç¼–è¯‘ c è¯­è¨€æ–‡ä»¶ã€‚ ","date":"2018-10-15","objectID":"/posts/linux-hello-c/:0:0","tags":["linux","C"],"title":"linux ç¼–ç¨‹åˆä½“éªŒ","uri":"/posts/linux-hello-c/"},{"categories":["OS"],"content":"æ‰“å¼€ vim ç¼–è¾‘å™¨ ï¼ˆæ²¡æœ‰å°±ç”¨ vi, æˆ–è€…å…ˆå®‰è£… vimsudo apt-get install vim) $ vim ","date":"2018-10-15","objectID":"/posts/linux-hello-c/:0:1","tags":["linux","C"],"title":"linux ç¼–ç¨‹åˆä½“éªŒ","uri":"/posts/linux-hello-c/"},{"categories":["OS"],"content":"ç¼–è¾‘æ–‡ä»¶ æ‰“å¼€æ–‡ä»¶ç¼–è¾‘å™¨ä¹‹åç¼–è¾‘æ–‡ä»¶ é¦–å…ˆæŒ‰Escå†:è¿›å…¥æœ«è¡Œå‘½ä»¤ å†ä¿å­˜ä¸º hello.c æ–‡ä»¶åé€€å‡º : w hello.c : q æ‰“å¼€ç›®å½•çœ‹çœ‹ç”Ÿæˆçš„æ–‡ä»¶ $ ls ","date":"2018-10-15","objectID":"/posts/linux-hello-c/:0:2","tags":["linux","C"],"title":"linux ç¼–ç¨‹åˆä½“éªŒ","uri":"/posts/linux-hello-c/"},{"categories":["OS"],"content":"ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶å¹¶æ‰§è¡Œ $ gcc hello.c -o hello $ ./hello è‹¥æƒé™ä¸å¤Ÿåˆ™åŠ å¯æ‰§è¡Œæƒé™chmod +x hello ","date":"2018-10-15","objectID":"/posts/linux-hello-c/:0:3","tags":["linux","C"],"title":"linux ç¼–ç¨‹åˆä½“éªŒ","uri":"/posts/linux-hello-c/"},{"categories":["Projects"],"content":"é¢„è§ˆ {{ message || 'ã€Œæ²ç›®ä¹‹ï¼Œæ¹˜ä¹Ÿã€\\n ä»ä¸‹ç¬”åˆ°åœç¬”ï¼Œä»å¼€å§‹åˆ°ç»“æŸï¼Œæ²ç›®ä½“è§è¯äº†æˆ‘ä»¬ç¨šå«©åˆ°æˆç†Ÿã€‚\\næ•…äº‹çš„å¼€å¤´å¾€å¾€æå…·æ¸©æŸ”ï¼Œä½†ç»“å±€å¸¸å¸¸ä¸å°½äººæ„ã€‚\\né‚£äº›å¿˜ä¸æ‰çš„äººå’Œäº‹ï¼Œå²æœˆéƒ½å·²æ›¿æˆ‘è½»ææ·¡å†™ã€‚' }} From playlist, Powered By mmt-netease ç‚¹å‡»å±•å¼€æ›´å¤š ã€Šå¯Œå£«å±±ä¸‹ã€‹ ã€Šçˆ±æƒ…è½¬ç§»ã€‹ å‰å°˜ç¡¬åŒ–åƒçŸ³å¤´ é˜³å…‰åœ¨èº«ä¸Šæµè½¬ éšç¼˜åœ°æŠ›ä¸‹ä¾¿é€ƒèµ° ç­‰æ‰€æœ‰ä¸šéšœè¢«åŸè°… æˆ‘ç»ä¸ç½•æœ‰ çˆ±æƒ…ä¸åœç«™ å¾€è¡—é‡Œç»•è¿‡ä¸€å‘¨ æƒ³å¼€å¾€åœ°è€å¤©è’ æˆ‘ä¾¿åŒ–ä¹Œæœ‰ éœ€è¦å¤šå‹‡æ•¢ ä½ è¿˜å«Œä¸å¤Ÿ ä½ ä¸è¦å¤±æœ› æˆ‘æŠŠè¿™é™ˆå¹´é£è¤› è¡æ°”å›è‚ æ˜¯ä¸ºäº† é€èµ ä½ è§£å’’ æœ€ç¾çš„å¹³å‡¡ ","date":"2018-10-12","objectID":"/projects/font-mmt/:1:0","tags":["æ²ç›®ä½“"],"title":"æ²ç›®ä½“","uri":"/projects/font-mmt/"},{"categories":["Projects"],"content":"ä¸‹è½½ è­¦å‘Š æ²ç›®ä½“ ä»…ç”¨äºä¸ªäººéå•†ç”¨ï¼ ","date":"2018-10-12","objectID":"/projects/font-mmt/:2:0","tags":["æ²ç›®ä½“"],"title":"æ²ç›®ä½“","uri":"/projects/font-mmt/"},{"categories":["Grocery"],"content":"æ¦‚å¿µ æµæ°´çº¿æ˜¯æŒ‡åœ¨ç¨‹åºæ‰§è¡Œæ—¶å¤šæ¡æŒ‡ä»¤é‡å è¿›è¡Œæ“ä½œçš„ä¸€ç§å‡†å¹¶è¡Œå¤„ç†å®ç°æŠ€æœ¯ã€‚å„ç§éƒ¨ä»¶åŒæ—¶å¤„ç†æ˜¯é’ˆå¯¹ä¸åŒæŒ‡ä»¤è€Œè¨€çš„ï¼Œå®ƒä»¬å¯åŒæ—¶ä¸ºå¤šæ¡æŒ‡ä»¤çš„ä¸åŒéƒ¨åˆ†è¿›è¡Œå·¥ä½œï¼Œä»¥æé«˜å„éƒ¨ä»¶çš„åˆ©ç”¨ç‡å’ŒæŒ‡ä»¤çš„å¹³å‡æ‰§è¡Œé€Ÿåº¦ã€‚ æœªä½¿ç”¨æµæ°´çº¿ ä½¿ç”¨æµæ°´çº¿ æµæ°´çº¿å‘¨æœŸä¸ºæ‰§è¡Œæ—¶é—´æœ€é•¿çš„ä¸€æ®µã€‚ ","date":"2018-10-09","objectID":"/posts/liushuixian/:1:0","tags":["æµæ°´çº¿","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"æµæ°´çº¿","uri":"/posts/liushuixian/"},{"categories":["Grocery"],"content":"æµæ°´çº¿è®¡ç®—å…¬å¼ é¦–å…ˆä½¿ç”¨ç†è®ºå…¬å¼ï¼Œæ²¡æœ‰ç­”æ¡ˆç”¨å®è·µå…¬å¼ã€‚ ","date":"2018-10-09","objectID":"/posts/liushuixian/:2:0","tags":["æµæ°´çº¿","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"æµæ°´çº¿","uri":"/posts/liushuixian/"},{"categories":["Grocery"],"content":"æµæ°´çº¿ååç‡è®¡ç®— æµæ°´çº¿ååç‡æ˜¯æŒ‡å•ä½æ—¶é—´å†…å¤„ç†çš„ä»»åŠ¡çš„æ•°é‡ã€‚ åŸºæœ¬å…¬å¼ æœ€å¤§ååç‡ ","date":"2018-10-09","objectID":"/posts/liushuixian/:3:0","tags":["æµæ°´çº¿","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"æµæ°´çº¿","uri":"/posts/liushuixian/"},{"categories":["Grocery"],"content":"æµæ°´çº¿åŠ é€Ÿæ¯” å®Œæˆä¸€æ‰¹ä»»åŠ¡ï¼Œä¸ä½¿ç”¨æµæ°´çº¿æ‰€ç”¨çš„æ—¶é—´ä¸ä½¿ç”¨æµæ°´çº¿æ‰€ç”¨çš„æ—¶é—´ä¹‹æ¯”ç§°ä¸ºæµæ°´çº¿çš„åŠ é€Ÿæ¯”ã€‚ å…¬å¼ï¼š S=ä¸ä½¿ç”¨æµæ°´çº¿æ‰§è¡Œæ—¶é—´/ä½¿ç”¨æµæ°´çº¿æ‰§è¡Œæ—¶é—´ æµæ°´çº¿åŠ é€Ÿæ¯”è¶Šé«˜è¶Šå¥½ï¼Œè¯´æ˜ä½¿ç”¨æµæ°´çº¿çš„æ•ˆæœã€‚ ","date":"2018-10-09","objectID":"/posts/liushuixian/:4:0","tags":["æµæ°´çº¿","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"æµæ°´çº¿","uri":"/posts/liushuixian/"},{"categories":["Grocery"],"content":"æµæ°´çº¿çš„æ•ˆç‡ ","date":"2018-10-09","objectID":"/posts/liushuixian/:5:0","tags":["æµæ°´çº¿","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"æµæ°´çº¿","uri":"/posts/liushuixian/"},{"categories":["Grocery"],"content":"ä¾‹é¢˜ ","date":"2018-10-09","objectID":"/posts/liushuixian/:6:0","tags":["æµæ°´çº¿","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"æµæ°´çº¿","uri":"/posts/liushuixian/"},{"categories":["Grocery"],"content":"å…¶ä»– ","date":"2018-10-09","objectID":"/posts/liushuixian/:7:0","tags":["æµæ°´çº¿","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"æµæ°´çº¿","uri":"/posts/liushuixian/"},{"categories":["Grocery"],"content":"ä¸»æœº ","date":"2018-10-09","objectID":"/posts/liushuixian/:7:1","tags":["æµæ°´çº¿","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"æµæ°´çº¿","uri":"/posts/liushuixian/"},{"categories":["Grocery"],"content":"CISC å’Œ RISC ç±»å‹ æŒ‡ä»¤ å¯»å€æ–¹å¼ å®ç°æ–¹å¼ å…¶ä»– CISCï¼ˆå¤æ‚æŒ‡ä»¤é›†ï¼‰ æ•°é‡å¤šï¼Œä½¿ç”¨é¢‘ç‡å·®åˆ«å¤§ï¼Œå¯å˜é•¿æ ¼å¼ æ”¯æŒå¤šç§ å¾®ç¨‹åºæ§åˆ¶æŠ€æœ¯ï¼ˆå¾®ç ï¼‰ ç ”åˆ¶å‘¨æœŸé•¿ RISCï¼ˆç²¾ç®€æŒ‡ä»¤é›†ï¼‰ æ•°é‡å°‘ï¼Œä½¿ç”¨é¢‘ç‡æ¥è¿‘ï¼Œå®šé•¿æ ¼å¼ï¼Œå¤§éƒ¨åˆ†ä¸ºå•å‘¨æœŸæŒ‡ä»¤ï¼Œæ“ä½œå¯„å­˜å™¨ï¼Œåªæœ‰ Load/Store æ“ä½œå†…å­˜ æ”¯æŒæ–¹å¼å°‘ å¢åŠ äº†é€šç”¨å¯„å­˜å™¨ï¼›ç¡¬å¸ƒçº¿é€»è¾‘æ§åˆ¶ä¸ºä¸»ï¼›é€‚åˆé‡‡ç”¨æµæ°´çº¿ ä¼˜åŒ–ç¼–ç ï¼Œæœ‰æ•ˆæ”¯æŒé«˜çº§è¯­è¨€ ","date":"2018-10-09","objectID":"/posts/liushuixian/:7:2","tags":["æµæ°´çº¿","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"æµæ°´çº¿","uri":"/posts/liushuixian/"},{"categories":["Grocery"],"content":"æ•°æ®çš„è¡¨ç¤º æ•°æ®çš„è¡¨ç¤ºå¯åˆ†ä¸ºï¼šåŸç ï¼Œåç å’Œè¡¥ç ã€‚ï¼ˆäºŒè¿›åˆ¶ï¼‰ åŸç ï¼š ç¬¦å·ä½ 0 ä¸ºæ­£ï¼Œ1 ä¸ºè´Ÿã€‚ åç ï¼š ç¬¦å·ä½ 0 ä¸ºæ­£ï¼Œ1 ä¸ºè´Ÿã€‚ æ­£æ•°ï¼š åç åŒåŸç ã€‚ è´Ÿæ•°ï¼š ç¬¦å·ä½é™¤å¤–å…¶ä»–ä½æŒ‰ä½å–åã€‚ è¡¥ç ï¼š æ­£æ•°ï¼š åŒåŸç ã€‚ è´Ÿæ•°ï¼š ç¬¦å·ä½é™¤å¤–å…¶ä»–ä½æŒ‰ä½å–åå†+1ã€‚ ç§»ç ï¼š è¡¥ç ç¬¦å·ä½å–åã€‚ ","date":"2018-10-08","objectID":"/posts/data/:0:1","tags":["è®¡ç®—æœºæ•°æ®","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"è®¡ç®—æœºæ•°æ®","uri":"/posts/data/"},{"categories":["Grocery"],"content":"æ•°æ®è¡¨ç¤ºèŒƒå›´ åŸç ï¼š -(z^n-1 - 1) ~ 2^n-1 - 1 åç ï¼š -(z^n-1 - 1) ~ 2^n-1 - 1 è¡¥ç ï¼š -z^n-1 ~ 2^n-1 - 1 ï¼ˆè¡¥ç æ­£ 0 å’Œè´Ÿ 0 ç›¸åŒï¼Œå°‘å ä¸€æ•°ä½ï¼Œå°±å¤šä¸€ä¸ªèŒƒå›´ï¼‰ ä¾‹ï¼š 8 ä½äºŒè¿›åˆ¶ï¼Œé™¤å»ç¬¦å·ä½è¿˜æœ‰ 7 ä½ï¼Œ7 ä¸ª 1 ä¸ºæœ€å¤§æ•°ï¼Œç›¸å½“äº 8 ä¸ª 1 å‡ 1ï¼Œä¹Ÿå°±æ˜¯ 2^7-1, æ‰€ä»¥èŒƒå›´å°±ç®—å‡ºæ¥äº†ã€‚ ","date":"2018-10-08","objectID":"/posts/data/:0:2","tags":["è®¡ç®—æœºæ•°æ®","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"è®¡ç®—æœºæ•°æ®","uri":"/posts/data/"},{"categories":["Grocery"],"content":"æµ®ç‚¹æ•°è¿ç®— å¯¹é˜¶ï¼ˆå°é˜¶å¯¹å¤§é˜¶ï¼‰+ å°¾æ•°è®¡ç®—ï¼ˆç§‘å­¦è®¡æ•°æ³•ï¼‰+ ç»“æœè§„æ ¼åŒ–ï¼ˆç§‘å­¦æŠ€æœ¯æ³•ï¼‰ ","date":"2018-10-08","objectID":"/posts/data/:0:3","tags":["è®¡ç®—æœºæ•°æ®","è®¡ç®—æœºç»„æˆä¸ä½“ç³»ç»“æ„"],"title":"è®¡ç®—æœºæ•°æ®","uri":"/posts/data/"},{"categories":["JavaScript"],"content":" è¿™å‡ å¤©çœ‹åˆ°åˆ«äººçš„åšå®¢æœ‰å¼€å…³ç¯æ•ˆæœï¼Œå°±æƒ³ç»™è‡ªå·±çš„åšå®¢ä¹ŸåŠ ä¸€ä¸ªï¼Œå…¶å®ä»¥å‰å°±åœ¨æƒ³äº†ã€‚ç»è¿‡è°·æ­Œç™¾åº¦åè¿™æ ·å®ç°äº†ã€‚css+js å¦‚ä½•ç»™ Web é¡µé¢å¢åŠ å¤œé—´æ¨¡å¼åŠŸèƒ½ï¼Ÿå…¶å®æ‰€è°“çš„å¤œé—´æ¨¡å¼å°±æ˜¯åœ¨é¡µé¢ä¸Šå¢åŠ ä¸€ä¸ªé€æ˜çš„é®ç½©å±‚ï¼Œä½†æ˜¯é®ç½©å±‚ä¼šæŒ¡ä½é¡µé¢å…ƒç´ ï¼Œ è§£å†³æ–¹æ³•æ˜¯ æ·»åŠ  DIVï¼Œç»™ DIV çš„ outline å±æ€§ä¸€ä¸ªå¾ˆå¤§çš„ outline-width å€¼ï¼Œç”¨ outline çš„è¾¹æ¡†ä½œä¸ºé®ç½©ï¼Œè¿™æ ·æ—¢èƒ½æ­£å¸¸ç‚¹å‡»é¡µé¢å…ƒç´ ï¼Œåˆèƒ½è¾¾åˆ°å¤œé—´æ¨¡å¼çš„æ•ˆæœã€‚ ","date":"2018-09-27","objectID":"/posts/night/:0:0","tags":["JavaScript"],"title":"ç½‘é¡µå¤œé—´æ•ˆæœ","uri":"/posts/night/"},{"categories":["JavaScript"],"content":"css éƒ¨åˆ† \u003cstyle\u003e .cover{ position:fixed; top: 0px; left: 0px; outline:5000px solid rgba(0, 0, 0, 0);//åˆå§‹äº®åº¦ z-index: 99999; } \u003c/style\u003e ","date":"2018-09-27","objectID":"/posts/night/:0:1","tags":["JavaScript"],"title":"ç½‘é¡µå¤œé—´æ•ˆæœ","uri":"/posts/night/"},{"categories":["JavaScript"],"content":"js éƒ¨åˆ† \u003cscript\u003e var brightness; //æ˜¾ç¤ºé®ç½© function cover(brightness) { if (typeof(div) == 'undefined') { div = document.createElement('div'); div.setAttribute('style', 'position:fixed;top:0;left:0;outline:5000px solid;z-index:99999;'); document.body.appendChild(div); } else { div.style.display = ''; } div.style.outlineColor = 'rgba(0,0,0,' + brightness + ')'; } //äº‹ä»¶ç›‘å¬ window.addEventListener('keydown', function(e) { if (e.altKey \u0026\u0026 e.keyCode == 90) { cover(brightness = 0.3); } if (e.altKey \u0026\u0026 e.keyCode == 88) { cover(brightness = 0); } if (e.altKey \u0026\u0026 e.keyCode == 38) { if (brightness - 0.05 \u003e 0.05) cover(brightness -= 0.05); } if (e.altKey \u0026\u0026 e.keyCode == 40) { if (brightness + 0.05 \u003c 0.95) cover(brightness += 0.05); } }, false); \u003c/script\u003e ","date":"2018-09-27","objectID":"/posts/night/:0:2","tags":["JavaScript"],"title":"ç½‘é¡µå¤œé—´æ•ˆæœ","uri":"/posts/night/"},{"categories":["JavaScript"],"content":"html éƒ¨åˆ† \u003cdiv class=\"cover\"\u003e\u003c/div\u003e ","date":"2018-09-27","objectID":"/posts/night/:0:3","tags":["JavaScript"],"title":"ç½‘é¡µå¤œé—´æ•ˆæœ","uri":"/posts/night/"},{"categories":["JavaScript"],"content":"ä½¿ç”¨ Alt+Z: æ‰“å¼€å¤œé—´æ¨¡å¼ Alt+X: å…³é—­ Alt+â†‘: å¢åŠ äº®åº¦ Alt+â†“: é™ä½äº®åº¦ ","date":"2018-09-27","objectID":"/posts/night/:0:4","tags":["JavaScript"],"title":"ç½‘é¡µå¤œé—´æ•ˆæœ","uri":"/posts/night/"},{"categories":["JavaScript"],"content":" ä»æš‘å‡åˆ°ç°åœ¨æœ‰å¥½å‡ ä¸ªå°ä¼™ä¼´é—®æˆ‘åšå®¢çš„æ ‡é¢˜æ€ä¹ˆå˜æ¥å˜å»çš„ï¼Œä¸æƒ³å†å’Œæ¯ä¸ªäººéƒ½è¯´ä¸€éäº†ï¼Œè€½è¯¯æ—¶é—´ï¼Œç´¢æ€§å†™ä¸€ä¸‹ã€‚ ","date":"2018-09-26","objectID":"/posts/crash-cheat/:0:0","tags":["JavaScript","hexo"],"title":"ç½‘é¡µç¦»å¼€æ—¶æ”¹å˜æ ‡é¢˜â€œå´©æºƒæ¬ºéª—â€","uri":"/posts/crash-cheat/"},{"categories":["JavaScript"],"content":"åˆ›å»ºä¸€ä¸ª js æ–‡ä»¶ æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ª js æ–‡ä»¶ï¼Œæˆ‘ä»¬ç”¨è®°äº‹æœ¬å°±å¥½äº†ï¼Œç„¶åæ”¹ä¸ªæ–‡ä»¶åï¼Œä¸å¦¨å°±å«crash-cheat.jså§ï¼Œä½ ä»¬å¯ä»¥éšæ„ï¼ ç„¶åæŠŠæ–‡ä»¶æ”¾åˆ° source æ–‡ä»¶å¤¹çš„ js æ–‡ä»¶å¤¹çš„ src é‡Œé¢ã€‚ï¼ˆæˆ‘ç”¨çš„ next ä¸»é¢˜ï¼Œæ”¾è¿™é‡Œç»Ÿä¸€å­˜æ”¾ï¼Œå…¶ä»–ä¸»é¢˜éšæ„ï¼‰ å´©æºƒæ¬ºéª— (Jquery ç‰ˆï¼‰ var OriginTitle = document.title; var titleTime; document.addEventListener('visibilitychange', function () { if (document.hidden) { $('[rel=\"icon\"]').attr('href', 'https://i.loli.net/2018/08/24/5b7fcb00ed9bf.png'); document.title = 'æ€ä¹ˆå›äº‹â•­(Â°AÂ°`)â•®'; clearTimeout(titleTime); } else { $(\"[rel='icon']\").attr('href', 'https://i.loli.net/2018/09/25/5baa4f21661e7.png'); document.title = 'å°è€å¼Ÿ (à¸…\u003eÏ‰\u003c*à¸…)'; titleTime = setTimeout(function () { document.title = OriginTitle; $(\"[rel='icon']\").attr('href', '/images/favicon-32x32-next.png'); }, 2000); } }); å´©æºƒæ¬ºéª— (JS ç‰ˆï¼‰ var oldTitle = document.title; var titleTime; //æ¨™é¡Œæ¢å¾©è¨ˆæ™‚å™¨ document.addEventListener('visibilitychange', function () { if (document.hidden) { document.querySelector(\"[rel='icon']\").setAttribute('href', '/images/icons/favicon-32.png'); document.title = 'ç¶²ç«™å´©æ½°äº†ï¼'; clearTimeout(titleTime); } else { document.title = 'å…¶å¯¦ä¸¦æ²’æœ‰ï¼'; document.querySelector(\"[rel='icon']\").setAttribute('href', '/images/icons/crash.png'); titleTime = setTimeout(function () { document.title = oldTitle; }, 1000); } }); ","date":"2018-09-26","objectID":"/posts/crash-cheat/:1:0","tags":["JavaScript","hexo"],"title":"ç½‘é¡µç¦»å¼€æ—¶æ”¹å˜æ ‡é¢˜â€œå´©æºƒæ¬ºéª—â€","uri":"/posts/crash-cheat/"},{"categories":["JavaScript"],"content":"ä½¿ç”¨ åœ¨hexo\\themes\\hexo-theme-next\\layoutæ–‡ä»¶è·¯å¾„æ‰¾åˆ°layout.swigæ–‡ä»¶ï¼Œå…¶ä»–æœ‰äº›ä¸»é¢˜ç”¨çš„æ˜¯.ejsåç¼€ï¼Œä¸€æ ·çš„ã€‚ ç„¶åæ‰“å¼€æ–‡ä»¶ï¼Œåœ¨\u003cbody\u003e\u003c/body\u003eä¹‹é—´åŠ å…¥è°ƒç”¨åˆšåˆšçš„ jsã€‚ \u003cscript type=\"text/javascript\" src=\"/js/src/crash-cheat.js\"\u003e\u003c/script\u003e é‡æ–°éƒ¨ç½²åšå®¢å°±å¯ä»¥äº†ã€‚ ","date":"2018-09-26","objectID":"/posts/crash-cheat/:2:0","tags":["JavaScript","hexo"],"title":"ç½‘é¡µç¦»å¼€æ—¶æ”¹å˜æ ‡é¢˜â€œå´©æºƒæ¬ºéª—â€","uri":"/posts/crash-cheat/"},{"categories":["Git","OS"],"content":"ä¸‹è½½ git wget https://github.com/git/git/archive/v2.14.1.zip ","date":"2018-09-22","objectID":"/posts/linux-git/:0:1","tags":["Git","linux"],"title":"linux/centos ä¸‹çš„å®‰è£… git","uri":"/posts/linux-git/"},{"categories":["Git","OS"],"content":"å®‰è£…ä¾èµ– sudo yum -y install zlib-devel openssl-devel cpio expat-devel gettext-devel curl-devel perl-ExtUtils-CBuilder perl-ExtUtils-MakeMaker ","date":"2018-09-22","objectID":"/posts/linux-git/:0:2","tags":["Git","linux"],"title":"linux/centos ä¸‹çš„å®‰è£… git","uri":"/posts/linux-git/"},{"categories":["Git","OS"],"content":"è§£å‹ git unzip v2.14.1.zip æ³¨ï¼š unzip å‘½ä»¤ç”¨ä¸äº†ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š #yum list | grep zip/unzipÂ #yum install zip #yum install unzip åŸºæœ¬å®Œæˆï¼Œå¦‚æœåœ¨ç¼–è¯‘çš„æ—¶å€™å‡ºç°é”™è¯¯ï¼šgcc : error trying to exec 'cc1plus': execvp : No sunch file or directory å¯ä»¥ç”¨gcc -v/g++ -v æ¥æŸ¥çœ‹ gcc ç‰ˆæœ¬ï¼Œä¼šå‘ç°æ²¡æœ‰å®‰è£…ã€‚å®‰è£…å¦‚ä¸‹ï¼š #yum list | grep gcc #yum install gcc-c++ #yum install unzip ","date":"2018-09-22","objectID":"/posts/linux-git/:0:3","tags":["Git","linux"],"title":"linux/centos ä¸‹çš„å®‰è£… git","uri":"/posts/linux-git/"},{"categories":["Git","OS"],"content":"å°† git å®‰è£…åˆ°/usr/local ä¸Š å…ˆè¿›å…¥ git æ–‡ä»¶å¤¹ ç¼–è¯‘ å®‰è£… cd git-2.14.1 make prefix=/usr/local all make prefix=/usr/local install ","date":"2018-09-22","objectID":"/posts/linux-git/:0:4","tags":["Git","linux"],"title":"linux/centos ä¸‹çš„å®‰è£… git","uri":"/posts/linux-git/"},{"categories":["Git","OS"],"content":"éªŒè¯æ˜¯å¦å®‰è£…å®Œæˆ git --version â€¦ ","date":"2018-09-22","objectID":"/posts/linux-git/:0:5","tags":["Git","linux"],"title":"linux/centos ä¸‹çš„å®‰è£… git","uri":"/posts/linux-git/"},{"categories":["Memo"],"content":"Vim é€ŸæŸ¥è¡¨-å¸®ä½ æé«˜ N å€æ•ˆç‡ ","date":"2018-08-31","objectID":"/posts/vim/:0:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"è¿›å…¥ vim å‘½ä»¤ æè¿° vim filename æ‰“å¼€æˆ–æ–°å»ºæ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºç¬¬ä¸€è¡Œé¦– vim +n filename æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºç¬¬ n è¡Œé¦– vim + filename æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºæœ€åä¸€è¡Œé¦– vim +/pattern filename æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºç¬¬ä¸€ä¸ªä¸ pattern åŒ¹é…çš„ä¸²å¤„ vim -r filename åœ¨ä¸Šæ¬¡æ­£ç”¨ vim ç¼–è¾‘æ—¶å‘ç”Ÿç³»ç»Ÿå´©æºƒï¼Œæ¢å¤ filename vim filenameâ€¦.filename æ‰“å¼€å¤šä¸ªæ–‡ä»¶ï¼Œä¾æ¬¡ç¼–è¾‘ ","date":"2018-08-31","objectID":"/posts/vim/:1:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"vim é…ç½® å‘½ä»¤ æè¿° all åˆ—å‡ºæ‰€æœ‰é€‰é¡¹è®¾ç½®æƒ…å†µ term è®¾ç½®ç»ˆç«¯ç±»å‹ ignorance åœ¨æœç´¢ä¸­å¿½ç•¥å¤§å°å†™ list æ˜¾ç¤ºåˆ¶è¡¨ä½ (Ctrl+I) å’Œè¡Œå°¾æ ‡å¿—ï¼ˆ$) number æ˜¾ç¤ºè¡Œå· report æ˜¾ç¤ºç”±é¢å‘è¡Œçš„å‘½ä»¤ä¿®æ”¹è¿‡çš„æ•°ç›® terse æ˜¾ç¤ºç®€çŸ­çš„è­¦å‘Šä¿¡æ¯ warn åœ¨è½¬åˆ°åˆ«çš„æ–‡ä»¶æ—¶è‹¥æ²¡ä¿å­˜å½“å‰æ–‡ä»¶åˆ™æ˜¾ç¤º NO write ä¿¡æ¯ nomagic å…è®¸åœ¨æœç´¢æ¨¡å¼ä¸­ï¼Œä½¿ç”¨å‰é¢ä¸å¸¦â€œ\\â€çš„ç‰¹æ®Šå­—ç¬¦ nowrapscan ç¦æ­¢ vi åœ¨æœç´¢åˆ°è¾¾æ–‡ä»¶ä¸¤ç«¯æ—¶ï¼Œåˆä»å¦ä¸€ç«¯å¼€å§‹ mesg å…è®¸ vi æ˜¾ç¤ºå…¶ä»–ç”¨æˆ·ç”¨ write å†™åˆ°è‡ªå·±ç»ˆç«¯ä¸Šçš„ä¿¡æ¯ :set number / set nonumber æ˜¾ç¤º/ä¸æ˜¾ç¤ºè¡Œå· :set ruler /set noruler æ˜¾ç¤º/ä¸æ˜¾ç¤ºæ ‡å°º :set hlsearch é«˜äº®æ˜¾ç¤ºæŸ¥æ‰¾åˆ°çš„å•è¯ :set nohlsearch å…³é—­é«˜äº®æ˜¾ç¤º :syntax on è¯­æ³•é«˜äº® :set nu æ˜¾ç¤ºè¡Œå· :set tabstop=8 è®¾ç½® tab å¤§å°ï¼Œ8 ä¸ºæœ€å¸¸ç”¨æœ€æ™®éçš„è®¾ç½® :set softtabstop=8 4:4 ä¸ªç©ºæ ¼ï¼Œ8: æ­£å¸¸çš„åˆ¶è¡¨ç¬¦ï¼Œ12: ä¸€ä¸ªåˆ¶è¡¨ç¬¦ 4 ä¸ªç©ºæ ¼ï¼Œ16: ä¸¤ä¸ªåˆ¶è¡¨ç¬¦ :set autoindent è‡ªåŠ¨ç¼©è¿› :set cindent C è¯­è¨€æ ¼å¼é‡Œé¢çš„è‡ªåŠ¨ç¼©è¿› ","date":"2018-08-31","objectID":"/posts/vim/:2:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"ç§»åŠ¨å…‰æ ‡ å‘½ä»¤ æè¿° k nk ä¸Š å‘ä¸Šç§»åŠ¨ n è¡Œ j nj ä¸‹ å‘ä¸‹ç§»åŠ¨ n è¡Œ h nh å·¦ å‘å·¦ç§»åŠ¨ n è¡Œ l nl å³ å‘å³ç§»åŠ¨ n è¡Œ Space å…‰æ ‡å³ç§»ä¸€ä¸ªå­—ç¬¦ Backspace å…‰æ ‡å·¦ç§»ä¸€ä¸ªå­—ç¬¦ Enter å…‰æ ‡ä¸‹ç§»ä¸€è¡Œ w/W å…‰æ ‡å³ç§»ä¸€ä¸ªå­—è‡³å­—é¦– b/B å…‰æ ‡å·¦ç§»ä¸€ä¸ªå­—è‡³å­—é¦– e æˆ– E å…‰æ ‡å³ç§»ä¸€ä¸ªå­—è‡³å­—å°¾ ) å…‰æ ‡ç§»è‡³å¥å°¾ ( å…‰æ ‡ç§»è‡³å¥é¦– } å…‰æ ‡ç§»è‡³æ®µè½å¼€å¤´ { å…‰æ ‡ç§»è‡³æ®µè½ç»“å°¾ n$ å…‰æ ‡ç§»è‡³ç¬¬ n è¡Œå°¾ H å…‰æ ‡ç§»è‡³å±å¹•é¡¶è¡Œ M å…‰æ ‡ç§»è‡³å±å¹•ä¸­é—´è¡Œ L å…‰æ ‡ç§»è‡³å±å¹•æœ€åè¡Œ 0 ï¼ˆæ³¨æ„æ˜¯æ•°å­—é›¶ï¼‰å…‰æ ‡ç§»è‡³å½“å‰è¡Œé¦– ^ ç§»åŠ¨å…‰æ ‡åˆ°è¡Œé¦–ç¬¬ä¸€ä¸ªéç©ºå­—ç¬¦ä¸Šå» $ å…‰æ ‡ç§»è‡³å½“å‰è¡Œå°¾ gg ç§»åˆ°ç¬¬ä¸€è¡Œ G ç§»åˆ°æœ€åä¸€è¡Œ f ç§»åŠ¨å…‰æ ‡åˆ°å½“å‰è¡Œçš„å­—ç¬¦ a ä¸Š F ç›¸å % ç§»åŠ¨åˆ°ä¸åˆ¶åŒ¹é…çš„æ‹¬å·ä¸Šå»ï¼ˆï¼‰ï¼Œ{}ï¼Œ[]ï¼Œ\u003c\u003eç­‰ nG ç§»åŠ¨åˆ°ç¬¬ n è¡Œä¸Š G åˆ°æœ€åä¸€è¡Œ ","date":"2018-08-31","objectID":"/posts/vim/:3:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"å±å¹•æ»šåŠ¨ å‘½ä»¤ æè¿° Ctrl+u å‘æ–‡ä»¶é¦–ç¿»åŠå± Ctrl+d å‘æ–‡ä»¶å°¾ç¿»åŠå± Ctrl+f å‘æ–‡ä»¶å°¾ç¿»ä¸€å± Ctrl ï¼‹ b å‘æ–‡ä»¶é¦–ç¿»ä¸€å± nz å°†ç¬¬ n è¡Œæ»šè‡³å±å¹•é¡¶éƒ¨ï¼Œä¸æŒ‡å®š n æ—¶å°†å½“å‰è¡Œæ»šè‡³å±å¹•é¡¶éƒ¨ ","date":"2018-08-31","objectID":"/posts/vim/:4:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"æ’å…¥æ–‡æœ¬ç±» å‘½ä»¤ æè¿° i åœ¨å…‰æ ‡å‰ I åœ¨å½“å‰è¡Œé¦– a å…‰æ ‡å A åœ¨å½“å‰è¡Œå°¾ o åœ¨å½“å‰è¡Œä¹‹ä¸‹æ–°å¼€ä¸€è¡Œ O åœ¨å½“å‰è¡Œä¹‹ä¸Šæ–°å¼€ä¸€è¡Œ r æ›¿æ¢å½“å‰å­—ç¬¦ R æ›¿æ¢å½“å‰å­—ç¬¦åŠå…¶åçš„å­—ç¬¦ï¼Œç›´è‡³æŒ‰ ESC é”® s ä»å½“å‰å…‰æ ‡ä½ç½®å¤„å¼€å§‹ï¼Œä»¥è¾“å…¥çš„æ–‡æœ¬æ›¿ä»£æŒ‡å®šæ•°ç›®çš„å­—ç¬¦ S åˆ é™¤æŒ‡å®šæ•°ç›®çš„è¡Œï¼Œå¹¶ä»¥æ‰€è¾“å…¥æ–‡æœ¬ä»£æ›¿ä¹‹ ncw/nCW ä¿®æ”¹æŒ‡å®šæ•°ç›®çš„å­— nCC ä¿®æ”¹æŒ‡å®šæ•°ç›®çš„è¡Œ ","date":"2018-08-31","objectID":"/posts/vim/:5:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"åˆ é™¤å‘½ä»¤ å‘½ä»¤ æè¿° x/X åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œx åˆ é™¤å…‰æ ‡åçš„ï¼Œè€Œ X åˆ é™¤å…‰æ ‡å‰çš„ dw åˆ é™¤ä¸€ä¸ªå•è¯ï¼ˆåˆ é™¤å…‰æ ‡ä½ç½®åˆ°ä¸‹ä¸€ä¸ªå•è¯å¼€å§‹çš„ä½ç½®ï¼‰ dnw åˆ é™¤ n ä¸ªå•è¯ dne ä¹Ÿå¯ï¼Œåªæ˜¯åˆ é™¤åˆ°å•è¯å°¾ do åˆ è‡³è¡Œé¦– d$ åˆ è‡³è¡Œå°¾ dd åˆ é™¤ä¸€è¡Œ ndd åˆ é™¤å½“å‰è¡ŒåŠå…¶å n-1 è¡Œ dnl å‘å³åˆ é™¤ n ä¸ªå­—æ¯ dnh å‘å·¦åˆ é™¤ n ä¸ªå­—æ¯ dnj å‘ä¸‹åˆ é™¤ n è¡Œï¼Œå½“å‰è¡Œ+å…¶ä¸Š n è¡Œ dnk å‘ä¸Šåˆ é™¤ n è¡Œï¼Œå½“æœŸè¡Œ+å…¶ä¸‹ n è¡Œ cnw[word] å°† n ä¸ª word æ”¹å˜ä¸º word C$ æ”¹å˜åˆ°è¡Œå°¾ cc æ”¹å˜æ•´è¡Œ shift+j åˆ é™¤è¡Œå°¾çš„æ¢è¡Œç¬¦ï¼Œä¸‹ä¸€è¡Œæ¥ä¸Šæ¥äº† ","date":"2018-08-31","objectID":"/posts/vim/:6:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"å¤åˆ¶ç²˜è´´ å‘½ä»¤ æè¿° p ç²˜è´´ç”¨ x æˆ– d åˆ é™¤çš„æ–‡æœ¬ ynw å¤åˆ¶ n ä¸ªå•è¯ yy å¤åˆ¶ä¸€è¡Œ ynl å¤åˆ¶ n ä¸ªå­—ç¬¦ y$ å¤åˆ¶å½“å‰å…‰æ ‡è‡³è¡Œå°¾å¤„ nyy æ‹·è´ n è¡Œ ","date":"2018-08-31","objectID":"/posts/vim/:7:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"æ’¤é”€ å‘½ä»¤ æè¿° u æ’¤é”€å‰ä¸€æ¬¡çš„æ“ä½œ shif+u(U) æ’¤é”€å¯¹è¯¥è¡Œçš„æ‰€æœ‰æ“ä½œ ","date":"2018-08-31","objectID":"/posts/vim/:8:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"æœç´¢åŠæ›¿æ¢ å‘½ä»¤ æè¿° /pattern ä»å…‰æ ‡å¼€å§‹å¤„å‘æ–‡ä»¶å°¾æœç´¢ pattern ?pattern ä»å…‰æ ‡å¼€å§‹å¤„å‘æ–‡ä»¶é¦–æœç´¢ pattern n åœ¨åŒä¸€æ–¹å‘é‡å¤ä¸Šä¸€æ¬¡æœç´¢å‘½ä»¤ N åœ¨åæ–¹å‘ä¸Šé‡å¤ä¸Šä¸€æ¬¡æœç´¢å‘½ä»¤ cw newword æ›¿æ¢ä¸º newword n ç»§ç»­æŸ¥æ‰¾ . æ‰§è¡Œæ›¿æ¢ :s/p1/p2/g å°†å½“å‰è¡Œä¸­æ‰€æœ‰ p1 å‡ç”¨ p2 æ›¿ä»£ï¼Œg è¡¨ç¤ºæ‰§è¡Œ ç”¨ c è¡¨ç¤ºéœ€è¦ç¡®è®¤ :n1,n2 s/p1/p2/g å°†ç¬¬ n1 è‡³ n2 è¡Œä¸­æ‰€æœ‰ p1 å‡ç”¨ p2 æ›¿ä»£ :g/p1/s//p2/g å°†æ–‡ä»¶ä¸­æ‰€æœ‰ p1 å‡ç”¨ p2 æ›¿æ¢ :1,$ s/string1/string2/g åœ¨å…¨æ–‡ä¸­å°† string1 æ›¿æ¢ä¸º string2 ","date":"2018-08-31","objectID":"/posts/vim/:9:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"ä¹¦ç­¾ å‘½ä»¤ æè¿° m[a-z] åœ¨æ–‡ä¸­åšæ ‡è®°ï¼Œæ ‡è®°å·å¯ä¸º a-z çš„ 26 ä¸ªå­—æ¯ `a ç§»åŠ¨åˆ°æ ‡è®° a å¤„ ","date":"2018-08-31","objectID":"/posts/vim/:10:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"visual æ¨¡å¼ å‘½ä»¤ æè¿° v è¿›å…¥ visual æ¨¡å¼ V è¿›å…¥è¡Œçš„ visual æ¨¡å¼ ctrl+v è¿›å¦‚å—æ“ä½œæ¨¡å¼ç”¨ o å’Œ O æ”¹å˜é€‰æ‹©çš„è¾¹çš„å¤§å° åœ¨æ‰€æœ‰è¡Œæ’å…¥ç›¸åŒçš„å†…å®¹å¦‚ include\u003c å°†å…‰æ ‡ç§»åˆ°å¼€å§‹æ’å…¥çš„ä½ç½®ï¼ŒæŒ‰ CTRL+V è¿›å…¥ VISUAL æ¨¡å¼ï¼Œé€‰æ‹©å¥½æ¨¡å—åæŒ‰ Iï¼ˆshift+i)ï¼Œåæ’å…¥è¦æ’å…¥çš„æ–‡æœ¬ï¼ŒæŒ‰ [ESC] å®Œæˆ ","date":"2018-08-31","objectID":"/posts/vim/:11:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"è¡Œæ–¹å¼å‘½ä»¤ å‘½ä»¤ æè¿° :n1,n2 co n3 å°† n1 è¡Œåˆ° n2 è¡Œä¹‹é—´çš„å†…å®¹æ‹·è´åˆ°ç¬¬ n3 è¡Œä¸‹ :n1,n2 m n3 å°† n1 è¡Œåˆ° n2 è¡Œä¹‹é—´çš„å†…å®¹ç§»è‡³åˆ°ç¬¬ n3 è¡Œä¸‹ :n1,n2 d å°† n1 è¡Œåˆ° n2 è¡Œä¹‹é—´çš„å†…å®¹åˆ é™¤ :n1,n2 w!command å°†æ–‡ä»¶ä¸­ n1 è¡Œè‡³ n2 è¡Œçš„å†…å®¹ä½œä¸º command çš„è¾“å…¥å¹¶æ‰§è¡Œä¹‹ è‹¥ä¸æŒ‡å®š n1ï¼Œn2ï¼Œåˆ™è¡¨ç¤ºå°†æ•´ä¸ªæ–‡ä»¶å†…å®¹ä½œä¸º command çš„è¾“å…¥ ","date":"2018-08-31","objectID":"/posts/vim/:12:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"å® å‘½ä»¤ æè¿° q[a-z] å¼€å§‹è®°å½•ä½†å‰å¼€å§‹çš„æ“ä½œä¸ºå®ï¼Œåç§°å¯ä¸ºã€a-zã€‘ï¼Œç„¶åç”¨ q ç»ˆæ­¢å½•åˆ¶å® reg æ˜¾ç¤ºå½“å‰å®šä¹‰çš„æ‰€æœ‰çš„å®ï¼Œç”¨@[a-z] æ¥åœ¨å½“å‰å…‰æ ‡å¤„æ‰§è¡Œå® [a-z] ","date":"2018-08-31","objectID":"/posts/vim/:13:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"çª—å£æ“ä½œ å‘½ä»¤ æè¿° :split åˆ†å‰²ä¸€ä¸ªçª—å£ :split file.c ä¸ºå¦ä¸€ä¸ªæ–‡ä»¶ file.c åˆ†éš”çª—å£ :nsplit file.c ä¸ºå¦ä¸€ä¸ªæ–‡ä»¶ file.c åˆ†éš”çª—å£ï¼Œå¹¶æŒ‡å®šå…¶è¡Œæ•° ctrl ï¼‹ w åœ¨çª—å£ä¸­åˆ‡æ¢ :close å…³é—­å½“å‰çª—å£ ","date":"2018-08-31","objectID":"/posts/vim/:14:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":"æ–‡ä»¶åŠå…¶ä»– å‘½ä»¤ æè¿° :q é€€å‡º vi :q! ä¸ä¿å­˜æ–‡ä»¶å¹¶é€€å‡º vi :e filename æ‰“å¼€æ–‡ä»¶ filename è¿›è¡Œç¼–è¾‘ :e! æ”¾å¼ƒä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼Œé‡æ–°è½½å…¥è¯¥æ–‡ä»¶ç¼–è¾‘ :w ä¿å­˜å½“å‰æ–‡ä»¶ :wq å­˜ç›˜é€€å‡º :ZZ ä¿å­˜å½“å‰æ–‡æ¡£å¹¶é€€å‡º VIM :!command æ‰§è¡Œ shell å‘½ä»¤ command :r!command å°†å‘½ä»¤ command çš„è¾“å‡ºç»“æœæ”¾åˆ°å½“å‰è¡Œ :n1,n2 write temp.c :read file.c å°†æ–‡ä»¶ file.c çš„å†…å®¹æ’å…¥åˆ°å½“å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹é¢ ","date":"2018-08-31","objectID":"/posts/vim/:15:0","tags":["vim","ä»–å±±ä¹‹çŸ³"],"title":"Vim é€ŸæŸ¥è¡¨","uri":"/posts/vim/"},{"categories":["Memo"],"content":" è­¦å‘Š 2018/11/1 è¯´æ˜ next ä¸»é¢˜å¥½åƒæ›´æ–°äº†ï¼Œç°åœ¨è‡ªå¸¦çš„å¯ä»¥ç”¨äº†ï¼Œå¦‚æœå¯ä»¥ç”¨äº†ï¼Œä»¥ä¸‹æ•™ç¨‹å¯ä»¥å¿½ç•¥ï¼ï¼ï¼ æœ€è¿‘æœ‰å‡ ä¸ªå°ä¼™ä¼´é—®æˆ‘åšå®¢çš„å­—æ•°ç»Ÿè®¡æ€ä¹ˆå®ç°çš„ï¼Œæ€ä¹ˆç½‘ä¸Šçš„æ•™ç¨‹ä¸ç®¡ç”¨å•Šï¼Ÿä¸€å¼€å§‹æˆ‘æ­å»ºåšå®¢çš„æ—¶å€™ä¹Ÿé‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ï¼ŒæŒ‰ç…§ github ä¸Š wordcount çš„ readme æ“ä½œåï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œæˆ‘æ‰“å¼€ post ç›¸å…³é…ç½®æ–‡ä»¶å¹¶æ²¡æœ‰å‘ç°å‘ç° wordcount è¿™ä¸ªå…³é”®è¯ï¼Œnext æœ¬èº«ä¼¼ä¹ä¹Ÿå¹¶æ²¡æœ‰åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶æä¾›é€‰é¡¹ï¼ˆæˆ–è®¸æ˜¯ä¸ªäººåŸå› ï¼‰ï¼Œæ‰€ä»¥åªå¥½è‡ªå·±åŠ¨æ‰‹åŠ ä¸€ä¸ªäº†ã€‚ä¸ºäº†ä¸é‡å¤å›ç­”é—®é¢˜ï¼Œå…ˆåšä¸ªåŸåˆ›è®°å½•ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚åœ¨æ­¤æŠ›è½¬å¼•ç‰ï¼Œå¦‚æœæœ‰æ›´å¥½çš„æ–¹æ³•è¯·åœ¨ç•™è¨€åŒºæå‡ºï¼Œæˆ‘ä¼šåŠæ—¶æ›´æ”¹ã€‚åŒæ—¶ä¹Ÿå¸Œæœ›å°ä¼™ä¼´å¤šå‘æ‰¬æŠ˜è…¾ç²¾ç¥ï¼Œå¤šä¸“ç ”ï¼Œå°‘æé—®ï¼Œæ¯•ç«Ÿè¿˜æ˜¯ RTFSC å¤§æ³•å¥½ï¼(Read the fucking source code) ","date":"2018-08-30","objectID":"/posts/hexo-wordcount/:0:0","tags":["hexo","å­—æ•°ç»Ÿè®¡"],"title":"hexo next ä¸»é¢˜æ·»åŠ å­—æ•°ç»Ÿè®¡ï¼ˆ2018ï¼‰","uri":"/posts/hexo-wordcount/"},{"categories":["Memo"],"content":"å®‰è£… wordcount github å¦‚æœæ²¡æœ‰å®‰è£… hexo-wordcount æ’ä»¶ï¼Œå…ˆå®‰è£…è¯¥æ’ä»¶ï¼š npm i --save hexo-wordcount # Node ç‰ˆæœ¬ 7.6.0 ä¹‹å‰ï¼Œè¯·å®‰è£… 2.x ç‰ˆæœ¬ (Node.js v7.6.0 and previous) npm install hexo-wordcount@2 --save ","date":"2018-08-30","objectID":"/posts/hexo-wordcount/:1:0","tags":["hexo","å­—æ•°ç»Ÿè®¡"],"title":"hexo next ä¸»é¢˜æ·»åŠ å­—æ•°ç»Ÿè®¡ï¼ˆ2018ï¼‰","uri":"/posts/hexo-wordcount/"},{"categories":["Memo"],"content":"post æ·»åŠ  æ‰“å¼€hexo\\themes\\hexo-theme-next\\layout\\_macroè·¯å¾„ä¸‹çš„ post.swig æ–‡ä»¶ï¼Œæ—¢ç„¶æ²¡æœ‰å­—æ•°ç»Ÿè®¡é‚£ä¹ˆæˆ‘ä»¬å°±åŠ ä¸€ä¸ªï¼Œç®€å•æš´åŠ›åœ°ç›´æ¥åœ¨é˜…è¯»æ•°åé¢åŠ ä¸Šä¸€æ¡å°±å¥½äº†ï¼Œåœ¨æ–‡ä»¶ç±»æœç´¢å…³é”®è¯busuanzi, æˆ‘ç”¨çš„æ˜¯ä¸è’œå­ï¼Œå¦‚æœç”¨çš„äº† leancloud çš„æœ leancloud å°±å¥½äº†ï¼Œå…¶ä»–ç±»ä¼¼ã€‚æ‰¾åˆ°è¿™æ®µä»£ç å {% if not is_index and theme.busuanzi_count.enable and theme.busuanzi_count.post_views %} \u003cspan class=\"post-meta-divider\"\u003e|\u003c/span\u003e \u003cspan class=\"post-meta-item-icon\" {% if not theme.post_meta.item_text %} title=\"{{ __('post.views') }}\" {% endif %}\u003e \u003ci class=\"fa fa-{{ theme.busuanzi_count.post_views_icon }}\"\u003e\u003c/i\u003e {% if theme.post_meta.item_text %} {{__('post.views') + __('symbol.colon') }} {% endif %} \u003cspan class=\"busuanzi-value\" id=\"busuanzi_value_page_pv\" \u003e\u003c/span\u003e \u003c/span\u003e {% endif %} åœ¨endifä¸Šé¢ï¼Œå³æœ¬æ–‡ä»£ç å—é‚£ä¸ªç©ºè¡Œå¤„æ·»åŠ ä»¥ä¸‹ä»£ç  \u003cspan class=\"post-meta-divider\"\u003e|\u003c/span\u003e \u003cspan title=\"{{ __('post.wordcount') }}\"\u003e\u003cspan class=\"post-meta-item-icon\"\u003e\u003ci class=\"fa fa-file-word-o\"\u003e\u003c/i\u003e\u003c/span\u003eå­—æ•°ï¼š {{ wordcount(post.content) }}\u003c/span\u003e ","date":"2018-08-30","objectID":"/posts/hexo-wordcount/:2:0","tags":["hexo","å­—æ•°ç»Ÿè®¡"],"title":"hexo next ä¸»é¢˜æ·»åŠ å­—æ•°ç»Ÿè®¡ï¼ˆ2018ï¼‰","uri":"/posts/hexo-wordcount/"},{"categories":["Memo"],"content":"å…¨ç«™æ·»åŠ  æ‰“å¼€hexo\\themes\\hexo-theme-next\\layout\\_partialsè·¯å¾„ä¸‹ footer.swig æ–‡ä»¶ï¼Œåœ¨ä½ å–œæ¬¢çš„ä½ç½®æ·»åŠ ä»¥ä¸‹ä»£ç  \u003cdiv class=\"theme-info\"\u003e \u003cdiv class=\"powered-by\"\u003e\u003c/div\u003e \u003cspan class=\"post-count\"\u003eå…¨ç«™å…± {{ totalcount(site) }} å­—\u003c/span\u003e \u003c/div\u003e ","date":"2018-08-30","objectID":"/posts/hexo-wordcount/:3:0","tags":["hexo","å­—æ•°ç»Ÿè®¡"],"title":"hexo next ä¸»é¢˜æ·»åŠ å­—æ•°ç»Ÿè®¡ï¼ˆ2018ï¼‰","uri":"/posts/hexo-wordcount/"},{"categories":["Memo"],"content":"æ­å»ºè¿™ä¸ªåšå®¢ä»¥æ¥ï¼Œéš”ä¸€æ®µæ—¶é—´å°±å‡ºç°ä¸€æ¬¡éƒ¨ç½²å¤±è´¥çš„é”™è¯¯ï¼Œæ¯æ¬¡éƒ½å·®ä¸å¤šï¼Œè«åå…¶å¦™åœ°å‡ºç°çš„ã€‚å‰å‡ æ¬¡ä¸çŸ¥é“æ€ä¹ˆçæå°±å¥½äº†ã€‚ ç°åœ¨åšä¸€ä¸‹è®°å½•ï¼Œé˜²æ­¢ä»¥åå‡ºé”™ç”¨ã€‚ é”™è¯¯å¦‚ä¸‹ Connection reset by 13.229.188.59 port 22 fatal: sha1 file '\u003cstdout\u003e' write error: Broken pipe fatal: The remote end hung up unexpectedly FATAL Something's wrong. Maybe you can find the solution here: http://hexo.io/docs/troubleshooting.html Error: Connection reset by 13.229.188.59 port 22 fatal: sha1 file '\u003cstdout\u003e' write error: Broken pipe fatal: The remote end hung up unexpectedly at ChildProcess.\u003canonymous\u003e (H:\\Hexo\\node_modules\\hexo-util\\lib\\spawn.js:37:17) at emitTwo (events.js:106:13) at ChildProcess.emit (events.js:191:7) at ChildProcess.cp.emit (H:\\Hexo\\node_modules\\cross-spawn\\lib\\enoent.js:40:29) at maybeClose (internal/child_process.js:850:16) at Socket.\u003canonymous\u003e (internal/child_process.js:323:11) at emitOne (events.js:96:13) at Socket.emit (events.js:188:7) at Pipe._handle.close [as _onclose] (net.js:492:12) ... ç¡®ä¿ ssh æ­£å¸¸ï¼Œhexo-deploy-git æ’ä»¶æ­£å¸¸çš„æƒ…å†µä¸‹åˆ é™¤ã€‚deploy_git æ–‡ä»¶å¤¹å°±å¥½äº†ã€‚ æœ€ååæ§½ä¸€ä¸‹ï¼Œè¿™ä¸ªé¬¼é”™è¯¯ï¼Œææˆ‘ä¸€æ™šä¸Šé†‰äº†ã€‚æˆ‘åˆæ‰“ç®—é‡è£…äº†çš„ã€‚/åè¡€ ","date":"2018-08-21","objectID":"/posts/hexo-d-error/:0:0","tags":["hexo"],"title":"hexo d å‡ºé”™","uri":"/posts/hexo-d-error/"},{"categories":["Memo"],"content":" æœ¬æ–‡é€‚åˆæˆ‘è¿™ç§çº¯å°ç™½ã€‚ ç›®å‰ä¸ºæ­¢ï¼Œå…¨ç½‘ä¹Ÿå°±åªæœ‰ä¸€ä¸ªåšä¸»å†™åˆ°è¿‡è¿™æ ·åŠ¨æ€æ˜¾ç¤º subtitle çš„æ–‡ç« ã€‚ä¼ é€é—¨ï¼ˆå…³é”®è¯ï¼šjs, ååŠ è½½ï¼‰ ä½†æ˜¯å˜ï¼Œè¯¥åšå†™çš„ä¸æ€ä¹ˆè¯¦ç»†ï¼Œ17 å¹´åº•å†™çš„ã€‚å½“ç„¶æ›´å¤§çš„å¯èƒ½æ˜¯ next æ›´æ–°äº†ä¸€äº›æ–‡ä»¶ç»“æ„ï¼Œæ‰€ä»¥ä¸é€‚åˆç°åœ¨ä½¿ç”¨äº†ã€‚ä»¥å‰æˆ‘æŒ‰åŸåšçš„æµç¨‹é…ç½®äº†ä¸€ä¸‹æ²¡æˆåŠŸå°±æåœ¨é‚£é‡Œäº†ï¼Œä»Šå¤©çªç„¶å¿ƒè¡€æ¥æ½®ã€‚ç¿»äº†ç¿»åŸåšä¸»åšå®¢çš„æºç ï¼Œå†ä¸è‡ªå·±çš„å¯¹æ¯”äº†ä¸€ä¸‹ï¼Œå‘ç°äº†ä¸€äº›ç«¯å€ªã€‚ç¨ä½œè°ƒæ•´åå¦‚ä¸‹ï¼š ","date":"2018-08-20","objectID":"/posts/dongtaisub/:0:0","tags":["hexo","JavaScript"],"title":"hexo ä¸ªæ€§åŒ– - next ä¸»é¢˜åŠ¨æ€æ˜¾ç¤º subtitle","uri":"/posts/dongtaisub/"},{"categories":["Memo"],"content":"ä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œä¸»è¦ä¿®æ”¹ subtitle subtitle: ä¸æ€•ä¸‡äººé˜»æŒ¡ï¼Œåªæ€•è‡ªå·±æŠ•é™ã€‚W ä½ å¦‚ä½•å›å¿†ï¼Œå†³å®šä½ æ˜¯ä¸€ä¸ªæ€æ ·çš„äººï¼W è¿™æ˜¯ä¸€ä¸ªå¥å­ã€‚W è¿™æ˜¯å¦ä¸€ä¸ªå¥å­ã€‚W è¿™äº›å¥å­ä½ ä»¬ä¸è¦æä¸€æ ·çš„ä¸ç„¶æ€ä¹ˆå«ä¸ªæ€§ç­¾å-_-ï¼ã€‚ å¥å­ä¸å¥å­ä¹‹é—´ä»¥ W åˆ†å‰²ï¼Œåç»­éœ€è¦æ ¹æ®è¯¥æ ‡å¿—ä½å»æ‹†åˆ†å¥å­ç»„ã€‚ å°ä¼™ä¼´ä»¬åšä¸»è¿™é‡Œåªæ˜¯æä¾›ä¸€ä¸ªæ€è·¯ï¼Œä¸è¦å’Œæˆ‘ç”¨ä¸€æ¨¡ä¸€æ ·çš„å•Šï¼Œä¸ç„¶æ’äº†å¤šå°´å°¬å‘€ ","date":"2018-08-20","objectID":"/posts/dongtaisub/:1:0","tags":["hexo","JavaScript"],"title":"hexo ä¸ªæ€§åŒ– - next ä¸»é¢˜åŠ¨æ€æ˜¾ç¤º subtitle","uri":"/posts/dongtaisub/"},{"categories":["Memo"],"content":"ä¿®æ”¹ header\\index.swig ä¿®æ”¹ themes\\next\\layout_partials\\header ä¸‹é¢çš„ index.swig æ–‡ä»¶ åœ¨æœ€å¼€å¤´æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š ï¼ˆè¿™é‡Œç”¨çš„åŸåšçš„ js) \u003cscript\u003e function GetRandomNum(Min,Max) { var Range = Max - Min; var Rand = Math.random(); return(Min + Math.round(Rand * Range)); } function setSidebarMarginTop (headerOffset) { return $('#sidebar').css({ 'margin-top': headerOffset }); } function getHeaderOffset () { return $('.header-inner').height() + CONFIG.sidebar.offset; } window.onload=function(){ var subtitle = \"{{config.subtitle}}\"; var mytitle = subtitle.split(\"W\"); var max = mytitle.length-1; var index = GetRandomNum(0,max); var text = mytitle[index]; $(\"#helloTitle\").html(text); var headOffset = getHeaderOffset(); setSidebarMarginTop(headOffset); //åŠ¨æ€ subtitle è®¾ç½® } \u003c/script\u003e ","date":"2018-08-20","objectID":"/posts/dongtaisub/:2:0","tags":["hexo","JavaScript"],"title":"hexo ä¸ªæ€§åŒ– - next ä¸»é¢˜åŠ¨æ€æ˜¾ç¤º subtitle","uri":"/posts/dongtaisub/"},{"categories":["Memo"],"content":"ä¿®æ”¹ brand.swig æ‰¾åˆ° {% if subtitle %} {% if theme.seo %} ... {% else %} ... {% endif %} {% endif %} æŠŠè¿™ä¸€æ®µï¼ŒæŠŠåŸæ¥çš„ä¿®æ”¹æˆä»¥ä¸‹ä»£ç å³å¯ ps: titleå’Œsubtitleçš„å­—ä½“è¿˜æœ‰é¢œè‰²ä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¿®æ”¹ï¼Œå³ä½¿ç”¨styleæ ‡ç­¾ï¼ŒæŒ‰ä¸ªäººçˆ±å¥½ä¿®æ”¹ä¹Ÿå¯ä¸è¦ã€‚ {% if subtitle %} {% if theme.seo %} \u003cp class=\"site-subtitle\" id=\"helloTitle\" itemprop=\"description\"\u003e\u003c/p\u003e {% else %} \u003cp id=\"helloTitle\" class=\"site-subtitle\"\u003e\u003c/p\u003e {% endif %} {% endif %} ä¹‹åéƒ¨ç½²åæ¯æ¬¡åˆ·æ–°å°±å¯ä»¥çœ‹åˆ°ä¸åŒçš„ subtitle äº†ï¼Œå¼€å¿ƒ ğŸ˜€ ","date":"2018-08-20","objectID":"/posts/dongtaisub/:3:0","tags":["hexo","JavaScript"],"title":"hexo ä¸ªæ€§åŒ– - next ä¸»é¢˜åŠ¨æ€æ˜¾ç¤º subtitle","uri":"/posts/dongtaisub/"},{"categories":["Memo"],"content":"ä»Šæ—¥è¯—è¯ ä»Šæ—¥è¯—è¯ \u003cspan id=\"jinrishici-sentence\"\u003eæ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯ ....\u003c/span\u003e \u003cscript src=\"https://sdk.jinrishici.com/v2/browser/jinrishici.js\" charset=\"utf-8\"\u003e\u003c/script\u003e æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯ .... ","date":"2018-08-20","objectID":"/posts/dongtaisub/:4:0","tags":["hexo","JavaScript"],"title":"hexo ä¸ªæ€§åŒ– - next ä¸»é¢˜åŠ¨æ€æ˜¾ç¤º subtitle","uri":"/posts/dongtaisub/"},{"categories":["Memo"],"content":"api è°ƒç”¨ ç›´æ¥ js è°ƒç”¨ api ç®€å•å¿«é€Ÿ 2021/9/30 æ›´æ–° ä¸€è¨€ api-å‚æ•°è¯¦è§ å·²ç»æŒ‚äº† \u003cdiv\u003e \u003cscript type=\"text/javascript\" src=\"https://api.imjad.cn/hitokoto/?cat=\u0026charset=utf-8\u0026length=\u0026encode=js\u0026fun=sync\u0026source=\"\u003e\u003c/script\u003e \u003cdiv id=\"hitokoto\"\u003e \u003cscript\u003e hitokoto(); \u003c/script\u003e \u003c/div\u003e \u003c/div\u003e ","date":"2018-08-20","objectID":"/posts/dongtaisub/:5:0","tags":["hexo","JavaScript"],"title":"hexo ä¸ªæ€§åŒ– - next ä¸»é¢˜åŠ¨æ€æ˜¾ç¤º subtitle","uri":"/posts/dongtaisub/"},{"categories":["Git"],"content":"åœ¨ git æ²¡æœ‰è¿è¡Œå®Œæˆä¹‹å‰å¼ºåˆ¶å…³é—­ï¼Œä¸‹æ¬¡æäº¤çš„æ—¶å€™ä¼šäº§ä»¥ä¸‹ç”Ÿé”™è¯¯ï¼Œæˆ–è€…ç±»ä¼¼çš„ã€‚ fatal: Unable to create '/xxx/xx/.git/index.lock': File exists. If no other git process is currently running, this probably means a git process crashed in this repository earlier. Make sure no other git process is running and remove the file manually to continue. åŸå› æ˜¯åœ¨ä½ è¿›è¡ŒæŸäº›æ¯”è¾ƒè´¹æ—¶çš„ git æ“ä½œæ—¶è‡ªåŠ¨ç”Ÿæˆï¼Œæ“ä½œç»“æŸåè‡ªåŠ¨åˆ é™¤ï¼Œç›¸å½“äºä¸€ä¸ªé”å®šæ–‡ä»¶ï¼Œç›®çš„åœ¨äºé˜²æ­¢å¯¹ä¸€ä¸ªç›®å½•åŒæ—¶è¿›è¡Œå¤šä¸ªæ“ä½œã€‚ æœ‰æ—¶å¼ºåˆ¶å…³é—­è¿›è¡Œä¸­çš„ git æ“ä½œï¼Œè¿™ä¸ªæ–‡ä»¶æ²¡æœ‰è¢«è‡ªåŠ¨åˆ é™¤ï¼Œä¹‹åä½ å°±æ— æ³•è¿›è¡Œå…¶ä»–æ“ä½œï¼Œå¿…é¡»æ‰‹åŠ¨åˆ é™¤ï¼Œè¿›å…¥ã€‚git æ–‡ä»¶ä¸­åˆ é™¤ï¼Œæ‰“å¼€æ˜¾ç¤ºéšè—æ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰çœ‹è§ã€‚git æ–‡ä»¶å¤¹ï¼Œå¯ä»¥ç›´æ¥ç”¨å‘½ä»¤ rm -f ./.git/index.lockã€‚ä¹‹åå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚ ","date":"2018-08-14","objectID":"/posts/git-index-lock/:0:0","tags":["Git"],"title":"git index.lock","uri":"/posts/git-index-lock/"},{"categories":["Memo"],"content":" æš‘å‡åˆšå¼€å§‹çš„æ—¶å€™æ”¾å‡å›å®¶æ²¡å¸¦ç”µè„‘ï¼Œåªèƒ½ç©æ‰‹æœºï¼Œæƒ³æŠ˜è…¾ä¸€ä¸‹åšå®¢éƒ½æ²¡æœ‰æ¡ä»¶ï¼Œåœ¨ä¸€ä¸ªå‘ç°ä¸€ä¸ª app, å§æ§½ ğŸ˜±ï¼Œtermux çœŸçš„å¼ºå¤§ï¼ï¼ˆåˆå§‹åŒ–éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰å®‰å“æ‰‹æœºä¸Šçš„ linux ç®€ç›´äº†ï¼Œåœ¨æ‰‹æœºå°±å¯ä»¥æ­äº†ä¸€ä¸ª hexo åšå®¢ï¼Œåªè¦åœ¨ github ä¸Šå®ç°åˆ†æ”¯ç®¡ç†å°±å¯ä»¥å¤šç»ˆç«¯åŒæ­¥æ›´æ–°äº†ã€‚æ•æˆ‘å­¦ç–æ‰æµ…ï¼Œè¿˜åªæƒ³åˆ°è¿™äº›ï¼ä¸€å¼€å§‹æƒ³å›æ ¡åï¼ŒæŠ˜è…¾ä¸€ä¸‹ hexo-admin å®ç°ç±»ä¼¼åŠ¨æ€åšå®¢ä¸€æ ·çš„å¤šç»ˆç«¯ç®¡ç†ï¼ˆæ‰‹åŠ¨æ»‘ç¨½ï¼‰ï¼Œç°åœ¨å‘ç° termux è¿™æ ·å­çš„æ“ä½œä¹Ÿä¸é”™å˜›ï¼ŒæŒºè£…å“” hhhhhh**éƒ¨ç½²åçš„æ•ˆæœ** ","date":"2018-08-11","objectID":"/posts/termux/:0:0","tags":["Node.js","hexo","termux"],"title":"åœ¨ Android ä¸Šæ­å»º hexo åšå®¢","uri":"/posts/termux/"},{"categories":["Memo"],"content":"å‡†å¤‡ Termux æ–‡ä»¶ç®¡ç†å™¨ï¼ˆRE,MT æ–‡ä»¶ç®¡ç†å™¨ç­‰é«˜çº§ä¸€ç‚¹çš„ï¼‰ ","date":"2018-08-11","objectID":"/posts/termux/:1:0","tags":["Node.js","hexo","termux"],"title":"åœ¨ Android ä¸Šæ­å»º hexo åšå®¢","uri":"/posts/termux/"},{"categories":["Memo"],"content":"å¼€å§‹ æ‰“å¼€ Termuxï¼Œè¾“å…¥$pkg install nodejså®‰è£… Nodejsï¼Œåœ¨è¾“å…¥pkg install gitå®‰è£… Gitã€‚ è¿‡ç¨‹ä¼šå‡ºç°ä¸€ä¸ªæç¤ºï¼Œè¾“å…¥ y å›è½¦ç¡®è®¤å³å¯ã€‚ æŒ‰ç…§ Hexo å®˜ç½‘æç¤ºå®‰è£… Hexoã€‚ npm install hexo-cli -g hexo init blog cd blog æ³¨æ„ ssh é…ç½®å…ˆå®‰è£…ï¼špkg install openssh ç„¶åæŒ‰ç…§åŸºæœ¬æ“ä½œé…ç½® Hexoï¼ŒGitHub æˆ–è€… gitee,coding ç­‰è¿ä¸Šï¼Œéƒ¨ç½²æµ‹è¯•ä¸€æ¬¡ã€‚ å®‰è£…éƒ¨ç½²æ’ä»¶npm install hexo-deployer-git --saveï¼Œéƒ¨ç½²hexo d -g æ²¡æœ‰é—®é¢˜çš„è¯è¿›è¡Œä¸‹ä¸€æ­¥ã€‚ ","date":"2018-08-11","objectID":"/posts/termux/:2:0","tags":["Node.js","hexo","termux"],"title":"åœ¨ Android ä¸Šæ­å»º hexo åšå®¢","uri":"/posts/termux/"},{"categories":["Memo"],"content":"ç¼–è¾‘ å†™æ–‡ç« çš„è¯åˆ›å»º md æ–‡ä»¶å‘½ä»¤å’Œç”µè„‘ä¸Šä¸€æ ·ï¼Œæ–‡ä»¶ç®¡ç†å™¨æ‰“å¼€/data/data/com.termux/files/home/i/source/_posts/ ç¼–è¾‘æ–‡ç«  md æ–‡ä»¶ã€‚è¿™ç§æ–¹å¼éœ€è¦ Rootã€‚ æ²¡æœ‰ Root çš„è¯å¯ä»¥ä½¿ç”¨ Vimï¼Œç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ç›¸å¯¹æ¥è¯´æ›´éº»çƒ¦ã€‚ ","date":"2018-08-11","objectID":"/posts/termux/:3:0","tags":["Node.js","hexo","termux"],"title":"åœ¨ Android ä¸Šæ­å»º hexo åšå®¢","uri":"/posts/termux/"},{"categories":["Memo"],"content":"å‚è€ƒ termux é«˜çº§ç»ˆç«¯å®‰è£…ä½¿ç”¨é…ç½®æ•™ç¨‹ ä½¿ç”¨ Termux åœ¨æ‰‹æœºä¸Šè¿è¡Œ linux é»‘ç§‘æŠ€ hexo æ­å»ºè¿‡ç¨‹ è¶…è¯¦ç»†æ•™ç¨‹ ","date":"2018-08-11","objectID":"/posts/termux/:4:0","tags":["Node.js","hexo","termux"],"title":"åœ¨ Android ä¸Šæ­å»º hexo åšå®¢","uri":"/posts/termux/"},{"categories":["Memo"],"content":"æ•ˆæœå›¾ï¼ˆæœªè¿æ¥ githubï¼Œcoding ç­‰ï¼‰ æ•ˆæœå›¾ 1 æ•ˆæœå›¾ 2 æ•ˆæœå›¾ 3 æ•ˆæœå›¾ 4 ","date":"2018-08-11","objectID":"/posts/termux/:5:0","tags":["Node.js","hexo","termux"],"title":"åœ¨ Android ä¸Šæ­å»º hexo åšå®¢","uri":"/posts/termux/"},{"categories":["ACM"],"content":"é“¾æ¥ï¼šhttps://www.nowcoder.com/acm/contest/157/A æ¥æºï¼šç‰›å®¢ç½‘ ","date":"2018-08-10","objectID":"/posts/nowcoder157a/:0:0","tags":["æ•°å­¦","ç»„åˆæ•°å­¦","ACM","Nowcoder","C++"],"title":"çŸ³å­é˜µåˆ—ï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/nowcoder157a/"},{"categories":["ACM"],"content":"é¢˜ç›®æè¿° xb æœ‰ m ç§çŸ³å­ï¼Œæ¯ç§æ— é™ä¸ªï¼ŒTa æƒ³ä»è¿™äº›çŸ³å­ä¸­å–å‡º n ä¸ªï¼Œå¹¶æŒ‰é¡ºåºæ’åˆ—èµ·æ¥ï¼Œä¸ºäº†å¥½çœ‹ï¼Œç›¸é‚»çš„çŸ³å­ä¸èƒ½ç›¸åŒã€‚xb æƒ³çŸ¥é“æœ‰å¤šå°‘ç§æ’åˆ—çš„æ–¹æ³•ã€‚ ","date":"2018-08-10","objectID":"/posts/nowcoder157a/:0:1","tags":["æ•°å­¦","ç»„åˆæ•°å­¦","ACM","Nowcoder","C++"],"title":"çŸ³å­é˜µåˆ—ï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/nowcoder157a/"},{"categories":["ACM"],"content":"è¾“å…¥æè¿°ï¼š ç¬¬ä¸€è¡Œæœ‰ä¸¤ä¸ªæ­£æ•´æ•° nï¼Œmã€‚ ","date":"2018-08-10","objectID":"/posts/nowcoder157a/:0:2","tags":["æ•°å­¦","ç»„åˆæ•°å­¦","ACM","Nowcoder","C++"],"title":"çŸ³å­é˜µåˆ—ï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/nowcoder157a/"},{"categories":["ACM"],"content":"è¾“å‡ºæè¿°ï¼š ç¬¬ä¸€è¡Œä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåœ¨ m ç§çŸ³å­ä¸­å–å‡º n ä¸ªçš„æ’åˆ—æ–¹æ¡ˆæ•°æ¨¡ 1000000007 åçš„å€¼ã€‚ ","date":"2018-08-10","objectID":"/posts/nowcoder157a/:0:3","tags":["æ•°å­¦","ç»„åˆæ•°å­¦","ACM","Nowcoder","C++"],"title":"çŸ³å­é˜µåˆ—ï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/nowcoder157a/"},{"categories":["ACM"],"content":"ç¤ºä¾‹ 1 è¾“å…¥ 1 1 è¾“å‡º 1 ","date":"2018-08-10","objectID":"/posts/nowcoder157a/:0:4","tags":["æ•°å­¦","ç»„åˆæ•°å­¦","ACM","Nowcoder","C++"],"title":"çŸ³å­é˜µåˆ—ï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/nowcoder157a/"},{"categories":["ACM"],"content":"ç¤ºä¾‹ 2 è¾“å…¥ 2 3 è¾“å‡º 6 ","date":"2018-08-10","objectID":"/posts/nowcoder157a/:0:5","tags":["æ•°å­¦","ç»„åˆæ•°å­¦","ACM","Nowcoder","C++"],"title":"çŸ³å­é˜µåˆ—ï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/nowcoder157a/"},{"categories":["ACM"],"content":"ç¤ºä¾‹ 3 è¾“å…¥ 3 3 è¾“å‡º 12 ","date":"2018-08-10","objectID":"/posts/nowcoder157a/:0:6","tags":["æ•°å­¦","ç»„åˆæ•°å­¦","ACM","Nowcoder","C++"],"title":"çŸ³å­é˜µåˆ—ï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/nowcoder157a/"},{"categories":["ACM"],"content":"å¤‡æ³¨ï¼š å¯¹äº 100%çš„æµ‹è¯•æ•°æ®ï¼š 1 â‰¤ n, m â‰¤ 1000 æ•°æ®é‡è¾ƒå¤§ï¼Œæ³¨æ„ä½¿ç”¨æ›´å¿«çš„è¾“å…¥è¾“å‡ºæ–¹å¼ã€‚ æ°´é¢˜ã€‚ #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ long long n,m,ans; scanf(\"%lld%lld\",\u0026n,\u0026m); ans=m; for(int i=1;i\u003cn;i++) ans=(ans*(m-1))%1000000007; printf(\"%lld\\n\",ans); return 0; } ","date":"2018-08-10","objectID":"/posts/nowcoder157a/:0:7","tags":["æ•°å­¦","ç»„åˆæ•°å­¦","ACM","Nowcoder","C++"],"title":"çŸ³å­é˜µåˆ—ï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/nowcoder157a/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ Dreamoon wants to climb up a stair of n steps. He can climb 1 or 2 steps at each move. Dreamoon wants the number of moves to be a multiple of an integer m. What is the minimal number of moves making him climb to the top of the stairs that satisfies his condition? ","date":"2018-08-10","objectID":"/posts/codeforces476a/:0:0","tags":["Codeforces","ACM","æ•°å­¦","C++","C"],"title":"Dreamoon and Stairs","uri":"/posts/codeforces476a/"},{"categories":["ACM"],"content":"Input The single line contains two space separated integers n, m (0â€‰\u003câ€‰nâ€‰â‰¤â€‰10000,â€‰1â€‰\u003câ€‰mâ€‰â‰¤â€‰10). ","date":"2018-08-10","objectID":"/posts/codeforces476a/:0:1","tags":["Codeforces","ACM","æ•°å­¦","C++","C"],"title":"Dreamoon and Stairs","uri":"/posts/codeforces476a/"},{"categories":["ACM"],"content":"Output Print a single integer â€” the minimal number of moves being a multiple of m. If there is no way he can climb satisfying condition print -â€‰1 instead. ","date":"2018-08-10","objectID":"/posts/codeforces476a/:0:2","tags":["Codeforces","ACM","æ•°å­¦","C++","C"],"title":"Dreamoon and Stairs","uri":"/posts/codeforces476a/"},{"categories":["ACM"],"content":"Examples input 10 2 output 6 input 3 5 output -1 ","date":"2018-08-10","objectID":"/posts/codeforces476a/:0:3","tags":["Codeforces","ACM","æ•°å­¦","C++","C"],"title":"Dreamoon and Stairs","uri":"/posts/codeforces476a/"},{"categories":["ACM"],"content":"Note For the first sample, Dreamoon could climb in 6 moves with following sequence of steps: {2, 2, 2, 2, 1, 1}. For the second sample, there are only three valid sequence of steps {2, 1}, {1, 2}, {1, 1, 1} with 2, 2, and 3 steps respectively. All these numbers are not multiples of 5. æœ‰ä¸€ä¸ª n çº§å°é˜¶ï¼Œæ¯æ¬¡å¯ä»¥èµ°ä¸€çº§æˆ–ä¸¤çº§ï¼Œé—®æœ€å°‘çš„æ­¥æ•°æ˜¯å¤šå°‘ï¼Œä¸”æ­¥æ•°å¿…é¡»æ˜¯ m çš„å€æ•°ã€‚ æ‰¾ä¸€ä¸‹æ•°å­¦å…¬å¼å°±å¥½äº†ã€‚ å…·ä½“çœ‹ä»£ç ã€‚ #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ int x,n,m; cin\u003e\u003en\u003e\u003em; if(n\u003cm){ cout\u003c\u003c-1\u003c\u003cendl; return 0; } if(n==m){ cout\u003c\u003cn\u003c\u003cendl; return 0; } if(n%2==0){ x=n/2%m; if(x==0) cout\u003c\u003cn/2\u003c\u003cendl; else cout\u003c\u003cn/2+m-x\u003c\u003cendl; }else if(n%2!=0){ x=(n/2+1)%m; if(x==0) cout\u003c\u003cn/2+1\u003c\u003cendl; else cout\u003c\u003c(n/2+1)+m-x\u003c\u003cendl; } return 0; } ","date":"2018-08-10","objectID":"/posts/codeforces476a/:0:4","tags":["Codeforces","ACM","æ•°å­¦","C++","C"],"title":"Dreamoon and Stairs","uri":"/posts/codeforces476a/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ ","date":"2018-08-10","objectID":"/posts/codeforces476b/:0:0","tags":["ç»„åˆæ•°å­¦","Codeforces","ACM","æ•°å­¦","C++","C"],"title":"Dreamoon and WiFiï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/codeforces476b/"},{"categories":["ACM"],"content":"é¢˜ç›®å¤§æ„ å°±æ˜¯ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ç”±\"+\",\"-â€œç»„æˆï¼Œç¬¬äºŒä¸ªå­—ç¬¦ä¸²ç”±â€+\",\"-\",\"?â€œç»„æˆï¼Œâ€œ+â€ä»£è¡¨åŠ  1ï¼Œâ€-â€œä»£è¡¨å‡ä¸€ï¼Œâ€œ?â€œä»£è¡¨å¯å–æ­£ä¹Ÿå¯å–è´Ÿï¼Œé—®ç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„ä½ç½®å’Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰çš„æ¦‚ç‡æ˜¯å¤šå°‘ã€‚ æˆ‘ä¸€å¼€å§‹çš„æƒ³æ³•æ˜¯æŠŠï¼ˆ+1ï¼Œ-1ï¼‰^n çœ‹æˆå’ŒäºŒé¡¹å¼å®šç†ä¸€æ ·çš„å±•å¼€å§‹å¼ï¼Œåªä¸è¿‡æŠŠä¹˜æ³•æ”¹ä¸ºåŠ æ³•ï¼Œç„¶åå¾—åˆ°å…¬å¼ c(n,0)(n+(-1)0)+c(n,1)(n-1+(-1)1)+c(n,i)(n-i+(-1)i)+...+c(n,n)(n-n+(-1)n) åŒ–ç®€ä¸€ä¸‹å¯çŸ¥é€šé¡¹ä¸ºc(n,i)(n-2*i) ç„¶åæˆ‘å¯¹ç¬¬ä¸€ä¸ªä¸²æ±‚å‡ºä½ç½® sum, ç¬¬äºŒä¸ªä¸²å…ˆæ±‚å‡ºå·²çŸ¥ä½ç½® sum1ï¼Œç„¶åè®°å½•ä¸‹ï¼Ÿçš„ä¸ªæ•°ï¼Œç„¶åéå†æ‰¾å‡ºå±•å¼€å¼ä¸­æŸä¸€é¡¹ n-2i+sum1==sumï¼Œè¿™æ · x çš„ç³»æ•°å°±æ˜¯å¯èƒ½å‡ºç°ä½ç½®ç›¸ç­‰çš„æ‰€æœ‰æƒ…å†µï¼Œç”¨ (n-2i)/ç³»æ•°å’Œå°±æ˜¯æ¦‚ç‡äº†å•Šï¼Œå¯æ˜¯ä¸ºä»€ä¹ˆä¸å¯¹å‘¢ï¼Œæœ¬åœ°è°ƒè¯•ï¼Œæ•°æ®æ²¡é—®é¢˜ï¼Œå¯æ˜¯äº¤åˆ° cf ä¸Šç¬¬äºŒç»„éƒ½è¿‡ä¸äº†ï¼Œçƒ¦äºæˆ‘è¿˜è§‰å¾—æƒ³åˆ°ä¸€ä¸ªç‹¬è¾Ÿçš„æ–¹æ³•å‘¢ï¼Œè¿‡ä¸äº†ã€‚ //cf é”™è¯¯æŠ¥å‘Šï¼Œæ€å‰æåä¸æ™“å¾— why,wtf??? å…ˆç ç€å§ Test: #2, time: 0 ms., memory: 0 KB, exit code: 0, checker exit code: 1, verdict: WRONG_ANSWER Input +-+- +-?? Output -0.000000000000 Answer 0.500000000000 Checker Log wrong answer 1st numbers differ - expected: '0.5000000', found: '-0.0000000', error = '0.5000000' ","date":"2018-08-10","objectID":"/posts/codeforces476b/:0:1","tags":["ç»„åˆæ•°å­¦","Codeforces","ACM","æ•°å­¦","C++","C"],"title":"Dreamoon and WiFiï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/codeforces476b/"},{"categories":["ACM"],"content":"é”™è¯¯ä»£ç  #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ int i,j,cnt=0; long long c[11][11],sum=0,sum1=0; for(i = 0; i \u003c 11; i++){//æ¨è¾‰ä¸‰è§’ c[i][0] = 1; c[i][i] = 1; for(j = 1; j \u003c i; j++) c[i][j] = c[i-1][j] + c[i-1][j-1]; } string a,b; cin\u003e\u003ea\u003e\u003eb; //cout\u003c\u003ca\u003c\u003cendl\u003c\u003cb\u003c\u003cendl; int len=a.length(); for(i=0;i\u003clen;i++) if(a[i]=='+') sum+=1; else sum-=1; for(i=0;i\u003cb.length();i++){ if(b[i]=='+') sum1+=1; else if(b[i]=='-')sum1-=1; if(b[i]=='?') cnt++; } if(sum==sum1\u0026\u0026cnt==0){ printf(\"1.000000000000\\n\"); return 0; } int flag=0; int x=0; for(j=0;j\u003c=cnt;j++) x+=c[cnt][j]; //cout\u003c\u003cx\u003c\u003cendl; for(i=0;i\u003c=cnt;i++) if(cnt-2*i+sum1==sum){ flag=1; long double y=c[cnt][i]*1.0/x; printf(\"%.12llf\\n\",y); } if(!flag)printf(\"0.000000000000\\n\"); return 0; } æƒ³ä¸é€šï¼Œæ²¡åŠæ³•åªå¥½æ¢æ€è·¯ã€‚ æˆ‘å…ˆåˆ†åˆ«è®°ä¸‹ a,b ä¸²çš„â€™+â€™,â€™-â€™,â€™?â€˜ä¸ªæ•°ï¼Œç„¶ååæˆ‘ä»¬å¾ˆå®¹æ˜“çŸ¥é“ï¼Œå¦‚è¦ a,b ä½ç½®ç›¸ç­‰ï¼Œåˆ™åŠ å·å’Œå‡å·çš„æ•°ç›®ï¼Œä¸¤ä¸²è¦ç›¸ç­‰ï¼Œä¸” a ä¸­çš„åŠ å·è¦æ¯” b ä¸­å·²çŸ¥çš„åŠ å·è¦å¤šï¼Œå‡å·ä¹Ÿè¦æ¯” b ä¸­å·²çŸ¥çš„è¦å¤šï¼Œå¦åˆ™æ‰“æ­»éƒ½ä¸ä¼šç›¸ç­‰çš„ï¼Œä»”ç»†æ¯”åˆ’ä¸€ä¸‹å°±çŸ¥é“äº†ã€‚ç„¶åæœ‰ z ä¸ªâ€˜?â€™ï¼Œç›¸å½“äºæœ‰ z ä¸ªå‘ï¼Œè®©æˆ‘ä»¬å»å¡«ä½¿å¾— a,b ç›¸ç­‰ã€‚åªèƒ½å¡«+æˆ–-ï¼Œè®¾åŠ å·å·®ç­‰äº x-p, æ‰€ä»¥æ¦‚ç‡å°±ç­‰äº c(z,x-p)/2^zã€‚ ","date":"2018-08-10","objectID":"/posts/codeforces476b/:0:2","tags":["ç»„åˆæ•°å­¦","Codeforces","ACM","æ•°å­¦","C++","C"],"title":"Dreamoon and WiFiï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/codeforces476b/"},{"categories":["ACM"],"content":"AC ä»£ç  #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ string a,b; int x,y,z,p,q,c[11][11],i,j; for(i = 0; i \u003c 11; i++){ c[i][0] = 1; c[i][i] = 1; for(j = 1; j \u003c i; j++) c[i][j] = c[i-1][j] + c[i-1][j-1]; } cin\u003e\u003ea; cin\u003e\u003eb; x=y=z=p=q=0; for(i=0;i\u003ca.length();i++) if(a[i]=='+') x++; else y++; for(i=0;i\u003cb.length();i++){ if(b[i]=='+') p++; else if(b[i]=='-') q++; else z++; } if(x==p\u0026\u0026z==0){ printf(\"1.000000000000\\n\"); return 0; } if(x-p\u003c0||y-q\u003c0) { printf(\"0.000000000000\\n\"); return 0; } x=x-p; printf(\"%0.12f\",c[z][x]*1.0/(2\u003c\u003c(z-1))); return 0; } å‡ åˆ†é’Ÿå†™å®Œåé¢çš„ä»£ç ï¼Œå¿ƒä¸­ä¸€ä¸‡å¤´è‰æ³¥é©¬åœ¨å¥”è…¾ã€‚ ","date":"2018-08-10","objectID":"/posts/codeforces476b/:0:3","tags":["ç»„åˆæ•°å­¦","Codeforces","ACM","æ•°å­¦","C++","C"],"title":"Dreamoon and WiFiï¼ˆç»„åˆæ•°å­¦ï¼‰","uri":"/posts/codeforces476b/"},{"categories":["ACM"],"content":"é¢˜æ„ï¼š ç»™å‡º a,b,c,x1,x2,y1,y2ï¼Œæ±‚æ»¡è¶³ ax+by+c=0ï¼Œä¸” xâˆˆ[x1,x2],yâˆˆ[y1,y2] çš„æ•´æ•°è§£ä¸ªæ•°ã€‚ ","date":"2018-08-10","objectID":"/posts/euclid/:0:1","tags":["æ•°å­¦","æ•°è®º","ACM","æ¬§å‡ é‡Œå¾—","ä»–å±±ä¹‹çŸ³","C++","C"],"title":"The equation-SGU106ï¼ˆæ‰©å±•æ¬§å‡ é‡Œå¾—ï¼‰","uri":"/posts/euclid/"},{"categories":["ACM"],"content":"åˆ†æï¼š å¯¹äºè§£äºŒå…ƒä¸€æ¬¡ä¸å®šæ–¹ç¨‹ï¼Œå®¹æ˜“æƒ³åˆ°åˆ©ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚å‡ºä¸€ç»„å¯è¡Œè§£åæ‰¾åˆ°é€šè§£ï¼Œä¸‹é¢æ¥ä»‹ç»ä¸€ä¸‹æ¬§å‡ é‡Œå¾—ä»¥åŠæ‰©å±•æ¬§å‡ é‡Œå¾—ã€‚ æ¬§å‡ é‡Œå¾—ï¼š åˆåè¾—è½¬ç›¸é™¤æ³•ï¼Œæ˜¯ç”¨æ¥è®¡ç®—ä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬çº¦æ•°ï¼Œå…¶ä¸­å°±æ˜¯åˆ©ç”¨ gcd(a,b)=gcd(b,a mod b) æ¥æ±‚è§£ã€‚ä¸‹è¯ gcd(a,b)=gcd(b,a mod b) çš„æ­£ç¡®æ€§ï¼š è®¾ a,b çš„ä¸€ä¸ªå…¬çº¦æ•°ä¸º d è®¾ a mod b=rï¼Œåˆ™ a=kb+r(k ä¸ºæ•´æ•°ï¼‰ï¼Œr=a-kb å› ä¸º d|a,d|b æ‰€ä»¥ d|a-kb, å³ d|rï¼Œè€Œ r=a mod b æ‰€ä»¥ d ä¸º b,a mod b çš„å…¬çº¦æ•° åˆå› ä¸º d ä¹Ÿä¸º a,b çš„å…¬çº¦æ•°ï¼Œæ‰€ä»¥ï¼ˆa,b) å’Œ (b,a mod b) çš„å…¬çº¦æ•°ä¸€æ ·ï¼Œæ‰€ä»¥æœ€å¤§å…¬çº¦æ•°å¿…ç„¶ä¸€æ ·ï¼Œå¾—è¯ã€‚ ä»£ç æè¿°ï¼š int gcd(int a,int b) { if (b==0) return a; return gcd(b,a%b); } æ‰©å±•æ¬§å‡ é‡Œå¾— é¡¾åæ€ä¹‰ï¼Œä¸ºä¸Šè¿°æ¬§å‡ é‡Œå¾—ç®—æ³•çš„æ‰©å±•ã€‚æ¬§å‡ é‡Œå¾—æ˜¯ç”¨æ¥æ±‚ a,b çš„æœ€å¤§å…¬çº¦æ•°ï¼Œé‚£ä¹ˆæ‰©å±•æ¬§å‡ é‡Œå¾—ä¸ä»…èƒ½æ±‚å‡º a,b çš„æœ€å¤§å…¬çº¦æ•°ï¼Œè¿˜èƒ½æ±‚å‡ºæ»¡è¶³ ax+by=gcd(a,b) çš„ä¸€ç»„å¯è¡Œè§£ã€‚ æ±‚è§£è¿‡ç¨‹ä¸­ï¼Œæ‰©å±•æ¬§å‡ é‡Œå¾—æ¯”æ¬§å‡ é‡Œå¾—å¤šäº†ä¸€ä¸ªèµ‹å€¼è¿‡ç¨‹ï¼Œå…·ä½“è¯æ˜å¦‚ä¸‹ï¼š è®¾ ax1+by1=gcd(a,b),bx2+(a mod b)y2=gcd(b,a mod b) å› ä¸ºç”±æ¬§å‡ é‡Œå¾—ç®—æ³•å¯çŸ¥ï¼Œgcd(a,b)=gcd(b,a mod b) æ‰€ä»¥ ax1+by1=bx2+(a mod b)y2 å› ä¸ºa mod b=a-(a div b)*bï¼ˆdiv ä¸ºæ•´é™¤ æ‰€ä»¥æœ‰ax1+by1=bx2+(a-(a div b)*b)y2 å°†å³è¾¹ç§»é¡¹ï¼Œå±•å¼€å¾—ï¼š ax1+by1=ay2+bx2-(a div b)*b*y2 =ay2+b[x2-(a div b)]y2 æ‰€ä»¥å¯å¾—ï¼š x1=y2 y1=x2-(a div b)*y2 å°†å¾—åˆ°çš„çš„ x1,y1 é€’å½’æ“ä½œæ±‚è§£ x2,y2ï¼Œå¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œå°†ä¼šåƒæ¬§å‡ é‡Œå¾—ä¸€æ ·å¾—åˆ° b=0 çš„æƒ…å†µï¼Œæ­¤æ—¶é€’å½’ç»“æŸï¼Œè¿”å› x=1,y=0ï¼Œå›æº¯å¾—è§£ã€‚ ä»£ç æè¿°ï¼š æ­¤å‡½æ•°è¿”å›çš„æ˜¯ a,b çš„æœ€å¤§å…¬çº¦æ•°ï¼ŒåŒæ—¶ä¹Ÿæ±‚è§£å‡ºæ»¡è¶³ ax+by=gcd(a,b) çš„ä¸€ç»„å¯è¡Œçš„ (x,y) int exgcd(int a,int b,int \u0026x,int \u0026y) { if (b==0) {x=1;y=0;return a;} int t=exgcd(b,a%b,x,y); int x0=x,y0=y; x=y0;y=x0-(a/b)*y0; return t; } å…³äºæ±‚è§£äºŒå…ƒä¸€æ¬¡ä¸å®šæ–¹ç¨‹ ax+by=c é¦–å…ˆï¼Œå¦‚æœ c ä¸æ˜¯ gcd(a,b) çš„å€æ•°ï¼Œæ–¹ç¨‹æ˜¾ç„¶æ— è§£ã€‚ æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚è§£çš„æ˜¯ ax+by=gcd(a,b)=1 çš„å¯è¡Œè§£ï¼Œä½†æ˜¯é¢˜ç›®ä¸­å¹¶æ²¡æœ‰è¯´ c ä¸ a,b äº’è´¨ä¹‹ç±»çš„æ¡ä»¶ï¼Œæ‰€ä»¥éœ€è¦åœ¨å¼€å§‹æ—¶ä¸¤è¾¹åŒæ—¶é™¤ä»¥ gcd(a,b)ã€‚ è®¾ d=gcd(a,b) è®¾ aâ€™=a/d,bâ€™=b/d,câ€™=c/d, åˆ™ä¸‹é¢éœ€è¦æ±‚è§£ aâ€™x+bâ€™y=câ€™çš„æ•´æ•°è§£ï¼Œè€Œ gcd(aâ€™,bâ€™)=1ï¼Œ åˆ™æˆ‘ä»¬åªéœ€æ±‚ aâ€™x+bâ€™y=1 çš„å¯è¡Œè§£ ç›´æ¥ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ï¼Œå¾—åˆ° (xâ€™,yâ€™), åˆ™æœ€ç»ˆè§£ä¸ºx'*c',y'*c'è®¾ä¸º (x0,y0)ã€‚ ç°åœ¨å¾—åˆ°äº†ä¸€ç»„å¯è¡Œè§£ï¼Œä½†æ˜¯å¦‚ä½•å¾—åˆ°é€šè§£å‘¢ï¼Ÿ å°† (x0,y0) ä»£å…¥ ax+by=cï¼Œåˆ™æœ‰ a*(x0)+b*(y0)=c é€šè¿‡æ‹†æ·»é¡¹ï¼Œå¯æœ‰ï¼š a*(x0+1*b)+b*(y0-1*a)=c a*(x0+2*b)+b*(y0-2*a)=c a*(x0+3*b)+b*(y0-3*a)=c â€¦â€¦ a*(x0+k*b)+b*(y0-k*a)=c (kâˆˆZ) è‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†é€šè§£çš„æ–¹ç¨‹ x=x0+k*b y=y0-k*a (kâˆˆZ) è¿™æ ·ï¼Œæ‰€æœ‰æ»¡è¶³ ax+by=c çš„å¯è¡Œè§£éƒ½å¯æ±‚å‡ºã€‚ ","date":"2018-08-10","objectID":"/posts/euclid/:0:2","tags":["æ•°å­¦","æ•°è®º","ACM","æ¬§å‡ é‡Œå¾—","ä»–å±±ä¹‹çŸ³","C++","C"],"title":"The equation-SGU106ï¼ˆæ‰©å±•æ¬§å‡ é‡Œå¾—ï¼‰","uri":"/posts/euclid/"},{"categories":["ACM"],"content":"å…·ä½“å®ç° æœ‰äº†ä¸»ä½“ç®—æ³•ï¼Œä¸‹é¢è¦è°ˆåˆ°å…·ä½“å®ç°äº†ã€‚ å…ˆå¤„ç†ä¸€ä¸‹æ— è§£çš„æƒ…å†µï¼š å½“ a=0 å¹¶ä¸” b=0ï¼Œè€Œ câ‰ 0 æ—¶ï¼Œæ˜¾ç„¶æ— è§£ï¼› å½“ a=0,b=0ï¼Œè€Œ c=0 æ—¶ï¼Œ[x1,x2],[y1,y2] éƒ½ä¸ºå¯è¡Œè§£ï¼Œæ ¹æ®ä¹˜æ³•åŸç†ï¼Œå¯è¡Œè§£çš„ä¸ªæ•°ä¸º(x2-x1+1)*(y2-y1+1); å½“ a=0 bâ‰ 0 æ—¶ï¼š æ­¤æ—¶å³ä¸ºæ±‚è§£ by=cï¼Œåˆ™ y=c/bï¼Œ å¦‚æœ c/b ä¸æ˜¯æ•´æ•°æˆ– c/b ä¸åœ¨ [y1,y2] çš„èŒƒå›´å†…ï¼Œæ— è§£ å¦åˆ™ [x1,x2] å†…å…¨éƒ¨æ•´æ•°éƒ½ä¸ºå¯è¡Œè§£ã€‚ å½“ b=0,aâ‰ 0 æ—¶ï¼ŒåŒä¸Šã€‚ è‹¥ c ä¸æ˜¯ gcd(a,b) çš„ä¸ªæ•°ï¼Œæ–¹ç¨‹æ˜¾ç„¶æ— è§£ã€‚ å¤„ç†å®Œäº†ä¸€äº›ç¹ççš„ç»†èŠ‚åï¼Œä¸‹é¢æ˜¯å…·ä½“çš„æ±‚è§£è¿‡ç¨‹ï¼š æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚è§£çš„æ˜¯ ax+by=cï¼Œè€Œæœ¬é¢˜æ˜¯ ax+by+c=0ï¼Œéœ€å°† c ç§»é¡¹ã€‚ å¯¹äºæœ¬é“é¢˜ï¼Œé¦–å…ˆè¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºè´Ÿæ•°çš„æ¨¡è¿ç®—åœ¨æ­¤ç®—æ³•ä¸­æ— æ³•å¾—åˆ°æ­£ç¡®è§£ï¼Œæ‰€ä»¥è¦å¤„ç†ä¸€ä¸‹ a,b,c çš„æ­£è´Ÿæƒ…å†µã€‚ å¦‚æœ a ä¸ºè´Ÿæ•°ï¼Œåªéœ€å°† a å–ç›¸åæ•°åï¼Œå†å¤„ç†ä¸€ä¸‹ xâˆˆ[x1,x2] çš„èŒƒå›´ã€‚å½“ a å–äº†ç›¸åæ•°ï¼Œç›¸å½“äºæŠŠ x ä¹Ÿå–åï¼Œåˆ™éœ€è¦æŠŠ x çš„èŒƒå›´ç”± [x1,x2] è½¬å˜æˆ [-x2,-x1], ç±»ä¼¼äºæŠŠæ•°è½´åäº†è¿‡æ¥ã€‚b åŒç†ã€‚ åˆ©ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—è§£äºŒå…ƒä¸€æ¬¡ä¸å®šæ–¹ç¨‹ï¼Œå¾—åˆ°ä¸€ç»„å¯è¡Œè§£ (x0,y0)ã€‚ å› ä¸ºé¢˜ç›®ä¸­å¯¹ x,y æœ‰æ¡ä»¶çº¦æŸï¼Œè€Œæœ‰ x=x0+kb,y=y0-kbï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡ºæ»¡è¶³ xâˆˆ[x1,x2],yâˆˆ[y1,y2] çš„ k çš„å–å€¼èŒƒå›´ï¼Œ å³ä¸ºæ±‚è§£ x1\u003c=x0+kb\u003c=x2,y1\u003c=y0-kb\u003c=y2 çš„æ•´æ•° k çš„ä¸ªæ•° ä½†æ˜¯åœ¨æ±‚è§£è¿™ä¸¤ä¸ªä¸€æ¬¡å‡½æ•°çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰é™¤ä¸å°½çš„ç°è±¡ï¼Œè¯¥å¦‚ä½•å–æ•´å‘¢ï¼Ÿ ä¸¾ä¸ªä¾‹å­ å½“å‡ºç° 2.5\u003c=k\u003c=5.5 æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çš„å¯è¡Œçš„ k ä¸º 3,4,5ï¼Œæ‰€ä»¥éœ€è¦å°† 2.5 å‘ä¸Šå–æ•´å¾—åˆ° 3ï¼Œ5.5 å‘ä¸‹å–æ•´å¾—åˆ° 5ï¼Œå³ä¸º 3\u003c=k\u003c=5ï¼› å½“å‡ºç°-5.5\u003c=\u003c=-2.5 æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çš„å¯è¡Œçš„ k ä¸º-5,-4,-3, æ‰€ä»¥éœ€è¦å°†-5.5 å‘ä¸Šå–æ•´å¾—åˆ°-5,-2.5 å‘ä¸‹å–æ•´å¾—åˆ°-3ï¼Œå³ä¸º-5\u003c=k\u003c=-3ï¼› æ­£è´Ÿæ•°çš„æƒ…å†µéƒ½å·²ç»è€ƒè™‘å®Œå…¨äº†ï¼Œå¯ä»¥å¾—åˆ°å–æ•´çš„ç»“è®ºï¼šä¸Šç•Œä¸‹å–æ•´ï¼Œä¸‹ç•Œä¸Šå–æ•´ã€‚ æœ€åï¼Œå°†å¾—åˆ°çš„ä¸¤ä¸ªèŒƒå›´å–äº¤é›†ï¼Œå¾—åˆ° [l,r]ï¼Œåˆ™æœ€ç»ˆç­”æ¡ˆä¸º r-l+1ã€‚ è¿™æ ·ï¼Œæœ¬é¢˜å°±å¯ä»¥å®Œç¾è§£å†³äº†ã€‚ // BY Rinyo #include\u003ccstdio\u003e #include\u003ccmath\u003e long long a,b,c,x1,x2,yy1,y2,x0,yy0; inline long long cmin(const long long \u0026x,const long long \u0026y) {return x\u003cy?x:y;} inline long long cmax(const long long \u0026x,const long long \u0026y) {return x\u003ey?x:y;} long long gcd(long long a,long long b) { if (b==0) return a; return gcd(b,a % b); } void exgcd(long long a,long long b) { if (b==0){x0=1;yy0=0;return;} exgcd(b,a%b); long long t=x0;x0=yy0;yy0=t-a/b*yy0; return; } int main() { scanf(\"%I64d%I64d%I64d%I64d%I64d%I64d%I64d\",\u0026a,\u0026b,\u0026c,\u0026x1,\u0026x2,\u0026yy1,\u0026y2); c=-c; if (c\u003c0) {a=-a;b=-b;c=-c;} if (a\u003c0) {a=-a;long long t=x1;x1=-x2;x2=-t;} if (b\u003c0) {b=-b;long long t=yy1;yy1=-y2;y2=-t;} if (a==0 \u0026\u0026 b==0) { if (c==0) { printf(\"%I64d\",(x2-x1+1)*(y2-yy1+1)); return 0; } printf(\"0\");return 0; } else if (a==0) { if (c %b ==0) if (c/b\u003c=y2 \u0026\u0026 c/b\u003e=yy1) {printf(\"%I64d\",x2-x1+1);return 0;} printf(\"0\");return 0; } else if (b==0) { if (c%a==0) if (c/a\u003c=x2 \u0026\u0026 c/a\u003e=x1) {printf(\"%I64d\",y2-yy1+1);return 0;} printf(\"0\");return 0; } long long d=gcd(a,b); if (c%d!=0){printf(\"0\");return 0;} a=a/d;b=b/d;c=c/d; exgcd(a,b); x0=x0*c;yy0=yy0*c; double tx2=x2,tx1=x1,tx0=x0,ta=a,tb=b,tc=c,ty1=yy1,ty2=y2,ty0=yy0; long long down1=floor(((tx2-tx0)/tb)),down2=floor(((ty0-ty1)/ta)); long long r=cmin(down1,down2); long long up1=ceil(((tx1-tx0)/tb)),up2=ceil(((ty0-ty2)/ta)); long long l=cmax(up1,up2); if (r\u003cl) printf(\"0\"); else printf(\"%I64d\",r-l+1); return 0; } æ‰©å±•æ¬§å‡ é‡Œå¾—æ¨¡æ¿ #include\u003ciostream\u003e using namespace std; int exgcd(int a,int b,int \u0026x,int \u0026y) { if(b==0) { x=1; y=0; return a; } int gcd=exgcd(b,a%b,x,y); int x2=x,y2=y; x=y2; y=x2-(a/b)*y2; return gcd; } int main() { int x,y,a,b; cout\u003c\u003c\"è¯·è¾“å…¥ a å’Œ b:\"\u003c\u003cendl; cin\u003e\u003ea\u003e\u003eb; cout\u003c\u003c\"a å’Œ b çš„æœ€å¤§å…¬çº¦æ•°ï¼š\"\u003c\u003cendl; cout\u003c\u003cexgcd(a,b,x,y)\u003c\u003cendl; cout\u003c\u003c\"ax+by=gcd(a,b) çš„ä¸€ç»„è§£æ˜¯ï¼š\"\u003c\u003cendl; cout\u003c\u003cx\u003c\u003c\" \"\u003c\u003cy\u003c\u003cendl; return 0; } ","date":"2018-08-10","objectID":"/posts/euclid/:0:3","tags":["æ•°å­¦","æ•°è®º","ACM","æ¬§å‡ é‡Œå¾—","ä»–å±±ä¹‹çŸ³","C++","C"],"title":"The equation-SGU106ï¼ˆæ‰©å±•æ¬§å‡ é‡Œå¾—ï¼‰","uri":"/posts/euclid/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ ","date":"2018-08-09","objectID":"/posts/lightoj1282/:0:1","tags":["æ•°è®º","æ•°å­¦","å¿«é€Ÿå¹‚","ACM","C"],"title":"Leading and Trailing-lightoj1282ï¼ˆå¿«é€Ÿå¹‚+å¯¹æ•°è¿ç®—ï¼‰","uri":"/posts/lightoj1282/"},{"categories":["ACM"],"content":"é¢˜ç›®å¤§æ„ï¼š ç»™å®šä¸¤ä¸ªæ•° n,k æ±‚ n^k çš„å‰ä¸‰ä½å’Œæœ€åä¸‰ä½ã€‚ ","date":"2018-08-09","objectID":"/posts/lightoj1282/:0:2","tags":["æ•°è®º","æ•°å­¦","å¿«é€Ÿå¹‚","ACM","C"],"title":"Leading and Trailing-lightoj1282ï¼ˆå¿«é€Ÿå¹‚+å¯¹æ•°è¿ç®—ï¼‰","uri":"/posts/lightoj1282/"},{"categories":["ACM"],"content":"åˆ†æ æ±‚åä¸‰ä½çš„è¯ï¼šç›´æ¥å¿«é€Ÿå¹‚ï¼Œå¯¹ 1000 å–æ¨¡å°±å¥½äº†ã€‚ æ±‚å‰ä¸‰ä½ï¼Œå¯¹äºç»™å®šçš„ä¸€ä¸ªæ•° n, å®ƒå¯ä»¥å†™æˆ n=10^a, å…¶ä¸­è¿™ä¸ª a ä¸ºæµ®ç‚¹æ•°ï¼Œåˆ™t=n^k=(10^a)^k=10^a*k=(10^x)*(10^y);å…¶ä¸­ x,y åˆ†åˆ«æ˜¯a*kçš„æ•´æ•°éƒ¨åˆ†å’Œå°æ•°éƒ¨åˆ†ï¼Œå¯¹äº t=n^k è¿™ä¸ªæ•°ï¼Œå®ƒçš„ä½æ•°ç”± (10^x) å†³å®šï¼Œå®ƒçš„ä½æ•°ä¸Šçš„å€¼åˆ™æœ‰ (10^y) å†³å®šï¼Œå› æ­¤æˆ‘ä»¬è¦æ±‚ t çš„å‰ä¸‰ä½ï¼Œåªéœ€è¦å°† 10^y æ±‚å‡ºï¼Œåœ¨ä¹˜ä»¥ 100ï¼Œå°±å¾—åˆ°äº†å®ƒçš„å‰ä¸‰ä½ã€‚ åˆ†æå®Œï¼Œæˆ‘ä»¬å†æ•´ä½“çœ‹ï¼Œè®¾ n^k=10^z; é‚£ä¹ˆz=k*log10(n) fmod(z,1)å¯ä»¥æ±‚å‡º x çš„å°æ•°éƒ¨åˆ†ã€‚ //å†ä¸€æ¬¡åæ§½ lightoj çš„å¤´æ–‡ä»¶ï¼Œè®©æˆ‘ä¸èƒ½ç”¨ä¸‡èƒ½å¤´\u003cbits/stdc++.h\u003e #include\u003cstdio.h\u003e #include\u003cmath.h\u003e typedef long long LL; int quickpow (int m, int n, int k) { int b = 1; while (n \u003e 0) { if (n \u0026 1) b = (b * m) % k; n \u003e\u003e= 1; m = (m * m) % k; } return b%k; } int main () { int t, flag = 1; scanf (\"%d\", \u0026t); while (t--) { LL n, k; scanf (\"%lld %lld\", \u0026n, \u0026k); int first = pow (10.0, 2.0 + fmod (k*log10(n*1.0), 1)); int last = quickpow (n%1000, k, 1000); printf (\"Case %d: %d %03d\\n\", flag++, first, last); } return 0; } ","date":"2018-08-09","objectID":"/posts/lightoj1282/:0:3","tags":["æ•°è®º","æ•°å­¦","å¿«é€Ÿå¹‚","ACM","C"],"title":"Leading and Trailing-lightoj1282ï¼ˆå¿«é€Ÿå¹‚+å¯¹æ•°è¿ç®—ï¼‰","uri":"/posts/lightoj1282/"},{"categories":["ACM"],"content":"æ³¨ï¼š C åº“å‡½æ•° - fmod() C åº“å‡½æ•° double fmod(double x, double y) è¿”å› x é™¤ä»¥ y çš„ä½™æ•°ã€‚ x â€“ ä»£è¡¨åˆ†å­çš„æµ®ç‚¹å€¼ã€‚ y â€“ ä»£è¡¨åˆ†æ¯çš„æµ®ç‚¹å€¼ã€‚ è¯¥å‡½æ•°è¿”å› x/y çš„ä½™æ•°ã€‚ ä¸‹é¢çš„å®ä¾‹æ¼”ç¤ºäº† fmod() å‡½æ•°çš„ç”¨æ³•ã€‚ #include \u003cstdio.h\u003e #include \u003cmath.h\u003e int main () { float a, b; int c; a = 9.2; b = 3.7; c = 2; printf(\"%f / %d çš„ä½™æ•°æ˜¯ %lf\\n\", a, c, fmod(a,c)); printf(\"%f / %f çš„ä½™æ•°æ˜¯ %lf\\n\", a, b, fmod(a,b)); return(0); } ç»“æœï¼š 9.200000 / 2 çš„ä½™æ•°æ˜¯ 1.200000 9.200000 / 3.700000 çš„ä½™æ•°æ˜¯ 1.800000 ","date":"2018-08-09","objectID":"/posts/lightoj1282/:0:4","tags":["æ•°è®º","æ•°å­¦","å¿«é€Ÿå¹‚","ACM","C"],"title":"Leading and Trailing-lightoj1282ï¼ˆå¿«é€Ÿå¹‚+å¯¹æ•°è¿ç®—ï¼‰","uri":"/posts/lightoj1282/"},{"categories":["ACM"],"content":"A. The Rank é¢˜ç›®å¤§æ„ï¼š ç»™å‡º n ä¸ªå­¦ç”Ÿçš„æˆç»©ï¼ŒThomas Smith çš„æˆç»©æ˜¯ç¬¬ä¸€è¡Œï¼Œç„¶åè¦æŒ‰æ€»æˆç»©è¿›è¡Œæ’åºï¼Œæ€»åˆ†ç›¸åŒçš„æŒ‰ç¼–å·ä»å°åˆ°å¤§æ’ï¼› å¼€å§‹çœ‹è¿˜ä»¥ä¸ºè¦å†™ sort çš„ cmp å‡½æ•°è¿›è¡Œå¤šæ¡ä»¶æ’åºï¼Œæ•²å®Œæ‰å‘ç°å…¶å®åªè¦æŒ‰æ€»åˆ†å°±å¯ä»¥äº†ï¼Œå› ä¸ºæ‰˜é©¬æ–¯çš„ id æ˜¯ä¸€ï¼Œå¿…ç„¶ä¼šæ’åœ¨å‰é¢ã€‚ #include\u003cbits/stdc++.h\u003e using namespace std; int a[4],sum[1005]; int main(){ int n,s,f1; cin\u003e\u003en; for(int j=1;j\u003c=n;j++){ s=0; for(int i=0;i\u003c4;i++){ cin\u003e\u003ea[i]; s+=a[i]; } sum[j]=s; if(j==1) f1=s; } sort(sum+1,sum+n+1,greater\u003cint\u003e()); for(int i=1;i\u003c=n;i++) if(sum[i]==f1){ cout\u003c\u003ci\u003c\u003cendl; break; } return 0; } ","date":"2018-08-09","objectID":"/posts/cfcontest1017/:0:1","tags":["ACM","Codeforces","ç»„åˆæ•°å­¦","C++"],"title":"Codeforces Round 502(Div.1 + Div.2)","uri":"/posts/cfcontest1017/"},{"categories":["ACM"],"content":"B. The Bits é¢˜ç›®å¤§æ„ï¼š å…ˆç»™å‡ºäºŒè¿›åˆ¶æ•°çš„é•¿åº¦ï¼Œç„¶åè¾“å…¥ä¸¤ä¸ªäºŒè¿›åˆ¶æ•° a,bï¼Œé—®äº¤æ¢ a ä¸­çš„æŸäº›ä½æ•°çš„æ•°ï¼Œä½¿å¾— a|bï¼ˆæŒ‰ä½æˆ–ï¼‰çš„ç»“æœä¸åŒï¼Œæ±‚æœ‰å¤šå°‘ç§ä¸åŒçš„æˆ–å€¼ã€‚ a,b ä¸Šä¸‹å¯¹åº”çš„æƒ…å†µï¼ša/b ä¸ªæ•° 1/0 m 0/0 n 1/1 x 0/1 y ç”¨ç»„åˆæ•°å­¦çš„æ€æƒ³æ¥æƒ³ï¼š åªè¦çœ‹ b ä¸º 0 çš„ä½å°±è¡Œäº†ï¼Œå¦‚æœ 0/0,a åªèƒ½æ¢ 1 çš„ä½ç½®ï¼Œä¸ºäº†é¿å…é‡å¤ï¼Œæ‰€ä»¥è¿™é‡Œæ€»æ•°ä¸ºn*x, å†è€ƒè™‘ 1/0 çš„æƒ…å†µï¼Œåªèƒ½å’Œ 0 çš„ä½ç½®æ¢ï¼Œè¿™æ˜¯åå¯ä»¥æŠŠ 0/0 æ²¡ç®—çš„éƒ½ç®—ä¸Šï¼Œæ‰€ä»¥æ€»æ•°m*(n+y) æ‰€ä»¥æœ€åæ€»æ•°ä¸ºsum=n*x+m*(n+y) #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ long long n,m,x,y,t; n=m=x=y=0; char a[100005],b[100005]; cin\u003e\u003et; cin\u003e\u003ea\u003e\u003eb; for(int i=0;i\u003ct;i++){ int p=a[i]-'0'; int q=b[i]-'0'; if(p==0\u0026\u0026q==0) n++; if(p==1\u0026\u0026q==0) m++; if(p==1\u0026\u0026q==1) x++; if(p==0\u0026\u0026q==1) y++; } long long sum=n*x+m*(y+n); cout\u003c\u003csum\u003c\u003cendl; return 0; } ","date":"2018-08-09","objectID":"/posts/cfcontest1017/:0:2","tags":["ACM","Codeforces","ç»„åˆæ•°å­¦","C++"],"title":"Codeforces Round 502(Div.1 + Div.2)","uri":"/posts/cfcontest1017/"},{"categories":["ACM"],"content":"æ¬§æ‹‰å‡½æ•°æ˜¯æ±‚å°äº x å¹¶ä¸”å’Œ xäº’è´¨ çš„æ•°çš„ä¸ªæ•° é€šå¼ï¼šÏ†(x)=x(1-1/p1)(1-1/p2)(1-1/p3)(1-1/p4)â€¦..(1-1/pn) å…¶ä¸­ p1, p2â€¦â€¦pn ä¸º x çš„æ‰€æœ‰è´¨å› æ•°ï¼Œx æ˜¯ä¸ä¸º 0 çš„æ•´æ•° Ï†(1)=1ï¼ˆå”¯ä¸€å’Œ 1 äº’è´¨çš„æ•°å°±æ˜¯ 1 æœ¬èº«ï¼‰ã€æ³¨æ„ï¼šæ¯ç§è´¨å› æ•°åªä¸€ä¸ªã€‚æ¯”å¦‚ 12=223ã€‘ ","date":"2018-08-08","objectID":"/posts/euler/:0:1","tags":["æ•°å­¦","æ•°è®º","euler","C"],"title":"æ¬§æ‹‰å‡½æ•°","uri":"/posts/euler/"},{"categories":["ACM"],"content":"å®šç†ï¼š è‹¥ n æ˜¯ç´ æ•° p çš„ k æ¬¡å¹‚ï¼ŒÏ†(n)=p^k-p^(k-1)=(p-1)p^(k-1)ï¼Œå› ä¸ºé™¤äº† p çš„å€æ•°å¤–ï¼Œå…¶ä»–æ•°éƒ½è·Ÿ n äº’è´¨ æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°â€”â€”è‹¥ m,n äº’è´¨ï¼ŒÏ†(mn)=Ï†(m)Ï†(n) ","date":"2018-08-08","objectID":"/posts/euler/:0:2","tags":["æ•°å­¦","æ•°è®º","euler","C"],"title":"æ¬§æ‹‰å‡½æ•°","uri":"/posts/euler/"},{"categories":["ACM"],"content":"ç‰¹æ®Šæ€§è´¨ï¼š å½“ n ä¸ºå¥‡æ•°æ—¶ï¼ŒÏ†(2n)=Ï†(n) p æ˜¯ç´ æ•°ï¼ŒÏ†(p) = p - 1ï¼ŒÏ†(p) ç§°ä¸º p çš„æ¬§æ‹‰å€¼ è‹¥ a ä¸ºç´ æ•°ï¼Œb mod a=0,Ï†(a*b)=Ï†(b)*a ","date":"2018-08-08","objectID":"/posts/euler/:0:3","tags":["æ•°å­¦","æ•°è®º","euler","C"],"title":"æ¬§æ‹‰å‡½æ•°","uri":"/posts/euler/"},{"categories":["ACM"],"content":"æ¨¡æ¿ //ç›´æ¥æ³• int Euler(int n){ int res = n,i; //ç”±äºä»»ä½•ä¸€ä¸ªåˆæ•°éƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸å¤§äºæ ¹å· n çš„ç´ å› å­ï¼Œæ‰€ä»¥åªè¦éå†åˆ°æ ¹å· n å³å¯ for(i=2;i * i \u003c= n;i++) if(n%i == 0){ //ç¬¬ä¸€æ¬¡æ‰¾åˆ°çš„å¿…ä¸ºç´ å› å­ n /=i ; res = res - res/i; //x(1-1/p1) while(n % i ==0) n/=i; //å°†è¯¥ç´ å› å­çš„å€æ•°ä¹Ÿå…¨éƒ¨ç­›æ‰ } if (n \u003e 1) res = res - res/n; return res; } ä»¥ä¸Šè½¬è½½æ³¨æ˜ //ç´ æ•°ç­›é€‰æ³•ï¼Œå…ˆç´ æ•°ç­›é€‰ï¼Œå†æ±‚æ¬§æ‹‰ /* ç‰¹æ€§ : 1. è‹¥ a ä¸ºè´¨æ•°ï¼Œphi[a]=a-1; 2. è‹¥ a ä¸ºè´¨æ•°ï¼Œb mod a=0,phi[a*b]=phi[b]*a 3. è‹¥ a,b äº’è´¨ï¼Œphi[a*b]=phi[a]*phi[b](å½“ a ä¸ºè´¨æ•°æ—¶ï¼Œif b mod a!=0 ,phi[a*b]=phi[a]*phi[b]) */ int m[n],phi[n],p[n],nump; //m[i] æ ‡è®° i æ˜¯å¦ä¸ºç´ æ•°ï¼Œ0 ä¸ºç´ æ•°ï¼Œ1 ä¸ä¸ºç´ æ•°ï¼›p æ˜¯å­˜æ”¾ç´ æ•°çš„æ•°ç»„ï¼›nump æ˜¯å½“å‰ç´ æ•°ä¸ªæ•°ï¼›phi[i] ä¸ºæ¬§æ‹‰å‡½æ•° int make() { phi[1]=1; for (int i=2;i\u003c=n;i++) { if (!m[i])//i ä¸ºç´ æ•°ï¼Œm[] åˆå§‹åŒ–ä¸º 0 { p[++nump]=i;//å°† i åŠ å…¥ç´ æ•°æ•°ç»„ p ä¸­ phi[i]=i-1;//å› ä¸º i æ˜¯ç´ æ•°ï¼Œç”±ç‰¹æ€§å¾—çŸ¥ } for (int j=1;j\u003c=nump\u0026\u0026p[j]*i\u003cn;j++) //ç”¨å½“å‰å·²çš„åˆ°çš„ç´ æ•°æ•°ç»„ p ç­›ï¼Œç­›å» p[j]*i { m[p[j]*i]=1;//å¯ä»¥ç¡®å®š i*p[j] ä¸æ˜¯ç´ æ•° if (i%p[j]==0) //çœ‹ p[j] æ˜¯å¦æ˜¯ i çš„çº¦æ•°ï¼Œå› ä¸ºç´ æ•° p[j], ç­‰äºåˆ¤æ–­ i å’Œ p[j] æ˜¯å¦äº’è´¨ { phi[p[j]*i]=phi[i]*p[j]; //ç‰¹æ€§ 2 break; } else phi[p[j]*i]=phi[i]*(p[j]-1); //äº’è´¨ï¼Œç‰¹æ€§ 3,p[j]-1 å°±æ˜¯ phi[p[j]] } } } é™„ç´ æ•°æ‰“è¡¨ int p[N]={1,1,0}; void prime(){ for(int i=2;i\u003cN;i++) if(!p[i]){ for(int j=2*i;j\u003c=N;j+=i)//ç­›æ‰ i çš„å€æ•° p[j]=1; } } ","date":"2018-08-08","objectID":"/posts/euler/:0:4","tags":["æ•°å­¦","æ•°è®º","euler","C"],"title":"æ¬§æ‹‰å‡½æ•°","uri":"/posts/euler/"},{"categories":["ACM"],"content":"ä¾‹é¢˜ Bi-shoe and Phi-shoe LightOJ - 1370 é¢˜æ„ï¼š ç»™ä¸€äº›æ•° Aiï¼ˆç¬¬ i ä¸ªæ•°ï¼‰ï¼ŒAi è¿™äº›æ•°ä»£è¡¨çš„æ˜¯æŸä¸ªæ•°æ¬§æ‹‰å‡½æ•°çš„å€¼ï¼Œæˆ‘ä»¬è¦æ±‚å‡ºæ•° Ni çš„æ¬§æ‹‰å‡½æ•°å€¼ä¸å°äº Aiã€‚è€Œæˆ‘ä»¬è¦æ±‚çš„å°±æ˜¯è¿™äº› Ni è¿™äº›æ•°å­—çš„å’Œ sumï¼Œè€Œä¸”æˆ‘ä»¬æƒ³è¦ sum æœ€å°ï¼Œæ±‚å‡º sum æœ€å°å¤šå°‘ã€‚ è§£é¢˜æ€è·¯ï¼š è¦æ±‚å’Œæœ€å°ï¼Œæˆ‘ä»¬å¯ä»¥è®©æ¯ä¸ªæ•°éƒ½å°½é‡å°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€åå¾—åˆ°çš„è‚¯å®šå°±æ˜¯ä¸€ä¸ªæœ€å°å€¼ã€‚ ç»™å®šä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°å€¼ Ïˆ(N)ï¼Œæˆ‘ä»¬æ€ä¹ˆæ ·æ‰èƒ½æ±‚å¾—æœ€å°çš„ N? æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªç´ æ•° P çš„æ¬§æ‹‰å‡½æ•°å€¼ Ïˆ(P)=P-1ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬çŸ¥é“ Ïˆ(N)ï¼Œé‚£ä¹ˆæœ€å°çš„ N å°±æ˜¯æœ€æ¥è¿‘ Ïˆ(N)ï¼Œå¹¶ä¸”å¤§äº Ïˆ(N) çš„ç´ æ•°ã€‚æˆ‘ä»¬æŠŠæ‰€æœ‰ç´ æ•°æ‰“è¡¨ä¹‹åå†åˆ¤æ–­å°±å¯ä»¥äº†ã€‚ è¿™ä¸ª lightoj æœ‰æ¯’ï¼Œä»€ä¹ˆå¤´æ–‡ä»¶éƒ½ä¸æ”¯æŒï¼Œå¡äº†æˆ‘å¥½ä¹…ã€‚ #include\u003cstdio.h\u003e #define N 1000005 #define ll long long int m[N]={1,1,0}; int p[100000],cnt=0; int max(int x,int y){ return x\u003ey?x:y; } void prime(){ for(int i=2;i\u003cN;i++) if(!m[i]){ for(int j=2*i;j\u003c=N;j+=i) m[j]=1; p[cnt++]=i; } } int binary_search(int x){//äºŒåˆ†æŸ¥æ‰¾ int l=0,r=cnt; while(l\u003c=r){ int mid=(l+r)/2; if(p[mid]\u003ex) r=mid-1; else l=mid+1; } for(int i=max(r,0);;i++) if(p[i]\u003ex) return p[i]; } int main(){ prime(); int T,n,cas=1,temp; scanf(\"%d\",\u0026T); while(T--){ scanf(\"%d\",\u0026n); ll sum=0; for(int i=0;i\u003cn;i++){ scanf(\"%d\",\u0026temp); sum+=binary_search(temp); } printf(\"Case %d: %lld Xukha\\n\",cas++,sum); } return 0; } ","date":"2018-08-08","objectID":"/posts/euler/:0:5","tags":["æ•°å­¦","æ•°è®º","euler","C"],"title":"æ¬§æ‹‰å‡½æ•°","uri":"/posts/euler/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥](http://poj.org/problem?id=1797) å¤§æ„ï¼š è¦ä»åŸå¸‚ 1 åˆ°åŸå¸‚ N è¿é€è´§ç‰©ï¼Œæœ‰ M æ¡é“è·¯ï¼Œæ¯æ¡é“è·¯éƒ½æœ‰å®ƒçš„æœ€å¤§è½½é‡é‡ï¼Œé—®ä»åŸå¸‚ 1 åˆ°åŸå¸‚ N è¿é€æœ€å¤šçš„é‡é‡æ˜¯å¤šå°‘ã€‚ å…¶å®é¢˜æ„å¾ˆç®€å•ï¼Œå°±æ˜¯æ‰¾ä¸€æ¡ 1â€“\u003eN çš„è·¯å¾„ï¼Œåœ¨ä¸è¶…è¿‡æ¯æ¡è·¯å¾„çš„æœ€å¤§è½½é‡é‡çš„æƒ…å†µä¸‹ï¼Œä½¿å¾—è¿é€çš„è´§ç‰©æœ€å¤šã€‚ä¸€æ¡è·¯å¾„ä¸Šçš„æœ€å¤§è½½é‡é‡ä¸ºè¿™ä¸ªè·¯å¾„ä¸Šæƒå€¼æœ€å°çš„è¾¹ï¼› //dijkstra #include\u003ciostream\u003e #include\u003ccstdio\u003e #define min(a,b) (a\u003cb?a:b) using namespace std; int n,m,v[1010],maps[1010][1010],d[1010];//æ­¤æ—¶ d è¡¨ç¤º 1 åˆ°æ¯ä¸€ä¸ªç‚¹çš„èƒ½é€šè¿‡çš„æœ€å¤§çš„é‡é‡ int dijkstra(){ int i,j,k; for(i=1;i\u003c=n;i++){ v[i]=0; d[i]=maps[1][i];//è¿™ä¸ªæ—¶å€™ d ä¸ä»£è¡¨æœ€çŸ­è·¯å¾„ï¼Œè€Œæ˜¯ä» 1 åˆ° n çš„æœ€å¤§æ‰¿è½½é‡ } for(i=1;i\u003c=n;i++){//n ä¸ªç‚¹ int f=-1; for(j=1;j\u003c=n;j++) if(!v[j]\u0026\u0026d[j]\u003ef){ f=d[j]; k=j; } v[k]=1; for(j=1;j\u003c=n;j++) if(!v[j]\u0026\u0026d[j]\u003cmin(d[k],maps[k][j]))//æ›´æ–°è¯´æ˜è§å›¾è§£ d[j]=min(d[k],maps[k][j]); } return d[n]; } int main(){ int ans=1; int a,b,w; int T; scanf(\"%d\",\u0026T); while(T--){ for(int i=0;i\u003c=n;i++) for(int j=0;j\u003c=n;j++) maps[i][j]=0; scanf(\"%d%d\",\u0026n,\u0026m); for(int i=1;i\u003c=m;i++){ scanf(\"%d%d%d\",\u0026a,\u0026b,\u0026w); maps[a][b]=maps[b][a]=w; } printf(\"Scenario #%d:\\n%d\\n\\n\",ans++,dijkstra()); } return 0; } ","date":"2018-08-06","objectID":"/posts/poj1797/:0:0","tags":["ACM","POJ","æœ€çŸ­è·¯","C++"],"title":"Heavy Transportation-poj1797(dijkstra æˆ–æœ€å¤§ç”Ÿæˆæ ‘ï¼‰","uri":"/posts/poj1797/"},{"categories":["JavaScript"],"content":"çœ‹åˆ°çŸ¥ä¹ï¼Œç™¾åº¦çš„é¡µé¢ F12 æ£€æŸ¥åéƒ½ä¼šæœ‰ä¸€äº›æœ‰è¶£çš„æ‹›è˜ä¿¡æ¯ã€‚äºæ˜¯ä¹æˆ‘ä¹Ÿæƒ³ç»™æˆ‘çš„åšå®¢åŠ ä¸€ä¸ªã€‚ æˆ‘ä¸»è¦ç”¨åˆ°çš„å·¥å…·ï¼š console.log() Notepad++ åœ¨çº¿å›¾ç‰‡è½¬æ–‡å­—å·¥å…· ","date":"2018-08-04","objectID":"/posts/console-log/:0:0","tags":["hexo","JavaScript"],"title":"hexo åšå®¢è‡ªå®šä¹‰ console log","uri":"/posts/console-log/"},{"categories":["JavaScript"],"content":"ç”¨æ³• ç”¨ js åœ¨\u003cbody\u003e\u003c/body\u003eä½¿ç”¨ console.log() å°±è¡Œäº†ï¼Œhexo çš„ä¸»é¢˜æ–‡ä»¶åœ¨_layout.swigé‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œåœ¨è¯¥ä½ç½®ï¼Œæ·»åŠ  js å°±è¡Œäº†ï¼› ","date":"2018-08-04","objectID":"/posts/console-log/:1:0","tags":["hexo","JavaScript"],"title":"hexo åšå®¢è‡ªå®šä¹‰ console log","uri":"/posts/console-log/"},{"categories":["JavaScript"],"content":"å›¾æ¡ˆ æˆ‘ç”¨çš„æˆ‘è‡ªå·±çš„ä¸€å¼ ç…§ç‰‡ï¼ˆç”µè„‘ä¸Šç…§ç‰‡å°±é‚£ä¹ˆå‡ å¼ ã€‚)ï¼Œç„¶åç”¨ åœ¨çº¿å›¾ç‰‡è½¬æ–‡å­—å·¥å…· è½¬å­—ç¬¦ï¼Œ é€‰æ‹©æ–‡ä»¶ï¼Œè®¾ç½®å¤§å°ï¼Œç„¶åç”Ÿæˆï¼Œ ç”Ÿæˆåï¼Œå¤åˆ¶ TXT æ–‡ä»¶ï¼ˆä¸‹é¢é‚£ä¸ªæ¡†ï¼Œä¸Šé¢çš„æ˜¯ HTML ä»£ç ï¼‰ ç²˜è´´åˆ° Notepad++ é‡Œé¢ï¼Œç„¶åæŒ‰å›¾æ“ä½œï¼› Ctrl+H æ›¿æ¢ æœ€åå°±å˜æˆä¸€ä¸ªå­—ç¬¦ä¸²äº†ã€‚ ","date":"2018-08-04","objectID":"/posts/console-log/:2:0","tags":["hexo","JavaScript"],"title":"hexo åšå®¢è‡ªå®šä¹‰ console log","uri":"/posts/console-log/"},{"categories":["JavaScript"],"content":"æ•ˆæœå›¾ çº¿ä¸Š demo, æŒ‰ F12 æ‰¾åˆ° console ","date":"2018-08-04","objectID":"/posts/console-log/:3:0","tags":["hexo","JavaScript"],"title":"hexo åšå®¢è‡ªå®šä¹‰ console log","uri":"/posts/console-log/"},{"categories":["JavaScript"],"content":"æˆ‘çš„ txt \\n` @@#``@@@@@@@@@@@@@@@@@@##,` \\n` @@#`;@@@@@@@@@@@@@@@@@@@':' \\n` @@#`@@@@@@@@@@@@@@@@@@@#+#;` \\n` @@#`@@@@@@@@@@@@@@@@@@###@'. \\n` @@+.@@@@@@@@@@@@@@@@@@@@@##, \\n` @@#,@@@@@@@@@@@@@@@@@@@@@@#, \\n` #@#:@@@@@@@@@@@@@@@@@@@@@@@, \\n` #@#'@@@@@@@@@@@@@@@@@@@@@@@. \\n` +@#;@@@@@@@@@@@@@@@@@@@@@@# \\n` `;: ;@#'@@@@@@@@@@@@@@@@@@+'+@' \\n` `,,;';'+';'@@+:@@@@@@@@@@@@##@#',.:#; \\n,, `` ``..,:;@@#'@@@@@@@@#####@@@@#:`:. \\n` `````:++@@@@@@@@@@@@@###@@@@#+,.. \\n ``````.#@@@@@@@@@@@@@@#@@@#++#'`` \\n` ```.,,:,.`:@@@@@@@@@@@@@###@@@##'.` \\n``..`````..,::;+@@@@@@@@@@@@#+`::+##'`. \\n` ````.```,@@@@@@@@@@@##;``.,';` ` \\n``.;@@@@@@@@@@@@@@@@@@@@@@###;``..`````` \\n#@@@@@@@@@@@@@@@@@@@@@@@@##@#;``,``,.`` \\n@@@@@@@@@@@@@@@@@@@.`````..``.. +` `:` \\n@+''++#####@@#`.@@@``````` ` `,``` `` \\n';;;;'+##+'+.`;+@@@,..```` `` :,. \\n;::,,:;+#++``,,#@@@'..``````` ,`.`` \\n;,,,,...'#.,,..#@@@#,,.`````` .```` \\n:,,,,....`,::;''+#@#;,..`````````.`` \\n:,,,.....'##++''';:+':,.`..,,...` \\n:,,,...#####+'+#@@@'.';+:. ` `` \\n;,,.`'####'#,`.`+@@@+'``` `.` \\n;,.`#@@@#+:'+++##+@##@,,,,` \\n',.#@@###'''';:,.```,+#. \\n+,#@@@####;,,..``````````````` `.:,::\\n+@@@@###+;,,..`````````````````` `.,\\n#@@@##+',,,........`````````````` \\n@@@@#+:,,,,`........`````````` \\n@@@#+:,,,,.`````.....`````````` `` \\n@@##':,......`````....``` ````` ```\\n@@@#':,....,..``````..```` ``` ```\\n@@@#',....,,,..``````````` ``` ..\\n@@@#,.....,,,,.`` ```````` `````` \\n@@@+....,,,,,..````````````` `````````` \\n@@@:....,,,,.LiRuihao```````` ```````````` \\n#@@,....,,,,.Always Be Yourself !````````````\\n,##,,...,::,.````````````..`````` `......``\\n,'#,,..,,:::.`````````........`````` `.,,..\\n\\n ä½ å¥½ï¼\\n æ¬¢è¿è¿›å…¥ä»€ä¹ˆéƒ½ä¸ä¼šçš„æç‘è±ªçš„ä¸ªäººç½‘ç«™ï¼\\nhttps://lruihao.cn\\nhttps://www.lruihao.cn\\nhttps://lruihao.github.io\\nhttps://liruihao.coding.me\\n\\n\\n\\n å…¶ä»–ä¸ªäººç½‘ç«™ï¼Œä¸ªäººåšå®¢ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ ","date":"2018-08-04","objectID":"/posts/console-log/:4:0","tags":["hexo","JavaScript"],"title":"hexo åšå®¢è‡ªå®šä¹‰ console log","uri":"/posts/console-log/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ é¢˜ç›®å¤§æ„ï¼š è¯´çš„æ˜¯ï¼Œä¸€åªå¥¶ç‰›ä½äº N å·èŠ‚ç‚¹ï¼Œè¾“å…¥ N ä¸ªèŠ‚ç‚¹å’Œ T å¯¹åŒå‘çš„è¾¹ï¼Œæ±‚å‡ºç”± N åˆ° 1 çš„æœ€çŸ­çš„è·ç¦»ï¼Œå…¶å®å°±æ˜¯é—®çš„å•æºæœ€çŸ­è·¯é—®é¢˜ã€‚ ä¸¤ä¸ªç‚¹å¯èƒ½æœ‰å¤šæ¡è·¯ï¼Œé€‰æ‹©æœ€çŸ­çš„ã€‚ #include\u003cstdio.h\u003e #include\u003cstring.h\u003e #include\u003calgorithm\u003e using namespace std; const int INF=99999999; //è®¾ä¸ºæ— ç©·å¤§ int maps[1005][1005],v[1005],d[1005]; //v è¡¨ç¤ºæ˜¯å¦å·²ç»è¿‡éå† d è¡¨ç¤ºä»æºåˆ°ç‚¹å½“å‰æœ€çŸ­è·¯ int n; void Dijkstra(int s,int t) { int i,j,k,mini; for(i=1;i\u003c=n;i++) d[i]=INF; //é™¤æºç‚¹è®¾ä¸º 0 è·ç¦»å¤– å…¶ä»–å…ˆè®¾ä¸ºæ— ç©·å¤§ d[s]=0; for(i=1;i\u003c=n;i++) //n ç‚¹å¾ªç¯ n æ¬¡ , æ‰¾å‡º n ä¸ª k, æ‰¾ n ä¸ªç‚¹ { mini=INF; k=-1; for(j=1;j\u003c=n;j++) //åœ¨æ‰€æœ‰æœªæ ‡è®°ç‚¹ä¸­ é€‰ d å€¼æœ€å°çš„ç‚¹ if(!v[j] \u0026\u0026 d[j]\u003cmini) mini=d[k=j]; v[k]=1; //æ ‡è®°èŠ‚ç‚¹ if(k==t) { printf(\"%d\\n\",d[t]); return; } for(j=1;j\u003c=n;j++) if(!v[j] \u0026\u0026 (d[k]+maps[k][j])\u003cd[j]) //è¡¨ç¤ºä» k å‡ºå‘çš„ç‚¹ï¼Œå¯¹äºæ‰€æœ‰è¾¹ï¼Œæ›´æ–°ç›¸è¿ç‚¹ d[j]=d[k]+maps[k][j]; } } int main() { int T,i,j,x,y,D; while(scanf(\"%d %d\",\u0026T,\u0026n)!=EOF) { memset(v,0,sizeof(v)); //æ¸…é™¤æ ‡è®° for(i=1;i\u003c=n;i++) for(j=1;j\u003c=n;j++) maps[i][j]=INF; for(i=1;i\u003c=T;i++){ scanf(\"%d%d%d\",\u0026x,\u0026y,\u0026D); if(maps[x][y]\u003eD) //å¯èƒ½æœ‰å¤šæ¡è·¯ï¼Œåªè®°å½•æœ€çŸ­çš„ maps[x][y]=D,maps[y][x]=D; } Dijkstra(1,n); } return 0; } ","date":"2018-08-03","objectID":"/posts/poj2387/:0:0","tags":["ACM","æœ€çŸ­è·¯","C++","C"],"title":"Til the Cows Come Home-poj2387(dijkstra åˆ¤æ–­é‡è¾¹ï¼‰","uri":"/posts/poj2387/"},{"categories":["ACM"],"content":"Dijkstra ç®—æ³• ","date":"2018-08-03","objectID":"/posts/zuiduanlu/:1:0","tags":["æœ€çŸ­è·¯","ACM"],"title":"æœ€çŸ­è·¯å…¥é—¨","uri":"/posts/zuiduanlu/"},{"categories":["ACM"],"content":"1. å®šä¹‰æ¦‚è§ˆ Dijkstraï¼ˆè¿ªæ°æ–¯ç‰¹æ‹‰ï¼‰ç®—æ³•æ˜¯å…¸å‹çš„å•æºæœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œç”¨äºè®¡ç®—ä¸€ä¸ªèŠ‚ç‚¹åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚ä¸»è¦ç‰¹ç‚¹æ˜¯ä»¥èµ·å§‹ç‚¹ä¸ºä¸­å¿ƒå‘å¤–å±‚å±‚æ‰©å±•ï¼Œç›´åˆ°æ‰©å±•åˆ°ç»ˆç‚¹ä¸ºæ­¢ã€‚Dijkstra ç®—æ³•æ˜¯å¾ˆæœ‰ä»£è¡¨æ€§çš„æœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œåœ¨å¾ˆå¤šä¸“ä¸šè¯¾ç¨‹ä¸­éƒ½ä½œä¸ºåŸºæœ¬å†…å®¹æœ‰è¯¦ç»†çš„ä»‹ç»ï¼Œå¦‚æ•°æ®ç»“æ„ï¼Œå›¾è®ºï¼Œè¿ç­¹å­¦ç­‰ç­‰ã€‚æ³¨æ„è¯¥ç®—æ³•è¦æ±‚å›¾ä¸­ä¸å­˜åœ¨è´Ÿæƒè¾¹ã€‚ é—®é¢˜æè¿°ï¼šåœ¨æ— å‘å›¾ G=(V,E) ä¸­ï¼Œå‡è®¾æ¯æ¡è¾¹ E[i] çš„é•¿åº¦ä¸º w[i]ï¼Œæ‰¾åˆ°ç”±é¡¶ç‚¹ V0 åˆ°å…¶ä½™å„ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚ï¼ˆå•æºæœ€çŸ­è·¯å¾„ï¼‰ ","date":"2018-08-03","objectID":"/posts/zuiduanlu/:1:1","tags":["æœ€çŸ­è·¯","ACM"],"title":"æœ€çŸ­è·¯å…¥é—¨","uri":"/posts/zuiduanlu/"},{"categories":["ACM"],"content":"2. ç®—æ³•æè¿° 1) ç®—æ³•æ€æƒ³ï¼š è®¾ G=(V,E) æ˜¯ä¸€ä¸ªå¸¦æƒæœ‰å‘å›¾ï¼ŒæŠŠå›¾ä¸­é¡¶ç‚¹é›†åˆ V åˆ†æˆä¸¤ç»„ï¼Œç¬¬ä¸€ç»„ä¸ºå·²æ±‚å‡ºæœ€çŸ­è·¯å¾„çš„é¡¶ç‚¹é›†åˆï¼ˆç”¨ S è¡¨ç¤ºï¼Œåˆå§‹æ—¶ S ä¸­åªæœ‰ä¸€ä¸ªæºç‚¹ï¼Œä»¥åæ¯æ±‚å¾—ä¸€æ¡æœ€çŸ­è·¯å¾„ , å°±å°†åŠ å…¥åˆ°é›†åˆ S ä¸­ï¼Œç›´åˆ°å…¨éƒ¨é¡¶ç‚¹éƒ½åŠ å…¥åˆ° S ä¸­ï¼Œç®—æ³•å°±ç»“æŸäº†ï¼‰ï¼Œç¬¬äºŒç»„ä¸ºå…¶ä½™æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„é¡¶ç‚¹é›†åˆï¼ˆç”¨ U è¡¨ç¤ºï¼‰ï¼ŒæŒ‰æœ€çŸ­è·¯å¾„é•¿åº¦çš„é€’å¢æ¬¡åºä¾æ¬¡æŠŠç¬¬äºŒç»„çš„é¡¶ç‚¹åŠ å…¥ S ä¸­ã€‚åœ¨åŠ å…¥çš„è¿‡ç¨‹ä¸­ï¼Œæ€»ä¿æŒä»æºç‚¹ v åˆ° S ä¸­å„é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ä¸å¤§äºä»æºç‚¹ v åˆ° U ä¸­ä»»ä½•é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªé¡¶ç‚¹å¯¹åº”ä¸€ä¸ªè·ç¦»ï¼ŒS ä¸­çš„é¡¶ç‚¹çš„è·ç¦»å°±æ˜¯ä» v åˆ°æ­¤é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ï¼ŒU ä¸­çš„é¡¶ç‚¹çš„è·ç¦»ï¼Œæ˜¯ä» v åˆ°æ­¤é¡¶ç‚¹åªåŒ…æ‹¬ S ä¸­çš„é¡¶ç‚¹ä¸ºä¸­é—´é¡¶ç‚¹çš„å½“å‰æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚ 2) ç®—æ³•æ­¥éª¤ï¼š a. åˆå§‹æ—¶ï¼ŒS åªåŒ…å«æºç‚¹ï¼Œå³ S ï¼{v}ï¼Œv çš„è·ç¦»ä¸º 0ã€‚U åŒ…å«é™¤ v å¤–çš„å…¶ä»–é¡¶ç‚¹ï¼Œå³ï¼šU={å…¶ä½™é¡¶ç‚¹}ï¼Œè‹¥ v ä¸ U ä¸­é¡¶ç‚¹ u æœ‰è¾¹ï¼Œåˆ™\u003cu,v\u003eæ­£å¸¸æœ‰æƒå€¼ï¼Œè‹¥ u ä¸æ˜¯ v çš„å‡ºè¾¹é‚»æ¥ç‚¹ï¼Œåˆ™\u003cu,v\u003eæƒå€¼ä¸º âˆã€‚ b. ä» U ä¸­é€‰å–ä¸€ä¸ªè·ç¦» v æœ€å°çš„é¡¶ç‚¹ kï¼ŒæŠŠ kï¼ŒåŠ å…¥ S ä¸­ï¼ˆè¯¥é€‰å®šçš„è·ç¦»å°±æ˜¯ v åˆ° k çš„æœ€çŸ­è·¯å¾„é•¿åº¦ï¼‰ã€‚ c. ä»¥ k ä¸ºæ–°è€ƒè™‘çš„ä¸­é—´ç‚¹ï¼Œä¿®æ”¹ U ä¸­å„é¡¶ç‚¹çš„è·ç¦»ï¼›è‹¥ä»æºç‚¹ v åˆ°é¡¶ç‚¹ u çš„è·ç¦»ï¼ˆç»è¿‡é¡¶ç‚¹ kï¼‰æ¯”åŸæ¥è·ç¦»ï¼ˆä¸ç»è¿‡é¡¶ç‚¹ kï¼‰çŸ­ï¼Œåˆ™ä¿®æ”¹é¡¶ç‚¹ u çš„è·ç¦»å€¼ï¼Œä¿®æ”¹åçš„è·ç¦»å€¼çš„é¡¶ç‚¹ k çš„è·ç¦»åŠ ä¸Šè¾¹ä¸Šçš„æƒã€‚ d. é‡å¤æ­¥éª¤ b å’Œ c ç›´åˆ°æ‰€æœ‰é¡¶ç‚¹éƒ½åŒ…å«åœ¨ S ä¸­ã€‚ æ‰§è¡ŒåŠ¨ç”»è¿‡ç¨‹å¦‚ä¸‹å›¾ ","date":"2018-08-03","objectID":"/posts/zuiduanlu/:1:2","tags":["æœ€çŸ­è·¯","ACM"],"title":"æœ€çŸ­è·¯å…¥é—¨","uri":"/posts/zuiduanlu/"},{"categories":["ACM"],"content":"spfa ç®—æ³• spfa æ˜¯ä¸€ç§æ±‚å•æºæœ€çŸ­è·¯çš„ç®—æ³• ç®—æ³•ä¸­éœ€è¦ç”¨åˆ°çš„ä¸»è¦å˜é‡ int n; //è¡¨ç¤º n ä¸ªç‚¹ï¼Œä» 1 åˆ° n æ ‡å· int s,t; //s ä¸ºæºç‚¹ï¼Œt ä¸ºç»ˆç‚¹ int d[N]; //d[i] è¡¨ç¤ºæºç‚¹ s åˆ°ç‚¹ i çš„æœ€çŸ­è·¯ int p[N]; //è®°å½•è·¯å¾„ï¼ˆæˆ–è€…è¯´è®°å½•å‰é©±ï¼‰ queue q; //ä¸€ä¸ªé˜Ÿåˆ—ï¼Œç”¨ STL å®ç°ï¼Œå½“ç„¶å¯æœ‰æ‰‹æ‰“é˜Ÿåˆ—ï¼Œæ— æ‰€è°“ bool vis[N]; //vis[i]=1 è¡¨ç¤ºç‚¹ i åœ¨é˜Ÿåˆ—ä¸­ vis[i]=0 è¡¨ç¤ºä¸åœ¨é˜Ÿåˆ—ä¸­ ","date":"2018-08-03","objectID":"/posts/zuiduanlu/:2:0","tags":["æœ€çŸ­è·¯","ACM"],"title":"æœ€çŸ­è·¯å…¥é—¨","uri":"/posts/zuiduanlu/"},{"categories":["ACM"],"content":"å‡ ä¹æ‰€æœ‰çš„æœ€çŸ­è·¯ç®—æ³•å…¶æ­¥éª¤éƒ½å¯ä»¥åˆ†ä¸ºä¸¤æ­¥ åˆå§‹åŒ– æ¾å¼›æ“ä½œ ","date":"2018-08-03","objectID":"/posts/zuiduanlu/:3:0","tags":["æœ€çŸ­è·¯","ACM"],"title":"æœ€çŸ­è·¯å…¥é—¨","uri":"/posts/zuiduanlu/"},{"categories":["ACM"],"content":"åˆå§‹åŒ–ï¼š d æ•°ç»„å…¨éƒ¨èµ‹å€¼ä¸º INFï¼ˆæ— ç©·å¤§ï¼‰ï¼›p æ•°ç»„å…¨éƒ¨èµ‹å€¼ä¸º sï¼ˆå³æºç‚¹ï¼‰ï¼Œæˆ–è€…èµ‹å€¼ä¸º-1ï¼Œè¡¨ç¤ºè¿˜æ²¡æœ‰çŸ¥é“å‰é©±ï¼Œç„¶å d[s]=0; è¡¨ç¤ºæºç‚¹ä¸ç”¨æ±‚æœ€çŸ­è·¯å¾„ï¼Œæˆ–è€…è¯´æœ€çŸ­è·¯å°±æ˜¯ 0ã€‚å°†æºç‚¹å…¥é˜Ÿï¼› ï¼ˆå¦å¤–è®°ä½åœ¨æ•´ä¸ªç®—æ³•ä¸­æœ‰é¡¶ç‚¹å…¥é˜Ÿäº†è¦è®°å¾—æ ‡è®° vis æ•°ç»„ï¼Œæœ‰é¡¶ç‚¹å‡ºé˜Ÿäº†è®°å¾—æ¶ˆé™¤é‚£ä¸ªæ ‡è®°ï¼‰ ","date":"2018-08-03","objectID":"/posts/zuiduanlu/:3:1","tags":["æœ€çŸ­è·¯","ACM"],"title":"æœ€çŸ­è·¯å…¥é—¨","uri":"/posts/zuiduanlu/"},{"categories":["ACM"],"content":"é˜Ÿåˆ—+æ¾å¼›æ“ä½œ è¯»å–é˜Ÿå¤´é¡¶ç‚¹ uï¼Œå¹¶å°†é˜Ÿå¤´é¡¶ç‚¹ u å‡ºé˜Ÿï¼ˆè®°å¾—æ¶ˆé™¤æ ‡è®°ï¼‰ï¼›å°†ä¸ç‚¹ u ç›¸è¿çš„æ‰€æœ‰ç‚¹ v è¿›è¡Œæ¾å¼›æ“ä½œï¼Œå¦‚æœèƒ½æ›´æ–°ä¼°è®¡å€¼ï¼ˆå³ä»¤ d[v] å˜å°ï¼‰ï¼Œé‚£ä¹ˆå°±æ›´æ–°ï¼Œå¦å¤–ï¼Œå¦‚æœç‚¹ v æ²¡æœ‰åœ¨é˜Ÿåˆ—ä¸­ï¼Œé‚£ä¹ˆè¦å°†ç‚¹ v å…¥é˜Ÿï¼ˆè®°å¾—æ ‡è®°ï¼‰ï¼Œå¦‚æœå·²ç»åœ¨é˜Ÿåˆ—ä¸­äº†ï¼Œé‚£ä¹ˆå°±ä¸ç”¨å…¥é˜Ÿ ä»¥æ­¤å¾ªç¯ï¼Œç›´åˆ°é˜Ÿç©ºä¸ºæ­¢å°±å®Œæˆäº†å•æºæœ€çŸ­è·¯çš„æ±‚è§£ ","date":"2018-08-03","objectID":"/posts/zuiduanlu/:3:2","tags":["æœ€çŸ­è·¯","ACM"],"title":"æœ€çŸ­è·¯å…¥é—¨","uri":"/posts/zuiduanlu/"},{"categories":["ACM"],"content":"SPFA å¯ä»¥å¤„ç†è´Ÿæƒè¾¹ å®šç†ï¼šåªè¦æœ€çŸ­è·¯å¾„å­˜åœ¨ï¼Œä¸Šè¿° SPFA ç®—æ³•å¿…å®šèƒ½æ±‚å‡ºæœ€å°å€¼ã€‚ è¯æ˜ï¼š æ¯æ¬¡å°†ç‚¹æ”¾å…¥é˜Ÿå°¾ï¼Œéƒ½æ˜¯ç»è¿‡æ¾å¼›æ“ä½œè¾¾åˆ°çš„ã€‚æ¢è¨€ä¹‹ï¼Œæ¯æ¬¡çš„ä¼˜åŒ–å°†ä¼šæœ‰æŸä¸ªç‚¹ v çš„æœ€çŸ­è·¯å¾„ä¼°è®¡å€¼ d[v] å˜å°ã€‚æ‰€ä»¥ç®—æ³•çš„æ‰§è¡Œä¼šä½¿ d è¶Šæ¥è¶Šå°ã€‚ç”±äºæˆ‘ä»¬å‡å®šå›¾ä¸­ä¸å­˜åœ¨è´Ÿæƒå›è·¯ï¼Œæ‰€ä»¥æ¯ä¸ªç»“ç‚¹éƒ½æœ‰æœ€çŸ­è·¯å¾„å€¼ã€‚å› æ­¤ï¼Œç®—æ³•ä¸ä¼šæ— é™æ‰§è¡Œä¸‹å»ï¼Œéšç€ d å€¼çš„é€æ¸å˜å°ï¼Œç›´åˆ°åˆ°è¾¾æœ€çŸ­è·¯å¾„å€¼æ—¶ï¼Œç®—æ³•ç»“æŸï¼Œè¿™æ—¶çš„æœ€çŸ­è·¯å¾„ä¼°è®¡å€¼å°±æ˜¯å¯¹åº”ç»“ç‚¹çš„æœ€çŸ­è·¯å¾„å€¼ã€‚ï¼ˆè¯æ¯•ï¼‰ æœŸæœ›çš„æ—¶é—´å¤æ‚åº¦ O(ke)ï¼Œ å…¶ä¸­ k ä¸ºæ‰€æœ‰é¡¶ç‚¹è¿›é˜Ÿçš„å¹³å‡æ¬¡æ•°ï¼Œå¯ä»¥è¯æ˜ k ä¸€èˆ¬å°äºç­‰äº 2ã€‚ åˆ¤æ–­æœ‰æ— è´Ÿç¯ï¼š å¦‚æœæŸä¸ªç‚¹è¿›å…¥é˜Ÿåˆ—çš„æ¬¡æ•°è¶…è¿‡ N æ¬¡åˆ™å­˜åœ¨è´Ÿç¯ï¼ˆSPFA æ— æ³•å¤„ç†å¸¦è´Ÿç¯çš„å›¾ï¼‰ ä»£ç  ","date":"2018-08-03","objectID":"/posts/zuiduanlu/:4:0","tags":["æœ€çŸ­è·¯","ACM"],"title":"æœ€çŸ­è·¯å…¥é—¨","uri":"/posts/zuiduanlu/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ å¯†ç ï¼šl9sn ç»ˆäºä¸çˆ†é›¶äº†ï¼Œä½†æ˜¯è¿˜æ˜¯ wa äº†æ— æ•°æ¬¡ï¼Œæœ‰æ—¶å€™ä»£ç æ„Ÿè§‰éƒ½å·®ä¸å¤š ","date":"2018-08-02","objectID":"/posts/nowcodersummer-5th/:0:0","tags":["Nowcoder","ACM","C++"],"title":"ç‰›å®¢æš‘å‡å¤šæ ¡ç¬¬äº”åœº","uri":"/posts/nowcodersummer-5th/"},{"categories":["ACM"],"content":"G-max /* //wa #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ int n,c;//å¥½åƒä¸ä¼šçˆ† int å§ï¼Œå¤´æ™• cin\u003e\u003ec\u003e\u003en; int t=n/c; if(t\u003c1) cout\u003c\u003c\"-1\\n\";// else if(t==1) cout\u003c\u003cc*c\u003c\u003cendl; else cout\u003c\u003c(t*c)*((t-1)*c)\u003c\u003cendl; return 0; }*/ //AC #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ long long n,c; cin\u003e\u003ec\u003e\u003en; long long t=n/c; if(t\u003c1) cout\u003c\u003c-1\u003c\u003cendl; else if(t==1) cout\u003c\u003cc*c\u003c\u003cendl; else cout\u003c\u003c(t*c)*((t-1)*c)\u003c\u003cendl; return 0; } ","date":"2018-08-02","objectID":"/posts/nowcodersummer-5th/:1:0","tags":["Nowcoder","ACM","C++"],"title":"ç‰›å®¢æš‘å‡å¤šæ ¡ç¬¬äº”åœº","uri":"/posts/nowcodersummer-5th/"},{"categories":["ACM"],"content":"J-plan /*æšä¸¾æ‰€æœ‰æƒ…å†µ å…¨ä¹°åŒäºº n%2 0 or 1//å‰© 1 ä¸ªäººçš„æ—¶å€™ï¼Œå¯ä»¥å¤šå¼€ä¸€é—´æˆ¿æˆ–è€…é€€ä¸€é—´ 2 äººæˆ¿å¼€ä¸€é—´ 3 äººæˆ¿ å…¨ä¹° 3 äºº n%3 0 or 1 or 2 å†æ¯”è¾ƒå¤§å° */ #include\u003cbits/stdc++.h\u003e #define INF 1\u003c\u003c20 using namespace std; typedef long long ll; ll min(ll a,ll b){ return a\u003cb?a:b; } int main(){ ll n,p2,p3,sum,sum1; while(cin\u003e\u003en\u003e\u003ep2\u003e\u003ep3){ if(n%2==0) sum=p2*(n/2); else sum=p2*(n/2)+min(min(p2,p3),p3-p2);//é€€äºŒä¹°ä¸‰ï¼› if(n%3==0) sum1=p3*(n/3); else if(n%3==1) sum1=p3*(n/3)+min(min(p2,p3),2*p2-p3);//é€€ 3 ä¹° 2*2 else if(n%3==2) sum1=p3*(n/3)+min(p3,p2);//é€€ 3 ä¹° 3*2 cout\u003c\u003cmin(sum1,sum)\u003c\u003cendl; } return 0; } ","date":"2018-08-02","objectID":"/posts/nowcodersummer-5th/:2:0","tags":["Nowcoder","ACM","C++"],"title":"ç‰›å®¢æš‘å‡å¤šæ ¡ç¬¬äº”åœº","uri":"/posts/nowcodersummer-5th/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ æ€è·¯å‚è€ƒ 1,æ€è·¯å‚è€ƒ 2ï¼ˆæ²¡çœ‹æ‡‚ï¼‰ å…ˆå å‘ï¼Œæœ‰æ—¶é—´å†ç†ç†æ€è·¯ã€‚ åŒä¸€æ£µæ ‘ä¸­ d=1, å³ x å’Œ y æ˜¯åŒç±»ï¼Œåˆ™éœ€æ»¡è¶³ r[x]==r[y] d=2,x åº”è¯¥åƒäº† y, ä¹Ÿå°±æ˜¯ (r[x]+1)%3 == r[y] ä¸åŒæ ‘åˆå¹¶ä¸”æ›´æ–°å…³ç³» (x æ ‘åšä¸»æ ¹) â€™ å¦‚æœ x å’Œ y ä¸ºå…³ç³» r1, y å’Œ z ä¸ºå…³ç³» r2ï¼Œ é‚£ä¹ˆ x å’Œ z çš„å…³ç³»å°±æ˜¯ï¼ˆr1+r2ï¼‰%3 å¦‚æœ d==1 åˆ™ x å’Œ y æ˜¯åŒç±» ï¼Œé‚£ä¹ˆ y å¯¹ x çš„å…³ç³»æ˜¯ 0, å¦‚æœ d==2 , åˆ™ x åƒäº† y, é‚£ä¹ˆ y å¯¹ x çš„å…³ç³»æ˜¯ 1, x å¯¹ y çš„å…³ç³»æ˜¯ 2ã€‚ç»¼ä¸Šæ‰€è¿° , æ— è®º d ä¸º 1 æˆ–è€…æ˜¯ä¸º 2, y å¯¹ x çš„å…³ç³»éƒ½æ˜¯ d-1ã€‚ fy å¯¹ y çš„å…³ç³»ä¸º 3-r[y] ï¼ˆæœ‰ç‚¹äº’è¡¥çš„æ„Ÿè§‰ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ä¸åŒç±»å–”ï¼‰ y å¯¹ x çš„å…³ç³»ä¸º d-1, x å¯¹ fx çš„å…³ç³»ä¸º r[x] æ‰€ä»¥ fy å¯¹ fx çš„å…³ç³»æ˜¯ï¼ˆ3-r[y] + d-1 + r[x]ï¼‰%3ã€‚å¯ä»¥å€ŸåŠ©å‘é‡å›¾ç†è§£ fy-\u003ey-\u003ex-\u003efx #include\u003ccstdio\u003e const int maxn = 50000+10; int p[maxn]; //å­˜çˆ¶èŠ‚ç‚¹ int r[maxn];//å­˜ä¸çˆ¶èŠ‚ç‚¹çš„å…³ç³» 0 åŒä¸€ç±»ï¼Œ1 è¢«çˆ¶èŠ‚ç‚¹åƒï¼Œ2 åƒçˆ¶èŠ‚ç‚¹ void set(int n) //åˆå§‹åŒ– { for(int x = 1; x \u003c= n; x++) { p[x] = x; //å¼€å§‹è‡ªå·±æ˜¯è‡ªå·±çš„çˆ¶äº²èŠ‚ç‚¹ r[x] = 0;//å¼€å§‹è‡ªå·±å°±æ˜¯è‡ªå·±çš„çˆ¶äº²ï¼Œæ¯ä¸€ä¸ªç‚¹å‡ç‹¬ç«‹ } } int find(int x) //æ‰¾çˆ¶äº²èŠ‚ç‚¹ { if(x == p[x]) return x; int t = p[x]; p[x] = find(p[x]); r[x] = (r[x]+r[t])%3; //å›æº¯ç”±å­èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹çš„å…³ç³»å’Œçˆ¶èŠ‚ç‚¹ä¸æ ¹èŠ‚ç‚¹çš„å…³ç³»æ‰¾å­èŠ‚ç‚¹ä¸æ ¹èŠ‚ç‚¹çš„å…³ç³» return p[x]; } void Union(int x, int y, int d) { int fx = find(x); int fy = find(y); p[fy] = fx; //åˆå¹¶æ ‘ æ³¨æ„ï¼šè¢« x åƒï¼Œæ‰€ä»¥ä»¥ x çš„æ ¹ä¸ºçˆ¶ r[fy] = (r[x]-r[y]+3+(d-1))%3; //å¯¹åº”æ›´æ–°ä¸çˆ¶èŠ‚ç‚¹çš„å…³ç³» } int main() { int n, m; scanf(\"%d%d\", \u0026n, \u0026m); set(n); int ans = 0; int d, x, y; while(m--) { scanf(\"%d%d%d\", \u0026d, \u0026x, \u0026y); if(x \u003e n || y \u003e n || (d == 2 \u0026\u0026 x == y)) ans++; //å¦‚æœèŠ‚ç‚¹ç¼–å·å¤§äºæœ€å¤§ç¼–å·ï¼Œæˆ–è€…è‡ªå·±åƒè‡ªå·±ï¼Œè¯´è° else if(find(x) == find(y)) //å¦‚æœåŸæ¥æœ‰å…³ç³»ï¼Œä¹Ÿå°±æ˜¯åœ¨åŒä¸€æ£µæ ‘ä¸­ï¼Œé‚£ä¹ˆç›´æ¥åˆ¤æ–­æ˜¯å¦è¯´è° { if(d == 1 \u0026\u0026 r[x] != r[y]) ans++; //å¦‚æœ x å’Œ y ä¸å±äºåŒä¸€ç±» if(d == 2 \u0026\u0026 (r[x]+1)%3 != r[y]) ans++; // å¦‚æœ x æ²¡æœ‰åƒ y ï¼ˆæ³¨æ„è¦å¯¹åº” Uinon(x, y) çš„æƒ…å†µï¼Œå¦åˆ™ä¸€è·¯ WA åˆ°æ­»å•Šï¼ï¼ï¼) } else Union(x, y, d); //å¦‚æœå¼€å§‹æ²¡æœ‰å…³ç³»ï¼Œåˆ™å»ºç«‹å…³ç³» } printf(\"%d\\n\", ans); return 0; } ","date":"2018-08-02","objectID":"/posts/poj1182/:0:0","tags":["ACM","å¹¶æŸ¥é›†","POJ","C++","C"],"title":"é£Ÿç‰©é“¾-poj1182ï¼ˆå¸¦æƒå¹¶æŸ¥é›†ç»å…¸æ¨¡æ¿ï¼‰","uri":"/posts/poj1182/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ï¼šå°å¸Œçš„è¿·å®« ","date":"2018-08-01","objectID":"/posts/hdu1272/:1:0","tags":["ACM","å¹¶æŸ¥é›†","HDU","C++","C"],"title":"å°å¸Œçš„è¿·å®«-HDU-1272ï¼ˆå¹¶æŸ¥é›† or æ ‘æ€§è´¨ï¼‰","uri":"/posts/hdu1272/"},{"categories":["ACM"],"content":"å¹¶æŸ¥é›†ï¼š æ— å›è·¯ å•è¿é€š å¹¶æŸ¥é›†åšï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯åˆ¤æ–­ä¸¤ä¸ªç‚¹æ˜¯å¦è¿é€šï¼Œä¸è¿é€šå°±åˆå¹¶ï¼Œå·²è¿é€šçš„è¯è¯´æ˜ä¼šå½¢æˆå›è·¯ï¼Œåˆ™å¯ä»¥åˆ¤å®š Noï¼Œäº¤äº†ä¸€å‘é”™äº†ã€‚ æƒ³äº†ä¸€ä¸‹æ²¡æœ‰è€ƒè™‘åˆ°å¤šä¸ªè¿é€šåŸŸçš„æƒ…å†µï¼Œè¯¥é¢˜å¿…é¡»åªæœ‰ä¸€ä¸ªè¿é€šåŸŸ ","date":"2018-08-01","objectID":"/posts/hdu1272/:2:0","tags":["ACM","å¹¶æŸ¥é›†","HDU","C++","C"],"title":"å°å¸Œçš„è¿·å®«-HDU-1272ï¼ˆå¹¶æŸ¥é›† or æ ‘æ€§è´¨ï¼‰","uri":"/posts/hdu1272/"},{"categories":["ACM"],"content":"æ ‘çš„æ€§è´¨ï¼š æ—¢ç„¶å•è¿é€šæ— å›è·¯ï¼Œåˆ™è¿™è‚¯å®šæ˜¯ä¸€æ£µæ ‘ï¼›é‚£ä¹ˆ edge=v-1; æœ€åæ³¨æ„ç©ºæ ‘çš„æƒ…å†µï¼Œè‡³äºè‡ªç¯æˆ‘è¿™é‡Œ No ä¹Ÿè¿‡äº†ï¼Œæ²¡æœ‰å»éªŒè¯è‡ªç¯ Yes çš„æƒ…å†µäº† //å¹¶æŸ¥é›† #include\u003cbits/stdc++.h\u003e using namespace std; int pre[100001]; int find(int root){ int son,t; son=root; while(root!=pre[root]) root=pre[root]; while(son!=root){ t=pre[son]; pre[son]=root; son=t; } return root; } void join(int a,int b){ int x=find(a),y=find(b); if(x!=y) pre[y]=x; } int main(){ int a,b,flag,i,sum; while(1) { flag = 0; while(~scanf(\"%d%d\",\u0026a,\u0026b) \u0026\u0026 a!=0 \u0026\u0026 b!=0){ if(a==-1 \u0026\u0026 b==-1) return 0; if(pre[a]==0)pre[a]=a; if(pre[b]==0)pre[b]=b; if(find(a)==find(b))flag = 1; else if(flag!=1) join(a,b); } for(sum = 0,i=1;i\u003c100001;i++){ if(pre[i]==i)sum++; pre[i] = 0; } if(sum\u003e1 || flag == 1) printf(\"No\\n\"); else printf(\"Yes\\n\"); } } //1 2 3 4 0 0 No æ²¡æœ‰è¿é€š //0 0 Yes //1 1 0 0 Noï¼ˆè¯¥ä»£ç ï¼‰ //æ ‘æ€§è´¨ #include \u003cstdio.h\u003e bool s[100001]; int main() { int a,b,i,len,num,v; for(i=0;i\u003c100001;++i) s[i]=false; len=0,num=0,v=0; while(1) { scanf(\"%d%d\",\u0026a,\u0026b); if(a==-1\u0026\u0026b==-1) break; if(a==0\u0026\u0026b==0) { if(v==0) { printf(\"Yes\\n\"); continue; } if(num==len-1) //åˆ’é‡ç‚¹ï¼ï¼ printf(\"Yes\\n\"); else printf(\"No\\n\"); num=len=v=0; for(i=0;i\u003c100001;++i) s[i]=false; continue; } v=1; if(s[a]==false) len++;//ç‚¹æ•° if(s[b]==false) len++; s[a]=s[b]=true; num++;//è¾¹æ•° } return 0; ","date":"2018-08-01","objectID":"/posts/hdu1272/:3:0","tags":["ACM","å¹¶æŸ¥é›†","HDU","C++","C"],"title":"å°å¸Œçš„è¿·å®«-HDU-1272ï¼ˆå¹¶æŸ¥é›† or æ ‘æ€§è´¨ï¼‰","uri":"/posts/hdu1272/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ï¼šHow Many Answers Are Wrong æ€è·¯å‚è€ƒï¼šæœ¬é¢˜ç›´æ¥å‚è€ƒ,å›¾æ–‡è§£é‡Š #include\u003cbits/stdc++.h\u003e using namespace std; typedef long long LL; int pre[200010],ranks[200010]; int find(int root){ if(pre[root] != root) { int f = pre[root]; pre[root] = find(pre[root]);//é€’å½’è·¯å¾„å‹ç¼© ranks[root] += ranks[f]; /*ç²¾é«“å‡å¦‚ä¸€å¼€å§‹æ²¡å…³ç³»ï¼Œé‚£ä¹ˆç”¨ rank æ•°ç»„æ¥è¡¨ç¤º aï¼Œb å„è‡ªåˆ°å„è‡ªç¥–å…ˆçš„è·ç¦»ã€‚ é‚£ä¹ˆåœ¨æŠŠ a çš„ç¥–å…ˆç»™ b çš„ç¥–å…ˆå½“çˆ¶äº²ä¹‹åï¼Œé‚£ä¹ˆ b åˆ°ç¥–å…ˆçš„è·ç¦»ä¹Ÿå°±æ˜¯ rank[b] å°±è¦å†åŠ ä¸Š b åŸæœ¬çš„ç¥–å…ˆåˆ° a çš„ç¥–å…ˆçš„è·ç¦»ï¼Œæ›´æ–°ä¸€ä¸‹ï¼Œ å…¶ä¸­ find å‡½æ•°ï¼ˆæ‰¾æ ¹èŠ‚ç‚¹çš„å‡½æ•°ï¼‰é‡Œ rank[x]+=rank[pre[x]]ï¼ˆè¿™é‡Œ pre æ•°ç»„å­˜çš„æ˜¯å¯¹åº”æ•°çš„çˆ¶èŠ‚ç‚¹ï¼‰*/ } return pre[root]; } int main(){ int n,m; while(~scanf(\"%d%d\",\u0026n,\u0026m)){ int ans=0; for(int i=1; i\u003c=n; i++) pre[i]=i; memset(ranks,0,sizeof(ranks)); while(m--){ int a,b,c; scanf(\"%d%d%d\",\u0026a,\u0026b,\u0026c); a--;//[a,b]~~(a--,b] int fa=find(a); int fb=find(b); if(fa!=fb){ pre[fb]=fa;//æ³¨æ„åˆå¹¶é¡ºåºï¼Œåè¿‡æ¥ä¸‹é¢çš„ä¹Ÿè¦æ”¹ ranks[fb]=ranks[a]-ranks[b]+c;//æ›´æ–°è·ç¦» } else { if(ranks[b]-ranks[a]!=c) ans++; } } printf(\"%d\\n\",ans); } return 0; } ","date":"2018-08-01","objectID":"/posts/hdu3038/:0:0","tags":["å¹¶æŸ¥é›†","ACM","HDU","C++"],"title":"How Many Answers Are Wrong-hdu3038ï¼ˆå¸¦æƒå¹¶æŸ¥é›†ï¼‰","uri":"/posts/hdu3038/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ï¼šBear and Finding Criminals å¤§è‡´é¢˜æ„å°±æ˜¯å°ç†Šè­¦å¯Ÿä½åœ¨æŸä¸ªåŸå¸‚ï¼Œä»–è¦æŠ“å„ä¸ªåŸå¸‚çš„ç½ªçŠ¯ï¼Œç°åœ¨ç”¨ä¸€ä¸ª BCD å¯ä»¥çŸ¥é“é‚£ä¸ªåŸå¸‚é‡Œä¸€å®šæœ‰ç½ªçŠ¯ã€‚ ä¸€å®šèƒ½ç¡®å®šè¯¥åŸå¸‚æœ‰å°å·çš„å‡ ç§æƒ…å†µï¼š è­¦å¯Ÿæ‰€ä½åŸå¸‚æœ‰ç½ªçŠ¯ï¼Œåˆ™ä¸€å®šèƒ½æ£€æµ‹åˆ° è­¦å¯Ÿæ‰€ä½åŸå¸‚çš„å·¦è¾¹å’Œå³è¾¹ä½ç½®è‹¥éƒ½ä¸ä¸º 0ï¼Œåˆ™è¯´æ˜ä¸¤åº§åŸå¸‚éƒ½æœ‰ç½ªçŠ¯ï¼ˆåªæœ‰ä¸€è¾¹ä¸º 1 æ˜¯ä¸èƒ½ç¡®å®šåˆ°åº•å“ªä¸ªåŸå¸‚æœ‰ç½ªçŠ¯çš„ï¼‰ è­¦å¯Ÿæ‰€åœ¨åŸå¸‚çš„ä¸€è¾¹æ£€æµ‹åˆ°æœ‰ç½ªçŠ¯ï¼Œä½†åœ¨å¦ä¸€è¾¹å·²ç»æ²¡æœ‰åŸå¸‚äº†ï¼Œåˆ™è¯´æ˜è¯¥åŸå¸‚ä¸€å®šæœ‰ç½ªçŠ¯ #include\u003cbits/stdc++.h\u003e using namespace std; int t[107]; int main() { int n, a; while(cin\u003e\u003en\u003e\u003ea){ int sum = 0; for(int i =1; i \u003c= n; i++) cin \u003e\u003e t[i]; if(t[a]) sum++;//å°ç†Šæ‰€åœ¨åŸå¸‚æœ‰ç½ªçŠ¯ for(int i = 1; i \u003c= n; i++){ if(a-i \u003e 0\u0026\u0026a+i \u003c= n) { if(t[a-i] == 1\u0026\u0026t[a+i] == 1) sum+=2; } else if(a-i \u003c= 0\u0026\u0026a+i \u003c= n){//è­¦å¯Ÿåœ¨ç¬¬ä¸€ä¸ªç‚¹ if(t[a+i]) sum++; } else if(a-i \u003e 0\u0026\u0026a+i \u003e n){ if(t[a-i]) sum++; } } cout \u003c\u003csum\u003c\u003cendl; } return 0; } ","date":"2018-07-31","objectID":"/posts/codeforces680b/:0:0","tags":["Codeforces","ACM","C++"],"title":"Bear and Finding Criminals-Codeforces680B","uri":"/posts/codeforces680b/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ï¼šBear and Five Cards å¤§è‡´é¢˜æ„å°±æ˜¯å°ç†Šæœ‰ 5 å¼ å¡ç‰‡ï¼Œæ¯å¼ å¡ç‰‡æœ‰å¯¹åº”çš„åˆ†æ•°ï¼Œä»–å¯ä»¥é€‰æ‹©ä¸¢å¼ƒ 2 å¼ ç›¸åŒçš„æˆ–è€… 3 å¼ ç›¸åŒçš„å¡ç‰‡ï¼Œæ²¡æœ‰ç›¸åŒçš„å°±æ— æ³•ä¸¢å¼ƒï¼Œé—®å°ç†Šå‰©ä¸‹çš„åˆ†æ•°æœ€å°‘æ˜¯å¤šå°‘ã€‚ æ²¡æœ‰æƒ³å¾—é‚£ä¹ˆå¤æ‚ï¼Œç”±äºåˆ†æ•°æœ€å¤§æ‰ 100ï¼Œæ‰€ä»¥ç›´æ¥æš´åŠ›å°±å¥½äº†ã€‚ #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ int a[5],b[107],i,j,sum=0,sum1=0; for(i=0;i\u003c5;i++){ cin\u003e\u003ea[i]; sum+=a[i]; } sort(a,a+5); memset(b,0,sizeof(b)); for(i=0;i\u003c5;i++) b[a[i]]++; for(i=0;i\u003c107;i++){ if(b[i]==2) sum1=max(2*i,sum1); if(b[i]\u003e=3) {sum1=max(3*i,sum1);/*cout\u003c\u003c3*i\u003c\u003c\" \"\u003c\u003csum1\u003c\u003cendl;*/} } cout\u003c\u003csum-sum1\u003c\u003cendl; return 0; } ","date":"2018-07-31","objectID":"/posts/codeforces680a/:0:0","tags":["Codeforces","ACM","C++"],"title":"Bear and Five Cards-Codeforces680A","uri":"/posts/codeforces680a/"},{"categories":["ACM"],"content":"å¹¶æŸ¥é›†æ±‚è¿é€šåŸŸæ•°ç›®ï¼Œåˆå§‹åŒ– sum=nï¼› é¢˜ç›®é“¾æ¥ï¼š how many tables #include\u003cbits/stdc++.h\u003e using namespace std; int pre[1005]; int find(int root){ int son,t; son=root; while(root!=pre[root]) root=pre[root]; while(son!=root){ t=pre[son]; pre[son]=root; son=t; } return root; } int main(){ int n,m,t,sum,root1,root2; cin\u003e\u003et; while(t--){ cin\u003e\u003en\u003e\u003em; sum=n; for(int i=1;i\u003c=n;i++) pre[i]=i; for(int i=0;i\u003cm;i++){ cin\u003e\u003eroot1\u003e\u003eroot2; int xx=find(root1); int yy=find(root2); if(xx!=yy){ pre[xx]=yy; sum--; } } cout\u003c\u003csum\u003c\u003cendl; } return 0; } ","date":"2018-07-31","objectID":"/posts/how-tables/:0:0","tags":["å¹¶æŸ¥é›†","HDU","C++","ACM"],"title":"how many tables-HDU-1213ï¼ˆå¹¶æŸ¥é›†æ±‚è¿é€šåŸŸæ•°ç›®ï¼‰","uri":"/posts/how-tables/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ï¼šThe-suspects ","date":"2018-07-31","objectID":"/posts/poj-1611/:1:0","tags":["å¹¶æŸ¥é›†","POJ","ACM","C","C++"],"title":"The-suspects-POJ-1611ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-1611/"},{"categories":["ACM"],"content":"ç¿»è¯‘ï¼š è­¦å¯ŸæŠ“è´©æ¯’é›†å›¢ã€‚æœ‰ä¸åŒç±»å‹çš„çŠ¯ç½ªé›†å›¢ï¼Œäººå‘˜å¯èƒ½é‡å¤ï¼Œé›†å›¢å†…çš„äººä¼šç›¸äº’æ¥è§¦ã€‚ç°åœ¨è­¦å¯Ÿåœ¨å…¶ä¸­ä¸€äººï¼ˆ0 å·ï¼‰èº«ä¸Šæœå‡ºæ¯’å“ï¼Œè®¤ä¸ºä¸è¿™ä¸ªäººç›´æ¥æ¥è§¦æˆ–é€šè¿‡å…¶ä»–äººæœ‰é—´æ¥æ¥è§¦çš„äººéƒ½æ˜¯å«Œç–‘çŠ¯ã€‚é—®åŒ…æ‹¬ 0 å·çŠ¯äººå…±æœ‰å¤šå°‘å«Œç–‘çŠ¯ï¼Ÿ ","date":"2018-07-31","objectID":"/posts/poj-1611/:2:0","tags":["å¹¶æŸ¥é›†","POJ","ACM","C","C++"],"title":"The-suspects-POJ-1611ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-1611/"},{"categories":["ACM"],"content":"Input å¤šæ ·ä¾‹è¾“å…¥ã€‚ æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ä»¥ä¸¤ä¸ªæ•´æ•° n å’Œ m å¼€å¤´ï¼Œå…¶ä¸­ n ä¸ºäººæ•°ï¼Œm ä¸ºçŠ¯ç½ªé›†å›¢æ•°ã€‚ä½ å¯ä»¥å‡å®š 0 \u003c n \u003c= 30000 å’Œ 0 \u003c= m \u003c= 500ã€‚åœ¨æ‰€æœ‰çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±ç‹¬ç‰¹çš„æ•´æ•°ç¼–å· 0 åˆ° nâˆ’1, ä¸” 0 å·æ˜¯å…¬è®¤çš„å«Œç–‘çŠ¯ã€‚ æ¥ä¸‹æ¥ m è¡Œè¾“å…¥ï¼Œæ¯ä¸ªçŠ¯ç½ªé›†å›¢ä¸€è¡Œã€‚æ¯ä¸€è¡Œä»ä¸€ä¸ªæ•´æ•° k å¼€å§‹ï¼Œå®ƒæœ¬èº«è¡¨ç¤ºé›†å›¢å†…æˆå‘˜çš„æ•°é‡ã€‚æŒ‰ç…§æˆå‘˜çš„æ•°é‡ï¼Œåœ¨è¿™ä¸ªç»„ä¸­æœ‰ k ä¸ªæ•´æ•°è¡¨ç¤ºäººå‘˜ã€‚ä¸€è¡Œä¸­çš„æ‰€æœ‰æ•´æ•°éƒ½è¢«è‡³å°‘ä¸€ä¸ªç©ºæ ¼éš”å¼€ã€‚ n = 0 ä¸” m = 0 æ—¶è¾“å…¥ç»“æŸã€‚ ","date":"2018-07-31","objectID":"/posts/poj-1611/:2:1","tags":["å¹¶æŸ¥é›†","POJ","ACM","C","C++"],"title":"The-suspects-POJ-1611ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-1611/"},{"categories":["ACM"],"content":"Output å¯¹äºæ¯ä¸ªæ ·ä¾‹ï¼Œè¾“å‡ºå«Œç–‘çŠ¯äººæ•°ã€‚ ","date":"2018-07-31","objectID":"/posts/poj-1611/:2:2","tags":["å¹¶æŸ¥é›†","POJ","ACM","C","C++"],"title":"The-suspects-POJ-1611ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-1611/"},{"categories":["ACM"],"content":"Sample Input 100 4 2 1 2 5 10 13 11 12 14 2 0 1 2 99 2 200 2 1 5 5 1 2 3 4 5 1 0 0 0 ","date":"2018-07-31","objectID":"/posts/poj-1611/:2:3","tags":["å¹¶æŸ¥é›†","POJ","ACM","C","C++"],"title":"The-suspects-POJ-1611ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-1611/"},{"categories":["ACM"],"content":"Sample Output 4 1 è¿™é¢˜ä¹Ÿå¾ˆå¥½ç†è§£ï¼ŒAC ä»£ç å¦‚ä¸‹ï¼š #include\u003ccstdio\u003e int pre[30010],x[30010]; int find(int root){ int son,t; son=root; while(root!=pre[root]) root=pre[root]; while(son!=root){ t=pre[son]; pre[son]=root; son=t; } return root; } void join(int x,int y){ int fx=find(x),fy=find(y); if(fx!=fy) pre[fy]=fx; } int main(){ int n,m,i,k,sum; while(scanf(\"%d%d\",\u0026n,\u0026m),n||m){ sum=0; for(i=0;i\u003cn;i++) pre[i]=i; while(m--){ scanf(\"%d\",\u0026k); for(i=0;i\u003ck;i++) scanf(\"%d\",\u0026x[i]); for(i=1;i\u003ck;i++) join(x[i-1],x[i]); } for(i=0;i\u003cn;i++) if(find(0)==find(i)) sum++;//å†æ¬¡æŸ¥æ‰¾å¹¶å‹ç¼©è·¯å¾„ï¼Œæ³¨ä¸ç”¨ pre[i] printf(\"%d\\n\",sum); } return 0; } ","date":"2018-07-31","objectID":"/posts/poj-1611/:2:4","tags":["å¹¶æŸ¥é›†","POJ","ACM","C","C++"],"title":"The-suspects-POJ-1611ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-1611/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ï¼šwireless network ","date":"2018-07-31","objectID":"/posts/poj-2236/:1:0","tags":["å¹¶æŸ¥é›†","ACM","POJ","C++","C"],"title":"wireless network-POJ-2236ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-2236/"},{"categories":["ACM"],"content":"ç¿»è¯‘ï¼š å—äºšå‘ç”Ÿäº†ä¸€æ¬¡åœ°éœ‡ã€‚ACM (Asia Cooperated Medical äºšæ´²è”åˆåŒ»ç–—é˜Ÿï¼‰ å·²ç»ä¸ºè†ä¸Šå‹ç”µè„‘æ­å»ºäº†ä¸€ä¸ªæ— çº¿ç½‘ç»œï¼Œä½†å—åˆ°äº†ä¸€æ¬¡ä¸å¯é¢„çŸ¥çš„ä½™éœ‡æ”»å‡»ï¼Œå› æ­¤ç½‘ç»œä¸­çš„æ‰€æœ‰ç”µè„‘éƒ½è¢«ç ´åäº†ã€‚ç”µè„‘è¢«é€å°ä¿®å¤ï¼Œç½‘ç»œé€æ­¥æ¢å¤äº†å·¥ä½œã€‚ç”±äºå—åˆ°ç¡¬ä»¶çš„çº¦æŸï¼Œæ¯å°ç”µè„‘åªèƒ½ä¸è·ç¦»å®ƒä¸è¶…è¿‡ d ç±³çš„å…¶å®ƒç”µè„‘ç›´æ¥é€šä¿¡ã€‚ä½†æ¯å°ç”µè„‘å¯è¢«çœ‹ä½œå…¶å®ƒä¸¤å°ç”µè„‘çš„é€šä¿¡ä¸­è½¬ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœç”µè„‘ A å’Œç”µè„‘ B å¯ä»¥ç›´æ¥é€šä¿¡ï¼Œæˆ–å­˜åœ¨ä¸€å°ç”µè„‘ C æ—¢å¯ä¸ A ä¹Ÿå¯ä¸ B é€šä¿¡ï¼Œé‚£ä¹ˆç”µè„‘ A å’Œç”µè„‘ B ä¹‹é—´å°±èƒ½å¤Ÿé€šä¿¡ã€‚ åœ¨å¤„ç†ç½‘ç»œä¿®å¤çš„è¿‡ç¨‹ä¸­ï¼Œå·¥ä½œäººå‘˜ä»¬åœ¨ä»»ä½•ä¸€ä¸ªæ—¶åˆ»ï¼Œå¯ä»¥æ‰§è¡Œä¸¤ç§æ“ä½œï¼šç»´ä¿®ä¸€å°ç”µè„‘ï¼Œæˆ–æµ‹è¯•ä¸¤å°ç”µè„‘æ˜¯å¦èƒ½å¤Ÿé€šä¿¡ã€‚è¯·æ‚¨æ‰¾å‡ºå…¨éƒ¨çš„æµ‹è¯•æ“ä½œã€‚ ","date":"2018-07-31","objectID":"/posts/poj-2236/:2:0","tags":["å¹¶æŸ¥é›†","ACM","POJ","C++","C"],"title":"wireless network-POJ-2236ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-2236/"},{"categories":["ACM"],"content":"è¾“å…¥ ç¬¬ä¸€è¡ŒåŒ…å«äº†ä¸¤ä¸ªæ•´æ•° N å’Œ d (1 \u003c= N \u003c= 1001, 0 \u003c= d \u003c= 20000)ã€‚æ­¤å¤„ N æ˜¯ç”µè„‘çš„æ•°ç›®ï¼Œç¼–å·ä» 1 åˆ° Nï¼›åŒæ—¶ï¼ŒD æ˜¯ä¸¤å°ç”µè„‘ä¹‹é—´èƒ½å¤Ÿç›´æ¥é€šä¿¡çš„æœ€å¤§è·ç¦»ã€‚æ¥ä¸‹æ¥çš„ N è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° xi, yi (0 \u003c= xi, yi \u003c= 10000)ï¼Œè¡¨ç¤º N å°ç”µè„‘çš„åæ ‡ã€‚ä»ç¬¬ (N+1) è¡Œåˆ°è¾“å…¥ç»“æŸï¼Œæ˜¯é€ä¸€æ‰§è¡Œçš„æ“ä½œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ“ä½œï¼Œæ ¼å¼æ˜¯ä»¥ä¸‹ä¸¤è€…ä¹‹ä¸€ï¼š â€œO pâ€ (1 \u003c= p \u003c= N)ï¼Œè¡¨ç¤ºç»´æŠ¤ç”µè„‘ p ã€‚ â€œS p qâ€ (1 \u003c= p, q \u003c= N)ï¼Œè¡¨ç¤ºæµ‹è¯•ç”µè„‘ p å’Œ q æ˜¯å¦èƒ½å¤Ÿé€šä¿¡ã€‚ è¾“å…¥ä¸è¶…è¿‡ 300000 è¡Œã€‚ ","date":"2018-07-31","objectID":"/posts/poj-2236/:2:1","tags":["å¹¶æŸ¥é›†","ACM","POJ","C++","C"],"title":"wireless network-POJ-2236ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-2236/"},{"categories":["ACM"],"content":"è¾“å‡º å¯¹äºæ¯ä¸ªæµ‹è¯•æ“ä½œï¼Œå¦‚æœä¸¤å°ç”µè„‘èƒ½å¤Ÿé€šä¿¡ï¼Œåˆ™æ‰“å° â€œSUCCESSâ€ï¼›å¦åˆ™ï¼Œæ‰“å° â€œFAILâ€ã€‚ ","date":"2018-07-31","objectID":"/posts/poj-2236/:2:2","tags":["å¹¶æŸ¥é›†","ACM","POJ","C++","C"],"title":"wireless network-POJ-2236ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-2236/"},{"categories":["ACM"],"content":"ç¤ºä¾‹è¾“å…¥ 4 1 0 1 0 2 0 3 0 4 O 1 O 2 O 4 S 1 4 O 3 S 1 4 ","date":"2018-07-31","objectID":"/posts/poj-2236/:2:3","tags":["å¹¶æŸ¥é›†","ACM","POJ","C++","C"],"title":"wireless network-POJ-2236ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-2236/"},{"categories":["ACM"],"content":"ç¤ºä¾‹è¾“å‡º FAIL SUCCESS ","date":"2018-07-31","objectID":"/posts/poj-2236/:2:4","tags":["å¹¶æŸ¥é›†","ACM","POJ","C++","C"],"title":"wireless network-POJ-2236ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-2236/"},{"categories":["ACM"],"content":"AC ä»£ç ï¼š #include \"iostream\" #include \"cstring\" using namespace std; int pre[1005]; int x[1005],y[1005],use[1005]; int findd(int root){ int son,t; son=root; while(root!=pre[root]) root=pre[root]; while(son!=root){ t=pre[son]; pre[son]=root; son=t; } return root; } void join(int x,int y){ int fx=findd(x),fy=findd(y); if(fx!=fy) pre[fx]=fy; } int dis(int i,int num,int d){ d=d*d; int xx=x[i]-x[num]; int yy=y[i]-y[num]; if((xx*xx+yy*yy)\u003c=d) return 1; return 0; } int main(){ int n,d; char s; memset(use,0,sizeof(use)); cin\u003e\u003en\u003e\u003ed; for(int i=0;i\u003c=n;i++) pre[i]=i; for(int i=1;i\u003c=n;i++) cin\u003e\u003ex[i]\u003e\u003ey[i]; while(cin\u003e\u003es){ if(s=='O'){ int num; cin\u003e\u003enum; use[num]=1; findd(num);//è·¯å¾„å‹ç¼© for(int i=1;i\u003c=n;i++) if(i!=num\u0026\u0026use[i]==1\u0026\u0026dis(i,num,d))//ä¿®å¥½äº†ï¼Œä¸”å¯ä»¥è¢«åˆå¹¶ï¼ˆè‡ªå·±é™¤å¤–ï¼‰ join(i,num); } else if(s=='S'){ int q,p; cin\u003e\u003eq\u003e\u003ep; if(findd(q)==findd(p)) cout\u003c\u003c\"SUCCESS\"\u003c\u003cendl; else cout\u003c\u003c\"FAIL\"\u003c\u003cendl; } } return 0; } ","date":"2018-07-31","objectID":"/posts/poj-2236/:2:5","tags":["å¹¶æŸ¥é›†","ACM","POJ","C++","C"],"title":"wireless network-POJ-2236ï¼ˆå¹¶æŸ¥é›†ï¼‰","uri":"/posts/poj-2236/"},{"categories":["ACM"],"content":"Codeforces Round #500 (Div. 2) é¢˜ç›®é“¾æ¥ï¼šPiles With Stones å¤§è‡´é¢˜æ„å°±æ˜¯æœ‰ n å †çŸ³å¤´ï¼Œç¬¬ä¸€å¤©æ¯å †æœ‰ä¸€å®šæ•°ç›®çš„çŸ³å¤´ï¼Œç¬¬äºŒå¤©çŸ³å¤´å¯èƒ½è¢«å°æœ‹å‹ç§»åŠ¨æˆ–è€…å¸¦èµ°ï¼Œæ±‚æ»¡è¶³é¢˜æ„çš„ä¸¤å¤©çš„çŸ³ç¢“ï¼› æ‰€ä»¥ç¬¬äºŒå¤©çš„çŸ³å¤´æ€»æ•°ä¸ä¼šå¤§äºç¬¬ä¸€å¤©çš„ï¼Œæ‰€ä»¥æ˜¯ sum1-sum2\u003e=0 å³å¯ã€‚ //åˆåªæ‰“äº†ä¸€é“é¢˜ï¼Œæ‰£äº† 80 å¤šåˆ†ã€‚ #include\u003cbits/stdc++.h\u003e using namespace std; int x[55],y[55],n,s1=0,s2=0; int main(){ scanf(\"%d\",\u0026n); for(int i=0;i\u003cn;i++){ scanf(\"%d\",\u0026x[i]); s1+=x[i]; } for(int i=0;i\u003cn;i++){ scanf(\"%d\",\u0026y[i]); s2+=y[i]; } if((s1-s2)\u003e=0) printf(\"Yes\\n\"); else printf(\"No\\n\"); return 0; } ","date":"2018-07-31","objectID":"/posts/piles-with-stones/:0:0","tags":["ACM","Codeforces","C++"],"title":"Piles-with-stones","uri":"/posts/piles-with-stones/"},{"categories":["ACM"],"content":"å¹¶æŸ¥é›†å…¥é—¨æ¨èï¼šè¶…æœ‰çˆ±çš„å¹¶æŸ¥é›†~ é¢˜ç›®é“¾æ¥ï¼šç•…é€šå·¥ç¨‹ é¢˜æ„åˆ†æï¼š é¦–å…ˆåœ¨åœ°å›¾ä¸Šç»™ä½ è‹¥å¹²ä¸ªåŸé•‡ï¼Œè¿™äº›åŸé•‡éƒ½å¯ä»¥çœ‹ä½œç‚¹ï¼Œç„¶åå‘Šè¯‰ä½ å“ªäº›å¯¹åŸé•‡ä¹‹é—´æ˜¯æœ‰é“è·¯ç›´æ¥ç›¸è¿çš„ã€‚æœ€åè¦è§£å†³çš„æ˜¯æ•´å¹…å›¾çš„è¿é€šæ€§é—®é¢˜ã€‚æ¯”å¦‚éšæ„ç»™ä½ ä¸¤ä¸ªç‚¹ï¼Œè®©ä½ åˆ¤æ–­å®ƒä»¬æ˜¯å¦è¿é€šï¼Œæˆ–è€…é—®ä½ æ•´å¹…å›¾ä¸€å…±æœ‰å‡ ä¸ªè¿é€šåˆ†æ”¯ï¼Œä¹Ÿå°±æ˜¯è¢«åˆ†æˆäº†å‡ ä¸ªäº’ç›¸ç‹¬ç«‹çš„å—ã€‚åƒç•…é€šå·¥ç¨‹è¿™é¢˜ï¼Œé—®è¿˜éœ€è¦ä¿®å‡ æ¡è·¯ï¼Œå®è´¨å°±æ˜¯æ±‚æœ‰å‡ ä¸ªè¿é€šåˆ†æ”¯ã€‚ #include\u003ciostream\u003e #include\u003ccstdio\u003e using namespace std; int pre[1010]; int findd(int root){ int son,t; son=root; while(root!=pre[root]) root=pre[root]; while(son!=root){ t=pre[son]; pre[son]=root; son=t; } return root; } int main(){ int n,m,i,sum,r1,r2,star,end1; while(scanf(\"%d\",\u0026n)\u0026\u0026n){ sum=n-1; for(i=1;i\u003c=n;i++) pre[i]=i; scanf(\"%d\",\u0026m); while(m--){ scanf(\"%d%d\",\u0026star,\u0026end1); r1=findd(star); r2=findd(end1); if(r1!=r2){ pre[r1]=r2; sum--; } } printf(\"%d\\n\",sum); } return 0; } åŸºç¡€å›é¡¾ï¼š find() å‡½æ•°æ‰¾æ ¹ç»“ç‚¹çš„ä¸¤ç§å†™æ³•å¦‚ä¸‹ï¼š ç¬¬ä¸€ç§é€’å½’ï¼š int find(int x) { return x == pre[x] ? x : find(pre[x]); } ç¬¬äºŒç§ï¼š int find(int x) { int root, temp; root = x; while(root != pre[root]) root = pre[root]; while(x != root) { temp = pre[x]; pre[temp] = root; x = temp; } return root; } åˆå¹¶å‡½æ•° void join(int x,int y){ int fx=find(x); int fy=find(y); if(fx!=fy) pre[fx]=fy; } ","date":"2018-07-31","objectID":"/posts/%E7%95%85%E9%80%9A%E5%B7%A5%E7%A8%8B/:0:0","tags":["ACM","å¹¶æŸ¥é›†","HDU","C++","C"],"title":"ç•…é€šå·¥ç¨‹-HDU-1232ï¼ˆå¹¶æŸ¥é›†ç»å…¸æ¨¡æ¿ï¼‰","uri":"/posts/%E7%95%85%E9%80%9A%E5%B7%A5%E7%A8%8B/"},{"categories":["ACM"],"content":"ä¸¤é¢˜æ°´è¿‡ï¼Œæš´åŠ›ï¼Œæ‰¾è§„å¾‹ã€‚ ","date":"2018-07-27","objectID":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/:0:0","tags":["Nowcoder","ACM","C++","C"],"title":"ç‰›å®¢ç»ƒä¹ èµ› 23","uri":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/"},{"categories":["ACM"],"content":"æ‰˜ç±³çš„èµŒçƒ ","date":"2018-07-27","objectID":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/:1:0","tags":["Nowcoder","ACM","C++","C"],"title":"ç‰›å®¢ç»ƒä¹ èµ› 23","uri":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/"},{"categories":["ACM"],"content":"æ‰˜ç±³çš„åˆ’åˆ† ","date":"2018-07-27","objectID":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/:2:0","tags":["Nowcoder","ACM","C++","C"],"title":"ç‰›å®¢ç»ƒä¹ èµ› 23","uri":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/"},{"categories":["ACM"],"content":"a #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ int c[13],d[13]={100,50,20,10,5,2,1,50,20,10,5,2,1}; int i,t; cin\u003e\u003et; int a,b; while(t--){ memset(c,0,sizeof(c)); cin\u003e\u003ea\u003e\u003eb; for(i=0;i\u003c7;i++){ int x=0; if(a\u003ec[i]){ x=a/d[i]; c[i]+=x; a-=x*d[i]; } for(i=7;i\u003c13;i++){ int x=0; if(b\u003ec[i]){ x=b/d[i]; c[i]+=x; b-=x*d[i]; } cout\u003c\u003cc[0]; for(i=1;i\u003c13;i++) cout\u003c\u003c\" \"\u003c\u003cc[i]; cout\u003c\u003cendl; } return 0; } ","date":"2018-07-27","objectID":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/:3:0","tags":["Nowcoder","ACM","C++","C"],"title":"ç‰›å®¢ç»ƒä¹ èµ› 23","uri":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/"},{"categories":["ACM"],"content":"b f(n)=f(n-1)+n-1; #include\u003cbits/stdc++.h\u003e using namespace std; long long sum; int main(){ int n; int t; cin\u003e\u003et; while(t--){ sum=1; cin\u003e\u003en; if(n==1) sum=0; for(int i=3;i\u003c=n;i++) sum+=i-1; cout\u003c\u003csum\u003c\u003cendl; } return 0; } ","date":"2018-07-27","objectID":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/:4:0","tags":["Nowcoder","ACM","C++","C"],"title":"ç‰›å®¢ç»ƒä¹ èµ› 23","uri":"/posts/%E7%89%9B%E5%AE%A2%E7%BB%83%E4%B9%A0%E8%B5%9B23/"},{"categories":["Grocery"],"content":"åœ¨çº¿ç®—æ³• åœ¨çº¿ç®—æ³•æ˜¯æŒ‡å®ƒå¯ä»¥ä»¥åºåˆ—åŒ–çš„æ–¹å¼ä¸€ä¸ªä¸ªçš„å¤„ç†è¾“å…¥ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å¼€å§‹æ—¶å¹¶ä¸éœ€è¦å·²ç»çŸ¥é“æ‰€æœ‰çš„è¾“å…¥ã€‚ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œä¸€ä¸ªåœ¨çº¿ç®—æ³•æ˜¯æŒ‡å®ƒå¯ä»¥ä»¥åºåˆ—åŒ–çš„æ–¹å¼ä¸€ä¸ªä¸ªçš„å¤„ç†è¾“å…¥ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å¼€å§‹æ—¶å¹¶ä¸éœ€è¦å·²ç»çŸ¥é“æ‰€æœ‰çš„è¾“å…¥ã€‚ç›¸å¯¹çš„ï¼Œå¯¹äºä¸€ä¸ªç¦»çº¿ç®—æ³•ï¼Œåœ¨å¼€å§‹æ—¶å°±éœ€è¦çŸ¥é“é—®é¢˜çš„æ‰€æœ‰è¾“å…¥æ•°æ®ï¼Œè€Œä¸”åœ¨è§£å†³ä¸€ä¸ªé—®é¢˜åå°±è¦ç«‹å³è¾“å‡ºç»“æœã€‚ä¾‹å¦‚ï¼Œé€‰æ‹©æ’åºåœ¨æ’åºå‰å°±éœ€è¦çŸ¥é“æ‰€æœ‰å¾…æ’åºå…ƒç´ ï¼Œç„¶è€Œæ’å…¥æ’åºå°±ä¸å¿…ã€‚ å› ä¸ºåœ¨çº¿ç®—æ³•å¹¶ä¸çŸ¥é“æ•´ä¸ªçš„è¾“å…¥ï¼Œæ‰€ä»¥å®ƒè¢«è¿«åšå‡ºçš„é€‰æ‹©æœ€åå¯èƒ½ä¼šè¢«è¯æ˜ä¸æ˜¯æœ€ä¼˜çš„ï¼Œå¯¹åœ¨çº¿ç®—æ³•çš„ç ”ç©¶ä¸»è¦é›†ä¸­åœ¨å½“å‰ç¯å¢ƒä¸‹æ€ä¹ˆåšå‡ºé€‰æ‹©ã€‚å¯¹ç›¸åŒé—®é¢˜çš„åœ¨çº¿ç®—æ³•å’Œç¦»çº¿ç®—æ³•çš„å¯¹æ¯”åˆ†æå½¢æˆäº†ä»¥ä¸Šè§‚ç‚¹ã€‚å¦‚æœæƒ³ä»å…¶ä»–è§’åº¦äº†è§£åœ¨çº¿ç®—æ³•å¯ä»¥çœ‹ä¸€ä¸‹æµç®—æ³•ï¼ˆå…³æ³¨ç²¾ç¡®å‘ˆç°è¿‡å»çš„è¾“å…¥æ‰€ä½¿ç”¨çš„å†…å­˜çš„é‡ï¼‰ï¼ŒåŠ¨æ€ç®—æ³•ï¼ˆå…³æ³¨ç»´æŠ¤ä¸€ä¸ªåœ¨çº¿è¾“å…¥çš„ç»“æœæ‰€éœ€è¦çš„æ—¶é—´å¤æ‚åº¦ï¼‰å’Œåœ¨çº¿æœºå™¨å­¦ä¹ ã€‚ ä¸€ä¸ªå¾ˆå¥½çš„å±•ç¤ºåœ¨çº¿ç®—æ³•æ¦‚å¿µçš„ä¾‹å­æ˜¯ åŠ æ‹¿å¤§æ—…è¡Œè€…é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜çš„ç›®æ ‡æ˜¯åœ¨ä¸€ä¸ªæœ‰æƒå›¾ä¸­ä»¥æœ€å°çš„ä»£ä»·åˆ°è¾¾ä¸€ä¸ªç›®æ ‡èŠ‚ç‚¹ï¼Œä½†è¿™ä¸ªæœ‰æƒå›¾ä¸­æœ‰äº›è¾¹æ˜¯ä¸å¯é çš„å¯èƒ½å·²ç»è¢«å‰”é™¤ã€‚ç„¶è€Œä¸€ä¸ªæ—…è¡Œè€…åªæœ‰åˆ°æŸä¸ªè¾¹çš„ä¸€ä¸ªç«¯ç‚¹æ—¶æ‰èƒ½ç¡®å®šè¯¥è¾¹æ˜¯å¦å·²ç»è¢«ç§»é™¤äº†ã€‚æœ€åæƒ…å†µä¸‹ï¼Œè¯¥é—®é¢˜ä¼šå˜å¾—ç®€å•äº†ï¼Œå³æ‰€æœ‰çš„ä¸ç¡®å®šçš„è¾¹éƒ½è¢«ç§»é™¤è¯¥é—®é¢˜å°†ä¼šå˜æˆé€šå¸¸çš„æœ€çŸ­è·¯å¾„é—®é¢˜ã€‚ ","date":"2018-07-26","objectID":"/posts/%E5%9C%A8%E7%BA%BF%E7%A6%BB%E7%BA%BF%E7%AE%97%E6%B3%95/:1:0","tags":["åœ¨çº¿ç¦»çº¿ç®—æ³•"],"title":"åœ¨çº¿ç¦»çº¿ç®—æ³•","uri":"/posts/%E5%9C%A8%E7%BA%BF%E7%A6%BB%E7%BA%BF%E7%AE%97%E6%B3%95/"},{"categories":["Grocery"],"content":"ç¦»çº¿ç®—æ³• ç¦»çº¿ç®—æ³• ( off line algorithms)ï¼Œæ˜¯æŒ‡åŸºäºåœ¨æ‰§è¡Œç®—æ³•å‰è¾“å…¥æ•°æ®å·²çŸ¥çš„åŸºæœ¬å‡è®¾ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªç¦»çº¿ç®—æ³•ï¼Œåœ¨å¼€å§‹æ—¶å°±éœ€è¦çŸ¥é“é—®é¢˜çš„æ‰€æœ‰è¾“å…¥æ•°æ®ï¼Œè€Œä¸”åœ¨è§£å†³ä¸€ä¸ªé—®é¢˜åå°±è¦ç«‹å³è¾“å‡ºç»“æœã€‚ è®¾è®¡ç­–ç•¥ åœ¨æ‰§è¡Œç®—æ³•å‰è¾“å…¥å·²çŸ¥çš„åŸºæœ¬å‡è®¾ å‰æ å…·æœ‰é—®é¢˜å®Œå…¨ä¿¡æ¯ ç®—æ³•è®¾è®¡ç­–ç•¥éƒ½æ˜¯åŸºäºåœ¨æ‰§è¡Œç®—æ³•å‰è¾“å…¥æ•°æ®å·²çŸ¥çš„åŸºæœ¬å‡è®¾ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªç¦»çº¿ç®—æ³•ï¼Œåœ¨å¼€å§‹æ—¶å°±éœ€è¦çŸ¥é“é—®é¢˜çš„æ‰€æœ‰è¾“å…¥æ•°æ®ï¼Œè€Œä¸”åœ¨è§£å†³ä¸€ä¸ªé—®é¢˜åå°±è¦ç«‹å³è¾“å‡ºç»“æœï¼Œé€šå¸¸å°†è¿™ç±»å…·æœ‰é—®é¢˜å®Œå…¨ä¿¡æ¯å‰æä¸‹è®¾è®¡å‡ºçš„ç®—æ³•ç§°ä¸ºç¦»çº¿ç®—æ³• ( off line algorithms) ","date":"2018-07-26","objectID":"/posts/%E5%9C%A8%E7%BA%BF%E7%A6%BB%E7%BA%BF%E7%AE%97%E6%B3%95/:2:0","tags":["åœ¨çº¿ç¦»çº¿ç®—æ³•"],"title":"åœ¨çº¿ç¦»çº¿ç®—æ³•","uri":"/posts/%E5%9C%A8%E7%BA%BF%E7%A6%BB%E7%BA%BF%E7%AE%97%E6%B3%95/"},{"categories":["ACM"],"content":"éå¸¸å¯ä¹ å¤§å®¶ä¸€å®šè§‰çš„è¿åŠ¨ä»¥åå–å¯ä¹æ˜¯ä¸€ä»¶å¾ˆæƒ¬æ„çš„äº‹æƒ…ï¼Œä½†æ˜¯ seeyou å´ä¸è¿™ä¹ˆè®¤ä¸ºã€‚å› ä¸ºæ¯æ¬¡å½“ seeyou ä¹°äº†å¯ä¹ä»¥åï¼Œé˜¿ç‰›å°±è¦æ±‚å’Œ seeyou ä¸€èµ·åˆ†äº«è¿™ä¸€ç“¶å¯ä¹ï¼Œè€Œä¸”ä¸€å®šè¦å–çš„å’Œ seeyou ä¸€æ ·å¤šã€‚ä½† seeyou çš„æ‰‹ä¸­åªæœ‰ä¸¤ä¸ªæ¯å­ï¼Œå®ƒä»¬çš„å®¹é‡åˆ†åˆ«æ˜¯ N æ¯«å‡å’Œ M æ¯«å‡ å¯ä¹çš„ä½“ç§¯ä¸º S ï¼ˆS\u003c101ï¼‰æ¯«å‡ã€€ï¼ˆæ­£å¥½è£…æ»¡ä¸€ç“¶ï¼‰ ï¼Œå®ƒä»¬ä¸‰ä¸ªä¹‹é—´å¯ä»¥ç›¸äº’å€’å¯ä¹ ï¼ˆéƒ½æ˜¯æ²¡æœ‰åˆ»åº¦çš„ï¼Œä¸” S==N+Mï¼Œ101 ï¼ S ï¼ 0ï¼ŒN ï¼ 0ï¼ŒM ï¼ 0) ã€‚èªæ˜çš„ ACMER ä½ ä»¬è¯´ä»–ä»¬èƒ½å¹³åˆ†å—ï¼Ÿå¦‚æœèƒ½è¯·è¾“å‡ºå€’å¯ä¹çš„æœ€å°‘çš„æ¬¡æ•°ï¼Œå¦‚æœä¸èƒ½è¾“å‡º\"NO\"ã€‚ ","date":"2018-07-24","objectID":"/posts/hdu-1495/:0:0","tags":["ACM","HDU","æœç´¢","C++"],"title":"HDU-1495-éå¸¸å¯ä¹ï¼ˆbfs æ¨¡æ‹Ÿå€’æ°´ or æ•°è®ºï¼‰","uri":"/posts/hdu-1495/"},{"categories":["ACM"],"content":"Input ä¸‰ä¸ªæ•´æ•° : S å¯ä¹çš„ä½“ç§¯ , N å’Œ M æ˜¯ä¸¤ä¸ªæ¯å­çš„å®¹é‡ï¼Œä»¥\"0 0 0\"ç»“æŸã€‚ ","date":"2018-07-24","objectID":"/posts/hdu-1495/:0:1","tags":["ACM","HDU","æœç´¢","C++"],"title":"HDU-1495-éå¸¸å¯ä¹ï¼ˆbfs æ¨¡æ‹Ÿå€’æ°´ or æ•°è®ºï¼‰","uri":"/posts/hdu-1495/"},{"categories":["ACM"],"content":"Output å¦‚æœèƒ½å¹³åˆ†çš„è¯è¯·è¾“å‡ºæœ€å°‘è¦å€’çš„æ¬¡æ•°ï¼Œå¦åˆ™è¾“å‡º\"NO\"ã€‚ ","date":"2018-07-24","objectID":"/posts/hdu-1495/:0:2","tags":["ACM","HDU","æœç´¢","C++"],"title":"HDU-1495-éå¸¸å¯ä¹ï¼ˆbfs æ¨¡æ‹Ÿå€’æ°´ or æ•°è®ºï¼‰","uri":"/posts/hdu-1495/"},{"categories":["ACM"],"content":"Sample Input 7 4 3 4 1 3 0 0 0 ","date":"2018-07-24","objectID":"/posts/hdu-1495/:0:3","tags":["ACM","HDU","æœç´¢","C++"],"title":"HDU-1495-éå¸¸å¯ä¹ï¼ˆbfs æ¨¡æ‹Ÿå€’æ°´ or æ•°è®ºï¼‰","uri":"/posts/hdu-1495/"},{"categories":["ACM"],"content":"Sample Output NO 3 æ¨¡æ‹Ÿä¸€ä¸‹å€’æ°´çš„è¿‡ç¨‹ï¼Œä¸€å…±æœ‰ä¸‰ç§å€’æ³•ï¼Œa å‘ bcï¼Œb å‘ acï¼Œc å‘ abã€‚ï¼ˆç›¸å½“äºä¸€å…±å…­ä¸ªæ–¹å‘ï¼‰æœç´¢å¹¶è®°å½•æœç´¢è¿‡çš„è¿‡ç¨‹å°±å¥½äº†ã€‚ #include\u003cbits/stdc++.h\u003e using namespace std; int a,b,c; int used[111][111][111]; struct node { int x,y,z; int step; }m,n; int bfs() { queue\u003cnode\u003eq; m.x = a; m.y = 0; m.z = 0; m.step = 0; used[a][0][0] = 1; q.push(m); while (!q.empty()) { int trans; //å€’æ°´é‡ m = q.front(); q.pop(); //æˆåŠŸåˆ†å¥½çš„ä¸‰ç§æƒ…å†µ if ((m.x == 0 \u0026\u0026 m.y == m.z) || (m.y == 0 \u0026\u0026 m.x == m.z) || (m.z == 0 \u0026\u0026 m.x == m.y)) return m.step; //ä¸‹é¢å¼€å§‹ 6 ä¸ªæœç´¢ï¼ˆç”±ä¸€ä¸ªæ¯å­å‘å¦å¤–ä¸¤ä¸ªå€’æ°´ï¼‰ if (m.x) { //ç¬¬ä¸€ trans = min(m.x , b - m.y);//è‡ªå·±æ¨¡æ‹Ÿä¸€ä¸‹å€’æ°´è¿‡ç¨‹å°±çŸ¥é“äº† n.x = m.x - trans; n.y = m.y + trans; n.z = m.z; n.step = m.step + 1; if (!used[n.x][n.y][n.z]) { q.push(n); used[n.x][n.y][n.z] = 1; } //ç¬¬äºŒ trans = min(m.x , c - m.z); n.x = m.x - trans; n.y = m.y; n.z = m.z + trans; n.step = m.step + 1; if (!used[n.x][n.y][n.z]) { q.push(n); used[n.x][n.y][n.z] = 1; } } if (m.y) { //ç¬¬ä¸‰ trans = min(m.y , a - m.x); n.x = m.x + trans; n.y = m.y - trans; n.z = m.z; n.step = m.step + 1; if (!used[n.x][n.y][n.z]) { used[n.x][n.y][n.z] = 1; q.push(n); } //ç¬¬å›› trans = min(m.y , c - m.z); n.x = m.x; n.y = m.y - trans; n.z = m.z + trans; n.step = m.step + 1; if (!used[n.x][n.y][n.z]) { used[n.x][n.y][n.z] = 1; q.push(n); } } if (m.z) { //ç¬¬äº” trans = min(m.z , a - m.x); n.x = m.x + trans; n.y = m.y; n.z = m.z - trans; n.step = m.step + 1; if (!used[n.x][n.y][n.z]) { used[n.x][n.y][n.z] = 1; q.push(n); } //ç¬¬å…­ trans = min(m.z , b - m.y); n.x = m.x; n.y = m.y + trans; n.z = m.z - trans; n.step = m.step + 1; if (!used[n.x][n.y][n.z]) { q.push(n); used[n.x][n.y][n.z] = 1; } } } return 0; } int main() { while (~scanf (\"%d %d %d\",\u0026a,\u0026b,\u0026c) \u0026\u0026 (a || b || c)) { if (a\u00261) //å…ˆç®€å•çš„å‰ªæä¸€ä¸‹ï¼Œå¥‡æ•°è‚¯å®šä¸èƒ½å¹³åˆ† printf (\"NO\\n\"); else { memset (used,0,sizeof (used)); int ans = bfs(); if (ans) printf (\"%d\\n\",ans); else printf (\"NO\\n\"); } } return 0; } ç„¶åæ­ç”µä¸Šè®¨è®ºæ¿å­ä¸Šæä¾›ä¸€ç§æ•°è®ºé¢˜è§£ï¼Œä½†æ˜¯æ•°æ®å­˜åœ¨ä¸€ç‚¹é—®é¢˜ï¼Œåªä¸è¿‡æœ‰äº›æ•°æ®å¥½åƒä¸å¯¹ï¼›æ¯”å¦‚ï¼š 10 6 5 çš„ç»“æœåº”è¯¥æ˜¯ 1 è€Œä¸æ˜¯ 9ï¼Œ ä¹Ÿæç¤ºæˆ‘ä»¬å¤šç»´æ€è€ƒåŒä¸€ä¸ªé—®é¢˜ï¼ æ•°è®ºæ¨å¯¼ #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ int s,n,m; while(cin\u003e\u003es\u003e\u003en\u003e\u003em,s+n+m){ s/=__gcd(n,m); if(s\u00261)//å¥‡æ•° cout\u003c\u003c\"NO\\n\"; else cout\u003c\u003cs-1\u003c\u003cendl; } return 0; } ","date":"2018-07-24","objectID":"/posts/hdu-1495/:0:4","tags":["ACM","HDU","æœç´¢","C++"],"title":"HDU-1495-éå¸¸å¯ä¹ï¼ˆbfs æ¨¡æ‹Ÿå€’æ°´ or æ•°è®ºï¼‰","uri":"/posts/hdu-1495/"},{"categories":["ACM"],"content":"Find a way åœ£è¯èŠ‚è¦åˆ°äº†ï¼Œå¤ç¥å’Œç‘ç‘è¿™å¯¹åŸºä½¬æƒ³ä¸€èµ·å»å¬å”¤å¸ˆå¤§å³¡è°·å¼€å¼€è½¦ã€‚ç™¾åº¦åœ°å›¾ä¸€ä¸‹ï¼Œå‘ç°å‘¨å›´çš„å¬å”¤å¸ˆå¤§å³¡è°·è¿˜ä¸å°‘ï¼Œè¿™å¯¹åŸºä½¬çº ç»“ç€ï¼Œè¯¥å»å“ªä¸€ä¸ªã€‚å¤ç¥ï¼šæˆ‘è¦å»å·¦è¾¹çš„è¿™ä¸ªï¼ˆå› ä¸ºç¦»è‡ªå·±æ¯”è¾ƒè¿‘ å“ˆå“ˆ~ï¼‰ã€‚ç‘ç‘ï¼šæˆ‘è¦å»å³è¾¹çš„è¿™ä¸ªï¼ˆå› ä¸ºç¦»è‡ªå·±æ¯”è¾ƒè¿‘ å˜¿å˜¿~ï¼‰ â€¦â€¦.. è¿™å¯¹åŸºä½¬é—¹çŸ›ç›¾äº†ï¼Œå¼€è½¦æœ‰å±é™©äº†ï¼ ä¸ºäº†ä¸è®©ä»–ä»¬å»å¬å”¤å¸ˆå¤§å³¡è°·å‘äººï¼Œriot å†³å®šè®©ä»–ä»¬å» X å¬å”¤å¸ˆå¤§å³¡è°·ï¼Œä¿è¯ä»–ä¿©æ‰€èµ°çš„è·¯ç¨‹å’Œæœ€çŸ­ã€‚æ¯èµ°ä¸€ä¸ªç‚¹éœ€è¦èŠ±è´¹ 11 åˆ†é’Ÿï¼Œè¾“å‡ºä»–ä»¬ä¸€å…±èŠ±è´¹å¤šå°‘æ—¶é—´ï¼ˆæœ€çŸ­æ—¶é—´å™¢ï¼‰ ","date":"2018-07-23","objectID":"/posts/hdu-2612/:0:1","tags":["ACM","HDU","æœç´¢","C++"],"title":"hdu-2612-Find a wayï¼ˆåŒ bfsï¼‰","uri":"/posts/hdu-2612/"},{"categories":["ACM"],"content":"Input å¤šç»„æµ‹è¯•æ•°æ® æ¯ç»„æ•°æ®ï¼Œå¼€å§‹ä¸€è¡Œ nï¼Œm (2\u003c=n,m\u003c=200) æ¥ä¸‹æ¥æ˜¯ä¸ª n x m çš„çŸ©é˜µ â€˜Yâ€™ è¡¨ç¤ºå¤ç¥æ‰€åœ¨çš„åˆå§‹ä½ç½® â€˜Mâ€™ è¡¨ç¤ºç‘ç‘æ‰€åœ¨çš„åˆå§‹ä½ç½® â€˜#â€™ è¯¥ç‚¹ç¦æ­¢é€šè¡Œ â€˜.â€™ è¯¥ç‚¹å¯é€šè¡Œ â€˜@â€™ å¬å”¤å¸ˆå¤§å³¡è°· ","date":"2018-07-23","objectID":"/posts/hdu-2612/:0:2","tags":["ACM","HDU","æœç´¢","C++"],"title":"hdu-2612-Find a wayï¼ˆåŒ bfsï¼‰","uri":"/posts/hdu-2612/"},{"categories":["ACM"],"content":"Output æ¯ç»„æµ‹è¯•æ•°æ®ï¼Œè¾“å‡ºå¤ç¥å’Œç‘ç‘åˆ°è¾¾åŒä¸€ä¸ªå¬å”¤å¸ˆå¤§å³¡è°·æ‰€èŠ±è´¹çš„æœ€çŸ­æ—¶é—´ã€‚ ","date":"2018-07-23","objectID":"/posts/hdu-2612/:0:3","tags":["ACM","HDU","æœç´¢","C++"],"title":"hdu-2612-Find a wayï¼ˆåŒ bfsï¼‰","uri":"/posts/hdu-2612/"},{"categories":["ACM"],"content":"Sample Input 4 4 Y.#@ .... .#.. @..M 4 4 Y.#@ .... .#.. @#.M 5 5 Y..@. .#... @..M. `#...#` ","date":"2018-07-23","objectID":"/posts/hdu-2612/:0:4","tags":["ACM","HDU","æœç´¢","C++"],"title":"hdu-2612-Find a wayï¼ˆåŒ bfsï¼‰","uri":"/posts/hdu-2612/"},{"categories":["ACM"],"content":"Sample Output 66 88 66 ","date":"2018-07-23","objectID":"/posts/hdu-2612/:0:5","tags":["ACM","HDU","æœç´¢","C++"],"title":"hdu-2612-Find a wayï¼ˆåŒ bfsï¼‰","uri":"/posts/hdu-2612/"},{"categories":["ACM"],"content":"Hint å¯¹äºç¬¬ä¸€ç»„æ ·ä¾‹ï¼Œå¤ç¥å’Œç‘ç‘å»çŸ©é˜µï¼ˆ4,1ï¼‰ è¿™ä¸ªå¬å”¤å¸ˆå¤§å³¡è°·ï¼Œè€—è´¹çš„æ—¶é—´ä¸º 3 _ 11 + 3 _ 11 = 66ï¼Œ å»çŸ©é˜µï¼ˆ1,4ï¼‰è¿™ä¸ªå¬å”¤å¸ˆå¤§å³¡è°·ï¼Œè€—è´¹çš„æ—¶é—´ä¸º 5 _ 11 + 3 _ 11 = 88 ã€‚æ‰€ä»¥ï¼Œæœ€ç»ˆç­”æ¡ˆï¼š66ã€‚æ€è·¯å‚è€ƒ å†™ä»£ç æ€»æ˜¯å¥½ç²—å¿ƒï¼ï¼ #include \u003cbits/stdc++.h\u003e #define inf 0x3f3f3f3f //acm ä¸­â€œæ— ç©·å¤§â€çš„ä¸€èˆ¬å®šä¹‰ using namespace std; const int M=202; char mp[M][M]; //åœ°å›¾ int a[M][M],b[M][M]; bool vis[M][M]; //æ ‡è®°æ•°ç»„ int n,m; int ans; struct node { int x,y,step; }; void init() //åˆå§‹åŒ–å‡½æ•° { ans=inf; for(int i=0; i\u003cn; i++) for(int j=0; j\u003cm; j++) { a[i][j]=inf; b[i][j]=inf; } } void bfs(int x,int y,bool flag){ int dir[4][2]={-1,0,1,0,0,1,0,-1}; node u,v; queue\u003cnode\u003e q; //åˆå§‹åŒ–é˜Ÿåˆ—ç¬¬ä¸€ä¸ªå…ƒç´  u.x=x; u.y=y; u.step=0; vis[x][y]=true; q.push(u); while(!q.empty()){ u=q.front(); q.pop(); if(mp[u.x][u.y]=='@'){ if(!flag) a[u.x][u.y]=u.step; else b[u.x][u.y]=u.step; } for(int i=0;i\u003c4;i++){ int tx=u.x+dir[i][0]; int ty=u.y+dir[i][1]; if(tx\u003e=0\u0026\u0026ty\u003e=0\u0026\u0026tx\u003cn\u0026\u0026ty\u003cm\u0026\u0026!vis[tx][ty]\u0026\u0026mp[tx][ty]!='#'){//æ³¨æ„@å’Œ Mï¼ŒY ä¹Ÿæ˜¯å¯ä»¥èµ°çš„ã€‚ v.x=tx; //æ¯æ¬¡å†™æœç´¢éƒ½å¿˜è®° vis!!!! v.y=ty; vis[tx][ty]=true; //æˆ‘æ€»æ˜¯å¿˜è®°ã€‚ v.step=u.step+1; q.push(v); } } } } int main() { while(~scanf(\"%d%d\",\u0026n,\u0026m)) { init(); for(int i=0; i\u003cn; i++) scanf(\"%s\",mp[i]); for(int i=0; i\u003cn; i++) for(int j=0; j\u003cm; j++) { if(mp[i][j]=='Y') { memset(vis,false,sizeof(vis)); bfs(i,j,false); } if(mp[i][j]=='M') { memset(vis,false,sizeof(vis)); //è®°å¾—å†æ¬¡åˆå§‹åŒ–æ ‡è®°æ•°ç»„ bfs(i,j,true); } } for(int i=0; i\u003cn; i++) for(int j=0; j\u003cm; j++) if(mp[i][j]=='@') ans=min(ans,a[i][j]+b[i][j]); printf(\"%d\\n\",ans*11); } return 0; } ","date":"2018-07-23","objectID":"/posts/hdu-2612/:0:6","tags":["ACM","HDU","æœç´¢","C++"],"title":"hdu-2612-Find a wayï¼ˆåŒ bfsï¼‰","uri":"/posts/hdu-2612/"},{"categories":["ACM"],"content":"Farmer John has been informed of the location of a fugitive cow and wants to catch her immediately. He starts at a point N (0 â‰¤ N â‰¤ 100,000) on a number line and the cow is at a point K (0 â‰¤ K â‰¤ 100,000) on the same number line. Farmer John has two modes of transportation: walking and teleporting. Walking: FJ can move from any point X to the points X\",â€œ1 or X + 1 in a single minute Teleporting: FJ can move from any point X to the point 2 Ã— X in a single minute. If the cow, unaware of its pursuit, does not move at all, how long does it take for Farmer John to retrieve it? ","date":"2018-07-22","objectID":"/posts/poj-3278/:0:0","tags":["BFS","ACM","æœç´¢","POJ","C++"],"title":"POJ-3278-Catch That Cow(bfs)","uri":"/posts/poj-3278/"},{"categories":["ACM"],"content":"Input Line 1: Two space-separated integers: N and K ","date":"2018-07-22","objectID":"/posts/poj-3278/:0:1","tags":["BFS","ACM","æœç´¢","POJ","C++"],"title":"POJ-3278-Catch That Cow(bfs)","uri":"/posts/poj-3278/"},{"categories":["ACM"],"content":"Output Line 1: The least amount of time, in minutes, it takes for Farmer John to catch the fugitive cow. ","date":"2018-07-22","objectID":"/posts/poj-3278/:0:2","tags":["BFS","ACM","æœç´¢","POJ","C++"],"title":"POJ-3278-Catch That Cow(bfs)","uri":"/posts/poj-3278/"},{"categories":["ACM"],"content":"Sample Input 5 17 ","date":"2018-07-22","objectID":"/posts/poj-3278/:0:3","tags":["BFS","ACM","æœç´¢","POJ","C++"],"title":"POJ-3278-Catch That Cow(bfs)","uri":"/posts/poj-3278/"},{"categories":["ACM"],"content":"Sample Output 4 ","date":"2018-07-22","objectID":"/posts/poj-3278/:0:4","tags":["BFS","ACM","æœç´¢","POJ","C++"],"title":"POJ-3278-Catch That Cow(bfs)","uri":"/posts/poj-3278/"},{"categories":["ACM"],"content":"Hint The fastest way for Farmer John to reach the fugitive cow is to move along the following path: 5-10-9-18-17, which takes 4 minutes. ","date":"2018-07-22","objectID":"/posts/poj-3278/:0:5","tags":["BFS","ACM","æœç´¢","POJ","C++"],"title":"POJ-3278-Catch That Cow(bfs)","uri":"/posts/poj-3278/"},{"categories":["ACM"],"content":"é¢˜æ„ï¼š å†œåœºä¸»çš„ç‰›ä¸è§äº†ï¼Œä¸»äººå’Œç‰›åœ¨ä¸€æ¡ç›´çº¿ä¸Šï¼Œä¸”ç‰›æ²¡æœ‰æ–°çš„ç›®æ ‡ï¼Œå®ƒä¸ä¼šèµ°åŠ¨ï¼Œä¸»äººçš„ä½ç½®æ˜¯ä½  nï¼Œç‰›çš„ä½ç½®æ˜¯ kï¼Œä¸»äººå¯ä»¥æœ‰ä¸‰ç§èµ°è·¯çš„æ–¹æ³•ï¼Œå³å·¦ï¼ˆè·ç¦»+-1ï¼‰ï¼Œé—ªç°ï¼ˆè·ç¦»+x,x ä¸ºå½“å‰ä½ç½®ï¼‰ï¼Œæ¯èµ°ä¸€æ­¥ï¼Œä¸€åˆ†é’Ÿï¼Œé—®å‡ åˆ†é’Ÿä¸»äººèƒ½æ‰¾åˆ°ç‰›ã€‚bfs æœç´¢æ–¹å‘å³ä¸ºä¸‰ä¸ªâ€œæ–¹å‘â€ã€‚æœç´¢æ‰€æœ‰èµ°æ³•ï¼› #include\"iostream\" #include\u003cqueue\u003e #include\"string.h\" using namespace std; int n,k; bool sign[200007]; struct node{ int x,step; }; bool check(int a) { if(!sign[a]\u0026\u0026a\u003e=0\u0026\u0026a\u003c110000) return true; return false; } void bfs() { node u,v; queue\u003cnode\u003e q; v.x=n;//åˆå§‹åŒ–èµ·ç‚¹ v.step=0; q.push(v); sign[v.x]=true; while(!q.empty()){ u=q.front(); q.pop(); if(u.x==k){ cout\u003c\u003cu.step\u003c\u003cendl; return ; } //ä¸‰ç§å‰è¿›æ–¹å‘ï¼Œå·¦å³å’Œé—ªç° v=u; v.x++; v.step++; if(check(v.x)){ sign[v.x]=true; q.push(v); } v=u; v.x--; v.step++; if(check(v.x)){ sign[v.x]=true; q.push(v); } v=u; v.x=2*v.x; v.step++; if(check(v.x)){ sign[v.x]=true; q.push(v); } } } int main() { cin\u003e\u003en\u003e\u003ek; memset(sign,0,sizeof(sign)); bfs(); return 0; } ","date":"2018-07-22","objectID":"/posts/poj-3278/:0:6","tags":["BFS","ACM","æœç´¢","POJ","C++"],"title":"POJ-3278-Catch That Cow(bfs)","uri":"/posts/poj-3278/"},{"categories":["ACM"],"content":"è‹±æ–‡åŸé¢˜é“¾æ¥ ","date":"2018-07-22","objectID":"/posts/poj-2251/:0:0","tags":["BFS","ACM","æœç´¢","POJ","C++","C"],"title":"poj-2251-Dungeon Masterï¼ˆä¸‰ç»´ bfs æœ€çŸ­è·¯ï¼‰","uri":"/posts/poj-2251/"},{"categories":["ACM"],"content":"Description - é¢˜ç›®æè¿° ä½ è¢«å›°åœ¨ä¸€ä¸ªä¸‰ç»´çš„ç©ºé—´ä¸­ï¼Œç°åœ¨è¦å¯»æ‰¾æœ€çŸ­è·¯å¾„é€ƒç”Ÿï¼ ç©ºé—´ç”±ç«‹æ–¹ä½“å•ä½æ„æˆ ä½ æ¯æ¬¡å‘ä¸Šä¸‹å‰åå·¦å³ç§»åŠ¨ä¸€ä¸ªå•ä½éœ€è¦ä¸€åˆ†é’Ÿ ä½ ä¸èƒ½å¯¹è§’çº¿ç§»åŠ¨å¹¶ä¸”å››å‘¨å°é—­ æ˜¯å¦å­˜åœ¨é€ƒå‡ºç”Ÿå¤©çš„å¯èƒ½æ€§ï¼Ÿå¦‚æœå­˜åœ¨ï¼Œåˆ™éœ€è¦å¤šå°‘æ—¶é—´ï¼Ÿ ","date":"2018-07-22","objectID":"/posts/poj-2251/:0:1","tags":["BFS","ACM","æœç´¢","POJ","C++","C"],"title":"poj-2251-Dungeon Masterï¼ˆä¸‰ç»´ bfs æœ€çŸ­è·¯ï¼‰","uri":"/posts/poj-2251/"},{"categories":["ACM"],"content":"Input - è¾“å…¥ è¾“å…¥ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•°è¡¨ç¤ºç©ºé—´çš„æ•°é‡ã€‚ æ¯ä¸ªç©ºé—´çš„æè¿°çš„ç¬¬ä¸€è¡Œä¸º Lï¼ŒR å’Œ Cï¼ˆçš†ä¸è¶…è¿‡ 30ï¼‰ã€‚ L è¡¨ç¤ºç©ºé—´çš„é«˜åº¦ã€‚R å’Œ C åˆ†åˆ«è¡¨ç¤ºæ¯å±‚ç©ºé—´çš„è¡Œä¸åˆ—çš„å¤§å°ã€‚ éšå L å±‚åœ°ç‰¢ï¼Œæ¯å±‚ R è¡Œï¼Œæ¯è¡Œ C ä¸ªå­—ç¬¦ã€‚ æ¯ä¸ªå­—ç¬¦è¡¨ç¤ºç©ºé—´çš„ä¸€ä¸ªå•å…ƒã€‚â€™#â€˜è¡¨ç¤ºä¸å¯é€šè¿‡å•å…ƒï¼Œâ€™.â€˜è¡¨ç¤ºç©ºç™½å•å…ƒã€‚ä½ çš„èµ·å§‹ä½ç½®åœ¨â€™Sâ€™ï¼Œå‡ºå£ä¸ºâ€™Eâ€™ã€‚ æ¯å±‚ç©ºé—´åéƒ½æœ‰ä¸€ä¸ªç©ºè¡Œã€‚Lï¼ŒR å’Œ C å‡ä¸º 0 æ—¶è¾“å…¥ç»“æŸã€‚ ","date":"2018-07-22","objectID":"/posts/poj-2251/:0:2","tags":["BFS","ACM","æœç´¢","POJ","C++","C"],"title":"poj-2251-Dungeon Masterï¼ˆä¸‰ç»´ bfs æœ€çŸ­è·¯ï¼‰","uri":"/posts/poj-2251/"},{"categories":["ACM"],"content":"Output - è¾“å‡º æ¯ä¸ªç©ºé—´å¯¹åº”ä¸€è¡Œè¾“å‡ºã€‚ å¦‚æœå¯ä»¥é€ƒç”Ÿï¼Œåˆ™è¾“å‡ºå¦‚ä¸‹ Escaped in x minute(s). x ä¸ºæœ€çŸ­è„±ç¦»æ—¶é—´ã€‚ å¦‚æœæ— æ³•é€ƒç”Ÿï¼Œåˆ™è¾“å‡ºå¦‚ä¸‹ Trapped! ","date":"2018-07-22","objectID":"/posts/poj-2251/:0:3","tags":["BFS","ACM","æœç´¢","POJ","C++","C"],"title":"poj-2251-Dungeon Masterï¼ˆä¸‰ç»´ bfs æœ€çŸ­è·¯ï¼‰","uri":"/posts/poj-2251/"},{"categories":["ACM"],"content":"Sample Input - è¾“å…¥æ ·ä¾‹ 3 4 5 S.... .###. .##.. ###.# ##### ##.## ##... ##### #.### ####E 1 3 3 S## #E# ### 0 0 0 ","date":"2018-07-22","objectID":"/posts/poj-2251/:0:4","tags":["BFS","ACM","æœç´¢","POJ","C++","C"],"title":"poj-2251-Dungeon Masterï¼ˆä¸‰ç»´ bfs æœ€çŸ­è·¯ï¼‰","uri":"/posts/poj-2251/"},{"categories":["ACM"],"content":"Sample Output - è¾“å‡ºæ ·ä¾‹ Escaped in 11 minute(s). Trapped! ç±»ä¼¼äºŒç»´å››ä¸ªæ–¹å‘çš„ bfs æœ€çŸ­è·¯ï¼Œæ”¹æˆä¸Šä¸‹ä¸œè¥¿å—åŒ—å°±è¡Œäº†ï¼Œä¸‰ç»´ bfs æœ€çŸ­è·¯ #include \u003ciostream\u003e #include \u003cstdio.h\u003e #include \u003cstring.h\u003e #include \u003cqueue\u003e #include \u003calgorithm\u003e using namespace std; char map[35][35][35]; int vis[35][35][35]; int k,n,m,sx,sy,sz,ex,ey,ez; int to[6][3] = {{0,0,1},{0,0,-1},{0,1,0},{0,-1,0},{1,0,0},{-1,0,0}};//ä¸Šä¸‹ä¸œè¥¿å—åŒ— struct node { int x,y,z,step; }; int check(int x,int y,int z)//æ£€æŸ¥æ˜¯å¦å¯èµ° { if(x\u003c0 || y\u003c0 || z\u003c0 || x\u003e=k || y\u003e=n || z\u003e=m)//è¶Šç•Œåˆ¤æ–­ return 1; else if(map[x][y][z] == '#') return 1; else if(vis[x][y][z]) return 1; return 0; } int bfs() { int i; node a,next; queue\u003cnode\u003e Q; a.x = sx,a.y = sy,a.z = sz; a.step = 0; vis[sx][sy][sz] = 1; Q.push(a); while(!Q.empty()) { a = Q.front(); Q.pop(); if(a.x == ex \u0026\u0026 a.y == ey \u0026\u0026 a.z == ez) return a.step; for(i = 0; i\u003c6; i++) { next = a; next.x = a.x+to[i][0]; next.y = a.y+to[i][1]; next.z = a.z+to[i][2]; if(check(next.x,next.y,next.z)) continue; vis[next.x][next.y][next.z] = 1; next.step = a.step+1; Q.push(next); } } return 0; } int main() { int i,j,r; while(scanf(\"%d%d%d\",\u0026k,\u0026n,\u0026m),n+m+k) { for(i = 0; i\u003ck; i++) { for(j = 0; j\u003cn; j++) { scanf(\"%s\",map[i][j]); for(r = 0; r\u003cm; r++) { if(map[i][j][r] == 'S') { sx = i,sy = j,sz = r; } else if(map[i][j][r] == 'E') { ex = i,ey = j,ez = r; } } } } memset(vis,0,sizeof(vis)); int ans; ans = bfs(); if(ans) printf(\"Escaped in %d minute(s).\\n\",ans); else printf(\"Trapped!\\n\"); } return 0; } ","date":"2018-07-22","objectID":"/posts/poj-2251/:0:5","tags":["BFS","ACM","æœç´¢","POJ","C++","C"],"title":"poj-2251-Dungeon Masterï¼ˆä¸‰ç»´ bfs æœ€çŸ­è·¯ï¼‰","uri":"/posts/poj-2251/"},{"categories":["ACM"],"content":"Time Limit: 1000MS Memory Limit: 10000K Total Submissions: 63659 Accepted: 30423 ","date":"2018-07-22","objectID":"/posts/poj-1321/:0:0","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1321 æ£‹ç›˜é—®é¢˜ï¼ˆdfsï¼‰","uri":"/posts/poj-1321/"},{"categories":["ACM"],"content":"Description åœ¨ä¸€ä¸ªç»™å®šå½¢çŠ¶çš„æ£‹ç›˜ï¼ˆå½¢çŠ¶å¯èƒ½æ˜¯ä¸è§„åˆ™çš„ï¼‰ä¸Šé¢æ‘†æ”¾æ£‹å­ï¼Œæ£‹å­æ²¡æœ‰åŒºåˆ«ã€‚è¦æ±‚æ‘†æ”¾æ—¶ä»»æ„çš„ä¸¤ä¸ªæ£‹å­ä¸èƒ½æ”¾åœ¨æ£‹ç›˜ä¸­çš„åŒä¸€è¡Œæˆ–è€…åŒä¸€åˆ—ï¼Œè¯·ç¼–ç¨‹æ±‚è§£å¯¹äºç»™å®šå½¢çŠ¶å’Œå¤§å°çš„æ£‹ç›˜ï¼Œæ‘†æ”¾ k ä¸ªæ£‹å­çš„æ‰€æœ‰å¯è¡Œçš„æ‘†æ”¾æ–¹æ¡ˆ Cã€‚ ","date":"2018-07-22","objectID":"/posts/poj-1321/:0:1","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1321 æ£‹ç›˜é—®é¢˜ï¼ˆdfsï¼‰","uri":"/posts/poj-1321/"},{"categories":["ACM"],"content":"Input è¾“å…¥å«æœ‰å¤šç»„æµ‹è¯•æ•°æ®ã€‚ æ¯ç»„æ•°æ®çš„ç¬¬ä¸€è¡Œæ˜¯ä¸¤ä¸ªæ­£æ•´æ•°ï¼Œn kï¼Œç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ï¼Œè¡¨ç¤ºäº†å°†åœ¨ä¸€ä¸ª n * n çš„çŸ©é˜µå†…æè¿°æ£‹ç›˜ï¼Œä»¥åŠæ‘†æ”¾æ£‹å­çš„æ•°ç›®ã€‚ n \u003c= 8 , k \u003c= n å½“ä¸º-1 -1 æ—¶è¡¨ç¤ºè¾“å…¥ç»“æŸã€‚ éšåçš„ n è¡Œæè¿°äº†æ£‹ç›˜çš„å½¢çŠ¶ï¼šæ¯è¡Œæœ‰ n ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­ # è¡¨ç¤ºæ£‹ç›˜åŒºåŸŸï¼Œ . è¡¨ç¤ºç©ºç™½åŒºåŸŸï¼ˆæ•°æ®ä¿è¯ä¸å‡ºç°å¤šä½™çš„ç©ºç™½è¡Œæˆ–è€…ç©ºç™½åˆ—ï¼‰ã€‚ ","date":"2018-07-22","objectID":"/posts/poj-1321/:0:2","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1321 æ£‹ç›˜é—®é¢˜ï¼ˆdfsï¼‰","uri":"/posts/poj-1321/"},{"categories":["ACM"],"content":"Output å¯¹äºæ¯ä¸€ç»„æ•°æ®ï¼Œç»™å‡ºä¸€è¡Œè¾“å‡ºï¼Œè¾“å‡ºæ‘†æ”¾çš„æ–¹æ¡ˆæ•°ç›® C ï¼ˆæ•°æ®ä¿è¯ C\u003c2^31ï¼‰ã€‚ ","date":"2018-07-22","objectID":"/posts/poj-1321/:0:3","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1321 æ£‹ç›˜é—®é¢˜ï¼ˆdfsï¼‰","uri":"/posts/poj-1321/"},{"categories":["ACM"],"content":"Sample Input 2 1 #. .# 4 4 ...# ..#. .#.. #... -1 -1 ","date":"2018-07-22","objectID":"/posts/poj-1321/:0:4","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1321 æ£‹ç›˜é—®é¢˜ï¼ˆdfsï¼‰","uri":"/posts/poj-1321/"},{"categories":["ACM"],"content":"Sample Output 2 1 ","date":"2018-07-22","objectID":"/posts/poj-1321/:0:5","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1321 æ£‹ç›˜é—®é¢˜ï¼ˆdfsï¼‰","uri":"/posts/poj-1321/"},{"categories":["ACM"],"content":"Source è”¡é”™@pku ","date":"2018-07-22","objectID":"/posts/poj-1321/:0:6","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1321 æ£‹ç›˜é—®é¢˜ï¼ˆdfsï¼‰","uri":"/posts/poj-1321/"},{"categories":["ACM"],"content":"æ€è·¯ ä¸‹å­æ–¹æ¡ˆæ•°å°±ç›¸å½“äºéå†å›¾çš„ä¸åŒéå†æ•°ï¼Œç”¨ dfs å˜å½¢ã€‚ ç†è§£ä»¥ä¸‹æ•°æ®è¿˜æœ‰æ ·ä¾‹åº”è¯¥å·®ä¸å¤šäº† 3 2 #.. .#. ..# 3 3 2 #.. .## ..# 4 ","date":"2018-07-22","objectID":"/posts/poj-1321/:0:7","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1321 æ£‹ç›˜é—®é¢˜ï¼ˆdfsï¼‰","uri":"/posts/poj-1321/"},{"categories":["ACM"],"content":"AC ä»£ç  #include\u003ciostream\u003e #include\u003ccstdio\u003e #include\u003ccstring\u003e #include\u003calgorithm\u003e using namespace std; char mp[8][8]; int v[8]; int n,k,w,r;//çŠ¶æ€è®¡æ•°å™¨ r void dfs(int x)//é€è¡Œæ·±æœï¼Œx ä¸ºå½“å‰æœç´¢è¡Œ { if(w==k)//ä¸‹å­æ•° w { r++;return; } if(x==n)return; for(int i=0;i\u003cn;i++) { if(v[i]!=1\u0026\u0026mp[x][i]=='#') { v[i]=1; w++; dfs(x+1); w--; v[i]=0; } } dfs(x+1);//æœç´¢ä¸‹ä¸€è¡Œ } int main() { while(cin\u003e\u003en\u003e\u003ek) { if(n==-1\u0026\u0026k==-1) return 0; memset(mp,0,sizeof(mp)); memset(v,0,sizeof(v)); for(int i=0;i\u003cn;i++) cin\u003e\u003emp[i]; w=0;r=0; dfs(0); cout\u003c\u003cr\u003c\u003cendl; } } ä¼ é€é—¨ ","date":"2018-07-22","objectID":"/posts/poj-1321/:0:8","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1321 æ£‹ç›˜é—®é¢˜ï¼ˆdfsï¼‰","uri":"/posts/poj-1321/"},{"categories":["ACM"],"content":"Find The Multiple Time Limit: 1000MS Memory Limit: 10000K Total Submissions: 40713 Accepted: 17088 Special Judge ","date":"2018-07-22","objectID":"/posts/poj-1426/:1:0","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1426-Find The Multiple(dfs)","uri":"/posts/poj-1426/"},{"categories":["ACM"],"content":"Description Given a positive integer n, write a program to find out a nonzero multiple m of n whose decimal representation contains only the digits 0 and 1. You may assume that n is not greater than 200 and there is a corresponding m containing no more than 100 decimal digits. ","date":"2018-07-22","objectID":"/posts/poj-1426/:1:1","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1426-Find The Multiple(dfs)","uri":"/posts/poj-1426/"},{"categories":["ACM"],"content":"Input The input file may contain multiple test cases. Each line contains a value of n (1 \u003c= n \u003c= 200). A line containing a zero terminates the input. ","date":"2018-07-22","objectID":"/posts/poj-1426/:1:2","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1426-Find The Multiple(dfs)","uri":"/posts/poj-1426/"},{"categories":["ACM"],"content":"Output For each value of n in the input print a line containing the corresponding value of m. The decimal representation of m must not contain more than 100 digits. If there are multiple solutions for a given value of n, any one of them is acceptable. ","date":"2018-07-22","objectID":"/posts/poj-1426/:1:3","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1426-Find The Multiple(dfs)","uri":"/posts/poj-1426/"},{"categories":["ACM"],"content":"Sample Input 2 6 19 0 ","date":"2018-07-22","objectID":"/posts/poj-1426/:1:4","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1426-Find The Multiple(dfs)","uri":"/posts/poj-1426/"},{"categories":["ACM"],"content":"Sample Output 10 100100100100100100 111111111111111111 ç»™å®šä¸€ä¸ªæ­£æ•´æ•° nï¼Œè¯·ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥å¯»æ‰¾ n çš„ä¸€ä¸ªéé›¶çš„å€æ•° mï¼Œè¿™ä¸ª m åº”å½“åœ¨åè¿›åˆ¶è¡¨ç¤ºæ—¶æ¯ä¸€ä½ä¸ŠåªåŒ…å« 0 æˆ–è€… 1ã€‚ä½ å¯ä»¥å‡å®š n ä¸å¤§äº 200 ä¸” m ä¸å¤šäº 100 ä½ã€‚ æç¤ºï¼šæœ¬é¢˜é‡‡ç”¨ Special Judgeï¼Œä½ æ— éœ€è¾“å‡ºæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ mï¼Œä½ åªéœ€è¦è¾“å‡ºä»»ä¸€ç¬¦åˆæ¡ä»¶çš„ m å³å¯ã€‚ #include\"iostream\" using namespace std; typedef unsigned long long ll; int n; bool sign; void dfs(ll x,int count) { if(sign) return ; if(x%n==0){ sign=true; cout\u003c\u003cx\u003c\u003cendl; return ; } if(count==19)//m æœ€å¤š 200 ä½ return ; dfs(x*10,count+1); dfs(x*10+1,count+1); //æ¯ä¸¤ä½æ•°åä¸¤ä½æœ‰ä¸¤ç§æƒ…å†µï¼Œ10 æˆ– 11ï¼Œæ·±æœæ‰€æœ‰æƒ…å†µï¼Œæ‰¾åˆ°ä¸€ç§å°±è¿”å›ï¼Œæ‰¾ä¸åˆ°æ‰¾å¦å¤–ä¸€é¢—å­æ ‘ } int main() { while(cin\u003e\u003en\u0026\u0026n) { sign=false; dfs(1,0); } return 0; } ","date":"2018-07-22","objectID":"/posts/poj-1426/:1:5","tags":["DFS","ACM","æœç´¢","POJ","C++"],"title":"poj-1426-Find The Multiple(dfs)","uri":"/posts/poj-1426/"},{"categories":["ACM"],"content":"Codeforces Round 498 (Div. 3) A. Adjacent Replacementsï¼ˆæ°´ï¼‰","date":"2018-07-22","objectID":"/posts/adjacent-replacements/","tags":["Codeforces","ACM","C++"],"title":"Adjacent Replacements","uri":"/posts/adjacent-replacements/"},{"categories":["ACM"],"content":"A. Adjacent Replacements ç¬¬ä¸€æ¬¡æ‰“ cf å°±åšå‡ºä¸€é“è¿™æ ·çš„æ‰¾è§„å¾‹çš„é¢˜ï¼Œæ‰“åˆ°è‡ªé—­ã€‚ #include\u003cbits/stdc++.h\u003e using namespace std; int main(){ int n,a[1001]; cin\u003e\u003en; int i; int flag=0; for(i=0;i\u003cn;i++){ cin\u003e\u003ea[i]; if(!(a[i]\u00261)) a[i]--; if(!flag) {cout\u003c\u003ca[i];flag=1;} else cout\u003c\u003c\" \"\u003c\u003ca[i]; } return 0; } ","date":"2018-07-22","objectID":"/posts/adjacent-replacements/:0:0","tags":["Codeforces","ACM","C++"],"title":"Adjacent Replacements","uri":"/posts/adjacent-replacements/"},{"categories":["ACM"],"content":"è¿·å®«é—®é¢˜ Time Limit: 1000MS Memory Limit: 65536K Total Submissions: 32323 Accepted: 18471 ","date":"2018-07-22","objectID":"/posts/poj-3984/:0:1","tags":["BFS","ACM","POJ","C++","C"],"title":"poj-3984-è¿·å®«é—®é¢˜ (bfs è·¯å¾„ï¼‰","uri":"/posts/poj-3984/"},{"categories":["ACM"],"content":"Description å®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼š int maze[5][5] = { 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, }; å®ƒè¡¨ç¤ºä¸€ä¸ªè¿·å®«ï¼Œå…¶ä¸­çš„ 1 è¡¨ç¤ºå¢™å£ï¼Œ0 è¡¨ç¤ºå¯ä»¥èµ°çš„è·¯ï¼Œåªèƒ½æ¨ªç€èµ°æˆ–ç«–ç€èµ°ï¼Œä¸èƒ½æ–œç€èµ°ï¼Œè¦æ±‚ç¼–ç¨‹åºæ‰¾å‡ºä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’çš„æœ€çŸ­è·¯çº¿ã€‚ ","date":"2018-07-22","objectID":"/posts/poj-3984/:0:2","tags":["BFS","ACM","POJ","C++","C"],"title":"poj-3984-è¿·å®«é—®é¢˜ (bfs è·¯å¾„ï¼‰","uri":"/posts/poj-3984/"},{"categories":["ACM"],"content":"Input ä¸€ä¸ª 5 Ã— 5 çš„äºŒç»´æ•°ç»„ï¼Œè¡¨ç¤ºä¸€ä¸ªè¿·å®«ã€‚æ•°æ®ä¿è¯æœ‰å”¯ä¸€è§£ã€‚ ","date":"2018-07-22","objectID":"/posts/poj-3984/:0:3","tags":["BFS","ACM","POJ","C++","C"],"title":"poj-3984-è¿·å®«é—®é¢˜ (bfs è·¯å¾„ï¼‰","uri":"/posts/poj-3984/"},{"categories":["ACM"],"content":"Output å·¦ä¸Šè§’åˆ°å³ä¸‹è§’çš„æœ€çŸ­è·¯å¾„ï¼Œæ ¼å¼å¦‚æ ·ä¾‹æ‰€ç¤ºã€‚ ","date":"2018-07-22","objectID":"/posts/poj-3984/:0:4","tags":["BFS","ACM","POJ","C++","C"],"title":"poj-3984-è¿·å®«é—®é¢˜ (bfs è·¯å¾„ï¼‰","uri":"/posts/poj-3984/"},{"categories":["ACM"],"content":"Sample Input 0 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 1 1 1 0 0 0 0 1 0 ","date":"2018-07-22","objectID":"/posts/poj-3984/:0:5","tags":["BFS","ACM","POJ","C++","C"],"title":"poj-3984-è¿·å®«é—®é¢˜ (bfs è·¯å¾„ï¼‰","uri":"/posts/poj-3984/"},{"categories":["ACM"],"content":"Sample Output (0, 0) (1, 0) (2, 0) (2, 1) (2, 2) (2, 3) (2, 4) (3, 4) (4, 4) å¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œä¸»è¦æ˜¯ bfs è·¯å¾„çš„é—®é¢˜æœ‰ç‚¹éš¾åº¦ï¼Œæå¾—æ™•æ™•çš„ã€‚ #include\u003ciostream\u003e #include\u003ccstring\u003e using namespace std; int map[5][5]; int visited[5][5]; int dx[4]={0, 1, 0, -1}; int dy[4]={ 1, 0,-1, 0}; int head,tail; struct node{ int xx,yy; int fa;//çˆ¶èŠ‚ç‚¹ }pre[25],way[25]; void BFS(int x,int y) { int x1,y1; head=0,tail=1; visited[x][y]=1; pre[0].xx=x,pre[0].yy=y; while(tail\u003ehead)//æ ˆç©º { x=pre[head].xx; y=pre[head].yy; if(x==4\u0026\u0026y==4)//ç»“æŸæ ‡å¿— return ; for(int i=0;i\u003c4;i++) { x1=x+dx[i];y1=y+dy[i]; if(x1\u003e=0\u0026\u0026x1\u003c=4\u0026\u0026y1\u003e=0\u0026\u0026y1\u003c=4) if(map[x1][y1]==0\u0026\u0026!visited[x1][y1]) { pre[tail].xx=x1; pre[tail].yy=y1; pre[tail].fa=head; visited[x1][y1]=1; tail+=1;//å…¥æ ˆ } } head++;//ç›¸å½“äºå‡ºæ ˆ } } int main() { int i,j; ios::sync_with_stdio(false); memset(map,0,sizeof(map)); memset(visited,0,sizeof(visited)); for(i=0;i\u003c5;i++) for(j=0;j\u003c5;j++) cin\u003e\u003emap[i][j]; BFS(0,0); i=0; while(head)//é€†åºè¿›è¡Œèµ‹å€¼è¾“å‡ºå°±æ˜¯é€šè·¯ { way[i].xx=pre[head].xx; way[i].yy=pre[head].yy; head=pre[head].fa; i++; } //ç”»ä¸€ä¸‹é˜Ÿåˆ— way[i].xx=0;way[i].yy=0; while(i!=-1) { cout\u003c\u003c\"(\"\u003c\u003cway[i].xx\u003c\u003c\", \"\u003c\u003cway[i].yy\u003c\u003c\")\"\u003c\u003cendl; i--; } return 0; } ","date":"2018-07-22","objectID":"/posts/poj-3984/:0:6","tags":["BFS","ACM","POJ","C++","C"],"title":"poj-3984-è¿·å®«é—®é¢˜ (bfs è·¯å¾„ï¼‰","uri":"/posts/poj-3984/"},{"categories":["ACM"],"content":"é“¾æ¥ï¼šhttps://www.nowcoder.com/acm/contest/133/A æ¥æºï¼šç‰›å®¢ç½‘ ","date":"2018-07-22","objectID":"/posts/wannafly-20/:0:0","tags":["ACM","Nowcoder","C++","C"],"title":"Wannafly æŒ‘æˆ˜èµ› 20-æŸ“è‰²","uri":"/posts/wannafly-20/"},{"categories":["ACM"],"content":"é¢˜ç›®æè¿° ç°åœ¨æœ‰ä¸€æ£µè¢« Samsara-Karma æŸ“äº† k ç§é¢œè‰²çš„æ ‘ï¼Œæ¯ç§é¢œè‰²æœ‰ç€ä¸åŒçš„ä»·å€¼ï¼ŒApplese è§‰å¾— Samsara-Karma æŸ“çš„å¤ªéš¾çœ‹äº†ï¼Œäºæ˜¯æ‰“ç®—æŠŠæ•´æ£µæ ‘é‡æ–°æŸ“æˆåŒä¸€ç§é¢œè‰²ï¼Œä½†æ˜¯ï¼Œç”±äºä¸€äº›å¥¥å¦™é‡é‡çš„åŸå› ï¼Œæ¯ä¸€æ¬¡æŸ“è‰² Applese å¯ä»¥é€‰æ‹©ä¸¤ä¸ªæœ‰è¾¹ç›¸è¿çš„ç‚¹ï¼Œå°†å…¶ä¸­ä¸€ä¸ªæŸ“æˆå¦ä¸€ä¸ªçš„é¢œè‰²ã€‚è€Œè¿›è¡Œä¸€æ¬¡è¿™æ ·çš„æ“ä½œéœ€è¦ä»˜å‡ºä¸¤ç§é¢œè‰²ä»·å€¼å’Œçš„ä»£ä»·ï¼Œ ç°åœ¨ï¼ŒApplese çš„é’±è¦ç”¨æ¥ä¹°ä¹¦ (game)ï¼Œæ‰€ä»¥ä»–æƒ³è¦æœ€å°åŒ–ä»£ä»· ","date":"2018-07-22","objectID":"/posts/wannafly-20/:0:1","tags":["ACM","Nowcoder","C++","C"],"title":"Wannafly æŒ‘æˆ˜èµ› 20-æŸ“è‰²","uri":"/posts/wannafly-20/"},{"categories":["ACM"],"content":"è¾“å…¥æè¿°ï¼š è¾“å…¥åŒ…æ‹¬è‹¥å¹²è¡Œç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ•° nï¼Œè¡¨ç¤ºè¿™æ£µæ ‘æœ‰ n ä¸ªèŠ‚ç‚¹ç¬¬äºŒè¡ŒåŒ…æ‹¬ n ä¸ªæ•°ï¼Œç¬¬ i ä¸ªæ•°è¡¨ç¤ºç¬¬ i ä¸ªèŠ‚ç‚¹çš„é¢œè‰² coli æ³¨æ„ï¼šä¸€ä¸ªé¢œè‰²çš„æ ‡å·å³ä»·å€¼æ¥ä¸‹æ¥çš„ n - 1 è¡Œï¼Œæ¯è¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ•° u, vï¼Œè¡¨ç¤º u èŠ‚ç‚¹ä¸ v èŠ‚ç‚¹ä¹‹é—´æœ‰ä¸€æ¡æ— å‘è¾¹ n â‰¤ 100000, 1 â‰¤ coli â‰¤ 1e9ï¼Œæ•°æ®ä¿è¯æ˜¯ä¸€æ£µæ ‘ ","date":"2018-07-22","objectID":"/posts/wannafly-20/:0:2","tags":["ACM","Nowcoder","C++","C"],"title":"Wannafly æŒ‘æˆ˜èµ› 20-æŸ“è‰²","uri":"/posts/wannafly-20/"},{"categories":["ACM"],"content":"è¾“å‡ºæè¿°ï¼š è¾“å‡ºåŒ…æ‹¬ä¸€è¡Œç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ•°ï¼Œè¡¨ç¤ºæœ€å°ä»£ä»· ","date":"2018-07-22","objectID":"/posts/wannafly-20/:0:3","tags":["ACM","Nowcoder","C++","C"],"title":"Wannafly æŒ‘æˆ˜èµ› 20-æŸ“è‰²","uri":"/posts/wannafly-20/"},{"categories":["ACM"],"content":"ç¤ºä¾‹ 1 è¾“å…¥ 4 2 3 4 3 1 2 2 3 3 4 è¾“å‡º 12 è’Ÿè’»æš´åŠ›æšä¸¾-_-! #include \u003cbits/stdc++.h\u003e using namespace std; const int MAXN=1e5+10; int a[MAXN]; map\u003cint, int \u003ema; set\u003cint\u003ese; int x[MAXN],y[MAXN]; int main() { int n; scanf(\"%d\",\u0026n); for (int i = 1; i \u003c=n ; ++i) { scanf(\"%d\",\u0026a[i]); se.insert(a[i]); } for (int i = 1; i \u003cn ; ++i) { scanf(\"%d%d\",\u0026x[i],\u0026y[i]); } long long ans=1e14,sum=0; set\u003cint\u003e::iterator it; for (it=se.begin(); it !=se.end() ; ++it) { sum=0; for (int j = 1; j \u003c=n ; ++j) { if((*it)!=a[j]) sum+=((*it)+a[j]); } ans=min(sum,ans); } printf(\"%lld\\n\",ans); return 0; } æœ€åæƒ³è¯´è¿™éƒ½è¿‡äº†ä»€ä¹ˆé¬¼ï¼Œä¸ä¼šæ•°æ®è¿™ä¹ˆå¼±å§ï¼Ÿï¼Ÿï¼? æˆ‘åªæšä¸¾äº†æœ€å°çš„ä»·å€¼é¢œè‰²çš„æƒ…å†µï¼Œå”‰ï¼Œä¸ç®¡äº†ä¸ç®¡äº†ã€‚ #include\u003cbits/stdc++.h\u003e using namespace std; int a[1000000],n,m,k=1,t,ans=0; int main() { scanf(\"%d\",\u0026n); for(int i=1;i\u003c=n;++i) scanf(\"%d\",\u0026a[i]); sort(a+1,a+n+1); for(int i=2;i\u003c=n;++i) if(a[i]!=a[1]) ans+=a[i]+a[1]; printf(\"%d\",ans); return 0; } ","date":"2018-07-22","objectID":"/posts/wannafly-20/:0:4","tags":["ACM","Nowcoder","C++","C"],"title":"Wannafly æŒ‘æˆ˜èµ› 20-æŸ“è‰²","uri":"/posts/wannafly-20/"},{"categories":["ACM"],"content":"Oil Deposits ç¿»è¯‘ Time Limit: 2000/1000 MS (Java/Others) Memory Limit: 65536/32768 K (Java/Others) Total Submission(s): 41406 Accepted Submission(s): 23977 Problem Description The GeoSurvComp geologic survey company is responsible for detecting underground oil deposits. GeoSurvComp works with one large rectangular region of land at a time, and creates a grid that divides the land into numerous square plots. It then analyzes each plot separately, using sensing equipment to determine whether or not the plot contains oil. A plot containing oil is called a pocket. If two pockets are adjacent, then they are part of the same oil deposit. Oil deposits can be quite large and may contain numerous pockets. Your job is to determine how many different oil deposits are contained in a grid. Input The input file contains one or more grids. Each grid begins with a line containing m and n, the number of rows and columns in the grid, separated by a single space. If m = 0 it signals the end of the input; otherwise 1 \u003c= m \u003c= 100 and 1 \u003c= n \u003c= 100. Following this are m lines of n characters each (not counting the end-of-line characters). Each character corresponds to one plot, and is either â€™ * â€˜, representing the absence of oil, or â€˜@â€™, representing an oil pocket. Output For each grid, output the number of distinct oil deposits. Two different pockets are part of the same oil deposit if they are adjacent horizontally, vertically, or diagonally. An oil deposit will not contain more than 100 pockets. Sample Input 1 1 * 3 5 *@*@* **@** *@*@* 1 8 @@****@* 5 5 ****@ *@@*@ *@**@ @@@*@ @@**@ 0 0 Sample Output 0 1 2 Source Mid-Central USA 1997 Recommend Eddy | We have carefully selected several similar problems for you: 1016 1010 1312 1242 1240 æ€è·¯ dfs æ¨¡æ¿é¢˜å§ï¼Œå…«ä¸ªæ–¹å‘æœç´¢ï¼›ï¼ˆåƒ iï¼Œj è¿™æ ·çš„è®¡æ•°å™¨è¿˜æ˜¯å†™åœ¨å±€éƒ¨æ¯”è¾ƒå¥½ï¼Œæˆ‘å°½ç„¶è¢«å®šä¹‰åŸŸçš„é—®é¢˜æäº†ä¸€æ™šä¸Šé†‰äº†é†‰äº†ã€‚ï¼‰ #include\u003cbits/stdc++.h\u003e using namespace std; int n,m,s; char maze[107][107]; int vx[8]={-1,1,0,0,-1,-1,1,1}; int vy[8]={0,0,-1,1,-1,1,1,-1}; void dfs(int x,int y){ maze[x][y]='*'; for(int i=0;i\u003c8;i++){ int tx=x+vx[i]; int ty=y+vy[i]; if(tx\u003e=0\u0026\u0026tx\u003cm\u0026\u0026ty\u003e=0\u0026\u0026ty\u003cn\u0026\u0026maze[tx][ty]=='@') dfs(tx,ty); } } int main(){ int i,j; while(cin\u003e\u003em\u003e\u003en\u0026\u0026m){ s=0; for(i=0;i\u003cm;i++) cin\u003e\u003emaze[i]; for(i=0;i\u003cm;i++){//ç›¸å½“äºä¸è¿é€šçš„æƒ…å†µ for(j=0;j\u003cn;j++){ if(maze[i][j]=='@'){ dfs(i,j); s++; } } } cout\u003c\u003cs\u003c\u003cendl; } return 0; } ","date":"2018-07-22","objectID":"/posts/hdu-1241/:1:0","tags":["DFS","æœç´¢","HDU","ACM","C++"],"title":"hdu-1241-Oil Deposits (dfs)","uri":"/posts/hdu-1241/"},{"categories":["ACM"],"content":"å‡è®¾æœ‰ä¸€ä¸ª n è¡Œ m åˆ—çš„è¿·å®«ï¼Œæ¯ä¸ªå•ä½è¦ä¹ˆæ˜¯ç©ºåœ°ï¼ˆç”¨ 1 è¡¨ç¤ºï¼‰è¦ä¹ˆæ˜¯éšœç¢ç‰©ï¼ˆç”¨ 0 è¡¨ç¤ºï¼‰. å¦‚ä½•æ‰¾åˆ°ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Ÿåˆ©ç”¨ BFS æœç´¢ï¼Œé€æ­¥è®¡ç®—å‡ºæ¯ä¸ªèŠ‚ç‚¹åˆ°èµ·ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œ ä»¥åŠæœ€çŸ­è·¯å¾„æ¯ä¸ªèŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚æœ€ç»ˆå°†ç”Ÿæˆä¸€é¢—ä»¥èµ·ç‚¹ä¸ºæ ¹çš„ BFS æ ‘ã€‚æ­¤æ—¶ BFS å¯ä»¥æ±‚å‡ºä»»æ„ä¸€ç‚¹åˆ°èµ·ç‚¹çš„è·ç¦»ã€‚ ","date":"2018-07-22","objectID":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/:0:0","tags":["BFS","æœç´¢","C++"],"title":"BFS æ±‚æœ€çŸ­è·¯","uri":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/"},{"categories":["ACM"],"content":"å›¾ 1 3 0 21 23 2 0 17 20 22 4 0 14 0 0 5 0 12 15 18 6 8 10 0 19 7 9 11 13 16 ","date":"2018-07-22","objectID":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/:1:0","tags":["BFS","æœç´¢","C++"],"title":"BFS æ±‚æœ€çŸ­è·¯","uri":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/"},{"categories":["ACM"],"content":"è¾“å…¥ 6 5 1 1 0 1 1 1 0 1 1 1 1 0 1 0 0 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 ","date":"2018-07-22","objectID":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/:2:0","tags":["BFS","æœç´¢","C++"],"title":"BFS æ±‚æœ€çŸ­è·¯","uri":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/"},{"categories":["ACM"],"content":"è¾“å‡º 1 2 4 5 6 8 10 12 14 17 20 21 23 12//æœ€çŸ­è·ç¦» ","date":"2018-07-22","objectID":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/:3:0","tags":["BFS","æœç´¢","C++"],"title":"BFS æ±‚æœ€çŸ­è·¯","uri":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/"},{"categories":["ACM"],"content":"ä»£ç  #include\u003ciostream\u003e #include\u003cqueue\u003e #include\u003ccstdio\u003e #include\u003ccstring\u003e #include\u003cvector\u003e using namespace std; const int maxn=100+5; int G[maxn][maxn]; //å­˜å›¾çš„ d=id int path[maxn]; //å­˜æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œå³è·¯å¾„ int n,m; //n è¡Œ m åˆ— int k=1;//è®°å½•ç¼–å· int end_num; int vx[5] = {-1,1,0,0}; //vx vy ç”¨æ¥è®¡ç®—ä¸€ä¸ªèŠ‚ç‚¹å‘¨å›´ä¸Šä¸‹å·¦å³ 4 ä¸ªèŠ‚ç‚¹ int vy[5] = {0,0,-1,1}; bool vis[maxn][maxn]; //åˆ¤æ–­æŸèŠ‚ç‚¹æ˜¯å¦å·²ç»è¢«è®¿é—®è¿‡ struct node { int x; int y; int id; int parent=0; node(int a,int b,int c) { x=a; y=b; id=c; } }; int main() { //freopen(\"in.txt\",\"r\",stdin); memset(G,0,sizeof(G)); memset(vis,0,sizeof(vis)); memset(path,0,sizeof(path)); cin\u003e\u003en\u003e\u003em; for(int i=1; i\u003c=n; i++) for(int j=1; j\u003c=m; j++) { cin\u003e\u003eG[i][j]; } queue\u003cnode\u003e q; node v=node(1,1,1); q.push(v); vis[1][1]=1; while(!q.empty()) { node u=q.front(); q.pop(); path[u.id]=u.parent;//è®°å½•æ¯ä¸ªç‚¹çš„çˆ¶èŠ‚ç‚¹ for(int i=0; i\u003c4; i++) { int tx=u.x+vx[i]; int ty=u.y+vy[i]; if(G[tx][ty]\u0026\u0026!vis[tx][ty])//æœ‰è·¯å¯èµ°ä¸”æœªè®¿é—® { vis[tx][ty]=1; //cout\u003c\u003ctx\u003c\u003cty\u003c\u003cendl; node v=node(tx,ty,++k); end_num=k; v.parent=u.id; q.push(v); } } } vector\u003cint\u003e ans; //cout\u003c\u003cend_num\u003c\u003cendl; while(end_num)//ä»åé¢å¼€å§‹æ‰¾çˆ¶äº²èŠ‚ç‚¹ { ans.push_back(end_num); end_num=path[end_num]; } int s=0; while(!ans.empty()) { s++; cout\u003c\u003c*(ans.end()-1)\u003c\u003c' ';//ans æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ 0 ans.pop_back(); } cout\u003c\u003cendl\u003c\u003cs-1; return 0; } ","date":"2018-07-22","objectID":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/:4:0","tags":["BFS","æœç´¢","C++"],"title":"BFS æ±‚æœ€çŸ­è·¯","uri":"/posts/bfs%E6%B1%82%E6%9C%80%E7%9F%AD%E8%B7%AF/"},{"categories":["ACM"],"content":"é‚£å¤©æ™šä¸ŠæŠ¥åäº†æ²¡æ‰“ï¼Œç¬¬äºŒå¤©æ—©ä¸Šæ‰“çš„ï¼Œä¹Ÿåªå‡ºäº†ä¸¤é¢˜ã€‚ ","date":"2018-07-22","objectID":"/posts/cf-1009/:0:0","tags":["Codeforces","ACM","C++","C"],"title":"Educational Codeforces Round 47 (Rated for Div. 2)","uri":"/posts/cf-1009/"},{"categories":["ACM"],"content":"A. Game Shopping #include\u003ciostream\u003e using namespace std; int main(){ int n,m,s=0; cin\u003e\u003en\u003e\u003em; int i,j; int c[1000],a[1000]; for(i=0;i\u003cn;i++) cin\u003e\u003ec[i]; for(i=0;i\u003cm;i++) cin\u003e\u003ea[i]; for(i=0,j=0;i\u003cn;){ if(j==m) break; if(c[i]\u003c=a[j]){ s++; j++; i++; } else i++; } if(i==n\u0026\u0026s==0) cout\u003c\u003c\"0\\n\"; else cout\u003c\u003cs\u003c\u003cendl; return 0; } ","date":"2018-07-22","objectID":"/posts/cf-1009/:1:0","tags":["Codeforces","ACM","C++","C"],"title":"Educational Codeforces Round 47 (Rated for Div. 2)","uri":"/posts/cf-1009/"},{"categories":["ACM"],"content":"B. Minimum Ternary String #include \u003cbits/stdc++.h\u003e using namespace std; string s, ans; int main(){ cin \u003e\u003e s; int one = 0; for (int i = 0; i \u003c s.size(); i++){ if (s[i] == '0') ans += \"0\"; if (s[i] == '1') one++; if (s[i] == '2') ans += \"2\"; } bool flag = false; for (int i = 0; i \u003c ans.size(); i++){ if (ans[i] == '2' \u0026\u0026 !flag) flag = true, cout \u003c\u003c string(one, '1'); cout \u003c\u003c ans[i]; } if (!flag) cout \u003c\u003c string(one, '1'); return 0; } /* 100210 11222121 20 2001 020201 2012101 111 000 */ ","date":"2018-07-22","objectID":"/posts/cf-1009/:2:0","tags":["Codeforces","ACM","C++","C"],"title":"Educational Codeforces Round 47 (Rated for Div. 2)","uri":"/posts/cf-1009/"},{"categories":["ACM"],"content":" 2018 å¹´å…¨å›½å¤šæ ¡ç®—æ³•å¯’å‡è®­ç»ƒè¥ç»ƒä¹ æ¯”èµ›ï¼ˆç¬¬äºŒåœºï¼‰B(0 1 èƒŒåŒ…å˜åŒ– ç‰¹æ®Šå¤„ç†ä¸€ä¸ªç‰©å“ï¼‰ é“¾æ¥ï¼šhttps://www.nowcoder.com/acm/contest/74/B æ¥æºï¼šç‰›å®¢ç½‘ ","date":"2018-07-22","objectID":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/:0:0","tags":["èƒŒåŒ…é—®é¢˜","Nowcoder","C++"],"title":"TaoTao è¦åƒé¸¡","uri":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/"},{"categories":["ACM"],"content":"é¢˜ç›®æè¿° Taotao çš„ç”µè„‘å¸¦ä¸åŠ¨ç»åœ°æ±‚ç”Ÿï¼Œæ‰€ä»¥ taotao åªèƒ½å»ç© pc ç‰ˆçš„è’é‡è¡ŒåŠ¨äº†ï¼Œ å’Œç»åœ°æ±‚ç”Ÿä¸€æ ·ï¼Œæ¸¸æˆäººç‰©æœ¬èº«å¯ä»¥æºå¸¦ä¸€å®šé‡é‡ m çš„ç‰©å“ï¼Œè£…å¤‡èƒŒåŒ… ä¹‹åå¯ä»¥å¤šæºå¸¦ hï¼ˆh ä¸º 0 ä»£è¡¨æ²¡æœ‰è£…å¤‡èƒŒåŒ…ï¼‰é‡é‡çš„ä¸œè¥¿ã€‚ç©äº†å‡ å¤© taotao å‘ç°äº†ä¸€ä¸ª BUGï¼Œå½“è£…å¤‡èƒŒåŒ…ä¹‹åï¼Œå¦‚æœå¯æºå¸¦é‡é‡æ²¡æœ‰æ»¡ï¼Œå°± å¯ä»¥æ‹¿ä¸€ä¸ªä»»æ„é‡çš„ä¸œè¥¿ã€‚ï¼ˆè§£é‡Šçœ‹æ ·ä¾‹ï¼‰æœ‰ä¸€å¤© taotao ç©ºé™åˆ°äº†ä¸€ä¸ª å¥‡æ€ªçš„å²›ä¸Šï¼Œå²›ä¸Šæœ‰ n ä»¶è£…å¤‡ï¼Œæ¯ä¸ªè£…å¤‡éƒ½æœ‰é‡é‡ Wi å’Œå¨åŠ›å€¼ Vi, ä½† taotao ä¸è®¤è¯†è¿™äº›è£…å¤‡ï¼Œæ‰€ä»¥ä»–æ¥æ±‚åŠ©ä½ ï¼ŒæŒ‘é€‰å¨åŠ›æœ€å¤§çš„è£…å¤‡ï¼Œå¸®åŠ©ä»–åƒé¸¡ã€‚ ","date":"2018-07-22","objectID":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/:0:1","tags":["èƒŒåŒ…é—®é¢˜","Nowcoder","C++"],"title":"TaoTao è¦åƒé¸¡","uri":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/"},{"categories":["ACM"],"content":"è¾“å…¥æè¿°ï¼š æœ¬é¢˜æœ‰å¤šç»„è¾“å…¥ï¼ˆå°äº 10ï¼‰ï¼Œå½“ n=0 æ—¶ç»“æŸè¾“å…¥ã€‚ç¬¬ä¸€è¡Œè¾“å…¥ n,m,hã€‚nï¼Œmï¼Œh ä¸ºæ•´æ•°ï¼Œå¹¶ä¸” 0\u003c=n,m,h\u003c=100ï¼Œæ¥ä¸‹æ¥ n è¡Œï¼Œæ¯è¡Œè¾“å…¥ç¬¬ i ä¸ªç‰©å“çš„ç‰©å“çš„é‡é‡ Wi å’Œå¨åŠ›å€¼ Viã€‚0\u003c=Wi,Vi\u003c=100. ","date":"2018-07-22","objectID":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/:0:2","tags":["èƒŒåŒ…é—®é¢˜","Nowcoder","C++"],"title":"TaoTao è¦åƒé¸¡","uri":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/"},{"categories":["ACM"],"content":"è¾“å‡ºæè¿°ï¼š è¾“å‡ºæœ€å¤§å¨åŠ›å€¼ï¼Œæ¯ç»„è¾“å‡ºä¸€è¡Œã€‚ ","date":"2018-07-22","objectID":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/:0:3","tags":["èƒŒåŒ…é—®é¢˜","Nowcoder","C++"],"title":"TaoTao è¦åƒé¸¡","uri":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/"},{"categories":["ACM"],"content":"ç¤ºä¾‹ 1 è¾“å…¥ 3 3 3 2 3 3 2 2 3 0 è¾“å‡º 8 ","date":"2018-07-22","objectID":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/:0:4","tags":["èƒŒåŒ…é—®é¢˜","Nowcoder","C++"],"title":"TaoTao è¦åƒé¸¡","uri":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/"},{"categories":["ACM"],"content":"è¯´æ˜ å¯æºå¸¦çš„æ€»é‡é‡ä¸º 6ï¼Œå½“æ‹¿äº†å‰ä¸¤ä»¶è£…å¤‡ï¼Œæ­¤æ—¶å®¹é‡ä¸º 5/6ï¼Œè¿˜å¯ä»¥å†æ‹¿ç¬¬ä¸‰ä»¶ç‰©å“ã€‚ æ€è·¯ï¼š0-1 èƒŒåŒ…çš„å˜å½¢é¢˜ç›®ï¼Œh=0 çš„æ—¶å€™ä¸ºèƒŒåŒ…çš„æ¨¡æ¿ï¼Œhï¼=0 çš„æ—¶å€™æšä¸¾æ¯ä¸€ä¸ªéœ€è¦ç‰¹æ®Šå¤„ç†çš„ç‰©å“å†èƒŒåŒ… #include \u003cbits/stdc++.h\u003e using namespace std; int v[105]; int w[105]; int n,m,h; int dp[205]; int main() { while(scanf(\"%d\",\u0026n)==1\u0026\u0026n!=0){ int sum=0; scanf(\"%d%d\",\u0026m,\u0026h); for(int i=1;i\u003c=n;i++) scanf(\"%d%d\",\u0026w[i],\u0026v[i]); if(h==0){ memset(dp,0,sizeof(dp)); for(int i=1;i\u003c=n;i++) //å‰ i ä¸ªç‰©å“ for(int j=m;j\u003e=w[i];j--) //æšä¸¾èƒŒåŒ…é‡é‡ dp[j]=max(dp[j],dp[j-w[i]]+v[i]); // sum=dp[m]; } else{ m+=h for(int k=1;k\u003c=n;k++) //æšä¸¾å¯ä»¥è¢«å‰©ä¸‹çš„ç‰©å“ { memset(dp,0,sizeof(dp)); for(int i=1;i\u003c=n;i++){ //å‰ i ä¸ªç‰©å“ if(i!=k){ for(int j=m;j\u003e=w[i];j--) //æšä¸¾èƒŒåŒ…é‡é‡ dp[j]=max(dp[j],dp[j-w[i]]+v[i]); } } //ç•™ä¸‹æ¥ä¸€ä¸ªé‡é‡ï¼Œå³åˆå§‹åŒ–å¨åŠ›ä¸ºé‚£ä¸ªé‡é‡çš„å¨åŠ› for(int j=m-1;j\u003e=m-w[k];j--) //æšä¸¾èƒŒåŒ…é‡é‡+å‰©ä¸‹ç‰©å“ dp[m]=max(dp[m],dp[j]+v[k]); // printf(\"%d\\n\",dp[m]); sum=max(sum,dp[m]); } } printf(\"%d\\n\",sum); } return 0; } ","date":"2018-07-22","objectID":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/:0:5","tags":["èƒŒåŒ…é—®é¢˜","Nowcoder","C++"],"title":"TaoTao è¦åƒé¸¡","uri":"/posts/taotao%E8%A6%81%E5%90%83%E9%B8%A1/"},{"categories":["ACM"],"content":"ç™¾åº¦çŸ¥é“ 1 1 1 1 2 1 1 3 3 1 1 4 6 4 1 1 5 10 10 5 1 1 6 15 20 15 6 1 1ã€æ¯è¡Œæ•°å­—å·¦å³å¯¹ç§°ï¼Œç”± 1 å¼€å§‹é€æ¸å˜å¤§ï¼Œç„¶åå˜å°ï¼Œå›åˆ° 1ã€‚ 2ã€ç¬¬ n è¡Œçš„æ•°å­—ä¸ªæ•°ä¸º n ä¸ªã€‚ 3ã€ç¬¬ n è¡Œæ•°å­—å’Œä¸º 2^(nï¼1)ã€‚ 4ã€æ¯ä¸ªæ•°å­—ç­‰äºä¸Šä¸€è¡Œçš„å·¦å³ä¸¤ä¸ªæ•°å­—ä¹‹å’Œã€‚å¯ç”¨æ­¤æ€§è´¨å†™å‡ºæ•´ä¸ªå¸•æ–¯å¡ä¸‰è§’å½¢ã€‚ 5ã€å°†ç¬¬ 2n+1 è¡Œç¬¬ 1 ä¸ªæ•°ï¼Œè·Ÿç¬¬ 2n+2 è¡Œç¬¬ 3 ä¸ªæ•°ã€ç¬¬ 2n+3 è¡Œç¬¬ 5 ä¸ªæ•°â€¦â€¦è¿æˆä¸€çº¿ï¼Œè¿™äº›æ•°çš„å’Œæ˜¯ç¬¬ 2n ä¸ªæ–æ³¢é‚£å¥‘æ•°ã€‚å°†ç¬¬ 2n è¡Œç¬¬ 2 ä¸ªæ•°ï¼Œè·Ÿç¬¬ 2n+1 è¡Œç¬¬ 4 ä¸ªæ•°ã€ç¬¬ 2n+2 è¡Œç¬¬ 6 ä¸ªæ•°â€¦â€¦è¿™äº›æ•°ä¹‹å’Œæ˜¯ç¬¬ 2n-1 ä¸ªæ–æ³¢é‚£å¥‘æ•°ã€‚ 6ã€ç¬¬ n è¡Œçš„ç¬¬ 1 ä¸ªæ•°ä¸º 1ï¼Œç¬¬äºŒä¸ªæ•°ä¸º 1Ã—(n-1)ï¼Œç¬¬ä¸‰ä¸ªæ•°ä¸º 1Ã—(n-1)Ã—ï¼ˆn-2ï¼‰/2ï¼Œç¬¬å››ä¸ªæ•°ä¸º 1Ã—(n-1)Ã—ï¼ˆn-2ï¼‰/2Ã—ï¼ˆn-3ï¼‰/3â€¦ä¾æ­¤ç±»æ¨ã€‚ æ­¤æ•°åˆ—ä¸­å„è¡Œä¸­çš„æ•°å­—æ­£å¥½æ˜¯äºŒé¡¹å¼ a+b ä¹˜æ–¹åï¼Œå±•å¼€å§‹ç»ˆå„é¡¹çš„ç³»æ•°ã€‚å¦‚ï¼š (a+b)^1=a^1+b^1 (a+b)^2=a^2+2ab+b^2 (a+b)^3=a^3+3a^2b+3ab^2+b^3 â€¦â€¦ (a+b)^6=a^6+6a^5b+15a^4b^2+20a^3b^3+15a^2b^4+6ab^5+b^6ï¼ˆæ³¨æ„å‘ç°è§„å¾‹ï¼‰ â€¦â€¦ äºŒé¡¹å¼å±•å¼€å¼ï¼š ","date":"2018-07-22","objectID":"/posts/%E6%9D%A8%E8%BE%89%E4%B8%89%E8%A7%92/:0:0","tags":["æ•°å­¦","æ¨è¾‰ä¸‰è§’"],"title":"æ¨è¾‰ä¸‰è§’","uri":"/posts/%E6%9D%A8%E8%BE%89%E4%B8%89%E8%A7%92/"},{"categories":["ACM"],"content":"å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ å¹¿åº¦ä¼˜å…ˆæœç´¢åœ¨è¿›ä¸€æ­¥éå†å›¾ä¸­é¡¶ç‚¹ä¹‹å‰ï¼Œå…ˆè®¿é—®å½“å‰é¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥ç»“ç‚¹ã€‚è®¿é—®äº†å°±å…¥é˜Ÿã€‚ ","date":"2018-07-22","objectID":"/posts/dfs_bfs/:0:1","tags":["ACM","BFS","DFS","æœç´¢","C","C++"],"title":"æ·±æœå¹¿æœ","uri":"/posts/dfs_bfs/"},{"categories":["ACM"],"content":"æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ æ·±åº¦ä¼˜å…ˆæœç´¢åœ¨æœç´¢è¿‡ç¨‹ä¸­è®¿é—®æŸä¸ªé¡¶ç‚¹åï¼Œéœ€è¦é€’å½’åœ°è®¿é—®æ­¤é¡¶ç‚¹çš„æ‰€æœ‰æœªè®¿é—®è¿‡çš„ç›¸é‚»é¡¶ç‚¹ã€‚ #include \u003cbits/stdc++.h\u003e #define N 5 using namespace std; int maze[N][N] = {//æ— æƒæœ‰å‘å›¾é‚»æ¥çŸ©é˜µ { 0, 1, 0, 1, 0 }, { 0, 0, 1, 0, 0 }, { 0, 0, 0, 0, 1 }, { 0, 0, 1, 0, 0 }, { 0, 0, 0, 0, 0 } }; int visited[N]; void DFS(int start) { cout \u003c\u003c start\u003c\u003c \" \"; visited[start] = 1; for (int i = 0; i \u003c N; i++) { if (!visited[i] \u0026\u0026 maze[start][i] == 1)//æ²¡è®¿é—®è¿‡ä¸”ä¸ºé‚»å±…èŠ‚ç‚¹ DFS(i); } } void BFS(int start){ queue\u003cint\u003e Q;//é˜Ÿåˆ— Q.push(start); visited[start] = 1; while (!Q.empty()) { int front = Q.front();//å¤´ cout \u003c\u003c front \u003c\u003c \" \"; Q.pop(); for (int i = 0; i \u003cN; i++) { if (!visited[i] \u0026\u0026 maze[front][i] == 1) { visited[i] = 1; Q.push(i); } } } } int main() { memset(visited,0,sizeof(visited)); for (int i = 0; i \u003c N; i++)//ä¸è¿é€šçš„æƒ…å†µ { if (visited[i] == 1)//è®¿é—®è¿‡ continue; DFS(i); } cout\u003c\u003cendl; memset(visited,0,sizeof(visited)); for (int i = 0; i \u003c N; i++)//ä¸è¿é€šçš„æƒ…å†µ { if (visited[i] == 1)//è®¿é—®è¿‡ continue; BFS(i); } return 0; } ä¼ é€é—¨ ","date":"2018-07-22","objectID":"/posts/dfs_bfs/:0:2","tags":["ACM","BFS","DFS","æœç´¢","C","C++"],"title":"æ·±æœå¹¿æœ","uri":"/posts/dfs_bfs/"},{"categories":["ACM"],"content":"æ—¶é—´é™åˆ¶ï¼šC/C++ 1 ç§’ï¼Œå…¶ä»–è¯­è¨€ 2 ç§’ ç©ºé—´é™åˆ¶ï¼šC/C++ 262144Kï¼Œå…¶ä»–è¯­è¨€ 524288K 64bit IO Format: %lld é¢˜ç›®æè¿° æœ‰ä¸€ä¸ªé•¿åº¦ä¸º n çš„åºåˆ— aï¼Œå·²çŸ¥ a[1]=a[n]=1ï¼Œä¸”å¯¹äº 2 \u003c= x \u003c= nï¼Œa[x] / a[x-1] æ˜¯ä»¥ä¸‹ä¸‰ä¸ªæ•°å­—ä¹‹ä¸€ [ 1ï¼Œ-2ï¼Œ0.5 ], é—®æœ‰å¤šå°‘ç§ä¸åŒçš„åºåˆ—æ»¡è¶³é¢˜æ„ã€‚ ä¸¤ä¸ªåºåˆ—ä¸åŒå½“ä¸”ä»…å½“å®ƒä»¬æœ‰è‡³å°‘ä¸€ä¸ªä½ç½®ä¸Šçš„æ•°å­—ä¸åŒï¼Œåºåˆ— a å¯ä»¥ä¸ºä»»ä½•å®æ•°ã€‚ è¾“å…¥æè¿°ï¼š ä¸€ä¸ªæ•´æ•° è¡¨ç¤º n (1\u003c= n \u003c= 1e3) è¾“å‡ºæè¿°ï¼š ä¸€ä¸ªæ•´æ•° è¡¨ç¤ºç­”æ¡ˆæ¨¡ 109+7 ç¤ºä¾‹ 1 è¾“å…¥ 5 è¾“å‡º 7 è§£é¢˜æ€è·¯ï¼š æ•´ä½“æ¥çœ‹ï¼Œa[x] = a[x-1] _ [1, -2, 0.5]ï¼Œé‚£ä¹ˆç­‰äºä» n-1 ä¸ª [1,-2,0.5] ä¸­é€‰å‡º n-1 ä¸ªæ•°å€¼ç›¸ä¹˜ï¼ˆa[x-1]=a[x-2] _ [1,-2,0.5] åŒç†åŒ–ç®€å¼å­ï¼‰ï¼Œ æœ€åç­”æ¡ˆè¦æ˜¯ 1ï¼Œæ‰€ä»¥-2 å°±å¿…é¡»æœ‰å¶æ•°ä¸ªï¼ŒåŒç† 0.5 çš„ä¸ªæ•°è¦ç­‰äº-2. é¡ºåºæ— å…³ã€‚ é‚£æ‰€æœ‰çš„è½¬æ¢ä¸­ï¼Œå°±åªè¦ä¿è¯æœ‰è‹¥å¹²ç»„ (-2,-2,0.5,0.5) å­˜åœ¨ è¡¨ç¤ºå¶æ•°ä¸ª 2 çš„ä¸ªæ•°ä¸å¶æ•°ä¸ª 0.5 çš„ä¸ªæ•°ç»„åˆï¼›ç»„åˆæ•°ç”¨äºŒé¡¹å¼ç³»æ•°ï¼Œæ¨è¾‰ä¸‰è§’æ¥æ±‚ã€‚ #include \u003cbits/stdc++.h\u003e using namespace std; const int maxn = 1e3 + 5; const int mod = 1e9 + 7; long long c[maxn][maxn]; int main(){ for(int i = 0; i \u003c maxn; i++){//æ¨è¾‰ä¸‰è§’ c[i][0] = 1; c[i][i] = 1; for(int j = 1; j \u003c i; j++) c[i][j] = (c[i-1][j] + c[i-1][j-1]) % mod; } int n; while(~scanf(\"%d\", \u0026n)){ n--; long long ans = 0; for(int i = 0; i*2 \u003c= n; i += 2){ ans = (ans%mod + (c[n][i]*c[n-i][i])%mod)%mod; } printf(\"%lld\\n\", ans); } return 0; } ","date":"2018-07-18","objectID":"/posts/wannafly-18/:0:0","tags":["ç»„åˆæ•°å­¦","ACM","Nowcoder","C++","C"],"title":"Wannafly æŒ‘æˆ˜èµ› 18-åºåˆ—","uri":"/posts/wannafly-18/"},{"categories":["ACM"],"content":"å¼±é¸¡è¿˜æ˜¯å¼±é¸¡å•Šæœ€ç®€å•çš„èƒŒåŒ…é—®é¢˜â€”â€”ã€‚â€”â€”ï¼ ","date":"2018-06-16","objectID":"/posts/%E7%AE%80%E5%8D%95%E8%83%8C%E5%8C%85/:0:0","tags":["èƒŒåŒ…é—®é¢˜","C"],"title":"ç®€å•èƒŒåŒ…","uri":"/posts/%E7%AE%80%E5%8D%95%E8%83%8C%E5%8C%85/"},{"categories":["ACM"],"content":"1) é—®é¢˜æè¿°ï¼š å‡è®¾æœ‰ä¸€ä¸ªèƒ½è£…å…¥æ€»ä½“ç§¯ä¸º T çš„èƒŒåŒ…å’Œ n ä»¶ä½“ç§¯åˆ†åˆ«ä¸º W1ï¼ŒW2ï¼ŒÂ·Â·Â·ï¼ŒWn çš„ç‰©å“ï¼Œèƒ½å¦ä» n ä»¶ç‰©å“ä¸­æŒ‘é€‰è‹¥å¹²ä»¶æ°å¥½è£…æ»¡èƒŒåŒ…ï¼Œå³ä½¿ W1+W2+Â·Â·Â·+Wn=Tï¼Œè¦æ±‚æ‰¾å‡ºæ‰€æœ‰æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„è§£ã€‚ä¾‹å¦‚ï¼šå½“ T=10ï¼Œå…± 6 ä»¶ç‰©å“ï¼Œç‰©å“çš„ä½“ç§¯ä¸º{1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ8}ï¼Œé‚£ä¹ˆå¯æ‰¾åˆ°ä¸‹åˆ— 4 ç»„è§£ï¼šï¼ˆ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼‰ã€ï¼ˆ1ï¼Œ4ï¼Œ5ï¼‰ã€ï¼ˆ2ï¼Œ3ï¼Œ5ï¼‰ã€ï¼ˆ2ã€8ï¼‰ã€‚ ","date":"2018-06-16","objectID":"/posts/%E7%AE%80%E5%8D%95%E8%83%8C%E5%8C%85/:1:0","tags":["èƒŒåŒ…é—®é¢˜","C"],"title":"ç®€å•èƒŒåŒ…","uri":"/posts/%E7%AE%80%E5%8D%95%E8%83%8C%E5%8C%85/"},{"categories":["ACM"],"content":"2) å®ç°æç¤ºï¼š å¯åˆ©ç”¨å›æº¯æ³•çš„è®¾è®¡æ€æƒ³æ¥è§£å†³èƒŒåŒ…é—®é¢˜ã€‚é¦–å…ˆï¼Œå°†ç‰©å“æ’æˆä¸€åˆ—ï¼Œç„¶åé¡ºåºé€‰å–ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå‡è®¾å·²é€‰å–äº†å‰ i ä»¶ç‰©å“ä¹‹åèƒŒåŒ…è¿˜æ²¡æœ‰è£…æ»¡ï¼Œåˆ™ç»§ç»­é€‰å–ç¬¬ i+1 ä»¶ç‰©å“ï¼Œè‹¥è¯¥ä»¶ç‰©å“â€œå¤ªå¤§â€ä¸èƒ½è£…å…¥ï¼Œåˆ™ä¸¢å¼ƒè€Œç»§ç»­é€‰å–ä¸‹ä¸€ä»¶ï¼Œç›´è‡³èƒŒåŒ…è£…æ»¡ä¸ºæ­¢ã€‚ä½†å¦‚æœåœ¨å‰©ä½™çš„ç‰©å“ä¸­æ‰¾ä¸åˆ°åˆé€‚çš„ç‰©å“ä»¥å¡«æ»¡èƒŒåŒ…ï¼Œåˆ™è¯´æ˜â€œåˆšåˆšâ€è£…å…¥èƒŒåŒ…çš„é‚£ä»¶ç‰©å“â€œä¸åˆé€‚â€ï¼Œåº”å°†å®ƒå–å‡ºâ€œä¸¢å¼ƒä¸€è¾¹â€ï¼Œç»§ç»­å†ä»â€œå®ƒä¹‹åâ€çš„ç‰©å“ä¸­é€‰å–ï¼Œå¦‚æ­¤é‡å¤ï¼Œç›´è‡³æ±‚å¾—æ»¡è¶³æ¡ä»¶çš„è§£ï¼Œæˆ–è€…æ— è§£ã€‚ç”±äºå›æº¯æ±‚è§£çš„è§„åˆ™æ˜¯â€œåè¿›å…ˆå‡ºâ€ï¼Œå› æ­¤è¦ç”¨åˆ°æ ˆã€‚ ä½¿ç”¨æ ˆä½œä¸ºè¯¥ç¨‹åºçš„æ•°æ®ç»“æ„ï¼Œåˆ©ç”¨æ ˆè¿›è¡Œè¯­æ³•æ£€æŸ¥ï¼Œä»¥æ·±åº¦ä¼˜å…ˆçš„æœç´¢æ–¹å¼è§£ç©ºé—´ï¼Œå®ç°é€’å½’è¿‡ç¨‹å’Œå‡½æ•°çš„è°ƒç”¨ï¼Œåœ¨è®¾è®¡æ—¶è¿˜ä½¿ç”¨ C è¯­è¨€çš„æ•°ç»„åŠå…¶å¾ªç¯è¯­è¨€æ¥å®ç°ç¨‹åºã€‚ è¿ç”¨å›æº¯æ³•è§£é¢˜ï¼Œåœ¨æœç´¢è§£ç©ºé—´æ ‘æ—¶ï¼Œåªè¦å…¶å·¦å„¿å­èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå¯è¡Œç»“ç‚¹ï¼Œæœç´¢å°±è¿›å…¥å·¦å­æ ‘ï¼Œåœ¨å³å­æ ‘ä¸­æœ‰å¯èƒ½åŒ…å«æœ€ä¼˜è§£æ˜¯æ‰è¿›å…¥å³å­æ ‘æœç´¢ã€‚å¦åˆ™å°†å³å­æ ‘å‰ªå»ã€‚ #include \u003cstdio.h\u003e #include \u003cwindows.h\u003e #define size 50 struct stacks { int data[size]; int top; } stack; void backpack(int number,int V,int w[]){ int i,j=1,k=0; int flag=0; do { while (V \u003e 0 \u0026\u0026 k \u003c= number) { if (V \u003e= w[k]) { stack.data[stack.top] = k;//ç¬¬ k ä¸ªç‰©å“çš„ä½“ç§¯ä¸‹æ ‡ stack.top++; V -= w[k]; } k++; } if (V == 0) { flag=1; printf(\"ç¬¬%d ä¸ªç¬¦åˆæ¡ä»¶çš„è§£ï¼š\", j); for (i = 0; i \u003c stack.top; i++) { printf(\"%d \", w[stack.data[i]]); } j++; printf(\"\\n\"); } //k æ»¡æ—¶å›æº¯ k = stack.data[--stack.top]; stack.data[stack.top] = 0; V += w[k]; k++; } while (!(stack.top == 0 \u0026\u0026 k == number)); if(!flag){ printf(\"èƒŒåŒ…æ— è§£ï¼\\n\"); } } void judge(int number,int V,int w[]){ int i,s = 0; for (i = 0; i \u003c number; i++) s = s + w[i]; if(V \u003e s){ printf(\"èƒŒåŒ…æ— è§£ï¼\\n\"); exit(0); } if(V==s){ printf(\"åªæœ‰ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„è§£ï¼š%d\\n\", V); exit(0); } } int main() { int w[size]; int V; int i = 0; int j = 0; int number; printf(\"\\t **ç®€å•èƒŒåŒ…é—®é¢˜**\\n\\n\"); printf(\"\\n è¯·è¾“å…¥å¯ä¾›é€‰æ‹©è£…å…¥ç‰©å“çš„ä¸ªæ•°ï¼š\\n\"); scanf(\"%d\", \u0026number); printf(\"\\n è¯·è¾“å…¥å„ä»¶ç‰©å“çš„ä½“ç§¯ï¼š\\n\"); for (i = 0; i \u003c number; i++) scanf(\"%d\", \u0026w[i]); //æ’åº for(i=0;i\u003cnumber;i++) for(j=i+1;j\u003cnumber;j++) if(w[i]\u003ew[j]){ w[i]=w[i]^w[j]; w[j]=w[i]^w[j]; w[i]=w[i]^w[j]; } printf(\"\\n è¯·è¾“å…¥èƒŒåŒ…çš„æ€»ä½“ç§¯ï¼š\\n\"); scanf(\"%d\", \u0026V); while(V \u003c 0){ printf(\"è¾“å…¥èƒŒåŒ…ä½“ç§¯é”™è¯¯ï¼é‡æ–°è¾“å…¥ï¼\\n\"); scanf(\"%d\",\u0026V); } judge(number,V,w); //åˆå§‹åŒ–æ ˆ for (i = 0; i \u003c number; i++) stack.data[i] = 0; stack.top = 0; backpack(number,V,w); return 0; } --è¿™ä¹ˆç®€å•çš„é—®é¢˜æˆ‘éƒ½è´¹åŠ›ï¼Œå¤ªè¾£é¸¡äº† ","date":"2018-06-16","objectID":"/posts/%E7%AE%80%E5%8D%95%E8%83%8C%E5%8C%85/:2:0","tags":["èƒŒåŒ…é—®é¢˜","C"],"title":"ç®€å•èƒŒåŒ…","uri":"/posts/%E7%AE%80%E5%8D%95%E8%83%8C%E5%8C%85/"},{"categories":["ACM"],"content":" æ¥è‡ªä¸€ä½å¤§ä½¬çš„æ¼”è®² å°Šæ•¬çš„é¢†å¯¼ã€æ•™ç»ƒï¼Œäº²çˆ±çš„å‚èµ›é€‰æ‰‹ä»¬ï¼š å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ¥è‡ªå¹¿ä¸œå·¥ä¸šå¤§å­¦çš„ tmkã€‚ä»Šå¤©å¾ˆè£å¹¸èƒ½å¤Ÿç«™åœ¨è¿™é‡Œä»£è¡¨å…¨ä½“å‚èµ›é€‰æ‰‹å‘è¨€ï¼Œä¸å¤§å®¶åˆ†äº«æˆ‘çš„ç»å†å’Œæ„Ÿå—ã€‚ åˆšå¼€å§‹æ¥åˆ°å¤§å­¦çš„æ—¶å€™ï¼Œæˆ‘ä¸€å¿ƒå‘å­¦ï¼Œæœ¬ç€â€œå¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸Šï¼Œä¸ºæ ¡äº‰å…‰ï¼Œä¸æå¯¹è±¡â€çš„ä¿¡å¿µï¼Œæƒ³åœ¨å¤§å­¦ä¸€å±•å®å›¾ã€‚å› ä¸ºé«˜ä¸­ OI çš„æŒ«è´¥ï¼Œæˆ‘åœ¨åˆšä¸Šå¤§å­¦çš„æ—¶å€™å°±é€‰æ‹©äº† ACM è¿™æ¡â€œä¸å½’è·¯â€ã€‚ä¸€å¼€å§‹æ˜¯å› ä¸ºé«˜ä¸­çš„é—æ†¾ï¼Œåˆ°åæ¥å°±å®Œå…¨æ˜¯å› ä¸ºä¿¡å¿µå’Œå…´è¶£æ…¢æ…¢ä¸€ç›´æåˆ°ç°åœ¨ã€‚å½“æ—¶çš„æˆ‘è¿˜ä¸çŸ¥é“è¸ä¸Š ACM è¿™æ¡è·¯çš„è‹¦ï¼Œè€Œå¦‚ä»Šçš„æˆ‘å´ä¹Ÿå°åˆ°äº† ACM å¸¦ç»™æˆ‘çš„ä¹ã€‚ åœ¨è¿™ä¸‰å¹´é‡Œï¼Œæœ‰æ•°ä¸æ¸…çš„å¤œæ™šï¼Œæˆ‘çš„èˆå‹ä»¬åœ¨å¯å®¤é‡Œå¼€é»‘ï¼Œè€Œæˆ‘å’Œæˆ‘çš„é˜Ÿå‹åœ¨æœºæˆ¿é‡Œå¼€é»‘ï¼›åœ¨è¿™ä¸‰å¹´é‡Œï¼Œæœ‰æ•°ä¸æ¸…çš„å‘¨æœ«ï¼Œæˆ‘çš„èˆå‹ä»¬åœ¨æ ¡å›­é‡Œé©°éª‹ï¼Œè€Œæˆ‘å’Œæˆ‘çš„é˜Ÿå‹åœ¨é¢˜åº“é‡Œé©°éª‹ï¼›åœ¨è¿™ä¸‰å¹´é‡Œï¼Œæœ‰æ•°ä¸æ¸…çš„å‡æœŸï¼Œæˆ‘çš„èˆå‹ä»¬åœ¨å¬å”¤å¸ˆå³¡è°·é‡Œå¾æˆ˜ï¼Œè€Œæˆ‘å’Œæˆ‘çš„é˜Ÿå‹åœ¨ä¸­å›½å„çœå¸‚å¾æˆ˜ã€‚ä¸‰å¹´è¿‡å»äº†ï¼Œæˆ‘çš„èˆå‹ä»¬æˆä¸ºäº† offer æ”¶å‰²æœºï¼Œè€Œæˆ‘å’Œæˆ‘çš„é˜Ÿå‹æˆä¸ºäº†æ°”çƒæ”¶å‰²æœºã€‚ ä¸ºäº†å˜å¼ºæ˜¯ä¸€ä¸ªç—›è‹¦ä¸”æ¼«é•¿çš„è¿‡ç¨‹ï¼Œåªæœ‰è€å¾—ä½å¯‚å¯ï¼Œæ‰èƒ½å®ˆå¾—ä½ç¹åã€‚æˆ‘çš„ä¸€ä½é˜Ÿå‹ä¸ºäº†å˜å¼ºç”šè‡³ç‰ºç‰²äº†è‡ªå·±çš„å¤´å‘ï¼Œä»…ä»…æ˜¯å› ä¸ºä»–æ‹…å¿ƒä»–çš„å¤´å‘é˜»ç¢äº†ä»–æ€ç»´çš„å‘æ•£ã€‚ä»–å˜ç§ƒäº†ä¹Ÿå˜å¼ºäº†ã€‚ ä¸‰å¹´çš„ ACM è®©æˆ‘æˆé•¿å¾ˆå¤šï¼Œæ”¶è·å¾ˆå¤šã€‚æˆ‘ä¹Ÿä»ä¸€ä¸ªâ€œå¥½å¥½å­¦ä¹ å¤©å¤©å‘ä¸Šä¸ºæ ¡äº‰å…‰ä¸æå¯¹è±¡â€çš„æ— çŸ¥é’å¹´å˜æˆäº†ä¸€ä¸ªå†™çš„äº†å·¥ç¨‹æŸ¥å¾—å‡ºå¼‚å¸¸çš„å‡†ç¨‹åºå‘˜ã€‚æˆ‘è§‰å¾—ä¸‰å¹´çŒ®èº«äº ACM çš„æ—¥å­æ˜¯å€¼å¾—çš„ï¼Œå’Œä¸€å¤§å †èŒèŒçš„ç”·å­©å­ä»¬åœ¨å±‹å­é‡Œé¢ä¸€ä¸ªåˆä¸€ä¸ªé€šå®µå¥‹æ–—çš„é…£ç•…æ·‹æ¼“çš„æ—¥å­æ˜¯å€¼å¾—çš„ï¼Œçœ‹ç€è°ˆæ‹çˆ±çš„å¤§å®¶ä¸€ä¼šå„¿å“€ä¼¤ä¸€ä¼šå„¿å¿§æ„è€Œæˆ‘ä¸ä»£ç è‡ªå¾—å…¶ä¹çŸ¢å¿—ä¸æ¸çš„æ—¥å­æ˜¯å€¼å¾—çš„ã€‚æ­¤å¤–ä»–è¿˜ç»™æˆ‘å¸¦æ¥ä¸¤ä¸ªæœ€å¥½çš„å°ä¼™ä¼´ï¼Œæ˜¯ä»–ä»¬çš„ä¸€è·¯é™ªä¼´ï¼Œè®©æˆ‘æœ‰å‹‡æ°”ä¸€ç›´èµ°ä¸‹å»ã€‚æˆ‘å’Œä»–ä»¬èµ°è¿‡çš„åœ°æ–¹ï¼Œæ¯”æˆ‘å’Œå¥³æœ‹å‹å»è¿‡çš„åœ°æ–¹è¿˜è¦å¤šã€‚å™¢ï¼Œå¯¹äº†ï¼Œæˆ‘å¥½åƒæ²¡æœ‰å¥³æœ‹å‹ã€‚æ€»è€Œè¨€ä¹‹ï¼Œè¯·çæƒœä½ ä»¬çš„é˜Ÿå‹ï¼Œä»–ä»¬æ˜¯ä½ ä»¬åœ¨å¤§å­¦é‡Œä¸ºæ•°ä¸å¤šä¸€èµ·å¥‹æ–—çš„å°ä¼™ä¼´ã€‚å¸Œæœ›å¤§å®¶åƒæˆ‘ä¸€æ ·ï¼Œä¹Ÿçˆ±ç€ ACMï¼Œä¸ºè‡ªå·±å¿ƒçˆ±çš„åŠªåŠ›ã€‚ æœ€åé¢„ç¥å„ä½å‚èµ›é€‰æ‰‹ä»¬å–å¾—ç†æƒ³çš„æˆç»©ï¼Œä¹Ÿé¢„ç¥æœ¬æ¬¡å¤§èµ›åœ†æ»¡æˆåŠŸã€‚è°¢è°¢å¤§å®¶ã€‚ ","date":"2018-06-15","objectID":"/posts/18%E6%B9%98%E6%BD%AD%E9%82%80%E8%AF%B7%E8%B5%9B%E9%98%9F%E5%91%98%E4%BB%A3%E8%A1%A8%E5%8F%91%E8%A8%80/:0:0","tags":["ACM","2018 æ¹˜æ½­é‚€è¯·èµ›"],"title":"18 æ¹˜æ½­é‚€è¯·èµ›å‚èµ›é˜Ÿå‘˜ä»£è¡¨å‘è¨€","uri":"/posts/18%E6%B9%98%E6%BD%AD%E9%82%80%E8%AF%B7%E8%B5%9B%E9%98%9F%E5%91%98%E4%BB%A3%E8%A1%A8%E5%8F%91%E8%A8%80/"},{"categories":["ACM"],"content":"é¢˜ç›®é“¾æ¥ï¼ˆhdu å¤èµ›ï¼‰ 2018 å¹´æ¹˜æ½­é‚€è¯·èµ›ï¼Œåœ¨æ¹˜å¤§ä¸¾è¡Œï¼Œå½“æ—¶ä¸€èµ·æ‰“çš„è¿‡å»çš„ï¼Œå› ä¸ºæ²¡å‡ºå¸‚å°±æ–¹ä¾¿ç‚¹ã€‚ç¬¬ä¸€æ¬¡å‚åŠ ç°åœºèµ›ï¼Œé¦–å…ˆåçœä¸€ä¸‹è‡ªå·±ï¼Œæ¯”èµ›å‰ç®—æ³•å…ˆä¸è¯´ï¼ˆæ²¡æœ‰å¥½å¥½æè¿‡ï¼‰ï¼Œå°±è¿æ™®é€šçš„é¢˜ï¼Œæ•°å­¦æ€§è´¨çš„é¢˜éƒ½å¾ˆå°‘åˆ·ï¼Œä»€ä¹ˆéƒ½ä¸ä¼šï¼Œç„¶åè‹±è¯­ä¸è¯´å››å…­çº§çš„ä¸œè¥¿ï¼Œå¾ˆå¤šä¸“ä¸šè‹±è¯­è¯æ±‡éƒ½æ²¡æœ‰å¥½å¥½äº†è§£è¿‡ï¼Œä¸»è¦çš„åŸå› è¿˜æ˜¯åˆ·é¢˜åˆ·å°‘äº†ï¼Œè‹±æ–‡é¢˜åˆ·å°‘äº†ã€‚ç†æ‰€å½“ç„¶ï¼ŒæˆåŠŸæ‹¿ä¸‹ä¸€é“ï¼Œæ¹˜æ½­èµ›æ‰“é“å‘Šç»ˆã€‚ æ¯”èµ›å¼€å§‹ï¼Œè¿™æ¬¡æ˜¯ä¸‰ä¸ªäººæ²¡äººä¸€ä»½çº¸è´¨é¢˜ç›®ï¼Œæ‹¿åˆ°é¢˜ç›®ï¼Œçœ‹æœ€åä¸€é¢˜ï¼Œk.2018 å‘ç°å¯ä»¥åšï¼Œï¼ˆäº‹å®è¯æ˜ç¡®å®æ˜¯ä¸€é“æ°´é¢˜ï¼‰ï¼Œæˆ‘å°±åœ¨åšè¿™é¢˜ï¼Œä»–ä»¬çœ‹äº† a é¢˜ï¼Œå¥½åƒæ˜¯ k é¢˜ä¸€é¡¿æ“ä½œåæäº¤ï¼Œé”™äº†ï¼Œä¸€ç›´åˆ°æ¯”èµ›ç»“æŸéƒ½æ²¡åšå‡ºæ¥ï¼Œåæ¥å›å»çœ‹åˆ«äººçš„é¢˜è§£ï¼Œå‘ç°è‡ªå·±æƒ…å†µæ²¡æœ‰åˆ†æå…¨é¢ï¼Œå…¶å®æ˜¯å®Œå…¨å¯ä»¥è§£å‡ºæ¥çš„ï¼ŒçœŸçš„åšçš„å¤ªå°‘å¤ªå°‘äº†ã€‚a é¢˜æœ€åä¹Ÿæ˜¯æ²¡è¿‡ï¼Œè¿˜æœ‰ä¸€ä¸ª f é¢˜ï¼Œsortï¼Œæˆ‘æœ€åˆçš„æƒ³æ³•æ˜¯ç”¨ stl é‡Œçš„é‚£ä¸ª sort æ’åºï¼Œåªè¦å¯¹ sort çš„ compare å‡½æ•°åšå¤„ç†åº”è¯¥å¯ä»¥å®Œæˆæ’åºï¼Œæ¯”èµ›ä¹‹å‰æˆ‘çœ‹è¿‡ï¼Œä½†æ˜¯ä¸ç†Ÿæ‚‰ï¼Œzxm å¥¹ä¹Ÿçœ‹äº†æˆ‘å°±äº¤ç»™å¥¹äº†ï¼Œæœ€åå¥½åƒå› ä¸ºçˆ† long double çš„é—®é¢˜ä¹Ÿæ²¡åšå‡ºæ¥ã€‚ å“ï¼Œèœè¿˜æ˜¯èœï¼Œå¾ˆå¤šç®—æ³•éƒ½ä¸æ‡‚ï¼Œæ•°æ®ç»“æ„ä¹Ÿæ²¡å­¦å¥½ï¼Œå¾ˆæœ‰ä¸€æ®µæ—¶é—´æˆ‘éƒ½ç‰¹åˆ«å¤´ç–¼ç®—æ³•ï¼Œä¸æƒ³å­¦ï¼Œè´¹åŠ²ï¼Œè§‰å¾—è‡ªå·±ä¸é€‚åˆå­¦è®¡ç®—æœºï¼Œæ›´ä¸é€‚åˆ ACMã€‚æœ‰æ—¶å€™åˆæƒ³ï¼Œä¸é€‚åˆå¥½åƒæ€»æ˜¯ loser çš„å€Ÿå£ï¼æ€»æ˜¯åœ¨åæ‚”å’Œå·æ‡’çš„çŸ›ç›¾ä¸­ï¼ æœ€åï¼Œæ”¾ä¸Šï¼Œâ€œå‚èµ›å¥–\"ç¾è¾±è‡ªå·±ï¼Œä¹Ÿæ˜¯é­ç­–ï¼ ","date":"2018-06-14","objectID":"/posts/18%E6%B9%98%E6%BD%AD%E9%82%80%E8%AF%B7%E8%B5%9B%E6%80%BB%E7%BB%93/:0:0","tags":["ACM","2018 æ¹˜æ½­é‚€è¯·èµ›","Summaries"],"title":"18 æ¹˜æ½­é‚€è¯·èµ›æ€»ç»“","uri":"/posts/18%E6%B9%98%E6%BD%AD%E9%82%80%E8%AF%B7%E8%B5%9B%E6%80%BB%E7%BB%93/"},{"categories":["ACM"],"content":"Sample Input 2 1 1 1 1 1 2 2 1 1 2 1 1 1 3 1 3 1 2 2 1 3 1 1 ","date":"2018-06-14","objectID":"/posts/f-sorting/:1:0","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM"],"title":"F.sorting","uri":"/posts/f-sorting/"},{"categories":["ACM"],"content":"Sample Output 2 1 1 2 1 2 3 é¢˜æ„ï¼šç»™å®š n ä¸ªå…ƒç»„ (a1,b1,c1),(a2,b2,c2),â€¦,(an,bn,cn)ï¼Œå°†å…¶æŒ‰ (ai+bi)/(ai+bi+ci) çš„å€¼ä»å°åˆ°å¤§æ’åºï¼Œè¾“å‡ºæ’åºåçš„ n ä¸ªå…ƒç»„çš„åŸåºå·ï¼› æ€è·¯ï¼šç¼–å†™ sort é‡Œçš„ cmp å‡½æ•°ï¼ˆå½¢å‚ä¸ºå…ƒç»„ç»“æ„ä½“å…ƒç´ ï¼Œè®¾ä¸º Tuple x,Tuple y)ï¼Œè‹¥ç›´æ¥ç®—å‡º (x.a+x.b)(y.a+y.b+y.c) å’Œ (y.a+y.b)(x.a+x.b+x.c) å†æ¯”è¾ƒå¤§å°ï¼Œè¿™ä¸¤ä¸ªç»“æœä¼šçˆ† unsigned long longï¼› å¯ä»¥æŠŠå› å¼ä¹˜ç§¯å±•å¼€æˆå¤šé¡¹å¼çš„å’Œï¼Œçº¦å»ä¸¤å¼ä¸­ç›¸åŒçš„é¡¹ï¼Œå¾—åˆ° x.ay.c+x.by.c å’Œ y.ax.c+y.bx.cï¼Œå› æ­¤åªéœ€è®¡ç®—å®ƒä¿©å†æ¯”è¾ƒå³å¯ï¼Œç»“æœä¸ä¼šçˆ† unsigned long long å AC ä»£ç  #include \"bits/stdc++.h\" using namespace std; struct node{ long double a,b,c; int numb; }ss[1005]; bool cmp(const node \u0026a,const node \u0026b){ long double suma,sumb; //suma=a.a*b.c+a.b*b.c; //sumb=b.a*a.c+b.b*a.c; suma=(a.a+a.b)/(a.a+a.b+a.c); sumb=(b.a+b.b)/(b.a+b.b+b.c); if(suma!=sumb)return suma\u003csumb; return a.numb\u003cb.numb; } int main(){ int n; while(cin\u003e\u003en){ for(int i=0;i\u003cn;i++){ cin\u003e\u003ess[i].a\u003e\u003ess[i].b\u003e\u003ess[i].c; ss[i].numb=i+1; } stable_sort(ss,ss+n,cmp); int i; for(i=0;i\u003cn-1;i++) cout\u003c\u003css[i].numb\u003c\u003c\" \"; cout\u003c\u003css[i].numb\u003c\u003cendl; } return 0; } ","date":"2018-06-14","objectID":"/posts/f-sorting/:2:0","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM"],"title":"F.sorting","uri":"/posts/f-sorting/"},{"categories":["ACM"],"content":"K. 2018 Given a,b,c,d, ï¬nd out the number of pairs of integers (x,y) where a â‰¤ x â‰¤ b,c â‰¤ y â‰¤ d and xÂ·y is a multiple of 2018. ","date":"2018-06-14","objectID":"/posts/k-2018/:1:0","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"K.2018","uri":"/posts/k-2018/"},{"categories":["ACM"],"content":"Input The input consists of several test cases and is terminated by end-of-ï¬le. Each test case contains four integers a,b,c,d. ","date":"2018-06-14","objectID":"/posts/k-2018/:1:1","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"K.2018","uri":"/posts/k-2018/"},{"categories":["ACM"],"content":"Output For each test case, print an integer which denotes the result. ","date":"2018-06-14","objectID":"/posts/k-2018/:1:2","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"K.2018","uri":"/posts/k-2018/"},{"categories":["ACM"],"content":"Constraint â€¢ 1â‰¤ a â‰¤ b â‰¤109,1â‰¤ c â‰¤ d â‰¤109 â€¢ The number of tests cases does not exceed 104. ","date":"2018-06-14","objectID":"/posts/k-2018/:1:3","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"K.2018","uri":"/posts/k-2018/"},{"categories":["ACM"],"content":"Sample Input 1 2 1 2018 1 2018 1 2018 1 1000000000 1 1000000000 ","date":"2018-06-14","objectID":"/posts/k-2018/:1:4","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"K.2018","uri":"/posts/k-2018/"},{"categories":["ACM"],"content":"Sample Output 3 6051 1485883320325200 é¢˜æ„ï¼šç»™å®šåŒºé—´ [a,b]ã€[c,d]ï¼Œé—®æœ‰å¤šå°‘å¯¹æœ‰åºæ•°ç»„ (x,y)(xâˆˆ[a,b],yâˆˆ[c,d]) ä½¿å¾— xy æ˜¯ 2018 çš„å€æ•° æ€è·¯ï¼š2018=21009ï¼ˆåˆ†è§£è´¨å› æ•°ï¼‰ï¼Œåˆ™å¯¹ x åˆ†ç±»è®¨è®ºï¼š1) ä»…ä¸º 2 çš„å€æ•°ï¼›2ï¼‰ä»…ä¸º 1009 çš„å€æ•°ï¼›3ï¼‰å³ä¸º 2 åˆä¸º 1009 çš„å€æ•°ï¼›4ï¼‰æ—¢ä¸ä¸º 2 åˆä¸ä¸º 1009 çš„å€æ•° ç­‰ä»·äºå¦‚ä¸‹åˆ†ç±»è®¨è®ºï¼š è‹¥ x æ˜¯å¶æ•°ï¼š1ï¼‰è‹¥ x æ˜¯ 1009 çš„å€æ•°ï¼Œåˆ™ y å¯ä¸º [c,d] ä¸­ä»»æ„æ•°ï¼› 2ï¼‰è‹¥ x ä¸æ˜¯ 1009 çš„å€æ•°ï¼Œåˆ™ y å¿…å®šä¸º [c,d] ä¸­ 1009 çš„å€æ•° è‹¥ x æ˜¯å¥‡æ•°ï¼š1ï¼‰è‹¥ x æ˜¯ 1009 çš„å€æ•°ï¼Œåˆ™ y å¿…å®šä¸º [c,d] ä¸­ 2 çš„å€æ•°ï¼› 2ï¼‰è‹¥ x ä¸æ˜¯ 1009 çš„å€æ•°ï¼Œåˆ™ y å¿…å®šä¸º [c,d] ä¸­ 2018 çš„å€æ•° å AC ä»£ç  #include\u003ccstdio\u003e #include\u003ciostream\u003e typedef unsigned long long ll; using namespace std; int main(){ ll a,b,c,d; while(cin\u003e\u003ea\u003e\u003eb\u003e\u003ec\u003e\u003ed){ ll num1_all_1009=b/1009-(a-1)/1009; ll num1_even=b/2-(a-1)/2; ll num1_1009_in_even=b/2018-(a-1)/2018; ll num1_rest_in_even=num1_even-num1_1009_in_even; ll num1_odd=(b-a+1)-num1_even; ll num1_1009_in_odd=num1_all_1009-num1_1009_in_even; ll num1_rest_in_odd=num1_odd-num1_1009_in_odd; ll ans=0; ans+=num1_1009_in_even*(d-c+1); ll num2_all_1009=d/1009-(c-1)/1009; ans+=num1_rest_in_even*num2_all_1009; ll num2_even=d/2-(c-1)/2; ans+=num1_1009_in_odd*num2_even; ll num2_all_2018=d/2018-(c-1)/2018; ans+=num1_rest_in_odd*num2_all_2018; cout\u003c\u003cans\u003c\u003cendl; } return 0; } ","date":"2018-06-14","objectID":"/posts/k-2018/:1:5","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"K.2018","uri":"/posts/k-2018/"},{"categories":["ACM"],"content":"B. Higher h-index The h-index of an author is the largest h where he has at least h papers with citations not less than h. Bobo has no papers and he is going to publish some subsequently. If he works on a paper for x hours, the paper will get (aÂ·x) citations, where a is a known constant. Itâ€™s clear that x should be a positive integer. There is also a trick â€“ one can cite his own papers published earlier. Given Bobo has n working hours, ï¬nd the maximum h-index of him. ","date":"2018-06-14","objectID":"/posts/b-higher/:1:0","tags":["ACM","2018 æ¹˜æ½­é‚€è¯·èµ›","C++","C"],"title":"B.Higher h-index","uri":"/posts/b-higher/"},{"categories":["ACM"],"content":"Input The input consists of several test cases and is terminated by end-of-ï¬le. Each test case contains two integers n and a. ","date":"2018-06-14","objectID":"/posts/b-higher/:1:1","tags":["ACM","2018 æ¹˜æ½­é‚€è¯·èµ›","C++","C"],"title":"B.Higher h-index","uri":"/posts/b-higher/"},{"categories":["ACM"],"content":"Output For each test case, print an integer which denotes the maximum h-index. ","date":"2018-06-14","objectID":"/posts/b-higher/:1:2","tags":["ACM","2018 æ¹˜æ½­é‚€è¯·èµ›","C++","C"],"title":"B.Higher h-index","uri":"/posts/b-higher/"},{"categories":["ACM"],"content":"Constraint â€¢ 1â‰¤ n â‰¤109 â€¢ 0â‰¤ a â‰¤ n â€¢ The number of test cases does not exceed 104. ","date":"2018-06-14","objectID":"/posts/b-higher/:1:3","tags":["ACM","2018 æ¹˜æ½­é‚€è¯·èµ›","C++","C"],"title":"B.Higher h-index","uri":"/posts/b-higher/"},{"categories":["ACM"],"content":"Sample Input 3 0 3 1 1000000000 1000000000 ","date":"2018-06-14","objectID":"/posts/b-higher/:1:4","tags":["ACM","2018 æ¹˜æ½­é‚€è¯·èµ›","C++","C"],"title":"B.Higher h-index","uri":"/posts/b-higher/"},{"categories":["ACM"],"content":"Sample Output 1 2 1000000000 ","date":"2018-06-14","objectID":"/posts/b-higher/:1:5","tags":["ACM","2018 æ¹˜æ½­é‚€è¯·èµ›","C++","C"],"title":"B.Higher h-index","uri":"/posts/b-higher/"},{"categories":["ACM"],"content":"Note For the ï¬rst sample, Bobo can work 3 papers for 1 hour each. With the trick mentioned, he will get papers with citations 2,1,0. Thus, his h-index is 1. For the second sample, Bobo can work 2 papers for 1 and 2 hours respectively. He will get papers with citations 1+1,2+0. Thus, his h-index is 2. é¢˜æ„ï¼šç»™å®š n ä¸ªå°æ—¶ï¼Œå¯ä»¥ç”¨å…¶ä¸­ x(1\u003c=x\u003c=n) ä¸ªå°æ—¶å†™ä¸€ç¯‡è®ºæ–‡ï¼Œé‚£ä¹ˆè¿™ç¯‡è®ºæ–‡çš„\"æ—¢å®š\"å¼•ç”¨æ•°å°†ä¼šæ˜¯x*a(a ä¸ºç»™å®šæ­£æ•´æ•°ï¼‰ï¼›æ­¤å¤–ï¼Œå·²ç»å†™å¥½çš„è®ºæ–‡å°†ä¼šè¢«å…¶åå†™æˆçš„è®ºæ–‡æ‰€å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç¯‡è®ºæ–‡çš„æ€»å¼•ç”¨æ•°å°†ä¼šæ˜¯\"æ—¢å®š\"å¼•ç”¨æ•°+å…¶åè®ºæ–‡ç¯‡æ•°ï¼›é—®åœ¨æ‰€æœ‰çš„å†™è®ºæ–‡æ–¹æ¡ˆä¸­ï¼ˆä¾‹å¦‚ä¸€ç§æ–¹æ¡ˆå°±æ˜¯ç”¨ n ä¸ªå°æ—¶å†™ n ç¯‡è®ºæ–‡ï¼Œæ¯ç¯‡è®ºæ–‡å„èŠ± 1 å°æ—¶ï¼ˆå¯ä»¥å¾—åˆ°è¿™ n ç¯‡è®ºæ–‡çš„å¼•ç”¨æ•°ï¼‰)ï¼Œh æœ€å¤§ä¸ºå¤šå°‘ (h çš„å«ä¹‰åŒä¸Šé¢˜ï¼‰ï¼ˆæ¯ä¸€ç§æ–¹æ¡ˆéƒ½å¯¹åº”ç€ä¸€ä¸ª hï¼Œæ±‚è¿™äº› h ä¸­çš„æœ€å¤§è€…ï¼‰ æ€è·¯ï¼šæœ€ä¼˜æ–¹æ¡ˆï¼ˆå³å¯¹åº” h å€¼æœ€å¤§çš„æ–¹æ¡ˆï¼‰æ˜¯å¹³æ‘Š n å°æ—¶å†™æˆ n ç¯‡è®ºæ–‡ï¼ˆè¯æ˜æœªçŸ¥ï¼‰ï¼›æ­¤æ—¶ n ç¯‡è®ºæ–‡çš„å¼•ç”¨æ•°ä¸º a,a+1,a+2,â€¦,a+n-1ï¼Œå¼•ç”¨æ•°ä¸º a+i æ—¶ï¼Œå¼•ç”¨æ•°å¤§äºç­‰äºå®ƒçš„è®ºæ–‡æœ‰ n-i ç¯‡ï¼Œä»¤ a+i=n-i å¾— i=(n-a)/2, æ‰€ä»¥ h=a+(n-a)/2; å AC ä»£ç  #include\u003ccstdio\u003e int main(){ int n,a; while(scanf(\"%d%d\",\u0026n,\u0026a)!=EOF){ printf(\"%d\\n\",a+(n-a)/2); } return 0; } ","date":"2018-06-14","objectID":"/posts/b-higher/:1:6","tags":["ACM","2018 æ¹˜æ½­é‚€è¯·èµ›","C++","C"],"title":"B.Higher h-index","uri":"/posts/b-higher/"},{"categories":["ACM"],"content":"A. Easy h-index The h-index of an author is the largest h where he has at least h papers with citations not less than h. Bobo has published many papers. Given a0,a1,a2,â€¦,an which means Bobo has published ai papers with itations exactly i, ï¬nd the h-index of Bobo. ","date":"2018-06-14","objectID":"/posts/a-easy/:1:0","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"A.Easy h-index","uri":"/posts/a-easy/"},{"categories":["ACM"],"content":"Input The input consists of several test cases and is terminated by end-of-ï¬le. The ï¬rst line of each test case contains an integer n. The second line contains (n+1) integers a0,a1,â€¦,an. ","date":"2018-06-14","objectID":"/posts/a-easy/:1:1","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"A.Easy h-index","uri":"/posts/a-easy/"},{"categories":["ACM"],"content":"Output For each test case, print an integer which denotes the result. ","date":"2018-06-14","objectID":"/posts/a-easy/:1:2","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"A.Easy h-index","uri":"/posts/a-easy/"},{"categories":["ACM"],"content":"Constraint â€¢ 1â‰¤ n â‰¤2Â·105 â€¢ 0â‰¤ ai â‰¤109 â€¢ The sum of n does not exceed 250,000. ","date":"2018-06-14","objectID":"/posts/a-easy/:1:3","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"A.Easy h-index","uri":"/posts/a-easy/"},{"categories":["ACM"],"content":"Sample Input 1 1 2 2 1 2 3 3 0 0 0 0 ","date":"2018-06-14","objectID":"/posts/a-easy/:1:4","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"A.Easy h-index","uri":"/posts/a-easy/"},{"categories":["ACM"],"content":"Sample Output 1 2 0 é¢˜æ„ï¼šç»™å®šè¢«å¼•ç”¨æ¬¡æ•°ä¸º 0~n çš„è®ºæ–‡åˆ†åˆ«æœ‰å‡ å¼ ï¼Œæ‰¾åˆ°æœ€å¤§çš„ hï¼Œæ»¡è¶³è¢«å¼•ç”¨æ¬¡æ•°å¤§äºç­‰äº h çš„è®ºæ–‡è‡³å°‘æœ‰ h å¼  æ€è·¯ï¼šåœ¨åŒºé—´ [0,n] å†…äºŒåˆ†ç­”æ¡ˆï¼›æˆ–ç›´æ¥ä» n~0 éå†æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ h å AC ä»£ç  #include \"bits/stdc++.h\" using namespace std; int main(){ int a[200005]; int n; int i; while(cin\u003e\u003en){ for(i=0;i\u003c=n;i++) cin\u003e\u003ea[i]; int sum=a[n]; for(i=n;i\u003e=0;){ if(sum\u003e=i){ cout\u003c\u003ci\u003c\u003cendl; break; } else sum+=a[--i]; } if(i\u003c0) cout\u003c\u003c\"0\"\u003c\u003cendl; } return 0; } ","date":"2018-06-14","objectID":"/posts/a-easy/:1:5","tags":["2018 æ¹˜æ½­é‚€è¯·èµ›","ACM","C++"],"title":"A.Easy h-index","uri":"/posts/a-easy/"},{"categories":["ACM"],"content":"sort ä½¿ç”¨#include\u003calgorithm\u003eå¤´æ–‡ä»¶ï¼Œ sortï¼ˆå¼€å§‹åœ°å€ï¼Œç»“æŸåœ°å€ï¼Œæ’åºæ–¹å¼ï¼‰ï¼Œå…¶ä¸­ç¬¬ä¸‰å‚æ•°å¯ä»¥æ²¡æœ‰ï¼Œåˆ™é»˜è®¤ä¸ºå‡åºæ’åºã€‚ æˆ–è€…ç®€å•çš„ç”¨ less\u003cå‚æ•°ç±»å‹\u003e()è¡¨ç¤ºå‡åº greater\u003cå‚æ•°ç±»å‹\u003e()è¡¨ç¤ºé™åº ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ª bool å‹å‡½æ•°ï¼Œæ¯”å¦‚ï¼š bool cmp(int a,int b){ return a\u003eb;//è¡¨ä»å¤§åˆ°å°ï¼Œå³é™åº } å‡è®¾è‡ªå·±å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“ node typedef struct node { int a; int b; double c; }note; æœ‰ä¸€ä¸ª node ç±»å‹çš„æ•°ç»„ node arr[100]ï¼Œæƒ³å¯¹å®ƒè¿›è¡Œæ’åºï¼šå…ˆæŒ‰ a å€¼å‡åºæ’åˆ—ï¼Œå¦‚æœ a å€¼ç›¸åŒï¼Œå†æŒ‰ b å€¼é™åºæ’åˆ—ï¼Œå¦‚æœ b è¿˜ç›¸åŒï¼Œå°±æŒ‰ c é™åºæ’åˆ—ã€‚å°±å¯ä»¥å†™è¿™æ ·ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ï¼š ä»¥ä¸‹æ˜¯ä»£ç ç‰‡æ®µï¼š bool cmp(node x,node y) { if(x.a!=y.a) return x.a\u003cy.a; if(x.b!=y.b) return x.b\u003ey.b; return x.c\u003ey.c; } sort() å‡½æ•°æ˜¯å®Œå…¨é€šç”¨çš„ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥æ“ä½œå‡ ä¹ä»»ä½•æ•°æ®é›†åˆï¼ŒåŒ…æ‹¬é“¾è¡¨ï¼Œå®¹å™¨å’Œæ•°ç»„ï¼Œæ•°ç»„ç±»å‹å¯ä»¥æ˜¯ int,char ç­‰ã€‚ å®ä¾‹ï¼šå…ˆé™åºå†å‡åº #include\u003ciostream\u003e #include\u003calgorithm\u003e using namespace std; typedef struct data{ int a; double b; }date; bool cmp(date a,date b){ if(a.b!=b.b) return a.b\u003eb.b; return a.a\u003cb.a; } int main(){ date a[3]={{5,56.5},{4,56.5},{8,85}}; sort(a,a+3,cmp); for(int i=0;i\u003c3;i++) cout\u003c\u003ca[i].a\u003c\u003c\"-\"\u003c\u003ca[i].b\u003c\u003cendl; cout\u003c\u003cendl; return 0; } ä¼ é€é—¨ ","date":"2018-06-14","objectID":"/posts/c-sort/:0:0","tags":["C++","sort","STL","ACM"],"title":"sort æ’åº","uri":"/posts/c-sort/"},{"categories":["ACM"],"content":"1.swapï¼ˆäº¤æ¢ä¸¤å…ƒç´ å€¼ï¼Œåœ¨ algorithm ä¸‹ï¼Œç”¨æ³•ï¼šswap(a,b);ï¼‰ äº¤æ¢ä¸¤å…ƒç´ çš„å€¼åœ¨ C è¯­è¨€è¯¾ä¸Šä½œä¸ºæŒ‡é’ˆè®²è§£çš„å…¸ä¾‹ã€‚ int a=1,b=2; swap(a,b); //æ­¤æ—¶ a=2,b=1 ï¼ˆå¯ä»¥æ˜¯å…¶ä»–ç±»å‹ï¼‰ ","date":"2018-06-14","objectID":"/posts/c-with-stl/:1:0","tags":["ACM","STL","C++"],"title":"C++ with STL","uri":"/posts/c-with-stl/"},{"categories":["ACM"],"content":"2.sort(,,) sort æ’åºæ˜¯ä¸ç¨³å®šçš„ï¼Œstl ä¸­çš„ stable_sort æ‰æ˜¯ç¨³å®šçš„ inta[10]={1,6,2,3,5,4,3,8,9,7}; stable_sort(a,a+10,greater\u003cint\u003e()); for(int i=0;i\u003c10;i++) cout\u003c\u003ca[i]\u003c\u003c\" \"; ","date":"2018-06-14","objectID":"/posts/c-with-stl/:2:0","tags":["ACM","STL","C++"],"title":"C++ with STL","uri":"/posts/c-with-stl/"},{"categories":["ACM"],"content":"3.reverseï¼ˆç¿»è½¬åºåˆ—ï¼Œåœ¨ algorithm ä¸‹ï¼‰ //å¸¸ç”¨åœ¨å­—ç¬¦ä¸²ä¸Š int a[5]={1,2,3,4,5}; reverse(a,a+5); //åºåˆ—ç°åœ¨æ˜¯ 5 4 3 2 1 char s[]=â€œericxieâ€; reverse(s,s+strlen(s)); //åºåˆ—ç°åœ¨æ˜¯ â€œeixcireâ€ //åŒæ ·é€‚ç”¨äº string string s=â€œqwerâ€; reverse(s.begin(),s.end()); ","date":"2018-06-14","objectID":"/posts/c-with-stl/:3:0","tags":["ACM","STL","C++"],"title":"C++ with STL","uri":"/posts/c-with-stl/"},{"categories":["ACM"],"content":"4.minï¼Œmaxï¼ˆå–å¤§ï¼Œå–å°ï¼‰ int a=1,b=2,c; c=min(a,b); //æ­¤æ—¶ c ç­‰äº 1 c=max(a,b); //æ­¤æ—¶ c ç­‰äº 2 string s=â€œqwerâ€,d=â€œasjkâ€,c; c=min(s,d); //c=â€œasjkâ€ ","date":"2018-06-14","objectID":"/posts/c-with-stl/:4:0","tags":["ACM","STL","C++"],"title":"C++ with STL","uri":"/posts/c-with-stl/"},{"categories":["ACM"],"content":"5.__gcdï¼ˆæœ€å¤§å…¬çº¦æ•°ï¼‰ æ‰‹å†™ gcd å‡½æ•°ä¹Ÿè¡Œï¼Œè¾—è½¬ç›¸é™¤ï¼Œè¾—è½¬ç›¸å‡ï¼› int gcd(int a,int b){ return a%b ? b : gcd(b,a%b); } //ç›´æ¥ç”¨ int a=4,b=6; int c=__gcd(a,b); //æ³¨æ„ä¸‹åˆ’çº¿ï¼Œæ­¤æ—¶ c ç­‰äº 2 ","date":"2018-06-14","objectID":"/posts/c-with-stl/:5:0","tags":["ACM","STL","C++"],"title":"C++ with STL","uri":"/posts/c-with-stl/"},{"categories":["ACM"],"content":"6.lower_bound å’Œ upper_boundï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰ lower_bound æ„æ€å°±æ˜¯ï¼šæ‰¾åˆ°ç¬¬ä¸€ä¸ªä½ç½®ï¼Œä½¿å¾—ï¼šå¦‚æœåœ¨è¿™ä¸ªä½ç½®æ’å…¥ value åï¼ŒåŸæœ‰åºåºåˆ—ä¾æ—§æœ‰åºã€‚ upper_bound æ˜¯æ‰¾åˆ°æœ€åä¸€ä¸ªç¬¦åˆæ•°ä½ç½®åä¸€ä¸ªä½ç½®ï¼Œä½¿å¾—ï¼šå¦‚æœåœ¨è¿™ä¸ªä½ç½®æ’å…¥ value åï¼ŒåŸæœ‰åºåºåˆ—ä¾æ—§æœ‰åºã€‚ //æ•°ç»„ int a[8]={1,2,4,4,9,12,12,15}; int pos1 = lower_bound(a,a+8,4)-a; int pos2 = upper_bound(a,a+8,4)-a-1; //åœ¨è¿™ä¸ªæ ·ä¾‹ä¸‹ pos1!=pos2;pos1=2;pos2=3; æ ¹æ®æˆ‘çš„ç†è§£ lower_bound(a,a+8,value) å¾—åˆ°çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œæ‹¿è¿™ä¸ªåœ°å€å‡å»æ•°ç»„é¦–åœ°å€ a[0]ï¼Œé‚£ä¹ˆåˆšå¥½å°±æ˜¯ value åº”è¯¥æ”¾å…¥çš„ä½ç½®ã€‚ //vector vector\u003cint\u003e a; è‹¥ a ä¸­ç›®å‰çš„å…ƒç´ ä¹Ÿæ˜¯{1,2,4,4,9,12,12,15}; é‚£ä¹ˆè¿™é‡Œç”¨ lower_bound å¾—åˆ°çš„åº”è¯¥ä¹Ÿæ˜¯ä¸€ä¸ªç±»ä¼¼äºæŒ‡é’ˆçš„ä¸œè¥¿ï¼Œä¸ºä»€ä¹ˆä¸å«å®ƒæŒ‡é’ˆå‘¢ï¼Ÿå› ä¸ºä»–æœ‰äº†ä¸€ä¸ªåå­—ï¼Œå«åšè¿­ä»£å™¨ã€‚ vector\u003cint\u003e::iterator it; it = lower_bound(a.begin(),a.end(),4); //è¿™é‡Œçš„ it å°±æ˜¯è¿­ä»£å™¨ï¼Œé‚£ä¹ˆ* it å°±æ˜¯è¯¥ä¸‹æ ‡å¯¹åº”çš„ value äº†ã€‚ //set é›†åˆ set\u003cint\u003e a; set\u003cint\u003e::iterator it; it = a.lower_bound(value); ","date":"2018-06-14","objectID":"/posts/c-with-stl/:6:0","tags":["ACM","STL","C++"],"title":"C++ with STL","uri":"/posts/c-with-stl/"},{"categories":["ACM"],"content":"7.next_permutation ï¼ˆæ’åˆ—ï¼‰ bool next_permutation( iterator start, iterator end ); é€šå¸¸ç”¨äºç”Ÿæˆåºåˆ—çš„å…¨æ’åˆ—ã€‚ç”¨ä¹‹å‰å…ˆä¿è¯æœ‰åºï¼› int a[]={1,2,3}; do{ for(int i=0;i\u003c3;i++) cout\u003c\u003ca[i]\u003c\u003c\" \"; cout\u003c\u003cendl; }while(next_permutation(a,a+3)); ç»“æœä¸ºï¼š 1 2 3 1 3 2 2 1 3 2 3 1 3 1 2 3 2 1 string str=\"STL\"; sort(str.begin(), str.end()); do{ cout \u003c\u003c str \u003c\u003c endl; }while (next_permutation(str.begin(),str.end()))ï¼› ç»“æœï¼š LST LTS SLT STL TLS TSL å¤§æ•°æ® c æ¯” c++æ•ˆç‡é«˜ int length; char str[MAX]; gets(str); length = strlen(str); sort(str, str + length); do{ puts(str); }while(next_permutation(str, str+length))ï¼› ","date":"2018-06-14","objectID":"/posts/c-with-stl/:7:0","tags":["ACM","STL","C++"],"title":"C++ with STL","uri":"/posts/c-with-stl/"},{"categories":["ACM"],"content":"8.unique ï¼ˆå»é‡ï¼‰ å¦‚ä½•æŠŠåºåˆ— a ä¸­çš„é‡å¤å…ƒç´ å»é™¤å‘¢ï¼Ÿé¦–å…ˆéœ€è¦å¯¹åŸåºåˆ— a è¿›è¡Œæ’åºï¼Œä¿è¯æœ‰åºåï¼Œè°ƒç”¨ unique(a.head , a.tail ) å°±å¯ä»¥äº†ã€‚unique ä¼šè¿”å›ä¸€ä¸ªç±»ä¼¼æŒ‡é’ˆçš„ä¸œè¥¿ï¼ˆå’Œ lower_bound æœ‰ç‚¹åƒï¼‰ï¼Œ-a åè¡¨ç¤ºå»é‡ä¹‹ååºåˆ—çš„é•¿åº¦ã€‚ ä¸‹é¢æ˜¯å®ä¾‹ã€‚ int a[]={1,3,5,7,9,2,2,2,1,1,1}; sort(a,a+11); int len = unique(a,a+11)-a; for(int i=0;i\u003clen;i++) cout\u003c\u003ca[i]\u003c\u003c\" \"; è¾“å‡ºç»“æœä¸ºï¼š1 2 3 5 7 9 ä¼ é€é—¨ ","date":"2018-06-14","objectID":"/posts/c-with-stl/:8:0","tags":["ACM","STL","C++"],"title":"C++ with STL","uri":"/posts/c-with-stl/"},{"categories":["Grocery"],"content":"1. \u0026è¿ç®— \u0026è¿ç®—é€šå¸¸ç”¨äºäºŒè¿›åˆ¶å–ä½æ“ä½œï¼Œä¾‹å¦‚ä¸€ä¸ªæ•° \u0026 1 çš„ç»“æœå°±æ˜¯å–äºŒè¿›åˆ¶çš„æœ€æœ«ä½ã€‚è¿™å¯ä»¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•´æ•°çš„å¥‡å¶ï¼ŒäºŒè¿›åˆ¶çš„æœ€æœ«ä½ä¸º 0 è¡¨ç¤ºè¯¥æ•°ä¸ºå¶æ•°ï¼Œæœ€æœ«ä½ä¸º 1 è¡¨ç¤ºè¯¥æ•°ä¸ºå¥‡æ•°ã€‚ ","date":"2018-06-14","objectID":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/:1:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—","uri":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/"},{"categories":["Grocery"],"content":"2. |è¿ç®— |è¿ç®—é€šå¸¸ç”¨äºäºŒè¿›åˆ¶ç‰¹å®šä½ä¸Šçš„æ— æ¡ä»¶èµ‹å€¼ï¼Œä¾‹å¦‚ä¸€ä¸ªæ•° or 1 çš„ç»“æœå°±æ˜¯æŠŠäºŒè¿›åˆ¶æœ€æœ«ä½å¼ºè¡Œå˜æˆ 1ã€‚å¦‚æœéœ€è¦æŠŠäºŒè¿›åˆ¶æœ€æœ«ä½å˜æˆ 0ï¼Œå¯¹è¿™ä¸ªæ•°| 1 ä¹‹åå†å‡ä¸€å°±å¯ä»¥äº†ï¼Œå…¶å®é™…æ„ä¹‰å°±æ˜¯æŠŠè¿™ä¸ªæ•°å¼ºè¡Œå˜æˆæœ€æ¥è¿‘çš„å¶æ•°ã€‚ ","date":"2018-06-14","objectID":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/:2:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—","uri":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/"},{"categories":["Grocery"],"content":"3. ^è¿ç®— ^è¿ç®—é€šå¸¸ç”¨äºå¯¹äºŒè¿›åˆ¶çš„ç‰¹å®šä¸€ä½è¿›è¡Œå–åæ“ä½œï¼Œå› ä¸ºå¼‚æˆ–å¯ä»¥è¿™æ ·å®šä¹‰ï¼šå¼‚æˆ– 0 éƒ½ä¸å˜ï¼Œå¼‚æˆ– 1 åˆ™å–åã€‚ ^è¿ç®—çš„é€†è¿ç®—æ˜¯å®ƒæœ¬èº«ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤æ¬¡å¼‚æˆ–åŒä¸€ä¸ªæ•°æœ€åç»“æœä¸å˜ï¼Œå³ a ^ b ^ b = aã€‚^è¿ç®—å¯ä»¥ç”¨äºç®€å•çš„åŠ å¯†ï¼Œæ¯”å¦‚ä½ æƒ³å¯¹ä½  MM è¯´ 1314520ï¼Œä½†æ€•åˆ«äººçŸ¥é“ï¼Œäºæ˜¯åŒæ–¹çº¦å®šæ‹¿ä½ çš„ç”Ÿæ—¥ 19880516 ä½œä¸ºå¯†é’¥ã€‚1314520^19880516 = 20665500ï¼Œä½ å°±æŠŠ 20665500 å‘Šè¯‰ MMã€‚MM å†æ¬¡è®¡ç®— 20665500 ^ 19880516 çš„å€¼ï¼Œå¾—åˆ° 1314520ï¼Œäºæ˜¯å¥¹å°±æ˜ç™½äº†ä½ çš„ä¼å›¾ã€‚ è¿˜å¯ä»¥ç”¨å¼‚æˆ–æ¥è¿›è¡Œå¿«é€Ÿåœ°äº¤æ¢æ•°æ®ï¼Œ a=2;b=3;//å…ˆè½¬åŒ–æˆäºŒè¿›åˆ¶ a=a^b; b=a^b; a=a^b; æ“ä½œå a=3;b=2; ","date":"2018-06-14","objectID":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/:3:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—","uri":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/"},{"categories":["Grocery"],"content":"4. ~ è¿ç®— ~è¿ç®—çš„å®šä¹‰æ˜¯æŠŠå†…å­˜ä¸­çš„ 0 å’Œ 1 å…¨éƒ¨å–åã€‚ä½¿ç”¨~è¿ç®—æ—¶è¦æ ¼å¤–å°å¿ƒï¼Œä½ éœ€è¦æ³¨æ„æ•´æ•°ç±»å‹æœ‰æ²¡æœ‰ç¬¦å·ã€‚å¦‚æœ~çš„å¯¹è±¡æ˜¯æ— ç¬¦å·æ•´æ•°ï¼ˆä¸èƒ½è¡¨ç¤ºè´Ÿæ•°ï¼‰ï¼Œé‚£ä¹ˆå¾—åˆ°çš„å€¼å°±æ˜¯å®ƒä¸è¯¥ç±»å‹ä¸Šç•Œçš„å·®ï¼Œå› ä¸ºæ— ç¬¦å·ç±»å‹çš„æ•°æ˜¯ç”¨$0000 åˆ°$FFFF ä¾æ¬¡è¡¨ç¤ºçš„ã€‚ ","date":"2018-06-14","objectID":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/:4:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—","uri":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/"},{"categories":["Grocery"],"content":"5. Â«è¿ç®— a Â« b å°±è¡¨ç¤ºæŠŠ a è½¬ä¸ºäºŒè¿›åˆ¶åå·¦ç§» b ä½ï¼ˆåœ¨åé¢æ·» b ä¸ª 0ï¼‰ã€‚ä¾‹å¦‚ 100 çš„äºŒè¿›åˆ¶ä¸º 1100100ï¼Œè€Œ 110010000 è½¬æˆåè¿›åˆ¶æ˜¯ 400ï¼Œé‚£ä¹ˆ 100 Â«2 = 400ã€‚å¯ä»¥çœ‹å‡ºï¼Œa Â« b çš„å€¼å®é™…ä¸Šå°±æ˜¯ a ä¹˜ä»¥ 2 çš„ b æ¬¡æ–¹ï¼Œå› ä¸ºåœ¨äºŒè¿›åˆ¶æ•°åæ·»ä¸€ä¸ª 0 å°±ç›¸å½“äºè¯¥æ•°ä¹˜ä»¥ 2ã€‚ é€šå¸¸è®¤ä¸º a Â« 1 æ¯” a * 2 æ›´å¿«ï¼Œå› ä¸ºå‰è€…æ˜¯æ›´åº•å±‚ä¸€äº›çš„æ“ä½œã€‚å› æ­¤ç¨‹åºä¸­ä¹˜ä»¥ 2 çš„æ“ä½œè¯·å°½é‡ç”¨å·¦ç§»ä¸€ä½æ¥ä»£æ›¿ã€‚ å®šä¹‰ä¸€äº›å¸¸é‡å¯èƒ½ä¼šç”¨åˆ°Â«è¿ç®—ã€‚ä½ å¯ä»¥æ–¹ä¾¿åœ°ç”¨ 1 Â«16 â€“ 1 æ¥è¡¨ç¤º 65535ã€‚å¾ˆå¤šç®—æ³•å’Œæ•°æ®ç»“æ„è¦æ±‚æ•°æ®è§„æ¨¡å¿…é¡»æ˜¯ 2 çš„å¹‚ï¼Œæ­¤æ—¶å¯ä»¥ç”¨Â«æ¥å®šä¹‰ Max_N ç­‰å¸¸é‡ã€‚ ","date":"2018-06-14","objectID":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/:5:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—","uri":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/"},{"categories":["Grocery"],"content":"6. Â»è¿ç®— å’ŒÂ«ç›¸ä¼¼ï¼Œa Â» b è¡¨ç¤ºäºŒè¿›åˆ¶å³ç§» b ä½ï¼ˆå»æ‰æœ« b ä½ï¼‰ï¼Œç›¸å½“äº a é™¤ä»¥ 2 çš„ b æ¬¡æ–¹ï¼ˆå–æ•´ï¼‰ã€‚æˆ‘ä»¬ä¹Ÿç»å¸¸ç”¨Â» 1 æ¥ä»£æ›¿ div 2ï¼Œæ¯”å¦‚äºŒåˆ†æŸ¥æ‰¾ã€å †çš„æ’å…¥æ“ä½œç­‰ç­‰ã€‚æƒ³åŠæ³•ç”¨Â»ä»£æ›¿é™¤æ³•è¿ç®—å¯ä»¥ä½¿ç¨‹åºæ•ˆç‡å¤§å¤§æé«˜ã€‚æœ€å¤§å…¬çº¦æ•°çš„äºŒè¿›åˆ¶ç®—æ³•ç”¨é™¤ä»¥ 2 æ“ä½œæ¥ä»£æ›¿æ…¢å¾—å‡ºå¥‡çš„ mod è¿ç®—ï¼Œæ•ˆç‡å¯ä»¥æé«˜ 60% ä¼ é€é—¨ åŸæ–‡ï¼šhttp://www.matrix67.com/blog/archives/263 ","date":"2018-06-14","objectID":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/:6:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—","uri":"/posts/%E4%BD%8D%E8%BF%90%E7%AE%97/"},{"categories":["Memo"],"content":" 2021/10/1 æ›´æ–° ä½¿ç”¨ Chrome ç­‰æµè§ˆå™¨ç®¡ç†ä¹¦ç­¾æ˜¯æ›´å¥½æ›´æ–¹ä¾¿çš„æ–¹å¼ï¼Œç™»é™† google è´¦å·ï¼Œæˆ–è€…å¯¼å‡º html ä¹¦ç­¾æ–‡ä»¶éƒ½æŒºæ–¹ä¾¿ã€‚ æˆ‘ä»¬åœ¨å¹³æ—¶å­¦ä¹ ç”Ÿæ´»æ€»ä¼šé‡åˆ°å¾ˆå¤šå¾ˆå¤šæœ‰ç”¨çš„ç½‘ç«™ï¼Œä¹Ÿè®¸æˆ‘ä»¬æ”¶è—åœ¨äº†æµè§ˆå™¨ä¹¦ç­¾é‡Œï¼Œå¯è¿‡ä¹…äº†ï¼Œä¸åšè¯´æ˜ï¼Œè¿™äº›é“¾æ¥çš„ä»·å€¼å°±è¢«æ—¶é—´æ·¹æ²¡äº†ï¼Œæˆ‘ä»¬è‡ªå·±éƒ½è®°ä¸èµ·æ¥äº†ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« å› æ­¤è€Œç”Ÿã€‚å¯¹è‡ªå·±æ”¶è—çš„é“¾æ¥åšäº›ç®€å•çš„è¯´æ˜ï¼ˆç¬¬ä¸€æ¬¡ç¼–å†™ç”¨äº†æˆ‘ä¸€ä¸ªä¸‹åˆï¼‰ï¼›ä¹Ÿç›¸å½“äºæˆ‘çš„é“¾æ¥æ”¶è—å¤¹ï¼Œåˆ†äº«ä¸€äº›æœ‰è¶£çš„ç½‘ç«™ï¼Œ ","date":"2018-06-07","objectID":"/posts/links/:0:0","tags":["ACM"],"title":"å„ç§ Links æ±‡æ€»ä¸åˆ†äº«","uri":"/posts/links/"},{"categories":["Memo"],"content":"ACM ç›¸å…³ é“¾æ¥ æè¿° å„å¤§ OJ é¢˜ç›®åˆ†ç±» å„ç§ç®—æ³•åˆ†ç±»ï¼Œå¯¹åº” OJ é¢˜å·è¶…é“¾æ¥ ACM é¢˜ç›®åˆ†ç±» codeforces ä¿„å›½ CF åœ¨çº¿ç¼–ç¨‹ï¼Œä¸€èˆ¬æ¯”èµ›åœ¨æ™šä¸Š 9:30 å’Œ 11ï¼š00 ç‰›å®¢ç½‘ å›½å†…æ±‚èŒå­¦ä¹ ç½‘ï¼Œæœ‰å¾ˆå¤šç¨‹åºè®¾è®¡æ¯”èµ› vjudge è¿™ä¸ªä¸ç”¨è¯´äº†å§ hihocoder æ‰“å¾—å°‘ï¼Œæ„Ÿè§‰å¥½å¤šæ•°æ®ç»“æ„çš„é¢˜ ç™¾ç»ƒ OpenJudge çš„ä¸€ä¸ªå°ç»„ï¼Œå¾ˆå¤šé¢˜ç›®æ¥è‡ª POJï¼›ä¹Ÿæ˜¯æˆ‘ ACM å¯è’™åœ° HDUOJ æ­å·ç”µå­ç§‘æŠ€å¤§å­¦ OJ POJ åŒ—äº¬å¤§å­¦ OJ æ´›è°· lintcode é¢†æ‰£ï¼ˆå›½å¤–ï¼‰ leedcode åŠ›æ‰£ codewar å›½å¤– æ›´å¤š OJï¼Œåœ¨çº¿åˆ·é¢˜ç½‘ç«™ â€¦ ","date":"2018-06-07","objectID":"/posts/links/:1:0","tags":["ACM"],"title":"å„ç§ Links æ±‡æ€»ä¸åˆ†äº«","uri":"/posts/links/"},{"categories":["Memo"],"content":"ç¼–ç¨‹ï¼Œå­¦ä¹  é“¾æ¥ æè¿° visualgo ç®—æ³•å­¦ä¹ ï¼Œæ•°æ®ç»“æ„å’Œç®—æ³•åŠ¨æ€å¯è§†åŒ– c,c++å­¦ä¹  å¾ˆè¯¦ç»†çš„çŸ¥è¯†è®²è§£ Tomcat ä¸‹è½½ Tomcat å„ç‰ˆæœ¬ä¸‹è½½ï¼ŒTomcat è§£å‹å³å®‰è£…ï¼›\\binä¸‹å¯ä»¥å¯åŠ¨å’Œå…³é—­æœåŠ¡å™¨ï¼›å¯æ‰‹åŠ¨åœ¨\\webappsé‡Œåˆ›å»º web åº”ç”¨ï¼Œä¹Ÿå¯ä»¥é…åˆEclisp IDE for Java EE Developersç­‰ Java IDE å·¥å…·åˆ›å»º w3school å¯åœ¨çº¿æµ‹è¯•ï¼ŒWeb æŠ€æœ¯æ•™ç¨‹ï¼ŒHTML, æµè§ˆå™¨è„šæœ¬ï¼ŒæœåŠ¡å™¨è„šæœ¬ï¼Œxml æ•™ç¨‹ç­‰ w3cschool å’Œä¸Šé¢ä¸åŒå“¦ï¼Œæ˜¯ä¸æ˜¯å’Œä¸Šé¢çš„å¾ˆåƒå“ˆå“ˆå“ˆï¼æˆ‘ä¼°è®¡æ˜¯ä¸Šä¸€ä¸ªç½‘ç«™çš„æ–°ç‰ˆï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ï¼Œå†…å®¹æ›´ä¸°å¯Œï¼Œè¿˜æœ‰å¾®ä¿¡å°ç¨‹åºæ•™ç¨‹ç­‰ èœé¸Ÿæ•™ç¨‹ å’Œä¸Šé¢ä¸¤ä¸ªå·®ä¸å¤šï¼Œè¿˜æœ‰ä¸€äº›æ•°æ®åº“ã€å®‰å“çš„ä¸œè¥¿ï¼Œgit å­¦ä¹  python å­¦ä¹  Python åº“å®‰è£…åŒ…ä¸‹è½½ï¼Œpython,Django,HTML,ACM å­¦ä¹  python123 Python123 æ˜¯ä¸“æ³¨äºä¸ºä¸­å›½é«˜ç­‰é™¢æ ¡æ•™å­¦ Python è¯­è¨€çš„è€Œå¼€å‘çš„ä¸€æ¬¾å­¦ä¹ å·¥å…·ç½‘ç«™ python å­¦ä¹  pypi Find, install and publish Python packages with the Python Package Index ä¼˜çŸ¿ python åœ¨çº¿æµ‹è¯•ï¼Œç¬”è®° é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— å¼€å‘è€…æ‰‹å†Œï¼ŒJavaScript ç­‰ç­‰ å»–é›ªå³° git,python,javascript å­¦ä¹  æ–°æ™´ç½‘ PS å­¦ä¹ ï¼Œæ‘„å½±æ•™ç¨‹ç­‰ å®éªŒæ¥¼ åœ¨çº¿åšå®éªŒï¼Œé«˜æ•ˆå­¦ç¼–ç¨‹ æ…•è¯¾ç½‘ åœ¨çº¿å­¦ä¹ ï¼Œå…è´¹ï¼Œä»˜è´¹è§†é¢‘ wxpy ä¸€ä¸ª python å…³äºå¾®ä¿¡çš„åº“ So1n python å­¦ä¹  ","date":"2018-06-07","objectID":"/posts/links/:2:0","tags":["ACM"],"title":"å„ç§ Links æ±‡æ€»ä¸åˆ†äº«","uri":"/posts/links/"},{"categories":["Memo"],"content":"äº‘æœåŠ¡åŠç«™é•¿å·¥å…· é“¾æ¥ æè¿° è…¾è®¯äº‘ dnspod è§£ææ–°ç‰ˆå…¥å£ï¼Œè…¾è®¯äº‘æ§åˆ¶å° dnspod è§£æ åŸŸåè§£æï¼Œå…¶ä»–ï¼šé˜¿é‡Œäº‘ç­‰ cloudflare è§£æ åŸŸåè§£æï¼Œhttps è§£æï¼Œ[ä»‹ç»](https://oliverqueen.cn/2018/01/25/å¯èƒ½æ˜¯æœ€å…¨çš„ä½¿ç”¨ HEXO æ­å»ºä¸ªäººåšå®¢æ•™ç¨‹) cloud studio è¿™æ˜¯è…¾è®¯äº‘å’Œ coding åˆä½œåçš„ä¸€ä¸ªä¸œè¥¿ï¼Œç®€å•æ¥è¯´å°±æ˜¯äº‘ç«¯å¼€å‘ç¯å¢ƒã€‚è¯•äº†ä¸€ä¸‹å®Œå…¨å¯ä»¥æŠŠ hexo åšå®¢æºç æŒ‚ä¸Šé¢ç¼–è¾‘ã€‚è¿™ä¹Ÿå°±ä¸ç”¨åªå±€é™äºä¸€å°ç”µè„‘å‘å¸ƒåšå®¢äº†ã€‚ è…¾è®¯äº‘å¤§å­¦å¼€æ”¾å®éªŒå®¤ å¯ä»¥åœ¨çº¿è¿›è¡Œä¸€äº›äº‘æœåŠ¡åº”ç”¨æ­å»ºç­‰çš„å®éªŒã€‚ä¸ä¹‹å¯¹åº”çš„è¿˜æœ‰é˜¿é‡Œäº‘å¼€æ”¾å®éªŒå®¤ å®å¡”é¢æ¿ å®å¡”é¢æ¿æ˜¯ä¸€æ¬¾ä½¿ç”¨æ–¹ä¾¿ã€åŠŸèƒ½å¼ºå¤§ä¸”ç»ˆèº«å…è´¹çš„æœåŠ¡å™¨ç®¡ç†è½¯ä»¶ï¼Œæ”¯æŒ Linux ä¸ Windows ç³»ç»Ÿã€‚ä¸€é”®é…ç½®ï¼šLAMP/LNMPã€ç½‘ç«™ã€æ•°æ®åº“ã€FTPã€SSLï¼Œé€šè¿‡ Web ç«¯è½»æ¾ç®¡ç†æœåŠ¡å™¨ã€‚ leancloud ä¸€ç«™å¼åç«¯äº‘æœåŠ¡ daovoice ç½‘ç«™åœ¨çº¿å®¢æœ ç™¾åº¦ç½‘ç«™æ”¶å½• ç½‘ç«™ seo Bing ç«™é•¿ Bing ç½‘ç«™ç®¡ç†å‘˜å·¥å…· ç«™é•¿å·¥å…· ç½‘ç«™ä¿¡æ¯æŸ¥è¯¢ï¼Œæƒé‡ï¼Œseoï¼Œç½‘ç«™é€Ÿåº¦æŸ¥è¯¢ï¼Œping ç­‰ ç«™é•¿å·¥å…·å¤§å…¨ å„ç§ seo ä¼˜åŒ–ï¼Œå·¥å…·ç­‰ ","date":"2018-06-07","objectID":"/posts/links/:3:0","tags":["ACM"],"title":"å„ç§ Links æ±‡æ€»ä¸åˆ†äº«","uri":"/posts/links/"},{"categories":["Memo"],"content":"å‰ç«¯å·¥å…· é“¾æ¥ æè¿° å…¨æ ˆå¼€å‘è€… é¡¾åæ€ä¹‰ï¼Œæœ‰å¾ˆå¤š web å¼€å‘çš„æ•™ç¨‹ï¼Œä¹Ÿå¯ä»¥åœ¨çº¿æ‰§è¡Œä»£ç  JSFuck JSFuck æ˜¯ä¸€ç§åŸºäº JavaScript åŸå­éƒ¨åˆ†çš„æ·±å¥¥æ•™è‚²ç¼–ç¨‹é£æ ¼ã€‚å®ƒåªä½¿ç”¨å…­ä¸ªä¸åŒçš„å­—ç¬¦æ¥ç¼–å†™å’Œæ‰§è¡Œä»£ç ã€‚ï¼ˆä»£ç æä¸‘åŒ–ï¼‰ BootCDN ç¨³å®šã€å¿«é€Ÿã€å…è´¹çš„å‰ç«¯å¼€æºé¡¹ç›® CDN åŠ é€ŸæœåŠ¡ï¼Œå…±æ”¶å½•äº† 3441 ä¸ªå‰ç«¯å¼€æºé¡¹ç›®ã€‚æ¯”å¦‚vue,fancyboxç­‰ bootstrap ä¸­æ–‡ç½‘ ç®€æ´ã€ç›´è§‚ã€å¼ºæ‚çš„å‰ç«¯å¼€å‘æ¡†æ¶ï¼Œè®© web å¼€å‘æ›´è¿…é€Ÿã€ç®€å•ã€‚è¿˜æœ‰ä¸€äº›åŸºäº bootstrap å¼€å‘æˆ–æ‰©å……çš„é¡¹ç›®çš„ cdnï¼ŒBootCDNä¹Ÿæ˜¯åœ¨è¯¥ç½‘ç«™æ——ä¸‹ Font Awesome å›¾æ ‡åº“ hexo æŒ‡å®šå›¾æ ‡åº“ iconfont é˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“ easyicon å›¾æ ‡åº“ å›¾æ ‡ä¸‹è½½ï¼Œæ ¼å¼è½¬æ¢ï¼Œå¯å¤–é“¾ semantic-ui.com å›¾æ ‡åº“ semantic-ui.com è¿˜æœ‰å¾ˆå¤šå‰ç«¯æ ·å¼å¯¹åº”ä»£ç  colorhunt é…è‰²æ–¹æ¡ˆæ¨èï¼Œè°ƒè¯• grabient æ¸å˜è‰² æ¸å˜è‰²è°ƒè‰² gradient æ¸å˜è‰²è°ƒè‰² æ¸å˜è‰²è°ƒè‰²ï¼Œè·å–ä»£ç  encycolorpedia encycolorpedia å–è‰²å™¨ ä¼˜é…·è§†é¢‘ä¸Šä¼  è·å–è§†é¢‘å¤–é“¾ï¼Œå…¶ä»–ï¼šè…¾è®¯è§†é¢‘ sm.ms éå¸¸å¥½ç”¨çš„å›¾åºŠ imgURL ä¸€ä¸ªå¼€æºçš„å›¾åºŠï¼Œå¾ˆä¸é”™ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±å°è¯•æ­å»ºï¼Œæ¯”å¦‚ img.lruihao.cn ç°å®å›å¤–é“¾ æ”¯æŒå¤šç§æ–‡ä»¶å¤–é“¾ï¼Œå”¯ä¸€ä¸å¥½çš„æ˜¯ http PEXELS ç¾å›¾ æ–‡ç« é…å›¾ï¼Œæ— ç‰ˆæƒç¾å›¾ç½‘ï¼Œé¿å…é…å›¾ä¾µæƒ unsplash ç¾å›¾ API è¿˜å¯ä»¥è·å– éšæœºå›¾ å›¾æ ‡å·¥å‚ ç§»åŠ¨åº”ç”¨å›¾æ ‡ç”Ÿæˆå·¥å…·ï¼Œä¸€é”®ç”Ÿæˆæ‰€æœ‰å°ºå¯¸çš„åº”ç”¨å›¾æ ‡ emoji åœ¨çº¿å¤åˆ¶ Simple emoji copy and paste HTML å­—ç¬¦å®ä½“ ç½‘é¡µç‰¹æ®Šç¬¦å·å¤§å…¨ ç‰¹æ•ˆå­—è½¬æ¢å·¥å…·é›† å„ç§ç‰¹æ•ˆå­—è½¬æ¢å·¥å…·ï¼Œå½©è™¹å­—ç”Ÿæˆå™¨ï¼ŒRGB è½¬ 16 è¿›åˆ¶é¢œè‰²ç­‰ å‹ç¼©å›¾ åœ¨çº¿ psï¼Œå›¾ç‰‡å»åº•ï¼Œè¯ä»¶ç…§æ¢åº•ç­‰æ“ä½œå¾ˆæ–¹ä¾¿çš„ web å›¾ç‰‡å¤„ç†å·¥å…· æ”¹å›¾å® åœ¨çº¿æ”¹å›¾å‹ç¼©ï¼ŒåŠ æ°´å°ï¼Œç”ŸæˆäºŒç»´ç ï¼Œå°ç« åˆ¶ä½œç­‰ GIF ä¹‹å®¶ ä¸€ä¸ªå‹ç¼©æ•ˆæœå¾ˆå¥½ä¸”å…è´¹çš„ gif å‹ç¼©å·¥å…· äºŒç»´ç è§£ç å™¨ è‰æ–™äºŒç»´ç  https://cli.im è”å›¾äºŒç»´ç  ç¬¬ä¹å·¥å‚ æ­»ç£•è‰ºæœ¯äºŒç»´ç  æ¨¡æ¿ç  åŠ¨æ€äºŒç»´ç ç­‰ ","date":"2018-06-07","objectID":"/posts/links/:4:0","tags":["ACM"],"title":"å„ç§ Links æ±‡æ€»ä¸åˆ†äº«","uri":"/posts/links/"},{"categories":["Memo"],"content":"å®ç”¨å·¥å…· é“¾æ¥ æè¿° Gearn Git Branching é€šè¿‡æ¸¸æˆé—¯å…³çš„æ–¹å¼å­¦ä¹  gitï¼ PicGo ä¸€ä¸ªå¾ˆå¥½çš„å¼€æºçš„å›¾åºŠç®¡ç†æ¡Œé¢ç¨‹åºï¼Œå›¾åºŠç¥å™¨æ”¯æŒå¾®åšå›¾åºŠã€ä¸ƒç‰›å›¾åºŠã€è…¾è®¯äº‘ COSã€åˆæ‹äº‘ã€GitHub å›¾åºŠã€é˜¿é‡Œäº‘ OSSã€Imgur å›¾åºŠç­‰ç­‰ Proxyee Down ç™¾åº¦äº‘ä¸‹è½½è§£å†³æ–¹æ¡ˆï¼Œæ»¡é€Ÿä¸‹è½½ï¼Œä½†ä¸é™äºç™¾åº¦äº‘çš„ä¸‹è½½ï¼Œæ„Ÿè§‰æ¯”è¿…é›·è¿˜å¥½ç”¨ï¼ PanDownload è¿™æ˜¯ pandownload ç½‘é¡µç‰ˆï¼ŒæŠŠéœ€è¦ä¸‹è½½çš„ç™¾åº¦ç½‘ç›˜é“¾æ¥baiduæ”¹æˆbaiduwpå³å¯åŠ é€Ÿï¼Œä¹Ÿæœ‰æ¡Œé¢ç‰ˆã€‚ ubuntu pastebin ä»£ç å±•ç¤ºæ‰˜ç®¡ï¼Œç”Ÿæˆåˆ†äº«ç½‘å€ï¼Œé˜²æ­¢ä»£ç ç›´æ¥åˆ†äº«ç¼©è¿›æ¶ˆå¤± å›¾ç‰‡è½¬å­—ç¬¦å·¥å…· Imgâ€“\u003eString everyfont ä¸­æ–‡å­—åº“åœ¨çº¿å‹ç¼© å­—è›› font-spider ä¸­æ–‡å­—åº“å‹ç¼© mdtr2pdf markdown è½¬ pdf ADâ€™s API åŒ…æ‹¬åŠ¨æ€ç­¾åï¼Œç½‘æ˜“éŸ³ä¹ç­‰ åœ¨çº¿å·¥å…· w3cschool çš„åœ¨çº¿å·¥å…·é›†åˆ åœ¨çº¿å·¥å…· å¼€æºä¸­å›½ç¤¾åŒº èœé¸Ÿå·¥å…· èœé¸Ÿæ•™ç¨‹ åœ¨çº¿å·¥å…·ï¼Œç¼–è¯‘ï¼ŒåŠ å¯†ï¼Œå‹ç¼©ä»£ç ç­‰ msdn windows ç³»ç»Ÿä¸Š office ç­‰è½¯ä»¶ä¸‹è½½ï¼ˆå¤‡ç”¨ï¼‰ è€æ®ç§‘æŠ€ Adobe ç­‰å„ç§ç»¿è‰²ç ´è§£è½¯ä»¶ ç™¾åº¦æ¥å£ ç™¾åº¦æœç´¢å…³é”®è¯æ¥å£ åœ¨çº¿çŸ­ä¿¡ ä¸æƒ³æ³„éœ²ä¸ªäººçš„ç”µè¯å·ç ï¼Œæ³¨å†Œä¸€äº›ä¸€æ¬¡æ€§ç½‘ç«™å¯ä»¥ç”¨åˆ° é…éŸ³é˜ æ–‡å­—è½¬æ¢è¯­éŸ³/è¯­éŸ³åˆæˆå¹¿å‘Šå«å–å½•éŸ³åœ¨çº¿é…éŸ³ç½‘ç»œè½¯ä»¶_ä¿ƒé”€å®£ä¼ ç‰‡é…éŸ³-é…éŸ³é˜-é…éŸ³é˜ï¼Œå›½å†…ä¸“ä¸šçš„å¹¿å‘Šé…éŸ³å¹³å° hacknical åœ¨çº¿ä¸ªæ€§ç®€å†ï¼Œä¸ªäºº Github æ€»ç»“åˆ†æ ","date":"2018-06-07","objectID":"/posts/links/:5:0","tags":["ACM"],"title":"å„ç§ Links æ±‡æ€»ä¸åˆ†äº«","uri":"/posts/links/"},{"categories":["Memo"],"content":"å…¶ä»– é“¾æ¥ æè¿° ä¿„ç½—æ–¯æ–¹å— è¿™æ˜¯ä¸€ä¸ªå¼€æºçš„æ¸¸æˆï¼Œå°ç™½çš„æˆ‘çœ‹æ¥ç®€ç›´ç‰›é€¼çˆ†äº†ï¼Œå¥½é€¼çœŸï¼Œåˆ·æ–°éƒ½ä¸ä¼šæ‰“æ–­æ¸¸æˆè¿›åº¦ï¼ï¼ ç½‘å€è¿·å®« nazo_game ä¸€ä¸ªç¨‹åºå‘˜çš„ç½‘é¡µæ¸¸æˆï¼Œæˆ‘åªç©åˆ° 12 å…³ã€‚ æ— æŸéŸ³ä¹ä¸‹è½½ æ‰‹å†™ä½“åˆ¶ä½œ åŒ—äº¬å¤§å­¦è®¡ç®—æœºç§‘å­¦æŠ€æœ¯ç ”ç©¶æ‰€çš„ä¸€ä¸ªé¡¹ç›®59.108.48.27 ï¼ˆæˆ‘çš„å­—ä½“è‡³ä»Šè¿˜æœªå®Œæˆï¼‰ å¤§è±¡ä»£ç† æ”¶è´¹ï¼Œå£ç¢‘ä¸é”™ è’²å…¬è‹± åº”ç”¨å†…æµ‹å‘å¸ƒå¹³å° ","date":"2018-06-07","objectID":"/posts/links/:6:0","tags":["ACM"],"title":"å„ç§ Links æ±‡æ€»ä¸åˆ†äº«","uri":"/posts/links/"},{"categories":["Memo"],"content":"åšå®¢æ–‡ç«  æ–‡ç«  æ¦‚æ‹¬ Web ç¬”è®° è®°å½•ä¸€ä¸‹è‡ªå·± web ç›¸å…³å­¦ä¹ çš„ç¬”è®° Git å¸¸ç”¨æŒ‡ä»¤æ±‡æ€» å¯èƒ½ç”¨åˆ°æŒ‰éœ€è‡ªæŸ¥ hexo æ’ä»¶åŠ next å†…ç½®æ ·å¼é›† è®©æ–‡ç« å†™çš„å¥½çœ‹åˆç®€æ´åˆå¥½ç”¨çš„æ’ä»¶ï¼hexo æ›´å¤šè¯·çœ‹åˆ†ç±» hexo-theme-next @modified LRH å¯¹ next ä¸»é¢˜çš„ DIY è®¾è®¡è®°å½•æ—¥å¿— ä¸€æ¬¾è‡ªå·±å†™çš„å­—ä½“ - æ²ç›®ä½“ æ²ç›®ä½“â€“release ","date":"2018-06-07","objectID":"/posts/links/:7:0","tags":["ACM"],"title":"å„ç§ Links æ±‡æ€»ä¸åˆ†äº«","uri":"/posts/links/"},{"categories":["Memo"],"content":"æ›´å¤šå…³äº hexo ","date":"2018-06-01","objectID":"/posts/hexobuild/:0:0","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"é¦–å…ˆ å®˜æ–¹æ–‡æ¡£ æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€æ‰‹èµ„æ–™ï¼Œä¹Ÿæ˜¯æœ€å¥½çš„ã€‚ å®‰è£… Hexo ç›¸å½“ç®€å•ã€‚ç„¶è€Œåœ¨å®‰è£…å‰ï¼Œæ‚¨å¿…é¡»æ£€æŸ¥ç”µè„‘ä¸­æ˜¯å¦å·²å®‰è£…ä¸‹åˆ—åº”ç”¨ç¨‹åºï¼š Node.js Git ","date":"2018-06-01","objectID":"/posts/hexobuild/:1:0","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"hexo å®‰è£… å¦‚æœæ‚¨çš„ç”µè„‘ä¸­å·²ç»å®‰è£…ä¸Šè¿°å¿…å¤‡ç¨‹åºï¼Œé‚£ä¹ˆæ­å–œæ‚¨ï¼æ¥ä¸‹æ¥åªéœ€è¦ä½¿ç”¨ npm å³å¯å®Œæˆ Hexo çš„å®‰è£…ã€‚ npm install -g hexo-cli ","date":"2018-06-01","objectID":"/posts/hexobuild/:2:0","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"å»ºç«™ å®‰è£… Hexo å®Œæˆåï¼Œè¯·æ‰§è¡Œä¸‹åˆ—å‘½ä»¤ï¼ŒHexo å°†ä¼šåœ¨æŒ‡å®šæ–‡ä»¶å¤¹ä¸­æ–°å»ºæ‰€éœ€è¦çš„æ–‡ä»¶ã€‚ hexo init \u003cfolder\u003e cd \u003cfolder\u003e npm install ä¸ºä¸€ä¸ªæ–‡ä»¶å¤¹çš„åå­— æ–°å»ºå®Œæˆåï¼ŒæŒ‡å®šæ–‡ä»¶å¤¹çš„ç›®å½•å¦‚ä¸‹ï¼š . â”œâ”€â”€ _config.yml â”œâ”€â”€ package.json â”œâ”€â”€ scaffolds â”œâ”€â”€ source | â”œâ”€â”€ _drafts | â””â”€â”€ _posts â””â”€â”€ themes ","date":"2018-06-01","objectID":"/posts/hexobuild/:3:0","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"å®‰è£… hexo æ’ä»¶ å…¨è£…ä¸Šå§ï¼Œæ²¡äº‹ã€‚ npm install hexo-generator-index --save npm install hexo-generator-archive --save npm install hexo-generator-category --save npm install hexo-generator-tag --save npm install hexo-server --save npm install hexo-deployer-git --save npm install hexo-deployer-heroku --save npm install hexo-deployer-rsync --save npm install hexo-deployer-openshift --save npm install hexo-renderer-marked@0.2 --save npm install hexo-renderer-stylus@0.2 --save npm install hexo-generator-feed@1 --save npm install hexo-generator-sitemap@1 --save ","date":"2018-06-01","objectID":"/posts/hexobuild/:4:0","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"æœ¬åœ°æŸ¥çœ‹æ•ˆæœ æ‰§è¡Œä¸‹é¢è¯­å¥ï¼Œæ‰§è¡Œå®Œå†ç™»å½• localhost:4000 æŸ¥çœ‹æ•ˆæœï¼ˆæ‰§è¡Œå®Œä¸è¦æŒ‰ Ctrl+Cï¼Œä¸ç„¶å°±åœæ­¢äº†ï¼‰ hexo g hexo s å…¶ä»–æ­¥éª¤åœ¨è¿™é‡Œä¸èµ˜è¿°ï¼Œå‚è§ è¶…è¯¦ç»†æ•™ç¨‹ å®‰å“ä¸Šæ­å»º hexo åšå®¢ ","date":"2018-06-01","objectID":"/posts/hexobuild/:5:0","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"éƒ¨ç½² hexo g -d éƒ¨ç½²åæˆ‘ä»¬å¯ä»¥æµè§ˆå™¨æœ username.github.io æŸ¥çœ‹è‡ªå·±çš„åšå®¢æ•ˆæœï¼Œæ¯”å¦‚æˆ‘çš„ lruihao.github.io ","date":"2018-06-01","objectID":"/posts/hexobuild/:6:0","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"ç¾åŒ– è¿™äº›ç¾åŒ–éƒ½å†™çš„å¾ˆè¯¦ç»†ï¼Œæˆ‘å»ºè®®ä½ ä»¬è‡ªå·±å¥½å¥½çœ‹çœ‹å§ï¼Œæˆ‘ä¹Ÿæ˜¯åœ¨è¿™é‡Œçœ‹åˆ°çš„ï¼Œå¦‚æœé—®æˆ‘å’Œè¿™é‡Œè¯´çš„æ˜¯ä¸€æ ·çš„ã€‚ hexo ä¸ªæ€§åŒ–æ•™ç¨‹ valine ç‰¹åˆ«é¸£è°¢èµµä¿Š ğŸ‘ asdfv1929 hexo å®˜æ–¹ä¸»é¢˜é›†åˆï¼Œæˆ‘ç”¨çš„æ˜¯ aloha ä¸»é¢˜ï¼Œè¯¥ä¸»é¢˜ å®˜æ–¹æ–‡æ¡£ï¼Œåæ”¹ç”¨ next ä¸»é¢˜ next ä¸»é¢˜ hexo å®˜æ–¹æ’ä»¶ è¯´è¯´æˆ‘çš„ä¸»é¢˜é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œç”±äºè¿™ä¸ªä¸»é¢˜ç”¨çš„äººå°‘ï¼Œæ‰€ä»¥ä½œè€…ä¼˜åŒ–çš„ä¸æ˜¯å¾ˆå¥½ï¼ˆnext ä½¿ç”¨æœ€å¤šï¼‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åè¿‡æ¥è¯´ï¼Œæ‰€ä»¥è‡ªå·±ç¾åŒ–äº†ä¸€ç‚¹ ","date":"2018-06-01","objectID":"/posts/hexobuild/:7:0","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"åšæ–‡ç½®é¡¶ ä¿®æ”¹ hero-generator-index æ’ä»¶ï¼ŒæŠŠæ–‡ä»¶ï¼šnode_modules/hexo-generator-index/lib/generator.js å†…çš„ä»£ç æ›¿æ¢ä¸ºï¼š 'use strict'; var pagination = require('hexo-pagination'); module.exports = function(locals){ var config = this.config; var posts = locals.posts; posts.data = posts.data.sort(function(a, b) { if(a.top \u0026\u0026 b.top) { // ä¸¤ç¯‡æ–‡ç«  top éƒ½æœ‰å®šä¹‰ if(a.top == b.top) return b.date - a.date; // è‹¥ top å€¼ä¸€æ ·åˆ™æŒ‰ç…§æ–‡ç« æ—¥æœŸé™åºæ’ else return b.top - a.top; // å¦åˆ™æŒ‰ç…§ top å€¼é™åºæ’ } else if(a.top \u0026\u0026 !b.top) { // ä»¥ä¸‹æ˜¯åªæœ‰ä¸€ç¯‡æ–‡ç«  top æœ‰å®šä¹‰ï¼Œé‚£ä¹ˆå°†æœ‰ top çš„æ’åœ¨å‰é¢ï¼ˆè¿™é‡Œç”¨å¼‚æˆ–æ“ä½œå±…ç„¶ä¸è¡Œ 233ï¼‰ return -1; } else if(!a.top \u0026\u0026 b.top) { return 1; } else return b.date - a.date; // éƒ½æ²¡å®šä¹‰æŒ‰ç…§æ–‡ç« æ—¥æœŸé™åºæ’ }); var paginationDir = config.pagination_dir || 'page'; return pagination('', posts, { perPage: config.index_generator.per_page, layout: ['index', 'archive'], format: paginationDir + '/%d/', data: { __index: true } }); }; ","date":"2018-06-01","objectID":"/posts/hexobuild/:7:1","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"about é¡µé¢ about é¡µé¢å¯ä»¥ç”¨ HTML å†™ï¼Œä½ æƒ³æ€ä¹ˆå†™éƒ½è¡Œï¼Œæˆ‘ç”¨çš„æœ€ç®€å•çš„æ–¹æ³•ï¼Œç›´æ¥hexo n page \"about\"åï¼Œä¼šç”Ÿæˆä¸€ä¸ª md æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯åé¢è¯´çš„æ–‡ç« ï¼Œç›´æ¥å†™æ–‡ç« å°±è¡Œäº†ã€‚ ","date":"2018-06-01","objectID":"/posts/hexobuild/:7:2","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"æ·»åŠ æœç´¢ï¼Œè¯„è®ºï¼Œåˆ†äº« æœç´¢åŠŸèƒ½çœŸå¿ƒå¥½ç”¨ï¼Œå½“æ–‡ç« å¤šèµ·æ¥çš„æ—¶å€™ï¼Œæ ‡ç­¾æä¾›çš„ä½œç”¨å·²ç»å¾ˆå°‘äº†ï¼Œåªèƒ½ç®€å•ç´¢å¼•ï¼Œæœç´¢å´èƒ½ç²¾ç¡®æŸ¥æ‰¾ï¼Œè¿™é‡Œæˆ‘ç”¨çš„ä¾æ—§æ˜¯æœ€ç®€å•çš„æœ¬åœ°ç«™å†…æœç´¢ã€‚ å®‰è£…hexo-generator-searchdb åœ¨ç«™ç‚¹çš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š npm install hexo-generator-searchdb --save é…ç½®ç«™ç‚¹é…ç½®æ–‡ä»¶ æ–°å¢ä»¥ä¸‹å†…å®¹åˆ°ä»»æ„ä½ç½®ï¼š search: path: search.xml field: post format: html limit: 10000 é…ç½®ä¸»é¢˜é…ç½®æ–‡ä»¶ ## Local search local_search: enable: true algolia å‚è€ƒæ–‡ä»¶ è®©æœç´¢å¼•æ“æ‰¾åˆ°ä½ çš„åšå®¢ï¼Œè¿˜æ˜¯çœ‹åˆ°é‚±æ‰¿ä½³å­¦é•¿åšæ–‡æœ‰å†™åˆ° ä¼ é€é—¨ ","date":"2018-06-01","objectID":"/posts/hexobuild/:7:3","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"æ·»åŠ è®¿å®¢æ•°ï¼Œé˜…è¯»é‡ç­‰ è¯„è®ºæœ‰å¤šè¯´ï¼ˆå¤šè¯´å¥½åƒæŒ‚äº†ï¼‰ï¼Œè®¡æ•°æœ‰ä¸è’œï¼Œæˆ‘ç”¨çš„ä¸è’œå­ï¼Œè¿˜æœ‰å…¶ä»–çš„ã€‚ æ–‡ç« é˜…è¯»é‡ ä»¥ä¸‹é€‚åˆé next ä¸»é¢˜çš„éƒ¨åˆ†ä¸»é¢˜ï¼Œnext ä¸»é¢˜å·²ç»è‡ªå¸¦ï¼Œåˆ°ä¸»é¢˜é…ç½®æ–‡ä»¶ä¿®æ”¹å°±å¥½äº†ã€‚ æ‰“å¼€ä»¥ä¸‹è·¯å¾„åœ¨ä½ å–œæ¬¢çš„åœ°æ–¹æ·»åŠ ä»£ç ï¼Œ\\blog\\hexo\\themes\\ä¸»é¢˜åå­—ã€layout\\_partialï¼Œæ‰¾åˆ° article.ejsæ–‡ä»¶ \u003cdiv align=\"left\"\u003e \u003cspan id=\"busuanzi_container_page_pv\"\u003e æœ¬æ–‡æ€»é˜…è¯»é‡\u003cspan id=\"busuanzi_value_page_pv\"\u003e\u003c/span\u003eæ¬¡ \u003c/span\u003e \u003c/div\u003e ç«™ç‚¹è®¿é—®é‡ï¼Œè®¿å®¢æ•° æ‰“å¼€ä»¥ä¸‹è·¯å¾„åœ¨ä½ å–œæ¬¢çš„åœ°æ–¹æ·»åŠ ä»£ç ï¼Œ\\blog\\hexo\\themes\\ä¸»é¢˜åå­—ã€layout\\_partialï¼Œæ‰¾åˆ° footer.ejsæ–‡ä»¶ \u003cscript src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\" async defer\u003e\u003c/script\u003e \u003cspan id=\"busuanzi_container_page_pv\"\u003e æœ¬ç«™æ€»è®¿é—®é‡\u003cspan id=\"busuanzi_value_site_pv\"\u003e\u003c/span\u003eæ¬¡ | \u003c/span\u003e \u003cspan id=\"busuanzi_container_site_uv\"\u003e æœ¬ç«™è®¿å®¢æ•°\u003cspan id=\"busuanzi_value_site_uv\"\u003e\u003c/span\u003eäººæ¬¡ \u003c/span\u003e 2018.10.08 æ›´æ–° ä¸è’œå­å®˜ç½‘è¯´ä¸ƒç‰›å¼ºåˆ¶è¿‡æœŸåŸŸådn-lbstatics.qbox.me, æ‰€ä»¥ js æ–‡ä»¶ä½ç½®å‘ç”Ÿæ”¹å˜ï¼Œæ”¹ä¸ºbusuanzi.ibruce.info ","date":"2018-06-01","objectID":"/posts/hexobuild/:7:4","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":"å†™æ–‡ç«  hexo æ–‡ç« ç”¨è½»é‡å‹æ ‡ç­¾è¯­è¨€ Markdown ç¼–å†™ markdown å…¥é—¨ ç¹ä½“åŸå§‹æ–‡ä»¶ ç¹ä½“åŸå§‹æ–‡ä»¶ github ","date":"2018-06-01","objectID":"/posts/hexobuild/:8:0","tags":["Node.js","hexo"],"title":"hexo+github æ­å»ºä¸ªäººåšå®¢åŠç¾åŒ–","uri":"/posts/hexobuild/"},{"categories":["Memo"],"content":" å¦‚æœå®åœ¨æå¾—å¤´æ™•ç›´æ¥å» ç®€ä¹¦ å†™æ–‡ç« ï¼Œå†æŠŠç®€ä¹¦ç”Ÿæˆçš„ md æ–‡ç« å¤åˆ¶è¿‡æ¥å°±å¥½äº†ï¼ˆç®€ä¹¦æ˜¯ä¸ªä¸é”™çš„ Markdown åœ¨çº¿ç¼–è¾‘å™¨ï¼‰ï¼Œè¿˜å¯ä»¥å» é©¬å…‹é£è±¡ï¼Œä¸“ä¸ºå°è±¡ç¬”è®°æ‰“é€ çš„ Markdown ç¼–è¾‘å™¨ï¼Œtypora ä¹Ÿæ˜¯ä¸é”™çš„ï¼Œçªç„¶å‘ç° csdn ä¹Ÿæ”¯æŒ Markdown ç¼–è¯‘å™¨äº† ","date":"2018-05-31","objectID":"/posts/hexowrite/:0:0","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"1. é¦–å…ˆ åˆšåˆšæ­åšå®¢ï¼Œå¾ˆå¤šéƒ½ä¸æ‡‚ï¼Œå°±è¿æ’å…¥å›¾ç‰‡çš„è·¯å¾„é—®é¢˜éƒ½æŠŠæˆ‘æ•´çš„è¦å‘½ã€‚ï¼ˆæˆ‘ç”¨çš„ Sublime Text 3 ç¼–è¯‘å™¨ï¼‰ ä¸‹é¢è®²è®²ï¼š ","date":"2018-05-31","objectID":"/posts/hexowrite/:1:0","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"1.1 è®¾ç½®ç«™ç‚¹é…ç½®_config.yml post_asset_folder: true ","date":"2018-05-31","objectID":"/posts/hexowrite/:1:1","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"1.2 å®‰è£…æ’ä»¶ npm install https://github.com/CodeFalling/hexo-asset-image -- save ","date":"2018-05-31","objectID":"/posts/hexowrite/:1:2","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"1.3 ä¸‹æ¬¡å†è¿è¡Œ hexo n â€œxxxx\"æ¥ç”Ÿæˆ md åšæ–‡æ—¶ï¼Œä¸‹è·¯å¾„ /source/_posts æ–‡ä»¶å¤¹å†…é™¤äº† xxxx.md æ–‡ä»¶è¿˜æœ‰ä¸€ä¸ªåŒåçš„æ–‡ä»¶å¤¹ï¼Œåœ¨ xxxx.md ä¸­æƒ³å¼•å…¥å›¾ç‰‡æ—¶ï¼Œå…ˆæŠŠå›¾ç‰‡å¤åˆ¶åˆ° xxxx è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œç„¶ååªéœ€è¦åœ¨ xxxx.md ä¸­æŒ‰ç…§ markdown çš„æ ¼å¼å¼•å…¥å›¾ç‰‡ã€‚ ","date":"2018-05-31","objectID":"/posts/hexowrite/:1:3","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"2. æ·»åŠ å›¾ç‰‡ é¦–å…ˆå¤§å®¶å¯ä»¥æŸ¥çœ‹ hexo å®˜æ–¹æ–‡æ¡£ èµ„æºæ–‡ä»¶å¤¹ç« èŠ‚ ","date":"2018-05-31","objectID":"/posts/hexowrite/:2:0","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"2.1 markdown æ·»åŠ  ç›¸å¯¹è·¯å¾„æ·»åŠ ï¼ˆæˆ‘è¢«è¿™ä¸ªç›¸å¯¹è·¯å¾„æå¾—è¦æ­»ï¼Œå‰é¢å„ç§å‡ºé”™ï¼Œå¤§å®¶å¯ä»¥å¯¹ç…§æˆ‘çš„æ¥æ’å…¥å›¾ç‰‡ â€¦ï¼‰ #ç›´æ¥å†™å›¾ç‰‡åå°±å¥½äº†ï¼Œå›¾ç‰‡å®ä¾‹è§ä¸‹ ![kyrie irving](294136.jpg) #å¦‚æœæ”¹äº† Permalink å°±è¦åŠ ä¸Šæ–‡ç« åï¼Œå³åŒåæ–‡ä»¶å¤¹å ![kyrie irving](hexo-æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘/294136.jpg) #ä»£ç å‹ç¼©åå‰é¢è¿˜è¦åŠ ä¸€ä¸ª/ ![kyrie irving](/hexo-æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘/294136.jpg) ","date":"2018-05-31","objectID":"/posts/hexowrite/:2:1","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"2.2 æ’ä»¶æ·»åŠ  ä¼ é€é—¨ è¿™ç§æ–¹å¼è¢«å¾ˆå¤šäººè¯Ÿç—…ï¼Œä½†æœ‰æ—¶å€™ä¹Ÿä¸å¤±ä¸€ç§å¥½æ–¹å¼ï¼Œç®€å•å¿«æ·ã€‚ è¿˜æœ‰å›¾ç‰‡åå­—æ˜¾ç¤ºï¼Œä¸é”™çš„ã€‚ {% asset_img 297787.jpg kyrie irving %} ","date":"2018-05-31","objectID":"/posts/hexowrite/:2:2","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"3. éŸ³ä¹ å¤§å®¶å¯ä»¥çœ‹ ç½‘æ˜“äº‘éŸ³ä¹ çš„å®˜ç½‘ï¼Œæ’­æ”¾éŸ³ä¹å¯ä»¥ç”Ÿæˆå¤–é“¾ï¼Œç›´æ¥æ‹¿æ¥ç”¨å°±è¡Œäº†ã€‚iframe æ’ä»¶å¯ä»¥åœ¨ä»£ç ä¸­è®¾ç½®å®½é«˜ç­‰å‚æ•°ï¼Œauto ä¸ºè‡ªåŠ¨æ’­æ”¾ã€‚flash ä¸å¯ä»¥è‡ªå·±è®¾ç½®å‚æ•°ã€‚çœ‹å–œå¥½ï¼Œéšä¾¿ä½ ã€‚ å…¶ä»–éŸ³ä¹ï¼ŒæŠŠæ’ä»¶ä¸­çš„é“¾æ¥æ›¿æ¢æˆè¦æ’­æ”¾çš„é“¾æ¥å°±å¯ä»¥äº† #iframe æ’ä»¶ \u003ciframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=86 src=\"//music.163.com/outchain/player?type=2\u0026id=66651\u0026auto=0\u0026height=66\"\u003e \u003c/iframe\u003e #flash æ’ä»¶ \u003cembed src=\"//music.163.com/style/swf/widget.swf?sid=40249713\u0026type=2\u0026auto=0\u0026width=320\u0026height=66\" width=\"340\" height=\"86\" allowNetworking=\"all\"\u003e \u003c/embed\u003e ","date":"2018-05-31","objectID":"/posts/hexowrite/:3:0","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"4. æ·»åŠ é“¾æ¥ [æˆ‘çš„å¾®åš](https://weibo.com/liahao) {% link text url title %} ","date":"2018-05-31","objectID":"/posts/hexowrite/:4:0","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"5. æ·»åŠ è§†é¢‘ è§†é¢‘é“¾æ¥æœ€å¥½æ˜¯æ‰“å¼€å°±æ˜¯è§†é¢‘çš„é“¾æ¥ï¼ˆyoukuï¼ŒYouTubeï¼ŒæŠ–éŸ³ç­‰ï¼‰ å¯ä»¥æŠŠè§†é¢‘ä¸Šä¼ åˆ°ä¼˜é…·ï¼ŒæŠ–éŸ³ç­‰ç”Ÿæˆå¤–é“¾å†æ‹¿æ¥ç”¨ã€‚ï¼ˆä¼˜é…·ä¸Šä¼ éœ€è¦æ³¨å†Œå’Œå®åè®¤è¯ï¼‰ æ’ä»¶å‚è€ƒèµ„æ–™ è‡ªæ‹æ‰‹å†™è§†é¢‘ï¼ˆä¼˜é…·ï¼‰ å®éªŒå®¤æ— èŠæ‹çš„ \u003ciframe height=500 width=100% src=\"https://player.youku.com/embed/XMzY0MzgxNDMyOA==\" frameborder=0 allowfullscreen\u003e \u003c/iframe\u003e ","date":"2018-05-31","objectID":"/posts/hexowrite/:5:0","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["Memo"],"content":"å·¥å…·é›†åˆ Picgo é©¬å…‹é£è±¡ã€CSDNã€ç®€ä¹¦ SM.MS å›¾åºŠ ","date":"2018-05-31","objectID":"/posts/hexowrite/:6:0","tags":["hexo"],"title":"hexo æ·»åŠ å›¾ç‰‡ï¼ŒéŸ³ä¹ï¼Œé“¾æ¥ï¼Œè§†é¢‘","uri":"/posts/hexowrite/"},{"categories":["éšç¬”"],"content":" â€œæ¯å¤©æ—©æ™¨å«é†’ä½ çš„ä¸æ˜¯é¬§é˜ï¼Œè€Œæ˜¯ä½ çš„å¤¢æƒ³ã€‚â€ æˆ‘æœ‰éé è‘—é€™ç¨®ä¿¡å¿µæ’ä¸‹ä¾†çš„æ—¥å­ï¼Œæˆ‘è¦‹éè‡ªå·±åŠªåŠ›çš„æ¨£å­ï¼Œè‡³æ–¼ç¾åœ¨çš„è‡ªå·±é…ä¸é…å¾—ä¸Šç•¶åˆåŠªåŠ›çš„è‡ªå·±ï¼Œ å…¶å¯¦ä¹Ÿä¸é‡è¦äº†ï¼Œé‚„æœ›æŠ«èŠæ–¬æ£˜ï¼Œä¸æ”¹åˆå¿ƒã€‚ ä¸æ€•è¬äººé˜»æ“‹ï¼Œåªæ€•è‡ªå·±æŠ•é™ã€‚ä½ å¦‚ä½•å›æ†¶ï¼Œæ±ºå®šä½ æ˜¯ä¸€å€‹æ€æ¨£çš„äººï¼ å¾å¤§ä¸€ä¼Šå§‹ï¼Œæ‰“ ACM æ¯”è³½ï¼Œè¨“ç·´åˆ·é¡Œï¼Œå†åˆ°æ¯…ç„¶æ±ºç„¶é›¢é–‹å¯¦é©—å®¤ï¼Œé¸æ“‡é™Œç”Ÿçš„ Web é–‹ç™¼ï¼Œå¾å·¥ä½œå‰çš„ä¸€ç„¡æ‰€çŸ¥åˆ°ï¼Œåˆ°å‰ç«¯é–‹ç™¼ï¼Œå¾Œç«¯é–‹ç™¼ï¼Œåˆ°æ•™å¯¦ç¿’ç”Ÿï¼Œåˆ°é¢è©¦æ–°äººï¼Œåˆ°é–‹å§‹ä¹å‘³ã€‚é€™ä¸€è·¯èµ°ä¾†ï¼Œå¥½å¥‡å¿ƒï¼Œæ¢ç´¢æ¬²ï¼Œçæ“‡é¨°ï¼Œæˆ–è¨±é‚„æœ‰æ„›æ„ï¼Œéƒ½æ˜¯æ”¯æ’æˆ‘çš„å‹•åŠ›ã€‚ æ™‚é–“ä¸¦ä¸æœƒå› ç‚ºä½ çš„è¿·èŒ«å’Œé²ç–‘è€Œåœç•™ï¼Œå°±åƒä½ åœ¨çœ‹åˆ°é€™ç¯‡åšå®¢çš„æ™‚å€™ï¼Œä¸çŸ¥é“æœ‰å¤šå°‘äººæ­£é¢¨é›¨å…¼ç¨‹è¶•èµ´å¤¢æƒ³ã€‚æ²’æœ‰èª°ç”Ÿä¾†å°±æ˜¯ç¥ç‰›ï¼Œåƒè£ä¹‹è¡Œï¼Œå§‹æ–¼è¶³ä¸‹ï¼æ¯”è‡ªå·±å„ªç§€çš„äººæœ‰å¾ˆå¤šï¼Œæ°¸é ä¸è¦æ„Ÿå‹•è‡ªå·±ï¼Œä¿æŒè¬™éœï¼Œæ²‰æ¾±è‡ªå·±ï¼Œæ„Ÿè¬æ¯ä¸€å€‹æ›¾ç¶“åŠªåŠ›çš„è‡ªå·±ã€‚ä¸å¿…åŸ·è‘—æ–¼éå»ï¼Œä¹Ÿä¸å¿…éåº¦æ“”æ†‚æœªä¾†ï¼Œæœ›æŠ«èŠæ–¬æ£˜ï¼Œä¸å¿˜åˆå¿ƒã€‚ æœ€é–‹å§‹å¯«åšå®¢ï¼Œæ˜¯åœ¨æ‰“ ACM çš„æ™‚å€™ï¼Œæ·±å—ä¸€å€‹å­¸é•·çš„åšå®¢å½±éŸ¿ï¼Œä»–çš„åšå®¢æ˜¯ hexo æ­å»ºçš„ï¼ŒID æ˜¯ [æˆç¢¼ä¸€ç”Ÿ]ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿç…§è‘«è˜†ç•«ç“¢ç”¨ hexo æ­å»ºäº†ä¸€å€‹ï¼Œä¸€ç”¨å°±æ˜¯ 3 å¹´ï¼Œåšå®¢åå­—åŸ â€œåšæ¡çœ¾é•·â€ æ”¹ä¸º â€œè èœçœ¾é•·â€ï¼Œå› ç‚ºä¸èƒ½ç”¨æˆèªä½œç‚ºç¶²ç«™åå­—ï¼Œå°±é€™å€‹åŸå› ã€‚ ç›´åˆ° 21 å¹´ä¸‹åŠå¹´ï¼Œå‡ç´š windows 11, ç³»çµ±å‡ºäº† BUG, æ•´ç†ç£ç›¤ä¸å°å¿ƒæŠŠä»£ç¢¼åˆªæ‰äº†ï¼Œå°±ä¹¾è„†æ›æˆ hugo äº†ã€‚ ç¾åœ¨ä¸¦æ²’æœ‰åˆ€æ§å…¥åº«ï¼Œé¦¬æ”¾å—å±±ï¼Œè¡¹æ˜¯åœ¨å¥”èµ´å¦ä¸€ç‰‡å±±æµ· ","date":"2018-05-28","objectID":"/posts/hello-world/:0:0","tags":["éšç¬”"],"title":"Hello World","uri":"/posts/hello-world/"},{"categories":null,"content":"ç¦»çº¿ - è èœçœ¾é•·","date":"0001-01-01","objectID":"/offline/","tags":null,"title":"","uri":"/offline/"}]