<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>C++ - åˆ†ç±» - yejian's blog</title><link>https://jianye0428.github.io/categories/c++/</link><description>C++ - åˆ†ç±» - yejian's blog</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>18817571704@163.com (Jian YE)</managingEditor><webMaster>18817571704@163.com (Jian YE)</webMaster><lastBuildDate>Mon, 31 Jul 2023 07:26:06 +0800</lastBuildDate><atom:link href="https://jianye0428.github.io/categories/c++/" rel="self" type="application/rss+xml"/><item><title>Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [4]</title><link>https://jianye0428.github.io/posts/partfour/</link><pubDate>Mon, 31 Jul 2023 07:26:06 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/partfour/</guid><description><![CDATA[<!-- <div class="details admonition quote">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>quote<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">note abstract info tip success question warning failure danger bug example quote</div>
    </div>
  </div> -->
<h1 id="å‰è¨€">å‰è¨€</h1>
<blockquote>
<p>Effective-C++æ€»ç»“ç³»åˆ—åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬äºŒéƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬3~4ç« ï¼Œå†…å®¹èŒƒå›´Rule13~25ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule13ç®€å†™ä¸ºR13ã€‚</p>
</blockquote>
<div class="details admonition Note">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>Effective-C++ç³»åˆ—List<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š</br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/partone/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/parttwo/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/partthree/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/partfour/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></div>
    </div>
  </div>
<p>ç”±äºåŸä¹¦åœ¨C++11ä¹‹å‰å†™æˆï¼Œæœ‰äº›ç°ä»£C++ç‰¹æ€§ä¸ä¼šæåŠï¼Œæ‰€ä»¥ä¼šæ ¹æ®æœ¬äºº<code>å¼€å‘ç»éªŒ</code>æ–°å¢ä¸€äº›ä¸ªäººæ„Ÿæ‚ŸğŸ‘‰<code>By the way</code>ç¯èŠ‚ã€‚</p>
<h2 id="ch7-æ¨¡æ¿ä¸æ³›å‹ç¼–ç¨‹">CH7 æ¨¡æ¿ä¸æ³›å‹ç¼–ç¨‹</h2>
<h3 id="r41-äº†è§£éšå¼æ¥å£å’Œç¼–è¯‘æœŸå¤šæ€">R41 äº†è§£éšå¼æ¥å£å’Œç¼–è¯‘æœŸå¤šæ€</h3>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é€šå¸¸åšæ³•ï¼š</p>
<ul>
<li><strong>æ˜¾å¼</strong>å®šä¹‰æ¥å£ï¼ˆå‚æ•°å’Œè¿”å›å€¼ç±»å‹éƒ½æ˜¯ç¡®å®šçš„ï¼Œå‡½æ•°ç­¾å å°±æ˜¯ç¡®å®šçš„ï¼‰</li>
<li>è™šå‡½æ•°å®ç°<strong>è¿è¡Œæ—¶å¤šæ€</strong></li>
</ul>
<p>é‚£ä¹ˆç¼–è¯‘æœŸå¤šæ€å‘¢ï¼Ÿåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„ç­”æ¡ˆé€šå¸¸æ˜¯å‡½æ•°é‡è½½ã€‚</p>
<p>åœ¨Templates åŠæ³›å‹ç¼–ç¨‹ä¸­ï¼Œæ›´ä¸ºæ³¨é‡çš„æ˜¯<strong>éšå¼æ¥å£</strong>å’Œ<strong>ç¼–è¯‘æœŸå¤šæ€</strong>ï¼š</p>
<ul>
<li><code>éšå¼æ¥å£</code>:
Templateçš„æ¥å£å±äºéšå¼æ¥å£ï¼Œå› ä¸ºå®ƒç±»å‹ä¸ç¡®å®šï¼Œæ‰€ä»¥æ˜¯åŸºäºæœ‰æ•ˆè¡¨è¾¾å¼æ¥åŒºåˆ†ã€‚å†åŠ ä¸Šè¿ç®—ç¬¦é‡è½½ç­‰ç‰¹æ€§ï¼Œéšå¼æ¥å£çš„è‡ªç”±åº¦éå¸¸å¤§ã€‚</li>
<li><code>ç¼–è¯‘æœŸå¤šæ€</code>:
Templateçš„å¤šæ€æ˜¯é€šè¿‡Templateå…·ç°åŒ–å’Œå‡½æ•°é‡è½½å†³è®®å‘ç”Ÿäºç¼–è¯‘æœŸã€‚</li>
</ul>
<p>ä¸Šè¿°æè¿°çœ‹èµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Œåˆ†æä¸‹æ–¹Templateå‡½æ•°ä»£ç ï¼š</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">doProcessing</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">w</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="o">&amp;&amp;</span> <span class="n">w</span> <span class="o">!=</span> <span class="n">someNastyWidget</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>doProcessingå±äºéšå¼æ¥å£ï¼Œç±»å‹ä¸å®šï¼Œä¼ å…¥ä¸åŒç±»å‹Tï¼Œå°±å¾—åˆ°ä¸åŒçš„å‡½æ•°ã€‚</p>
<p>ç”±äº <code>æ“ä½œç¬¦é‡è½½(operator overloading)</code> çš„å­˜åœ¨ï¼Œéšå¼æ¥å£å¯¹ä¼ å…¥çš„ T ç±»å‹çš„è¦æ±‚æ¯”è¾ƒå®½æ¾ï¼Œåˆ—ä¸¾å¦‚ä¸‹ï¼š</p>
<ol>
<li>Tç±»å‹æˆ–å…¶çˆ¶ç±»å‹å…·æœ‰ size() æ¥å£ï¼Œsize() æ¥å£è¿”å›ç±»å‹Sä¸ºæ•´å‹æˆ–è€…Sç±»å‹æœ‰ <code>bool operator&gt;(int)</code> æ¥å£ï¼›</li>
<li>Tç±»å‹æœ‰ <code>bool operator != (const T&amp;)</code>æ¥å£ï¼›æˆ–Tç±»å‹å¯ä»¥éšå¼è½¬æ¢ä¸ºæŸSç±»å‹ï¼ŒSå¯ä»¥ä¸someNastyWidgetè¿›è¡Œ != æ¯”è¾ƒï¼Œæˆ–è€…å¹²è„†someNastyWidgetå°±æ˜¯Tç±»å‹ï¼›</li>
<li>ä¸Šè¿°1 ã€ 2 ç‚¹çš„æè¿°æ²¡æœ‰å°† <code>operator &amp;&amp;</code> è€ƒè™‘è¿›æ¥ï¼Œå¦åˆ™æƒ…å†µä¼šæ›´ä¸ºå¤æ‚ï¼Œè¿™é‡Œä¸èµ˜è¿°äº†ã€‚</li>
</ol>
<h3 id="r42-äº†è§£typenameçš„åŒé‡æ„ä¹‰">R42 äº†è§£typenameçš„åŒé‡æ„ä¹‰</h3>
<ul>
<li><code>typename</code> å’Œ <code>class</code> å…³é”®å­—åœ¨å£°æ˜ Template å‚æ•°çš„æ—¶å€™ï¼Œæ²¡æœ‰ä»»ä½•åŒºåˆ«
å¦‚ä¸‹ç¤ºä¾‹ï¼Œæ•ˆæœæ˜¯ä¸€è‡´çš„ï¼š</li>
</ul>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">Widget</span> <span class="p">;</span> <span class="c1">//æ—©æœŸC++ä½¿ç”¨è¿™ä¸ªå£°æ˜Templateå‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">Widget</span><span class="p">;</span> <span class="c1">//ç°åœ¨æ›´æ¨èç”¨è¿™ä¸ªï¼Œæš—ç¤ºå‚æ•°ä¸ä¸€å®šæ˜¯ä¸ªclassç±»å‹
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>ä½¿ç”¨å…³é”®å­— <code>typename</code> æ ‡è¯† <strong>åµŒå¥—ä»å±ç±»å‹åç§°</strong>
æ¨¡æ¿å†…çš„ä»å±ç±»å‹ï¼Œæ˜¯æŒ‡åœ¨æ¨¡æ¿å‡½æ•°/æ¨¡æ¿ç±»ä¸­ï¼Œéœ€è¦<strong>ä¾èµ–ä¼ å…¥çš„ template å‚æ•°é—´æ¥è¡¨ç¤º</strong>çš„ç±»å‹ï¼Œå¦‚æœå‘ˆåµŒå¥—çŠ¶ï¼Œå°±å«åµŒå¥—ä»å±åç§°/ç±»å‹ã€‚ å¦‚ä¸‹ç¤ºä¾‹çš„ <code>C::const_iterator</code> å°±æ˜¯åµŒå¥—ä»å±ç±»å‹ã€‚</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">C</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">printContainer2ndVal</span><span class="p">(</span><span class="k">const</span> <span class="n">C</span><span class="o">&amp;</span> <span class="n">container</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">container</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">typename</span> <span class="n">C</span><span class="o">::</span><span class="n">const_iterator</span> <span class="n">iter</span><span class="p">(</span><span class="n">container</span><span class="p">.</span><span class="n">begin</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;this container&#39;s second value is: &#34;</span> <span class="o">&lt;&lt;</span> <span class="o">*++</span><span class="n">iter</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¤æ—¶ï¼Œtypename çš„ä½œç”¨å°±æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ C::const_iterator æ˜¯ä¸ªç±»å‹ï¼Œå¦åˆ™ä¼šç¼–è¯‘æŠ¥é”™ã€‚æ­¤æ—¶å¯ä»¥ç”¨ class å…³é”®å­—æ›¿ä»£ï¼Œä½†æ˜¯ä¸å»ºè®®ã€‚</p>
<p>typename ä½¿ç”¨èŒƒå›´ä¸åªæ˜¯ template å‡½æ•°å†…éƒ¨ï¼Œä¹ŸåŒ…æ‹¬äº†å‡½æ•°å…¥å‚ ï¼š</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">C</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">foo</span><span class="p">(</span><span class="k">const</span> <span class="n">C</span><span class="o">&amp;</span> <span class="n">container</span><span class="p">,</span>    <span class="c1">// ä¸å…è®¸ä½¿ç”¨ &#34;typename&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">typename</span> <span class="n">C</span><span class="o">::</span><span class="n">iterator</span> <span class="n">iter</span><span class="p">);</span> <span class="c1">// å¿…é¡»ä½¿ç”¨ &#34;typename&#34;
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>âš ï¸ å…¶ä»–ç‰¹æ®Šæƒ…å†µï¼šä¸è¦åœ¨ åŸºç±»åˆ—è¡¨base class list æˆ– æˆå‘˜åˆå§‹åŒ–åˆ—member initialization list ä½¿ç”¨ typename</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Derived</span><span class="o">:</span> <span class="k">public</span> <span class="n">Base</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">Nested</span><span class="p">{</span> <span class="c1">//åŸºç±»åˆ—è¡¨ä¸å…è®¸ä½¿ç”¨typename
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">explicit</span> <span class="n">Derived</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span><span class="o">:</span><span class="n">Base</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">Nested</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="c1">// æˆå‘˜åˆå€¼åˆ—ä¹Ÿä¸å…è®¸typename
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">typedef</span> <span class="k">typename</span> <span class="n">Base</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">Nested</span> <span class="n">NestedType</span><span class="p">;</span><span class="c1">//ç»“åˆtypedefå®šä¹‰ï¼Œå¸¸è§„ç”¨æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">NestedType</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span><span class="c1">// å…¶ä»–æ“ä½œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="r43-å­¦ä¹ å¤„ç†æ¨¡æ¿åŒ–åŸºç±»å†…çš„åç§°">R43 å­¦ä¹ å¤„ç†æ¨¡æ¿åŒ–åŸºç±»å†…çš„åç§°</h3>
<p><strong>æ¨¡æ¿åŒ–åŸºç±»</strong>ï¼šæŒ‡å®šä¹‰ template æ¨¡æ¿ç±»æ—¶ï¼Œç»§æ‰¿äºæŸåŸºç±» Base<T>ï¼Œè¿™ä¸ª Base<T> ç±»å°±æ˜¯æ¨¡æ¿åŒ–åŸºç±»ã€‚</p>
<p>ğŸ¤” é‚£ä¹ˆ Base<T> ç±»æœ‰å…³çš„å‡½æ•°ç­‰åç§°è¯¥å¦‚ä½•å¤„ç†ï¼Œåœ¨å­ç±»ä¸­ç›´æ¥ä½¿ç”¨å—ï¼Ÿè¿˜æ˜¯æœ‰æ³¨æ„äº‹é¡¹ï¼Ÿè¿™ï¼Œå°±æ˜¯æœ¬èŠ‚è¦è®¨è®ºçš„é—®é¢˜ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Company</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MsgSender</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">SendPlain</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;send plain</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">SendEncrypted</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;send encrypted</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>  <span class="c1">// åŸºç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">Company</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LoggingMsgSender</span><span class="o">:</span> <span class="k">public</span> <span class="n">MsgSender</span><span class="o">&lt;</span><span class="n">Company</span><span class="o">&gt;</span><span class="p">{</span><span class="c1">//å­ç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">SendPlainMsg</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">SendPlain</span><span class="p">();</span><span class="c1">//  ==&gt; è¿™æ ·ç›´æ¥è°ƒç”¨æ˜¯ä¸è¡Œçš„ï¼Œæƒ³æƒ³ä¸ºä»€ä¹ˆï¼Ÿ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šè¿°æ³¨é‡Šä¸­é—®é¢˜çš„åŸå› ï¼šå› ä¸ºå½“å…¨ç‰¹åŒ–æ—¶å¯éšæ„å»é™¤ MsgSender å†…çš„å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨æ— æ³•ç¡®å®šåŸºç±»æ˜¯å¦ä»æœ‰ SendPlain è¿™ä¸ªæ–¹æ³•ã€‚æ‰€ä»¥ï¼Œç¼–è¯‘å™¨å¹²è„†<strong>æ‹’ç»åœ¨ç¼–è¯‘æ—¶</strong>å»æ¨¡æ¿åŒ–åŸºç±»ä¸­<strong>ä¸»åŠ¨å¯»æ‰¾</strong>ç»§æ‰¿è€Œæ¥çš„åç§°ã€‚</p>
<p>è§£å†³æ–¹æ³•æœ‰ä¸‰ä¸ªï¼š</p>
<ol>
<li>ä½¿ç”¨ <code>this-&gt;</code> è°ƒç”¨SendPlain()ï¼Œå³å¯è½¬åŒ–ä¸ºè¿è¡Œæ—¶çš„é—®é¢˜ï¼Œæ¨èè¿™ä¸ªæ–¹æ³•ï¼›</li>
<li>ä½¿ç”¨ <code>using MsgSender::SendPlain;</code> è¿™æ ·çš„ using å£°æ˜å¼ï¼Œæˆ‘ä»¬åœ¨ Rule 33: é¿å…é®æ©ç”±ç»§æ‰¿å¾—æ¥çš„åç§° ä¸­ç”¨è¿‡è¿™ç§æ–¹æ³•ï¼Œæ˜¾å¼åœ°å‘Šè¯‰ç¼–è¯‘å™¨æ‰©å¤§åç§°æœç´¢èŒƒå›´ï¼Œå°è¯•å»åŸºç±»æ‰¾æ‰¾ï¼›</li>
<li>ä½¿ç”¨æ˜¾å¼è°ƒç”¨ï¼Œå³ <code>MsgSender::SendPlain();</code> ï¼Œä½†è¿™æ ·åšçš„åå¤„æ˜¯ç›´æ¥æ–­ç»äº† virtual å‡½æ•°çš„çµæ´»æ€§å’Œå¯èƒ½ï¼Œä¸å¤ªæ¨è</li>
</ol>
<h3 id="r44-å°†ä¸å‚æ•°æ— å…³çš„ä»£ç æŠ½ç¦»templates">R44 å°†ä¸å‚æ•°æ— å…³çš„ä»£ç æŠ½ç¦»templates</h3>
<p>é€šå¸¸ï¼Œåœ¨éæ¨¡æ¿ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºé‡å¤çš„ä»£ç æˆ–è€…ç±»ï¼Œä¸€èˆ¬é‡‡ç”¨æŠ½å–å…¬å…±éƒ¨åˆ†ä¸ºå•ç‹¬å‡½æ•°ï¼Œæˆ–è€…é‡‡ç”¨ç±»çš„ç»§æ‰¿/èšåˆç­‰é¢å‘å¯¹è±¡è®¾è®¡æ–¹å¼ã€‚</p>
<p>ä½†æ˜¯ï¼Œ template æœ‰å…³çš„ä»£ç ï¼Œæœ‰æ—¶ä»£ç é‡å¤æ˜¯éšæ™¦çš„ã€‚ è¿™ä¸€èŠ‚æ˜¯ä¸ºäº†è§£å†³ template çš„ <code>ä»£ç è†¨èƒ€(code bloat)</code> é—®é¢˜ï¼Œä¸»è¦åŸåˆ™ä¸º <code>å…±æ€§ä¸å·®å¼‚æ€§åˆ†æ(commonality and variability analysis)</code> ã€‚</p>
<p>**æŸäº›ä¸æ°å½“çš„è®¾è®¡ï¼Œä¼šå¯¼è‡´æ— ç•çš„ä»£ç è†¨èƒ€ã€‚**å…ˆçœ‹ä¸‹æ–¹è¿™ä¸ªåé¢æ•™æï¼š</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">n</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SquareMatrix</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">invert</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;size is &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åº”ç”¨ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//ä¸‹é¢è¿™2å¥ï¼Œæ¨¡æ¿ç±»å®ä¾‹åŒ– 1 æ¬¡ã€‚ invertå‡½æ•°æœ‰ 1 ä»½å®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">SquareMatrix</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="mi">5</span><span class="o">&gt;</span> <span class="n">mat5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">SquareMatrix</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="mi">5</span><span class="o">&gt;</span> <span class="n">mat5New</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//æ¢æˆä¸‹é¢è¿™2å¥ï¼Œæ¨¡æ¿ç±»å®ä¾‹åŒ– 2 æ¬¡ã€‚invertå‡½æ•°æœ‰ 2 ä»½å®ç°(é—®é¢˜æš´éœ²)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">SquareMatrix</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="mi">5</span><span class="o">&gt;</span> <span class="n">mat5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">SquareMatrix</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="mi">10</span><span class="o">&gt;</span> <span class="n">mat10</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>è†¨èƒ€åŸå› </strong>ï¼šåœ¨ç¼–è¯‘å™¨çœ‹æ¥ï¼ŒSquareMatrix&lt;int, 5&gt; å’Œ SquareMatrix&lt;int, 10&gt; æ˜¯2ä¸ª<strong>å®Œå…¨ä¸åŒçš„ C++ ç±»</strong>ï¼Œå®ä¾‹åŒ–äº†2æ¬¡ï¼Œç”Ÿæˆäº†è¿™2ä¸ªç±»ã€‚è¯•æƒ³ï¼Œå¦‚æœä»£ç ä¸­è¿˜éœ€è¦å…¶ä»– size çš„SquareMatrix ï¼Œéƒ½ä¼šå†ç”Ÿæˆä¸€ä¸ªæ–°ç±»ï¼Œé‚£ä¹ˆæœ€åäºŒè¿›åˆ¶æ–‡ä»¶å°±å¤šäº†è®¸å¤šé‡å¤çš„ç›®æ ‡ä»£ç ï¼Œä¹Ÿå°±æ˜¯è†¨èƒ€ã€‚</p>
<p>å¦‚æœèƒ½<strong>æŠ½ç¦»å‚æ•°ç›¸å…³ä»£ç </strong>ï¼Œåšåˆ°å°ºå¯¸æ— å…³ï¼Œä¾¿å¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p><strong>è§£å†³æ€è·¯</strong>ï¼šæ–°å»ºä¸€ä¸ªåŸºç±» BaseMatrix ï¼Œå°†å°ºå¯¸å‚æ•°ä¼ å…¥ç»™åˆ°åŸºç±»ä½œä¸ºæˆå‘˜å˜é‡ä¿ç®¡ï¼Œå…·ä½“çš„æ•°æ®å¯ä»¥ç”¨æ•°ç»„æŒ‡é’ˆå½¢å¼æ‰˜ç®¡ã€‚ä¸è®ºæœ‰å¤šå°‘ä¸ªä¸å°ºå¯¸æœ‰å…³çš„æ´¾ç”Ÿç±»ï¼Œä¸€ä¸ª T ç±»å‹å°±<strong>åªæœ‰ä¸€ä¸ªåŸºç±»</strong>ï¼Œæ‰€ä»¥åŸºç±» <code>baseInvert</code> <strong>å‡½æ•°å®ç°åªæœ‰ä¸€ä»½</strong>ã€‚</p>
<p><mark>åŸºç±»å®ç°</mark>ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BaseSqaureMatrix</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">BaseSqaureMatrix</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">n</span><span class="p">,</span><span class="n">T</span><span class="o">*</span> <span class="n">dataPtr</span><span class="p">)</span> <span class="o">:</span><span class="n">n_</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">dataPtr_</span><span class="p">(</span><span class="n">dataPtr</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">protected</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">baseInvert</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;invert: pData = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">dataPtr_</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; , size = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">n_</span>  <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">SetDataPtr</span><span class="p">(</span><span class="n">T</span><span class="o">*</span> <span class="n">dataPtr</span><span class="p">)</span> <span class="p">{</span> <span class="n">dataPtr_</span> <span class="o">=</span> <span class="n">dataPtr</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">n_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">T</span><span class="o">*</span> <span class="n">dataPtr_</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p><mark>ç›®æ ‡æ´¾ç”Ÿç±»</mark>å®ç°å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">n</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SquareMatrix</span> <span class="o">:</span> <span class="k">public</span> <span class="n">BaseSqaureMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">SquareMatrix</span><span class="p">()</span> <span class="o">:</span><span class="n">BaseSqaureMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="k">nullptr</span><span class="p">),</span> <span class="n">data_</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span> <span class="n">T</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">-&gt;</span><span class="n">SetDataPtr</span><span class="p">(</span><span class="n">data_</span><span class="p">.</span><span class="n">get</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">invert</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">baseInvert</span><span class="p">();</span> <span class="p">}</span><span class="c1">// å‚è€ƒRule43
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">data_</span> <span class="p">;</span><span class="c1">// RAIIç®¡ç†èµ„æº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€ç»ˆæ•ˆæœï¼šç›¸åŒ T ç±»å‹çš„templateå®ä¾‹ç±»(æ¯”å¦‚SquareMatrix&lt;float,5&gt;å’ŒSquareMatrix&lt;float,6&gt;)ï¼Œ<mark>å…±äº«å®ç°ç </mark>ï¼Œç¥›é™¤ä»£ç è†¨èƒ€ã€‚</p>
<h3 id="r45-è¿ç”¨æ¨¡æ¿æˆå‘˜å‡½æ•°æ¥å—æ‰€æœ‰å…¼å®¹ç±»å‹">R45 è¿ç”¨æ¨¡æ¿æˆå‘˜å‡½æ•°æ¥å—æ‰€æœ‰å…¼å®¹ç±»å‹</h3>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œ<code>Base *pBase = pDerived</code>; è¿™æ ·æ™®é€šç±»å‹è£¸æŒ‡é’ˆçš„éšå¼è½¬æ¢æ˜¯è¢« C++ æ‰€è®¤å¯çš„ã€‚</p>
<p>é‚£ä¹ˆå¦‚æœæ¢æˆæ™ºèƒ½æŒ‡é’ˆæ¨¡æ¿ç±» SmartPtr<Base> å’Œ SmartPtr <Derived> å‘¢ï¼Œè¿˜èƒ½è¿™æ ·<strong>ä¸éœ€é¢å¤–é…ç½®</strong>å°±éšæ„è½¬æ¢å—ï¼Œç­”æ¡ˆæ˜¾ç„¶<strong>æ˜¯ä¸è¡Œ</strong>çš„ï¼ˆçºµç„¶ Base å’Œ Derived æ˜¯å…¼å®¹ç±»å‹ä¹Ÿä¸è¡Œï¼‰ã€‚</p>
<p>æœ¬èŠ‚ï¼Œå°±é‡‡ç”¨<mark>æ¨¡æ¿æˆå‘˜å‡½æ•°</mark>æ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<ul>
<li><strong>ä½¿ç”¨æ¨¡æ¿æˆå‘˜å‡½æ•°ï¼Œæ¥å—æ‰€æœ‰å…¼å®¹ç±»å‹çš„â€œæ³›åŒ–æ„é€ â€/â€œæ³›åŒ–èµ‹å€¼â€</strong>
<code>æ³›åŒ–(generalized)Copyæ„é€ </code>ï¼Œæ˜¯æŒ‡æ¥å—å…¶ä»–å…¼å®¹ç±»å‹è¿›è¡Œæ¨¡æ¿å‡½æ•°çš„Copyæ„é€ ã€‚ä¸¾ä¾‹ä¸€ä¸ªç²—ç³™çš„ RAII æ™ºèƒ½æŒ‡é’ˆå®ç°ï¼Œä»£ç å¦‚ä¸‹ğŸ‘‡:
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SmartPtr</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">SmartPtr</span><span class="p">(</span><span class="n">T</span><span class="o">*</span> <span class="n">origPtr</span><span class="p">)</span> <span class="o">:</span><span class="n">originPtr_</span><span class="p">(</span><span class="n">origPtr</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">  <span class="n">SmartPtr</span><span class="p">(</span><span class="k">const</span> <span class="n">SmartPtr</span><span class="o">&amp;</span> <span class="n">smt</span><span class="p">)</span> <span class="o">:</span><span class="n">originPtr_</span><span class="p">(</span><span class="n">smt</span><span class="p">.</span><span class="n">get</span><span class="p">())</span> <span class="p">{}</span><span class="c1">// æ­£å¸¸Copyæ„é€ å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//æ­£å¸¸copyæ“ä½œç¬¦å‡½æ•°: ç®€å•æ¼”ç¤ºï¼Œå°±æµ…å¤åˆ¶å§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">SmartPtr</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">SmartPtr</span><span class="o">&amp;</span> <span class="n">smt</span><span class="p">)</span> <span class="p">{</span> <span class="n">originPtr_</span> <span class="o">=</span> <span class="n">smt</span><span class="p">.</span><span class="n">get</span><span class="p">();</span> <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">U</span><span class="o">&gt;</span> <span class="c1">//æ³›åŒ–æ„é€ å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">SmartPtr</span><span class="p">(</span><span class="k">const</span> <span class="n">SmartPtr</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&amp;</span> <span class="n">other</span><span class="p">)</span><span class="o">:</span><span class="n">originPtr_</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">get</span><span class="p">())</span> <span class="p">{</span> <span class="p">}</span> <span class="c1">//ä¸ºäº†éšå¼è½¬æ¢ä¸åŠ  explict
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">U</span><span class="o">&gt;</span> <span class="c1">//æ³›åŒ–èµ‹å€¼æ“ä½œç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">SmartPtr</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">SmartPtr</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&amp;</span> <span class="n">other</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">originPtr_</span> <span class="o">=</span> <span class="n">other</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span><span class="c1">//ç®€å•æ¼”ç¤ºï¼Œæµ…å¤åˆ¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">T</span><span class="o">*</span> <span class="nf">get</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">originPtr_</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">~</span><span class="n">SmartPtr</span><span class="p">()</span> <span class="p">{</span> <span class="k">delete</span> <span class="n">originPtr_</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">T</span><span class="o">*</span> <span class="n">originPtr_</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div>æœ‰ä¸Šè¿°çš„ä»£ç æ”¯æŒï¼Œæˆ‘ä»¬å°±èƒ½å†™å‡ºå¦‚ä¸‹çš„åº”ç”¨ä»£ç ï¼š
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BaseObj</span><span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">DerivedObj</span><span class="o">:</span><span class="k">public</span> <span class="n">BaseObj</span> <span class="p">{};</span><span class="c1">//DerivedObjæ˜¯BaseObjå…¼å®¹ç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">SmartPtr</span><span class="o">&lt;</span><span class="n">DerivedObj</span><span class="o">&gt;</span> <span class="n">smDerived</span><span class="p">(</span><span class="k">new</span> <span class="n">DerivedObj</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="n">SmartPtr</span><span class="o">&lt;</span><span class="n">BaseObj</span><span class="o">&gt;</span> <span class="n">smBase</span><span class="p">(</span><span class="n">smDerived</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">SmartPtr</span><span class="o">&lt;</span><span class="n">BaseObj</span><span class="o">&gt;</span> <span class="n">smBase2</span> <span class="o">=</span> <span class="n">smDerived</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li><strong>å³ä½¿æœ‰ â€œæ³›åŒ–æ„é€ / èµ‹å€¼â€ï¼Œä¹Ÿéœ€è¦æ­£å¸¸çš„ Copyæ„é€ /èµ‹å€¼</strong>
æ³¨æ„ï¼Œæ¨¡æ¿æˆå‘˜å‡½æ•°ä¸ä¼šæ”¹å˜è¯­è¨€è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´â€œæ³›åŒ–æ„é€ â€ä¸èƒ½ä»£æ›¿æ­£å¸¸çš„ copy æ„é€ å‡½æ•°ã€‚æ‰€ä»¥ï¼Œéœ€è¦åŒæ—¶å£°æ˜æ­£å¸¸çš„ Copy æ„é€ å‡½æ•°å’Œ Copy èµ‹å€¼æ“ä½œç¬¦å‡½æ•°ã€‚</li>
</ul>
<h3 id="r46-éœ€è¦ç±»å‹è½¬æ¢æ—¶è¯·ä¸ºæ¨¡æ¿å®šä¹‰éæˆå‘˜å‡½æ•°">R46 éœ€è¦ç±»å‹è½¬æ¢æ—¶è¯·ä¸ºæ¨¡æ¿å®šä¹‰éæˆå‘˜å‡½æ•°</h3>
<p>æœ‰æ—¶æˆ‘ä»¬å¸Œæœ› class æ”¯æŒç±»å‹è½¬æ¢ï¼Œç±»ä¼¼æœ¬ä¹¦çš„å¦å¤–ä¸€èŠ‚ğŸ‘‰ <a href="https://jianye0428.github.io/posts/parttwo/#r24-%E8%8B%A5%E6%89%80%E6%9C%89%E5%8F%82%E6%95%B0%E7%9A%86%E9%9C%80%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E8%AF%B7%E9%87%87%E7%94%A8non-member"target="_blank" rel="external nofollow noopener noreferrer">Rule24:è‹¥æ‰€æœ‰å‚æ•°çš†éœ€ç±»å‹è½¬æ¢ï¼Œè¯·é‡‡ç”¨non-member<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> ã€‚</p>
<p>å¦‚æœ Rule24 ä¸­çš„ Rational ç±»æ˜¯ template æ¨¡æ¿ç±»ï¼Œç›´æ¥ä»¿ç…§ Rule24 åˆ©ç”¨ non-member å‡½æ•°åšæ··åˆè¿ç®—æ˜¯è¡Œä¸é€šçš„ï¼ŒåŸå› æ˜¯ <strong>template å®å‚æ¨å¯¼</strong>æ˜¯ä¸é‡‡çº³ â€œé€šè¿‡æ„é€ å‡½æ•°è€Œå‘ç”Ÿçš„â€éšå¼ç±»å‹è½¬æ¢ã€‚</p>
<p>è§£å†³åŠæ³•å¦‚ä¸‹:</p>
<ul>
<li>
<p><strong>ä½¿ç”¨ â€œtemplate class å†…éƒ¨çš„friendå‡½æ•°â€ å®Œæˆå‚æ•°éšå¼è½¬æ¢</strong>
å°† Rule24 çš„ non-member çš„ <strong>operator *å‡½æ•°</strong>æ”¹ä¸º <code>inline-friend</code> å‡½æ•°ï¼Œå› ä¸º template å®ä¾‹åŒ–çš„æ—¶å€™éœ€è¦æ‰¾åˆ°è¯¥ friend å‡½æ•°çš„å®šä¹‰å®ç°ï¼Œç±»å¤–å®šä¹‰å®ç°æ˜¯ä¼šé“¾æ¥é”™è¯¯çš„ï¼Œæ‰€ä»¥éœ€è¦ inline ã€‚
å‚è€ƒä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">RationalNew</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">RationalNew</span><span class="p">(</span><span class="n">T</span> <span class="n">numerator</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">:</span><span class="n">numerator_</span><span class="p">(</span><span class="n">numerator</span><span class="p">),</span> <span class="n">denominator_</span><span class="p">(</span><span class="n">denominator</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">T</span> <span class="nf">numerator</span><span class="p">()</span><span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">numerator_</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">T</span> <span class="nf">denominator</span><span class="p">()</span><span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">denominator_</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">friend</span> <span class="k">const</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">*</span><span class="n">rhs</span><span class="p">.</span><span class="n">numerator</span><span class="p">(),</span><span class="n">lhs</span><span class="p">.</span><span class="n">denominator</span><span class="p">()</span><span class="o">*</span><span class="n">rhs</span><span class="p">.</span><span class="n">denominator</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">T</span> <span class="n">numerator_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">T</span> <span class="n">denominator_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆï¼Œå¯¹å¦‚ä¸‹çš„åº”ç”¨ä»£ç ï¼Œå°±ä½¿ç”¨è‡ªå¦‚äº†ï¼š</p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">RationalNew</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">oneHalf</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">RationalNew</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">oneHalf</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">RationalNew</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">res2</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">oneHalf</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>è‹¥inline-friendå‡½æ•°ä½“å¤ªå¤§ï¼Œå¯ä»¥æŠ½ç¦»å‡ºç±»å¤–è¾…åŠ©å‡½æ•°ä¾›inlineè°ƒç”¨</strong>
ä¸Šè¿°çš„ operator* å‡½æ•°ä½“åªæœ‰ä¸€è¡Œï¼Œå®ç°ç®€å•ï¼Œä½†å¦‚æœå®ç°è¿‡ç¨‹å¤æ‚ä»£ç é‡å¤§ï¼Œè€ƒè™‘ inline å¸¦æ¥çš„å†²å‡»ä»¥åŠä»£ç å¯è¯»æ€§ï¼Œå¯ä»¥æŠ½å–ä¸ªå‡½æ•°å‡ºæ¥ä¾› inline-friend è°ƒç”¨ã€‚</p>
<p>ä¿®æ”¹æ–¹å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">RationalNew</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="c1">//  å…¶ä»–éƒ¨åˆ†ç•¥ã€‚æ³¨æ„ operator* å‡½æ•°ä½“å®ç°ï¼Œæ”¹ä¸ºè°ƒç”¨doMultiply
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">friend</span> <span class="k">const</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">doMultiply</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">rhs</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ç±»å¤–å‡½æ•°  doMultiply
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">doMultiply</span><span class="p">(</span><span class="k">const</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">RationalNew</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">*</span><span class="n">rhs</span><span class="p">.</span><span class="n">numerator</span><span class="p">(),</span> <span class="n">lhs</span><span class="p">.</span><span class="n">denominator</span><span class="p">()</span><span class="o">*</span><span class="n">rhs</span><span class="p">.</span><span class="n">denominator</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="r47-è¯·ä½¿ç”¨traits-classesè¡¨ç°ç±»å‹ä¿¡æ¯">R47 è¯·ä½¿ç”¨traits classesè¡¨ç°ç±»å‹ä¿¡æ¯</h3>
<p>C++ ä¸­é€šå¸¸æŠŠ Traits ç§°ä¸º<strong>ç±»å‹èƒå–</strong>æŠ€æœ¯ï¼Œå³ï¼šåœ¨ template ç¼–ç¨‹ä¸­ï¼Œè·å–æ¨¡æ¿å‚æ•°çš„ç±»å‹ä¿¡æ¯ï¼Œå¹¶åœ¨ç¼–è¯‘é˜¶æ®µé’ˆå¯¹ä¸åŒçš„ç±»å‹å“åº”ä¸åŒçš„å¤„ç†ã€‚åŒæ—¶ï¼Œè¿™ä¸ªæŠ€æœ¯è¦æ±‚å¯¹C++<strong>å†…ç½®ç±»å‹built-in</strong> å’Œ <strong>ç”¨æˆ·è‡ªå®šä¹‰user-defined</strong> ç±»å‹çš„è¡¨ç°å¿…é¡»ä¸€æ ·å¥½ã€‚</p>
<p>æœ¬èŠ‚è®¨è®ºæ­¤è®®é¢˜ï¼Œå¹¶ä¸”ä»¥ä¸€ä¸ª C++ æ ‡å‡†çš„æ¨¡æ¿å‡½æ•°ä½œä¸ºåˆ‡å…¥å£è¿›è¡Œè®¨è®º(std::advanceï¼Œä½œç”¨æ˜¯å…¼å®¹ä¸åŒç±»å‹è¿­ä»£å™¨ï¼Œç”¨äºåç»­å–ç”¨æŒ‡å®šåç§»é‡çš„å…ƒç´  )ã€‚</p>
<p>ä¸‹æ–¹ â€œBy the wayâ€ ç¯èŠ‚ç®€å•å±•ç¤ºäº† std::advance æ ‡å‡†C++çš„å£°æ˜å¼å’ŒåŸºæœ¬ç”¨æ³•ï¼š ğŸ‘‡ï¼ˆå•å‡»å±•å¼€ï¼‰</p>
<p><div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>std::advance éœ€è¦çš„å¤´æ–‡ä»¶åŒ…å«ä¸º <code>#include&lt;iterator&gt;</code> ï¼Œå†çœ‹ä¸‹å®ƒçš„å‡½æ•°åŸå‹å£°æ˜ï¼š</p>
<div class="highlight" id="id-35"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">InputIt</span><span class="p">,</span> <span class="k">class</span> <span class="nc">Distance</span> <span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">advance</span><span class="p">(</span> <span class="n">InputIt</span><span class="o">&amp;</span> <span class="n">it</span><span class="p">,</span> <span class="n">Distance</span> <span class="n">n</span> <span class="p">);</span>       <span class="c1">// C++17 ä¹‹å‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">InputIt</span><span class="p">,</span> <span class="k">class</span> <span class="nc">Distance</span> <span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">constexpr</span> <span class="kt">void</span> <span class="n">advance</span><span class="p">(</span> <span class="n">InputIt</span><span class="o">&amp;</span> <span class="n">it</span><span class="p">,</span> <span class="n">Distance</span> <span class="n">n</span> <span class="p">);</span> <span class="c1">// è‡ªC++17 å¼€å§‹
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å†çœ‹ä¸‹ç¤ºä¾‹åº”ç”¨ä»£ç ï¼š</p>
<div class="highlight" id="id-36"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">nums</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="n">vIter</span> <span class="o">=</span> <span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">advance</span><span class="p">(</span><span class="n">vIter</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;after advance  3 offset: *vIter = &#34;</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">vIter</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">deque</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">fNums</span><span class="p">{</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="n">dIter</span> <span class="o">=</span> <span class="n">fNums</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">advance</span><span class="p">(</span><span class="n">dIter</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;after advance -2 offset: *dIter = &#34;</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">dIter</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="n">chList</span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="n">cIter</span> <span class="o">=</span> <span class="n">chList</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">advance</span><span class="p">(</span><span class="n">cIter</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;after advance  2 offset: *cIter = &#34;</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="o">*</span><span class="n">cIter</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€ç»ˆè¾“å‡ºä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-37"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">after advance  <span class="m">3</span> offset: *vIter <span class="o">=</span> <span class="m">4</span>
</span></span><span class="line"><span class="cl">after advance -2 offset: *dIter <span class="o">=</span> 0.5
</span></span><span class="line"><span class="cl">after advance  <span class="m">2</span> offset: *cIter <span class="o">=</span> <span class="m">30</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>
èƒŒæ™¯çŸ¥è¯† ğŸ‘‰ STL è¿­ä»£å™¨æŒ‰ç…§åŠŸèƒ½åˆ†ä¸º 5 ç±»ï¼Œå¦‚ä¸‹æ–¹è¡¨æ ¼æ‰€è¿°ï¼š</p>
<table>
<thead>
<tr>
<th>æè¿°</th>
<th>ç‰¹ç‚¹</th>
<th>åº”ç”¨</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>input è¿­ä»£å™¨</td>
<td>åªå‘å‰ç§»åŠ¨ï¼Œä¸€æ¬¡ä¸€æ­¥ï¼Œåªè¯»</td>
<td>istream_iterators</td>
<td></td>
</tr>
<tr>
<td>outputè¿­ä»£å™¨</td>
<td>åªå‘å‰ç§»åŠ¨ï¼Œä¸€æ¬¡ä¸€æ­¥ï¼Œåªå†™</td>
<td>ostream_iterators</td>
<td></td>
</tr>
<tr>
<td>forwardè¿­ä»£å™¨</td>
<td>åªå‘å‰ç§»åŠ¨ï¼Œä¸€æ¬¡ä¸€æ­¥ï¼Œå¯è¯»å†™</td>
<td>single-list iterator</td>
<td></td>
</tr>
<tr>
<td>Bidirectionalè¿­ä»£å™¨</td>
<td>åŒå‘ç§»åŠ¨ï¼Œä¸€æ¬¡ä¸€æ­¥ï¼Œå¯è¯»å†™</td>
<td>set/multiset/map/multimap</td>
<td></td>
</tr>
<tr>
<td>random-accessè¿­ä»£å™¨</td>
<td>åŒå‘ç§»åŠ¨ï¼Œä¸€æ¬¡å¤šæ­¥ï¼Œå¯è¯»å†™</td>
<td>vetor/deque/string</td>
<td></td>
</tr>
</tbody>
</table>
<p><mark>å¦‚ä½•è®¾è®¡ä¸€ä¸ª trait_class å¹¶è¿ç”¨èµ·æ¥å‘¢ï¼Ÿ</mark></p>
<ul>
<li><strong>Step1ï¼š ç¡®è®¤è‹¥å¹²ä¸ªå¸Œæœ›è·å–çš„ç±»å‹ä¿¡æ¯</strong> (æœ¬ä¾‹åªæœ‰ä¸€ä¸ª iterator ç±»åˆ«ä¿¡æ¯)
é’ˆå¯¹5 ç§è¿­ä»£å™¨åˆ†ç±»ï¼ŒC++ æä¾›äº†ä¸“å±çš„ <strong>å·æ ‡ç»“æ„tag struct</strong> åŠ ä»¥åŒºåˆ†(å¯ä»¥ç†è§£ä¸ºç¼–è¯‘æœŸçš„æšä¸¾ä½œç”¨)ï¼Œç»§æ‰¿å…³ç³»å¦‚ä¸‹ï¼š
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">input_iterator_tag</span><span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">output_iterato_tag</span><span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">forward_iterator_tag</span><span class="o">:</span><span class="k">public</span> <span class="n">input_iterator_tag</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">bidirectional_iterator_tag</span><span class="o">:</span> <span class="k">public</span> <span class="n">forward_iterator_tag</span><span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">random_access_iterator_tag</span><span class="o">:</span> <span class="k">public</span> <span class="n">bidirectional_iterator_tag</span><span class="p">{};</span><span class="err">`</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li><strong>Step2ï¼šä¸ºè¯¥ä¿¡æ¯é€‰ä¸€ä¸ªåç§°</strong> (ä¾‹å¦‚ iterator_category)
é‚£ä¹ˆ vectorï¼Œsetä¹‹ç±»çš„<strong>ç›®æ ‡å®¹å™¨ç±»</strong>ï¼Œå¦‚ä½•ä¸ä¸Šè¿° iterator_tag <strong>è”ç³»èµ·æ¥</strong>å‘¢ï¼Œéœ€è¦ä¸€ä¸ªåç§°ä¼ é€’å‡ºå»ï¼š
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span> <span class="p">...</span> <span class="o">&gt;</span> <span class="c1">//çœç•¥template å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">vector</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">iterator</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">public</span><span class="o">:</span>   <span class="c1">// ps: C++11 ä¹‹åä½¿ç”¨çš„éƒ½æ˜¯ using å®šä¹‰å¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">typedef</span> <span class="n">random_access_iterator_tag</span> <span class="n">iterator_category</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li><strong>Step3ï¼šæä¾›ä¸€ä¸ª template ç±»å’Œä¸€ç»„ç‰¹åŒ–ç‰ˆæœ¬</strong>ï¼ˆç‰¹åŒ–ç‰ˆæœ¬æ”¯æŒæŸäº›ç‰¹æ®Šæƒ…å†µï¼‰
<code>Traits æŠ€æœ¯</code>é’ˆå¯¹äºè¿­ä»£å™¨çš„å…³é”®æ¨¡æ¿ç±» iterator_traits å®šä¹‰å¦‚ä¸‹ï¼š
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">IterT</span><span class="o">&gt;</span>  <span class="c1">//  æ³¨æ„ï¼šä½¿ç”¨çš„æ˜¯ struct
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">iterator_traits</span> <span class="p">{</span> <span class="c1">//è¿™é‡Œçš„ IterT å°±å¯ä»¥ä¼ å…¥vectorç­‰å®¹å™¨ç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">typedef</span> <span class="k">typename</span> <span class="n">IterT</span><span class="o">::</span><span class="n">iterator_category</span>  <span class="n">iterator_category</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>æ³¨æ„ï¼Œè¿™é‡Œçš„ IterT ç±»å‹ä¸èƒ½æ˜¯æŒ‡é’ˆç±»å‹ï¼Œå› ä¸º pointer ä¸èƒ½åç»­åµŒå¥—ã€‚é‚£ä¹ˆå°±éœ€è¦ä¸€ä¸ªç‰¹åŒ–ç‰ˆæœ¬äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">IterT</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">iterator_traits</span><span class="o">&lt;</span><span class="n">IterT</span><span class="o">*&gt;</span><span class="p">{</span> <span class="c1">// æŒ‡é’ˆç±»å‹å’Œ random è¿­ä»£å™¨ç±»ä¼¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">typedef</span> <span class="n">random_access_iterator_tag</span> <span class="n">iterator_category</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>è‡³æ­¤ï¼Œiterator_traits çš„åŸºæœ¬å®ç°å°±å®Œæˆäº†ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>iterator_traits&lt;IterT&gt;::iterator_category</code> å¯ä»¥åœ¨ç¼–è¯‘æœŸç¡®å®šï¼Œæ¥ä¸‹æ¥çœ‹çœ‹advance å‡½æ•°å¦‚ä½•ä½¿ç”¨å®ƒã€‚</p>
<p>ğŸ’— æ­£ç¡®åšæ³•ï¼šåˆ©ç”¨ <strong>å‡½æ•°é‡è½½overloading</strong> æŠ€æœ¯ï¼Œä½¿å¾— <strong>trait classes åœ¨ç¼–è¯‘æœŸå¯¹ç±»å‹æ‰§è¡Œ if â€¦ else æµ‹è¯•</strong>ã€‚</p>
<p>å›é¡¾æˆ‘ä»¬çš„ advance å‡½æ•°ï¼Œåªæœ‰è¿­ä»£å™¨ç±»å‹ IterT å’Œ åç§»é‡ DistT ã€‚å¯ä»¥é‡è½½å…¶å­å‡½æ•° doAdvance ï¼Œå®Œæˆç±»å‹èƒå–åçš„è‡ªé€‚åº”ï¼š</p>
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">IterT</span><span class="p">,</span> <span class="k">typename</span> <span class="n">DistT</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">doAdvance</span><span class="p">(</span><span class="n">IterT</span><span class="o">&amp;</span> <span class="n">iter</span><span class="p">,</span> <span class="n">DistT</span> <span class="n">d</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">random_access_iterator_tag</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">iter</span> <span class="o">+=</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">IterT</span><span class="p">,</span> <span class="k">typename</span> <span class="n">DistT</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">doAdvance</span><span class="p">(</span><span class="n">IterT</span><span class="o">&amp;</span> <span class="n">iter</span><span class="p">,</span> <span class="n">DistT</span> <span class="n">d</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">bidirectional_iterator_tag</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">while</span> <span class="p">(</span><span class="n">d</span><span class="o">--</span><span class="p">)</span> <span class="o">++</span><span class="n">iter</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">{</span> <span class="k">while</span> <span class="p">(</span><span class="n">d</span><span class="o">++</span><span class="p">)</span> <span class="o">--</span><span class="n">iter</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">IterT</span><span class="p">,</span> <span class="k">typename</span> <span class="n">DistT</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">doAdvance</span><span class="p">(</span><span class="n">IterT</span><span class="o">&amp;</span> <span class="n">iter</span><span class="p">,</span> <span class="n">DistT</span> <span class="n">d</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">input_iterator_tag</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">throw</span> <span class="n">std</span><span class="o">::</span><span class="n">out_of_range</span><span class="p">(</span><span class="s">&#34;Negative distance&#34;</span><span class="p">);}</span><span class="c1">//ps: msvcä¸­çš„C++å®ç°æ˜¯é‡‡ç”¨ç¼–è¯‘æœŸé—´çš„assetåˆ¤å®š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="n">d</span><span class="o">--</span><span class="p">)</span> <span class="o">++</span><span class="n">iter</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è‡ªç„¶åœ°ï¼Œadvance å‡½æ•°çš„å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">IterT</span><span class="p">,</span> <span class="k">typename</span> <span class="n">DistT</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span>  <span class="n">advance</span><span class="p">(</span><span class="n">IterT</span><span class="o">&amp;</span> <span class="n">iter</span><span class="p">,</span> <span class="n">DistT</span> <span class="n">d</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">doAdvance</span><span class="p">(</span><span class="n">iter</span><span class="p">,</span><span class="n">d</span><span class="p">,</span> <span class="cm">/*ä¸è®º category çš„tagç±»å‹æ˜¯ä»€ä¹ˆï¼Œé‡è½½èƒ½æ‰¾åˆ°åŒ¹é…å‡½æ•°ã€‚å³ç¼–è¯‘æœŸçš„ if...else æµ‹è¯•*/</span>
</span></span><span class="line"><span class="cl">              <span class="k">typename</span> <span class="n">std</span><span class="o">::</span><span class="n">iterator_traits</span><span class="o">&lt;</span><span class="n">IterT</span><span class="o">&gt;::</span><span class="n">iterator_category</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è‡³æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„ (ä»¥ iterator_traits ä¸ºä¾‹)Traits æŠ€æœ¯å®ç°ä¸è¿ç”¨çš„è¿‡ç¨‹å°±å®Œæˆäº†ã€‚</p>
<div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><ul>
<li>
<p>å…³äº iterator_traits ï¼Œä¸æ­¢æœ‰ iterator_categoryï¼Œè¿˜æœ‰ difference_type, value_type, pointer, reference ç­‰4ä¸ªæˆå‘˜ï¼Œ<a href="https://zh.cppreference.com/w/cpp/iterator/iterator_traits"target="_blank" rel="external nofollow noopener noreferrer">è¯¦ç»†å¯å‚è€ƒ cppå‚è€ƒæ‰‹å†Œï¼šiterator_traits<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> ã€‚</p>
</li>
<li>
<p>C++ æ ‡å‡†åº“ä¸­ç±»ä¼¼ iterator_traits åº”ç”¨äº† Traits æŠ€æœ¯çš„æ¨¡æ¿æœ‰åå‡ ä¸ªã€‚</p>
<p>ä¸¾ä¾‹å¸¸ç”¨çš„æ•°å€¼ç±»å‹èƒå– <code>numeric_limits</code> ï¼Œéœ€è¦æ³¨æ„2ä¸ªç»†èŠ‚ï¼š</p>
<ol>
<li>å¤´æ–‡ä»¶æ˜¯ #include<limits>;</li>
<li>æˆå‘˜å‡½æ•° lowest/min/max æŒ‰ç…§é¡ºåºï¼Œåˆ†åˆ«ä»£è¡¨ç»™å®šç±»å‹çš„ æœ€ä½æœ‰é™å€¼ã€æœ€å°éè´Ÿå€¼ã€æœ€å¤§æœ‰é™å€¼ã€‚å°¤å…¶æ˜¯ float/doubleï¼Œå–æœ€å°å€¼æ˜¯ lowest() ï¼Œä¸æ˜¯ min().</li>
</ol>
</li>
</ul>
</div>
    </div>
  </div>
<h3 id="r48-è®¤è¯†templateæ¨¡æ¿å…ƒç¼–ç¨‹">R48 è®¤è¯†Templateæ¨¡æ¿å…ƒç¼–ç¨‹</h3>
<p><strong>TMPï¼Œæ¨¡æ¿å…ƒç¼–ç¨‹template metaprogramming</strong> ï¼Œæ˜¯ç¼–å†™ template-based C++ ç¨‹åºå¹¶æ‰§è¡Œäºç¼–è¯‘æœŸçš„è¿‡ç¨‹ã€‚TMP è¿‡ç¨‹ç»“æŸåï¼Œè‹¥å¹² C++ æºç ä¼šè¢« templates å…·ç°åŒ–å‡ºæ¥ï¼Œä¾¿ä¼šä¸€å¦‚å¾€å¸¸åœ°è¢«ç¼–è¯‘ã€‚</p>
<p>TMP æœ‰ 2 ä¸ªå¼ºå¤§çš„ä½œç”¨ï¼š</p>
<ol>
<li>å¯ä»¥å®Œæˆé TMP çš„å¸¸è§„ç¼–ç¨‹åšä¸åˆ°çš„äº‹æƒ…
æ¯”å¦‚ä»£ç ç”Ÿæˆï¼Œç±»å‹é€‚é…ç­‰ã€‚</li>
<li>å¯ä»¥å°†æŸäº›å·¥ä½œä»è¿è¡ŒæœŸè½¬ç§»åˆ°ç¼–è¯‘æœŸ
å¯ä»¥å°†è¿è¡ŒæœŸçš„é”™è¯¯æå‰æš´éœ²åœ¨ç¼–è¯‘æœŸï¼Œå¯ä»¥è·å¾—æ›´å°çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ›´å¿«åœ°è¿è¡Œï¼Œæ›´å°‘åœ°å†…å­˜éœ€æ±‚ï¼Œç¼ºç‚¹æ˜¯æ˜æ˜¾å¢åŠ ç¼–è¯‘æ—¶é—´ã€‚</li>
</ol>
<p>TMP å·²è¢«è¯æ˜æ˜¯ä¸ªâ€œ<strong>å›¾çµå®Œå¤‡</strong>â€çš„æœºå™¨ï¼Œæ„æ€æ˜¯å®ƒå¼ºå¤§åˆ°å¯ä»¥è®¡ç®—ä»»ä½•äº‹ç‰©ã€‚ä½¿ç”¨ TMP å¯ä»¥å£°æ˜å˜é‡ã€æ‰§è¡Œå¾ªç¯ã€ç¼–å†™åŠè°ƒç”¨å‡½æ•°â€¦ç­‰ç­‰ã€‚</p>
<p>æ¯”è¾ƒç‰¹åˆ«çš„æ˜¯ï¼ŒTMP å®ç°ä¸Šè¿°å„ç±»åŠŸèƒ½çš„æ–¹å¼ä¸åŒäºå¸¸è§„ C++ ç¨‹åºã€‚æ¯”å¦‚ä¸Šä¸€èŠ‚ Rule47 ä¸­ä½¿ç”¨é‡è½½å®Œæˆäº†ç¼–è¯‘æœŸçš„ ifâ€¦else æ¡ä»¶åˆ†æ”¯ã€‚TMP å¾ªç¯åŠŸèƒ½ä¹Ÿé€šå¸¸ä¼šä½¿ç”¨ â€œ<strong>é€’å½’å…·ç°åŒ–</strong>â€ æ¥å®Œæˆçš„ã€‚</p>
<p>ä¸‹æ–¹ä»£ç ç¤ºèŒƒå¦‚ä½•ä½¿ç”¨ TMP çš„æ–¹å¼æ¥è®¡ç®—é˜¶ä¹˜ï¼š</p>
<div class="highlight" id="id-22"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="n">n</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Factorial</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>   <span class="c1">// é€’å½’çš„å½¢å¼ä½“ç°: f(n) = n * f(n -1)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">enum</span> <span class="p">{</span><span class="n">value</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span> <span class="n">Factorial</span><span class="o">&lt;</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Factorial</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>  <span class="c1">// æ¨¡æ¿å…¨ç‰¹åŒ–: å®é™…æ˜¯åˆå§‹åŒ– f(0) = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">enum</span> <span class="p">{</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆé˜¶ä¹˜è®¡ç®—åœ¨ç¼–è¯‘æœŸå°±å®Œæˆäº†ï¼Œè¿è¡Œæ—¶å°±æ˜¯ç›´æ¥å–ç”¨äº†ï¼š</p>
<div class="highlight" id="id-23"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Factorial(&#34;</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;) = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">Factorial</span><span class="o">&lt;</span><span class="mi">5</span><span class="o">&gt;::</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Factorial(&#34;</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;) = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">Factorial</span><span class="o">&lt;</span><span class="mi">7</span><span class="o">&gt;::</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ch8-å®šåˆ¶newå’Œdelete">CH8 å®šåˆ¶newå’Œdelete</h2>
<h3 id="r49-äº†è§£new-handlerçš„è¡Œä¸º">R49 äº†è§£new-handlerçš„è¡Œä¸º</h3>
<p>å½“ <code>operator new</code> æ— æ³•æ»¡è¶³æŸä¸ªå†…å­˜åˆ†é…éœ€æ±‚æ—¶ï¼Œä¸€èˆ¬ä¼šæŠ›å‡º <code>std::bad_alloc</code> å¼‚å¸¸ã€‚</p>
<blockquote>
<p>å¦‚æœç”¨ std::nothrow ä¿®é¥° new æ“ä½œç¬¦ï¼Œä½¿å¾—å†…å­˜åˆ†é…é˜¶æ®µä¸ä¼šæŠ›å¼‚å¸¸ï¼Œå¤±è´¥äº†å°±è¿”å› null æŒ‡é’ˆã€‚ä¸¾ä¾‹ :</p>
<div class="highlight" id="id-24"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">pArr</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">nothrow</span><span class="p">)</span> <span class="kt">int</span><span class="p">[</span><span class="mh">0x1fffffff</span><span class="p">];</span> <span class="c1">//å³ä½¿åˆ†é…å¤±è´¥ï¼Œä¹Ÿä¸æŠ›å¼‚å¸¸ï¼Œè€Œæ˜¯å¾—åˆ°nullæŒ‡é’ˆ.
</span></span></span><span class="line"><span class="cl"><span class="c1">//  nothroow-new ä¸èƒ½ä¿è¯ class åç»­çš„æ„é€ å‡½æ•°ä¸æŠ›å¼‚å¸¸
</span></span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<p>new-hanlder çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-25"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">OutOfMemTip</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;new memory fail,out of memory!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">abort</span><span class="p">();</span><span class="c1">//ç»ˆæ­¢ç¨‹åºï¼Œè‹¥è°ƒè¯•æ¨¡å¼ä¼šå¼¹çª—æç¤º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// æ•…æ„åˆ¶é€ newå¤±è´¥çš„æƒ…å½¢ï¼Œç¨‹åºä¼šè°ƒç”¨ OutOfMemTipï¼Œè§¦å‘std::abort()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">std</span><span class="o">::</span><span class="n">set_new_handler</span><span class="p">(</span><span class="n">OutOfMemTip</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">pArr</span> <span class="o">=</span>  <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="mh">0x1fffffff</span><span class="p">];</span><span class="c1">//çº¦2GB,å¦‚æœæ‰›çš„ä½ï¼Œè°ƒå¤§è¿™ä¸ªæ•°
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹å‡ºè¿™æ ·çš„å‡½æ•°æŒ‡é’ˆç»™äº†ä½¿ç”¨è€…éå¸¸å¤§çš„è®¾è®¡å¼¹æ€§ï¼Œå¯ä»¥åšåˆ°ä»¥ä¸‹äº‹æƒ…ï¼š</p>
<ul>
<li>æå‰ç”³è¯·å†…å­˜ï¼Œè®© new_handler è§¦å‘ä¸‹ä¸€æ¬¡åˆ†é…ä½¿ç”¨ï¼›</li>
<li>å®‰è£…å¦ä¸€ä¸ª new_handler ï¼Œæˆ–è®¸æ–°çš„ handler å¯ä»¥ç”³è¯·åˆ°å†…å­˜ï¼›</li>
<li>å¸è½½ new_handler ï¼Œåªè¦ä¼  null æŒ‡é’ˆå³å¯ï¼›</li>
<li>æ‰‹åŠ¨æŠ› std::bad_alloc çš„å¼‚å¸¸ï¼›</li>
<li>ä¸è¿”å›ï¼Œé€šå¸¸è°ƒç”¨ std::abort() æˆ– std::exit() ;</li>
</ul>
<p>ğŸ¤” æˆ‘ä»¬æ€è€ƒå¦å¤–ä¸€ä¸ªé—®é¢˜ï¼šæ˜¯å¦å¯ä»¥ è®©ä¸åŒçš„ <strong>C++ ç±»æ‹¥æœ‰è‡ªå·±çš„ new-handler</strong> å‘¢ï¼Ÿ C++ æ ‡å‡†æœºåˆ¶æ˜¯ä¸æ”¯æŒçš„ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°ã€‚æœ‰ä¸¤ä¸ªå®ç°é€”å¾„ï¼Œåˆ—ä¸¾å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>é’ˆå¯¹æŸä¸ªç‰¹å®šç±» ï¼Œç±»å†…é‡è½½ static ç±»å‹çš„ <code>operator new</code> ä»¥åŠ <code>set_new_handler</code>æ–¹æ³•</strong>
å…·ä½“å®ç°ç•¥ï¼Œåªæƒ³æŒ‡å‡ºè¿™æ ·åšæ³•æœ‰ä¸ªæ˜æ˜¾å¼Šç«¯ï¼Œå°±æ˜¯æ¯ä¸ªç±»éƒ½å¾—è¿™ä¹ˆåšï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œä¹Ÿå®¹æ˜“ä»£ç å†—ä½™ã€‚</li>
<li><strong>ä½¿ç”¨ CRTP æ–¹æ³•ï¼ˆå³ <code>æ€ªå¼‚çš„å¾ªç¯æ¨¡æ¿æ¨¡å¼curiously recurring template pattern</code> ï¼‰å°†ä¸Šè¿°æ–¹æ³• 1 å¡è¿› template ç±»</strong>
è¿™æ ·åšçš„å¥½å¤„æ˜¯ä½¿ç”¨æ¨¡æ¿ç±»èµ‹äºˆä¸Šè¿° operator new å’Œ set_new_hanler çš„æ“ä½œï¼Œä½¿ç”¨èµ·æ¥æ–¹ä¾¿ã€‚
CRTP æ–¹æ³•ä¸­çš„åŸºç±» NewHandlerSupport å®ç°å¦‚ä¸‹ ğŸ‘‡(ç‚¹å‡»æ‰“å¼€æŠ˜å ) ï¼š</li>
</ol>
<div class="highlight" id="id-26"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">NewHandlerSupport</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">new_handler</span> <span class="n">set_new_handler</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">new_handler</span> <span class="n">p</span><span class="p">)</span><span class="k">noexcept</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">new_handler</span> <span class="n">oldHandler</span> <span class="o">=</span> <span class="n">currentHandler_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">currentHandler_</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">oldHandler</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="kt">void</span><span class="o">*</span> <span class="k">operator</span> <span class="nf">new</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">)</span> <span class="k">throw</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">bad_alloc</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">new_handler</span> <span class="n">oldHandle</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">set_new_handler</span><span class="p">(</span><span class="n">currentHandler_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">void</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="o">::</span><span class="k">operator</span> <span class="k">new</span><span class="p">(</span><span class="n">size</span><span class="p">);</span> <span class="c1">//newå®Œåå¤åŸglobal-new-handler
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">std</span><span class="o">::</span><span class="n">set_new_handler</span><span class="p">(</span><span class="n">oldHandle</span><span class="p">);</span><span class="c1">//åŸä¹¦ä½¿ç”¨RAIIæ‰‹æ³•åœ¨è¿˜åŸè¿™ä¸ªhandlerï¼Œè¿™é‡Œä½œç”¨ç±»ä¼¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">new_handler</span> <span class="n">currentHandler_</span><span class="p">;</span><span class="c1">//åˆå§‹åŒ–åŠ¨ä½œæ”¾åˆ°ç±»å¤–cppæ–‡ä»¶é‡Œå»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆç›®æ ‡ç±» <code>TestNewHandler</code> åªè¦åŸºäº <code>CRTP</code> æ–¹æ³•ç»§æ‰¿äºåŸºç±»å°±å¯ä»¥äº†ï¼Œå®ç°å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-27"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestNewHandler</span> <span class="o">:</span> <span class="k">public</span> <span class="n">NewHandlerSupport</span><span class="o">&lt;</span><span class="n">TestNewHandler</span><span class="o">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//ä¸å¿…å£°æ˜ set_new_handler æˆ– operator new
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">//æœ€ç»ˆåº”ç”¨æ—¶ä¹Ÿéå¸¸ç®€å•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">TestNewHandler</span><span class="o">::</span><span class="n">set_new_handler</span><span class="p">(</span><span class="n">OutOfMemTip</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">TestNewHandler</span><span class="o">*</span> <span class="n">pTestHandle</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TestNewHandler</span><span class="p">();</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="r50-äº†è§£newå’Œdeleteçš„åˆç†æ›¿æ¢æ—¶æœº">R50 äº†è§£newå’Œdeleteçš„åˆç†æ›¿æ¢æ—¶æœº</h3>
<p>æ›¿æ¢ç¼–è¯‘å™¨æä¾›çš„ <code>operator new</code> å’Œ <code>operator delete</code> çš„ å¸¸è§ç†ç”± å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>æ£€æµ‹è¿ç”¨ä¸Šçš„é”™è¯¯</strong>
è‡ªå®šä¹‰çš„new/deleteå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ ¡éªŒå®é™…æ§åˆ¶çš„åŒºæ®µå†…å­˜ï¼Œæ¯”å¦‚å¯ä»¥åœ¨ç›®æ ‡åŒºå—å‰åé¢å¤–ç©ºé—´æ·»åŠ å†…å­˜ç­¾å(æ¯”å¦‚å†™å…¥ç‰¹å®š int å€¼)ï¼Œç›‘æµ‹è¶Šç•Œçš„é—®é¢˜ã€‚
è¶Šç•Œåˆ†2ç§ï¼šunderruns (åŒºå—å†…å­˜èµ·ç‚¹ä¹‹å‰) å’Œ overruns (åŒºå—å†…å­˜æœ«å°¾ä¹‹å)ã€‚</p>
</li>
<li>
<p><strong>æ—¶é—´æˆ–å†…å­˜ä½¿ç”¨çš„ä¼˜åŒ–</strong>
é€šç”¨çš„ new/delete éœ€è¦é€‚ç”¨å„ç§åˆ†é…å½¢æ€å’Œåœºæ™¯ï¼Œå¯¹äºå†…å­˜ç¢ç‰‡æˆ–æ—¶é—´æ€§èƒ½éƒ½æ˜¯ä¸­åº¸æ°´å¹³ã€‚
å¯¹ç‰¹å®šçš„éœ€æ±‚å’Œåœºæ™¯ï¼Œå®šåˆ¶åŒ–åœ°å†…å­˜ç®¡ç†ä¼šæœ‰å¾ˆå¥½çš„ä¼˜åŒ–æ•ˆæœã€‚</p>
</li>
<li>
<p><strong>æ”¶é›†å†…å­˜ä½¿ç”¨çš„ç»Ÿè®¡æ•°æ®</strong>
å¯¹å†…å­˜åˆ†é…ç»†èŠ‚çš„æŠŠæ§ï¼Œä¾‹å¦‚åˆ†é…åŒºå—çš„å¤§å°åˆ†å¸ƒã€å­˜ç»­å‘¨æœŸã€FIFO/LIFOæ¬¡åºåˆ†é…å›æ”¶ã€å†…å­˜å³°å€¼ç­‰æƒ…å†µã€‚</p>
</li>
<li>
<p><strong>å¼¥è¡¥é»˜è®¤å†…å­˜åˆ†é…å™¨çš„ éæœ€ä½³å¯¹é½ä½suboptimal alignment</strong>
ä¾‹å¦‚x86ä½“ç³»ç»“æ„CPUä¸Šè®¿é—®doubleéƒ½æ˜¯8byteså¯¹é½ï¼Œå¦‚æœèƒ½åœ¨å†…å­˜åˆ†é…æ—¶å°±åšå¥½å†…å­˜å¯¹é½ï¼Œå¯æå‡è®¿é—®æ•ˆç‡ã€‚</p>
</li>
<li>
<p><strong>å°†ç›¸å…³å¯¹è±¡æˆç°‡é›†ä¸­</strong>
æ¯”å¦‚å·²çŸ¥æŸä¸ªæ•°æ®ç»“æ„å¾€å¾€ä¸€èµ·ä½¿ç”¨ï¼Œé‚£ä¹ˆåˆ†é…çš„æ—¶å€™åº”è¯¥å°½é‡è®©æ‰€æœ‰æ•°æ®çš„å†…å­˜é›†ä¸­ä¸€äº›ï¼Œé¿å…é¢‘ç¹è§¦å‘ æ¢é¡µä¸­æ–­page faults ï¼Œæå‡è®¿é—®æ•ˆç‡ã€‚</p>
</li>
<li>
<p><strong>å…¶ä»–çš„éä¼ ç»Ÿè¡Œä¸º</strong>
æƒ³å®Œæˆä¸€äº›ç³»ç»Ÿç¼–è¯‘å™¨åŠä¸åˆ°çš„äº‹æƒ…ã€‚æ¯”å¦‚å¸Œæœ›åˆ†é…é‡Šæ”¾å…±äº«å†…å­˜çš„åŒºå—ï¼Œä½†æ˜¯åªæœ‰ C-API èƒ½åšåˆ°ï¼Œé‚£å°±éœ€è¦å®šåˆ¶ç‰ˆçš„ new/delete å»åŒ…è£¹å°è£…è¿™æ ·çš„APIã€‚</p>
</li>
</ol>
<h3 id="r51-ç¼–å†™newå’Œdeleteæ—¶éœ€å›ºå®ˆå¸¸è§„">R51 ç¼–å†™newå’Œdeleteæ—¶éœ€å›ºå®ˆå¸¸è§„</h3>
<p>ä¸Šä¸€ä¸ªæ¡æ¬¾è®²äº†é‡å†™ new/delete çš„åŸå› ï¼Œè¿™ä¸€èŠ‚å°†è®²è¿°å…·ä½“éœ€è¦éµå®ˆçš„å‡ ä¸ªè§„åˆ™ã€‚</p>
<ol>
<li>
<p><strong>æ­£ç¡®å¤„ç† new å¤±è´¥çš„æƒ…å†µ</strong>
å¦‚æœåˆ†é…æ­£å¸¸ï¼Œç›´æ¥è¿”å›åŒºå—å¯¹åº”çš„æŒ‡é’ˆå³å¯ã€‚å¯å¦‚æœå¤±è´¥ï¼Œå°±å¿…é¡»å¾—æ­£ç¡®è°ƒç”¨ new-handler å‡½æ•°ï¼Œå‚è€ƒ R49 äº†è§£new-handlerçš„è¡Œä¸ºã€‚</p>
</li>
<li>
<p><strong>å¦‚æœè¦æ±‚åˆ†é… 0 byte ç©ºé—´</strong>
C++è§„å®šï¼Œå¦‚æœå®¢æˆ·è¦æ±‚åˆ†é… 0 byte å†…å­˜ç”³è¯·ï¼Œå°±è¿”å› 1byte ç©ºé—´ç”³è¯·ï¼Œå¹¶è¿”å›è¯¥æœ‰æ•ˆåœ°å€ã€‚</p>
</li>
<li>
<p><strong>ç†è§£ operator new å†…éƒ¨çš„æ— ç©·å¾ªç¯</strong>
operator new æœ‰ä¸ª while(true) å¾ªç¯ï¼Œåˆ†é…æˆåŠŸå¯ä»¥returnï¼Œæˆ–ç”± new-handler ä¸º nullptr æ—¶æŠ›å‡º std::bad_alloc å¼‚å¸¸ã€‚ä¼ªä»£ç pseudocode å¦‚ä¸‹ï¼š</p>
</li>
</ol>
<div class="highlight" id="id-28"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span><span class="o">*</span> <span class="k">operator</span> <span class="nf">new</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">)</span> <span class="k">throw</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">bad_alloc</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">      <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="err">å°è¯•åˆ†é…</span> <span class="n">size</span> <span class="n">bytes</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="err">åˆ†é…æˆåŠŸ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>  <span class="n">target_pointer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">new_handler</span> <span class="n">globalHandler</span> <span class="o">=</span> <span class="n">set_new_handler</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">set_new_handler</span><span class="p">(</span><span class="n">globalHandler</span><span class="p">);</span><span class="c1">//åˆ†é…å¤±è´¥äº†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="n">globalHandler</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="n">globalHanler</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">throw</span> <span class="n">std</span><span class="o">::</span><span class="n">bad_alloc</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li><strong>å½“åŸºç±»çš„ operator new è¢«å­ç±»ç»§æ‰¿æ—¶</strong>
å½“åŸºç±»è¢«ç»§æ‰¿æ—¶ï¼Œæˆå‘˜ operator new ä¹Ÿä¸€èµ·è¢«ç»§æ‰¿äº†ï¼Œè¦æ³¨æ„çš„æ˜¯åŸºç±»å’Œå­ç±»çš„ size é€šå¸¸æ˜¯ä¸ä¸€æ ·çš„ã€‚æ¨èå®ç°å¦‚ä¸‹ï¼š</li>
</ol>
<div class="highlight" id="id-29"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">static</span> <span class="kt">void</span><span class="o">*</span> <span class="k">operator</span> <span class="k">new</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">)</span><span class="k">throw</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">bad_alloc</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">!=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">Base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="o">::</span><span class="k">operator</span> <span class="k">new</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="c1">//å­ç±»èµ°è¿™é‡Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<strong>operator new[] ä¸èƒ½è¿™æ ·åœ¨åŸºç±»ä¸­åŒºåˆ†</strong>ã€‚å› ä¸ºå³ä½¿åœ¨Baseç±»ï¼Œä¹Ÿæ— æ³•å‡å®šæ¯ä¸ªå…ƒç´ æ˜¯ sizeof(Base)ï¼Œé€šå¸¸è¿˜æœ‰é¢å¤–å†…å­˜ç©ºé—´æ¥ä¿å­˜å…ƒç´ ä¸ªæ•°ã€‚</p>
<ol start="5">
<li>operator delete çš„æ³¨æ„äº‹é¡¹
C++ éœ€è¦ä¿è¯ â€œ<code>åˆ é™¤NULLæŒ‡é’ˆæ°¸è¿œå®‰å…¨</code>â€ï¼Œæ‰€ä»¥å¿…é¡»å…‘ç°è¿™ä¸ªè§„åˆ™ã€‚é’ˆå¯¹nullæŒ‡é’ˆï¼Œå°±ä»€ä¹ˆä¹Ÿä¸åšï¼Œç›´æ¥returnã€‚</li>
</ol>
<h3 id="r52-å†™äº†placement-new-ä¹Ÿè¦å†™placement-delete">R52 å†™äº†placement-new ä¹Ÿè¦å†™placement-delete</h3>
<p>placement-newï¼Œæ˜¯æŒ‡â€œ<code>é™¤sizeå‚æ•°ä»¥å¤–ï¼Œæ¥å—ä¸€ä¸ªé¢å¤–å‚æ•°å‚ä¸æ„é€ </code>â€çš„ ç‰¹å®š operator-newã€‚</p>
<p>å…¶ä¸­ï¼Œâ€œ<code>æ¥å—ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å¯¹è±¡è¯¥è¢«æ„é€ ä¹‹å¤„</code>â€æ˜¯<strong>æœ€å¸¸ä½¿ç”¨</strong>çš„ placement-newï¼Œå³â€œ<code>ä¸€ä¸ªç‰¹å®šä½ç½®ä¸Šçš„new</code>â€ï¼Œå½¢å¼å¦‚ä¸‹ä¸ºï¼š</p>
<div class="highlight" id="id-30"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//è¿™ä¸ªç‰¹æ®Šçš„ä¹Ÿæ˜¯æœ€å¸¸æ¶‰åŠçš„ placement-new å·²è¢«çº³å…¥C++æ ‡å‡†ç¨‹åºåº“
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="o">*</span> <span class="k">operator</span> <span class="nf">new</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">,</span><span class="kt">void</span><span class="o">*</span> <span class="n">pMemory</span><span class="p">)</span> <span class="k">noexcept</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å…ˆæš‚æ—¶è€ƒè™‘ä¸€ä¸ªè°ƒç”¨äº†placement-newçš„æ­£å¸¸æ„é€ è¿‡ç¨‹ï¼š</p>
<div class="highlight" id="id-31"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// æœ‰è¿™æ ·ä¸€ä¸ªplacement-new,æ¥æ”¶ä¸€ä¸ªostreamæ¥logåˆ†é…æ—¶çš„ç›¸å…³ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span><span class="o">*</span> <span class="k">operator</span> <span class="nf">new</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">logStream</span><span class="p">)</span> <span class="k">throw</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">bad_alloc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">Widget</span><span class="o">*</span> <span class="n">pw</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="p">)</span> <span class="n">Widget</span><span class="p">;</span><span class="c1">//ä¼ å…¥ostream
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹äºä»»ä½•çš„newå¯¹è±¡æ„é€ è¿‡ç¨‹ï¼Œè‡³å°‘å¯åˆ†ä¸ºä¸‹è¿°2ä¸ªè¿‡ç¨‹ï¼š</p>
<ol>
<li>operator new åˆ†é…å¯¹è±¡éœ€è¦çš„å†…å­˜ç©ºé—´ï¼›</li>
<li>æ‰§è¡Œå¯¹åº”çš„æ„é€ å‡½æ•°
å¦‚æœä¸Šè¿°è¿‡ç¨‹ 1 æˆåŠŸäº†ï¼Œè¿‡ç¨‹ 2 æŠ›å¼‚å¸¸ï¼Œå·²ç»ç”³è¯·çš„å†…å­˜å°±éœ€è¦åŠæ—¶å›æ”¶é¿å…memory-leakï¼Œè¿è¡ŒæœŸç³»ç»Ÿå°±ä¼šå°è¯•å¯»æ‰¾å¹¶è°ƒç”¨â€œ<strong>é¢å¤–å‚æ•°ä¸ªæ•°å’Œç±»å‹éƒ½ä¸operator new ä¸€è‡´çš„operator delete</strong>â€ï¼Œå®Œæˆå†…å­˜å›æ”¶ã€‚</li>
</ol>
<p>é‚£ä¹ˆä¸Šè¿°äº‹å®ï¼Œå°±æ˜¯ placement-new å’Œ placement-delete éœ€è¦<strong>æˆå¯¹å®ç°çš„ç†ç”±</strong>ã€‚</p>
<p>é’ˆå¯¹ä¸Šä¾‹é¢å¤–å‚æ•°æ˜¯ std::ostream çš„operator newï¼Œoperator deleteï¼Œç±»å£°æ˜å½¢å¼å¦‚ä¸‹:</p>
<div class="highlight" id="id-32"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Widget</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="kt">void</span><span class="o">*</span> <span class="k">operator</span> <span class="k">new</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">logStream</span><span class="p">)</span> <span class="k">throw</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">bad_alloc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//ä¸æŠ›å¼‚å¸¸æ—¶ï¼Œæœ€åå¯¹è±¡ææ„æ—¶æ­£å¸¸è°ƒç”¨è¿™ä¸ª
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">static</span> <span class="kt">void</span> <span class="k">operator</span> <span class="nf">delete</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">pMemory</span><span class="p">)</span> <span class="k">noexcept</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//newæŠ›å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨è¿™ä¸ª é¢å¤–å‚æ•°ä¸ªæ•°å’Œç±»å‹éƒ½ä¸€è‡´çš„ placement-delete
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">static</span> <span class="kt">void</span> <span class="k">operator</span> <span class="nf">delete</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">pMemory</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">logStream</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>âš ï¸ <strong>One More Thing</strong> : C++ åœ¨global ä½œç”¨åŸŸæä¾›ä»¥ä¸‹å½¢å¼çš„ operator new:</p>
<div class="highlight" id="id-33"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="o">*</span> <span class="k">operator</span> <span class="nf">new</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">)</span> <span class="k">throw</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">bad_alloc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="o">*</span> <span class="k">operator</span> <span class="nf">new</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">,</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span> <span class="k">noexcept</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="o">*</span> <span class="k">operator</span> <span class="nf">new</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">,</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">nothrow_t</span> <span class="o">&amp;</span><span class="p">)</span> <span class="k">noexcept</span><span class="p">;</span><span class="c1">//è§æ¡æ¬¾49 new-Handlerçš„è¡Œä¸º
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ğŸ˜ æ‰€ä»¥ï¼Œå¦‚æœåœ¨class å†…å£°æ˜äº†ä¸Šè¿° operator newï¼Œ åˆ™globalä½œç”¨åŸŸçš„ operator new ä¼šè¢«<code>åç§°é®æ©</code>ã€‚</p>
<p>ğŸ¤” <code>è§£å†³åŠæ³•</code>ï¼šåœ¨åŸºç±»å¯¹globalä½œç”¨åŸŸçš„ ::operator new è¿›è¡Œå°è£…è°ƒç”¨ï¼Œç„¶ååœ¨å­ç±»ä¸­ä½¿ç”¨using å£°æ˜å¼ç ´é™¤åç§°é®æ©ã€‚</p>
<h2 id="ch9-æ‚é¡¹è®¨è®º">CH9 æ‚é¡¹è®¨è®º</h2>
<h3 id="r53-ä¸è¦è½»æ˜“å¿½ç•¥ç¼–è¯‘å™¨çš„è­¦å‘Š">R53 ä¸è¦è½»æ˜“å¿½ç•¥ç¼–è¯‘å™¨çš„è­¦å‘Š</h3>
<ul>
<li>
<p><strong>ä¸¥è‚ƒå¯¹å¾…ç¼–è¯‘å™¨å‘å‡ºçš„è­¦å‘Šä¿¡æ¯</strong>
ç¼–è¯‘å™¨å‘å‡ºçš„è­¦å‘Šä¿¡æ¯ï¼Œç»å¸¸ä¼šè¢«å¿½ç•¥ã€‚No-Warningæ˜¯å€¼å¾—è¿½å´‡çš„ï¼Œé™¤éä½ å¯¹ç¼–è¯‘ warning ä¿¡æ¯æ˜¯å……åˆ†äº†è§£å¹¶ç¡®ä¿¡æ˜¯æ— å…³ç´§è¦çš„ã€‚</p>
<p>ä¸‹é¢ä¸¾ä¸€ä¸ªè¾ƒä¸ºå¸¸è§çš„ä¾‹å­ï¼š</p>
<div class="highlight" id="id-34"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BaseWarn</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">GetWarnInfo</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="s">&#34;Base&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">DerivedWarn</span> <span class="o">:</span><span class="k">public</span> <span class="n">BaseWarn</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">GetWarnInfo</span><span class="p">()</span>  <span class="p">{</span><span class="c1">//ç¼ºäº†const
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">return</span> <span class="s">&#34;Derived&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œæ²¡æœ‰æˆåŠŸå®ç°è™šå‡½æ•°é‡å†™ï¼Œè€Œæ˜¯é€ æˆäº†â€œ<strong>åç§°é®æ©</strong>â€ã€‚
è¿™æ ·çš„é”™è¯¯è¾ƒä¸ºéšè”½ï¼Œæœ‰äº›ç¼–è¯‘å™¨ä¼šç»™å‡ºè­¦å‘Šä¿¡æ¯ï¼Œæœ‰äº›ç”šè‡³è¿è­¦å‘Šä¿¡æ¯éƒ½æ²¡æœ‰ï¼ˆPsï¼šæˆ‘è‡ªè¡Œæµ‹è¯•äº†VS2017ï¼Œæ²¡æœ‰warningä¿¡æ¯ï¼‰ã€‚
<code>å¦‚æœç¼–è¯‘å™¨ç»™å‡ºäº†è­¦å‘Šä¿¡æ¯ï¼Œè¯·è®¤çœŸå¯¹å¾…</code>ã€‚</p>
</li>
<li>
<p><strong>ä¸è¦è¿‡åº¦ä¾èµ–ç¼–è¯‘å™¨çš„æŠ¥è­¦èƒ½åŠ›</strong>
è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œä¸åŒç¼–è¯‘å™¨å¤„ç†æ€åº¦ä¸åŒï¼Œè­¦å‘Šä¿¡æ¯ç”šè‡³å¯èƒ½æ¢ä¸ªç¼–è¯‘å™¨å°±æ¶ˆå¤±äº†ã€‚</p>
</li>
</ul>
<h3 id="r54-ç†Ÿæ‚‰åŒ…æ‹¬tr1åœ¨å†…çš„æ ‡å‡†ç¨‹åºåº“">R54 ç†Ÿæ‚‰åŒ…æ‹¬TR1åœ¨å†…çš„æ ‡å‡†ç¨‹åºåº“</h3>
<p><strong>C++ Technical Report 1 (TR1)</strong> å¹¶éæ ‡å‡†ï¼Œè€Œæ˜¯ä¸€ä»½è‰ç¨¿æ–‡ä»¶ï¼Œå¯¹C++æ ‡å‡†åº“çš„ç¬¬ä¸€æ¬¡æ‰©å±•ï¼Œå®ƒæå‡ºäº†å¯¹C++æ ‡å‡†å‡½å¼åº“çš„è¿½åŠ é¡¹ç›®ã€‚</p>
<p>è¿™ä»½æ–‡ä»¶çš„ç›®æ ‡åœ¨äºã€Œä¸ºæ‰©å……çš„C++æ ‡å‡†å‡½å¼åº“å»ºç«‹æ›´ä¸ºå¹¿æ³›çš„ç°å®ä½œå“ã€ã€‚</p>
<blockquote>
<p><code>æˆ‘çš„ç†è§£</code>ï¼š200x å¹´å‘å¸ƒçš„ C++ ç§°ä¸º â€œC++0xâ€ï¼ŒæŒç»­ä¿®æ”¹ä¸­ï¼Œæ‰€æœ‰ä¿®æ”¹å°†åˆå¹¶äº TR1ï¼Œæœ€ç»ˆç»å¤§éƒ¨åˆ†éƒ½å®šç‰ˆã€æ”¶å½•å‘å¸ƒäº <strong>C++11</strong>ã€‚</p>
</blockquote>
<p>TR1è¯¦ç»†å™è¿°äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œéƒ½æ”¾åœ¨ <code>std::tr1</code> å‘½åç©ºé—´å†…ï¼ˆä»¥ä¸‹ç®€ç§° <code>tr1::</code> ï¼‰ï¼Œåˆ—ä¸¾å¦‚ä¸‹</p>
<ol>
<li><code>æ™ºèƒ½æŒ‡é’ˆ</code>ï¼štr1::shared_ptr å’Œ tr1::weak_ptr ï¼ŒRAII åŸºç¡€ï¼Œä¸èµ˜è¿°ï¼›</li>
<li><code>tr1::function</code>ï¼šè¡¨ç¤º å¯è°ƒç”¨ç‰©callable entityï¼Œå³ä»»ä½•å‡½æ•°æˆ–å‡½æ•°å¯¹è±¡ï¼Œåªè¦ç­¾åä¸€è‡´å³å¯ï¼›</li>
<li><code>tr1::bind</code>ï¼šå¯¹å‡½æ•°è°ƒç”¨çš„å°è£…ï¼Œå°†å‡½æ•°å’Œå…¶å‚æ•°ç»‘å®šä¸€èµ·ï¼›</li>
<li><code>Hash tables</code>ï¼šé‡‡å“ˆå¸Œè¡¨å½¢å¼å‚ä¸æ„æˆï¼Œåç§°ä»¥ unordered_ å¼€å¤´çš„ set/multiset/map/multimapï¼›</li>
<li><code>æ­£åˆ™è¡¨è¾¾å¼</code>ï¼šå¤´æ–‡ä»¶åœ¨ <regrex> ï¼›</li>
<li><code>Tuple å…ƒç»„(æˆ–å«å˜é‡ç»„)</code>ï¼šä¸å®šé•¿å˜é‡ç»„ï¼Œæ˜¯ std::pair çš„ä¸€ç§æ³›åŒ–ï¼›</li>
<li><code>tr1::array</code>: å’Œ C è¯­è¨€æ•°ç»„ä¸€æ ·ï¼Œæ˜¯ä¸ªå®šé•¿æ•°ç»„ï¼ŒåŒ…è£¹äº† STL ç”¨æ³•ï¼›</li>
<li><code>tr1::mem_fn</code>: ä¼ å…¥ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ˆæ”¯æŒå¯¹æˆå‘˜å‡½æ•°å–å€ï¼‰ä½œä¸ºå…¥å‚ï¼Œæ„é€ ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œè¿›è€Œè°ƒç”¨ï¼Œç±»ä¼¼åœ°è¿˜æœ‰ mem_fn_ref;</li>
<li><code>tr1::reference_wrapper</code>ï¼šâ€œå°è£…å¼•ç”¨ä¸ºä¸€ä¸ªå¯¹è±¡â€ï¼Œé€šå¸¸ç”¨äºå¯¹å¼•ç”¨è¿›è¡Œå°è£…ç„¶åè£…å…¥æ ‡å‡†å®¹å™¨(ç›´æ¥å¾€å®¹å™¨å¡å¼•ç”¨æ˜¯ä¸è¡Œçš„)ï¼›</li>
<li><code>éšæœºæ•°ç”Ÿæˆå·¥å…·</code>ï¼šrandom_deviceï¼Œå¯ä»¥ç›´æ¥ç”Ÿæˆæˆ–è€…ä½¿ç”¨ä¸åŒçš„ éšæœºæ•°å¼•æ“ å’Œ éšæœºåˆ†å¸ƒç®—æ³•è¿›è¡Œç”Ÿæˆï¼Œå¤´æ–‡ä»¶æ˜¯ <random>ï¼›</li>
<li><code>æ•°å­¦ç‰¹æ®Šå‡½æ•°</code>ï¼šåŒ…æ‹¬Laguerreå¤šé¡¹å¼ã€Bessel å‡½æ•°ã€å®Œå…¨æ¤­åœ†ç§¯åˆ†ç­‰ç‰¹æ®Šæ•°å­¦å‡½æ•°ï¼Œæ³¨æ„ï¼Œè¿™äº› åœ¨ C++17 æ‰å¼•å…¥C++æ ‡å‡†ï¼Œå¯å‚è€ƒcppreference: special math ï¼Œå¤´æ–‡ä»¶åœ¨ <cmath>ï¼›</li>
<li><code>C99å…¼å®¹æ‰©å……</code> ï¼šC99æ ‡å‡†æ˜¯Cè¯­è¨€çš„å®˜æ–¹æ ‡å‡†ç¬¬äºŒç‰ˆï¼Œ1999å¹´å‘å¸ƒï¼ŒTR1å¯¹å…¶è¿›è¡Œäº†å…¼å®¹ï¼›</li>
<li><code>Type traits ç±»å‹èƒå–</code>ï¼štemplateç¼–ç¨‹çš„ç²¾åä¹‹ä¸€ï¼Œå‚è€ƒ Rule47:ä½¿ç”¨traitè¡¨ç°ç±»å‹ä¿¡æ¯ï¼Œå¤´æ–‡ä»¶ä¸º &lt;type_traits&gt;ï¼ŒåŠŸèƒ½ååˆ†ä¸°å¯Œï¼Œå¯å‚è€ƒcppreference: type_traitsï¼›</li>
<li><code>tr1::result_of</code> ï¼šå¯ä»¥å¯¹å‡½æ•°è¿”å›å€¼åšæ¨æ–­ï¼Œå¾—åˆ°è¿”å›å€¼ç±»å‹ï¼Œå¤´æ–‡ä»¶ä¸º &lt;type_traits&gt; ï¼Œç¤ºä¾‹ç”¨æ³•å¦‚ä¸‹ï¼š
<code>c++ // å‡è®¾æœ‰ä¸ªå‡½æ•° double calcDaySale(int); std::tr1::result_of&lt;calcDaySale(int)&gt;::type x = 3.14;//xå°±æ˜¯doubleç±»å‹. C++11ä¸­ç›´æ¥ std::result_of </code>
æ›´è¯¦ç»†çš„å®šç‰ˆTR1ä¿¡æ¯å¯ä»¥å‚è€ƒ<a href="https://aristeia.com/EC3E/TR1_info.html"target="_blank" rel="external nofollow noopener noreferrer">Effective-C++ï¼šTR1 information<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ã€‚</li>
</ol>
<h3 id="r55-è®©è‡ªå·±ç†Ÿæ‚‰boost">R55 è®©è‡ªå·±ç†Ÿæ‚‰Boost</h3>
<p>Boostæ˜¯ä¸€ä¸ªC++å¼€å‘è€…é›†ç»“çš„ç¤¾ç¾¤ï¼Œä¹Ÿæ˜¯ä¸ªå¯è‡ªç”±ä¸‹è½½çš„ç¨‹åºåº“é›†ï¼Œç½‘å€æ˜¯ <code>http://boost.org</code>ã€‚</p>
<p><strong>å…¶ç‰¹æ®Šæ€§</strong>ï¼šå’ŒC++æ ‡å‡†å§”å‘˜ä¼šæœ‰ç€ç‹¬ä¸€æ— äºŒçš„å¯†åˆ‡å…³ç³»ï¼Œä¸”å…·æœ‰å¾ˆæ·±å½±å“åŠ›ï¼›æ¥çº³ç¨‹åºåº“éå¸¸ä¸¥è°¨ï¼Œéœ€è¦ä¸€æ¬¡ä»¥ä¸Šçš„åŒè¡Œä¸“å®¶è¯„å®¡ã€‚</p>
<p>Boost ç¨‹åºåº“é›†å¯å¤„ç†çš„åœºæ™¯æœ‰è®¸å¤šï¼ˆä¸”<strong>å›Šæ‹¬äº†TR1</strong>çš„å®ç°ï¼‰ï¼Œå¯åŒºåˆ†å‡ºæ•°åä¸ªç±»åˆ«ï¼Œå¹¶ä¸”è¿˜åœ¨æŒç»­å¢åŠ ï¼Œ<strong>åˆ—ä¸¾ä¸€å°éƒ¨åˆ†</strong>å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>å­—ç¬¦ä¸²ä¸æ–‡æœ¬å¤„ç†</strong></li>
<li><strong>å®¹å™¨</strong></li>
<li><strong>å‡½æ•°å¯¹è±¡ä¸é«˜çº§ç¼–ç¨‹</strong></li>
<li><strong>æ³›å‹ç¼–ç¨‹</strong>ï¼šè¦†ç›–ä¸€å¤§ç»„ traits classes</li>
<li><strong>æ¨¡æ¿å…ƒç¼–ç¨‹</strong>ï¼šè¦†ç›–ä¸€ä¸ªé’ˆå¯¹ç¼–è¯‘å™¨ assertions è€Œå†™çš„ç¨‹åºåº“ï¼Œä»¥åŠ Boost MPLç¨‹åºåº“</li>
<li><strong>æ•°å­¦å’Œæ•°å€¼</strong>:åŒ…æ‹¬æœ‰ç†æ•°ã€å…«å…ƒæ•°ã€å››å…ƒæ•°ã€å…¬çº¦æ•°ã€å¤šé‡è¿ç®—ã€éšæœºæ•°ç­‰ç­‰</li>
<li><strong>æ­£ç¡®æ€§ä¸æµ‹è¯•æ€§</strong></li>
<li><strong>æ•°æ®ç»“æ„</strong></li>
<li><strong>è¯­è¨€é—´çš„æ”¯æŒ</strong>ï¼šå…è®¸ C++ å’Œ Python ä¹‹é—´çš„æ— ç¼äº’è”</li>
<li><strong>å†…å­˜</strong>ï¼šè¦†ç›–Poolç¨‹åºåº“å’Œæ™ºèƒ½æŒ‡é’ˆç­‰</li>
<li><strong>æ‚é¡¹</strong>ï¼šåŒ…æ‹¬ CRC æ ¡éªŒã€æ—¥æœŸå’Œæ—¶é—´çš„å¤„ç†ã€æ–‡ä»¶ç³»ç»Ÿç­‰å†…å®¹</li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼ŒBoost æ˜¯ä¸€ä¸ªç¤¾ç¾¤ï¼Œä¹Ÿæ˜¯ä¸ªç½‘ç«™ã€‚è‡´åŠ›äºå…è´¹ã€æºç å¼€æ”¾ã€åŒè¡Œå¤å®¡çš„ C++ ç¨‹åºåº“å¼€å‘ï¼Œéå¸¸å€¼å¾—ç»å¸¸è®¿é—®ä¸å­¦ä¹ ã€‚</p>
<p>ref:</br>
[1]. <a href="https://blog.csdn.net/cltcj/category_12098441.html"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/cltcj/category_12098441.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
[2]. <a href="https://kissingfire123.github.io/2022/05/17_effective-c-%e4%b9%8b%e9%98%85%e8%af%bb%e6%80%bb%e7%bb%93%e5%9b%9b/"target="_blank" rel="external nofollow noopener noreferrer">https://kissingfire123.github.io/2022/05/17_effective-c-%e4%b9%8b%e9%98%85%e8%af%bb%e6%80%bb%e7%bb%93%e5%9b%9b/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></p>]]></description></item><item><title>Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [3]</title><link>https://jianye0428.github.io/posts/partthree/</link><pubDate>Mon, 31 Jul 2023 07:26:00 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/partthree/</guid><description><![CDATA[<!-- <div class="details admonition quote">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>quote<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">note abstract info tip success question warning failure danger bug example quote</div>
    </div>
  </div> -->
<h1 id="å‰è¨€">å‰è¨€</h1>
<blockquote>
<p>Effective-C++æ€»ç»“ç³»åˆ—åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬äºŒéƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬3~4ç« ï¼Œå†…å®¹èŒƒå›´Rule13~25ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule13ç®€å†™ä¸ºR13ã€‚</p>
</blockquote>
<div class="details admonition Note">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>Effective-C++ç³»åˆ—List<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š</br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/partone/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/parttwo/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/partthree/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/partfour/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></div>
    </div>
  </div>
<p>ç”±äºåŸä¹¦åœ¨C++11ä¹‹å‰å†™æˆï¼Œæœ‰äº›ç°ä»£C++ç‰¹æ€§ä¸ä¼šæåŠï¼Œæ‰€ä»¥ä¼šæ ¹æ®æœ¬äºº<code>å¼€å‘ç»éªŒ</code>æ–°å¢ä¸€äº›ä¸ªäººæ„Ÿæ‚ŸğŸ‘‰<code>By the way</code>ç¯èŠ‚ã€‚</p>
<h2 id="ch5-å®ç°">CH5. å®ç°</h2>
<h3 id="r26-å°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´">R26 å°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´</h3>
<ul>
<li>å°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°ï¼Œå¯å¢åŠ ç¨‹åºæ¸…æ™°åº¦å’Œæ•ˆç‡
<ol>
<li>å®šä¹‰åï¼Œåœ¨ä½¿ç”¨å‰å°±é­é‡æŠ›å¼‚å¸¸
è¿™ç§æƒ…å†µï¼Œå¦‚æœæ˜¯å®šä¹‰äº†å¯¹è±¡<code>ObjectA a</code>ï¼Œä¾¿ç™½ç™½åœ°æµªè´¹äº†å¯¹è±¡açš„æ„é€ å’Œææ„æˆæœ¬ã€‚</li>
<li>ä¸åªæ˜¯å»¶åå˜é‡å®šä¹‰åˆ°ä½¿ç”¨æ—¶ï¼Œè€Œæ˜¯å°½é‡å»¶ååˆ°èƒ½ç»™å®ƒåˆå€¼æ—¶</li>
</ol>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">encryptPassword</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">password</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="n">length</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">throw</span> <span class="n">std</span><span class="o">::</span><span class="n">logic_error</span><span class="p">(</span><span class="s">&#34;Password is too short&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span><span class="c1">// è€ƒè™‘1ï¼šåœ¨å¼‚å¸¸ä¹‹åå®šä¹‰å˜é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">encrypted</span><span class="p">(</span><span class="n">password</span><span class="p">);</span><span class="c1">//è€ƒè™‘2ï¼šå®šä¹‰å»¶åè‡³å˜é‡èƒ½èµ‹åˆå€¼çš„æ—¶æœº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">encrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">encrypted</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>æ€è€ƒå˜é‡å®šä¹‰<strong>æ˜¯å¦</strong>è¯¥åœ¨å¾ªç¯å†…</li>
</ol>
<ul>
<li>æ–¹æ³•Aï¼šå®šä¹‰äºå¾ªç¯å¤–
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">Widget</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">â€ƒ â€ƒ <span class="n">w</span> <span class="o">=</span> <span class="n">foo</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">â€ƒ â€ƒ<span class="c1">// other...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>æ–¹æ³•Bï¼šå®šä¹‰äºå¾ªç¯å†…
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Widget</span> <span class="nf">w</span><span class="p">(</span><span class="n">foo</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// other...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<p><strong>ç©¶ç«Ÿæ˜¯Aè¿˜æ˜¯Bæ–¹æ³•å¥½</strong>ï¼Œå–å†³äº <code>ä¸€ä¸ªèµ‹å€¼æˆæœ¬</code>å’Œ<code>ä¸€ç»„æ„é€ +ææ„</code>æˆæœ¬ï¼Œè¿™2è€…ä¹‹é—´ï¼Œå¦‚æœæ˜¯èµ‹å€¼æˆæœ¬ä½ï¼Œé‚£ä¹ˆAæ›´å¥½ï¼Œå¦åˆ™Bæ›´å¥½ã€‚</p>
<h3 id="r27-å°½é‡å°‘åšè½¬å‹åŠ¨ä½œ">R27 å°½é‡å°‘åšè½¬å‹åŠ¨ä½œ</h3>
<p>é€šå¸¸çš„è½¬å‹æ˜¯å¯èƒ½ä¼šè¿™æ ·å†™ï¼šå‡½æ•°é£æ ¼çš„<code>int(expression)</code>æˆ–è€…Cé£æ ¼çš„(int)<code>expression</code>ï¼Œè¿™éƒ½è¢«æˆä¸ºâ€œæ—§å¼è½¬å‹â€ã€‚</p>
<ul>
<li>
<p>åœ¨C++ä¸­ï¼Œæœ‰4ç§æ–°å¼è½¬å‹æ“ä½œç¬¦ï¼š</p>
<ol>
<li><strong>const_cast (expression)</strong>
ä½œç”¨æ˜¯ç§»é™¤å˜é‡çš„å¸¸é‡æ€§(cast away the constness)ï¼Œæ˜¯å”¯ä¸€æœ‰æ­¤èƒ½åŠ›çš„æ“ä½œç¬¦ã€‚</li>
<li><strong>dynamic_cast(expression)</strong>
ä½œç”¨æ˜¯â€œå®‰å…¨å‘ä¸‹è½¬å‹â€(safe downcasting)ï¼Œå†³å®šæŸä¸ªå¯¹è±¡æ˜¯å¦å±äºæŸç»§æ‰¿ä½“ç³»ã€‚è€—è´¹é‡å¤§è¿è¡Œæˆæœ¬ï¼ˆåŸå› ï¼šéœ€è¦æŸ¥è¯¢RTTIä¿¡æ¯ï¼Œè€Œä¸”ä¸åŒç¼–è¯‘å™¨å®ç°çš„æ–¹æ³•å’Œæ•ˆç‡æœ‰æ‰€ä¸åŒï¼‰ã€‚</li>
<li><strong>reinterpret_cast(expression)</strong>
æ‰§è¡Œä½çº§è½¬å‹ï¼Œå®é™…ç»“æœå–å†³äºç¼–è¯‘å™¨ï¼Œç§»æ¤æ€§å·®ã€‚ï¼ˆæ¯”å¦‚int* è½¬ä¸ºintï¼‰è¦æ¸…æ¥šè‡ªå·±åœ¨åšä»€ä¹ˆï¼Œæ…ç”¨ã€‚</li>
<li><strong>static_cast(expression)</strong>
å¼ºè¿«éšå¼ç±»å‹è½¬æ¢ï¼Œä»£æ›¿Cé£æ ¼çš„&quot;æ—§å¼è½¬æ¢&quot;ã€‚ä¹Ÿå¯ä»¥ç»™å˜é‡åŠ ä¸Šconstç‰¹æ€§ã€‚</li>
</ol>
<p>æ–°å¼è½¬æ¢çš„å¥½å¤„ï¼šå¾ˆå®¹æ˜“åœ¨ä»£ç æ‰¾åˆ°â€œç±»å‹ç³»ç»Ÿåœ¨ä½•å¤„è½¬å˜æˆ–ç ´åâ€ï¼›å¯¹constç‰¹æ€§çš„ä¸¥æ§ï¼Œè®©ç±»å‹ç³»ç»Ÿæ›´å¥å£®ã€‚</p>
</li>
<li>
<p>æ´¾ç”Ÿç±»é‡Œç›´æ¥è°ƒç”¨åŸºç±»æˆå‘˜å‡½æ•°æ—¶ï¼Œä¸è¦ç”¨è½¬å‹</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SpecialWindow</span><span class="o">:</span><span class="k">public</span> <span class="n">Window</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">onResize</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">Window</span><span class="o">::</span><span class="n">onResize</span><span class="p">();</span><span class="c1">//ä¸è¦ä½¿ç”¨ static_cast&lt;Window&gt;(*this).onResize();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å…³äºdynamic_castéœ€è¦æ³¨æ„çš„</p>
<ol>
<li>å¦‚ä½•æ›¿ä»£å’Œé¿å…
ä¸€èˆ¬æ˜¯æŒæœ‰ä¸€ä¸ª<code>Base *pBase</code>ï¼Œä½†æ˜¯æŒ‡å‘çš„æ˜¯DerivedObjï¼Œäºæ˜¯è½¬å‹ä¸ºpDerived</li>
</ol>
<ul>
<li>å¯ä»¥è¿™æ ·ä¿®æ”¹ï¼š
ä¿®æ”¹è®¾è®¡ï¼Œçª„åŒ–ç±»å‹ï¼ŒæŒæœ‰ä¸€ä¸ªpDerivedå³å¯ï¼›æˆ–è€…å°†æƒ³åšçš„äº‹æ”¾åˆ°è™šå‡½æ•°ä¸­ï¼Œåˆ©ç”¨å¤šæ€å»å®Œæˆã€‚</li>
</ul>
<ol start="2">
<li>é¿å…ä¸²è”
é¿å…ä¸‹æ–¹è¿™æ ·çš„ä»£ç ï¼Œä¸€è¿ä¸²çš„dynamic_castï¼š</li>
</ol>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Window</span><span class="p">{</span> <span class="p">...</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">// å®šä¹‰å­ç±» SpecialWindow1,SpecalWindow2,SpecialWindow3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Window</span><span class="o">*</span> <span class="n">winPtr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// çœç•¥winPtrçš„å…¶ä»–æ“ä½œ ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="n">SpecialWindow1</span> <span class="o">*</span><span class="n">psw1</span> <span class="o">=</span> <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">SpecialWindow1</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">winPtr</span><span class="p">)){</span> <span class="p">...</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>  <span class="nf">if</span><span class="p">(</span><span class="n">SpecialWindow2</span> <span class="o">*</span><span class="n">psw2</span> <span class="o">=</span> <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">SpecialWindow2</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">winPtr</span><span class="p">)){</span> <span class="p">...</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>  <span class="nf">if</span><span class="p">(</span><span class="n">SpecialWindow3</span> <span class="o">*</span><span class="n">psw3</span> <span class="o">=</span> <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">SpecialWindow3</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">winPtr</span><span class="p">)){</span> <span class="p">...</span> <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·çš„ä»£ç åˆå¤§åˆæ…¢ï¼Œæ¯æ¬¡ç»§æ‰¿ä½“ç³»æœ‰æ‰€æ”¹å˜ï¼Œä»£ç å°±éœ€è¦é‡æ–°æ£€é˜…åˆ¤æ–­ã€‚è¿™æ ·çš„ä»£ç åº”è¯¥ç”¨â€œåŸºäºvirtualå‡½æ•°è°ƒç”¨â€å–ä»£å®ƒã€‚</p>
</li>
</ul>
<div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>è‡ª <strong>C++11</strong> èµ·ï¼Œé’ˆå¯¹æ™ºèƒ½æŒ‡é’ˆ shared_ptr çš„è½¬å‹ï¼Œæ¨å‡ºäº†å¦å¤– 4 ä¸ªæ¨¡ç‰ˆå‡½æ•°ï¼š</p>
<ul>
<li><code>std::static_pointer_cast</code>
å‡½æ•°çš„åŸå‹å£°æ˜ä¸ºï¼š
<div class="highlight" id="id-47"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="k">class</span> <span class="nc">U</span> <span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">static_pointer_cast</span><span class="p">(</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&amp;</span> <span class="n">r</span> <span class="p">)</span> <span class="k">noexcept</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div>å«ä¹‰ä»¥åŠåº”ç”¨åœºæ™¯ä¸ <code>static_cast</code> ç±»ä¼¼ï¼Œæ¯”å¦‚å­ç±»å‹æŒ‡é’ˆè½¬ä¸ºçˆ¶ç±»å‹ï¼š
<div class="highlight" id="id-48"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">auto</span> <span class="n">basePtr</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Base</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">auto</span> <span class="n">derivedPtr</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Derived</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">basePtr</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">static_pointer_cast</span><span class="o">&lt;</span><span class="n">Base</span><span class="o">&gt;</span><span class="p">(</span><span class="n">derivedPtr</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div>æˆ–è®¸æˆ‘ä»¬ä¼šæœ‰ç–‘é—®ï¼Œæ˜¯å¦æœ‰å¿…è¦ç”¨è¿™ä¸ªå‡½æ•°è¿›è¡Œè½¬å‹å‘¢ï¼Œå¦‚ä¸‹å®ç°ä¸æ˜¯ä¸€æ ·çš„å—?
<div class="highlight" id="id-49"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">basePtr</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Base</span><span class="o">&gt;</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Base</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">derivedPtr</span><span class="p">.</span><span class="n">get</span><span class="p">()));</span></span></span></code></pre></td></tr></table>
</div>
</div>ğŸ¤” å½“ç„¶ä¸ä¸€æ ·ï¼Œstatic_cast&lt;T*&gt;((U*)nullptr)æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œè€Œä¸”å°±è¯­æ³•æè¿°ä¸Šæ¥çœ‹ï¼Œå“ªä¸ªæ›´ç®€æ´ä¸è¨€è‡ªæ˜ã€‚
å¦å¤–ï¼Œè‡ª C++20 èµ·æ”¯æŒå³å€¼å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯å¦‚ä¸‹å½¢å¼ï¼š
<div class="highlight" id="id-50"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="k">class</span> <span class="nc">U</span> <span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">static_pointer_cast</span><span class="p">(</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&amp;&amp;</span> <span class="n">r</span> <span class="p">)</span> <span class="k">noexcept</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li><code>std::dynamic_pointer_cast</code>
å«ä¹‰ä»¥åŠåº”ç”¨åœºæ™¯ä¸ dynamic_cast ç±»ä¼¼ï¼Œç”¨æ³•ä¼ å‚ä¸ std::static_pointer_cast ç±»ä¼¼ï¼Œä¸”è‡ª C++20 èµ·æ”¯æŒå³å€¼å¼•ç”¨ï¼Œä¸èµ˜è¿°ã€‚</li>
<li><code>std::const_pointer_castï¼š</code>ä¸å‰ 2 è€…ç±»ä¼¼ï¼Œä¸èµ˜è¿°ã€‚</li>
<li><code>std::reinterpret_pointer_castï¼š</code>ä¸å‰ 3 è€…ç±»ä¼¼ï¼Œä¸èµ˜è¿°ã€‚</li>
</ul>
</div>
    </div>
  </div>
<h3 id="r28-é¿å…è¿”å›handlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ†">R28 é¿å…è¿”å›handlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ†</h3>
<p>è¿™é‡Œçš„<strong>handlesï¼ˆå·ç ç‰Œï¼‰åŒ…æ‹¬</strong>æŒ‡å‘å¯¹è±¡å†…éƒ¨çš„<strong>æŒ‡é’ˆ</strong>ã€<strong>è¿­ä»£å™¨</strong>ã€<strong>å¼•ç”¨</strong>ã€‚</p>
<p>ä»¥ä¸‹è®²è¿°å½“è¿”å›å¯¹è±¡å†…éƒ¨çš„handlesæ—¶ï¼Œå­˜åœ¨çš„2ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>å¯èƒ½ä¼šç ´åå°è£…æ€§
è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼špublicå‡½æ•°è¿”å›ä¸€ä¸ªprivateæˆå‘˜çš„éconstå¼•ç”¨ï¼Œå°±è®©å¤–ç•Œæœ‰äº†ä¿®æ”¹privateçš„æœºä¼šï¼Œç ´åäº†å°è£…æ€§ã€‚
æ­¤æ—¶ï¼Œéœ€è¦å°†éconstå¼•ç”¨æ”¹ä¸ºconstå¼•ç”¨ï¼Œåªè¯»å±æ€§ã€‚
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Pixel</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">float</span> <span class="n">r</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Image</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>  <span class="c1">//æ³¨æ„ï¼šåé¢è¿™conståªä¿è¯æˆå‘˜å˜é‡vPixPtrs_ä¸æ”¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Pixel</span><span class="o">&amp;</span> <span class="n">GetThePixel</span><span class="p">(</span><span class="kt">int</span> <span class="n">idx</span><span class="p">)</span> <span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>  <span class="n">vPixPtrs_</span><span class="p">[</span><span class="n">i</span><span class="p">];}</span><span class="c1">//éšæ‚£ï¼šå…¶å®å¤–éƒ¨è°ƒç”¨è€…ä»èƒ½ç›´æ¥ä¿®æ”¹Pixelçš„rgbå€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// ä¸Šä¸€å¥çš„è¿”å›å€¼åº”è¯¥æ”¹ä¸º &#34;const Pixel&amp;&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Pixel</span><span class="o">&gt;&gt;</span> <span class="n">vPixPtrs_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>å¯èƒ½ä¼šå¼•èµ·â€œç©ºæ‚¬handlesâ€
å³ä½¿ç”¨constè§£å†³äº†å°è£…æ€§çš„é—®é¢˜ï¼Œå› ä¸ºå¾ˆå®¹æ˜“å‡ºç°**â€œhandlesæ¯”å…¶æ‰€æŒ‡å¯¹è±¡æ›´é•¿å¯¿â€**ï¼Œå¯èƒ½å­˜åœ¨å¯¹è±¡å·²ææ„ï¼Œä½†handlesè¿˜ç•™å­˜çš„é—®é¢˜ã€‚å°¤å…¶æ˜¯ä¸´æ—¶å˜é‡çš„ææ„ï¼Œä¸å¤ªå®¹æ˜“å¯Ÿè§‰ã€‚
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SceneGraph</span><span class="p">{</span> <span class="p">...</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">Image</span> <span class="nf">CaptureImage</span><span class="p">(</span><span class="k">const</span> <span class="n">SceneGraph</span><span class="o">&amp;</span> <span class="n">graph</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//é‚£ä¹ˆè°ƒç”¨æ–¹å¯èƒ½ä¼šè¿™æ ·ä½¿ç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">SceneGraph</span> <span class="n">Grap</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ä¸‹é¢è¿™å¥ä¹‹åï¼ŒImageä¸´æ—¶å¯¹è±¡è¢«é”€æ¯ï¼ŒpPixæŒ‡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="n">Pixel</span> <span class="o">*</span><span class="n">pPix</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">CaptureImage</span><span class="p">(</span><span class="n">Grap</span><span class="p">).</span><span class="n">GetThePixel</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span></span></span></code></pre></td></tr></table>
</div>
</div>æ³¨æ„ï¼ŒCaptureImageçš„ç¡®èƒ½è¿”å›ä¸€ä¸ªä¸´æ—¶Imageå¯¹è±¡ï¼Œèƒ½æˆåŠŸè°ƒç”¨GetThePixelï¼Œä½†è¿™å¥ç»“æŸåï¼Œä¸´æ—¶å¯¹è±¡ç«‹é©¬ä¼šè¢«é”€æ¯ï¼Œé€ æˆç©ºæ‚¬ç°è±¡ï¼Œæˆ–å«è™šåŠ(dangling) ï¼</li>
</ul>
<h3 id="r29-ä¸ºå¼‚å¸¸å®‰å…¨è€ŒåŠªåŠ›æ˜¯å€¼å¾—çš„">R29 ä¸ºâ€œå¼‚å¸¸å®‰å…¨â€è€ŒåŠªåŠ›æ˜¯å€¼å¾—çš„</h3>
<p>â€œ<strong>å¼‚å¸¸å®‰å…¨</strong>â€æ˜¯æŒ‡ï¼Œå½“å¼‚å¸¸æŠ›å‡ºæ—¶ï¼Œä»£ç ä¾ç„¶èƒ½åšåˆ°å¦‚ä¸‹2ç‚¹ï¼š</p>
<ol>
<li>ä¸æ³„éœ²ä»»ä½•èµ„æº
åŒ…æ‹¬å†…å­˜èµ„æºï¼Œé”èµ„æºã€‚</li>
<li>ä¸å…è®¸æ•°æ®è´¥å
ä¸ä¼šå› ä¸ºå¼‚å¸¸è€Œå¯¼è‡´ç©ºæ‚¬æŒ‡é’ˆç­‰æœªå®šä¹‰è¡Œä¸ºã€‚</li>
</ol>
<p>è€ƒè™‘ä¸‹æ–¹çš„ç¤ºä¾‹ä»£ç ï¼Œï¼ˆå¦‚æœ<code>new Image</code>æŠ›<code>std::bad_alloc</code>å¼‚å¸¸ï¼‰åˆ™ä¼šåŒæ—¶è¿èƒŒäº†ä¸Šè¿°2æ¡ï¼š</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PrettyMenu</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Mutex</span> <span class="n">mutex_</span><span class="p">;</span> <span class="c1">//äº’æ–¥å™¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Image</span><span class="o">*</span> <span class="n">bgImage_</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">imageChangeCnt_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="n">PrettyMenu</span><span class="o">::</span><span class="n">changeBackground</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ifstream</span><span class="o">&amp;</span> <span class="n">imgSrc</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_</span><span class="p">);</span><span class="c1">// è¿™ä¸ªå¯ä»¥æ”¹ä¸ºRAIIçš„é”ï¼Œæ¥ä¿è¯å¼‚å¸¸å®‰å…¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">delete</span> <span class="n">bgImage_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">++</span><span class="n">imageChangeCnt_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//è¿™é‡Œnew ImageæŠ›å¼‚å¸¸ï¼Œå¯¼è‡´æ— æ³•è§£é”ï¼›ä¸”bgImage_æŒ‡å‘èµ„æºå·²ç»é‡Šæ”¾ï¼Œç©ºæ‚¬æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">bgImage_</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Image</span><span class="p">(</span><span class="n">imageSrc_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å¼‚å¸¸å®‰å…¨çš„3ä¸ªç­‰çº§">å¼‚å¸¸å®‰å…¨çš„3ä¸ªç­‰çº§</h4>
<p>å¼‚å¸¸å®‰å…¨çš„å‡½æ•°ï¼Œæœ‰<strong>3ä¸ªç­‰çº§</strong>çš„å¼‚å¸¸å®‰å…¨ä¿è¯ï¼Œä¼šæ»¡è¶³<strong>ä¸‰è€…ä¹‹ä¸€</strong>ï¼š</p>
<ul>
<li>
<p><strong>åŸºæœ¬æ‰¿è¯º</strong>
å¦‚æœå¼‚å¸¸è¢«æŠ›å‡ºï¼Œç¨‹åºå†…çš„ä»»ä½•äº‹åŠ¡ä»ç„¶ä¿æŒåœ¨æœ‰æ•ˆçŠ¶æ€ä¸‹ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ•°æ®è´¥åã€‚æ¯”å¦‚ä¸Šä¾‹ä¸­å¦‚æœæŠ›å¼‚å¸¸ï¼Œä¼šå¦å¤–æ·»åŠ å®ç°ï¼Œä½¿bgImage_æŒæœ‰æŸä¸ªé»˜è®¤å›¾åƒï¼Œæˆ–ä¿æŒåŸå€¼ï¼Œè®©ç¨‹åºç»§ç»­æœ‰æ•ˆè¿è¡Œã€‚</p>
</li>
<li>
<p><strong>å¼ºçƒˆä¿è¯</strong>
å¦‚æœå¼‚å¸¸è¢«æŠ›å‡ºï¼Œç¨‹åºçŠ¶æ€ä¸æ”¹å˜ã€‚è¿™æ ·çš„å‡½æ•°è¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆé€€å›åˆ°æ‰§è¡Œå‰çš„çŠ¶æ€ã€‚</p>
<p>ä¸Šè¿°æ¡ˆä¾‹åˆ™åº”è¯¥ä¼šè¢«ä¿®æ”¹æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PrettyMenu</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Image</span><span class="o">&gt;</span> <span class="n">bgImage_</span><span class="p">;</span> <span class="c1">//RAIIé¿å…äº†å¼‚å¸¸å‘ç”Ÿæ—¶çš„èµ„æºæ³„æ¼å’Œæ•°æ®è´¥å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//... çœç•¥å…¶ä»–æˆå‘˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="n">PrettyMenu</span><span class="o">::</span><span class="n">changeBackground</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ifstream</span><span class="o">&amp;</span> <span class="n">imgSrc</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">CLock</span> <span class="nf">ml</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_</span><span class="p">);</span><span class="c1">//RAIIå°è£…çš„Lockç±»ï¼Œè¯¦ç»†å¯å‚è€ƒ é˜…è¯»æ€»ç»“(äºŒ)-Rule14
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">bgImage_</span><span class="p">.</span><span class="n">reset</span><span class="p">(</span><span class="k">new</span> <span class="n">Image</span><span class="p">(</span><span class="n">imgSrc</span><span class="p">));</span><span class="c1">//è‹¥newå¤±è´¥ï¼Œåˆ™ä¸ä¼šreset
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">++</span><span class="n">imageChangeCnt_</span><span class="p">;</span><span class="c1">//æŠŠäº‹æƒ…åšå®Œå†++count
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>ä¸æŠ›å¼‚å¸¸</strong>
åœ¨åŸä¹¦ä¸­ï¼Œè¿™ä¸ªâ€œNo Throwâ€ä¸æ˜¯ç»å¯¹ä¸æŠ›å¼‚å¸¸ï¼Œè€Œæ˜¯ä¸€æ—¦æ„å¤–æŠ›å¼‚å¸¸ï¼Œå°±ä¼šè°ƒç”¨unexpectedå‡½æ•°è¿›è€Œabortï¼ˆä¾‹å¦‚<code>int doSomething() throw();//ç©ºç™½çš„å¼‚å¸¸æ˜ç»†</code>ï¼‰ã€‚</p>
</li>
</ul>
<div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>åŸä¹¦ä¸­ä¾‹å­çš„ <strong>throw()</strong> åœ¨ä¸åŒç¼–è¯‘å™¨è¡¨ç°ä¸ä¸€è‡´ï¼Œç°åœ¨å·²ç» <strong>ä¸æ¨èä½¿ç”¨</strong>ã€‚</p>
<p>æ›´è¯¦ç»†èµ„æ–™å¯å‚è€ƒ<a href="http://gotw.ca/publications/mill22.htm"target="_blank" rel="external nofollow noopener noreferrer">A Pragmatic Look at Exception Specifications<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>å’Œ<a href="https://stackoverflow.com/questions/88573/should-i-use-an-exception-specifier-in-c"target="_blank" rel="external nofollow noopener noreferrer">Should I use an exception specifier in C++<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>åœ¨C++11ä¸­ï¼Œæœ‰äº†æ›´å¯é æœ‰æ•ˆçš„å…³é”®å­—noexceptï¼Œä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œæœ‰æ“ä½œç¬¦å’Œå¼‚å¸¸æç¤ºç¬¦ä¸¤ç§ä½œç”¨ï¼Œä¸‹æ–¹å±•ç¤ºç®€å•ç”¨æ³•ï¼š</p>
<div class="highlight" id="id-51"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">f</span><span class="p">()</span> <span class="k">noexcept</span><span class="p">;</span> <span class="c1">// å‡½æ•° f() ä¸ä¼šæŠ›å‡º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fp</span><span class="p">)()</span> <span class="k">noexcept</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span> <span class="c1">// fp æŒ‡å‘å¯èƒ½ä¼šæŠ›å‡ºçš„å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">g</span><span class="p">(</span><span class="kt">void</span> <span class="n">pfa</span><span class="p">()</span> <span class="k">noexcept</span><span class="p">);</span>  <span class="c1">// g æ¥æ”¶æŒ‡å‘ä¸ä¼šæŠ›å‡ºçš„å‡½æ•°çš„æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1">// typedef int (*pf)() noexcept; // é”™è¯¯
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ›´è¯¦ç»†çš„<code>noexcept</code>ä»‹ç»å¯ä»¥è®¿é—®<a href="https://zh.cppreference.com/w/cpp/language/noexcept"target="_blank" rel="external nofollow noopener noreferrer">cppreferenceï¼šnoexceptæ“ä½œç¬¦<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>å’Œ<a href="https://zh.cppreference.com/w/cpp/language/noexcept_spec"target="_blank" rel="external nofollow noopener noreferrer">cppreferenceï¼šnoexceptå¼‚å¸¸è¯´æ˜ç¬¦<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
</div>
    </div>
  </div>
<h4 id="ä½¿ç”¨copy-and-swapä¿éšœå¼‚å¸¸å®‰å…¨">ä½¿ç”¨copy-and-swapä¿éšœå¼‚å¸¸å®‰å…¨</h4>
<p><code>copy-and-swap</code>æŠ€æœ¯ï¼šå…ˆæ‹·è´ä¸€ä»½æƒ³ä¿®æ”¹çš„å¯¹è±¡ï¼Œç­‰ä¿®æ”¹å½»åº•å®Œæˆåï¼ˆè¿‡ç¨‹ä¸­ä¸æŠ›å¼‚å¸¸ï¼‰ï¼Œå†ä¸åŸå¯¹è±¡äº¤æ¢ã€‚</p>
<p>ä¸ºäº†æ›´å½¢è±¡å±•ç¤ºè¿™ä¸€è¿‡ç¨‹ï¼Œä½¿ç”¨pImlæ‰‹æ³•å¯¹bgImage_å°è£…ä¸€ä¸‹ï¼š</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">ImgPimpl</span><span class="p">{</span> <span class="c1">//é€‰ç”¨structè€ŒéClassï¼šæ–¹ä¾¿ï¼›æœ€åè¢«privateæˆå‘˜å½¢å¼ä½¿ç”¨ï¼Œå°è£…æ€§ä¸ç”¨æ‹…å¿ƒ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Image</span><span class="o">&gt;</span> <span class="n">bgImage_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="n">imageChangeCnt_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆPrettyMenuç±»å¯ä»¥æ”¹ä¸ºå¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PrettyMenu</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Mutex</span> <span class="n">mutex_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">ImgPimpl</span><span class="o">&gt;</span> <span class="n">pImpl_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>  <span class="c1">//æ„é€ ç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">void</span> <span class="n">PrettyMenu</span><span class="o">::</span><span class="n">changeBackground</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ifstream</span><span class="o">&amp;</span> <span class="n">imgSrc</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">using</span> <span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">;</span>   <span class="c1">//å‚è€ƒ é˜…è¯»æ€»ç»“(äºŒ)-Rule25
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">CLock</span> <span class="nf">ml</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_</span><span class="p">);</span><span class="c1">//RAIIå°è£…çš„Lockç±»ï¼Œè¯¦ç»†å¯å‚è€ƒæ€»ç»“(äºŒ)-Rule14
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">ImgPimpl</span><span class="o">&gt;</span> <span class="n">pNewCopy</span><span class="p">(</span><span class="k">new</span> <span class="n">ImgPimpl</span><span class="p">(</span><span class="o">*</span><span class="n">pImpl_</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">pNewCopy</span><span class="o">-&gt;</span><span class="n">bgImage_</span><span class="p">.</span><span class="n">reset</span><span class="p">(</span><span class="k">new</span> <span class="n">Image</span><span class="p">(</span><span class="n">imgSrc</span><span class="p">));</span> <span class="c1">//ä¿®æ”¹å‰¯æœ¬
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">++</span><span class="n">pNewCopy</span><span class="o">-&gt;</span><span class="n">imageChangeCnt_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">swap</span><span class="p">(</span><span class="n">pImpl_</span><span class="p">,</span><span class="n">pNewCopy</span><span class="p">);</span><span class="c1">//æ”¹å®Œä¹‹åswap
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å¼‚å¸¸å®‰å…¨çš„è¿å¸¦å½±å“side-effects">å¼‚å¸¸å®‰å…¨çš„è¿å¸¦å½±å“(side effects)</h4>
<p>å‡½æ•°æä¾›çš„â€œå¼‚å¸¸å®‰å…¨ä¿è¯ç­‰çº§â€åª<strong>å–å†³äº</strong>å…¶è°ƒç”¨çš„<strong>å„ä¸ªå­å‡½æ•°çš„â€œæœ€ä¸å®‰å…¨è€…â€</strong>ã€‚</p>
<p>è€ƒè™‘ä»¥ä¸‹å‡½æ•°SomeFuncä»£ç ï¼š</p>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">SomeFunc</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span> <span class="c1">// å¯¹localçŠ¶æ€åšä¸€ä»½å‰¯æœ¬
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">f1</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">f2</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>  <span class="c1">//å°†ä¿®æ”¹åçš„çŠ¶æ€ç½®æ¢è¿‡æ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong><code>åˆ†æ</code></strong>ï¼šæ˜¾ç„¶copy-and-swapåœ¨å°½åŠ›å¼ºçƒˆä¿è¯å¼‚å¸¸å®‰å…¨ï¼Œä½†æ˜¯ï¼Œf1æˆ–è€…f2çš„å¼‚å¸¸å®‰å…¨å¦‚æœæ¯”è¾ƒä½ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦å•ç‹¬å¯¹f1ï¼Œf2è¿›è¡Œcopy-and-swapï¼Œæ¥å°è¯•ä¿è¯â€œå¼ºçƒˆå¼‚å¸¸å®‰å…¨â€ï¼›å³ä½¿å¦‚æ­¤ï¼Œå¦‚æœf1èƒ½æˆåŠŸåšäº†ä¿®æ”¹ï¼Œä½†æ˜¯f2ä¿®æ”¹å¤±è´¥äº†å¹¶å›é€€ï¼Œé‚£ä¹ˆ<strong>f1ã€f2æ•´ä½“</strong>çœ‹èµ·æ¥è¿˜æ˜¯â€œ<strong>æ”¹äº†ä¸€éƒ¨åˆ†</strong>â€ã€‚</p>
<p><strong><code>è¿™ä¹Ÿå‘Šè¯«æˆ‘ä»¬</code></strong>ï¼Œå¦‚æœå¼•å…¥äº†å¼‚å¸¸ä¸å®‰å…¨çš„æ—§ä»£ç ï¼Œé‚£ä¹ˆè¿™ç§ç‰¹æ€§ä¼šæ³¢åŠå…¶ä»–ä»£ç ã€‚</p>
<p>å°±è®¾è®¡è€…è€Œè¨€ï¼Œåªèƒ½æ ¹æ®å®é™…æƒ…å†µï¼Œå°½å¯èƒ½ä¿è¯â€œå¼‚å¸¸å®‰å…¨â€ï¼Œé€‰æ‹©3ä¸ªå¼‚å¸¸å®‰å…¨ç­‰çº§ä¹‹ä¸€å®æ–½ã€‚</p>
<h3 id="r30-é€å½»äº†è§£inlineçš„é‡Œé‡Œå¤–å¤–">R30 é€å½»äº†è§£inlineçš„é‡Œé‡Œå¤–å¤–</h3>
<p><code>inline</code>æ˜¯C++çš„å…³é”®å­—ï¼Œè¡¨ç¤ºå†…è”å‡½æ•°ã€‚<code>ç›´æ¥åœ¨å¯¹åº”ä½ç½®å±•å¼€ä»£ç </code>ï¼Œå…å»å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼Œéš¾ä»¥é¿å… â€œ<strong>ä»£ç è†¨èƒ€</strong>â€é—®é¢˜ã€‚</p>
<p>ä½¿ç”¨inlineæ—¶åº”è¯¥æ³¨æ„ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>
<p><strong>inlineåªæ˜¯å¯¹ç¼–è¯‘å™¨çš„ç”³è¯·</strong>
inlineåªæ˜¯å¯¹ç¼–è¯‘å™¨çš„ç”³è¯·/å»ºè®®ï¼Œä¸æ˜¯å¼ºåˆ¶å‘½ä»¤ï¼Œ<strong>ç¼–è¯‘å™¨æœ‰æƒåˆ©</strong> å¯¹å…¶è®¤ä¸ºä¸é€‚åˆinlineçš„å‡½æ•°<strong>æ‹’ç»</strong>inlineã€‚ ï¼ˆåŸä¹¦è¯´ï¼šå¦‚æœç¼–è¯‘å™¨æ‹’ç»ï¼Œé€šå¸¸å®ƒä¼šç»™å‡ºwarningä¿¡æ¯ã€‚å®é™…æœ¬äººå®æµ‹VS2017æ²¡çœ‹åˆ°ï¼‰
inlineæœ‰2ç§ç”³è¯·æ–¹å¼ ï¼š</p>
<ol>
<li>åœ¨å‡½æ•°å®šä¹‰ æ—¶ä½¿ç”¨å…³é”®å­—inline<strong>æ˜¾å¼å¼ºè°ƒ</strong></li>
<li>å®ç°åœ¨Classå†…çš„æˆå‘˜å‡½æ•°æˆ–friendå‡½æ•°ï¼Œå±äº<strong>éšå¼inline</strong></li>
</ol>
</li>
<li>
<p><strong>inlineå’ŒTemplateæ²¡æœ‰ä»»ä½•å¿…ç„¶è”ç³»</strong>
è™½ç„¶æœ‰ä¸å°‘ç®€çŸ­çš„Templateå‡½æ•°æ˜¯å¸¦æœ‰inlineï¼ˆä¾‹å¦‚ä¸‹æ–¹çš„std::maxï¼‰ï¼Œä½†ä¸æ˜¯å¿…ç„¶ä¸ºä¹‹ï¼Œ<strong>ä¸¤è€…æ²¡æœ‰å› æœå…³ç³»</strong>ã€‚</p>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">){</span> <span class="c1">//å¯ä»¥ç”³è¯·inlineï¼Œä½†ä¸æ˜¯å¿…é¡»ç”³è¯·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span> <span class="o">?</span> <span class="nl">b</span> <span class="p">:</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>ç¼–è¯‘å™¨æ‹’ç»å¤æ‚å‡½æ•°è¿›è¡Œinline</strong>
å¤æ‚å‡½æ•°çš„inlineä¼šå¸¦æ¥è¾ƒä¸¥é‡çš„â€œä»£ç è†¨èƒ€â€é—®é¢˜ï¼Œå¹¶ä¸”å¯èƒ½ä¼šæ›´æ…¢ï¼Œå› ä¸ºå¢åŠ äº†è¿è¡Œæ—¶çš„â€œé¢å¤–æ¢é¡µâ€è¡Œä¸ºï¼Œé™ä½äº†æŒ‡ä»¤cacheå‘½ä¸­ç‡ã€‚</p>
<ol>
<li>inlineå‡½æ•°å†…ä¸è¦å‡ºç°å¾ªç¯æˆ–é€’å½’</li>
<li>è™šå‡½æ•°ä¹Ÿä¸é€‚åˆåšinline
å› ä¸ºinlineæ˜¯ç¼–è¯‘æœŸé—´å†³å®šçš„äº‹ï¼Œè€Œè™šå‡½æ•°æ˜¯è¿è¡Œæ—¶å†³å®šçš„äº‹ï¼Œä¸¤è€…å°±ä¸æ˜¯åŒä¸€ä¸ªåœºæ™¯çš„ã€‚</li>
<li>æ„é€ /ææ„å‡½æ•°ä¹Ÿä¸é€‚åˆåšinline
ç¼–è¯‘å™¨å¯èƒ½ä¼šåœ¨æ„é€ /ææ„å‡½æ•°å†…éƒ¨åšç²¾å¦™å¤æ‚çš„å¼‚å¸¸å¤„ç†ï¼›ä»¥åŠåœ¨ç»§æ‰¿ä½“ç³»ä¸‹ï¼ŒBaseç±»å‡½æ•°ä½“åˆ°å¤„inlineè†¨èƒ€ã€‚</li>
</ol>
</li>
<li>
<p><strong>ä»¥å‡½æ•°æŒ‡é’ˆå½¢å¼çš„è°ƒç”¨é€šå¸¸ä¸èƒ½inline</strong>
å¯¹ç»å¤§å¤šæ•°ç¼–è¯‘å™¨è€Œè¨€ï¼Œæ˜¯å¦inlineæ˜¯compileé˜¶æ®µå†³å®šçš„äº‹æƒ…ï¼Œå°‘æ•°ç¼–è¯‘å™¨æ”¾åˆ°äº†linké˜¶æ®µã€‚</p>
<p>è®¨è®ºå¤§å¤šæ•°æƒ…å†µï¼šéœ€è¦åœ¨ç¼–è¯‘æ—¶å¾—çŸ¥inlineçš„æœ¬ä½“ï¼Œè€Œå‡½æ•°æŒ‡é’ˆåŠä¸åˆ°ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">f</span><span class="p">()</span> <span class="p">{...}</span> <span class="c1">//å‡è®¾ç¼–è¯‘å™¨æœ‰æ„æ„¿inline â€œå¯¹fçš„è°ƒç”¨â€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span> <span class="n">pf</span><span class="p">)()</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span><span class="c1">//pf æ‰§è¡Œf
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span><span class="p">();</span>     <span class="c1">//è¿™ä¸ªè°ƒç”¨å°†è¢«inlinedï¼Œå› ä¸ºæ˜¯ä¸ªæ­£å¸¸è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">pf</span><span class="p">();</span>     <span class="c1">//è¿™ä¸ªå¾ˆå¯èƒ½ä¸è¢«inlined
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>è¿‡åº¦inlineå¯¹è°ƒè¯•å’Œå‘å¸ƒå¸¦æ¥å›°éš¾</strong>
inlineæ˜¯ä»£ç åµŒå…¥ä¸å±•å¼€ï¼Œè€Œéå‡½æ•°è°ƒç”¨ï¼Œæ‰€ä»¥æŸäº›ç¼–è¯‘å™¨ä¸æ”¯æŒinlineçš„å•æ­¥Debugï¼ˆå°±åƒå®å±•å¼€ä¸€æ ·ä¸æ”¯æŒè°ƒè¯•ï¼‰ï¼›å¦å¤–ï¼Œinlineåªè¦å·²ä¿®æ”¹ï¼Œæ¶‰åŠè°ƒç”¨å®ƒçš„ä»£ç å…¨éƒ½è¦ç¼–è¯‘ï¼Œå¦‚æœæ˜¯non-inlineåˆ™å¯èƒ½åªéœ€è¦é‡æ–°linkå³å¯ã€‚</p>
</li>
</ul>
<h3 id="r31-å°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾èµ–å…³ç³»é™è‡³æœ€ä½">R31 å°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾èµ–å…³ç³»é™è‡³æœ€ä½</h3>
<p>C++çš„Classå®šä¹‰å¼åŒ…æ‹¬äº†æˆå‘˜å˜é‡ï¼Œå‡è®¾æŸæˆå‘˜å˜é‡æ˜¯ç±»å¯¹è±¡<code>ClassObjA a</code>ï¼Œå¦‚æœ<code>ClassObjA</code>ç±»çš„å†…éƒ¨å®ç°å‘ç”Ÿäº†æ”¹å˜ï¼ˆå“ªæ€•è¿™ä¸ª<code>ClassObjA.h</code>å†…åªåœ¨æŸå¤„åŠ äº†ä¸€ä¸ªç©ºæ ¼ ï¼‰ï¼Œé‚£ä¹ˆincludeäº†<code>ClassObjA.h</code>çš„æ‰€æœ‰<code>.h</code>æ–‡ä»¶<code>.cpp</code>æ–‡ä»¶éƒ½ä¼š<strong>é‡æ–°ç¼–è¯‘</strong>ã€‚</p>
<p>ğŸ‘†è¿™å°±æ˜¯ç”±â€œ<strong>ç¼–è¯‘ä¾èµ–</strong>â€å…³ç³»å¸¦æ¥çš„é—®é¢˜ã€‚</p>
<p>ä½¿ç”¨ <code>PIMPL</code> æ‰‹æ³•(pointer to implementation)å¯ä»¥å¾ˆå¥½åœ°åˆ†ç¦»å£°æ˜å’Œå®šä¹‰ï¼š</p>
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//Person.hæ–‡ä»¶  ä¸éœ€è¦include &#34;PersonImpl.h&#34;å’Œ&#34;BirthDay.h&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">PersonImpl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BirthDay</span><span class="p">;</span><span class="c1">// å‰ç½®å£°æ˜ä»£æ›¿include
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span><span class="c1">// æ„é€ å‡½æ•°è¿™é‡Œæ”¾å®ç°æ— æ‰€è°“ï¼Œå› ä¸ºæ˜¯å‡½æ•°æŒ‡é’ˆï¼Œä¸éœ€çŸ¥é“PersonImplæœ¬ä½“å®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Person</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">PersonImpl</span><span class="o">&gt;&amp;</span> <span class="n">pImpl</span><span class="p">);</span><span class="c1">//æ„é€ å‡½æ•°çš„å®ç°ä¹Ÿæ”¾åˆ°cppé‡Œå»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">const</span> <span class="n">BirthDay</span><span class="o">&amp;</span> <span class="n">GetBirthDay</span><span class="p">();</span><span class="c1">// æ³¨æ„ï¼šè¿™é‡Œåªå£°æ˜ï¼ŒæŠŠå®ç°éƒ¨åˆ†æ”¾åˆ°cppé‡Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">GetName</span><span class="p">();</span><span class="c1">//å®ç°ç»†èŠ‚ç”±pImpl_è½¬å‘å®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">PersonImpl</span><span class="o">&gt;</span> <span class="n">pImpl_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">//Person.cppæ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#include</span> <span class="cpf">&#34;PersonImpl.h&#34; //åœ¨&#34;PersonImpl.h&#34;æ–‡ä»¶å†…includeé‚£ä¸ª&#34;BirthDay.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;Person.h&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼šImplç”¨æ³•ï¼Œç›¸å…³çš„å¤´æ–‡ä»¶é‡Œä¸è¦æ”¾ç½®ä»»ä½•å‡½æ•°å®ç°ä»£ç  ã€‚
ä¸Šè¿°åšæ³•å¯ä»¥è®©ä½¿ç”¨Personç±»çš„å®¢æˆ·ä¸éœ€è¦å†å…³å¿ƒPersonImplä»¥åŠBirthDayçš„å®ç°ç»†èŠ‚äº†ï¼Œåšåˆ°äº†â€œæ¥å£ä¸å®ç°åˆ†ç¦»â€ï¼Œå…³é”®ç‚¹åœ¨äºæŠŠâ€œå®šä¹‰çš„ä¾èµ–æ€§â€ æ¢æˆ $\Rightarrow$ â€œ<strong>å£°æ˜çš„ä¾èµ–æ€§</strong>â€ã€‚
è¿™é‡Œçªå‡ºäº†å¦‚ä½•<strong>æœ€å°åŒ–ç¼–è¯‘ä¾èµ–æ€§</strong>çš„æœ¬è´¨ï¼š<code>è®©å¤´æ–‡ä»¶å°½å¯èƒ½è‡ªæˆ‘æ»¡è¶³</code>ï¼Œå¦‚æœä¸è¡Œï¼Œä¹Ÿè¦ä¾èµ–äºå…¶ä»–æ–‡ä»¶çš„å£°æ˜å¼è€Œéå®šä¹‰å¼ã€‚</p>
<p>å…·ä½“åˆ°è®¾è®¡ç­–ç•¥ä¸Šï¼Œæœ‰ä»¥ä¸‹å‡ ç§åšæ³•ï¼š</p>
<ul>
<li>
<p>å¦‚æœèƒ½ç”¨object references æˆ– object pointerså®Œæˆä»»åŠ¡ï¼Œå°±åˆ«ç”¨objects
å¦‚æœè¦å®šä¹‰æŸç±»å‹çš„objectsï¼Œå°±è¦ä½¿ç”¨å®šä¹‰å¼ï¼ŒæŒ‡é’ˆå’Œåº”ç”¨åˆ™å¯ä»¥åªç”¨å£°æ˜å¼ã€‚</p>
</li>
<li>
<p>å°½é‡ä»¥classå£°æ˜å¼æ›¿æ¢classå®šä¹‰å¼
å‡½æ•°å£°æ˜ç§çš„Classç±»å‹å¯ä»¥åªç”¨å£°æ˜å¼ï¼Œå³ä½¿ä»¥by-object-valueå½¢å¼ä¼ å€¼ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
</li>
<li>
<p>ä¸ºå£°æ˜å¼å’Œå®šä¹‰å¼æä¾›ä¸åŒçš„æ–‡ä»¶
æ¯”å¦‚Dateç±»ï¼Œåˆ†ä¸ºåªåŒ…å«å£°æ˜å¼çš„&quot;Datefwd.h&quot;å’ŒåŒ…å«å®šä¹‰å¼çš„&quot;Date.h&quot;ï¼Œé‚£ä¹ˆä½¿ç”¨æ—¶ç”¨å£°æ˜å¼å¤´æ–‡ä»¶ä»£æ›¿å‰ç½®å£°æ˜ï¼Œåœ¨éœ€è¦åº”ç”¨ä»£ç client.cppé‡Œincludeå®šä¹‰å¼å¤´æ–‡ä»¶ã€‚è¿™ç§æ–¹å¼åœ¨æ ‡å‡†åº“é‡Œé‡‡ç”¨è¾ƒå¤šï¼Œå‚è€ƒ<iosfwd>å’Œ<sstream>,<fstream>,<streambuf>ç­‰ã€‚</p>
</li>
</ul>
<div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><ul>
<li>C/C++å¯ä»¥ä½¿ç”¨ç¼–è¯‘å™¨é¢„å¤„ç†æŒ‡ä»¤<font color=red><code>#pragma message</code></font>ï¼Œæ‰“å°å‡ºè¯¥æ–‡ä»¶æ˜¯å¦å‚ä¸æ­¤æ¬¡ç¼–è¯‘ï¼Œä»¥åŠå‚ä¸ç¼–è¯‘æ—¶è¢«å“ªä¸ªæ–‡ä»¶æ‰€ä¾èµ–ã€‚
<div class="highlight" id="id-52"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//æ¯”å¦‚å¯ä»¥åœ¨ testEffective.h æ–‡ä»¶å†…åŠ ä¸Šè¿™å¥ï¼Œå°±èƒ½åœ¨ç¼–è¯‘è¾“å‡ºä¿¡æ¯é‡Œçœ‹åˆ°æ‰“å°ä¿¡æ¯ï¼Œè§‚å¯Ÿåˆ°ä¾èµ–å…³ç³»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#pragma message(&#34;testEffective.h å‚ä¸é‡æ–°ç¼–è¯‘&#34;)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">//è¿˜å¯ä»¥ç”¨äºæµ‹è¯•æŸäº›å®æ˜¯å¦çœŸçš„ç”Ÿæ•ˆï¼Œæœ‰æ—¶IDEçš„é«˜äº®æ˜¾ç¤ºä¸å‡†ç¡®è€Œä»¤äººç”Ÿç–‘ã€‚
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>å…³äºå¤´æ–‡ä»¶includeçš„å…¶ä»–ç¼–å†™è§„èŒƒï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/headers/#"target="_blank" rel="external nofollow noopener noreferrer">Google-C++é£æ ¼æŒ‡å—ï¼š1.å¤´æ–‡ä»¶<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
</ul>
</div>
    </div>
  </div>
<p>ä½¿ç”¨ <font color><strong><code>Interface Class</code></strong></font> ä¹Ÿèƒ½åšåˆ°æ¥å£å’Œå®ç°çš„çœŸæ­£åˆ†ç¦»ï¼š</p>
<p>è¿™ç§æ–¹å¼å¸¸è§äºè¾“å‡ºåŠ¨æ€åº“ç»™åˆ°å®¢æˆ·ä½¿ç”¨ï¼Œå®¢æˆ·èƒ½è§åˆ°æ¥å£å®šä¹‰å’Œä½¿ç”¨ï¼Œä½†æ— æ³•çœ‹åˆ°å†…éƒ¨å®ç°ã€‚</p>
<p>ç”¨æ³•è¾ƒä¸ºå¸¸è§ï¼Œä¸èµ˜è¿°ï¼Œç›´æ¥<strong>show-code</strong>ï¼š</p>
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//VirtualPerson.h   //å’Œ libæ–‡ä»¶ä¸€èµ·æä¾›ç»™åˆ°å®¢æˆ·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">VirtualPerson</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span> <span class="c1">//createçš„è¿”å›å€¼è¿˜å¯ä»¥æ ¹æ®éœ€æ±‚ï¼Œæ¢æˆRAIIçš„æ™ºèƒ½æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">static</span> <span class="n">VirtualPerson</span> <span class="o">*</span> <span class="n">create</span><span class="p">(</span><span class="kt">int</span> <span class="n">level</span><span class="p">,</span> <span class="kt">int</span> <span class="n">salary</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">Level</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">Salary</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="o">~</span><span class="n">VirtualPerson</span><span class="p">();</span><span class="c1">// avoid memory leak
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">//VirtualPerson.cpp  //æºç ä¸æä¾›ç»™å®¢æˆ·ï¼Œè€Œæ˜¯ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶ libæ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">VirtualPerson</span><span class="o">*</span> <span class="n">VirtualPerson</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="kt">int</span> <span class="n">level</span><span class="p">,</span> <span class="kt">int</span> <span class="n">salary</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">level</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//å·¥å‚æ–¹æ³•ï¼Œè¿˜å¯ä»¥ç”Ÿæˆå…¶ä»–å­ç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="nf">Engineer</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">salary</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">VirtualPerson</span><span class="o">::~</span><span class="n">VirtualPerson</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Engineer.h  //Engineerä¹Ÿæ˜¯å‚ä¸ç¼–è¯‘åˆ° libæ–‡ä»¶ä¸­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Engineer</span><span class="o">:</span> <span class="k">public</span> <span class="n">VirtualPerson</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Engineer</span><span class="p">(</span><span class="kt">int</span> <span class="n">level</span><span class="p">,</span><span class="kt">int</span> <span class="n">salary</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">Level</span><span class="p">()</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="nf">Salary</span><span class="p">()</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">level_</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">salary_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ch6-ç»§æ‰¿ä¸é¢å‘å¯¹è±¡è®¾è®¡">CH6. ç»§æ‰¿ä¸é¢å‘å¯¹è±¡è®¾è®¡</h2>
<h3 id="r32-ç¡®å®šä½ çš„publicç»§æ‰¿å¡‘é€ å‡ºis-aå…³ç³»">R32 ç¡®å®šä½ çš„publicç»§æ‰¿å¡‘é€ å‡ºis-aå…³ç³»</h3>
<p>åŸä¹¦æ ‡é¢˜ï¼š<strong>Make sure public inheritance models â€œis-aâ€</strong>. ä¾¯æ·è€å¸ˆç¿»è¯‘ä¸ºâ€œå¡‘æ¨¡â€ï¼Œæˆ‘ä¸ªäººæ›´æ„¿æ„ç§°ä¸ºâ€œå¡‘é€ â€ã€‚</p>
<ul>
<li><strong>â€œpublicç»§æ‰¿â€æ„å‘³ç€is-a</strong>
is-aï¼Œå³â€œæ˜¯ä¸€ç§â€ï¼Œå°±æ˜¯è¯´ï¼Œé€‚ç”¨äºBase Classèº«ä¸Šçš„æ¯ä¸€ä»¶äº‹ï¼Œä¹Ÿä¸€å®šé€‚ç”¨äºDerived Classèº«ä¸Šã€‚</li>
</ul>
<div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>é¢å‘è®¾è®¡å¯¹è±¡çš„è®¾è®¡æœ‰è‘—åçš„5å¤§åŸåˆ™ï¼Œ SOLID åŸåˆ™ï¼Œæ¯ä¸ªå­—æ¯åˆ†åˆ«ä»£è¡¨ä¸€ç§åŸåˆ™ï¼š</p>
<ul>
<li>Sâ€“å•ä¸€è´£ä»»åŸåˆ™(SRP) â€“Single Responsibility Principle</li>
<li>Oâ€“å¼€æ”¾å°é—­åŸåˆ™(OCP)â€“ Open-Closed Principle</li>
<li>Lâ€“é‡Œå¼æ›¿æ¢åŸåˆ™(LSP)â€“ Liskov Substitution Principle</li>
<li>I â€“- æ¥å£åˆ†ç¦»åŸåˆ™(ISP)â€“Interface Segregation Principle</li>
<li>Dâ€“-ä¾èµ–å€’ç½®åŸåˆ™(DIP)â€“ Dependency Inversion Principle</li>
</ul>
<p>æ›´è¯¦ç»†çš„å™è¿°å¯ä»¥å‚è€ƒï¼š<a href="https://cloud.tencent.com/developer/article/1503629"target="_blank" rel="external nofollow noopener noreferrer">è…¾è®¯äº‘ï¼šSOLIDåŸåˆ™<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
</div>
    </div>
  </div>
<p>æœ¬èŠ‚æ¡æ¬¾çš„ä¸­å¿ƒæ€æƒ³å³é‡Œæ°æ›¿æ¢åŸåˆ™ï¼š<strong>ä¸€ä¸ªå¯¹è±¡å‡ºç°çš„åœ°æ–¹éƒ½å¯ä»¥ç”±å…¶å­ç±»ä»£æ›¿å¹¶ä¸”ä¸ä¼šå‡ºé”™ã€‚</strong></p>
<p>ç»§æ‰¿å…³ç³»æœ‰æ—¶å€™å¬èµ·æ¥å¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚ <code>Class Student: public Person</code>ç†æ‰€åº”å½“ï¼Œä½†æœ‰æ—¶ä¹Ÿä¼šå¯¼è‡´è¯¯è§£ã€‚æ¯”å¦‚ä¼é¹…å±äºé¸Ÿç±»ï¼Œä½†ä¼é¹…ä¸ä¼šé£ï¼Œé‚£ä¹ˆåŸºç±»<code>Bird::Fly</code>æ–¹æ³•åˆå½“å¦‚ä½•å¤„ç†ï¼Œä¸‹æ–¹æ»¡è¶³è®¾è®¡æ„å›¾ï¼š</p>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Bird</span><span class="p">{</span>   <span class="c1">//... ä¸å£°æ˜Fly()æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FylingBird</span><span class="o">:</span><span class="k">public</span> <span class="n">Bird</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span> <span class="k">virtual</span> <span class="kt">void</span> <span class="n">Fly</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Penguin</span><span class="o">:</span> <span class="k">public</span> <span class="n">Bird</span><span class="p">{</span> <span class="c1">//... ä¸å£°æ˜Fly()æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">// æ³¨ï¼šå¦‚æœBirdç±»ä»¥åŠå­ç±»éƒ½ä¸è€ƒè™‘Fly()æ–¹æ³•ï¼Œé‚£ä¹ˆPenguinç›´æ¥ç»§æ‰¿äºBirdå³å¯
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿˜æœ‰å¦ä¸€ç§åœºæ™¯ï¼Œçˆ¶ç±»å’Œå­ç±»å¯¹äºåŒä¸€ä¸ªæ–¹æ³•çš„æ•°æ®ä¿®æ”¹è§„åˆ™ä¸åŒï¼Œå¯¼è‡´äº†ç»§æ‰¿ä½“ç³»çš„ç¼ºé™·ã€‚
æ¯”å¦‚<code>Class Square:public Rectangle</code> $\rightarrow$ æ­£æ–¹å½¢ç»§æ‰¿äºé•¿æ–¹å½¢ï¼Œä½†æ˜¯è€ƒè™‘è¿™æ ·ä¸€ä¸ª<strong>ç±»å¤–æ–¹æ³•</strong>:</p>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">makeBigger</span><span class="p">(</span><span class="n">Rectangle</span><span class="o">&amp;</span> <span class="n">r</span><span class="p">){</span>  <span class="c1">//æ™®é€šéæˆå‘˜å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">oldHeight</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">height</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="p">.</span><span class="n">setWidth</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10</span><span class="p">);</span><span class="c1">//å¦‚æœræ˜¯Squqreï¼Œå¯èƒ½å†…éƒ¨è‡ªåŠ¨å°±é•¿å®½ä¸€èµ·å˜äº†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">assert</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">height</span><span class="p">()</span> <span class="o">==</span> <span class="n">oldHeight</span><span class="p">);</span><span class="c1">//è¿™ä¸ªassertå¯¹äºæ­£æ–¹å½¢å°±ä¸åˆé€‚äº†,è´¸ç„¶å»é™¤åˆè¿èƒŒè®¾è®¡æœ¬æ„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åº”å¯¹ä¸Šè¿°è¿™æ ·çš„æƒ…å†µï¼Œå°±éœ€è¦ä¿®æ”¹è®¾è®¡æˆ–ä¿®æ”¹ç»§æ‰¿ä½“ç³»äº†ã€‚</p>
<h3 id="r33-é¿å…é®æ©ç”±ç»§æ‰¿å¾—æ¥çš„åç§°">R33 é¿å…é®æ©ç”±ç»§æ‰¿å¾—æ¥çš„åç§°</h3>
<p>é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯åç§°çš„é®æ©ï¼Œé€šä¿—åœ°è¯´ï¼Œæ˜¯æŒ‡ç”±äºä½œç”¨åŸŸä¸åŒå¸¦æ¥çš„å˜é‡åè¦†ç›–ã€‚è€ƒè™‘ä¸‹æ–¹ä»£ç ï¼š</p>
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">someFunc</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;x is&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// localä½œç”¨åŸŸæ‰¾åˆ°äº†xï¼Œç›´æ¥è¦†ç›–å…¨å±€çš„xï¼Œè¾“å‡º0.1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆå¦‚æœå°†ç»§æ‰¿ä½“ç³»è€ƒè™‘è¿›æ¥å‘¢ï¼š<strong>Derivedçš„ä½œç”¨åŸŸä¼šè¦†ç›–Baseçš„ä½œç”¨åŸŸ</strong>ï¼ŒåŒ…æ‹¬virtualå’Œnon-virtualã€‚è€ƒè™‘ä¸‹æ–¹ä»£ç ï¼š</p>
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">mf1</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">mf1</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Base::mf1():x =&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">mf2</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Base::mf2()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">mf3</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Base::mf3()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">mf3</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Base::mf3():x =&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="o">~</span><span class="n">Base</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Derived</span> <span class="o">:</span><span class="k">public</span> <span class="n">Base</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">mf1</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Derived::mf1()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">mf3</span><span class="p">(){</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Derived::mf3()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¾ˆæ˜æ˜¾å­˜åœ¨åç§°é®æ©çš„é—®é¢˜ï¼ŒDerivedçš„mf1ï¼Œmf3ä¼šé®æ©å­ç±»çš„æ‰€æœ‰åŒåå‡½æ•°ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">Derived</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">.</span><span class="n">mf1</span><span class="p">();</span>      <span class="c1">//OKï¼Œè¾“å‡º: Derived::mf1()
</span></span></span><span class="line"><span class="cl"><span class="c1">//d.mf1(100);  ç¼–è¯‘æŠ¥é”™ï¼Œå› ä¸ºåç§°è¢«é®æ©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">d</span><span class="p">.</span><span class="n">mf2</span><span class="p">();</span>      <span class="c1">//OKï¼Œè¾“å‡º: Base::mf2()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">d</span><span class="p">.</span><span class="n">mf3</span><span class="p">();</span>      <span class="c1">//OKï¼Œè¾“å‡º: Derived::mf3()
</span></span></span><span class="line"><span class="cl"><span class="c1">//d.mf3(300);  ç¼–è¯‘æŠ¥é”™ï¼ŒåŒç†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">d</span><span class="p">.</span><span class="n">Base</span><span class="o">::</span><span class="n">mf3</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span> <span class="c1">//OKï¼Œè¾“å‡º: Base::mf3():x =300 . ä½†æ˜¯ä¸å¤ªå»ºè®®è¿™ä¹ˆå†™ï¼Œä¸‘ï¼ï¼
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨usingå£°æ˜å¼æˆ–è½¬å‘å‡½æ•°
<ol>
<li>using å£°æ˜å¼
å¯ä»¥ä½¿ç”¨usingå£°æ˜å¼ï¼Œè®©Derivedå¯ä»¥å¿½ç•¥åç§°é®æ©ï¼Œçœ‹åˆ°Baseä½œç”¨åŸŸå†…çš„å‡½æ•°ã€‚å¯ä»¥è®©ä¸Šæ–¹ä»£ç çš„â€œç¼–è¯‘æŠ¥é”™â€æ¶ˆå¤±ï¼Œæ­£å¸¸è°ƒç”¨d.mf1(100)å’Œd.mf3(300)ã€‚
<div class="highlight" id="id-22"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"> <span class="k">class</span> <span class="nc">Derived</span> <span class="o">:</span><span class="k">public</span> <span class="n">Base</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="k">public</span><span class="o">:</span> <span class="c1">//ä¿®æ”¹æœ¬èŠ‚å†…å®¹ä¸­ä¸Šæ–¹ä»£ç çš„Derivedç±»çš„å£°æ˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="k">using</span> <span class="n">Base</span><span class="o">::</span><span class="n">mf1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="k">using</span> <span class="n">Base</span><span class="o">::</span><span class="n">mf3</span><span class="p">;</span> <span class="c1">//è¿™2ä¸ªusingä½¿å¾—Baseç±»ä½œç”¨åŸŸå†…æ‰€æœ‰mf1,mf3å‡½æ•°éƒ½å¯è§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="c1">// ... å…¶ä»–ï¼Œç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>è½¬å‘å‡½æ•°(forwarding function)
åº”ç”¨åœºæ™¯: åœ¨privateç»§æ‰¿ä¸‹ï¼Œå¼ºè°ƒçš„æ˜¯ç»§æ‰¿å®ç°è€Œéç»§æ‰¿æ¥å£ï¼Œå¦‚æœæƒ³åœ¨å­ç±»çš„æˆå‘˜ä¸­è°ƒç”¨çˆ¶ç±»å‡½æ•°ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡å‡½æ•°è½¬å‘æ¥å®ç°ã€‚</li>
</ol>
<div class="highlight" id="id-23"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Derived</span><span class="o">:</span> <span class="k">private</span> <span class="n">Base</span><span class="p">{</span> <span class="c1">//æ”¹å†™æœ¬èŠ‚ä¸Šæ–¹ä»£ç ï¼Œæ³¨æ„ï¼Œæ˜¯ç§æœ‰ç»§æ‰¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">mf1</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">Base</span><span class="o">::</span><span class="n">mf1</span><span class="p">();</span> <span class="c1">//æ‹¿åˆ°äº†çˆ¶ç±»çš„å‡½æ•°å®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// ... è¯¥å‡½æ•°å…¶ä»–éƒ¨åˆ†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">// åº”ç”¨ä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Derived</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">.</span><span class="n">mf1</span><span class="p">();</span>    <span class="c1">//è°ƒç”¨æˆåŠŸï¼ŒDerived::mf1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">d</span><span class="p">.</span><span class="n">mf1</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>  <span class="c1">//ç¼–è¯‘å¤±è´¥
</span></span></span></code></pre></td></tr></table>
</div>
</div>å½“ç„¶ï¼Œpublicç»§æ‰¿ä¹Ÿèƒ½ä½¿ç”¨è½¬å‘å‡½æ•°ï¼Œå†™å‡º<code>d.Base::mf3(300)</code>; è¿™æ ·çš„ä»£ç ã€‚ä½†æ˜¯ï¼Œä¸€æ¥publicç»§æ‰¿ç†åº”éµå¾ª&quot;is-a&quot;è§„åˆ™ï¼Œusingå£°æ˜æ‹¿åˆ°æ‰€æœ‰è¢«é®æ©çš„æ¥å£ï¼›äºŒæ¥æ˜æ˜¾ä»£ç ä¸ç¾è§‚ã€‚</li>
</ul>
<h3 id="r34-åŒºåˆ†æ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿">R34 åŒºåˆ†æ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿</h3>
<p>å½“ä¸€ä¸ªå­ç±»Derivedç»§æ‰¿äºçˆ¶ç±»Baseï¼Œé‚£ä¹ˆè¦æ—¶åˆ»æ¸…æ¥šï¼Œå¯¹äºç±»ä¸­çš„æˆå‘˜å‡½æ•°ï¼Œæ˜¯æƒ³ç»§æ‰¿çˆ¶ç±»çš„æ¥å£ï¼Œè¿˜æ˜¯æƒ³ç»§æ‰¿çˆ¶ç±»çš„å®ç°ã€‚</p>
<ul>
<li>
<p><strong>å¯¹äºPublicç»§æ‰¿ï¼Œæ¥å£æ€»æ˜¯ä¼šè¢«ç»§æ‰¿</strong>
åŸºäºâ€œ<strong>is-a</strong>â€çš„å…³ç³»ï¼Œä½œç”¨äºçˆ¶ç±»çš„ä»»ä½•äº‹æƒ…ä¹Ÿä¸€å®šè¦é€‚ç”¨äºå­ç±»ã€‚</p>
</li>
<li>
<p><strong>å£°æ˜çº¯è™šå‡½æ•°(pure-virtual)çš„ç›®çš„æ˜¯è®©å­ç±»åªç»§æ‰¿å‡½æ•°æ¥å£</strong>
å¯¹äºçº¯è™šå‡½æ•°ï¼Œå­ç±»å¿…é¡»é‡æ–°å®ç°è¯¥æ¥å£ã€‚æ³¨æ„ï¼Œ<code>çˆ¶ç±»å¯ä»¥é€‰æ‹©æ€§ç»™å‡ºçº¯è™šå‡½æ•°çš„å®ç°</code>ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸ä¼šç»™ã€‚</p>
</li>
<li>
<p><strong>éšæ‚£ï¼šä»éçº¯è™šå‡½æ•°(impure-virtual)åŒæ—¶ç»§æ‰¿æ¥å£å’Œç¼ºçœå®ç°</strong>
éçº¯è™šå‡½æ•°ï¼Œå¯ä»¥è®©å­ç±»é€‰æ‹©æ˜¯å¦é‡æ–°å®ç°è¯¥æ¥å£ã€‚é‚£ä¹ˆï¼Œå¦‚æœå­ç±»æ˜¯æœ‰å¿…è¦é‡å†™ï¼Œä½†æ˜¯<strong>å¿˜è®°å†™äº†</strong>å´é»˜é»˜ç”¨çˆ¶ç±»ç‰ˆæœ¬ï¼Œä¾¿äº‹ä¸æ„¿è¿äº†ã€‚
ä¸¾ä¾‹ï¼šçˆ¶ç±»Airplaneæœ‰å­ç±»PlaneModelAã€PlaneModelBã€PlaneModelCï¼Œå…¶ä¸­Cå‹é£æœºä¸åŒäºABå‹ï¼Œæ˜¯æ–°å¼é£æœºï¼š</p>
<div class="highlight" id="id-24"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Airport</span> <span class="p">{...};</span><span class="c1">//æœºåœºç±»ï¼Œå®ç°ç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Airplane</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">fly</span><span class="p">(</span><span class="k">const</span> <span class="n">Airport</span><span class="o">&amp;</span> <span class="n">destination</span><span class="p">);</span><span class="c1">//çˆ¶ç±»è¿˜ä¼šç»™å‡ºé»˜è®¤çš„flyå®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PlaneModelA</span><span class="o">:</span> <span class="k">public</span> <span class="n">Airplane</span><span class="p">{</span> <span class="p">...</span> <span class="p">};</span> <span class="c1">// ä¸é‡å†™flyï¼Œç»§æ‰¿çˆ¶ç±»çš„flyå®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">PlaneModelB</span><span class="o">:</span> <span class="k">public</span> <span class="n">Airplane</span><span class="p">{</span> <span class="p">...</span> <span class="p">};</span> <span class="c1">// Bå’ŒAä¸€æ ·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">PlaneModelC</span><span class="o">:</span> <span class="k">public</span> <span class="n">Airplane</span><span class="p">{</span> <span class="p">...</span> <span class="p">};</span> <span class="c1">//æ–°å‹é£æœºï¼Œæœ¬æ¥è¦é‡å†™flyï¼Œç»“æœå¿˜äº†
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆè¿™ä¸ª<code>éšæ‚£è¯¥å¦‚ä½•è§£å†³</code>å‘¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å®ç°Cå‹é£æœºç±»æ—¶åˆ«å¿˜äº†flyæ–¹æ³•ï¼Ÿ
æ ¸å¿ƒæ€æƒ³æ˜¯â€œ<strong>åˆ‡æ–­virtualå‡½æ•°æ¥å£å’Œå…¶é»˜è®¤å®ç°ä¹‹é—´çš„è¿æ¥</strong>â€ã€‚</p>
<ol>
<li>æ–¹æ³•1ï¼šè®¾ç½®flyä¸ºçº¯è™šå‡½æ•°ï¼Œå¹¶æ–°å¢ä¸€ä¸ªdefaultyFlyæ–¹æ³•
æ³¨æ„ç»†èŠ‚ï¼šdefaultFlyæ–¹æ³•è¦è®¾ç½®ä¸ºprotectedå±æ€§çš„non-virtualå‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š
<div class="highlight" id="id-25"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Airplane</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">fly</span><span class="p">(</span><span class="k">const</span> <span class="n">Airport</span><span class="o">&amp;</span> <span class="n">destination</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="c1">// çˆ¶ç±»ä¸ç»™å‡ºå®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">protected</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">defaultFly</span><span class="p">(</span><span class="k">const</span> <span class="n">Airport</span><span class="o">&amp;</span> <span class="n">destination</span><span class="p">){</span> <span class="p">...</span> <span class="p">}</span><span class="c1">//é»˜è®¤çš„flyå®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PlaneModelA</span><span class="o">:</span> <span class="k">public</span> <span class="n">Airplane</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>   <span class="c1">//çº¯è™šæ¥å£,å­ç±»å¿…é¡»ç»™å‡ºå®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">fly</span><span class="p">(</span><span class="k">const</span> <span class="n">Airport</span><span class="o">&amp;</span> <span class="n">destination</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">defaultFly</span><span class="p">(</span><span class="n">destination</span><span class="p">);</span> <span class="c1">//è°ƒç”¨çˆ¶ç±»çš„ç¼ºçœå®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span><span class="c1">//PlaneModelB å’Œ PlaneModelA ç±»ä¼¼,ç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">PlaneModelC</span><span class="o">:</span> <span class="k">public</span> <span class="n">Airplane</span><span class="p">{</span> <span class="p">...};</span><span class="c1">// é‡å†™flyæ–¹æ³•
</span></span></span></code></pre></td></tr></table>
</div>
</div>è¿™æ ·å†™è¿˜æœ‰ä¸ªå¥½å¤„ï¼šfly()å’ŒdefaultFly()äº«æœ‰ä¸åŒçš„ä¿æŠ¤çº§åˆ«ã€‚</li>
<li>æ–¹æ³•2ï¼š çˆ¶ç±»çš„é»˜è®¤å®ç°å¡åˆ°çº¯è™šæ¥å£flyä¸­
è¿™æ ·å°±ä¸éœ€è¦å®šä¹‰defaultFlyæ–¹æ³•äº†ï¼Œå› ä¸ºå­ç±»å¿…é¡»å®ç°flyæ–¹æ³•ï¼Œå¯¹äºA å‹ã€Bå‹é£æœºï¼Œå­ç±»fly()è½¬å‘ä¸€æ¬¡çˆ¶ç±»çš„fly()å³å¯ï¼ŒCç±»é£æœºå®ç°æ–°å¼çš„fly()ã€‚ç¼ºç‚¹æ˜¯è®©åŸæœ¬åœ¨defaultFlyå†…çš„å®ç°å†…å®¹æš´éœ²åœ¨å¤–äº†(æŒ‡publicå±æ€§)ã€‚
<div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>Note<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><pre><code>  ä¸ªäººè®¤ä¸ºï¼Œè¿™æ–¹æ³•2è¿˜æœ‰ä¸ªç¼ºç‚¹ï¼šå®ƒè®©è™šåŸºç±»çš„çº¯è™šæ¥å£æ‰¿è½½äº†æ¥å£å®ç°ï¼Œä¸å¤Ÿçº¯ç²¹(æ¯”å¦‚éœ€è¦è¾“å‡ºç»™åˆ°å®¢æˆ·ï¼Œåº”è¯¥åªç»§æ‰¿æ¥å£)ã€‚
</code></pre>
</div>
    </div>
  </div></li>
</ol>
</li>
<li>
<p><strong>non-virtualå‡½æ•°å…·ä½“æŒ‡å®šæ¥å£ç»§æ‰¿å’Œå¼ºåˆ¶æ€§å®ç°ç»§æ‰¿</strong>
å¦‚æœæˆå‘˜å‡½æ•°æ˜¯non-virtualï¼Œè¡¨ç¤ºå®ƒä¸æ‰“ç®—åœ¨å­ç±»ä¸­æœ‰ä¸åŒçš„è¡Œä¸ºï¼Œæˆ–è€…è¯´ï¼Œä¸å˜æ€§å‡Œé©¾äºç‰¹å¼‚æ€§ã€‚å¯¹åº”åœ°ï¼Œç»ä¸åº”è¯¥åœ¨å­ç±»ä¸­é‡å†™non-virtualå‡½æ•°ã€‚</p>
</li>
</ul>
<h3 id="r35-è€ƒè™‘virtualå‡½æ•°çš„æ›¿ä»£é€‰æ‹©">R35 è€ƒè™‘virtualå‡½æ•°çš„æ›¿ä»£é€‰æ‹©</h3>
<p>å‡è®¾è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šè®¾è®¡ä¸€æ¬¾æ¸¸æˆï¼Œä¸åŒäººç‰©ä»¥ä¸åŒæ–¹å¼è®¡ç®—ç”Ÿå‘½å€¼ï¼Œé‚£ä¹ˆ$\Longrightarrow$ è®¾è®¡ç»§æ‰¿ä½“ç³»ï¼Œå­ç±»å…±åŒç»§æ‰¿çˆ¶ç±»çš„public-virtualæ–¹æ³•healthValue()ï¼Œå­ç±»å„è‡ªé‡æ–°å®ç°healthValue()æ¥å£ã€‚</p>
<p>ğŸ˜„å¾ˆå¥½ï¼Œä¸­è§„ä¸­çŸ©ï¼Œé‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰å…¶ä»–æ–¹å¼å‘¢ï¼Ÿ</p>
<ul>
<li>
<p><strong><code>NVIæ‰‹æ³•(non-virtual interface)å®ç°Template Methodæ¨¡å¼</code></strong>
æ€è·¯å°±æ˜¯çˆ¶ç±»å®šä¹‰ä¸ªnon-virtualçš„publicæ–¹æ³•healthValue()ï¼Œè°ƒç”¨virtualçš„privateæ–¹æ³•healthValueImplã€‚å­ç±»ç›´æ¥é‡å†™healthValueImplï¼Œè¾¾åˆ°ç±»ä¼¼æ¨¡ç‰ˆæ–¹æ³•è®¾è®¡æ¨¡å¼çš„æ•ˆæœã€‚
çˆ¶ç±»<code>GameCharacter</code>è®¾è®¡å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-26"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">GameCharacter</span><span class="p">{</span><span class="c1">//æ„é€ å‡½æ•°å’Œè™šææ„å‡ç•¥å»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">healthValue</span><span class="p">()</span><span class="k">const</span><span class="p">{</span> <span class="c1">//ps:æ–¹ä¾¿å±•ç¤ºï¼Œè€Œå†™åœ¨äº†å¤´æ–‡ä»¶é‡Œï¼Œæˆäº†inline
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span> <span class="s">&#34;Do prepare works...</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span><span class="c1">//äº‹å‰ï¼Œå¦‚åŠ é”,å†™log,éªŒè¯æ¡ä»¶ç­‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">retVal</span> <span class="o">=</span> <span class="n">healthValueImpl</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span> <span class="s">&#34;</span><span class="se">\n</span><span class="s">Do post works...</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span><span class="c1">//äº‹å,å¦‚è§£é”,æ›´æ–°æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">retVal</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="n">healthValueImpl</span><span class="p">()</span> <span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">val</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;default caculate process... GetValue:&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">val</span><span class="p">;</span><span class="c1">//éšåè¿›è¡Œè®¡ç®—ï¼Œè¿‡ç¨‹ç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å­ç±»<code>GoodGuy</code>å’Œ<code>BadGuy</code>è®¾è®¡å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-27"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">GoodGuy</span><span class="o">:</span><span class="k">public</span> <span class="n">GameCharacter</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="n">healthValueImpl</span><span class="p">()</span> <span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;goodGuy caculate ... GetValue: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; &#34;</span><span class="p">;</span><span class="c1">//è¿‡ç¨‹ç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BadGuy</span><span class="o">:</span><span class="k">public</span> <span class="n">GameCharacter</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">int</span> <span class="n">healthValueImpl</span><span class="p">()</span> <span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;badGuy caculate ... GetValue: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; &#34;</span><span class="p">;</span><span class="c1">//è¿‡ç¨‹ç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åº”ç”¨ç«¯ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-28"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">GameCharacter</span><span class="o">&gt;</span> <span class="n">pGood</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">GoodGuy</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">pGood</span><span class="o">-&gt;</span><span class="n">healthValue</span><span class="p">();</span> <span class="c1">//å¾—åˆ°60
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">GameCharacter</span><span class="o">&gt;</span> <span class="n">pBad</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">BadGuy</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">pBad</span><span class="o">-&gt;</span><span class="n">healthValue</span><span class="p">();</span><span class="c1">//å¾—åˆ°80
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong><code>ç”¨å‡½æ•°æŒ‡é’ˆå®ç°Strategyæ¨¡å¼</code></strong>
ä¸»ä½“æ€æƒ³æ˜¯æ·»åŠ ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆä¸ºprivateæˆå‘˜å˜é‡pFuncï¼Œè¿™ä¸ªå‡½æ•°é€šè¿‡å¤–éƒ¨ä¼ å…¥ï¼Œä»è€Œå®ç°ä¸åŒçš„è¡Œä¸ºã€‚</p>
<div class="highlight" id="id-29"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">GameCharacter</span><span class="p">;</span><span class="c1">//forward declaration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">defaultHealthCalc</span><span class="p">(</span><span class="k">const</span> <span class="n">GameCharacter</span><span class="o">&amp;</span> <span class="n">gc</span><span class="p">);</span><span class="c1">//é»˜è®¤ç®—æ³•å®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">GameCharacter</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">typedef</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">HealthCalcFunc</span><span class="p">)(</span><span class="k">const</span> <span class="n">GameCharacter</span><span class="o">&amp;</span> <span class="n">gc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">explicit</span> <span class="nf">GameCharacter</span><span class="p">(</span><span class="n">HealthCalcFunc</span> <span class="n">hcf</span> <span class="o">=</span> <span class="n">defaultHealthCalc</span><span class="p">)</span><span class="o">:</span><span class="n">calcFunc_</span><span class="p">(</span><span class="n">hcf</span><span class="p">){}</span><span class="c1">//ä¼ å…¥å‡½æ•°æŒ‡é’ˆ,è‡ªå®šä¹‰å®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="nf">healthValue</span><span class="p">()</span><span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">calcFunc_</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">HealthCalcFunc</span> <span class="n">calcFunc_</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªè®¾è®¡æœ‰2ä¸ªæœ‰è¶£çš„<strong>è®¾è®¡å¼¹æ€§</strong>ï¼š</p>
<ol>
<li>å³ä½¿åŒä¸€ä¸ªäººç‰©ç±»å‹çš„ä¸åŒå®ä½“ï¼Œå…è®¸æ‹¥æœ‰ä¸åŒçš„ç”Ÿå‘½å€¼è®¡ç®—æ–¹æ³•ï¼›</li>
<li>æŸä¸ªäººç‰©å¯¹è±¡çš„ç”Ÿå‘½å€¼è®¡ç®—æ–¹æ³•ï¼Œåœ¨å…¶ç”Ÿå‘½æœŸå†…å¯ä»¥ä»»æ„ä¿®æ”¹ï¼Œåªè¦æ·»åŠ ä¸€ä¸ªsetæ–¹æ³•å³å¯ï¼›</li>
</ol>
</li>
<li>
<p><strong><code>ç”¨std::functionå®ç°Strategyæ¨¡å¼</code></strong>
privateæˆå‘˜å˜é‡ç”±ä¸Šæ–‡çš„å‡½æ•°æŒ‡é’ˆæ›¿æ¢æˆstd::functionå¯¹è±¡ï¼Œç›¸å½“äºæ˜¯<code>æŒ‡å‘å‡½æ•°çš„æ³›åŒ–æŒ‡é’ˆ</code>ã€‚å°±<code>æ›´å…·è®¾è®¡å¼¹æ€§</code>äº†ã€‚std::functionå¯ä»¥ä¼ å…¥å‡½æ•°æŒ‡é’ˆã€ä»¿å‡½æ•°ã€std::bindå‡½æ•°å¯¹è±¡ã€‚GameCharacterçš„ç±»å®ç°ä¿®æ”¹ä¸ºï¼š</p>
<div class="highlight" id="id-30"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">GameCharacter</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">int</span> <span class="p">(</span><span class="k">const</span> <span class="n">GameCharacter</span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span>  <span class="n">healthCalcFunc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">explicit</span> <span class="nf">GameCharacter</span><span class="p">(</span><span class="n">healthCalcFunc</span> <span class="n">hcf</span> <span class="o">=</span> <span class="n">defaultHealthCalc</span><span class="p">)</span><span class="o">:</span><span class="n">healthValueImpl_</span><span class="p">(</span><span class="n">hcf</span><span class="p">){}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="nf">healthValue</span><span class="p">()</span><span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span> <span class="s">&#34;Do prepare works...</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">retVal</span> <span class="o">=</span> <span class="n">healthValueImpl_</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span> <span class="c1">// è¿™é‡Œæ”¹äº†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span> <span class="s">&#34;</span><span class="se">\n</span><span class="s">Do post works...</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">retVal</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">healthCalcFunc</span> <span class="n">healthValueImpl_</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>ä¼ å…¥å‡½æ•°æŒ‡é’ˆ</li>
</ol>
<div class="highlight" id="id-31"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"> <span class="n">gameChashort</span> <span class="nf">quickHurtHealthCalc</span><span class="p">(</span><span class="k">const</span> <span class="n">GameCharacter2</span><span class="o">&amp;</span> <span class="n">gc</span><span class="p">);</span><span class="c1">//è¿”å›å€¼ä¸æ˜¯int,å¯éšå¼è½¬æ¢;å®ç°ç•¥å»
</span></span></span><span class="line"><span class="cl"><span class="c1">//åº”ç”¨ç«¯ä»£ç å¦‚ä¸‹ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">GameCharacter</span> <span class="nf">quickGuy</span><span class="p">(</span><span class="n">quickHurtHealthCalc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">quickGuy</span><span class="p">.</span><span class="n">healthValue</span><span class="p">();</span><span class="c1">//å†…éƒ¨è°ƒç”¨quickHurtHealthCalc
</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>ä¼ å…¥ä»¿å‡½æ•°
ä»¿å‡½æ•°ï¼šå³å‡½æ•°å¯¹è±¡ï¼Œè€Œä¸”é‡è½½äº†operator() ã€‚</li>
</ol>
<div class="highlight" id="id-32"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">HealthCalculator</span><span class="p">{</span><span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="nf">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">GameCharacter2</span><span class="o">&amp;</span> <span class="n">gc</span><span class="p">)</span> <span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">180</span><span class="p">;</span><span class="c1">//çœç•¥å®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">//åº”ç”¨ç«¯ä»£ç å¦‚ä¸‹ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">GameCharacter</span> <span class="nf">functorGuy</span><span class="p">(</span> <span class="p">(</span><span class="n">HealthCalculator</span><span class="p">())</span> <span class="p">);</span><span class="c1">//ç”¨æ‹¬å·å°†ä»¿å‡½æ•°æ‹¬èµ·æ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">functorGuy</span><span class="p">.</span><span class="n">healthValue</span><span class="p">();</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>ä¼ å…¥<code>std::bind</code>å‡½æ•°å¯¹è±¡
std::bindæ˜¯å‡½æ•°å¯¹è±¡æ¨¡æ¿ï¼Œæ¥æ”¶ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆfå’Œè‹¥å¹²å‡½æ•°å…¥å‚å¾—åˆ°fObjï¼Œè°ƒç”¨fObjç­‰åŒäºè°ƒç”¨å¸¦å‚æ•°çš„fã€‚æœ¬ä¾‹ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<div class="highlight" id="id-33"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">GameLevel</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span> <span class="c1">//ç”¨ç±»å†…å‡½æ•°ä½œä¸ºå‡½æ•°æŒ‡é’ˆf
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">float</span> <span class="n">health</span><span class="p">(</span><span class="k">const</span> <span class="n">GameCharacter</span><span class="o">&amp;</span> <span class="n">gc</span><span class="p">)</span> <span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">-</span><span class="mf">20.3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">//åº”ç”¨ç«¯ä»£ç å¦‚ä¸‹ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">GameLevel</span>  <span class="n">curLevel</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">GameCharacter</span> <span class="nf">levelGuy</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">GameLevel</span><span class="o">::</span><span class="n">health</span><span class="p">,</span> <span class="n">curLevel</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">placeholders</span><span class="o">::</span><span class="n">_1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="n">levelGuy</span><span class="p">.</span><span class="n">healthValue</span><span class="p">();</span><span class="c1">//å†…éƒ¨è°ƒç”¨ç­‰ä»·äºcurLevel.health(leveGuy);
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><pre><code>å…¶å®è¿™é‡Œä¼ å…¥C++11æ–°å¢çš„Lambdaè¡¨è¾¾å¼ä½œä¸ºstd::functionä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè€Œä¸”æ›´æ–¹ä¾¿ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š
```c++
GameCharacter  lamGuy([&amp;](const GameCharacter&amp; gc){
 std::cout&lt;&lt; &quot;value is &quot; &lt;&lt; 75 &lt;&lt; std::endl;//å…·ä½“è®¡ç®—ç•¥
   return 75;
   });
lamGuy.healthValue();
```
å…³äºStrategyè®¾è®¡æ¨¡å¼æ›´å¤šå‚è€ƒï¼š
  - [Strategyè®¾è®¡æ¨¡å¼-åŸç†è®²è§£](https://refactoringguru.cn/design-patterns/strategy)
  - [Strategyè®¾è®¡æ¨¡å¼-C++ä»£ç å‚è€ƒ](https://refactoringguru.cn/design-patterns/strategy/cpp/example)
</code></pre>
</div>
    </div>
  </div>
</li>
</ul>
<h3 id="r36-ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„non-virtualå‡½æ•°">R36 ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„non-virtualå‡½æ•°</h3>
<ul>
<li>
<p>ç”±äºåç§°é®æ©ï¼Œä¸è¦é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„non-virtualå‡½æ•°
çœ‹ä¸ªåä¾‹ï¼š</p>
<div class="highlight" id="id-34"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">B</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">mf</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;B::mf()&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">D</span><span class="o">:</span> <span class="k">public</span> <span class="n">B</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">mf</span><span class="p">(){</span><span class="c1">//é‡æ–°å®šä¹‰mf()ï¼Œè¿åäº†Rule33
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;D::mf()&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆçœ‹è¿™æ ·çš„åº”ç”¨ä»£ç ï¼š</p>
<div class="highlight" id="id-35"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">D</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">D</span><span class="o">*</span> <span class="n">pD</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">B</span><span class="o">*</span> <span class="n">pB</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="p">.</span><span class="n">mf</span><span class="p">();</span>    <span class="c1">// è¾“å‡º D::mf()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">pD</span> <span class="o">-&gt;</span> <span class="n">mf</span><span class="p">();</span><span class="c1">// è¾“å‡º D::mf()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">pB</span> <span class="o">-&gt;</span> <span class="n">mf</span><span class="p">();</span><span class="c1">// è¾“å‡º B::mf()
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™å°±å¾ˆè¯¡å¼‚äº†ï¼éƒ½é€šè¿‡å¯¹è±¡dè°ƒç”¨æˆå‘˜å‡½æ•°mfï¼Œè°ƒç”¨ç»“æœåº”è¯¥ç›¸åŒã€‚</p>
<p>å¦å¤–ä¸€ç‚¹ï¼Œå‡ºäºpublicç»§æ‰¿çš„â€œ<strong>is-a</strong>â€ç‰¹æ€§ï¼Œè¿™æ ·é‡æ–°å®šä¹‰non-virtualå‡½æ•°ä¹Ÿæ˜¯<strong>å¯¹&quot;is-a&quot;çš„ä¸¥é‡è¿èƒŒ</strong>ã€‚</p>
</li>
</ul>
<h3 id="r37-ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„ç¼ºçœå…¥å‚å€¼">R37 ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„ç¼ºçœå…¥å‚å€¼</h3>
<p>è¿™é‡Œè¯´çš„ç¼ºçœå…¥å‚ï¼ŒæŒ‡çš„æ˜¯å‡½æ•°å…¥å‚çš„é»˜è®¤å€¼ï¼Œåœ¨é‡å†™å¸¦æœ‰ç¼ºçœå…¥å‚çš„virtualå‡½æ•°æ—¶ï¼Œä¸è¦ä¿®æ”¹é‚£ä¸ªé»˜è®¤å‚æ•°çš„é»˜è®¤å€¼ã€‚</p>
<p>åŸå› ï¼švirtualå‡½æ•°ä¸º<code>åŠ¨æ€ç»‘å®š</code>ç‰¹æ€§ï¼Œè€Œç¼ºçœå‚æ•°å€¼æ˜¯<code>é™æ€ç»‘å®š</code>ç‰¹æ€§ã€‚ä¿®æ”¹åä¼šé€ æˆä¸€äº›ä»¤äººè´¹è§£çš„ç°è±¡ã€‚</p>
<p>è¯·çœ‹ä¸‹æ–¹åé¢æ•™æï¼š</p>
<div class="highlight" id="id-36"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">enum</span> <span class="k">class</span> <span class="nc">Color</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">RED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">GREEN</span> <span class="p">,</span><span class="n">BLUE</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Shape</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>  <span class="c1">// ï¼šçˆ¶ç±»é»˜è®¤å…¥å‚æ˜¯RED
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">draw</span><span class="p">(</span><span class="n">Color</span> <span class="n">col</span> <span class="o">=</span> <span class="n">Color</span><span class="o">::</span><span class="n">RED</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Shape:col is &#34;</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Rectangle</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Shape</span><span class="p">{</span> <span class="c1">// ï¼šå­ç±»ç±»ä¿®æ”¹é»˜è®¤å…¥å‚ä¸ºGREEN
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">draw</span><span class="p">(</span><span class="n">Color</span> <span class="n">col</span> <span class="o">=</span> <span class="n">Color</span><span class="o">::</span><span class="n">GREEN</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Rectangle:col is &#34;</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆå½“å‡ºç°å…¸å‹åº”ç”¨åœºæ™¯<code>Base* pB=new Derived</code>æ—¶ï¼Œå°±ä¼šé€ æˆâ€œçˆ¶ç±»å­ç±»å„å‡ºä¸€åŠåŠ›â€çš„æƒ…å½¢ï¼š</p>
<div class="highlight" id="id-37"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">Shape</span> <span class="o">*</span><span class="n">pRec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">pRec</span><span class="o">-&gt;</span><span class="n">draw</span><span class="p">();</span> <span class="c1">// è¾“å‡ºï¼šRectangle:col is 0  ï¼ˆ0æ˜¯REDï¼‰
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœç¡®å®è°ƒç”¨å­ç±»drawï¼Œä½†æ˜¯é»˜è®¤å…¥å‚å–çš„æ˜¯åŸºç±»çš„ REDï¼Œè€Œéå­ç±»çš„GREENã€‚
é‚£æ€ä¹ˆä¿®æ”¹åˆé€‚å‘¢ï¼Œéƒ½å¸¦é»˜è®¤å‚æ•°ï¼Œä¸”å­ç±»çˆ¶ç±»ç›¸åŒï¼Ÿå¸¦æ¥ä¸€ä¸ª<strong>è€¦åˆé—®é¢˜</strong>ï¼Œå¦‚æœçˆ¶ç±»æ”¹äº†ï¼Œæ‰€æœ‰å­ç±»éƒ½å¾—æ”¹ã€‚
æ­£å¦‚Rule35æåˆ°çš„NVI(non-virtual interface)æ‰‹æ³•ï¼Œæ­¤å¤„ä¾¿æ˜¯ç»ä½³çš„åº”ç”¨åœºæ™¯$\Longrightarrow$ drawæ–¹æ³•æ”¹ä¸ºé»˜è®¤å‚æ•°çš„non-virtualï¼ŒæŠŠvirtualå‡½æ•°æ”¾åˆ°privateé‡Œå»ï¼Œä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-38"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Shape</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>   <span class="c1">//å­ç±»ç»§æ‰¿è¯¥é»˜è®¤å…¥å‚çš„non-virtualæ¥å£ï¼Œåˆ«é‡å†™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">void</span> <span class="n">draw</span><span class="p">(</span><span class="n">Color</span> <span class="n">col</span> <span class="o">=</span> <span class="n">Color</span><span class="o">::</span><span class="n">RED</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">drawImpl</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span> <span class="c1">//çº¯è™šå‡½æ•°æ˜¯å¼ºåˆ¶å­ç±»é‡å†™ï¼Œçœ‹å…·ä½“æƒ…å†µï¼Œimpure-virtualä¹Ÿè¡Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">drawImpl</span><span class="p">(</span><span class="n">Color</span> <span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="c1">//å­ç±»é‡å†™è¿™ä¸ªdrawImpl
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="r38-é€šè¿‡å¤åˆå¡‘é€ å‡ºhas-aæˆ–æ ¹æ®æŸç‰©å®ç°å‡º">R38 é€šè¿‡å¤åˆå¡‘é€ å‡ºhas-aæˆ–&quot;æ ¹æ®æŸç‰©å®ç°å‡ºâ€</h3>
<p>åŸä¹¦æ ‡é¢˜ï¼š<code>Model â€œhas-aâ€ or â€œis-implemented-in-terms-ofâ€ through composition</code>ï¼ŒåŒRule32ï¼Œä¾¯æ·è€å¸ˆç¿»è¯‘ä¸ºâ€œå¡‘æ¨¡â€ã€‚</p>
<p>å¤åˆå…³ç³»ï¼ˆcompositionï¼‰æ˜¯ä¸€ç§å¸¸è§çš„ç±»å…³ç³»ï¼Œå½“æŸç§ç±»å‹çš„å¯¹è±¡å†…å«æœ‰å®ƒç§ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œä¾¿æ˜¯æ­¤ç§å…³ç³»ã€‚</p>
<p>å¤åˆå…³ç³»åˆ†ä¸º2ç§ï¼š<code>&quot;has-a&quot;</code> å’Œ <code>â€œis-implemented-in-terms-of&quot;</code>ã€‚</p>
<ul>
<li>â€œ<code>has-a</code>â€å…³ç³»ï¼š
æŒ‡çš„æ˜¯<strong>åº”ç”¨åŸŸ</strong>éƒ¨åˆ†ï¼Œä¸å‚ä¸å†…çš„å…·ä½“å„é¡¹å®ç°ã€‚æ˜¯ä¸€ç§å•çº¯çš„å®Œå¤‡å¯¹è±¡çš„åŒ…å«å…³ç³»ï¼Œæ¯”å¦‚Personç±»æœ‰Addressã€PhoneNumberã€Jobç­‰ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œåˆæˆ–æ˜¯Imageç±»æœ‰Bufferã€Mutexxã€SearchTreeç­‰ç±»å‹çš„æˆå‘˜ã€‚</li>
<li>â€œ<code>is-implemented-in-terms-of</code>â€œå…³ç³»ï¼š
æŒ‡çš„æ˜¯<strong>å®ç°åŸŸ</strong>éƒ¨åˆ†ï¼Œå‚ä¸ç±»çš„å„ç±»å®ç°ï¼Œæ¯”å¦‚æ•°æ®ç»“æ„çš„è®¾è®¡ä¸­ï¼Œæƒ³ç”¨ç°æœ‰çš„ std::listæ¥å®ç°Setç±»ï¼Œè¿™æ ·å¯èƒ½æ•ˆç‡ä¸é«˜(é€šå¸¸æ›´å…·æ•ˆç‡çš„å®ç°æ˜¯é‡‡ç”¨å¹³è¡¡æŸ¥æ‰¾æ ‘ )ï¼Œä½†æ˜¯å¯è¡Œã€‚
ğŸ“Œï¼šæ­¤å¤„ä¸èƒ½è®©Setä»¥publicç»§æ‰¿äºstd::listï¼Œå› ä¸ºlistå…è®¸é‡å¤å…ƒç´ ï¼Œè€ŒSetä¸è¡Œï¼Œä¸æ»¡è¶³â€œis-aâ€å…³ç³»ã€‚
æ­£ç¡®å®ç°éƒ¨åˆ†ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š
<div class="highlight" id="id-39"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Set</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="kt">bool</span> <span class="n">contains</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">item</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">find</span><span class="p">(</span><span class="n">rep_</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">rep_</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="n">item</span><span class="p">)</span> <span class="o">!=</span> <span class="n">rep_</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">insert</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">item</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">contains</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="n">rep_</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">remove</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">item</span><span class="p">);</span><span class="c1">// å®ç°ç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">size</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>  <span class="c1">// å®ç°ç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">rep_</span><span class="p">;</span> <span class="c1">//ç”¨æ¥è¡¨è¿°Setçš„æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="r39-æ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨privateç»§æ‰¿">R39 æ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨privateç»§æ‰¿</h3>
<p>â€œæ˜æ™ºè€Œå®¡æ…â€çš„æ„æ€æ˜¯ğŸ‘‰å½“è€ƒè™‘äº†å…¶ä»–æ–¹æ¡ˆå¯¹æ¯”åï¼Œä»ç„¶è§‰å¾—privateç»§æ‰¿æ˜¯æœ€åˆé€‚çš„ï¼Œæ‰ä½¿ç”¨å®ƒã€‚</p>
<p>é¦–å…ˆæ˜ç¡®privateç»§æ‰¿çš„2ä¸ªç‰¹æ€§ï¼š</p>
<ol>
<li>ç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨å°†ä¸€ä¸ªderived-classå¯¹è±¡éšå¼è½¬æ¢ä¸ºbase-classå¯¹è±¡(å‡½æ•°å…¥å‚æ—¶)ï¼›</li>
<li>ç»§æ‰¿è€Œæ¥çš„æˆå‘˜ï¼Œåœ¨derived-classä¸­éƒ½ä¼šå˜æˆprivateå±æ€§ï¼›</li>
</ol>
<p>privateç»§æ‰¿çš„æ„ä¹‰ï¼šæ„å‘³ç€<strong>implemented-in-terms-of</strong>ï¼Œåœ¨ç±»å…³ç³»è®¾è®¡ä¸Šæ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼Œåªçœ‹é‡è½¯ä»¶å®ç°ã€‚</p>
<p>è€ƒè™‘ä»¥ä¸‹ä½¿ç”¨privateçš„2ä¸ªåº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>
<p><strong>derived-classæƒ³ç»§æ‰¿base-classçš„æŸpublicæ¥å£å®ç°ï¼Œä½†åˆæƒ³éšè—æ­¤æ¥å£</strong>
è€ƒè™‘å¦‚ä¸‹åº”ç”¨åœºæ™¯ï¼šå¯¹äºä¸€ä¸ªå·²çŸ¥çš„ç±»Widgetï¼Œæƒ³ç”¨å¦ä¸€ä¸ªå·²çŸ¥çš„è®¡æ—¶ç±»Timerè¾…åŠ©æ€§èƒ½åˆ†æï¼Œåœ¨å°½é‡å°æ”¹åŠ¨å·²æœ‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•å¯ç”¨Timerï¼Ÿ
privateç»§æ‰¿åšæ³•ï¼šè®©Widgetç±»privateç»§æ‰¿äºTimerï¼Œé‡å†™çˆ¶ç±»Timerçš„onTickå‡½æ•°ã€‚
å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-40"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Timer</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">explicit</span> <span class="n">Timer</span><span class="p">(</span><span class="kt">int</span> <span class="n">tickFrequency</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">onTick</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span><span class="c1">//å®šæ—¶å™¨æ»´ç­”ä¸€æ¬¡ï¼Œè‡ªåŠ¨è¢«è°ƒç”¨ä¸€æ¬¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Widget</span><span class="o">:</span><span class="k">private</span> <span class="n">Timer</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span> <span class="c1">// privateç»§æ‰¿è€Œæ¥çš„æ‰€æœ‰æˆå‘˜éƒ½æ˜¯privateå±æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">onTick</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span><span class="c1">//æŸ¥çœ‹å¹¶è®°å½•Widgetæ•°æ®ï¼Œèµ„æºç­‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¯¥é—®é¢˜é™¤äº†ä¸Šæ–¹çš„privateç»§æ‰¿ï¼Œèƒ½ä¸èƒ½ç”¨å…¶ä»–æ–¹æ¡ˆæ›¿ä»£privateç»§æ‰¿å‘¢ï¼Ÿ
ğŸ‘‰ğŸ‘‰â€œpublicç»§æ‰¿+å¤åˆâ€æ›¿ä»£privateç»§æ‰¿ï¼šåœ¨Widgetå†…éƒ¨åµŒå¥—å®šä¹‰privateå±æ€§çš„æ–°ç±»WidgetTimer:private Timerï¼Œå³å¯åŒæ ·å¯ç”¨Timerä¸”éšè—äº†Timerã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-41"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Widget</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">WidgetTimer</span><span class="o">:</span><span class="k">public</span> <span class="n">Timer</span><span class="p">{</span><span class="c1">// ç±»å†…åµŒå¥—å®šä¹‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">virtual</span> <span class="kt">void</span> <span class="n">onTick</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="n">WidgetTimer</span> <span class="n">wTimer_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>â­â­ WidgetTimerä¹Ÿå¯ä»¥ä¸å®šä¹‰åœ¨Widgetç±»å†…,ç±»å†…åªæ”¾WidgetTimer* å’ŒWidgetTimerçš„å‰ç½®å£°æ˜ï¼Œå®Œå…¨è§£è€¦åˆï¼Œ<strong>é™ä½ç¼–è¯‘ä¾èµ–æ€§</strong>ã€‚è€Œè¿™æ ·çš„è®¾è®¡è‡ªç”±åº¦æ˜¯å•çº¯çš„privateç»§æ‰¿ä¸å…·å¤‡çš„ã€‚</p>
</li>
<li>
<p><strong>ç©ºç™½åŸºç±»æœ€ä¼˜åŒ–(EBO,empty base optimization)</strong>
âš¡å€¼å¾—ä¸€æï¼šç©ºç±»(Empty Class)æ˜¯æŒ‡ä¸å«non-staticæ•°æ®æˆå‘˜å’Œvirtual-funcçš„ç±»ã€‚
ç©ºç±»çš„sizeä¼šè¢«C++å¼ºåˆ¶è¦æ±‚è‡³å°‘ä¸º1ï¼Œé€šå¸¸æ˜¯ç”¨1ä¸ªcharå ä½ã€‚å¦‚æœè®©Empty-Classä½œä¸ºæ•°æ®æˆå‘˜ï¼Œå› ä¸ºå†…å­˜å¯¹é½è€Œå¯¼è‡´Derived-Classæµªè´¹å†…å­˜ã€‚
ç¤ºä¾‹ä»£ç  ğŸ‘‡ï¼š</p>
<div class="highlight" id="id-42"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Empty</span> <span class="p">{</span> <span class="c1">// ç©ºç±»ï¼Œ1å­—èŠ‚. ä¸å«non-staticæ•°æ®ï¼Œä¸å«virtual
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">void</span> <span class="nf">privteFoo</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;private non-virtual.&#34;</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">typedef</span> <span class="kt">char</span><span class="o">*</span>  <span class="n">pChar</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">typedef</span> <span class="nf">void</span><span class="p">(</span><span class="o">*</span><span class="n">pFuncReadData</span><span class="p">)(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">enum</span> <span class="k">class</span> <span class="nc">clolr</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">red</span><span class="p">,</span><span class="n">green</span><span class="p">,</span><span class="n">blue</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;public non-virtual!&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="p">;</span><span class="c1">//static æ•°æ®ä¹Ÿä¸å±äºclasså®ä½“
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HoldsIntsAndEmpty</span> <span class="p">{</span> <span class="c1">//å†…å­˜å¯¹é½å12å­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">x_</span><span class="p">;</span>   <span class="c1">// 4å­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Empty</span> <span class="n">e_</span><span class="p">;</span> <span class="c1">// 1å­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">y_</span><span class="p">;</span>   <span class="c1">// 4å­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HoldsInts</span><span class="o">:</span><span class="k">private</span> <span class="n">Empty</span> <span class="p">{</span><span class="c1">//ä½¿ç”¨EBO,ç±»å¤§å°8å­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">x_</span><span class="p">;</span><span class="c1">//4å­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">y_</span><span class="p">;</span><span class="c1">//4å­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>EBOä¼˜åŒ–å¯ä»¥å‡å°‘Derived-Classçš„å†…å­˜å¤§å°ï¼Œæ³¨æ„EBOåªé€‚ç”¨äºå•ç»§æ‰¿ã€‚</p>
</li>
</ul>
<h3 id="r40-æ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨å¤šé‡ç»§æ‰¿">R40 æ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨å¤šé‡ç»§æ‰¿</h3>
<p>å¤šé‡ç»§æ‰¿(multiple inheritance)æ˜¯æŒ‡ç»§æ‰¿ä¸€ä¸ªä»¥ä¸Šçš„çˆ¶ç±»ã€‚ä½†æ˜¯è¿™äº›çˆ¶ç±»åº”è¯¥é¿å…æ‹¥æœ‰å…±åŒçš„ç¥–çˆ¶ç±»ï¼Œä¼šå½¢æˆæ¯”è¾ƒéº»çƒ¦çš„â€œè±å½¢ç»§æ‰¿â€(æˆ–è€…å«é’»çŸ³ç»§æ‰¿)ã€‚</p>
<ul>
<li>
<p><strong>å¤šé‡ç»§æ‰¿çš„æˆæœ¬ä»¥åŠå‰¯ä½œç”¨</strong>
ä¸Šé¢è¯´â€œè±å½¢ç»§æ‰¿â€æ¯”è¾ƒéº»çƒ¦ï¼Œä¸»è¦åŸå› æ˜¯å¦‚æœç¥–çˆ¶ç±»å¦‚æœæ‹¥æœ‰æŸä¸ªæˆå‘˜å˜é‡xï¼Œé‚£ä¹ˆ2ä¸ªçˆ¶ç±»åˆ†åˆ«publicå½¢å¼ç»§æ‰¿äº†xï¼Œåˆ°äº†ç›®æ ‡å­ç±»å°±æœ‰äº†2ä»½xã€‚
è§£å†³é—®é¢˜çš„åŠæ³•æ˜¯<strong>è™šç»§æ‰¿</strong>(virtual inheritance)ï¼Œå¦‚æ­¤ï¼Œä¸Šè¿°å­ç±»åªæœ‰ä¸€ä»½xã€‚ä¸ºä¿è¯è™šç»§æ‰¿çš„æ­£ç¡®æ€§ï¼Œç¼–è¯‘å™¨åœ¨èƒŒåéœ€è¦ä»˜å‡ºæ›´å¤šä»£ä»·ï¼Œå¯èƒ½é€ æˆå­ç±»å†…å­˜æ›´å¤§æˆ–è¿è¡Œé€Ÿåº¦æ›´æ…¢ã€‚
ğŸ‘‰å¦‚æœå­˜åœ¨è±å½¢ç»§æ‰¿ï¼Œé‚£ä¹ˆç¥–çˆ¶ç±»å°½é‡ä¸è¦æŒæœ‰æ•°æ®æˆå‘˜ã€‚
è™šç»§æ‰¿ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-43"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">File</span><span class="p">{...};</span>  <span class="c1">//ç¥–çˆ¶ç±»æœ€å¥½ä¸è¦æŒæœ‰non-staticæ•°æ®æˆå‘˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">InputFile</span><span class="o">:</span> <span class="k">virtual</span> <span class="k">public</span> <span class="n">File</span><span class="p">{...};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">OutputFile</span><span class="o">:</span> <span class="k">virtual</span> <span class="k">public</span> <span class="n">File</span><span class="p">{...};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">IOFile</span><span class="o">:</span><span class="k">public</span> <span class="n">InputFile</span><span class="p">,</span><span class="k">public</span> <span class="n">OutputFile</span><span class="p">{...};</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>åº”ç”¨åœºæ™¯ï¼špublicç»§æ‰¿æ¥å£+privateç»§æ‰¿å®ç°</strong>
æ€è€ƒè¿™æ ·çš„åº”ç”¨åœºæ™¯ï¼ŒPersonBaseç±»æ˜¯è™šåŸºç±»ï¼ŒRealPersonæ˜¯ç›®æ ‡å­ç±»ï¼ˆéœ€è¦ç»§æ‰¿æ¥å£ï¼‰ï¼Œä½†æ˜¯è·å–nameå’ŒbirthDateä¿¡æ¯çš„å‡½æ•°åœ¨å¦ä¸€ä¸ªPersonInfoç±»éƒ½æœ‰äº†ç°æˆçš„å®ç°ï¼ˆåªéœ€è¦ç®€å•ä¿®æ”¹è¯¥å®ç°ï¼‰ã€‚</p>
<p>ä¸¤è€…ç»“åˆåï¼Œå³è®©RealPersonç±»publicç»§æ‰¿äºPersonBaseï¼Œprivateç»§æ‰¿äºPersonInfoã€‚</p>
<div class="highlight" id="id-44"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PersonBase</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="o">~</span><span class="n">PersonBase</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">birthDate</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PersonInfo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span>  <span class="o">~</span><span class="n">PersonInfo</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="k">explicit</span> <span class="nf">PersonInfo</span><span class="p">(</span><span class="kt">int</span> <span class="n">pID</span><span class="p">)</span><span class="o">:</span><span class="n">id_</span><span class="p">(</span><span class="n">pID</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">theName</span><span class="p">()</span> <span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">static</span> <span class="kt">char</span> <span class="n">value</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">static</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">exampleName</span> <span class="o">=</span> <span class="s">&#34;Luka&#34;</span><span class="p">;</span><span class="c1">// è®¡ç®—è¿‡ç¨‹ç•¥,ç”¨å›ºå®šå­—ç¬¦ä¸²æ›¿ä»£
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">std</span><span class="o">::</span><span class="n">strcpy</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">valueDelimLeft</span><span class="p">());</span>   <span class="c1">// è·å–å·¦ç•Œå®šç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">std</span><span class="o">::</span><span class="n">strcat</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">exampleName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">strcat</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">valueDelimRight</span><span class="p">());</span><span class="c1">// è·å–å³ç•Œå®šç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">theBirthDate</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="s">&#34;1990-1-1&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">valueDelimLeft</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="s">&#34;[&#34;</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">valueDelimRight</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="s">&#34;]&#34;</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">id_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¤šé‡ç»§æ‰¿çš„ä»£ç ä¸ºğŸ‘‡:</p>
<div class="highlight" id="id-45"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">RealPerson</span> <span class="o">:</span> <span class="k">public</span> <span class="n">PersonBase</span><span class="p">,</span> <span class="k">private</span> <span class="n">PersonInfo</span> <span class="p">{</span><span class="c1">//å¤šé‡ç»§æ‰¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">explicit</span> <span class="n">RealPerson</span><span class="p">(</span><span class="kt">int</span> <span class="n">pID</span><span class="p">)</span> <span class="o">:</span><span class="n">PersonInfo</span><span class="p">(</span><span class="n">pID</span><span class="p">)</span> <span class="p">{}</span> <span class="c1">// å§”æ‰˜æ„é€ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">virtual</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">()</span> <span class="k">const</span><span class="p">{</span> <span class="c1">//å®ç°å¿…è¦çš„è™šåŸºç±»Personçš„pure-virtualæˆå‘˜å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">PersonInfo</span><span class="o">::</span><span class="n">theName</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">birthDate</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">PersonInfo</span><span class="o">::</span><span class="n">theBirthDate</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">valueDelimLeft</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="s">&#34;&#34;</span><span class="p">;</span> <span class="p">};</span><span class="c1">//é‡å†™ç•Œå®šç¬¦å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">virtual</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">valueDelimRight</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="s">&#34;&#34;</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€ååº”ç”¨ç«¯ä»£ç ï¼š</p>
<div class="highlight" id="id-46"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">RealPerson</span> <span class="nf">rPerson</span><span class="p">(</span><span class="mi">613</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">rPerson</span><span class="p">.</span><span class="n">name</span><span class="p">();</span> <span class="c1">//è¾“å‡ºLuka ,è€Œä¸æ˜¯[Luka]
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œå¤šé‡ç»§æ‰¿ä½“ç³»å®Œç¾è§£å†³è¯¥é—®é¢˜ã€‚</p>
</li>
</ul>
<p>å›åˆ°æœ¬èŠ‚å¼€å¤´ï¼Œæ˜æ™ºå’Œå®¡æ…çš„æ„æ€æ˜¯ğŸ‘‰å³ä½¿å¤šé‡ç»§æ‰¿å¯ä»¥ç”¨å•ç»§æ‰¿æ–¹æ¡ˆæ›¿ä»£è§£å†³ï¼Œæ€è€ƒåï¼Œå¦‚æœå¤šé‡ç»§æ‰¿ä¾ç„¶æ˜¯æœ€ç®€æ´ã€æœ€æ˜“ç»´æŠ¤ã€æœ€åˆç†çš„åšæ³•ï¼Œé‚£å°±é€‰æ‹©å®ƒã€‚</p>
<p>ref:</br>
[1]. <a href="https://blog.csdn.net/cltcj/category_12098441.html"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/cltcj/category_12098441.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
[2]. <a href="https://kissingfire123.github.io/2022/02/14_effective-c-%E4%B9%8B%E9%98%85%E8%AF%BB%E6%80%BB%E7%BB%93%E4%B8%89/"target="_blank" rel="external nofollow noopener noreferrer">https://kissingfire123.github.io/2022/02/14_effective-c-%E4%B9%8B%E9%98%85%E8%AF%BB%E6%80%BB%E7%BB%93%E4%B8%89/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></p>]]></description></item><item><title>Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [2]</title><link>https://jianye0428.github.io/posts/parttwo/</link><pubDate>Sun, 30 Jul 2023 17:08:51 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/parttwo/</guid><description><![CDATA[<!-- <div class="details admonition quote">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>quote<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">note abstract info tip success question warning failure danger bug example quote</div>
    </div>
  </div> -->
<h1 id="å‰è¨€">å‰è¨€</h1>
<blockquote>
<p>Effective-C++æ€»ç»“ç³»åˆ—åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬äºŒéƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬3~4ç« ï¼Œå†…å®¹èŒƒå›´Rule13~25ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule13ç®€å†™ä¸ºR13ã€‚</p>
</blockquote>
<div class="details admonition Note">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>Effective-C++ç³»åˆ—List<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š</br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/partone/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/parttwo/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰)</br>
ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››)</br></div>
    </div>
  </div>
<p>ç”±äºåŸä¹¦åœ¨C++11ä¹‹å‰å†™æˆï¼Œæœ‰äº›ç°ä»£C++ç‰¹æ€§ä¸ä¼šæåŠï¼Œæ‰€ä»¥ä¼šæ ¹æ®æœ¬äºº<code>å¼€å‘ç»éªŒ</code>æ–°å¢ä¸€äº›ä¸ªäººæ„Ÿæ‚ŸğŸ‘‰<code>By the way</code>ç¯èŠ‚ã€‚</p>
<h2 id="ch3èµ„æºç®¡ç†">CH3.èµ„æºç®¡ç†</h2>
<h3 id="r13-ä»¥å¯¹è±¡ç®¡ç†èµ„æº">R13 ä»¥å¯¹è±¡ç®¡ç†èµ„æº</h3>
<ul>
<li>
<p>ä¸ºé˜²æ­¢èµ„æºæ³„éœ²ï¼Œå°½é‡ä½¿ç”¨<code>RAII</code>å¯¹è±¡(èµ„æºè·å–å³åˆå§‹åŒ–ï¼ŒResource Acquisition Is Initialization)
å¦‚æœç”¨è€å¼çš„new-deleteç»„åˆæ‰‹åŠ¨ç®¡ç†èµ„æºï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼Œå¤„ç†ä»£ç ä¸­æœ‰å¤šå¤„return/breakä¹‹ç±»çš„åˆ†æ”¯è¯­å¥ï¼Œæ¯å¤„éƒ½æ‰‹åŠ¨æ·»åŠ deleteå›æ”¶èµ„æºéš¾å…ä¼šæœ‰é—æ¼é£é™©ã€‚</p>
<ol>
<li>
<p>auto_ptr
æœ¬ä¹¦æåŠçš„æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡<code>std::auto_ptr</code>å¯ä»¥åœ¨èµ„æºAåˆå§‹åŒ–åŒ–æ—¶æ¥ç®¡å¯¹è±¡Aï¼Œå¯¹è±¡è„±ç¦»ä½œç”¨åŸŸï¼Œææ„æ—¶é‡Šæ”¾æ¥ç®¡çš„Aã€‚
ä¸ºé¿å…é‡å¤åˆ é™¤èµ„æºï¼Œ<code>std::auto_ptrç‰¹æ€§:</code> é€šè¿‡copyæ„é€ å‡½æ•°æˆ–copy-assignmentæ“ä½œç¬¦ï¼Œæ“ä½œå®ƒä»¬ï¼Œå®ƒä»¬è‡ªèº«ä¼šå¤±å»èµ„æºæ‰€æœ‰æƒï¼Œå˜æˆNULL ï¼</p>
</li>
<li>
<p>shared_ptr
ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œåæ¥æ¨å‡ºäº†å¼•ç”¨è®¡æ•°ç®¡ç†èµ„æºï¼Œå³<code>RCSP(Reference-counting smart poiner)</code>ï¼Œstd::shared_ptr ã€‚(ä¹¦ä¸­å½“æ—¶è¿˜æ˜¯tr1::shared_ptr)ç‰¹ç‚¹æ˜¯shared_ptråœ¨ä½¿ç”¨copyæ„é€ å‡½æ•°æˆ–copy-assignmentæ“ä½œç¬¦æ—¶ï¼Œä¸ä¼šå¤±å»èµ„æºæ‰€æœ‰æƒï¼Œè€Œæ˜¯è‡ªèº«å¼•ç”¨è®¡æ•°åŠ 1ã€‚
<div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>Note<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><ul>
<li>
<p>auto_ptrç›®å‰å·²ç»è¢«å¼ƒç”¨ï¼Œè½¬è€Œä½¿ç”¨ std::unique_ptræ¥æŒ‡æ¶‰ç‹¬å èµ„æºçš„æ™ºèƒ½æŒ‡é’ˆï¼Œä¸å¯è¢«å¤åˆ¶å’Œèµ‹å€¼ã€‚</p>
</li>
<li>
<p>shared_ptrå­˜åœ¨çš„é—®é¢˜æ˜¯ç¯å½¢å¾ªç¯åº”ç”¨ï¼Œäº’ç›¸æŒæœ‰å¯¹æ–¹ï¼Œåˆ™æ— æ³•é‡Šæ”¾ï¼Œé’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼Œéœ€è¦å¼•å…¥std::weak_ptræ¥ç ´å±€ã€‚</p>
</li>
<li>
<p>è¿™äº›æ™ºèƒ½æŒ‡é’ˆçš„å¤´æ–‡ä»¶æ”¯æŒï¼š#include <memory></p>
</li>
</ul>
</div>
    </div>
  </div></p>
</li>
</ol>
</li>
<li>
<p>å¸¸ç”¨çš„RAIIæ–¹å¼å­˜åœ¨çš„é—®é¢˜
ä¸Šè¿°çš„shared_ptræ˜¯<strong>ä¸æ”¯æŒæ•°ç»„èµ„æºçš„é‡Šæ”¾</strong>çš„ï¼Œåœ¨ææ„æ—¶é»˜è®¤è°ƒç”¨deleteï¼Œè€Œä¸æ˜¯delete[] ã€‚å¦‚æœè¦èƒ½é‡Šæ”¾ï¼Œéœ€è¦æ‰‹åŠ¨ä¼ å…¥ææ„å‡½æ•°ã€‚</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Investment</span><span class="o">&gt;</span> <span class="n">instSpMan</span><span class="p">(</span><span class="k">new</span> <span class="n">Investment</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[](</span><span class="n">Investment</span><span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span><span class="k">delete</span><span class="p">[]</span> <span class="n">p</span><span class="p">;</span> <span class="p">});</span> <span class="c1">// ä½¿ç”¨lamdaå‡½æ•°ï¼Œè¿˜å¯ä»¥ä¼ å…¥æ™®é€šå‡½æ•°æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Investment</span><span class="p">[]</span><span class="o">&gt;</span> <span class="n">instSp</span><span class="p">(</span><span class="k">new</span> <span class="n">Investment</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span><span class="c1">// shared_ptré‡è½½äº†[]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">[]</span><span class="o">&gt;</span> <span class="n">intUp</span><span class="p">(</span><span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span> <span class="c1">// unique_ptré‡è½½äº†[]
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>PS: é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœèƒ½ç”¨vectorä»£æ›¿çš„åœºæ™¯ï¼Œå°±ä¸éœ€è¦è¿™æ ·ä½¿ç”¨å¯¹è±¡æ•°ç»„ã€‚</p>
</li>
</ul>
<h3 id="r14-åœ¨èµ„æºç®¡ç†ç±»ä¸­å°å¿ƒcopingè¡Œä¸º">R14 åœ¨èµ„æºç®¡ç†ç±»ä¸­å°å¿ƒcopingè¡Œä¸º</h3>
<p>å¹¶éæ‰€æœ‰èµ„æºéƒ½æ˜¯å †ä¸Šç®¡ç†(heap-based)ï¼Œæ‰€ä»¥ä¹Ÿæœ‰æ™ºèƒ½æŒ‡é’ˆä¸é€‚åˆçš„åœºæ™¯ï¼Œè¿™æ—¶éœ€è¦è‡ªå·±å®ç°ä¸€ä¸ªèµ„æºç®¡ç†ç±»ã€‚</p>
<p>æ¯”å¦‚æœ‰ä¸ªç±»CMutex ï¼Œåªæœ‰2ä¸ªå‡½æ•°lockå’Œunlockï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªç®¡ç†ç±»CLockï¼Œæ¥ç®¡ç†Mutexç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CMutex</span> <span class="p">{</span><span class="cm">/*çœç•¥ç±»å®ç°*/</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">lock</span><span class="p">(</span><span class="n">CMutex</span> <span class="o">*</span><span class="n">mtx</span><span class="p">)</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;has lock...</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span><span class="cm">/*other operation...*/</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">unlock</span><span class="p">(</span><span class="n">CMutex</span> <span class="o">*</span><span class="n">mtx</span><span class="p">)</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;release lock...</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span><span class="cm">/*other operation...*/</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CLock</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">explicit</span> <span class="n">CLock</span><span class="p">(</span><span class="n">CMutex</span> <span class="o">*</span><span class="n">mtx</span><span class="p">)</span> <span class="o">:</span><span class="n">mtx_</span><span class="p">(</span><span class="n">mtx</span><span class="p">)</span> <span class="p">{</span> <span class="n">lock</span><span class="p">(</span><span class="n">mtx_</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">~</span><span class="n">CLock</span><span class="p">()</span> <span class="p">{</span> <span class="n">unlock</span><span class="p">(</span><span class="n">mtx_</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span> <span class="n">CMutex</span> <span class="o">*</span><span class="n">mtx_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœæ¶‰åŠCLockçš„copingç›¸å…³å‡½æ•°ï¼Œé‚£ä¹ˆæœ‰ä»¥ä¸‹å‡ ç§é€‰æ‹©ï¼š</p>
<ul>
<li>ç¦æ­¢å¤åˆ¶
å‚è€ƒæœ¬ä¹¦Part1-Rule06ï¼Œç¦æ­¢copingå‡½æ•°çš„ç”Ÿæˆã€‚</li>
<li>å¯¹åº•å±‚èµ„æºä½¿ç”¨â€œå¼•ç”¨è®¡æ•°æ³•â€
ä»¥shared_ptr<CMutex>ä»£æ›¿è£¸æŒ‡é’ˆï¼Œå¹¶ä¸”ä¼ å…¥unlockå‡½æ•°ä½œä¸ºè¯¥æŒ‡é’ˆçš„â€œåˆ é™¤å™¨â€ã€‚</li>
<li>å¤åˆ¶åº•éƒ¨èµ„æº
å³â€œæ·±åº¦æ‹·è´â€ï¼Œå¤åˆ¶èµ„æºç®¡ç†å¯¹è±¡æ—¶ï¼ŒåŒæ—¶å¤åˆ¶å…¶åŒ…è£¹çš„èµ„æºã€‚</li>
<li>è½¬ç§»åº•éƒ¨èµ„æºæ‰€æœ‰æƒ
å³æµ…å¤åˆ¶ï¼Œä¸æ‹·è´åŒ…è£¹çš„èµ„æºï¼Œè€Œæ˜¯è½¬ç§»æ‰€æœ‰æƒï¼Œå’Œå‰æ–‡æåˆ°çš„auto_ptréå¸¸å¥‘åˆã€‚</li>
</ul>
<h3 id="r15-åœ¨èµ„æºç®¡ç†ç±»ä¸­æä¾›å¯¹åŸå§‹èµ„æºçš„è®¿é—®">R15 åœ¨èµ„æºç®¡ç†ç±»ä¸­æä¾›å¯¹åŸå§‹èµ„æºçš„è®¿é—®</h3>
<p>æ™ºèƒ½æŒ‡é’ˆ<code>auto_ptr</code>, <code>unique_ptr</code>, <code>shared_ptr</code>éƒ½æä¾›äº†æ¥å£è®¿é—®åŸå§‹èµ„æºï¼Œæ–¹æ³•åç§°ä¸º<code>get()</code>ï¼Œå¯¹ç±»Aèµ„æºå¾—åˆ°è£¸æŒ‡é’ˆ<code>A*</code>ã€‚</p>
<p>æ™ºèƒ½æŒ‡é’ˆä¹Ÿé‡è½½äº†æ“ä½œç¬¦<code>operator -&gt;</code> å’Œ <code>operator *</code> ï¼Œè®¿é—®ç±»æˆå‘˜å‡½æ•°éƒ½å¯ä»¥åƒæ™®é€šæŒ‡é’ˆé‚£æ ·ä½¿ç”¨ã€‚</p>
<p>å¦‚æœè‡ªè¡Œè®¾è®¡èµ„æºç®¡ç†ç±»ï¼Œä¹Ÿè¦åƒä¸Šè¿°çš„æ™ºèƒ½æŒ‡é’ˆé‚£æ ·ï¼Œåšåˆ°èƒ½å¤Ÿè½»æ¾è®¿é—®åŸå§‹èµ„æºã€‚</p>
<p>æŸäº›æƒ…å†µï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨getæˆå‘˜å‡½æ•°<strong>æ˜¾å¼è½¬æ¢</strong>ï¼Œè½¬è€Œä½¿ç”¨<strong>éšå¼ç±»å‹è½¬æ¢</strong>ï¼Œæ–¹ä¾¿å®¢æˆ·è°ƒç”¨:</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Font</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">     <span class="c1">// éšå¼è½¬æ¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">operator</span> <span class="n">FontHandle</span><span class="p">()</span> <span class="k">const</span><span class="p">{</span> <span class="k">return</span> <span class="n">f</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">     <span class="c1">// æ˜¾å¼è½¬æ¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">FontHandle</span> <span class="nf">get</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">f</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">FontHandle</span> <span class="n">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="r16-æˆå¯¹ä½¿ç”¨newå’Œdeleteæ—¶è¦é‡‡å–ç›¸åŒå½¢å¼">R16 æˆå¯¹ä½¿ç”¨newå’Œdeleteæ—¶è¦é‡‡å–ç›¸åŒå½¢å¼</h3>
<p>å…ˆçœ‹ä¸€æ®µé”™è¯¯ä»£ç ï¼š</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">*</span><span class="n">stringArray</span> <span class="o">=</span> <span class="k">new</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="n">stringArray</span><span class="p">;</span><span class="c1">// undefined behavior,æœªå®šä¹‰è¡Œä¸ºï¼›æœ‰å¯èƒ½åªåˆ é™¤äº†ç¬¬ä¸€ä¸ªå…ƒç´ 
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>æ³¨æ„<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><ul>
<li>new å’Œ deleteå¯¹åº”</li>
<li>new[] å’Œ delete[]å¯¹åº”
ä¸å¯é—æ¼æˆ–è€…äº¤å‰é”™é…ï¼</li>
</ul>
</div>
    </div>
  </div>
<p>ç®€å•æ¢ç©¶ <code>delete[]</code>çš„åŸç†ï¼šå®é™…ä¸Šï¼Œåœ¨ç¼–è¯‘å™¨çš„å®ç°ä¸­ï¼Œå¯¹è±¡æ•°ç»„çš„èµ·å§‹å†…å­˜ä¼šå­˜æ”¾â€œæ•°ç»„é•¿åº¦â€è¿™ä¸€å˜é‡ï¼Œä»¥ä¾¿å‘ŠçŸ¥<code>delete[]</code>åº”è¯¥è°ƒç”¨å¤šå°‘æ¬¡ææ„ï¼Œåˆ é™¤å¤šå°‘èµ„æºã€‚</p>
<p>ğŸ‘‰ è°¨æ…å¯¹æ•°ç»„ä½¿ç”¨typedefï¼Œå®¹æ˜“äº§ç”Ÿnew-deleteçš„åŒ¹é…è¯¯è§£ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">typedef</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">AddressLines</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">*</span><span class="n">pal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AddressLines</span><span class="p">;</span><span class="c1">//æ³¨æ„ï¼šè¿™é‡Œå…¶å®å°±æ˜¯ new string[4]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span> <span class="n">pal</span><span class="p">;</span>     <span class="c1">// è¡Œä¸ºæœªå®šä¹‰ï¼ï¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span> <span class="p">[]</span> <span class="n">pal</span><span class="p">;</span>  <span class="c1">// æ­£è§£ï¼
</span></span></span><span class="line"><span class="cl"><span class="c1">// è¿™é‡Œå»ºè®®çš„æ›¿ä»£æ–¹æ³•ï¼švector&lt;string&gt;
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="r17-ä»¥ç‹¬ç«‹è¯­å¥å°†newedå¯¹è±¡ç½®å…¥æ™ºèƒ½æŒ‡é’ˆ">R17 ä»¥ç‹¬ç«‹è¯­å¥å°†newedå¯¹è±¡ç½®å…¥æ™ºèƒ½æŒ‡é’ˆ</h3>
<p><strong>ä¸è¦å°†ç”³è¯·èµ„æºçš„newè¯­å¥ç›´æ¥å½“ä½œå‡½æ•°å…¥å‚</strong>ï¼Œè€Œæ˜¯åº”è¯¥å…ˆä»¥å•ç‹¬è¯­å¥ç”³è¯·åä¼ å…¥ã€‚</p>
<p>è€ƒè™‘ä¸‹è¿°é—®é¢˜ä»£ç ï¼š</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">priority</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">processWidget</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">pw</span><span class="p">,</span><span class="kt">int</span> <span class="n">pri</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//å‡½æ•°è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">processWidget</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span> <span class="n">Widget</span><span class="p">),</span><span class="n">priority</span><span class="p">());</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šè¿°ä»£ç ç¬¬4è¡Œï¼Œåœ¨processWidgetå‡½æ•°ä½“æ‰§è¡Œä¹‹å‰ï¼Œè‡³å°‘æœ‰3ä¸ªæ­¥éª¤(å¹¶éä¸¥æ ¼æ¬¡åº)ï¼š</p>
<ol>
<li>æ‰§è¡Œ&quot;new Widget&quot;</li>
<li>è°ƒç”¨std::shared_ptrçš„æ„é€ å‡½æ•°</li>
<li>è°ƒç”¨priorityå‡½æ•°</li>
</ol>
<p>C++ç¼–è¯‘å™¨èƒ½ä¿è¯1-&gt;2çš„æ¬¡åº(2éœ€è¦1åšå…¥å‚)ï¼Œä½†æ˜¯æ— æ³•ä¿è¯3çš„æ¬¡åºä¸åœ¨1ï¼Œ2ä¹‹é—´ï¼Œå¦‚æœæ­¥éª¤3æŠ›å‡ºå¼‚å¸¸ï¼Œå°†ä¼šç›´æ¥å¯¼è‡´å†…å­˜æ³„æ¼ã€‚æ­£ç¡®ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span>  <span class="n">pw</span><span class="p">(</span><span class="k">new</span> <span class="n">Widget</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">processWidget</span><span class="p">(</span><span class="n">pw</span><span class="p">,</span><span class="n">priority</span><span class="p">());</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ch4è®¾è®¡ä¸å£°æ˜">CH4.è®¾è®¡ä¸å£°æ˜</h2>
<h3 id="r18-è®©æ¥å£å®¹æ˜“è¢«æ­£ç¡®ä½¿ç”¨ä¸æ˜“è¢«è¯¯ç”¨">R18 è®©æ¥å£å®¹æ˜“è¢«æ­£ç¡®ä½¿ç”¨ï¼Œä¸æ˜“è¢«è¯¯ç”¨</h3>
<p>è¦æƒ³è®¾è®¡ä¸€ä¸ªä¸å®¹æ˜“è¯¯ç”¨çš„æ¥å£ï¼Œ<strong>å°±è¦å…ˆè€ƒè™‘ä½¿ç”¨è€…å¯èƒ½çŠ¯ä»€ä¹ˆé”™è¯¯</strong>ã€‚</p>
<ul>
<li><code>é¿å…â€œæ¥å£è¯¯ç”¨â€ï¼Œå¯ä»¥å¯¼å…¥æ–°ç±»å‹è¿›è¡Œé™åˆ¶</code>
æ¯”å¦‚è®¾è®¡ä¸€ä¸ªDateç±»ï¼Œå‚æ•°ä¼ é€’å°±å¯èƒ½å‡ºé”™ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Date</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Date</span><span class="p">(</span><span class="kt">int</span> <span class="n">month</span><span class="p">,</span><span class="kt">int</span> <span class="n">day</span><span class="p">,</span><span class="kt">int</span> <span class="n">year</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div>å®é™…ä½¿ç”¨æ—¶ï¼Œä½¿ç”¨è€…å¯èƒ½å†™å‡º<code>Date date(30,4,2021)</code>;è¿™æ ·çš„é”™è¯¯ä»£ç ï¼Œå¦‚ä½•é˜²èŒƒå‘¢ï¼Ÿ
æ–¹æ³•ä¹‹ä¸€ï¼šå°è£…å‡ºMonth,Day,Yearè¿™3ä¸ªStruct/Classï¼Œä½œä¸ºå‚æ•°å…¥å‚ï¼Œå¹¶<strong>æ·»åŠ æœˆä»½é™åˆ¶</strong>ï¼Œä»£ç ï¼š
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Month</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="n">Month</span> <span class="n">Jan</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">Month</span><span class="p">(</span><span class="mi">1</span><span class="p">);}</span> <span class="c1">// ...çœç•¥å…¶ä»–11ä¸ªæœˆä»½
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">explicit</span> <span class="nf">Month</span><span class="p">(</span><span class="kt">int</span> <span class="n">m</span><span class="p">)</span><span class="o">:</span><span class="n">val</span><span class="p">(</span><span class="n">m</span><span class="p">){}</span> <span class="c1">//å¯è¢«class-staticè°ƒç”¨ï¼Œä¸èƒ½è¢«å¤–éƒ¨è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Day</span> <span class="p">{</span><span class="k">explicit</span> <span class="nf">Day</span><span class="p">(</span><span class="kt">int</span> <span class="n">d</span><span class="p">)</span> <span class="o">:</span><span class="n">day</span><span class="p">(</span><span class="n">d</span><span class="p">){}</span>    <span class="kt">int</span> <span class="n">day</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>  <span class="c1">//çœç•¥ struct Yearå®šä¹‰ï¼Œå’ŒDayç±»ä¼¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Date</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Date</span><span class="p">(</span><span class="k">const</span> <span class="n">Month</span><span class="o">&amp;</span> <span class="n">month</span><span class="p">,</span><span class="k">const</span> <span class="n">Day</span><span class="o">&amp;</span> <span class="n">day</span><span class="p">,</span><span class="k">const</span> <span class="n">Year</span><span class="o">&amp;</span> <span class="n">year</span><span class="p">){}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div>æœ€ç»ˆå®¢æˆ·ä»£ç ä½¿ç”¨çš„æƒ…å†µå¦‚ä¸‹ï¼š
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">Date</span> <span class="nf">date</span><span class="p">(</span><span class="n">Month</span><span class="o">::</span><span class="n">Jan</span><span class="p">(),</span><span class="n">Day</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">Year</span><span class="p">(</span><span class="mi">2022</span><span class="p">));</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><pre><code>  C++11 æ”¯æŒå¯¹æšä¸¾çš„å¼ºåŒ–ï¼Œå³ç±»å‹å®‰å…¨çš„`enum class`ï¼Œå®ƒä¸èƒ½éšå¼åœ°è½¬æ¢ä¸ºæ•´æ•°ï¼›ä¹Ÿæ— æ³•ä¸æ•´æ•°æ•°å€¼åšæ¯”è¾ƒã€‚æ­¤å¤„å¯ä»¥è€ƒè™‘å®šä¹‰ä¸€ä¸ªMonthEmæ¥ä»£æ›¿Monthï¼š
  ```c++
  enum  class MonthEm {
  Jan = 1,
  Feb = 2, //... çœç•¥å…¶å®ƒçš„æœˆä»½å®šä¹‰
  };
  // ä¿®æ”¹Dateçš„æ„é€ å‡½æ•°ï¼ŒMonthEmæ¥ä»£æ›¿Month
  Date(const MonthEm&amp; monthEm, const Day&amp; day, const Year&amp; year) {}
  // æ„é€ å¯¹è±¡
  Date date2(MonthEm::Feb, Day(23), Year(2021));
  ```
</code></pre>
</div>
    </div>
  </div></li>
<li><code>é™åˆ¶ç±»å‹å†…ä»€ä¹ˆäº‹æ˜¯å¯ä¸å¯åšçš„</code>
å¸¸è§æ“ä½œæ˜¯åŠ ä¸Šconsté™åˆ¶ï¼Œæ¯”å¦‚â€œä»¥const ä¿®é¥°operator * çš„è¿”å›ç±»å‹â€å¯ä»¥é˜»æ­¢è¿™ä¸ªé”™è¯¯ï¼š
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//æœ¬æ„æ˜¯æƒ³åšæ¯”è¾ƒï¼Œå†™æˆäº†èµ‹å€¼ï¼Œä½†æ˜¯èµ‹ç»™constï¼ŒæŠ¥é”™ï¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li><code>æ™ºèƒ½æŒ‡é’ˆä¼ å…¥åˆ é™¤å™¨å¯é¿å…&quot;Cross-dll-problem&quot;</code>
std::shared_ptrç®¡ç†èµ„æºæ—¶ï¼Œä¼ å…¥åˆ é™¤å™¨ï¼Œå¯é¿å…åœ¨A-Dllä¸­newï¼Œç»“æœåœ¨å¦ä¸€ä¸ªB-Dllä¸­deleteçš„æƒ…å†µï¼Œè¿™ä¼šå¯¼è‡´Runtime-Errorã€‚</li>
</ul>
<h3 id="r19-è®¾è®¡classçŠ¹å¦‚è®¾è®¡type">R19 è®¾è®¡ClassçŠ¹å¦‚è®¾è®¡Type</h3>
<p>è®¾è®¡ä¸€ä¸ªä¼˜ç§€çš„Classå¹¶ä¸å®¹æ˜“ï¼Œå¾ˆå¤šC++ä¹¦ç±éƒ½åƒæœ¬ä¹¦ä¸€æ ·æåˆ°â€œCheck-Tableâ€ï¼Œè®¾è®¡Class/Typeå‰ï¼Œé—®è‡ªå·±ä¸€äº›é‡è¦é—®é¢˜ï¼š</p>
<ul>
<li>æ–°typeçš„å¯¹è±¡åº”è¯¥å¦‚ä½•è¢«åˆ›å»ºå’Œé”€æ¯ï¼Ÿ</li>
<li>å¯¹è±¡çš„åˆå§‹åŒ–å’Œèµ‹å€¼è¯¥æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ</li>
<li>æ–°typeçš„å¯¹è±¡å¦‚æœå€¼ä¼ é€’(pass-by-value)ï¼Œæ„å‘³ç€ä»€ä¹ˆï¼Ÿ
copyæ„é€ å‡½æ•°ç”¨æ¥å®šä¹‰ä¸€ä¸ªtypeçš„å€¼ä¼ é€’å…·ä½“å®ç°ã€‚</li>
<li>ä»€ä¹ˆæ˜¯æ–°typeçš„â€œåˆæ³•å€¼â€ï¼Ÿ
æƒ³æ¸…æ¥šçº¦æŸæ¡ä»¶ï¼Œç‰¹åˆ«æ˜¯æ„é€ å‡½æ•°ã€èµ‹å€¼æ“ä½œç¬¦ä»¥åŠ<strong>setter</strong>å‡½æ•°ï¼Œæ¶‰åŠçš„é”™è¯¯æ£€æŸ¥ä¸éæ³•å€¼æ‹¦æˆªã€‚</li>
<li>æ–°typeéœ€è¦é…åˆæŸä¸ªç»§æ‰¿å›¾è°±å—ï¼Ÿ
å¦‚æœç»§æ‰¿è‡ªæŸBaseç±»ï¼Œé‚£ä¹ˆå°±ä¼šæ”¶åˆ°virtual,non-virtualå‡½æ•°çš„çº¦æŸï¼›å¦‚æœè¦åšåç»­ç±»çš„åŸºç±»ï¼Œåˆ™è¯¥typeå°±è¦æ³¨æ„<strong>è™šææ„</strong>çš„è®¾è®¡ã€‚</li>
<li>æ–°typeæ¶‰åŠä»€ä¹ˆæ ·çš„è½¬æ¢ï¼Ÿ
ä¸å…¶ä»–typeä¹‹é—´å¦‚æœ‰è½¬æ¢éœ€æ±‚ï¼Œåˆ™éœ€è¦è‡ªè¡Œå®ç°ç›¸å…³å‡½æ•°ï¼Œå¯å‚è€ƒ<code>Rule15</code>ã€‚</li>
<li>æ–°typeéœ€è¦æ€æ ·çš„æ“ä½œç¬¦å’Œå‡½æ•°ï¼Ÿ
ç¡®å®šå“ªäº›æ˜¯memberå‡½æ•°ï¼Œå“ªäº›ä¸æ˜¯ã€‚å‚è€ƒ<code>Rule23</code>ï¼Œ<code>Rule24</code>ï¼Œ<code>Rule26</code>ã€‚</li>
<li>æ˜¯å¦æœ‰éœ€è¦ç«‹å³é©³å›çš„æ ‡å‡†å‡½æ•°ï¼Ÿ
æ¯”å¦‚<strong>æ˜¯å¦ç¦æ­¢</strong>copyæ„é€ ï¼Œcopy-assignmentæ“ä½œç¬¦ç­‰å‡½æ•°ï¼Œå¯ä»¥å£°æ˜ä¸ºprivateï¼›æˆ–è€…ä½¿ç”¨C++æ–°ç‰¹æ€§&quot;=delete&quot;ã€‚å‚è€ƒ<code>Rule6</code>ã€‚</li>
<li>æ–°typeæˆå‘˜çš„è®¿é—®å±æ€§æ§åˆ¶ï¼Ÿ
æˆå‘˜å˜é‡éƒ½åº”ä¸ºprivateï¼Œè€ƒè™‘å…¶ä»–memberå‡½æ•°è¯¥ä¸ºprivate/public/protectedã€‚ä»¥åŠå¯ç”¨å‹å…ƒfriendçš„è€ƒè™‘ã€‚</li>
<li>ä»€ä¹ˆæ˜¯æ–°typeçš„â€œæœªå£°æ˜æ¥å£â€?
å‚è€ƒ<code>Rule29</code>ã€‚</li>
<li>æ–°typeæœ‰å¤šä¹ˆä¸€èˆ¬åŒ–ï¼Ÿ
å¦‚æœæ˜¯ä¸€èˆ¬åŒ–çš„é—®é¢˜å¤„ç†ï¼Œè¯¥è€ƒè™‘æ˜¯å¦è¯¥å®šä¹‰Class-Templateã€‚</li>
<li>çœŸçš„éœ€è¦ä¸€ä¸ªæ–°typeå—ï¼Ÿ</li>
</ul>
<h3 id="r20-ä»¥pass-by-reference-to-constä»£æ›¿pass-by-value">R20 ä»¥pass-by-reference-to-constä»£æ›¿pass-by-value</h3>
<ul>
<li>å°½é‡ä»¥pass-by-reference-to-constä»£æ›¿pass-by-value
å‰è€…é€šå¸¸æ›´<strong>é«˜æ•ˆ</strong>ï¼Œå¹¶å¯<strong>é¿å…â€œå¯¹è±¡åˆ‡å‰²â€é—®é¢˜</strong>ã€‚
å¦‚æœå¯¹è±¡å…¥å‚ä»¥å€¼ä¼ é€’ï¼Œå°±ä¼šåœ¨å…¥å‚æ—¶åˆ›å»ºä¸´æ—¶å¯¹è±¡ï¼Œå‡½æ•°å®Œæˆåä¸´æ—¶å¯¹è±¡ææ„ï¼Œæ¶‰åŠæ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„è°ƒç”¨ï¼Œè¿™äº›éƒ½å¯èƒ½æ˜¯ä¸å°çš„å¼€é”€ï¼
<code>å¦‚æœæ˜¯ä»¥const referenceå½¢å¼ï¼Œåˆ™ä¸ä¼šæœ‰ä»»ä½•æ„é€ /ææ„çš„å¼€é”€</code>ã€‚constçš„ä½œç”¨æ˜¯è®©ä½¿ç”¨è€…æ”¾å¿ƒï¼Œä¸ä¼šæ”¹å˜å…¥å‚çš„å€¼ã€‚
â€œå¯¹è±¡åˆ‡å‰²&quot;é—®é¢˜ï¼š
å¦‚æœæ˜¯å€¼ä¼ é€’ï¼ŒDerived-Objä¼ é€’ç»™Base-Paramï¼Œä¼šä¸¢å¤±Derivedç‹¬æœ‰çš„ç‰¹æ€§ï¼Œåªä¿ç•™Baseçš„é‚£éƒ¨åˆ†ã€‚</li>
<li>å¯¹äºC++å†…ç½®ç±»å‹ï¼Œå€¼ä¼ é€’å¾€å¾€æ›´é«˜æ•ˆ
ä»C++ç¼–è¯‘å™¨çš„åº•å±‚å®ç°è§’åº¦æ¥çœ‹ï¼Œreferenceså¼•ç”¨å¾€å¾€æ˜¯ä»¥æŒ‡é’ˆçš„å½¢å¼å®ç°ã€‚æ‰€ä»¥å¦‚æœæ˜¯å†…ç½®æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚intç±»å‹ ï¼Œç›´æ¥å€¼ä¼ é€’åè€Œæ•ˆç‡æ›´é«˜ã€‚
<blockquote>
<p>æ­¤è§„åˆ™è¿˜é€‚ç”¨äºSTLè¿­ä»£å™¨å’Œå‡½æ•°å¯¹è±¡ã€‚</p>
</blockquote>
</li>
</ul>
<h3 id="r21-å¿…é¡»è¿”å›å¯¹è±¡æ—¶ä¸è¦éšæ„è¿”å›reference">R21 å¿…é¡»è¿”å›å¯¹è±¡æ—¶ï¼Œä¸è¦éšæ„è¿”å›reference</h3>
<p><strong>ä¸è¦è¿”å›æŒ‡é’ˆæˆ–å¼•ç”¨æŒ‡å‘ä»¥ä¸‹å¯¹è±¡</strong>:</p>
<ul>
<li>å±€éƒ¨æ ˆå¯¹è±¡(local stack)
å‡½æ•°å†…éƒ¨æ–°å»ºçš„æ ˆå˜é‡å¯¹è±¡ï¼Œå‡ºäº†å‡½æ•°å°±é¢ä¸´æ¶ˆäº¡ï¼Œä»æŒæœ‰å®ƒçš„å¼•ç”¨/æŒ‡é’ˆï¼Œæ˜¯å…¸å‹çš„æœªå®šä¹‰è¡Œä¸ºã€‚</li>
<li>å †åˆ†é…å¯¹è±¡(heap allocated)
å†…éƒ¨newï¼Œç„¶åreturnå‡ºå»ä½¿ç”¨ï¼Œä¸€æ¥ä¼šå¢åŠ å¤–éƒ¨deleteçš„è´Ÿæ‹…ï¼ŒäºŒæ¥å¯èƒ½deleteçš„æœºä¼šéƒ½æ²¡æœ‰ã€‚ä»£ç å¦‚ä¸‹ï¼š
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="n">Rational</span> <span class="o">*</span><span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rational</span><span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">n</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">.</span><span class="n">n</span><span class="p">,</span><span class="n">lhs</span><span class="p">.</span><span class="n">d</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">.</span><span class="n">d</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// å¦‚ä¸‹ä½¿ç”¨è¿ä¹˜ï¼Œåˆ™æ²¡æœ‰deleteçš„æœºä¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Rational</span> <span class="n">w</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">z</span><span class="p">;</span> <span class="c1">// å†…å­˜æ³„æ¼ï¼ï¼ï¼
</span></span></span></code></pre></td></tr></table>
</div>
</div>ä¸Šè¿°ä»£ç è¿”å›çš„æ˜¯å¼•ç”¨ï¼Œè¿”å›æŒ‡é’ˆä¹Ÿæ˜¯ä¸€æ ·çš„è´Ÿä½œç”¨ã€‚</li>
<li>å±€éƒ¨staticå¯¹è±¡(local static)
å‡½æ•°å†…éƒ¨çš„staticå¯¹è±¡ï¼Œåªåˆå§‹åŒ–ä¸€æ¬¡ï¼Œä¸”åªæœ‰ä¸€ä»½ï¼Œæœ‰è®°å¿†åŠŸèƒ½ï¼Œå¯ä»¥è¢«æ›´æ–°ã€‚é‚£ä¹ˆä¸‹è¿°ä»£ç å°±ä¼šå‡ºç°é—®é¢˜ï¼š
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="k">static</span> <span class="n">Rational</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">result</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">n</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">.</span><span class="n">n</span><span class="p">,</span><span class="n">lhs</span><span class="p">.</span><span class="n">d</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">.</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span> <span class="c1">//åœ¨è°ƒç”¨è€…çœ‹æ¥ï¼Œå› ä¸ºæ˜¯å¼•ç”¨ï¼Œæ°¸è¿œåªçœ‹åˆ°ç‹¬ä¸€ä»½çš„resultçš„â€œæœ€æ–°å€¼ â€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸‹æ–¹çš„æ¯”è¾ƒæ°¸è¿œéƒ½æ˜¯trueï¼Œæ°¸è¿œèµ°ifåˆ†æ”¯  ï¼ï¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Rational</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">((</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">d</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//ä¹˜ç§¯ç›¸ç­‰ï¼Œèµ°ifåˆ†æ”¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//ä¹˜ç§¯ä¸ç›¸ç­‰ï¼Œèµ°elseåˆ†æ”¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>Tips<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><blockquote>
<p>é‚£æ˜¯ä¸æ˜¯æ°¸è¿œä¸èƒ½ä»¥referenceä½œä¸ºè¿”å›å€¼å‘¢ ï¼Ÿ
å½“ç„¶ä¸æ˜¯ï¼Œ*thiså¯ä»¥è¿”å›å…¶å¼•ç”¨ï¼Œå‚è€ƒRule10ï¼›æˆ–è€…ç±»æˆå‘˜ä½œä¸ºè¿”å›å€¼æ—¶ï¼Œå¯ä»¥è¿”å›å…¶å¼•ç”¨ï¼Œä½†æœ€å¥½æ˜¯constã€‚</p>
</blockquote>
</div>
    </div>
  </div>
<h3 id="r22-å°†æˆå‘˜å˜é‡å£°æ˜ä¸ºprivate">R22 å°†æˆå‘˜å˜é‡å£°æ˜ä¸ºprivate</h3>
<ul>
<li>
<p>æˆå‘˜å˜é‡ä¸ºprivateè·å¾—çš„å¥½å¤„</p>
<ol>
<li>å®¢æˆ·è®¿é—®æ•°æ®çš„ä¸€è‡´æ€§ã€‚éƒ½æ˜¯ç”¨getterå‡½æ•°ï¼ˆéœ€è¦åŠ æ‹¬å·ï¼‰ï¼Œè€Œä¸æ˜¯æ··ç”¨å‡½æ•°è·å–å’Œç›´æ¥è®¿é—®ï¼›</li>
<li>ç»†åŒ–æˆå‘˜å˜é‡çš„è®¿é—®æƒé™ã€‚æ ¹æ®æ˜¯å¦æœ‰getterã€setterå‡½æ•°å¯ä»¥ç²¾å‡†æ§åˆ¶read/write/noneè¿™æ ·çš„ç»†åŒ–ã€‚</li>
<li>ä¿æŒå®ç°å¼¹æ€§ã€‚æ¯”å¦‚è·å–æŸç³»ç»ŸæŒ‡æ ‡ï¼Œå¯ä»¥åœ¨getterå‡½æ•°ä¸­ä¿®æ”¹å„ç§çµæ´»çš„ç­–ç•¥å’Œç®—æ³•ï¼Œè€Œè°ƒç”¨è€…æ„ŸçŸ¥ä¸åˆ°ã€‚</li>
<li>å°è£…æ€§ã€‚å°è£…æ€§æ˜¯æŒ‡â˜ <code>è¶Šå¤šå‡½æ•°å¯ä»¥è®¿é—®è¯¥æ•°æ®ï¼Œå°è£…æ€§è¶Šä½</code>ã€‚
å®¢æˆ·è°ƒç”¨ç«¯æ„ŸçŸ¥ä¸åˆ°classå†…éƒ¨çš„å®ç°ï¼Œè¿™äº›ç¡®å®ä¹Ÿæ˜¯ä¸å¿…æš´éœ²çš„ã€‚å¹¶ä¸”ï¼Œå¦‚æœæ˜¯è¦ä¿®æ”¹æŸä¸ªå˜é‡ï¼Œä½¿ç”¨setterå‡½æ•°ä¹Ÿæ›´æ–¹ä¾¿è°ƒè¯•ï¼Œä¸è‡³äºè¢«éšæ„ä¿®æ”¹ã€‚</li>
</ol>
</li>
<li>
<p>protectedå’Œpublicå·®ä¸å¤šï¼Œéƒ½ä¸å…·å¤‡å°è£…æ€§
å¦‚æœæŸä¸ªpublic/protectedå˜é‡æƒé™è¢«å–æ¶ˆï¼ˆæ¯”å¦‚æ”¹ä¸ºprivateï¼‰ï¼Œå°†ä¼šå¯¼è‡´å¤§é¢ç§¯çš„ç¼–è¯‘é”™è¯¯ï¼Œèƒ½è®¿é—®çš„å˜æˆunaccessibleï¼Œéœ€è¦å¯¹åº”ä¿®æ”¹è®¸å¤šä»£ç ã€‚</p>
</li>
</ul>
<h3 id="r23-å®å¯ç”¨non-membernon-friendä»£æ›¿memberå‡½æ•°">R23 å®å¯ç”¨non-member,non-friendä»£æ›¿memberå‡½æ•°</h3>
<ul>
<li>å®é™…ä¸Šï¼Œnon-member/non-friendå‡½æ•°å…·æœ‰æ›´å¤§çš„å°è£…æ€§
è€ƒè™‘ä¸‹è¿°ä¸€ä¸ªç±»WebBrowserï¼Œmemberå‡½æ•°å’Œnon-memberå‡½æ•°ï¼Œå®é™…ä¸Šï¼Œ<strong>memberå‡½æ•°</strong>WebBrowser::clearEverythingå…·æœ‰å…¶ä»–privateæ•°æ®çš„è®¿é—®æƒé™ï¼Œ<strong>å°è£…æ€§æ˜¯æ›´å·®çš„</strong>ï¼
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">WebBrowser</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">clearCache</span><span class="p">()</span> <span class="p">{</span><span class="cm">/*to clear cache*/</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">clearHistory</span><span class="p">()</span> <span class="p">{</span><span class="cm">/*to clear history*/</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">removeCookies</span><span class="p">()</span> <span class="p">{</span><span class="cm">/*to clear cookies*/</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">clearEverything</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">clearCache</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">clearHistory</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">removeCookies</span><span class="p">();}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">clearBrowser</span><span class="p">(</span><span class="n">WebBrowser</span> <span class="o">&amp;</span><span class="n">wb</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">wb</span><span class="p">.</span><span class="n">clearCache</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">wb</span><span class="p">.</span><span class="n">clearHistory</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">wb</span><span class="p">.</span><span class="n">removeCookies</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>å·¥ç¨‹ç»“æ„å®‰æ’
å¯¹äºä¸Šè¿°WebBrowserçš„ä¾‹å­ï¼Œnon-memberå‡½æ•°æ”¾å“ªé‡Œå‘¢ï¼Œé™¤äº†å¯ä»¥æ˜¯å…¶ä»–classçš„memberå‡½æ•°ï¼Œæ›´é€‚ç”¨è‡ªç„¶çš„ç­”æ¡ˆæ˜¯ç”¨<code>namespaceåŒ…è£¹èµ·æ¥</code>ã€‚ä»£ç å¦‚ä¸‹ï¼š
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="n">WebBrowserStuff</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">WebBrowser</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">clearBrowser</span><span class="p">(</span><span class="n">WebBrowser</span> <span class="o">&amp;</span><span class="n">wb</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>æ³¨æ„ï¼š<code>namespaceå¯ä»¥è·¨è¶Šå¤šä¸ªæºç æ–‡ä»¶ï¼Œè€Œclassä¸èƒ½</code>ã€‚
<strong>é€šå¸¸çš„ç»„ç»‡æ–¹å¼</strong>ï¼šå¤šä¸ª.hå¤´æ–‡ä»¶éƒ½ä½¿ç”¨åŒä¸€ä¸ªnamespaceï¼Œç®¡ç†ä¸åŒçš„åŠŸèƒ½æ¨¡å—ã€‚é™¤äº†è®©æ¨¡å—æ›´æ¸…æ™°ï¼Œè¿˜èƒ½é™ä½ä¸å¿…è¦çš„ç¼–è¯‘ä¾èµ–å…³ç³»ã€‚</li>
<li>å¯¹äºprivateæ•°æ®ï¼Œmemberå’Œfriendå‡½æ•°å…·æœ‰ç›¸åŒçš„è®¿é—®æƒé™
åŸºäºæ­¤ï¼Œè¿™é‡Œè®¨è®ºçš„å°è£…æ€§ä¸åœ¨äºmemberä¸å¦ï¼Œè€Œæ˜¯memberå’Œnon-member ï¼Œnon-friendå‡½æ•°ä¹‹é—´ã€‚</li>
</ul>
<h3 id="r24-è‹¥æ‰€æœ‰å‚æ•°çš†éœ€ç±»å‹è½¬æ¢è¯·é‡‡ç”¨non-member">R24 è‹¥æ‰€æœ‰å‚æ•°çš†éœ€ç±»å‹è½¬æ¢ï¼Œè¯·é‡‡ç”¨non-member</h3>
<p>æ ‡é¢˜éœ€æ˜æ™°ï¼šæ‰€æœ‰å‚æ•°ï¼Œæ˜¯æŒ‡<strong>åŒ…å«äº†è¢«thisæŒ‡é’ˆæ‰€æŒ‡å‘çš„é‚£ä¸ªéšå«å‚æ•°</strong>ï¼ˆnon-explicitæ„é€ å‡½æ•°è°ƒç”¨éšå¼ç±»å‹è½¬æ¢æ—¶ï¼‰ã€‚</p>
<p><strong>åº”å¯¹å…·ä½“åœºæ™¯</strong>ï¼šæ„é€ å‡½æ•°å…è®¸éšå¼ç±»å‹è½¬æ¢ï¼Œä¸”éœ€è¦è¿™ä¸ªæ„é€ å¥½çš„å¯¹è±¡ç«‹å³è°ƒç”¨æŸmemberå‡½æ•°foo(æ¯”å¦‚operatorå‡½æ•°)ï¼Œæ­¤æ—¶è¿™ä¸ªfooå‡½æ•°åº”è¯¥æ”¹ä¸ºnon-memberçš„fooå‡½æ•°ã€‚</p>
<p>è€ƒè™‘ä¸€ä¸ªæœ‰ç†æ•°ç±»Rationalï¼Œå…è®¸éšå¼ç±»å‹è½¬æ¢æ„é€ ï¼ˆå³non-explicitï¼‰ï¼Œå¦‚æœ<code>operator*</code>æ˜¯memberå‡½æ•°åˆ™ä¼šå‡ºç°é—®é¢˜ã€‚Rationalç±»å®ç°ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Rational</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Rational</span><span class="p">(</span><span class="kt">int</span> <span class="n">numerator</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">:</span><span class="n">numerator_</span><span class="p">(</span><span class="n">numerator</span><span class="p">),</span> <span class="n">denominator_</span><span class="p">(</span><span class="n">denominator</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="n">Rational</span> <span class="k">operator</span><span class="o">*</span> <span class="p">(</span><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span><span class="k">const</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nf">Rational</span><span class="p">(</span><span class="n">numerator_</span><span class="o">*</span><span class="n">rhs</span><span class="p">.</span><span class="n">numerator_</span><span class="p">,</span> <span class="n">denominator_</span><span class="o">*</span><span class="n">rhs</span><span class="p">.</span><span class="n">denominator_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="nf">numerator</span><span class="p">()</span><span class="k">const</span>  <span class="p">{</span> <span class="k">return</span> <span class="n">numerator_</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="nf">denominator</span><span class="p">()</span><span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">denominator_</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">numerator_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">denominator_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šè¿°ä»£ç å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸èƒ½æ··åˆè¿ç®—ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">Rational</span> <span class="nf">rat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">Rational</span> <span class="n">rat3Tm</span> <span class="o">=</span> <span class="n">rat</span> <span class="o">*</span> <span class="mi">3</span><span class="p">;</span>   <span class="c1">//èƒ½æˆåŠŸè°ƒç”¨member-operator*
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Rational</span> <span class="n">rat3Tm2</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">rat</span><span class="p">;</span>  <span class="c1">//ç¼–è¯‘æŠ¥é”™ï¼ï¼ï¼ æœ¬èŠ‚çš„åœºæ™¯å°±åœ¨äºæ­¤.
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœè¦è®©è¿™ç§æ··åˆè¿ç®—æ— éšœç¢ï¼ŒæŠŠ<code>operator*</code>å‡½æ•°æ”¹æˆnon-memberå³å¯ï¼Œæ³¨æ„è¦<strong>åˆ æ‰åŸæ¥memberå†…çš„<code>operator*</code></strong>ï¼Œä¸èƒ½åŒæ—¶å­˜åœ¨è¿™2ä¸ªoperator*ã€‚</p>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Rational</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//... æ³¨æ„ï¼Œè¦åˆ é™¤ç±»å†…çš„memberå‡½æ•°operator*
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">Rational</span> <span class="k">operator</span><span class="o">*</span> <span class="p">(</span><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nf">Rational</span><span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">numerator</span><span class="p">()</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">.</span><span class="n">numerator</span><span class="p">(),</span> <span class="n">lhs</span><span class="p">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">.</span><span class="n">denominator</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="r25-è€ƒè™‘å†™ä¸€ä¸ªä¸æŠ›å¼‚å¸¸çš„swapå‡½æ•°">R25 è€ƒè™‘å†™ä¸€ä¸ªä¸æŠ›å¼‚å¸¸çš„swapå‡½æ•°</h3>
<ul>
<li>å½“ std::swapå¯¹æŸä¸ªç±»å‹æ•ˆç‡ä¸é«˜æ—¶ï¼Œæä¾›ä¸€ä¸ªswapæˆå‘˜å‡½æ•°ï¼Œä¸”è¯¥swapä¸æŠ›å¼‚å¸¸
å…ˆçœ‹ä¸€ä¸‹æ•ˆç‡ä¸é«˜çš„std::swapå®ç°ï¼š
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="n">std</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>  <span class="c1">//std::swapçš„å…¸å‹å®ç°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">void</span> <span class="n">swap</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//ç½®æ¢ a å’Œ b çš„å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">T</span> <span class="nf">temp</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>   <span class="c1">//è‹¥Tæ˜¯classï¼Œæ­¤å¤„è°ƒç”¨copyæ„é€ å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>       <span class="c1">//è‹¥Tæ˜¯classï¼Œæ­¤å¤„è°ƒç”¨copy assignmentæ“ä½œç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">b</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>è€ƒè™‘è¿™æ ·çš„ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦swapä¸€ä¸ª&quot;pimplæ‰‹æ³•â€(pointer to implementation)å®ç°çš„ç±»ï¼Œè¿™ç§ä¼ ç»Ÿçš„std::swapå¿…ç„¶æ˜¯æ•ˆç‡ä¸é«˜(æ·±å¤åˆ¶implç±»çš„æ•°æ®è€—æ—¶è¾ƒé•¿)ã€‚
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">WidgetSwImpl</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span> <span class="c1">//å¾ˆå¤§çš„vector,æ„å‘³ç€å¤åˆ¶æ—¶é—´å¾ˆé•¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">WidgetSw</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">WidgetSw</span><span class="p">(</span><span class="n">WidgetSwImpl</span><span class="o">*</span> <span class="n">pImpl</span><span class="p">)</span> <span class="o">:</span><span class="n">pImpl_</span><span class="p">(</span><span class="n">pImpl</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="n">WidgetSw</span><span class="p">(</span><span class="k">const</span> <span class="n">WidgetSw</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="p">{</span><span class="cm">/*å…¶ä»–copy&amp;initialæ“ä½œ*/</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">WidgetSw</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">WidgetSw</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span><span class="n">pImpl_</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">rhs</span><span class="p">.</span><span class="n">pImpl_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">swap</span><span class="p">(</span><span class="n">WidgetSw</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//public-memberå‡½æ•°swap
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">using</span> <span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">;</span>   <span class="c1">//ä»¤std::swapåœ¨æ­¤å‡½æ•°å¯ç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">swap</span><span class="p">(</span><span class="n">pImpl_</span><span class="p">,</span><span class="n">other</span><span class="p">.</span><span class="n">pImpl_</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">WidgetSwImpl</span><span class="o">*</span> <span class="n">pImpl_</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div>è°ƒç”¨æ—¶ä»£ç å¦‚ä¸‹ï¼š
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">WidgetSw</span> <span class="nf">wSw1</span><span class="p">(</span><span class="k">new</span> <span class="n">WidgetSwImpl</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">WidgetSw</span> <span class="nf">wSw2</span><span class="p">(</span><span class="k">new</span> <span class="n">WidgetSwImpl</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">wSw1</span><span class="p">.</span><span class="n">swap</span><span class="p">(</span><span class="n">wSw2</span><span class="p">);</span> <span class="c1">//æˆåŠŸè¿è¡Œ
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>å¦‚æœæä¾›äº†member swapï¼Œéœ€æä¾›ä¸€ä¸ªnon-memberçš„swapè°ƒç”¨å‰è€…
æ³¨æ„ï¼Œå…¶å®ä¸Šè¿°swapæˆå‘˜å‡½æ•°ä½¿ç”¨èµ·æ¥ä¸ç®—ç›´è§‚å’Œç»Ÿä¸€ï¼Œå¯ä»¥å…¨ç‰¹åŒ–std::swapè®©ä½¿ç”¨æ›´ç›´è§‚æ–¹ä¾¿ï¼Œä»£ç å¦‚ä¸‹ï¼š
<div class="highlight" id="id-22"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="n">std</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">template</span><span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="n">swap</span><span class="o">&lt;</span><span class="n">WidgetSw</span><span class="o">&gt;</span><span class="p">(</span><span class="n">WidgetSw</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="n">WidgetSw</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">a</span><span class="p">.</span><span class="n">swap</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// å®¢æˆ·ç«¯åº”ç”¨ä»£ç å¯ä»¥å¦‚ä¸‹è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1">// æ³¨æ„ï¼Œä¸åº”è¯¥ï¼Œä¹Ÿæ²¡å¿…è¦åŠ  std::ï¼Œä¼šé™åˆ¶ç¼–è¯‘å™¨åªä½¿ç”¨stdå‘½åç©ºé—´çš„swap
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">swap</span><span class="p">(</span><span class="n">wSw1</span><span class="p">,</span><span class="n">wSw2</span><span class="p">);</span><span class="c1">//ç¼–è¯‘å™¨ä¼šä¼˜å…ˆæŒ‘ä¸­å…¨ç‰¹åŒ–ç‰ˆæœ¬çš„std::swap
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>å¦‚æœæ˜¯Class-Templateï¼Œåˆ™ä¸è¦ç‰¹åŒ–stdå‘½åç©ºé—´çš„swapï¼Œè€Œæ˜¯ç§»åˆ°å…¶å®ƒå‘½åç©ºé—´
<div class="highlight" id="id-23"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="n">WidgetStuff</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">WidgetSw</span><span class="p">{</span> <span class="cm">/*çœç•¥ç±»å®šä¹‰*/</span><span class="p">}</span> <span class="c1">// ç±»å†…å«æœ‰swapæˆå‘˜å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="n">swap</span><span class="p">(</span><span class="n">WidgetSw</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="n">WidgetSw</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span><span class="p">.</span><span class="n">swap</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>Notice<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><ul>
<li>stdå‘½åç©ºé—´çš„å‡½æ•°ä¸è¦å°è¯•é‡è½½ï¼Œä¹Ÿä¸è¦å¢åŠ ä»»ä½•æ–°ä¸œè¥¿</li>
<li>C++åªå…è®¸å¯¹<code>Class-Template</code>ç›´æ¥åç‰¹åŒ–ï¼Œä¸èƒ½å¯¹<code>Function-Template</code>åç‰¹åŒ–(å‡½æ•°æ¨¡æ¿å¯ä»¥é€šè¿‡é‡è½½é—´æ¥å®ç°â€œåç‰¹åŒ–â€çš„ä½œç”¨)</li>
<li><strong>æˆå‘˜ç‰ˆswapç»å¯¹ä¸è¦æŠ›å‡ºå¼‚å¸¸</strong>ï¼Œéæˆå‘˜swapå¯ä»¥(å› ä¸ºæˆå‘˜swapçš„ä¸€ä¸ªæœ€å¥½åº”ç”¨å°±æ˜¯æä¾›å¼‚å¸¸å®‰å…¨æ€§)</li>
</ul>
</div>
    </div>
  </div></li>
</ul>
<p>ref:</br>
[1]. <a href="https://blog.csdn.net/cltcj/category_12098441.html"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/cltcj/category_12098441.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
[2]. <a href="https://kissingfire123.github.io/2022/01/11_effective-c-%e4%b9%8b%e5%ad%a6%e4%b9%a0%e6%80%bb%e7%bb%93%e4%ba%8c/"target="_blank" rel="external nofollow noopener noreferrer">https://kissingfire123.github.io/2022/01/11_effective-c-%e4%b9%8b%e5%ad%a6%e4%b9%a0%e6%80%bb%e7%bb%93%e4%ba%8c/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></p>]]></description></item><item><title>Effective C++ (ç¬¬3ç‰ˆ) ç²¾è¯»æ€»ç»“ [1]</title><link>https://jianye0428.github.io/posts/partone/</link><pubDate>Sat, 29 Jul 2023 18:51:19 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/partone/</guid><description><![CDATA[<h1 id="åºè¨€">åºè¨€</h1>
<p>è¿™æœ¬C++çš„ç»å…¸ä¹‹ä½œï¼Œä½œè€…æ˜¯å¤§ä½¬<code>Scott Meyers</code>ğŸ‘‰<a href="https://www.aristeia.com/books.html"target="_blank" rel="external nofollow noopener noreferrer">å¤§ä½¬ä¸»é¡µ<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ï¼Œè¿˜å†™è¿‡å…¶ä»–å‡ æœ¬å½±å“æ·±è¿œçš„C++ç»å…¸ï¼Œä¾‹å¦‚<code>ã€ŠEffective STLã€‹</code>,<code>ã€ŠMore Effective C++ã€‹</code>,<code>ã€ŠEffective Mordern C++ã€‹</code>,<code>ã€ŠOverview of the New C++(C++11/14)ã€‹</code>ç­‰ç­‰ã€‚æœ¬äººçœ‹çš„æ˜¯ä¸­æ–‡ç‰ˆï¼Œä¾¯æ·è€å¸ˆç¿»è¯‘çš„ï¼Œç²¾è¯»åˆ†æå¹¶å®è·µæ¨æ•²åï¼Œæ•´ç†æˆåšå®¢è®°å½•ä¸‹æ¥ã€‚</p>
<blockquote>
<p>(Effective-C++æ€»ç»“ç³»åˆ—åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œæœ¬æ–‡ä¸ºç¬¬ä¸€éƒ¨åˆ†ï¼Œæ¶‰åŠåŸä¹¦ç¬¬1~2ç« ï¼Œå†…å®¹èŒƒå›´Rule01~12ã€‚ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼ŒRule01ç®€å†™ä¸ºR01)ã€‚</p>
</blockquote>
<div class="details admonition Note">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>Effective-C++ç³»åˆ—List<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">æœ¬åšå®¢ç«™ç‚¹ç³»åˆ—å†…å®¹å¦‚ä¸‹ï¼š</br>
ğŸ’¡ <a href="https://jianye0428.github.io/posts/partone/"target="_blank" rel="external nofollow noopener noreferrer">Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸€)<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(äºŒ)</br>
ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(ä¸‰)</br>
ğŸ’¡ Effective C++(ç¬¬3ç‰ˆ)ç²¾è¯»æ€»ç»“(å››)</br></div>
    </div>
  </div>
<h2 id="ch1è®©è‡ªå·±ä¹ æƒ¯c">CH1.è®©è‡ªå·±ä¹ æƒ¯C++</h2>
<h3 id="r01-è§†cä¸ºä¸€ä¸ªè¯­è¨€è”é‚¦">R01 è§†C++ä¸ºä¸€ä¸ªè¯­è¨€è”é‚¦</h3>
<p>å¦‚ä»Šçš„C++å·²ç»æ˜¯ä¸ªå¤šé‡èŒƒå¼(multiparadigm)è¯­è¨€ï¼ŒåŒæ—¶æ”¯æŒé¢å‘è¿‡ç¨‹å½¢å¼ã€é¢å‘å¯¹è±¡å½¢å¼ã€å‡½æ•°å½¢å¼ã€æ³›å‹å½¢å¼ã€å…ƒç¼–ç¨‹å½¢å¼ã€‚ è¦ç†è§£è¿™ä¹ˆå¤šç‰¹æ€§ï¼Œå¯ä»¥ç®€å•çš„å½’ç»“ä¸º<code>å››ç§æ¬¡è¯­è¨€</code>(sublanguage)ç»„æˆï¼š</p>
<ul>
<li><strong>Cè¯­è¨€ï¼š</strong><code>C++ä»ä»¥Cä¸ºåŸºç¡€</code>ã€‚C++æ˜¯Cçš„è¶…é›†ï¼ŒåŒºå— ã€è¯­å¥ã€é¢„å¤„ç†ã€å†…ç½®æ•°æ®ç±»å‹ã€æ•°ç»„ã€æŒ‡é’ˆç­‰å…¨éƒ¨æ¥è‡ªäºCè¯­è¨€ï¼›
<ul>
<li>è¯´åˆ°åº• C++ ä»ç„¶ä»¥ C ä¸ºåŸºç¡€ã€‚åŒºå—ã€è¯­å¥ã€é¢„å¤„ç†å™¨ã€å†…ç½®æ•°æ®ç±»å‹ ã€æ•°ç»„ã€æŒ‡é’ˆç­‰ç»Ÿç»Ÿæ¥è‡ªCï¼Œè®¸å¤šæ—¶å€™C++å¯¹é—®é¢˜çš„è§£å†³å…¶å®ä¸è¿‡å°±æ˜¯è¾ƒé«˜çº§çš„ C è§£æ³•ï¼Œä½†å½“ä½ C++å†…çš„ C æˆåˆ†å·¥ä½œæ—¶ï¼Œé«˜æ•ˆç¼–ç¨‹å®ˆåˆ™æ˜ ç…§å‡º C è¯­è¨€çš„å±€é™ï¼šæ²¡æœ‰æ¨¡æ¿(template) ï¼Œæ²¡æœ‰å¼‚å¸¸(exceptions)ï¼Œæ²¡æœ‰é‡è½½(overloading)â€¦â€¦</li>
</ul>
</li>
<li><strong>Object-Oriented C++:</strong> é¢å‘å¯¹è±¡ç‰¹æ€§ã€‚è¿™éƒ¨åˆ†ä¹Ÿå°±æ˜¯ C with classes æ‰€è¯‰æ±‚çš„ï¼šclasses(åŒ…æ‹¬æ„é€ å‡½æ•°å’Œææ„å‡½æ•°)ï¼Œå°è£…(encapsulation)ã€ç»§æ‰¿(inheritance)ã€å¤šæ€(polymorhpism)ã€virtualå‡½æ•°(åŠ¨æ€ç»‘å®š)â€¦â€¦ç­‰ç­‰ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯é¢å‘å¯¹è±¡è®¾è®¡ä¹‹å¤å…¸å®ˆåˆ™åœ¨C++ ä¸Šçš„ç›´æ¥å®æ–½ã€‚</li>
<li>**Template C++:**C++çš„æ³›å‹(generic)ç¼–ç¨‹çš„éƒ¨åˆ†ï¼Œä¹Ÿå¸¦æ¥äº†é»‘é­”æ³•-æ¨¡æ¿å…ƒç¼–ç¨‹(TMP,Metaprogramming)ï¼›</li>
<li>**STLï¼š**STL(Standard Temlate Library)å³æ ‡å‡†æ¨¡æ¿åº“ï¼Œå®ƒæ˜¯templateç¨‹åºåº“ã€‚å°è£…äº†å„ç±»å®¹å™¨(container)ã€é…ç½®å™¨(allocator)ã€è¿­ä»£å™¨(iterator)ã€ç®—æ³•ä»¥åŠå¸¸ç”¨å¯¹è±¡ã€‚</li>
</ul>
<p><strong>æ€»ç»“:</strong>
C++é«˜æ•ˆç¼–ç¨‹å®ˆåˆ™è§†çŠ¶å†µè€Œå˜åŒ–ï¼Œå–å†³äºä½ ä½¿ç”¨C++çš„å“ªä¸€éƒ¨åˆ†</p>
<h3 id="r02-å°½é‡ä»¥constenuminlineæ›¿æ¢define">R02 å°½é‡ä»¥<code>const</code>,<code>enum</code>,<code>inline</code>æ›¿æ¢<code>#define</code></h3>
<ul>
<li><strong>å¯¹äºå®å®šä¹‰çš„å¸¸é‡ï¼Œå»ºè®®ç”¨constå¸¸é‡æˆ–è€…æšä¸¾enumæ›¿æ¢</strong>
è¿™æ ·åšçš„å¥½å¤„æ˜¯æ–¹ä¾¿è°ƒè¯•ï¼Œå› ä¸ºå®æŠ¥é”™å°±æ˜¯ä¸ªå¸¸æ•°å€¼ï¼Œæ²¡æœ‰ç¬¦å·è¡¨ï¼›å¹¶ä¸”å®ä¸å…·æœ‰å°è£…æ€§(å®çš„ä½œç”¨åŸŸæ˜¯åœ¨ç¼–è¯‘æ—¶æ˜¯å…¶å®šä¹‰ä¹‹äº‹)ã€‚
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// ä¸¾ä¾‹ï¼šMAX_DATA_COUNTåœ¨é¢„å¤„ç†é˜¶æ®µå°±ä¼šè¢«æ›¿æ¢ï¼Œç¼–è¯‘å™¨ä¸ä¼šè§åˆ°å®ƒï¼Œæ‰€ä»¥ä¸€æ—¦æœ‰ç›¸å…³æŠ¥é”™ï¼Œç»™çš„æ˜¯100è¿™ä¸ªå€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define MAX_DATA_COUNT   100
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">const</span>  <span class="kt">int</span> <span class="n">MAX_DATA_COUNT</span> <span class="o">=</span> <span class="mi">100</span> <span class="p">;</span><span class="c1">//å¸¸é‡åªæœ‰ä¸€ä»½ï¼Œå®ä¼šå¯¼è‡´å¤šä»½å¸¸é‡å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Buffer</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span><span class="c1">//...ç±»å…¶ä»–éƒ¨åˆ†çœç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">static</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">factor_</span> <span class="p">;</span><span class="c1">//staticå¸¸é‡,ç±»å†…å£°æ˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">static</span> <span class="k">const</span> <span class="kt">int</span>  <span class="n">times_</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="c1">// intç±»å‹å…è®¸ç±»å†…åˆå§‹åŒ–,è§„èŒƒä¸Šè¿˜æ˜¯å»ºè®®æ‹¿åˆ°ç±»å¤–
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="k">const</span>  <span class="kt">int</span> <span class="n">ArrLength</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">arr</span><span class="p">[</span><span class="n">ArrLength</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">double</span> <span class="n">Buffer</span><span class="o">::</span><span class="n">factor_</span>  <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span><span class="c1">//ç±»å¤–åˆå§‹åŒ–,ä¸€èˆ¬å†™åœ¨å®ç°æ–‡ä»¶*.cpp,*.ccä¸­
</span></span></span></code></pre></td></tr></table>
</div>
</div>å¦‚æœç¼–è¯‘å™¨ä¸å…è®¸å£°æ˜æ—¶&quot;in-classåˆå€¼è®¾å®š&quot;,å¦‚æœæ˜¯æ•´å½¢å¸¸é‡ï¼Œå¯ä»¥è®©æšä¸¾å€¼æ¥æ›¿ä»£ï¼Œè€Œä¸”<font color=red><code>æšä¸¾å€¼ä¸èƒ½è¢«å–åœ°å€</code></font>ã€‚</li>
<li><strong>å¯¹äºå®å®šä¹‰çš„å‡½æ•°ï¼Œå»ºè®®ç”¨å†…è”inlineå‡½æ•°æ›¿æ¢</strong>
å®å‡½æ•°æ²¡åŠæ³•å•è¡Œdebugè°ƒè¯•ï¼Œè€Œå†…è”å‡½æ•°å¯ä»¥ï¼›
å®çš„å†™æ³•å³ä½¿å°å¿ƒç¿¼ç¿¼çš„åŠ å¥½äº†æ‹¬å·ï¼Œä¹Ÿå¯èƒ½é€ æˆæ„æƒ³ä¸åˆ°çš„<font color=red><code>å®å‡½æ•°é‡å¤è®¡ç®—</code></font>çš„é—®é¢˜ã€‚
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#define  GET_MAX(a,b)   ((a)&gt;(b) ? (a) :(b))
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">GET_MAX</span><span class="p">(</span><span class="o">++</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>    <span class="c1">// aç´¯åŠ äºŒæ¬¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">GET_MAX</span><span class="p">(</span><span class="o">++</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">+</span><span class="mi">10</span><span class="p">);</span> <span class="c1">// aç´¯åŠ ä¸€æ¬¡
</span></span></span><span class="line"><span class="cl"><span class="c1">// å®šä¹‰ä¸ªinlineå‡½æ•°å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜,(a,b)ä½œä¸ºå‡½æ•°å…¥å‚å°±åªä¼šè®¡ç®—ä¸€æ¬¡
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>ä¸Šè¿°æƒ…å†µï¼Œä»çº¯Cè¯­è¨€è§’åº¦ï¼Œæƒ³é¿å…â€œå®å‡½æ•°é‡å¤è®¡ç®—â€ï¼Œå…¶å®è¿˜æœ‰ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨GNU C æ‰©å±•çš„ typeof æˆ– GCC çš„ <code>__auto_type</code> å…³é”®å­—ï¼Œè¯¦ç»†å¯å‚è€ƒGCCå®˜æ–¹æ–‡æ¡£é¡µé¢ã€‚2è€…éƒ½é€‚ç”¨äºGCCå’ŒClangï¼Œéƒ½ä¸é€‚ç”¨MSVCï¼‰ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define  GET_MAX_ONCE(a,b) \
</span></span></span><span class="line"><span class="cl"><span class="cp">      ( {typeof(a) _a = (a);   \
</span></span></span><span class="line"><span class="cl"><span class="cp">         typeof(b) _b = (b);   \
</span></span></span><span class="line"><span class="cl"><span class="cp">         (_a) &gt; (_b) ? (_a) : (_b); } )</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="nf">GET_MAX</span><span class="p">(</span><span class="o">++</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">++</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;a = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, b = &#34;</span><span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, c = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="nf">GET_MAX_ONCE</span><span class="p">(</span><span class="o">++</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">++</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;a = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, b = &#34;</span><span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, c = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æµ‹è¯•ä»£ç è¾“å‡ºï¼š</p>
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">a</span> <span class="o">=</span> 11, <span class="nv">b</span> <span class="o">=</span> 22, <span class="nv">c</span> <span class="o">=</span> <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="nv">a</span> <span class="o">=</span> 11, <span class="nv">b</span> <span class="o">=</span> 21, <span class="nv">c</span> <span class="o">=</span> <span class="m">20</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ğŸ¤” <code>ä½¿ç”¨ __auto_type</code> æ¥å–ä»£æ—¶è¦èµ‹åˆå€¼ï¼Œå…³é”®çš„ typeof é‚£è¡Œç”¨æ³•æ”¹ä¸º<code>__auto_type _a = (a);</code> ã€‚
__auto_type æ¯” typeof çš„ä¼˜åŠ¿ä¹‹å¤„åœ¨äºé¢å¯¹å˜é•¿æ•°ç»„(VLA)ï¼Œåªè§£æ1æ¬¡ï¼›ä»¥åŠé¢å¯¹åµŒå¥—å®å®šä¹‰æ—¶ä¹Ÿæ˜¯åªä¸¥æ ¼è§£æä¸€æ¬¡ã€‚</p>
</blockquote>
</div>
    </div>
  </div></li>
</ul>
<h3 id="r03-å°½å¯èƒ½ç”¨const">R03 å°½å¯èƒ½ç”¨const</h3>
<p>è¯´èµ·constï¼Œå…ˆå¤ä¹ ä¸ªé¢è¯•é«˜é¢‘é¢˜ğŸ˜</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//ç±»å‹charåœ¨å“ªé‡Œæ²¡å…³ç³»ï¼Œå…³é”®çœ‹constå’Œ*çš„ç›¸å¯¹ä½ç½®ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//conståœ¨*å·¦è¾¹ï¼ŒæŒ‡é’ˆæ‰€æŒ‡ç‰©ä¸ºå¸¸é‡;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//conståœ¨*å³è¾¹ï¼ŒæŒ‡é’ˆä¸ºå¸¸é‡ï¼›
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p</span><span class="p">;</span> <span class="c1">// æŒ‡é’ˆpæ‰€æŒ‡çš„å­—ç¬¦ä¸²ä¸ºå¸¸é‡ï¼Œä½†æ˜¯på¯ä»¥ä¿®æ”¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">char</span><span class="o">*</span> <span class="k">const</span> <span class="n">p</span><span class="p">;</span> <span class="c1">// æŒ‡é’ˆpæ˜¯å¸¸é‡ï¼ŒæŒ‡å‘çš„å­—ç¬¦ä¸²å¯ä¿®æ”¹
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>constä¿®é¥°å‡½æ•°è¿”å›å€¼æ—¶çš„é˜²å¾¡æ€§
constä¿®é¥°å‡½æ•°çš„è¿”å›å€¼ï¼Œå¯ä»¥é¿å…ä¸€äº›é”™è¯¯ï¼Œå¦‚ä¸‹ï¼š
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">Rational</span> <span class="k">operator</span><span class="o">*</span> <span class="p">(</span><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span><span class="k">const</span> <span class="n">Rational</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//å­˜åœ¨Rational a,b,c;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span> <span class="c1">//ä¾‹å¦‚æ‰‹è¯¯ &#34;==&#34;æ‰“æˆäº†&#34;=&#34;ï¼Œç¼–è¯‘å™¨ä¼šç›´æ¥æŠ¥é”™
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>constæˆå‘˜å‡½æ•°çš„é™åˆ¶
constæˆå‘˜å‡½æ•°æœ‰2ä¸ªå¥½å¤„ï¼š(1). æ˜ç¡®ç†è§£å‡½æ•°æ˜¯å¦ä¿®æ”¹å¯¹è±¡å†…å®¹ï¼›(2). ä½¿â€œæ“ä½œconstå¯¹è±¡â€æˆä¸ºå¯èƒ½ã€‚
å¯ä»¥é€šè¿‡constç‰¹æ€§è®©å¯¹è±¡è‡ªåŠ¨è°ƒç”¨æ­£ç¡®çš„ç‰ˆæœ¬ï¼š
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TextBlock</span><span class="p">{</span><span class="c1">//...ç±»å…¶ä»–éƒ¨åˆ†çœç•¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">const</span> <span class="kt">char</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">index</span><span class="p">)</span> <span class="k">const</span><span class="p">{</span> <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">index</span><span class="p">];}</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="n">std</span><span class="o">::</span><span class="n">size_t</span> <span class="n">index</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">index</span><span class="p">];}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="k">const</span> <span class="n">TextBlock</span><span class="o">&amp;</span> <span class="n">ctb</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ctb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">;</span><span class="c1">//æ ¹æ®constç‰¹æ€§ï¼Œè°ƒç”¨ const TextBlock::operator[]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>æ€è€ƒï¼šconstæˆå‘˜å‡½æ•°ä¸ä¿®æ”¹æˆå‘˜å¯¹è±¡ï¼Œé‚£ä¹ˆï¼Œå¦‚æœæˆå‘˜å¯¹è±¡ä¸ºæŒ‡é’ˆ<code>char *p</code>ï¼Œä»…ä¿®æ”¹<code>p</code>æŒ‡å‘çš„å†…å®¹ï¼Œé‚£å®ƒè¿˜æ˜¯<code>const</code>æˆå‘˜å‡½æ•°å—ï¼Ÿ
å®æµ‹ï¼šconstæˆå‘˜å‡½æ•°æ˜¯å…è®¸<code>p[2]= 'x'</code>è¿™ä¸€æ“ä½œçš„ï¼Œä½†æ˜¯ä¸å…è®¸p++ï¼›
<ul>
<li><code>bitwise-constness</code>(åˆç§°ä¸ºphysical constness)ç†å¿µè®¤ä¸ºä¸æ˜¯ï¼Œä¸èƒ½æ›´æ”¹ä»»ä½•å¯¹è±¡å†…çš„ä»»ä½•ä¸€ä¸ªbitã€‚è¿™ç§è¯´æ³•ä¹Ÿæœ‰çº°æ¼ï¼Œconstå‡½æ•°è¿”å›ä¸€ä¸ªå¼•ç”¨å°±å¤±æ§äº†,å¤–éƒ¨å¯æ”¹ï¼›</li>
<li><code>logical-constness</code>ç†å¿µåˆ™å…è®¸constæˆå‘˜å‡½æ•°ä¿®æ”¹æˆå‘˜å˜é‡çš„bitsï¼Œä½†åªæœ‰åœ¨å®¢æˆ·ç«¯ä¾¦æµ‹ä¸å‡ºçš„æƒ…å†µä¸‹;</li>
<li><code>constæˆå‘˜å‡½æ•°</code>å¦‚æœä¸€å®šè¦ä¿®æ”¹æˆå‘˜å˜é‡ï¼Œæˆå‘˜å˜é‡ä½¿ç”¨ <code>mutable</code> ä¿®é¥°å³å¯.</li>
</ul>
</li>
<li>constä¸non-constçš„æˆå‘˜å‡½æ•°å®ç°å®Œå…¨ç›¸åŒæ—¶
è¿™ç§æƒ…å†µï¼Œå¦‚ä½•å»é™¤ä»£ç å†—ä½™æ˜¯ä¸ªé—®é¢˜ã€‚ä¸è¦å°è£…å‡ºä¸€ä¸ªprivateå‡½æ•°ç„¶åä¸€èµ·è°ƒç”¨ï¼Œå¤šäº†å±‚è°ƒç”¨ã€‚
æ­£ç¡®åšæ³•ğŸ‘‰ <code>ä½¿ç”¨è½¬å‹,è®©non-constè°ƒç”¨constæˆå‘˜å‡½æ•°</code>ï¼Œå¦‚ä¸‹ä¸ºç¤ºä¾‹ï¼š</li>
</ul>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Rawdata</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Rawdata</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span><span class="o">:</span><span class="n">p_</span><span class="p">(</span><span class="n">src</span><span class="p">),</span><span class="n">length_</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">src</span><span class="p">))</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">GetLength</span><span class="p">()</span><span class="k">const</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">p_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span><span class="c1">//ä¸ºæ±‚ç®€ä¾¿,ä¸ä½œæ£€æŸ¥äº†ã€‚p_å†…å®¹ä¿®æ”¹ç¼–è¯‘å™¨æ˜¯å…è®¸çš„.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">length_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="nf">GetLength</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">const_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&amp;&gt;</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">Rawdata</span><span class="o">&amp;&gt;</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)).</span><span class="n">GetLength</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="o">*</span><span class="n">p_</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">length_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="r04-ç¡®å®šå¯¹è±¡ä½¿ç”¨å‰å…ˆåˆå§‹åŒ–">R04 ç¡®å®šå¯¹è±¡ä½¿ç”¨å‰å…ˆåˆå§‹åŒ–</h3>
<p>åˆ†æ¸…&quot;èµ‹å€¼&quot;å’Œ&quot;åˆå§‹åŒ–&quot;ï¼Œåœ¨ç±»çš„æ„é€ å‡½æ•°ä½“å†…ä½¿ç”¨ç­‰å·&quot;=&ldquo;èµ‹å€¼å¹¶é&quot;åˆå§‹åŒ–â€ã€‚æˆå‘˜å˜é‡çš„åˆå§‹åŒ–æ˜¯åœ¨æ„é€ å‡½æ•°çš„<u>æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨</u>å®ç°ï¼Œæ•ˆç‡æ›´é«˜ã€‚</p>
<p><code>C++åˆå§‹åŒ–çš„æ¬¡åº:</code></p>
<ol>
<li>Base classæ€»æ˜¯æ—©äºDerived Classè¢«åˆå§‹åŒ–ï¼›</li>
<li>Classå†…çš„æˆå‘˜å˜é‡æ€»æ˜¯ä»¥å£°æ˜æ¬¡åºè¢«åˆå§‹åŒ–ï¼›
ä¸¾ä¾‹: ä¸‹å›¾ä¸­çš„ä»£ç åˆå§‹åŒ–é¡ºåºä¸ºå£°æ˜é¡ºåº&quot;age_$\rightarrow$name_$\rightarrow$gender_ $\rightarrow$isVip_&rdquo;
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"> <span class="k">class</span> <span class="nc">Customer</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="k">public</span><span class="o">:</span> <span class="c1">//è¿™é‡Œåªæ˜¯ä¸ºäº†éªŒè¯ï¼Œå¦‚æœæ˜¯å®é™…å·¥ç¨‹ä»£ç ï¼Œå»ºè®®åˆå€¼åˆ—è¡¨å°½é‡å’Œå£°æ˜é¡ºåºä¿æŒä¸€è‡´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">Customer</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">gender</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">age</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isVip</span> <span class="o">=</span> <span class="nb">false</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="o">:</span><span class="n">isVip_</span><span class="p">(</span><span class="n">isVip</span><span class="p">),</span> <span class="n">gender_</span><span class="p">(</span><span class="n">gender</span><span class="p">),</span> <span class="n">name_</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">age_</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"> <span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">     <span class="kt">uint8_t</span> <span class="n">age_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">gender_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="kt">bool</span> <span class="n">isVip_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><pre><code>ğŸ’¡ï¼šä»»ä½•ä¸€ä¸ªæˆå‘˜å˜é‡açš„åˆå§‹åŒ–æµç¨‹ï¼šç±»å†…å£°æ˜èµ‹åˆå€¼(C++11)-&gt;æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨-&gt;æ„é€ å‡½æ•°ä½“å†…èµ‹å€¼.
</code></pre>
</div>
    </div>
  </div></li>
<li>å‡½æ•°ä½“å¤–staticå˜é‡ç§°ä¸º<code>non-local static</code>å˜é‡ï¼Œè¿™ç§å˜é‡å¯ä»¥åœ¨å„è‡ªçš„ç¼–è¯‘å•å…ƒæ­£å¸¸å·¥ä½œï¼Œä½†C++æ— æ³•ä¿è¯åˆå§‹åŒ–æ¬¡åºï¼Œå½“ç¼–è¯‘å•å…ƒä¹‹é—´éœ€è¦å…±äº«å˜é‡æ—¶ï¼Œè€Œè¯¥å˜é‡ä¾èµ–non-local staticï¼Œå°±å¯èƒ½ä¼šå‡ºé—®é¢˜ã€‚
<strong>è§£å†³åŠæ³•</strong>æ˜¯å°†è¿™æ ·çš„å˜é‡æ”¾å›å‡½æ•°ä½“å†…ï¼Œæˆä¸ºlocal staticï¼Œå› ä¸ºC++ç¡®ä¿åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ä¸€å®šä¼šåˆå§‹åŒ–è¿™ä¸ªstaticå˜é‡ã€‚</li>
</ol>
<h2 id="ch2æ„é€ ææ„èµ‹å€¼è¿ç®—">CH2.æ„é€ /ææ„/èµ‹å€¼è¿ç®—</h2>
<h3 id="r05-äº†è§£cé»˜è®¤ç¼–å†™å¹¶è°ƒç”¨å“ªäº›å‡½æ•°">R05 äº†è§£C++é»˜è®¤ç¼–å†™å¹¶è°ƒç”¨å“ªäº›å‡½æ•°</h3>
<p>ç¼–è¯‘å™¨å¯ä»¥æš—è‡ªä¸ºClassåˆ›å»º<code>defaultæ„é€ å‡½æ•°</code>ï¼Œ<code>copyæ„é€ å‡½æ•°(å¤åˆ¶æ„é€ )</code>ï¼Œ<code>copy assigment(èµ‹å€¼æ„é€ )æ“ä½œç¬¦</code>ï¼Œä»¥åŠ<code>defaultææ„å‡½æ•°</code>ã€‚</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">EmptyClass</span><span class="p">{};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç­‰ä»·äº:</p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">EmptyClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">EmptyClass</span><span class="p">()</span> <span class="p">{}</span>        <span class="c1">// defaultæ„é€ å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">EmptyClass</span><span class="p">(</span><span class="k">const</span> <span class="n">EmptyClass</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="p">{}</span><span class="c1">//copyæ„é€ å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">~</span><span class="n">EmptyClass</span><span class="p">()</span> <span class="p">{}</span><span class="c1">//defaultææ„å‡½æ•°ï¼Œæ³¨æ„æ˜¯non-virtual
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">EmptyClass</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">EmptyClass</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="p">{}</span><span class="c1">//copy assignmentæ“ä½œç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>å¦‚æœä¸€ä¸ªéç©ºClassè‡ªè¡Œå£°æ˜äº†æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨å°±ä¸å†ä¸ºå®ƒåˆ›å»ºdefaultæ„é€ å‡½æ•°;</p>
</li>
<li>
<p>å¦‚æœä¸€ä¸ªClasså†…æœ‰å¼•ç”¨å˜é‡æˆ–constå˜é‡ï¼Œç¼–è¯‘å™¨ä¸ä¼šä¸ºå…¶ç”Ÿæˆcopy-assignmentå‡½æ•°ï¼Œéœ€è¦è‡ªå·±å®ç°.</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">NameObject</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">NameObject</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">name</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">value</span><span class="p">)</span> <span class="o">:</span><span class="n">nameValue_</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">objectVal_</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">nameValue_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="kt">int</span> <span class="n">objectVal_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span><span class="c1">//è€ƒè™‘ä»¥ä¸‹åº”ç”¨ä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">(</span><span class="s">&#34;Mike&#34;</span><span class="p">),</span> <span class="n">name2</span><span class="p">(</span><span class="s">&#34;Nicky&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">NameObject</span> <span class="nf">nObj</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span> <span class="n">nObj2</span><span class="p">(</span><span class="n">name2</span><span class="p">,</span><span class="mi">33</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">nObj2</span> <span class="o">=</span> <span class="n">nObj</span><span class="p">;</span><span class="c1">//è¿™ä¸€å¥ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼Œå› ä¸ºå¼•ç”¨ä¸èƒ½æŒ‡å‘2ä¸ªå¯¹è±¡ï¼Œä¸”constä¸å¯æ”¹
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="r06-ä¸æƒ³ç¼–è¯‘å™¨çš„è‡ªåŠ¨ç”Ÿæˆçš„å‡½æ•°æ˜ç¡®æ‹’ç»">R06 ä¸æƒ³ç¼–è¯‘å™¨çš„è‡ªåŠ¨ç”Ÿæˆçš„å‡½æ•°,æ˜ç¡®æ‹’ç»</h3>
<p>æŸäº›åœºæ™¯ï¼Œç±»å¯¹è±¡æœ¬èº«æ˜¯è®¤ä¸ºç‹¬ä¸€æ— äºŒçš„ï¼Œæ¯”å¦‚æè¿°äººç‰©æ€§æ ¼çš„ç±»Personality(å¯èƒ½ä¸æ°å½“)ï¼Œä¸åŒçš„äººæ€§æ ¼ä¸åŒï¼Œè‚¯å®šæ˜¯ä¸å¸Œæœ›èƒ½å¤åˆ¶/èµ‹å€¼çš„ã€‚
å¦‚æœä¸æƒ³ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆé‚£å‡ ä¸ªå‡½æ•°ï¼Œæ¯”å¦‚ä¸æƒ³è¦å¤åˆ¶æ„é€ æˆ–èµ‹å€¼æ„é€ ï¼Œå°±æ˜ç¡®åœ¨ä»£ç ä¸­ç¦æ­¢ï¼Œä¹Ÿé˜²æ­¢å¤–éƒ¨ç”¨æˆ·ä½¿ç”¨ã€‚</p>
<ul>
<li>æŠ€å·§1ï¼šå¯ä»¥å£°æ˜ä¸ºprivateå‡½æ•°ä½†æ˜¯ä¸ç»™å‡ºå®ç°ï¼Œè®©ç¼–è¯‘å™¨æŠ¥é”™ï¼›</li>
<li>æŠ€å·§2ï¼šå¯ä»¥è®¾ç«‹åŸºç±»Baseï¼Œè®©å¤åˆ¶æ„é€ å’Œèµ‹å€¼æ„é€ éƒ½ä¸ºprivateå‡½æ•°ï¼Œè®©ç›®æ ‡ç±»ç»§æ‰¿äºBaseç±»ã€‚</li>
</ul>
<div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>C++11é’ˆå¯¹æ­¤ç±»æƒ…å†µï¼Œç»™äºˆäº†deleteå…³é”®å­—ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œåœ¨æˆå‘˜å‡½æ•°åé¢æ–°å¢&quot;=delete&quot;ï¼Œå³å¯æ˜¾å¼åœ°æ‹’ç»è¿™ä¸ªå‡½æ•°çš„ç”Ÿæˆå’Œè°ƒç”¨.ä¸¾ä¾‹å¦‚ä¸‹:</p>
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="p">(</span><span class="k">const</span> <span class="n">A</span><span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span> <span class="c1">// æ‹·è´æ„é€ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">A</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">A</span><span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span> <span class="c1">// æ‹·è´èµ‹å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>
<h3 id="r07-ä¸ºå¤šæ€åŸºç±»å£°æ˜virtualææ„å‡½æ•°">R07 ä¸ºå¤šæ€åŸºç±»å£°æ˜<code>virtual</code>ææ„å‡½æ•°</h3>
<ul>
<li>é’ˆå¯¹<code>Base* pBase= new DerivedObj()</code>ï¼Œé‡Šæ”¾pBaseæ—¶ï¼Œå¦‚æœBaseåŸºç±»çš„ææ„å‡½æ•°<code>None-Virtual</code>ï¼Œåˆ™ä¼šå¯¼è‡´Derivedçš„ææ„å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨ï¼Œé€ æˆ<code>å†…å­˜ä¸å®Œå…¨é‡Šæ”¾</code>ï¼Œå³å†…å­˜æ³„æ¼ï¼›</li>
<li>Non-Virtualçš„Classä¸è¦åšåŸºç±»ï¼›</li>
<li>å¦‚æœä¸åšåŸºç±»ï¼Œå°±ä¸è¦å£°æ˜ææ„å‡½æ•°ä¸ºvirtualå‡½æ•°ï¼Œé¿å…è™šè¡¨ä¸ºå…¶åˆ†é…vptré€ æˆæµªè´¹ï¼›</li>
<li>å¦‚æœæƒ³è¦æŠ½è±¡ç±»ï¼Œåˆæš‚æ—¶æ²¡æœ‰åˆé€‚æ¥å£ï¼Œå¯ä»¥è®©å…ˆè™šææ„æˆä¸ºçº¯è™šå‡½æ•°ï¼Œä¾‹å¦‚
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">RawData</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="o">~</span><span class="n">RawData</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">// è¿™é‡Œç‰¹æ®Šçš„æ˜¯ï¼Œéœ€è¦ä¸ºè¿™ä¸ªçº¯è™šå‡½æ•°æä¾›å®šä¹‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">~</span><span class="n">RawData</span><span class="o">::</span><span class="n">RawData</span><span class="p">(){}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="r08-åˆ«è®©å¼‚å¸¸é€ƒç¦»ææ„å‡½æ•°">R08 åˆ«è®©å¼‚å¸¸é€ƒç¦»ææ„å‡½æ•°</h3>
<ul>
<li>
<p>ææ„å‡½æ•°æœ€å¥½ä¸è¦åå‡ºå¼‚å¸¸</br>
å¯¹äºæŸä¸ªWidgetç±»ï¼Œå¦‚æœææ„å‡½æ•°æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆ<code>vector&lt;widget&gt;</code>ææ„æ—¶å¯èƒ½è¿ç»­æŠ›å‡ºå¤šä¸ªå¼‚å¸¸ä»¥è‡³äºæ— æ³•å¤„ç†ï¼Œç›´æ¥å¯¼è‡´æå‰ç¨‹åºç»“æŸæˆ–è€…æœªå®šä¹‰è¡Œä¸ºã€‚</p>
</li>
<li>
<p>å¦‚æœæœ‰æŸä¸ªå‡½æ•°å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¹¶éœ€è¦å¯¹å¼‚å¸¸åšå‡ºååº”ï¼Œåº”è¯¥æä¾›ä¸€ä¸ªéææ„çš„å‡½æ•°æ¥å¤„ç†</br>
æ³¨æ„ï¼Œåœ¨ææ„ä¸­æŠ›å¼‚å¸¸å¹¶åä¸‹(catchågo-on-execute)ï¼Œä¼šæ©ç›–é”™è¯¯ï¼Œä¹Ÿä¸æ˜¯ä¸ªå¥½åŠæ³•;æŠ›å¼‚å¸¸åcatchä½å¹¶std::abort()åè€Œå¯ä»¥æå‰ç»ˆç»“ã€æœªå®šä¹‰è¡Œä¸ºã€ã€‚</p>
</li>
</ul>
<h3 id="r09-ç»ä¸åœ¨æ„é€ å’Œææ„è¿‡ç¨‹ä¸­è°ƒç”¨virtualå‡½æ•°">R09 ç»ä¸åœ¨æ„é€ å’Œææ„è¿‡ç¨‹ä¸­è°ƒç”¨<code>virtual</code>å‡½æ•°</h3>
<ul>
<li>åœ¨Derived-Classçš„Base-Classæ„é€ æœŸé—´ï¼Œå¯¹è±¡çš„ç±»å‹æ˜¯Base-Classï¼Œè€ŒéDerivedï¼Œå³ä½¿<code>dynamic_cast</code>ä¹Ÿæ˜¯è¿™æ ·è®¤ä¸ºçš„ï¼Œå› ä¸ºæ­¤æ—¶virtualå‡½æ•°ä¸ä¼šä¸‹é™åˆ°Derived-Classçš„é˜¶å±‚ï¼›æ¢å¥è¯è¯´==&gt; â€œ<code>åœ¨Base-Classæ„é€ æœŸé—´ï¼Œvirtualå‡½æ•°ä¸æ˜¯virtualå‡½æ•°</code>â€ï¼›</li>
<li>åœ¨ææ„çš„æ—¶å€™ä¹Ÿæ˜¯ç±»ä¼¼é“ç†ï¼Œä¹Ÿä¸è¦åœ¨ææ„å‡½æ•°ä¸­è°ƒç”¨virtualå‡½æ•°ï¼Œé—´æ¥è°ƒç”¨ä¹Ÿä¸è¡Œ(æ¯”å¦‚non-Virtual-&gt;virtual)ï¼›</li>
<li>é‚£ä¹ˆæ›¿ä»£æ–¹æ¡ˆæ˜¯ï¼Ÿ</br>
å¦‚æœæœ‰è¿™æ ·ä¸€ç§æƒ…å†µï¼Œå¸Œæœ›åœ¨å­ç±»æ„é€ æ—¶èƒ½è°ƒç”¨çˆ¶ç±»çš„fooå‡½æ•°(ä¸‹æ–¹logTransactionå‡½æ•°)ï¼Œé‚£ä¹ˆå°†fooæ”¹ä¸ºnon-Virtualå‡½æ•°ï¼Œå¹¶ä¸”å­ç±»æ„é€ æ—¶è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œæœ‰å‚æ•°æ—¶ä¸€å¹¶ä¼ è¿‡å»ï¼›</li>
</ul>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Transaction</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">explict</span> <span class="n">Transaction</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">info</span><span class="p">,</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span><span class="o">:</span><span class="n">id_</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span> <span class="n">logTransaction</span><span class="p">(</span><span class="n">info</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">logTransaction</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">info</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">info</span><span class="p">.</span><span class="n">c_str</span><span class="p">();</span> <span class="p">}</span><span class="c1">//non-Virtualå‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">id_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BuyTransaction</span> <span class="o">:</span><span class="k">public</span> <span class="n">Transaction</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>  <span class="c1">//å°†logä¿¡æ¯ä¼ é€’ç»™ åŸºç±»Transactionæ„é€ å‡½æ•°ï¼› å¹¶åˆå§‹åŒ–äº†åŸºç±»æˆå‘˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">BuyTransaction</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">info</span><span class="p">,</span> <span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">:</span><span class="n">Transaction</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span><span class="cm">/**/</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition Note open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>By the way<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œå¦‚æœæœ‰å‡ ä¸ªBaseæ„é€ å‡½æ•°ï¼Œå°±å¾—å†™å‡ ä¸ªDerivedæ„é€ å‡½æ•°ä¼ å‚ã€‚ä¸ºäº†ç®€åŒ–è¿™ä¸€æ­¥éª¤ï¼Œ åœ¨ç°ä»£C++11ï¼Œæ¨å‡ºäº†ç»§æ‰¿æ„é€ å‡½æ•°(Inheriting Constructor)ï¼Œå­ç±»å¯ä»¥ä¸€ä¸ªéƒ½ä¸ç”¨å†™ï¼Œç›´æ¥å†™ä¸€å¥usingå£°æ˜å³å¯ï¼Œä½¿ç”¨<code>using BaseClass::BaseClass</code>çš„å½¢å¼ï¼Œå¦‚ä¸‹ğŸ‘‡</p>
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BuyTransaction</span> <span class="o">:</span><span class="k">public</span> <span class="n">Transaction</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">using</span> <span class="n">Transaction</span><span class="o">::</span><span class="n">Transaction</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//å…¶ä»–
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>
<h3 id="r10-ä»¤operatorè¿”å›ä¸€ä¸ªreference-to-this">R10 ä»¤<code>operator=</code>è¿”å›ä¸€ä¸ªreference to *this</h3>
<ul>
<li>å…³äºèµ‹å€¼æ“ä½œç¬¦<code>operator=</code>ï¼Œä¸»æµåšæ³•æ˜¯:
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Widget</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Widget</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">Widget</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//... do some thing
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div>ä¸Šè¿°åšæ³•ä¸å±€é™äºoperator=ï¼Œè¿˜æœ‰<code>operator += ,-=,*=,/=</code>ç­‰å…¶ä»–èµ‹å€¼è¿ç®—ç¬¦ã€‚</br>
è¯¥ä¸»æµåè®®/åšæ³•ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œåªæ˜¯ä¸ªå»ºè®®ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥å…è®¸<strong>è¿ç»­èµ‹å€¼</strong>($x=y=z$çš„å½¢å¼)ã€‚</br>
è¯¥åè®®è¢«å†…ç½®ç±»å‹ï¼Œä»¥åŠSTLçš„ç±»å‹(å¦‚string,vector,complex,shared_ptr)å…±åŒéµå®ˆã€‚</br></li>
</ul>
<h2 id="r11-åœ¨operatorä¸­å¤„ç†è‡ªæˆ‘èµ‹å€¼">R11 åœ¨<code>operator=</code>ä¸­å¤„ç†&quot;è‡ªæˆ‘èµ‹å€¼&quot;</h2>
<p>ä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™è‡ªå·±ï¼Œè¿™ç§çœ‹èµ·æ¥æœ‰ç‚¹å‚»çš„åšæ³•ï¼Œæœ‰æ—¶å€™ä¼šæ¯”è¾ƒéš¾ä»¥å‘è§‰ã€‚æ¯”å¦‚ï¼š<code>a[i] = a[j]</code>ï¼Œå¦‚æœ $i$ å’Œ $j$ ç›¸ç­‰ï¼Œå°±æ˜¯â€œè‡ªæˆ‘èµ‹å€¼â€çš„ç»å…¸åœºæ™¯äº†ã€‚
æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå°½é‡å®Œå¤‡çš„èµ‹å€¼æ“ä½œç¬¦å‡½æ•°ğŸ¤”ã€‚
è€ƒè™‘å¦‚ä¸‹ç±»<code>MapWidget</code>ï¼Œå†…æœ‰æ•°æ®è£¸æŒ‡é’ˆ<code>BitMap *pb_</code>ï¼Œåœ¨èµ‹å€¼æ—¶åŒæ—¶è€ƒè™‘<strong>å¼‚å¸¸å®‰å…¨</strong>å’Œ <strong>â€œè‡ªæˆ‘èµ‹å€¼â€</strong> å®‰å…¨(è®¤åŒæµ‹è¯•ä¿éšœè‡ªæˆ‘èµ‹å€¼å®‰å…¨)ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹ä¸é”™çš„å®ç°ã€‚ä½†æ˜¯ï¼Œè®¤åŒæµ‹è¯•ä¼šé™ä½è¿è¡Œæ•ˆç‡ï¼Œæ ¹æ®å®é™…å·¥ç¨‹å®è·µæƒ…å†µ(è‡ªæˆ‘èµ‹å€¼æ¦‚ç‡æä½ )å¯ä»¥é…Œæƒ…å»æ‰ã€‚</p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BitMap</span> <span class="p">{</span><span class="cm">/*çœç•¥ç±»å£°æ˜&amp;å®ç°*/</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MapWidget</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">BitMap</span> <span class="o">*</span> <span class="n">pb_</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">explicit</span> <span class="n">MapWidget</span><span class="p">(</span><span class="n">BitMap</span> <span class="o">*</span><span class="n">pb</span><span class="p">)</span> <span class="o">:</span><span class="n">pb_</span><span class="p">(</span><span class="n">pb</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="n">MapWidget</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">MapWidget</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">==</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> <span class="c1">//è¿™ä¸€å¥ä¸ºè®¤åŒæµ‹è¯•(identity test)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">BitMap</span> <span class="o">*</span><span class="n">pOrig</span> <span class="o">=</span> <span class="n">pb_</span><span class="p">;</span><span class="c1">//ä¸è¦ä¸€ä¸Šæ¥å°±deleteï¼Œè€Œæ˜¯ä¿å­˜this-&gt;pb_
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">pb_</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BitMap</span><span class="p">(</span><span class="o">*</span><span class="n">rhs</span><span class="p">.</span><span class="n">pb_</span><span class="p">);</span><span class="c1">//å› ä¸ºè¿™ä¸€å¥å¯èƒ½æŠ›å¼‚å¸¸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">delete</span> <span class="n">pOrig</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Copy and SwapæŠ€æœ¯ ä¸Šæ–‡ä¸­ä¿éšœ<strong>å¼‚å¸¸å®‰å…¨</strong>å’Œ **â€œè‡ªæˆ‘èµ‹å€¼â€**å®‰å…¨çš„æŠ€æœ¯æ‰‹æ®µï¼Œå¦å¤–ä¸€ä¸ªåŠæ³•ï¼Œå°±æ˜¯Copy and SwapæŠ€æœ¯ã€‚è¿™ä¸ªæŠ€æœ¯çš„å…³é”®åœ¨äºâ€œä¿®æ”¹å¯¹è±¡æ•°æ®çš„å‰¯æœ¬ï¼Œç„¶ååœ¨ä¸€ä¸ªä¸æŠ›å¼‚å¸¸çš„å‡½æ•°ä¸­å°†ä¿®æ”¹çš„æ•°æ®å’ŒåŸä»¶ç½®æ¢ â€ã€‚
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">MapWidget</span><span class="o">::</span><span class="n">Swap</span><span class="p">(</span><span class="n">MapWidget</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">){</span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">rhs</span><span class="p">.</span><span class="n">pb_</span><span class="p">,</span><span class="n">pb_</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl"><span class="n">MapWidget</span><span class="o">&amp;</span> <span class="n">MapWidget</span><span class="o">::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">MapWidget</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">MapWidget</span> <span class="nf">temp</span><span class="p">(</span><span class="n">rhs</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Swap</span><span class="p">(</span><span class="n">temp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="r12-å¤åˆ¶å¯¹è±¡æ—¶åˆ«å¿˜è®°å…¶æ¯ä¸€ä¸ªæˆåˆ†">R12 å¤åˆ¶å¯¹è±¡æ—¶åˆ«å¿˜è®°å…¶æ¯ä¸€ä¸ªæˆåˆ†</h3>
<ul>
<li>
<p>ç¼–å†™ç±»çš„Copyingå‡½æ•°æ—¶éœ€è¦åšåˆ°2ç‚¹
è¿™é‡Œçš„Copyingå‡½æ•°æ˜¯æŒ‡æœ‰copyå±æ€§çš„ç‰¹æ®Šå‡½æ•°==&gt; copyæ„é€ å‡½æ•°å’Œcopyèµ‹å€¼æ“ä½œç¬¦ã€‚</p>
<ol>
<li>å¤åˆ¶æ‰€æœ‰Localæˆå‘˜å˜é‡
å¦‚æœæˆå‘˜å¤åˆ¶çš„æ—¶å€™æœ‰é—æ¼ï¼Œç¼–è¯‘å™¨å¹¶ä¸ä¼šæœ‰æ€¨è¨€ï¼Œè¿™å°±åŸ‹ä¸‹äº†éšæ‚£ã€‚å¦‚æœæ–°å¢äº†æˆå‘˜ï¼Œè¦å¯¹åº”ä¿®æ”¹Copyingå‡½æ•°ã€‚</li>
<li>è°ƒç”¨æ‰€æœ‰Base-Classå†…éƒ¨çš„é€‚å½“çš„Copyå‡½æ•°
å…·ä½“ä»£ç çš„æ¨èå®ç° å¦‚ä¸‹ğŸ‘‡ï¼š</li>
</ol>
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Customer</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Customer</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">float</span> <span class="n">money</span><span class="p">)</span><span class="o">:</span><span class="n">name_</span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="n">money_</span><span class="p">(</span><span class="n">money</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">money_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">VipCustomer</span> <span class="o">:</span><span class="k">public</span> <span class="n">Customer</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>  <span class="c1">//æ³¨æ„ï¼šæ´¾ç”Ÿç±»è¦å¤åˆ¶åŸºç±»é‚£éƒ¨åˆ†çš„æˆå‘˜å˜é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">using</span> <span class="n">Customer</span><span class="o">::</span><span class="n">Customer</span><span class="p">;</span> <span class="c1">//å‚è€ƒR09
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">VipCustomer</span><span class="p">(</span><span class="k">const</span> <span class="n">VipCustomer</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">:</span><span class="n">priority_</span><span class="p">(</span><span class="n">rhs</span><span class="p">.</span><span class="n">priority_</span><span class="p">),</span><span class="n">Customer</span><span class="p">(</span><span class="n">rhs</span><span class="p">){}</span>
</span></span><span class="line"><span class="cl">    <span class="n">VipCustomer</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">VipCustomer</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">Customer</span><span class="o">::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">rhs</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">priority_</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">.</span><span class="n">priority_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">setPriority</span><span class="p">(</span><span class="kt">int</span> <span class="n">priority</span><span class="p">)</span> <span class="p">{</span> <span class="n">priority_</span> <span class="o">=</span> <span class="n">priority</span><span class="p">;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">priority_</span><span class="p">;</span><span class="c1">//å­ç±»ç‹¬æœ‰æˆå‘˜å¯ä»¥å•ç‹¬setå‡½æ•°èµ‹å€¼ï¼Œæˆ–è€…æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨èµ‹å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ä¸è¦ç”¨ä¸€ä¸ªCopyingå‡½æ•°å»å®ç°å¦ä¸€ä¸ª
ä»¤copy-assignmentæ“ä½œç¬¦è°ƒç”¨copyæ„é€ å‡½æ•°æ˜¯ä¸åˆç†çš„ï¼›åä¹‹ï¼Œåè€…è°ƒç”¨å‰è€…ä¹Ÿæ˜¯æ— æ„ä¹‰çš„ã€‚ å¦‚æœ2è€…æœ‰å¤§é‡çš„ä»£ç æ˜¯ç›¸åŒçš„ï¼Œå¯ä»¥å‰¥ç¦»ä¸€ä¸ªç±»å†…privateç±»å‹çš„<code>init</code>å‡½æ•°å‡ºæ¥ï¼Œæä¾›ç»™ä¸Šè¿°2è€…è°ƒç”¨ã€‚</p>
</li>
</ul>
<p>ref:</br>
[1]. <a href="https://blog.csdn.net/cltcj/category_12098441.html"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/cltcj/category_12098441.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
[2]. <a href="https://kissingfire123.github.io/2021/12/06_effective-c-%e4%b9%8b%e5%ad%a6%e4%b9%a0%e6%80%bb%e7%bb%93%e4%b8%80/"target="_blank" rel="external nofollow noopener noreferrer">https://kissingfire123.github.io/2021/12/06_effective-c-%e4%b9%8b%e5%ad%a6%e4%b9%a0%e6%80%bb%e7%bb%93%e4%b8%80/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></p>]]></description></item><item><title>Effective STL [8] | æ°¸ä¸å»ºç«‹auto_ptrçš„å®¹å™¨</title><link>https://jianye0428.github.io/posts/clause_8/</link><pubDate>Thu, 27 Jul 2023 07:45:11 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/clause_8/</guid><description><![CDATA[<!-- <div class="details admonition quote">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>quote<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">note abstract info tip success question warning failure danger bug example quote</div>
    </div>
  </div> -->
<h2 id="æ‹·è´ä¸€ä¸ªauto_ptrå°†æ”¹å˜å®ƒçš„å€¼">æ‹·è´ä¸€ä¸ªauto_ptrå°†æ”¹å˜å®ƒçš„å€¼</h2>
<p>å½“ä½ æ‹·è´ä¸€ä¸ª<code>auto_ptr</code>æ—¶ï¼Œ<code>auto_ptr</code>æ‰€æŒ‡å‘å¯¹è±¡çš„æ‰€æœ‰æƒè¢«è½¬ç§»åˆ°æ‹·è´çš„<code>auto_ptr</code>ï¼Œè€Œè¢«æ‹·è´çš„<code>auto_ptr</code>è¢«è®¾ä¸º<code>NULL</code>ã€‚</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Widget</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">explicit</span> <span class="n">Widget</span><span class="p">(</span><span class="kt">int</span> <span class="n">in</span><span class="p">)</span> <span class="o">:</span> <span class="n">randy</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">  <span class="kr">inline</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="n">Widget</span><span class="o">&amp;</span> <span class="n">in</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">randy</span> <span class="o">&lt;</span> <span class="n">in</span><span class="p">.</span><span class="n">randy</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">randy</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">pw1</span><span class="p">(</span><span class="k">new</span> <span class="n">Widget</span><span class="p">);</span> <span class="c1">// pw1æŒ‡å‘ä¸€ä¸ªWidget
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">pw2</span><span class="p">(</span><span class="n">pw1</span><span class="p">);</span> <span class="c1">// pw2æŒ‡å‘pw1çš„Widget; pw1è¢«è®¾ä¸ºNULLã€‚ï¼ˆWidgetçš„æ‰€æœ‰æƒä»pw1è½¬ç§»åˆ°pw2ã€‚ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">pw1</span> <span class="o">=</span> <span class="n">pw2</span><span class="p">;</span> <span class="c1">// pw1ç°åœ¨å†æ¬¡æŒ‡å‘Widgetï¼› pw2è¢«è®¾ä¸ºNULL
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æœ‰æ„æ€çš„æ˜¯ï¼Œå¦‚æœä½ å»ºç«‹ä¸€ä¸ª<code>auto_ptr&lt;Widget&gt;</code>çš„<code>vector</code>ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªæŒ‡å‘çš„<code>Widget</code>çš„å€¼çš„å‡½æ•°å¯¹å®ƒè¿›è¡Œæ’åºï¼š</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">widgetAPCompare</span><span class="p">(</span><span class="k">const</span> <span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="o">*</span><span class="n">lhs</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">rhs</span><span class="p">;</span> <span class="c1">// å‡è®¾Widget å­˜åœ¨operator&lt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">w1</span><span class="p">(</span><span class="k">new</span> <span class="n">Widget</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">w2</span><span class="p">(</span><span class="k">new</span> <span class="n">Widget</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="n">widgets</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">w1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">widgets</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="n">auto_ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">widgets</span><span class="p">;</span> <span class="c1">// å»ºç«‹ä¸€ä¸ªvectorï¼Œç„¶åç”¨Widgetçš„auto_ptrå¡«å……å®ƒï¼›
</span></span></span><span class="line"><span class="cl"><span class="c1">// è®°ä½è¿™å°†ä¸èƒ½ç¼–è¯‘ï¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">sort</span><span class="p">(</span><span class="n">widgets</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">widgets</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">widgetAPCompare</span><span class="p">);</span><span class="c1">// æ’åºè¿™ä¸ªvector
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç å°†ä¸èƒ½ç¼–è¯‘</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">warning: â€˜template&lt;class&gt; class std::auto_ptrâ€™ is deprecated <span class="o">[</span>-Wdeprecated-declarations<span class="o">]</span>
</span></span><span class="line"><span class="cl">   <span class="m">30</span> <span class="p">|</span>   std::vector&lt;auto_ptr&lt;Widget&gt; &gt;
</span></span><span class="line"><span class="cl">      <span class="p">|</span>               ^~~~~~~~
</span></span><span class="line"><span class="cl">In file included from /usr/include/c++/9/memory:80,
</span></span><span class="line"><span class="cl">                 from temp.cpp:10:
</span></span><span class="line"><span class="cl">/usr/include/c++/9/bits/unique_ptr.h:53:28: note: declared here
</span></span><span class="line"><span class="cl">   <span class="m">53</span> <span class="p">|</span>   template&lt;typename&gt; class auto_ptr<span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">|</span>                            ^~~~~~~~
</span></span><span class="line"><span class="cl">temp.cpp:33:3: warning: â€˜template&lt;class&gt; class std::auto_ptrâ€™ is deprecated <span class="o">[</span>-Wdeprecated-declarations<span class="o">]</span>
</span></span><span class="line"><span class="cl">   <span class="m">33</span> <span class="p">|</span>   auto_ptr&lt;Widget&gt; w1<span class="o">(</span>new Widget<span class="o">(</span>3<span class="o">))</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">|</span>   ^~~~~~~~</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»æ¦‚å¿µä¸Šçœ‹æ‰€æœ‰ä¸œè¥¿ä¹Ÿéƒ½å¾ˆåˆç†ï¼Œä½†ç»“æœå´å®Œå…¨ä¸åˆç†ã€‚ä¾‹å¦‚ï¼Œåœ¨æ’åºè¿‡ç¨‹ä¸­widgetsä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªauto_ptrå¯èƒ½å·²ç»è¢«è®¾ä¸ºNULLã€‚</p>
<p>æ’åºè¿™ä¸ªvectorçš„è¡Œä¸ºå¯èƒ½å·²ç»æ”¹å˜äº†å®ƒçš„å†…å®¹ï¼</p>
<h2 id="å‰–æ">å‰–æ</h2>
<p>å®ç°<code>sort</code>çš„æ–¹æ³•æ˜¯ä½¿ç”¨äº†<strong>å¿«é€Ÿæ’åºç®—æ³•</strong>çš„æŸç§å˜ä½“ã€‚</p>
<p>æ’åºä¸€ä¸ªå®¹å™¨çš„<strong>åŸºæœ¬æ€æƒ³</strong>æ˜¯ï¼Œé€‰æ‹©å®¹å™¨çš„æŸä¸ªå…ƒç´ ä½œä¸ºâ€œä¸»å…ƒâ€ï¼Œç„¶åå¯¹å¤§äºå’Œå°äºæˆ–ç­‰äºä¸»å…ƒçš„å€¼è¿›è¡Œé€’å½’æ’åºã€‚</p>
<p>åœ¨sortå†…éƒ¨ï¼Œè¿™æ ·çš„æ–¹æ³•çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">RandomAccessIterator</span><span class="p">,</span> <span class="k">class</span> <span class="nc">Compare</span><span class="o">&gt;</span><span class="c1">// è¿™ä¸ªsortçš„å£°æ˜ç›´æ¥æ¥è‡ªäºæ ‡å‡†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="n">sort</span><span class="p">(</span><span class="n">RandomAccessIterator</span> <span class="n">first</span><span class="p">,</span> <span class="n">RandomAccessIterator</span> <span class="n">last</span><span class="p">,</span> <span class="n">Compare</span> <span class="n">comp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// è¿™ä¸ªtypedefåœ¨ä¸‹é¢è§£é‡Š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">typedef</span> <span class="k">typename</span> <span class="n">iterator_traits</span><span class="o">&lt;</span><span class="n">RandomAccessIterator</span><span class="o">&gt;::</span><span class="n">value_type</span> <span class="n">ElementType</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">RandomAccessIterator</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span> <span class="c1">// è®©iæŒ‡å‘ä¸»å…ƒ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">ElementType</span> <span class="n">pivotValue</span><span class="p">(</span><span class="o">*</span><span class="p">);</span> <span class="c1">// æŠŠä¸»å…ƒæ‹·è´åˆ°ä¸€ä¸ªå±€éƒ¨ä¸´æ—¶å˜é‡ä¸­ï¼›
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">...</span> <span class="c1">// wor
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æºç ä¸ºï¼š</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">_RandomAccessIterator</span><span class="p">,</span> <span class="k">typename</span> <span class="n">_Compare</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span>
</span></span><span class="line"><span class="cl"><span class="n">sort</span><span class="p">(</span><span class="n">_RandomAccessIterator</span> <span class="n">__first</span><span class="p">,</span> <span class="n">_RandomAccessIterator</span> <span class="n">__last</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="n">_Compare</span> <span class="n">__comp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// concept requirements
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">__glibcxx_function_requires</span><span class="p">(</span><span class="n">_Mutable_RandomAccessIteratorConcept</span><span class="o">&lt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">_RandomAccessIterator</span><span class="o">&gt;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">__glibcxx_function_requires</span><span class="p">(</span><span class="n">_BinaryPredicateConcept</span><span class="o">&lt;</span><span class="n">_Compare</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">typename</span> <span class="n">iterator_traits</span><span class="o">&lt;</span><span class="n">_RandomAccessIterator</span><span class="o">&gt;::</span><span class="n">value_type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">typename</span> <span class="n">iterator_traits</span><span class="o">&lt;</span><span class="n">_RandomAccessIterator</span><span class="o">&gt;::</span><span class="n">value_type</span><span class="o">&gt;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">__glibcxx_requires_valid_range</span><span class="p">(</span><span class="n">__first</span><span class="p">,</span> <span class="n">__last</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">__glibcxx_requires_irreflexive_pred</span><span class="p">(</span><span class="n">__first</span><span class="p">,</span> <span class="n">__last</span><span class="p">,</span> <span class="n">__comp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">std</span><span class="o">::</span><span class="n">__sort</span><span class="p">(</span><span class="n">__first</span><span class="p">,</span> <span class="n">__last</span><span class="p">,</span> <span class="n">__gnu_cxx</span><span class="o">::</span><span class="n">__ops</span><span class="o">::</span><span class="n">__iter_comp_iter</span><span class="p">(</span><span class="n">__comp</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸Šé¢ __gnu_cxx::__ops::__iter_comp_iter(__comp) çš„å®ç°å¦‚ä¸‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">_Compare</span><span class="p">,</span> <span class="k">typename</span> <span class="n">_Iterator</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">inline</span> <span class="n">_Iter_comp_to_iter</span><span class="o">&lt;</span><span class="n">_Compare</span><span class="p">,</span> <span class="n">_Iterator</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">__iter_comp_iter</span><span class="p">(</span><span class="n">_Iter_comp_iter</span><span class="o">&lt;</span><span class="n">_Compare</span><span class="o">&gt;</span> <span class="n">__comp</span><span class="p">,</span> <span class="n">_Iterator</span> <span class="n">__it</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">_Iter_comp_to_iter</span><span class="o">&lt;</span><span class="n">_Compare</span><span class="p">,</span> <span class="n">_Iterator</span><span class="o">&gt;</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">   <span class="n">_GLIBCXX_MOVE</span><span class="p">(</span><span class="n">__comp</span><span class="p">.</span><span class="n">_M_comp</span><span class="p">),</span> <span class="n">__it</span><span class="p">);</span> <span class="c1">// è¿™é‡Œæœ‰move
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å½“æ¶‰åŠ<code>iterator_traits&lt;RandomAccessIterator&gt;::value_type</code>æ—¶ï¼Œå¿…é¡»åœ¨å®ƒå‰é¢å†™ä¸Š<code>typename</code>ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª<strong>ä¾èµ–äºæ¨¡æ¿å‚æ•°ç±»å‹çš„åå­—</strong>ï¼Œåœ¨è¿™é‡Œæ˜¯<code>RandomAccessIterator</code>ã€‚</p>
<p>ä¸Šé¢ä»£ç ä¸­æ£˜æ‰‹çš„æ˜¯è¿™ä¸€è¡Œ:</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">ElementType</span> <span class="nf">pivotValue</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å› ä¸ºå®ƒæŠŠä¸€ä¸ªå…ƒç´ ä»ä¿å­˜çš„åŒºé—´æ‹·è´åˆ°å±€éƒ¨ä¸´æ—¶å¯¹è±¡ä¸­ã€‚</p>
<p>åœ¨ä¾‹å­é‡Œï¼Œè¿™ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª<code>auto_ptr&lt;Widget&gt;</code>ï¼Œæ‰€ä»¥è¿™ä¸ªæ‹·è´æ“ä½œé»˜é»˜åœ°æŠŠè¢«æ‹·è´çš„<code>auto_ptrâ€”â€”vector</code>ä¸­çš„é‚£ä¸ªâ€”â€”è®¾ä¸º<code>NULL</code>ã€‚</p>
<p>å¦å¤–ï¼Œå½“<code>pivotValue</code>å‡ºäº†ç”Ÿå­˜æœŸï¼Œå®ƒä¼šè‡ªåŠ¨åˆ é™¤æŒ‡å‘çš„<code>Widget</code>ã€‚è¿™æ—¶sortè°ƒç”¨è¿”å›äº†ï¼Œ<code>vector</code>çš„å†…å®¹å·²ç»æ”¹å˜äº†ï¼Œè€Œä¸”è‡³å°‘ä¸€ä¸ª<code>Widget</code>å·²ç»è¢«åˆ é™¤äº†ã€‚</p>
<p>ä¹Ÿå¯èƒ½æœ‰å‡ ä¸ª<code>vector</code>å…ƒç´ å·²ç»è¢«è®¾ä¸º<code>NULL</code>ï¼Œè€Œä¸”å‡ ä¸ª<code>widget</code>å·²ç»è¢«åˆ é™¤ï¼Œå› ä¸ºå¿«é€Ÿæ’åºæ˜¯ä¸€ç§é€’å½’ç®—æ³•ï¼Œé€’å½’çš„æ¯ä¸€å±‚éƒ½ä¼šæ‹·è´ä¸€ä¸ªä¸»å…ƒã€‚</p>
<h2 id="ç»“è®º">ç»“è®º</h2>
<p>æ™ºèƒ½æŒ‡é’ˆçš„å®¹å™¨æ˜¯å¾ˆå¥½çš„ï¼Œ ä½†æ˜¯<code>auto_ptr</code><font color=red>å®Œå…¨ä¸æ˜¯é‚£æ ·çš„æ™ºèƒ½æŒ‡é’ˆ</font>ã€‚</p>]]></description></item><item><title>Effective STL [7] | å½“ä½¿ç”¨newå¾—æŒ‡é’ˆçš„å®¹å™¨æ—¶ï¼Œè®°å¾—åœ¨é”€æ¯å®¹å™¨å‰deleteé‚£äº›æŒ‡é’ˆ</title><link>https://jianye0428.github.io/posts/clause_7/</link><pubDate>Wed, 26 Jul 2023 18:18:11 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/clause_7/</guid><description><![CDATA[<!-- <div class="details admonition quote">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>quote<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">note abstract info tip success question warning failure danger bug example quote</div>
    </div>
  </div> -->
<h2 id="stlå®¹å™¨èƒ½å¤Ÿåšçš„äº‹æƒ…">STLå®¹å™¨èƒ½å¤Ÿåšçš„äº‹æƒ…</h2>
<ul>
<li>
<p>æä¾›äº†å‰å‘å’Œé€†å‘éå†çš„è¿­ä»£å™¨ï¼ˆé€šè¿‡<code>begin</code>ã€<code>end</code>ã€<code>rbegin</code>ç­‰ï¼‰ï¼›</p>
</li>
<li>
<p>èƒ½å‘Šè¯‰ä½ æ‰€å®¹çº³çš„å¯¹è±¡ç±»å‹ï¼ˆé€šè¿‡<code>value_type</code>çš„<code>ttypedef</code>ï¼‰ï¼›</p>
</li>
<li>
<p>åœ¨æ’å…¥å’Œåˆ é™¤ä¸­ï¼Œè´Ÿè´£ä»»ä½•éœ€è¦çš„å†…å­˜ç®¡ç†ï¼›</p>
</li>
<li>
<p>æŠ¥å‘Šå®¹çº³äº†å¤šå°‘å¯¹è±¡å’Œæœ€å¤šå¯èƒ½å®¹çº³çš„æ•°é‡ï¼ˆåˆ†åˆ«é€šè¿‡<code>size</code>å’Œ<code>max_size</code>ï¼‰ï¼›</p>
</li>
<li>
<p>å½“å®¹å™¨è‡ªå·±è¢«é”€æ¯æ—¶ä¼šè‡ªåŠ¨é”€æ¯å®¹çº³çš„æ¯ä¸ªå¯¹è±¡ã€‚</p>
</li>
</ul>
<h2 id="å®¹å™¨å†…åŒ…å«æŒ‡é’ˆ">å®¹å™¨å†…åŒ…å«æŒ‡é’ˆ</h2>
<p>è™½ç„¶STLå®¹å™¨è¢«é”€æ¯æ—¶ï¼Œèƒ½å¤Ÿè‡ªåŠ¨é”€æ¯å®¹çº³çš„æ¯ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å¦‚æœè¿™äº›å¯¹è±¡æ˜¯é€šè¿‡newåˆ†é…çš„å¯¹è±¡çš„æŒ‡é’ˆæ—¶ï¼Œå®ƒä¸ä¼šè°ƒç”¨<code>delete</code>ï¼Œé”€æ¯æŒ‡é’ˆæ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚</p>
<p><strong>Example</strong></p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">doSomething</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">*&gt;</span> <span class="n">vwp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">SOME_MAGIC_NUMBER</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">vwp</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span> <span class="n">Widget</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span> <span class="c1">// work
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="c1">// Widgetsåœ¨è¿™é‡Œæ³„æ¼ï¼
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç å°†ç›´æ¥å¯¼è‡´å†…å­˜æ³„éœ²ã€‚</p>
<p>å½“<code>vwp</code>ç»“æŸå…¶ç”Ÿå‘½å‘¨æœŸåï¼Œ<code>vwp</code>çš„æ¯ä¸ªå…ƒç´ éƒ½è¢«é”€æ¯ï¼Œä½†ä¸ä¼š<code>delete</code>æ¯ä¸ª<code>new</code>å¾—åˆ°çš„å¯¹è±¡ã€‚</p>
<p>é‚£æ ·çš„åˆ é™¤æ˜¯ä½ çš„èŒè´£ï¼Œè€Œä¸æ˜¯vectorçš„ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹æ€§ã€‚åªæœ‰ä½ çŸ¥é“ä¸€ä¸ªæŒ‡é’ˆæ˜¯å¦åº”è¯¥è¢«åˆ é™¤ã€‚</p>
<p>å¯ä»¥å¾ˆç®€å•åœ°å®ç°ï¼š</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">doSomething</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">*&gt;</span> <span class="n">vwp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span> <span class="c1">// work
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">*&gt;::</span><span class="n">iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">vwp</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">!=</span> <span class="n">vwp</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">delete</span> <span class="o">*</span><span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µé”€æ¯çš„ä»£ç ï¼Œä»ç„¶æœ‰2ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>æ–°çš„forå¾ªç¯ä»£ç æ¯”for_eachå¤šå¾—å¤šï¼Œæ²¡æœ‰ä½¿ç”¨for_eachæ¥çš„æ¸…æ¥š</li>
<li>è¿™æ®µä»£ç ä¸æ˜¯å¼‚å¸¸å®‰å…¨çš„ã€‚å¦‚æœåœ¨ç”¨æŒ‡é’ˆå¡«å……äº†vwpçš„æ—¶å€™å’Œä½ è¦åˆ é™¤å®ƒä»¬ä¹‹é—´æŠ›å‡ºäº†ä¸€ä¸ªå¼‚å¸¸ï¼Œä½ ä¼šå†æ¬¡èµ„æºæ³„æ¼ã€‚</li>
</ul>
<p><strong>for_eachåˆ é™¤å¯¹è±¡</strong></p>
<p>è¦æŠŠä½ çš„ç±»ä¼¼for_eachçš„å¾ªç¯è½¬åŒ–ä¸ºçœŸæ­£ä½¿ç”¨for_eachï¼Œä½ éœ€è¦æŠŠdeleteè½¬å…¥ä¸€ä¸ªå‡½æ•°å¯¹è±¡ä¸­ã€‚</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">DeleteObject</span> <span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="n">unary_function</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">T</span><span class="o">*</span><span class="p">,</span> <span class="kt">void</span><span class="o">&gt;</span> <span class="p">{</span> <span class="c1">// è¿™é‡Œæœ‰è¿™ä¸ªç»§æ‰¿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">void</span> <span class="nf">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">T</span><span class="o">*</span> <span class="n">ptr</span><span class="p">)</span> <span class="k">const</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">delete</span> <span class="n">ptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨å¯ä»¥è¿™ä¹ˆåˆ é™¤å¯¹è±¡</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">HappyWork</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span> <span class="c1">// work
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">for_each</span><span class="p">(</span><span class="n">vwp</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">vwp</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">DeleteObject</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>é—®é¢˜</strong></p>
<p>å¦‚æœæœ‰äººç¼–å†™äº†ä¸€ä¸ªç±»ï¼Œè¯¥ç±»ç»§æ‰¿äº† string</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SpecialString</span><span class="o">:</span> <span class="k">public</span> <span class="n">string</span> <span class="p">{</span> <span class="p">...</span> <span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯å¾ˆå±é™©çš„è¡Œä¸ºï¼Œå› ä¸ºstringï¼Œå°±åƒæ‰€æœ‰çš„æ ‡å‡†STLå®¹å™¨ï¼Œ<strong>ç¼ºå°‘è™šææ„å‡½æ•°</strong>ï¼Œè€Œä»æ²¡æœ‰è™šææ„å‡½æ•°çš„ç±»å…¬æœ‰ç»§æ‰¿æ˜¯ä¸€ä¸ªå¤§çš„C++ç¦å¿Œã€‚</p>
<p>å½“ä»–åˆ é™¤ SpecialString æ—¶å°±ä¼šèµ„æºæ³„éœ²</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">doSomething</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">deque</span><span class="o">&lt;</span><span class="n">SpecialString</span><span class="o">*&gt;</span> <span class="n">dssp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">for_each</span><span class="p">(</span><span class="n">dssp</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">dssp</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="c1">// è¡Œä¸ºæœªå®šä¹‰ï¼é€šè¿‡æ²¡æœ‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">DeleteObject</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">());</span> <span class="c1">// è™šææ„å‡½æ•°çš„åŸºç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="c1">// æŒ‡é’ˆæ¥åˆ é™¤æ´¾ç”Ÿå¯¹è±¡
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>è§£å†³</strong></p>
<p>å¯ä»¥é€šè¿‡ç¼–è¯‘å™¨æ¨æ–­ä¼ ç»™<code>DeleteObject::operator()</code>çš„æŒ‡é’ˆçš„ç±»å‹æ¥æ¶ˆé™¤è¿™ä¸ªé”™è¯¯ï¼ˆä¹Ÿå‡å°‘DeleteObjectçš„ç”¨æˆ·éœ€è¦çš„å‡»é”®æ¬¡æ•°ï¼‰ã€‚</p>
<p><strong>æŠŠæ¨¡æ¿åŒ–ä»DeleteObjectç§»åˆ°å®ƒçš„operator()</strong>ï¼š</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">DeleteObject</span> <span class="p">{</span> <span class="c1">// åˆ é™¤è¿™é‡Œçš„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// æ¨¡æ¿åŒ–å’ŒåŸºç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="c1">// æ¨¡æ¿åŒ–åŠ åœ¨è¿™é‡Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">void</span> <span class="k">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">T</span><span class="o">*</span> <span class="n">ptr</span><span class="p">)</span> <span class="k">const</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">delete</span> <span class="n">ptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ä¼ ç»™<code>DeleteObject::operator()</code>çš„æŒ‡é’ˆçš„ç±»å‹ï¼Œè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ª<code>operator()</code>ã€‚è¿™ç§ç±»å‹æ¼”ç»ä¸‹é™è®©æˆ‘ä»¬æ”¾å¼ƒä½¿<code>DeleteObject</code>å¯é€‚é…çš„èƒ½åŠ›</p>
<p>ç°åœ¨åˆ é™¤ SpecialString å°±ä¼šæ­£å¸¸äº†</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">doSomething</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">deque</span><span class="o">&lt;</span><span class="n">SpecialString</span><span class="o">*&gt;</span> <span class="n">dssp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">for_each</span><span class="p">(</span><span class="n">dssp</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">dssp</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">DeleteObject</span><span class="p">());</span> <span class="c1">// goodï¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><font color=red>ç°åœ¨ä»ä¸æ˜¯å¼‚å¸¸å®‰å…¨çš„ã€‚</font></p>
<p>æœåœ¨SpecialStringè¢«newä½†åœ¨è°ƒç”¨for_eachä¹‹å‰æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œå°±ä¼šå‘ç”Ÿæ³„æ¼ã€‚</p>
<p>è¿™ä¸ªé—®é¢˜å¯ä»¥ä»¥å¤šç§æ–¹å¼è¢«è§£å†³ï¼Œä½†æœ€ç®€å•çš„å¯èƒ½æ˜¯ç”¨<strong>æ™ºèƒ½æŒ‡é’ˆçš„å®¹å™¨æ¥ä»£æ›¿æŒ‡é’ˆçš„å®¹å™¨ï¼Œå…¸å‹çš„æ˜¯å¼•ç”¨è®¡æ•°æŒ‡é’ˆ</strong>ã€‚</p>
<h2 id="booståº“ä¸­çš„shared_ptr">Booståº“ä¸­çš„shared_ptr</h2>
<p>åˆ©ç”¨Boostçš„shared_ptrï¼Œæœ¬æ¡æ¬¾çš„åŸå§‹ä¾‹å­å¯ä»¥é‡å†™ä¸ºè¿™æ ·ï¼š</p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">doSomething</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">typedef</span> <span class="n">boost</span><span class="o">::</span><span class="n">shared_</span> <span class="n">ptr</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">SPW</span><span class="p">;</span> <span class="c1">//SPW = &#34;shared_ptr to Widget&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">vector</span><span class="o">&lt;</span><span class="n">SPW</span><span class="o">&gt;</span> <span class="n">vwp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">SOME_MAGIC_NUMBER</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="n">vwp</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">SPW</span><span class="p">(</span><span class="k">new</span> <span class="n">Widget</span><span class="p">));</span> <span class="c1">// ä»ä¸€ä¸ªWidgetå»ºç«‹SPW,ç„¶åè¿›è¡Œä¸€æ¬¡push_back
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">...</span> <span class="c1">// work
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="c1">// è¿™é‡Œæ²¡æœ‰Widgetæ³„æ¼ï¼Œç”šè‡³åœ¨ä¸Šé¢ä»£ç ä¸­æŠ›å‡ºå¼‚å¸¸
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç»“è®º">ç»“è®º</h2>
<p>STLå®¹å™¨å¾ˆæ™ºèƒ½ï¼Œä½†å®ƒä»¬æ²¡æœ‰æ™ºèƒ½åˆ°çŸ¥é“æ˜¯å¦åº”è¯¥åˆ é™¤å®ƒä»¬æ‰€åŒ…å«çš„æŒ‡é’ˆã€‚</p>
<p>å½“ä½ è¦åˆ é™¤æŒ‡é’ˆçš„å®¹å™¨æ—¶è¦é¿å…èµ„æºæ³„æ¼ï¼Œä½ å¿…é¡»<strong>ç”¨æ™ºèƒ½å¼•ç”¨è®¡æ•°æŒ‡é’ˆå¯¹è±¡</strong>ï¼ˆæ¯”å¦‚<code>Boost</code>çš„<code>shared_ptr</code>ï¼‰æ¥ä»£æ›¿æŒ‡é’ˆï¼Œæˆ–è€…ä½ <strong>å¿…é¡»åœ¨å®¹å™¨é”€æ¯å‰æ‰‹åŠ¨åˆ é™¤å®¹å™¨ä¸­çš„æ¯ä¸ªæŒ‡é’ˆ</strong>ã€‚</p>]]></description></item><item><title>Effective STL [3] | ä½¿å®¹å™¨é‡Œå¯¹è±¡çš„æ‹·è´æ“ä½œè½»é‡è€Œæ­£ç¡®</title><link>https://jianye0428.github.io/posts/clause_3/</link><pubDate>Mon, 24 Jul 2023 09:11:28 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/clause_3/</guid><description><![CDATA[<h2 id="æ‹·è´å¯¹è±¡æ˜¯stlçš„æ–¹å¼">æ‹·è´å¯¹è±¡æ˜¯STLçš„æ–¹å¼</h2>
<ul>
<li>
<p>å½“ä¸€ä¸ªå¯¹è±¡è¿›å…¥ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒå·²ç»ä¸æ˜¯ä½ æ·»åŠ ï¼ˆ<code>insert</code>æˆ–<code>push_back</code>ç­‰ï¼‰çš„é‚£ä¸ªå¯¹è±¡äº†ï¼Œè¿›å…¥å®¹å™¨çš„æ˜¯ä½ æŒ‡å®šçš„å¯¹è±¡çš„æ‹·è´ï¼›</p>
</li>
<li>
<p>å½“ä»å®¹å™¨ä¸­å–å‡ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ‰€å¾—åˆ°çš„ä¹Ÿä¸æ˜¯å®¹å™¨é‡Œçš„å¯¹è±¡ï¼›</p>
</li>
<li>
<p>å¦‚æœä»<code>vector</code>ã€<code>string</code>æˆ–<code>deque</code>ä¸­æ’å…¥æˆ–åˆ é™¤äº†ä»€ä¹ˆï¼Œç°æœ‰çš„å®¹å™¨å…ƒç´ ä¼šç§»åŠ¨ï¼ˆæ‹·è´ï¼‰</p>
</li>
<li>
<p>å¦‚æœä½¿ç”¨äº†ä»»ä½•æ’åºç®—æ³•ï¼š<code>next_permutation</code>æˆ–è€…<code>previous_permutation</code>ï¼›</p>
</li>
<li>
<p><code>remove</code>ã€<code>unique</code>æˆ–å®ƒä»¬çš„åŒç±»ï¼›</p>
</li>
<li>
<p><code>rotate</code>æˆ–<code>reverse</code>ç­‰ï¼Œå¯¹è±¡ä¼šç§»åŠ¨ï¼ˆæ‹·è´ï¼‰</p>
</li>
</ul>
<p><strong>æ‹·è¿›å»ï¼Œæ‹·å‡ºæ¥</strong>ã€‚è¿™å°±æ˜¯STLçš„æ–¹å¼.</p>
<p>å› ä¸ºæ‹·è´ï¼Œè¿˜è§£å†³äº†ä¸€ä¸ª double free çš„ bug<a href="https://mp.weixin.qq.com/s?__biz=MzUyMDc2MDMxNg==&amp;mid=2247490628&amp;idx=1&amp;sn=43650727bc93d8064fd2969733873fdc&amp;chksm=f9e422d7ce93abc1d2784bcb5772536f55aa79902bbb783003c3314df7ed6461a014ed3cce25&amp;token=235869638&amp;lang=zh_CN&amp;scene=21#wechat_redirect"target="_blank" rel="external nofollow noopener noreferrer">ç‚¹å‡»æŸ¥çœ‹<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h2 id="how-copy-å¦‚ä½•å®Œæˆæ‹·è´">How Copy? å¦‚ä½•å®Œæˆæ‹·è´</h2>
<div class="details admonition info open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-info-circle fa-fw" aria-hidden="true"></i>Notice<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">é€šè¿‡æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´å¤åˆ¶æ“ä½œç¬¦å®Œæˆï¼</div>
    </div>
  </div>
<p>ä¸€ä¸ªå¯¹è±¡é€šè¿‡ä½¿ç”¨å®ƒçš„æ‹·è´æˆå‘˜å‡½æ•°æ¥æ‹·è´ï¼Œç‰¹åˆ«æ˜¯å®ƒçš„æ‹·è´æ„é€ å‡½æ•°å’Œå®ƒçš„æ‹·è´èµ‹å€¼æ“ä½œç¬¦ã€‚</p>
<p>å¯¹äºç”¨æˆ·è‡ªå®šä¹‰ç±»ï¼Œæ¯”å¦‚Widgetï¼Œè¿™äº›å‡½æ•°ä¼ ç»Ÿä¸Šæ˜¯è¿™ä¹ˆå£°æ˜çš„ï¼š</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Widget</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="n">Widget</span><span class="p">(</span><span class="k">const</span> <span class="n">Widget</span><span class="o">&amp;</span><span class="p">);</span> <span class="c1">// æ‹·è´æ„é€ å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Widget</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">Widget</span><span class="o">&amp;</span><span class="p">);</span> <span class="c1">// æ‹·è´èµ‹å€¼æ“ä½œç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å¦‚æœä½ è‡ªå·±æ²¡æœ‰å£°æ˜è¿™äº›å‡½æ•°ï¼Œä½ çš„ç¼–è¯‘å™¨å§‹ç»ˆä¼šä¸ºä½ å£°æ˜å®ƒä»¬ã€‚</strong></p>
<p>æ‹·è´å†…å»ºç±»å‹ï¼ˆæ¯”å¦‚intã€æŒ‡é’ˆç­‰ï¼‰ä¹Ÿå§‹ç»ˆæ˜¯é€šè¿‡ç®€å•åœ°æ‹·è´ä»–ä»¬çš„å†…åœ¨æ¯”ç‰¹æ¥å®Œæˆçš„ã€‚ï¼ˆè¯·å‚è€ƒã€ŠEffective C++ã€‹ä¸­ï¼Œæ¡æ¬¾11å’Œ27ä¸“æ³¨äºè¿™äº›å‡½æ•°çš„è¡Œä¸ºã€‚ï¼‰</p>
<h2 id="æ‹·è´å¸¦æ¥çš„é—®é¢˜">æ‹·è´å¸¦æ¥çš„é—®é¢˜</h2>
<p><strong>æ€§èƒ½ç“¶é¢ˆ</strong></p>
<p>æ‹·è´ä¼šå¯¼è‡´æŠŠå¯¹è±¡æ”¾è¿›å®¹å™¨ä¹Ÿä¼šè¢«è¯æ˜ä¸ºæ˜¯ä¸€ä¸ªæ€§èƒ½ç“¶é¢ˆã€‚</p>
<p>å®¹å™¨ä¸­ç§»åŠ¨è¶Šå¤šçš„ä¸œè¥¿ï¼Œä½ å°±ä¼šåœ¨æ‹·è´ä¸Šæµªè´¹è¶Šå¤šçš„å†…å­˜å’Œæ—¶é’Ÿå‘¨æœŸã€‚</p>
<p><strong>åˆ‡ç‰‡åˆ†å‰²</strong></p>
<p>å½“ç„¶ç”±äºç»§æ‰¿çš„å­˜åœ¨ï¼Œæ‹·è´ä¼šå¯¼è‡´åˆ†å‰²ã€‚</p>
<p>å¦‚æœä»¥åŸºç±»å¯¹è±¡å»ºç«‹ä¸€ä¸ªå®¹å™¨ï¼Œè€Œä½ è¯•å›¾æ’å…¥æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œé‚£ä¹ˆå½“å¯¹è±¡ï¼ˆé€šè¿‡åŸºç±»çš„æ‹·è´æ„é€ å‡½æ•°ï¼‰æ‹·å…¥å®¹å™¨çš„æ—¶å€™å¯¹è±¡çš„æ´¾ç”Ÿéƒ¨åˆ†ä¼šè¢«åˆ é™¤ï¼š</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">randy</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SpecialWidget</span><span class="o">:</span> <span class="k">public</span> <span class="n">Widget</span> <span class="p">{...};</span> <span class="c1">// SpecialWidgetä»ä¸Šé¢çš„Widgetæ´¾ç”Ÿ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">SpecialWidget</span> <span class="n">sw</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">randy</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">sw</span><span class="p">);</span> <span class="c1">// swè¢«å½“ä½œåŸºç±»å¯¹è±¡æ‹·å…¥randyï¼Œå½“æ‹·è´æ—¶å®ƒçš„ç‰¹æ®Šéƒ¨åˆ†ä¸¢å¤±äº†
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ†å‰²é—®é¢˜æš—ç¤ºäº†æŠŠä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡æ’å…¥åŸºç±»å¯¹è±¡çš„å®¹å™¨å‡ ä¹æ€»æ˜¯é”™çš„ã€‚</p>
<p>å¦‚æœä½ å¸Œæœ›ç»“æœå¯¹è±¡è¡¨ç°ä¸ºæ´¾ç”Ÿç±»å¯¹è±¡ï¼Œæ¯”å¦‚ï¼Œè°ƒç”¨æ´¾ç”Ÿç±»çš„è™šå‡½æ•°ç­‰ï¼Œæ€»æ˜¯é”™çš„ã€‚</p>
<h2 id="è§£å†³">è§£å†³</h2>
<p>ä¸€ä¸ªä½¿æ‹·è´æ›´é«˜æ•ˆã€æ­£ç¡®è€Œä¸”å¯¹åˆ†å‰²é—®é¢˜å…ç–«çš„ç®€å•çš„æ–¹å¼æ˜¯<strong>å»ºç«‹æŒ‡é’ˆçš„å®¹å™¨è€Œä¸æ˜¯å¯¹è±¡çš„å®¹å™¨</strong>ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸æ˜¯å»ºç«‹ä¸€ä¸ªWidgetçš„å®¹å™¨ï¼Œå»ºç«‹ä¸€ä¸ªWidget*çš„å®¹å™¨ã€‚</p>
<p><strong>æ‹·è´æŒ‡é’ˆå¾ˆå¿«ï¼Œå®ƒæ€»æ˜¯ä¸¥å¯†åœ°åšä½ å¸Œæœ›çš„ï¼ˆæŒ‡é’ˆæ‹·è´æ¯”ç‰¹ï¼‰ï¼Œè€Œä¸”å½“æŒ‡é’ˆæ‹·è´æ—¶æ²¡æœ‰åˆ†å‰²ï¼Œå°±æ˜¯intç±»å‹çš„åœ°å€ã€‚</strong></p>
<p><font color=red>ä½†æ˜¯ä¸€å®šè¦è®°å¾—åœ¨é”€æ¯å®¹å™¨çš„æ—¶å€™ï¼Œä½¿ç”¨delete é”€æ¯é‡Œé¢ä¿å­˜çš„æ¯ä¸ªæŒ‡é’ˆã€‚è€Œä¸”ä¸€å®šè¦å®šä¹‰å¯¹è±¡çš„æ·±æ‹·è´æ„é€ å‡½æ•°å’Œæ·±æ‹·è´æ‹·è´èµ‹å€¼æ“ä½œç¬¦ï¼Œå¦åˆ™delete çš„æ—¶å€™ä¼šæŠ¥é”™ã€‚</font></p>
<h2 id="å’Œæ•°ç»„å¯¹æ¯”stlå®¹å™¨æ›´æ–‡æ˜">å’Œæ•°ç»„å¯¹æ¯”ï¼ŒSTLå®¹å™¨æ›´æ–‡æ˜</h2>
<p><strong>STLå®¹å™¨åªå»ºç«‹ï¼ˆé€šè¿‡æ‹·è´ï¼‰ä½ éœ€è¦çš„ä¸ªæ•°çš„å¯¹è±¡ï¼Œè€Œä¸”å®ƒä»¬åªåœ¨ä½ æŒ‡å®šçš„æ—¶å€™åšã€‚</strong></p>
<p>STLè¿›è¡Œäº†å¤§é‡æ‹·è´ï¼Œä½†å®ƒé€šå¸¸è®¾è®¡ä¸ºé¿å…ä¸å¿…è¦çš„å¯¹è±¡æ‹·è´ï¼Œå®é™…ä¸Šï¼Œå®ƒä¹Ÿè¢«å®ç°ä¸ºé¿å…ä¸å¿…è¦çš„å¯¹è±¡æ‹·è´ã€‚</p>
<ol>
<li>æ•°ç»„åœ¨å£°æ˜çš„æ—¶å€™ï¼Œä¼šé»˜è®¤å…ˆæ„é€ å¥½æ¯ä¸ªå…ƒç´ ï¼›STLå®¹å™¨å¯ä»¥å®ç°åŠ¨æ€æ‰©å±•</li>
</ol>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">Widget</span> <span class="n">randy</span><span class="p">[</span><span class="n">maxNumWidgets</span><span class="p">];</span> <span class="c1">// å»ºç«‹ä¸€ä¸ªå¤§å°ä¸ºmaxNumWidgetsçš„Widgetsæ•°ç»„
</span></span></span><span class="line"><span class="cl"><span class="c1">// é»˜è®¤æ„é€ æ¯ä¸ªå…ƒç´ 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å³ä½¿åªä½¿ç”¨å…¶ä¸­çš„ä¸€äº›æˆ–è€…æˆ‘ä»¬ç«‹åˆ»ä½¿ç”¨ä»æŸä¸ªåœ°æ–¹è·å–ï¼ˆæ¯”å¦‚ï¼Œä¸€ä¸ªæ–‡ä»¶ï¼‰çš„å€¼è¦†ç›–æ¯ä¸ªé»˜è®¤æ„é€ çš„å€¼ï¼Œè¿™ä¹Ÿå¾—æ„é€ maxNumWidgetsä¸ªWidgetå¯¹è±¡ã€‚</p>
<p>ä½¿ç”¨STLæ¥ä»£æ›¿æ•°ç»„ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å¢é•¿çš„vectorï¼Œå°±æ˜¯åŠ¨æ€æ•°ç»„çš„æ¦‚å¿µï¼š</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">randy</span><span class="p">;</span> <span class="c1">// å»ºç«‹ä¸€ä¸ª0ä¸ªWidgetå¯¹è±¡çš„vector
</span></span></span><span class="line"><span class="cl"><span class="c1">// éœ€è¦çš„æ—¶å€™å¯ä»¥æ‰©å±•
</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>å»ºç«‹ä¸€ä¸ªå¯ä»¥è¶³å¤ŸåŒ…å«maxNumWidgetsä¸ªWidgetçš„ç©ºvectorï¼Œä½†ä¸å»æ„é€ Widgetï¼Œéœ€è¦æ—¶å†æ„é€ ï¼š</li>
</ol>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">randy</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">randy</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">maxNumWidgets</span><span class="p">);</span> <span class="c1">// reserveçš„è¯¦ç»†ä¿¡æ¯è¯·å‚è§æ¡æ¬¾14
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å³ä¾¿éœ€è¦çŸ¥é“STLå®¹å™¨ä½¿ç”¨äº†æ‹·è´ï¼Œä½†æ˜¯åˆ«å¿˜äº†ä¸€ä¸ªäº‹å®ï¼šæ¯”èµ·æ•°ç»„å®ƒä»¬ä»ç„¶æ˜¯ä¸€ä¸ªè¿›æ­¥ã€‚</p>
]]></description></item><item><title>Effective STL [2] | å°å¿ƒå¯¹â€œå®¹å™¨æ— å…³ä»£ç â€çš„å¹»æƒ³</title><link>https://jianye0428.github.io/posts/clause_2/</link><pubDate>Thu, 20 Jul 2023 15:58:12 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/clause_2/</guid><description><![CDATA[<h2 id="stl-å®¹å™¨ç‰¹ç‚¹">STL å®¹å™¨ç‰¹ç‚¹</h2>
<p>STLæ˜¯å»ºç«‹åœ¨<strong>æ³›åŒ–</strong>ä¹‹ä¸Šçš„</p>
<ul>
<li>æ•°ç»„æ³›åŒ–ä¸ºå®¹å™¨ï¼Œå‚æ•°åŒ–äº†æ‰€åŒ…å«çš„å¯¹è±¡çš„ç±»å‹</br></li>
<li>å‡½æ•°æ³›åŒ–ä¸ºç®—æ³•ï¼Œå‚æ•°åŒ–äº†æ‰€ç”¨çš„è¿­ä»£å™¨çš„ç±»å‹</br></li>
<li>æŒ‡é’ˆæ³›åŒ–ä¸ºè¿­ä»£å™¨ï¼Œå‚æ•°åŒ–äº†æ‰€æŒ‡å‘çš„å¯¹è±¡çš„ç±»å‹</br></li>
</ul>
<p><strong>ç‹¬ç«‹çš„å®¹å™¨ç±»å‹æ³›åŒ–ä¸ºåºåˆ—æˆ–å…³è”å®¹å™¨ï¼Œè€Œä¸”ç±»ä¼¼çš„å®¹å™¨æ‹¥æœ‰ç±»ä¼¼çš„åŠŸèƒ½ã€‚</strong></p>
<p>æ ‡å‡†çš„å†…å­˜ç›¸é‚»å®¹å™¨éƒ½æä¾›éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œæ ‡å‡†çš„åŸºäºèŠ‚ç‚¹çš„å®¹å™¨éƒ½æä¾›åŒå‘è¿­ä»£å™¨ã€‚</p>
<p>åºåˆ—å®¹å™¨æ”¯æŒ<code>push_front</code>æˆ–<code>push_back</code>ï¼Œä½†å…³è”å®¹å™¨ä¸æ”¯æŒã€‚å…³è”å®¹å™¨æä¾›å¯¹æ•°æ—¶é—´å¤æ‚åº¦çš„<code>lower_bound</code>ã€<code>upper_bound</code>å’Œ<code>equal_range</code>æˆå‘˜å‡½æ•°ï¼Œä½†åºåˆ—å®¹å™¨å´æ²¡æœ‰ã€‚</p>
<p>ä¸¾ä¾‹:</p>
<ul>
<li>æ ‡å‡†åºåˆ—å®¹å™¨: vectorã€stringã€deque å’Œ list</li>
<li>æ ‡å‡†å…³è”å®¹å™¨: setã€multisetã€map å’Œ multimap</li>
</ul>
<h2 id="æ¨è¡Œè‡ªå·±çš„å®¹å™¨">æ¨è¡Œè‡ªå·±çš„å®¹å™¨</h2>
<p>å¾ˆå¤šäººä¼šè¯•å›¾åœ¨ä»–ä»¬çš„è½¯ä»¶ä¸­æ³›åŒ–å®¹å™¨çš„ä¸åŒï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®¹å™¨çš„ç‰¹æ®Šæ€§ç¼–ç¨‹ï¼Œä»–ä»¬ä¼šæƒ³åœ¨vector ä¸­ä½¿ç”¨ deque æˆ–è€… listçš„ç‰¹æ€§ï¼Œè¿™å¾€å¾€ä¼šå¸¦æ¥éº»çƒ¦ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>
<p>åªæœ‰åºåˆ—å®¹å™¨æ”¯æŒpush_frontæˆ–push_backï¼Œåªæœ‰å…³è”å®¹å™¨æ”¯æŒcountå’Œlower_bound</p>
</li>
<li>
<p>å³ä¾¿æ˜¯ insertå’Œeraseè¿™æ ·çš„æ“ä½œåœ¨åç§°å’Œè¯­ä¹‰ä¸Šä¹Ÿæœ‰å·®åˆ«</p>
<ul>
<li>å½“æŠŠå¯¹è±¡æ’å…¥åºåˆ—å®¹å™¨ä¸­ï¼Œè¯¥å¯¹è±¡ä¼šä¿ç•™åœ¨ä½ æ”¾ç½®çš„ä½ç½®ä¸Š;</li>
<li>å½“ä½ æŠŠå¯¹è±¡æ’å…¥åˆ°ä¸€ä¸ªå…³è”å®¹å™¨ä¸­ï¼Œå®¹å™¨ä¼šæŒ‰ç…§æ’åˆ—é¡ºåºæŠŠå¯¹è±¡ç§»åˆ°å®ƒåº”è¯¥åœ¨çš„ä½ç½®;</li>
</ul>
</li>
<li>
<p>åœ¨åºåˆ—å®¹å™¨ä¸Šç”¨ä¸€ä¸ªè¿­ä»£å™¨ä½œä¸ºå‚æ•°è°ƒç”¨ eraseï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ï¼›åœ¨å…³è”å®¹å™¨ä¸Šä»€ä¹ˆéƒ½ä¸è¿”å›ã€‚</p>
</li>
</ul>
<p><strong>å®¹å™¨èƒ½åŠ›çš„äº¤é›†</strong></p>
<p>å¦‚æœä½ æƒ³å†™ä¸€ä¸ªå¯ä»¥ç”¨åœ¨å¸¸ç”¨åºåˆ—å®¹å™¨ä¸Šçš„ä»£ç â€”â€” åŒ…å«vector, dequeå’Œlistã€‚ä½ å¿…é¡»ä½¿ç”¨å®ƒä»¬èƒ½åŠ›çš„äº¤é›†æ¥ç¼–å†™ã€‚</p>
<p>ä½†è¦è€ƒè™‘å‡ ç‚¹ï¼š</p>
<ul>
<li><code>deque</code>å’Œ<code>list</code>ä¸æ”¯æŒ<code>reserve</code>æˆ–<code>capacity</code></li>
<li><code>list</code>ä¸æ”¯æŒ<code>operator[]</code>æ“ä½œï¼Œä¸”å—é™äºåŒå‘è¿­ä»£å™¨çš„æ€§èƒ½</li>
<li>ä¸èƒ½ä½¿ç”¨éœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨çš„ç®—æ³•ï¼ŒåŒ…æ‹¬<code>sort</code>ï¼Œ<code>stable_sort</code>ï¼Œ<code>partial_sort</code>å’Œ<code>nth_element</code></li>
<li>å¦‚æœæƒ³æ”¯æŒ<code>vector</code>çš„è§„åˆ™ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨<code>push_front</code>å’Œ<code>pop_front</code></li>
<li><code>vector</code>å’Œ<code>deque</code>éƒ½ä¼šä½¿<code>splice</code>å’Œæˆå‘˜å‡½æ•°æ–¹å¼çš„<code>sort</code>å¤±è´¥</li>
<li>å› ä¸º<code>deque::insert</code>ä¼šä½¿æ‰€æœ‰è¿­ä»£å™¨å¤±æ•ˆï¼Œè€Œä¸”å› ä¸ºç¼ºå°‘<code>capacity</code>ï¼Œ<code>vector::insert</code>ä¹Ÿå¿…é¡»å‡è®¾ä½¿æ‰€æœ‰æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆï¼Œè€Œdequeæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨è¿­ä»£å™¨å¤±æ•ˆçš„æƒ…å†µä¸‹, æŒ‡é’ˆå’Œå¼•ç”¨ä»ç„¶æœ‰æ•ˆçš„ä¸œè¥¿</li>
<li><strong>ä¸èƒ½æŠŠå®¹å™¨é‡Œçš„æ•°æ®ä¼ é€’ç»™Cé£æ ¼çš„ç•Œé¢</strong>ï¼Œåªæœ‰vectoræ”¯æŒè¿™ä¹ˆåš</li>
<li><strong>ä¸èƒ½ç”¨boolä½œä¸ºä¿å­˜çš„å¯¹è±¡æ¥å®ä¾‹åŒ–ä½ çš„å®¹å™¨</strong>ï¼Œå› ä¸ºvector å¹¶éæ€»è¡¨ç°ä¸ºä¸€ä¸ªvectorï¼Œå®é™…ä¸Šå®ƒå¹¶æ²¡æœ‰çœŸæ­£ä¿å­˜boolå€¼ã€‚</li>
<li>ä¸èƒ½æœŸæœ›äº«å—åˆ°listçš„å¸¸æ•°æ—¶é—´å¤æ‚åº¦çš„æ’å…¥å’Œåˆ é™¤ï¼Œvectorå’Œdequeçš„æ’å…¥å’Œåˆ é™¤æ“ä½œæ˜¯çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„</li>
</ul>
<p>æ‰€ä»¥ï¼ŒçœŸæ­£å¼€å‘æ—¶ï¼Œå¦‚æœéƒ½è€ƒè™‘åˆ°ä¸Šé¢å‡ ç‚¹ï¼Œé‚£æƒ³å¼€å‘çš„å®¹å™¨åªå‰©ä¸‹ä¸€ä¸ª&quot;æ³›åŒ–çš„åºåˆ—å®¹å™¨&quot;ï¼Œä½†æ˜¯ä½ ä¸èƒ½è°ƒç”¨<code>reserve</code>ã€<code>capacity</code>ã€<code>operator[]</code>ã€<code>push_front</code>ã€<code>pop_front</code>ã€<code>splice</code>æˆ–ä»»ä½•éœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨çš„ç®—æ³•ï¼›è°ƒç”¨insertå’Œeraseä¼šæœ‰çº¿æ€§æ—¶é—´å¤æ‚åº¦è€Œä¸”ä¼šä½¿æ‰€æœ‰è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆï¼›è€Œä¸”ä¸èƒ½å…¼å®¹Cé£æ ¼çš„ç•Œé¢ï¼Œä¸èƒ½å­˜å‚¨boolã€‚</p>
<p>å¦‚æœä½ æ”¾å¼ƒäº†åºåˆ—å®¹å™¨ï¼ŒæŠŠä»£ç æ”¹ä¸ºåªèƒ½å’Œä¸åŒçš„å…³è”å®¹å™¨é…åˆï¼Œè¿™æƒ…å†µå¹¶æ²¡æœ‰ä»€ä¹ˆæ”¹å–„ã€‚</p>
<ul>
<li>è¦åŒæ—¶å…¼å®¹setå’Œmapå‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºsetä¿å­˜å•ä¸ªå¯¹è±¡ï¼Œè€Œmapä¿å­˜å¯¹è±¡å¯¹ã€‚</li>
<li>ç”šè‡³è¦åŒæ—¶å…¼å®¹setå’Œmultisetï¼ˆæˆ–mapå’Œmultimapï¼‰ä¹Ÿæ˜¯å¾ˆéš¾çš„ã€‚</li>
<li><code>set/map</code>çš„<code>insert</code>æˆå‘˜å‡½æ•°åªè¿”å›ä¸€ä¸ªå€¼ï¼Œå’Œä»–ä»¬çš„multiå…„å¼Ÿçš„è¿”å›ç±»å‹ä¸åŒï¼Œè€Œä¸”ä½ å¿…é¡»é¿å…å¯¹ä¸€ä¸ªä¿å­˜åœ¨å®¹å™¨ä¸­çš„å€¼çš„æ‹·è´ä»½æ•°ä½œå‡ºä»»ä½•å‡è®¾ã€‚</li>
<li>å¯¹äº<code>map</code>å’Œ<code>multimap</code>ï¼Œä½ å¿…é¡»é¿å…ä½¿ç”¨<code>operator[]</code>ï¼Œå› ä¸ºè¿™ä¸ªæˆå‘˜å‡½æ•°åªå­˜åœ¨äºmapä¸­ã€‚</li>
</ul>
<h2 id="å°è£…">å°è£…</h2>
<p>å¦‚æœæƒ³æ”¹å˜å®¹å™¨ç±»å‹ï¼Œå°±ä½¿ç”¨<strong>å°è£…</strong>ã€‚</p>
<p><strong>Method 1: typedef</strong>
ä¸€ç§æœ€ç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡è‡ªç”±åœ°å¯¹å®¹å™¨å’Œè¿­ä»£å™¨ç±»å‹ä½¿ç”¨typedef</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Widget</span> <span class="p">{...};</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">vw</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Widget</span> <span class="n">bestWidget</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span> <span class="c1">// ç»™bestWidgetä¸€ä¸ªå€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">i</span> <span class="o">=</span>  <span class="c1">// å¯»æ‰¾å’ŒbestWidgetç›¸ç­‰çš„Widget
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">find</span><span class="p">(</span><span class="n">vw</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">vw</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">bestWidget</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥ç®€åŒ–ä¸Šè¿°å†™æ³•</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Widget</span> <span class="p">{</span> <span class="p">...</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">WidgetContainer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="n">WidgetContainer</span><span class="o">::</span><span class="n">iterator</span> <span class="n">WCIterator</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">WidgetContainer</span> <span class="n">cw</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Widget</span> <span class="n">bestWidget</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="n">WCIterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">cw</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">cw</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">bestWidg</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœéœ€è¦åŠ ä¸Šç”¨æˆ·çš„allocatorï¼Œä¹Ÿç‰¹åˆ«æ–¹ä¾¿ã€‚ï¼ˆä¸€ä¸ªä¸å½±å“å¯¹è¿­ä»£å™¨/æŒ‡é’ˆ/å‚è€ƒçš„å¤±æ•ˆè§„åˆ™çš„æ”¹å˜ï¼‰</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Widget</span> <span class="p">{</span> <span class="p">...</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="c1">// å…³äºä¸ºä»€ä¹ˆè¿™é‡Œéœ€è¦ä¸€ä¸ªtemplate
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">SpecialAllocator</span> <span class="p">{</span> <span class="p">...</span> <span class="p">};</span> <span class="c1">// è¯·å‚è§æ¡æ¬¾10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">Widget</span><span class="p">,</span> <span class="n">SpecialAllocator</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">WidgetContainer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="n">WidgetContainer</span><span class="o">::</span><span class="n">iterator</span> <span class="n">WCIterator</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">WidgetContainer</span> <span class="n">cw</span><span class="p">;</span> <span class="c1">// ä»ç„¶èƒ½ç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Widget</span> <span class="n">bestWidget</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="n">WCIterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">cw</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">cw</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">bestWidget</span><span class="p">);</span> <span class="c1">// ä»ç„¶èƒ½ç”¨
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><font color=red><code>typedef</code>åªæ˜¯å…¶å®ƒç±»å‹çš„åŒä¹‰å­—ï¼Œæ‰€ä»¥å®ƒæä¾›çš„çš„å°è£…æ˜¯çº¯çš„è¯æ³•ï¼ˆè¯‘æ³¨ï¼šä¸åƒ#defineæ˜¯åœ¨é¢„ç¼–è¯‘é˜¶æ®µæ›¿æ¢çš„ï¼‰ã€‚<code>typedef</code>å¹¶ä¸èƒ½é˜»æ­¢ç”¨æˆ·ä½¿ç”¨ï¼ˆæˆ–ä¾èµ–ï¼‰ä»»ä½•ä»–ä»¬ä¸åº”è¯¥ç”¨çš„ï¼ˆæˆ–ä¾èµ–çš„ï¼‰ã€‚</font></p>
<p><strong>Method 2: class</strong></p>
<p>è¦é™åˆ¶å¦‚æœç”¨ä¸€ä¸ªå®¹å™¨ç±»å‹æ›¿æ¢äº†å¦ä¸€ä¸ªå®¹å™¨å¯èƒ½éœ€è¦ä¿®æ”¹çš„ä»£ç ï¼Œå°±éœ€è¦åœ¨ç±»ä¸­éšè—é‚£ä¸ªå®¹å™¨ï¼Œè€Œä¸”è¦é€šè¿‡ç±»çš„æ¥å£é™åˆ¶å®¹å™¨ç‰¹æ®Šä¿¡æ¯å¯è§æ€§çš„æ•°é‡ã€‚</p>
<p>æ¯”å¦‚éœ€è¦éšè— çœŸå®çš„å®¹å™¨ list å»ºç«‹å®¢æˆ·åˆ—è¡¨ï¼š</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CustomerList</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="n">list</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">&gt;</span> <span class="n">CustomerContainer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="n">CustomerContainer</span><span class="o">::</span><span class="n">iterator</span> <span class="n">CCIterator</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">CustomerContainer</span> <span class="n">customers</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span> <span class="c1">// é€šè¿‡è¿™ä¸ªæ¥å£
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">...</span> <span class="c1">// é™åˆ¶listç‰¹æ®Šä¿¡æ¯çš„å¯è§æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä½ å‘ç°ä»åˆ—è¡¨çš„ä¸­éƒ¨æ’å…¥å’Œåˆ é™¤å®¢æˆ·å¹¶ä¸åƒä½ æƒ³è±¡çš„é‚£ä¹ˆé¢‘ç¹ï¼Œä»…ä»…éœ€è¦å¿«é€Ÿç¡®å®šå®¢æˆ·åˆ—è¡¨é¡¶éƒ¨çš„20%â€”â€”ä¸€ä¸ªä¸ºnth_elementç®—æ³•é‡èº«å®šåšçš„ä»»åŠ¡ã€‚</p>
<p>ä½†<code>nth_element</code>éœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œä¸èƒ½å…¼å®¹<code>list</code>ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ çš„å®¢æˆ·&quot;list&quot;å¯èƒ½æ›´åº”è¯¥ç”¨&quot;vector&quot;æˆ–&quot;deque&quot;æ¥å®ç°</p>
<p>å½“ä½ å†³å®šä½œè¿™ç§æ›´æ”¹çš„æ—¶å€™ï¼Œä½ ä»ç„¶<strong>å¿…é¡»æ£€æŸ¥æ¯ä¸ªCustomerListçš„æˆå‘˜å‡½æ•°å’Œæ¯ä¸ªå‹å…ƒï¼Œçœ‹çœ‹ä»–ä»¬å—å½±å“çš„ç¨‹åº¦ï¼ˆæ ¹æ®æ€§èƒ½å’Œè¿­ä»£å™¨/æŒ‡é’ˆ/å¼•ç”¨å¤±æ•ˆçš„æƒ…å†µç­‰ç­‰ï¼‰</strong>ã€‚</p>
<p>ä½†å¦‚æœä½ åšå¥½äº†å¯¹CustomerListåœ°å®ç°ç»†èŠ‚åšå¥½å°è£…çš„è¯ï¼Œé‚£å¯¹CustomerListçš„å®¢æˆ·çš„å½±å“å°†ä¼šå¾ˆå°ã€‚</p>
]]></description></item><item><title>Effective STL [1] | ä»”ç»†é€‰æ‹©ä½ çš„å®¹å™¨</title><link>https://jianye0428.github.io/posts/clause_1/</link><pubDate>Wed, 19 Jul 2023 08:51:49 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/clause_1/</guid><description><![CDATA[<div class="details admonition quote">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>quote<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">é€‰æ‹©å®¹å™¨éœ€è¦æ³¨æ„çš„å‡ ä¸ªæ–¹é¢</div>
    </div>
  </div>
<h2 id="è¿­ä»£å™¨">è¿­ä»£å™¨</h2>
<ol>
<li>è¾“å…¥è¿­ä»£å™¨</li>
</ol>
<ul>
<li>æ¯ä¸ªè¿­ä»£ä½ç½®<strong>åªèƒ½è¢«è¯»1æ¬¡</strong>çš„åªè¯»è¿­ä»£å™¨ï¼Œé€šå¸¸è¡¨ç°ä¸º istream_iterator</li>
</ul>
<ol start="2">
<li>è¾“å‡ºè¿­ä»£å™¨</li>
</ol>
<ul>
<li>æ¯ä¸ªè¿­ä»£ä½ç½®<strong>åªèƒ½è¢«å†™1æ¬¡</strong>çš„åªå†™è¿­ä»£å™¨ï¼Œé€šå¸¸è¡¨ç°ä¸º ostream_iterator</li>
</ul>
<ol start="3">
<li>å‰å‘è¿­ä»£å™¨</li>
</ol>
<ul>
<li>
<p>æœ‰<strong>è¾“å…¥</strong>å’Œ<strong>è¾“å‡º</strong>è¿­ä»£å™¨çš„èƒ½åŠ›ï¼Œå¯ä»¥åå¤è¯»å†™1ä¸ªä½ç½®ï¼Œ<u>ä¸æ”¯æŒ operator&ndash;</u>ï¼Œå¯ä»¥é«˜æ•ˆåœ°å‘å‰ç§»åŠ¨ä»»æ„æ¬¡æ•°</p>
</li>
<li>
<p>æ•£åˆ—å®¹å™¨çš„ä¸€ç§è®¾è®¡å¯ä»¥äº§ç”Ÿå‰å‘è¿­ä»£å™¨ï¼›</p>
</li>
<li>
<p>å•é“¾è¡¨å®¹å™¨ä¹Ÿæä¾›å‰å‘è¿­ä»£å™¨</p>
</li>
</ul>
<ol start="4">
<li>åŒå‘è¿­ä»£å™¨</li>
</ol>
<ul>
<li>åƒå‰å‘è¿­ä»£å™¨ä¸€æ ·ï¼Œåé€€å¾ˆå®¹æ˜“ã€‚æ ‡å‡†å…³è”å®¹å™¨éƒ½æä¾›åŒå‘è¿­ä»£å™¨ï¼Œlistä¹Ÿæœ‰</li>
</ul>
<ol start="5">
<li>éšæœºè®¿é—®è¿­ä»£å™¨</li>
</ol>
<ul>
<li>
<p>å¯ä»¥åšåŒå‘è¿­ä»£å™¨ä¸€æ ·çš„äº‹æƒ…ï¼Œä½†ä¹Ÿæä¾›â€œè¿­ä»£å™¨ç®—æœ¯â€ï¼Œå³è¿­ä»£å™¨æœ‰ä¸€æ­¥å‘å‰æˆ–å‘åè·³çš„èƒ½åŠ›ã€‚</p>
</li>
<li>
<p>vectorã€string å’Œ deque éƒ½æä¾›éšæœºè®¿é—®è¿­ä»£å™¨ã€‚</p>
</li>
<li>
<p>æŒ‡é’ˆæ•°ç»„çš„æŒ‡é’ˆå¯ä»¥ä½œä¸ºæ•°ç»„çš„éšæœºè®¿é—®è¿­ä»£å™¨ã€‚</p>
</li>
</ul>
<h2 id="å®¹å™¨">å®¹å™¨</h2>
<p>STLæœ‰<font color=red><strong>è¿­ä»£å™¨</strong></font>ã€<font color=red><strong>ç®—æ³•</strong></font>å’Œ<font color=red><strong>å‡½æ•°å¯¹è±¡</strong></font>ï¼Œä½†å¯¹äºå¤§å¤šæ•°C++ç¨‹åºå‘˜ï¼Œå®¹å™¨æ˜¯æœ€çªå‡ºçš„ã€‚</p>
<p>å®ƒä»¬æ¯”æ•°ç»„æ›´å¼ºå¤§æ›´çµæ´»ï¼Œå¯ä»¥åŠ¨æ€å¢é•¿ï¼ˆä¹Ÿå¸¸æ˜¯ç¼©å‡ï¼‰ï¼Œå¯ä»¥ç®¡ç†å±äºå®ƒä»¬è‡ªå·±çš„å†…å­˜ï¼Œå¯ä»¥è·Ÿè¸ªå®ƒä»¬æ‹¥æœ‰çš„å¯¹è±¡æ•°ç›®ï¼Œå¯ä»¥é™åˆ¶å®ƒä»¬æ”¯æŒæ“ä½œçš„ç®—æ³•å¤æ‚åº¦ç­‰ç­‰ã€‚</p>
<p><strong>åˆ†ç±»</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">ç±»åˆ«</th>
<th style="text-align:left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">æ ‡å‡†STLåºåˆ—å®¹å™¨</td>
<td style="text-align:left">vectorã€stringã€dequeå’Œlist</td>
</tr>
<tr>
<td style="text-align:left">æ ‡å‡†STLå…³è”å®¹å™¨</td>
<td style="text-align:left">setã€multisetã€mapå’Œmultimap</td>
</tr>
<tr>
<td style="text-align:left">éæ ‡å‡†åºåˆ—å®¹å™¨slistå’Œrope</td>
<td style="text-align:left">slistæ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œropeæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé‡å‹å­—ç¬¦ä¸²ã€‚(&ldquo;ç»³å­(rope)&ldquo;æ˜¯é‡å‹çš„&quot;çº¿(string)&rdquo;)</td>
</tr>
<tr>
<td style="text-align:left">éæ ‡å‡†å…³è”å®¹å™¨</td>
<td style="text-align:left">hash_setã€hash_multisetã€hash_mapå’Œhash_multimap</td>
</tr>
<tr>
<td style="text-align:left">vector	å¯ä»¥ä½œä¸ºstringçš„æ›¿ä»£å“</td>
<td style="text-align:left">vectorä½œä¸ºæ ‡å‡†å…³è”å®¹å™¨çš„æ›¿ä»£å“</br>	æœ‰æ—¶å€™vectorå¯ä»¥åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½è¡¨ç°å¾—æ¯”æ ‡å‡†å…³è”å®¹å™¨å¥½</td>
</tr>
<tr>
<td style="text-align:left">æ ‡å‡†éSTLå®¹å™¨</td>
<td style="text-align:left">åŒ…æ‹¬æ•°ç»„ã€bitsetã€valarrayã€stackã€queueå’Œpriority_queue ã€‚</br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•°ç»„å¯ä»¥å’ŒSTLç®—æ³•é…åˆï¼Œå› ä¸ºæŒ‡é’ˆå¯ä»¥å½“ä½œæ•°ç»„çš„è¿­ä»£å™¨ä½¿ç”¨</td>
</tr>
</tbody>
</table>
<p><code>vector</code>ã€<code>list</code>å’Œ<code>deque</code>æä¾›ç»™ç¨‹åºå‘˜ä¸åŒçš„å¤æ‚åº¦ï¼Œå› æ­¤åº”è¯¥è¿™ä¹ˆç”¨ï¼š</p>
<ul>
<li>vectoræ˜¯ä¸€ç§å¯ä»¥é»˜è®¤ä½¿ç”¨çš„åºåˆ—ç±»å‹</br></li>
<li>å½“å¾ˆé¢‘ç¹åœ°å¯¹åºåˆ—ä¸­éƒ¨è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ—¶åº”è¯¥ç”¨list</br></li>
<li>å½“å¤§éƒ¨åˆ†æ’å…¥å’Œåˆ é™¤å‘ç”Ÿåœ¨åºåˆ—çš„å¤´æˆ–å°¾æ—¶å¯ä»¥é€‰æ‹©dequeè¿™ç§æ•°æ®ç»“æ„</br></li>
</ul>
<p><strong>è¿ç»­å†…å­˜å®¹å™¨å’ŒåŸºäºèŠ‚ç‚¹çš„å®¹å™¨çš„åŒºåˆ«</strong></p>
<ul>
<li><strong>è¿ç»­å†…å­˜å®¹å™¨ï¼ˆä¹Ÿå«åšåŸºäºæ•°ç»„çš„å®¹å™¨ï¼‰</strong>
<ul>
<li>
<p>åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªï¼ˆåŠ¨æ€åˆ†é…ï¼‰çš„å†…å­˜å—ä¸­ä¿å­˜å®ƒä»¬çš„å…ƒç´ ã€‚</p>
</li>
<li>
<p>å¦‚æœä¸€ä¸ªæ–°å…ƒç´ è¢«æŸ¥å…¥æˆ–è€…å·²å­˜å…ƒç´ è¢«åˆ é™¤ï¼Œå…¶ä»–åœ¨åŒä¸€ä¸ªå†…å­˜å—çš„å…ƒç´ å°±å¿…é¡»å‘ä¸Šæˆ–è€…å‘ä¸‹ç§»åŠ¨æ¥ä¸ºæ–°å…ƒç´ æä¾›ç©ºé—´æˆ–è€…å¡«å……åŸæ¥è¢«åˆ é™¤çš„å…ƒç´ æ‰€å çš„ç©ºé—´ã€‚</p>
</li>
<li>
<p>è¿™ç§ç§»åŠ¨å½±å“äº†æ•ˆç‡å’Œå¼‚å¸¸å®‰å…¨ã€‚</p>
</li>
<li>
<p>æ ‡å‡†çš„è¿ç»­å†…å­˜å®¹å™¨æ˜¯vectorã€stringå’Œdequeã€‚</p>
</li>
<li>
<p>éæ ‡å‡†çš„ropeä¹Ÿæ˜¯è¿ç»­å†…å­˜å®¹å™¨ã€‚</p>
</li>
</ul>
</li>
<li><strong>åŸºäºèŠ‚ç‚¹çš„å®¹å™¨</strong>
<ul>
<li>
<p>åœ¨æ¯ä¸ªå†…å­˜å—ï¼ˆåŠ¨æ€åˆ†é…ï¼‰ä¸­åªä¿å­˜ä¸€ä¸ªå…ƒç´ ã€‚</p>
</li>
<li>
<p>å®¹å™¨å…ƒç´ çš„æ’å…¥æˆ–åˆ é™¤åªå½±å“æŒ‡å‘èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œè€Œä¸æ˜¯èŠ‚ç‚¹è‡ªå·±çš„å†…å®¹ã€‚</p>
</li>
<li>
<p>æ‰€ä»¥å½“æœ‰ä¸œè¥¿æ’å…¥æˆ–åˆ é™¤æ—¶ï¼Œå…ƒç´ å€¼ä¸éœ€è¦ç§»åŠ¨ã€‚</p>
</li>
<li>
<p>è¡¨ç°ä¸ºé“¾è¡¨çš„å®¹å™¨â€”â€”æ¯”å¦‚listå’Œslistâ€”â€”æ˜¯åŸºäºèŠ‚ç‚¹çš„ï¼Œæ‰€æœ‰çš„æ ‡å‡†å…³è”å®¹å™¨ä¹Ÿæ˜¯ï¼ˆå®ƒä»¬çš„å…¸å‹å®ç°æ˜¯å¹³è¡¡æ ‘ï¼‰ã€‚</p>
</li>
<li>
<p>éæ ‡å‡†çš„æ•£åˆ—å®¹å™¨ä½¿ç”¨ä¸åŒçš„åŸºäºèŠ‚ç‚¹çš„å®ç°ã€‚</p>
</li>
</ul>
</li>
</ul>
<h2 id="å¦‚ä½•é€‰æ‹©å®¹å™¨">å¦‚ä½•é€‰æ‹©å®¹å™¨?</h2>
<ol>
<li>ä½ éœ€è¦â€œå¯ä»¥åœ¨å®¹å™¨çš„ä»»æ„ä½ç½®æ’å…¥ä¸€ä¸ªæ–°å…ƒç´ â€çš„èƒ½åŠ›å—ï¼Ÿ
<ul>
<li>å¦‚æœæ˜¯ï¼Œä½ éœ€è¦<strong>åºåˆ—å®¹å™¨</strong>ï¼Œå…³è”å®¹å™¨åšä¸åˆ°ã€‚
</br></li>
</ul>
</li>
<li>ä½ å…³å¿ƒå…ƒç´ åœ¨å®¹å™¨ä¸­çš„é¡ºåºå—ï¼Ÿ
<ul>
<li><strong>å¦‚æœä¸ï¼Œæ•£åˆ—å®¹å™¨å°±æ˜¯å¯è¡Œçš„é€‰æ‹©</strong>ã€‚å¦åˆ™ï¼Œä½ è¦é¿å…ä½¿ç”¨æ•£åˆ—å®¹å™¨ã€‚
</br></li>
</ul>
</li>
<li>å¿…é¡»ä½¿ç”¨æ ‡å‡†C++ä¸­çš„å®¹å™¨å—?
<ul>
<li>å¦‚æœæ˜¯ï¼Œå°±å¯ä»¥é™¤å»æ•£åˆ—å®¹å™¨ã€slistå’Œropeã€‚
</br></li>
</ul>
</li>
<li>ä½ éœ€è¦å“ªä¸€ç±»è¿­ä»£å™¨ï¼Ÿ
<ul>
<li>å¦‚æœå¿…é¡»æ˜¯<strong>éšæœºè®¿é—®è¿­ä»£å™¨</strong>ï¼Œåœ¨æŠ€æœ¯ä¸Šä½ å°±åªèƒ½é™äº<code>vector</code>ã€<code>deque</code>å’Œ<code>string</code>ï¼Œä½†ä½ ä¹Ÿå¯èƒ½ä¼šè€ƒè™‘<code>rope</code>ã€‚</li>
<li>å¦‚æœéœ€è¦<strong>åŒå‘è¿­ä»£å™¨</strong>ï¼Œä½ å°±<strong>ç”¨ä¸äº†</strong><code>slist </code>å’Œ<code>æ•£åˆ—å®¹å™¨</code>çš„ä¸€èˆ¬å®ç°ã€‚
</br></li>
</ul>
</li>
<li>å½“æ’å…¥æˆ–è€…åˆ é™¤æ•°æ®æ—¶ï¼Œæ˜¯å¦éå¸¸åœ¨æ„å®¹å™¨å†…ç°æœ‰å…ƒç´ çš„ç§»åŠ¨ï¼Ÿ
<ul>
<li>å¦‚æœæ˜¯ï¼Œä½ å°±å¿…é¡»<strong>æ”¾å¼ƒè¿ç»­å†…å­˜å®¹å™¨</strong>ã€‚
</br></li>
</ul>
</li>
<li>å®¹å™¨ä¸­çš„æ•°æ®çš„å†…å­˜å¸ƒå±€éœ€è¦å…¼å®¹Cå—ï¼Ÿ
<ul>
<li>å¦‚æœæ˜¯ï¼Œä½ å°±åªèƒ½ç”¨vectorã€‚
</br></li>
</ul>
</li>
<li>æŸ¥æ‰¾é€Ÿåº¦å¾ˆé‡è¦å—ï¼Ÿ
<ul>
<li>å¦‚æœæ˜¯ï¼Œä½ å°±åº”è¯¥çœ‹çœ‹æ•£åˆ—å®¹å™¨ï¼Œæ’åºçš„vectorå’Œæ ‡å‡†çš„å…³è”å®¹å™¨â€”â€”å¤§æ¦‚æ˜¯è¿™ä¸ªé¡ºåºã€‚
</br></li>
</ul>
</li>
<li>ä½ ä»‹æ„å¦‚æœå®¹å™¨çš„åº•å±‚ä½¿ç”¨äº†å¼•ç”¨è®¡æ•°å—ï¼Ÿ
<ul>
<li>å¦‚æœæ˜¯ï¼Œä½ å°±å¾—é¿å¼€stringï¼Œå› ä¸ºå¾ˆå¤šstringçš„å®ç°æ˜¯ç”¨å¼•ç”¨è®¡æ•°ã€‚</li>
<li>ä½ ä¹Ÿ<strong>ä¸èƒ½ç”¨rope</strong>ï¼Œå› ä¸º<strong>æƒå¨çš„ropeå®ç°æ˜¯åŸºäºå¼•ç”¨è®¡æ•°çš„</strong>ã€‚</li>
<li>äºæ˜¯ä½ å¾—é‡æ–°å®¡æ ¸ä½ çš„stringï¼Œä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨vector<char>
</br></li>
</ul>
</li>
<li>ä½ éœ€è¦æ’å…¥å’Œåˆ é™¤çš„äº‹åŠ¡æ€§è¯­ä¹‰å—ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œä½ éœ€è¦æœ‰å¯é åœ°å›é€€æ’å…¥å’Œåˆ é™¤çš„èƒ½åŠ›å—ï¼Ÿ
<ul>
<li>å¦‚æœæ˜¯ï¼Œä½ å°±éœ€è¦ä½¿ç”¨<strong>åŸºäºèŠ‚ç‚¹çš„å®¹å™¨</strong>ã€‚</li>
<li>å¦‚æœä½ éœ€è¦<strong>å¤šå…ƒç´ æ’å…¥</strong>ï¼ˆæ¯”å¦‚ï¼Œä»¥èŒƒå›´çš„æ–¹å¼ï¼‰çš„äº‹åŠ¡æ€§è¯­ä¹‰ï¼Œä½ å°±åº”è¯¥é€‰æ‹©<code>list</code>ï¼Œå› ä¸º<strong>listæ˜¯å”¯ä¸€æä¾›å¤šå…ƒç´ æ’å…¥äº‹åŠ¡æ€§è¯­ä¹‰çš„æ ‡å‡†å®¹å™¨</strong>ã€‚</li>
<li>äº‹åŠ¡æ€§è¯­ä¹‰å¯¹äºæœ‰å…´è¶£å†™å¼‚å¸¸å®‰å…¨ä»£ç çš„ç¨‹åºå‘˜æ¥è¯´éå¸¸é‡è¦ã€‚ï¼ˆäº‹åŠ¡æ€§è¯­ä¹‰ä¹Ÿå¯ä»¥åœ¨è¿ç»­å†…å­˜å®¹å™¨ä¸Šå®ç°ï¼Œä½†ä¼šæœ‰ä¸€ä¸ªæ€§èƒ½å¼€é”€ï¼Œè€Œä¸”ä»£ç ä¸é‚£ä¹ˆç›´è§‚ï¼‰
</br></li>
</ul>
</li>
<li>ä½ è¦æŠŠè¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨çš„å¤±æ•ˆæ¬¡æ•°å‡åˆ°æœ€å°‘å—ï¼Ÿ
<ul>
<li>å¦‚æœæ˜¯ï¼Œä½ å°±åº”è¯¥<strong>ä½¿ç”¨åŸºäºèŠ‚ç‚¹çš„å®¹å™¨</strong>ï¼Œå› ä¸ºåœ¨è¿™äº›å®¹å™¨ä¸Šè¿›è¡Œæ’å…¥å’Œåˆ é™¤ä¸ä¼šä½¿è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆï¼ˆé™¤éå®ƒä»¬æŒ‡å‘ä½ åˆ é™¤çš„å…ƒç´ ï¼‰ã€‚</li>
<li>ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>åœ¨è¿ç»­å†…å­˜å®¹å™¨ä¸Šæ’å…¥å’Œåˆ é™¤ä¼šä½¿æ‰€æœ‰æŒ‡å‘å®¹å™¨çš„è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆ</strong>ã€‚
</br></li>
</ul>
</li>
<li>ä½ éœ€è¦å…·æœ‰ä»¥ä¸‹ç‰¹æ€§çš„åºåˆ—å®¹å™¨å—ï¼š1ï¼‰ å¯ä»¥ä½¿ç”¨éšæœºè®¿é—®è¿­ä»£å™¨ï¼›2ï¼‰ åªè¦æ²¡æœ‰åˆ é™¤è€Œä¸”æ’å…¥åªå‘ç”Ÿåœ¨å®¹å™¨ç»“å°¾ï¼ŒæŒ‡é’ˆå’Œå¼•ç”¨çš„æ•°æ®å°±ä¸ä¼šå¤±æ•ˆï¼Ÿ
<ul>
<li>è¿™ä¸ªä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„æƒ…å†µï¼Œä½†å¦‚æœä½ é‡åˆ°è¿™ç§æƒ…å†µï¼Œ<strong>dequeå°±æ˜¯ä½ æ¢¦æƒ³çš„å®¹å™¨</strong>ã€‚</li>
<li>æœ‰è¶£çš„æ˜¯ï¼Œ<strong>å½“æ’å…¥åªåœ¨å®¹å™¨ç»“å°¾æ—¶ï¼Œdequeçš„è¿­ä»£å™¨ä¹Ÿå¯èƒ½ä¼šå¤±æ•ˆ</strong>ï¼Œ<code>deque</code>æ˜¯**å”¯ä¸€ä¸€ä¸ªâ€œåœ¨è¿­ä»£å™¨å¤±æ•ˆæ—¶ä¸ä¼šä½¿å®ƒçš„æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆâ€**çš„æ ‡å‡†STLå®¹å™¨ã€‚</li>
</ul>
</li>
</ol>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p><font color=green><strong>å½“é¢å¯¹å®¹å™¨æ—¶ï¼ŒSTLç»™äº†ä½ å¾ˆå¤šé€‰é¡¹ã€‚å¦‚æœä½ çš„è§†çº¿è¶…è¶Šäº†STLçš„èŒƒå›´ï¼Œé‚£å°±ä¼šæœ‰æ›´å¤šçš„é€‰é¡¹ã€‚åœ¨é€‰æ‹©ä¸€ä¸ªå®¹å™¨å‰ï¼Œè¦ä¿è¯è€ƒè™‘äº†æ‰€æœ‰ä½ çš„é€‰é¡¹ã€‚</strong></font></p>]]></description></item><item><title>C++ STL Containers</title><link>https://jianye0428.github.io/posts/datastructrue/</link><pubDate>Sun, 16 Jul 2023 15:03:55 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/datastructrue/</guid><description><![CDATA[<h2 id="c-stl-standard-template-library-æ€»ç»“">C++ STL (Standard Template Library) æ€»ç»“</h2>
<p>C++ STL å®¹å™¨æ˜¯ä½¿ç”¨é¢‘ç‡è¶…é«˜çš„åŸºç¡€è®¾æ–½ï¼Œåªæœ‰äº†è§£å„ä¸ªå®¹å™¨çš„åº•å±‚åŸç†ï¼Œæ‰èƒ½å¾—å¿ƒåº”æ‰‹åœ°ç”¨å¥½ä¸åŒçš„å®¹å™¨ï¼Œåšåˆ°ç”¨æœ€åˆé€‚çš„å®¹å™¨å¹²æœ€åˆé€‚çš„äº‹æƒ…ã€‚</p>
<p>æœ¬æ–‡æ—¨åœ¨å¯¹ C++ æ ‡å‡†æ¨¡æ¿åº“çš„ <em>array</em>, <em>vector</em>, <em>deque</em>, <em>list</em>, <em>forward_list</em>, <em>queue</em>, <em>priority_queue</em>, <em>stack</em>, <em>map</em>, <em>multimap</em>, <em>set</em>, <em>multi_set</em>, <em>unordered_map</em>, <em>unordered_multimap</em>, <em>unordered_set</em>, <em>unordered_multiset</em> å…±åå…­ç±»å®¹å™¨è¿›è¡Œç³»ç»Ÿçš„å¯¹æ¯”åˆ†æï¼Œé‡ç‚¹å…³æ³¨å„ä¸ªå®¹å™¨çš„åº•å±‚åŸç†ä¸æ€§èƒ½ç‰¹ç‚¹ã€‚æœ¬æ–‡å”¯ä¸€å‚è€ƒèµ„æ–™ä¸ºC++å®˜æ–¹æ–‡æ¡£ï¼Œè‹¥æœ‰å…¶å®ƒå‚è€ƒåˆ™ä¼šæŒ‡æ˜å‡ºå¤„ã€‚</p>
<h3 id="1-array">1. array</h3>
<blockquote>
<p>Container properties: Sequence | Contiguous storage | Fixed-size aggregate
å®¹å™¨å±æ€§ï¼šé¡ºåºå®¹å™¨ï¼ˆæ”¯æŒéšæœºè®¿é—®ï¼‰ï¼Œè¿ç»­å†…å­˜ç©ºé—´ï¼Œå›ºå®šå¤§å°ï¼›//è¿ç»­å†…å­˜
ç±»æ¨¡æ¿å¤´ï¼štemplate &lt; class T, size_t N &gt; class array;</p>
</blockquote>
<p>array å³æ•°ç»„ï¼Œå…¶å¤§å°å›ºå®šï¼Œæ‰€æœ‰çš„å…ƒç´ ä¸¥æ ¼æŒ‰ç…§å†…å­˜åœ°å€çº¿æ€§æ’åˆ—ï¼Œarray å¹¶ä¸ç»´æŠ¤å…ƒç´ ä¹‹å¤–çš„ä»»ä½•å¤šä½™æ•°æ®ï¼Œç”šè‡³ä¹Ÿä¸ä¼šç»´æŠ¤ä¸€ä¸ªsizeè¿™æ ·çš„å˜é‡ï¼Œè¿™ä¿è¯äº†å®ƒåœ¨å­˜å‚¨æ€§èƒ½ä¸Šå’ŒC++è¯­æ³•ä¸­çš„æ•°ç»„ç¬¦å·[]æ— å¼‚ã€‚å°½ç®¡å…¶å®ƒå¤§éƒ¨åˆ†æ ‡å‡†å®¹å™¨éƒ½å¯ä»¥é€šè¿‡ std::allocator æ¥åŠ¨æ€çš„åˆ†é…å’Œå›æ”¶å†…å­˜ç©ºé—´ï¼Œä½† <strong>Array å¹¶ä¸æ”¯æŒè¿™æ ·åš</strong>ã€‚</p>
<p>Array å’Œå…¶å®ƒæ ‡å‡†å®¹å™¨ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸åŒæ˜¯ï¼š<u>å¯¹ä¸¤ä¸ª array æ‰§è¡Œ swap æ“ä½œæ„å‘³ç€çœŸçš„ä¼šå¯¹ç›¸åº” range å†…çš„å…ƒç´ ä¸€ä¸€ç½®æ¢</u>ï¼Œå› æ­¤å…¶æ—¶é—´èŠ±é”€æ­£æ¯”äºç½®æ¢è§„æ¨¡ï¼›ä½†åŒæ—¶ï¼Œå¯¹ä¸¤ä¸ª array æ‰§è¡Œ swap æ“ä½œä¸ä¼šæ”¹å˜ä¸¤ä¸ªå®¹å™¨å„è‡ªçš„è¿­ä»£å™¨çš„ä¾é™„å±æ€§ï¼Œè¿™æ˜¯ç”± array çš„ swap æ“ä½œä¸äº¤æ¢å†…å­˜åœ°å€å†³å®šçš„ã€‚</p>
<p>Array çš„å¦ä¸€ä¸ªç‰¹æ€§æ˜¯ï¼šä¸åŒäºå…¶å®ƒå®¹å™¨ï¼Œ<font color = red>array å¯ä»¥è¢«å½“ä½œ std::tuple ä½¿ç”¨</font>ï¼Œå› ä¸º array çš„å¤´æ–‡ä»¶é‡è½½äº†get()ä»¥åŠtuple_size()å’Œtuple_element()å‡½æ•°ï¼ˆæ³¨æ„è¿™äº›å‡½æ•°é array çš„æˆå‘˜å‡½æ•°ï¼Œè€Œæ˜¯å¤–éƒ¨å‡½æ•°ï¼‰ã€‚</p>
<p>æœ€åéœ€è¦æ³¨æ„ï¼Œè™½ç„¶ array å’Œ C++è¯­æ³•ä¸­çš„[]ç¬¦å·æ— é™æ¥è¿‘ï¼Œä½†ä¸¤è€…æ˜¯ä¸¤ä¸ªå­˜åœ¨ï¼Œarray æ¯•ç«Ÿæ˜¯æ ‡å‡†æ¨¡æ¿åº“çš„ä¸€å‘˜ï¼Œæ˜¯ä¸€ä¸ªclassï¼Œå› æ­¤æ”¯æŒ
<code>begin(), end(), front(), back(), at(), empty(), data(), fill(), swap(), ... </code> ç­‰ç­‰æ ‡å‡†æ¥å£ï¼Œè€Œ[]æ˜¯çœŸæ­£çš„æœ€æœ´ç´ çš„æ•°ç»„ã€‚</p>
<h3 id="2-vector">2. vector</h3>
<blockquote>
<p>Container properties: Sequence | Dynamic array | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color = red>é¡ºåºå®¹å™¨</font>ï¼ˆæ”¯æŒéšæœºè®¿é—®ï¼‰ï¼ŒåŠ¨æ€è°ƒæ•´å¤§å°ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼›//è¿ç»­å†…å­˜
ç±»æ¨¡æ¿å¤´ï¼štemplate &lt; class T, class Alloc = allocator<T> &gt; class vector;</p>
</blockquote>
<p>ä¸€å¥è¯æ¥è¯´ï¼Œ<u>vector å°±æ˜¯èƒ½å¤ŸåŠ¨æ€è°ƒæ•´å¤§å°çš„ array</u>ã€‚å’Œ array ä¸€æ ·ï¼Œvector ä½¿ç”¨<font color=red>è¿ç»­å†…å­˜ç©ºé—´</font>æ¥ä¿å­˜å…ƒç´ ï¼Œè¿™æ„å‘³ç€å…¶å…ƒç´ å¯ä»¥ç”¨æ™®é€šæŒ‡é’ˆçš„<code>++</code>å’Œ<code>--</code>æ“ä½œæ¥è®¿é—®ï¼›ä¸åŒäº array çš„æ˜¯ï¼Œå…¶<strong>å­˜å‚¨ç©ºé—´å¯ä»¥è‡ªåŠ¨è°ƒæ•´</strong>ã€‚</p>
<p>åœ¨åº•å±‚ä¸Šï¼Œvector ä½¿ç”¨åŠ¨æ€åˆ†é…çš„ arrayï¼Œå½“ç°æœ‰ç©ºé—´æ— æ³•æ»¡è¶³å¢é•¿éœ€æ±‚æ—¶ï¼Œä¼šé‡æ–°åˆ†é…ï¼ˆreallocateï¼‰ä¸€ä¸ªæ›´å¤§çš„ array å¹¶æŠŠæ‰€æœ‰å…ƒç´ ç§»åŠ¨è¿‡å»ï¼Œå› æ­¤ï¼Œ<font color=red>vector çš„ reallocate æ˜¯ä¸€ä¸ªå¾ˆè€—æ—¶çš„å¤„ç†</font>ã€‚æ‰€ä»¥ï¼Œæ¯æ¬¡ reallocate æ—¶éƒ½ä¼šé¢„ç•™å¤šä½™çš„ç©ºé—´ï¼Œä»¥æ»¡è¶³æ½œåœ¨çš„å¢é•¿éœ€æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œvectorçš„capacity()é€šå¸¸ä¼šå¤§äºsize()ã€‚vector ä»€ä¹ˆæ—¶å€™åš reallocateï¼Œreallocate å¤šå°‘å¤šä½™ç©ºé—´ï¼Œæ˜¯æœ‰å…·ä½“ç­–ç•¥çš„ï¼ŒæŒ‰ä¸‹ä¸è¡¨ã€‚æ€»ä½“æ¥è¯´ï¼Œ<u>vector æ¯” array å¤šäº†ä¸€äº›å†…å­˜æ¶ˆè€—ï¼Œä»¥æ¢å–æ›´çµæ´»çš„å†…å­˜ç®¡ç†</u>ã€‚</p>
<p>å’Œå…¶å®ƒçš„åŠ¨æ€é¡ºåºå®¹å™¨ï¼ˆdeque, list, forward_listï¼‰ç›¸æ¯”ï¼Œ<u>vector åœ¨å…ƒç´ è®¿é—®ä¸Šæ•ˆç‡æœ€é«˜ï¼Œåœ¨å°¾éƒ¨å¢åˆ å…ƒç´ çš„æ•ˆç‡ä¹Ÿç›¸å¯¹æœ€é«˜</u>ã€‚å¦‚æœè°ƒç”¨è€…æœ‰åœ¨å°¾éƒ¨ä»¥å¤–çš„åœ°æ–¹å¢åˆ å…ƒç´ çš„éœ€æ±‚ï¼Œvector åˆ™ä¸å¦‚å…¶å®ƒå®¹å™¨ï¼Œå¹¶ä¸”è¿­ä»£å™¨çš„ä¸€è‡´æ€§ä¹Ÿè¾ƒå·®ï¼ˆhave less consistent iterators and references than lists and forward_listsï¼‰ã€‚</p>
<h3 id="3-queue">3. queue</h3>
<blockquote>
<p>å®¹å™¨å±æ€§ï¼š<font color=red>å®¹å™¨é€‚é…å™¨(adapter)</font>ï¼Œå…ˆè¿›å…ˆå‡ºå‹å®¹å™¨ï¼ˆFIFOï¼‰ï¼›//C++è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼
template &lt;class T, class Container = deque<T> &gt; class queue;</p>
</blockquote>
<p>queueï¼ˆæ™®é€šé˜Ÿåˆ—ï¼‰æ˜¯ä¸€ä¸ªä¸“ä¸º FIFO è®¾è®¡çš„å®¹å™¨é€‚é…å™¨ï¼Œä¹Ÿå³åªèƒ½ä»ä¸€ç«¯æ’å…¥ã€ä»å¦ä¸€ç«¯åˆ é™¤ï¼›æ‰€è°“å®¹å™¨é€‚é…å™¨ï¼Œæ˜¯æŒ‡å®ƒæœ¬èº«åªæ˜¯ä¸€ä¸ªå°è£…å±‚ï¼Œå¿…é¡»ä¾èµ–æŒ‡å®šçš„åº•å±‚å®¹å™¨ï¼ˆé€šè¿‡æ¨¡æ¿å‚æ•°ä¸­çš„class ContaineræŒ‡å®šï¼‰æ‰èƒ½å®ç°å…·ä½“åŠŸèƒ½ã€‚</p>
<p>**å®¹å™¨é€‚é…å™¨(Adapter)**å®é™…ä¸Šæ˜¯C++è®¾è®¡æ¨¡å¼çš„ä¸€ç§ &ndash; ç§°ä¸º Adapter æ¨¡å¼ï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰ï¼ŒAdapter æ¨¡å¼çš„ç›®çš„æ˜¯å°†ç¬¬ä¸‰æ–¹åº“æä¾›çš„æ¥å£åšä¸€ä¸ªå°è£…å’Œè½¬åŒ–ï¼Œä½¿å…¶é€‚é…è‡ªå·±å·¥ç¨‹ä¸­é¢„ç•™çš„æ¥å£ï¼Œæˆ–è€…é€‚åº”è‡ªå·±å·¥ç¨‹çš„è°ƒç”¨é£æ ¼ã€‚æ¢å¥è¯è¯´ï¼ŒAdapter æ¨¡å¼çš„ç›®çš„æ˜¯å°†è¢«è°ƒç”¨ç±»ï¼ˆå¦‚ç¬¬ä¸‰æ–¹åº“ï¼‰çš„æ¥å£è½¬åŒ–ä¸ºå¸Œæœ›çš„æ¥å£ã€‚</p>
<p>å›åˆ°æ­£é¢˜ï¼Œqueue å¯ä»¥æ¥çº³ä»»ä½•ä¸€ä¸ªè‡³å°‘æ”¯æŒä¸‹åˆ—æ¥å£çš„å®¹å™¨ä½œä¸ºåº•å±‚å®¹å™¨ï¼š</p>
<blockquote>
<p>empty(); size(); front(); back(); push_back(); pop_front().</p>
</blockquote>
<p>åœ¨æ ‡å‡†æ¨¡æ¿åº“å®¹å™¨ä¸­ï¼Œdeque å’Œ list æ»¡è¶³ä¸Šè¿°è¦æ±‚ï¼Œå½“ç„¶ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ»¡è¶³ä¸Šè¿°è¦æ±‚çš„å®¹å™¨ã€‚é€šè¿‡æ¨¡æ¿å‚æ•°å¯ä»¥çœ‹å‡ºï¼Œ<font color=red>é»˜è®¤æƒ…å†µä¸‹ï¼Œqueue ä½¿ç”¨ deque ä½œä¸ºåº•å±‚å®¹å™¨</font>ã€‚</p>
<h3 id="4-deque">4. deque</h3>
<blockquote>
<p>Container properties: Sequence | Dynamic array | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color=red>é¡ºåºå®¹å™¨</font>ï¼ˆæ”¯æŒéšæœºè®¿é—®ï¼‰ï¼ŒåŠ¨æ€è°ƒæ•´å¤§å°ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼›//åˆ†æ®µè¿ç»­å†…å­˜
ç±»æ¨¡æ¿å¤´ï¼štemplate &lt; class T, class Alloc = allocator<T> &gt; class deque;</p>
</blockquote>
<p>dequeï¼ˆè¯»ä½œ&quot;deck&quot;ï¼‰æ˜¯ double-ended queue çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥åœ¨é¦–å°¾ä¸¤ç«¯è¿›è¡ŒåŠ¨æ€å¢åˆ çš„é¡ºåºå®¹å™¨ã€‚</p>
<p>ä¸åŒçš„åº“å¯¹ deque çš„å®ç°å¯èƒ½ä¸åŒï¼Œä½†å¤§ä½“ä¸Šéƒ½æ˜¯<font color=green>æŸç§å½¢å¼çš„åŠ¨æ€ array</font>ï¼Œä¸”éƒ½æ”¯æŒéšæœºè®¿é—®ã€‚deque çš„åŠŸèƒ½å’Œ vector æ¯”è¾ƒæ¥è¿‘ï¼Œä½† deque é¢å¤–æ”¯æŒåœ¨å¤´éƒ¨åŠ¨æ€å¢åˆ å…ƒç´ ã€‚å’Œ vector ä¸ä¸€æ ·çš„æ˜¯ï¼Œ<font color = red><u>deque ä¸ä¿è¯å­˜å‚¨åŒºåŸŸä¸€å®šæ˜¯è¿ç»­çš„!</u></font> å› æ­¤ç”¨æŒ‡å‘å…ƒç´ çš„æ™®é€šæŒ‡é’ˆåš<code>++</code>å’Œ<code>--</code>æ“ä½œæ˜¯éå¸¸å±é™©çš„è¡Œä¸ºã€‚</p>
<p>ä»åº•å±‚æœºç†ä¸Šèƒ½æ›´é€å½»åœ°ç†è§£ deque çš„ç‰¹ç‚¹ï¼š<font color = red>vector ä½¿ç”¨çš„æ˜¯å•ä¸€çš„ arrayï¼Œdeque åˆ™ä¼šä½¿ç”¨å¾ˆå¤šä¸ªç¦»æ•£çš„ array æ¥ç»„ç»‡æ•°æ®</font>ã€Œthe elements of a deque can be scattered in different chunks of storageã€ï¼å¦‚æœè¯´ vector æ˜¯è¿ç»­çš„ï¼Œdeque åˆ™æ˜¯åˆ†æ®µè¿ç»­ã€‚deque ä¼šç»´æŠ¤ä¸åŒ array ä¹‹é—´çš„å…³è”ä¿¡æ¯ï¼Œä½¿ç”¨æˆ·æ— éœ€å…³å¿ƒåˆ†æ®µè¿™ä¸ªäº‹å®ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¾ˆæ˜æ˜¾çš„ï¼šdeque åœ¨ reallocate æ—¶ï¼Œåªéœ€æ–°å¢/é‡Šæ”¾ä¸¤ç«¯çš„ storage chunk å³å¯ï¼Œæ— éœ€ç§»åŠ¨å·²æœ‰æ•°æ®ï¼ˆvector çš„å¼Šç«¯ï¼‰ï¼Œæå¤§æå‡äº†æ•ˆç‡ï¼Œå°¤å…¶åœ¨æ•°æ®è§„æ¨¡å¾ˆå¤§æ—¶ï¼Œä¼˜åŠ¿æ˜æ˜¾ã€‚</p>
<p>ç›¸æ¯”äº vector å’Œ listï¼Œdeque å¹¶ä¸é€‚åˆéå†ï¼å› ä¸ºæ¯æ¬¡è®¿é—®å…ƒç´ æ—¶ï¼Œdeque åº•å±‚éƒ½è¦æ£€æŸ¥æ˜¯å¦è§¦è¾¾äº†å†…å­˜ç‰‡æ®µçš„è¾¹ç•Œï¼Œé€ æˆäº†é¢å¤–çš„å¼€é”€ï¼deque çš„æ ¸å¿ƒä¼˜åŠ¿æ˜¯åœ¨åŒç«¯éƒ½æ”¯æŒé«˜æ•ˆçš„å¢åˆ æ“ä½œï¼Œç¨‹åºå‘˜é€‰æ‹©ä½¿ç”¨ deque æ—¶éœ€è¦æœ‰åŒç«¯æ“ä½œçš„æ˜ç¡®ç†ç”±ã€‚</p>
<h3 id="5-priority_queue">5. priority_queue</h3>
<blockquote>
<p>å®¹å™¨å±æ€§ï¼š<font color=red>å®¹å™¨é€‚é…å™¨</font>ï¼Œä¸¥æ ¼å¼±åºï¼ˆStrict Weak Orderingï¼‰ï¼Œä¼˜å…ˆçº§é˜Ÿåˆ—ï¼›
template &lt;class T, class Container = vector<T>,
class Compare = less<typename Container::value_type> &gt; class priority_queue;</p>
</blockquote>
<p>å’Œ queue ç±»ä¼¼ï¼Œpriority_queueï¼ˆæœ¯è¯­å«ä½œä¼˜å…ˆçº§é˜Ÿåˆ—ï¼‰ä¹Ÿåªæ˜¯ä¸€ä¸ªå®¹å™¨é€‚é…å™¨ï¼Œéœ€è¦æŒ‡å®šåº•å±‚å®¹å™¨æ‰èƒ½å®ä¾‹åŒ–ï¼Œå‚è§æ¨¡æ¿å‚æ•°ä¸­çš„class Containerå½¢å‚ã€‚priority_queue çš„æ ¸å¿ƒç‰¹ç‚¹åœ¨äºå…¶ä¸¥æ ¼å¼±åºç‰¹æ€§ï¼ˆstrict weak orderingï¼‰ï¼šä¹Ÿå³ priority_queue ä¿è¯å®¹å™¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å§‹ç»ˆæ˜¯æ‰€æœ‰å…ƒç´ ä¸­æœ€å¤§çš„ï¼ä¸ºæ­¤ï¼Œç”¨æˆ·åœ¨å®ä¾‹åŒ–ä¸€ä¸ª priority_queue æ—¶ï¼Œå¿…é¡»ä¸ºå…ƒç´ ç±»å‹ï¼ˆclass Tï¼‰é‡è½½&lt;è¿ç®—ç¬¦ï¼Œä»¥ç”¨äºå…ƒç´ æ’åºï¼</p>
<p>priority_queue çš„åŸç†å¯ä»¥ç”¨ä¸€ä¸ªå¤§é¡¶å †æ¥è§£é‡Šï¼špriority_queue åœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªåŸºäºäºŒå‰æ ‘çš„å¤§é¡¶å †æ•°æ®ç»“æ„ï¼Œåœ¨è¿™ä¸ªæ•°æ®ç»“æ„ä¸­ï¼Œæœ€å¤§çš„å…ƒç´ å§‹ç»ˆä½äºå †é¡¶éƒ¨ï¼Œä¸”åªæœ‰å †é¡¶éƒ¨çš„å…ƒç´ ï¼ˆmax heap elementï¼‰æ‰èƒ½è¢«è®¿é—®å’Œè·å–ï¼Œå¤§é¡¶å †çš„å…·ä½“åŸç†å¯å‚è§ä»»ä½•ä¸€æœ¬æ•°æ®ç»“æ„ä¹¦ç±ã€‚</p>
<p>ä¸ºäº†æ”¯æŒè¿™ç§å·¥ä½œåŸç†ï¼Œpriority_queue å¯¹åº•å±‚å®¹å™¨ä¹Ÿæ˜¯æœ‰è¦æ±‚çš„ï¼Œpriority_queue çš„åº•å±‚å®¹å™¨å¿…é¡»æ”¯æŒéšæœºè®¿é—®å’Œè‡³å°‘ä»¥ä¸‹æ¥å£ï¼š</p>
<blockquote>
<p>empty(); size(); front(); push_back(); pop_back().</p>
</blockquote>
<p>æ ‡å‡†æ¨¡æ¿åº“ä¸­çš„ vector å’Œ deque èƒ½å¤Ÿæ»¡è¶³ä¸Šè¿°éœ€æ±‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œpriority_queue ä½¿ç”¨ vector ä½œä¸ºåº•å±‚å®¹å™¨ã€‚</p>
<p>æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ï¼Œpriority_queue é»˜è®¤åœ¨ vector ä¸Šä½¿ç”¨å †ç®—æ³•å°† vector ä¸­å…ƒç´ æ„é€ æˆå¤§é¡¶å †çš„ç»“æ„ï¼Œå› æ­¤ priority_queue å°±æ˜¯å † ï¼Œæ‰€æœ‰éœ€è¦ç”¨åˆ°å †çš„ä½ç½®ï¼Œéƒ½å¯ä»¥è€ƒè™‘ä½¿ç”¨ priority_queueã€‚priority_queue é»˜è®¤æ˜¯å¤§é¡¶å †ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ¨¡æ¿å‚æ•°ä¸­çš„ class Compare æ¥å®ç°ä¸€ä¸ªå°é¡¶å †ã€‚</p>
<p>ç›¸æ¯”äº queueï¼ˆæ™®é€šé˜Ÿåˆ—ï¼‰çš„å…ˆè¿›å…ˆå‡ºFIFOï¼Œpriority_queue å®ç°äº†æœ€é«˜ä¼˜å…ˆçº§å…ˆå‡ºã€‚</p>
<h3 id="6-list">6. list</h3>
<blockquote>
<p>Container properties: Sequence | Doubly-linked list | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color = red>é¡ºåºå®¹å™¨</font>ï¼ˆå¯é¡ºåºè®¿é—®ï¼Œä½†ä¸æ”¯æŒéšæœºè®¿é—®ï¼‰ï¼ŒåŒé“¾è¡¨ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼›//ç¦»æ•£å†…å­˜
ç±»æ¨¡æ¿å¤´ï¼štemplate &lt; class T, class Alloc = allocator<T> &gt; class list;</p>
</blockquote>
<p>list æ˜¯ä¸€ç§æ”¯æŒåœ¨<strong>ä»»æ„ä½ç½®éƒ½å¯ä»¥å¿«é€Ÿåœ°æ’å…¥å’Œåˆ é™¤</strong>å…ƒç´ çš„å®¹å™¨ï¼Œä¸”æ”¯æŒ<strong>åŒå‘éå†</strong>ã€‚list å®¹å™¨èƒ½å¤Ÿåšåˆ°è¿™äº›çš„åŸå› åœ¨äº<strong>å…¶åº•å±‚ç»“æ„æ˜¯åŒé“¾è¡¨</strong>ï¼ŒåŒé“¾è¡¨å…è®¸æŠŠå„ä¸ªå…ƒç´ éƒ½ä¿å­˜åœ¨å½¼æ­¤ä¸ç›¸å¹²çš„å†…å­˜åœ°å€ä¸Šï¼Œä½†æ¯ä¸ªå…ƒç´ éƒ½ä¼šä¸å‰åç›¸é‚»å…ƒç´ å…³è”ã€‚</p>
<p>å’Œå…¶å®ƒçš„é¡ºåºå®¹å™¨ï¼ˆarray, vector, dequeï¼‰ç›¸æ¯”ï¼Œ<u>list çš„æœ€å¤§ä¼˜åŠ¿åœ¨äºæ”¯æŒåœ¨ä»»æ„ä½ç½®æ’å…¥ã€åˆ é™¤å’Œç§»åŠ¨å…ƒç´ </u>ï¼Œå¯¹ list æ¥è¯´ï¼Œåœ¨å“ªä¸ªä½ç½®è¿›è¡Œæ“ä½œå¹¶æ²¡æœ‰åŒºåˆ«ã€‚list åœ¨éƒ¨åˆ†ç®—æ³•ï¼ˆå¦‚ sortingï¼‰ä¸­çš„æ•ˆç‡å¯èƒ½ä¼˜äºå…¶å®ƒé¡ºåºå®¹å™¨ã€‚</p>
<p>list çš„<strong>ä¸»è¦ç¼ºç‚¹</strong>æ˜¯<u>ä¸æ”¯æŒå…ƒç´ çš„éšæœºè®¿é—®</u>ï¼å¦‚æœæˆ‘ä»¬æƒ³è¦è®¿é—®æŸä¸ªå…ƒç´ ï¼Œåˆ™å¿…é¡»ä»ä¸€ä¸ªå·²çŸ¥å…ƒç´ ï¼ˆå¦‚ begin æˆ– endï¼‰å¼€å§‹æœä¸€ä¸ªæ–¹å‘éå†ï¼Œç›´è‡³åˆ°è¾¾è¦è®¿é—®çš„å…ƒç´ ã€‚æ­¤å¤–ï¼Œlist è¿˜è¦æ¶ˆè€—æ›´å¤šçš„å†…å­˜ç©ºé—´ï¼Œç”¨äºä¿å­˜å„ä¸ªå…ƒç´ çš„å…³è”ä¿¡æ¯ã€‚</p>
<p>[å¦è¯´] <strong>list å¯¹å†…å­˜ç©ºé—´çš„ä½¿ç”¨æ•ˆç‡å¹¶ä¸é«˜ï¼Œä¸€æ–¹é¢å…ƒç´ å†…å­˜åœ°å€æ˜¯ç¦»æ•£çš„è€Œéè¿ç»­ï¼Œå¦ä¸€æ–¹é¢ï¼Œlist éœ€è¦ä¿å­˜é¢å¤–çš„å…³è”ä¿¡æ¯ã€‚</strong></p>
<h3 id="7-forward_list">7. forward_list</h3>
<blockquote>
<p>Container properties: Sequence | Linked list | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color = red>é¡ºåºå®¹å™¨</font>ï¼ˆå¯é¡ºåºè®¿é—®ï¼Œä½†ä¸æ”¯æŒéšæœºè®¿é—®ï¼‰ï¼Œå•é“¾è¡¨ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼›
ç±»æ¨¡æ¿å¤´ï¼štemplate &lt; class T, class Alloc = allocator<T> &gt; class list;</p>
</blockquote>
<p>forward_list ä¹Ÿæ˜¯ä¸€ç§æ”¯æŒåœ¨ä»»æ„ä½ç½®å¿«é€Ÿæ’å…¥å’Œåˆ é™¤å…ƒç´ çš„å®¹å™¨ï¼Œforward_list ç›¸æ¯”äº list çš„æ ¸å¿ƒåŒºåˆ«æ˜¯å®ƒæ˜¯ä¸€ä¸ªå•é“¾è¡¨ï¼Œå› æ­¤, æ¯ä¸ªå…ƒç´ åªä¼šä¸ç›¸é‚»çš„ä¸‹ä¸€ä¸ªå…ƒç´ å…³è”ï¼ç”±äºå…³è”ä¿¡æ¯å°‘äº†ä¸€åŠï¼Œå› æ­¤ forward_list å ç”¨çš„å†…å­˜ç©ºé—´æ›´å°ï¼Œä¸”æ’å…¥å’Œåˆ é™¤çš„æ•ˆç‡ç¨ç¨é«˜äº listã€‚ä½œä¸ºä»£ä»·ï¼Œforward_list åªèƒ½å•å‘éå†ã€‚</p>
<p>ç›¸æ¯”äºå…¶å®ƒé¡ºåºå®¹å™¨ï¼ˆarray, vector, dequeï¼‰ï¼Œforward_list çš„ä¼˜ç¼ºç‚¹å’Œ list åŸºæœ¬ç›¸åŒã€‚</p>
<p>æ—¢ç„¶å·²ç»æœ‰äº† listï¼Œä¸ºä»€ä¹ˆ C++ STL åˆè®¾è®¡äº† forward_list è¿™ä¸€å®¹å™¨å‘¢ï¼Ÿè®¾è®¡ forward_list çš„ç›®çš„æ˜¯ä¸ºäº†è¾¾åˆ°ä¸è¾“äºä»»ä½•ä¸€ä¸ªCé£æ ¼<strong>æ‰‹å†™é“¾è¡¨çš„æå€¼æ•ˆç‡</strong>ï¼ä¸ºæ­¤ï¼Œforward_list æ˜¯ä¸€ä¸ªæœ€å°é“¾è¡¨è®¾è®¡ï¼Œå®ƒç”šè‡³æ²¡æœ‰size()æ¥å£ï¼Œå› ä¸ºå†…éƒ¨ç»´æŠ¤ä¸€ä¸ªsizeå˜é‡ä¼šé™ä½å¢åˆ å…ƒç´ çš„æ•ˆç‡ã€‚å¦‚æœæƒ³è¦è·å– forward_list çš„ sizeï¼Œä¸€ä¸ªé€šå¸¸çš„åšæ³•æ˜¯ï¼Œç”¨ std::distance è®¡ç®— begin åˆ° end çš„è·ç¦»å¾—å‡º sizeã€‚ä¸€å¥è¯æ€»ç»“ï¼šlist å…¼é¡¾äº†æ¥å£ä¸°å¯Œæ€§ç‰ºç‰²äº†æ•ˆç‡ï¼Œè€Œ forward_list èˆå¼ƒäº†ä¸å¿…è¦çš„æ¥å£åªä¸ºè¿½æ±‚æè‡´æ•ˆç‡ã€‚</p>
<h3 id="8-stack">8. stack</h3>
<blockquote>
<p>å®¹å™¨å±æ€§ï¼š<font color = red>å®¹å™¨é€‚é…å™¨</font>ï¼Œåè¿›å…ˆå‡ºå‹å®¹å™¨ï¼ˆLIFOï¼‰ï¼›
template &lt;class T, class Container = deque<T> &gt; class stack;</p>
</blockquote>
<p>stackï¼ˆæ ˆï¼‰æ˜¯ä¸€ä¸ªä¸“ä¸º LIFO è®¾è®¡çš„å®¹å™¨é€‚é…å™¨ï¼Œä¹Ÿå³åªèƒ½ä»ä¸€ç«¯æ’å…¥å’Œåˆ é™¤ï¼›ä½œä¸ºé€‚é…å™¨ï¼Œéœ€è¦æŒ‡å®šåº•å±‚å®¹å™¨æ‰èƒ½å®ä¾‹åŒ–ï¼Œå‚è§æ¨¡æ¿å‚æ•°ä¸­çš„<code>class Container</code>å½¢å‚ã€‚</p>
<p>stack çš„ç‰¹ç‚¹æ˜¯åè¿›å…ˆå‡ºï¼ˆä¸€ç«¯è¿›å‡ºï¼‰ï¼Œä¸å…è®¸éå†ï¼›ä»»ä½•æ—¶å€™å¤–ç•Œåªèƒ½è®¿é—® stack é¡¶éƒ¨çš„å…ƒç´ ï¼›åªæœ‰åœ¨ç§»é™¤ stack é¡¶éƒ¨çš„å…ƒç´ åï¼Œæ‰èƒ½è®¿é—®ä¸‹æ–¹çš„å…ƒç´ ã€‚stack éœ€è¦åº•å±‚å®¹å™¨èƒ½å¤Ÿåœ¨ä¸€ç«¯å¢åˆ å…ƒç´ ï¼Œè¿™ä¸€ç«¯ä¹Ÿå³ stack çš„â€œæ ˆé¡¶â€ï¼›stack å¯ä»¥æ¥çº³ä»»ä½•ä¸€ä¸ªè‡³å°‘æ”¯æŒä¸‹åˆ—æ¥å£çš„å®¹å™¨ä½œä¸ºåº•å±‚å®¹å™¨ï¼š</p>
<blockquote>
<p>empty(); size(); back(); push_back(); pop_back()</p>
</blockquote>
<p>åœ¨æ ‡å‡†æ¨¡æ¿åº“å®¹å™¨ä¸­ï¼Œvectorã€deque å’Œ list æ»¡è¶³ä¸Šè¿°è¦æ±‚ï¼Œå½“ç„¶ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ»¡è¶³ä¸Šè¿°è¦æ±‚çš„å®¹å™¨ã€‚é€šè¿‡æ¨¡æ¿å‚æ•°å¯ä»¥çœ‹å‡ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>stack ä½¿ç”¨ deque ä½œä¸ºåº•å±‚å®¹å™¨</strong>ã€‚</p>
<p>stack å®¹å™¨åº”ç”¨å¹¿æ³›ï¼Œä¾‹å¦‚ï¼Œç¼–è¾‘å™¨ä¸­çš„ undo ï¼ˆæ’¤é”€æ“ä½œï¼‰æœºåˆ¶å°±æ˜¯ç”¨æ ˆæ¥è®°å½•è¿ç»­çš„æ“ä½œã€‚stack çš„è®¾è®¡åœºæ™¯å’Œè‡ªåŠ©é¤é¦†ä¸­å †å çš„ç›˜å­ã€æ‘èµ·æ¥çš„ä¸€å †ä¹¦ç±»ä¼¼ã€‚</p>
<h3 id="9-map">9. map</h3>
<blockquote>
<p>Container properties: Associative | Ordered | Map | Unique keys | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color = red>å…³è”å®¹å™¨</font>ï¼Œæœ‰åºï¼Œå…ƒç´ ç±»å‹&lt;key, value&gt;ï¼Œkeyæ˜¯å”¯ä¸€çš„ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼›
template &lt; class Key, // map::key_type
class T, // map::mapped_type
class Compare = less<Key>, // map::key_compare
class Alloc = allocator&lt;pair&lt;const Key,T&gt; &gt; // map::allocator_type
class map;</p>
</blockquote>
<p>map æ˜¯ä¸€ä¸ªå…³è”å‹å®¹å™¨ï¼Œå…¶å…ƒç´ ç±»å‹æ˜¯ç”± key å’Œ value ç»„æˆçš„ std::pairï¼Œå®é™…ä¸Š map ä¸­å…ƒç´ çš„æ•°æ®ç±»å‹æ­£æ˜¯ <code>typedef pair&lt;const Key, T&gt; value_type</code>;ï¼Œè¿™å°±çœ‹çš„å¾ˆæ¸…æ¥šäº†ã€‚</p>
<p>æ‰€è°“å…³è”å®¹å™¨ï¼Œæ˜¯æŒ‡<strong>å¯¹æ‰€æœ‰å…ƒç´ çš„æ£€ç´¢éƒ½æ˜¯é€šè¿‡å…ƒç´ çš„ key è¿›è¡Œçš„ï¼ˆè€Œéå…ƒç´ çš„å†…å­˜åœ°å€ï¼‰</strong>ï¼Œmap é€šè¿‡åº•å±‚çš„ã€Œçº¢é»‘æ ‘ã€æ•°æ®ç»“æ„æ¥å°†æ‰€æœ‰çš„å…ƒç´ æŒ‰ç…§ key çš„ç›¸å¯¹å¤§å°è¿›è¡Œæ’åºï¼Œæ‰€å®ç°çš„æ’åºæ•ˆæœä¹Ÿæ˜¯ä¸¥æ ¼å¼±åºç‰¹æ€§ï¼ˆstrict weak orderingï¼‰ï¼Œä¸ºæ­¤ï¼Œå¼€å‘è€…éœ€è¦é‡è½½ key çš„&lt;è¿ç®—ç¬¦æˆ–è€…æ¨¡æ¿å‚æ•°ä¸­çš„ class Compareã€‚æ‰€æåˆ°çš„çº¢é»‘æ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼Œå®ƒè¡ç”Ÿè‡ªBæ ‘ï¼Œè¿™é‡Œæ¨èä¸¤ç¯‡æ–‡ç« ï¼ˆ<a href="https://zhuanlan.zhihu.com/p/72505589"target="_blank" rel="external nofollow noopener noreferrer">è®°ä¸€æ¬¡è…¾è®¯é¢è¯•ï¼šæœ‰äº†äºŒå‰æŸ¥æ‰¾æ ‘ã€å¹³è¡¡æ ‘ï¼ˆAVLï¼‰ä¸ºå•¥è¿˜éœ€è¦çº¢é»‘æ ‘ï¼Ÿ<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ï¼Œ<a href="https://zhuanlan.zhihu.com/p/273829162"target="_blank" rel="external nofollow noopener noreferrer">å›¾è§£ï¼šä»€ä¹ˆæ˜¯çº¢é»‘æ ‘ï¼Ÿ<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ï¼‰ä½œä¸ºæ›´æ·±å…¥çš„å‚è€ƒã€‚</p>
<p>å¤§ä½“æ¥è¯´ï¼Œmap è®¿é—®å…ƒç´ çš„é€Ÿåº¦è¦ç¨æ…¢äºä¸‹æ–‡çš„ unordered_mapï¼Œè¿™æ˜¯å› ä¸ºè™½ç„¶éƒ½å«â€œmapâ€ï¼Œä½†ä¸¤è€…çš„åº•å±‚æœºåˆ¶å®Œå…¨ä¸ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œç›¸æ¯”äºåè€…ï¼Œmap æ”¯æŒåœ¨ä¸€ä¸ªå­é›†åˆä¸Šè¿›è¡Œç›´æ¥è¿­ä»£å™¨è®¿é—®ï¼ŒåŸå› åœ¨äº map ä¸­çš„å…ƒç´ æ˜¯è¢«æœ‰åºç»„ç»‡çš„ã€‚</p>
<p>æœ€åï¼Œmap ä¹Ÿæ”¯æŒé€šè¿‡operator[]çš„æ–¹å¼æ¥ç›´æ¥è®¿é—® valueã€‚</p>
<h3 id="10-multimap">10. multimap</h3>
<blockquote>
<p>Container properties: Associative | Ordered | Map | Multiple equivalent keys | Allocator-aware
å®¹å™¨å±æ€§: å…³è”å®¹å™¨ï¼Œæœ‰åºï¼Œå…ƒç´ ç±»å‹&lt;key, value&gt;ï¼Œå…è®¸ä¸åŒå…ƒç´ keyç›¸åŒï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨ç®¡ç†å†…å­˜ï¼›
template &lt; class Key, // map::key_type
class T, // map::mapped_type
class Compare = less<Key>, // map::key_compare
class Alloc = allocator&lt;pair&lt;const Key,T&gt; &gt; // map::allocator_type
class map;</p>
</blockquote>
<p><strong>map ä¸­ä¸å…è®¸å‡ºç° key ç›¸åŒçš„ä¸¤ä¸ªå…ƒç´ ï¼Œä½† multimap åˆ™å¯ä»¥è¿™æ ·åšï¼</strong></p>
<p>multimap ä¸ map åº•å±‚åŸç†å®Œå…¨ä¸€æ ·ï¼Œéƒ½æ˜¯ä½¿ç”¨ã€Œçº¢é»‘æ ‘ã€å¯¹å…ƒç´ æ•°æ®æŒ‰ key çš„æ¯”è¾ƒå…³ç³»ï¼Œè¿›è¡Œå¿«é€Ÿçš„æ’å…¥ã€åˆ é™¤å’Œæ£€ç´¢æ“ä½œï¼›æ‰€ä¸åŒçš„æ˜¯ multimap å…è®¸å°†å…·æœ‰ç›¸åŒ key çš„ä¸åŒå…ƒç´ æ’å…¥å®¹å™¨ï¼ˆè¿™ä¸ªä¸åŒä½“ç°äº† multimap å¯¹çº¢é»‘æ ‘çš„ä½¿ç”¨æ–¹å¼çš„å·®å¼‚ï¼‰ã€‚åœ¨ multimap å®¹å™¨ä¸­ï¼Œå…ƒç´ çš„ key ä¸å…ƒç´  value çš„æ˜ å°„å…³ç³»ï¼Œæ˜¯ä¸€å¯¹å¤šçš„ï¼Œå› æ­¤ï¼Œmultimap æ˜¯å¤šé‡æ˜ å°„å®¹å™¨ã€‚</p>
<p>æ³¨æ„ï¼Œåœ¨å‘ multimap ä¸­æ–°å¢å…ƒç´ æ—¶ï¼Œmultimap åªä¼šåˆ¤æ–­ key æ˜¯å¦ç›¸åŒï¼Œè€Œå®Œå…¨ä¸ä¼šåˆ¤æ–­ value æ˜¯å¦ç›¸åŒï¼<font color=red>è¿™æ„å‘³ç€å¦‚æœç›¸åŒçš„ &lt;key, value&gt; æ’å…¥äº†å¤šæ¬¡ï¼Œmultimap ä¼šå¯¹å®ƒä»¬æ‚‰æ•°ä¿å­˜ï¼</font></p>
<p>åœ¨ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿­ä»£å™¨é…åˆ lower_bound() å’Œ upper_bound() æ¥è®¿é—®ä¸€ä¸ª key å¯¹åº”çš„æ‰€æœ‰ valueï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨equal_range()æ¥è®¿é—®ä¸€ä¸ª key å¯¹åº”çš„æ‰€æœ‰ valueï¼Œä¹Ÿå¯ä»¥é€šè¿‡find()é…åˆcount()æ¥è®¿é—®ä¸€ä¸ª key å¯¹åº”çš„æ‰€æœ‰ valueï¼Œä¸ªäººè®¤ä¸ºå‰ä¸¤ç§æ–¹æ³•ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ä¸€ç‚¹ã€‚</p>
<p>ä¸‹æ–‡ä¸­å°†è¦æåˆ°çš„ multiset ä¹‹äº set ç±»ä¼¼äºè¿™é‡Œçš„ multimap ä¹‹äº mapã€‚</p>
<h3 id="11-set">11. set</h3>
<blockquote>
<p>Container properties: Associative | Ordered | Set | Unique keys | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color=red>å…³è”å®¹å™¨</font>ï¼Œæœ‰åºï¼Œå…ƒç´ è‡ªèº«å³keyï¼Œå…ƒç´ æœ‰å”¯ä¸€æ€§ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ï¼›
template &lt; class T, // set::key_type/value_type
class Compare = less<T>, // set::key_compare/value_compare
class Alloc = allocator<T> // set::allocator_type
class set;</p>
</blockquote>
<p>set æ˜¯ä¸€ä¸ªå…³è”å‹å®¹å™¨ï¼Œå’Œ map ä¸€æ ·ï¼Œå®ƒçš„åº•å±‚ç»“æ„æ˜¯ã€Œçº¢é»‘æ ‘ã€ï¼Œä½†å’Œ map ä¸ä¸€æ ·çš„æ˜¯ï¼Œ<strong>set æ˜¯ç›´æ¥ä¿å­˜ value çš„</strong>ï¼Œæˆ–è€…è¯´ï¼Œset ä¸­çš„ value å°±æ˜¯ keyã€‚</p>
<p><strong>set ä¸­çš„å…ƒç´ å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä¸å…è®¸å‡ºç°é‡å¤çš„å…ƒç´ </strong>ï¼Œä¸”å…ƒç´ ä¸å¯æ›´æ”¹ï¼Œä½†å¯ä»¥è‡ªç”±æ’å…¥æˆ–è€…åˆ é™¤ã€‚</p>
<p>ç”±äºåº•å±‚æ˜¯çº¢é»‘æ ‘ï¼Œæ‰€ä»¥ set ä¸­çš„å…ƒç´ ä¹Ÿæ˜¯ä¸¥æ ¼å¼±åºï¼ˆstrict weak orderingï¼‰æ’åºçš„ï¼Œå› æ­¤<u>æ”¯æŒç”¨è¿­ä»£å™¨åšèŒƒå›´è®¿é—®</u>ï¼ˆè¿­ä»£å™¨è‡ªåŠ è‡ªå‡ï¼‰ã€‚</p>
<p>å®é™…ä½¿ç”¨ä¸­ï¼Œset å’Œ map æ˜¯è¿‘äº²ï¼Œæ€§èƒ½ç›¸ä¼¼ï¼Œä»–ä»¬çš„å·®åˆ«æ˜¯å…ƒç´ çš„ value æœ¬èº«æ˜¯å¦ä¹Ÿä½œä¸º key æ¥æ ‡è¯†è‡ªå·±ã€‚</p>
<h3 id="12-multi_set">12. multi_set</h3>
<blockquote>
<p>Container properties: Associative | Ordered | Set | Multiple equivalent keys | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color=red>å…³è”å®¹å™¨</font>ï¼Œæœ‰åºï¼Œå…ƒç´ è‡ªèº«å³keyï¼Œå…è®¸ä¸åŒå…ƒç´ å€¼ç›¸åŒï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼›
template &lt; class T, // multiset::key_type/value_type
class Compare = less<T>, // multiset::key_compare/value_compare
class Alloc = allocator<T> &gt; // multiset::allocator_type
class multiset;</p>
</blockquote>
<p>multiset ä¹‹äº set å°±å¦‚åŒ multimap ä¹‹äº mapï¼š</p>
<p>multiset å’Œ set åº•å±‚éƒ½æ˜¯çº¢é»‘æ ‘ï¼Œmultiset ç›¸æ¯”äº set æ”¯æŒä¿å­˜å¤šä¸ªç›¸åŒçš„å…ƒç´ ï¼›</p>
<p>multimap å’Œ map åº•å±‚éƒ½æ˜¯çº¢é»‘æ ‘ï¼Œmultimap ç›¸æ¯”äº map æ”¯æŒä¿å­˜å¤šä¸ªkeyç›¸åŒçš„å…ƒç´ ã€‚</p>
<p>é‰´äºä»¥ä¸Šè¿‘äº²å…³ç³»ï¼Œmultiset çš„æ€§èƒ½ç‰¹ç‚¹ä¸å…¶å®ƒä¸‰è€…ç›¸ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚</p>
<h3 id="13-unordered_map">13. unordered_map</h3>
<blockquote>
<p>Container properties: Associative | Unordered | Map | Unique keys | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color = red>å…³è”å®¹å™¨</font>ï¼Œæ— åºï¼Œå…ƒç´ ç±»å‹&lt;key, value&gt;ï¼Œkeyæ˜¯å”¯ä¸€çš„ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼› template &lt; class Key, // unordered_map::key_type
class T, // unordered_map::mapped_type
class Hash = hash<Key>, // unordered_map::hasher
class Pred = equal_to<Key>, // unordered_map::key_equal
class Alloc = allocator&lt; pair&lt;const Key,T&gt; &gt; // unordered_map::allocator_type
class unordered_map;</p>
</blockquote>
<p>unordered_map å’Œ map ä¸€æ ·ï¼Œéƒ½æ˜¯å…³è”å®¹å™¨ï¼Œä»¥é”®å€¼å¯¹å„¿ &lt;key, value&gt; ä½œä¸ºå…ƒç´ è¿›è¡Œå­˜å‚¨ï¼›ä½†æ˜¯ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä¸¤è€…å¯ä»¥è¯´æ˜¯å®Œå…¨ä¸ä¸€æ ·ï¼</p>
<p>è¿™æ˜¯ç”±åº•å±‚çš„æ•°æ®ç»“æ„å†³å®šçš„ï¼Œmap ä»¥çº¢é»‘æ ‘ä½œä¸ºåº•å±‚ç»“æ„ç»„ç»‡æ•°æ®ï¼Œè€Œ <strong>unordered_map ä»¥å“ˆå¸Œè¡¨(hash table)ä½œä¸ºåº•å±‚æ•°æ®ç»“æ„</strong>æ¥ç»„ç»‡æ•°æ®ï¼Œè¿™é€ æˆäº†ä¸¤ç‚¹é‡è¦å½±å“ï¼š
1. unordered_map ä¸æ”¯æŒæ’åºï¼Œ<font color=red>åœ¨ä½¿ç”¨è¿­ä»£å™¨åšèŒƒå›´è®¿é—®æ—¶ï¼ˆè¿­ä»£å™¨è‡ªåŠ è‡ªå‡ï¼‰æ•ˆç‡æ›´ä½</font>ï¼›
2. ä½† unordered_map ç›´æ¥è®¿é—®å…ƒç´ çš„é€Ÿåº¦æ›´å¿«ï¼ˆå°¤å…¶åœ¨è§„æ¨¡å¾ˆå¤§æ—¶ï¼‰ï¼Œå› ä¸ºå®ƒé€šè¿‡ç›´æ¥è®¡ç®— key çš„å“ˆå¸Œå€¼æ¥è®¿é—®å…ƒç´ ï¼Œæ˜¯O(1)å¤æ‚åº¦ï¼</p>
<p>ç½‘ç»œä¸Šæœ‰å¯¹ map VS unordered_map æ•ˆç‡å¯¹æ¯”çš„æµ‹è¯•ï¼Œé€šå¸¸ <strong>map å¢åˆ å…ƒç´ çš„æ•ˆç‡æ›´é«˜ï¼Œunordered_map è®¿é—®å…ƒç´ çš„æ•ˆç‡æ›´é«˜</strong>ï¼Œå¯ä»¥å‚è§<a href="https://link.zhihu.com/?target=https%3A//blog.csdn.net/uniqsa/article/details/62442383"target="_blank" rel="external nofollow noopener noreferrer">è¿™ç¯‡æ–‡ç« <i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ã€‚å¦å¤–ï¼Œunordered_map å†…å­˜å ç”¨æ›´é«˜ï¼Œå› ä¸ºåº•å±‚çš„å“ˆå¸Œè¡¨éœ€è¦é¢„åˆ†é…è¶³é‡çš„ç©ºé—´ã€‚</p>
<p>ç»¼ä¸Šï¼Œunordered_map æ›´é€‚ç”¨äºå¢åˆ æ“ä½œä¸å¤šï¼Œä½†éœ€è¦é¢‘ç¹è®¿é—®ï¼Œä¸”å†…å­˜èµ„æºå……è¶³çš„åœºåˆã€‚</p>
<blockquote>
<p>æ¯”å¦‚åœ¨æœºå™¨äººé¢†åŸŸçš„SLAMæŠ€æœ¯ä¸­ï¼Œå¯ä»¥é€‰æ‹© unordered_map æ¥ç»´æŠ¤ä½“ç´ å½¢å¼çš„ local mapï¼Ÿ å½“ç„¶ deque åº”è¯¥ä¹Ÿæ˜¯ä¸é”™çš„é€‰æ‹©ã€‚</p>
</blockquote>
<h3 id="14-unordered_multimap">14. unordered_multimap</h3>
<blockquote>
<p>Container properties: Associative | Unordered | Map | Multiple equivalent keys | Allocator-aware
å®¹å™¨å±æ€§ï¼šå…³è”å®¹å™¨ï¼Œæ— åºï¼Œå…ƒç´ ç±»å‹&lt;key, value&gt;ï¼Œå…è®¸ä¸åŒå…ƒç´ keyç›¸åŒï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨ç®¡ç†å†…å­˜ ï¼›
template &lt; class Key, // unordered_multimap::key_type
class T, // unordered_multimap::mapped_type
class Hash = hash<Key>, // unordered_multimap::hasher
class Pred = equal_to<Key>, // unordered_multimap::key_equal
class Alloc = allocator&lt; pair&lt;const Key,T&gt; &gt; // unordered_multimap::allocator_type
class unordered_multimap;</p>
</blockquote>
<p>unordered_multimap æ˜¯å¯¹ unordered_map çš„æ‹“å±•ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äº unordered_multimap å…è®¸ä¸åŒå…ƒç´ çš„ key ç›¸åŒï¼Œä½†ä¸¤è€…æ— è®ºæ˜¯åœ¨åº•å±‚ç»“æ„è¿˜æ˜¯åœ¨å®¹å™¨ç‰¹æ€§ä¸Šéƒ½æ˜¯ç›¸é€šçš„ï¼Œä»…ä»…æ˜¯å¯¹åº•å±‚å“ˆå¸Œè¡¨çš„ä½¿ç”¨æ–¹å¼ç¨æœ‰ä¸åŒã€‚</p>
<p>åœ¨ unordered_multimap ä¸­æƒ³è¦è®¿é—®åŒä¸€ä¸ª key ä¸‹å¯¹åº”çš„æ‰€æœ‰å…ƒç´ çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨equal_range()è½»æ¾åšåˆ°ï¼›å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨find()å’Œcount()é…åˆçš„æ–¹å¼æ¥è®¿é—®ã€‚</p>
<p>unordered_multimap çš„å®¹å™¨ç‰¹æ€§å‚è§ unordered_mapï¼Œä¸å†èµ˜è¿°ã€‚</p>
<h3 id="15-unordered_set">15. unordered_set</h3>
<blockquote>
<p>Container properties: Associative | Unordered | Set | Unique keys | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color=red>å…³è”å®¹å™¨</font>ï¼Œæ— åºï¼Œå…ƒç´ è‡ªèº«å³keyï¼Œå…ƒç´ æœ‰å”¯ä¸€æ€§ï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼›
template &lt; class Key, // unordered_set::key_type/value_type
class Hash = hash<Key>, // unordered_set::hasher
class Pred = equal_to<Key>, // unordered_set::key_equal
class Alloc = allocator<Key> // unordered_set::allocator_type
class unordered_set;</p>
</blockquote>
<p>æ‰€æœ‰unordered_XXXç±»å®¹å™¨çš„ç‰¹ç‚¹éƒ½æ˜¯ä»¥å“ˆå¸Œè¡¨ä½œä¸ºåº•å±‚ç»“æ„ï¼›æ‰€æœ‰ XXX_set ç±»å®¹å™¨çš„ç‰¹ç‚¹éƒ½æ˜¯ã€Œå…ƒç´ è‡ªèº«ä¹Ÿä½œä¸ºkeyã€æ¥æ ‡è¯†è‡ªå·±ã€‚æˆ‘ä»¬åœ¨æŠŠä¸¤ç±»ç‰¹æ€§å åŠ åˆ°ä¸€èµ·ï¼Œå°±å¾—åˆ°äº† unordered_setã€‚</p>
<p>åœ¨ unordered_set ä¸­ï¼Œå…ƒç´ è‡ªèº«åŒæ—¶ä¹Ÿä½œä¸º key ä½¿ç”¨ï¼›æ—¢ç„¶æ˜¯ä½œä¸º key ä½¿ç”¨ï¼Œé‚£ä¹ˆå…ƒç´ å°±ä¸èƒ½è¢«æ›´æ”¹ï¼Œä¹Ÿå³ unordered_set ä¸­çš„å…ƒç´ éƒ½æ˜¯ constant çš„ï¼Œä½†æˆ‘ä»¬å¯ä»¥è‡ªç”±çš„æ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œè¿™ä¹Ÿæ˜¯æ‰€æœ‰XXX_setç±»å®¹å™¨çš„æ€§è´¨ã€‚æ—¢ç„¶åº•å±‚ç»“æ„æ˜¯å“ˆå¸Œè¡¨ï¼Œæ„å‘³ç€ unordered_set ä¸­çš„å…ƒç´ æ˜¯æ— åºçš„ï¼Œä¸èƒ½æŒ‰ç…§å¤§å°æ’åºï¼Œè¿™ä¹Ÿæ˜¯æ‰€æœ‰unordered_XXXç±»å®¹å™¨çš„æ€§è´¨ã€‚</p>
<p>å’Œæ‰€æœ‰çš„unordered_XXXç±»å®¹å™¨ä¸€æ ·ï¼š
1. unordered_set ç›´æ¥ç”¨è¿­ä»£å™¨åšèŒƒå›´è®¿é—®æ—¶ï¼ˆè¿­ä»£å™¨è‡ªåŠ è‡ªå‡ï¼‰æ•ˆç‡æ›´ä½ï¼Œä½äº setï¼›
2. ä½† unordered_set ç›´æ¥è®¿é—®å…ƒç´ çš„é€Ÿåº¦æ›´å¿«ï¼ˆå°¤å…¶åœ¨è§„æ¨¡å¾ˆå¤§æ—¶ï¼‰ï¼Œå› ä¸ºå®ƒé€šè¿‡ç›´æ¥è®¡ç®— key çš„å“ˆå¸Œå€¼æ¥è®¿é—®å…ƒç´ ï¼Œæ˜¯O(1)å¤æ‚åº¦ï¼</p>
<h3 id="16-unordered_multiset">16. unordered_multiset</h3>
<blockquote>
<p>Container properties: Associative | Unordered | Set | Multiple equivalent keys | Allocator-aware
å®¹å™¨å±æ€§ï¼š<font color=red>å…³è”å®¹å™¨</font>ï¼Œæ— åºï¼Œå…ƒç´ è‡ªèº«å³keyï¼Œå…è®¸ä¸åŒå…ƒç´ å€¼ç›¸åŒï¼Œä½¿ç”¨å†…å­˜åˆ†é…å™¨åŠ¨æ€ç®¡ç†å†…å­˜ ï¼›
template &lt; class Key, // unordered_multiset::key_type/value_type
class Hash = hash<Key>, // unordered_multiset::hasher
class Pred = equal_to<Key>, // unordered_multiset::key_equal
class Alloc = allocator<Key> // unordered_multiset::allocator_type
class unordered_multiset;</p>
</blockquote>
<p>unordered_multisetï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯é›†é½äº†â€œå“ˆå¸Œè¡¨ä¸ºåº•å±‚ç»“æ„â€ï¼Œâ€œå…ƒç´ è‡ªèº«å³keyâ€ï¼Œâ€œå…è®¸ä¸åŒå…ƒç´ å€¼ç›¸åŒâ€è¿™ä¸‰ä¸ªç‰¹æ€§çš„å®¹å™¨ï¼Œæ˜¯å¯¹ unordered_set çš„ç®€å•æ‹“å±•ã€‚</p>
<p>unordered_multiset çš„æ•ˆç‡ç‰¹æ€§ä¸æ‰€æœ‰åŸºäºå“ˆå¸Œè¡¨çš„å®¹å™¨ç›¸ä¼¼ï¼Œå‚è§ unordered_setï¼Œä¸å†èµ˜è¿°ã€‚</p>
<h3 id="17-pair--tuple">17. pair &amp;&amp; tuple</h3>
<blockquote>
<p>template &lt;class&hellip; Types&gt; class tuple;
template &lt;class T1, class T2&gt; struct pair;</p>
</blockquote>
<p><code>std::pair</code> å’Œ <code>std::tuple</code> å¹¶ä¸æ˜¯stlå®¹å™¨åº“ä¸­çš„å®¹å™¨ï¼Œä¸è¿‡é‰´äºç»å¸¸ç”¨åˆ°ï¼Œå°±é¡ºä¾¿æ•´ç†ä¸€ä¸‹ã€‚å…ˆä» tuple è¯´èµ·ï¼Œpair ç›¸å½“äº tuple çš„ç‰¹ä¾‹ã€‚</p>
<p>tuple å«ä½œå…ƒç»„ï¼Œå®ƒå¯ä»¥æŠŠä¸€ç»„ç±»å‹ç›¸åŒæˆ–ä¸åŒçš„å…ƒç´ ç»„åˆåˆ°ä¸€èµ·ï¼Œä¸”å…ƒç´ çš„æ•°é‡ä¸é™ã€‚tuple çš„åº•å±‚åŸç†ä¸ stl ä¸­çš„å®¹å™¨å®Œå…¨ä¸åŒï¼Œä½†åœ¨åŠŸèƒ½ä¸Šï¼Œtuple æ˜¯å¯¹å®¹å™¨çš„æœ‰æ•ˆè¡¥å……ï¼Œå› ä¸ºæ‰€æœ‰çš„å®¹å™¨éƒ½åªèƒ½ç»„åˆç›¸åŒç±»å‹çš„å…ƒç´ ï¼Œä½†tuple å¯ä»¥ç»„åˆä»»æ„ä¸åŒç±»å‹çš„å…ƒç´ ã€‚åœ¨ä½¿ç”¨ä¸Šï¼Œå¯ä»¥ç”¨std::make_tuple()æ¥æ„é€  tuple å¯¹è±¡ï¼Œå¯ä»¥ç”¨std::get<index>()æ¥è·å– tuple å¯¹è±¡çš„æŸä¸ªå…ƒç´ ï¼Œæ³¨æ„std::get<index>()è¿”å›çš„æ˜¯ tuple å¯¹è±¡ä¸­æŸä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Œå› æ­¤æ˜¯å¯ä»¥ç”¨ä½œå·¦å€¼çš„ï¼æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨std::tie()æ‰“åŒ…ä¸€ç»„å˜é‡æ¥ä½œä¸ºå·¦å€¼æ¥å— tuple å¯¹è±¡çš„èµ‹å€¼ã€‚</p>
<p>tuple çš„åº•å±‚åŸç†å¤§æ¦‚æ˜¯ä¸€ä¸ªå±‚å±‚ç»§æ‰¿çš„ç±»ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒ<a href="https://zhuanlan.zhihu.com/p/356954012"target="_blank" rel="external nofollow noopener noreferrer">è¿™ç¯‡æ–‡ç« <i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ï¼Œå†™çš„éå¸¸é€å½»ã€‚</p>
<p>pair å¯ä»¥çœ‹ä½œæ˜¯æŠŠ tuple çš„ size é™åˆ¶ä¸º 2 çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œpair åªèƒ½æŠŠä¸€å¯¹å„¿å…ƒç´ ç»„åˆåˆ°ä¸€èµ·ã€‚åœ¨ä½¿ç”¨ä¸Šï¼Œå¯ä»¥ç”¨std::make_pair()æ¥ç›´æ¥æ„å»º pair å¯¹è±¡ï¼Œå¯ä»¥ç”¨std::get&lt;0&gt;()å’Œstd::get&lt;1&gt;()æ¥åˆ†åˆ«è·å– pair å¯¹è±¡çš„ä¸¤ä¸ªå…ƒç´ ï¼Œä½†æ›´æ–¹ä¾¿çš„åšæ³•æ˜¯ç›´æ¥è®¿é—® pair ç±»å‹çš„ä¸¤ä¸ªæ•°æ®æˆå‘˜pairå¯¹è±¡.firstå’Œpairå¯¹è±¡.secondæ¥è®¿é—®å…ƒç´ </p>
<p>reference:
[1]. <a href="https://zhuanlan.zhihu.com/p/542115773"target="_blank" rel="external nofollow noopener noreferrer">https://zhuanlan.zhihu.com/p/542115773<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
]]></description></item><item><title>C++ åŸºç¡€çŸ¥è¯†[äºŒ]</title><link>https://jianye0428.github.io/posts/basics_two/</link><pubDate>Tue, 11 Jul 2023 19:39:15 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/basics_two/</guid><description><![CDATA[<div class="details admonition quote">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>quote<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">c++ å…«è‚¡æ–‡ ç¬¬ä¸€éƒ¨åˆ†</div>
    </div>
  </div>
<h2 id="6-åŸºç¡€çŸ¥è¯†å…­">6 åŸºç¡€çŸ¥è¯†(å…­)</h2>
<h3 id="61-æ„é€ å‡½æ•°ä¸ºä»€ä¹ˆä¸èƒ½å®šä¹‰ä¸ºè™šå‡½æ•°-ææ„å‡½æ•°èˆ¬å†™æˆè™šå‡½æ•°çš„åŸå› -">6.1 æ„é€ å‡½æ•°ä¸ºä»€ä¹ˆä¸èƒ½å®šä¹‰ä¸ºè™šå‡½æ•°ï¼Ÿ â½½ææ„å‡½æ•°â¼€èˆ¬å†™æˆè™šå‡½æ•°çš„åŸå›  ï¼Ÿ</h3>
<p>æ„é€ å‡½æ•°ä¸èƒ½å£°æ˜ä¸ºè™šå‡½æ•°çš„åŸå› æ˜¯:</p>
<blockquote>
<p>1 æ„é€ ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå¿…é¡»çŸ¥é“å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œè€Œè™šå‡½æ•°è¡Œä¸ºæ˜¯åœ¨è¿è¡ŒæœŸé—´ç¡®å®šå®é™…ç±»å‹çš„ã€‚è€Œåœ¨æ„é€ ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç”±äºå¯¹è±¡è¿˜æœªæ„é€ æˆåŠŸã€‚ç¼–è¯‘å™¨æ— æ³•çŸ¥é“å¯¹è±¡ çš„å®é™…ç±»å‹ï¼Œæ˜¯è¯¥ç±»æœ¬èº«ï¼Œè¿˜æ˜¯è¯¥ç±»çš„ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼Œæˆ–æ˜¯æ›´æ·±å±‚æ¬¡çš„æ´¾ç”Ÿç±»ã€‚æ— æ³•ç¡®å®šã€‚</br>
2 è™šå‡½æ•°çš„æ‰§è¡Œä¾èµ–äºè™šå‡½æ•°è¡¨ã€‚è€Œè™šå‡½æ•°è¡¨åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œåˆå§‹åŒ–å·¥ä½œï¼Œå³åˆå§‹åŒ–vptrï¼Œè®©ä»–æŒ‡å‘æ­£ç¡®çš„è™šå‡½æ•°è¡¨ã€‚è€Œåœ¨æ„é€ å¯¹è±¡æœŸé—´ï¼Œè™šå‡½æ•°è¡¨è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå°†æ— æ³•è¿›è¡Œã€‚</br></p>
</blockquote>
<p>è™šå‡½æ•°çš„æ„æ€å°±æ˜¯å¼€å¯åŠ¨æ€ç»‘å®šï¼Œç¨‹åºä¼šæ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹æ¥é€‰æ‹©è¦è°ƒç”¨çš„æ–¹æ³•ã€‚ç„¶è€Œåœ¨æ„é€ å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡çš„åŠ¨æ€ç±»å‹è¿˜ä¸å®Œæ•´ï¼Œæ²¡æœ‰åŠæ³•ç¡®å®šå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹ï¼Œæ•…æ„é€ å‡½æ•°ä¸èƒ½åŠ¨æ€ç»‘å®šã€‚ï¼ˆåŠ¨æ€ç»‘å®šæ˜¯æ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹è€Œä¸æ˜¯å‡½æ•°åï¼Œåœ¨è°ƒç”¨æ„é€ å‡½æ•°ä¹‹å‰ï¼Œè¿™ä¸ªå¯¹è±¡æ ¹æœ¬å°±ä¸å­˜åœ¨ï¼Œå®ƒæ€ä¹ˆåŠ¨æ€ç»‘å®šï¼Ÿï¼‰
ç¼–è¯‘å™¨åœ¨è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°çš„æ—¶å€™å¹¶ä¸çŸ¥é“ä½ è¦æ„é€ çš„æ˜¯ä¸€ä¸ªåŸºç±»çš„å¯¹è±¡è¿˜æ˜¯ä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚</p>
<blockquote>
<p>ææ„å‡½æ•°è®¾ä¸ºè™šå‡½æ•°çš„ä½œç”¨:
è§£é‡Šï¼šåœ¨ç±»çš„ç»§æ‰¿ä¸­ï¼Œå¦‚æœæœ‰åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»ï¼Œé‚£ä¹ˆç”¨åŸºç±»æŒ‡é’ˆdeleteæ—¶ï¼Œå¦‚æœä¸å®šä¹‰æˆè™šå‡½æ•°ï¼Œæ´¾ç”Ÿç±»ä¸­æ´¾ç”Ÿçš„é‚£éƒ¨åˆ†æ— æ³•ææ„ã€‚ï¼ˆå¦‚æœåŸºç±»çš„ææ„å‡½æ•°ä¸æ˜¯è™šå‡½æ•°ï¼Œé‚£ä¹ˆåœ¨delete åŸºç±»æŒ‡é’ˆæ—¶ï¼Œåªè°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ï¼Œä¸ä¼šè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼Œæ•…æ´¾ç”Ÿç±»éƒ¨åˆ†ä¸ä¼šè¢«ææ„ã€‚ï¼‰</p>
</blockquote>
<h3 id="62-ccä¸­registerå…³é”®å­—å¯„å­˜å™¨ç¼“å­˜å†…å­˜">6.2 c/c++ä¸­registerå…³é”®å­—ï¼ˆå¯„å­˜å™¨ã€ç¼“å­˜ã€å†…å­˜ï¼‰</h3>
<p><a href="https://blog.csdn.net/u012484779/article/details/117514000"target="_blank" rel="external nofollow noopener noreferrer">c/c++ä¸­registerå…³é”®å­—ï¼ˆå¯„å­˜å™¨ã€ç¼“å­˜ã€å†…å­˜ï¼‰<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå˜é‡çš„å€¼æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼ŒCPU æ¯æ¬¡ä½¿ç”¨æ•°æ®éƒ½è¦ä»å†…å­˜ä¸­è¯»å–ã€‚å¦‚æœæœ‰ä¸€äº›å˜é‡ä½¿ç”¨éå¸¸é¢‘ç¹ï¼Œä»å†…å­˜ä¸­è¯»å–å°±ä¼šæ¶ˆè€—å¾ˆå¤šæ—¶é—´ï¼Œä¾‹å¦‚ for å¾ªç¯ä¸­çš„å¢é‡æ§åˆ¶ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†ä½¿ç”¨é¢‘ç¹çš„å˜é‡æ”¾åœ¨CPUçš„é€šç”¨å¯„å­˜å™¨ä¸­ï¼Œè¿™æ ·ä½¿ç”¨è¯¥å˜é‡æ—¶å°±ä¸å¿…è®¿é—®å†…å­˜ï¼Œç›´æ¥ä»å¯„å­˜å™¨ä¸­è¯»å–ï¼Œå¤§å¤§æé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚</p>
<p><strong>å¯„å­˜å™¨ã€ç¼“å­˜ã€å†…å­˜</strong></p>
<p>ä¸ºäº†åŠ æ·±å¯¹ register å˜é‡çš„ç†è§£ï¼Œè¿™é‡Œæœ‰å¿…è¦è®²ä¸€ä¸‹CPUå¯„å­˜å™¨ã€‚</p>
<p>æŒ‰ç…§ä¸CPUçš„è¿œè¿‘æ¥åˆ†ï¼Œç¦»CPUæœ€è¿‘çš„æ˜¯å¯„å­˜å™¨ï¼Œç„¶åæ˜¯ç¼“å­˜ï¼Œæœ€åæ˜¯å†…å­˜ã€‚</p>
<p>å¯„å­˜å™¨æ˜¯æœ€è´´è¿‘CPUçš„ï¼Œè€Œä¸”CPUåªåœ¨å¯„å­˜å™¨ä¸­è¿›è¡Œå­˜å–ã€‚<font color=green>å¯„å­˜çš„æ„æ€æ˜¯æš‚æ—¶å­˜æ”¾æ•°æ®ï¼Œä¸ç”¨æ¯æ¬¡éƒ½ä»å†…å­˜ä¸­è¯»å–ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸´æ—¶çš„å­˜æ”¾æ•°æ®çš„ç©ºé—´</font>ã€‚</p>
<p>è€Œå¯„å­˜å™¨çš„æ•°æ®åˆæ¥æºäºå†…å­˜ï¼Œäºæ˜¯ CPU &lt;&ndash; å¯„å­˜å™¨ &lt;&ndash; å†…å­˜ï¼Œè¿™å°±æ˜¯å®ƒä»¬ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ã€‚</p>
<p><font color=red>é‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜éœ€è¦ç¼“å­˜å‘¢ï¼Ÿ</font>å› ä¸ºå¦‚æœé¢‘ç¹åœ°æ“ä½œå†…å­˜ä¸­åŒä¸€åœ°å€ä¸Šçš„æ•°æ®ä¼šå½±å“é€Ÿåº¦ï¼Œäºæ˜¯å°±åœ¨å¯„å­˜å™¨å’Œå†…å­˜ä¹‹é—´è®¾ç½®ä¸€ä¸ªç¼“å­˜ï¼ŒæŠŠä½¿ç”¨é¢‘ç¹çš„æ•°æ®æš‚æ—¶ä¿å­˜åˆ°ç¼“å­˜ï¼Œå¦‚æœå¯„å­˜å™¨éœ€è¦è¯»å–å†…å­˜ä¸­åŒä¸€åœ°å€ä¸Šçš„æ•°æ®ï¼Œå°±ä¸ç”¨å¤§è€è¿œåœ°å†å»è®¿é—®å†…å­˜ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–å³å¯ã€‚</p>
<p>ç¼“å­˜çš„é€Ÿåº¦è¿œé«˜äºå†…å­˜ï¼Œä»·æ ¼ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<p>æ³¨æ„ï¼šç¼“å­˜çš„å®¹é‡æ˜¯æœ‰é™çš„ï¼Œå¯„å­˜å™¨åªèƒ½ä»ç¼“å­˜ä¸­è¯»å–åˆ°éƒ¨åˆ†æ•°æ®ï¼Œå¯¹äºä½¿ç”¨ä¸æ˜¯å¾ˆé¢‘ç¹çš„æ•°æ®ï¼Œä¼šç»•è¿‡ç¼“å­˜ï¼Œç›´æ¥åˆ°å†…å­˜ä¸­è¯»å–ã€‚æ‰€ä»¥ä¸æ˜¯æ¯æ¬¡éƒ½èƒ½ä»ç¼“å­˜ä¸­å¾—åˆ°æ•°æ®ï¼Œè¿™å°±æ˜¯ç¼“å­˜çš„å‘½ä¸­ç‡ï¼Œèƒ½å¤Ÿä»ç¼“å­˜ä¸­è¯»å–å°±å‘½ä¸­ï¼Œå¦åˆ™å°±æ²¡å‘½ä¸­ã€‚</p>
<p>å…³äºç¼“å­˜çš„å‘½ä¸­ç‡åˆæ˜¯ä¸€é—¨å­¦é—®ï¼Œå“ªäº›æ•°æ®ä¿ç•™åœ¨ç¼“å­˜ï¼Œå“ªäº›æ•°æ®ä¸ä¿ç•™ï¼Œéƒ½æœ‰å¤æ‚çš„ç®—æ³•ã€‚</p>
<p>æ³¨æ„ï¼šä¸Šé¢æ‰€è¯´çš„CPUæ˜¯æŒ‡CPUæ ¸å¿ƒï¼Œä»å¸‚åœºä¸Šè´­ä¹°çš„CPUå·²æ˜¯å°è£…å¥½çš„å¥—ä»¶ï¼Œé™„å¸¦äº†å¯„å­˜å™¨å’Œç¼“å­˜ï¼Œæ’åˆ°ä¸»æ¿ä¸Šå°±å¯ä»¥ç”¨ã€‚</p>
<p>ä»ç»æµå’Œé€Ÿåº¦çš„ç»¼åˆè€ƒè™‘ï¼Œç¼“å­˜åˆè¢«åˆ†ä¸ºä¸€çº§ç¼“å­˜ã€äºŒçº§ç¼“å­˜å’Œä¸‰çº§ç¼“å­˜ï¼Œå®ƒä»¬çš„å­˜å–é€Ÿåº¦å’Œä»·æ ¼ä¾æ¬¡é™ä½ï¼Œå®¹é‡ä¾æ¬¡å¢åŠ ã€‚è´­ä¹°åˆ°çš„CPUä¸€èˆ¬ä¼šæ ‡å‡ºä¸‰çº§ç¼“å­˜çš„å®¹é‡ã€‚</p>
<p><strong>register å˜é‡</strong></p>
<p>å¯„å­˜å™¨çš„æ•°é‡æ˜¯æœ‰é™çš„ï¼Œé€šå¸¸æ˜¯æŠŠä½¿ç”¨æœ€é¢‘ç¹çš„å˜é‡å®šä¹‰ä¸º register çš„ã€‚</p>
<p>å…³äºå¯„å­˜å™¨å˜é‡æœ‰ä»¥ä¸‹äº‹é¡¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>ä¸ºå¯„å­˜å™¨å˜é‡åˆ†é…å¯„å­˜å™¨æ˜¯åŠ¨æ€å®Œæˆçš„ï¼Œå› æ­¤ï¼Œåªæœ‰å±€éƒ¨å˜é‡å’Œå½¢å¼å‚æ•°æ‰èƒ½å®šä¹‰ä¸ºå¯„å­˜å™¨å˜é‡ã€‚</li>
<li>å±€éƒ¨é™æ€å˜é‡ä¸èƒ½å®šä¹‰ä¸ºå¯„å­˜å™¨å˜é‡ï¼Œå› ä¸ºä¸€ä¸ªå˜é‡åªèƒ½å£°æ˜ä¸ºä¸€ç§å­˜å‚¨ç±»åˆ«ã€‚</li>
<li>å¯„å­˜å™¨çš„é•¿åº¦ä¸€èˆ¬å’Œæœºå™¨çš„å­—é•¿ä¸€è‡´ï¼Œæ‰€ä»¥ï¼Œåªæœ‰è¾ƒçŸ­çš„ç±»å‹å¦‚intã€charã€shortç­‰æ‰é€‚åˆå®šä¹‰ä¸ºå¯„å­˜å™¨å˜é‡ï¼Œè¯¸å¦‚doubleç­‰è¾ƒå¤§çš„ç±»å‹ï¼Œä¸æ¨èå°†å…¶å®šä¹‰ä¸ºå¯„å­˜å™¨ç±»å‹ã€‚</li>
<li>CPUçš„å¯„å­˜å™¨æ•°ç›®æœ‰é™ï¼Œå› æ­¤ï¼Œå³ä½¿å®šä¹‰äº†å¯„å­˜å™¨å˜é‡ï¼Œç¼–è¯‘å™¨å¯èƒ½å¹¶ä¸çœŸæ­£ä¸ºå…¶åˆ†é…å¯„å­˜å™¨ï¼Œè€Œæ˜¯å°†å…¶å½“åšæ™®é€šçš„autoå˜é‡æ¥å¯¹å¾…ï¼Œä¸ºå…¶åˆ†é…æ ˆå†…å­˜ã€‚å½“ç„¶ï¼Œæœ‰äº›ä¼˜ç§€çš„ç¼–è¯‘å™¨ï¼Œèƒ½è‡ªåŠ¨è¯†åˆ«ä½¿ç”¨é¢‘ç¹çš„å˜é‡ï¼Œå¦‚å¾ªç¯æ§åˆ¶å˜é‡ç­‰ï¼Œåœ¨æœ‰å¯ç”¨çš„å¯„å­˜å™¨æ—¶ï¼Œå³ä½¿æ²¡æœ‰ä½¿ç”¨ register å…³é”®å­—ï¼Œä¹Ÿè‡ªåŠ¨ä¸ºå…¶åˆ†é…å¯„å­˜å™¨ï¼Œæ— é¡»ç”±ç¨‹åºå‘˜æ¥æŒ‡å®šã€‚</li>
</ul>
<p><strong>c++ä¸­register</strong></p>
<p>åœ¨æ—©æœŸcè¯­è¨€ç¼–è¯‘å™¨ä¸ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤ä½¿ç”¨registerå…³é”®å­—ä¿®é¥°å˜é‡æ˜¯å¾ˆå¥½çš„è¡¥å……ï¼Œå¤§å¤§æé«˜çš„é€Ÿåº¦ã€‚</p>
<p>registerå…³é”®å­—è¯·æ±‚è®©ç¼–è¯‘å™¨å°†å˜é‡aç›´æ¥æ”¾å…¥å¯„å­˜å™¨é‡Œé¢ï¼Œä»¥æé«˜è¯»å–é€Ÿåº¦ï¼Œåœ¨Cè¯­è¨€ä¸­registerå…³é”®å­—ä¿®é¥°çš„å˜é‡ä¸å¯ä»¥è¢«å–åœ°å€ï¼Œä½†æ˜¯c++ä¸­è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p>
<p>c++ä¸­ä¾ç„¶æ”¯æŒregisterå…³é”®å­—ï¼Œä½†æ˜¯c++ç¼–è¯‘å™¨ä¹Ÿæœ‰è‡ªå·±çš„ä¼˜åŒ–æ–¹å¼ï¼Œå³æŸäº›å˜é‡ä¸ç”¨registerå…³é”®å­—è¿›è¡Œä¿®é¥°ï¼Œç¼–è¯‘å™¨ä¹Ÿä¼šå°†å¤šæ¬¡è¿ç»­ä½¿ç”¨çš„å˜é‡ä¼˜åŒ–æ”¾å…¥å¯„å­˜å™¨ä¸­ï¼Œä¾‹å¦‚å…¥forå¾ªç¯çš„å¾ªç¯å˜é‡iã€‚</p>
<p>c++ä¸­ä¹Ÿå¯ä»¥å¯¹registerä¿®é¥°çš„å˜é‡å–åœ°å€ï¼Œä¸è¿‡c++ç¼–è¯‘å™¨å‘ç°ç¨‹åºä¸­éœ€è¦å–registerå…³é”®å­—ä¿®é¥°çš„å˜é‡çš„åœ°å€æ—¶ï¼Œregisterå…³é”®å­—çš„å£°æ˜å°†å˜å¾—æ— æ•ˆã€‚</p>
<h3 id="63-ccä¸­è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«">6.3 c/c++ä¸­è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«</h3>
<p><a href="https://blog.csdn.net/weixin_43956732/article/details/109736126"target="_blank" rel="external nofollow noopener noreferrer">c++å¤šçº¿ç¨‹ç¼–ç¨‹ &ndash; è¿›ç¨‹ä¸çº¿ç¨‹åŒºåˆ«<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>
<a href="https://zhuanlan.zhihu.com/p/616080301"target="_blank" rel="external nofollow noopener noreferrer">c++é¢è¯•-æ“ä½œç³»ç»Ÿç¯‡<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>
<a href="https://zhuanlan.zhihu.com/p/114453309"target="_blank" rel="external nofollow noopener noreferrer">é¢è¯•å¿…è€ƒ | è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<ul>
<li>
<p>ä½•ä¸ºè¿›ç¨‹(process)?</p>
<ul>
<li>
<p><strong>è¿›ç¨‹æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºè¢«æ“ä½œç³»ç»Ÿæ‹‰èµ·æ¥åŠ è½½åˆ°å†…å­˜ä¹‹åä»å¼€å§‹æ‰§è¡Œåˆ°æ‰§è¡Œç»“æŸçš„è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹</strong>ã€‚ç®€å•æ¥è¯´ï¼Œè¿›ç¨‹æ˜¯ç¨‹åºï¼ˆåº”ç”¨ç¨‹åºï¼Œå¯æ‰§è¡Œæ–‡ä»¶ï¼‰çš„ä¸€æ¬¡æ‰§è¡Œã€‚è¿›ç¨‹é€šå¸¸ç”±ç¨‹åºã€æ•°æ®å’Œè¿›ç¨‹æ§åˆ¶å—ï¼ˆPCBï¼‰ç»„æˆã€‚æ¯”å¦‚åŒå‡»æ‰“å¼€ä¸€ä¸ªæ¡Œé¢åº”ç”¨è½¯ä»¶å°±æ˜¯å¼€å¯äº†ä¸€ä¸ªè¿›ç¨‹ã€‚</p>
</li>
<li>
<p>ä¼ ç»Ÿçš„è¿›ç¨‹æœ‰ä¸¤ä¸ªåŸºæœ¬å±æ€§ï¼šå¯æ‹¥æœ‰èµ„æºçš„ç‹¬ç«‹å•ä½ï¼›å¯ç‹¬ç«‹è°ƒåº¦å’Œåˆ†é…çš„åŸºæœ¬å•ä½ã€‚å¯¹äºè¿™å¥è¯æˆ‘çš„ç†è§£æ˜¯ï¼šè¿›ç¨‹å¯ä»¥è·å–æ“ä½œç³»ç»Ÿåˆ†é…çš„èµ„æºï¼Œå¦‚å†…å­˜ç­‰ï¼›è¿›ç¨‹å¯ä»¥å‚ä¸æ“ä½œç³»ç»Ÿçš„è°ƒåº¦ï¼Œå‚ä¸CPUçš„ç«äº‰ï¼Œå¾—åˆ°åˆ†é…çš„æ—¶é—´ç‰‡ï¼Œè·å¾—å¤„ç†æœºï¼ˆCPUï¼‰è¿è¡Œã€‚</p>
</li>
<li>
<p>è¿›ç¨‹åœ¨åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢ä¸­ï¼Œç³»ç»Ÿå¿…é¡»ä¸ºä¹‹ä»˜å‡ºè¾ƒå¤§çš„æ—¶ç©ºå¼€é”€ï¼Œå› æ­¤åœ¨ç³»ç»Ÿä¸­å¼€å¯çš„è¿›ç¨‹æ•°ä¸å®œè¿‡å¤šã€‚æ¯”å¦‚ä½ åŒæ—¶æ‰“å¼€åå‡ ä¸ªåº”ç”¨è½¯ä»¶è¯•è¯•ï¼Œç”µè„‘è‚¯å®šä¼šå¡æ­»çš„ã€‚äºæ˜¯ç´§æ¥ç€å°±å¼•å…¥äº†çº¿ç¨‹çš„æ¦‚å¿µã€‚</p>
</li>
</ul>
</li>
<li>
<p>ä½•ä¸ºçº¿ç¨‹(thread)?</p>
<ul>
<li>
<p>çº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯è¢«ç³»ç»Ÿç‹¬ç«‹åˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚ä¹Ÿæœ‰è¯´ï¼Œçº¿ç¨‹æ˜¯CPUå¯æ‰§è¡Œè°ƒåº¦çš„æœ€å°å•ä½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿›ç¨‹æœ¬èº«å¹¶ä¸èƒ½è·å–CPUæ—¶é—´ï¼Œåªæœ‰å®ƒçš„çº¿ç¨‹æ‰å¯ä»¥ã€‚</p>
</li>
<li>
<p>å¼•å…¥çº¿ç¨‹ä¹‹åï¼Œå°†ä¼ ç»Ÿè¿›ç¨‹çš„ä¸¤ä¸ªåŸºæœ¬å±æ€§åˆ†å¼€äº†ï¼Œçº¿ç¨‹ä½œä¸ºè°ƒåº¦å’Œåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œè¿›ç¨‹ä½œä¸ºç‹¬ç«‹åˆ†é…èµ„æºçš„å•ä½ã€‚æˆ‘å¯¹è¿™å¥è¯çš„ç†è§£æ˜¯ï¼šçº¿ç¨‹å‚ä¸æ“ä½œç³»ç»Ÿçš„è°ƒåº¦ï¼Œå‚ä¸CPUçš„ç«äº‰ï¼Œå¾—åˆ°åˆ†é…çš„æ—¶é—´ç‰‡ï¼Œè·å¾—å¤„ç†æœºï¼ˆCPUï¼‰è¿è¡Œã€‚è€Œè¿›ç¨‹è´Ÿè´£è·å–æ“ä½œç³»ç»Ÿåˆ†é…çš„èµ„æºï¼Œå¦‚å†…å­˜ã€‚</p>
</li>
<li>
<p>çº¿ç¨‹åŸºæœ¬ä¸Šä¸æ‹¥æœ‰èµ„æºï¼Œåªæ‹¥æœ‰ä¸€ç‚¹è¿è¡Œä¸­å¿…ä¸å¯å°‘çš„èµ„æºï¼Œå®ƒå¯ä¸åŒå±ä¸€ä¸ªè¿›ç¨‹çš„å…¶ä»–çº¿ç¨‹å…±äº«è¿›ç¨‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æºã€‚</p>
</li>
<li>
<p>çº¿ç¨‹å…·æœ‰è®¸å¤šä¼ ç»Ÿè¿›ç¨‹æ‰€å…·æœ‰çš„ç‰¹æ€§ï¼Œæ•…ç§°ä¸ºâ€œè½»é‡å‹è¿›ç¨‹â€ã€‚åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹å¯ä»¥å¹¶å‘æ‰§è¡Œã€‚</br></p>
</li>
</ul>
</li>
<li>
<p>è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ</p>
<ul>
<li>
<p>çº¿ç¨‹åˆ†ä¸º<font color=red>ç”¨æˆ·çº§çº¿ç¨‹</font>å’Œ<font color=red>å†…æ ¸æ”¯æŒçº¿ç¨‹</font>ä¸¤ç±»ï¼Œ<strong>ç”¨æˆ·çº§çº¿ç¨‹</strong>ä¸ä¾èµ–äºå†…æ ¸ï¼Œè¯¥ç±»çº¿ç¨‹çš„åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢éƒ½ä¸åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨æ¥å®ç°; <strong>å†…æ ¸æ”¯æŒçº¿ç¨‹</strong>ä¾èµ–äºå†…æ ¸ï¼Œå³æ— è®ºæ˜¯åœ¨ç”¨æˆ·è¿›ç¨‹ä¸­çš„çº¿ç¨‹ï¼Œè¿˜æ˜¯åœ¨ç³»ç»Ÿä¸­çš„çº¿ç¨‹ï¼Œå®ƒä»¬çš„åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢éƒ½åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨æ¥å®ç°ã€‚</p>
</li>
<li>
<p>ä½†æ˜¯ï¼Œä¸çº¿ç¨‹ä¸åŒçš„æ˜¯ï¼Œæ— è®ºæ˜¯ç³»ç»Ÿè¿›ç¨‹è¿˜æ˜¯ç”¨æˆ·è¿›ç¨‹ï¼Œåœ¨è¿›è¡Œåˆ‡æ¢æ—¶ï¼Œéƒ½è¦ä¾èµ–äºå†…æ ¸ä¸­çš„è¿›ç¨‹(process)è°ƒåº¦ã€‚å› æ­¤ï¼Œæ— è®ºæ˜¯ä»€ä¹ˆè¿›ç¨‹éƒ½æ˜¯ä¸å†…æ ¸æœ‰å…³çš„ï¼Œæ˜¯åœ¨å†…æ ¸æ”¯æŒä¸‹è¿›ç¨‹åˆ‡æ¢çš„ã€‚å°½ç®¡çº¿ç¨‹å’Œè¿›ç¨‹è¡¨é¢ä¸Šçœ‹èµ·æ¥ç›¸ä¼¼ï¼Œä½†æ˜¯ä»–ä»¬åœ¨æœ¬è´¨ä¸Šæ˜¯ä¸åŒçš„ã€‚</p>
</li>
<li>
<p>æ ¹æ®æ“ä½œç³»ç»Ÿä¸­çš„çŸ¥è¯†ï¼Œè¿›ç¨‹è‡³å°‘å¿…é¡»æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œé€šå¸¸å°†æ­¤çº¿ç¨‹ç§°ä¸ºä¸»çº¿ç¨‹ã€‚</p>
</li>
<li>
<p><font color=red><u>è¿›ç¨‹è¦ç‹¬ç«‹åœ°å ç”¨ç³»ç»Ÿèµ„æºï¼ˆå¦‚å†…å­˜ï¼‰ï¼Œè€ŒåŒä¸€è¿›ç¨‹çš„çº¿ç¨‹ä¹‹é—´æ˜¯å…±äº«èµ„æºçš„ã€‚è¿›ç¨‹æœ¬èº«å¹¶ä¸èƒ½è·å–CPUæ—¶é—´ï¼Œåªæœ‰å®ƒçš„çº¿ç¨‹æ‰å¯ä»¥ã€‚</u></font></p>
</li>
</ul>
</li>
<li>
<p>å…¶ä»–</p>
<ul>
<li>è¿›ç¨‹åœ¨åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿçš„æ—¶ç©ºå¼€é”€éå¸¸å¤§ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡åˆ›å»ºçº¿ç¨‹æ¥å®Œæˆä»»åŠ¡ï¼Œä»¥å‡å°‘ç¨‹åºå¹¶å‘æ‰§è¡Œæ—¶ä»˜å‡ºçš„æ—¶ç©ºå¼€é”€ã€‚ä¾‹å¦‚å¯ä»¥åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­è®¾ç½®å¤šä¸ªçº¿ç¨‹ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å—é˜»æ—¶ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹å¯ä»¥ç»§ç»­è¿è¡Œï¼Œå½“ç¬¬äºŒä¸ªçº¿ç¨‹å—é˜»æ—¶ï¼Œç¬¬ä¸‰ä¸ªçº¿ç¨‹å¯ä»¥ç»§ç»­è¿è¡Œ&hellip;&hellip;ã€‚è¿™æ ·ï¼Œå¯¹äºæ‹¥æœ‰èµ„æºçš„åŸºæœ¬å•ä½ï¼ˆè¿›ç¨‹ï¼‰ï¼Œä¸ç”¨é¢‘ç¹çš„åˆ‡æ¢ï¼Œè¿›ä¸€æ­¥æé«˜äº†ç³»ç»Ÿä¸­å„ç§ç¨‹åºçš„å¹¶å‘ç¨‹åº¦ã€‚</li>
</ul>
</li>
</ul>
<p>ref: </br>
[1].https://blog.csdn.net/qq_41803340/category_10405604.html</p>
<p>[å¾…æ•´ç†å†…å®¹]</p>
<h2 id="ä¸€å¸¸è€ƒcåŸºç¡€æ¦‚å¿µ">ä¸€.å¸¸è€ƒC++åŸºç¡€æ¦‚å¿µ</h2>
<h3 id="1cä¸‰å¤§ç‰¹æ€§å°è£…ç»§æ‰¿å¤šæ€">1.C++ä¸‰å¤§ç‰¹æ€§ï¼ˆå°è£…ã€ç»§æ‰¿ã€å¤šæ€ï¼‰</h3>
<p><strong>å°è£…ï¼š</strong></p>
<blockquote>
<p>éšè—ç±»çš„å±æ€§å’Œå®ç°ç»†èŠ‚ï¼Œä»…ä»…å¯¹å¤–æä¾›æ¥å£ï¼Œ
å°è£…æ€§å®é™…ä¸Šæ˜¯ç”±ç¼–è¯‘å™¨å»è¯†åˆ«å…³é”®å­—publicã€privateå’Œprotectedæ¥å®ç°çš„ï¼Œ
ä½“ç°åœ¨ç±»çš„æˆå‘˜å¯ä»¥æœ‰<font color=red>å…¬æœ‰æˆå‘˜(public)</font>ï¼Œ<font color=red>ç§æœ‰æˆå‘˜(private)</font>ï¼Œ<font color=red>ä¿æŠ¤æˆå‘˜(protected)</font>ã€‚
ç§æœ‰æˆå‘˜æ˜¯åœ¨å°è£…ä½“å†…è¢«éšè—çš„éƒ¨åˆ†ï¼Œåªæœ‰ç±»ä½“å†…å£°æ˜çš„å‡½æ•°(ç±»çš„æˆå‘˜å‡½æ•°)æ‰å¯ä»¥è®¿é—®ç§æœ‰æˆå‘˜ï¼Œ
è€Œåœ¨ç±»ä½“å¤–çš„å‡½æ•°æ˜¯ä¸èƒ½è®¿é—®çš„ï¼Œ<u>å…¬æœ‰æˆå‘˜(public)æ˜¯å°è£…ä½“ä¸å¤–ç•Œçš„ä¸€ä¸ªæ¥å£</u>ï¼Œ
ç±»ä½“å¤–çš„å‡½æ•°å¯ä»¥è®¿é—®å…¬æœ‰æˆå‘˜ï¼Œä¿æŠ¤æˆå‘˜æ˜¯åªæœ‰è¯¥ç±»çš„æˆå‘˜å‡½æ•°å’Œ<strong>è¯¥ç±»çš„æ´¾ç”Ÿç±»</strong>æ‰å¯ä»¥è®¿é—®çš„ã€‚</p>
</blockquote>
<blockquote>
<p>ä¼˜ç‚¹ï¼šéš”ç¦»å˜åŒ–ï¼›ä¾¿äºä½¿ç”¨ï¼›æé«˜é‡ç”¨æ€§ï¼›æé«˜å®‰å…¨æ€§
ç¼ºç‚¹ï¼šå¦‚æœå°è£…å¤ªå¤šï¼Œå½±å“æ•ˆç‡ï¼›ä½¿ç”¨è€…ä¸èƒ½çŸ¥é“ä»£ç å…·ä½“å®ç°ã€‚</p>
</blockquote>
<p><strong>ç»§æ‰¿ï¼š</strong></p>
<blockquote>
<p>è¢«ç»§æ‰¿çš„æ˜¯çˆ¶ç±»ï¼ˆåŸºç±»ï¼‰ï¼Œç»§æ‰¿å‡ºæ¥çš„æ˜¯å­ç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰ï¼Œå­ç±»æ‹¥æœ‰çˆ¶ç±»çš„æ‰€æœ‰çš„ç‰¹æ€§ã€‚
ç»§æ‰¿æ–¹å¼æœ‰<font color=red>å…¬æœ‰ç»§æ‰¿</font>ã€<font color=red>ç§æœ‰ç»§æ‰¿</font>ï¼Œ<font color=red>ä¿æŠ¤ç»§æ‰¿</font>ã€‚é»˜è®¤æ˜¯<strong>ç§æœ‰ç»§æ‰¿</strong></p>
</blockquote>
<blockquote>
<p>*å…¬æœ‰ç»§æ‰¿ä¸­çˆ¶ç±»çš„å…¬æœ‰å’Œä¿æŠ¤æˆå‘˜åœ¨å­ç±»ä¸­ä¸å˜ï¼Œç§æœ‰çš„åœ¨å­ç±»ä¸­ä¸å¯è®¿é—®ã€‚
*ç§æœ‰ç»§æ‰¿ä¸­çˆ¶ç±»çš„å…¬æœ‰å’Œä¿æŠ¤æˆå‘˜åœ¨å­ç±»ä¸­å˜ä¸ºç§æœ‰ï¼Œä½†ç§æœ‰çš„åœ¨å­ç±»ä¸­ä¸å¯è®¿é—®ã€‚
*ä¿æŠ¤ç»§æ‰¿ä¸­çˆ¶ç±»çš„å…¬æœ‰å’Œä¿æŠ¤æˆå‘˜åœ¨å­ç±»ä¸­å˜ä¸ºä¿æŠ¤ï¼Œä½†ç§æœ‰çš„åœ¨å­ç±»ä¸­ä¸å¯è®¿é—®ã€‚
c++è¯­è¨€å…è®¸å•ç»§æ‰¿å’Œå¤šç»§æ‰¿</p>
</blockquote>
<blockquote>
<p>ä¼˜ç‚¹ï¼šç»§æ‰¿å‡å°‘äº†é‡å¤çš„ä»£ç ã€ç»§æ‰¿æ˜¯å¤šæ€çš„å‰æã€ç»§æ‰¿å¢åŠ äº†ç±»çš„è€¦åˆæ€§ï¼›
ç¼ºç‚¹ï¼šç»§æ‰¿åœ¨ç¼–è¯‘æ—¶åˆ»å°±å®šä¹‰äº†ï¼Œæ— æ³•åœ¨è¿è¡Œæ—¶åˆ»æ”¹å˜çˆ¶ç±»ç»§æ‰¿çš„å®ç°ï¼›</p>
</blockquote>
<blockquote>
<p>çˆ¶ç±»é€šå¸¸è‡³å°‘å®šä¹‰äº†å­ç±»çš„éƒ¨åˆ†è¡Œä¸ºï¼Œçˆ¶ç±»çš„æ”¹å˜éƒ½å¯èƒ½å½±å“å­ç±»çš„è¡Œä¸ºï¼›
å¦‚æœç»§æ‰¿ä¸‹æ¥çš„å­ç±»ä¸é€‚åˆè§£å†³æ–°é—®é¢˜ï¼Œçˆ¶ç±»å¿…é¡»é‡å†™æˆ–æ›¿æ¢ï¼Œé‚£ä¹ˆè¿™ç§ä¾èµ–å…³ç³»å°±é™åˆ¶äº†çµæ´»æ€§ï¼Œ
æœ€ç»ˆé™åˆ¶äº†å¤ç”¨æ€§ã€‚</p>
</blockquote>
<blockquote>
<p>è™šç»§æ‰¿ï¼šä¸ºäº†è§£å†³å¤šé‡ç»§æ‰¿ä¸­çš„äºŒä¹‰æ€§é—®é¢˜ï¼Œå®ƒç»´æŠ¤äº†ä¸€å¼ è™šåŸºç±»è¡¨ã€‚ (è±å½¢ç»§æ‰¿é—®é¢˜)</p>
</blockquote>
<p><strong>å¤šæ€:</strong></p>
<p>ref: <a href="https://blog.csdn.net/weixin_42678507/article/details/97111466"target="_blank" rel="external nofollow noopener noreferrer">å¤šæ€çš„å››ç§è¡¨ç°å½¢å¼<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<ul>
<li>è¿è¡Œæ—¶å¤šæ€(è™šå‡½æ•°)</li>
<li>ç¼–è¯‘æ—¶å¤šæ€(æ¨¡æ¿)</li>
<li>é‡è½½</li>
<li>ç±»å‹è½¬æ¢</li>
</ul>
<blockquote>
<p>è¿è¡Œæ—¶å¤šæ€(Subtype Polymorphism/Runtime Polymorphism)</p>
</blockquote>
<p>è¿è¡Œæ—¶å¤šæ€å°±æ˜¯æ´¾ç”Ÿç±»é‡å†™åŸºç±»çš„è™šå‡½æ•°ï¼Œåœ¨è°ƒç”¨å‡½æ•°é‡Œï¼Œå‚æ•°ä¸ºåŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œä¼šæ„æˆå¤šæ€ã€‚æˆ‘ä¹‹å‰å†™è¿‡ä¸€ç¯‡å¤šæ€çš„åŸç†ï¼Œå°±æ˜¯åœ¨è®²å¤šæ€(è¿è¡Œæ—¶å¤šæ€)åœ¨åº•å±‚æ˜¯æ€ä¹ˆå®ç°çš„
<a href="https://blog.csdn.net/weixin_42678507/article/details/89467387"target="_blank" rel="external nofollow noopener noreferrer">å¤šæ€çš„åº•å±‚å®ç°<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>ä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚ä¹°ç¥¨è¿™ä¸ªè¡Œä¸ºï¼Œæˆäººå»ä¹°å°±æ˜¯å…¨ä»·ï¼Œå­¦ç”Ÿä¹°å°±æ˜¯åŠä»·ç¥¨ã€‚ä½†æ˜¯ä¸ç®¡æˆäººè¿˜æ˜¯å­¦ç”Ÿéƒ½æ˜¯äººè¿™ä¸ªä½“ç³»ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ¹æ®è°æ¥ä¹°ç¥¨æ‰èƒ½å†³å®šä»·æ ¼ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å¤šæ€ã€‚</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ticket</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">price</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">adult</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ticket</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">price</span><span class="p">()</span> <span class="k">override</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;æˆäººå…¨ä»·ï¼&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">student</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ticket</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">price</span><span class="p">()</span> <span class="k">override</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;å­¦ç”ŸåŠä»·ï¼&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">BuyTicket</span><span class="p">(</span><span class="n">ticket</span><span class="o">&amp;</span> <span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">t</span><span class="p">.</span><span class="n">price</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">adult</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">student</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">BuyTicket</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">BuyTicket</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ç¼–è¯‘æ—¶å¤šæ€(Parametric Polymorphism/Compile-Time Polymorphism)</p>
</blockquote>
<p>ç¼–è¯‘æ—¶å¤šæ€å°±æ˜¯æ¨¡æ¿ã€‚åœ¨ç¨‹åºç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨æ ¹æ®å‚æ•°çš„ç±»å‹ï¼Œå°±å°†ç”ŸæˆæŸç§ç±»å‹çš„å‡½æ•°æˆ–ç±»ã€‚æˆ‘ä¹‹å‰å…³äºæ¨¡æ¿çš„(æ€»ç»“)[https://blog.csdn.net/weixin_42678507/article/details/88658291]</p>
<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼šAdd() å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å‡½æ•°ï¼Œä½†æ˜¯å¦‚æœä½ å†™ä¸€ä¸ªæ•´å‹çš„ Add å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘æƒ³åŠ  double å‹çš„å‘¢ï¼Ÿä½ å†å†™ä¸€ä¸ª double å‹çš„ Add å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘æƒ³åŠ  char å‹çš„å‘¢ï¼Ÿ</p>
<p>è¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº†æ¨¡æ¿ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªé€»è¾‘ï¼Œå…·ä½“ç±»å‹ç­‰ç¼–è¯‘æ—¶å†ç”Ÿæˆè¯¥ç±»å‹çš„å‡½æ•°æˆ–ç±»ã€‚</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">T</span> <span class="n">Add</span><span class="p">(</span><span class="n">T</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">T</span> <span class="n">rhs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">lhs</span> <span class="o">+</span> <span class="n">rhs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">Add</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">Add</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>é‡è½½(Ad-hoc Polymorphism/Overloading)</p>
</blockquote>
<p>å‡½æ•°åç›¸åŒï¼Œå‚æ•°ä¸åŒå°±æ„æˆäº†é‡è½½ã€‚é‡è½½ä¸»è¦ç”¨äºå‡½æ•°ï¼Œå½“æŸä¸ªå‡½æ•°çš„åŠŸèƒ½æ— æ³•å¤„ç†æŸäº›å‚æ•°çš„æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡è½½ä¸€ä¸ªå‡½æ•°æ¥å•ç‹¬å¤„ç†ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚è¯´ä¸Šé¢çš„ Add å‡½æ•°ï¼Œå½“å‰å†…ç½®ç±»å‹éƒ½å¯ä»¥å¤„ç†ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä¼ ä¸¤ä¸ªå­—ç¬¦ä¸²æ€ä¹ˆåŠï¼Ÿå°±ä¸å¯ä»¥åƒåˆšæ‰é‚£ä¹ˆåŠ äº†ã€‚å¾—é‡è½½ä¸€ä¸ªå‡½æ•°å•ç‹¬å¤„ç†ã€‚</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">Add</span><span class="p">(</span><span class="kt">int</span> <span class="n">lhs</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rhs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">lhs</span> <span class="o">+</span> <span class="n">rhs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">Add</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">ans</span><span class="p">(</span><span class="n">lhs</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">ans</span> <span class="o">+=</span> <span class="n">rhs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">Add</span><span class="p">(</span><span class="s">&#34;abc&#34;</span><span class="p">,</span> <span class="s">&#34;def&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ç±»å‹è½¬æ¢(Coercion Polymorphism/Casting)</p>
</blockquote>
<p>ç±»å‹è½¬æ¢ä¸»è¦åˆ†ä¸ºå››ç§ï¼š</p>
<ul>
<li>static_cast: ç›¸å½“äºéšå¼ç±»å‹è½¬æ¢ã€‚</li>
<li>const_cast: è¿™ä¸ªå¯ä»¥å»é™¤ä¸€ä¸ª const å˜é‡çš„ const æ€§è´¨ï¼Œä½¿å¯ä»¥æ”¹å˜å®ƒçš„å€¼ã€‚</li>
<li>reinterpret_cast: ç›¸å½“äºå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</li>
<li>dynamic_cast: è¿™ä¸ªå¯ä»¥ä½¿å­ç±»æŒ‡é’ˆæˆ–å¼•ç”¨èµ‹å€¼ç»™çˆ¶ç±»æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚</li>
</ul>
<p>ç±»å‹è½¬æ¢å¾ˆç®€å•ï¼Œè¿™é‡Œå°±ä¸å¤šèµ˜è¿°äº†ã€‚</p>
<h3 id="2æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ«">2.æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ«</h3>
<p>æ•°ç»„å’Œé“¾è¡¨æ˜¯ä¸¤ç§ä¸åŒçš„æ•°æ®å­˜å‚¨æ–¹å¼</p>
<p><strong><font color=purple>æ•°ç»„çš„å®šä¹‰</font></strong></p>
<blockquote>
<p>æ•°ç»„æ˜¯ä¸€ç»„å…·æœ‰ç›¸åŒæ•°æ®ç±»å‹çš„å˜é‡çš„é›†åˆï¼Œè¿™äº›å˜é‡ç§°ä¹‹ä¸ºé›†åˆçš„å…ƒç´ ã€‚
æ¯ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼Œç§°ä¹‹ä¸ºä¸‹æ ‡ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡æ¥åŒºåˆ«å¹¶è®¿é—®æ•°ç»„å…ƒç´ ï¼Œæ•°ç»„å…ƒç´ çš„ä¸ªæ•°å«åšæ•°æ®çš„é•¿åº¦ã€‚</p>
</blockquote>
<p><strong><font color=purple>é“¾è¡¨çš„å®šä¹‰</font></strong></p>
<blockquote>
<p>é“¾è¡¨æ˜¯ä¸€ç§<u>ç‰©ç†å­˜å‚¨å•å…ƒä¸Šéè¿ç»­ã€éé¡ºåºçš„</u>å­˜å‚¨ç»“æ„,æ•°æ®å…ƒç´ çš„é€»è¾‘é¡ºåºæ˜¯é€šè¿‡é“¾è¡¨ä¸­çš„æŒ‡é’ˆé“¾æ¥æ¬¡åºå®ç°çš„ã€‚
é“¾è¡¨çš„ç‰¹æ€§æ˜¯åœ¨ä¸­é—´ä»»æ„ä½ç½®æ’å…¥å’Œåˆ é™¤å…ƒç´ éƒ½éå¸¸å¿«ï¼Œä¸éœ€è¦ç§»åŠ¨å…¶å®ƒå…ƒç´ ã€‚
å¯¹äºå•å‘é“¾è¡¨è€Œè¨€ï¼Œé“¾è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½è¦ä¿å­˜ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚
å¯¹äºåŒå‘é“¾è¡¨è€Œè¨€ï¼Œé“¾è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ—¢è¦ä¿å­˜æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼Œåˆè¦ä¿å­˜æŒ‡å‘ä¸Šä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚
å¯¹äºåŒå‘å¾ªç¯é“¾è¡¨è€Œè¨€ï¼Œé“¾è¡¨ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ä¿å­˜ä¸€ä¸ªæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚</p>
</blockquote>
<p><strong><font color=purple>æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ«ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢</font></strong></p>
<table>
<thead>
<tr>
<th>æ¯”è¾ƒ</th>
<th>æ•°ç»„</th>
<th>é“¾è¡¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>é€»è¾‘ç»“æ„</td>
<td>(1) æ•°ç»„åœ¨å†…å­˜ä¸­è¿ç»­ï¼›   (2)ä½¿ç”¨æ•°ç»„ä¹‹å‰ï¼Œå¿…é¡»äº‹å…ˆå›ºå®šæ•°ç»„é•¿åº¦ï¼Œä¸æ”¯æŒåŠ¨æ€æ”¹å˜æ•°ç»„å¤§å°ï¼›  (3) æ•°ç»„å…ƒç´ å¢åŠ æ—¶ï¼Œæœ‰å¯èƒ½ä¼šæ•°ç»„è¶Šç•Œï¼›  (4) æ•°ç»„å…ƒç´ å‡å°‘æ—¶ï¼Œä¼šé€ æˆå†…å­˜æµªè´¹ï¼›  ï¼ˆ5ï¼‰æ•°ç»„å¢åˆ æ—¶éœ€è¦ç§»åŠ¨å…¶å®ƒå…ƒç´ </td>
<td>(1) é“¾è¡¨é‡‡ç”¨åŠ¨æ€å†…å­˜åˆ†é…çš„æ–¹å¼ï¼Œåœ¨å†…å­˜ä¸­ä¸è¿ç»­   (2)æ”¯æŒåŠ¨æ€å¢åŠ æˆ–è€…åˆ é™¤å…ƒç´    (3) éœ€è¦æ—¶å¯ä»¥ä½¿ç”¨mallocæˆ–è€…newæ¥ç”³è¯·å†…å­˜ï¼Œä¸ç”¨æ—¶ä½¿ç”¨freeæˆ–è€…deleteæ¥é‡Šæ”¾å†…å­˜</td>
</tr>
<tr>
<td>å†…å­˜ç»“æ„</td>
<td>æ•°ç»„ä»æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œä½†æ˜¯è‡ªç”±åº¦å°</td>
<td>é“¾è¡¨ä»å †ä¸Šåˆ†é…å†…å­˜ï¼Œè‡ªç”±åº¦å¤§ï¼Œä½†æ˜¯è¦æ³¨æ„å†…å­˜æ³„æ¼</td>
</tr>
<tr>
<td>è®¿é—®æ•ˆç‡</td>
<td>æ•°ç»„åœ¨å†…å­˜ä¸­é¡ºåºå­˜å‚¨ï¼Œå¯é€šè¿‡ä¸‹æ ‡è®¿é—®ï¼Œè®¿é—®æ•ˆç‡é«˜</td>
<td>é“¾è¡¨è®¿é—®æ•ˆç‡ä½ï¼Œå¦‚æœæƒ³è¦è®¿é—®æŸä¸ªå…ƒç´ ï¼Œéœ€è¦ä»å¤´éå†</td>
</tr>
<tr>
<td>è¶Šç•Œé—®é¢˜</td>
<td>æ•°ç»„çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥å­˜åœ¨è®¿é—®è¶Šç•Œçš„é£é™©</td>
<td>è¶Šç•Œçš„é£é™©	åªè¦å¯ä»¥ç”³è¯·å¾—åˆ°é“¾è¡¨ç©ºé—´ï¼Œé“¾è¡¨å°±æ— è¶Šç•Œé£é™©</td>
</tr>
</tbody>
</table>
<p><strong><font color=purple>æ•°ç»„å’Œé“¾è¡¨çš„ä½¿ç”¨åœºæ™¯</font></strong></p>
<table>
<thead>
<tr>
<th>æ¯”è¾ƒ</th>
<th>æ•°ç»„ä½¿ç”¨åœºæ™¯</th>
<th>é“¾è¡¨ä½¿ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç©ºé—´</td>
<td>æ•°ç»„çš„å­˜å‚¨ç©ºé—´æ˜¯æ ˆä¸Šåˆ†é…çš„ï¼Œå­˜å‚¨å¯†åº¦å¤§ï¼Œå½“è¦æ±‚å­˜å‚¨çš„å¤§å°å˜åŒ–ä¸å¤§æ—¶ï¼Œä¸”å¯ä»¥äº‹å…ˆç¡®å®šå¤§å°ï¼Œå®œé‡‡ç”¨æ•°ç»„å­˜å‚¨æ•°æ®</td>
<td>é“¾è¡¨çš„å­˜å‚¨ç©ºé—´æ˜¯å †ä¸ŠåŠ¨æ€ç”³è¯·çš„ï¼Œå½“è¦æ±‚å­˜å‚¨çš„é•¿åº¦å˜åŒ–è¾ƒå¤§æ—¶ï¼Œä¸”äº‹å…ˆæ— æ³•ä¼°é‡æ•°æ®è§„æ¨¡ï¼Œå®œé‡‡ç”¨é“¾è¡¨å­˜å‚¨</td>
</tr>
<tr>
<td>æ—¶é—´</td>
<td>æ•°ç»„è®¿é—®æ•ˆç‡é«˜ã€‚å½“çº¿æ€§è¡¨çš„æ“ä½œä¸»è¦æ˜¯è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¾ˆå°‘æ’å…¥å’Œåˆ é™¤æ—¶ï¼Œå®œé‡‡ç”¨æ•°ç»„ç»“æ„</td>
<td>é“¾è¡¨æ’å…¥ã€åˆ é™¤æ•ˆç‡é«˜ï¼Œå½“çº¿æ€§è¡¨è¦æ±‚é¢‘ç¹æ’å…¥å’Œåˆ é™¤æ—¶ï¼Œå®œé‡‡ç”¨é“¾è¡¨ç»“æ„</td>
</tr>
</tbody>
</table>
<h3 id="3-æ™ºèƒ½æŒ‡é’ˆ">3. æ™ºèƒ½æŒ‡é’ˆ</h3>
<p>æˆ‘ä»¬çŸ¥é“é™¤äº†é™æ€å†…å­˜å’Œæ ˆå†…å­˜å¤–ï¼Œæ¯ä¸ªç¨‹åºè¿˜æœ‰ä¸€ä¸ª<strong>å†…å­˜æ± </strong>ï¼Œè¿™éƒ¨åˆ†å†…å­˜è¢«ç§°ä¸ºè‡ªç”±ç©ºé—´æˆ–è€…å †ã€‚ç¨‹åºç”¨å †æ¥å­˜å‚¨åŠ¨æ€åˆ†é…çš„å¯¹è±¡å³é‚£äº›åœ¨ç¨‹åºè¿è¡Œæ—¶åˆ†é…çš„å¯¹è±¡ï¼Œå½“åŠ¨æ€å¯¹è±¡ä¸å†ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬çš„ä»£ç å¿…é¡»æ˜¾å¼çš„é”€æ¯å®ƒä»¬ã€‚</p>
<p>åœ¨C++ä¸­ï¼ŒåŠ¨æ€å†…å­˜çš„ç®¡ç†æ˜¯ç”¨ä¸€å¯¹è¿ç®—ç¬¦å®Œæˆçš„ï¼š<strong>new</strong>å’Œ<strong>delete</strong>ï¼Œnew:åœ¨åŠ¨æ€å†…å­˜ä¸­ä¸ºå¯¹è±¡åˆ†é…ä¸€å—ç©ºé—´å¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆï¼Œdeleteï¼šæŒ‡å‘ä¸€ä¸ªåŠ¨æ€ç‹¬äº«çš„æŒ‡é’ˆï¼Œé”€æ¯å¯¹è±¡ï¼Œå¹¶é‡Šæ”¾ä¸ä¹‹å…³è”çš„å†…å­˜ã€‚</p>
<p>åŠ¨æ€å†…å­˜ç®¡ç†ç»å¸¸ä¼šå‡ºç°ä¸¤ç§é—®é¢˜ï¼šä¸€ç§æ˜¯å¿˜è®°é‡Šæ”¾å†…å­˜ï¼Œä¼šé€ æˆå†…å­˜æ³„æ¼ï¼›ä¸€ç§æ˜¯å°šæœ‰æŒ‡é’ˆå¼•ç”¨å†…å­˜çš„æƒ…å†µä¸‹å°±é‡Šæ”¾äº†å®ƒï¼Œå°±ä¼šäº§ç”Ÿå¼•ç”¨éæ³•å†…å­˜çš„æŒ‡é’ˆã€‚</p>
<p>ä¸ºäº†æ›´åŠ å®¹æ˜“ï¼ˆæ›´åŠ å®‰å…¨ï¼‰çš„ä½¿ç”¨åŠ¨æ€å†…å­˜ï¼Œå¼•å…¥äº†æ™ºèƒ½æŒ‡é’ˆçš„æ¦‚å¿µã€‚æ™ºèƒ½æŒ‡é’ˆçš„è¡Œä¸ºç±»ä¼¼å¸¸è§„æŒ‡é’ˆï¼Œé‡è¦çš„åŒºåˆ«æ˜¯å®ƒè´Ÿè´£è‡ªåŠ¨é‡Šæ”¾æ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚æ ‡å‡†åº“æä¾›çš„ä¸¤ç§æ™ºèƒ½æŒ‡é’ˆçš„åŒºåˆ«åœ¨äºç®¡ç†åº•å±‚æŒ‡é’ˆçš„æ–¹æ³•ä¸åŒï¼Œ<strong>shared_ptrå…è®¸å¤šä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œunique_ptråˆ™â€œç‹¬å â€æ‰€æŒ‡å‘çš„å¯¹è±¡</strong>ã€‚æ ‡å‡†åº“è¿˜å®šä¹‰äº†ä¸€ç§åä¸º<strong>weak_ptrçš„ä¼´éšç±»</strong>ï¼Œå®ƒæ˜¯ä¸€ç§å¼±å¼•ç”¨ï¼ŒæŒ‡å‘shared_ptræ‰€ç®¡ç†çš„å¯¹è±¡ï¼Œè¿™ä¸‰ç§æ™ºèƒ½æŒ‡é’ˆéƒ½å®šä¹‰åœ¨memoryå¤´æ–‡ä»¶ä¸­ã€‚</p>
<ul>
<li>
<p>1 æ™ºèƒ½æŒ‡é’ˆçš„ä½œç”¨</p>
<ul>
<li>æ™ºèƒ½æŒ‡é’ˆæ˜¯ä¸€ä¸ªç±»ï¼Œç”¨æ¥å­˜å‚¨æŒ‡å‘åŠ¨æ€åˆ†é…å¯¹è±¡çš„æŒ‡é’ˆï¼Œè´Ÿè´£è‡ªåŠ¨é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å¯¹è±¡ï¼Œé˜²æ­¢å †å†…å­˜æ³„æ¼ã€‚åŠ¨æ€åˆ†é…çš„èµ„æºï¼Œäº¤ç»™ä¸€ä¸ªç±»å¯¹è±¡å»ç®¡ç†ï¼Œå½“ç±»å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°é‡Šæ”¾èµ„æº</li>
</ul>
</li>
<li>
<p>2  æ™ºèƒ½æŒ‡é’ˆçš„ç§ç±»: shared_ptrã€unique_ptrã€weak_ptrã€auto_ptr</p>
<ul>
<li><a href="https://blog.csdn.net/weixin_41969690/article/details/107912842"target="_blank" rel="external nofollow noopener noreferrer">å››ç§æŒ‡é’ˆè¯¦æƒ…<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
</ul>
</li>
</ul>
<p>2.1 æ™ºèƒ½æŒ‡é’ˆçš„å®ç°åŸç†</p>
<p>æ™ºèƒ½æŒ‡é’ˆçš„å®ç°åŸç†å°±æ˜¯åœ¨ä¸€ä¸ªç±»çš„å†…éƒ¨å°è£…äº†ç±»å¯¹è±¡çš„æŒ‡é’ˆï¼Œç„¶ååœ¨ææ„å‡½æ•°é‡Œå¯¹æˆ‘ä»¬çš„ç±»å¯¹è±¡æŒ‡é’ˆè¿›è¡Œé‡Šæ”¾ï¼Œå› ä¸ºç±»çš„ææ„æ˜¯åœ¨ç±»å¯¹è±¡ç”Ÿå‘½æœŸç»“æŸæ—¶è‡ªåŠ¨è°ƒç”¨çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±çœå»äº†æ‰‹åŠ¨é‡Šæ”¾å†…å­˜çš„æ“ä½œï¼Œé¿å…å¿˜è®°æ‰‹åŠ¨é‡Šæ”¾å¯¼è‡´çš„å†…å­˜æ³„æ¼ã€‚</p>
<p>2.2 C++11å››ç§æ™ºèƒ½æŒ‡é’ˆæ€»ç»“</p>
<p>2.2.1 auto_ptrï¼š</p>
<pre><code>auto_pträ»¥å‰æ˜¯ç”¨åœ¨C98ä¸­ï¼ŒC++11è¢«æŠ›å¼ƒï¼Œå¤´æ–‡ä»¶ä¸€èˆ¬ç”¨æ¥ä½œä¸ºç‹¬å æŒ‡é’ˆ

auto_ptrè¢«èµ‹å€¼æˆ–è€…æ‹·è´åï¼Œå¤±å»å¯¹åŸæŒ‡é’ˆçš„ç®¡ç†

auto_pträ¸èƒ½ç®¡ç†æ•°ç»„æŒ‡é’ˆï¼Œå› ä¸ºauto_ptrçš„å†…éƒ¨å®ç°ä¸­ï¼Œææ„å‡½æ•°ä¸­åˆ é™¤å¯¹è±¡ä½¿ç”¨deleteè€Œä¸æ˜¯delete[]ï¼Œé‡Šæ”¾å†…å­˜çš„æ—¶å€™ä»…é‡Šæ”¾äº†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç©ºé—´ï¼Œä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚

auto_pträ¸èƒ½ä½œä¸ºå®¹å™¨å¯¹è±¡ï¼Œå› ä¸ºSTLå®¹å™¨ä¸­çš„å…ƒç´ ç»å¸¸è¦æ”¯æŒæ‹·è´ï¼Œèµ‹å€¼ç­‰æ“ä½œã€‚
</code></pre>
<p>2.2.2 unique_ptr:</p>
<pre><code>C++11ä¸­ç”¨æ¥æ›¿ä»£auto_ptr

æ‹·è´æ„é€ å’Œèµ‹å€¼è¿ç®—ç¬¦è¢«ç¦ç”¨ï¼Œä¸èƒ½è¿›è¡Œæ‹·è´æ„é€ å’Œèµ‹å€¼è¿ç®—

è™½ç„¶ç¦ç”¨äº†æ‹·è´æ„é€ å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼Œä½†unique_ptrå¯ä»¥ä½œä¸ºè¿”å›å€¼ï¼Œç”¨äºä»æŸä¸ªå‡½æ•°ä¸­è¿”å›åŠ¨æ€ç”³è¯·å†…å­˜çš„æ‰€æœ‰æƒï¼Œæœ¬è´¨ä¸Šæ˜¯ç§»åŠ¨æ‹·è´ï¼Œå°±æ˜¯ä½¿ç”¨std:move()å‡½æ•°ï¼Œå°†æ‰€æœ‰æƒè½¬ç§»ã€‚
</code></pre>
<p>2.2.3 share_ptr:</p>
<pre><code>å¤šä¸ªæŒ‡é’ˆå¯ä»¥æŒ‡å‘ç›¸åŒçš„å¯¹è±¡ï¼Œè°ƒç”¨release()è®¡æ•°-1ï¼Œè®¡æ•°0æ—¶èµ„æºé‡Šæ”¾

.use_count()æŸ¥è®¡æ•°

.reset()æ”¾å¼ƒå†…éƒ¨æ‰€æœ‰æƒ

share_ptrå¤šæ¬¡å¼•ç”¨åŒä¸€æ•°æ®ä¼šå¯¼è‡´å†…å­˜å¤šæ¬¡é‡Šæ”¾

å¾ªç¯å¼•ç”¨ä¼šå¯¼è‡´æ­»é”ï¼Œ

å¼•ç”¨è®¡æ•°ä¸æ˜¯åŸå­æ“ä½œã€‚
</code></pre>
<p><code>shared_ptr</code> æœ‰ä¸¤ä¸ªæ•°æ®æˆå‘˜ï¼Œä¸€ä¸ªæ˜¯æŒ‡å‘ å¯¹è±¡çš„æŒ‡é’ˆ ptrï¼Œå¦ä¸€ä¸ªæ˜¯ ref_count æŒ‡é’ˆï¼ˆåŒ…å«vptrã€use_countã€weak_countã€ptrç­‰ï¼‰ï¼›
åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°
</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">(</span><span class="k">new</span> <span class="n">Foo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¥éª¤ä¸€ï¼š</p>
<pre><code>`y=x` æ¶‰åŠä¸¤ä¸ªæˆå‘˜çš„å¤åˆ¶ï¼Œè¿™ä¸¤æ­¥æ‹·è´ä¸ä¼šåŒæ—¶ï¼ˆåŸå­ï¼‰å‘ç”Ÿï¼Œä¸­é—´æ­¥éª¤ 1ï¼Œå¤åˆ¶ ptr æŒ‡é’ˆï¼Œä¸­é—´æ­¥éª¤ 2ï¼Œå¤åˆ¶ ref_count æŒ‡é’ˆï¼Œå¯¼è‡´å¼•ç”¨è®¡æ•°åŠ  1
</code></pre>
<p>
æ­¥éª¤äºŒ:
</p>
<p>å› ä¸ºæ˜¯ä¸¤æ­¥ï¼Œå¦‚æœæ²¡æœ‰ <code>mutex</code> ä¿æŠ¤ï¼Œé‚£ä¹ˆåœ¨å¤šçº¿ç¨‹é‡Œå°±æœ‰æ•°æ®ç«äº‰ã€‚</p>
<p>å¤šçº¿ç¨‹è¯»å†™åŒä¸€ä¸ª <code>shared_ptr</code> å¿…é¡»åŠ é”ã€‚</p>
<p>2.2.4 weak_ptr:</p>
<pre><code>1.è§£å†³ä¸¤ä¸ªshare_pträº’ç›¸å¼•ç”¨äº§ç”Ÿæ­»é”ï¼Œè®¡æ•°æ°¸è¿œé™ä¸åˆ°0ï¼Œæ²¡åŠæ³•è¿›è¡Œèµ„æºé‡Šæ”¾ï¼Œé€ æˆå†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚

2.ä½¿ç”¨æ—¶é…åˆshare_pträ½¿ç”¨ï¼ŒæŠŠå…¶ä¸­ä¸€ä¸ªshare_ptræ›´æ¢ä¸ºweak_ptrã€‚
</code></pre>
<h3 id="4-é‡è½½é‡å†™é‡å®šä¹‰">4. é‡è½½ã€é‡å†™ã€é‡å®šä¹‰</h3>
<p>(1) é‡è½½ï¼ˆoverloadï¼‰ï¼š
æŒ‡å‡½æ•°åç›¸åŒï¼Œä½†æ˜¯å®ƒçš„å‚æ•°è¡¨åˆ—ä¸ªæ•°æˆ–é¡ºåºï¼Œç±»å‹ä¸åŒã€‚ä½†æ˜¯ä¸èƒ½é è¿”å›ç±»å‹æ¥åˆ¤æ–­ã€‚
a ç›¸åŒçš„èŒƒå›´ï¼ˆåœ¨åŒä¸€ä¸ªç±»ä¸­ï¼‰
b å‡½æ•°åå­—ç›¸åŒã€ å‚æ•°ä¸åŒ
c virtualå…³é”®å­—å¯æœ‰å¯æ— 
d è¿”å›å€¼å¯ä»¥ä¸åŒï¼›</p>
<p>(2) é‡å†™ï¼ˆè¦†ç›–override)æ˜¯æŒ‡æ´¾ç”Ÿç±»å‡½æ•°è¦†ç›–åŸºç±»å‡½æ•°ï¼Œç‰¹å¾æ˜¯ï¼š
a ä¸åŒçš„èŒƒå›´ï¼Œåˆ†åˆ«ä½äºåŸºç±»å’Œæ´¾ç”Ÿç±»ä¸­
b å‡½æ•°çš„åå­—ç›¸åŒã€ å‚æ•°ç›¸åŒ
c åŸºç±»å‡½æ•°å¿…é¡»æœ‰virtualå…³é”®å­—ï¼Œä¸èƒ½æœ‰static
d è¿”å›å€¼ç›¸åŒï¼ˆæˆ–è€…åå˜ï¼‰ï¼Œå¦åˆ™æŠ¥é”™ï¼›
e é‡å†™å‡½æ•°çš„è®¿é—®ä¿®é¥°ç¬¦å¯ä»¥ä¸åŒã€‚å°½ç®¡virtualæ˜¯privateçš„ï¼Œæ´¾ç”Ÿç±»ä¸­é‡å†™æ”¹å†™ä¸ºpublic, protectedä¹Ÿæ˜¯å¯ä»¥çš„</p>
<p>(3) é‡å®šä¹‰(éšè—redefine)æ˜¯æŒ‡æ´¾ç”Ÿç±»çš„å‡½æ•°å±è”½äº†ä¸å…¶åŒåçš„åŸºç±»å‡½æ•°ï¼Œç‰¹å¾æ˜¯ï¼š
a ä¸åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸï¼ˆåˆ†åˆ«ä½äºæ´¾ç”Ÿç±»ä¸åŸºç±»ï¼‰
b å‡½æ•°åå­—ç›¸åŒ
c è¿”å›å€¼å¯ä»¥ä¸åŒ
d è§„åˆ™ï¼š</p>
<p>å¦‚æœæ´¾ç”Ÿç±»çš„å‡½æ•°å’ŒåŸºç±»çš„å‡½æ•°åŒåï¼Œä½†æ˜¯å‚æ•°ä¸åŒï¼Œæ­¤æ—¶ï¼Œä¸ç®¡æœ‰æ— virtualï¼ŒåŸºç±»çš„å‡½æ•°è¢«éšè—ï¼›</p>
<p>å¦‚æœæ´¾ç”Ÿç±»çš„å‡½æ•°ä¸åŸºç±»çš„å‡½æ•°åŒåï¼Œå¹¶ä¸”å‚æ•°ä¹Ÿç›¸åŒï¼Œä½†æ˜¯åŸºç±»å‡½æ•°æ²¡æœ‰vitualå…³é”®å­—ï¼Œæ­¤æ—¶ï¼ŒåŸºç±»çš„å‡½æ•°è¢«éšè—ã€‚</p>
<p>ps: å¤šæ€æ€§å¯ä»¥åˆ†ä¸ºé™æ€å¤šæ€æ€§ï¼ˆæ–¹æ³•çš„é‡è½½ï¼Œä¸€ä¸ªç±»ï¼‰å’ŒåŠ¨æ€å¤šæ€æ€§ï¼ˆæ–¹æ³•çš„è¦†ç›–ï¼Œæœ‰ç»§æ‰¿å…³ç³»çš„ç±»ä¹‹é—´çš„è¡Œä¸ºï¼‰ã€‚è¿›è€Œå¤šæ€æ€§å¯ä»¥ç”±é‡è½½å’Œè¦†ç›–æ¥å®ç°ã€‚</p>
<h3 id="5staticä¸conståŒºåˆ«å’Œä½œç”¨">5.staticä¸conståŒºåˆ«å’Œä½œç”¨</h3>
<p>static:</p>
<pre><code>1.**staticå±€éƒ¨å˜é‡**å°†ä¸€ä¸ªå˜é‡å£°æ˜ä¸ºå‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå±€éƒ¨å˜é‡åœ¨å‡½æ•°æ‰§è¡Œå®Œä¸ä¼šé‡Šæ”¾ï¼Œè€Œæ˜¯ç»§ç»­ä¿ç•™åœ¨å†…å­˜ä¸­ï¼›
2.**staticå…¨å±€å˜é‡**è¡¨ç¤ºä¸€ä¸ªå˜é‡åœ¨å½“å‰æ–‡ä»¶çš„å…¨å±€å¯ä»¥è®¿é—®ï¼›
3.**staticå‡½æ•°**è¡¨ç¤ºä¸€ä¸ªå‡½æ•°åªèƒ½åœ¨å½“å‰æ–‡ä»¶ä¸­è¢«è®¿é—®ï¼›
4.**staticç±»æˆå‘˜å˜é‡**è¡¨ç¤ºè¿™ä¸ªæˆå‘˜ä¸ºå…¨ç±»æ‰€å…±æœ‰ï¼›
5.**staticç±»æˆå‘˜å‡½æ•°**è¡¨ç¤ºè¿™ä¸ªå‡½æ•°ä¸ºå…¨ç±»æ‰€æœ‰ï¼Œä¸”åªèƒ½è®¿é—®æˆå‘˜å˜é‡ã€‚
6.å…¨å±€å˜é‡åœ¨æ•´ä¸ªå·¥ç¨‹æ–‡ä»¶å†…æœ‰æ•ˆï¼›é™æ€å…¨å±€å˜é‡åªåœ¨å®šä¹‰å®ƒçš„æ–‡ä»¶ä¸­æœ‰æ•ˆï¼›
7.é™æ€å±€éƒ¨å˜é‡åªåœ¨å®šä¹‰å®ƒçš„å‡½æ•°å†…æœ‰æ•ˆï¼Œä¸”ç¨‹åºåªåˆ†é…ä¸€æ¬¡å†…å­˜ï¼Œå‡½æ•°è¿”å›æ—¶ä¸ä¼šé‡Šæ”¾ï¼Œä¸‹æ¬¡è°ƒç”¨æ—¶ä¸ä¼šé‡æ–°èµ‹å€¼ï¼Œè¿˜ä¿ç•™ä¸Šæ¬¡ç»“æœå€¼ï¼›å±€éƒ¨å˜é‡åœ¨å‡½æ•°è¿”å›æ—¶å°±é‡Šæ”¾æ‰ï¼›
8.å…¨å±€å˜é‡å’Œé™æ€å˜é‡ç¼–è¯‘å™¨ä¼šé»˜è®¤åˆå§‹åŒ–ä¸º0ï¼›å±€éƒ¨å˜é‡çš„é»˜è®¤å€¼æœªçŸ¥ï¼›
9.å±€éƒ¨é™æ€å˜é‡ä¸å…¨å±€å˜é‡å…±äº«å…¨å±€æ•°æ®ï¼Œä½†æ˜¯é™æ€å±€éƒ¨å˜é‡å€¼åœ¨å®šä¹‰è¯¥å˜é‡çš„å‡½æ•°å†…éƒ¨å¯è§ã€‚
10.é™æ€æˆå‘˜ï¼ˆé™æ€æˆå‘˜å‡½æ•°ï¼‰ä¸éé™æ€æˆå‘˜ï¼ˆæˆå‘˜å‡½æ•°ï¼‰çš„åŒºåˆ«åœ¨äºæœ‰æ— thisæŒ‡é’ˆï¼›é™æ€æˆå‘˜æ˜¯é™æ€å­˜å‚¨ï¼Œå¿…é¡»è¿›è¡Œåˆå§‹åŒ–ï¼›
11.é™æ€æˆå‘˜å‡½æ•°è®¿é—®éé™æ€æˆå‘˜æŠ¥é”™: é™æ€æˆå‘˜åœ¨ç±»åŠ è½½æ—¶å°±å·²ç»åˆ†é…å†…å­˜ï¼Œè€Œæ­¤æ—¶éé™æ€æˆå‘˜å°šæœªåˆ†é…å†…å­˜ï¼Œè®¿é—®ä¸å­˜åœ¨çš„å†…å­˜è‡ªç„¶ä¼šæŠ¥é”™ï¼›
</code></pre>
<p>const</p>
<pre><code>1.&lt;font color=red&gt;constå¸¸é‡&lt;/font&gt; å®šä¹‰æ—¶å¿…é¡»åˆå§‹åŒ–ï¼Œä»¥åä¸èƒ½ä¿®æ”¹ï¼›
2.&lt;font color=red&gt;constå½¢å‚&lt;/font&gt; è¯¥å½¢å‚åœ¨å‡½æ•°é‡Œä¸èƒ½è¢«ä¿®æ”¹ï¼›
3.&lt;font color=red&gt;constä¿®é¥°ç±»æˆå‘˜å‡½æ•°&lt;/font&gt; è¯¥å‡½æ•°å¯¹æˆå‘˜å˜é‡åªèƒ½è¿›è¡Œè¯»æ“ä½œï¼›
</code></pre>
<p>staticå…³é”®å­—ä½œç”¨</p>
<pre><code>1.å‡½æ•°ä½“å†…staticå˜é‡çš„ä½œç”¨èŒƒå›´ä¸ºè¯¥å‡½æ•°ä½“ï¼Œè¯¥å˜é‡çš„å†…å­˜åªè¢«åˆ†é…ä¸€æ¬¡ï¼Œå› æ­¤è¯¥å€¼åœ¨ä¸‹æ¬¡è°ƒç”¨æ—¶è¿˜ç»´æŒä¸Šä¸€æ¬¡çš„å€¼ï¼›
2.åœ¨æ¨¡å—å†…çš„staticå‡½æ•°å’Œå˜é‡å¯ä»¥è¢«å¯ä»¥è¢«æ¨¡å—å†…çš„å‡½æ•°è®¿é—®ï¼Œä¸èƒ½è¢«æ¨¡å—å¤–çš„å‡½æ•°è®¿é—®ï¼›
3.åœ¨ç±»å†…çš„staticæˆå‘˜å˜é‡ä¸ºæ•´ä¸ªç±»æ‰€æœ‰ï¼Œç±»çš„æ‰€æœ‰å¯¹è±¡åªæœ‰ä¸€ä»½æ‹·è´ï¼›
4.åœ¨ç±»å†…çš„staticæˆå‘˜å‡½æ•°ä¸ºæ•´ä¸ªç±»æ‰€æœ‰ï¼Œè¿™ä¸ªå‡½æ•°ä¸æ¥æ”¶thisæŒ‡é’ˆï¼Œå› æ­¤åªèƒ½è®¿é—®ç±»çš„staticæˆå‘˜å˜é‡ï¼›
</code></pre>
<p>constå…³é”®å­—</p>
<pre><code>1.é˜»æ­¢ä¸€ä¸ªå˜é‡è¢«æ”¹å˜ï¼›
2.å£°æ˜å¸¸é‡æŒ‡é’ˆå’ŒæŒ‡é’ˆå¸¸é‡ï¼›
3.constä¿®é¥°å½¢å‚ï¼Œè¡¨ç¤ºä¸ºè¾“å…¥å‚æ•°ï¼Œåœ¨å‡½æ•°ä½“å†…ä¸èƒ½ä¿®æ”¹è¯¥å‚æ•°çš„å€¼ï¼›
4.constä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œè¡¨æ˜ä¸ºä¸€ä¸ªå¸¸å‡½æ•°ï¼Œä¸èƒ½ä¿®æ”¹æˆå‘˜å˜é‡çš„å€¼ï¼›
5.ç±»çš„æˆå‘˜å‡½æ•°ï¼Œæœ‰æ—¶å¿…é¡»è¿”å›constç±»å‹çš„å€¼ï¼Œä½¿å¾—è¿”å›å€¼ä¸èƒ½ä¸ºå·¦å€¼ã€‚
</code></pre>
<p><strong>constä¿®é¥°æŒ‡é’ˆæœ‰ä¸‰ç§æƒ…å†µ</strong></p>
<ol>
<li>constä¿®é¥°æŒ‡é’ˆ &mdash; å¸¸é‡æŒ‡é’ˆ (constä¿®é¥°çš„æ˜¯æŒ‡é’ˆ,æŒ‡é’ˆæŒ‡å‘å¯ä»¥æ”¹,æŒ‡é’ˆæŒ‡å‘çš„å€¼ä¸å¯ä»¥æ›´æ”¹)</li>
</ol>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">    <span class="k">const</span> <span class="kt">int</span> <span class="o">*</span> <span class="n">p1</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">;</span> <span class="c1">//æ­£ç¡®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//*p1 = 100; æŠ¥é”™
</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>constä¿®é¥°å¸¸é‡ &mdash; æŒ‡é’ˆå¸¸é‡ (constä¿®é¥°çš„æ˜¯å¸¸é‡,æŒ‡é’ˆæŒ‡å‘ä¸å¯ä»¥æ”¹,æŒ‡é’ˆæŒ‡å‘çš„å€¼å¯ä»¥æ›´æ”¹)</li>
</ol>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span> <span class="k">const</span> <span class="n">p2</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//p2 = &amp;b; //é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">*</span><span class="n">p2</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">//æ­£ç¡®
</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>constå³ä¿®é¥°æŒ‡é’ˆ,åˆä¿®é¥°å¸¸é‡ (constæ—¢ä¿®é¥°æŒ‡é’ˆåˆä¿®é¥°å¸¸é‡ï¼Œéƒ½ä¸å¯ä»¥æ”¹)</li>
</ol>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="o">*</span> <span class="k">const</span> <span class="n">p3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//p3 = &amp;b; //é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1">//*p3 = 100; //é”™è¯¯
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æŠ€å·§:çœ‹constå³ä¾§ç´§è·Ÿç€çš„æ˜¯æŒ‡é’ˆè¿˜æ˜¯å¸¸é‡, æ˜¯æŒ‡é’ˆå°±æ˜¯å¸¸æŒ‡é’ˆ,æ˜¯å¸¸é‡å°±æ˜¯æŒ‡é’ˆå¸¸é‡</p>
<h3 id="6-constä¸å®å®šä¹‰defineåŒºåˆ«å’Œä½œç”¨">6. constä¸å®å®šä¹‰ï¼ˆ#defineï¼‰åŒºåˆ«å’Œä½œç”¨</h3>
<p>const å®šä¹‰çš„æ˜¯å˜é‡ä¸æ˜¯å¸¸é‡ï¼Œåªæ˜¯è¿™ä¸ªå˜é‡çš„å€¼ä¸å…è®¸æ”¹å˜ï¼Œæ˜¯å¸¸å˜é‡ï¼Œå¸¦æœ‰ç±»å‹ã€‚ç¼–è¯‘è¿è¡Œçš„æ—¶å€™èµ·ä½œç”¨ï¼Œå­˜åœ¨ç±»å‹æ£€æŸ¥ã€‚</p>
<p>define å®šä¹‰çš„æ˜¯ä¸å¸¦ç±»å‹çš„å¸¸æ•°ï¼Œåªè¿›è¡Œç®€å•çš„å­—ç¬¦æ›¿æ¢ã€‚åœ¨é¢„ç¼–è¯‘çš„æ—¶å€™èµ·ä½œç”¨ï¼Œä¸å­˜åœ¨ç±»å‹æ£€æŸ¥ã€‚</p>
<p>1ã€ä¸¤è€…çš„åŒºåˆ«
(1) ç¼–è¯‘å™¨å¤„ç†æ–¹å¼ä¸åŒ
#define å®æ˜¯åœ¨é¢„å¤„ç†é˜¶æ®µå±•å¼€ã€‚
const å¸¸é‡æ˜¯ç¼–è¯‘è¿è¡Œé˜¶æ®µä½¿ç”¨ã€‚</p>
<p>(2) ç±»å‹å’Œå®‰å…¨æ£€æŸ¥ä¸åŒ
#define å®æ²¡æœ‰ç±»å‹ï¼Œä¸åšä»»ä½•ç±»å‹æ£€æŸ¥ï¼Œä»…ä»…æ˜¯å±•å¼€ã€‚
const å¸¸é‡æœ‰å…·ä½“çš„ç±»å‹ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šæ‰§è¡Œç±»å‹æ£€æŸ¥ã€‚</p>
<p>(3) å­˜å‚¨æ–¹å¼ä¸åŒ
#defineå®ä»…ä»…æ˜¯å±•å¼€ï¼Œæœ‰å¤šå°‘åœ°æ–¹ä½¿ç”¨ï¼Œå°±å±•å¼€å¤šå°‘æ¬¡ï¼Œä¸ä¼šåˆ†é…å†…å­˜ã€‚ï¼ˆå®å®šä¹‰ä¸åˆ†é…å†…å­˜ï¼Œå˜é‡å®šä¹‰åˆ†é…å†…å­˜ã€‚ï¼‰
constå¸¸é‡ä¼šåœ¨å†…å­˜ä¸­åˆ†é…(å¯ä»¥æ˜¯å †ä¸­ä¹Ÿå¯ä»¥æ˜¯æ ˆä¸­)ã€‚</p>
<p>(4) const å¯ä»¥èŠ‚çœç©ºé—´ï¼Œé¿å…ä¸å¿…è¦çš„å†…å­˜åˆ†é…ã€‚ ä¾‹å¦‚ï¼š
const å®šä¹‰å¸¸é‡ä»æ±‡ç¼–çš„è§’åº¦æ¥çœ‹ï¼Œåªæ˜¯ç»™å‡ºäº†å¯¹åº”çš„å†…å­˜åœ°å€ï¼Œè€Œä¸æ˜¯è±¡ #define ä¸€æ ·ç»™å‡ºçš„æ˜¯ç«‹å³æ•°ï¼Œæ‰€ä»¥ï¼Œconst å®šä¹‰çš„å¸¸é‡åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åªæœ‰ä¸€ä»½æ‹·è´ï¼ˆå› ä¸ºæ˜¯å…¨å±€çš„åªè¯»å˜é‡ï¼Œå­˜åœ¨é™æ€åŒºï¼‰ï¼Œè€Œ #define å®šä¹‰çš„å¸¸é‡åœ¨å†…å­˜ä¸­æœ‰è‹¥å¹²ä¸ªæ‹·è´ã€‚</p>
<p>(5) æé«˜äº†æ•ˆç‡ã€‚ ç¼–è¯‘å™¨é€šå¸¸ä¸ä¸ºæ™®é€šconstå¸¸é‡åˆ†é…å­˜å‚¨ç©ºé—´ï¼Œè€Œæ˜¯å°†å®ƒä»¬ä¿å­˜åœ¨ç¬¦å·è¡¨ä¸­ï¼Œè¿™ä½¿å¾—å®ƒæˆä¸ºä¸€ä¸ªç¼–è¯‘æœŸé—´çš„å¸¸é‡ï¼Œæ²¡æœ‰äº†å­˜å‚¨ä¸è¯»å†…å­˜çš„æ“ä½œï¼Œä½¿å¾—å®ƒçš„æ•ˆç‡ä¹Ÿå¾ˆé«˜ã€‚</p>
<p>(6) å®æ›¿æ¢åªä½œæ›¿æ¢ï¼Œä¸åšè®¡ç®—ï¼Œä¸åšè¡¨è¾¾å¼æ±‚è§£;å®é¢„ç¼–è¯‘æ—¶å°±æ›¿æ¢äº†ï¼Œç¨‹åºè¿è¡Œæ—¶ï¼Œå¹¶ä¸åˆ†é…å†…å­˜ã€‚è®¡ç®—æ—¶æ³¨æ„è¾¹ç¼˜æ•ˆåº”</p>
<h3 id="7è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°åŒºåˆ«">7.è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°åŒºåˆ«</h3>
<pre><code>1.è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°å¯ä»¥å®šä¹‰åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œå«æœ‰çº¯è™šå‡½æ•°çš„ç±»è¢«ç§°ä¸ºæŠ½è±¡ç±»ï¼Œè€Œåªå«æœ‰è™šå‡½æ•°çš„ç±»ä¸èƒ½è¢«ç§°ä¸ºæŠ½è±¡ç±»ã€‚
2.è™šå‡½æ•°å¯ä»¥è¢«ç›´æ¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥è¢«å­ç±»é‡è½½ä»¥åï¼Œä»¥å¤šæ€çš„å½¢å¼è°ƒç”¨ï¼Œè€Œçº¯è™šå‡½æ•°å¿…é¡»åœ¨å­ç±»ä¸­å®ç°è¯¥å‡½æ•°æ‰å¯ä»¥ä½¿ç”¨ï¼Œå› ä¸ºçº¯è™šå‡½æ•°åœ¨åŸºç±»æœ‰å£°æ˜è€Œæ²¡æœ‰å®šä¹‰ã€‚
3.è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°éƒ½å¯ä»¥åœ¨å­ç±»ä¸­è¢«é‡è½½ï¼Œä»¥å¤šæ€çš„å½¢å¼è¢«è°ƒç”¨ã€‚
4.è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°é€šå¸¸å­˜åœ¨äºæŠ½è±¡åŸºç±»ä¹‹ä¸­ï¼Œè¢«ç»§æ‰¿çš„å­ç±»é‡è½½ï¼Œç›®çš„æ˜¯æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ã€‚
5.è™šå‡½æ•°çš„å®šä¹‰å½¢å¼ï¼švirtual{};çº¯è™šå‡½æ•°çš„å®šä¹‰å½¢å¼ï¼švirtual  { } = 0;åœ¨è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°çš„å®šä¹‰ä¸­ä¸èƒ½æœ‰staticæ ‡è¯†ç¬¦ï¼ŒåŸå› å¾ˆç®€å•ï¼Œè¢«staticä¿®é¥°çš„å‡½æ•°åœ¨ç¼–è¯‘æ—¶è¦æ±‚å‰æœŸç»‘å®š,ç„¶è€Œè™šå‡½æ•°å´æ˜¯åŠ¨æ€ç»‘å®šï¼Œè€Œä¸”è¢«ä¸¤è€…ä¿®é¥°çš„å‡½æ•°ç”Ÿå‘½å‘¨æœŸä¹Ÿä¸ä¸€æ ·ã€‚
6.è™šå‡½æ•°å……åˆ†ä½“ç°äº†é¢å‘å¯¹è±¡æ€æƒ³ä¸­çš„ç»§æ‰¿å’Œå¤šæ€æ€§è¿™ä¸¤å¤§ç‰¹æ€§ï¼Œåœ¨C++è¯­è¨€é‡Œåº”ç”¨æå¹¿ã€‚æ¯”å¦‚åœ¨å¾®è½¯çš„MFCç±»åº“ä¸­ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šå‡½æ•°éƒ½æœ‰virtualå…³é”®å­—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬éƒ½æ˜¯è™šå‡½æ•°ã€‚éš¾æ€ªæœ‰äººç”šè‡³ç§°è™šå‡½æ•°æ˜¯C++è¯­è¨€çš„ç²¾é«“ã€‚
7.å®šä¹‰çº¯è™šå‡½æ•°å°±æ˜¯ä¸ºäº†è®©åŸºç±»ä¸å¯å®ä¾‹åŒ–ï¼Œå› ä¸ºå®ä¾‹åŒ–è¿™æ ·çš„æŠ½è±¡æ•°æ®ç»“æ„æœ¬èº«å¹¶æ²¡æœ‰æ„ä¹‰æˆ–è€…ç»™å‡ºå®ç°ä¹Ÿæ²¡æœ‰æ„ä¹‰ã€‚
</code></pre>
<p><font color=purple>çº¯è™šå‡½æ•°åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ˜¯ä¸ªå‡½æ•°çš„å£°æ˜è€Œå·²ï¼Œå®ƒè¦ç•™åˆ°å­ç±»é‡Œå»å®ç°ã€‚</font></p>
<p>è™šå‡½æ•°åœ¨å­ç±»é‡Œé¢ä¹Ÿå¯ä»¥ä¸é‡è½½çš„ï¼›ä½†çº¯è™šå¿…é¡»åœ¨å­ç±»å»å®ç°ï¼Œè¿™å°±åƒJavaçš„æ¥å£ä¸€æ ·ã€‚é€šå¸¸æˆ‘ä»¬æŠŠå¾ˆå¤šå‡½æ•°åŠ ä¸Švirtualï¼Œæ˜¯ä¸€ä¸ªå¥½çš„ä¹ æƒ¯ï¼Œè™½ç„¶ç‰ºç‰²äº†ä¸€äº›æ€§èƒ½ï¼Œä½†æ˜¯å¢åŠ äº†é¢å‘å¯¹è±¡çš„å¤šæ€æ€§ï¼Œå› ä¸ºä½ å¾ˆéš¾é¢„æ–™åˆ°çˆ¶ç±»é‡Œé¢çš„è¿™ä¸ªå‡½æ•°ä¸åœ¨å­ç±»é‡Œé¢ä¸å»ä¿®æ”¹å®ƒçš„å®ç°</p>
<p>è™šå‡½æ•°: <a href="https://www.cnblogs.com/zkfopen/p/11061414.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.cnblogs.com/zkfopen/p/11061414.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h3 id="8-æŒ‡é’ˆå’Œå¼•ç”¨çš„åŒºåˆ«">8. æŒ‡é’ˆå’Œå¼•ç”¨çš„åŒºåˆ«</h3>
<p>1.æŒ‡é’ˆå’Œå¼•ç”¨çš„å®šä¹‰å’Œæ€§è´¨åŒºåˆ«ï¼š</p>
<p>(1) æŒ‡é’ˆï¼šæŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œåªä¸è¿‡è¿™ä¸ªå˜é‡å­˜å‚¨çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼ŒæŒ‡å‘å†…å­˜çš„ä¸€ä¸ªå­˜å‚¨å•å…ƒï¼›è€Œå¼•ç”¨è·ŸåŸæ¥çš„å˜é‡å®è´¨ä¸Šæ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œåªä¸è¿‡æ˜¯åŸå˜é‡çš„ä¸€ä¸ªåˆ«åè€Œå·²ã€‚å¦‚ï¼š</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="o">=&amp;</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªæ•´å½¢å˜é‡å’Œä¸€ä¸ªæŒ‡é’ˆå˜é‡pï¼Œè¯¥æŒ‡é’ˆå˜é‡æŒ‡å‘açš„å­˜å‚¨å•å…ƒï¼Œå³pçš„å€¼æ˜¯aå­˜å‚¨å•å…ƒçš„åœ°å€ã€‚</p>
<p>è€Œä¸‹é¢2å¥å®šä¹‰äº†ä¸€ä¸ªæ•´å½¢å˜é‡aå’Œè¿™ä¸ªæ•´å½¢açš„å¼•ç”¨bï¼Œäº‹å®ä¸Šaå’Œbæ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œåœ¨å†…å­˜å æœ‰åŒä¸€ä¸ªå­˜å‚¨å•å…ƒã€‚</p>
<p>(2)å¼•ç”¨ä¸å¯ä»¥ä¸ºç©ºï¼Œå½“è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œå¿…é¡»åˆå§‹åŒ–ï¼Œè€ŒæŒ‡é’ˆå¯ä»¥æ˜¯ç©ºå€¼ï¼Œå¯ä»¥åœ¨ä»»ä½•æ—¶å€™è¢«åˆå§‹åŒ–ã€‚</p>
<p>(3)å¯ä»¥æœ‰constæŒ‡é’ˆï¼Œä½†æ˜¯æ²¡æœ‰constå¼•ç”¨ï¼›</p>
<p>(4)æŒ‡é’ˆå¯ä»¥æœ‰å¤šçº§ï¼Œä½†æ˜¯å¼•ç”¨åªèƒ½æ˜¯ä¸€çº§ï¼ˆint **pï¼›åˆæ³• è€Œ int &amp;&amp;aæ˜¯ä¸åˆæ³•çš„ï¼‰</p>
<p>(5)æŒ‡é’ˆçš„å€¼å¯ä»¥ä¸ºç©ºï¼Œä½†æ˜¯å¼•ç”¨çš„å€¼ä¸èƒ½ä¸ºNULLï¼Œå¹¶ä¸”å¼•ç”¨åœ¨å®šä¹‰çš„æ—¶å€™å¿…é¡»åˆå§‹åŒ–ï¼›</p>
<p>(6)æŒ‡é’ˆçš„å€¼åœ¨åˆå§‹åŒ–åå¯ä»¥æ”¹å˜ï¼Œå³æŒ‡å‘å…¶å®ƒçš„å­˜å‚¨å•å…ƒï¼Œè€Œå¼•ç”¨åœ¨è¿›è¡Œåˆå§‹åŒ–åå°±ä¸ä¼šå†æ”¹å˜äº†ã€‚</p>
<p>(7)&ldquo;sizeofå¼•ç”¨&quot;å¾—åˆ°çš„æ˜¯æ‰€æŒ‡å‘çš„å˜é‡(å¯¹è±¡)çš„å¤§å°ï¼Œè€Œ&quot;sizeofæŒ‡é’ˆ&quot;å¾—åˆ°çš„æ˜¯æŒ‡é’ˆæœ¬èº«çš„å¤§å°ï¼›</p>
<p>(8)æŒ‡é’ˆå’Œå¼•ç”¨çš„è‡ªå¢(++)è¿ç®—æ„ä¹‰ä¸ä¸€æ ·ï¼›</p>
<p>(9)å¦‚æœè¿”å›åŠ¨æ€å†…å­˜åˆ†é…çš„å¯¹è±¡æˆ–è€…å†…å­˜ï¼Œå¿…é¡»ä½¿ç”¨æŒ‡é’ˆï¼Œå¼•ç”¨å¯èƒ½å¼•èµ·å†…å­˜æ³„æ¼ï¼›</p>
<h3 id="9-ç»“æ„ä½“èµ‹å€¼">9. ç»“æ„ä½“èµ‹å€¼</h3>
<p>(ç»“æ„ä½“èµ‹å€¼)[https://blog.csdn.net/datase/article/details/78988320]</p>
<h3 id="10-cå’ŒcåŒºåˆ«">10. Cå’ŒC++åŒºåˆ«</h3>
<p>(Cå’ŒC++åŒºåˆ«)[https://blog.csdn.net/czc1997/article/details/81254971]</p>
<h3 id="11-cå’Œcä¼ å‚æ–¹å¼åŒºåˆ«">11. Cå’ŒC++ä¼ å‚æ–¹å¼åŒºåˆ«</h3>
<p>Cè¯­è¨€ä¸æ”¯æŒå¼•ç”¨ä¼ å‚ï¼Œå¦‚æœæƒ³è¦æ”¹å˜ä¼ å…¥å‚æ•°çš„å€¼ï¼Œåªèƒ½ç”¨ä¼ å…¥æŒ‡é’ˆçš„æ–¹å¼ã€‚</p>
<h3 id="12-æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«">12. æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«</h3>
<p>(æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«)[https://blog.csdn.net/Situo/article/details/110225143]</p>
<h3 id="13-é¿å…å¤´æ–‡ä»¶é‡å¤åŒ…å«ä»¥åŠå®å®šä¹‰é‡å®šä¹‰">13. é¿å…å¤´æ–‡ä»¶é‡å¤åŒ…å«ä»¥åŠå®å®šä¹‰é‡å®šä¹‰</h3>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#ifndef LWIP_TCP_KEEPALIVE
</span></span></span><span class="line"><span class="cl"><span class="cp">#define LWIP_TCP_KEEPALIVE
</span></span></span><span class="line"><span class="cl"><span class="cp">#endif</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="14-ä½ æ€ä¹ˆç†è§£è™šæ‹Ÿç±»è™šæ‹Ÿç±»å¯ä»¥å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡å—ä¸ºä»€ä¹ˆå®ƒçš„ä½œç”¨å’Œå…¶ä»–ç±»çš„åŒºåˆ«">14. ä½ æ€ä¹ˆç†è§£è™šæ‹Ÿç±»ï¼Ÿè™šæ‹Ÿç±»å¯ä»¥å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿå®ƒçš„ä½œç”¨å’Œå…¶ä»–ç±»çš„åŒºåˆ«</h3>
<p>ç­”æ¡ˆï¼šè™šæ‹Ÿç±»å¯ä»¥æ´¾ç”Ÿå¯¹è±¡ï¼Œçº¯è™šç±»ä¸å¯ä»¥å®ä¾‹åŒ–å¯¹è±¡ã€‚å› ä¸ºçº¯è™šç±»å­˜åœ¨æœªå®šä¹‰çš„å‡½æ•°ï¼Œåªæ˜¯ä¸ªæ¦‚å¿µï¼Œä¸å¯çœŸå®å­˜åœ¨ã€‚è™šæ‹Ÿç±»ç”¨åšå¤šæ€ï¼Œçº¯è™šç±»åšæ¥å£ã€‚</p>
<h3 id="15-å†…è”å‡½æ•°æ€ä¹ˆå®ç°çš„ä»€ä¹ˆæ—¶æœŸå¤„ç†çš„ä¼˜ç¼ºç‚¹">15. å†…è”å‡½æ•°æ€ä¹ˆå®ç°çš„ï¼Œä»€ä¹ˆæ—¶æœŸå¤„ç†çš„ï¼Œä¼˜ç¼ºç‚¹</h3>
<p>ç­”æ¡ˆï¼šåœ¨ç¨‹åºç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨å°†ç¨‹åºä¸­å‡ºç°çš„å†…è”å‡½æ•°çš„è°ƒç”¨è¡¨è¾¾å¼ç”¨å†…è”å‡½æ•°çš„å‡½æ•°ä½“æ¥è¿›è¡Œæ›¿æ¢ã€‚
ä¼˜ç‚¹ï¼šä¸ä¼šäº§ç”Ÿå‡½æ•°è°ƒç”¨çš„å¼€é”€
ç¼ºç‚¹ï¼šå¢åŠ ç›®æ ‡ç¨‹åºçš„ä»£ç é‡ï¼Œå³å¢åŠ ç©ºé—´å¼€é”€</p>
<h3 id="16-ä½è¿ç®—æŒ‰ä½ä¸æŒ‰ä½æˆ–å¼‚æˆ–">16 .ä½è¿ç®—ï¼ˆæŒ‰ä½ä¸ã€æŒ‰ä½æˆ–ã€å¼‚æˆ–ï¼‰</h3>
<p>æŒ‰ä½ä¸è¿ç®—ç¬¦ï¼ˆ&amp;ï¼‰</p>
<p>å‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€œä¸â€è¿ç®—ã€‚</p>
<p>è¿ç®—è§„åˆ™ï¼šåªæœ‰ä¸¤ä¸ªæ•°çš„äºŒè¿›åˆ¶åŒæ—¶ä¸º1ï¼Œç»“æœæ‰ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚ï¼ˆè´Ÿæ•°æŒ‰è¡¥ç å½¢å¼å‚åŠ æŒ‰ä½ä¸è¿ç®—ï¼‰</p>
<p>å³ 0 &amp; 0= 0 ï¼Œ0 &amp; 1= 0ï¼Œ1 &amp; 0= 0ï¼Œ 1 &amp; 1= 1ã€‚</p>
<p>ä¾‹ï¼š3 &amp;5  å³ 00000011 &amp; 00000101 = 00000001 ï¼Œæ‰€ä»¥ 3 &amp; 5çš„å€¼ä¸º1ã€‚</p>
<p>æŒ‰ä½æˆ–è¿ç®—ç¬¦ï¼ˆ|ï¼‰</p>
<p>å‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€œæˆ–â€è¿ç®—ã€‚</p>
<p>è¿ç®—è§„åˆ™ï¼šå‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°åªè¦ä¸¤ä¸ªæ•°ä¸­çš„ä¸€ä¸ªä¸º1ï¼Œç»“æœå°±ä¸º1ã€‚</p>
<p>å³  0 | 0= 0 ,  1 | 0= 1  ï¼Œ 0 | 1= 1  ,  1 | 1= 1 ã€‚</p>
<p>ä¾‹ï¼š2 | 4 å³ 00000010 | 00000100 = 00000110 ï¼Œæ‰€ä»¥2 | 4çš„å€¼ä¸º 6 ã€‚
å¼‚æˆ–è¿ç®—ç¬¦ï¼ˆ^ï¼‰</p>
<p>å‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€œå¼‚æˆ–â€è¿ç®—ã€‚</p>
<p>è¿ç®—è§„åˆ™ï¼šå‚åŠ è¿ç®—çš„ä¸¤ä¸ªæ•°ï¼Œå¦‚æœä¸¤ä¸ªç›¸åº”ä½ä¸ºâ€œå¼‚â€ï¼ˆå€¼ä¸åŒï¼‰ï¼Œåˆ™è¯¥ä½ç»“æœä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚</p>
<p>å³ 0 ^ 0=0  ï¼Œ 0 ^ 1= 1  ï¼Œ 1 ^ 0= 1  ï¼Œ 1 ^ 1= 0 ã€‚</p>
<p>ä¾‹ï¼š 2 ^ 4 å³ 00000010 ^ 00000100 =00000110 ï¼Œæ‰€ä»¥ 2 ^ 4 çš„å€¼ä¸º6 ã€‚</p>
<h3 id="17-åŸç åç è¡¥ç ">17. åŸç ã€åç ã€è¡¥ç </h3>
<blockquote>
<p>åŸç ï¼šæ˜¯æœ€ç®€å•çš„æœºå™¨æ•°è¡¨ç¤ºæ³•ã€‚ç”¨æœ€é«˜ä½è¡¨ç¤ºç¬¦å·ä½ï¼Œâ€˜1â€™è¡¨ç¤ºè´Ÿå·ï¼Œâ€˜0â€™è¡¨ç¤ºæ­£å·ã€‚å…¶ä»–ä½å­˜æ”¾è¯¥æ•°çš„äºŒè¿›åˆ¶çš„ç»å¯¹å€¼ã€‚</p>
</blockquote>
<blockquote>
<p>åç ï¼šæ­£æ•°çš„åç è¿˜æ˜¯ç­‰äºåŸç 
è´Ÿæ•°çš„åç å°±æ˜¯ä»–çš„åŸç é™¤ç¬¦å·ä½å¤–ï¼ŒæŒ‰ä½å–åã€‚</p>
</blockquote>
<blockquote>
<p>è¡¥ç ï¼šæ­£æ•°çš„è¡¥ç ç­‰äºä»–çš„åŸç 
è´Ÿæ•°çš„è¡¥ç ç­‰äºåç +1ã€‚</p>
</blockquote>
<h3 id="18--å †å’Œæ ˆ">18 . å †å’Œæ ˆ</h3>
<p>(å †å’Œæ ˆ)[https://blog.csdn.net/qq_45856289/article/details/106473750]</p>
<h3 id="19-ç±»å’Œå¯¹è±¡">19. ç±»å’Œå¯¹è±¡</h3>
<p>é¢å‘å¯¹è±¡(Object Oriented,OO)ã€‚</p>
<p>èµ·åˆï¼Œâ€œé¢å‘å¯¹è±¡â€æ˜¯æŒ‡åœ¨ç¨‹åºè®¾è®¡ä¸­é‡‡ç”¨å°è£…ã€ç»§æ‰¿ã€å¤šæ€ç­‰è®¾è®¡æ–¹æ³•ã€‚ç°åœ¨ï¼Œé¢å‘å¯¹è±¡çš„æ€æƒ³å·²ç»æ¶‰åŠåˆ°è½¯ä»¶å¼€å‘çš„å„ä¸ªæ–¹é¢ã€‚å¦‚ï¼Œé¢å‘å¯¹è±¡çš„åˆ†æï¼ˆOOAï¼ŒObjectOriented Analysisï¼‰ï¼Œé¢å‘å¯¹è±¡çš„è®¾è®¡ï¼ˆOODï¼ŒObject Oriented Designï¼‰ã€ä»¥åŠé¢å‘å¯¹è±¡çš„ç¼–ç¨‹å®ç°ï¼ˆOOPï¼ŒObject Oriented Programmingï¼‰ã€‚
å¯¹è±¡å’Œç±»è§£é‡Šï¼š</p>
<p>1ï¼‰å¯¹è±¡ï¼šå¯¹è±¡æ˜¯äººä»¬è¦è¿›è¡Œç ”ç©¶çš„ä»»ä½•äº‹ç‰©ï¼Œå®ƒä¸ä»…èƒ½è¡¨ç¤ºå…·ä½“çš„äº‹ç‰©ï¼Œè¿˜èƒ½è¡¨ç¤ºæŠ½è±¡çš„è§„åˆ™ã€è®¡åˆ’æˆ–äº‹ä»¶ã€‚å¯¹è±¡å…·æœ‰çŠ¶æ€ï¼Œä¸€ä¸ªå¯¹è±¡ç”¨æ•°æ®å€¼æ¥æè¿°å®ƒçš„çŠ¶æ€ã€‚å¯¹è±¡è¿˜æœ‰æ“ä½œï¼Œç”¨äºæ”¹å˜å¯¹è±¡çš„çŠ¶æ€ï¼Œå¯¹è±¡åŠå…¶æ“ä½œå°±æ˜¯å¯¹è±¡çš„è¡Œä¸ºã€‚å¯¹è±¡å®ç°äº†æ•°æ®å’Œæ“ä½œçš„ç»“åˆï¼Œä½¿æ•°æ®å’Œæ“ä½œå°è£…äºå¯¹è±¡çš„ç»Ÿä¸€ä½“ä¸­ã€‚</p>
<p>2ï¼‰ç±»ï¼šå…·æœ‰ç›¸åŒç‰¹æ€§ï¼ˆæ•°æ®å…ƒç´ ï¼‰å’Œè¡Œä¸ºï¼ˆåŠŸèƒ½ï¼‰çš„å¯¹è±¡çš„æŠ½è±¡å°±æ˜¯ç±»ã€‚å› æ­¤ï¼Œå¯¹è±¡çš„æŠ½è±¡æ˜¯ç±»ï¼Œç±»çš„å…·ä½“åŒ–å°±æ˜¯å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥è¯´ç±»çš„å®ä¾‹æ˜¯å¯¹è±¡ï¼Œç±»å®é™…ä¸Šå°±æ˜¯ä¸€ç§æ•°æ®ç±»å‹ã€‚ç±»å…·æœ‰å±æ€§ï¼Œå®ƒæ˜¯å¯¹è±¡çš„çŠ¶æ€çš„æŠ½è±¡ï¼Œç”¨æ•°æ®ç»“æ„æ¥æè¿°ç±»çš„å±æ€§ã€‚ç±»å…·æœ‰æ“ä½œï¼Œå®ƒæ˜¯å¯¹è±¡çš„è¡Œä¸ºçš„æŠ½è±¡ï¼Œç”¨æ“ä½œåå’Œå®ç°è¯¥æ“ä½œçš„æ–¹æ³•æ¥æè¿°ã€‚
å¯¹è±¡å’Œç±»çš„å…³ç³»ï¼š</p>
<p>ç±»ä¸å¯¹è±¡çš„å…³ç³»å°±å¦‚æ¨¡å…·å’Œé“¸ä»¶çš„å…³ç³»ï¼Œç±»çš„å®åŠ›åŒ–çš„ç»“æœå°±æ˜¯å¯¹è±¡ï¼Œè€Œå¯¹å¯¹è±¡çš„æŠ½è±¡å°±æ˜¯ç±»ï¼Œç±»æè¿°äº†ä¸€ç»„æœ‰ç›¸åŒç‰¹æ€§ï¼ˆå±æ€§ï¼‰å’Œç›¸åŒè¡Œä¸ºçš„å¯¹è±¡ã€‚</p>
<h3 id="20--newå’ŒmallocåŒºåˆ«">20 . newå’ŒmallocåŒºåˆ«</h3>
<p>0.å±æ€§
new/deleteæ˜¯C++å…³é”®å­—ï¼Œéœ€è¦ç¼–è¯‘å™¨æ”¯æŒã€‚malloc/freeæ˜¯åº“å‡½æ•°ï¼Œéœ€è¦å¤´æ–‡ä»¶æ”¯æŒã€‚</p>
<p>1.å‚æ•°
ä½¿ç”¨newæ“ä½œç¬¦ç”³è¯·å†…å­˜åˆ†é…æ—¶<u>æ— é¡»æŒ‡å®šå†…å­˜å—çš„å¤§å°</u>ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®ç±»å‹ä¿¡æ¯è‡ªè¡Œè®¡ç®—ã€‚è€Œmallocåˆ™éœ€è¦<u>æ˜¾å¼åœ°æŒ‡å‡ºæ‰€éœ€å†…å­˜çš„å°ºå¯¸</u>ã€‚</p>
<p>2.è¿”å›ç±»å‹
newæ“ä½œç¬¦å†…å­˜åˆ†é…æˆåŠŸæ—¶ï¼Œè¿”å›çš„æ˜¯å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆï¼Œç±»å‹ä¸¥æ ¼ä¸å¯¹è±¡åŒ¹é…ï¼Œæ— é¡»è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ•…newæ˜¯ç¬¦åˆç±»å‹å®‰å…¨æ€§çš„æ“ä½œç¬¦ã€‚
è€Œmallocå†…å­˜åˆ†é…æˆåŠŸåˆ™æ˜¯è¿”å›void * ï¼Œéœ€è¦é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢å°†void*æŒ‡é’ˆè½¬æ¢æˆæˆ‘ä»¬éœ€è¦çš„ç±»å‹ã€‚</p>
<p>3.åˆ†é…å¤±è´¥
newå†…å­˜åˆ†é…å¤±è´¥æ—¶ï¼Œä¼šæŠ›å‡ºbac_allocå¼‚å¸¸ã€‚mallocåˆ†é…å†…å­˜å¤±è´¥æ—¶è¿”å›NULLã€‚</p>
<p>4.è‡ªå®šä¹‰ç±»å‹
newä¼šå…ˆè°ƒç”¨operator newå‡½æ•°ï¼Œç”³è¯·è¶³å¤Ÿçš„å†…å­˜ï¼ˆé€šå¸¸åº•å±‚ä½¿ç”¨mallocå®ç°ï¼‰ã€‚ç„¶åè°ƒç”¨ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æˆå‘˜å˜é‡ï¼Œæœ€åè¿”å›è‡ªå®šä¹‰ç±»å‹æŒ‡é’ˆã€‚deleteå…ˆè°ƒç”¨ææ„å‡½æ•°ï¼Œç„¶åè°ƒç”¨operator deleteå‡½æ•°é‡Šæ”¾å†…å­˜ï¼ˆé€šå¸¸åº•å±‚ä½¿ç”¨freeå®ç°ï¼‰ã€‚
malloc/freeæ˜¯åº“å‡½æ•°ï¼Œåªèƒ½åŠ¨æ€çš„ç”³è¯·å’Œé‡Šæ”¾å†…å­˜ï¼Œæ— æ³•å¼ºåˆ¶è¦æ±‚å…¶åšè‡ªå®šä¹‰ç±»å‹å¯¹è±¡æ„é€ å’Œææ„å·¥ä½œã€‚</p>
<p>5.é‡è½½
C++å…è®¸é‡è½½new/deleteæ“ä½œç¬¦ï¼Œç‰¹åˆ«çš„ï¼Œå¸ƒå±€newçš„å°±ä¸éœ€è¦ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ï¼Œè€Œæ˜¯æŒ‡å®šäº†ä¸€ä¸ªåœ°å€ä½œä¸ºå†…å­˜èµ·å§‹åŒºåŸŸï¼Œnewåœ¨è¿™æ®µå†…å­˜ä¸Šä¸ºå¯¹è±¡è°ƒç”¨æ„é€ å‡½æ•°å®Œæˆåˆå§‹åŒ–å·¥ä½œï¼Œå¹¶è¿”å›æ­¤åœ°å€ã€‚è€Œmallocä¸å…è®¸é‡è½½ã€‚</p>
<p>6.å†…å­˜åŒºåŸŸ
newæ“ä½œç¬¦ä»è‡ªç”±å­˜å‚¨åŒºï¼ˆfree storeï¼‰ä¸Šä¸ºå¯¹è±¡åŠ¨æ€åˆ†é…å†…å­˜ç©ºé—´ï¼Œè€Œmallocå‡½æ•°ä»å †ä¸ŠåŠ¨æ€åˆ†é…å†…å­˜ã€‚è‡ªç”±å­˜å‚¨åŒºæ˜¯C++åŸºäºnewæ“ä½œç¬¦çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå‡¡æ˜¯é€šè¿‡newæ“ä½œç¬¦è¿›è¡Œå†…å­˜ç”³è¯·ï¼Œè¯¥å†…å­˜å³ä¸ºè‡ªç”±å­˜å‚¨åŒºã€‚è€Œå †æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„æœ¯è¯­ï¼Œæ˜¯æ“ä½œç³»ç»Ÿæ‰€ç»´æŠ¤çš„ä¸€å—ç‰¹æ®Šå†…å­˜ï¼Œç”¨äºç¨‹åºçš„å†…å­˜åŠ¨æ€åˆ†é…ï¼ŒCè¯­è¨€ä½¿ç”¨mallocä»å †ä¸Šåˆ†é…å†…å­˜ï¼Œä½¿ç”¨freeé‡Šæ”¾å·²åˆ†é…çš„å¯¹åº”å†…å­˜ã€‚è‡ªç”±å­˜å‚¨åŒºä¸ç­‰äºå †ï¼Œå¦‚ä¸Šæ‰€è¿°ï¼Œå¸ƒå±€newå°±å¯ä»¥ä¸ä½äºå †ä¸­</p>
<h3 id="21-å†…æ ¸é“¾è¡¨ä¸åŒå‘å¾ªç¯é“¾è¡¨">21. å†…æ ¸é“¾è¡¨ä¸åŒå‘å¾ªç¯é“¾è¡¨</h3>
<p>(å†…æ ¸é“¾è¡¨ä¸åŒå‘å¾ªç¯é“¾è¡¨)[https://blog.csdn.net/liebao_han/article/details/53956609]</p>
<h3 id="22-ç»“æ„ä½“å’Œç±»çš„åŒºåˆ«">22. ç»“æ„ä½“å’Œç±»çš„åŒºåˆ«</h3>
<p>1.ç»“æ„ä½“æ˜¯ä¸€ç§å€¼ç±»å‹ï¼Œè€Œç±»æ˜¯å¼•ç”¨ç±»å‹ã€‚å€¼ç±»å‹ç”¨äºå­˜å‚¨æ•°æ®çš„å€¼ï¼Œå¼•ç”¨ç±»å‹ç”¨äºå­˜å‚¨å¯¹å®é™…æ•°æ®çš„å¼•ç”¨ã€‚
é‚£ä¹ˆç»“æ„ä½“å°±æ˜¯å½“æˆå€¼æ¥ä½¿ç”¨çš„ï¼Œç±»åˆ™é€šè¿‡å¼•ç”¨æ¥å¯¹å®é™…æ•°æ®æ“ä½œã€‚</p>
<ol start="2">
<li>ç»“æ„ä½“ä½¿ç”¨æ ˆå­˜å‚¨ï¼ˆStack Allocationï¼‰ï¼Œè€Œç±»ä½¿ç”¨å †å­˜å‚¨ï¼ˆHeap Allocation)
æ ˆçš„ç©ºé—´ç›¸å¯¹è¾ƒå°.ä½†æ˜¯å­˜å‚¨åœ¨æ ˆä¸­çš„æ•°æ®è®¿é—®æ•ˆç‡ç›¸å¯¹è¾ƒé«˜.
å †çš„ç©ºé—´ç›¸å¯¹è¾ƒå¤§.ä½†æ˜¯å­˜å‚¨åœ¨å †ä¸­çš„æ•°æ®çš„è®¿é—®æ•ˆç‡ç›¸å¯¹è¾ƒä½.</li>
</ol>
<p>3.ç±»æ˜¯åæ˜ ç°å®äº‹ç‰©çš„ä¸€ç§æŠ½è±¡ï¼Œè€Œç»“æ„ä½“çš„ä½œç”¨åªæ˜¯ä¸€ç§åŒ…å«äº†å…·ä½“ä¸åŒç±»åˆ«æ•°æ®çš„ä¸€ç§åŒ…è£…ï¼Œç»“æ„ä½“ä¸å…·å¤‡ç±»çš„ç»§æ‰¿å¤šæ€ç‰¹æ€§</p>
<p>4.ç»“æ„ä½“èµ‹å€¼æ˜¯ ç›´æ¥èµ‹å€¼çš„å€¼. è€Œå¯¹è±¡çš„æŒ‡é’ˆ èµ‹å€¼çš„æ˜¯å¯¹è±¡çš„åœ°å€</p>
<p>5.Structå˜é‡ä½¿ç”¨å®Œä¹‹åå°±è‡ªåŠ¨è§£é™¤å†…å­˜åˆ†é…ï¼ŒClasså®ä¾‹æœ‰åƒåœ¾å›æ”¶æœºåˆ¶æ¥ä¿è¯å†…å­˜çš„å›æ”¶å¤„ç†ã€‚</p>
<p>6.ç»“æ„ä½“çš„æ„é€ å‡½æ•°ä¸­ï¼Œå¿…é¡»ä¸ºç»“æ„ä½“æ‰€æœ‰å­—æ®µèµ‹å€¼ï¼Œç±»çš„æ„é€ å‡½æ•°æ— æ­¤é™åˆ¶</p>
<p>é¦–å…ˆ,å…³äºéšå¼æ„é€ å‡½æ•°.æˆ‘ä»¬çŸ¥é“,åœ¨1ä¸ªç±»ä¸­å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¸ºç±»å†™ä»»æ„çš„æ„é€ å‡½æ•°,é‚£ä¹ˆC++ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šè‡ªåŠ¨çš„ä¸ºè¿™ä¸ªç±»ç”Ÿæˆ1ä¸ªæ— å‚æ•°çš„æ„é€ å‡½æ•°.æˆ‘ä»¬å°†è¿™ä¸ªæ„é€ å‡½æ•°ç§°ä¹‹ä¸ºéšå¼æ„é€ å‡½æ•° ä½†æ˜¯ä¸€æ—¦æˆ‘ä»¬ä¸ºè¿™ä¸ªç±»å†™äº†ä»»æ„çš„1ä¸ªæ„é€ å‡½æ•°çš„æ—¶å€™,è¿™ä¸ªéšå¼çš„æ„é€ å‡½æ•°å°±ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆäº†.åœ¨ç»“æ„ä½“ä¸­,å°±ä¸æ˜¯è¿™æ ·äº†,åœ¨ç»“æ„ä½“ä¸­éšå¼çš„æ„é€ å‡½æ•°æ— è®ºå¦‚ä½•éƒ½å­˜åœ¨ã€‚æ‰€ä»¥ç¨‹åºå‘˜ä¸èƒ½æ‰‹åŠ¨çš„ä¸ºç»“æ„æ·»åŠ 1ä¸ªæ— å‚æ•°çš„æ„é€ å‡½æ•°ã€‚</p>
<p>7.ç»“æ„ä½“ä¸­å£°æ˜çš„å­—æ®µæ— æ³•èµ‹äºˆåˆå€¼ï¼Œç±»å¯ä»¥:</p>
<p>å¦‚ä½•é€‰æ‹©ç»“æ„ä½“è¿˜æ˜¯ç±»</p>
<p>1ï¼ å †æ ˆçš„ç©ºé—´æœ‰é™ï¼Œå¯¹äºå¤§é‡çš„é€»è¾‘çš„å¯¹è±¡ï¼Œåˆ›å»ºç±»è¦æ¯”åˆ›å»ºç»“æ„å¥½ä¸€äº›
2ï¼ ç»“æ„è¡¨ç¤ºå¦‚ç‚¹ã€çŸ©å½¢å’Œé¢œè‰²è¿™æ ·çš„è½»é‡å¯¹è±¡ï¼Œä¾‹å¦‚ï¼Œå¦‚æœå£°æ˜ä¸€ä¸ªå«æœ‰ 1000 ä¸ªç‚¹å¯¹è±¡çš„æ•°ç»„ï¼Œåˆ™å°†ä¸ºå¼•ç”¨æ¯ä¸ªå¯¹è±¡åˆ†é…é™„åŠ çš„å†…å­˜ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œç»“æ„çš„æˆæœ¬è¾ƒä½ã€‚
3ï¼ åœ¨è¡¨ç°æŠ½è±¡å’Œå¤šçº§åˆ«çš„å¯¹è±¡å±‚æ¬¡æ—¶ï¼Œç±»æ˜¯æœ€å¥½çš„é€‰æ‹©
4ï¼ å¤§å¤šæ•°æƒ…å†µä¸‹è¯¥ç±»å‹åªæ˜¯ä¸€äº›æ•°æ®æ—¶ï¼Œç»“æ„æ—¶æœ€ä½³çš„é€‰æ‹©</p>
<h3 id="23-ç»“æ„ä½“å’Œè”åˆä½“åŒºåˆ«">23. ç»“æ„ä½“å’Œè”åˆä½“åŒºåˆ«</h3>
<p>ä¸¤è€…æœ€å¤§çš„åŒºåˆ«åœ¨äºå†…å­˜åˆ©ç”¨</p>
<p>ä¸€ã€ç»“æ„ä½“struct</p>
<pre><code>å„æˆå‘˜å„è‡ªæ‹¥æœ‰è‡ªå·±çš„å†…å­˜ï¼Œå„è‡ªä½¿ç”¨äº’ä¸å¹²æ¶‰ï¼ŒåŒæ—¶å­˜åœ¨çš„ï¼Œéµå¾ªå†…å­˜å¯¹é½åŸåˆ™ã€‚ä¸€ä¸ªstructå˜é‡çš„æ€»é•¿åº¦ç­‰äºæ‰€æœ‰æˆå‘˜çš„é•¿åº¦ä¹‹å’Œã€‚
</code></pre>
<p>äºŒã€è”åˆä½“union</p>
<p>å„æˆå‘˜å…±ç”¨ä¸€å—å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”åŒæ—¶åªæœ‰ä¸€ä¸ªæˆå‘˜å¯ä»¥å¾—åˆ°è¿™å—å†…å­˜çš„ä½¿ç”¨æƒ(å¯¹è¯¥å†…å­˜çš„è¯»å†™)ï¼Œå„å˜é‡å…±ç”¨ä¸€ä¸ªå†…å­˜é¦–åœ°å€ã€‚å› è€Œï¼Œè”åˆä½“æ¯”ç»“æ„ä½“æ›´èŠ‚çº¦å†…å­˜ã€‚ä¸€ä¸ªunionå˜é‡çš„æ€»é•¿åº¦è‡³å°‘èƒ½å®¹çº³æœ€å¤§çš„æˆå‘˜å˜é‡ï¼Œè€Œä¸”è¦æ»¡è¶³æ˜¯æ‰€æœ‰æˆå‘˜å˜é‡ç±»å‹å¤§å°çš„æ•´æ•°å€ã€‚</p>
<h3 id="24-ç»“æ„ä½“å’Œæšä¸¾">24. ç»“æ„ä½“å’Œæšä¸¾</h3>
<p>ä¸€ã€ç»“æ„ä½“</p>
<p>ç»“æ„ä½“:å¾ˆåƒé¢å‘å¯¹è±¡ä¸­çš„å¯¹è±¡ï¼Œä½†æ˜¯ç»“æ„ä½“æ²¡æœ‰æ–¹æ³•åªæœ‰å±æ€§ï¼Œä¸€ä¸ªç»“æ„ä½“ç”±ä¸åŒç±»å‹çš„å…ƒç´ ç»„æˆï¼Œè€Œç›¸è¾ƒäºæ•°ç»„æ¥è¯´ï¼Œæ•°ç»„åªèƒ½å­˜å‚¨ç›¸åŒç±»å‹çš„å…ƒç´ ã€‚ç»“æ„ä½“å ç”¨çš„ç©ºé—´ç­‰äºå†…éƒ¨å„å…ƒç´ å ç”¨ç©ºé—´çš„å’Œï¼Œå¹¶ä¸”å…ƒç´ åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼ˆæŒ‰ç…§å…ƒç´ å®šä¹‰çš„é¡ºåºï¼‰æ˜¯è¿ç»­çš„ã€‚</p>
<p>æ³¨æ„ï¼šç»“æ„ä½“ä¸èƒ½åƒé¢å‘å¯¹è±¡ä¸­é‚£æ ·é€’å½’è°ƒç”¨ï¼Œè‡ªå·±åŒ…å«è‡ªå·±ï¼Œä½†æ˜¯å¯ä»¥åŒ…å«å…¶ä»–ç±»å‹çš„ç»“æ„ä½“ã€‚</p>
<p>äºŒã€æšä¸¾</p>
<p>æšä¸¾:å’Œé¢å‘å¯¹è±¡ä¸­ä¸€æ ·ï¼Œæšä¸¾éƒ½æ˜¯ç”¨æ¥å®šä¹‰ä¸€äº›å›ºå®šå–å€¼çš„å¸¸é‡,ä½†æ˜¯Cä¸­çš„æšä¸¾ä¸­çš„å€¼æ˜¯æ•´æ•°ï¼Œé»˜è®¤æŒ‰ç…§0é€’å¢,ä¹Ÿå¯ä»¥åœ¨å®šä¹‰æšä¸¾çš„æ—¶å€™èµ‹å€¼ï¼Œé‚£ä¹ˆåé¢çš„å…ƒç´ çš„å€¼å°±ä¼šä»¥è¿™ä¸ªå…ƒç´ ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ é€’å¢</p>
<h3 id="25--æ•°ç»„å’ŒæŒ‡é’ˆçš„åŒºåˆ«ä¸è”ç³»">25 . æ•°ç»„å’ŒæŒ‡é’ˆçš„åŒºåˆ«ä¸è”ç³»</h3>
<p>(æ•°ç»„å’ŒæŒ‡é’ˆçš„åŒºåˆ«ä¸è”ç³»)[https://blog.csdn.net/cherrydreamsover/article/details/81741459]</p>
<h3 id="26--å‡½æ•°æŒ‡é’ˆæŒ‡é’ˆå‡½æ•°">26 . å‡½æ•°æŒ‡é’ˆ&amp;æŒ‡é’ˆå‡½æ•°</h3>
<p><a href="https://blog.csdn.net/baidu_37973494/article/details/83150266"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/baidu_37973494/article/details/83150266<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h3 id="27--constæ”¾åœ¨å‡½æ•°å‰åçš„åŒºåˆ«">27 . constæ”¾åœ¨å‡½æ•°å‰åçš„åŒºåˆ«</h3>
<p>1ã€int GetY() const;
2ã€const int * GetPosition();</p>
<p>å¯¹äº1
è¯¥å‡½æ•°ä¸ºåªè¯»å‡½æ•°ï¼Œä¸å…è®¸ä¿®æ”¹å…¶ä¸­çš„æ•°æ®æˆå‘˜çš„å€¼ã€‚</p>
<p>å¯¹äº2
ä¿®é¥°çš„æ˜¯è¿”å›å€¼ï¼Œè¡¨ç¤ºè¿”å›çš„æ˜¯æŒ‡é’ˆæ‰€æŒ‡å‘å€¼æ˜¯å¸¸é‡</p>
<h3 id="28--gotoè¯­å¥">28 . gotoè¯­å¥</h3>
<p>gotoè¯­å¥ä¹Ÿç§°ä¸ºæ— æ¡ä»¶è½¬ç§»è¯­å¥ï¼Œå…¶ä¸€èˆ¬æ ¼å¼å¦‚ä¸‹ï¼š goto è¯­å¥æ ‡å·ï¼› å…¶ä¸­è¯­å¥æ ‡å·æ˜¯æŒ‰æ ‡è¯†ç¬¦è§„å®šä¹¦å†™çš„ç¬¦å·ï¼Œ æ”¾åœ¨æŸä¸€è¯­å¥è¡Œçš„å‰é¢ï¼Œæ ‡å·ååŠ å†’å·(ï¼š)ã€‚è¯­å¥æ ‡å·èµ·æ ‡è¯†è¯­å¥çš„ä½œç”¨ï¼Œä¸goto è¯­å¥é…åˆä½¿ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">goto</span> <span class="n">label</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;This is the&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="29--externå…³é”®å­—">29 . externå…³é”®å­—</h3>
<p>1ã€externç”¨åœ¨å˜é‡æˆ–è€…å‡½æ•°çš„å£°æ˜å‰ï¼Œç”¨æ¥è¯´æ˜â€œæ­¤å˜é‡/å‡½æ•°æ˜¯åœ¨åˆ«å¤„å®šä¹‰çš„ï¼Œè¦åœ¨æ­¤å¤„å¼•ç”¨â€ã€‚externå£°æ˜ä¸æ˜¯å®šä¹‰ï¼Œå³ä¸åˆ†é…å­˜å‚¨ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å®šä¹‰äº†å˜é‡å’Œå‡½æ•°ï¼Œ åœ¨å…¶ä»–æ–‡ä»¶ä¸­è¦ä½¿ç”¨å®ƒä»¬ï¼Œ å¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼šä½¿ç”¨å¤´æ–‡ä»¶ï¼Œç„¶åå£°æ˜å®ƒä»¬ï¼Œç„¶åå…¶ä»–æ–‡ä»¶å»åŒ…å«å¤´æ–‡ä»¶ï¼›åœ¨å…¶ä»–æ–‡ä»¶ä¸­ç›´æ¥externã€‚</p>
<p>2ã€extern Cä½œç”¨</p>
<p>é“¾æ¥æŒ‡ç¤ºç¬¦extern C
å¦‚æœç¨‹åºå‘˜å¸Œæœ›è°ƒç”¨å…¶ä»–ç¨‹åºè®¾è®¡è¯­è¨€å°¤å…¶æ˜¯C å†™çš„å‡½æ•°ï¼Œé‚£ä¹ˆè°ƒç”¨å‡½æ•°æ—¶å¿…é¡»å‘Šè¯‰ç¼–è¯‘å™¨ä½¿ç”¨ä¸åŒçš„è¦æ±‚ï¼Œä¾‹å¦‚å½“è¿™æ ·çš„å‡½æ•°è¢«è°ƒç”¨æ—¶å‡½æ•°åæˆ–å‚æ•°æ’åˆ—çš„é¡ºåºå¯èƒ½ä¸åŒï¼Œæ— è®ºæ˜¯C++å‡½æ•°è°ƒç”¨å®ƒè¿˜æ˜¯ç”¨å…¶ä»–è¯­è¨€å†™çš„å‡½æ•°è°ƒç”¨å®ƒï¼Œç¨‹åºå‘˜ç”¨é“¾æ¥æŒ‡ç¤ºç¬¦å‘Šè¯‰ç¼–è¯‘å™¨è¯¥å‡½æ•°æ˜¯ç”¨å…¶ä»–çš„ç¨‹åºè®¾è®¡è¯­è¨€ç¼–å†™çš„ï¼Œé“¾æ¥æŒ‡ç¤ºç¬¦æœ‰ä¸¤ç§å½¢å¼æ—¢å¯ä»¥æ˜¯å•ä¸€è¯­å¥å½¢å¼ä¹Ÿå¯ä»¥æ˜¯å¤åˆè¯­å¥å½¢å¼ã€‚
// å•ä¸€è¯­å¥å½¢å¼çš„é“¾æ¥æŒ‡ç¤ºç¬¦
extern &ldquo;C&rdquo; void exit(int);
// å¤åˆè¯­å¥å½¢å¼çš„é“¾æ¥æŒ‡ç¤ºç¬¦
extern &ldquo;C&rdquo; {
int printf( const char* &hellip; );
int scanf( const char* &hellip; );
}
// å¤åˆè¯­å¥å½¢å¼çš„é“¾æ¥æŒ‡ç¤ºç¬¦
extern &ldquo;C&rdquo; {
#include <cmath>
}
é“¾æ¥æŒ‡ç¤ºç¬¦çš„ç¬¬ä¸€ç§å½¢å¼ç”±å…³é”®å­—extern åè·Ÿä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ä»¥åŠä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œå£°æ˜æ„æˆè™½ç„¶å‡½æ•°æ˜¯ç”¨å¦å¤–ä¸€ç§è¯­è¨€ç¼–å†™çš„ä½†è°ƒç”¨å®ƒä»ç„¶éœ€è¦ç±»å‹æ£€æŸ¥ä¾‹å¦‚ç¼–è¯‘å™¨ä¼šæ£€æŸ¥ä¼ é€’ç»™å‡½æ•°exit()çš„å®å‚çš„ç±»å‹æ˜¯å¦æ˜¯int æˆ–è€…èƒ½å¤Ÿéšå¼åœ°è½¬æ¢æˆint å‹ï¼Œå¤šä¸ªå‡½æ•°å£°æ˜å¯ä»¥ç”¨èŠ±æ‹¬å·åŒ…å«åœ¨é“¾æ¥æŒ‡ç¤ºç¬¦å¤åˆè¯­å¥ä¸­ï¼Œè¿™æ˜¯é“¾æ¥æŒ‡ç¤ºç¬¦çš„ç¬¬äºŒç§å½¢å¼èŠ±æ‰©å·è¢«ç”¨ä½œåˆ†å‰²ç¬¦è¡¨ç¤ºé“¾æ¥æŒ‡ç¤ºç¬¦åº”ç”¨åœ¨å“ªäº›å£°æ˜ä¸Šåœ¨å…¶ä»–æ„ä¹‰ä¸Šè¯¥èŠ±æ‹¬å·è¢«å¿½ç•¥ï¼Œæ‰€ä»¥åœ¨èŠ±æ‹¬å·ä¸­å£°æ˜çš„å‡½æ•°åå¯¹å¤–æ˜¯å¯è§çš„å°±å¥½åƒå‡½æ•°æ˜¯åœ¨å¤åˆè¯­å¥å¤–å£°æ˜çš„ä¸€æ ·ï¼Œä¾‹å¦‚åœ¨å‰é¢çš„ä¾‹å­ä¸­å¤åˆè¯­å¥extern &ldquo;C&quot;è¡¨ç¤ºå‡½æ•°printf()å’Œscanf()æ˜¯åœ¨C è¯­è¨€ä¸­å†™çš„ï¼Œå‡½æ•°å› æ­¤è¿™ä¸ªå£°æ˜çš„æ„ä¹‰å°±å¦‚åŒprintf()å’Œscanf()æ˜¯åœ¨extern &ldquo;C&quot;å¤åˆè¯­å¥å¤–é¢å£°æ˜çš„ä¸€æ ·ï¼Œå½“å¤åˆè¯­å¥é“¾æ¥æŒ‡ç¤ºç¬¦çš„æ‹¬å·ä¸­å«æœ‰#include æ—¶ï¼Œåœ¨å¤´æ–‡ä»¶ä¸­çš„å‡½æ•°å£°æ˜éƒ½è¢«å‡å®šæ˜¯ç”¨é“¾æ¥æŒ‡ç¤ºç¬¦çš„ç¨‹åºè®¾è®¡è¯­è¨€æ‰€å†™çš„ï¼Œåœ¨å‰é¢çš„ä¾‹å­ä¸­åœ¨å¤´æ–‡ä»¶<cmath>ä¸­å£°æ˜çš„å‡½æ•°éƒ½æ˜¯Cå‡½æ•°é“¾æ¥æŒ‡ç¤ºç¬¦ä¸èƒ½å‡ºç°åœ¨å‡½æ•°ä½“ä¸­ä¸‹åˆ—ä»£ç æ®µå°†ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</p>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="c1">// é”™è¯¯: é“¾æ¥æŒ‡ç¤ºç¬¦ä¸èƒ½å‡ºç°åœ¨å‡½æ•°å†…
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">extern</span> <span class="s">&#34;C&#34;</span> <span class="kt">double</span> <span class="n">sqrt</span><span class="p">(</span> <span class="kt">double</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="mi">305</span> <span class="err">ç¬¬ä¸ƒç« å‡½æ•°</span>
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="n">getValue</span><span class="p">();</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">double</span> <span class="n">result</span> <span class="o">=</span> <span class="n">sqrt</span> <span class="p">(</span> <span class="n">getValue</span><span class="p">()</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="err">å¦‚æœæŠŠé“¾æ¥æŒ‡ç¤ºç¬¦ç§»åˆ°å‡½æ•°ä½“å¤–ç¨‹åºç¼–è¯‘å°†æ— é”™è¯¯</span>
</span></span><span class="line"><span class="cl"><span class="k">extern</span> <span class="s">&#34;C&#34;</span> <span class="kt">double</span> <span class="n">sqrt</span><span class="p">(</span> <span class="kt">double</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="n">getValue</span><span class="p">();</span> <span class="c1">//ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">double</span> <span class="n">result</span> <span class="o">=</span> <span class="n">sqrt</span> <span class="p">(</span> <span class="n">getValue</span><span class="p">()</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="err">ä½†æ˜¯æŠŠé“¾æ¥æŒ‡ç¤ºç¬¦æ”¾åœ¨å¤´æ–‡ä»¶ä¸­æ›´åˆé€‚ï¼Œåœ¨é‚£é‡Œå‡½æ•°å£°æ˜æè¿°äº†å‡½æ•°çš„æ¥å£æ‰€å±ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›</span><span class="n">C</span><span class="o">++</span><span class="err">å‡½æ•°èƒ½å¤Ÿä¸º</span><span class="n">C</span> <span class="err">ç¨‹åºæ‰€ç”¨åˆè¯¥æ€ä¹ˆåŠå‘¢æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨</span><span class="k">extern</span> <span class="s">&#34;C&#34;</span><span class="err">é“¾æ¥æŒ‡ç¤ºç¬¦æ¥ä½¿</span><span class="n">C</span><span class="o">++</span><span class="err">å‡½æ•°ä¸º</span><span class="n">C</span> <span class="err">ç¨‹åºå¯ç”¨ä¾‹å¦‚ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="c1">// å‡½æ•°calc() å¯ä»¥è¢«C ç¨‹åºè°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">extern</span> <span class="s">&#34;C&#34;</span> <span class="kt">double</span> <span class="n">calc</span><span class="p">(</span> <span class="kt">double</span> <span class="n">dparm</span> <span class="p">)</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="err">å¦‚æœä¸€ä¸ªå‡½æ•°åœ¨åŒä¸€æ–‡ä»¶ä¸­ä¸åªè¢«å£°æ˜ä¸€æ¬¡åˆ™é“¾æ¥æŒ‡ç¤ºç¬¦å¯ä»¥å‡ºç°åœ¨æ¯ä¸ªå£°æ˜ä¸­å®ƒï¼Œä¹Ÿå¯ä»¥åªå‡ºç°åœ¨å‡½æ•°çš„ç¬¬ä¸€æ¬¡å£°æ˜ä¸­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ç¬¬äºŒä¸ªåŠä»¥åçš„å£°æ˜éƒ½æ¥å—ç¬¬ä¸€ä¸ªå£°æ˜ä¸­é“¾æ¥æŒ‡ç¤ºç¬¦æŒ‡å®šçš„é“¾æ¥è§„åˆ™ä¾‹å¦‚</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ---- myMath.h ----
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">extern</span> <span class="s">&#34;C&#34;</span> <span class="kt">double</span> <span class="n">calc</span><span class="p">(</span> <span class="kt">double</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// ---- myMath.C ----
</span></span></span><span class="line"><span class="cl"><span class="c1">// åœ¨Math.h ä¸­çš„calc() çš„å£°æ˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#include</span> <span class="cpf">&#34;myMath.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">// å®šä¹‰äº†extern &#34;C&#34; calc() å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1">// calc() å¯ä»¥ä»C ç¨‹åºä¸­è¢«è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">double</span> <span class="nf">calc</span><span class="p">(</span> <span class="kt">double</span> <span class="n">dparm</span> <span class="p">)</span> <span class="p">{</span> <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="err">åœ¨æœ¬èŠ‚ä¸­æˆ‘ä»¬åªçœ‹åˆ°ä¸º</span><span class="n">C</span> <span class="err">è¯­è¨€æä¾›çš„é“¾æ¥æŒ‡ç¤º</span><span class="k">extern</span> <span class="s">&#34;C&#34;</span><span class="err">ï¼Œ</span><span class="k">extern</span> <span class="s">&#34;C&#34;</span><span class="err">æ˜¯æƒŸä¸€è¢«ä¿è¯ç”±æ‰€æœ‰</span><span class="n">C</span><span class="o">++</span><span class="err">å®ç°éƒ½æ”¯æŒçš„ï¼Œæ¯ä¸ªç¼–è¯‘å™¨å®ç°éƒ½å¯ä»¥ä¸ºå…¶ç¯å¢ƒä¸‹å¸¸ç”¨çš„è¯­è¨€æä¾›å…¶ä»–é“¾æ¥æŒ‡ç¤ºä¾‹å¦‚</span><span class="k">extern</span> <span class="s">&#34;Ada&#34;</span><span class="err">å¯ä»¥ç”¨æ¥å£°æ˜æ˜¯ç”¨</span><span class="n">Ada</span> <span class="err">è¯­è¨€å†™çš„å‡½æ•°ï¼Œ</span><span class="k">extern</span> <span class="s">&#34;FORTRAN&#34;</span><span class="err">ç”¨æ¥å£°æ˜æ˜¯ç”¨</span><span class="n">FORTRAN</span> <span class="err">è¯­è¨€å†™çš„å‡½æ•°ï¼Œç­‰ç­‰å› ä¸ºå…¶ä»–çš„é“¾æ¥æŒ‡ç¤ºéšç€å…·ä½“å®ç°çš„ä¸åŒè€Œä¸åŒæ‰€ä»¥å»ºè®®è¯»è€…æŸ¥çœ‹ç¼–è¯‘å™¨çš„ç”¨æˆ·æŒ‡å—ä»¥è·å¾—å…¶ä»–é“¾æ¥æŒ‡ç¤ºç¬¦çš„è¿›ä¸€æ­¥ä¿¡æ¯ã€‚</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ€»ç»“ extern â€œCâ€
extern â€œCâ€ ä¸ä½†å…·æœ‰ä¼ ç»Ÿçš„å£°æ˜å¤–éƒ¨å˜é‡çš„åŠŸèƒ½ï¼Œè¿˜å…·æœ‰å‘ŠçŸ¥C++é“¾æ¥å™¨ä½¿ç”¨Cå‡½æ•°è§„èŒƒæ¥é“¾æ¥çš„åŠŸèƒ½ã€‚ è¿˜å…·æœ‰å‘ŠçŸ¥C++ç¼–è¯‘å™¨ä½¿ç”¨Cè§„èŒƒæ¥å‘½åçš„åŠŸèƒ½ã€‚</p>
<h3 id="30--åŠ¨æ€å†…å­˜ç®¡ç†">30 . åŠ¨æ€å†…å­˜ç®¡ç†</h3>
<p>(åŠ¨æ€å†…å­˜ç®¡ç†)[https://blog.csdn.net/zgege/article/details/82054076]</p>
<h3 id="31-æ•°ç»„é“¾è¡¨å“ˆå¸Œé˜Ÿåˆ—æ ˆæ•°æ®ç»“æ„ç‰¹ç‚¹å„è‡ªä¼˜ç‚¹å’Œç¼ºç‚¹">31 .æ•°ç»„ã€é“¾è¡¨ã€å“ˆå¸Œã€é˜Ÿåˆ—ã€æ ˆæ•°æ®ç»“æ„ç‰¹ç‚¹ï¼Œå„è‡ªä¼˜ç‚¹å’Œç¼ºç‚¹</h3>
<p>æ•°ç»„(Array)ï¼š
ä¼˜ç‚¹ï¼šæŸ¥è¯¢å¿«ï¼Œé€šè¿‡ç´¢å¼•ç›´æ¥æŸ¥æ‰¾ï¼›æœ‰åºæ·»åŠ ï¼Œæ·»åŠ é€Ÿåº¦å¿«ï¼Œå…è®¸é‡å¤ï¼›
ç¼ºç‚¹ï¼šåœ¨ä¸­é—´éƒ¨ä½æ·»åŠ ã€åˆ é™¤æ¯”è¾ƒå¤æ‚ï¼Œå¤§å°å›ºå®šï¼Œåªèƒ½å­˜å‚¨ä¸€ç§ç±»å‹çš„æ•°æ®ï¼›
å¦‚æœåº”ç”¨éœ€è¦å¿«é€Ÿè®¿é—®æ•°æ®ï¼Œå¾ˆå°‘æ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œå°±åº”è¯¥ç”¨æ•°ç»„ã€‚</p>
<p>é“¾è¡¨(LinkedList)ï¼š
ä¼˜ç‚¹ï¼šæœ‰åºæ·»åŠ ã€å¢åˆ æ”¹é€Ÿåº¦å¿«ï¼Œå¯¹äºé“¾è¡¨æ•°æ®ç»“æ„ï¼Œå¢åŠ å’Œåˆ é™¤åªè¦ä¿®æ”¹å…ƒç´ ä¸­çš„æŒ‡é’ˆå°±å¯ä»¥äº†ï¼›
ç¼ºç‚¹ï¼šæŸ¥è¯¢æ…¢ï¼Œå¦‚æœè¦è®¿é—®é“¾è¡¨ä¸­ä¸€ä¸ªå…ƒç´ ï¼Œå°±éœ€è¦ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹æŸ¥æ‰¾ï¼›
å¦‚æœåº”ç”¨éœ€è¦ç»å¸¸æ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œå°±åº”è¯¥ç”¨é“¾è¡¨ã€‚</p>
<p>æ ˆ(Stack)ï¼š
ä¼˜ç‚¹ï¼šæä¾›åè¿›å…ˆå‡ºçš„å­˜å‚¨æ–¹å¼ï¼Œæ·»åŠ é€Ÿåº¦å¿«ï¼Œå…è®¸é‡å¤ï¼›
ç¼ºç‚¹ï¼šåªèƒ½åœ¨ä¸€å¤´æ“ä½œæ•°æ®ï¼Œå­˜å–å…¶ä»–é¡¹å¾ˆæ…¢ï¼›</p>
<p>é˜Ÿåˆ—(Queue)ï¼š
ä¼˜ç‚¹ï¼šæä¾›å…ˆè¿›å…ˆå‡ºçš„å­˜å‚¨æ–¹å¼ï¼Œæ·»åŠ é€Ÿåº¦å¿«ï¼Œå…è®¸é‡å¤ï¼›
ç¼ºç‚¹ï¼šåªèƒ½åœ¨ä¸€å¤´æ·»åŠ ï¼Œå¦ä¸€å¤´è·å–ï¼Œå­˜å–å…¶ä»–é¡¹å¾ˆæ…¢ï¼›</p>
<p>å“ˆå¸Œ(Hash)ï¼š
ç‰¹ç‚¹ï¼šæ•£åˆ—è¡¨ï¼Œä¸å…è®¸é‡å¤ï¼›
ä¼˜ç‚¹ï¼šå¦‚æœå…³é”®å­—å·²çŸ¥åˆ™å­˜å–é€Ÿåº¦æå¿«ï¼›
ç¼ºç‚¹ï¼šå¦‚æœä¸çŸ¥é“å…³é”®å­—åˆ™å­˜å–å¾ˆæ…¢ï¼Œå¯¹å­˜å‚¨ç©ºé—´ä½¿ç”¨ä¸å……åˆ†ï¼›</p>
<h3 id="32-å‹å…ƒå‡½æ•°">32. å‹å…ƒå‡½æ•°</h3>
<pre><code>å¼•å…¥å‹å…ƒå‡½æ•°çš„åŸå› 
    ç±»å…·æœ‰å°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€ä¿¡æ¯éšè—çš„ç‰¹æ€§ï¼Œåªæœ‰ç±»çš„æˆå‘˜å‡½æ•°æ‰å¯ä»¥è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜ï¼Œéæˆå‘˜å‡½æ•°åªèƒ½è®¿é—®ç±»çš„å…¬æœ‰æˆå‘˜ã€‚ä¸ºäº†ä½¿ç±»çš„éæˆå‘˜å‡½æ•°è®¿é—®ç±»çš„æˆå‘˜ï¼Œå”¯ä¸€çš„åšæ³•å°±æ˜¯å°†æˆå‘˜å®šä¹‰ä¸ºpublicï¼Œä½†è¿™æ ·åšä¼šç ´åä¿¡æ¯éšè—çš„ç‰¹æ€§ã€‚åŸºäºä»¥ä¸ŠåŸå› ï¼Œå¼•å…¥å‹å…ƒå‡½æ•°è§£å†³ã€‚
</code></pre>
<p>(å‹å…ƒå‡½æ•°)[https://blog.csdn.net/qq_26337701/article/details/53996104]</p>
<h3 id="33-è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼å·¥å‚æ¨¡å¼å‘å¸ƒè®¢é˜…æ¨¡å¼ä»¥åŠè§‚å¯Ÿè€…æ¨¡å¼">33. è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€å‘å¸ƒè®¢é˜…æ¨¡å¼ä»¥åŠè§‚å¯Ÿè€…æ¨¡å¼</h3>
<p>(è®¾è®¡æ¨¡å¼)[https://blog.csdn.net/m0_37322399/article/details/108515158]</p>
<h3 id="34-æ„é€ å‡½æ•°">34. æ„é€ å‡½æ•°ï¼š</h3>
<blockquote>
<p>ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ</p>
</blockquote>
<p>é€šä¿—çš„è®²ï¼Œåœ¨ç±»ä¸­ï¼Œå‡½æ•°åå’Œç±»åç›¸åŒçš„å‡½æ•°ç§°ä¸ºæ„é€ å‡½æ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯åœ¨å»ºç«‹ä¸€ä¸ªå¯¹è±¡æ—¶ï¼ŒåšæŸäº›åˆå§‹åŒ–çš„å·¥ä½œï¼ˆä¾‹å¦‚å¯¹æ•°æ®èµ‹äºˆåˆå€¼ï¼‰ã€‚C++å…è®¸åŒåå‡½æ•°ï¼Œä¹Ÿå°±å…è®¸åœ¨ä¸€ä¸ªç±»ä¸­æœ‰å¤šä¸ªæ„é€ å‡½æ•°ã€‚å¦‚æœä¸€ä¸ªéƒ½æ²¡æœ‰ï¼Œç¼–è¯‘å™¨å°†ä¸ºè¯¥ç±»äº§ç”Ÿä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°ã€‚</p>
<p>æ„é€ å‡½æ•°ä¸ŠæƒŸä¸€çš„è¯­æ³•é™åˆ¶æ˜¯å®ƒä¸èƒ½æŒ‡å®šè¿”å›ç±»å‹ï¼Œç”šè‡³void ä¹Ÿä¸è¡Œã€‚</p>
<p>ä¸å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼šä¸€èˆ¬å½¢å¼ä¸º ç±»å å¯¹è±¡å(){å‡½æ•°ä½“}</p>
<p>å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼šä¸å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œåªèƒ½ä»¥å›ºå®šä¸å˜çš„å€¼åˆå§‹åŒ–å¯¹è±¡ã€‚å¸¦å‚æ•°æ„é€ å‡½æ•°çš„åˆå§‹åŒ–è¦çµæ´»çš„å¤šï¼Œé€šè¿‡ä¼ é€’ç»™æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œå¯ä»¥èµ‹äºˆå¯¹è±¡ä¸åŒçš„åˆå§‹å€¼ã€‚ä¸€èˆ¬å½¢å¼ä¸ºï¼šæ„é€ å‡½æ•°åï¼ˆå½¢å‚è¡¨ï¼‰ï¼›</p>
<p>åˆ›å»ºå¯¹è±¡ä½¿ç”¨æ—¶ï¼šç±»å å¯¹è±¡åï¼ˆå®å‚è¡¨ï¼‰ï¼›</p>
<p>æ„é€ å‡½æ•°å‚æ•°çš„åˆå§‹å€¼ï¼šæ„é€ å‡½æ•°çš„å‚æ•°å¯ä»¥æœ‰ç¼ºçœå€¼ã€‚å½“å®šä¹‰å¯¹è±¡æ—¶ï¼Œå¦‚æœä¸ç»™å‡ºå‚æ•°ï¼Œå°±è‡ªåŠ¨æŠŠç›¸åº”çš„ç¼ºçœå‚æ•°å€¼èµ‹ç»™å¯¹è±¡ã€‚ä¸€èˆ¬å½¢å¼ä¸ºï¼š
æ„é€ å‡½æ•°åï¼ˆå‚æ•°=ç¼ºçœå€¼ï¼Œå‚æ•°=ç¼ºçœå€¼ï¼Œâ€¦â€¦ï¼‰;
ææ„å‡½æ•°ï¼š</p>
<p>å½“ä¸€ä¸ªç±»çš„å¯¹è±¡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œææ„å‡½æ•°å°†è¢«è°ƒç”¨(ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨)ã€‚ææ„å‡½æ•°çš„åå­—å’Œç±»åä¸€æ ·ï¼Œä¸è¿‡è¦åœ¨å‰é¢åŠ ä¸Š ~ ã€‚å¯¹ä¸€ä¸ªç±»æ¥è¯´ï¼Œåªèƒ½å…è®¸ä¸€ä¸ªææ„å‡½æ•°ï¼Œææ„å‡½æ•°ä¸èƒ½æœ‰å‚æ•°ï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰è¿”å›å€¼ã€‚ææ„å‡½æ•°çš„ä½œç”¨æ˜¯å®Œæˆä¸€ä¸ªæ¸…ç†å·¥ä½œï¼Œå¦‚é‡Šæ”¾ä»å †ä¸­åˆ†é…çš„å†…å­˜ã€‚</p>
<p>ä¸€ä¸ªç±»ä¸­å¯ä»¥æœ‰å¤šä¸ªæ„é€ å‡½æ•°ï¼Œä½†ææ„å‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªã€‚å¯¹è±¡è¢«ææ„çš„é¡ºåºï¼Œä¸å…¶å»ºç«‹æ—¶çš„é¡ºåºç›¸åï¼Œå³åæ„é€ çš„å¯¹è±¡å…ˆææ„ã€‚
1ã€æ¦‚å¿µä¸åŒï¼š</p>
<p>ææ„å‡½æ•°ï¼šå¯¹è±¡æ‰€åœ¨çš„å‡½æ•°å·²è°ƒç”¨å®Œæ¯•æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œææ„å‡½æ•°ã€‚</p>
<p>æ„é€ å‡½æ•°ï¼šæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ã€‚ç‰¹åˆ«çš„ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªæ„é€ å‡½æ•° ï¼Œå¯æ ¹æ®å…¶å‚æ•°ä¸ªæ•°çš„ä¸åŒæˆ–å‚æ•°ç±»å‹çš„ä¸åŒæ¥åŒºåˆ†å®ƒä»¬ å³æ„é€ å‡½æ•°çš„é‡è½½ã€‚
2ã€ä½œç”¨ä¸åŒï¼š</p>
<p>ææ„å‡½æ•°ï¼šææ„å‡½æ•°è¢«è°ƒç”¨ã€‚</p>
<hr>
<p>æ„é€ å‡½æ•°ï¼šä¸ºå¯¹è±¡æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼
3ã€ç›®çš„ä¸åŒï¼š</p>
<p>ææ„å‡½æ•°ï¼šâ€æ¸…ç†å–„åâ€ çš„å·¥ä½œ</p>
<p>æ„é€ å‡½æ•°ï¼šä¸»è¦ç”¨æ¥åœ¨åˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–å¯¹è±¡ï¼Œ å³ä¸ºå¯¹è±¡æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼ï¼Œæ€»ä¸newè¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨åœ¨åˆ›å»ºå¯¹è±¡çš„è¯­å¥ä¸­ã€‚</p>
<h3 id="35-cæ¨¡æ¿">35. C++æ¨¡æ¿</h3>
<p><a href="https://blog.csdn.net/zhaizhaizhaiaaa/article/details/104091658"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/zhaizhaizhaiaaa/article/details/104091658<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h3 id="36-c-stl">36. C++ STL</h3>
<p><a href="https://www.cnblogs.com/shiyangxt/archive/2008/09/11/1289493.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.cnblogs.com/shiyangxt/archive/2008/09/11/1289493.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>ref: <a href="https://blog.csdn.net/qq_52621551/article/details/122960158"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq_52621551/article/details/122960158<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h2 id="c-å…«è‚¡æ–‡">c++ å…«è‚¡æ–‡</h2>
<h3 id="å…³é”®å­—ä¸è¿ç®—ç¬¦">å…³é”®å­—ä¸è¿ç®—ç¬¦</h3>
<h4 id="1-æŒ‡é’ˆä¸å¼•">1. æŒ‡é’ˆä¸å¼•â½¤</h4>
<p>æŒ‡é’ˆï¼šå­˜æ”¾æŸä¸ªå¯¹è±¡çš„åœ°å€ï¼Œå…¶æœ¬â¾å°±æ˜¯å˜é‡ï¼ˆå‘½äº†åçš„å¯¹è±¡ï¼‰ï¼Œæœ¬â¾å°±æœ‰åœ°å€ï¼Œæ‰€ä»¥å¯ä»¥æœ‰æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼›å¯å˜ï¼ŒåŒ…æ‹¬å…¶æ‰€æŒ‡å‘çš„åœ°å€çš„æ”¹å˜å’Œå…¶æŒ‡å‘çš„åœ°å€ä¸­æ‰€å­˜æ”¾çš„æ•°æ®çš„æ”¹å˜ (åœ°å€å¯å˜ï¼Œåœ°å€å­˜å‚¨çš„å€¼ä¹Ÿå¯å˜)</p>
<p>å¼•â½¤ï¼šå°±æ˜¯å˜é‡çš„åˆ«åï¼Œä»â¼€â½½ç»ˆï¼Œä¸å¯å˜ï¼Œå¿…é¡»åˆå§‹åŒ–ï¼Œ ä¸å­˜åœ¨æŒ‡å‘ç©ºå€¼çš„å¼•â½¤ï¼Œä½†æ˜¯å­˜åœ¨æŒ‡å‘ç©ºå€¼çš„æŒ‡é’ˆ</p>
<h4 id="2-const-å…³é”®å­—">2. const å…³é”®å­—</h4>
<p>constçš„ä½œâ½¤ï¼šè¢«å®ƒä¿®é¥°çš„å€¼ä¸èƒ½æ”¹å˜ï¼Œæ˜¯åªè¯»å˜é‡ã€‚å¿…é¡»åœ¨å®šä¹‰çš„æ—¶å€™å°±ç»™å®ƒèµ‹åˆå€¼ã€‚</p>
<p>é¡¶å±‚const: è¡¨ç¤ºæŒ‡é’ˆæœ¬èº«æ˜¯ä¸ªå¸¸é‡
åº•å±‚const: è¡¨ç¤ºæŒ‡é’ˆæ‰€æŒ‡çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå¸¸é‡</p>
<p>2.1 å¸¸é‡æŒ‡é’ˆï¼ˆ<strong>åº•å±‚const</strong>ï¼‰ï¼ˆ<strong>æŒ‡é’ˆæŒ‡çš„å¯¹è±¡</strong>ä¸å¯æ”¹å˜ï¼‰</p>
<p>å¸¸é‡æŒ‡é’ˆï¼šæ˜¯æŒ‡å®šä¹‰äº†â¼€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘â¼€ä¸ªåªè¯»çš„å¯¹è±¡ï¼Œä¸èƒ½é€šè¿‡å¸¸é‡æŒ‡é’ˆæ¥æ”¹å˜è¿™ä¸ªå¯¹è±¡çš„å€¼ã€‚å¸¸é‡æŒ‡é’ˆå¼ºè°ƒçš„æ˜¯æŒ‡é’ˆå¯¹å…¶æ‰€æŒ‡å¯¹è±¡çš„ä¸å¯æ”¹å˜æ€§ã€‚
ç‰¹ç‚¹ï¼šé è¿‘å˜é‡å
å½¢å¼:</p>
<ul>
<li>const æ•°æ®ç±»å‹ *æŒ‡é’ˆå˜é‡ = å˜é‡å</li>
<li>æ•°æ®ç±»å‹ const *æŒ‡é’ˆå˜é‡ = å˜é‡å</li>
<li>ä¸¾ä¾‹:
<ul>
<li>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  int temp = 10;
</span></span><span class="line"><span class="cl">  const int* a = &amp;temp;
</span></span><span class="line"><span class="cl">  int const *a = &amp;temp;</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<p>2.2 æŒ‡é’ˆå¸¸é‡ï¼ˆ<strong>é¡¶å±‚const</strong>ï¼‰(<strong>æŒ‡é’ˆ</strong>ä¸èƒ½æ”¹å˜)
æŒ‡é’ˆå¸¸é‡ï¼šæŒ‡é’ˆå¸¸é‡æ˜¯æŒ‡å®šä¹‰äº†â¼€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆçš„å€¼åªèƒ½åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œå…¶ä»–åœ°â½…ä¸èƒ½æ”¹å˜ã€‚æŒ‡é’ˆå¸¸é‡å¼ºè°ƒçš„æ˜¯æŒ‡é’ˆçš„ä¸å¯æ”¹å˜æ€§ã€‚
ç‰¹ç‚¹: é è¿‘å˜é‡ç±»å‹
å½¢å¼: æ•°æ®ç±»å‹ * const æŒ‡é’ˆå˜é‡=å˜é‡å</p>
<ul>
<li>å®ä¾‹:
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span> <span class="k">const</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">temp</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="3-define-å’Œ-typedefçš„åŒºåˆ«">3. define å’Œ typedefçš„åŒºåˆ«</h4>
<p>ref : <a href="https://blog.csdn.net/CSSDCC/article/details/122049204"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/CSSDCC/article/details/122049204<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>
ref : <a href="https://zhuanlan.zhihu.com/p/513450251"target="_blank" rel="external nofollow noopener noreferrer">https://zhuanlan.zhihu.com/p/513450251<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>]]></description></item><item><title>C++ åŸºç¡€çŸ¥è¯†[ä¸€]</title><link>https://jianye0428.github.io/posts/basics_one/</link><pubDate>Tue, 11 Jul 2023 19:37:05 +0800</pubDate><author>Jian YE</author><guid>https://jianye0428.github.io/posts/basics_one/</guid><description><![CDATA[<div class="details admonition quote">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>quote<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">c++ å…«è‚¡æ–‡ ç¬¬ä¸€éƒ¨åˆ†</div>
    </div>
  </div>
<h2 id="1-åŸºç¡€çŸ¥è¯†ä¸€">1. åŸºç¡€çŸ¥è¯†ï¼ˆä¸€ï¼‰</h2>
<h3 id="11-cè¯­è¨€çš„ç‰¹ç‚¹">1.1 C++è¯­è¨€çš„ç‰¹ç‚¹</h3>
<blockquote>
<p>â‘ C++åœ¨Cçš„åŸºç¡€ä¸Šå¼•å…¥äº†<u><font color=red><strong>é¢å‘å¯¹è±¡</strong></font></u>æœºåˆ¶ï¼ŒåŒæ—¶ä¹Ÿå…¼å®¹Cè¯­è¨€ï¼›</br>
â‘¡C++ä¸‰å¤§ç‰¹æ€§ï¼š<font color=red><em>å°è£…</em>ã€<em>ç»§æ‰¿</em>ã€<em>å¤šæ€</em></font>ï¼›</br>
â‘¢C++ç¨‹åºç»“æ„æ¸…æ™°ã€æ˜“äºæ‰©å……ã€ç¨‹åºå¯è¯»æ€§å¥½ï¼›</br>
â‘£C++ä»£ç è´¨é‡é«˜ï¼Œ<strong>è¿è¡Œæ•ˆç‡é«˜</strong>ã€ä»…æ¯”æ±‡ç¼–è¯­è¨€æ…¢10%~20%ï¼›</br>
â‘¥C++<strong>å¯å¤ç”¨æ€§é«˜</strong>ï¼ŒC++å¼•å…¥äº†æ¨¡æ¿çš„æ¦‚å¿µï¼Œæœ‰ä¸“é—¨çš„æ¨¡æ¿åº“(STL)ï¼›</br>
â‘¦C++æ˜¯ä¸æ–­å‘å±•çš„è¯­è¨€ï¼ŒC++11ä¸­æ–°å¼•å…¥äº†nullptrã€autoå˜é‡ã€LambdaåŒ¿åå‡½æ•°ã€å³å€¼å¼•ç”¨ã€æ™ºèƒ½æŒ‡é’ˆã€‚</br></p>
</blockquote>
<p><strong>C++é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹å¾</strong></p>
<blockquote>
<p><font color=red><strong>å°è£…æ€§ï¼š</strong></font> å°†å®¢è§‚äº‹ç‰©æŠ½è±¡æˆç±»ï¼Œæ¯ä¸ªç±»å¯¹è‡ªèº«çš„<u>æ•°æ®</u>å’Œ<u>æ–¹æ³•</u>å®è¡Œè®¿é—®æ§åˆ¶ï¼ŒåŒ…æ‹¬ï¼ˆprivateï¼Œprotectedï¼Œpublicï¼‰ã€‚</br>
<font color=red><strong>ç»§æ‰¿æ€§ï¼š</strong></font> å¹¿ä¹‰çš„ç»§æ‰¿æœ‰ä¸‰ç§å®ç°å½¢å¼ï¼š<u>å®ç°ç»§æ‰¿</u>ï¼ˆä½¿ç”¨åŸºç±»çš„å±æ€§å’Œæ–¹æ³•è€Œæ— éœ€é¢å¤–ç¼–ç çš„èƒ½åŠ›)ã€<u>å¯è§†ç»§æ‰¿</u>(å­çª—ä½“ä½¿ç”¨çˆ¶çª—ä½“çš„å¤–è§‚å’Œå®ç°ä»£ç )ã€<u>æ¥å£ç»§æ‰¿</u>(ä»…ä½¿ç”¨å±æ€§å’Œæ–¹æ³•ï¼Œå®ç°æ»ååˆ°å­ç±»å®ç°)ã€‚</br>
<font color=red><strong>å¤šæ€æ€§ï¼š</strong></font> æ˜¯å°†çˆ¶ç±»å¯¹è±¡è®¾ç½®æˆä¸ºå’Œä¸€ä¸ªæˆ–æ›´å¤šå®ƒçš„å­å¯¹è±¡ç›¸ç­‰çš„æŠ€æœ¯ã€‚ç”¨å­ç±»å¯¹è±¡ç»™çˆ¶ç±»å¯¹è±¡èµ‹å€¼ä¹‹åï¼Œçˆ¶ç±»å¯¹è±¡å°±å¯ä»¥æ ¹æ®å½“å‰èµ‹å€¼ç»™å®ƒçš„å­å¯¹è±¡çš„ç‰¹æ€§ä»¥ä¸åŒçš„æ–¹å¼è¿ä½œã€‚</br></p>
</blockquote>
<h3 id="12-cå’Œcè¯­è¨€çš„åŒºåˆ«">1.2 C++å’ŒCè¯­è¨€çš„åŒºåˆ«</h3>
<blockquote>
<p>â‘  Cè¯­è¨€æ˜¯C++çš„å­é›†ï¼ŒC++å¯ä»¥å¾ˆå¥½<strong>å…¼å®¹Cè¯­è¨€</strong>ã€‚ä½†æ˜¯C++åˆæœ‰å¾ˆå¤šæ–°ç‰¹æ€§ï¼Œå¦‚å¼•ç”¨ã€æ™ºèƒ½æŒ‡é’ˆã€autoå˜é‡ç­‰ï¼›</br>
â‘¡ C++æ˜¯é¢å¯¹<strong>å¯¹è±¡</strong>(object-oriented)çš„ç¼–ç¨‹è¯­è¨€ï¼›Cè¯­è¨€æ˜¯é¢å¯¹<strong>è¿‡ç¨‹</strong>(process-oriented)çš„ç¼–ç¨‹è¯­è¨€ï¼›</br>
â‘¢ Cè¯­è¨€æœ‰ä¸€äº›ä¸å®‰å…¨çš„è¯­è¨€ç‰¹æ€§ï¼Œå¦‚æŒ‡é’ˆä½¿ç”¨çš„æ½œåœ¨å±é™©ã€å¼ºåˆ¶è½¬æ¢çš„ä¸ç¡®å®šæ€§ã€å†…å­˜æ³„éœ²ç­‰ã€‚è€ŒC++å¯¹æ­¤å¢åŠ äº†ä¸å°‘æ–°ç‰¹æ€§æ¥æ”¹å–„å®‰å…¨æ€§ï¼Œå¦‚constå¸¸é‡ã€å¼•ç”¨ã€castè½¬æ¢ã€æ™ºèƒ½æŒ‡é’ˆã€tryâ€”catchç­‰ç­‰ï¼›</br>
â‘£ C++å¯å¤ç”¨æ€§é«˜ï¼ŒC++å¼•å…¥äº†æ¨¡æ¿çš„æ¦‚å¿µï¼Œåé¢åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå®ç°äº†æ–¹ä¾¿å¼€å‘çš„æ ‡å‡†æ¨¡æ¿åº“STLã€‚C++çš„STLåº“ç›¸å¯¹äºCè¯­è¨€çš„å‡½æ•°åº“æ›´çµæ´»ã€æ›´é€šç”¨ã€‚</br></p>
</blockquote>
<h3 id="13-cä¸­-struct-å’Œ-class-çš„åŒºåˆ«">1.3 C++ä¸­ struct å’Œ class çš„åŒºåˆ«</h3>
<blockquote>
<p>â‘  struct ä¸€èˆ¬ç”¨äºæè¿°ä¸€ä¸ªæ•°æ®ç»“æ„é›†åˆï¼Œè€Œ class æ˜¯å¯¹ä¸€ä¸ªå¯¹è±¡æ•°æ®çš„<strong>å°è£…</strong>ï¼›</br>
â‘¡ struct ä¸­é»˜è®¤çš„è®¿é—®æ§åˆ¶æƒé™æ˜¯ public çš„ï¼Œè€Œ class ä¸­é»˜è®¤çš„è®¿é—®æ§åˆ¶æƒé™æ˜¯ private çš„ï¼›</br>
â‘¢ åœ¨<u>ç»§æ‰¿å…³ç³»</u>ä¸­ï¼Œstruct é»˜è®¤æ˜¯å…¬æœ‰ç»§æ‰¿ï¼Œè€Œ class æ˜¯ç§æœ‰ç»§æ‰¿ï¼›</br>
â‘£ classå…³é”®å­—å¯ä»¥ç”¨äºå®šä¹‰æ¨¡æ¿å‚æ•°ï¼Œå°±åƒtypenameï¼Œè€Œ struct ä¸èƒ½ç”¨äºå®šä¹‰æ¨¡æ¿å‚æ•°ã€‚</br></p>
</blockquote>
<h3 id="14-includeå¤´æ–‡ä»¶çš„é¡ºåºä»¥åŠåŒå¼•å·å’Œå°–æ‹¬å·çš„åŒºåˆ«">1.4 includeå¤´æ–‡ä»¶çš„é¡ºåºä»¥åŠåŒå¼•å·&quot;&ldquo;å’Œå°–æ‹¬å·&lt;&gt;çš„åŒºåˆ«</h3>
<blockquote>
<p>åŒºåˆ«ï¼š</br>
â‘  å°–æ‹¬å·<code>&lt; &gt;</code>çš„å¤´æ–‡ä»¶æ˜¯<font color=red>ç³»ç»Ÿæ–‡ä»¶</font>ï¼ŒåŒå¼•å·<code>&quot; &quot;</code>çš„å¤´æ–‡ä»¶æ˜¯è‡ªå®šä¹‰æ–‡ä»¶ï¼›</br>
â‘¡ ç¼–è¯‘å™¨é¢„å¤„ç†é˜¶æ®µæŸ¥æ‰¾å¤´æ–‡ä»¶çš„è·¯å¾„ä¸ä¸€æ ·ï¼›</br>
æŸ¥æ‰¾è·¯å¾„ï¼š</br>
â‘  ä½¿ç”¨å°–æ‹¬å·<code>&lt;  &gt;</code>(ç³»ç»Ÿæ–‡ä»¶)çš„å¤´æ–‡ä»¶çš„æŸ¥æ‰¾è·¯å¾„ï¼šç¼–è¯‘å™¨è®¾ç½®çš„å¤´æ–‡ä»¶è·¯å¾„â€“&gt;ç³»ç»Ÿå˜é‡;</br>
â‘¡ ä½¿ç”¨åŒå¼•å·<code>&quot;  &quot;</code>(è‡ªå®šä¹‰æ–‡ä»¶)çš„å¤´æ–‡ä»¶çš„æŸ¥æ‰¾è·¯å¾„ï¼šå½“å‰å¤´æ–‡ä»¶ç›®å½•â€“&gt;ç¼–è¯‘å™¨è®¾ç½®çš„å¤´æ–‡ä»¶è·¯å¾„â€“&gt;ç³»ç»Ÿå˜é‡ã€‚</br></p>
</blockquote>
<h3 id="15-cç»“æ„ä½“å’Œcç»“æ„ä½“çš„åŒºåˆ«">1.5 C++ç»“æ„ä½“å’ŒCç»“æ„ä½“çš„åŒºåˆ«</h3>
<blockquote>
<p>â‘ Cçš„ç»“æ„ä½“å†…ä¸å…è®¸æœ‰å‡½æ•°å­˜åœ¨ï¼ŒC++å…è®¸æœ‰å†…éƒ¨æˆå‘˜å‡½æ•°ï¼Œä¸”å…è®¸è¯¥å‡½æ•°æ˜¯è™šå‡½æ•°ï¼›</br>
â‘¡Cçš„ç»“æ„ä½“å¯¹å†…éƒ¨æˆå‘˜å˜é‡çš„è®¿é—®æƒé™<strong>åªèƒ½æ˜¯public</strong>ï¼Œè€ŒC++å…è®¸publicï¼Œprotectedï¼Œprivateä¸‰ç§ï¼›</br>
â‘¢C ä¸­ä½¿ç”¨ç»“æ„ä½“éœ€è¦åŠ ä¸Š struct å…³é”®å­—ï¼Œæˆ–è€…å¯¹ç»“æ„ä½“ä½¿ç”¨ typedef å–åˆ«åï¼Œè€Œ C++ ä¸­å¯ä»¥çœç•¥ struct å…³é”®å­—ç›´æ¥ä½¿ç”¨ï¼›</br>
â‘£Cè¯­è¨€çš„ç»“æ„ä½“æ˜¯<strong>ä¸å¯ä»¥ç»§æ‰¿çš„</strong>ï¼ŒC++çš„ç»“æ„ä½“æ˜¯å¯ä»¥ä»å…¶ä»–çš„ç»“æ„ä½“æˆ–è€…ç±»ç»§æ‰¿è¿‡æ¥çš„ã€‚</br></p>
</blockquote>
<h3 id="16-å¯¼å…¥cå‡½æ•°çš„å…³é”®å­—æ˜¯ä»€ä¹ˆcç¼–è¯‘æ—¶å’Œcæœ‰ä»€ä¹ˆä¸åŒ">1.6 å¯¼å…¥Cå‡½æ•°çš„å…³é”®å­—æ˜¯ä»€ä¹ˆï¼ŒC++ç¼–è¯‘æ—¶å’ŒCæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h3>
<blockquote>
<p><strong>å…³é”®å­—ï¼š</strong> åœ¨C++ä¸­ï¼Œå¯¼å…¥Cå‡½æ•°çš„å…³é”®å­—æ˜¯externï¼Œè¡¨è¾¾å½¢å¼ä¸º<code>extern &quot;C&quot;</code>ï¼Œ <code>extern &quot;C&quot;</code> çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®å®ç°C++ä»£ç è°ƒç”¨å…¶ä»–Cè¯­è¨€ä»£ç ã€‚<font color=red>åŠ ä¸Š<code>extern &quot;C&quot;</code>åï¼Œä¼šæŒ‡ç¤ºç¼–è¯‘å™¨è¿™éƒ¨åˆ†ä»£ç æŒ‰Cè¯­è¨€çš„è¿›è¡Œç¼–è¯‘</font>ï¼Œè€Œä¸æ˜¯C++çš„ã€‚</br></p>
</blockquote>
<blockquote>
<p><strong>ç¼–è¯‘åŒºåˆ«ï¼š</strong> ç”±äºC++æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤<u>ç¼–è¯‘å™¨ç¼–è¯‘å‡½æ•°çš„è¿‡ç¨‹ä¸­ä¼šå°†å‡½æ•°çš„å‚æ•°ç±»å‹ä¹ŸåŠ åˆ°ç¼–è¯‘åçš„ä»£ç ä¸­</u>ï¼Œè€Œä¸ä»…ä»…æ˜¯å‡½æ•°åï¼›è€ŒCè¯­è¨€å¹¶ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘Cè¯­è¨€ä»£ç çš„å‡½æ•°æ—¶ä¸ä¼šå¸¦ä¸Šå‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œä¸€èˆ¬åªåŒ…æ‹¬å‡½æ•°åã€‚</br>
æ€»ç»“: åŒºåˆ«åœ¨äºåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ˜¯å¦å¸¦ä¸Šå‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œc++å¸¦ï¼Œcä¸å¸¦ã€‚</p>
</blockquote>
<h3 id="17-ç®€è¿°cä»ä»£ç åˆ°å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„è¿‡ç¨‹">1.7 ç®€è¿°C++ä»ä»£ç åˆ°å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„è¿‡ç¨‹</h3>
<blockquote>
<p><strong>é¢„ç¼–è¯‘ã€ç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥</strong> </br>
â‘ é¢„ç¼–è¯‘ï¼šè¿™ä¸ªè¿‡ç¨‹ä¸»è¦çš„å¤„ç†æ“ä½œå¦‚ä¸‹ï¼š</br>
<tab>ï¼ˆ1ï¼‰ å°†æ‰€æœ‰çš„#defineåˆ é™¤ï¼Œå¹¶ä¸”å±•å¼€æ‰€æœ‰çš„å®å®šä¹‰</br>
<tab>ï¼ˆ2ï¼‰ å¤„ç†æ‰€æœ‰çš„<u><font color=purple>æ¡ä»¶é¢„ç¼–è¯‘æŒ‡ä»¤</font></u>ï¼Œå¦‚#ifã€#ifdef</br>
<tab>ï¼ˆ3ï¼‰ å¤„ç†#includeé¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œå°†è¢«åŒ…å«çš„æ–‡ä»¶æ’å…¥åˆ°è¯¥é¢„ç¼–è¯‘æŒ‡ä»¤çš„ä½ç½®ã€‚</br>
<tab>ï¼ˆ4ï¼‰ è¿‡æ»¤æ‰€æœ‰çš„æ³¨é‡Š</br>
<tab>ï¼ˆ5ï¼‰ æ·»åŠ è¡Œå·å’Œæ–‡ä»¶åæ ‡è¯†</br>
â‘¡ç¼–è¯‘ï¼šè¿™ä¸ªè¿‡ç¨‹ä¸»è¦çš„å¤„ç†æ“ä½œå¦‚ä¸‹ï¼š</br>
<tab>ï¼ˆ1ï¼‰ è¯æ³•åˆ†æï¼šå°†æºä»£ç çš„å­—ç¬¦åºåˆ—åˆ†å‰²æˆä¸€ç³»åˆ—çš„è®°å·ã€‚</br>
<tab>ï¼ˆ2ï¼‰ è¯­æ³•åˆ†æï¼šå¯¹è®°å·è¿›è¡Œè¯­æ³•åˆ†æï¼Œäº§ç”Ÿè¯­æ³•æ ‘ã€‚</br>
<tab>ï¼ˆ3ï¼‰ è¯­ä¹‰åˆ†æï¼šåˆ¤æ–­è¡¨è¾¾å¼æ˜¯å¦æœ‰æ„ä¹‰ã€‚</br>
<tab>ï¼ˆ4ï¼‰ ä»£ç ä¼˜åŒ–ï¼š</br>
<tab>ï¼ˆ5ï¼‰ ç›®æ ‡ä»£ç ç”Ÿæˆï¼šç”Ÿæˆæ±‡ç¼–ä»£ç ã€‚</br>
<tab>ï¼ˆ6ï¼‰ ç›®æ ‡ä»£ç ä¼˜åŒ–</br>
â‘¢æ±‡ç¼–ï¼šè¿™ä¸ªè¿‡ç¨‹ä¸»è¦æ˜¯å°†æ±‡ç¼–ä»£ç è½¬å˜æˆæœºå™¨å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤ã€‚</br>
â‘£é“¾æ¥ï¼šå°†ä¸åŒçš„æºæ–‡ä»¶äº§ç”Ÿçš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œé“¾æ¥ï¼Œä»è€Œå½¢æˆä¸€ä¸ªå¯ä»¥æ‰§è¡Œçš„ç¨‹åºã€‚</br>
â€‹ <strong>é“¾æ¥åˆ†ä¸º<font color=red>é™æ€é“¾æ¥</font>å’Œ<font color=red>åŠ¨æ€é“¾æ¥</font>ã€‚</strong></br>
â€‹<tab> (1) <strong>é™æ€é“¾æ¥</strong>ï¼Œæ˜¯åœ¨é“¾æ¥çš„æ—¶å€™å°±å·²ç»æŠŠè¦è°ƒç”¨çš„å‡½æ•°æˆ–è€…è¿‡ç¨‹é“¾æ¥åˆ°äº†ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå°±ç®—ä½ å†å»æŠŠé™æ€åº“åˆ é™¤ä¹Ÿä¸ä¼šå½±å“å¯æ‰§è¡Œç¨‹åºçš„æ‰§è¡Œï¼›ç”Ÿæˆçš„é™æ€é“¾æ¥åº“ï¼ŒWindowsä¸‹ä»¥.libä¸ºåç¼€ï¼ŒLinuxä¸‹ä»¥.aä¸ºåç¼€ã€‚</br>
<tab>â€‹ (2) <strong>åŠ¨æ€é“¾æ¥</strong>ï¼Œæ˜¯åœ¨é“¾æ¥çš„æ—¶å€™æ²¡æœ‰æŠŠè°ƒç”¨çš„å‡½æ•°ä»£ç é“¾æ¥è¿›å»ï¼Œè€Œæ˜¯åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå†å»æ‰¾è¦é“¾æ¥çš„å‡½æ•°ï¼Œç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­æ²¡æœ‰å‡½æ•°ä»£ç ï¼ŒåªåŒ…å«å‡½æ•°çš„é‡å®šä½ä¿¡æ¯ï¼Œæ‰€ä»¥å½“ä½ åˆ é™¤åŠ¨æ€åº“æ—¶ï¼Œå¯æ‰§è¡Œç¨‹åºå°±ä¸èƒ½è¿è¡Œã€‚ç”Ÿæˆçš„åŠ¨æ€é“¾æ¥åº“ï¼ŒWindowsä¸‹ä»¥.dllä¸ºåç¼€ï¼ŒLinuxä¸‹ä»¥.soä¸ºåç¼€ã€‚</br></p>
</blockquote>
<h3 id="18-staticå…³é”®å­—çš„ä½œç”¨">1.8 staticå…³é”®å­—çš„ä½œç”¨</h3>
<blockquote>
<p>â‘ <strong>å®šä¹‰å…¨å±€é™æ€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡</strong>ï¼šåœ¨å˜é‡å‰é¢åŠ ä¸Šstaticå…³é”®å­—ã€‚staticçš„å˜é‡é»˜è®¤åˆå§‹åŒ–ä¸º0ã€‚åˆå§‹åŒ–çš„é™æ€å˜é‡ä¼šåœ¨<font color=red><strong>æ•°æ®æ®µ</strong></font>åˆ†é…å†…å­˜ï¼Œæœªåˆå§‹åŒ–çš„é™æ€å˜é‡ä¼šåœ¨<font color=red><strong>BSSæ®µ</strong></font>åˆ†é…å†…å­˜ã€‚ç›´åˆ°ç¨‹åºç»“æŸï¼Œé™æ€å˜é‡å§‹ç»ˆä¼šç»´æŒå‰å€¼ã€‚åªä¸è¿‡å…¨å±€é™æ€å˜é‡(åœ¨æ•´ä¸ªå·¥ç¨‹æ–‡ä»¶æœ‰æ•ˆ)å’Œå±€éƒ¨é™æ€å˜é‡(åœ¨å½“å‰å®šä¹‰çš„æ–‡ä»¶å†…æœ‰æ•ˆ)çš„ä½œç”¨åŸŸä¸ä¸€æ ·ï¼›</br>
â‘¡<strong>å®šä¹‰é™æ€å‡½æ•°</strong>ï¼šåœ¨å‡½æ•°è¿”å›ç±»å‹å‰åŠ ä¸Šstaticå…³é”®å­—ï¼Œå‡½æ•°å³è¢«å®šä¹‰ä¸ºé™æ€å‡½æ•°ã€‚é™æ€å‡½æ•°åªèƒ½åœ¨æœ¬æºæ–‡ä»¶ä¸­ä½¿ç”¨ï¼›<code>static int func()</code></br>
â‘¢åœ¨å˜é‡ç±»å‹å‰åŠ ä¸Šstaticå…³é”®å­—ï¼Œå˜é‡å³è¢«å®šä¹‰ä¸ºé™æ€å˜é‡ã€‚é™æ€å˜é‡åªèƒ½åœ¨æœ¬æºæ–‡ä»¶ä¸­ä½¿ç”¨ï¼›</br>
â‘£<font color=red><strong>ç±»å†…é™æ€æˆå‘˜å˜é‡:</strong></font> åœ¨c++ä¸­ï¼Œstaticå…³é”®å­—å¯ä»¥ç”¨äºå®šä¹‰<strong>ç±»ä¸­çš„é™æ€æˆå‘˜å˜é‡</strong>ï¼šä½¿ç”¨é™æ€æ•°æ®æˆå‘˜ï¼Œå®ƒæ—¢å¯ä»¥è¢«å½“æˆå…¨å±€å˜é‡é‚£æ ·å»å­˜å‚¨ï¼Œä½†åˆè¢«éšè—åœ¨ç±»çš„å†…éƒ¨ã€‚ç±»ä¸­çš„staticé™æ€æ•°æ®æˆå‘˜æ‹¥<strong>æœ‰ä¸€å—å•ç‹¬çš„å­˜å‚¨åŒº</strong>ï¼Œè€Œ<u>ä¸ç®¡åˆ›å»ºäº†å¤šå°‘ä¸ªè¯¥ç±»çš„å¯¹è±¡ã€‚æ‰€æœ‰è¿™äº›å¯¹è±¡çš„é™æ€æ•°æ®æˆå‘˜éƒ½å…±äº«è¿™ä¸€å—é™æ€å­˜å‚¨ç©ºé—´ï¼Œstaticä¿®é¥°çš„å˜é‡è¦åœ¨<font color=purplr>ç±»å¤–åˆå§‹åŒ–</font></u>ã€‚</br>
â‘¤<font color=red><strong>ç±»å†…é™æ€æˆå‘˜å‡½æ•°:</strong></font>åœ¨c++ä¸­ï¼Œstaticå…³é”®å­—å¯ä»¥ç”¨äºå®šä¹‰<strong>ç±»ä¸­çš„é™æ€æˆå‘˜å‡½æ•°</strong>ï¼šä¸é™æ€æˆå‘˜å˜é‡ç±»ä¼¼ï¼Œç±»é‡Œé¢åŒæ ·å¯ä»¥å®šä¹‰é™æ€æˆå‘˜å‡½æ•°ã€‚åªéœ€è¦åœ¨å‡½æ•°å‰åŠ ä¸Šå…³é”®å­—staticå³å¯ã€‚å¦‚é™æ€æˆå‘˜å‡½æ•°ä¹Ÿæ˜¯ç±»çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚æ‰€æœ‰è¿™äº›å¯¹è±¡çš„é™æ€æ•°æ®æˆå‘˜éƒ½å…±äº«è¿™ä¸€å—é™æ€å­˜å‚¨ç©ºé—´ï¼Œåªèƒ½è®¿é—®ç±»çš„staticæˆå‘˜å˜é‡ï¼Œstaticä¿®é¥°çš„å˜é‡è¦åœ¨ç±»å¤–åˆå§‹åŒ–ã€‚</br></p>
</blockquote>
<h3 id="19-æ•°ç»„å’ŒæŒ‡é’ˆçš„åŒºåˆ«">1.9 æ•°ç»„å’ŒæŒ‡é’ˆçš„åŒºåˆ«</h3>
<blockquote>
<p><strong>æ¦‚å¿µï¼š</strong></br>
(1ï¼‰æ•°ç»„ï¼šæ•°ç»„æ˜¯ç”¨äºå‚¨å­˜å¤šä¸ª<strong>ç›¸åŒç±»å‹æ•°æ®</strong>çš„é›†åˆã€‚æ•°ç»„åæ˜¯é¦–å…ƒç´ çš„åœ°å€ã€‚</br>
(2ï¼‰æŒ‡é’ˆï¼šæŒ‡é’ˆç›¸å½“äºä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯å®ƒå’Œä¸€èˆ¬å˜é‡ä¸ä¸€æ ·ï¼Œå®ƒå­˜æ”¾çš„æ˜¯å…¶å®ƒå˜é‡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚æŒ‡é’ˆåæŒ‡å‘äº†å†…å­˜çš„é¦–åœ°å€ã€‚</br>
<strong>åŒºåˆ«ï¼š</strong></br>
èµ‹å€¼ï¼šåŒç±»å‹æŒ‡é’ˆå˜é‡å¯ä»¥ç›¸äº’èµ‹å€¼ï¼›æ•°ç»„ä¸è¡Œï¼Œåªèƒ½ä¸€ä¸ªä¸€ä¸ªå…ƒç´ çš„èµ‹å€¼æˆ–æ‹·è´ï¼›</br>
<strong>å­˜å‚¨æ–¹å¼ï¼š</strong></br>
æ•°ç»„ï¼šæ•°ç»„åœ¨<strong>å†…å­˜ä¸­æ˜¯è¿ç»­</strong>å­˜æ”¾çš„ï¼Œå¼€è¾Ÿä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´ã€‚æ•°ç»„æ˜¯æ ¹æ®æ•°ç»„çš„ä¸‹æ ‡è¿›è¡Œè®¿é—®çš„ï¼Œæ•°ç»„çš„å­˜å‚¨ç©ºé—´ï¼Œä¸æ˜¯åœ¨é™æ€åŒºå°±æ˜¯åœ¨æ ˆä¸Šã€‚</br>
æŒ‡é’ˆï¼šæŒ‡é’ˆå¾ˆçµæ´»ï¼Œå®ƒå¯ä»¥æŒ‡å‘ä»»æ„ç±»å‹çš„æ•°æ®ã€‚æŒ‡é’ˆçš„ç±»å‹è¯´æ˜äº†å®ƒæ‰€æŒ‡å‘åœ°å€ç©ºé—´çš„å†…å­˜ã€‚ç”±äºæŒ‡é’ˆæœ¬èº«å°±æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå†åŠ ä¸Šå®ƒæ‰€å­˜æ”¾çš„ä¹Ÿæ˜¯å˜é‡ï¼Œæ‰€ä»¥æŒ‡é’ˆçš„å­˜å‚¨ç©ºé—´ä¸èƒ½ç¡®å®šã€‚</br></p>
</blockquote>
<h3 id="110-ä»€ä¹ˆæ˜¯å‡½æ•°æŒ‡é’ˆå¦‚ä½•å®šä¹‰å‡½æ•°æŒ‡é’ˆæœ‰ä»€ä¹ˆä½¿ç”¨åœºæ™¯">1.10 ä»€ä¹ˆæ˜¯å‡½æ•°æŒ‡é’ˆï¼Œå¦‚ä½•å®šä¹‰å‡½æ•°æŒ‡é’ˆï¼Œæœ‰ä»€ä¹ˆä½¿ç”¨åœºæ™¯</h3>
<blockquote>
<p><strong>æ¦‚å¿µï¼š</strong> å‡½æ•°æŒ‡é’ˆå°±æ˜¯æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡ã€‚æ¯ä¸€ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªå…¥å£åœ°å€ï¼Œè¯¥å‡½æ•°å…¥å£åœ°å€å°±æ˜¯å‡½æ•°æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ã€‚</br></p>
</blockquote>
<blockquote>
<p><strong>å®šä¹‰å½¢å¼ï¼š</strong></br></p>
</blockquote>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">func</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">f</span><span class="p">)(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">func</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼š å›è°ƒï¼ˆcallbackï¼‰ã€‚æˆ‘ä»¬è°ƒç”¨åˆ«äººæä¾›çš„ APIå‡½æ•°(Application Programming Interface,åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£)ï¼Œç§°ä¸ºCallï¼›å¦‚æœåˆ«äººçš„åº“é‡Œé¢è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°ï¼Œå°±å«Callbackã€‚</p>
</blockquote>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//ä»¥åº“å‡½æ•°qsortæ’åºå‡½æ•°ä¸ºä¾‹ï¼Œå®ƒçš„åŸå‹å¦‚ä¸‹ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">qsort</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">base</span><span class="p">,</span><span class="c1">//void*ç±»å‹ï¼Œä»£è¡¨åŸå§‹æ•°ç»„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="n">size_t</span> <span class="n">nmemb</span><span class="p">,</span> <span class="c1">//ç¬¬äºŒä¸ªæ˜¯size_tç±»å‹ï¼Œä»£è¡¨æ•°æ®æ•°é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="n">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="c1">//ç¬¬ä¸‰ä¸ªæ˜¯size_tç±»å‹ï¼Œä»£è¡¨å•ä¸ªæ•°æ®å ç”¨ç©ºé—´å¤§å°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="kt">int</span><span class="p">(</span><span class="o">*</span><span class="n">compar</span><span class="p">)(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">,</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="c1">//ç¬¬å››ä¸ªå‚æ•°æ˜¯å‡½æ•°æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ç¬¬å››ä¸ªå‚æ•°å‘Šè¯‰qsortï¼Œåº”è¯¥ä½¿ç”¨å“ªä¸ªå‡½æ•°æ¥æ¯”è¾ƒå…ƒç´ ï¼Œå³åªè¦æˆ‘ä»¬å‘Šè¯‰qsortæ¯”è¾ƒå¤§å°çš„è§„åˆ™ï¼Œå®ƒå°±å¯ä»¥å¸®æˆ‘ä»¬å¯¹ä»»æ„æ•°æ®ç±»å‹çš„æ•°ç»„è¿›è¡Œæ’åºã€‚åœ¨åº“å‡½æ•°qsortè°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°ï¼Œè¿™å°±æ˜¯å›è°ƒçš„åº”ç”¨ã€‚
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//ç¤ºä¾‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">cmp_int</span><span class="p">(</span><span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">_a</span> <span class="p">,</span> <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">_b</span><span class="p">){</span><span class="c1">//å‚æ•°æ ¼å¼å›ºå®š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span><span class="o">*</span> <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">_a</span><span class="p">;</span>    <span class="c1">//å¼ºåˆ¶ç±»å‹è½¬æ¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span><span class="o">*</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">_b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="o">*</span><span class="n">b</span><span class="p">;</span>ã€€ã€€
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">qsort</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">cmp_int</span><span class="p">);</span> <span class="c1">//å›è°ƒ
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="111-é™æ€å˜é‡ä»€ä¹ˆæ—¶å€™åˆå§‹åŒ–">1.11 é™æ€å˜é‡ä»€ä¹ˆæ—¶å€™åˆå§‹åŒ–</h3>
<blockquote>
<p>å¯¹äºCè¯­è¨€çš„å…¨å±€å’Œé™æ€å˜é‡ï¼Œåˆå§‹åŒ–å‘ç”Ÿåœ¨ä»»ä½•ä»£ç æ‰§è¡Œä¹‹å‰ï¼Œå±äº<font color=red><strong>ç¼–è¯‘æœŸ</strong></font>åˆå§‹åŒ–ã€‚</br>
è€ŒC++æ ‡å‡†è§„å®šï¼šå…¨å±€æˆ–é™æ€å¯¹è±¡å½“ä¸”ä»…å½“å¯¹è±¡<font color=red>é¦–æ¬¡ç”¨åˆ°æ—¶</font>æ‰è¿›è¡Œæ„é€ ã€‚</p>
</blockquote>
<h3 id="112-nullptrè°ƒç”¨æˆå‘˜å‡½æ•°å¯ä»¥å—ä¸ºä»€ä¹ˆ">1.12 nullptrè°ƒç”¨æˆå‘˜å‡½æ•°å¯ä»¥å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3>
<p>å¯ä»¥ã€‚å› ä¸º<font color=red>åœ¨ç¼–è¯‘æ—¶å¯¹è±¡å°±ç»‘å®šäº†å‡½æ•°åœ°å€</font>ï¼Œå’ŒæŒ‡é’ˆç©ºä¸ç©ºæ²¡å…³ç³»ã€‚</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="c1">//ç»™å‡ºå®ä¾‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">animal</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">sleep</span><span class="p">()</span> <span class="p">{</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;animal sleep&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">breathe</span><span class="p">()</span> <span class="p">{</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;animal breathe haha&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">fish</span> <span class="o">:</span><span class="k">public</span> <span class="n">animal</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">breathe</span><span class="p">(){</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;fish bubble&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">animal</span> <span class="o">*</span><span class="n">pAn</span><span class="o">=</span><span class="k">nullptr</span><span class="p">;</span>    <span class="c1">//ç±»æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">pAn</span><span class="o">-&gt;</span><span class="n">breathe</span><span class="p">();</span>   <span class="c1">// è¾“å‡ºï¼šanimal breathe haha
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">fish</span> <span class="o">*</span><span class="n">pFish</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pFish</span><span class="o">-&gt;</span><span class="n">breathe</span><span class="p">();</span> <span class="c1">// è¾“å‡ºï¼šfish bubble
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// åŸå› ï¼šå› ä¸ºåœ¨ç¼–è¯‘æ—¶å¯¹è±¡å°±ç»‘å®šäº†å‡½æ•°åœ°å€ï¼Œå’ŒæŒ‡é’ˆç©ºä¸ç©ºæ²¡å…³ç³»ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1">// pAn-&gt;breathe();ç¼–è¯‘çš„æ—¶å€™ï¼Œå‡½æ•°çš„åœ°å€å°±å’ŒæŒ‡é’ˆpAnç»‘å®šäº†ï¼›
</span></span></span><span class="line"><span class="cl"><span class="c1">// è°ƒç”¨breath(*this), thiså°±ç­‰äºpAnã€‚ç”±äºå‡½æ•°ä¸­æ²¡æœ‰éœ€è¦è§£å¼•ç”¨thisçš„åœ°æ–¹ï¼Œæ‰€ä»¥å‡½æ•°è¿è¡Œä¸ä¼šå‡ºé”™ï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="c1">// ä½†æ˜¯è‹¥ç”¨åˆ°thisï¼Œå› ä¸ºthis=nullptrï¼Œè¿è¡Œå‡ºé”™ã€‚
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="113-ä»€ä¹ˆæ˜¯é‡æŒ‡é’ˆæ€ä¹ˆäº§ç”Ÿçš„å¦‚ä½•é¿å…">1.13 ä»€ä¹ˆæ˜¯é‡æŒ‡é’ˆï¼Œæ€ä¹ˆäº§ç”Ÿçš„ï¼Œå¦‚ä½•é¿å…ï¼Ÿ</h3>
<blockquote>
<p><strong>æ¦‚å¿µï¼š</strong> é‡æŒ‡é’ˆå°±æ˜¯æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®æ˜¯ä¸å¯çŸ¥çš„(éšæœºçš„ã€ä¸æ­£ç¡®çš„ã€æ²¡æœ‰æ˜ç¡®é™åˆ¶çš„)ï¼›</p>
</blockquote>
<blockquote>
<p>äº§ç”ŸåŸå› ï¼š<u>é‡Šæ”¾å†…å­˜åæŒ‡é’ˆä¸åŠæ—¶ç½®ç©ºï¼ˆé‡æŒ‡é’ˆï¼‰</u>ï¼Œä¾ç„¶æŒ‡å‘äº†è¯¥å†…å­˜ï¼Œé‚£ä¹ˆå¯èƒ½å‡ºç°éæ³•è®¿é—®çš„é”™è¯¯ã€‚è¿™äº›æˆ‘ä»¬éƒ½è¦æ³¨æ„é¿å…ã€‚(å†…å­˜æ³„éœ²)</p>
</blockquote>
<blockquote>
<p>é¿å…åŠæ³•ï¼š</br>
ï¼ˆ1ï¼‰åˆå§‹åŒ–ç½®NULL</br>
ï¼ˆ2ï¼‰ç”³è¯·å†…å­˜ååˆ¤ç©º</br>
ï¼ˆ3ï¼‰æŒ‡é’ˆé‡Šæ”¾åç½®NULL</br>
ï¼ˆ4ï¼‰ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ</br></p>
</blockquote>
<h3 id="114-é™æ€å±€éƒ¨å˜é‡å…¨å±€å˜é‡å±€éƒ¨å˜é‡çš„ç‰¹ç‚¹ä»¥åŠä½¿ç”¨åœºæ™¯">1.14 é™æ€å±€éƒ¨å˜é‡ï¼Œå…¨å±€å˜é‡ï¼Œå±€éƒ¨å˜é‡çš„ç‰¹ç‚¹ï¼Œä»¥åŠä½¿ç”¨åœºæ™¯</h3>
<blockquote>
<p>â‘ é¦–å…ˆä»ä½œç”¨åŸŸè€ƒè™‘ï¼š</br>
C++é‡Œä½œç”¨åŸŸå¯åˆ†ä¸º6ç§ï¼šå…¨å±€ï¼Œå±€éƒ¨ï¼Œç±»ï¼Œè¯­å¥ï¼Œå‘½åç©ºé—´å’Œæ–‡ä»¶ä½œç”¨åŸŸã€‚</br>
å…¨å±€å˜é‡ï¼šå…¨å±€ä½œç”¨åŸŸï¼Œå¯ä»¥é€šè¿‡externä½œç”¨äºå…¶ä»–éå®šä¹‰çš„æºæ–‡ä»¶ã€‚</br>
é™æ€å…¨å±€å˜é‡ ï¼šå…¨å±€ä½œç”¨åŸŸ+æ–‡ä»¶ä½œç”¨åŸŸï¼Œæ‰€ä»¥æ— æ³•åœ¨å…¶ä»–æ–‡ä»¶ä¸­ä½¿ç”¨ã€‚</br>
å±€éƒ¨å˜é‡ï¼šå±€éƒ¨ä½œç”¨åŸŸï¼Œæ¯”å¦‚å‡½æ•°çš„å‚æ•°ï¼Œå‡½æ•°å†…çš„å±€éƒ¨å˜é‡ç­‰ç­‰ã€‚</br>
é™æ€å±€éƒ¨å˜é‡ ï¼šå±€éƒ¨ä½œç”¨åŸŸï¼Œåªè¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œç›´åˆ°ç¨‹åºç»“æŸã€‚</br></p>
</blockquote>
<blockquote>
<p>â‘¡ä»æ‰€åœ¨ç©ºé—´è€ƒè™‘ï¼šé™¤äº†å±€éƒ¨å˜é‡åœ¨æ ˆä¸Šå¤–ï¼Œå…¶ä»–éƒ½åœ¨é™æ€å­˜å‚¨åŒºã€‚å› ä¸ºé™æ€å˜é‡éƒ½åœ¨é™æ€å­˜å‚¨åŒºï¼Œæ‰€ä»¥ä¸‹æ¬¡è°ƒç”¨å‡½æ•°çš„æ—¶å€™è¿˜æ˜¯èƒ½å–åˆ°åŸæ¥çš„å€¼ã€‚</br></p>
</blockquote>
<blockquote>
<p>â‘¢ç”Ÿå‘½å‘¨æœŸï¼š å±€éƒ¨å˜é‡åœ¨æ ˆä¸Šï¼Œå‡ºäº†ä½œç”¨åŸŸå°±å›æ”¶å†…å­˜ï¼›è€Œå…¨å±€å˜é‡ã€é™æ€å…¨å±€å˜é‡ã€é™æ€å±€éƒ¨å˜é‡éƒ½åœ¨é™æ€å­˜å‚¨åŒºï¼Œç›´åˆ°ç¨‹åºç»“æŸæ‰ä¼šå›æ”¶å†…å­˜ã€‚</br></p>
</blockquote>
<blockquote>
<p>â‘£ä½¿ç”¨åœºæ™¯ï¼šä»å®ƒä»¬å„è‡ªç‰¹ç‚¹å°±å¯ä»¥çœ‹å‡ºå„è‡ªçš„åº”ç”¨åœºæ™¯ï¼Œä¸å†èµ˜è¿°ã€‚</br></p>
</blockquote>
<h3 id="115-cç»§æ‰¿">1.15 C++ç»§æ‰¿</h3>
<blockquote>
<p>â‘ <strong>å…¬æœ‰ç»§æ‰¿public</strong>ï¼šåŸºç±»çš„å…¬æœ‰æˆå‘˜å’Œä¿æŠ¤æˆå‘˜ä½œä¸ºæ´¾ç”Ÿç±»çš„æˆå‘˜æ—¶ï¼Œå®ƒä»¬éƒ½ä¿æŒåŸæœ‰çš„çŠ¶æ€ï¼Œè€ŒåŸºç±»çš„ç§æœ‰æˆå‘˜ä»ç„¶æ˜¯ç§æœ‰çš„ï¼Œä¸èƒ½è¢«è¿™ä¸ªæ´¾ç”Ÿç±»çš„å­ç±»æ‰€è®¿é—®ã€‚</br>
â‘¡<strong>ç§æœ‰ç»§æ‰¿private</strong>ï¼šç§æœ‰ç»§æ‰¿çš„ç‰¹ç‚¹æ˜¯åŸºç±»çš„å…¬æœ‰æˆå‘˜å’Œä¿æŠ¤æˆå‘˜éƒ½ä½œä¸ºæ´¾ç”Ÿç±»çš„ç§æœ‰æˆå‘˜ï¼Œå¹¶ä¸”ä¸èƒ½è¢«è¿™ä¸ªæ´¾ç”Ÿç±»çš„å­ç±»æ‰€è®¿é—®ã€‚</br>
â‘¢<strong>ä¿æŠ¤ç»§æ‰¿protect</strong>ï¼šä¿æŠ¤ç»§æ‰¿çš„ç‰¹ç‚¹æ˜¯åŸºç±»çš„æ‰€æœ‰å…¬æœ‰æˆå‘˜å’Œä¿æŠ¤æˆå‘˜éƒ½æˆä¸ºæ´¾ç”Ÿç±»çš„ä¿æŠ¤æˆå‘˜ï¼Œå¹¶ä¸”åªèƒ½è¢«å®ƒçš„æ´¾ç”Ÿç±»æˆå‘˜å‡½æ•°æˆ–å‹å…ƒè®¿é—®ï¼ŒåŸºç±»çš„ç§æœ‰æˆå‘˜ä»ç„¶æ˜¯ç§æœ‰çš„</br></p>
</blockquote>
<h3 id="116-å¸¸é‡æŒ‡é’ˆå’ŒæŒ‡é’ˆå¸¸é‡">1.16 å¸¸é‡æŒ‡é’ˆå’ŒæŒ‡é’ˆå¸¸é‡</h3>
<blockquote>
<p>å¸¸é‡æŒ‡é’ˆ: å†…å­˜é‡Œçš„å€¼ä¸å˜</br>
æŒ‡é’ˆå¸¸é‡: æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åœ°å€ä¸å˜</br></p>
</blockquote>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="mf">1.</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>     <span class="c1">//æŒ‡çš„æ˜¯aæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œä¸å…è®¸ä¿®æ”¹ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mf">2.</span> <span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">a</span><span class="p">;</span>    <span class="c1">//aæŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜é‡Œçš„å€¼ä¸å˜ï¼Œå³ï¼ˆ*aï¼‰ä¸å˜  å¸¸é‡æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mf">3.</span> <span class="kt">int</span> <span class="k">const</span> <span class="o">*</span><span class="n">a</span><span class="p">;</span>    <span class="c1">//åŒconst int *a;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="kt">int</span> <span class="o">*</span><span class="k">const</span> <span class="n">a</span><span class="p">;</span>    <span class="c1">//aæŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜åœ°å€ä¸å˜ï¼Œå³aä¸å˜     æŒ‡é’ˆå¸¸é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mf">5.</span> <span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="k">const</span> <span class="n">a</span><span class="p">;</span>   <span class="c1">//éƒ½ä¸å˜ï¼Œå³ï¼ˆ*aï¼‰ä¸å˜ï¼Œaä¹Ÿä¸å˜
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="117-å†…è”å‡½æ•°å’Œå‡½æ•°çš„åŒºåˆ«">1.17 å†…è”å‡½æ•°å’Œå‡½æ•°çš„åŒºåˆ«</h3>
<blockquote>
<p>â‘ å†…è”å‡½æ•°æ¯”æ™®é€šå‡½æ•°å¤šäº†å…³é”®å­—inlineï¼›</br>
â‘¡å†…è”å‡½æ•°é¿å…äº†å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼›æ™®é€šå‡½æ•°æœ‰è°ƒç”¨çš„å¼€é”€ï¼›</br>
â‘¢æ™®é€šå‡½æ•°åœ¨è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œéœ€è¦å¯»å€ï¼ˆå‡½æ•°å…¥å£åœ°å€ï¼‰ï¼›<u>å†…è”å‡½æ•°ä¸éœ€è¦å¯»å€</u>ã€‚</br>
â‘£å†…è”å‡½æ•°æœ‰ä¸€å®šçš„é™åˆ¶ï¼Œå†…è”å‡½æ•°ä½“è¦æ±‚ä»£ç ç®€å•ï¼Œä¸èƒ½åŒ…å«å¤æ‚çš„ç»“æ„æ§åˆ¶è¯­å¥(å†…è”å‡½æ•°å†…ä¸å…è®¸ç”¨å¾ªç¯è¯­å¥å’Œå¼€å…³è¯­å¥ã€‚æ™®é€šå‡½æ•°æ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚</br></p>
</blockquote>
<h3 id="118-ç®€è¿°cæœ‰å‡ ç§ä¼ å€¼æ–¹å¼ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ">1.18 ç®€è¿°C++æœ‰å‡ ç§ä¼ å€¼æ–¹å¼ï¼Œä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<blockquote>
<p><strong>å€¼ä¼ é€’ã€å¼•ç”¨ä¼ é€’ã€æŒ‡é’ˆä¼ é€’</strong></br>
â‘ å€¼ä¼ é€’ï¼šå½¢å‚å³ä½¿åœ¨å‡½æ•°ä½“å†…å€¼å‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿä¸ä¼šå½±å“å®å‚çš„å€¼ï¼›</br>
â‘¡å¼•ç”¨ä¼ é€’ï¼šå½¢å‚åœ¨å‡½æ•°ä½“å†…å€¼å‘ç”Ÿå˜åŒ–ï¼Œä¼šå½±å“å®å‚çš„å€¼ï¼›</br>
â‘¢æŒ‡é’ˆä¼ é€’ï¼šåœ¨æŒ‡é’ˆæŒ‡å‘æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„å‰æä¸‹ï¼Œå½¢å‚åœ¨å‡½æ•°ä½“å†…å€¼å‘ç”Ÿå˜åŒ–ï¼Œä¼šå½±å“å®å‚çš„å€¼ï¼›</br></p>
</blockquote>
<h3 id="119-å†…è”å‡½æ•°å’Œå®å‡½æ•°çš„åŒºåˆ«">1.19 å†…è”å‡½æ•°å’Œå®å‡½æ•°çš„åŒºåˆ«</h3>
<blockquote>
<p><strong>å®å¸¸é‡&amp;å®å‡½æ•°</strong></br></p>
</blockquote>
<p>å®šä¹‰:</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// a. å®šä¹‰ä¸€ä¸ªå®å¸¸é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define MAX 1024 </span><span class="c1">// å®å¸¸é‡  MAXç§°ä¸ºç¬¦å·å¸¸é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// b. å®šä¹‰ä¸€ä¸ªå®å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1">// å®å‡½æ•°:å®å‡½æ•°å°±æ˜¯ä½¿ç”¨å®å®šä¹‰å®šä¹‰å‡ºæ¥çš„å‡½æ•°,å¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„å‡½æ•°ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define GETSUM(x, y) ((x) + (y)) </span><span class="c1">// å®å‡½æ•°
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨å®å‡½æ•°çš„æ³¨æ„äº‹é¡¹: </br></p>
<blockquote>
<ol>
<li>è¦ä¿è¯è¿ç®—çš„å®Œæ•´æ€§ï¼›</br></li>
<li>å®å‡½æ•°çš„ä½¿ç”¨åœºæ™¯:é¢‘ç¹è°ƒç”¨å’ŒçŸ­å°çš„å‡½æ•°,å°è£…æˆå®å‡½æ•°ï¼›</br></li>
<li>ä½¿ç”¨å®å‡½æ•°çš„ä¼˜ç‚¹:ä»¥ç©ºé—´æ¢æ—¶é—´ï¼›</br></li>
</ol>
</blockquote>
<p>å®å®šä¹‰å’Œå‡½æ•°çš„åŒºåˆ«:</br></p>
<blockquote>
<ol>
<li>å®åœ¨é¢„å¤„ç†é˜¶æ®µå®Œæˆæ›¿æ¢ï¼Œä¹‹åè¢«æ›¿æ¢çš„æ–‡æœ¬å‚ä¸ç¼–è¯‘ï¼Œç›¸å½“äºç›´æ¥æ’å…¥äº†ä»£ç ï¼Œè¿è¡Œæ—¶ä¸å­˜åœ¨å‡½æ•°è°ƒç”¨ï¼Œæ‰§è¡Œèµ·æ¥æ›´å¿«ï¼›å‡½æ•°è°ƒç”¨åœ¨è¿è¡Œæ—¶éœ€è¦è·³è½¬åˆ°å…·ä½“è°ƒç”¨å‡½æ•°ï¼›</br></li>
<li>å®å®šä¹‰å±äºåœ¨ç»“æ„ä¸­æ’å…¥ä»£ç ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼›å‡½æ•°è°ƒç”¨å…·æœ‰è¿”å›å€¼ï¼›</br></li>
<li>å®å®šä¹‰å‚æ•°æ²¡æœ‰ç±»å‹ï¼Œä¸è¿›è¡Œç±»å‹æ£€æŸ¥ï¼›å‡½æ•°å‚æ•°å…·æœ‰ç±»å‹ï¼Œéœ€è¦æ£€æŸ¥ç±»å‹ï¼›</br></li>
<li>å®å®šä¹‰ä¸è¦åœ¨æœ€ååŠ åˆ†å·ï¼›</br></li>
</ol>
</blockquote>
<p>å®å®šä¹‰å’Œtypedefçš„åŒºåˆ«:</br></p>
<blockquote>
<ol>
<li>å®ä¸»è¦ç”¨äºå®šä¹‰å¸¸é‡åŠä¹¦å†™å¤æ‚çš„å†…å®¹ï¼›typedefä¸»è¦ç”¨äºå®šä¹‰ç±»å‹åˆ«åï¼›</br></li>
<li>å®æ›¿æ¢å‘ç”Ÿåœ¨<strong>é¢„ç¼–è¯‘é˜¶æ®µ</strong>ï¼Œå±äºæ–‡æœ¬æ’å…¥æ›¿æ¢ï¼›typedefæ˜¯<strong>ç¼–è¯‘</strong>çš„ä¸€éƒ¨åˆ†ï¼›</br></li>
<li>å®ä¸æ£€æŸ¥ç±»å‹ï¼›typedefä¼šæ£€æŸ¥æ•°æ®ç±»å‹ï¼›</br></li>
<li>å®ä¸æ˜¯è¯­å¥ï¼Œä¸åœ¨åœ¨æœ€ååŠ åˆ†å·ï¼›typedefæ˜¯è¯­å¥ï¼Œè¦åŠ åˆ†å·æ ‡è¯†ç»“æŸï¼›</br></li>
<li>æ³¨æ„å¯¹æŒ‡é’ˆçš„æ“ä½œï¼Œtypedef char * p_charå’Œ#define p_char char *åŒºåˆ«å·¨å¤§ï¼›</br></li>
</ol>
</blockquote>
<p>å®å‡½æ•°å’Œå†…è”å‡½æ•°çš„åŒºåˆ«:</br></p>
<blockquote>
<p>1.åœ¨ä½¿ç”¨æ—¶ï¼Œå®åªåšç®€å•å­—ç¬¦ä¸²æ›¿æ¢ï¼ˆç¼–è¯‘å‰æˆ–è€…é¢„ç¼–è¯‘é˜¶æ®µï¼‰ã€‚è€Œå†…è”å‡½æ•°å¯ä»¥è¿›è¡Œå‚æ•°ç±»å‹æ£€æŸ¥ï¼ˆç¼–è¯‘æ—¶ï¼‰ï¼Œä¸”å…·æœ‰è¿”å›å€¼ï¼›</br>
2.å†…è”å‡½æ•°åœ¨ç¼–è¯‘æ—¶ç›´æ¥å°†å‡½æ•°ä»£ç åµŒå…¥åˆ°ç›®æ ‡ä»£ç ä¸­ï¼Œçœå»å‡½æ•°è°ƒç”¨çš„å¼€é”€æ¥æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œå¹¶ä¸”è¿›è¡Œå‚æ•°ç±»å‹æ£€æŸ¥ï¼Œå…·æœ‰è¿”å›å€¼ï¼Œå¯ä»¥å®ç°é‡è½½ï¼›</br>
3.å®å®šä¹‰æ—¶è¦æ³¨æ„ä¹¦å†™ï¼ˆå‚æ•°è¦æ‹¬èµ·æ¥ï¼‰å¦åˆ™å®¹æ˜“å‡ºç°æ­§ä¹‰(ä¿è¯è¿ç®—çš„å®Œæ•´æ€§)ï¼Œå†…è”å‡½æ•°ä¸ä¼šäº§ç”Ÿæ­§ä¹‰ï¼›</br>
4.å†…è”å‡½æ•°æœ‰ç±»å‹æ£€æµ‹ã€è¯­æ³•åˆ¤æ–­ç­‰åŠŸèƒ½ï¼Œè€Œå®æ²¡æœ‰ï¼›</br></p>
</blockquote>
<p>defineå®å®šä¹‰å’Œconstçš„åŒºåˆ«:</br></p>
<blockquote>
<p>å¤„ç†é˜¶æ®µï¼šdefineæ˜¯åœ¨ç¼–è¯‘çš„é¢„å¤„ç†é˜¶æ®µèµ·ä½œç”¨ï¼Œè€Œconstæ˜¯åœ¨ç¼–è¯‘ã€è¿è¡Œçš„æ—¶å€™èµ·ä½œç”¨ï¼›</p>
</blockquote>
<blockquote>
<p>å®‰å…¨æ€§ï¼š</br></p>
<blockquote>
<ol>
<li>defineåªåšæ›¿æ¢ï¼Œä¸åšç±»å‹æ£€æŸ¥å’Œè®¡ç®—ï¼Œä¹Ÿä¸æ±‚è§£ï¼Œå®¹æ˜“äº§ç”Ÿé”™è¯¯ï¼Œä¸€èˆ¬æœ€å¥½åŠ ä¸Šä¸€ä¸ªå¤§æ‹¬å·åŒ…å«ä½å…¨éƒ¨çš„å†…å®¹ï¼Œè¦ä¸ç„¶å¾ˆå®¹æ˜“å‡ºé”™ï¼›</br></li>
<li>constå¸¸é‡æœ‰æ•°æ®ç±»å‹ï¼Œç¼–è¯‘å™¨å¯ä»¥å¯¹å…¶è¿›è¡Œç±»å‹å®‰å…¨æ£€æŸ¥ï¼›</br></li>
</ol>
</blockquote>
</blockquote>
<blockquote>
<p>å†…å­˜å ç”¨ï¼š</br></p>
<blockquote>
<ol>
<li>defineåªæ˜¯å°†å®åç§°è¿›è¡Œæ›¿æ¢ï¼Œåœ¨å†…å­˜ä¸­ä¼šäº§ç”Ÿå¤šä»½ç›¸åŒçš„å¤‡ä»½ã€‚conståœ¨ç¨‹åºè¿è¡Œä¸­åªæœ‰ä¸€ä»½å¤‡ä»½ï¼Œä¸”å¯ä»¥æ‰§è¡Œå¸¸é‡æŠ˜å ï¼Œèƒ½å°†å¤æ‚çš„çš„è¡¨è¾¾å¼è®¡ç®—å‡ºç»“æœæ”¾å…¥å¸¸é‡è¡¨ï¼›</br></li>
<li>å®å®šä¹‰çš„æ•°æ®æ²¡æœ‰åˆ†é…å†…å­˜ç©ºé—´ï¼Œåªæ˜¯æ’å…¥æ›¿æ¢æ‰ï¼›constå®šä¹‰çš„å˜é‡åªæ˜¯å€¼ä¸èƒ½æ”¹å˜ï¼Œä½†è¦åˆ†é…å†…å­˜ç©ºé—´ï¼›</br></li>
</ol>
</blockquote>
</blockquote>
<h3 id="120å››ç§castç±»å‹è½¬æ¢">1.20Â å››ç§castç±»å‹è½¬æ¢</h3>
<blockquote>
<p>ä½œç”¨ï¼šå…‹æœcè¯­è¨€ä¸­å¼ºåˆ¶ç±»å‹è½¬åŒ–å¸¦æ¥çš„é£é™©ï¼ŒC++å¼•å…¥å››ç§æ›´åŠ å®‰å…¨çš„å¼ºåˆ¶ç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼ˆæ˜ç¡®è½¬æ¢çš„ç›®çš„ï¼Œä¾¿äºç¨‹åºçš„ç»´æŠ¤å’Œåˆ†æï¼‰</p>
</blockquote>
<ol>
<li>const_castï¼šå»é™¤constå±æ€§</li>
</ol>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// 1.å»é™¤constå±æ€§ï¼Œå°†åªè¯»å˜ä¸ºåªè¯»å†™
</span></span></span><span class="line"><span class="cl"><span class="c1">// 2.é’ˆå¯¹å¸¸é‡æŒ‡é’ˆã€å¸¸é‡å¼•ç”¨å’Œå¸¸é‡å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">*</span><span class="n">p1</span> <span class="o">=</span> <span class="k">const_cast</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">p</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>static_cast: å†…ç½®æ•°æ®ç±»å‹ã€åŸºç±»-æ´¾ç”Ÿç±»ä¹‹é—´çš„è½¬æ¢</li>
</ol>
<blockquote>
<ul>
<li>å†…ç½®æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼Œintè½¬doubleï¼Œcharè½¬int</br></li>
<li>åŸºç±»æŒ‡é’ˆä¸æ´¾ç”Ÿç±»ä¹‹é—´çš„è½¬æ¢ï¼Œåªèƒ½è½¬æ¢æœ‰ç»§æ‰¿æˆ–æ´¾ç”Ÿå…³ç³»çš„ç±»ã€‚ç”¨äºç±»å±‚æ¬¡ç»“æ„ä¹‹é—´åŸºç±»å’Œæ´¾ç”Ÿç±»æŒ‡é’ˆå’Œå¼•ç”¨ä¹‹é—´çš„è½¬æ¢ï¼Œè¿›è¡Œå‘ä¸Šè½¬å‹æ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯è¿›è¡Œå‘ä¸‹è½¬å‹æ˜¯ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯æ˜¯å¯ä»¥è½¬æ¢çš„;
<ul>
<li>å‘ä¸Šè½¬å‹(å‘åŸºç±»è½¬æ¢ -&gt; å®‰å…¨)ï¼šæˆ‘ä»¬çŸ¥é“åŸºç±»çš„å¼•ç”¨å’ŒæŒ‡é’ˆéƒ½å¯ä»¥æŒ‡å‘æ´¾ç”Ÿç±»çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå°†æ´¾ç”Ÿç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨å¼ºè½¬ä¸ºåŸºç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯å‘ä¸Šè½¬å‹ï¼Œä¹Ÿå°±æ˜¯å‘çˆ¶ç±»è½¬;</br></li>
<li>å‘ä¸‹è½¬å‹(å‘æ´¾ç”Ÿç±»è½¬æ¢ -&gt; ä¸å®‰å…¨)ï¼šå‘ä¸‹è½¬å‹å°±å’Œå‘ä¸Šè½¬å‹ç›¸åï¼Œå®ƒæ˜¯å°†çˆ¶ç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼Œå¼ºåˆ¶è½¬æ¢ä¸ºå­ç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨</br></li>
</ul>
</li>
<li>æŠŠvoidç±»å‹æŒ‡é’ˆè½¬æ¢ä¸ºç›®æ ‡ç±»å‹çš„æŒ‡é’ˆ</br></li>
<li>ä»»ä½•ç±»å‹çš„è¡¨è¾¾å¼è½¬åŒ–ä¸ºvoidç±»å‹</br></li>
</ul>
</blockquote>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">// æ•´å½¢è½¬æµ®ç‚¹å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">double</span> <span class="n">b</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//åŸºç±»æŒ‡é’ˆè½¬æ´¾ç”Ÿç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">A</span><span class="p">{};</span> <span class="k">class</span> <span class="nc">B</span> <span class="o">:</span> <span class="k">public</span> <span class="n">A</span><span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">*</span><span class="n">pA</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">B</span> <span class="o">*</span><span class="n">pB</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">B</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">pA</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>reinterpret_cast:</li>
</ol>
<blockquote>
<ul>
<li>å¯ä»¥å°†ä¸€ä¸ªç±»å‹çš„<strong>æŒ‡é’ˆ</strong>è½¬æ¢ä¸ºå…¶å®ƒä»»æ„ç±»å‹çš„æŒ‡é’ˆï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨æŒ‡é’ˆå’Œæ•´å½¢æ•°æ®ä¹‹é—´çš„è½¬æ¢ã€‚å®ƒæ˜¯å¾ˆå±é™©çš„ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨å®ƒçš„å……åˆ†ç†ç”±ï¼Œé‚£ä¹ˆå°±ä¸è¦ä½¿ç”¨å®ƒ</br></li>
<li>ä¸ºè¿ç®—å¯¹è±¡çš„ä½æ¨¡å¼æä¾›è¾ƒä½å±‚æ¬¡ä¸Šçš„é‡æ–°è§£é‡Š</br></li>
<li>ç”¨äºåº•å±‚çš„å¼ºåˆ¶è½¬æ¢ï¼Œä¾èµ–äºæœºå™¨ï¼Œä¸€èˆ¬ä½¿ç”¨è¾ƒå°‘</br></li>
</ul>
</blockquote>
<ol start="4">
<li>dynamic_cast: è¿è¡Œæ—¶å¤„ç†ï¼›åŸºç±»å‘æ´¾ç”Ÿç±»è½¬æ¢æ—¶æ¯”static_castæ›´å®‰å…¨</li>
</ol>
<blockquote>
<ul>
<li>dynamic_castæ˜¯<font color=red>è¿è¡Œæ—¶å¤„ç†</font>çš„ï¼Œè¿è¡Œæ—¶è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå…¶ä»–ä¸‰ç§æ˜¯ç¼–è¯‘æ—¶å¤„ç†çš„</br></li>
<li>ä¸èƒ½ç”¨äºå†…ç½®æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢</br></li>
<li>dynamic_caståœ¨è¿›è¡Œä¸Šè¡Œè½¬æ¢æ—¶å’Œstatic_castæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯è¿›è¡Œä¸‹è¡Œè½¬æ¢æ—¶ä¼šè¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œæ¯”static_castæ›´åŠ å®‰å…¨ï¼Œä¸‹è¡Œè½¬æ¢æ˜¯å¦æˆåŠŸå–å†³äºè½¬æ¢å¯¹è±¡çš„å®é™…ç±»å‹ä¸ç›®æ ‡ç±»å‹æ˜¯å¦ç›¸åŒ</br></li>
<li>è¦æ±‚åŸºç±»å¿…é¡»å…·æœ‰è™šå‡½æ•°ï¼Œå¦åˆ™ç¼–è¯‘ä¸é€šè¿‡</br></li>
<li>è‹¥è½¬æ¢æˆåŠŸï¼Œè¿”å›çš„æ˜¯æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œä¸æˆåŠŸè¿”å›NULL</br></li>
</ul>
</blockquote>
<h2 id="2-åŸºç¡€çŸ¥è¯†äºŒ">2. åŸºç¡€çŸ¥è¯†ï¼ˆäºŒï¼‰</h2>
<h3 id="21-å†™å‡º-int-bool-float-æŒ‡é’ˆå˜é‡ä¸-é›¶å€¼æ¯”è¾ƒçš„if-è¯­å¥">2.1 å†™å‡º int ã€boolã€ float ã€æŒ‡é’ˆå˜é‡ä¸ â€œé›¶å€¼â€æ¯”è¾ƒçš„if è¯­å¥</h3>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//intä¸é›¶å€¼æ¯”è¾ƒ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//boolä¸é›¶å€¼æ¯”è¾ƒ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="c1">// è¡¨ç¤ºflagä¸ºçœŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">flag</span><span class="p">)</span> <span class="c1">// è¡¨ç¤ºflagä¸ºå‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//floatä¸é›¶å€¼æ¯”è¾ƒ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">float</span> <span class="n">EPSINON</span> <span class="o">=</span> <span class="mf">0.00001</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="o">-</span> <span class="n">EPSINON</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">EPSINON</span><span class="p">)</span> <span class="c1">//å…¶ä¸­EPSINONæ˜¯å…è®¸çš„è¯¯å·®ï¼ˆå³ç²¾åº¦ï¼‰ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//æŒ‡é’ˆå˜é‡ä¸é›¶å€¼æ¯”è¾ƒ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="k">nullptr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="k">nullptr</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="22-å˜é‡çš„å£°æ˜å’Œå®šä¹‰æœ‰ä»€ä¹ˆåŒºåˆ«">2.2 å˜é‡çš„å£°æ˜å’Œå®šä¹‰æœ‰ä»€ä¹ˆåŒºåˆ«</h3>
<blockquote>
<p>â‘  å˜é‡çš„å®šä¹‰ä¸ºå˜é‡<u><em>åˆ†é…åœ°å€å’Œå­˜å‚¨ç©ºé—´</em></u>ï¼Œ å˜é‡çš„å£°æ˜ä¸åˆ†é…åœ°å€ã€‚</br>
â‘¡ ä¸€ä¸ªå˜é‡å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹å£°æ˜ï¼Œ ä½†æ˜¯åªåœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰ã€‚<font color=red>å£°æ˜å¤šæ¬¡ï¼Œå®šä¹‰ä¸€æ¬¡ã€‚</font></br>
â‘¢ åŠ å…¥extern ä¿®é¥°çš„æ˜¯å˜é‡çš„å£°æ˜ï¼Œè¯´æ˜æ­¤å˜é‡å°†åœ¨æ–‡ä»¶å¤–éƒ¨æˆ–åœ¨æ–‡ä»¶åé¢éƒ¨åˆ†å®šä¹‰ã€‚</br>
â‘£ è¯´æ˜ï¼šå¾ˆå¤šæ—¶å€™ä¸€ä¸ªå˜é‡ï¼Œåªæ˜¯å£°æ˜ï¼Œä¸åˆ†é…å†…å­˜ç©ºé—´ï¼Œç›´åˆ°å…·ä½“ä½¿ç”¨æ—¶æ‰åˆå§‹åŒ–ï¼Œåˆ†é…å†…å­˜ç©ºé—´ï¼Œ å¦‚å¤–éƒ¨å˜é‡ã€‚</br></p>
</blockquote>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">extern</span> <span class="kt">int</span> <span class="n">A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">//è¿™æ˜¯ä¸ªå£°æ˜è€Œä¸æ˜¯å®šä¹‰ï¼Œå£°æ˜Aæ˜¯ä¸€ä¸ªå·²ç»å®šä¹‰äº†çš„å¤–éƒ¨å˜é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">//æ³¨æ„ï¼šå£°æ˜å¤–éƒ¨å˜é‡æ—¶å¯ä»¥æŠŠå˜é‡ç±»å‹å»æ‰å¦‚ï¼šextern A;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">dosth</span><span class="p">();</span> <span class="c1">//æ‰§è¡Œå‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">A</span><span class="p">;</span> <span class="c1">//æ˜¯å®šä¹‰ï¼Œå®šä¹‰äº†Aä¸ºæ•´å‹çš„å¤–éƒ¨å˜é‡
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="23-ç®€è¿°-ifdefelseendifå’Œifndefçš„ä½œç”¨">2.3 ç®€è¿° <code>#ifdef</code>ã€<code>#else</code>ã€<code>#endif</code>å’Œ<code>#ifndef</code>çš„ä½œç”¨</h3>
<p>åˆ©ç”¨ <code>#ifdef</code>ã€<code>#endif</code> <u>å°†æŸç¨‹åºåŠŸèƒ½æ¨¡å—åŒ…æ‹¬è¿›å»ï¼Œä»¥å‘ç‰¹å®šç”¨æˆ·æä¾›è¯¥åŠŸèƒ½</u>ã€‚åœ¨ä¸éœ€è¦æ—¶ç”¨æˆ·å¯è½»æ˜“å°†å…¶å±è”½ã€‚</p>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">  <span class="cp">#ifdef MATH
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>    <span class="cp">#include</span> <span class="cpf">â€œmath.câ€</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">  <span class="c1">//åœ¨å­ç¨‹åºå‰åŠ ä¸Šæ ‡è®°ï¼Œä»¥ä¾¿äºè¿½è¸ªå’Œè°ƒè¯•ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="cp">#ifdef DEBUG
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>    <span class="n">printf</span> <span class="p">(</span><span class="err">â€œ</span><span class="n">Indebugging</span><span class="err">â€¦</span><span class="o">!</span><span class="err">â€</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="cp">#endif</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åº”å¯¹ç¡¬ä»¶çš„é™åˆ¶ã€‚ç”±äºä¸€äº›å…·ä½“åº”ç”¨ç¯å¢ƒçš„ç¡¬ä»¶ä¸ä¸€æ ·ï¼Œé™äºæ¡ä»¶ï¼Œæœ¬åœ°ç¼ºä¹è¿™ç§è®¾å¤‡ï¼Œåªèƒ½ç»•è¿‡ç¡¬ä»¶ï¼Œç›´æ¥å†™å‡ºé¢„æœŸç»“æœã€‚</br>
æ³¨æ„ï¼šè™½ç„¶ä¸ç”¨æ¡ä»¶ç¼–è¯‘å‘½ä»¤è€Œç›´æ¥ç”¨ifè¯­å¥ä¹Ÿèƒ½è¾¾åˆ°è¦æ±‚ï¼Œä½†é‚£æ ·åšç›®æ ‡ç¨‹åºé•¿ï¼ˆå› ä¸ºæ‰€æœ‰è¯­å¥éƒ½ç¼–è¯‘ï¼‰ï¼Œè¿è¡Œæ—¶é—´é•¿ï¼ˆå› ä¸ºåœ¨ç¨‹åºè¿è¡Œæ—¶é—´å¯¹ifè¯­å¥è¿›è¡Œæµ‹è¯•ï¼‰ã€‚è€Œé‡‡ç”¨<u><strong>æ¡ä»¶ç¼–è¯‘</strong></u>ï¼Œå¯ä»¥å‡å°‘è¢«ç¼–è¯‘çš„è¯­å¥ï¼Œä»è€Œå‡å°‘ç›®æ ‡ç¨‹åºçš„é•¿åº¦ï¼Œå‡å°‘è¿è¡Œæ—¶é—´ã€‚</p>
<h3 id="24-ç»“æ„ä½“å¯ä»¥ç›´æ¥èµ‹å€¼å—">2.4 ç»“æ„ä½“å¯ä»¥ç›´æ¥èµ‹å€¼å—?</h3>
<blockquote>
<p>â‘ ç»“æ„ä½“å£°æ˜æ—¶å¯ä»¥ç›´æ¥åˆå§‹åŒ–ï¼ŒåŒä¸€ç»“æ„ä½“çš„ä¸åŒå¯¹è±¡ä¹‹é—´ä¹Ÿå¯ä»¥ç›´æ¥èµ‹å€¼ï¼Œä½†æ˜¯å½“ç»“æ„ä½“ä¸­å«æœ‰æŒ‡é’ˆâ€œæˆå‘˜â€æ—¶ä¸€å®šè¦å°å¿ƒã€‚</br>
â‘¡æ³¨æ„ï¼šå½“æœ‰å¤šä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€æ®µå†…å­˜æ—¶ï¼ŒæŸä¸ªæŒ‡é’ˆé‡Šæ”¾è¿™æ®µå†…å­˜å¯èƒ½ä¼šå¯¼è‡´å…¶ä»–æŒ‡é’ˆçš„éæ³•æ“ä½œã€‚å› æ­¤åœ¨é‡Šæ”¾å‰ä¸€å®šè¦ç¡®ä¿å…¶ä»–æŒ‡é’ˆä¸å†ä½¿ç”¨è¿™æ®µå†…å­˜ç©ºé—´ã€‚</p>
</blockquote>
<h3 id="25-sizeof-å’Œstrlen-çš„åŒºåˆ«">2.5 sizeof å’Œstrlen çš„åŒºåˆ«</h3>
<blockquote>
<p>â‘ sizeofæ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œstrlenæ˜¯åº“å‡½æ•°ã€‚</br>
â‘¡sizeofçš„å‚æ•°å¯ä»¥æ˜¯æ•°æ®çš„ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å˜é‡ï¼Œè€Œstrlenåªèƒ½ä»¥ç»“å°¾ä¸ºâ€˜\0â€™çš„å­—ç¬¦ä¸²ä½œå‚æ•°ã€‚</br>
â‘¢ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å°±è®¡ç®—å‡ºäº†sizeofçš„ç»“æœï¼Œè€Œstrlenå‡½æ•°å¿…é¡»åœ¨è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºæ¥ã€‚å¹¶ä¸”sizeofè®¡ç®—çš„æ˜¯æ•°æ®ç±»å‹å å†…å­˜çš„å¤§å°ï¼Œè€Œstrlenè®¡ç®—çš„æ˜¯å­—ç¬¦ä¸²å®é™…çš„é•¿åº¦ã€‚</br>
â‘£æ•°ç»„åšsizeofçš„å‚æ•°ä¸é€€åŒ–ï¼Œä¼ é€’ç»™strlenå°±é€€åŒ–ä¸ºæŒ‡é’ˆäº†</br></p>
</blockquote>
<h3 id="26-sizeofæ±‚ç±»å‹å¤§å°">2.6 sizeofæ±‚ç±»å‹å¤§å°</h3>
<p>ref: <a href="https://www.cnblogs.com/maji233/p/11439880.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.cnblogs.com/maji233/p/11439880.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<blockquote>
<p>â‘ ç±»çš„å¤§å°ä¸ºç±»çš„éé™æ€æˆå‘˜æ•°æ®çš„ç±»å‹å¤§å°ä¹‹å’Œï¼Œä¹Ÿå°±æ˜¯è¯´<font color=red>é™æ€æˆå‘˜æ•°æ®ä¸ä½œè€ƒè™‘</font>ã€‚
æ™®é€šæˆå‘˜å‡½æ•°ä¸sizeofæ— å…³ã€‚</br>
â‘¡è™šå‡½æ•°ç”±äºè¦ç»´æŠ¤è™šå‡½æ•°è¡¨ï¼Œæ‰€ä»¥è¦å æ®ä¸€ä¸ªæŒ‡é’ˆå¤§å°ï¼Œä¹Ÿå°±æ˜¯4å­—èŠ‚ã€‚
ç±»çš„æ€»å¤§å°ä¹Ÿéµå®ˆç±»ä¼¼classå­—èŠ‚å¯¹é½çš„ï¼Œè°ƒæ•´è§„åˆ™ã€‚</br></p>
</blockquote>
<p>ref:</br></p>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(32 ä½)
</span></span><span class="line"><span class="cl">æŒ‡é’ˆéƒ½æ˜¯  4ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">char     1ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">short ä¸¤ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">int      4ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">long     4ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">long int 4ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">float    4ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">double    8ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">long double  8ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(64 å­—èŠ‚)
</span></span><span class="line"><span class="cl">æŒ‡é’ˆéƒ½æ˜¯ä¸€ä¸ªå­—é•¿, 8ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">char    1ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">short   2ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">int     4ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">long    8ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">long int  8ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">double    8ä¸ªå­—èŠ‚
</span></span><span class="line"><span class="cl">long double ä¹Ÿå¯ä»¥å˜é•¿äº†, 16ä¸ªå­—èŠ‚</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¾‹å¦‚æœ‰å¦‚ä¸‹ç»“æ„ä½“ï¼š</p>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">    <span class="k">struct</span> <span class="nc">Stu</span>  <span class="c1">//è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œå…è®¸ç”¨æˆ·å­˜å‚¨ä¸åŒçš„æ•°æ®ç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">char</span> <span class="n">sex</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">hight</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆä¸€ä¸ªè¿™æ ·çš„ç»“æ„ä½“å˜é‡å å¤šå¤§å†…å­˜å‘¢ï¼Ÿä¹Ÿå°±æ˜¯ <code>cout&lt;&lt;sizeof(Stu)&lt;&lt;endl;</code>  ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ
åœ¨äº†è§£å­—èŠ‚å¯¹é½æ–¹å¼ä¹‹å‰æƒ³å½“ç„¶çš„ä¼šä»¥ä¸ºï¼šsizeof(Stu) = sizeof(int)+sizeof(char)+sizeof(float) = 9.
ç„¶è€Œäº‹å®å¹¶éå¦‚æ­¤ï¼</p>
<blockquote>
<p><font color=red>å­—èŠ‚å¯¹é½åŸåˆ™: </font></br>
åœ¨ç³»ç»Ÿé»˜è®¤çš„å¯¹é½æ–¹å¼ä¸‹ï¼šæ¯ä¸ªæˆå‘˜ç›¸å¯¹äºè¿™ä¸ªç»“æ„ä½“å˜é‡åœ°å€çš„åç§»é‡æ­£å¥½æ˜¯è¯¥æˆå‘˜ç±»å‹æ‰€å å­—èŠ‚çš„æ•´æ•°å€ï¼Œä¸”æœ€ç»ˆå ç”¨å­—èŠ‚æ•°ä¸ºæˆå‘˜ç±»å‹ä¸­æœ€å¤§å ç”¨å­—èŠ‚æ•°çš„æ•´æ•°å€ã€‚</p>
</blockquote>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œidçš„åç§»é‡ä¸º0ï¼ˆ0=40ï¼‰ï¼Œsexçš„åç§»é‡ä¸º4ï¼ˆ4=14ï¼‰ï¼Œhightçš„åç§»é‡ä¸º8ï¼ˆ8=24ï¼‰ï¼Œæ­¤æ—¶å ç”¨12å­—èŠ‚ï¼Œä¹ŸåŒæ—¶æ»¡è¶³12=34.æ‰€ä»¥sizeof(Stu)=12.</p>
<blockquote>
<p>æ€»ç»“ï¼š</br>
â‘ æœ€ç»ˆå¤§å°ä¸€å®šæ˜¯æœ€å¤§æ•°æ®ç±»å‹çš„æ•´æ•°å€ï¼›</br>
â‘¡é™æ€å˜é‡ä¸å ç©ºé—´</br>
â‘¢æ¯ç§ç±»å‹çš„åç§»é‡ä¸ºè‡ªèº«çš„nå€ï¼›</br>
è¯¦ç»†è¯·æŸ¥é˜…ï¼š<a href="https://blog.csdn.net/weixin_30412577/article/details/95141536?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task"target="_blank" rel="external nofollow noopener noreferrer">struct/classç­‰å†…å­˜å­—èŠ‚å¯¹é½é—®é¢˜è¯¦è§£<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></p>
</blockquote>
<p>ref:</br>
<a href="https://www.cnblogs.com/always-chang/p/6084973.html#:~:text=1.%E5%B1%95%E5%BC%80%E5%90%8E%E7%9A%84%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%88%90%E5%91%98%E7%9A%84%E5%81%8F%E7%A7%BB%E9%87%8F%EF%BC%88%E5%B5%8C%E5%A5%97%E7%9A%84%E7%BB%93%E6%9E%84%E4%BD%93%E5%81%8F%E7%A7%BB%E9%87%8F%EF%BC%89%E5%BA%94%E5%BD%93%E6%98%AF%E8%A2%AB%E5%B1%95%E5%BC%80%E7%9A%84%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%AD%E6%9C%80%E5%A4%A7%E6%88%90%E5%91%98%E7%9A%84%E6%95%B4%E6%95%B0%E5%80%8D%EF%BC%9B,2.%E7%BB%93%E6%9E%84%E4%BD%93%E5%A4%A7%E5%B0%8F%E5%BF%85%E9%A1%BB%E6%98%AF%E6%89%80%E6%9C%89%E6%88%90%E5%91%98%E5%A4%A7%E5%B0%8F%E7%9A%84%E6%95%B4%E6%95%B0%E5%80%8D%EF%BC%8C%E8%BF%99%E9%87%8C%E8%AE%A1%E7%AE%97%E7%9A%84%E6%98%AF%E5%B1%95%E5%BC%80%E5%90%8E%E7%9A%84%E6%88%90%E5%91%98%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AF%E5%B0%86%E5%B5%8C%E5%A5%97%E7%9A%84%E7%BB%93%E6%9E%84%E4%BD%93%E7%9C%8B%E4%BD%9C%E4%B8%80%E4%B8%AA%E6%95%B4%E4%BD%93%E3%80%82"target="_blank" rel="external nofollow noopener noreferrer">structåœ°å€åç§»é‡è®¡ç®—<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h3 id="27-c-è¯­è¨€çš„å…³é”®å­—-static-å’Œ-c-çš„å…³é”®å­—-static-æœ‰ä»€ä¹ˆåŒºåˆ«">2.7 C è¯­è¨€çš„å…³é”®å­— static å’Œ C++ çš„å…³é”®å­— static æœ‰ä»€ä¹ˆåŒºåˆ«</h3>
<blockquote>
<p>â‘ åœ¨ C ä¸­ static ç”¨æ¥ä¿®é¥°å±€éƒ¨é™æ€å˜é‡å’Œå¤–éƒ¨é™æ€å˜é‡ã€å‡½æ•°ã€‚è€Œ C++ä¸­é™¤äº†ä¸Šè¿°åŠŸèƒ½å¤–ï¼Œè¿˜ç”¨æ¥å®šä¹‰ç±»çš„æˆå‘˜å˜é‡å’Œå‡½æ•°ã€‚å³é™æ€æˆå‘˜å’Œé™æ€æˆå‘˜å‡½æ•°ã€‚</br>
â‘¡æ³¨æ„ï¼šç¼–ç¨‹æ—¶ static çš„è®°å¿†æ€§å’Œå…¨å±€æ€§çš„ç‰¹ç‚¹å¯ä»¥è®©åœ¨ä¸åŒæ—¶æœŸè°ƒç”¨çš„å‡½æ•°è¿›è¡Œé€šä¿¡ï¼Œä¼ é€’ä¿¡æ¯ï¼Œè€Œ C++çš„é™æ€æˆå‘˜åˆ™å¯ä»¥åœ¨å¤šä¸ªå¯¹è±¡å®ä¾‹é—´è¿›è¡Œé€šä¿¡ï¼Œä¼ é€’ä¿¡æ¯ã€‚</br></p>
</blockquote>
<h3 id="28-ï½ƒ-è¯­è¨€çš„-malloc-å’Œ-ï½ƒ-ä¸­çš„-new-æœ‰ä»€ä¹ˆåŒºåˆ«">2.8 ï¼£ è¯­è¨€çš„ malloc å’Œ ï¼£ï¼‹ï¼‹ ä¸­çš„ new æœ‰ä»€ä¹ˆåŒºåˆ«</h3>
<blockquote>
<p>â‘ new ã€delete æ˜¯æ“ä½œç¬¦ï¼Œå¯ä»¥é‡è½½ï¼Œåªèƒ½åœ¨C++ ä¸­ä½¿ç”¨ã€‚</br>
â‘¡mallocã€free æ˜¯å‡½æ•°ï¼Œå¯ä»¥è¦†ç›–ï¼ŒCã€C++ ä¸­éƒ½å¯ä»¥ä½¿ç”¨ã€‚</br>
â‘¢new å¯ä»¥è°ƒç”¨å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œå¯¹åº”çš„delete è°ƒç”¨ç›¸åº”çš„ææ„å‡½æ•°ã€‚</br>
â‘£malloc ä»…ä»…åˆ†é…å†…å­˜ï¼Œfree ä»…ä»…å›æ”¶å†…å­˜ï¼Œå¹¶ä¸æ‰§è¡Œæ„é€ å’Œææ„å‡½æ•°ã€‚</br>
â‘¤new ã€delete è¿”å›çš„æ˜¯æŸç§æ•°æ®ç±»å‹æŒ‡é’ˆï¼Œmallocã€free è¿”å›çš„æ˜¯void æŒ‡é’ˆã€‚</br>
æ³¨æ„ï¼šmalloc ç”³è¯·çš„å†…å­˜ç©ºé—´è¦ç”¨free é‡Šæ”¾ï¼Œè€Œnew ç”³è¯·çš„å†…å­˜ç©ºé—´è¦ç”¨delete é‡Šæ”¾ï¼Œä¸è¦æ··ç”¨ã€‚
<a href="###_2.11">2.11 new å’Œ mallocçš„åŒºåˆ«</a></p>
</blockquote>
<h3 id="29-å†™ä¸€ä¸ª-æ ‡å‡†-å®min">2.9 å†™ä¸€ä¸ª â€œæ ‡å‡†â€ å®MIN</h3>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#define min(a,b) ((a)&lt;=(b)?(a):(b))</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="210-iå’Œiçš„åŒºåˆ«">2.10 ++iå’Œi++çš„åŒºåˆ«</h3>
<blockquote>
<p>++iå…ˆè‡ªå¢1ï¼Œå†è¿”å›ï¼›i++å…ˆè¿”å›i,å†è‡ªå¢1</br>
å‰ç½®ç‰ˆæœ¬å°†å¯¹è±¡æœ¬èº«ä½œä¸ºå·¦å€¼è¿”å›ï¼Œåç½®ç‰ˆæœ¬å°†å¯¹è±¡åŸå§‹å€¼çš„å‰¯æœ¬ä½œä¸ºå³å€¼è¿”å›ã€‚</p>
</blockquote>
<h3 id="211-newå’Œmallocçš„åŒºåˆ«å„è‡ªåº•å±‚å®ç°åŸç†-delete-å’Œ-freeç±»ä¼¼">2.11 newå’Œmallocçš„åŒºåˆ«ï¼Œå„è‡ªåº•å±‚å®ç°åŸç† (delete å’Œ freeç±»ä¼¼)</h3>
<blockquote>
<p>â‘ newæ˜¯æ“ä½œç¬¦ï¼Œè€Œmallocæ˜¯å‡½æ•°ã€‚</br>
â‘¡newåœ¨è°ƒç”¨çš„æ—¶å€™å…ˆåˆ†é…å†…å­˜ï¼Œå†è°ƒç”¨æ„é€ å‡½æ•°ï¼Œé‡Šæ”¾çš„æ—¶å€™è°ƒç”¨ææ„å‡½æ•°ï¼›è€Œmallocæ²¡æœ‰æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ã€‚</br>
â‘¢mallocéœ€è¦ç»™å®šç”³è¯·å†…å­˜çš„å¤§å°ï¼Œè¿”å›çš„æŒ‡é’ˆéœ€è¦å¼ºè½¬ï¼›newä¼šè°ƒç”¨æ„é€ å‡½æ•°ï¼Œä¸ç”¨æŒ‡å®šå†…å­˜çš„å¤§å°ï¼Œè¿”å›æŒ‡é’ˆä¸ç”¨å¼ºè½¬ã€‚</br>
â‘£newå¯ä»¥è¢«é‡è½½ï¼›mallocä¸è¡Œ</br>
â‘¤newåˆ†é…å†…å­˜æ›´ç›´æ¥å’Œå®‰å…¨ã€‚</br>
â‘¥newå‘ç”Ÿé”™è¯¯æŠ›å‡ºå¼‚å¸¸ï¼Œmallocè¿”å›null</br></p>
</blockquote>
<h3 id="212-const-å’Œ-define-çš„åŒºåˆ«">2.12 const å’Œ define çš„åŒºåˆ«</h3>
<p><strong>åŒºåˆ«</strong></p>
<blockquote>
<p>ï¼ˆ1ï¼‰å°±èµ·ä½œç”¨çš„é˜¶æ®µè€Œè¨€ï¼š #defineæ˜¯åœ¨ç¼–è¯‘çš„é¢„å¤„ç†é˜¶æ®µèµ·ä½œç”¨ï¼Œè€Œconstæ˜¯åœ¨ ç¼–è¯‘ã€è¿è¡Œçš„æ—¶å€™èµ·ä½œç”¨ã€‚</br>
ï¼ˆ2ï¼‰å°±èµ·ä½œç”¨çš„æ–¹å¼è€Œè¨€ï¼š #defineåªæ˜¯<u>ç®€å•çš„å­—ç¬¦ä¸²æ›¿æ¢ï¼Œæ²¡æœ‰ç±»å‹æ£€æŸ¥</u>ã€‚è€Œconstæœ‰å¯¹åº”çš„æ•°æ®ç±»å‹ï¼Œæ˜¯è¦è¿›è¡Œåˆ¤æ–­çš„ï¼Œå¯ä»¥é¿å…ä¸€äº›ä½çº§çš„é”™è¯¯ã€‚</br>
ï¼ˆ3ï¼‰å°±å­˜å‚¨æ–¹å¼è€Œè¨€ï¼š#defineåªæ˜¯è¿›è¡Œå±•å¼€ï¼Œæœ‰å¤šå°‘åœ°æ–¹ä½¿ç”¨ï¼Œå°±æ›¿æ¢å¤šå°‘æ¬¡ï¼Œå®ƒå®šä¹‰çš„å®å¸¸é‡åœ¨å†…å­˜ä¸­æœ‰è‹¥å¹²ä¸ªå¤‡ä»½ï¼›constå®šä¹‰çš„åªè¯»å˜é‡åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åªæœ‰ä¸€ä»½å¤‡ä»½ã€‚</br>
ï¼ˆ4ï¼‰ä»ä»£ç è°ƒè¯•çš„æ–¹ä¾¿ç¨‹åº¦è€Œè¨€ï¼š constå¸¸é‡å¯ä»¥è¿›è¡Œè°ƒè¯•çš„ï¼Œdefineæ˜¯ä¸èƒ½è¿›è¡Œè°ƒè¯•çš„ï¼Œå› ä¸ºåœ¨é¢„ç¼–è¯‘é˜¶æ®µå°±å·²ç»æ›¿æ¢æ‰äº†ã€‚</br></p>
</blockquote>
<p><strong>constä¼˜ç‚¹ï¼š</strong></p>
<blockquote>
<p>ï¼ˆ1ï¼‰constå¸¸é‡æœ‰æ•°æ®ç±»å‹ï¼Œè€Œå®å¸¸é‡æ²¡æœ‰æ•°æ®ç±»å‹ã€‚ç¼–è¯‘å™¨å¯ä»¥å¯¹å‰è€…è¿›è¡Œç±»å‹å®‰å…¨æ£€æŸ¥ã€‚è€Œå¯¹åè€…åªè¿›è¡Œå­—ç¬¦æ›¿æ¢ï¼Œæ²¡æœ‰ç±»å‹å®‰å…¨æ£€æŸ¥ï¼Œå¹¶ä¸”åœ¨å­—ç¬¦æ›¿æ¢å¯èƒ½ä¼šäº§ç”Ÿæ„æ–™ä¸åˆ°çš„é”™è¯¯ã€‚</br>
ï¼ˆ2ï¼‰æœ‰äº›é›†æˆåŒ–çš„è°ƒè¯•å·¥å…·å¯ä»¥å¯¹constå¸¸é‡è¿›è¡Œè°ƒè¯•ï¼Œä½†æ˜¯ä¸èƒ½å¯¹å®å¸¸é‡è¿›è¡Œè°ƒè¯•ã€‚</br>
ï¼ˆ3ï¼‰constå¯èŠ‚çœç©ºé—´ï¼Œé¿å…ä¸å¿…è¦çš„å†…å­˜åˆ†é…ï¼Œæé«˜æ•ˆç‡</br></p>
</blockquote>
<h3 id="213cä¸­å‡½æ•°æŒ‡é’ˆå’ŒæŒ‡é’ˆå‡½æ•°çš„åŒºåˆ«">2.13Â C++ä¸­å‡½æ•°æŒ‡é’ˆå’ŒæŒ‡é’ˆå‡½æ•°çš„åŒºåˆ«</h3>
<ol>
<li>å®šä¹‰ä¸åŒ</li>
</ol>
<blockquote>
<p>æŒ‡é’ˆå‡½æ•°æœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…¶è¿”å›å€¼ä¸ºæŒ‡é’ˆã€‚</br>
å‡½æ•°æŒ‡é’ˆæœ¬è´¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå…¶æŒ‡å‘ä¸€ä¸ªå‡½æ•°ã€‚</br></p>
</blockquote>
<ol start="2">
<li>å†™æ³•ä¸åŒ</li>
</ol>
<blockquote>
<p>æŒ‡é’ˆå‡½æ•°ï¼šint *fun(int x, int y);</br>
å‡½æ•°æŒ‡é’ˆï¼šint (*fun)(int x, int y);</br></p>
</blockquote>
<ol start="3">
<li>ç”¨æ³•ä¸åŒ</li>
</ol>
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//æŒ‡é’ˆå‡½æ•°ç¤ºä¾‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">_Data</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="n">Data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//æŒ‡é’ˆå‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Data</span><span class="o">*</span> <span class="nf">f</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">Data</span> <span class="o">*</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//è°ƒç”¨æŒ‡é’ˆå‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Data</span> <span class="o">*</span> <span class="n">myData</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Data * myData = static_cast&lt;Data*&gt;(f(4,5));
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//å‡½æ•°æŒ‡é’ˆç¤ºä¾‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//å‡½æ•°æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">fun</span><span class="p">)(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//èµ‹å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">fun</span> <span class="o">=</span> <span class="n">add</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;(*fun)(1,2) = &#34;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">*</span><span class="n">fun</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//è¾“å‡ºç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="c1">//(*fun)(1,2) =  3
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="214ä½¿ç”¨æŒ‡é’ˆéœ€è¦æ³¨æ„ä»€ä¹ˆ">2.14Â ä½¿ç”¨æŒ‡é’ˆéœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ</h3>
<blockquote>
<p>â‘ å®šä¹‰æŒ‡é’ˆæ—¶ï¼Œå…ˆåˆå§‹åŒ–ä¸ºNULLã€‚</br>
â‘¡ç”¨mallocæˆ–newç”³è¯·å†…å­˜ä¹‹åï¼Œåº”è¯¥ç«‹å³æ£€æŸ¥æŒ‡é’ˆå€¼æ˜¯å¦ä¸ºNULLã€‚é˜²æ­¢ä½¿ç”¨æŒ‡é’ˆå€¼ä¸ºNULLçš„å†…å­˜ã€‚</br>
â‘¢ä¸è¦å¿˜è®°ä¸ºæ•°ç»„å’ŒåŠ¨æ€å†…å­˜èµ‹åˆå€¼ã€‚é˜²æ­¢å°†æœªè¢«åˆå§‹åŒ–çš„å†…å­˜ä½œä¸ºå³å€¼ä½¿ç”¨ã€‚</br>
â‘£é¿å…æ•°å­—æˆ–æŒ‡é’ˆçš„ä¸‹æ ‡è¶Šç•Œï¼Œç‰¹åˆ«è¦å½“å¿ƒå‘ç”Ÿâ€œå¤š1â€æˆ–è€…â€œå°‘1â€æ“ä½œã€‚</br>
â‘¤åŠ¨æ€å†…å­˜çš„ç”³è¯·ä¸é‡Šæ”¾å¿…é¡»é…å¯¹ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</br>
â‘¥ç”¨freeæˆ–deleteé‡Šæ”¾äº†å†…å­˜ä¹‹åï¼Œç«‹å³å°†æŒ‡é’ˆè®¾ç½®ä¸ºNULLï¼Œé˜²æ­¢â€œé‡æŒ‡é’ˆâ€ã€‚</br></p>
</blockquote>
<h3 id="215volatileæœ‰ä»€ä¹ˆä½œç”¨">2.15Â volatileæœ‰ä»€ä¹ˆä½œç”¨</h3>
<blockquote>
<p>â‘ volatileä¸ºçŠ¶æ€å¯„å­˜å™¨ä¸€ç±»çš„å¹¶è¡Œè®¾å¤‡ç¡¬ä»¶å¯„å­˜å™¨ã€‚</br>
â‘¡ä¸€ä¸ªä¸­æ–­æœåŠ¡å­ç¨‹åºä¼šè®¿é—®åˆ°çš„éè‡ªåŠ¨å˜é‡ã€‚</br>
â‘¢å¤šçº¿ç¨‹é—´è¢«å‡ ä¸ªä»»åŠ¡å…±äº«çš„å˜é‡ã€‚</br>
æ³¨æ„ï¼šè™½ç„¶volatileåœ¨åµŒå…¥å¼æ–¹é¢åº”ç”¨æ¯”è¾ƒå¤šï¼Œä½†æ˜¯åœ¨PCè½¯ä»¶çš„å¤šçº¿ç¨‹ä¸­ï¼Œvolatileä¿®é¥°çš„ä¸´ç•Œå˜é‡ä¹Ÿæ˜¯éå¸¸å®ç”¨çš„ã€‚</p>
</blockquote>
<p>C++ä¸­volatileçš„ä½œç”¨:
<font color=red>æ€»ç»“: å»ºè®®ç¼–è¯‘å™¨ä¸è¦å¯¹è¯¥å˜é‡è¿›è¡Œä¼˜åŒ–</font></p>
<blockquote>
<p>volatileæ˜¯â€œæ˜“å˜/ä¸ç¨³å®šâ€çš„æ„æ€ã€‚volatileæ˜¯Cçš„ä¸€ä¸ªè¾ƒä¸ºå°‘ç”¨çš„å…³é”®å­—ï¼Œè§£å†³å˜é‡åœ¨â€œå…±äº«â€ç¯å¢ƒä¸‹å®¹æ˜“å‡ºç°è¯»å–é”™è¯¯çš„é—®é¢˜ã€‚</br></p>
</blockquote>
<blockquote>
<p>å®šä¹‰ä¸ºvolatileçš„å˜é‡æ˜¯è¯´è¿™å˜é‡å¯èƒ½ä¼šè¢«æ„æƒ³ä¸åˆ°åœ°æ”¹å˜ï¼Œå³åœ¨ä½ ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸€ç›´ä¼šå˜ï¼Œ<font color=red>ä½ å¸Œæœ›è¿™ä¸ªå€¼è¢«æ­£ç¡®åœ°å¤„ç†ï¼Œæ¯æ¬¡ä»å†…å­˜ä¸­å»è¯»è¿™ä¸ªå€¼ï¼Œè€Œä¸æ˜¯å› ç¼–è¯‘å™¨ä¼˜åŒ–ä»ç¼“å­˜çš„åœ°æ–¹è¯»å–</font>ï¼Œæ¯”å¦‚è¯»å–ç¼“å­˜åœ¨å¯„å­˜å™¨ä¸­çš„æ•°å€¼ï¼Œä»è€Œä¿è¯volatileå˜é‡è¢«æ­£ç¡®çš„è¯»å–ã€‚</br></p>
</blockquote>
<blockquote>
<p>åœ¨å•ä»»åŠ¡çš„ç¯å¢ƒä¸­ï¼Œä¸€ä¸ªå‡½æ•°ä½“å†…éƒ¨ï¼Œå¦‚æœåœ¨ä¸¤æ¬¡è¯»å–å˜é‡çš„å€¼ä¹‹é—´çš„è¯­å¥æ²¡æœ‰å¯¹å˜é‡çš„å€¼è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±ä¼šè®¾æ³•å¯¹å¯æ‰§è¡Œä»£ç è¿›è¡Œä¼˜åŒ–ã€‚ç”±äºè®¿é—®å¯„å­˜å™¨çš„é€Ÿåº¦è¦å¿«è¿‡RAMï¼ˆä»RAMä¸­è¯»å–å˜é‡çš„å€¼åˆ°å¯„å­˜å™¨ï¼‰ï¼Œä»¥ååªè¦å˜é‡çš„å€¼æ²¡æœ‰æ”¹å˜ï¼Œå°±ä¸€ç›´ä»å¯„å­˜å™¨ä¸­è¯»å–å˜é‡çš„å€¼ï¼Œè€Œä¸å¯¹RAMè¿›è¡Œè®¿é—®ã€‚</br></p>
</blockquote>
<blockquote>
<p>è€Œåœ¨å¤šä»»åŠ¡ç¯å¢ƒä¸­ï¼Œè™½ç„¶åœ¨ä¸€ä¸ªå‡½æ•°ä½“å†…éƒ¨ï¼Œåœ¨ä¸¤æ¬¡è¯»å–å˜é‡ä¹‹é—´æ²¡æœ‰å¯¹å˜é‡çš„å€¼è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯è¯¥å˜é‡ä»ç„¶æœ‰å¯èƒ½è¢«å…¶ä»–çš„ç¨‹åºï¼ˆå¦‚ä¸­æ–­ç¨‹åºã€å¦å¤–çš„çº¿ç¨‹ç­‰ï¼‰æ‰€ä¿®æ”¹ã€‚å¦‚æœè¿™æ—¶è¿˜æ˜¯ä»å¯„å­˜å™¨è€Œä¸æ˜¯ä»RAMä¸­è¯»å–ï¼Œå°±ä¼šå‡ºç°è¢«ä¿®æ”¹äº†çš„å˜é‡å€¼ä¸èƒ½å¾—åˆ°åŠæ—¶ååº”çš„é—®é¢˜ã€‚å¦‚ä¸‹ç¨‹åºå¯¹è¿™ä¸€ç°è±¡è¿›è¡Œäº†æ¨¡æ‹Ÿã€‚</br></p>
</blockquote>
<h3 id="216-ä¸€ä¸ªå‚æ•°å¯ä»¥æ—¢æ˜¯conståˆæ˜¯volatileå—">2.16 ä¸€ä¸ªå‚æ•°å¯ä»¥æ—¢æ˜¯conståˆæ˜¯volatileå—</h3>
<blockquote>
<p>å¯ä»¥ï¼Œç”¨constå’ŒvolatileåŒæ—¶ä¿®é¥°å˜é‡ï¼Œè¡¨ç¤ºè¿™ä¸ªå˜é‡åœ¨ç¨‹åºå†…éƒ¨æ˜¯åªè¯»çš„ï¼Œä¸èƒ½æ”¹å˜çš„ï¼Œåªåœ¨ç¨‹åºå¤–éƒ¨æ¡ä»¶å˜åŒ–ä¸‹æ”¹å˜ï¼Œå¹¶ä¸”ç¼–è¯‘å™¨ä¸ä¼šä¼˜åŒ–è¿™ä¸ªå˜é‡ã€‚æ¯æ¬¡ä½¿ç”¨è¿™ä¸ªå˜é‡æ—¶ï¼Œéƒ½è¦å°å¿ƒåœ°å»å†…å­˜è¯»å–è¿™ä¸ªå˜é‡çš„å€¼ï¼Œè€Œä¸æ˜¯å»å¯„å­˜å™¨è¯»å–å®ƒçš„å¤‡ä»½ã€‚</br>
æ³¨æ„ï¼šåœ¨æ­¤ä¸€å®šè¦æ³¨æ„constçš„æ„æ€ï¼Œconståªæ˜¯ä¸å…è®¸ç¨‹åºä¸­çš„ä»£ç æ”¹å˜æŸä¸€å˜é‡ï¼Œå…¶åœ¨ç¼–è¯‘æœŸå‘æŒ¥ä½œç”¨ï¼Œå®ƒå¹¶æ²¡æœ‰å®é™…åœ°ç¦æ­¢æŸæ®µå†…å­˜çš„è¯»å†™ç‰¹æ€§<br></p>
</blockquote>
<h3 id="217a-å’Œa-æœ‰ä»€ä¹ˆåŒºåˆ«">2.17Â a å’Œ&amp;a æœ‰ä»€ä¹ˆåŒºåˆ«</h3>
<p>&lt;1&gt; <code>&amp;a</code>ï¼šå…¶å«ä¹‰å°±æ˜¯â€œå˜é‡açš„åœ°å€â€ã€‚</br>
&lt;2&gt; <code>*a</code>ï¼šç”¨åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œå«ä¹‰ä¹Ÿä¸ä¸€æ ·ã€‚</br></p>
<ul>
<li>â‘ åœ¨å£°æ˜è¯­å¥ä¸­ï¼Œ<code>*a</code>åªè¯´æ˜aæ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œå¦‚<code>int *a</code>ï¼›</li>
<li>â‘¡åœ¨å…¶ä»–è¯­å¥ä¸­ï¼Œ<code>*a</code>å‰é¢æ²¡æœ‰æ“ä½œæ•°ä¸”aæ˜¯ä¸€ä¸ªæŒ‡é’ˆæ—¶ï¼Œ<code>*a</code>ä»£è¡¨æŒ‡é’ˆaæŒ‡å‘çš„åœ°å€å†…å­˜æ”¾çš„æ•°æ®(è§£å¼•ç”¨)ï¼Œå¦‚<code>b=*a</code>ï¼›</li>
<li>â‘¢<code>*a</code>å‰é¢æœ‰æ“ä½œæ•°ä¸”aæ˜¯ä¸€ä¸ªæ™®é€šå˜é‡æ—¶ï¼Œaä»£è¡¨ä¹˜ä»¥aï¼Œå¦‚c=ba</li>
</ul>
<h3 id="218-ç”¨c-ç¼–å†™ä¸€ä¸ªæ­»å¾ªç¯ç¨‹åº">2.18 ç”¨C ç¼–å†™ä¸€ä¸ªæ­»å¾ªç¯ç¨‹åº</h3>
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„ï¼šå¾ˆå¤šç§é€”å¾„éƒ½å¯å®ç°åŒä¸€ç§åŠŸèƒ½ï¼Œä½†æ˜¯ä¸åŒçš„æ–¹æ³•æ—¶é—´å’Œç©ºé—´å ç”¨åº¦ä¸åŒï¼Œç‰¹åˆ«æ˜¯å¯¹äºåµŒå…¥å¼è½¯ä»¶ï¼Œå¤„ç†å™¨é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œå­˜å‚¨ç©ºé—´è¾ƒå°ï¼Œæ‰€ä»¥æ—¶é—´å’Œç©ºé—´ä¼˜åŠ¿æ˜¯é€‰æ‹©å„ç§æ–¹æ³•çš„é¦–è¦è€ƒè™‘æ¡ä»¶ã€‚</p>
</blockquote>
<h3 id="219å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡æœ‰ä»€ä¹ˆåŒºåˆ«æ˜¯æ€ä¹ˆå®ç°çš„æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨æ˜¯æ€ä¹ˆçŸ¥é“çš„">2.19Â å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿæ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨æ˜¯æ€ä¹ˆçŸ¥é“çš„ï¼Ÿ</h3>
<blockquote>
<p>â‘ å…¨å±€å˜é‡æ˜¯æ•´ä¸ªç¨‹åºéƒ½å¯è®¿é—®çš„å˜é‡ï¼Œè°éƒ½å¯ä»¥è®¿é—®ï¼Œç”Ÿå­˜æœŸåœ¨æ•´ä¸ªç¨‹åºä»è¿è¡Œåˆ°ç»“æŸï¼ˆåœ¨ç¨‹åºç»“æŸæ—¶æ‰€å å†…å­˜é‡Šæ”¾ï¼‰ï¼›</br>
â‘¡è€Œå±€éƒ¨å˜é‡å­˜åœ¨äºæ¨¡å—ï¼ˆå­ç¨‹åºï¼Œå‡½æ•°ï¼‰ä¸­ï¼Œåªæœ‰æ‰€åœ¨æ¨¡å—å¯ä»¥è®¿é—®ï¼Œå…¶ä»–æ¨¡å—ä¸å¯ç›´æ¥è®¿é—®ï¼Œæ¨¡å—ç»“æŸï¼ˆå‡½æ•°è°ƒç”¨å®Œæ¯•ï¼‰ï¼Œå±€éƒ¨å˜é‡æ¶ˆå¤±ï¼Œæ‰€å æ®çš„å†…å­˜é‡Šæ”¾ã€‚</br>
â‘¢æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨ï¼Œå¯èƒ½æ˜¯é€šè¿‡å†…å­˜åˆ†é…çš„ä½ç½®æ¥çŸ¥é“çš„ï¼Œå…¨å±€å˜é‡åˆ†é…åœ¨å…¨å±€æ•°æ®æ®µå¹¶ä¸”åœ¨ç¨‹åºå¼€å§‹è¿è¡Œçš„æ—¶å€™è¢«åŠ è½½.å±€éƒ¨å˜é‡åˆ™åˆ†é…åœ¨å †æ ˆé‡Œé¢ã€‚</br></p>
</blockquote>
<h3 id="220-ç»“æ„ä½“å†…å­˜å¯¹é½é—®é¢˜">2.20 ç»“æ„ä½“å†…å­˜å¯¹é½é—®é¢˜</h3>
<p>è¯·å†™å‡ºä»¥ä¸‹ä»£ç çš„è¾“å‡ºç»“æœï¼š</p>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**************************************************************
</span></span></span><span class="line"><span class="cl"><span class="cm">*		ç»“æ„ä½“å†…å­˜å¯¹â»¬é—®é¢˜
</span></span></span><span class="line"><span class="cl"><span class="cm">*   ä»åç§»ä¸º0çš„ä½ç½®å¼€å§‹å­˜å‚¨ï¼›
</span></span></span><span class="line"><span class="cl"><span class="cm">*	å¦‚æœæ²¡æœ‰å®šä¹‰ #pragma pack(n)
</span></span></span><span class="line"><span class="cl"><span class="cm">*	sizeof çš„æœ€ç»ˆç»“æœå¿…ç„¶æ˜¯ç»“æ„å†…éƒ¨æœ€â¼¤æˆå‘˜çš„æ•´æ•°å€ï¼Œä¸å¤Ÿè¡¥â»¬ï¼›
</span></span></span><span class="line"><span class="cl"><span class="cm">*	ç»“æ„å†…éƒ¨å„ä¸ªæˆå‘˜çš„â¾¸åœ°å€å¿…ç„¶æ˜¯â¾ƒèº«â¼¤â¼©çš„æ•´æ•°å€ï¼›
</span></span></span><span class="line"><span class="cl"><span class="cm">*
</span></span></span><span class="line"><span class="cl"><span class="cm">***************************************************************/</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">S1</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">i</span> <span class="p">;</span>  <span class="c1">//èµ·å§‹åç§»0ï¼Œsizeof(i)=4; åœ°å€0ã€1ã€2ã€3åˆ†é…ç»™æˆå‘˜i
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">char</span> <span class="n">j</span> <span class="p">;</span> <span class="c1">//èµ·å§‹åç§»4ï¼Œsizeof(j)=1;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">int</span> <span class="n">a</span> <span class="p">;</span>	 <span class="c1">//sizeof(a)=4,å†…å­˜å¯¹é½åˆ°8ä¸ªå­—èŠ‚ï¼Œä»åç§»é‡ä¸º8å¤„å­˜æ”¾a;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">double</span> <span class="n">b</span><span class="p">;</span><span class="c1">//sizeof(b)=8,å†…å­˜å¯¹é½åˆ°16ä¸ªå­—èŠ‚ï¼Œå†å­˜æ”¾b,ç»“æ„ä½“æ€»å¤§å°24;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ç»“æ„ä½“æˆå‘˜çš„é¦–åœ°å€å¿…é¡»æ˜¯è‡ªèº«å¤§å°çš„æ•´æ•°å€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">S3</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">j</span><span class="p">;</span><span class="c1">//èµ·å§‹åç§»0ï¼Œsizeof(j)=1;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">float</span> <span class="n">i</span><span class="p">;</span><span class="c1">//sizeof(i)=4ï¼Œå†…å­˜å¯¹é½åˆ°4ï¼Œèµ·å§‹åç§»é‡ä¸º4,å†å­˜æ”¾i
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">double</span> <span class="n">b</span><span class="p">;</span><span class="c1">//å½“å‰åœ°å€ä¸º8ï¼Œæ˜¯bå¤§å°çš„æ•´æ•°å€ï¼Œæ— éœ€å¯¹é½ï¼Œç›´æ¥å­˜æ”¾æˆå‘˜b 8ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">int</span> <span class="n">a</span><span class="p">;</span><span class="c1">//sizeof(a)=4,å†…å­˜å¯¹é½åˆ°20ï¼Œå†å­˜æ”¾a,æ€»å¤§å°24å­—èŠ‚ï¼›
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">S1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">S3</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡º:</p>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">24
</span></span><span class="line"><span class="cl">24</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯´æ˜ï¼š</br></p>
<blockquote>
<p>â‘ ç»“æ„ä½“ä½œä¸ºä¸€ç§å¤åˆæ•°æ®ç±»å‹ï¼Œå…¶æ„æˆå…ƒç´ æ—¢å¯ä»¥æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€äº›å¤åˆå‹ç±»å‹æ•°æ®ã€‚å¯¹æ­¤ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œæˆå‘˜å˜é‡çš„å¯¹é½ä»¥æé«˜è¿ç®—æ•ˆç‡ã€‚</br>
â‘¡é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŒ‰è‡ªç„¶å¯¹é½æ¡ä»¶åˆ†é…ç©ºé—´ã€‚å„ä¸ªæˆå‘˜æŒ‰ç…§å®ƒä»¬è¢«å£°æ˜çš„é¡ºåºåœ¨å†…å­˜ä¸­é¡ºåºå­˜å‚¨ï¼Œç¬¬ä¸€ä¸ªæˆå‘˜çš„åœ°å€å’Œæ•´ä¸ªç»“æ„çš„åœ°å€ç›¸åŒï¼Œå‘ç»“æ„ä½“æˆå‘˜ä¸­sizeæœ€å¤§çš„æˆå‘˜å¯¹é½ã€‚</br>
â‘¢è®¸å¤šå®é™…çš„è®¡ç®—æœºç³»ç»Ÿå¯¹åŸºæœ¬ç±»å‹æ•°æ®åœ¨å†…å­˜ä¸­å­˜æ”¾çš„ä½ç½®æœ‰é™åˆ¶ï¼Œå®ƒä»¬ä¼šè¦æ±‚è¿™äº›æ•°æ®çš„é¦–åœ°å€çš„å€¼æ˜¯æŸä¸ªæ•°kï¼ˆé€šå¸¸å®ƒä¸º4æˆ–8ï¼‰çš„å€æ•°ï¼Œè€Œè¿™ä¸ªkåˆ™è¢«ç§°ä¸ºè¯¥æ•°æ®ç±»å‹çš„å¯¹é½æ¨¡æ•°ã€‚</br></p>
</blockquote>
<h2 id="3-åŸºç¡€çŸ¥è¯†ä¸‰">3 åŸºç¡€çŸ¥è¯†ï¼ˆä¸‰ï¼‰</h2>
<h3 id="31-ç®€è¿°ccç¨‹åºç¼–è¯‘çš„å†…å­˜åˆ†é…æƒ…å†µ">3.1 ç®€è¿°Cã€C++ç¨‹åºç¼–è¯‘çš„å†…å­˜åˆ†é…æƒ…å†µ</h3>
<blockquote>
<p>â‘ ä»é™æ€å­˜å‚¨åŒºåŸŸåˆ†é…ï¼š</br>
å†…å­˜åœ¨ç¨‹åºç¼–è¯‘æ—¶å°±å·²ç»åˆ†é…å¥½ï¼Œè¿™å—å†…å­˜åœ¨ç¨‹åºçš„æ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ã€‚é€Ÿåº¦å¿«ã€ä¸å®¹æ˜“å‡ºé”™ï¼Œ å› ä¸ºæœ‰ç³»ç»Ÿä¼šå–„åã€‚ä¾‹å¦‚å…¨å±€å˜é‡ï¼Œstatic å˜é‡ï¼Œå¸¸é‡å­—ç¬¦ä¸²ç­‰ã€‚</p>
</blockquote>
<blockquote>
<p>â‘¡åœ¨æ ˆä¸Šåˆ†é…ï¼š</br>
åœ¨æ‰§è¡Œå‡½æ•°æ—¶ï¼Œå‡½æ•°å†…å±€éƒ¨å˜é‡çš„å­˜å‚¨å•å…ƒéƒ½åœ¨æ ˆä¸Šåˆ›å»ºï¼Œå‡½æ•°æ‰§è¡Œç»“æŸæ—¶è¿™äº›å­˜å‚¨å•å…ƒè‡ªåŠ¨è¢«é‡Šæ”¾ã€‚æ ˆå†…å­˜åˆ†é…è¿ç®—å†…ç½®äºå¤„ç†å™¨çš„æŒ‡ä»¤é›†ä¸­ï¼Œæ•ˆç‡å¾ˆé«˜ï¼Œä½†æ˜¯åˆ†é…çš„å†…å­˜å®¹é‡æœ‰é™ã€‚å¤§å°ä¸º2Mã€‚</p>
</blockquote>
<blockquote>
<p>â‘¢ä»å †ä¸Šåˆ†é…ï¼š</br>
å³åŠ¨æ€å†…å­˜åˆ†é…ã€‚ç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™ç”¨ malloc æˆ–new ç”³è¯·ä»»æ„å¤§å°çš„å†…å­˜ï¼Œç¨‹åºå‘˜è‡ªå·±è´Ÿè´£åœ¨ä½• æ—¶ç”¨free æˆ–delete é‡Šæ”¾å†…å­˜ã€‚åŠ¨æ€å†…å­˜çš„ç”Ÿå­˜æœŸç”±ç¨‹åºå‘˜å†³å®šï¼Œä½¿ç”¨éå¸¸çµæ´»ã€‚å¦‚æœåœ¨å †ä¸Šåˆ†é…äº†ç©ºé—´ï¼Œå°±æœ‰è´£ä»»å›æ”¶å®ƒï¼Œå¦åˆ™è¿è¡Œçš„ç¨‹åºä¼šå‡ºç°å†…å­˜æ³„æ¼ï¼Œå¦å¤–é¢‘ç¹åœ°åˆ†é…å’Œé‡Šæ”¾ä¸åŒå¤§å°çš„å †ç©ºé—´å°†ä¼šäº§ç”Ÿ å †å†…ç¢å—ã€‚</p>
</blockquote>
<p><strong>ä¸€ä¸ªCã€C++ç¨‹åºç¼–è¯‘æ—¶å†…å­˜åˆ†ä¸º5å¤§å­˜å‚¨åŒºï¼šå †åŒºã€æ ˆåŒºã€å…¨å±€åŒºã€æ–‡å­—å¸¸é‡åŒºã€ç¨‹åºä»£ç åŒºã€‚</strong></p>
<h3 id="32ç®€è¿°strcpysprintf-ä¸memcpy-çš„åŒºåˆ«">3.2Â ç®€è¿°strcpyã€sprintf ä¸memcpy çš„åŒºåˆ«</h3>
<blockquote>
<p>â‘ æ“ä½œå¯¹è±¡ä¸åŒï¼Œstrcpy çš„ä¸¤ä¸ªæ“ä½œå¯¹è±¡å‡ä¸ºå­—ç¬¦ä¸²ï¼Œsprintf çš„æ“ä½œæºå¯¹è±¡å¯ä»¥æ˜¯å¤šç§æ•°æ®ç±»å‹ï¼Œ ç›®çš„æ“ä½œå¯¹è±¡æ˜¯å­—ç¬¦ä¸²ï¼Œmemcpy çš„ä¸¤ä¸ªå¯¹è±¡å°±æ˜¯ä¸¤ä¸ªä»»æ„å¯æ“ä½œçš„å†…å­˜åœ°å€ï¼Œå¹¶ä¸é™äºä½•ç§æ•°æ®ç±»å‹ã€‚</br>
â‘¡æ‰§è¡Œæ•ˆç‡ä¸åŒï¼Œmemcpy æœ€é«˜ï¼Œstrcpy æ¬¡ä¹‹ï¼Œsprintf çš„æ•ˆç‡æœ€ä½ã€‚</br>
â‘¢å®ç°åŠŸèƒ½ä¸åŒï¼Œstrcpy ä¸»è¦å®ç°å­—ç¬¦ä¸²å˜é‡é—´çš„æ‹·è´ï¼Œsprintf ä¸»è¦å®ç°å…¶ä»–æ•°æ®ç±»å‹æ ¼å¼åˆ°å­—ç¬¦ä¸²çš„è½¬åŒ–ï¼Œmemcpy ä¸»è¦æ˜¯å†…å­˜å—é—´çš„æ‹·è´ã€‚</br>
æ³¨æ„ï¼šstrcpyã€sprintf ä¸memcpy éƒ½å¯ä»¥å®ç°æ‹·è´çš„åŠŸèƒ½ï¼Œä½†æ˜¯é’ˆå¯¹çš„å¯¹è±¡ä¸åŒï¼Œæ ¹æ®å®é™…éœ€æ±‚ï¼Œæ¥ é€‰æ‹©åˆé€‚çš„å‡½æ•°å®ç°æ‹·è´åŠŸèƒ½ã€‚</p>
</blockquote>
<h3 id="è¯·è§£ævoid---0-çš„å«ä¹‰">è¯·è§£æ((void ()( ) )0)( )çš„å«ä¹‰</h3>
<blockquote>
<p><code>void (0)( )</code> ï¼šæ˜¯ä¸€ä¸ªè¿”å›å€¼ä¸ºvoidï¼Œå‚æ•°ä¸ºç©ºçš„å‡½æ•°æŒ‡é’ˆ0ã€‚</br>
<code>(void ()( ))0</code>ï¼šæŠŠ0è½¬å˜æˆä¸€ä¸ªè¿”å›å€¼ä¸ºvoidï¼Œå‚æ•°ä¸ºç©ºçš„å‡½æ•°æŒ‡é’ˆã€‚</br>
<code>((void ()( ))0()</code>ï¼šåœ¨ä¸Šå¥çš„åŸºç¡€ä¸ŠåŠ è¡¨ç¤ºæ•´ä¸ªæ˜¯ä¸€ä¸ªè¿”å›å€¼ä¸ºvoidï¼Œæ— å‚æ•°ï¼Œå¹¶ä¸”èµ·å§‹åœ°å€ä¸º0çš„å‡½æ•°çš„åå­—ã€‚</br>
<code>((void (*)( ))0)( )</code>ï¼šè¿™å°±æ˜¯ä¸Šå¥çš„å‡½æ•°åæ‰€å¯¹åº”çš„å‡½æ•°çš„è°ƒç”¨ã€‚</br></p>
</blockquote>
<h3 id="34-typedef-å’Œdefine-æœ‰ä»€ä¹ˆåŒºåˆ«">3.4 typedef å’Œdefine æœ‰ä»€ä¹ˆåŒºåˆ«</h3>
<blockquote>
<p>â‘ ç”¨æ³•ä¸åŒï¼š</br>
typedef ç”¨æ¥å®šä¹‰ä¸€ç§æ•°æ®ç±»å‹çš„åˆ«åï¼Œå¢å¼ºç¨‹åºçš„å¯è¯»æ€§ã€‚define ä¸»è¦ç”¨æ¥å®šä¹‰å¸¸é‡ï¼Œä»¥åŠä¹¦å†™å¤æ‚ä½¿ç”¨é¢‘ç¹çš„å®ã€‚</br>
â‘¡æ‰§è¡Œæ—¶é—´ä¸åŒï¼š</br>
typedef æ˜¯ç¼–è¯‘è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæœ‰ç±»å‹æ£€æŸ¥çš„åŠŸèƒ½ã€‚define æ˜¯å®å®šä¹‰ï¼Œæ˜¯é¢„ç¼–è¯‘çš„éƒ¨åˆ†ï¼Œå…¶å‘ç”Ÿåœ¨ç¼–è¯‘ä¹‹å‰ï¼Œåªæ˜¯ç®€å•çš„è¿›è¡Œå­—ç¬¦ä¸²çš„æ›¿æ¢ï¼Œä¸è¿›è¡Œç±»å‹çš„æ£€æŸ¥ã€‚</br>
â‘¢ä½œç”¨åŸŸä¸åŒï¼š</br>
typedef æœ‰ä½œç”¨åŸŸé™å®šï¼šdefine ä¸å—ä½œç”¨åŸŸçº¦æŸï¼Œåªè¦åœ¨define å£°æ˜åçš„å¼•ç”¨éƒ½æ˜¯æ­£ç¡®çš„ã€‚</br>
â‘£å¯¹æŒ‡é’ˆçš„æ“ä½œä¸åŒï¼š</br>
typedef å’Œdefine å®šä¹‰çš„æŒ‡é’ˆæ—¶æœ‰å¾ˆå¤§çš„åŒºåˆ«ã€‚</br>
æ³¨æ„ï¼štypedef å®šä¹‰æ˜¯è¯­å¥ï¼Œå› ä¸ºå¥å°¾è¦åŠ ä¸Šåˆ†å·ã€‚è€Œdefine ä¸æ˜¯è¯­å¥ï¼Œåƒä¸‡ä¸èƒ½åœ¨å¥å°¾åŠ åˆ†å·ã€‚</br></p>
</blockquote>
<h3 id="35æŒ‡é’ˆå¸¸é‡ä¸å¸¸é‡æŒ‡é’ˆåŒºåˆ«">3.5Â æŒ‡é’ˆå¸¸é‡ä¸å¸¸é‡æŒ‡é’ˆåŒºåˆ«</h3>
<blockquote>
<p>æŒ‡é’ˆå¸¸é‡æ˜¯æŒ‡å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆçš„å€¼åªèƒ½åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œå…¶ä»–åœ°æ–¹ä¸èƒ½æ”¹å˜ã€‚</br>
å¸¸é‡æŒ‡é’ˆæ˜¯æŒ‡å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªåªè¯»çš„å¯¹è±¡ï¼Œä¸èƒ½é€šè¿‡å¸¸é‡æŒ‡é’ˆæ¥æ”¹å˜è¿™ä¸ªå¯¹è±¡çš„å€¼ã€‚</br></p>
<blockquote>
<p>æŒ‡é’ˆå¸¸é‡å¼ºè°ƒçš„æ˜¯æŒ‡é’ˆçš„ä¸å¯æ”¹å˜æ€§ï¼Œè€Œå¸¸é‡æŒ‡é’ˆå¼ºè°ƒçš„æ˜¯æŒ‡é’ˆå¯¹å…¶æ‰€æŒ‡å¯¹è±¡çš„ä¸å¯æ”¹å˜æ€§ã€‚</br></p>
</blockquote>
</blockquote>
<blockquote>
<p>æ³¨æ„ï¼šæ— è®ºæ˜¯æŒ‡é’ˆå¸¸é‡è¿˜æ˜¯å¸¸é‡æŒ‡é’ˆï¼Œå…¶æœ€å¤§çš„ç”¨é€”å°±æ˜¯ä½œä¸ºå‡½æ•°çš„å½¢å¼å‚æ•°ï¼Œä¿è¯å®å‚åœ¨è¢«è°ƒç”¨å‡½æ•°ä¸­çš„ä¸å¯æ”¹å˜ç‰¹æ€§ã€‚</p>
</blockquote>
<h3 id="36ç®€è¿°é˜Ÿåˆ—å’Œæ ˆçš„å¼‚åŒ">3.6Â ç®€è¿°é˜Ÿåˆ—å’Œæ ˆçš„å¼‚åŒ</h3>
<blockquote>
<p>é˜Ÿåˆ—å’Œæ ˆéƒ½æ˜¯çº¿æ€§å­˜å‚¨ç»“æ„ï¼Œä½†æ˜¯ä¸¤è€…çš„æ’å…¥å’Œåˆ é™¤æ•°æ®çš„æ“ä½œä¸åŒï¼Œé˜Ÿåˆ—æ˜¯â€œå…ˆè¿›å…ˆå‡ºâ€ï¼Œæ ˆæ˜¯ â€œåè¿›å…ˆå‡ºâ€ã€‚
æ³¨æ„ï¼šåŒºåˆ«æ ˆåŒºå’Œå †åŒºã€‚å †åŒºçš„å­˜å–æ˜¯â€œé¡ºåºéšæ„â€ï¼Œè€Œæ ˆåŒºæ˜¯â€œåè¿›å…ˆå‡ºâ€ã€‚æ ˆç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾ ï¼Œå­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼ï¼Œå±€éƒ¨å˜é‡çš„å€¼ç­‰ã€‚å…¶æ“ä½œæ–¹å¼ç±»ä¼¼äºæ•°æ®ç»“æ„ä¸­çš„æ ˆã€‚å †ä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…é‡Šæ”¾ï¼Œ è‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾ï¼Œç¨‹åºç»“æŸæ—¶å¯èƒ½ç”±OS å›æ”¶ã€‚åˆ†é…æ–¹å¼ç±»ä¼¼äºé“¾è¡¨ã€‚ å®ƒä¸æœ¬é¢˜ä¸­çš„å †å’Œæ ˆæ˜¯ä¸¤å›äº‹ã€‚å †æ ˆåªæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œè€Œå †åŒºå’Œæ ˆåŒºæ˜¯ç¨‹åºçš„ä¸åŒå†…å­˜å­˜å‚¨åŒºåŸŸã€‚</p>
</blockquote>
<h3 id="37è®¾ç½®åœ°å€ä¸º0x67a9-çš„æ•´å‹å˜é‡çš„å€¼ä¸º0xaa66">3.7Â è®¾ç½®åœ°å€ä¸º0x67a9 çš„æ•´å‹å˜é‡çš„å€¼ä¸º0xaa66</h3>
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">ptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ptr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x67a9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span><span class="n">ptr</span> <span class="o">=</span> <span class="mh">0xaa66</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„ï¼šè¿™é“é¢˜å°±æ˜¯å¼ºåˆ¶ç±»å‹è½¬æ¢çš„å…¸å‹ä¾‹å­ï¼Œæ— è®ºåœ¨ä»€ä¹ˆå¹³å°ï¼Œåœ°å€é•¿åº¦å’Œæ•´å‹æ•°æ®çš„é•¿åº¦æ˜¯ä¸€æ ·çš„ï¼Œ å³ä¸€ä¸ªæ•´å‹æ•°æ®å¯ä»¥å¼ºåˆ¶è½¬æ¢æˆåœ°å€æŒ‡é’ˆç±»å‹ï¼Œåªè¦æœ‰æ„ä¹‰å³å¯ã€‚</p>
</blockquote>
<h3 id="38ç¼–ç å®ç°å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—">3.8Â ç¼–ç å®ç°å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—</h3>
<blockquote>
<p>ç¼–ç å®ç°å‡½æ•°atoi()ï¼Œè®¾è®¡ä¸€ä¸ªç¨‹åºï¼ŒæŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬åŒ–ä¸ºä¸€ä¸ªæ•´å‹æ•°å€¼ã€‚ä¾‹å¦‚æ•°å­—ï¼šâ€œ5486321 â€ï¼Œ è½¬åŒ–æˆå­—ç¬¦ï¼š5486321ã€‚</p>
</blockquote>
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">myAtoi</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//ä¿å­˜è½¬æ¢åçš„æ•°å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="kt">int</span> <span class="n">isNegative</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//è®°å½•å­—ç¬¦ä¸²ä¸­æ˜¯å¦æœ‰è´Ÿå·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="kt">char</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span><span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="c1">//åˆ¤æ–­æŒ‡é’ˆçš„åˆæ³•æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="k">while</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">++</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="c1">//è®¡ç®—æ•°å­—ç¬¦ä¸²åº¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">n</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="n">p</span> <span class="o">=</span> <span class="n">str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;-&#39;</span><span class="p">)</span> <span class="c1">//åˆ¤æ–­æ•°ç»„æ˜¯å¦æœ‰è´Ÿå·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">isNegative</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="kt">char</span> <span class="n">temp</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kt">char</span> <span class="n">temp</span> <span class="o">=</span> <span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span><span class="p">(</span><span class="n">temp</span> <span class="o">&gt;</span> <span class="sc">&#39;9&#39;</span> <span class="o">||</span><span class="n">temp</span> <span class="o">&lt;</span> <span class="sc">&#39;0&#39;</span><span class="p">)</span> <span class="c1">//æ»¤é™¤éæ•°å­—å­—ç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span><span class="n">num</span> <span class="o">!=</span><span class="mi">0</span> <span class="o">||</span> <span class="n">temp</span> <span class="o">!=</span> <span class="sc">&#39;0&#39;</span><span class="p">)</span> <span class="c1">//æ»¤é™¤å­—ç¬¦ä¸²å¼€å§‹çš„0 å­—ç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="n">temp</span> <span class="o">-=</span> <span class="mh">0x30</span><span class="p">;</span> <span class="c1">//å°†æ•°å­—å­—ç¬¦è½¬æ¢ä¸ºæ•°å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="n">num</span> <span class="o">+=</span> <span class="n">temp</span> <span class="o">*</span><span class="kt">int</span><span class="p">(</span> <span class="n">pow</span><span class="p">(</span><span class="mi">10</span> <span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span><span class="p">(</span><span class="n">isNegative</span><span class="p">)</span> <span class="c1">//å¦‚æœå­—ç¬¦ä¸²ä¸­æœ‰è´Ÿå·ï¼Œå°†æ•°å€¼å–å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="p">(</span><span class="mi">0</span> <span class="o">-</span> <span class="n">num</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="k">else</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">num</span><span class="p">;</span> <span class="c1">//è¿”å›è½¬æ¢åçš„æ•°å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="39cè¯­è¨€çš„ç»“æ„ä½“structå’Œcçš„ç±»classæœ‰ä»€ä¹ˆåŒºåˆ«">3.9Â Cè¯­è¨€çš„ç»“æ„ä½“(struct)å’ŒC++çš„ç±»(class)æœ‰ä»€ä¹ˆåŒºåˆ«</h3>
<blockquote>
<p>â‘ Cè¯­è¨€çš„ç»“æ„ä½“æ˜¯ä¸èƒ½æœ‰æˆå‘˜å‡½æ•°çš„ï¼Œè€ŒC++çš„ç±»å¯ä»¥æœ‰ã€‚</br>
â‘¡Cè¯­è¨€çš„ç»“æ„ä½“ä¸­æ•°æ®æˆå‘˜æ˜¯æ²¡æœ‰privateã€publicå’Œprotectedè®¿é—®é™å®šçš„ã€‚è€ŒC++çš„ç±»çš„æˆå‘˜æœ‰è¿™äº›è®¿é—®æƒé™é™å®šã€‚</br>
â‘¢Cè¯­è¨€çš„ç»“æ„ä½“æ˜¯æ²¡æœ‰ç»§æ‰¿å…³ç³»çš„ï¼Œè€ŒC++çš„ç±»å´æœ‰ä¸°å¯Œçš„ç»§æ‰¿å…³ç³»ã€‚</br>
æ³¨æ„ï¼šè™½ç„¶Cçš„ç»“æ„ä½“å’ŒC++çš„ç±»æœ‰å¾ˆå¤§çš„ç›¸ä¼¼åº¦ï¼Œä½†æ˜¯ç±»æ˜¯å®ç°é¢å‘å¯¹è±¡çš„åŸºç¡€ã€‚è€Œç»“æ„ä½“åªå¯ä»¥ç®€å•åœ°ç†è§£ä¸ºç±»çš„å‰èº«ã€‚</br></p>
</blockquote>
<h3 id="310-ç®€è¿°æŒ‡é’ˆå¸¸é‡ä¸å¸¸é‡æŒ‡é’ˆçš„åŒºåˆ«">3.10 ç®€è¿°æŒ‡é’ˆå¸¸é‡ä¸å¸¸é‡æŒ‡é’ˆçš„åŒºåˆ«</h3>
<blockquote>
<p>â‘ æŒ‡é’ˆå¸¸é‡æ˜¯æŒ‡å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆçš„å€¼åªèƒ½åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œå…¶ä»–åœ°æ–¹ä¸èƒ½æ”¹å˜ã€‚å¸¸é‡æŒ‡é’ˆæ˜¯æŒ‡å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªåªè¯»çš„å¯¹è±¡ï¼Œä¸èƒ½é€šè¿‡å¸¸é‡æŒ‡é’ˆæ¥æ”¹å˜è¿™ä¸ªå¯¹è±¡çš„å€¼ã€‚æŒ‡é’ˆå¸¸é‡çš„å€¼åªèƒ½åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œå¸¸é‡æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªåªè¯»çš„å¯¹è±¡</br>
â‘¡æŒ‡é’ˆå¸¸é‡å¼ºè°ƒçš„æ˜¯æŒ‡é’ˆçš„ä¸å¯æ”¹å˜æ€§ï¼Œè€Œå¸¸é‡æŒ‡é’ˆå¼ºè°ƒçš„æ˜¯æŒ‡é’ˆå¯¹å…¶æ‰€æŒ‡å¯¹è±¡çš„ä¸å¯æ”¹å˜æ€§ã€‚</br>
æ³¨æ„ï¼šæ— è®ºæ˜¯æŒ‡é’ˆå¸¸é‡è¿˜æ˜¯å¸¸é‡æŒ‡é’ˆï¼Œå…¶æœ€å¤§çš„ç”¨é€”å°±æ˜¯ä½œä¸ºå‡½æ•°çš„å½¢å¼å‚æ•°ï¼Œä¿è¯å®å‚åœ¨è¢«è°ƒç”¨å‡½æ•°ä¸­çš„ä¸å¯æ”¹å˜ç‰¹æ€§ã€‚</br></p>
</blockquote>
<h3 id="311-å¦‚ä½•é¿å…é‡æŒ‡é’ˆ">3.11 å¦‚ä½•é¿å…â€œé‡æŒ‡é’ˆâ€</h3>
<blockquote>
<p>â‘ æŒ‡é’ˆå˜é‡å£°æ˜æ—¶æ²¡æœ‰è¢«åˆå§‹åŒ–ã€‚è§£å†³åŠæ³•ï¼šæŒ‡é’ˆå£°æ˜æ—¶åˆå§‹åŒ–ï¼Œå¯ä»¥æ˜¯å…·ä½“çš„åœ°å€å€¼ï¼Œä¹Ÿå¯è®©å®ƒæŒ‡å‘NULLã€‚</br>
â‘¡æŒ‡é’ˆpè¢«freeæˆ–è€…deleteä¹‹åï¼Œæ²¡æœ‰ç½®ä¸ºNULLã€‚è§£å†³åŠæ³•ï¼šæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´è¢«é‡Šæ”¾åæŒ‡é’ˆåº”è¯¥æŒ‡å‘NULLã€‚</br>
â‘¢æŒ‡é’ˆæ“ä½œè¶…è¶Šäº†å˜é‡çš„ä½œç”¨èŒƒå›´ã€‚è§£å†³åŠæ³•ï¼šåœ¨å˜é‡çš„ä½œç”¨åŸŸç»“æŸå‰é‡Šæ”¾æ‰å˜é‡çš„åœ°å€ç©ºé—´å¹¶ä¸”è®©æŒ‡é’ˆæŒ‡å‘NULLã€‚</br></p>
</blockquote>
<h3 id="312å¥æŸ„å’ŒæŒ‡é’ˆçš„åŒºåˆ«å’Œè”ç³»æ˜¯ä»€ä¹ˆ">3.12Â å¥æŸ„å’ŒæŒ‡é’ˆçš„åŒºåˆ«å’Œè”ç³»æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>å¥æŸ„å’ŒæŒ‡é’ˆå…¶å®æ˜¯ä¸¤ä¸ªæˆªç„¶ä¸åŒçš„æ¦‚å¿µã€‚Windowsç³»ç»Ÿç”¨å¥æŸ„æ ‡è®°ç³»ç»Ÿèµ„æºï¼Œéšè—ç³»ç»Ÿçš„ä¿¡æ¯ã€‚ä½ åªè¦çŸ¥é“æœ‰è¿™ä¸ªä¸œè¥¿ï¼Œç„¶åå»è°ƒç”¨å°±è¡Œäº†ï¼Œå®ƒæ˜¯ä¸ª32bitçš„uintã€‚æŒ‡é’ˆåˆ™æ ‡è®°æŸä¸ªç‰©ç†å†…å­˜åœ°å€ï¼Œä¸¤è€…æ˜¯ä¸åŒçš„æ¦‚å¿µã€‚</p>
<h3 id="313newdeleteä¸mallocfreeçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ">3.13Â new/deleteä¸malloc/freeçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ</h3>
<blockquote>
<p>newèƒ½è‡ªåŠ¨è®¡ç®—éœ€è¦åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œè€Œmallocéœ€è¦æ‰‹å·¥è®¡ç®—å­—èŠ‚æ•°ã€‚</p>
</blockquote>
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mi">2</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>â‘ newä¸deleteç›´æ¥å¸¦å…·ä½“ç±»å‹çš„æŒ‡é’ˆï¼Œmallocå’Œfreeè¿”å›voidç±»å‹çš„æŒ‡é’ˆã€‚</br>
â‘¡newç±»å‹æ˜¯å®‰å…¨çš„ï¼Œè€Œmallocä¸æ˜¯ã€‚ä¾‹å¦‚int *p = new float[2];å°±ä¼šæŠ¥é”™ï¼›è€Œint p = malloc(2sizeof(int))ç¼–è¯‘æ—¶ç¼–è¯‘å™¨å°±æ— æ³•æŒ‡å‡ºé”™è¯¯æ¥ã€‚</br>
â‘¢newä¸€èˆ¬åˆ†ä¸ºä¸¤æ­¥ï¼šnewæ“ä½œå’Œæ„é€ ã€‚newæ“ä½œå¯¹åº”ä¸mallocï¼Œä½†newæ“ä½œå¯ä»¥é‡è½½ï¼Œå¯ä»¥è‡ªå®šä¹‰å†…å­˜åˆ†é…ç­–ç•¥ï¼Œä¸åšå†…å­˜åˆ†é…ï¼Œç”šè‡³åˆ†é…åˆ°éå†…å­˜è®¾å¤‡ä¸Šï¼Œè€Œmallocä¸è¡Œã€‚</br>
â‘£newè°ƒç”¨æ„é€ å‡½æ•°ï¼Œmallocä¸èƒ½ï¼›deleteè°ƒç”¨ææ„å‡½æ•°ï¼Œè€Œfreeä¸èƒ½ã€‚</br>
â‘¤malloc/freeéœ€è¦åº“æ–‡ä»¶stdlib.hçš„æ”¯æŒï¼Œnew/deleteåˆ™ä¸éœ€è¦ï¼</br>
æ³¨æ„ï¼šdeleteå’Œfreeè¢«è°ƒç”¨åï¼Œå†…å­˜ä¸ä¼šç«‹å³å›æ”¶ï¼ŒæŒ‡é’ˆä¹Ÿä¸ä¼šæŒ‡å‘ç©ºï¼Œdeleteæˆ–freeä»…ä»…æ˜¯å‘Šè¯‰æ“ä½œç³»ç»Ÿï¼Œè¿™ä¸€å—å†…å­˜è¢«é‡Šæ”¾äº†ï¼Œå¯ä»¥ç”¨ä½œå…¶ä»–ç”¨é€”ã€‚ä½†æ˜¯ç”±äºæ²¡æœ‰é‡æ–°å¯¹è¿™å—å†…å­˜è¿›è¡Œå†™æ“ä½œï¼Œæ‰€ä»¥å†…å­˜ä¸­çš„å˜é‡æ•°å€¼å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå‡ºç°é‡æŒ‡é’ˆçš„æƒ…å†µã€‚å› æ­¤ï¼Œé‡Šæ”¾å®Œå†…å­˜åï¼Œåº”è¯¥è®²è¯¥æŒ‡é’ˆæŒ‡å‘NULLã€‚</br></p>
</blockquote>
<h3 id="314è¯´ä¸€è¯´externc">3.14Â è¯´ä¸€è¯´externâ€œCâ€</h3>
<blockquote>
<p>extern &ldquo;C&quot;çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®å®ç°C++ä»£ç è°ƒç”¨å…¶ä»–Cè¯­è¨€ä»£ç ã€‚åŠ ä¸Šextern &ldquo;C&quot;åï¼Œä¼šæŒ‡ç¤ºç¼–è¯‘å™¨è¿™éƒ¨åˆ†ä»£ç æŒ‰Cè¯­è¨€ï¼ˆè€Œä¸æ˜¯C++ï¼‰çš„æ–¹å¼è¿›è¡Œç¼–è¯‘ã€‚ç”±äºC++æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘å™¨ç¼–è¯‘å‡½æ•°çš„è¿‡ç¨‹ä¸­ä¼šå°†å‡½æ•°çš„å‚æ•°ç±»å‹ä¹ŸåŠ åˆ°ç¼–è¯‘åçš„ä»£ç ä¸­ï¼Œè€Œä¸ä»…ä»…æ˜¯å‡½æ•°åï¼›è€ŒCè¯­è¨€å¹¶ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘Cè¯­è¨€ä»£ç çš„å‡½æ•°æ—¶ä¸ä¼šå¸¦ä¸Šå‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œä¸€èˆ¬åªåŒ…æ‹¬å‡½æ•°åã€‚</br></p>
</blockquote>
<blockquote>
<p>è¿™ä¸ªåŠŸèƒ½ååˆ†æœ‰ç”¨å¤„ï¼Œå› ä¸ºåœ¨C++å‡ºç°ä»¥å‰ï¼Œå¾ˆå¤šä»£ç éƒ½æ˜¯Cè¯­è¨€å†™çš„ï¼Œè€Œä¸”å¾ˆåº•å±‚çš„åº“ä¹Ÿæ˜¯Cè¯­è¨€å†™çš„ï¼Œä¸ºäº†æ›´å¥½çš„æ”¯æŒåŸæ¥çš„Cä»£ç å’Œå·²ç»å†™å¥½çš„Cè¯­è¨€åº“ï¼Œéœ€è¦åœ¨C++ä¸­å°½å¯èƒ½çš„æ”¯æŒCï¼Œè€Œextern &ldquo;C&quot;å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªç­–ç•¥ã€‚</br></p>
</blockquote>
<blockquote>
<p>C++ä»£ç è°ƒç”¨Cè¯­è¨€ä»£ç åœ¨C++çš„å¤´æ–‡ä»¶ä¸­ä½¿ç”¨åœ¨å¤šä¸ªäººååŒå¼€å‘æ—¶ï¼Œå¯èƒ½æœ‰çš„äººæ¯”è¾ƒæ“…é•¿Cè¯­è¨€ï¼Œè€Œæœ‰çš„äººæ“…é•¿C++ï¼Œè¿™æ ·çš„æƒ…å†µä¸‹ä¹Ÿä¼šæœ‰ç”¨åˆ°ã€‚</br></p>
</blockquote>
<h3 id="315è¯·ä½ æ¥è¯´ä¸€ä¸‹cä¸­structå’Œclassçš„åŒºåˆ«">3.15Â è¯·ä½ æ¥è¯´ä¸€ä¸‹C++ä¸­structå’Œclassçš„åŒºåˆ«</h3>
<p>åœ¨C++ä¸­ï¼Œclasså’Œstructåšç±»å‹å®šä¹‰æ˜¯åªæœ‰ä¸¤ç‚¹åŒºåˆ«ï¼š</p>
<blockquote>
<p>â‘ é»˜è®¤ç»§æ‰¿æƒé™ä¸åŒï¼Œclassç»§æ‰¿é»˜è®¤æ˜¯privateç»§æ‰¿ï¼Œè€Œstructé»˜è®¤æ˜¯publicç»§æ‰¿</br>
â‘¡classè¿˜å¯ç”¨äºå®šä¹‰æ¨¡æ¿å‚æ•°ï¼Œåƒtypenameï¼Œä½†æ˜¯å…³é”®å­—structä¸èƒ½åŒäºå®šä¹‰æ¨¡æ¿å‚æ•° </br>
â‘¢C++ä¿ç•™structå…³é”®å­—ï¼ŒåŸå› ï¼šä¿è¯ä¸Cè¯­è¨€çš„å‘ä¸‹å…¼å®¹æ€§ï¼ŒC++å¿…é¡»æä¾›ä¸€ä¸ªstruct</br>
â‘£C++ä¸­çš„structå®šä¹‰å¿…é¡»ç™¾åˆ†ç™¾åœ°ä¿è¯ä¸Cè¯­è¨€ä¸­çš„structçš„å‘ä¸‹å…¼å®¹æ€§ï¼ŒæŠŠC++ä¸­çš„æœ€åŸºæœ¬çš„å¯¹è±¡å•å…ƒè§„å®šä¸ºclassè€Œä¸æ˜¯structï¼Œå°±æ˜¯ä¸ºäº†é¿å…å„ç§å…¼å®¹æ€§è¦æ±‚çš„é™åˆ¶</br>
â‘¤å¯¹structå®šä¹‰çš„æ‰©å±•ä½¿Cè¯­è¨€çš„ä»£ç èƒ½å¤Ÿæ›´å®¹æ˜“çš„è¢«ç§»æ¤åˆ°C++ä¸­</br></p>
</blockquote>
<h3 id="316cç±»å†…å¯ä»¥å®šä¹‰å¼•ç”¨æ•°æ®æˆå‘˜å—">3.16Â C++ç±»å†…å¯ä»¥å®šä¹‰å¼•ç”¨æ•°æ®æˆå‘˜å—ï¼Ÿ</h3>
<blockquote>
<p>å¯ä»¥ï¼Œå¿…é¡»é€šè¿‡æˆå‘˜å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ–ã€‚</p>
</blockquote>
<h3 id="317cä¸­ç±»æˆå‘˜çš„è®¿é—®æƒé™">3.17Â C++ä¸­ç±»æˆå‘˜çš„è®¿é—®æƒé™</h3>
<blockquote>
<p>â‘ C++é€šè¿‡ publicã€protectedã€private ä¸‰ä¸ªå…³é”®å­—æ¥æ§åˆ¶æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°çš„è®¿é—®æƒé™ï¼Œå®ƒä»¬åˆ†åˆ«è¡¨ç¤ºå…¬æœ‰çš„ã€å—ä¿æŠ¤çš„ã€ç§æœ‰çš„ï¼Œè¢«ç§°ä¸ºæˆå‘˜è®¿é—®é™å®šç¬¦ã€‚</br>
â‘¡åœ¨ç±»çš„å†…éƒ¨ï¼ˆå®šä¹‰ç±»çš„ä»£ç å†…éƒ¨ï¼‰ï¼Œæ— è®ºæˆå‘˜è¢«å£°æ˜ä¸º publicã€protected è¿˜æ˜¯ privateï¼Œéƒ½æ˜¯å¯ä»¥äº’ç›¸è®¿é—®çš„ï¼Œæ²¡æœ‰è®¿é—®æƒé™çš„é™åˆ¶ã€‚</br>
â‘¢åœ¨ç±»çš„å¤–éƒ¨ï¼ˆå®šä¹‰ç±»çš„ä»£ç ä¹‹å¤–ï¼‰ï¼Œåªèƒ½é€šè¿‡å¯¹è±¡è®¿é—®æˆå‘˜ï¼Œå¹¶ä¸”é€šè¿‡å¯¹è±¡åªèƒ½è®¿é—® public å±æ€§çš„æˆå‘˜ï¼Œä¸èƒ½è®¿é—® privateã€protected å±æ€§çš„æˆå‘˜</br></p>
</blockquote>
<h3 id="318ä»€ä¹ˆæ˜¯å³å€¼å¼•ç”¨è·Ÿå·¦å€¼åˆæœ‰ä»€ä¹ˆåŒºåˆ«">3.18Â ä»€ä¹ˆæ˜¯å³å€¼å¼•ç”¨ï¼Œè·Ÿå·¦å€¼åˆæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<p>å·¦å€¼å’Œå³å€¼çš„æ¦‚å¿µï¼š</p>
<blockquote>
<p>â‘ å·¦å€¼ï¼š</br>
èƒ½å–åœ°å€ï¼Œæˆ–è€…å…·åå¯¹è±¡ï¼Œè¡¨è¾¾å¼ç»“æŸåä¾ç„¶å­˜åœ¨çš„æŒä¹…å¯¹è±¡ï¼›</br>
å³å€¼ï¼šä¸èƒ½å–åœ°å€ï¼ŒåŒ¿åå¯¹è±¡ï¼Œè¡¨è¾¾å¼ç»“æŸåå°±ä¸å†å­˜åœ¨çš„ä¸´æ—¶å¯¹è±¡ï¼›</br>
â‘¡åŒºåˆ«ï¼š</br>
å·¦å€¼èƒ½å¯»å€ï¼Œå³å€¼ä¸èƒ½ï¼›</br>
å·¦å€¼èƒ½èµ‹å€¼ï¼Œå³å€¼ä¸èƒ½ï¼›</br>
å·¦å€¼å¯å˜ï¼Œå³å€¼ä¸èƒ½ï¼ˆä»…å¯¹åŸºç¡€ç±»å‹é€‚ç”¨ï¼Œç”¨æˆ·è‡ªå®šä¹‰ç±»å‹å³å€¼å¼•ç”¨å¯ä»¥é€šè¿‡æˆå‘˜å‡½æ•°æ”¹å˜ï¼‰ï¼›</br></p>
</blockquote>
<h3 id="319é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹å¾">3.19Â é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹å¾</h3>
<blockquote>
<p>å°è£…æ€§ï¼šå°†å®¢è§‚äº‹ç‰©æŠ½è±¡æˆç±»ï¼Œæ¯ä¸ªç±»å¯¹è‡ªèº«çš„æ•°æ®å’Œæ–¹æ³•å®è¡Œ protection ï¼ˆprivate ï¼Œ protected ï¼Œ public ï¼‰ã€‚</br>
ç»§æ‰¿æ€§ï¼šå¹¿ä¹‰çš„ç»§æ‰¿æœ‰ä¸‰ç§å®ç°å½¢å¼ï¼šå®ç°ç»§æ‰¿ï¼ˆä½¿ç”¨åŸºç±»çš„å±æ€§å’Œæ–¹æ³•è€Œæ— éœ€é¢å¤–ç¼–ç çš„èƒ½åŠ›)ã€å¯è§†ç»§æ‰¿(å­çª—ä½“ä½¿ç”¨çˆ¶çª—ä½“çš„å¤–è§‚å’Œå®ç°ä»£ç )ã€æ¥å£ç»§æ‰¿(ä»…ä½¿ç”¨å±æ€§å’Œæ–¹æ³•,å®ç°æ»ååˆ°å­ç±»å®ç°)ã€‚</br>
å¤šæ€æ€§ï¼šæ˜¯å°†çˆ¶ç±»å¯¹è±¡è®¾ç½®æˆä¸ºå’Œä¸€ä¸ªæˆ–æ›´å¤šå®ƒçš„å­å¯¹è±¡ç›¸ç­‰çš„æŠ€æœ¯ã€‚ç”¨å­ç±»å¯¹è±¡ç»™çˆ¶ç±»å¯¹è±¡èµ‹å€¼ä¹‹åï¼Œçˆ¶ç±»å¯¹è±¡å°±å¯ä»¥æ ¹æ®å½“å‰èµ‹å€¼ç»™å®ƒçš„å­å¯¹è±¡çš„ç‰¹æ€§ä»¥ä¸åŒçš„æ–¹å¼è¿ä½œã€‚</br></p>
</blockquote>
<h3 id="320cçš„ç©ºç±»æœ‰å“ªäº›æˆå‘˜å‡½æ•°">3.20Â C++çš„ç©ºç±»æœ‰å“ªäº›æˆå‘˜å‡½æ•°</h3>
<p><a href="https://blog.csdn.net/weixin_45805339/article/details/128089198"target="_blank" rel="external nofollow noopener noreferrer">C++ç©ºç±»æˆå‘˜å‡½æ•°<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ï¼š</p>
<blockquote>
<p>ç¼ºçœæ„é€ å‡½æ•°ã€‚</br>
ç¼ºçœæ‹·è´æ„é€ å‡½æ•°ã€‚</br>
ç¼ºçœææ„å‡½æ•°ã€‚</br>
ç¼ºçœèµ‹å€¼è¿ç®—ç¬¦ã€‚</br>
ç¼ºçœå–å€è¿ç®—ç¬¦ã€‚</br>
ç¼ºçœå–å€è¿ç®—ç¬¦ const ã€‚</br>
æ³¨æ„ï¼šæœ‰äº›ä¹¦ä¸Šåªæ˜¯ç®€å•çš„ä»‹ç»äº†å‰å››ä¸ªå‡½æ•°ã€‚æ²¡æœ‰æåŠåé¢è¿™ä¸¤ä¸ªå‡½æ•°ã€‚ä½†åé¢è¿™ä¸¤ä¸ªå‡½æ•°ä¹Ÿæ˜¯ç©ºç±»çš„é»˜è®¤å‡½æ•°ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰å½“å®é™…ä½¿ç”¨è¿™äº›ç©ºç±»æˆå‘˜å‡½æ•°çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨æ‰ä¼šå»å®šä¹‰å®ƒä»¬ã€‚</br></p>
</blockquote>
<h2 id="4-åŸºç¡€çŸ¥è¯†å››">4. åŸºç¡€çŸ¥è¯†ï¼ˆå››ï¼‰</h2>
<h3 id="41-è¯´ä¸€è¯´cä¸­å››ç§castè½¬æ¢">4.1 è¯´ä¸€è¯´c++ä¸­å››ç§castè½¬æ¢</h3>
<p>C++ä¸­å››ç§ç±»å‹è½¬æ¢æ˜¯ï¼š<code>static_cast</code>, <code>dynamic_cast</code>, <code>const_cast</code>, <code>reinterpret_cast</code></p>
<blockquote>
<p>1ã€const_cast</br>
ç”¨äºå°†constå˜é‡è½¬ä¸ºéconst</br>
2ã€static_cast</br>
ç”¨äºå„ç§éšå¼è½¬æ¢ï¼Œæ¯”å¦‚éconstè½¬constï¼Œvoid*è½¬æŒ‡é’ˆç­‰, static_castèƒ½ç”¨äºå¤šæ€å‘ä¸Šè½¬åŒ–ï¼Œå¦‚æœå‘ä¸‹è½¬èƒ½æˆåŠŸä½†æ˜¯ä¸å®‰å…¨ï¼Œç»“æœæœªçŸ¥ï¼›</br>
3ã€dynamic_cast</br>
ç”¨äºåŠ¨æ€ç±»å‹è½¬æ¢ã€‚åªèƒ½ç”¨äºå«æœ‰è™šå‡½æ•°çš„ç±»ï¼Œç”¨äºç±»å±‚æ¬¡é—´çš„å‘ä¸Šå’Œå‘ä¸‹è½¬åŒ–ã€‚åªèƒ½è½¬æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚å‘ä¸‹è½¬åŒ–æ—¶ï¼Œå¦‚æœæ˜¯éæ³•çš„å¯¹äºæŒ‡é’ˆè¿”å›NULLï¼Œå¯¹äºå¼•ç”¨æŠ›å¼‚å¸¸ã€‚è¦æ·±å…¥äº†è§£å†…éƒ¨è½¬æ¢çš„åŸç†ã€‚</br></p>
<ul>
<li>å‘ä¸Šè½¬æ¢ï¼šæŒ‡çš„æ˜¯å­ç±»å‘åŸºç±»çš„è½¬æ¢</br></li>
<li>å‘ä¸‹è½¬æ¢ï¼šæŒ‡çš„æ˜¯åŸºç±»å‘å­ç±»çš„è½¬æ¢</br>
å®ƒé€šè¿‡åˆ¤æ–­åœ¨æ‰§è¡Œåˆ°è¯¥è¯­å¥çš„æ—¶å€™å˜é‡çš„è¿è¡Œæ—¶ç±»å‹å’Œè¦è½¬æ¢çš„ç±»å‹æ˜¯å¦ç›¸åŒæ¥åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œå‘ä¸‹è½¬æ¢ã€‚</br></li>
</ul>
<p>4ã€reinterpret_cast</br>
å‡ ä¹ä»€ä¹ˆéƒ½å¯ä»¥è½¬ï¼Œæ¯”å¦‚å°†intè½¬æŒ‡é’ˆï¼Œå¯èƒ½ä¼šå‡ºé—®é¢˜ï¼Œå°½é‡å°‘ç”¨ï¼›</br>
5ã€ä¸ºä»€ä¹ˆä¸ä½¿ç”¨Cçš„å¼ºåˆ¶è½¬æ¢ï¼Ÿ</br>
Cçš„å¼ºåˆ¶è½¬æ¢è¡¨é¢ä¸Šçœ‹èµ·æ¥åŠŸèƒ½å¼ºå¤§ä»€ä¹ˆéƒ½èƒ½è½¬ï¼Œä½†æ˜¯è½¬åŒ–ä¸å¤Ÿæ˜ç¡®ï¼Œä¸èƒ½è¿›è¡Œé”™è¯¯æ£€æŸ¥ï¼Œå®¹æ˜“å‡ºé”™ã€‚</br></p>
</blockquote>
<h3 id="42-å¯¹cä¸­çš„smart-pointerå››ä¸ªæ™ºèƒ½æŒ‡é’ˆçš„ç†è§£shared_ptrunique_ptrweak_ptrauto_ptr">4.2 å¯¹c++ä¸­çš„smart pointerå››ä¸ªæ™ºèƒ½æŒ‡é’ˆçš„ç†è§£ï¼šshared_ptr,unique_ptr,weak_ptr,auto_ptr</h3>
<blockquote>
<p>â‘ C++é‡Œé¢çš„å››ä¸ªæ™ºèƒ½æŒ‡é’ˆ: auto_ptr, shared_ptr, weak_ptr, unique_ptr å…¶ä¸­åä¸‰ä¸ªæ˜¯c++11æ”¯æŒï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªå·²ç»è¢«C++11å¼ƒç”¨ã€‚</br>
â‘¡æ™ºèƒ½æŒ‡é’ˆçš„ä½œç”¨æ˜¯ç®¡ç†ä¸€ä¸ªæŒ‡é’ˆï¼Œå› ä¸ºå­˜åœ¨ä»¥ä¸‹è¿™ç§æƒ…å†µï¼š</br>
ç”³è¯·çš„ç©ºé—´åœ¨å‡½æ•°ç»“æŸæ—¶å¿˜è®°é‡Šæ”¾ï¼Œé€ æˆ<strong>å†…å­˜æ³„æ¼</strong>ã€‚ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šçš„é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ™ºèƒ½æŒ‡é’ˆå°±æ˜¯ä¸€ä¸ªç±»ï¼Œå½“è¶…å‡ºäº†ç±»çš„ä½œç”¨åŸŸæ˜¯ï¼Œç±»ä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ï¼Œææ„å‡½æ•°ä¼šè‡ªåŠ¨é‡Šæ”¾èµ„æºã€‚æ‰€ä»¥æ™ºèƒ½æŒ‡é’ˆçš„ä½œç”¨åŸç†å°±æ˜¯åœ¨å‡½æ•°ç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾å†…å­˜ç©ºé—´ã€‚</br>
â‘¢auto_ptrï¼ˆc++98çš„æ–¹æ¡ˆï¼Œcpp11å·²ç»æŠ›å¼ƒï¼‰</p>
</blockquote>
<p><font color=red>é‡‡ç”¨æ‰€æœ‰æƒæ¨¡å¼ã€‚</font></p>
<div class="highlight" id="id-22"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">unique_ptr</span> <span class="nf">p3</span> <span class="p">(</span><span class="k">new</span> <span class="n">string</span> <span class="p">(</span><span class="err">â€œ</span><span class="k">auto</span><span class="err">â€</span><span class="p">));</span> <span class="c1">//#4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">unique_ptr</span> <span class="n">p4</span><span class="err">ï¼›</span> <span class="c1">//#5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">p4</span> <span class="o">=</span> <span class="n">p3</span><span class="p">;</span><span class="c1">//æ­¤æ—¶ä¼šæŠ¥é”™ï¼ï¼
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¯‘å™¨è®¤ä¸ºp4=p3éæ³•ï¼Œé¿å…äº†p3ä¸å†æŒ‡å‘æœ‰æ•ˆæ•°æ®çš„é—®é¢˜ã€‚å› æ­¤ï¼Œunique_ptræ¯”auto_ptræ›´å®‰å…¨ã€‚</br></p>
<p>å¦å¤–unique_ptrè¿˜æœ‰æ›´èªæ˜çš„åœ°æ–¹ï¼šå½“ç¨‹åºè¯•å›¾å°†ä¸€ä¸ª unique_ptr èµ‹å€¼ç»™å¦ä¸€ä¸ªæ—¶ï¼Œå¦‚æœæº unique_ptr æ˜¯ä¸ªä¸´æ—¶å³å€¼ï¼Œç¼–è¯‘å™¨å…è®¸è¿™ä¹ˆåšï¼›å¦‚æœæº unique_ptr å°†å­˜åœ¨ä¸€æ®µæ—¶é—´ï¼Œç¼–è¯‘å™¨å°†ç¦æ­¢è¿™ä¹ˆåšï¼Œæ¯”å¦‚ï¼š</p>
<div class="highlight" id="id-23"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">unique_ptr</span> <span class="nf">pu1</span><span class="p">(</span><span class="k">new</span> <span class="n">string</span> <span class="p">(</span><span class="err">â€œ</span><span class="n">hello</span> <span class="n">world</span><span class="err">â€</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="n">unique_ptr</span> <span class="n">pu2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pu2</span> <span class="o">=</span> <span class="n">pu1</span><span class="p">;</span> <span class="c1">// #1 not allowed
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">unique_ptr</span> <span class="n">pu3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pu3</span> <span class="o">=</span> <span class="n">unique_ptr</span><span class="p">(</span><span class="k">new</span> <span class="n">string</span> <span class="p">(</span><span class="err">â€œ</span><span class="n">You</span><span class="err">â€</span><span class="p">));</span> <span class="c1">// #2 allowed
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­#1ç•™ä¸‹æ‚¬æŒ‚çš„ unique_ptr(pu1)ï¼Œè¿™å¯èƒ½å¯¼è‡´å±å®³ã€‚è€Œ#2ä¸ä¼šç•™ä¸‹æ‚¬æŒ‚çš„unique_ptrï¼Œå› ä¸ºå®ƒè°ƒç”¨ unique_ptr çš„æ„é€ å‡½æ•°ï¼Œè¯¥æ„é€ å‡½æ•°åˆ›å»ºçš„ä¸´æ—¶å¯¹è±¡åœ¨å…¶æ‰€æœ‰æƒè®©ç»™ pu3 åå°±ä¼šè¢«é”€æ¯ã€‚è¿™ç§éšæƒ…å†µè€Œå·²çš„è¡Œä¸ºè¡¨æ˜ï¼Œunique_ptr ä¼˜äºå…è®¸ä¸¤ç§èµ‹å€¼çš„auto_ptr ã€‚</p>
<p>æ³¨ï¼šå¦‚æœç¡®å®æƒ³æ‰§è¡Œç±»ä¼¼ä¸#1çš„æ“ä½œï¼Œè¦å®‰å…¨çš„é‡ç”¨è¿™ç§æŒ‡é’ˆï¼Œå¯ç»™å®ƒèµ‹æ–°å€¼ã€‚C++æœ‰ä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°std::move()ï¼Œè®©ä½ èƒ½å¤Ÿå°†ä¸€ä¸ªunique_ptrèµ‹ç»™å¦ä¸€ä¸ªã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight" id="id-24"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">unique_ptr</span> <span class="n">ps1</span><span class="p">,</span> <span class="n">ps2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ps1</span> <span class="o">=</span> <span class="n">demo</span><span class="p">(</span><span class="err">â€œ</span><span class="n">hello</span><span class="err">â€</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">ps2</span> <span class="o">=</span> <span class="n">move</span><span class="p">(</span><span class="n">ps1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">ps1</span> <span class="o">=</span> <span class="n">demo</span><span class="p">(</span><span class="err">â€œ</span><span class="n">alexia</span><span class="err">â€</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">ps2</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">ps1</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>shared_ptrå®ç°å…±äº«å¼æ‹¥æœ‰æ¦‚å¿µã€‚</strong><u>å¤šä¸ªæ™ºèƒ½æŒ‡é’ˆå¯ä»¥æŒ‡å‘ç›¸åŒå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å’Œå…¶ç›¸å…³èµ„æºä¼šåœ¨â€œæœ€åä¸€ä¸ªå¼•ç”¨è¢«é”€æ¯â€æ—¶å€™é‡Šæ”¾ã€‚</u>ä»åå­—shareå°±å¯ä»¥çœ‹å‡ºäº†èµ„æºå¯ä»¥è¢«å¤šä¸ªæŒ‡é’ˆå…±äº«ï¼Œå®ƒä½¿ç”¨è®¡æ•°æœºåˆ¶æ¥è¡¨æ˜èµ„æºè¢«å‡ ä¸ªæŒ‡é’ˆå…±äº«ã€‚å¯ä»¥é€šè¿‡æˆå‘˜å‡½æ•°use_count()æ¥æŸ¥çœ‹èµ„æºçš„æ‰€æœ‰è€…ä¸ªæ•°ã€‚é™¤äº†å¯ä»¥é€šè¿‡newæ¥æ„é€ ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¼ å…¥auto_ptr, unique_ptr,weak_ptræ¥æ„é€ ã€‚å½“æˆ‘ä»¬è°ƒç”¨release()æ—¶ï¼Œå½“å‰æŒ‡é’ˆä¼šé‡Šæ”¾èµ„æºæ‰€æœ‰æƒï¼Œè®¡æ•°å‡ä¸€ã€‚å½“è®¡æ•°ç­‰äº0æ—¶ï¼Œèµ„æºä¼šè¢«é‡Šæ”¾ã€‚</p>
<p>shared_ptr æ˜¯ä¸ºäº†è§£å†³ auto_ptr åœ¨å¯¹è±¡æ‰€æœ‰æƒä¸Šçš„å±€é™æ€§(auto_ptr æ˜¯ç‹¬å çš„), åœ¨ä½¿ç”¨å¼•ç”¨è®¡æ•°çš„æœºåˆ¶ä¸Šæä¾›äº†å¯ä»¥å…±äº«æ‰€æœ‰æƒçš„æ™ºèƒ½æŒ‡é’ˆã€‚</p>
<p><strong>æˆå‘˜å‡½æ•°ï¼š</strong></p>
<blockquote>
<p>use_count è¿”å›å¼•ç”¨è®¡æ•°çš„ä¸ªæ•°</br>
unique è¿”å›æ˜¯å¦æ˜¯ç‹¬å æ‰€æœ‰æƒ( use_count ä¸º 1)</br>
swap äº¤æ¢ä¸¤ä¸ª shared_ptr å¯¹è±¡(å³äº¤æ¢æ‰€æ‹¥æœ‰çš„å¯¹è±¡)</br>
reset æ”¾å¼ƒå†…éƒ¨å¯¹è±¡çš„æ‰€æœ‰æƒæˆ–æ‹¥æœ‰å¯¹è±¡çš„å˜æ›´, ä¼šå¼•èµ·åŸæœ‰å¯¹è±¡çš„å¼•ç”¨è®¡æ•°çš„å‡å°‘</br>
get è¿”å›å†…éƒ¨å¯¹è±¡(æŒ‡é’ˆ), ç”±äºå·²ç»é‡è½½äº†()æ–¹æ³•, å› æ­¤å’Œç›´æ¥ä½¿ç”¨å¯¹è±¡æ˜¯ä¸€æ ·çš„.å¦‚ shared_ptrsp(new int(1)); sp ä¸ sp.get()æ˜¯ç­‰ä»·çš„</br></p>
</blockquote>
<p><strong>weak_ptr:</strong></p>
<blockquote>
<p>weak_ptr æ˜¯ä¸€ç§ä¸æ§åˆ¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„æ™ºèƒ½æŒ‡é’ˆ, å®ƒæŒ‡å‘ä¸€ä¸ª shared_ptr ç®¡ç†çš„å¯¹è±¡. è¿›è¡Œè¯¥å¯¹è±¡çš„å†…å­˜ç®¡ç†çš„æ˜¯é‚£ä¸ªå¼ºå¼•ç”¨çš„shared_ptr. weak_ptråªæ˜¯æä¾›äº†å¯¹ç®¡ç†å¯¹è±¡çš„ä¸€ä¸ªè®¿é—®æ‰‹æ®µã€‚</br></br>
weak_ptr è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºé…åˆ shared_ptr è€Œå¼•å…¥çš„ä¸€ç§æ™ºèƒ½æŒ‡é’ˆæ¥ååŠ© shared_ptr å·¥ä½œ, å®ƒåªå¯ä»¥ä»ä¸€ä¸ª shared_ptr æˆ–å¦ä¸€ä¸ª weak_ptr å¯¹è±¡æ„é€ , å®ƒçš„æ„é€ å’Œææ„ä¸ä¼šå¼•èµ·å¼•ç”¨è®°æ•°çš„å¢åŠ æˆ–å‡å°‘ã€‚</br></br>
weak_ptræ˜¯ç”¨æ¥<strong>è§£å†³shared_ptrç›¸äº’å¼•ç”¨æ—¶çš„æ­»é”é—®é¢˜</strong>,å¦‚æœè¯´ä¸¤ä¸ªshared_ptrç›¸äº’å¼•ç”¨,é‚£ä¹ˆè¿™ä¸¤ä¸ªæŒ‡é’ˆçš„å¼•ç”¨è®¡æ•°æ°¸è¿œä¸å¯èƒ½ä¸‹é™ä¸º0,èµ„æºæ°¸è¿œä¸ä¼šé‡Šæ”¾ã€‚å®ƒæ˜¯å¯¹å¯¹è±¡çš„ä¸€ç§å¼±å¼•ç”¨ï¼Œä¸ä¼šå¢åŠ å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œå’Œshared_pträ¹‹é—´å¯ä»¥ç›¸äº’è½¬åŒ–ï¼Œshared_ptrå¯ä»¥ç›´æ¥èµ‹å€¼ç»™å®ƒï¼Œå®ƒå¯ä»¥é€šè¿‡è°ƒç”¨lockå‡½æ•°æ¥è·å¾—shared_ptrã€‚</br></p>
</blockquote>
<div class="highlight" id="id-25"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">B</span><span class="o">&gt;</span> <span class="n">pb_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">~</span><span class="n">A</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;A delete&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">B</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="n">pa_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">~</span><span class="n">B</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;B delete&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">fun</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">B</span><span class="o">&gt;</span> <span class="n">pb</span><span class="p">(</span><span class="k">new</span> <span class="n">B</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="n">pa</span><span class="p">(</span><span class="k">new</span> <span class="n">A</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">pb</span><span class="o">-&gt;</span><span class="n">pa_</span> <span class="o">=</span> <span class="n">pa</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pa</span><span class="o">-&gt;</span><span class="n">pb_</span> <span class="o">=</span> <span class="n">pb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">pb</span><span class="p">.</span><span class="n">use_count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">pa</span><span class="p">.</span><span class="n">use_count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">fun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°funå‡½æ•°ä¸­pa ï¼Œpbä¹‹é—´äº’ç›¸å¼•ç”¨ï¼Œä¸¤ä¸ªèµ„æºçš„å¼•ç”¨è®¡æ•°ä¸º2ï¼Œå½“è¦è·³å‡ºå‡½æ•°æ—¶ï¼Œæ™ºèƒ½æŒ‡é’ˆpaï¼Œpbææ„æ—¶ä¸¤ä¸ªèµ„æºå¼•ç”¨è®¡æ•°ä¼šå‡ä¸€ï¼Œä½†æ˜¯ä¸¤è€…å¼•ç”¨è®¡æ•°è¿˜æ˜¯ä¸º1ï¼Œå¯¼è‡´è·³å‡ºå‡½æ•°æ—¶èµ„æºæ²¡æœ‰è¢«é‡Šæ”¾ï¼ˆA Bçš„ææ„å‡½æ•°æ²¡æœ‰è¢«è°ƒç”¨ï¼‰ï¼Œå¦‚æœæŠŠå…¶ä¸­ä¸€ä¸ªæ”¹ä¸ºweak_ptrå°±å¯ä»¥äº†ï¼Œæˆ‘ä»¬æŠŠç±»Aé‡Œé¢çš„shared_ptr pb_; æ”¹ä¸ºweak_ptr pb_; è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œè¿™æ ·çš„è¯ï¼Œèµ„æºBçš„å¼•ç”¨å¼€å§‹å°±åªæœ‰1ï¼Œå½“pbææ„æ—¶ï¼ŒBçš„è®¡æ•°å˜ä¸º0ï¼ŒBå¾—åˆ°é‡Šæ”¾ï¼ŒBé‡Šæ”¾çš„åŒæ—¶ä¹Ÿä¼šä½¿Açš„è®¡æ•°å‡ä¸€ï¼ŒåŒæ—¶paææ„æ—¶ä½¿Açš„è®¡æ•°å‡ä¸€ï¼Œé‚£ä¹ˆAçš„è®¡æ•°ä¸º0ï¼ŒAå¾—åˆ°é‡Šæ”¾ã€‚</br></p>
<p>æ³¨æ„ï¼šä¸èƒ½é€šè¿‡weak_ptrç›´æ¥è®¿é—®å¯¹è±¡çš„æ–¹æ³•ï¼Œæ¯”å¦‚Bå¯¹è±¡ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•print(),æˆ‘ä»¬ä¸èƒ½è¿™æ ·è®¿é—®ï¼Œpa-&gt;pb_-&gt;print(); è‹±æ–‡pb_æ˜¯ä¸€ä¸ªweak_ptrï¼Œåº”è¯¥å…ˆæŠŠå®ƒè½¬åŒ–ä¸ºshared_ptr,å¦‚ï¼šshared_ptr p = pa-&gt;pb_.lock(); p-&gt;print();</br></p>
<h3 id="43-è¯´è¯´å¼ºåˆ¶ç±»å‹è½¬æ¢è¿ç®—ç¬¦">4.3 è¯´è¯´å¼ºåˆ¶ç±»å‹è½¬æ¢è¿ç®—ç¬¦</h3>
<p><strong>â‘ static_castÂ ç”¨äºéå¤šæ€ç±»å‹çš„è½¬æ¢</strong></p>
<blockquote>
<p>ç”¨äºéå¤šæ€ç±»å‹çš„è½¬æ¢</br>
ä¸æ‰§è¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼ˆè½¬æ¢å®‰å…¨æ€§ä¸å¦‚ dynamic_castï¼‰</br>
é€šå¸¸ç”¨äºè½¬æ¢æ•°å€¼æ•°æ®ç±»å‹ï¼ˆå¦‚ float -&gt; intï¼‰</br>
å¯ä»¥åœ¨æ•´ä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­ç§»åŠ¨æŒ‡é’ˆï¼Œå­ç±»è½¬åŒ–ä¸ºçˆ¶ç±»å®‰å…¨ï¼ˆå‘ä¸Šè½¬æ¢ï¼‰ï¼Œçˆ¶ç±»è½¬åŒ–ä¸ºå­ç±»ä¸å®‰å…¨ï¼ˆå› ä¸ºå­ç±»å¯èƒ½æœ‰ä¸åœ¨çˆ¶ç±»çš„å­—æ®µæˆ–æ–¹æ³•ï¼‰</br></p>
</blockquote>
<p><strong>â‘¡dynamic_castÂ ç”¨äºå¤šæ€ç±»å‹çš„è½¬æ¢</strong></p>
<blockquote>
<p>ç”¨äºå¤šæ€ç±»å‹çš„è½¬æ¢
æ‰§è¡Œè¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥
åªé€‚ç”¨äºæŒ‡é’ˆæˆ–å¼•ç”¨
å¯¹ä¸æ˜ç¡®çš„æŒ‡é’ˆçš„è½¬æ¢å°†å¤±è´¥ï¼ˆè¿”å› nullptrï¼‰ï¼Œä½†ä¸å¼•å‘å¼‚å¸¸
å¯ä»¥åœ¨æ•´ä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­ç§»åŠ¨æŒ‡é’ˆï¼ŒåŒ…æ‹¬å‘ä¸Šè½¬æ¢ã€å‘ä¸‹è½¬æ¢</p>
</blockquote>
<p><strong>â‘¢const_cast</strong></p>
<blockquote>
<p>ç”¨äºåˆ é™¤ constã€volatile å’Œ __unaligned ç‰¹æ€§ï¼ˆå¦‚å°† const int ç±»å‹è½¬æ¢ä¸º int ç±»å‹ ï¼‰</p>
</blockquote>
<p><strong>â‘£reinterpret_cast</strong></p>
<blockquote>
<ul>
<li>ç”¨äºä½çš„ç®€å•é‡æ–°è§£é‡Š</br></li>
<li>æ»¥ç”¨ reinterpret_cast è¿ç®—ç¬¦å¯èƒ½å¾ˆå®¹æ˜“å¸¦æ¥é£é™©ã€‚é™¤éæ‰€éœ€è½¬æ¢æœ¬èº«æ˜¯ä½çº§åˆ«çš„ï¼Œå¦åˆ™åº”ä½¿ç”¨å…¶ä»–å¼ºåˆ¶è½¬æ¢è¿ç®—ç¬¦ä¹‹ä¸€ã€‚</br></li>
<li>å…è®¸å°†ä»»ä½•æŒ‡é’ˆè½¬æ¢ä¸ºä»»ä½•å…¶ä»–æŒ‡é’ˆç±»å‹ï¼ˆå¦‚ char* åˆ° int* æˆ– One_class* åˆ° Unrelated_class* ä¹‹ç±»çš„è½¬æ¢ï¼Œä½†å…¶æœ¬èº«å¹¶ä¸å®‰å…¨ï¼‰
ä¹Ÿå…è®¸å°†ä»»ä½•æ•´æ•°ç±»å‹è½¬æ¢ä¸ºä»»ä½•æŒ‡é’ˆç±»å‹ä»¥åŠåå‘è½¬æ¢ã€‚</br></li>
<li>reinterpret_cast è¿ç®—ç¬¦ä¸èƒ½ä¸¢æ‰ constã€volatile æˆ– __unaligned ç‰¹æ€§ã€‚</br></li>
<li>reinterpret_cast çš„ä¸€ä¸ªå®é™…ç”¨é€”æ˜¯åœ¨å“ˆå¸Œå‡½æ•°ä¸­ï¼Œå³ï¼Œé€šè¿‡è®©ä¸¤ä¸ªä¸åŒçš„å€¼å‡ ä¹ä¸ä»¥ç›¸åŒçš„ç´¢å¼•ç»“å°¾çš„æ–¹å¼å°†å€¼æ˜ å°„åˆ°ç´¢å¼•ã€‚</br></li>
</ul>
</blockquote>
<p><strong>â‘¤bad_cast</strong></p>
<blockquote>
<p>ç”±äºå¼ºåˆ¶è½¬æ¢ä¸ºå¼•ç”¨ç±»å‹å¤±è´¥ï¼Œdynamic_cast è¿ç®—ç¬¦å¼•å‘ bad_cast å¼‚å¸¸ã€‚
bad_cast ä½¿ç”¨:</p>
</blockquote>
<div class="highlight" id="id-26"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Circle</span><span class="o">&amp;</span> <span class="n">ref_circle</span> <span class="o">=</span> <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">Circle</span><span class="o">&amp;&gt;</span><span class="p">(</span><span class="n">ref_shape</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">catch</span> <span class="p">(</span><span class="n">bad_cast</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Caught: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="44-è°ˆè°ˆä½ å¯¹æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦çš„è®¤è¯†">4.4 è°ˆè°ˆä½ å¯¹æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦çš„è®¤è¯†</h3>
<p>æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦é‡è½½æœ‰ä»¥ä¸‹ä¸¤ä¸ªä¸åŒä¹‹å¤„ï¼š</br></p>
<blockquote>
<p>â‘ æ‹·è´æ„é€ å‡½æ•°ç”Ÿæˆæ–°çš„ç±»å¯¹è±¡ï¼Œè€Œèµ‹å€¼è¿ç®—ç¬¦ä¸èƒ½ã€‚</br>
â‘¡ç”±äºæ‹·è´æ„é€ å‡½æ•°æ˜¯ç›´æ¥æ„é€ ä¸€ä¸ªæ–°çš„ç±»å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨åˆå§‹åŒ–è¿™ä¸ªå¯¹ä¹‹å‰ä¸ç”¨æ£€éªŒåŸå¯¹è±¡æ˜¯å¦å’Œæ–°å»ºå¯¹è±¡ç›¸åŒï¼Œè€Œèµ‹å€¼è¿ç®—ç¬¦åˆ™éœ€è¦è¿™ä¸ªæ“ä½œï¼Œ</br>
â‘¢å¦å¤–ï¼Œèµ‹å€¼è¿ç®—ä¸­ï¼Œå¦‚æœåŸæ¥çš„å¯¹è±¡ä¸­æœ‰å†…å­˜åˆ†é…è¦å…ˆæŠŠå†…å­˜é‡Šæ”¾æ‰ã€‚</br>
æ³¨æ„ï¼šå½“æœ‰ç±»ä¸­æœ‰æŒ‡é’ˆç±»å‹çš„æˆå‘˜å˜é‡æ—¶ï¼Œä¸€å®šè¦é‡å†™æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼Œä¸è¦ä½¿ç”¨é»˜è®¤çš„ã€‚</p>
</blockquote>
<h3 id="45-åœ¨cä¸­ä½¿ç”¨mallocç”³è¯·çš„å†…å­˜èƒ½å¦é€šè¿‡deleteé‡Šæ”¾ä½¿ç”¨newç”³è¯·çš„å†…å­˜èƒ½å¦ç”¨free">4.5 åœ¨C++ä¸­ï¼Œä½¿ç”¨mallocç”³è¯·çš„å†…å­˜èƒ½å¦é€šè¿‡deleteé‡Šæ”¾ï¼Ÿä½¿ç”¨newç”³è¯·çš„å†…å­˜èƒ½å¦ç”¨freeï¼Ÿ</h3>
<blockquote>
<p>ä¸èƒ½ï¼Œmalloc /freeä¸»è¦ä¸ºäº†å…¼å®¹Cï¼Œnewå’Œdelete å®Œå…¨å¯ä»¥å–ä»£malloc /freeçš„ã€‚</br>
â‘ malloc /freeçš„æ“ä½œå¯¹è±¡éƒ½æ˜¯å¿…é¡»æ˜ç¡®å¤§å°çš„ã€‚<font color=red>è€Œä¸”ä¸èƒ½ç”¨åœ¨åŠ¨æ€ç±»ä¸Š</font>ã€‚</br>
â‘¡new å’Œdeleteä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹æ£€æŸ¥å’Œå¤§å°ï¼Œmalloc/freeä¸èƒ½æ‰§è¡Œæ„é€ å‡½æ•°ä¸ææ„å‡½æ•°ï¼Œæ‰€ä»¥åŠ¨æ€å¯¹è±¡å®ƒæ˜¯ä¸è¡Œçš„ã€‚</br></p>
</blockquote>
<p>å½“ç„¶ä»ç†è®ºä¸Šè¯´ä½¿ç”¨mallocç”³è¯·çš„å†…å­˜æ˜¯å¯ä»¥é€šè¿‡deleteé‡Šæ”¾çš„ã€‚ä¸è¿‡ä¸€èˆ¬ä¸è¿™æ ·å†™çš„ã€‚è€Œä¸”ä¹Ÿä¸èƒ½ä¿è¯æ¯ä¸ªC++çš„è¿è¡Œæ—¶éƒ½èƒ½æ­£å¸¸ã€‚</p>
<h3 id="46-ç”¨cè®¾è®¡ä¸€ä¸ªä¸èƒ½è¢«ç»§æ‰¿çš„ç±»">4.6 ç”¨C++è®¾è®¡ä¸€ä¸ªä¸èƒ½è¢«ç»§æ‰¿çš„ç±»</h3>
<p>ref: <a href="https://blog.csdn.net/wei_cheng18/article/details/81043858"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/wei_cheng18/article/details/81043858<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<div class="highlight" id="id-27"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">A</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">friend</span> <span class="n">T</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">     <span class="n">A</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="o">~</span><span class="n">A</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">B</span> <span class="o">:</span> <span class="k">virtual</span> <span class="k">public</span> <span class="n">A</span><span class="o">&lt;</span><span class="n">B</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">B</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">   <span class="o">~</span><span class="n">B</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">C</span> <span class="o">:</span> <span class="k">virtual</span> <span class="k">public</span> <span class="n">B</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">     <span class="n">C</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="o">~</span><span class="n">C</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(</span> <span class="kt">void</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">B</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//C c;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼š<font color=red>æ„é€ å‡½æ•°æ˜¯ç»§æ‰¿å®ç°çš„å…³é”®</font>ï¼Œæ¯æ¬¡å­ç±»å¯¹è±¡æ„é€ æ—¶ï¼Œé¦–å…ˆè°ƒç”¨çš„æ˜¯çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œç„¶åæ‰ æ˜¯è‡ªå·±çš„ã€‚</p>
<h3 id="48-è®¿é—®åŸºç±»çš„ç§æœ‰è™šå‡½æ•°">4.8 è®¿é—®åŸºç±»çš„ç§æœ‰è™šå‡½æ•°</h3>
<p>å†™å‡ºä»¥ä¸‹ç¨‹åºçš„è¾“å‡ºç»“æœï¼š</p>
<div class="highlight" id="id-28"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">class</span> <span class="nc">A</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">g</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;A::g&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">virtual</span> <span class="kt">void</span> <span class="n">f</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;A::f&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">B</span> <span class="o">:</span> <span class="k">public</span> <span class="n">A</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="kt">void</span> <span class="nf">g</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;B::g&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">h</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;B::h&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="nf">void</span><span class="p">(</span> <span class="o">*</span><span class="n">Fun</span> <span class="p">)(</span> <span class="kt">void</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="n">B</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="n">Fun</span> <span class="n">pFun</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">pFun</span> <span class="o">=</span> <span class="p">(</span> <span class="n">Fun</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span> <span class="kt">int</span><span class="o">*</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="kt">int</span><span class="o">*</span> <span class="p">)(</span> <span class="o">&amp;</span><span class="n">b</span> <span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">pFun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºç»“æœ:</p>
<div class="highlight" id="id-29"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">B</span><span class="o">::</span><span class="n">g</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span><span class="o">::</span><span class="n">f</span>
</span></span><span class="line"><span class="cl"><span class="n">B</span><span class="o">::</span><span class="n">h</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„ï¼šè€ƒå¯Ÿäº†é¢è¯•è€…å¯¹è™šå‡½æ•°çš„ç†è§£ç¨‹åº¦ã€‚ä¸€ä¸ªå¯¹è™šå‡½æ•°ä¸äº†è§£çš„äººå¾ˆéš¾æ­£ç¡®çš„åšå‡ºæœ¬é¢˜ã€‚ åœ¨å­¦ä¹ é¢å‘å¯¹è±¡çš„å¤šæ€æ€§æ—¶ä¸€å®šè¦æ·±åˆ»ç†è§£è™šå‡½æ•°è¡¨çš„å·¥ä½œåŸç†ã€‚</p>
</blockquote>
<blockquote>
<p>è™šå‡½æ•°ï¼šé€šè¿‡åŸºç±»è®¿é—®æ´¾ç”Ÿç±»å®šä¹‰çš„å‡½æ•°ï¼Œå¤šæ€æ—¶ä½¿ç”¨ï¼Œä½¿ç”¨è™šå‡½æ•°åŠ ä¸Švirtualå…³é”®å­—ã€‚</br>
è™šå‡½æ•°å°±æ˜¯åœ¨åŸºç±»å®šä¹‰ä¸€ä¸ªæœªå®ç°çš„å‡½æ•°åï¼Œä¸ºäº†æé«˜ç¨‹åºçš„å¯è¯»æ€§</br>
<a href="https://blog.csdn.net/weixin_45138932/article/details/125667041"target="_blank" rel="external nofollow noopener noreferrer">è™šå‡½æ•°è¯¦è§£<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>
<a href="https://blog.csdn.net/qq_42048450/article/details/117282640?spm=1001.2014.3001.5502"target="_blank" rel="external nofollow noopener noreferrer">C++è™šå‡½æ•°è¯¦è§£_ç–¯ç‹‚çš„éº¦å…‹æ–¯_maxçš„åšå®¢-CSDNåšå®¢_c++è™šå‡½æ•°<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
</blockquote>
<p><a href="https://blog.csdn.net/weixin_43700340/article/details/89471069"target="_blank" rel="external nofollow noopener noreferrer">è±å½¢ç»§æ‰¿1<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>
<a href="https://blog.csdn.net/Y673789476/article/details/128271855#t9"target="_blank" rel="external nofollow noopener noreferrer">è±å½¢ç»§æ‰¿2<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h3 id="49-å¯¹è™šå‡½æ•°å’Œå¤šæ€çš„ç†è§£">4.9 å¯¹è™šå‡½æ•°å’Œå¤šæ€çš„ç†è§£</h3>
<blockquote>
<p>â‘ å¤šæ€çš„å®ç°ä¸»è¦åˆ†ä¸ºé™æ€å¤šæ€å’ŒåŠ¨æ€å¤šæ€ï¼Œé™æ€å¤šæ€ä¸»è¦æ˜¯é‡è½½ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™å°±å·²ç»ç¡®å®šï¼›åŠ¨æ€å¤šæ€æ˜¯ç”¨è™šå‡½æ•°æœºåˆ¶å®ç°çš„ï¼Œåœ¨è¿è¡ŒæœŸé—´åŠ¨æ€ç»‘å®šã€‚
ä¸¾ä¸ªä¾‹å­: ä¸€ä¸ªçˆ¶ç±»ç±»å‹çš„æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå­ç±»å¯¹è±¡æ—¶å€™ï¼Œä½¿ç”¨çˆ¶ç±»çš„æŒ‡é’ˆå»è°ƒç”¨å­ç±»ä¸­é‡å†™äº†çš„çˆ¶ç±»ä¸­çš„è™šå‡½æ•°çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨å­ç±»é‡å†™è¿‡åçš„å‡½æ•°ï¼Œåœ¨çˆ¶ç±»ä¸­å£°æ˜ä¸ºåŠ äº†virtualå…³é”®å­—çš„å‡½æ•°ï¼Œåœ¨å­ç±»ä¸­é‡å†™æ—¶å€™ä¸éœ€è¦åŠ virtualä¹Ÿæ˜¯è™šå‡½æ•°ã€‚</br>
â‘¡è™šå‡½æ•°çš„å®ç°: åœ¨æœ‰è™šå‡½æ•°çš„ç±»ä¸­ï¼Œç±»çš„æœ€å¼€å§‹éƒ¨åˆ†æ˜¯ä¸€ä¸ªè™šå‡½æ•°è¡¨çš„æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªè™šå‡½æ•°è¡¨ï¼Œè¡¨ä¸­æ”¾äº†è™šå‡½æ•°çš„åœ°å€ï¼Œå®é™…çš„è™šå‡½æ•°åœ¨ä»£ç æ®µ(.text)ä¸­ã€‚å½“å­ç±»ç»§æ‰¿äº†çˆ¶ç±»çš„æ—¶å€™ä¹Ÿä¼šç»§æ‰¿å…¶è™šå‡½æ•°è¡¨ï¼Œå½“å­ç±»é‡å†™çˆ¶ç±»ä¸­è™šå‡½æ•°æ—¶å€™ï¼Œä¼šå°†å…¶ç»§æ‰¿åˆ°çš„è™šå‡½æ•°è¡¨ä¸­çš„åœ°å€æ›¿æ¢ä¸ºé‡æ–°å†™çš„å‡½æ•°åœ°å€ã€‚ä½¿ç”¨äº†è™šå‡½æ•°ï¼Œä¼šå¢åŠ è®¿é—®å†…å­˜å¼€é”€ï¼Œé™ä½æ•ˆç‡ã€‚</br></p>
</blockquote>
<h3 id="410-ç®€è¿°ç±»æˆå‘˜å‡½æ•°çš„é‡å†™overwriteé‡è½½overloadå’Œéšè—çš„åŒºåˆ«">4.10 ç®€è¿°ç±»æˆå‘˜å‡½æ•°çš„é‡å†™(overwrite)ã€é‡è½½(overload)å’Œéšè—çš„åŒºåˆ«</h3>
<p>ï¼ˆ1ï¼‰é‡å†™å’Œé‡è½½ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ä¸åŒã€‚</p>
<blockquote>
<p>â‘ èŒƒå›´çš„åŒºåˆ«ï¼šè¢«é‡å†™çš„å’Œé‡å†™çš„å‡½æ•°åœ¨ä¸¤ä¸ªç±»ä¸­ï¼Œè€Œé‡è½½å’Œè¢«é‡è½½çš„å‡½æ•°åœ¨åŒä¸€ä¸ªç±»ä¸­ã€‚</br>
â‘¡å‚æ•°çš„åŒºåˆ«ï¼šè¢«é‡å†™å‡½æ•°å’Œé‡å†™å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸€å®šç›¸åŒï¼Œè€Œè¢«é‡è½½å‡½æ•°å’Œé‡è½½å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸€å®šä¸åŒã€‚</br>
â‘¢virtualçš„åŒºåˆ«ï¼šé‡å†™çš„åŸºç±»ä¸­è¢«é‡å†™çš„å‡½æ•°å¿…é¡»è¦æœ‰virtualä¿®é¥°ï¼Œè€Œé‡è½½å‡½æ•°å’Œè¢«é‡è½½å‡½æ•°å¯ä»¥è¢«virtualä¿®é¥°ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ã€‚</br></p>
</blockquote>
<p>ï¼ˆ2ï¼‰éšè—å’Œé‡å†™ã€é‡è½½æœ‰ä»¥ä¸‹å‡ ç‚¹ä¸åŒã€‚</p>
<blockquote>
<p>ä¸é‡è½½çš„èŒƒå›´ä¸åŒï¼šå’Œé‡å†™ä¸€æ ·ï¼Œéšè—å‡½æ•°å’Œè¢«éšè—å‡½æ•°ä¸åœ¨åŒä¸€ä¸ªç±»ä¸­ã€‚</br>
å‚æ•°çš„åŒºåˆ«ï¼šéšè—å‡½æ•°å’Œè¢«éšè—çš„å‡½æ•°çš„å‚æ•°åˆ—è¡¨å¯ä»¥ç›¸åŒï¼Œä¹Ÿå¯ä¸åŒï¼Œä½†æ˜¯å‡½æ•°åè‚¯å®šè¦ç›¸åŒã€‚ å½“å‚æ•°ä¸ç›¸åŒæ—¶ï¼Œæ— è®ºåŸºç±»ä¸­çš„å‚æ•°æ˜¯å¦è¢«virtual ä¿®é¥°ï¼ŒåŸºç±»çš„å‡½æ•°éƒ½æ˜¯è¢«éšè—ï¼Œè€Œä¸æ˜¯è¢«é‡å†™ã€‚</br>
æ³¨æ„ï¼šè™½ç„¶é‡è½½å’Œè¦†ç›–éƒ½æ˜¯å®ç°å¤šæ€çš„åŸºç¡€ï¼Œä½†æ˜¯ä¸¤è€…å®ç°çš„æŠ€æœ¯å®Œå…¨ä¸ç›¸åŒï¼Œè¾¾åˆ°çš„ç›®çš„ä¹Ÿæ˜¯å®Œå…¨ä¸åŒçš„ï¼Œè¦†ç›–æ˜¯åŠ¨æ€æ€ç»‘å®šçš„å¤šæ€ï¼Œè€Œé‡è½½æ˜¯é™æ€ç»‘å®šçš„å¤šæ€ã€‚</p>
</blockquote>
<h3 id="411-é“¾è¡¨å’Œæ•°ç»„æœ‰ä»€ä¹ˆåŒºåˆ«">4.11 é“¾è¡¨å’Œæ•°ç»„æœ‰ä»€ä¹ˆåŒºåˆ«</h3>
<p><strong>å­˜å‚¨å½¢å¼:</strong></p>
<blockquote>
<p>æ•°ç»„æ˜¯ä¸€å—è¿ç»­çš„ç©ºé—´ï¼Œå£°æ˜æ—¶å°±è¦ç¡®å®šé•¿åº¦ã€‚</br>
é“¾è¡¨æ˜¯ä¸€å—å¯ä¸è¿ç»­çš„åŠ¨æ€ç©ºé—´ï¼Œ é•¿åº¦å¯å˜ï¼Œæ¯ä¸ªç»“ç‚¹è¦ä¿å­˜ç›¸é‚»ç»“ç‚¹æŒ‡é’ˆã€‚</br></p>
</blockquote>
<p><strong>æ•°æ®æŸ¥æ‰¾:</strong></p>
<blockquote>
<p>æ•°ç»„çš„çº¿æ€§æŸ¥æ‰¾é€Ÿåº¦å¿«ï¼ŒæŸ¥æ‰¾æ“ä½œç›´æ¥ä½¿ç”¨åç§»åœ°å€ã€‚</br>
é“¾è¡¨éœ€è¦æŒ‰é¡ºåºæ£€ç´¢ç»“ç‚¹ï¼Œ æ•ˆç‡ä½ã€‚</br>
æ•°æ®æ’å…¥æˆ–åˆ é™¤ï¼šé“¾è¡¨å¯ä»¥å¿«é€Ÿæ’å…¥å’Œåˆ é™¤ç»“ç‚¹ï¼Œè€Œæ•°ç»„åˆ™å¯èƒ½éœ€è¦å¤§é‡æ•°æ®ç§»åŠ¨ã€‚</br></p>
</blockquote>
<p><strong>è¶Šç•Œé—®é¢˜ï¼š</strong></p>
<blockquote>
<p>é“¾è¡¨ä¸å­˜åœ¨è¶Šç•Œé—®é¢˜ï¼Œæ•°ç»„æœ‰è¶Šç•Œé—®é¢˜ã€‚</p>
</blockquote>
<p><strong>æ³¨æ„ï¼š</strong></p>
<blockquote>
<p>åœ¨é€‰æ‹©æ•°ç»„æˆ–é“¾è¡¨æ•°æ®ç»“æ„æ—¶ï¼Œä¸€å®šè¦æ ¹æ®å®é™…éœ€è¦è¿›è¡Œé€‰æ‹©ã€‚æ•°ç»„ä¾¿äºæŸ¥è¯¢ï¼Œé“¾è¡¨ä¾¿äºæ’å…¥åˆ é™¤ã€‚æ•°ç»„èŠ‚çœç©ºé—´ä½†æ˜¯é•¿åº¦å›ºå®šï¼Œé“¾è¡¨è™½ç„¶å˜é•¿ä½†æ˜¯å äº†æ›´å¤šçš„å­˜å‚¨ç©ºé—´ã€‚</p>
</blockquote>
<h3 id="412-ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—çš„åŠŸèƒ½">4.12 ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—çš„åŠŸèƒ½</h3>
<div class="highlight" id="id-30"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">node</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="n">node</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="n">node</span><span class="p">,</span><span class="o">*</span><span class="n">LinkStack</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//åˆ›å»ºç©ºæ ˆï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">LinkStack</span> <span class="nf">CreateNULLStack</span><span class="p">(</span> <span class="n">LinkStack</span> <span class="o">&amp;</span><span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinkStack</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span> <span class="k">sizeof</span><span class="p">(</span> <span class="n">node</span> <span class="p">)</span> <span class="p">);</span> <span class="c1">// ç”³è¯·æ–°ç»“ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="k">if</span><span class="p">(</span> <span class="nb">NULL</span> <span class="o">==</span> <span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Fail to malloc a new node.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="n">S</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//åˆå§‹åŒ–æ–°ç»“ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//æ ˆçš„æ’å…¥å‡½æ•°ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">LinkStack</span> <span class="nf">Push</span><span class="p">(</span> <span class="n">LinkStack</span> <span class="o">&amp;</span><span class="n">S</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="k">if</span><span class="p">(</span> <span class="nb">NULL</span> <span class="o">==</span> <span class="n">S</span><span class="p">)</span> <span class="c1">//æ£€éªŒæ ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;There no node in stack!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="n">LinkStack</span> <span class="n">p</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">LinkStack</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span> <span class="k">sizeof</span><span class="p">(</span> <span class="n">node</span> <span class="p">)</span> <span class="p">);</span> <span class="c1">// ç”³è¯·æ–°ç»“ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"> <span class="k">if</span><span class="p">(</span> <span class="nb">NULL</span> <span class="o">==</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Fail to malloc a new node.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="k">if</span><span class="p">(</span> <span class="nb">NULL</span> <span class="o">==</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="k">else</span>
</span></span><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="n">p</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span> <span class="c1">//åˆå§‹åŒ–æ–°ç»“ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span> <span class="c1">//æ’å…¥æ–°ç»“ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="k">return</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//å‡ºæ ˆå‡½æ•°ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">node</span> <span class="nf">Pop</span><span class="p">(</span> <span class="n">LinkStack</span> <span class="o">&amp;</span><span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="n">node</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="n">temp</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="n">temp</span><span class="p">.</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="k">if</span><span class="p">(</span> <span class="nb">NULL</span> <span class="o">==</span> <span class="n">S</span><span class="p">)</span> <span class="c1">//æ£€éªŒæ ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;There no node in stack!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="n">temp</span> <span class="o">=</span> <span class="o">*</span><span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="k">if</span><span class="p">(</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;The stack is NULL,can&#39;t pop!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="n">LinkStack</span> <span class="n">p</span> <span class="o">=</span> <span class="n">S</span> <span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span> <span class="c1">//èŠ‚ç‚¹å‡ºæ ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"> <span class="n">S</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">next</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="n">temp</span> <span class="o">=</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="n">free</span><span class="p">(</span> <span class="n">p</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="n">p</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//åŒæ ˆå®ç°é˜Ÿåˆ—çš„å…¥é˜Ÿå‡½æ•°ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">LinkStack</span> <span class="nf">StackToQueuPush</span><span class="p">(</span> <span class="n">LinkStack</span> <span class="o">&amp;</span><span class="n">S</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="n">node</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="n">LinkStack</span> <span class="n">S1</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="n">CreateNULLStack</span><span class="p">(</span> <span class="n">S1</span> <span class="p">);</span> <span class="c1">//åˆ›å»ºç©ºæ ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"> <span class="k">while</span><span class="p">(</span> <span class="nb">NULL</span> <span class="o">!=</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">next</span> <span class="p">)</span> <span class="c1">//S å‡ºæ ˆå…¥S1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="n">Pop</span><span class="p">(</span> <span class="n">S</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Push</span><span class="p">(</span> <span class="n">S1</span><span class="p">,</span> <span class="n">n</span><span class="p">.</span><span class="n">data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="n">Push</span><span class="p">(</span> <span class="n">S1</span><span class="p">,</span> <span class="n">data</span> <span class="p">);</span> <span class="c1">//æ–°ç»“ç‚¹å…¥æ ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"> <span class="k">while</span><span class="p">(</span> <span class="nb">NULL</span> <span class="o">!=</span> <span class="n">S1</span><span class="o">-&gt;</span><span class="n">next</span> <span class="p">)</span> <span class="c1">//S1 å‡ºæ ˆå…¥S
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="n">Pop</span><span class="p">(</span> <span class="n">S1</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Push</span><span class="p">(</span> <span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">.</span><span class="n">data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼šç”¨ä¸¤ä¸ªæ ˆèƒ½å¤Ÿå®ç°ä¸€ä¸ªé˜Ÿåˆ—çš„åŠŸèƒ½ï¼Œé‚£ç”¨ä¸¤ä¸ªé˜Ÿåˆ—èƒ½å¦å®ç°ä¸€ä¸ªé˜Ÿåˆ—çš„åŠŸèƒ½å‘¢ï¼Ÿç»“æœæ˜¯å¦å®šçš„ï¼Œå› ä¸ºæ ˆæ˜¯å…ˆè¿›åå‡ºï¼Œå°†ä¸¤ä¸ªæ ˆè¿åœ¨ä¸€èµ·ï¼Œå°±æ˜¯å…ˆè¿›å…ˆå‡ºã€‚è€Œé˜Ÿåˆ—æ˜¯ç°å…ˆè¿›å…ˆå‡ºï¼Œæ— è®ºå¤šå°‘ä¸ªè¿åœ¨ä¸€èµ·éƒ½æ˜¯å…ˆè¿›å…ˆå‡ºï¼Œè€Œæ— æ³•å®ç°å…ˆè¿›åå‡ºã€‚</p>
<h3 id="413-å…±äº«æ•°æ®çš„ä¿æŠ¤">4.13 å…±äº«æ•°æ®çš„ä¿æŠ¤</h3>
<p>â‘ å¸¸å¼•ç”¨ï¼šä½¿æ‰€å¼•ç”¨çš„å½¢å‚ä¸èƒ½è¢«æ›´æ–°</p>
<div class="highlight" id="id-31"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">display</span><span class="p">(</span><span class="k">const</span> <span class="kt">double</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>â‘¡å¸¸å¯¹è±¡ï¼šåœ¨ç”Ÿå­˜æœŸå†…ä¸èƒ½è¢«æ›´æ–°ï¼Œä½†å¿…é¡»è¢«åˆå§‹åŒ–</p>
<div class="highlight" id="id-32"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">A</span> <span class="k">const</span> <span class="nf">a</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>â‘¢å¸¸æˆå‘˜å‡½æ•°ï¼š
ä¸èƒ½ä¿®æ”¹å¯¹è±¡ä¸­æ•°æ®æˆå‘˜ï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ç±»ä¸­æ²¡æœ‰è¢«const ä¿®é¥°çš„æˆå‘˜å‡½æ•°ï¼ˆå¸¸å¯¹è±¡å”¯ä¸€çš„å¯¹å¤–æ¥å£ï¼‰.å¦‚æœå£°æ˜äº†ä¸€ä¸ªå¸¸å¯¹è±¡ï¼Œåˆ™è¯¥å¯¹è±¡åªèƒ½è°ƒç”¨ä»–çš„å¸¸å‡½æ•°ï¼-&gt;å¯ä»¥ç”¨äºå¯¹é‡è½½å‡½æ•°çš„åŒºåˆ†;</p>
<div class="highlight" id="id-33"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">print</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">print</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>â‘£extern int a:ä½¿å…¶ä»–æ–‡ä»¶ä¹Ÿèƒ½è®¿é—®è¯¥å˜é‡
å£°æ˜ä¸€ä¸ªå‡½æ•°æˆ–å®šä¹‰å‡½æ•°æ—¶ï¼Œå† ä»¥staticçš„è¯ï¼Œå‡½æ•°çš„ä½œç”¨åŸŸå°±è¢«é™åˆ¶åœ¨äº†å½“å‰ç¼–è¯‘å•å…ƒï¼Œå½“å‰ç¼–è¯‘å•å…ƒå†…ä¹Ÿå¿…é¡»åŒ…å«å‡½æ•°çš„å®šä¹‰ï¼Œä¹Ÿåªåœ¨å…¶ç¼–è¯‘å•å…ƒå¯è§ï¼Œå…¶ä»–å•å…ƒä¸èƒ½è°ƒç”¨è¿™ä¸ªå‡½æ•°(æ¯ä¸€ä¸ªcpp æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªç¼–è¯‘å•å…ƒ)ã€‚</p>
<h3 id="414-ç¨‹åºå†…å­˜åˆ†é…æ–¹å¼ä»¥åŠå®ƒä»¬çš„åŒºåˆ«">4.14 ç¨‹åºå†…å­˜åˆ†é…æ–¹å¼ä»¥åŠå®ƒä»¬çš„åŒºåˆ«</h3>
<p>å†…å­˜åˆ†é…å¤§è‡´ä¸Šå¯ä»¥åˆ†æˆ5å—ï¼š</p>
<blockquote>
<p><strong>æ ˆåŒºï¼ˆstackï¼‰</strong></br>
æ ˆï¼Œå°±æ˜¯é‚£äº›ç”±ç¼–è¯‘å™¨åœ¨éœ€è¦æ—¶åˆ†é…ï¼Œåœ¨ä¸éœ€è¦çš„æ—¶å€™è‡ªåŠ¨æ¸…é™¤çš„å˜é‡çš„å­˜å‚¨åŒºã€‚é‡Œé¢çš„å˜é‡é€šå¸¸æ˜¯<u>å±€éƒ¨å˜é‡</u>ã€<u>å‡½æ•°å‚æ•°</u>ç­‰ã€‚ï¼ˆç”±ç¼–è¯‘å™¨ç®¡ç†ï¼‰</br>
<strong>å †åŒºï¼ˆheapï¼‰</strong></br>
ä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…ã€é‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾ï¼Œç¨‹åºç»“æŸæ—¶å¯èƒ½ç”±ç³»ç»Ÿå›æ”¶ã€‚æ³¨æ„ï¼Œå®ƒä¸æ•°æ®ç»“æ„ä¸­çš„å †æ˜¯ä¸¤å›äº‹ï¼Œåˆ†é…æ–¹å¼ç±»ä¼¼äºé“¾è¡¨ã€‚</br>
<strong>å…¨å±€åŒºï¼ˆé™æ€åŒºï¼‰ï¼ˆstaticï¼‰</strong></br>
å…¨å±€å˜é‡å’Œé™æ€å˜é‡è¢«åˆ†é…åˆ°åŒä¸€å—å†…å­˜ä¸­ã€‚ç¨‹åºç»“æŸåç”±ç³»ç»Ÿé‡Šæ”¾ã€‚</br>
<strong>å¸¸é‡å­˜å‚¨åŒº</strong></br>
å¸¸é‡å­—ç¬¦ä¸²å°±æ˜¯æ”¾åœ¨è¿™é‡Œçš„ï¼Œä¸å…è®¸ä¿®æ”¹ï¼Œç¨‹åºç»“æŸåç”±ç³»ç»Ÿé‡Šæ”¾ã€‚</br>
<strong>ç¨‹åºä»£ç åŒº</strong></br>
å­˜æ”¾å‡½æ•°ä½“çš„äºŒè¿›åˆ¶ä»£ç ã€‚</br></p>
</blockquote>
<p>C++ç¨‹åºåœ¨æ‰§è¡Œæ—¶ï¼Œå°†å†…å­˜å¤§æ–¹å‘åˆ’åˆ†ä¸º4ä¸ªåŒºåŸŸ:</p>
<blockquote>
<p>ç¨‹åºè¿è¡Œå‰</p>
<blockquote>
<ul>
<li>ä»£ç åŒºï¼šå­˜æ”¾å‡½æ•°ä½“çš„äºŒè¿›åˆ¶ä»£ç ï¼Œç”±æ“ä½œç³»ç»Ÿè¿›è¡Œç®¡ç†çš„</br></li>
<li>å…¨å±€åŒºï¼šå­˜æ”¾å…¨å±€å˜é‡å’Œé™æ€å˜é‡ä»¥åŠå¸¸é‡</br></li>
</ul>
</blockquote>
</blockquote>
<blockquote>
<p>ç¨‹åºè¿è¡Œå</p>
<blockquote>
<ul>
<li>æ ˆåŒºï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾, å­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼,å±€éƒ¨å˜é‡ç­‰</br></li>
<li>å †åŒºï¼šç”±ç¨‹åºå‘˜åˆ†é…å’Œé‡Šæ”¾,è‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾,ç¨‹åºç»“æŸæ—¶ç”±æ“ä½œç³»ç»Ÿå›æ”¶</br></li>
</ul>
</blockquote>
</blockquote>
<p>å†…å­˜å››åŒºæ„ä¹‰ï¼š</p>
<blockquote>
<p>ä¸åŒåŒºåŸŸå­˜æ”¾çš„æ•°æ®ï¼Œèµ‹äºˆä¸åŒçš„ç”Ÿå‘½å‘¨æœŸ, ç»™æˆ‘ä»¬æ›´å¤§çš„çµæ´»ç¼–ç¨‹</p>
</blockquote>
<h3 id="415-explicit">4.15 explicit</h3>
<p>å‡½æ•°å£°æ˜æ—¶åŠ ä¸Šexplicitå¯ä»¥<u>é˜»æ­¢å‡½æ•°å‚æ•°è¢«éšå¼è½¬æ¢</u>ã€‚</p>
<div class="highlight" id="id-34"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">    <span class="n">Class</span> <span class="n">A</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="k">explicit</span> <span class="nf">A</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="n">A</span> <span class="n">a1</span><span class="o">=</span><span class="mi">12</span><span class="p">;</span>   <span class="c1">//ä¸åŠ explicitæ—¶ä¼šè¢«éšå¼è½¬æ¢ä½ A a1=A(12);åŠ äº†æ­¤æ—¶ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¢«å£°æ˜ä¸ºexplicitçš„æ„é€ å‡½æ•°é€šå¸¸æ¯”non-explicit å‡½æ•°æ›´å—æ¬¢è¿ã€‚</p>
<h3 id="416-mutableå…³é”®å­—">4.16 mutableå…³é”®å­—</h3>
<blockquote>
<p>mutableçš„ä¸­æ–‡æ„æ€æ˜¯â€œå¯å˜çš„ï¼Œæ˜“å˜çš„â€ï¼Œè·Ÿconstantï¼ˆæ—¢C++ä¸­çš„constï¼‰æ˜¯åä¹‰è¯ã€‚åœ¨C++ä¸­ï¼Œmutableä¹Ÿæ˜¯ä¸ºäº†çªç ´constçš„é™åˆ¶è€Œè®¾ç½®çš„ã€‚</br>
è¢«mutableä¿®é¥°çš„å˜é‡(mutableåªèƒ½ç”¨äºä¿®é¥°ç±»çš„éé™æ€æ•°æ®æˆå‘˜)ï¼Œå°†æ°¸è¿œå¤„äºå¯å˜çš„çŠ¶æ€ï¼Œå³ä½¿åœ¨ä¸€ä¸ªconstå‡½æ•°ä¸­ã€‚</br>
æˆ‘ä»¬çŸ¥é“ï¼Œå‡å¦‚ç±»çš„æˆå‘˜å‡½æ•°ä¸ä¼šæ”¹å˜å¯¹è±¡çš„çŠ¶æ€ï¼Œé‚£ä¹ˆè¿™ä¸ªæˆå‘˜å‡½æ•°ä¸€èˆ¬ä¼šå£°æ˜ä¸ºconstã€‚ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬<font color=purple>éœ€è¦åœ¨constçš„å‡½æ•°é‡Œé¢ä¿®æ”¹ä¸€äº›è·Ÿç±»çŠ¶æ€æ— å…³çš„æ•°æ®æˆå‘˜ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®æˆå‘˜å°±åº”è¯¥è¢«mutalbeæ¥ä¿®é¥°</font>ã€‚ï¼ˆä½¿ç”¨mutableä¿®é¥°çš„æ•°æ®æˆå‘˜å¯ä»¥è¢«constæˆå‘˜å‡½æ•°ä¿®æ”¹ï¼‰ã€‚</br></p>
</blockquote>
<h3 id="417-ç”¨constä¿®é¥°å‡½æ•°çš„è¿”å›å€¼">4.17 ç”¨constä¿®é¥°å‡½æ•°çš„è¿”å›å€¼</h3>
<p>å¦‚æœç»™ä»¥â€œæŒ‡é’ˆä¼ é€’â€æ–¹å¼çš„å‡½æ•°è¿”å›å€¼åŠ constä¿®é¥°ï¼Œé‚£ä¹ˆå‡½æ•°è¿”å›å€¼ï¼ˆå³æŒ‡é’ˆï¼‰çš„å†…å®¹ä¸èƒ½è¢«ä¿®æ”¹ï¼Œè¯¥è¿”å›å€¼åªèƒ½è¢«èµ‹ç»™åŠ constä¿®é¥°çš„åŒç±»å‹æŒ‡é’ˆã€‚ä¾‹å¦‚å‡½æ•°ï¼š</p>
<div class="highlight" id="id-35"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="nf">GetString</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// å¦‚ä¸‹è¯­å¥å°†å‡ºç°ç¼–è¯‘é”™è¯¯ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span><span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">GetString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// æ­£ç¡®çš„ç”¨æ³•æ˜¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span><span class="n">GetString</span><span class="p">();</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="418-å®constå’Œenum">4.18 å®ã€constå’Œenum</h3>
<blockquote>
<p>#defineä¸è¢«è§†ä¸ºè¯­è¨€çš„ä¸€éƒ¨åˆ†ã€‚å¯¹äºå•çº¯å¸¸é‡ï¼Œæœ€å¥½ç”¨constå¯¹è±¡æˆ–è€…enumæ›¿æ¢#defineã€‚</br>
å¯¹äºç±»ä¼¼å‡½æ•°çš„å®ï¼Œå°½é‡ä½¿ç”¨å†…è”å‡½æ•°inlineæ›¿æ¢æ‰#define</br>
enumæšä¸¾ç±»å‹æ˜¯è¢«å½“åš int æˆ–è€… unsigned int ç±»å‹æ¥å¤„ç†çš„ã€‚</br></p>
</blockquote>
<h3 id="419-stackçš„ç”Ÿå­˜æœŸ">4.19 stackçš„ç”Ÿå­˜æœŸ</h3>
<blockquote>
<p>â‘ C++ä¸­çš„staticå¯¹è±¡æ˜¯æŒ‡å­˜å‚¨åŒºä¸å±äºstackå’Œheapã€&ldquo;å¯¿å‘½&quot;ä»è¢«æ„é€ å‡ºæ¥ç›´è‡³ç¨‹åºç»“æŸä¸ºæ­¢çš„å¯¹è±¡ã€‚</br>
â‘¡è¿™äº›å¯¹è±¡åŒ…æ‹¬å…¨å±€å¯¹è±¡ï¼Œå®šä¹‰äºnamespaceä½œç”¨åŸŸçš„å¯¹è±¡ï¼Œåœ¨classã€functionä»¥åŠfileä½œç”¨åŸŸä¸­è¢«å£°æ˜ä¸ºstaticçš„å¯¹è±¡ã€‚</br>
â‘¢å…¶ä¸­ï¼Œå‡½æ•°å†…çš„staticå¯¹è±¡ç§°ä¸ºlocal staticå¯¹è±¡ï¼Œè€Œå…¶å®ƒstaticå¯¹è±¡ç§°ä¸ºnon-local staticå¯¹è±¡ã€‚</br></p>
</blockquote>
<p>è¿™ä¸¤è€…åœ¨ä½•æ—¶è¢«åˆå§‹åŒ–(æ„é€ )è¿™ä¸ªé—®é¢˜ä¸Šå­˜åœ¨ç»†å¾®çš„å·®åˆ«ï¼š</p>
<blockquote>
<p>â‘ å¯¹äºlocal staticå¯¹è±¡ï¼Œåœ¨å…¶æ‰€å±çš„å‡½æ•°è¢«è°ƒç”¨ä¹‹å‰ï¼Œè¯¥å¯¹è±¡å¹¶ä¸å­˜åœ¨ï¼Œå³åªæœ‰åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨å¯¹åº”å‡½æ•°æ—¶ï¼Œlocal staticå¯¹è±¡æ‰è¢«æ„é€ å‡ºæ¥ã€‚</br>
â‘¡è€Œå¯¹äºnon-local staticå¯¹è±¡ï¼Œåœ¨main()å‡½æ•°å¼€å§‹å‰å°±å·²ç»è¢«æ„é€ å‡ºæ¥ï¼Œå¹¶åœ¨main()å‡½æ•°ç»“æŸåè¢«ææ„ã€‚</br></p>
</blockquote>
<p>&lt;/font color=red&gt;å»ºè®®ï¼š</font></p>
<blockquote>
<p>1.å¯¹å†…ç½®å¯¹è±¡è¿›è¡Œæ‰‹å·¥åˆå§‹åŒ–ï¼Œå› ä¸ºC++ä¸ä¿è¯åˆå§‹åŒ–å®ƒä»¬ã€‚</br>
2.æ„é€ å‡½æ•°æœ€å¥½ä½¿ç”¨æˆå‘˜åˆå€¼åˆ—ï¼Œè€Œä¸è¦åœ¨æ„é€ å‡½æ•°æœ¬ä½“ä¸­ä½¿ç”¨èµ‹å€¼æ“ä½œã€‚åˆå€¼åˆ—ä¸­åˆ—å‡ºçš„æˆå‘˜å˜é‡ï¼Œå…¶æ’åºæ¬¡åºåº”è¯¥å’Œå®ƒä»¬åœ¨classä¸­çš„å£°æ˜æ¬¡åºç›¸åŒ(åˆå§‹åŒ–é¡ºåºä¸å£°æ˜å˜é‡é¡ºåºä¸€è‡´)ã€‚</br>
3.ä¸ºå…é™¤â€œè·¨ç¼–è¯‘å•å…ƒçš„åˆå§‹åŒ–æ¬¡åºé—®é¢˜â€ï¼Œå°½é‡ä»¥local staticå¯¹è±¡æ›¿æ¢non-local staticå¯¹è±¡ã€‚</br></p>
</blockquote>
<h3 id="420-å…¨å±€å˜é‡å’Œstaticå˜é‡çš„åŒºåˆ«">4.20 å…¨å±€å˜é‡å’Œstaticå˜é‡çš„åŒºåˆ«</h3>
<blockquote>
<p>â‘ å…¨å±€å˜é‡æœ¬èº«å°±æ˜¯é™æ€å­˜å‚¨æ–¹å¼ï¼Œ é™æ€å…¨å±€å˜é‡å½“ç„¶ä¹Ÿæ˜¯é™æ€å­˜å‚¨æ–¹å¼ã€‚ è¿™ä¸¤è€…åœ¨å­˜å‚¨æ–¹å¼ä¸Šå¹¶æ— ä¸åŒã€‚</br>
â‘¡è¿™ä¸¤è€…çš„åŒºåˆ«åœ¨äºéé™æ€å…¨å±€å˜é‡çš„ä½œç”¨åŸŸæ˜¯æ•´ä¸ªæºç¨‹åºï¼Œ å½“ä¸€ä¸ªæºç¨‹åºç”±å¤šä¸ªæºæ–‡ä»¶ç»„æˆæ—¶ï¼Œéé™æ€çš„å…¨å±€å˜é‡åœ¨å„ä¸ªæºæ–‡ä»¶ä¸­éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚</br>
â‘¢è€Œé™æ€å…¨å±€å˜é‡åˆ™é™åˆ¶äº†å…¶ä½œç”¨åŸŸï¼Œ å³åªåœ¨å®šä¹‰è¯¥å˜é‡çš„æºæ–‡ä»¶å†…æœ‰æ•ˆï¼Œ åœ¨åŒä¸€æºç¨‹åºçš„å…¶å®ƒæºæ–‡ä»¶ä¸­ä¸èƒ½ä½¿ç”¨å®ƒã€‚</br>
â‘£ç”±äºé™æ€å…¨å±€å˜é‡çš„ä½œç”¨åŸŸå±€é™äºä¸€ä¸ªæºæ–‡ä»¶å†…ï¼Œåªèƒ½ä¸ºè¯¥æºæ–‡ä»¶å†…çš„å‡½æ•°å…¬ç”¨ï¼Œ å› æ­¤å¯ä»¥é¿å…åœ¨å…¶å®ƒæºæ–‡ä»¶ä¸­å¼•èµ·é”™è¯¯ã€‚</br></p>
</blockquote>
<h2 id="5-åŸºç¡€çŸ¥è¯†äº”">5 åŸºç¡€çŸ¥è¯†ï¼ˆäº”ï¼‰</h2>
<h3 id="51-ä¸ºä»€ä¹ˆæ ˆè¦æ¯”å †é€Ÿåº¦è¦å¿«">5.1 ä¸ºä»€ä¹ˆæ ˆè¦æ¯”å †é€Ÿåº¦è¦å¿«</h3>
<blockquote>
<p>â‘ é¦–å…ˆ, æ ˆæ˜¯æœ¬ç€LIFOåŸåˆ™çš„å­˜å‚¨æœºåˆ¶, å¯¹æ ˆæ•°æ®çš„å®šä½ç›¸å¯¹æ¯”è¾ƒå¿«é€Ÿ, è€Œå †åˆ™æ˜¯éšæœºåˆ†é…çš„ç©ºé—´, å¤„ç†çš„æ•°æ®æ¯”è¾ƒå¤š, æ— è®ºå¦‚ä½•, è‡³å°‘è¦ä¸¤æ¬¡å®šä½.
â‘¡å…¶æ¬¡, æ ˆæ˜¯ç”±CPUæä¾›æŒ‡ä»¤æ”¯æŒçš„, åœ¨æŒ‡ä»¤çš„å¤„ç†é€Ÿåº¦ä¸Š, å¯¹æ ˆæ•°æ®è¿›è¡Œå¤„ç†çš„é€Ÿåº¦è‡ªç„¶è¦ä¼˜äºç”±æ“ä½œç³»ç»Ÿæ”¯æŒçš„å †æ•°æ®.
â‘¢å†è€…, æ ˆæ˜¯åœ¨ä¸€çº§ç¼“å­˜ä¸­åšç¼“å­˜çš„, è€Œå †åˆ™æ˜¯åœ¨äºŒçº§ç¼“å­˜ä¸­, ä¸¤è€…åœ¨ç¡¬ä»¶æ€§èƒ½ä¸Šå·®å¼‚å·¨å¤§.
æœ€å, å„è¯­è¨€å¯¹æ ˆçš„ä¼˜åŒ–æ”¯æŒè¦ä¼˜äºå¯¹å †çš„æ”¯æŒ, æ¯”å¦‚swiftè¯­è¨€ä¸­, ä¸‰ä¸ªå­—åŠä»¥å†…çš„structç»“æ„, å¯ä»¥åœ¨æ ˆä¸­å†…è”, ä»è€Œè¾¾åˆ°æ›´å¿«çš„å¤„ç†é€Ÿåº¦.</p>
</blockquote>
<h3 id="52-c-ææ„å‡½æ•°è°ƒç”¨æ—¶é—´">5.2 c++ ææ„å‡½æ•°è°ƒç”¨æ—¶é—´</h3>
<blockquote>
<p>å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸï¼Œè¢«é”€æ¯æ—¶
deleteæŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆæ—¶ï¼Œæˆ–deleteæŒ‡å‘å¯¹è±¡çš„åŸºç±»ç±»å‹æŒ‡é’ˆï¼Œè€Œå…¶åŸºç±»ææ„å‡½æ•°æ˜¯è™šå‡½æ•°æ—¶
å¯¹è±¡iæ˜¯å¯¹è±¡oçš„æˆå‘˜ï¼Œoçš„ææ„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå¯¹è±¡içš„ææ„å‡½æ•°ä¹Ÿè¢«è°ƒç”¨</p>
</blockquote>
<h3 id="53-é™æ€ç»‘å®š-åŠ¨æ€ç»‘å®š-ä¹Ÿå«åŠ¨æ€è¿ç¼–é™æ€è¿ç¼–">5.3 é™æ€ç»‘å®š åŠ¨æ€ç»‘å®š ï¼ˆä¹Ÿå«åŠ¨æ€è¿ç¼–ï¼Œé™æ€è¿ç¼–ï¼‰</h3>
<blockquote>
<p>å¦‚æœçˆ¶ç±»ä¸­å­˜åœ¨æœ‰è™šå‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¾¿ä¼šä¸ºä¹‹ç”Ÿæˆè™šè¡¨ï¼ˆå±äºç±»ï¼‰ä¸è™šæŒ‡é’ˆï¼ˆå±äºæŸä¸ªå¯¹è±¡ï¼‰ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ ¹æ®è™šæŒ‡é’ˆçš„æŒ‡å‘ï¼Œæ¥å†³å®šè°ƒç”¨å“ªä¸ªè™šå‡½æ•°ï¼Œè¿™ç§°ä¹‹ä¸åŠ¨æ€ç»‘å®šï¼Œä¸ä¹‹ç›¸å¯¹çš„æ˜¯é™æ€ç»‘å®šï¼Œé™æ€ç»‘å®šåœ¨ç¼–è¯‘æœŸå°±å†³å®šäº†ã€‚</p>
</blockquote>
<p>classå’Œtemplateéƒ½æ”¯æŒæ¥å£ä¸å¤šæ€ï¼›
â‘ å¯¹classesè€Œè¨€ï¼Œæ¥å£æ˜¯æ˜¾å¼çš„ï¼Œä»¥å‡½æ•°ç­¾åä¸ºä¸­å¿ƒã€‚å¤šæ€åˆ™æ˜¯é€šè¿‡virtualå‡½æ•°(è™šå‡½æ•°)å‘ç”Ÿäºè¿è¡ŒæœŸï¼›
â‘¡å¯¹templateå‚æ•°è€Œè¨€ï¼Œæ¥å£æ˜¯éšå¼çš„ï¼Œå¥ åŸºäºæœ‰æ•ˆè¡¨è¾¾å¼ã€‚å¤šæ€åˆ™æ˜¯é€šè¿‡templateå…·ç°åŒ–å’Œå‡½æ•°é‡è½½è§£æå‘ç”Ÿäºç¼–è¯‘æœŸã€‚
<strong>æ³›å‹</strong>
æ³›å‹æ˜¯é€šè¿‡å‚æ•°åŒ–ç±»å‹æ¥å®ç°åœ¨åŒä¸€ä»½ä»£ç ä¸Šæ“ä½œå¤šç§æ•°æ®ç±»å‹ã€‚åˆ©ç”¨â€œå‚æ•°åŒ–ç±»å‹â€å°†ç±»å‹æŠ½è±¡åŒ–ï¼Œä»è€Œå®ç°çµæ´»çš„å¤ç”¨ã€‚</p>
<h3 id="54-cè¯­è¨€çš„æŒ‡é’ˆå’Œcçš„å¼•ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«">5.4 Cè¯­è¨€çš„æŒ‡é’ˆå’Œc++çš„å¼•ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<blockquote>
<ul>
<li>æŒ‡é’ˆæœ‰è‡ªå·±çš„ä¸€å—ç©ºé—´ï¼ŒæŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œåªä¸è¿‡è¿™ä¸ªå˜é‡å­˜å‚¨çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼ŒæŒ‡å‘å†…å­˜çš„ä¸€ä¸ªå­˜å‚¨å•å…ƒï¼Œå³æŒ‡é’ˆæ˜¯ä¸€ä¸ªå®ä½“ã€‚è€Œå¼•ç”¨åªæ˜¯ä¸€ä¸ªåˆ«åï¼›</br></li>
<li>ä½¿ç”¨sizeofçœ‹ä¸€ä¸ªæŒ‡é’ˆçš„å¤§å°æ˜¯4ï¼Œè€Œå¼•ç”¨åˆ™æ˜¯è¢«å¼•ç”¨å¯¹è±¡çš„å¤§å°ï¼›</br></li>
<li>æŒ‡é’ˆå¯ä»¥è¢«åˆå§‹åŒ–ä¸ºNULLï¼Œè€Œå¼•ç”¨å¿…é¡»è¢«åˆå§‹åŒ–ä¸”å¿…é¡»æ˜¯ä¸€ä¸ªå·²æœ‰å¯¹è±¡çš„å¼•ç”¨ï¼›</br></li>
<li>ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ï¼ŒæŒ‡é’ˆéœ€è¦è¢«è§£å¼•ç”¨æ‰å¯ä»¥å¯¹å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œè€Œç›´æ¥å¯¹å¼•ç”¨çš„ä¿®æ”¹éƒ½ä¼šæ”¹å˜å¼•ç”¨æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼›</br></li>
</ul>
</blockquote>
<h3 id="55-è¯·ä½ è¯´è¯´cè¯­è¨€æ˜¯æ€ä¹ˆè¿›è¡Œå‡½æ•°è°ƒç”¨çš„">5.5 è¯·ä½ è¯´è¯´Cè¯­è¨€æ˜¯æ€ä¹ˆè¿›è¡Œå‡½æ•°è°ƒç”¨çš„</h3>
<blockquote>
<p>æ¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨éƒ½ä¼šåˆ†é…å‡½æ•°æ ˆï¼Œåœ¨æ ˆå†…è¿›è¡Œå‡½æ•°æ‰§è¡Œè¿‡ç¨‹ã€‚è°ƒç”¨å‰ï¼Œå…ˆæŠŠè¿”å›åœ°å€å‹æ ˆï¼Œç„¶åæŠŠå½“å‰å‡½æ•°çš„espæŒ‡é’ˆå‹æ ˆã€‚ï¼ˆESPï¼ˆExtended Stack Pointerï¼‰ä¸ºæ‰©å±•æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œæ˜¯æŒ‡é’ˆå¯„å­˜å™¨çš„ä¸€ç§ï¼Œç”¨äºå­˜æ”¾å‡½æ•°æ ˆé¡¶æŒ‡é’ˆï¼‰</br></p>
</blockquote>
<p>Cè¯­è¨€å‚æ•°å‹æ ˆé¡ºåºï¼Ÿï¼šä»å³åˆ°å·¦</p>
<h3 id="56-cä¸­æ‹·è´èµ‹å€¼å‡½æ•°çš„å½¢å‚èƒ½å¦è¿›è¡Œå€¼ä¼ é€’">5.6 C++ä¸­æ‹·è´èµ‹å€¼å‡½æ•°çš„å½¢å‚èƒ½å¦è¿›è¡Œå€¼ä¼ é€’ï¼Ÿ</h3>
<p>ä¸èƒ½ã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œé¦–å…ˆè¦å°†å®å‚ä¼ é€’ç»™å½¢å‚ï¼Œè¿™ä¸ªä¼ é€’çš„æ—¶å€™åˆè¦è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°(aa = ex.aa; //æ­¤å¤„è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°)ã€‚å¦‚æ­¤å¾ªç¯ï¼Œæ— æ³•å®Œæˆæ‹·è´ï¼Œæ ˆä¹Ÿä¼šæ»¡ã€‚</p>
<h3 id="57-includeå¤´æ–‡ä»¶çš„é¡ºåºä»¥åŠåŒå¼•å·å’Œå°–æ‹¬å·çš„åŒºåˆ«">5.7 includeå¤´æ–‡ä»¶çš„é¡ºåºä»¥åŠåŒå¼•å·â€â€å’Œå°–æ‹¬å·&lt;&gt;çš„åŒºåˆ«</h3>
<p>ç¼–è¯‘å™¨é¢„å¤„ç†é˜¶æ®µæŸ¥æ‰¾å¤´æ–‡ä»¶çš„è·¯å¾„ä¸ä¸€æ ·</p>
<blockquote>
<p>ä½¿ç”¨åŒå¼•å·åŒ…å«çš„å¤´æ–‡ä»¶ï¼ŒæŸ¥æ‰¾å¤´æ–‡ä»¶è·¯å¾„çš„é¡ºåºä¸ºï¼š
â‘ å½“å‰å¤´æ–‡ä»¶ç›®å½•
â‘¡ç¼–è¯‘å™¨è®¾ç½®çš„å¤´æ–‡ä»¶è·¯å¾„ï¼ˆç¼–è¯‘å™¨å¯ä½¿ç”¨-Iæ˜¾å¼æŒ‡å®šæœç´¢è·¯å¾„ï¼‰
â‘¢ç³»ç»Ÿå˜é‡CPLUS_INCLUDE_PATH/C_INCLUDE_PATHæŒ‡å®šçš„å¤´æ–‡ä»¶è·¯å¾„
å¯¹äºä½¿ç”¨å°–æ‹¬å·åŒ…å«çš„å¤´æ–‡ä»¶ï¼ŒæŸ¥æ‰¾å¤´æ–‡ä»¶çš„è·¯å¾„é¡ºåºä¸ºï¼š
â‘ ç¼–è¯‘å™¨è®¾ç½®çš„å¤´æ–‡ä»¶è·¯å¾„ï¼ˆç¼–è¯‘å™¨å¯ä½¿ç”¨-Iæ˜¾å¼æŒ‡å®šæœç´¢è·¯å¾„ï¼‰
â‘¡ç³»ç»Ÿå˜é‡CPLUS_INCLUDE_PATH/C_INCLUDE_PATHæŒ‡å®šçš„å¤´æ–‡ä»¶è·¯å¾„</p>
</blockquote>
<h3 id="58-ä¸€ä¸ªcæºæ–‡ä»¶ä»æ–‡æœ¬åˆ°å¯æ‰§è¡Œæ–‡ä»¶ç»å†çš„è¿‡ç¨‹">5.8 ä¸€ä¸ªC++æºæ–‡ä»¶ä»æ–‡æœ¬åˆ°å¯æ‰§è¡Œæ–‡ä»¶ç»å†çš„è¿‡ç¨‹</h3>
<p>å¯¹äºC/C++ç¼–å†™çš„ç¨‹åºï¼Œä»æºä»£ç åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸€èˆ¬ç»è¿‡ä¸‹é¢å››ä¸ªæ­¥éª¤ï¼š</br></p>
<ul>
<li>é¢„ç¼–è¯‘ï¼Œé¢„ç¼–è¯‘çš„æ—¶å€™åšä¸€äº›ç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼Œæ¯”å¦‚å®æ›¿æ¢ï¼Œè€Œä¸è¿›è¡Œè¯­æ³•çš„æ£€æŸ¥ï¼›</li>
<li>ç¼–è¯‘ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µï¼Œç¼–è¯‘å™¨å°†æ£€æŸ¥ä¸€äº›è¯­æ³•é”™è¯¯ï¼Œä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨çš„å‡½æ•°äº‹å…ˆæ²¡æœ‰å®šä¹‰è¿™ç§æƒ…å†µï¼Œä¸å†è¿™ä¸€é˜¶æ®µæ£€æŸ¥ï¼Œç¼–è¯‘åï¼Œå¾—åˆ°.sæ–‡ä»¶</li>
<li>æ±‡ç¼–ï¼Œå°†C/C++ä»£ç å˜ä¸ºæ±‡ç¼–ä»£ç ï¼Œå¾—åˆ°.oæˆ–è€….objæ–‡ä»¶</li>
<li>é“¾æ¥ï¼Œå°†æ‰€ç”¨åˆ°çš„å¤–éƒ¨æ–‡ä»¶é“¾æ¥åœ¨ä¸€èµ·ï¼Œåœ¨è¿™ä¸€é˜¶æ®µï¼Œå°±ä¼šæ£€æŸ¥ä½¿ç”¨çš„å‡½æ•°æœ‰æ²¡æœ‰å®šä¹‰</li>
</ul>
<p>é“¾æ¥è¿‡åï¼Œå½¢æˆå¯æ‰§è¡Œæ–‡ä»¶.exe
è¯¦ç»†è¯·å‚é˜…: <a href="https://blog.csdn.net/daaikuaichuan/article/details/89060957"target="_blank" rel="external nofollow noopener noreferrer">ä¸€ä¸ªC++æºæ–‡ä»¶ä»æ–‡æœ¬åˆ°å¯æ‰§è¡Œæ–‡ä»¶ç»å†çš„è¿‡ç¨‹<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h3 id="59-å†…å­˜æ³„æ¼åŸå› å’Œåˆ¤æ–­æ–¹æ³•">5.9 å†…å­˜æ³„æ¼åŸå› å’Œåˆ¤æ–­æ–¹æ³•</h3>
<p>å†…å­˜æ³„æ¼é€šå¸¸æ˜¯å› ä¸ºè°ƒç”¨äº†malloc/newç­‰å†…å­˜ç”³è¯·æ“ä½œï¼Œä½†æ˜¯ç¼ºå°‘äº†å¯¹åº”çš„free/deleteã€‚
ä¸ºäº†åˆ¤æ–­å†…å­˜æ˜¯å¦æ³„æ¼ï¼Œæˆ‘ä»¬ä¸€æ–¹é¢å¯ä»¥ä½¿ç”¨Linuxç¯å¢ƒä¸‹çš„å†…å­˜æ³„æ¼æ£€æŸ¥å·¥å…·Valgrindï¼Œå¦ä¸€æ–¹é¢æˆ‘ä»¬å†™ä»£ç çš„æ—¶å€™ï¼Œå¯ä»¥æ·»åŠ å†…å­˜ç”³è¯·å’Œé‡Šæ”¾çš„ç»Ÿè®¡åŠŸèƒ½ï¼Œç»Ÿè®¡å½“å‰ç”³è¯·å’Œé‡Šæ”¾çš„å†…å­˜æ˜¯å¦ä¸€è‡´ï¼Œä»¥æ­¤æ¥åˆ¤æ–­å†…å­˜æ˜¯å¦æœ‰æ³„æ¼ã€‚</p>
<p>å†…å­˜æ³„æ¼åˆ†ç±»ï¼š</p>
<ul>
<li>å †å†…å­˜æ³„æ¼ï¼ˆheap leakï¼‰ã€‚å †å†…å­˜å€¼å¾—æ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æ ¹æ®éœ€è¦åˆ†é…é€šè¿‡malloc\realloc\newç­‰ä»å †ä¸­åˆ†é…çš„ä¸€å—å†…å­˜ï¼Œå†å®Œæˆä¹‹åå¿…é¡»è¦é€šè¿‡è°ƒç”¨å¯¹åº”çš„freeæˆ–è€…deleteåˆ é™¤ã€‚</li>
<li>å¦‚æœç¨‹åºçš„è®¾è®¡çš„é”™è¯¯å¯¼è‡´è¿™éƒ¨åˆ†å†…å­˜æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œé‚£ä¹ˆæ­¤åè¿™å—å†…å­˜å°†ä¸ä¼šè¢«ä½¿ç”¨ï¼Œå°±ä¼šäº§ç”ŸHeap Leakã€‚</li>
<li>ç³»ç»Ÿèµ„æºæ³„éœ²ï¼ˆResource Leakï¼‰ã€‚ä¸»è¦æŒ‡ç¨‹åºä½¿ç”¨ç³»ç»Ÿåˆ†é…çš„èµ„æºæ¯”å¦‚ Bitmapï¼Œhandleï¼ŒSOCKETç­‰æ²¡æœ‰ä½¿ç”¨ç›¸åº”çš„å‡½æ•°é‡Šæ”¾æ‰ï¼Œå¯¼è‡´ç³»ç»Ÿèµ„æºçš„æµªè´¹ï¼Œä¸¥é‡å¯å¯¼è‡´ç³»ç»Ÿæ•ˆèƒ½é™ä½ï¼Œç³»ç»Ÿè¿è¡Œä¸ç¨³å®šã€‚</li>
<li>æ²¡æœ‰å°†åŸºç±»çš„ææ„å‡½æ•°å®šä¹‰ä¸ºè™šå‡½æ•°ã€‚å½“åŸºç±»æŒ‡é’ˆæŒ‡å‘å­ç±»å¯¹è±¡æ—¶ï¼Œå¦‚æœåŸºç±»çš„ææ„å‡½æ•°ä¸æ˜¯virtualï¼Œé‚£ä¹ˆå­ç±»çš„ææ„å‡½æ•°å°†ä¸ä¼šè¢«è°ƒç”¨ï¼Œå­ç±»çš„èµ„æºæ²¡æœ‰æ­£ç¡®çš„é‡Šæ”¾ï¼Œä»è€Œé€ æˆå†…å­˜æ³„æ¼ã€‚</li>
</ul>
<h3 id="510-æ®µé”™è¯¯çš„äº§ç”ŸåŸå› ">5.10 æ®µé”™è¯¯çš„äº§ç”ŸåŸå› </h3>
<p><strong>æ®µé”™è¯¯æ˜¯ä»€ä¹ˆ?</strong></p>
<blockquote>
<p>ä¸€å¥è¯æ¥è¯´ï¼Œæ®µé”™è¯¯æ˜¯æŒ‡è®¿é—®çš„å†…å­˜è¶…å‡ºäº†ç³»ç»Ÿç»™è¿™ä¸ªç¨‹åºæ‰€è®¾å®šçš„å†…å­˜ç©ºé—´ï¼Œä¾‹å¦‚è®¿é—®äº†ä¸å­˜åœ¨çš„å†…å­˜åœ°å€ã€è®¿é—®äº†ç³»ç»Ÿä¿æŠ¤çš„å†…å­˜åœ°å€ã€è®¿é—®äº†åªè¯»çš„å†…å­˜åœ°å€ç­‰ç­‰æƒ…å†µã€‚è¿™é‡Œè´´ä¸€ä¸ªå¯¹äºâ€œæ®µé”™è¯¯â€çš„å‡†ç¡®å®šä¹‰ã€‚</br></p>
</blockquote>
<p><strong>æ®µé”™è¯¯äº§ç”Ÿçš„åŸå› </strong></p>
<blockquote>
<p>è®¿é—®ä¸å­˜åœ¨çš„å†…å­˜åœ°å€</br>
è®¿é—®ç³»ç»Ÿä¿æŠ¤çš„å†…å­˜åœ°å€</br>
è®¿é—®åªè¯»çš„å†…å­˜åœ°å€</br>
æ ˆæº¢å‡º</br>
è¯¦ç»†è¯·å‚é˜…ï¼š<a href="https://www.cnblogs.com/lidabo/p/4545625.html"target="_blank" rel="external nofollow noopener noreferrer">Linuxç¯å¢ƒä¸‹æ®µé”™è¯¯çš„äº§ç”ŸåŸå› åŠè°ƒè¯•æ–¹æ³•å°ç»“<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></p>
</blockquote>
<h3 id="511-c-å‡½æ•°è°ƒç”¨è¿‡ç¨‹">5.11 C++ å‡½æ•°è°ƒç”¨è¿‡ç¨‹</h3>
<p>æ€»ç»“èµ·æ¥æ•´ä¸ªè¿‡ç¨‹å°±ä¸‰æ­¥ï¼š</p>
<blockquote>
<p>1ï¼‰æ ¹æ®è°ƒç”¨çš„å‡½æ•°åæ‰¾åˆ°å‡½æ•°å…¥å£ï¼›</br>
2ï¼‰åœ¨æ ˆä¸­ç”³è¯·è°ƒç”¨å‡½æ•°ä¸­çš„å‚æ•°åŠå‡½æ•°ä½“å†…å®šä¹‰çš„å˜é‡çš„å†…å­˜ç©ºé—´</br>
3ï¼‰å‡½æ•°æ‰§è¡Œå®Œåï¼Œé‡Šæ”¾å‡½æ•°åœ¨æ ˆä¸­çš„ç”³è¯·çš„å‚æ•°å’Œå˜é‡çš„ç©ºé—´ï¼Œæœ€åè¿”å›å€¼ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰</br></p>
</blockquote>
<p>è¯¦ç»†è¯·æŸ¥é˜…ï¼š<a href="https://www.cnblogs.com/biyeymyhjob/archive/2012/07/20/2601204.html"target="_blank" rel="external nofollow noopener noreferrer">å‡½æ•°è°ƒç”¨è¿‡ç¨‹ / C/C++å‡½æ•°è°ƒç”¨è¿‡ç¨‹åˆ†æ<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h3 id="512-å¦‚ä½•è°ƒè¯•cå¤šçº¿ç¨‹ç¨‹åº">5.12 å¦‚ä½•è°ƒè¯•c++å¤šçº¿ç¨‹ç¨‹åºï¼Ÿ</h3>
<ol>
<li>æ‰“å°æ—¥å¿—ï¼Œæ—¥å¿—ä¸­åŠ ä¸Šçº¿ç¨‹IDï¼›ï¼ˆç®€å•ç²—æš´ï¼‰
gdbæœ‰threadç›¸å…³å‘½ä»¤ï¼Œå¦‚infothreadï¼ˆç®€å†™infothï¼‰æ˜¾ç¤ºçº¿ç¨‹æ¶ˆæ¯ï¼Œbxxthreadyyå¯ä»¥</br></li>
<li>å¯¹æŸä¸ªthreadè®¾ç½®æ–­ç‚¹ï¼Œthreadxxï¼ˆç®€å†™æˆthrxxï¼‰åˆ‡æ¢åˆ°æŸä¸ªthreadã€‚å†é…åˆframeï¼ˆç®€å†™fï¼‰ç›¸å…³çš„å‘½ä»¤ï¼ˆæ¯”å¦‚upï¼Œdownåœ¨ä¸åŒframeé—´è·³è½¬ï¼‰ï¼ŒåŸºæœ¬å¯ä»¥å¤„ç†è‹¥å¹²ä¸ªä¸åŒçš„çº¿ç¨‹é—´çš„debugâ€¦â€¦</br>
è¯¦ç»†è¯·æŸ¥é˜…ï¼š<a href="https://www.cnblogs.com/LuckCoder/p/10948242.html"target="_blank" rel="external nofollow noopener noreferrer">C++(vs)å¤šçº¿ç¨‹è°ƒè¯• ï¼ˆè½¬ï¼‰<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
</ol>
<h3 id="513é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«">5.13Â é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«</h3>
<blockquote>
<p>â‘ é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼ŒæŠŠæ•°æ®å’Œæ•°æ®æ“ä½œæ”¾åœ¨ä¸€èµ·ï¼Œç»„æˆå¯¹è±¡ï¼›å¯¹åŒç±»çš„å¯¹è±¡æŠ½è±¡å‡ºå…¶å…±æ€§ç»„æˆç±»ï¼›ç±»é€šè¿‡ç®€å•çš„æ¥å£ä¸å¤–ç•Œå‘ç”Ÿè”ç³»ï¼Œå¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´é€šè¿‡æ¶ˆæ¯è¿›è¡Œé€šä¿¡ã€‚</br>
â‘¡é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§æ˜¯&quot;å°è£…ã€â€œå¤šæ€â€ã€â€œç»§æ‰¿â€ï¼Œäº”å¤§åŸåˆ™æ˜¯&quot;å•ä¸€èŒè´£åŸåˆ™&rdquo;ã€â€œå¼€æ”¾å°é—­åŸåˆ™â€ã€â€œé‡Œæ°æ›¿æ¢åŸåˆ™â€ã€â€œä¾èµ–å€’ç½®åŸåˆ™â€ã€â€œæ¥å£åˆ†ç¦»åŸåˆ™â€ã€‚</br>
â‘¢è€Œé¢å‘è¿‡ç¨‹æ–¹æ³•æ˜¯ä»¥è¿‡ç¨‹ä¸ºä¸­å¿ƒçš„å¼€å‘æ–¹æ³•ï¼Œå®ƒè‡ªé¡¶å‘ä¸‹é¡ºåºè¿›è¡Œï¼Œ ç¨‹åºç»“æ„æŒ‰ç…§åŠŸèƒ½åˆ’åˆ†æˆè‹¥å¹²ä¸ªåŸºæœ¬æ¨¡å—ï¼Œè¿™äº›æ¨¡å—å½¢æˆæ ‘çŠ¶ç»“æ„ã€‚</br></p>
</blockquote>
<p><strong>ï¼ˆè¿‡ç¨‹ï¼‰ä¼˜ç‚¹ï¼š</strong></p>
<p>æ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ï¼Œå› ä¸ºç±»è°ƒç”¨æ—¶éœ€è¦å®ä¾‹åŒ–ï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œæ¯”è¾ƒæ¶ˆè€—æº;æ¯”å¦‚åµŒå…¥å¼å¼€å‘ã€Linux/Unixç­‰ä¸€èˆ¬é‡‡ç”¨é¢å‘è¿‡ç¨‹å¼€å‘ï¼Œæ€§èƒ½æ˜¯æœ€é‡è¦çš„å› ç´ ã€‚ç¼ºç‚¹ï¼šæ²¡æœ‰é¢å‘å¯¹è±¡æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ã€‚</p>
<p><strong>ï¼ˆå¯¹è±¡ï¼‰ä¼˜ç‚¹ï¼š</strong></p>
<p>æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ï¼Œç”±äºé¢å‘å¯¹è±¡æœ‰å°è£…ã€ç»§æ‰¿ã€å¤šæ€æ€§çš„ç‰¹æ€§ï¼Œå¯ä»¥è®¾è®¡å‡ºä½è€¦åˆçš„ç³»ç»Ÿã€‚ç¼ºç‚¹ï¼šæ€§èƒ½æ¯”é¢å‘è¿‡ç¨‹ä½ã€‚</p>
<h3 id="514-å…³äºå¼•ç”¨èµ‹å€¼çš„å¤šæ€">5.14 å…³äºå¼•ç”¨èµ‹å€¼çš„å¤šæ€ï¼š</h3>
<div class="highlight" id="id-36"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">Class</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Class</span> <span class="nl">D</span> <span class="p">:</span> <span class="k">public</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">B</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">D</span><span class="o">&amp;</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">B</span><span class="o">&amp;</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">d</span> <span class="p">;</span>  <span class="c1">//çˆ¶ç±»å¯ä»¥ä½œä¸ºå­ç±»çš„å¼•ç”¨ï¼Œæ­¤æ—¶b1è¡¨ç°å’ŒæŒ‡é’ˆå½¢å¼ä¸€è‡´ï¼ˆä¼šè°ƒç”¨Bçš„éè™šå‡½æ•°ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">D</span><span class="o">&amp;</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">b</span><span class="err">ï¼›</span> <span class="c1">//é”™è¯¯ï¼Œä¸èƒ½å°†å­ç±»ä½œä¸ºçˆ¶ç±»çš„å¼•ç”¨
</span></span></span><span class="line"><span class="cl"><span class="c1">//çˆ¶ç±»å¯ä»¥ä½œä¸ºå­ç±»çš„å¼•ç”¨ï¼Œæ­¤æ—¶b1è¡¨ç°å’ŒæŒ‡é’ˆå½¢å¼ä¸€è‡´ï¼ˆä¼šè°ƒç”¨Bçš„éè™šå‡½æ•°ï¼‰Â 
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="515-æ¨¡æ¿çš„å£°æ˜å’Œå®ç°ä¸èƒ½åˆ†å¼€çš„åŸå› ">5.15 æ¨¡æ¿çš„å£°æ˜å’Œå®ç°ä¸èƒ½åˆ†å¼€çš„åŸå› </h3>
<blockquote>
<p>é“¾æ¥çš„æ—¶å€™ï¼Œéœ€è¦å®ä¾‹åŒ–æ¨¡æ¿ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ‰¾æ¨¡æ¿çš„å…·ä½“å®ç°äº†ã€‚å‡è®¾åœ¨mainå‡½æ•°ä¸­è°ƒç”¨äº†ä¸€ä¸ªæ¨¡æ¿å‡½æ•°ï¼Œè¿™æ—¶å€™å°±éœ€è¦å»å®ä¾‹åŒ–è¯¥ç±»å‹çš„æ¨¡æ¿ã€‚æ³¨æ„mainå‡½æ•°é‡Œé¢åªåŒ…å«äº†.hæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯åªæœ‰æ¨¡æ¿çš„å£°æ˜ï¼Œæ²¡æœ‰å…·ä½“å®ç°ã€‚å°±ä¼šæŠ¥é”™ã€‚
è€Œæ¨¡æ¿çš„å®ç°.cppé‡Œé¢ï¼Œè™½ç„¶æœ‰æ¨¡æ¿çš„å…·ä½“å®ç°ï¼Œä½†æ˜¯æ²¡æœ‰è°åœ¨è¯¥.cppé‡Œé¢ä½¿ç”¨ä¸€ä¸ªæ¨¡æ¿å‡½æ•°ï¼Œå°±ä¸ä¼šç”Ÿæˆä¸€ä¸ªå…·ä½“åŒ–çš„å®ä¾‹
è¯¦ç»†è¯·å‚é˜…ï¼š<a href="https://www.cnblogs.com/callme/articles/6142129.html"target="_blank" rel="external nofollow noopener noreferrer">C++ æ¨¡æ¿ç±»çš„å£°æ˜ä¸å®ç°åˆ†ç¦»é—®é¢˜<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> / â€‹â€‹â€‹â€‹â€‹<a href="https://blog.csdn.net/weixin_40539125/article/details/83375452?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param"target="_blank" rel="external nofollow noopener noreferrer">â€‹C++ æ¨¡æ¿ç±»çš„å£°æ˜ä¸å®ç°åˆ†ç¦»é—®é¢˜ï¼ˆæ¨¡æ¿å®ä¾‹åŒ–ï¼‰â€‹â€‹â€‹â€‹â€‹â€‹<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
</blockquote>
<h3 id="516-cç±»ä¸­å¼•ç”¨æˆå‘˜å’Œå¸¸é‡æˆå‘˜çš„åˆå§‹åŒ–åˆå§‹åŒ–åˆ—è¡¨">5.16 C++ç±»ä¸­å¼•ç”¨æˆå‘˜å’Œå¸¸é‡æˆå‘˜çš„åˆå§‹åŒ–ï¼ˆåˆå§‹åŒ–åˆ—è¡¨ï¼‰</h3>
<p>å¦‚æœä¸€ä¸ªç±»æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š</p>
<div class="highlight" id="id-37"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Class</span> <span class="n">A</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">          <span class="n">A</span><span class="p">(</span><span class="kt">int</span> <span class="n">pram1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pram2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pram3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="nl">privite</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">          <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">const</span> <span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å‡å¦‚åœ¨æ„é€ å‡½æ•°ä¸­å¯¹ä¸‰ä¸ªç§æœ‰å˜é‡è¿›è¡Œèµ‹å€¼åˆ™é€šå¸¸ä¼šè¿™æ ·å†™ï¼š</p>
<div class="highlight" id="id-38"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">A</span><span class="o">::</span><span class="n">A</span><span class="p">(</span><span class="kt">int</span> <span class="n">pram1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pram2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pram3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="n">a</span><span class="o">=</span><span class="n">pram1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="n">b</span><span class="o">=</span><span class="n">pram2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="n">c</span><span class="o">=</span><span class="n">pram3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†æ˜¯ï¼Œè¿™æ ·æ˜¯ç¼–è¯‘ä¸è¿‡çš„ã€‚å› ä¸ºå¸¸é‡å’Œå¼•ç”¨åˆå§‹åŒ–å¿…é¡»èµ‹å€¼ã€‚æ‰€ä»¥ä¸Šé¢çš„æ„é€ å‡½æ•°çš„å†™æ³•åªæ˜¯ç®€å•çš„èµ‹å€¼ï¼Œå¹¶ä¸æ˜¯åˆå§‹åŒ–ã€‚
æ­£ç¡®å†™æ³•åº”è¯¥æ˜¯ï¼š</p>
<div class="highlight" id="id-39"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">  <span class="n">A</span><span class="o">::</span><span class="n">A</span><span class="p">(</span><span class="kt">int</span> <span class="n">pram1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pram2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pram3</span><span class="p">)</span><span class="o">:</span><span class="n">b</span><span class="p">(</span><span class="n">pram2</span><span class="p">),</span><span class="n">c</span><span class="p">(</span><span class="n">pram3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">a</span><span class="o">=</span><span class="n">pram1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>é‡‡ç”¨åˆå§‹åŒ–åˆ—è¡¨å®ç°äº†å¯¹å¸¸é‡å’Œå¼•ç”¨çš„åˆå§‹åŒ–ã€‚é‡‡ç”¨æ‹¬å·èµ‹å€¼çš„æ–¹æ³•ï¼Œæ‹¬å·èµ‹å€¼åªèƒ½ç”¨åœ¨å˜é‡çš„åˆå§‹åŒ–è€Œä¸èƒ½ç”¨åœ¨å®šä¹‰ä¹‹åçš„èµ‹å€¼ã€‚
å‡¡æ˜¯æœ‰å¼•ç”¨ç±»å‹çš„æˆå‘˜å˜é‡æˆ–è€…å¸¸é‡ç±»å‹çš„å˜é‡çš„ç±»ï¼Œä¸èƒ½æœ‰ç¼ºçœæ„é€ å‡½æ•°ã€‚é»˜è®¤æ„é€ å‡½æ•°æ²¡æœ‰å¯¹å¼•ç”¨æˆå‘˜æä¾›é»˜è®¤çš„åˆå§‹åŒ–æœºåˆ¶ï¼Œä¹Ÿå› æ­¤é€ æˆå¼•ç”¨æœªåˆå§‹åŒ–çš„ç¼–è¯‘é”™è¯¯ã€‚å¹¶ä¸”å¿…é¡»ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨è¿›è¡Œåˆå§‹åŒ–constå¯¹è±¡ã€å¼•ç”¨å¯¹è±¡ã€‚</p>
</blockquote>
<h3 id="517-memsetä¸ºintå‹æ•°ç»„åˆå§‹åŒ–é—®é¢˜">5.17 memsetä¸ºintå‹æ•°ç»„åˆå§‹åŒ–é—®é¢˜ï¼š</h3>
<p>å¤´æ–‡ä»¶ï¼š<code>#include &lt;string.h&gt;</code>
memset() å‡½æ•°ç”¨æ¥å°†æŒ‡å®šå†…å­˜çš„å‰nä¸ªå­—èŠ‚è®¾ç½®ä¸ºç‰¹å®šçš„å€¼ï¼Œå…¶åŸå‹ä¸ºï¼š</p>
<div class="highlight" id="id-40"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="o">*</span> <span class="nf">memset</span><span class="p">(</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">ptr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">value</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">num</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å‚æ•°è¯´æ˜ï¼š</br>
ptr ä¸ºè¦æ“ä½œçš„å†…å­˜çš„æŒ‡é’ˆã€‚</br>
value ä¸ºè¦è®¾ç½®çš„å€¼ã€‚ä½ æ—¢å¯ä»¥å‘ value ä¼ é€’ int ç±»å‹çš„å€¼ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ char ç±»å‹çš„å€¼ï¼Œint å’Œ char å¯ä»¥æ ¹æ® ASCII ç ç›¸äº’è½¬æ¢ã€‚</br>
num ä¸º ptr çš„å‰ num ä¸ªå­—èŠ‚ï¼Œsize_t å°±æ˜¯unsigned intã€‚</br></p>
</blockquote>
<p>ã€å‡½æ•°è¯´æ˜ã€‘memset() ä¼šå°† ptr æ‰€æŒ‡çš„å†…å­˜åŒºåŸŸçš„å‰ num ä¸ªå­—èŠ‚çš„å€¼éƒ½è®¾ç½®ä¸º valueï¼Œç„¶åè¿”å›æŒ‡å‘ ptr çš„æŒ‡é’ˆã€‚</p>
<p>æ— æ³•ä¸‹é¢è¿™æ ·åˆå§‹åŒ–ï¼Œè¿™æ ·çš„ç»“æœæ˜¯aè¢«èµ‹å€¼æˆ168430090ï¼Œ168430090&hellip;..</p>
<div class="highlight" id="id-41"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">memset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">));</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯å› ä¸ºintç”±4ä¸ªå­—èŠ‚(è¯´)è¡¨ç¤ºï¼Œå¹¶ä¸”ä¸èƒ½å¾—åˆ°æ•°ç»„aä¸­æ•´æ•°çš„æœŸæœ›å€¼ã€‚
ä½†æˆ‘ç»å¸¸çœ‹åˆ°ç¨‹åºå‘˜ä½¿ç”¨memsetå°†intæ•°ç»„å…ƒç´ è®¾ç½®ä¸º0æˆ–-1ã€‚å…¶ä»–å€¼ä¸è¡Œï¼</p>
<div class="highlight" id="id-42"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">b</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">memset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="n">memset</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">b</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="c1">//å‡è®¾aä¸ºintå‹æ•°ç»„ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">memset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mh">0x7f</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="c1">//aæ•°ç»„æ¯ä¸ªç©ºé—´å°†è¢«åˆå§‹åŒ–ä¸º0x7f7f7f7f,åŸå› æ˜¯Cå‡½æ•°ä¼ å‚è¿‡ç¨‹ä¸­çš„æŒ‡é’ˆé™çº§ï¼Œå¯¼è‡´sizeof(a)ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª something*æŒ‡é’ˆç±»å‹å¤§å°çš„çš„å­—èŠ‚æ•°ï¼Œå¦‚æœæ˜¯32ä½ï¼Œå°±æ˜¯4å­—èŠ‚ã€‚æ‰€ä»¥memsetæŒ‰å­—èŠ‚èµ‹å€¼ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">memset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mh">0xaf</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="c1">//aæ•°ç»„æ¯ä¸ªç©ºé—´å°†è¢«åˆå§‹åŒ–ä¸º0xafafafaf
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="518-ç¼–è¯‘å™¨å¯¹-inline-å‡½æ•°çš„å¤„ç†æ­¥éª¤">5.18 ç¼–è¯‘å™¨å¯¹ inline å‡½æ•°çš„å¤„ç†æ­¥éª¤</h3>
<blockquote>
<p>å°† inline å‡½æ•°ä½“å¤åˆ¶åˆ° inline å‡½æ•°è°ƒç”¨ç‚¹å¤„ï¼›</br>
ä¸ºæ‰€ç”¨ inline å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡åˆ†é…å†…å­˜ç©ºé—´ï¼›</br>
å°† inline å‡½æ•°çš„çš„è¾“å…¥å‚æ•°å’Œè¿”å›å€¼æ˜ å°„åˆ°è°ƒç”¨æ–¹æ³•çš„å±€éƒ¨å˜é‡ç©ºé—´ä¸­ï¼›</br>
å¦‚æœ inline å‡½æ•°æœ‰å¤šä¸ªè¿”å›ç‚¹ï¼Œå°†å…¶è½¬å˜ä¸º inline å‡½æ•°ä»£ç å—æœ«å°¾çš„åˆ†æ”¯ï¼ˆä½¿ç”¨ GOTOï¼‰</br></p>
</blockquote>
<p>ä¼˜ç‚¹:</p>
<blockquote>
<p>å†…è”å‡½æ•°åŒå®å‡½æ•°ä¸€æ ·å°†åœ¨è¢«è°ƒç”¨å¤„è¿›è¡Œä»£ç å±•å¼€ï¼Œçœå»äº†å‚æ•°å‹æ ˆã€æ ˆå¸§å¼€è¾Ÿä¸å›æ”¶ï¼Œç»“æœè¿”å›ç­‰ï¼Œä»è€Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ã€‚</br>
å†…è”å‡½æ•°ç›¸æ¯”å®å‡½æ•°æ¥è¯´ï¼Œåœ¨ä»£ç å±•å¼€æ—¶ï¼Œä¼šåšå®‰å…¨æ£€æŸ¥æˆ–è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆåŒæ™®é€šå‡½æ•°ï¼‰ï¼Œè€Œå®å®šä¹‰åˆ™ä¸ä¼šã€‚</br>
åœ¨ç±»ä¸­å£°æ˜åŒæ—¶å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œè‡ªåŠ¨è½¬åŒ–ä¸ºå†…è”å‡½æ•°ï¼Œå› æ­¤å†…è”å‡½æ•°å¯ä»¥è®¿é—®ç±»çš„æˆå‘˜å˜é‡ï¼Œå®å®šä¹‰åˆ™ä¸èƒ½ã€‚</br>
å†…è”å‡½æ•°åœ¨è¿è¡Œæ—¶å¯è°ƒè¯•ï¼Œè€Œå®å®šä¹‰ä¸å¯ä»¥ã€‚</br></p>
</blockquote>
<p>ç¼ºç‚¹:</p>
<blockquote>
<p>ä»£ç è†¨èƒ€ã€‚å†…è”æ˜¯ä»¥ä»£ç è†¨èƒ€ï¼ˆå¤åˆ¶ï¼‰ä¸ºä»£ä»·ï¼Œæ¶ˆé™¤å‡½æ•°è°ƒç”¨å¸¦æ¥çš„å¼€é”€ã€‚å¦‚æœæ‰§è¡Œå‡½æ•°ä½“å†…ä»£ç çš„æ—¶é—´ï¼Œç›¸æ¯”äºå‡½æ•°è°ƒç”¨çš„å¼€é”€è¾ƒå¤§ï¼Œé‚£ä¹ˆæ•ˆç‡çš„æ”¶è·ä¼šå¾ˆå°‘ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¯ä¸€å¤„å†…è”å‡½æ•°çš„è°ƒç”¨éƒ½è¦å¤åˆ¶ä»£ç ï¼Œå°†ä½¿ç¨‹åºçš„æ€»ä»£ç é‡å¢å¤§ï¼Œæ¶ˆè€—æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚</br>
inline å‡½æ•°æ— æ³•éšç€å‡½æ•°åº“å‡çº§è€Œå‡çº§ã€‚inlineå‡½æ•°çš„æ”¹å˜éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œä¸åƒ non-inline å¯ä»¥ç›´æ¥é“¾æ¥ã€‚</br>
æ˜¯å¦å†…è”ï¼Œç¨‹åºå‘˜ä¸å¯æ§ã€‚å†…è”å‡½æ•°åªæ˜¯å¯¹ç¼–è¯‘å™¨çš„å»ºè®®ï¼Œæ˜¯å¦å¯¹å‡½æ•°å†…è”ï¼Œå†³å®šæƒåœ¨äºç¼–è¯‘å™¨ã€‚</br></p>
</blockquote>
<h3 id="519-è™šå‡½æ•°virtualå¯ä»¥æ˜¯å†…è”å‡½æ•°inlineå—">5.19 è™šå‡½æ•°ï¼ˆvirtualï¼‰å¯ä»¥æ˜¯å†…è”å‡½æ•°ï¼ˆinlineï¼‰å—ï¼Ÿ</h3>
<blockquote>
<p>è™šå‡½æ•°å¯ä»¥æ˜¯å†…è”å‡½æ•°ï¼Œå†…è”æ˜¯å¯ä»¥ä¿®é¥°è™šå‡½æ•°çš„ï¼Œä½†æ˜¯å½“è™šå‡½æ•°è¡¨ç°å¤šæ€æ€§çš„æ—¶å€™ä¸èƒ½å†…è”ã€‚</br>
å†…è”æ˜¯åœ¨ç¼–è¯‘å™¨å»ºè®®ç¼–è¯‘å™¨å†…è”ï¼Œè€Œè™šå‡½æ•°çš„å¤šæ€æ€§åœ¨è¿è¡ŒæœŸï¼Œç¼–è¯‘å™¨æ— æ³•çŸ¥é“è¿è¡ŒæœŸè°ƒç”¨å“ªä¸ªä»£ç ï¼Œå› æ­¤è™šå‡½æ•°è¡¨ç°ä¸ºå¤šæ€æ€§æ—¶ï¼ˆè¿è¡ŒæœŸï¼‰ä¸å¯ä»¥å†…è”ã€‚</br>
inline virtual å”¯ä¸€å¯ä»¥å†…è”çš„æ—¶å€™æ˜¯ï¼šç¼–è¯‘å™¨çŸ¥é“æ‰€è°ƒç”¨çš„å¯¹è±¡æ˜¯å“ªä¸ªç±»(å¦‚ Base::who())ï¼Œè¿™åªæœ‰åœ¨ç¼–è¯‘å™¨å…·æœ‰å®é™…å¯¹è±¡è€Œä¸æ˜¯å¯¹è±¡çš„æŒ‡é’ˆæˆ–å¼•ç”¨æ—¶æ‰ä¼šå‘ç”Ÿ;</br></p>
</blockquote>
<h3 id="520é™æ€åº“å’ŒåŠ¨æ€åº“æ¯”è¾ƒ">5.20Â é™æ€åº“å’ŒåŠ¨æ€åº“æ¯”è¾ƒ</h3>
<p>é™æ€åº“Â (.aã€.lib):</p>
<blockquote>
<p>å°†é™æ€åº“çš„å†…å®¹æ·»åŠ åˆ°ç¨‹åºä¸­ï¼Œæ­¤æ—¶ç¨‹åºçš„ç©ºé—´ï¼Œå˜æˆäº†æºç¨‹åºç©ºé—´å¤§å°+é™æ€åº“ç©ºé—´å¤§å°ã€‚</p>
</blockquote>
<p>åŠ¨æ€åº“ï¼ˆå…±äº«åº“ï¼‰(.soã€.dll):</p>
<blockquote>
<p>å¸¸é©»å†…å­˜ï¼Œå½“ç¨‹åºéœ€è¦è°ƒç”¨ç›¸å…³å‡½æ•°æ—¶ï¼Œä¼šä»å†…å­˜è°ƒç”¨ã€‚</p>
</blockquote>
<p>åŒºåˆ«:</p>
<blockquote>
<p>é™æ€åº“ï¼šå¯¹ç©ºé—´è¦æ±‚è¾ƒä½ï¼Œè€Œæ—¶é—´è¦æ±‚è¾ƒé«˜çš„æ ¸å¿ƒç¨‹åºä¸­ã€‚(.aã€.lib) </br>
åŠ¨æ€åº“ï¼šå¯¹æ—¶é—´è¦æ±‚è¾ƒä½ï¼Œå¯¹ç©ºé—´è¦æ±‚è¾ƒé«˜ã€‚(.soã€.dll)Â </br></p>
</blockquote>
<p><a href="https://blog.csdn.net/m0_46245582/article/details/124027320"target="_blank" rel="external nofollow noopener noreferrer">hash<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<h2 id="6-åŸºç¡€çŸ¥è¯†å…­">6 åŸºç¡€çŸ¥è¯†(å…­)</h2>
<h3 id="61-æ„é€ å‡½æ•°ä¸ºä»€ä¹ˆä¸èƒ½å®šä¹‰ä¸ºè™šå‡½æ•°-ææ„å‡½æ•°èˆ¬å†™æˆè™šå‡½æ•°çš„åŸå› -">6.1 æ„é€ å‡½æ•°ä¸ºä»€ä¹ˆä¸èƒ½å®šä¹‰ä¸ºè™šå‡½æ•°ï¼Ÿ â½½ææ„å‡½æ•°â¼€èˆ¬å†™æˆè™šå‡½æ•°çš„åŸå›  ï¼Ÿ</h3>
<p>æ„é€ å‡½æ•°ä¸èƒ½å£°æ˜ä¸ºè™šå‡½æ•°çš„åŸå› æ˜¯:</p>
<blockquote>
<p>1 æ„é€ ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå¿…é¡»çŸ¥é“å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œè€Œè™šå‡½æ•°è¡Œä¸ºæ˜¯åœ¨è¿è¡ŒæœŸé—´ç¡®å®šå®é™…ç±»å‹çš„ã€‚è€Œåœ¨æ„é€ ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç”±äºå¯¹è±¡è¿˜æœªæ„é€ æˆåŠŸã€‚ç¼–è¯‘å™¨æ— æ³•çŸ¥é“å¯¹è±¡ çš„å®é™…ç±»å‹ï¼Œæ˜¯è¯¥ç±»æœ¬èº«ï¼Œè¿˜æ˜¯è¯¥ç±»çš„ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼Œæˆ–æ˜¯æ›´æ·±å±‚æ¬¡çš„æ´¾ç”Ÿç±»ã€‚æ— æ³•ç¡®å®šã€‚</br>
2 è™šå‡½æ•°çš„æ‰§è¡Œä¾èµ–äºè™šå‡½æ•°è¡¨ã€‚è€Œè™šå‡½æ•°è¡¨åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œåˆå§‹åŒ–å·¥ä½œï¼Œå³åˆå§‹åŒ–vptrï¼Œè®©ä»–æŒ‡å‘æ­£ç¡®çš„è™šå‡½æ•°è¡¨ã€‚è€Œåœ¨æ„é€ å¯¹è±¡æœŸé—´ï¼Œè™šå‡½æ•°è¡¨è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå°†æ— æ³•è¿›è¡Œã€‚</br></p>
</blockquote>
<p>è™šå‡½æ•°çš„æ„æ€å°±æ˜¯å¼€å¯åŠ¨æ€ç»‘å®šï¼Œç¨‹åºä¼šæ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹æ¥é€‰æ‹©è¦è°ƒç”¨çš„æ–¹æ³•ã€‚ç„¶è€Œåœ¨æ„é€ å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡çš„åŠ¨æ€ç±»å‹è¿˜ä¸å®Œæ•´ï¼Œæ²¡æœ‰åŠæ³•ç¡®å®šå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹ï¼Œæ•…æ„é€ å‡½æ•°ä¸èƒ½åŠ¨æ€ç»‘å®šã€‚ï¼ˆåŠ¨æ€ç»‘å®šæ˜¯æ ¹æ®å¯¹è±¡çš„åŠ¨æ€ç±»å‹è€Œä¸æ˜¯å‡½æ•°åï¼Œåœ¨è°ƒç”¨æ„é€ å‡½æ•°ä¹‹å‰ï¼Œè¿™ä¸ªå¯¹è±¡æ ¹æœ¬å°±ä¸å­˜åœ¨ï¼Œå®ƒæ€ä¹ˆåŠ¨æ€ç»‘å®šï¼Ÿï¼‰
ç¼–è¯‘å™¨åœ¨è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°çš„æ—¶å€™å¹¶ä¸çŸ¥é“ä½ è¦æ„é€ çš„æ˜¯ä¸€ä¸ªåŸºç±»çš„å¯¹è±¡è¿˜æ˜¯ä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚</p>
<blockquote>
<p>ææ„å‡½æ•°è®¾ä¸ºè™šå‡½æ•°çš„ä½œç”¨:
è§£é‡Šï¼šåœ¨ç±»çš„ç»§æ‰¿ä¸­ï¼Œå¦‚æœæœ‰åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»ï¼Œé‚£ä¹ˆç”¨åŸºç±»æŒ‡é’ˆdeleteæ—¶ï¼Œå¦‚æœä¸å®šä¹‰æˆè™šå‡½æ•°ï¼Œæ´¾ç”Ÿç±»ä¸­æ´¾ç”Ÿçš„é‚£éƒ¨åˆ†æ— æ³•ææ„ã€‚ï¼ˆå¦‚æœåŸºç±»çš„ææ„å‡½æ•°ä¸æ˜¯è™šå‡½æ•°ï¼Œé‚£ä¹ˆåœ¨delete åŸºç±»æŒ‡é’ˆæ—¶ï¼Œåªè°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ï¼Œä¸ä¼šè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼Œæ•…æ´¾ç”Ÿç±»éƒ¨åˆ†ä¸ä¼šè¢«ææ„ã€‚ï¼‰</p>
</blockquote>
<p>ref:</br>
[1]. <a href="https://blog.csdn.net/Yangy_Jiaojiao/article/details/127588598"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/Yangy_Jiaojiao/article/details/127588598<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
[2]. <a href="https://blog.csdn.net/Yangy_Jiaojiao/article/details/128145609"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/Yangy_Jiaojiao/article/details/128145609<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></p>
<p>å‚è€ƒï¼ˆå¾…è¡¥å……ï¼‰:</br>
[1]. <a href="https://zhuanlan.zhihu.com/p/401341063"target="_blank" rel="external nofollow noopener noreferrer">https://zhuanlan.zhihu.com/p/401341063<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br>
[2]. <a href="https://zhuanlan.zhihu.com/p/602866792"target="_blank" rel="external nofollow noopener noreferrer">https://zhuanlan.zhihu.com/p/602866792<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></br></p>
<p>ref: <a href="https://blog.csdn.net/m0_46245582/category_11569287.html"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/m0_46245582/category_11569287.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>]]></description></item></channel></rss>